JPL Hatchett and R K¨uhn
Laboratory for mathematical neuroscience, RIKEN BSI, Hirosawa 2-1, Saitama
351-0198, Japan
Department of Mathematics, King’s College London, The Strand, London WC2R
2LS, United Kingdom

Abstract. We study a credit risk model which captures eﬀects of economic inter-
actions on a ﬁrm’s default probability. Economic interactions are represented as a
functionally deﬁned graph, and the existence of both cooperative, and competitive,
business relations is taken into account. We provide an analytic solution of the model
in a limit where the number of business relations of each company is large, but the
overall fraction of the economy with which a given company interacts may be small.
While the eﬀects of economic interactions are relatively weak in typical (most proba-
ble) scenarios, they are pronounced in situations of economic stress, and thus lead to
a substantial fattening of the tails of loss distributions in large loan portfolios. This
manifests itself in a pronounced enhancement of the Value at Risk computed for inter-
acting economies in comparison with their non-interacting counterparts.

5 Eﬀects of Economic Interactions on Credit Risk
0
0
2
 
c
e
D
 
6
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
5
5
1
2
1
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The proper quantiﬁcation of credit risk poses a complex mix of problems, as important
credit risk parameters such as default rates, recovery rates or exposures, ﬂuctuate
substantially in time even on a high portfolio aggregation level [1]. This results in
large unexpected losses in loan portfolios, for which banks are required to hold equity
capital as a loss buﬀer. To determine the appropriate level of equity capital for banks’
loan portfolios is one main focus of the regulatory consultive process known as Basel
II [2]. Accordingly, credit risk modelling has been a focus of intense research in recent
years [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], although considering
the risk premium when pricing interest rates goes back some time [22].

hatchett@brain.riken.jp, kuehn@mth.klc.ac.uk

PACS numbers: 02.50.-r,05.40.-a,89.65.Gh,89.75.Da

1. Introduction

Date: December 6, 2005

E-mail:

The assessment of credit ratings by assessment agencies such as Moody’s and
S&P allow some statistical assessment of the credit quality of individual oﬀerings or
particular companies. However, it is clearly essential when considering the risk of a
basket of loans that the correlations between the members of the portfolio are taken
into account. One systematic approach is to replace the number of ﬁrms in a portfolio

Eﬀects of Economic Interactions on Credit Risk

2

with an eﬀective number of independent ﬁrms [24]. By boosting the contribution of
each ﬁrm to keep the mean loss constant, this introduces a larger variance of losses,
in at attempt to capture the risk caused by correlations between ﬁrms. JPMorgan’s
CreditMetrics approach [3] (see also Credit Suisse Financial Products’s CreditRisk+ [4]
and [19] for a detailed comparison of the two) tries to model the correlations between
ﬁrms in credit quality using the observable correlations in equity value of the ﬁrms.
An intuitively appealing approach is to assume that the default intensity depends on
some set of macroscopic economic factors (e.g.
interest rates, growth rates, oil prices
etc.), the so-called reduced form model [7, 8]. Thus the default rates of diﬀerent ﬁrms
are coupled via some limited number of factors, but given the factors the default rates
are independent.
In structural models [22, 23], the dependence on macro-economic
factors is understood in terms of correlations in the dynamics of asset returns of
diﬀerent companies, leading to correlations in default rates via correlated dynamics
of returns. More involved approaches have modelled interactions between ﬁrms in the
wider economy by introducing changes to a ﬁrm’s default intensity upon the default of
another ﬁrm [6], or via a copula function [10]. The quantiﬁcation of these correlations
via simulations is discussed in [14].

The main purpose of the present contribution is speciﬁcally to expand upon
recent modelling and analytic descriptions of the inﬂuence of counter-party risk
[6, 9, 11, 13, 15, 16, 17, 18, 21]. Counter-party risk addresses the fact that a given
ﬁrm’s economic health is strongly inﬂuenced by the performance within the network of
companies with which it has direct economic interactions. Economic interactions are
here to be read in a broad sense as any form of relation which is likely to mutually
inﬂuence performance, though not necessarily in symmetric ways.
Speciﬁcally, a
defaulting ﬁrm within this network of counter-parties will aﬀect a company’s own default
probability — reducing it, if the defaulting ﬁrm was a competitor, or increasing it, if
the relation was of a cooperative nature. When the default probability is increased, this
process is known as credit contagion and has been considered in e.g. [16, 18] while the
incorporation of counter-party risk into a reduced form model was introduced in [9]. In
what follows we consider the dynamics of individual ﬁrm defaults and their inﬂuence on
loss distributions. More subtle eﬀects such as credit quality migration are, as yet, not
taken into account.

The importance of direct functional interactions in the analysis of risk is not
restricted to credit risk. In fact the role of interactions is much more obvious in the
context of operational risk, where sequential, functionally induced failures of mutually
dependent processes constitute one of the main sources for operational risk. Indeed, an
attempt to explore the consequences of interactions for quantifying the capital buﬀer
necessary to cover operational risk [25] has provided major ingredients for the approach
to credit risk modelling started by Neu and one of us [21].

In the present paper we provide an analytic solution to the dynamical description
of counter-party risk within a heterogeneous, functionally deﬁned network of interacting
ﬁrms (to be referred to as economy in what follows), see e.g. [18], in the spirit of [21].

Eﬀects of Economic Interactions on Credit Risk

3

We generalize the analysis of that study to capture eﬀects of cooperative as well as
competitive business relations within the economy, and we solve the model for a wide
degree of dilution of the network of economic dependencies in the sense that we assume
each company in the net to have business relations only with a (randomly chosen) subset
of the full set of companies. In the present investigation we will always consider the case
where the number of interaction partners of each company is large, and for simplicity we
shall restrict ourselves here to the case where the graph deﬁning economic connectivity is
a Poisson degree distributed Erd¨os-R´enyi random graph [26]. More realistic connectivity
distributions reﬂecting the diﬀerent connectivity patterns of large and small players in
an economy, taking into account small-world eﬀects and fat tailed degree distributions
[27] can be handled by methods similar to those used in the present investigation [28, 29],
but will be studied in a separate paper.

As in [21], the model parameters are unconditional and conditional default
probabilities, which may be thought of as being obtained via a suitable rating procedure.
One of the virtues of the present analytic investigation is to highlight the fact that the
collective behaviour of the system, which ultimately determines the the loss-distribution
on an economy-wide scale, is fairly insensitive to detail. That is, it does not depend on
getting individual dependencies correct, but only on the overall distribution of of the
unconditional and conditional default probabilities. Our main result is to demonstrate
that the eﬀects of economic interactions — while relatively weak in typical scenarios —
are pronounced in situations of economic stress, and thus lead to a substantial fattening
of the tails of loss distributions even in large loan portfolios.

The remainder of the paper is organized as follows. In Sec. 2 we deﬁne our model,
and specify the stochastic setting for our analytic investigation. The relation between
the model parameters and conditional and unconditional default probabilities as used
in [21] is brieﬂy reviewed to make the paper self-contained. Sec. 3 describes a heuristic
solution for the dynamical evolution of the fraction of defaulted companies over a risk
horizon of one year, starting from an overall healthy situation, a scenario appropriate for
the analysis of credit risk. A formal solution in terms of a generating function approach
(GFA) [30], which provides a full justiﬁcation for the heuristic solution is relegated
to Appendix A. Both solution methods are based upon techniques developed in the
statistical mechanical analysis of dilute neural networks [31]. In Sec. 4 a phase diagram
distinguishing regions in parameter space in which economic interactions can lead to a
collective acceleration of the economy-wide default rate in situations of economic stress
from regions where such acceleration is impossible is computed. Distributions of annual
fractions of defaulted companies as well as loss distributions, both economy-wide and for
ﬁnite loan-portfolios are also computed and compared with simulations. Sec. 5 ﬁnally
summarizes our ﬁndings and discusses their main implications for the analysis of credit
risk

Eﬀects of Economic Interactions on Credit Risk

4

2. Model Deﬁnitions

In this section we deﬁne a statistical model that attempts to capture the eﬀects
of counter-party risk on credit contagion.
In contrast to approaches based on
microeconomics, and in keeping with the framework discussed in the introduction, we
allow the ﬁrms’ wealth, macro-economic factors and interactions between ﬁrms to all
be described probabilistically. This is due to our focus on the characteristic change in
behaviour caused by examining interactions between ﬁrms in the wider economy.

We analyse an economy which consists of N ﬁrms. The state of each ﬁrm i at a
given time t is described by its ‘wealth’ Wit which we take to be the diﬀerence between
its assets and its liabilities. Accordingly, a company defaults, if its wealth Wit falls
below zero. As indicated in the introduction, we are interested in the inﬂuence of
economic partners on ﬁrms’ own performance, speciﬁcally on their default probability.
We understand the notions of ﬁrm and economic partner in a very wide sense: a ﬁrm
could be any economic entity, a manufacturer, a service provider, a trader of goods or
services, etc. It could also be an individual (we shall often use the generic term ‘node’
to designate these entities). Two ﬁrms are partners if the state of one has a material
eﬀect upon the other, e.g. one is the supplier of the other, performs outsourced services,
there exists substantial loans or other ﬁnancial commitments between the two, or they
compete in the same market. For instance, if a major manufacturer of PCs were to go
out of business tomorrow, this would inevitably have a material impact on the economic
performance (i.e. wealth) of other companies operating in the same industry sector.
It would on the one hand lead to a deterioration in the ﬁnancial viability of most of
the suppliers or service providers of the PC manufacturer in question — including in
particular its own work force! — but on the other hand it would improve the situation
for competing producers of PCs, in that they could proﬁt by taking over a share of the
defaulted company’s market.

We are interested in quantifying the eﬀect of these interactions from the perspective
of a lending bank which would be required to set aside a suﬃcient amount of capital
to cover losses incurred by defaults of its obligors. Another perspective might be that
of a central bank, which would base monetary policy decisions in part on their impact
on expected default rates at an economy wide scale. The typical risk horizon in these
contexts would be one year.

For simplicity, we assume that that within the risk horizon of one year node
i experiences an interaction-induced material change of its wealth only if one of its
business partners, say j, defaults. In order to formalize this in a dynamical description,
we introduce binary indicator variable njt which indicates whether node j is solvent at
time t (njt = 0) or has defaulted (njt = 1).

The value of the ith node’s wealth at time t, Wit, is thus taken to be of the form

Wit = ϑi −

Jijnjt −

ηit

n

Xj=1

(1)

Here Jij denotes the change in i’s wealth which would be induced by a default of node

Eﬀects of Economic Interactions on Credit Risk

5

j. One would have Jij > 0 if j is a cooperative partner of i, whereas Jij < 0 if j is a
competitor, while Jij = 0 if there is no direct inﬂuence of j on i. By ϑi we designate i’s
initial wealth at the beginning of the year, and ηit are random ﬂuctuations caused by
both, external macro-economic factors (an expanding/shrinking economy, an oil price
spike, market sentiment etc), and ﬁrm speciﬁc actions or events.

We take the initial state of the economy to be a set of solvent ﬁrms, ni0 = 0 for all
i, (one could view this as a deﬁnition) and say that a ﬁrm defaults at time t if Wit < 0.
We deﬁne our dynamics such that if a ﬁrm goes bankrupt it does not recover within a
risk horizon of one year, so the bankrupt state is absorbing. Thus the dynamics of the
ﬁrms state is given by the equation

nit+1 = nit + (1

nit)Θ

−

 

Xj

Jijnjt −

ϑi + ηit

!

where Θ(. . .) is the Heavyside function. The time step in this dynamical rule will be
taken to represent one month.

We choose the ηit to be Gaussian distributed. Without loss of generality they can
— by suitably rescaling the ϑi and the Jij — be chosen to have unit variance. We follow
widespread practice [3, 5] to account for common ﬂuctuating macro-economic factors
by choosing the ηit to be correlated for diﬀerent i. This could be achieved by taking ηit
to be of the form

ηit = σiξit +

βikYkt

K

Xk=1

with uncorrelated Gaussian unit variance white noises ξit and
, the former
describing ﬁrm speciﬁc wealth ﬂuctuations, whereas the latter could account for the
relative eﬀects of ﬂuctuations common to industry sectors, regions, or countries, with
prefactors σi and βik describing the relative importance of these ﬂuctuations on i. In
what follows we restrict ourselves to a minimal variant of this set-up by ﬁnally choosing

Ykt}

{

ηit = √ρ η0t +

ρ ξit .

1
q

−

We shall simplify matters further by assuming that the common economic factor η0t is
slow and take it to be constant η0t = η0 within a risk horizon of one year. One-factor
models of this type also feature in the regulatory framework laid out in the Basel II
accord [2].

None of the simplifying assumptions are necessary for our analysis to go through;
the generating function formalism given in Appendix A in particular can easily handle
more general cases. However, the simpliﬁed setting is suﬃcient to highlight the
important eﬀects of interactions on credit risk, and it does lead to a greatly simpliﬁed
macroscopic description of the system, as we will see in Sec. 3.

As for the Jij which describe the loss or gain of node i due to a default of node j,
in the present paper we will investigate them in a probabilistic setting. It will be useful
to disentangle the presence or absence of an interaction from its strength by writing

Jij = cij ˜Jij

(2)

(3)

(4)

(5)

Eﬀects of Economic Interactions on Credit Risk

6

}

0, 1

describes the absence or presence of a connection j

i, while ˜Jij
where cij ∈ {
describes its magnitude, both of which are assumed to be ﬁxed.
It is reasonable to
assume that connectivity is a symmetric relation, cij = cji, whereas there is no reason
to suppose symmetry of the magnitudes of mutual inﬂuences. Considering the case of
a small supplier with one large company taking the majority of its orders, if the larger
company defaults then the small supplier may well go bust too. However, if the small
supplier defaults then the large company is less likely to suﬀer terminal ﬁnancial distress,
so in general ˜Jij 6

Speciﬁcally, we assume a random connectivity pattern described by

= ˜Jji.

→

P (cij) =

δcij ,1 +

δcij,0 , i < j , cij = cji

(6)

c
N

1
(cid:18)

−

c
N (cid:19)

O

and we will be interested in the limit of a large economy (the thermodynamic limit), in
which the average connectivity c of each node is itself large, N
. We will
→ ∞
initially be concerned with the extremely diluted regime, where c/N
0, taking e.g.
(log(N)). These assumptions have important consequences for the structure of
c =
the graph deﬁning the connectivities, namely that each node feels the eﬀects of a large
number of other nodes (so that limit theorems will allow us to describe the overall eﬀects
of interactions) and, for the extremely diluted regime, that there are only a ﬁnite number
of loops of ﬁnite length even in the inﬁnite economy limit. The graph of interactions
between companies for ﬁnite N is just an Erd¨os-R´enyi random graph [26].

→ ∞

, c

→

The magnitudes ˜Jij of the interactions will also be taken as ﬁxed random quantities.
In order to allow the taking of the thermodynamic limit as described, the mean and
ﬂuctuations of the ˜Jij must scale in a suitable way with the connectivity c. Quite
generally, we must have

˜Jij =

J0
c

+

J
√c

xij

(7)

in which the xij are zero-mean unit-variance random variables. The scaling of mean
and variance of the ˜Jij is given by the parameters J0 and J respectively. If J0 > 0 there
will be a net cooperative tendency within the economy, which seems to be a reasonable
assumption. Finally, we will need to assume that all moments of the xij are ﬁnite and
we will choose the xij to be independent in pairs

xij = 0 ,

x2
ij = 1 ,

xijxji = α ,

xijxkl = 0 otherwise .

(8)

The parameter α, (
Jji. Strictly symmetric interactions are obtained only for α = 1

1
−

1) describes the degree of correlations between Jij and

≤

≤

α

At this point let us brieﬂy recall that, after rescaling as described, the model
parameters ϑi and Jij have a clear meaning in terms of unconditional and conditional
default probabilities [21]. We denote by nt the values of all indicator variables in the
economy at time t, assuming nit = 0. Then by integrating over the unit variance
Gaussian ηit in (2) one obtains the conditional probability for node i to default within
a month given a conﬁguration nt of non-defaulted and defaulted ﬁrms in the economy

Eﬀects of Economic Interactions on Credit Risk

7

at time t as,

Prob

nit+1 = 1
(cid:16)

nt

= Φ

(cid:17)

(cid:16) Xj

Jij njt −

ϑi

(cid:17)

(cid:12)
(cid:12)
(cid:12)

2 [1 + erf(x/√2)] the cumulative normal distribution.

with Φ(x) = 1
Thus the
unconditional probability pi of default of i within a month in an otherwise healthy
j for a default of i within a month, given j
economy and the conditional probability pi
|
and only j has defaulted before are given by

pi = Prob

nit+1 = 1

j = Prob

nit+1 = 1

pi
|

nit = 0

{
njt = 1,

= Φ(

ϑi) ,

−
=j)t = 0

}

(cid:17)
nk(
{

(cid:16)

(cid:16)

= Φ
(cid:16)

Jij −

}

(cid:17)

ϑi

.

(cid:17)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

These relations may be inverted to express the model parameters in terms of conditional
and unconditional default probabilities — quantities that would be estimated in a rating
procedure — as

ϑi =

Φ−

1(pi)

,

−

Jij = Φ−

1(pi
|

j)

−

Φ−

1(pi) .

While characterising the default of companies is of interest, our primary concern
is to examine the distribution of losses accrued over our one year time frame, both in
the economy at large, and in a portfolio made up of a ﬁnite number of ﬁrms within the
economy. We assume that the losses caused by default are independent of the month of
default, and then examine two diﬀerent cases. The ﬁrst simpler case is that the losses at
ﬁrm i, given that ﬁrm i defaults, are uncorrelated with any other variables. The second,
perhaps more interesting case, is that the losses at ﬁrm i are random but are correlated
with the initial monetary reserves ϑi. The intuitive reasons are that if a ﬁrm has more
cash, then the default is less anticipated, and thus will be less priced in by the market;
or the ﬁrm has larger credit lines and so will default on a larger amount; and ﬁnally the
ﬁrm is likely to be larger, and hence cause a larger loss.

(9)

(10)

(11)

3. Heuristic Solution

In the present section we show that our model has a relatively simple solution that can be
obtained by qualitative probabilistic reasoning, appealing to statistical limit theorems.
This solution turns out to be exact, as we show using a more involved generating function
formalism in Appendix A. Both types of argument have been developed in the analysis
of the statistical mechanics of disordered systems, and in particular neural network
models [31], while for a more general introduction to emergent collective behaviour see
e.g.
[32]. Recall the microscopic dynamics as deﬁned by (2). The complications are
due to the interactions between ﬁrms, namely that the state of a given ﬁrm i at time t,
depends on the state of the neighbours of i for times t′ < t which in turn depend on i at
times t′′ < t′ < t. In general this feedback prohibits straightforward analysis, and indeed,
it led Jarrow and Yu [9] to eliminate this feedback explicitly by considering an economy
of two types of ﬁrms: primary ﬁrms whose default depended only on macro-economic
factors and secondary ﬁrms whose default depended on macro-economic factors and the

6
Eﬀects of Economic Interactions on Credit Risk

8

default of primary ﬁrms. However, due to the speciﬁc structure of our model we are
able to push the analysis further. By deﬁnition, the overall eﬀect of interaction terms
j Jijnjt. From the statistics of
on company i at time t is given by the local ﬁeld hit =
the interactions Jij given by (6)-(8) we see that each ﬁrm i is connected to, on average,
c other ﬁrms. Since we consider the large c limit, this means that we could evaluate the
statistics of hit by appeal to the law of large numbers and the central limit theorem if
the contributions to hit were independent, or at least suﬃciently weakly correlated.

P

At ﬁrst sight we cannot expect this condition to hold if we have some degree of
symmetry in the interactions, i.e. for α
= 0, even in the extremely diluted regime. Note
that there are two ways in which the njt of the neighbours interacting with i may become
correlated through the dynamics: either they inﬂuence each other through ﬁrm i, or not
through ﬁrm i but though some loop of interactions in the economy. In the extremely
diluted regime, correlations between the neighbours j of i cannot build up in ﬁnite time
(within the risk horizon) via loops not involving i, since due to the scaling almost all
loops are very long. With symmetry in the interactions, correlations between the njt
could in principle be induced by the dynamics of i. However, as long as nit = 0, the
njt clearly cannot inﬂuence each other through site i, whereas once nit = 1, then ﬁrm i
is in the absorbing state, and correlations it induces on the dynamics of its neighbours,
have become irrelevant for its own microscopic dynamics (2). Thus limit theorems can
be used after all to solve the macroscopic dynamics of the system, despite a possible
symmetry in the interactions.

Returning to the dynamical evolution equation (2), we observe that the coupling

of a node to the economy is via the local ﬁeld

hit =

Jijnjt =

cijnjt +

cijxijnjt ,

(12)

J0
c

Xj

J
√c

Xj

Xj

which is a sum of random quantities (with randomness both due to the Gaussian
ﬂuctuating forces (the
), and due to the heterogeneity of
the environment). The ﬁrst contribution is a sum of terms of non-vanishing average.
By the law of large numbers this sum converges to the sum of averages in the large c
limit,

, respectively the

ηit}

ξit}

{

{

h0
it ≡

J0
c

cijnjt →

J0
c

cijh

njti ≃

J0
c

Xj

Xj

cij h

njti

= J0

Xj

1
N

njti

Xj h

h

. . .
i

denote an average over the ﬂuctuating forces, and the
in which angled brackets
overbar (. . .) an average over the Jij, i.e., the cij and the xij. An approximation is
made by assuming negligible correlations between the cij and the
induced by the
heterogeneity of the interactions. The second contribution to (12) is a sum of random
variables with zero mean, which we have argued are suﬃciently weakly correlated for
the central limit theorem to apply for describing the statistics of their sum. Thus the
sum

njti

h

δhit ≡

J
√c

Xj

cijxijnjt

6
Eﬀects of Economic Interactions on Credit Risk

9

is a zero-mean Gaussian whose variance follows from
J 2
c
Xjk
= J 2 1
N

cijcikxijxikh

njtnkti ≃

(δhit)2

njti

=

i

h

J 2
c

Xjk

Xj h

cijcikxijxikh

njtnkti

An approximation based on assuming negligible correlations has been made as for the
ﬁrst contributions. Thus the local ﬁeld hit is a Gaussian with mean h0
it and variance
(δhit)2
both scaling with the average fraction of defaulted nodes in the economy. By the
h
law of large numbers this average fraction will be typically realized in a large economy,
i.e. we have

i

mt =

1
N

njt →

1
N

Xj

njti

Xj h

(13)

in the large N limit. The dynamics of the fraction of defaulted nodes then follows from
(2),

1
N

mt+1 =

hit −
where the one factor noise model (4) has been used.

nit+1 = mt +

nit)Θ

Xi

Xi

(1

−

(cid:16)

1
N

ϑi + √ρη0 +

ρ ξit

,

(14)

1
q

−

(cid:17)

The sum in (14) is evaluated as a sum of averages over joint nit, hit, and ξit
distribution by the law of large numbers. We exploit the fact that nit, ξit and hit
are uncorrelated. Noting that the sum hit + √1
ρ ξit is Gaussian with mean J0mt and
ρ + J 2mt, and taking into account that nit-averages, depend on i through
variance 1
−
nti(ϑi), we ﬁnd
niti
ϑi,
=
h
1
N

nti(ϑi)
− h
2

mt+1 = mt +

1 + erf

−



1





h

ϑi

J0mt + √ρ η0 −
−

ρ + J 2mt) 


2(1





q

Xi



This version can be understood as an average over the ϑ distribution

p(ϑ) =

1
N

δ(ϑ

ϑi) ,

−

Xi
which maps onto a distribution of unconditional default probabilities as discussed above.
Denoting that average by
iϑ we ﬁnally get the following evolution equation for the
macroscopic fraction of defaulted companies in the economy

. . .

h

mt+1 = mt +

1

nti(ϑ)
− h
2

*

1 + erf





ϑ

J0mt + √ρ η0 −
2(1
−

ρ + J 2mt) 






q



+



ϑ

(15)

We have thus an explicit dynamic equation for the macroscopic fraction of defaulted
nodes in the economy. It involves ﬁrst propagating ϑ-dependent default probabilities
via

nt+1i(ϑ) =

h

nti(ϑ) +

h

1

nti(ϑ)
− h
2

1 + erf

ϑ

J0mt + √ρ η0 −
2(1
−

ρ + J 2mt) 










q

,

(16)





Eﬀects of Economic Interactions on Credit Risk

10

which depends only on mt, thereafter performing an integral over the ϑ distribution to
obtain the updated fraction mt+1 of defaulted nodes given in (15).

The heuristic solution of the macroscopic dynamics (15), (16) presented here is
based on independence assumptions which are not easily justiﬁed in a rigorous way via
the probabilistic reasoning presented above. However, the solution is supported in full
detail by an exact analysis based on generating functions presented in Appendix A.

4. Results

In the present section we explore the consequences of our theory. We studied the
dynamics and computed loss distributions for an economy in which the parameters ϑi
determining unconditional monthly default probabilities according to (9) are normally
distributed with mean ϑ0 = 3, and variance σ2
ϑ = 0.01 so that typical monthly
4 range. Except when stated otherwise we shall
default probabilities are in the 5
use ρ = 0.15 for the parameter describing the relative importance of economy-wide
ﬂuctuations, a value that is considered to be in an economically acceptable range.

10−

×

In Fig 1a we show the evolution of the typical fraction of defaulted ﬁrms over a
risk horizon of 12 months for various settings of the interaction parameters J0 and J;
the typical fraction is computed by choosing the most-probable value η0 = 0 for the
economy-wide inﬂuence on the dynamics. Fig 1b shows the probability density of the
end of year fraction of defaulted ﬁrms driven by ﬂuctuations in economic conditions. It
is obvious that interactions cause a signiﬁcant fattening of the tail of the density at large
values of this fraction, which is a clear indication of the signiﬁcance of counter-party
risk in particular in situations of economic stress.

t

m

 0.014

 0.012

 0.01

 0.008

 0.006

 0.004

 0.002

 0

 0

)

2
1
m
(
p

 100

 10

 1

 0.1

 0.01

 0.001

-0.2

 2

 4

 8

 10

 12

 0

 0.2

 0.4

 0.6

 0.8

 1

 1.2

 6
t

m12

Figure 1. Left: Typical fraction of defaulted companies as a function of time for
(J0, J) = (0, 0), (1, 0), (0, 1), and (1,1) (bottom to top). Right: Distribution of the
fraction of defaulted companies at t = 12 for (J0, J) = (0, 0), and (1,1). Analytic
curves are overlaid with results of a simulation in which the distribution is obtained
by computing the fraction of defaulted companies for randomly sampled η0.

In order to assess whether interactions can lead to a collective acceleration of the

Eﬀects of Economic Interactions on Credit Risk

11

rate of defaults we look at the discrete second derivatives

∆t = mt+1 + mt

2mt

1 −

−

which are always negative for the non-interacting system and maximal at t = 1,
irrespectively of η0.
Interactions can lead to a collective acceleration of the rate of
defaults signiﬁed by the possibility that the ∆t may become positive in unfavourable
economic conditions. We deﬁne the region in parameter space in which collective
acceleration of default rates can occur by the condition that

(17)

Prob

∆t > 0

> 0

n

o

for some t, with 1 < t < 11. The concavity of the error function for positive arguments
entails that eﬀects of collective acceleration are always strongest at t = 1. Evaluating
this condition for various values of the parameter ρ describing the coupling to the overall
economy, we get lines shown in the phase diagram Fig 2a. Note that the inﬂuence of ρ
is very weak in interesting region of low ρ values. Note also that ∆1 values are typically
positive but very small in the region near the phase boundaries shown, as illustrated in
In Fig 2b where we exhibit the distribution of discrete second derivatives at t = 1, just
inside the phase where acceleration of default rates is observed. The tail of negative ∆1
is found to extend to signiﬁcantly larger values.

J

 0.4

 0.8

 0.7

 0.6

 0.5

 0.3

 0.2

 0.1

 0

 0

 100000

 10000

 1000

)
1
∆
(
p

 100

 10

 1

 0.1

 0.1

 0.2

 0.3

 0.5

 0.6

 0.7

 0.8

-0.0005

-0.0004

-0.0003

-0.0002

-0.0001

 0

 0.0001

 0.0002

∆1

 0.4
J0

Figure 2. Left: Phase boundaries separating regions without collective acceleration of
default rates from regions where acceleration occurs, for ρ = 0.15, 0.3 and 0.8 (bottom
to top). Distribution of discrete second derivative ∆1 = m2 + m0
2m1 just within
the phase with accelerating default rates for (J0, J) = (0.5, 0.5) (right).

−

The quantity of central importance from the point of view of credit risk analysis is
of course the distribution of losses. Let ℓi denote the loss that would be incurred by a
default of node i. Then the loss per node for a given state η0 of the economy is

L(η0) =

ni12ℓi

1
N

Xi

(18)

where ℓi is randomly sampled from the loss distribution for node i. We assume that
the ℓi are independent of the stochastic evolution. In the large system limit, the loss

Eﬀects of Economic Interactions on Credit Risk

per node at given value of η0 describing the inﬂuence of the overall economy is a non-
ﬂuctuating quantity, as it is itself an (empirical) average taken over an (inﬁnitely) large
system,

L(η0) = lim
→∞

N

n12(ϑi)ℓ(ϑi) =

dϑp(ϑ)

n12i(ϑ)ℓ(ϑ)

h

Z

1
N

Xi

by the law of large numbers, where ℓ = ℓ(ϑ) is the mean of the loss distribution for
a node. If loss distributions were identical for each node, with means independent of
default probabilities ℓ(ϑ) = ℓ0, then the distribution of losses driven by the ﬂuctuations
of the economic stresses would simply replicate the distribution of the fraction of
defaulted ﬁrms.

The situation is diﬀerent

loss-distributions are correlated with default
probabilities. As an example we consider the case where average losses are inversely
proportional to the unconditional default probabilities pd(ϑi) = pi introduced in (9).

if

ℓ(ϑ) =

ℓ0
ε + pd(ϑ)

with a parameter ε introduced as a regularizer to prevent divergence as pd →
0. That is, the contribution to the total losses incurred by defaulting ﬁrms with
diﬀerent unconditional default probabilities is approximately uniform over the default
probabilities. In our model we have

pd(ϑ) =

[1

erf(ϑ/√2)]

1
2

−

N

Fig. 3 shows loss distributions for such a situation. The analytic curves are computed
by noting that the losses per node are monotone increasing functions of η0 which is itself
(0, 1). Integrated loss distributions are thus simply obtained using error functions

1
2
where η0(L) is the η0-value giving rise to loss L per node. The probability density
function is obtained via a single numerical diﬀerentiation.

[1 + erf(η0(L)/√2)]

Prob[L(η0)

L] =

≤

It would be of some interest to know whether ﬁnite sample ﬂuctuations could
possibly upset the picture seen so far. To study this issue we look at the losses per
node of a ﬁnite sample randomly drawn from the nodes of a large economy,

LM (η0) =

n12(ϑi)ℓ(ϑi)

(22)

Writing this as

LM (η0) =

n12i(ϑ)ℓ(ϑ)

ϑ

E

M

Xi=1

M

1
M

1
M

+

h
Xi=1 D
M
1
M

h
Xi=1 (cid:16)
M

Xi=1 (cid:16)

+

1
M

n12i(ϑi)ℓ(ϑi)

−

n12i(ϑ)ℓ(ϑ)

h

D

ϑ

E

(cid:17)

= L(η0) + L2(η0,

n12(ϑi)ℓ(ϑi)

− h
) + L3(η0,

n12i(ϑi)ℓ(ϑi)
φit}
,
ϑi}

{

{

(cid:17)

)

ϑi}

{

12

(19)

(20)

(21)

(23)

Eﬀects of Economic Interactions on Credit Risk

13

)
L
(
P

 1

 0.1

 0.01

 0.001

 1e-04

 1e-05

 1e-06

 1e-07

-20

 0

 20

 40

 60

 100

 120

 140

 160

 180

 80
L

Figure 3. Loss-distribution per node for the inﬁnite system with ℓ(ϑ) = 1/(ε + pd(ϑ))
at ε = 0.005. Analytic curves are overlaid with simulation results. Lower curve:
non-interacting system, upper curve: interacting system with (J0, J) = (1, 1).

we see that it has three components. The ﬁrst is simply the expectation value describing
the loss per node at given η0 in an inﬁnite system, the third, L3 has zero mean and is
1 describing the noise
expected to be Gaussian at large M, with variance scaling as M −
ϑi}
, while the second,
induced ﬂuctuations about the average for a given collection of
1 at large M — describes
L2 — also a a zero mean Gaussian of variance scaling as M −
the ﬁnite sample ﬂuctuations of this average. Since the collection of
is ﬁxed,
these Gaussians are correlated for diﬀerent η0. While an analytic evaluation of the loss
distribution may still be feasible in principle, it would become very involved in practice.
An approximation to the ﬁnite size computation is obtained by assuming that losses
per node at given η0 are Normally distributed about their inﬁnite system η0-dependent
mean with [combining L2 and L3] variance (also η0-dependent)

ϑi}

{

{

σ2
M = M −

1

n12i(ϑ)ℓ2(ϑ)

h

 

D

ϑ −

h

D

E

n12(ϑ)

ℓ(ϑ)

i

,

2

ϑ!

E

(24)

which is an annealed approximation which ignores that the parameters of the individual
loss distributions of the nodes in question remain ﬁxed. The results of an evaluation
along this line are shown in Fig 4, using the scaling (20) of average losses used above;
the approximation suggests that ﬁnite size ﬂuctuations give rise to fatter tails in the
loss distributions, though the eﬀect is negligible in the interacting system except at the
extreme end of the loss distribution, and small but a bit more pronounced in the non-
interacting system. A comparison with a simulation shows that the eﬀects of ﬂuctuations
are slightly underestimated in our approximation. Note, however, that loan portfolios
of typical banks usually contain orders of magnitude more debtors than the M = 100
considered in the present example.

Let us ﬁnally look at the so-called Value at Risk in terms of which the capital buﬀer

that banks are required to hold to cover risk is often expressed. It is deﬁned as

VaRq = (Qq[L]

rT

) e−

L
i

− h

(25)

Eﬀects of Economic Interactions on Credit Risk

14

)

0
0
1
L
(
P

 
,
)
L
(
P

 1

 0.1

 0.01

 0.001

 1e-04

 1e-05

 1e-06

 1e-07

 1e-08

)

0
0
1
L
(
P

 
,
)
L
(
P

 1

 0.1

 0.01

 0.001

 1e-04

 1e-05

 1e-06

 1e-07

-20

 0

 20

 40

 60

 80

 100

 120

 140

 160

-20

 0

 20

 40

 60

 100

 120

 140

 160

 180

L, L100

 80
L, L100

Figure 4. Loss-distribution per node in the large system system limit with ℓ(ϑ) =
1/(ε + pd(ϑ)) at ε = 0.005 and for a ﬁnite sample of M = 100 companies randomly
taken from the ensemble. For the ﬁnite sample, individual loss distributions are taken
to be ﬂat in the range [0, 2ℓ(ϑ]. Right: The same analytic curves, overlaid with a
simulation result for the ﬁnite sample. Lower curves correspond in both cases to the
non-interacting system, upper curves to the interacting system with (J0, J) = (1, 1).

in which Qq[L] is the q-quantile of the loss distribution at time T , i.e. the loss that is
not exceeded with probability q

Prob(L

Qq[L]) = q ,

≤

h

L
i

is the average loss, and r denotes a risk free interest rate. To highlight
while
the eﬀects introduced by economic interactions we take the ratio of the value at risk
computed for economies with and without functional economic interactions VaR/VaR0,
both computed at conﬁdence level q = 0.999 as required by the Basel II regulations [2].
Taking this ratio also eliminates the dependence on the interest rate r.

h

/

L
i

In Fig 5 we display this ratio alongside with analogous ratios of average losses
L
i0 for comparison.
h
As perhaps may be anticipated in view of results displayed in Figs 3 and 4, the
Value at Risk is signiﬁcantly more sensitive to functional interactions in an economy,
than the average losses are. This is understandable, as VaR probes the tails of loss
distributions, while average losses will be determined mostly by typical results.

For the results displayed in Fig 5, unconditional default probabilities where not
adjusted with the strength of the interactions so as to keep the average annual default
probability constant.
In Fig 6, therefore, we take this extra step, displaying an
analogous ratio of the Value at Risk of interacting and non-interacting economies,
where now unconditional default probabilities in the interacting system are adjusted
in such a way that the average (interaction-renormalized) default probability stays
constant — at the level chosen for the non-interacting system. To keep matters simple,
a homogeneous portfolio, with ﬁrm-independent unconditional default probabilities
and ﬁrm independent average losses was chosen. Clearly the interaction-induced
enhancement of the Value at Risk is rather close to the corresponding enhancement

Eﬀects of Economic Interactions on Credit Risk

15

0
R
a
V
R
a
V

/

 
 

0
>
 
L
 
<
>
 
L
 
<

/

 1.5

 1.45

 1.4

 1.35

 1.3

 1.25

 1.2

 1.15

 1.1

 1.05

 1

 0.95

0
R
a
V
R
a
V

/

 
 

0
>
 
L
 
<
>
 
L
 
<

/

 1.7

 1.6

 1.5

 1.4

 1.3

 1.2

 1.1

 1

 0.9

 0

 0

 0.1

 0.2

 0.3

 0.4

 0.6

 0.7

 0.8

 0.9

 1

 0.1

 0.2

 0.3

 0.4

 0.6

 0.7

 0.8

 0.9

 1

 0.5
R

 0.5
R

0
R
a
V
R
a
V

/

 
 

0
>
 
L
 
<
>
 
L
 
<

/

 1.8

 1.7

 1.6

 1.5

 1.4

 1.3

 1.2

 1.1

 1

 0.9

 0

 0.1

 0.2

 0.3

 0.4

 0.6

 0.7

 0.8

 0.9

 1

 0.5
R

Figure 5. Ratio of Value at Risk for systems with and without functional interaction
as a function of the strength of the interaction (upper curves). The analogous ratio
for average losses is also shown in each case (lower curves). The curves shown in the
three ﬁgures are evaluated along straight lines in the J0
J plane, and the parameter
J 2
0 + J 2. The three ﬁgure correspond to
R measures a distance from the origin R =
the lines J0 = 0 (upper left), J = 0 (upper right) and J0/J = 1 (lower).

−

p

computed without adjustment of the unconditional default probabilities.

To summarize, the capital buﬀer that banks are required to hold according to
the Basel II regulations [2] to cover credit risk is signiﬁcantly underestimated when
interaction eﬀects in an economy are not taken into account. It is important to note
that this is true already in the regime in which interactions are too weak to cause an
overall acceleration of default rates, as can be seen by comparing the phase diagram
Fig. 2a with results for the Value at Risk displayed in Figs. 5 and 6.

5. Conclusion

In conclusion, we have studied the eﬀects of economic interactions on credit risks.
Though non-equilibrium initial conditions and the fact that the credit-risk problem
has an absorbing state would at ﬁrst sight appear to complicate the analysis, we found,
quite to our own surprise, that in particular the presence of the absorbing state simpliﬁes
the analysis considerably, as it removes the non-Markovian eﬀects in the macroscopic

Eﬀects of Economic Interactions on Credit Risk

16

0
R
a
V
R
a
V

/

 1.5

 1.45

 1.4

 1.35

 1.3

 1.25

 1.2

 1.15

 1.1

 1.05

 1

 0.95

 0

 0.1

 0.2

 0.3

 0.4

 0.6

 0.7

 0.8

 0.9

 1

 0.5
R

Figure 6. Value at Risk relative to Value at Risk in systems without functional
J 2
0 + J 2 of the interaction for J0/J = 1,
interaction as a function of the strength R =
with unconditional default probabilities in the interacting system adjusted as a function
of the strength R of the interaction to keep the annual average default probability
constant (in the present case at a value close to 3%.). As in Fig. 5, the VaR ratio is
computed at q = 0.999.

p

dynamics that would otherwise be present in systems with some degree of symmetry in
the interactions. While the limit of extreme dilution simpliﬁed the reasoning within the
heuristic solution, we saw in the generating function analysis that the assumption of
extreme dilution could be dispensed with. So although the rather heavy machinery of
non-equilibrium disordered systems theory is required to rigorously treat the model (due
to asymmetry in the inter-ﬁrm dependencies and the initial conditions), the resulting
eﬀective single-ﬁrm process is remarkably simple. This has obvious practical beneﬁts in
terms of computational eﬃciency.

We have seen that the eﬀects of economic interactions are relatively weak in typical
economic scenarios, but they are pronounced in situations of economic stress, and thus
lead to a substantial fattening of the tails of loss distributions in large loan portfolios.
This leads to signiﬁcant increases in the Value at Risk, i.e. the capital that must be
held as a loss buﬀer, when compared to the non-interacting theory. Importantly, this
conclusion remains valid even in the case where there is no overall acceleration in default
rates, c.f. Fig. 2a and Figs. 5 and 6.

It is worth paraphrasing these last observations as they address a point of key
importance. While credit risk models that do not take direct economic interactions
into account can provide a very reasonable ﬁt, when calibrated on historical data which
reﬂect normal economic conditions, their predictions would be entirely inadequate when
it comes to estimating default rates and losses in situations of signiﬁcant economic stress.
Note that the model presented here is suitable for detailed and comprehensive stress
testing, as explicitly demanded within the regulatory framework of the Basel II accord
[2]. The issue of stress testing was addressed in greater detail when the present model
was ﬁrst introduced in [21].

The patterns of economic interactions studied in the present paper are described

Eﬀects of Economic Interactions on Credit Risk

17

by an Erd¨os-R´enyi random graph. The large connectivity limit considered in the
present investigation further entails that there is no pronounced heterogeneity in the
sets of economic partners of any one given node. Connectivity distributions other than
Poisson can, however, be handled by suitably adapting the generating function approach
explained in Appendix A along the lines developed in [29], and will be investigated in
a separate publication [33]. In terms of model ﬁtting there appear to be a vast number
of free parameters in terms of the interactions
between ﬁrms. However, it is
important to realise that to understand the macroscopic behaviour, here only their low
order statistics are relevant.

Jij}

{

In the present investigation, we restricted ourselves to analysing the eﬀects of
interactions on default-dynamics and, via default rates, on loss distributions. More
subtle eﬀects such as credit-quality migration are, as yet, not taken into account, but
could be modelled along similar lines using the dynamics of interacting multi-state
indicator variables. Further assumptions concerning details of such models would be
required, however, and the full complexity of non-Markovian dynamics would resurface
in such an analysis.

Appendix A. Generating Function Analysis

In this appendix we describe the generating function approach (GFA) to solve our model,
giving full justiﬁcation to the arguments used in section 3. The reasoning is relatively
standard; we include it here to make the paper reasonably self-contained

Appendix A.1. The Generating Function for Correlation Functions

First we introduce the generating function at ﬁxed value of the macro-economic force
η0,

where the angled brackets denote averages over the microscopic dynamics (2) of ni, i.e.

Z[ψ

η0] =

i

e−

12
t=0

ψitnit

i

(cid:28)

P

P

(cid:29)

|

|

Z[ψ

η0] =

P [n0, . . . , n12]e−

i

12
t=0

ψitnit ,

i

n0,...,n12
X

P

P

with P [n0, . . . , n12] denoting the probability of a sequence of conﬁgurations of the entire
set of interacting ﬁrms over the risk period of 12 months. The generating function can
be used to compute expectation values and correlation functions via diﬀerentiations
with respect to the source ﬁelds ψit,

niti

h

= i

η0]

∂Z[ψ
|
∂ψit

,

nisnjti

h

ψ

0

≡

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= i2 ∂2Z[ψ

η0]
|
∂ψis∂ψjt (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ψ

0

≡

It is expected that correlation functions averaged over the randomness in the couplings
Jij are dominated by typical realizations of the disorder, hence to describe typical results
an average of the generating function over the disorder,

(A.1)

(A.2)

(A.3)

Z[ψ

η0] =

|

dP (Jij, Jji) Z[ψ

η0]

|

Z Yi<j

Eﬀects of Economic Interactions on Credit Risk

18

is computed.

To proceed, the path-probability P [n0, . . . , n12] at given η0 is expressed in terms of

transition probabilities of the Markovian dynamics,

P [n0, . . . , n12] = P (n0)

11

t=0
Y

P (nt+1|

nt) ,

where

with

P (nt+1|

nt) =

dξit
√2π

1
2

e−

P

Yi Z

ξ2
itδnit+1,fit

i

(A.4)

(A.5)

(A.7)

fit = nit + (1

nit)Θ

Jijnjt +

−





Xj

1
q

ρ ξit + √ρ η0 −

−

ϑi


The ξit integrations appearing in the transition probabilities and the average over the
Jij distribution are facilitated by utilizing δ-distributions to ‘extract’ the ξit and the Jij
from the Heaviside function in fit, using

1 =

duit δ

Z

uit −

 

Xj

Jijnjt −

1
q

−

ρ ξit

=

!

Z

duitdˆuit
2π

e−

(cid:16)

P

iˆuit

uit

−

j

Jijnjt

√1

ρ ξit

−

−

.

(cid:17)

This gives

with now

P (nt+1|

nt) =

Z Yi

duitdˆuit
2π

e
P

i

−
h

1−ρ
2 ˆu2

it−

iˆuit

uit

−

Jijnjt

j

(cid:16)

P

(cid:17)i

Yi

δnit+1,fit

(A.6)

fit = nit + (1

nit)Θ (uit + √ρ η0 −

−

ϑi)

Inserting into the generating function, we get

Z[ψ

η0] =

|

P (n0)

n0,...,n12
X

Z Yit

duitdˆuit
2π

exp

1

ρ

−
2

ˆ(iuit)2

iˆuit

uit −

 

−

Jijnjt

iψitnit

! −

δnit+1,fit

Xj

(

Xit "

#


Yit



The disorder average aﬀects the Jij; it factorises in the pairs (i, j) and involves the term

Dij =

exp

i

(

Yi<j

t (cid:16)
X

Y(i,j)

ˆuitJijnjt + ˆujtJjinit

Here the superscripts c and x indicate averages over the cij and the xij in the Jij
according to the statistics (6)-(8). Performing the cij average, one gets

Dij =

1 +

exp

c
N "

J0
c

+

J
√c

xij

( 

iˆuitnjt

!

t
X

Y(i,j)

Yi<j






+

J0
c

 

+

J
√c

xji

iˆujtnit

1

#

) −

!

t
X

c,x

)

(cid:17)

x






Eﬀects of Economic Interactions on Credit Risk

19

The exponential is expanded using c
re-exponentiating the result one obtains

≫

1. Using (8), keeping dominant terms and

Dij ≃

Y(i,j)










t
X

which depends only on the macro-variables

exp

N

J0

ktmt +

Qstqst + αGstGts

i










J 2
2

s,t h
X

1
N

Xi
1
N

Xi

kt =

iˆuit

, mt =

nit

(A.8)

1
N

Xi
1
N

Xi

exp

J 2
2

(

Xit "

s,t h
X

1
N

Xi

#


i

Yit

Qst =

iˆuisiˆuit ,

qst =

nisnit , Gst =

iˆuisnit .

(A.9)

We thus have

Z[ψ

η0] =

|

P (n0)

n0,...,n12
X

Z Yit

duitdˆuit
2π

1

ρ

−
2

ˆ(iuit)2

iˆuituit −

−

iψitnit

#

+N

J0

"

t
X

ktmt +

Qstqst + αGstGts

δnit+1,fit

Site factorisation in Z[ψ
macro-variables, using δ-function identities of the form

|

η0] is achieved as usual by writing it as an integral over the



1 =

d(Nmt) δ

Z

Nmt −

 

njt

=

!

Z

Xj

dmtd ˆmt
2π/N

i ˆmt
e

(cid:16)

N mt

−

njt

j

P

(cid:17)

and analogous ones for the kt, qst, Qst, and the Gst to compute densities of state. This
results in the following compact expression for the average generating function

Z[ψ

η0] =

exp

. . .
}

N[Φ + Ψ + Ξ]
}

Z D{

|
in which
stands for an diﬀerentials of all order parameters introduced in (A.8),
(A.9) and their conjugate (hatted) parameters introduced via Fourier-representations of
δ-functions. The functions Φ, Ψ, and Ξ appearing in (A.10) are given by

. . .
}

D{

{

(A.10)

J 2
2

Φ = J0

ktmt +

Qstqst + αGstGts

t
s,t h
X
X
[ ˆmtmt + ˆktkt] + i

Ψ = i

i
[ˆqstqst + ˆQstQst + ˆGstGst]

(A.11)

(A.12)

t
X
1
N

Ξ =

log

st
X
dˆutdut
2π

t
Z Y
Xi
denoting the ‘dynamic action’

nt
X{
}

exp

  − S −

i

ψitnt

δnt+1,fit .(A.13)

t
X

!

t
Y

with

S

=

S

1

ρ

−
2

t "−
X

(iˆut)2+iˆutut+i ˆmtnt+iˆktiˆut

+i

ˆqstnsnt+ ˆQstiˆusiˆut+ ˆGstiˆusnt

(A.14)
#

#

st "
X

The third contribution, Ξ, in (A.10) describes an ensemble of independent single site
dynamical problems. Thus, to leading order in N we have written our generating
function in terms of an integral which may be computed via a saddle point argument.

Eﬀects of Economic Interactions on Credit Risk

20

Appendix A.2. Saddle Point Problem

In the saddle-point, variation of our observables gives

iˆkt =

−
i ˆQst =

J0mt
J 2
2

−

qst

i ˆGst =

αJ 2Gts

−

i ˆmt =

iˆqst =

J0kt
J 2
2

−

−

Qst

mt =

qst =

Gst =

1
N
1
N
1
N

Xi h

Xi h

Xi h

nti(i)

kt =

nsnti(i) Qst =

1
N
1
N

iˆuti(i)

Xi h

iˆusiˆuti(i)

Xi h

iˆusnti(i)

(A.15)

(A.16)

(A.17)

(A.18)

(A.19)

with

. . .

h

i(i) denoting averages evaluated wrt eﬀective single site dynamics at i.
(. . .) exp

t δnt+1,fit

t

. . .

i(i) =

h

P

nt
{

}

R Q
nt
}
{

dˆutdut
2π
dˆutdut
2π

t

exp

− S

(cid:16)
− S

(cid:16)

(cid:17) Q

(cid:17) Q
t δnt+1,fit

P

R Q

In the usual manner [30] averages involving conjugate ﬁelds iˆut describe response
functions, i.e. perturbations of expectation values wrt external ﬁelds, so that averages
involving nothing but conjugate variables correspond to perturbations of a constant and
will therefore vanish. Moreover, causality implies that Gst, which describes the response
of the average fraction of defaulted companies to at time t to perturbations at time s
must vanish for s
t. At the saddle point, therefore, we have kt ≡
0,
iˆqst ≡

With these observations we ﬁnd that the functions Φ and Ψ appearing in the average

t, thus i ˆGst = 0 for s

0, and Gst = 0 for s

0, i ˆmt ≡

0, Qst ≡

≥

≥

≤

t.

generating function (A.10) are zero at the saddle point,

Φ = 0 ,

Ψ = 0 ,

(A.20)

and the dynamic action

of (A.14) simpliﬁes to

S
ρ)δst + J 2qst

1
2

−

=

S

(1

−

st h
X

t
X
With this form of the dynamic action the system-dynamics is described by an ensemble
independent eﬀective single-node stochastic process of the form

s<t
X

i

iˆusiˆut +

iˆut

ut −

J0mt −

 

αJ 2

Gstns

!

(A.21)

nt+1 = fϑt ≡

nt + (1

nt)Θ

J0mt + αJ 2

−

 

Gstns + √ρη0 −

ϑ + φt

!

(A.22)

s<t
X

the details of which are self-consistently speciﬁed by macroscopic properties of the
system via the saddle point equations, in that each single site process (i) depends on the
dynamics of the macroscopic fraction of defaulted nodes mt, (ii) the original Gaussian
white noise is replaced by a coloured Gaussian noise φt with correlations depending on
qst

= 0 ,

φti

h

φsφti

h

= (1

−

ρ)δst + J 2qst ,

Eﬀects of Economic Interactions on Credit Risk

21

and (iii) a memory term appears in the dynamics, if there is some degree of symmetry
in the interactions, i.e. if α

= 0.

The only site-dependence in the averages

i(i) appearing the ﬁxed point equations
(A.16) - (A.18) comes from the ϑi dependence in the update rules fit. By the law of
large numbers, the sums can therefore be evaluated as an average over the ϑ-distribution
in the large N limit

. . .

h

1
N

. . .

i(i) −→ Z

Xi h

dϑp(ϑ)

. . .

h

i(ϑ) ≡

. . .

h

D

i(ϑ)

ϑ

E

. . .

in which
i(ϑ) has the same structure as (A.19), except for the fact that the dynamical
constraints fit of (A.7) are replaced by the fϑt of (A.22). The saddle point equations
thus take the form

h

mt =

nti(ϑ)

h

D

ϑ

E

, qst =

nsnti(ϑ)

h

D

ϑ

E

, Gst =

iˆusnti(ϑ)

h

D

ϑ

E

Appendix A.3. Simpliﬁcation of the Single Node Equation

The single node equation (A.22) is complicated by the fact that it is non-Markovian,
containing a correlation function coupled to the noise term qst and a retarded self-
interaction Gst. This latter term encodes the physics that a ﬁrms performance at time
t is inﬂuence by its neighbours, themselves dependent on the ﬁrm itself at times s < t,
via loops in our network of corporate interactions — in particular short loops arising
through correlated bi-directional interactions. However, as we argued in section 3, if a
ﬁrm is bankrupt at time s then the performance of partner ﬁrms at time t is irrelevant,
since the ﬁrm will still be bankrupt. In the alternative case when the ﬁrm is solvent at
time t, it is clear from the deﬁnitions in the dynamics that it must have been solvent
at time s < t and thus cannot have aﬀected its partner terms at that time. Thus, the
retarded self-interaction is zero.

There is a second simplifying feature in (A.22) related to the statistics of the
coloured noise within our system. On multiplying (A.22) on both sides by ns with
s < t and and ﬁrst averaging over the noise φt = (φ1, φ2, . . . , φt) one ﬁnds
nsnti(ϑ) =
nmin(s,t)i(ϑ) at ﬁxed ϑ, since if ns = 1, then nt = 1 due to the absorbing nature of the
h
defaulted state, whereas if ns = 0, so is the product nsnt, irrespectively of nt. As a
consequence we have qst = mmin(s,t), and thus

h

φsφti

h

= (1

−

ρ)δst + J 2ms ,

s

t ,

≤

(A.23)

Having seen that the memory term in the dynamics vanishes, it transpires that only the
ρ+J 2mt is required to propagate
φtφti
equal-time version of the noise correlation
the order parameter mt. One needs

= 1

−

h

mt+1 =

nt+1i(ϑ)

h

ϑ
E

(cid:28)D
D
In order to evaluate the average
i(ϑ) over the correlated noise in the second term,
convert the probability density p(φt) = p(φ1, φ2, . . . , φt) into p(nt, φt) — the joint

. . .

E

h

= mt +

(1

nt)Θ(J0mt + √ρη0 −

−

ϑ + φt)

(ϑ)

(cid:29)ϑ

6
Eﬀects of Economic Interactions on Credit Risk

22

probability density that the node-variable takes value nt (nt = 0 or nt = 1) and the
noise variable at time t is in an inﬁnitesimal interval around φt; formally one can write
this as

p(nt, φt) =

dφt
−

1p(φt)δnt,nt(ϑ,φt−1) =

dφt
−

1p(φt
−

1, φt)δnt,nt(ϑ,φt−1)

Z

Z

where nt(ϑ, φt
−
noise history φt
−

1) is the value of nt for the speciﬁc ϑ under consideration, and a given

1. Writing the joint probability in terms of a conditional as

p(nt, φt) = p(nt|

φt)p(φt) ,

→

(2000)

and noting that p(nt|
ﬁnally using

φt) must be independent of the conditioning by causality, and

for a given ϑ one ﬁnally obtains

p(nt) =

nti(ϑ)δnt,1 +

h

1

nti(ϑ)

− h

(cid:16)

δnt,0
(cid:17)

mt+1 =

nt+1i(ϑ)

h
D

ϑ

E

= mt +

1

nti(ϑ)
− h
2



*

1 + erf



ϑ

J0mt + √ρ η0 −
2(1
−

ρ + J 2mt) 




+

ϑ

(A.24)


which agrees with the result of our heuristic reasoning in Sec 3. Note that the condition
c/N

0 is not needed in the present argument.

q





Acknowledgements It is a pleasure to thank Peter Neu for valuable discussions

on a range of problems dealt with in the present contribution.

[1] S. Keenan, Historical default rates of corporate bond issues, 1920-2000, Moody’s Investor Services,

[2] Basel Committee on Banking Supervision, International Convergence of Capital Measurement and
Capital Standards A Revised Framework, URL: http://www.bis.org, Basel (Nov 2005).
[3] J.P. Morgan Global Research, CreditMetricsTM: The Benchmark for Understanding Credit Risk,

Technical Document, URL: www.creditmetrics.com, New York (1997).

[4] Credit Suisse First Boston, Credit Risk+: A Credit Risk Management Framework, Technical

Document, URL: www.csfb.com/creditrisk, New York (1997).

[5] S. Kealhofer, Portfolio Management of Default Risk, Net Exposure, Vol. 1 (2),

(1998);
KMV Corporation, Credit MonitorTM and Portfolio ManagerTM, New York, (1996), URL:
www.KMV.com; O. A. Vasicek, The loan Loss Distribution, Technical Report, KMV Corporation
(1997).

[6] M. Davis and V. Lo, Infectious Defaults, Quantitative Finance 1, p. 382-387 (2001); Modelling
Default Correlation in Bond Portfolios, in Mastering Risk Volume 2: Applications, ed. Carol
Alexander, Financial Times Prentice Hall, p. 141-151 (2001); M. Crowder, M. Davis and G.
Giampieri, A Hidden Markov Model of default interaction, Quantitative Finance 5, p. 27-34,
(2005).

[7] D. Lando On Cox processes and credit risky securities, Rev. Derivatives Res. 2, p. 99-120, (1998)
[8] D. Duﬃe and K. Singleton Modelling term structures of defaultable bonds Rev. Financial Stud. 12,

p. 687-720, (1999)

[9] R. Jarrow and F. Yu, Counter-party Risk and the Pricing of Defaultable Securities, Journal of
Finance 56, p. 1765 (2001); F. Yu, Correlated Defaults in Intensity Based Models Mathematical
Finance (to appear).

Eﬀects of Economic Interactions on Credit Risk

23

[10] E. Rogge and P. Sch¨onbucher, Modelling Dynamic Portfolio Credit Risk, Working Paper, Imperial
College, London, ABN Amro Bank, London, and ETH, Z¨urich (February 2003); P. Sch¨onbucher
and D. Schubert Copula-dependent Default Risk in Intensity Models Working Paper, Department
of Statistics, Bonn University, (2001).

[11] F. Yu, R. Jarrow and D. Lando, Default Risk and Diversiﬁcation: Theory and Empirical

Implications Mathematical Finance 15(1), p. 1-26, (2005).

[12] S. R. Das, D. Duﬃe and N. Kapadia, Common Failings: How Corporate Defaults are Correlated,
Working Paper, Santa Clara University, Stanford University, University of Massachusetts,
(February 2005).

[13] F. Yu, Default Correlation in Reduced-Form Models, Journal of Investment Management, 3(4), p.

33-42, (2005).

[14] D. Duﬃe and K. Singleton Simulating Correlated Defaults Working Paper, Graduate School of

Business, Stanford University, (May 1999)

[15] K. Giesecke, A simple exponential model for dependent defaults, Journal of Fixed Income, 13(3),
74-83, (2003); K. Giesecke , Successive Correlated Defaults: Pricing Trends and Simulations ,
Computing in Economics and Finance No 247, Society for Computational Economics, (2003).

[16] K. Giesecke and S. Weber, Credit Contagion and Aggregate Losses, Journal of Economic Dynamics
and Control (to appear), K. Giesecke and S. Weber, Cyclical Correlation, Credit Contagion and
Portfolio Losses,Journal of Banking and Finance 28(12), p. 3009-3036, (2004).

[17] D. Tasche and U. Theiler, Calculating Concentration-Sensitive Capital with Conditional Value-at-
Risk, in Operations Research 2003, D. Ahr, R. Fahrion, M. Oswald, G. Reinelt (eds.) Springer,
p. 261-268, (2004).

[18] D. Egloﬀ, M. Leippold, and P. Vanini, A Simple Model of Credit Contagion, EFA 2004 Maastricht

Meetings Paper No. 1142, (January 2, 2004).

[19] M. B. Gordy, A Comparative Anatomy of Credit Risk Models, Journal of Banking and Finance,

Vol. 24, p. 119-149 (2000).

[20] M. B. Gordy, A Risk-Factor Model Foundation for Ratings-Based Capital Rules, Journal of

Financial Intermediation , Vol. 12(3), p. 199-232 (2002).

[21] P. Neu and R. K¨uhn, Credit risk Enhancement in a Network of Interdependent Firms, Physica A

[22] R. Merton, On the Pricing of Corporate Debt: The Risk Structure of Interest Rates, Journal of

342, 639–655 (2004)

Finance, Vol. 29, p. 449-470 (1974).

[23] Ian Iscoe, Alex Kreinin and Dan Rosen, An Integrated Market and Credit Risk Portfolio Model,

Algorithmics Research Quarterly, Vol. 2 (3), p. 21-37 (September 1999).

[24] Moody’s Investment Services, The Binominal Expansion Technique, URL: www.moodys.com (1997).
[25] R. K¨uhn and P. Neu, Functional Correlation Approach to Operational Risk in Banking

Organizations, Physica A 322, 650–666 (2003).

[26] B. Bollob`as, Random Graphs, (Cambridge Univ. Press, Cambridge, 2001)
[27] A.L. Barab´asi and R. Albert, Emergence of Scaling in Random Networks, Science, 286, p. 509-
512, (1999); D.J. Watts and S.H. Strogarz Collective dynamics of ’small-world’ networks Nature,
393, p. 440-442 (1998).

[28] J.P.L. Hatchett, B. Wemmenhove, I P´erez Castillo, T. Nikoletopoulos, N.S. Skantzos and A.C.C.
Coolen, Parallel dynamics of disordered Ising spin systems on ﬁnitely connected random graphs J.
Phys. A: Math. Gen. 37, 6201-6220 (2004); I P´erez Castillo, B. Wemmenhove, J.P.L. Hatchett,
A.C.C. Coolen, N.S. Skantzos and T. Nikoletopoulos, Analytic Solution of Attractor Neural
Networks on Scale-Free Graphs, J. Phys. A: Math. Gen. 37, 8789–8799 (2004); T. Nikoletopoulos,
A.C.C. Coolen, I P´erez Castillo, N.S. Skantzos, J.P.L. Hatchett and B. Wemmenhove Replicated
transfer matrix analysis of Ising spin models on ’small world’ lattices J. Phys. A:Math. Gen.,
37, p. 6455-6475, (2004).

[29] J.P.L. Hatchett, Parallel dynamics of disordered Ising spin systems on random graphs, AIP Conf.

Proc. 776, 150, (2005);

Eﬀects of Economic Interactions on Credit Risk

24

[30] C. De Dominicis, Dynamics as Substitute for Replicas in Systems with Quenched Random

Impurities, Phys. Rev. B 18 4913-4919 (1978)

[31] B. Derrida, E. Gardner, A. Zippelius, An exactly solvable asymmetric neural network model
Europhys. Lett. 4, 167-173 (1987); R. Kree and A. Zippelius Asymmetrically diluted neural
networks in E. Domany, J. L. van Hemmen, and K. Schulten, K eds, Models of Neural Networks.
Springer, Berlin (1991); J.P.L. Hatchett and A. C. C. Coolen Asymmetrically extremely dilute
neural networks with Langevin dynamics and unconventional results J. Phys. A: Math. Gen. 37,
p. 7199-7212, (2004); T.L.H. Watkin and D. Sherrington A neural network with low symmetric
connectivity Europhys.Lett. 14, p. 791-796, (1991); T.L.H. Watkin D. and Sherrington The
parallel dynamics of a dilute symmetric Hebb-rule network J. Phys. A:Math. Gen. 24, p. 5427-
5433, (1991).

[32] L.E. Reichl, A Modern Course in Statistical Physics, Wiley-VCH (1998).
[33] K. Anand, J.P.L. Hatchett, and R. K¨uhn, work in progress (2005)

