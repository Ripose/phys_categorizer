5
0
0
2
 
g
u
A
 
2
2
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
9
5
1
8
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Dynamic instability in a simple model of correlated assets

Giacomo Raffaelli & Matteo Marsili
INFM-SISSA, via Beirut 2-4, Trieste I-34014, Italy and
Abdus Salam International Centre for Theoretical Physics
Strada Costiera 11, 34014 Trieste, Italy

Portfolio theory maintains that investment should be diversiﬁed across assets in order to minimize risk. If
investment has an impact on prices, it generates correlations between returns of assets, and hence modiﬁes the
risk measure which determines the optimal portfolio itself. Hence the correlations enter a feedback loop because
they are generated by the very same strategies devised to exploit them. We introduce a simple phenomenological
model which takes the impact of investment on the market explicitly into account. We show that the feedback
on correlations gives rise to an instability when the impact of optimal portfolio investors exceeds a critical
value. Close to the critical point, the model exhibits dynamical correlations very similar to those observed in
real markets. Indeed ﬁtting our model to real markets data, we ﬁnd parameters close to the critical point. These
results suggest that ﬁnancial markets cannot be regarded as frictionless systems and that there is a limit to the
amount of investment they are able to cope with.

Financial markets are prototype systems to investigate the
collective results of human interaction. Though they are ex-
tremely complicated systems, their aggregate behaviour ex-
hibits surprising regularities which can be cast in the form of
simple, yet non-trivial, statistical laws[1, 2, 3], and which are
extremely robust across types of markets (indices, single as-
sets or currencies) and countries [1, 2, 3]. This suggests that
the approach which has been so useful in unveiling statistical
laws in physics might also be helpful in understanding ﬁnan-
cial market ﬂuctuations [1, 8].

A key question is whether such “stylized facts” reﬂect
properties of the external factors which inﬂuence the mar-
ket – the news arrival process – or whether they emerge as
a consequence of the internal dynamics of the system. Re-
cent research on interacting agent models of ﬁnancial mar-
kets has shown that indeed anomalous price (or index of ex-
change rate) ﬂuctuations can indeed be generated by traders’
interaction[4, 5, 6, 7]. This approach allows us to relate
these properties to key features, such as for example the in-
terplay between trend followers and fundamental traders [5]
or the proximity to a critical point where the market becomes
(information-wise) efﬁcient [8].

The theoretical approach has, thus far, mostly concentrated
on single asset models, whereas empirical analysis has shown
that ensembles of assets exhibits rich and non-trivial statistical
properties. The central object of study is the covariance ma-
trix of asset returns (at the daily scale in most cases). The bulk
of its eigenvalue distribution is dominated by noise and de-
scribed very well by random matrix theory [9]. The few large
eigenvalues which leak out of the noise background contain
signiﬁcant information about market’s structure. The taxon-
omy built with different methods [10, 11, 12, 13] from ﬁnan-
cial correlations alone bear remarkable similarity with a clas-
siﬁcation in economic sectors. This agrees with the expecta-
tion that companies engaged in similar economic activities are
subject to the same “factors”, e.g. ﬂuctuations in prices or de-
mands of common inputs or outputs. Besides their structure,
market correlations also exhibit a highly non-trivial dynam-
ics: correlations “build up” as the time scale on which returns

are measured increases and saturate for returns on the scale
of some days [14, 15]. Furthermore, ﬁnancial correlations are
persistent over time [16] and they follow recurrent patterns
[13].

In what follows we shall mostly concentrate on the dynam-
ics of the largest eigenvalue of the correlation matrix. The
corresponding market mode [9] describes the co-movement
of stocks and it accounts for a signiﬁcant fraction of the
correlations[17]. Fig. 1a shows the time dependence of the
largest eigenvalue of (the exponentially averaged) correlation
matrix of daily returns for Toronto Stock Exchange [18]. Sim-
ilar behaviour has been reported earlier [19] for different mar-
kets. Fig. 2 shows that ﬂuctuations in the largest eigenvalue
are broadly distributed, suggesting that Fig. 1a can hardly be
explained entirely as the effect of few exogenous shocks.

This leads us to formulate the hypothesis that such non-
trivial dynamics arises as a consequence of the internal mar-
ket dynamics. One of the key functions of ﬁnancial markets
is indeed that of allowing companies to “trade” their risk for
return, by spreading it across ﬁnancial investors. Investors on
their side, diversify (i.e. spread) their strategies across stocks
so as to minimize risk, as postulated by portfolio optimiza-
tion theory [20, 21]. The efﬁciency of portfolio optimization
clearly depends on the cross correlations among the stocks the
ﬁnancial market is composed of. On the other hand, ﬁnancial
trading activity resulting from portfolio optimization strate-
gies itself contributes to the correlations it exploits. Hence
ﬁnancial correlations enter into a feedback loop because they
determine in part those trading strategies which contribute to
the price dynamics, i.e.
to the ﬁnancial correlations them-
selves. This feedback is somewhat implicit in the Capital As-
set Pricing Model (CAPM), which concludes that since all
traders invest according to the optimal portfolio, the market
is well approximated by a one factor model [20] (see however
[22]). While this explains why the largest eigenvalue of the
correlation matrix is so well separated from the other ones,
CAPM relies on rational expectation equilibrium arguments,
and it does not address dynamical effects such as those of Fig.
1a.

Λ

Λ

 0.05

 0.04

 0.03

 0.02

 0.01

 0
 0.04
 0.03
 0.02
 0.01
 0

a

b

 0

 400

 800

 1200

 1600

t

FIG. 1: Maximum eigenvalue of the correlation matrix as a function
of time for τ = 50. a) Toronto Stock exchange [18]. Here the corre-
lation matrix is obtained using Eqs.(4) and (5) with |δxti taken from
−2,
historical data. b) simulation of Eq.(1) with N = 20, R = 10
−1,W = 1.4. Components of |bi
B = 10
where generated uniformly in the interval [0, 2 · 10−3], resulting in
W ∗

−6,∆ = 0.04,ǫ = 10

≈ 1.41.

The purpose of this paper is to show, by resorting to a sim-
ple model, that a non-trivial dynamics of correlations can in-
deed result from the internal dynamics of a ﬁnancial market
were agents follow optimal portfolio strategies. This, how-
ever, occurs only close to a critical point where a dynamic
instability occurs. Not only we ﬁnd very realistic dynamics of
correlations close to the critical point (see Fig. 1b) but maxi-
mum likelyhood parameter estimation from real data suggest
that markets are indeed close to the instability.

Modeling such a complex systems as a ﬁnancial market in-
evitably implies dealing with many complications. Our aim
here is to focus on the ﬁnancial market as an interacting sys-
tem, trying to capture in a simple but yet plausible way the
interaction among assets, and the resulting correlations in-
duced by portfolio investment[23]. Hence we assume there
is a component of trading activity due to investors who fol-
low Markovitz’s optimal portfolio strategy, and we will rely
on very rough approximations: we shall assume that i) all in-
vestors have the same trading horizon, that ii) they use his-
torical data to estimate correlations and expected returns and
ﬁnally iii) we shall postulate a simple linear impact function
for the price dynamics. Portfolio investment is, in principle,
based on expected returns and covariances which may be dif-
ferent from the historical ones and different from trader to
trader, also because traders may have different time horizons.
Hence, we assume that historical data can be used as a proxy
for expected correlations and returns and that portfolio invest-
ment is dominated by a single time scale. Finally, price im-
pacts depends on the speciﬁc market mechanism. While at
high frequency we know it is not linear [24], a linear form can
be justiﬁed for daily returns [25].

Let us consider a set of N assets. We denote by |xi the
vector of log-prices and use bra-ket notation [26]. We focus on

2

daily time-scale and assume that |xti undergoes the dynamics

|xt+1i = |xti + |βti + ξt|zti.

(1)

where |βti is the vector of bare returns, i.e. it describes the
fundamental economic processes which drive the prices. This
is assumed to be a Gaussian random vector with

E[|βti] = |bi, E[|βtihβ(t′)|] = |bihb| + ˆBδt,t′

(2)

|bi and ˆB will be considered as parameters in what follows.

The last term of Eq. (1) describes the feedback of portfo-
lio investment on the price dynamics. Here ξt is an indepen-
dent Gaussian variable with mean ǫ and variance ∆, which
describes the impact of optimal portfolio investors. The vec-
tor |zti is the optimal portfolio with ﬁxed return R and total
wealth hz|1i = W . In other words, |zti is the solution of

min
|zi,ν,σ

1
2

(cid:20)

hz| ˆCt|zi − ν (hz|rti − R) − σ (hz|1i − W )

(3)

(cid:21)

where ˆCt is the correlation matrix at time t. Both the expected
returns |rti and the correlation matrix ˆCt, which enter Eq. (3),
are computed from historical data over a characteristic time τ :

|rti = (e

1
τ − 1)

t−t′
τ

e−

|δxti

(4)

ˆCt = (e

1
τ − 1)

t−t′
τ

e−

|δxtihδxt| − |rtihrt|

(5)

t′<t
X

t′<t
X

where |δxti ≡ |xti − |xt − 1i. This makes the set of equa-
tions above a self-contained dynamical stochastic system. In
a nutshell, it describes a simple way in which the economic
bare correlated ﬂuctuations |βti are dressed by the actions of
different ﬁnancial investors.

Eq.

(1) can be thought of as the lowest order of a phe-
nomenological equation, similar to Landau’s theory of critical
phenomena [27]. Higher orders, e.g.
|zt+1i − |zti, will in
principle be present, but we assume that their effect is small.
In principle, one can consider several component |zk
t i of port-
folio investors, each with a different parameters Rk, ǫk and
∆k. However, it can be shown that this problem is under gen-
eral assumptions equivalent to the one above, with effective
parameters ˜R, ˜ǫ and ˜∆. Notice ﬁnally that |zti is a quantity,
not a percentage as in portfolio theory [20, 21]. This choice
is however immaterial for the following results and it will be
convenient for our discussion.

Numerical simulations of the model show a very interesting
behaviour. In Fig 1b we plot the temporal evolution of the
maximum eigenvalue of the correlation matrix for a particular
choice of parameters (see later). The dynamics is highly non-
trivial, with the appearance of instabilities resembling those
observed for real markets (Fig. 1a). To be more precise, we

also analyze the statistics of the day-to-day differences in Λ.
In Fig. 2 we can see a clear power-law behaviour emerging,
again very similar to the one we get for real markets.

In order to shed light on these ﬁndings, let us consider the
behaviour of the model in the limit τ → ∞. We assume
that, in the stationary state[28], the correlations and hence |zti
reach a time independent limit, which by Eqs. (1, 3) is given
by

|zi =

1
ˆC − νǫ

|qi

(6)

(7)

where |qi = ν|bi + σ|1i, and σ and ν are ﬁxed by the
constraints hz|1i = W and hz|ri = R (notice that |ri =
E[|δxi] = |bi+ǫ|zi needs to be determined self-consistently).
The matrix ˆC = E[|δxihδx|] − |rihr| is then be given by

ˆC = ˆB + ∆

1
ˆC − νǫ

|qihq|

1
ˆC − νǫ

The solution to this equation yields ˆC as a function of the bare
covariance matrix ˆB. In order to make the following analysis
simpler, we shall assume structure-less bare correlations ˆB =
B ˆI. Hence ˆC will have N − 1 eigenvalues equal to B, and
one eigenvalue with eigenvector parallel to |zi, whose value
is[29]

Λ = B +

∆hb|bi
ǫ2

γ2
2

+

ǫR
hb|bi

−

hb|1iǫW
N hb|bi

(8)

(cid:26)

γ
2 s

−

1 +

4ǫR
hb|bi

−

(hb|1i − 2ǫW )2
N hb|bi

)

p

1 − hb|1i2/(N hb|bi). Notice that, hb|1i/N is
where γ =
the average bare return and, if total return R and portfolio in-
vestment W are both proportional to N , then the contribution
to Λ due to portfolio investment is also proportional to N .
This is indeed the order of Λ in empirical data. Most remark-
ably, Eq. (8) makes sense only for W < W ∗ where

As W → W ∗ the solution develops a singularity with inﬁnite
slope ∂Λ
∂W → ∞. This is reminiscent of the divergence of
susceptibility χ close to a phase transition, signalling that the
response δΛ = χδW to a small perturbation δW diverges as
W → W ∗. The analytic approach can be extended to ﬁnite
τ by a systematic 1/τ expansion in the W < W ∗ phase. We
will report elsewhere about it [30].

Numerical simulations show that W ∗ represents a thresh-
old to the amount of wealth that can be invested by risk-
minimization into a market without destabilizing it. This is
clearly seen in Fig. 3 where we report the relative ﬂuctuations
of Λt as a function of W , for simulations carried out at dif-
ferent time scales τ . For W < W ∗, ﬂuctuations vanish in the
limit τ → ∞ and Λ converges to the value of Eq. (8). For

3

W > W ∗, instead, the dynamics is characterized by persis-
tent instabilities with ﬂuctuations of the same order of Λ, and
it does not attain a smooth limit as τ → ∞. Fig. 1b shows
that the time series obtained in simulations for W smaller but
close to W ∗ exhibit strong ﬂuctuations, precursors of the in-
stabilities for W > W ∗.

The presence of a phase transition from a stable to an un-
stable state and the strong resemblance of the dynamics of the
model close to criticality with real data (see Fig. 1) suggests
that real markets might be close to the phase transition. In
order to investigate this issue systematically, we estimate the
parameters of our model from real data. In doing this we im-
plicitly assume that parameters ǫ, R, W etc. vary slowly on
time scales of order τ . We compute the likelihood that the
particular set of time series of a given market are produced
as output of Eq.(1) for a particular choice of parameters. Next
we ﬁnd the parameters which maximize the likelihood (details
will be given elsewhere).As a check, the procedure was run on
synthetic data set generated by Eq. (1) and it allowed us to re-
cover the parameters with which the data set was created.

In the inset of Fig.2 we plot the result of such a ﬁt for (the
assets of) four different indices in the time period 1997-2005
[18]. We used τ = 50 and ﬁts were taken on a time window
of T = 250 days. Notice, in this respect, that while in our
model τ enters both in the dynamics and in the way we take
averages, in the empirical analysis it only enters in the way
we take averages, whereas we don’t have access to the time
scale τ used by investors. We checked that the main results do
not depend signiﬁcantly on the choice of τ . We see that ﬁtted
parameters for real markets tend to cluster close, but below,
the transition line W = W ∗. This is also consistent with the
similarity of the distribution of Λ for real and synthetic data
of Fig. 2.

 0.1

 0.001

 0.6

 0.4

ω

 0.2

 0

Λ

 1e-10  1e-08  1e-06  1e-04

 0.01

 1

FIG. 2: Cumulative distribution of the day-to day change in the max-
imum eigenvalue for different indices: DAX (+), TSX(⋆), DOW((cid:3)),
ASX(×). Also shown is the same distribution for a numerical sim-
ulation of the model with N = 20, ǫ = 0.1, R = 1, W = 14.7,
−2,τ = 100. In the inset we show the results of the
∆ = 1,B = 10
ﬁtting procedure on these indices (same symbols).

W ∗ =

N
2ǫ "r

hb|bi + 4ǫR
N

+

hb|1i
N #

.

(9)

)

Λ
P

(

 0.01

ω

c

 0

 0.2

 0.4

 0.6

Λ
/
Λ
σ

 1

 0.1

 0.01

 0.001

 8

 10

 12

 16

 18

 20

 14

W

FIG. 3: Relative ﬂuctuation of the maximum eigenvalue as a function
of W in a simulation of the model with N = 20, ǫ = 0.1, R = 1,
−2,τ = 1000 (+), τ = 20000 (×) and τ = 50000
∆ = 1,B = 10
(⋆). Vertical line is the theoretical critical value of W .

In summary, we have studied a simple model of multi-asset
market which takes into account the feedback of correlations
due to risk minimization strategies. The model is very stylized
and misses many important aspects. Rather than insisting on
the validity of the approximations on a theoretical ground, we
have compared the main ﬁndings of the model with empirical
data from real ﬁnancial markets. Not only the model repro-
duces realistic time series of correlations, but it also predicts
that real markets are close to a phase transition.

This does not mean that external inﬂuences on the market
do not play any role. Indeed, the scatter of points in the inset
if Fig. 2 for the same market implies a time dependence of
the parameters that the model cannot explain. Furthermore,
it is undeniable that global events have an effect on ﬁnancial
markets (similar patterns in the dynamics of Λt for different
markets can indeed be found). Our point is that there is a
sizeable contribution to the collective behaviour of the market
which arises from its internal dynamics and which is a poten-
tial cause of instability.

Furthermore, the ﬁnding that real markets “self-organize”
close to a critical point where correlations become unstable
lends itself to a simple interpretation. As long as the impact
of risk minimization strategies is small, market correlations
are stable. This means that these strategies are reliable and
efﬁcient, which attracts even more investment on these strate-
gies (i.e. W increases). However, as W increases, the market
approaches the instability line, where correlations respond to
further investment, thus making risk minimization strategies
less efﬁcient. This suggests that W should self-organize close
to the critical value W ∗. Such a scenario is reminiscent of
the picture which Minority Games [8] provide of single asset
markets as systems close to a critical point. There speculators
are attracted by an information rich, predictable market which
gets less and less predictable because of the very impact of
their trading. This pushes the (Minority Game’s) market close

4

to the critical point where it becomes information-efﬁcient. It
is indeed exactly there that Minority Game models exhibit sta-
tistical properties very similar to those of real ﬁnancial mar-
kets [31].

Our ﬁndings provide a further example of a case where,
when the scale of human activity reaches a critical point, the
collective properties of the system change dramatically.
In
all these cases, the assumption that the individual intervention
has no impact on the aggregate – the so-called price taking be-
havior in markets – fails because the system reaches a point of
inﬁnite susceptibility. These problems naturally arise where
agents rely on the exploitation of a public good [32]. Their
appearance in ﬁnancial markets – the prototype examples of
perfect competition – is somewhat paradoxical.

[1] J.-P. Bouchaud and M. Potters Theory of ﬁnancial risk and
derivative pricing: from statistical physics to risk management
(Cambridge University Press, Cambridge, 2003).

[2] R. Mantegna and E. Stanley, Introduction to Econophysics

(Cambridge University Press, 1999)

[3] M. M. Dacorogna, et al. An Introduction to High-Frequency

Finance, Chap. V, Academic Press, London (2001)

[4] Caldarelli G., Marsili M. and Zhang Y-C., Europhys. Lett. 40,

479 (1997)

[5] Lux T. and Marchesi M. Nature 397 (6719) 498-500 (1999)
[6] R. Cont and J.-P. Bouchaud, Macroecon. Dyn. 4, 170 (2000).
[7] H. Levy, M. Levy, S. Solomon, From Investor Behaviour to

Market Phenomena, Academic Press, London (2000).

[8] Challet D., Marsili M. and Zhang Y-C. Minority Games. In-
teracting agents in ﬁnancial markets Oxford University Press
(Oxford, 2004)

[9] Laloux L, Cizeau P, Bouchaud JP, Potters M Phys. Rev. Lett. 83
(7) 1467-1470 (1999) and Plerou V, Gopikrishnan P, Rosenow
B, Amaral LAN, Stanley HE Phys. Rev. Lett. 83 (7) 1471-1474
(1999)

[10] Bonanno G, Caldarelli G, Lillo F, Mantegna RN, Phys. Rev. E

68 4, 046130 (2003)

[11] Plerou V, Gopikrishnan P, Rosenow B, Amaral N.A.N. and
Stanley H.E., Phys. Rev. Lett. 83 (7) 1471-1474 (1999).
[12] Giada L. and Marsili M. Phys. Rev. E 63 (6) 061101 (2001)
[13] Marsili M. Quant. Fin. 2 297-302 (2002)
[14] Kwapien J, Drodz S. and Speth J, Phys. A 330 (3-4) 605-621

(2003)

[15] Potters M. , Bouchaud J.P. and Laloux L., cond-mat/0507111
[16] Onnela JP, Chakraborti A, Kaski K, Kertesz J, Kanto A, Phys.

Rev. E 68 (5) 056110 (2003)

[17] The persistence of the structure of correlations [10, 16] and
their overlap with economic sectors [11, 12, 13] suggests that it
can be related to economic factors which evolve on long time
scales. Financial activity is instead relevant over time scales of
few days and it is responsible for the emergence of the market
mode.

[18] Data was taken form finance.yahoo.com in the time pe-
riod June 16th 1997 to May 25th 2005 for all assets except for
the Dow Jones, for which we used May 2nd 1995 to May 23rd
2005. Correlations were measured on the set of assets compos-
ing the index at the ﬁnal date.

[19] Drodz S, Kwapien J, Grummer F, Ruf F and Speth J, Phys. A

5

299 (1-2), 144-153 (2001) and Drodz S, Grummer F, Ruf F and
Speth J, Phys. A 294 (1-2), 226-234 (2001).

423 267-270 (2003) and Lillo F., Farmer J. D., Mantegna R. N.,
Nature 421 129-130 (2003).

[20] Elton E.J. and Gruber M.J., Modern Portfolio theory and invest-

[25] For a discussion see Farmer, J.D. Industrial and Corporate

ment analysis (J. Wiley & sons, New York, 1995).

Change 11(5) 895-953 (2002)

[21] Markovitz H., Portfolio Selection: Eﬁicient diversiﬁcation of

investments (J. Wiley & sons, New York, 1959).

[22] Bonanno G., Caldarelli G., Lillo F. and Mantegna R.N., Phys.

Rev. E 68 046130 (2003)

[23] Notice that simple, but ad hoc, behavioural assumptions (herd-
ing) leads naturally to the emergence of a market mode. Hence
a direct generalization of agent based models of single asset
markets [5, 8] might also produce a complex dynamics. These
models however focus on speculative trading where agents con-
cern is limited to expected return and miss the particular role
which risk and correlations play.

[24] Gabaix X., Gopikrishnan P., Plerou V., Stanley H. E., Nature

[26] |xi should be considered as a column vector, whereas hx| is a
row vector. Hence hx|yi is the scalar product and |xihy| is the
direct product, i.e. the matrix with entries ai,j = xiyj.

[27] Landau, L. Collected Papers of L. D. Landau (ed. ter Haar, D.)

193-216 (Pergamon, Oxford, 1965).

[28] The limit of inﬁnite time is taken before the limit τ → ∞.
[29] There are indeed two solutions for Λ. We choose the one for

which Λ → B as ǫ → 0.

[30] Raffaelli G. and Marsili M., in preparation.
[31] Challet D. and Marsili M. Phys. Rev. E 68 (3) 036132 (2003)
[32] Hardin, G., Science 162, 1243 (1968).

