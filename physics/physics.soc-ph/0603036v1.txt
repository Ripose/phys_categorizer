6
0
0
2
 
r
a

M
 
6
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
6
3
0
3
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Moody’s Correlated Binomial Default Distributions
for Inhomogeneous Portfolios

S.Mori †

, K Kitsukawa ‡
†

‡

and M Hisakado ¶
§

Department of Physics, School of Science, Kitasato University, Kitasato 1-15-1 ,

†
Sagamihara, Kanagawa 228-8555, Japan

Graduate School of Media and Governance, Keio University, Endo 5322, Fujisawa,

¶
Kanagawa 252-8520, Japan

‡

Standard & Poor’s, Marunouchi 1-6-5, Chiyoda-ku, Tokyo 100-0005, Japan

Abstract. This paper generalizes Moody’s correlated binomial default distribution
for homogeneous credit portfolio, which is introduced by Witt, to the case of
inhomogeneous portfolios. As inhomogeneous portfolios, we consider two cases. In the
ﬁrst case, we treat a portfolio whose assets have uniform default correlation and non-
uniform default probabilities. We obtain the default probability distribution and study
the eﬀect of the inhomogeneity on it. The second case corresponds to a portfolio with
inhomogeneous default correlation. Assets are categorized in several diﬀerent sectors
and the inter-sector and intra-sector correlations are not the same. We construct the
joint default probabilities and obtain the default probability distribution. We show
that as the number of assets in each sector decreases, inter-sector correlation becomes
more important than the intra-sector one. We study the maximum values of the inter-
sector default correlation.
In the modeling of portfolio credit risk, it is possible to
incorporate realistic magnitude of inter-sector default correlations. We also show how
to estimate the implied default correlation from the premium of tranches in CDO.

Submitted to: Quantitative Finance

mori@sci.kitasato-u.ac.jp
kj198276@sfc.keio.ac.jp
masato hisakado@standardpoors.com

†
‡
§

Moody’s Correlated Binomial Default Distribution

2

1. Introduction

Credit derivatives, credit risk modeling and credit portfolio modeling have been widely
and extensively discussed during more than ten years [1, 2]. In particular, the modeling
of portfolio credit risk and default correlation are hot topics and pose entirely new
problems. Contrary to the single-name credit derivatives, which are targeted on the
default of one single obligor, portfolio credit derivatives are developed in order to manage
the risk of joint defaults or a clustering of defaults. For example, a ﬁrst-to-default swap
(FtD) is the portfolio extension of a credit default swap (CDS). An FtD is speciﬁed with
respect to a basket of reference credits and the default event is the ﬁrst default of any
of the reference credits. The premium of FtD is not the same with the sum of CDSs of
the reference credits in the basket. It is greatly aﬀected by the default correlation or
joint defaults [2]. A loss layer protection on the credit portfolio enable a more ﬂexible
transfer of the portfolio’s risk. The loss layer is deﬁned by its lower and upper bounds
KL and KU . If the cumulative loss amount L exceed the lower bound KL, the default
KL. By the upper bound KU of the loss layer, the payment is at most
payment is L
KU
KL even if L exceeds KU . More complex and more ﬂexible credit derivative
for the credit portfolio is collateralised debt obligations (CDOs). They are ﬁnancial
innovations to securitize portfolios of defaultable assets: loans, bonds or CDSs. Instead
of a single loss layer, there are several tranches in the notes of a CDO. The tranches
of lower seniority, which are called equity tranche, the ﬁrst mezzanine tranches, the
second mezzanine tranche starting from the lowest seniority, serve as a loss absorber for
the tranches of higher seniority. The ﬁrst losses damage the equity tranche alone up to
when the cumulative loss amount L reaches the equity notional KE. Other tranches are
protected by the equity tranche. Beyond KE, the ﬁrst mezzanine tranche loses its value
until its notional is used up. Then the subsequent mezzanine tranches are damaged in
the order of their seniority.

−

−

, N) which take values 0, 1 or

In the ﬁnancial engineering, pricing or evaluation of these portfolio credit derivatives
pose new problems. In the modeling of portfolio credit risk, the essential diﬃculty is the
modeling of default dependency or default correlation. Many probabilistic models are
proposed for modeling portfolio credit risk[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]. Among
them, two correlated binomial default distribution models contrast starkly about the
eﬀect of default correlation [12, 13, 14]. These models use two-valued random variables
Xi(i = 1,
1 depending on whether the i-th asset
described by Xi is not defaulted or defaulted. The default probability p is deﬁned by
the average number of defaulted assets n per an asset as p = <n>
N . Here < > means
the expectation value.
In the correlated binomial default distribution introduced by
Witt, which we call MCB (Moody’s Correlated Binomial default distribution) model
for abbreviation, the default correlation between the assets is set to be constant ρ
irrespective of the number of defaults [12]. From these conditions, the joint default
probabilities and default distribution function PN (n) are calculated explicitly. On the
other hand, in the long-range Ising model, which is a variants of the factor model and is

· · ·

±

Moody’s Correlated Binomial Default Distribution

3

natural from the viewpoint of Information theory, default correlation is introduced via
a Lagrange multiplier. In the latter model, averaged default correlation is ρ in contrast
to the former MCB model. These models have quite diﬀerent PN (n) proﬁles for the
same default probability p and default correlation ρ. PN (n) of the former model looks
similar to that of the normal copula approach [12]. As ρ increases, the peak of PN (n)
shifts to n = 0 and the length of its tail becomes long. The latter model have two peaks
in PN (n) even for small ρ and only the second small peak which represents the defaults
of all assets generates the default correlation. Assets default independently from each
other and multiple defaults seldom occur. If a multiple default occurs, almost all assets
default simultaneously and only this event is responsible for the default correlation. The
default dependency of MCB model is weaker than that of the long-range Ising model
and if there occurs multiple default, the former model is more likely to have a small
avalanche than the latter model.

The importance of these two-valued variable models comes from that they are easier
to evaluate than other more reﬁned models. In particular, if one need to estimate the
implied default correlation from the market price of the portfolio credit derivatives, this
aspect is important. If a probabilistic model is implemented by Monte Carlo simulation,
the evaluation of the price of these derivatives consumes much computer time and
the inverse process to obtain the model parameters becomes tedious work. With the
above two-valued variable models, the default probability function PN (n) is obtained
explicitly, one can estimate the model parameters from the derivative premiums more
easily. However, these two-valued variable models are formulated only for homogeneous
portfolio, where the default probability p and default correlation ρ are constants in the
portfolio. Generalization to more realistic portfolios should be done.
In this paper,
we generalize the Moody’s correlated binomial default distribution (MCB) model to
two types of inhomogeneous portfolios. We obtain the default probability function
PN (n) and examine the dependence of the expected loss rate of the tranches on the
inhomogeneities. With the proposed model, we also show how to estimate the implied
value of the default correlation.

About the organization of the paper, we start with a short review of the Moody’s
correlated binomial default distribution (MCB) model in Section 2. The model assumes
that the default correlations are constant irrespective of the number of defaults and
the explicit form for PN (n) is given. We modify the condition on the correlation such
λn). The
that the default correlation decays with the number of defaults n as exp(
proﬁle of PN (n) is almost the same with that of the original model for small λ and the
modiﬁcation does not aﬀect the bulk properties of PN (n). By the modiﬁcation, it is
possible to study a portfolio with more than 100 assets. Furthermore, negative default
correlation can also be incorporated with the modiﬁed model. Section 3 is the main
part of the paper. We couple multiple MCB models as a portfolio credit risk model
for inhomogeneous portfolio. In the ﬁrst subsection, we couple two two-valued random
variables X, Y and recall on the limit of the correlation ρxy between them. In the next
, XN with a random variable
subsection, we couple a MCB model of N assets X1, X2,

−

· · ·

Moody’s Correlated Binomial Default Distribution

4

Y and we study the maximum value of the correlation between Xi and Y . Then we
couple two MCB models with N and M assets. Choosing the model parameters properly,
we construct a MCB model for an inhomogeneous default probability case and obtain
the default distribution function. We then study the eﬀect of the inhomogeneity on
the cumulative distribution function D(i) and show that only the tranches with lower
seniority are aﬀected. The last subsection is devoted to an inhomogeneous default
correlation case. Assets are categorized in diﬀerent sectors and inter-sector and intra-
sector default correlations are not the same. We consider a portfolio with K sectors and
th sector contains Nk assets. Within each sector, the portfolio is homogeneous and it
k
has parameters as pk and ρk. The inter-sector default correlations are not the same and
they depends on the choice of sector pairs. We construct the joint default probabilities
and the default probability function PN (n) for the portfolio explicitly. We study the
eﬀect of the inhomogeneity on PN (n) with several simple portfolios. We show that as K
increases, with other parameters are ﬁxed, the eﬀective default correlation are governed
by the inter-sector correlation. In Section 4, using the above results, we estimate the
implied default correlation for each tranche from a CDO’s premium data. We conclude
with some remarks and future problems.

−

2. Moody’s correlated binomial default distribution

X i

i=1,2,....,N
p
=<Xi>
ρ
: Correlation

Figure 1. Homogeneous Portfolio with N assets. The default probability is p and the
default correlation is ρ.

We review the deﬁnitions and some properties of Moody’s correlated binomial
default distribution (MCB model). We consider a homogeneous portfolio, which
is composed of N assets. Here the term “homogeneous” means that the default
probabilities for the assets and the default correlations between the assets are uniform
and we denote them as p and ρ. Two-valued random variables Xi show the states of the
i-th assets. Xi = 1 means that the asset is defaulted and non default state is represented
as Xi = 0. The joint default probabilities is denoted as

P (x1, x2,

, xN ) = Prob(X1 = x1, X2 = x2,

, XN = xN ).

(1)

· · ·

In order to determine P (x1, x2,
2N correspond to the number of possible conﬁgurations and

, xN ), we need 2N

· · ·

−

· · ·
1 conditions for them. Here
1 comes from the

−

Moody’s Correlated Binomial Default Distribution

5

overall normalization condition for the joint probabilities. From the assumption of the
homogeneity for the portfolio, the number of degrees of freedom of the joint probabilities
n non-defaults is the same for any
are reduced. The probability for n defaults and N
N
i=1 xi = n. The number of defaults n is ranged
conﬁguration (x1, x2,
from 0 to N and considering the overall normalization condition, remaining degrees of
freedom are N.

, xN ) with

· · ·

−

P

In MCB model, the conditional default probabilities are introduced. We denote pn
as the default probability for any assets under the condition that any other n assets of
the portfolio are defaulted. To exemplify the situation concretely, we take the n assets as
the ﬁrst n assets of N assets, we denote them with n
, n. The condition
′ = 1. The conditional default
that they are defaulted is written concisely as
probability for n + 1-th assets under the condition of n defaults can then be written as

=1 Xn

= 1, 2,

as n

· · ·

n
n

′

′

′

Q

pn =< Xn+1|

Xn

′ = 1 > .

n

′
Yn
=1

C > means the expectation value of random variable A under condition C
Here, < A
|
is satisﬁed. Two-valued random variable Xn takes 1 for n-th asset default, < Xn
C >
corresponds to its default probability with condition C. Of course, any asset from
, N can be chosen in the evaluation of the expectation value for pn with
k = n + 1,
the condition that

′ = 1. p0 is nothing but the default probability p.

· · ·

|

′

n
n

=1 Xn

N independent conditional default probabilities pn(i = 0,

, N

1) are determined

Q

· · ·

−

by the following condition on the default correlations.

Cor(Xn+1, Xn+2|

Xn

′ = 1) = ρ.

n

′
Yn
=1

Here, Cor(X, Y

C) is deﬁned as

|

Cor(X, Y

C) =

|

< XY

C >

|
< X

< X

C >< Y

C >

−
C >) < Y

|

|
C > (1

< X

C > (1

|

−

|

|

< Y

C >))

−

|

. (4)

The conditions on the default correlations give us the following recursion relations for
pn as

q

−

pn+1 = pn + (1

pn)ρ.

pn = 1

(1

p)(1

−

−

−

ρ)n.

These recursion relations can be solved to give pn as

pn increases as the number of defaults n increases and pn
From these conditional default probabilities pn(n = 0,

1 as n
, N

for ρ > 0.

→ ∞
1), the joint default

probabilities for the conﬁguration ~x = (x1, x2,
N

P (~x) = P (x1, x2,

, xN ) =<

· · ·

→
· · ·

−
, xN ) are given as

Xn)1−xn > .

· · ·
X xn

n (1

−

n=1
Y

(2)

(3)

(5)

(6)

(7)

Moody’s Correlated Binomial Default Distribution

6

The normalization condition for P (~x) is guaranteed by the following decomposition of
unity.

1 =< 1 >=<

Xn+(1

Xn)

>=

[

] <

N

N

1

N

−

}

Yj=1

xj=0
X

n=1
Y

n=1{
Y
The probability for n defaults is

X xn

n (1

Xn)1−xn > (8)

−

PN (n) = N Cn

P (1, 1,

, 1, 0,

, 0) = N Cn <

Xi

n

N

i=1
Y

i=n+1
Y

(1

Xi) >

−

= N Cn

N −nCk(

1)k(

pn′).

(9)

×
N −n

Xk=0

· · ·

−

· · ·
n+k−1

Yn′=0

p=ρ=0.1

Approx.
Numerical

t
i

m

i
l

p

 1

 0.9

 0.8

 0.7

 0.6

 0.5

 0.4

 0.3

 0

 0.05

 0.1

 0.2

 0.25

 0.3

 0.15
λ

Figure 2. p∞ for 0
The numerically enumerated data are shown with + symbol.

≤

≤

λ

0.3 with p = ρ = 0.1. The solid line comes from eq.(13).

We modify the above MCB model as follows.

In the MCB model, the default
correlation is set to be constant irrespective of the number of default (see(3)). We
change the condition as

Cor(Xn+1, Xn+2|

Xn

′ = 1) = ρ exp(

nλ).

−

n

′
Yn
=1

Here, we introduce a parameter λ > 0 and the default correlation under n defaults
nλ). If we set λ = 0, the modiﬁed model reduces to the original MCB
decay as exp(
model. The motivation for the modiﬁcation will become clear when we come to discuss
the coupling of multiple MCB models. The above modiﬁcation changes the recursive
relation for pn to

−

pn is calculated as

pn+1 = pn + (1

pn)ρ exp(

nλ).

−

−

pn = 1

(1

p)

−

−

(1

ρn′).

−

n−1

Yn′=0

(10)

(11)

(12)

Moody’s Correlated Binomial Default Distribution

Here ρn is deﬁned as ρn = ρ exp(

nλ).

−

The conditional default probability pn increases with n, however the increase is

reduced by the decay of the correlation with n. About the limit value of pn as n
is roughly estimated as

→ ∞

7

(13)

p∞ = lim

n→∞ pn = 1

(1

−

−

For λ = 0, p∞ = 1 and p∞ = p + (1

−

p)(1

ρ) exp(

ρ
−
p)ρ = p1 for λ =

1

−
.

∞

−

e−λ

e−λ )

N=30 p=ρ=0.1

MCB
Binomial
λ=0.3
∆PN(n)

)
n
(
N
P

 0.3

 0.25

 0.2

 0.15

 0.1

 0.05

 0

-0.05

 0

 5

 10

 20

 25

 30

 15

n

Figure 3. PN (n) for N = 30,λ = 0.0, 0.3 and p = ρ = 0.1. We also plot the proﬁle for
the binomial distribution b(N, p). ∆PN (n) is the diﬀerence of PN (n) = with λ = 0.3
and λ = 0.0.

In ﬁgure 2, we show the enumerated data for p∞ and the results from eq.(13). As
λ increases, p∞ decreases and the λ dependence is well described by eq.(13). Figure 3
shows PN (n) for λ = 0.0 and λ = 0.3. We set N = 30 and p = ρ = 0.1. We also plot the
binomial distribution b(N, p). The default correlation shifts the peak of b(N, p) to n = 0
and PN (n) comes to have a long tail. In order to study the eﬀect of the parameter λ, we
plot the proﬁle diﬀerence ∆PN (n) between λ = 0.3 and λ = 0.0. We see that the proﬁle
is not so altered by the above modiﬁcation on the correlation. We think that the shape
of PN (n) is mainly determined by pn with small n. pns with large n comes from very rare
′ = 1 and they do not aﬀect the proﬁle so much. The tail part of PN (n)
events
is not altered much, the modiﬁcation is not so serious from the viewpoint of VaR. We
also note another role of the damping parameter λ. In the calculation PN (n), there are
N
Xi) .
i=n+1(1
many cancellations
This causes numerical error in the evaluation and it is diﬃcult to get PN (n) for N
40,

1)k in (9) from the decomposition of

N −n
k=0 N −nCk(

=1 Xn

−

−

Q

n
n

′

P

Q

≥

Moody’s Correlated Binomial Default Distribution

8

even if we use long double precision variable in the numerical implementation. When
we set λ = 0.3, the numerical error diminishes much and we can obtain PN (n) even for
N = 100. This point is important, when one uses the MCB model for the actual CDO
analysis, which has at least 50 assets. In addition, with λ > 0, we can take ρ to be
negatively large enough. In S& P ’s data, the negative default correlation of 0.1% or so
has been reported [15]. We think that this point is also the advantage of the modiﬁed
model.

3. Generalization to Inhomogeneous Portfolios

In this section we couple multiple MCB models and construct the joint default
probabilities and PN (n) for inhomogeneous portfolios. In addition, we show that the
inter-sector default correlation can be set to be large enough by choosing λ and other
parameters properly. We think that it is possible to use the model as a model for
portfolio credit risk.

3.1. Coupling of X and Y : 1+1 MCB model

Before proceeding to the coupling of multiple MCB models, we recall some results for
the coupling of two random variables X and Y . The default probability is px (py) for
X (respectively for Y ) and the default correlation between them is ρxy,

Corr(X, Y ) = ρxy.

Like in the MCB model, we introduce the conditional default probabilities as

p0 = px =< X > and p1 =< X
q0 = py =< Y > and q1 =< Y

Y = 1 > .

|
X = 1 > .

|

From the default correlation ρxy, p1 and q1 are calculated as

p1 = p0 + (1

q1 = q0 + (1

q0)

−

−

p0)v
u
u
t

q0)
−
p0)q0

ρxy

p0)
−
q0)p0

ρxy.

p0(1
(1

−
q0(1
(1

−

v
u
u
t

In the symmetric (homogeneous) case px = py, the equality p1 = q1 holds and they are
given as

p1 = q1 = px + (1

px)ρxy.

−
The correlation ρxy can be set to be 1 and in the limit p1 = q1 →
1. The maximum value
= py),
of ρxy is 1 in the symmetric case. On the contrary, in the asymmetric case (px
ρxy cannot set to be 1. The maximum value of ρxy is determined by the condition that
1. From these conditions, we derive the following conditions on ρxy as
p1 ≤

1 and q1 ≤

ρxy

≤ v
u
u
t

q0(1
(1

p0)
−
q0)p0

−

and ρxy

p0(1
(1

q0)
−
p0)q0

.

−

≤ v
u
u
t

(14)

(15)

(16)

(17)

6
Moody’s Correlated Binomial Default Distribution

We introduce a asymmetric parameter r as

r =

py
px

and a function f (r, p) as

f (r, p) =

(1
1

s

p)r
rp

.

−
−

The maximum value of ρxy is then given as

Max(ρxy) = Min(f (r, p0), f (r, p0)−1).

9

(18)

(19)

(20)

Here Max(ρxy) represents the maximum value of ρxy and Min(A, B) means that the
smaller value of A and B is taken. Figure 4 shows Max(ρxy) as a function of the

px=0.1
px=0.5

)

y
x

ρ
(
x
a
M

 1

 0.9

 0.8

 0.7

 0.6

 0.5

 0.4

 0.3

 0.2

 0.1

 0

 0

 0.5

 1

 1.5

 2

 3

 3.5

 4

 4.5

 5

 2.5
r=py/px

Figure 4. Max(ρxy) for px = 0.1, 0.5 and 0.2

r

5.0.

≤

≤

asymmetry (inhomogeneity) parameter r. We show two curves, the upper one for
px = 0.1 and the lower one for px = 0.5. As the inhomogeneity r increases, that is
r departs from r = 1, Max(ρxy) decreases. For ﬁxed r, as px becomes large Max(ρxy)
becomes small. The reason is that the condition p1 ≤
1 becomes more diﬃcult to be
satisﬁed as px = p0 increase. p1 is a monotonous increasing function of p0.
In the
previous section, the conditional default probability pn becomes smaller as we set λ
larger. When we set λ large, we show that it is possible to couple multiple MCB models
with large default correlation.

3.2. N + 1 MCB model

As the second step, we couple a N assets MCB model with one two-valued random
, N) and the default
variable Y . We introduce N random variables Xn(n = 1,
probability and the default correlation for them is < Xn >= px and ρ. The default
probability for Y is < Y >= py and the default correlation between Y and Xn is written

· · ·

Moody’s Correlated Binomial Default Distribution

10

as ρxy. We assume homogeneity for the N assets MCB model, the default correlation
between Xn and Y is independent of the asset index i. As in the previous cases, we
introduce conditional default probabilities as

pn,0 =< Xn+1|

Xn

′ = 1 > and pn,1 =< Xn+1|

Xn

′

×

Y = 1 >

n

′
Yn
=1

qn =< Y

Xn

′ = 1 > .

The joint default probabilities P (~x, y) = P ( ~X = ~x, y) are calculated by decomposing
the following expression with these conditional default probabilities

P (~x, y) =<

X xn

n (1

−

Xn)1−xn

Y y(1

Y )1−y >

×

−

The joint default probabilities with the condition Y = 1 are

Y = 1) =<

P (~x
|

X xn

n (1

Xn)1−xn

−

×

Y > /py.

The joint probabilities with the condition Y = 0 are obtained by the following relations.

P (~x
|

Y = 0)(1

py)+P (~x
|

−

Y = 1)py = P (~x) =<

X xn

n (1

Xn)1−xn > (24)

−

N

n=1
Y

n

′
Yn
=1

n

|

′
Yn
=1

N

n=1
Y

N

n=1
Y

The explicit form for P (~x
|

y = 0) is

Y = 0) =

P (~x
|

P (~x)

−

Y = 1)py
P (~x
|
py
1

.

−

The probability for n defaults is given as in eq.(9)
n+k−1

N −n

PN (n) = N Cn

N −nCk(

1)k(

−

pn′,0).

Yn′=0

Xk=0

The probability for n defaults with Y = 1 is

PN (n
|

Y = 1) = N Cn

N −nCk(

1)k(

−

N −n

Xk=0

n+k−1

Yn′=0

pn′,1).

Using the same argument as for the joint probabilities with Y = 0, PN (n
|
written as

Y = 0) is

PN (n
|

Y = 0) =

PN (n)

PN (n
|
py

−
1

1)py

.

−

About the conditional default probabilities pn,0, we impose the same conditions as

with the homogeneous N assets MCB model.

Cor(Xn+1, Xn+2|

Xn

′ = 1) = ρ exp(

nλ)

−

The same recursive relation (11) for pn,0 is obtained and the pn,0 is given by

n

′
Yn
=1

n−1

Yn′=0

pn,0 = 1

(1

px)

−

−

(1

ρn′).

−

(21)

(22)

(23)

(25)

(26)

(27)

(28)

(29)

(30)

Moody’s Correlated Binomial Default Distribution

Here ρn is deﬁned as before. About the condition on pn,1 and qn, there are two possible
ways. The only way to realize a strong correlation ρxy between Xn and Y is

Corr(Xn+1, Y

′ ) = ρxye−nλ.

Xn

n

|

′
Yn
=1

In the case, the relations for pn,1 and qn are

pn,1qn = qn+1pn,0 = pn,0qn + ρxy

pn,0(1

pn,0)qn(1

qn) exp(

nλ).

(32)

q

−

−

−

The recursive relations are

pn,1 = pn,0 + ρxy exp(

nλ)(1

pn,0)

−

−

qn+1 = qn + ρxy exp(

nλ)(1

qn)

−

−

pn,0(1
(1

qn)
−
pn,0)qn

v
u
u
t
(1
−
pn,0(1

−
pn,0)qn
qn)

.

−

v
u
u
t

If we set py = px and ρxy = ρ, these relation reduces to pn,1 = pn+1,0 and qn = pn,0 and
this coupled model is nothing but the (N + 1) assets MCB model.

11

(31)

(33)

(34)

λ=0.0
λ=0.3

ρ
/
)

y
x

ρ
(
x
a
M

 2.4

 2.2

 2

 1.8

 1.6

 1.4

 1.2

 1

 0.8

 0.6

 0

 0.5

 1

 1.5

 2

 3

 3.5

 4

 4.5

 5

 2.5
r=py/px

Figure 5. Plot of Max(ρxy)/ρ vs r = py
px
λ = 0.0 and the dotted line λ = 0.3

. N = 30,ρ = 0.1,px = 0.1. The solid line

We write the ratio qn

pn,0 as rn and the condition that pn,1 ≤

1 and qn+1 ≤

1 are

summarized as

ρxy

exp(nλ)

(35)
Min(f (rn, pn), f (rn, pn)−1) is nothing but the condition for Max(ρxy) of the two random
variables X, Y with default probabilities (px, py) = (pn,0, rnpn,0) (see eq.(20)). As we

Min(f (rn, pn,0), f (rn, pn,0)−1).

≤

×

Moody’s Correlated Binomial Default Distribution

12

have explained before, Min(f (rn, pn), f (rn, pn)−1) takes maximum value 1 at rn = 1 for
any value of pn. It also decrease with the increase of pn for ﬁxed rn.

qn

•

The necessary condition that the model to be self-consistent is that pn,1 ≤
1 for all n. We discuss λ = 0 and λ > 0 cases separately.
≤
λ = 0.0 case : pn,0 increases with n and pn,0 →
. The range of pn,0
1 for all n. If
[px, 1] and it is diﬃcult to choose py such that rn
is [px, pN −1]
rn departs much from 1 for some n, Max(ρxy) decreases. The choice px = py and
ρxy = ρ is possible, we anticipate that Max(ρxy) decreases from ρ as py departs
from px.

1 as n

1 and

→ ∞

≃

≃

•

λ > 0 case : The limit value of pn becomes small (see eq.(13)) and the range of pn
is narrow as compared with the λ = 0.0 case. It may be possible to choose py such
that the asymmetric parameter rn is small for small n. In addition, for large n, it is
easy to satisfy the condition (35) because of the prefactor exp(nλ). We think that
Max(ρxy) is large in this case.

We have checked numerically the value of

for all
conﬁgurations (~x, y) with N = 30 and px = ρ = 0.1. In ﬁgure 5, we show the data
of Max(ρxy)/ρ for the case λ = 0.0 (solid line) and λ = 0.3 (dotted line). λ = 0.0 case,
ρ near r = 1 and as r departs from 1, Max(ρxy) decreases from ρ. The data
Max(ρxy)
for λ = 0.3 case show that it is possible to set Max(ρxy) large if we use large r. We can
choose ρxy as strong as several times of ρ.

the joint probabilities

≃

3.3. N + M MCB Model : Coupled MCB model

i

X
i=1,2,,,,, N
<Xi>= px
ρ
x : Correlation

Y
j
j=1,2,,,,M
<Yj>= p y
ρ

: Correlation

y

ρ

xy

Figure 6. Portfolio of N + M MCB model. The ﬁrst (second) sector has parameters
N (M ),px (py) and ρx(ρy). The inter-sector default correlation is ρxy

We consider a portfolio with two sectors. The ﬁrst sector has N assets and the
second has M assets. To construct the joint default probabilities for the portfolio,
we try to couple two MCB models. The former model’s N assets are described
, N) and the states of the latter model’s assets are described by
by Xn(n = 1,

· · ·

Moody’s Correlated Binomial Default Distribution

Ym(m = 1,
, M). The default probability and the default correlation in each sector
are (px, ρx) and (py, ρy). The default correlation between the assets in diﬀerent sectors
is denoted as ρxy (see Figure 6).

· · ·

Introducing the conditional default probabilities pn,m and qn,mas

Yn′=1
n

Yn′=1

n

Yn′=1
m

pn,m = < Xn+1|

qn,m = < Ym+1|

Ym′=1
m

Ym′=1

n

m

Xn′

Ym′ = 1 >,

p0,0 = px

Xn′

Ym′ = 1 >,

q0,0 = py,

we impose the following conditions on pn,0 and q0,m

Cor(Xn+1Xn+2|

Xn′ = 1) = ρx exp(

nλ)

Cor(Ym+1Ym+2|
The recursive relations for pn,0 and q0,m are

Ym′=1

Ym′ = 1) = ρy exp(

mλ).

pn+1,0 = pn,0 + ρx exp(
q0,m+1 = q0,n + ρy exp(

−

nλ)(1

mλ)(1

−

pn,0)
q0,m).

−
Their solutions are, by denoting ρx,n = ρx exp(

−

−

−

nλ) and ρy,m = ρy exp(

mλ),

−

−

pn,0 = 1

(1

px)

−

−

(1

ρx,n′)

−

q0,m = 1

(1

py)

−

−

(1

ρy,m′).

−

n−1

Yn′=0
m−1

Ym′=0

About the inter-sector correlation, we impose the next conditions on pn,m and qn,m,
which is natural generalization of N + 1 case (see eq.(31)).

n

m

Cor(Xn+1Ym+1|
We obtain the following recursive relations,

Ym′=1

Yn′=1

Xn′

Ym′ = 1) = ρxy exp(

(n + m)λ).

(44)

pn,m+1qn,m = qn+1,mpn,m
= pn,mqn,m + ρxye−(n+m)λ

Using these relations, we are able to calculate pn,m and qn,m iteratively starting from
pn,0 and q0,m.

The joint default probability for the portfolio conﬁguration (~x, ~y) is calculated by

pn,m(1

pn,m)qn,m(1

qn,m).

(45)

q

−

decomposing the following expression with pn,m and qn,m

−

−

P (~x, ~y) = P (x1, x2,

=<

N

n=1
Y

X xn

n (1

−

· · ·
Xn)1−xn

, xN , y1, y2,
M

· · ·
Y ym
m (1

, yM )

Ym)1−ym > .

−

m=1
Y

13

(36)

(37)

(38)

(39)

(40)

(41)

(42)

(43)

(46)

Moody’s Correlated Binomial Default Distribution

14

In particular, the probability for n, m defaults in each sector, which is denoted as
PN,M (n, m), is

PN,M (n, m) = N Cm

M Cm
n

P (1, 1,
N −n

×

×

· · ·

, 1, 0,
m

· · ·

, 0, 1, 1,
M −m

· · ·

, 1, 0,

, 0)

· · ·

(47)

(48)

(49)

(1

Xk)

−

Yj

Ym′=1

Yl=m+1

(1

Yl) >

−

N −nCk

M −mCl

×

= N Cm

M Cm

<

Xn

= N Cm

M Cm

×

×

×

×

Yn′=1

N −n

M −m
(

Xk=0

Xl=0

Yk=n+1
1)k+l

−

<

×

n+k

m+l

Xn′

Ym′ > .

Yn′=1

Ym′=1

n

PN +M (n) =

PN,M (n′, n

n′).

−

PN +M (n) is easily calculated from PN,M (n, m) as

In decomposing <
of the order of the decomposition of <
Q
(45). We decompose it as

k
n=1 Xn

Q

Xn′=0
l
m=1 Ym > , one can do it in any order. The independence
l
m=1 Ym > is guaranteed by (44) and

k
n=1 Xn

k

l

<

Xn

Ym >=

n=1
Y

m=1
Y

Q

pn,0 ×

Q

l−1

m=0
Y

k−1

n=0
Y

qk,m.

About the maximum value of ρxy, it is necessary to check all values of the joint
probabilities. However, N + M model is reduced to N + 1 or 1 + M model by choosing
M = 1 or N = 1 respectively. From the discussions and the results in the previous
subsection for N + 1 model, we can anticipate as follows.

(i) λ = 0 Case : If px = py and ρx = ρy, two MCB models are the same and we can
set ρxy = ρx = ρy. Two models merge completely and we have a (N + M) assets
MCB model. As the asymmetry between the two models becomes large (px
= py
or ρx

= ρy) , Max(ρxy) decreases from ρx, ρy.

(ii) λ > 0 Case : As λ increases, Max(ρxy) becomes large. The asymmetry in px, py

and ρx, ρy diminishes Max(ρxy).

±

Using the above coupled N + M MCB model, we study the eﬀect of the non-
uniformity of the default probability on PN (n) and on the evaluation of tranches. We
consider a portfolio with N +N assets. The assets in each sector has default probabilities
∆Pd and the intra-sector default correlation ρ. We set the inter-sector default
p
correlation ρxy also as ρ. The inhomogeneity in the default probability is controlled by
∆Pd. If we set ∆Pd = 0, the two sector are completely merged to one sector and we
have a homogeneous 2N MCB model with p and ρ. In ﬁgure 7, we shows the default
probability diﬀerence ∆P (n) between the inhomogeneous case PN +N (n) with ∆Pd
= 0
and homogeneous case P2N (n). The default probability diﬀerence is deﬁned as

∆P (n) = PN +N (n)

P2N (n).

−

(50)

6
6
6
Moody’s Correlated Binomial Default Distribution

15

∆Pd=0.01
∆Pd=0.02

)
n
(
P
∆

 0.02

 0.015

 0.01

 0.005

 0

-0.005

-0.01

-0.015

-0.02

-0.025

 0

 5

 15

 20

 10
n

Figure 7. ∆P (n) vs n. We set N = 20,p = 0.03,ρ = 0.03 and λ = 0.3.

We set N = 20, p = ρ = 0.03 and λ = 0.3. The solid curve represents the data for
∆Pd = 0.01 and the dotted curve stands for the case ∆Pd = 0.02. We see that ∆P (n)
is large only for small n. Only the tranches with lower seniority are aﬀected by the
inhomogeneity ∆Pd.

To see the eﬀect of ∆Pd on the evaluations of tranches, we study the change in the

cumulative distribution functions D(i). D(i) are deﬁned as

n=i
X
D(i) represents the expected loss rate of the i
th tranche, which is damaged if more
than i assets are defaulted. In terms of the loss layer protection, KU = i + 1, KL = i
and the recovery ratio rrec is zero. One of the important properties of D(i) is

−

N

D(i) =

PN (n).

1
N

N

Xi=1

D(i) = p.

This identity means that the tranches distribute the portfolio credit risk between them.
Another important property of D(i) is that the expected loss rate D[i, j] of the layer
protection with KL = i,KU = and rrec = 0.0 can be built up from D(i) as

D[i, j] =

1
i + 1

j

n=i
X

j

−

D(i).

Figure 8 shows the diﬀerence ∆D(i) between the inhomogeneous case and
homogeneous case. The parameters are the same with those of ﬁgure 7. We see that
∆D(n)
5 becomes smaller
|
5
than

and the inhomogeneity does not aﬀect the evaluation of tranche with n

increase with ∆Pd for any n. For ﬁxed ∆Pd,

∆D(n)

for n

≥

|

|

|

∆D(4)
|

|

(51)

(52)

(53)

≥

Moody’s Correlated Binomial Default Distribution

16

∆D(1)
∆D(2)
∆D(3)
∆D(4)
∆D(5)
∆D(6)
∆D(7)
∆D(8)

)
i
(

D
∆

 0.004

 0.012

 0.01

 0.008

 0.006

 0.002

 0

-0.002

-0.004

 0

 0.002

 0.004

 0.006

 0.008

 0.01

 0.012

 0.014

∆Pd

Figure 8. ∆D(i) vs ∆Pd. The parameters are the same with the previous ﬁgure. We
plot D(n) for 1

8.

n

≤

≤

so much as n = 4. We conclude that the tranches with higher seniority are not aﬀected
2,p = ρ = 0.03 case, the
by the inhomogeneity of the default probability. For N = 20
border line is n = 4.

×

3.4. Multi Sectors Case

We try to couple two or more MCB models. We consider a portfolio with N assets,
which are categorized in K diﬀerent sectors. Figure 9 sketches the situation of the
K
portfolio. The k-th sector contains Nk assets and the relation
k=1 Nk = N holds.
The states of the assets in the k-th sector is described by X k
, Nk) and the
default rate and default correlation are denoted as pk and ρk. About the inter-sector
default correlation, we denote them as ρij for the default correlation between the i
th
and j
th sector. The intra-sector default correlation and inter-sector default correlation
are diﬀerent and the former is larger than the latter in general [16].

nk(nk = 1,
P

· · ·

−

−

We have not yet succeeded in the coupling of three or more MCB models, by
generalizing the result for the coupled N + M MCB model. The reason is that the self-
consistency relations are very rigid restrictions on the MCB model. These relations,
two sectors version is given by (45), assure the independence of the order of the
decomposition in the estimation of the expectation values of the product of random

Moody’s Correlated Binomial Default Distribution

17

ρ
1

K

Sector K
N
K
P
K
ρ
K

Sector 1
N
1
P
1
ρ
1

ρ
1

2

ρ

2K

ρ
1

3

ρ
3K

Sector 2
N
P
2
ρ
2

2

ρ

23

Sector 3
N
3
P
3
ρ
3

Figure 9. Structure of the portfolio. There are K sectors and k-th sector contains Nk
assets. The default probability and default correlation for the assets in the k-th sector
th and j-th sector is ρij.
is pk, ρk. The inter-sector default correlation between the i

−

variables.
probabilities that satisfy the self-consistency relations.

It is diﬃcult to impose any simple relations on the conditional default

· · ·

In order to construct the joint default probabilities for the assets states
, ~xK), we do not glue together K MCB models directly. Instead, as depicted
(~x1, ~x2,
in ﬁgure 10, we glue multiple MCB models through one random variable Y . More
concretely, we prepare K sets of Nk + 1 MCB models. Nk + 1 MCB model is the
Nk MCB model coupled with Y . The probability of P (Y = 1) is written as py. We
Introduce the following conditional default probabilities

nk,0 =< X k
pk

= 1 > and pk

nk,1 =< X k

nk

′
Yn
k=1

X k
n

′
k

nk+1|

nk

|

′
Yn
k=1

qk
nk =< Y

X k
n

′
k

= 1 > .

nk

nk+1|

′
Yn
k=1

X k
n

′

k ×

Y = 1 >

We also impose the following conditions on pk

nk,0, pk

nk,1 and qk

nk as

Cor(X k

nk+1, X k

= 1) = ρk exp(

nkλ)

−

Corr(X k

nk+1, Y

) = ρky exp(

nkλ).

−

nk

′
Yn
k=1

X k
n

′
k

nk+2|

nk

X k
n

′
k

|

′
Yn
k=1

The joint default probabilities P (~xk, y) and the conditional joint default probabilities

(54)

(55)

(56)

Moody’s Correlated Binomial Default Distribution

P k(~xk

|

y) are constructed as before.

Nk

P (~xk, y) =<

nk=1
Y
P (~xk, y) = P k(~xk

y)P (y).

|

(X k

nk)xk

nk (1

X k

nk)1−xk

nk

−

Y y(1

Y )1−y >

×

−

Packing these conditional default probabilities P k(~xk
joint default probabilities for the total portfolio as

|

y) into a bundle, we construct the

P (~x1, ~x2,

, ~xK) =

p(y)

· · ·

y=0,1
X

K

×

Yk=1

P (xk

1, xk
2,

, xk

Nk |

y).

· · ·

We also obtain the default probability function PN (n1, n2,
k-th sector as

· · ·

, nK) for nk default in the

PN (n1, n2,

, nK) =

p(y)

· · ·

y=0,1
X

K

×

Yk=1

PNk(nk

y)

|

From the expression, it it easy to calculate the probability for n defaults and we write
it as PN (n).

18

(57)

(58)

(59)

(60)

K
X
n
n K=1,2,,, NK

K

p

K

K
<X  >=
n
ρ

K

K : Correlation

ρ

1

y

Y
<Y>=Py

ρ

2

y

ρ

K y

2
X
n
2 =1,2,,,N2

2

n

p

2

2
<X  >=
n
ρ

2

: Correlation

2

1

n

1
X
n
1 =1,2,,,N1
1
p
<X  >=
n
ρ

1

1

: Correlation

1

ρ

3

y

3

n 3

3
X
n
=1,2,,,N3
3
<X  >=
n
ρ

p

3

3

: Correlation

3

Figure 10. Gluing multiple MCB models with Y . The correlation between X k
Y is ρky. The default correlation between X i

nj is given as ρij = ρiy

ni and X j

nk and
ρjy.

×

About the default correlation between the diﬀerent sectors, we can show the next

relations.

ρij = ρiy

ρjy.

×

(61)

Moody’s Correlated Binomial Default Distribution

19

More generally, the conditional
relations.

inter-sector default correlations obey the following

Cor(X i

ni+1, X j

nj+1|

ni

nj

X i
n′
i

X j
n′
j

= 1) = ρij exp(

(ni + nj)λ)

(62)

−

Yn′
i=1

Yn′
j=1
These relations mean that our construction procedure is natural from the viewpoint of
original MCB model. In particular, in the K = 2 case, these relations are completely
equivalent with those of the N + M coupled MCB model. See (44) and (62). The
conditional default probabilities obey the same conditions.

Furthermore, from the results on Max(ρxy) of the N + 1 MCB model, we see that
the model can induce realistic magnitude of inter-sector default correlation. By choosing
λ and py properly, it is possible to take ρky as large as several times of ρk.

r=1.0
r=3.0
r=15.0

)

y
x

ρ
(
x
a
M

 0.35

 0.3

 0.25

 0.2

 0.15

 0.1

 0.05

 0

 0

 0.05

 0.15

 0.2

 0.1
ρ

Figure 11. Plot of Max(ρxy) vs ρ. N = 30,px = 0.03 and λ = 0.3.

Figure 11 plots Max(ρxy)=Max(ρky) as functions of ρ = ρk. We set parameters as
depicted in the ﬁgure. The dotted line depicts the data for r = py
= 3.0. Other two
px
). We see that by setting r = 3.0.
curves correspond to r = 1.0 (+) and r = 15.0 (
it is possible to set ρky as large as several times of ρk. If the intra-sector correlation
ρi = ρj is 10%, we can set ρiy = ρjy = 20%. The inter-sector correlations is then
ρij = ρiy
ρjy = 4%. In general, ρinter is smaller that ρintra, we think that the present
model can incorporate strong enough inter-sector default correlation.

×

×

We prove the relations (61) and (62). In order to calculate the correlation, we need

to estimate the next expression.
ni

< X i

ni+1X j

nj +1|

nj

X i
i′

X j

j′ = 1 > .

Yi′=1

Yj′=1

(63)

(64)

ni,0,

(65)

(66)

(67)

Moody’s Correlated Binomial Default Distribution

20

If we ﬁx the random variable Y , X i
ni and X j
and the above equation is estimated by the average over Y = 0 and Y = 1 as
nj

nj are independent. They are coupled by Y

ni

X i
i′

X j

j′ = 1 >

Yj′=1

Yi′=1
i′ = 1, Y = 1 >< X j
X i

< X i

ni+1X j

=< X i

ni+1|

nj +1|
ni

Yi′=1
ni

+ < X i

ni+1|

Yi′=1
nj,1py + ˜pi

= pi

ni,1pj

nj

Yj′=1
nj

Yj′=1

nj +1|

nj +1|

X i

i′ = 1, Y = 0 >< X j

X j

j′ = 1, Y = 0 > (1

py)

−

−
Here, we denote the conditional default probabilities with the condition Y = 0 as ˜pi

ni,0 ˜pj

nj,0(1

py).

X j

j′ = 1, Y = 1 > py

ni,0 =< X i
˜pi

ni

X i
n

′

ni+1|

′
Yn
i=1

(1

Y ) = 1 > .

i ×

−

Between pi

ni,0, the next relation holds.

ni,0 and ˜pi
ni,0 = pi
pi

ni,1py + ˜pi

ni,0(1

py).

−

In addition, from the correlation between X i

ni and Y , we also have the next relations.

pi
ni,1py = pi,0py + ρxy

pi,0(1

pi,0)py(1

py)

−

−

q

Putting these relations into (64), we can prove the next equations.

ni

nj

X i
i′

X j

j′ = 1 >

< X i

ni+1X j

nj +1|

Yi′=1

= pi

ni,0pj

nj,0 + ρiy

ρjy

×

Yj′=1
pi
ni,0(1

ni,0)pj
pi

nj,0(1

pj
nj,0)

−

×

−

e−λ(ni+nj)

(68)

r
Using these relations, we calculate the inter-sector correlation and prove (62).

1y = ρ2

We check the validity of the above glueing process. We consider the two sector
case K = 2 and their intra-sector parameters are set to be the same as N, p and ρ in
each sector. About the inter-sector default correlation ρ12, we set ρ2
2y = ρ12 in
the above multi-sector model. If the glueing process of the multi-sector model works
well, P2N (n) should coincide with PN +N (n) of the coupled N + N MCB model in the
previous subsection. Figure 12 shows ∆P (n) = P2N (n)
PN +N (n) with N = 5, 10, 20
and λ = 0.3. We set p = ρ = 0.03 and ρ12 = 0.01. In addition we also plot the data for
ρ12 = 0.02 and N = 20. As the system size N becomes large, the discrepancy ∆P (n)
increases. With the same system size N = 20, as the inter-sector correlation increases,
the discrepancy also increases. As we have stated previously, these models obey the
same conditions on the conditional default probabilities, however default probability
proﬁle does not coincide. The gluing process by the auxiliary random variable Y may
cause changes to the joint probabilities. We have not yet understood this point well.

−

With the present model, we study the eﬀects of the inhomogeneous default
= ρintra on the default distribution function PN (n) and the loss rates

correlation ρinter

6
Moody’s Correlated Binomial Default Distribution

21

N=5 ρ
N=10 ρ
N=20 ρ
N=20 ρ

xy=0.01
xy=0.01
xy=0.01
xy=0.02

)
n
(
P
∆

 0.005

 0.025

 0.02

 0.015

 0.01

 0

-0.005

-0.01

-0.015

 0

 0.05

 0.1

 0.2

 0.25

 0.3

 0.15
n/(2*N)

Figure 12. Comparison of Two sectors MCB model: Directly Coupled Model vs
Coupled by Y Mode (py = 0.5). Plot of ∆P (n) = P2N (n)
PN +N (n) vs n/(2N )).
N = 5, 10, 20,p = ρ = 0.03 and λ = 0.3. Upper three curves have ρxy = 0.01 and the
bottom line has ρxy = 0.02.

−

D(i). We consider ideal portfolios which have the same default probability pk = p,
default correlation ρk = ρ. The inter-sector default correlations are also set to be the
same value as ρij = ρinter. Nk are also set to be the same Nk = Ns. We ﬁx the total
number of assets as N and compare PN (n) and D(i) between the portfolios with diﬀerent
sector number K. Of course, between K and Ns the relation N = Ns
K holds. We set
ρinter < ρ. As the number K increases, the average default correlation is governed by
the inter-sector correlation ρinter and becomes weak. At the extreme limit K = N case,
each sector contains only one asset. By the inter-sector default correlation, PN (n) is
given by the super-position of PN (n
Y = 0). The conditional default
|
1,0 pk
probabilities pk

Y = 1) and PN (n
|

1,0 are given as

1,1 and ˜pk

×

1,0 = p and pk
pk

1,1 = p + √ρinter(1

p

(1

py)

−
py

1

v
u
u
t

p

−

p)

−

.

(69)

(70)

˜pk
1,0 = p

√ρinter p

1

p

py

−
p

s

−

−

(1

Y = 1) and PN (n
|

py)
Y = 0) are the binomial distributions b(N, pk
PN (n
1,0).
|
Figure 13 shows the semi-log plot of the default probability PN (n) for K =
1, 2, 10, 50, 100. We set the model parameters as p = ρ = 0.03, N = 100, ρinter = 0.01
and py = 0.5. The solid curve represents the data for K = 1 and ρ = 0.03 and the
dotted line shows the data for K = 1 and ρ = 0.01. As K increases, the data for each
K departs from the solid line. At K = 10, the data almost shrinks on the dotted line

1,1) and b(N, ˜pk

Moody’s Correlated Binomial Default Distribution

22

K=1 ρ=0.03
K=2
K=10
K=50
K=100
K=1 ρ=0.01

 1

 0.1

 0.01

)
n
(
N
P

 0.001

 1e-04

 1e-05

 1e-06

 0

 5

 15

 20

 10
n

Figure 13. Semi-log plot of ∆P (n) vs n. N = 100,K = 2, 10, 100,p = ρ =
0.03,ρinter = 0.01 and λ = 0.3. We set py = 0.5. Solid line represents K = 1
and ρ = 0.03 case and the dotted line shows the curve for K = 1 and ρ = 0.01.

(K = 1 and ρ = 0.01). The data for K = 50 almost coincide with those of K = 100,
whose PN (n) is given by the superposition of the two binomial distributions. This point
is also a drawback of the present model. If the glueing process works perfect, these data
should coincide with the homogeneous portfolio case K = 1 and ρ = 0.01. However, this
discrepancy is inherent property of the model. Contrary to the discrepancy of the two-
sector case, the conditions on the conditional default probabilities pk
nk,1 are diﬀerent
from those of the K = 1 homogeneous portfolio. They could cause the diﬀerence in
PN (n).

From the above discussions on PN (n) with diﬀerent K, we think that the inter-sector
default correlation ρinter is more important than the intra-sector default correlation ρ
for the large K case.
In the K = 10 case, the PN (n) are roughly given by those of
the homogeneous portfolio with ρ = ρinter. If one estimates the implied values of ρ and
ρinter from the premium (or D(i)) of the portfolio with large K, this point is crucial.
for K = 10 between ρ = 0.01, 0.05 and ρ = 0.03. We
In Figure 14, we show
set the model parameters as in the previous ﬁgure. For comparison, we also plot D(i)
for ρ = 0.03. D(i) represents the expected loss rate of the i-th tranche, the magnitude
is important when one estimates the implied default correlation ρ from the
of
with small i is small as compared with
∆D(i)
premium of the tranche. We see that
D(i). If we change ρ from ρ = 0.03, D(i) does not change much. It is diﬃcult to obtain

∆D(i)

∆D(i)

|

|

|

|

|

|

Moody’s Correlated Binomial Default Distribution

23

D(i) ρ=0.03
|∆D(i)| ρ=0.01
|∆D(i)| ρ=0.05

 1

 0.1

 0.01

 0.001

)
i
(

D
 
d
n
a
 
|
)
i
(

D
∆

|

 1e-04

 0

 2

 4

 6

 10

 12

 14

 8

i

Figure 14. Plot of
and D(i) vs i. ∆D(i) are between ρ = 0.01, 0.05 and
ρ = 0.03. N = 100,K = 2, 10, 100,p = 0.03,ρinter = 0.01 and λ = 0.3. We set py = 0.5.
The solid curve shows the data of D(i) with ρ = 0.03.

∆D(i)
|
|

the implied values of ρ from the premium of the tranche with the lower seniority. On
13, the magnitude of D(i) and ∆D(i) are
the other hands, with medium value of i
≃
almost comparable. D(i) is sensitive to the change in ρ and it is not diﬃcult to get the
implied value of ρ.

4. Implied Default Correlation and Concluding Remarks

In the last section, as a concrete example, we try to estimate the implied values
of the default correlation from the premium of a synthetic CDO. We consider a
inhomogeneous portfolio which has 50 assets with default probability p = 60.7[bps]/year
and ∆Pd = 39.3[bps]/year. The correlations ρ and ρinter are set to be the same. We use
the PN +N (n) of the coupled N + N MCB model with p = p
∆Pd and N = 25. We
consider a CDO which has 5 tranches. We show its structure in the table 1. The equity
has KL = 0 and KU = 3%. The ﬁrst mezzanine tranche has KL = 3% and KU = 6%
In the fourth column, we show their premium. The recovery rate rrec
and so forth.
means that if an asset is defaulted, how much the creditor is paid oﬀ. We set it as
rrec = 0.4. In a CDO, if n assets are defaulted, the equity loss is 0.6n up to its notional
3%
50). If more that three assets are defaulted
the equity loses its notional completely. The expected loss rate is the premium of the
tranche and we have the following relation.

50 and the loss rate is 0.6n/(3%

×

±

×

P50(1)

+ P50(2)

+ D(3) = Premium of Equity.

0.6
1.5

×

1.2
1.5

×

Moody’s Correlated Binomial Default Distribution

24

D(3) is the cumulative probability for n
3 defaults. From the relation, it is possible
to get the implied value of ρ. The ﬁrst mezzanine tranche begins to lose its value from
50 until 0.6n reaches its upper notional
when 0.6n reaches its lower notional KL = 3%
KU = 6%

×
50. We have the following relation.

≥

×

P50(3)

+ P50(4)

+ D(5) = Premium of Mezzanine 1.

0.3
1.5

×

0.9
1.5

×

From similar relations, it is possible to estimate the default correlations ρ for other
tranches. The results are presented in the 5th column. For comparison, in the last
column, we show the implied values for the same p but with ∆Pd = 0.0. We see that
the implied correlations are diﬀerent between the tranches.
In addition, the implied
values are considerably diﬀerent between ∆Pd
= 0 and ∆Pd = 0.0. In the estimation
of the implied correlation, we cannot neglect the ﬂuctuation ∆Pd. We also see that,
instead of the “Correlation Smile”, which is a typical behavior of implied correlations
across portfolio tranches [17], our results show monotonically an increasing curve with
the seniority.

Tranches
Equity
Mezzanine 1
Mezzanine 2
Senior 1
Senior 2

KL KU Premium Implied ρ (∆Pd
17 bps
0% 3%
12.0 %
2.2 %
3% 6% 115 bps
4.3 %
6% 9% 42.5 bps
7.0 %
9% 12% 25 bps
11.1 %
12% 22% 15.5 bps

= 0.0)

Implied ρ (∆Pd = 0.0)
15 bps
1.9 %
3.87 %
5.2 %
10.0 %

Table 1. Tranching, premium and implied correlations. In the 5th column, we show
the results for ∆Pd
= 0.0 case. In the last column, the results for ∆Pd = 0.0 case are
presented. We set the asset number N = 50, average default probability p = 60.7[bps]
and the default probability ﬂuctuation ∆Pd = 39.3[bps].

In this paper, we generalize the Moody’s correlated binomial default distribution
to the inhomogeneous portfolio cases. As the inhomogeneity, we consider the non-
uniformity in the default probability p and in the default correlation ρ and ρinter. To
treat the former case, we construct a coupled N + M MCB model and obtain the
default probability function PN +M (n). The inhomogeneity in p causes the changes
in the expected loss rates of the tranches with lower seniority. The tranches with
In order to treat the inhomogeneity in the default
higher seniority are not aﬀected.
correlation, we construct a multi-sector MCB model, by glueing multiple MCB models
by an auxiliary random variable Y . We cannot take out the lines of joint between the
MCB models, for small portfolio and small ρinter, the construction works well. About the
inhomogeneity in ρ, we divide a homogeneous portfolio in K sectors. We set ρinter < ρ
and see the eﬀect of the increase in K on PN (n). As the sector number K increases,
the inter-sector correlation ρinter becomes more important than the intra-sector default
correlation ρ. With large K, the default correlation is governed by ρinter only. The

6
6
6
Moody’s Correlated Binomial Default Distribution

25

CDOs, whose assets are categorized in many sectors, ρinter should be treated more
carefully than ρ.

In order to check the validity of the present model, more careful comparison with
other models should be performed. For example, we introduce a parameter λ and set it
as λ = 0.3. However, more careful treatment and calibration should be done.

This work has received ﬁnancial support from Kitasato University, project SCI:2005-
1706.

Acknowledgments

References

& Sons).

[1] Fabozzi F J and Goodman L S 2001 Investing in Collateralized Debt Obligations (U.S. John Wiley

[2] Sch¨onbucher P J 2003 Credit Derivatives Pricing Models : Model, Pricing and Implementation

[3] Cifuettes A and O’Connor G 1996 The Binomial Expansion Method Applied to CBO/CLO

(U.S. John Wiley & Sons) .

Analysis (Moody’s Investors Service).

[4] Martin R, Thompson K and Browne C 2001 Risk July 86.
[5] Finger C C 2000 A Comparison of stochastic default rate models: Working Paper (The

RiskMetrics Group).

[6] Li D X 2000 The Journal of Fixed Income 9(4)43.
[7] Sch¨onbucher P and Schubert D, 2001 Copula Dependent Default Risk in Intensity Models,

working paper, Department of Statistics, Bonn University.

[8] Vasicek O, 1987 Probability of Loss on Loan Portfolio , KMV Corporation.
[9] Hull J and White A, 2001, Valuing Credit Default Swaps II: Modeling Default Correlations,

Spring 812-22.

[10] Duﬃe D and Gˆarleau 2001 Financial Analyst Journal 57(1)41-59.
[11] Duﬃe D and Singleton K J 2003 Credit Risk-Pricing, Measurement and Management

[12] Witt G 2004 Moody’s Correlated Binomial Default Distribution (Moody’s

Investors

(Princeton:Princeton University Press).

Service)August 10.

portfolios Preprint cond-mat/0401378.

[13] Molins J and Vives E 2004 Long range Ising Model for credit risk modeling in homogeneous

[14] Kitsukawa K, Mori S and Hisakado M 2005 Evaluation of Tranche in Securitization and Long-

range Ising Model to be published in Physica A.

[15] Standard & Poor’s CreditPro 7.00 2005.
[16] Jobst N J and de Servigny A 2005 Working Paper (Standard & Poor’s)
[17] Andersen L, Sidenius J and Basu S 2003, All your Hedges in one Basket RISK November 67-72.

