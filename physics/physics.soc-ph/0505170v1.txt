5
0
0
2
 
y
a
M
 
4
2
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
1
5
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Recurrence analysis of the NASDAQ crash of
April 2000

Annalisa Fabretti1 and Marcel Ausloos2

1

2

Department of Mathematics for Economy, Insurances and Finance Applications,
University of Roma 1, La Sapienza I-00100 Rome, Italy
annalisa.fabretti@uniroma1.it
SUPRATECS, B5, University of Li`ege, B-4000 Li`ege, Euroland
marcel.ausloos@ulg.ac.be

Summary. Recurrence Plot (RP) and Recurrence Quantiﬁcation Analysis (RQA)
are signal numerical analysis methodologies able to work with non linear dynamical
systems and non stationarity. Moreover they well evidence changes in the states of
a dynamical system. It is shown that RP and RQA detect the critical regime in
ﬁnancial indices (in analogy with phase transition) before a bubble bursts, whence
allowing to estimate the bubble initial time. The analysis is made on NASDAQ daily
closing price between Jan. 1998 and Nov. 2003. The NASDAQ bubble initial time
has been estimated to be on Oct. 19, 1999.

Key words: Endogenous crash, Financial bubble, Recurrence Plot, Recur-
rence Quantiﬁcation Analysis, Nonlinear Time Series Analysis, NASDAQ

1 Introduction

Recent papers have shown some analogy between crashes and phase transi-
tions [1, 2, 3]; like in earthquakes, log periodic oscillations have been found
before some crashes [4, 5], then it was proposed that an economic index y(t)
increases as a complex power law, whose ﬁrst order Fourier representation is

y(t) = A + B ln(tc − t){1 + C cos[ω ln(tc − t) + φ]}

(1)

where A, B, C , ω, φ are constants and tc is the critical time (rupture time).
An endogenous crash is preceded by an unstable phase where any informa-

tion is ampliﬁed; this critical period takes the name of ’speculative bubble’.

Recurrence Plots are graphical tools elaborated by Eckmann, Kamphorst
and Ruelle in 1987 and are based on Phase Space Reconstruction [6]. In 1992,
Zbilut and Webber [7] proposed a statistical quantiﬁcation of RPs and gave
it the name of ’Recurrence Quantiﬁcation Analysis’ (RQA). RP and RQA are

2

Annalisa Fabretti and Marcel Ausloos

good in working with non stationarity and noisy data, in detecting changes
in data behavior, in particular in detecting breaks, like a phase transition [8],
and in informing about other dynamic properties of a time series [6]. Most of
the applications of RP and RQA are at this time in the ﬁeld of physiology and
biology, but some authors have already applied these techniques to ﬁnancial
data [9, 10]. We have used RP and RQA techniques for detecting critical
regimes preceding an endogenous crash seen as a phase transition and whence
give an estimation of the initial bubble time.

It has been simulated a signal as in 1, the analysis is made on NASDAQ,
taken over a time span of 6 years including the known crash of April 2000 [5].
The series are also divided into subseries in order to investigate changes in the
evolution of the signal. Then the RPs of all time series have been observed,
compared and discussed. This work is extracted by [13].

2 Recurrence Analysis

The changing state of a dynamic system can be indeed represented by
sequences of ’state vectors’
in the phase space. Each unknown point of
the phase space at time i is reconstructed by the delayed vector y(i) =
Xi, Xi+d, ..., Xi+(m−1)d in an m-dimensional space.

Recurrence Plot

The Recurrence Plot (RP) is a matrix of points (i, j) where each point is said
to be recurrent and marked with a dot if the distance between the delayed
vectors y(i) and y(j) is less than a given threshold ǫ. As each coordinate
i represents a point in time, RP provides information about the temporal
correlation of phase space points [6].

Therefore RPs can be used to test a system deterministic behavior through
the percentage of recurrent points belonging to parallel lines. In fact for a
periodic or a deterministic signal patterns like parallel lines appear. In so
doing, RPs are useful tools for the preprocessing of experimental time series
and provide a comprehensive image of the dynamic course at a glance [8].

Recurrence Quantiﬁcation Analysis

RQA quantiﬁes the presence of patterns, like parallel lines of RPs, with 5 RQA
variables: the percentage of recurrent points (%REC). The percentage of re-
current points forming line segments parallel to the main diagonal (%DET).
The longest line segment measured parallel to the main diagonal (MAXLINE).
The slope of line-of-best-ﬁt through %REC as a function of the displacement
from the main diagonal (excluding the last 10% range) (TREND). The Shan-
non entropy of the distribution of the length of line segments parallel to the
main diagonal (ENT).

Recurrence analysis of the NASDAQ crash of April 2000

3

3 Analysis and Conclusions

In order to study the crash from the point of view of a phase transition with
log periodic precursors, a log periodic signal, generated by equation (1), has
been simulated, its RP is shown in Fig. 1(lhs). The ’arrow’ shape is due to
the trend, the not smooth border (’color’) lines are due to the log periodicity.
It has been also considered a phase transition signature. In Fig. 2(lhs) an
arbitrary signal is plotted before and after a peak, taking into account the
anti-bubble phenomenon after a crash [12]. The RP aspect of Fig. 2(RHS)
reveals a feature far from the normal signal evolution; to be noted the well
marked black bands corresponding to the crash time.

About NASDAQ after studied the whole time series the data has been
divided into subseries of 200 days, overlapping each other of almost 5 months,
in order to further analyze whether and how the data changes.

Fig. 3(rhs) is the RP of NASDAQ between Jan. 05, 1998 and Nov. 21,
2003. Of interest is the dark grey vertical band surrounded by a lighter grey
area, delimited by horizontal coordinates x = 452 and x = 690 corresponding
to Oct. 19, 1999 and Sept. 27, 2000. In correspondence of the period in which
the bubble grows, RQA variables take the highest absolute values [13].

It is worth to note the same RP shape of the phase transition signature in
Fig. 2. Considering that each coordinate in RP is linked with the time series,
the border line of a grey or black band reveals the time when the data behavior
starts to change. Noting that the dates here above fall in the same time interval
as the bubble and the subsequent crash, it can be supposed that the initial
bubble time occurs at x = 452 (Oct. 19,1999). We can thus deduce that on
such a day the evolution of the system changes, i.e. the evolution passes from
a normal regime to a critical regime. This is an a posteriori estimation of the
initial bubble time, but through the analysis of the subseries one can argue
to be able to recognize the beginning of the bubble with some delay before
the bubble grows. In fact, while the RPs of the ﬁrst (I), the second (II) and
of the third (III) subseries do not present any remarkable pattern [13] (they
are quite homogeneous except some local maximum reached by the index) the
fourth subseries presents an interesting pattern: the RP in Figure 1(rhs) shows
the characteristic shape typical of the strong trend of a speculative bubble as
studied and pointed out in Fig. 1(lhs). The trend starts to be signiﬁcant in
the middle of Oct. 1999. This indicates that the RP has changed indeed when
the bubble has started. Even the RQA variables, in Table 1, evidence in this
period the highest values. It has to be underlined that this IV period does
not include the crash time, but stops in Dec. 1999 before the bubble bursts.
Even in the ﬁfth (V) subseries RP, the bubble beginning is not so evidently
as it was in the fourth subseries.

In conclusion it has been shown that, with some delay as respect to the
beginning but enough time before the crash (3 months in this particular case),
such that a warning could be given, RP and RQA detect a diﬀerence in state
and recognize the critical regime.

4

Annalisa Fabretti and Marcel Ausloos

Fig. 1. (lhs) RP of a log periodic signal as generated by equation (1). The arrow
shape on the lhs plot is the sign of a strong trend; the curve lines are due to the log
periodicity. (rhs) RP of the NASDAQ subseries (IV) from Jan., 1999 to Dec., 1999.
It is worth to note the similarity between these two RPs

4800

4600

4400

4200

4000

3800

3600

3400

3200

3000

2800

0

200

400

600

800

1000

1200

1400

Fig. 2. (RHS) the RP of a simulated phase transition of a signal (LHS) following
the law (1) before and after the critical event.

Table 1. RQA of NASDAQ on 5 the subseries studied of 200 days.

Subseries
periods

II

I
Jan.1998 June 1998 Oct.1998 Feb.1999 July 1999
Oct.1998 Feb.1999 July1999 Dec.1999 May2000

III

IV

V

%REC
%DET
MAXLINE
ENT
TREND(units/1000points) -105.125 -155.824

9.141
36.119
158
3.547

6.075
35.980
125
2.522

5.513
29.079
83
2.585
-97.808

17.146
45.018
179
4.054
-273.775 -138.501

9.246
54.511
166
3.301

1

Recurrence analysis of the NASDAQ crash of April 2000

5

Fig. 3. (LHS)daily closing price of NASDAQ from Jan. 05, 1998 to Nov. 21, 2003;
(RHS) RP of NASDAQ from Jan. 05, 1998 to Nov. 21, 2003. The dark grey band
delimited by horizontal coordinates x = 504 and x = 566, encircled by a grey area
delimited by horizontal coordinates x = 452 and x = 690, is the ’image’ of the crash
of April 2000. It is a ’strong event’ but afterwards the normal regime is restored

References

1. D. Sornette, A. Johansen, J. P. Bouchaud, 1996. Stock Market Crashes, Pre-

cursors and Replicas, J Phys I France 6 167-175.

2. J. A. Feigenbaum, P. G. O. Freund, 1996. Discrete scale invariance in Stock

Market before crashes, Int J Mod Phys B 10 3737-3745.

3. N. Vandewalle, Ph. Boveroux, A. Minguet, M. Ausloos, 1998. The crash of

October 1987 seen as a phase transition Physica A 255 201-210.

4. N. Vandewalle, M. Ausloos, Ph. Boveroux, A. Minguet, 1998. How the ﬁnancial
crash of October 1997 could have been predicted, Eur Phys J B 4 139-141.
5. A. Johansen, D. Sornette, 2000. The Nasdaq crash of April 2000: yet another
example of log-periodicity in a speculative bubble ending in a crash Eur Phys
J B 17 319-328.

6. J.P. Eckmann, S.O. Kamphorst, D. Ruelle, 1987. Recurrence Plot of dynamical

system, Europhys Lett 4 973-977.

7. J. P. Zbilut, C. L. Webber, 1992. Embedding and delays as derived from quan-

tiﬁcation of Recurrence Plot, Phys Lett A 171 199-203.

8. M. Lambertz, R. Vandenhouten, R. Grebe, P. Langhorst, 2000. Phase tran-
sition in the common brainstem and related systems investigated by nonsta-
tionary time series analysis, Journal of the Autonomic Nervous System 78
141-157.

1

9. A. Antoniou, C. E. Vorlow, 2000. Recurrence Plot and ﬁnancial time series

analysis, Neural Network World 10 131-145.

10. J. A. Holyst, M. Zebrowska, 2000. Recurrence plots and hurst exponents for
ﬁnancial markets and foreign-exchange data, International Journal of Theoret-
ical and Applied Finance 3 419 .

11. J. A. Holyst, M. Zebrowska, K. Urbanowicz, 2001. Observation of deterministic
chaos in ﬁnancial time series by Recurrence Plots, can one control chaotic
economy?, Eur Phys J B 20 531-535.

12. A. Johansen, D. Sornette, 1999. Financial ’Anti-Bubbles’: Log Periodicity in

Gold and Nikkei collapses, Int Journ Mod Phys C 10 563-575.

6

Annalisa Fabretti and Marcel Ausloos

13. A.Fabretti, M. Ausloos, 2005. Recurrence Plot and Recurrence Quantiﬁcation
Analysis Techniques for detecting a critical regime. Examples from ﬁnancial
market indices, Int Journ Mod Phys C 16 xxx-xxx.

