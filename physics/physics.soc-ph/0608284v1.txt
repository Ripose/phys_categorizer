6
0
0
2
 
g
u
A
 
9
2
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
4
8
2
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Self-Consistent Asset Pricing Models ∗

Y. Malevergne1,2 and D. Sornette3,4

1 ISFA Graduate School of Actuarial Science
University of Lyon 1, 50 avenue Tony Garnier, 69366 Lyon Cedex 07, France
2 EM-Lyon Graduate School of Management
23 avenue Guy de Collongue, 69134 Ecully Cedex, France
3 Department of Management, Technology and Economics
ETH Zurich, Kreuzplatz 5, CH-8032 Zurich, Switzerland
4 LPMC, CNRS UMR6622 and Universit´e des Sciences
Parc Valrose, 06108 Nice Cedex 2, France
e-mails: Malevergne@univ-lyon1.fr and dsornette@ethz.ch

February 2, 2008

Abstract

We discuss the foundations of factor or regression models in the light of the self-consistency condition that
the market portfolio (and more generally the risk factors) is (are) constituted of the assets whose returns it
is (they are) supposed to explain. As already reported in several articles, self-consistency implies correlations
between the return disturbances. As a consequence, the alpha’s and beta’s of the factor model are unobservable.
Self-consistency leads to renormalized beta’s with zero eﬀective alpha’s, which are observable with standard
OLS regressions. When the conditions derived from internal consistency are not met, the model is necessarily
incomplete, which means that some sources of risk cannot be replicated (or hedged) by a portfolio of stocks
traded on the market, even for inﬁnite economies. Analytical derivations and numerical simulations show that,
for arbitrary choices of the proxy which are diﬀerent from the true market portfolio, a modiﬁed linear regression
holds with a non-zero value αi at the origin between an asset i’s return and the proxy’s return. Self-consistency
also introduces “orthogonality” and “normality” conditions linking the beta’s, alpha’s (as well as the residuals)
and the weights of the proxy portfolio. Two diagnostics based on these orthogonality and normality conditions
are implemented on a basket of 323 assets which have been components of the S&P500 in the period from
Jan. 1990 to Feb. 2005. These two diagnostics show interesting departures from dynamical self-consistency
starting about 2 years before the end of the Internet bubble. Assuming that the CAPM holds with the self-
consistency condition, the OLS method automatically obeys the resulting orthogonality and normality conditions
and therefore provides a simple way to self-consistently assess the parameters of the model by using proxy
portfolios made only of the assets which are used in the CAPM regressions. Finally, the factor decomposition
with the self-consistency condition derives a risk-factor decomposition in the multi-factor case which is identical
to the principal components analysis (PCA), thus providing a direct link between model-driven and data-
driven constructions of risk factors. This correspondence shows that PCA will therefore suﬀer from the same
limitations as the CAPM and its multi-factor generalization, namely lack of out-of-sample explanatory power and
predictability. In the multi-period context, the self-consistency conditions force the beta’s to be time-dependent
with speciﬁc constraints.

1

Introduction

One of the most important achievements in ﬁnancial economics is the Capital Asset Pricing Model (CAPM),
which is probably still the most widely used approach to relative asset valuation. Its key idea is that the expected

∗

The authors acknowledge helpful discussions and exchanges with R. Roll. All remaining errors are ours.

1

excess return of an asset is proportional to the expected covariance of the excess return of this asset with the
excess return of the market portfolio. The proportionality coeﬃcient measures the average relative risk aversion
of investors. As a consequence, there is an irreducible risk component which cannot be diversiﬁed away, which
cannot be eliminated through portfolio aggregation and thus has to be priced. The central testable implication
of the CAPM is that assets must be priced so that the market portfolio is mean-variance eﬃcient (Fama and
French, 2004; Roll, 1977). However, past and recent tests have rejected the CAPM as a valid model of ﬁnancial
valuation. In particular, the Fama/French analysis (Fama and French, 1992; 1993) shows basically no support
for the CAPM’s central result of a positive relation between expected return and global market risk (quantiﬁed
by the beta parameter). In contrast, other variables, such as the market capitalization and the book-to-market
ratio or the turnover and the past return, present some explanatory power.

More and more sophisticated extensions of the CAPM beyond the mean-variance approach have not improved
the ability of the CAPM and its generalization to explain relative asset valuations. Let us mention the multi-
moments CAPM, which has originally been proposed by Rubinstein (1973) and Krauss and Litzenberger (1976)
to account for the departure of the returns distributions from Normality. The relevance of this class of models
has been underlined by Lim (1989) and Harvey and Siddique (2000) who have tested the role of the asymmetry
in the risk premium by accounting for the skewness of the distribution of returns and more recently by Fang and
Lai (1997) and Hwang and Satchell (1999) who have introduced a four-moments CAPM to take into account
the letpokurtic behavior of the assets return distributions. Many other extensions have been presented such as
the VaR-CAPM (Alexander and Baptista, 2002), the Distributional-CAPM (Polimenis, 2005), and generalized
CAPM models with consistent measures of risks and heterogeneous agents (Malevergne and Sornette, 2006a),
in order to account more carefully for the risk perception of investors.

The arbitrage pricing theory (APT) provides an alternative to the CAPM. Like the CAPM, the APT assumes
that only non-diversiﬁable risk is priced. But, unlike the CAPM which speciﬁes returns as a linear function of
only systematic risk, the APT is based on the well-known observations that multiple factors aﬀect the observed
time series of returns, such as industry factors, interest rates, exchange rates, real output, the money supply,
aggregate consumption, investors conﬁdence, oil prices, and many other variables (Ross, 1976; Roll and Ross,
1984; Roll, 1994). While observed asset prices respond to a wide variety of factors, there is much weaker evidence
that equities with larger sensitivity to some factors give higher returns, as the APT requires. This weakness
in the APT has led to further generalizations of factor models, such as the empirical Fama/French three factor
model (Fama and French, 1995), which does not use an arbitrage condition anymore. Fama and French started
with the observation that two classes of stocks show better returns that the average market: (1) stocks with
small market capitalization (“small caps”) and (2) stocks with a high book-value-to-price ratio (often “value”
stocks as opposed to “growth” stocks).

What then survive of the fundamental ideas underlying the CAPM? A key remark is that, given a set of assets,
what is literally tested is the eﬃciency of a speciﬁc proxy for the market portfolio together with the CAPM. As
recalled by Fama and French (2004), the CAPM requires using the market portfolio of all the invested wealth
(which includes stocks, bonds, real-estate, commodities, etc.). More precisely, as ﬁrst stressed by Roll (1977),
“The theory is not testable unless the exact composition of the true market portfolio is known and used in
the tests. This implies that the theory is not testable unless all individual assets are included in the sample.”
(italics in Roll (1977)). Unfortunately, the market proxies used in empirical work are almost always restricted
to common stocks, and as pointed out by Roll, the composition of a proxy for the market portfolio can cause
quite confusing inferences on the validity of the test and the mean-variance eﬃciency of the market portfolio.
It is thus possible that the CAPM holds, the true market portfolio is eﬃcient, and empirical contradictions of
the CAPM are due to bad proxies for the market portfolio. Given a universe of N assets, it is always possible
to construct a mean-variance portfolio (or any multi-moment generalization thereof), which will be such that
the expected excess return of an asset is proportional to the expected covariance of the excess return of this
asset with the excess return of the mean-variance portfolio. This results mechanically (or algebraically) from
the construction of the mean-variance portfolio. While this property looks identical to the central test of the
CAPM, in order for the CAPM to hold and for such a mean-variance portfolio to be the market portfolio, it
should remain a mean-variance portfolio ex-ante (out-of-sample). The failure of the CAPM together with such
a construction for the proxy of the market portfolio is revealed by the notorious instability of mean-variance
portfolios (see for instance Michaud, 2003) with their weights needing to be continuously readjusted as a function
of time. Empirically, the problem is that a mean-variance portfolio constructed over a given time interval will
be no more in general a mean-variance portfolio (even allowing for a diﬀerent average return) in the next period,
and can not thus qualify as the market portfolio.

In addition to this problem of the market portfolio proxy, the “disturbances” in factor models are correlated,

2

as a consequence of the self-consistency condition that, in a complete market, the market portfolio and, more
generally, the explanatory factors are made of (or can be replicated by) the assets they are intended to explain
(Fama, 1973) (see also Sharpe (1990)’s Nobel lecture). This presence of correlations between return residuals
may a priori pose problems in the pricing of portfolio risks: only when the return residuals can be averaged out
by diversiﬁcation can one conclude that the only non-diversiﬁable risk of a portfolio is born by the contribution
of the market portfolio which is weighted by the beta of the portfolio under consideration. Previous authors
have suggested that this is indeed what happens in economies in the limit of a large market N → ∞, for which
the correlations between residuals vanish asymptotically and the self-consistency condition seems irrelevant. For
example, while Sharpe (1990; footnote 13) concluded that, as a consequence of the self-consistency condition,
at least two of the residuals, say εi and εj, must be negatively correlated, he suggested that this problem may
disappear in economies with inﬁnitely many securities. In fact, we show in Malevergne and Sornette (2006b)
that this apparently quite reasonable line of reasoning does not tell the whole story: even for economies with
inﬁnitely many securities, when the companies exhibit a large distribution of sizes as they do in reality, the
self-consistency condition leads to the important consequence that the risk born out by an investor holding a
well-diversiﬁed portfolio does not reduce to the market risk in the limit of a very large portfolio, as usually
believed. A signiﬁcant proportion of “speciﬁc risk” may remain which cannot be diversiﬁed away by a simple
aggregation of a very large number of assets. Moreover, this non-diversiﬁable risk can be accounted for in the
APT by an additional factor associated with the self-consistency condition.

Here, our more modest goal is to present a review of the foundation of factor models using the self-consistent
condition as a pivot to organize the presentation and form threads across diﬀerent results scattered in the
literature. Our goal will be reached if the reader starts to appreciate, as the authors did in the course of their
digestion of the literature leading to some new results reported in (Malevergne and Sornette, 2006b), the many
subtle issues interconnecting the concepts of equilibrium, no-arbitrage and risk pricing. In the physicist language,
these concepts describe ultimately what can probably be seen as the attractive ﬁxed point (equilibrium) of self-
organizing systems with feedbacks. We believe that the study of the inner-consistency of these models can be
useful to inspire the development of novel approaches addressing the above issues and others.

The organization of the paper is the following. In the next section, we consider an equilibrium model where the
assets return dynamics can be explained by a single factor, the market. At equilibrium, this model is consistent
with the CAPM but, due to the self-consistency condition that the market portfolio is constituted of the assets
whose returns it is supposed to explain, the parameters of the original factor model remain unobservable. Only
the CAPM beta’s are observable if the true market portfolio is known. Due the self-consistency condition, the
residuals of the regression of the assets’ returns with respect to the market portfolio can only be deﬁned with a
zero intercept. Then, the orthogonality condition obtained in Fama (1973) concerning the disturbances of the
factor models is derived both for a one-factor as well as for a multi-factor model. In section 3, we discuss the
calibration issues associated with the one factor model in relation with the impact of the non-observability of the
actual market factor. We illustrate that, if a proxy is used (which is the real-life situation), then one can only
measure a modiﬁed beta value which may diﬀer from the true beta. In addition, a non-zero ‘alpha’ appears,
which has however nothing to do with the unobservable alpha of the original factor model, but reﬂects the
diﬀerence between the proxy and the market portfolio. Section 4 addresses the same question for multi-factor
models. A multi-factor analysis with the self-consistency condition is shown to be equivalent to the principal
component analysis (PCA) applied to baskets of assets. In the light of these results, section 5 oﬀers a discussion
of the theoretical and practical limitations of the factor-models. It underlines the necessity for the introduction of
non constant β’s and propose some restrictions on the possible dynamics for the β. All the technical derivations
are gathered in the 6 appendices.

2 Self-consistency of factor models

2.1 One-factor model: dynamical consistency of the CAPM

2.1.1 Factor model from CAPM

The celebrated Capital Asset Pricing Model, derived by Sharpe (1964), yields the famous relation known as the
Market Security Line

E [ri] = r0 + βi · E [rm − r0] ,

(1)

3

where rm, ri and r0 denote the market return, the return1 on asset i and the risk free interest rate respectively,
while

As stressed by Sharpe (1990), “the value βi can be given an interpretation similar to that found in regression
analysis utilizing historic data, although in the context of the CAPM it is to be interpreted strictly as an ex-ante
value based on probabilistic beliefs about future outcomes.” If the investors’ anticipations are self-fulﬁlling, the
relationship between ri and rm can be modeled as

βi =

Cov (ri, rm)
Var rm

.

ri = ai + βi · rm + εi ,

with ai = (1 − βi) r0, provided that the expectation of the residual E [εi] is assumed to be zero. These two
conditions ai = (1 − βi) r0 and E [εi] = 0 ensures that the market portfolio is eﬃcient in the mean-variance sense.
Indeed, taking expectations (or sample means) of (3), one obtains an exact linear cross-sectional relation between
mean returns and beta’s. There is a one-to-one correspondence between exact linearity and mean/variance
eﬃciency of the market portfolio (Bodie et al., 2004).

2.1.2 CAPM from a factor model

Let us now start from the opposite view point to determine the conditions under which the CAPM relation
holds for an economy obeying a linear factor model, where the excess returns of asset prices over the risk-free
rate r0 are determined according to the following equation 2

~rt = ~α + ~β0 · rm(t) + ~εt,

where ~rt is the N × 1 vector of asset excess returns at time t, rm(t) is the excess return on the market portfolio
and ~εt is a vector of disturbances with zero average E [~εt] = ~0 and covariance matrix Ωt = E [~εt · ~ε′
t]. We assume
that Ωt is a deterministic function of t and that the ~εt are independent. We do not make any other assumption
concerning Ωt, in particular, we do not assume that it is a diagonal matrix since the CAPM places no restriction
on the correlation between the disturbance terms. The symbols ~α and ~β0 represent constant N × 1 vectors.

Let us assume that the model (4) is common knowledge, i.e., each economic agent knows that the asset
returns follow equation (4), each agent knows that all other agents know that the assets returns follow equation
(4), and so on... Let us assume that, by reallocating her wealth Wt among the n risky assets and the risk-free
asset at each intermediate time period t = 1, . . . , T − 1, each agent aims at maximizing her expected terminal
wealth WT under the constraint that its variance Var WT is not greater than a predetermined level σ2
WT .
Mathematically, this dynamic optimization program reads

max
~w

E [WT ]

(P) :

s.t Var WT ≤ σ2

WT
Wt+1 = Wt [1 + ~w′~rt + r0] ,

t = 0, 1, . . . , T − 1.

Many other approaches have been considered in the large body of literature devoted to the problem of optimal
investment selection in a multi-period framework. In particular, the approaches based on the maximization of
the expected utility of the terminal wealth or of the lifetime consumption seem to dominate, but they often rely
on a speciﬁc choice of the utility function, such as the CARA, HARA or quadratic utility functions (Samuelson,
1969, Hakansson 1971, Pliska 1997, among many others). Since the choice of a particular utility function may
appear as arbitrary, we have preferred to resort to the mean-variance criterion in so far as it constitutes a low
order expansion approximation which holds irrespective of the speciﬁc form of the utility function.

The solution of problem (P) can be found for instance in Li and Ng (2000): at each time period t, the optimal

strategy amounts to invest a fraction of wealth in the risk free asset and the remaining in the risky portfolio

(2)

(3)

(4)

(5)

(6)

1Given the price Pi(t) of security i at time t, is return is deﬁned as ri(t) =
2in all what follows, we work with excess returns, i.e., returns decreased by the risk-free rate r0 but use the same notation as for

Pi(t+1)
Pi(t)

− 1.

the returns to simplify the notations.

~w∗

t =

Σt
~1′Σt

−1E [~rt]
−1E [~rt]

,

4

where Σt = Cov ~rt denotes the covariance of the vector of excess returns of the asset prices over the risk-free
rate, at time t. As we shall see in the sequel, Σt and E [~rt] are known functions of t, which is a necessary
assumption for the solution given by Li and Ng (2000) to hold.

Since all agents invest only in two funds, namely the risk-free asset and the risky portfolio with weights ~w∗
t ,
if we assume that an equilibrium is reached at each time t, then the composition ~w∗
t of the risky portfolio must
represent that of the market portfolio at time t. In other words, in full generality, ~w∗
t given by (6) is nothing
but the eﬃcient tangency portfolio on the frontier composed of the existing risky assets. It becomes the market
portfolio of all assets when the assets being considered here comprise indeed all assets, which is the case we ﬁrst
examine. Section 3 discusses what happens when this is not the case. For the sake of simplicity, we will denote
by ~wt the composition of the market portfolio.

It is important to note that the result (6) holds irrespective of the time horizon T chosen by the investors
because the composition ~wt of the market portfolio is independent of T . Only the relative part of wealth invested
in the risk-free asset and in the market portfolio depends on T , but this has no eﬀect on the composition ~wt of
the market portfolio. As a consequence, the result still holds when investors have diﬀerent time horizons, as in
real markets.

Now, accounting for the fact that the market factor is itself built upon the universe of assets that it is
supposed to explain (which we refer to as the “self-consistent condition”), the model must fulﬁll the internal
consistency condition

Starting from this self-consistency condition together with the assumption that investors follow a dynamic mean-
variance strategy and with the condition of market equilibrium, we show in Appendix A that the regression model
(4) leads to the CAPM

rm(t) = ~w′

t · ~rt.

E [~rt] = ~βtE [rm(t)] ,

with

~βt =

Cov (~rt, rm(t))
Var rm(t)

=

′

Ω−1

t ~α

~1 − ~β0
(cid:16)

~α′Ω−1
(cid:17)
t ~α

~α + ~β0 .

This shows that the regression model (4) is consistent with the relation of the CAPM provided that the internal
consistency condition (7) holds together with the existence of an equilibrium.

The rather lengthly derivation in Appendix A is not needed in the standard approach in which the vector
~α is identically zero and the market portfolio is mean-variance eﬃcient as given by (6). Appendix A makes
explicit that the parameters of the market model (4) are of no consequence for the CAPM. Appendix A derives
the expression of the observable parameters of the CAPM (in particular the beta) from the parameters α’s, β0’s
and the matrix Ω of the covariance of the disturbances ~ε of the market model3.

Therefore, the general regression model (4) provides a reasonable statistical model to test the CAPM relation
(8). But, two important point must be discussed. First, even if ~α and ~β0 are assumed constant, the CAPM’s
β depends on time t as soon as Ωt is not constant. Thus, the heteroscedasticity of the residuals is suﬃcient to
make the β’s time varying. Since, in the real market, the variance of assets returns is time varying (the so-called
GARCH eﬀect), one has to account for the dynamics of the β’s. Second, the equilibrium imposes a dynamic
constraint on the composition of the market portfolio. On the one hand, it is endogenously determined by the
investors’ anticipations according to formula (6). On the other hand, the market portfolio must be related to
the market capitalization of each asset, which reﬂects the economic performance of the ﬁrms. Thus, the relation

(7)

(8)

(9)

(10)

wi

t+1 = wi
t ·

1 + ri

t + r0

1 + rm(t) + r0

must hold. The r0 appears in the numerator and denominator because of our convention to denote by ri
t and
rm(t) the excess returns of asset and market prices over the risk-free interest r0. For the time being, we assume
that this relation (10) is compatible with the dynamics described by (4) and with the optimal portfolio allocation
(6) and will discuss this point in more detail at the end of this article.

3As we clarify further below, the disturbances ~ε of the market model are not the residuals of an OLS (ordinary least-square)

regression

5

2.2 One-factor model: observable parameters, orthogonality and normalization
conditions

For ease of the exposition, let us assume that Ωt remains constant during the time interval under consideration.
As a consequence, ~β can be a priori independent of t as shown by eq. (9), allowing us to remove the subscript
t in the sequel.

The previous sub-section has made clear that, according to (9), the coeﬃcients ~β of the CAPM can be
expressed in terms of the α’s, β0’s and the matrix Ω of the covariance of the disturbances ~ε of the market model.
Actually, one can go further and show that the self-consistency condition implies that only ~βt is observable while
the coeﬃcients ~α and ~β0 are unobservable. Indeed, expression (4) cannot be directly calibrated by the OLS
estimator since the disturbances ~εt are correlated with the regressors while an OLS estimation automatically
construct residuals which are orthogonal to the factor decomposition. To see why the disturbances ~εt are
correlated with the regressors rm(t), let us left-multiply expression (4) by ~w′
t. Then, the self-consistency condition
(7) implies that

rm(t) =

~w′
t · (~α + ~εt)
t · ~β0
1 − ~w′

,

unless wt ~β0 = 1.

The fact that the regressors rm(t) are correlated with the residuals ~εt does not invalidate the OLS procedure.
It just means that the OLS procedure will estimate residuals which are diﬀerent from the model disturbances.
The observed residuals are obtained by decomposing the disturbances ~εt on its component correlated with rm(t)
plus a contribution uncorrelated with rm(t). We thus introduce two non-random vectors ~δ, ~γ and the random
vector ~ut, uncorrelated with rm(t) with zero mean, such that

Then, Appendix B shows that the one-factor model reduces to

with the “normalization” and ”orthogonality” conditions

~εt = ~δ + ~γ · rm(t) + ~ut.

~rt = ~β · rm(t) + ~ut ,

~w′
t

~β = 1

and

~w′

t~ut = 0 ,

which derive from the self-consistency condition (7). The result (13) means that, under the assumption that
rm(t) is observable, the OLS estimator of (4) provides an estimate of ~β and not of ~β0 and ~α which remain
unobservable. Taking the expectation of (13) recovers the CAPM prediction (8) as it should.

We should stress that the orthogonality condition ~w′

t~ut = 0 shows that at least two of the ut,i must be
negatively correlated, which resemble Sharpe (1990)’s statement in his footnote 13. But, there is an important
diﬀerence in that the regression (13) has zero intercept (its “alpha” is zero). The absence of intercept together
with the mean-variance nature of the market portfolio automatically ensures the validity of the CAPM relation
(8).

Using the jargon of physicists, we can rephrase these results as follows. The self-consistency condition
together with the mean-variance eﬃcient nature of the market portfolio imply that the market model (4) is
“renormalized” into an observable model given by expression (13) with (14), that is, the “bare” parameters
~α and ~β0 are renormalized into ~0 and ~β. A standard OLS regression (a measurement) gives access only to
the renormalized values ~0 and ~β, in the same that physicists can only measure for instance the large scale
renormalized mass and charge of an electron and not its bare values (Lifshitz et al., 1982).

2.3 Multi-factor model

Let us generalize (4) and assume that the excess return vector ~rt of n securities traded on the market (made of
these n assets), over the risk free interest rate, can be explained by the q-factor model

(11)

(12)

(13)

(14)

(15)

(16)

~rt =

~βiui(t) + ~εt,

= B~u(t) + ~εt,

q

i=1
X

6

where B is the n × q matrix which stacks the vectors ~βi, ~ut is the vector whose ith component is the ith risk
factor ui and E [~ε(t)] = 0.

With n assets and n + q sources of randomness, the market is a priori incomplete. The market becomes

complete if all risk factors can be replicated by an asset portfolio.

Consider the risk factor i, which can be replicated by the portfolio ~wi, that is, ui(t) = ~w′

i~rt in vector notations.

The internal consistency of the model implies that

so that

~w′

i~rt = ui(t) =

~w′
i

~βj

uj(t) + ~w′

i~εt,

~w′
i

~βj

uj(t) +

~w′
i

~βi − 1

ui(t) + ~w′

i~εt = 0 .

j6=i (cid:16)
X

(cid:17)

(cid:16)

q

j=1 (cid:16)
X

(cid:17)

(cid:17)

For a complete market such that all the risk factors ui’s can be replicated by asset portfolios ~wi’s, i = 1, . . . , q
and denoting by W the matrix which stacks all the portfolio weight vectors ~wi’s, the self-consistency condition
(18) generalizes into

Taking the expectation of both sides yields

(Id − W ′B) ~u(t) = W ′~εt .

(Id − W ′B) E [~u(t)] = 0 ,

since we assume E [~ε(t)] = 0. Two cases must be considered.

• First case: det (Id − W ′B) 6= 0 and the unique solution is E [~u(t)] = 0, so that E [~rt] = 0 by (16), which

does not capture a real economy.

• Second case: det (Id − W ′B) = 0, which means that the matrix W ′B has rank q − p, for some 0 < p ≤ q.
Provided that the system admits a solution, this solution can be expressed as a linear combination of p
independent vectors. As a consequence, the expected excess return on each individual asset E [ri] can be
expressed as the linear combination of the expected value of only p risk factors. Therefore, only p factors
really matter. This implies that, if we assume that assets excess returns really depend upon p = q factors,
the rank of the matrix (Id − W ′B) should be q − p = 0 so that the expectation of the excess return on
each individual asset E [ri] can be expressed as the linear combination of the expected value of all the q
risk factors. In such a case, we will say that the model is irreducible, an hypothesis that we will assume
to hold in the sequel. The case p < q can be treated analogously by expressing the excess return of each
individual asset as a linear combination of the expected value of the p risk factors.

The condition that the rank of the matrix (Id − W ′B) should be zero for the asset excess returns to depend

on the q irreducible factors simply means that the normalization condition

must hold. This relation is satisﬁed by the market factor in the CAPM, and generalizes the normalization
condition discussed in section 2.1. In addition, equation (19) together with (21) enables us to conclude that

which means that the vector ~εt of disturbances has dimension n − q at most, provided that W is full rank, i.e.
provided that the q risk factors ui(t) can be replicated by q linearly independent portfolios ~wi. Condition (22)
generalizes the orthogonality condition for the one-factor model derive in section 2.2. The two conditions (21)
and (22) generalize the orthogonality and normalization conditions (14) obtained for the one-factor CAPM.

Note that ~u and ~ε are uncorrelated under the condition that the q risk factors ui(t) can be replicated by q

linearly independent portfolios.

To sum up, the possibility to replicate the risk factors by portfolios implies strong internal consistency
conditions for factor models, namely equations (21) and (22). Conversely, if these conditions are not met, the
model is necessarily incomplete, which means that some sources of risk cannot be replicated (or hedged) by
an asset portfolio. Therefore, risk factors, such as the GDP, the term spread, the dividend yield, the size and
book-to-market factors (Fama and French, 1993; 1995) and so on, could bring in additional information with
respect to the usual market factor. See Petkova (2006) for empirical evidence.

W ′B = Id

W ′~εt = 0 ,

7

(17)

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

(26)

3 Non-observability of the market portfolio (One-factor model)

3.1 What if the proxy is diﬀerent from the true market portfolio?

In practice, the true market factor is unknown and one commonly uses a proxy. We show in Appendix C that
model (13) leads to

~rt =

E [rm] ~β − E [˜rt]

~˜β · ˜rt + ~ηt ,
+

~˜β
(cid:17)

(cid:16)

~˜α

~˜β is the vector of beta’s of the regression of asset excess returns on the proxy
where ˜rt is the proxy excess return,
and ~ηt has zero mean E [~ηt] = 0 and is uncorrelated with the proxy Cov (~η, ˜rt) = 0. The explicit dependence of
~˜β as a function of the true ~β, the weights ˜w′
t of the portfolio proxy, the variance Varrm of the market portfolio
excess returns and the covariance matrix ˜Ω of the vector ~ut of residuals of the model (13) is given in equation
(85).

{z

|

}

The result (23) derives straightforwardly from the CAPM formulated explicitly with (13) and (14) by again
using a self-consistent (or endogenous) condition that the proxy is itself a portfolio of the assets it is supposed to
explain. As a consequence of the internal consistency requirement, one gets new orthogonality and normalization
conditions. As previously, we have the normalization and orthogonality conditions

where ˜wt represents the composition of the proxy at time t. In addition, we have the following orthogonality
constraint

~˜β = 1,

˜w′
t

and

˜w′

t~ηt = 0,

˜w′
t

~˜α = ˜w′
t

E [rm] ~β − E [˜rt]
(cid:16)
˜w′ ~β
(cid:16)

(cid:17)

β of the proxy

,

~˜β
(cid:17)

=

·E [rm] − E [˜rt] ,

= 0 ,

| {z }

provided that the CAPM relation holds.

~˜β in
Using a proxy instead of the true market portfolio yields a non-vanishing intercept ~˜α = E [rm] ~β − E [˜rt]
the regression of the excess returns of each asset as a function of the excess returns of the portfolio proxy, which
is a priori diﬀerent from asset to asset. However, taking the expectation of (23), we obtain

E [ri,t] = E [rm] βi =

E [rm]
E [˜rt]

βi
˜βi (cid:19)

E [˜rt] ˜βi ,

(cid:18)
for each individual asset i. As in the standard CAPM prediction, we thus obtain that the expected excess return
E [~ri,t] of an asset i is proportional to its beta ˜βi (obtained from the conditional regression (23)). But there
is a major diﬀerence with the standard CAPM prediction, which is that the coeﬃcient of proportionality is
not simply the expectation E [˜rt] of the proxy excess returns (as one could expect naively from translating the
standard result to the proxy case). The diﬀerence involves the two correction factors E [rm] /E [˜rt] and βi/ ˜βi,
the second one being non-constant since it is a function of ˜βi itself. Recall that E [rm] and the βi’s are in
principle unobservable. We can thus expect a deviation from the standard CAPM linear relationship due to an
increased scatter induced by the scatter in the coeﬃcient of proportionality between expected excess return and
beta evaluated with a market proxy.

Although this result is generally true, there is an exception.

If the proxy happens to be on the ex-ante
mean/variance eﬃcient frontier, there will be an exact cross-sectional relation between expected returns and
betas (calculated against the proxy) and there will be no scatter around the linear relation between mean returns
and beta’s. Any market proxy will produce exact linearity, not just the tangency portfolio from the translated
(by r0) origin. Of course, the beta’s will be diﬀerent for each such proxy but there will be no scatter. Generally,
there is no need to assume the existence of a riskless rate. This is the heart of Black (1972)’s generalization
of the CAPM. If there is no riskless rate, any ex-ante mean-variance eﬃcient portfolio, which can lie anywhere
on the positive or negative part of the frontier, will produce exact cross-sectional mean return/beta linearity.
The only exception is the global minimum variance portfolio, which is positively correlated with all assets. For
all other market proxies, there is a “zero-beta” portfolio, a portfolio uncorrelated with the chosen proxy, which
serves in place of the riskless rate.

8

(27)

(28)

(29)

(30)

3.2 Empirical illustration

As an illustration, let us ﬁrst take the S&P500 index as a proxy for the USA market portfolio. Figure 1 shows
the average daily return of Exxon mobil (ticker XOM) daily returns conditioned on a ﬁxed value of the S&P500
index daily returns rm(t) over the period from July 1962 to December 2000. In practice, we consider a given
value rm (to within a small interval) of the S&P500. We then search for all days for which the return of the
S&P500 was equal to this value rm (to within a small interval). We then take the average of the daily return
of Exxon mobil realized in all these days. We then iterate by scanning all possible values of rm and use a
kernel estimation to get a smoother and more robust estimation. Note that this procedure is non-parametric
and provides an interesting determination of the market model. Indeed, suppose that the return ri of an asset
i is given by

where Fi[x] is an a priori arbitrary (possibly non-linear function) and e(t) are the zero-mean residuals. Then,
the above non-parametric procedure (whose result is shown in ﬁgures 1 and 2) amounts to calculate E[ri|rm = x]
as a function of x:

ri(t) = Fi[rm(t)] + e(t) ,

E[ri|rm = x] = Fi[x] .

Figure 1 plots the function Fi[x] determined non-parametrically from the data. It seems that a linear dependence
proves a reasonable approximation of the data presented in Fig. 1. The straight line is the line of equation
y = αXOM + βXOM · rSP 500(t), where βXOM is obtained from the regression

rXOM(t) = αXOM + βXOM · rSP 500(t) + εXOM(t)

of the returns.

This plot presented in Fig. 1 is typical of the relationship between conditional expected returns as a function
of the return of the S&P500 index, obtained for all stocks in the S&P500, as shown from the superposed data
in ﬁgure 2. Figure 2 is the same as ﬁgure 1, but for 25 diﬀerent assets. In order to represent the corresponding
functions Fi(x) for each asset on a same ﬁgure without loosing visibility, we have just translated and scaled each
curve, i.e., we plot

E [ri − r0|rSP 500 − r0] − αi
βi

= (Fi[x] − αi)/βi ,

as a function of x = rSP 500 − r0, where the αi’s and βi’s are obtained by linear regressions similar to (29),
one ﬁt being performed for each non-parametrically determined Fi. The risk-free interest rate r0 is basically
negligible at the daily scale. E [ri − r0|rSP 500 − r0] is the expected return of stock i above the risk-free interest
rate, conditional on the value of rSP 500 − r0. The straight line in Figure 2 has slope 1 and goes through the
origin, thus conﬁrming the remarkable quality of the relationship between the conditional expected asset returns
and the S&P500 index daily returns, in agreement with (23). In other words, Figure 2 seems to conﬁrm that
the Fi’s appear to be quite closely approximated by an aﬃne function: Fi[x] = αi + βix.

We have performed similar regressions as a function of the S&P500 returns for the monthly returns of the
323 stocks which remained into the composition of the S&P500 over the period between January 1990 and
February 2005. But, in order to test the self-consistency condition and its consequences derived above, one
could argue that it should be better to construct a market portfolio based solely on these 323 stocks. We
have thus constructed an eﬀective S&P323 index, constituted as a portfolio of these 323 stocks with weights
proportional to their capitalizations. The regressions of the expected monthly returns of each of these 323 stocks
conditioned on the S&P323 index monthly returns as a function of the S&P323 index monthly returns are similar
to those obtained on the S&P500 and resemble the regressions shown in ﬁgures 1 and 2 albeit with more noise
(not shown). Figure 3 shows the population of the intercepts (the alpha’s) of these regression. The abscissa is
an arbitrary indexing of the 323 assets. The estimated probability density function of the population of alpha’s
is shown on the right panel and illustrates the existence of a systematic bias for the alpha’s, as expected from
the previous section 3.1. Note that the bias is negative which reﬂects the fact that over the period of study, the
average performance of the S&P323 (and even more so for the S&P500) has been smaller than the risk-free rate.
Another way of formulating the existence of the bias is just to say that the constructed index is not located on
the sample eﬃcient frontier.

Figure 4 plots the expected returns E [ri − r0] of the monthly excess returns of the 323 assets used in ﬁgure 3
as a function of their βi obtained by regressions with respect to the excess return to the eﬀective S&P323 index.
Under the CAPM hypothesis, one should obtain a straight line with slope E [rSP 323 − r0] (−13.1% per month)
and zero additive coeﬃcient at the origin. The straight line is the regression y = 0.88% − 13.5% · x. A standard

9

statistical test shows that the value 0.88% of the intercept at the origin is not statistically signiﬁcant from zero.
Together with the reasonable agreement between the slope of the regression and the excess expected returns of
the S&P323 index, this would give a positive score for the CAPM. This is perhaps surprising considering the
biases distribution of alpha’s shown in ﬁgure 3. This suggests that this standard expected return/beta tests
exampliﬁed in ﬁgure 3 has not large power.

~˜β and ˜w′

~˜β = 1 (expression 24) and ˜w′

As a complement, one can use the self-consistency conditions ˜w′
t

~˜α = 0 (expression
25) to perform empirical tests. As explained in section 2.1, the dynamical consistency of the CAPM imposes
that these two relationships should hold at each time step for the proxy of the market portfolio. We have thus
~˜α, where ˜wt is the vector of weights of the 323 stocks in our eﬀective S&P323 index which
calculated ˜w′
t
~˜β and ~˜α are the two vectors of beta’s
evolves at each time step according to the capitation of each stock while
~˜β and
and alpha’s obtained from the regressions used in ﬁgures 3 and 4. Figure 5 shows the time evolution of ˜w′
t
~˜α over the period from January 1990 to February 2005 which includes 182 monthly values. The deviations
˜w′
t
respectively from 1 and 0 are signiﬁcant, as shown by a standard Fisher test. The close connection between
the time varying average alpha and beta shown in Figure 5 results from their common dynamics through the
evolution of the weights ~w.

t

t

The variable ˜w′
t

~˜β can be interpreted as the average beta of the stocks in the self-consistent market proxy.
~˜β > 1, this can be
A value diﬀerent from 1 suggests that the market is out of equilibrium. In particular, if ˜w′
t
interpreted as an “over-heating” of the market with the existence of positive feedback. Interestingly, this occurs
just about two years before the peak of the Internet bubble in April 2000. It then took about two years after
the peak to recover an equilibrium. Since early 2003, the market seems to have remained approximately at
equilibrium according to this metric.

3.3 Tests on a synthetically generated market

In order to investigate the sensitivity of these tests, and in particular the impact of using a proxy for the
market portfolio, we have constructed a toy (synthetic) market in which 1000 assets are traded and such that
their returns at time t obey equation (13) with the constraints (14). The weight of each asset in the market
portfolio is drawn from a power law with tail index equal to one, in accordance with empirical observations on
the distribution of ﬁrm sizes (Axtell, 2001), and then renormalized so that the weights sum up to one. For the
purpose of illustration and easiness in testing, we impose that the composition of the market remain constant,
i.e., the economy is stationary. The interest in this condition is that we can then study the pure impact of
not observing the true market but only the proxy constructed on a subset of the whole universe of assets. The
daily return on the synthetic market factor follows a Gaussian law with mean and standard deviation equal to
the mean and the standard deviation of the daily return on the S&P500 over the time period from July 1962
to December 2000, namely 0.037% and 0.90% respectively. The β’s are also randomly drawn from a uniform
law with mean equals to one and are such that they satisfy the normalization condition (14). It can be seen in
ﬁgure 6 that the β’s range between 0.35 and 1.15, which is reasonable if we refer to the values usually reported
in the literature. Finally, the residuals ~εt are drawn from a degenerate multivariate Gaussian distribution (i.e.,
the rank of its covariance matrix is N − 1 = 999), so that they fulﬁll the orthogonality condition (14). The
variances and covariances of these residuals have been ﬁxed in such a way that they are of the same order of
magnitude as the variances and covariances of the residuals estimated by linear regression of our basket of 25
assets on the S&P500. Thus, the values given by our toy market are expected to be consistent with the values
observed on the actual market if the description by a one factor model has some merit.

Using the OLS estimator, we have ﬁrst performed a regression with respect to the true market portfolio,
whose composition is assumed to remain constant as we said. Then, we have constructed an arbitrary portfolio
and have considered it to be the proxy of the market portfolio. We have then performed the linear regression of
the assets returns on the proxy returns. Figure 6 compares the estimated beta’s obtained from the regression of
the asset returns on the returns of the market portfolio with those obtained from the regression on the returns of
the proxy, as a function of the true beta’s. The regression on the market factor gives a line with unit slope and
zero intercept, as expected from the construction of the synthetic market. The regression on the proxy returns
~˜β given by (85) in Appendix C.
gives also a straight line, as predicted from the linear relation between ~β and
Figure 6 provides a veriﬁcation of the properties put by construction in our synthetic market. Obviously, no one
would be able to perform this veriﬁcation on real data since the market portfolio and thus the true beta’s are
unknowable.

Figure 7 shows the population of the intercepts of the regression of expected stock returns versus the market

10

return or versus the proxy return in our synthetic market. These intercepts are presented as a function of the
(arbitrary) indices of the 1000 assets. For the regression on the market factor, one can observe as expected a
scatter around zero. For the regression on the market proxy, the intercepts are, on average, all signiﬁcantly
diﬀerent from zero. As expected, the orthogonality and normalization conditions ˜w′~α = 0 and ˜w′~˜β = 1 are
satisﬁed, providing a veriﬁcation of the validity of the numerical implementation of the model for these synthet-
ically generated data. Thus, ﬁgure 7 conﬁrms that a universe of assets which by construction obeys the CAPM
exhibits non-zero alpha intercepts (which take apparently random values) when using an arbitrary proxy. This
result can be compared with the empirical analog shown in ﬁgure 3.

Figure 8 shows the individual expected returns E [ri] for each of the 1000 assets (i) as a function of the true
βi’s, (ii) as a function of the βi’s obtained by regression on the true market and (iii) by regression on the proxy.
As expected, the dependence of the expected returns on the true beta’s and on the beta’s obtained from the
true market portfolio follows the CAPM prediction, but with rather signiﬁcant ﬂuctuations. The scatter of the
dependence of the expected returns on the beta’s determined from the proxy is larger but one can still observe
a well-deﬁned linear dependence with a zero intercept, and a slope diﬀerent from the expected return E [˜rt] of
the portfolio proxy, as predicted in expression (26). This seems to justify why the bias in the distribution of
alpha’s does not seem to aﬀect the existence of the standard expected return/beta test shown in ﬁgure 3.

3.4 On the orthogonality and normality conditions

To summarize, the condition of self-consistency leads to the orthogonality and normality conditions (14) for
the mono-factor model and to (21,22) for the multifactor model when the market portfolio is known. The
orthogonality and normality conditions still hold when only a market proxy is available and they take the form
(24) together with the additional orthogonality constraint (25). This suggests to use the orthogonality and
normality conditions as new tests of the CAPM in the real-life situation where the market portfolio is not known
and a somewhat arbitrary proxy is used. The motivation of these tests stems from the fact that they are not
aﬀected by the problem of using a proxy which is diﬀerent from the real market factor, in contrast with the
problem on the standard test of the CAPM made explicit in ﬁgure 8. Concretely, this suggests to complement
the standard expected excess return versus beta, by tests checking the validity of the orthogonality and normality
conditions when using for the proxy, not the S&P500, but any portfolio constructed on the assets used in the
test. A test of the CAPM would then consist in testing the normalization and orthogonality conditions (24-25),
which should hold for any such proxy portfolio.

It turns out however that the OLS estimated intercepts ˆ~α, the estimated β’s

ˆ~β and the estimated residuals ˆ~η
of a basket of assets necessarily satisfy the constraints (24-25) when the proxy used as the regressor is a portfolio
build on these same assets. Let us denote by Y the matrix which stacks the returns of the basket of the N assets
under consideration, by X the matrix of the regressors, by B the matrix of the regression coeﬃcients and by U
the matrix which stacks the vectors of the residuals:

~r′
1
...
~r′
T

Y = 

, X = 












1
rm(1)
...
...
1 rm(T )

, B =

(cid:18)






α1
β1

· · · αN
· · · βN

, U = 

(cid:19)




~η′
1
...
~η′
T

,






so that, if ~rm denotes the vector of the returns on any portfolio W made of our N assets only, we have

With these notations, the linear regression equation reads Y = XB + U . The OLS estimators of B and of U
are then respectively

and

It is then easy to show that

ˆU = Y − X ˆB =

Id − X

X tX

−1

X t

Y,

(cid:0)

(cid:1)

i

ˆBW =

,

et

ˆU W = ~0 ,

(cid:0)

h

0
1

(cid:18)

(cid:19)

rm(1)
...
rm(T )






= Y W .

ˆB =

X tX

−1

X tY






(cid:1)

11

(31)

(32)

(33)

(34)

(35)

which are nothing but the constraints (24-25) in matrix form. Their derivation involves the same kind of algebraic
manipulations as those employed in Appendix E in the next section and are thus not repeated here. Therefore,
given any portfolio made of the subset of assets under consideration only, the OLS estimator automatically
provides estimates which fulﬁll the self-consistency constraints. This prevents us from using these constraints
as a way to test the CAPM. However, this derivation shows that, assuming that the CAPM holds, the OLS
method provides a simple way to self-consistently assess the parameters of the model by using proxy portfolios
made only of the assets which are used in the CAPM regressions.

4 Multi-factor models

4.1 Orthogonality and normality conditions

Extending section 3.1, we now investigate the implications of using portfolio proxies for the explanatory factors
in the multi-factor model analyzed in section 2.3.

Let us ﬁrst assume that the individual asset returns can be explained by exactly q factors. Then, q factor
proxies are built by deﬁning q portfolios of the traded assets. Let us denote by ˜W the matrix whose columns
represent the q portfolios and by ~vt the vector of the q proxies. Appendix D shows that, similarly to the result
(23) obtained for the one-factor model, a non-zero intercept ~α appears in the regression of the vector of asset
returns with respect to the q proxies in the vector ~vt (see expression (98)).
In addition, the normalization
condition

and the two orthogonality conditions

˜W ′ ˜B = Id

˜W ′~α = ~0,

and

˜W ′~νt = ~0,

hold, where νt is the vector of the residuals of the multivariate regression on the vector of the q proxies vt.

A priori, we do not know how many factors are needed but there are standard tests in factor analysis that
provide some estimates of the number of factors (Connor and Korajzcyk, 1993; Bai and Ng, 2002). It is possible
to encounter a situation where the number r of portfolio proxies is diﬀerent from the true number q of factors.
The case r < q corresponds to market incompleteness. Let us discuss the situation where r > q. In this case,
equations (36–37) still hold, as shown in Appendix E, but a diﬃculty arises from the fact that the matrix ˜W ′B
is not a q × q matrix anymore, it is a r × q matrix, where r > q is the number of chosen factor proxies. As

−1

˜W ′B

does not exist and has to be replaced by its (left) pseudo-inverse. As previously, a
a consequence,
non-zero intercept ~α also appears in the regression of the vector of asset returns with respect to the q proxies.
The orthogonality and normalization conditions still hold, as shown in Appendix E.

(cid:17)

(cid:16)

4.2 Self-consistent calibration of the multi-factor model and principal component
analysis (PCA)

Let us assume the existence of Q factors which can be replicated by Q portfolios Wi (the market is complete).
Let W be the matrix which stacks all these portfolios: W = (W1, W2, . . . , WQ). We again denote ~rt as the vector
of excess returns of the n assets over the risk free rate4, ~ut = W ′~rt is the set of factors and B is the matrix of
beta’s. This deﬁnes the model (16):

where the intercept is set to zero, which is always possible provided that we subtract the mean value of ~rt.
Appendix F shows how to estimate the beta’s B and the Q replicating portfolios W = (W1, W2, . . . , WQ) by
using the properties

(36)

(37)

(38)
(39)

(40)
(41)

(42)

~rt = B~ut + ~εt ,

= BW ′~rt + εt ,

W ′~1N = ~1Q ,
W ′B = IdQ ,
W ′~εt = 0 .

12

4If for instance the APT is true (i.e., there are no arbitrages available), then one does not need to subtract means for the intercept

in (39) to be zero.

The ﬁrst property (40) just expresses the normalization of the portfolio weights. The two other properties are
the normalization and orthogonality conditions derived from the self-consistency condition that the factors can
be replicated by portfolios constituted of the assets that they are supposed to explain (see (14) for the one-factor
case and (21,22) for the multi-factor case).

Appendix F ﬁrst derives the relation (133)

between the matrix W of weights and the matrix B of beta’s, showing the dependence between W and B
resulting from the self-consistency conditions. Finally, B and W can be constructed as (159,160)

W = B [B′B]

−1 ,

B = P ′U ∇V ′ ,
W = P ′U ∇−1V ′ .

(43)

(44)

(45)

The matrix P is speciﬁed by the decomposition RR′ = P ′DP given in (145), where R = (~r1, ~r2, . . . , ~rT ) is a
N × T matrix and D is the diagonal matrix with elements equal to the eigenvalues of RR′. The matrix U is also
ﬁxed by (158), i.e., it has its ﬁrst Q upper diagonal elements equal to 1 and all its other elements equal to zero.
The matrix V is not uniquely ﬁxed, reﬂecting in this way the rotational degeneracy of the Q factors. Indeed,
matrix V can be any Q × Q orthogonal matrix whose lines add up to a non vanishing constant.

Expression (39) with (44,45) oﬀers a practical decomposition of the market risks, using a multi-factor model
generalizing the CAPM. It is useful to compare it with other available methods. It is customary in the ﬁnancial
literature to distinguish between model-driven and data-driven constructions of risk factors (Loretan, 1997).
The CAPM is a good example of a model-driven method which imposes strict relationship between asset prices.
On the other hand, the Principal Components Analysis (PCA) method is the archetype of data-driven methods,
which enjoys widespread use among statistical practitioners (Dunteman, 1989; Jolliﬀe, 2002). PCA is frequently
employed to reduce the data dimensionality to a tractable value without needing strong hypotheses about the
nature of the data generating process. Now, the reader familiar with PCA will notice that expression (39) with
(44,45) provides a decomposition of risk components which is nothing but the decomposition obtained by using
PCA! In other words, this section together with Appendix F has shown that a multi-factor analysis implemented
with the self-consistency condition is equivalent to the empirical methodology of analyzing baskets of assets using
PCA.

In general, there are no any necessary connection between data-driven and model-driven constructions of
risk factors. But, as soon as one uses a factor model, if the factors can be indeed expressed in terms of the
assets themselves they are supposed to explain (as in the Fama/French 3-factor model) which is nothing but
the self-consistency condition, then it follows automatically and necessarily that there is a connection between
the factor model and the PCA: in fact, the factor analysis and the PCA are one and the same. This shows
again the strong constraint that the self-consistency condition provides. This provides a direct link between
model-driven and data-driven constructions of risk factors: one of the best representative of model-driven risk
factor decomposition methods (the multi-factor model with self-consistency) is one and the same as one of the
best examples of data-driven risk factor decomposition methods (the PCA). This correspondence implies that
PCA will therefore suﬀer from the same limitations as the CAPM and its multi-factor generalization, namely
lack of out-of-sample explanatory power and predictability. The exact correspondence between self-consistent
multi-factor models and PCA justiﬁes claims on the empirical and practitioner literature5 that PCA may be
an implementation of the arbitrage pricing theory (APT) (Ross, 1976; Roll and Ross, 1984; Roll, 1994). Our
result also suggests that using PCA to pre-ﬁlter the data before a factor decomposition is misconceived since
both PCA and factor decomposition are one and the same thing. It might however be useful in nonlinear factor
decomposition, as suggested from previous nonlinear dynamic studies (Broomhead and King, 1986; Vautard et
al., 1992; Chan and Tong, 2001).

PCA is theoretically better in one sense:

it works with the raw covariance matrix of returns and hence
should uncover any factors present in that matrix. The same cannot be said about approaches in terms of
It is quite possible that the later approaches will fail to uncover
a ﬁxed pre-determined number of factors.
important factors. However, PCA has a disadvantage because it is diﬃcult to estimate when allowing for time
variation in the true covariance matrix. This is in that sense that the factor models are more tractable.

5see

for

instance

http://www.perfectdownloads.com/business-finance/investment-tools/pickstock.htm

and

http://www.apt.com/en/aboutus/theaptapproach.html

13

5 Discussion and conclusion

We have structured the presentation of factor models in the light of the self-consistency condition. Starting
from arbitrary factor models, internal consistency requirements have been shown to impose strong constraints
on the coeﬃcients of the factor models. These requirements merely express the fact that the factors employed
to explain the changes in assets prices are themselves combinations of these securities. These conditions read

In addition, when proxies of the market factors are used instead of the factors themselves, a non-vanishing
intercept ~α appears which satisﬁes the third constraint

W ′

t Bt = Id,

and W ′

t ~εt = 0.

W ′~α = 0.

(46)

(47)

These constraints are appealing and it would have been natural to use them to test the adequacy of the factor-
models. However, they are automatically fulﬁlled by the regression (i) on a proxy which is a portfolio whose
composition is constant through time and is restricted to the subset of assets under consideration and (ii) on the
factors derived from the PCA, when one uses this statistical method to select the relevant explaining factors.
Thus, on the one end, these constraints do not allow to test the CAPM (or the multi-factor models), which
remains untestable unless the entire market is considered, as ﬁrst stressed by Roll (1977); nevertheless, on the
other hand, the OLS estimator and the PCA provides a consistent method to assess the value of the diﬀerent
parameters of the problem.

Now, to escape from this self-referential approach which consists in regressing the assets returns on the
returns on a portfolio made of the assets under consideration with constant proportion, one has to use a proxy
with non-constant composition, such as the Standard & Poor’s 500 index. In such a case, the normalization
and orthogonality conditions (46-47) must hold at each time t. Thus, for a number of periods t larger than the
number N of assets constituting the proxy, the number of constraints is larger than the number of parameters
αi’s and βi’s to estimate. This implies that ~β and ~α can not be constant, unless the time varying vectors of
t · ~β = 1 (given by (14)
market weights ~wt “live” in a subspace of RN which is orthogonal to ~α and such that ~w′
for the mono-factor model, by (21,22) for the multifactor model when the market portfolio is known and by
(24,25) when only a market proxy is available).

This condition raises questions on the dynamic consistency of the CAPM. As stressed, and then immedi-
ately swept under the carpet, at the end of section 2.1, the equilibrium imposes a dynamic constraint on the
composition of the market portfolio: on the one hand, it is endogenously determined by the investors’ antici-
pations according to formula (6) while, on the other hand, the market portfolio must be related to the market
capitalization of each asset, which reﬂects the economic performance of the industry. Thus, the relation (10)
must hold. It can be rewritten as

wi

t+1 = wi
t ·

1 + r0 + βirm(t) + ui
t
1 + r0 + rm(t)

.

This relation would be compatible with the normalization condition at times t and t+1 if and only if

N
i=1 βiwi

t+1 = 1 which would imply that

P

rm(t) =

N
tui
i=1 βiwi
t
N
i=1 wi
tβ2
i

.

1 −
P

(48)

N
i=1 βiwi

t =

P

(49)

P

But now, what could justify such a relation between the market return and the residuals. They have been
assumed independent (or at least uncorrelated) up to now. Recall that our basic assumption was that rm(t) is
exogenously ﬁxed by the economic environment.

In this respect, it seems imperative to give up the assumption of a constant ~β. But, as a consequence, it
becomes necessary to specify a dynamics for ~βt. Several works have started addressing this question (Blume,
1971; 1975; Ohlson and Rosenberg, 1982; Lee and Chen, 1982; Bos and Newbold, 1984; Simmonds et al.,1986;
Collins et al., 1987) and have proved the merit of this approach. With regard to this question, both eq. (9)
and ﬁgures 1 and 2 suggest the existence of a well deﬁned average β. Besides, considering that the volatility of
the assets returns is mean-reverting, which is a well-known stylized fact (Satchell and Knight, 2002; Figlewski,
2004), eq. (9) shows that such an assumption should also hold for the dynamic of βt

6

6To get this result, let us start from expression (9) for the vector ~β. Let us assume that the matrix Ω has a dynamics of its own

14

Finally, the normalization condition shows that ~βt can be written as the sum of two terms

~βt =

~wt
|| ~wt||2 + ~β†
t ,

(50)

t · ~β†

where ~w′
t = 0. The ﬁrst term, ~wt/|| ~wt||2, is directly related to the Herﬁndahl index, i.e. the concentration, of
the market portfolio. So, everything else taken equal, the risk premium increases when the level of diversiﬁcation
of the market decreases. As a ﬁrst approximation, ~β†
t could be taken constant, so that the dynamics of ~βt could
be easily related to the dynamics of the market portfolio, which is a predictable quantity ( ~wt is known at time
t − 1, by use of (48)).

As mentioned brieﬂy in the introduction, there is another interesting consequence of the self-consistency
condition when an addition ingredient holds, namely when the distribution of the capitalization of ﬁrms is
suﬃciently heavy-tailed. In such case which seems to be relevant to real economies, assuming that a general
complete equilibrium with no-arbitrage holds, then one ﬁnds that arbitrage-pricing is actually fundamentally
inconsistent with equilibrium even for arbitrary large real economies: there exists a signiﬁcant non-diversiﬁable
risk which is however not priced by the market (Malevergne and Sornette, 2006b). This result is based on the self-
consistency condition discussed at length in this paper, which leads mechanically to correlations between return
residuals which are equivalent to the existence of a new “self-consistency” factor. Then, when the distribution
of the capitalization of ﬁrms is suﬃciently heavy-tailed, it is possible to show, using methods associated with
the generalized central limit theorem, that the “self-consistency” factor does not disappear even for inﬁnite
economies and may produce signiﬁcant non-diversiﬁed non-priced risks for arbitrary well-diversiﬁed portfolios.
For economies in which the return residuals are function of the capitalization of ﬁrms, the new self-consistency
factor provides a rationalization of the SMB (Small Minus Big) factor introduced by Fama and French.

which is mean-reverting, Ω(t) = Ω0 + f (t)O, where we assume that the time dependence is in the scalar factor f (t), while O is a
constant matrix. Let us assume that f (t) is small, so that f (t)O constitutes a perturbation to Ω0. Expression (9) can be expanded
to ﬁrst order in powers of f (t) to obtain β(t) = C(1 + f (t) ¯O) + β0, where C and ¯O are constant matrices which can be expressed in
terms of O, Ω0, ~α and ~β0. This shows that, if f (t) is mean-reverting, then β(t) is also mean-reverting.

15

Appendix A: derivation of the CAPM relations (8) and (9)

Let us consider the single factor model (4) together with the self-consistency condition (7) that the market is
constructed over the observable universe of securities. Then, left-multiplying (4) by the market portfolio ~w′
t
yields

rm(t) =

~w′
t · (~α + ~εt)
t · ~β0
1 − ~w′

,

and E [rm(t)] =

~w′
1 − ~w′

t · ~α
t · ~β0

.

By substitution in (4), we obtain

~β0 · ~w′
t

~rt =

Id +

 

1 − ~w′

t · ~β0 !

(~α + ~εt) ,

and E [~rt] =

Id +

~β0 · ~w′
t

~α.

 

1 − ~w′

t · ~β0 !

Assuming that the investors aim at achieving the dynamic mean-variance program (P), Li and Ng (2000)
have shown that they all invest a part of their wealth in the risk-free asset and the remaining in a portfolio made
of risky assets only, whose composition is given by

where Σt is the conditional covariance matrix of the returns ~r(t). Now, if an equilibrium is reached at every
time t, ~wt represents the market portfolio at this time.

From (52), one easily obtains that, conditional on the observations up to time t − 1,

By use of Shermann-Morrison inversion formula (see Golub and Van Loan 1996, for instance), we have

~wt =

Σ−1
~1′Σ−1

t E [~rt]
t E [~rt]

=

Σ−1
t

Id +

(cid:16)
~1′Σ−1
t

Id +

′
t

~β0· ~w
1− ~w′

t·~β0
~β0· ~w′
t

1− ~w′

(cid:17)
t·~β0

~α

,

~α

(cid:16)

(cid:17)

~β0 · ~w′
t

′

~wt · ~β0

Σt =

Id +

Ωt

Id +

 

1 − ~w′

t · ~β0 !

 

1 − ~w′

t · ~β0 !

.

−1

~β0 · ~w′
t

Id +

 

1 − ~w′

t · ~β0 !

= Id − ~β0 · ~w′
t,

Σ−1

t =

Id − ~wt · ~β0

′

Ω−1
t

Id − ~β0 · ~w′
t

.

Substituting this expression in equation (53) yields

(cid:16)

(cid:17)

(cid:16)

(cid:17)

where A is a scalar equal to

~wt = A−1 ·

Id − ~wt · ~β0

′

Ω−1
t

Id − ~β0 · ~w′
t

Id +

~β0 · ~w′
t

1 − ~w′

t · ~β0 !

~α

 

(cid:17)

= A−1 ·

Id − ~wt · ~β0

(cid:17)

′

(cid:16)
t ~α ,

Ω−1

(cid:17)

A = ~1′

Id − ~wt · ~β0

′

Ω−1
t

Id − ~β0 · ~w′
t

Id +

~β0 · ~w′
t

1 − ~w′

t · ~β0 !

~α

 

(cid:17)

= ~1′

Id − ~wt · ~β0

(cid:17)

′

(cid:16)
t ~α .

Ω−1

(cid:17)

(cid:16)

(cid:16)

(cid:16)

(cid:16)

The two equalities (58) and (60) result from (55).

Expanding the right hand side of (58), we obtain

so that

so that

~wt = A−1Ω−1

t ~α − A−1

~β0
(cid:16)

′

Ω−1

t ~α

~wt

(cid:17)

~wt =

1
′
A + ~β0

Ω−1

t ~α

Ω−1

t ~α ,

16

(51)

(52)

(53)

(54)

(55)

(56)

(57)

(58)

(59)

(60)

(61)

(62)

and with (60), we eventually get

~wt =

1
~1′Ω−1
t ~α

Ω−1

t ~α.

By substitution in (51) and (52), we obtain

E [rm(t)] =

and E [~rt] = ~α +

~α′Ω−1
t ~α
′

~1 − ~β0
(cid:16)

(cid:17)

Ω−1

t ~α

~α′Ω−1
t ~α
′

~1 − ~β0
(cid:16)

(cid:17)

Ω−1

t ~α

~β0.

Remark that E [~rt] is a deterministic function of time since Ωt is deterministic. In addition, substituting ~wt
in (54) by its expression (63), we show that Σt depends on t through Ωt only, and is therefore a deterministic
function of t. Therefore, both Σt and E [~rt] are deterministic, which justiﬁes the use of the results of Li and Ng
(2000) concerning the optimal allocation strategy in a dynamic mean-variance formulation.

Let us now deﬁne the vector of beta coeﬃcients

where the last equality results from the equations (51-52). Then, using (65), the expressions (64) yield

~β =

Cov (~rt, rm(t))
Var rm(t)

=

′

Ω−1

t ~α

~1 − ~β0
(cid:16)

~α′Ω−1
(cid:17)
t ~α

~α + ~β0 ,

E [~rt] = ~βE [rm(t)] ,

which is nothing but the fundamental CAPM prediction that the excess return of each individual stock is
proportional to the excess return on the market portfolio. This shows that the relation of the CAPM can be
derived from the regression model (4) together with the self-consistency condition (7) under the assumption of
the existence of an equilibrium.

(63)

(64)

(65)

(66)

17

Appendix B: observable beta’s and ortho-normality conditions in one-
factor models

We start with the decomposition (12) of the vector of disturbances ~εt as the sum of a term proportional to rm(t)
plus a contribution uncorrelated with rm(t). We thus introduce two non-random vectors ~δ, ~γ and the random
vector ~ut, uncorrelated with rm(t) and with zero mean deﬁned in (12). The covariance matrix ˜Ωt of ~ut will be
shown to be not full-rank in the following.

In order to express ~δ, ~γ and ˜Ωt, let us remark that

0 = ~δ + ~γ · E [rm(t)] ,

Ωt = Var rm(t) · ~γ~γ′ + ˜Ωt,

~γ =

1
Var rm(t)

Cov (~εt, rm(t)) .

Var rm(t) =

2 ,

and Cov (~εt, rm(t)) =

~α′Ω−1~α
′

~1 − ~β0

Ω−1~α
(cid:21)

(cid:17)

(cid:20)(cid:16)

′

~α
~1 − ~β0
(cid:16)

(cid:17)

,

Ω−1~α

′

Ω−1

t ~α

~1 − ~β0
(cid:16)

~α′Ω−1
(cid:17)
t ~α

~α

~γ =

˜Ωt = Ωt −

1
~α′Ω−1~α

~α~α′.

˜Ωt

Ω−1

t ~α

= 0

(cid:0)

(cid:1)

~δ = −~α.

It is straightforward to check that

so that as asserted above, ˜Ωt is not full rank.
Beside, by (64), (67) and (71), we get

Now, substituting these relations into (12) yields

and replacing ~εt into (4), we get

~εt = −~α +

~α · rm(t) + ~ut,

′

Ω−1

t ~α

~1 − ~β0
(cid:16)

~α′Ω−1
(cid:17)
t ~α

~rt = 

′

Ω−1

t ~α

~1 − ~β0
(cid:16)

~α′Ω−1
(cid:17)
t ~α




= ~β · rm(t) + ~ut.






~α + ~β0

· rm(t) + ~ut,

The α terms have disappeared as a direct consequence of endogeneity, that is, the market portfolio is expressed
through (7) in terms of the basket of assets it is supposed to explain.

In the present form, the model is self-consistent. Indeed, left multiplying the last equation of (77) by ~w′
t

and

Since

we obtain

and

yields

so that

(67)

(68)

(69)

(70)

(71)

(72)

(73)

(74)

(75)

(76)

(77)

(78)

(79)

rm(t) = ~w′
t

~β

·rm(t) + ~w′

t~ut,

=1

|{z}
~w′

t~ut = 0,

18

which is consistent with the fact that ˜Ωt is not full rank. Indeed, taking the variance of both side of the equation
(79) leads to

~w′
t

˜Ωt ~wt
=0 by (63) and (73)

= 0

(80)

| {z }
These calculations show that, thanks to (77) and under the assumption that rm(t) is observable, the OLS
estimator of (4) provides an estimate of ~β (and not ~β0 and ~α which are unobservable). This comes with two
conditions of consistency, ~w′
t

~β = 1 and w′

t~ut = 0.

19

Appendix C: Breakdown of the main CAPM prediction when the
proxy is not the true market portfolio in the one-factor model

Let us investigate the impact of replacing the market factor by a proxy and derive expression (23). Let us denote
by ˜w the portfolio of the market proxy. Left multiplying (13) by ˜w′ we get

which allows us to express rm as a function of ˜r (provided that ˜w′ ~β 6= 0) and, by (77), we have

def
= ˜w′~rt = ˜w′ ~β · rm(t) + ˜w′~ut,

˜rt

~rt =

~β · ˜rt +

Id −

1
˜w′ ~β

 

~β ˜w′
˜w′ ~β !

~ut

.

~vt

~vt = ~γ (˜rt − E [˜rt]) + ~η,

~γ =

˜Ω ˜w −

˜w′ ˜Ω ˜w
(cid:16)
+

˜w′ ~β

2
(cid:17)

˜w′ ˜Ω ˜w

~β
˜w′ ~β

Var rm

,

|
Again, the residual vector ~vt is correlated with ˜rt, which implies that such a model cannot be directly estimated
by the OLS estimator.

{z

}

Performing a decomposition similar to (12), we deﬁne another residual vector ~ηt such that

with Cov (~η, ˜rt) = 0 and E [~η] = 0, by construction.

Following the same lines of reasoning as in Appendix B, we can express ~γ and the covariance matrix of ~η.

We ﬁnd

where ˜Ω is the covariance matrix of ~ut. Thus, by (82) and (83), we obtain

(cid:16)

(cid:17)

(cid:16)

(cid:17)

~rt =

~β · E[˜rt] +

1
˜w′ ~β

Var rm ~β

Var rm

˜Ω ˜w +

˜w′ ˜Ω ˜w

˜w′ ~β
(cid:16)
+

(cid:17)

2

(cid:17)
˜w′ ~β
(cid:16)

(cid:17)

~˜β
{z

(cid:16)

|

}

or, equivalently

(˜rt − E [˜rt]) + ~η ,

(85)

~rt =

1
˜w′ ~β

(cid:18)

~β −

~˜β
(cid:19)

−~γ

·E[˜rt] +

~˜β · ˜rt + ~η,

=

{z

E [rm] ~β − E [˜rt] ~˜β
(cid:17)

}

|

(cid:16)

+ ~˜β · ˜rt + ~η ,

which is the announced result (23). Thus, using a proxy diﬀerent from the true market portfolio yields a
non-vanishing intercept in the regression of asset returns as a function of the proxy returns.

Left multiplying

~˜β in (85) by ˜w′ yields ˜w′~˜β = 1, which is the usual normalization condition. Then, left

multiplying the intercept in (86) by ˜w′, we obtain

which provides a new orthogonality condition. Obviously, left multiplying (86) by ˜w′ and accounting for the two
previous constraints leads to ˜w′ηt = 0.

To sum up, when dealing with a proxy of the market portfolio, the self-consistency conditions lead us to
cast the CAPM into a statistical regression model with a non-vanishing intercept and the regression has to obey
three constraints on the parameter and the residuals of the regression, namely a normalization condition

˜w′ ·

1
˜w′ ~β

(cid:18)

~β −

= 0,

~˜β
(cid:19)

˜w′~˜β = 1 ,

20

(81)

(82)

(83)

(84)

(86)

(87)

(88)

(89)

and two orthogonality conditions

˜w′ηt = 0 and

˜w′ ·

1
˜w′ ~β

~β − ~˜β
(cid:19)

(cid:18)

= 0 .

(90)

21

Appendix D: Breakdown of the main CAPM prediction and normality
condition when the proxy is not the true market portfolio in the multi-
factor model

We derive the result announced in section 4, in the case where the individual asset returns can be explained
by exactly q factors. Then, q factor proxies can be built by deﬁning q non-degenerate portfolios of the traded
assets. Let us denote by ˜W the matrix whose columns represent the q portfolios and by ~vt the vector of the q
proxies. By equation (16), we have

and, assuming that the matrix ˜W ′B is full rank, we obtain

˜W ′~rt = ~vt = ˜W ′B~ut + ˜W ′~εt,

~ut =

˜W ′B

~vt −

˜W ′B

˜W ′~εt,

−1

−1

(cid:16)

(cid:17)

(cid:16)

(cid:17)

so that (16) can be rewritten as

~rt = B

˜W ′B

~vt +

Id − B

˜W ′B

˜W ′

~εt

,

−1

−1

(cid:16)

(cid:17)

(cid:16)

(cid:17)

(cid:21)

(cid:20)

|

~ηt

{z

where the disturbance ~ηt is correlated with ~vt, since both ~vt and ~ηt depend on ~εt.

}

As in Appendix B, we can deﬁne a new residual vector ~νt such that

with E [~νt] = 0 and Cov (~vt, ~νt) = 0. As usual, we obtain

~η = Γ · (~vt − E [~vt]) + ~νt

Γ = Cov (~ηt, ~vt) · Cov (~vt, ~vt)−1 ,

with

and

Cov (~ηt, ~vt) =

Id − B

−1

˜W ′B

˜W ′

Ωt ˜W ,

(cid:20)

(cid:16)

(cid:17)

(cid:21)

Cov (~vt, ~vt) = ˜W ′Ωt ˜W +

˜W ′B

Cov (~ut, ~ut)

B′ ˜W

,

where Ωt = Cov (~εt, ~εt). Finally, one gets

(cid:16)

(cid:17)

(cid:16)

(cid:17)

~rt = B

˜W ′B

· E [~vt]

+

Γ + B

−1

· (~vt − E [~vt]) + ~νt,

˜W ′B
(cid:16)

(cid:17)

−1

(cid:21)

(cid:16)

(cid:17)
=BE[~ut]=E[~rt], by (91)

(cid:20)

|

= −Γ · E [~vt]

{z
+

}
Γ + B

˜W ′B

~vt + ~νt.

~α

{z

|

}

(cid:20)

|

(cid:16)
˜B

{z

−1

(cid:17)

(cid:21)

}

When using a set of q factor proxies instead of the true set of risk factors, we ﬁnd that a non-zero intercept ~α
appears as for the one-factor case, and the normalization and orthogonality relations

˜W ′ ˜B = Id,

˜W ′α = ~0,

and,

˜W ′~νt = ~0,

(100)

still hold since equation (96) implies ˜W ′Cov (~ηt, ~vt) = 0, which yields ˜W ′Γ = 0, by (95).

(91)

(92)

(93)

(94)

(95)

(96)

(97)

(98)

(99)

22

Appendix E: Analysis of the case where the number r of factor proxies
is larger than the number q of true factors

In this case, equation (91) still holds, but the matrix ˜W ′B is not a q × q matrix anymore, it is a r × q matrix,

where r > q is the number of chosen factors. As a consequence,

does not exist and has to be replaced

by its (left) pseudo-inverse

−1

˜W ′B
(cid:16)

(cid:17)

−1

−→

˜W ′B

† def
=

(cid:17)

(cid:16)

(cid:17)

B′ ˜W ˜W ′B
(cid:16)

(cid:17)

−1

B′ ˜W ,

˜W ′B
(cid:16)
˜W ′B
(cid:16)

(cid:17)

˜W ′B

†

·

(cid:16)

(cid:17)

which is such that

= Idq. Since the calculation performed in Appendix D up to equation (99)

involves only the (left) inversion of the matrix ˜W ′B, it remains valid if we replace
that ˜B becomes

˜W ′B
(cid:16)

(cid:17)

−1

by

˜W ′B

†

, so

(cid:16)

(cid:17)

˜B = Γ + B

= Γ + B

†

,

˜W ′B
(cid:16)
(cid:17)
B′ ˜W ˜W ′B
(cid:16)

−1

B′ ˜W ,

(cid:17)

†

while the new expression of the intercept is

˜W ′B
(cid:16)
Note that the existence of the inverse of Cov (~vt, ~vt) is ensured as it does not require the invertibility of ˜W ′B,
and thus Γ is well deﬁned.

Id − Γ ˜W ′ − B

· E [~rt] .

(104)

~α =

˜W ′

(cid:17)

(cid:20)

(cid:21)

The orthogonality and normalization conditions (36,100) still hold, but are slightly more diﬃcult to derive.

Indeed, from (102), we have

with ˜W ′B

˜W ′B

6= Id and ˜W ′Γ 6= 0. Remarking that

†

(cid:16)

(cid:17)

˜W ′ ˜B = ˜W ′Γ + ˜W ′B

˜W ′B

†

,

(cid:16)

(cid:17)

˜W ′ · Cov (~ηt, ~vt) = 

Id − ˜W ′B

˜W ′Ωt ˜W ,

˜W ′B
(cid:16)
6=Id

(cid:17)

†

}











and applying the matrix inversion formula (Golub and Van Loan, 1996), we get

|

{z

Cov (~vt, ~vt)−1 =

˜W ′Ωt ˜W

−1

Id −

Cov (~ut, ~ut)−1

+

˜W ′B

(cid:16)

(cid:16)

′

(cid:17)
n
˜W ′Ωt ˜W
(cid:16)

(cid:17)

(cid:17)

(cid:16)

(cid:17)(cid:21) (cid:16)

(cid:17)

(cid:16)

′

˜W ′B

˜W ′Ωt ˜W

−1

,

(cid:27)

(cid:17)

˜W ′B
(cid:16)
−1

(cid:17) (cid:2)
˜W ′B

so that

˜W ′Γ =

Id − ˜W ′B

˜W ′B

(cid:20)

+

˜W ′B

′

(cid:16)
(cid:17)
˜W ′Ωt ˜W

†

·

Id −

(cid:21)
−1

n
˜W ′B

˜W ′B
(cid:16)

(cid:17) (cid:2)
˜W ′B

′

Cov (~ut, ~ut)−1

˜W ′Ωt ˜W

−1

,

(cid:27)

(cid:17)

(cid:17)(cid:21) (cid:16)

(cid:17)

(cid:16)

(cid:16)

(cid:16)
= Id − ˜W ′B

(cid:17)

˜W ′B

(cid:16)

(cid:17)
†
,

and thus, by (105), we recover (100).

(cid:16)

(cid:17)

23

(101)

(102)

(103)

(105)

(106)

(107)

(108)

(109)

Appendix F: Derivation of the procedure to calibrate the self-consistent
multi-factor model

We start with the multi-factor model (16)

and the properties (40,41,42). Our goal is to obtain the procedure summarized in section 4.2 to estimate the
beta’s B and the Q replicating portfolio weights W = (W1, W2, . . . , WQ) by a suitable calibration of the model
to the data consisting of the returns of the N assets of the market over a given period of time of length T .

Given the above properties (40,41,42), the estimation of the multi-factor model amounts to ﬁnding the N × Q

matrices B and W which minimize

~rt = B~ut + ~εt

= BW ′~rt + εt ,

′
t (Id − BW ′)
~r′

(Id − BW ′) ~rt

T

t=1
X

under the constraints (40,41). The last condition (42) (W ′~εt = 0) is automatically fulﬁlled by the least square
regression.

Introducing the Q × 1 vector 2~µ and the Q × Q matrix 2Λ of Lagrange multipliers, the Lagrangian of the

system reads

L(W, B) = ritrit − 2 · ritBikWlkrlt + ritWikBjkBjmWlmrlt − 2µj

Wij − 1

− 2λij (BkiWkj − δij) , (113)

where we sum over repeated subscripts.

Diﬀerentiating L(W, B) with respect to Brs and Wrs respectively yields

 

i
X

!

∂Brs L = ritWisBrmWlmrlt − rrtWlsrlt − λsj Wrj,
∂Wrs L = rrtBjsBjmWlmrlt − ritBisrrt − µs − λisBri .

The minimization of (112) thus leads to the ﬁrst order condition

Summing up, we have to ﬁnd two N × Q matrices B and W , a Q × Q matrix Λ and a Q × 1 vector ~µ solution

of

BW ′~rt~r′
tW B′B − ~rt~r′

tW − ~rt~r′

tW − W Λ′ = 0,
tB − ~1N ~µ′ − BΛ = 0.

~rt~r′

tW − W Λ′ = 0,
tB − ~1N ~µ′ − BΛ = 0,

tW − ~rt~r′
tW B′B − ~rt~r′

BW ′~rt~r′
~rt~r′
W ′~1N = ~1Q,
W ′B = IdQ.

We can simplify this program using the following manipulations.

W ′ · (119)

Λ = W ′~rt~r′

tW B′B − W ′~rt~r′

tB′ − W ′~1N

~µ′

B′ · (118)

Λ′ = B′BW ′~r′
Λ = W ′~rt~r′

t~rtW − B′~rt~r′
tW B′B − W ′~rt~r′

tW
tB′,

=~1Q (120)

| {z }

(121)
=⇒

(121)
=⇒

=⇒

Therefore, by (122) and (124), we must have

which leads to

~1Q · ~µ′ = 0

~µ = 0 .

24

(110)

(111)

(112)

(114)

(115)

(116)
(117)

(118)
(119)

(120)
(121)

(122)

(123)

(124)

(125)

(126)

and equation (119) simpliﬁes into

~rt~r′

tW B′B − ~rt~r′

tB − BΛ = 0.

Then,

so that

W ′ · (118)

=⇒

W ′~r′

t~rtW − W ′~rt~r′

tW = W ′W Λ′

W ′B
Id (121)

=⇒ W ′W Λ′ = 0,

| {z }

Λ = 0 ,

since the matrix [W ′W ] is full rank (equal to Q) and therefore invertible.

The equations (118,119) reduce to

Since [~rt~r′

t] is invertible, provided that T > N , equation (132) leads to W B′B − B = 0, and ﬁnally

since the matrix [B′B] is full rank (equal to Q) and therefore invertible.

Note that (121) is automatically satisﬁed, so that the search for B and W in the system (118-121) reduces

to ﬁnding a matrix B such that

or equivalently by using (133)

BW ′~rt~r′
~rt~r′

tW − ~rt~r′
tW B′B − ~rt~r′

tW = 0,
tB = 0,

W = B [B′B]

−1 ,

tW − ~rt~r′

tW = 0,

BW ′~rt~r′
W = B [B′B]
W ′~1N = ~1Q,

−1

tB = ~rt~r′

tB,

B[B′B]−1B′~rt~r′
W = B [B′B]
~1N − B~1Q
B′
h

i

−1 ,

= 0 .

Finding the solution of this system above is not straightforward. An alternative approach is to go back to
the quadratic form (112) to minimize, and use (133) to replace W by B [B′B]−1. In addition, from (126) and
(130), we know now that both ~µ and Λ are zero. Then, the optimal matrix B we are looking for is solution of

under the constraint

This minimization has the same solution as

~r′
t

Id − B [B′B]

−1 B′

~rt

min
B

t
X

(cid:16)

(cid:17)

B′

~1N − B~1Q
h

i

= 0 .

max
B

tB [B′B]
~r′

−1 B′~rt = max
B

Tr

R′B [B′B]

−1 B′R

,

t
X

= max

Tr

B′RR′B [B′B]

B

(cid:16)

(cid:16)

(cid:17)

−1

(cid:17)

under the same constraint (141), where R the N × T matrix R = (~r1, ~r2, . . . , ~rT ). T is the duration of the time
interval over which the data is available.

Using the transformation

RR′ = P ′DP ,

25

(127)

(128)

(129)

(130)

(131)
(132)

(133)

(134)

(135)

(136)

(137)

(138)

(139)

(140)

(141)

(142)

(143)

(144)

(145)

where D is a diagonal matrix and P is the matrix of the (orthogonal) eigenvectors of RR′, we thus have to solve

under the constraint

where ˜B = P B is a full rank N × Q matrix.

Any N × Q (N ≥ Q) matrix ˜B admits a singular value decomposition

where U is an N × Q matrix, ∇ and V are Q × Q matrices with ∇ diagonal and

Tr

max
˜B

˜B′D ˜B

˜B′ ˜B

(cid:18)

h

i
˜B′P~1N = ˜B′ ˜B~1Q,

−1

(cid:19)

˜B = U ∇V ′,

U ′U = IdQ,
V ′V = V V ′ = IdN .

With the singular value decomposition (148), the constraint (147) becomes

U ′P~1N = ∇V ′~1Q.
(151)
Thus, deﬁning ∇ as the diagonal matrix whose ith diagonal element ∇i is given by the ratio of the ith component
of the vector U ′P~1N over the ith component of the vector V ′~1Q

• V is any Q × Q orthogonal matrix whose lines add up to a non vanishing constant (to ensure the existence

∇i =

U ′P~1N
h

V ′~1Q
h

i

i
i
i

,

˜B = U ∇V ′ ,

any matrix ˜B solution of the constraint (147) can be written as

where

of ∇i in (152), for all i = 1, . . . , Q),

• ∇ is the Q × Q diagonal matrix deﬁned by (152),
• and U is any N × Q matrix such that U ′U = IdQ.
By circular permutation

and since a straightforward calculation shows that

Tr

˜B′D ˜B

(cid:18)

−1

˜B′ ˜B
h

i

= Tr

D ˜B

(cid:19)

(cid:18)

˜B′ ˜B
h

i

−1

˜B′

,

(cid:19)

our maximization program becomes

−1

˜B′ = U U ′ ,

˜B

˜B′ ˜B
h

i

max
U

Tr (DU U ′) = max

Tr (U ′DU ) ,

U

under the constraint

(157)
Recalling that D is the diagonal matrix which elements equal to the eigenvalues of the matrix RR′ and
assuming that these eigenvalues are sorted in decreasing order (D11 ≥ D22 ≥ · · · ≥ DN N ), the simplest solution
of the maximization program is

U ′U = IdQ.

To sum up, the set of optimal solutions of the original problem (112) is given by

While P is unique by the decomposition (145) and U is also ﬁxed to (158), the matrix V can be any Q ×
Q orthogonal matrix whose lines add up to a non vanishing constant. This expresses simply the rotational
degeneracy of the Q factors.

U =

IdQ
0

.

(cid:19)

(cid:18)

B = P ′U ∇V ′,
W = P ′U ∇−1V ′ .

26

(146)

(147)

(148)

(149)

(150)

(152)

(153)

(154)

(155)

(156)

(158)

(159)

(160)

References
Alexander, G.J. and A.M. Baptista (2002) Economic implications of using a mean-VaR model for portfolio
selection: A comparison with mean-variance analysis, Journal of Economic Dynamics & Control 26, 1159–1193.

Axtell, R.L. (2001) Zipf distribution of U.S. ﬁrm sizes, Science 293, 1818-1820.
Bai, J. and S. Ng, S. (2002) Determining the Number of Factors in Approximate Factor Models, Econometrica

70 (1), 191-221.

Black, F. (1972) Capital market equilibrium with restricted borrowing, Journal of Business 45 (July), 444-455.
Blume, M. E. (1971) On the Assessment of Risk, Journal of Finance, 26, 1-10.
Blume, M. E. (1975) Betas and their Regression Tendencies, Journal of Finance, 30, 785-795.
Bodie, Z., A. Kane, A.J. Marcus (2004) Investments, 6th ed., McGraw-Hill/Irwin.
Bos, T. and Newbold, P. (1984) An Empirical Investigation of the Possibility of Stochastic Systematic Risk

in the Market Model, Journal of Business, 57, 35-41.

Broomhead, D.S., King G. (1986) Extracting qualitative dynamics from experimental data, Physica D 20,

217-236.

Chan, K.S., Tong H. (2001) Chaos: A statistic perspective, Spring-Verlag, New York.
Collins, D. W. Ledolter, J. and Rayburn, J. (1987) Some Further Evidence on the Stochastic Properties of

Systematic Risk, Journal of Business, 60, 425-448.

Connor, G. and R. Korajzcyk (1993) A test for the number of factors in an approximate factor model, Journal

of Finance 48 (4), 1263-1291.

47, 427–465.

Financial Economics 33, 3–56.

Finance 50, 131–155.

18 (August), 25-46.

Dunteman, G.H. (1989) Principal components analysis, Sage Publication, California.
Fama, E.F. and K.R. French (1992) The Cross-Section of Expected Stock Returns, Journal of Finance

Fama, E.F. and K.R. French (1993) Common Risk Factors in the Returns on Stocks and Bonds, Journal of

Fama, E.F. and K.R. French (1995) Size and Book-to-Market Factors in Earnings and Returns, Journal of

Fama, E.F. and K.R. French (2004) The CAPM: Theory and Evidence, Journal of Economic Perspectives

Fang, H.B. and T. Lai (1997) Co-kurtosis and capital asset pricing, Financial Review 32, 293–307.
Figlewski, S. (2004) Forecasting volatility, Blackwell.
Golub, G.H. and C.F. Van Loan (1996) Matrix Computations, 3rd edition (John Hopkins: Baltimore, MD),

p51.

1263–1295.

Greene, W. (2003) Econometric Analysis, 5th Edition, Prentice Hall.
Hakansson, N.H. (1971) On optimal myopic portfolio policies, with and without serial correlation of yields,

Journal of Business 44, 324–334.

Harvey, C.R. and A. Siddique (2000) Conditional skewness in asset pricing tests, Journal of Finance 55,

Hwang, S. and S. Satchell (1999) Modelling emerging market risk premia using higher moments, International

Journal of Finance & Economics 4, 271–296.

Washington DC, Appendix VII, Glossary.

IMF, International Monetary Fund (2004) Compilation Guide on Financial Soundness Indicators, IMF,

Jolliﬀe, I.T. (2002) Principal Component Analysis, 2nd ed., Springer Series in Statistics, New York.
Krauss, A. and R. Litzenberger (1976) Skewness preference and the valuation of risk assets Journal of Finance

31, 1085–1099.

Lee, C.F. and Chen, CR. (1982) Beta Stability and Tendency: An Application of the Variable Mean Response

Regression Model, Journal of Economics and Business, 34, 201-206.

Li, D. and W.L. Ng (2000) Optimal dynamic portfolio selection: multiperiod mean-variance formulation,

Mathematical Finance 10, 387–406.

Butterworth-Heinemann.

Quantitative Analysis 24, 205–216.

Lifshitz, E.M., L.P. Pitaevskii and V.B. Berestetskii (1982) Quantum Electrodynamics, 2nd ed., Vol. 4,

Lim, K.G. (1989) A new test for the three-moment capital asset pricing model, Journal of Financial &

Loretan, M. (1997) Generating market risk scenarios using principal components analysis: Methodological
and practical considerations, In The Measurement of Aggregate Market Risk, CGFS Publications No. 7, pages
23-60. Bank for International Settlements, November 1997 (Available at http://www.bis.org/publ/ecsc07.htm).

27

Malevergne, Y. and D. Sornette (2006a) Multi-Moments Method for Portfolio Management: Generalized
Capital Asset Pricing Model in Homogeneous and Heterogeneous markets, in B. Maillet and E. Jurczenko
(eds.): Multi-moment Asset Allocation and Pricing Models (Wiley & Sons), pp. 165-193.

Malevergne, Y. and D. Sornette (2006b) New Irreducible Non-Diversiﬁable Risks in Asset Pricing Models,

Michaud, R.A. (2003) A practical framework for portfolio choice, Journal of Investment Management 1 (2),

working paper, ETH Zurich.

1-16.

Ohlson, J. and Rosenberg, B. (1982) Systematic Risk of the CRSP Equal-weighted Common Stock Index: A

History Estimated by Stochastic Parameter Regression, Journal of Business, 55, 121-145.

Petkova, R. (2006) Do the Fama-French factors proxy for innovations in predictive variables? Journal of

Finance, forthcoming (April).

Pliska, S.R. (1997) Introduction to Mathematical Finance. Blackwell: Malden, MA.
Polimenis, V. (2005) On the concavity of jump equity premia, Finance Letters 3 (1), paper 18, February.
Roll, R. (1977) A critique of the asset pricing theory’s tests, Part I: On past and potential testability of the

theory, Journal of Financial Economics 4, 129-176.

Roll, R. (1994) What every CFO should know about scientiﬁc progress in ﬁnancial economics: What is

known and what remains to be resolved. Financial Management 23(2), 69–75.

Roll, R. and S.A. Ross (1984) The arbitrage pricing theory approach to strategic portfolio planning, Financial

Analysts Journal (May/June), 14-26.

Ross, S.A. (1976) The Arbitrage Theory of Capital Asset Pricing, Journal of Economic Theory (December),

Rubinstein, M. (1973) The fundamental theorem of parameter-preference security valuation, Journal of

341-60.

1990.

Financial & Quantitative Analysis 8, 61–69.

Economics and Statistics 50, 239–246.

Finance), Butterworth-Heinemann.

Samuelson, P.A. (1969) Lifetime portfolio selection by dynamic stochastic programming, The Review of

Satchell, S. and J. Knight (2002) Forecasting Volatility in the Financial Markets, 2nd ed. (Quantitative

Sharpe, W.F. (1990) Capital asset prices with and without negative holdings, Nobel Lecture, December 7,

Simmonds, R., La Motte, L. and McWhorter, A. (1986) Testing for Nonstationarity of Market Risk: An

Exact Test and Power Considerations, Journal of Financial and Quantitative Analysis, 21, 209-220.

Vautard, R., Yiou P., Ghil M. (1992) Singular-spectrum analysis: A toolkit for short, noisy chaotic signals,

Physica D 58, 95-126.

28

0.06

0.04

0.02

0

−0.02

−0.04

]

0

r
−

0
0
5
p
s

0

M
O
X

r
 
|
 

r
−

r
 
[

E

XOM

29

−0.06

−0.05

−0.04

−0.03

−0.02

−0.01

0

0.01

0.02

0.03

0.04

0.05

r
sp500

−r
0

Figure 1: Regression of the expected return above the risk-free interest rate for Exxon mobil daily returns with
respect to the excess return of the S&P500 index over the period from July 1962 to December 2000. The risk free
interest rate is obtained from the three month Treasury Bill.

0.08

0.06

0.04

0.02

0

−0.02

−0.04

−0.06

−0.08

i

i

b
/
)
α
−

 

 
]

0

r
−

0
0
5
p
s

0

i

r
 
|
 

r
−
r
 
[

E

(

−0.1

−0.05

−0.04

−0.03

−0.02

−0.01

0

0.01

0.02

0.03

0.04

0.05

r
sp500

−r
0

Figure 2: Each curve is similar to that shown in ﬁgure 1 and represents the normalized expected return above
the risk-free interest rate deﬁned by (30) for a given stock i over the period from July 1962 to December 2000
as a function of the excess return rSP 500 − r0 above the risk-free interest rate r0 of the S&P500 index taken
as a proxy of the market portfolio. Since the αi’s and βi’s are diﬀerent from asset to asset, the normalization
(30) ensures by construction that a good linear regression for each asset should be qualiﬁed by having all curves
collapse on the diagonal, with unit slope and crossing of the origin, as observed up to statistical ﬂuctuations.
The 25 curves corresponds to the following stocks: Abbott Laboratories, American Home Products Corp., Boeing
Co., Bristol-Myers Squibb Co., Chevron Corp., Du Pont (E.I.) de Nemours & Co., Disney (Walt) Co., General
Electric Co., General Motors Corp., Hewlett-Packard Co., International Business Machines Co., Coca-Cola Co.,
Minnesota Mining & MFG Co., Philip Morris Cos Inc., Merck & Co Inc., Pepsico Inc., Pﬁzer Inc., Procter &
Gamble Co., Pharmacia Corp., Schering-Plough Corp., Texaco Inc., Texas Instruments Inc., United Technologies
Corp., Walgreen Co. and Exxon Mobil Co. The risk free interest rate is obtained from the three month Treasury
Bill.

30

i

α

0.15

0.1

0.05

0

−0.05

−0.1

0

50

100

200

250

300

150

i

−0.1

0

5
10
Density

15

Figure 3: Left panel: Population of the intercepts of the regression of the expected monthly excess returns of
323 stocks entering into the composition of the S&P500 between January 1990 and February 2005 versus the
monthly excess returns of the eﬀective S&P323 index that we have constructed as a portfolio of these 323 stocks
with weights proportional to their capitalizations. The risk free interest rate is obtained from the three month
Treasury Bill. The abscissa is an arbitrary indexing of the 323 assets. The estimated probability density function
of the population of alpha’s is shown on the right panel and illustrates the existence of a systematic bias for the
alpha’s.

0.15

0.1

0.05

α

0

−0.05

31

−0.09

−0.1

−0.11

i

]

r
[

E

−0.12

−0.13

−0.14

−0.15

0.5

1

1.5

2

β
i

Figure 4: Expectation E [ri − r0] of the monthly excess returns of the 323 assets used in ﬁgure 3 as a function of
their βi obtained by regressions with respect to the excess return to the eﬀective S&P323 index. The risk free
interest rate is obtained from the three month Treasury Bill. Under the CAPM hypothesis, one should obtain
a straight line with slope E [rSP 323 − r0] (−13.1% per month) and zero additive coeﬃcient at the origin. The
straight line is the regression y = 0.88% − 13.5% · x.

32

0.02

0.015

0.01

 

α
W

0.005

0

−0.005

−0.01

0
0

20
20

40
40

60
60

120
120

140
140

160
160

80
100
100
80
Time (in month)

0.92

180
180

~˜β (red and right vertical scale) and ˜w′

Figure 5: Time evolution of ˜w′
~˜α (blue and left vertical scale) over the period
t
from January 1990 to February 2005 which includes 182 monthly values. ˜wt is the vector of weights of the 323
~˜β
stocks in our eﬀective S&P323 index which evolves at each time step according to the capitation of each stock.
and ~˜α are the two vectors of beta’s and alpha’s obtained from the regressions used in ﬁgures 3 and 4. According
~˜β = 1
to the self-consistency conditions (24) and (25), the dynamical consistency of the CAPM should lead to ˜w′
t
and ˜w′
t

~˜α = 0 at all time periods.

t

1.1

1.08

1.06

1.04

1.02

1

0.98

0.96

0.94

β
 
W

33

Market factor
Proxy

β
 
d
e
t
a
m

i
t
s
e

1.4

1.2

1

0.8

0.6

0.4

0.2

0
0.3

0.4

0.5

0.6

0.7

0.9

1

1.1

1.2

1.3

0.8
β

Figure 6: Synthetic tests on an artiﬁcial market of 1000 synthetic assets with properties adjusted to mimic those
of the real US market. The plot shows the estimated beta’s obtained from the regression of the asset returns on
the returns of the market portfolio (blue dots) and on the returns of the proxy (red crosses), as a function of the
true beta’s. The upper straight line corresponds to the ideal case where the estimated beta’s equal the true beta’s.
The lower straight line is the predicted dependence (85) of the beta’s estimated with the proxy as a function of
the true beta.

34

−3

x 10

1.5

Market factor
Proxy

−3

x 10

1.5

Market factor
Proxy

i

α

α

0.5

1

0

−0.5

−1

0

200

400

600

800

1000

1000

2000

3000

i

Density

Figure 7: Synthetic tests on an artiﬁcial market of 1000 synthetic assets with properties adjusted to mimic those
of the real US market. Left panel: Population of the intercepts of the regression of expected stock returns versus
the market return (blue dots) or versus the proxy return (red crosses) in our synthetic market. The abscissa is an
arbitrary indexing of the 1000 assets of our artiﬁcial market. The estimated probability density functions of the
two population of alpha’s are shown on the right panel and illustrate the existence of a systematic bias for the
proxy’s alpha’s.

0.5

1

0

−0.5

−1

0

35

−4

x 10

20

True β
Market factor
Proxy

i

]

r
[

E

15

10

5

0

−5

0

0.2

0.4

0.6

0.8

1

1.2

1.4

β
i

Figure 8: Synthetic tests on an artiﬁcial market of 1000 synthetic assets with properties adjusted to mimic those
of the real US market. Individual expected returns E [ri] for each of the 1000 assets (i) as a function of the true
βi’s (blue dots), (ii) as a function of the βi’s obtained by regression on the true market (red crosses ×) and by
regression on the proxy (green +). The straight lines are the linear regressions.

36

