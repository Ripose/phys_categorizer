6
0
0
2
 
n
a
J
 
8
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
5
3
1
1
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Biham-Middleton-Levine Traﬃc Model With
Origin-Destination Trips

Najem Moussa ∗
ESNM, D´ept. de Physique, FST,
B.P. 509, Boutalamine, Errachidia, Morocco

February 21, 2014

Abstract

We extended the Biham-Middleton-Levine model to incorporate
the origin and destination eﬀect of drivers trips on the traﬃc in cities.
The destination sites are randomly chosen from some origin-destination
distances probability distribution ”ODDPD”. We use three diﬀerent
distributions: exponential, uniform and power-law. We consider two
variants of the model. In conserved particles model (Model A), drivers
continue their travelling even if they reached their destinations.
In
non-conserved particles model (Model B), a driver which reaches its
destination disappears with rate β. It is found that the traﬃc dynam-
ics in model A and the evacuation processes in model B are greatly
inﬂuenced by the ODDPD. On one hand, we found that we can adjust
the ODDPD to enhance the road capacity of the city and to minimize
the arrival times of drivers in particles conserved system and to op-
timize the evacuation time of drivers in non-conserved case. On the
other hand, we ﬁnd that, independently on the ODDPD, the evacua-
tion time T of drivers diverges in the form of a power law T ∝ β−ν ,
with ν = 1.
Pacs numbers: 45.70.Vn, 02.50.Ey, 05.40.-a
Keywords: Traﬃc; Cellular Automata; Freely Moving; Jamming; Ar-
rival Times, Evacuation Times

∗e-mail: najemmoussa@yahoo.fr

1

1 Introduction

Ever since O. Biham, A.A. Middleton and D. Levine elaborated their traﬃc
model (BML) [1], the two-dimensional cellular automata (CA) traﬃc models
are used enormously in order to understand the complex dynamic behavior of
the traﬃc in cities (see the reviews [2-4]). In CA, time and space are discrete.
The space is represented as a uniform lattice of cells with ﬁnite number of
states, subject to a uniform set of rules, which drives the behavior of the
system. These rules compute the state of a particular cell as a function of
its previous state and the state of the neighboring cells.
The BML model is a three-state CA with periodic boundary conditions where
at a given time step each site can be occupied by a car moving upward, a car
moving rightward, or the site is empty. There are equal number of cars in
each direction and the dynamics is governed by synchronous traﬃc lights that
allow alternatively vertical or horizontal movements. At their turn each car
jumps to its next place whenever it is empty. Thus, an essential ingredient
of the BML model is the excluded volume at crossings which determines the
sharp transition between two phases. A ﬁrst order phase transition from
the free phase to the completely jamming phase occurs as the car density
of the system increases. Recently, many generalizations and extensions of
the BML model are elaborated to take into account several realistic features
of traﬃc in cities. For example, the eﬀect of asymmetry distributions of
vehicles among the east-bound and north-bound streets are investigated in
Ref.
[6] introduced the turn capability of urban car
movement in cities and they found a ﬁrst order phase transition from a
freely moving regime to a jammed state. Tadaki and Kikuchi [7] found two
types of jam phases in the BML model, the self-organized jam at relatively
low density and the random jam at high density. The anisotropy eﬀect of
directions of move on the BML model, in the periodic and open boundaries
conditions are investigated in Ref [8]. Chopard et al.
[9] have developed a
more realistic CA model of city traﬃc where the stretches of the streets in
between successive crossings appear explicitly. The rule for implementing
the motion of the vehicles at the crossing is formulated assuming a rotary
to be located at each crossing. The BML model has been extended also to
incorporate the eﬀects of the static hindrances or road blocks (e.g., vehicles
crashed in traﬃc accident) [10, 11]. It was shown that the dynamical jamming
transition occurs at lower density of cars with increasing delay time of a car
passing over the position of the traﬃc accident. J. Freund and T. P¨oschel

[5]. Cuesta et al.

2

[12] studied another generalization of the BML model. Each site of this
generalized model represents a crossing where a ﬁnite number of cars can
wait approaching the crossing from each of the four directions. The mean
velocity of cars, as a function of the global traﬃc density, is determined
numerically and derived analytically applying combinatorics and statistical
methods. The spatial extension of the streets between two intersections is
completely neglected in the original model. To incorporate this feature, D.
Chowdhury and A. Schadschneider [13] proposed a new cellular automata
model for vehicular traﬃc in cities by combining ideas borrowed from the
BML model of city traﬃc and the Nagel-Schreckenberg model [14] of highway
traﬃc. It was found a phase transition from the free-ﬂowing dynamical phase
to the completely ”jammed” phase at a vehicle density which depends on the
time periods of the synchronized signals and the separation between them
[15, 16].
In Sec. 2, we describe our models for traﬃc of cars in cities with origins
and destinations. In Sec. 3, we present our numerical results where we give
the mean velocity diagrams of the model A. A detailed description of the
distributions of the arrival times of drivers are also presented. For model B,
we present results concerning the evacuation processes of drivers inside the
lattice. Finally, we conclude with some conclusions in Sec. 4.

2 The BML Traﬃc Model With Origin-Destination

Trips

In the original BML Traﬃc Model, cars move, whenever the traﬃc lights
allow it, all along the lanes without any destinations.
In this paper, we
extend the model to describe cars movements with origin-destination trips.
Each car is associated with some given origin-destination sites. The distance
δ between origin and destination sites is chosen from certain probability
distributions ”ODDPD”. We shall consider here three types of distributions:
1) The exponential distribution,

f e(δ) =

µ
e−µδm − e−µδM

e−µδ

(1)

Here we focus the case where µ = 0.1 and we suppose that f (δ) has a support
on some interval [δm, δM ]. The numerical values of these parameters will be

3

deﬁned below.
2) The power-law distribution,

f p(δ) =

n + 1

(δM − δm)n+1 (δ − δm)n

(2)

(3)

(4)

Here we focus the case of n = 2 and we suppose that f (δ) has a support on
the interval [δm, δM ].
3) The uniform distribution,

f u(δ) = 1/(δM − δm)

Here f u(δ) has a support on the interval [δm, δM ].
The distance δ between origin and destination sites, used all along this paper
is deﬁned as follows. Let (xo, yo) and (xd, yd) be the coordinates of the origin
and destination sites respectively. We deﬁne also the variables δx and δy as:

δx = xd − x0
δx = L + (xd − x0)

(cid:26)

if

if

(xd − x0) ≥ 0;

(xd − x0) < 0.

Similar equations can lead to deﬁning δy with replacing x by y. The distance
δ is then given by,

(5)

δ = δx + δy
Initially, all the origins sites of drivers are chosen randomly from the lattice
points. According to traﬃc lights that permit horizontal motion at even time
steps and vertical motion at odd time steps, cars will move towards their des-
tinations by selecting some appropriates paths. Suppose that a car is initially
moving rightward (upward). If the origin and destination sites are in the same
lane (column), then the car will move horizontally (vertically) until it reaches
its destination. Otherwise, the car will move horizontally (vertically) until it
reaches the site belonging to the column (lane) of the destination site where
the car turns and moves upward (rightward) until it reaches its destination
(see ﬁgure 1). In this paper, we shall consider two simplest versions of the
model, which we name model A and model B. In conserved particles model
(model A), cars travel from the origin sites towards the destination sites.
A car which reaches its destination site continues to travel from that site
to a new destination site, chosen according to the ODDPD, and so on. In
non-conserved particles model ( model B), cars which completes its journey
disappears with certain probability β, or continues to travel from that site
to a new destination site (as in model A) with probability 1 − β.

4

3 Simulation experiments and results

We carry out our computer simulations of the model by considering a square
Initially, we put randomly a number N of cars into the
lattice of size L.
lattice with half arrows up and half right. The density of cars is denoted
as ρ = N/L2. We use a parallel updates scheme and a periodic boundary
conditions. The average velocity < v > of cars is deﬁned as the rate of moving
cars to the total number of cars allowed to move by the traﬃc lights. The
velocity of each car can be either 1 or 0. We perform numerical simulations of
the CA model starting with a set of random initial conditions for the system
size L = 40 − 200. After a transient period that depends on the system size,
on the random initial conﬁguration and on the density of cars, the system
reaches its asymptotic state. The duration of each simulation run is 50, 000
time steps with the ﬁrst 20, 000 time steps to initiate the simulation and
the latter 30, 000 used to generate performance statistics. Finally, we deﬁne
the parameter δm (resp. δM ) of the support interval of the ODDPD as the
minimal (resp. maximal) distance between the origin and the destination
sites, of the travelling paths of drivers. In our numerical simulations, we set
δm = 20 cells and δM = 2 ∗ (L − 1) cells. The ﬁrst numerical value is chosen
without any speciﬁcation while the second rises from the nature of the path
selection procedure followed in this paper (see for example the gray car and
its gray destination in ﬁgure 1).

3.1 Conserved particles model (Model A)

3.1.1 Velocity diagrams

In model A, cars travel from origins to destinations. After the arrival, the
destination sites will be considered as new origins, from where the travelling
will continue towards some new chosen destination sites, and so on. In ﬁgure
2, we carried out the plots of the mean velocity of cars as a function of the
density, for the three ODDPD. This diagram shows the presence of the two
known states, namely the moving phase and the completely jammed state
where all cars are blocked. In the freely moving state, interaction between
cars is weak and the propagation is important inside the lattice. In contrast,
for large density, the interaction becomes strong and jamming takes place
where car movements become rare. In contrast with the original BML model,
where a sharp transition separates the two phases, our model shows that the

5

mean velocity goes down to zero gradually with increasing the density and
vanishes above the transition point. On one hand, the power-law and the
uniform ODDPD lead to almost the same curves of the plot of hvi. On
the other hand, the exponential ODDPD leads to some diﬀerently curve.
So, for low density the mean velocity of cars of the exponential ODDPD is
smaller than that corresponding to power-law (or uniform) and higher for
high density. Now, let us study the transition point ρt separating the moving
phase and the completely jammed state where the average velocity vanishes.
From ﬁgure 2, we see clearly that ρt resulting from the exponential ODDPD
is higher than that resulting from the power-law or the uniform ones. Hence,
the capacity of traﬃc in cities can be improved if the travelling paths of
drivers are likely shorts.
To study the ﬁnite size eﬀect on the velocity diagrams of the system, we
compute the mean velocity for diﬀerent lattice sizes. That is in contrast
with the original BML traﬃc model, where the transition point decreases
when increasing the system size L (ρt ∝ L−0.14) [17], the velocity diagrams
in our models are unchanged with respect to large lattice sizes (Figure 3a,b).
The exponential ODDPD exhibits an interesting dependence of the velocity
diagram on the lattice size L (Fig.3a). At low densities, < v > remains
unchanged with respect to the variation of L. However, in the high density
region, one may distinguish some particular density where the mean velocity
does not depend once again on L. Below (resp. above) this density, < v >
increases) with L and reaches a stationary value at larger
decreases (resp.
sizes (L > 120). One sees from ﬁgure 3b that a similar behaviour may
occurred for the power-law ODDPD with the only diﬀerence is that the
dependence on L is inverted.

3.1.2 Arrival time distributions

When dealing with a realistic traﬃc in cities, it is important to know the
time necessary to travel from a given origin to a given destination, which
is called ”arrival time”. This time is interesting to the drivers because it
determines when they must leave their house in order to be on time at their
work.
In ﬁgure 4, we give the arrival time probability distribution of drivers where
the chosen ODDPD is exponential. When the cars density is low, times
shorter than τ1 ∼ 2 ∗ δm are strongly suppressed while beyond the probability
decays exponentially and exhibits a single peak at τ1. Since the traﬃc light

6

turns periodically and the minimal distance taken by each driver is supposed
equal to δm = 20 cells, the shortest arrival time will be closely equal to 40 time
steps. In addition, since cars interact very weakly at low densities, the arrival
time of any driver is almost equal to 2 ∗ δ where δ is the origin-destination
distance chosen by a driver. This justiﬁes the fact that the arrival time
distribution keeps the same shape (exponential) as the ODDPD. For higher
densities, the probability distribution of arrival times presents a single peak at
time approximately equal to τ1; reﬂecting the short routes chosen by almost
all drivers. Beyond τ1, the arrival time distribution decreases exponentially.
Consequently, with exponential ODDPD, arrival times of drivers will be likely
shorts even if the density is relatively high. In another hand, there are no
signiﬁcant changes of the probability distribution of arrival times with respect
to relatively large lattice sizes and relatively low densities. This result can
be clariﬁed from two points. First, only small distances from origins to
destinations can be drawn from the exponential distribution of equation (1).
Second, all the origins points of drivers are chosen randomly from the lattice
points. Hence, standing times lost by a driver are usually shorts since the
interaction with others cars is weak. Nevertheless, when the cars density is
close to ρt, cars self-organized into a large cluster (large jam) and almost all
vehicles do not move. Thus, drivers situated in the interior of this large jam
do not move and rest inside for an inﬁnite time. The only moving cars are
situated at the boundaries of the large jam which can reach their destinations
at ﬁnite times.
In ﬁgure 5, we plot the arrival time probability distribution of drivers where
the ODDPD is power-law. As before, when the cars density is low, the form
of the arrival time distribution is similar to that of the ODDPD because the
system is in free regime. However, in contrast to the exponential ODDPD,
the power-low one exhibits a strong dependence on the lattice size. In deed,
the distances drawn from the power-law ODDPD are usually large; leading
therefore to an enhancement of the arrival times of drivers if the lattice
size is increased.
If the car density increases, one ﬁnds evidently a broad
distribution of arrival times, because cars are moving for quite long times
before reaching their destinations. The higher is ρ, the higher is the arrival
time. Yet, the arrival time distribution exhibits two peaks. The arrival time
at the ﬁrst peak which is located at τ2 ∼ 2 ∗ δM changes little with increasing
the density. Beyond τ2, the distribution spreads to the higher value of arrival
times. On the other hand, times shorter than τ2 represent the arrival times of
cars which terminate their journey without that they are stopped. However,

7

times longer than τ2 correspond to cars which stopped for a while during
their routes. In the long times region, the probability distribution increases,
reaches a maximum and then decreases asymptotically towards zero. This
peak is considered as the most probable arrival time of a driver who travels
in congested region of the lattice. This behaviour which occurs also for the
time-headway in highways [18], rises from the strong interactions between
cars at high densities. Furthermore, long arrival times should be taken by
drivers in large lattice sizes, because larger distances could be drawn from
the probability distribution of Eq.(2).
If the uniform ODDPD is used and the cars density is low, one sees that
the corresponding arrival times distribution is uniform (Fig. 6). For higher
densities, we ﬁnd that the arrival times distribution behaves as the power-law
case, especially in long arrival times region. The main diﬀerence is that, in
the power-law case, the distribution presents two peaks while, in the uniform
case, it presents three peaks. The ﬁrst peak is the higher corresponding to
the arrival time τ1 while the second peak is shifted a little bit towards the
higher values with respect to τ2. Drivers with short trips can avoid congested
regions and move towards their destinations with a minimal arrival times.
However, those which travel far away, cannot avoid congested regions and
their arrival times will be larger than the distances of their trips. The third
peak gives the most probable arrival time of such drivers.

3.2 Non-Conserved particles model (Model B)

In model B, cars move from origins to destinations. In contrast to model A,
cars which completes its journey disappears with certain probability β, or
continues to move from that site to a new destination site with probability
1 − β. In model B, the number of cars present in the lattice, N(t), is not
conserved but decreases with time until becomes zero above certain time T ,
called hereafter as the evacuation time, i.e., the time it takes for all cars to
leave the lattice. Hereafter, we shall investigate the eﬀect of the ODDPD on
N(t).
If β = 1, the number of cars remains constant up to certain time τ1 ∼ 40
time steps which is the same for the three diﬀerent ODDPD. This is the time
needed to reach a destination for a driver which have an origin-destination
distance equal to δm = 20 cells. Above τ1, the number of cars N(t) shows a
polynomial or a linear or an exponential decreases if we used respectively a
power-law, or a uniform or an exponential ODDPD. Moreover, as ﬁgure 7a

8

shows, the evacuation time is much shorter for the exponential distribution
than for the two others distributions. As β diminishes, N(t) decreases slowly
with time; leading therefore to an increasing of the evacuation time. Most
interestingly, if β becomes very small, N(t) will decrease almost exponentially
for the three diﬀerent ODDPD. In addition, the evacuation times are found
to be very long for the power-law ODDPD (see Fig. 7b).
It is found that, when the time t exeeds τ1, the exponential ODDPD produces
an exponential decrease of the number N(t) whatever the values of the system
parameters. Thus, N(t) follows the equation,
N(t) = N0e−λt

(6)

where N0 is the initial number of drivers present in the lattice. Our results
depicted in ﬁgures 8a and 8b show that the coeﬃcient λ is independent on
both the initial density ρ0 and the lattice size L. However, it is found that λ
depends strongly on β and λ = f (β) is an increasing function which shows
a strong increase as β approaches the maximal value (β = 1). This function
is illustrated in ﬁgure 8c.
Finally, the dependence of the evacuation time T on the parameter β is
depicted in ﬁgure 9a for the three ODDPD at low and high densities. We
ﬁnd that, the evacuation time diverges as β approaches the vanishing value.
From ﬁgure 9b we see that the evacuation time T follows a power law behavior
of the form,

T ∝ β−ν
Except for some minor ﬂuctuations, the dynamic exponent ν remains un-
changed when varying the density or when changing the type of ODDPD.
For examples, if the exponential ODDPD is used, one ﬁnds, ν ≈ 1.08 ± 0.001
for ρ0 = 0.1 and ν ≈ 1.09 ± 0.007 for ρ0 = 0.3, while for the power-law case
one ﬁnds, ν ≈ 1.10 ± 0.009 for ρ0 = 0.1 and ν ≈ 1.11 ± 0.006 for ρ = 0.3.
Assuming that the parameter β is rate of transition for the dynamics of the
model B, and as it was demonstrated in Ref. [19] for a one-dimensional traﬃc
model, the exponent ν is expected to be theoretically equal to one.

(7)

4 Conclusions

In summary, we have extended the BML model to incorporate the origin
and destination eﬀect of drivers trips on the traﬃc in cities. The origin-
destination distances are drawn from certain probability distribution that is

9

used for all drivers.
In model A, all drivers continue their travelling even if they reached their des-
tinations. The mean velocity of cars is greatly inﬂuenced by the ODDPD.
Yet, the transition density that separates the moving phase and the com-
pletely jammed state, is higher when we used the exponential ODDPD than
if we used the power-law or the uniform ODDPD. The arrival times of drivers
depend on the density and on the type of ODDPD. At low density, cars in-
teract very weakly and the arrival time is almost equal to 2 ∗ δ where δ is the
origin-destination distance. However, at high density, cars strongly interact
and jamming phase occurs. This increases the arrival time of some drivers
which stopped for a while during their journeys. Our results indicate that
we can adjust the ODDPD to enhance the road capacity of the city and to
minimize the arrival time of drivers. The eﬀect of lattice size L is also stud-
ied. Hence, in contrast to the original BML model, the model A shows a non
dependence of the mean velocity on the lattice size beyond some large limit.
However, the distribution of arrival times becomes broad as we increase the
size L, especially for the power-law and the uniform distance distributions.
The other version studied in this paper is the model B where a driver which
reaches its destination disappears with rate β. We found that the evacua-
tion processes is greatly inﬂuenced by the ODDPD. For the three ODDPD
and with respect to varying the rate β, the evacuation time is found to ex-
hibit a power law behaviour. This evacuation processes is characterized by
a dynamical exponent ν (τ ∝ β−ν, ν = 1).

10

References

[1] O. Biham, A. A. Middleton, and D. Levine, Phys. Rev. A 46 6124 (1992).

[2] D. Helbing, Rev. Mod. Phys. 73 1067 (2001).

[3] D. Chowdhury, L. Santen and A. Schadschneider, Phys. Rep. 329 199

(2000).

[4] T. Nagatani, Rep. Prog. Phys. 65 1331 (2002).

[5] T. Nagatani, J. Phys. Soc. Jap. 62, 2656(1993).

[6] J.A. Cuesta, F.C. Martines, J.M. Molera and A. Sanchez, Phys. Rev. E

48, R4175 (1993).

[7] S. Tadaki and M. Kikuchi, Phys. Rev. E 50, 4564 (1994).

[8] A. Benyoussef, H. Chakib, and H. Ez-Zahraouy, Phys. Rev. E 68, 026129

(2003).

(1993).

421 (1996).

[9] B. Chopard, P.O. Luthi and P.A. Queloz, J. Phys. A 29, 2325 (1996).

[10] T. Nagatani, J.Phys.A 26, L1015 (1993); J. Phys. Soc. Jap. 62, 1085

[11] G.Q. Gu, K.H. Chung and P.M. Hui, Physica A 217, 339 (1995).

[12] J. Freund and T. P¨oschel, Physica A 219, 95 (1995); J. Stat. Phys., 86,

[13] D. Chowdhury and A. Schadschneider, Phys. Rev. E 59, R1311 (1999).

[14] K. Nagel and M. Schreckenberg, J. Phys. (France) I, 2, 2221 (1992).

[15] A. Schadschneider, D. Chowdhury, E. Brockfeld, K. Klauck, L. Santen,
and J. Zittartz, Traﬃc and Granular Flow 99 Springer, New York (2000).

[16] E. Brockfeld, R. Barlovic, A. Schadschneider and M. Schreckenberg,

Phys. Rev. E 64 056132 (2001).

11

[17] Y. Shi, adap-org/9509003.

[18] N. Moussa, Int. J. Mod. Phys. C 15, 29 (2004).

[19] N. Moussa, Phys. Rev. E 71, 026124 (2005).

12

Figures captions

Figure 1. Illustration of traﬃc in a square lattice (with periodic
boundary conditions) where each car moves from origins to des-
tinations. Cars (rectangles) located at the origin sites will move
towards their destination sites (circles).
Figure 2. Mean velocity diagrams of cars versus density for the
three diﬀerent ODDPD.
Figure 3. Mean velocity diagrams of cars versus density for
diﬀerent values of lattice size L. (a) Exponential ODDPD; (b)
Power-law ODDPD.
Figure 4. The arrival time probability distribution of drivers for
the exponential ODDPD.
Figure 5. The arrival time probability distribution of drivers for
the power-law ODDPD.
Figure 6. The arrival time probability distribution of drivers for
the uniform ODDPD.
Figure 7. Time evolution of the number of drivers present in the
lattice for the three ODDPD and for various values of the rate β;
(a) β = 1.0 and β = 0.5; (b) β = 0.1.
Figure 8. Time evolution of the number of drivers present in
the lattice for the exponential ODDPD; (a) for various values of
the rate β and density ρ; (b) for various lattice size L.
Figure 9. The dependence of the evacuation time T on the pa-
rameter β for the three ODDPD at low and high densities; (a)
Linear plots (b) Log-Log plots.

13

6
0
0
2
 
n
a
J
 
8
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
5
3
1
1
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Biham-Middleton-Levine Traﬃc Model
With Origin-Destination Trips

Najem Moussa ∗
ESNM, D´ept. de Physique, FST,
B.P. 509, Boutalamine, Errachidia, Morocco

February 21, 2014

Abstract

We extended the Biham-Middleton-Levine model to incorporate
the origin and destination eﬀect of drivers trips on the traﬃc in cities.
The destination sites are randomly chosen from some origin-destination
distances probability distribution ”ODDPD”. We use three diﬀerent
distributions: exponential, uniform and power-law. We consider two
variants of the model. In conserved particles model (Model A), drivers
continue their travelling even if they reached their destinations.
In
non-conserved particles model (Model B), a driver which reaches its
destination disappears with rate β. It is found that the traﬃc dynam-
ics in model A and the evacuation processes in model B are greatly
inﬂuenced by the ODDPD. On one hand, we found that we can adjust
the ODDPD to enhance the road capacity of the city and to minimize
the arrival times of drivers in particles conserved system and to op-
timize the evacuation time of drivers in non-conserved case. On the
other hand, we ﬁnd that, independently on the ODDPD, the evacua-
tion time T of drivers diverges in the form of a power law T ∝ β−ν ,
with ν = 1.
Pacs numbers: 45.70.Vn, 02.50.Ey, 05.40.-a
Keywords: Traﬃc; Cellular Automata; Freely Moving; Jamming; Ar-
rival Times, Evacuation Times

∗e-mail: najemmoussa@yahoo.fr

1

1 Introduction

Ever since O. Biham, A.A. Middleton and D. Levine elaborated their traﬃc
model (BML) [1], the two-dimensional cellular automata (CA) traﬃc models
are used enormously in order to understand the complex dynamic behavior of
the traﬃc in cities (see the reviews [2-4]). In CA, time and space are discrete.
The space is represented as a uniform lattice of cells with ﬁnite number of
states, subject to a uniform set of rules, which drives the behavior of the
system. These rules compute the state of a particular cell as a function of
its previous state and the state of the neighboring cells.
The BML model is a three-state CA with periodic boundary conditions where
at a given time step each site can be occupied by a car moving upward, a car
moving rightward, or the site is empty. There are equal number of cars in
each direction and the dynamics is governed by synchronous traﬃc lights that
allow alternatively vertical or horizontal movements. At their turn each car
jumps to its next place whenever it is empty. Thus, an essential ingredient
of the BML model is the excluded volume at crossings which determines the
sharp transition between two phases. A ﬁrst order phase transition from
the free phase to the completely jamming phase occurs as the car density
of the system increases. Recently, many generalizations and extensions of
the BML model are elaborated to take into account several realistic features
of traﬃc in cities. For example, the eﬀect of asymmetry distributions of
vehicles among the east-bound and north-bound streets are investigated in
Ref.
[6] introduced the turn capability of urban car
movement in cities and they found a ﬁrst order phase transition from a
freely moving regime to a jammed state. Tadaki and Kikuchi [7] found two
types of jam phases in the BML model, the self-organized jam at relatively
low density and the random jam at high density. The anisotropy eﬀect of
directions of move on the BML model, in the periodic and open boundaries
conditions are investigated in Ref [8]. Chopard et al.
[9] have developed a
more realistic CA model of city traﬃc where the stretches of the streets in
between successive crossings appear explicitly. The rule for implementing
the motion of the vehicles at the crossing is formulated assuming a rotary
to be located at each crossing. The BML model has been extended also to
incorporate the eﬀects of the static hindrances or road blocks (e.g., vehicles
crashed in traﬃc accident) [10, 11]. It was shown that the dynamical jamming
transition occurs at lower density of cars with increasing delay time of a car
passing over the position of the traﬃc accident. J. Freund and T. P¨oschel

[5]. Cuesta et al.

2

[12] studied another generalization of the BML model. Each site of this
generalized model represents a crossing where a ﬁnite number of cars can
wait approaching the crossing from each of the four directions. The mean
velocity of cars, as a function of the global traﬃc density, is determined
numerically and derived analytically applying combinatorics and statistical
methods. The spatial extension of the streets between two intersections is
completely neglected in the original model. To incorporate this feature, D.
Chowdhury and A. Schadschneider [13] proposed a new cellular automata
model for vehicular traﬃc in cities by combining ideas borrowed from the
BML model of city traﬃc and the Nagel-Schreckenberg model [14] of highway
traﬃc. It was found a phase transition from the free-ﬂowing dynamical phase
to the completely ”jammed” phase at a vehicle density which depends on the
time periods of the synchronized signals and the separation between them
[15, 16].
In Sec. 2, we describe our models for traﬃc of cars in cities with origins
and destinations. In Sec. 3, we present our numerical results where we give
the mean velocity diagrams of the model A. A detailed description of the
distributions of the arrival times of drivers are also presented. For model B,
we present results concerning the evacuation processes of drivers inside the
lattice. Finally, we conclude with some conclusions in Sec. 4.

2 The BML Traﬃc Model With Origin-Destination

Trips

In the original BML Traﬃc Model, cars move, whenever the traﬃc lights
allow it, all along the lanes without any destinations.
In this paper, we
extend the model to describe cars movements with origin-destination trips.
Each car is associated with some given origin-destination sites. The distance
δ between origin and destination sites is chosen from certain probability
distributions ”ODDPD”. We shall consider here three types of distributions:
1) The exponential distribution,

f e(δ) =

µ
e−µδm − e−µδM

e−µδ

(1)

Here we focus the case where µ = 0.1 and we suppose that f (δ) has a support
on some interval [δm, δM ]. The numerical values of these parameters will be

3

deﬁned below.
2) The power-law distribution,

f p(δ) =

n + 1

(δM − δm)n+1 (δ − δm)n

(2)

(3)

(4)

Here we focus the case of n = 2 and we suppose that f (δ) has a support on
the interval [δm, δM ].
3) The uniform distribution,

f u(δ) = 1/(δM − δm)

Here f u(δ) has a support on the interval [δm, δM ].
The distance δ between origin and destination sites, used all along this paper
is deﬁned as follows. Let (xo, yo) and (xd, yd) be the coordinates of the origin
and destination sites respectively. We deﬁne also the variables δx and δy as:

δx = xd − x0
δx = L + (xd − x0)

(cid:26)

if

if

(xd − x0) ≥ 0;

(xd − x0) < 0.

Similar equations can lead to deﬁning δy with replacing x by y. The distance
δ is then given by,

(5)

δ = δx + δy
Initially, all the origins sites of drivers are chosen randomly from the lattice
points. According to traﬃc lights that permit horizontal motion at even time
steps and vertical motion at odd time steps, cars will move towards their des-
tinations by selecting some appropriates paths. Suppose that a car is initially
moving rightward (upward). If the origin and destination sites are in the same
lane (column), then the car will move horizontally (vertically) until it reaches
its destination. Otherwise, the car will move horizontally (vertically) until it
reaches the site belonging to the column (lane) of the destination site where
the car turns and moves upward (rightward) until it reaches its destination
(see ﬁgure 1). In this paper, we shall consider two simplest versions of the
model, which we name model A and model B. In conserved particles model
(model A), cars travel from the origin sites towards the destination sites.
A car which reaches its destination site continues to travel from that site
to a new destination site, chosen according to the ODDPD, and so on. In
non-conserved particles model ( model B), cars which completes its journey
disappears with certain probability β, or continues to travel from that site
to a new destination site (as in model A) with probability 1 − β.

4

3 Simulation experiments and results

We carry out our computer simulations of the model by considering a square
Initially, we put randomly a number N of cars into the
lattice of size L.
lattice with half arrows up and half right. The density of cars is denoted
as ρ = N/L2. We use a parallel updates scheme and a periodic boundary
conditions. The average velocity < v > of cars is deﬁned as the rate of moving
cars to the total number of cars allowed to move by the traﬃc lights. The
velocity of each car can be either 1 or 0. We perform numerical simulations of
the CA model starting with a set of random initial conditions for the system
size L = 40 − 200. After a transient period that depends on the system size,
on the random initial conﬁguration and on the density of cars, the system
reaches its asymptotic state. The duration of each simulation run is 50, 000
time steps with the ﬁrst 20, 000 time steps to initiate the simulation and
the latter 30, 000 used to generate performance statistics. Finally, we deﬁne
the parameter δm (resp. δM ) of the support interval of the ODDPD as the
minimal (resp. maximal) distance between the origin and the destination
sites, of the travelling paths of drivers. In our numerical simulations, we set
δm = 20 cells and δM = 2 ∗ (L − 1) cells. The ﬁrst numerical value is chosen
without any speciﬁcation while the second rises from the nature of the path
selection procedure followed in this paper (see for example the gray car and
its gray destination in ﬁgure 1).

3.1 Conserved particles model (Model A)

3.1.1 Velocity diagrams

In model A, cars travel from origins to destinations. After the arrival, the
destination sites will be considered as new origins, from where the travelling
will continue towards some new chosen destination sites, and so on. In ﬁgure
2, we carried out the plots of the mean velocity of cars as a function of the
density, for the three ODDPD. This diagram shows the presence of the two
known states, namely the moving phase and the completely jammed state
where all cars are blocked. In the freely moving state, interaction between
cars is weak and the propagation is important inside the lattice. In contrast,
for large density, the interaction becomes strong and jamming takes place
where car movements become rare. In contrast with the original BML model,
where a sharp transition separates the two phases, our model shows that the

5

mean velocity goes down to zero gradually with increasing the density and
vanishes above the transition point. On one hand, the power-law and the
uniform ODDPD lead to almost the same curves of the plot of hvi. On
the other hand, the exponential ODDPD leads to some diﬀerently curve.
So, for low density the mean velocity of cars of the exponential ODDPD is
smaller than that corresponding to power-law (or uniform) and higher for
high density. Now, let us study the transition point ρt separating the moving
phase and the completely jammed state where the average velocity vanishes.
From ﬁgure 2, we see clearly that ρt resulting from the exponential ODDPD
is higher than that resulting from the power-law or the uniform ones. Hence,
the capacity of traﬃc in cities can be improved if the travelling paths of
drivers are likely shorts.
To study the ﬁnite size eﬀect on the velocity diagrams of the system, we
compute the mean velocity for diﬀerent lattice sizes. That is in contrast
with the original BML traﬃc model, where the transition point decreases
when increasing the system size L (ρt ∝ L−0.14) [17], the velocity diagrams
in our models are unchanged with respect to large lattice sizes (Figure 3a,b).
The exponential ODDPD exhibits an interesting dependence of the velocity
diagram on the lattice size L (Fig.3a). At low densities, < v > remains
unchanged with respect to the variation of L. However, in the high density
region, one may distinguish some particular density where the mean velocity
does not depend once again on L. Below (resp. above) this density, < v >
increases) with L and reaches a stationary value at larger
decreases (resp.
sizes (L > 120). One sees from ﬁgure 3b that a similar behaviour may
occurred for the power-law ODDPD with the only diﬀerence is that the
dependence on L is inverted.

3.1.2 Arrival time distributions

When dealing with a realistic traﬃc in cities, it is important to know the
time necessary to travel from a given origin to a given destination, which
is called ”arrival time”. This time is interesting to the drivers because it
determines when they must leave their house in order to be on time at their
work.
In ﬁgure 4, we give the arrival time probability distribution of drivers where
the chosen ODDPD is exponential. When the cars density is low, times
shorter than τ1 ∼ 2 ∗ δm are strongly suppressed while beyond the probability
decays exponentially and exhibits a single peak at τ1. Since the traﬃc light

6

turns periodically and the minimal distance taken by each driver is supposed
equal to δm = 20 cells, the shortest arrival time will be closely equal to 40 time
steps. In addition, since cars interact very weakly at low densities, the arrival
time of any driver is almost equal to 2 ∗ δ where δ is the origin-destination
distance chosen by a driver. This justiﬁes the fact that the arrival time
distribution keeps the same shape (exponential) as the ODDPD. For higher
densities, the probability distribution of arrival times presents a single peak at
time approximately equal to τ1; reﬂecting the short routes chosen by almost
all drivers. Beyond τ1, the arrival time distribution decreases exponentially.
Consequently, with exponential ODDPD, arrival times of drivers will be likely
shorts even if the density is relatively high. In another hand, there are no
signiﬁcant changes of the probability distribution of arrival times with respect
to relatively large lattice sizes and relatively low densities. This result can
be clariﬁed from two points. First, only small distances from origins to
destinations can be drawn from the exponential distribution of equation (1).
Second, all the origins points of drivers are chosen randomly from the lattice
points. Hence, standing times lost by a driver are usually shorts since the
interaction with others cars is weak. Nevertheless, when the cars density is
close to ρt, cars self-organized into a large cluster (large jam) and almost all
vehicles do not move. Thus, drivers situated in the interior of this large jam
do not move and rest inside for an inﬁnite time. The only moving cars are
situated at the boundaries of the large jam which can reach their destinations
at ﬁnite times.
In ﬁgure 5, we plot the arrival time probability distribution of drivers where
the ODDPD is power-law. As before, when the cars density is low, the form
of the arrival time distribution is similar to that of the ODDPD because the
system is in free regime. However, in contrast to the exponential ODDPD,
the power-low one exhibits a strong dependence on the lattice size. In deed,
the distances drawn from the power-law ODDPD are usually large; leading
therefore to an enhancement of the arrival times of drivers if the lattice
size is increased.
If the car density increases, one ﬁnds evidently a broad
distribution of arrival times, because cars are moving for quite long times
before reaching their destinations. The higher is ρ, the higher is the arrival
time. Yet, the arrival time distribution exhibits two peaks. The arrival time
at the ﬁrst peak which is located at τ2 ∼ 2 ∗ δM changes little with increasing
the density. Beyond τ2, the distribution spreads to the higher value of arrival
times. On the other hand, times shorter than τ2 represent the arrival times of
cars which terminate their journey without that they are stopped. However,

7

times longer than τ2 correspond to cars which stopped for a while during
their routes. In the long times region, the probability distribution increases,
reaches a maximum and then decreases asymptotically towards zero. This
peak is considered as the most probable arrival time of a driver who travels
in congested region of the lattice. This behaviour which occurs also for the
time-headway in highways [18], rises from the strong interactions between
cars at high densities. Furthermore, long arrival times should be taken by
drivers in large lattice sizes, because larger distances could be drawn from
the probability distribution of Eq.(2).
If the uniform ODDPD is used and the cars density is low, one sees that
the corresponding arrival times distribution is uniform (Fig. 6). For higher
densities, we ﬁnd that the arrival times distribution behaves as the power-law
case, especially in long arrival times region. The main diﬀerence is that, in
the power-law case, the distribution presents two peaks while, in the uniform
case, it presents three peaks. The ﬁrst peak is the higher corresponding to
the arrival time τ1 while the second peak is shifted a little bit towards the
higher values with respect to τ2. Drivers with short trips can avoid congested
regions and move towards their destinations with a minimal arrival times.
However, those which travel far away, cannot avoid congested regions and
their arrival times will be larger than the distances of their trips. The third
peak gives the most probable arrival time of such drivers.

3.2 Non-Conserved particles model (Model B)

In model B, cars move from origins to destinations. In contrast to model A,
cars which completes its journey disappears with certain probability β, or
continues to move from that site to a new destination site with probability
1 − β. In model B, the number of cars present in the lattice, N(t), is not
conserved but decreases with time until becomes zero above certain time T ,
called hereafter as the evacuation time, i.e., the time it takes for all cars to
leave the lattice. Hereafter, we shall investigate the eﬀect of the ODDPD on
N(t).
If β = 1, the number of cars remains constant up to certain time τ1 ∼ 40
time steps which is the same for the three diﬀerent ODDPD. This is the time
needed to reach a destination for a driver which have an origin-destination
distance equal to δm = 20 cells. Above τ1, the number of cars N(t) shows a
polynomial or a linear or an exponential decreases if we used respectively a
power-law, or a uniform or an exponential ODDPD. Moreover, as ﬁgure 7a

8

shows, the evacuation time is much shorter for the exponential distribution
than for the two others distributions. As β diminishes, N(t) decreases slowly
with time; leading therefore to an increasing of the evacuation time. Most
interestingly, if β becomes very small, N(t) will decrease almost exponentially
for the three diﬀerent ODDPD. In addition, the evacuation times are found
to be very long for the power-law ODDPD (see Fig. 7b).
It is found that, when the time t exeeds τ1, the exponential ODDPD produces
an exponential decrease of the number N(t) whatever the values of the system
parameters. Thus, N(t) follows the equation,
N(t) = N0e−λt

(6)

where N0 is the initial number of drivers present in the lattice. Our results
depicted in ﬁgures 8a and 8b show that the coeﬃcient λ is independent on
both the initial density ρ0 and the lattice size L. However, it is found that λ
depends strongly on β and λ = f (β) is an increasing function which shows
a strong increase as β approaches the maximal value (β = 1). This function
is illustrated in ﬁgure 8c.
Finally, the dependence of the evacuation time T on the parameter β is
depicted in ﬁgure 9a for the three ODDPD at low and high densities. We
ﬁnd that, the evacuation time diverges as β approaches the vanishing value.
From ﬁgure 9b we see that the evacuation time T follows a power law behavior
of the form,

T ∝ β−ν
Except for some minor ﬂuctuations, the dynamic exponent ν remains un-
changed when varying the density or when changing the type of ODDPD.
For examples, if the exponential ODDPD is used, one ﬁnds, ν ≈ 1.08 ± 0.001
for ρ0 = 0.1 and ν ≈ 1.09 ± 0.007 for ρ0 = 0.3, while for the power-law case
one ﬁnds, ν ≈ 1.10 ± 0.009 for ρ0 = 0.1 and ν ≈ 1.11 ± 0.006 for ρ = 0.3.
Assuming that the parameter β is rate of transition for the dynamics of the
model B, and as it was demonstrated in Ref. [19] for a one-dimensional traﬃc
model, the exponent ν is expected to be theoretically equal to one.

(7)

4 Conclusions

In summary, we have extended the BML model to incorporate the origin
and destination eﬀect of drivers trips on the traﬃc in cities. The origin-
destination distances are drawn from certain probability distribution that is

9

used for all drivers.
In model A, all drivers continue their travelling even if they reached their des-
tinations. The mean velocity of cars is greatly inﬂuenced by the ODDPD.
Yet, the transition density that separates the moving phase and the com-
pletely jammed state, is higher when we used the exponential ODDPD than
if we used the power-law or the uniform ODDPD. The arrival times of drivers
depend on the density and on the type of ODDPD. At low density, cars in-
teract very weakly and the arrival time is almost equal to 2 ∗ δ where δ is the
origin-destination distance. However, at high density, cars strongly interact
and jamming phase occurs. This increases the arrival time of some drivers
which stopped for a while during their journeys. Our results indicate that
we can adjust the ODDPD to enhance the road capacity of the city and to
minimize the arrival time of drivers. The eﬀect of lattice size L is also stud-
ied. Hence, in contrast to the original BML model, the model A shows a non
dependence of the mean velocity on the lattice size beyond some large limit.
However, the distribution of arrival times becomes broad as we increase the
size L, especially for the power-law and the uniform distance distributions.
The other version studied in this paper is the model B where a driver which
reaches its destination disappears with rate β. We found that the evacua-
tion processes is greatly inﬂuenced by the ODDPD. For the three ODDPD
and with respect to varying the rate β, the evacuation time is found to ex-
hibit a power law behaviour. This evacuation processes is characterized by
a dynamical exponent ν (τ ∝ β−ν, ν = 1).

10

References

[1] O. Biham, A. A. Middleton, and D. Levine, Phys. Rev. A 46 6124 (1992).

[2] D. Helbing, Rev. Mod. Phys. 73 1067 (2001).

[3] D. Chowdhury, L. Santen and A. Schadschneider, Phys. Rep. 329 199

(2000).

[4] T. Nagatani, Rep. Prog. Phys. 65 1331 (2002).

[5] T. Nagatani, J. Phys. Soc. Jap. 62, 2656(1993).

[6] J.A. Cuesta, F.C. Martines, J.M. Molera and A. Sanchez, Phys. Rev. E

48, R4175 (1993).

[7] S. Tadaki and M. Kikuchi, Phys. Rev. E 50, 4564 (1994).

[8] A. Benyoussef, H. Chakib, and H. Ez-Zahraouy, Phys. Rev. E 68, 026129

(2003).

(1993).

421 (1996).

[9] B. Chopard, P.O. Luthi and P.A. Queloz, J. Phys. A 29, 2325 (1996).

[10] T. Nagatani, J.Phys.A 26, L1015 (1993); J. Phys. Soc. Jap. 62, 1085

[11] G.Q. Gu, K.H. Chung and P.M. Hui, Physica A 217, 339 (1995).

[12] J. Freund and T. P¨oschel, Physica A 219, 95 (1995); J. Stat. Phys., 86,

[13] D. Chowdhury and A. Schadschneider, Phys. Rev. E 59, R1311 (1999).

[14] K. Nagel and M. Schreckenberg, J. Phys. (France) I, 2, 2221 (1992).

[15] A. Schadschneider, D. Chowdhury, E. Brockfeld, K. Klauck, L. Santen,
and J. Zittartz, Traﬃc and Granular Flow 99 Springer, New York (2000).

[16] E. Brockfeld, R. Barlovic, A. Schadschneider and M. Schreckenberg,

Phys. Rev. E 64 056132 (2001).

11

[17] Y. Shi, adap-org/9509003.

[18] N. Moussa, Int. J. Mod. Phys. C 15, 29 (2004).

[19] N. Moussa, Phys. Rev. E 71, 026124 (2005).

12

Figures captions

Figure 1. Illustration of traﬃc in a square lattice (with periodic
boundary conditions) where each car moves from origins to des-
tinations. Cars (rectangles) located at the origin sites will move
towards their destination sites (circles).
Figure 2. Mean velocity diagrams of cars versus density for the
three diﬀerent ODDPD.
Figure 3. Mean velocity diagrams of cars versus density for
diﬀerent values of lattice size L. (a) Exponential ODDPD; (b)
Power-law ODDPD.
Figure 4. The arrival time probability distribution of drivers for
the exponential ODDPD.
Figure 5. The arrival time probability distribution of drivers for
the power-law ODDPD.
Figure 6. The arrival time probability distribution of drivers for
the uniform ODDPD.
Figure 7. Time evolution of the number of drivers present in the
lattice for the three ODDPD and for various values of the rate β;
(a) β = 1.0 and β = 0.5; (b) β = 0.1.
Figure 8. Time evolution of the number of drivers present in
the lattice for the exponential ODDPD; (a) for various values of
the rate β and density ρ; (b) for various lattice size L.
Figure 9. The dependence of the evacuation time T on the pa-
rameter β for the three ODDPD at low and high densities; (a)
Linear plots (b) Log-Log plots.

13

