6
0
0
2
 
p
e
S
 
7
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
3
5
0
9
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Random matrix ensembles of time-lagged correlation matrices: Derivation of
eigenvalue spectra and analysis of ﬁnancial time-series

Christoly Biely1,

∗ and Stefan Thurner1,

†

1

Complex Systems Research Group, HNO, Medical University of Vienna, W¨ahringer G¨urtel 18-20, A-1090 Vienna
and
Atominstitut der ¨Osterreichischen Universit¨aten, Stadionallee 2, A-1020 Vienna, Austria
(Dated: February 2, 2008)

We derive the exact form of the eigenvalue spectra of correlation matrices derived from a
set of time-shifted, ﬁnite Brownian random walks (time-series). These matrices can be seen as
random, real, asymmetric matrices with a special structure superimposed due to the time-shift.
We demonstrate that the associated eigenvalue spectrum is circular symmetric in the complex
plane for large matrices. This fact allows us to exactly compute the eigenvalue density via an
inverse Abel-transform of the density of the symmetrized problem. We demonstrate the validity
of this approach by numerically computing eigenvalue spectra of lagged correlation matrices based
on uncorrelated, Gaussian distributed time-series. We then compare our theoretical ﬁndings with
eigenvalue densities obtained from actual high frequency (5 min) data of the S&P500 and discuss
the observed deviations. We identify various non-trivial, non-random patterns and ﬁnd asymmetric
dependencies associated with eigenvalues departing strongly from the Gaussian prediction in the
imaginary part. For the same time-series, with the market contribution removed, we observe strong
clustering of stocks, i.e. causal sectors. We ﬁnally comment on the time-stability of the observed
patterns.

PACS: 02.50.-r, 02.10.Yn, 89.65.Gh, 05.45.Tp, 05.40.-a, 24.60.-k, 87.10.+e

1.

INTRODUCTION

regime) in actual portfolio management.

One of the pillars of contemporary theory of ﬁnan-
cial economics is the notion of correlation matrices of
timeseries of ﬁnancial instruments; the capital asset pric-
ing model [1] and Markowitz portfolio theory [2] proba-
bly being the most prominent examples. Recent empir-
ical analyses on the detailed structure of ﬁnancial cor-
relation matrices have shown that there exist remark-
able deviations from predictions that would be expected
from the eﬃcient market hypothesis. In particular, based
on pioneering work [3, 4], eigenvalue spectra of empiri-
cal equal-time covariance matrices have been analyzed
and compared to predictions of eigenvalue densities for
Gaussian-randomness obtained from random matrix the-
ory (RMT). It has been shown, that the eigenvectors
which strongly depart from the spectrum obtained by
RMT contain information about sector organization of
markets [5, 6]. The largest eigenvalue has been identi-
ﬁed as the ’market-mode’, and it has been pointed out
that a ’cleaning’ of the original correlation matrices by
removing the noise part of the spectrum explainable by
RMT results in an improved mean variance eﬃcient fron-
tier which seems to be much more adequate than the one
obtained by Markowitz (see e.g. the recent discussion in
[7]). Further, RMT provides an almost full understand-
ing of why the Markovitz approach is close to useless
(dominance of small eigenvalues which lie in the noise

∗Electronic address: christoly.biely@meduniwien.ac.at
†Electronic address: thurner@univie.ac.at

Initially, RMT has been proposed to explain energy
spectra of complicated nuclei half a century ago. In its
simplest form, a random matrix ensemble is an ensemble
N matrices M whose entries Mij are uncorrelated
of N
iid random variables, and whose distribution is given by

×

P (M)

exp

∼

βN
2

−

(cid:18)

Tr(MMT )

,

(1)

(cid:19)

where β takes speciﬁc values for diﬀerent ensembles of
matrices (e.g. depending on whether or not the random
variables are complex- or real-valued). Eigenvalue spec-
tra and correlations of eigenvalues in the limit N
→ ∞
have been worked out for symmetric N
N random ma-
trices by Wigner [8]. For real valued matrix entries, such
symmetric random matrices are sometimes referred to as
the Gaussian orthogonal ensemble (GOE).

×

The symmetry constraint has later been relaxed by
Ginibre and the probability distributions of diﬀerent en-
sembles (real, complex, quaternion) – known as Ginibre
ensembles (GinOE, GinUE, GinSE) – have been derived
[9] in the limit of inﬁnite matrix size. For ensembles of
random real asymmetric matrices (GinOE) – the most
diﬃcult case – progress has only slowly been made under
great eﬀorts over the past decades. The eigenvalue den-
sity could ﬁnally be derived via diﬀerent methods [10, 11],
where – quite remarkably – the ﬁnite-size dependence of
the ensemble has also been elucidated [11]. For recent
progress in the ﬁeld also see [12].

However, these developments in RMT do not yet take
into account the timeseries character of ﬁnancial appli-
cations, i.e. the fact, that one deals – in general – with
(lagged) covariance matrices stemming from ﬁnite rect-

∼

×

×

T data matrices X, which contain data for N
angular N
diﬀerent assets (or instruments) at T observation points.
N co-
The matrix ensemble corresponding to the N
variance matrix C
XXT of such data is known as the
Wishart ensemble [13] and is a cornerstone of multivari-
ate data analysis. For the case of uncorrelated Gaussian
distributed data, the exact solution to the eigenvalue-
spectrum of XXT is known as Marcenko-Pastur law (for
N
) and has been used as a starting point for ran-
dom matrix analysis of correlation matrices at lag zero
[3, 4, 5, 6, 7, 14]. Moreover a quite general methodol-
ogy of extracting meaningful correlations between vari-
ables has been discussed based on a generalization of
the Marcenko-Pastur distribution [36]. The underlying
method was the powerful tool of singular-value decompo-
sition and RMT was used to predict singular-value spec-
tra of Gaussian randomness.

→ ∞

P

T
t ri

τ ∼

The time-lagged analogon to the covariance matrix
trj
is deﬁned as Cij
τ , where one timeseries is
t
−
shifted by τ timesteps with respect to the other. In con-
trast to (real-valued) equal-time correlation matrices of
the Wishart ensemble, which have a real eigenvalue spec-
trum, the spectrum of Cτ is deﬁned in the complex plane
since matrices of these type are in general asymmetric.
While the complex spectrum of Cτ remains unknown so
far, results for symmetrized lagged correlation matrices
have been reported recently [15, 16]. In [16], it was also
shown that the methodology of free random variables
can be used to tackle a variety of correlated (symmet-
ric) Wishart matrix models.

However, it is the analysis of the initial asymmetric
time-lagged correlations which forms a fundamental part
of ﬁnance and econometrics, and which has attracted
considerable attention in the respective literature. The
existence of asymmetric lead-lag relationships has been
initially reported for the U.S. stock market [17]. Speciﬁ-
cally, it was found that returns of large stocks lead those
of smaller ones. Later, trading volume was identiﬁed as
a signiﬁcant determinant of such lead-lag patterns, and
returns of high-volume stocks (portfolios) were found to
lead those of low-volume stocks (portfolios) [18]. These
lead-lag eﬀects have primarily been explained by diﬀer-
ent eﬀects of information adjustment asymmetry. For
instance, a model was brought forward in [19], where it
was argued, that, as soon as previous price changes are
observed and marketwide information can thus be incor-
porated in the marketmakers’ evaluation of stock prices,
lagged correlations may emanate. Another type of infor-
mation asymmetry can be seen in the diﬀerent number
of investment analysts following a ﬁrm’s stock price [20].
Other explanatory approaches, include the institutional
ownership of stocks [21], the diﬀerent exposure of stocks
to persistent factors [22], or transaction costs and market
microstructure [23] as causes of lagged autocorrelations.
Whether or not non-synchronous trading may constitute
a source of lead-lag relationships or not is an issue of on-
going discussion [17, 24, 25]. Recently, aiming at a closer
empirical understanding of lagged correlations, the de-

2

pendence of the strength of lagged correlations on the
chosen time-shift τ has been analyzed for high-frequency
It was shown, that the lagged corre-
NYSE data [26].
lation function typically exhibits an asymmetric peak.
The revealed patterns basically showed structures con-
sistent with those found in [17] (e.g. patterns where
more ’important’ companies pull smaller, less ’important’
ones). Interestingly, also evidence for a diminution of the
Epps eﬀect [27] has been demonstrated based on lagged
cross-correlations of NYSE-data, as lead-lag dependen-
cies seem to diminish over the years [28].

As diverse,

interesting and as on-going these ap-
proaches are, the methods applied are mainly based
on Granger causality, vector autoregressive models and
shrinkage estimators. In this paper, we want to extend
the methodology to eigenvalue analysis of time-lagged
correlations. First, we discuss how solutions of RMT
problems pertaining to real, asymmetric matrices can be
obtained from solutions to the symmetrized problem via
an inverse Abel-transform. The respective developments
will then enable us to derive the form of the eigenvalue
spectra of the pure random case. As an immediate ap-
plication we compare these theoretical results, with real
ﬁnancial data and relate the observed deviations to mar-
ket speciﬁc features.

The paper is organized as follows: In Section 2 we ﬁx
the notation and develop the spectral form of asymmetric
real random correlation matrices. In Section 3 we apply
the introduced methodology to empirical correlation ma-
trices of 5 min log-returns of the S&P500 and discuss the
meaning of deviant eigenvalues from several perspectives.
Time-dependence issues are discussed in Section 4 and in
Section 5 we ﬁnally conclude.

2. SPECTRA OF TIME-LAGGED
CORRELATION MATRICES

2.1. Notation

The entries in the N

T data matrices X for N assets
and T observation times, are the log-return time-series
of asset i at observation times t,

×

(2)

t = ln Si
ri

ln Si
t
−

1

,

t −
after subtraction of the mean and normalization to unit
2. Here,
variance, i.e. division by σi =
Si
t is the price of asset i at time t. One time unit is the
time diﬀerence between observations at t + 1 and t, e.g.
a day, 5 minutes; for tic data it can also be of variable
size. Time-lagged correlation functions of unit-variance
log-return series among stocks are deﬁned as

(ri
h
p

ri
ti

i − h

t)2

Cij

τ (T )

(ri

≡ h

t − h

ri
ti

)(rj
t
−

rj
t
−

)
τ i
iT

τ − h

,

(3)

where the time-lag τ is measured in time units and
iT
stands for a time-average over the period T . We drop (T )

...
h

3

in the following, except for Section 4. Equal-time corre-
lations are obviously obtained for τ = 0. For τ
= 0, the
lagged correlation matrix Cτ is generally not symmetric
and contains the lagged autocorrelations in the diagonal.
It can be written as

Cτ =

1
T
δt,t+τ and where X is the N

XDτ XT

,

where Dτ ≡
T normalized
time-series data. Denoting the eigenvalues of Cij
τ by λi
and their associated eigenvectors by ~ui (or uik), where
i, k = 1, ..., N , we may write the eigenvalue problem as

×

the Poisson equation

ρ(x, y) =

φ(x, y)

.

(8)

1
4π △

−

Expanding the argument of the determinant in Eq. (6)

we obtain the positive deﬁnite matrix

|

+Cij

x(Cij

τ Cji

τ +Cji

τ −

z
Hij = δij |
This form shows that any symmetric (anti-symmetric)
contribution of Cij
τ only inﬂuences the real (imaginary)
part of z.

. (9)

τ −

τ )+iy(Cij

Cji
τ )

(4)

(5)

Cij

τ ~uj = λj~uj

.

j
X

×

We immediately recognize that eigenvalues λi are either
real or complex conjugate, since the matrix elements of
Cij
τ are real and thus the conjugate eigenvalue λ∗i also
solves Eq. (5). Regarding the elements of Cij
τ as random
variables with a certain distribution, we should keep in
mind that their speciﬁc construction, Eq. (4), results in a
departure from a ’purely’ random real asymmetric N
N
matrix where the entries are iid Gaussian distributed.
Thus we do – in general – not expect a ﬂat eigenvalue
distribution as in the Ginibre-Girko case. Rather, we
can interpret Cτ as a random real asymmetric matrix
with a special structure due to its construction. In gen-
eral, comparably little work has been done to understand
the eigenvalue spectra of such random real asymmetric
matrices. Unfortunately, powerful addition formalisms
developed for non-Hermitian random matrices (see e.g.
[29] and references therein) are not applicable in the case
of random real asymmetric matrices. However, it was
shown that the problem can be treated in a way for-
mally equivalent to classical electrostatics [10, 30] and a
generalization of Girko’s semicircular law [32] could be
recovered via application of the replica-technique.

2.2. General Arguments

We start our arguments from the electrostatic poten-
tial analogy, originally introduced by Wigner. The idea
is to interpret the distribution of eigenvalues in the com-
plex plane as a distribution of electrical charges in 2 di-
mensions. Following the same arguments as in [30], the
corresponding potential in 2 dimensions is given by

φ(x, y) =

ln det

(δij z∗

1
N h

−

where z = x + iy, and
distribution,

Cji

τ )(δijz

Cij
τ )

−

−

,

ic
(cid:1)

(6)
(cid:0)
ic denotes the average over the
...
h

P (X)

exp

∼

N
2

−

(cid:18)

Tr(XT

,

)
(cid:19)

(7)

of the matrices Xij . It can be shown [30] that Eq. (6)
allows for the calculation of a density ρ(z) = ρ(x, y) via

If there is no structural diﬀerence in the randomness
of the symmetric and the anti-symmetric part of matrix
Cτ , the expression of Eq.
(9) is equivalent under ex-
change of x and y in the distribution sense, and Eq. (8)
will thus be a symmetric function in x and y. Since we
do not expect any direction in the complex plane being
, we
distinguished from any other in the limit N
conceive that the eigenvalue density resulting from (6) is
a radial symmetric function, i.e.,

→ ∞

ρ(x, y) = ρ(r)

z
dzρ(z) δ(
|

| −

r)

.

(10)

1
2πr

≡

ZS

A more formal argument can be given via expanding the
matrix Hij entering the potential φ [31]. Since the entries
in Cij are typically smaller than one, Hij can be written
(A + ǫB). Here, ǫ is a small perturbation,
as Hij ≈ |
z
|
Cji)+i¯y(Cij +Cji)
¯x(Cij
A = δij and B = CijCji/
|−
with ¯x = x/
= 1 without
. We ﬁx
z
|
|
loss of generality and write the determinant as a Taylor
series,

and ¯y = y/

z
|

z
|

z
|

−

|

|

φ(x, y) =

ln det(Hij)

−

1
N h
1
N h

≈ −

Tr(B)

−

ic =
B2
2

Tr(

1
N h

−

Tr ln(Hij)

ic

) + Tr(

B3
3

)

− · · · ic

.

(11)

→ ∞

Based on this series, we checked up to fourth order
that this expansion indeed only leads to terms in r for
N
; we outline some aspects of the calculation in
Appendix A. We note that yet a diﬀerent and probably
even more powerful way of proving our conjecture would
be to replace the determinant in Eq. (6) by Gaussian
integrals and use the replica method to average over the
distribution of the Cij .

S

If ρ(r) is circular symmetric, the support

of the
eigenvalue-spectrum will be bounded by a circle and is
thus deﬁnable via a maximal radius rmax. Since rmax is
governed by the standard deviation of the underlying ran-
dom matrix elements, one can compute the extent of the
support of Cτ by considering the support of symmetric
(rS
max). Let these be
deﬁned by CS
2 (Cτ −
T ).
τ ≡
If we assume that the standard deviations of the sym-
metric and anti-symmetric matrices are equal, σS = σA,

max) and anti-symmetric matrices (rA
T ) and CA

2 (Cτ + Cτ

τ ≡

Cτ

1

1

6
(a)

0.2

0.1

)
λ
(
m

I

0

−0.1

0.5

(c)

)
λ
(
m

I

0

2

1

0

3

2

1

0

)
λ
(
m

I

−1

−2
−2

)
λ
(
m

I

−1

−2

−3

Q=100

(b)

−0.2

−0.2

−0.1

0
Re(λ)

0.1

0.2

−0.1

0
Re(λ), Im(λ)

0.1

0.2

Q=10

(d)

−0.5

−0.5

0
Re(λ)

0.5

0
Re(λ), Im(λ)

(e)

Q=1

0.15

(f)

−1

0
Re(λ)

1

2

−1

0
Re(λ)/Im(λ)

1

(g)

Q=0.5

0.07

0.06

0.05

0.03

0.02

0.01

0.04

y

)
λ
(

ρ
 
,
)
λ
(

ρ

x

0

 
−0.2

0.06

0.05

0.04

0.03

0.02

0.01

)
λ
(

ρ
 
,
)
λ
(

ρ

y

x

0

 
−0.5

)
λ
(

ρ
 
,
)
λ
(

ρ

y

x

0.1

0.05

0
 
−2

0.04

(h)

)
λ
(

ρ
 
,
)
λ
(

ρ

y

x

0.03

0.02

0.01

0
 
−3

−2

0
Re(λ)

2

−2

−1

0
Re(λ), Im(λ)

1

2

3

FIG. 1: Complex eigenvalue spectra of time-lagged correla-
tion matrices, obtained from random matrices X. The entries
of X are iid and Gaussian with unit variance. In (a), (c), (e)
and (g) the position of the eigenvalues is shown in the complex
plane for values of Q ≡ T
N = 100, 10, 1 and 0.5, respectively.
The visibly enhanced density along the real axis is the ﬁnite-
size eﬀect mentioned in the text. The right column shows
the projections of the EVs onto the real and imaginary axis.
The solid lines are the theoretically expected curves, which
are numerical solutions to Eq.
(18). Note in (h) that for
this projection, the eigenvalue spectra is composed of diﬀer-
ent solutions to Eq. (18) as G(z) itself has a discontinuity.
The divergence at z = 0 is not shown for analytical curves
associated with Q = 100, 10 and 0.5.

this implies that the standard deviation σ of the matrix
τ , will be σ = √2σS/2. Thus, the support of Cτ can
Cij
be deﬁned via a disc with radius

rSmax =

rS
max =

rA
max

(12)

1
√2

1
√2

The argument here is that the eigenvalue-density can be
regarded as a log-gas [33] which has only one degree of

 

 

Re(λ)
Im(λ)

Re(λ)
Im(λ)

0.5

 

Re(λ)
Im(λ)

2

 

Re(λ)
Im(λ)

4

freedom for CS
Cτ , hence leading to σ = √2σS/2 instead of √2σS.

τ , but two degrees of freedom for

τ and CA

Based on these relations and regarding the discussion
of Eq. (9), it is sensible to conjecture that the projections
of ρ(r) onto the x-axis, denoted by ρx(λ), and the projec-
tion onto the y-axis, ρy(λ), are nothing but the rescaled
spectra of the solution to the symmetric, ρS(λ), and to
the anti-symmetric problem, ρA(y). To be more explicit,

ρx(λ)

ρ(Re(λ)) =

ρ(r)dy = ρS(√2x)

ρy(λ)

ρ(Im(λ)) =

ρ(r)dx = ρA(√2y)

≡

≡

ZS

ZS

,

(13)

in the
where the integration extends over the support
complex plane. Although this conjecture might seem
quite natural we shall provide numerical evidence for its
correctness below.

S

First, we note that the eigenvalue density of the sym-
metric problem can be obtained from the well-known re-
lation

1
π

lim
0
ǫ
→

(cid:2)

n
X

ρS(x) =

δ(x

xn) =

−

Im(GS(x

iǫ))

.

−

(14)
For a radial symmetric problem, of course, ρS
ρA. The
main idea of this work is now to note that one can use
the following technique to actually determine the radial
symmetric density ρ(r):

∼

(cid:3)

Since the rescaled eigenvalue density of the sym-
metrized problem ρS(√2x) is nothing but the projection
of ρ(r) onto the real axis, Eq. (13), it can be written as
the Abel-transform [34],

ρS(√2x) = 2

dr

,

(15)

∞

ρ(r)r

x
Z

√r2

x2

−

of the radial density ρ(r). One can then reconstruct the
desired eigenvalue spectrum exactly (in the limit N

→
) via the inverse Abel-transform, and thus via the cuts

∞
of the Greens function of the symmetric problem,

ρ(r) =

1
π

−

r
Z

∞

d
dx limǫ

0

→

Im(GS
√x2
(cid:2)

τ (√2x
r2

−

iǫ))

−

dx .

(cid:3)

(16)
Here, we have made use of Eq. (14). Since Eq. (16) can
be problematic if evaluated numerically, we also specify
a form which exploits the Fourier-Hankel-Abel cycle [34]

∞

0
Z

ρ(r) = 2π

qJ0(2πrq)

∞

ρS(x)e−

2πixqdx dq

,

Z

−∞

(17)
where J0(x) denotes the zeroth-order Besselfunction.
We also note, that yet another method of determining
ρ(r) is the evaluation of the inverse Radon-transform of
ρS(√2x).

→ ∞

Equation (16) applies for any radial symmetric eigen-
value density in the limit N
and allows for a cal-
culation of the eigenvalue density in the complex plane
via a method of exact reconstruction based on the eigen-
value density of the symmetrized (or anti-symmetrized)
problem. Typically, the solution of the symmetric prob-
limit. Thus, al-
lem will be valid only in the N
though the Abel-inversion gives an exact result, discrep-
ancies may occur because of ﬁnite-size eﬀects. Before
turning to the speciﬁc problem of lagged correlation ma-
trices we refer to Appendix B, where – as a speciﬁc and
prominent example – we show the almost trivial case of
deriving the density of real asymmetric random matrices
(without ’imposed structure’) [30] directly from Wigner’s
celebrated semicircle law.

→ ∞

2.3. Application to lagged correlation matrices

We now turn to our speciﬁc problem of determining
the eigenvalue density of Cτ . What is left is to conﬁrm
the validity of our conjecture, Eq. (13), and to show, that
– as a consequence – Eq. (16) gives an approximation to
the radial eigenvalue distribution, ρ(r). To start, we can
refer to existing literature on the symmetric problem: It
has been shown [15, 16], that the Greens function, G(z)
of the symmetric problem Cτ
τ )XT is
given by

X(Dτ + D
−

S = 1
2T

(18)

1

1

Q3 z2G4(z)
Q (z2
Q −

+2( 1

1)zG3(z)

2 1
Q2 ( 1
( 1
Q −
1)zG(z) + 2

−
−

Q −
1)2)G2(z)
1
Q = 0

−

,

−
T /N playing the role of a information-to-noise
with Q
ratio. Note, that this equation is independent of a speciﬁc
value for τ and is valid for any value of it [16].

≡

We note, that – in a calculation analogous to the one in
[16] – it is easy to show that the Greens function pertain-
ing to the asymmetric problem follows exactly the same
equation, which reaﬃrms circular symmetry. Based on
Eq. (18) one can calculate ρx(λ) by using Eqs. (14) and
(13).

Figure 1 shows (simulated) spectra of Cτ =1 as deﬁned
by Eq. (4) with iid entries in the columns of X, for var-
ious values of Q. Note, that for Q < 1 the shape of the
boundary of eigenvalues in the complex plane changes
[35] for a discus-
from a disk to an annulus (see e.g.
sion of disc-annulus phase transition in the case of non-
hermitian matrix models). We immediately recognize
that eigenvalues are enhanced along the real axis and
that, as a consequence, the density is lower in the vicin-
ity of the real axis. This can be attributed to a well-
known ﬁnite-size eﬀect, already discussed in [10, 30]. Of
course, this eﬀect implies that circular symmetry is not
fully fulﬁlled for ﬁnite matrices of the GinOE. Thus, we
also expect to observe some discrepancies between the
theoretical results based on the Abel-transform and the
empirical densities of ﬁnite, lagged correlation matrices
based on random data.

5

Im(λ)≈0
Re(λ)≈0
Im(λ)≈Re(λ)

)
r
(
ρ

0.05

0.04

0.03

0.02

0.01

0
 
0

0.03

0.025

0.02

)
r
(
ρ

0.015

0.01

0.005

0
 
0

)
r
(
ρ

0.25

0.2

0.15

0.1

0.05

0
 
0

 

 

 

(a)

(b)

(c)

0.02

0.04

0.08

0.1

0.12

0.06
r

Im(λ)≈0
Re(λ)≈0
Im(λ)≈Re(λ)

0.1

0.2

0.4

0.5

0.6

Im(λ)≈0
Re(λ)≈0
Im(λ)≈Re(λ)

0.3
r

0.06

0.04

0.02

0

0.5

1

1.5

r

0.5

1.5

2

1
r

FIG. 2: Radial eigenvalue densities approximated via simula-
tions along diﬀerent directions (real axis, imaginary axis and
the diagonal in the complex plane. Numerical data for ﬁnite
matrices is compared with the solution of the inverse Abel-
transform. (a) Q=100 (b) Q=10 (c) Q=1; the inset shows a
detail of the curve.

In our concrete case, the prediction of the projections
ρx and ρy (blue lines, obtained from Eq. (14) and Eq.
(18)) depicted in the right column of Figure 1 is in good
agreement with the numerical data for the real parts of
the eigenvalues (ρx). For the projection of the complex
parts (ρy) we recognize that there is a slight deviation
from the prediction (due to the enhanced density along
the real axis). We also checked projections with data ob-
tained via rotating all the individual eigenvalues in the

complex plane for diﬀerent angles. Apart from some mi-
nor eﬀects attributable to the inhomogenity around the
real axis we found no signiﬁcant discrepancies. We also
note that the simulated data did not show any signiﬁcant
discrepancies when taking diﬀerent values of τ which is
again in agreement with the theoretical anticipation.

Turning towards the point of reconstructing the ra-
dial eigenvalue density, the function to be transformed
(ρS(√2x) or ρA(√2y)) may be evaluated exactly (with
some eﬀort) for the symmetric case from Eq. (14) and
Eq. (18). The remaining integral Eq. (16) will, however,
be hard to solve in general. Nonetheless, we are able to
solve the case Q = 1 analytically and obtain the exact
formula for the eigenvalue density,

ρQ=1(r) =

1
K

−

23/43rΓ
(cid:20)
21/4Γ

−

(cid:18)

5
4

Γ

5
4

Φ1
2

(cid:19)

Γ

(cid:18)
1
4

(cid:18)
7
4

(cid:19)
Φ1
2

(cid:19)

(cid:18)

(cid:19)

(cid:18)

,

1
4
(cid:18)
1
4

−

,

,

,

5
4
3
4

,

3
2
1
2

,

λ2
2
λ2
2

(cid:19)

,

(cid:19)(cid:21)

(19)

≡

6√π5r3. Here, Γ(x) denotes the Gamma func-
with K
tion and Φ1
2(a, b, c, z) the hypergeometric function; the
derivation is brieﬂy summarized in Appendix C. Note
that limQ
we ex-
pect the Greens function and the eigenvalue density to
converge to those of a random real asymmetric matrix
without speciﬁc structure, i.e. a ﬂat eigenvalue-density
in the sense of [30].

z , whereas for Q

Q(z) = 1

→ ∞

0 GS

→

We were not able to derive closed expressions for other
values of Q, since already the solution of Eq. (18) results
in lengthy expressions. In these cases we computed the
integral Eq. (16) numerically. The results are depicted
in Figure 2 for Q = 100, Q = 10 and Q = 1. The theoret-
ical predictions are accompanied by data obtained from
performing cuts along various directions of the spectra
ρ(x, y) from Fig. 1, namely along the x-axis, the y-axis
and along the diagonal direction, i.e. Re(λ) = Im(λ). We
performed these cuts numerically via calculating the den-
sity in narrow strips along the diﬀerent directions. The
theoretical prediction catches the diﬀerent experimental
densities very well. Especially for Q = 100 and Q = 1 re-
sults are consistent with the predictions to a high degree.
For Q = 10 we observe some discrepancies for values
r < 0.1. We think that these are very probably asso-
ciated with the ﬁnite-size eﬀect of enhanced eigenvalue
density along the real axis discussed above. Actually, a
closer investigation of this eﬀect and a comparison with
the solution found in [11] would be interesting to do but
remains outside the scope of the present work.

3. EMPIRICAL ANALYSIS

With a theoretical concept of, and some speciﬁc knowl-
edge about, the eigenvalue-spectra of time-lagged corre-
lation matrices, we now turn to actual ﬁnancial data and
study empirical lagged correlation matrices Cτ .

6

3.1. Data

We analyze 5 min data of the S&P500 in the time pe-
riod of Jan 2 2002 – Apr 20 2004. The time-series were
cleaned, corrected for splits and synchronized.
In par-
ticular, days where trading took only place in ’limited’
form (’half-days’ etc.) have been removed (this includes
the dates Sep 11 2002, Dec 26 2003, Jan 19 2004, Feb
16 2004). Additionally, all assets in which more that
1.5% of data were missing and/or assets which were not
quoted over the full time-frame have been removed. Af-
ter cleaning, the data set X consisted of N = 400 time-
series at T = 44720 observation times each. The em-
pirical time-series and its distribution-functions showed
the usual ’stylized facts’ of high-frequency stock-returns
(fat-tails, clustered volatility, etc.). Of course, also the
well-known structure of correlation matrix element dis-
tribution at equal times was found to be present in the
data (not shown). For the remainder of the paper, we
ﬁx τ = 1, i.e. a ﬁve minute shift, and T = 44720, if not
stated otherwise. From X we construct two surrogate
data sets, one by removing the market mode, the other
by a scrambling of data. As τ = 1 remains unchanged
during the rest of the paper, we will occasionally drop
the subscript, C1 = C.

3.1.1. Market mode removed data

It is well known that the spectrum of equal-time cor-
relations is dominated by a single very large eigenvalue
which can be attributed to the so-called ’market-mode’,
[5, 7, 37]. Removing the ’market mode’ is
see e.g.
thus approximately equivalent to removing the move-
ment of the ’index’ of a given universe from the individ-
ual assets. We deﬁne the market return (the index) by
rm
t , where v1j is the eigenvector associated
t =
with the largest eigenvalue ˜λ1 of the empirical covariance
matrix at equal times, i.e. τ = 0. To remove this market
mode from the data we simply regress in the spirit of the
CAPM

j=1 v1jrj

P

N

t = αi + βirm
ri

t + ǫi
t

,

(20)

where the residuals ǫi
t carry what is left of the structural
information in the data; we denote this data set by Xres,
its elements being X res
it = ǫi
t.

3.1.2. Scrambled data

A scrambled version Xscr is generated by a random
permutation of all elements of X. This destroys all corre-
lation structure but has exactly the same distributions as
the original data. Correlation matrices from Xscr should
– up to potential non-Gaussian eﬀects in the distribu-
tions – correspond to the developments in Section 2. We

0
10

T=4×104

T=4000

j
i

)

C
P

(

−2

10

j
i

)

C
P

(

−4

10

−2

10

)

s
e
jr
i
C
P

(

−4

10

−0.2

−0.1

0

0.2

0.3

0.4

0
10

T=4×104

0.1
C
ij

) T=4000
s
e
jr
i
C
P

(

−0.2

0.2

0
C
ij

(a)

(b)

−0.2

0.2

0
res
C
ij

−0.2

−0.1

0

0.2

0.3

0.4

0.1
res
C
ij

FIG. 3: (a) Empirical distribution P (Cij) of the lagged corre-
lation matrix elements Cij for a sampling period of T = 40000
and T = 4000 (inset). Circles represent empirical data, red
squares the situation for scrambled data from Xscr. (b) shows
the same for the removed market case, i.e. from Xres. Indi-
vidual frequencies are normalized by the summed frequencies
for each plot.

checked that the support of the eigenvalue-spectra per-
taining to the lagged correlation matrices – which will be
the quantity used for identifying deviating eigenvalues –
indeed resembles the value rmax of the Gaussian case dis-
cussed in Section 2. A treatment of the exact spectra of
lagged correlation matrices of random Levy distributed
data (see e.g. [16, 38, 39] for the case of equal-time covari-
ance matrices) is beyond the scope of the present work.

3.2. Empirical time-lagged ﬁnancial random
matrices

In Fig. 3 we show the distribution of matrix elements
P (Cij
1 ) (circles) of the empirical correlation matrix C1,
based on X (a), and Xres (b). Squares show the results
for the scrambled data Cscr
1 . The inset shows the result
for a shorter sampling time of T = 4000. Clearly, there
is ’signiﬁcant’ correlation in the data in both cases, con-
trasting the Gaussian prediction of the eﬃcient market
hypothesis. The eﬀect of varying the time-diﬀerence as-
pect of lagged correlations has been carefully studied in

7

[26], and we shall not discuss this issue here. However
we point out, that – as expected – the lagged correla-
tions at τ = 1 were larger than for values of τ > 1, which
is fully conforming with the ﬁndings of [26]. We also
mention that we see that correlations typically decrease
with decreasing observation frequency (comparing 5 min
data with hourly returns), but still remain well above the
scrambled case (not shown).

The situation for the market removed data Xres, (Fig.
3 (b), shows that lagged correlations are not distributed
according to the eﬃcient market hypothesis as well. The
frequency of higher values of Cij
1 is slightly reduced and
the curve has signiﬁcantly changed shape. In the semilog-
arithmic plot of Fig. 3, the positive regime is clearly not
following a square-polynomial curvature, but rather an
exponential one. This also applies to the data sampled
from T = 4000 subperiods, depicted in the inset of Fig.
3. Both empirical distribution functions also exhibit clear
non-random negative autocorrelations which are the pre-
dominant source of the non-Gaussian tails for negative
entries.

3.2.1. Eigenvalue spectra

≈

We now proceed to the analysis of empirical eigenvalue
spectra of the ﬁnancial data. Figure 4 (a)-(c) shows the
eigenvalue spectrum obtained from C at various stages.
In Fig.
4 (a) a few very strong deviations from the
bulk of the eigenvalues are seen, most signiﬁcantly one
real eigenvalue λ1
4.6 and a conjugate pair of com-
plex eigenvalues. Fig. 4 (b) is a detail of (a) where a
clear shift of the bulk of the eigenvalues with respect
to the Gaussian regime (circle) is observed. This shift
can be attributed to two eﬀects: First, each deviating
positive real eigenvalue ˜λi is associated with a shift s
Re(˜λi)/N in direction
of the ’bulk’ spectrum of s
≈ −
of the negative real axis.
(’Departing’ eigenvalues are
those which have real parts larger than the radius of the
theoretical support.) The shift of the ’disc’ pertaining
to this eﬀect is then the sum of all eﬀects from depart-
1
ing eigenvalues, stot =
0.031. A
N
second contribution of the shift is due to the non-zero
diagonal entries of the correlation matrices C1. The
shift of the center of the disk explainable by the mean
of the diagonal elements is ¯Cii
0.029, such that
the overall displacement is d = stot + ¯Cii =
0.060.
When corrected for the total shift we arrive at Fig. 4
(c). We repeated the same procedure for Cres
1 , getting
dres = stot + ¯Cii =
0.061 = 0.081; the resulting
0.020
−
displacement corrected distribution is depicted in Fig. 4
(d). The shift of the center of the support is thus quite
simply explained.

˜λi Re(˜λi)

1 =

≈ −

P

−

−

−

−

The eigenvalues lying outside the random regime
should now be clearly associated with speciﬁc non-
random structures which will be examined below. For

0

1

3

4

5

2
Re(λ)

−0.2

0

0.2

0.6

0.8

1

−0.4 −0.2

0

0.4
Re(λ)

0.4
0.2
Re(λ),Im(λ)

0.6

0.8

1

0

)
λ
(
m

I

−1
−1

0.2

)
λ
(
m

I

0

−0.2

)
λ
(
m

I

)

s
e
r
λ
(
m

I

0.2

0

−0.2

0.2

0

−0.2

−0.2

0

0.2

0.6

0.8

1

0.4
Re(λ)

−1

−0.5

0.5

1

1.5

0

Re(λres)

FIG. 4: Eigenvalue spectra of lagged correlation matrices from
5 min S&P500 data. (a) shows the full spectrum with one very
large deviation on the real axis (λ1 ∼ 4.6), and a large depart-
ing eigenvalue pair λ2 = λ∗
3. (b) is a detail, clearly showing
that the spectrum is shifted with respect to the ’bulk-disc’.
(c) spectrum corrected for displacement d as discussed in the
text. (d) is the eigenvalue spectrum based on the market re-
moved data, Xres
, also after displacement correction. The
circles in plots (b)–(d) indicate the theoretical support dis-
cussed in Section 2.

the eigenvalues within the circle – i.e. for the eigenvalues
within the regime of Gaussian randomness – the natu-
ral expectation would be that these follow the Gaussian
predictions developed in Section 2.

In Fig. 5 we compare predictions from Section 2 with
the empirical data , showing projections of empirical
eigenvalue data onto the real and imaginary axis. The
inset shows the theoretical prediction of the radial den-
sity integrated over the complex plane, 2rπρ(r), com-
). We chose a ’ac-
λ
pared with the empirical data, ρ(
|
|
cumulated’ representation since data quality would be
unsatisfying otherwise. The empirical spectra are trun-
cated at Re(λ) = 1. Given the modest eigenvalue statis-

(a)

(b)

(c)

(d)

8

)
r
(
ρ
π
r
2

0.08

0.06

0.04

0.02

0

0

0.5
r

1

theory
Re(λ)
Im(λ)

0.15

0.1

0.05

)
λ
(

ρ
,
)
λ
(

ρ

y

x

0

FIG. 5: Projection of the empirical spectrum pertaining to
Fig. 4c on the real and imaginary axis. The blue line is the
analytical solution discussed in Section 2. The inset shows the
empirical distribution of ρ(|λ|) compared with the analytical
analogue 2rπρ(r).

tics (Nλ = 400) and the strong deviations outside the
theoretical support, the agreement between the theoreti-
cal predictions for Gaussian noise and the empirical data
seems rather satisfying.

3.2.2.

Interpretation of deviating eigenvalues

Strong deviations from the theoretical pure random
prediction indicate signiﬁcant correlation structure in the
data.
It is intuitively clear that eigenvalues departing
positively (negatively) on the real axis with no or only
a small imaginary part will be the eﬀect of symmetric
(anti-) correlations. On the other hand, complex conju-
gate eigenvalues departing on the imaginary axis will be
attributable to asymmetric, non-Gaussian correlations.

Thus, the departures of the largest eigenvalue in Fig.
4 (a) and (c) should be caused by a lagged correlation
structure either pertaining to a group of stocks or to all
of the stocks. On the other hand, we also see signiﬁcant
non-symmetric correlations in X reﬂected in complex-
conjugate pairs of eigenvalues with relatively large imag-
inary parts. The residuals Xres show a large negative
real eigenvalue indicating approximately symmetric anti-
correlations between stocks. Such a departure is not vis-
ible for X.

For a closer inspection of which assets ’participate’ in
a given eigenvector belonging to a deviating eigenvalue,
one usually deﬁnes the inverse participation ratio for the
eigenvectors ~ui,

IPR(~ui)

N

≡

Xℓ=1

4

uiℓ|
|

.

(21)

0.02

(a)

)

k

i

u
(
R
P

I

0.01

0.015

)

k

i

u
(
R
P

I

0.005

)

s
e
r

k

i

0.025

u
(
R
P

I

0.02

0.015

0.01

0.005

0

0.01

0

0.2

0.4

|λ
|
i

0

1

4

5

2

3

|λ
|
i

(b)

0.04

0.035

0.03

)

s
e
r

k

i

u
(
R
P

I

0.01

0

0.1

0.2

res|
|λ
i

0.5

1.5

2

1
res|
|λ
i

FIG. 6: (a) Inverse participation ratio as deﬁned in Eq. (21)
as a function of the absolute value of λi. Circles represent
data from the empirical matrix, squares (inset) data from a
random analogue, obtained from iid gaussian distributed X.
(b) The same as above but for eigenvectors obtained from the
data with the market mode subtracted out.

This ratio shows to which extent each of the N = 400
assets contribute to the eigenvector ~ui. While a low IPR
means that assets contribute equally, a large IPR signals
that only a few assets dominate the eigenvector.

Figure 6 (a) shows the IPRs for the empirical correla-
tion matrix C1. The inset is a detail and also exhibits
the IPRs from scrambled data (squares). It appears, that
the ’random’ regime is not conﬁned to an approximately
constant region of IPRs but varies quite widely. This is in
contrast to the symmetric case where one has a constant
IPR for eigenvalues stemming from Gaussian random-
ness. We checked that the ﬂuctuations observed here are
already present in the Ginibre ensemble of real random
asymmetric matrices and are thus not associated to the
speciﬁc structure of Cτ . It is clear, that the IPRs be-
longing to the random case not being bound to a line
hinders the identiﬁcation of the eigenvectors with strong
inﬂuence of only a few components to a certain extent.
However, one can nonetheless see that the largest depart-
ing eigenvalue λ1 is characterized by a rather small IPR,
indicating an inﬂuence of a large number of assets. In
contrast, some other deviant eigenvalues lie well above

9

Sector

GICS No. of Stocks Ns

Energy
Materials
Industrials
Consumer Discretionary
Consumer Staples
Healthcare
Financials
Information Technology
Telecommunication
Utilities

10
15
20
25
30
35
40
45
50
55

22
27
44
63
35
40
71
63
11
24

TABLE I: Global Industry Classiﬁcation Standard (GICS
code), for the 10 main sectors of the S&P500 with the number
of stocks in these sectors, see www.standardandpoors.com.

the random regime indicating the inﬂuence of only few
stocks.

Again, we compare with the situation found for the
residuals Xres which is given in Fig. 6 (b). On average,
the IPRs of the deviating eigenvalues are larger than in
(a), indicating a more clustered structure. We further
analyzed and IPR-like quantity only based on the imag-
ℓ=1 Im(uiℓ)4, and found
inary parts, IPR(Im(~ui)) =
pure random behavior, except for λ2 = λ∗3 (not shown).
With evidence at hand for some group structure in the
lagged-correlations, we now take a closer look at these
structures.

P

N

3.2.3. Sector organization in time-lagged data

It is well known from RMT applications to covariance
matrices (τ = 0) of ﬁnancial data, that the eigenvectors
~ui of large eigenvalues can be associated with the sector
organization of markets. Let us label the diﬀerent sectors
with s, and deﬁne

∆sk =

(cid:26)

1 if stock k belongs to sector s
0 otherwise

.

(22)

To visualize the inﬂuence of each sector s to a given eigen-
vector i, we calculate

Isi ≡

1
Ns

N

Xk=1

2

∆sk|

uik|

,

(23)

where Ns is the number of stocks in the respective sec-
tor, s. We evaluate Eq. (23) for the S&P500, using the
standard sector classiﬁcation scheme, the so-called GICS
code, which is summarized in Table I. Figure 7 shows the
contributions of the sectors to a set of selected eigenval-
ues for the original (left column) and the market-mode
removed data (right column). In the case of the original
data, the information technology sector seems to play
a decisive role for the largest 3 eigenvalues, namely λ1

original

−3

x 10

market removed

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

λ
1

*
=λ
λ
3
2

λ
4

λ

10

0.02

0.015

0.01

0.005

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

0

−3

x 10

−3

x 10

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

8

6

4

2

0

4

3

2

1

0

0.02

0.015

0.01

0.005

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

0

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

6

5

4

3

2

1

0

0.01

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

0.008

0.006

0.004

0.002

0

0.02

0.015

0.01

0.005

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

0

−3

x 10

r
o
t
c
e
s
 
f
o
 
n
o
i
t
u
b
i
r
t
n
o
c

8

6

4

2

0

10

strong sectorial contribution (not shown).

For a quantitative discussion of the structure imposed
by the individual eigenvectors and eigenvalues we decom-
posed the (square) correlation matrices with respect to
individual eigenvalues,

Cλi = uijdiag(λi)u−
ij

1

,

(24)

where diag(λi) denotes a diagonal matrix with only one
entry at the respective position, associated with eigen-
In Fig. 8 (a) we display histograms of the
value λi.
elements of C1
λi in the same way as in Fig. (3). The
largest contribution to C1 is seen to originate from λ1,
and tails seem to follow a distinctive exponential distribu-
tion. Thus, the structure associated with λ1 is deﬁnitely
not Gaussian and exhibits speciﬁc (exponential) behavior
which is not visible in the distributions of the elements
of the full matrix C1. The complex pair λ2 = λ∗3 car-
ries predominantly negative correlations. The following
eigenvalues contribute much less. The ’humps’ in the
histograms, e.g. seen for λ2 = λ∗3 and λ4, indicate some
deterministic structure. In Fig. 8 (b) the same is shown
for the market removed data. The positive tails of the
distribution of the entries of C1
strongly deviate from
the Gaussian regime. This ’hump’ can be understood as
a consequence of strong correlations of sectors 10 and 55,
seen in Fig. 7. This eﬀect is also visible in a network vi-
sualization of the market removed matrix. We will now
proceed to such a network view to visualize and further
discuss the ﬁndings of strong sectorial contribution and
strongly anomalous distributions Cλi .

res
λ
1

res
λ
1

res
λ
2

res
λ
3

res
res=λ
λ
5
4

10 15 20 25 30 35 40 45 50 55

GICS code

10 15 20 25 30 35 40 45 50 55

GICS code

FIG. 7: Strength of participation, Isi, of the ten main sectors
of the S&P500 (according to the GICS code) to eigenvectors
~ui for some selected eigenvalues λi.

and λ2 = λ∗3. This sector thus explains a large part of
the most distinctive non-random (symmetric and asym-
metric) structure in C1. For other eigenvectors, as for
example λ4 and λ10 and others not shown here, a dis-
tinctive role is played by the energy and ﬁnancial sector,
respectively.

1

Results for Cres
(right column) also show remarkable de-
viations from the Gaussian eﬃcient market prediction
(equal contribution of the individual sectors). Here, the
largest eigenvalue λres
is associated with a strong partic-
ipation of the energy and utility sectors. In the second
eigenvector, the ﬁnancial sector is dominant, whereas the
eigenvalue associated with the strong negative departure
on the real axis, λ3
1, is not dominantly inﬂuenced
by any sector. For λ4 = λ∗5 we ﬁnd a strong inﬂuence
of the energy sector. Other eigenvectors also indicate a

≈ −

1

3.2.4. Lead-lag networks

Comparing eigenvalue spectra of the residuals with
those of the initial data (Figure 4), it is apparent that
the market mode has a clear inﬂuence on the deviations
and that the largest eigenvalue for the residuals is signif-
icantly reduced. As a matter of fact, one would expect
that removing the (equal-time) market-mode also elimi-
nates much of the correlations pertaining to small ﬁrms
driven by large companies or similar ’star-like’ structures
(i.e. any network structure where one stock leads or lags
many other stocks).
In Fig. 9 (a) we show a network
view of the C1 correlation matrix, where a link is drawn
for any Cij
1 > 0.09; (b) is the same after removal of the
market mode, and Cij res
> 0.033. Clearly, while in (a)
there is not much clustering (except maybe for the utility
sector), in the market removed scenario distinctive clus-
tering appears. As in the previous section, we identiﬁed
the nodes with the 10 most important sectors in the mar-
ket. Nodes are colored according to these sectors in Fig.
9 along the lines of the accompanying color scheme. The
identiﬁed clusters correspond very nicely with industry
sectors, as was found quite some time ago for τ = 0.

1

Returning to an analysis of the original data, we look
1 , Eq.

at networks derived from individual matrices Cλi

(a)

(b)

−0.2 −0.1

0

0.1

0.2

0.3

0.4

Cλ

i

λ
1
λ
2
λ
4
λ

10

res
λ
1
res
λ
2
res
λ
3
res
λ
4

0
10

−2

10

−4

10

0
10

−2

10

−4

10

i

)

λ
C
P

(

i

)

s
e
λ
r
C
P

(

−0.1

−0.05

0.05

0.1

0
res
Cλ

i

λi for several strongly
FIG. 8: Histograms of entries in C1
deviating eigenvalues, for original (a), and market-mode re-
moved data (b).

(24), to visualize some ’qualitative structure’ associated
with strongly deviant eigenvalues and thus associated to
the most ’orthogonal’ aspects of overall-deviations.

For the largest eigenvalue λ1, we investigate a few as-
sets from the Information Technology (IT) sector lead-
ing stocks of diﬀerent sectors (not shown) with positive
lagged correlations. The most pronounced hubs from IT
were found to be AMAT, BRCM, INTC, KLAC, LLTC,
MSFT, MXIM, NVLS, YHOO and XLNX. Quite simi-
larly, the most prominent features of the conjugate pair
λ2 = λ∗3 can be associated with a hub-like inﬂuence of
the IT sector – this time, however, with a negative lagged
correlation. Networks pertaining to λ4 and λ10 primarily
exhibited intersectorial ties of the Energy and Financial
sector, where we also observed hub-like anti-correlations
pointing from stocks of the Financial sector to the Energy
sector.

For the lagged correlation matrix of the residuals Xres,
shows a strong clustering of

the largest eigenvalue λres

1

11

1

Energy & Utility sector, which is shown in Fig. 9 (c). The
fact that practically no assets apart from the Energy and
Utilities sector are represented is fully conforming with
the top right panel of Fig. 7. The tight binding of these
sectors is also seen in Figs. 9 (c), and 8 (b). In the lat-
ter, the strong tail corresponding to positive correlations
of λres
seems to be a consequence of this binding. The
second largest eigenvalue, λres
2 , demonstrates organiza-
tion of the Financial sector where some stocks – namely
BAC (Bank of America), FITB (Fifth Third Bank) and
C (Citigroup Inc.) – dominate the others (not shown).
1
Closer inspection of the negative eigenvalue Re(λ3)
reveals, that it is mostly associated with time-lagged anti-
correlations between various sectors; eigenvalue λ4 = λ∗5
exhibits clustering of the Energy and the Consumer Sta-
ples sector.

≈ −

In general, the analysis of the residuals eﬀectively re-
veal secondary information not seen before, which is
mainly attributable to the sectorization of stocks.
In-
ferring from causes to eﬀects, this fact may explain in
investigated equal-time cross-
part or all of the well
correlations, see e.g.
[7] for a short description of an
adequate model. In contrast to the residuals, the origi-
nal data exhibits lots of hub-like interactions, where the
assets lagging the hubs do not seem to belong to a spe-
ciﬁc sector. The most pronounced leading hubs are stocks
from the IT sector which has apparently ’lead’ the mar-
ket within an observed time-period. As a side comment,
it does not seem to us that the associated leading stocks
were the ones with the highest market capitalization as
would be implied by the ﬁnding of [17].

4. TIME DEPENDENCE

C

In this section we discuss the time-dependence of the
correlation matrices. We can immediately use the pre-
diction of the support of the eigenvalue spectra in the
complex plane
to determine a minimum sampling pe-
riod T (or equivalently a minimum value of Q) at which
the estimated cross-correlations still exhibit non-random
structure. This is possible since we know that if eigenval-
ues are outside the support the data is non-random. Re-
ducing T too much one expects to arrive a very noisy esti-
mate of the lagged correlation matrix, which will manifest
itself in having no departing eigenvalues at all.

We calculate C1(Ti) for consecutive, non-overlapping
time periods Ti and ﬁnd that – very remarkably – down to
a information to noise ratio of Q
1.25, clear deviations
from the predicted support occur. This means that even
though noise is drastically increased for low values of Q,
non-random structures prevail even at short time-scales.
More speciﬁcally, we analyzed 11 correlation matrices
obtained from time slices of 4000 observations (Q=10),
and 89 matrices for 500 time points each. For each in-
dividual sub-period Tn, we compute lagged correlation
matrices C(Tn) for the raw data as well as on the matri-
ces resulting from the regression model, Cres(Tn). Figure

≈

(a)

(b)

(c)

12

Q=10

Im(λ
)=0
1
)≠0
Im(λ
1

Q=1.25

5

n

10

20

60

80

40

n

Q=10

5

n

10

Im(λres
1
Im(λres
1

)=0

)≠0

Q=1.25

25

5

0
0

)

1

λ
(
s
b
a

30

20

15

10

10

8

6

4

2

5

0

0

(a)

2

0
0

(b)

0

0

1

)

s
e
r
λ
(
s
b
a

20

60

80

40

n

FIG. 10:
(a) Time dependence of the largest eigenvalue of
C1(Tn) as a function of the period index n for T = 500
(main ﬁgure) and T = 4000 (inset). Values are plotted as
blue circles if the largest eigenvalue is located on the real axis
(Im(λmax
) = 0) and as red squares otherwise. (b) Same for
Cres
.
τ

n

also observe that the largest eigenvalues with non-zero
imaginary parts (red squares) mainly occur at low values
of abs(λn), whereas real eigenvalues occur at absolute
values. If the eigenvalue is real, the lead-lag network is
dominated by strong, approximately symmetric eﬀects;
for imaginary eigenvalues the network is dominated by
asymmetric correlations, i.e. anti-correlations may play
a distinctive part too. We ﬁnd that if an eigenvalue λ1
was real (i.e. marked by a blue circle in Fig. 10), the
analysis of the preceding sections always identiﬁed the
IT sector mainly contributing to ~u1 (for Q = 10). On
the other hand, if the largest eigenvalue was imaginary,
no unique interpretation appeared to be valid for all of
the sub-periods.

In Fig. 10 (b) we show the same for our continuing an-

FIG. 9: Network view of C1 (a). A Link was drawn for C ij
1 >
0.09. The situation for the regressed scenario is shown in (b)
with a threshold of C ij res
> 0.033. (c) Shows the correlation
network for stocks belonging to the largest eigenvalue in the
regressed data (for C ij λ1
> 0.13). Two sectors (Energy and
Utilities) are tightly bound together. All network pictures are
results from a Kamada-Kawai algorithm.

1

1

10 (a) shows a plot of the absolute value, abs(λn), of the
maximal eigenvalue found for each sub-period, indexed
by n. The dashed blue line corresponds to the predic-
tion of the support rmax. We immediately recognize that
for Q = 10, as well as for Q = 1.25 the largest eigen-
value lies signiﬁcantly above the noise regime. On the
other hand, the absolute value of the largest eigenvalue
is quite volatile and anti-persistent for Q = 1.25. We

tagonist Xres. Again, we observe abs(λn) being clearly
located above the random frontier for all sub-periods.
The movement of abs(λ1) is less volatile. Closer investi-
gation of the underlying eigenvalues for Q = 10 revealed
changing participation of the sectors (measured by the
quantity Isi as deﬁned in Eq. (23)). In eﬀect, for all of
the 11 sub-periods either the Energy (in periods 6-9) or
the Utilities sector (in periods 3, 5) appeared as primar-
ily contributing. In the rest of the periods, both of these
sectors were represented strongly in Isi.

The last question addressed in this analysis is about
the correlations of the lagged correlation matrices: Are
signiﬁcant lagged correlations only found a posteriori or
does the data indicate a possibility for a reasonable pre-
diction of future lead-lag structures? To this end we
calculate the correlation of matrix elements between the
lagged correlation matrices obtained from diﬀerent (non-
overlapping) observation periods Tn and Tm,

c(Tn, Tm) =
(Cij
τ (Tn)
h

− h

Cij

τ (Tn)

τ (Tm)

iij )(Cij
σTn σTm

Cij

τ (Tm)

iij )

iij

.

− h

(25)

Here, the average extends over all matrix-elements and
σTn denotes the standard deviation of matrix C1(Tn).
Figure 11 depicts the characteristics we obtained from
empirical data. While the expected band of correlation-
coeﬃcients would be bound by very small values (in the
order of 1/400), we ﬁnd extremely signiﬁcant correla-
tions, especially for the Q = 10 case. As expected,
the ’predictability’ of future weighted lead-lag matri-
ces is signiﬁcantly higher for lagged matrices calculated
over longer sub-periods. The inset of Figure 11 shows
cres(Tn, Tm), i.e.
the same quantity calculated for the
residual data. Overall correlations are lower in this case,
meaning nothing else than that the market-wide move-
ments exhibit predictable lead-lag structures. However,
note that for Q=10 the ﬂuctuations of abs(λn) depicted
in the inset of Fig. 10 are not mirrored by any speciﬁc
variation of c(T1, T1 + d) in Fig. 11.

Although the present analysis of time-dependence is
not comprehensive in every respect, we may state that
non-random structures prevail to quite low information-
to-noise ratios and that a signiﬁcant amount of lagged
correlation matrices is predictable for future periods.
However, shortening the length of the sub-periods results
in decreasing predictability.

5. CONCLUSION

We have applied random matrix theory to lagged cross-
correlation matrices and theoretically derived the eigen-
value spectra emanating from the respective real asym-
metric random matrices in dependence of the informa-
tion to noise ratio, Q. Speciﬁcally, we have shown that
– in the case of any eigenvalue ’gas’ satisfying circular

13

Q=1.25

Q=10

1

0.5

d
+
1

1

)

T

,

T
(

s
e
r

c

0
0

20

60

80

40
d

)

d
+
1

1

T

,

T
(
c

1

0.8

0.6

0.4

0.2

0

0

20

60

80

40

d

FIG. 11: Matrix element correlation c(T1, T1+d) as described
in Eq. (25) for various time lags d for the original data and
for the residuals Xres

.

symmetry – an inverse Abel-transform can be used to re-
construct the radial density, ρ(r), from rescaled projec-
tions available via solutions of the symmetrized problem.
Based on these theoretical results, we analyzed empirical
cross-correlations of 5 min returns of the S&P500. For
the full time-period observed, we found remarkable devi-
ations from the prediction of the eﬃcient market hypoth-
esis and discussed various structural properties of these
deviations. We found the largest eigenvalue being as-
sociated with a sub-matrix of exponentially distributed
entries. This eigenvalue was associated with a strong
hub-like leading inﬂuence of the IT sector. Analyzing
data based on the residuals of a regression to common
movements, we found that cluster structure in the lead-
lag network is strongly enhanced. Looking at lagged cor-
relation matrices pertaining to sub-periods of the overall
investigation period we found that deviations from the
theoretical prediction do occur at quite low information
to noise ratios. We also found that signiﬁcant parts of
the lagged correlation matrix should be predictable via
measurements of past (non-overlapping) periods.

We think that the current work can be extended in
various directions. On the theoretical side, a closer in-
vestigation of the nature ﬁnite-size eﬀects in the ensemble
of time-lagged correlation matrices and comparison with
the exact ﬁnite-size result of the random real asymmetric
case [11] would be tempting. Finite-size eﬀects could also
be inferred from the terms which were found to vanish
in the N
limit in Appendix A. We also think that
some work is needed in an exact understanding of the re-
lation between the eigenvalue spectra (including the left
and right eigenvectors of the ensemble discussed here)
and the singular value decomposition of related problems
[36]. Also a rigorous study of a ’cleaning procedure’ along
the lines of methods already worked out for equal-time

→ ∞

ﬁnancial covariance matrices could be pursued as well.

Finally we believe that the presented work – in general
– should allow for an eigenvalue-dependent, systematic
study of the inﬂuence of matrices and their interplay with
equal time-correlations between ﬁnancial assets in con-
crete models. The fact that cluster structure conforming
with market sectors can be found in lagged correlation
matrices already indicates the direction of ﬁndings to be
expected from such work.

Acknowledgements

We thank J.D. Farmer for encouraging discussions on
the matter and Jean-Phillipe Bouchaud for various very
useful suggestions, especially for pointing out Eq. (11) to
C.B., who further acknowledges useful information from
M. Biely. Data is by courtesy of red-stars.com data AG,
the paper was sponsored in part by the Austrian Science
Fund under FWF project P17621-G05.

Appendix A

Based on the series expansion (11) of the potential φ,
we have calculated the ﬁrst four terms in the series. For
the ﬁrst term, one easily obtains

1
N h

lim
N
→∞

Tr(B)

ic = lim

N

→∞

1
N

Cij Cji
Tr(
h

ic) =

1
Q

.

(26)
since all other terms vanish as Tr(C) gives just N times
the averages of the autocorrelation of the assumed iid
white noise process. For calculating the second term, it
is useful to remember Tr(AB) = Tr(BA) and Tr(CC) =
Tr(CT CT ) as well as taking into account that odd powers
of C vanish. One then arrives at

1
N h

lim
N
→∞

Tr(B2)

1
N

N

ic = lim

(Cij Cji)2
(Tr(
h
→∞
+ (x2 + y2)Tr(
2Cij Cji
h
y2)Tr(
+ (x2
2Cij Cij
h

ic)
ic))

−

ic)

.

(27)

This structure is also typical for higher order terms (not
shown for brevity). The trace in the ’dangerous’ term
proportional to x2
y2 is nothing else than N times the
variance of autocorrelations which is just 1/T for a Gaus-
sian process. Thus, in total, the term vanishes as 1/T in
the limit N

with Q = const., and one gets

−

→ ∞
1
N

lim
N
→∞

(B2)
Tr
h

ic = K + 2rQ−

1

.

(28)

In very similar calculations, it is easy (but tedious), to
check that

1
N h

Tr(B3)
i

= f (r)

and

= g(r)

.

(29)

1
N h

Tr(B4)
i

14

The typical situation for higher order terms is similar to
the one for the second order term, i.e. the terms in r gen-
erally depend on some function of Q and the ’dangerous’
terms (like (x2
y2)2) vanish since they remain constant
for growing matrix size and are thus neutralized by the
prefactor 1/N . We do not expect any diﬀerent behavior
for terms higher than fourth order.

−

Appendix B

The uniform eigenvalue distribution of real asymmetric
matrices in the complex plane
found in [30] can be
almost trivially recovered from Wigner’s semicircle law
of real symmetric matrices via application of the inverse
Abel-transform. Starting from Wigner’s semicircle law
ρ(¯λ) = 1
¯λ2 and after proper rescaling ρx(λ) =
2π
√4
2λ2 we may insert into Eq. (16) and arrive at
p

1
√2π

−

C

4

−

ρ(λ) =

1
π2

√2

λ

r
Z

√2

λ2

y2

−

=

1
√2π2

arctan

p
√2
√λ2

−
−

 

dλ

√2

λ2

−
λ2
r2 ! (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

r

We immediately arrive at the result of an uniform eigen-
value distribution,

(30)

=

1
2π

.

ρ(r) =

(

1
2π 0 < r < √2
elsewhere
0

.

(31)

Appendix C

For Q = 1, one solution can be written in the form

GH

r=1(z) =

1
1
√2 s

−

4

√z2
z

−

.

(32)

Note, that this equation shows a simple relation to the
resolvent of the Gaussian orthogonal ensemble (GS
Q=1 =
r=1 (z)). The eigenvalue spectrum following from

1
z GGOE

Eqs. (14) and (32) can then be written as
q

ρQ=1(¯λ) =

1
√2π q

−

¯λ

|

|

1

2+

2 + 2
¯λ
|
|
¯λ
2+
|
|
1
¯λ
|
|

q
1
2 −

1

=

√2π s−

+

2
2 +

+

¯λ
|
|

4
¯λ
(2 +
|
|

¯λ
)
|
|

,

(33)

and is valued on the support [
ing and taking an expression equivalent to Eq.
namely

2, 2]. After proper rescal-
(16),

−

ρQ=1(r) =

1
πr

d
dr

−

∞

λ

ρQ=1
x
√λ2

(λ)
r2

−

r
Z

dλ ,

(34)

we end up with the expression

ρQ=1(r) =

1
π2r

d
dr

−

r
Z
which can be evaluated to

√2

λ

1

√2
λ −
r2

−

q
√λ2

dλ ,

(35)

ρQ=1(r) =

23/43rΓ

1
K

(cid:20)
21/4Γ

−

5
4

(cid:18)

Γ

(cid:19)
7
4

Γ

5
4

(cid:18)
Φ1
2

Φ1
2

1
4
(cid:18)
3
4

,

,

,

5
4
1
2

,

,

3
2
λ2
2

1
4

(cid:19)

−

(cid:18)

(cid:19)

(cid:18)

(cid:19)

1
4

−

(cid:18)

,

λ2
2

(cid:19)

,

(cid:19)(cid:21)

(36)

[1] W. F. Sharpe, Capital Asset Prices: A Theory of Mar-
ket Equilibrium Under Conditions of Risk, Journal of Fi-
nance 19, 425-442 (1964).

[2] H. M. Markowitz, Portfolio selection Journal of Finance

7, 77-91 (1952).

[3] L. Laloux, P. Cizeau, J.-P. Bouchaud, M. Potters, Noise
Dressing of Financial Correlation Matrices, Phys. Rev.
Lett. 83, 1467 (1999).

[4] V. Plerou, P. Goprikrishnan, B. Rosenow, L. A. N. Ama-
ral, H.E. Stanley, Universal and Nonuniversal Properties
of Cross Correlations in Financial Time Series, Phys.
Rev. Lett. 83, 1471 (1999).

[5] V. Plerou, P. Gopikrishnan, B. Rosenow, L. A. N. Ama-
ral, T. Guhr, H. E. Stanley Random matrix approach
to cross correlations in ﬁnancial data, Phys. Rev. E 65,
066126 (2002).

[6] D.-H. Kim, H. Jeong, Systematic analysis of group identi-
ﬁcation in stock markets Phys. Rev. E 72, 046133 (2005).
[7] M. Potters, J. P. Bouchaud, L. Laloux, Financial Appli-
cations of Random Matrix Theory: Old Laces and New
Pieces, Acta Physica Polonica B 36, 9 (2005).

[8] E. P. Wigner, Characteristic Vectors of Bordered Matri-
ces with Inﬁnite Dimensions, Ann. Math 62 548 (1955);
On the Distribution of the Roots of Certain Symmetric
Matrices, Ann. Math 67, 325 (1958).

[9] J. Ginibre, Statistical Ensembles of Complex, Quater-
nion, and Real Matrices, J. Math. Phys. 6, 440 (1965).

[10] N. Lehmann, H.-J. Sommers, Eigenvalue Statistics of
Random Real Matrices, Phys. Rev. Lett. 67, 941 (1991).
[11] A. Edelman, The probability that a Random Real Gaus-
sian Matrix has k Real Eigenvalues, J. Multivariate Anal.
60, 203-232 (1997).

[12] E. Kanzieper, G. Akemann, Statistics of Real Eigenvalues
in Ginibre’s Ensemble of Random Real Matrices, Phys.
Rev. Lett. 95, 230201 (2005).

[13] J. Wishart, The generalized product moment distribu-
tion in samples from a normal multivariate population,
Biometrika 20 32 (1928).

[14] A. Utsugi, K. Ino, M. Oshikawa, Random matrix theory
analysis of cross correlations in ﬁnancial markets, Phys.
Rev. E 70, 026110 (2004).

[15] K. B. K. Mayya and R. E. Amritkar, Delay correlation

15

where K = 6√π5r3, Γ(x) denotes the Gamma-Function
and Φ1
2(a, b, c, x) is the hypergeometric function. It can
be checked, that – of course –

2πrρ(r)dr = 1.

√2
0

R

due to stock market over-reaction?, Review of Financial
Studies 3, 175-206 (1990).

[18] T. Chordia, B. Swaminathan, Trading volume and cross-
autocorrelations in stock returns Journal of Finance 55,
913-936 (2000).

[19] K.

Chan,

cross-
autocorrelation among stock prices, Journal of Finance
48, 1211-1230 (1993).

information

Imperfect

and

[20] M. J. Brennan, N. Jegadeesh, B. Swaminathan, Invest-
ment analysis and the adjustment of stock prices to com-
mon information, Review of Financial Studies 6, 799-824
(1993).

[21] S. G. Badrinath, J. R. Kale, T.H. Noe, Of shepherds,
sheep, and the cross-autocorrelations in equity returns,
Review of Financial Studies, 8, 401-430 (1995).
and
Time-varying

cross-
autocorrelations in short-horizon stock returns, Journal
of Financial Research 20, 435-458 (1997).

[22] A. Hameed,

factors

[23] R. Mench, Portfolio return autocorrelation, Journal of

Financial Economics 34, 307-344 (1993).

[24] J. Boudoukh, R. Richardson, R. Whitelaw, A tale of three
schools: Insights on autocorrelation of short-horizon re-
turns, Review of Financial Studies 7, 539-573 (1994).

[25] D. Bernhardt, R.

J. Davies,

Portfolio

cross-

autocorrelation puzzles, Working Paper (2005)

[26] L. Kullmann, J. Kertesz, K. Kaski, Time dependent cross
correlations between diﬀerent stock returns: A directed
network of inﬂuence, Phys. Rev. E 66, 026125 (2006).

[27] T. W. Epps, Comovements in stock prices in the very
short run, Journal of the American Statistical Associa-
tion 74, 291-298 (1979).

[28] B. Toth, J. Kertesz, Increasing market eﬃciency: Evo-
lution of cross-correlations of stock returns, Physica A
360, 505 (2006).

[29] R. A. Janik, M. A. Nowak, G. Papp, J. Wambach, I. Za-
hed, Non-Hermitian random matrix models: Free random
variable approach, Phys. Rev. E 55, 4100-4106 (1997).

[30] H. J. Sommers, A. Crisanti, H. Somopolinsky, Y. Stein,
Spectrum of Large Random Asymmetric Matrices, Phys.
Rev. Lett. 60, 1895 (1988).

[31] J. P. Bouchaud, private communication (2006).
[32] V. L. Girko, Spectral Theory of Random Matrices (in

Matrices, cond-mat/0601279 (2006).

Russian), Nauka, Moscow (1988).

[16] Z. Burda, A. Jarosz, J. Jurkiewicz, M. A. Nowak,
G. Papp, I. Zahed, Applying Free Random Variables
to Random Matrix Analysis of Financial Data, cond-
mat/0603024 (2006).

[33] P. J. Forrester, Log-gases and random matrices, in prepa-
ration, www.ms.unimelb.edu.au/ matpjf/matpjf.html
[34] R. Bracewell, The Fourier transform and its Applica-

tions, McGraw-Hill, New York (1965).

[17] A. W. Lo, A. C. MacKinlay, When are contrarian proﬁts

[35] J. Feinberg, R. Scalettar, A. Zee, ’Single ring theorem’

and the disk-annulus phase transition, J. Math. Phys. 42,
5718 (2001).

[36] J. P. Bouchaud, L. Laloux, M. M. Augusta, M. Potters,
Large dimension forecasting models and random singular
value spectra, physics/0512090 (2005).

[37] J. P. Bouchaud, M. Potters, Theory of Financial Risk,

Cambridge University Press, Cambridge (2000).

[38] P. Cizeau, J. P. Bouchaud, Theory of Levy matrices,

Phys. Rev. E 50, 1810 (1994).

[39] Z. Burda, R. A. Janik, J. Jurkiewicz, M. A. Nowak, G.
Papp, I. Zahed Free random Levy matrices, Phys. Rev. E
65, 021106 (2002).

[40] R.N. Mantegna, Hierarchical structure in ﬁnancial mar-

kets, Eur. Phy.s. J. B 11, 193-197 (1999).

[41] T. J. Asaki, R. Chartrand, K. R. Vixie, B. Wohlberg,
Abel inversion using total-variation regularization, In-
verse Problems 21, 1895-1903 (2005).

16

