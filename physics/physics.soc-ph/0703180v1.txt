7
0
0
2
 
r
a

M
 
8
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
0
8
1
3
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

A CLOSED-FORM APPROXIMATION OF
LIKELIHOOD FUNCTIONS FOR DISCRETELY
SAMPLED DIFFUSIONS:
THE EXPONENT EXPANSION

Luca Capriotti
Global Modelling and Analytics Group,
Credit Suisse, Investment Banking Division
One Cabot Square, London, E14 4QJ, United Kingdom
e.mail: luca.capriotti@credit-suisse.com

February 2, 2008

Abstract

In this paper we discuss a closed-form approximation of the likelihood functions of
an arbitrary diﬀusion process. The approximation is based on an exponential ansatz
of the transition probability for a ﬁnite time step ∆t, and a series expansion of the
deviation of its logarithm from that of a Gaussian distribution. Through this procedure,
dubbed exponent expansion, the transition probability is obtained as a power series in
∆t. This becomes asymptotically exact if an increasing number of terms is included,
and provides remarkably accurate results even when truncated to the ﬁrst few (say 3)
terms. The coeﬃcients of such expansion can be determined straightforwardly through
a recursion, and involve simple one-dimensional integrals.

We present several examples of ﬁnancial interest, and we compare our results with
the state-of-the-art approximation of discretely sampled diﬀusions [A¨ıt-Sahalia, Journal
of Finance 54, 1361 (1999)]. We ﬁnd that the exponent expansion provides a simi-
lar accuracy in most of the cases, but a better behavior in the low-volatility regime.
Furthermore the implementation of the present approach turns out to be simpler.

Within the functional integration framework the exponent expansion allows one to
obtain remarkably good approximations of the pricing kernels of ﬁnancial derivatives.
This is illustrated with the application to simple path-dependent interest rate deriva-
tives. Finally we discuss how these results can also be used to increase the eﬃciency
of numerical (both deterministic and stochastic) approaches to derivative pricing.

1

INTRODUCTION

Continuous-time diﬀusion processes is the basis of much of the modeling work performed
every day in Finance and Economics, from portfolio optimization and econometric appli-
cations, to contingent claim pricing. Indeed, since Bachelier’s 1900 doctoral thesis on the
dynamics of stock prices [1], many economic variables subject to unpredictable ﬂuctuations,

1

have been modeled by stochastic diﬀerential equations of the form

dYt = µy(Yt)dt + σy(Yt)dWt .

(1)

Here µy(y) is the drift, describing a deterministic trend, and σy(y)
0 is the volatility
function, describing the level of randomness introduced by the Wiener process (i.e., white
noise), dWt. The main reason for the popularity of this class of models is probably that in
continuous time one can perform analytic calculations using the instruments of stochastic
calculus, and the powerful framework of partial diﬀerential equations.

≥

In particular, for the few cases for which the process (1) is exactly solvable, one can
derive closed-form solutions for the associated transition probability. The latter contains
all the statistical properties of the ﬁnancial quantity modeled by the diﬀusion, and can be
exploited in a variety of ways, including the derivation of no-arbitrage prices for ﬁnancial
derivatives in complete markets. The milestone results derived by Black, Scholes and Merton
[2, 3], Cox, Ingersoll and Ross [4], or Vasicek [6], are among the most signiﬁcant examples of
the amount of progress in Economics that has been done using integrable continuous-time
diﬀusion processes.

Nonetheless, an accurate description of the market observables requires in general more
sophisticated models than those for which an analytic solution is available. These are usually
tackled by means of numerical schemes ultimately relying on a discretization of the diﬀusion,
obtained by replacing the inﬁnitesimal time dt with a ﬁnite time step, ∆t. These approaches
typically involve either solving numerically a Kolmogorov partial diﬀerential equation, or
a Monte Carlo sampling of the diﬀusive paths. The approximate results obtained in this
way become exact only approaching the limit ∆t
0, and this can be done with some
computational eﬀort. In addition, a drawback of these numerical methods, more speciﬁc to
econometric applications, is that they do not produce closed-form expressions for the tran-
sition probability. These are crucial for maximum-likelihood estimations of the parameters,
say θ, of model diﬀusions. In fact, economic data are generally available on discrete sets of
observations, usually well spaced in time, say weekly or monthly. As a result, only if the
transition probability, ρ(X(l+1)∆t, ∆t
Xl∆t; θ), associated with each time interval ∆t of the
|
series t = l∆t (l = 1, . . . n), is known in closed form, the maximum likelihood function,

→

ln(θ) =

log ρ(X(l+1)∆t, l∆t

Xl∆t; θ) ,
|

(2)

1
n

n

Xl=1

can be analytically maximized over θ. If this is not the case, one has to repeat the numerical
calculation of the transition probability for every value of θ needed for the determination of
the maximum, e.g. by means of an optimization algorithm. This can be clearly very time
consuming.

Motivated by this diﬃculty, A¨ıt-Sahalia recently proposed a method to approximate the
transition probability for one dimensional diﬀusions [7] by means of a Hermite polynomial
expansion. This was applied to a variety of test cases, and the accuracy of the method was
clearly demonstrated.

In this paper, we utilize the exponent expansion – a technique introduced in chemical
physics by Makri and Miller [8] – to derive a closed-form short-time approximation of the
transition probability of the diﬀusion process (1). The aim is to obtain an analytic approxi-
mation which is as accurate as possible for a time step ∆t as large as possible. On one hand,
this allows one to derive approximations of ﬁnancial quantities that are very accurate even
for sizable values of the time step, and to derive closed-form expression for the maximum

2

→

likelihood function (2). On the other, it allows a reduction of the computational burden of
numerical schemes as the limit ∆t
0 can be achieved with larger time steps, i.e., with
less calculations. Our approach is similar in spirit to the one of Ref. [7], reviewed in Section
2.1, but it overcomes some of its shortcomings, and it is of simpler implementation.
In
particular, the coeﬃcients of the exponent expansion can be expressed in terms of one di-
mensional integrals that can be easily calculated numerically. In addition, we show how we
can apply our approach to any suﬃciently regular volatility function, even when the latter
does not have an analytic expression but it is speciﬁed numerically through an interpolation
procedure, as it is the typically the case for local volatility models.

The possibility to use Makri and Miller’s technique to derive approximations of the
transition probability was originally hinted by Bennati et al.
in Ref. [9, 10]. Here we
explore this route, giving derivations for a generic diﬀusion process with state-dependent
drift and volatility, and we study the reliability of the exponent expansion by applying it to
several test problems of ﬁnancial interest.

Through the exponent expansion, the transition probability is obtained as a power series
in ∆t which becomes asymptotically exact if an increasing number of terms is included, and
provides remarkably accurate results even when truncated to the ﬁrst few (say, n = 3)
terms. Two derivations are oﬀered, the ﬁrst by means of Kolmogorov’s forward equation
[11] (Sec. 2.2), and the second introducing a slightly diﬀerent formalism (Sec. 2.2.1). The
latter, once the problem is formulated in terms of Feynman’s path integrals [12, 13], allows
the generalization of the exponent expansion to the calculation of the pricing kernel of
ﬁnancial derivatives whose underlying follows the considered diﬀusion. This allows in turn
the derivation of simple approximations for the price of such contingent claims (Sec. 3). In
Sections 2.3 and 3.3, we illustrate the exponent expansion through the application to the
Vasicek, the Cox-Ingersoll-Ross, and the Constant Elasticity of Variance models, and in
Section 4 we discuss its application to Monte Carlo and deterministic numerical methods
within the path integral framework [14, 15, 16, 17, 18, 10]. Finally, we draw our conclusions,
and we discuss future developments in Section 6.

2 TRANSITION PROBABILITIES OF DIFFUSION

PROCESSES

y0), associated
Let us consider the problem of estimating the transition probability, ρy(y, ∆t
|
with one-dimensional continuous-time diﬀusion processes of the form (1). This represents
the likelihood that the random walker following the process (1) ends up in the position y at
time t = ∆t, given that it was in y0 at time t = 0, and satisﬁes the Kolmogorov forward (or
Fokker-Planck) equation [11]:

∂tρy(y, ∆t

y0) =
|

−

(cid:20)

∂yµy(x) +

y σy(y)2
∂2

ρy(y, ∆t

y0) .
|

1
2

(cid:21)

(3)

In this Section we will consider two short-time approximations of the transition probability
above that can be derived in closed form. We will start by reviewing the Hermite poly-
nomial expansion, recently introduced by A¨ıt-Sahalia [7], and then describe the exponent
expansion.

3

2.1 Review of the Hermite polynomials expansion

The ﬁrst step of A¨ıt-Sahalia’s derivation is to transform the original process in an auxiliary
one, say Xt, with constant volatility σx. Following Ref. [7], this can be achieved in general
through the following integral transformations

Xt = γ(Yt)

σx

≡ ±

Z

Yt

dz
σy(z)

,

where the choice of the sign is just a matter of convenience depending on the speciﬁc problem
considered. The latter relation deﬁnes a one to one mapping between the Xt and Yt processes
as the condition σy(z)
0 ensures that the function x = γ(y) deﬁned by (4) is monotonic,
and therefore invertible. 1 A straightforward application of Ito’s Lemma [11] allows one to
write the diﬀusion process followed by Xt as

≥

with

dXt = µx(Xt)dt + σxdWt ,

µx(x) =

σx

±

(cid:20)

µy(γ−1(x))
σy(γ−1(x)) −

1
2

∂σy
∂y

(γ

−1(x))
(cid:21)

,

where y = γ−1(x) is the inverse of the transformation (4).

Using Hermite polynomials, it is possible to show [7], that a short time approximation

of the transition probability can be expressed up to order N as

ρx(x, ∆t

x0) = ∆t
|

−1/2φ(

x
x0
∆t1/2 ) exp
−

dzµx(z)

cn(x, x0)

(7)

(∆t)n
n!

,

x

x0

Z

(cid:0)

N

n=0
X

(cid:1)

where φ(x) is a standard normal distribution. Here the coeﬃcients cn(x, x0) can be derived
by solving the recursive equation

cn(x, x0) = n(x

x

−n

x0)

−

dz(z

−

x0)n−1

(cid:18)

λ(z)cn−1(z, x0) +

∂2
z cn−1(z, x0)

,

(8)

1
2

(cid:19)

for n > 0, with c0(x, x0)

x0

Z
1, and

≡

Finally, the transition probability for the process Yt can be determined through the

(cid:1)

Jacobian of the transformation (4) giving

λ(x) =

µx(x)2 + ∂xµx(x)

.

1
2

−

(cid:0)

ρy(y, ∆t

y0) = σx
|

ρx(γ(y), ∆t
σy(y)

x0)
|

.

(4)

(5)

(6)

(9)

(10)

The expansion above turns out to provide very accurate results in a variety of test cases
for which the exact expression of the transition probability is available. Some of these
examples will be considered in detail in the following when we will compare the results
obtained with the approximation Eqs. (7)-(10), with those given by the exponent expansion
described in this paper, and introduced in the following Section.

1For a discussion of the regularity conditions on the drift and volatility functions see e.g., Ref. [7].

4

2.2 The Exponent Expansion

In this Section, we derive the exponent expansion for the transition probability for the
process (1), ρy(y, ∆t
y0). In order to make the derivation easier, it is convenient to transform
|
the original process in the constant volatility one Eq. (5) by means of the transformation
(4).

For ∆t

0 the transition probability for Xt is dominated by the diﬀusive Gaussian

component and therefore reads:

→

ρx(x, ∆T

x0) =
|

1
2πσ2
x∆t

(cid:18)

(cid:19)

1/2

exp

(x

x0)2
−
2σ2
x∆t

.

(cid:19)

−

(cid:18)

Guided by this observation, in order to ﬁnd an expression for the transition probability
associated with Eq. (5) which is accurate for a time ∆t as long as possible, we make the
following ansatz:

ρx(x, ∆t

x0) =
|

1
2πσ2

x∆t

exp

−

(cid:20)

(x

x0)2
−
2σ2
x∆t −

W (x, x0, ∆t)
(cid:21)

.

Such transition probability must satisfy the Kolmogorov forward equation [11]:

p

∂tρ(x, ∆t

x0) =
|

−

(cid:20)

∂xµx(x) +

σ2
x∂2
x

ρx(x, ∆t

x0) .
|

1
2

(cid:21)

Note that since the auxiliary process Xt has a constant volatility, the latter equation is
mathematically much simpler than the one for the process Yt (3). Equation (13) implies in
turn that the function W (x, x0, t) satisﬁes the relation:

∂tW =

µx∂xW +

−

1
2

x∂2
σ2

xW

1
2

−

x (∂xW )2 + ∂xµx −
σ2

x

x0

−
∆t

∂xW +

.

(14)

µx
σ2
x (cid:19)

(cid:18)

Expanding W (x, x0, t) in powers of ∆t,

∞

W (x, x0, ∆t) =

Wn(x, x0) ∆tn ,

n=0
X
substituting it in Eq. (14), and equating equal powers of ∆t leads in a straightforward way
to a decoupled equation for the order zero in ∆t giving

(11)

(12)

(13)

(15)

(16)

W0(x, x0) =

dz µx(z) ,

x

x0

1
σ2
x Z

−

and to the following set of recursive diﬀerential equations:

(n + 1)Wn+1 =

(x

x0)∂xWn+1 +

1
2

(cid:20)

x∂2
σ2

x −

µx∂x

Wn

(cid:21)

∂xWm∂xWn−m + δn,0∂xµx .

(17)

−

1
2

σ2
x

−
m=n

m=0
X

−

5

In particular, for n = 0, 1, 2 Eqs. (17) read:

W1(x, x0) =

x0) ∂xW1(x, x0) +

µx(x)2 +

2W2(x, x0) =

x0) ∂xW2(x, x0) +

xW1(x, x0) ,

3W3(x, x0) =

x0) ∂xW3(x, x0) +

x∂2
σ2

xW2(x, x0) ,

(x

−

−

−

(x

(x

−

−
1
2

−
x(∂xW1(x, x0))2 .
σ2

−

1
2σ2
x
x ∂2
σ2

(cid:20)
1
2
1
2

1
2

∂xµx(x)
(cid:21)

,

The diﬀerential equations above (17) are all ﬁrst order, linear and inhomogeneous of the
form

nWn(x, x0) =

(x

x0)∂xWn(x, x0) + Λn−1(x, x0) ,

−
where Λn−1(x, x0) is a function that is completely determined by the ﬁrst n
1 relations.
It can be readily veriﬁed by substitution and integration by parts that the solution of (21)
reads

−

−

(21)

Wn(x, x0) =

dξξn−1Λn−1(x0 + (x

x0)ξ, x0) .

−

1

0
Z

This, for n = 1, 2, 3, after some manipulations, gives:

W1(x, x0) =

W2(x, x0) =

W3(x, x0) =

x

x0

dzVeﬀ (z) ,

1
∆x
σ2
x
2∆x2 [Veﬀ (x) + Veﬀ (x0)

Z

2W1(x, x0)] ,

−

σ2
x
2∆x4

−

∆x

"

x

x0

dzVeﬀ(z)2

−

x

x0

dzVeﬀ(z)

2

#

Z

(cid:18)Z
σ4
x
4∆x3 [∂xVeﬀ (x)
x0, and, for reasons that will be clearer in the next Section, we have also

3σ2
x
∆x2 W2(x, x0) +

∂xVeﬀ (x0)] ,

(25)

−

−

(cid:19)

where ∆x = x
introduced the ‘eﬀective potential’ as the following quantity with dimension time−1:

−

Note that, from Eq. (9), Veﬀ (x) =

2λ(x). The ﬁrst order correction can be rewritten as

Veﬀ (x) =

µx(x)2 +

∂xµx(x) .

1
2σ2
x

1
2

W1(x, x0) =

dt Veﬀ (x0 + t∆x/∆t) ,

−

∆t

1
∆t

0
Z

leading to the interpretation of this term as a time-average of the eﬀective potential over
the straight line, constant velocity (∆x/∆t) trajectory between x0 and x. Similarly, the
leading term in W3(x, x0) (i.e., the one proportional to the lowest power of the volatility) is
proportional to the variance of the eﬀective potential over the same trajectory. Note that
0. In particular, for n = 1, 2, 3
the corrections Wn(x, x0) are well deﬁned in the limit ∆x

→

(18)

(19)

(20)

(22)

(23)

(24)

(26)

(27)

6

it is not diﬃcult to show that

lim
x→x0

lim
x→x0

lim
x→x0

W1(x, x0) = Veﬀ (x0) ,

W2(x, x0) =

∂2
xVeﬀ (x) ,

σ2
x
12

σ2
x
24

−

W3(x, x0) =

(∂xVeﬀ (x))2 +

∂4
xVeﬀ (x) .

σ4
x
240

(28)

(29)

(30)

Finally, the transition probability of the original diﬀusion (1) is recovered by means of

the Jacobian transformation (10).

−

The form of the trial transition probability represents the main diﬀerence of the present
approach to the one described in Section 2.1 Ref. [7], which is otherwise very similar in spirit.
W (x, x0, ∆t)] rather then
In fact, the latter expands in powers of ∆t the exponential exp [
just the exponent, as we do here, instead. As it will be shown explicitly in the following, the
present choice gives rise to a distinct approximation scheme for n > 0 providing generally
a similar level of accuracy but remarkably simpler mathematical expressions. In particular,
all the calculations related to the test cases presented in the following Sections have been
easily obtained by hand, i.e., without the aid of symbolic calculation computer programs.
This is because, by keeping the exponential form of the ansatz, one formulates a guess
which is closer to the exact one. The latter, can be expected to have an exponential form in
order to satisfy the Chapman-Kolmogorov property of Markov processes [11]. In addition,
the exponential choice of the ansatz automatically enforces the positive deﬁniteness of the
transition density which is not granted in the approach of Ref. [7]. In fact, as it will be
0), when the eﬀect
shown explicitly in Sec. 2.3, in the limit of very small volatility (σx →
of the noise disappears, and the transition density converges to a Dirac’s δ distribution,
the expansion of Ref. [7] breaks down as the transition probability becomes negative. On
the contrary, the exponent expansion remains well deﬁned and accurate also in this limit.
Indeed, the ﬁrst terms of the expansion in ∆t can be also derived through a small volatility
expansion of the transition density, as it will be discussed in Sec. 3.1.

Similarly to the approximation developed in Ref. [7], the exponent expansion has in
general a ﬁnite convergence radius which is a decreasing function of the volatility. As it
will be shown in the following, for the values of volatilities and ∆t relevant for ﬁnancial
applications the exponent expansion turns out to be very accurate even when truncated to
the ﬁrst few terms.

2.2.1 Alternative derivation

The term W0(x, x0) in the exponent expansion is somewhat diﬀerent from the higher order
terms. In fact, it is deﬁned by Eq. (16) which is decoupled from the recursive system (17).
Indeed, it is possible to obtain the same result for the exponent expansion by expressing the
transition density as

ρx(x, ∆t

x0) = e
|

−W0(x,x0)Φρx (x, ∆t

x0) ,
|

and looking for an approximate expansion of the form (12) for Φρx(x, ∆t
show by direct substitution in the forward Kolmogorov equation (13) that Φρx (x, ∆t
the solution of

x0). It is easy to
|
x0) is
|

(31)

(32)

Hx Φρx(x, ∆t

x0) =
|

−

∂tΦρx(x, ∆t

x0) ,
|

7

where

Hx is the “Hamiltonian” diﬀerential operator

Hx =

−

σ2
x
2

∂2
x + Veﬀ (x) ,

(33)

and Veﬀ (x) is the eﬀective potential of Eq. (26). As a result one can equivalently derive the
exponent expansion by substituting in Eq. (32) the following trial function

Φρx (x, ∆t

x0) =
|

1
2πσ2

x∆t

exp

"−

(x

x0)2
−
2σ2
x∆t −

Wn(x, x0)∆tn

,

(34)

#

∞

n=1
X

which does not contain the term W0(x, x0). This observation will be used in Section 3 to
generalize the exponent expansion to the pricing kernel of ﬁnancial derivatives.

p

2.2.2 Exponent Expansion Coeﬃcients in terms of the the Original Diﬀusion

The derivations of the exponent expansion, and of the Hermite polynomial approximation
of Section 2.1, both rely on the introduction of the auxiliary process (5), and the integral
transformation (4). As a result, the expressions obtained are easy to handle if the the
volatility of the original process σy(y) is such that both the function γ(y) (4) and its inverse
γ−1(x) admit a closed-form expression.
In fact, in this case the eﬀective potential (26)
– or the function λ(z) (9) – has a closed-form expression, and the determination of the
coeﬃcients of the expansion can be determined either analytically or through numerical
quadrature. This is the case for the examples considered in the following. However, these
In fact, very few volatility functions have a reciprocal for which
are very special cases.
a primitive exist. On the contrary, in many practical applications, e.g.
in local volatility
models [5], the volatility is speciﬁed numerically through a ﬁt to an volatility function. For
all these cases the application of the exponent expansion or the approach of Section 2.1
becomes cumbersome and computationally demanding, because it requires the numerical
inversion of the integral equation (4).

However, at a more careful analysis, it turns out that it is possible to circumvent this
diﬃculty, and to eliminate any dependence on the function γ−1(x) in the expressions for the
exponent expansion. This makes its application straightforward for any diﬀusion process,
irrespective of the analytic tractability of the speciﬁed volatility function. The ﬁrst step to
do this, is to note that, according to the Jacobian transformation (10), x and x0 in Eq. (12)
need to be calculated for γ(y), and γ(y0), respectively. As a result, one can express the
exponent expansion as

ρy(y, ∆t

y0) =
|

1
2π∆tσy(y)2

exp

"−

(γ(y)

γ(y0))2

−
2∆t

˜Wn(y, y0)∆tn

.

(35)

#

∞

−

n=0
X

with the notation

p

˜G(y, y0) = G(x, x0)

|x=γ(y),x=γ(y0),

(36)

and taking, without any loss of generality σx = 1. Now, using Eq. (16), by means of the
change of variables y = γ−1(x) one can express the zeroth order term as

˜W0(y, y0) =

y

dz
σy(z)

−

y0

Z

˜µx(z)

8

where, using Eq. (6),

˜µx(z) =

µy(z)
σy(z) −
As anticipated, the expression for W0 does not contain any reference to the function γ−1(x)
y
y0 dz/σy(z)
so that it can be calculated even if there is no closed-form expression for γ(y) =
available, or if the latter is not analytically invertible. Similarly, using Eqs. (23)-(25) one
R
can easily ﬁnd

∂σy
∂y

(37)

(z)

1
2

±

(cid:20)

(cid:21)

.

˜W1(y, y0) =

y

y0

dz
σy(z)

˜Veﬀ (z) ,

˜W2(y, y0) =

˜Veﬀ (y) + ˜Veﬀ (y0)

1
∆˜y
1
2∆˜y2

Z

h

1
2∆˜y4

−

˜W3(y, y0) =

−

2 ˜W1(y, y0)
i
y

,

y

∆˜y

"

y0

Z

˜Veﬀ (z)2

dz
σy(z)

˜Veﬀ (z)

2

#

(cid:19)

−

y0

(cid:18)Z

dz
σy(z)

σy(y)
4∆˜y3

3
∆˜y2

−

˜W2(y, y0) +

∂y ˜Veﬀ (y)
h

−

∂y ˜Veﬀ (y)
i

,

where ∆˜y = γ(y)

γ(y0), and the eﬀective potential now reads

−

˜Veﬀ (y) =

˜µx(y)2 +

σy(y)∂y ˜µx(y) .

1
2

1
2

As a result, the exponent expansion can be easily applied for any speciﬁcation of the volatility
function σy(y). Indeed, given any drift and volatility function one can immediately calculate
– possibly numerically – their derivatives and the function γ(y). From these quantities,
one then easily calculates the eﬀective potential (41), and the coeﬃcients of the exponent
expansion (38)-(40).

2.3 Examples

The application of the exponent expansion to a generic diﬀusion process of the form (1)
is rather straightforward and reduces to the calculation of one dimensional integrals. In
this Section, we illustrate this procedure for a few test cases, namely for the Vasicek [6],
the Cox-Ingersoll-Ross [4], and the Constant Elasticity of Variance [19] diﬀusion processes.
We will compare the results of the exponent expansion with the exact results available in
literature, and with the approach of Ref.[7].

2.3.1 Vasicek diﬀusion

We ﬁrst consider the Ornstein-Uhlenbeck diﬀusion proposed by Vasicek [6] as a model for
the short-term interest rate:

dXt = a(b

Xt)dt + σdWt ,

−

where a, b, and σ are positive constants representing the mean-reversion level, the veloc-
ity to mean reversion, and the volatility, respectively. This model is integrable and the
corresponding probability density function is Gaussian:

ρex(x, ∆t

x0) =
|

(2π¯σ2)1/2 exp

1

[(x0 −

a)e−a∆t
2¯σ2

(x

−

−

a)]2

,

(cid:21)

−

(cid:20)

9

(38)

(39)

(40)

(41)

(42)

(43)

Figure 1: Accuracy of the exponent expansion for the transition density of the Vasicek model
(42). for a = 0.0717, b = 0.261 and x0 = 0.1. Panel (a): comparison between the exponent
expansion (stars) and the approximation of Ref. [7] (squares) for σ = 0.02237 and ∆t = 0.5.
At order zero the two schemes are identical. The uniform error of the Euler approximation
is also reported for comparison. Panel (b): comparison between the exponent expansion
(stars) and the approximation of Ref. [7] (squares) in the regime of low volatility (σ = 0.01),
for ∆t = 0.5.

10

Figure 2: Accuracy of the exponent expansion for the transition density of the Vasicek model
(42). for a = 0.0717, b = 0.261 and x0 = 0.1. Maximum relative error for σ = 0.02237 as a
function of ∆t: n = 0 (continuous), n = 1 (dotted), n = 2 (long dashed) and n = 3 (short
dashed). The inset is an enlargement of the 5-10 years region.

11

The exponent expansion of the Vasicek model can be easily derived using Eqs. (16), and

(23-25) with the eﬀective potential, Eq. (26),

with

and gives,

1

−

e−2a∆t
2a

.

¯σ = σ

r

Veﬀ (x) =

a2(b

x)2

−
2σ2

a
2

,

−

ρx(x, ∆t

x0) =
|

exp

1
√2πσ2∆t
W1(x, x0)∆t

(x

x0)2
−
2σ2∆t −

−
(cid:2)
W2(x, x0)∆t2
−

−

−

W0(x, x0)

W3(x, x0)∆t3

,

(46)

up to the third order in ∆t (n = 3). Here

(cid:3)

a
2

,

b)2 + (x

b)(x0 −

−

b))

−

,

b)2

b)2

a(x0 −

−
2σ2
b)2 + (x0 −
Veﬀ (x) + Veﬀ (x0)

−

W0(x, x0) =

W1(x, x0) =

W2(x, x0) =

W3(x, x0) =

a(x

−

a2
6σ2 ((x
σ2
2∆x2
σ2
(cid:2)
x
2∆x3

h

a4
20σ4 [(x
a3
6σ2 [(x

−
a2
4
−
−
σ2
x
2∆x2 (W1(x, x0))2

∆x

+

+

2W1(x, x0)

,

−

b)5

−

(x0 −

−

b)5]

(cid:3)

b)3

−

b)3]

(x0 −

−
3σ2
x
∆x2 W2(x, x0) +

i

a2σ2
x
4∆x2 ,

It is interesting to note that the approximate transition probability
with ∆x = x
obtained with the present approach reproduces exactly the expansion of the exact transition
density Eq. (43) at the same order.

x0.

−

On the other hand, the ﬁrst two coeﬃcients of the Hermite polynomials expansion (7)

as quoted in Ref. [7] read:

c1(x, x0) =

3(x + x0)baσ

c2(x, x0) =

+ (

−

1
6σ2
3 + x2a + xx0a + x2

a(3b2a
h

−

a2(9b4a2

−
1
36σ4
−
h
3 + x2a)σ3 + (3
6xba(
−
−
3b + xσ)(3b2a
+ 2aσ(
−
+ 3aσ2(5b2a

−
4xbaσ + (

−

.

+ a2σ4x4
0)
i

,

0a)σ2)
i

18xb3a2σ + 3b2a(

6 + 5x2a)σ2

−

6x2a + x4a2)σ4

−
3xbaσ + (
2 + x2a)σ2)x2

3 + x2a)σ2)x0
0 + 2a2σ3(

−

−

3b + xσ)x3
0

−

The fast convergence of the approximation scheme is illustrated in Figs. 12. Here the
percentage error of the exponent expansion with respect to the exact result (43) is plotted

12

(44)

(45)

(47)

(48)

(49)

(50)

(51)

(52)

for various ∆t, and compared with the approach of Ref. [7]. The parameter choice, also
taken from Ref. [7] corresponds to a sensible parameterization for interest rate markets. We
adopt one year as unit of time, and we express the various parameters in this unit. The
Euler approximation

ρE(x, ∆t

x0) =
|

s

1
2πσ2
x∆t

exp

−

(cid:18)

(x

−

x0 −
2σ2

µx(x0)∆t)2
x∆t

,

(cid:19)

(53)

is also reported for comparison. The inclusion of each successive order allows one to increase
dramatically the accuracy of the approximation so that the third order expansion has basi-
cally a negligible error even for a sizable time step of order 6 months. Remarkably, for the
considered example, the third order expansion allows one to estimate the 10 years transition
probability with a relative error of less than 10 basis points (Fig. 2). As illustrated in Fig. 1-
(a), in the present case the approach of Ref. [7] provides a slightly poorer level of accuracy
for n
2. In addition, it generally produces more complicated mathematical expressions.
Furthermore, as shown in Fig. 1-(b), in the regime of small volatility the exponent expansion
still provides accurate results while the performance of the approach of Ref. [7] degrades.
In fact, as anticipated, in the limit of small volatility (σx . 0.5%) the ﬁrst order correction
of the latter approach produces a negative transition probability signaling a break down of
the scheme.

≤

2.3.2 Cox, Ingersoll and Ross diﬀusion

The Vasicek model is probably too easy of a test case as the associated transition probability
is Gaussian. In fact, since the exponent expansion has a leading term which is Gaussian, the
higher powers in ∆t just have to renormalize its average and variance in order to reproduce
the exact result. It is interesting therefore to test the accuracy of the exponent expansion
for a diﬀusion process that, while still integrable, generates a non-normal transition density.
This is the case for the Feller’s square root process [20]

dYt = a(b

Yt) + σy

YtdWt

−

which is the basis of Cox-Ingersoll-Ross model for the instantaneous interest rate [4]. The
exact transition probability is given by [4]

ρex(y, ∆t

y0) = ce
|

−(u+v)

Iq(2√uv) ,

where c = 2a/[σ2
is the modiﬁed Bessel function of the ﬁrst kind of order q [21].

a∆t))], q = 2ab/σ2

exp (

y(1

≥

−

−

0, u = cy0 exp (

−

a∆t), v = cy and Iq

As explained in Sec.2.2, since the volatility is not uniform, it is convenient to introduce
2√Yt/σy. The Xt process follows

the auxiliary process deﬁned by Eq. (4), as Xt = γ(Yt)
Eq. (5), with σx = 1 and

≡

p

q
2

v
u

(cid:17)

(cid:16)
1
y −

and ˜q = q + 1/2. In this case the eﬀective potential reads:

µx(x) =

˜q
x −

a
2

x ,

Veﬀ (x) =

µx(x)2

1
2

˜q
2x2 −

a
4

,

−

13

(54)

(55)

(56)

(57)

and the ﬁrst four terms of the exponent expansion in Eq. (15) are:

+

−

1
5

W0(x, x0) =

W1(x, x0) =

˜q log

−

x
x0

+

(x2

a
4

x2
0)

−

−

−

−

x3
0

h
x3

µx(x)

1
2∆x
a2
12
1
(cid:0)
2∆x2
1
(cid:2)
2∆x2
(cid:20)
3
∆x2 W2(x, x0) +

G(x)

(cid:1)

−

µx(x0)

˜q2

−

1
x −

1
x0 (cid:19)

(cid:18)

a˜q (x

x0)

−

i
2W1(x, x0)

(cid:3)
(W1(x, x0))2

−

−

(cid:21)

G(x0)

−
∆x

1

4∆x3 [∂xVeﬀ (x)

−

∂xVeﬀ (x0)] ,

W2(x, x0) =

Veﬀ (x) + Veﬀ (x0)

W3(x, x0) =

(58)

(59)

(60)

(61)

where ∆x = x

x0, ∂xVeﬀ (z) = ˜q(1

˜q)/z3 + a2z/4, and

−

G(z) =

α2z5

−

−
β2
1
z3 + γ2z + 2αβz
3
a(˜q + 1)/2. Finally, going back to the original process

αγz3 ,

βγ
z

(62)

2
3

−

+

2

and α = a2/8, β = ˜q(˜q
−
with Eq. (10), the transition probability reads:

1)/2, γ =

−

ρy(y, ∆t

y0) = ρx(2√y/σy, ∆t
|

|

2√y0/σy)/σy√y .

(63)

The coeﬃcients of the expansion in Hermite polynomials Eq. (7) as quoted in Ref. [7]

read instead:

c1(x, x0) =

48b2a2

48baσ2 + 9σ4

−

1
24xx0σ4

−
+ xa2σ2(

h

−

0σ8

1
576x2x2
+ 6xa2σ2(
+ x2a2σ4(672b2a2
+ 2xa2σ4(48b2a2

−

24b + x2σ2)x0 + x2a2σ4x2

0 + xa2σ4x3
0

,

(64)

c2(x, x0) =

9(256b4a4

512b3a3σ2 + 224b2a2σ4 + 32baσ6

15σ8)

i

−

−

h
24b + x2σ2)(16b2a2

16baσ2 + 3σ4)x0

−

48ba(2 + x2a)σ2 + (
−
24ba(2 + x2a)σ2 + (9 + x4a2)σ4)x3
0
−

6 + x4a2)σ4)x2
0

−

+ 3x2a4σ6(

16b + x2σ2)x4

0 + 2x3a4σ8x5

0 + x2a4σ8x6
0

.

(65)

−

i

The accuracy of the exponent expansion in this case is illustrated in Figs. 3 and 4.
Similarly to the case of the Vasicek diﬀusion, the exponent expansion is characterized by a
remarkably fast convergence by including successive terms of the approximation so that n =
3 provides already a virtually exact representation of the transition density, for ∆t
1 yrs.
In this case, the approach of Ref. [7] performs slightly worse of the exponent expansion for
n = 1, and slightly better for n = 2. However, also in this case the former breaks down for
small values of the volatility, generating unphysical transition densities.

≃

14

Figure 3: Accuracy of the exponent expansion for the transition density of the Cox-Ingersoll-
Ross model (54), for a = 0.0721, b = 0.219, σ = 0.06665, and x0 = 0.06. Comparison
between the exponent expansion (stars) and the approximation of Ref. [7] (squares) for
∆t = 0.5. The uniform error of the Euler approximation is also reported for comparison.

15

Figure 4: Accuracy of the exponent expansion for the transition density of the Cox-Ingersoll-
Ross model (54), for a = 0.0721, b = 0.219, σ = 0.06665, and x0 = 0.06. Probability density
function for ∆t = 1.5 for diﬀerent values of n: n = 0 (dotted), n = 1 (long dashed), n = 2
(short dashed), n = 3 (continuous), Euler (dot-long dashed), exact (crosses). The inset is
an enlargement of the region of the maximum. On this scale, the estimates for n = 2 and
n = 3 still appear coincident.

16

2.3.3 Constant Elasticity of Variance diﬀusion

As a last example we consider the Constant Elasticity of Variance model:

Here we consider for brevity only the case p > 1. The transformation to a process with
constant (unit) variance is Xt = γ(Yt) = Y 1−p

1) and gives, according to Eq. (6)

/σy(p

dYt = a(b

Yt)dt + σyY p

t dWt

µx(x) =

+ c2x + c3x

p−1 ,

−

p

−

t

c1
x

with c1 = p/2(p
eﬀective potential reads

−

1), c2 = a(p

1), and c3 =

ab(p

−

−

−

1)p/(p−1)σ1/(p−1)

y

. In this case the

Veﬀ (x) =

µx(x)2

1
2

c1
2x2 +

c2
2

+

−

p

−

2(p

1)

c3x1/(p−1) ,

and the ﬁrst three terms of the expansion are:

W0(x, x0) = c1 log

1)
1)

y0
y −

a(p
−
2(2p
−
1
p
p−1
p−1 σ
y

h
2p−1
p−1

x

F (x)

−

(cid:16)
F (x0)
i

,

(2p

1)(x2

x2
0)

−

−

−

2p−1
p−1
x
0

,

(cid:17)i

−

(cid:3)

+ 2b(p

1)

−

1
2∆x
h
1
2∆x2

(cid:2)

W2(x, x0) =

Veﬀ (x) + Veﬀ (x0)

2W1(x, x0)

,

W1(x, x0) =

with

F (z) =

c2
1
z

−

+

z3 +

c2
2
3

3p−1
p−1

z

c2
3(p
3p

1)
−
1
−
1)

p
p−1 +

z

2c1c3(p
p

−

+ 2c1c2z +

2c2c3(p
3p

−
2

1)

−

3p−2
p−1 + µx(z) .

z

(72)

Similarly to the examples considered previously, also for the Constant Elasticity of Vari-
1, and
ance model we ﬁnd a very fast convergence of the exponent expansion for ∆t
a performance generally similar to the one of the approach of Ref. [7], for values of the
volatility large enough.

≃

3 PRICING KERNELS OF CONTINGENT CLAIMS

3.1 Path integral formulation

The exponent expansion can be generalized to obtain an approximation of the pricing kernels
of ‘standard’ derivatives. This can be done by formulating the pricing problem within
Feynman’s path integral framework [9, 10]. Here we indicate as ‘standard’ any contingent
claim written on the underlying, Yt, whose value at time t = 0, V0, can be expressed as an
expectation value of a functional of a certain type, namely

(66)

(67)

(68)

(69)

(70)

(71)

(73)

V0(∆t, y0) = E

P (Y∆t)F [Yu]
(cid:12)
h
(cid:12)
(cid:12)

17

y0

,

i

where

∆t

"−

F [Yu] = exp

du VF [Yu]

,

(74)

0
Z
and P (Y∆t) is a payout function. Above ∆t is the time to expiry, and the expectation
value is performed with respect to the probability measure deﬁned by the diﬀusion for Yt
that we assume of the form (1). European Vanilla options, zero coupon bonds, caplets,
and ﬂoorets clearly belong to this family of contingent claims.
In addition, other path-
dependent derivatives, like barrier or Asian options can be expressed in this form (see e.g.,
Refs. [23, 24]).

#

Similarly to the case of the transition probability, it is in general convenient to introduce
an auxiliary diﬀusion with constant volatility of the form (5) by means of the integral
transformations (4). Then, the expectation value in (73) can be transformed in an integral
over the distribution generated by such auxiliary diﬀusion by means of the usual Jacobian
transformation (10). As a result, the value of the option can be in general written as:

V0(∆t, x0) = E

P (X∆t)F [Xu]
x0
(cid:12)
h
(cid:12)
where D is the domain of the auxiliary process as deﬁned by the relative stochastic diﬀer-
(cid:12)
ential equation (5), and K(x, ∆t
x0) is the pricing kernel. The latter can be expressed in
|
terms of a path integral as it follows[9, 10]

dxP (x)K(x, ∆t

x0) .
|

(75)

ZD

=

i

K(x, ∆t

x0) = e
|

−W0(x,x0)Φ(x, ∆t

x0)
|

with

x(∆t)=x

∆t

Φ(x, ∆t

x0) =
|

x(0)=x0 D
Z

"−

0
Z

[x(u)] exp

du Leﬀ[x(u), ˙x(u)]

.

(77)

#

where W0 is given by Eq. (16) and the functional Leﬀ[x(u), ˙x(u)] is the eﬀective Euclidean
Lagrangian

Leﬀ[x(u), ˙x(u)] =

˙x(u)2 + Veﬀ (x)

( ˙x(u)

dx(u)/du) with the eﬀective potential, Veﬀ (x), deﬁned as:

≡

Veﬀ (x) =

µx(x)2 +

∂xµx(x) + VF (x) .

1
2σ2
x

1
2σ2
x

1
2

(76)

(78)

(79)

D

Finally, the measure
[x(u)] is deﬁned by discretizing each path x(u) connecting x(0) = x0
and x(T ) = x. This can be done by dividing the time interval [0, T ] into P intervals so that
xn = x(un) (un = nT /P with n = 0, ..., P ), and by integrating the internal P
1 variables
xn over the domain D. The path integral
of this procedure, namely

[x(u)] is then obtained as the limit for P

→ ∞

−

D

R

[x(u)]

lim
P →∞

≡

D

Z

P −1

n=1 ZD
Y

(2πσ2

x∆t)

−P/2

dxn .

(80)

It is well known form the physical sciences that the path integral Φ(x, ∆t

r0) satisﬁes
|
the partial diﬀerential equation Eq. (32) [12, 13]. Note that this is consistent with the fact
0 the pricing kernel coincides with the transition density of
that, by deﬁnition, for VF (x)

≡

18

the underlying diﬀusion process for Xt. In particular, as observed in Sec. 2.2.1, one can use
Eq. (32) to derive the exponent expansion for Φ(x, ∆x
r0) using the trial form (34). As a
|
result, the same expressions Eqs.(23-25) derived for the transition density hold true also for
the pricing kernel, provided that the eﬀective potential (79) replaces the one in Eq. (26).

3.2 Correspondence with Quantum Mechanics

It is interesting to note that the path integral formulation of the pricing kernel (77) is
mathematically equivalent to the quantum mechanical description of the thermodynamic
properties of an ideal gas of particles moving in the potential ~Veﬀ (x) (~ is the reduced
Planck’s constant giving the correct energy dimensions). The complete correspondence is
~/kBT where m is the mass of the particle, T
obtained by identifying σ2
→
is the temperature, and kB is the Boltzmann constant. With this prescription, Φ(x, ∆t
x0)
|
becomes the so-called single particle density matrix, and the results of Makri and Miller
[8] can be readily recovered. In addition, it is straightforward to show using Eqs. (30) that
the exponent expansion of its diagonal elements, Φ(x0, ∆t
x0), are consistent with the so
|
called Wigner expansion for the high-temperature limit. Finally, performing the analytic
i~t allows one to obtain the single-particle
continuation known as Wick rotation ∆t
quantum propagator. In this case (32) becomes the celebrated Schr¨odinger equation.

~/m and ∆t

x →

→

This correspondence provides an alternative justiﬁcation of the choice of the exponential
ansatz in Eq. (12).
Indeed, this is the form in which can be expressed in general the
quantum mechanical propagator or the single particle density matrix [12, 13]. Furthermore,
it has been shown for the quantum problem [22] that the exponent expansion up to third
order in ∆t and ﬁrst order in ~/m can be derived starting from the short time semiclassical
propagator obtained through a saddle point analysis of the limit ~/m
0 [25]. Indeed, it
can be shown that the second order correction W2(x, x0), Eq. (24), is the so-called van-Vleck
determinant of the saddle point expansion. This explains why the accuracy of the present
scheme is preserved in the corresponding regime of low volatility, as it was anticipated in
Sec.2.2, and illustrated in Sec.2.3.

→

3.3 An example: Zero Coupon Bond

In this Section we illustrate the prescriptions outlined above by applying the exponent
expansion to the calculation of a zero coupon bond within the Vasicek and Cox-Ingersoll-
Ross models. The zero coupon bond is a ﬁnancial instrument that provides at time t = ∆t
a payout of one unit of a certain notional. Its value at time t = 0 can be expressed therefore
as

P (0, ∆t) = E

exp

du Xu

r0

(81)

which is of the standard form given by Eqs. (73) and (74), with VF [Xu] = Xu, and P [X∆t]
1.

≡

As a result, the exponent expansion for the kernel Eq. (76) can be easily derived giving

for the Vasicek model

∆t

−

0
Z

h

i

(cid:12)
(cid:12)
(cid:12)

W1(x, x0) = W 0

1 (x, x0) +

W2(x, x0) = W 0

2 (x, x0)

W3(x, x0) = W 0

3 (x, x0)

x + x0
2

σ2
x + 2a2(x

b)

−

−

24

19

(82)

(83)

(84)

Figure 5: Accuracy of the exponent expansion for the pricing kernel Eq. (76) of the Vasicek
model (42), for a = 0.0717, b = 0.261, and x0 = 0.1. Symbols as in Fig. 4. The panel on
the left shows the maximum absolute error as a function of the order of the expansion n.

where W 0
of Sec. 2.3.1. For the Cox-Ingersoll-Ross model instead we get:

i (x, x0) are the expressions obtained for the transition probability Eqs. (47)-(50)

W1(x, x0) = W 0

1 (x, x0) +

(x2 + x2

0 + xx0)

W2(x, x0) = W 0

2 (x, x0)

σ2
12
σ2
24

−

with W 0
in Eq. (61) with

i (x, x0) given by Eqs. (58)-(60), and W 0

3 (x, x0) related to the previous quantities as

G(z) = G0(z) +

(α +

+

z3 + βz

,

σ2
y
2 "

σ2
y
8

)

z5
5

γ
3

#

G0(z) as in Eq. (62), and ∂zVeﬀ (z) = ∂zV 0
yz/2. The exponent expansion for the
pricing kernel can be compared with the exact results that can be shown to read for the
Vasicek model (42)

eﬀ (z) + σ2

Kex(x, ∆t

, x0) =
|

exp

(x

−

x0)/a

∆t(b
−
(2π¯σ2)1/2

−

(cid:2)

σ2/2a2)

b + σ2/a2

x0 −

exp

"− (cid:2)(cid:0)

(cid:3)
(y

−

−

e−a∆t
2¯σ2

(cid:1)

b + σ2/a2)

2

,

(88)

#

(cid:3)

(85)

(86)

(87)

20

Figure 6: Zero Coupon Bond for the Cox-Ingersoll-Ross model. Parameters and symbols as
in Fig.4.

with ¯σ given by Eq. (44), and

Kex(x, ∆t

, x0) =
|

2
x

exp

−

"

a

4 (x2

−

x2
0) + (2ab
σ2

−

2

σ

2 ) log x

x0

2

2

b∆t/σ

γ√xx0 ea
2σ2 sinh [γ∆t/2]

#

γ
4σ2 (x2 + x2

exp

−
h

Iq
0) coth [γ∆t/2]
i

(cid:18)

xx0γ
2σ2 sinh [γ∆t/2]

(cid:19)

(89)

with γ = √a2 + 2σ2, for the Cox-Ingersoll-Ross one. As illustrated in Fig.5, similarly
to the case of the transition probability, the exponent expansion provides a remarkably
good, and fast converging approximation of the exact pricing kernel for ﬁnancially sensible
parameterizations, and for a sizable value of the time step ∆t.

Finally, the zero coupon bond can be obtained by numerical integration of the pricing
kernel according to Eq. (75). The corresponding results are shown in Fig. 6 conﬁrming
once more the quality of the approximation. In a similar fashion, one can obtain systematic
approximations for caplets, ﬂoorets, and other simple interest rate derivatives whose value
depends only on the value of the instantaneous short rate at time t = ∆t. It is also possible
to generalize this approach to path dependent contingent claims, like Asian options.

4 EXTENDING THE TIME STEP: PATH INTEGRAL

MONTE CARLO METHODS

For an extended time interval T , the calculation of the transition density or, more in general,
of the pricing kernel (76) can be performed by discretizing the path integral (77), and taking
) according to the standard Trotter product
the limit of large number of time slices (P

→ ∞

21

formula:

P −1

n=1 ZD
Y

k=P

Xk=1

K(x, ∆t

x0)
|

≃

(2πσ2

x∆t)

−P/2e

−W0(x,x0)

dxn

exp

1
2σ2
x∆t

"−

×

(xk −

xk−1)2

∆t
2

−

k=P

Xk=1

(Veﬀ (xk) + Veﬀ (xk−1))

(90)

#

with ∆t = T /P , xP = x, and the eﬀective potential given by Eq. (79).
It is worth re-
marking that, for the case of the transition density, by interpreting the latter equation
as the Chapman-Kolmogorov property of Markov processes [11] one obtains the following
approximation of the short-time propagator

KTrotter(x, ∆t

x0) =
|

e−W0(x,x0)
2πσ2
x∆t

exp

−

(cid:20)

(x

x0)2
−
2σ2
x∆t −

∆t
2

(cid:16)

Veﬀ (x) + Veﬀ (x0)

.

(91)

(cid:17)(cid:21)

However, in contrast to the n = 1 exponent expansion, the latter expression is not strictly
correct up to order ∆t, and only in the limit P

the diﬀerence becomes negligible.

p

In general, to obtain an accurate result for the pricing kernel for an extended time period
T one has to increase the number of time slices, or Trotter number P , until convergence is
achieved. By replacing the Trotter formula with the improved short-time kernel obtained
through the exponent expansion (12) one achieves a faster convergence with the Trotter
number, thus signiﬁcantly reducing the computational burden. In this case the ﬁnite-time
expression of the pricing kernel reads

→ ∞

K(x, T

x0)
|

≃

(2πσ2

x∆t)

−P/2

exp

1
2σ2
x∆t

"−

×

P

Xk=1

(xk −

xk−1)2

−

Xk=1

P −1

n=1 ZD
Y
P

dxn

W (xk, xk−1, ∆t)

(92)

#

with W (x, x0, ∆t) given by Eq. (15).

Equation (92) allows one to obtain the transition density or the pricing kernel for a
standard derivative through the calculation of a multidimensional integral over the variables
x1, . . . , xP −1. The latter integration is ideally suited for Monte Carlo methods either in real,
or in Fourier space [26], the speciﬁc choice depending on the particular problem at hand.
In addition, importance-sampling schemes, e.g., by means of the Metropolis algorithm [27],
can be easily applied in order to reduce the computation time. However, in order not to
introduce a systematic bias in the result a particular attention has to be paid in order to
sample accurately the conﬁguration space.

The most straightforward way to perform a Monte Carlo quadrature of Eq. (92), is to

realize that a simple Markov chain x = (x1, . . . , xP −1)

xn = xn−1 + σx√∆t Zn ,

(93)

with Zn, sampled from a standard normal distribution, generates an ensemble of walkers
distributed according to

ρ(x1, . . . , xP −1|

x0) = (2πσ2

x∆t)

−(P −1)/2 exp

1
2σ2
x∆t

"−

P −1

Xk=1

(xk −

xk−1)2

.

(94)

#

22

As a result, the pricing kernel (92) can be obtained as the average over the random paths
generated according to Eq. (93) of the following estimator:

(x, xP = x) = (2πσ2

x∆t)

−1/2 exp

O

1
2σ2
x∆t

(x

−

"−

xP −1)2

−

P

W (xk, xk−1)

.

(95)

#

Xk=1
A remarkable property of the path integral approach is that K(x, ∆t
x0) for any ﬁnal point
|
x can be evaluated with a single Monte Carlo simulation by appropriately reweighting the
x0) is independent
accumulated estimator. In fact the distribution of walkers p(x1, . . . , xP −1|
of the ﬁnal point xP so that K(x′, ∆t
(x, xP = x′). In
x0) can be calculated by averaging
|
addition, the latter quantity can be eﬃciently obtained by means of the following reweighting
procedure

O

with

′
(x, xP = x

) =

O

O

(x, xP = x) W
W

(x′, x)
(x, x)

(x, x) = exp

W

1
2σ2
x∆t

(x

−

−

(cid:20)

xP −1)2

−

W (x, xP −1)
(cid:21)

.

Expectation values of the form (75) on a time horizon T can be calculated by integrating

over the ﬁnal variable giving:

V0(T, x0) =

dxP (x)K(x, T

x0)
|

≃

(2πσ2

x∆t)

−P/2

dxnP (xP )

ZD

exp

1
2σ2
x∆t

"−

P

Xk=1

(xk −

xk−1)2

P

−

Xk=1

W (xk, xk−1)

.

(98)

#

P

n=1 ZD
Y

This can be simulated by extending the Markov chain (93) up to step x = xP , and accumu-
lating the estimator

′
(x, xP = x

) = P (x) exp

P

P

"−

Xk=1

W (xk, xk−1)

.

#

Remarkably, within the path integral approach, the sensitivities of such expectation values
with respect to the model parameters (the so-called Greeks) can be computed in the same
Monte Carlo simulation, thus avoiding any numerical diﬀerentiation.
Indeed, indicating
with θ a generic parameter, under quite general conditions [28], one has

∂θV0(T, x0, θ) =

dx [Kθ(x, T

x0)∂θP (x, θ) + P (x, θ)∂θKθ(x, T
|

x0)] .
|

(100)

ZD

As a result the sensitivity ∂θV0(T, x0, θ) can be calculated by means of the estimator:

′
(x, xP = x

) = exp

G

P

"−

Xk=1

W (xk, xk−1)

(∂θP + P ∂θ log Kθ) .

(101)

#

Higher order sensitivities can be obtained in a similar fashion.

The convergence with the Trotter number P of the path integral Monte Carlo estimates is
illustrated in Fig. 7 for the calculation of the ﬁrst ﬁve moments of the T = 40 yrs transition

(96)

(97)

(99)

23

Figure 7: Convergence with the Trotter number P of the normalization, and of the ﬁrst 4
moments of the 40 years transition density for the Cox-Ingerssol-Ross model. Parameters as
in Fig.3. In the ﬁrst top panels the relative error with respect to the exact result is reported.
Lines are quadratic ﬁts.

probability of the Cox-Ingersoll-Ross model (54). The ﬁnite P estimates converge very
rapidly with 1/P . In particular, for the case considered, P = 20 already provides estimates in
agreement with the exact result within statistical uncertainties. In general, as also shown in
the ﬁgure, a convenient indicator of the convergence is the zeroth-moment or normalization
of the distribution. The calculation of this quantity allows in general to assess the level
of convergence without performing a complete scaling with P , thus saving computational
time.

5 EXTENDING THE TIME STEP: GREEN’S FUNC-

TION BACKWARD INDUCTION

The Green’s function backward induction is a deterministic approach alternative to partial
diﬀerential equation methods, introduced in ﬁnancial context by Rosa-Clot and Taddei [10].
This is based on the path integral representation of standard contingent claims (73), that
we rewrite here for convenience as

E [GT (Yu)

Y0] .

|

24

(102)

Here GT is the payout functional dependent on the realization of the path of the underlying
up to expiry T , and Yt is the general process following the diﬀusion (1). As partial diﬀerential
methods, the Green’s function backward induction is eﬃcient for low-dimensional problems
but allows one to include naturally early exercise features in the contingent claim, i.e., to
treat expectation values of the form

where 0

τ

T is the stopping time of the process [11].

For standard contingent claims, Eqs. (73) and (74), the functional GT [Yu] can be dis-

≤

≤

cretized in the form,

max
τ

E [Gτ (Yu)]

GT [Yu]

g(i)(Yi).

N

≃

i=0
Y

and the conditional expectation value (102) is given by

E[GT [Yu]

Y0]

...

dYi g(N )(YN )

|

≃

Z

N

Z

i=1
Y

N

j=1
Y

˜ρ(Yj , tj |

Yj−1, tj−1),

(105)

where the function, ˜ρ, is

˜ρ(Yi, ti |

Yi−1, ti−1) = ρy(Yi, ti −

ti−1 |

Yi−1) g(i−1)(Yi−1) ,

(106)

Yi−1) is the transition probability associated with the process (1). This
and ρy(Yi, ti −
is the Green’s function of the partial diﬀerential equation associated with the calculation of
the expectation value (102), hence the name of the method.

ti−1 |

Let us now consider a single integration

dYi ˜ρ(Yi+1, ti+1 |

Yi, ti) ˜ρ(Yi, ti |

Yi−1, ti−1) .

Z

If we approximate this integral by using a numerical quadrature rule, we obtain the following
algebraic relation

where the matrices, ˜ρ (i), are deﬁned by

˜ρ (i)
αγ

˜ρ (i−1)

γβ

wγ ,

M

γ=1
X

˜ρ (i)
αβ = ˜ρ(zα, ti+1 |

zβ, ti),

the quantities, wα, and zα, are the weights and the grid points, respectively, associated with
In conclusion, the expression (105) can be
the integration rule, and α, β, γ = 1, . . . , M .
written as

E[GT [Y (τ )]

Y0 = zα]

|

M

≃

γ1,...,γN =1
X

G(0)

γ1α G(1)

γ2γ1 . . . G(N −2)

γN −1γN −2G(N −1)

γN γN −1 g(N )
γN

,

(110)

αβ = wα ˜ρ(i)

αβ, and g(N )

where G(i)
γN = g(N )(zγN ). Therefore, we have reduced the evaluation
of the expectation value of a functional to the product of N matrices with dimension M .
By starting the calculation from the right (backward induction), we need to memorize just
linear arrays, while the matrix elements, G(i)
αβ, can be computed step by step. In practice,
one can follow the following algorithm:

25

(103)

(104)

(107)

(108)

(109)

i. Set uα = g(N )

α

(α = 1, . . . , M ), and i = N

1.

−

ii. Set vα =

uβ G(i)

βα (α = 1, . . . , M ).

M

Xβ=1

iii. If i > 0 then set uα = vα (α = 1, . . . , M ), i = i

−
Here the arrays, uα, and vα, are two working vectors.

1, and go to ii.

The inclusion of early exercise features is completely straightforward and simply involves

the following steps:

i. Set uα = g(N )

α

(α = 1, . . . , M ), and i = N

1.

ii. Set w(i)

α = f (zα, ti), and vα = max

(α = 1, . . . , M ).

−

M





Xβ=1

uβ G(i)

βα , w(i)

α 



iii. If i > 0 then set uα = vα (α = 1, . . . , M ), i = i

1, and go to ii.

−

The only diﬀerence is in the point ii, where we have now a test operation, and the function
f (zα, ti) is the exercise value of the option.

The exponent expansion can signiﬁcatively speed up the Green’s function backward
induction presented above. In fact, as illustrated in the previous Sections, it allows one
ti−1) much
obtain reliable approximations of ˜ρ(Yi, ti |
larger than those that can be safely used with a simple Euler discretization. As a result,
one can reduce the discretization bias to acceptable levels with a much smaller number of
intermediate time steps N . The application of this procedure to local volatility models is
currently in progress and will be presented elsewhere [29].

for a time step (ti −

Yi−1, ti−1)

6 CONCLUSIONS

Closed-form approximations of non-liner diﬀusions are of primary importance in a variety
of ﬁelds of quantitative Finance. In Econometrics, they are crucial for an eﬃcient maximum
likelihood estimation of the parameters of continuous time processes. In derivative pricing,
they allow one to develop eﬀective approximation schemes or to improve the eﬃciency of
numerical approaches.

In this paper we have presented an eﬀective method to produce a family of closed-form
approximations of the transition probability of a general diﬀusion process. Such approxima-
tion, dubbed exponent expansion, is based on an exponential ansatz of the transition prob-
ability for a ﬁnite time interval ∆t, and a series expansion of the deviation of its logarithm
from that of a Gaussian distribution. Through this procedure the transition probability
is obtained as a power series in ∆t which becomes asymptotically exact if an increasing
number of terms is included, and provides remarkably accurate results even when truncated
to the ﬁrst few (say 3) terms. This approach can be easily implemented, and involves the
calculation of simple one dimensional integrals. In addition, it applies to a very wide class
of volatility functions, even to those that do not have a simple analytic expression but they
are speciﬁed through a numerical interpolation.

26

We have shown that the exponent expansion produces very accurate results for inte-
grable diﬀusions of ﬁnancial interest, like the Vasicek and the Cox-Ingersoll-Ross models.
In particular, we have compared our results with those obtained with the state-of-the-art
approximation of discretely sampled diﬀusions [7], that shares a similar rationale. We ﬁnd
that the exponent expansion provides a similar accuracy in most of the cases but it is
more stable in the low-volatility regimes. Furthermore the implementation of the exponent
expansion turns out to be simpler.

By introducing a path integral framework we have generalized the exponent expansion
to the calculation of the pricing kernels of ﬁnancial derivatives, and we have shown how
to obtain accurate approximations for the price of simple contingent claims. We have also
shown how the exponent expansion can be naturally used to increase the eﬃciency of both
deterministic and stochastic numerical simulations. A systematic study of the eﬃciency of
this approach for the pricing of exotic derivatives, and the calibration of local and stochastic
volatility models will be the object of future investigations.

Acknowledgments It is a pleasure to thank Gabriele Cipriani for sparking my interest
in the path integral approach to option pricing, and for continuous stimulating discussions. I
would also like to thank Marco Rosa-Clot for kindly sharing with me a series of unpublished
results.

References

[1] L. Bachelier, Theorie de la Sp´eculation, Annales de l’Ecole Normale Sup´erieure (1900).

[2] F. Black and M. Scholes, The Pricing of Options and Corporate Liabilities, Journal of

Political Economy 81 (1973) 637-45.

[3] R. C Merton, Theory of Rational Option Pricing, Bell Journal of Economics 4 (1973)

141-183.

[4] J.C. Cox, J.E. Ingersoll, and S.A. Ross, A Theory of the Term Structure of Interest

Rates, Econometrica 53 (1985) 385-408.

[5] B. Dupire, Pricing with a Smile, Risk 7 18-20 (1994).

[6] O. Vasicek, An equilibrium Characterization of the Term Structure, Journal of Finan-

cial Economics 5 (1977) 177-188.

[7] Y. A¨ıt Sahalia, Transition Densities for Interest Rate and Other Nonlinear Diﬀusions,

Journal of Finance 54 (1999) 1361-1395.

[8] N. Makri and W.H. Miller, Exponential Power Series Expansion for the Quantum Time

Evolution Operator, Journal of Chemical Physics 90 (1989) 904-911.

[9] M. Bennati, M. Rosa-Clot, and S. Taddei, A Path Integral Approach to Derivative
Security Pricing I: General Method and Analytical Results, International Journal of
Theoretical and Applied Finance 2 (1999) 381-407.

[10] M. Rosa-Clot, and S. Taddei, A Path Integral Approach to Derivative Security Pric-
ing II: Numerical Results, International Journal of Theoretical and Applied Finance 5
(2002) 123-146.

27

[11] S. E. Shreve, Stochastic Calculus for Finance (Springer-Verlag, New York, 2004).

[12] R. P. Feynman, Space-Time Approach to Non-Relativistic Quantum Mechanics, Review

of Modern Physics 20 (1948) 367-387.

[13] R. P. Feynman and A. R. Hibbs, Quantum Mechanics (McGraw-Hill, New York, 1965).

[14] G. Montagna, O. Nicrosini, and N. Moreni, A Path Integral Way to Option Pricing,

Physica A 310 (2002) 450-466.

[15] G. Bormetti, G. Montagna, N. Moreni, and N. Nicrosini, Pricing Exotic Options in a

Path Integral Approach, Quantitative Finance 6 (2006) 55-66.

[16] B.E. Baaquie, C. Corian`o, and M. Srikant, Hamiltonian and Potentials in Derivative
Pricing Models: Exact Results and Lattice Simulations, Physica A 334 (2004) 531-557.

[17] A. Matacz, Path Dependent Option Pricing:

the Path Integral Partial Averaging

Method, e.print arXiv:cond-mat/0005319 (2000).

[18] J. W. Dash, Quantitative Finance and Risk Management: a Physicist’s approach

(World Scientiﬁc, Singapore, 2004).

[19] J. C. Cox and S. A. Ross, The Valuation of Options for Alternative Stochastic Processes,

Journal of Financial Economics 3 (1976) 145-166.

[20] W. Feller, The Parabolic Diﬀerential Equations and the Associated Semi-Groups of

Transformations, Annals of Mathematics 55 (1952) 468-519.

[21] M. Abramovitz, I. A. Stegun, Handbook of Mathematical Functions (National Bureau

of Standards, Applied Mathematics Series, 1965).

[22] N. Makri and W.H. Miller, Correct Short Time Propagator for Feynman Path Integra-
tion by Power Series Expansion in ∆t, Chemical Physics Letters 151 (1989) 1-8.

[23] B. E. Baaquie, Quantum Finance (Cambridge University Press, 2004).

[24] V. Linetsky, The Path Integral Approach to Financial Modeling and Options Pricing,

Computational Economics 11 (1998) 129-163.

[25] L.S. Schulman, Techniques and applications of path integration (Wiley, New York,

1981).

[26] R.D. Coalson, On the Connection between Fourier Coeﬃcient and Discretized Cartesian

Path Integration, Journal of Chemical Physics 85 (1986) 926-936.

[27] N. Metropolis, A.W. Rosenbluth, M.N. Rosenbluth, H. Teller, and E. Teller, Equation
of State Calculations by Fast Computing Machines, Journal of Chemical Physics 21
(1953) 1087-1092.

[28] P. Glasserman, Monte Carlo Methods in Financial Engineering (Springer-Verlag, New

York, 2004).

[29] L. Capriotti, in preparation.

28

