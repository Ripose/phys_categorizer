7
0
0
2
 
n
a
J
 
0
3
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
5
3
3
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Diﬀusive behavior and the modeling of characteristic times in limit order executions

Zolt´an Eisler,1, ∗ J´anos Kert´esz,1, 2 Fabrizio Lillo,3, 4 and Rosario N. Mantegna3
1Department of Theoretical Physics, Budapest University of Technology and Economics, Budapest, Hungary
2Laboratory of Computational Engineering, Helsinki University of Technology, Espoo, Finland
3Dipartimento di Fisica e Tecnologie Relative, Universit`a di Palermo, Viale delle Scienze, I-90128, Palermo, Italy
4Santa Fe Institute, 1399 Hyde Park Road, Santa Fe, NM 87501, USA
(Dated: September 22, 2013)

We present a study of the order book data of the London Stock Exchange for ﬁve highly liquid
stocks traded during the calendar year 2002. Speciﬁcally, we study the ﬁrst passage time of order
book prices needed to observe a prescribed price change ∆, the time to ﬁll (TTF) for executed limit
orders and the time to cancel (TTC) for canceled ones. We ﬁnd that the distribution of the ﬁrst
passage time decays asymptotically in time as a power law with an exponent λFPT ≈ 1.5. The
median of the same quantity scales as ∆1.6, which is diﬀerent from the ∆2 behavior expected for
Brownian motion. The quantities TTF, and TTC are also asymptotically power law distributed
with exponents λTTF = 1.8 − 2.2 and λTTC = 1.9 − 2.4, respectively. For the medians of the time to
ﬁll we observe a scaling proportional to ∆1.4. We outline a simple model, which assumes that prices
are characterized by the empirically observed distribution of the ﬁrst passage time and orders are
canceled randomly with lifetimes that are asymptotically power law distributed with a power λLT.
The model predicts λTTF = λTTC and we estimate from empirical data λLT ≈ 1.6. We verify that
the observed results are not crucially dependent on simplifying assumptions.

Keywords: Econophysics, Limit order book, First passage time, Brownian motion, Time to ﬁll

I.

INTRODUCTION

Price formation, the trading process and the consequences of market organization are classical areas of investigation
in the modeling of market microstructure [1]. A large number of studies have been focusing on modeling the dynamics
of a limit order book, with and without specialists, in ﬁnancial markets. They comprise both theoretical [2, 3, 4, 5, 6, 7]
and empirical studies [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22] devoted to the search for the determinants
of several key aspects of price formation, trading process and market organization. These are extremely diﬃcult
problems, and their studies can contribute greatly to the success of the modeling of ﬁnancial markets. The market
mechanism, along with the complex interactions among market participants result in the emergence of a collective
action of continuous price formation.

Some of the studies have also used an agent based modeling approach. Examples are market models described in
terms of agents interacting through an order book by using simple rules [23] and models where the assumptions about
the trading strategies are kept as minimal as possible (see for example Refs. [6, 20]). One of the most striking ﬁndings
was that even if trends and investor strategies are neglected, purely random trading may be adequate to describe
certain basic properties of the order book [19].

In this paper, we take an empirical approach: We ﬁrst demonstrate that some aspects of the order book dynamics
are consistent with theoretical predictions obtained by assuming a random process with independent identically
distributed and symmetrical increments. In particular, we focus on the diﬀerence observed between the time to ﬁll a
limit order, which is the time one has to wait before a limit order is executed, and the ﬁrst passage time [24], i.e., the
time elapsed between an initial instant and the time when the transaction price crosses a given predeﬁned threshold.
We observe that for a ﬁxed price change the ﬁrst passage time distributions of transaction price, best bid and best
ask are quite well described by the theoretical prediction expected for a Brownian motion [24] or for any Markov
process with symmetric jump length distribution [25] as it can be expected on the basis of the Sparre-Andersen
theorem [26].

The empirical time to ﬁll of the corresponding order is smaller than this value. We attribute this discrepancy
to canceled and expired orders. By proposing a simple model we are able to predict some constraints about the
asymptotic functional form of the time to ﬁll and time to cancel probability densities. The simple model also allows
us to estimate the degree of heterogeneity in the time horizons of diﬀerent limit orders submitted to the market. We

∗Electronic address: eisler@maxwell.phy.bme.hu

2

numerically test that one restrictive assumption of the model – although it is not consistent with real data – does not
invalidate the main results obtained.

The paper is organized as follows. In Section II we describe the investigated market and the variables of interest.
In Section III we study the ﬁrst passage time and in Section IV the time to ﬁll and the time to cancel. Section V
describes a simple limit order model and in Section VI we discuss the empirical testing of the model. Section VII
discusses the validity of one key assumption, namely random cancellation, whereas Section VIII extends the result to
limit orders placed inside the spread. Finally Section IX concludes.

II. THE ORDER BOOK

The empirical analysis presented in this study is based on the trading data of the electronic market (SETS) of
London Stock Exchange (LSE) during the year 2002. We investigate 5 highly liquid stocks, AstraZeneca (AZN),
GlaxoSmithKline (GSK), Lloyds TSB Group (LLOY), Shell (SHEL), and Vodafone (VOD). Opening times of LSE
are divided into three periods. The intervals 7:50–8:00 and 16:30–16:35 are called the opening and the closing auction,
respectively. These follow diﬀerent rules and thus also observe diﬀerent statistical properties than the rest of the
trading. Therefore we discarded limit orders placed during these times, and focused only on the periods of continuous
(double) auction during 8:00–16:30. We also removed limit orders that were placed during 8:00–16:30 but were canceled
(or expired) during the opening/closing auctions. We measure time intervals in trading time, i.e., we discard the time
between the closing and the opening of the next day.1 Finally, whenever we refer to prices, unless stated otherwise,
we exclude all transactions that were executed on the SEAQ market2 and not by means of the limit order book.

The limit order book is a mechanism that is used to organize the market, it is basically a database of buy and sell
limit orders, i.e., oﬀers to buy or sell a given volume of a certain asset at a predetermined price. The limit orders with
better prices are executed ﬁrst, while those with the same price are executed in the order of their placement. The
highest price to buy is usually called the best bid price b(t), and the lowest price to sell the best ask price a(t). The
distance between the two is called the bid-ask spread s, s(t) = a(t)

b(t).

−

Except for very special cases, there are already other limit orders waiting inside the book when one wants to place
a new one. Let b(t)
∆ denote the price of a new buy limit order, and a(t) + ∆ the price of a new sell limit order. The
mechanism of limit order placement is illustrated in Fig. 1. Let us take buy orders for example. An incoming buy
order can be placed in three regimes with respect to the distance ∆ from the current best: (i) exactly at the existing
best bid price, ∆ = 0, (ii) at a better (higher) price, ∆ < 0, this means that the order is placed inside the spread,
(iii) or at a lower price, ∆ > 0 below the current best bid/ask, deeper ”inside the book”. For sell orders one can give
analogous deﬁnitions. Any limit order which was not executed can be canceled at any time by the trader who placed
it. The order can also have a predetermined validity after which it is automatically removed from the book, this is
called expiration.

−

There exists another type of orders called market orders, these are characterized by a given volume and the traded
asset, but they have no preﬁxed price. Instead, they are requests to buy/sell immediately at the best price available
It is also possible to have limit orders with such large
from counterparties with currently standing limit orders.
negative values of ∆ that they cross the spread, i.e., ∆ < b(t)
a(t). These orders are called crossing orders, and
they can be immediately paired with orders from the other side of the book. Given that enough volume of opposite
limit orders is available, they are fully executed right away. Otherwise the unmatched part of the crossing limit order
remains in the book as a new limit order. Since a trader would place a crossing limit order to execute part of it
immediately, we will not consider them as limit orders in our analysis.

−

Throughout the paper we will use ticks as units of price and all logarithms are 10-base. We treat buy and sell
orders together because we do not ﬁnd a signiﬁcant diﬀerence between their behavior, in contrast with Ref. [15] for
[17] for the case of Ericsson stock traded at the Stockholm Stock Exchange.
US markets but in analogy with Ref.
We therefore are not able to conclude whether the symmetric behavior we observe in the London Stock Exchange is
common to most markets or speciﬁc to some of them or to certain time periods.

Finally, let us point out that in most of the literature the logarithm of the price is modeled, while throughout the
paper we intentionally use price itself. Our study is concerned with very small price changes on the order of the
spread, when there is little discrepancy between the two approaches. However it is important to keep bare prices,
as stocks have a ﬁnite tick size (minimal price change). Taking a log-transformation would mean that the minimal

1 In our analyses, we removed the data of trading on September 20, 2002. This is because on that day very unusual trading patterns were

observed, including an anomalous behavior of the bid-ask spread.

2 Many studies refer to this colloquially as the ”upstairs” market.

3

(1)

(2)

sell

orders

 > 0

current ask

 = 0

sell

new

orders

bid-ask

spread

e
c
i
r
p

current bid

 = 0

new

buy

orders

 < 0

 < 0

 > 0

buy

orders

 volume

Figure 1: The schematic structure of the limit order book. Buy limit orders are placed at lower, sell limit orders at higher
prices. The regime between the highest buy and lowest sell oﬀer is the bid-ask spread. The placement of a new incoming limit
order can be characterized by the ∆ distance from the best oﬀer on the same side of the book. ∆ = 0 for an order which is
placed at the price of the current best oﬀer. We deﬁne ∆ < 0 for orders that were placed inside the spread, and ∆ > 0 which
are placed inside the bulk of previous orders.

increment would depend on the price itself. Omitting the transformation will enable us to classify the orders into
discrete categories by price diﬀerence. The size of ticks depends on the stock, the possible values at are 1/4, 1/2 or 1
penny.

III. THE FIRST PASSAGE TIME

Let the price of an asset at time t = 0 be S0. The ﬁrst passage time [24] of price through a prescribed level S0 + ∆
S0 + ∆. Then we repeat the same analysis for
∆. We will call the distribution of the quantity t the ﬁrst passage time distribution to a distance ∆,

for a ﬁxed distance ∆ > 0 is deﬁned as the ﬁrst time t when S(t)
the level S0 −
and denote it by PFPT;∆(t).

≥

Such ﬁrst passage processes have been studied extensively [26]. For the following analysis of empirical data, it is
useful to review the ﬁrst passage time distribution for a Brownian motion. If the standard deviation for the price
changes during a unit time (i.e., the volatility) is σ, then [24]

PFPT;∆(t) =

∆
√2πσ2

−3/2 exp

t

∆2
2σ2t

,

(cid:19)

−

(cid:18)

which is the fully asymmetric 1/2-stable distribution. For any ﬁxed ∆ the asymptotics for long times is

PFPT;∆(t)

−3/2.

t

∝
A recent study [25] has clariﬁed that this asymptotic behavior is valid not only for Brownian motion but also for
any Markov process with symmetric jump length distribution. This result is consistent with the Sparre-Andersen
theorem [26]. Alternative descriptions obtained for the asymptotic time dependence of the FPT of L´evy ﬂights
which were hypothesizing a dependence of the distribution exponent from the index of the L´evy distribution have
missed the fact that the method of the images, which is extremely powerful in Gaussian diﬀusion, fails for L´evy ﬂight
processes [25]. The behavior is of course more complex in the case of L´evy random processes described by using a
subordination scheme. In these cases the ﬁrst passage time asymptotic behavior depends on the complete properties
of the subordination procedure [27].

Not only price changes are not described by continuous values, but transactions and order submissions are also
separated by ﬁnite waiting times, which a continuous time random walk formalism could take into account [28, 29].

4

(3)

(4)

λ

T

λ

stock

∆ = 2
λ′

∆ = 1
λ′

∆ = 4
λ′
T
350
AZN 1.50 0.14 58 1.50 0.22 140 1.50 0.18 240 1.49 0.11
GSK 1.52 0.16 62 1.52 0.18 230 1.50 −0.02 390 1.48 −0.21 520
LLOY 1.54 0.22 85 1.55 0.20 280 1.53 0.01 460 1.51 −0.12 630
SHEL 1.52 0.20 83 1.53 0.27 160 1.51 0.02 360 1.51 0.00
450
VOD 1.57 0.43 150 1.54 −0.19 450 1.49 −0.69 720 1.51 −0.66 1500

∆ = 3
λ′

λ

λ

T

T

Table I: Parameters of the ﬁtting function (3) for the distribution of ﬁrst passage time for the ﬁve stocks. ∆ is measured in
′
ticks and all times are given in seconds. Typical standard errors for the quantities: ±0.05 for λFPT, ±0.05 for λ
FPT, and ±10%
for TFPT.

However, in this paper we are mainly interested in relatively long time intervals as compared to these waiting times,
so the discrete aspects of the dynamics are negligible. Thus, we will model prices as if they varied continuously in
time.

Let us now investigate empirically the ﬁrst passage time behavior. The ﬁrst passage time distribution for the
transaction price,3 bid and ask when ∆ = 1 tick is shown in Fig. 2 for the stock GSK. The distribution is obtained by
sampling the ﬁrst passage time at each second. One can see that there are no signiﬁcant diﬀerences in the behavior
of the three quantities. Qualitatively, the distribution is similar to Eq. (1), and the long time asymptotic of real data
seems to decay approximately as t−3/2. For times shorter than 1 minute the curves signiﬁcantly deviate from the
power law. We choose to ﬁt the ﬁrst passage time distribution with the function

PFPT;∆(t) =

Ct−λFPT
1 + [t/TFPT(∆)]−λFPT+λ′

.

FPT

This form, that we will use to ﬁt also the other distributions introduced below, is characterized by two power
TFPT(∆) it is

law regimes. Normalization conditions of Eq. (3) imply that λFPT > 1 and λ′
PFPT;∆(t)

TFPT(∆) it is PFPT;∆(t)

FPT < 1. For t

t−λFPT .

t−λ

≪

′
FPT , whereas for t
Table I contains the ﬁtted parameters λFPT, λ′

≫

∝

FPT, and TFPT(∆) for ∆ = 1, . . . , 4 ticks. The diﬀerence between
the actual values of λFPT and 3/2 known for Brownian motion or for any Markov process with symmetric jump
length distribution is small. Other values would be possible due to clustered volatility but we ﬁnd no evidence for a
systematic deviation.

∝

Given the level of noise in the sample, these arguments are not meant as conclusive evidence in favor of the form
proposed in Eq. (3). In several parts of the paper it will be enough that for large times PFPT is well approximated by
a power law. According to Fig. 2, for ∆ = 1 tick we are in this regime when t is at least a few minutes. Finally, the
inset of Fig. 2 shows the median ﬁrst passage time as a function of ∆ for the ﬁve investigated stocks. The behavior is
not exactly quadratic (∆2) as one would expect from Eq. (1). If prices followed a Brownian motion, the q-th quantile
(Tq) of the ﬁrst passage time distribution would be

Tq =

∆2
2σ2[erfc

,

−1(q)]

where the median (M [FPT]) corresponds to q = 0.5. Instead, the power law behavior with ∆ is not always evident
∆η would require an exponent varying between 1.5 and
in the inset of Fig. 2 and assuming a behavior M [FPT]
∝
1.8 depending on the speciﬁc stock and the precise ∆ interval used for the estimation of η. A similar deviation from
the prediction for the Brownian motion was reported in Ref. [30] in the analysis of closure index values sampled at a
daily time horizon.

We have also veriﬁed the role of the inclusion of SEAQ transactions in the determination of the η exponent. By
considering time series including the SEAQ transactions, the exponent η assumes values within the range 1.7
1.9.
This discrepancy might be due to deviation from the Gaussian assumption, to superdiﬀusive behavior of price or to
both. We have performed a series of shuﬄing experiments and preliminary results support the conclusion that the
main role is played by the deviation from Gaussianity. This non-Gaussianity is well documented in the literature
down to the scale of single transactions [18, 31]. Moreover, the scaling exponent of the ﬁrst passage time of L´evy

−

3 The reader is reminded that we only consider here transactions that take place through the order book, but not the SEAQ ”upstairs”

market.

5

)
T
P
F
(
P

-1

-2

-3

-4

-6

-7

10

10

10

10

10

10

10

10

-9

10

 price,  =1

 bid,  =1

 ask,  =1

 Brownian

 fit of Eq. (6)

-5

6

10

slope 2.0

slope -1.5

5

10

4

10

3

10

 

T
P
F
n
a
d
e
m

i

 AZN

 GSK

 LLOY

 SHEL

 VOD

-8

2

10

slope 1.5

0

1

2

10

10

10

 (ticks)

-1

0

1

2

3

4

5

6

10

10

10

10

10

10

10

10

FPT (sec)

Figure 2: First passage time distributions for the price, bid and ask quotes of GlaxoSmithKline (GSK), distance ∆ = 1 tick.
−1/2. The thick
The dotted line is the ﬁrst passage time distribution for Brownian motion with volatility σ = 1/7 penny× sec
solid line is a ﬁt with Eq. (3) as given in Table I. The inset shows the median ﬁrst passage time as a function of ∆.

ﬂights with the variable ∆ can be expected to be diﬀerent from 2 and related to the index of the L´evy distribution
[32]. At the present stage these observations and theoretical interpretations are preliminary and further investigations
are needed to clarify this discrepancy.

IV. TIME TO FILL, TIME TO CANCEL

As noted in Section II, the life of every limit order ends with either execution or deletion. In this latter case deletion
can be due to intentional cancellation or to expiration, but we will not distinguish between these mechanisms and we
will call both of them cancellation. For an executed order the elapsed time between its placement and its complete
execution is called time to ﬁll. Orders are often not executed in a single transaction, thus one can independently deﬁne
time to ﬁrst ﬁll, which is the time from order placement to the ﬁrst transaction this order participates in. Finally, for
canceled orders one can deﬁne the time to cancel which is the time between order placement and cancellation. The
distribution of these three quantities will be in the following denoted by PTTF(t), PTTFF(t), and PTTC(t), respectively.
By the nature of trading, limit orders with small ∆, especially ones with large negative values, are executed earlier.
In most of the paper we will only concern orders where ∆ > 0. Then, Section VIII will deal with the generalization
to ∆

0.

≤

A. Distributional properties

As a ﬁrst characteristic of the order book, we investigate the distribution of time to ﬁll and time to cancel for the
stocks in our dataset. Fig. 3 shows these distributions for the stock GlaxoSmithKline (GSK) for diﬀerent values of
∆. Similarly to ﬁrst passage time, we ﬁtted the empirical density with the functional form

PTTF;∆(t) =

C′t−λTTF
1 + [t/TTTF(∆)]−λTTF+λ′

.

TTF

(5)

Table II shows the results for all ﬁve stocks. We found that λTTF, which gives the asymptotic behavior of the
distribution, ranges between 1.8 and 2.2 for up to ∆ = 4 ticks. This ﬁnding is in contrast with the value 1.5 obtained
in Ref. [14] for the limit order data of a pool of stocks traded at NASDAQ. We have no explanation for this discrepancy.
The exponent λ′
0.4 and 0.6. Finally TTTF typically grows with larger ∆, orders placed deeper
into the book are executed later. We will return to this observation in Section IV C. For higher values of ∆ the small
number of limit orders in our sample does not allow us to make reliable histograms or give robust estimates for the
shape of the distribution. Fig. 3 also gives a comparison of four further stocks (AZN, LLOY, SHEL and VOD) to
show that our ﬁndings are quite general. The distribution of time to ﬁrst ﬁll is indistinguishable from time to ﬁll [33].

TTF varies between

−

)

C
T
T
(
P

)

C
T
T
(
P

-1

10

-2

10

-3

10

-4

10

-5

10

-6

-7

-8

10

0

-1

-2

-3

-4

-5

-6

-8

-9

10

10

10

10

10

10

10

10

10

-1

-2

-3

-4

-5

-6

-7

-8

-9

-1

-2

-3

-4

-5

-6

-7

-8

-9

10

10

10

10

10

10

10

10

10

10

10

10

10

10

10

)
F
T
T
(
P

)
F
T
T
(
P

6

’

TTF

’

TTC

 

 = 1 tick

 

 = 1 tick

10

 

 = 2 ticks

10

 

 = 2 ticks

TTF

TTC

 

 = 3 ticks

 

 = 3 ticks

10

 

 = 4 ticks

10

 

 = 4 ticks

 slope -2.0

 slope -2.0

0

1

2

3

4

5

0

1

2

3

4

5

10

10

10

10

10

10

10

10

10

10

10

10

TTF (sec)

TTC (sec)

’

TTF

10

’

TTC

 AZN, 

 = 1 tick

 AZN, 

 = 1 tick

 LLOY, 

 = 1 tick

TTF

-7

 LLOY, 

 = 1 tick

TTC

 SHEL, 

 = 1 tick

 SHEL, 

 = 1 tick

10

 VOD, 

 = 1 tick

 VOD, 

 = 1 tick

 slope -2.0

 slope -2.0

0

1

2

3

4

5

0

1

2

3

4

5

10

10

10

10

10

10

10

10

10

10

10

10

TTF (sec)

TTC (sec)

Figure 3: Top left: distribution of time to ﬁll of GSK for ∆ = 1 . . . 4 ticks, and ﬁts with Eq. (5). The dashed line is a power law
with exponent −2.0. Top right: distribution of time to cancel of GSK for ∆ = 1 . . . 4 ticks, and ﬁts with Eq. (6). The dashed
line is a power law with exponent −2.0. Bottom left: comparison of distributions of time to ﬁll for three typical stocks, ∆ = 1
tick, and ﬁts with Eq. (5). The dashed line is a power law with exponent −2.0. Bottom right: comparison of distributions of
time to cancel for three typical stocks, ∆ = 1 tick, and ﬁts with Eq. (6). The dashed line is a power law with exponent −2.0.

For time to cancel one ﬁnds a similarly robust behavior, also shown in Fig. 3. The respective distribution again

decays as a power law and it is well ﬁtted by the form

PTTC;∆(t) =

C′′t−λTTC
1 + [t/TTTC(∆)]−λTTC+λ′

,

TTC

(6)

where the long time asymptotic has an exponent λTTC ranging between 1.9 and 2.4. Diﬀerently from the case of λTTF
previously discussed, the measured values of of λTTC are in agreement with those measured in Ref. [14] for the limit
order data of a pool of stocks traded at NASDAQ. All results concerning the time to cancel are given in Table III.

B. Comparison of characteristic times

The emphasis of this paper is on the interplay between order execution, order cancellation and the ﬁrst passage
properties of price. To understand this relationship, consider the following argument proposed in Ref. [15]. Imagine
that there are no cancellations. Let a buy order be placed at the price b0 −
∆, when the current best bid is at b0.
How much time does it take until this order is executed? It is certain that the order cannot be executed before the
∆, because until then there will always be more favorable oﬀers in the book. On the other
best bid decreases to b0 −

Table II: Parameters of the ﬁtting function (5) for the distribution of time to ﬁll for the ﬁve stocks and ∆ ≥ 0 ticks. All
times are given in seconds. Data are missing where the statistics was inadequate for ﬁtting. Typical standard errors for the
quantities: ±0.1 for λTTF, ±0.1 for λ

′
TTF, and ±10% for TTTF.

stock

∆ = 0
λ λ′ T

∆ = 1
λ′

∆ = 2
λ′

∆ = 3
λ′

∆ = 4
λ′

T

λ

λ

T
AZN 2.2 0.6 110 2.0 −0.0 65 1.9 0.0 100 1.8 −0.0 120 1.9 0.0 200
GSK 2.2 0.5 110 1.9 −0.2 68 1.9 −0.2 150 1.8 −0.4 190 1.8 −0.3 320
LLOY 2.2 0.5 120 2.0 −0.1 85 1.9 −0.1 160 1.9 −0.2 240 1.9 −0.2 350
SHEL 2.2 0.4 110 1.9 −0.1 77 1.9 −0.2 110 1.9 0.0 270 1.8 −0.1 250
VOD 2.1 0.5 160 1.8 −0.4 190 1.8 −0.5 490 1.8 −0.4 980 –
–

λ

T

λ

T

–

stock

∆ = 0
′

∆ = 1
′

∆ = 2
′

∆ = 3
′

T

T

λ λ

λ λ

λ λ
AZN 2.3 0.6 130 2.2 0.6 87 2.2 0.6 90 2.2 0.6 85 2.2 0.7 100
GSK 2.1 0.6 130 2.2 0.5 110 2.0 0.5 90 1.9 0.5 94 1.9 0.6 170
LLOY 2.2 0.5 120 2.3 0.5 130 2.2 0.4 140 2.0 0.4 120 2.0 0.5 250
SHEL 2.3 1.0 220 2.4 1.1 150 2.3 1.1 140 2.3 1.1 68 2.2 1.0 56
VOD 2.0 0.7 200 2.0 0.9 300 2.1 0.8 1000 2.2 0.6 1500 1.9 0.5 1000

λ λ

λ λ

T

T

T

∆ = 4
′

Table III: Parameters of the ﬁtting function (6) for the distribution of time to cancel for the ﬁve stocks and ∆ ≥ 0 ticks. All
times are given in seconds. Data are missing when there were no orders at all, or the statistics was inadequate for ﬁtting.
Typical standard errors for the quantities: ±0.1 for λTTC, ±0.1 for λ

′
TTC, and ±25% for TTTC.

hand, once the price decreases to b0 −
ǫ where ǫ is the tick size of the stock, it is certain, that all possible oﬀers
∆ have been exhausted, including ours. Therefore both time to ﬁll and time to ﬁrst ﬁll for any order
at the price b0 −
(a similar argument can be given for sell orders) placed at a distance ∆ from the best oﬀer is greater than the ﬁrst
passage time of price to a distance ∆, and less than that to ∆ + ǫ. Since this is true for every individual order, one
expects the following inequality for the distribution functions of characteristic times:

∆

−

t

PFPT;∆(t

)dt

′

′

t

PTTF;∆(t

)dt

′

′

t

PTTFF;∆(t

)dt

′

′

0
Z
Using the empirical distributions above, a straightforward calculation yields

0
Z

0
Z

≥

≥

t

≥

0

Z

PFPT;∆+ǫ(t

)dt

.

′

′

λFPT = λTTFF = λTTF

(wrong!),

λTTFF. This inequality for the
which is in clear disagreement with the data, where pronouncedly λFPT < λTTF ≈
tail exponents means that one ﬁnds less orders with very long time to (ﬁrst) ﬁll than expected. The solution of this
apparent contradiction is the presence of cancellations: Orders which would have a too long time to wait until being
executed are often canceled and thus removed from the statistic. The problem is that this argument is only qualitative,
and it tells us nothing about the behavior of cancellation times. Actually, the measurement of the cancellation time
distribution suﬀers from the same bias. The observed distribution of time to cancel does not characterize how traders
actually cancel their orders, because from that statistic it is the executed orders that are missing. In fact, one can
infer very little directly from PTTC about how orders are canceled.

In Section V we will present a simple model that gives insight into the features pointed out so far. However, before

doing so, we would like to present one further point concerning the empirical data.

C. The role of entry depth

How do order execution times change as a function of the entry depth ∆? Before answering the question, let us
remark on a caveat: The distributions found above imply that the mean of time to ﬁll/cancel might diverge, because
the distributions decay very slowly. Therefore, in the following we will use the medians of all quantities as a measure
of their typical value.

In Fig. 4 we show that the median of time to ﬁll is empirically well described by

∆2, which would be expected naively from Eq. (4) and a Brownian
a behavior which is quite diﬀerent from M [TTF]
motion assumption. An explanation for this discrepancy can be broken down into steps based on Fig. 4(left), which

∝

M [TTF]

∆1.4,

∝

7

(7)

(8)

(9)

8

summarizes the ∆-dependence of several quantities. In the following we will use the stock GSK as a representative
example, but qualitatively the same arguments hold for other stocks as well.

Let us ﬁrst make a surrogate experiment for GSK, which is similar to the calculation of time to ﬁll. We select all
ﬁlled orders, and from the time of their placement we calculate the ﬁrst time when the transaction price becomes
equal to or better than the price of the order. If one plots the median of this quantity versus the ∆ of the orders, the
resulting curve is indistinguishable from the median of time to ﬁll [curve labeled as ”TTF/FPT ﬁlled ord”]. Because
of this, we can also think of time to ﬁll as a ﬁrst passage time measurement for executed orders only. For these time
to ﬁll surrogates multiple sources can contribute to their non-diﬀusive behavior. There are several statistical biases:
due to the exclusion of canceled orders (A), because ∆ is correlated with volatility (B), and also because the number
of incoming limit orders is correlated with volatility (C). The exclusion of the ”upstairs” market transactions may also
play a role (D).

First of all, for any ∆ clearly M [TTF] is smaller than M [FPT] for the price, which supports our above statements
concerning bias (A) due to cancellations [the two curves we refer to are labeled as ”TTF/FPT ﬁlled ord.” and ”FPT,
price (book only)”]. So how do we eliminate these biases?

We can make another surrogate in a similar way as before, but including all orders, not only the ﬁlled ones to
eliminate bias (A). Moreover, to destroy correlations between volatility and order placement, we shuﬄe the ∆ values
between orders. We end up with the following dataset: Every time an order is placed, for buy orders we introduce a
marker at the current best bid minus ∆ (or at best ask plus ∆ for sell orders), where due to the shuﬄing ∆ is drawn
randomly from its empirical distribution. Then we measure the time it takes for price to reach the marker (this time is
labeled as ”FPT shuﬀ. all ord”). This new curve now agrees with the ﬁrst passage time of price with upstairs trading
excluded, but still only when ∆ > 8 ticks, which corresponds to a median time of about 1
2 hours [labeled as ”FPT
shuﬀ. all ord.” and to be compared with ”FPT, price (book only)”]. The reason is simple: We are not sampling the
ﬁrst passage process uniformly in time, which refers to bias (C). We place a marker every time an order was placed,
so periods with many incoming limit orders are oversampled. If we change to sampling every second, we recover the
ﬁrst passage time for order book transactions [line labeled as ”FPT, price (book only)”].

−

We can also include upstairs trades (D) [line labeled as ”FPT, price (upst.

incl.)”]. The ﬁrst passage time of
∆1.9 for GSK. The exponents for the other four stocks
this price now follows the approximate relation M [FPT]
∝
vary between 1.7 and 1.9, which are closer to, but consistently less than 2 expected for Brownian motion. As already
noticed, this behavior is similar to the one detected in Ref. [30] in the investigation of the daily closures of a detrended
version of the Dow Jones Industrial Average.

In summary, the most signiﬁcant bias is (A), the presence of canceled orders. Once this is accounted for, the other
curves have at least qualitatively similar behavior, and for ∆ > 20 they become indistinguishable. This price change
corresponds to a median FPT of about one trading day.

The dependence of time to cancel on the entry depth ∆ has a less clear functional form, as shown by Fig. 5. While
M [TTC] appears to be a monotonically increasing function of ∆, the curves for the diﬀerent stocks show only a
qualitative similarity. The reason is probably the non-trivial dependence of order lifetimes on ∆. Here we have no a
priori expectation such as the quadratic form for the ﬁrst passage times.

V. A SIMPLE MODEL

In this section we present a simple model of limit order placement and cancellation.4 We will see that the model
gives falsiﬁable predictions that can be tested against real data. Moreover, it also gives indications on the statistical
properties of a quantity that is directly unobservable: the lifetime an agent gives to a limit order. We do not suggest
a detailed microstructure of any kind, but rather the following assumptions:

1. We consider one ”agent”. At time t = 0 the agent places a single buy5 limit order at a ∆ > 0 distance from
the current best oﬀer. We treat all the other agents on an aggregate level, which we will call ”the market”. The
spirit of this assumption is similar to a ”mean ﬁeld” approximation in physics.

2. The agent is not willing to wait indeﬁnitely for the order to be executed. Instead, at the time of placement
the agent also decides about a cancellation (or more appropriately expiration) time t′ for the order. This is a
value drawn randomly from the distribution PLT;∆(t′). We will call this function the lifetime distribution. If

4 Ref. [34] shows that similar arguments give a very good approximation for the average shape of the order book.
5 Note that throughout the paper we use the language of buy orders, but analogous deﬁnitions can be given for sell orders. All measurements

include both buy and sell orders.

slope 1.9

 AZN

slope 2.0

9

)
c
e
s
(
 
n
a
d
e
m

i

5

10

4

10

3

10

2

10

 LLOY

 SHEL

 VOD

6

10

5

10

4

10

3

10

2

10

)
c
e
s
(
 
F
T
T
n
a
d
e
m

 

i

 FPT, price (book only)

 FPT, price (upst. incl.)

 TTF/FPT filled ord.

slope 1.4

 FPT, shuff. all ord.

0

1

2

0

1

2

10

10

10

10

10

10

 (ticks)

 (ticks)

slope 1.4

Figure 4: Left: The dependence of characteristic times on the entry depth ∆ for GSK. Empty squares show time to ﬁll, the
curve for the surrogate ﬁrst passage time assigned to ﬁlled orders is indistinguishable from this one. The dotted lines are
M [·] ∝ ∆1.4 and M [·] ∝ ∆1.9. Right: The dependence of median time to ﬁll on the entry depth ∆ for four stocks. The curves
show a strong similarity and they are signiﬁcantly better ﬁtted by M [TTF] ∝ ∆1.4 than by the naive ansatz M [TTF] ∝ ∆2
from Brownian motion.

 AZN

 GSK

 LLOY

 SHEL

 VOD

4

10

3

10

2

10

1

10

)
c
e
s
(
 

 

C
T
T
n
a
d
e
m

i

0

1

2

10

10

10

 (ticks)

Figure 5: The dependence of median time to cancel on the entry depth ∆ of the limit order. The curves have an increasing
tendency and they are qualitatively similar across stocks. However, they do not follow any obvious functional form.

the order is not executed until t′, then the order is canceled. The agent has no additional cancellation strategy.
This assumption makes cancellations eﬀectively independent from price changes.

3. The market is very liquid and tick sizes are small. As a consequence,

(a) before its execution, the eﬀect of the agent’s limit order on the evolution of the market price is negligible.

(b) the time between when the best bid reaches the order price and when the agent’s order is executed is

negligible.

(c) such immediate execution happens regardless of the volume of the order

These assumptions seem very restrictive, hence the next part of this section is devoted to motivating them (we keep
the above scheme of numbering).

1. Our agent should be considered as a typical investor, or ”representative agent” [35].

In reality, the typical
investor does not exist, as trading strategies are very heterogeneous. Mixing together a range of strategies often

10

(10)

leads to the recognition that the ﬁnal average no more resembles any individual market participant [36]. Thus
when we analyze all limit orders regardless of who placed them (because such information is not available), our
conclusions will also only apply on this aggregate level. As for the restriction ∆ > 0, for simplicity we only
consider here such orders, and return to the ∆

0 case in Section VIII.

≤

2. The cancellation process is an essential part of the model. Ref.

[20] ﬁnds that the per tick probability of an

order being canceled is of the form

exp

K1

1
(cid:20)

−

∆(t)
∆(0)

−

,

(cid:18)
where ∆(t) is the diﬀerence between the limit order price and the price of the opposite best at time t. ∆(0) is
this diﬀerence when the limit order was placed, so that ∆(0) is equal to ∆ plus the spread at time t = 0. It is
a very crude assumption to say instead that traders decide about the expiry time of the limit orders when they
place them, and do not cancel them otherwise. Nevertheless, this will not aﬀect the quantities we are interested
in, see Section VII for more detail.

(cid:19)(cid:21)

3. High liquidity and small relative tick sizes (minimal price change divided by stock price) do not hold for every
stock. It has been pointed out by several studies that small liquidity [37, 38] or too large tick sizes [20, 34] can
have a great impact on the microstructural properties of prices and limit order books. This is the reason why
we included in our study SHEL and VOD which are known to have large tick/price ratios. Contrary to our
expectations, we did not ﬁnd any indication of anomalies, and the model proved valid for all ﬁve stocks.

(a) Before its execution, a limit order by deﬁnition has no direct impact on price formation. There is an indirect
eﬀect however. The appearance of a new, large limit order introduces signiﬁcant new information about
the state of the market that was previously hidden from traders. They may become more cautious, or try
to take advantage of such disclosed demand/supply, even if it is not at the current best price. This leads to
a hide-and-seek game of traders. Informed traders are trying to conceal their information (and thus their
excess demand/supply) to decrease their losses due to the price impact of their trades. Meanwhile, others
are trying to infer this knowledge to increase their own proﬁt from providing them liquidity. This is the
main motivation behind strategic order splitting. While we fully acknowledge their existence, our model
cannot take such eﬀects into account [39, 40, 41].

(b) When a transaction is set at a given price, it does not necessarily mean that all limit orders at that price
are executed immediately. Moreover, even that limit order may possibly be only partially executed. A
simple way to motivate that the volume present at a given price does not strongly aﬀect execution times
is to measure the typical ratio between time to ﬁll and time to ﬁrst ﬁll as a function of the volume of the
order. Fig. 6 shows that for at least 75% of the orders of any volume this is close to 1. The only exceptions
can be very large orders with ∆ = 1. Here the price reaches the order quickly, but it takes about 20%
longer to execute it completely. Our model neglects these eﬀects on very large volumes (see also Ref. [15]).
(c) The typical time to ﬁll does not depend too strongly on the volume of the order, except for very large
orders. Fig. 7 shows the median time to ﬁll (left panel) and time to cancel as a function of the volume of
the order. These median values are not correlated with volume except for very large orders which have a
larger median time to ﬁll. Our model neglects this behavior.

Under our assumptions one can write a joint density function that describes both the price diﬀusion process and
cancellations. The probability P∆(t, t′) that the price reaches an order placed at a distance ∆ > 0 from the current
best oﬀer at time t (and it is then executed immediately), and that the agent decides to cancel the order a time t′
can be written as a product of two independent distributions:

(11)
P∆(t, t′) is the joint probability that a limit order placed at a distance ∆ with lifetime t′ describes the following state
for the limit order at time t: (i) the limit order is executed if t < t′ or (ii) it is canceled if t > t′. The two states are
illustrated in detail in Fig. 8.

) = PFPT;∆(t)PLT;∆(t

P∆(t, t

).

′

′

VI. THE PREDICTIONS OF THE MODEL

Let us denote distribution functions in the following way:

PX;∆(> t) =

PX;∆(τ )dτ,

(12)

∞

t
Z

11

 AZN, 

 = 1 tick

 AZN, 

 = 2 ticks

 GSK, 

 = 1 tick

 GSK, 

 = 2 ticks

1.4

1.2

1.0

)
F
F
T
T
F
T
T
(
 
f

/

o
e

 

l
i
t

 

n
a
u
q
%
5
7

 

0

1

2

3

4

5

10

10

10

10

10

10

volume

Figure 6: The 75% quantile of the ratio of time to ﬁll and time to ﬁrst ﬁll for AZN and GSK. The ratio is around 1.1 − 1.2 for
the largest orders and ∆ = 1 tick, but it decreases when ∆ = 2 ticks. These results show that except for very small ∆ and very
large orders, at least 75% of the orders time to ﬁll and time to ﬁrst ﬁll is essentially equal.

 AZN, 

 = 1 tick

 AZN, 

 = 2 ticks

400

 GSK, 

 = 1 tick

 GSK, 

 = 2 ticks

 AZN, 

 = 1 tick

 AZN, 

 = 2 ticks

 GSK, 

 = 1 tick

 GSK, 

 = 2 ticks

 

F
T
T
n
a
d
e
m

i

500

300

200

100

0

300

 

C
T
T
n
a
d
e
m

i

200

100

0

0

1

2

3

4

5

0

1

2

3

4

5

6

10

10

10

10

10

10

10

10

10

10

10

10

10

volume

volume

Figure 7: Left: median time to ﬁll for AZN and GSK, ∆ = 1 and 2 ticks, as a function of order volume. The value does not
depend strongly on order size except for very large orders. Right: median time to cancel for AZN and GSK, ∆ = 1 and 2 ticks,
as a function of order volume. The value does not depend strongly on order size.

where X can be any process introduced above (FPT, LT, TTF, TTFF, TTC). We omit the lower index ∆ for brevity.
Let us ﬁrst express the previously introduced quantities in terms of the joint probability P∆(t, t′) and via Eq. (11).
For executed orders t < t′, thus the distribution of time to ﬁll is given by

PTTF(t) =

=

[PFPT(t)PLT(> t)].

We introduced the operator
t < t′:

], which normalizes a function to an integral of 1. Symmetrically for time to cancel
[
·

N

PTTC(t) =

=

[PFPT(> t)PLT(t)].

As (13) and (14) are two equations with only one unknown function, namely the lifetime distribution PLT(t), one
can calculate that from, e.g., Eq. (13), and then see if the solution is consistent with Eq. (14). We can express from

PFPT(t)PLT(> t)
∞
0 PFPT(τ )PLT(> τ )dτ
R

PFPT(> t)PLT(t)
∞
0 PFPT(> τ )PLT(τ )dτ
R

N

N

(13)

(14)

12

(15)

(16)

(17)

(18)

(19)

15

first

passage

time

first passage time

executed

canceled

orders

orders

10

e
c
i
r
p

5

0

order 

placement

order 

order 

order 

order lifetime

execution

placement

cancellation

first passage process

0

20

40

80

100

120

140

time

Figure 8: Left: The scheme of the diﬀusive model for execution times (example with buy orders). Orders are indicated by
thick horizontal lines. The order is placed at a distance ∆ below the current best bid. At the time of its placement the order is
assigned a lifetime (the length of the thick line). If the bid crosses the line, then the order is executed at the time of crossing.
The time between order placement and the crossing is the ﬁrst passage time of the bid price to a distance ∆. If there is no
crossing, the order is canceled at its cancellation time (the end of the thick line). Right: Orders are executed when the ﬁrst
passage time is less, and canceled when larger than the intended lifetime.

Eq. (13), that

and thus

PLT(> t)

PTTF(t)
PFPT(t)

∝

It is also possible to estimate the same quantity directly from Eq. (14):

PLT(t) =

PLT(> t) =

d
dt

−

d
dt

PTTF(t)
PFPT(t)

.

(cid:21)

−N

(cid:20)

(cid:20)
Let us eliminate the lifetime distribution, and substitute the large t asymptotic power law behavior of all probabilities.
After simple calculations one ﬁnds that

(cid:21)

PLT(t) =

PTTC(t)
PFPT(> t)

.

N

λTTF = λTTC.

PLT(t)

∝

−λLT,

t

Then we substitute this result back into Eq. (15) to ﬁnd that the lifetime distribution also has to decay asymptotically
as a power law:

with

λLT = λTTF −
Eq. (18) is in good agreement with the results of Section IV, where λTTF = 1.8

λFPT + 1 = λTTC −

λFPT + 1.

2.4. This
is a clear improvement as compared to Eq. (8). The introduction of the simplest possible cancellation model gives a
good prediction for the discrepancy between the asymptotic of ﬁrst passage time and time to ﬁll.

2.2, and λTTC = 1.9

(20)

−

−

Moreover, one can now observe the hidden distribution of lifetimes. By substituting the typical values into Eq. (20),
1.6. In comparison, a paper by Borland and Bouchaud [42] describes a GARCH-like model obtained
one gets λLT ≈
by introducing a distribution of traders’ investment horizons and the model reproduces empirical values of volatility
correlations for λLT = 1.15, which is not far from our estimate. More recently it has been shown [43] that the limit

order price probability distribution is consistent with the solution of an utility maximization problem in which the
1.75. The origin of the power law distribution of
limit order lifetime is power law distributed with an exponent λLT ≃
limit order lifetimes is not clear. Unfortunately the data do not allow us to separate individual traders. Therefore we
do not know whether such a result arises from the broad distribution of the time horizons of each trader, or simply a
distribution of traders with diﬀerent investment strategies. Based on an empirical investigation at the broker level, in
Ref. [43] it is argued that heterogeneity of investors could be the determinant of the power law lifetime distribution.
Notice, however, two points: (i) We are not speaking about how long the investors hold the stock. Instead, PLT is
the distribution of how long investors are willing to wait for their limit orders to be executed and before they cancel
or revise their oﬀers. (ii) None of the limit orders we are discussing here are truly long-term. Even the orders with
relatively long lifetime spend at most a few days in the book.

VII. THE VALIDITY OF THE LIFETIME PROCESS

In Section V we motivated most assumptions of our model. However, one unrealistic assumption was the inde-
pendence of the lifetime of the order from the evolution of price. This would mean that traders decide about an
expiry time of their limit orders at the time of their placement, and then do not cancel them earlier, or for example
that cancellation is simply random as in Ref.
[19]. The natural procedure to validate this assumption would be to
calculate the cross-correlation coeﬃcient of ﬁrst passage times and the lifetime process and show that this value is
negligible. However, once again we are limited by the fact that the lifetime is hidden. It is not possible to calculate
cross-correlations between time to ﬁll and time to cancel either, because an order can only be either ﬁlled or canceled,
thus the two variables cannot be observed simultaneously for the same order.

One solution to this puzzle is the following. One can observe the realized values of the lifetime for those orders
that were actually canceled. Moreover, for the same orders it is possible to observe the value of the ﬁrst passage time
simply because price data is always available, even after the cancellation of the order. So under our model assumption,
for all canceled orders we know the cancellation time and also the time when the order would have been executed.
It is possible to quantify cross-correlations between these two quantities, but one has to keep in mind three points.
(Note that we will consider orders with ∆ = 1 to have the largest possible sample.)

1. For very short times the price dynamics is dominated by bid-ask bounce, and other non-diﬀusive processes [44].
Our model is not valid in this regime, because order executions are not governed by a ﬁrst passage process.
Hence we discard all orders which were canceled within L = 4 minutes of their placement.

2. At least for small ∆, both ﬁrst passage times and the lifetime distributions may have diverging means. Therefore
the cross-correlation coeﬃcient is not always well-deﬁned.
Instead, we choose to evaluate Spearman’s rank-
correlation coeﬃcient (ρ), which has favorable statistical properties, for example it is not very sensitive to the
extreme events. Moreover, it can be deﬁned for any two random variables regardless of the existence of any of
their moments.

3. As we can only consider canceled orders, we know that FPT > LT. This constraint alone, and regardless of the
choice of correlation measure, will cause strong positive correlations between the two quantities. The conditional
joint distribution reads

P (FPT = t, LT = t

′

FPT > LT) =
|

N

[Θ(t

−

′

t

)PFPT(t)PLT(t

)],

′

where Θ is the Heaviside step function. Even if FPT and LT are independent, due to our restricted observations
this is clearly not a product of two independent densities.
Instead, a proper null hypothesis is to measure the correlations between FPT/LT and LT. We know that for
∆ = 1 and L = 4 min the distribution of the ﬁrst passage time is well described by the power law

PFPT(t

t > L)
|

∼

λFPT −
1
LλFPT−1 t

−λFPT .

If FPT and LT are independent, then

P (FPT/LT = x, LT = t

′

FPT > LT) =
|

[Θ(x
−
−λFPT ]

N
1)x

′
1)PFPT(xt

′

)PLT(t
′

)] =
′
)].

(23)
−
This is a product form in functions of x and of t′, which means that FPT/LT is independent from LT, given
that we restrict ourselves to FPT > LT. Remember that the only assumption for this result is that ﬁrst passage
times are asymptotically power law distributed, which seems to hold very well both in our data down to L
4
min, and any reference process described in Section III.

[PFPT(t

)PLT(t

[Θ(x

× N

N

≈

13

(21)

(22)

ρres

ρsurr

stock
AZN −0.12 ± 0.02 −0.001 ± 0.001 −0.19 ± 0.03 −0.18 ± 0.03
0.000 ± 0.001 −0.21 ± 0.02 −0.20 ± 0.02
GSK −0.13 ± 0.01
LLOY −0.10 ± 0.01
0.000 ± 0.001 −0.16 ± 0.02 −0.15 ± 0.02
SHEL −0.13 ± 0.02 −0.001 ± 0.001 −0.21 ± 0.03 −0.19 ± 0.03
VOD −0.134 ± 0.008 0.000 ± 0.001 −0.22 ± 0.01 −0.21 ± 0.01

3277
8573
8201
2791
16392

ρtrue (Morg.) ρtrue (Frank) number of points

Table IV: Estimates of the correlation between ﬁrst passage times and the lifetimes for orders with entry depth ∆ = 1 tick. We
discarded orders executed or canceled within L = 4 minutes of their placement. The errors represent the standard deviation
estimated from 300 bootstrap samples.

As a next step, we calculated Spearman’s rank correlations ρres between FPT/LT and LT in our restricted sample
for various stocks. Results are summarized in Table IV. At all traditional signiﬁcance levels one ﬁnds negative
correlation between the two quantities.6 This means that those limit orders that would have been executed later were
canceled earlier, i.e., that traders update their decision on when to cancel a limit order by tracking the price path.
This is in line with the results of Ref. [20]. To prove that this value of ρ truly comes from correlations, we generated
surrogate datasets by randomizing the pairs FPT/LT and LT while keeping the constraint FPT > LT. According to
Table IV this completely destroys the correlations between FPT/LT and LT, ρsurr = 0.

It is a key point to remember that this value of ρres is not the actual correlation coeﬃcient between the ﬁrst
passage time and the lifetime process. To quantify the true value of cross-correlations, we introduce ρtrue which is
Spearman’s rank-correlation coeﬃcient between LT and FPT. While this cannot be measured directly, there is a
procedure to estimate it from a known value of ρres based on Monte Carlo simulation. Let us assume that FPT and
LT are adequately described by power law distributions with the known tail exponents. Moreover, let us model the
cross-correlation between the two processes by Morgenstern’s copula:

′
P (> t, > t

) = PFPT(> t)PLT(> t

)

′

1 + 3ρtrue[1
{

−

PFPT(> t)][1

PLT(> t

−

′

,

)]
}

with some

1/3 < ρtrue < 1/3, or by Frank’s copula:

−

′
P (> t, > t

) =

1
α

ln

1 +

"

(eαPFPT(>t)

1)(eαPLT(>t
1

−
eα

′

)

1)

−

,

#

−

−∞

< α <

. Here P (> t, > t′) =

with some
are widely used in the ﬁnance and insurance literature (for an authoritative introduction, see Ref. [47]).

t′ dτ ′P (τ, τ ′) which is the joint distribution function. Copulas
R

Monte Carlo measurements based on random pairs from these copulas suggest a nearly linear relationship between
the true and the restricted correlation coeﬃcients. With the substitution of the typical values of λFPT and λLT one
ﬁnds that the values of the true rank correlation coeﬃcients ρtrue are given by

∞

∞
t dτ
R

∞

ρtrue = r

ρres,

×

where r
Naturally, the shuﬄed surrogate datasets yield ρtrue = ρres = 0.

1.66 for Morgenstern’s and r

≈

≈

1.55 for Frank’s copula. The resulting estimates are given in Table IV.

In conclusion we observe that there is a strong negative correlation between the ﬁrst passage time and the lifetime
of an order in agreement with Ref. [20] but contrary to our model assumption 2 and Eq. (11). So the key question
is: How much does the presence of this correlation aﬀect the predictions of our model? We performed a series of
Monte Carlo simulation of the submission and cancellation processes by using the empirically observed value of tail
exponents and cross correlations (Table IV). We found that for a ﬁxed value of λFPT and λLT the introduction of
such correlations increases the values of λTTF and λTTC by about 0.1, which is comparable to the error bars of our
estimates, and the power law behavior is well preserved. Moreover, the central part of our arguments, Eq. (18),
remains valid [33]. Thus the presence of a dynamic cancellation strategy does not signiﬁcantly aﬀect the validity of
our model.

14

(24)

(25)

(26)

6 The error bars were estimated by the bootstrapping procedure suggested in Ref.

[45] (for more details see refs. therein). For the

application of bootstrapping to test the signiﬁcance of correlations in ﬁnancial data, see e.g. Ref. [46].

Table V: Parameters of the ﬁtting function (5) for the distribution of time to ﬁll for the ﬁve stocks and ∆ < 0 ticks. All times
are given in seconds. Data are missing when there were the statistics was inadequate for ﬁtting. Typical standard errors for
the quantities: ±0.1 for λTTF, ±0.1 for λ

′
TTF, and ±25% for TTTF.

15

stock

∆ = −1
λ λ′ T

∆ = −2
λ λ′ T
AZN 2.2 1.0 230 2.1 1.2 320
GSK 2.1 1.1 180 2.2 1.3 410
LLOY 2.1 1.0 150 2.0 1.2 220
SHEL 2.1 1.0 120 2.1 1.0 140
VOD 2.0 1.1 130 –

–

–

stock

∆ = −1
′
T
λ λ

∆ = −2
′
T
λ λ
AZN 2.0 0.7 90 1.9 0.8 72
GSK 1.9 0.7 90 1.8 0.8 50
LLOY 1.9 0.7 70 1.8 0.9 85
SHEL 2.2 1.0 130 2.0 1.0 160
VOD 1.8 0.8 120 –

–

–

Table VI: Parameters of the ﬁtting function (6) for the distribution of time to cancel for the ﬁve stocks and ∆ < 0 ticks. All
times are given in seconds. Data are missing when there were no orders at all, or the statistics was inadequate for ﬁtting.
Typical standard errors for the quantities: ±0.1 for λTTC, ±0.1 for λ′

TTC, and ±25% for TTTC.

VIII. A GENERALIZATION TO ∆ ≤ 0

So far we only considered orders with prices which were worse than the best oﬀer at the time of their placement,
i.e., ∆ > 0. However, this group only accounts for less than half of the actual limit orders. Measurements for ∆
0
orders give the surprising result that execution times are described by statistics very similar to that for ∆ > 0. One
example stock (GSK) is shown in Fig. 9(left), and ﬁt results with formula (5) for all ﬁve stocks are given in Table V.
According to our model, these orders should have been executed within a negligible time of placement. While this
is true for a number of them, certainly not for all. Let us assume that we are placing a new buy limit order. If our
order has ∆ = 0, then it will be among the best oﬀers at the time of its placement. If our order has ∆ < 0, then
it becomes the single best oﬀer in the book, and hence it will trade with certainty if the next event is a buy market
order. Why can our order still take a long time before being executed? The answer is naturally that before our order
is executed, a new buy limit order may enter the book. If this new order has ∆ < 0, it means that it has an even
better price than our order and it will gain priority of execution. On the other hand, our order now eﬀectively has
∆ > 0, and the original model can be applied.

≤

In order to test such a hypothesis, we carried out the following calculation. For the sake of simplicity, we will
consider the time to ﬁrst ﬁll instead of time to ﬁll. Section V argued that for the majority of orders the diﬀerence
between the two is negligible. From the time of its placement, we tracked every single at least partially ﬁlled ∆
0
order until the time it was ﬁrst ﬁlled. We deﬁned the reduced entry depth (∆′) and the reduced time to ﬁrst ﬁll
(TTFF

) for these orders as follows

≤

′

1. For orders, where from their placement to their ﬁrst ﬁll there were no even more favorable orders both placed

and then at least partially ﬁlled, ∆′ = 0 and TTFF

′

= TTFF.

2. For orders where after their placement but before their ﬁrst ﬁll there was at least one new, more favorable order
introduced with ∆new < 0 and then this new order was at least partially ﬁlled, we selected the ﬁrst of such new
orders placed after the original one and set ∆′ =
∆new. Thus, ∆′ is the new position of the original order,
′
after the new one was placed. TTFF
is deﬁned as the time to ﬁrst ﬁll of our order measured from the placement
of this new order.

−

′

The typical distribution of TTFF

for diﬀerent groups in ∆′ is shown in Fig. 9(right). For orders with ∆′ = 0 this is
– except for very short times – well described by a stretched exponential distribution PTTFF′ (t) = 1
.
These are the orders, where there was no better oﬀer made, and hence their execution times were purely determined
i
by the incoming market orders. The distribution is very close to the distribution of the times between two consecutive
transactions of the stock (see, for an example the right panel of Fig. 9).

For orders with ∆′ > 0, one recovers the results of the previous sections, and the distribution of reduced time to

25 exp

−
h

1/2

t
6

(cid:0)

(cid:1)

16

slope -1.9

0

10

-1

-2

-3

-4

-5

-6

-7

-8

10

10

10

10

10

)

C
T
T
(
P

 
,
)
F
T
T
(
P

10

slope -2.1

slope -1.8

10

 

 = 0 ticks (fill)

 

 = -1 tick (fill)

10

 

 = -2 ticks (fill)

 

 = 0 ticks (canc)

 GSK, 

’=0 ticks

 AZN, 

’=0 ticks

 GSK, 

’=1 tick

 AZN, 

’=1 tick

 AZN, 

’=2 ticks

 stretched exp.

 AZN, waiting time

0

1

2

3

4

5

0

1

2

3

4

10

10

10

10

10

10

10

10

10

10

10

TTF, TTC (sec)

TTFF’ (sec)

0

10

-1

-2

-3

-4

-5

-6

-7

-8

10

10

10

10

10

10

10

10

)
’
F
F
T
T
(
P

Figure 9: Left: Examples of the distribution of time to ﬁll/cancel for ∆ ≤ 0 buy limit orders of GSK. Right: The distribution
of reduced time to ﬁrst ﬁll (TTFF
= 0, the tail of the
distribution is well ﬁtted by the stretched exponential 1
> 0, the distribution decays asymptotically
`
as a power law with an exponent close to −2.0. The solid line is the distribution of waiting times between two consecutive
trades of GSK.

) as a function of the reduced entry depth ∆
′
25 exp h−
i. Where ∆

. For orders where ∆

t
6 ´

1/2

′

′

′

ﬁrst ﬁll asymptotically decays as a power law with a power close to 2.0. Eqs. (18) and (20) are expected to be valid
′
for orders with ∆ < 0 and ∆′ > 0 as well, given that we use them in terms of ∆′ and TTFF

.

As a summary, time to ﬁrst ﬁll for orders with ∆

0 is a two-component process. If there is no better order
submitted before the ﬁrst ﬁll, then time to ﬁrst ﬁll is identical to the waiting time distribution between opposite
If there is a better oﬀer submitted, then the order eﬀectively becomes ∆ > 0, and the diﬀusion
market orders.
approximation applies. As this latter process has a much fatter tail than the former one, long waiting times and the
tail exponent are again dominated by a ﬁrst passage process.

≤

IX. CONCLUSIONS

The price formation of stock markets is organized by complex procedures which often involve a limit order book.
There have been many attempts to map some aspects of this auction process to less complicated probabilistic models.
In this paper we showed that the waiting time of an order until its execution presents statistical regularities which
are quite robust and can be seen as ”stylized facts” of the order book dynamics. These results oﬀer some insight into
how the random diﬀusion process of price can be characterized more precisely.

The diﬀerence between statistical properties of time to ﬁll, ﬁrst passage time and time to cancel are informative
of the interdependence of these phenomena. With data of ﬁve highly capitalized stocks traded at the London Stock
Exchange, we empirically observed that for the transaction time (and best bid and ask) the ﬁrst passage time, the
time to (ﬁrst) ﬁll and time to cancel are asymptotically power law distributed in time. Based on a simple model we
showed that the characteristic exponents of the asymptotic power law behavior of the ﬁrst passage time, the time
to (ﬁrst) ﬁll and time to cancel are related to each other by simple rules which are in agreement with our empirical
observations. These predictions are in contrast with another study (the NASDAQ data investigated in Ref.
[14]).
Therefore further investigation of our results is needed to clarify whether or not they are market dependent.

Although the proposed model makes many simplifying assumptions – for example that order volume is irrelevant
for the execution time – we have veriﬁed that most of them are suﬃciently supported by empirical evidence. Other
important stylized facts have been neglected in the model, for example, the role of volatility ﬂuctuations. In fact, the
temporal ﬂuctuations of volatility and liquidity result in execution rates that change from time to time. In short we
have, at the moment, ignored the conditional aspects of the dynamics of the order book. Some of these aspects have
been already investigated in the literature [15]. An extension of our study along these lines can be feasible.

In spite of its obvious limitations, our simple model is able to make one additional prediction: The place-
ment/cancellation strategies followed by each single trade are strongly heterogeneous. This might come from a
heterogeneity either among diﬀerent traders, or already in the actions of each single trader in diﬀerent time periods.
It remains an open question to discriminate between these two kinds of heterogeneity. Nevertheless, the observation

17

itself is still relevant, because as long as orders cannot be traced back to whoever placed them, this aggregate is
what any investor sees as a market environment. Proprietary data ﬁrms providing ﬁnancial services to institutional
investors may be used to verify or falsify the results obtained from aggregated data by means of our simple model.

Acknowledgments

ZE is grateful to Jean-Philippe Bouchaud for discussions of the order book, to Michele Tumminello for advice on
bootstrapping, and to Ingve Simonsen for help with the measurement of ﬁrst passage times. The hospitality of l’Ecole
de Physique des Houches and Capital Fund Management is also thankfully acknowledged. This work was supported
by COST–STSM–P10–917 and OTKA T049238. FL and RNM acknowledge support from MIUR research project
“Dinamica di altissima frequenza nei mercati ﬁnanziari” and NEST-DYSONET 12911 EU project.

[1] B. Biais, L. Glosten, and C. Spatt, Journal of Financial Markets 8, 217 (2005).
[2] L. Glosten, Journal of Finance 49, 1127 (1994).
[3] S. Chakravarty and C. Holden, Journal of Financial Intermediation 4, 213 (1995).
[4] D. Seppi, Review of Financial Studies 10, 704 (1997).
[5] C. Parlour, Review of Financial Studies 11, 789 (1998).
[6] M. G. Daniels, J. D. Farmer, G. Iori, and E. Smith, Physical Review Letters 90, 108102 (2003).
[7] H. Luckock, Quantitative Finance 3, 385 (2003).
[8] B. Biais, P. Hillion, and C. Spatt, Journal of Finance 50, 1655 (1995).
[9] P. Handa and R. Schwartz, Journal of Finance 51, 1835 (1996).
[10] L. Harris and J. Hasbrouck, Journal of Financial and Quantitative Analysis 31, 213 (1996).
[11] K. Kavajecz, Journal of Finance 54, 747 (1999).
[12] P. Sandas, Review of Financial Studies 14, 704 (2001).
[13] S. Maslov and M. Mills, Physica A 299, 234 (2001).
[14] D. Challet and R. Stinchcombe, Physica A 300, 285 (2001).
[15] A. Lo, A. MacKinlay, and J. Zhang, Journal of Financial Econometrics 65, 31 (2002).
[16] M. Potters and J.-P. Bouchaud, Physica A 324, 133 (2003).
[17] B. Holliﬁeld, R. A. Miller, and P. Sandas, Review of Economic Studies 71, 1027 (2004).
[18] J. D. Farmer, L. Gillemot, F. Lillo, S. Mike, and A. Sen, Quantitative Finance 4, 383 (2004).
[19] J. D. Farmer, P. Patelli, and I. I. Zovko., Proc. Natl. Acad. Sci. USA 102, 2254 (2005).
[20] S. Mike and J. D. Farmer, physics/0509194 (2005).
[21] P. Weber and B. Rosenow, Quantitative Finance 5, 357 (2005).
[22] A. Ponzi, F. Lillo, and R. N. Mantegna, physics/0608032 (2006).
[23] M. L. Calzi and P. Pellizzari, Quantitative Finance 3, 470 (2003).
[24] W. Feller, An introduction to probability theory, vol. 1 (Wiley & Sons, 1967), 3rd ed.
[25] A. V. Chechkin, R. Metzler, V. Y. Gonchar, J. Klafter, and L. V. Tanatarov, J. Phys. A: Math. Gen. 36, L537 (2003).
[26] S. Redner, A Guide to First-Passage Processes (Cambridge University Press, 2001).
[27] I. M. Sokolov and R. Metzler, J. Phys. A: Math. Gen. 37, L609 (2004).
[28] E. Scalas, Physica A 362, 225 (2005).
[29] M. Montero, J. Perell´o, J. Masoliver, F. Lillo, S. Miccich´e, and R. N. Mantegna, Phys. Rev. E 72, 056101 (2005).
[30] I. Simonsen, M. Jensen, and A. Johansen, Eur. Phys. J. B 27, 583 (2002).
[31] J.-P. Bouchaud and M. Potters, Theory of Financial Risk (Cambridge University Press, Cambridge, 2000).
[32] V. Seshadri and B. J. West, PNAS 79, 4501 (1982).
[33] Data available upon request.
[34] M. Wyart, J.-P. Bouchaud, J. Kockelkoren, M. Potters, and M. Vettorazzo (2006), cond-mat/0603084.
[35] A. P. Kirman, Journal of Economic Perspectives 6, 117 (1992).
[36] W. H¨ardle and A. Kirman, Journal of Econometrics 92, 227 (1995).
[37] Z. Eisler and J. Kert´esz, Eur. Phys. J. B 51, 145 (2006), (also physics/0508156).
[38] Z. Eisler and J. Kert´esz (2007), physics/0606161, to appear in Europhys. Lett.
[39] J.-P. Bouchaud, personal communication.
[40] M. Barclay, C. Dunbar, and J. Warner, Journal of Financial Economics 34, 281 (1993).
[41] S. Chakravarty, Journal of Financial Economics 61, 289 (2001).
[42] L. Borland and J.-P. Bouchaud, physics/0507073 (2005).
[43] F. Lillo, physics/0612016 (2006).
[44] R. Roll, Journal of Finance 39, 1127 (1984).
[45] F. Schmid and R. Schmidt (2006), Proc. Compstat (in press).

[46] M. Tumminello, C. Coronnello, F. Lillo, S. Miccich`e, and R. N. Mantegna, to appear in J. Bifurcation Chaos 17 (2007),

physics/0605116.

[47] E. W. Frees and E. A. Valdez, North American Actuarial Journal 2, 1 (1998).

18

