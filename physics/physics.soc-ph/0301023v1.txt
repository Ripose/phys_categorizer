3
0
0
2
 
n
a
J
 
3
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
3
2
0
1
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Renormalization Group Analysis of the
2000-2002 anti-bubble in the US S&P 500
index: Explanation of the hierarchy of 5
crashes and Prediction

Wei-Xing Zhou a, Didier Sornette a,b,c,1

aInstitute of Geophysics and Planetary Physics, University of California
Los Angeles, CA 90095-1567
bDepartment of Earth and Space Sciences, University of California
Los Angeles, CA 90095-1567
cLaboratoire de Physique de la Mati`ere Condens´ee, CNRS UMR 6622 and
Universit´e de Nice-Sophia Antipolis, 06108 Nice Cedex 2, France

Abstract

We propose a straightforward extension of our previously proposed log-periodic
power law model of the “anti-bubble” regime of the USA market since the sum-
mer of 2000, in terms of the renormalization group framework to model critical
points. Using a previous work by Gluzman and Sornette (2002) on the classiﬁca-
tion of the class of Weierstrass-like functions, we show that the ﬁve crashes that
occurred since August 2000 can be accurately modelled by this approach, in a fully
consistent way with no additional parameters. Our theory suggests an overall con-
sistent organization of the investors forming a collective network which interact to
form the pessimistic bearish “anti-bubble” regime with intermittent acceleration
of the positive feedbacks of pessimistic sentiment leading to these crashes. We de-
velop retrospective predictions, that conﬁrm the existence of signiﬁcant arbitrage
opportunities for a trader using our model. Finally, we oﬀer a prediction for the
unknown future of the US S&P500 index extending over 2003 and 2004, that reﬁnes
the previous prediction of Sornette and Zhou (2002).

Key words: Anti-bubble; Singularity; Herding and imitative behavior;
Weierstrass-type function; Prediction; Endogenous and exogenous crashes;
Econophysics

1 Corresponding author. Department of Earth and Space Sciences and Institute
of Geophysics and Planetary Physics, University of California, Los Angeles, CA
90095-1567, USA. Tel: +1-310-825-2863; fax: +1-310-206-3051. E-mail address: sor-

Preprint submitted to Elsevier Science

14 January 2013

1 Introduction

In two recent papers [22,27], we have analyzed 39 world stock market in-
dices from 2000 to the end of 2002 and have found that 22 of them are in
an “anti-bubble” regime, deﬁned as a self-fulﬁlling decreasing price created
by positive price-to-price feedbacks feeding an overall pessimism and negative
market sentiments further strengthened by interpersonal interactions. Math-
ematically, we characterize anti-bubbles by a power law decrease of the price
(or of the logarithm of the price) as a function of time decorated by decel-
erating/expanding log-periodic oscillations. We have used several parametric
and non-parametric statistical tools which all conﬁrm the very high signiﬁ-
cance of the reported mathematical signature of herding characterizing these
bearish anti-bubble phases. In addition, the majority of European and West-
ern stock market indices as well as other stock indices have been found to
exhibit practically the same log-periodic power law anti-bubble structure as
found for the USA S&P500 index. These anti-bubbles are found to start ap-
proximately at the same time, August 2000, in all these markets and show a
remarkable degree of synchronization worldwide, suggesting that the descent
of the worldwide stock markets since 2000 is an international event. These
results augment the number of anti-bubble cases in addition to the previous
examples documented on the Japanese, Gold and Russian markets [9,11].

These analyses [22,27] are based on a general theory of ﬁnancial crashes and
of stock market instabilities developed in a series of works by D. Sornette and
his co-workers over the last decade [23,8,15,14,21,19]. The main ingredient of
the theory is the existence of positive feedbacks, that is, self-reinforcements,
which leads to cooperative herding and imitation between investors. As a
consequence, the actions of investors tend to produce waves of contrariant
and imitative behaviors leading to self-reinforcing bullish or bearish phases,
themselves decorated by the opposite regimes in a hierarchical fashion. Positive
feedbacks, when unchecked, can produce runaways until the deviation from the
fundamental price is so large that other eﬀects can be abruptly triggered and
lead to rupture or crashes. Alternatively, it can lead to prolonged depressive
bearish markets for most of the developed stock markets in the world [27].

Figure 1 shows the USA S&P 500 index from August 21, 2000 to August 24,
2002 and the ﬁts by the log-periodic power law formula

ln[p (t)] ≈ A + B(t − tc)α + C(t − tc)α cos [ω ln (t − tc) − φ] ,

(1)

(where tc is the starting time of the anti-bubble) including a single angular log-

nette@moho.ess.ucla.edu (D. Sornette)
http://www.ess.ucla.edu/faculty/sornette/

2

frequency ω (continuous line) as well as its harmonics 2ω (dashed line). These
two theoretical curves constituted the main results of our previous work [22]
which led us to issue a prediction for the future evolution of the US market (see
also our web site for monthly updates of our predictions). Notwithstanding the
remarkable capture of the overall decay and of the expanding alternation of
ups and downs, the ﬁve crashes outlines by the arrows are not accounted by
this theory. These ﬁve crashes constitute an important characteristic of this
time series which is much rougher and singular than predicted by the gentle
cosine function used in expression (1). The importance of these ﬁve crashes can
be seen both at the level of the geometrical description of the price time series
and with respect to their meaning and implications in the overall organization
of the social network of investors.

Our purpose is to propose a simple extension of expression (1) based on a
renormalization group analysis of the critical behavior embodied by (1) that
accounts very accurately for the presence of these ﬁve crashes. The theory
developed here shows that expression (1) is nothing but the ﬁrst Fourier com-
ponent of a more complete inﬁnite Fourier series expansion of the general
critical log-periodic power law behavior. This extension rationalizes the hier-
archical geometric series of the time occurrences of these ﬁve crashes. Within
our new theory, the qualitative explanation for the occurrence of these ﬁve
crashes is similar to that underlying crashes following speculative bubbles.
The main qualitative ingredient of the theory is the existence of positive feed-
backs, of the kind which has been documented to occur in stock markets as
well as in the economy. Positive feedbacks, i.e., self-reinforcement, refer to the
fact that, conditioned on the observation that the market has recently moved
up (respectively down), this makes it more probable to keep it moving up (re-
spectively down), so that a large cumulative move may ensue. In a dynamical
model, positive feedbacks with nonlinear ampliﬁcations has been shown to give
rise to a ﬁnite-time singularity which are good mathematical representation of
the market price trajectory on the approach to crashes [20,7]. However, such
dynamical formulation describes only the price trajectory up to its singularity.
It does not describe the rebound and ensuing evolution after the singularity.
In this sense, our present approach is more powerful because it shows a deep
connection between the existence and organization of the ﬁve crashes on the
one hand and the overall log-periodic power law decay of the market crash on
the other hand.

In an anti-bubble such as the regime of the S&P500 since August 2000, after a
bottom, the positive feedbacks described above lead to the following qualita-
tive scenario. First, the price rebounds as investors expect that the bad times
may be behind them. However, the euphoria is short-lived as the fundamen-
tals and the overall market sentiment are negative, leading to a slowdown and
even reversal of the positive into a negative trend. The negative trend is then
ampliﬁed by the collective herding behavior of investors, who, similarly to

3

lemmings rushing over a cliﬀ, run to sell, leading to each of these ﬁve observed
crashes. Within our framework, these ﬁve crashes pertaining to the S&P500
anti-bubble phase are thus intrinsically endogenous to the market dynamics,
similarly to most of the crashes found in many markets worldwide [13].

This paper is organized as follows. In Sec. 2, we summarize the main concepts
and results of a renormalization group theory of the anti-bubble regime, lead-
ing to solutions taken the form of Weierstrass-type functions [5]. We present
our ﬁtting procedure in Sec. 3.1 and the determination of the relevant number
of terms in our model in Sec. 3.2. The class of models describing the discretely
scale invariant hierarchy of crashes is presented in Sec. 3.3. Its variants lead-
ing to non-singular price trajectories are investigated in Sec. 3.4. In Sec. 4, we
then use three variants with diﬀerent choices of the phases of the log-periodic
components to oﬀer a new analysis of the prediction of the S&P 500 index
in the coming year. This set of predictions extend and reﬁne our previous
prediction [22]. Sec. 5 concludes.

2 Construction of Weierstrass-type functions

ln[p (t)] given by expression (1) is endowed with the symmetry of discrete scale
invariance [18]. Indeed, multiplying t − tc by the factor 1/γ = e2π/ω, we have

ln[p ((t − tc)/γ)] = A

+

ln[p (t − tc)] , with µ = γα .

(2)

µ − 1
µ

1
µ

Equation (2) expresses the fact that the prices, at two times related by a
simple contraction with factor γ of the interval since the beginning of the
anti-bubble, are related themselves by a simple contraction with factor µ (up
to the additive term A(µ − 1)/µ). The scale invariance equation (2) is a spe-
cial case of a general one-parameter renormalization group equation, which
captures the collective behavior of investors in speculative regimes (see [19]
for a pedagogical introduction to the ideas of the renormalization group as
applied to ﬁnance). Using the renormalization group (RG) formalism on the
stock market index p amounts to assuming that the index at a given time t is
related to that at another time t′ by the general transformations (4) and (5)
below, ﬁrst proposed for the stock market in Ref. [23] on the variable

F (x) = ln[p(t)] − ln[p(tc)] ,

such that F = 0 at the critical point at tc. The ﬁrst expression on the distance
x = |t − tc| to the critical point occurring at tc reads

x′ = R(x) ,

(3)

(4)

4

where R is called the RG ﬂow map. The second expression describes the
corresponding transformation of the price and reads

F (x) = G(x) +

F [R(x)] .

1
µ

The constant µ > 1 describes the scaling of the index evolution upon a rescal-
ing of time (4). The function G(x) represents the non-singular part of the
function F (x) which describes the degrees of freedom left-over by the decima-
tion procedure involved in the change of scale of the description. We assume as
usual [6] that the function F (x) is continuous and that R(x) is diﬀerentiable.

These equations (5) with (4) can be solved recursively to give

F =

∞

X
n=0

1
µn G hR(n)(x)i ,

R(x) = γx

F =

∞

X
n=0

1
µn G [γn(x)] .

where R(n) is the nth iterate of the map R. To make further progress, one
expands R(x) as a Taylor series in powers of x. For our purpose, it is suﬃcient
to keep only the ﬁrst-order linear approximation

of the map R around the ﬁxed point R(xc) = xc = 0. For the eﬀect of the
next order term proportional to x2, see [3]. Equation (6) then becomes

(5)

(6)

(7)

(8)

For the special choice G(x) = cos(x), expression (8) recovers the Weierstrass
function, famous for the fact that it was proposed by Weierstrass in 1876 as
the ﬁrst example of a continuous function which is no-where diﬀerentiable.
This opened up the ﬁeld of “fractals” [4].

Following Ref. [5], the inﬁnite series in (8) can be expressed in a more con-
venient way by (1) applying the Mellin transform to (8), (2) re-expanding by
ordering with respect to the poles of the Mellin transform of F in the complex
plane, and (3) perform the inverse Mellin transform to obtain an expansion
for F in terms of power laws expressing the critical behavior of the solution of
the RG equation (5). This set of operation amounts to a resummuation of the
inﬁnite series in (8) which is better suited to describe the critical behavior and
its leading corrections to scaling. The result is that F (x) can be expressed as

5

(9)

(10)

(11)

(12)

the sum of a singular part Fs(x) and of a regular part Fr(x) [5]:

F (x) = Fs(x) + Fr(x) ,

Fs(x) =

Anx−sn ,

∞

X
n=0

An =

ˆG(sn)
ln γ

,

where

with

and

sn = −m + i

n , with m =

2π
ln γ

ln µ
ln γ

.

The coeﬃcients An control the relative weights of the log-periodic corrections
(resulting from the imaginary parts of the complex exponents sn) to the lead-
ing power law behavior described by the ﬁrst term n = 0. The regular part
Fr(x) does not exhibit any singularity at x = 0 or anywhere else and will not
be considered further.

As an illustration, for the Weierstrass case with G(x) = cos(x), for large n,
the coeﬃcients An are given by

An =

1
ln γ

1

nm+0.5 eiψn , with ψn = ωn ln(ωn) and ω =

2π
ln γ

.

(13)

More generally, Ref. [5] has shown that, for a large class of systems, the coeﬃ-
cients An of the power expansion of the singular part Fs(x) can be expressed
as the product of an exponential decay by a power prefactor and a phase

An =

1
ln γ

1

np e−κn eiψn,

for large n ,

(14)

where p, κ ≥ 0 and ψn are determined by the form of G(x) and the values
of µ and γ. Systems, with quasi-periodic G(x) and/or such that G(x) has
compact support, have coeﬃcients An decaying as a power law An ∼ n−p
(κ = 0) leading to strong log-periodic oscillatory amplitudes. If in addition,
the phases of An are ergodic and mixing, the observable presents singular
properties everywhere, similar to those of “Weierstrass-type” functions (13).

6

In the following, we restrict our attention to the “Weierstrass-type” class of
models with κ = 0 and extend the log-periodic power law formula (2) for the
ﬁt of empirical price time series by using the class of models Fs(x) given by
(10) with the parametrization (14) with κ = 0. Speciﬁcally, we shall use the
following function for the ﬁt of price time series:

F (x) = A + Bxm + C

n−m−0.5eiψnx−sn ,

(15)

where A, B and C are three parameters and N is the number of log-periodic
harmonics kept in the description. In the second term of the right-hand-side
of (15), we have used sn=0 = −m as seen from (12). We shall play with
diﬀerent parameterizations for the phases ψn, which can have forms diﬀerent
from ψn = ωn ln(ωn) given in (13) for the Weierstrass function. We shall also
test the robustness of the ﬁts with (15) by using the more general function

ln[p(t)] = A + Bxm +

Cneiψnx−sn .

(16)

N

X
n=1

N

X
n=1

Eq. (15) is recovered for Cn = C/nm+0.5.

3 Description of the S&P500 anti-bubble by multiple singularities

3.1 Fitting procedure

The USA S&P 500 daily price series of the 2000 anti-bubble from August 21,
2000 to August 24, 2002, as shown in Fig. 1, is ﬁtted with expression (16) by
using a standard mean-square minimization procedure. We exploit the linear
dependence of ln[p(t)] on the parameters A, B and Cn as follows. Rewriting
formula (16) as

y(x) = A + Bf (x; Φ) +

Cngn(x; Φ) ,

N

X
n=1

where Φ encapsulates all the non-linear parameters, given the data set {(xj, yj) :
j = 1, ..., J}, the function to minimize is

(17)

(18)

Q(A, B, Cn; Φ) =

[yj − y(xj)]2 .

J

X
j=1

7

Following [15,14], the N + 2 linear parameters A, B and Cn are slaved to the
nonlinear parameters Φ by solving the following linear equations:

∂Q(A, B, Cn; Φ)/∂(A, B, Cn) = 0 .

Let ~A = [~I, ~f, ~g1, · · · , ~gN ], where ~I is the identity column vector of J elements,
~f = [f (x1), f (x2), · · · , f (xJ)]T and ~gn = [gn(x1), gn(x2), · · · , gn(xJ )]T . Then
the solution of Eq. (19) is

[A, B, C1, · · · , CN ]T = ( ~AT ~A)−1( ~A~y)T ,

where ~y = [y1, y2, · · · , yJ]T . In the minimization of Q(A, B, Cn; Φ) given by
(18), the linear parameters A, B and Cn are determined accordingly to Eq. (20)
as a function of the nonlinear parameters Φ. The minimization process then
reduces to minimizing Q(A, B, Cn; Φ) with respect only to the nonlinear pa-
rameters Φ. In order to obtain the global solution, we employ the taboo search
[2] to determine an “elite list” of solutions as the initial solutions of the en-
suing line search procedure in conjunction with a quasi-Newton method. The
best ﬁt is regarded to be globally optimized.

3.2 Jack-knife method to truncate the inﬁnite series

For a practical implementation, it is necessary to truncate the inﬁnite series
in (16) and (17) at a ﬁnite order N. The larger N is, the ﬁner are the struc-
tures, as seen from the fact that, using (12), the real part of x−sn equal to
xm cos [ωn ln(t − tc)] involves faster and faster oscillations as n increases. Using
a larger number N of terms in (16) and (17) is bound to improve the quality of
the ﬁt by construction since the mean-square minimization with N + 1 terms
is obviously encompassing the mean-square minimization with N terms, this
later case being retrieved by imposing CN +1 = 0. We thus need a criterion
for characterizing the trade-oﬀ between the improvement of the ﬁts on one
hand when increasing N and the associated increase in complexity (or lost
of parsimony). For this, we adapt the Jack-knife method [24] in the following
way. For a ﬁxed N, we take away one observation (xk, yk) from the time series
{(xj, yj) : j = 1, · · · , J}, estimate the best ﬁt characterized by its nonlinear
parameters Φk using all observations but (xk, yk), and try to predict ˆyk, using
the estimated function. We then repeat this procedure for every observation
and get the average “prediction error”

(19)

(20)

(21)

σN = 


1
J

J

(yj − ˆyj)2


X
j=1

1/2

,

8

which is a function of N. The optimal N, noted N ∗, is such that by

σN ∗ = min

{σN : N ∈ N } .

N

(22)

This Jack-knife method is used usually for a sample of large size, generated
by an unknown but ﬁxed regression curve (e.g. a polynomial of an unknown
degree). By the Jack-knife method, one determines once and for all the prefer-
able degree of the approximating polynomial for the whole sample, i.e., the
regression curves do not change from one sample point to another sample
point. If the size of the time series J is too large, σN tends asymptotically to
the the r.m.s. χN of the ﬁt errors in the jack-knife test which tends to the
r.m.s. χ of the ﬁt errors with no points deleted. Hence, σN is a monotonously
decreasing function of N. Since we are interested in predictions over more
than a one day horizon to minimize the impact of market noise, we extend the
Jack-knife by partitioning the time series into groups of u successive points.
In each ﬁt, a group of points are deleted and the previous Jack-knife method
is applied simultaneously to the u consecutive points to determine which N
leads to their best and most robust prediction.

We ﬁt the S&P500 time series by Eq. (16) for N = 1, · · · , 10. This process
is repeated for u = 1, · · · , 5. The set of free nonlinear parameters is ΦN =
(tc, m, ω, ψ1, · · · , ψN ). In all these ﬁts, we ﬁnd a very robust value for the ﬁtted
critical time (which is the theoretical starting time of the 2000 anti-bubble)
given by tc = August 8, 2000 ± 10 days. This result is in good agreement our
previous result tc = August 9 ± 5, 2000 obtained by varying the beginning of
the ﬁtted time window [22].

Figure 2 illustrates how we determine the optimal value for the number N
of terms in (16) using the extended Jack-knife method describe above. The
dashed line with open circles corresponds to deleting only one point (u = 1).
In contrast with the monotonous decrease of σN obtained for u = 1, two local
minima at N = 4 and N = 6 occur for all u > 1, while the best minimum of
σN ∗ deﬁned by (22) is obtained for N = 6. We shall thus perform all our ﬁts
with six terms in the series (16) and (17).

3.3 A parsimonious model of the discrete hierarchy of ﬁve crashes

Within the present RG theory whose solution is expressed in the form of
the “Weierstrass-type functions” (8), additional singularities other than that
occurring by deﬁnition at xc = 0 appear when the phases ψn in (14) all vanish
so that all log-periodic power laws x−sn in the expansion (10) are perfectly
in phase for x coincident with the inﬁnitely discrete sets xq = 1/γq with q
integer. Appendix B of Ref. [5] demonstrates using a renormalization group

9

method applied to the series (10) that FS(x) behaves, in the vicinity of these
singular points xq, as

FS(x) ∼ constant + c|x − xq|m− 1
2 ,

(23)

where c is a constant. Thus, for 0 < m < 1/2, spikes develop that correspond
to a divergence of FS(x) as x → xq = 1/γq. For 1/2 < m < 3/2, FS(x) goes
to a ﬁnite value as x → xq but with an inﬁnite slope (since 0 < m − 1
2 < 1).
The appearence of this set of singularities described by (23) is fundamentally
based on the coherent “interferences” between all log-periodic oscillations in
the inﬁnite series expansion (10). These singularities disappear as soon as the
phases are a function of n due to the ensuing dephasing. In particular, for
generic phase functions, the phases are ergodic as a function of n and the
singularities give place to no-where diﬀerentiable function (for m < 1) [5].

Therefore, in order to reconstruct the ﬁve crashes shown in Figure 1, we ﬁrst
impose ψn = 0 and search for the best ﬁt of the S&P500 time series by
expression (15) with Cn = C/nm+0.5, n = 1, ..., N, truncated at N = 6.
Compared with the more general expression (16), equation (15) has only three
linear parameters A, B and C instead of eight (A, B, C1, · · ·, and C6). We ﬁt
the S&P500 data from August 21, 2000 to August 24, 2002 and exclude the
later data (the last four months at the time of writing) because August 24,
2002 is close to the end of the last complete log-periodic oscillations and the
later data contains only a small part of the next extrapoled cycle. Our tests
show that taking into account such a fraction of a log-periodic cycle in such
an expanding anti-bubble may have a signiﬁcant impact in the quality of the
ﬁts. Similarly, when we ﬁt the time series ending in March 2002 at which the
preceding cycle has completed less than its period, the retrieved log-periodic
structure is quite distorted. We shall come back to this issue in details in Sec. 4
regarding its impact on the prediction of the future.

Figure 3 shows the best ﬁt (in thick wiggly line) of the S&P500 index with
formula (15) with ψn = 0, Cn = C/nm+0.5, n = 1, ..., N, truncated at N = 6.
The values of the parameters are tc = July 26, 2000, m = 0.53, ω = 11.43,
A = 7.39, B = −0.0141, and C = −0.0022. The r.m.s. of the ﬁt residuals is
0.0256 (with only three free nonlinear parameters). In comparison, the r.m.s. of
the ﬁt residuals with expression (1) is 0.0325 (four free nonlinear parameters)
and with the extension including the second harmonic is 0.0265 (ﬁve free
nonlinear parameters). Since C is determined from the ﬁt with N = 6, it can
be used to extrapolate to the large N limit and we thus also show the formula
for N = 1000 (thin smooth line with sharp troughs), which approximates very
well the singularities at the ﬁve times of the crashes. Since m = 0.53 is larger
than 1/2, the ﬁt selects the class of singularities with ﬁnite end-log(price) and
inﬁnite slope. However, since m is so close to the borderline value 0.5, the
price trajectory predicted by (23) is essentially undistinguishable numerically

10

for a logarithmic singularity of the form FS(x) ∼ ln |x − xq|. Such logarithmic
singularities have been derived from a simple theory of positive feedback on
risk aversion [1] and has been used as a trick to remove the exponent parameter
from the ﬁtting procedure [25,26] (see however [10]).

This model reproduces remarkably well the structure of the S&P500 index,
including both the overall log-periodic power law decay of the anti-bubble and
the discrete hierarchy of the ﬁve crashes shown with arrows in Figure 1.

3.4 The role of the phase

Ref. [5] has shown that the dependence of the phases ψn in Eq. (15) and
Eq. (16) as a function of n plays a central role in determining the structure
of the solution. Expanding ψn as ψn = apnp + ... + a1n + a0, where p is the
degree of the polynomial expansion of ψn in powers of n, we ﬁnd by ﬁtting
it to the price series for p = 0, 1, 2, 3, 4, 5 that only for p = 0 and p = 1 can
one obtain the singular behavior obtained for ψn = 0 (recovered for p = 0)
shown in ﬁgure 3. The reason is that only for p = 0 and p = 1 are the phases
ψn suﬃciently regular to allow for constructive interference of the successive
harmonics of Eq. (15) and Eq. (16).

For the ﬁt with p = 1, we ﬁnd the following parameter values: tc = 04-
Aug-2000, m = 0.542, ω = 11.4, a = −252, A = 7.365, B = −0.012, and
C = −0.0020, with a r.m.s. of the ﬁt residuals equal to χ = 0.0259. We ﬁnd
that all these parameters are very stable and robust except a which is not well
constrained.

To demonstrate the phenomenon of destructive interferences between the log-
periodic oscillations of successive harmonics, let us consider the simple model
ψn = ωn2. Following the same ﬁtting procedure as in Sec. 3.3 with N = 6,
Fig. 4 shows the best ﬁt (smooth continuous line) compared with the data
(dots), corresponding to the parameters tc = August 7, 2000, m = 0.69, ω =
10.61, A = 7.32, B = −0.0043, and C = 0.0008. The r.m.s. of the ﬁt residuals
is 0.0312 (three free nonlinear parameters). The wiggly continuous curve is
constructed by inserting these ﬁtted parameters into Eq. (15) with N = 1000,
leading to a continuous but non-diﬀerentiable function (in the limit N →
+∞). Notice that these two functions capture quite well the complex structure
of ups and downs occurring at multiple scales but fall short of ﬁtting the ﬁve
sharp drops of crashes analyzed in the previous Sec. 3.3. Freeing parameter ω
and adding one parameter a in the ﬁtting procedure of the quadratic model
ψn = an2 improves the goodness-of-ﬁt by decreasing r.m.s. of the ﬁt residuals
to χ = 0.274 with parameters moved to tc = August 3, 2000, m = 0.59,
ω = 11.2, a = 454, A = 7.355, B = −0.0090, and C = 0.0016. But again, no

11

sharp drops are reconstructed due to the incoherent interferences between the
oscillations at diﬀerent scales.

As a second illustrative example, let us take the phases corresponding to the
asymptotic dependence of the phases of the Weierstrass function given by
(13), that is, ψn = ωn ln(ωn). With N = 6, we follow the same procedure
as in Sec. 3.3. Fig. 5 shows the ﬁtted function (smooth continuous line) with
parameters tc = July 27, 2000, m = 0.67, ω = 11.18, A = 7.34, B = −0.0051,
and C = 0.0009. The r.m.s. of the ﬁt residuals is 0.0309. The wiggly continuous
curve is constructed by inserting these ﬁtted parameters into Eq. (15) with
N = 1000, leading to a continuous but non-diﬀerentiable function (in the limit
N → +∞). Again, this model does not capture the ﬁve crashes described in
Sec. 3.3. Replacing ω by two free parameters to obtain ψn = bn ln(cn) improves
the goodness-of-ﬁt by decreasing the r.m.s. of the ﬁt residuals to χ = 0.280,
but without much diﬀerences in the other parameters and no improvement to
describe the 5 crashes.

In sum, Fig. 4 and Fig. 5 put in contrast with Fig. 3 show that the ﬁve crashes
can be described accurately together with the overall anti-bubble structure
by a coherent interference of the log-periodic harmonics occurring for the
model with ψn = 0 while any other model of phases that desynchronizes the
harmonics destroys the singularities and leads to a larger r.m.s. of the ﬁt
residuals.

4 Predictions

Up to now, we have shown that the model (15) with ψn = 0 provides the
best parsimonious description of the anti-bubble regime of the USA S&P500
index, improving upon our previous model [22] by ﬁtting remarkably well the
ﬁve crashes indicated by the arrows in ﬁgure 1. Notwithstanding the justi-
ﬁcation of our approach by the general renormalization group model, we do
not have a microscopic model allowing us to justify rigorously the model (15)
with ψn = 0 based upon the detailed understanding of how each individual
investor behavior is renormalized into a collective dynamics of this type. As
an alternative, we propose that a crucial test of the model (15) with ψn = 0
lies in its predictive power. We thus analyze its retro-active predictive power
and then present a prediction for the future, that reﬁnes and complement our
prediction issued in [22].

12

4.1 Retroactive predictions

By retroactive predictions, we mimick a real-life situation in which, at any
present time tlast, we ﬁt the past time series up to tlast, issue a prediction on
the evolution of the price over, say, the next month and then compare it with
the realized price from tlast to one month after tlast.

Figure 6 compares the realized future prices to ten predictions of the S&P
500 index using Eq. (15) with N = 6 and ψn = 0 for ten ﬁctitious present
dates from 02-Jan-2001 (bottom) to 22-Oct-2002 (top). Showing ten translated
replicas of the S&P 500 allows us to represent and compare the ten predictions
in a synoptic manner. In each replica, the dots are the real price data, the
smooth continuous line shows the ﬁt up to the ﬁctitious present tlast and the
dashed line is the prediction beyond tlast obtained by extrapolating Eq. (15).

The ﬁrst two predictions for tlast = Jan 2, 2001 and tlast = Mar 15, 2001 fail
to give the correct trend. The predictions for tlast = May 25, 2001 and tlast =
Aug 7, 2001 capture the trend of the price trajectory but are too pessimistic.
However, these two predictions suggest that there is a signiﬁcant endogenous
drop in the beginning of September, 2001, before the 9/11 terrorist attack
happened. In general, the predictions after tlast = Oct 23, 2001 are in excellent
agreement with the real data and are very robust. In addition, the last three
predictions are successful in suggesting the future happening of an instability
in the form of two close sharp drops between July and November of 2002.

Let us now quantify the predictive skill of Eq. (15) with N = 6 and ψn = 0 by
calculating the percentage of success for the prediction of the sign of the return
r(t; ∆t) = ln[p(t + ∆t)] − ln[p(t)] from the ﬁctitious present tlast to the time
tlast + ∆t, that is, over a time horizon of ∆t days. For each successive ﬁctitious
present tlast, a new prediction is issued to predict the sign of r(last; ∆t). We
investigate prediction horizons ∆t spanning from 1 day to 200 days. For each
∆t, we calculate the success rate from a starting time tenter to November, 21,
2002 and consider ﬁve diﬀerent starting time tenter to test for the robustness
of the results. The results are presented in Fig. 7. The prediction success
percentage increases with ∆t from a minimum of 53% for ∆t = 1 day to above
90 − 95% for ∆t > 120 days. This extraordinary good success for the larger
time horizons only reﬂects the overall downward trend of the S&P500 market
over the studied time period and is thus not a qualiﬁer of the model. More
interesting is the observation that the success rate increases above 70% for
∆t > 20 days. In addition, the results are robust with respect to the changes
of the starting date tenter. We consider the plateaus at about 75% success rate
in the range ∆ = 20 ∼ 70 days to reﬂect a genuine predictive power of the
model.

13

If indeed the model has predictive power, we should be able to use it in order
to generate a proﬁtable investment strategy. This is done as follows. For sim-
plicity, we assume that a trader can hold no more than one share (position +1)
or short no more than one share (position −1). In addition, a trader is always
invested in the market, so that her position is ±1 at any time. For a given ∆t,
at a given time tlast, if the model predicts that, at time tlast + ∆t, the price
will go up (r(tlast; ∆t) > 0), the trader buys 2 shares at the price p(tlast) if she
was holding −1 share or holds her existing share if she has already one. Anal-
ogously, if the prediction shows that the price will go down (r(tlast; ∆t) < 0),
she sells 2 shares at the present time tlast at the price p(tlast) if she was holding
1 share or holds her existing −1 short position if she is shorting already. Each
prediction and reassessment of her position is performed with a time step of
∆t days. We do not include transaction costs or losses from the motion of the
price during a transaction. Their impact can easily be incorporated and they
are found not to erase the signiﬁcant arbitrage opportunity documented here.

The initial wealth of each trader is +1 share of stock at the initial time taken
to be tenter = Jan 2, 2001. Figure 8 shows the time dependence of the trader’s
wealth W (t) for diﬀerent values of ∆t. We compare this wealth with the
“short-and-hold” strategy, the symmetric of the usual “buy-and-hold” strat-
egy adapted to the overall bearish nature of the S&P500 price trajectory
over the studied period. It is clear that all the strategies using our model
outperform signiﬁcantly the naive “short-and-hold” strategy. The correspond-
ing Sharpe ratios, R(∆t), deﬁned as the ratio of the average daily return
ln[W (t + 1)] − ln[W (t)] divided by the standard deviation of the daily return,
are shown in Figure 9 as a function of ∆t for ﬁve diﬀerent starting times tenter
of the strategies. Our trading strategies have a daily Sharpe ratio of the order
of 0.1 − 1.4. In comparison, the Sharpe ratio of the “short-and-hold” strategy
is 0.06. Thus, the impact of our strategy is roughly to double the Sharpe ra-
tio. Translated into the standard yearly sharp ratio, a daily value 0.1 − 0.14
gives a quite honorable value in the range 1.5 − 2.2 compared with 0.9 for the
“short-and-hold.”

4.2 Forward predictions

The predictions shown in Fig. 10 use the US S&P 500 index from August 21,
2000 to August 24, 2002 which is ﬁtted by Eq. (15) with N = 6 and the three
diﬀerent phases ψn = 0, ψn = ωn2 and ψn = ωn ln(ωn) respectively. Once the
parameters of these three models have been determined, we construct the cor-
responding Weierstrass-type functions with N = 1000 terms. The predictions
are obtained as straightforward extrapolations of the three Weierstrass-type
functions in the future. The predictions published in [22] using the log-periodic
formula (1) with a single angular log-frequency ω (dashed line) and including

14

its harmonics 2ω (dash-dotted line) are also shown for comparison.

Fig. 11 is the same as Fig. 10 but is updated by including the US S&P 500
index data from August 21, 2000 to January 8, 2003. One can observe that
the two predictions are very similar. The parameters of the corresponding ﬁts
are listed in Table 1.

According to these predictions, we can expect an overall continuation of the
bearish phase, punctuated by some local rallies. An overall increasing market
until the ﬁrst quarter of 2003 is predicted, which should be followed by several
months of more or less stable prices. Then, we predict a rather rapid descent
(with maybe one or two severe ups and downs in the middle) which bottoms
during the ﬁrst semester of 2004. Quantitatively, the predictions suggests that
the S&P 500 will culminate at about 1000 in the ﬁrst quarter of 2003 and then
dive down to 650 in early/mid 2004. These results are consistent with those
in Ref. [22].

In spite of the robustness of the predictions, there is nevertheless a slight
visible diﬀerences between Fig. 10 and Fig. 11. The latest predictions shown
in Fig. 11 are shifted compared with those shown in Fig. 10 by a few months.
Technically, we see that this comes from the existence of two dips in the second
half of 2002, the ﬁrst dip being ﬁtted by the model in Fig. 10 while the second
dip seems to have a stronger inﬂuence as shown in Fig. 11.

5 Discussion and Concluding remarks

We have proposed a straightforward extension of our previously proposed log-
periodic power law model of the “anti-bubble” regime of the USA market since
the summer of 2000 [22] and which is continuing to the present day. The gener-
alization proposed here is using the renormalization group framework to model
critical points. Using a previous work [5] on the classiﬁcation of the class of
Weierstrass-like function, we have shown that the ﬁve crashes that occurred
since August 2000 can be accurately modelled by this approach, in a fully
consistent way with no additional parameters. Our theory suggests an overall
consistent organization of the investors forming a collective network which
interact to form the pessimistic bearish “anti-bubble” regime with intermit-
tent acceleration of the positive feedbacks of pessimistic sentiment leading to
these crashes. We have complemented the descriptive analysis by developing
and testing retrospective predictions, that conﬁrm the existence of signiﬁcant
arbitrage opportunities for a trader using our model. We then conclude our
analysis by oﬀering a prediction for the unknown future. Obviously, only for-
ward predictions constitute the ultimate proof of our claims. This exercise is
an additional step in our constitution of a database of forward predictions

15

whose statistical analysis will eventually allow us to conﬁrm or disprove the
validity of our models.

An additional feature may be pointed out: our analysis suggests that the
ﬁve crashes are essentially of an endogenous origin, including the one in the
ﬁrst half of September 2001, often thought to have been provoked by the 911
terrorist attack. Our analysis suggests that the market was already on its way
to a panic: the 911 event seems to have ampliﬁed the drop quantitatively
without changing its qualitative nature. A similar conclusion was obtained for
the crash of August-September 1998 often attributed to external political and
economic events in Russia [9]. In this spirit, Ref. [13] has stressed that two-
third of the major crashes in a large number of markets are of an endogenous
origin and only the most dramatic piece of news (such as the announcement
of World War I) are able to move the markets with an amplitude similar to
the endogenous crashes.

Acknowledgments: We are grateful to V.F. Pisarenko for helpful discussions
concerning the Jack-knife method and S. Gluzman for useful discussions on
Weierstrass-type functions. This work was supported by the James S. Mc
Donnell Foundation 21st century scientist award/studying complex system.

References

[1] Bouchaud, J.-P. and Cont, R., A Langevin approach to stock market ﬂuctuations

and crashes, European Physics Journal B 6, 543-550 (1998).

[2] D. Cvijovic and J. Klinowski, Taboo Search: An Approach to the Multiple

Minima Problem, Science 267 (1995) 664-666.

[3] B. Derrida, J. P. Eckmann, A. Erzan, Renormalization groups with periodic and

aperiodic orbits, J. Phys. A 16, 893-906 (1983).

[4] Edgar, G.A.,

ed., Classics

on Fractals

(Addison-Wesley Publishing

Company, Reading, Massachusetts, 1993).

[5] S. Gluzman and D. Sornette, Log-periodic route to fractal functions, Phys. Rev.

E 65, 036142 (2002).

[6] Goldenfeld, N., Lectures on phase transitions and the renormalization group

(Addison-Wesley, Advanced Book Program, Reading, Mass., 1992)

[7] K. Ide and D. Sornette, Oscillatory Finite-Time Singularities in Finance,

Population and Rupture, Physica A 307 (1-2), 63-106 (2002)

[8] A. Johansen and D. Sornette, Critical Crashes, Risk 12 (1), 91-94 (1999).

16

[9] A. Johansen and D. Sornette, Financial “anti-bubbles”: Log-periodicity in Gold

and Nikkei collapses, Int. J. Mod. Phys. C 10, 563-575 (1999).

[10] A. Johansen and D. Sornette, Modeling the stock market prior to large crashes,

Eur. Phys. J. B 9:1, 167-174 (1999).

[11] A. Johansen and D. Sornette, Evaluation of the quantitative prediction of a
trend reversal on the Japanese stock market in 1999, Int. J. Mod. Phys. C Vol.
11 (2), 359-364 (2000).

[12] A. Johansen and D. Sornette, Bubbles and anti-bubbles in Latin-American,
Asian and Western Stock markets: An emprical study, Int. J. Theoretical and
Appl. Finance 4, 853-920 (2000).

[13] A. Johansen and D. Sornette, Endogenous versus Exogenous Crashes in

Financial Markets, preprint at cond-mat/0210509 (2002).

[14] A. Johansen, O. Ledoit and D. Sornette, Crashes as critical points, International

Journal of Theoretical and Applied Finance 3, 219-255 (2000).

[15] A. Johansen, D. Sornette and O. Ledoit, Predicting ﬁnancial crashes using

discrete scale invariance, Journal of Risk 1, 5-32 (1999).

[16] B.B. Mandelbrot, The Fractal Geometry of Nature (New York, Freeman, 1983).

[17] W. Press, S. Teukolsky, W. Vetterling and B. Flannery, Numerical Recipes in
FORTRAN: The Art of Scientiﬁc Computing (Cambridge University, Cambridge,
1996).

[18] D. Sornette, Discrete scale invariance and complex dimensions, Phys. Rep. 297,

239-270 (1998).

[19] D. Sornette, Why Stock Markets Crash (Critical Events in Complex Financial

Systems), Princeton University Press, Princeton, NJ (2003).

[20] D. Sornette and K. Ide, Theory of self-similar oscillatory ﬁnite-time singularities

in Finance, Population and Rupture, Int. J. Mod. Phys. C 14 (3) (2002).

[21] D. Sornette and A. Johansen, Signiﬁcance of log-periodic precursors to ﬁnancial

crashes, Quantitative Finance 1, 452-471 (2001).

[22] D. Sornette and W.-X. Zhou, The US 2000-2002 Market Descent: How Much

Longer and Deeper? Quantitative Finance 2, 468-481 (2002).

[23] D. Sornette, A. Johansen and J.-P. Bouchaud, Stock market crashes, Precursors

and Replicas, J. Phys. I France 6, 167-175 (1996).

[24] Stone, M., Cross-validatory choice and assessment of statistically prediction

(with discussion), J. Roy. Statist. Soc. B 36, 111-147 (1974).

[25] N. Vandewalle, Ph. Boveroux, A. Minguet and M. Ausloos, The crash of October
1987 seen as a phase transition: amplitude and universality, Physica A 255, 201-
210 (1998).

17

[26] N. Vandewalle, M. Ausloos, P. Boveroux and A. Minguet, How the ﬁnancial
crash of October 1997 could have been predicted, Eur. Phys. J. B 4, 139-41 (1998).

[27] W.-X. Zhou and D. Sornette, Evidence of a Worldwide Stock Market Log-

Periodic Anti-Bubble Since mid-2000, preprint at cond-mat/0212010.

18

Table 1
Values of the parameters of the ﬁts of the S&P500 index from Aug-09-2000 to tlast
given in the ﬁrst column with formula (15) for diﬀerent models of the phases ψn. χ
is the r.m.s. of the ﬁt residuals.

tlast

Aug-24-2002

Aug-24-2002

Jan-08-2003

Jan-08-2003

ψn

0

ωn2

0

ωn2

tc

m

ω

A

B

C

χ

19-Jul-2000

0.52

11.41

7.40

-0.0146

-0.0022

0.027

02-Aug-2000

0.69

10.59

7.33

-0.0044

0.0008

0.031

Aug-24-2002 ωn ln(ωn)

27-Jul-2000

0.67

11.18

7.34

-0.0052

0.0010

0.030

30-Jul-2000

0.82

10.37

7.31

-0.0019

-0.0004

0.036

31-Jul-2000

0.84

10.55

7.31

-0.0016

0.0003

0.035

Jan-08-2003 ωn ln(ωn)

22-Jul-2000

0.83

11.07

7.31

-0.0017

0.0003

0.033

19

1600

1400

1200

1000

800

)
t
(
p

Jul00 Oct00 Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02
t

Fig. 1. The price trajectory of the US S&P 500 index from August 21, 2000 to
August 24, 2002. A clear decaying log-periodic structure is visible, implying a well
developed anti-bubble. The upward arrows indicate the very large and sharp drops
or crashes in the price evolution, which will be modelled in this paper as approximate
local singularities. The lines are the ﬁts by the log-periodic power law formula (1)
including a single angular log-frequency ω (continuous line) as well as its harmonics
2ω (dashed line).

20

u = 1
u = 2
u = 3
u = 4
u = 5

N

σ

0.036

0.034

0.032

0.03

0.028

0.026

0.024

0.022
1

2

3

4

5

6

7

8

9

10

N

Fig. 2. Standard deviation σN of the errors in predicting the values of u successive
data points as a function of the number N of terms in the series (15) deﬁning the
model used to ﬁt the data. This constitutes a slight generalization of the Jack-knife
method. The downward pointing arrows indicate the ﬁrst two minima of σN at
N = 4 and N = 6 for u > 1. The “global” minimum lies at N = 6.

21

Real data
N = 6
N = 1000

1100

)
t
(
p

1600

1500

1300

900

700

Jul00 Oct00 Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02
t

Fig. 3. Fit of the price trajectory of the US S&P 500 (dots) by the model deﬁned
by Eq. (15) with N = 6 and ψn = 0. The ﬁtted function is shown as the continuous
wiggly line. The values of the ﬁtted parameters are: tc = July 26, 2000, m = 0.53,
ω = 11.43, A = 7.39, B = −0.0141, and C = −0.0022. The r.m.s. of the ﬁt residuals
is 0.0256. The smooth continuous curve exhibiting local singularities (sharp drops)
is constructed by inserting these ﬁtted parameters into Eq. (15) with N = 1000.

22

Real data
N = 6
N = 1000

1600

1400

1200

1000

800

)
t
(
p

Jul00 Oct00 Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02
t

Fig. 4. Fit of the price trajectory of the US S&P 500 (dots) using Eq. (15) with
N = 6 and ψn = ωn2. The values of the parameters are: tc = August 7, 2000,
m = 0.69, ω = 10.61, A = 7.32, B = −0.0043, and C = 0.0008. The r.m.s. of the
ﬁt residuals is 0.0312. The thin wiggly curve is constructed by inserting the ﬁtted
parameters into Eq. (15) with N = 1000. Freeing the parameter ω in the phase
ψn = ωn2 by adopting ψn = an2 improves the goodness-of-ﬁt to the r.m.s. of ﬁt
residuals equal to χ = 0.274.

23

Real data
N = 6
N = 1000

1600

1400

1200

1000

800

)
t
(
p

Jul00 Oct00 Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02
t

Fig. 5. Fit of the price trajectory of the US S&P 500 (dots) using Eq. (15) with
N = 6 and ψn = ωn ln(ωn). The values of the parameters are: tc = July 27, 2000,
m = 0.67, ω = 11.18, A = 7.34, B = −0.0051, and C = 0.0009. The r.m.s. of the
ﬁt residuals is 0.0309. The thin wiggly line is constructed by inserting the ﬁtted
parameters into Eq. (15) with N = 1000. Freeing the parameter ω in the phase
ψn = ωn ln(ωn) by adopting ψn = bn ln(cn) improves the goodness-of-ﬁt to the
r.m.s. of ﬁt residuals equal to χ = 0.280.

24

]
)
t
(
p
[
n
l

Jul00 Oct00 Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02 Jan03
t

Fig. 6. Ten predictions of the S&P 500 index using Eq. (15) with N = 6 and
ψn = 0 for ten ﬁctitious present dates: 02-Jan-2001, 15-Mar-2001, 25-May-2001,
07-Aug-2001, 23-Oct-2001, 04-Jan-2002, 19-Mar-2002, 30-May-2002, 12-Aug-2002,
and 22-Oct-2002. Ten replicas of the price trajectory of the US S&P 500 (dots)
have been generated and translated vertically to allow a simple comparison of the
predictions. The continuous curves correspond to the ﬁtted part of the mathematical
function Eq. (15) with N = 6 and ψn = 0. The dashed parts give the extrapolations
of these function beyond the ﬁctitious present dates and thus correspond to the
predictions.

25

1

0.95

0.9

0.85

0.8

0.75

0.7

0.65

0.6

0.55

s
s
e
c
c
u
s
 
f
o
 
e
g
a
t
n
e
c
r
e
P

02−Jan−2001
15−Mar−2001
25−May−2001
07−Aug−2001
23−Oct−2001

s
s
e
c
c
u
s
 
f
o

 
e
g
a
t
n
e
c
r
e
P

0.75

0.7

0.65

0.6

0.55

0.5
0

50

10

100
∆t

20

∆t

30

40

150

50

200

Fig. 7. Percentage of success for the prediction of the signs of the returns over a time
horizon of ∆t as a function of ∆t for ﬁve diﬀerent starting dates of the strategies
given in the upper-left inset. The lower-right inset gives a magniﬁcation for ∆t ≤ 50.
See text for explanations.

26

Trivial strategy
∆t = 1
∆t = 8
∆t = 15
∆t = 22
∆t = 29

)
t
(

W

1800

2400

2200

2000

1600

1400

1200

Jan01 Apr01 Jul01 Oct01 Jan02 Apr02 Jul02 Oct02 Jan03
t

Fig. 8. The running wealth W (t) of a trader investing with a time step ∆t based
on the prediction of the sign of the return over the time interval ∆t. The origin
of time is chosen as tenter = Jan 2, 2001. Six time horizons are compared with the
“short-and-hold” strategy (called trivial in the inset). See text for explanations.

27

03−Jan−2001
16−Mar−2001
29−May−2001
08−Aug−2001
24−Oct−2001

)
t
∆
(
R

0.16

0.14

0.12

0.1

0.08

0.06

0.04
0

28

5

10

20

25

30

15
∆t

Fig. 9. Daily Sharpe ratio R(∆t) as a function of the time horizon ∆t for ﬁve
diﬀerent origin of time tenter.

1600

1400

1200

1000

)
t
(
p

800

600

Real data
ψ
 = 0
n
 = ωn2
ψ
n
 = ωn ln(ωn)
ψ
n
Eq. (16) with N = 1
Eq. (16) with N = 2

400

2000

2001

2002

2003

2004

2005

t

Fig. 10. Forward predictions based on the analysis of the US S&P 500 index from
August 21, 2000 to August 24, 2002 using Eq. (15) with N = 1000 obtained with the
three phase models ψn indicated in the legend. The otherwise lines are predictions
using (16) with N = 1 (dashed line) and N = 2 (dash-dotted line).

29

Real data
ψ
 = 0
n
 = ωn2
ψ
n
 = ωn ln(ωn)
ψ
n

1600

1400

1200

1000

)
t
(
p

800

600

400

2000

2001

2002

2004

2005

2006

2003
t

Fig. 11. Same as Figure 10 based on the analysis of the US S&P 500 index from
August 21, 2000 to January 8, 2003.

30

03−Jan−2001
16−Mar−2001
29−May−2001
08−Aug−2001
24−Oct−2001

)
t
∆
(
W

2400

2200

2000

1800

1600

1400

1200
0

5

10

20

25

30

15
∆t

