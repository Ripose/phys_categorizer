6
0
0
2
 
g
u
A
 
5
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
3
5
1
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Random Walks Along the Streets and Channels in Compact Cities:

Spectral analysis, Dynamical Modularity, Information, and Statistical

Mechanics

D. Volchenkov ∗and Ph. Blanchard

BiBoS, University Bielefeld, Postfach 100131,

D-33501, Bielefeld, Germany

Phone: +49 (0)521 / 106-2972

Fax: +49 (0)521 / 106-6455

E-Mail: VOLCHENK@Physik.Uni-Bielefeld.DE

February 17, 2014

Abstract

Statistics of random walks in compact cities helps to detect their modularity.The complexity of city

modularity can be measured by an information-like parameter which plays the role of an individual ﬁngerprint
of Genius loci. Global structural properties of a city can be characterized by the thermodynamical parameters
calculated in the random walks problem.

PACS codes: 89.75.Fb, 89.75.-k, 89.90.+n

Keywords: Random walks, Complex networks, city streets and channels

1

Introduction to city networks studies

Studies of urban networks have a long history. Many researches have been devoted to the

optimizations of transportation routes and power grids, to the predictions of traﬃc ﬂows be-

tween the highly populated city districts, to the investigations of habits and artefact exchanges

between distanced settlements in historical eras. In all early studies, the traﬃc end points had

been referred to as the nodes, and the routes had been considered as the edges of some spa-

tial networks. Being embedded onto the geographical landscape the planar complex networks

∗The Alexander von Humboldt Research Fellow at the BiBoS Research Center

1

bare the multiple ﬁngerprints of it in their structures. Among the main factors featuring them

are the high costs for the maintenance of long-range connections and the scarce availability of

physical space. Spatial networks diﬀer from other complex networks and call for the alternative

approaches to investigate them [1].

While studying the motifs and cycles in the complex networks, a comparative analysis of

the original graph and of its randomized version is used. If a motif is statistically signiﬁcant,

it appears in the real network at a number much higher that in the randomized versions of the

graph. However, in the planar city street patterns, its randomized version is not of signiﬁcance

since, ﬁrst, it is surely a non-planar graph due to the randomness of edge crossings and, sec-

ond, the long-range connections inevitably presented in the random graphs in abundance are

extremely costly in the real cities, [1]. In [2], it has been proposed to compare the city street

patterns with the grid-like structures that is indeed useful essentially for the regular urban

development.

In [3, 4], a signiﬁcant correlation between the topological accessibility of streets and their

popularity, micro-criminality, micro-economic vitality and social liveability had been estab-

lished. The eﬀective accessibility of cities, neighborhoods, streets, and single buildings can be

estimated by the statistical properties of a diﬀusion process describing the dynamics of a large

number of random walkers moving on the network at discrete time steps [5]. At each time step

every walker moves from its current node to one of the neighboring nodes along a randomly

selected link. The metric length of streets are of no matter for such a discrete time diﬀusion

process, and then the dual step-distance approach to the city networks is preferable: the streets

are mapped as nodes, and the intersections between every two streets are mapped as edges.

Following [6], we call such a graph as dual. In [7] it is called an information city network.

The dual graphs of a geographic network comparable in its structure with other complex

networks are irrelevant to neither distance, nor the physical space constrains.

In [8], while

identifying a street over a plurality of edges on the city map, the ”named-street” approach had

been used, in which two diﬀerent arcs of the original street network are assigned to the same

street ID provided they have the same street name. The main problem of the approach is that

the meaning of a street name could vary from one district to another even within the same

city. For instance, the streets in Manhattan do not meet, in general, the continuity principle

rather playing the role of coordinates. Being interested in the statistics of random walks, we

generalized the approach [8] in a way to account the possible discontinuities of streets. Namely,

we assign an individual street ID code to each continuous part of it even if all parts have the

same street name. The dual graph is constructed by mapping edges coded with the same street

2

ID into nodes of the dual graph, and intersections among each pair of edges in the primal graph

- into edges connecting the corresponding nodes of the dual graph.

In [6], the Intersection Continuity principle (ICN) diﬀerent from our identiﬁcation approach

has been used: two edges forming the largest convex angle in a crossroad on the city map are

assigned the highest continuity and therefore are coupled together acquiring the same street

ID. The main problem with the ICN principle [6] is that the streets crossing under the convex

angles would be artiﬁcially exchange their identiﬁers that makes the interpretation of results

on the city modularity very diﬃcult. It is important to mention that the number of street ID

identiﬁed within the ICN principle usually exceeds the actual number of street names in a city.

In [1, 6, 14, 12, 13], the degree statistics and various centrality measures for the data set of the

square mile samples of diﬀerent world cities had been investigated. However, the decision on

which a square mile would provide an adequate representation of a city is always questionable.

In this paper, we use an alternative strategy investigating the spectral properties and statis-

tical mechanics of random walks introduced in the dual (informational) graphs of compact city

patterns bounded by the natural geographical limitations. We have studied six examples of

diﬀerent streets and channels structures. Two of them are situated on the islands: Manhattan

(with an almost regular greed-like city plan) and the network of Venice channels (imprinting

the joined eﬀect of natural, political, and economical factors acted on the network during many

centuries). We have also considered two cities founded shortly after Crusades and developed

within the medieval fortresses: Rothenburg ob der Tauber (the medieval Bavarian city pre-

serving its original structure from the XIII-th century) and the Bielefeld downtown (Altstadt

Bielefeld) comprising of two diﬀerent parts: the old one founded in the XIII-th century and

the modern part subjected to the partial urban redevelopment at the end of XIX-th century.

To supplement the study, we have investigated the channel network in the city of Amsterdam.

Although it is not isolated from the national channel network, it is binding to the delta of Am-

stel river forming a dense channel web showing a high degree of radial symmetry. The scarce

of physical space is among the most important factors determining the structure of compact

urban patterns. The general information on the city networks we study is given in Tab. 1. We

compare the spectral properties of these city street and channel patterns with those of a model

example: a hypothetical village extended along one principal street and comprised of N blind

passes branching oﬀ it. The random walks spectrum for such a village is characterized by the

(N − 2)-degenerate eigenmodes, and its statistics is similar to that of ideal gas.

A square mile of New York city grid and a square mile pattern of Venice streets array

have been discussed recently in [6, 14, 12, 13], however, up to our knowledge, the city channel

3

patterns have never been subjected to the modern network analysis. The navigation eﬃciency

in the Manhattan streets has been studied in [7].

It is worth to mention the importance of implemented street identiﬁcation principle for

the conclusion on the degree statistics of dual city graphs. The comparative investigations of

diﬀerent street patterns performed in [1, 6] implementing the ICN principle reveal the scale-free

degree distributions for the vertices of dual graphs. However, in [8] it had been reported that

under the street name approach the dual graphs exhibit the small-world character, but the

scale-free degree statistics can hardly be recognized. We draw back to the paper [8] and use

the street name principle of streets identiﬁcation, the results we report on the degree statistics

are compatible with that of [8]. Compact city patterns do not provide us with a suﬃcient

data to conclude on the universality of degree statistics. The fractions of streets n(s) having s

crossroads are shown (by points) in Fig. 1 together with their cumulative distributions (solid

lines).

It is worth to mention that the cumulative degree statistics for the medieval cities

seems to approach exponential one (the plots Fig. 1.a and Fig. 1.b are given in the log-linear

scale). The rest of plots are presented in the log-log scale: Fig.1.c. (Venice channels), Fig.1.d.

(Amsterdam channels), Fig.1.e. (Manhattan streets), and Fig.1.f, for the degree statistics of

”village” model extended along one prime street and a number (200) of blind passes branching

oﬀ it, it comprises of just two points - for the prime street and for all the rest. Plots shown

in Fig. 1 display the following features common for the compact cities we have studied: 1)

broadness; 2) there is the most probable number of streets an average street would cross in a

given city; 3) there are just a few ”broadways” (reﬂected by the highly connected nodes in the

dual city graph) crossing many more streets than an average street in the city.

The structure of networks may be completely described by the associated adjacency matrix

A. The adjacency matrices of undirected graphs are symmetric matrices with elements, equal

to number of edges between the given vertices. The eigenvalues of graphs, most often deﬁned as

the eigenvalues of their adjacency matrices, have received much attention over the last decades

in concern with studies of such properties as the diameter, girth, chromatic number, and connec-

tivity. The structural modularity in a city can be revealed by the investigation of eigenvectors

of the adjacency matrix of the correspondent dual graph. However, the spectral properties of

the graph Laplacian have drawn more attention recently. It appears in many problems related

to the various dynamical processes deﬁned on graphs (like the diﬀusion process). The spectral

analysis of Laplacian helps to detect the dynamical modularity of city network which cannot

be seen from the adjacency matrix. Furthermore, the eigenvalues of adjacency matrix can be

either positive or negative, so that their spectral moments

oscillate strongly essentially

i λ−n

i

P

4

for the large networks. In contrast to them, the eigenvalues of Laplacians are always positive

that allows for the introduction of the well-known spectral functions of statistical mechanics.

The investigations of statistical properties of eigenvalues of Laplacian relevant to the random

walk process helps much in the rigorous detection of city districts (modules) interacting with

each other relatively weakly. Estimating the strength of inter-modular interactions and local-

izing the pairs of tightly related city modules generating the main dynamical ﬂows in the given

complex network, one can test the city stability with respect to breaking it up into isolated

components.

In the forthcoming section (Sec. 2), we study the structural and dynamical modularities

of dual city graphs. To detect the dynamical modularity, we consider the ensemble of large

number of random walkers moving along the edges of dual graphs in the discrete steps. We

have studied the spectral properties of dynamical process and detected precisely the dynamical

modules of the cities. Dynamical modularity is an individual characteristic of a given city, its

complexity can be measured by the information-like parameter.

In Sec. 3, we discuss the statistical mechanics of random walks in the compact city patterns.

We compute the well-known thermodynamical quantities (the internal energy, entropy, the free

energy, the heat capacity, and pressure) describing the macroscopical properties of the ensemble.

We provided the detailed explanation for each thermodynamical parameter in the context of

random walks in the compact city patterns.

We conclude in the last section.

2 Structural and Dynamical modularity of dual city graphs. Infor-

mation encoded by the dynamical modularity of a city

The structural modularity and symmetries of an undirected connected dual city graphs can
be visually revealed by the 3d-drawing with respect to the eigenvectors u(2), u(3), and u(4),
correspondent to the second, third, and fourth largest eigenvalues (in absolute value) of its
adjacency matrix [21]. Then the (xi, yi, zi) coordinates of the i−th vertex of G is (u(2)
i ).
i
Sometimes other symmetries in the graph can be seen by using other eigenvectors. In Fig. 2,

, u(3)
i

, u(4)

we have presented two city patterns (Bielefeld downtown and Rothenburg ob.d.T.) together

with their 3d representations of dual graphs. It is curious that both patterns located inside the

medieval fortresses contain precisely 50 streets. The downtown of Bielefeld comprises of the A-

part which keeps its original structure (founded in XIII-XIV cs.) and the bart B which had been

redeveloped in the XIX-th century (Fig. 2.a). The 3d dual graph of Bielefeld displays clearly the

5

structural diﬀerence between these parts: the relevant subgraphs are located in the orthogonal

planes.

In contrast to it, the city of Rothenburg ob.d.T. (Fig. 2.b) maintains its medieval

development, and its dual graph is mostly symmetric and homogeneous. The drawing with

respect to the eigenvectors could be an eﬀective tool for detecting the city districts constructed

in accordance to the diﬀerent urban development principles, in diﬀerent historical epochs if the

number of nodes in the graph is not very large.

Dynamical modularity is a localization of modes on the certain groups of nodes in a dy-

namical process introduced in a complex network. Let us consider random walks on a dual

graph G(V, E) representing a street (channel) city pattern of N streets with E crossroads. The
node degree ks = deg(s) is the number of streets the street s is crossing on the city plan. The
diﬀusion process we analyze here describes the dynamics of a large number of random walkers

moving on the network at discrete time steps. At each time step every walker moves from its

current node (street) to one of the neighboring nodes (a street crossing the initial one) along the
randomly selected link (with the probability k−1
j Aij meets
the normalization condition,

s ). The transition matrix Tij = k−1

It is related to the scaled Laplacian,

by T = D1/2(1 − L)D−1/2, in which the diagonal connectivity matrix Dij = k−1
dynamics of this process is described by the equation

p

j δij. The average

Tij = 1.

j
X

Lij = δij −

Aij
kikj

,

˙nt
i =

Lijnt
j

j
X

for the expectation value of the number of random walkers on the street i at time t, nt
i. The
total number of walkers is conserved at all times due to the normalization (1). All eigenvalues of
L belong to the interval λα ∈ (0, 2), the eigenvectors are normalized, |n(α)| = 1, and orthogonal,
n(α)n(β)
= δαβ. The linear equation (3) supplied with an initial condition n0 is solved by the
function nt = Q exp(−tJ)(Q−1n0), in which J is a block diagonal matrix (the Jordan canonical
(cid:10)
form of L), Q is the the transformation matrix corresponding to the Jordan form. Given the
eigenvalue λα with the multiplicity mα > 1, the relevant contribution to nt is given by

(cid:11)

(1)

(2)

(3)

(4)

exp(−tλα)

mα

mα−1

Xk=0  

Xl=0

cl+1

uk

tl
l! !

6

where uk is the k-th vector of the mα-dimensional eigenspace of degenerate eigenvalue λα and
cl is the l−th component of the transformed vector of initial conditions, c = Q−1n0. It follows
from (4) that in the presence of degenerate modes with mα ≫ 1 the relaxation process can be
delayed signiﬁcantly. Moreover, if λα ≤ 1 the expectation numbers of walkers in a certain city
modules would substantially increase in a lapse of time aﬀecting the network traﬃc performance.

The dynamical modularity of a given city pattern reﬂects itself in the statistical properties

of its Laplacian eigenvalues. The eigenvalues and their densities for the dual graphs of compact

urban patterns are shown in Fig. 3. The appearance of spectra allows us to divide the urban

patterns into three categories: i) the medieval cities, Fig. 3.a (Bielefeld) and Fig. 3.b (Rothen-

burg); ii) the channel patterns, Fig. 3.c (Venice) and Fig. 3.d (Amsterdam); iii) the spectra

with a highly degenerated mode, Fig. 3.e (Manhattan) and Fig. 3.f (the village model). The

density of eigenvalues of the adjacency matrices have the similar forms as that shown on Fig. 3.

It is important to note that the densities of eigenvalues for the compact urban patterns diﬀer

dramatically from those computed for the classical random graphs of Erd¨os-R´enyi model [9, 10],

deviate form the semicircular law, and the densities found for the scale-free random tree-like

graphs in [11]. In [15], the density of eigenvalues for the Internet graph on the Autonomous

Systems (AS) level had been computed. The Internet spectrum on the AS level is broadly

distributed with two symmetric maxima and similar to the eigenvalue density of random scale-

free networks. In contrast to them, the spectral density for the compact city samples are bell

shaped and tend to turn into a sharp peak localized at λ = 1 due to the highly degenerate

1-mode which would score a valuable fraction of eigenvalues (48% for Manhattan). 1-modes

come in part from pairs of streets of minimal connectivities branching of either ”broadways” or

belt roads. These structures are overrepresented in the compact city patterns. In the marginal

example displayed on Fig. 3.f, the 99% eigenvalues for the ”village” extended along one principal

street with 200 blind passes are submitted to the degenerate eigenmodes λ = 1, and the rest
two eigenvalues are λ1 = 3/2 and λN = 1/2.

The slowest modes of diﬀusion process (3) allow one to detect the city modules characterized

by the individual accessibility properties.

Indeed, these random walks do not describe the

properties of an actual city traﬃc, since the approach does not concern the lengthes of streets

referring uniquely to the topological matters. However, the modularity plays an important role

in any local dynamical process taking place in the city including its traﬃc conditions. The

primary feature of the diﬀusion process in the compact urban patterns is the ﬂow between the

dominant pair of city modules: the ”broadways” and the relatively isolated streets remote from

the primary roads.

7

Due to the proper normalization, the components of the eigenvectors n(α) play the role of
the Participation Ratios (PR) which quantify the eﬀective numbers of nodes participating in

a given eigenvector with a signiﬁcant weight. This characteristic has been used in [15] and by

other authors to describe the modularity of complex networks. However, under the abundance

of a highly degenerate mode PR is not a well deﬁned quantity (since the diﬀerent vectors in

the eigensubspace correspondent to the degenerate mode have diﬀerent PR).

As time advances the distribution of random walkers approaches a steady state n∞
which all diﬀusion currents are balanced. It corresponds to the principal eigenvector n(1)
to the largest eigenvalue of L. The relaxation processes toward the steady state are described
by the remaining eigenvectors n(α), α > 1, with the characteristic decay times τ (α), such that
exp(−1/τ (α)) = λα. The second largest eigenvalue of the scaled Laplacian (2) is related to the
graph diameter,

i ∝ ki, in
related

i

diam(G) ≤ −

ln(N − 1)
ln(λ2)

,

the maximum distance between any two vertices of the graph. It is also related to the Fiedler

vector [16] describing the algebraic connectivity of the graph. Namely, let us consider the
components of the eigenvector n(2) correspondent to the second largest eigenvalue λ2 for the
scaled Laplacian (2) deﬁned on a connected graph G(V, E). Deﬁne V1 = {v ∈ V : n(2)
v < 0}
and V2 = {v ∈ V : n(2)

v ≥ 0}, then the subgraphs induced by V1 and V2 are connected.

In general, each nodal domain on which the components of the eigenvector n(α) does not
change sign refers to a coherent ﬂow (characterized by its decay time τ (α)) of random walkers
toward the domain of alternative sign. The nodal domains participate in the diﬀerent eigen-

modes as one degree of freedom, and therefore their total number is important for detecting
the dynamical modularity of city networks. It is known from [17] that the eigenvector n(α) can
have at most α + mα − 1 strong nodal domains (the maximal connected induced subgraphs,
on which the components of eigenvectors have a deﬁnite sign) where mα is the multiplicity of
the eigenvalue λα, but not less than 2 strong nodal domains (α > 1) [18]. However, the actual
number of nodal domains can be much smaller than the bound obtained in [18]. In the case of

degenerate eigenvalues the situation becomes even more diﬃcult because this number may vary
considerably depending upon which vector from the mα-dimensional eigenspace of degenerate
eigenvalue λα is chosen. A fragment of nodal matrix for the Chelsea village (Fig. 4.a) in the
Manhattan island is shown on Fig. 4.b: the components of all eigenvectors localized on the

nodal domains displayed in white (black) have always the positive (negative) sign.

We investigate the statistics of components of eigenvectors n(α) localized on a given street,
i }α. To uncover a ﬁne modular structure of compact city patterns, we have computed the

{n(α)

8

linear correlation coeﬃcients between the lists of eigenvector components for all pairs of streets

in a city,

Cij =

Cov

{n(α)

i }α, {n(α)

j }α

Var

r

i }α

(cid:16)
{n(α)
(cid:16)

(cid:17)

Var

.

(cid:17)
{n(α)
i }α
(cid:16)

(cid:17)

(5)

The linear correlation measures how well a linear function explains the relationship between two

data lists. The correlation is positive if an increase in the eigenvectors components localized on

a given street corresponds to an increase in those related to other street, and negative when an

increase in one corresponds to a decrease in the other. The matrix plot of correlation coeﬃcients
Cij for 96 Venice channels is displayed on (Fig. 5) All diagonal elements Cii = 1 and have been
omitted.

The study of correlations between the components of eigenvectors allows us for a precise re-

covering of all dynamical modules in a city, street by street. By tuning the sensitivity threshold

κ > 0, one can detect the groups of streets characterized by the signiﬁcant pairwise correlations
Cij ≥ κ. In case of a degenerate eigenmode, the whole bunch of streets of minimal accessibil-
ity joins a correlation cluster at once. Investigating the size of clusters characterized by the

signiﬁcant pairwise correlations between the eigenvectors components, we have found that it is
very sensitive to the threshold value κ. Pairs of correlated streets can be detected for κ ≤ κc,
below the critical value κc individual for each city. For instance, the strongest correlations in
the Manhattan island (κ ≥ 0.16) are observed between the Bowery st. (Chinatown) and the

6-th Avenue (Greenwich Village), and between the Lafayette st. and Mott st. (Chinatown).

By reducing κ just by 1%, we immediately get many new correlated pairs and [South FDR Dr.,

Allen st.], [Greene st.(Soho), Ave. D], [Crosby st. (Little Italy), Ave. D], [Centre st, Elizabeth

st.], [Allen st., 6-th Ave.], [Lafayette st., Ave. B], [Broadway, West st.] among the others. In

most cases the streets in correlated pairs have the same driving directions although the driv-

ing direction data has not been initially used in the adjacency matrices. Reducing the value

of sensitivity threshold, one can detect the triples of correlated streets and more structurally

complicated dynamical modules. Then the correlated clusters merge exhibiting a sharp phase

transition into a giant connected component for essentially small κ.

The appearance of correlated k-tuples and their total numbers at given κ are by no means

random and encode the important information on the city modularity. The complexity of

dynamical modularity can be measured as a quantity of information encoded at the diﬀerent

values of κ in the following way. The probability that a certain connected correlated k-tuple

9

appears in the random labelled graph of N nodes equals to

pk(N) =

−1

,

N
k !

 

and the relevant information is I = −pk(N) log2 pk(N). For a mesh of values κ > 0, we had
counted the total numbers of correlated k-tuples appeared in each city, Nk(κ), and found the
total amount of information I(κ) encoded by the dynamical modularity,

I(κ) = −

Nkpk (|V |) log2 pk (|V |) .

(6)

Xk−tuples

It is worth to mention that in the absence of correlations as well as in the case when all nodes in

the dual city graph are simultaneously correlated, no information can be encoded, and therefore

I = 0. The results on the comparative information analysis of dynamical modularities in the

cities are displayed in Fig. 6.

In general, the dynamical modularity in ancient cities contains more information then that

in the modern or redeveloped cities. However, the amounts of information (and it appearance

with κ) calculated for Rothenburg and for the downtown of Bielefeld (subjected to a partial

redevelopment) are almost equal (Fig. 6.a). Both medieval cities contains a number of streets

characterized with the relatively highly correlated traﬃc (they are the belt roads encircling

the cities along the fortress walls), while the traﬃc along the streets close to the city centers

appears to be less correlated, although all streets of low accessibility join the correlation cluster

at once at some level κ, then the information on the dynamical modularity turns to zero.

Information proﬁles obtained for the Venice and Amsterdam channel patterns look similar

(see Fig. 6.b). However, it seems that a message on possible correlations in the gondoliers

traﬃc would be much more valuable than a cruise schedule along the Amstel embankments.

The triggering between diﬀerent information states seen on Fig. 6.b reveals the merging of

correlated clusters into the bigger correlated modules. The information peaks located close to

κ = 0 indicate the phase transitions to a giant correlated component. It is important to note

that not all channels join the giant correlated module (since the amount of information is not

zero as κ → 0, but, on the contrary, turns to be very high). There is also an anti-correlated

module in the channel patterns we have considered, in which the components of Laplacian
eigenvectors are negatively correlated, Cij < 0.

The scale of the graph shown in Fig. 6.c is incompatible with those of Fig. 6.a and Fig. 6.b

since the dynamical modularity in the Manhattan island (one of the most regular city grids

in the world) contains much less information (it comes primarily from the region close to the

Central park) than that in the ancient cities.

10

3 Statistical mechanics of random walks in a compact city.

A number of diﬀerent measures quantifying the various properties of complex networks has

been proposed in so far in a wide range of studies in order to distinguish the groups of nodes

and enlighten the relations between them. Some measures can be computed directly from the

graph adjacency matrix: likelihood [24], assortativity [25], clustering [26], degree centrality [20],

[27], [28], betweeness centrality [28], link value [29], structural similarity [23], distance (counting

the number of paths between vertices) [30]. Other measures (concerned with the networks

embedded into Euclidean space) involve the lengths of links or the true Euclidean distances

between nodes: closeness centrality [20], [31], straightness centrality [32], [33], expansion [29],

information centrality and graph eﬃciency [33],[34]. A good summary on the several centrality

measures can be found in [14] and in [35] for the Internet related measures. The list of avail-

able measures is still far from being complete, the new measures approach together with any

forthcoming network model. It is also worth to add some spectral measures (concerned the

eigenvalues of graph adjacency matrix): subgraph centralization [36], subgraph centrality [22],

network bipartivity [37] and many others.

In the present section, we study the statistics of ﬂows of random walkers roaming in the

compact city patterns. The walkers we concern have no masses and do not interact with

each other. They do not play a part neither in the energy nor in the momentum transfer.

Nevertheless, the ﬂows have the nontrivial thermodynamical properties due to the complex

topology of streets and channels they move along. Therefore, while considering the statistical

mechanics of random walkers, we hope to learn more about the entire properties of cities. The

obvious advantage of the approach is that the measure and all relations between the statistical

moments are well known within the thermodynamic formalism.

In the what following, we use the inverse temperature parameter β > 0 which can be

considered as an eﬀective time scale in the problem (the number of streets a walker passes
in one clock tick). Since the eigenvalues λα of scaled Laplacian operator (3) are positive and
bounded, one can deﬁne three well known spectral functions for them:

1. the heat kernel (the partition function),

K(β) = Tr exp (−βL) =

e−βλα,

(7)

converging as β ≥ 0,

N

α=1
X

11

(8)

(9)

(10)

(11)

(12)

2. the spectral zeta function (the spectral moments)

3. and the spectral density,

These spectral functions are related to each other by the Laplace transformation,

and by the Mellin transformation [38],

Furthermore,

ζ(s) =

λ−s
α ,

N

α=1
X

ρ(λ) =

δ(λ − λα).

N

α=1
X

K(t) =

dλ e−βλρ(λ),

ζ(s) =

1
Γ(s)

∞

βs−1K(β)dβ.

ζ(s) =

ρ(λ)λ−sdλ.

∞

0
Z

0

Z

∞

−∞

Z

ζ(−n) < N · 2n,

ζ(n) > N · 2−n.

(−1)nK (n)(β) ≥ 0, β > 0, n ≥ 1,

Let us note that since 0 < λα < 2, we immediately obtain estimations for the spectral moments,

The partition function K(β) meets the criterium of Bernstein’s theorem [19]:

and therefore deﬁnes a unique non-negative measure dµ(β) = K(β)dβ on R+ providing the
solutions for the Hamburger and Stiltjes moments problems, [38]. Concerning the list of mea-

sures given above, it is worth to note that, in principle, any of spectral functions (7-9) at a
given temperature β−1 can be used as a measure of some quantities relevant to the random
walk problem in question.

The ensemble of random walkers in the graph G(V, E) can be characterized by the following
macroscopical quantities: 1) the internal (averaged) energy, ¯E = −∂β ln K(β); 2) the entropy,
S = ln K(β) + β ¯E; 3) the free energy, F = β−1 ln K(β); 4) the heat capacity at constat
city size, C|V | = β2∂2
β ln K(β), and 5) the pressure, P = β−1∂|V | ln K(β). In the last equality,
we have considered the diﬀerential with respect to the graph size as d|V | = ρ(λ)dλ. The

thermodynamics of compact urban city patterns is presented on the Figs. 7-10 and in Tab. 2.

The data collected give an insight into the various aspects of the averaged street (channels)

accessibility in a given city.

12

Due to a complicated topology of city streets and channels, the ﬂows of random walkers

acquire the internal energy, the ensemble average of the total energy of the system, which grows
with temperature β−1 (albeit still bounded in the interval [0,2]). As usual, the absolute value
of internal energy relevant to a given city cannot be precisely measured, but we can measure

its diﬀerence in any temperature interval. In Fig. 7.(a-c), we have combined the energy proﬁles

taken from the urban patterns according to the similarity of their spectra. In principle, the

slope of energy curve is steeper (the energy grows faster) in the modern cities with a quite

regular grid-like structures in which any street has a relatively good accessibility.

In physics, there is a measurable quantity that characterizes the ability of a body to store

heat as it changes in temperature.

It is sensitive to the size of the object and its internal

structure. In Fig. 8 (a-c), we have shown the heat capacity proﬁles (the sizes of compact cities

are indeed ﬁxed) via the inverse temperature β.

In fact, these graphs provide us with the

complimentary information on the dynamical modularity of cities. The asymptotic behavior
of heat capacity for large temperatures β−1 ≫ 1 (β → 0) is uniform within each category of
compact urban patterns we studied and can be used as an indicator in the classiﬁcation of city

patterns. The individual structural characteristics of each city can be uncovered in the mean

temperatures.

In terms of statistical mechanics, the entropy describes the number of the possible micro-

scopic conﬁgurations of the system. In the problem of random walks in the compact cities, its

value quantiﬁes the diversity of ﬂows which can be detected in the city at a given temperature,

it grows with temperature. In Fig. 9 (a-c), we have displayed the entropy curves. It is impor-

tant to mention that the improve of street accessibility causes the decrease of entropy growth

rates for large temperatures. The entropy of random walkers ﬂows as well as the rate it grows

with temperature increase in Manhattan is ever less than in any other city we studied.

One can say that the random walkers loss their ways in the highly entangled meshes of city

street and channels, and it takes long time for them to cross a city roaming randomly along the

streets. This can be interpreted as an eﬀect of slight negative pressure involving the walkers

into the city. It is obvious that such a pressure should vary from one district to another within

a city. However, it follows from the previous section that the dynamical modularity of a city

has no a rigorous bind to its administrative units, but to the localization of eigenmodes λ on

the certain city streets that is why we have studied the pressure spectra P (λ) in the cities (see

Fig. 10). Generally speaking, the more junctions has a city, the stronger is the drag force:

despite Venice has more channels than in Amsterdam, the number of junctions between them

is less than in Amsterdam, and therefore the negative pressure in the latter city is stronger

13

(Fig. 10.a). The numbers of streets in Rothenburg and in the downtown of Bielefeld are equal,

but there are more crossroads in Bielefeld than in Rothenburg (Fig. 10.b).

One can see that pressure proﬁles have maxima (correspondent to a minimal drug force)

located at some eigenmodes (for Amsterdam, Venice, and Manhattan, it is λ = 1). It calls for

the idea of a city ”transparency corridor”, a sequence of streets following which the city can

be crossed in minimal time. In Manhattan, the pressure proﬁle almost touches zero at λ = 1

due to Broadway and FDR Drive. In Venice, the minimal pressure is for the Grand Canal and

Giudecca Canal, and it is for Het IJ and Amstel river in Amsterdam.

In Tab. 2,we have sketched the ﬁgures for the internal energy, entropy, the free energy, and

heat capacity for all studied cities at β = 1, in purpose of comparison. We also gave the location

of maxima for the heat capacity proﬁles.

4 Discussion and Conclusion

We conclude the analysis of street and channel patterns in compact cities with a discussion

on the possibility to apply the approach for the study of other complex networks.

The use of tools developed in statistical mechanics provides us with a detailed picture of local

and global properties of city structures. The structural modularity of a city can be revealed

visually by means of drawing its dual (informational) graph with respect to three eigenvectors

relevant to the largest eigenvalues of its adjacency matrix. Sometimes, other eigenvectors can

be used.

Dynamical modularity representing the localization of dynamical modes on the certain

streets and channels cannot be detected from the adjacency matrices. We have studied the

random walks of a large number of massless particles introduced in the dual graphs of compact

cities and investigated their statistical properties. The spectrum of Laplace operator is broadly

distributed for the compact city patterns and has a bell shape. However, it turns into a sharp

peak (a highly degenerate mode) if there is a number of low accessible streets branching of a

prime street in a city.

To detect the dynamical modularity precisely, we have computed the linear correlation co-

eﬃcients between the lists of eigenvector components for all pairs of streets (channels) in the

cities. Tuning the sensitivity threshold of correlations, one can detect the various modules

of essentially correlated streets. The complexity of dynamical modularity can be measured

by the information quantity. The information versus correlation proﬁle is an individual city

ﬁngerprint.

14

The statistical mechanics description of random walks in the compact cities provides us with

a rigorous deﬁnition of the unique measure and all statistical moments which have a deﬁnite re-

lation to the entire topological properties of complex networks. Due to a complicated topology

of city streets and channels, the ﬂows of random walkers acquire the nontrivial thermodynam-

ical characteristics which can be implemented in studies of interactions between diﬀerent city

modules and of city stability with respect to occasional accessibility problems that would be of

vital importance for the city traﬃc conditions in urgency.

The obvious advantage of the method is that the information on the role of a given street

or channel in the entire city network can be interpreted by the very end, and all city modules

can be named street by street.

The method can be easily generalized for the complex networks which can be described by

the weighted graphs. For instance, one can consider a graph of city plan in which the weights of

edges are the actual lengthes of streets. In the case of weighted adjacency matrix, the spectrum

of relevant Laplace operator acquires the pairs of complex conjugated eigenvalues. Then the

components of eigenvectors are also complex, and the coeﬃcients of linear correlations should

be computed for the real and imaginary parts of spectrum separately. Other approach could be

used while studying the undirected graphs which adjacency matrix is not symmetric in general.
Instead of Laplacian L, one can consider the pair of squared Laplacian operators LL† and L†L
which spectrum is real and positively deﬁned [39].

5 Acknowledgements

One of the authors (D.V.) is grateful to the Alexander von Humboldt Foundation (Germany)

and to the Bielefeld-Bonn Stochastic Research Center (BiBoS, Bielefeld, Germany) for the

ﬁnancial support and hospitality. We thank R. Lima for the fruitful discussion and comments.

References

[1] A. Cardillo, S. Scellato, V. Latora, S. Porta, Phys. Rev. E 73, 066107 (2006).

[2] J. Buhl, J. Gautrais, R.V. Sol´e, P. Kuntz, S. Valverde, J.L. Deneubourg, G. Thereulaz,

Eur. Phys. Journ. B 42, 123 (2004).

[3] B. Hillier, J. Hanson, ”The social logic of space”, Cambridge univ. press, Cambridge, UK

(1984).

15

[4] B. Hillier, ”Space is the machine: a conﬁgurational theory of architecture”, Cambridge

Univ. Press, Cambridge, UK (1996).

[5] S. Bilke, C. Peterson, Phys. Rev. E 64, 036106 (2001);

[6] S. Porta, P. Crucitti, V. Latora, Physica A 369, 853 (2006).

[7] M. Rosvall, A. Trusina, P. Minnhagen, K. Sneppen, Phys. Rev. Lett. 94, 028701 (2005).

[8] B. Jiang, C. Claramunt, ”Topological analysis of urban street networks”, Environmental

Planning B 31, 151-162 (2004).

[9] I.J. Farkas, I. Der´enyi, A.-L. Barab´asi, T. Vicsek, Phys. Rev. E 64, 026704 (2001).

[10] I. Farkas, I. Der´enyi, H. Jeong, Z. Neda, Z.N. Oltvai, E. Ravasz, A. Schubert, A.-L.

Barab´asi, T. Vicsek, Physic A 314, 25 (2002).

[11] S.N. Dorogovtsev, A.V. Goltsev, J.F.F. Mendes, A.N. Samukhin, Phys. Rev. E 68, 046109

(2003).

[12] S. Scellato, A. Gardillo, V. Latora, S. Porta, Eur. Phys. Journ. B 50, 221 (2006).

[13] P. Crucitti, , V. Latora, S. Porta, Phys. Rev. E 73, 036125 (2006).

[14] P. Crucitti, , V. Latora, S. Porta, Chaos 16, 015113 (2006).

[15] K. A. Eriksen, I. Simonsen, S. Maslov, K. Sneppen, Phys. Rev. Lett. 90, Issue 14, id.

148701 (2003).

[16] M. Fiedler, Chechoslovak Math. J. 23, 298 (1973); Chechoslovak Math. J. 25, 146 (1975).

Let us note that Fiedler’s theorem had been formulated for the Laplacian D − A and
relates to its 2-nd smallest eigenvalue. In contrast, we use the scaled Lapalcian (2) and

therefore consider its second largest eigenvalue.

[17] E.B. Davis, G. M.L. Gladwell, J. Leydold, P.F. Stadler, Lin. Alg. Appl. 336, 51-60 (2001).

[18] T. Biyiko˘glu, W. Hordijk, J. Leydold, T. Pisanski, P.F. Stadler, Lin. Alg. Appl. 390, pp.

[19] W. Feller, An Introduction to probability Theory and Applications, Vol. 2, NY-London-

SYdney: John Wiley&Sons, Inc. XVIII (1966).

[20] S. Wasserman, K. Faust, Social Network Analysis, Cambridge Univ. Press, Cambridge,

155-174 (2004).

England (1994).

16

[21] The 3d-drqwing of networks with respect to thier eigenvectors is used in the standard

rutines of Maple and matlab environments.

[22] E. Estrada, J.A. Rodr´iguez-Vel´azquez, Phys. Rev. E 71, 056103 (2005).

[23] E. A. Leicht, P. Holme, M. E. J. Newman, Phys. Rev. E 73, 026120 (2006).

[24] L. Li, D. Alderson, W. Willinger, J. Doyle, A ﬁrst principles approach to understanding

the Internet router-level topology, In ACM SIGCOMM (2004).

[25] M. E. J. Newman, Phys. Rev. Lett. 89, 208702 (2002).

[26] M. E. J. Newman, Phys. Rev. E 68, 026121 (2003).

[27] J. Nieminen, Scand. J. Psychol. 15, 322 (1974).

[28] L.C. Freeman, Soc. Networks 1, 215 (1979).

[29] H. Tangmunarunkit, J. Doyle, R. Govindan, S. Jamin, W. Willinger, S. Shenker, Does

AS size determine AS degree?, In ACM Computer Comm. Review, Oct. (2001).

[30] M. Girvan, M. E. J. Newman, PNAS 99 (12), 7821 (2002).

[31] L.G. Sabiduss, Psychometrica 31, 581 (1966).

[32] I. Vragovic, E. Louis, A. Diaz-Guilera, Phys. Rev. E 71, 036122 (2005).

[33] V. Latora, M. Marchiori, Phys. Rev. Lett. 87, 198701 (2001).

[34] V. Latora, M. Marchiori, Phys. Rev. E 71, 015103 (R) (2005).

[35] P. Mahadevan, D. Krioukov, K. Fall, A. Vahdat, A Basis for Systematic Analysis of

Network Topologies, In ACM SIGCOMM 2006.

[36] D. Cvetkovic, P. Rowlinson, S. Simic, Eigenspaces of Graphs, Cambridge Univ. Press,

Cambridge, UK (1997).

[37] E. Estrada, J.A. Rodr´iguez-Vel´azquez, Phys. Rev. E 72, 046105 (2005).

[38] M. Tierz, E.Elizalde, Heat Kernel-Zeta Function Relationship Coming From The Classical

Moment Problem, arXiv:math-ph/0112050 (2001).

[39] We thank R. Lima for this comment.

17

Table 1: Some features of studied city samples

λ1 (Laplacian) λ|V | (Laplacian) diam(G)

Rothenburg ob.d.T.

Bielefeld downtown

Amsterdam channels

Venice channels

|V |

50

50

57

96

|E|

115

142

200

196

Manhattan

355

3543

1.372

1.414

1.4505

1.394

1.467

0.5

0.5

0.5

0.5

0.5

13

14

11

14

17

Table caption: Some features of compact city samples: |V | is the number of streets, |E| the
number of junctions (crossroads), λ1 is the spectral radius of Laplacian operator (the largest
eigenvalue), λ|V | is the smallest eigenvalue, diam(G) is the maximum distance between any two
vertices of the graph.

Table 2: Thermodynamical properties of ensembles of random walkers in the

compact cities at β = 1

¯E(β = 1) S(β = 1) F (β = 1)

Rothenburg ob.d.T.

0.946604

3.885109

2.93850

Bielefeld downtown

0.957324

3.89042

2.93309

Venice channels

0.95082

4.53962

3.58880

Manhattan

”Village”

0.990083

5.86713

4.87705

0.994226

4.49687

3.5026

Cmax

1.60468

2.04195

1.92003

5.87368

5.2971

βCmax

11.1

9.90

27.4

13.65

12.00

Amsterdam channels

0.898409

3.88836

2.98996

1.3353; 1.1094

8.6; 48.75

Table caption: ¯E is the internal energy, S is the entropy, F is the free energy, Cmax is the

maximal values of heat capacity, and βCmax is the points they are achieved.

18

a.

c.

e.

b.

d.

f.

Figure 1: The fractions of streets n(s) having s crossroads are shown (by points) together with their cumulative

distributions (solid lines). The cumulative degree statistics for the medieval cities seems to approach exponential
19
one, the plot a) Bielefeld downtown and b) Rothenburg are given in the log-linear scale. Other plots are presented

in the log-log scale: c) Venice channels, d) Amsterdam channels, e) Manhattan streets, and f) for the degree

a.

b.

8

7

32

10

6

9

26

11

27

2

3

5

20

33

36

49

16
34

28

44
25

50

45

23

4
30

29

38

22

12

18

15

14

17

1

21

13

19

48

37

47

46
24

41

35

42

39

43

40

20

Figure 2: The structural modularity and symmetries of an undirected connected dual city graphs can be visually

revealed by the 3d-drawing with respect to the eigenvectors. Bielefeld downtown (a) and Rothenburg ob.d.T.

(b)) are presented together with their 3d representations of their dual graphs. The downtown of Bielefeld

comprises of the A-part which keeps its original structure (founded in XIII-XIV cs.) and the bart B which

had been redeveloped in the XIX-th century. The 3d dual graph of Bielefeld displays clearly their structural

diﬀerence.

a.

c.

e.

b.

d.

f.

Figure 3: The eigenvalues and their densities for the dual graphs of compact urban patterns: Bielefeld (a),

Rothenburg (b), Venice channels (c), Amsterdam channels (d), Manhattan (e), the degenerate spectrum of the
21

”village” extended along one prime road with a number (200) of blind passes branching oﬀ it.

a.

b.

Figure 4: a. Plan of the Chelsea village in Manhattan and the matrix plot of its nodal domains (b). All

eigenvectors localized on the nodal domains displayed in white (black) have always the positive (negative) sign.

Figure 5: The matrix plot of coeﬃcients of the linear correlations Cij for 96 Venice channels. The diagonal
elements Cii = 1 and have been omitted.

22

Figure 6: Complexity of dynamical modularity can be measured by the information like quantity. I.
appearance with the correlation level κ plays the role of a unique ﬁnger print of Genius loci.

It it

Figure 7: Due to a complicated topology of city streets and channels, the ﬂows of random walkers acquire a

certain internal energy which grows with temperature.

a.

a.

a.

a.

b.

b.

b.

b.

c.

c.

c.

c.

Figure 8: The heat capacity proﬁles via the inverse temperature β.

Figure 9: Entropy quantiﬁes the diversity of ﬂows detected in a city and grows with temperature.

23

a.

b.

Figure 10: Pressure spectral proﬁles and the city ”transparency corridors”.

24

