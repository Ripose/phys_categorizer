5
0
0
2
 
g
u
A
 
2
2
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
0
6
1
8
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

SIR dynamics in structured populations with
heterogeneous connectivity

Erik Volz
(Cornell University, email: emv7@cornell.edu)

October 7, 2011

Abstract

Most epidemic models assume equal mixing among members of
a population. An alternative approach is to model a population as
random network in which individuals may have heterogeneous con-
nectivity. This paper builds on previous research by describing the
exact dynamical behavior of epidemics as they occur in random net-
works. A system of nonlinear diﬀerential equations is presented which
describes the behavior of epidemics spreading through random net-
works with arbitrary degree distributions. The degree distribution is
observed to have signiﬁcant impact on both the ﬁnal size and time
scale of epidemics.

1 Introduction

Population structure constitutes an important aspect of heterogeneity
within a population of susceptible and infectious individuals. It has
also been one of the hardest factors to incorporate into epidemiolog-
ical models. Compartment models have been able to capture many
aspects of population heterogeneity, such as with respect to heteroge-
neous susceptibility and infectiousness [1, 2, 3]. But such models can
be inadequate with respect to population structure, especially when
contact rates follow a steep and continuous gradient.

Network theory contends that a population of susceptible and in-
fectious individuals can be modeled as nodes in a network [4, 5, 6, 7].

1

This has spawned a new category of epidemiological model where epi-
demics spread by traversing network connections [8, 9, 10, 11, 12, 13].
Pure random networks with speciﬁed degree distributions have been
proposed as realistic models of population structure. This case has
the advantage of being well understood mathematically. The limit-
ing behavior of epidemics spreading through random networks with a
given degree distributions has been solved exactly [9, 10].

The network approach has the advantage that the mathematics of
stochastic branching processes [16, 17, 18] can be brought to bear on
the problem. This allows for precise descriptions of the distribution
of outbreak sizes early in the course of the epidemic [9, 10].

A shortcoming of the network model has been that the mathe-
matics of stochastic branching processes are inadequate to describe
the explicit dynamical behavior of an epidemic. Thus the distribution
of outbreak sizes are easy to solve for, yet the incidence curve, that
is the number of infecteds at a time t, has been diﬃcult to derive.
Simulation can be used in this case [19].

Heterogeneous networks make it diﬃcult to create diﬀerential equa-
tions to describe the course of an epidemic. Nevertheless, Barthelemy
et al. [20, 21, 22] have been successful modeling many of the dynami-
cal aspects of network epidemics, particularly in the early stage where
asymptotically correct formuli for disease incidence are now known.
We improve upon these results by presenting a system of nonlinear
diﬀerential equations which can be used to solve for the complete in-
cidence curve, as well as other quantities of interest. We treat the
simplest possible case of the SIR dynamics with constant rate of in-
fection and recovery. Section 2 describes the model. Several examples
are given in section 3.

2 The model

We investigate undirected random networks with speciﬁed degree dis-
tributions1[5]. Let pk be the probability of a node having a degree
k. As in previous research we will make great use of the probability
generating function (PGF) corresponding to the degree distribution.
Although widely employed in the probability theory and the study
1The degree of a node in a network is the number of connections to that node. The
degree distribution is a discrete probability density over the positive integers describing
the probability of realizing a given degree.

2

˙β = α µ pW
˙α = −α(r + µ)pW
˙T = −(r + µ)pW T − pW r n α2g′′(α + β)
˙W = pW (r n α2g′′(α + β) − (r + µ)(2W + T ))

Table 1: A summary of the nonlinear diﬀerential equations used to the de-
scribe the spread of a simple SIR type epidemic through a random network.
The degree distribution of the network is generated by g(x).

of stochastic branching processes, generating functions are less familiar
to those working in mathematical epidemiology (but see[14, 15]). The
utility of PGF’s for the current investigation cannot be understated.
Consider the degree distribution among susceptibles at a given time t.
As an epidemic progresses, more highly connected nodes, often called
“hubs”, will be preferentially culled from the population of suscepti-
bles. Thus the degree distribution among susceptibles will evolve as
the epidemic progresses. Our approach will be to keep track of the
evolution of this distribution by careful application of parameters to
the PGF. This will ultimately allow us to ﬁnd the number of infecteds
at any given time.

Given a degree distribution, we deﬁne the probability generating

function g(x) as

g(x) = p0 + p1x + p2x2 + p3x3 + · · ·

(1)

In most cases this series will converge to an algebraic function, in
which case any operation to be done on the PGF can be done on the
simple algebraic form. The series form can be retrieved by Taylor
expansion. The degree distribution is a parameter of the model, so
g must be well-deﬁned. Several examples for common distributions
are given in section 3. The results given below hold for any degree
distribution.

It will be helpful to the reader if several examples are provided to
illustrate the utility of PGF’s. Generating functions allow us to ma-
nipulate probability densities using simple algebraic operations. For
example, if we were to draw two realizations of a random variable X
with generating function g(x), the density of the sum would have gen-
k(p1pk−1 + p2pk−2 + · · · )xk = g2(x). The mean of
erating function

P

3

the random variable can be be gotten by diﬀerentiating the generating
function, < X >=

k kpk = g′(1).

P

Another example more apropos to this paper is the following: Sup-
pose we select a fraction α of the stubs2 from a network whose degree
distribution has generating function g(x). Then what proportion of
nodes will not be attached to any of the stubs we selected?

Meanwhile the degree distribution of those not attached to a selected
connection is generated by

pk(1 − α)k = g(1 − α)

Xk

g((1 − α)x)
g(1 − α)

We can do better by computing the explicit generating function for
the joint degree distribution of selected and unselected stubs. This is
accomplished by applying a second variable to the generating function.
Let x correspond to selected stubs and y correspond to unselected
stubs. The probability of a degree k node having m of its stubs selected
αm(1 − α)k−m. Then the generating function will be of the form
is
(cid:1)

k
m
(cid:0)

g(x, y; α) =

αm(1 − α)k−mxmyk−m/c

k

k
m(cid:19)

pk(cid:18)

Xk

Xm=0

=

pk(αx + (1 − α)y)k/c = g(αx + (1 − α)y)/c

Xk

where c = g(α + β) is a normalizing constant. This example is impor-
tant, as it underlies the methodology employed in this paper. The sit-
uation would be identical if infection had spontaneously spread among
a fraction α of the stubs and we asked how many nodes remained un-
infected.

We will use an indirect approach in that we will not track the
evolution of susceptibles and infecteds directly, but rather the num-
ber of stubs which are attached to susceptibles and infecteds. When
an infected node transmits infection along one of its connections, we
say the corresponding connection is occupied. The variable T will be
the number of non-refractory stubs emanating from susceptible nodes.
The variable W will be the number of stubs emanating from infected

2In network vernacular a stub is one end of a connection between two nodes.

4

nodes which have not yet become occupied or refractory. The quanti-
ties of interest in the model are as follows:

• r := Force of infection. The probability per unit time of infection

traversing a network connection.

• µ := Recovery rate. The probability per unit time that a con-

nection to an infected will become refractory.

• n := The population size.

• z := The average degree in the network.

• T := The number of all network connections to susceptible nodes.

• W := The number of all network connections to infected nodes
which have neither become occupied nor become refractory.

• α := The proportion of stubs not connected to an occupied or
refractory stub, i.e. the survivor function of susceptible stubs.

• β := The proportion of stubs among susceptible nodes which are

connected to refractory stubs.

• S := The number of susceptibles.

• I := The number of infecteds, including those who have recov-

ered.

We will treat the simple case of a constant force of infection and
constant recovery rate.

During the course of an epidemic, a node may be connected to a re-
fractory stub, an occupied stub, or an unoccupied stub. The diﬀerent
types of connections can be factored into the generating function by
using multiple variables. Let the variable x correspond to the number
of unoccupied stubs, and y correspond to the number of refractory
stubs. Note that at any given time, a susceptible will not have any
occupied stubs by deﬁnition. Since we are only interested in the de-
gree distribution of susceptibles, we will not introduce a variable for
the number of occupied stubs.

For susceptibles, stubs will be distributed among refractory con-
nections and unoccupied/non-refractory connections. As deﬁned above,
α is the probability of having the latter type of connection, while β is
the probability of the former. The generating function for the degree
distribution among susceptibles will be

pk(αx + βy)k/c = g(αx + βy)/g(α + β)

(2)

Xk

5

The quantity T is easy to derive by similar logic. The probability of
a node having degree k and contributing m stubs to T is

k
m(cid:19)

pk(cid:18)

αm(β)k−m

So in terms of the PGF, the number of non-refractory stubs emanating
from susceptibles will be

T = n

[g(αx + βy)]x=1,y=1 = n α g

(α + β)

(3)

′

d
dx

α and β will change over the course of the epidemic, thereby con-
trolling the evolution of the degree distribution (2).
It remains to
determine the dynamics of these parameters. At any given time,
the hazard rate for an unoccupied stub being connected to an in-
fected stub is rpW , where pW = W/(W + T ) is the proportion of
non-refractory/unoccupied stubs connected to infecteds. Likewise, the
hazard rate for becoming connected to a refractory stub is µpW . Re-
call α is the survivor function for stubs not connected to occupied or
refractory stubs; thus its dynamics is governed by

˙α = −α(r + µ)pW

(4)

(5)

The evolution of β is more complicated. The probability of a stub
connected to a susceptible node surviving to a time t is of course α.
At time t, the hazard of connecting to a refractory stub is µpW . Then
we have the following:

˙β = α µ pW

The dynamics of W is dependent both on the outﬂow of stubs
becoming occupied and refractory, plus the inﬂow of stubs from newly
infected nodes. Note that the total degree mass of the network, M =
nz is conserved. If we denote by X the stubs which are either occupied
or refractory, we have the identity W = M − T − X . Diﬀerentiating
gives ˙W .

˙W = − ˙T − ˙X
(6)
˙X is quite simple. When a network connection becomes occupied
or refractory, the two stubs making up the connection change state.
Then ˙X increases at twice the rate at which stubs from W become
refractory or occupied.

˙X = 2(r + µ)W

6

Diﬀerentiating equation (3) and using equation (3) gives

˙T = −(r + µ)pW T − pW r n α2 g

′′

(α + β)

Finally, using equation (6) and using equations (2) and (7) we have

˙W = (r + µ)(pW T − 2W ) + pW r n α2g

(α + β)
(α + β) − (r + mu)(2W + T ))

′′

= pW (r n α2g

′′

This completes the model.

Once the model has been integrated the number of susceptibles
can be determined by applying the PGF to distribution parameters α
and β. At a given time t, the number of susceptibles S is

k

k
m(cid:19)

pk(cid:18)

αmβk−m

Xm=0

Xk
pk(α + β)k = n g(α + β)

S = n

= n

Xk

The number of infecteds including those who have recovered is I =
n − S.

3 Examples

The model has been tested on several common degree distributions:

• Poisson: pk = zke−z

k!

. This is generated by

g(x) = ez(x−1)

• Power-law. For our experiments, we utilize power-laws with ex-
Liγ (e−1/κ) , k ≥ 1 where Lin(x) is the

ponential cutoﬀs κ: pk = k−γe−k/κ
nth polylogarithm of x. This is generated by

g(x) = Liγ(xe

−1/κ)/Liγ (e

−1/κ)

• Exponential: pk = (1 − e−1/λ)e−λk. This is generated by

(7)

(8)

(9)

(10)

(11)

(12)

(13)

(14)

g(x) =

1 − e−1/λ
1 − xe−1/λ

7

If a single node is chosen at random from the population and in-
fected, we can anticipate the following initial conditions: The survivor
function for uninfected stubs, α, will begin at 1 and evolve downwards.
β will begin at 0 and evolve upwards. T will be equivalent to the de-
gree mass of the network minus the degree of the initial infected. And
W will be the degree of the initial infected. We take the degree of the
initial infected to be the average degree within the network. These
are the initial conditions used in the trials shown in ﬁgure 1 and 2.

Figure 1 shows the disease incidence for each of the degree dis-
tributions (12), (13), and (14), with a force of infection r = .2 and
mortality µ = .1. The parameters of the degree distributions were cho-
sen so that each network has an identical average degree of 3. That
is, the density of connections in each network is identical. Neverthe-
less, there is widely diﬀerent epidemic behavior due to the diﬀerent
distribution.

A sense for the diﬀerent dynamical behaviors of each of the three
networks can be gotten from ﬁgure 1. Consistent with previous re-
search, the degree distribution has a great impact on the ﬁnal size
of the epidemic [9, 10]. More importantly, the three networks exhibit
widely varying dynamical behavior. In particular, note that the power
law network experiences epidemics which accelerate very rapidly. Such
epidemics enter the expansion phase virtually as soon as the ﬁrst in-
dividual in the network is infected. Both the Poisson and exponential
networks experience a lag before the expansion phase of the epidemic.
These observations are consistent with the ﬁndings in [20] that the
timescale of epidemics shortens with increasing contact heterogene-
ity. Pure power laws have an inﬁnite second moment, that is inﬁnite
heterogeneity, and therefore have a maximally short time-scale. This
has important implications for intervention strategies, as it is often
the case that interventions are planned and implemented only after a
pathogen has circulated in the population for some time. If an epi-
demic were to occur in the power-law network, there would be little
time to react before the the infection had reached a large proportion
of the population.

Several other variables of interest are computed as a byproduct of
the model. Figure 2 shows the most important for the power law trial
described above. α shows the proportion of stubs not connected to an
occupied or refractory alter. β shows the proportion of stubs among
susceptibles connected to a refractory alter. These variables do not
quite move in tandem and may cross each other. Also shown is W

8

8000

)
I
(
 
d
e
t
c
e
f
n
I
 
r
e
b
m
u
N

6000

4000

2000

0

0

Power law
Poisson
Exponential

Time (t)

50

Figure 1: The number of infecteds (including recovered) is shown versus
time for an SIR model on three networks. Force of infection and mortality
are constant: r = 0.2, µ = 0.1. The networks have Poisson (z = 3), power
law (γ = 1.615, κ = 20), and exponential (λ = 3.475) degree distributions.
Each of these degree distributions has an average degree of 3.

(rescaled by population size n) which is similar to the hazard rate of
becoming infected (rW/(W + T )). The epidemic ceases only when W
reaches negligible levels.

Something oﬀered by this model and not to the author’s knowl-
edge seen previously, is an explicit calculation for how the degree dis-
tribution of susceptibles evolves over the course of the epidemic. The
infection will clearly tend to strike more highly connected individuals
before more isolated individuals. Thus we expect the degree distri-
bution to become bottom-heavy, as high degree nodes are gradually
weeded out of the population. This is indeed observed in ﬁgure 3 for
the Poisson trial described above.

Recall that the degree distribution of susceptibles is generated by
equation (2) and that we retrieve the explicit degree distribution by
diﬀerentiation:

Applying this to the Poisson PGF (equation (12)) gives

(15)

(16)

pk = [(

dk
dxk g(x)]x=0/k!

pk =

(zα)ke−zα
k!

9

1

0.8

0.6

0.4

0.2

0

0

α
β
W/n

Time(t)

25

Figure 2: α, β, and W/n are shown versus t for a power law network with
exponent κ = 1.615 and exponential cutoﬀ κ = 20. Force of infection and
mortality are constant: r = 0.2, µ = 0.1.

We recognize this as simply the Poisson distribution with an adjusted
parameter z × α.

Previous work [10] has shown that there is a critical transmissibility
above which an epidemic will reach a fraction of the population in the
limit as n goes to inﬁnity. Below that threshold, the epidemic is
limited to a ﬁnite-sized outbreak. Figure 4 shows the qualitatively
diﬀerent dynamical behavior of outbreaks below the phase transition
for networks with a Poisson distribution. Note that these outbreak
sizes are independent of the population size, n, in contrast to the
incidence curves above the phase transition which are sensitive to n
both in the time-scale of the epidemic and the number ultimately
infected.

Deﬁne the transmissibility, τ , of the disease as the probability that
the infection will traverse a network connection. With constant force
of infection and mortality

What is the critical transmissibility that deﬁnes the phase transition?
Recall that the epidemic is complete when W is negligible and decreas-
ing. If W is decreasing at t = 0 then the epidemic will necessarily die
out without reaching a fraction of the population. The critical point

τ =

r
r + µ

10

)

k

0.4

p
(
 
y
c
n
e
u
q
e
r
F

0.5

0.3

0.2

0.1

0

0

t=0
t=35
t=50

5

Degree 

Figure 3: The degree distribution (equation (16)) for susceptibles is shown
at three diﬀerent times during the course of an epidemic on a Poisson network
(z = 3). Force of infection and mortality are constant: r = 0.2, µ = 0.1.

occurs where

˙Wt=0 = 0 = − ˙T − ˙X

Applying equations (7) and (2)

0 =

αW
W + T

[(r + µ)g

(α + β) + α r g

′

r + µ

r (cid:16)

αn
W + T

′

g

(α + β) − 2

=

′′

(α + β)] − 2(r + µ)
−α2 n g′′(α + β)
W + T
2W + T
n α2g′′(α + β)

(cid:17)
= τ =

r
r + µ

At t = 0, α = 1, β = 0, W ≈ 0 and T ≈ n g′(1). Then

∗

τ

′

′′

= g

(1)/g

(1)

(17)

This is in agreement with previous results based on bond-percolation
theory [10].

4 Discussion

The statistical properties of SIR epidemics in random networks have
been understood for some time, but the explicit dynamics have been

11

r = .17, µ = .4
r = .15, µ  = .4
r = .18, µ = .4

)
I
(
 
e
z
i
s
 

k
a
e
r
b
t
u
O

15

10

5

0

20

80

100

40

60
Time (t)

Figure 4: The number of infecteds (including recovered) is shown versus
time for an SIR model on a Poisson network (z = 3). Each of these trials are
below the critical level of transmissibility required to sustain an epidemic.
Mortality is constant, µ = 0.4, while three diﬀerent levels of the force of
infection are tried, r = 0.15, 0.17, 0.18.

understood mainly through simulation. This paper has addressed this
shortcoming by proposing a system of diﬀerential equations to model
SIR in random networks.

It should be noted that the SI dynamics are a special case of this
model (µ = 0), in which case the ultimate extent of the epidemic is
simply the giant component [23]3 of the network.

The distribution of contacts, even holding the density of contacts
constant, has enormous impact on epidemic behavior. This goes be-
yond merely the extent of the epidemic, but as shown here, the dy-
namical behavior of the epidemic. In particular, the distribution of
contacts plays a key role in determining the onset of the expansion
phase of an epidemic.

The distribution dynamics from equation (2) and shown in ﬁg-
ure 3 have important implications for vaccination strategies. Previous
work [24, 25] has focused on determining the critical levels of vacci-
nation required to halt or prevent an epidemic. It is usually taken for
granted that contact patterns among susceptibles are constant. Fur-

3The giant component of a network, if it exists, is the largest set of nodes such there
exists a path between any two of them; furthermore the giant component must occupy a
fraction of the network in the limit as network size goes to inﬁnity.

12

thermore, most widespread vaccinations occur only once an epidemic
is underway. Future research could be enhanced by considering op-
timal vaccination levels when the epidemic proceeds unhindered for
variable amounts of time.

It is hoped that the distribution dynamics described in this pa-
per will ﬁnd applications beyond modeling heterogeneous connectivity.
The dynamic PGF approach may be used to capture other forms of
heterogeneity, such as of susceptibility, mortality, and infectiousness.

References

[1] V.M. Veliov, “On the eﬀect of population heterogeneity on dy-
namics of epidemic diseases”, J. Math. Biol., 51, 123-143, 2005

[2] R. M. Anderson and R. M. May, Infectious Diseases of Humans.

Oxford University Press, Oxford (1991).

[3] Diekmann, O., Heesterbeek, J.A.P.: Mathematical epidemiology
of infectious diseases. Model building, analysis and interpretation.
Wiley Series in Mathematical and Computational Biology. John
Wiley & Sons, Ltd., Chichester, 2000

[4] Liljeros, F., Edling, C. R., Amaral, L. A. N., Stanley, H. E. &
Aberg, Y. (2001). The web of humansexual contacts. Nature, 411,
907908.

[5] S. H. Strogatz, Exploring complex networks. Nature 410, 268276

(2001).

[6] M. E. J. Newman, D. J. Watts, and S. H. Strogatz, Random
graph models of social networks. Proc. Natl. Acad. Sci. USA 99,
25662572 (2002).

[7] S. Gupta, R. M. Anderson, and R. M. May, Networks of sexual
contacts: Implications for the patternof spread of HIV. AIDS 3,
807817 (1989).

[8] R. Pastor-Satorras, A. Vespignani, “Epidemics and immunization
in scale-free networks”, Contribution to Handbook of Graphs and
Networks: From the Genome to the Internet eds. S. Bornholdt
and H.G. Schuster ,Wiley-VCH, Berlin, 2002

[9] Meyers, L. A., Pourbohloul, B., Newman, M. E. J., Skowron-
ski, D. M., Brun-ham, R. C., 2005. Network theory and SARS:
Predicting outbreak diversity. J. Theor. Biol. 232, 71-81.

13

[10] M. E. J. Newman, The spread of epidemic disease on networks,

Phys. Rev. E 66, 016128 (2002).

[11] C. P. Warren, L. M. Sander, I. Sokolov, C. Simon, and J. Koop-
man, Percolation on disordered networks as a model for epi-
demics. Math. Biosci. (in press).

[12] Dezso, Z. & Barabasi, A.-L. (2002). Halting viruses in scale-free

networks. Phys. Rev. E, 65, 055103(R).

[13] J. Saramki and K. Kaski, Modelling development of epidemics
with dynamic small-world networks, Journal of Theoretical Biol-
ogy, Volume 234, Issue 3, 7 June 2005, Pages 413-421.

[14] Altmann M., Susceptible-infected-removed epidemic models with

dynamic partnerships. J Math Biol. 1995;33(6):661-75.

[15] H. Andersson, Limit theorems for a random graph epidemic

model, Ann. Appl. Probab. 8, no. 4 (1998), 1331?1349

[16] H. S. Wilf, Generatingfunctionology, 2d ed., Academic Press,

[17] Harris, T. E. (1963). The Theory of Branching Processes.

[18] Athreya, K. B. and Ney, P. (1972). Branching Processes. Springer,

Boston, 1994.

Springer, Berlin.

New York.

[19] S. Eubank, H. Guclu, V.S.Anil Kunar, M.V. Marathe, A. Srini-
vasan, Z. Toroczkai, N. Wang, “Modelling disease outbreaks in
realistic social networks”, Nature, 429, 13, 180-184

[20] M. Barthelemy, A. Barrat, R. Pastor-Satorras, A. Vespignani,
“Dynamical patterns of epidemic outbreaks in complex hetero-
geneous networks”, Journal of Theoretical Biology, 235 (2005)
275-288

[21] Pastor-Satorras, R. & Vespignani, A. (2001b). Epidemic spread-
ing in scale-free networks. Phys. Rev. Lett. 86, 3200 3203.

[22] Pastor-Satorras, R. & Vespignani, A. (2001c). Epidemic dynam-
ics and endemic states in complex networks. Phys. Rev. E, 63,
066117.

[23] M. Molloy and B. Reed, The size of the giant comp onent of
a random graph with a given degree sequence. Combinatorics,
Probability and Computing 7, 295305 (1998).

14

[24] E.H. Kaplan, D.L. Craft, L.M. Wein, “Emergency response to a
smallpox attack: The case for mass vaccination”, PNAS, 99, 16,
10935-10940

[25] M.E. Halloran, I. Longini, A. Nizam, Y. Yang, “Containing

bioterrorist smallpox”, Science, 298, 1428, 2005

15

