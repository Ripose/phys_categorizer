Deterministic approach to microscopic three-phase
traﬃc theory

Boris S. Kerner 1 and Sergey L. Klenov 2
1 DaimlerChrysler AG, REI/VF, HPC: G021, 71059 Sindelﬁngen, Germany
2 Moscow Institute of Physics and Technology, Department of Physics, 141700
Dolgoprudny, Moscow Region, Russia

PACS numbers: 89.40.+k, 47.54.+r, 64.60.Cn, 64.60.Lx

Abstract. A deterministic approach to three-phase traﬃc theory is presented.
Two diﬀerent deterministic microscopic traﬃc ﬂow models are introduced.
In
an acceleration time delay model (ATD-model), diﬀerent time delays in driver
acceleration associated with driver behavior in various local driving situations
are explicitly incorporated into the model. Vehicle acceleration depends on local
traﬃc situation, i.e., whether a driver is within the free ﬂow, or synchronized ﬂow,
or else wide moving jam traﬃc phase. In a speed adaptation model (SA-model),
driver time delays are simulated as a model eﬀect: Rather than driver acceleration,
vehicle speed adaptation occurs with diﬀerent time delays depending on one of
the three traﬃc phases in which the vehicle is in. It is found that the ATD- and
SA-models show spatiotemporal congested traﬃc patterns that are adequate with
It is shown that in accordance with empirical results in the
empirical results.
ATD- and SA-models the onset of congestion in free ﬂow at a freeway bottleneck
is associated with a ﬁrst-order phase transition from free ﬂow to synchronized
ﬂow. As in empirical observations, in the ATD- and SA-models moving jams
emerge spontaneously in synchronized ﬂow only. Diﬀerences between the ATD-
and SA-models are studied. A comparison of the ATD- and SA-models with
stochastic models in the context of three phase traﬃc theory is made. A critical
discussion of earlier traﬃc ﬂow theories and models based on the fundamental
diagram approach is presented.

5
0
0
2
 
l
u
J
 
5
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
0
2
1
7
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Deterministic approach to microscopic three-phase traﬃc theory

2

1. Introduction

Theoretical studies of freeway traﬃc ﬂow dynamics is one of the rapid developing
ﬁelds of statistical and nonlinear physics. For a mathematical description of freeway
traﬃc ﬂow diﬀerent deterministic and stochastic traﬃc ﬂow models have been
introduced (see the reviews [1, 2, 3, 4, 5, 6], the book [7], and the conference
proceedings [8, 9, 10, 11, 12, 13, 14, 15]). In deterministic models, some dynamic rules
of vehicle motion in traﬃc ﬂow are responsible for spatiotemporal features of traﬃc
patterns that the models exhibit. Contrastingly, stochastic models, in addition to
dynamic rules of vehicle motion, exhibit model ﬂuctuations, which play a fundamental
role for traﬃc pattern features.

There are at least two classes of deterministic traﬃc ﬂow models [1, 3, 4, 5, 6].
In the ﬁrst class, driver time delays in vehicle acceleration (deceleration) a associated
with a change in local driving situation are explicitly taken into account. An example
is the classic model of Herman, Montroll, Potts, and Rothery [16]: If the vehicle speed
v, or the speed diﬀerence between the vehicle speed and the speed of the preceding
vehicle vℓ, or else the net distance g (space gap) between vehicles changes, then the
driver accelerates (decelerates) with a time delay τ [16]:

a(t + τ ) = f (v(t), vℓ(t), g(t)).

(1) and choosing of the integrating constant associated
After integration of Eq.
with steady state model solutions that lie on a one-dimensional curve in the ﬂow–
density plane (the fundamental diagram), a solvable traﬃc ﬂow model is gained as
that of Gazis, Herman, and Rothery [17]; this model is similar to the classic model of
Newell [20] (see the review by Nagel et al. [6] for more detail). Recall that steady state
solutions are hypothetical model solutions in which all vehicles move at the same time-
independent speed and the same space gap between vehicles. One of the mathematical
descriptions of this model class ﬁrst proposed by Nagatani and Nakanishi [18] and
further developed by Lubashevky et al. [19] reads as follows

da
dt

=

f (v(t), vℓ(t), g(t)) − a(t)
τ

.

In both models [17, 18, 19], steady state model solutions in the ﬂow–density plane lie
on the fundamental diagram.

There is also another class of deterministic microscopic models in which the vehicle

speed satisﬁes the equation [1, 3, 4, 5, 6]:

(1)

(2)

(3)

dv
dt

= φ(v, vℓ, g).

Examples are optimal velocity (OV) models of Newell [20], Whitham [21], Bando,
Sugiyama et al.
[22], and the intelligent driver model (IDM) of Treiber and
Helbing [23, 24]. Steady state solutions of this model class that obviously satisfy
the conditions φ(v, vℓ, g) = 0 and v = vℓ lie on the fundamental diagram in the
ﬂow–density plane.

If functions and model parameters in the models (2) and (3) are chosen in an
appropriated way, then there is a range of vehicle density in which steady state
model solutions are unstable against inﬁnitesimal inhomogeneous perturbations in free
ﬂow [2, 3, 4, 5, 6]. Whereas in the models of the ﬁrst class this instability is the result of
driver delay time τ (2), in the second class models (3) the instability is a model eﬀect.
This eﬀect is simulated by a density dependent dynamic behavior of inhomogeneous
model solutions in the vicinity of model steady states on the fundamental diagram.

Deterministic approach to microscopic three-phase traﬃc theory

3

The growth of local perturbations caused by this instability leads to spontaneous
moving jam emergence in free ﬂow. The models whose steady states lie on the
fundamental diagram and in which moving jams emerge spontaneously in free
ﬂow, speciﬁcally, the onset of congestion in free ﬂow is caused by moving jam
emergence [3, 4, 5, 6] are associated with the fundamental diagram approach to traﬃc
ﬂow theories [7]. Consequently, in these models at an on-ramp bottleneck moving
jam(s) occurs spontaneously in free ﬂow when the ﬂow rate upstream of the bottleneck
qin is high enough and the ﬂow rate to the on-ramp qon increases gradually beginning
from zero [4, 5, 25, 26, 27, 24].

However, this fundamental model result (i.e., that at a high enough ﬂow rate on
the main road the phase transition governing the onset of congestion in free ﬂow is
associated with spontaneous moving jam emergence [3, 4, 5, 6]) is in a serious conﬂict
with empirical evidence [28, 29, 7].

Indeed, numerous empirical investigations of phase transitions in freeway traﬃc
indicate that moving jams do not emerge spontaneously in free ﬂow. Rather than
moving jam emergence, a ﬁrst-order phase transition from free ﬂow to synchronized
ﬂow (F→S transition for short) governs the onset of congestion in free ﬂow [28, 29].
Due to the F→S transition, the speed decreases abruptly. This speed breakdown
caused by the F→S transition that is also called traﬃc breakdown exhibits a
probabistic nature [30, 31, 32]: At the same traﬃc demand (the same ﬂow rates
qin and qon), in some realizations (days) traﬃc breakdown, i.e., an F→S transition
is observed, but in other realizations it is not observed. The probabilistic nature of
traﬃc breakdown is explained by the metastability and nucleation eﬀects, which are
characteristic features of the ﬁrst-order F→S transition [7].

There are the macroscopic spatiotemporal objective (empirical) criteria for the
two diﬀerent phases in congested traﬃc, synchronized ﬂow and wide moving jam [7]:
A wide moving jam propagates through any ﬂow states and bottlenecks while
In contrast, the
maintaining the mean velocity of the downstream jam front.
downstream front of synchronized ﬂow, in which vehicles accelerate from synchronized
ﬂow upstream to free ﬂow downstream, is usually ﬁxed at a freeway bottleneck.

Wide moving jams can emerge spontaneously only in the synchronized ﬂow phase
(S→J transition for short). Thus, in empirical observations wide moving jams occur
spontaneously due to the sequence of two phase transitions, ﬁrst an F→S transition,
then later and usually at another location an S→J transition (F→S→J transitions for
short) [7].

Consequently, in 1996–1999 Kerner introduced three-phase traﬃc theory (see [7]
for a review). In this theory, there are three traﬃc phases: free ﬂow, synchronized ﬂow,
and wide moving jams. This theory can explain and predict the F→S→J transitions
and empirical spatiotemporal congested pattern features. The fundamental hypothesis
of three-phase traﬃc theory, which is a qualitative theory, is that hypothetical steady
states of synchronized ﬂow cover a two-dimension region in the ﬂow–density plane,
i.e., there is no fundamental diagram in this theory.

The ﬁrst microscopic models in the context of three-phase traﬃc theory
introduced in 2002 are stochastic models [33, 34]. These models exhibit the
F→S→J transitions as well as all types of congested patterns found in empirical
observations [33, 34, 35, 36, 7, 37]. Recently, some new microscopic models based
on three-phase traﬃc theory have been developed [38, 39, 40]. However, there are no
deterministic models in the context of three-phase traﬃc theory, which can exhibit
the F→S→J transitions and the diagram of congested patterns of three-phase traﬃc

Deterministic approach to microscopic three-phase traﬃc theory

4

theory [29, 7]. In stochastic models [33, 34, 35, 36, 7], driver time delays in acceleration
(deceleration) are simulated mainly through the use of model ﬂuctuations. Therefore,
a development of deterministic models based on three-phase theory is important for a
more realistic theory of car following behavior.

In this paper, two deterministic microscopic three-phase traﬃc models are
In an acceleration time delay model (Sect. 2), an explicit description
presented.
In a speed
of driver time delays in vehicle acceleration (deceleration) is used.
adaptation model (Sect. 3), a speed and density dependent dynamic behavior of model
solutions in the vicinity of averaged steady states of synchronized ﬂow associated
with a one-dimension region in the ﬂow–density plane is applied, to simulate phase
transitions and congested patterns.
In Sect. 4, we show that these models exhibit
the F→S→J transitions and congested patterns associated with results of empirical
observations.
In addition, a stochastic speed adaptation model is introduced and
compared with the deterministic speed adaptation model of Sect. 3. In Sect. 5, the
deterministic microscopic three-phase traﬃc models of Sects. 2 and 3 are compared
with earlier deterministic models and a critical discussion of models in the context of
the fundamental diagram approach is performed.

2. Acceleration Time Delay Model

2.1. Main Equations

A deterministic three-phase traﬃc ﬂow model with driver time delays (Acceleration
Time Delay model, ATD-model for short) reads as follows:

dx
dt
dv
dt

da
dt

= v,

= a,

= 


(a(free) − a)/τ
(a(syn) − a)/τ
(a(jam) − a)/τ

at g > G and g > g(jam)
max ,
at g ≤ G and g > g(jam)
max ,
at 0 ≤ g ≤ g(jam)
max ,

(4)

(5)

(6)



where x, v, and a are the space co-ordinate, the speed, and the acceleration of a vehicle,
respectively; g = xℓ − x − d is the space gap (net distance) to the preceding vehicle;
the lower index ℓ marks variables related to the preceding vehicle; all vehicles have the
same length d, which includes the minimum space gap between vehicles within a wide
moving jam; G = G(v, vℓ) is a synchronization gap (see Sect. 2.5); a(free), a(syn), and
a(jam) are vehicle accelerations in the free ﬂow, synchronized ﬂow, and wide moving
jam phases, respectively. If the space gap g satisﬁes the condition g > G(v, vℓ), then
a vehicle moves in accordance with the rules for free ﬂow. Within synchronized ﬂow
associated with the condition g(max)
jam < g ≤ G(v, vℓ), the vehicle tends to adapt the
speed to the preceding vehicle. Within a wide moving jam, the space gap is small,
speciﬁcally g ≤ g(max)
is the maximum space gap
within the wide moving jam phase. In (6), τ is a driver time delay.

jam , and the vehicle decelerates; g(jam)

max

2.2. Driver Acceleration

The accelerations (decelerations) a(free), a(syn), and a(jam) are found from the condition

a(phase) = min(max(˜a(phase), amin), amax, as),

(7)

Deterministic approach to microscopic three-phase traﬃc theory

5

the superscript “phase” in (7) means either “free”, or “syn”, or else “jam” for the
related traﬃc phase; as is an acceleration related to safety requirements; amin and
amax (amin < 0, amax ≥ 0) are respectively the minimum and maximum accelerations
for cases in which there are no safety restrictions. ‡ In (7), functions ˜a(free), ˜a(syn),
and ˜a(jam) associated with driver acceleration within the related traﬃc phase – free
ﬂow, or synchronized ﬂow, or else wide moving jam – are determined as follows:
˜a(free)(g, v, vℓ) = A(free)(g, v)(V (free)(g) − v) +
K (free)(v, vℓ)(vℓ − v),

(9)

˜a(syn)(g, v, vℓ) = A(syn) min(V (syn)
K (syn)(v, vℓ)(vℓ − v),
˜a(jam)(v) = −K (jam)(v)v.

max (g) − v, 0) +

Here V (free)(g) is a gap-dependent optimal speed in free ﬂow; V (syn)
max (g) is a gap-
dependent maximum vehicle speed in steady states of synchronized ﬂow; A(free), A(syn),
K (free), K (syn), and K (jam) are sensitivities. In real traﬃc, these sensitivities can be
asymmetric speed functions depending on whether the vehicle speed is higher or lower
than either the speed of the preceding vehicle or the optimal speed V (free)(g) (see
Sect. 2.5).

The acceleration as for safety vehicle motion is chosen as (Appendix A)

as(g, v, vℓ) = α

g − vTs + (T0 + vℓ/b)(vℓ − v)
T0(Ts + vℓ/b)

,

where Ts is a safety time gap; b, T0 and α are constants. § Formula (12) ensures
collision less vehicle motion at all chosen model parameters.

2.3. Physics of Driver Time Delays

In Eqs. (6), the time delay τ is chosen as

τs
˜τ

at as < min(0, ˜a(phase), a),
otherwise.

τ =

(cid:26)

Here, τs is a short driver time delay associated with a ﬁnite driver reaction time that
must be taken into account in the cases when the driver should decelerate unexpectedly

‡ Since the vehicle speed v cannot be negative, the following condition is also used for Eqs. (5), (6):

a(t) ≥ 0 at v(t) = 0.

To satisfy this condition in numerical simulation, the acceleration a(t) is replaced by the value
max(a(t), 0) if v(t) = 0 at time t.
§ Note that Eqs. (6) of the ATD-model can also be written without the term a(jam) as follows

if rather than (12) the following formula is used for the safety acceleration in (7)

da
dt

=

(cid:26)

as = α

(cid:26)

(a(free) − a)/τ
(a(syn) − a)/τ

at g > G,
at g ≤ G,

g−vTs+(T0+vℓ/b)(vℓ−v)
T0(Ts+vℓ/b)
,

−v(Ts+T0)
T0Ts

,

at g ≥ g(jam)
max ,
at g < g(jam)
max .

In this case, the second term in the right hand side of Eq. (14) plays the role of vehicle acceleration
within the wide moving jam phase.

(10)

(11)

(12)

(15)

(8)

(13)

(14)

Deterministic approach to microscopic three-phase traﬃc theory

to avoid collisions; ˜τ is a time delay in other traﬃc situations, which is chosen diﬀerent
depending on whether the vehicle accelerates or decelerates:

In turn, τ (acc) and τ (dec) in (16) depend on the acceleration a:

τ (acc)
τ (dec)

at a > 0,
at a ≤ 0.

˜τ =

(cid:26)

τ (acc) =

τ (dec) =

τ (acc)
0
τ (acc)
1

τ (dec)
0
τ (dec)
1

(

(

at a < ˜a(phase),
otherwise,

at a ≥ ˜a(phase),
otherwise.

6

(16)

(17)

(18)

1

0

τ (acc)
0

, τ (dec)
0

, and τ (acc)

The driver time delays τ (acc)

, τ (dec)
in (17), (18) are associated
1
with human expectation of local driving conditions, in particular, with spatial and
temporal anticipation of a driver in accordance with local adaptation to those traﬃc
situations in which the driver takes into account the behavior of many vehicles ahead.
is the mean time delay when a driver starts to accelerate or wants to increase
the acceleration. This can often occur at the downstream front of a wide moving jam
or a synchronized ﬂow region, i.e., when the speed in traﬃc ﬂow downstream of the
vehicle is higher than the current vehicle speed. In these cases, after the preceding
vehicle has begun to accelerate, the driver also begins to accelerate, however, after a
time delay to have a desired time gap to the preceding vehicle.

τ (dec)
0

is the mean time delay when the driver starts to decelerate or wants to
decelerate harder in cases in which the driver approaches a region of a lower speed
downstream.
τ (acc)
1

corresponds to situations in which the driver accelerates currently but wants
either to stop the acceleration or to reduce it. Thus, τ (acc)
is the mean driver time
delay in interruption or reduction of driver acceleration in cases in which the driver
recognizes that current acceleration is greater than a desired acceleration in the current
driving situation.
τ (dec)
1

corresponds to situations in which the driver decelerates currently but wants
either to stop the deceleration or to reduce it. Thus, τ (dec)
is the mean time delay in
interruption or reduction of driver deceleration in cases in which the driver recognizes
that current deceleration is more negative than a desired deceleration in the current
driving situation.

1

1

2.4. Model of Road with On-Ramp Bottleneck

“Open” boundary conditions are applied. At the beginning of the road free ﬂow
conditions are generated for each vehicle one after another at equal time intervals
τin = 1/qin where qin is the ﬂow rate in the incoming boundary ﬂow. However, a
new vehicle appears only if the distance from the beginning of the road (x = xb) to
the position x = xℓ of the farthest upstream vehicle in the lane exceeds the distance
vℓTs + d where Ts = 1 s is a safety time gap. The speed v and coordinate x of a new
vehicle are v = vℓ and x = xb, respectively.

In the initial state (t = 0), all vehicles have the same initial speed v = vh =
V (free)(gh), where gh is an initial space gap between vehicles and qin = vh/(gh + d).

Deterministic approach to microscopic three-phase traﬃc theory

7

After a vehicle has reached the end of the road, it is removed; before this, the farthest
downstream vehicle maintains its speed.

An on-ramp bottleneck on the main road is considered. The on-ramp consists
of two parts: (i) The merging region of the length Lm at which vehicle can merge
onto the main road from the on-ramp. (ii) The part of the on-ramp lane of length
Lr upstream of the merging region at which vehicles move according to the model
equations for a homogeneous road with the maximum speed vfree, on = 60 km/h. At
the beginning of the on-ramp lane x = x(b)
on the ﬂow rate to the on-ramp qon is given
as the ﬂow rate on the main road qin.

The following rules are applied for vehicle merging within the merging region:

Firstly, a speed ˆv is calculated corresponding to formula
ˆv = min(v+, v + ∆v(1)

).

r

(19)

−

Then the speed ˆv is used in the merging rules:
g+ > g(jam)

−

> g(jam)

g

Ts.

max + γv

max + γˆvTs,

(20)
Here superscripts g+ and g− are space gaps to the preceding vehicle and the trailing
vehicle on the main road, respectively; v+ and v− are respectively speeds of the
preceding vehicle and the trailing vehicle; γ and ∆v(1)
are constants, where ∆v(1)
describes the maximum possible increase in speed after merging. Note that the ﬁnite
increase ∆v(1)
in the vehicle speed (19) is used to simulate a complex driver behavior
during merging onto the main road, especially in synchronized ﬂow: In some cases,
before merging the driver has to accelerate abruptly, to adjust the speed to the speed
of the preceding vehicle.

r

r

r

If the conditions (20) are satisﬁed, then the vehicle merges onto the main road.
After merging the vehicle speed v is set to ˆv (19) and the vehicle coordinate does not
change. If the conditions (20) are not satisﬁed, the vehicle does not merge onto the
main road. In this case, the vehicle moves in the on-ramp lane until it comes to a stop
at the end of the merging region.

2.5. Model Functions and Parameters

Model functions and parameters are shown in Tables 1 and 2, respectively.

2.6. Steady States

In steady states, all vehicles have the same speed v = vℓ and the same space gap g,
and all accelerations and their time derivatives are zero, and the density ρ and the
ﬂow rate q are related to the space gap g and to the speed v by the obvious conditions

ρ = 1/(xℓ − x) = 1/(g + d),

q = ρv = v/(g + d).

According to (5)–(12), for steady states we get

v = V (g) at g > G(v) and g > g(jam)
max ,
v ≤ V (g) at g ≤ G(v) and g > g(jam)
max ,

v = 0 at

g ≤ g(jam)
max ,

where in all three cases

g ≥ vTs.

(21)

(22)

(23)

(24)

(25)

Deterministic approach to microscopic three-phase traﬃc theory

8

Table 1. ATD-model functions

Synchronization gap

κ(v, vℓ) =

G(v, vℓ) = v max
κ(acc)
(cid:0)
κ(dec)
T (syn)(v) = T (syn)

(cid:26)

0

at v < vℓ,
at v ≥ vℓ,
(1 − 0.85(v/V0)2).
Sensitivities

0, T (syn)(v) + κ(v, vℓ)(vℓ − v)

,

(cid:1)

A(free)(g, v) = A(syn)(g, v) = A0,
K (free)(v, vℓ) = K (syn)(v, vℓ) = K(v, vℓ),

K(v, vℓ) =

K (acc)
K (dec)

at v < vℓ,
at v ≥ vℓ.
(1 − λ(v)) + K (dec)

(cid:26)

K (dec)(v) = K (dec)
2
λ(v) = (1 + exp((v/vc − 1)/δ))−1.

1

λ(v),

Characteristic speed functions

V (free)(g) = V (g) at g > g(free)
min ,
max (g) = V (g) at g ≤ g(free)
V (syn)
min ,
V (g) = V0 tanh((g + 2)/(V0T )),
g(free)
min
as a solution of the set of the equations
v = V (g) and g = G(v, vℓ) at v = vℓ.

is the minimum space gap in free ﬂow found

Speed dependensies of time delays

τ (dec)
1

(v) =

τ (acc)
1

(v) =

(cid:26)

(cid:26)

0.5 s
0.7 s
0.57 s
0.87 s

at v ≥ vc,
otherwise,
at v ≥ vc,
otherwise.

Table 2. ATD-model parameters
V0 = 33.3 m/s (120 km/h), T = 0.9 s,
A0 = 0.5 s−1, K (acc) = 0.8 s−1, K (jam) = 1 s−1,
K (dec)
1
T (syn)
0
max = 0.95 m, τ (dec)
g(jam)
0
amax = 1 m/s2, amin = −1 m/s2,
α = 0.5, b = 4 m/s2, Ts = 1 s, T0 = 0.4 s,
Lm = 300 m, Lr = 500 m, γ = 0.22, ∆v(1)

= 0.95 s−1, K (dec)
= 2.5 s, κ(acc) = 0.5 s2/m, κ(dec) = 0.55 s2/m,
= 1 s, τ (acc)

r = 8 m/s.

2

0

= 0.75 s, τs = 0.4 s,

= 0.48 s−1, vc = 15 m/s, δ = 0.15,

Deterministic approach to microscopic three-phase traﬃc theory

9

Figure 1. Model steady states for the ADT-model: (a) - in the space-gap–speed
plane. (b) - in the ﬂow–density plane. (c) – Steady states and the line J.

Deterministic approach to microscopic three-phase traﬃc theory

10

According to (22)–(25), the model steady states consist of the curve v = V (g)
(22) at g > g(free)
(curve F in Fig. 1 (a)) associated with the free ﬂow phase, a two-
min
dimensional region in the space-gap–speed plane determined by inequalities in (23),
(25) associated with the synchronized ﬂow phase, and the line v = 0 at g ≤ g(jam)
max
(24) associated with the wide moving jam phase (Fig. 1 (a)). The two-dimensional
region for steady states of synchronized ﬂow is limited by the following boundaries:
the line U , the curve L, the curve v = V (g) (22) at g ≤ g(free)
min , and the horizontal
line g = g(jam)
max . The boundary U associated with the safe speed is determined by the
condition (25) when it is the equality: g = vTs. The boundary L is found from the
condition g = G(v).

In the ﬂow–density plane, free ﬂow (curve F in Fig. 1, (b)) is found from

q = ρVF(ρ)

max where VF(ρ) = V (g) |g=ρ−1−d, ρ(free)

(26)
min + d)−1. A wide moving
at ρ < ρ(free)
jam is associated with the horizontal line q = 0 at ρ(jam)
min ≤ ρ ≤ ρmax (Fig. 1 (b)), where
max + d)−1, ρmax = d−1. The boundaries of a two-dimensional region for
min = (g(jam)
ρ(jam)
steady states of synchronized ﬂow are: the upper line U determined by the condition
q = (1 − ρd)/Ts, the lower curve L determined by the condition ρG(q/ρ) = 1 − ρd, the
curve (26) at ρ ≥ ρ(free)

max , and the vertical line ρ = ρ(jam)
min .

max = (g(free)

3. Speed Adaptation Model

3.1. Empirical F→S→J Transitions as Physical Basis of Speed Adaptation Model

The fundamental hypothesis of three-phase traﬃc theory, which postulates that
hypothetical steady states of synchronized ﬂow cover a two-dimensional region in the
ﬂow–density plane, is also one of the basic hypotheses of the ATD-model presented
in a speed adaptation
In contrast with the ATD-model,
above (Fig. 1 (a, b)).
model (Speed Adaptation model, SA-model for short) presented below hypothetical
steady states of synchronized ﬂow are associated with a curve, i.e., they cover a one-
dimensional region in the ﬂow–density plane (curve S in Fig. 2 (a, b)). The curve S
is associated with an averaging of an inﬁnite number of steady states of synchronized
ﬂow to one synchronized ﬂow speed for each space gap (density).

The basis hypothesis of the SA-model is associated with the sequence of F→S→J
transitions, which determine moving jam emergence in empirical observations [28, 7].
To explain the F→S→J transitions, as in three-phase traﬃc theory in the SA-model
it is assumed that at each given density in free ﬂow the critical amplitude of a local
ﬂuctuation required for an F→S transition is considerably smaller than the one for an
F→J transition.

Note that as in the models and theories in the context of the fundamental diagram
approach [3, 4, 5, 6], in the SA-model steady state model solutions cover a one-
dimension region(s) in the ﬂow–density plane. However, in the models and theories
in the context of the fundamental diagram approach the F→J transition governs the
In
onset of congestion [3, 4, 5, 6]. This is inconsequent with empirical results [7].
contrast, in the SA-model the onset of congestion is associated with an F→S transition,
whereas moving jams occur spontaneously only in synchronized ﬂow, in accordance
with empirical results.

Deterministic approach to microscopic three-phase traﬃc theory

11

Figure 2. Model steady states for the SA-model: (a, b) - in the space-gap–speed
(a) and the ﬂow–density plane for the SA-model (27)–(33) (b). (c, d) - the SA-
model (27)–(32), (34). (e, f) - other possible SA-models (see Appendix B). (g, h)
– Steady states and the line J for the model (a, b) and the model (c, d).

Deterministic approach to microscopic three-phase traﬃc theory

12

The SA-model is simpler than the ATD-model. However, due to this simpliﬁcation
the SA-model cannot show some features of congested patterns of the ATD-model
(Sect. 4.3), which are observed in empirical observations. The purpose of the SA-
model is to simulate an F→S transition and features of the sequence of F→S→J
transitions, as observed in empirical observations [28, 7], in a simple way. This conﬁrms
an assumption of three-phase traﬃc theory that if rather than the fundamental
hypothesis of this theory, one of its consequences (e.g., the hypothesis about the
F→S→J transitions, which is the basis of a mathematical model), then the model
can show and predict some important empirical features of the phase transitions (see
footnote 4 of Sect. 4.3.4 in [7]).

3.2. Basic Equations

There can be diﬀerent possibilities for a separation of steady states of free ﬂow and
synchronized ﬂow in SA-models, which all exhibit qualitatively the same features of
the F→S→J transitions. To illustrate this, here we consider two variants of SA-
models; in Appendix B two other possible variants of SA-models are discussed. All
these variants of the SA-models exhibit very similar features of phase transitions and
spatiotemporal congested traﬃc patterns that are associated with the same physics of
these SA-models.

A formulation for the SA-model reads as follows

dx
dt

dv
dt

= v,

= 


a(free)
a(syn)
a(jam)

min and g > g(jam)
max ,
min and g > g(jam)
max ,

at v ≥ v(free)
at v < v(free)
at 0 ≤ g ≤ g(jam)
max ,



a(free), a(syn), and a(jam) are vehicle accelerations (decelerations) in free ﬂow,
synchronized ﬂow, and a wide moving jam, respectively; v(free)
is the minimum speed
min
in free ﬂow associated with the maximum ﬂow rate q(free)
max and the maximum density
max /ρ(free)
ρ(free)
max in accordance with the formula v(free)
max . The vehicle acceleration
a = dv/dt in (28) is supposed to be limited by the maximum acceleration amax, i.e.,
in (28)

min = q(free)

a(phase) = min(˜a(phase), amax),

where as above the superscript “phase” in (29) means either “free”, or “syn”, or else
“jam”.

3.3. Vehicle Acceleration

Functions ˜a(free)(g, v, vℓ), ˜a(syn)(g, v, vℓ), and ˜a(jam)(v) in (29) are chosen as follows

˜a(free)(g, v, vℓ) = A(free)(V (free)(g) − v) +
K (free)(v, vℓ)(vℓ − v),

˜a(syn)(g, v, vℓ) = A(syn)
K (syn)(v, vℓ)(vℓ − v),
˜a(jam)(v) = −K (jam)v.

(cid:0)

V (syn)
av

(g) − v

+

(cid:1)

(27)

(28)

(29)

(30)

(31)

(32)

Deterministic approach to microscopic three-phase traﬃc theory

13

Similarly to the ATD model, V (free)(g) is a gap-dependent optimal speed in free ﬂow;
V (syn)
(g) is an average vehicle speed in steady states of synchronized ﬂow; A(free),
av
A(syn), K (free), K (syn), and K (jam) are sensitivities.

Two versions of functions V (syn)

av

(g) in (31) that lead to two diﬀerent versions of

the SA-models are considered:

V (syn)
av

(g) = ˜g/T (syn)

,

av

and

V (syn)
av

(g) = V1

tanh

˜g
T (syn)
av

+ c˜g

,
(cid:21)

V1 (cid:19)

(cid:20)

(cid:18)

where ˜g = g − g(jam)

max ; T (syn)

av

, V1 and c are constants.

3.4. Steady States and Model Parameters

In the SA-models, in accordance with (28) there are three isolated curves for steady
states of the SA-models associated with the three traﬃc phases: free ﬂow, synchronized
ﬂow, and wide moving jam (Fig. 2 (a, b)).

Steady states of free ﬂow are related to a curve v = VF(ρ) given by (26) (the

curve F in Fig. 2 (a–d)) associated with the condition

v = V (free)(g)

at v ≥ v(free)
min .

Steady states of synchronized ﬂow are related to a curve S in the space-gap–speed

plane (Fig. 2 (a, c)) given by the condition

v = V (syn)

av

(g) at v < v(free)

min and g > g(jam)
max .

In terms of the ﬂow rate q and density ρ, the formula (36) reads

q = ρVS(ρ) at ρ(syn)

min < ρ < ρ(jam)
min ,
max + d)−1, g(syn)
min = (g(syn)

max is found from the

where VS(ρ) = V (syn)
av
equation V (syn)
(g(syn)
max ) = v(free)
min .

av

(g) |g=ρ−1−d, ρ(syn)

In the case of the function V (syn)

av

equation for the line S with a negative slope in the ﬂow–density plane (Fig. 2 (b))

(g) given by (33), the formula (37) yields the

q = (1 − ρ/ρ(jam)

min )/T (syn)

min < ρ < ρ(jam)
min .
(g) is given by formula (34), the curve S has a maximum in

at ρ(syn)

(38)

av

When the function V (syn)
the ﬂow–density plane (Fig. 2 (d)).

av

Steady states for a wide moving jam are the same as those in the ATD-model,

i.e., they are given by a horizontal line

q = 0 at ρ(jam)

min ≤ ρ ≤ ρmax

in the ﬂow–density plane (Fig. 2 (b, d)).

Parameters of the SA-model are shown in Table 3.

(33)

(34)

(35)

(36)

(37)

(39)

Deterministic approach to microscopic three-phase traﬃc theory

14

Table 3. SA-model parameters

V (free)(g) = V (g),
V (g) = V0 tanh(g/(V0T )), V0 = 33.3 m/s (120 km/h), T = 0.85 s,
amax = 2 ms−2; A(free) = 0.4 s−1,
A(syn) = 0.1 s−1, K (jam) = 2 s−1,
K (free)(v, vℓ) = K (syn)(v, vℓ) = K(v, vℓ)
where K(v, vℓ) is given in Table 1,
K (dec)(v) is given in Table 1 at vc = 10 m/s, δ = 0.07.
In the SA model with function V (syn)
(g) (33), we use
= 0.95 s−1K (dec)
min = 22.22 m/s (80 km/h), K (dec)
v(free)
K (acc) = 0.4 s−1; T (syn)
av = 1.2 s, g(jam)
In the SA model with function V (syn)
min = 23.61 m/s (85 km/h), K (dec)
v(free)
2
K (acc)(v) = 0.3 + 0.4 min(1, v/12) s−1, V1 = 20 m/s,
c = 0.007 m−1, T (syn)
av = 1 s, g(jam)

(g) (34), we use
= 0.95 s−1, K (dec)

1
max = 0.7 m.

max = 1 m.

av

av

2

1

= 0.64 s−1,

= 0.75 s−1,

4. Diagram of Congested Traﬃc Patterns at On-Ramp Bottleneck

4.1. Congested Patterns in ATD-Model

S

S

Numerical simulations of the ATD-model show that a diagram of congested patterns
(Fig. 3), which appear on the main road upstream of the bottleneck, is qualitatively
the same as those for the stochastic model of Ref. [33, 34, 35]. The diagram (Fig. 3
(a)) shows regions of diﬀerent types of congested patterns in the ﬂow–ﬂow plane whose
co-ordinates are qon and qin.

and S(B)

There are two main boundaries in the diagram, F (B)

(Fig. 3 (a)).
At the boundary F (B)
, a ﬁrst-order F→S transition occurs spontaneously leading
to a synchronized ﬂow pattern (SP) formation upstream of the bottleneck. At
the boundary S(B)
in the diagram, wide moving jam(s) emerges spontaneously in
synchronized ﬂow upstream of the bottleneck, i.e., an S→J transition is realized. As a
result, a general pattern (GP) emerges due to the sequence of the F→S→J transitions,
if the ﬂow rates qin and qon are related to a point (qon, qin) that is right of the boundary
S(B)
J

in the diagram.
Depending on qin and qon, there are three types of SPs that can occur at the
boundary F (B)
due to the F→S transition: A widening SP (WSP) (Fig. 3 (c)), a
moving SP (MSP) (Fig. 3 (d)), and a lolalized SP (LSP) (Fig. 3 (e)); in addition in
a neighborhood at the boundary F (B)
S within the region of WSP in the diagram, an
alternating SP (ASP) can occur (Fig. 3 (f)). These SPs exhibit qualitative features
as those found in a stochastic three-phase traﬃc theory [33, 35].

S

J

J

If an WSP exists at the bottleneck (region labeled WSP & ASP in the diagram,
Fig. 3 (a)) and at a given qin the ﬂow rate qon gradually increases beyond the
boundary S(B)
in the diagram, then wide moving jams begin to emerge spontaneously
in synchronized ﬂow of an initial WSP, i.e., the WSP transforms into one of the GPs.
There are two possibilities for GP formation right of the boundary S(B)
J : (i)
At greater ﬂow rates qin, a dissolving GP (DGP) appears (Fig. 3 (h)), if a point

J

Deterministic approach to microscopic three-phase traﬃc theory

15

Figure 3. Congested patterns in the ATD-model: (a) – Diagram of congested
patterns. (b) – Maximum capacity in free ﬂow at the bottleneck q(free B)
, the
discharge ﬂow rate downstream of the congested bottleneck q(bottle)
, and the
capacity drop δq. (c–h) – Congested patterns upstream of the bottleneck related
to (a): (c–f) – SPs and (g, h) – GPs. (c) – WSP, (d) – sequence of MSPs, (e) –
LSP, (f) – alternating synchronized ﬂow pattern (ASP), (g) – GP, (h) – DGP. In
(c–f) the ﬂow rates (qon, qin) are: (c) (350, 2140), (d) (60, 2340), (e) (360, 1800),
(f) (240, 2026), (g) (460, 2450), (h) (360, 2450) vehicles/h. q(free B)
max, lim ≈ 2470
vehicles/h. In (b) the discharge ﬂow rate q(bottle)
is changed from 2270 vehicles/h
to 1925 vehicles/h, qout ≈ 1805 vehicles/h.

max

out

out

Deterministic approach to microscopic three-phase traﬃc theory

16

(qon, qin) is within the region labeled DGP in the diagram. (ii) At smaller qin right
of the boundary S(B)
J , an initial SP (WSP or LSP) transforms into an GP in which
no interruption of wide moving jam emergence in synchronized ﬂow is realized (Fig. 3
(g)). Such GPs appears also at greater qin right of the line D in the diagram.

As in the KKW cellular automata (CA) model [34, 7], in the ATD-model the
maximum ﬂow rate in free ﬂow downstream of the bottleneck q(free B)
is a decreasing
max
function of qon (Fig. 3 (b)). Recall, that the ﬂow rate q(free B)
(qon) is the ﬂow rate
associated with the boundary F (B)
in the diagram of congested patterns at which an
F→S transition occurs at the bottleneck. After a congested pattern is formed at the
bottleneck due to this F→S transition, the ﬂow rate downstream of the congested
bottleneck called discharge ﬂow rate q(bottle)
(Fig. 3 (b)) is usually smaller than the
initial ﬂow rate q(free B)

. The diﬀerence

max

out

S

(qon) − q(bottle)
called “capacity drop” (see references in [7]) is an increasing function of qon at the
boundary F (B)

in the diagram of congested patterns.

(qon)

(40)

max

out

S

max
δq(qon) = q(free B)

4.2. Nucleation and Metastability Eﬀects of Pattern Formation

Numerical simulations show that an F→S transition at the bottleneck is a ﬁrst-order
phase transition, which is accomponied by nucleation and metastability eﬀects, as well
as by a hysteresis in SP emergence and dissolution. If an initial point (qon, qin) is
left of the boundary F (B)
in the diagram (Fig. 3 (a)), there is a limited region in the
diagram in which a short-time local speed (density) perturbation in a neighborhood of
the bottleneck can lead to an induced F→S transition at the bottleneck. At a greater
perturbation, after an F→S transition has occurred at the bottleneck, wide moving
jams emerge spontaneously in synchronized ﬂow, i.e., an GP is induced.

S

These nucleation and metastability eﬀects are characteristic for both ATD- and
SA-models. For simplicity, we restrict their consideration to the SA-model (27)–(33)
(Figs. 4 and 5). When an initial state at the bottleneck is free ﬂow in which qin is given
and qon increases gradually, then a speed (density) perturbation in free ﬂow localized
at the bottleneck appears spontaneously. The perturbation consists of deterministic
and random components. The random component is associated with diﬀerent dynamic
behavior of vehicles merging onto the main road from the on-ramp. The deterministic
component (deterministic perturbation for short) is permanent and motionless. This
is because the deterministic perturbation is caused by merging of two ﬂows with the
ﬂow rates qin and qon within freeway locations associated with the merging region of
the bottleneck. A spatial dependence of speed and density within the deterministic
perturbation localized in the merging region of the on-ramp (labeled “on-ramp” in
Fig. 4 (a, b)) can be approximately found by averaging of space functions of speed
and density over long enough time interval (Fig. 4 (a, b)).

As the deterministic perturbation at given qin and qon is motionless, the total ﬂow
rate (across the main road and on-ramp lane) qsum = qin + qon within the perturbation
does not depend on spatial co-ordinate, whereas the speed v(x) and density ρ(x)
change in free ﬂow at the bottleneck: qsum = v(B)
free = v(free)ρ(free), where v(B)
free
and ρ(B)
free are the minimum speed and maximum density within the perturbation;
v(free), ρ(free) the speed and density downstream of the perturbation (Fig. 4 (a, b));
free < v(free), ρ(B)
v(B)

free > ρ(free).

freeρ(B)

Deterministic approach to microscopic three-phase traﬃc theory

17

Figure 4. Nucleation and metastability of free ﬂow and synchronized ﬂow in the
SA-model: (a, b) – Spatial dependence of the speed (a) and density (b) within
the deterministic perturbation in free ﬂow at the bottleneck for two ﬂow rates
qon = 150 (curve I) and 240 (curve II) vehicles/h at qin = 2252 vehicles/h. (c) –
Double Z-characteristic in the ﬂow-rate–speed plane for the sequence of F→S→J
transitions. (d, e) – Hysteresis eﬀects in the ﬂow–density plane due to F→S and
reverse S→F transitions. Dotted curves in (d, e) are related to steady state model
solutions.

Deterministic approach to microscopic three-phase traﬃc theory

18

Figure 5. Congested pattern excitation in metastable free ﬂow: (a) – Short-time
(2 min) perturbations in the ﬂow rate qon used for pattern excitation. (b–d) –
WSP (b), GP (c), and MSP (d) induced by the related perturbations (curve 1,
2, and 3 in (a), respectively). qin = 2252 vehicles/h. qon = 220 vehicles/h in (b,
c) and qon = 140 vehicles/h in (d). Amplitudes of perturbations in (a) are: 270
vehicles/h for (b, d) and 500 vehicles/h for (c).

Deterministic approach to microscopic three-phase traﬃc theory

19

The speed v(B)

on

free decreases when qon increases (from point 1 to 5 in Fig. 4 (c)).
Consequently, ρ(B)
free increases. In the ﬂow–density plane, the ﬂow rate on the main road
associated with this density increases too (from point 1 to 5 in Fig. 4 (d)), whereas the
ﬂow rate upstream of the perturbation is equal to qin, i.e., it does not change (from
point 1 to 5 in Fig. 4 (e)). This increase in the perturbation amplitude with qon has
a limit qon = q(determ, FS)
associated with the deterministic F→S transition (dotted
down-arrow in Fig. 4 (c)). However, non-homogeneous free ﬂow dynamics, which is
caused by vehicle merging, results in an F→S transition at a smaller qon (point 5
in Fig. 4 (c)) related to a point on the boundary F (B)
in the diagram of congested
patterns (Fig. 6 (a)). The speed decreases and density increases abruptly within the
initial perturbation (arrows F→S from point 5 to 5′ in Fig. 4 (c–e)) and a congested
pattern emerges at the bottleneck. In the example, an WSP occurs upstream of the
bottleneck due to the F→S transition.

If now qon decreases, the speed within the WSP increases (from point 5′ to 3′
in Fig. 4 (c–e)). This synchronized ﬂow speed increase also has a limit: The speed
increases and density decreases abruptly within the synchronized ﬂow (arrows S→F
from the point 3′ to 3 in Fig. 4 (c–e)) and free ﬂow returns at the bottleneck.

S

However, at the chosen model parameters, this free ﬂow can persist for a short
time only: A new F→S transition occurs spontaneously and MSPs emerge at the
bottleneck (dashed part of the synchronized ﬂow states v(B)
syn in Fig. 4 (c)). This
is because the threshold ﬂow rate qth for MSP existence is smaller than a chosen
value qin. Thus, in accordance with stochastic models [35] at qon > 0 an MSP(s)
emerges spontaneously at the bottleneck. Even if qon = 0, an MSP can be induced by
application a short-time local perturbation in free ﬂow with qin > qth. The amplitude
of this perturbation should be greater than the critical amplitude associated with the
critical branch on the Z-characteristic v(B)
cr, FS. This Z-characteristic for the F→S and
reverse S→F transitions at the bottleneck consists of the states for free ﬂow associated
with the deterministic perturbation at the bottleneck v(B)
cr, FS,
and synchronized ﬂow states v(B)
syn (Fig. 4 (c)). In accordance with this Z-characteristic,
we get the associated hysteresis eﬀects on the fundamental diagram (arrows F→S and
S→F in Fig. 4 (d, e)).

syn , the critical branch v(B)

on

on

If in contrast qon increases, the speed within the WSP decreases (Fig. 4 (c)). This
speed decrease has a limit associated with the ﬂow rate qon = q(cr, SJ)
at which an
S→J transition must occur (dotted down-arrow S→J in Fig. 4 (c)). However, because
there are speed and density waves of a ﬁnite amplitude in synchronized ﬂow, an S→J
transition occurs already for qon < q(cr, SJ)
(point 6 and solid down-arrow in Fig. 4 (c)).
As a result, an GP emerges. This is because in the ATD- and SA-models, synchronized
ﬂow states that are above the line J in the ﬂow–density plane are metastable ones
against wide moving jam emergence. This can be seen from another Z-characteristic
in the ﬂow-rate–speed plane for an S→J transition in synchronized ﬂow that consists
of the states for synchronized ﬂow v(B)
syn , the critical branch for critical perturbations
in synchronized ﬂow v(B)

cr, SJ, and the line v = 0 for wide moving jams (Fig. 4 (c)).

From the resulting double Z-characteristic, it can concluded that in a metastable
free ﬂow at the bottleneck (left of the boundary F (B)
in the diagram in Fig. 6 (a))
depending on amplitude of a time-limited perturbation caused, for example, by an
increase in qon (curves 1 and 2 in Fig. 5 (a)), either an WSP (Fig. 5 (b)) or an GP
(Fig. 5 (c)) can be induced. At smaller qon (curve 3 in Fig. 5 (a)), an MSP (Fig. 5 (d))

S

Deterministic approach to microscopic three-phase traﬃc theory

20

Figure 6. Diagram of congested patterns at the on-ramp bottleneck in SA-model
(28), (33) (a), maximum capacity in free ﬂow at the bottleneck (b) and congested
patterns (c–h) related to (a): (c–e) – SPs and (f–h) – GPs. (c) – WSP, (d) – MSP,
(e) – LSP, (f) – GP arising from WSP at smaller qon, (g) – GP at qin > qout,
(h) - GP at qin < qout. In (c–h) the ﬂow rates (qon, qin) are: (c) (200, 2353), (d)
(140, 2378), (e) (940, 1520), (f) (250, 2353), (g) (400, 2353), and (h) (900, 1770)
vehicles/h. q(free B)

max, lim ≈ 2475 vehicles/h.

Deterministic approach to microscopic three-phase traﬃc theory

21

can be excited in free ﬂow. All results presented in Figs. 4 and 5 for the SA-model
remain qualitatively equal for the ATD-model.

4.3. Congested Patterns in SA-Models

The SA-model (28), (33) (Fig. 6) exhibits the following shortcoming in comparison
with the ATD-model (Fig. 3):

(i) If the ﬂow rate qon is within a ﬂow rate range q(FSJ)

, then no
SP can be formed at the boundary F (B)
in the diagram (Fig. 6 (a)): The sequence of
F→S→J transitions occurs spontaneously at this boundary, leading to GP emergence.
For this reason, the related part of the boundary at which GPs emerge spontaneously
in free ﬂow at the bottleneck is labeled F (B)

on < qon < q(LSP)

on

S & S(B)
J .

S

associated with the ﬂow rate qon = q(LSP)

(ii) If the ﬂow rate qin at this boundary decreases, another characteristic ﬂow rate
qin = q(LSP)
at this boundary is reached:
on
in
At qin < q(LSP)
all moving jams that emerge in synchronized ﬂow upstream of the
bottleneck dissolve. As a result, at qin < q(LSP)
only
in
an LSP remains at the bottleneck. Within this LSP the speed is very low. This LSP
has a qualitative diﬀerent nature in comparison with an LSP of higher synchronized
ﬂow speed in the ATD-model that occurs at considerably greater qin (Fig. 3).

and right of the boundary F (B)

in

S

(iii) In contrast with the ATD-model and with empirical observations, in the
SA-model synchronized ﬂow cannot be formed in wide moving jam outﬂow, i.e., only
free ﬂow occurs in the wide moving jam outﬂow. The reason for this is as follows.
To simulate moving jam emergence in synchronized ﬂow, the average branch for
synchronized ﬂow V (syn)
lies for higher speeds above the line J (Fig. 2 (g)). Flow
states in the jam outﬂow should be related to points on the line J. However, all
synchronized ﬂow states at higher speeds are above the line J. Thus, there are no
synchronized ﬂow states in the jam outﬂow. This explains why only free ﬂow can be
formed in the jam outﬂow in the SA-model. k

av

av

av

If the branch for average synchronized ﬂow states V (syn)

The mentioned shortcoming of the SA-model result from the averaging of a 2D-
region of steady states for synchronized ﬂow in the ﬂow–density plane of the ATD-
model (Fig. 1 (a)) to the branch for average synchronized ﬂow states V (syn)
in Fig. 2.
in a SA-model has a part
with a positive slope (Fig. 2 (d)), then LSPs of higher speeds appear in the diagram
of congested patterns (Fig. 7). However, these LSPs should be considered a model
eﬀect only, rather than they are related to LSPs observed in empirical observations.
To explain this, note that these model LSPs are very narrow ones (Fig. 7 (e)). They
are localized within the merging region of the on-ramp and consist of two narrow
fronts only (Fig. 8 (a)): There is no region of synchronized ﬂow between the fronts
within these LSPs. This is regardless of the ﬂow rates qin and qon. The downstream
front of an LSP is associated with a drop in the speed (and jump in density) due to
a transition from a free ﬂow state on the curve F to an average synchronized ﬂow
state on the part of the branch V (syn)
with a positive slope (curve S in Fig. 2 (d)).
k The only exclusion is the SA-model with the function V (syn)
(34), if parameters for the curve S
and/or the line J, i.e., for wide moving jam propagation are chosen diﬀerent as those shown in Fig. 2
(c, d, h): These diﬀerent parameters should lead to an intersection of the line J with the branch of
the curve V (syn)
with a positive slope in the ﬂow–density plane. However, in this speciﬁc case only
synchronized ﬂow associated with the point of the latter intersection can appear in the moving jam
outﬂow, i.e., this is also a model eﬀect.

av

av

av

Deterministic approach to microscopic three-phase traﬃc theory

22

out

Figure 7. Diagram of congested patterns at the on-ramp bottleneck in the SA-
model (28), (34) (a), the capacity in free ﬂow q(free B)
, the discharge ﬂow rate at
the on-ramp q(bottle)
and the capacity drop δq (b), and congested patterns (c-f)
related to (a): (c-e) - SP and (f) - GP. (c) - WSP, (d) - subsequence of MSP, (e)
- LSP, (f) - GP arising from WSP. In (c-f) the ﬂow rates (qon, qin) are: (c) (200,
2400), (d) (90, 2450), (e) (360, 2115), (f) (300, 2400) vehicles/h. In the model
max, lim ≈ 2475 vehicles/h. In (b) the discharge ﬂow rate q(bottle)
q(free B)
is changed
out
from 2450 vehicles/h to 2200 vehicles/h, qout ≈ 1880 vehicles/h.

max

Deterministic approach to microscopic three-phase traﬃc theory

23

Figure 8. Comparison of LSPs in the SA-model with the function V (syn)
(34)
(a) and in the ATD-model (b). The LSPs and their parameters are the same as
those in Fig. 7 (e) and, Fig. 3 (e) respectively.

av

The upstream front of the LSP is associated with a reverse transition (Fig. 8 (a)).
Conﬂictingly, in empirical observations rather than such narrow LSPs, an extended
region of synchronized ﬂow is usually observed within an empirical LSP and the LSP
width changes over time considerably. These empirical features of LSPs shown by the
ATD-model (Fig. 8 (b)) are not found in the SA-model.
At chosen SA-model parameters the condition

qout > q(pinch)

(41)
is satisﬁed, where q(pinch) is the ﬂow rate within the pinch region of an GP in which
narrow moving jams emerge. Under the condition (41), no DGPs appear in the SA-

Deterministic approach to microscopic three-phase traﬃc theory

models (Figs. 6 and 7). At other parameters of the SA-models, an opposite condition

qout < q(pinch)

can be satisﬁed. Then DGPs appear in the SA-models.

out

The maximum ﬂow rate in free ﬂow downstream of the bottleneck q(free B)

(qon),
the discharge ﬂow rate q(bottle)
, and the “capacity drop” δq can sometimes exhibit
diﬀerent features as those in the ATD-model (Fig. 3 (b)) when the ﬂow rate qon
changes (Figs. 6 (b) and 7 (b)). Particularly, in contrast with the ATD-model, in the
SA-model (28), (33) q(free B)
does not depend on qon, whereas in the SA-model (28),
(34) q(free B)
depends on qon but at considerably greater qon than for the ATD-model.
max
Simulations show that the SA models presented in Appendix B show qualitatively
the same features of the phase transitions and spatiotemporal congested patterns as
those in the SA-model (28), (33).

max

max

4.4. Comparison with Stochastic SA-Models

As mentioned in Sect. 4.1, the ATD-model, in which a 2D region of synchronized
ﬂow steady states is used, exhibits many similar features of the stochastic microscopic
model with a 2D region of synchronized ﬂow steady states ﬁrst introduced in [33] and
further developed in [35]. It is interesting to compare the deterministic SA-models
introduced in this article with possible stochastic SA-models. Such models can be
derived from the stochastic model of Ref. [33, 35], if 2D region of synchronized ﬂow
steady states is averaged to synchronized ﬂow states related to a 1D region in the
ﬂow–density plane.

A stochastic SA-model can easily be derived from the stochastic model of Ref. [35]
based on the physics and ideas for the SA-model approach discussed in Sect. 3. To
reach this goal, in the dynamic part of the stochastic model of Ref. [35]

vn+1 = max(0, min(vfree, vc,n, vs,n)),
xn+1 = xn + vn+1τ

for a desired speed in synchronized ﬂow vc,n, rather than the formula (3) of Ref. [35]
leading to a 2D region of synchronized ﬂow steady states in the ﬂow–density plane,
the following equations associated with the physics of the SA-models of Sect. 3 are
used:

vc,n = vn + max(−bnτ, min(anτ, ∆n)),

A(free)(gn)(vfree − vn)+
K (free)(vℓ,n − vn)
A(syn)(V (syn)
av
+K (syn)(vℓ,n − vn)

(gn) − vn)

at g ≥ g(free)
min

,

at g < g(free)
min .

∆n = 



In (43)–(46), vn and xn are the speed and space co-ordinate of a vehicle; the index n
corresponds to the discrete time t = nτ , n = 0, 1, 2, ..; τ is the time step; vfree is the
maximum speed in free ﬂow which is considered as a constant value; vs,n is the save
speed of Ref. [35]; the lower index ℓ marks variables related to the preceding vehicle;
all vehicles have the same length d; an ≥ 0 is acceleration, bn ≥ 0 is deceleration; the
space gap gn = xℓ,n − xn − d; the average speed in synchronized ﬂow steady states
V (syn)
max = 0. Of course, other formulations for the
av

is given by the formula (33) at g(jam)

24

(42)

(43)
(44)

(45)

(46)

Deterministic approach to microscopic three-phase traﬃc theory

25

average synchronized ﬂow steady states V (syn)
SA-models (Fig. 2 (b, d, f)) can also be applied.

av

, for example used in the deterministic

In general, descriptions of random vehicle acceleration and deceleration are the
same as those in the stochastic model of Ref. [33, 35]: At the ﬁrst step, the preliminary
speed ˜vn+1 is set to ˜vn+1 = vn+1 where the speed vn+1 is calculated from the dynamic
equations (43)–(46). At the second step, a noise component ξn is added to the
calculated speed ˜vn+1. Then the ﬁnal speed is found from the condition [35]

vn+1 = max(0, min(vfree, ˜vn+1 + ξn, vn + amaxτ, vs,n)),

(47)

where amax is the maximum acceleration.

However, in contrast with the stochastic model of Ref. [35], the noise component

ξn in (47) can be diﬀerent from zero only, if the vehicle decelerates, speciﬁcally

−bmaxτ θ(pb − r)
0

if ˜vn+1 < vn − δ
otherwise,

ξn =

(cid:26)

(48)

where r = rand(0, 1), θ(z) = 0 at z < 0 and θ(z) = 1 at z ≥ 0, δ ≪ 1, bmax, pb
are constants. The acceleration an and deceleration bn in (46) are taken as the same
stochastic functions as those in the model of Ref. [35].

Simulations show that the stochastic SA-model (43)–(48) exhibits qualitatively
similar features of phase transitions and of spatiotemporal congested patterns at
the on-ramp bottleneck (Fig. 9) as those in the associated deterministic SA-models
(Fig. 6). Note that under the chosen model parameters in the stochastic SA-model
(43)–(48) the condition (42) is satisﬁed. As a result, there is a region in the diagram
of congested patterns in which DGPs occur (region labeled DGP in Fig. 9 (a)). After
the wide moving jam of the DGP is upstream of the bottleneck as well as in the ATD-
model, an LSP remains at the bottleneck (Fig. 9 (h)).
In contrast with the ATD-
model, this LSP exists for a ﬁnite time interval only and free ﬂow ﬁnally emerging
at the bottleneck. However, in a small neighborhood of the boundary labeled D
in the diagram, which separates DGPs and GPs, there is a peculiarity in pattern
formation, which is related to all deterministic SA-models under the condition (42): If
the ﬂow rate qon increases in the neighborhood of the boundary D in the diagram, then
the lifetime of an LSP, which occurs within an DGP increases and it tends towards
inﬁnity at the boundary D (Fig. 10 (a)). This quasi-steady LSP is explained by a
very long interval between wide moving jam emergence in the synchronized ﬂow at
the bottleneck, which tends towards inﬁnity at the boundary D. Indeed, already a
very small increase in qon beyond the boundary D leads to GP formation with a long
interval between wide moving jams (Fig. 10 (b)).

5. Discussion

5.1. Comparison of ATD- and SA-models with OV-models and other Deterministic
Models

The ﬁrst term in the formula for vehicle acceleration a(free) (9), A(g, v)(V (g) − v),
describes the dynamics of the vehicle speed v in the free ﬂow phase in the vicinity
of the optimal speed in free ﬂow V (g). At a time scale that is considerably greater
than the time delay τ , this dynamic behavior is the same as those in diﬀerent OV-
models [3, 4, 5, 22], which can be written as follows

dv
dt

= A(g, v)(V (g) − v).

(49)

Deterministic approach to microscopic three-phase traﬃc theory

26

Figure 9. Diagram of congested patterns at the on-ramp bottleneck in
the stochastic SA-model (43)–(48) (a), maximum capacity in free ﬂow at the
bottleneck (b) and congested patterns (c–h) related to (a): (c–f) – SPs and (g,
h) – GPs. (c) – WSP, (d) – MSP, (e) – LSP, (f) – ASP, (g) – GP, (h) - DGP. In
(c–h) the ﬂow rates (qon, qin) are: (c) (200, 2250), (d) (60, 2250), (e) (720, 1470),
(f) (120, 2235), (g) (500, 2220), and (h) (352, 2235) vehicles/h. q(free B)
max, lim ≈
2300 vehicles/h. Model parameters: A(free)(gn) = 0.5 min
min )/20
,
g(free)
min = 36 m, A(syn) = 0.1, T (syn)
max = 0, pb = 0.02. p1 =0.55,
(cid:1)
p2(vn) = 0.5 + 0.48θ(vn − 15), amax = bmax = 0.5 m/s2. The other parameters
are the same as those in [35]. The on-ramp model from [35, 36] is used, in which
−
n = g(free)
the synchronization gaps G+
min .

= 1.45 s, g(jam)

1, (gn − g(free)

n = G

(cid:0)

av

Deterministic approach to microscopic three-phase traﬃc theory

27

Figure 10. Transformation of DGP in Fig. 9 (h) to GP with a very long time
interval between wide moving jam emergence (b) through an DGP with a quasi-
steady LSP (a) by a small increase in the ﬂow rate (qon in a neighborhood of the
boundary D in the diagram of congested patterns in Fig. 9 (a). The ﬂow rates
(qon, qin) are: (a) (357, 2235) and (b) (362, 2235) vehicles/h.

However, in the OV-models the vehicle acceleration A(g, v)(V (g) − v) is valid for the
whole possible space gap range [3, 4, 5, 22]

In contrast with the OV-models, in the ATD-model this vehicle acceleration is applied
for large space gaps

g ≥ 0.

g > G

associated with free ﬂow only.

(50)

(51)

Deterministic approach to microscopic three-phase traﬃc theory

28

The crucial diﬀerence of the ATD-model with the OV-models and all other
deterministic microscopic traﬃc ﬂow models (see references in the reviews [1, 3, 4, 5, 6])
is that the vehicle acceleration behavior qualitatively changes when the vehicle is
within the synchronization gap, i.e., if the condition

g ≤ G,

(52)

which is opposite to the condition (51), is satisﬁed.

The condition (52) is associated with the synchronized ﬂow phase in which there
is no optimal speed in the ATD-model. This conclusion follows from (10) and its
analysis made in Sect. 2.6 in which it has been shown that for a given steady space
gap in synchronized ﬂow there are an inﬁnity of steady vehicle speeds within a ﬁnite
speed range (Fig. 1 (a)).

The crucial diﬀerences between the SA-models and OV-models and all other
deterministic microscopic traﬃc ﬂow models in which steady states covering a one-
dimensional region(s) in the ﬂow–density plane (see references in the reviews [1, 3, 4,
5, 6]) are as follows. In the SA-models, at each density of free ﬂow states the critical
amplitude of a local perturbation required for an F→S transition is considerably
smaller than the critical amplitude of a local perturbation required for an F→J
transition.

In the SA-models, there are two ranges of model steady states separated one
from another by a model discontinuity in vehicle space gap or in speed (Fig. 2
(a–e)) or else due to instability of model steady states against inﬁnitisimal non-
homogeneous ﬂuctuations (Fig. 2 (f)) This simulates the hypothesis of three-phase
traﬃc theory about a competition between over-acceleration and speed adaptation
eﬀect that is responsible for F→S and S→F transitions: The ﬁrst range of steady
states simulates free ﬂow, whereas the second simulates synchronized ﬂow. To simulate
S→J transitions within synchronized ﬂow, steady states associated with synchronized
ﬂow are metastable with respect to moving jam emergence, i.e., moving jams emerge
in these synchronized ﬂow states only if large enough amplitude local perturbations
appear. These requirements to the SA-models lead to F→S→J transitions that are
responsible for moving jam emergence found in empirical data [7].

5.2. Critical Discussion of Theories and Models based on the Fundamental Diagram
Approach

In the OV model (49), as in other deterministic (and stochastic) traﬃc ﬂow
models in the context of the fundamental diagram approach, which claim to show
spontaneous jam emergence, there is a range of the density on the fundamental
diagram in which steady states on this diagram are unstable against inﬁnitesimal
perturbations [3, 4, 5, 6]. This instability leads to wide moving jam emergence in these
models both on homogeneous road and at a bottleneck, i.e., to an F→J transition. We
denote the minimum density of this density range, in which inﬁnitisimal ﬂuctuations
grow, by ρ(FJ)

(Fig. 11 (a, b)).

cr

There are two possibilities for the arrangement of the point of this instability
, q(FJ)
) on the fundamental diagram in the OV model and other models in the
cr

(ρ(FJ)
cr
context of the fundamental diagram approach:

(i) The point (ρ(FJ)

) lies left of the maximum point of the fundamental
diagram (ρ0, q0), i.e., on the branch of the diagram with a positive slope (Fig. 11 (a)):

cr

, q(FJ)
cr

ρ = ρ(FJ)

cr < ρ0

(53)

Deterministic approach to microscopic three-phase traﬃc theory

29

Figure 11. Traﬃc patterns in OV-models at an on-ramp bottleneck: (a, b) –
Fundamental diagrams of OV-models when the condition (53) (a) and (54) (b) are
satisﬁed, respectively. (c, d) – Widening patterns of dense ﬂow upstream of the
bottleneck at two ﬂow rates qon =160 (c) and 400 (d) vehicles/h. (e) – Formation
of wide moving jams within the dense ﬂow upstream of the bottleneck at qon =700
vehicles/h. In (c–e) the ﬂow rate qin =2676 vehicles/h. Figures (c–e) are related
to the OV-model (b) at V (g) = V0
at V0 = 14
m/s, g0 = 17 m, g1 = 7 m, the sensitivity A(g, v) = A(v) in (49) is A(v) = 5 at
v ≥ 12 m/s and A(v) = 0.9 at v <12 m/s.

tanh((g − g0)/g1) + tanh(g0/g1)

(cid:1)

(cid:0)

Deterministic approach to microscopic three-phase traﬃc theory

30

(ii) The point (ρ(FJ)

) lies right of the maximum point of the fundamental
diagram (ρ0, q0), i.e., on the branch of the diagram with a negative slope (Fig. 11
(b)):

, q(FJ)
cr

cr

Note that in both cases (i) and (ii) all states on the fundamental diagram, in

ρ = ρ(FJ)

cr > ρ0.

which the density satisﬁes the condition

ρmin ≤ ρ < ρ(FJ)

,

cr

(54)

(55)

where ρmin is the density in the wide moving jam outﬂow associated with the ﬂow
rate qout, are metastable states with respect to an F→J transition.

The case (i) has intensively been considered in the literature [3, 4, 5, 6]. On
a homogeneous road as well as at an on-ramp bottleneck an F→J transition occurs
spontaneously, when the ﬂow rate qin is large enough [42, 25, 22, 26, 27, 4]. Thus,
the onset of congestion in these models is associated with the F→J transition. As
mentioned in Sect. 1, this model result is inconsistent with empirical observations in
which a ﬁrst-order F→S transition governs the onset of congestion in free ﬂow.

In the case (ii) (Fig. 11 (b)), the ﬂow rate in free ﬂow downstream of an on-ramp
bottleneck qsum cannot exceed the maximum ﬂow rate on the fundamental diagram
If qin is a given large enough value and the ﬂow rate qon begins to increase,
q0.
then a localized perturbation that has qualitatively the same features as in the ATD-
and SA-models (Sect. 4.2) appears in a neighborhood of the bottleneck (Fig. 12 (a,
b)). In particular, the minimum speed v(B)
free within the perturbation decreases when
qon increases (points 1–4 in Fig. 12 (c)). In the OV-model, when qon increases, the
location of the minimum speed v(B)
free within the perturbation exhibits ﬁrstly a slight
shift downstream and then upstream within the merging region of the on-ramp (Fig. 12
(a, b)). For this reason, the ﬂow rate on the main road at the location of the minimum
speed v(B)
free ﬁrstly slightly increases and then decreases (points 1–4 in Fig. 12 (e)),
whereas the ﬂow rate on the main road upstream of the on-ramp merging region is
equal to qin (points 1–4 in Fig. 12 (d)).

At a given large enough ﬂow rate qin this growth of the local perturbation with
qon has a limit. This limit is reached when the ﬂow rate qsum aproaches the maximum
ﬂow rate on the fundamental diagram:
q(max)
sum = qin + qon = q0.

(56)

When the ﬂow rate qon further increases, i.e.,

∆q = qin + qon − q0 > 0,

then upstream of the bottleneck a dense traﬃc ﬂow with the density ρd > ρ0 and ﬂow
rate qd < q0 associated with the branch of the diagram with a negative slope occurs
(Fig. 11 (c, d)). The greater the ﬂow rate qon, speciﬁcally the greater ∆q (57), the
greater the velocity of the upstream front of this dense ﬂow (Fig. 11 (c, d)) and the
lower vehicle speed within the dense ﬂow (points 5, 6 in Fig. 12 (c)).

This widening dense ﬂow upstream of the bottleneck can exist only, when the

density ρd in the dense ﬂow satisﬁes the condition
ρ0 < ρd < ρ(FJ)

.

cr

This is because at the density ρd = ρ(FJ)
the dense ﬂow loses its stability against
wide moving jam emergence (point 7 and dotted down-arrow in Fig. 12 (c)). Due to

cr

(57)

(58)

Deterministic approach to microscopic three-phase traﬃc theory

31

Figure 12. Pattern evolution in the OV-model in Fig. 11 (b) at an on-ramp
bottleneck: (a, b) – averaged speed (5-min averaged data) (a) and density (b) as
freeway location functions within the deterministic perturbation localized at the
bottleneck at diﬀerent ﬂow rates. qon = 80 (curve I) and 120 (curve II) vehicles/h.
(c, d) – On-ramp ﬂow rate dependences of the speed (c), ﬂow rate and density (d,
e) within patterns at the bottleneck. Dotted curves on Fig. (d, e) show steady
model states in the ﬂow–density plane. qin = 2676 vehicles/h.

Deterministic approach to microscopic three-phase traﬃc theory

32

large ﬂuctuations at the bottleneck, in numerical simulations this instability occurs
already at the density ρd < ρ(FJ)
. This conﬁrmes that wide moving jam emergence is
associated with a ﬁrst-order phase transition (point 6 and solid down-arrow in Fig. 12
(c)).

cr

The congested patterns in Fig. 11 (c, d) at the ﬁrst glance resemble a widening
SP and an GP, respectively. Indeed, in both cases a dense ﬂow occurs upstream of the
bottleneck whose downstream front is ﬁxed at the bottleneck. Thus, this dense ﬂow
should satisfy the macroscopic spatiotemporal objective criteria for the synchronized
ﬂow phase (Sect. 1). This conclusion is, however, incorrect. To explain this, note that
in empirical observations application of the objective criteria for the traﬃc phases
in congested traﬃc leads to clear distinction of the synchronized ﬂow phase. This
is because in this case this empirical traﬃc ﬂow exhibits all necessary features of
synchronized ﬂow. One of the most important features is the probabilistic nature
of synchronized ﬂow emergence in free ﬂow, i.e., that an F→S transition is a ﬁrst-
order phase transition. In contrast, in a traﬃc ﬂow theory application of the objective
criteria does not guarantee that a dense traﬃc ﬂow exhibits the probabilistic nature
of synchronized ﬂow emergence.

This conclusion concerns the OV model under the condition (54) (Fig. 11 (b)) as
well as in other models in the context of the fundamental diagram approach. Whereas
for the SA-model there is a Z-shaped speed–ﬂow rate characteristic associated with
the probabilistic nature of synchronized ﬂow emergence in free ﬂow at the bottleneck
(Fig. 4 (c–e)), for the OV-model the on-ramp ﬂow rate dependence of the speed at
the bottleneck is a monotonous decreasing function (Fig. 12 (c)): There is no ﬁrst-
order phase transition, when a dense ﬂow related to the fundamental diagram with
a negative slope is formed upstream of the bottleneck. Thus, the dense traﬃc ﬂow
in the case OV-model and other models in the context of the fundamental diagram
approach does not exhibit the important empirical feature of synchronized ﬂow and,
therefore, the dense ﬂow is not associated with the synchronized ﬂow phase.

This dense ﬂow occurs due to maximum point on the fundamental diagram
(point (ρ0, q0) in (Fig. 11 (b)) and a spatial non-homogeneity on the road caused
by the bottleneck. In other words, rather than a probabilistic nucleation eﬀect that is
shown by empirical synchronized ﬂow, this dense ﬂow occurs on a deterministic way.
There is no hysteresis and there is no speed drop that are characteristic for empirical
synchronized ﬂow emergence at the bottleneck, when dense ﬂow is formed upstream of
the bottleneck after the ﬂow rate qsum exceeds q0 associated with the maximum point
(ρ0, q0) on the fundamental diagram (Fig. 12 (c)). Thus, this dense ﬂow together
with free ﬂow associated with the branch of the fundamental diagram with a positive
slope can be considered the free ﬂow phase. Only when the density in this dense ﬂow
approaches the critical density ρ(FJ)
cr moving jams begin to emerge in this dense ﬂow.
Consequently, the point (ρ(FJ)
, q(FJ)
) on the fundamental diagram can be considered
cr
as the critical point for an F→J transition in the OV-model.

cr

We see that all eﬀects of diﬀerent pattern formation at the bottleneck in the OV-
models as well as in other models in the context of the fundamental diagram approach
are model eﬀects only, which have no relation to empirical observations of congested
traﬃc patterns [7]. The only one exception is characteristic parameters of wide moving
jam propagation ﬁrst discovered in [42].

Deterministic approach to microscopic three-phase traﬃc theory

33

5.3. Conclusions

(i) Two diﬀerent deterministic microscopic traﬃc ﬂow model classes in the context
of three-phase traﬃc theory, the ATD- and SA-models, have been introduced in the
article.

(ii) The ATD- and SA-models reproduce most important empirical spatiotemporal

features of phase transitions in traﬃc ﬂow and congested traﬃc patterns.

(iii) In contrast with all other known deterministic microscopic traﬃc ﬂow models,
in the ATD- and SA-models vehicles moving in free ﬂow and vehicles moving in
synchronized ﬂow exhibit qualitatively diﬀerent dynamic behavior. This is a result of
the introduction of two separated regions of steady state model solutions for free ﬂow
and synchronized ﬂow in the ATD- and SA-models as well as diﬀerent dynamic rules
of vehicle motion in free ﬂow and synchronized ﬂow implemented in the models.

(iv) There is a ﬁrst-order phase transition in the ATD- and SA-models from free
ﬂow to synchronized ﬂow. This means that the ATD- and SA-models exhibit the
probabilistic nature of an F→S transition at the bottleneck observed in empirical
observations.

(v) The probabilistic nature of the onset of congestion in free ﬂow at the bottleneck
that the ATD- and SA-models show is also associated with metastability of free ﬂow at
the bottleneck against external short-time disturbances in this ﬂow in a neighborhood
of the bottleneck. As a result, there is multiple congested pattern emergence in an
initial free ﬂow at the bottleneck in the ATD- and SA-models: Depending on an
amplitude (or duration) of an external disturbance, one of the SPs or else an GP can
be induced in free ﬂow at the bottleneck at the same chosen model parameters.

(v) In accordance with empirical results, in the ATD- and SA-models moving
jams can emerge spontaneously in synchronized ﬂow only, i.e., as a result of F→S→J
transitions.

(vi) In addition to the above common behavior of the ATD- and SA-models,
these models exhibit also some qualitatively diﬀerent features. This is because in the
ATD-model synchronized ﬂow model steady states are related to a 2D-region in the
ﬂow–density plane, whereas synchronized ﬂow model steady states in the SA-models
belong to an 1D-region (a curve) in the ﬂow–density plane. In particular, the following
diﬀerences of model features have been found:

(1) The ATD-model can show all types of spatiotemporal congested patterns at
an on-ramp bottleneck observed in empirical observations. The ADT-model exhibits
qualitatively the same diagram of congested patterns at the bottleneck as those in
microscopic stochastic models in the context of three-phase traﬃc theory of Ref. [33].
(2) In contrast, whereas WSPs and GPs can also be reproduced by SA-models,
these models cannot show LSPs associated with empirical results as well as diﬀerent
states of synchronized ﬂow in the wide moving jam outﬂows.

(vii) Deterministic models in the context of the fundamental diagram approach
(see references in [4]) cannot explain the onset of congestion in free ﬂow, which in
empirical observations are associated with a ﬁrst-order F→S transition.
In these
models, when the density in free ﬂow at the bottleneck exceeds the density associated
with the maximum point at the fundamental diagram, widening dense traﬃc ﬂow
occurs upstream of an on-ramp bottleneck. In contrast with empirical observations,
there is no nucleation of this dense traﬃc ﬂow in an initial free ﬂow at the bottleneck:
This model dense ﬂow results from non-homogeneity of a freeway in a neighborhood
of the bottleneck. Thus, these models cannot show the probabilistic nature of

Deterministic approach to microscopic three-phase traﬃc theory

34

the onset of congestion at the bottleneck. However, the probabilistic nature is
the fundamental empirical feature of the onset of congestion in free ﬂow with the
subsequent synchronized ﬂow phase emergence at the bottleneck. In other words, this
dense traﬃc ﬂow is not to be identiﬁed as synchronized ﬂow, i.e., this dense ﬂow is a
model eﬀect only, which has no relation to real traﬃc ﬂow.

Appendix A.

To derive the formula (12) for the safety acceleration, let us use the concept of safety
speed vs proposed by Gipps [41]. A simple condition for the safety speed vs can be
written as follows:

vsTs + v2

s /(2bs) ≤ g + v2

(A.1)
ℓ /(2bs),
where bs is a constant deceleration. When (A.1) is an equality, the formula (A.1) gives
the equation for the speed vs as a function of space gap g and the preceding vehicle
speed vℓ. The solution of this equation can be written as:

vs(g, vℓ) =

bsTs +

2bsg + v2
ℓ
b2
s T 2

s + 2bsg + v2
ℓ

.

p

From (A.1), (A.2) it can be seen that if g = vℓTs, the safety speed vs equals vℓ. Since
the vehicle speed v cannot exceed the safe speed, and hence v ≤ vs = vℓ at g = vℓTs,
the space gap g cannot become smaller than vℓTs.
In particular, this ensures the
collision-free vehicle motion in models with safety speed. The condition g ≥ vℓTs
can be used, to simplify the formula (A.2). For this purpose, the space gap g in
denominator of (A.2) can be replaced by the value vℓTs. Then formula (A.2) reads

Let us deﬁne the safety acceleration as as an acceleration needed for the driver to
reach the safety speed vs at time t1 = t + T0, provided the vehicle moves with the
speed v at time t:

vs(g, vℓ) =

g + v2
ℓ /(2bs)
Ts + vℓ/(2bs)

.

as =

vs(g(t1), vℓ(t1)) − v(t)
T0

,

where T0 is a constant equal or greater than the minimum driver time delay. Neglecting
the changes in vehicle speeds v and vℓ during the time T0, and estimating the space
gap g at time t1 as g(t1) = g(t) + (vℓ(t) − v(t))T0, from (A.3), (A.4) we get:

T0 + vℓ/(2bs)
Ts + vℓ/(2bs)
(cid:1)
where all values are related to the same time moment t.
(cid:1)

g − vTs +
T0
(cid:0)
(cid:0)

as(g, v, vℓ) =

(vℓ − v)

,

In the microscopic model this formula for the safety acceleration as (12) is used

with a heuristic coeﬃcient α and at b = 2bs.

Appendix B.

In this Appendix, two further variants of the SA-models are presented. In the ﬁrst of
these variants, the formula (28) reads as follows

(A.2)

(A.3)

(A.4)

(A.5)

(B.1)

a(free)
a(syn)
a(jam)

,
max < g < g(free)
min ,

at g ≥ g(free)
min
at g(jam)
at 0 ≤ g ≤ g(jam)
max ,

dv
dt

= 




Deterministic approach to microscopic three-phase traﬃc theory

35

where a(free), a(syn), a(jam) are given by (29)–(33). In this SA-model, steady states of
free ﬂow (the curve F in Fig. 2 (e)) correspond to the condition (35), averaged steady
states of synchronized ﬂow are related to a line S given by the condition
min )/T (syn)

max < ρ < ρ(jam)
min ,

q = (1 − ρ/ρ(jam)

at ρ(free)

(B.2)

av

steady states for a wide moving jam are associated with the condition (39) (Fig. 2
(e)).

In the second SA-model, formula (28) reads as follows

a(free)
a(FS)
a(syn)
a(jam)

at g ≥ g(free)
min ,
at g(syn)
at g(jam)
at 0 ≤ g ≤ g(jam)
max ,

max < g < g(free)
min ,
max < g < g(syn)
max ,

dv
dt

= 



a(FS)(g, v, vℓ) = min
K (FS)(v, vℓ)(vℓ − v), amax

(cid:0)

,

A(FS)(V (FS)(g) − v) +

where a(free), a(syn), a(jam) are given by (29)–(33); g(syn)
the synchronized ﬂow. A function a(FS)(g, v, vℓ) in (B.3) is taken as follows

max is the maximum space gap in

where A(FS) = A(syn), K (FS) = K (syn); V (FS)(g) is chosen as a linear function between
(cid:1)
points (g(free)

max , v(syn)

min ) and (g(syn)

min , v(free)

max ):

V (FS)(g) = v(free)

min + (v(syn)

max − v(free)
min )

g(free)
min − g
min − g(syn)
g(free)

max

,

where v(syn)

max =

max − g(jam)
g(syn)
max

/T (syn)
av

.

(cid:0)

In the SA-model (B.3), steady states of free ﬂow (the curve F in Fig. 2 (f)) are
associated with the condition (35), averaged steady states of synchronized ﬂow are
related to a line S given by the condition
min )/T (syn)

min < ρ < ρ(jam)
min ,

q = (1 − ρ/ρ(jam)

at ρ(syn)

(B.6)

av

(cid:1)

min = 1/(g(syn)
where ρ(syn)
the condition (39) (Fig. 2 (f)).

max + d), and steady states for a wide moving jam are found from

In contrast with the other SA-models, the SA-model (B.3) has a limited density
range of steady states between steady states for free ﬂow and synchronized ﬂow, which
are found from the condition

a(FS) = 0

at g(syn)

max < g < g(free)
min

.

This condition yields the equation for the line F S with a negative slope in the ﬂow–
density plane (Fig. 2 (d))

q = q(free)

max + (q(syn)

max − q(free)
max )

ρ(free)
max − ρ
ρ(free)
max − ρ(syn)
min

max < ρ < ρ(syn)
min ,

at ρ(free)
min v(syn)

max = ρ(syn)

where q(syn)
max . The steady state model solutions (B.8) should be unstable
against inﬁnitesimal non-homogeneous perturbations that can be satisﬁed through an
appropriated choice of the value q(syn)
max . These solutions are used to simulate F→S and
S→F transitions in the SA-model (B.3).

(B.3)

(B.4)

(B.5)

(B.7)

(B.8)

Deterministic approach to microscopic three-phase traﬃc theory

36

[1] N.H. Gartner, C.J. Messer, A. Rathi (eds.). Special Report 165: Revised Monograph on Traﬃc

Flow Theory (Transportation Research Board, Washington, D.C. 1997)

[2] D.E. Wolf. Physica A 263, 438 (1999)
[3] D. Chowdhury, L. Santen, A. Schadschneider. Physics Reports 329, 199 (2000)
[4] D. Helbing. Rev. Mod. Phys. 73, 1067–1141 (2001)
[5] T. Nagatani. Rep. Prog. Phys. 65, 1331–1386 (2002)
[6] K. Nagel, P. Wagner, R. Woesler. Operation Res. 51, 681–716 (2003)
[7] B.S. Kerner. The Physics of Traﬃc (Springer, Berlin, New York 2004).
[8] J.-B. Lesort (editor). Transportation and Traﬃc Theory, Proceedings of the 13th International
Symposium on Transportation and Traﬃc Theory (Elsevier Science Ltd, Oxford 1996)
[9] A. Ceder (editor). Transportation and Traﬃc Theory, Proceedings of the 14th International
Symposium on Transportation and Traﬃc Theory (Elsevier Science Ltd, Oxford 1999)
[10] M.A.P. Taylor (editor). Transportation and Traﬃc Theory in the 21st Century, Proceedings
of the 15th International Symposium on Transportation and Traﬃc Theory (Elsevier Science
Ltd, Amsterdam 2002)

[11] D.E. Wolf, M. Schreckenberg, A. Bachem (editors). Traﬃc and Granular Flow, Proceedings of
the International Workshop on Traﬃc and Granular Flow, October 1995 (World Scientiﬁc,
Singapore 1995)

[12] M. Schreckenberg, D.E. Wolf (editors). Traﬃc and Granular Flow’ 97, Proceedings of the
International Workshop on Traﬃc and Granular Flow, October 1997 (Springer, Singapore
1998)

[13] D. Helbing, H.J. Herrmann, M. Schreckenberg, D.E. Wolf (editors). Traﬃc and Granular Flow’
99, Proceedings of the International Workshop on Traﬃc and Granular Flow, October 1999,
(Springer, Heidelberg 2000)

[14] M. Fukui, Y. Sugiyama, M. Schreckenberg, D.E. Wolf (editors). Traﬃc and Granular Flow’
01, Proceedings of the International Workshop on Traﬃc and Granular Flow, October 2001,
(Springer, Heidelberg 2003)

[15] S.P. Hoogendoorn, P.H.L. Bovy, M. Schreckenberg, D.E. Wolf (editors). Traﬃc and Granular
Flow’ 03, Proceedings of the International Workshop on Traﬃc and Granular Flow, October
2003, (Springer, Heidelberg 2004) (in press)

[16] R. Herman, E.W. Montroll, R.B. Potts, R.W. Rothery. Operations Res. 7, 86–106 (1959).
[17] D. C. Gazis, R. Herman, and R. W. Rothery, Operations Res. 9, 545–567 (1961).
[18] T. Nagatani and K. Nakanishi, Phys. Rev. E 57, 6415 (1998).
[19] I. Lubashevsky, P. Wagner, R. Mahnke, European Phys. J. B 32, 243–247 (2003).
[20] G.F. Newell, Operations Res. 9, 209 (1961).
[21] G.B. Whitham, Proc. R. Soc. London A 428, 49 (1990).
[22] M. Bando, K. Hasebe, A. Nakayama, A. Shibata, Y. Sugiyama, Jpn. J. Appl. Math. 11, 203

(1994); Phys. Rev. E 51, 1035–1042 (1995).

[23] M. Treiber, D. Helbing, e-print, cond-mat/9901239 (1999).
[24] M. Treiber, A. Hennecke, D. Helbing, Phys. Rev. E 62, 1805–1824 (2000).
[25] B.S. Kerner, P. Konh¨auser, M. Schilke, Phys. Rev. E 51, 6243–6246 (1995).
[26] D. Helbing, A. Hennecke, M. Treiber: Phys. Rev. Lett. 82, 4360 (1999)
[27] H.Y. Lee, H.-W. Lee, D. Kim: Phys. Rev. E 59, 5101 (1999)
[28] B. S. Kerner, Phys. Rev. Lett. 81, 3797 (1998).
[29] B. S. Kerner, Phys. Rev. E 65, 046138 (2002).
[30] L. Elefteriadou, R.P. Roess, W.R. McShane, Transportation Research Record 1484, 80–89

(1995).

[31] B.N. Persaud, S. Yagar, R. Brownlee: Transportation Research Record 1634, 64–69 (1998).
[32] M. Lorenz, L. Elefteriadou, Transportation Research Circular E-C018, 84–95 (2000).
[33] B.S. Kerner, S.L. Klenov: J. Phys. A: Math. Gen. 35, L31 (2002)
[34] B.S. Kerner, S.L. Klenov, D.E. Wolf, J. Phys. A: Math. Gen. 35 9971–10013 (2002).
[35] B.S. Kerner, S.L. Klenov, Phys. Rev. 68 036130 (2003)
[36] B.S. Kerner, S.L. Klenov, J. Phys. A: Math. Gen. 37 8753–8788 (2004).
[37] B.S. Kerner,

physics/0507094

S.L. Klenov,

H. Hiller.

E-print

(2005).

in

http://arxiv.org/abs/physics/0507094.

[38] L.C. Davis, Phys. Rev. E 69 016108 (2004).
[39] H.K. Lee, R. Barlovi´c, M. Schreckenberg, D. Kim, Phys. Rev. Let. 92, 238702 (2004).
[40] R. Jiang, Q.S. Wu, J. Phys. A: Math. Gen. 37, 8197–8213 (2004).
[41] P.G. Gipps, Trans. Res. B. 15, 105–111 (1981).
[42] B.S. Kerner, P. Konh¨auser. Phys. Rev. E 50, 54–83 (1994).

