5
0
0
2
 
g
u
A
 
2
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
7
7
0
8
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Application of Zhangs Square Root Law and
Herding to Financial Markets

Friedrich Wagner

Institut f¨ur Theoretische Physik, Universit¨at Kiel, Leibnizstrasse 15, D-24098 Kiel,
Germany, e-mail: wagner@theo-physik.uni-kiel.de

Abstract

We apply an asymmetric version of Kirman’s herding model to volatile ﬁnancial
markets. In the relation between returns and agent concentration we use the square
root law proposed by Zhang. This can be derived by extending the idea of a critical
mean ﬁeld theory suggested by Plerou et al. We show that this model is equivalent to
the so called 3/2-model of stochastic volatility. The description of the unconditional
distribution for the absolute returns is in good agreement with the DAX independent
whether one uses the square root or a conventional linear relation. Only the statistic
of extreme events prefers the former. The description of the autocorrelations are in
much better agreement for the square root law. The volatility clusters are described
by a scaling law for the distribution of returns conditional to the value at the
previous day in good agreement with the data.

Key words: Econophysics, Financial Market, Volatility, Stochastic Processes
PACS: 89.90.+n, 02.50.-r, 05.40.+j, 05.45.Tp

1 Introduction

Any model for the price or index of a ﬁnancial market should account for the
following so called stylized facts [1,2]. (i): The sign of the return cannot be
predicted. In most models this fact is build in by assuming the return pro-
portional to an iid noise. (ii): The probability for having an absolute return
larger than x decays for large x as a power law x−nT . The tail index nT seems
to be universal [3] in the range 3-4. A precise determination of nT for dayly
returns is hampered by the impossibility to reach the asymtotic regime in
the data. Therefore one should require a good description of all returns. (iii):
Returns are not independent. They form so called volatility cluster. A quan-
titative measure of this eﬀect may be the distribution of ﬁrst passage times
[4]. In this paper we use the distribution of the returns conditional to the

Preprint submitted to Elsevier Science

2 February 2008

value of the previous day. (iv): Absolute returns are correlated. In the case of
high frequency data a hyperbolic decay of the autocorrelation indicates a long
memory process. For dayly returns it behaves neither as a power law nor a
simple exponential expected from a Markov process.
To acchieve these properties one can distinguish two schools. The ﬁrst are the
stochastic volatility models. Here one assumes the return to be an iid noise
multiplied with a volatility factor √VT , where VT typically follows a Markov
process. Examples are the GARCH model [6] and its continuous time version
[7]. Other posibilities are the CIR-model [8] or the 3/2 model [9] discussed in ref
[10]. The multifractal model [11] implements fact (iv) by occurence of many
time scales. Any model for dayly returns faces the following diﬃculty. The
quality of data for dayly returns does not allow to estimate reliably more than
three parameters, for example a scale parameter given by the ﬁrst moment,
a combination of parameters describing the tail index and a rate constant for
the time dependence as in GARCH(1,1). Therefore the parsimonity princi-
ple invoked by Calvet and Fisher [11] is rather a must and not a freedom.
For stochastic volatility models a second diﬃculty arrises, that the choice of
the free parameters is dictated by mathematical convenience. Their relation
to market properties remains obscure. This diﬃculty is avoided in agent or
microscopic models (for a recent review see ref [12] and the references given
therein). The behaviour of the agents may be characterized by utility functions
[13]. The observed power law (fact (ii)) motivates the use of critical physical
models as the application of percolation by Cont-Bouchaud [14]. The perco-
lation cluster are interpreted as herding behaviour of the agents. In the Lux-
Marchesi model [15] a herding mechanism appears explicitly in the transition
probabilities between chartists and fundamentalistic traders. This leads to an
intermittent behaviour of agent numbers and thereby also for the returns. To
see whether herding alone can describe the stylized facts a symmetric Kirman
model [16] has been studied [17]. Quantitative agreement with the data could
be acchieved [18] within an asymmetric Kirman model. In the latter agents
diﬀer slightly from those in the Lux-Marchesi model that the two types of
chartists (optimists and pessimists) are replaced by one sort of agents (noise
traders). The diﬀerence between optimists and pessimists is described by an
iid random number. With this approximation the return behaves similar to a
stochastic volatility model, except √VT follows a Markov process instead of
VT . In this paper we apply the Kirman model with a further simpliﬁcation.
In empirical investigations it has been found [18,19] that fundamentalists are
much less aﬀected by herding than noise traders, which implicates a very
asymmetric herding model. In the limit of large asymmetry the number of
free parameters is reduced from three to two. In the spirit of parsimonity we
adopt this approach.
For an application to ﬁnancial markets an equation of state is needed relating
the return to ratios of agent numbers. In a Walrasian market [18] the volatil-
ity factor √VT depends linearely on the concentration of agents. The model
using the simpliﬁed Kirman model and this linear relation has been studied in

2

[19]. In this paper we adopt another equation of state. In contrast to a Wal-
rasian market the time for an agreement of the agents on a common return
ought to be ﬁnite. Assuming a random walk Zhang [20,21] concluded that Vt
itself should be proportional to the agent concentration. We use this approach
in the present paper. It oﬀers two desirable properties. Since in stochastic
volatility models Vt and in herding models the concentration proportional to
Vt follow simple Markov processes, one might be able to show the equivalence
of the latter with one of the stochastic volatility models. Secondly one can
use the empirical observation of Plerou et al [22], that the return and the
imbalanced volume satisfy the same relation as the order parameter and an
external ﬁeld in a critical mean ﬁeld theory. In the framework of a universal
Φ4 [23] there ought to be another equation for the return at zero ﬁeld. We
will show that Zhang’s law emerges within such a model naturally from risk
aversity. Whether the Walrasian linear relation or Zhang’s law are correct can
be decided at present only empirically. We will compare our model and the
results from ref [19] with the probability density function (hereafter abbrevi-
ated with pdf ) and the autocorrelation function with the empirical returns
derived from the DAX.
The paper is organized in the following way. In section 2 we describe our ver-
sion of the Kirman model and in section 3 a derivation of Zhang’s law. The
resulting unconditional pdf and the common pdf for two absolute returns at
diﬀerent times are given in section 4. The square root law together with a
Gaussian noise allows analytical calculation of various observables. As exam-
ples we treat the autocorrelation function and the pdf conditional on the value
of the previous day. These predictions we confront with the data in section 5.
In section 6 we make some concluding remarks.

2 Kirman’s Herding Model

We want to describe the changes of prices in a stock market with diﬀerent
agents which can change their strategy as function of time. Apart from the
speciﬁcation of an agent model a relation between the relative changes (return)
of the stock index and the agent numbers is needed which will be treated in
the next section. As herding model we use the Kirman model [16] discussed
by Alfarano et al [18]. It is deﬁned by the transition probability between two
types of behaviour. S denotes the mood of noise traders and F a conservative
or fundamentalistic strategy. The probabilities per unit time to change opinion
are given by

π(S
π(F

→
→

F ) = (a2 + b
S) = (a1 + b

nF )
nS)

.

·
·

3

(1)

The parameters a1,2 correspond to spontaneous changes of mind. The second
terms in equ (1) are proportional to the agent numbers nS,F in the new state
and therefore describe the herding eﬀect. Despite of the extensive character
of π this Markov process leads for a large number of agents to a non trivial
equilibrium distribution for intensive ratios as u
nF /(nS + nF ). As shown in
[18] the master equation belonging to (1) leads to a Fokker Planck equation
(hereafter abreviated by FPE) for the pdf w(u, t) and a Langevin equation
for u(t). In application of the model it turned out [18,19] that in most cases
a1 >> a2 holds. This means that fundmentalists are much less inﬂuenced by
herding than noise traders. Invoking the parsimonity principle we consider the
limit of large a1/b. For the ratio

∝

u =

a1
b ·

nF
nF + nS

it is shown in appendix A that one obtains the following FPE

∂w(u, t)
∂t

= b

∂
∂u "

u

β

1 +

−

−

∂
∂u

#

u

w(u, t)

,

with the parameter β = a2/b
1 describing the equilibrium pdf. This implies,
that the number of fundamentalists is much smaller than that of the noise
traders. If we transform the Langevin equation belonging to (3) to the variable
y = 1/u

−

∆y = b ∆t yt (1 + (1

β)yt) + (2b∆t y3

t )1/2ηt

,

−

we obtain a well known model of stochastic volatility, the so called 3/2 model
[9] provided we identify yt in the relation between the return rt and a Gaussian
noise ηt

rt =

ηt

Vt ·

q

with the volatility factor Vt. Equ (4) corresponds to a special version of the
3/2 model where drift and diﬀusion constants are related to ensure existence
of an equilibrium pdf for y. From Vt = ut follows another frequently used
model [8].
The limit of large a1/b aﬀects also the time scales. As shown in the appendix
the process (1) should be applied to micro time steps ∆tm, whereas the variable
u changes with the observed time scale ∆t. Both are related by ∆t = a1∆tm/b.
Eliminating a1/b with (2) we get

(2)

(3)

(4)

(5)

(6)

nF
nF + nS

= u

∆tm
∆t

·

,

4

which shows an explicit dependency of the agent ratio on the time resolution
∆t.
As shown in [9] the FPE can be solved analytically for the equilibrium pdf
w0(u)

w0(u) =

uβ
Γ(β + 1)

exp(

u)

−

and for the conditional pdf w(u, t + t0|

¯u, t0) = A(u

¯u, exp(

bt)) with

|

A(u

¯u, z) = w0(u)

|

(u¯uz)−β/2

1

z

−

exp

z(u + ¯u)

 −

1

z !

−

Iβ

 

−
2√u¯uz
1

−

z !

.

(8)

Iβ denotes the Bessel function with imaginary argument. The kernel A has
the following convolution property

d¯uA(u

¯u, z)A(¯u

u′, z′) = A(u

u′, z

z′)

|

|

|

·

Z

and can be used for the time evolution of w(u, t + t0)

w(u, t + t0) =

d¯uA(u

¯u, exp(

bt))w(¯u, t0)

.

Z

|

−

3 Derivation of Zhang’s Law

The problem of this section deals with relation of agent ratio to the observable
return rt. The small decay time in the autocorrelation of the returns suggests
that the dynamic of the price is much faster than the change of agent numbers.
The extreme case of an instantaneous Walrasian market has been assumed in
ref [18] to model the behaviour of agents in the Lux-Marchesi model[15]. With
the additional assumption that the change between optimistic and pessimistic
noise traders occurs also on a fast time scale one gets [18] a linear relation
between the return and the agent ratio nS/nF . Using u for small values of nF
one gets

rt = ∆ ln St = r0 ·

1
ut ·

ηt

The noise ηt incorporates many changes during ∆t due to the noise traders.
In this Walrasian approach the price change is set instantaneously, a closed
order book is assumed and the agents have to accept any new return irre-
spectively of their risk aversity. Considering for example the XETRA market

5

(7)

(9)

(10)

(11)

(12)

(13)

these assumptions seem to be questionable. Removing the ﬁrst assumption
Zhang [20] assumed the time needed to get the new price is proportional to
the demand, which is linear in the agent numbers. Describing the evolution of
the price by a random walk the return will be proportional to the square root
of the agent numbers. Therefore the linear relation (11) should be replaced by
the so called sqare root law given by

rt = r0 ·

1
√ut ·

ηt

It has been applied [21] in context of the percolation model of Cont-Bouchaud
[14] in order to obtain a tail index larger than 2. Equ (12) agrees with the
return obtained in the 3/2 stochastic model. Therefore the parameters of the
latter can be related to the behaviour of agents.
To obtain a less qualitative derivation of (12) and to include the eﬀect of risk
aversity and an unbalanced order book we start with an observation made by
Plerou et al [22], who showed empirically that the absolute return v increases
with the imbalanced volume Ω at small time intervalls ∆t and small Ω as

vt =

rt| ∝

|

Ω1/δ
t

±

with an exponent δ = 2.9
0.3. At large ∆t and Ω the return saturates as
v = B0 tanh(B1Ω). As suggested already in ref [22] this could be interpreted
as an equation of state in a critical mean ﬁeld theory if v corresponds to a
scalar order parameter and Ω to an external ﬁeld. As dynamical ﬁelds in such
a theory we use the return Φk,i expected by agent i of type k = F, S. After
time ∆t equilibrium is reached at a common return r = E[Φk,i]. A critical
mean ﬁeld theory with a scalar order parameter is described by the universal
Φ4 model [23]. This is deﬁned by the following cost or energy functional

S(Φ) = Sint(∆Φ) +

Xk=S,F Xi "

βk
4

Φ4

k,i −

αk
2

Φ2

k,i −

ΩΦk,i

.

#

(14)

The ﬁrst term Sint is a positive deﬁnite quadratic form in the diﬀerences
Φj,l describing the interaction between the agents. We assume
∆Φik,jl = Φk,i −
it strong enough that in equilibrium the mean ﬁeld value for Φi,k is independent
of i, k. This means the agents reach a common value v for their expected
absolute return. We normalize Sint by Sint(0) = 0. The Φ4 terms lead to large
cost functions for large Φ. They account for the risk aversity of the agents.
We expect that noise traders are much less aﬀected by risk aversity than
fundamentalists and can set βS to zero. Since the disordered phase E[Φ] = 0
is not observed, the coeﬃcients αk in the quadratic term in (14) must be
positive. A negative contribution to the cost function of the noise traders can

6

be interpreted as ’happy loser’ eﬀect [20], that fundamentalists are willing to
accept a loss of money restricted by their risk aversity. The analogous term
for the fundamentalists can be neglected by setting αF = 0. The last term
in (14) corresponds to the coupling of the return to an imbalanced volume.
If this coupling is independent of k the coeﬃcient can be set without loss of
generality to 1. In the limit of large agent numbers the model is solved by a
constant Φk,i = v with negligeable variance. The value of v is given by the
minimum of (14). With the above discussed approximations S reads

S(v) =

nF v4

βF
4

αS
2

−

nS v2

−

Ωv(nS + nF )

.

Introducing the parameter Ω0 by

Ω0 =

(nSαS)3
(nS + nF )2βF nF #

"

1/2

the value of v making S(v) to a minimum satiﬁes the following mean ﬁeld
equation

nSαS
(nS + nF )Ω0

 

v

!

nSαS
(nS + nF )Ω0

v

−

Ω
Ω0

−

= 0

3

The solution of (17) can be written as

v
Ω0

=

nS + nF
αSnS

f

·

Ω
Ω0 (cid:19)

(cid:18)

Equ (18) expresses the scaling property of the critical theory. Ω, Ω0 and v
may be rescaled by the same factor without altering the results. The scaling
function f does not depend on any parameter. Its behaviour near x
0 and
x

is given by

∼

→ ∞

f (x) = 


2x +

1 + 1
· · ·
(x)1/3(1 + (x)−2/3 +

for x

for x

1

1

≪

≫

)
· · ·



If only the leading terms are kept, for historical reasons the ﬁrst form is called
the zero ﬁeld equation of state and the second the critical isotherm. The latter
written in v reads as

v3 =

nS + nF
βF nF

·

Ω ,

7

(15)

(16)

(17)

(18)

(19)

(20)

v =

αS
βF ·

nS
nF

s

,

1/2

Ω0 ∝ (cid:18)

∆t
u (cid:19)

.

(∆t)1/2

.

r0 ∝

where we recover (13) for Ω
state

≫

Ω0. For Ω

Ω0 we get another equation of

≪

which reproduces the square root law of Zhang. The size of Ω0 depends on
the time resolution ∆t, if we use the Kirman model of the previous section.
Inserting equ (6) for the agent ratios we get

Therefore the empirical relation (13) should hold only at small time scales in
agreement with the data [22]. For large time scales the Zhang’s law ought to
be applied. In addition we have the prediction, that the rate factor r0 in (12)
should vary with ∆t as

This power law is in nice agreement with the observed [30] power of 0.51.
There are still two problems within our derivation of the square root law. The
application of a critical theory is conﬁned to small values of the ﬁelds. At ﬁnite
values the scaling law (18) may no longer valid. Secondly the return does not
saturate as required by the data, but will increase as (20) for large Ω. There
exist of course many models which have the same small ﬁeld expansion as (14).
Even if we restrict ourselves to a minimal model of Ising spins which has been
used in ref [22] to describe the saturation there will be an extra parameter
for the distance from the scaling law (18). As shown in appendix B for a spin
model the mean ﬁeld equation (17) should be replaced by

nSαS v
(nS + nF )Ω0

=

3
y2)y ·

tanh

nSαS vy
(nS + nF )Ω0

 

+

y3
3 ·

Ω
Ω0 !

(24)

(3

−

with a parameter y describing the deviation from the critical region. For y
0
we recover the critical mean ﬁeld equation. Finite y may be adjusted to the
observed saturation of the return with the unbalanced volume Ω. Therefore
the critical isotherm (20) is very model dependent. On the other side the zero
Ω0 is almost unchanged. In the case of (24) we obtain
ﬁeld equation for Ω

→

≪

v = a(y)

αS
βF ·

nS
nF

· s

8

(21)

(22)

(23)

(25)

with a y-dependent constant a(y) which is the non zero solution of

a

y =

·

3

y2 ·

3

−

tanh(a

y)

.

·

(26)

Since this constant can be absorbed into the rate constant r0, the square root
law appears to be robust against deviation from criticality. In appendix B we
also replaced the Ising spin model by a compact model, which leads to the
same conclusions.
At present stage of research only empirical observations can decide on the
possibilities (12) or (11). In the present paper we want to discuss whether
there are advantages of the square root law (12) over the linear relation (11).

4 Unconditional probability and 2-point function

Suppose one observes a time serie of the absolute returns Ht = [v1,
, vt]. We
assume the time t to be an integer by absorbing the time step ∆t in the rate
factor b. Only the combined process [Ht, Ut] with the history Ut = [u0,
, ut]
of the herding variables is a Markov process. This property is expressed by
the following recursion formula for the pdf f (H, U)

· · ·

· · ·

f (Ht, Ut) = g(vt|

ut)

A(ut|

·

ut−1, e−b)

·

f (Ht−1, Ut−1)

.

(27)

Assuming the sqare root law (12) with a Gaussian noise the conditional dis-
tribution g is given by

g(v

u) = N0√u

exp(

|

·

v2u
2r2
0

)

−

(28)

2/πr2

q

with the normalization constant N0 =
0. To calculate the pdf for the
absolute returns Ht the solution of the recursion (27) has to be integrated over
all u variables. The sqare root law leads to an exponential dependence of g as
function of u, which matches with the exponentials in A allowing analytical
calculations. In principal the recursion (27) can be used to compute f (Ht).
The singularity of A for exp(
1 presents a problem, if one encounters a
small value of the rate b. For the determination of the parameters β, r0 and b
two simpler cases are suﬃcient and we defer an approximative solution of the
recursion (27) to a future publication [24].
The common pdf f (vt+t0, vt) for the absolute returns at t0 and t + t0 is ob-
tained from the t times iterated recursion (27) by integrating over Ut and all

b)

−

∼

9

vt−1+t0. The latter integration eliminates the correspond-
intermediate vt+1 · · ·
ing g-factors and we can use the convolution property (9) of A to perform the
intermediate u integration leading to

f (vt+t0, vt0) =

u)A(u

du dut0g(vt+t0|
dHt0−1dUt0−1f (Ht0, Ut0)

|

.

ut0, e−bt)

Z

Z

For large t the operator A converges to the equilibrium distribution w0(u)
independent of ut0. Therefore f (vt+t0, vt0) factorizes in the limit of large t as

f (vt+t0, vt0) = G0(vt+t0)

f (vt0)

·

with the equilibrium pdf

G0(v) =

du g(v

u) w0(u) = N0

Z

|

Γ(β + 3/2)
Γ(β + 1)  

1 +

v2
2r2

0 !

−β−3/2

This Pareto like distribution becomes at large v a power law v−nT −1 with a
tail index nT determined by the herding parameter

From equ (31) all equilibrium moments may be calculated ( see equ (D.2) in
the appendix). For example the second moment

(29)

(30)

(31)

(32)

(33)

nT = 2β + 2 .

E0[v2] =

r2
0
β

will be used for expressing r0 in terms of β and the observable second moment
in equilibrium 1 .
To derive an explicit form of the two point function f (vt+t0, vt0) we take in
equ (29) large t0 with ﬁnite t. Analogue to the previous case the distribution
factorizes and we obtain

f (vt+t0, vt0) =

Z

dudu′g(vt+t0|

u)A(u

u′, e−bt) g(vt0|

|

u′)w0(u′)

.

(34)

The integrations in (34) can be carried out and f (vt+t0, vt0) is expressed in
terms of hypergeometric functions. The exact form is given in appendix C. An
interesting property of f is that it depends only on a combination ζ(vt+t0, vt0)

1 Expectation values taken with the equilibrium pdf (31) will be denoted by E0[ . ]

10

but not each of the variables vt0 and vt+t0 separately. Such a behaviour implies
scaling laws. We demonstrate this scaling law in the simple case of t = 1
and neglected terms of order b. As shown in appendix C the conditional pdf
f (vt+1|

vt) is given by

f (vt+1|

vt) =

s

2
0 + v2
π(2r2

t ) ·

Γ(β + 2)
Γ(β + 3/2)  

1 +

v2
t+1
0 + v2
2r2

t !

−β−2

.

(35)

If we eliminate r0 with equ (33) and introduce the scaling variable xt+1 by

xt+1 =

vt+1
2βE0[v2] + v2
t

,

q

we get

f (xt+1|

vt) =

2
√π ·

Γ(β + 2)
Γ(β + 3/2)

−β−2

.

1 + x2
(cid:16)

t+1

(cid:17)

The conditional distribution of xt+1 is independent of the previous return vt.
From this we can determine β, since only at the true β the data for xt+1 with
diﬀerent vt will collapse into a single scaling function f (xt+1). This function
can be compared with the predicted curve (37).
Knowing the two point function the autocorrelation of vq can be derived (see
appendix D ). The ratio

R =

E[vq
t+t0vq
t0]
E2
0[vq]

= F (q/2, q/2; β + 1; e−bt)

involves again a hypergeometric function. For negative values of α = q
the variance of vq exists and we ﬁnd the autocorrelation function C(t)

−

β

1

−

Cq(t) =

E2
0[vq]
var[vq] ·

(cid:16)

F (q/2, q/2; β + 1; e−bt)

.

1

−

(cid:17)

If we expand for large t the hypergeometric function we ﬁnd with the leading
term an exponentially decay

Cq(t) =

q2
4(β + 1) ·

e−bt

.

For small b and ﬁnite t the deviation from the exponential dependence (40)
and the exact expression (39) may be substantial. It is interesting to note that

11

(36)

(37)

(38)

(39)

(40)

Intervall

1/1973-10/1978

11/1978-8/1984

9/1984-7/1990

8/1990-3/1996

4/1996-2/2002

β

4.3

3.3

0.98

1.04

1.86

∆β

1.4

1.0

0.12

0.15

0.35

χ2/point

9/19

31/18

39/25

41/22

21/30

1/1973-2/2002

1.115

0.068

44/43

Table 1
β values and their statistical errors obtained by a ﬁt in four diﬀerent time intervalls.
The last row gives the ﬁt using all data. Column 3 gives the χ2 value per data point.

for α > 0 the ratio R becomes singular at t = 0. Applying Eulers relation to
the hypergeometric function one observes for the ratio

R =

Γ(β + 1)Γ(α)
Γ(q/2)2

·

−α

(bt)

(41)

a power law in t. This does not mean a long memory since neither the variance
exists nor it consists in a large t eﬀect. The example given by Lillo et al.[28]
shows that Markov processes may lead to power law in t also with existing
variance.

5 Empirical Comparison with the DAX

In this section we want to estimate the parameters of the model described
in the previous section from a time serie of absolute returns of the DAX[25]
during 1973-2002. The most eﬃcient method would be using a maximum like-
lihood ﬁt. The bad analytical properties of A make this task prohibitive unless
b is large. As less eﬃcient but tractable method to estimate β and r0 is to use
χ2 ﬁts to the unconditional pdf given in equ (31). In presence of correlations
the sample of length T can be still considered as a representative subset of an
inﬁnite time serie if bT >> 1 holds. A small rate parameter b may cause a
problem. To see this we divide the data in 5 subsamples of similar statistics.
Here and in all subsequent estimates we ﬁx r0 by equ(33) in terms of β and
E0[v2]. We checked that in each case a free variation of r0 did not alter the
results. The estimates of β in each sample are given in table 1. They behave
rather erratic and χ2 probability is rather low indicating a poor descripition
of the data. This eﬀect is due to the volatility clusters which are by no means
equally distributed over the subsamples. Taking all data one obtains a good

12

χ2 value and the following value of β

β = 1.115

0.068 .

±

(42)

In ﬁgure 1 we compare the pdf from equ (31) with the empirical data. The
agreement is excellent with a χ2-probability of 60%. The values in the sub-
samples agree with (42) within two standard deviations. The value (42) cor-
responds to a tail index of nT ∼
4 which is slightly larger than the the values
obtained in other ﬁnancial markets [3,26]. As we discuss lateron this may be
an eﬀect of not having reached the asymtotic regime in the data.
We can compare our model with a model discussed by Alfarano [19] where

Fig. 1. The pdf from equ (31) for equilibrium (solid line) as function of the absolute
return compared with the DAX from 1973-2002. The dashed line gives the result of
the linear relation.

the same herding mechanism is used but the sqare root law replaced by the
linear relation (11). The ﬁt is worse ( χ2-probability
1% ), but in view of
possible systematic errors still acceptable. The diﬀerence stems mainly from
the better description of low returns in our model. On a log scale the ﬁt in
the linear model ( dashed line in ﬁgure 1 ) can hardly be distinguished from
our model, although the tail index nT ∼
6 is 50% larger than in our case. A
χ2- or maximum likelihood ﬁt is dominated by the many events with low v.

∼

13

1985-2002

1973-2002

x Nsqrt Nlin Nobs Nsqrt Nlin Nobs

5

6

7

9

11

15

8.1

3.9

2.1

0.8

0.3

7.6

3.4

1.6

0.5

0.2

0.09

0.03

11

13.8

13.0

24

6

3

1

0

0

6.6

3.6

1.3

0.6

0.2

5.7

2.8

0.8

0.3

0.06

9

6

1

1

0

Table 2
Predicted number of events with normalized absolute return larger than x (column
1) for the square root law (column 2 and 5) and the linear law (column 3 and 6) for
two time intervalls. The observed number from DAX is given in column 4 and 7.

q

∼

To judge the description of extreme events we compare the predicted events
E0[v2] in both models with the observed number of events. Since
with v > x
the largest return in ﬁgure 1 correponds to x
6 the ﬁts may not be sensible
to extreme events with larger x. The values for x
5 are given in table 2.
Despite of the large diﬀerence in the tail index both models agree with the
observation reasonably well with a preference for the square root law. Large
diﬀerences occur only outside the observable region (x > 15). We also learn
that there is no need for an extra mechanism for crash events as proposed in
[27].
Both models can be distinguished if we consider the time dependence. The
parameter b can be estimated from the common pdf for pairs [vt+t0, vt] given in
equ(C.5) of the appendix. We perform maximum likelihood ﬁts by adding the
log likelihoods for all pairs with a time lag t0i = [1, 2, 5, 10, 20]. Maximizing

≥

i,t log f (vt+t0i, vt) with respect to b and β we obtain

P

β = 1.083

0.020

b = 0.0075

0.0015 .

±

±

(43)

(44)

The value of β is compatibel with the estimate (42) from the equlibrium pdf.
The estimate (44) for b implies a large decay time tD = 1/b
133[day] in the
order of 1/2 year. In the linear model only the autocorrelation function can
be computed. This model cannot describe the data over large range of time
lags. Adjusting b to describe the autocorrelation for small time lags a value
b
1/37[day]−1 is obtained [19]. In ﬁgure 2 we compare the autocorrelation
function given in (39) (solid line) of our model with the values from DAX. The
agreement is good. The leading asymtotic term (40) (dashed line) shows that
the data cannot be described by an exponential behaviour. The prediction of
[19] (dotted line) should be valid only for small time lags. Therefore the data

∼

∼

14

Fig. 2. Correlation function for DAX. Solid line gives the prediction of equ (39), the
dashed line the asymtotic term (40) and the dotted line the prediction of the linear
relation.
for the autocorrelation prefer the square root law.

Finally we test the scaling prediction, that the conditional pdf f (vt+1|
independent of vt if one uses the scaling variable

vt) is

The assumption of small b is very well satisﬁed with (44). In ﬁgure 3 we show
the distribution of x obtained in four intervalls of the normalized absolute
return

xt+1 =

vt+1
2βE0[v2] + v2
t

.

q

yt =

vt
E0[v2]

q

(45)

(46)

1.1 the data collapse into a single curve.
at β = 0.4, 0.7, 1.11, 3.0. For a β
This curve agrees with the predicted scaling function (37) (solid line). From
this agreement we conclude that the model describes the correlation between

∼

15

≤

0.35 ( 0.35

Fig. 3. Conditional pdf for the scaling variable xt+1 deﬁned in (45) for various β
and vt intervalls. The solid line for β = 1.11 gives the prediction 37. The intervalls
of the normalized return y from equ 46 are denoted by stars (diamonds, triangles,
squares) for y

≤
vt and vt+1 well, which is not obvious from the autocorrelation due to the
large ﬂuctuation near t = 0 seen in ﬁgure 2. A best ﬁt to the scaling curve
(37) leads to β = 1.1
0.2 which agrees with the previous estimations in (42)
and (43). It is very remarkable that three very diﬀerent methods to determine
β lead to the same value.

0.9, 0.9

1.5, y

1.5 ).

±

≥

≤

≤

≤

y

y

6 Conclusions

The herding model of Kirman has been considered in the limit that funda-
mentalists are much less aﬀected by herding than noise traders. As a con-
sequence the market consists of many noise traders and few fundamentalists
reﬂecting the conditions in a real market. Volatility cluster occur if the funda-
mentalists dissapear from the market. This is in contradiction to the results of
the Lux-Marchesi model, where fundamentalists dominate and volatility clus-
ters appear if chartists rise beyond 30%. Augmenting the herding model with
Zhang’s square root law between price changes and agent ratios the model

16

turns out to equivalent to the 3/2 model of statistical volatility. This coinci-
dence allows an interpretation of the parameters in the latter model in terms
of agent behaviour. Due to the simplicity of our model various observables
can be calculated analytically. This is important in χ2 or maximum likelihood
estimations, where numerically accurate and computationally easy accessible
expressions are required.
Comparing our model with empirical data we ﬁnd good agreement with the
stylized facts derived from the DAX. The tail index of 4 is in harmony with
universality. Replacing the square root law by a linear relation one gets a
worse but still acceptable value of χ2, however the tail index increases to 6.
This shows that the index depends strongly whether one uses a Pareto law in
the squared return v2 (as in our model) or in v. Universality of the tail index
and the behaviour of extreme events favor the square root law. The autocor-
relation of the absolute return will decay exponentially at large time lags. The
very small rate constant b ensures that this asymtotic behaviour is reached
outside the region of timelags where the data can be trusted. The reasonable
agreement of the autocorrelation function of our model with the data is much
better than in the linear model. A quantitave measure of the volatility cluster
is expressed by a new scaling law for the pdf conditional on the value of the
previous day, which is again in good agreement with the data.
The predictions based on a recursive solution of the combined Markov process
of return and agent ratios will be presented in a future publication.
Acknowlegments: The author thanks Thomas Lux and Simone Alfarano for
stimulating discussions and valuable hints.

A Asymmetric Kirman Model

In this section we give the changes of the formulae of [18] in the case if one of
the parameters describing the spontaneous change of oppinion becomes large.
As pointed out in [18] the macroscopic time scale ∆t during the returns are
observed does not need to coincide with the microscopic time scale ∆tm over
which the agents change oppinion. On the latter scale we have the FPE for
z = nS/(nS + nF ) derived in [18] from the transition probabilities (1)

∆w(z, t)
∆tm

=

∂
∂z "

za2 −

(1

−

∂
∂z

−

#

z)a1 +

bz(1

z)

w(z, t)

.

(A.1)

For large a1 z will be close to 1. Therefore we introduce the variable u by

u =

(1

z) =

a1
b

−

a1
b

nF
nS + nF

(A.2)

17

which remains ﬁnite. Transforming (A.1) into u and neglecting terms of the
order b/a1 we ﬁnd

∆w(u, t)
∆tm

= a1 ·

Duw(u, t)

with the diﬀerential operator

Du =

∂
∂u "

u

−

a2
b

+

∂
∂u

u

#

.

∆t =

∆tm .

a1
b ·

nF
nS + nF

=

∆tm
∆t

u

Inserting (A.5) into equ. (A.3) leads to

∆w(u, t)
∆t

= b

Duw(u, t)

·

The real time scale ∆t (f.e. days) is related to ∆tm by

The limit of large a1 leads to small average values of the number of fundamen-
talists. By the identiﬁcation (A.5) the agent ratio can be expressed in terms
of the time scale

which is equivalent to equ. (7) replacing ∆w(u, t)/∆t by ∂w(u, t)/∂t and a2/b
by β + 1. The FPE (3) ( see [9] ) can be solved by expanding w(u, t) in terms
of Laguerre polynomials Lβ

n(u):

w(u, t) =

cn(t)Lβ

n(u)w0(u)

∞

Xn=0

with the equilibrium pdf w0(u) from equ. (7). The functions Lβ
right eigen functions of Du

n(u)

w0(u) are

·

Du ·

Lβ

n(u)w0(u) =

Lβ

n(u)w0(u)

.

n

−

·

The conditional pdf A(u
¯u, z) follows from the generating function of the La-
guerre polynomials (see [29] ). The convolution property (9) is proven by the
orthogonality of Lβ
n

|

E0[Lβ

n(u)Lβ

n′(u)] = δn,n′

(A.10)

18

(A.3)

(A.4)

(A.5)

(A.6)

(A.7)

(A.8)

(A.9)

with E0[.] the expectation value with respect to w0.

B Models Outside the Critical Region

A general class of models can be characterized by the following cost functional

S(Φ) =

g + g0
Nσ2
0

−

ΦiΦj −

µ0Ω
σ0

Xi<j

Xi

Φi

.

The minimum coupling g0 ensures that the system is never in the disordered
state. σ0 and µ0 set the scales for Φ and Ω. A suitable dynamic (Langevin
equation, heat bath or Metropolis algorithm) will bring the system into equi-
librium, which is a Boltzmann distribution. Expectation values are given by
derivatives of the partition sum Z:

Z =

dµ(Φi) exp(

S(Φ)

.

−

Yi Z

For the measure dµ(Φ) we can use either a spin or a compact model. µ reads
in these cases

dµ(Φ) = 


Z

1
2

Φ=±σ0

1
P
2σ0

dΦ

for

for

for the Ising model

for the compact model



R

The expectation value of the return is given by

v = E

1
N

"

Φi

=

#

σ0
Nµ0

∂ ln Z
∂Ω

Xi

To evaluate Z we use the Gaus trick for large agent number N:

(B.1)

(B.2)

(B.3)

(B.4)

exp(

g + g0
Nσ2
0

ΦiΦj) =

N
2π(g + g0) ·

s

Xi<j

dω exp

Z

Nω2
2(g + g0)

 −

+

ω
σ0

Φi

!

X

(B.5)

Inserting equ (B.5) into Z the integration over Φi can be carried out with the
result

19

Z =

N
2π(g + g0) ·

s

dω exp

N

 −

2(g + g0) −

"

ln C(ω + µ0Ω)

.

#!

Z

ω2

For the spin model we set g0 = 1 and C is given by

whereas in the compact model we use g0 = 3 and the function C as

C(x) = cosh(x)

,

C(x) =

tanh(x)

.

1
x ·

In the large N-limit Z is given by the maximum of the integrand at ω0. For
the spin model we get

ω0 = (g + 1) tanh(ω0 + µ0Ω)

.

Replacing ω0 by the expectation value v = E[Φi] = ω0σ0/(g + 1) we ﬁnd the
equation of state

v = σ0 tanh

(g + 1)

+ µ0Ω

(cid:18)

(cid:19)

v
σ0

To get the relation with the parameters of the critical model discussed in
section 3 we expand equ (B.10) around small g and µ0

3

1
3µ0 (cid:18)

g + 1
σ0 (cid:19)

v3

·

−

g
σ0µ0 ·

v

−

Ω = 0

Comparing coeﬃcients with the equation of state (18) we get two equations
for the three parameters g, σ0 and µ0. For example the scale parameter µ0 for
Ω can be chosen arbitrarily. Measuring µ0 in units of Ω0 we set

and express g and σ0 in terms of the previous parameters Ω0 and αS

µ0 =

1
(6g0 −

y3

3)Ω0 ·

g =

and σ0 =

y2

y2

3

−

Ω0
αS

y(3

y2)

3

−

20

(B.6)

(B.7)

(B.8)

(B.9)

(B.10)

(B.11)

(B.12)

(B.13)

(B.14)

(B.15)

(B.16)

(C.1)

Inserting these parameters into equ (B.10) we obtain the equation of state
valid also outside the critical region

αS
Ω0 ·

v =

3
y2)y ·

(3

−

tanh (ξ)

with

ξ =

v +

αS
Ω0 ·

y3
6g0 −

Ω
Ω0

3 ·

The parameter y with 0 < y < √3 describes the distance from the critical
behaviour obtained for y
0. The saturation of the return as function of Ω
determines the value of y. The exact form is model dependent. The analogous
calculation for the compact model leads instead of (B.14) to

→

αS
Ω0 ·

v =

(15

y2)y ·  

coth(ξ)

1
ξ !

−

45

−

It has the same behaviour for y
0, but extrapolates hyperbolically for small
1/Ω to a constant instead of the exponential behaviour obtained from (B.14).

→

C Two Point Function of the Probability Density

From the expansion of the Bessel function in (8) we obtain the following
bt)
representation for A with z = exp(

A(u

u′, z) =

|

uβ
z)β+1 exp
uu′z

(1
∞

−

(1

Xm=0  

−

z)2 !

zu′
1

z ! ·

1
 −
m 1
m!

−

z −
1
(β + m)!

.

Inserting (C.1) and the noise distribution (28) into equ(34) we obtain after
integration over u and u′

f (vt+t0, vt0) =

N 2
0
β!

z)β+2

(1

−

∞

((β + m + 1/2)!)2
m!(β + m)!

zm

·

(1 + (1
"

−

z)

Xm=0
v2
t+t0
2r2
0

)

·

(1 + (1

z)

−

v2
t0
2r2
0

)

#

−(β+m+3/2)

.

(C.2)

−

u

−

21

The sum corresponds to the serie expansion of the hypergeometric function

F (a, b; c; x) =

∞

Xm=0

(a + m
(a

−
1)!

1)!

−

(b + m
(b

−

1)!

−
1)!

(c
−
(c + m

1)!

−

1)!

xm
m!

.

(C.3)

At special arguments F (a, b; c; 0) = 1 and F (a, b; c + 1; 1) = c!(c
a)!(c

b)!) holds. Using the scaling variable

a

b)!/((c

−

−

−

−

ζ =

1
2r2

0  

t+t0 + v2
v2

t0 + (1

z)

−

t+t0v2
v2
t0
2r2

0 !

(C.4)

we get

f (vt+t0, vt0) =

2

N0(β + 1/2)!
β!

−
−
β + 3/2, β + 3/2; β + 1;

(1
(1 + (1

!

 

F

z)β+2
z)ζ)β+3/2 ·

z
(1 + (1

 

.

(C.5)

z)ζ) !

−

With Euler’s relation F (a, b; c; x) = (1
can be rewritten as

−

x)c−a−bF (c

a, c

b; c; x) equ(C.5)

−

−

f (vt+t0, vt0) =

N0(β + 1/2)!
β!

2

q

!

z)ζ

1 + (1
(1 + ζ)β+2

−

·

 

F

1/2,

1/2; β + 1;

 −

−

z
(1 + (1

z)ζ) !

−

.

(C.6)

If terms of order 1
variable x2

−

z are negligeable and t = 1 ζ agrees with the scaling

t+1 from equ (36). Setting in F the argument to 1 leads to

f (vt+1, vt) =

2(β + 1)
πr2
0

1 + x2
(cid:16)

t+1

(cid:17)

−β−2

.

This equation is equivalent to (35) if we use

f (xt+1|

vt) =

dvt+1
dxt+1

f (vt+1, vt)
G0(vt)

with the equilibrium pdf (31) for vt.

22

(C.7)

(C.8)

D Autocorrelation

The easiest way to derive E[vq
integrations using

t+t0 ·

vq
t0] is to perform in equ(34) ﬁrst the v

∞

Z0

g(v

u) vq dv = E0[vq]

|

β!
q/2)!

u−q/2

(β

−

with the equilibrium moments

E0[vq] =

2q
π

s

rq
0 ·

(β

−

q/2)!((q
β!

−

1)/2)!

.

Inserting as in the previous section the expansion (C.1) and performing the
integrations over u and u′ we obtain for the ratio

R =

E[vq

t+t0 vq
t0]
E0[vq]2

= (1

e−bt)β+1−q

−

∞

·

Xm=0  

(β + m
(β

q/2)!
−
q/2)! !

2

β!

e−btm
m!(β + m)!

·

·

−

(D.3)

Again the sum is a hypergeometric function leading to

R = (1

e−bt)β+1−q

F

β + 1

q/2, β + 1

q/2; β + 1; e−bt

(D.4)

−

·

(cid:16)

−

−

(cid:17)

With the help of Euler’s relation we get ﬁnally

R = F

q/2, q/2; β + 1; e−bt
(cid:16)

(cid:17)

.

For large bt expansion of F up to linear terms leads to

R = 1 +

q2
4(β + 1) ·

e−bt

.

0 and β + 1

q < 0 the expectation value R becomes singular.
For bt
Replacing in equ(D.4) the function F by its value at argument 1 we ﬁnd the
power law given in equ (41)

→

−

23

(D.1)

(D.2)

(D.5)

(D.6)

References

[1] C. G. de Vries The handbook of International Macroeconomics, Blackwell,

Oxford 1994, p. 348.

[2] A. Pagan Journal of Empirical Finance 3 (1996) 15

[3] T. Lux and M. Ausloos in A. Bunde et al.(ed.) Theory of Desaster, Berlin 2002,

p.373

[4] F. Wagner Physica A 322 (2003) 607

[5] Y. Liu, P. Gopikrishnan, P. Cizeau, M. Meyer, C. K. Peng and H. E. Stanley

Phys.Rev E 60 (1999) 1390
P. Gopikrishnan, V. Plerou,L. A. Nunes Amaral, M. Meyer and H. E. Stanley
Phys.Rev E 60 (1999) 5305

[6] R. F. Engle and T. Bollerslev Econometric Reviews 5 (1986) 1

[7] D. B. Nelson Journ. of Econometrics 45 (1990) 7

[8] J. C. Cox, J. e. Ingersoll and S. A. Ross Econometrica 53 (1985) 385

[9] D. Ahn and B. Gao Rev.Fin.Studies 12 (1999) 721

[10] A.

l. Lewis Option Valuation under Stochastic Volatility, Finance Press,

Newportbeach 2000

[11] L. Calvet and A. Fisher Review of Economics & Statistics 84 (2002) 381

[12] E. Samanidou, E. Zschischang, D. Stauﬀer and T. Lux in F. Schweitzer
(ed.)Microscopic models for Economic Dynamics, Lecture notes in Physics,
Springer, Berlin 2002.

[13] G. Kim and H.M. Markowitz Journ. Portfolio Management 16 (1989) 45

M. Levy, H. Levy and S. Solomon Journal de Physique I 5 (1995) 1087 and
Physica A 242 (1997) 90
S. Solomon and R. Richmond, Physica A 299 (2001) 188 O. Biham, Z. F.
Huang, O. Malcai and S. Solomon Phys. Rev. E 64 (2001) 101

[14] R. Cont and J. P. Bouchaud Macroeconomic Dynamics 4 (2000) 170

[15] T. Lux and M. Marchesi Nature 397 (1999) 397 and Int. Journ. Theor. Appl.

Finance 3 (2000) 67

[16] A. Kirman Quart. Journal Econ. 108 (1993) 137

[17] S. Alfarano and T. Lux in A. Kirman and G. Teyssi´ere, eds., Long Memory in

Economics and Econometrics, Springer, Berlin 2004

[18] S. Alfarano, F. Wagner and T. Lux to be published in Computational Economics

2005

[19] S. Alfarano Thesis, Kiel 2005

24

[20] Y.C. Zhang Physica A 269 (1999) 30

[21] D. Stauﬀer and D. Sornette Physica A 271 (1999) 496

[22] V. Plerou, P. Gopikrishnan, X. Gabaix and H. E. Stanley Phys.Rev E 66 (2002)

027104

[23] J. J. Binney, N. J. Darwick, A. J. Fisher and M. E. J. Newman The Theory of

Critical Phenomena, Clarendon Press, Oxford 1992

[24] S. Alfarano and F. Wagner, to be published

[25] Data basis of Institut f¨ur Weltwirtschaft, Kiel

[26] M. M.Dacarogna, R. Gen¸cay and U. M¨uller An Introduction to High-Frequency

Finance, Academic Press, Oxford 2001

[27] A. Johansen, O. Ledoit and D. Sornette Int. Journ. of Theor. and Applied Fin.

3 (2000) 219

New York 1953

[28] F. Lillo, S. Micciche and R. N. Mantegna arXiv:cond-mat/0203442 (2002)

[29] A. Erdely Higher Transcendental Functions Volume 2, p.189 McGraw-Hill Inc.,

[30] P. Gopikrishnan, V. Plerou, L. A. Nunes Amaral, M. Meyer and H. E. Stanley

Phys.Rev E 60 (1999) 5305

25

