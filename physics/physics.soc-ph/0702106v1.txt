7
0
0
2
 
b
e
F
 
3
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
6
0
1
2
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Emergence of time-horizon invariant correlation structure in ﬁnancial returns by subtraction of the
market mode

Christian Borghesi
Service de Physique de l’Etat Condens´e (CNRS URA 2464), CEA Saclay, 91191 Gif sur Yvette Cedex, France

Matteo Marsili∗
The Abdus Salam ICTP, Strada Costiera 11, I-34014, Trieste. Italy.†

Salvatore Miccich`e‡
Universit`a degli Studi di Palermo, Dipartimento di Fisica e Tecnologie Relative,
Viale delle Scienze, Ediﬁcio 18, I-90128 Palermo, Italy.
(Dated: February 2, 2008)

We investigate the emergence of a structure in the correlation matrix of assets’ returns as the time-horizon
over which returns are computed increases from the minutes to the daily scale. We analyze data from different
stock markets (New York, Paris, London, Milano) and with different methods. Result crucially depends on
whether the data is restricted to the “internal” dynamics of the market, where the “center of mass” motion (the
market mode) is removed or not. If the market mode is not removed, we ﬁnd that the structure emerges, as the
time-horizon increases, from splitting a single large cluster. In NYSE we ﬁnd that when the market mode is
removed, the structure of correlation at the daily scale is already well deﬁned at the 5 minutes time-horizon, and
this structure accounts for 80 % of the classiﬁcation of stocks in economic sectors. Similar results, though less
sharp, are found for the other markets. We also ﬁnd that the structure of correlations in the overnight returns is
markedly different from that of intraday activity.

PACS numbers: 89.75.Hc , 05.90.+m

I.

INTRODUCTION

Besides their intrinsic interest, ﬁnancial markets have also
attracted a great deal of attention as a paradigm of complex
systems of interacting agents.
In this view, the correlation
between different assets are one of the signatures of the com-
plexity of the system’s interactions and, as such, have been
the focus of intense recent research [1, 2]. The central ob-
ject of study is the empirical covariance matrix of a set of
N assets, whose elements are the Pearson’s correlation co-
efﬁcients C(τ )
i,j (T ) between the log–returns of assets i and j
over a time-horizon τ , measured on historical time series of
length T . Early studies have focused mainly on daily returns
(τ = 1 day) and have shown that the bulk of the eigenvalue
distribution of the correlation matrix is dominated by noise
and described very well by random matrix theory [3, 4]. This
“noise” band of noisy eigenvalues shrinks as
N/T as the
length T of dataset increases, but it is signiﬁcant for typical
cases where N and T are of the order of some hundreds. The
few large eigenvalues which leak out of the noise background
contain signiﬁcant information about market’s structure. The
taxonomy built with different methods [4, 5, 6, 7] from ﬁ-
nancial correlations alone bears remarkable similarity with a
classiﬁcation in economic sectors. This agrees with the ex-
pectation that companies engaged in similar economic activ-
ities are affected by economic factors in a similar way. With

p

∗Electronic address: marsili@ictp.it
†also DEMOCRITOS
‡Electronic address: micciche@lagash.dft.unipa.it

respect to their dynamical properties, it has been found that,
ﬁnancial correlations are persistent over time [8] and that they
follow recurrent patterns [7].

Furthermore, correlations “build up” as the time-horizon τ
on which returns are measured increases, and they saturate
for returns on the scale of some days [9, 10]. This behavior,
known as the Epps effect[11], is a manifestation of the process
of mutual information exchange across assets.
It quantiﬁes
how this information ﬂow is ultimately “incorporated” into
correlations, in much the same way as information on single
assets is incorporated into their prices. Interestingly, it was
found that such a process is much faster today than in the past
and more pronounced for more capitalized stocks [9]. It has
also been remarked [12, 13] that the structure of correlations
changes as the time-horizon τ over which returns are deﬁned
increases, i.e. that “pictorially, the market appears as an em-
bryo which progressively forms and differentiates over time”
[10].

Here we shall take a closer look on the dependence of the
structure of correlations on the time-horizon τ and show that
the observed evolution of the market structure is due, to some
extent, to the dynamics of the market mode. Global correla-
tions play a dominant role at high frequency, thus giving rise
to correlation structures which are much more clustered than
at the daily scale. However, if global correlations are removed,
the structure of correlations at the daily scale, is largely pre-
served across time-horizons, down to a scale of 5 minutes for
the most liquid market we have analyzed. Loosely speaking,
the network structure, after removing the market mode, ap-
pears fully formed and differentiated already at small scales,
it only grows in size (of correlations) as the time-horizon in-
creases.

The effect of disentangling the effect of the market mode
when computing pairwise correlations between stocks is anal-
ogous to decomposing the dynamics of a complex interacting
system in that of its center of mass and of its internal coor-
dinates. This is obvious in physics, where the center of mass
dynamics is determined by external forces, whereas internal
coordinates mainly respond to inter-particle interaction forces.
By analogy, our results suggest that in order to understand the
dynamics of inter-asset correlations, it makes sense to elimi-
nate the effect of the “center of mass”.

The paper is organized as follows: in the next Section we
discuss the datasets and how we build correlation matrices.
Then we shall discuss the results of data clustering approach
in Section III ﬁrst for NYSE and then for the other markets.
The following Section deals with the Minimal Spanning Trees
approach. Finally we shall summarize our results and offer
some concluding remarks.

II. THE DATA

In this paper we empirically investigate the ensemble be-
haviour of price returns for 4 different markets: the New York
Stock Exchange (NYSE), the London Stock Exchange (LSE),
the Paris Bourse (PB) and the Borsa Italiana (BI). All data
refer to year 2002.

The NYSE data are taken from the Trades and Quotes
(TAQ) database maintained by NYSE [14]. In particular, 100
highly capitalized stocks were considered. For each stock and
for each trading day we consider the time series of stock prices
recorded transaction by transaction. Since transactions for dif-
ferent stocks do not happen simultaneously, we divide each
trading day (lasting 6h 30′) into intervals of length τ . For
each trading day, we deﬁne Nτ intraday stock price proxies
pi(tk) of asset i, with k = 1,
, Nτ . The proxy is deﬁned as
· · ·
the transaction price detected nearest to the end of the interval
(this is one possible way to deal with high-frequency ﬁnan-
cial data [15]). By using these proxies, we compute the price
returns

(1)

a(τ )
i

(t) = ln pi(t)

ln pi(t

τ )

−

time-horizons τ .

−
The time-horizon used are τ =
at
5, 15, 30, 65, 195 minutes. For NYSE, values of τ are large
enough that all the considered stocks have at least one trans-
action in each time interval.

The LSE data are taken from the “Rebuild Order Book”
database, maintained by LSE [16]. In particular, we consider
only the electronic transactions for 92 highly traded stocks
belonging to the SET1 segment of the LSE market. The trad-
ing activity has been deﬁned in terms of the total number of
transactions (electronic and manual) occurred in 2002. How-
ever, most of the transactions, a mean value of 75% for the
92 stocks, are of the electronic type. This market is com-
monly believed to be very active and can be regarded as a
realization of a “liquid” market. For each stock i and for
each trading day we consider the time series of stock price
recorded transaction by transaction and generate Nτ intra-
day stock price proxies pi(tk) according to the procedure ex-

2

plained above. For the LSE data, the time-horizon used were
5, 15, 30, 51, 102, 255 minutes. Each trading day lasts
8h 30′.

The PB data are taken from the “Historical Market Data”
database, maintained by EURONEXT [17]. In particular, we
consider the electronic transactions of two subsets of stocks
traded in the year 2002. For each stock i and for each trading
day, lasting 8h 30′, we consider the time series of stock price
recorded transaction by transaction and generate Nτ intra-
day stock price proxies pi(tk) according to the procedure ex-
plained above. One ﬁrst set, which will be analyzed in Section
III, consists of the 75 most frequently traded stocks at time-
2k seconds, for k = 0, . . . , 10. An anal-
horizons τk = 27
ogous dataset was derived considering tick time: τ (tick)
=
2k. This choice was considered in order to probe the
100
region of very high frequencies and to assess the relevance
of time inhomogeneity of trading activity at intraday time
scales.
In this respect, it is worth to remark that for small
τ stocks were not traded in each time interval. A second
dataset, that will be considered in Section IV, instead con-
sisted of N = 39 stocks which were continuosly traded in the
entire 2002 (i.e.
in each time interval) over time-horizon of
τ = 5, 15, 30, 51, 102, 255 minutes.

k

·

·

The BI data are taken from the “Dati Intraday” database,
maintained by Borsa Italiana [18].
In particular, we con-
sider only the electronic transactions occurred for 30 stocks
continuosly traded in the entire year 2002. For each stock i
and for each trading day we consider the time series of stock
price recorded transaction by transaction and generate Nτ in-
traday stock price proxies pi(tk) according to the procedure
explained above. For the BI data, the time-horizon used were
5, 15, 30, 60, 120, 240 minutes. Each trading day lasts 8h.
For all markets, in addition to the intraday time-horizons,

we have considered returns on the daily time-horizon

a(op−cl)
i
a(cl−cl)
i
a(night)
i

(n) = log pcl
(n) = log pcl
(n) = log pop

i (n)

i (n)

i (n)

−

−

i (n),
i (n

log pop
log pcl
log pcl

i (n

−

−

1),

1),

−

(2)

(3)

(4)

corresponding to intraday, daily and overnight returns, respec-
tively. Here pop
i (n) are the open and closure prices
of stock i in day n.

i (n) and pcl

For

activity.

the NYSE data we

Each stock can be associated to an economic sec-
tor of
consid-
ered the classiﬁcation scheme given in the web–site
http://finance.yahoo.com/, for the LSE and BI
data we considered the classiﬁcation scheme used in the
web–site www.euroland.com, for the PB data we con-
sidered the classiﬁcation scheme used in the web–site
http://www.euronext.com/. The relevant economic
sectors are reported in Table I.

Given the price return at a selected time-horizon τ , we built

the correlation matrices in the usual way

A(τ )

i,j =

i a(τ )
a(τ )
j
h
a(τ )
[a(τ )
i

i − h

i − h
]2
i

ih

a(τ )
i
ih
[a(τ )

j − h

a(τ )
j

i
a(τ )
j

]2
i

i

qh

.

(5)

TABLE I: Color codes for the economic sectors of activity for the
stocks.

COLOR
red
green
blue

SECTOR
1 Technology
2 Financial
3 Energy
4 Consumer non-Cyclical yellow
brown
5 Consumer Cyclical
grey
6 Healthcare
violet
7 Basic Materials
cyan
8 Services
magenta
9 Utilities
light green
10 Capital Goods
maroon
11 Transportation
orange
12 Conglomerates

Here and in what follows,
time average.

. . .
i
h

= (1/Nτ )

Nτ
t=1 . . . denotes

P

In order to disentangle different components of the dynam-
ics and to understand their effect, we considered also series of
datasets derived from a(τ )
(t). In all derived datasets we sub-
tract a particular component of market dynamics from the rest.
When the structure of the derived dataset differ substancially
from that of the matrix ˆA we can conclude that the decompo-
sition is meaningful and informative.

i

First we removed the “center of mass” dynamics:

b(τ )
i

(t) = a(τ )

(t)

i

1
N

N

X
j=1

−

a(τ )
j

(t).

(6)

From this, a covariance matrix B(τ )
way as in Eq. (5).

i,j was computed in the same

In a further dataset we removed the effect of the market
index from a(τ )
(t). This was done ﬁrst considering the time-
series I (τ )(t) of the corresponding market index at the same
time-horizon τ and then estimating the coefﬁcients of a one
factor model

i

a(τ )
i

(t) = αi + βiI (τ )(t) + c(τ )

(t).

i

(7)

i

The residuals c(τ )
(t) were used to build the covariance matrix
C(τ )
i,j . We could build the time series I (τ )(t) only in the case
of NYSE data, for which we had access to intraday data of the
SP500 composite index.

In all datasets we computed an “endogenous” market index

using the market average return

¯a(τ )(t) =

1
N

N

X
j=1

a(τ )
j

(t).

Using this instead of the market index I (τ )(t) in Eq. (7) and
considering the residues d(τ )
(t), we computed a further co-
variance matrix D(τ )
i,j .

i

3

Finally, we produced a dataset by removing the contribu-
tion of the largest eigenvector of the matrix A(τ )
i,j . This can be
done by zeroing the largest eigenvalue of ˆA, as discussed in
Ref. [4]. An alternative method, which we prefer, is that of
removing the “optimal” factor, G(τ )(t) which is obtained by
minimizing

N

Nτ

2

i

χ2 =

ha(τ )

i

(t)

αi

βiG(τ )(t)i

−

−

X
i=1

X
t=1
on αi, βi and G(τ )(t). The residues e(τ )
(t) resulting from this
operation coincide with the time-series obtained from a(τ )
(t)
by subtracting the leading contribution of its singular value
decomposition. We call E(τ )
the correlation matrix of the
i,j
residues e(τ )
(t).

i

i

In summary, we consider the original time-series (set A),
the one obtained subtracting the average market return (set B)
and those obtained from the residues of a one factor model
with the market index (set C), the average market return (set
D) and the optimal factor (set E). Set C represents a case
where the market mode is exogenously determined whereas
in sets D and E it is determined by the data itself. This allows
us to understand how much an index, such as SP500 which is
a weighted average, accounts for the collective dynamics of
the market.

The distribution of matrix elements is shown in Fig. 1 as a
function of time-horizon (top, for the sets A and B) and for
different datasets at the intraday time-horizon. We observe
that the distribution spreads out as the time-horizon increases,
as a manifestation of the Epps effect. However, while the dis-
tribution of Ai,j is centered around a positive value, that of
correlations of derived datasets is peaked on values close to
zero and is narrower. For set B (D and E) the peak is at
slightly negative values, whereas for set C it occurs at posi-
tive values. This suggests that the removal of correlations is
more efﬁcient when the single factor is computed from the
data. This already shows that the dynamics of the mean ¯a(t)
already explains the correlations better than the market index.
We also ﬁnd that intraday and overnight returns have dis-
tinctly different distribution of correlation coefﬁcients. This
difference is particularly pronounced in dataset C which again
suggest that the market index is even less explicative of the
market’s collective behavior at these scales.

Correlation Di,j and Ei,j were found to have a distribution
which is similar to that of Bi,j. This anticipates a generic
conclusion: the subtraction of a global component from the
dynamics is most meaningful when it eliminates (either im-
plicitly as in ˆB or explicitly as in ˆE) the market mode by
setting the corresponding eigenvalue to zero.

Before analyzing the structure of correlations, it is of inter-
est to provide some estimate of the relative strength of global
correlations and of noise in the correlation matrices ˆA. Fig. 2
plots the share of correlation carried by the largest eigenvalue
Λ (which is Λ/N , by normalization) for NYSE, LSE and PB,
as a function of time-horizon τ . As a manifestation of Epps
effect [11], this increases with τ in a way which is reason-
ably well approximated by a logarithmic growth. The ratio of

Bi,j

Ai,j

  5 min
 15 min
 30 min
 65 min
195 min
cl−op

X=A
X=B
X=C
X=D
X=E

0

0.5

1

Xi,j

FIG. 1: Distribution of correlation coefﬁcients Ai,j and Bi,j for dif-
ferent time-horizons τ (top) and at the intraday time-horizon for dif-
ferent datasets (NYSE data).

the second largest eigenvalue λ to the largest, which could be
taken as a measure of the relative strength of inter-asset corre-
lations against global correlations, has a declining trend with
τ for small time-horizons and then saturates at around 0.1.

NYSE
LSE
PB

Λ/Ν

10

5

0

4

2

)
τ

|

j
,
i

X
(
P

)
p
o
−
l
c

|

X
(
P

j
,
i

0
−0.5

 0.45

 0.4

 0.35

 0.3

 0.25

 0.2

 0.15

 0.1

 0.05

 0

λ/Λ

1 min

5 min

20 min

1 h

2 h

4 h

cl-op

cl-cl

op-cl

FIG. 2: Largest eigenvalue Λ/N , divided by the number of assets,
of the matrix ˆAτ as a function of τ for NYSE, LSE and PB (full
symbols). Ratio λ/Λ of the second largest to the largest eigenvalue
of ˆAτ , as a function of τ (open symbols).

4

}

→ ∞

where ηs(t) and ηi(t) are independent gaussian variables with
mean zero and unitary variance. Here ηs(t) describes the
component of the dynamics which is common to all time se-
ries xi(t) with si = s whereas ǫi(t) describes idiosyncratic
(8) is consistent with a correlation ma-
ﬂuctuations. Eq.
trix Xi,j =
which has a block diagonal structure for
xixj
i
h
: Xi,j = g2
si if si = sj and Xi,j = 0 otherwise. The
T
parameters gs entering Eq. (8) as well as the cluster structure
can be determined by maximum likelihood estimation.
si
{
Approximate maximization of the log-likelihood can be done
following an hierarchical clustering procedure [24]: start with
N clusters, each composed of a single asset (s(0)
i = i). From
with K + 1 clusters, compute the
the conﬁguration
log-likelihood of all conﬁgurations obtained by merging two
s(K)
with K clusters is the one
clusters. The conﬁguration
i
corresponding to the maximal log-likelihood
K . This opera-
1 to 1, and the opti-
tion can be iterated with K going from N
mal conﬁguration can be chosen as that for which
K is max-
imal. This also predicts the optimal number K ∗ of clusters
which describes our dataset. This method has already been
used to analyze stock market data: in Refs. [6] the emergent
clusters were found to be highly correlated with economic ac-
tivity. Furthermore the method was extended to perform noise
undressing. In Ref. [7] the method has been applied to inves-
tigate market dynamics, showing that well deﬁned recurrent
states of market wide activity can be deﬁned.

s(K+1)
i

−

L

L

{

}

{

}

Here we apply this method to investigate how the structure
of market’s correlations evolves as the time lag τ increases
from the high-frequency range to the daily scale. We shall
ﬁrst focus on NYSE and then discuss the differences found in
other markets.

A
B
C
D
E

40

30

20

10

0

15

10

5

0

)
l
l

a
(
 

K

)
d

.
k

i
l

−
g
o

l
 
f
o
 
%
0
9
(
 

K

III. DATA CLUSTERING

5   m i n

5   m i n

1

0   m i n

3

5   m i n

6

5   m i n

9

1

p

c l  −   o

h t

e r n i g

v

o

y

a

d

We performed data clustering analysis following the
method of Ref. [6]. Here we only sketch the basic idea of
the method and we refer the interested reader to Ref. [6] for
details. In brief, assume we wish to cluster N standardized
[23] time series xi(t) in groups having a similar dynamics.
First we assign a cluster label si to each time series, specify-
ing which cluster it belongs to. Then we assume that xi(t) is
generated according to the model

xi(t) = gsiηsi (t) + q1

−

g2
si ǫi(t),

t = 1, . . . , T

(8)

FIG. 3: Top: Number of clusters for datasets A, B, C, D and E.
Bottom: number of clusters accounting for 90% of the likelihood
(NYSE data).

A. NYSE

Fig. 3 shows the evolution of the number of clusters with
the time-horizon τ for the different datasets in the NYSE. For

ˆA we ﬁnd fewer clusters then with other methods and the
number of clusters increases with τ . This is consistent with
results of Refs. [12] which observe an evolution of the struc-
ture of correlations, where more and more details are added
as the time-horizon increases. The other datasets, however,
reveal that this is due to the fact that ˆA includes the correla-
tions induced by the common factor. When this is removed,
as for ˆB, ˆD and ˆE, we ﬁnd that the number of clusters which
accounts for most of the log-likelihood is remarkably stable
from the 5 min to the intraday scale. When the S&P500 in-
dex is removed from the data ( ˆC), we ﬁnd a fast evolution of
the structure between 5 min and 30 min and then the number
of clusters saturates to a constant level. Again, in all cases, a
signiﬁcant variation takes place in the overnight and hence at
the daily (cl-cl) scale.

5 min

15 min

30 min

65 min

1/2 day

9:30-15:00

cl-op

cl-cl

op-cl

5 min

15 min

30 min

65 min

1/2 day

9:30-15:00

cl-op

cl-cl

op-cl

5 min

15 min

30 min

65 min

1/2 day

cl-op

cl-cl

op-cl

5 min

15 min

30 min

65 min

1/2 day

cl-op

cl-cl

op-cl

FIG. 4: Evolution of the cluster structure with time-horizon for the
set A (top left) B (top right), C (bottom left) and E (bottom right)
of NYSE. The cluster label s(τ )
of each asset belonging to the most
relevant clusters is shown as a function of τ .
In this way, assets
who always belong to the same cluster follow the same “trajectory”
(indeed trajectories of different assets i are shifted by a small random
variable ǫi to distinguish them). The color is relative to the cluster
structure at the intraday scale.

i

i

A closer view on the evolution of the cluster structure is pre-
sented in Figs. 4. This plots the cluster label s(τ )
as a function
of τ , for each asset belonging to clusters accounting for 90%
of the log-likelihood [25]. Hence assets i and j belonging to
the same cluster for all τ , follow parallel trajectories in the ﬁg-
ure. In this representation, cluster splitting and merging can
clearly be read off. In dataset ˆA and ˆC we see considerable
splitting of clusters as we move from τ =5 min to the daily
time-horizons. A substantial reshufﬂing and merging takes
place when going to overnight returns. On the contrary, in
dataset ˆB, ˆE and ˆD (not shown), cluster membership exhibits
a remarkable stability at intraday scales: the vast majority of
assets within a cluster at 5 min, follows the same “trajectory”
across time-horizons. Some reshufﬂing takes place in the or-
der of clusters, suggesting that the structure of correlations
among sectors evolves with time-horizons. Again, the struc-
ture of overnight returns is considerably different.

In order to make the comparison of different cluster struc-

5

ℑ(%) 5 min 15 min 30’ 65 min 195 min cl-op cl-cl op-cl
77
90
86
91
87

100
90
92
92
90

89
90
89
90
90

86
92
87
89
90

11
90
66
90
87

5
91
33
91
91

24
72
30
78
80

42
91
84
92
90

A
B
C
D
E

TABLE II: Overlaps ℑ between cluster structures at different time-
horizons and different sets and the structure of set A at τ = 1 day.

{

{

and

s(1)
i }

(s(1), s(2)) between any two structures

ture quantitative, we have introduced an information distance
s(2)
.
i }
ℑ
In words, this tells us how much the knowledge of the clus-
ter label s(1)
of a randomly chosen stock i, yields information
i
on the value of s(2)
. Information is quantiﬁed by entropy re-
duction, in the following manner: Let p(ℓ)(s) be the fraction
of stocks with s(ℓ)
s′) be the
|
fraction of stocks with s(1)
i = s, among those which have
s(2)
i = s′. From these, we can compute the entropies S(ℓ) in
the usual way and the conditional entropy

i = s for ℓ = 1, 2 and p(1|2)(s

i

S(1|2) =

p(2)(s′)

p(1|2)(s

− X
s′

X
s

s′) log p(1|2)(s
|

s′).
|

The information gain is then given by

S(1)

S(1|2)

=

ℑ

−
S(1)

(9)

ℑ

ℑ

ℑ ≈

1 implies that
Because of the normalization, a value of
s(2) yields a rather precise information on s(1), so if
= 0.8
we shall say that s(2) accounts for 80 % of the information
contained in s(1). Table III A shows the values of
(in %)
between different cluster structures and that obtained from set
A at τ =1 day time-horizon. This shows that at this time-
horizon, the cluster structure is essentially the same in the ﬁve
datasets, with an overlap larger than 90 %. An overlap of the
same order of magnitude attains for all intraday scales in sets
B, D and E. Even though the overlap drops down as one
moves to overnight returns, the difference is much smaller in
sets B, D and E than in sets A and C. This suggests that, even
though overnight returns have a structure which is markedly
different from that of intraday returns, still removing the mar-
ket mode allows one to reveal more invariant features.

∈ {

1, . . . , 12

Such invariant features, we claim, are related to economic
sectors. In order to support this, we compare the cluster struc-
tures with the classiﬁcation of assets in the sectors of eco-
nomic activity given in Table I. The latter, yields a sector
for each stock i, for which we can
label ei
, as above, setting s(1)
i = ei.
compute an information gain
ℑ
Fig. 5 shows the behavior of
for different datasets across
ℑ
time-horizons. This suggests that the most informative sets
are those where the market mode is removed and these ac-
count for 80% of the information contained in ei. For these,
the information content is remarkably constant across time-
horizons. On the contrary, for set A the information gain

}

ℑ

6

the (entropy of a) classiﬁcation in economic sectors for LSE,
and that this information content is roughly constant across
time (intraday) scales.

As for the NYSE, we found that overnight returns have a
cluster structure which is markedly different from that of in-
traday returns. Different markets, however, exhibit different
patterns in this respect. While the LSE has a fragmented clus-
ter structure of overnight returns similar to NYSE, PB shows
a more compact structure.

5 min

15 min

30 min

51 min

102 day

255 min

cl-op

cl-cl

op-cl

FIG. 6: Evolution of the cluster structure for set E of LSE.

increases with τ in the intraday range, as if information on the
economic activity of assets were ”released” gradually, as time-
horizon increases. It is worth to remark that, for all datasets,
overnight returns (specially for sets A and C) carry much less
information on the economic structure of the market, than in-
traday returns.

Hence, we conclude that in datasets A and C the evolu-
tion in the cluster structure is due to the interplay between
the “center of mass” motion (i.e.
the market mode) and the
internal dynamics. Indeed when the latter contribution is sub-
tracted from the data, as in datasets B, D and E, we ﬁnd
that the structure of correlations is remarkably stable with the
time-horizon. This is consistent with a notion of market’s in-
formational efﬁciency by which information is incorporated
very quickly in market’s returns. From the above analysis, we
infer that the information on the relations between assets is
efﬁciently incorporated in returns over time-horizons shorter
than 5 min in NYSE.

 1

 0.8

 0.6

 0.4

 0.2

 0

A
B
C
D
E

5 min

15 min

30 min

65 min

1/2 day

cl-op

cl-cl

op-cl

FIG. 5: Information gain on the classiﬁcation in economic sectors
given by the knowledge of cluster structures s(τ )
at different time-
horizons τ , for different datasets a, . . . , e. In order to avoid effects
due to differences in the number of clusters, we considered maximum
likelihood structures with 20 clusters for all datasets. Notice that by
normalization 0 ≤ ℑ ≤ 1.

i

B. Other markets

FIG. 7: Evolution of the cluster structure for set B of 75 stocks in
PB.

1 min

4 min

15 min

1 h

4 h

cl-op

cl-cl

op-cl

We have performed data clustering analysis also on LSE
and PB data. Again we found that removing the market mode
allows one to reveal the structure of correlations much more
clearly. Indeed, while set A is characterized by one or two
clusters at intraday time scales, set B, . . . , E are character-
ized by a richer structure, as shown in Figs. 6 and 7. In both
cases, we see that a signiﬁcant part of the structure forms at
intermediate time-horizons of 15 - 30 minutes. In PB data,
we pushed our analysis to ultra-high frequency, probing very
short time scales. We found that for τ <5 min barely any
structure can be seen in the correlation matrix. As for NYSE,
we found that the cluster structure of set ˆA is poorly correlated
with the classiﬁcation of assets in economic sectors, whereas
datasets B and E cluster in a way which reﬂects up to 70% of

In contrast with our ﬁndings on NYSE data, the cluster
structure of set A is now markedly different from that of other
sets even at the daily scale. This suggests that the role of
global correlation is much stronger in LSE and PB.

In order to compare different markets, we performed the
Kolmogorov-Smirnov (KS) test [19] on the distribution of
cluster sizes. This provides a p value for the hypothesis that
sa
two different samples
of cluster sizes can be
and
i }
considered as different populations drawn from the same un-
known parent distribution.
If this is not the case (i.e. p is
small), we can conclude that the two samples have a different
structure, whereas if p is close to one, we cannot reject the
hypothesis that the two samples have the same structure. We
found that LSE and PB have a cluster size distribution which

sb
i }

{

{

is different from that of NYSE (p
markably similar one to the other (p

0.1), but which are re-
1).

The similarity between LSE and PB, and their difference
with NYSE, is also visible in the dependence of the largest
eigenvalues on τ shown in Fig. 2. Remarkably, the market
mode seems stronger in NYSE than in LSE and PB, whereas
data clustering suggests the opposite.

≃
≃

In the case of PB data, we also performed several tests in
order to asses the sensitivity of our results on the inhomogene-
ity of trading activity. One may indeed think that particular
times of the day, such as the opening or the closure of the
market, peak or lunch break hours, might be characterized by
different statistical properties. In order to test for these effect,
we removed the ﬁrst and the last 20 minutes of trading from
the data in each day and considered the resulting correlation
matrices ˆA′, ˆB′, . . .. We computed the relative information
ℑ
between the maximum likelihood structures obtained in this
way and the original ones, at different time scales τ . The re-
sult is that, for set B of PB, at all τ roughly
70% of
the structure found in the whole dataset coincides with that
obtained eliminating the opening and the closing period (see
Fig. 8). An even stronger similarity (
= 0.83) was found
in NYSE between the structure of intraday correlations and
those obtained from returns measured roughly 30 minutes af-
ter opening and before closing. We conclude that a signiﬁcant
part of the structure is not affected by the activity at the market
opening or at closure.

ℑ ≃

ℑ

As a further test to check the effects of time inhomogeneity
of trading activity, we compute correlation matrices in tick
time for PB, over intervals of τ (tick)
2k ticks, which
k
correspond on average to the time scales τk used in real time
(here a tick is deﬁned as a transaction on any of the stocks
considered). The results, shown in Fig. 8, suggest that the
structure of market correlation is largely independent of the
deﬁnition of time, as indeed roughly 80% of the information
found with real time is recovered using tick time.

= 100

·

 1

 0.8

 0.6

 0.4

 0.2

 0

1 min

4 min

15 min

1 h

4 h

cl-op

max likelihod
20 clusters
with/without op-cl

FIG. 8: Relative entropy ℑ of the cluster structures of set B of PB
obtained for i) tick and real time (circles) on maximum likelihood
structures (ﬁlled) or structures with 20 clusters (open) and ii) with
and without the opening and closure period of roughly 30’ (ﬁlled
squares).

7

IV. SINGLE LINKAGE CLUSTERING ANALYSIS

In this section we review the results obtained by applying
the Single Linkage Clustering Algorithm (SLCA) to the data
considered in section II. For each time-horizon considered,
the SLCA allows to obtain a Hierarchical Tree (HT) and a
Minimum Spanning Tree (MST), which give complementary
information about the network structure of the considered set
of stocks. Indeed, the HT gives a description of the hierarchi-
cal organization of the stocks, while the MST gives an indi-
cation about their topological organization. For a review of
SLCA in the context of multivariate ﬁnancial time series we
refer to [13, 20, 21].

As much as in the previous section, here we apply the
SLCA to the different datasets in order to investigate how the
structure of market’s correlations evolves as the time-horizon
τ increases from intraday scales to the daily scale. We shall
ﬁrst focus on NYSE and then discuss the differences found in
other markets. The colors used in the representation of both
the HTs and the MSTs refer to the classiﬁcation is sectors of
economic activity given in Table I.

A. NYSE

The investigation of NYSE data by using the SLCA reveals
that the role of the “center of mass” in the structure of the cor-
relation is twofold. On one side, the level of clustering in all
the HTs in the sets where the “center of mass” is removed is at
an higher distance than the corresponding HTs of set A. Such
effect is expected since, by removing the “center of mass”, the
mean correlation is now approximately zero, as shown in Fig.
1. On the other side, the cluster structure seems now to be
more evident than in the case of the original data.

In Figs. 9 we present the data for set A (top) and set E
(bottom) at the two extreme time-horizon of 5 min (left) and
1 at 1 day (right). Contrary to what we ﬁnd in set A (top left),
the HT of set E at 5 min time-horizon (top right) shows a
signiﬁcant level of structure that, additionally, is similar to the
one found at 1 day (op-cl) time-horizon (bottom right).

This is also conﬁrmed by comparing the structure of the
MST in sets A and set E. The 5 min MST of set A shows a
typical structure with a few hubs characterized by an high de-
gree (Fig. 10). The 1 day (op-cl) MST of set A indicates that
the number of hubs has increased, reﬂecting the progressive
organization of stocks according to their sectors of activity as
time-horizon increases (Fig. 11). The MSTs shown in Figs.
12 and 13 for set E are markedly different from the corre-
sponding ones for set A. No preminent hub is traceable in the
two MSTs. In addition, they have a structure which is remark-
ably similar one another, to the extent that one could not say
which is which, on the basis of their statistical structure alone.
In order to quantify the difference between the structure of
the MSTs of different datasets at different time-horizons, we
performed the Kolmogorov-Smirnov (KS) test [19] on the de-
gree distributions of MSTs. The results for different sets are
collected in table III and it largely conﬁrms the conclusions
based on visual inspection of Fig. 10 – 13. First, we see

10

20

30

40

50

60

70

80

90

100

10

20

30

40

50

60

70

80

90

100

0

0

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0

0

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

10

20

30

40

50

60

70

80

90

100

10

20

30

40

50

60

70

80

90

100

FIG. 9: HT for set A (top) and E (bottom) of NYSE at τ = 5 min
(left) and at daily (op-cl) time-horizon (right). The vertical lines
represent different stocks. For each stock, colors refer to its eco-
nomic sector of activity, see table I. Economic sectors of activity are
deﬁned according to the classiﬁcation scheme used in the web–site
http://finance.yahoo.com/.

8

one associated to uncorrelated random walks.

Aτ Bτ

Cτ Dτ

Eτ

Aτ =5min
Aτ =1d

X5min, τ = 1d 0.031 0.677 0.961 0.992 1.000
1.000 0.047 0.021 0.001 0.000
1.000 0.794 0.894 0.677 0.794
R, τ = 5min 0.000 0.443 0.677 0.794 0.992
0.556 1.000 1.000 1.000 1.000
16
22

R, τ = 1d
d, τ = 5min
d, τ = 1d

23
25

8
15

23
22

17
26

TABLE III: Results of the Kolmogorov-Smirnov test on the de-
gree distribution of MSTs for different datasets and time-horizons
in NYSE. The ﬁrst row compares the MSTs at τ ′ =5 min and τ =1
day (op-cl) in different datasets X = A, . . . , E. The second (third)
row compares the structure of the MST of set A at τ =5 min (1
day) with the MSTs in different datasets at the same horizon τ . The
fourth (ﬁfth) row compares the MSTs of sets A, . . . , E at τ =5 min
(1 day) with one generated by a random sample of N = 100 random
walks of the same length. The last two rows report the diameters
of the MSTs at τ =5 min and 1 day (op-cl). These should be com-
pared with the diameter 22 ± 3 of a r-MST generated by uncorrelated
random walks.

that the structure of the MSTs at the extremes of the intra-
day scale range are markedly different in set A and become
increasingly similar as we move to set E. Second, Table III
shows that the structure of set A is similar to that of other sets
at the same time-horizon at τ = 1 day (op-cl), but this is not
true at smaller time-horizons.

≃

We also compared the MSTs with random MST (r-MST)
generated by uncorrelated random walks of the same length.
This reveals that, apart from set A, we are not able to detect
any statistical feature in the degree distribution which differ-
entiates the MSTs of sets B, C, D and E at τ = 1 day (op-cl)
from those generated by pure noise. Even the diameter of the
MSTs is not able to discriminate them from those generated
by pure noise. However, the similarity of MSTs with r-MST
disappears for larger datasets of N = 500 or N = 2000 stocks
0 for all sets, at
of NYSE, for which KS yields values of p
both τ =5 min and 1 day (op-cl). Furthermore, MSTs turn out
to be considerably more compact than r-MSTs. For example,
we ﬁnd that with N = 500 the r-MST have a diameter of 53
whereas at τ =1 day (op-cl) the largest value of the diameter
is 37 for set E. Finally, in the case of N = 500 stocks, for
set B, set C, set D and set E we have also performed the KS
test in order to compare the degree distribution of the MSTs
at 5 min and 1 day (op-cl). Such tests conﬁrm the result of
Table III, valid for N = 100 stocks, that the degree distri-
butions are essentially indistinguishable, with p-values which
are close to zero. Hence, we conclude that the removal of the
“market mode” generates residues whose MSTs still contain
non-trivial statistical features, although these are not clearly
observable in the case of N = 100 assets. When considering
a larger set, say N = 500, the noise threshold lowers enough
to reveal a topological organization which is different from the

BAX

ABT

SGP

LLY

MRK

BLS

JNJ

BMY

TXN

ADI

EMC

BNI

TRB

DUK

AFL

LOW

IGT

OXY

NEM

GCI

UNP

SLB

MMC

SO

NCC

MER

LEH

SCH

STI

PNC

CI

BSC

FRE

FNM

SBC

PFE

GM

CCU

KR

BA

DIS

AXP

CA

GD

IBM

EMR

CAH

UTX

WLP

HD

HDI

BUD

RD

WAG
K

BSX

SYY

WMT

CAG

GDT

FDC

GPS

BBY

MCD

GE

MOT

IP

PPG

DD

CAT

FON

OMC

AIG

TYC

MDT

KSS

DOW

SLE

S

KO

PG

ONE

GDW

WFC

BAC

MEL

BK

DE

DHR

ITW

PEP

AVP

GIS

G

CL

KMB

KRB

NOC

PGR

ALL

FIG. 10: MST for set A of NYSE at τ = 5 min. The vertices
represent different stocks. For each stock, colors refer to its eco-
nomic sector of activity, see table I. Economic sectors of activity are
deﬁned according to the classiﬁcation scheme used in the web–site
http://finance.yahoo.com/.

Pajek

In Fig. 14 we show the HTs relative to set A (left) and set
E (right) in the case when the overnight time-horizon is con-
sidered. The structure of such trees is different form the ones
at intraday time-horizons. In particular, for set A, the HT of
Fig. 14 shows that some stocks are highly correlated with
each other. However, the organization in economic sectors of
activity is less marked than in the corresponding HT at daily
time-horizon, see Fig. 9. Such effect is also observable when
considering set E, i.e. the right panel of Fig. 14. Here the av-
erage level of correlation increases, as expected. It is therefore

9

MOT

TXN

ADI

IBM

FON

BLS

EMC

CA

SBC

BSC

KR

GE

LEH

TYC

SCH

MER

MMC

AFL

BK

MEL

AIG

KO

PEP

WAG

WFC

SLB

OXY

WLP

GDT

MDT

BSX

CAH

SGP

MRK

BMY

PFE

JNJ

ABT
LLY

GIS

K

G

CL

AVP

CAG

BUD

PG

KMB

SLE

RD

STI

GDW

FDC

DD

DOW

EMR

ITW

PPG

GM

UNP

CI

NCC

ONE

BAC

WMT

KSS

LOW

PNC

BAX

IP

PGR

TRB

ALL

GCI

SYY

S

HD

BBY

GPS

IGT

HDI

CCU

DIS

AXP

OMC

NEM

KRB

FNM

DUK

FRE

SO

DHR

BNI

CAT

DE

UTX

MCD

BA

GD

NOC

MCD

FDC

GPS

BBY

LOW

HD

S

FRE

KSS

FNM

WMT

WAG

DUK

SO

GIS

SLE

K

KR

AVP

CL

G

BMY

BAX

LLY

ABT

MRK

SGP

PFE

BSX

JNJ

MDT

GDT

CAH

WLP

PEP

KO

PG

BUD

CAG

KMB

SYY

NOC

UTX

BA

DHR

EMR

DOW

ITW

GM

PPG

IP

DD

UNP

BNI

CAT

DE

GD

RD

OXY

SLB

NEM

KRB

AXP

ONE

BAC

NCC

WFC

CA
TXN

MOT

BSC

LEH

BK

AFL

CI

GDW

SCH

STI

MER

MEL

AIG

PGR

MMC

ALL

PNC

IBM

GE

ADI

EMC

DIS

FON

CCU

BLS

SBC

OMC

TRB

TYC

GCI

HDI

IGT

FIG. 11: MST for set A of NYSE at τ =1 day (op-cl). The vertices
represent different stocks. For each stock, colors refer to its eco-
nomic sector of activity, see table I. Economic sectors of activity are
deﬁned according to the classiﬁcation scheme used in the web–site
http://finance.yahoo.com/.

FIG. 13: MST for set E of NYSE at τ =1 day (op-cl). The vertices
represent different stocks. For each stock, colors refer to its eco-
nomic sector of activity, see table I. Economic sectors of activity are
deﬁned according to the classiﬁcation scheme used in the web–site
http://finance.yahoo.com/.

Pajek

Pajek

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

NOC

GD

BA

HDI

IGT

CAT

DHR

UTX

EMR

ITW

BNI

UNP

GCI

DE

IP

PPG

DD

TRB

DUK

SO

RD

OXY

SLB

BUD

NEM

CAG

K

MCD

KR

SLE

DOW

KMB

G

AVP

CL

FDC

LOW

GPS

BBY

HD

GM

S

KSS

GIS

SYY

PEP

WMT

PG

WAG
KO

BAX

JNJ

CI

WLP

BMY

CAH

LLY

ABT

MDT

GDT

BSX

MRK

SGP

PFE

AFL

PGR

AIG

MMC

ALL

GE

TYC

DIS

IBM

CCU

OMC

SBC

BLS

FON

CA

ADI

EMC

TXN

MOT

MER

BSC

LEH

BAC

WFC

SCH

AXP

KRB

FRE

FNM

GDW
ONE

STI

NCC

PNC

MEL

BK

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

Pajek

FIG. 12: MST for set E of NYSE at τ = 5 min. The vertices
represent different stocks. For each stock, colors refer to its eco-
nomic sector of activity, see table I. Economic sectors of activity are
deﬁned according to the classiﬁcation scheme used in the web–site
http://finance.yahoo.com/.

evident that at the overnight time-horizon the organization of
stocks in clusters is different than at intraday time-horizons,
i.e. when the market is open.

We have seen above that when removing the market mode
the topology of the MSTs has no speciﬁc statistical features,
even though the distribution of stocks on them is deﬁnitely not
random. Indeed the cluster structure seen in HTs (Fig. 9) cor-
respond to the fact that companies belonging to the same eco-
nomic sector appear clustered in the same region of the MST.
Again, this shows that the removal of the “center of mass” re-
veals the organization in sectors of activity already at such a
small time-horizons as 5 min. It is worth remarking, though,

10

20

30

40

50

60

70

80

90

100

20

40

60

80

100

FIG. 14: HT for set A (left) and E (right) of NYSE at overnight time-
horizon. The vertical lines represent different stocks. For each stock,
colors refer to its economic sector of activity, see table I. Economic
sectors of activity are deﬁned according to the classiﬁcation scheme
used in the web–site http://finance.yahoo.com/.

that the location of sectors themselves along the tree is dif-
ferent at 5 min and at the intraday scale. In other words, the
intra-sector structure evolves in time, while the sector compo-
sition remains stable.

In order to give a quantitative description of this effect, for
each set and at each time-horizon we have measured the frac-
tion of the MST links that are conserved with respect to the
open-to-close case. The results are reported in Fig. 15. The
top panel refers to the case when all links in the MST are con-
sidered. The other two panels refer to the case when we also
use the information about the economic sectors of activity, see
Table I. In particular, we consider only intra-sector links (mid-
dle panel) or only inter-sector links (bottom panel). Ideally,
for a better quantitative description we should have consid-
ered clusters rather than economic sectors. Unfortunately, the
SLCA does not allow a precise identiﬁcation of what a cluster
is. However, in Fig. 5 it is shown that there exists a strict re-
lation between economic sectors and the clusters obtained by
using the methodology of Ref. [6]. We here somehow make
the ansatz that such strict relation persists also in the clusteri-

zation given by the SLCA.

In the case when we consider all links (top) or only those
between stocks in the same sector (middle), in all the cases
but one, when the center of mass has been removed, the frac-
tion of conserved links is higher than for set A. The middle
panel of Fig. 15 shows that 70-80% of the MST links be-
tween stocks belonging to the same economic sector are con-
served with respect to the open-to-close case, whereas a much
smaller fraction is conserved between stocks belonging to dif-
ferent economic sectors. This is consistent with our observa-
tion that while sector composition remains stable, intra-sector
correlations evolve with the time-horizon. Moreover, such re-
sults are also consistent with the ones shown in Fig. 5 that the
amount of economic information contained in the clusters is
constant.

In this respect, the botton panel of Fig. 15 shows that set
D and set E reveal better than the others the topogical organi-
zation within different economic sectors at all time-horizons.
Finally, it is worth remarking that set C, where the market
mode is exogenously given by the SP500 index, gives results
which are comparable with those of set A.

By summarizing, the investigation of sets A, B, C, D and
E by using the SLCA shows that (i) the removal of the “center
of mass” reveals the organization of the sectors within differ-
ent economic sectors even at small time-horizons and (ii) this
is better achieved in set D and set E, where the “center of
mass” is endogeneously obtained either by miminizing the χ2
function of Eq. II or by using a mere return market average.
Finally, we ﬁnd that the degree distributions of the MST at
different time-horizons are statistically the same, specially in
set E, according the the Kolmogorov-Smirnov test, but they
cannot be distinguished from those of a set of N independent
random walks, for such a small market (N = 100). The distri-
bution of stocks on the MST reﬂects the organization of stocks
in economic sectors, and indeed links between companies in
the same sector are “conserved” across time scales.

B. Other markets

The question arises whether the above results have some
degree of universality or they are peculiar to the NYSE mar-
ket. We have therefore repeated the above investigations for
different markets, i.e. for LSE, PB and BI. Generally we con-
ﬁrmed the main conclusions: We ﬁnd that HT of sets B, C, D
and E reveal better the organization of stocks in economic
sectors than set A, and that the structure of HTs for the form-
ers is less dependent on the time-horizon τ than for the latter.
The structure of MSTs has a clear evolution in set A as the
time-horizon increases (e.g. KS test yields pLSE = 0.051 for
the degree distributions of MSTs of set A between τ =5 min
and 1 day), whereas it has a remarkably stable structure in the
other sets (particularly for set E, for which pLSE = 0.999
between τ =5 min and 1 day). A comparison of the MST for
set E for NYSE and LSE yields a KS test value of p > 0.9
for all time-horizons τ . Similar results were found comparing
NYSE and PB or BI MSTs. This invariance of the structure of
MSTs for set E across markets and time-horizons should not

10

0.8

0.7

0.6

0.5

0.4

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.3

0

0.8

0.7

0.6

0.5

0.4

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.5

0.4

0.3

0.2

s
k
n
i
l
 

d
e
v
r
e
s
n
o
c
 
f
o
n
o
i
t
c
a
r
f

 

20

40

60

80

100

120

140

160

180

200

time horizon (min)

0.3

0

20

40

80

100
140
60
time horizon (min)

120

160

180

200

set A
set B
set C
set D
set E

0.1

0

20

40

80

100
140
60
time horizon (min)

120

160

180

200

FIG. 15: Fraction of the intraday MST links that are conserved with
respect to the open-to-close case in the NYSE data. We report the
cases where we consider all the links (top), only intra-sector links
(middle) or only inter-sector links (bottom). Economic sectors of
activity are deﬁned according to the classiﬁcation scheme used in
the web–site http://finance.yahoo.com/.

be considered as an indication of universality, though. Indeed,
as for NYSE, this invariant structure is indistinguishable from
that of r-MSTs generated from uncorrelated random walks.
Hence, what this allows us to conclude is that markets of such
small sizes do not allow to make statements on the similarity
of market topology in terms of their MSTs. Indeed, the topol-
ogy of MSTs for N
100 stocks or less, is dominated by
noise.

≈

When the market is open, the disposition of stocks on the
MSTs, as in NYSE, is consistent with economic classiﬁca-
tion, across time-horizons. In Figs. 16 we report, for different
sets and at each time-horizon, the fraction of the MST links
that are conserved with respect to the open-to-close case for
LSE (left) and PB (middle) and BI (right). Again, we con-
sider all the links (top), only intra-sector links (middle) or

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

0.3

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

0.2

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.6

0.5

0.4

0.3

0.2

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.6

0.5

0.4

0.3

0.2

0.4

0.3

0.2

0.1

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.9

0.8

0.7

0.6

0.5

0.4

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.9

0.8

0.7

0.6

0.5

0.4

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.2

0.15

0.1

0.05

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.9

0.8

0.7

0.6

0.5

0.4

0.3

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.9

0.8

0.7

0.6

0.5

0.4

0.3

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0.2

0.1

s
k
n
i
l
 
d
e
v
r
e
s
n
o
c
 
f
o
 
n
o
i
t
c
a
r
f

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

0.3

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

0.2

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

set A
set B
set D
set E

set A
set B
set D
set E

set A
set B
set D
set E

0

0

20

40

60

80

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

0

0

50

250

300

20

40

60

80

0

0

100
200
150
time horizon (min)

100 120 140 160 180 200 220 240 260 280 300
time horizon (min)

FIG. 16: Fraction of the intraday MST links that are conserved
with respect to the open-to-close case in the LSE (left), PB (mid-
dle) and BI (right) data. We report the cases where we con-
sider all the links (top), only intra-sector links (middle) or only
inter-sector links (bottom). Economic sectors of activity are de-
ﬁned according to the classiﬁcation scheme used in the web–site
http://www.euroland.com/.

only inter-sector links (bottom). As much as in the NYSE
case, the sectors considered here are the economic sectors of
activity mentioned above. In the case of LSE data the results
are less sharp than in the NYSE case. Set B, set D and set
E give results which are more similar to each other with re-
spect to the NYSE case. One possible exception is given by
set B at 5 min time-horizon. In all cases, it is conﬁrmed that
the removal of the “market mode” reveals the organization of
stocks in economic sector already at small time-horizons. As
an example, the fraction of conserved intra-sector links in set
E is always ranging between 50% and 60%, while in set A
such percentage drops to 30% at the smallest time-horizon.
At larger time scales. however, the fraction of conserved links
for set A has roughly the same value that for other sets. This
is different from what we found for NYSE, where the fraction
of conserved links were systematically smaller for set A than
for other sets.

When considering the overnight time-horizon, we conﬁrm
that the organization of stocks in economic sectors of activ-
ity is less evident than in the case when the market is open.
However, such differences are less marked than in the NYSE
case.

V. CONCLUSIONS

We found that removing the dynamics of the center of mass
i) decreases the level of correlations and ii) makes the cluster
structure more evident. Na¨ıvely one would expect that reduc-
ing the level of correlations reduces the “signal” and hence
enhances the role of noise in the dataset. On this ground, one
might expect a less sharply deﬁned structure, i.e. the opposite

11

of ii). The fact that we observe i) and ii) implies that the mar-
ket mode dynamics bears little or no information on the mar-
ket structure. It also suggests that the market mode dynamics
and the dynamics of “internal coordinates” are to a large ex-
tent separable, in much the same manner as in particle systems
of classical mechanics, where the center of mass dynamics ac-
counts for the effect of external forces, whereas relative coor-
dinates respond to internal forces arising from inter-particle
potentials.

It is not difﬁcult to imagine components of trading activ-
ity which might contribute to the dynamics of the “center of
mass” or to relative coordinates. It is worth to remark, in this
respect, that a simple phenomenological model for the dynam-
ics of the market mode, taking into account the impact of trad-
ing in risk minimization strategies, has been recently proposed
[22]. Besides reproducing the main statistical properties of the
dynamics of the largest eigenvalue of the covariance matrix,
this model also shows that the behavior of the market mode is
largely insensitive to a ﬁner structure of correlations. The in-
variance of the structure of “internal” correlations across time
scales, and its similarity with economic classiﬁcation, instead
suggests that the dynamics of relative coordinates might be
related to the ways in which information on different assets
diffuses in the market.

The ﬁnding of a scale-invariant correlation structure is non-
trivial, in several respects. First, its origin suggests a ﬁne bal-
ance between signal and noise across time-horizons: On one
hand, the growth of correlations implicit in the Epps effect
implies that the “signal” gets stronger as the time scale in-
creases. On the other, random matrix theory suggests that the
strength of “noise” due to ﬁnite sampling, is more severe at
large time-horizons than at short ones. Indeed, the length of
1/τ , which implies a spread
the time series decreases as T
√τ in the eigenvalues due to noise dressing.
δλ
This latter effect allows us to detect weak correlation struc-
tures with an high precision at small time scales.

∼ p

N/T

∼

∼

Secondly, the scale invariance of correlation structure might
have important implications for risk management, because it
suggests that correlations on short time scales might be used
as a proxy for correlations on longer time-horizons.
If the
structure of correlations at short time scales can be computed
using shorter time series, this might allows us to detect struc-
tural changes more efﬁciently.

Finally, uncovering the dynamical origin of such a complex
phenomenology poses exciting challenges to theoretical mod-
eling of multi-asset markets.

VI. ACKNOWLEDGMENTS

Authors acknowledge support

from research projects
MIUR 449/97 “High frequency dynamics in ﬁnancial mar-
kets”, M.M. acknowledges support from EU-STREP project
n.
516446 COMPLEXMARKETS. S. M. acknowledges
support from MIUR-FIRB RBNE01CW3M “Cellular Self-
Organizing nets and chaotic nonlinear dynamics to model and
control complex systems”, from the EU-STREP projects n.
012911 “Human behavior through dynamics of complex so-

cial networks: an interdisciplinary approach”. We wish to
thank Dr. Claudia Coronnello for assistance in the prepara-

tion of data.

12

[1] J.-P. Bouchaud, M. Potters Theory of ﬁnancial risk and deriva-
tive pricing: from statistical physics to risk management (Cam-
bridge University Press, Cambridge, 2003).

[2] R. Mantegna, E. Stanley, Introduction to Econophysics (Cam-

[3] L. Laloux, P. Cizeau, J.-P. Bouchaud, M. Potters, Phys. Rev.

bridge University Press, 1999).

Lett., 83 (7) 1467-1470, (1999).

[4] V, Plerou, P. Gopikrishnan, B. Rosenow, L. A. N. Amaral, H.

E. Stanley, Phys. Rev. Lett., 83 (7) 1471-1474, (1999).

[5] G. Bonanno, G. Caldarelli, F. Lillo, R. N. Mantegna Phys. Rev.

[6] L. Giada, M. Marsili, Phys. Rev. E, 63 (6) 061101, (2001);

E, 68 (4) 046130, (2003).

Physica A, 315 57-71, (2002).

[7] M. Marsili, Quant. Fin., 2 297-302, (2002).
[8] J.-P. Onnela, A. Chakraborti, K. Kaski, J. Kertesz, A. Kanto,

Phys. Rev. E, 68 (5) 056110, (2003).

[9] J. Kwapien, S. Drodz, J. Speth, Physica A, 337 231-242,

[10] M. Potters, J.-P. Bouchaud and L. Laloux, J. Stat. Mech.,

[11] T.W. Epps, J. Am. Stat. Assoc., 74 291, (1974).
[12] G. Bonanno, F. Lillo, R.N. Mantegna, Quantitative Finance, 1,

(2004).

P08010 (2005)

96 (2001).

[13] C. Coronnello, M. Tumminello, F. Lillo, S. Miccich`e, R. N.
Mantegna, Acta Physica Polonica B, 36 (9) 2653-2679, (2005);
M. Tumminello, T. Di Matteo, T. Aste, R.N. Mantegna, DOI:
10.1140/epjb/e2006-00414-4; M. Tumminello, C. Coronnello,

F. Lillo, S. Miccich`e, R. N. Mantegna, e-print physics/0605251.

[14] www.nysedata.com
[15] M. M. Dacorogna, R. Gencay, U. A. M¨uller, R. B. Olsen, O.V.
Pictet, An Introduction to High-Frequency Finance, Academic
Press (2001).

[16] www.rebuildorderbook.com
[17] www.euronext.com
[18] www.borsaitaliana.it
[19] W.H. Press, S.A. Teukolsky, W.T. Veterling, B.P. Flannery, Nu-
the art of scientiﬁc computing,

merical Recipes in Fortran:
(Cambridge University Press, Cambridge, 2nd Ed., 1992).

[20] R.N. Mantegna, Eur. Phys. J. B 11, 193 (1999).
[21] G. Bonanno, G. Caldarelli, F. Lillo, S. Miccich`e, N. Vande-

walle, R.N. Mantegna, Eur. Phys. J. B, 38 363, (2004).

[22] G. Raffaelli, M. Marsili, JSTAT L08001 (2006).
[23] The time series xi(t) are derived from a(τ )

(t) by
normalization to zero average and unit variance. E.g. xi(t) =
[a(τ )
i − ha(τ )
i
[24] We choose this simple option, rather than more elaborate maxi-
mization procedures based e.g. on simulated annealing, because
for the data sets used the optimal conﬁguration we ﬁnd depend
only marginally on the algorithm used.

i]/qh[a(τ )

(t), . . . , e(τ )

(t) − ha(τ )

i]2i.

i

i

i

i

[25] Labels are sorted with respect to their contribution to the log-
i = 3 means that asset i belongs to the third

likelihood. E.g. s(τ )
most relevant cluster at time-horizon τ .

