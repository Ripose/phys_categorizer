6
0
0
2
 
b
e
F
 
5
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
2
0
1
2
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

TRANSACTIONS OF THE
AMERICAN MATHEMATICAL SOCIETY
Volume 00, Number 0, Pages 000–000
S 0002-9947(XX)0000-0

UNIFYING THE BGM AND SABR MODELS:
A SHORT RIDE IN HYPERBOLIC GEOMETRY

PIERRE HENRY-LABORD`ERE

Abstract. In this short note, using our geometric method introduced in a previous paper [12]
and initiated by [4], we derive an asymptotic swaption implied volatility at the ﬁrst-order for a
general stochastic volatility Libor Market Model. This formula is useful to quickly calibrate a
model to a full swaption matrix. We apply this formula to a speciﬁc model where the forward
rates are assumed to follow a multi-dimensional CEV process correlated to a SABR process.
For a caplet, this model degenerates to the classical SABR model and our asymptotic swaption
implied volatility reduces naturally to the Hagan-al formula [11]. The geometry underlying this
model is the hyperbolic manifold Hn+1 with n the number of Libor forward rates.

1. Introduction

The BGM model [6, 15] has recently been the focus of much attention as it gives a theoretical
justiﬁcation for pricing caps-ﬂoors using the classical Black-Scholes formula. The basic (physical)
random variables are given by the Libor forward rates which are assumed to follow a correlated
log-normal process. As the forward swap rate model implied by the BGM is quite complicated
(the swap forward rate is not log-normally distributed), the calibration to the swaption matrix
is diﬃcult. Asymptotic swaption implied volatility (at the zero-order) were initially derived by
Rebonato [18] and Hull-White [9] for the (log-normal) BGM model. Such formula has been obtained
by assuming that the ratio of a forward Libor rate over the swap rate and the derivative of the swap
rate according to a forward Libor rate are almost constant (and therefore equal to their values at
the spot).

Despite its great success, the BGM model presents the same drawbacks as the classical Black-
Scholes theory: As the forward rates follow a correlated log-normal process, the model is not
able to calibrate the full swaption matrix in/out-the money (in particular the caplets) and give
a good dynamics to the Libor rates. The incorporation of a swaption smile can be obtained by
introducing more elaborated models which should be ﬂexible enough to calibrate caplets and a grid
of swaption volatilities (not necessary at the money) across all swaption expiries and underlying
swap maturities. One property that these models must still share is their ability to quickly calibrate
the swaption matrix without using complicated numerical routines such as Monte-Carlo simulation
which are usually noisy and time-consuming.
In this context, Andersen-Andreasen introduced
the CEV Libor Market Model (LMM) [1] which assumes that each forward rate follows a CEV
process, and showed how to obtain asymptotic swaption smile. Their method is still based on the
Rebonato ”freezing” argument which is not completely mathematically justiﬁed. Recently, for this
speciﬁc model, Kawai found a better asymptotic formula using the Wiener chaos expansion [16].

Key words and phrases. Heat Kernel expansion, Hyperbolic Geometry, Asymptotic Smile Formula, Stochastic

Libor Market Model.

1

©1997 American Mathematical Society

2

PIERRE HENRY-LABORD `ERE

Although giving more ﬂexibility than the BGM model, the CEV LMM model is still not able to
calibrate the swaption matrix for in/out strike and in this context, we are naturally led to use
stochastic volatility LMM. The literature on this subject is not particularly large. Andersen-al
introduced a LMM where the Libors follow a multi-dimensional correlated CEV process coupled
(but uncorrelated) to a Heston model [2, 3] and recently V. Piterbarg modiﬁes this model to
incorporate term structure [17]. Using an averaging principle, V. Piterbarg derives an asymptotic
volatility. Note that as these models are uncorrelated to the stochastic volatility, the swaption fair
value is simply given by the fair price in the case of a local volatility model conditional to the
stochastic volatility process as explained by the Hull-White decomposition [10]. An asymptotic
expression can then be generated by approximating the moments of the volatility process[2].

For pricing exotic options (such as bermudan swaptions for example), it is simpler or more natural
to model directly the forward swap rate with a stochastic volatility process. For example, the
SABR model [11] was introduced to fulﬁll his goal. An asymptotic swaption smile formula (at the
ﬁrst-order) was derived for this speciﬁc model and help to calibrate quickly the model to liquid
market data. In this context, it is natural to try to reconcilate/unify the two benchmark models,
the BGM and SABR models. We therefore introduce a LMM where the forward rates follow a
multi-dimensional CEV process (with one beta for each forward) correlated to a SABR model.
As it is the case for the SABR model, we impose that the libors are correlated to the unique
volatility and it is therefore not possible to follow the Andersen-al [3] method (i.e. the Hull-White
decomposition) to derive an asymptotic swaption smile.

In this paper, we pursue our previous work on the application of the heat kernel expansion on
a Riemannian manifold endowed with an Abelian connection [12] to derive an asymptotic smile
formula for a swaption. The plan of this paper is as follows: In the ﬁrst part, we will recall some
deﬁnitions and present a list of recent Libor Market Models. In the second part, we apply this heat
kernel expansion to derive an asymptotic swaption smile formula at the ﬁrst-order valid for any
LLM. In the third part, we present our stochastic LMM and apply this general formula. We will
prove that the geometry underlying this model is the hyperbolic manifold Hn+1. Some important
properties of this space are then presented. Furthermore, we show that the ”freezing” argument
is no longer valid when we try to price a swaption in/out the money: The libors should in fact be
frozen to the saddle-point (constrained on a particular hyperplane) which minimizes the geodesic
distance on Hn+1.

2. Libor Market Model

A swaption gives the right, but not the obligation, to enter into an interest rate swap at a
pre-determined rate on an agreed future date [7]. The maturity date for the swaption is noted Tα
and Tβ is the expiry for the forward swap rate sαβ given by

(2.1)

sαβ(t) =

1

−
β
i=α+1 τ
Q

β
j=α+1
i
j=α+1

1
(1+τ Fj (t))

1
(1+τ Fj (t))

P

Q

with τ the tenor and Fk(t)

F (t, Tk−1, Tk) is the forward rate resetting at Tk−1.

≡

As the product of the bond P (t, Tk) with the forward rates Fk(t) is a diﬀerence of two bonds
with maturity Tk−1 and Tk, 1
P (t, Tk), and therefore a traded asset, Fk is a (local)
martingale under Qk, the (forward) measure associated with the num´eraire P (t, Tk). Therefore,

τ (P (t, Tk−1)

−

UNIFYING THE BGM AND SABR MODELS

3

we assume the following driftless dynamics

(2.2a)

dFk(t) = σk(t)Φk(a, Fk)dWk ,

Tk−1 , k = 1,

, n

t
∀

≤

· · ·

dWkdWl = ρkl(t)dt
(2.2b)
with the initial conditions a(t = 0) = α and Fk(t = 0) = F 0
k .

Libor market model
BGM
CEV
Limited CEV

Shifted log-normal

FL-SV

FL-TSS

SDE
dFk = σk(t)FkdWk
dFk = σk(t)F β
k dWk

dFk = σk(t)Fkmin(F β−1

, ǫβ−1)dWk

k

with ǫ a small positive number
dXk = σ(t)XkdWk
with Fk = Xk + α

dFk = σk(t)(βFk + (1
dv = λ(v

k )√vdWk
¯λ)dt + ν√vdZ ; dWkdZ = 0

−

β)F 0

−
dFk = σk(t)(βk(t)Fk + (1

¯λ)dt + ν√vdZ ; dWkdZ = 0

−

βk(t))F 0

k )√vdWk

dv = λ(v

−

Table 1. Examples of stochastic (or local) volatility Libor models.

In order to achieve some ﬂexibility, we assume that the (normal) local volatility Φk(a, Fk) depends
on a hidden Markov process a (to be speciﬁed later) representing a stochastic volatility. We
therefore assume that all the forward rates are coupled with the same stochastic volatility a.
(Table 1) presents a list of the diﬀerent functional forms for φk used in the literature. The BGM,
(limited) CEV and shifted log-normal models correspond to local volatility models (a = 1) and
the others to stochastic volatility models with a unique stochastic volatility a driven by a Heston
process. Note that the stochastic diﬀerential equation for the libors Lk has been written in the
forward measure Qk and the stochastic equation for a remains the same in the forward or forward
swap rate measures as a is assumed to be uncorrelated with the Libor rates. This will not be the
case in our LLM.

3. Asymptotic Swaption Smile

The forward swap rate satisﬁes the following driftless dynamics in the forward-swap measure Qαβ
β
i=α+1 τiP (t, Ti))
(associated to the num´eraire Cαβ (t) =

(3.1)

dsαβ =

σk(t)φk(a, Fk)dZk

β
P

∂sαβ
∂Fk

Xk=α+1

with ∂sαβ
∂Fj

= sαβ τj

(1+τj Fj ) (

P (t,Tα)
P (t,Tβ )−P (t,Tα) +

α−1
k=j τkP (t,Tk+1)

)

P

Cαβ

The local volatility associated to the forward swap rate (dsαβ = σαβ
tion

loc (sαβ, t)dWt) is then by deﬁni-

(3.2a)

(σαβ

loc )2(s, t)

Eαβ [

ρij(t)σi(t)σj (t)φi(a, Fi)φj(a, Fj )

∂sαβ
∂Fi

∂sαβ
∂Fj |

sαβ = s]

(3.2b)

ρij (t)σi(t)σj (t)

B φi(a, Fi)φj (a, Fj) ∂sαβ
∂Fi
i dFi

B pda

∂sαβ
∂Fj

R

pda

i dFi

Q

R

Q

≡

=

β

i,j=α+1
X

β

i,j=α+1
X

4

PIERRE HENRY-LABORD `ERE

with the submanifold B =
and p
i ) the conditional probability
satisfying the (backward) Kolmogorov equation associated to the SDE for the Libors and the
volatility a in the forward swap measure Qαβ. An asymptotic expression in the short time limit
for the local volatility σαβ(s, t) can be found in two steps: ﬁnd an asymptotic expansion for the
conditional probability p (in Qαβ) and do the integration over B.

p(a, Fi, t

sαβ = s

Fi}i|

α, F 0
|

{{

≡

}

3.1. First step: Heat Kernel expansion. As explained previously, the ﬁrst step can be achieved
using the heat kernel expansion. In that purpose, the Kolmogorov equation is rewritten as the heat
n+1 endowed with an Abelian
kernel equation on a (n + 1)-dimensional Riemannian manifold
connection as explained in [12, 13, 14]. Let’s assume that our multi-dimensional stochastic equa-
tions (in Qαβ) are written as

M

(3.3)

dxµ = bµ(x, t)dt + σµ(x, t)dW µ

with dW µdW ν = ρµν (t)dt (note that the indices 1,
, n (resp. n+1) correspond(s) to the forward
F i (resp. a)). Then, the metric gµν depends only on the diﬀusion terms σµ and the connection
Aµ on the drift terms bµ as well

· · ·

(3.4a)

gµν(x, t) = 2

, µ, ν = 1

n + 1 , ρµν

[ρ−1]µν

· · ·

≡

(3.4b)

µ(x, t) =

(bµ(x, t)

g− 1

2 ∂ν(g1/2gµν (x, t))) , µ = 1

A

1
2

n + 1

· · ·

ρµν(t)
σµ(x, t)σν (x, t)
n+1

−

ν=1
X

with g(x, t)
equation in the short-time limit is given by (x = (a, Fi), x0 = (α, F 0

det[gµν(x, t)]. In terms of these functions, the asymptotic solution to the Kolmogorov

≡

i ))

(3.5)

x0) =
p(x, t
|

∆(x, x0)

P

(x, x0)e− σ(x,x0 )

2t

an(x, x0)tn , t

0

→

g(x)

n
2

(4πt)
p

p

∞

n=1
X

•

Here, σ(x, x0) is the Synge world function equal to one half of the square of geodesic
distance d(x, x0) between x and x0 for the metric gµν(x, t = 0). This distance is deﬁned
as the minimizer of

(3.6)

d(x, x0)2 = minC

gµν(x, t = 0)

T

0
Z

dxµ
dt

dxν
dt

dt

and t parameterizes the curve
≡
∆(x, x0) is the so-called Van Vleck-Morette determinant

(x, x0) joining x(t = 0)

C

x0 and x(T )

x.

≡

•

(3.7)

(3.8)

∆(x, x0) = g(x, 0)− 1

2 det(

∂2σ(x, x0)
∂x∂x0

−

)g(x0, 0)− 1

2

with g(x, 0) = det[gµν(x, 0)]

• P

from the point x0 to x

(x, x0) is the parallel transport of the Abelian connection along the geodesic

(x, x0)

C

(x, x0) = e

R

P

C(x,x0 ) Aµ(x,t=0)dxµ

The ai(x, x0) (a0(x, x0) = 1) are smooth functions on M and depend on geometric invari-
ants such as the scalar curvature R. More details can be found in [12].

•

UNIFYING THE BGM AND SABR MODELS

5

3.2. Second step: Saddle-point method. The integration over B is obtained by using a saddle-
f (x)eǫφ(x)dx in the
point method which consists in approximating at the ﬁrst order the integral
limit ǫ small by [8]

f (x)eǫφ(x)dx

∼ǫ<<1

Z
(3.9)

f (x∗)eǫφ(x

)(1 +

∗

1
ǫ

(
−

∂αβf
2f

∂αβγφ∂δµν φ
72

−

Aαβ AγδAµν ))

Aαβ + (

∂βγδφ +

∂αβγδφ)Aαβ Aγδ

∂αf
2f

R

1
8

n
with Aαβ = [∂αβφ]−1, dx
i=1 dxi and x∗ the saddle-point (which minimizes φ(x)). This
expression can be obtained by developing φ(x) and f (x) in series around x∗. The quadratic part
in φ(x) leads to a Gaussian integration over x which can be performed.

Q

≡

3.2.1. Saddle-point. As the conditional probability at the zero-order is proportional to e− d(x,x0)2
,
the saddle-point corresponds to the point x = (a, Fi=1,··· ,n) on the submanifold sαβ = s which
minimizes the geodesic distance d(x, x0) [5, 4]

4t

(3.10)

(3.11)

(a∗,

F ∗
i }

)

{

(a,

Fi}

{

≡

) such as mina,{Fi}|sαβ =s[d(x, x0)2]

Introducing a Lagrange multiplier, λ, this is equivalent to

(a∗,

F ∗
i }

)

{

(a,

Fi}

{

≡

) such as mina,{Fi},λ[d2(x, x0) + λ(sαβ (F )

s)]

−

3.3. Asymptotic local volatility. Plugging our asymptotic expression for the conditional prob-
ability (3.5) into (3.9), we ﬁnally obtain the local volatility at the ﬁrst-order

(σαβ

loc )2(s, t) =

ρij (t)σi(t)σj (t)fij (F ∗, a∗)(1 + 2t

Aµν ((

∂µν fij(F ∗, a∗)
fij(F ∗, a∗)

∂µfij(F ∗, a∗)
fij(F ∗, a∗)

∂νψ(F ∗, a∗)
ψ(F ∗, a∗)

)

n+1

µ,ν=1
X

n

i,j=1
X

(3.12)

+ 2

n+1

−

Xγ,δ=1

Aγδ ∂µfij(F ∗, a∗)
fij(F ∗, a∗)

∂νγδd2))

with fij(F, a) = a2Ci(Fi)Cj(Fj ) ∂sαβ
∂Fi

∂sαβ
∂Fj

, ψ(F, a) = √g∆

and Aµν = [∂µνd2]−1.

P

Note that as opposed to other asymptotic methods presented in the literature, this formula is exact
at t = 0. The zero-order formula (independent of the time t for σi(t), ρij(t) constant) was derived
for a general multi-dimensional local volatility model by [4, 5]. Moreover, in the expansion, we
assumed that time is small but we made no assumption that Fk is close to the spot libor or that
the volatility of volatility is small.

3.4. Asymptotic Smile. The asymptotic smile can be derived in two steps from the asymptotic
local volatility: ﬁrst, we have

(3.13)

(3.14)

ds =

σαβ
loc (s, t)
σαβ
loc(s0, t)

σαβ
loc(s0, t)dWt

t

0 σαβ
R
dsαβ = ¯σαβ

loc(s, t)dW ′

t

and doing a change of local time t′ =
model for the swap rate

loc (s0, u)2du, we now obtain the associated local volatility

6

PIERRE HENRY-LABORD `ERE

with ¯σαβ

loc (s, t) = σαβ
σαβ

loc(s,t)
loc(s0,t)

.

Secondly, we know that there is a one-to-one correspondence between this local volatility and the
¯σαβ
loc(s, t = 0))
smile [12] given at the ﬁrst-order by (C(f )

σαβ
BS(K, Tα) =

Tα

0 σαβ

loc(s0, u)2du

s

R

T

C2(fav)

(1 +

T

0 σαβ
loc (s0, u)2du
24
R

(2

C′′(f )
C(fav) −

(

C′(fav)
C(fav)

)2 +

1
f 2
av

≡

ln( K
)
s0
df ′
K
C(f ′)
s0

(3.15)

+12

∂t¯σαβ

loc (fav, t = 0)
R
)
|fav = s0+K
C3(fav)

2

)

4. SABR-LMM model

We have seen that the asymptotic local and implied volatilities can be computed if we know the
n+1. This is the case for the
geodesic distance and a parametrization of geodesic curves on
hyperbolic space Hn for all n. This manifold has a lot of important properties. As such, it appears
to be the perfect toy model (usually its Lorentzian version AdS/dS) in a number of domain:
chaos, cosmology, string theory, .... In the ﬁrst part, we present our BGM-LLM-SABR model and
show that the underlying geometry is Hn+1 (with n the number of forward Libor rates). Using
this connection, we will ﬁnd an asymptotic local volatility and an asymptotic swaption implied
volatility.

M

4.1. Dynamics. We introduce the model SABR-LMM, given by the following SDE under the
spot Libor measure Q (associated to the num´eraire Bd(t) =
1))P (t, Tβ(t)−1)
where β(t) = m if Tm−2 < t < Tm−1)

(1 + τjFj (Tj −

β(t)−1
j=1

Q

dFk = a2Bk(F, t)dt + σk(t)aCk(Fk)dZk
da = νadZn+1; , dZidZj = ρij(t)dt i, j = 1,

, n + 1

· · ·

Ck(Fk) = φkF βk
k

Bk(F, t) =

k

Xj=β(t)

τjρjkσk(t)σj (t)Ck(Fi)Ci(Fk)
(1 + τjFj )

The functions Ck(Fk) have been scaled by φk and therefore we can impose that σk(0) = 0. The
stochastic equation for a was written in the spot Libor measure in order to get a SDE of a speciﬁc
underlying swap sαβ or a forward bond. Under the forward swap measure Qαβ, we have

(4.4a)

(4.4b)

dFk = a2bk(F, t)dt + σk(t)aCk(Fk)dZk
da =

ν2a2ba(F, t) + νadZn+1; , dZidZj = ρij (t)dt i, j = 1,

−

, n + 1

· · ·

(4.1a)
(4.1b)

with

(4.2)

(4.3)

UNIFYING THE BGM AND SABR MODELS

7

a, b, c, d, φi, ρL, δA, δB

BGM parameters
Cev parameters
, n,
SABR parameters
Table 2. SABR-LMM: 9 + 3n parameters

βi, i = 1,
· · ·
α, ν, ρia i = 1,

· · ·

, n

with

(4.5)

bk(F, t) =

(21j≤k −

1)τj

P (t, Tj)
Cαβ (t)

max(k,j)

Xi=min(k+1,j+1)

τiρkiσi(t)σk(t)Ci(Fi)Ck(Fk)
(1 + τiFi)

β

j=α+1
X
β

i=α+1
X
β

i=α+1
X

(4.6)

Cαβ (t) =

τiP (t, Ti)

(4.7)

ba(F, t) =

τiωi(t)

τkCk(Fk)ρkaσk(t)
1 + τkFk(t)

i

Xk=1

and with ωi(t) =

i
k=1

β
Q
j=α+1

1
(1+τk Fk )
j
1
k=1
(1+τk Fk )

Note that the forward-rate dynamics under the forward measure Qk is much simpler and given by
the following stochastic diﬀerential equations (SDE)

P

Q

(4.8)

dFk(t) = σk(t)aCk(Fk)dWk , dWkdWp = ρkp(t)dt

As it is the case for the BGM model, we can use a piecewise parametric form or a functional form
for the serial volatilities σi(t) and the correlation ρij(t) (here full rank) as

(4.9)

(4.10)

σi(t) = Ni[(a(Ti−1 −

t) + d)e−b(Ti−1−t) + c]

t
∀

≤

Ti−1

ρij (t = 0) = ρL + (1

ρL)e−(δA−δB min[Ti−1,Tj−1])|Ti−1−Tj−1|

−

The constants Ni are ﬁxed such as σi(0) = 0. The model depends on 9 + 3n parameters (see Tab.
2) which are calibrated on the swaption matrix. In the next subsection, we derive the metric, the
geodesic distance and the Abelian connection underlying this model.

4.2. Hyperbolic geometry. By deﬁnition, the inﬁnitesimal distance (at t = 0) between the point
xα and xα + dxα (3.4a) (ds2 =
, n)
and ρia

[ρ−1]ia are the components of the inverse of the correlation matrix ρ)

n+1
α,β=1 gαβdxαdxβ) is given by (ρij

[ρ−1]ij , (i, j) = (1,

· · ·

≡

≡

(4.11)

ds2 =

P
ρij νdFi
Ci(Fi)

n

2
ν2a2 (

i,j=1
X

νdFj
Cj(Fj )

+ 2

ρia νdFi
Ci(Fi)

da + ρaada2)

n

i=1
X

After some algebraic manipulations, we show that in the new coordinates [xk]k=1···n+1 (L is the
Cholesky decomposition of the (reduced) correlation matrix: [ρ]i,j=1···n = [ ˆL ˆL†]i,j=1···n)

(4.12)

(4.13)

xk =

n

ν ˆLki

i=1
X

n

Fi

dF ′
i
Ci(F ′
i )

+

F 0
i

Z

n

i=1
X

xn+1 = (1

ρiaρjaρij )

1
2 a

−

i,j
X

ρia ˆLika , k = 1,

, n

· · ·

the metric becomes

8

(4.14)

PIERRE HENRY-LABORD `ERE

ds2 =

2(1

−

n
i,j ρiaρjaρij )
ν2

i + dx2

n+1

n
i=1 dx2
x2

n+1

P

P

Written in the coordinates [xi], the metric is therefore the standard hyperbolic metric on Hn+1
(modulo a constant factor
). In order to compute our saddle-point (3.11), we
need the geodesic distance which is given by [19]

i,j,k=1 ρiaρja ρij )

2(1−

ν2

P

n

Proposition 4.2.1. The geodesic distance d(x, x′) on Hn+1 is given by

(4.15)

d(x, x0) = cosh−1[1 +

n+1

i=1 (xi −
2xn+1x0

n+1

i )2
x0

]

P

Using the geodesic distance on Hn+1 between the points x = (
{
x0 = (
{

i ) ) given by

F 0

}k, α) (qi =
√2(1

−

P

Fi
F 0
i

′
dF
i
Ci(F ′
n
R
i,j ρiaρjaρij)
ν

1
2

d(x, x0) =

cosh−1[1 +

ν2

n
i,j=1 ρijqiqj + 2ν

n
j=1 ρjaqj + (a

P

2(1

−

n
i,j=1 ρiaρjaρij)aα

P

α)2

]

−

F

}k, a) and the initial point

we derive the following non-linear equations (3.11) satisﬁed by the saddle-point a∗(s), q∗
implicitly depends on s, the swaption strike:

P

i (s) which

a∗(s) =

α2 + 2ν

ρiaq∗

i + ν2

ρij q∗

i q∗
j

n

i=1
X

n

i,j=1
X

v
u
u
t

(2νρia + 2

ν2ρijq∗
j )

n

j=1
X

d(a∗,

{
a∗(s)(cosh(d(a∗,

q∗
)
i }
q∗
i }
{

))2

1
2

1)

−

=

λα(1

−

−

ρpaρqaρpq)

∂sαβ
∗
∂qi |

n

p,q=1
X

cosh(d(a∗,

q∗
i }

{

) = 1 +

(1

−

i = φ−1
q∗

i

(

1−βi

F ∗
i

(1

−
−

F ∗
i
F 0
i

i = φ−1
q∗

i

ln(

) , βi = 1

a∗(s)
α
n
i,j=1 ρiaρjaρij )α

−

P

F 0
i
βi)

1−βi

) , βi 6

= 1

The saddle-point is determined by solving these non-linear equations (4.16) and an approximation
(which could be used as a guess solution in a numerical optimization routine) is found by linearizing
these equations around the spot Libor rates (i.e. qi = 0)

λ∗(s)α2 = −
−

(1

−

−

2ν

2ν2(s
s0)
n
p,q=1 ρpaρqaρpq)
P
n
j=1 ρij ωj(s

s0)
P
n
p,q=1 ωpωqρpq

−

P
q∗
i (s) =

P

P

n
j=1 ρij ρjaωj

n
i,j=1 ρij ωiωj

+ o((s

s0)2)

−

+ o((s

s0)2)

−

with ωi ≡
close to the spot Libors and a∗ = α.

∂sαβ
∂qi

(qi = 0). Note that when the strike is close to at-the-money, the saddle-points are

(4.16a)

(4.16b)

with

(4.17)

and with

(4.18)

(4.19)

(4.20a)

(4.20b)

UNIFYING THE BGM AND SABR MODELS

9

Moreover, by using the explicit expression for the hyperbolic distance, the Van-Vleck-Morette
determinant is

(4.21)

∆(F, a, α) =

d(a, F

α)
|
cosh2(d(a, F

α))
|

−

1

p

4.3. Connection. The Abelian connection is given by (3.4b) 1

n

1
Ci(Fi)

[

ρij (

bj(F, t)
Cj(Fj ) −

∂jCj(Fj )
2

)

−

νρiaba(F, t)]

bj(F, t)
Cj (Fj) −

∂jCj (Fj)
2

)

−

νρaaba(F, t)]

Ai =

Aa =

j=1
X
ρaj(

n

1
ν

[

j=1
X

(4.24)

(4.25)

(4.26)

where we have used that

√g =

2
νa2

n+1

2 det[ρ]− 1

2

n
i=1 Ci(Fi)

Q

Finally, the Abelian 1-form connection is
n

n

=

A

1
ν

[(

bj(F, t)
Cj (Fj) −

∂jCj(Fj )
2

)(ν

j=1
X

i=1
X

ρijdqi + ρajda)]

ba(F, t)(ν

ρiadqi + ρaada)

−

n

i=1
X

In order to compute the log of the parallel gauge transport ln(
, we need to know
a parametrization of the geodesic curve on Hn+1. However, we can directly ﬁnd ln(
α) if we
|
approximate the drifts bk(F, t) by their values at the Libor spots (and t = 0). A similar approxi-
mation was done in the Hagan-al formula [11] as was shown in [12]. Modulo this approximation,

C A
R

α) =
|

)(a, q

)(a, q

P

P

ln(

)(a, q

P

α)
|

∼

[(

bj(F 0, 0)
Cj(F 0

j ) −

∂jCj(F 0
j )
2

)(ν

1
ν

n

j=1
X

n

i=1
X

ρij qi + ρaj(a

α))]

ba(F 0, 0)(ν

ρiaqi + ρaa(a

α))

−

−

−

n

i=1
X

4.4. Asymptotic Smile-Summary. The asymptotic local volatility is given by (3.12)

(σαβ

loc )2(s, τ ) =

ρijσi(t)σj(t)fij (a, F )(1 + 2τ

n+1

µ,ν=1
X

Aµν ((

∂µν fij(a, F )
fij(a, F )

+ 2

∂µfij(a, F )
fij(a, F )

∂ν ψ(a, F )
ψ(a, F )

)

−

Aγδ ∂µfij(a, F )
fij(a, F )

∂νγδd2(a, F )))

|(a,F )=(a∗(s),F ∗(s))

n

i,j=1
X
n+1

Xγ,δ=1

with (a∗2(s),
and

F ∗
i }i(s)) the saddle-point satisfying the equations (4.16) and approximated by (4.20)

{

1

(4.22)

(4.23)

Ai =

Aa = −

Ci∂iCi)

a2
2

(bi − 1
2
ν2a2ba(F, t)
2

fij(a, F ) = a2Ci(Fi)Cj (Fj )

, ψ(a, F ) =

g∆

, Aαβ = [∂αβd2]−1

10

PIERRE HENRY-LABORD `ERE

∂sαβ
∂Fj

∂sαβ
∂Fi
n
i,j ρiaρjaρij)
ν

1
2

√2(1

−

1
ν

n

[(

j=1
X

P
bj(F 0, 0)
Cj(F 0

j ) −

∂jCj (F 0
j )
2

)(ν

n

i=1
X

d(a, F

α)
|
cosh2(d(a, F
2 det[ρ]− 1

n+1

2

n
i=1 Ci(Fi)

2
p
νa2

α))
|

−

1

d(a, F ) =

ln(

)(a, q

P

α)
|

∼

∆(F, a, α) =

√g =

P

2(1

p

ν2

P

cosh−1[1 +

n
i,j=1 ρij qiqj + 2ν

n
j=1 ρjaqj + (a

α)2

]

−

ρijqi + ρaj(a

ba(F 0, 0)(ν

ρiaqi + ρaa(a

α))

−

n
i,j=1 ρiaρjaρij)aα
n

P

−

−

P
α))]

−

i=1
X

Note that this expression is exact when τ goes to zero. The smile at the ﬁrst-order is then obtained
by plugging the above expression into (3.15).

Q

Remark 4.4.1 (Libor CEV model). Note that our model for ν goes to zero (and α
1) gives the
Andersen-Andreasen CEV libor model (with diﬀerent CEV parameters for each libors) and the
above expressions degenerates into

≡

(4.27)

(4.28)

(4.29)

(4.30)

(4.31)

fij (F ) = Ci(Fi)Cj (Fj)

∂sαβ
∂Fi

∂sαβ
∂Fj

d(F ) =

ln(

)(q) =

P

∆(F, F 0) = 1

n

ρijqiqj

i,j=1
X
bj(F 0, 0)
Cj(F 0

(

j ) −

2
v
u
u
t
n

j=1
X

√g =

2

n

2

2 det[ρ]− 1
n
i=1 Ci(Fi)

∂jCj(F 0
j )
2

)

ρijqi

n

i=1
X

with the saddle-points (4.16) satisfying the non-linear equations (modulo the constraint sαβ = s)
λ
4

∂sαβ
∗
∂qi |

(4.32)

ρijq∗

j =

−

Q

4.5. Comments and Numerical Tests. It is interesting to note that for n = 1, i.e. for a caplet,
the caplet asymptotic smile reduces to the classical SABR formula by construction.

Moreover, the asymptotic local volatility is given at the zero-order by

(σαβ

loc)2(s, t) =

ρij(t)σi(t)σj (t)a∗2(F ∗)Ci(F ∗

i )Ci(F ∗
i )

∂sαβ
∂Fi

(F ∗)

(F ∗)

∂sαβ
∂Fj

n

i,j=1
X

with F ∗ depending implicitly on s via (4.16). At this stage, it is useful to recall how a similar
asymptotic local volatility is derived using the ”freezing” argument. The forward swap rate satisﬁes
the following SDE in the forward swap num´eraire Qαβ

(4.33)

dsαβ =

σk(t)aCk(Fk)dZk

∂sαβ
∂Fk

n

Xk=1

UNIFYING THE BGM AND SABR MODELS

11

The ”freezing” argument consists in assuming that the terms ∂sαβ
∂Fk
Therefore, the SDE (4.33) can be approximated by

and C(s)

C(Fi) are almost constant.

(4.34)

dsαβ =

(F 0)σk(t)a

Ck(s)dZk

∂sαβ
∂Fk

n

Xk=1

Ck(F 0
k )
Ck(s0)

and the local volatility is

(σαβ

loc )2(s, t) =

ρij (t)σi(t)σj (t)a∗2(s)

Ci(F 0
i )
Ci(s0)

Cj(F 0
j )
Ci(s0)

∂sαβ
∂Fi

(F 0)

∂sαβ
∂Fj

(F 0)Ci(s)Cj (s)

n

i,j=1
X

We can reproduce this formula for the swaption smile at-the-money 2 as the saddle-point Libor
rates coincides with the spot rates. This is not the case for in/out-the-money swaption. Therefore
our expression (exact at the zero-order) shows that the freezing argument is no longer correct
when we try to ﬁt a swaption implied smile in/out-the-money. In the following, we have tested
our asymptotic swaption formula at the zero-order (Formula F1) against the Andersen-Andreasen
asymptotic formula (Formula F2) [1] in the case ν = 0. The accuracy of these approximations
are examined using Monte-Carlo (MC) prices as a benchmark. Following [16], we consider ﬁve
scenarii (see Tables 3-4-5-6-7). In the following tables, the implied volatility is reported and the
numbers in brackets are the errors (in basis points i.e. true volatility times 104) corresponding to
the implied volatility computed using the F1 or F2 formula minus the MC implied volatility. An
x
y swaption has an option maturity of x years, a swap length of y years and a tenor of one year.
We set a time-step for Monte-Carlo δ = 0.125 and 216 paths 3. Our formula F1 is more accurate
than F2.

×

Swaption

5

15

×

10

10

×

F1

MC

F2
strike
22.61% (19)
22.42% 22.41% (-1)
4%(ITM)
20.46% (13)
6%(ATM)
20.33% 20.41% (8)
19.01% (10)
8%(OTM) 18.92% 18.93% (1)
22.41% 22.51% (11) 22.67% (26)
4%(ITM)
20.50% (12)
6%(ATM)
20.38% 20.41% (3)
19.05% (12)
8%(OTM) 18.93% 18.93% (-1)

Table 3. Scenario A: Libor volatility λi(t) = 5%. Libor Li(0) = 6%. β = 0.5

5

×

15

F1

MC

Swaption

F2
Strike
18.12% 18.20% (8)
18.17% (5)
5.08%(ITM)
16.51% 16.61% (10) 16.63% (12)
7.26%(ATM)
15.56% (18)
15.38% 15.38% (0)
9.44%(OTM)
17.89% (9)
17.80% 17.81% (1)
5.55%(ITM)
16.38% (11)
7.93%(ATM)
16.26% 16.33% (7)
15.32% (15)
10.31%(OTM) 15.17% 15.19% (2)
Table 4. Scenario B: Libor volatility dLi = 0.25(0.17 + 0.002(Ti−1 −
Libor Li(0) = log(a + bi), L0(0) = 5%, L19(0) = 9% . β = 0.5

10

10

×

t))Lβ

i dW .

2An at-the-money swaption (ATM) has a strike K equal to the spot rate sαβ (0) and an out-of-the money (OTM)

(resp. in-the-money (ITM)) swaption has K < sαβ(0) (resp. K > sαβ(0)).
3We have used a predictor-corrector scheme with a Brownian bridge.

12

PIERRE HENRY-LABORD `ERE

Swaption

5

15

×

10

10

×

F1

MC

Strike
14.89% 14.97% (8)
5.08%(ITM)
13.73% 13.79% (4)
7.26%(ATM)
12.92% 12.91% (-1)
9.44%(OTM)
14.52% 14.53% (1)
5.55%(ITM)
7.93%(ATM)
13.33% 13.38% (5)
10.31%(OTM) 12.51% 12.51% (0)

F2
15.08% (19)
13.81% (8)
12.92% (0)
14.64% (12)
13.40% (7)
12.54% (3)
0.002(Ti−1 −

Table 5. Scenario C: Libor volatility dLi = 0.25(0.17
Libor Li(0) = log(a + bi). L0(0) = 5%, L19(0) = 9%. β = 0.5

−

t))Lβ

i dW .

5

×

15

F2

F1

MC

Swaption

Strike
19.19% 19.33% (14) 19.38% (19)
5.08%(ITM)
17.59% 17.72% (13) 17.75% (16)
7.26%(ATM)
16.61% (15)
16.46% 16.49% (3)
9.44%(OTM)
19.06% (14)
18.92% 18.94% (2)
5.55%(ITM)
17.45% (14)
7.93%(ATM)
17.31% 17.39% (8)
10.31%(OTM) 16.18% 16.21%(3)
16.32% (14)
Table 6. Scenario D: dLi = 0.05Lβ
i (

bi2(t)
√bi1(t)2+bi2(t)2
ρ2e−k1(Ti−1−t). ρ = 0.99,
0.99, k1 = k2 = 0.54. Libor Li(0) = log(a + bi). L0(0) = 5%, L19(0) = 9%.

bi1(t) = ρe−k1(Ti−1−t) + θe−k2(Ti−1−t), bi2(t) =
θ =
β = 0.5

bi1(t)
√bi1(t)2+bi2(t)2
1

dW1 +

dW2).

10

10

p

−

×

−

Swaption

5

15

×

10

10

×

F1

MC

F2
Strike
34.24%(115)
33.09% 33.65% (56)
5.08%(ITM)
30.23%(76)
29.47% 29.96% (49)
7.26%(ATM)
27.49% (57)
26.92% 27.14% (22)
9.44%(OTM)
31.75% 32.41% (66) 33.33% (158)
5.55%(ITM)
29.37%(91)
7.93%(ITM)
28.47% 28.88% (41)
26.68% (67)
10.31%(OTM) 26.01% 26.18% (17)

Table 7. Scenario E: Scenario D with β = 0.3

In [12], we explained how to derive a general asymptotic smile for any stochastic volatility model
using this geometric framework. As an application, we derived an asymptotic smile for a SABR
model with a mean-reversion term. In the following, we try to consider some natural extensions
of our SABR-BGM model where we add a non trivial drift to the volatility process. The only
modiﬁcation comes from the expression of the Abelian connection.

4.6. Extensions. Under the spot Libor measure, we assumed that the volatility follows the process

(4.35)

da =

νa2ψa(a)dt + νadZn+1

−

UNIFYING THE BGM AND SABR MODELS

13

with ψa(a) a general analytical function of a (the scaling a2 in front of ψa(a) has been put for
convenience). After some algebraic computations, we derive the new Abelian 1-form connection

=

A

1
ν

[(

bj(F, t)
Cj (Fj ) −

∂jCj(Fj )
2

)(ν

n

j=1
X

n

i=1
X

ρij dqi + ρajda)]

(ba(F, t) + ψ(a))(ν

ρiadqi + ρaada)

−

n

i=1
X
ψa(α), we obtain for

Using a similar approximation as before, i.e. Cj (Fj)
the parallel gauge transport

∼

Cj (F 0

j ) and ψa(a)

∼

ln(

)(a, q

P

α)
|

∼

1
ν

n

j=1
X

[(

bj(F 0, 0)
Cj (F 0

j ) −

∂jCj (F 0
j )
2

)(ν

n

i=1
X

(4.36)

+ ψ(α))(ν

ρiaqi + ρaa(a

α))

−

n

i=1
X

ρijqi + ρaj(a

α))]

(ba(F 0, 0)

−

−

Finally, the smile is obtained using our general formula (3.15). Note that the metric and the
geodesic equations remain unchanged when we only modify the drift terms.

In this short note, we have introduced a LMM model coupled to a SABR stochastic volatility
process. By using the heat kernel expansion technique in the short time limit, we have obtained
an asymptotic swaption implied volatility at the ﬁrst-order, compatible with the Hagan-al classical
formula for caplets. Moreover, we have seen that this exact expression (when the expiry is very
short) is incompatible with the analog expression obtained using the freezing argument.

5. Conclusion

References

[1] Andersen, L. and Andreasen, J. (2000) : Volatility Skews and Extensions of the Libor Market Model, Applied

Mathematical Finance 7(1):1-32.

[2] Andersen, L. and Andreasen, J. : Volatile volatilities, Risk 15(12), December 2002.
[3] Andersen, L., Brotherton-Ratcliﬀe, R. : Extended Libor Market Models with Stochastic Volatility, Working

[4] Avellaneda, M., Boyer-Olson, D., Busca, J., Fritz, P. : Reconstructing the Smile, Risk magazine, October 2002.
[5] Berestycki, H., Busca, J., Florent, I. : Asymptotics and Calibration of Local Volatility Models, Quantitative

[6] Brace, A., Gatarek, D., Musiela, M. : The Market Model of Interest Rate Dynamics, Mathematical ﬁnance,

Paper, ssrn.

ﬁnance, 2:31-44, 1998.

7:127-154, 1996.

[7] Brigo, D., Mercurio, F. : Interest Rate Models, Theory and Practice, Springer Finance.
[8] Erd´ely, A. : Asymptotic Expansions, Dover, 1956.
[9] Hull, J., White, A. : Forward Rate Volatilities, Swap Rate Volatilities, and the Implementation of the Libor

Market Model, Journal of Fixed Income, 3, pp. 46-62.

[10] Hull, J., White, A. : The pricing of Options on Assets with Stochastic volatilities, The Journal Finance, 42,

281-300.

2002.

(2004).

[11] Hagan, P., Kumar, D., Lesniewski, A., Woodward, D. : Managing smile risk, Willmott Magazine pages 84-108,

[12] Henry-Labordere, P : A General Asympotic Implied Volatility for Stochastic Volatility Models, April 2005,

http://ssrn.com/abstract=698601.

[13] Henry-Labordere, P : Stochastic Volatility Model and Hyperbolic Geometry, Working paper Barclays Capital

[14] Henry-Labordere, P: Solvable Local and Stochastic Volatility Models: Supersymmetric Methods in Option

Pricing, July 2005, http://ssrn.com/abstract=773568.

[15] Jamshidian, F. : Libor and Swap Market Models and Measures, Finance and Stochastics, 1(4):293-330 (1997).
[16] Kawai, A. : A New Approximate Swaption Formula in the Libor Model Market: an Asymptotic Approach,

Applied Mathematical Finance, 2003, vol. 10, issue 1, pages 49-74.

14

PIERRE HENRY-LABORD `ERE

[17] Piterbarg, V. : A Stochastic Volatility Forward Libor Model with a Term Structure of Volatility Smiles, ssrn.
[18] Rebonato, A. : On the Pricing Implications of the Joint Lognormal Assumption for the Swaption and Cap

Markets, Journal of Computational Finance 3(3):5-26.

[19] Terras, A. : Harmonic Analysis on Symmetric Spaces and Applications, Vols. I, II, Springer-Verlag, N.Y., 1985,

1988.

Soci´et´e G´en´erale, Equity Derivatives Research, Paris, France.

E-mail address: pierre.henry-labordere@sgcib.com

