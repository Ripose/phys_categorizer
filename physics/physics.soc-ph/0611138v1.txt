6
0
0
2
 
v
o
N
 
4
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
8
3
1
1
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The continuous time random walk formalism
in ﬁnancial markets

Jaume Masoliver, Miquel Montero, Josep Perell´o,

Departament de F´ısica Fonamental, Universitat de Barcelona, Diagonal, 647,
08028-Barcelona, Spain

and George H. Weiss

1105 N. Belgrade Rd. Silver Spring, Md. 20902, U.S.A.

Abstract

We adapt continuous time random walk (CTRW) formalism to describe asset price
evolution and discuss some of the problems that can be treated using this approach.
We basically focus on two aspects: (i) the derivation of the price distribution from
high-frequency data, and (ii) the inverse problem, obtaining information on the
market microstructure as reﬂected by high-frequency data knowing only the daily
volatility. We apply the formalism to ﬁnancial data to show that the CTRW oﬀers
alternative tools to deal with several complex issues of ﬁnancial markets.

Key words: continuous time random walk, volatility, ﬁnancial markets, market
microstructure

1 Introduction

The continuous time random walk (CTRW), ﬁrst introduced by Montroll and
Weiss (1965), has become a widely-used tool for studying the microstruc-
ture of random process appearing in a large variety of physical phenomena.
These range from transport in disordered media (e.g., Montroll and Shlesinger
1984), earthquake modelling (e.g., Helmstetter and Sornette 2002) and even
solar surface kinetics (e.g., Lawrence et al. 2001), to name just a few. This
article extends the ﬁelds of application of the CTRW analysis by including the
dynamics of ﬁnancial markets. In this way, we aim to introduce the CTRW
approach to the ﬁnancial mathematics community where, to our knowledge,
this formalism has been barely explored.

Preprint submitted to Elsevier

2 February 2008

As its name suggests, the CTRW generalizes simple random walk models. Al-
though the term “random walk” was coined by Pearson (1905), the formalism
had been formulated in the seventeenth century in the context of gambling
games such as the probability of ruin after betting n times in a coin tossing
game. In this case, the sum of gains minus losses in n trials is equal to the
state of a player’s fortune (Weiss 1994).

Financial markets have also been studied from the random walk point of view.
In fact, this formalism was the ﬁrst tentative model known in ﬁnance, hav-
ing been suggested by Bachelier (1900) to describe stock market dynamics
and give a price for a European call option. In fact, Bachelier modelled the
price evolution assuming that prices change one unit at each time step with
a probability p of going up and 1
p of going down. Thus there are only two
possible events. This process is called the binomial model and is the simplest
random walk. Bachelier showed that the distribution of the resulting process,
after a large number of time steps, tends to the Gaussian distribution. The
limit behavior is often called the diﬀusion limit and the result obtained is just
the consequence of the central limit theorem (Weiss).

−

Several decades passed before there was further progress in the application
of random walk methodology to analyze diﬀerent aspects of ﬁnancial transac-
tions. Thus, in the book edited by Cootner (1964), there is a chapter devoted
to the reexamination of the random walk hypothesis in ﬁnance. At that time,
it was well-established that random walk models should be applied to the price
return instead of the price itself as Bachelier asserted. In Cootner there are
also several papers, basically published in the period 1961-1963, devoted to the
question of whether the market is a random walk or a trend follower. Within
these works we mention the article by Fama (1963) that studies an alterna-
tive to the Gaussian Bachelier random walk, proposing instead the Pareto
distribution.

Later on, Cox and Ross (1976) used the Bachelier ordinary random walk
formalism to provide a discrete time analog to the well-known Black-Scholes
option price. In addition, Cox and Ross also obtained a diﬀerent limiting
process when the number n of time steps is large, ﬁnding that the binomial
model leads to a Poisson jump process. Other contributions of the random
walk approach to ﬁnance extend the binomial model by adding a third possible
event, a crash, and observe the implications of it to the European option price
(see e.g. Wilmott 1999). To our knowledge, there are not other ﬁnancial market
models exploiting all the possibilities that random walk analysis can oﬀer in
the study of many interesting phenomena in markets.

Note that the ordinary random walk formalism mentioned above is based on
the assumption that step changes are made at equal time intervals but this is
a ﬁrst approximation for many physical phenomena and markets. The CTRW

2

relaxes this restriction since it assumes that time intervals between transac-
tions are not constant but random. Ticks have now, and in contrast with
the Bachelier random walk, two sources of randomness: one coming from the
amplitude and another one from the waiting times between ticks. This so-
phistication is necessary to describe markets with tick-by-tick data (i.e., the
highest frequency price data available). The deepest structure corresponds to
the transaction-to-transaction operations. We believe that the CTRW formal-
ism is especially useful in these cases and may improve the ordinary random
walk approach. In contrast, it seems not to be suitable for cash indices since
indices are averages of many prices and are recorded following some speciﬁc
criteria described by an almost constant tick-by-tick frequency.

Despite this promising fact, the CTRW is hardly known among ﬁnancial an-
alysts. Physicists have recently provided, from a new discipline called econo-
physics, only a few examples of CTRW’s applied to ﬁnance. Thus the papers
by Scalas et al. (2000) and Mainardi et al. (2000) were among the ﬁrst works
addressed to this issue. Further developements were given by Raberto et al.
(2002), Kutner and ´Swita la (2003), and Masoliver et al. (2003). Perhaps one of
the most solid reasons in favor of CTRW models is that they provide general
expressions for the distribution of prices at time t in terms of two auxiliary
densities that can be estimated from data: the probability density function
(pdf) of the pausing time between ticks, ψ(t), and the density for the magni-
tude of the price increment at a given tick, h(x) (see Eqs. (2) and (3) below
for a formal deﬁnitions of these quantities).

Other quantities, such as the distribution of daily or longer-time prices based
on two probability density functions ψ(t) and h(x), can be obtained using
the CTRW formalism. This in turn allows for the possibility of dealing with
inverse problems, that is, estimating from the observed daily or longer-time
data the forms of the microscopic functions ψ(t) and h(x). This is useful since
in many practical situations, one only has, at most, daily data. In this case
our formalism enables us to determine features of the otherwise unknown
microscopic structure of the ﬁnancial process.

Finally, we mention the existence of an important precedent that probably
might have occurred to many readers. Within a very diﬀerent approach, Mer-
ton (1976) proposed a jump market model whose jumps are completely inde-
pendent and have a Poisson distribution for the waiting times. The CTRW
formalism generalizes the Merton model because we have now the freedom
of choosing any probability distribution for pausing times and jumps and,
even more importantly, the present formalism allows one to study arbitrary
correlations between them.

The paper is organized as follows. In Section 2 we present a short introduction
to the CTRW formalism. In Section 3 we derive the exact distribution of

3

prices and volatility in terms of market microstructure statistics, while in
Section 4 we study the inverse problem. These sections contain analysis based
on actual data to illustrate the procedures used. Finally, conclusions are drawn
in Section 5 and more technical questions are left to appendices available on
the JEBO website.

2 An introduction to the CTRW

We ﬁrst provide a deﬁnition of the CTRW from the perspective of ﬁnancial
markets. Let Z(t) be the return deﬁned by Z(t) = ln[S(t)/S(t0)] where S(t)
is a speculative price and t0 is an initial time. In what follows we will assume
that the return process is stationary so that Z(t) is independent of t0. We are
interested in the zero-mean return, X(t), rather than the return Z(t). This is
deﬁned by

X(t) = Z(t)

Z(t)

,

i

− h

where

Z(t)

is the average of Z(t).

h

i

We now suppose that X(t) evolves following a CTRW and that any realiza-
tion consists of a series of step functions (see Fig. 1). Therefore the return
evolves discontinuously, and during any sojourn its value remains constant.
In this picture X(t) changes at random times t0, t1, t2,
. We assume
that the intervals between successive steps, which we call sojourns or pausing
times, Tn = tn −
) are independent, identically distributed,
· · ·
random variables with a probability density function, ψ(t), deﬁned by

1 (n = 1, 2, 3,

, tn,

· · ·

· · ·

tn

−

ψ(t)dt = Prob

t < Tn ≤

{

t + dt
}

.

At the conclusion of a given sojourn X(t) undergoes a random change equal
to ∆Xn = X(tn)
1) whose probability density function is deﬁned by

X(tn

−
h(x)dx = Prob
{

−

x < ∆Xn ≤

x + dx
}

.

We collect these two random sources into one single function ρ(x, t) that rep-
resents the joint probability density function of pausing times and return in-
crements. That is,

ρ(x, t)dxdt = Prob
{

x < ∆X

x + dx; t < T

≤

t + dt
}

.

≤

In what follows, we take ρ(x, t) to be an even function of x thus assuring
that there is no net drift in the evolution of X(t). Observe that two marginal

(1)

(2)

(3)

(4)

4

X(t)

X(t  )
n

n−1X(t    )

∞

Z
−∞

X(t  )=0
0

t 0

t
1

t
2

t3

t n−1

t
n

t

nT

Fig. 1. Schematic representation of the return process. The dots mark the value
1 is the time increment of the
X(tn) of the return after each sojourn. Tn = tn −
n-th sojourn.

tn

−

densities can be formed out of ρ(x, t); the pausing-time density ψ(t) and the
density for a random jump h(x), these are related to ρ(x, t) by

ψ(t) =

ρ(x, t)dx,

h(x) =

ρ(x, t)dt.

(5)

Our main goal is to obtain the probability density function of X(t). This
function is the propagator, deﬁned by

p(x, t)dx = Prob
{

x < X(t)

x + dx
}

.

≤

It is well known that p(x, t), satisﬁes the following renewal equation (e.g., Cox
1965 and Weiss 1994),

p(x, t) = p0(x, t) +

dt′

ρ(x′, t′)p(x

x′, t

t′)dx′,

(6)

−

−

t

Z0

∞

Z
−∞

where we have assumed that the initial jump occurred at t = 0. Equation (6)
involves several new deﬁnitions. The function p0(x, t) is the propagator prior
to the ﬁrst jump and is equal to

where Ψ(t) is the probability that no transaction has occurred before time t,

p0(x, t) = Ψ(t)δ(x),

Ψ(t) =

ψ(t′)dt′.

∞

Zt

(7)

(8)

∞

Z0

5

The function δ(x) appearing in Eq. (7) is the Dirac delta function that can be
deﬁned by δ(x) = 0 for x

= 0 and

δ(x)f (x)dx = f (0)

∞

Z
−∞

for any integrable function f (x) (Lighthill 1980). Equation (6) is derived from
the consideration that at time t the ﬁrst transaction has not yet occurred, this
given by the ﬁrst term on the right hand side of this equation, or else that a
transaction occurred at time t′ < t, at which time the return had value x′ and
from (x′, t′) the return process is renewed. We can solve Eq. (6) in terms of
the joint Fourier-Laplace transform:

ˆp(ω, s) =

st

dte−

dxeiωxp(x, t).

∞

Z0

∞

Z
−∞

The solution is

ˆp(ω, s) =

ˆp0(ω, s)

1

ˆρ(ω, s)

−

,

ˆp0(ω, s) =

−

1

ˆψ(s)
s

,

where ˆp0(ω, s) and ˆρ(ω, s) are respectively the joint Fourier-Laplace transforms
of the functions p0(x, t) and ρ(x, t). We easily see from Eq. (7) that the explicit
form of ˆp0(ω, s) is given by

(9)

(10)

where ˆψ(s) is the Laplace transform of the pausing-time density ψ(t). Equa-
tion (9) furnishes the complete solution in the transform domain and is a
convenient starting point in any CTRW analysis.

One may argue that the CTRW is only applicable to intraday price evolution.
The process can be extended to larger time lags as depicted in Fig. 2. Neglect-
ing overnight eﬀects on the price, obviously a ﬁrst approximation, we show
there how to describe the daily price evolution and thus represent the whole
historical price evolution within the framework of the CTRW. This allows
that the time t appearing in p(x, t) can be any time interval: minutes, hours,
days, or longer. A signiﬁcant eﬀect of this linkage is that we unify within the
same formalism high-frequency data with low-frequency data such as daily or
weekly closing prices. We will see in future sections that this enables us to
derive some important results.

6

6
(a)

S(t)

(b)

X(t)

Closed
market

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

Closed
market

t0

1t

2t

t3

nt

nt

tn+1

tn+m

t

t0

1t

nt

nt

tn+1

tn+m

t

· · ·

Fig. 2. In (a) we describe the evolution of the stock price S(t). Consecutive transac-
tions take place at discrete random times t0, t1, t2,
and are represented by black
circles. At every moment, the last traded price is the reference value during the in-
tervals between changes. Two prices are noteworthy: the opening and closing prices.
These are respectively the price of the ﬁrst and last transaction and are represented
by white (opening) and black (closing) boxes. In many situations opening and clos-
ing prices are the only data available. Generally the closing price of a session does
not coincide with the opening price of the next day. Nevertheless, as an approxima-
tion, the last return of a given day can be taken as the ﬁrst return of the next day.
Therefore, since we do not model the behavior of the market when it is closed, we
proceed as shown in (b); that is, we identify the last operation of a given day with
the ﬁrst transaction of the next day. In the ﬁgure both transactions are represented
by white circles.

7

3 From market microstructure to return distributions

We want to obtain the return distribution from information concerning tick-
by-tick price behavior. Apparently, this is straightforward by taking the Fourier-
Laplace inversion of Eq. (9). Unfortunately, we need ﬁrst to determine the form
of the joint density ρ(x, t), but this is not possible from the available data.
More easily accessible are the marginal pdf’s, h(x) and ψ(t), that fully deﬁne
the tick-by-tick statistics. It is therefore essential to assume a functional re-
lation between ρ(x, t) and its marginal densities ψ(t) and h(x). Let us ﬁrst
study some possible ways of combining ψ(t) and h(x) to obtain ρ(x, t) and
discuss their main implications.

The simplest choice would be based on the assumption that return increments
and their duration time are independent random variables (Scalas et al.). In
this case (ansatz 1)

ρ(x, t) = h(x)ψ(t),

so that Eq. (9) becomes

ˆp(ω, s) =

[1
1

ˆψ(s)]/s
−
˜h(ω) ˆψ(s)

.

−

For the case of exponentially distributed pausing times, ψ(t) = λ exp(
λt),
and after Laplace inversion, equation (12) results in the following characteristic
function:

−

˜p(ω, t) = exp

λ[1

˜h(ω)]t
}

.

−

{−

However, in many situations one expects some degree of correlation between
return increments and their duration, while Eq. (11) implies complete indepen-
dence between them. This is, for example, conﬁrmed in the statistical analysis
by Raberto et al. for the speciﬁc stock shares of General Electric.

One possible assumption is to suppose that the density ρ(x, t) is such that its
characteristic function ˜ρ(ω, t) has the following functional form (ansatz 2),

˜ρ(ω, t) = ψ

t
˜h(ω) #

,

"

where ψ(t) is the pausing time density and ˜h(ω) is the Fourier transform
of h(x). The assumption given by Eq. (14) is at least intuitively plausible

8

(11)

(12)

(13)

(14)

because it implies that one must wait for a long time in order for a large
variation of return to occur. In other words, large increments of the return are
very infrequent.

tn
Let us show this by proving that sojourn times, T = tn −
1, and return
−
quadratic increments, ∆X 2 = [X(tn)
1)]2, are positively correlated
so that increasing return variations imply increasing sojourn times and vice
versa. In eﬀect, we deﬁne the following measure of the correlation between
∆X 2 and T by

X(tn

−

−

∆X 2T
i
∆X 2
T

ih

i

r = h
h

1.

−

We can easily evaluate the cross average
function ˜ρ(ω, t).Thus

h

i

∆X 2T

using the joint characteristic

∆X 2T

=

i

−

h

∂2
∂ω2

∞

Z0

∆X 2T

,

t˜ρ(ω, t)dt
(cid:12)
(cid:12)
ω=0
(cid:12)
(cid:12)
(cid:12)
(cid:12)
∆X 2

= 2

i

h

ih

i

which after using Eq. (14) yields
meant to prove.

h

T

. Hence r = 1 as we

We now come back to the ansatz in Eq. (14) and observe that it allows us
to write ˆρ(ω, s) in the form ˆρ(ω, s) = ˜h(ω) ˆψ[s˜h(ω)]. This in turn leads us to
write the formal solution to the problem given by Eq. (9) in the following more
explicit form:

ˆp(ω, s) =

ˆψ(s)]/s

[1
−
˜h(ω) ˆψ

.

s˜h(ω)
h

i

1

−

We next consider an example in which it is possible to evaluate p(x, t) directly.
Thus, on the assumption that ψ(t) = λ exp(
)/2,
Eq. (16) yields

λt) and h(x) = γ exp(

x
|

−

−

γ

|

ˆp(ω, s) =

1
λ + s "

1 +

λ
λω2/γ2 + s #

.

The inverse Fourier transform followed by the Laplace inversion and the con-
volution theorem lead us to the following return pdf:

(15)

(16)

(17)

(18)

p(x, t) = e−

λt

δ(x) +

eξ2

−

γ2x2/4ξ2

dξ

.

γ
√π

√λt

Z0









9

γ

/
)
t
λ
,
x
γ

(
p

0.2

0.1

0

8

6

λt

4

1
1

2
2

γx

2

3
3

4

Fig. 3. The return pdf in dimensionless units p(γx, λt)/γ given in Eq. (18) for
x > 0, that is, without the delta function term appearing in (18). By the assumed
symmetry in x, p(x, t) behaves similarly for negative returns.

In Fig. 3 we plot this density for positive returns x > 0.

The ansatz given in Eq. (14) is not the only possible one that assumes a
dependence between jumps and pausing times. Another plausible choice would
be given by the following form (ansatz 3):

ˆρ(ω, s) = ˆψ(s)˜h[ω ˆψ(s)].

Following the method outlined above one can easily see that in this case return
variations and pausing times are also positively correlated but with a higher
correlation (cf. Eq. (15)) given by r = 2.

Note that in this case return pdf is given by

ˆp(ω, s) =

1
λ + s

+

λ
s(λ + s) + λ2ω2/γ2

10

(19)

(20)

γ

/
)
t
λ
,
x
γ

(
p

0.2

0.1

0
-10
-10

10

8

6

4

λt

-5
-5

0
0
γ x

5
5

2

10 0

Fig. 4. The return pdf in dimensionless units p(γx, λt)/γ given in Eq. (21) for x
without the delta function term.

= 0,

and its joint Fourier-Laplace inversion yields

p(x, t) = e−

λtδ(x) + (γ/2)e−

λt/2Θ(λt

)I0

γ

x
|

|

−

λ2t2

γ2x2/2

,

(21)

(cid:18)q

−

(cid:19)

where Θ(x) is the Heaviside step function deﬁned by

Θ(x) = 


1

0



when x > 0,

when x < 0;

and I0(x) is the modiﬁed Bessel function. We note that, contrary to the pdf’s
given in Eqs. (13) and (18), the density p(x, t) given by Eq. (21) has a compact
support since the value of the zero-mean return, X(t), diﬀers from zero only
λt/γ < x < λt/γ for any ﬁxed time t. Since this limitation
within the interval
on the value of X(t) is unrealistic, the model given by the ansatz in (19)
together with the assumption that jumps are exponentially distributed seems
not to describe events in real ﬁnancial markets. In any case, for completeness,
we plot this pdf in Fig. 4.

−

11

6
3.1 Some asymptotic results

We now focus on some asymptotic expressions of the distribution of returns,
exempliﬁed by its characteristic function ˜p(ω, t). These approximate expres-
sions are completely general and independent of the model chosen for ρ(x, t)
as long as the sojourn time density ψ(t) has some ﬁnite moments. Under
these conditions, we have derived in Appendix A (see also Kotulski 1995 for
an alternative method) some interesting results that can be summarized as
follows:

(a) If the jumps pdf h(x) has a ﬁnite second moment, µ2 =

,
∞
the asymptotic distribution of returns for long times approaches to the
Gaussian density:

<

h

i

∆X 2

˜p(ω, t)

≃

µ2ω2t/2
T
h

i

e−

(t

T

).

≫ h

i

, then ˜h(ω)
(b) If h(x) is a long-tailed density, h(x)
has an expansion of the form ˜h(ω)
0 (note that if
≃
0 < α < 2, h(x) has inﬁnite variance). Moreover, if we assume that for
ω small
, then the asymptotic return pdf approaches the
h
L´evy distribution:

α as
x
α as ω

| → ∞
→

T eiω∆X

x
−
|
k

∼ |
1

i ≃ h

−
ω

−

T

i

|

|

|

1

˜p(ω, t)

≃

e−

k

ω

|

αt/
T
h

|

i

(t

T

).

≫ h

i

(c) At intermediate times, t

T

, the behavior of p(x, t) for large values of

≈ h
is the same as that of the jump distribution:

i

x
|

|

(22)

(23)

(24)

p(x, t)

h(x).

t
T

h

i

∼

Note incidentally that the L´evy distribution has been proposed by several
authors as a good candidate for describing ﬁnancial distributions when the
observed fat tails are not Gaussian (e.g., Mandelbrot 1963, Fama 1963). How-
ever, from the discussion above, we see that in the framework of CTRW’s
the appearance of L´evy distributions is linked to the existence of transactions
for which the jumps have inﬁnite variance. Since this is manifestly impossi-
ble in real markets, we conclude that the L´evy distribution is an unsuitable
candidate for the propagator. In order to overcome this inconsistency some
authors propose a truncated L´evy distribution (see, for instance, Mantegna
and Stanley 1995), although in many cases the truncation procedure is done
in an arbitrary way, without any justiﬁcation provided by the behavior of the
market.

12

3.2 The volatility

Aside from the pdf p(x, t), which provides maximal information about the
evolution of X(t), there is another quantity of considerable practical interest:
the volatility, which does not require the knowledge of the entire jump dis-
tribution h(x). It suﬃces to know the pdf ψ(t) and the ﬁrst two moments of
h(x).

Let us denote by ˆm2(s) the Laplace transform of the second moment

X 2(t)

:

i

h

ˆm2(s)

∞

≡

Z0

st

e−

X 2(t)

dt.

h

i

This quantity can be derived in terms of the joint Fourier-Laplace transform
of p(x, t) by

The combination of Eqs. (9) and (25) leads to the relation

ˆm2(s) =

∂2 ˆp(ω, s)
∂ω2

−

.

ω=0

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ˆm2(s) =

ˆR2(s)

,

ˆψ(s)]

s[1

−

h

i

ˆm2(s) = µ2

ˆψ(s)

.

ˆψ(s)]

s[1

−

X 2(t)

= λµ2t,

h

i

where ˆR2(s) =

∂2 ˆρ(ω, s)/∂ω2

−

|ω=0.

For the independent model deﬁned by Eq. (11) we see that ˆR2(s) = µ2
where µ2 =

is the second moment of the jump density. Hence

∆X 2

ˆψ(s),

Note that the assumption of exponentially distributed sojourns, for which
ˆψ(s) = λ/(λ + s), leads to

so that the variance always increases linearly with time as in the Wiener
process.

For the model speciﬁed by the ansatz (14) we have ˆR2(s) = µ2[s ˆψ(s)]′, where

13

(25)

(26)

(27)

(28)

the prime denotes a derivative, and

ˆm2(s) =

µ2[s ˆψ(s)]′
ˆψ(s)]
s[1

.

−

X 2(t)

= µ2

h

i

λt

λt + e−
h

−

1

.

i

For exponentially distributed pausing times we have ˆm2(s) = µ2λ2/s2(λ + s),
so that

The limiting behaviors of this volatility are
X 2(t)

µ2λt for λt

1.

h

X 2(t)

µ2(λt)2 for λt

1, and

i ∼

≪

i ∼

h
For the second ansatz given by Eq. (19) we see that ˆR2(s) = µ2 ˆψ(s)3 and

≫

ˆm2(s) =

µ2 ˆψ(s)3
s[1

ˆψ(s)]

.

−

In the case of exponentially distributed pausing times we have

ˆm2(s) = λ3µ2/s2(λ + s)2

and

X 2(t)

= µ2

h

i

λt

λt
h

1 + e−
(cid:16)

2

1
(cid:16)

−

−

(cid:17)

λt

e−

.

(cid:17)i

h

X 2(t)

µ2λt for λt

In this case the limiting behaviors are given by
1
i ∼
and
1. Therefore, and similar to ansatz (14), if we
suppose that sojourn times are exponentially distributed, the volatility has
a superdiﬀusion-like behavior at short times and a diﬀusion-like behavior at
long times.

µ2(λt)3/6 for λt

X 2(t)

i ∼

≫

≪

h

We remark that the asymptotic variance grows linearly with time regardless
of the speciﬁc form of ρ(x, t). Indeed, assuming that in all realistic models µ2
and

are ﬁnite from Eq. (22) we readily obtain

T

h

i

X 2(t)

h

i ≃

t

µ2
T

h

i

(t

T

),

≫ h

i

independent of the correlation model.

14

(29)

(30)

(31)

(32)

(33)

3.3 The U.S. dollar/Deutsche mark case

Let us now show how to infer the return statistics at an arbitrary time t from
high frequency data. The case we discuss is that of the U.S. dollar/Deutsche
mark future exchange, based on a transactions data base from January 1993 to
December 1997. This consists of 1,048,590 transactions. We have chosen this
data since this future has a high trading volume that is required to provide
reliable statistical inferences.

The ﬁrst assignment is to estimate from high-frequency data plausible forms
for ψ(t) and h(x). In Fig. 5 we plot the experimental pausing-time density
ψ(t) for the U.S. dollar/Deutsche mark future. We see that the data is well ﬁt
by a power-law density:

ψ(t) =

λ(α
1)
(1 + λt)α ,
−

where α = 3.47 and λ = 2.73
moment are

×

10−

2s−

1. The mean sojourn time and its second

=

T

h

i

1

λ−
α

−

,

2

T 2

=

h

i

(α

2

2λ−
2)(α

−

−

.

3)

For the dollar/mark future market the experimental mean sojourn time di-
iexp = 23.6 s, in satisfactory agreement with
rectly evaluated from data is
= 24.9 s evaluated from Eq. (35) with the
the theoretical prediction of
i
parameters estimated from the ﬁt to ψ(t) in Fig. 5.

T
h
T
h

In Fig. 6 we plot the experimental jump density, h(x). The data indicate that
the experimental h(x) can be considered a symmetric function of the return
increment x. A good ﬁt is also given by a power law with a greater exponent
than that of ψ(t):

(34)

(35)

(36)

h(x) =

(β
2γ(1 +

1)
/γ)β ,
−
x
|
|

4. Power law densities such as (34) and (36)
where β = 5.52 and γ = 2.64
have been suggested for describing several market models such as individual
companies by Plerou et al. (1999), market indices by Gopikrishnan et al. (1999)
and Mainardi et al. (2000).

10−

×

We have now all the elements to get the return pdf p(x, t) at any time t and,
hence, to obtain a complete analysis of the dollar/mark exchange market. In
order to focus ideas and results, we will now assume that pausing times and

15

USD-DEM
Proposed fit

n
o
i
t
c
n
u
f
 
y
t
i
s
n
e
d
 
y
t
i
l
i

b
a
b
o
r
P

101

100

10-1

10-2

10-3

10-4

10-5

0.1

1

10

100

Normalized time between sojourns

Fig. 5. Empirical distribution of the time between the closest-to-maturity transac-
tions of the U.S. dollar/Deutsche mark future (in the US market). The analyzed
data range from January, 1993, to December, 1997. The pdf of the sojourn times,
ψ(t), clearly follows a power law at suﬃciently long times. The solid line is the
T
representation of Eq. (34). The normalized time between sojourns is t/
h

.
i

jump sizes are positively correlated as speciﬁed in Eq. (14). This is supported
by empirical data since for the U.S. dollar/Deutsche mark future market we
have a positive correlation given by r = 0.53 (cf. Eq. (15)).

Unfortunately, the densities given by Eqs. (34) and (36) do not allow an exact
evaluation of p(x, t), or even of the characteristic function ˜p(ω, t). The Fourier
and Laplace transforms of h(x) and ψ(t) are too complex to manage them
analytically as required for deriving the characteristic function (16). We will
therefore restrict ourselves to study the behavior of the tails of the distribution.
We have shown above that, for moderate times, the tails of p(x, t) are the same
as that of the jump density h(x). That is, for large

(cf. Eq. (24)),

p(x, t)

h(x)

t
T

h

i

∼

x
|

|

(t

T

) .

≈ h

i

In our case we see from Eqs. (35)-(36) that
(β

. Therefore,

β/2 as

1)γβ

x

1

−

T

h

i

= λ−

1/(α

2) and h(x)

−

−

p(x, t)

|

−

x
|
(β
−
2(α

∼

|
1)λt
2)

−

| → ∞
γβ
1
x
|

−
β

|

(t

T

) .

≈ h

i

∼

(37)

Hence, the tails of p(x, t) follow the same power law as that of the return

16

Increments
Decrements
Proposed fit

)
x
(
h

104

103

102

101

100

10-1

10-2

10-3

10-4

10-5

10-4

10-3

10-2

Return variations between sojourns

Fig. 6. Empirical distribution of the logarithmic changes between transactions in
the U.S. dollar/Deutsche mark future market. Positive variations (increments) and
negative variations (decrements) exhibit approximately the same behavior, thereby
supporting our assumption of the symmetry of h(x). The plot suggests a power law
dependence at large return increments. It also includes a graph showing the shape
of h(x) in Eq. (36), using the parameters reported there.

increment distribution h(x). Observe that the approximation (37) is valid
when the time lag is of the same order of the mean sojourn. This prediction
of the theoretical model is conﬁrmed by actual data. In Fig. 7 we show the
empirical p(x, t) for the dollar/mark future exchange for t = 15 seconds in
which the time lag t is of the same order than the empirical mean sojourn
iexp = 23.9 s. The empirical distribution clearly shows a power-law decay
T
h
with exponent β
5.5, which coincides with the decaying exponent of h(x)
which is consistent with the predictions of the CTRW model.

≈

We close this section with a remark about the volatility. In this case, we need to
obtain the Laplace transform of the expression for ψ(t) given by Eq. (34). This
results in an expression in terms of the Kummer function U(a, c, z) (Magnus et
al. 1966), which renders very diﬃcult the inversion of ˆm2(s) to obtain
.
i
We thus limit ourselves to another asymptotic result. As we have proven above,
the variance grows linearly with t as t
regardless of the model chosen;
therefore,
2)
1. We refer the reader to Fig. 10 of Sect.
and
4.1 where this asymptotic linear dependence on time is clearly observed for
the U.S. dollar/Deutsche mark futures market.

T
h
2)µ2λt for λt

(see Eq. (33)). In our case

h
X 2(t)
i ≃

X 2(t)
(α

i ∼
−

X 2(t)

→ ∞

= λ−

1/(α

µ2t/

≫

−

T

h

i

h

h

i

17

β=5.52

)
t
,
x
(
p

104

103

102

101

100

10-1

10-2

10-3

10-4

t= 15 s

10-5

10-4

10-3

10-2

x

Fig. 7. The empirical probability density function p(x, t) for a time lag t of 15 seconds
(U.S. dollar/Deutsche mark future market). The model leads to a power-law decay,
governed by an exponent β that is precisely the one appearing in the power-law for
iexp = 23.9 s. We show the tail only
the jump density h(x) as expected when t
for positive increments; the tail for negative increments behaves similarly.

≈ h

T

4 The inverse problem

i

h

X 2(t)

To this point we have determined the return density p(x, t) when the densities
ψ(t) and h(x) are known. However, from the CTRW formalism, it is possible
to infer the mechanism of price formation at a microscopic level. This requires
one to obtain the statistics of high frequency data represented by the pausing-
time density ψ(t) and the return increment density h(x) once we know the
and the return pdf p(x, t). We call this “the inverse problem”.
variance
Obviously this problem will require the knowledge of the complete pdf p(x, t)
for all times t, something that is beyond reach, since, in practice, one has
access, for instance, to daily data from which one is able to guess the pdf for
the daily return p(x, t), where t = 1 day. In such a case we do not have an
analytical expression for p(x, t) permitting us to get the microscopic densities
ψ(t) and h(x) exactly. Nevertheless with the formalism presented below we
will be able to guess which forms of ψ(t) and h(x) may be consistent with the
observed p(x, t).

Let us ﬁrst discuss the problem of obtaining the microscopic jump density
once we know the return pdf p(x, t). In eﬀect, setting s = 0 in Eq. (9) and

18

2.5

1.5

0.5

3

2

1

3

2

1

2.5

1.5

0.5

0

0

y
t
i
s
n
e
d
 
e
m

i

i
t
 
g
n
s
u
a
P

y
t
i
s
n
e
d
 
e
m

i

i
t
 
g
n
s
u
a
P

α=0.915

Independent
Ansatz 1
Ansatz 2

α=1.12

Independent
Ansatz 1
Ansatz 2

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

0.25

0.5

0.75

1

1.25

1.5

α=0.877

Independent
Ansatz 1
Ansatz 2

α=1.06

Independent
Ansatz 1
Ansatz 2

1.75

1.5

1.25

1

0.75

0.5

0.25

1.75

1.5

1.25

1

0.75

0.5

0.25

0

0

0.2

0.4

0.6
0.8
Normalized time τ

1

1.2

1.4

1.6

0.25

0.5

0.75

1

1.25

1.5

Normalized time τ

Fig. 8. The inverse Laplace transform of the pausing time distribution (41), (49)
and (54) with τ deﬁned by Eq. (42). The values of alpha chosen are the ones obtained
from IBM (α = 0.915), 3M (α = 0.877), Gillette (α = 1.12) and Dupont (α = 1.06)
data (see Table 1).

taking into account that ˆρ(ω, 0) = ˆh(ω) and ˆp0(ω, 0) =

T

, we have

h

i

ˆp(ω, 0) = h
−

1

T
i
ˆh(ω)

(38)

ˆh(ω) = 1

T
ˆp(ω, 0)

h

i

.

−

so that

Since

∞

ˆp(ω, 0) =

ˆp(ω, t)dt,

Z0
we see that Eq. (38) allows us to get the characteristic function corresponding
to the jump density h(x) if we know the entire return pdf p(x, t) for all t
0.
Therefore, Eq. (38) is very diﬃcult to implement because, as mentioned, we
know at most a numerical series for the value of the propagator instead of an
analytical expression of p(x, t). In these cases, Eq. (38) is useless for evaluating
h(x). However, Eq. (38) can be useful for testing any statistical hypothesis and
evaluating statistical parameters for the form of h(x). Incidentally, we note

≥

19

that Eq. (38) is valid independent of the existing correlations between jumps
and pausing times, that is, regardless of the form of the joint density ρ(x, t).

Unfortunately, the inverse problem for obtaining the pausing time density ψ(t)
requires the knowledge of the form of ρ(x, t).
from the return variance
Thus, for the independent model in which ρ(x, t) = h(x)ψ(t) the volatility is
given by Eq. (27), for which we get

X 2(t)

h

i

ˆψ(s) =

s ˆm2(s)
µ2 + s ˆm2(s)

.

As an illustration of this procedure let us see for which density ψ(t) corre-
sponds to an anomalous diﬀusion volatility of the form

X 2(t)

= ktα

h

i

(k, α > 0)

In this case,

where Γ(x) is the Gamma function. From Eq. (39), we get

ˆm2(s) = kΓ(1 + α)s−

1

α

−

ˆψ(s) =

1
1 + µ2sα/kΓ(1 + α)

.

We can invert numerically this Laplace transform. To this end we use an algo-
rithm proposed by Stehfest (1970) that is the simplest method for numerically
inverting Laplace transforms in the literature. We show in Fig. 8 the paus-
ing time distribution for several values of α in terms of a normalized time τ
deﬁned by

τ = [kΓ(1 + α)/µ2]1/αt.

One can also obtain, by using Tauberian theorems (Handelsman and Lew
1974), the asymptotic behavior of ψ(t) as t
and also the short time
behavior t
0. It is worth to mention that Kotulski gives an alternative
method based on renewal theory and limit theorems for random sum of jumps.
In any case, following Tauberian theorems, we see from Eq. (41) that for small
s,

→ ∞

→

ˆψ(s)

1

≃

−

µ2
kΓ(1 + α)

sα

(sα

≪

kΓ(1 + α)/µ2) ,

and the Tauberian theorems imply that

ψ(t)

µ2 sin(πα)
kπ

≃

1

t−

−

α

(ktα

µ2/Γ(1 + α)) .

(43)

≫

20

(39)

(40)

(41)

(42)

On the other hand, for long values of s, we have

ˆψ(s)

kΓ(1 + α)
µ2

≃

α

s−

(sα

≫

kΓ(1 + α)/µ2) .

Hence,

ψ(t)

αk
µ2

≃

1+α

t−

(ktα

µ2/Γ(1 + α)) .

≪

(44)

We thus see that a power-law volatility leads to a power-law pausing density
at short and long times.

Let us treat now the cases in which there exists a correlation between paus-
ing times and return increments. When the ansatz in Eq. (14) is valid, the
formulation of the problem given by Eq. (16) provides a relation between the
Fourier and Laplace transforms of the daily return density p(x, t) and the high
frequency densities ψ(t) and h(x). A second relation is required to determine
the microscopic densities. This is supplied by the volatility. In eﬀect, we start
from Eq. (29), which, on deﬁning ˆφ(s)

s ˆψ(s), can be written in the form

≡

µ2

d ˆφ(s)
ds

+ ˆm2(s) ˆφ(s) = s ˆm2(s).

The solution to this equation with the initial condition ˆφ(0) = 0 yields

ˆψ(s) =

s

1
µ2s

ξ ˆm2(ξ) exp 


−

Z0

ˆm2(ξ′)dξ′


Zξ

dξ.

s

1
µ2





Equation (45) yields an expression for the Laplace transform of the transac-
tions pausing-time density once we know the volatility.

In the case of a linear variance of the form

X 2(t)

= σ2t,

h

i

for which ˆm2(s) = σ2/s2, we see from Eq. (45) that

ˆψ(s) =

eD/sEi(

D/s),

−

D
s

−

where D = σ2/µ2, and Ei(z) is the exponential integral. The Laplace inversion
is (Roberts and Kaufman 1966)

ψ(t) = 2DK0(2√Dt),

21

(45)

(46)

(47)

where K0(x) is a modiﬁed Bessel function of the second kind (Erdelyi 1954).
The asymptotic form of ψ(t) is (Magnus et al.)

π2D3

1/4

ψ(t)

≃  

t !

2√Dt

e−

(Dt

1).

≫

Therefore, a linear variance implies that ln[ψ(t)] falls oﬀ assyptotically as

√4Dt.

−
Another example is provided by the anomalous diﬀusion volatility given in
Eq. (40). Now from Eq. (45) we get

ˆψ(s) =

[kΓ(α)]1/α
µ1/α
2 s

U[1/α, 1/α, kΓ(α)/µ2sα],

(49)

where U(a, c, x) is a Kummer function (Magnus et al.). This function can be
inverted numerically with results shown in Fig. 8. As before we use Taube-
rian theorems to obtain the asymptotic behavior of ψ(t). We have shown in
Appendix B that

ψ(t)

Ak
µ2

≃

1

tα
−

(ktα

µ2),

≪

and

ψ(t)

µ2 sin(πα)
kπ

≃

1

t−

−

α

(ktα

µ2),

≫

where A is a constant given by Eq. (B.2). Note that these results agree with
Eqs. (43) and (44).

Let us brieﬂy comment on the inverse problem under the assumption that
pausing times and return jumps are correlated as in ansatz (19). In this case
from Eq. (26) we have

Consequently, if we know the return moment
and hence its Laplace
transform ˆm2(s), the Laplace transform of the microscopic pausing-time den-
sity ψ(t) obeys the cubic algebraic equation

i

h

X 2(t)

ˆm2(s) =

µ2 ˆψ3(s)
ˆψ(s)
1
h

−

i

.

s

µ2 ˆψ3(s) + s ˆm2(s) ˆψ(s)

s ˆm2(s) = 0,

−

22

(48)

(50)

(51)

(52)

(53)

whose solution is

ˆψ(s) = ˆβ(s)1/3

1 +

1 + 8 ˆβ(s)/27
(cid:21)

q

+

1

− q

(cid:20)

1 + 8 ˆβ(s)/27
(cid:21)

((cid:20)

1/3

1/3

, (54)

)

≡

where ˆβ(s)
s ˆm2(s)/2µ2. The numerical inversion of this equation when
= ktα is shown in Fig. 8. Again we can proceed as before and perform
X 2(t)
h
an asymptotic analysis based on the use of Tauberian theorems. We present
the results of these calculations without going into details. We have

i

ψ(t)

kΓ(1 + α)
µ2Γ(α/3)

≃

1+α/3

t−

(ktα

µ2) ,

≪

and

ψ(t)

µ2 sin(πα)
kπ

≃

1

t−

−

α

(ktα

µ2),

≫

(55)

(56)

which is similar to Eqs. (43)–(44) and (50)–(51). We therefore see that the ap-
pearance of asymptotic power-law pausing densities seems to be independent
of the existence of correlations between jumps and pausing times. We also ob-
serve the asymptotic distribution at long times has the same decay exponent
for dependent and independent models.

4.1 A market application

We ﬁnally present an example involving real data. We base our discussion on
four sets of data points corresponding to daily opening and closing prices for
shares of IBM, Gillette, Dupont and 3M. These were chosen because a con-
siderable amount of data was available for them. Thus data for IBM consists
of daily prices from Jan. 2, 1968 to Dec. 31, 2002 with a total of 8,784 data
points. The data for Gillette corresponds to daily prices from July 27, 1980 to
Dec. 31, 2002 with 5,628 data points. Analogously the data for Dupont and
3M consist of daily prices from July 28, 1980 to Oct. 17, 2003 with respectively
a total of 5,801 and 5,842 points. For all these ﬁrms we have tried to deduce
the form of the microscopic pausing time density, ψ(t), from a knowledge of
low-frequency volatilities. We ﬁrst plot
1 day. This is shown
in Fig. 9. In the case of all of these companies we see a slightly but clear
anomalous diﬀusive behavior for few days and a regular diﬀusive behavior at
long times:

X 2(t)

for t

≥

i

h

X 2(t)

tα

(t

h

i ∼

0)

→

and

X 2(t)

h

i ∼

t

(t

),

→ ∞

(57)

23

IBM
Linear fit
 fit
kt

α

3M
Linear fit
 fit
kt

α

5

4

3

2

1

4

3

2

1

3
-

0
1
 
x
 
 
e
c
n
a
i
r
a
v
 
n
r
u
t
e
R

3
-

0
1
 
x
 
 
e
c
n
a
i
r
a
v
 

n
r
u

t

e
R

Gilette
Linear fit
 fit
k t

α

Dupont
Linear fit
 fit
kt

α

3
-

12.5

15

10

7.5

5

2.5

0
1
 
x
 
 
e
c
n
a
i
r
a
v
 
n
r
u
t
e
R

6

5

4

3

2

1

3
-

0
1
 
x
 
 
e
c
n
a
i
r
a
v
 

n
r
u

t

e
R

0

5

10

15

20

25

0

5

10

15

20

Trading days

Trading days

0

5

10

15

20

25

0

5

10

15

20

25

Trading days

Trading days

Fig. 9. The return variance dependence with time for IBM, Gillette, 3M, and
Dupont.

±

0.005 (IBM), α = 1.12

0.03
where α = 0.915
(Dupont) and α = 0.877
0.006 (3M). We therefore see that the anomalous
diﬀusive behavior in the data is subdiﬀusive for IBM and 3M and superdiﬀu-
sive for Gillette and Dupont. We summarize all the estimations of these ﬁts
in Table 1.

0.04 (Gillette), α = 1.06

±

±

±

What can we say about the microscopic density ψ(t)? From the analysis per-
formed above we see that, in all cases, ψ(t) dacays exponentially at long times.
For intermediate times, times not too long neither too short, for instance
(µ2/k)1/α (see Eq. (40)), we cannot apply either Tauberian or Abelian
t
theorems. In these cases, as we have done above (see Fig. 8), we must numer-
ically invert ˆψ(s) to obtain ψ(t).

≥

Let us remark that a good empirical test of the formalism used for the inverse
problem is to estimate the waiting time density. Unfortunately, we could not
get enough data to perform such a test for the four stocks studied above.
However, we can take the U.S. dollar/Deutsche mark high frequency data and
ﬁlter them in order to get daily return changes. We thus observe the time-
dependence of the variance provided by this daily data and perform a ﬁt to
the form ktα. Figure 10 plots the resulting variance and its ﬁt.

24

Table 1
Summary of the linear and polynomial regressions for data from IBM, Gillette,
3M and Dupont. The details of the linear and polynomial regressions are shown
specifying the range within each ﬁt is performed and the values with their errors
obtained from each regression. Some parameters are given in days (d).

IBM

Gillette

3M

Dupont

Period

Points

1968-2002

1980-2002

1980-2003

1980-2003

8,784

5,628

5,842

5,801

Range in days

15–25

11–20

15–25

15–25

2.5

0.7

8.104

0.005

1.42

0.03

2.17

0.01

7.30

0.14

4.15

0.07

7.1

0.5

4.6

0.2

Linear Regression:

= At + B

X 2(t)
i
h

(A

(B

±

±

δA)

δB)

×

×

104d−

1

104

Polynomial Regression:

Range in days

δk)

104 d−

1/α

×

(k

α

±

±

δα

±

±

±

±

= ktα

X 2(t)
i
h
1–4

±

±

1–4

±

±

±

±

1–5

±

±

±

±

1–5

±

±

2.129

0.010

5.8

0.2

2.73

0.02

2.61

0.07

0.915

0.005

1.12

0.04

0.877

0.006

1.06

0.03

Once we have estimated the α, we can numerically invert ˆψ(s) and ﬁnally we
can compare the pausing time distribution provided by the inverse method
with the one directly observed from high-frequency data. We compare them
in Fig. 11 showing a good agreement in the region of intermediate times for
which ktα

µ2.

≥

If we take a closer look at the three pausing distributions provided by the
independent model and by the dependent models exempliﬁed by ansatzes 1
and 2, we observe that both the independent model and ansatz 1 describe
the U.S. dollar/Deutsche mark data much better than does ansatz 2. This is
explained by considering the quantity r deﬁned in Eq. (15) that quantiﬁes
the correlation between waiting times and jumps. We have seen that for the
independent model r = 0, ansatz 1 gives r = 1, and ansatz 2, r = 2. On the
other hand, the empirical correlation of the US dollar/Deutsche mark data
is (see Section 3.3) r = 0.53, and intermediate value between those of the
independent model and ansatz 1, while the correlation given by ansatz 2 is
higher. All of this seems to indicate that the actual Foreign Exchange (FX)

25

daily USD-DEM
Linear fit
 fit
kt

α

5

4

3

2

1

4
-

0
1
 
x
 
 
e
c
n
a
i
r
a
v
 
n
r
u
t
e
R

0

5

10

15

20

25

Trading days

Fig. 10. The U.S. dollar/Deutsche mark daily return variance ranging from 1 day
to 25 days return changes. We have ﬁltered the tick-by-tick futures data to provide
the daily return changes from January, 1993, to December, 1997, 1,035 days. Again
the short time scale is ﬁtted assuming that the variance has the time dependence
ktα. The polynomial regression is done with nine data points (from 1 day until 9
days) and yields k = (2.09
0.03. The long
time ﬁt assumes a linear behavior, that is, At+B. The linear regression takes eleven
1 and
data points (from 15 to 25 days) and yields A = (1.42
B = (7.1

5(days)1/α and α = 0.94

4(days)−

0.05)

0.03)

10−

10−

0.5)

4.

×

±

×

±

±

10−

±

×

market should be described with an intermediate model between the indepen-
dent model and ansatz 1 while the model based on ansatz 2 is too correlated.
This is exactly what is observed in Fig. 11 since the curves corresponding to
the independent model and ansatz 1 oscillate very closely around the empirical
distribution from τ = 0.1 to τ = 20 while the curve corresponding to ansatz
2 clearly deviates from the empirical result.

We can quantify this by performing the chi-square test on these ﬁts. The
results, based on Fig. 11, are the following. The value of chi-square statistic for
the independent model is 6.5 times higher than that of the ﬁtted distribution
given by Eq. (34). For ansatz 1 the ratio is 39.2, and for the ansatz 2 the value
is 60.7 times higher than that of the pausing ﬁt. This is quite consistent with
the assertions in the previous paragraph.

We ﬁnally observe from the inset of Fig. 11 that for large times, τ
1, 000,
the three models converge to the same power law decay as was anticipated by
Eqs. (43), (51), and (56) with α + 1 = 1.94, which diﬀers from the behavior
of the empirical pausing-time density shown in Fig. 11. This is not surprising

∼

26

Independent
Ansatz 1
Ansatz 2
US-DEM pausing fit

n
o

i
t
c
n
u

f
 
y
t
i
s
n
e
d
 
y
t
i
l
i

i

b
b
a
b
o
r
P

100

10-1

10-2

10-3

10-4

10-5

10-6

0.1

10-4

10-8

Asymptotic regime
τ−α−1

1

10

100

1000

10000

1

10

Normalized time 

Fig. 11. The pausing time distributions for the U.S. dollar/Deutsche mark. We
compare the pausing time distributions obtained from the Laplace inversion of
Eqs. (41), (49) and (54) with the empirical pausing time distribution (34). The
results produced by the three ansatzes are polotted with the value of α obtained
from the ﬁt of fewer days in Fig. 10 with τ given by Eq. (42). The empirical ﬁt takes
τ = t/
. Note that both normalized times are quite similar. The inset shows in a
T
i
h
logscale how the three models collapse in the same power law when τ > 1, 000.

since this time scale is outside the region of validity of the empirical distri-
bution (see Fig. 5 and Eq. (34)). Indeed, if we assume that t
, then
τ = 1, 000 approximately corresponds to seven hours of trading, an interval of
time exceeding the trading day.

∼

T

τ

h

i

5 Conclusions

We have described some uses of CTRW formalism in the context of ﬁnan-
cial markets. The CTRW formalism provides insight that is able to relate not
only the market microstructure activity with the probability distribution of
intraday prices, but also with the distributions of daily, weekly, or longer-
time prices. Techniques based on the CTRW also can be applied to inverse
problems in which it is possible to analyze the microstructure of ﬁnancial pro-
cesses, represented by their transaction statistics, based only on low-frequency
(daily, weekly, etc.) data. In this way, we can have some knowledge of the mar-
ket microstructure by taking the information related to low frequency price
changes.

27

The formalism, in its direct version (i.e., from high-frequency data to lower
frequency statistics), depends on estimates of the pausing-time density, ψ(t),
and the jump density, h(x). A ﬁrst and simpler approach consists in assuming
that these densities are independent. However, in many practical situations
one certainly expects some degree of correlation, in the sense that large return
increments are infrequent. We have proposed two possible ways to model this
correlation. We have described some general features of the formalism that
hold for any model of correlation between sojourn times and return jumps.
Thus (i) the variance grows linearly with time as t increases, and (ii) the tails
of the return distribution p(x, t) have the same appearance than those of the
jump density h(x). We have also applied the direct formalism to data provided
by the U.S. dollar/Deutsche mark future exchange rate. High frequency data
indicate that ψ(t) and h(x) are well described by power-law densities. We have
therefore shown that the volatility has a diﬀusion-like behavior at long times
and that the tails of the return distribution, p(x, t), follow a power law with
the same exponent as that of h(x).

We have applied the inverse formalism to daily data provided by four compa-
nies: IBM, Gillette, Dupont and 3M. We have focused on the volatility and
its behavior as a function of the time lag. The data for all companies exhibit
a slight but clearly anomalous diﬀusive behavior at short times since the vari-
ance can be ﬁtted with a polynomial function growing as tα in the short time
regime (few days), and as was expected, the variance describes an ordinary
diﬀusion-like behavior for return changes of a week or more, that is, a linear
dependence on time for large time lags. All of this implies that the shortest-
day behavior of the unknown pausing-time density ψ(t) follows a power law
consistent with high frequency data for the US-Deutsche mark case and that
for larger times the pausing-time density decays exponentially.

Finally, these results seem to indicate the suitability of the CTRW framework
to study other complex issues in ﬁnance. We can mention that the present
formalism can be useful in the study of problems related to large ﬂuctuations
and extreme values central to risk control and also to exotic derivative pricing.
All of these are under present investigation.

Acknowledgements

This work has been supported in part by Direcci´on General de Investigaci´on
under contract No. BFM2003-04574 and by Generalitat de Catalunya under
contract No. 2000 SGR-00023. We acknowledge J. M. Porr`a and Gaesco Bolsa
S.V. y B. for providing daily data.

28

A Asymptotic results

Let us prove the results given in Section 3.1. Since ∆X and T are random
variables representing respectively returns increments and sojourn times, we
can write ˆρ(ω, s) in the form (see Eq. (4))

ˆρ(ω, s) =

exp

iω∆X

h

{

sT

.

}i

−

Expanding this average around s = 0, we get

ˆρ(ω, s)

˜h(ω)

s

T eiω∆X

≃

−

h

i

s
(cid:16)

T

1

−

,

≪ h

i

(cid:17)

(A.1)

(A.2)

(A.3)

(A.4)

where

h
On the other hand, if we assume that the sojourn-time density ψ(t) has a
ﬁnite ﬁrst moment, then

i

˜h(ω) =

eiω∆X

.

ˆψ(s)

1

s

T

h

i

−

≃

s

(cid:16)

T

1

−

,

≪ h

i

(cid:17)

where

is the mean sojourn time. Therefore, from Eq. (10) we have

T

h

i

ˆp0(ω, s)

T

≃ h

i

s

(cid:16)

T

1

−

.

≪ h

i

(cid:17)

Substituting Eqs. (A.1) and (A.3) into Eq. (9) yields

ˆp(ω, s)

T
i
h
˜h(ω) + s
h

≃

1

−

T eiω∆X

i

s

(cid:16)

T

1

−

.

≪ h

i

(cid:17)

By virtue of Tauberian theorems (Handelsman and Lew 1974), the asymptotic
behavior of the characteristic function ˜p(ω, t) as t
will be given by the
inverse Laplace transform of Eq. (A.4). The resulting inverse reads

→ ∞

˜p(ω, t)

T
h
T eiω∆X

i

exp

(−

i

˜h(ω)]t

−
T eiω∆X

[1

h

)

i

≃

h

(t

T

) .

≫ h

i

(A.5)

We emphasize that the asymptotic expression in Eq. (A.5) is totally general
regardless of the correlation between sojourn times T and return increments
∆X, requiring only that the mean sojourn time
be ﬁnite. Obviously for a
usable form of this asymptotic expression we will need to know the correlation
between T and ∆X. In other words, we will have to specify a form for ρ(x, t)

T

h

i

29

since the correlation appearing in Eq. (A.5) is related to ˆρ by

Thus, for instance, making use of ansatz in Eq. (14), we have

T eiω∆X

=

i

−

h

∂
∂s

ˆρ(ω, s)

.

(cid:12)
s=0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T eiω∆X

h

=

T

h

i

i

˜h2(ω)

so that

˜p(ω, t)

1
˜h2(ω)

≃

exp

(−

˜h(ω)]t
˜h2(ω) )

[1

−
T
i

h

(t

T

) .

≫ h

i

(A.6)

Now assume that h(x) has a ﬁnite second moment µ2 so that ˜h(ω)
as µ2ω2
≪
the Gaussian density

µ2ω2/2
1. In this case, for values of ω suﬃciently small, Eq. (A.5) yields

≃

−

1

˜p(ω, t)

≃

µ2tω2/2
T
h

i,

e−

which is equivalent to the result given by the central limit theorem.

On the other hand, for a long-tailed jump density for which ˜h(ω)
α for
small ω (note that if 0 < α < 2, h(x) has inﬁnite variance) and assuming that
for ω small
, we obtain from Eq. (A.5) the L´evy distribution

T eiω∆X

≃

−

ω

T

k

1

|

|

h

i ≃ h

i

˜p(ω, t)

≃

e−

k

ω

|

αt/
T
h

|

i.

We ﬁnally show that the tails of the return pdf p(x, t) are the same as that of
x
the jump pdf h(x). Indeed, as is well known the tails of p(x, t) as
| → ∞
are determined by the behavior of its characteristic function as ω
0 (Weiss
1994). Thus suppose that ω is small so that
and t is moderate
in the sense that the approximation given in Eq. (A.5) is still valid but in such
1. Then from Eq. (A.5) we see that for small ω,
a way that [1

˜h(ω)]t/

T eiω∆X

|
→

i ≃ h

T

T

h

i

−

h

i ≪

˜p(ω, t)

[1

˜h(ω)]t/

∼ −

−

T

,

i

h

which for large values of

is equivalent to

x
|

|

p(x, t)

h(x),

t
T

h

i

∼

(t

T

) .

≈ h

i

Therefore, we have proved Eq. (24) in item (c) of Section 3.1 and shown that
the tails of p(x, t) are equal to the tails of h(x).

30

B Pausing time density limits

In order to get the asymptotic behavior of ψ(t) as t
0, we ﬁrst
write the Kummer function appearing in Eq. (49) in terms of the incomplete
gamma function: U(a, a, x) = exΓ(1
a, x) (Magnus et al. 1966). Therefore,

and as t

→ ∞

→

ˆψ(s) =

[kΓ(α)]1/α
µ1/α
2 s

ekΓ(α)/µ2sα

Γ [1

1/α, kΓ(α)/µ2sα] .

(B.1)

−

−

Now, using Tauberian theorems (Handelsman and Lew 1974), the behavior
as t
while the
behavior of ψ(t) as t

0 of ψ(t) will be given by the behavior of ˆψ(s) as s
0.

is determined by ˆψ(s) as s

→ ∞

→

→ ∞

→

(a) Short-time behavior. We use the following series representation of the in-
complete gamma function:

Γ(β, x) = e−

L(β)
n (x)
n + 1

xxβ ∞
Xn=0

= e−

xxβ

L(β)
n (0)
n + 1

∞

"

Xn=0

+ O(x)

,

#

β = 1

1/α,

−

x = kΓ(α)/µsα,

n (x) are the generalized Laguerre polynomials (Magnus et al.). Since

n (0) = Γ(1 + β + n)/n!Γ(1 + β), we have

Γ(β, x) = e−

x

Axβ + O
h

(cid:16)

xβ+1

,

(cid:17)i

where

and L(β)
L(β)

where

Hence

A =

∞

Xn=0

Γ(1 + β + n)
n!Γ(1 + β)

.

ˆψ(s) =

AkΓ(α)
µ2

s−

α + O

2α

µ2s−
k2Γ(α)2 !

,

 

which implies (Handelsman and Lew)

ψ(t)

Ak
µ2

≃

1

tα
−

(ktα

µ2) .

≪

(B.2)

(B.3)

(b) Long-time behavior. In order to obtain the long-time behavior of the den-
sity ψ(t) corresponding to the volatility, we employ the following asymptotic
behavior for the gamma function (Magnus et al.):

Γ(β, x) = e−

xxβ

−

1

1

(1

β)

+ O

−

−

(cid:20)

1
x

1
x2

(cid:18)

(cid:19)(cid:21)

.

31

Thus

ˆψ(s) = 1

µ2sα
αkΓ(α)

−

+ O

µ2s2α
k2Γ(α)2 !

,

 

and (Handelsman and Lew)

µ2

ψ(t)

≃

kΓ(

α)Γ(1 + α)

−

1

t−

−

α

(ktα

µ2) .

≫

(B.4)

References

Bachelier, L., 1900. Th´eorie de la Sp´eculation. Paris: Gauthier-Villars.

Cootner, P. H. (Ed.), 1964. The Random Character of Stock Market Prices.
Cambridge: The MIT Press.

Cox, J., Ross, S., 1976. The valuation of options for alternative stochastic
processes. Journal of Financial Economics 3, 145-166.

Cox, D. R., 1965. Renewal Theory. New-York: John Wiley and Sons.

Erdelyi, A., 1954. Tables of Integral Transforms. New York: McGraw-Hill.

Fama, E., 1963. Mandelbrot and the stable Paretian hypothesis. Journal of
Business 35, 420-429.

Gopikrishnan, P., Plerou, V., Nunes Amaral, L. A., Meyer, M., and Stanley,
H. E., 1999. Scaling of the Distributions of Fluctuations of Financial Market
Indices. Physical Review E 60, 5305-5316.

Handelsman, R. A., Lew, J. S., 1974. Asymptotic expansion of Laplace
convolutions for large argument and tail densities for certain sums of random
variables. SIAM Journal on Mathematical Analysis 5, 425-451.

Helmstetter, A., Sornette, D., 2002. Diﬀusion of epicenters of earthquake
aftershocks, Omori’s law, and generalized continuous-time random walk
models. Physical Review E 66, 061104.

Kotulski, M., 1995. Asymptotic distributions of continuous-time random
walks: a probabilistic approach. Journal of Statistical Physics 81, 777-792.

Kutner, R., ´Swita la, F., 2003. Stochastic simulations of time series within
Weierstrass-Mandelbrot walks. Quantitative Finance 3, 201-211.

Lawrence, J. K., Cadavid, A. C., Ruzmaikin, A., Berger, T. E., 2001.
Spatiotemporal Scaling of Solar Surface Flows. Physical Review Letters 86,
5894-5897.

Lighthill, M. J., 1980. An Introduction to Fourier analysis and Generalized
Functions. Cambridge: Cambridge University Press.

32

Magnus, W., Oberhettinger, F., Soni, R. P., 1966. Formulas and Theorems
for the Special Functions of Mathematical Physics. Berlin and New York:
Springer-Verlag.

Mainardi, F., Roberto, M., Gorenﬂo, R., Scalas, E., 2000. Fractional calculus
and continuous-time ﬁnance II: the waiting-time distribution. Physica A 287,
468-481.

Mandelbrot, B., 1963. The variation of certain speculative prices. Journal of
Business 35, 394-419.

Mantegna, R. N., Stanley, H. E., 1995. Scaling behavior in the dynamics of an
economic index. Nature 376, 46-49.

Masoliver, J., Montero, M., Weiss, G. H., 2003. Continuous-time random-walk
model for ﬁnancial distributions. Physical Review E 67, 021112.

Merton, R. C., 1976. Option Pricing when underlying stock returns are
discontinuous. Journal of Financial Economics 3, 125-144.

Montroll, E. W., Shlesinger, M. F., 1984. Nonequilibrium Phenomena II: From
stochastics to hydrodynamics. In: Lebowitz, J. L., Montroll, E. W. (Eds.).
Amsterdam: North-Holland, 1-121.

Montroll, E. W., Weiss, G. H., 1965. Random Walks on Lattices, II. Journal
of Mathematical Physics 6, 167-181.

Pearson, K., 1905. The problem of the Random Walk. Nature 72, 294.

Plerou, V., Gopikrishnan, P., Nunes Amaral, L. A., Meyer, M., Stanley,
H. E., 1999. Scaling of the Distribution of Price Fluctuations of Individual
Companies. Physical Review E 60, 6519-6529.

Raberto, M., Scalas, E., Mainardi, F., 2002. Waiting-times and returns in
high-frequency ﬁnancial data: an empirical study. Physica A 314, 749-755.

Roberts, G. E., Kaufman, H., 1966. Table of Laplace transforms. Philadelphia
and London: W. B. Saunders Company.

Scalas, E., Gorenﬂo, R., Mainardi, F., 2000. Fractional calculus and
continuous-time ﬁnance. Physica A 284, 376-384.

Stehfest, H.,
Communications of the Association for Computing Machinery 13, 47-49.

1970. Numerical

inversion

Laplace

of

transforms,

Weiss, G. H., 1994. Aspects and Applications of the Random Walk.
Amsterdam: North-Holland.

Wilmott, P., 1999. Derivatives. Chichester: John Wiley and Sons.

33

