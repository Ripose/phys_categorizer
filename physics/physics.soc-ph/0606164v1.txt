6
0
0
2
 
n
u
J
 
8
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
4
6
1
6
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Analysis of aggregated tick returns: evidence for anomalous diﬀusion

Philipp Weber
Institut f¨ur Theoretische Physik, Universit¨at zu K¨oln, 50937 K¨oln, Germany∗
(Dated: September 21, 2013)

In order to investigate the origin of large price ﬂuctuations, we analyze stock price changes of ten
frequently traded NASDAQ stocks in the year 2002. Though the inﬂuence of the trading frequency
on the aggregate return in a certain time interval is important, it cannot alone explain the heavy
tailed distribution of stock price changes. For this reason, we analyze intervals with a ﬁxed number
of trades in order to eliminate the inﬂuence of the trading frequency and investigate the relevance of
other factors for the aggregate return. We show that in tick time the price follows a discrete diﬀusion
process with a variable step width while the diﬀerence between the number of steps in positive and
negative direction in an interval is Gaussian distributed. The step width is given by the return due
to a single trade and is long-term correlated in tick time. Hence, its mean value can well characterize
an interval of many trades and turns out to be an important determinant for large aggregate returns.
We also present a statistical model reproducing the cumulative distribution of aggregate returns.
For an accurate agreement with the empirical distribution, we also take into account asymmetries
of the step widths in diﬀerent directions together with crosscorrelations between these asymmetries
and the mean step width as well as the signs of the steps.

The mechanics of stock price changes were studied al-
ready more than a hundred years ago, when Bachelier
modelled price movements as a diﬀusion process with
Gaussian ﬂuctuations [1]. However, empirical studies
show that the distribution of returns has heavy tails
[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], meaning that events
with large price changes are much more probable than
in a Gaussian distribution.
In addition, the functional
form of the distribution stays similar if the return is ag-
gregated on very diﬀerent time scales from seconds to
months, approximating a Gaussian distribution only if
the time scale becomes very large [2, 3].

These ﬁndings would suggest that stock returns have a
L´evy stable distribution [2, 13, 14, 15]. In a L´evy ﬂight,
the second moment would be divergent and extreme re-
turns aggregated over a long time would be determined
by very large price jumps on smaller time scales. How-
ever, empirical studies ﬁnd evidence that the tail of the
return distribution follows a power law with exponent
around α
1 = 3 so that it does not agree with the stable
Paretian hypothesis [3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21].

−

The cause of the fat tails is currently a subject of great
interest [22, 23, 24, 25, 26]. Farmer et al. ﬁnd that
the distribution of returns due to a single trade (tick re-
turns) is similar to the distribution of returns aggregated
on longer time scales with the same tail exponent [25].
Although the tail exponent is outside the L´evy regime
0 < α
1 < 2, they argue that similar to a L´evy ﬂight
both distributions are caused by the same microscopic
mechanism, so that large aggregate returns are due to
single exceptionally large tick returns. Plerou et al. de-
scribe the price movements as a diﬀusion process with a
ﬂuctuating diﬀusion constant and relate the distribution
of aggregate returns to the distribution of the variance of

−

∗Electronic address: pw@thp.uni-koeln.de

the tick returns [26].

In the present paper, we investigate the transition from
tick returns to returns aggregated in intervals with a
larger number of trades. It is well documented (e.g. in
[27, 28]) that the number of trades in a time interval is
an important determinant of the aggregate return. How-
ever, the trading frequency alone cannot account for the
observed fat tailed distribution of aggregate returns [26].
Thus, we remove the direct inﬂuence of the trading fre-
quency by analyzing intervals with a constant number of
trades so that eﬀects due to other quantities like the tick
return size are more clearly visible.

We study how each aggregate return is actually built
from the basic quantities involved in the process, and
thus examine the mechanism leading to large price ﬂuc-
tuations. According to the central limit theorem, inde-
pendent tick returns would in aggregation lead to Gaus-
sian distributed returns. However, we ﬁnd that the tick
return size is long-term correlated in tick time (com-
pare [29, 30, 31, 32, 33, 34, 35, 36, 37]), so that the
conditions of the central limit theorem are not fulﬁlled.
Thus, the mean tick return size can well characterize an
interval of many trades and its ﬂuctuations lead to the
non-Gaussian behavior of the aggregate return. In this
picture, large aggregate returns do not occur because of a
few very large tick returns, but rather when the average
tick return is large, so that even Gaussian ﬂuctuations in
the direction of the trades can lead to aggregate return
larger than in a Gaussian distribution.

The remainder of this paper is organized as follows:
section I shows our model for the price diﬀusion pro-
cess, in section II we describe the data set used for this
study, section III shows the inﬂuence of the tick return
size on the aggregate return while section IV focusses on
the inﬂuence of diﬀerences in the direction of tick returns
(number diﬀerence). Section V compares the number dif-
ference and the ﬂow of market orders and in section VI
we present a statistical model which approximates the

2

distribution of aggregate returns. We conclude with a
discussion of our results in section VII.

I. MODEL

We study intervals with a ﬁxed number of N = 100
trades. If the price of a stock before the i-th trade is si,
we deﬁne the return due to a single trade, the tick return,
as

δgi = ln(si+1)

ln(si) .

(1)

−

The interval Ij contains all N trades with index i be-
tween jN and (j + 1)N , so the aggregate return Gj is
given by the sum over all δgi with iǫIj:

Gj = X
iǫIj

δgi

.

(2)

We want to discuss two special cases in order to ana-
lyze the mechanism leading to large aggregate returns
Gj. In the ﬁrst case, Gj is dominated by one (or a few)
extremely large δgmax

, so that

i0

Gj = δgmax

i0 + X

δgi ≈

δgmax
i0

.

iǫIj ,i6=i0

(3)

Thus, Gj becomes large if δgmax

is exceptionally large.
i0
In the second case, we assume that there is no ex-
tremely large tick return dominating the aggregate re-
turn, so that we focus on the average size ∆gj of the
non-zero tick returns, which is deﬁned by

∆gj =

1
nj

X
δgi6=0,iǫIj

δgi|
|

(4)

= 0 in the interval Ij.
Here, nj is the number of δgi
=
Neglecting assymetries in the δgi, we can replace all δgi 6
0 by sign(δgi)∆gj and approximate the aggregate return
by

Gj ≈

∆gj X

sign(δgi) = ∆gj∆Nj

(5)

δgi6=0,iǫIj

where ∆Nj = Pδgi6=0,iǫIj sign(δgi) is called number dif-
ference. Similarly, Gj can be described as a diﬀusion
process with

(cid:10)G2

j (cid:11) ≈

DjN

(6)

where the diﬀusion constant Dj = nj
j varies due to
the varying step width ∆gj and the number nj of non-
zero tick returns.

N ∆g2

In the approximation given by Eq. 5, we can study the
inﬂuence of the mean size of the tick returns as well as
asymmetries in their direction. A large aggregate return
can occur if the price moves more often in one direction

than in the other. Thus, with large temporary corre-
lations between the signs, even small tick returns could
compose a large Gj. On the other hand, if ∆gj is larger,
even a small asymmetry in the signs can lead to a large
return.

The two approximations given in Eq. 3 and Eq. 5 are
analyzed in sections III and IV of this paper, but in sec-
tion VI we also consider the error term neglected in Eq. 5.
An exact formulation writes

Gj = ∆gj∆Nj +

j n−
2n+
nj

j

(∆g+

j −

∆g−
j )

(7)

j and ∆g−

where ∆g+
j are the average tick returns in posi-
j and n−
tive and negative direction while n+
j are the num-
bers of non-negative tick returns in positive and negative
direction.

II. DATA ANALYSIS

We analyzed order book data of the year 2002 from Is-
land ECN for the ten most frequently traded stocks [38].
Since the Island ECN is a secondary market where only
part of the whole stock volume is traded, we also studied
the index fund QQQ which was mainly traded via Island
until September 2002. Since our results for the ten stocks
and QQQ are similar, we ﬁnd no evidence that secondary
market characteristics of Island aﬀect our analysis nega-
tively.

In an electronic market place like Island, people can
place limit orders to buy or to sell at a given or better
price (limit price), which is speciﬁed in the order. These
orders are stored in the order book and they are only
executed when the actual stock price reaches the limit
price. A trade is initiated by a market order indicating
that someone wants to buy or sell immediately at the
best available price. Such a market order executes the
limit orders oﬀering the best prices until the number of
shares speciﬁed in the market order is traded.

Our dataset contains information about every limit or-
der so that we are able to reproduce the market situation
at each instant of time. We combine those limit order
executions with identical time stamps as they reﬂect the
same market order. Therefore, we can analyze the impact
of each single market order on the price. In this analysis,
the price is deﬁned as the mid-quote price which is the
mean of the best available buy (bid) and sell (ask) limit
prices (quotes). We study intervals with a ﬁxed num-
ber of N = 100 market orders and have approximately
100,000 intervals in our dataset for ten stocks. Thus,
on average a 100 trade interval corresponds to about 10
minutes, but the trading frequency ﬂuctuates strongly
so that 100 trades can correspond to time intervals with
very diﬀerent lengths.

We determine the mid-quote price si just before the
execution of the i-th market order. Since most trades
change the price just by the size of the gap between the

6
(a)

(b)

max+

δgj

max-

δgj

1

0.8

0.6

0.4

0.2

0

0.8

0.6

0.4

0.2

0

0

3

number of events (color coded)

|Gj|

8

7

6

5

4

3

2

1

0

50000

rank

100000

j

j

FIG. 1: (Color online) Five largest price changes (a) δgmax+
and (b) δgmax−
due to a single trade with (a) the same and
(b) the opposite sign as the aggregate return in that 100 tick
interval, plotted against the rank of the corresponding aggre-
gate return |Gj | for the combined data of ten Nasdaq stocks
in 2002 (smoothed by averaging over 100 intervals). For large
|Gj |, the size of the δgmax+
increases by a factor of two while
the increase in the δgmax−
is slightly smaller. The sum over
all ﬁve δgmax+
reaches more than 3 standard deviations for
intervals with extremely large |Gj |, but the ﬂuctuations in the
opposite direction are almost equally large.

j

j

j

best and the second best limit price [25], the tick re-
turn δgi corresponds to the gap size. We note that the
price can (and often does) change between two consec-
utive market orders due to placement or cancellation of
limit orders so that δgi does not provide a direct estimate
of the gap size. We normalize the tick returns δgi by the
standard deviation of the aggregate return Gj for each
stock individually so that we can combine the results for
diﬀerent stocks.

III.

INFLUENCE OF THE SIZE OF TICK

RETURNS

First, we investigate the question whether large tick
returns caused by large gaps in the order book can be
responsible for large aggregate returns. To this end, we
start with the approximation shown in Eq. 3 where a
few extremely large tick returns (corresponding to some
very large gaps in the order book) lead to a very large
In order to test this hypothesis,
aggregate return Gj.
we analyzed the ﬁve largest tick returns δgmax+
with the
same sign as the aggregate return Gj (i.e. the ﬁve largest
positive δgi if Gj > 0 and the ﬁve largest negative δgi for
Gj < 0) in each time interval. To this end, we sort the
and plot the δgmax+
against the rank
intervals by

j

j

Gj|
|

0

0.1

0.2

0.4

0.5

0.3

∆gj

FIG. 2: Density plot of the 100-trade-return |Gj | of ten Nas-
daq stocks against the average return of a single trade ∆gj
for each interval. The Points are coded from light grey to
black indicating the number of events from 1 to more than
500. A linear regression has only a small correlation coeﬃ-
cient R2 = 0.07.

j

of the interval according to its return

Fig. 1(a) shows the values of these δgmax+

.
Gj|
|
in inter-
0 on the left while the values for
vals with small Gj ≈
large returns exceeding ﬁve standard deviations can be
found on the right. Since there are large ﬂuctuations
in the data, we smoothed the curves by averaging over
100 intervals. The δgmax+
grow by a factor of two be-
. When aggre-
tween small and very large returns
gated, these ﬁve largest δgmax+
can reach about three
j
standard deviations, which is almost half of the largest
aggregate returns.

Gj|
|

j

In Fig. 1(b), we plot the ﬁve largest tick returns
δgmax−
with the opposite direction as the aggregate re-
j
turn against their rank. The δgmax−
behave similarly
to the δgmax+
, though the increase for large aggregate
returns is slightly weaker. However, even for the largest
aggregate returns the diﬀerence between the δgmax+
and
δgmax−
is rather small, so that there are also large tick
j
returns reducing the aggregate return.

j

j

j

Our results suggest that large aggregate returns are not
the result of single exceptionally large tick returns since
very large tick returns occur in both directions and cancel
each other out. In the following, we want to focus not
on the extreme tick returns, but on the inﬂuence of their
mean value. More precisely, we analyze Eq. 5 and the
δgi|
in the interval
mean tick return ∆gj of all non-zero
|
Ij as deﬁned in Eq. 4. A density plot of
against ∆gj
Gj|
|
is shown in Fig. 2. It seems that extremely large returns
Gj correspond to larger average tick returns ∆gj, but the
broad distribution suggests that the explanatory power
of ∆gj alone for the aggregate return Gj is small, which
is conﬁrmed by the low correlation coeﬃcient R2 = 0.07
of a linear regression.

In order to clarify the relation between the extreme

empirical data
empirical data (shuffled)
simulation

4

0.2

0.15

∆gj

0.1

0.05

0

0

0.1

|

i

g
δ
|
 
f
o
 
n
o
i
t
a
l
e
r
r
o
c
o
t
u
a

-0.16

~ x

50000

rank

100000

0.02

1

10

100

1000

time lag [tick time]

FIG. 3: (Color online) Black curve: average tick return ∆gj
of ten Nasdaq stocks plotted against the rank of the corre-
sponding aggregate return |Gj |, smoothed by averaging over
100 intervals. Going from the smallest returns |Gj | ≈ 0 to
returns larger than 5 standard deviations, ∆gj increases by a
factor of two. Light grey curve: after shuﬄing the tick returns
for each stock, the same curve is only slightly increased for
the largest aggregate returns, the eﬀect is much smaller than
for the original data. Blue curve (or dark grey): the simu-
lation according to the statistical model discussed in section
VI shows a similar behaviour as the empirical data, but in
the simulation ∆gj is a little larger than the empirical one
except for the largest |Gj | where the simulated ∆gj is slightly
smaller than the empirical one.

Gj|
|
Gj|
|

and ∆gj, we sort the intervals by

values of
Gj|
Gj|
|
|
and plot ∆gj against the rank of the interval according
to its return
. In Fig. 3 (black curve), we see that
coincide with larger tick returns as ∆gj
large returns
changes by a factor of two from very low aggregate re-
turns to large returns of several standard deviations. In
comparison with the largest tick returns δgmax+
shown
in Fig. 1, the change of a factor of two is similar, but the
mean ∆gj is two to four times smaller than the largest
tick returns.

j

This ﬁnding can be explained by the presence of au-
tocorrelations in the time series of δgi, which can be il-
lustrated when we shuﬄe the data for each stock by ex-
changing each tick return with another randomly chosen
tick return. The light grey curve in Fig. 3 shows that for
shuﬄed data ∆gj increases only marginally for large ag-
gregate returns, suggesting that autocorrelations of the
tick returns have a strong inﬂuence on the mean tick re-
turn size ∆gj. Indeed, we ﬁnd that the absolute values
of the tick return are long-range correlated in tick
δgi|
|
time with a correlation function decaying like ∆i−0.16 for
large time lags ∆i =
, as shown in Fig. 4. If these
i2|
correlations are destroyed by shuﬄing, in each interval of
100 trades only a few large tick returns remain so that
the average over these 100 tick returns approximates the
global mean of all tick returns in the data set.

i1 −
|

In contrast, in the empirical unshuﬄed data correla-
tions lead to intervals where many tick returns are large,
so that the average tick return size is also large. The

FIG. 4: Autocorrelation function of the absolute value of the
tick return |δgi| averaged over the data of ten Nasdaq stocks
in 2002. The function shows a power law decay in tick time
proportional to ∆i−0.16 for large ∆i.

average tick return size ∆gj can well characterize the in-
terval only because these autocorrelations exist. It turns
out that the increase of ∆gj by a factor of two is the
main eﬀect where the original empirical data deviates
signiﬁcantly from shuﬄed data. Hence, we suggest that
ﬂuctuations of the tick return size are responsible for the
non-Gaussian ﬂuctuations of the aggregate return.

Using Eq. 5, we can estimate whether the change by a
factor of two of the average tick return alone is enough
to explain large aggregate returns Gj of more than ﬁve
standard deviations. To this end, we focus on the inter-
vals with the 50 largest aggregate returns ranging from
approximately 4 to almost 8 standard deviations. Here,
we ﬁnd that ∆gj ﬂuctuates between 0.13 and 0.35. As-
suming uncorrelated returns, ∆Nj should be of the order
√N
10 if each trade would lead to a price change, but
normal ﬂuctuations could well lead to ∆Nj twice as large
as √N , so that large tick returns together with ﬂuctu-
ations in the number diﬀerence could explain the large
aggregate returns we ﬁnd in our data set.

≈

Thus, we ﬁnd that in intervals with 100 trades large
do not mainly depend on single extremely large tick
Gj|
|
returns. It rather turns out that correlations between the
tick returns lead to large average tick returns ∆gj in an
interval, and the ﬂuctuations of ∆gj can account for the
non-Gaussian distribution of the aggregate returns.

IV. NUMBER DIFFERENCE

The diﬀusion process of aggregate returns is not only
inﬂuenced by the step width (i.e. the tick return size),
but also by the direction of the steps. Therefore, we now
analyze the inﬂuence of the number diﬀerence ∆Nj in
Eq. 5. In order to treat positive and negative aggregate
returns in the same analysis, it is useful to replace ∆Nj

number of events (color coded)

empirical data
empirical data (shuffled)
simulation

5

|Gj|

8

7

6

5

4

3

2

1

0

20

15

∆nj

10

5

0

0

-20

0

20

40

∆nj

FIG. 5: Density plot of the aggregate return |Gj | against the
diﬀerence ∆nj between the number of tick returns with the
same and with the opposite direction as the aggregate return,
for ten Nasdaq stocks. The points are coded from light grey
to black indicating the number of events from 1 to more than
600. A linear regression has a large correlation coeﬃcient
R2 = 0.32.

by the sign-adapted number diﬀerence

∆nj = sign(Gj)∆Nj

.

(8)

A positive value of ∆nj indicates that the price tends to
move in one speciﬁc direction leading to an aggregate re-
turn with the same sign. ∆nj can be negative if there are
a few large tick returns determining the direction of the
aggregate return, but also many small tick returns with
the opposite direction which do not aﬀect the aggregate
return very much. Fig. 5 shows a density plot of the
aggregate return
against the sign-adapted number
diﬀerence ∆nj. A linear regression yields an R2 of 0.32,
a large correlation coeﬃcient conﬁrming the visual im-
pression that ∆nj and
are strongly connected. We
can also see that ∆nj is mostly positive for large returns
Gj, so that each large price change is accompanied by a
certain sign-adapted number diﬀerence ∆nj.

Gj|
|

Gj|
|

We now plot in Fig. 6 ∆nj against the rank according
to
. We ﬁnd that except for the largest (approxi-
Gj|
|
mately 15%) of the aggregate returns, ∆nj grows linearly
with the rank while in Fig. 3 ∆gj remained almost con-
stant in that region. For the largest ranks, ∆n increases
more rapidly, so that all in all the smoothed curve (aver-
aged over 100 intervals) grows from 0 to 18 between very
small and extremely large aggregate returns. Thus, in in-
tervals with very large returns there are approximately 18
trades pushing the price in one direction (assuming that
all other trades cancel each other out), so that even with
rather small tick returns this can lead to large returns in
aggregation. Focusing on the 50 largest Gj, we ﬁnd that
∆nj ranges from 8 to 35, clearly above the expected stan-
dard deviation of 10 when assuming uncorrelated returns
and nj = N .

50000

rank

100000

FIG. 6: (Color online) Black curve: the sign-adapted number
diﬀerence ∆nj is plotted against the rank according to the
aggregate return |Gj | for 10 Nasdaq stocks, smoothed by av-
eraging over 100 intervals. ∆nj grows from zero to 18. The
relation between ∆nj and the rank seems to be linear except
for the largest 15% of the aggregate returns. A simulation
(blue curve (or dark grey)) using a normal distribution for
∆Nj leads to nearly the same dependance on the rank. For
shuﬄed data (light grey curve), the curve is slightly ﬂatter,
but the diﬀerence is not large.

Thus, the ﬂuctuations of ∆nj around the mean value
are crucial for getting large aggregate returns. The num-
ber diﬀerence seems to be the main mechanism aﬀecting
the aggregate return since it changes much more drasti-
cally than the tick return size when the aggregate return
increases. On the other hand, when we compare the re-
sults to the analysis with shuﬄed data (light grey curve
in Fig. 6), it turns out that this eﬀect is very similar to
what happens with random price changes. Hence, the
basic movement of the aggregate return seems to depend
mostly on the number diﬀerence, but the non-Gaussian
large aggregate price changes only occur if the tick re-
turns are large.

V. MARKET ORDER SIGNS AND DIRECTION
OF TICK RETURNS

It is known that the signs of market orders are strongly
correlated [39, 40] which means that there is a large prob-
ability that a buy market order will be followed by an-
other buy market order. Thus, it is probable that large
number diﬀerences in the direction of tick returns are
caused by large numbers of equally signed market or-
ders. In order to analyze the relation between the num-
ber diﬀerence and the market order ﬂow, we deﬁne the
j between the number nm+
diﬀerence ∆nm
of market or-
ders with the same direction as Gj and the market orders
with opposite direction nm−
:

j

j

∆nm

j = nm+

j −

nm−
j

.

(9)

number of events (color coded)

empirical data
simulation

6

∆nj

40

20

0

-20

-100

-50

50

100

0
∆nj

m

FIG. 7: Comparison between sign-adapted number diﬀerence
∆nj and market order diﬀerence ∆nm
for ten Nasdaq stocks.
j
The Points are coded from light grey to black indicating the
number of events from 1 to more than 200. The correlation
coeﬃcient of a linear regression yields R2 = 0.29, thus there
is a strong connection between the two quantities. On the
other hand, the events scatter widely so that small ∆n are
often linked with large ∆nm

j and vice versa.

In Fig. 7 we plot the sign-adapted number diﬀerence
∆nj against the market order diﬀerence ∆nm
j . We ﬁnd a
strong correlation between ∆nj and ∆nm
j , a linear regres-
sion yields a correlation coeﬃcient R2 of 0.29. However,
there are also large ﬂuctuations suggesting that the num-
ber diﬀerence is also due to order book dynamics, namely
limit order placement and cancellation as well as asym-
metries in the order book. A model for price formation
due to these quantities was recently proposed by Mike
and Farmer [41].

VI. DISTRIBUTION OF AGGREGATE
RETURNS AND A STATISTICAL MODEL

In the ﬁrst part of this paper, we analyzed the mech-
anism leading to large aggregate returns and showed
that the varying step width ∆gj accounts for the non-
Gaussian behavior of the diﬀusion process of price move-
ments. Now we want to use our results in a statistical
model and reproduce the cumulative distribution func-
tion of the absolute value of the aggregate return

The model given by Eq. 5 belongs to the well-known
class of stochastic volatility models (see e.g. [42]) con-
sisting of a noise term multiplied by a time-dependent
volatility giving the magnitude of the ﬂuctuations.
In
the present paper, the model is based on a microscopic
description of the price process, so that we can ﬁt the
microscopic quantities determining the aggregate return
in order to estimate the parameters of the model. In this
approach the model is parameter-free in the sense that
there are no parameters ﬁtting the aggregate returns di-
rectly, though we ﬁt the distributions of its determinants

.
Gj|
|

(a)

(b)

n
o
i
t
u
b
i
r
t
s
i
d

 
e
v
i
t
a
l
u
m
u
c

0
10

-1

10

-2

10

-3

10

-4

10

-5

10

)

j

N
∆
(
P

-2

10

-3

10

-4

10

-5

10

0
10

-1

10

-2

10

-3

10

-4

10

-5

10

0

n
o
i
t
u
b
i
r
t
s
i
d
 
e
v
i
t
a
l
u
m
u
c

0

0.1

0.2

0.4

0.5

0.3
∆gj

0
∆Nj

empirical data
simulation

-40

-30

-20

-10

10

20

30

40

(c)

empirical data positive values
empirical data negative values
fit to empirical data
simulation

0.1

∆gj

+

-

 - ∆gj

0.2

FIG. 8:
(Color online) Estimation of the parameters for
the simulation (results shown as dotted lines) from empir-
ical data for ten Nasdaq stocks.
(a) The tail of the cu-
mulative distribution of ∆gj (line) can be well ﬁtted with
P (x > ∆gj) = e−a(x−x0)/∆¯g where ∆¯g ≈ 0.12 is the average
of all ∆gj and the parameters are a = 3.6 and x0 = 0.094.
For ∆gj . x0 the limited tick size leads to a plateau. (b)
The probability distribution of ∆Nj (line) follows in good ap-
proximation a normal distribution with mean 0.24 and stan-
dard deviation 9.0. (c) As a rough approximation, the aver-
age of the cumulative distribution of the positive (line) and
negative (dashed line) values of ∆g+
j are parameter-
ized proportional to two exponential functions e−a1,2x/∆¯g for
|∆g+
j | ≶ 0.1, with a1 = 8.0 and a2 = 4.8 (dashdotted
line). The simulation (dotted line) uses the adapted a1 = 9.0
and a2 = 2.0 in order to compensate the change in the distri-
bution after taking into account (cid:10)∆g+

j − ∆g−

j − ∆g−

j − ∆g−

j (cid:11)∆gj ∆Nj

.

like the step width ∆gj and the number diﬀerence ∆Nj.
We also discuss corrections to the model by including the
tick return asymmetries according to Eq. 7.

We ﬁrst analyze the distributions of ∆gj and ∆Nj.
Fig. 8(a) shows the cumulative distribution of ∆gj in a
log-linear plot. The approximately straight line suggests
that the tail follows an exponential distribution which

empirical data
simulation of Gj = ∆gj
simulation of Gj = ∆gj
with independent quantities
simulation of Gj = ∆gj
taking into account <∆gj

+

∆Nj
∆Nj + 28.7 (∆gj

∆Nj + 28.7 (∆gj
 - ∆gj
∆Nj

>∆gj

-

+

 - ∆gj

-

)

+

 - ∆gj

-

)

0
10

-1

10

-2

10

-3

10

-4

10

n
o
i
t
u
b
i
r
t
s
i
d
 
e
v
i
t
a
l
u
m
u
c

-5

10

0

2

4

6

8

10

|Gj|

FIG. 9: (Color online) Cumulative distribution of the em-
pirical aggregate return (circles) obtained from ten Nasdaq
stocks in comparison with diﬀerent simulations. A simulation
of Eq. 5 (triangles) leads to a reasonable approximation of the
empirical data, but it overestimates the probability of large
returns. It becomes a little broader if we add the tick return
asymmetry ∆g+
j according to Eq. 7 and simulate in-
dependent quantities (diamonds). The simulation (squares)
matches the empirical data very well if we incorporate corre-
lations by generating ∆g+
j according to the conditional
expectation value (cid:10)∆g+
j (cid:11)∆gj ∆Nj

j −∆g−
j − ∆g−

j − ∆g−

.

≈

can be well ﬁtted with P (x > ∆gj) = e−a(x−x0)/∆¯g where
∆¯g
0.12 is the average of all ∆gj and the parameters
are a = 3.6 and x0 = 0.094. In the region of the smallest
values of ∆gj . x0 the limited tick sizes of the diﬀerent
stocks lead to a plateau. In section IV we already found
evidence that ∆Nj behaves similarly to uncorrelated data
since in Fig. 6 the shuﬄed data shows almost the same
. Figure
dependence on the rank of the corresponding
8(b) shows that indeed ∆Nj can be well described by a
Gaussian noise with mean 0.24 and standard deviation
9.0.

Gj|
|

In order to analyze the accuracy of the approximation
given in Eq. 5, we simulate two independent time series
according to the ﬁtted functions for ∆gj and ∆Nj and
build the aggregate return Gj as the product of ∆gj and
∆Nj. In Figure 9 we can compare the empirically found
cumulative distribution of aggregate returns
(circles)
to the results of this simulation (triangles). The simula-
tion of Eq. 5 leads to a reasonable agreement with the
actual aggregate return, but it overestimates the proba-
bility of large aggregate returns. We note that the pa-
rameters of the simulation are completely determined by
the empirically found distributions of ∆gj and ∆Nj, so
that in this sense the simulation of
has no free pa-
rameters.

Gj|
|

Gj|
|

In the following, we want to address the remaining de-
viations of the simulation from the empirical data. Eq. 7
gives an exact formula for Gj and provides a good pa-

7

rameterization for the error term which reads

j

(10)

j −

(∆g+

∆g−
j )

Gj −

∆gj∆Nj =

j n−
2n+
nj
j n−
We ﬁnd that the term 2n+
j /nj has no systematic in-
ﬂuence on the aggregate return since it shows almost no
dependence on the rank according to the aggregate re-
turn. In the following, we thus approximate it by its av-
j n−
erage value (cid:10)2n+
j /nj(cid:11) = 28.7, so that the error term is
determined by the asymmetries ∆g+
in the mean
j −
tick return size.
The cumulative distribution of ∆g+

is shown
in Fig. 8(c). The main part of the distribution could be
well ﬁtted by an exponential function, but in the tail the
distribution becomes broader. Thus, we add the term
with ∆g+
to our simulation by creating a third
independent time series according to the empirical distri-
bution of ∆g+
j . Fig. 9 (diamonds) shows that this
leads to an even broader distribution of the aggregate re-
turn. Since the diﬀerence to the distribution according
to Eq. 5 is small, the tick return asymmetry seems to
have only a small inﬂuence on the aggregate return.

∆g−
j

∆g−
j

∆g−
j

∆g−

j −

j −

j −

A more accurate agreement with the empirical data
can be obtained by taking into account correlations be-
tween the quantities involved in the process. The correla-
tion coeﬃcients between them are shown in the following
table where the correlations between the absolute values
are shown in brackets:

∆Nj

∆g+

j − ∆g−

j ∆gj∆Nj

-0.02 (-0.07) -0.01 (0.37) -0.01 (0.34)

1

-0.35 (0.01) 0.95 (0.87)

∆gj

∆Nj

∆gj∆Nj 0.95 (0.87)

-0.41 (0.02)

1

j −

∆g−

∆Nj|
|

∆gj and
show slightly negative correlations which
might suggest that people act more cautiously when large
tick returns indicate a low liquidity.
In these times,
traders try not to place too many consecutive orders with
the same sign because they know that it could lead to
a large price change and increased trading costs. Fur-
thermore, the strong anti-correlations between ∆Nj and
∆g+
j also indicate cautious traders: If there are
large asymmetries, so that e.g. the positive tick returns
are much larger than the negative ones, people tend to
use the higher liquidity in negative direction so that in
these times they sell more often than they buy. For an
analysis of the relation between liquidity imbalance and
market eﬃciency, see e.g. [43]. The large correlations
∆g−
between ∆gj and
show that we can expect
j |
j −
large variations of the tick return in positive and negative
direction when the tick return is in general large.

∆g+
|

We now want to incorporate correlations in our simu-
lation. The strongest non-trivial correlations appear be-
tween ∆gj∆Nj and ∆g+
including also some of

∆g−
j

j −

8

j

j

N
∆
g
∆
>

-

j

g
∆
 
-
 

+

g
∆
<

j

0.2

0.1

0

-0.1

-0.2

empirical data

fit leading to - 0.0057 sgn(x) x

1.59

-6

-4

-2

2

4

6

0
∆Nj
∆gj

j − ∆g−

j − ∆g−

(Color online) Conditional expectation value
FIG. 10:
(cid:10)∆g+
plotted against ∆gj∆Nj (circles), ob-
j (cid:11)∆gj ∆Nj
A ﬁt
tained from the data of 10 Nasdaq stocks.
leads to (cid:10)∆g+
≈ −0.0057 · sgn(∆gj∆Nj) ·
j (cid:11)∆gj ∆Nj
(∆gj∆Nj )1.59 (dashed line). The tick return asymmetry
∆g+
is strongly correlated with the mean tick return
size ∆gj and strongly anti-correlated with the number dif-
ference ∆Nj . Using the conditional expectation value in the
simulation incorporates these correlations which allows for the
reproduction of the distribution of aggregate returns.

j − ∆g−

j

∆g−

j −

the correlations between ∆g+
j and ∆gj as well as
∆Nj. However, it turns out that the conditional expec-
tation value (cid:10)∆g+
is non-linear, as seen
j (cid:11)∆gj ∆Nj
in Fig. 10 (circles) where it is plotted against ∆gj∆Nj.
β with
The function can be well ﬁtted by
|
−
α = 0.0057 and β = 1.59 (dashed line).

x
sgn(x)α
|

∆g−

j −

j −

j −

j −

∆g−

∆g−

∆g−

to ∆g+

j (cid:11)∆gj∆Nj

In order to incorporate this conditional expectation
value into the simulation, we ﬁrst create three inde-
∆g−
pendent time series for ∆gj, ∆Nj, and ∆g+
j .
Then, for each j we add the conditional expectation value
(cid:10)∆g+
j , according to the
value of ∆gj∆Nj for that j. This method leads to a dif-
ferent distribution for ∆g+
j than the initial one,
j −
so that we can not anymore generate ∆g+
from
the unconditional empirical distribution. As a rough ap-
proximation, we parameterize this distribution by two
exponential functions e−a1,2x/∆¯g for ∆g+
j ≶ 0.1.
Then, we adapt the factors in the exponent in such a
way that the resulting unconditional distribution ﬁts the
empirical one (a ﬁt to the empirical distribution yields
a1 = 8.0 and a2 = 4.8, for the simulation we use the
adapted a1 = 9.0 and a2 = 2.0, compare Fig. 8(c)). The
resulting distribution of Gj does not depend very much
on the exact values of a1,2.

∆g−
j

∆g−

j −

j −

The eﬀect of the correlations represented by the con-
ditional expectation value (cid:10)∆g+
is very
large and leads to a cumulative distribution of
Gj|
|
(squares in Fig. 9) very similar to the empirical one (cir-
cles). It is worth noting that now the largest events are

j (cid:11)∆gj ∆Nj

∆g−

j −

not anymore necessarily the ones with the largest values
of ∆gj∆Nj. Due to the anti-correlations expressed in
(cid:10)∆g+
, very large values of ∆gj∆Nj can
lead to relatively large values of ∆g+
j of the op-
posite sign reducing the aggregate return.

j (cid:11)∆gj ∆Nj

∆g−

∆g−

j −

j −

In addition to the distribution of the aggregate return,
the simulation does also agree with other properties of
the empirical data we found earlier in this paper.
In
Fig. 3 and 6 we also plotted the data from the simulation
against the rank according to the aggregate return
.
Gj|
|
For ∆Nj the simulation matches the empirical data very
well, while in Figure 3 we see that the simulated ∆gj
shows the same dependence on the rank as the empirical
data, but it is generally a little larger than the real one
except for the largest aggregate returns, which might be
due to the cutoﬀ around 0.094 we used in the simulation
of the distribution of ∆gj. We also ﬁnd that the role of
∆g+
in determining large aggregate returns is a
little overestimated by our simulation, but the simulation
covers the main features of the empirical data although
we neglected many of the subtle relations between the
diﬀerent quantities.

∆g−
j

j −

VII. DISCUSSION AND CONCLUSION

Our results can be divided into two parts: First, we
showed that the movement of stock prices in intervals
with a constant number of trades can be understood as a
diﬀusion process with a varying step width. Here, Gaus-
sian ﬂuctuations of the number diﬀerence determine the
basic price movement, but the non-Gaussian large price
changes are due to changes in the tick return size coin-
ciding with large number diﬀerences at the same time.
The large inﬂuence of the tick return size is caused by its
autocorrelations assuring that in a 100 tick interval one
can ﬁnd many large tick returns so that the mean value of
the tick return can be large. In such intervals, the price
change in response to a trade is large, which is referred
to as a period of low liquidity. Thus, the diﬀusion pro-
cess of stock returns depends largely on ﬂuctuations in
the liquidity, in agreement with the ﬁndings of previous
works [23, 24, 25, 26].

In the second part of this paper, we found that the dis-
tribution of aggregate returns can be reasonably approxi-
mated by simulating the microscopic quantities mean tick
return size and number diﬀerence according to their em-
pirically found distributions. A more accurate agreement
can be obtained by taking into account asymmetries in
the tick return size in positive and negative direction as
well as correlations between the diﬀerent quantities.

To conclude, we found evidence that price ﬂuctuations
in intervals with a constant number of trades can be de-
scribed by a diﬀusion process with a varying step width.
The long-term autocorrelations in the tick return size
make sure that periods of low liquidity, where the price
change due to a trade is large, last long enough to cause
large aggregate returns in intervals with many trades.

Our results suggests that the power law distribution of
aggregate returns might not be universal but rather de-
pends on a more complicated mechanism which is a com-
bination of the dynamics of the trading frequency, the
dynamics of the step width and the Gaussian process of
the step direction.

Acknowledgment

I would like to thank Bernd Rosenow for collaboration
in the initial phase of the project, many helpful discus-

[1] L. Bachelier, “Th´eorie de la sp´eculation” [Ph.D. thesis in
mathematics], Annales Scientiﬁques de l’Ecole Normale
Sup´erieure III-17, 21 (1900).

[2] B. B. Mandelbrot, J. Business 36, 394 (1963).
[3] R. N. Mantegna and H. E. Stanley, Nature (London) 376,

46 (1995).

[4] T. Lux, Applied Financial Econonomics 6, 463 (1996).
[5] P. Gopikrishnan, M. Meyer, L. A. N. Amaral, and
H. E. Stanley, European Physical J. B 3, 139 (1998).
[6] U. A. Muller, M. M. Dacorogna, and O. V. Pictet,
“Heavy Tails in High-Frequency Financial Data,” in A
Practical Guide to Heavy Tails, edited by R. J. Adler,
R. E. Feldman, and M. S. Taqqu (Birkh¨auser Publishers,
1998), p. 83.

[7] V. Plerou, P. Gopikrishnan, L. A. N. Amaral, M. Meyer,
and H. E. Stanley, Physical Review E 60, 6519 (1999);
P. Gopikrishnan, V. Plerou, X. Gabaix, and H. E. Stan-
ley, ibid. 62, 4493 (2000).

[8] A. Pagan, J. Empirical Finance 3, 15 (1996).
[9] E. F. Fama, J. Business 38, 34 (1965).
[10] R. N. Mantegna and H. E. Stanley, Nature 383, 587

(1996).

(1997).

[12] F. M. Longin, The asymptotic distribution of extreme
stock market returns, J. Business, 69(3), 383-408 (1996).

[13] E. F. Fama, J. Business 36, 420 (1963).
[14] V. Pareto, Cours d’Economie Politique (Lausanne and

[15] P. L´evy, Th´eorie de l’Addition des Variables Al´eatoires

(Gauthier-Villars, Paris, 1937).

[16] P. Gopikrishnan, V. Plerou, L. A. N. Amaral, M. Meyer,

and H. E. Stanley, Physical Review E 60, 5305 (1999).

[17] P. K. Clark, Econometrica 41, 135 (1973).
[18] R. R. Oﬃcer, J. American Statistical Association. 67,

[19] P. D. Praetz, J. Business 45, 49 (1972).
[20] R. C. Blattberg and N. Gonedes, J. Business 47, 244

[21] M. Loretan and P. C. B. Phillips, J. Empirical Finance

807 (1972).

(1974).

1, 211 (1994).

[22] X. Gabaix, P. Gopikrishnan, V. Plerou and H. E. Stanley,

Nature (London) 423, 267 (2003).

[23] P. Weber and B. Rosenow, in Proceedings of the Third
Nikkei Econophysics Research Workshop and Sympo-
sium, The Fruits of Econophysics, Tokyo, November

sions, and a critical reading of the manuscript.
thank Fengzhong Wang for useful conversations.

I also

9

2004 , edited by H. Takayasu (Springer-Verlag, Berlin,
2005), p. 88.

[24] P. Weber and B. Rosenow, Quantitative Finance 6, 7

(2006).

[25] J. D. Farmer, L. Gillemot, F. Lillo, S. Mike, and A. Sen,

Quantitative Finance 4(4), 383 (2004).

[26] V. Plerou, P. Gopikrishnan, L. A. N. Amaral, X. Gabaix,
and H. E. Stanley, Physical Review E 62(3), R3023-
R3026 (2000).

[27] C. M. Jones, G. Kaul, M. L. Lipson, Review of Financial

Studies, 7(4), 631-651 (1994).

[28] D. Easley, N. M. Kiefer, M. O’Hara, Review of Financial

Studies, 10(3), 805-835 (1997).

[29] Z. Ding, C. W. J. Granger and R. F. Engle, J. Empirical

[30] C. W. J. Granger and Z. Ding Annales d’Economie et de

Finance 1, 83 (1993).

Statistique 40, 67 (1995).

[31] Z. Ding and C. W. J. Granger J. Econometrics 50, 987

[32] T. G. Andersen and T. Bollerslev, J. Finance 52, 975

(1996).

(1997).

[33] Y. Liu, P. Cizeau, M. Meyer, C.-K. Peng, and H. E. Stan-

[34] P. Cizeau, Y. Liu, M. Meyer, C.-K. Peng, and H. E. Stan-

ley, Physica A 245, 441 (1997).

[35] R. Cont, Ph.D. thesis, Universite de Paris XI, 1998 (un-

published); see also e-print cond-mat/9705075.

[36] M. Pasquini and M. Serva, Economics Letters 65, 275

[37] Y. Liu, P. Gopikrishnan, P. Cizeau, M. Meyer, C.-
K. Peng, and H. E. Stanley, Physical Review E 60, 1390
(1999).

[38] We analyzed the following companies (ticker symbols):
AMAT, BRCD, BRCM, CSCO, INTC, KLAC, MSFT,
ORCL, QLGC, SEBL.

[39] J. P. Bouchaud, Y. Gefen, M. Potters, and M. Wyart,

Quantitative Finance, 4(2), 176-190 (2004).

[40] F. Lillo and J. D. Farmer, Studies in Nonlinear Dynamics

& Econometrics, 8(3) (2004).

[41] S. Mike and D. Farmer, physics/0509194 (2005).
[42] J. Y. Campbell, A. W. Lo, A. C. MacKinlay, The Econo-
metrics of Financial Markets, Priceton University Press
(1997).

[43] J. D. Farmer, A. Gerig, F. Lillo, and S. Mike,

physics/0602015 (2006).

[11] R. N. Mantegna and H. E. Stanley, Physica A 239, 255

ley, Physica A 245, 437 (1997).

Paris, 1897).

(1999).

