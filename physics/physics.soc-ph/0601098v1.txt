6
0
0
2
 
n
a
J
 
3
1
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
8
9
0
1
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

MARKET MILL DEPENDENCE PATTERN IN THE STOCK
MARKET: ASYMMETRY STRUCTURE, NONLINEAR
CORRELATIONS AND PREDICTABILITY

Andrei Leonidov(a,b,c)1, Vladimir Trainin(b),
Alexander Zaitsev(b), Sergey Zaitsev(b)

(a) Theoretical Physics Department, P.N. Lebedev Physics Institute,
Moscow, Russia

(b) Letra Group, LLC, Boston, Massachusetts, USA
(c) Institute of Theoretical and Experimental Physics, Moscow, Russia

Abstract

An empirical study of joint bivariate probability distribution of two con-
secutive price increments for a set of stocks at time scales ranging from one
minute to thirty minutes reveals asymmetric structures with respect to the
axes y = 0, y = x, x = 0 and y =
x. All four asymmetry patterns remark-
ably resemble a four-blade mill called market mill pattern. The four market
mill patterns characterize diﬀerent aspects of interdependence between past
(push) and future (response) price increments. When analyzed in appropriate
coordinates, each pattern corresponds to a particular nonlinear dependence
between the push and conditional mean of response. Qualitative interpre-
tation of each pattern is discussed. The market mill pattern is an evidence
of complex dependence properties relating past and future price increments
resulting in various types of nonlinear correlation and predictability.

−

1Corresponding author. E-mail leonidov@lpi.ru

1

1 Introduction

The apparent randomness of stock price dynamics explains a dominant role
of the random walk paradigm in theoretical ﬁnance. The evolution of stock
prices is indeed close to being random, but a careful statistical analysis re-
veals a number of characteristic dependence patterns such as correlations
between simultaneous increments of diﬀerent stocks, statistically signiﬁcant
autocorrelations at intraday timescales, volatility clustering, leverage eﬀect,
etc., that became a part of a standard toolkit for model - building [1, 2, 3, 4].
Each of these eﬀects corresponds to some sort of probabilistic dependence
between lagged and/or simultaneous price increments.

A general way of quantifying the probabilistic dependence providing a
full description of the set of quantities under consideration is to specify the
corresponding multidimensional probability distribution, from which one can
calculate all quantities of interest such as various conditional distributions
and their moments. Generically such distributions can depend on simulta-
neous and lagged price increments, traded volumes, etc.

Our approach to studying the dynamical patterns in the stock price evolu-
tion [5, 6, 7] is based on a direct analysis of such multidimensional probability
distributions. A simplest case we concentrate upon in our studies [5, 6, 7] is
that of a bivariate distribution describing the interdependence of two price
increments in two coinciding or non-overlapping time intervals. Even here
there is quite a few cases to analyze: the increments can be simultaneous and
belong to diﬀerent stocks or lagged and belong to the same stock or diﬀerent
stocks, the time lag separating the intervals can vary, etc. The interde-
pendence between lagged price increments for the same stock was termed
”horizontal” and the one between simultaneous price increments of diﬀerent
stocks termed ”vertical” in [5], where both horizontal and vertical dependen-
cies were considered. In the present paper we focus on the horizontal case
only.

Despite of the fundamental importance of the issue, a list of papers on
multidimensional probability distributions of stock price increments is, to
the best of our knowledge, not abundant. A theoretical analysis of bivariate
distribution of returns in two consecutive intervals in the particular case of
Levy-type marginals was performed by Mandelbrot [8], where some interest-
ing geometric features of this distribution both for the case of independent
and dependent returns were described. As discussed in [9], the bivariate
distribution in question can be considered as a ”ﬁngerprint” reﬂecting the

2

nature of the pattern embracing the two consecutive returns.

Recently an analysis of conditional dynamics of volatility exploiting con-
ditional distributions was described in [10]. Let us also mention direct studies
of the above-described bivariate distributions for returns in consequent time
intervals that revealed interesting phenomena such as the ”compass rose”
[11, 12, 13]. The conclusions on whether the discovered patterns are re-
lated to predictability diﬀered: whereas [11] found no predictability, in [13]
an interesting pattern of wavelet-ﬁltered series corresponding to partial pre-
dictability was found. The ﬁrst moment of corresponding conditional distri-
bution for daily time intervals was studied in [14]. Another line of research is
an explicit analytical reconstruction of the bivariate distribution in question
using copulas, see e.g. [15, 16, 17, 18].

Any dependence between lagged price increments means that certain
characteristics of price evolution are predictable. The issues of predictability
and market eﬃciency are of paramount importance for theoretical ﬁnance.
The analysis of the present paper is relevant in this context because a key
quantity characterizing predictability, the conditional mean [19, 20, 21, 22,
23], is determined by the conditional distribution of the increment in the
second interval at given increment in the ﬁrst one. Let us emphasize that
the proﬁtability of a strategy given the existence of the nonzero conditional
mean requires, in each and every case, a separate analysis. A particular ex-
ample of potential proﬁt from high frequency anticorrelations of stock price
returns was discussed in [4]. The properties of conditional mean are most
often discussed in the context of verifying the martingale property of the
ﬁnancial series [24] which is, in turn, a generally accepted outcome of market
eﬃciency.

The paper is organized as follows.
In paragraph 2.1 we describe the market data used in our study and
elaborate on basic points behind the probabilistic methodology used in its
analysis.

Main empirical results of the paper are described in paragraph 2.2. We
begin with discussing the symmetry properties of the joint bivariate distri-
bution of price increments in two consecutive time intervals, termed push
and response. The distribution is shown to be approximately invariant with
respect to rotations at a multiple of π/2. This gives rise to a number of re-
lations between the probabilities of certain two-step processes. We continue
with discussing four asymmetries of the bivariate distribution with respect to
x: asymmetry of conditional response,
the axes y = 0, y = x, x = 0 and y =

−

3

asymmetry with respect to increment’s ordering , asymmetry of conditional
push and asymmetry of mirror orderings correspondingly. Remarkably all of
these asymmetries are characterized by the same geometric pattern termed
market mill. The asymmetries are shown to result from the basic geometry
of the full distribution described at the beginning of the section.

In paragraph 2.3 we discuss major outcomes from the market mill pat-
terns. In particular a nonlinear dependence of the conditional mean response
on the push clearly demonstrates the nonlinear nature of correlations between
the two variables in the considered bivariate probability distribution. The
market mill pattern signals the market ineﬃciency at intraday time scales
resulting from temporal interdependencies between consecutive price incre-
ments.

We conclude by formulating the main results and outline of the future

work in paragraph 3.

2 Asymmetry patterns in price dynamics

2.1 Data and Methodology

Our study of high frequency dynamics of stock prices are based on data on
the prices of 100 stocks traded in NYSE and NASDAQ in 2003-2004 sampled
at 1 minute frequency2.

A method of analyzing dependence patterns in ﬁnancial market dynamics
adopted in the present paper, see also [5, 6, 7], is based on a direct exami-
nation of multivariate probability distributions and conditional distributions
constructed from them. Below we shall restrict our consideration to the bi-
variate distribution of stock price increments in two non-overlapping time
intervals.

Let us consider two non-overlapping time intervals of length ∆T1 and ∆T2.
The time ordering is such that the interval ∆T2 follows after the interval ∆T1.
Generically the end of the ﬁrst interval and the beginning of the second can be
separated by some time interval but in most of cases under consideration the
second interval immediately follows the ﬁrst one. In this case we are dealing
with two price increments δp(∆T1) = p(t)
∆T1) and δp(∆T2) =
p(t). In what follows we shall denote the price increment in the
p(t + ∆T2)
2All holidays, weekends and oﬀ-market hours are excluded from the dataset. The list

p(t

−

−

−

of stocks is given in the Appendix.

4

ﬁrst interval δp(∆T1) by x (push) and that in the second one δp(∆T2) by y
(response). Below we consider the case of ∆T1 = ∆T2 = ∆T and study four
time scales ∆T = 1 min, 3 min., 6 min. and 30 min.

The full probabilistic picture of interrelation between the push and re-
(x, y). This is the most
sponse is given by a bivariate probability density
comprehensive quantity from which other quantities of practical interest
In particular, one can compute the conditional proba-
could be derived.
(x) describing the probabilistic shape
(y
bility distribution
of response at given push.

(x, y)/

x) =

P

P

P

P

|

Let us stress that in the present paper we consider the joint probability
distribution characterizing a set of stocks. The distribution is termed joint
because a set of events (pairs of increments) under consideration uniﬁes all
subsets of events characterizing individual stocks. Studying the properties of
(x, y) is the main goal of the present paper
the joint bivariate distribution
and the companion paper [6]. Bivariate distributions for individual stocks
are considered in the companion paper [7].

P

Let us now comment on our choice of price increments and not price
returns as basic variables. The question of a choice of the ”right” variable
is by no means trivial. The full picture may well be the one using both
increments and returns at diﬀerent time scales. At intraday time scales
the market participants use strategies based on evaluating price moves in
dollars, while at larger time scales (e.g. weeks) they are rather formulated
and realized in terms of returns. The particular scheme interpolating between
price increments at small time scales and returns at large ones is described in
[4]. Let us emphasize that we have checked that the main results described
in the paper are valid for normalized returns as well.

2.2 Empirical results: market mill patterns

Let us now turn to discussing the structure of push - response relationship
by considering the market data on price increments in two consecutive 1 -
minute intervals. As discussed in the previous section, the full probabilistic
picture of the two-step push - response process is described by the probability
(x, y) 3 is
(x, y). The two - dimensional projection of log8 P
distribution
3In all plots we are using the log2n scale for the probability distribution so that the
equiprobability lines diﬀer by the factor of 2n. The particular values of n are chosen to
show the distribution geometry in the most clear fashion. The borders between diﬀerent
colors correspond to the equiprobability lines.

P

5

plotted in Fig. 10 4. This distribution turns out to have many remarkable
properties that we analyze below and in the companion papers [6, 7].

To facilitate the analysis let us sketch the shape of the equiprobability
levels in Fig. 1, in which the xy plane is divided into sectors numbered

IV

V

III

II

VI

VII

I

VIII

Figure 1: Sketch of the equiprobability levels of the bivariate distribution

(x, y). Straight lines are drawn to guide the eye.

P

counterclockwise from I to VIII.

The ﬁrst striking property of the bivariate distribution

(x, y) is its ap-
proximate invariance with respect to rotations at the multiples of π/2. In
ζ2 the symme-
terms of sample paths composed by the increments
try with respect to rotations at multiples of π/2 leads to a chain of equalities5

ζ1 and

±

±

P

(ζ1, ζ2) =

(

ζ2, ζ1) =

(

ζ1,

ζ2) =

(ζ2,

ζ1)

P

P

−

P
Second, let us stress that naively expected commutativity of price increments
(ζ2, ζ1) is violated by the asymmetries of the
under addition
(x, y) analyzed in full details in the next paragraph.
bivariate distribution
4The paper contains charts in ”eps” and ”png” formats. The numeration is such that

(ζ1, ζ2) =

−

−

−

P

P

P

P

(1)

the ”png” charts follow the ”eps” ones.

5A quantitative analysis of these properties is presented in the companion paper [6].

6

Thus a simple interchange of price increments ζ1 ↔
price dynamics.

ζ2 is not a symmetry of

The third crucial property of the

(x, y) is that all even sectors are
”stronger” (containing more probability) than the odd ones. This leads to a
number of remarkable consequences described in the next paragraph.

P

2.2.1 Asymmetry of conditional response

(x, y) with respect to
Let us ﬁrst analyze the symmetry of the distribution
the axis y = 0. In term of sectors shown in Fig. 1 we compare sector I versus
sector VIII, sector II versus sector VII, etc. To arrange a convenient frame-
work for analyzing this question let us separate the two-dimensional distribu-
s
a
I components:
tion
I
P

(x, y) into a sum of symmetric

6 and antisymmetric

P

P

P

(x, y) =

P

s
I +

a
I
P

P

(2)

where

s
I =

P

1
2

(

P

(x, y) +

(x,

y))

and

P

−

a
I =

P

1
2

(

P

(x, y)

(x,

y))

(3)

− P

−

This decomposition is of course not a sum of two probability densities. To
a
I (y, x) one should
provide a probabilistic meaning for the asymmetric term
consider only its positive part.

P

P

a(p)
I
P

(x, y) = θ [

To get a better visual picture of the asymmetric component

P
] is a Heaviside step function. The deﬁnition of

a
I (x, y)]
let us consider its positive part
a(p)
θ[
I
·
P
that no information is lost when imposing this restriction.
a(p)
show a two-dimensional projection of the surface log4 P
I
$
−

a
I (x, y)
P
a
I (x, y), where
(x, y) guarantees
In Fig. 8 we
(x, y) in the range
0.3 <= x, y <= $ 0.3 for the case of two consequent 1 - minute intervals.
We see that the plot in Fig. 8 demonstrates a remarkable four - blade
mill - like pattern or simply the market mill pattern. Before analyzing this
asymmetry in more details, let us point out that the overall asymmetry, if
measured with respect to the symmetric component, is of order of 5 percent,
so we are in fact dealing with a small asymmetric component on top of the
dominating symmetric one.

To study the structure of the response asymmetry

in more details,
let us consider the sections of its surface by the constant push planes x =
6We use a subscript ”I” to index the ﬁrst of the four asymmetries considered in the

a(p)
I
P

paper.

7

const. In Fig. 9 we show three response proﬁles for log4 P
values of x = $ 0.01, 0.07, 0.25 .

a(p)
I

for the push

For small pushes we observe a clear example of the skewed distribution.
The small negative response after the small initial positive push happens
quite often, but is outweighted by the positive tail corresponding to big pos-
itive response. So, a reaction to the small push is either the small contrarian
response or the big followup in the direction of the initial push separated by
the gap. At medium pushes the situation becomes more balanced: contrar-
ian mechanism eats away a large chunk of the response asymmetry space.
Finally, for large pushes the response is purely contrarian.

A dependence of the response pattern on the magnitude of the push
(x).
is best quantiﬁed by the conditional distribution
In particular the market mill structure shown in Fig. 8 leads to a very
nontrivial z-shaped nonlinear behavior of the conditional mean response
x). To illustrate this phenomenon we plot in Fig. 2 the
y
h
dependence of the conditional mean response on the push at three time scales
∆T = 1 min., 3 min. and 6 min.

(x, y)/

x) =

x =

dy y

(y

(y

P

P

P

P

R

i

|

|

To clarify the relation between the market mill pattern shown in Fig. 8 and
the behavior of the conditional response let us note that the decomposition
of the two-dimensional distribution in Eqs. (2,3) generates a corresponding
x) into symmetric and
decomposition of the conditional distribution
antisymmetric parts

(y

P

|

(y

x) =

s
I (y

x) +

a
I (y

x)

P
It is easy to check that the conditional response
asymmetric component only:

P

P

|

|

|

h

i

y

x is a functional of the

y

h

x

i

≡ Z

dy y

(y

x) =

dy y

P

|

Z

a
I (y

x)

|

P

so that the nontrivial nonlinear response shown in Fig. 2 directly follows from
the market mill pattern of Fig. 8. In terms of sectors shown in Fig. 1 the
nonlinear mean response follows from the fact that at small x > 0 contribu-
tion of sector II is stronger than that of sector VIII while at larger x sector
VIII starts dominating over sector II, etc.

Let us illustrate the asymmetry of conditional mean by considering a
sample price trajectory in the xy plane composed by two consecutive price
increments ζ1 and ζ2. The existence of the market mill structure shown in

(4)

(5)

8

1 min => 1 min(cid:13)

3 min => 3 min(cid:13)

6 min => 6 min(cid:13)

(cid:13)

$

 
,
)
e
s
n
o
p
s
e
r
 
n
a
e
m

(
 
y

-0.15(cid:13)

-0.12(cid:13)

-0.09(cid:13)

-0.06(cid:13)

-0.03(cid:13)

0.00(cid:13)

0.03(cid:13)

0.06(cid:13)

0.09(cid:13)

0.12(cid:13)

0.15(cid:13)

Figure 2: Mean conditional response, 1 min =
min =

6 min

⇒

1 min, 3 min =

3 min, 6

⇒

⇒

−

Fig. 8 means that the probability
P
equal to that of the combination (ζ1,

(ζ1, ζ2) of the combination (ζ1, ζ2) is not

ζ2), see the diagram in Fig. 3.

How does the market mill asymmetry depend on the length of the time
interval? To study this question we have examined a set of intervals of
length ∆T = 6 and 30 minutes. The corresponding asymmetries are shown
in Figures. 11-12. All the plots show the presence of the market mill structure
which is progressively becoming more noisy with the growing length of the
interval. Let us also mention that if we have a gap between the two time
intervals under consideration, the market mill structure is still present. This
is illustrated in Fig. 13 where we show the asymmetry for two 1 minute
intervals separated by 1 minute gap.

Mean response(cid:13)

0.010(cid:13)

0.008(cid:13)

0.006(cid:13)

0.004(cid:13)

0.002(cid:13)

0.000(cid:13)

-0.002(cid:13)

-0.004(cid:13)

-0.006(cid:13)

-0.008(cid:13)

-0.010(cid:13)

x (push), $(cid:13)

9

p(t)

1

2

-z

2

?

t

Figure 3: Diagram illustrating the conditional response asymmetry

2.2.2 Asymmetry with respect to increment’s ordering

Let us now analyze the symmetry properties of
axis y = x. The appropriate decomposition of
antisymmetric contributions reads

P
P

(x, y) with respect to the
(x, y) into symmetric and

(x, y) =

P

s
II +

a
II

P

P

(6)

where

s
II =

P

1
2

(

P

(x, y) +

(y, x))

and

P

a
II =

P

1
2

(
P

(x, y)

(y, x))

(7)

− P

P

a(p)
II

, where

a(p)
A two-dimensional projection of log4 P
is a positive compo-
II
a
II, is plotted in Fig. 14 showing the market mill
nent of the asymmetric part
pattern similar to the one for the asymmetry of the conditional response in
paragraph 2.2.1. The diﬀerence is that for the market mill in paragraph 2.2.1
the ﬁrst blade (sector 2) with respect to the axis y = 0 is one sector away
from it, while here the ﬁrst blade (the same sector 2) is the sector closest to
the axis y = x. This diﬀerence results in speciﬁc z-shaped pattern discussed
below, see Fig. 4.

P

Another way of analyzing the symmetry properties of

(x, y) is to intro-

P

duce new coordinates

z =

(x + y) ;

¯z =

1
√2

1
√2

(y

x)

−

(8)

10

z
(cid:13)
z
(cid:13)
(cid:13)
which means that we have rotated the original coordinate axes at φ = π/4.
This speciﬁc rotation is chosen because geometrically the symmetry with
respect to the transformation x
y is the symmetry upon reﬂection with
respect to the axis x = y, which in the new coordinates (z, ¯z) a symmetry
with respect to the axis ¯z = 0. In new coordinates

←→

s
II =

P

1
2

(

P

(z, ¯z) +

(z,

¯z))

and

P

−

a
II =

P

1
2

(

P

(z, ¯z)

(z,

¯z))

(9)

− P

−

The properties of the distribution (9) can be conveniently analyzed by con-
z). In Fig. 4 we plot the conditional
(¯z
sidering a conditional distribution
|
time scale. We see the z-shaped structure
mean

z versus z at 1 min.

P

¯z
i

h

1 min => 1 min(cid:13)

(cid:13)

$

 
,

Z

 

-0.15(cid:13)

-0.12(cid:13)

-0.09(cid:13)

-0.06(cid:13)

-0.03(cid:13)

0.00(cid:13)

0.03(cid:13)

0.06(cid:13)

0.09(cid:13)

0.12(cid:13)

0.15(cid:13)

Figure 4: Conditional mean with respect to the axis y = x, 1 min =

1 min

⇒

analogous to the one discussed in the previous paragraph, with the diﬀer-
ence that the conditional mean ¯z is now trend-following at large
> z0,
< z0. This asymmetry of the
where z0 ∼

$ 0.1, and contrarian at small

z

z

|

|

|

|

Mean Z(cid:13)

0.008(cid:13)

0.006(cid:13)

0.004(cid:13)

0.002(cid:13)

0.000(cid:13)

-0.002(cid:13)

-0.004(cid:13)

-0.006(cid:13)

-0.008(cid:13)

Z , $(cid:13)

11

¯z
i

z is, of course, another manifestation of the basic asym-
conditional mean
metry with respect to the transformation x
y. To illustrate conclusions
following from the pattern plotted in Fig. 4, let us again consider the sample
path (ζ1, ζ2) and list the basic patterns:

←→

h

−

−

ζ1 + ζ2 <

z0 =
z0 < ζ1 + ζ2 < 0 =
0 < ζ1 + ζ2 < z0 =
ζ1 + ζ2 > z0 =

⇒
⇒
⇒
⇒

on average ζ2 < ζ1
on average ζ2 > ζ1
on average ζ2 < ζ1
on average ζ2 > ζ1

(10)

A clear interpretation of the asymmetry with respect to the axis y = x is

obtained by comparing the probabilities of two sample paths

Path 1: Push ζ1, response ζ2, ζ1 + ζ2 ﬁxed, probability

(ζ1, ζ2)

Path 2: Push ζ2, response ζ1, ζ2 + ζ1 ﬁxed, probability

(ζ2, ζ1)

P

P

•

•

This is illustrated in the diagram in Fig. 5. The market mill pattern corre-

2

1

?

p(t)

1

2

t

Figure 5: Diagram illustrating the asymmetry with respect to increment’s
ordering

(x, y) with respect to the axis y = x leads
sponding to the asymmetry of
therefore to the striking conclusion that the ordering of the price increments
is probabilistically essential!

P

12

z
(cid:13)
z
(cid:13)
z
(cid:13)
z
(cid:13)
2.2.3 Conditional push asymmetry

(x, y) with
Let us turn to the analysis of the symmetry of the distribution
respect to the axis x = 0. The appropriate separation of the full distribution
into symmetric and antisymmetric parts reads

P

(x, y) =

P

s
III +

a
III ,

P

P

(11)

where

s
III =

P

1
2

(

P

(x, y) +

(

x, y)) and

P

−

a
III =

P

1
2

(

P

(x, y)

(

x, y)) (12)

− P

−

We are thus dealing with an ”inverse” relation between the push and re-
sponse, namely, with the structure of push patterns leading to a given re-
sponse. A two-dimensional projection of log4 P
is a positive
a
component of the asymmetric part
III, is plotted in Fig. 15. It shows the
same market mill pattern as characterizing the asymmetry of conditional
response discussed in paragraph 2.2.1. All the discussion on the asymme-
try of conditional response can be repeated here for the conditional push.
This includes, in particular, the zigzag structure of the dependence of mean
conditional push on response

a(p)
III , where

a(p)
III

P

P

y.

Another way of looking at this problem is a rotation of the axes at φ =

x
i

h

π/2:

z = y ;

¯z =

x

−

(13)

followed by the corresponding decomposition of the full probability distribu-
tion with respect to the axis ¯z = 0.

The asymmetry of conditional push corresponds to considering the prob-
(ζ1, ζ2)
ζ1, ζ2), so that we are interested in the properties of the ”prehistory”

abilities of the two sample paths (ζ1, ζ2) and (
and
of the increment in the second interval ζ2, see the diagram in Fig. 6.

ζ1, ζ2), respectively

−

−

P

P

(

2.2.4 Asymmetry of mirror orderings

Let us ﬁnally analyze the symmetry properties of
axis y =
read

(x, y) with respect to the
x. The corresponding symmetric and antisymmetric components

−

P

(x, y) =

P

s
IV +

a
IV

P

P

(14)

13

p(t)

?

1

-z

1

2

t

Figure 6: Diagram illustrating the conditional push asymmetry

where

s
IV =

P

1
2

(

P

(x, y) +

(

y,

P

−

−

x)) and

a
IV =

P

1
2

(

P

(x, y)

(

y,

x))

− P

−

−

(15)
A two-dimensional projection of log4 P
is a the positive com-
a
IV , is plotted for the case of two consecutive
ponent of the asymemtric part
1 - minute intervals in Fig. 16. We see the same four - blade market mill
pattern as in paragraph 2.2.2.

a(p)
IV , where

a(p)
IV

P

P

A useful view on the symmetry with respect to the axis y =

x is provided
by using the rotated coordinate frame, which in this case is obtained by
rotation at φ = 3π/4:

−

z =

(x

y) ;

¯z =

(x + y)

(16)

1
√2

−

1
√2

h

¯z
i

The conditional mean
z has the same shape as in the case of the asymmetry
with respect to the increment’s ordering, but now this is a conditional mean
of the total increment z1 + z2 at given diﬀerence z1 −
x, let us consider the probabilities of two sample paths

To elucidate the meaning of the asymmetry with respect to the axis y =

z2.

−

•

•

Path 1: Push ζ1, response ζ2, ζ1 + ζ2 = z∗, probability

(ζ1, ζ2)

Path 2: Push

ζ2, response

ζ1,

ζ2−
−

ζ1 =

−

−

−

(

ζ2,

P

−

−

ζ1)

P

z∗, probability

14

z
(cid:13)
(cid:13)
z
(cid:13)
p(t)

2

1

-z

2

-z

1

t

?

Figure 7: Diagram illustrating the asymmetry of mirror orderings

This is illustrated by the diagram in Fig. 7. Note that the second path is a
mirror one with respect to the ﬁrst. One could also describe the Path 2 as a
trajectory reversal. The meaning of the asymmetry with respect to the axis
y =
x is thus that the probabilities associated with two mirror trajectories
are not equal.

−

2.3 Discussion

Let us add a few more points to the discussion of the properties of the
structure of probability distribution in the push - response plane.

First, the existence of the z-shaped conditional mean response implies
the existence of a nonlinear predictability7. Does this predictability reﬂect
the market ineﬃciency at the timescales under consideration? The generic
probabilistic test of market eﬃciency is model-dependent [19, 20, 21, 22, 23].
A simple, although not totally generic picture of the eﬃcient market is that
of a martingale dynamics [24].
In this picture the full implementation of
available information into current stock price means that the expected value
of this price in the future equals its current one, which in the framework of
x = 0 for all x. The nonzero conditional mean is
y
this paper means that
h
y
x = 0, see Eq. (5), and
thus explicitly breaking the martingale condition
7By nonlinear predictability we mean the nonlinear dependence of conditional mean

h

i

i

response on the push.

15

(cid:13)
z
(cid:13)
(cid:13)
z
(cid:13)
thus, within the generally accepted paradigm, signals market ineﬃciency.

Second, it is of substantial interest to view our results on conditional re-
sponse in connection with the usual measure of dependence between stochas-
tic variables - the covariance. The unconditional mean increments in all in-
tervals considered are so small that one can safely neglect it. The covariance
is than equal to

x y

=

h

i

Z

dx x P (x)

y

x

i

h

(17)

x

h

i

i

i

h

i

h

i

i

y

y

y

∝

x4

x2

b
h

i −

x = ax

= a
h

x is even in the push, say

It is clear the nonlinear structure of the conditional response
x strongly
aﬀects the value of conditional mean. For example, if the conditional re-
x2, the covariance and thus the
y
sponse
h
linear correlation coeﬃcient are, for symmetric marginal distribution P (x),
bx3 gives
identically zero. A somewhat more realistic example of
x y
, so that in this case the value of the linear correlation
h
coeﬃcient depends, through parametrization of the conditional response, on
higher moments of the marginal distributions P (x). We see that generi-
cally the linear correlation does not provide an adequate description of the
response. In particular, the zigzag form of the conditional response makes
description in terms of linear correlation unreliable. Let us notice that even
the sign of the high frequency autocorrelation does not seem to be well estab-
lished. The popular view is that at short timescales the increments (returns)
are anticorrelated [4]. A detailed analysis of high frequency returns in [25]
showed, however, a positive autocorrelation. This ambiguity can well be re-
lated to the nonlinear structure of the conditional response discussed in the
present paper.

−

Third, the existence of market mill structure means that price evolution
is characterized by an explicit breakdown of the symmetry with respect to
time reversal, which in the considered case is a symmetry with respect to
the push-response interchange x
y. Previously the time reversal asym-
metry eﬀects were found only in the context of volatility dynamics [26, 27].
Let us note, that the breakdown of the time reversal symmetry and the
zigzag structure of the mean response provides valuable information on the
(x, y). For the popular elliptical
two-dimensional probability distribution
distributions, i.e. those dependent on the quadratic form dependent on x
and y, the mean response is always linear in the push and the distribution
function is symmetric with respect to x
y transformation. Therefore,
the two-dimensional distribution of consecutive increments is, in fact, non-

↔

↔

P

16

elliptical, which is a serious obstacle in developing an analytical description
of this distribution. Let us mention that in [28] it was shown that the bi-
variate distributions of the returns at FX market is not elliptical at short
intraday timescales.

The above-described remarkable market structures characterize the joint
bivariate distribution for the whole ensemble of price increments of all the
stocks considered. Does this blend also give an adequate description for
asymmetry characterizing individual stocks? Careful analysis shows that in-
dividual asymmetry patterns vary strongly from security to security. This
makes the stability in these individual patterns even more unexpected. One
could say that each stock is characterized by its own ”ﬁngerprint” of the
asymmetry of push-response distribution. A detailed analysis of this issue
will appear in the forthcoming work [7]. Here we just show in Fig. 17 three
individual characteristic patterns corresponding to the cases with the domi-
nance of nonlinear response, ordinary correlation and anticorrelation patterns
respectively. To illustrate the stability of the asymmetry patterns in Fig. 17
they are shown in two non-intersecting time intervals.

3 Conclusions and outlook

Let us formulate the main results obtained in the present paper. Studying
the full probabilistic description of the dynamics of price increments in two
nonintersecting intraday time intervals for a set of stocks we found an ap-
(x, y) with respect
proximate symmetry of the joint bivariate distribution
to rotations at the multiples of π/2 and four remarkable asymmetries with
respect to the axes y = 0, y = x, x = 0 and y =
x characterized by the
market mill patterns:

−

P

The asymmetry of the conditional response.

The asymmetry with respect to the increment’s ordering.

The asymmetry of the conditional push.

•

•

•

The asymmetry of the mirror orderings.

•
All of four market mill patterns follow from the speciﬁc structure of the
(x, y). The present study was focused on

general probability distribution

P

17

describing and interpreting the market mill patterns having left many ques-
tions for future analysis [6, 7]. Some particular issues we are going to address
are:

•

•

•

A detailed analysis of the shape of response pattern [6]. Besides giving
a detailed view on the structure of the response proﬁle this analysis
provides a direct link to a large body of econometric literature devoted
to modeling of price dynamics in terms of regressive models such as,
e.g., that in [29].

We have brieﬂy mentioned the remarkable stability of the asymmetry
patterns of the individual stocks. A detailed study of these patterns and
an analysis of the way the noisy individual patterns combine to produce
a clear overall market mill structure is perhaps the most important
problem to address [7].

At the fundamental level the main challenge is to build a parsimonious
model of agent strategies allowing to reproduce the speciﬁc structure
of response asymmetry described in the present paper. In particular,
it is important to discuss the issue of predictability using a more mi-
croscopic type of description such as used in [30]. Work on these issues
is currently in progress.

The work of A.L. was partially supported by the Scientiﬁc school support

grant 1936.2003.02

4 Appendix

Below we list stocks studied in the paper:

A, AA, ABS, ABT, ADI, ADM, AIG, ALTR, AMGN, AMD, AOC, APA,
APOL, AV, AVP, AXP, BA, BBBY, BBY, BHI, BIIB, BJS, BK, BLS, BR,
BSX, CA, CAH, CAT, CC, CCL, CCU, CIT, CL, COP, CTXS, CVS, CZN,
DG, DE, EDS, EK, EOP, EXC, FCX, FD, FDX, FE, FISV, FITB, FRE,
GENZ, GIS, HDI, HIG, HMA, HOT, HUM, JBL, JWN, INTU, KG, KMB,
KMG, LH, LPX, LXK, MAT, MAS, MEL, MHS, MMM, MO, MVT, MX,
MYG, NI, NKE, NTRS, PBG, PCAR, PFG, PGN, PNC, PX, RHI, ROK,
SOV, SPG, STI, SUN, T, TE, TMO, TRB, TSG, UNP, UST, WHR, WY

18

References

[1] B. Mandelbrot, ”Fractal and Multifractal Finance. Crashes and Long-
dependence”, www.math.yale.edu/mandelbrot/webbooks/wb ﬁn.html

[2] A.C. MacKinlay, A.W. Lo, J.Y. Kampbell, The Econometrics of Finan-

cial Markets, Princeton, 1997;
A.W. Lo, A.C. MacKinlay, A Non-Random Walk Down Wall Sreet,
Princeton, 1999

[3] A. Shiryaev, ”Essentials of Stochastic Finance: Facts, Models, Theory”,

World Scientiﬁc, 2003

[4] J.-P. Bouchaud, M. Potters, Theory of Financial Risk and Derivative

Pricing, Cambridge, 2000, 2003.

[5] A. Leonidov, V. Trainin, A. Zaitsev,

gaussian dependence patterns
ArXiv:physics/0506072, submitted to Quantitative Finance

”On collective non-
in high frequency ﬁnancial data”,

[6] A. Leonidov, V. Trainin, A. Zaitsev, S. Zaitsev, ”Market Mill Depen-
dence Pattern in the Stock Market: Geometry and Moments”, in prepa-
ration.

[7] A. Leonidov, V. Trainin, A. Zaitsev, S. Zaitsev, ”Market Mill Depen-
dence Pattern in the Stock Market: Individual Portraits”, in prepara-
tion.

[8] B. Mandelbrot, ”The Variation of Certain Speculative Prices”, Journal

of Business 36 (1963), 394-419

[9] B. Mandelbrot, R.L. Hudson, ”The (Mis)behavior of Prices: A Fractal
View of Risk, Ruin, and Reward”. New York: Basic Books; London:
Proﬁle Books, 2004

[10] K. Chen, C. Jayprakash, B. Yuan, ”Conditional Probability as
a Measure of Volatility Clustering in Financial Time Series”,
arXiv:physics/0503157

[11] T.F. Crack, O. Ledoit, ”Robust Structure Without Predictability: The
”Compass Rose” Pattern of the Stock Market”, The Journal of Finance
51 (1996), 751-762

19

[12] A. Antoniou, C.E. Vorlow, ”Price Clustering and Discreteness: Is there

Chaos behind the Noise?”, arXiv:cond-mat/0407471

[13] C.E. Vorlow, ”Stock Price Clustering and Discreteness: The ”Compass

Rose” and Predictability”, arXiv:cond-mat/0408013

[14] M. Boguna, J. Masoliver, ”Conditional dynamics driving ﬁnancial mar-

kets”, ArXiv:cond-mat/0310217

[15] P. Embrechts, A. McNeil, D. Straumann, ”Correlation and depenen-
dence in risk management: properties and pitfalls”, Risk Lab working
paper (1999)

[16] P. Embrechts, P. Lindskog, A. McNeil, ”Modelling Dependence with
Copulas and Applications to Risk Management”, Risk Lab working pa-
per (2001)

[17] Y. Malevergne, D. Sornette, ”Testing the Gaussian Copula Hypothesis

for Financial Asset Dependencies”, ArXix:cond-mat/0111310

[18] E. Jondeau, M. Rockinger, ”Conditional Dependency of Financial Series:
an Application of Copulas”, Banque de France working paper NER 82
(2001)

[19] E.F. Fama, ”Eﬃcient Capital Markets: A Review of Theory and Em-

pirical Work”, Journal of Finance 25 (1970), 383-417

[20] E.F. Fama, ”Foundations of Finance”, NY: Basic Books, 1976

[21] E.F. Fama, ”Eﬃcient Capital Markets: Reply”, Journal of Finance 31

(1976), 143-145

(1991), 1575-1617

[22] E.F. Fama, ”Eﬃcient Capital Markets:

II”, Journal of Finance 46

[23] S.F. LeRoy, ”Eﬃcient Capital Markets and Martingales”, Journal of

Economic Literature 27 (1989), 1583-1621

[24] B. Mandelbrot, ”Forecasts of Future Prices, Unbiased Markets and

”Martingale” Models”, Journal of Business 39 (1966), 242-255

20

[25] Y. Liu et al., ”The statistical properties of the volatility of price ﬂuctu-

ations”, Phys. Rev. E60 (1999), 1390

[26] P.E. Lynch, G.O. Zumbach, ”Market heterogeneities and the causal stru-

ture of volatility”, Quantitative Finance 3 (2003), 320-331

[27] L. Borland, J.-Ph. Bouchaud, ”On a multi-timescale statistical feedback

model for volatility ﬂuctuations”, ArXiv:cond-mat/0507073

[28] W. Breymann, A. Dias, P. Embrechts, ”Dependence structures for multi-
variate high-frequency data in ﬁnance”, Quantitative Finance 3 (2003),
1 - 14

[29] E. Jondeau, M. Rockinger, ”Conditional volatility, skewness, and kurto-
sis: existence and persistence”, Banque de France working paper NER
77 (2000)

[30] R.D. Huang, H.R. Stoll, ”Market Mikrostructure and Stock Return Pre-

dictions”, The Review of Financial Studies 7 (1994), 179-213

21

Figure captions

the axis y = 0, 6 min =

the axis y = x, 1 min =

the axis y = 0, 30 min =

⇒

6 min.

30 min.

Figure 10. The full bivariate distribution log8 P
Figure 11. The asymmetric component log4 P
Figure 12. The asymmetric component log4 P
⇒
Figure 13. The asymmetric component log4 P
Figure 14. The asymmetric component log4 P
Figure 15. The asymmetric component log4 P
⇒
Figure 16. The asymmetric component log4 P
Figure 17. The asymmetric components log4 P
1 min, individual stocks.

x, 1 min =

1 min.

1 min.

1 min.

⇒

⇒

⇒

−

(x, y), 1 min =
a(p)
I

1 min.
(x, y) with respect to

⇒

a(p)
I

(x, y) with respect to

a(p)
II (x, y) with respect to

a(p)
III (x, y) with respect to

a(p)
IV (x, y) with respect to

a(p)
I

a(p)
I

(x, y) with respect to

(x, y) with respect to

the axis y = 0, 1 min =

1 min, gap between the intervals 1 min.

the axis x = 0, 1 min =

the axis y =

the axis y = 0, 1 min =

⇒

22

Figure 8: Two-dimensional projection of the asymmetry of conditional dis-
tribution, 1 min =

1 min

⇒

23

-0.30

-0.25

-0.20

-0.15

-0.10

-0.05

0.00

0.05

0.10

0.15

0.20

0.25

0.30

-0.30

-0.25

-0.20

-0.15

-0.10

-0.05

0.00

0.05

0.10

0.15

0.20

0.25

0.30

I

)
p
(
a
P
g
o

l

I

)
p
(
a
P
g
o

l

I

)
p
(
a
P
g
o

l

-0.30

-0.25

-0.20

-0.15

-0.10

-0.05

0.00

0.05

0.10

0.15

0.20

0.25

0.30

Response, $

Figure 9: Asymmetry of conditional distribution, 1 min =
push values 0.01, 0.07, 0.25.

⇒

1 min, selected

x = 0.01

Response, $

x = 0.07

Response, $

x = 0.25

24

This figure "Figure15x=0.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure131-gap-1.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure116-6.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure10Distribution.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure14y=x.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure16y=-x.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure17Individuals.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

This figure "Figure1230-30.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0601098v1

