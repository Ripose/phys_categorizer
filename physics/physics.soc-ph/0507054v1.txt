5
0
0
2
 
l
u
J
 
6
 
 
]
h
p
-
c
o
s
.
s
c
i
s
y
h
p
[
 
 
1
v
4
5
0
7
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Scaling and data collapse for the mean exit time of asset prices

Miquel Montero,∗ Josep Perell´o, and Jaume Masoliver
Departament de F´ısica Fonamental, Universitat de Barcelona,
Diagonal 647, E-08028 Barcelona, Spain

Fabrizio Lillo,1,2,3 Salvatore Miccich`e,1,2 and Rosario N. Mantegna1,2
1 Dipartimento di Fisica e Tecnologie Relative, University of Palermo,
Viale delle Scienze, Ediﬁcio 18, I-90128 Palermo, Italy
2 INFM-CNR, Unit`a di Palermo, Palermo, Italy
3 Santa Fe Institute, 1399 Hyde Park Road, Santa Fe, NM 87501, USA
(Dated: February 2, 2008)

We study theoretical and empirical aspects of the mean exit time of ﬁnancial time series. The
theoretical modeling is done within the framework of continuous time random walk. We empirically
verify that the mean exit time follows a quadratic scaling law and it has associated a pre-factor
which is speciﬁc to the analyzed stock. We perform a series of statistical tests to determine which
kind of correlation are responsible for this speciﬁcity. The main contribution is associated with the
autocorrelation property of stock returns. We introduce and solve analytically both a two-state
and a three-state Markov chain models. The analytical results obtained with the two-state Markov
chain model allows us to obtain a data collapse of the 20 measured MET proﬁles in a single master
curve.

PACS numbers: 89.65.Gh, 02.50.Ey, 05.40.Jc, 05.45.Tp

I.

INTRODUCTION

The Continuous Time Random Walk (CTRW) for-
malism introduced four decades ago by Montroll and
Weiss [1] has been successfully applied to a wide and
diverse variety of physical phenomena over the years [2]
but only recently to ﬁnance [3, 4, 5, 6, 7, 8, 9, 10, 11, 12].
In this latter context, the eﬀorts have been mostly fo-
cused on the statistical properties of the waiting time
between successive transactions and the asset return at
each transaction. Diﬀerent studies in diﬀerent markets
are conceiving the idea that the empirical distributions
of both random variables are compatible with an asymp-
totic fat tail behavior [3, 4, 5, 6, 7, 8, 9, 10, 11].

Within the CTRW formalism some of us have recently
investigated the mean exit time (MET) of asset prices
out of a given interval of size L for ﬁnancial time series
[12]. This study shows that the MET follows a quadratic
growth in terms of L for small interval lengths L.
In
the same study, this functional form was observed for a
speciﬁc time series of the foreign exchange (FX) market,
which is the U.S. dollar/Deutsche mark futures time se-
ries [12].

In this paper we investigate both theoretically and em-
pirically the MET of price returns traded in a stock ex-
change. In our empirical investigation we study the MET
of high frequency return time series of 20 highly capital-
ized stocks traded in New York Stock Exchange. Em-
pirical results about this market conﬁrm that the MET
follows a power law with a pre-factor that depends on

∗Corresponding author: miquel.montero@ub.edu

the speciﬁc stock chosen. This observation motivates us
to ﬁrst verify and then release some of the assumptions
used in Ref.
[12] therefore generalizing the model dis-
cussed in that paper. The theoretical generalization has
been performed by introducing and solving a new two-
state chain Markovian model able to both describe the
quadratic scaling property of the MET and provide the
data collapse of the MET stock pre-factor.

We show that a satisfactory data collapse of the MET
is obtained when some degree of autocorrelation in the
stock returns is introduced in the two-state chain Marko-
vian model. We attempt to further improve the accuracy
by extending the model to a three-state Markov chain for
which we are still able to evaluate the MET. Neverthe-
less, empirical data show that the three-state model does
not improve the quality of data collapse in the MET pro-
ﬁles of the diﬀerent stocks although the theoretical curve
shows a better agreement with the empirical data than
that of the two-state Markov chain model.

The paper is organized as follows. In Sections II and
III, we discuss the MET behavior under the CTRW
In
formalism and a series of simplifying assumptions.
Sect. IV we empirically investigate the scaling and data
collapse properties of highly capitalized stock data. Sec-
tion V relates the time correlation of stock return with
the absence of data collapse of MET observed in the pre-
vious section. In Sect. VI we introduce and solve a two-
state and a three-state Markov chain model to describe
the empirical MET observations. Conclusions are drawn
in Sect. VII.

II. MEAN EXIT TIME FOR I.I.D. PROCESSES

, t−1, t0, t1, t2,

In the most common version of the CTRW for-
malism a given random process X(t) shows a se-
ries of random increments or jumps at random times
remaining constant between
· · ·
these jumps. Therefore, after a given time interval
tn−1, the process experiences a random in-
τn = tn −
crement ∆Xn(τn) = X(tn)
X(tn−1) and the resulting
−
trajectory consists of a series of steps as shown in Fig. 1.

, tn,

· · ·

· · ·

Both waiting times τn and random jumps ∆Xn(τn) are
assumed to be independent and identically distributed
(i.i.d.) random variables described by their probability
density functions (pdfs) which we denote by ψ(τ ) and
h(x) respectively.

However, in the most general representation of the for-
malism, another function is needed to describe the time
evolution of X(t). We denote this function by ρ(x, τ )
which is the joint pdf of waiting times and jumps:

2

ρ(x, τ )dxdτ = Prob
{

x < ∆Xn ≤

x + dx; τ < τn ≤

τ + dτ

.

}

(1)

X(t)

nX(t  )
−1X(t   )

n−1X(t    )

X(t )=x 0
0

b

t

a

−1t

t 0

1t

2t

t3

t
n−1

tn

τ
n

t    (x )
a,b       0

where

FIG. 1: A sample trajectory of the X(t) process along with
the corresponding value of the random variable ta,b(x0).

Note that the functions ψ(τ ) and h(x) are the marginal
probability density functions of ρ(x, τ ). We refer the
reader to Ref. [1, 2, 3, 4, 5, 6, 7, 8, 10, 11] for a more
complete account of the CTRW formalism.

In this paper we will apply the CTRW to study some
aspects of the exit problem of ﬁnancial time series. We
will take as underlying random process X(t) the logarith-
mic price X(tn) = ln(S(tn)), where S(t) is the stock price
at time t. We speciﬁcally consider the problem of ob-
taining the mean exit time of X(t) out of a given interval
[a, b]. We assume that at certain reference time t0, right
after an event, the price has a known value X(t0) = x0,
[a, b]. We focus our attention on a particular real-
x0
ization of the process and suppose that at certain time
tn > t0 the process ﬁrst leaves the interval (see Fig. 1).
t0 the exit time out of the re-
We call the interval tn −
gion [a, b] and denote it by ta,b(x0). This quantity is a
random variable since it depends on the particular trajec-
tory of X(t) chosen and the MET is simply the average
Ta,b(x0) = E[ta,b(x0)].

∈

The standard approach to exit time problems is based

on the knowledge of the survival probability which is gen-
erally quite involved [13]. However, within the CTRW
formalism one can assume that the events compose a
series of independent and identically distributed two-
dimensional random variables. Under such an assump-
tion, some of us [12] have recently shown that one can
obtain the MET directly, without making use of the sur-
vival probability. In this framework the MET obeys the
following integral equation [12, 14]

T (x0) = E[τ ] +

h(x

x0)T (x)dx,

(2)

−

b

a
Z

∞

0
Z

E[τ ] =

ψ(τ ′)τ ′dτ ′

is the mean waiting time between jumps.
It is worth
noticing that Eq. (2) is still valid even when τn and ∆Xn
are cross-correlated. In fact, in the case of an i.i.d. pro-
cess the MET only depends on the pdfs of waiting times
ψ(τ ) and jumps h(x), but it does not depend on the
particular form of the joint pdf ρ(x, τ ). However if we
would remove the i.i.d. hypothesis we should specify a
functional form for ρ(x, τ ).

We now assume that returns increments are distributed
x), which also sat-

according to an even pdf, h(x) = h(
isﬁes the following scaling condition,

−

H

x
κ

h(x) =

1
κ
where κ is the scale of the ﬂuctuations given by the
standard deviation κ of jumps, where κ2 = E[∆X 2
n −
E[∆Xn]2].
The parameter κ corresponds to the
transaction-to-transaction volatility. Under these as-
sumptions some of us showed that the MET out of a
a
small region of size L

κ is [12]

(3)

(cid:16)

(cid:17)

b

T (a + L/2) = E[τ ]

1 + 2H(0)

≡

−

≪

(cid:20)

L
2κ
2

(cid:18)

(cid:19)

L
2κ

L3
κ3

(cid:18)

(cid:19)

(cid:18)

(cid:19)(cid:21)

+ (H ′(0+) + 4H(0)2)

+ O

, (4)

where it is assumed that the return process is initially in
the middle of the interval [a, b].

In Ref. [12] some of us have applied the above result
to the FX market of the U.S. dollar/Deutsche mark fu-
ture price. One important conclusion there was that the
quadratic growth of the MET is still a good approxi-
It is less
mation even for large intervals, i.e. L
clear nonetheless that the coeﬃcients of the polynomial
which we have obtained in Eq. (4) are those that better
reproduce the global behavior of the MET. We refer the
reader to Ref. [12] for a more detailed discussion on this
particular aspect of the problem.

≫

κ.

In this paper we analyze the scaling properties of the
MET for 20 highly capitalized stocks traded at the NYSE
in the four year period 1995-1998 and spanning 1, 011
trading days. Table I shows the list of stocks and the
relevant parameters. We have measured the MET for
each stock and compared them in the scaled variables
T (a + L/2)/E[τ ] and L/2κ. If all previous hypotheses of
the model were correct, and the function H(u) is of uni-
versal nature, one should observe the same curve for all
stocks, i.e. a data collapse, as well as a quadratic growth
in L at least for small L. However, Fig. 2 shows that
there is a considerable spread of the curves. although
the parabolic shape is recovered in all cases not only for
small intervals, as expected, but for the whole investi-
gated range of L/2κ .

TABLE I: Summary statistics of the 20 stocks we study for
the period 1995-1998. The second column gives the number
of transactions, the third one the standard deviation of jumps
and the fourth one the mean waiting time, i.e. the mean time
between two intraday consecutive transactions.

Ticker
AHP
AIG
BMY
CHV
DD
GE
GTE
HWP
IBM
JNJ
KO
MO
MOB
MRK
PEP
PFE
PG
T
WMT
XON

Transactions
521,639
472,393
573,397
449,328
645,164
1,319,145
512,581
930,003
1,072,395
728,686
784,357
971,700
461,669
971,842
767,929
1,003,518
679,601
1,030,761
565,946
674,412

−4)

κ (×10
9.18
6.98
7.30
8.47
8.80
7.17
13.10
9.20
5.42
8.75
9.11
10.11
6.82
7.34
15.48
7.46
7.36
11.13
15.80
7.08

E[τ ] (seconds)
44.2
49.2
40.3
51.5
36.0
18.7
45.2
25.0
22.7
32.1
29.7
23.9
50.0
23.8
30.3
23.1
34.2
22.6
40.1
34.5

3

FIG. 2: (Color online) Mean exit times as a function of the
region size L for the 20 investigated stocks. The x axis is
scaled by 2κ, whereas the y axis is scaled by the mean wait-
ing time E[τ ]. The inset shows the same curves in a double
logarithmic plot.

III. A DISCRETE STATE MODEL

Our ﬁrst objective is to understand why the quadratic
term governs both the long and short range behavior of
the MET, without a drastic change of the general model
and its assumptions. In the present approach we develop
a model for h(x) based on the small-scale properties of
the system.

It is worth noticing that this approach is also used in
the context of option pricing, when the fair price of a
derivative product is obtained by making use of the bi-
nomial trees methodology, where it is assumed that the
stock price makes a jump up or down with some proba-
bility [15]. Here we introduce the following symmetrical
three-state discrete model:

h(x) = Q δ(x) +

[δ(x

c) + δ(x + c)] .

(5)

1

Q

−
2

−

where Q represents the probability that the price remains
unchanged, and c is the basic jump size [16]. By substi-
tuting this expression of h(x) into Eq. (2) we obtain

T (x0) = E[τ ]+Q T (x0)+

[T (x0 + c) + T (x0

c)] ,

−

1

Q

−
2

≤

with the convention that the term T (x0 + c) only counts
c, and similarly that T (x0
if x0
c) only appears
b
when x0
a + c. Let us analyze these two boundary
conditions in greater detail. In general, the limits of our
interval can be expressed in the following form:

−
≥

−

a = x0
(l + εa)c,
−
b = x0 + (m + εb)c,

∈

−

−

N and εa, εb ∈

with l, m
[0, 1). However it is easy to
conclude that T (x0) can depend neither on εa nor on εb.
The only way of leaving the interval is by reaching the
(l + 1)c or x = x0 + (m + 1)c, because
points x = x0
x = x0
lc, and x = x0 + mc lay always inside the
interval. Therefore we will not loose generality by setting
εa = εb = 0. After that, the length of the interval in the
L/c = l + m,
natural scale units of the problem is N
T (a + nc),
and the use of the following notation Tn ≡
with n
−

}
Summing up, for the discrete model given by Eq. (5)
the MET out of the interval [a, b] obeys the following set
of diﬀerence equations

, arises in a natural way.

1, N

0, 1,

∈ {

, N

· · ·

≡

Tn =

+

(Tn+1 + Tn−1)

E[τ ]
Q
1

−

1
2

(n = 0, 1, 2,

, N ) with boundary conditions:

· · ·

T−1 = TN +1 = 0.

The solution to Eqs. (6)-(7) is given by

Tn = E[˜τ ](n + 1)(N + 1

n),

−

where the random variable ˜τ is related to τ in such a way
that

(6)

(7)

(8)

(9)

E[˜τ ] =

E[τ ]
Q
1

.

−

(6),
By repeating the above derivation leading to Eq.
one can show that the random variable ˜τ represents the
waiting time between jumps if one neglects zero-return
trades, i.e. if one identiﬁes the occurrence of a jump when
X(t) actually changes its value. Thus, for instance, if
∆Xi−1
= 0 with correspond-
ing waiting times τi−1, τi, and τi+1, we can replace the
pair of events (∆Xi, ∆Xi+1) with a single transaction of
size ∆ ˜Xj = ∆Xi + ∆Xi+1 = ∆Xi+1, taking a waiting
time ˜τj = τi + τi+1.

= 0, ∆Xi = 0, and ∆Xi+1

From Eq. (8) we see that, for even values of N , the

MET starting from the middle of the interval reads

2

.

N
2

TN/2 = E[˜τ ]

1 +

(10)

(cid:19)

(cid:18)
Looking at the general solution given by Eq. (8) and also
at Eq. (10) we clearly observe a quadratic behavior of
the MET as a function of N , that is to say, as a function
of the length of the interval. Indeed, from Eq. (10) we
have:

T (a + L/2)
E[˜τ ]

=

1 +

(cid:18)

2

.

L
2˜κ

(cid:19)

E[∆ ˜Xn]2] = c2. The
where N = L/c and ˜κ2 = E[∆ ˜X 2
same kind of scaling also holds in terms of the parameters
of the three-state model. In fact, from Eq. (9) we get

n −

T (a + L/2)
E[τ ]

=

1

−

1

Q

(cid:18)

1 +

L√1

Q

−
2κ

2

.

(cid:19)

where κ2 = E[∆X 2
large values of L/κ,

n −

E[∆Xn]2] = (1

Q) c2. Hence, for

−

2

.

T (a + L/2)
E[τ ]

L
2κ

(cid:19)

∼

(cid:18)

4

(13)

IV. CAUSES OF ABSENCE OF DATA
COLLAPSE

In the previous section we have shown that a sim-
ple discrete model for the jump distribution results in
a quadratic growth of the MET valid for arbitrary values
of the length of the interval and not only for small values
of L/κ, as was the case of Eq. (4).

Unfortunately the discrete model does not properly ac-
count for the spread of the MET curves observed in Fig. 2
when we consider diﬀerent stocks. One could argue that
this spread can be controlled through the parameter Q
appearing in Eq. (12) since Q may distinguish one stock
from another. However, as Eq. (13) shows the MET is
practically independent of Q for large values of L and the
diﬀerence between stocks would disappear in this range
of lengths. Nevertheless, we clearly see in Fig. 2 that the
spread between stocks does not tend to vanish but, even
in some cases, it increases with L.

In this Section we try to identify the possible reasons of
the failure of the data collapse of our previous model. We
revisit some of our assumptions and derive consequences
with the aim of ﬁnding the most important feature that
we are leaving aside. The ﬁnal goal is to improve our de-
scription in the simplest possible way. Let us ﬁrst sum-
marize some potential causes for the lack of data collapse
in the previous models:

1. The probability density h(x) is diﬀerent for diﬀer-
ent stocks. This would imply diﬀerent mean exit
time curves.

2. There is some dependency on the cross-correlation

between waiting times and price returns.

3. The time auto-correlation of waiting times should

be included in the model.

4. The time auto-correlation of returns should be in-

cluded in the model.

We analyze the impact of these hypotheses on the
empirical outcomes by performing shuﬄing experiments.
Thus, in order to test the ﬁrst hypothesis we shuﬄe inde-
pendently the time series of ∆Xn and τn and we perform
the mean exit time analysis on the shuﬄed time series.
This shuﬄing destroys all the time- and cross- correla-
tions but it preserves the shape of the pdfs h(x) and
ψ(τ ) and therefore the values of the scaling parameter κ
and the average waiting time E[τ ]. Figure 3 shows a very
good collapse indicating that the assumption of a master
pdf for the returns of all the stocks is good working hy-
pothesis and it is not the reason for the lack of collapse

(11)

(12)

6
6
of Fig. 2. Moreover the MET curves are well ﬁtted by
the functional form y = (1 + x)2.

5

FIG. 3: (Color online) Mean exit times as a function of the
region size L for the 20 investigated time series after shuﬄing
both waiting times and return increments. The x axis is scaled
by 2κ, whereas the y axis is scaled by the mean waiting time
E[τ ]. The inset shows the same curves in a double logarithmic
plot. The dashed curve represents the functional form y =
(1 + x)2.

The other three hypotheses can be similarly tested by
performing three diﬀerent shuﬄing experiments. Speciﬁ-
cally, hypothesis 2) can be tested by shuﬄing simultane-
ously the two series and preserving the cross-correlation
between ∆Xn and τn. Notice that even if Ref. [12] has
shown that in the absence of autocorrelation of waiting
times and returns (i.i.d. model) the MET is indepen-
dent of the cross-correlations ρ(x, τ ), in the general case
ρ(x, τ ) may play a role. Hypothesis 3) can be tested by
shuﬄing only the series of waiting times and preserving
the order in the series of returns. Finally, hypothesis 4)
can be tested by shuﬄing only the time series of returns
and preserving the order of the series of waiting times.
Figure 4 shows the results of these shuﬄing experiments
for the General Electric (GE) stock. The Figure shows
that neglecting the autocorrelation function of waiting
times does not change the MET curve. On the other
hand, when one destroys the auto correlation of returns
the MET (star) changes dramatically and becomes close
to the one predicted by the i.i.d. model.

By summarizing, in order to have a good model of
the mean exit time one cannot neglect the correlation
properties of price return, whereas the other correlations
can be neglected as a ﬁrst approximation.

V. THE CORRELATION OF RETURN
INCREMENTS

What is the origin of correlation of returns? There
are, in principle, two possible answers. One contribution

FIG. 4: (Color online) Mean exit times as a function of the
region size L for General Electric obtained by performing four
diﬀerent shuﬄing experiments. The dashed (black) curve is
the MET of the original data. The solid (red) line is the
MET for data shuﬄed both in the waiting times and in the
return increments. The squares (green) give the MET when
one shuﬄes both ∆Xn and τn but preserving the association
(cross correlation) between the two and circles (blue) give
the MET when one shuﬄes only the waiting times. The star
(magenta) give the MET when one shuﬄes only the returns.

].
∆Xm|

comes from the linear autocorrelation of the increments
of returns given by E[∆Xn∆Xm]. A second contribution
is related to nonlinear properties which can be exempli-
∆Xn||
ﬁed by the nonlinear correlation E[
|

The ﬁrst contribution can be easily evaluated by tak-
ing the linear autocorrelation function of the increments
of price returns. Figure 5 shows this quantity for GE
(solid line). In the Figure it is clear that for a lag of one
trade the linear autocorrelation function is negative and
signiﬁcantly diﬀerent from zero. This is a known eﬀect
of transaction prices which is due to the presence of a
spread between the best bid and the best ask (the “bid-
ask bounce”, see for example [17]). It is reasonable to
assume that this short range correlation can be included
in the model by using a Markov process.

The nonlinear correlation is related to the volatility
and can be quantiﬁed by plotting the autocorrelation
. The result (dashed line) in Fig. 5 is a
function of
slowly decaying function indicating a long range correla-
tion, which is probably not compatible with a Markovian
model.

∆Xn|
|

We can test the relative importance of the two contri-
butions to the correlation of returns by performing an-
other shuﬄing experiment. We can obtain a surrogate
time series with the same linear autocorrelation function
but with an uncorrelated volatility (absolute value of re-
turn increments). The method (see for example Chapter
7 of Ref. [18]) consists in taking the Fourier transform of
the original time series and then randomize its phases.
Because of the Wiener-Kinchine theorem the linear au-

6

randomized series does not. The two METs (see solid line
and circles in Fig. 6) are again very close, thus showing
that the most important time correlation contribution to
the MET is the linear autocorrelation (bid-ask bounce),
while the clustered volatility plays a minor role.

VI. MEAN EXIT TIME FOR A
MARKOV-CHAIN MODEL

In order to incorporate the linear correlations of re-
turns, we derive an integral equation for the mean exit
time out of a given interval when the driving process is a

FIG. 5: (Color online) The solid (blue) line shows the auto-
correlation function of the time series of returns for the stock
GE. The dashed (red) line shows the autocorrelation of the
absolute value of returns for the same stock.

tocorrelation of the surrogate time series is the same as
the original, but the nonlinear correlation will be zero.
Therefore, we have a time series with the same bid-ask
bounce properties but with an uncorrelated volatility.
One diﬃculty of the method is the fact that the pdf of
the surrogate series will be in general diﬀerent from the
original one (unless the time series is Gaussian). Since
we know that, in general, the MET depends on the re-
turn pdf, we should control that the distortion of the pdf
introduced by the phase randomization is not critical in
changing the properties of the MET. To this end we ﬁrst
compare the MET curve of the shuﬄed original time se-
ries to the shuﬄed phase-randomized time series. These
two series are both i.i.d. but with diﬀerent pdfs. Figure 6
shows that the two METs (dashed line and squares) are
very close, thus indicating that the distortion of the pdf
introduced by the phase randomization is not critical for
the MET properties.

We can now compare the METs of the original data to
the ones for the phase-randomized time series. The two
series have the same linear autocorrelation function, but
the ﬁrst one displays a clustered volatility whereas the

FIG. 6:
(Color online) Mean exit times obtained by per-
forming shuﬄing experiments for the stock GE. The dashed
(green) line refers to the real data shuﬄed both in time and
in returns (the curve is also shown in Fig. 3). The squares
(blue) refer to the shuﬄed phase-randomized time series. The
solid (black) curve refers to the original data (the curve is
also shown in Fig. 2) and the circles (red) refer to the phase-
randomized time series.

continuous time random walk with memory. In particu-
lar, we will consider Markov processes within the CTRW
framework. Such models lead to the following joint con-
ditional probability density function:

ρ(x, τ

x′, τ ′)dxdτ = Prob
{
|

x < ∆Xn ≤

x + dx; τ < τn ≤

τ + dτ

∆Xn−1 = x′; τn−1 = τ ′
|

.

}

(14)

In
T (x0
nitude of the previous jump ∆X0 = x0
sojourn time τ0 = t0

this Markovian case
conditional MET,
∆X0, τ0), will also depend on both the mag-
|
x−1 and its
t−1 (see Fig. 1). Now, and

the

−

−

contrary to Eq. (2), the integral equation for the condi-
tional MET depends on the complete joint probability
density function. It reads:

T (x0

∆X0, τ0) = E [τ
|

∆X0, τ0] +
|

dτ

ρ(x

x0, τ

−

∆X, τ )dx,
∆X0, τ0)T (x
|
|

∞

b

0
Z

a
Z

−

x0 and τ = t

t0. The level of com-
where ∆X = x
plexity of Eq. (15) can be considerably reduced by noting
that, as we have shown in Sect. V, it is possible to remove
the correlation between consecutive waiting times with-
out aﬀecting the MET. Therefore, we will assume that

−

the correlation involving waiting times is negligible, and
that all relevant information we have to consider when
dealing with the n-th event is the magnitude of the pre-
vious change. In such a case instead of Eq. (14) we write

7

(15)

ρ(x, τ

x′)dxdτ = Prob
{
|

x < ∆Xn ≤

x + dx; τ < τn ≤

τ + dτ

∆Xn−1 = x′
|

.

}

(16)

Hence, the integral equation for the MET is simpler, be-
cause on the right hand side of Eq. (15) we can perform
the integral over time. We thus obtain

T (x0

∆X0) = E [τ
|
b

∆X0]
|

+

a
Z

h(x

x0

∆X)dx. (17)
∆X0)T (x
|
|

−

In this case the MET only depends on the marginal
probability density function of the return increments,
∆X0),
h(x
|

∆X0) =
h(x
|

ρ(x, τ

∆X0)dτ,
|

and on the conditional expectation of waiting times
E [τ
∆X0] which has to be evaluated through the
|
marginal pdf, ψ(τ

∆X0),
|

ψ(τ

∆X0) =
|

ρ(x, τ

∆X0)dx.
|

∞

0

Z

∞

−∞

Z

We ﬁnally observe that although x0
to be any real number.

∈

[a, b], we let ∆X0

A. A two-state Markov chain model

In order to solve Eq. (17) and obtain explicit expres-
sions for the MET that can be compared with empirical
data, we follow the same approach of Sect. III and choose
a discrete model for h(x
∆X0). At this point we can opt
|
for a two-state model in which, at any time step, returns
can only go up and down a ﬁxed quantity c, or for a three-
state model where in addition the return increment can
III that for an i.i.d.
be zero. We have shown in Sect.
process both alternatives are equivalent. In the case of a
Markovian process the equivalence is not complete. As
we will see below, the ﬁnal expressions obtained for the

unconditional MET are slightly diﬀerent although, for
large values of L, the leading term is the same in both
cases.

Let us start with a two-state Markov chain model. In
the symmetrical case in which up and down movements
are equally likely, the conditional pdf for return incre-
ments is

y) =
h(x
|

c + ry
2c

δ(x

c) +

−

c

ry

−
2c

δ(x + c),

(18)

where r is the correlation between the magnitude of two
consecutive jumps:

r

≡

Cov[∆ ˜Xn, ∆ ˜Xn−1]
Var[∆ ˜Xn]Var[∆ ˜Xn−1]

.

(19)

From Eq. (18) we see that the squared volatility,
∞

q

˜κ2(y)

y)dx = c2,
x2h(x
|

≡

−∞

Z
is independent of y. By substituting Eq.
(18) into
Eq. (17) we get the following diﬀerence equation for the
MET:

T (x0

∆ ˜X0) = E[˜τ
|

∆ ˜X0] +
|
r∆ ˜X0
2c

c

−

+

c + r∆ ˜X0
2c

T (x0 + c

c)
|

T (x0

c

c),

−

| −

(20)

where ∆ ˜X0 =
T (x0
c
introduced in Sect. III and deﬁne

c and
c) = 0 if x0 < a + c. We extend the notation

c) = 0 if x0 > b
|

c, T (x0 + c

| −

−

±

−

Tn,n∓1

T (x0 = a + nc

≡

∆ ˜X0 =
|

±

c).

(21)

Now, Eq. (20) is equivalent to the following set of recur-
rence equations:

Tn,n−1 = E[˜τ ] +

Tn+1,n +

Tn−1,n, (22)

Tn,n+1 = E[˜τ ] +

Tn+1,n +

Tn−1,n, (23)

1 + r
2

1

r

−
2

r

1

−
2
1 + r
2

(n = 0, 1,

, N ) with boundary conditions:

· · ·

T−1,0 = TN +1,N = 0.

(24)

Note that in writing Eqs. (22)-(23) we have set E[˜τ
c] =
E[˜τ ] which is consistent with the assumed symmetry be-
tween up and down movements (see also Eq. (25) below).
The solution to problem (22)-(24) reads

|±

Tn,n−1 = E[˜τ ](N + 1

n)

1 + n

−

(cid:20)

Tn,n+1 = E[˜τ ](n + 1)

1 + (N

,

1
r
−
1 + r
(cid:21)
1
r
−
1 + r

n)

.

−

(cid:20)
The quantity of interest for our analysis is the uncon-

(cid:21)

ditional MET Tn, which is related to Tn,n±1 by

Tn =

(Tn,n−1 + Tn,n+1) ,

(25)

1
2

that is,

Tn = E[˜τ ]

1 +

n(N

n)

.

(26)

N
1 + r

+

1
r
−
1 + r

(cid:20)

−

(cid:21)

Thus the MET starting from the middle of the interval
reads

TN/2 = E[˜τ ]

2r
1 + r

1 +

N
2

+

r
1
−
1 + r

1 +

N
2

"

(cid:19)

(cid:18)

#
(27)
In this case, and contrary to the i.i.d. case given in Eq.
(10), the MET TN/2 is not a perfect quadratic expression.
However, taking into account that N = L/c and ˜κ = c
we have

(cid:18)

(cid:19)

2

.

T (a + L/2)
E[˜τ ]

=

2r
1 + r

1 +

(cid:18)

L
2˜κ

(cid:19)

+

1
r
−
1 + r

(cid:18)

1 +

2

,

L
2˜κ

(cid:19)

(28)
and for large values of L/˜κ we recover the expected
quadratic behavior in the leading term:

(29)

(30)

T (a + L/2)
E[˜τ ]

r
1
−
1 + r

∼

2

.

L
2˜κ

(cid:19)

1 +

(cid:18)

Note that the value of r depends on each particular stock.
Therefore, the scaled MET deﬁned as:

Tsc(L)

1 + r
r
1

−

(cid:19)

≡

(cid:18)

T (a + L/2)
E[˜τ ]

,

tends, for increasing values of L, to a quadratic function
of the interval length which is independent of the partic-
ular stock chosen.

In Fig. 7 we compare the MET curves for the data
scaled in the original way (inset), as given in Eq. (11),
and for the data scaled according to Eq. (30). The inset
of Figure 7 is essentially the same as Fig. 2. Figure 7
shows that the scaling of Eq. (29) gives a signiﬁcant im-
provement with respect to the original one. We note
that the scaled curves are systematically below the curve
y = (1 + x)2, probably because some correlation is not
taken correctly into account by the two-state model. We
will now attempt to correct this bias by introducing a
three-state model.

8

4

10

3

10

]
τ
[
E
T

/

4
10

3
10

2
10

1
10

0
10
0
10

T
 
d
e
l
a
c
s
e
r

2

10

1
10

10

0
0
10

1
10

L/2κ

1

10

L/2κ

FIG. 7: (Color online) Comparison of the MET curves for the
original i.i.d. model and the two-state Markov chain model.
In this ﬁgure we have scaled the MET according to Eq. (29)
of the two-state Markovian model. The dashed (black) line is
the parabolic curve y = (1 + x)2. The inset is the same shown
in Fig. 2 for the i.i.d. process.

B. A three-state Markov chain model

One can argue that the two-state model just devel-
oped would need an improvement in order to include
zero-return transactions, i.e. those with ∆Xn = 0. In
Sect. III we have shown that for the i.i.d. process the in-
clusion of a third possible state is completely equivalent
to a two-state (up and down) model after redeﬁning the
mean waiting time and the volatility κ by including the
probability Q of zero-return transactions. However, when
memory is present, as is now the case, this equivalence
is not complete. We thus outline a discrete three-state
Markov chain model.

The Markov-chain model is now characterized by the

following transition matrix:

T = 



P (
P (0
P (+

−|−
|−
|−

) P (
0) P (
+)
−|
−|
+)
0) P (0
) P (0
|
|
+)
0) P (+
) P (+
|
|

,






)

≡

−|−

Prob
{

and
∆Xn =
where P (
similar deﬁnitions for the rest of the matrix elements.
Since we are also assuming that the process is symmetri-
cal for positive and negative returns, the transition ma-
trix T can be written in the following form:

∆Xn−1 =
|

−

−

}

c

c

2 p 1−q
1+r
2
1
q
p
−
2 p 1−q
1−r

2

1−r
2 p
1
p
−
1+r
2 p

,






T = 



where q = P (0

0) is the probability for trapping,
|

p = P (

) + P (+

) = P (+

−|−

|−

+) + P (
|

−|

+)

(31)

(32)

9

and r measures the strength of the persistence:

r =

P (
P (

−|−
−|−

P (+
)
) + P (+

−

)
)

|−
|−

=

P (+
P (+

P (
+)
−
|
+) + P (
|

−|
−|

+)
+)

.

Note that the ﬁrst order autocorrelation coeﬃcient, de-
ﬁned as on the right-hand side of Eq. (19) is now given
by (cf. Eq. (19))

conditions

In writing Eqs. (36) and (38) we have taken into account
the symmetry

E[τ

+ c] = E[τ

c]

| −
Finally the solution to Eqs. (36)-(38) with boundary

≡

|

E[τ

c].
|

Cov[∆Xn, ∆Xn−1]
Var[∆Xn]Var[∆Xn−1]

= pr.

(33)

(cf Eq. (24)) reads

T−1,0 = TN +1,N = 0

p
We also need to specify the unconditional probabilities
of each state:

P (
)
−
P (0)
P (+)

P = 





≡ 



1−Q
2
Q
1−Q
2

.





However, in this case Q is not an independent parameter
as was the case of the i.i.d. model (cf Sect.
In-
deed, using the total probability formula and taking into
account the values of the transition matrix T and the
vector P, we get

III).




p = 1

−

q
Q

1
1

−
−

Q.

Observe that when q = Q we have p = 1
is no trapping in the value of the random process.

−

Q and there

Now the pdf of the returns reads

Tn,n−1 =

(N + 1

n)

1 + n

(39)

E[τ ]
Q
1

−

−

(cid:20)

pr
1
−
1 + pr

(cid:21)

(34)

Tn,n =

E[τ
1

0]
|
q
−

+

E[τ ]

2(1

Q) "

−

pr
1
−
1 + pr

h

(N

n)(n + 1)

−

+ n(N

n + 1)

+ N

(40)

−

#

i

−

1
pr
−
1 + pr

E[τ ]
Q
1

Tn,n+1 =

(n + 1)

1 + (N

n)

,

(41)

−
is the (unconditional) mean waiting time

(cid:21)

(cid:20)

where E[τ ]
which is related to E[τ

c] and E[τ
|

0] by
|

E[τ ] = QE[τ

0] + (1
|

−

Q)E[τ

c].
|

(35)

In terms of Tn,n±1 and Tn,n the unconditional MET Tn
is given by

y) = a(y)δ(x)
h(x
|
(1

+

−

a(y))
2c

where

[(c + ry) δ(x

c) + (c

ry) δ(x + c)] ,

−

−

a(y) =

q,
1

(

p,

−

if y = 0,
= 0.
if y

In this case the integral equation (17) is equivalent to the
following set of diﬀerence equations for Tn,n and Tn,n±1:

Tn,n−1 = E[τ

c] + (1
|
1 + r
2

p)Tn,n
1

−
Tn+1,n +

r

−
2

+ p

(cid:20)

Tn−1,n

(36)

Tn,n = E[τ

0] + qTn,n
|
q

1

+

−
2

[Tn+1,n + Tn−1,n]

(37)

c] + (1
Tn,n+1 = E[τ
|
r
1

+ p

−
2

(cid:20)

p)Tn,n

−
Tn+1,n +

1 + r
2

Tn−1,n

(38)

(cid:21)

(cid:21)

where Tn,n±1 are deﬁned as in Eq. (21) and

Tn,n = T (x0 = a + nc

∆X0 = 0).
|

Tn = QTn,n +

(Tn,n−1 + Tn,n+1),

1

Q

−
2

(cid:18)

(cid:19)

and starting from the center of the interval we explicitly
have

TN/2 =

1 +

E[τ ]
1

−

2pr
1 + pr

Q "
E[τ
1

0]
|
q −
−

(cid:18)
E[τ ]
Q
1

N
2

.

+ Q

+

1
pr
−
1 + pr

1 +

N
2

(cid:18)

(cid:19)

2

#

(cid:19)

(42)

(cid:20)

−

(cid:21)
The main diﬀerence between this expression and Eq. (27)
is the ﬁnal constant term that accounts for the two kind
of trapping that the system may experience: the proba-
bilistic one, q
= E[τ ].
0]
|
By using the fact that κ2 = (1
Q) c2, the leading term
is again of the form:

= Q, and the temporal one, E[τ

−

T (a + L/2)
E[τ ]

1
pr
−
1 + pr

∼

L
2κ

(cid:18)

(cid:19)

2

.

(43)

In Fig. 8 we show the MET curves for the data scaled ac-
cording to Eq. (43). It is worth noting that the quantity
p r appearing in Eq. (43) can be estimated in two diﬀer-
ent ways. One could separately compute p, the proba-
bility of a change in the price return provided a previous

6
6
6
change, and r which is the strength of the persistence.
Alternatively one can estimate directly the quantity p r
by using Eq. (33). This second approach has the advan-
tage of reducing the dependence of the estimates from
the speciﬁc details of the model. This is the reason why
in the curves shown in Fig. 8 the quantity p r has been
estimated by using Eq. (33). The scaling shown in Fig-
ure 8 is not satisfactory, we would even say that it is less
satisfactory than the scaling corresponding to the two-
state model which has been shown in Fig. 7. However, it
is worth noting that the rescaled curves are not system-
atically below the parabolic curve (1 + x)2 as it was in
the case of the two-state model.

10

both a two-state and a three-state Markov chain mod-
els. The analytical results obtained through the two-state
model allow us to get a quite satisfactory data collapse
of the 20 MET proﬁles into a single parabolic curve as
predicted by the model. However, this parabolic curve
appears to be systematically above real data, that is, the
model overstimates the mean exit time.

We have been able to solve a three-state Markov chain
model as well. Unfortunately this more detailed model
does not provide an improvement on data collapse. The
main advantage of this generalization is that the MET
provided by the model lies close to the empirical curves.
In other words, the three-state model does not overesti-
mate the METs.

We do not have a convincing explanation for this ob-
servation but only some indications. Speciﬁcally, we have
seen that the symmetries assumed in the three state
model are not present in some empirical transition matri-
ces [19]. Perhaps this assumption prevents the data from
a convincing data collapse and the system would perform
a better collapse in a model taking into account a certain
degree of asymmetry in the Markovian transition matrix.
However, obtaining the analytical solution for this more
general case seems to be very involved and it has been
left for future research.

In conclusion, the MET and the search of a data col-
lapse in the MET curves of stock prices provide a good
occasion for testing the underlying hypothesis character-
izing the return dynamics and for the improvement of
the CTRW models describing this phenomenon. We be-
lieve we have detected the essential ingredients to be ac-
counted for a feasible model within the CTRW. We hope
that the results may provide a certain insight on the way
to bridge the gap between the description of the stochas-
tic dynamics at very short time horizons with that of
longer time scales [17, 20, 21, 22, 23, 24, 25].

Acknowledgments

FIG. 8: (Color online) MET curves scaled according to Eq.
(43) of the three-state Markovian model. The quantity p r
has been estimated by using Eq. (33). The dashed (black)
line represents the curve y = (1 + x)2.

VII. CONCLUSIONS

This paper presents theoretical and empirical results
about the MET of ﬁnancial time series. Speciﬁcally the
scaling property of the MET as a function of the size L
has been conﬁrmed to follow a quadratic law for a number
of stock price time series. We empirically verify that the
quadratic scaling law has associated a pre-factor which
is speciﬁc to the analyzed stock. We have performed a
series of tests to determine which kind of correlation are
responsible for this dependence. It turned out that the
main contribution is associated with the linear autocor-
relation property of stock returns.

We have therefore introduced and solved analytically

The authors acknowledge support from the ESF
project “Cost Action P10 Physics of Risk”. M.M.,
J.P. and J.M. acknowledge partial support from Di-
recci´on General de Investigaci´on under contract No.
BFM2003-04574 and by Generalitat de Catalunya un-
2001 SGR-00061. F.L., S.M. and
der contract No.
R.N.M acknowledge support from the research project
MIUR-FIRB RBNE01CW3M “Cellular Self-Organizing
nets and chaotic nonlinear dynamics to model and con-
trol complex system”, from the research project MIUR
449/97 “High frequency dynamics in ﬁnancial markets”
and from the European Union STREP project n. 012911
“Human behavior through dynamics of complex social
networks: an interdisciplinary approach.”.

[1] E.W. Montroll and G.H. Weiss, J. Math. Phys. 6, 167

[2] G.H. Weiss, Aspects and Applications of the Random

(1965).

Walk (North-Holland, Amsterdam, 1994).

[3] E. Scalas, R. Gorenﬂo, and F. Mainardi, Physica A 284,

[4] F. Mainardi, M. Roberto, R. Gorenﬂo, and E. Scalas,

Physica A 287, 468 (2000).

[5] M. Raberto, E. Scalas, and F. Mainardi, Physica A 314,

376 (2000).

749 (2002).

[6] L. Sabatelli, S. Keating, J. Dudley, and P. Richmond,

Eur. Phys. J. B 27, 273 (2002).

[7] R. Kutner and F. Switala, Quant. Fin. 3, 201 (2003).
[8] E. Scalas, cond-mat/0501261.
[9] P.C. Ivanov, A. Yuen, B. Podobnik, and Y. Lee, Phys.

[10] J. Masoliver, M. Montero, and G.H. Weiss, Phys. Rev. E

Rev. E 69, 056107 (2004).

67, 021112-1 (2003).

[11] J. Masoliver, M. Montero, J. Perell´o and G.H. Weiss, J.
Economic Behavior and Organization (to appear, 2005).
[12] J. Masoliver, M. Montero, and J. Perell´o, Phys. Rev. E

71, 056130 (2005).

[13] G.H. Weiss and R.J. Rubin, Adv. Chem. Phys. 52, 363
(1983); C.W. Gardiner, Handbook of Stochastic Methods
(Springer-Verlarg, Berlin, 1983); K. Lindenberg and B.J.
West, J. Stat. Phys. 42, 201 (1986).

[14] If there is no confusion and in order to keep notation
simple, we will drop the subscript and write T (x0) for
the MET out of [a, b].

[15] J. Cox, S. Ross, and M. Rubinstein, J. Fin. Econ. 7,

229-264, (1971).

[16] This choice for h(x) implies that the ﬂat levels in ev-
ery particular trajectory will be in a regular grid of size

11

c centered at the starting point x0. A priori we could
expect that H(0) is related with Q and, by means of
a naive ﬁnite-diﬀerence approximation, that H ′(0+) ∼
(1 − 3Q)/2.

[17] J.Y. Campbell, A.W. Lo, and A.C. MacKinlay, The
Econometrics of Financial Markets (Princeton Univer-
sity Press, Princeton, 1997).

[18] H. Kantz and T. Schreiber, Nonlinear Time Series Anal-

ysis (Cambridge University Press, 2003).

[19] For instance, the General Electric transition matrix has
the following elements: P (−|−) = 0.05, P (−|0) = 0.14,
P (−|+) = 0.34, P (0|−) = 0.53, P (0|0) = 0.73, P (0|+) =
0.62, P (+|−) = 0.42, P (+|0) = 0.13, and P (+|+) =
0.04. Note that some symmetry assumptions on the tran-
sition matrix of Eqs. (31)-(32) are approximately satis-
ﬁed: P (−|−) ≃ P (+|+) and P (−|0) ≃ P (+|0) while oth-
ers are not: P (+|−) 6= P (−|+) and P (0|−) 6= P (0|+).

[20] M. O Hara, Market Microstructure Theory (Blackwell,

[21] X. Gabaix, P. Gopikrishnan, V. Plerou and H.E. Stanley,

[22] F. Lillo, J.D. Farmer, R. N. Mantegna, Nature 421, 129

Cambridge, 1995).

Nature 423, 267 (2003).

(2003).

[23] M. Daniels, J.D. Farmer, L. Gillemot, G. Iori, E. Smith,

Phys. Rev. Lett. 90, 108102 (2003).

[24] J.D. Farmer and F. Lillo, Quant. Fin. 4, C7 (2004).
[25] J.D. Farmer, L. Gillemot, F. Lillo, S. Mike, A. Sen,

Quant. Fin. 4, 383 (2004).

