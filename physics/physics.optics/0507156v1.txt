5
0
0
2
 
l
u
J
 
0
2
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
6
5
1
7
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

General Recipe for Designing Photonic
Crystal Cavities

Dirk Englund
Department of Applied Physics, Stanford University, Stanford, CA 94305

Ilya Fushman
Department of Biophysics, Stanford University, Stanford, CA 94305

Jelena Vuˇckovi´c
Department of Electrical Engineering, Stanford University, Stanford, CA 94305

All authors contributed equally.

We describe a general recipe for designing high-quality
Abstract:
factor (Q) photonic crystal cavities with small mode volumes. We ﬁrst
derive a simple expression for out-of-plane losses in terms of the k-space
distribution of the cavity mode. Using this, we select a ﬁeld that will result
in a high Q. We then derive an analytical relation between the cavity ﬁeld
and the dielectric constant along a high symmetry direction, and use it to
conﬁne our desired mode. By employing this inverse problem approach,
106 and mode
we are able to design photonic crystal cavities with Q > 4
(l /n)3. Our approach completely eliminates parameter space
volumes V
searches in photonic crystal cavity design, and allows rapid optimization of
a large range of photonic crystal cavities. Finally, we study the limit of the
out-of-plane cavity Q and mode volume ratio.

∼

·

© 2014 Optical Society of America

OCIS codes: (130) Integrated optics; (130.2790) Guided waves; (130) Integrated optics;
(130.3120) Integrated optics devices; (140) Lasers and laser optics; (140.3410) Laser res-
onators; (140) Lasers and laser optics; (140.5960) Semiconductor lasers; (230) Optical devices;
(230.5750) Resonators; (230.6080) Sources; (250) Optoelectronics; (250.5300) Photonic inte-
grated circuits; (260) Physical optics; (260.5740) Resonance;

References and links

1. S. Johnson, S. Fan, A. Mekis, and J. Joannopoulos, “Multipole-cancellation mechanism for high-Q cavities in

the absence of a complete photonic band gap,” Appl. Phys. Lett. 78(22), 3388–3390 (2001).

2. J. Vuˇckovi´c, M. Lonˇcar, H. Mabuchi, and A. Scherer, “Design of photonic crystal microcavities for cavity QED,”

Phys. Rev. E 65, 016,608 (2002).

3. J. Vuˇckovi´c, M. Lonˇcar, H. Mabuchi, and A. Scherer, “Optimization of Q factor in microcavities based on free-

standing membranes,” IEEE J. Quan. Electron. 38(7), 850–856 (2002).

4. Y. Akahane, T. Asano, and S. Noda, “High-Q photonic nanocavity in a two-dimensional photonic crystal,” Nature

425, 944–947 (2003).

10(15), 670–684 (2002).

5. K. Srinivasan and O. Painter, “Momentum space design of high-Q photonic crystal optical cavities,” Opt. Express

6. H. Y. Ryu, S. H. Kim, H. G. Park, J. K. Hwang, Y. H. Lee, and J. S. Kim, “Square-lattice photonic band-gap
single-cell laser operating in the lowest-order whispering gallery mode,” Appl. Phys. Lett. 80, 3883–3885 (2002).
7. P. Lalanne, S. Mias, and J. P. Hugonin, “Two physical mechanisms for boosting the quality factor to cavity

volume ratio of photonic crystal microcavities,” Opt. Express 12(3), 458–467 (2004).

8. H.-Y. Ryu, M. Notomi, G.-H. Kim, and Y.-H. Lee, “High quality-factor whispering-gallery mode in the photonic

crystal hexagonal disk cavity,” Opt. Express 12(8), 1708–1719 (2004).

9. Y. Akahane, T. Asano, B.-S. Song, and S. Noda, “Fine-tuned high-Q photonic-crystal nanocavity,” Opt. Express

10. J. M. Geremia, J. Williams, and H. Mabuchi, “An inverse-problem approach to designing photonic crystals for

13(4), 1202–1214 (2005).

cavity QED,” Phys. Rev. E 66, 066606 (2002).

Mater. 4, 207 (2005).

11. B. Song, S. Noda, T. Asano, and Y. Akahane, “Ultra-high-Q photonic double heterostructure nanocavity,” Nature

12. A. Yariv and P. Yeh, Optical Waves in Crystals (Wiley and Sons, 2003).
13. A. Badolato, K. Hennessy, M. Atature, J. Dreiser, E. Hu, P. Petroff, and A. Imamoglu, “Deterministic coupling

of single quantum dots to single nanocavity modes,” Science 308(5725), 1158–61 (2005).

14. D. Englund, D. Fattal, E. Waks, G. Solomon, B. Zhang, T. Nakaoka, Y. Arakawa, Y. Yamamoto, and J. Vuˇckovi´c,
“Controlling the spontaneous emission rate of single quantum dots in a two-dimensional photonic crystal,” Phys.
Rev. Lett. 95, 013904(2005), arxiv/quant-ph/0501091 (2005).

15. R. Haberman, Elementary Applied Partial Differential Equations (Prentice-Hall, 1987).

1.

Introduction

One of the most interesting applications of photonic crystals (PhCs) is the localization of light to
very small mode volumes – below a cubic optical wavelength. The principal conﬁnement mech-
anism is Distributed Bragg Reﬂection (DBR), in contrast to, e.g., microspheres or microdisks,
which rely solely on Total Internal Reﬂection (TIR). However, since three-dimensional (3D)
PhCs (employing DBR conﬁnement in all 3D in space) have not been perfected yet, the main-
stream of the PhC research has addressed 2D PhCs of ﬁnite depth, employing DBR in 2D and
TIR in the remaining 1D. Such structures are also more compatible with the present microfab-
rication and planar integration techniques. These cavities can still have small mode volumes,
but the absence of full 3D conﬁnement by DBR makes the problem of the high-quality fac-
tor (high-Q) cavity design much more challenging. The main problem is out-of-plane loss by
imperfect TIR, which becomes particularly severe in the smallest volume cavities.

Over the past few years, many approaches have been proposed to address this issue, but they
all focused on the optimization of a particular cavity geometry and a particular mode supported
by it [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]. Some of the proposed cavities seem promising and have
already been proven useful as components of lasers or add/drop ﬁlters. However, a general
recipe for designing optimized nanocavities is missing, and it is also not known if cavities
better than the ones presently known are possible; these are exactly the issues that we will
address in this article. In Section 2, we will ﬁrst derive a simple set of equations for calculation
of cavity Q and mode volume. In Section 3 we estimate the optimum k-space distribution of
the cavity mode ﬁeld. In Section 4, we will ﬁnally address the question of ﬁnding PhC cavities
with maximum possible ﬁgures of merit for various applications. In this process, we start from
the optimum k-space distribution of the cavity ﬁeld; then we derive an approximate analytical
relation between the cavity mode and the dielectric constant along a direction of high symmetry,
and use it to create a cavity that supports the selected high-Q mode in a single step. Thus, we
eliminate the need for trial and error or other parameter search processes, that are typically used
in PhC cavity designs. Furthermore, we study the limit of out-of-plane Q factor for a given V
of the cavity mode with a particular ﬁeld pattern.

2. Simpliﬁed relation between Q of a cavity mode and its k-space Distribution

In order to simplify PhC cavity optimization, we derive an analytical relation between the near-
ﬁeld pattern of the cavity mode and its quality factor in this section. Q measures how well the
cavity conﬁnes light and is deﬁned as

Q

≡

U
w h
P
h

i
i

(1)

where w

is the angular frequency of the conﬁned mode. The mode energy is

U
h

i

=

1
2

Z

(e E 2 + m H2)dV

The difﬁculty lies in calculating P, the far-ﬁeld radiation intensity.

Following our prior work [2], we consider the in-plane and out-of-plane mode loss mecha-

nisms in two-dimensional photonic crystals of ﬁnite depth separately:

or

=

P
h

i

+

P
||i
h

P
⊥i
h

1
Q

=

+

1
Q

1
Q

⊥

||
In-plane conﬁnement occurs through DBR. For frequencies well inside the photonic band gap,
arbitrarily large) by addition of PhC
this conﬁnement can be made arbitrarily high (i.e., Q
layers. On the other hand, out-of-plane conﬁnement, which dictates Q
, depends on the modal
k-distribution that is not conﬁned by TIR. This distribution is highly sensitive to the exact mode
pattern and must be optimized by careful tuning of the PhC defect. Assuming that the cavity
mode is well inside the photonic band gap, Q
gives the upper limit for the total Q-factor of
the cavity mode.

⊥

⊥

||

Given a PhC cavity or waveguide, we can compute the near-ﬁeld using Finite Difference
Time Domain (FDTD) analysis. As described in Reference [3], the near-ﬁeld pattern at a surface
S above the PhC slab contains the complete information about the out-of-plane radiation losses
of the mode, and thus about Q

(Fig. 1).

⊥

Fig. 1. Estimating the radiated power and Q

from the known near ﬁeld at the surface S

⊥

The total time-averaged power radiated into the half-space above the surface S is:

P =

dq df sin(q )K(q , f ),

p /2

2p

Z0

Z0

where K(q , f ) is the radiated power per unit solid angle. In the appendix, we derive a very
simple form for K in terms of 2D Fourier Transforms (FTs) of Hz and Ez at the surface S, after
expressing the angles q , f

in terms of kx and ky:

K(kx, ky) =

h k2
z
2l 2k2

1
h 2 |

k (cid:20)

2 +
FT2(Ez)
|

FT2(Hz)
|
|

2

(cid:21)

(2)

(3)

(4)

(5)

(6)

m o
e o

l

h

,

≡

Here,

is the mode wavelength in air, k = 2p /l
= (kx, ky) =
k(sin q cos f , sin q sin f ) and kz = k cos(q ) denote the in-plane and out-of-plane k-components,
respectively. In Cartesian coordinates, the radiated power (5) can thus be re-written as the inte-
gral over the light cone, k

< k. Substituting (6) into (5) gives

, and ~k

q

||

||

h
2l 2k

P

≈

(7)

dkxdky
k2
k

kz

Zk

k

1
h 2 |

2 +
FT2(Ez)
|

2
FT2(Hz)
|
|

k≤

(cid:20)
This is the simpliﬁed expression we were seeking. It gives the out-of-plane radiation loss as
the light cone integral of the simple radiation term (6), evaluated above the PhC slab. Substi-
tuting Eq. (2) and Eq. (7) into Eq. (1) thus yields a straightforward calculation of the Q for a
given mode. In the following sections, when considering the qualitative behavior of (7), we will
restrict ourselves to TE-like modes, described at the slab center by the triad (Ex, Ey, Hz), that
2 in (7) just
have Hz even in at least one dimension x or y. For such modes, the term
FT2(Hz)
|
|
2 can be neglected in predicting the general trend of
above the slab is dominant, and
FT2(Ez)
|
|
Q.

(cid:21)

The ﬁgure of merit for cavity design depends on the application: for spontaneous emission
rate enhancement through the Purcell effect, one desires maximal Q/V ; for nonlinear optical
effects Q2/V ; while for the strong coupling regime of cavity QED, maximizing ratios g/k
Q/√V and g/g
V
are the cavity ﬁeld and emitter dipole decay rates, respectively [2].

∼
1/√V is important. In these expressions, V is the cavity mode volume:
∼
2), g is the emitter-cavity ﬁeld coupling, and k and g
2d3~r)/ max(e (~r)
e (~r)
~E(~r)
~E(~r)
|
|
|
|

≡

(

Thus, for a given mode pattern, we have derived a simple set of equations that allow easy
evaluations of the relevant ﬁgures of merit. In the next section, we address the problem of
ﬁnding the ﬁeld pattern that optimizes these ﬁgures of merit and later derive the necessary PhC
to support it.

R

3. Optimum k-space ﬁeld distribution of the cavity mode ﬁeld

The photonic crystals considered here are made by periodically modulating the refractive index
of a thin semiconductor slab (see Fig. 2). The periodic modulation introduces an energy band-
structure for light in two dimensions ~r = (x, y). The forbidden energy bands are the source of
DBR conﬁnement.

The periodic refractive index e (~r) = e (~r + ~R) can be expanded in a Fourier sum over spatial

frequency components in the periodic plane:

Here ~G are the reciprocal lattice vectors in the (kx, ky) plane and are deﬁned by ~G

~R = 2p m
for integer m. The real and reciprocal lattice vectors for the square and hexagonal lattices with
periodicity a are:
Square Lattice:

·

e (~r) = (cid:229)

e

~Gei~G

~r
·

~G

~Rm j = ma ˆx + ja ˆy

~Gql =

2p q
a

ˆx +

2p l
a

ˆy

Hexagonal Lattice:

~Rm j = ma

( ˆx + ˆy√3)
2

+ ja

( ˆx

−

ˆy√3)
2

(8)

(9)

(10)

Fig. 2. Left: TE-like mode band diagram for the square lattice photonic crystal. The inset
on the right shows the reciprocal lattice (orange circles), the ﬁrst Brillouin zone (blue) and
the irreducible Brillouin zone (green) with the high symmetry points. The inset on the left
shows the square lattice PhC slab and relevant parameters: periodicity a, hole radius r, and
slab thickness d. The parameters used in the simulation were r/a = 0.4, d/a = 0.55, and
n = 3.6. Right: Band diagram for TE-like modes of the hexagonal lattice PhC. The inset
on the right shows the reciprocal lattice (orange), the Brillouin zone (blue), and the ﬁrst
irreducible Brillouin zone (green) for the hexagonal lattice photonic crystal. The inset on
the left shows the hexagonal lattice PhC slab. The parameters used for the simualtion were
r/a = 0.3, d/a = 0.65, n = 3.6. A discretization of 20 points per period a was used for both
diagrams.

~Gql =

ˆx√3 + ˆy)

4p
a√3

(
−

q

2

+

4p
a√3

l

( ˆx√3 + ˆy)
2

,

where m, j, q and l are integers. The electromagnetic ﬁeld corresponding to a particular wave

vector~k inside such a periodic medium can be expressed as [12]:

~E~k = ei~k

~r (cid:229)
·

A~k,~Gei~G

~r
·

~G

(11)

By introducing linear defects into a PhC lattice, waveguides can be formed. Waveguide
modes have the discrete translational symmetry of the particular direction in the PhC lattice
and can therefore be expanded in Bloch states E~k. In Fig. 3, we plot the dispersion of a waveg-
uide in the G J direction of a hexagonal lattice PhC.

Cavity modes can then be formed by closing a portion of a waveguide, i.e., by introducing
mirrors to conﬁne a portion of the waveguide mode. In case of perfect mirrors, the standing
k0 . (Here we focus on TE-like PhC modes, and
wave is described by H = ak0Hk0 + a
discuss primarily Hz, although similar relations can be written for all other ﬁeld components).
Imperfect mirrors introduce a phase shift upon reﬂection; moreover, the reduction of the dis-
tance between the mirrors (shortening of the cavity) broadens the distribution of k vectors in
the mode to some width D k. The Hz ﬁeld component of the cavity (i.e., a closed waveguide)
mode can then be approximated as:

k0H
−

−

Hz(x, y)

∼

~k0+D ~k/2

~G

~k0−

D ~k/2 (cid:16)

A~k,~Gei~k

~r + A
·

~k,~Ge−
−

i~k

~r
·

ei~G
~r
·

(cid:17)

(12)

A similar expansion of Hz can be made at the surface S directly above the PhC slab (see
Fig. 1), which is relevant for calculation of radiation losses. The Fourier transform of the above

(cid:229)
(cid:229)
Fig. 3. Left: Band diagram for hexagonal waveguide in G J direction, with r/a = 0.3, d/a =
0.65, n = 3.6. The bandgap (wedged between the gray regions) contains three modes. Mode
Boo can be pulled inside the bandgap by additional neighbor hole tuning. Right: Bz of
conﬁned modes of hexagonal waveguide. The modes are indexed by the B-ﬁeld’s even (“e”)
or odd (“o”) parities in the x and y directions, respectively. The conﬁned cavity modes Boo,
Bee, and Beo required additional structure perturbations for shifting into the bandgap. This
was done by changing the diameters of neighboring holes.

±

±

~ko

~k,~G. The
equation gives the k-space distribution of the cavity mode, with coefﬁcients A~k,~G and A
−
~G, with widths directly proportional to D k. The k-
distribution peaks are positioned at
space distribution is mapped to other points in Fourier space by the reciprocal lattice vectors ~G.
To reduce radiative losses, the mapping of components into the light cone should be minimized
[3]. Therefore, the center of the mode distribution ~k0 should be positioned at the edge of the
ﬁrst Brillouin zone, which is the region in k-space that cannot be mapped into the light cone
by any reciprocal lattice vector ~G (see Fig. 2). For example, this region corresponds to ~k0 =
= 1 is a better
±
choice for ~k0, since it deﬁnes the edge point of the 1st Brillouin zone which is farthest from the
light cone. Thus, modes centered at this point and k-space broadened due to conﬁnement, will
radiate the least. Similarly, the optimum ~k0 for the cavities resonating in the G J direction of the
ˆkx (as it is for the cavity from Ref. [4], and for the G X direction is
hexagonal lattice is ~k0 =
~k0 =

ˆky (as it is for the cavity from Refs. [2] and [3]).

ˆky for the square lattice, where jx, jy

0, 1. Clearly,

ˆkx

±

±

=

p
a

p
a

p
a

∈

jy

jx

jx

jy

|

|

|

|

Assuming that the optimum choice of ~k0 at the edge of the ﬁrst Brillouin zone has been
made, the summation over ~G can be neglected in Eq. (12), because it only gives additional
Fourier components which are even further away from the light cone and do not contribute to
the calculation of the radiation losses. In that case, we can express the ﬁeld distribution as:

2p
a√3

±

Hz(x, y) =

dkxdkyA(kx, ky)ei~k

~r,
·

Z Z

(13)

where A(kx, ky) is the Fourier space envelope of the mode, which is some function centered at
~k0 = (
k0y) with the full-width half-maximum (FWHM) determined by D ~k = (D kx, D ky)
in the kx and ky directions respectively. Eq. (13) implies that Hz(x, y) and A(kx, ky) are related by
2D Fourier transforms. For example, if A(kx, ky) can be approximated by a Gaussian centered

k0x,

±

±

at ~k0 = (k0x, k0y) and with the FWHM of (D kx, D ky), the real space ﬁeld distribution Hz(x, y)
is a function periodic in the x and y directions with the spatial frequencies of k0x and k0y,
respectively, and modulated by Gaussian envelope with the widths D x
1/D ky.
Therefore, the properties of the Fourier transforms imply that the extent of the mode in the
Fourier space D k is inversely proportional to the mode extent in real space (i.e., the cavity
length), making the problem of Q maximization even more challenging when V needs to be
simultaneously minimized. This has already been attempted in the past for a dipole cavity
[2, 3] and a linear defect [4, 9, 11], by using extensive parameters space search. In the following
sections, we will design high Q cavities by completely eliminating the need for parameter space
searches and iterative trial and error approaches.

1/D kx and D y

∼

∼

There are two main applications of Eq. (7). First, this formulation of the cavity Q factor
allows us to investigate the theoretical limits of this parameter and its relation to the mode
volume of the cavity. Second, it allows us to quantify the effect of our perturbation on the
optimization of Q using only one or two layers of the computational ﬁeld and almost negligible
computational time compared to standard numerical methods. We applied Eq. (7) to cavities
obtained from an iterative parameter space search. These cavities were previously studied in
[3] and [4]. The results for Q using Eq. (7) at S, as well as full ﬁrst-principle FDTD simulations
are shown in Fig. 4. A good match is observed. Therefore, our expression (7) is a valid measure
of the radiative properties of the cavity and can be used to theoretically approach the design
problem; we can also use this form to speed up the optimization of the cavity parameters. The
discrepancy between Eq. (7) and FDTD is primarily due to discretization errors.

Fig. 4. Comparison of Q factors derived from Eq. (7) (squares) to those calculated with
FDTD (circles). Left: cavity made by removing three holes along the G J direction conﬁning
the Boe mode. The Q factor is tuned by shifting the holes closest to the defect as shown by
the red arrow. The x-axis gives the shift as a fraction of the periodicity a. Right: the X
dipole cavity described in [3]. The Q factor is tuned by stretching the center line of holes
in the G X direction, as shown by the arrow. The x-axis gives the dislocation in terms of the
periodicity a.

4.

Inverse problem approach to designing PhC cavities

In the inverse approach, we begin with a desired in-plane Fourier decomposition of the resonant
mode, FT2(~H(~r)), chosen again to minimize radiation losses given by Eq. (7). The difﬁculty
lies with designing a structure that supports the ﬁeld which is approximately equal to the target
ﬁeld, ~H(~r).

In this section, we ﬁrst estimate the general behavior of Q/V for structures of varying mode
volume. Then we present two approaches for analytically estimating the PhC structure e (~r)
from the desired k-space distribution FT2(~H(~r)). As mentioned in Sec.2, we restrict the analysis

to TE-like modes Beo, Boe, and Bee (Fig.3(b)) for which we can approximate the trend of the
radiation (7) by considering only Hz at the surface S just above the PhC slab. Moreover, to make
a rough estimate of the cavity dielectric constant distribution from the desired Hz ﬁeld on S, we
approximate that Hz at S is close to Hz at the slab center.

4.1. General trend of Q/V

The simpliﬁcation described above allows us to study the general behavior of Q/V for a cavity
with varying mode volume. Here, we assume that a structure has been found to support the
desired ﬁeld Hz.

We again start from the expression for radiated power, Eq. (7), and calculateQ using Eq. (1).
All that is required of the cavity ﬁeld is that its FT at the surface S above the slab be distributed
2p
around the four points kx0 =
, to minimize the components inside the light
√3a
cone. As an example, we choose a ﬁeld with a Gaussian envelope in Fourier space, as described
in Sec. 3. For now, let us consider mode symmetry Boe. The Fourier Transform of the Hz ﬁeld
is then given by

p /a, ky0 =

±

±

FT2(Hz) = (cid:229)

kx0,ky0

sign(kx0) exp(

(kx

kx0)(s x/√2)2

ky0)(s y/√2)2),

(14)

(ky

−

−

−

−

where s x and s y denote the modal width in real space. The mode and its FT are shown in Fig.5
(d-e). We use Eq.7 without the Ez terms to estimate the trend in Q, as described above. As the
mode volume grows, the radiation inside the light cone shrinks exponentially. This results in
an exponential increase in Q. This relationship is shown in Fig.5(g) for ﬁeld Boe at frequency
a/l = 0.248. At the same time, the mode volume grows linearly with s x. The growth of Q/V
is therefore dominantly exponental , and we can ﬁnd the optimal Q for a particular choice of
mode volume (i.e. s x) of the Gaussian mode cavity.

According to Fig.5(g), very large Qs can be reached with large mode volumes and there does
not seem to be an upper bound on Q
. As the mode volume of the Gaussian cavity increases,
the radiative Fourier components vanish exponentially, but are never zero. A complete lack of
Fourier components in the light cone should result in the highest possible Q. As an example of
such a ﬁeld, we propose a mode with a sinc envelope in x and a Gaussian one in y. The FT of
this mode in Fig.5(b) is described by

⊥

FT2(Hz) = (cid:229)

exp(

(ky

−

−

kx0,ky0

ky0)2(s y/√2)2)Rect(kx

kx0, D kx),

(15)

−

where Rect(kx, D kx) is a rectangular function of width D kx and centered at kx.

The Fourier-transform implies that the cavity mode is described by a sinc function in x whose
width is inversely proportional to the width of the rectangle Rect(kx, D kx). To our knowledge,
this target ﬁeld has not been previously considered in PhC cavity design. This ﬁeld is shown in
Fig.5(a-c). Though it has no out-of-plane losses, this ﬁeld drops off as 1
r and therefore requires
a larger structure than the Gaussian ﬁeld for conﬁnement.

Over the past years, many new designs with ever-higher theoretical quality factors have been
suggested [11]. In light of our result that Q/V increases exponentially with mode size, these
large Qs are not surprising. On the other hand, direct measurements on fabricated PhC cavities
104 by material absorption and surface roughness
indicate that Qs are bounded to currently
∼
105[9,
[13, 14], while indirect measurements using waveguide coupling indicate values up to 6
11].

·

It is interesting to note that Eq. (6) also allows one to calculate the ﬁeld required to radiate
with a desired radiation distribution. For example, many applications require radiation with a
strong vertical component; waveguide modes with even Hz can be conﬁned for this purpose so

Fig. 5. Idealized cavity modes at the surface S above the PhC slab; all with mode volume
(l /n)3. (a-c) Mode with sinc and Gaussian envelopes in x and y, respectively: Hz(x, y),
∼
FT2(Hz), and K(kx, ky) inside the light cone; (d-g) Mode Boe with Gaussian envelopes in
/V .
the x and y directions : Hz(x, y), FT2(Hz), K(kx, ky), and Q
was calculated using Eq. (7) and Ez was neglected.; (h-i) Mode Bee with Gaussian
Q
envelopes in x and y can be conﬁned to radiate preferentially upward.

(s x/a) as well as Q

⊥

⊥

⊥

that K(kx, ky) dominates losses at the origin in k
the conﬁned mode pattern Bee of Fig.3.

−

space, as shown for instance in Fig. 5(h-i) for

4.2. Estimating Photonic Crystal Design from k-space Field Distribution
Now we introduce two analytical ways of estimating the dielectric structure e (~r) that supports a
cavity ﬁeld that is approximately equal to the desired ﬁeld ~Hc. These methods directly calculate
the dielectric proﬁle from the desired ﬁeld distribution, without any dynamic tuning of PhC
parameters, and are thus computationally fast. We focus on TE-like modes, since they see a
large bandgap and exhibit electric-ﬁeld maxima at the slab center. For TE-like modes, ~Hc =
Hc ˆz at the surface. First, we relate ~Hc to one of the
Hc ˆz at the center of the slab, and ~Hc
allowed waveguide ﬁelds ~Hw. The ﬁelds Hc and Hw at the center of the PhC slab (z = 0) are
solutions to the homogeneous wave equation with the corresponding refractive indices e c and
e w, respectively.

≈

¶ 2 ~Hc
¶ t2 = w 2

c

m 0

−

m 0~Hc = (cid:209)

1
e c

×

~Hc

×

(16)

(cid:209)
¶ 2 ~Hw
¶ t2 = w 2

w

m 0

−

m 0~Hw = (cid:209)

1
e w

×

~Hw

×

(17)

(18)

Here w c and w w are the frequencies of the cavity and waveguide ﬁelds. We expand the cavity

mode into waveguide Bloch modes:

Hc = (cid:229)

ckuk(~r)ei(~k

~r
·

−

w kt)

~k

~k

where uk is the periodic part of the Bloch wave. Assuming that the cavity ﬁeld is composed
of the waveguide modes with ~k
uk0(~r), which leads to the
slowly varying envelope approximation:

~k0, we can approximate uk(~r)

≈

≈

uk0(~r)ei(~k0·

~r

−

w wt) (cid:229)

ckei((~k

~k0)

~r
·

−

(w k−

w w)t) = HwHe,

−

(19)

Hc

≈

where the waveguide mode Hw = uk0(~r)ei(~k0·
(cid:229) ~k ckei((~k
w w)t).

(w k−

~k0)

~r
·

−

−

~r

−

w wt) and the cavity ﬁeld envelope He =

The cavity and waveguide ﬁelds FT-distributions are concentrated at the edge of the Brillouin

1 (i.e., the band is nearly ﬂat). Differentiating (19)

zone, where w 2
in time twice gives:

k ≈

2

and a

~k0

−

≪

w + a
w 2

~k
(cid:12)
(cid:12)
(cid:12)
¶ 2Hc
¶ t2 =

−

(cid:12)
(cid:12)
(cid:12)
c Hc =

w 2

Hw (cid:229)

−

~k

ckei((~k

~k0)

~r
·

−

(w k−

−

w w)t)

ckuk(~r)ei(~k

~r
·

−

w kt)

w + a
w 2

−

~k
w + a
w 2

h

k
|

−

k0

2
|

=

−

i

k
|

−

k0

2
|

≈

h
wHwHe + a Hw(cid:209) 2He
w 2

i

(20)

Thus, for a

1 and ﬁnite (cid:209) 2He, w c
frequency of the dominant waveguide mode. The condition a
i.e. He

≪
(cid:229) ~k ckei(~k

~r.
·

~k0)

≈

−

w w, i.e., the cavity resonance is very close to the
w w,

1, also implies that w k

≪

≈

≈

4.2.1. Estimating Photonic Crystal Design from k-space ﬁeld Distribution: Approach 1
Let us express the cavity dielectric constant e c as e c = e we e, where e e is the unknown envelope.
w kt) satisﬁes Eq. (17). From
Hc is a solution of Eq. (16) and each waveguide mode uk(~r)ei(~k
previous arguments, for~k within the range corresponding to the cavity mode, w c
w k.
w kt) = HeHw = Hc also satis-
Thus, a linear superposition of waveguide modes (cid:229)
ﬁes Eq. (17), i.e. the cavity mode is also a solution of Eq. (17) for a slowly varying envelope.
We assume that the mode is TE-like, so that the H ﬁeld only has a z component at the cen-
ter of the slab. Then inserting Hc from (19) into Eq.(16) and Eq. (17) and subtracting the two
equations with e c = e we e, yields a partial differential equation for e c(x, y):

k ckuk(~r)ei(~k

w w

≈

≈

~r
·

~r
·

−

−

¶ x

1
e w (cid:18)

(cid:20)

1
e e −

1

(cid:19)

¶ xHc

+ ¶ y

(cid:21)

1
e w (cid:18)

(cid:20)

1
e e −

1

(cid:19)

¶ yHc

≈

(cid:21)

m 0(w 2

w −

w 2

c )Hc

0

≈

(21)

For this approach, we consider waveguide modes with Boe symmetry in Fig.3(b). These
modes are even in ˆy, so the partial derivatives in y in (21) vanish at y = 0. The resulting sim-
pliﬁed ﬁrst-order differential equation in 1/e e can then be solved directly near y = 0, and the
solution is 1
C , where C is an arbitrary constant of integration. In our analysis
e w

1)¶ xHc

( 1
e e −

≈

(cid:209)
(cid:229)
e w corresponds to removing holes along one line (x-axis) in the PhC lattice. The cavity is cre-
ated by introducing holes into this waveguide, which means that 1
1 > 0. The solution holds
when we take the absolute value of both its sides, and for C > 0, this leads to the following
result for the cavity dielectric constant near y = 0:

e e −

e c(x)

≈

¶ xHc
|
C + 1

|
¶ xHc

e w |

|

(22)

C is a positive constant of integration, and Hc = HwHe, where Hw is the known waveguide
ﬁeld and He is the desired ﬁeld envelope. C can be chosen by ﬁxing the value of e c at some
x, leading to a particular solution for e c. In our cavity designs we chose C such that the value
of e c is close to e w at the cavity center. To implement this design in a practical structure, we
need to approximate this continuous e c by means of a binary function with low and high-index
materials e l and e h, respectively. We do this by ﬁnding, in every period j, the air hole radius r j
that gives the same ﬁeld-weighted averaged index on the x-axis:

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

2

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

ja+a/2

ja

a/2

−

Z

(e h + (e l

e h)Rect( ja, r j))

~Ec

dx =

−

ja

a/2

−

Z

ja+a/2

e c(x)

~Ec

2

dx,

(23)

where ~Ec is estimated from a linear superposition of waveguide modes as ~Ec (cid:181)
~Hc. We
assume that the holes are centered at the positions of the unperturbed hexagonal lattice PhC
holes.

×

The radii r j thus give the required index proﬁle along the x symmetry axis. The exact shape
of the holes in 3D is secondary – we choose cylindrical holes for convenience. Furthermore, we
are free to preserve the original hexagonal crystal structure of the PhC far away from the cavity
where the ﬁeld is vanishing.

To illustrate the power of this inverse approach, we now design PhC cavities that support the
Gaussian and sinc-type modes of Eq. (14), (15). In each case, we start with the waveguide ﬁeld
Boe of Fig.3(b) conﬁned in a line-defect of a hexagonal PhC. The calculated dielectric structures
and FDTD simulated ﬁelds inside them are shown in Fig. 6. The FT ﬁelds on S also show a
close match and very little power radiated inside the light cone (Fig.6(c,f)). This results in very
large Q values, estimated from Q
to limit computational constraints. These estimates were
done in two ways, using ﬁrst principles FDTD simulations [2], and direct integration of lossy
components by Eq. (7). The results are listed in Table 1 and show an improvement of roughly
three orders of magnitude over the unmodiﬁed structure of Fig. 4 with as small increase in
mode volume. Furthermore, a ﬁt of the resulting ﬁeld pattern to a Gaussian envelope multiplied
by a Sine, yielded a value of s x/a
1.6, which, according to the plot in Fig. 5 g., puts us at the
attainable limit of Q

at this mode volume.

≈

⊥

In our FDTD simulations, we veriﬁed that Q

correctly estimates Q by noting that Q

·

||

⊥

−

−

= 22

and y

= 180

= 1.48

103, Q

103, Q

⊥
directions, Nx
did not change appreciably as the number of PhC periods in the x
and Ny, was increased: for the Gaussian-type (sinc-type) mode, increasing the simulation size
from Nx = 13, Ny = 13 (Nx = 21, Ny = 9) PhC periods to Nx = 25, Ny = 13 (Nx = 33, Ny = 13)
106) to
changed quality factors from Q
⊥
106). (The number of PhC periods in
103, Q
Q
the x-direction in which the holes are modulated to introduce a cavity is 9 and 29 for Gaussian
and sinc cavity, respectively, while both cavities consist of only one line of defect holes in the
, as summa-
y-direction.) Thus, with enough periods, the quality factors would be limited to Q
was estimated from
rized in the table. In the calculation of Q, the vertically emitted power
l above the PhC surface. Note that the frequencies a/l closely
the ﬁelds a distance
match those of the original waveguide ﬁeld Boe (a/l cav=0.251), validating the assumption in
the derivation.

·
= 260

||
106 (Q

·
= 4.0

106 (Q

103, Q

P
||i
h

= 1.4

= 4.2

= 17

0.25

∼

⊥

⊥

⊥

⊥

||

||

·

·

·

·

·

·

⊥

(cid:209)
Table 1. Q values of structures derived with inverse-approach 1

Gaussian
Sinc
Unmodiﬁed 3-hole defect

a/l cav Qcav (freq. ﬁlter) Qcav (Eq. (7)) Vmode(
0.85
0.248
1.43
0.247
0.63
0.251

106
106
103

106
106
103

1.6
4.3
6.4

1.4
4.2
6.6

l
n )3

·
·
·

·
·
·

|

|

E

; (c) FT pattern of Bz

Fig. 6. FDTD simulations for the derived Gaussian cavity (a-c) and the derived sinc
taken above the PhC
cavity (d-f). Gaussian: (a) Bz; (b)
; (f) FT pattern of Bz taken
slab (blue) and target pattern (red). Sinc: (d) Bz; (e)
above the PhC slab (blue) and target pattern (red) (The target FT for the sinc cavity
appears jagged due to sampling, since the function was expressed with the reso-
lution of the simulations). The cavities were simulated with a discretization of 20
points per period a, PhC slab hole radius r = 0.3a, slab thickness of 0.6a and refrac-
tive index 3.6. Starting at the center, the defect hole radii in units of periodicity a are:
(0, 0, 0.025, 0.05, 0.075, 0.1, 0.075, 0.075, 0.1, 0.125, 0.125, 0.125, 0.1, 0.125, 0.15, 0.3, 0.3)
for the sinc cavity, and (0.025, 0.025, 0.05, 0.1, 0.225) for the Gaussian cavity.

E

|

|

4.2.2. Estimating Photonic Crystal Design from k-space Field Distribution: Approach 2
We now derive a closed-form expression for e c(x, y) that is valid in the whole PhC plane (instead
of the center line only). Again, begin with the cavity ﬁeld ~H(~r) = ˆzHc consisting of the product
of the waveguide ﬁeld and a slowly varying envelope, Hc = HwHe, and treat the cavity dielectric
constant as: 1
. In the PhC plane, Eq. (16, 17) for a TE-like mode can be rewritten
e c
as

= 1
e pert

+ 1
e w

w 2
c

m 0Hc = (cid:209)

w 2
w

m 0Hw = (cid:209)

−

−

1
e c
1
e w

(

(

·

·

(cid:209) Hc)

(cid:209) Hw)

Multiplying the last equation by He, subtracting from the ﬁrst, and recalling that w c

w w yields

∼

w 2
w

m 0HeHw

w 2
c

m 0Hc = m 0Hc(w 2

−

0

w −
(cid:209) Hc)

w 2
c )
≈
He(cid:209)

= (cid:209)

≈

1
e c
1
e pert

(

(

·

·

−
(cid:209) Hc)

1
e w

(

·

(cid:209) Hw)

(24)

(25)

(26)

(27)

(cid:209)
where the last line results after some algebra and dropping spatial derivatives of the slowly
varying envelope He. This relation is a quasilinear partial differential equation in 1/e pert . With
boundary conditions that can be estimated from the original waveguide ﬁeld, this equation can
in principle be solved for e c (e.g., [15]).

Alternatively, one can ﬁnd a formal solution for e pert by assuming a vector function ~x (~r)

chosen to satisfy the boundary conditions, so that

1
e pert

(cid:209) Hc = (cid:209)

~x

×

1
e pert

=

~x
×
·
(cid:209) Hc
|

(cid:209) H∗c
2
|

(28)

(29)

This gives is the formal solution of the full dielectric constant e c = (e −
of the photonic crystal.

pert + e −
1

1
w )−

1 in the plane

or

5. Conclusions

⊥

∼

We have described a simple recipe for designing two-dimensional photonic crystal cavities. Al-
though the approach is general, we have demonstrated its utility on the design of cavities with
(l /n)3. These values follow our theoret-
very large Q > 106 and near-minimal mode volume
/V for the cavity with the Gaussian ﬁeld envelope, which means
ically estimated value of Q
that we were able to ﬁnd the maximal Q for the given mode volume V under our assumptions.
Our approach is analytical, and the results are obtained within a single computational step. We
ﬁrst derive a simple expression of the modal out-of-plane radiative loss and demonstrate its
utility by the straightforward calculation of Q factors on several cavity designs. Based on this
radiation expression, the recipe begins with choosing the FT mode pattern that gives the desired
radiation losses. For high-Q cavities with minimal radiative loss inside the light cone, we show
that the transform of the mode should be centered at the extremes of the Brillouin Zone, as far
removed from the light cone as possible. Next we proved that for a cavity mode with a Gaussian
envelope, Q/V grows exponentially with mode volume V , while the cavity with the sinc ﬁeld
envelope should lead to even higher Q’s by completely eliminating the Fourier components in
the light cone. Finally, we derived approximate solutions to the inverse problem of designing a
cavity that supports a desired cavity mode. This approach yields very simple design guides that
lead to very large Q/V . Since it eliminates the need for lengthy trial-and-error optimization,
our recipe enables rapid and efﬁcient design of a wide range of PhC cavities.

5.1. Acknowledgements

This work has been supported by the MURI Center for photonic quantum information systems
(ARO/ARDA Program DAAD19-03-1-0199). Dirk Englund has also been supported by the
NDSEG fellowship, and Ilya Fushman by the NIH training grant

A. Derivation of Cavity Radiative Loss
The radiated power per unit solid angle K(q , f ) can be expressed in terms of the radiation
vectors ~N and~L in spherical polar coordinates (r, q , f ) :

K(q , f ) =

h
8l 2

Nq +

2

+

Lf
h

Lq
h

−

(cid:18)(cid:12)
(cid:12)
(cid:12)
(cid:12)

Nf
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

,
(cid:19)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(30)

(cid:209)
(31)

(32)

(33)

(34)

where h =
their components in Cartesian coordinates:

q

m o
e o

. The radiation vectors in spherical polar coordinates can be expressed from

Nq = (Nx cos f + Ny sin f ) cos q
Nf =

Nx sin f + Ny cos f ,

−

and similarly for Lq and Lf . As described in Reference [3], the radiation vectors in Cartesian
coordinates are proportional to 2D Fourier transforms of the parallel (x and y) ﬁeld components
at the surface S (Fig. 1):

Nx =

−

FT2(Hy)
~k
(cid:12)
(cid:12)
||
(cid:12)
(cid:12)

Ny = FT2(Hx)
~k
(cid:12)
(cid:12)
||
(cid:12)
(cid:12)
Lx = FT2(Ey)
~k
(cid:12)
(cid:12)
||
(cid:12)
(cid:12)
FT2(Ex)
~k
(cid:12)
(cid:12)
||
(cid:12)
(cid:12)

y
r0
||
kz = k cos q ,

Ly =

= k(

x
r0

−

,

~k

) = k sin q (cos f ˆx + sin f ˆy)

where k = 2p /l

, l

is the mode wavelength in air, and k

Here the 2D Fourier Transform of the function f (x, y) is

= k sin q .

||

FT2( f (x, y)) =

dxdy f (x, y)ei~k
||·

(x,y)

=

dxdy f (x, y)ei(kxx+kyy)

Z Z

Z Z

Substitution of expressions (32) and (33) into (30) now yields an expression for the radiated
power (5) in terms of the FTs of the four scalars Hx, Hy, Ex, and Ey. This expression is in general
difﬁcult to track analytically. We will now use Maxwell’s relations to express (30) in terms of
only two scalars, Hz and Ez.

Noting that for a bounded function g, FT2(

ikxFT2(g) (similarly for

¶ g
¶ y ), we can

¶ g
¶ x ) =

−

re-write Nq as

Nq =

kxFT2(Hy) + kyFT2(Hx))

(35)

k

kz
k
k

(
−
kz
k
k
−
k
kzce 0
k

i

k

=

=

FT2(

¶ Hy
¶ x −

¶ Hx
¶ y

)

FT2(Ez)

where the last step follows from Maxwell’s Eq. ~(cid:209)
Lq = kzcm 0

FT2(Hz). From ~(cid:209)

~H = 0 and ~(cid:209)

o~E. Similarly, we ﬁnd
~E = 0 at the surface S, it also follows that Nf =

~H = e o

×

¶ ~E
¶ t = iwe

k
k

·

·

k
k

"

1
h 2

FT2(

¶ Hz
¶ z ) and Lf = i

FT2(

¶ Ez
¶ z ). Substituting these expressions into Eq. (30) yields

i

−
k
k

K(kx, ky) =

h
8l 2k2
k
Furthermore, Ez, Hz (cid:181)

2

¶ Ez
¶ z

+

(cid:12)
(cid:12)
(cid:12)
(cid:12)

kzFT2(Ez) + iFT2(

kzFT2(Hz) + iFT2(
(cid:12)
(cid:12)
(cid:12)
(cid:12)
exp(ikzz) for propagating waves inside the light cone (which are the
ikzFT2(Ez) and similarly for Hz. This

)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
¶ Ez
¶ z ) =

)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(36)

#

2

¶ Hz
¶ z

only ones that determine P), implying that FT2(
−
allows further simpliﬁcation of the previous expression to

K(kx, ky) =

h k2
z
2l 2k2

1
h 2 |

k (cid:20)

2 +
FT2(Ez)
|

FT2(Hz)
|
|

2

(cid:21)

Substituting this result back into the expression for total radiated power (5) gives the required

result (7):

P =

dq df sin(q )K(q , f )

dkxdky

J(kx, ky)
K(kx, ky)
|
|

k
||
k

p /2

2p

Z0

Z0

k

Zk
k≤
h
2l 2k

=

=

(cid:20)
Above, J(kx, ky) is the Jacobian resulting from the change of coordinates from (q , f ) to

k≤

(cid:21)

dkxdky
k2
k

kz

Zk

k

1
h 2 |

2 +
FT2(Ez)
|

2
FT2(Hz)
|
|

(kx, ky).

(37)

(38)

