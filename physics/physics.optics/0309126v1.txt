3
0
0
2
 
p
e
S
 
0
3
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
6
2
1
9
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Image processing as state reconstruction in optics

Department of Optics, Palack´y University, 17.

listopadu 50, 77200 Olomouc, Czech Republic

M. Jeˇzek∗ and Z. Hradil

(Dated: July 23, 2013)

The image reconstruction of partially coherent light is interpreted as the quan-
tum state reconstruction. The eﬃcient method based on maximum-likelihood
estimation is proposed to acquire information from registered intensity mea-
surements aﬀected by noise. The connection with totally incoherent image
restoration is pointed out. The feasibility of the method is demonstrated nu-
merically. Spatial and correlation details signiﬁcantly smaller than the diﬀrac-
tion limit are revealed in the reconstructed pattern.

2013 Optical Society of America

c
(cid:13)
OCIS codes: 030.1640, 100.3010, 100.5070, 100.6640, 100.6950, 110.4980.

1.

Introduction

Light conveys considerable part of information on the
Information coded into and trans-
surrounding world.
mitted by means of light plays the key role in contem-
porary information technology. That is why any deeper
understanding of fundamental limitations imposed by the
theory represents a challenging problem. The origin of
the diﬀraction limit restricting the spatial resolution is
comprehended since the era of wave optics. This phe-
nomenon, manifested for example by a fuzzy diﬀraction
spot as a consequence of the ﬁnite aperture, yields a se-
rious limitation in image processing. But there are still
other physical restrictions which must be taken into ac-
count. Direct observations are not able to determine the
phase of optical ﬁelds due to the fast oscillations and
due to the eﬀect of the time integration of intensity de-
tectors. The phase must be therefore retrieved adopting
sophisticated techniques. This is known phase problem,
solution of which is sensitive to noise and requires various
regularization treatments.

the

sets

convex
of

optical device1,2,3,4,5,6,7,8,9,

There are several ways to surpass the mentioned
imposed by realistic aspects of opti-
limitations
cal observations.
Sophisticated algorithms of data
processing and image reconstruction have been de-
such as analytic continuation of signal and
vised,
diagonalization of
dif-
regularization and smoothing techniques of
ferent
direct deconvolution and methods
of projections
(POCS)10,11,12,13,14,15,16,17,18,19,20,
onto
solving
transport-of-intensity equation for
phase reconstruction21,22,23,24,25, utilizing of canonical
transforms26, and statistical methods based on minimum
least-squares distance27,28, maximum entropy29,30,31,
maximum Cramer-Rao bound32,33, and maximum like-
lihood principle34,35,36,37,38,39,40,41. The tomographical
synthesis of diﬀerent intensity observations of an object
can considerably improve its reconstruction and allow
the phase retrieval42,43,44,45,46,47,48,49,50,51,52,53.
The
resolution can also be enhanced by eliminating of out-of-
focus light by means of the apodisation technique54 or
by utilizing of confocal arrangement and interaction be-

tween light and matter, like in multi-photon ﬂuorescence
microscopy and STED technique55,56.

In this article the problem of image processing will be
addressed from the viewpoint of statistical reconstruc-
tion techniques. The series of tomographical-like inten-
sity measurements will be used up for the reconstruction
of a state of partially coherent light. In the particular
case of totally incoherent light the proposed approach
will be identiﬁed with the Richardson algorithm34 of the
image reconstruction.

There is a tight connection between fundamental prin-
ciples of wave optics and quantum mechanics. Descrip-
tion of the scalar wave in optics is equivalent to descrip-
tion of the de Broglie wave of a mass particle in the frame-
work of quantum mechanics. The pure quantum state in
position representation coincides with the complex scalar
wave, and similarly, the mixed quantum state in this rep-
resentation corresponds to the correlation function of the
second order. This connection will be systematically ex-
ploited and the problem of quantum state reconstruction
will be considered in analogy with optical counterpart of
image processing.

For the sake of simplicity all the considered problems
will be treated as two dimensional problems. The ﬁrst
dimension corresponds to the evolution parameter—time
t in dynamical problems or longitudinal z-coordinate in
the case of image processing. The second dimension cor-
responds to the observed quantity. This could be position
in the former case of dynamical problems or transverse
x-coordinate in the later case of image processing. Fur-
ther generalization to higher dimension can be obtained
by a straightforward manner.

2. Wave theory

In this section the analogy between scalar wave optics
and quantum mechanics will be highlighted. As will be
shown, abstract quantum formulation is advantageous for
the purpose of signal reconstruction.

In quantum domain, pure quantum state

from the
Hilbert space represents the complete knowledge about
the position and momentum of a particle, of course obey-

ψ
|

i

ing the Heisenberg uncertainty principle. Any random-
ness in the ensemble of identically prepared particles is
described by the incoherent mixture of pure states—a
density operator,

λk|

ϕkih

.
ϕk|

ρ =

b

Xk

Probabilities λk are nonnegative and adds to unity, and
the mixed state (1) satisﬁes the following relations,

ρ+ =

ρ, Tr[

ρ] = 1,

0,

ψ

,
i

∀|

i ≥

(2)

ψ
h

ρ
|

ψ
|
b

b

b

b

where + means the Hermitian conjugation. Denoting
formally the position by a projector
, complex
x
x
|
|
amplitude ψ(x) =
describes the coherent quasi-
monochromatic scalar ﬁeld. Indeed, it characterizes the
amplitude as well as the phase of the propagating wave.
In the general case of partially coherent ﬁeld, the second
order correlation function9

ψ
x
|
h

ih

i

Γ(x, x′) = Tr [
ρ

ϕkih
x
λkh
|

x′
ϕk|

i

=

ih

] =
x
|

x′
|
b
λkϕk(x)ϕ∗

Xk
k(x′) =

ψ∗(x′)ψ(x)
h

iens, (3)

=

Xk

describes the statistical properties of the ﬁeld. The
brackets
h iens denote the averaging over complex am-
plitudes of all modes k. The analogy between the den-
sity matrix (1) and the mutual intensity (3) is expressed
clearly by the relations analogous to (2),

Γ∗(x′, x) = Γ(x, x′),

dx I(x) = 1, Γ(x, x)

0. (4)

Z

≥

Notice that the function I(x) = Γ(x, x) means the optical
intensity of ﬁeld. The analogy between quantum and
wave descriptions can be emphasized in phase space by
means of the Wigner quasi-distribution57,58,

W (x, p) =

dx′ e−i2px

Γ(x + x′, x

x′).

(5)

′

−

1
π Z

This (x, p) distribution is real bounded function, which
is however, not positively deﬁned in general.

Let us proceed further to consider the state transfor-
mation. Assuming linearity and causality the equation
for evolution of pure state formally reads

iout =
T is linear operator satisfying the equation

ψ
|
b

iin.

ψ
|

T

Here

b

∂
∂z

T =

L

T ,

b
L of
where z is evolution parameter and the generator
evolution is considered to be z-independent. The evolu-
tion equation (7) covers both the Schr¨odinger equation
in quantum mechanics and paraxial Helmholtz equation

b

b

b

(6)

(7)

2

in Fresnel approximation of scalar wave optics. The uni-
tary evolution is governed by the Hamiltonian operator,
L =
H, and the evolution of the mixed state is de-
scribed by transformation
b

−

i
¯h

b

(1)

ρout =

T

ρin

T +,

T = exp

(8)

i
¯h

Hz

.
(cid:21)

(cid:20)−

b

b

b

b

b

b

Evolution (8) of the state

ρ in the Schr¨odinger picture
can be equivalently formulated in the Heisenberg picture.
b
This formulation follows the laws of ray optics. Indeed,
the relationship between the canonical observables of po-
sition and momentum reads

(cid:18)

xout
pout (cid:19)
b
b

=

T +

(cid:18)

T .

xin
pin (cid:19)
b
b

b
Particularly, for the evolution generated by quadratic
Hamiltonian in canonical observables the transformation
(9) is linear,

b

(9)

,

(cid:18)

(cid:18)

(cid:18)

=

= T

(10)

A B
C D (cid:19) (cid:18)

xout
pout (cid:19)
b
b

xin
xin + s
pin + r (cid:19)
pin (cid:19)
b
b
b
b
where Det[T ] = AD
BC = 1. This generic ABCD
transformation covers useful cases of wave transforma-
tion, for example free evolution, displacement, rotation,
phase shift, squeezing, and chirp. Linear transformation
of the (
p) operators induces the evolution of the Wigner
function by linear transformation of its variables,

x,

−

b

b

W (x, p) = W (Dx

Bp

s,

Cx + Ap

−

−

−
Roughly speaking, all these transformations rotate and
rescale the input state. As the consequence, the observ-
able A
p can be measured oﬀering an important tool
for all the tomographical methods.

x + B

−

(11)

r).

b

b

x,

In the classical limit there is a tight connection be-
tween evolution of position and momentum operators in
the Heisenberg picture (10) and geometrical paraxial op-
tics represented by the identity between operators (
p)
and its c-values (x, p). The state vector (x, p) is used
b
to specify position and angle of the optical ray. Simi-
lar description may be adopted for particle in classical
mechanics. Evolution operator
T is given by the ABCD
matrix T completed by the transverse shift s and rotation
r in analogy with the relation (10). Geometrical optics
as well as classical mechanics do not involve interference,
what simpliﬁes the input-output relations considerably.
This is why the geometrical optics is so suitable for “di-
rect” observations. Indeed, if the positions x1, x2 for the
two values z1, z2 are measured, the state vector (x0, p0)
for z = 0 can be completely reconstructed as

b

b

x0
p0 (cid:19)

(cid:18)

=

1
z2 −

x1z2 −
x2 −

x2z1
x1 (cid:19)

.

z1 (cid:18)

(12)

In the case of losses the evolution turns out to be non-
unitary. Let us imagine the absorbing screen with 2a
aperture. The incident state can be decomposed in the

of position

x on screen. Since only
base of eigenstates
a part of eigenstates spectrum for eigenvalues ξ
a, a]
is transmitted, the non-unitary transformation can be
described by projection operator

[
−

ξ
|

∈

b

i

a

T =

dξ

ξ
|

ξ
ih

|

Z

−a

b

(13)

(14)

(15)

corresponding to ﬁnite aperture.

Let us conclude the overview by explicit formulation of
the state transformation in position representation. The
generic evolution (6) of the pure state (coherent wave)
takes a well-known form of the superposition integral ,

ψout(x) =

ψ
x
|
h

iout =

T
x
dx0 h
|

x0ih
|
b
dx0 h(x, x0) ψin(x0).

Z

ψ
x0|

iin =

=

Z

The kernel of the integral transformation (14),

h(x, x0) =

T
x
|
h

,
x0i
|
b

is called propagator in the quantum theory and the re-
sponse function or point-spread function (PSF) in the
scalar wave theory59. Loosely speaking, it relates the
point source in the object (input) plane, z = 0, with
its image in the image (output) plane with coordinate
z. This mapping is fuzzy in realistic image processing
due to the eﬀect of diﬀraction caused by non-unitary
evolution. In the case of unlimited aperture it may be-
come sharp corresponding to the case of unitary evolu-
T −1. Analogously, the evolution (8) of the
tion,
mixed state (mutual intensity) in the position represen-
b
tation reads

T + =

b

Γout(x, x′) =

dqdq′ h(x, q)h∗(x′, q′) Γin(q, q′).

(16)

Z Z

3. Detection

According to standard formulation of quantum mechan-
ics the measurement is represented by an observable, a
A. Eigenvalues of this operator cor-
Hermitian operator
respond to possible results of elementary measurements.
Eigenstates determine the possible states after the mea-
surement and they are complete and orthogonal,

b

= a

a
|

,
i

a
A
|
b

i

Xa

b

a

=

1,

a
|

ih

|

a
h

a′
|

i

= δaa′.

(17)

ρ

a

ih

a
|

These properties are reﬂected in the probability pa =
] predicted by quantum theory guaranteeing
Tr[
|
a pa = 1 (complete-
the normalization of probabilities
ness), and mutual exclusivity of the results a (orthog-
onality). This description may be further generalized
in terms of positive-operator valued measure (POVM)
yielding the decomposition of identity operator60,61,

P

b

3

ρ

b

It predicts the probability for registering the output b
analogously to the case of orthogonal projectors, pb =
Πb]. The notion of POVM plays the crucial role
Tr[
in description a generic quantum measurement in state
estimation and discrimination.

b
Registration of the image intensity I(x) of partially
coherent wave in the transverse position x corresponds
to the measurement of position operator
x in the output
plane,

I(x) = Γout(x, x) = p(x) = Tr [

(19)

Realistic detector always possesses the ﬁnite spatial re-
solving power. Denoting its pixels by the indices i, the
simplest representation of detector POVM is given by the
operators

b
x
ρout|
b

] .
x
|

ih

Oi =

dx

x
|

ih

,
x
|

Z∆i

b

(20)

where the integration is done along the surface of the i-th
pixel.

b

Consider now the generic observation scheme. The in-
ρ represented by its mutual intensity Γ(x, x′)
put state
T =
in wave description is transformed by optical device
T (A, B, . . .) with the response function h(x, x0; A, B, . . .).
ρout is observed by the detector
Resulting output state
b
(20) placed in the output plane. The detector counts
the elementary clicks in every i-th pixel. The numbers
Ni of registered clicks represented by relative frequen-
i Ni, sample the probabilities pi
cies fi = Ni/N , N =
(intensities Ii),

b

b

P

pi = Tr

ρout

Oi

= Tr

h

i

ρ
h

Πi

,

i

Πi =

T +

Oi

T .

(21)

b

b

b

b

b

b

b
b
Notice however, that this scheme is rather classical and
it does not take into account statistics of detection pro-
cess in accordance with classical image processing, when
intensity is considered as measurable quantity. Provided
that quantum nature of detection will be considered, the
relation (20) should be modiﬁed taking into account reg-
istration of photons instead.

4. Direct reconstruction

The reconstruction of the signal in wave theory is rather
involved and extensive ﬁeld with many applications. Let
us review brieﬂy this topic. Assuming an unknown signal
propagating through optical refractive and diﬀractive el-
ements, the output ﬁeld may be detected. Provided that
properties of the optical device are known, and detection
is ideal, the input signal may be predicted from the out-
put one. This is the classical inverse problem of wave
optics.

Standard methods use the isoplanatic approximation

involving the relation (14) as convolution,

0,

Πb ≥
b

Πb =

1.

Xb

b

b

(18)

ψout =

dx0 h(x

x0) ψin(x0) = h

ψin.

(22)

Z

−

∗

Inversion is given by the Fourier deconvolution

ψin =

ψout +

h

e

.

N
e

(23)

e

e

e

e

ψin,

N
e

e
h are Fourier transformations of ψin,
Here
ψout, and
represents the spectrum
ψout, and h, respectively, and
e
. Typical point-spread function h
of additive noise
N
has the form of Sinc or BeSinc function and
h corre-
sponds to step-function. Hence, the spatial frequencies
of the signal are transmitted only up to certain upper
cut-oﬀ59. This is why the deconvolution is very sensi-
and diverges at spatial frequencies for
tive to noise
N
which the transfer function
h turns to be zero. In par-
ticular, for frequencies above the cut-oﬀ, the transfer
e
h vanishes and (23) diverges due to the broad
function
noise spectrum
. Some regularization procedures are
necessary in all these cases10,11,12,13,14,15,16. The spe-
cial attention has been devoted to the more accurate de-
scription of the optical device. Detailed analysis needs
special choice of eigenfunctions related to ﬁnite aper-
ture instead of spatial frequencies3,4,5. Systematic the-
ory of this remarkable basis, so called prolate spheroidal
wave functions, was given by Frieden6.
Several fur-
ther super-resolution techniques as apodisation54 or an-
alytic continuation7,8 have been suggested. The inverse
source problem may be further generalized, taking into
account other realistic aspects of detection. For exam-
ple, optical intensity is detected by real photo-detectors
instead of complex amplitude and phase is subject of
reconstruction1,2,9,16,18,19,20,21,22,23,24,25,26.

N
e

e

b

b

x + B

Standard image processing deals with the observa-
tion in the image plane revealing the sharpest image.
However, the observations in defocused planes are also
worthwhile45,47,52,62. They correspond to the observation
of A
p operators in the language of quantum the-
ory (10), bringing other piece of information about signal
and aﬀording better employment of measured data. Such
tomographical technique was suggested by Bertrand,
Bertrand42 and Vogel, Risken43 and experimentally ver-
iﬁed by group from University of Oregon44. Up to now
several other tomographical schemes for observing of var-
ious faces of the system have been proposed. This is usu-
ally achieved by adjusting of some parameters in the set-
up. Particular conﬁguration in dependence on parameter
provides the desired group of transformations. Both the
classical X–ray tomography (CT) used in medicine63,64,65
and the homodyne tomography43,44,50,51,53 use the group
of rotations. Phase-space tomography and chronocyclic
tomography are connected with the symplectic group but
they are convertible to the classical tomography45,47,52.
General non-homogeneous symplectic tomography was
introduced by Mancini, Man’ko, and Tombesi48.

All the above mentioned inverse problems are relat-
ing measured data fi with theoretical probabilities pi by
means of the equality

4

where multi-index i passes over all conﬁgurations of op-
tical device and over all pixels of detector. However, the
solution of linear equations (24) represents an ill-posed
problem of the same kind as image reconstruction us-
ing deconvolution. This procedure is very sensitive to
noise, which is an inevitably involved in any measurement
Ill posed problem implies, that reconstructed
scheme.
“state” need not represent any physically possible ob-
ject. In the language of quantum theory this means that
< 0 may hold for some states. Alternatively,
ψ
h
the optical intensity I(x) may drop below zero at some
position coordinates in wave-theory language. Linear al-
gorithm is not capable to guarantee such necessary condi-
tions as positive deﬁniteness of density matrix or mutual
intensity.

ψ
|
b

ρ
|

i

Statistical approaches suggest a remedy to this prob-
lem releasing the strict condition (24). For example, the
equality between fi and pi could be replaced by require-
ment of their minimal least-squares distance

2

,

Tr

fi −

ρ
h

Πi

i(cid:12)
(cid:12)
(cid:12)

b

b

Xi

(cid:12)
(cid:12)
(cid:12)

(25)

an obvious choice in engineering practice.
But
Least-squares
the other metrics are also eligible.
method27,28,66, Richardson method34, maximum-
likelihood (ML) principle and expectation-maximization
(EM) algorithm35,36,37,38,39,40,41,67,68, principle of maxi-
mum Cramer-Rao bound32,33, maximum entropy (ME)
method29,30,31,69,70,71, and intrinsic correlation function
(ICF) model represent several examples of various
statistical signal-processing schemes.
In the following
section the arguments in favor of maximum likelihood
estimation will be formulated with the help of quantum
treatment.

5. Reconstruction as generalized quantum mea-
surement

Let us assume the generic scheme for the quantum mea-
surement (20)-(21) described above. The conditional
probability of detecting Ni clicks in the i-th pixel, if the
state
ρ occurs in the input plane, has the form of multi-
nomial distribution

b

pN fi
i

,

ρ)
(
L

b

≈ Yi

(26)

where fi are the relative frequencies of registered clicks,
N fi = Ni. The input state
ρ is the subject of estimation
procedure. The likelihood functional (26) then gives the
b
answer to the question “How is it likely that the given
data fi were registered provided that the system was in
the given quantum state
ρ?” For some states the detec-
tion of given data is more likely than for others. Using
the relation (21) the log-likelihood function reads

b

Tr

ρ

Πi

= fi,

i

h

b

b

(24)

ln

ρ) =
(
L

Xi

b

fi ln pi =

fi ln Tr

(27)

Xi

ρ
h

Πi

.

i

b

b

Maximum likelihood principle selects such a state
which the likelihood reaches its maximum,

ρest for

b

(28)

ρest = arg

max
ˆρ

(cid:20)

ln

ρ)
(
L

(cid:21)

.

b
The formal necessary condition

b

δ ln
ρ)
(
L
ρ
δ

= 0

(29)

b

ˆρest

(cid:12)
(cid:12)
b
(cid:12)
(cid:12)
may be rewritten to the form of extremal operator equa-
tion 72,73,74,75,76, or alternatively, extremization can be
done by means of numerical up-hill simplex method77.
Any density matrix may be parameterized in diagonal
form (1) using independent (orthogonal) basis states
and the variation (29) may be done along these
ϕki
|
rays. Likelihood function depends on the density matrix
through probabilities pi. This yields the system of cou-
pled equations δ ln L( ˆρ)
δ hϕk| = 0 for any allowed component
k. Using the relation

δ ln
δ

ρ)
(
L
ϕk|
h
b

=

Xi

fi
pi

,
ϕki

Πi|
b
ρ] = 1,

and the normalization Tr[
equation72,73,74,75,76 for the density operator

the extremal
ρ reads

(30)

b

(31)

Here

b
ρ =

ρ.

R

b

b

b

R =

b

Xi

fi
pi

Πi,

b

R(

and probabilities pi are state dependent (21). Operator
equation (31) determines the most likely solution
ρest, for
1 holds on the Hilbert space of the state
which
72,75. No prior knowledge about the estimated state
ρest
is needed. Results of the measurement itself are suﬃcient
b
for analysis.

ρest) =

b

b

b

b

Let us develop the optical counterpart of this recon-
struction problem. In the spatial domain the extremal
equation (31) has the form of integral equation for mu-
tual intensity Γ(x, x′),

dx′

(q, x′) Γ(x′, q′) = Γ(q, q′),

(33)

Z

R

5

correspond to the operator
R and to the POVM operators
Πi, respectively. The probabilities (21) of elementary
b
detection in individual pixels then read
b

pi =

Z Z

dq dq′ Γ(q, q′)

Pi(q′, q).

(36)

The equation (33) relates measured data fi, properties
of optical device, and reconstructed signal Γ(x, x′). De-
pendence on the optical apparatus is expressed via point-
spread function h(x, x′) only. However, this mutual re-
lation is inseparable, since the relation is nonlinear. In
comparison to standard treatments in scalar optics, no
assumptions about statistical nature of the signal have
been done. This seems to be reasonable, since the coher-
ence properties of the light ﬁeld may change during the
propagation (van Cittert–Zernike eﬀect9). The proposed
formulation anticipates only the knowledge of the opti-
cal apparatus and the measured data without any prior
assumptions about the unknown signal.

Special cases of the generic formulation deserve atten-
tion. Let us assume an iterative solution of the equa-
tion (33) taking the maximally-ignorant initial guess rep-
ρ(0) =
resented by the totally mixed uniform state,
1
1, where 1/D ensures the trace normalization in D-
D
dimensional Hilbert space. After evaluating the kernel
R(0) we are able to write down the ﬁrst iteration of es-
ρ(0) =
Πi]. In the
timated state,
b
spatial domain this state has the form of partially coher-
ent superposition of response functions (15) weighted by
measured data fi,

b
i fi = 1,

Πi/Tr[

ρ(1) =

R(0)

i fi

P

b

b

b

b

b

b

P

Xi

∆idx h∗(x, q)h(x, q′)
2 .
dξ

h(x, ξ)
|
|

∆idx
R

fi R
R

(37)

It is clear that the coherence properties of estimated sig-
nal are changed during repeated iterations of extremal
equation (33). Besides the proposed iterative solution the
well-known EM algorithm37 completed by unitary step75
can also be utilized. This guarantees the convergence and
keeps all fundamental properties (4) of partially coherent
signal Γ(x, x′).

As the second special case the totally incoherent light

can be assumed,

Γ(x, x′) = I(x)δ(x

x′),

(38)

−

where δ(x) is Dirac distribution. The extremal equation
then reduces to

dq′

(q, q′) I(q′) = I(q),

(39)

Z

R

(32)

Γ(1)(q, q′) =

where the resolution of identity
used. Kernel

x
|

ih

x
|

has been

whereas the probabilities (36) read

1 =

dx

R

b
fi
pi Pi(q, x′)

(q, x′) =

R

Xi

and functions

Pi(q, x′) =

Z∆i

dx h∗(x, q) h(x, x′)

(35)

(34)

pi =

dq

Pi(q, q) I(q).

Z

(40)

The relations (39), (34), and (40) provide the extremal
equations for unknown optical intensity I(x),

fi

dq

Pi(q, q)I(q) Z

Xi

R

dq′

Pi(x, q′)I(q′) = I(x).

(41)

This relationship may be utilized for iterative procedure
as was proposed by Richardson in 1972 for incoherent im-
age reconstruction. Notice, however, that in the original
derivation34 the Bayes rule was adopted. The treatment
devised here makes it possible to extend the solution to
the cases of partially or totally coherent signals.

6. Numerical example

In this section we demonstrate the feasibility and advan-
tages of the presented method by means of the carefully
selected example. The partially coherent testing object
is chosen below the resolution limit of the simple optical
device with ﬁnite aperture. Therefore, the observed im-
ages do not bear any resemblance with the true object.
In spite of this obvious limitations the reconstructed ob-
ject reveals the original structure. This improvement is
achieved by adjusting of the detector position in trans-
verse and longitudinal directions. The background noise
is added to simulated intensities. Only these data enter
the reconstruction procedure (33)-(34).

Let us consider the optical set-up that consist of free
evolution to the distance din, thin lens with the focal
length f , and free evolution to the distance dout. The lens
has the ﬁnite aperture diameter 2a. The whole device
can be transversely shifted to a distance s from axial
position. The longitudinal distance din from the object
and transverse shift s are parameters of the optical set-up
and they may be adjusted during measurement, while the
other parameters are kept constant. The point-spread
function h(x, x0) = h(x, x0; din, s) =
of
the device under consideration reads

x0i
T (din, s)
x
|
|
h

h(x, x0) =

exp (

x
|
h

i

dout
2k

−

p2)

dξ

ξ
|

ξ
ih

|×

Z

−a

b

a

exp (

×

i

k
2f

−

x2) exp (

i

din
2k

−

b

p2) exp (

is

p)

,
x0i
|

−

(42)

b

b

b

where k = 2π/λ is the longitudinal wave number. With
the help of the relations
,
dx
x
p
|
|
ih
= (2π)−1/2 exp (ixp) the point-spread function
and
(42) can be rewritten to the form

p
x
|
h

,
x
|

1 =

1 =

p
|

dp

ih

b

b

R

R

i

Here

h∞(x, x0) = const e

x2
out

d

+ (x

0 +s)2
d
in

− θ2

∆

i k
2

h(cid:16)

(cid:17)

i

(44)

is the response function of the ideal refractive focusing
device and

(x, x0) =

erf

E

1
2
1
2

i

i

1

1

(cid:20)

(cid:20)

−
2

−
2

√k∆

√k∆

(cid:19)(cid:21) −

+ a

θ
∆
θ
∆ −

(cid:18)

(cid:18)

a

(cid:19)(cid:21)

erf

−

(45)

represents the correction to the ﬁnite aperture. This
(x, x0) = 1.
tends to unity for large aperture, lima→∞ E

h(x, x0; din, s) = h∞(x, x0)

(x, x0).

(43)

E

)
q
(
I

6

(46)

(47)

(48)

(49)

The parameter ∆ characterizes the defocusing from the
imaging conﬁguration,

∆ =

+

1
din

1

dout −

1
f

,

the parameter θ is related to the transverse wave number,

θ = θin + θout =

x0 + s
din

+

x
dout

,

and the function erf() denotes the common error func-
tion,

erf(z) =

z
dt e−t2

.

2
√π Z
0

In the present simulation the parameters have been
chosen as λ = 600 nm, dout = 1.5 m, f = 0.5 m, and
a = 0.6 mm. The image (∆ = 0) appears at the distance
din = 0.75 m. However, it is blurred due to the small
aperture. In fact, details closer than the diﬀraction limit

R = C λ

dout
a

are mapped to two spots with insuﬃcient contrast ac-
cording to Rayleigh’s criterion. The factor C depends on
aperture shape and coherence properties of the signal. It
equals to 0.61 in the case of circular shape and totally
incoherent light, or to 0.82 in the case of totally coherent
light (Abbe’s resolution limit). We set C = 0.5, what
is equal or smaller than any classical resolution limit for
imaging with partially coherent light. The testing ob-
ject consists from four bright spots separated by dark
spaces. The distance 0.15 mm between the edges of the
central closest spots is 5-times smaller than resolution
limit R (49). The corresponding optical intensity I(q)
is shown in Fig. 1. The oﬀ-diagonal peaks of mutual

2R

−

R

−

0
q

R

2R

Fig. 1. Optical intensity I(q) of the true object in the
input plane.

intensity Γ(q, q′) of the testing object representing the
cross-correlations between the spots are lower than di-
agonal ones due to the partial coherence. The contrast
= 1.

Imin)/(Imax + Imin) of the object is

= (Imax −

V

V

7

0

200

400

600

800

iteration

Fig. 3. The exponentially fast convergence of square dis-
tance ε during the extremization process.

iterations, see Fig. 4. The positions and relative intensi-

×

−

100 points (qm, q′

The object plane is discretized by 100 equidistant
1.5, 1.5] mm, or equivalently
points in the interval [
2R, 2R]. The corresponding mutual intensity Γ(q, q′)
[
−
is given on the square mesh of 100
n)
in the process of data generation and subsequent state
reconstruction. Similarly, the detection plane x in the
4, 4] mm is sampled only by 64 pixels xi for
interval [
0.05 j) m,
every longitudinal distance dinj = (0.75
j = 0, . . . , 5, and for every transverse shift sl = (
1.2 +
0.3 l) mm, l = 0, . . . , 8. Using the relations (35), (36),
and (43)-(45) the intensities pijl = Ijl(xi) in the pixels i
can be evaluated for all the conﬁgurations of the optical
set-up. For example, in the case of imaging axial conﬁg-
uration (j = 0, l = 4) the intensity reveals the central
peak with small side lobes, see Fig. 2. The correspond-

−

−

−

)
x
(
I

1

0.01

0.0001

ε

1e-06

1e-08

1e-10

1e-12

)
q
(
I

4
−

2
−

0

x [mm]

2

4

Fig. 2. Simulated relative frequencies fi (points) aﬀected
by 20% of background noise sample the optical intensity
I(x) in the detection plane (lines) for imaging axial ar-
rangement, din = 0.75 m, s = 0.

×

ing under-sampled data fi spoiled by 20% of background
noise are shown in the same ﬁgure. These simulated rela-
tive frequencies fijl serve as an input for the reconstruc-
tion procedure (33)-(34). To solve the extremal equation
(33) we need to ﬁnd the mutual intensity on the given
mesh as the hermitian matrix of the dimension 100
100.
As an initial iteration, the uniform incoherent superpo-
sition of all pure states on the supposed space is used. It
exhibits ﬂat intensity proﬁle. It is interesting to note that
the ﬁnal results seems to be independent of the choice
of initial mutual intensity. In the course of repeated it-
erations of the discretized equation (33) the diﬀerence
Γ(n)(q, q′)]2 between succes-
ε =
sive iterations can be used as the criterion for terminating
the extremization process. Numerical results show that
the diﬀerence ε reaches the level about 10−6 after several
tens of iterations and it reaches the level 10−12 after ap-
proximately 1000 iterations, see Fig. 3. The convergence
improves slightly for smaller portion of background noise.
Iterated intensity starts to reveal the four-peak structure
after relatively small number of steps. The contrast
of
the central part of the estimated optical intensity beyond
the diﬀraction limit R reaches the value of 0.56 after 1000

dqdq′[Γ(n+1)(q, q′)

RR

−

V

2R

−

R

−

0
q

R

2R

Fig. 4. Reconstructed optical intensity I(q) in the input
plane.

ties of bright spots in estimated object match very well
the structure of the true object. This is demonstrated in
Fig. 5.

The numerical simulations clearly show that the pro-
posed reconstruction algorithm is feasible and could
be implemented.
It provides considerable improve-
ment comparing to non-statistical image processing tech-
niques, and signiﬁcantly, it yields the complete informa-
tion in the form of correlation function.

7. Conclusion

The purpose of the presented paper is twofold. First
the tight connection between wave optics and quantum
mechanics has been emphasized. The operator language
routinely used in quantum theory can simplify the manip-
ulation and description of optical objects, like partially
coherent wave and response function of optical device.
The second goal of the contribution is the mathematical
formulation of the reconstruction algorithm for partially
coherent signal proceeded from the maximum-likelihood
estimation of mixed quantum state72,73,74,75,76. The solu-

2R

R

R

−

0

q′

References

8

Acknowledgments

We would like to thank Z. Bouchal, J. Fiur´aˇsek,
M. Duˇsek, and J. ˇReh´aˇcek for valuable discussions.
This work was supported by the EU grant under
QIPC, project IST-1999-13071 (QUICOV) and by Grant
LN00A015 of the Czech Ministry of Education.

∗ Electronic address: jezek@optics.upol.cz

1. R. E. Burge, M. A. Fiddy, A. H. Greenaway, and
G. Ross, “The application of dispersion relations
(Hilbert transforms) to phase retrieval,” J. Phys.
D: Appl. Phys 7, L65 (1974).

2. R. E. Burge, M. A. Fiddy, A. H. Greenaway, and G.
Ross, “The phase problem,” Proc. Roy. Soc. Lond.
A 350, 191 (1976).

3. B. R. Frieden, “Band-unlimited reconstruction of
optical objects and spectra,” J. Opt. Soc. Am. 57,
1013 (1967).

4. B. R. Frieden, “On arbitrarily perfect imagery with

a ﬁnite aperture,” Opt. Acta 16, 795 (1969).

5. G. Toraldo di Francia, “Degrees of freedom of an

image,” J. Opt. Soc. Am. 59, 799 (1969).

6. B. R. Frieden, “Evaluation, Design and Extrapo-
lation Methods for Optical Signals, Based on Use
of the Prolate Functions,” in Progress in Optics 9,
E. Wolf, ed., (North-Holland, Amsterdam, 1971),
Chap. 8, p. 311.

7. J. Peˇrina and V. Peˇrinov´a, “Optical imaging with
partially coherent non-thermal light. II. Reconstruc-
tion of object from its image and similarity between
object and its image,” Optica Acta 16, 309 (1969).
8. J. Peˇrina, V. Peˇrinov´a, and Z. Braunerov´a, “Super-
resolution in linear systems with noise,” Optica Ap-
plicata VII, 79 (1977).

9. J. Peˇrina, Coherence of Light (D. Reidel Publ.

Comp., Dordrecht, 2nd ed. 1985).

10. D. L. Phillips, “A technique for the numerical solu-
tion of certain integral equations of the ﬁrst kind,”
J. Assoc. Comput. Machinery 9, 84 (1962).

11. S. Twomey, “On the numerical solution of Fredholm
integral equations of the ﬁrst kind by the inversion
of the linear system produced by quadrature,” J.
Assoc. Comput. Machinery 10, 97 (1963).

12. K. Miller, “Least squares methods for ill-posed
problems with a prescribed bound,” SIAM J. Math.
Anal. 1, 52 (1970).

13. A. N. Tikhonov and V. Y. Arsenin, Solution of ill-

posed problems (Wiley, New York, 1977).

14. G. E. Backus and F. Gilbert, “The resolving power
of growth earth data,” Geophys. J. Roy. Astron.
Soc. 16, 169 (1968).

15. G. E. Backus and F. Gilbert, “Uniqueness in the
inversion of inaccurate gross earth data,” Philos.
Trans. Roy. Soc. Lond. A 266, 123 (1970).

16. R. W. Gerchberg and W. O. Saxton, “A practical
algorithm for the determination of phase from im-

2R

−

R

−

0
q

R

2R

−

2R

Fig. 5. Contour lines (thin) of the reconstructed mutual
intensity Γ(q, q′). The positions of the diagonal bright
spots as well as the positions of oﬀ-diagonal correlations
match the true ones (thick lines).

tion of extremal equation by means of repeated iterations
has been suggested. The ﬁrst iteration has been explic-
itly formulated. The proposed method never yields the
non-physical results.

The feasibility of the method has been veriﬁed by ex-
tensive numerical simulations. The realistic experimen-
tal data will be considered in the forthcoming publica-
tion. The particular numerical example shows the good
agreement between the true and estimated states of par-
tially coherent light beyond the diﬀraction limit, despite
of under-sampled data and 20% of background noise.

The method is able to estimate the generic signal with-
out any prior assumptions, utilizing only real noisy data.
The potential applications cover wide range of optical in-
verse problems. The method may be used for the state
estimation of the localized mode in photonic band-gap
structures (photonic crystals), for the determination of
the near-ﬁeld short-range correlation of the signal trans-
mitted through random media78, and for the reconstruc-
tion of spatial and coherence properties of light conﬁned
and emitted by modern laser-diode sources. Moreover,
the general quantum origin of the method allows us to es-
timate arbitrary continuous (discretized) partially coher-
ent physical object described by the correlation function
or the Wigner function. The reconstruction of de Broglie
wave function of a particle and the optical homodyne de-
tection of a quantum state of the light mode are typical
examples79. In short, the method is applicable to all in-
verse problems where the precise knowledge of partially
coherent signal (mixed state) is essential, providing that
the measurement device and real data are known.

age and diﬀraction plane pictures,” Optik 35, 237
(1972).

17. R. W. Gerchberg, “Superresolution through error
energy reduction,” Opt. Acta 21, 709 (1974).
18. J. R. Fienup, “Phase retrieval algorithms: a com-

parison,” Appl. Optics 15, 2758 (1982).

19. W. Kim, “Two-dimensional phase retrieval using a
window function,” Opt. Lett. 26, 134 (2001).
20. R. W. Gerchberg, “A new approach to phase re-
trieval of a wave front,” J. Mod. Opt. 49, 1185
(2002).

21. M. R. Teague, “Irradiance moments: their propaga-
tion and use for unique retrieval of phases,” J. Opt.
Soc. Am. 72, 1199 (1982).

22. M. R. Teague, “Deterministic phase retrieval: a
Green’s function solution,” J. Opt. Soc. Am. 73,
1434 (1983).

23. K. A. Nugent, T. E. Gureyev, D. F. Cookson, D.
Paganin, and Z. Barnea, “Quantitative phase imag-
ing using hard X rays,” Phys. Rev. Lett. 77, 2961
(1996).

24. D. Paganin and K. A. Nugent, “Noninterferometric
phase imaging with partially coherent light,” Phys.
Rev. Lett. 80, 2586 (1998).

25. L. J. Allen and M. P. Oxley, “Phase retrieval from
series of images obtained by defocus variation,” Opt.
Commun. 199, 65 (2001).

26. M. J. Bastiaans and K. B. Wolf, “Phase recon-
struction from intensity measurements in linear sys-
tems,” J. Opt. Soc. Am. A 20, 1046 (2003).
27. C. W. Helstrom, “Image restoration by the method
of least squares,” J. Opt. Soc. Am. 57, 297 (1967).
28. Y. Biraud, “A new approach for increasing the re-
solving power by data processing,” Astron. Astro-
phys. 1, 124 (1969).

29. B. R. Frieden, “Restoring with maximum likelihood
and maximum entropy,” J. Opt. Soc. Am. 62, 511
(1972).

30. S. F. Gull and G. J. Daniell, “Image reconstruction
from incomplete and noisy data,” Nature (London)
272, 686 (1978).

31. B. R. Frieden and D. J. Graser, “Closed-form max-
imum entropy image restoration,” Opt. Commun.
146, 79 (1998).

32. B. R. Frieden, “Applications to optics and wave me-
chanics of the criterion of maximum Cramer-Rao
bound,” J. Mod. Opt. 35, 1297 (1988).

33. J. ˇReh´aˇcek and Z. Hradil, “Invariant information
and quantum state estimation,” Phys. Rev. Lett.
88, 130401 (2002).
34. W. H. Richardson,

“Bayesian-based iterative
method of image restoration,” J. Opt. Soc. Am. 62,
55 (1972).

35. A. Rockmore and A. Macovski, “A maximum like-
lihood approach to emission image reconstruction
from projections,” IEEE Trans. Nucl. Sci. 23, 1428
(1976).

9

hood approach to transmission image reconstruction
from projections,” IEEE Trans. Nucl. Sci. 24, 1929
(1977).

37. A. P. Dempster, N. M. Laird, and D. B. Rubin,
“Maximum likelihood from incomplete data via the
EM algorithm,” J. R. Statist. Soc. B 39, 1 (1977).
38. L. A. Shepp and Y. Vardi, “Maximum likelihood
reconstruction for emission tomography,” IEEE
Trans. Med. Imaging 1, 113 (1982).

39. D. L. Snyder, M. I. Miller, J. L. J. Thomas,
and D. G. Politte, “Noise and edge artifacts in
maximum-likelihood reconstructions for emission
tomography,” IEEE Trans. Med. Imaging 6, 228
(1987).

40. Y. Vardi and D. Lee, “From image deblurring to
optimal investments: Maximum likelihood solutions
for positive linear inverse problems,” J. R. Statist.
Soc. B 55, 569 (1993).

41. J. ˇReh´aˇcek, Z. Hradil, M. Zawisky, W. Treimer, and
M. Strobl, “Maximum likelihood absorption tomog-
raphy,” Europhys. Lett. 59, 694 (2002).

42. J. Bertrand and P. Bertrand, “A tomographic ap-
proach to Wigner’s function,” Found. Phys. 17, 397
(1987).

43. K. Vogel and H. Risken,

“Determination of
quasiprobability distribution in terms of probabil-
ity distribution for the rotated quadrature phase,”
Phys. Rev. A 40, 2847 (1989).

44. D. T. Smithey, M. Beck, M. G. Raymer, and A.
Faridani, “Measurement of the Wigner distribution
and the density matrix of a light mode using opti-
cal homodyne tomography: Application to squeezed
states and the vacuum,” Phys. Rev. Lett. 70, 1244
(1993).

45. M. G. Raymer, M. Beck, and D. F. McAlister,
“Complex wave-ﬁeld reconstruction using phase-
space tomography,” Phys. Rev. Lett. 72, 1137
(1994).

46. G. M. D’Ariano, C. Macchiavello, and M. G. A.
Paris, “Detection of the density matrix through op-
tical homodyne tomography without ﬁltered back
projection,” Phys. Rev. A 50, 4298 (1994).

47. D. F. V. James and G. S. Agarwal, “Generalized
Radon transform for tomographic measurement of
short pulses,” J. Opt. Soc. Am. B 12, 704 (1995).

48. S. Mancini, V. I. Man’ko, and P. Tombesi, “Wigner
function and probability distribution for shifted and
squeezed quadratures,” Quantum Semiclass. Opt. 7,
615 (1995).

49. K. Banaszek and K. Wodkiewicz, “Direct probing
of quantum phase space by photon counting,” Phys.
Rev. Lett. 76, 4344 (1996).

50. S. Schiller, G. Breitenbach, S. F. Pereira, T. Muller,
and J. Mlynek, “Quantum statistics of the squeezed
vacuum by measurement of the density matrix in
the number state representation,” Phys. Rev. Lett.
77, 2933 (1996).

36. A. Rockmore and A. Macovski, “A maximum likeli-

51. G. Breitenbach, S. Schiller, and J. Mlynek, “Mea-

surement of the quantum states of squeezed light,”
Nature (London) 387, 471 (1997).

52. C. Kurtsiefer, T. Pfau, and J. Mlynek, “Measure-
ment of the Wigner function of an ensemble of he-
lium atoms,” Nature (London) 386, 150 (1997).
53. A. I. Lvovsky, H. Hansen, T. Aichele, O. Benson,
J. Mlynek, and S. Schiller, “Quantum state recon-
struction of the single-photon Fock state,” Phys.
Rev. Lett. 87, 050402 (2001).

54. P. Jacquinot and B. Roizen-Dossier, “Apodisation,”
in Progress in Optics 3, E. Wolf, ed., (North–
Holland, Amsterdam, 1964), Chap. 2, pp. 29–186.
55. M. Dyba and S. W. Hell, “Focal spots of size
λ/23 open up far-ﬁeld ﬂuorescence microscopy at
33 nm axial resolution,” Phys. Rev. Lett. 88, 163901
(2002).

56. E. H. K. Stelzer, “Beyond the diﬀraction limit?,”

Nature (London) 417, 806 (2002).

57. E. Wigner, “On the quantum correction for thermo-

dynamic equilibrium,” Phys. Rev. 40, 749 (1932).

58. J. Ville, “Theorie et applications de la notion de
signal analytique,” Cables et Transmission 2A, 61
(1948).

59. J. W. Goodman, Introduction to Fourier Optics

(McGraw-Hill, 2nd ed. 1996).

60. A. S. Holevo, “Statistical decision theory for quan-
tum systems,” J. Multivar. Anal. 3, 337 (1973).
61. C. W. Helstrom, Quantum Detection and Estima-
tion Theory (Academic Press, New York, 1976).
62. X. Liu and K.-H. Brenner, “Reconstruction of
two-dimensional complex amplitudes from intensity
measurements,” Opt. Commun. 225, 19 (2003).
63. G. T. Herman, Image Reconstruction from Projec-

tion (Academic, New York, 1980).

64. A. C. Kak and M. Slaney, Principles of Computer-
ized Tomographic Imaging (IEEE, New York, 1988).
65. F. Natterer, The Mathematics of Computerized To-

mography (Wiley, New York, 1986).

66. T. Opatrn´y, D. G. Welsch, and W. Vogel, “Least-
squares inversion for density-matrix reconstruc-
tion,” Phys. Rev. A 56, 1788 (1997).

10

67. R. A. Fisher, “On the mathematical foundations
of theoretical statistics,” Philos. Trans. Roy. Soc.
Lond. A 222, 309 (1922).

68. R. A. Fisher, “Theory of statistical estimation,”
Proc. Cambridge Philos. Soc. 22, 700 (1925).
69. C. E. Shannon, “A mathematical theory of cummu-
nication,” Bell Syst. Techn. J. 27, 379, 623 (1948).
70. E. T. Jaynes, “Information theory and statistical
mechanics,” Phys. Rev. 106, 620, 108, 171 (1957).
71. V. Buˇzek, G. Adam, and G. Drobn´y, “Quantum
state reconstruction and detection of quantum co-
herences on diﬀerent observation levels,” Phys. Rev.
A 54, 804 (1996).

72. Z. Hradil, “Quantum-state estimation,” Phys. Rev.

A 55, R1561 (1997).

73. Z. Hradil, J. Summhammer, and H. Rauch, “Quan-
tum tomography as normalization of incompatible
observation,” Phys. Lett. A 261, 20 (1999).

74. Z. Hradil and J. Summhammer, “Quantum theory
of incompatible observations,” J. Phys. A: Math.
Gen. 33, 7607 (2000).

75. J. ˇReh´aˇcek, Z. Hradil, and M. Jeˇzek, “Iterative algo-
rithm for reconstruction of entangled states,” Phys.
Rev. A 63, 040303(R) (2001).

76. M. Jeˇzek, J. Fiur´aˇsek, and Z. Hradil, “Quantum
inference of states and processes,” Phys. Rev. A 68,
012305 (2003).

77. K. Banaszek, G. M. D’Ariano, M. G. A. Paris,
and M. F. Sacchi, “Maximum-likelihood estimation
of the density matrix,” Phys. Rev. A 61, 10304(R)
(2000).

78. V. Emiliani, F.

Intonti, M. Cazayous, D. S.
Wiersma, and M. Colocci, “Near-ﬁeld short range
correlation in optical waves transmitted through
random media,” Phys. Rev. Lett. 90, 250801 (2003).
79. S. A. Babichev, B. Brezger, and A. I. Lvovsky,
“Remote preparation of a single-mode photonic
qubit by measuring ﬁeld quadrature noise,” (2003),
arXiv:quant-ph/0308127.

