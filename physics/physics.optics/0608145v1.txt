6
0
0
2
 
g
u
A
 
4
1
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
5
4
1
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

DEUTSCHES ELEKTRONEN-SYNCHROTRON

in der HELMHOLTZ-GEMEINSCHAFT

DESY 06-127

August 2006

Fourier Optics treatment of Classical Relativistic
Electrodynamics

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and
Mikhail Yurkov
DeutschesElektronen-Synchrotron DESY,Hamburg

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

Fourier Optics treatment of Classical Relativistic
Electrodynamics

Gianluca Geloni a Evgeni Saldin a Evgeni Schneidmiller a
Mikhail Yurkov a

aDeutsches Elektronen-Synchrotron (DESY), Hamburg, Germany

Abstract

In this paper we couple Synchrotron Radiation (SR) theory with a branch of phys-
ical optics, namely laser beam optics. We show that the theory of laser beams is
successful in characterizing radiation ﬁelds associated with any SR source. Both
radiation beam generated by an ultra-relativistic electron in a magnetic device and
laser beam are solutions of the wave equation based on paraxial approximation.
It follows that they are similar in all aspects. In the space-frequency domain SR
beams appear as laser beams whose transverse extents are large compared with
the wavelength. In practical situations (e.g. undulator, bending magnet sources),
radiation beams exhibit a virtual ”waist” where the wavefront is often plane. Re-
markably, the ﬁeld distribution of a SR beam across the waist turns out to be strictly
related with the inverse Fourier transform of the far-ﬁeld angle distribution. Then,
we take advantage of standard Fourier Optics techniques and apply the Fresnel
propagation formula to characterize the SR beam. Altogether, we show that it is pos-
sible to reconstruct the near-ﬁeld distribution of the SR beam outside the magnetic
setup from the knowledge of the far-ﬁeld pattern. The general theory of SR in the
near-zone developed in this paper is illustrated for the special cases of undulator
radiation, edge radiation and transition undulator radiation. Using known ana-
lytical formulas for the far-ﬁeld pattern and its inverse Fourier transform we ﬁnd
analytical expressions for near-ﬁeld distributions in terms of far-ﬁeld distributions.
Finally, we compare these expressions with incorrect or incomplete literature.

Key words:
Synchrotron Radiation, near ﬁeld, laser beam optics, Edge Radiation, Transition
Undulator Radiation
PACS: 41.60.Ap, 41.60.-m, 41.20.-q

PreprintsubmittedtoElsevierScience

2February2008

1

Introduction

In a series of previous works [1, 2, 3] we developed a formalism which, we
believe, is ideally suited for analysis of any Synchrotron Radiation problem.
In particular, in [3] we took advantage of Fourier Optics ideas. Fourier Optics
(see e.g. [4]) provides an extremely successful approach which revolution-
ized the treatment of wave optics problems and, in particular, laser beam
optics problems. It deals with paraxial ﬁelds, propagating along a chosen
direction (say the longitudinal z-axis) and directions close to it. In any given
plane transverse to the z-axis, the ﬁeld is represented in the space-frequency
domain by a complex scalar function. Alternatively, one may deal with a
iωt], ω being the frequency and t
monochromatic signal oscillating as exp[
being the time. Then, one can represent the slowly varying 1 ﬁeld envelope
, z). Here z is the longitudinal position
with a complex scalar function
of the observer, and ~r
is a two-dimensional vector identifying transverse
e
⊥
E(~r
coordinates (x, y) of the observer.
, z) represents an electric ﬁeld am-
⊥
plitude polarized everywhere in the same, ﬁxed direction. The eﬀects of
free-space propagation are mathematically represented by the Fresnel for-
mula. Elementary systems, such as lenses and ﬁlters placed along the z axis
are introduced as complex scalar-amplitude transmission functions T(~r
),
⊥
which yield the output ﬁeld after multiplication with an input ﬁeld. More
complex systems are realized by stacking free-space sections and amplitude
transmission functions in series.

E(~r
⊥

e

−

The use of Fourier Optics led us in a natural way to establish, in this work,
basic foundations for the treatment of SR ﬁelds in terms of laser beam optics.
In particular, radiation from an ultra-relativistic particle can be interpreted
as radiation from a virtual source, which produces a laser-like beam. The
virtual source itself is the waist of the laser-like beam, and often exhibits
a plane wavefront. In this case it is completely speciﬁed, for any given
polarization component, by a real-valued amplitude distribution of the ﬁeld.
As we will see, the laser-like representation of SR is intimately connected
with the ultra-relativistic nature of the electron beam. In particular, paraxial
approximation always applies. Then, free space basically acts as a spatial
Fourier transformation. This means that the ﬁeld in the far zone is, aside
for a phase factor, the Fourier transform of the ﬁeld at any position z down
the beamline. It is also, aside for a phase factor, the Fourier transform of
the virtual source. Once the ﬁeld at the virtual source is known, the ﬁeld
at other longitudinal positions, both in the far and in the near zone up to
distances to the sources comparable with the radiation wavelength, can be
obtained with the help of the Fresnel propagation formula. This is equivalent
to state that the near-zone ﬁeld can be calculated from the knowledge of the

1 With respect to the wavelength λ = 2πc/ω.

3

far-zone ﬁeld, i.e. from the acceleration term of the Lienard-Wiechert ﬁeld
only. This is possible due to the paraxial approximation. On the one hand,
as said above, the Fresnel formula can be used to recover the ﬁeld up to
longitudinal positions which are a wavelength far away from the sources.
On the other hand, due to the paraxial approximation, the wavelength of
interest in SR emission is very short compared with the radiation formation
length and with the linear dimensions of the magnetic setup. In this view, it
is incorrect to consider the far-zone ﬁeld as an asymptotic expression only:
its knowledge completely speciﬁes, through the Fresnel integral, the near-
zone ﬁeld as well. In the case when the electron generating the ﬁeld is not
ultra-relativistic, though, the paraxial approximation cannot be applied. As a
result, the radiation wavelength is comparable with the radiation formation
length. It is then impossible to reconstruct the near-ﬁeld distribution from
the knowledge of the far-ﬁeld pattern 2 .

In this work we consider a SR source composed of an arbitrary number of
magnetic devices under the standard ultra-relativistic approximation. We
show that every such magnetic setup is equivalent to several virtual sources
and can be modelled as a sequence of appropriately chosen plane sources
inserted between the edges of each magnetic structure. This equivalence
provides conceptual insight regarding SR sources and should facilitate their
design and analysis. In fact, great simpliﬁcations in the solution for the prob-
lem of propagation of radiation through a beamline result after adopting
our viewpoint. Since the analysis of SR sources can be reduced to that of
laser-like sources, it follows that any result, method of analysis or design
and any algorithm speciﬁcally developed for laser beam optics (e.g. the code
ZEMAX [5]) are also applicable to SR sources.

To give an example of the applicability of our method we ﬁrst consider the
case of undulator radiation. We work within the applicability region of the
resonance approximation. This means that we consider an undulator with
a large number Nw of periods, i.e. Nw ≫
1, and that we are interested in fre-
quencies near the fundamental. We ﬁnd the ﬁeld distribution of the virtual
source with the help of the far-zone ﬁeld distribution and we propagate to
any distance of interest.

Subsequently, we treat the relatively simple case of edge radiation, studying
the emission from a setup composed by a straight section and two bending
magnets, upstream and downstream of the straight section. Bright, long-
wavelength edge radiation is expected to be emitted by such setup for λ

≫

2 Our arguments hold in the case near zone and formation zone coincide. For
example, this is the case for bending magnet radiation. However, depending on the
parameter choice, this may not be the case for complex magnetic setups. We will
treat this subject in a more extensive way in Section 3

4

λc, λc being the critical wavelength of SR produced by bending magnets.
In particular, we derived an expression for the ﬁeld from a straight section
that is valid at arbitrary observation position. This result is fundamental
importance because, due to the superposition principle, our expression may
be used as building block for more complicated setups. We begin calculating
an analytical expression for the edge radiation (see, among others, [6, 7, 8,
9, 10, 11, 12, 13]) from a single electron in the far zone. Then, through
the virtual-source technique we ﬁnd novel results in the near zone. Two
alternative description of the ﬁeld propagation are given, based on a single
virtual source located in the middle of the edge-radiation setup and based
on two virtual sources located at the edges of the setup.

With the help of the knowledge of the edge-radiation case, we turn to analyze
a more complicated setup consisting of an undulator preceded and followed
by two straight sections and two (upstream and downstream) bending mag-
nets. We restrict ourselves to the long-wavelength region. Edge radiation
from this kind of setup is commonly known as Transition Undulator Radi-
ation (TUR). The ﬁrst study on TUR appeared more than a decade ago [14].
In that work it was pointed out for the ﬁrst time that, since an electron en-
tering or leaving an undulator experiences a sudden change in longitudinal
velocity, radiation with broadband spectral features, similar to transition
radiation, had to be expected in the low-frequency region in addition to
the usual undulator radiation. That paper constituted a theoretical basis for
many other studies, developed in the years that followed. We remind here a
few [8, 15, 16, 17, 18], dealing both with theoretical and experimental issues.
More recently, TUR has been given consideration in the framework of large
X-Ray Free Electron Laser (XFEL) projects. For example, a characterization
of Coherent Transition Radiation from the LCLS undulator has been given
in [19]. A method to obtain intense infrared/visible light pulses naturally
synchronized to x-ray pulses from the LCLS XFEL by means of Coherent
TUR has been proposed in [20], that should be used for pump-probe exper-
iments in the femtosecond scale resolution. In view of these applications,
there is a need to extend the knowledge of TUR to the near zone and to the
coherent case 3 .

Speciﬁcation of what precedes and follows the undulator is of fundamental
importance. As has been recognized in particular for TUR many years ago
[8], it does make sense to discuss about the intensity distribution of TUR
only when a detailed knowledge is given, of what precedes and follows
the undulator in a speciﬁc setup. According to our novel approach, the two
straight sections and the undulator will be associated to virtual sources with
plane wavefronts. The ﬁeld from the setup can then be described, in the near

3 In this paper we limit our analysis to the single-particle case, leaving the study
of coherent radiation for the future

5

as well as in the far ﬁeld, as a superposition of laser-like beams, radiating at
the same wavelength and separated by diﬀerent phase shifts.

Our work is organized as follows. In Section 2 we discuss our method
in full generality. In fact, the analogy with laser beams can be extended
to include SR from setups not discussed in this paper. In the following
Section 3 we discuss our method in more detail and we focus on particular
issues like the importance of the paraxial approximation, the accuracy of
our calculations and a easily misleading relationship between velocity and
radiation ﬁeld. In Section 4 we apply our algorithm to the case of usual
undulator radiation. Section 5 is dedicated to the study of the simplest edge
radiation setup, composed of a straight section and two bending magnets.
An undulator is then added to the setup in Section 6, where radiation is
given as a superposition of laser-like beam from diﬀerent virtual sources.
Our ﬁndings are compared with results in literature in Section 7. Finally, in
Section 8, we come to conclusions.

2 Method for obtaining the electromagnetic ﬁeld generated by an ultra-

relativistic electron

In the present Section 2 we discuss our method in all generality. In the next
paragraphs 2.1 and 2.2 we show that radiation from an ultra-relativistic
particle can be represented as a laser-like beam with a given virtual source.
Our algorithm is based on two separately well-known expressions, the Fres-
nel propagation formula and a far-ﬁeld presentation of the electromagnetic
ﬁeld.

2.1

Inverse problem with far-ﬁeld data

We represent the electric ﬁeld in time domain ~E(~r, t) as a time-dependent
+ z~z = x~x + y~y + z~z,
function of an observation point located at position ~r = ~r
⊥
where ~x, ~y and ~z are deﬁned as (adimensional) unit vectors along horizontal,
vertical and longitudinal direction. The ﬁeld ~E(~r, t) satisﬁes, in free space,
the source-free wave equation:

2

"∇

−

1
c2

∂2
∂t2 #

~E = 0 .

(1)

Here c indicates the speed of light in vacuum. For monochromatic waves of
angular frequency ω, the wave amplitude has the form

6

(2)

(3)

(4)

(5)

~E

(z, ~r
⊥

⊥

, t) = ~¯E

(z, ~r
⊥

⊥

) exp [

iωt] + C.C. ,

−

where ”C.C.” indicates the complex conjugate of the preceding term and
~¯E
actually
represents the amplitude of the electric ﬁeld in the space-frequency domain.

describes the variation of the wave amplitude. The vector ~¯E

⊥

⊥

We assume that the ultra-relativistic approximation is satisﬁed, that is al-
ways the case for SR setups. In this case paraxial approximation applies [1].
Paraxial approximation implies a slowly varying envelope of the ﬁeld with
respect to the wavelength. It is therefore convenient to introduce the slowly
varying envelope of the transverse ﬁeld components as

where the propagation constant ω/c is related to the wavelength λ by ω/c =
2π/λ. In paraxial approximation and in free space, the following parabolic
E of the Fourier transform of the
equation holds for the complex envelope
electric ﬁeld along a ﬁxed polarization component:

e

= ~¯E

⊥

exp [

iωz/c] ,

−

~
E

⊥
e

2 +

2iω
c

∂
∂z!

 ∇⊥

= 0 .

E

⊥
e

2 are taken with respect to
The derivatives in the Laplacian operator
the transverse coordinates. One has to solve Eq. (4) with a given initial
condition at z, which deﬁnes a Cauchy problem. Note that Eq. (4) is similar
to the time-dependent Schroedinger equation. We obtain

∇⊥

(zo, ~ro
⊥

) =

E

⊥
e

iω
2πc(zo −

d~r′

⊥

(z, ~r′

⊥

z) Z

E

⊥
e

2

~ro
iω
⊥ −
(cid:12)(cid:12)(cid:12)
2c(zo −

~r′
⊥(cid:12)(cid:12)(cid:12)
z)

,





) exp 


where the integral is performed over the transverse plane. It is important to
note that since ˜E is a slowly-varying function with respect to the wavelength,
within the accuracy of the paraxial approximation one cannot resolve the
evolution of the ﬁeld on a longitudinal scale of order of the wavelength. In
order to do so, the paraxial equation Eq. (4) should be replaced by a more
general Helmholtz equation.

Next to the propagation equation for the ﬁeld in free space, Eq. (5), we can
discuss a propagation equation for the spatial Fourier transform of the ﬁeld,
which can also be derived from Eq. (4) and will be useful later on. We will

7

indicate the spatial Fourier transform of

E

(z, ~r′

⊥

) with F(z, ~u) 4 :

F

z, ~u
(cid:1)

(cid:0)

=

Z

d~r′

⊥

E

⊥
e

(z, ~r′

) exp

i~r′

⊥

⊥ ·

h

Eq. (4) can be rewritten in terms of F as

⊥
e
~u
i

.

2 +

2iω
c

∂
∂z! (Z

 ∇⊥

d~u F

z, ~u
(cid:1)

(cid:0)

exp

i~r

−

⊥ ·

~u

(cid:2)

)

(cid:3)

= 0 .

Eq. (7) requires that

 −

2 +
~u
(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

2iω
c

∂
∂z !

F

= 0 .

z, ~u
(cid:1)

(cid:0)

Solution of Eq. (8) can be presented as

F

z, ~u
(cid:1)

(cid:0)

= F

exp

0, ~u
(cid:1)

(cid:0)

ic

2z
~u
|
|
2ω #

.

"−

(6)

(7)

(8)

(9)

It should be noted that the deﬁnition of F(0, ~u) is a matter of initial conditions.
In many practical cases, including the totality of the situation treated in this
paper, F (or ˜E) may have no direct physical meaning at z = 0. For instance,
in all cases considered in this paper, z = 0 is within the magnetic setup.
However, F(0, ~u) can be considered as the spatial Fourier transform of the
ﬁeld produced by a virtual source. Such a source is deﬁned by the fact

4 For the sake of completeness we explicitly write the deﬁnitions of the two-
dimensional Fourier transform and inverse transform of a function g(~r) in agree-
ment with the notations used in this paper. The Fourier transform and inverse
transform pair reads:

˜g(~k) =

Z

d~r g(~r) exp

i~r

; g(~r) =

~k
i

·

h

1
4π2 Z

d~k ˜g(~k) exp

i~r

,

~k
i

·

−

h

the integration being understood over the entire plane. If g is circular symmetric
we can introduce the Fourier-Bessel transform and inverse transform pair:

˜g(k) = 2π

dr rg(r)Jo(kr) ; g(r) =

dk k ˜g(k)Jo(kr) ,

∞

Z
0

r and k indicating the modulus of the vectors ~r and ~k respectively, and Jo being the
zero-th order Bessel function of the ﬁrst kind.

1
2π

∞

Z
0

8

that, supposedly placed at z = 0, it would produce, at any distance from
the magnetic system under study, the same ﬁeld as the real source does.
The result in Eq. (9) is very general. On the one hand, the spatial Fourier
transform of the electric ﬁeld exhibits an almost trivial behavior in z, since
2 = const. On the other hand, the behavior of the electric ﬁeld itself
F(z)
|
|
is not trivial at all. These properties directly follow from the propagation
equation for the ﬁeld and its Fourier transform.

Let us discuss the physical meaning of Eq. (9). The spatial Fourier transform
of the ﬁeld, F(z, ~u), may be interpreted as a superposition of plane waves (the
so-called angular spectrum). Once the frequency ω is ﬁxed, the wave number
k = ω/c is ﬁxed as well, and a given value of the transverse component
of the wave vector ~k
= ~u corresponds to a given angle of propagation
⊥
of a plane wave. Diﬀerent propagation directions correspond to diﬀerent
distances travelled to get to a certain observation point. Therefore, they also
correspond to diﬀerent phase shifts, which depend on the position along the
z axis (see, for example, reference [4] Section 3.7). Free space basically acts as
a Fourier transformation. This means that the ﬁeld in the far zone is, phase
factor and proportionality factor aside, the spatial Fourier transform of the
ﬁeld at any position z. We now demonstrate this fact. This proof will directly
result in an operative method to calculate the ﬁeld at the virtual source, once
the far ﬁeld is known. We ﬁrst recall that if we know the ﬁeld at a given
position (z, ~r′
) we may use Eq. (5) to calculate the ﬁeld at another position
(zo, ~ro
, with ﬁnite ratio ~ro
/zo. In
⊥
⊥
this case, the exponential function in Eq. (5) can be expanded giving

) . Let us now consider the limit zo −→ ∞

⊥

E

⊥
e

E

⊥
e

E

⊥
e

(zo, ~ro
⊥

) =

iω
2πczo Z

d~r′

E

(z, ~r′

)

⊥

⊥

⊥
e
2
~ro
⊥|

iω
2czo  |

"

exp

×

2~ro

−

⊥ ·

+

~r′

⊥

2
~ro
z
⊥|
|
zo

.

!#

Letting ~θ = ~ro
⊥

/zo we have

(~θ) =

iω
2πczo

exp

~θ
2
iω
|
|
2c

F

z,

−

(zo + z)







.

ω~θ
c 


With the help of Eq. (9), Eq. (11) may be presented as









(~θ) =

iω
2πczo

exp

~θ
2
iω
|
|
2c

0,

−

zo
F






.

ω~θ
c 


9

(10)

(11)

(12)

Eq. (12) shows what we wanted to demonstrate: free space basically acts as
a Fourier transformation. Also, from Eq. (12) one directly obtains

E

⊥
e

E

⊥
e

(0, ~r
⊥

) =

iωzo
2πc Z

d~θ exp

~θ
2
iω
|
|
2c

(~θ) exp

iω
c

~r
⊥ ·

(cid:20)

,

~θ
(cid:21)

(13)


−



zo
E


⊥
e

where the transverse vector ~r
deﬁnes a transverse position on the virtual
⊥
source plane at z = 0. Eq. (13) allows to calculate the ﬁeld at the virtual
source once the ﬁeld in the far zone is known. Identiﬁcation of the position
z = 0 with the virtual source position is always possible, but not always
convenient (although often it is). In general, if the virtual source is at position
z = zs, one obtains, from Eq. (11) that Eq. (13) should be modiﬁed to

(zs, ~r
⊥

) =

iωzo
2πc Z

d~θ exp

~θ
2
iω
|
|
2c


−



(zo + zs)
E



⊥
e

(~θ) exp

iω
c

~r
⊥ ·

(cid:20)

.

~θ
(cid:21)

(14)

2.2

Far-ﬁeld pattern calculations

All is left to do in order to solve the propagation problem in paraxial ap-
proximation is to calculate the ﬁeld in the far zone. We indicate the electron
velocity in units of c with ~β(t′), the Lorentz factor (that will be considered
ﬁxed throughout this paper) with γ, the (negative) charge of the electron
e) and the electron trajectory as ~r′(t′). Finally, the direction from the
with (
retarded position of the electron to the observer is ﬁxed by the unit vector
~n,

−

~n =

~ro −
~ro −
|

~r′(t′)
~r′(t′)
|

.

(15)

(16)

Condition ~n = constant deﬁnes the far-ﬁeld zone. In this zone, a widely-used
result presented in textbooks (see [21]) holds:

~¯E(~ro, ω) =

iωe
cro

−

exp

iω
c

(cid:20)

~n

~ro

·

dt′ ~n

(~n

×

×

~β) exp

iω
(cid:20)

t′
(cid:18)

−

1
c

~n

·

~r′

.

(cid:19)(cid:21)

∞

Z
(cid:21)
−∞

The transverse components of the envelope of the ﬁeld in Eq. (16) can be
written as (see [1])

10

(zo, ~r
⊥

o, ω) =

~
E

⊥
e

∞

iωe
c2zo

−

Z
−∞
x′(z′)
xo −
zo

−

dz′exp [iΦT]

vx(z′)
c

" 

~x +

!

vy(z′)

 

c −

y′(z′)
yo −
zo

,

~y

#

!

where the total phase ΦT is

ΦT = ω

s(z′)

"

v −

z′
c #

+ ω

1
zo

 

+

z′
z2
o !

[xo −

x′(z′)]2 +
2c

(cid:2)

yo −

2

y′(z′)
(cid:3)

.

(17)

(18)

Eq. (17) can be obtained starting directly with Maxwell’s equations in the
space-frequency domain. Textbooks (see for example [21]) usually follow a
not so direct derivation. They start with the solution of Maxwell’s equation
in the space-time domain, the well-known Lienard-Wiechert expression,
and they subsequently apply a Fourier transformation. Eq. (17) is automat-
ically subject to the paraxial approximation. Here vx(z′) and vy(z′) are the
horizontal and the vertical components of the transverse velocity of the elec-
tron, while x′(z′) and y′(z′) specify the transverse position of the electron as
a function of the longitudinal position. Finally, we deﬁne the curvilinear
abscissa s(z′) = vt′(z′), v being the modulus of the velocity of the electron.

Eq. (17) can be used to characterize the far ﬁeld from an electron moving
on any trajectory as long as the ultra-relativistic approximation is satisﬁed.
Then, once the far ﬁeld is known, Eq. (13) (or Eq. (14)) can be used to
calculate the ﬁeld distribution at the virtual source. Finally, Eq. (5) solves
the propagation problem at any observation position zo. Note that part of
2 in Eq. (13). If Eq.
the phase in Eq. (18) compensates with the phase in
|
(17) describes a ﬁeld with a spherical wavefront with center at z = 0, such
compensation is complete. The centrum of the spherical wavefront is a
privileged point, and the plane at z = 0 exhibits a plane wavefront. This
explains why the point z = 0 is often privileged with respect to others.

~θ
|

Let us conclude this Section with a short summary. We considered the
electric ﬁeld represented in the space-frequency domain. Since the system
is ultra-relativistic, paraxial approximation applies. We saw that within the
applicability region of the paraxial approximation, all information about
the ﬁeld, both in the near and in the far zone, is encoded in the far zone
ﬁeld alone. An explicit expression for the near ﬁeld can in fact be recovered
with the help of the paraxial Green’s function for Maxwell’s equation. Such
Green’s function is the same Green’s function considered in Fourier Optics.
This consideration allows to describe simple ultra-relativistic systems like,
for instance, an electron moving through a bending magnet, an undulator or
a straight section in terms of laser-like beams. Each beam has a virtual source,

11

which often exhibits a plane wavefront and is completely speciﬁed, for any
given polarization component, by a real-valued amplitude distribution for
the ﬁeld. Note that the square modulus of such distribution can be physically
associated with an intensity, and can be detected as the image of a properly
placed, ideal converging lens. The Fourier transform of such distribution
instead is linked to the electric ﬁeld in the far zone. Then, once the electric
ﬁeld in the far zone is calculated, a virtual source for the laser-like beam can
be speciﬁed. Once the ﬁeld at the virtual source is known, the ﬁeld at any
position can be found by applying usual propagation equations based on
Fourier Optics.

3 Discussion

In the present Section 3 we discuss the algorithm proposed in Section 2.
First we present a thorough derivation of Eq. (17) based on paraxial Green’s
function techniques. Then we discuss the region of applicability and the
accuracy of this derivation. Finally, we deal with some delicate question
related to the nature of the so-called ”velocity ﬁeld”.

3.1 A derivation of the electric ﬁeld based on paraxial Green’s function

Eq. (17) is an expression that can be used to characterize the far ﬁeld from
of an electron moving on any trajectory in paraxial approximation. For the
sake of completeness we present, here, a derivation of Eq. (17) based on [1].

Accounting for electromagnetic sources, i.e. in a region of space where
current and charge densities are present, the following equation for the
ﬁeld in the space-frequency domain holds in all generality:

c2

2~¯E + ω2~¯E = 4πc2~
∇

¯ρ

∇

−

4πiω~¯j ,

where ¯ρ(~r, ω) and ~¯j(~r, ω) are the Fourier transforms of the charge density
ρ(~r, t) and of the current density ~j(~r, t). Eq. (19) is the well-known Helmholtz
equation, that has elliptic characteristic. With the help of Eq. (3), Eq. (19) can
be written as

c2 exp [iωz/c]

2 +

 ∇

2iω
c

∂
∂z !

~
E = 4πc2~
∇

¯ρ

−

4πiω~¯j .

A system of electromagnetic sources in the space-time can be conveniently

(19)

(20)

e

12

(21)

(22)

described by ρ(~r, t) and ~j(~r, t). In this paper we will be concerned about a
single electron. Using the Dirac delta distribution, we can write, following
[1]

ρ(~r, t) =

eδ(~r

~r′(t)) =

−

−

e
vz(z)

−

δ(~r

⊥ −

~r′

⊥

(z))δ

s(z)
v −

 

t
!

and

and

~j(~r, t) =

e~v(t)δ(~r

~r′(t)) =

−

−

e
vz(z)

−

~v(z)δ(~r

~r′

⊥

(z))δ

⊥ −

s(z)
v −

 

,

t
!

where ~r′(t) and ~v(t) are, respectively, the position and the velocity of the
particle at a given time t in a ﬁxed reference frame, and vz is the longitudinal
velocity of the electron.

In the space-frequency domain, Eq. (21) and Eq. (22) transform to:

¯ρ( ~r
⊥

, z, ω) =

e
vz(z)

δ

−

~r
⊥ −
(cid:16)

~r′
⊥

(z)
(cid:17)

exp [iωs(z)/v]

(23)

~¯j( ~r

⊥

, z, ω) =

e
vz(z)

−

~v(z)δ

~r
⊥ −
(cid:16)

~r′
⊥

(z)
(cid:17)

exp [iωs(z)/v] .

(24)

By substitution in Eq. (20) we obtain

2 +

 ∇

2iω
c

∂
∂z !

~
E =

exp

4πe
vz(z)
(
iω
c2 ~v(z)δ

× (cid:20)

z
c !)

s(z)
v −
~r′
⊥

(z)
(cid:17)

iω

 

~r
⊥ −
(cid:16)

e

δ

~
∇

−

~r
⊥ −
(cid:16)

(z)

~r′
⊥

.

(cid:17)(cid:21)

(25)

Eq. (25) is still fully general and may be solved in any ﬁxed reference system
(x, y, z) of choice with the help of an appropriate Green’s function.

z ≫

When the longitudinal velocity of the electron, vz, is close to the speed of light
c (i.e. γ2
1), the Fourier components of the source are almost synchronized
with the electromagnetic wave travelling at the speed of light. In this case
the phase ω(s(z)/v
z/c) is a slow function of z compared to the wavelength.
For example, in the particular case of motion on a straight section, one has
z/c) = ωz/(2γ2
s(z) = z/vz, so that ω(s(z)/v
1 such phase

zc), and if γ2

−

z ≫

−

13

grows slowly in z with respect to the wavelength. For a more generic motion,
one has

s(z2)

s(z1)

ω

 

−
v

z1

z2 −
c

=

!

−

d¯z

ω
2γ2
z(¯z)c

.

z2

Z
z1

(26)

−

Mathematically, the phase in Eq. (26) enters in the Green’s function solution
of Eq. (25) as a factor in the integrand. As we integrate along z′, the factor
ω(s(z′)/v
z′/c) leads to an oscillatory behavior of the integrand over a
certain integration range in z′. Such range can be identiﬁed with the value
z1 for which the right hand side of Eq. (26) is of order unity, and it
of z2 −
is naturally deﬁned as the radiation formation length L f of the system at
frequency ω. It is easy to see by inspection of Eq. (26) that if v is sensibly
smaller than c (but still of order c), i.e. v
1, then L f ∼
λ. On
the contrary, when v is very close to c, i.e. 1/γ2
1, the right hand side of
Eq. (26) is of order unity for L f = z2 −
λ. When the radiation formation
~
E does not vary much along z
length is much longer than the wavelength,
ω/c
Ex,y |
Ex,y |≪
on the scale of λ, that is
. Therefore, the second order
e
2 operator on the left hand side of Eq.
derivative with respect to z in the
e
e
(25) is negligible with respect to the ﬁrst order derivative. Eq. (25) can then
be simpliﬁed to

∼
z1 ≫

c but 1/γ2

z ≪

z ∼

∂z

∇

|

|

2 +

2iω
c

∂
∂z!

 ∇⊥

=

4πe
c

~
E

⊥
e

exp

iω

(

iω
c2 ~v

⊥

(z)δ

× (cid:20)

s(z)
v −

 

z
c !)

~r
⊥ −
(cid:16)

~r′

⊥

(z)
(cid:17)

δ

~
∇⊥

−

~r
⊥ −
(cid:16)

~r′

⊥

(z)

,

(cid:17)(cid:21)

(27)

e

~
E only and we substituted vz(z)
where we consider transverse components of
with c, having used the fact that 1/γ2
1. Eq. (27) is Maxwell’s equation in
z ≪
paraxial approximation. In this way we transformed Eq. (25), which is an
elliptic partial diﬀerential equation, into Eq. (27), that is of parabolic type.
Note that the applicability of the paraxial approximation depends on the
ultra-relativistic assumption γ2
1 but not on the choice of the z axis. In
fact, if the longitudinal z direction is chosen in such a way that γ2
1,
than the formation length is very short L f ∼
λ, and the radiated ﬁeld is
practically zero. As a result, Eq. (27) can always be applied, i.e. the paraxial
approximation can always be applied, whenever γ2
1. Formally, this
statement is in contradiction with the approximation 1/γ2
1, explicitly
declared to obtain Maxwell’s equation in paraxial approximation, i.e. Eq.
(27). However, suppose that one is using a detector not accurate enough
to distinguish, on an axis where γ2
1, between solution of Maxwell’s

z ≪

z ∼

≫

≫

z ≫

14

z ∼

equation with paraxial approximation and solution without it. Let us ﬁx any
observation wavelength of interest λ. Then, with the accuracy of the paraxial
approximation, one would detect no photon ﬂux along an axis where γ2
1.
Thus, from a practical viewpoint, the paraxial approximation can always be
applied independently of γz. When it is not formally applicable, the error
resulting from its application cannot be resolved by our detector, within
the accuracy of the paraxial approximation, because we are working with
ultra-relativistic particles, and radiation is highly collimated. In this regard,
it should be remarked here that the status of the paraxial equation Eq.
(27) in Synchrotron Radiation theory is diﬀerent from that of the paraxial
equation in Physical Optics. In the latter case, the paraxial approximation
is satisﬁed only by small observation angles. For example, one may think
of a setup where a thermal source is studied by an observer positioned
at a long distance from the source and behind a limiting aperture. Only if
a small-angle acceptance is considered the paraxial approximation can be
applied. On the contrary, due to the ultra-relativistic nature of the electrons
that generate radiation, Synchrotron Radiation is highly collimated. As a
result the paraxial equation can always be applied in practice, because it
practically returns zero ﬁeld at angles where it should not be applied.

The Green’s function for Eq. (27), namely the solution corresponding to the
unit point source, satisﬁes the equation

2 +

2iω
c

∂
∂z!

 ∇⊥

G(zo −

z; ~r
⊥

o −

~r
⊥

) = δ( ~r
⊥

o −

~r
⊥

)δ(zo −

z) ,

and, in an unbounded region, can be explicitly written as

G(zo −

z′; ~r
⊥

⊥

~r′

) =

o −

1
4π(zo −
z′ > 0. When zo −

−

exp

iω|

(

z′)

~r′
~r
o −
⊥
2c(zo −

2
⊥ |
z′) )

,

z′ < 0 the paraxial approximation does
assuming zo −
not hold, and the paraxial wave equation Eq. (27) should be substituted,
in the space-frequency domain, by the more general Helmholtz equation.
However, the radiation formation length for zo −
z′ < 0 is very short with
z′ > 0, i.e. there is no radiation for observer positions
respect to the case zo −
z′ > 0. It
zo −
follows that the observer is located downstream of the sources.

z′ < 0. As a result, in this paper we will consider only zo −

(28)

(29)

This leads to the solution

(zo, ~r
⊥

o, ω) =

~
E

⊥
e

∞

dz′

e
c

−

Z
−∞

1
zo −

d~r′

⊥

z′ Z

15

(30)

(31)

(32)

iω
c2 ~v

⊥

× (cid:20)

(z′)δ

exp

iω

(

|

"

×

~r′
~r′
⊥ −
(cid:16)
~r′
~r
o −
⊥
2c(zo −

⊥
2
⊥ |
z′)

(z′)
(cid:17)

+

δ

⊥

~
∇′
−
s(z′)

 

v −

⊥ −

~r′
(cid:16)
z′
c !#)

,

~r′

⊥

(z′)

(cid:17)(cid:21)

where ~
represents the gradient operator with respect to the source point.
∇′
The integration over transverse coordinates can be carried out leading to
the ﬁnal result:

⊥

(zo, ~r
⊥

o, ω) =

~
E

⊥
e

vx(z′)
c

" 

iωe
c2

−

Z
−∞
xo −
zo −

−

∞

dz′

x′(z′)
z′

!

z′

exp [iΦT]
zo −
~x +

vy(z′)

 

c −

yo −
zo −

y′(z′)
z′

,

~y

#

!

where the total phase ΦT is given by

ΦT = ω

s(z′)

"

v −

z′
c #

+ ω

(xo −

x′(z′))2 +
2c(zo −
(cid:0)

2

yo −
z′)

y′(z′)
(cid:1)

.









As we will see in Section 3.2, Eq. (31) is valid at any observation position zo
such that the paraxial approximation is valid, i.e. up to distances between
the observer and the electromagnetic sources comparable with the radiation
wavelength. In the far zone Eq. (31) reduces to Eq. (17).

3.2

Exact solution of Helmholtz equation

Up to now we presented an algorithm based on the paraxial approximation.
It makes sense to ask what is the range of observer positions where the
paraxial approximation applies, and what is the accuracy of our result in
this range. We will demonstrate that paraxial approximation holds with
good accuracy up to positions of the observer such that its distance from the
electromagnetic sources in the space-frequency domain, denoted with d, is
of order of λ.

In order to investigate the accuracy of our ﬁndings we have to compare
results from the paraxial treatment with results obtained within a more
general framework without the help of the paraxial approximation. There-
fore we go back to the most general Eq. (19), that can be solved by direct
application of the Green’s function for the Helmholtz equation

16

G(~ro −

~r′) =

−

4π

exp

i

ω
c |

(cid:26)

~ro −

~r′ |(cid:27)

,

1
~ro −
(cid:12)(cid:12)(cid:12)

~r′

(cid:12)(cid:12)(cid:12)

that automatically includes the Sommerfeld radiation condition

~ro −
|

~r′|  

∂G
∂~n −

i

cG
ω ! −→

0

as

~ro −
|

~r′| −→ ∞

.

Integrating by parts the term in ~
∇

¯ρ we have

¯ρ~n

− Z

~¯E =

¯ρ~n
~ro −
(cid:12)(cid:12)(cid:12)
Use of explicit expressions for ¯ρ, i.e. Eq. (23), and for ~¯j, i.e. Eq. (24), leads
straightforwardly to the following expression for the ﬁeld envelope:

iω
~ro −
(cid:12)(cid:12)(cid:12)

d~r′ 


~r′ |(cid:27)

~ro −

ω
c |

(35)

exp





2 

~r′

~r′

−

+

(cid:26)

(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)



c

i

.

~¯j
c


~
E(~ro, ω) =

iωe
c

−

e

∞

dz′

Z
−∞

1
vz(z′) 


s(z′)

exp

iω

×

(

" 

v −

−

~β
~n
−
~r′(z′)
~ro −
|
|
~ro −
z′
+
|
c !

 

ic
ω

~ro −
|
~r′(z′)
|
c

−

~n
2 
~r′(z′)
|
z′
zo −
c



.

!#)

It should be emphasized that in usual Physical Optics cases one is interested
in solving Maxwell’s equations with particular boundary conditions. Typi-
cally, boundary conditions are artiﬁcial and not consistent with Maxwell’s
equation. Thus, it is not possible to control approximations applied. On the
contrary, in our case, Eq. (36) is an exact solution of Maxwell’s equations
with boundary conditions at inﬁnity. In this case the scalar Green’s function
in Eq. (33) can be used without introducing any extra assumption. These
situations are completely diﬀerent. The exactness of the solution in Eq. (36)
allows us to control the overall accuracy of the paraxial approximation
by comparing results from Eq. (31) with results from the exact solution of
Maxwell’s equations, Eq. (36). We can present here a conservative estimate.
Let us pose

Ż =

λ
2π

.

When d & L f this accuracy can be estimated to amount to Ż/L f , but quickly
Ż remaining, at least, of order of Ż/d. The words
decreases as L f ≫
”at least” emphasize the before-mentioned fact that this is a conservative
estimate.

≫

d

17

(33)

(34)

(36)

(37)

The most general conclusion that can be drawn from Eq. (36) is that, in-
dependently of any approximation, the use of the space-frequency domain
automatically presents a very natural scale, the wavelength λ. As it can be
~r′(z′)
2 can
veriﬁed by inspecting Eq. (36), the integrand term scaling as
−
|
λ. This is to be taken as a suﬃcient condition,
be dropped whenever d
but not necessary in general. Dropping this term is automatically enforced
when the paraxial approximation is applied, but it is not suﬃcient for the
paraxial approximation to hold. In order for the paraxial approximation to
hold, as seen before, the system must be ultra-relativistic.

~ro −
|

≫

While the present discussion about Helmholtz equation is important to
understand the region of applicability of Eq. (31) we should stress the fact
that the inverse ﬁeld problem, which relies on far-ﬁeld data only, cannot
be solved without application of the paraxial approximation. In fact, let us
suppose that the paraxial approximation was not applicable. Then, instead
of Eq. (4) we should solve the homogeneous Helmholtz equation

c2

2~¯E + ω2~¯E = 0 .

∇

(38)

(39)

Boundary conditions are now constituted by the knowledge of the ﬁeld on
a open surface (for example, a transverse plane) and additionally, Rayleigh-
Sommerfeld radiation condition (separately for all polarization compo-
nents) at inﬁnity, i.e.

~ro −
|

~r′|  

∂ ¯Ex,y
∂~n −

c ¯Ex,y
ω ! −→

i

0

as

~ro −
|

~r′| −→ ∞

.

However, this is not enough to reconstruct the ﬁeld at any position in space.
In order to do so, we would need to specify the sources. In this case though,
Eq. (35) can be directly applied. The boundary conditions speciﬁed above
allow one to solve the direct transmission problem, but not the inverse one.
However, as we have seen, if the paraxial approximation is applicable, the
inverse ﬁeld problem has unique and stable solution.

Based on this discussion we can formulate a deﬁnition of several observa-
tion zones of interest (together with their complementary zones in square
brackets).

•

•

Far zone [Near zone]. Deﬁned by d such that ~n = const. [for the near zone
read: ~n , const.] throughout the integration in Eq. (36).
Formation zone [Non-formation zone]. Deﬁned by d . L f
L f ] .
formation zone read: d

5 [for the non-

≫

5 In this region one may say that the part of the electron trajectory actively con-
tributing to the ﬁeld at the observer position is the nearest to the observer and of

18

•

•

•

zone] . Deﬁned by d such that the term in 1/R2 =

Radiation zone [Non-radiation zone] . Deﬁned by d such that the electro-
magnetic ﬁeld is disentangled [for the non-radiation zone read: entangled]
from the particle ﬁeld and can be interpreted as radiation 6 .
zone [1/R2
1/R
−
~r′(z′)
2 can be neglected [for the 1/R2
−
|
integrand of Eq. (36).
Reconstruction zone [Non-reconstruction zone]. Deﬁned by d such that
a solution of the inverse problem based on far-ﬁeld data can be given [for
the non-reconstruction zone read: cannot be given].

~ro −
|
zone read: cannot be neglected] in the

−

−

In all generality, from Eq. (36) follows that the 1/R
zone always coincides
with the reconstruction zone, because ﬁeld can be reconstructed from the
far-zone data if and only if the term containing 1/R2 in the integrand of Eq.
(36) can be neglected. This is clear because the far-zone data do not include
the term in Eq. (36). Moreover if an observer is in the 1/R
zone (or in the
reconstruction zone), it necessarily belongs to the radiation zone as well.
However we cannot prove, in general, that if an observer is in the radiation
zone, it necessarily belongs to the 1/R
zone (or to the reconstruction zone).

−

−

−

Let us now consider a slightly less general standpoint and discuss, indepen-
dently of the paraxial approximation, both non-ultra-relativistic systems 7 ,
1
such that β
(and obviously β

1, and ultra-relativistic systems such that γ2

1 and γ2
1).

≫

≃

≃

≃

In the case of non-ultra-relativistic systems the characteristic size of the
system a, the formation length L f and the radiation wavelength λ are of
the same magnitude 8 . As a result, there are only two observation zones of
Ż, incorporates far zone, non-formation
interest. The ﬁrst, such that d
zone, radiation zone, 1/R
zone and reconstruction zone. The second, such
that d . Ż, incorporates near zone, formation zone, non-radiation zone,
1/R2

zone and non-reconstruction zone.

≫

−

−

In the case of ultra-relativistic systems instead, we can say that a & L f and
λ. As a result the near zone is now deﬁned by d . a, the formation
L f ≫
Ż. As for the reconstruction zone
zone by d . L f , the radiation zone by d
zone we can say that a necessary and suﬃcient condition to be
and the 1/R

≫

−

length of order L f .
6 This means that in the radiation zone the ﬂux of the Poynting vector through any
transverse plane is independent of its longitudinal position.
7 Note that there is a certain abuse of language in this deﬁnition, as it does not
include the case β
8 This is almost always the case. It is possible, however, to organize particular
situations where contributions from many structure sum up coherently within a
limited angular and spectral range. For instance, one may think of contributions
from a row of bends spaced ad hoc, as in a wiggler, behaving as an array of antennas.

≪

1.

19

in these zones is that d

Ż.

≫

3.3 Radiation contribution from the ”velocity ﬁeld”

As one can see, the case of ultra-relativistic system presents an increased
level of complexity with respect to the non-ultra-relativistic system. This
complexity is at the origin of several misconceptions, that we here discuss.

We presented, in the space-frequency domain, an exact solution of Maxwell’s
equation, Eq. (36) (and its paraxial form Eq.(31)), starting directly with
Maxwell’s equations in the space-frequency domain. As said before, text-
books (see for example [21]) usually follow a not so direct derivation. They
start with the solution of Maxwell’s equation in the space-time domain,
the well-known Lienard-Wiechert expression, and they subsequently apply
a Fourier transformation. The Lienard-Wiechert expression for the electric
ﬁeld of a point charge (

e) reads (see, e.g. [21]):

−

~n

~β
−
~β)2

~n

·

−
~r′(t′)
|

~E(~ro, t) =

e

−

γ2(1

e
c

~n

(1

[(~n

~n

·

×

−

−
~β)2

˙~β]
~β)
×
~r′|
~ro −
|

.

~ro −
|

2 −
~r′|

(40)

~ro −
|

As before, R =
denotes the displacement vector from the retarded
position of the charge to the point where the ﬁelds are calculated. Moreover,
~β = ~v/c, ~˙β = ~˙v/c, while ~v and ~˙v denote the retarded velocity and acceleration
of the electron. Finally, the observation time t is linked with the retarded
time t′ by the retardation condition R = c(t
t′). As is well-known, Eq. (40)
serves as a basis for the decomposition of the electric ﬁeld into a sum of two
quantities. The ﬁrst term on the right-hand side of Eq. (40) is independent of
acceleration, while the second term linearly depends on it. For this reason,
the ﬁrst term is called ”velocity ﬁeld”, and the second ”acceleration ﬁeld”
[21]. Velocity ﬁelds diﬀer from acceleration ﬁelds in several respects, one of
which is the behavior in the limit for a very large distance from the electron.
2, while acceleration
There one ﬁnds that the velocity ﬁelds decrease like R−
ﬁelds only decrease as R−

1. Let us apply a Fourier transformation:

−

~¯E(~ro, ω) =

e

−

∞

dt′

~n

~β
−
~β)2

∞

Z
−∞
e
c

Z
−∞

−

γ2(1

2

~r′|

·

~n

−
[(~n

×

−

~n

·

−
~β)2

~ro −
|
˙~β]
~β)
×
~r′|
~ro −
|

dt′

~n

(1

exp

iω
"

t′ + |
 

~ro −

~r′(t′)
|
c

!#

exp

iω
"

t′ + |
 

~ro −

~r′(t′)
|
c

.

!#

(41)

20

(42)

(43)

(44)

As in Eq. (40) one may formally recognize a velocity and an acceleration
term in Eq. (41) as well. Since Eq. (41) follows directly from Eq. (40), that
is valid in the time domain, the magnitude of the velocity and acceleration
parts in Eq. (41), that include terms in 1/R2 and 1/R respectively, do not
depend on the wavelength λ. On the contrary, as we have seen, the terms
including 1/R and 1/R2 in Eq. (36) do. It is instructive to take advantage of
integration by parts to show that Eq. (36) and Eq. (40) are equivalent. With
the help of

1
c

d
dt′ |

~ro −

~r′(t′)
|

=

~n

−

·

~β .

and

d~n
dt′

=

c
~r′(t′)

~ro −
|
Eq. (41) can be written as

| h

−

~β + ~n

~n
(cid:16)

·

~β
(cid:17)i

,

~¯E (~ro, ω) =

∞

dt′

e

−

Z
−∞
d
dt′ 


(1

~n
~r′(t′)
2
|

~ro −
|
~β
~n
−
~β)
~ro −
|

~n

·

−

∞

dt′

+

e
c

Z
−∞

~r′(t′)
|





exp

iω
"

t′ + |
 

~ro −

~r′(t′)
|
c

!#

exp

iω

"

t′ + |
 

~ro −

~r′(t′)
|
c

.

!#

Eq. (44) may now be integrated by parts. When edge terms can be dropped 9

∞

−∞

and t′ = +

9 The only assumption made going from Eq. (41) to Eq. (45) is that edge terms
in the integration by parts can be dropped. This assumption can be justiﬁed by
means of physical arguments in the most general situation accounting for the fact
that the integral in dt′ has to be performed over the entire history of the particle
and that at t′ =
the electron does not contribute to the ﬁeld
anymore. Let us give a concrete example for an ultra-relativistic electron. In this
case, switchers may be obtained placing bending magnets at the beginning and
at the end of the setup, and requiring that they deﬂect the electron trajectory of
an angle much larger than the maximal observation angle of interest for radiation
from a bending magnet. Equivalently, this means that the magnets would be longer
(cρ2/ω)1/3, where ρ
than the formation length associated with the bends, i.e. Lfb ∼
is the bending radius. In this way, intuitively, the magnets act like switches: the ﬁrst
magnet switches the radiation on, the second switches it oﬀ. Then, what precedes
the upstream bend and what follows the downstream bend does not contribute to
the ﬁeld detected at the screen position. With these caveat Eq. (45) is completely
equivalent to Eq. (41).

21

one obtains

~¯E(~ro, ω) =

iωe
c

−

∞

Z
−∞

(

~β
~n
−
dt′ 
~r′(t′)
~ro −

|
|
~r′(t′)
~ro −
t′ + |
|
c
 

−

ic
ω

!)

~ro −
|
.

exp

iω

×

~n
2 
~r′(t′)
|



(45)

Recalling t′ = z′/vz(z′) = s(z′)/v and the deﬁnition in Eq. (3) one sees that
Eq. (45) is equivalent to Eq. (36). Eq. (45) is the starting point for numerical
codes based on direct calculation of the near ﬁeld (the most well-known
example is perhaps SRW [22]).

The derivation of Eq. (45) is particularly instructive because shows that each
term in Eq. (45) is due to a combination of velocity and acceleration terms
in Eq. (41). In other words the terms in 1/R and in 1/R2 in Eq. (45) appear
as a combination of the terms in 1/R (acceleration term) and 1/R2 (velocity
term) in Eq. (41). As a result, one can say that there exist contributions to
the radiation from the velocity part in Eq. (41). The presentation in Eq. (45)
(or Eq. (36)) is more interesting with respect to that in Eq. (41) (although
equivalent to it) because the magnitude of the 1/R2-term in Eq. (45) can
be directly compared with the magnitude of the 1/R-term inside the sign
of integral, and is related, as we have seen, to the 1/R-zone and to the
reconstruction zone, where the ﬁeld can be reconstructed from far-ﬁeld
data. It must be clear that the 1/R2-term in Eq. (45) does not coincide with
the 1/R2-term in Eq. (41), that is the velocity ﬁeld. If one forgets about this
fact he would come to the paradoxical conclusion that far-ﬁeld data can be
used to reconstruct the ﬁeld in the far-zone only (on the contrary, we have
Ż we are in the reconstruction zone). Note that while
seen that when d
this conclusion is, in general, a misconception, it does give incorrect results
in the case of ultra-relativistic systems only, because in the case of non-ultra-
relativistic systems the reconstruction zone and the far zone coincide.

≫

The bottom line is that only to the integral in Eq. (41) or Eq. (45) can be
ascribed physical sense. The integrand is, in fact, an artiﬁcial construction.
In this regard, it is interesting to note that the integration by parts giving
Eq. (45) is not unique. An expression equivalent to Eq. (45) for the Fourier
transform of the electric ﬁelds can be found in the very interesting, but
perhaps little known reference [23]. After starting with Eq. (41), the authors
of [23] organized integration by part in a diﬀerent way compared with what
has been done in Eq. (44). First they found that

22

~β)

~n
×
~ro −
|

[(~n
−
~r′|
(1

−

×
~n

·

~˙β]
~β)2

=

1
~r′|
~ro −
|
~˙n(~n
·

~β)
×
~β) 

~˙n(~n

(~n

~n

d
×
dt′ 
(1

−
~β) + ~n(~˙n
·
~ro −
|

~n
·
~β)
−
~r′|
(1

− 

Note that Eq. (46) accounts for the fact that ~n = (~ro −
is not
a constant in time. Using Eq. (46) in the integration by parts, authors of [23]
obtained


~r′(t′))/
~ro −
|

~r′(t′)
|

−

~n



·

~β(~˙n

~β)

·

−

.

·

~β)2
~β)2

(46)

~¯E(~ro, ω) =

iωe
c

−

∞

Z
−∞

(

~β)
(~n
~n
×
×
~r′(t′)
~ro −
|
|
~r′(t′)
~ro −
|
c

dt′ 
−

t′ + |
 

exp

iω

×

.

!)

+

~β

ic
ω

~β)

~n
−
−
~ro −
|

2~n(~n
·
~r′(t′)
2
|





(47)

(48)

(49)

Similarly as before, the edge terms have been dropped. Eq. (41), Eq. (45) and
Eq. (47) are equivalent but include diﬀerent integrands. This is no mistake,
as diﬀerent integrands can lead to the same integral.

Another way to state this fact, in a more general way, is that Eq. (41), Eq. (45)
and Eq. (47) can be obtained one from the other by means of the addition
of a full derivative to the respective integrals. For example, the integration
by parts used to transform Eq. (41) into Eq. (45) is equivalent to add to the
integrand of Eq. (41) the full derivative dΩ1/dt′ of the quantity

Ω1 =

~β
~n
−
~β)
~ro −
|

·

~r′(t′)
|

−

(1

~n

−

exp

iω
"

t′ + |
 

~ro −

~r′(t′)
|
c

,

!#

while the integration by parts used to transform Eq. (41) into Eq. (47) is
equivalent to add to the integrand of Eq. (41) the full derivative dΩ2/dt′ of
the quantity

Ω2 =

~n

~n

~β)
(~n
×
×
~β)
~r′(t′)
~ro −
|
|

·

−

(1

−

exp

iω
"

t′ + |
 

~ro −

~r′(t′)
|
c

.

!#

There are inﬁnite full derivatives of functions Ω that can be summed to the
integrand of the ﬁeld-integral, giving inﬁnite representations of the same
physical quantity, the electric ﬁeld. From this viewpoint, summing a full
derivative to the integrand of the ﬁeld-integral is analogous to a gauge
transformation, that leaves invariant the observable quantity (the ﬁeld),
but transforms the electromagnetic potential in ways that may be useful in

23

particular situations. Of all possible choice of Ω, the function Ω1, that gives
Eq. (45), is particularly useful because, as we have seen, the magnitude of
the 1/R2-term in Eq. (45) can be directly compared with the magnitude of
the 1/R-term inside the sign of integral. However, the ﬁeld obtained by
summing full derivatives to the integrand is invariant for any choice of Ω.

Let us summarize the result of this discussion. We have seen how diﬀerent
zones scale with the other characteristic lengths of the problem, the wave-
length λ, the formation length L f and the typical dimension of the system
a. Complexities arise in the ultra-relativistic case, when λ, a and L f are very
diﬀerent quantities. In particular far zone, reconstruction zone and radia-
tion zone are, in general, diﬀerent concepts. Due to this fact, paradoxes may
arise when ascribing separate meaning to velocity and acceleration part of
the Lienard-Wiechert ﬁelds after Fourier transformation, i.e. in Eq. (40). In
particular, we have shown that the integrand of the ﬁeld-integral has no
physical meaning. However, the representation of the ﬁeld integral in Eq.
(45) is particularly important, as it allows a better physical insight, very
much as a particular choice of electromagnetic gauge can do in particular
situations.

4 Application 1. Undulator radiation as a laser-like beam

An important exempliﬁcation of our algorithm is given here for the particu-
lar case of undulator radiation. We assume, for simplicity, that the resonance
condition with the fundamental harmonic is satisﬁed, that is

where λw is the undulator period, while K is the undulator parameter

ω
2γ2c  

1 +

K2
2 !

=

2π
λw

,

K =

λweHw
2πmec2 ,

me being the electron mass and Hw being the maximum of the magnetic ﬁeld
produced by the undulator on the z axis.

We also specify that position z = 0 is taken in the middle of the undulator.
We consider a planar undulator, so that the transverse velocity of an electron
can be written as

(z′) =

~v
⊥

cK
γ

−

sin (kwz′)~x .

24

(50)

(51)

(52)

A well-known expression for the angular distribution of the ﬁrst harmonic
ﬁeld in the far-zone can be obtained from Eq. (17) or Eq. (16). Such expression
is axis-symmetric, and can therefore be presented as a function of a single
observation angle θ, where

θ2 = θ2

x + θ2
y ,

θx and θy being angles measured from the undulator z-axis in the horizontal
and in the vertical direction. One obtains the following distribution:

(zo, θ) =

KωeLw
c2zoγ

−

AJJ exp

ωzo
2c

i
(cid:20)

θ2

sinc

(cid:21)

ωLwθ2
4c

"

#

,

E

⊥
e

where the ﬁeld is polarized in the horizontal direction. Here Lw = λwNw is
the undulator length and Nw the number of undulator periods. Finally, AJJ
is deﬁned as

(53)

(54)

(55)

AJJ = Jo

K2

 

4 + 2K2 ! −

J1

K2
4 + 2K2 !

 

,

Jn being the n-th order Bessel function of the ﬁrst kind. Eq.(54) describes a
ﬁeld with spherical wavefront centered in the middle of the undulator. Eq.
(13) can now be used to calculate the ﬁeld distribution at the virtual source
yielding

(56)

E

(0, r

) = i

Kωe
c2γ

AJJ

π
"

−

2Si

ωr2
⊥
Lwc !#

 

,

⊥

⊥

⊥

=

⊥
e

) indicates the sin integral function and r

⊥
e
~r
is the distance
where Si(
⊥|
|
·
(0, r
E
from the z axis on the virtual-source plane. Note that
) is axis-
symmetric. Eq. (56), that has been already presented in [3], describes a
virtual ﬁeld with a plane wavefront. Let us compare this virtual ﬁeld with
a laser-beam waist. In laser physics, the waist is located in the center of the
optical cavity. In analogy with this, in our case the virtual source is located
in the center of the undulator. Both in laser physics and in our situation the
waist has a plane phase front and the transverse dimension of the waist is
much longer than the wavelength. Note that the phase of the wavefront in
Eq. (56) is shifted of
π/2 with respect to the spherical wavefront in the far
zone. Such phase shift is analogous to the Guoy phase shift in laser physics.
Finally, in laser physics, the Rayleigh range for a laser beam is presented
in the form zR = (ω/c)w2
o, wo being the radius of the beam at the location
of the waist (i.e. at that position along z where the phase front is ﬂat). This
is deﬁned, for example, by requiring that the intensity on the edge of an

−

25

aperture of radius wo be one fourth of the intensity at the center of the radia-
tion spot. In the undulator source case, the deﬁnition given above amounts
to wo = 0.9(cLw/ω)1/2 and zR = 0.8Lw ≃
Lw. In the case of a laser beam the
Rayleigh length is related to the resonator geometrical factor. In analogy
with this, in the case of a undulator source the Rayleigh length is related,
instead, to the undulator geometrical factor.

Finally, use of Eq. (5) gives the ﬁeld distribution at arbitrary observation
position zo outside the magnetic setup:

(zo, r

) =

⊥

E

⊥
e

KωeAJJ

Ei

c2γ "

 

2zoc

iωr2
⊥
Lwc ! −
−

Ei

iωr2
⊥
2zoc + Lwc!#

 

,

) indicates the exponential integral function 10 . Taking square
where Ei(
·
modulus of Eq. (56) and Eq. (57) one obtains, respectively, the intensity
proﬁle for the virtual source and the evolution of the intensity proﬁle for
undulator radiation both in the near and in the far zone. Namely, introducing
normalized units

=

~ˆr
⊥

ω
Lwc

,

~r
⊥

r

~ˆθ =

ωLw
c

~θ ,

r

and

ˆz =

z
Lw

(57)

(58)

(59)

(60)

10 Note that the ﬁeld is singular in the point zo = Lw/2 and r
= 0. This feature is
⊥
related with the use of the resonance approximation. As has been seen before, the
ﬁeld distributions in the virtual source and in the far zone are linked by a Fourier
transformation. This fact justiﬁes the reciprocal relation linking small features in
the near zone to large feature in the far zone (and viceversa large features in the
near zone to small features in the far zone). Thus we may say that the singularity at
zo = Lw/2 and r
= 0 is another way of stating the well known fact that resonance
⊥
approximation fails, in the far zone, for angles comparable with 1/γz (or larger).
From this viewpoint, singularity in Eq. (57) is not speciﬁc of our approach, but is
intrinsically related with the use of resonance approximation. Note that, while for
the ﬁrst harmonic the far zone ﬁeld does not exhibit singular behaviors at large
angles, for the second harmonic one has a logarithmic divergence of the spectral
ﬂux integrated over angles of observation, due to a diﬀerent behavior of the ﬁeld
distribution as a function of angles (see [24]).

26

Fig. 1. Normalized intensity distribution at the beam waist location, ˆI as a function
of

(upper plot) and 3D view as a function of ˆx and ˆy.

~ˆr
⊥|
|

27

-6

-4

-2

2

4

6

-6

-4

-2

2

4

6

^
z = 0.6

^
z = 0.75

^
I

1.5

2

1

0.5

^
I

1.5

2

1

0.5

q^

6

q^

^
I

^
I

1.5

2

1

0.5

1.5

2

1

0.5

-6

-4

-2

2

4

-6

-4

-2

2

4

6

^
z = 1

^
z = 4

Fig. 2. Evolution of the intensity proﬁle for undulator radiation according to Eq.
(62) (solid lines) and comparison with the far ﬁeld asymptotic sinc2( ˆθ2/4) (dashed
lines). The proﬁles according to Eq. (62) are shown as a function of angles at diﬀerent
observation distances ˆzo = 0.6, ˆzo = 0.75, ˆzo = 1.0 and ˆzo = 4.0.

we obtain the relative intensity at the virtual source

ˆI(0, ˆr
⊥

) =

1
π2

π

2Si

−

h

2

,

ˆr2
⊥(cid:17)i
(cid:16)

and at any distance ˆzo, both in the near and in the far zone:

= ˆz2

Ei

ˆI

ˆzo, ˆθ
(cid:16)
(cid:17)

ˆθ2
iˆz2
o
2ˆzo −

 

1 ! −

Ei

 

o (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2

,

iˆz2
o

ˆθ2

2ˆzo + 1 !(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

28

q^

q^

(61)

(62)

where ˆI is deﬁned as a normalized version of
2 in normalized units. Note
that we use the notation ˆθ = ˆr
/ˆzo in the near zone as well, because it is
⊥
convenient, for future discussions, to present the intensity as in Eq. (62).
Aside for scaling factor, the intensity proﬁle in Eq. (61) can be detected by
imaging the virtual plane with an ideal lens.

˜E
|

⊥|

The relative intensity at the virtual source is plotted in Fig. 1. The evolution
of the intensity proﬁle at diﬀerent positions after the exit of the undulator
according to Eq. (62) is plotted, instead in Fig. 2.

To conclude, a single electron produces a laser-like radiation beam with a
virtual source located in the center of the undulator whose transverse size
is much larger than the radiation wavelength. Following [1], Eq. (54) and
Eq. (56) can be generalized to the case of a particle with a given oﬀset ~l and
deﬂection angle ~η with respect to the longitudinal axis. The far-zone ﬁeld,
Eq. (54), can be generalized to

(63)

θ2

exp

(cid:21)

i

ω
c

~θ

~l
(cid:21)

·

(cid:20)−

zo, ~η,~l, ~θ
(cid:17)
(cid:16)

E

⊥
e

=

KωeLw
c2zoγ

−

AJJ exp

sinc 

×

ωLw

−

~θ
(cid:12)(cid:12)(cid:12)(cid:12)

4c



i
(cid:20)
~η

(cid:12)(cid:12)(cid:12)(cid:12)

ωzo
2c
2

,





while the expression for the ﬁeld at virtual source, Eq. (56), is transformed
to:

0, ~η,~l, r
(cid:16)

⊥

(cid:17)

= i

Kωe
c2γ

AJJ exp

ω
c

i
(cid:20)

~η

~r
⊥ −
(cid:16)

·

~l
(cid:17)(cid:21)


π

2Si 

−

E

⊥
e

ω

2

~r
⊥ −
Lwc

(cid:12)(cid:12)(cid:12)(cid:12)

~l
(cid:12)(cid:12)(cid:12)(cid:12)



.









(64)



The meaning of Eq. (63) and Eq. (64) is that oﬀset and deﬂection of the single
electron motion with respect to the longitudinal axis of the system result in
oﬀset and deﬂection of the waist plane. Computer codes (e.g. ZEMAX [5],
PHASE [25]), often referred to as wavefront propagation codes have been
developed and are now standard tools used to carry out Fourier Optics-
based calculations. For example ZEMAX can be used for single-particle ﬁeld
calculations. Once the virtual source Eq. (64) is speciﬁed, it can be used as an
input for computer codes. This allows propagation of the virtual wavefront
in the presence of a complicated setup, very much like it has been used as
an input to Eq. (5) in the particularly simple case of free-space propagation.
One may also deal with SR from a beam of ultrarelativistic electrons. For
example, in the case of spontaneous (incoherent) SR, radiation produced by

29

x

O

Screen

zo

z

B

A

Fig. 3. Edge radiation geometry. The beam enters the system through a bending
magnet, passes a straight section and leaves the setup through another bend. Ra-
diation is collected at a distance zo from the origin of the reference system, located
in the middle of the straight section.

an electron beam in an undulator can be treated as an incoherent collection
of laser beams with diﬀerent oﬀsets and deﬂections (i.e. by summing up the
intensities of laser-like beams with diﬀerent oﬀsets and deﬂections) 11 .

5 Application 2. Edge radiation

In this Section we apply the method described in Section 2 to the particular
case of two dipole magnet edges.

We restrict ourselves to the system depicted in Fig. 3 and we consider a
single particle moving along the system. The electron enters the setup via a
bending magnet, passes through a straight section (segment AB) and exits
the setup via another bend. Radiation is collected at a distance zo from the
center of the reference system, located in the middle of the straight section.
For wavelengths λ
λc, λc being the critical wavelength of SR produced
by bending magnets, the passage of the electron through the setup results
in the emission of edge radiation (see, among the many references some
early works and more recent developments in [6, 7, 8, 9, 10, 11, 12, 13] and
references therein).

≫

In our case of study the trajectory and, therefore, the space integration in

11 Note that if the electron beam is distributed coherently, radiation can be described
as a coherent collection of laser beams.

30

Eq. (17) can be split in three parts: the two bends, that will be indicated with
b1 and b2, and the straight sections AB. One may write

(zo, ~r
⊥

o, ω) = ~

Eb1(zo, ~r
⊥

o, ω) + ~

EAB(zo, ~r
⊥

o, ω) + ~

Eb2(zo, ~r
⊥

o, ω) ,

(65)

e
with obvious meaning of notation.

e

e

~
E

⊥
e

We will denote the length of the segment AB with L. This means that points
A and B are located at longitudinal coordinates zA =

L/2 and zB = L/2.

−

First, with the help of Eq. (17) we will derive an expression for the ﬁeld in
the far zone. The intensity distribution in this case, result to be in agreement
with expression in references cited above. Then, we will calculate the ﬁeld
distribution at the virtual source with the help of Eq. (13). Finally, Eq. (5)
will allow us to ﬁnd an expression for the ﬁeld both in the near and in the
far zone.

In the following we will only deal with a contribution of the electric ﬁeld,
i.e. that from the straight section.

≫

According to the superposition principle, one should sum the contribution
due to the straight section to that from the bends. In some cases one can
ignore the presence of the bending magnets with good accuracy, and treat
them as if they had zero length. In other cases one cannot do that. When
one can neglect the ﬁeld contribution due to the switchers, one can work
in what can be called the ”zero-length switchers approximation”. While we
direct the reader to Section 5.3 for details, we can mention here that for long
γ2Ż, a condition for the zero-length switchers
enough straight sections L
≫
approximation to apply is λ
λc, λc being the critical wavelength for SR
from bends. Intuitively, magnets act like switchers: the ﬁrst magnet switches
the radiation harmonic on, the second switches it oﬀ. In the case depicted in
Fig. 3 the switchers are bending magnets, but other setups can be considered
where they have diﬀerent physical realizations. For example, one may think
of a setup where the phenomenon at study is the emission of bremsstrahlung
in a collision between a ultra-relativistic electron and a nucleus. In this case,
the switch-oﬀ process is taken care of by the collision itself. The nucleus
plays the role of the switcher and the impact parameter, i.e. the minimal
distance of the nucleus to the electron, characterizes the switcher itself.
Note that there is no principle nor practical limitation to the length of the
switcher. In the bremsstrahlung case we can assume that such length is very
short, even with respect to the radiation wavelength. In the case of bends it
can be much longer than all characteristic scales of interest, depending on
the magnetic ﬁeld strength, and all kind of intermediate situations can be
realized. As one can see, the case of a straight line preceded and followed

31

by switchers has a number of physical realizations. The only feature that
diﬀerent realizations must have in common by deﬁnition of switcher is
that the switching process depends exponentially on the distance from the
beginning of the process. Then, a characteristic length ds is associated to
any switcher. Since electrodynamics is a linear theory, in the case when
the contribution from the ﬁnite straight-line cannot be considered a good
approximation of the total ﬁeld, it can be considered as a building block
for a more complicated setup. An example of a more sophisticated setup is
studied in the next Section 6, where the problem of Transition Undulator
Radiation is addressed.

In general, one can say that the problem of studying the ﬁeld from a ﬁ-
nite straight-line is of fundamental importance, independently of the type
of switchers considered. This justiﬁes our attention to the straight-section
contribution to the ﬁeld.

5.1

Far ﬁeld pattern of edge radiation

5.1.1

Field contribution calculated along the straight section

Accounting for the geometry in Fig. 3 we have

s(z′) = z′

for zA < z′ < zB

With the help of Eq. (17) we write the contribution from the straight line AB
as

~
EAB =

iωe
c2zo

e

L/2

Z
L/2
−

dz′ exp [iΦAB]

θx~x + θy~y

(cid:16)

(cid:17)

where ΦAB in Eq. (67) is given by

ΦAB = ω

x + θ2
θ2
y
2c

zo +

z′
2c  

1
γ2

+ θ2

x + θ2

,

y!






~
EAB =

iωeL
c2zo

exp

iωθ2zo
2c

"

#

~θ sinc

ωL
4c  

"

θ2 +

1
γ2 !#

e

32

θx = xo/zo and θy = yo/zo being the observation angles in the horizontal and
vertical direction. From Eq. (67) one obtains

(66)

(67)

(68)

(69)

(70)

(71)

(72)

Eq. (69) is an exact expression for the electric ﬁeld from the straight section
AB. Note that Eq. (69) describes a spherical wave. Moreover, it explicitly
depends on L (this last remark will be useful later on).

The formation length Lfs for the straight section AB can be written as

L. In both
Depending on the wavelength of interest then, Lfs ∼
cases, with the help of Eq. (68) we can give on a purely mathematical basis
an upper limit to the value of the observation angle of interest related to the
straight line:

γ2Ż or Lfs ∼

where, as before

θ2 = θ2

x + θ2
y .

Lfs ∼

min

γ2Ż, L
i
h

.

θ2

x,y .

Ż

Lfs

.

Note that, if Lfs ∼
frequency.

γ2Ż, the maximal angle of interest is independent of the

Finally it should be remarked that the the far-zone asymptotic in Eq. (67)
L. This is a necessary and suﬃcient
is valid at observation positions zo ≫
condition for the vector ~n pointing from the retarded position of the source
to the observer, to be considered constant. This result is independent of the
formation length given by Eq. (71). Therefore, when L . γ2Ż we can say
that an observer is the far zone if and only if it is located many formation
γ2Ż. In this
lengths away from the origin. This is no more correct when L
≫
γ2Ż, i.e. many formation
case the observer can be located at a distance zo ≫
L, i.e.
lengths away from the origin of the reference system, but still at zo ∼
in the near zone. As we see here, the formation length L f is often, but not
always related with the deﬁnition of the far (or near) zone. This is the case for
bending magnet radiation, but not for edge radiation. As has been remarked
before in Section 3, the far (or near) is related with the characteristic size of
the system a (in our case a = L). In its turn L f . a, which includes, as in the
edge radiation case when γ2Ż

a.

L, the situation L f ≪

≪

5.1.2

Energy spectrum of radiation

The radiation energy density as a function of angles and frequencies can be
written as

33

(73)

(74)

(75)

(76)

(77)

(78)

dΩ being the diﬀerential of the solid angle Ω. Here we have used Parseval
theorem and the fact that the irradiance (i.e. the energy per unit time per
unit area, averaged over a period of the carrier frequency) is given by

where brackets < ... > denote averaging over a cycle of oscillation of the
carrier wave. Substituting Eq. (69) in Eq. (73) it follows that

dW
dωdΩ

=

ω2e2L2
4π2c3 θ2 sinc2

ωL
4c  

"

θ2 +

1
γ2 !#

.

It is convenient to introduce normalized quantities

dW
dωdΩ

=

2

,

cz2
o

4π2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

c

P =

2

~E

=

c

4π (cid:28)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:29)

(cid:12)(cid:12)(cid:12)(cid:12)

2

,

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2π (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

~ˆθ =

ωL
c

~θ ,

r

ˆφ =

ωL
γ2c

,

With Eq. (75) in mind and using normalized units, we may write the direc-
tivity diagram ˆI of the radiation as

ˆI = const.

ˆθ2 sinc2

×

1
4

(cid:20)

ˆθ2 + ˆφ
(cid:16)

(cid:17)(cid:21)

The directivity diagram in Eq. (78) is plotted in Fig. 4 for several values
of ˆφ as a function of the normalized angle ˆθ. The natural angular unit is
evidently (2πL/λ)−

1/2.

≫

≫

1. When ˆφ

There are two asymptotic cases for the problem parameter ˆφ: ˆφ
1 and
ˆφ
1 the oscillating structures are ﬁne with respect to the
envelope of the directivity diagram. The intensity peaks where the envelope
ˆφ. This feature for the far-ﬁeld
of the directivity diagram peaks, i.e. at ˆθ
emission is shown in Fig. 4 for the case ˆφ = 50 and are typical for ˆφ
1.
≫
When the length of the straight section becomes smaller and ˆφ
1, we
reach the other asymptotic limit. In this case, the period of the oscillations
ˆφ, as it can also be

) function becomes much larger than

∼ q

≪

≪

due to the sin(
·

q

34

^

^
^

I(a.u.)

^

I(a.u.)

^

^

0

1

2

3

4

5

0

1

2

3

4

5

6

7

8

9

10

^

I(a.u.)

^

^

I(a.u.)

^

^

^

0

10

20

0

10

20

30

40

50

^

^

Fig. 4. Directivity diagram (solid lines) of the radiation from the setup in Fig. 3 for
diﬀerent values of ˆφ. Dotted lines show the envelope of the directivity diagram.

seen in Fig. 4 for the case ˆφ = 0.1. Then, the maximum intensity does not
coincide anymore with the peak of the envelope of the directivity diagram,
but it is found at ˆθ = 2.2.

The behavior of the far-ﬁeld emission described here is well-known in liter-
ature, and has been ﬁrst reported long ago in [8]. We take this as the starting
point for further investigations based on Fourier Optics.

5.2 Method of virtual sources

5.2.1 Edge radiation as a ﬁeld from a single virtual source

Eq. (13) and Eq. (69) allow one to characterize the virtual source through

~
E(0, ~r
⊥

) =

ω2eL
2πc3 Z

−

d~θ ~θ sinc

ωL
4c  

"

θ2 +

1
γ2 !#

exp

iω
c

~r
⊥ ·

(cid:20)

.

~θ
(cid:21)

(79)

e

35

(80)

(81)

(82)

The Fourier transform in Eq. (79) is diﬃcult to calculate analytically in full
generality. However, simple analytical results can be found in the asymptotic
case for ˆφ
1. In this limit, the right hand side of
Eq. (79) can be calculated with the help of polar coordinates. An analytic
expression for the ﬁeld amplitude at the virtual source can then be found
and reads:

1, i.e. for 2πL/(γ2λ)

≪

≪

~
E(0, ~r
⊥

) =

4ωe
c2L

~r
⊥

sinc

ω
Lc

(cid:18)

e

.

2

(cid:19)

~r
⊥
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

It is useful to remark, for future use, that similarly to the far-ﬁeld emission
Eq. (69), also the non-normalized version of the ﬁeld in Eq. (80) explicitly
depend on L. This is true in general, for any value of ˆφ. After deﬁnition of
the normalized transverse position

=

~ˆr
⊥

ω
Lc

~r
⊥

r

the intensity distribution of the virtual source is given by

ˆI(ˆr
⊥

) = const.

sinc2

ˆr2
⊥

×

,

ˆr2
⊥(cid:17)
(cid:16)

it can be detected (aside for scaling factors) by imaging the virtual plane
with an ideal lens, and is plotted in Fig. 5.

Note that Eq. (80) describes a virtual source characterized by a plane wave-
front. Application of the Fresnel propagation formula, Eq. (5) to Eq. (80)
allows one to reconstruct the ﬁeld both in the near and in the far region. We
obtain the following result:

~
E(zo, ~r
⊥

) =

2e
c

~r
⊥
r2
⊥

−

e

exp

× "

 −

exp

i
"

ωr2
⊥
2czo #
iωr2
⊥
2czo(1 + 2zo/L) ! −

exp

 

2czo(

−

iωr2
⊥
1 + 2zo/L) !#

.

(83)

1 12 .

Eq. (83) solves the ﬁeld propagation problem for both the near and the far
ﬁeld in the limit for ˆφ

≪
12 Eq. (83) is singular as ~r
= 0 and zo = L/2. Moreover, the spectral photon
⊥
ﬂux, integrated in angles, is logarithmically divergent. In the undulator case, as
we have seen in footnote 10, singular features have been interpreted as limits
of applicability of the resonance approximation. Similarly we can state here that
the paraxial approximation is valid, in the far zone, for angles of observation much

36

Fig. 5. Intensity distribution at the virtual source, ˆI, as a function of
and 3D view as a function of ˆx and ˆy.

~ˆr
⊥|
|

(upper plot)

37

(84)

(85)

(86)

1.

≪

The intensity proﬁle associated with Eq. (83) is given by

ˆI( ˆθ) =

i ˆθ2 ˆzo

exp
"

 −

2(1 + 2ˆzo)! −

exp

1

ˆθ2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

where ˆθ = ˆr
⊥

/ˆzo and ˆzo = zo/L.

2

,

i ˆθ2 ˆzo

 

2(

−

1 + 2ˆzo)!#(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

In the limit for ˆzo −→ ∞

Eq. (83) and Eq. (84) respectively transform to

~
E =

iωeL
c2zo

exp

iωθ2zo
2c

"

#

~θ sinc

ωLθ2
4c #

"

e

and

ˆI = const.

ˆθ2 sinc2

×

ˆθ2
4 #

"

,

corresponding to Eq. (69) and Eq. (78) in the asymptotic case for for ˆφ

1 and the near zone for ˆzo ≪

Note that when ˆφ
1 we have only two asymptotic regions with respect
≪
to ˆzo: the far zone for ˆzo ≫
1. Of course, it
should be stressed that in the case ˆzo ≪
1 we still hold the assumption
that the approximation of zero-length switchers is satisﬁed. It is interesting
to study the evolution of the intensity proﬁle for edge radiation along the
longitudinal axis. This gives an idea of how good the far ﬁeld approximation
1) is. A comparison between intensity proﬁles at diﬀerent observation
(ˆzo ≫
points is plotted in Fig. 6.

≪

≪

The case ˆφ
1 studied until now corresponds to a short straight section
γ2Ż. When this is condition is not satisﬁed, we ﬁnd that the integral on
L
the right hand side of Eq. (79) is diﬃcult to calculate analytically. However,
one can use numerical techniques. With the help of polar coordinates, the
right hand side of Eq. (79) can be transformed in a one-dimensional integral,
namely

smaller than unity. The logarithmic singularity of the ﬂux and the singular behavior
= 0 and zo = L/2 correspond to a logarithmic divergence of the ﬂux in the far
at ~r
⊥
zone at large angles. These divergences, in the near as well as in the far zone are
outside the region of applicability of our approximation, because we discuss the
far-zone ﬁeld within angles much smaller than unity as well as near-zone ﬁeld for
transverse displacements r

Ż, where we have no singularity at all.

⊥ ≫

38

^
I

^
I

3

2

1

2.5

1.5

0.5

3

2

1

2.5

1.5

0.5

10

q^

10

q^

^
I

3

2

1

2.5

1.5

0.5

^
I

3

2

1

2.5

1.5

0.5

q^

q^

39

-10

-5

5

10

-10

-5

5

^
z = 0.6

^
z = 1

-10

-5

5

10

-10

-5

5

^
z = 2

^
z = 5

Fig. 6. Evolution of the intensity proﬁle for edge radiation in the limit for ˆφ
1.
These proﬁles are shown as a function of angles at diﬀerent observation distances
ˆzo = 0.6, ˆzo = 1.0, ˆzo = 2.0 and ˆzo = 5.0 (solid lines). The dashed line always refers
to the far-zone intensity.

≪

~
E(0, ~r
⊥

) =

e

4ωe
c2

−

~r
⊥
r

⊥

∞

Z
0

θ2
θ2 + 1/γ2 sin

ωL
4c  

"

θ2 +

1
γ2 !#

ωθr
c

⊥

(cid:19)

J1

(cid:18)

dθ .

(87)

We calculated the intensity distribution associated with the virtual source
for values ˆφ = 0.1, ˆφ = 1, ˆφ = 10 and ˆφ = 50, corresponding to directivity
diagrams in the far zone in Fig. 4. We plot these distributions in Fig. 7.
In particular, it is instructive to make a separate, enlarged plot of the case
ˆφ = 50, that is in the asymptotic case for ˆφ
1. This is given in Fig. 8.
Fine structures are now evident, and are consistent with the presence of ﬁne

≫

^
^

I(a.u.)

^

I(a.u.)

^

^

0

1

2

3

4

5

0

1

2

3

4

5

^

I(a.u.)

^

r

^

I(a.u.)

^

^

^

r

^

r

0

1

2

3

4

5

0

1

2

3

4

5

^

r

Fig. 7. Intensity proﬁles of the virtual source for the setup in Fig. 3. These proﬁles
are shown for ˆφ = 0.1, ˆφ = 1.0, ˆφ = 10.0 and ˆφ = 50.0 (solid lines). Solid curves
are calculated with the help of Eq. (87). The dotted lines show comparison with the
asymptotic limit for ˆφ

1, shown in Fig. 5 and calculated using Eq. (82).

≪

≫

structures in Fig. 4 for the far zone. In fact, as we have seen, the ﬁeld in the
far region and the virtual source are linked, basically, by a Fourier transform.
In principle, this allows to qualitatively describe the situation at the virtual
source through the reciprocal relation. However, as we have said before,
when ˆφ
1, in the far zone we have ﬁne structures with variable width δθ
(see also Fig. 4). As a result, in the limiting case ˆφ
1, use of the reciprocal
relation to describe the properties of the virtual source is problematic. For
example, a typical width δ ˆθ
1 should correspond to typical dimension
of the virtual source of order unity, that is in obvious disagreement with
Fig. 8. Nonetheless, we managed to speciﬁed the ﬁeld at the virtual source
by means of numerical techniques, even in the case ˆφ
1 (see Fig. 8).
Once the ﬁeld at the virtual source is speciﬁed for any value of ˆφ, Fourier
Optics can be used to propagate it. In free space, the Fresnel formula must
be used. However, we prefer to proceed in another way. There is, in fact,
an alternative way to obtain the solution to the ﬁeld propagation problem
valid for any value of ˆφ and capable of giving a better physical insight for
large values of ˆφ.

≫

≫

∼

40

^

I(a.u.)

^

0

5

10

15

20

^

r

Fig. 8. Intensity distribution at the virtual source for the setup in Fig. 3 for ˆφ = 50
(enlargement of the bottom right graph in Fig. 7).

5.2.2 Edge radiation as a superposition of the ﬁeld from two virtual sources

Let us begin considering the far ﬁeld in Eq. (69). This can also be written as

(88)

(89)

~
E

zo, ~θ
(cid:17)
(cid:16)
e
where

= ~
E1

e

zo, ~θ
(cid:17)
(cid:16)

+ ~
E2

e

zo, ~θ
(cid:17)
(cid:16)

~
E1,2

e

=

zo, ~θ
(cid:17)
(cid:16)

2e~θ
czo(θ2 + 1/γ2)

±

exp

iωL
4cγ2 #

"±

exp

iωLθ2
2c

"

zo
L ±

1
2 (cid:19)#

.

(cid:18)

~
E1 and

~
E2 represent two spherical waves respectively cen-
The two terms
tered at z = L/2 and z =
L/2, that is at the edges of the straight section.
e
Analysis of Eq. (89) shows that both contributions to the total ﬁeld are
peaked at an angle of order 1/γ. While, as has been seen before, the total
ﬁeld in dimensional units explicitly depends on the straights section length

e

−

41

e

~
E1 and

~
E1 and

~
E2 exhibit dependence on L through phase
L, the two expressions
factors only. This fact will have interesting consequences, as we will discuss

e
~
E2 may be thought
later. The two spherical waves represented by
as originating from two separate virtual sources located at the edges of the
straight section. One may then describe the system with the help of two
separate virtual sources, and interpret the ﬁeld at any distance as the super-
position of the contributions from two edges. This viewpoint is completely
equivalent to that considered before involving a single virtual source in the
straight line center. We are presenting here a diﬀerent description of the
same phenomenon. As we have seen before, we could not specify, analyti-
cally, the single virtual source in the center of the straight line. In contrast to
this it is possible to specify the two virtual sources at the edges of the setup.
In order to so so we take advantage of a slightly modiﬁed version of Eq. (13)
that accounts for an arbitrary position of the source zs(1,2):

e

e

=

zs(1,2), ~r
⊥
(cid:16)

(cid:17)

~
E

e

iωzo
2πc Z

d~θ

exp

×

"−

iωθ2
2c

(cid:16)

zo + zs(1,2)

exp

zo, ~θ
(cid:17)

(cid:16)

iω
c

~r
⊥ ·

(cid:20)

,

~θ
(cid:21)

~
E1,2
#
(cid:17)

e

(90)

~
E2 into Eq. (90), and with the help of polar
Separately substituting
coordinates, we ﬁnd the following expressions for the ﬁeld at the virtual
source positions zs1 = L/2 and zs2 =

~
E1 and

L/2 13 :

e

e

−

L
2

, ~r

⊥(cid:19)

=

2ieω
c2γ

∓

(cid:18)±

exp

iωL
4cγ2 #

~r
⊥
r

K1

ωr
⊥
cγ !

 

,

"±

~
E

e

(91)

13 It should be noted here that the virtual sources are singular in the point r
= 0,
⊥
due to the behavior of the modiﬁed Bessel function K1. In footnote 10 we associated
the singularity of the undulator ﬁeld with the resonance approximation. Similarly
we can state here that paraxial approximation is valid, in the far zone, for angles
of observation much smaller than unity. As a result, features near the downstream
edge of the straight section cannot be resolved in paraxial approximation because
they depend on far ﬁeld data at large angles. Analysis of Eq. (91) shows that the
intensity associated to each source exhibits a weak, logarithmic singularity of the
= 0. This corresponds to a logarithmic divergence
ﬂux in the near zone around r
of the ﬂux in the far zone at large angles. These divergences, in the near as well as in
the far zone are outside the region of applicability of our approximation, because
we discuss the far-zone ﬁeld within angles much smaller than unity as well as
Ż, where we have no singularity
near-zone ﬁeld for transverse displacements r
at all.

⊥ ≫

⊥

42

q

where K1(
) is the modiﬁed Bessel function of the ﬁrst order. Analysis of Eq.
·
(91) shows a typical scale related to the sources dimension of order cγ/ω in
ˆφ in normalized units. This is in
dimensional units, corresponding to 1/
agreement with the fact that both source contributions to the far ﬁeld are
ˆφ. Note that this remark is only qualitative.
peaked at an angle of order
The peak angle in the far zone does not correspond univocally to the width
ˆφ of the virtual sources
of the ﬁeld distribution, nor the typical scale 1/
can be univocally associated to the width of the sources. Also note that
since the far zone ﬁeld in dimensional units exhibit dependence on L only
through phase factors only has its counterpart in the fact that the ﬁeld at the
virtual sources, written in dimensional units, exhibit dependence on L only
through phase factors as well.

q

q

Application of the Fresnel formula allows to calculate the ﬁeld at any dis-
tance zo in free space. Of course, Eq. (91) can also be used as input to any
Fourier code to calculate the ﬁeld evolution in the presence of whatever
optical beamline. However, we restrict ourselves to the free-space case.
Taking advantage, once more, of polar coordinates and using the deﬁnition
~ˆθ = ~ˆr
⊥
units:

/ˆzo we obtain the following scaling law for the intensity in normalized

ˆI

ˆzo, ~ˆθ
(cid:19)

(cid:18)

= const

i ˆφ/4

2i

q

~ˆθ
ˆθ

ˆφ exp
ˆzo −

h
1/2

exp

i

i ˆθ2 ˆz2
o
1/2)#
2 (ˆzo −

"

·

−






(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

∞

×

Z
0

+ 

~ˆθ
ˆθ

∞




×

Z
0

dˆr′
⊥

ˆr′
⊥

K1

ˆφˆr′

J1

⊥!

 

  q

ˆθˆr′
ˆzo
⊥
ˆzo −
1/2!

exp

iˆr′2
⊥
2 (ˆzo −

"

2i

ˆφ exp
−
ˆzo + 1/2

h

q

i ˆφ/4

exp

i

i ˆθ2 ˆz2
o
2 (ˆzo + 1/2)#

"


1/2)#



dˆr′
⊥

ˆr′
⊥

K1

ˆφˆr′

J1

  q

⊥!

ˆθˆr′
ˆzo
⊥
ˆzo + 1/2!

 

exp

"

2

.

iˆr′2

⊥
2 (ˆzo + 1/2)#



(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(92)

In the limit for ˆzo ≫
in normalized units. Similarly, in the limit for ˆφ

1 Eq. (92) gives back the square modulus of Eq. (89)
1, and using the fact
ˆφ) one recovers the square modulus of Eq. (83). In
that K1(
general, the integrals in Eq. (92) cannot be calculated analytically, but they
can be integrated numerically.

ˆφˆr
⊥

1/(ˆr

⊥ q

≪

q

≃

)

43

^

I(a.u.)

6

x 5 10

 

 

^

I(a.u.)

3

x 5 10

^

I(a.u.)

5

x 3 10

 

 

^

I(a.u.) 

  x 1

^

^

z

^

z

0

2

4

6

8

10

12

14

16

18

20

0

2

4

6

8

10

12

14

16

18

20

^

^
^

^

z

^

z

0

2

4

6

8

10

12

14

16

18

20

0

2

4

6

8

10

12

14

16

18

20

^

^

Fig. 9. Intensity proﬁle for edge radiation for ˆφ = 50. These proﬁles are shown as a
function of angles at diﬀerent observation distances ˆzo = 0.52, ˆzo = 0.6, ˆzo = 1.5 and
ˆzo = 100.0.

First we checked that we are able to recover, posing ˆzo = 0, the intensity
proﬁle for the single virtual source, already calculated numerically and
shown in Fig. 7 and Fig. 8. Then we propagated the ﬁeld at non-virtual
positions, for ˆzo > 1/2. In Fig. 9 we plotted, in particular, results for the
propagation in case ˆφ = 50. Radiation proﬁles are shown as a function of
angles ˆθ at diﬀerent observation distances ˆzo = 0.52, ˆzo = 0.6, ˆzo = 1.5 and
ˆzo = 100.0.

From a technical viewpoint, it is easier to deal with two sources than with
one, because the expression for the virtual two sources is analytical, whereas
that for a single one is not. Moreover, as said before, the two-sources picture
gives new physical insight for the asymptotic limit ˆφ

1.

≫

≪

Qualitatively, we can deal with two limiting cases of the theory, the ﬁrst for
ˆφ

1 and the second for ˆφ

≫
Let us ﬁrst discuss the case ˆφ
given by Eq. (83). There are only two observation zones of interest.

1. The ﬁeld at any observation distance is

≪

1.

Far zone. In the limit for ˆzo ≫

•

1 one has the far ﬁeld Eq. (85).

44

Near zone. When ˆzo . 1 instead, one has the near ﬁeld Eq. (83).

•

after which the integrands in dˆr′
⊥

As it can be seen from Eq. (83), the total ﬁeld is given, both in the near
and in the far zone, by the interference of the two virtual sources located at
the straight section edges. Eq. (92) shows that the transverse dimension of
these virtual sources is given by γŻ in dimensional units. This is the typical
scale in r′
in Eq. (92) are suppressed by
⊥
the function K1. Thus, the sources at the edges of the straight section have
a dimension that is independent of L. In the center of the setup instead, the
virtual source has a dimension of order √ŻL as it can be seen Eq. (82). When
ˆφ
1 the source in the center of the setup is much smaller than those at the
edge. This looks paradoxical. The explanation is that the two contributions
due to edge sources interfere in the center of the setup. In particular, when
ˆφ
1 they nearly compensate, as they have opposite sign. As a result of
this interference, the single virtual source in the center of the setup (and its
far-zone counterpart) has a dimension dependent on L (in non-normalized
units) while at the edges (and in their far-zone counterpart) the dependence
on L is limited to phase factors only. Due to the fact that edges contributions
nearly compensate for ˆφ
1 one may say that the single-source picture is
particularly natural in the case ˆφ

≪

≪

≪

1.

≪

≫

Let us now discuss the case ˆφ
1. In this situation the two-sources picture
becomes more natural. Let us deﬁne with d1,2 = zo ∓
L/2 the distances of
the observer from the edges. As seen before, the transverse dimension of
γŻ. Moreover, we see
the sources at the edges of the straight section is r′
from Eq. (67) and Eq. (68) that when ˆφ
1 the formation length is L f = γ2Ż,
much shorter than the system dimension L. As a result, one can recognize
four regions of interest, that are more naturally discussed in the two-source
picture.

⊥ ∼

≫

•

•

•

Two-edge radiation. Far zone. When d1,2 ≫
L we are summing far ﬁeld
contributions from the two edge sources. This case is well represented
in Fig. 9 for ˆzo = 100, where interference eﬀects between the two edges
contribution are well visible.
Two-edge radiation. Near zone. When d1,2 ∼
L the observer is located
far away with respect to the formation length of the sources L′f . Both
contributions from the sources are important, but that from the nearest
source begins to become the main one, as d1 and d2 become sensibly
diﬀerent. This case is well represented in Fig. 9 for ˆzo = 1.5.
Single-edge radiation. Far zone. When γ2Ż
L the contribution
due to the near edge is dominant, while the far edge contribution is negli-
gible. Such tendency is clearly depicted in Fig. 9 for ˆzo = 0.6. Interference
tends to disappear as the near edge becomes the dominant one, while the
intensity distribution tends to approximate

d1 ≪

≪

45

I (θ) = const

~
E2 (zo, θ)

= const

2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

× (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

e

4e2
c2z2
o

γ4θ2
γ2θ2 + 1

×

2 ,

(cid:0)

(cid:1)

•

~
E2 is the single edge far ﬁeld limit in Eq. (89).

where
Single-edge radiation. Near zone. When 0 < d1 . γ2Ż we have the near-
ﬁeld contribution from a single edge. As d1 becomes smaller and smaller
the intensity distribution tends to reproduce the singular behavior from
a single virtual source, i.e. the square modulus of Eq. (91):

e

I

L
2

(cid:18)

⊥(cid:19)

, ~r

= const

~
E

L
2

(cid:18)

, ~r

= const

e
This tendency can be seen in Fig. 9 for ˆzo = 0.52.

4e2

×

γ2Ż2c2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

K1

 

2

.

r

⊥

γŻ!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2

⊥(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

× (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(93)

(94)

It should be noted that the straight section contribution has been calculated
within the applicability region of the paraxial approximation, but indepen-
dently of all assumptions on the switchers. If switchers or other setup parts
are present, their contribution must be separately calculated and added to
the contribution due to the straight section. For instance, if an observer is
placed after a switcher located downstream of the straight section, the ﬁeld
due to the straight section has physical meaning (i.e. the theoretical inten-
sity can be compared with experiment) only if the zero-length switchers
approximation can be applied. Otherwise it is just a mathematically conve-
nient term, a partial result to be summed with the switcher contribution.
If, instead, the observer is placed on a transverse plane placed before the
switcher, at the downstream edge of the straight section, the switcher (or
any other part of the setup following the straight section) will not inﬂu-
ence the ﬁeld with ultra-relativistic accuracy. Eq. (91) (or Eq. (94)) can then
be compared with experimental results. As has been discussed in footnote
= 0 is fundamentally related with our
13, the singularity in the ﬁeld at r
ignorance about the structure of the electron.

⊥

It should be noted that our Eq. (91) is identical to the frequency-domain
expression for the transverse component of the ﬁeld originating from an
ultra-relativistic electron moving with constant velocity (see [21]). In fact,
our treatment for the straight-section contribution in the case of single-edge
radiation in the near zone gives, within an accuracy of 1/γ2, the same result
found in [21] for bremsstrahlung in a collision between an ultra-relativistic
electron and an atomic nucleus by means of the method of virtual quanta.
In the bremsstrahlung case the electron harmonic is switched oﬀ within a
Ż even in the model for an electron on a uniform motion, be-
length ds ≪
cause non-negligible contributions to the ﬁeld are generated by the part of
the trajectory before the nucleus only, while the trajectory after the nucleus
gives negligible contribution within an accuracy 1/γ2. Exact calculation,
retaining all parts of the Lienard-Wiechert ﬁeld show that the ﬁeld from

46

the relativistic particle is equivalent to two virtual pulses of radiation. One
moves longitudinally, i.e. in the same direction as the electron. A second
moves transversely, i.e. perpendicularly with respect to the electron direc-
tion. As already said, the component of the frequency spectrum due to the
longitudinal pulse is given by our Eq. (91). At any observation position, the
component due to the transverse pulse can be neglected with an accuracy
1/γ2. In other words, the weak transverse pulse is a correction to the main
longitudinal pulse. It may be interpreted as an evanescent wave decaying in
the longitudinal direction, since it propagates transversely, i.e. at large angle
π/2 with respect to the z axis. Dropping this term gives back our result, that
was found in the paraxial approximation.

Our previous result in Eq. (91) constitutes a novel ﬁnding in theory of edge
radiation dealing with the situation of a particle in straight motion. The case
of a particle in straight motion is of fundamental importance, because of
two reasons. First, our result can be applied to any setup where the zero-
length switchers approximation applied. Second, straight sections are basic
building blocks for any magnetic setup, and our expression for the near
ﬁeld from a straight section can be used, as part of the total ﬁeld, also in the
case when the zero-length switchers approximation fails.

5.3

Supplementary remarks on the zero-length switcher approximation

≫

For the sake of completeness it remains to qualitatively discuss the condi-
tions when the ﬁeld due to switchers is negligible, because in this case one
can work in the ”zero-length switchers approximation”. We consider the
case when switchers are present in the form of bending magnets. In par-
ticular, here we report results from an analysis of the problem in the limit
γ2Ż. In this case the formation length associated with the straight sec-
L
tion is given by γ2Ż, while the formation length associated with the bending
magnet is given by (Żρ2)1/3, ρ being the radius of the bend. The ratio be-
tween the latter and the former is indicated with ǫ2 = (λc/λ)2/3
1, where
λc = 4πρ/(3γ3) is the critical wavelength for SR from the bend and we as-
λc, as we are interested in edge radiation. The product between
sumed λ
the small quantity ǫ and the formation length for the straight section is
indicated with dc = ǫγ2Ż, and turns out to constitute an extra characteristic-
length for our system. Let us indicate with d the distance between a trans-
verse plane of observation and the downstream edge of the straight section.
At very short distances, for d
dc, the straight section contribution domi-
nates the bending magnet one for transverse displacements from the z-axis
< ǫγŻ the two contributions are
r
⊥
comparable. Note that in this area the contribution from the straight section
< γŻ due to singular behavior
is much larger than in the area for ǫγŻ < r

> ǫγŻ. Within the area r

of order r

≫

≪

≪

⊥

⊥

⊥

47

x

Screen

zo

A

B

z

C

D

Fig. 10. Edge radiation geometry. The beam enters the system through a bending
magnet, passes a straight section, an undulator and another straight section before
leaving the setup through another bend. Radiation is collected at a distance zo from
the origin of the reference system, located in the middle of the undulator.

of the ﬁeld contribution from the straight section at r
dc
the zero-length switcher approximation cannot be used, and contributions
from the bend should be calculated explicitly. When γ2Ż & d
dc we have
room for direct application of our theory for the straight section within the
(Ż2ρ)1/3, because the characteristic size of the radiation is
range 0 < r
γ2Ż, we have room for direct application of our
ǫ(Ż2ρ)1/3. Finally, for d
(Ż/ρ)1/3,
theory for the straight section within the angular range 0 < θ
because the characteristic angle of the radiation is ǫ(Ż/ρ)1/3.

0. When d

⊥ −→

⊥ ≪

≫

≫

≪

∼

6 A more sophisticated application. Transition undulator radiation

In this Section we apply the method described in Section 2 to the more
complicated case of an undulator setup.

Instead of the setup in Fig. 3, we now consider the system depicted in
Fig. 10 and we consider a single particle moving along the system. The
electron enters the setup via a bending magnet, passes through a straight
section (segment AB), an undulator (segment BC), and another straight
section (segment CD). Finally, it exit the setup via another bend. Radiation
is collected at a distance zo from the center of the reference system, located in
the middle of the undulator. The passage of the electron through the setup
results in collimated emission of radiation in the low photon energy range,
a mechanism analogous to transition radiation. This kind of radiation is
known in literature as TUR [14, 8, 15, 16, 17, 18], even though in this paper

48

we prefer to denote it as edge radiation from undulator setup.

In our case of study the trajectory and, therefore, the space integration in
Eq. (17) can be split in ﬁve parts: the two bends, that will be indicated with
b1 and b2, the two straight sections AB and CD and the undulator BC. One
may write

(zo, ~r
⊥

~
E

⊥
e

o, ω) = ~
Eb1(zo, ~r
⊥
+~
ECD(zo, ~r
e
⊥

o, ω) + ~

EAB(zo, ~r
⊥
Eb2(zo, ~r
⊥

o, ω) + ~
e

o, ω) + ~
o, ω) ,

e

EBC(zo, ~r
⊥

o, ω)

with obvious meaning of notation.

e

e

We will denote the length of the segment AD with Ltot, while we will indicate
the length of the straight section AB with L1, the length of the straight section
CD with L2 and the length of the undulator with Lw. It follows

(95)

(96)

Ltot = L1 + Lw + L2 .

This means that point A is located at longitudinal coordinate zA =
while B, C and D are located respectively at zB =
zD = Lw/2 + L2.

Lw/2,
−
Lw/2, zC = Lw/2 and

L1−

−

First, with the help of Eq. (17) we will derive an expression for the ﬁeld in the
far zone. The intensity distribution in this case, results to be in agreement
with that given in [8]. Then, we will calculate the ﬁeld distribution at the
virtual source with the help of Eq. (13). Finally, Eq. (5) will allow us to ﬁnd
an expression for the ﬁeld both in the near and in the far zone. We will
the turn to analyze the case when a undulator is present, and describe the
ﬁeld from the setup as superposition of three laser-like beam from straight
sections and undulator. In the following we will ignore the presence of the
bending magnets, i.e. the radiation switchers. As before, we will treat them
as if they had zero length. As a result, Eq. (95) can be simpliﬁed to

~
E

⊥
e

(zo, ~r
⊥

o, ω) = ~

EAB(zo, ~r
⊥

o, ω) + ~

EBC(zo, ~r
⊥

o, ω) + ~

ECD(zo, ~r
⊥

o, ω) .

(97)

e

e

e

We already addressed the question of the applicability region of the ”zero-
length switcher approximation” in previous Section 5.

49

6.1

Far ﬁeld from the undulator setup

Let us describe the far ﬁeld from the undulator setup in Fig. 10 by separately
characterizing the ﬁeld contributions along undulator, straight sections and
bends and ﬁnally adding them together.

6.1.1

Field contribution calculated along the undulator

~
EBC from the undulator, following [1].
We ﬁrst consider the contribution
Assuming a planar undulator we write the following expression for the
e
transverse velocity of an electron:

(z′) =

~v
⊥

cK
γ

−

sin (kwz′)~x ,

(z′) =

~r′

⊥

K
γkw

cos (kwz′)~x .

that is Eq. (52). Here K is the undulator parameter deﬁned in Eq. (51). More-
over, kw = 2π/λw, where λw is the undulator period, so that the undulator
length is L = Nwλw. The transverse position of the electron is therefore

An expression for the curvilinear abscissa s as a function of the longitudinal
position z′ is given by

s(z′) =

β
βav

z′

−

K2
8γ2kw

sin (2kwz′) ,

where βav is the time-averaged velocity along the z direction, that can be
expressed as:

βav = β

K2
4γ2 !

.

1
 

−

We can now substitute Eq. (99) and Eq. (98) in Eq. (17). Such substitution
leads to a general expression, valid for any observer distance zo. It is possible
to obtain, similarly to many SR textbooks, a simpliﬁed expression valid in
the limit for large values of zo. Since we are interested in the contribution
of the undulator device to the total ﬁeld at the observer position, we will
1 in
integrate Eq. (17) only along the undulator. Then all terms in (zo −
the phase factor of Eq. (17) can be expanded around zo. In the far ﬁeld limit
we can retain ﬁrst order terms in z′. Dropping negligible terms we obtain

z′)−

50

(98)

(99)

(100)

(101)

~
EBC(zo, ~r
⊥

o, ω) =

iωe
c2zo

dz′exp [iΦBC]

sin (kwz′) + θx

~x + θy~y

, (102)

#

)

K
γ

("

zC

Z
zB

e

where

zo +

z′
2c  

1
γ2
z

+ θ2

x + θ2

Kθx
γkwc

y! −

cos(kwz′)

x + θ2
θ2
y
2c

ΦBC = ω 

K2

8γ2kwc

−

sin(2kwz′)

.

)

The longitudinal Lorentz factor γz in Eq. (103) is deﬁned by

γz =

γ
√1 + K2/2

and is always smaller than γ, because the average longitudinal velocity
of the electron inside the undulator is smaller than that along the straight
sections.

In this paper we will be interested up to frequencies much lower than the
14 . Then, the contribution due to the
resonance frequency, i.e. ω
term in sin(kwz′) in Eq. (102) can always be neglected when compared with
the maximal ﬁeld magnitude of the terms in θx,y. Similarly, in Eq. (103),
phase terms in cos(kwz′) and sin(2kwz′) can can also be neglected. As a result,
Eq. (102) can be simpliﬁed as

zckw

2γ2

≪

~
EBC(zo, ~r
⊥

o, ω) =

iωe
c2zo

zC

Z
zB

dz′exp [iΦBC]

θx~x + θy~y
(cid:16)

(cid:17)

e

while

ΦBC = ω

x + θ2
θ2
y
2c

zo +

z′
2c  

1
γ2
z





+ θ2

x + θ2

.

y!


14 Although we are outside of the applicability range of the resonance approxima-
tion, we still assume that the number of undulator period Nw is large, i.e. Nw
1
to calculate the undulator contribution. As a result, the accuracy related with the
undulator contribution is 1/(2πNw), and not 1/γ2 as in the straight section case. It
follows that results regarding the undulator contribution to the ﬁeld are not as fun-
damental as those regarding the straight section, because the extra approximation
Nw

1 has been used, that is speciﬁc for the undulator device.

≫

≫

51

(103)

(104)

(105)

(106)

(107)

(110)

(111)

Finally, note that within these approximations, the curvilinear abscissa s in
Eq. (100) can be simpliﬁed to

s(z′) =

z′ .

β
βav

6.1.2

Field contribution calculated along the straight sections

Let us now calculate the curvilinear abscissa along segments AB and CD. Eq.
(107) implies that the curvilinear abscissa at the undulator edges z′ =
Lw/2
βLw/(2βav). Moreover the curvilinear abscissa must be of the
is given by
form s(z′) = z′ + const., because segments AB and CD are straight lines. It
follows that

±

±

s(z′) = z′ +

Lw
2  

1

−

β
βav ! ≃

z′ +

Lw
4γ2 −

Lw
4γ2
z

for zA < z′ < zB

(108)

and

s(z′) = z′

Lw
2  

1

−

β
βav ! ≃

−

z′

−

Lw
4γ2

+

Lw
4γ2
z

for zC < z′ < zD ,

(109)

With the help of Eq. (17) we write the contribution from the straight line AB
as

where we have used the fact that

1
βav ≃

1 +

1
2γ2
z

.

~
EAB =

iωe
c2zo

e

zB

Z
zA

dz′ exp [iΦAB]

θx~x + θy~y
(cid:16)

(cid:17)

where ΦAB in Eq. (111) is given by

ΦAB = ω

x + θ2
θ2
y
2c

zo −

Lw
4cγ2
z

+

Lw
4cγ2

+

z′
2c  

1
γ2

+ θ2

x + θ2

,

(112)

y!






θx = x/zo and θy = y/zo being the observation angles in the horizontal and
c when calculating the term
vertical direction. Note that we also used v

≃

52

Lw/(4cγ2
to that from the straight line AB and reads

z) in Eq. (112). The contribution from the straight line CD is similar

~
ECD =

iωe
c2zo

e

zD

Z
zC

dz′ exp [iΦCD]

θx~x + θy~y
(cid:16)

(cid:17)

where ΦCD in Eq. (113) is given by

ΦCD = ω

x + θ2
θ2
y
2c

zo +

Lw
4cγ2

z −

Lw
4cγ2

+

z′
2c  

1
γ2

+ θ2

x + θ2

.

(114)

y!






In general, the phases ΦCD and ΦAB start exhibiting oscillatory behavior
when ωz′/(2cγ2)
1, which gives a maximal integration range in the longi-
tudinal direction. Similarly as before, in general one has that the formation
lengths Lfs1 and Lfs2 for the straight sections AB and CD can be written as

∼

Lfs(1,2) ∼

min

λγ2, L(1,2)

.

h

i

Depending on the wavelength of interest then, Lfs(1,2) ∼

λγ2 or Lfs(1,2) ∼

L(1,2).

6.1.3

Total ﬁeld and energy spectrum of radiation

Consider Eq. (97). The contributions for segment AB and segment CD are
given by Eq. (111) and Eq. (113). One obtains

~
EAB =

−

e

2e

θx~x + θy~y
(cid:16)
1/γ2 + θ2
(cid:16)
exp

(cid:17)
x + θ2
czo
y
ω(L1 + Lw/2)
2c
1
γ2

+ θ2

ωLw
4c  

"−

"−

(cid:17)

i

i

× (

exp

−

iω



+ θ2

exp

1
γ2

 

x + θ2
θ2
y
2c

x + θ2

y!#

zo


x + θ2

y!#)

exp

iωLw
4cγ2
z

+

iωLw
4cγ2 #

"−

that can also be written as

~
EAB =

iωeL1
c2zo

~θsinc

e

exp

×

iωLw
4c

"−

ωL1
4c  
1
γ2
z

"

 

1
γ2

+ θ2

exp

!#

+ θ2

exp

!#

"−

iωθ2zo
2c
1
γ2

"
iωL1
4c  

#

+ θ2

!#

53

(113)

(115)

(116)

(117)

Similarly,

~
ECD =

−

e

2e

θx~x + θy~y
(cid:16)
1/γ2 + θ2
(cid:16)

(cid:17)
x + θ2
czo
y
ω(L2 + Lw/2)
2c

exp

(cid:17)

iω



+ θ2

exp

1
γ2

 

x + θ2
θ2
y
2c

x + θ2

y!#

zo


× (−

+ exp

i
"

i
"
ωLw
4c  

1
γ2

+ θ2

x + θ2

.

y!#)

exp

iωLw
4cγ2

"

z −

iωLw
4cγ2 #

that can also be written as

~
ECD =

iωeL2
c2zo

~θsinc

ωL2
4c  

1
γ2

+ θ2

e

exp

×

iωLw
4c

"

 

+ θ2

exp

!#

"
1
γ2
z

"

exp

!#
iωL2
4c  

"

1
γ2

iωθ2zo
2c

#

+ θ2

!#

Finally, the contribution for the segment BC is written as in Eq. (105). Cal-
culations yield:

~
EBC =

e

2e

θx~x + θy~y
(cid:16)
z + θ2
1/γ2
(cid:16)

−

x + θ2
y
iωLw
4c
"
iωLw
4c

 
1
γ2
z

 

exp

"−

× (−

+exp

x + θ2
θ2
y
2c

zo


exp

iω



x + θ2

+ θ2

(cid:17)
czo
(cid:17)
1
γ2
z

y!#

+ θ2

x + θ2

.

y!#)

that can be written as

~
EBC =

iωeLw
c2zo

~θsinc

ωLw
4c  

1
γ2
z

"

+ θ2

exp

!#

iωθ2zo
2c

"

#

e

The total ﬁeld produced by the setup is obtained by summing up Eq. (116),
Eq. (118) and Eq. (121). Note that the same deﬁnition for the observation
angle ~θ = ~r
/zo is used in these equations. This means that the observation
⊥
angle is measured starting from the center of the undulator, located at z = 0.
The energy density of radiation as a function of angles and frequencies can
be written substituting the resultant total ﬁeld in Eq. (73). We obtain

54

(118)

(119)

(120)

(121)

dW
dωdΩ

=

+ exp

i

"−
1/γ2 + θ2
1/γ2

+

z + θ2 (−
iωLw
4cγ2  
ωL2
2cγ2

"−

i
"

(cid:16)

+exp

exp

−

e2
π2c
ωL1
(cid:0)
2cγ2

γ4θ2
1 + γ2θ2

(cid:1)
1 + γ2θ2
(cid:16)

2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

exp

i

"−

−

i

ωLw
4cγ2  
K2
2

1 +

−

(cid:17)
iωLw
4cγ2  

ωLw
4cγ2  
K2
2

1 +

+ γ2θ2

K2
2

1 +

+ γ2θ2

!#

+ γ2θ2

!#

exp

"
K2
2

!#)

iωLw
4cγ2  

1 +

K2
2

1 + γ2θ2

+

(cid:17)

!#
ωLw
4cγ2  

i
"

+ γ2θ2

K2
2

2

,

!# (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1 +

+ γ2θ2

+ exp

1 +

+ γ2θ2

that is equivalent to the analogous expression in [8].

!#

(122)

6.2 Virtual source characterization and ﬁeld propagation

Expressions in Eq. (117), Eq. (119) and Eq. (121) can be interpreted as far
ﬁeld radiation from separate virtual sources. Note that the same deﬁnition
for the observation angle ~θ = ~r
/zo is used in these equations. Let us ﬁnd the
⊥
locations of the virtual sources. We will see that these locations corresponds
to points along the longitudinal axis where wavefronts are plane, i.e. where
maximal simpliﬁcation arises.

When F(0) is real, Eq. (12) describes the far ﬁeld in terms of a spherical wave
centered at z = 0. In the more generic case of a spherical wave centered
at some position zs Eq. (12) should be substituted by Eq. (11) with z =
zs, as the typical phase phase factor of a spherical wave centered in zs
is exp[iωθ2(zo + zs)/(2c)]. In this case F(zs) in Eq. (11) is a real function.
Accordingly, Eq. (13) should be modiﬁed to Eq. (14). Once we substitute Eq.
(117), Eq. (119) or Eq. (121) in Eq. (14), there are particular values of zs (zs1
for the segment AB, zs2 for BC and zs3 for CD) such that the phase in θ2 is
cancelled and that

) gives a plane wave. These are:

E(zs, ~r
⊥

zs1 =

Lw
2 −

−

e
,

L1
2

zs2 = 0

and

zs3 =

Lw
2

+

L2
2

.

55

(123)

(124)

(125)

Substituting Eq. (117), Eq. (119) and Eq. (121) into Eq. (14) we obtain the
following plane wavefronts describing the three virtual sources at positions
zs1, zs2 and zs3:

~
EAB

(cid:0)

e

zs1, ~r
⊥

(cid:1)

=

ω2eL1
2πc3 exp

−

"−

× Z

Lw
γ2
z

iω
4c  
ωL1
4c  

"

+

L1
γ2 !#
1
γ2 !#

d~θ ~θ sinc

θ2 +

exp

(126)

iω
c

~r
⊥ ·

(cid:20)

,

~θ
(cid:21)

~
EBC(zs2, ~r
⊥

) =

ω2eLw
2πc3 Z

−

d~θ ~θ sinc

ωLw
4c  

"

θ2 +

1
γ2
z !#

exp

iω
c

~r
⊥ ·

(cid:20)

~θ
(cid:21)

(127)

e

and

~
ECD

(cid:0)

e

zs3, ~r
⊥

(cid:1)

=

ω2eL2
2πc3 exp

iω
4c  

"

−

d~θ ~θ sinc

× Z

+

Lw
γ2
z
ωL1
4c  

L2
γ2 !#
1
γ2 !#

θ2 +

"

exp

iω
c

~r
⊥ ·

(cid:20)

.

~θ
(cid:21)

(128)

Note that L1, L2 and Lw can assume diﬀerent values. γ and γz are also dif-
ferent. It may therefore seem convenient to introduce diﬀerent normalized
quantities, referring to the undulator and the straight lines. However, in
the end we are in summing up contribution all contributions from diﬀer-
ent sources, so that it is important to keep a common deﬁnition of vertical
displacement (or observation angle). Therefore we prescribe the same nor-
malization for all quantities:

~ˆθ =

ωLtot
c

~θ ,

r

ˆφ =

ωLtot
γ2c

,

and

=

~ˆr
⊥

ω
Ltotc

.

~r
⊥

r

(129)

(130)

(131)

Then, we introduce parameters ˆL1 = L1/Ltot, ˆL2 = L2/Ltot, ˆLw = Lw/Ltot and
ˆφw = γ2/γ2
ˆφ. Finally, we deﬁne ˆzs = zs/Ltot. Eq. (126), Eq. (127) and Eq. (128)
z
can then be written as

56

~ˆEAB

ˆz1,~ˆr
⊥

=

−

(cid:17)

(cid:16)

ˆL1 exp

i
4
(cid:20)−
d~ˆθ ~ˆθ sinc

ˆLw ˆφw + ˆL1 ˆφ
(cid:16)
ˆL1
4

(cid:17)(cid:21)
ˆθ2 + ˆφ
(cid:17)

"

(cid:16)

× Z

exp

#

i~ˆr
(cid:20)

⊥ ·

~ˆθ
(cid:21)

,

~ˆEBC(ˆz2,~ˆr

) =

⊥

−

ˆLw

Z

d~ˆθ ~ˆθ sinc

ˆLw
4

"

(cid:16)

ˆθ2 + ˆφw

exp

#
(cid:17)

i~ˆr
(cid:20)

⊥ ·

~ˆθ
(cid:21)

and

~ˆECD

ˆz3,~ˆr
⊥
(cid:16)

(cid:17)

=

ˆL2 exp

−

i
4
(cid:20)
d~ˆθ ~ˆθ sinc

ˆLw ˆφw + ˆL2 ˆφ
(cid:16)
ˆL2
4

(cid:17)(cid:21)
ˆθ2 + ˆφ
(cid:17)

"

(cid:16)

× Z

exp

#

i~ˆr
(cid:20)

⊥ ·

~ˆθ
(cid:21)

where we deﬁned

~
E =

~ˆE .

ωe
c2

e

Besides factors in the sinc functions, the integrals in Eq. (132), Eq. (133) and
Eq. (134) are mathematically identical to Eq. (79). One may check that, in
the limit for ˆφ
1 one obtains the same results as for edge
radiation from a single straight section.

1 and ˆφw ≪

≪

Besides this obvious limit, there is a second region of interest in the param-
eter space that can be dealt with analytically and corresponds to ˆφ
1 and
ˆφw ≫
1. In this particular limit, the contribution from the undulator, Eq.
(133) can be neglected, because the sinc(
) is strongly suppressed. In this
·
case one has the following virtual sources:

≪

~ˆE(ˆz1,~ˆr

) =

⊥

4~ˆr
⊥
ˆL1

exp

iˆLw ˆφw
4

sinc





2

/ˆL1

,

(cid:19)

~ˆr
(cid:18)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)


−







~ˆE(ˆz2,~ˆr

0 ,

)

⊥

≃

~ˆE(ˆz3,~ˆr

) =

⊥

4~ˆr
⊥
ˆL2

exp

iˆLw ˆφw
4

2

/ˆL2

,

(cid:19)

sinc





~ˆr
(cid:18)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)

57

(132)

(133)

(134)

(135)

(136)

(137)

(138)

Note that the previous three equations describe virtual sources characterized
by plane wavefronts. Application of the Fresnel propagation formula, Eq.
(5) allows one to reconstruct the ﬁeld both in the near and in the far region.
Results can directly be obtained from Eq. (83) accounting for the fact that
we want to calculate contributions at the same observation point, which
zs(1,2,3))/L(1,w,2). From Eq. (83) we
requires substitution of zo/L(1,w,2) with (zo −
obtain the following results for the two surviving contributions:

~ˆEAB(ˆzo,~ˆr

) =

⊥

−

4~ˆr
⊥
ˆr2
⊥

exp

exp

× "

 −

iˆLw ˆφw
4


−


2(ˆzo −

ˆr2
⊥
2(ˆzo −





exp

i
"
iˆL1 ˆr2
⊥
ˆzs1)(ˆL1 + 2ˆzo −
iˆL1 ˆr2
⊥
ˆL1 + 2ˆzo −

−

 

2(ˆzo −

ˆzs1)(

exp

−

ˆzs1)#

2ˆzs1)!

.

2ˆzs1)!#

~ˆECD(ˆzo,~ˆr

) =

⊥

−

4~ˆr
⊥
ˆr2
⊥

exp

exp

× "

 −

iˆLw ˆφw
4




2(ˆzo −

exp

−

 

2(ˆzo −

ˆzs3)(



exp

ˆr2
⊥
2(ˆzo −

i
"

iˆL2 ˆr2
⊥
ˆzs3)(ˆL2 + 2ˆzo −
iˆL2 ˆr2
⊥
ˆL2 + 2ˆzo −

−

ˆzs3) #

2ˆzs3)!

.

2ˆzs3)!#

(139)

(140)

Eq. (139) and Eq. (140) solve the ﬁeld propagation problem for both the near
and the far ﬁeld in the limit for ˆφ
1. The directivity diagram is
obtained by summing up Eq. (139) and Eq. (140) and taking square modulus
of the sum.

1 and ˆφw ≫

≪

In the particular case L1 = L2 = Lw = Ltot/3 we obtain simpliﬁed expressions:

~ˆEAB(ˆzo,~ˆr

) =

⊥

−

4~ˆr
⊥
ˆr2
⊥
exp

exp

i
"

exp

ˆr2
⊥
2(ˆzo + 1/3)# "
iˆr2
⊥
6(ˆzo + 1/3)(2ˆzo + 1/3)!#

 −

−

 

iˆr2
⊥
6(ˆzo + 1/3)(1 + 2ˆzo)!

exp

.

i ˆφw
12 



−



(141)

~ˆECD(ˆzo,~ˆr

) =

⊥

−

4~ˆr
⊥
ˆr2
⊥

exp

i
"

ˆr2
⊥
2(ˆzo −

exp

1/3)# "

 −

6(ˆzo −

iˆr2
⊥
1/3)(2ˆzo −

1/3)!

58

exp

6(ˆzo −
The corresponding directivity diagram is given by

1)!#



−

 



iˆr2
⊥
1/3)(2ˆzo −

exp

.

i ˆφw
12 


ˆI

∼

exp

i
"

1

ˆθ2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

−

ˆz2
o

ˆθ2
2(ˆzo + 1/3)# "
iˆz2
o

exp

 −

exp

ˆθ2
6(ˆzo + 1/3)(2ˆzo + 1/3)!#

 

+ exp

exp

−

exp

ˆθ2
ˆz2
o
2(ˆzo −
1/3)# "
ˆθ2
iˆz2
o
1/3)(2ˆzo −

6(ˆzo −

i
"

 

 −

1)!#

exp

ˆθ2
iˆz2
o
6(ˆzo + 1/3)(1 + 2ˆzo)!
i ˆφw
12 

−


ˆθ2
iˆz2
o
1/3)(2ˆzo −
i ˆφw
12 
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)






2

1/3)!

6(ˆzo −
exp

(142)

(143)

Even though it refers to a particular case where L1 = L2 = Lw = Ltot/3,
1. Its dependence on ˆφw is
Eq. (143) still depends on the parameter ˆφw ≫
periodic, with period 12π. For the sake of exempliﬁcation, in Fig. 11 we plot
the intensity proﬁle for ˆφw = 12π at diﬀerent distances ˆzo and we compare
these proﬁles with the far ﬁeld asymptotic behavior. In Fig. 12 and Fig. 13
we plot, instead, the intensity proﬁle for diﬀerent values of ˆφw at ˆzo = 0.6
and in the asymptotic case for ˆzo ≫

1 respectively.

7 A critical re-examination of conventional edge radiation theory

In this Section we compare our ﬁndings with treatments of edge radiation
and TUR, that can be found in literature. Conventional understanding is
based on the zero-length switcher approximation. This allows direct com-
parison of results with the contributions calculated in the previous Section
5 and Section 6. Since there is a lot of literature dealing with edge radiation
and TUR we will limit ourselves to a few signiﬁcative works only. In par-
ticular, we will refer to [8], [12], [9] and [7], even though other works report
the same results. For example, the same understanding can be found in the
very recent 15 review [13].

We found agreement with literature as concerns calculations in the far-ﬁeld
zone.

As we have discussed before, the far-ﬁeld asymptotic is valid at observation

15 The year of writing is 2006.

59

^
I (a.u.)

^
I (a.u.)

2

4

10

12

14

2

4

6

8

10

12

14

8

6
^
z = 0.6

^
I (a.u.)

^
z = 1

^
I (a.u.)

q^

q^

2

4

6

8

10

12

14

2

4

6

8

10

12

14

^
z = 2

^
z = 10

^

w = 12 p

Fig. 11. Evolution of the intensity proﬁle for TUR for ˆφw = 12π . These proﬁles are
shown as a function of angles at diﬀerent observation distances ˆzo = 0.6, ˆzo = 1.0,
ˆzo = 2.0 and ˆzo = 10.0 (solid lines). The dashed line always refers to the far-zone
intensity.

≫

L, independently of ˆφ = L/(γ2Ż). It should therefore be
positions zo ≫
stressed that in the case ˆφ
1 one may be in the near zone even though the
observer is located many formation lengths γ2Ż from the downstream edge
(for example, when zo = L). In the far-zone case Eq. (69) gives the electric
ﬁeld in the far region. The correspondent directivity diagram, Eq. (78), is
plotted in Fig. 4, for diﬀerent values of the main parameter of the theory,
ˆφ. This result is well-known and in perfect agreement with literature. For
example one may see that, aside for proportionality factors due to diﬀerent
choice of units, there is agreement between the radiation energy density
in Eq. (75) and the photon ﬂux per unit solid angle in Eq. (18) of [8] (also
compare, qualitatively, Fig. 4 of that reference and our Fig. 4). Similarly, the
ﬁeld in Eq. (75) is in agreement with Eq. (17) of [12] or Eq. (31) of [9] (in the
limit for a large observation distance) accounting for the fact that the origin

q^

q^

60

f
^
I (a.u.)

^
I (a.u.)

2

6

8

10

12

14

2

4

6

8

10

12

14

4
^

w = ¼ (12 p n) 

^
I (a.u.)

^

w = ½ (12 p n) 

^
I (a.u.)

q^

q^

2

6

8

10

12

14

2

6

8

10

12

14

4

^

w = ¾ (12 p n) 

4

^

w = 12 p n 

^
z  =0.6

Fig. 12. Intensity proﬁles for TUR at ˆz0 = 0.6. at diﬀerent values ˆφw = (1/4)(12π),
ˆφw = (1/2)(12π), ˆφw = (3/4)(12π), ˆφw = (12π).

of the reference system is chosen at the exit of the straight section by the
author of [12] (also, the electron charge e is negative in that reference). Note
that in the far zone, the ﬁeld exhibits a spherical wavefront (independently
of the choice of coordinate system).

Diﬀerences between our results and results in literature arise, however, in
the near zone.

7.1 Near-ﬁeld edge radiation

≫

1. Let us pose d = zo −

Case for ˆφ
γ2Ż, we
have seen that the intensity proﬁle for edge radiation reproduces better and
better (as d decreases) the single edge source, i.e. Eq. (94). According to our
understanding then, it follows that the photon ﬂux depends on γ, does not

L/2. In the case when 0 . d

≪

q^

q^

61

f
f
f
f
^
I (a.u.)

^
I (a.u.)

2

6

8

10

12

14

2

4

6

8

10

12

14

4
^

w = ¼ (12 p n) 

^
I (a.u.)

^

w = ½ (12 p n) 

^
I (a.u.)

q^

q^

2

6

8

10

12

14

2

6

8

10

12

14

4

^

w = ¾ (12 p n) 

4

^

w = 12 p n 

^
z  >> 1

Fig. 13. Intensity proﬁles for TUR in the asymptotic limit for ˆz0 ≫
values ˆφw = (1/4)(12π), ˆφw = (1/2)(12π), ˆφw = (3/4)(12π), ˆφw = (12π)

1. at diﬀerent

exhibit oscillatory dependence on the transverse position r, it has a charac-
teristic scale γŻ, and depends on the frequency as ω2(∆ω/ω)K2
/(cγ)]. In
contrast to this, the ﬂux according to Eq. (14) in [8] 16 reads, in our notation
(number of photons per unit surface per unit time within the bandwidth
∆ω/ω) :

1[ωr

⊥

dF
dS ≃

α

∆ω
ω

Ib
eπ2

sin2

ωr2
⊥
4cd #

"

,

1
r2
⊥

(144)

where α = e2/(~c) is the ﬁne structure constant and Ib is the beam current.
γ2λ the photon ﬂux does not depend on γ, exhibits
This suggests that for d
on the scale √λd, and
oscillatory dependence on the transverse position r
depends on the frequency as (∆ω/ω) sin2[ωr2
/(4cd)]. The ﬁeld from which
⊥

≪

⊥

16 This equation coincides with Eq. (20) in [7] and Eq. (26) in the review [13]. It is a
currently accepted expression describing the photon ﬂux in the case under study.

q^

q^

62

f
f
f
f
Eq. (144) is derived is given explicitly in several papers (e.g. Eq. (24) in [9],
Eq. (4) in [11]). In our units, it reads:

~
E(zo, ~r
⊥

) =

4ie
c

−

~r
⊥
r2
⊥

e

exp

i

ωr2
⊥
4cd #

"−

sin

ωr2
⊥
4cd #

"

.

(145)

We disagree with the conclusions in Eq. (144) and Eq. (145). In particular
the expression for the ﬁeld in Eq. (145) is in contrast with our Eq. (91).

γ2Ż is not discussed in literature. As we
The region of parameters for d
have seen, this corresponds to a region where the near-ﬁeld contribution
from the downstream edge is present.

∼

d

≪

≪

When γ2Ż
L the contribution of the downstream edge is dominant,
ˆθ2/( ˆθ2+ ˆφ)2, that is
and the intensity distribution tends to approximate const
the single edge far ﬁeld limit. This case is practically described in literature
when discussing ”an electron exiting a bending magnet at the upstream
end of a straight section” of inﬁnite length (cited from [8]. Compare, for
example with Eq. (8) in the same reference). Although this situation is per se
not physical, in the sense that an inﬁnite straight section cannot be built, it
has a practical realization (for ˆφ
1) in the before-mentioned observation
region γ2Ż

≫

L.

×

d

≪

≪

The region of parameters for d
L is not discussed in literature, because
the near-ﬁeld region is understood for d . γ2Ż only. However, as we have
seen, the case d
L corresponds to a region where interference begins to
become important. In our understanding, this is a transition region between
the near and the far zone (d

L).

∼

∼

≫

1.

≪

Case for ˆφ
In this situation we can compare results in literature with
our Eq. (83). In particular, Eq. (31) of [9] (or, equivalently, Eq. (17) of [12] for
the Fourier transform of the ﬁeld ~¯E) is said to be applicable at for observation
γ2Ż, i.e. when
γ2Ż (using our notations) and for L
regions where d
ˆφ
1. Accounting for the fact that the origin of the reference system in [9]
is at the downstream edge of the straight section, we can write Eq. (31) of
[9] in our dimensional units as:

≪

≪

≪

~
E(zo, ~r
⊥

) =

e

2e
c

~r
⊥
r2
⊥
exp

exp

i
"

exp

ωr2
⊥
2czo #
iωr2
⊥
2czo(1 + 2zo/L) ! −

i
"

2c(L

ωr2
⊥
2zo)#
−
exp

 

2czo(

× "

 −

iωr2
⊥
1 + 2zo/L) !#

.

−

(146)

63

Thus, Eq. (31) in [9] appears to diﬀer of the phase factor exp
2zo)]
}
with respect to our Eq. (83), directly calculated by propagating the ﬁeld at
the virtual source position. We disagree with the result in Eq. (146) (i.e. Eq.
(31) in [9]). The intensity pattern, however, is correct in both cases 17 .

iωr2
{
⊥

/[2c(L

−

≫

≪

≪

≫

d (and L

It is of some interest to understand the origin of the diﬀerence between our
Eq. (83) and Eq. (31) in [9]. In this regard, in [9] it is reported that when
γ2λ) , the interference between upstream and downstream
L
edge is negligible. In this limit, Eq. (31) in [9] gives back Eq. (24) in [9]
that is Eq. (145). On the one hand Eq. (24) in [9] is said to be valid for
an inﬁnitely long straight section followed by a downstream edge. On the
other hand, Eq. (31) in [9] (and thus its limiting case for L
d as well) is
γ2λ. Since the limiting case of Eq. (31) in [9]
reported to be valid for d, L
for L
d coincides with Eq. (24) in [9] one concludes that an inﬁnitely long
d. We hold this to be a
straight section is identiﬁed de facto with the case L
misconception, in disagreement with our understanding. The length of the
straight section is naturally measured by the parameter ˆφ = L/(γ2Ż). Such
length is independent of the position of the observer. Only when ˆφ
1 it
is possible to have radiation from a single edge. In our understanding thus,
d is still necessary, but not suﬃcient to have single-edge
the condition L
radiation. Describing the situation for ˆφ
1 we have seen from Eq. (83)
that the total ﬁeld is always given as the result of the interference of the
two virtual sources located at the straight section edges and one never has
radiation from single edge. In contrast to this radiation from a single edge
γ2λ in the limit for
(in Eq. (24) of [9]) is explicitly reported to hold for L
L

≫

≫

≪

≫

≫

≪

d.

≫

We conclude that the origin of the diﬀerence between our results and those
in literature may be ascribed to a diﬀerent understanding of the parameters
of the theory. While we hold ˆφ to be the main parameter of our treatment,
result in literature seem to neglect its existence. By doing this, conventional
treatments neglect the fact that d and L should always be compared with
the third main length scale of the problem, that is γ2Ż.

7.2 Transition Undulator Radiation

As we have seen, TUR can be addressed as a more complicated edge-
radiation setup. In this case we have contributions from three parts, two
straight lines and the undulator. As we have seen, the undulator contri-
bution is similar to a straight line contribution, the only diﬀerence being a

17 Note that the intensity proﬁle in Eq. (27) of the review [13] is the square modulus
of Eq. (31) in [8].

64

diﬀerent average longitudinal velocity of the electron. Then, the far-zone
Ltot. In the far zone, well-accepted
region can be identiﬁed by distances zo ≫
expressions for the TUR emission are reported in literature [14, 15, 16], that
are equivalent to the following equation for the radiation energy density as
a function of angle and frequency:

dW
dωdΩ

=

e2
π2c "

2γ2θK2
(1 + K2/2 + γ2θ2)(1 + γ2θ2)#

2

sin2

πLw
2γ2λ  

"

1 +

K2
2

+ γ2θ2

.

!#
(147)

We disagree with this expression. In our understanding, there cannot be any
range of parameters in the setup in Fig. 10 where Eq. (147) is valid.

In order to prove this it is suﬃcient to compare Eq. (147) with Eq. (122), that
is equivalent to Eq. (20) of reference [8] 18 . In particular, since Eq. (147) does
not depend on the straight section lengths L1 or L2, we conclude that the
only regions where such comparison makes sense can be for L1 = L2 = 0, or
L1 = L2 = Lw

19 .

When L1 = L2 = 0 Eq. (122) reduces to:

dW
dωdΩ

=

e2
π2c "

2γ2θ
1 + K2/2 + γ2θ2 #

2

sin2

πLw
2γ2λ  

"

1 +

K2
2

+ γ2θ2

,

!#

(148)

that is obviously diﬀerent from Eq. (147.)

When L1 = L2 = Lw Eq. (122) becomes:

2

dW
dωdΩ

=

2γ2θK2
(1 + K2/2 + γ2θ2)

e2
π2c "
K2
πLw
1
2γ2λ  
2
2
(1 + K2/2 + γ2θ2)
K2

1 +

sin

sin

"

−

× (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1 + γ2θ2

#

(cid:0)
+ γ2θ2

(cid:1)

!#
ωLw
4cγ2  

"

3 +

+ 3γ2θ2

K2
2

2

,

!# (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(149)

≈

” should be replaced by the ﬁne-structure constant ”α”.

18 We believe that there is a small misprint in Eq. (8) of [8]. The symbol ”θ” after
the sign ”
γ2Ż the contribution from the straight
19 Referring to Fig. 10, note that when L2 ≫
section edge in D is always larger than those from the undulator edges in B and C
at any distance in the near and in the far zone. This is the case because outside the
z < γ2). Thus, for
undulator the longitudinal velocity is nearer to c than inside (γ2
γ2Ż, the straight section contribution will
long straight sections L1 = L2, with L2 ≫
be dominant compared to the undulator contribution.

65

that is also diﬀerent from Eq. (147) 20 . We conclude that Eq. (147) has no
physical meaning.

Finally, we put attention on the fact that there is a general need, in the FEL
community, to extend the current theory of TUR to cover the near zone.
Some attempt in this direction has been reported in [20]. The author of [20]
discusses a possible use of coherent TUR to produce visible-to-infrared light
synchronized with X-rays from an X-ray free-electron laser. For simplicity
we will ignore the delicate issue of technical realization of the scheme pro-
posed in [20] for the LCLS facility, and we will restrict our discussion of a
issue pertaining fundamental questions of electrodynamics.

In our view, the extension of the theory of TUR in Appendix A of [20] to the
near zone also includes some misconceptions. The treatment begins with Eq.
(A1), that is an expression for the vector potential ~A at a given observation
position and at a given frequency of interest. We report this expression here,
for the readers’ commodity:

~A(ω)

exp [iω (t + R(t)/c)]

(150)

T/2

∼

Z
T/2
−

~n

~β
(cid:17)

×
1

~n
(cid:16)
−

~β

×
~n

·

d
dt 


.





Here T = L/c is the time that a photon takes to travel the undulator length,
R(t) is the distance from the electron position at retarded time t to the
observer, the unit vector ~n is the direction from the retarded position of
the electron to the observer and ~β(t) is the electron velocity in units of the
speed of light. Eq. (150) is a modiﬁcation of the well-known Eq. (14.62) of
to
[21]. In fact, integration limits in Eq. (150) have been changed from
T/2 ”under the assumption that the electrons go on straight paths before
±
and after the undulator” (cited from [20]). As a ﬁrst remark, as discussed
above, the previous assumption is not justiﬁed in our view, as it does not
make sense to discuss generically about inﬁnite straight lines preceding and
following the undulator. However, we believe that there is another problem
with the use made of Eq. (150). The author of [20] starts with Eq. (150) and
modiﬁes it accounting for the fact that, in the near zone, ~n is not constant.
The problem with this is that the derivation of Eq. (150) relies a priori on the
assumption that ~n = const. In particular, the classical result

±∞

~n

~n

=

(1

×
~n

˙~β]
~β)
[(~n
×
−
~β)
~r′(t)
~ro −
(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)
20 For example, in the limit for K
back Eq. (75) with L = 3Lw as it should be.

d
dt 


×
1

1
ro

(~n

≪

−

−

·

~n

,

~β)
×
~β 


·

(151)

1 Eq. (147) tends to zero, while Eq. (149) gives

66

is used, where ro =
coordinate system. Eq. (151) assumes ~n = const.

~ro|
|

is the distance of the observer from the origin of the

Our conclusion is that Eq. (150) cannot be manipulated assuming that ~n is
not constant, as has been done in [20]. When ~n is not constant, as in this
case, Eq. (151) should be modiﬁed to the expression presented before in Eq.
(46) that may be found in the interesting but perhaps little-known reference
[23], dating back more than twenty years.

However, in this paper we have seen that it is possible to develop a more
convenient theory of near-ﬁeld Synchrotron Radiation Theory (including
the case of TUR) in the space-frequency domain, where Fourier Optics
techniques can be taken advantage of.

8 Conclusions

In this paper we presented a general connection between Fourier Optics
and classical relativistic electrodynamics. Consistent use of such connection
resulted in the formulation of a modern theory of Synchrotron Radiation in
terms of laser-beam optics.

In particular, we developed a theory of near-ﬁeld SR in the space-frequency
domain based of Fourier Optics techniques. These techniques can be taken
advantage of without limitations for SR setups, because the paraxial approx-
imation can always be applied in the case of electrons in ultra-relativistic
motion. We restricted ourselves to the analysis of single-particle radiation.
As we demonstrated in Section 2, and discussed in Section 3 the use of
paraxial approximation allows reconstruction of the ﬁeld in the near-zone
from the knowledge of far-ﬁeld data only. The solvability of the inverse
problem for the ﬁeld starting from far-ﬁeld data allows characterization of
any synchrotron radiation setup by means of virtual sources. In cases of in-
terest these sources exhibit a plane wavefront, and can be pictured as waists
of laser-like beams. These laser-like beams help developing our theory in
close relation with laser-beam optics. In particular, usual Fourier Optics
can be used to describe the ﬁeld at any distance, thus providing a tool for
designing and analyzing SR setups.

We gave several examples of applications of our theory in Section 4, Section
5 and Section 6. These examples provide both physical insight and under-
standing of several non-intuitive phenomena. In Section 4 we treated the
case of undulator radiation. In the case of perfect resonance we found an
analytic expression for the virtual source and we propagated such expres-
sion both in the near and in the far zone. The applications in the following

67

Section 5 and Section 6 actually constitute the ﬁrst comprehensive theory of
edge radiation and transition undulator radiation.

In Section 5 we dealt with the fundamental case of an electron moving on
a straight section. Such kind of system can be considered, in all generality,
as a fundamental building block for a number of more complicated setups.
We demonstrated that two equivalent pictures in terms of laser-like sources
can be presented. The ﬁrst takes advantage of a single virtual source in the
middle of the straight section. The second relies on two virtual sources at the
edges. The virtual sources at the edges can always be described analytically,
independently of the region of parameters considered. The main parameter
of the theory is identiﬁed to be the ratio between the straight section length
L and γ2Ż. When this ratio is small the single-source picture is found to be
natural, and two asymptotic regions of observation are found, the near and
the far zone. When the ratio is large, the two-source picture is more natural
and one is left with four asymptotic regions of observation: far zone for
two interfering sources, near zone for two interfering sources, far zone for
a single edge and near zone for a single edge. Results in Section 5 can be
directly used to describe an edge-radiation setup in the case upstream and
downstream bends can be considered to have zero length. These bends act
like switchers, switching the radiation harmonic (and the beam current har-
monic) on and oﬀ. Thus, our results for the straight section can be applied to
any situation with zero-length switchers. Our expressions are of importance
also in the case when switchers cannot be considered having zero-length.
In fact in general, as said before, straight sections can be considered as basic
building blocks for any magnetic setup.

To demonstrate this last point, in Section 6 we used results of Section 5 as
building blocks for describing the case of TUR in the zero-length switcher
approximation. In particular, we dealt with a setup composed by an un-
dulator preceded and followed by two straight sections. In the zero-length
switchers approximation, such setup describes TUR emission. Although
more sophisticated with respect to the straight-section motion, the example
in Section 6 does not present any conceptual diﬃculty in addition to those
encountered in the treatment of the straight-section motion.

Finally, in Section 7, we compared our ﬁndings with current understanding
of edge radiation and TUR. We found that several misconceptions exist in
the conventional understanding of edge radiation in the near zone, as well as
in the treatment of TUR. We extensively discussed these misconceptions and
proposed our understanding of the correct description of these phenomena.

We ﬁnd it interesting to remark that, although classical relativistic electro-
dynamics is a relatively old branch of physics, there are many novel and
valuable results pertaining this ﬁeld that have been obtained only recently.

68

Undoubtedly, many more will follow. These recent developments illustrate
a recurring fact in the history of Physics. Namely, subjects appearing well-
understood, and perhaps even a little old-fashioned may still have surprises
in store for us.

9 Acknowledgements

The authors are grateful to Martin Dohlus, Hermann Franz, Petr Ilinski and
Helmut Mais (DESY) for many useful discussions and to Massimo Altarelli,
Edgar Weckert and Jochen Schneider (DESY) for their interest in this work.

References

[1] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, ”Paraxial Green’s

functions in SR theory”, DESY 05-032, ISSN 0418-9833 (2005)

[2] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, ”Understanding
transverse coherence properties of X-ray beams in third generation SR
source”, DESY 05-109, ISSN 0418-9833 (2005)

[3] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, ”Statistical Optics
approach to the design of beamlines for Synchotron Radiation”, DESY
06-037, ISSN 0418-9833 (2006)
J. W. Goodman, ”Introduction to Fourier Optics”, Mc Graw-Hill Book
Company(1968)

[4]

[5] ZEMAX code, at http://www.zemax.com/
[6] R.A. Bosch et al. Rev. Sci. Instrum. 67, 3346 (1995)
[7] R.A. Bosch and O.V. Chubar, ”Long wavelength edge radiation in an
electron storage ring”, Proc. SRI’97, tenth US National Conference, AIP
Conf. Proc. 417, edited by E. Fontes (AIP, Woodbury, NY), pp. 35-41
(1997)

[8] R.A. Bosch, Il Nuovo Cimento, 20, 4 p. 483 (1998)
[9] R.A. Bosch, Nucl. Instr. Meth. Phys. Res. A, 431 (1999) 320
[10] P. Roy, J-B. Brubach et al., Nucl. Instr. Meth. Phys. Res. A, 426 (2001)
[11] R.A. Bosch, Nucl. Instr. Meth. Phys. Res. A, 482, 789 (2002)
[12] R.A. Bosch, Phys. Rev. ST AB 5, 020701 (2002)
[13] G. P. Williams, Rep. Prog. Phys. 69 (2006), 301
[14] K.-J. Kim, Phys. Rev. Lett. 76, 8 (1996)
[15] B.M. Kincaid, Il Nuovo Cimento Soc. Ital. Fis, 20D, 495 (1998) and

LBL-38245 (1996)

[16] M. Castellano, Nucl. Instr and Meth. in Phys. Res. A 391 (1997) 375
[17] R.A. Bosch, Nucl. Instr. Meth. Phys. Res. A, 386 (1997) 525
[18] P. Roy et al. Phys. Rev. Lett. 84, 3 (2000)

69

[19] S. Reiche and Z. Huang, in Proceedings of the 2004 FEL Conference, R.

Bakker et al. Editors, Trieste, pp. 193-195 (2004)

[20] B. Adams, Rev. Sci. Instrum. 76, 2 (2005)
[21] J. Jackson, ”Classical Electrodynamics”, 3rd ed., Wiley, New York (1999)
[22] O. Chubar and P. Elleaume, in Proc. of the 6th European Particle Ac-

celerator Confernce EPAC-98, 1177-1179 (1998)

[23] Y. Hirai, A. Luccio and Li-hua Yu, J. Appl. Phys. 55(1), 25 (1984)
[24] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, ”Exact solution
for the Second Harmonic Generation in XFELs”, DESY 05-137, ISSN
0418-9833 (2005), submitted to Optics Communications

[25] J. Bahrdt, in Proceedings of the 2005 FEL Conference, R. Reitmeyer

Editor, Stanford, pp. 694-701 (2005)

70

