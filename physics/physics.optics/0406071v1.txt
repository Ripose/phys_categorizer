4
0
0
2
 
n
u
J
 
6
1
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
1
7
0
6
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Analytical expressions for optimum alignment modes of highly
segmented mirrors
L. Noethe
European Southern Observatory, Karl-Schwarzschild-Straße 2,
D-85748 Garching bei M¨unchen, Germany

Abstract

Abstract. The major sources causing deterioration of optical quality in extremely large optical telescopes are
misadjustments of the mirrors, deformations of monolithic mirrors, and misalignments of segments in segmented
mirrors. For active optics corrections, all three errors, which can partially compensate each other, are measured
simultaneously.
It is therefore of interest to understand the similarities and diﬀerences between the three
corresponding types of modes which describe these errors. The ﬁrst two types are best represented by Zernike
polynomials and elastic modes respectively, both of them being continuous and smooth functions. The segment
misaligment modes, which are derived by singular value decomposition, are by their nature not smooth and
in general discontinuous. However, for mirrors with a large number of segments, the lowest modes become
eﬀectively both smooth and continuous. This paper derives analytical expressions for these modes, using
diﬀerential operators and their adjoints, for the limit case of inﬁnitesimally small segments. For segmented
mirrors with approximately 1000 segments, it is shown that these modes agree well with the corresponding
lowest singular value decomposition modes. Furthermore, the analytical expressions reveal the nature of the
segment misalignment modes and allow for a detailed comparison with the elastic modes of monolithic mirrors.
Some mathematical features emerge as identical in the two cases.

1

Introduction

The ﬁrst large optical telescope with a segmented mirror was the ten-meter Keck Telescope.
Its primary
mirror consisted of 36 hexagonal segments. All currently envisaged extremely large optical telescopes will have
segmented primary mirrors, but with a much larger number of hexagonal segments, of the order of one thousand
or more. Assuming that the shapes of the segments are perfect at all times, the only source for wavefront errors
generated by a segmented mirror would be misalignments of the segments. These can be measured either
optically or by edge sensors at intersegment edges. Both types of measurements can, in principle, detect the
relative piston and the relative tilt of adjacent segments. The misalignments are then corrected by appropriate
vertical position changes of actuators which can modify piston, tip and tilt of each segment [1].

If the signals given by the measurements were free of noise and the actuators were perfect, the misalignments
of the segments could be perfectly corrected. But, in reality, both signal noise and correction noise will give
rise to residual misalignments. Both the signals and the actuator positions can be represented as vectors with
suitable sets of base vectors.
If the errors are introduced by the actuators themselves, one can choose an
arbitrary orthogonal set of base vectors. However, if the errors are due to the signals, an optimum modal
correction requires the possibility to expand the signal into a set of well distinguishable, that is orthogonal
signal modes, which correspond to well distinguishable, that is orthogonal, actuator modes. Such modes are
the optimum alignment modes. For mathematical reasons, also described in section 2, they were called normal
modes in reference [1]. These modes can be calculated by Singular Value Decomposition (SVD). In the rest of
the paper we assume that the actuators are perfect and noise is only introduced by the signals.

For segmented mirrors with a thousand segments or more the modes with the lowest so called singular values
are rather smooth. They are also the ones which appear statistically with the largest amplitudes in an expansion
of the misalignment error due to random signal noise. In modern large active optical telescopes [2] containing
both segmented and ﬂexible monolithic mirrors the lowest normal modes could largely be compensated or
corrected by other elements in the telescope optics. This shows the need to compare the normal modes with
other sets of modes used in large telescopes, for example Zernike polynomials or elastic modes of monolithic
mirrors [3].

1

In the limit of an inﬁnite number of segments over a ﬁnite area the lowest normal modes should be continuous
smooth functions.
If the relationship between a position function and the corresponding signal function is
expressed by a continuous operator, such smooth functions can be calculated from diﬀerential equations and
appropriate boundary conditions. It should therefore be possible to derive analytical expressions for the lowest
normal modes in the limit of inﬁnitesimally small segments.

Section 2 outlines the method to obtain the analytical solutions. Before treating the case of two-dimensional
segmentation the method is applied in section 3 to two examples of one-dimensional line segments. In section 4
the method is used to calculate analytical expressions of the normal modes of a mirror with hexagonal segments
and section 5 compares the analytical solutions with the SVD solutions of a highly segmented mirror. Section 6
discusses the relationship to modes calculated with variational methods to minimise the r.m.s. of the signal
vector for a given r.m.s. of the actuator vector and section 7 shows the relationship to elastic minimum energy
modes of a circular plate.

2 Method to obtain analytical solutions

A given set of actuator positions is described by a vector ˜v in a nact-dimensional vector space
, and a given
set of signals by a vector ˜u in a nsig-dimensional vector space
. Without noise eﬀects, that is if the signals
depend only on the actuator positions, the actuator vectors are related to the signal vectors by a linear mapping
A from

, represented as a two-dimensional nsig

nact matrix A :

to

A

S

A

S

×

A˜v = ˜u

A = UΣVH

In this case a misalignment could be perfectly corrected by actuator changes. In reality, noise in the signals is
not negligible and only those signal vectors which are in the image space of
under the mapping A can be fully
corrected. An optimum modal correction of a misalignment of the segments requires the possibility to expand
the signal in an orthogonal set
of signal modes which are related by the mapping A to an orthogonal set
vi}

of actuator modes. Such sets are generated by the Singular Value Decomposition of A :

ui}

A

{

{

U is a matrix of dimension nsig
×
square matrices of dimension nact
σsvd,i. The nact column vectors of U and row vectors of V form orthonormal sets
that is, with <, > denoting the inner vector product,

nact and Σ and VH, where the superscript H denotes the adjoint matrix, are
nact. The matrix Σ is diagonal and contains nact so called singular values
, respectively,

vj}

ui}

and

×

{

{

The vectors ui and vi which are related by

< ui, uj >=< vi, vj >= δi,j

Avi = σsvd,i ui

will be called normal signal and actuator modes, respectively, since they are eigenvectors of so called normal
matrices, which are matrices which commute with their adjoints. The normal matrices are AHA in the case of
the actuator vectors and AAH in the case of the signal vectors. In the following the term normal mode without
a speciﬁcation ’actuator’ or ’signal’ will refer to an actuator mode.

For a large number of nseg of segments the normal modes with the smallest singular values become rather
smooth. In the limit of an inﬁnite number of segments over a ﬁnite area, that is in terms of the radii a of a
segment (see ﬁgure 5) and R of the mirror, a/R
0, they should converge to functions which are continuously
diﬀerentiable an inﬁnite number of times. Let L denote the continuous operator which corresponds to the
matrix A, and fi and gi the functions, called the analytical position and signal modes, to which the actuator
modes vi and the signal modes ui, respectively, converge for a/R
0. The position functions fi will also be
→
will have, similar to the sets
fi}
referred to as analytical normal modes. The two now inﬁnite sets
{

gi}

and

→

{

2

(1)

(2)

(3)

(4)

vi}

{

and

ui}

{

, the following two characteristics. Let the vector products be deﬁned by

< fi, fj >=

dx fi(x)fj(x) =

dξ fi(ξ)fj(ξ)

(5)

1
2D

+D

−D

Z

1
2

+1

−1

Z

for the one-dimensional problems with a length of the chain of segments of 2D and the normalised variable
ξ = x/D and by

< fi, fj >=

1
π(R2

2π

R

r2
1)

−

0

Z

r1

Z

1

−

π(1

ρ2
1)

0

Z

2π

1

ρ1

Z

dϕ

r dr fi(r, ϕ)fj(r, ϕ) =

dϕ

ρ dρ fi(ρ, ϕ)fj(ρ, ϕ)

(6)

for the two-dimensional problems, where r is the radial, ϕ the azimuthal coordinate, R the outer radius of
a circular mirror, r1 the radius of its inner hole, ρ = r/R the normalised radial variable, and ρ1 = r1/R the
normalised radius of the inner hole. The ﬁrst characteristic is then that the two sets of functions are orthonormal,
that is

The second characteristic is that the members fi and gi are related by

< fi, fj >=< gi, gj >= δi,j

L fi = ˜σi gi ,

where the ˜σi, which from now on will be called analytical singular values, correspond to the singular values
σsvd,i in the discrete SVD.

The functions fi and gi can be derived from the two conditions (7) and (8). Introducing equation (8) into

equation (7) gives

i < gi, gj > = < Lfi, Lfj > = ˜σ2
˜σ2
After integrating the vector product < Lfi, Lfj > by parts one gets [4]

i δi,j

< Lfi, Lfj > =< LH Lfi, fj > = < LF Lfi, fj > + βL[fi, fj] ,

where LH is the adjoint of L, LF the formal or Lagrange adjoint of L, and βL[fi, fj] a boundary functional. If
the boundary functional is zero equations (7), (9), and (10) lead to the linear diﬀerential equation

LF Lf = ˜σ2 f

Equations (10) and (11) are the fundamental equations for the derivation of the expressions for the analytical
normal modes in the limit of inﬁnitely ﬁne segmentation. The boundary conditions which are required to derive
speciﬁc inﬁnite sets
of analytical singular values
from the general solution of equation (11) are obtained from the requirement that the boundary functional
vanishes. The form of the operator LF and the boundary functional depend on the operator L. One of the
problems is therefore to ﬁnd the correct expression for the linear diﬀerential operator L which corresponds, in
the limit of inﬁnitely ﬁne segmentation, to the matrix A.

of analytical normal modes and the corresponding sets

˜σi}

fi}

{

{

(7)

(8)

(9)

(10)

(11)

3 One-dimensional segmentation

The method outlined in section 2 is ﬁrst applied to the mathematically easier case of one-dimensional segmen-
tation. In addition, some of the features appearing in this section are similar to the ones occuring in the more
interesting examples of two-dimensional segmentation discussed in sections 4 and 5.

3.1 SVD solutions

Figure 1 shows two examples which are based on linear chains of segments. In ﬁgure 1a each segment can only

3

(a)

1

2

3

4

(b)

1

2

3

3

4

4

5

1

2

3

4

5

1

2

6

Figure 1: (a) : Segments with piston movements only, (b) : Segments linked at the interfaces.

be moved in vertical direction. If the actuator positions are denoted by zi, the signals si measured by vertical
displacement sensors are given by

In ﬁgure 1b the segments are linked and the actuators are at the links and at both ends of the chain. The
signals si are deﬁned by

For small angles si is approximately proportional to the diﬀerence between the tilts of the segments. The
matrices linking the actuator positions to the signals are given by

si = zi+1

zi

−

si = zi −

2zi+1 + zi+2

for the example (a) with nsig = nact

1 and

−

1 1
0 1
0 0
0 0

0
1
−
1
0

0
0
1
−
1

0
0
0
1

−







1
0
0
0

−

2
1
0
0

−

1
2
1
0

0
1
2
1

−

0 0
0 0
1 0
2 1

−







Aa = 





−

Ab = 





for the example (b) with nsig = nact
singular values is equal to the number of signals.

−

2. In both examples the number nnz of normal modes with non-zero

For large values of nact the lowest modes, which are the ones with the smallest singular values, approach
smooth functions. Figure 2 shows for the example (b) with 100 segments the three modes with the lowest
singular values.

(12)

(13)

(14)

(15)

Figure 2: Example (b) : Actuator values (circles) and sensor signals (crosses) for the three SVD modes with the lowest
singular values. The solid lines are the mode shapes calculated analytically for an inﬁnite number of segments.

4

3.2 Analytical solutions for one-dimensional segmentation

3.2.1 Example (a)

In the limit of inﬁnitely small segments the operator L which corresponds to the matrix Aa of example (a) is
given by

Then, with

D and D being the left and the right end of the chain of segments, equation (10) becomes

−

< Lfi(x), Lfj(x) > =

For an arbitrary choice of a function fj from the set

the boundary functional vanishes only if

1
2D2

d
dξ

(cid:20)(cid:18)

fi(ξ)

fj(ξ)
(cid:21)

(cid:19)

+1

−1

L =

=

d
dx

1
D

d
dξ

1
2D2

+1

−1 (cid:18)
Z
+1

=

1
2D2

−

−1 (cid:18)
Z

d
dξ

fi(ξ)

d
dξ

(cid:19) (cid:18)
d2
dξ2 fi(ξ)
(cid:19)

fj(ξ)

dξ

(cid:19)

fj(ξ) dξ +

{

=

fj}
d
dξ

(cid:18)

d
dξ

(cid:18)

f (ξ)

(cid:19)ξ=−1

f (ξ)

= 0

(cid:19)ξ=+1

The diﬀerential equation (11) in terms of the normalised variable ξ is then given by

or, with the new normalised parameter σ = D˜σ which has the advantage that it is independent of the length
2D of the chain and has got the unit 1, by

The general solutions are either symmetric or antisymmetric :

with cs and ca denoting arbitrary constants. Introducing these equations into the boundary conditions (19) gives
the equations from which the inﬁnite sets of normalised analytical singular values σi = D˜σi for the symmetric
and the antisymmetric cases can be obtained. The σi are identical to the wavenumbers of the solution functions
and given by

Obviously, for the symmetric and antisymmetric cases the sets
, representing the analytical
fs/a,i}
position and signal modes respectively, are orthogonal sets of functions. The following relationships, which follow
from the equations (7), (9), and (17) will be required in section 3.3.1 :

Lfs/a,i}

and

{

{

1
D2

d2
dξ2 f (ξ) = ˜σ2f (ξ),

−

d2
dξ2 f (ξ) = σ2f (ξ)

−

fs(ξ) = cs cos(σξ)
fa(ξ) = ca sin(σξ)

σi = i

π
2

(16)

(17)

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

i = D2 ˜σ2
σ2

i = D2 < Lfi(x), Lfi(x) >
< fi(x), fi(x) >

=

+1

−1 (cid:18)
Z

d
dξ

fi(ξ)

dξ

2

(cid:19)

−1

Z

(cid:14)

+1

(fi(ξ))2 dξ

5

3.2.2 Example (b)

In the limit of inﬁnitely small segments the operator L which correspnds to the matrix Ab of example (b) is
given by

L =

d2
dx2 =

1
D2

d2
dξ2

Taking the same steps as in section 3.2.1 one gets
d4
dξ4

LFL =

1
D4

β

L

[fi, fj] =

1
2D4

d2
dξ2 fi

(cid:20)(cid:18)

(cid:19)

dfj
dξ −

d3
dξ3 fi

+1

fj

(cid:19)

−1

(cid:21)

(cid:18)

The diﬀerential equation is therefore given by

with σ = D2 ˜σ. The fourth-order diﬀerential operator in equation (29) can be factorised into two second-order
diﬀerential operators :

With the deﬁnition

the symmetric and antisymmetric solutions are, with as and aa denoting additional coeﬃcients,

Both sets of solutions require two boundary conditions which can be derived from the boundary functional (28).
This must be zero for arbitrary functions taken from the sets of functions
. Since at least for
some of them both the function and its derivative are non-zero at the edges the four conditions which guarantee
that the boundary functional is zero for all combinations of i and j are

fa,j}

fs,j}

or

{

{

(

d4
dξ4 −

σ2) f (ξ) = 0

(

d2
dξ2 −

σ)(

d2
dξ2 + σ) f (ξ) = 0

λ2 = σ

fs(ξ) = cs[cos(λξ) + as cosh(λξ)]
fa(ξ) = ca[sin(λξ) + aa sinh(λξ)]

(cid:18)

d2
dξ2 f (ξ)
d3
dξ3 f (ξ)

(cid:19)ξ=−1

(cid:18)

(cid:19)ξ=+1

d2
dξ2 f (ξ)
d3
dξ3 f (ξ)

= 0

= 0

(cid:18)
Introducing the general solutions (32) and (33) into equations (34) and (35) gives the equations from which
the wavenumbers λi and the coeﬃcients as,i and aa,i can be calculated. The wavenumber λi of a mode i is
approximately given by

(cid:18)

(cid:19)ξ=+1

(cid:19)ξ=−1

λi =

(1 + 2i)

This approximation is very accurate for large i. For small i the diﬀerences are only of the order of a few percent.
According to equation (31) the normalised analytical singular values σi are the squares of the wavenumbers λi.

3.3 Comparison between SVD-modes and analytical modes

3.3.1 Example (a)

One can derive an expression for the singular values σsvd,an,i expected from SVD based on the normalised
analytical singular values σi. From the equations (3) and (4) one gets

σ2
svd,i =

< Avi, Avi >
< ui, ui >

=

< Avi, Avi >
< vi, vi >

(26)

(27)

(28)

(29)

(30)

(31)

(32)

(33)

(34)

(35)

(36)

=

=

π
4

6

< Avi, Avi >
nsig

< vi, vi >
nact

(cid:14)

=

=

nsig
nact

nsig
nact

ǫ2
sig,i
ǫ2
act,i

,

(37)

(38)

(39)

(40)

(41)

(42)

where ǫsig,i and ǫact,i are the r.m.s. values of the signals and the actuator positions, respectively. To derive an
expression for ǫsig,i let d be the length of a segment, nseg the number of segments, and 2D = nsegd the length of
the full linear chain. If fi(x) is one of the analytical normal modes going through the centers of the segments
and the xj are the locations of the sensors, the mean square ǫ2

sig,i of the signals is approximately given by

nsig

sig,i = d2 1
ǫ2
nsig

dfi(x)
dx

2

x=xj

j=1 (cid:18)
X
For a very large number of segments the averaged sum can be replaced by the integral expressions in equation (17)
with i = j, leading to the analytical mean square ǫ2

sig,an,i of the signals :

(cid:19)

−1 (cid:18)
Z
Dividing equation (39) by the analytical mean square ǫ2
act,an,i of the positions

(cid:18)

(cid:19)

(cid:19)

ǫ2
sig,an,i =

1
2

d
D

2

+1

dfi(ξ)
dξ

2

dξ

and using equation (25) gives

ǫ2
act,an,i =

f 2
i (ξ) dξ

1
2

+1

−1

Z

ǫ2
sig,an,i
ǫ2
act,an,i

=

=

d
D

d
D

(cid:18)

(cid:19)
2

(cid:18)

(cid:19)

2

+1

−1 (cid:18)
Z
i = d2 ˜σ2
σ2
i

2

dξ

dfi(ξ)
dξ

(cid:19)

−1

. Z

+1

f 2
i (ξ) dξ

Introducing equation (41) into equation (37) and taking the square root gives an expression not any more for
the true singular values σsvd,i but for the ones σsvd,an,i based on the analytical approximation with an inﬁnite
number of segments. The relationship between the normalised analytical singular value σi of the mode i and
the corresponding one σsvd,an,i expected from SVD is then

σsvd,an,i =

nsig
nact

d
D

σi

r
For a chain with 100 segments ﬁgure 3a shows the singular values σsvd,an,i according to equation (42) (crosses)
and the true singular values σsvd,i calculated by SVD (circles). As one would expect, they only coincide for
the lowest smooth modes. For the higher modes the analytical calculation overestimates the singular values.
This can also be seen in ﬁgure 3b which shows the ratios of σsvd,an,i to σsvd,i. Also for the lowest modes these
ratios are not exactly equal to 1, but approximately equal to 1 + 0.5/nseg. For a large number of segments
the shapes of the SVD solutions with the smallest singular values are in perfect agreement with the ones of
the analytical solutions. Since the normal modes are used for the alignment of segmented mirrors, a common
question is how the signal errors propagate to actuator errors, that is, which r.m.s. ǫact,n of the actuator errors
is generated by noise in the signals with a given r.m.s. of ǫsig,n. The r.m.s. ǫact,n can be calculated by a sum
involving the nnz non-zero singular values. Two r.m.s. values will be calculated. An analytical one denoted by
ǫact,n,an, where the sum is formed with the singular values σsvd,an,i, and a true one denoted by ǫact,n,svd, where
the sum is formed with the true singular values σsvd,i. In general, the mean square ǫ2
act,an of the actuator errors
based on analytical singular values is the sum of the mean squares ǫ2
act,an,i of the individual modes. Using also
equation (41) one gets

ǫ2
act,an =

ǫ2
act,an,i =

ǫ2
sig,an,i

(43)

nnz

i=1
X

nnz

i=1
X

7

D
d

2 1
σ2
i

(cid:18)

(cid:19)

Figure 3: Example (a). (a) : Singular values calculated analytically (crosses) and by SVD (circles), (b) : Ratios of
these values for the lowest 50 modes.

If the signal errors are random, each of the nsig signal modes contributes an equal amount ǫsig,n,i = ǫsig,n/√nsig
to the total r.m.s. ǫsig,n of the signal noise. The analytically expected total mean square ǫ2
act,n,an of the actuator
errors due to random signal noise is then, after replacing ǫsig,an,i by ǫsig,n,i = ǫsig,n/√nsig and σi by the explicit
expression in equation (24), given by

act,n,an = ǫ2
ǫ2

sig,n

2

nnz

1
π2

2D
d

1
nsig

1
i2

(cid:18)
For a large number of segments nsig can be replaced by 2D/d. Furthermore, because of its fast convergence,
the sum from 1 to nnz is, for large nnz, approximately equal to the sum from 1 to inﬁnity, with a value of π2/6.
All this ﬁnally gives

i=1
X

(cid:19)

For a given r.m.s. of the signal noise the r.m.s. of the actuator error therefore scales, as one would expect, with
the square root of the number of segments. Equation (44) can also be written as

Similarly, the true r.m.s. ǫact,n,svd calculated with the true SVD singular values σsvd,i is given by

ǫact,n,an

ǫsig,n

≈

1
6 r

2D
d

r

act,n,an = ǫ2
ǫ2

sig,n

act,n,svd = ǫ2
ǫ2

sig,n

1
nact

nnz

i=1
X

1

σ2
svd,an,i

1
nact

nnz

i=1
X

1
σ2
svd,i

The result from equation (47) is eﬀectively identical to the one from equation (45). The same result is also
obtained by simple statistical considerations, that is by summing up random piston movements along a line of
segments and calculating the r.m.s. after subtracting the average.

3.3.2 Example (b)

The expression for σsvd,an,i can be derived in the same way as in section 3.3.1. One gets for a speciﬁc mode i

2

ǫsig,an,i
ǫact,an,i (cid:19)

(cid:18)

=

d2
D4

+1

−1 (cid:18)

Z

4

dξ

dfi(ξ)
dξ

(cid:19)

+1

f 2
i (ξ)dξ

−1

. Z

8

(44)

(45)

(46)

(47)

(48)

(49)

(50)

(51)

(52)

=

d2
D4 σ2

i = d2 ˜σ2
i

σsvd,an,i =

nsig
nact

d
D2 σi

with σi = D2˜σi. Here ǫsig,an,i is the r.m.s. of the angular signal error in radians. The singular value σsvd,an,i
expected from SVD is then related to the corresponding analytical singular value σi by

r
For a chain with 100 segments ﬁgure 4a shows the square roots of the singular values σsvd,an,i (crosses), that
is the wavenumbers corresponding to σsvd,an,i according to equation (31), and of the true ones σsvd,i (circles).
Figure 4a for the wavenumbers is very similar to the corresponding ﬁgure 3a for the singular values of example
(a). Also the ﬁgure 4b for the ratios of the square roots of σsvd,an,i to the square roots of σsvd,i is eﬀectively
identical to the corresponding ﬁgure 3b of example (a) for the ratios of the singular values. The total mean

Figure 4: Example (b). (a) : Wavenumbers calculated analytically (crosses) and by SVD (circles), (b) : Ratios of these
values for the lowest 50 modes.

square of the actuator errors is given by, using also equation (36) for the analytical singular values,

Next, nsig is replaced by 2D/d. Furthermore, because of its fast convergence, the sum from 1 to nnz is, for large
nnz, approximately equal to the sum from 1 to inﬁnity, with a value of π4/120

1. All this ﬁnally gives

−

act,n,an = ǫ2
ǫ2

sig,n

4
π

4 D4
d2

1
nsig

(cid:18)

(cid:19)

nnz

i=1 (cid:18)
X

1
1 + 2i

4

(cid:19)

ǫact,n,an

0.0982 D

ǫsig,n

≈

2D
d

r

For a chain of 100 segments the diﬀerence between the true value ǫact,n,svd obtained from equation (47) applied
to example (b) and ǫact,n,an from equation (52) is less than 1%. The solid lines in ﬁgure 2 show the analytical
solutions with the three smallest singular values. Clearly, they are in perfect agreement with the SVD solutions.

4 Analytical solutions for two-dimensional segmentation

4.1 General remarks

There are several combinations of signals and actuator positions which could be studied. In this chapter we
discuss mainly two examples which are of particular interest for the alignment and phasing of segmented mirrors.

9

We assume that the segments are hexagonal and the signals are measured at locations along the intersegment
edges as shown in ﬁgure 5. In both examples the signals are the relative vertical displacements between adjacent
segments at the locations of the sensors. Such signals can be obtained by optical measurements or by position
sensors. In principle, the signals can also include the relative tilts between adjacent segments, deﬁned here as

ract

b

a

Figure 5: Locations of the sensors at the intersegment edges of hexagonal segments. The ﬁlled circles in the segments
mark the positions of the actuators.

a change in the slope of the segments perpendicular to the edges at the locations of the sensors. Usually, the
signals generated by relative tilts are much smaller than signals generated by relative vertical displacements [6].
Except for one particular mode, the defocus mode, which is discussed in section 5.4, relative tilts at the sensors
are therefore of less signiﬁcance.

The two examples diﬀer in the number of the degrees of freedom for the movements of the segments.

•

•

Piston movements
In this case, which is the two-dimensional equivalent of the one-dimensional example (a) presented in
section 3.2.1, the segments can only move in piston and the positions of the three actuators of one
segment are therefore all identical. The signals along one intersegment edge are all the same and it would
be suﬃcient to consider just one signal along one edge. This example describes a situation where the
segments have already been perfectly aligned in tilt and the remaining phasing errors are corrected by
pure piston movements of the segments, a procedure which is used for the phasing of the segmented
primary mirror of the Keck telescope based on optical measurements.

Piston, tip and tilt movements
In this case, which is to some extent related to the one-dimensional example (b) presented in section 3.2.2,
there are three degrees of freedom for the movements of the segments, namely piston, tip and tilt. It
describes situations where a full correction of the misalignments including phasing is based on relative
vertical displacement signals at the locations shown in ﬁgure 5. It is used for the fast stabilization of the
alignment in the Keck telescope with signals obtained by position sensors.

60◦, θ2 = 0◦
The sensors at the edges of the hexagonal segments detect signals in the three directions θ1 =
and θ3 = 60◦ with respect to the horizontal axis in ﬁgure 5. The derivative of a function f (r, ϕ) in one of the
directions θk, k = 1, 2, 3, expressed as derivatives with respect to the radial and azimuthal coordinates r and ϕ
of a cylindrical coordinate system, is given by

−

Tk f (r, ϕ) =

f (r, ϕ) =

∂
∂sθk

1
R

(cid:18)

cos(ϕ

θk)

−

∂
∂ρ −

sin(ϕ
−
ρ

θk)

∂
∂ϕ

(cid:19)

f (ρ, ϕ) ,

(53)

10

In the limit of inﬁnitesimally small segments the lowest SVD modes always follow rotational symmetries n.
They can therefore be written as a product of a radial and an azimuthal component :

The diﬀerential operators for curvatures are second derivatives based on the operator in equation (53). Here
we use the following approximation. Strictly speaking, the curvature K along a direction s is deﬁned by

f (r, ϕ) = fn(r) cos(nϕ)

K =

1 +

d2f
ds2

df
ds

"

.

(cid:18)

#

(cid:19)

3/2

2

Since the derivative in the denominator is small compared to unity, we will replace the denominator by 1. This
is equivalent to approximating the spherical surface by a paraboloid with a radial dependence on ρ2.

4.2 Piston movements

The two-dimensional case which is equivalent to the one-dimensional example in section 3.2.1 is a conﬁguration
where the segments can only perform piston movements and the sensors measure only the relative vertical
displacements. In this case the diﬀerential operator is given by the operator Tk in equation (53). The starting
point for the derivation of the analytical normal modes is a vector product averaged over the three directions
θk :

1
3

3

Xk=1

1
3

1

−

π(1

ρ2
1)

3

Xk=1 Z

1

ρ1

Z

< Tkfi(r, ϕ), Tkfj(r, ϕ) >=

dϕ

ρ dρ (Tkfi(ρ, ϕ)) (Tkfj(ρ, ϕ))

(56)

After introducing equation (54), integrating over the azimuth angle ϕ, and summing over k equation (56)
becomes

1
3

3

Xk=1

< Tkfi(r, ϕ), Tkfj(r, ϕ) > =

ρ dρ

fn,i(ρ)

fn,j(ρ)

+

1
2R2

1 + δn,0
ρ2
1
1 Z

−

1

ρ1

d
dρ

(cid:20)(cid:18)

d
dρ

(cid:19) (cid:18)

(cid:19)

n2
ρ2 fn,i(ρ)fn,j(ρ)
(cid:21)
(57)

Following the procedure outlined in section 2 one gets

LF L =

βL[fn,i, fn,j] =

1
2R2 LB,n
−
1 + δn,0
1
ρ2
2R2
1
1 (cid:20)(cid:18)

−

d
dρ

1

fn,i(ρ)

fn,j(ρ)
(cid:21)

ρ1

(cid:19)

where LB,n is the operator appearing in the Bessel diﬀerential equation :

The general solution of

with σ related to ˜σ in equation (11) by σ = √2R˜σ is a sum of the Bessel functions Jn(σρ) and Yn(σρ) with
coeﬃcients cJ and cY :

For arbitrary functions fn,j taken from the set of general solutions (62) the boundary functional (59) vanishes
if the expression in the square brackets is zero for both ρ = ρ1 and ρ = 1, that is if the derivatives vanish
at both the inner and outer edges of the mirror. Introducing the general solution (62) into the two boundary
conditions gives a set of two linear homogeneous equation in cJ and cY from which the inﬁnite set of normalised
analytical singular values σn,i and the corresponding ratios (cY/cJ)n,i can be obtained. As in the corresponding

LB,n =

d2
dρ2 +

1
ρ

d
dρ −

n2
ρ2

LB,nfn(ρ) =

σ2fn(ρ)

−

fn(ρ) = cJJn(σρ) + cYYn(σρ)

11

(54)

(55)

(58)

(59)

(60)

(61)

(62)

one-dimensional example discussed in section 3.2.1 the singular values σn,i are identical to the wavenumbers of
the functions, in this case two Bessel functions, contributing to the solution (62).

For the rotational symmetries 0, 1, and 2 ﬁgure 6 shows, for ρ1 = 0.1, the four analytical normal modes
with the smallest singular values σn,i. Like the Zernike polynomials the modes can be classiﬁed according to
their rotational symmetries and, within each rotational symmetry, according to their number of nodes, that is
zeros along the radial coordinate. The only mode, which is, compared with the set of Zernike modes, missing in
the set
is the lowest mode of rotational symmetry 0 with no nodes. This reﬂects the fact that a uniform
piston movement of all segments does not generate relative vertical displacements at intersegment edges.

fn,i}

{

The major diﬀerence to the Zernike polynomials is that, due to the boundary conditions following from
equation (59), the ﬁrst derivatives are, as in the one-dimensional example in section 3.2.1, zero at the edges. In

Figure 6: Lowest analytical normal modes of an annular mirror with ρ1 = 0.1 for pure piston movements for the
rotational symmetries 0, 1, and 2.

the case of a completely ﬁlled mirror, that is ρ1 = 0, the function Yn(σρ), which diverges at ρ = 0, drops out of
the general solution, which is then given by

fn(ρ) = cJJn(σρ)

(63)

In this case the expression inside the square brackets of the boundary functional (59) is automatically zero
for ρ = 0. This leaves therefore only one boundary condition which is suﬃcient to determine the inﬁnite set
of normalised analytical singular values σn,i which are also identical to the wavenumbers. The functions look
similar to the ones in ﬁgure 6, but now, for all symmetries n > 0, they are zero at the centre of the mirror.

4.3 Piston, tip and tilt movements

4.3.1 Diﬀerential operator

As in section 4.2 the sensors detect only relative vertical displacements, but the segments can now be controlled
in piston, tip and tilt. Let a smooth function over hexagonal areas be approximated by planes. For a spherical
surface this can be done without generating relative axial displacements. The sensors therefore measure locally
only the diﬀerence to a surface with, also locally, a constant curvature in all directions. This is the same as the
torsion of the surface which is given by, using also equation (54),

Lkf (r, ϕ) =

∂2f (r, ϕ)
∂sθk ∂sθk−90◦

1
2R2 [sin(2(ϕ

−

12

=

θk)) cos(nϕ) Ln,1fn(ρ) + 2 cos(2(ϕ

θk)) sin(nϕ) Ln,2fn(ρ)]

(64)

−

with the two operators Ln,1 and Ln,2 deﬁned by

Ln,1 =

Ln,2 =

+

n2
ρ2

d2
dρ2 −
d
n
dρ
ρ

−

1
ρ

+

d
dρ
n
ρ2

(65)

(66)

(68)

(69)

(71)

(72)

(73)

4.3.2 Derivation of the analytical normal modes

The procedure outlined in section 2 starts oﬀ with the following vector product averaged over the three direction
Θk :

< Lkfi(r, ϕ), Lkfj(r, ϕ) > =

dϕ

ρ dρ (Lkfi(ρ, ϕ)) (Lkfj(ρ, ϕ))

(67)

1
3

1

−

π(1

ρ2
1)

3

Xk=1 Z

1

ρ1

Z

After introducing equation (54), integrating over the azimuth angle ϕ, and summing over the three directions
denoted by k one gets

< Lkfi(r, ϕ), Lkfj(r, ϕ) > =

ρ dρ [(Ln,1fn,i(ρ))(Ln,1fn,j(ρ)) +

1
3

3

Xk=1

1
3

3

Xk=1

A straightforward calculation shows that

The boundary functional is given by

βL[fn,ifn,j] =

1
8R4

−

(cid:20)(cid:18)

1 + δn,0
ρ2
1
1 ((cid:20)(cid:18)

−
d3
dρ3 fn,i(ρ)

ρ

−

ρ

d2
dρ2 fn,i(ρ)

−

d
dρ

fn,i(ρ) +

fn,i(ρ)

n2
ρ

1

d
dρ

(cid:19)

fn,j(ρ)
(cid:21)

ρ1

+

d2
dρ2 fn,i(ρ) + (1 + 3n2)

1
ρ

d
dρ

fn,i(ρ)

4

−

1

n2
ρ2 fn,i(ρ)
(cid:19)

fn,j(ρ)
(cid:21)

ρ1 )

(70)

With σ related to ˜σ in equation (11) by σ = √8R2 ˜σ the fourth-order diﬀerential operator appearing in

1

1
8R4

1 + δn,0
ρ2
1
1 Z
4 (Ln,2fn,i(ρ))(Ln,2fn,j(ρ))]

−

ρ1

LF L =

1
8R4 L2

B,n

can be written as a product of two second-order diﬀerential operators. Equation (71) then becomes

L2
B,nfn(ρ) = σ2fn(ρ)

(LB,n + σ) (LB,n −

σ)fn(ρ) = 0

With the same deﬁnition (31) of λ as in section 3.2.2 the general solution of (72) is a sum of the Bessel functions
Jn(λρ), Yn(λρ), In(λρ), and Kn(λρ) with coeﬃcients cJ, cY, cY and cK :

f (ρ) = cJJn(λρ) + cYYn(λρ) + cIIn(λρ) + cKKn(λρ)

For an arbitrary choice of the functions fn,j the boundary functional (70) is zero if the expressions in both square
brackets vanish for ρ = ρ1 and ρ = 1. Introducing (73) into the four boundary conditions gives a system of
four linear homogeneous equations in cJ, cY, cI, and cK from which the inﬁnite set of normalised wavenumbers
λn,i and the corresponding ratios of cY, cI, and cK to cJ can be obtained. Similarly to the corresponding
one-dimensional example the singular values σn,i are the squares of the wavenumbers λn,i.

For the rotational symmetries 0, 1, and 2 and ρ1 = 0.1 ﬁgure 7 shows the four analytical normal modes with
the lowest singular values σn,i. Using the classiﬁcation of the modes introduced in section 4.2 three modes are
missing compared with the set of Zernike modes. Two of them are the two lowest modes of rotational symmetry
0 without and with one node, corresponding to Zernike piston and defocus, and the third one is the lowest

13

mode of rotational symmetry 1 corresponding to Zernike tilt. All three modes can be generated without relative
vertical displacements at intersegment edges.

The functions are somewhat similar to the corresponding Zernike polynomials, but should better be compared
with the elastic minimum energy modes of circular plates (see section 7). For the case of a full mirror, that is

Figure 7: Lowest analytical normal modes of an annular mirror with ρ1 = 0.1 for piston, tip and tilt movements for the
rotational symmetries 0, 1, and 2.

ρ1 = 0, the Bessel functions Yn(λρ) and Kn(λρ), which diverge at ρ = 0, drop out of the general solution, which
is then given by

f = cJJn(λρ) + cIIn(λρ)
The expressions in the two square brackets of the boundary functional (70) are automatically zero for ρ = 0. This
leaves two boundary conditions which are suﬃcient to calculate the wavenumbers λn,i and the corresponding
ratios (cI/cJ)n,i. The functions look similar to the ones in ﬁgure 7, but now, for all symmetries n > 0, they are
zero at the centre of the mirror.

(74)

5 Comparison with SVD results

5.1 SVD programs

All SVD calculations were done with computer programs supplied by G. Chanan [5]. They were developed for
and applied to the control of the segmented primary mirror of the Keck telescope. Most of the data used in this
paper were obtained for the segmented mirror shown in ﬁgure 8. In the following, the radius of the segments
is, as shown in ﬁgure 5, denoted by a and the distance between the sensors along one intersegment edge by b.
For the numerical SVD-calculations we used the parameters a = 0.5 m, b = 0.3078 m, and R = 15.05 m. The
segments in ﬁgure 8 are the ones with the centres inside the range of normalised radii ρ of 0.30 < ρ < 1.0. This
mirror has got 1002 segments and 5688 sensors. The radius of the circle ract deﬁned by the actuator locations
shown in ﬁgure 5 was ract = 0.52275 a. Calculations were also done for a geometry similar to the one shown in
ﬁgure 8, but without a central hole. This mirror has got 1099 segments and 6348 sensors.

5.2 Piston movements

5.2.1 Mode shapes

The number of SVD modes with non-zero singular values is nnz = nseg
1. One mode with a singular value
equal to zero, which corresponds to the missing analytical mode in section 4.2, is related to a uniform piston

−

14

Figure 8: Segmentation used for the SVD calculations.

movement of all segments. For a few low order modes ﬁgure 9 shows the traces along a diameter for a full
and an annular mirror. Especially for the full mirror the agreement between the shapes of the normal modes
obtained with SVD (circles) and analytically (solid lines) in section 4.2 is excellent. The deviations close to
the inner hole of the annular mirror are to be expected since this edge is less accurately deﬁned because of the
smaller number of segments.

5.2.2 Singular values

For pure piston movements a sensor signal is proportional to the diﬀerence between the values of an analytical
normal mode fn,i at adjacent segment centres. To the ﬁrst approximation, this is proportional to the slopes of
fn,i midway between two centres along the line connecting the two centres times the distance √3a between the
two centres. The mean square ǫ2

sig,n,i of the sensor signals of the mode (n, i) is therefore

ǫ2
sig,n,i =

√3a

T 2
n,i,j ,

2

1
nsig

nsig

j=1
X

(cid:16)

(cid:17)

where Tn,i,j is the slope of the mode i of rotational symmetry n perpendicular to the edge at the location of
the sensor j. For a very large number of segments the averaged sum in equation (75) can be replaced by the
integral expressions in equation (57) with i = j :

ǫ2
sig,an,n,i =

3a2
2R2

1 + δn,0
ρ2
1
1 Z

−

1

ρ1

d
dρ

"(cid:18)

ρ dρ

fn,i(ρ)

+

2

(cid:19)

n2
ρ2 f 2

n,i(ρ)
#

After dividing by the mean square ǫ2

act,an,n,i of the actuator positions

(75)

(76)

(77)

ǫ2
act,n,i =

ρ dρ f 2

n,i(ρ)

1 + δn,0
ρ2
1
1 Z

−

1

ρ1

15

Figure 9: Normal modes calculated by SVD (circles) and analytical normal modes (solid lines) for pure piston movements.
The ﬁrst index along a curve denotes the rotational symmetry and the second one the order within the symmetry. (a) :
Full mirror, (b) : Annular mirror with ρ1 = 0.3.

one gets

ǫ2
sig,an,n,i
ǫ2
act,an,n,i

=

3a2
2R2 σ2

n,i = 3a2 ˜σ2
n,i

where σn,i = √2R˜σn,i are the normalised analytical singular values. Similarly to section 3.3.1 one ﬁnally gets
for the relationship between a singular value σsvd,an,n,i expected analytically from SVD and the corresponding
σn,i

σsvd,an,n,i =

3
2

nsig
nact

a
R

σn,i

r
Since the ratio nsig/nact is eﬀectively constant for highly segmented mirrors, the singular values for a speciﬁc
mode (n, i) expected from SVD scale with a/R. Figure 10a shows for the lowest 25 normal modes the true
singular values σsvd,n,i given by SVD (circles) on the one hand and the ones σsvd,an,n,i (crosses) according
to equation (79) on the other hand. The agreement is quite satisfactory. Figure 10b, displaying the ratios of
σsvd,an,n,i to σsvd,n,i, shows that for the higher modes the analytical calculation overstimates the singular values.

5.2.3 Error propagation

Starting from equation (78) one can derive how the total r.m.s. ǫact,n,an of the actuator errors generated by a
given r.m.s. ǫsig,n of the signal errors scales with the number of segments. The procedure is the same as the
one used in section 3.3.1. One gets

where the sum runs over the nnz = nseg
the total number of segments is approximately given by

−

1 non-zero analytical singular values. For a large number of segments

Neglecting the missing sensors at the edge of the mirror, the number of sensors is approximately given by

act,n,an = ǫ2
ǫ2

sig,n

2R2
3a2

1
nsig

1
σ2
n,i

,

n,i
X

nseg

2π
3√3

≈

2

R
a

(cid:18)

(cid:19)

nsig

6 nseg

≈

16

(78)

(79)

(80)

(81)

(82)

Figure 10: Singular values calculated by SVD (circles) and analytically (crosses) for pure piston movements. (a) :
Lowest 25 modes, (b) : Ratios of analytically expected singular values to the ones calculated by SVD for the lowest 230
modes.

Introducing all this into equation (80) one gets

ǫ2
act,n,an ≈

ǫ2
sig,n

1
2π√3

1
σ2
n,i

n,i
X

For the higher modes the analytical singular values increase approximately linearly both with the symmetry n
and the order i, in the latter case, as one should expect, in steps of π. With such linear dependencies on n and
i the sum in equation (83) does not converge if the number of segments goes to inﬁnity. But it increases only
very slowly, namely approximately linearly with the logarithm of nnz. Therefore, ǫact,n,an scales approximately
with log(R/a).

For the full mirror desribed in section 5.1 the sum in equation (83) is approximately equal to 2.4. This gives

for the r.m.s. ǫact,n,an of the actuator errors

ǫact,n,an

0.470 ǫsig,n

≈

This is in good agreement with the true r.m.s. ǫact,n,svd = 0.504 ǫsig,n of the actuator errors calculated with
the true singular values σsvd,n,i. Similar values for ǫact,n,svd are given in table 4 of reference [6]. The true
value ǫact,n,svd is slightly larger than ǫact,n,an since, ﬁrst, the singular values σsvd,an,n,i are larger than the true
ones σsvd,n,i and, second, the number of signals is smaller than the value of 6 nseg used in the derivation of
equation (84).

(83)

(84)

5.3 Piston, tip and tilt movements

5.3.1 Mode shapes

The number of non-zero singular values is nnz = nact
4. Four normal modes calculated by SVD with singular
values zero are the piston mode, the defocus mode and the two tilt modes. They correspond to the three missing
analytical normal modes in section 4.3.2. Figure 11 shows for a few of the lowest modes the SVD solutions
(circles) and the corresponding analytical solutions (solid lines) for a full and an annular mirror. Especially for
the full mirror the agreement is excellent.

−

17

Figure 11: Normal modes calculated by SVD (circles) and analytical normal modes (solid lines) for piston, tip and tilt
movements for the lowest two modes of the rotational symmetries 1 and 2. (a) : Full mirror, (b) : Annular mirror with
ρ1 = 0.3.

5.3.2 Singular values

The sensor signals are proportional to the diﬀerence in the slope of an analytical normal mode fn,i between
adjacent segment centres. If only the torsion contributes to a sensor signal one has to take the slope perpendicular
to the line connecting the two centres. The diﬀerence in the slope is then, to the ﬁrst approximation, proportional
to the torsion of fn,i at the location midway between the two centres, the distance √3a between the two centres,
and the distance from the midway point to the sensor, that is b/2. The mean square ǫ2
sig,n,i of the sensor signals
for the mode (n, i) is therefore

ǫ2
sig,n,i =

2

√3ab

 

2 !

1
nsig

T 2
n,i,j ,

nsig

j=1
X

where Tn,i,j is the torsion of the mode (n, i) at the location of the sensor j. For a very large number of segments
the averaged sum in equation (85) can be replaced by the integral expressions in equation (68) with i = j :

ǫ2
sig,an,n,i =

3a2b2
32R4

1

1 + δn,0
ρ2
1
0
1 Z

−

ρd ρ [(Ln,1fn,i(ρ))2 + 4(Ln,2fn,i(ρ))2]

After dividing, as in section 5.2.2, by the mean square of the actuator positions, the ratio of the mean square
of the sensors signals to the mean square of the actuator positions for a given mode (n, i) becomes

where σn,i = √8R2 ˜σn,i are the normalised analytical singular values. Similarly to section 3.2.1 one ﬁnally gets
for the relationship between the singular value σsvd,an,n,i of the mode (n, i) expected analytically from SVD and
the corresponding normalised analytical one σn,i

ǫ2
sig,an,n,i
ǫ2
act,an,n,i

=

3a2b2
32R4 σ2

n,i =

3a2b2
4

˜σ2
n,i ,

σsvd,an,n,i =

3
32

nsig
nact

ab
R2 σn,i

r

Since the ratio nsig/nact is eﬀectively constant for highly segmented mirrors, the singular values expected from
SVD scale with ab/R2. Figure 12a shows for the lowest 25 normal modes the true singular values σsvd,n,i given
by SVD (circles) on the one hand and the ones σsvd,an,n,i (crosses) according to equation (88) on the other
hand. The agreement is quite satisfactory. Figure 12b, displaying the ratios of σsvd,an,n,i to σsvd,n,i, shows that
for the higher modes the analytical calculation understimates the singular values.

18

(85)

(86)

(87)

(88)

Figure 12: Singular values calculated with SVD (circles) and analytically (crosses) for piston, tip and tilt movements.
(a) : Lowest 25 modes, (b) : Ratios of expected singular values to the ones calculated by SVD for the lowest 230 modes.

5.3.3 Error propagation

Starting from equation (87) one can derive an expression for the total r.m.s. ǫact,n,an of the actuator errors
based on the analytical singular values. The procedure is again the same as the one used in section 3.3.1. One
gets

act,n,an = ǫ2
ǫ2

sig,n

32R4
3a2b2

1
nsig

1
σ2
n,i

,

n,i
X

4 non-zero analytical singular values. For the higher modes the square
where the sum runs over the nnz = nact
roots of the analytical singular values increase approximately linearly both with the symmetry n and the order
i, in the latter case, as one should expect, in steps of π. The sum in equation (89) converges rapidly for a
large number of segments. For the full mirror described in section 5.1 the limit value is approximately 0.065.
Introducing this and the approximate expressions (81) and (82) into equation (89) one ﬁnally gets for the r.m.s.
of the actuator errors

−

ǫact,n,an

0.31

ǫsig,n

≈

R
b

The true r.m.s. σact,n,svd of the actuator errors is eﬀectively the same as the one calculated from equation (90).
For the currently envisaged extremely large telescopes the ratio R/b is approximately equal to 50. The r.m.s.
of the actuator errors is then approximately ﬁfteen times larger than the r.m.s. of the signal errors. This is in
good agreement with the results of SVD calculations for a thirty meter telescope given in table 1 of reference
[6].

(89)

(90)

5.4 Piston, tip and tilt generated by relative tilt signals

Some sensors detect in addition to the relative vertical displacements also the relative tilts between adjacent
segments. One could use the same formalism as in the other examples to derive the diﬀerential equations and
the boundary conditions. Unfortunately, the fourth-order diﬀerential operator cannot easily be factorised into
two second-order diﬀerential operators as it could be done in equations (71) and (72). But usually the signals
due to the relative tilts perpendicular to the edges are much smaller than the signals due to relative vertical
displacements [6]. Most modes will then hardly be aﬀected by the tilt signals. There is only one additional

19

mode of rotational symmetry zero with a non-zero singular value which converges, in the limit of the signals
due to relative tilts going to zero, to the pure defocus mode with a singular value equal to zero. For small, but
still non-zero tilt signals the singular value of this mode can be estimated. It is related to the integral of the
mean curvature over the mirror for a mode shape proportional to pure defocus. The operator which measures
the curvature along a direction θk is given by

Lkf (r, ϕ) =

∂2f (r, ϕ)
∂2sθk

=

1
R2

cos(nϕ)

cos2(θk)

(cid:26)

(cid:20)

+ sin(nϕ) sin(2θk) n

∂2fn(ρ)
∂ρ2 + sin2(θk)
1
ρ

∂ρ −

fn(ρ)

∂fn(ρ)

1
ρ

(cid:19)(cid:27)

(cid:18)

(cid:18)

∂fn(ρ)

∂ρ −

n2
ρ

fn(ρ)

(cid:19)(cid:21)

One then obtains, after introducing equation (54), integrating over the azimuth angle ϕ, and averaging over the
three directions denoted by k, for the special case of rotational symmetry 0 and a full mirror

3

1
3

< Lkfi(r, ϕ), Lkfi(r, ϕ) >=

1
4R4

1

ρ dρ

3
"

d2f0,i(ρ)
dρ2

2

+

3
ρ2

df0,i(ρ)
dρ

2

+

2
ρ

d2f0,i(ρ)
dρ2

df0,i(ρ)
dρ

Xk=1

#
(92)
If one assumes that the lowest mode f0,2 (f0,1 would denote the piston mode) is equal to pure Zernike defocus
c√3(2ρ2

1), where c is the r.m.s. of this mode, one gets

0
Z

(cid:19)

(cid:18)

(cid:18)

(cid:19)

−

1
3

3

Xk=1

< Lkf0,2(r, ϕ), Lkf0,2(r, ϕ) >= c2 48
R4

The sensor signal is proportional to the diﬀerence in tilt between adjacent segment centres. If only the curvature
contributes to the sensor signal one has to take the tilt component parallel to the line connecting the two centres.
The diﬀerence in tilt is then, to the ﬁrst approximation, proportional to the curvature at the location midway
between the two centres, the distance √3a between the centres and the lever g which converts the angular
diﬀerence into a diﬀerential displacement [6]. The mean square ǫ2

sig,0,2 of the sensor signals is therefore

where T0,2,j is the curvature of the defocus mode at the location of the sensor j. In the limit of small segments
the averaged sum in equation (94) can be replaced by the integral expression in equation (93) :

After dividing, as in section 5.2.2, by the mean square c2 of the position function, the ratio of the r.m.s. of the
sensor signals to the r.m.s. of the actuator positions for the defocus mode becomes

The singular value expected from SVD is then ﬁnally given by

sig,0,2 = (√3 ag)2 1
ǫ2
nsig

sig,an,0,2 = 144 c2
ǫ2

T 2
0,2,j ,

nsig

j=1
X

2

ag
R2

(cid:16)

(cid:17)

ǫsig,an,0,2
ǫact,an,0,2

= 12

ag
R2

σsvd,an,0,2 = 12

nsig
nact

ag
R2

r

For the full mirror described in section 5.1 with g = 23.53 mm one gets from equation (97) σsvd,an,0,2 = 0.0007206.
This is in good agreement with the result of σsvd,0,2 = 0.0007064 obtained from a SVD calculation.

6 Relationship to modes minimizing the signals measured by the

sensors

For arbitrary position functions the mean square

of the signals is given f (ξ) by

(91)

(93)

(94)

(95)

(96)

(97)

(98)

J
1
2D

=

J

(Lf (ξ))2 dξ

Z

20

for the two one-dimensional examples with the operators L deﬁned in equations (16) and (26), and for arbitrary
position functions fn(ρ) by

=

=

J

J

1
2R2

1
8R4

1 + δn,0
ρ2
1
1 Z

−
1 + δn,0
ρ2
1
1 Z

−

1

ρ1
1

ρ1

d
dρ

n2
ρ2 f 2

fn(ρ))2 +

(
(cid:18)
(Lρ,1fn(ρ))2 + 4(Lρ,2fn(ρ))2

n(ρ)

(cid:19)

ρ dρ

ρ dρ

for the two-dimensional examples in sections 4.2 and 4.3. On the assumption that the mean square
position functions, deﬁned by

C

of the

(cid:0)

(cid:1)

=

C

1
2

+1

f 2(ξ) dξ

−1
Z
1 + δn,0
ρ2
1
1 Z
for the one- and two-dimensional cases, is constant, the modes which minimise the r.m.s. of the signals can be
calculated by variational methods. Denoting the variation by δ one has to solve

ρ dρ f 2

n(ρ)

(102)

=

−

ρ1

C

1

where ζ is a free parameter which can be interpreted the energy per unit of the r.m.s. of
m = 0 and η = ξ for the one-dimensional and m = 1, η = ρ, and f = fn for the two-dimensional examples

. This gives, with

C

δ(

ζ

) = 0

J −

C

δJ
δf −

2ζηmf = 0

or explicitly, with a prime denoting a partial derivative with respect to η,

∂J
∂f −

∂
∂η

∂J
∂f ′ +

∂2
∂η2

∂J
∂f ′′ −

2ζηmf = 0

For all examples given in this paper the diﬀerential equations derived from equation (105) are identical to the
ones derived with the method outlined in section 2. The analytical normal modes can therefore be regarded as a
special class of the modes which minimise the r.m.s. of the signals for a speciﬁed r.m.s. of the position function
f . Their special characteristic is that the position modes and corresponding signal modes form orthogonal sets,
which deﬁnes the boundary conditions.

(99)

(100)

(101)

(103)

(104)

(105)

7 Relationship of analytical normal modes to elastic modes

7.1 Reasons for a comparison

In future extremely large telescopes segmented mirrors will be used together with large ﬂexible meniscus mirrors.
Whereas the aberrations of the segmented mirrors are best described by the analytical normal modes derived in
this paper, the deformations of the thin meniscus mirros are best described by minimum elastic energy modes
[3]. For the two examples in sects. 3.2.2 and 4.3 both types of modes are closely related and, as will be shown
in this section, often very similar. This oﬀers the possibility to correct aberrations, which are generated by
segmented mirrors, by thin meniscus mirrors and vice versa.

7.2 One-dimesional segmentation

The diﬀerential equation (30) for example (b) in section 3.2.2 is identical to the one for minimum elastic energy
modes of a bar. Since the boundary conditions (34) and (35) are also the same as the boundary conditions for
a bar which is free at both ends, the analytical normal modes of example (b) are identical to the elastic modes
of a free bar.

21

Table 1: Residual r.m.s. after ﬁtting a set of elastic modes of rotational symmetry 2 to the four lowest analytical normal
modes of rotational symmetry 2.

1
0.0817
0.9969
0.9998
1.0000

1
2
3
4

Fitted elastic modes
4
3
2
0.0056
0.0104
0.0238
0.0007
0.0007
0.0053
0.0066
0.0124
0.9998
0.0156
0.9999
1.0000

5
0.0023
0.0006
0.0042
0.0081

Normal
modes

7.3 Two-dimensional segmentation

It is shown in appendix A that the orthogonal set of minimum elastic energy modes of a thin circular plate can
be derived with a slightly more general method than the one introduced in section 2. For the set of elastic modes
the corresponding set of curvature tensors has to be orthogonal to the corresponding set of moment tensors.
This leads to the same diﬀerential equation (72) as for the case of piston, tip and tilt movements in section 4.3.2.
Any diﬀerences in the shapes must then be related to the boundary conditions. For higher order modes with
large wavenumbers the terms with highest derivatives in the boundary conditions dominate the other terms.
If only the terms with the highest derivatives are retained, the boundary conditions for the analytical normal
modes in equation (70) and the elastic modes in equations (117) and (118) below of a free plate are identical :

d2
dρ2 fi(ρ)
d3
dρ3 fi(ρ)

(cid:18)

(cid:18)

(cid:19)ρ=1

(cid:19)ρ=1

= 0

= 0

(106)

(107)

Therefore, within each rotational symmetry, the higher analytical normal modes should be very similar to the
corresponding elastic modes of a circular plate. This similarity is obvious from ﬁgure 13 which compares the
shapes of the lowest analytical normal modes of the rotational symmetries 0 and 2 with the shapes of the
corresponding elastic modes.

Figure 13: Comparison of the lowest analytical normal modes (solid lines) and corresponding elastic modes (dashed
lines) for the rotational symmetries 0 and 2.

Table 1 shows, for an initial r.m.s. of an analytical normal mode of 1, the residual r.m.s. after ﬁtting a given
number of the lowest elastic modes of a full circular plate to the lowest four analytical normal modes of rotational
symmetry 2 of a full mirror. The diﬀerence between the lowest analytical normal mode and the corresponding

22

lowest elastic mode is of the order of 8% and one needs to ﬁt the lowest three elastic modes to push the residual
r.m.s. to a level of 1%. The similarity of the higher order modes is expressed by the fact that the residual r.m.s.
1 elastic modes are ﬁtted to i-th analytical normal mode, but drops
is eﬀectively equal to 1 if the lowest i
−
sharply to approximately 1% after the i-th elastic mode is included in the ﬁt.

It is interesting to compare the probabilities of the occurence of normal modes in a segmented mirror on
the one hand with the probabilities of the occurence of elastic modes in a monolithic mirror on the other hand.
One has to choose the normal modes obtained from the more general case of piston, tip and tilt movements
presented in section 4.3 because of their similarity to the elastic minimum energy modes.

The source for wavefront errors in the form of normal modes are the signals at intersegment edges. For
white noise the r.m.s. values ǫsig,i of all signal modes are identical. Since the singular value is proportional to
1/λ2

i the r.m.s. ǫnor,i of a normal mode is related to ǫsig by

The source for wavefront errors in the form of elastic modes are errors in the support forces of the large
monolithic mirrors. For a large number of supports these force errors can be replaced by pressure ﬁelds. Since
the elastic modes form an orthogonal set of functions and are proportional to the pressure ﬁelds generating
them, the elastic modes and pressure functions can be regarded as a pair of normal modes similar to the pair
of analytical signal and position modes in segmented mirrors. But, instead of being proportional to 1/λ2
i the
r.m.s. ǫela,i of an elastic mode is, for a given r.m.s. ǫpr of the pressure ﬁeld, proportional to 1/λ4

i :

ǫnor,i ∝

ǫsig
λ2
i

ǫela,i ∝

ǫpr
λ4
i

A comparison of the equations (108) and (109) shows that the coeﬃcients of the elastic modes generated by
random force errors decline much faster with the order of the mode than the coeﬃcients of the normal modes of
a segmented mirror generated by signal errors. The diﬀerence in the behaviour is, at a ﬁrst glance, surprising,
since the normal modes of a segmented mirror are similar to the elastic modes, that is the relationship between
the position modes and the ﬁelds of the second derivatives of the position modes is the same. But the diﬀerence
is that for the normal mirror modes the source is already a kind of curvature ﬁeld, whereas for the elastic modes
there is another additional relationship involving a factor λ2
i between the source, which is the pressure ﬁeld,
and the curvature ﬁeld.

Appendix A : Derivation of elastic modes of a circular plate
For the derivation of the elastic modes of a free circular plate one has to generalise the method introduced in
section 2. Instead of equation (9)

we require now that

< Lfi, Lfj >

δi,j

< Lfi, N fj >

δi,j

∝

∝

with two possibly diﬀerent diﬀerential operators L and N . Partial integration of the left hand side leads to an
equation which is equivalent to equation (10) :

< Lfi, N fj > = < N F Lfi, fj > + βL,N[fi, fj]

If the boundary functional βL,N[fi, fj] is zero, equations (7), (111), and (112) lead to the linear diﬀerential
equation

N F Lfi = σ2

i fi

For elastic modes the operators are related to the strain and moment tensors. With a prime and an asterix
denoting a partial derivative with respect to the radial variable r and the azimuthal variable φ, respectively,
the components of the strain tensor are deﬁned by

χr =

′′

f

, χφ =

−

f ′
r −

f ∗∗
r2 , χrφ =

−

′∗

f
r

−

+

f ∗
r2

23

(108)

(109)

(110)

(111)

(112)

(113)

(114)

and the components of the moment tensor by

where D = Kh2/12 and K = Eh/(1
ratio. Equation (112) then becomes

−

Mr = D(χr + νχφ), Mφ = D(χφ + νχr), Mrφ = D(1

ν)χrφ ,

(115)

−

ν2). E is the modulus of elasticity, h the mirror thickness, and ν Poisson’s

< Lfi, N fj > =

dϕ

dr (Mr,iχr,j + Mφ,iχφ,j + 2Mrφ,iχrφ,j)

2π

r2

0
Z

r2

r1

Z

=

∝

r1

Z

δi,j

dr [(χr,iχr,j + χφ,iχφ,j + 2χrφ,iχrφ,j)

+ ν (χφ,iχr,j + χr,iχφ,j −

2χrφ,iχrφ,j)]

Introducing equation (54) and partial integration lead to the diﬀerential equation (72) and a boundary func-
tional. For an arbitrary choice of the functions fn,j the boundary functional is always zero if the following
boundary conditions are fulﬁlled :

′′′
i (rx) +

f

f ′′
i (rx)
r

+ (1 + n2(2

v))

−

′′
i (rx) + ν

f

f ′
i (rx)
r
−
f ′
i (rx)
r2 + n2(3

n2ν

v)

−

fi(rx)
r2
fi(rx)
r3

= 0

= 0

for both rx = r1 and rx = r2. These four boundary conditions are identical to those for a free thin annular
circular plate [3].

Acknowledgements The author would like to thank Gary Chanan for many useful discussions and Ray
Wilson and Natalia Yaitskova for critical comments on the manuscript.

(116)

(117)

(118)

References

1 Troy, M., Chanan, G., Sirko, E., and Leﬀert, E., 1998, Residual Misalignments of the Keck Telescope
Primary Mirror Segments : Classiﬁcation of Modes and Implications for Adaptive Optics, Proceedings of
the International Society for Optical Engineering, Vol. 3352, 307-317

2 Noethe, L., Active optics in modern large optical telescopes, Progress in Optics, 43, chapter 1

3 Noethe, L., 1991, Journal of Modern Optics, 38, 1043-1066

4 Cantrill, C.D., 2002, Modern Mathematical Methods for Physicists and Engineers, (Cambridge University

Press)

5 Chanan, G., 2002, Private communication

6 Chanan, G., MacMartin, D.G., Nelson, J., Mast, T., Control and Alignment of Segmented-Mirror Tele-

scopes : Matrices, Modes, and Error Propagation, accepted for publication in Applied Optics

24

