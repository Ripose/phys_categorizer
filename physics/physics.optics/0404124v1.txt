4
0
0
2
 
r
p
A
 
7
2
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
4
2
1
4
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Shaping Current Waveforms for direct Modulation
of Semiconductor Lasers

Lucas Illing and Matthew B. Kennel

1

Abstract— We demonstrate a technique for shaping current
inputs for the direct modulation of a semiconductor laser for
digital communication. The introduction of shaped current
inputs allows for the suppression of relaxation oscillations and
the avoidance of dynamical memory in the physical laser device,
i.e., the output will not be inﬂuenced by previously communicated
information. On the example of time-optimized bits, the possible
performance enhancement for high data rate communications is
shown numerically.

Index Terms— Semiconductor lasers, Intersymbol

interfer-
ence, Time optimal control, Optimal control, Communication
system nonlinearities, Nonlinear optics, Nonlinear systems

I. INTRODUCTION

S EMICONDUCTOR lasers typically convey information

for optical communication using either “external” or “di-
rect” modulation. In the ﬁrst scheme, the laser is maintained
in a constant light-emitting state and some sort of exter-
nal “shutter,” typically a Mach-Zehnder type electro-optic
modulator, modulates the output intensity according to an
externally applied voltage. The advantage of this technique
and there
is that it allows high bit rates (> 10 Gbit/s)
is no interaction between the information being applied to
the modulator and any internal dynamics of the laser. The
disadvantage is that costly external apparatus are necessary.
Direct modulation involves changing the current input of the
laser, i.e., modulating it around the bias current, in order to
produce time-dependent output in optical intensity.

In terms of modeling, the use of direct modulation means
that the laser becomes a driven nonlinear system with po-
tentially complicated dynamics. Indeed, it is well known that
even simple high-frequency periodic modulation of sufﬁciently
large amplitude can lead to nonlinear phenomena such as
period doubling cascades, period tripling, and chaos [1]–[8].
It is therefore not surprising that attempting communication
with current pulses that occur rapidly in succession, quickly
changing among discrete current levels to transmit randomly
interleaved zero and one bits, will result in a complex output
time series of intensity. As a result the bits may cease to be
decodable at the receiver and there is a considerable memory
effect [9]. This effect is called “inter-symbol interference”
in the communications literature because the sequence of

This work was supported in part by the US Army Research Ofﬁce (grant

# DAAD19-99-1-0199 and grant # DAAG55-98-1-0269)

L. Illing is with the Department of Physics and the Center for Nonlinear
and Complex Systems, Duke University, P.O. Box 90305, Durham, NC 27708
(e-mail:illing@phy.duke.edu)

M. B. Kennel is with the Institute for Nonlinear Science, University of

California, San Diego, La Jolla, CA 93093-0402

information symbols at previous times may harm decoding
at the present time. Additionally, communication using high-
speed direct modulation is limited by transient oscillations,
known as relaxation oscillations, that result from the interplay
between the optical ﬁeld and the carrier density [10], [11].
Such oscillations cause distortions of the output light pulse
and broaden the signal’s optical spectrum (increased chirp),
thus contributing to an increased bit-error rate.

In an effort

to overcome the problems associated with
direct modulation many techniques for chirp reduction and
suppression of relaxation oscillations have been proposed,
including the modiﬁcation of the physical laser device [11]–
[13], the use of external optical feedback [14] and external
electronic circuits [15], as well as the shaping of the current
pulses that are used to encode logical bits into the optical
output of the laser [16]–[20].

We approach the issue of inter-symbol interference and
from the point of view of nonlinear
relaxation oscillations
dynamics. A basic single-mode semiconductor laser modeled
by the rate equations is a two degree of freedom system,
with ordinary differential equations for photon density and
carrier density. The cause of inter-symbol interference is the
fact that even if the observable intensity returns to its nominal
stationary condition after a current wave form is applied, the
unobservable carrier density may not have, and thus there
is dynamical coupling from past to future. Our feed-forward
solution is to use appropriately shaped driving currents to
control the state-space trajectory of the laser, and we show
how to obtain these waveforms given a dynamical model for
the laser.

The main goal of this paper is to demonstrate a tech-
nique that can eliminate relaxation oscillations and inter-
symbol interference, without having to physically change the
laser diode. This allows enhanced data rates and improved
communication performance as is shown numerically for a
communication scheme using time-optimized non-return-to-
zero (NRZ) bits. This improvement comes at
the cost of
more complex input electronics, which would be necessary
to shape the input current in experiments. A distinguishing
feature of our approach is the use of shaped, continuous, drive
currents with ﬁnite rise times. This contrasts with other recent
research [20], where relaxation oscillations are suppressed
using piece-wise constant currents, which would possibly
present difﬁcult discontinuities.

We will ﬁrst present the general idea of the shaping method
in Sec. II and then show particular solutions for the speciﬁc
case of optimizing the transition time for NRZ bits in Sec. III.
Using these solutions, we estimate the bit error rate (BER)

performance for the case of a simple Gaussian white noise
channel to show the possible performance enhancement.

TABLE I

DYNAMICAL VARIABLES, DEFINITIONS, AND NUMERICAL VALUES OF
PARAMETERS.

2

II. CURRENT SHAPING

The semiconductor laser is presumed to be single mode. For
this case the laser dynamics can be described by a driven two
dimensional system of ordinary differential equations for the
carrier density N (t) and the photon density S(t), the latter
being proportional to output intensity:

dS
dt
dN
dt

=

=

−

−

γc S + Γ G(N, S) S,

γs N

G(N, S) S +

−

J0 + J
ed

.

(1)

The constant J0 is the bias current, J(t) the modulation around
the bias, G(N (t), S(t)) the optical gain coefﬁcient including
nonlinear effects, Γ the conﬁnement factor, d the active layer
thickness of the laser, γc the photon decay rate, and γs the
spontaneous carrier decay rate.

For the purpose of numerical calculations and analytical in-
vestigations it is useful to work with dimensionless quantities.
It is convenient to non-dimensionalize using the ﬁxed point
(S0, N0) of the laser in the absence of modulation (J(t) = 0),
that is, of the laser under stationary continuous-wave operating
conditions (dS/dt = dN/dt = 0). We expand the nonlinear
G(N (t), S(t)) around this point to ﬁrst order

G(N, S) = G0 + Gn(N

N0) + Gp(S

S0).

(2)

−

−

Liu and Simpson [21] show how to experimentally estimate
Gn = ∂G/∂N > 0 and Gp = ∂G/∂S < 0. Note that the ﬁxed
point conditions yield the relations ΓG0 = γc and J0/ed
γsN0 = G0S0.

−

These dimensionless dynamical equations are independent
of how far above threshold the laser is operated except via
indirect inﬂuence on the empirical differential gain parameters
Gn and Gp, which depend on the expansion point. The dimen-
sionless photon density s(t) is deﬁned via s(t) = S(t)/S0, the
1, and the current
carrier density n(t) via n(t) = N (t)/N0 −
1.1 The dimensionless
via
M = (J0 +J(t))/(γsN0ed)
J
gain g = G/G0 is

−

+

J

n

g(n, s) = 1 +

γn
γs
−
ΓGpS0. Using the natural
where γn = GnS0 and γp =
relaxation oscillation angular-frequency ωR = √γcγn + γsγp,
the dimensionless quantity corresponding to time τ = tωR can
be formed. With this the model equations are:

γp
γc

(3)

1),

(s

−

−

J

ds
dτ
dn
dτ

=

=

γc
ωR
γs
ωR

g(n, s)

1

s

−

+

M

J

−

(cid:17)

(cid:3)
n

− J

(cid:16)(cid:2)
J

(cid:16)

g(n, s) s

.

(cid:17)

(4)

Table I lists the dimensionless quantities and the parameters
we use, the values of which are based on measurements of J.M.
Liu’s group [22]. For the purpose of digital communication

1Roughly speaking, the dimensionless total current 1 +

M is in
units of the threshold current. This is strictly true for simple gain functions
that imply clamping of the carrier density to it’s threshold value for currents
above threshold.

+

J

J

Symbol

s(τ )
n(τ )
g(n, s)
M(τ )

J

J
γs
γn/
γp/
γc
ωR

J
J

Value

Description

dimensionless photon density
dimensionless carrier density
dimensionless gain coefﬁcient
dimensionless modulation current

bias current at ﬁxed point
spontaneous carrier decay rate
gain variation with carrier density
gain variation with photon density
photon decay rate
relaxation oscillation frequency

2/3

1.458
2.0
3.6
3.6

109s−1
×
109s−1
×
109s−1
×
1011s−1
×

√γcγn + γsγp

1
45 ps

∼

we are interested in the relationship between the information
bearing modulation current and the output of the laser. The
key insight is to note that, given a functional form for the time
series s(t), the corresponding input current can be computed
just by differentiation. In contrast, given the functional form of
the current, it is necessary to integrate the nonlinear equations
of motion (4) to obtain the potentially chaotic resulting laser
output.

Given a particular model for the laser, there is often some
differential operator taking a given s(τ ) to the other variables
M(τ ) and another one On[s(τ )] = n(τ ) such
Os[s(τ )] =
that
is a solution to
the equations of motion. This solution though may not be
physically allowable (such as having negative total current)
or dynamically stable.

J
the state vector [

M(τ ), n(τ ), s(τ )]

J

To derive the driving current as function of the output
waveform we introduce, for computational ease, s(τ ) = ey(τ ),
solve for n(τ ) using the ds/dτ equation, differentiate, and
rearrange the dn/dτ equation to solve for

M(τ ), yielding

M =

J

ω2
RJ
γcγn (cid:20)

¨y +

(cid:18)

γp + γn
ωR

ey +

γs
ωR (cid:19)

J
˙y + (ey

1)

.

(5)

−

(cid:21)

This equation relates a given waveform s(τ ), via y, to the
modulation current that caused it. Any desired output wave-
form that corresponds to a physically allowed input can thus
be produced by driving the laser with the according shaped
M(τ ). Not all functions s(τ ) will however result in
current
M(τ ). One physical requirement is a non-negative
realistic
total driving current at all times, 1 +
0, as
it is not possible to extract electrical energy back from the
carrier density. Practical considerations generally limit the
peak current that can be applied as well.

J
J

+

≥

J

J

M

Note that (5) includes the full nonlinear dynamics of the
laser as modeled by the rate equations (1). In contrast to any
theory based on the linearization of (1), results obtained using
(5) apply to large driving amplitudes. The speciﬁc linearized
parameterization of gain we used (2) restricts the validity
of (4) because it does not take into account gain saturation
effects that become important for very large intracavity photon
densities s. However, it is equally straightforward to derive

a)

b)

)
s
t
i
n
u

 
.

b
r
a
(
 
t
n
e
r
r
u
C

)
s
t
i
n
u

 
.

b
r
a
(
 
s

2

1
10

5

0

1

1

1

0

1

1

0

1

0

0

1

1

100

110

120

170

180

190

140

130
160
Time (in units of 1/ω
R)

150

Fig. 1. We show how a square-like total driving current 1 +
M (a)
gives rise to relaxation oscillations of the laser photon density s(t) (b). The
bit time is Tbit = 8 which corresponds to 360 ps for the model-parameters
shown in Tab. I (ω
45 ps). The lower and upper value for the driving
current corresponds to ﬁxed points with s = 0.2 and s = 2.0, respectively.

−1
R ∼

+

J

J

formulas analogous to (5) when gain functions which model
saturation are used. We chose to work with gain (2) because
it is simple. For the results presented in the rest of the paper
gain saturation is not important, and, the parameters of (2)
may be estimated experimentally.

III. APPLICATION TO COMMUNICATION

We consider a “direct” modulation setup: the laser’s driving
current J(t) is modulated to encode information. The laser
light travels through the communication channel, and at the
receiver, the intensity of the arriving signal is measured. One
then attempts to extract the information from this signal, in
the simplest case by a single thresholding to decode binary
information.

Figure 1 shows the laser dynamics driven with an unshaped
current waveform (NRZ bits). After a transition from low
current to high current, there are clear relaxation oscillations
of the laser output, that is, the output “rings” at the char-
acteristic relaxation oscillation frequency. In the particular
situation here, the bit time would be sufﬁciently large that a
conventional system could decode the information successfully
by integrating energy over a bit interval. A further increase
in bit rate, however, will result in signiﬁcant inter-symbol
interference (see Fig. 3d-f)

J

The state-space trajectory depends on its initial conditions
s0 and n0 as well as on the driving signal
M(τ ). If, at the
end of each bit time Tbit, the system returns to a particular
point in state-space, e.g. s(Tbit) = s0 and n(Tbit) = n0,
then repeating the same driving signal
M(τ ) will result
in a repetition of the state-space trajectory. If, on the other
hand, the system trajectory did not reach (s0, n0) after the
ﬁrst bit, then repeating the driving signal will result in a
different laser output, whose particular details depend on the
previous drive signal. This dynamic coupling causes inter-
symbol interference.

J

The main physical issue is to return the unobserved carrier
density to a speciﬁc state as well as the photon density. We

3

use (5) to design driving signals which return the system
trajectory to a known state at the end of each bit. Since
the adverse effects of dynamic coupling on communication
performance are especially relevant for high bit rates, we will
try to maximize the bit rate (minimizing the bit time) for a
given physical laser by optimizing driving signals which cause
no dynamical inter-symbol interference.

A. Finding the time-optimal NRZ bits

NRZ bits encode 1-bits (0-bits) as high (low) light power,
but in contrast to return-to-zero pulsing, the intensity stays
high when two or more consecutive 1-bits are transmitted, and
similarly for consecutive zero bits. The dynamical picture is a
system that can be driven to switch between two ﬁxed points
in state-space, one corresponding to low output power, the
“off” state, and the other corresponding to high output power,
the “on” state. The driving waveform for a bit identical to its
predecessor is trivial—a constant to stay at the particular ﬁxed
point. We solve for driving currents that ﬁx the system along
a state-space trajectory, smoothly connecting the “off” ﬁxed
point to the “on” ﬁxed point (up transition) and another one
for the “on” to “off” transition (down transition). We require
both the photon density and the carrier density come to a
known ﬁxed point at the end of each bit, thus there will be no
dynamic coupling from one bit to the next and therefore no
inter-symbol interference.

We use (5), a parameterized set of photon density wave
forms, and an optimization algorithm to search for waveforms
which optimize some other desirable communication criterion
under the condition that they correctly connect the two states.
In particular, we have searched for the minimum transition
time T , and thus highest bit rate, given a desired intensity
separation between high and low.

To be speciﬁc, let us ﬁx the “off” intensity to 20% of the
ﬁxed point intensity around which we normalized, soff = 0.2,
and the “on” state to twice the ﬁxed point value, son = 2.0.
For the up (down) transition we need to search the space of
all smooth waveforms s(τ ) with s(0) = soff and s(T ) = son
(s(0) = son and s(T ) = soff) such that the transition time T
is minimized and such that the corresponding current
M(τ )
meets certain constraints. In this example, we require that 0 <
M < 6, which means that the total input current
1 +
into the laser is positive and that the largest pump current we
admit is roughly six times the threshold current, a physically
reasonable requirement. We furthermore require that
M(τ )
has zero ﬁrst derivatives at τ = 0 and τ = T .

+

J

J

J

J

The success of the optimization over all possible waveforms
depends on the choice of the right set of basis functions, and
satisfying all the boundary conditions. We found that, although
an ordinary Fourier base does work to a certain extent, it
is numerically advantageous to pick base functions which
automatically incorporate many of the constraints, avoiding
needing as many explicit constraint equations in the opti-
mization procedure. This notion led us to use the following
functions to parameterize s = ey:

y(τ ) = p

+

ak sin

2πf

(6)

τ
T

(cid:16)

(cid:17)

N

"

k=1
X

τ
T

4

,

#

(cid:16)

(cid:16)

(cid:17)(cid:17)

a)

b)

c)

TABLE II

4

0
2
1
Time (arb. units)

0
2
1
Time (arb. units)

0
2
1
Time (arb. units)

)
s
t
i
n
u
 
.
b
r
a
(
 
s

2

1

0

)
s
t
i
n
u
 
.
b
r
a
(
 
s

2

1

0

2

0
1
Time (in units of 1/ω
e)

2
R )

0

f)

 
)
s
t
i
n
u
 
.
b
r
a
(
 
t
n
e
r
r
u
C

)
s
t
i
n
u
 
.
b
r
a
(
 
 
t
n
e
r
r
u
C

6

4

2

0

6

4

2

0

0

d)

0

)
s
t
i
n
u
 
.
b
r
a
(
 
s

2

1

0

 
)
s
t
i
n
u
 
.
b
r
a
(
 
s

1

2

1

0

1

0
2
1
Time (arb.units)

0
2
1
Time (arb. units)

0
2
1
Time (arb. units)

2

0
1
Time (in units of 1/ω

0

2
R)

+

The ﬁgure shows driving current waveforms, i.e. 1 +

Fig. 2.
M(t),
and in the insets the corresponding optical laser output in terms of the photon
density s(t). Panels a), b), and c) show the transition from the “off” to the
“on” state. Using two sin-terms [N=2 in (6)] in the optimization procedure
for the driving current yields a), whereas the use of 20 base functions (N=20)
results in b). For comparison, we display in c) the photon density waveform
and discontinuous current computed using optimal control theory. Panels d),
e), and f) are results for the “on” to “off” transition, where two base functions
are used in d), 20 base functions in e), and f) is the optimal control theory
result.

J

J

J

) is a (7th degree) polynomial with p(0) = ln [s(0)],
where p(
·
p(1) = ln [s(T )], and with zero ﬁrst, second, and third deriva-
tive at τ = 0 and τ = T , which ensures zero ﬁrst derivatives
of
M at these times. f (x) = (a0 + 1)x/(a0x + 1) is a
warp function introducing asymmetry with the effect that short
transition times can be obtained using fewer base functions.
The only constraint that has to be enforced in the optimization
is the requirement 0 < 1 +
M < 6 (see Table II).
J
This choice of base functions was rather arbitrary, justiﬁed
principally by numerical ease in automatically incorporating
boundary conditions and empirically giving reasonably suc-
cessful results, not by any strong theoretical considerations.
We leave the question of how to choose mathematically
optimal, or experimentally desirable, base functions for future
investigations. Our main goal is to demonstrate the general
concept; there is no barrier to incorporating other forms of
base functions and other models for different lasers in this
method.

+

J

Figure 2 shows numerical results from using base functions
(6) and the NPSOL software package [23], [24], which allows
nonlinear constrained optimization. Comparing the currents
for the “off” to “on” transition (Fig. 2a, b, and c) to the
corresponding photon densities s(t) (insets) shows that the
shaped current waveform that is obtained as result of the
optimization is quite dissimilar from the output
intensity
waveform.

In particular, an increase of the laser’s output intensity is not
achieved by just ramping up the current from the low value
corresponding to the “off” steady state to the higher value
corresponding to the “on” state. Instead the pump current is
reduced after an initial surge to allow the carrier density to

)
s
t
i
n
u
 
.
b
r
a
(
 
s

2

1

0

)
s
t
i
n
u
 
.
b
r
a
(
 
s

1

2

1

0

1

SUMMARY OF PARAMETERS, CONSTRAINTS, AND RESULTS FOR THE
OPTIMIZED NRZ BITS

2

2

Fixed parameters in the optimization

Optimization constraints and how they are met

0-bit ﬁxed point
1-bit ﬁxed point
minimal allowed pump power
maximal allowed pump power

ﬁxed s(0) (either son or soff)
ﬁxed s(T ) (either soff or son)
∂
∂t J
∂
∂t J
0 < 1 +

M(0) = 0
M(T ) = 0

M(τ ) < 6

+

J

J

s0bit = 0.2
s1bit = 2.0
+
+

M

M

J
J

min = 0.0
max = 6.0

1 +
1 +

J
J

y(0) = p(0) = ln(s(0))
y(T ) = p(1) = ln(s(T ))
...
y (0) = 0
˙y(0) = ¨y(0) =
...
y (T ) = 0
˙y(T ) = ¨y(T ) =

active constraint

Results of optimization

up transition
down transition

N=2

T = 1.80
T = 1.98

N=20

T = 1.57
T = 1.71

Theory

Topt = 1.42
Topt = 1.53

relax to the steady state value.

In Fig. 2a we show the current and photon density that
were obtained with just two sinusoidal terms (N=2 in (6)).
The minimal transition time that can be obtained decreases
when the number of base functions is increased, e.g. tenfold
(N=20) as shown in Fig. 2b. The inclusion of higher frequency
sine functions results in a current with a much faster rise time.
Just by the choice of the number of base functions one can
therefore approximately take into account limitations on the
possible rise-times of electronics involved. Thus, we did not
explicitly add this limitation as an additional constraint in the
optimization procedure, but such a constraint is reasonable to
use.

The waveforms found also converge to the theoretical best
limit
(Fig. 2c), obtained by applying results from optimal
control theory. If one drops the requirement of ﬁnite rise times
for the drive current, that is, if discontinuous functions are
admitted, then the so called Minimum Principle [25] can be
applied. It tells us that a time-optimal state-space trajectory
is achieved by driving the laser with a constant current at
either the maximal allowed or minimal possible value (see as
well [20]). The point in state-space where to switch from
one value to the other can be found by integration of the
Hamiltonian corresponding to (4) (for details see [26]). The
resulting minimum transition time is a lower bound benchmark
for the transition times that can be achieved with realistic input
currents. It also is the lower bound for the bit period Tbit = T
for which communication without laser induced inter-symbol
interference is possible. Figure 2 shows that the results we
obtain with our technique converge both in the shape of the
waveform and in the value of the transition time to the optimal-
control theory result as more base functions are included in
the optimization routine.

The down transition driving the laser from the “on” power
(Fig. 2d, e, and f) we
that values used for the

level
design exactly as before except

to the “off” power level

boundary conditions s(0) and s(T ) are reversed from the low
to high transition. The minimal transition times are displayed
in table II, where we show the results using two and twenty
base functions as well as using optimal control theory. It
is important to note that the down transition is not just a
time reversed version of the up transition, and that both the
transition times and the waveforms are different and have
to be designed separately. Most communication schemes are
evenly clocked, the time necessary to transmit a symbol is
independent of the particular information. Yet our results show
that the fundamental dynamics of the laser may mean that
approaching the optimal limits might imply using unequal
symbol times. We offer this as an idea to explore but we do
not pursue it further.

B. Performance

Using shaped input currents will result in a better BER
performance for high bit rates because we avoid errors caused
by inter-symbol interference due to the internal dynamics
of the laser. To show the possible improved communication
performance we compare NRZ bits obtained using the up and
down transitions that were designed by the presented technique
using two base functions (N=2 in (6)) to unshaped current
modulation.

A random sequence of bits is to be transmitted in this
numerical experiment. The bit sequence determines the shaped
current, shown in Fig.3a, which enters as driving term the laser
rate equations (4). The output s(τ ) is obtained by integration
of (4) and Fig.3b shows that s(τ ) switches, as was the design
goal, between the “on” and “off” state without any relaxation
oscillations. Transmitting 50 bits results in the state-space
trajectory presented in Fig.3c (thick line). The two ﬁxed points
(square and diamond) and the optimal control trajectory (dash-
dotted line) obtained by using non-continuous currents are also
shown.

The bit time for all the panels in Fig.3 was set to Tbit = 2.0.
We extend each transition to this time by appending the ap-
propriate interval of ﬁxed-point current. Since we normalized
time using ωR = 2πfr this implies that we communicate using
NRZ bits that last about one third of the relaxation oscillation
period 1/fr of the ﬁxed point (S0, N0).

We compare the bit errors using shaped currents to square-
like current modulation where, basically, the current follows
the NRZ bits but with ﬁnite rise times, to be slightly more
realistic. The up and down transitions of the square-like
driving current shown in Fig.3d was achieved using ‘tanh’
functions. The maximum slope of the current equals the
maximum slope of the shaped current shown in Fig.3a. Since
the bit time is short compared to the period of the laser’s
intrinsic relaxation oscillations, the state-space trajectory due
to the modulation of 50 NRZ-bits is complicated and exhibits
large excursions (see Fig.3f). Since the system does not reach
either one of the two ﬁxed points at the end of a bit-period,
there is considerable dynamic coupling from past to future
and hence inter-symbol interference. In Fig.3e we show the
output corresponding to the drive current above (Fig.3d). It is
apparent that even without channel noise the receiver will not

5

a)

)
s
t
i
n
u
 
.
b
r
a
(

t
n
e
r
r
u
C

 
 
 

b)

)
s
t
i
n
u
 
.
b
r
a
(
 
s

d)

 
t
n
e
r
r
u
C

 
 
 

)
s
t
i
n
u
 
.
b
r
a
(

e)

)
s
i
t
n
u
 
.
b
r
a
(
 
s

6

4

2

0

2

1

0

2

1

4

2

0

c)

)
s
t
i
n
u
 
.
b
r
a
(
 
n

0.1

0

-0.1

f)

)
s
t
i
n
u
 
.
b
r
a
(
 
n

0.2

0.1

0

-0.1

0 → 1 → 1 → 0 → 1 →  0 → 0 → 1 → 0 → 1

2
E

3
E

5
E

4
E

6
E

7
E

4
E

5
E

40
35
45
Time (in units of 1/ω

R)

50

0

1
s (arb. units)

2

0 → 1 → 1 → 0 → 1 →  0 → 0 → 1 → 0 → 1

40
35
45
Time (in units of 1/ω

R)

50

0

5

10

s (arb. units)

Fig. 3.
Comparison between shaped current modulation (a-c) and square-
like currents (d-f). Shaped drive currents (a) result in an optical laser output (b)
free of relaxation oscillations. For visual guidance, bit times are indicated by
dotted lines. Note that the currents were designed to optimize the transition
between the two logical states (“on” and “off” ) and consequently, in the
output, the assigned bits appear shifted by half a bit time. The bit assignment
is shown between panels a) and b) together with the corresponding bit energies
(see text). Square-like currents (d) result in an output (e) corrupted by strong
inter-symbol interference. Panels c) and f) are the corresponding state-space
plots (see text for further details).

be able to infer without error the bit sequence that was to be
transmitted.

To quantify the possible improved communication perfor-
mance we calculated bit error rates (BER). For illustration, a
simple additive white Gaussian noise corrupted a dispersion-
less channel. The overall conclusions drawn will apply to more
realistic channel models, since the performance enhancement
is due to avoiding inter-symbol interference in the laser and
should be largely independent of the characteristics of the
communication channel.

Figure 4 shows in the main panel the SNR versus the BER
for high bit rate (Tbit = 2) square-like current modulation
as squares and high bit rate shaped current modulation as
circles. Low bit rate (Tbit = 8) square-like current modulation
(squares) and low bit rate shaped current modulation (circles)
is presented in the inset of Fig. 4. These are results of nu-
merical experiments where one million random bits generated
a corresponding input current (either shaped or square-like)
to (4), which was integrated. To the resulting laser output an
appropriate amount of channel noise was added. The bits were
decoded at the receiver by integrating the received power over
each bit time (assuming a perfect clock) and by distinguishing
zero and one bits through simple thresholding. This way an
estimate of the BER was obtained for each noise level.

For the case of square-like current modulation the threshold
used for bit detection was determined numerically. It was
optimized for each noise level separately. Furthermore, due to

0

10

-1

10

-2

10

-4

10

-5

10

-6

10

-3

10

R
E
B

0

10

-1

10

-2

10

-4

10

-5

10

-6

10

-3

10

R
E
B

-10

10

20

SNR in dB

0

0

-10

10

SNR in dB 

20

Fig. 4.
The signal-to-noise ratio (SNR) versus the bit-error-rate (BER)
is presented for the laser being driven by both shaped currents (circles and
lines) and square-like currents (squares). The main panel shows high bit rate
(Tbit = 2) and the inset lower bit rate (Tbit = 8) communication. The
symbols represent results obtained by numerical integration and the lines are
theoretical curves. We display as triangles results where stimulated emission
noise is simulated.

the complex dynamics of s(τ ), it is not immediately obvious
when to start the receiver clock that determines the beginning
and end of a bit (see Fig. 3e). Therefore the optimal starting
time was numerically estimated as well.

}

∈ {

1, 2, 3, 4

For a shaped current input, a simple theoretical expression
for the expected BER can be derived. Consider transmission
without channel noise ﬁrst. Without any noise the receiver
detects four different bit energies Ei (i
) sig-
nifying one bits.2 The largest energy E1 corresponds to a
one bit being both preceded and succeeded by a one bit,
the smallest energy E4 corresponds to a one bit being both
preceded and succeeded by a zero bit, whereas E2 and E3
correspond to one bits that contain an up or down transition
(see Fig. 3). Similarly, there are four energy levels (Ej
with j
) representing zero bits. The expected bit
error rate is obtained by evaluating the probability that the
energy that results after adding white Gaussian noise ξ with
variance σ2 to a zero bit energy level exceeds the threshold
Eth and by considering the probability that Ei + ξ < Eth for
. Doing this the theoretically expected BER can
i
be written in terms of the complementary error function:

5, 6, 7, 8

1, 2, 3, 4

∈ {

∈ {

}

}

BER =

8

1
8

i=1
X

1
2

erfc

(cid:18)

Ei
|

Eth

−
√2σ

|

.

(cid:19)

(7)

The resulting curves are plotted as lines in Fig.4 where a ﬁxed
threshold given by

1
2

Eth =

(Ei)
(cid:21)
2For the purpose of the numerical experiment we use E =

(Ej) + min
i∈[1...4]

max
j∈[5...8]

s(t)dt
for the bit energies because the photon density s(t) is proportional to the
laser output power.

Tbit
0

(8)

(cid:20)

R

6

was used.

Calculating the theoretically expected BER using the opti-
mal threshold value Eopt
th (σ), which can be derived from (7),
and which is a function of the noise strength, results in a curve
that to the eye is indistinguishable from the one displayed in
Fig.4. For this reason we used the simpler Eth given by (8)
in the numerical experiment determining the BER when using
shaped modulation currents.

The following conclusion can be drawn from the results pre-
sented in Fig. 4. As expected, using shaped current modulation
there is a very good agreement between the theoretical and
numerical result for both high and low bit rates, showing that
all errors are due to Gaussian channel noise. In contrast, Fig. 4
shows that high bit rates (Tbit = 2) for square-like current
modulation lead essentially to a communication breakdown.
Even for very small noise levels (high SNR) on average about
14 bits per 100 transmitted bits are wrongly decoded by the
receiver. These errors are caused by inter-symbol interference
due to the laser dynamics. For lower bit rates, that is bit rates
smaller than ωr/2π, the bit errors attributable to the laser
dynamics become more and more negligible, as is indicated
by the inset of Fig. 4, which shows that for lower bit rates
the performance enhancement due to the use of shaped input
currents is minor.

C. Noise and Parameter Mismatch

Semiconductor laser diodes are inherently noisy. To study
the effects of spontaneous emission noise on the proposed
communication scheme we conduct numerical experiments,
where rate equations that include appropriate stochastic terms
(Gaussian white noise) are driven by the shaped current,
which, as discussed above, was calculated based on the deter-
ministic model (4). The rate equation including spontaneous
emission terms and a description of the integrator can be found
in [22], [26].

For realistic values of the noise variance (same as in [22])
the performance advantage achieved by modulating the laser
with shaped input currents persists. Although noise causes the
state-space trajectory to deviate from the ideal trajectory, the
deviations remained for the bit sequences and noise realization
of our numerical experiments small enough to cause only
slight performance degradations. The BER performance calcu-
lated in one such numerical experiment is shown as triangles
in the main panel of Fig. 4. It is close to the theoretical curve
calculated for the noise free system and far better than square-
like modulation of a laser model free of spontaneous emission
noise.

The shaped current waveform that is used to achieve high
bit rate communications without inter-symbol interference was
calculated based on the model (4), the parameters of which
will be known only approximately for a given laser diode.
It is therefore important to consider the effects of parameter
mismatch between the model used to generate the shaped
driving current and the model used to numerically evaluate
the BER performance.

Figure 5 shows the degradation of the BER performance for
′.

differential gain mismatches, deﬁned as ∆ = (γn

γn) /γn

′

−

7

0

-3

-4×10

 
)
s
t
i
n
u

 
.

b
r
a
(
 
n

-3

-8×10

0

0.3
0.2
0.1
s (arb. units)

0.4

0
10

-1

10

-2

10

R
E
B

-3

10

-4

10

∆ = 10%
∆ = 8%
∆ = 6%
∆ = 4%
Theory
∆ = -6%
∆ = -10%

)
s
t
i
n
u
 
.
b
r
a
(
 
s

5

4

3

2

1

0

0

2

)
s
t
i
n
u
 
.
b
r
a
(
 
s

0
400

20

-5

10

300

-10

350
Time (in units of 1/ω

R)

0

10
SNR in dB

′ is the
Fig. 5. BER performances for mismatches ∆ =
estimated and γn the actual differential gain. The inset shows a time trace of
the photon density s for ∆ =
10% at the output of the laser. The bits are
clearly distinguishable.

, where γn

−

γn

′−γn
′
γn

′ denotes the estimated differential gain, the one used
Here γn
in the generation of the shaped drive current, and γn is the
actual parameter, the one characterizing the system driven by
the shaped currents. Overestimating of the differential gain
(∆ > 0) severely degrades performance for mismatches
>
5%, whereas underestimation (∆ < 0) has a far less noticeable
effect.

∆
|
|

The reason is that overestimating the differential gain im-
plies an overestimation of ωR, i.e. the response time of the
actual laser is slower than was assumed. The laser will have
slower rise and fall times and consequently a lower bit energy
for a one bit that is both preceded and succeeded by a zero bit.
Although the mean bit energy does not change signiﬁcantly,
the energy difference between the maximum energy for a zero
bit (maxj∈[5...8](Ej )) and the minimum energy for a one bit
(mini∈[1...4](Ei)) is decreased resulting in a higher BER.

A similar asymmetric performance degradation holds for
mismatches in the photon decay parameter γc. Performance is
most sensitive to mismatches of γc and γn and least sensitive
to mismatches in γp.

The unexpected asymmetry of the performance degradation
with estimation may suggests that, in practice, it may be
wiser to solve for state-space trajectories using slightly smaller
values of γc,n than the best available experimental estimations
of the parameters. This may reduce the risk to performance
from ﬂuctuations in γc,n.

IV. DISCUSSION

We demonstrate a technique to control the laser’s nonlinear
internal degrees of freedom to move along a speciﬁc state-
space trajectory by designing current input waveforms. This
intensity waveforms
can be used to optimize the optical
emitted to ﬁt certain desired characteristics.

50
Time (in units of 1/ω

R)

100

Fig. 6.
Evolution of the photon density s(t) in time for initial conditions
chosen randomly in the neighborhood of the correct initial state (a subset
of ten realizations is displayed, no noise and no mismatch).
Inset: Initial
conditions in state-space (circles) and where the trajectories in state-space
end up (squares) after driving currents for 49 random bits were applied.

On the example of time-optimized NRZ bits, the possible
BER performance enhancement due to the elimination of inter-
symbol interference is demonstrated. We furthermore show
that spontaneous emission noise and parameter mismatches
can be tolerated suggesting that this scheme can be used in
practice to enhance the communication data rate when directly
modulated lasers are used as transmitters.

Our numerical experiments show that including spontaneous
emission noise and small but ﬁnite parameter mismatches
leads to trajectories in state-space that are close to the ideal
one. This suggest that the trajectory we obtain in the opti-
mization is robust with respect to perturbations. In numerical
investigations it appears that the state-space trajectory is also
stable in the sense that, starting from slightly perturbed initial
conditions, trajectories converge to the ideal one, when the
system is driven by the same bit sequence. The result of
one such numerical experiment is shown in Fig. 6, where
initial relaxation oscillations soon disappear as the trajectories
converge.

Theoretically, an open dynamical-systems question is
whether there is some kind of easily computable generalized
stability property that would quantify whether the controlled
system is stable even under arbitrary message driving. It
would be desirable to build this property into the optimization
target to ensure that the solutions found are also stable. In
our model it was fortuitous that all solutions were stable
with the parameters we used, but this was not guaranteed
by the method, and at present the best check is empirical
integration under perturbations. We also speculate that the
relative advantage of dynamically-aware current-shaping over
conventional direct modulation could be signiﬁcantly larger
if, instead of transmitting binary symbols (two energy levels),
the system was controlled to a higher alphabet. The net
result of our pulse shaping is to radically reduce that part of
variance which is due to dynamics in the optical intensities
of the different received symbols. If the ﬂuctuations from

inter-symbol dynamics are eliminated, leaving only detector
noise and spontaneous emission, then it is conceivable that
one could transmit with more than two distinct optical levels
for the symbols, and still reliably decode them. This would
improve useful data rate versus binary transmission even
without increasing the rate of symbols being transmitted.

The key technological issue is whether the proposed direct-
modulation scheme using shaped currents can be implemented
at low cost. Existing technology has been developed for clock
equalization, generating fast fronts at gigahertz speeds which
could subsequently be shaped using delay line techniques [27].
Thus, current shaping is in principle electrically achievable.
We speculate that the laser and the current shaping electronics
could be integrated on one chip so that the overall cost should
be comparable to that of traditional single-mode-lasers. We
hope that the potential of current-shaping to mitigate problems
that have plagued the direct-modulation approach to high-
speed communication will stimulate further research and lead
to practical applications.

REFERENCES

[1] C. H. Lee, T. H. Yoon, and S. Y. Shin, “Period doubling and chaos
in a directly modulated laser diode,” Appl.Phys.Lett., vol. 46, no.1, pp.
95-97, Jan. 1985

[2] Y. C. Chen, H. G. Winful, and J. M. Liu, “Subharmonic bifurcations
and irregular pulsing behaviour of modulated semiconductor lasers,”
Appl.Phys.Lett., vol. 47, no.3, pp. 208-210, Aug. 1985

[3] M. Tang and S. Wang, “Simulation studies of bifurcation and chaos
in semiconductor lasers,” Appl.Phys.Lett., vol. 48, no.14, pp. 900-902,
April 1986

[4] G. P. Agrawal, “Effect of gain nonlinearities on period doubling and
chaos in directly modulated semiconductor lasers”, Appl.Phys.Lett., vol.
49, no.16, pp. 1013-1015, Oct. 1986

[5] W. Lauterborn and R. Steinhoff, “Bifurcation structure of a laser with
pump modulation,” J. Opt. Soc. Am. B, vol. 5, no. 5, pp. 1097-1104,
May 1988

[6] H. Lamela, G. Carpintero, and F. J. Mancebo, “Period tripling and chaos
in the dynamic behavior of directly modulated diode lasers,” IEEE J.
Quantum Electron., vol. QE-34, no.10, pp. 1797-1801, Oct. 1998
[7] K. A. Corbett and M. W. Hamilton, “Comparison of the bifurcation
scenarios predicted by the single-mode and multimode semiconductor
rate equations,” Phys. Rev. E, vol. 62, no.5, pp. 6487-6495, Nov. 2000
[8] H. F. Liu and W. F. Ngai, “Nonlinear dynamics of a directly modulated
1.55 µm InGaAsP distributed feedback semiconductor laser,” IEEE J.
Quantum Electron., vol. QE-29, no.6, pp. 1668-1675, June 1993
[9] P. Colet, C. R. Mirasso, and M. S. Miguel, “Memory Diagram of Single-
Mode Semiconductor Lasers”, IEEE J. Quantum Electron., vol. QE-29,
pp. 1624-1630, June 1993

[10] K. Petermann, Laser Diode Modulation and Noise (Kluwer, Tokyo,

1988)

[11] K. Y. Lau and A. Yariv, “Ultra-High Speed Semiconductor Lasers”,
IEEE J. Quantum Electron., vol. QE-21, pp. 121-138, Feb. 1985
[12] R. S. Tucker, “High-Speed Modulation of Semiconductor Lasers”, J.

Lightwave Technol., vol. LT-3, pp. 1180-1192, Dec. 1985

[13] S. Riyopoulos, “Elimination of transient vertical-cavity surface-emitting
laser oscillations using photoactive feedback”, Appl. Phys. Lett., vol. 75,
pp. 3057-3059, Nov. 1999

[14] C. R. Mirasso, E. Hernandez-Garcia, J. Dellunde, M. C. Torrent, and J.
M. Sancho, “Analytical calculations of switch-on time and timing jitter
in diode lasers subjected to optical feedback and external light injection”,
Opt. Comm., vol. 115, pp. 523-527, April 1995

[15] Y. Suematsu and T. H. Hong “Suppression of Relaxation Oscillation
in Light Output of Injection by Electrical Resonance Circuit”, IEEE J.
Quantum Electron., vol. QE-13, pp. 756-762, Sept. 1977

[16] M. Danielsen, “A Theoretical Analysis for Gigabit/Second Pulse Code
Modulation of Semiconductor Lasers”, IEEE J. Quantum Electron., vol.
QE-12, pp. 657-660, Nov. 1976

8

[17] P. Torphammar, R. Tell, H. Eklund, and A. R. Johnston, “ Minimizing
Pattern Effects in Semiconductor Lasers at High Rate Pulse Modula-
tion”, IEEE J. Quantum Electron., vol. QE-15, pp. 1271-1276, Nov.
1979

[18] R. Olshansky and D. Fye, “Reduction of dynamics linewidth in single-
frequency semiconductor lasers”, Electron. Lett., vol. 20, pp. 928-929,
Oct. 1984

[19] L. Bickers and L. D. Westbrook, “Reduction of transient laser chirp in
1.5 µm DFB lasers by shaping the modulation pulse”, IEE Proceedings,
Pt. J, vol. 133, pp. 155-162, April 1986

[20] N. Dokhane and G. L. Lippi, “Improved direct modulation technique
for faster switching of diode laser”, IEE Proc.-Optoelectron., vol. 149,
pp.7-16, Feb. 2002

[21] J. M. Liu and T. B. Simpson, “Four-Wave Mixing and Optical Modula-
tion in a Semiconductor Laser”, IEEE J. Quantum Electron., vol. QE-30,
pp. 957-965, April 1994

[22] H. D. I. Abarbanel, M. Kennel, L. Illing, S. Tang, H.F. Chen and J.M.
Liu, “Synchronization and Communication Using Semiconductor Lasers
With Optoelectronic Feedback”, IEEE J. Quantum Electron., vol. QE-
37, pp. 1301-1311, Oct. 2001

[23] P.E. Gill, W. Murray, M.A. Saunders, and M.H. Wright, “Some theoreti-
cal properties of an augmented Lagrangian merit function”, Advances in
Optimization and Parallel Computing, P.M. Pardalos, ed., North Holland,
1992, pp. 101–128.

[24] P.E. Gill, W. Murray, M.A. Saunders, and M.H. Wright, “User’s Guide
for NPSOL (Version 4.0): A Fortran package for nonlinear program-
ming”, Report SOL 86-2, Department of Operations Research, Stanford
University, Stanford, CA, 1986

[25] M. Athans and P. L. Flab, Optimal Control: An Introduction to the
Theory and Its Applications, McGraw-Hill Book Company, 1966
[26] L. Illing, Chaos synchronization and communication in semiconductor
lasers, Thesis (Ph.D.), University of California, San Diego, 2002
[27] W. J. Dally, J. Poulton, “Transmitter equalization for 4-Gbps signaling”,

IEEE Micro, vol. 17, pp. 48-56, Jan. 1997

Lucas Illing was born in Halle, Germany, in 1973.
He received his Vordiplom in 1996 from the Hum-
boldt University in Berlin, Germany and in 2002 the
Ph.D. in Physics from the University of California,
San Diego. He is a Research Assistant at Duke
University. His research is primarily concerned with
chaos synchronization, control, and communication
using chaos.

Matthew B. Kennel was born in Santa Monica, California in 1968. He
received the A.B. degree in physics in 1989 from Princeton University
and in 1995 the Ph.D. in physics from the University of California, San
Diego. After a Department of Energy postdoctoral fellowship at the Oak
Ridge National Laboratory, he joined the Institute for Nonlinear Science at
UCSD as an Assistant Research Scientist. His research interests are in chaotic
communication and the application of information theoretical algorithms to
observed nonlinear dynamics.

