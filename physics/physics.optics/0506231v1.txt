5
0
0
2
 
n
u
J
 
0
3
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
1
3
2
6
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

DEUTSCHES ELEKTRONEN-SYNCHROTRON

in der HELMHOLTZ-GEMEINSCHAFT

DESY 05-109

June 2005

Understanding transverse coherence
properties of X-ray beams in third generation
Synchrotron Radiation sources

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and
Mikhail Yurkov
Deutsches Elektronen-Synchrotron DESY, Hamburg

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

Understanding transverse coherence
properties of X-ray beams in third generation
Synchrotron Radiation sources

Gianluca Geloni a Evgeni Saldin a Evgeni Schneidmiller a
Mikhail Yurkov a

aDeutsches Elektronen-Synchrotron (DESY), Hamburg, Germany

Abstract

This paper describes a theory of transverse coherence properties of Undulator Radi-
ation. Our study is of very practical relevance, because it yields speciﬁc predictions
of Undulator Radiation cross-spectral density in various parts of the beamline. On
the contrary, usual estimations of coherence properties assume that the undulator
source is quasi-homogeneous, like thermal sources, and rely on the application of
van Cittert-Zernike (VCZ) theorem, in its original or generalized form, for calculat-
ing transverse coherence length in the far-ﬁeld approximation. The VCZ theorem is
derived in the frame of Statistical Optics using a number of restrictive assumptions:
in particular, the quasi-homogeneous assumption is demonstrated to be inaccurate
in many practical situations regarding undulator sources. We propose a technique
to calculate the cross-spectral density from undulator sources in the most general
case. Also, we ﬁnd the region of applicability of the quasi-homogeneous model and
we present an analytical expression for the cross-spectral density which is valid up
to the exit of the undulator. For the case of more general undulator sources, simple
formulas for the transverse coherence length, interpolated from numerical calcula-
tions and suitable for beamline design applications are found. Finally, using a simple
vertical slit, we show how transverse coherence properties of an X-ray beam can be
manipulated to obtain a larger coherent spot-size on a sample. This invention was
devised almost entirely on the basis of theoretical ideas developed throughout this
paper.

Key words:
X-ray beams, Undulator radiation, Transverse coherence, Van Cittert-Zernike
theorem, Emittance eﬀects
PACS: 41.60.m, 41.60.Ap, 41.50 + h, 42.50.Ar

Preprint submitted to Elsevier Science

2 February 2008

1

Introduction

In recent years, continuous evolution of third generation light sources has
allowed dramatic increase of brilliance with respect to older designs, which
has triggered a number of new techniques and experiments unthinkable before.
Among the most exciting properties of today third generation facilities is the
high ﬂux of coherent X-rays provided. The availability of intense coherent X-
ray beams has fostered the development of new coherence-based techniques like
ﬂuctuation correlation dynamics, phase imaging, coherent X-ray diﬀraction
(CXD) and X-ray holography. In this context, understanding the evolution
of transverse coherence properties of Synchrotron Radiation (SR) along the
beam line is of fundamental importance.

In general, when dealing with this problem, one should account for the fact
that Synchrotron Radiation is a random statistical process. Therefore, the
evolution of transverse coherence properties should be treated in terms of
probabilistic statements: the shot noise in the electron beam causes ﬂuctua-
tions of the beam density which are random in time and space. As a result,
the radiation produced by such a beam has random amplitudes and phases.

Statistical Optics [5, 6, 10] aﬀords convenient tools to deal with ﬂuctuating
electromagnetic ﬁelds in an appropriate way. Among the most important quan-
tities needed to describe coherent phenomena in the framework of Statistical
Optics is the correlation function of the electric ﬁeld. In any interference ex-
periment one needs to know the system (second order) correlation function
of the signal at a certain time and position with the signal at another time
and position. Alternatively, and equivalently, one can describe the same ex-
periment in frequency domain. In this case one is interested in the correlation
function of the Fourier transform of the time domain signal at a certain fre-
quency and position with the Fourier transform of the time domain signal
at another frequency and position. The signal one is interested to study is,
indeed, the Fourier transform of the original signal in time domain. In SR
experiments the analysis in frequency domain is much more natural than that
in the time domain. In fact, up-to-date detectors are limited to about 100 ps
time resolution and they are by no means able to resolve a single X-ray pulse
in time domain. They work, instead, by counting the number of photons at
a certain frequency over an integration time longer than the radiation pulse.
Therefore, in this paper we will deal with signals in the frequency domain and
we will often refer to the ”Fourier transform of the electric ﬁeld” simply as
”the ﬁeld”.

For some particular experiment one may be interested in higher order correla-
tion functions (for instance, in the correlation between the intensities) which,
in general, must be calculated separately. In the particular case when the ﬁeld

3

ﬂuctuations can be described as a Gaussian process, the ﬁeld is often said to
obey Gaussian statistics. In this case, with the help of the Moment Theorem
[5] one can recover correlation functions of any order from the knowledge of
the second order one: this constitutes a great simpliﬁcation to the task of de-
scribing coherence properties of light. A practical example of a ﬁeld obeying
Gaussian statistics is constituted by the case of polarized thermal light. This
is more than a simple example: in fact, Statistical Optics has largely developed
in connection with problems involving optical sources emitting thermal light
like the sun, other stars, or incandescent lamps. As a consequence, Gaussian
statistics is often taken for granted. Anyway, it is not a priori clear wether
Synchrotron Radiation ﬁelds obey it or not; our analysis will show that Syn-
chrotron Radiation is indeed a Gaussian random process. Therefore, as is also
the case for polarized thermal light and any other signal obeying Gaussian
statistics, when we deal with Synchrotron Radiation the basic quantity to
consider is the second order correlation function of the ﬁeld. Moreover, as al-
ready discussed, in Synchrotron Radiation experiments it is natural to work in
the space-frequency domain, so that we will focus, in particular, on the second
order correlation function in the space-frequency domain.

Besides obeying Gaussian statistics, polarized thermal light has two other spe-
ciﬁc properties allowing simpliﬁcations of the theory: the ﬁrst is stationarity 1
and the second is quasi-homogeneity. Exactly as the property of Gaussian
statistics, also stationarity and quasi-homogeneity of the source are usually
taken for granted in Statistical Optics problems but, unlike it, they do not
belong, in general, to Synchrotron Radiation ﬁelds. In fact, as we will show,
Synchrotron radiation ﬁelds are intrinsically non-stationary and not always
quasi-homogeneous. Nevertheless, up to now it has been a widespread prac-
tice to assume that undulator sources are completely incoherent (i.e. homo-
geneous) and to apply the well known van Cittert-Zernike (VCZ) theorem for
calculating the degree of transverse coherence in the far-ﬁeld approximation
[1]. Using the VCZ theorem, the electric ﬁeld cross-correlation function in the
far ﬁeld is usually calculated (aside for a geometrical phase factor) as a Fourier
transformation of the intensity distribution of the source, customarily located
at the exit of the undulator.

Although the VCZ theorem only deals with completely incoherent sources,
there exists an analogous generalized version of it which allows to extend
the treat the case of quasi-homogeneous sources as well. Actually there is
no unambiguous choice of terminology in literature regarding the scope of
the VCZ theorem. For instance, a very well-known textbook [6] reports of a
”Zernike-propagation” equation dealing with any distance from the source.
Also, sometimes [5], the generalized VCZ theorem is referred to as Schell’s

1 Here we do not distinguish between diﬀerent kind of stationarity because, under
the assumption of a Gaussian process, these concepts simply coincide.

4

theorem (and also used in some paper [2]). In this paper we will refer to the
VCZ theorem and its generalized version only in the limit for a large distance
from the source and for, respectively, homogeneous and quasi-homogeneous
sources. However, irrespectively of diﬀerent denominations, the fundamental
fact holds, that once a cross-correlation function is known on a given source
plane it can be propagated through the beamline at any distance from the
source. It should be noted that, from this viewpoint, a source simply denotes
an initial plane down the beamline from which the cross-correlation function
is propagated further. Then, the position of the source down the beamline
is suggested only on the ground of opportunity. On the contrary, when deal-
ing with the VCZ theorem, the source must be (quasi)-homogeneous which
explains the customary location at the exit of the undulator.

In some cases, the VCZ theorem or its generalized version may provide a con-
venient method for calculating the degree of transverse coherence in various
parts of the beamline once the transverse coherence properties of the photon
beam are speciﬁed at the exit of the undulator, that is at the source plane. In
most SR applications though, such treatment is questionable. First, the source
(even at the exit of the undulator) may not be quasi-homogeneous. Second,
even for speciﬁc sets of problem parameters where the quasi-homogeneous
model is accurate, the speciﬁcation of the far-ﬁeld zone depends not only on
the electron beam sizes, but also on the electron beam divergencies (in both
direction) and on the intrinsic divergence of the radiation connected with the
undulator device. At the time being, widespread and a-critical use of the VCZ
theorem and its generalization shows that there is no understanding of trans-
verse coherence properties of X-ray beams in third generation Synchrotron
Radiation sources.

If, on the one hand, the deﬁnition of the far-zone and the possible non quasi-
homogeneity of SR sources constitute serious problems in the description of
the coherence properties of Synchrotron light, on the other hand the intrinsic
non-stationarity of the SR process does not play a very important role. In par-
ticular, as we will show, assumption of a minimal undulator bandwidth much
larger than the characteristic inverse bunch duration (which is always veriﬁed
in practice) allows to separate the correlation function in space-frequency do-
main in the product of two functions. The ﬁrst function is a spectral correlation
describing correlation in frequency. The second function describes correlation
in space and is well-known also in the case of stationary processes as the cross-
spectral density of the process. Then, the cross-spectral density can be studied
independently at any given frequency giving information on the spatial cor-
relation of the ﬁeld. Subsequently, the knowledge of the spectral correlation
function brings back the full expression for the space-frequency correlation.

In this paper we aim at the development of a theory of transverse coherence
capable of providing very speciﬁc predictions, relevant to practice, regarding

5

the cross-spectral density of undulator radiation at various positions along
the beam-line. A fully general study of undulator sources is not a trivial one.
Diﬃculties arise when one tries to include simultaneously the eﬀect of intrinsic
divergence of the radiation due to the presence of the undulator, of electron
beam size and electron beam divergence into the insertion device. The full
problem, including all eﬀects, poses an unsolvable analytical challenge, and
numerical calculations are to be preferred. Generally, the cross-spectral density
of the undulator radiation is controlled by nine physical parameters which
model both the electron beam and the undulator: the horizontal and vertical
geometrical emittances of the electron beam ǫx,y, the horizontal and vertical
minimal betatron functions βo
x,y, the observation distance down the beamline
zo, the observation frequency ω, the undulator resonant frequency ωo, the
undulator length Lw and the length of the undulator period λw.

We will make a consistent use of dimensional analysis. Dimensional analysis
of any problem, performed prior to analytical or numerical investigations, not
only reduces the number of independent terms, but also allows one to clas-
sify the grouping of dimensional variables in a way that is most suitable for
subsequent study. The algorithm for calculating the cross-spectral density can
be formulated as a relation between dimensionless quantities. After appro-
priate normalization, the radiation cross-spectral density from an undulator
device is described by six dimensionless quantities: the normalized emittances
ˆǫx,y = ωoǫx,y/c, the normalized betatron functions ˆβx,y = βo
x,y/Lw, the normal-
ized observation distance ˆzo = zo/Lw and the normalized detuning parameter
ˆC = 2πNw(ω
ωo)/ωo, where Nw = Lw/λw is the number of undulator periods.

−

At some point in this work we will ﬁnd it convenient to pose ˆC = 0. In other
words we will assume that parameters are tuned at perfect resonance. It is
relevant to note that even under this simplifying assumptions, conditions for
the undulator source to be quasi-homogeneous still include four parameters ˆǫx,y
and ˆβx,y. For storage rings that are in operation or planned in the ˚Angstrom
wavelength range, the parameter variation of ˆǫx ∼
10,
ˆβx,y ∼
10 are possible: these include many practical situations in which
the assumption of quasi-homogeneous sources and, therefore the (generalized)
VCZ theorem, is not accurate.

103, ˆǫy ∼

10−1

10−1

10

−

−

−

In this paper we will ﬁrst deal with the most general case of non-homogeneous
sources. In fact, from a practical viewpoint, it is important to determine the
cross-spectral density as a function of ˆǫx,y, ˆβx,y, ˆC and ˆzo. Once a general
expression for the cross-spectral density is found, it can be used as a basis
for numerical calculations. A second goal of this work is to ﬁnd the region of
applicability of the quasi-homogeneous source model (i.e. of the generalized
VCZ theorem) which will arise automatically from the dimensional analysis of
the problem. Finally, we will derive analytical expressions for the cross-spectral
density at ˆC = 0 in various parts of the beamline.

6

Results may also be obtained using numerical techniques alone, starting from
the Lienard-Wiechert expressions for the electromagnetic ﬁeld and applying
the deﬁnition of the ﬁeld correlation function without any analytical manipu-
lation. Yet, computer codes can calculate properties for a given set of param-
eters, but can hardly improve physical understanding, which is particularly
important in the stage of planning experiments: understanding of correct ap-
proximations and their region of applicability with the help of a consistent use
of dimensional analysis can simplify many tasks a lot, including practical and
non-trivial ones. Moreover, at the time being, no code capable to deal with
transverse coherence problems has been developed at all.

It should be noted that some theoretical attempt to follow this path has been
proposed in [4]. Among the results of that paper is the fact that van Cittert-
Zernike theorem could not be applied unless the electron beam divergence is
much smaller than the diﬀraction angle, which is never veriﬁed in practice in
the horizontal plane. We will show that this conclusion is incorrect.

We organize our work as follows. After this Introduction, in Section 2 we
present a second-order theory of coherence for ﬁelds generated by Synchrotron
Radiation sources. In Section 3 we give a derivation of the cross-spectral den-
sity for undulator-based sources in reduced units. Subsequently, we analyze
the evolution of the cross-spectral density function through the beamline in
the limit for ˆC = 0. A particular case of quasi-homogeneous sources and its ap-
plicability region is treated under several simplifying assumptions in Section 4.
Eﬀects of the vertical emittance on the cross-spectral density are discussed in
detail in Section 5, while a treatment of some non quasi-homogeneous source is
given in the following Section 6. Obtained results include approximate design
formula capable of describing in very simple terms the evolution of the coher-
ence length along the beamline in many situation of practical interest. A good
physical insight is useful to identify possible applications of given phenomena.
In particular in Section 7 we selected one practical application to exploit the
power of our approach. We show that, by means of a simple vertical slit, it
is possible to manipulate transverse coherence properties of an X-ray beam
to obtain a convenient coherent spot-size on the sample. This invention was
devised almost entirely on the basis of theoretical ideas of rather complex and
abstract nature which have been described in this paper. Finally, in Section
8, we come to conclusions.

7

Fig. 1. Light intensity from an incandescent lamp driven by a constant electric
current. A statistically stationary wave has an average that does not vary with
time.

2

Second-order coherence theory of ﬁelds generated by Synchrotron
Radiation sources

2.1 Thermal light and Synchrotron Radiation: some concepts and deﬁnitions

A great majority of optical sources emits thermal light. Such is the case of the
sun and the other stars, as well as of incandescent lamps. This kind of radia-
tion consists of a large number of independent contributions (radiating atoms)
and is characterized by random amplitudes and phases in space and time. The
electromagnetic ﬁelds can be then conveniently described in terms of Statisti-
cal Optics, a branch of Physics that has been intensively developed during the
last few decades. Today one can take advantage of a lot of existing experience
and theoretical basis for the descriptions of ﬂuctuating electromagnetic ﬁelds
[5, 6].

Consider the light emitted by a thermal source passing through a polariza-
tion analyzer (see Fig. 1). Properties of polarized thermal light are well-known
in Statistical Optics, and are referred to as properties of completely chaotic,
polarized light [5, 6]. Thermal light is a statistical random process and state-
ments about such process are probabilistic statements. Statistical processes
are handled using the concept of statistical ensemble, drawn from Statistical
Mechanics, and statistical averages are performed indeed, over many ensem-
bles, or realizations, or outcomes of the statistical process under study.

8

Polarized thermal light is a very particular kind of random process in that
it is Gaussian, stationary and ergodic. Let us discuss these characteristics in
more detail.

The properties of Gaussian random processes are well-known in Statistical
Optics. For instance, the real and imaginary part of the complex amplitudes
of the electric ﬁeld from a polarized thermal source have Gaussian distribu-
tion, while the instantaneous radiation power ﬂuctuates in accordance with the
negative exponential distribution. Gaussian statistics alone, guarantees that
higher-order correlation functions can be expressed in terms of second-order
correlation functions. Moreover, it can be shown [5] that a linearly ﬁltered
Gaussian process is also a Gaussian random process. As a result, the presence
of a spectral ﬁlter (monochromator) and a spatial ﬁlter as in the system de-
picted in Fig. 1 do not change the statistics of the signal, because they simply
act as linear ﬁlters.

Stationarity is a subtle concept. There are diﬀerent kinds of stationarity.
Strict-stationarity means that all ensemble averages are independent on time.
Wide-sense stationarity means that the signal average is independent on time
and that the second order correlation function in time depends only on the
diﬀerence of the observation times. However, for Gaussian processes strict and
wide-sense stationarity coincide [5, 6]. As a consequence of the deﬁnition of
stationarity, necessary condition for a certain process to be stationary is that
the signal last forever. Yet, if a signal lasts much longer than its coherence
time τc (which ﬁxes the short-scale duration of the ﬁeld ﬂuctuations) and it is
observed for a time much shorter than its duration σT , but much longer than
its coherence time it can be reasonably considered as everlasting and it has a
chance to be stationary as well, as in the case of thermal light.

Ergodicity is a stronger requirement than stationarity. Qualitatively, we may
state that if, for a given random process all ensemble averages can be substi-
tuted by time averages, the process under study is said to be ergodic: all the
statistical properties of the process can be derived from one single realization.
A process must be strictly stationary in order to be ergodic. There exist sta-
tionary processes which are not ergodic. One may consider, for instance, the
random constant process: this is trivially strictly stationary, but not ergodic
because a single (constant) realization of the process does not allow one to
characterize the process from a statistical viewpoint. However, this is a patho-
logic case when both the coherence time τc and the duration time of the signal
σT are inﬁnite. On the contrary, a stationary process like the radiation from
an incandescent lamp driven by a constant current has, virtually, inﬁnite du-
ration. In this case diﬀerent ensembles are simply diﬀerent observations, for
given time intervals, of the same, statistically identical phenomenon: then, the
concept of ensemble average and time average are equivalent and the process
is also ergodic.

9

Fig. 2. The intensity of an X-ray beam from a Synchrotron Radiation source.
A statistically non-stationary wave has a time-varying intensity averaged over an
ensemble of bunches.

Statistical Optics was developed starting with signals characterized by Gaus-
sian statistics, stationarity and ergodicity. Let us consider any Synchrotron
radiation source. Like thermal light, also Synchrotron Radiation is a random
process. In fact, relativistic electrons in a storage ring emit Synchrotron Ra-
diation passing through bending magnets or undulators. The electron beam
shot noise causes ﬂuctuations of the beam density which are random in time
and space from bunch to bunch. As a result, the radiation produced has ran-
dom amplitudes and phases. As already declared in the Introduction we will
demonstrate that the SR ﬁeld obeys Gaussian statistics. In contrast with ther-
mal light though, Synchrotron Radiation is intrinsically non-stationary (and,
therefore, non-ergodic) because even if its short pulse duration cannot be
resolved by detectors working in the time domain, it can nonetheless be re-
solved by detectors working in frequency domain. For this reason, in what
follows the averaging brackets
will always indicate the ensemble aver-
age over bunches. In spite of diﬀerences with respect to the simpler case of
thermal light, as we will see in this paper, also Synchrotron Radiation ﬁelds
can be described in terms of Statistical Optics. Fig. 2 shows the geometry of
the experiment under consideration. The problem is to describe the statistical
properties of Synchrotron Radiation at the detector installed after the spatial
and spectral ﬁlters. Radiation at the detector consists of a carrier modulation
of frequency ω subjected to random amplitude and phase modulation. The
Fourier decomposition of the radiation contains frequencies spread about the
monochromator bandwidth ∆ωm: it is not possible, in practice, to resolve the
oscillations of the radiation ﬁelds which occur at the frequency of the carrier
modulation. It is therefore appropriate, for comparison with experimental re-

...
i

h

10

Fig. 3. Reciprocal width relations of Fourier transform pairs.

sults, to average the theoretical results over a cycle of oscillations of the carrier
modulation.

Fig. 3 gives a qualitative illustration of the type of ﬂuctuations that occur in
cycle-averaged Synchrotron Radiation beam intensity. Within some character-
istic time, a given random function appears to be smooth, but when observed
at larger scales the same random function exhibits ”rough” variations. The
time scale of random ﬂuctuations is the coherence time τc. When τc ≪
σT
the radiation beyond the monochromator is partially coherent. This case is
shown in Fig. 3: there, we can estimate τc ≃
m . If the radiation beyond
the monochromator is partially coherent, a spiky spectrum is to be expected.
The nature of the spikes is easily described in terms of Fourier transform the-
ory. We can expect that the typical width of the spectrum envelope should be
(τcω)−1. Also, the spectrum of the radiation from a bunch
of order of ∆ω/ω
with typical duration σT at the source plane should contain spikes with char-
(ωσT )−1, as a consequence of the reciprocal width
acteristic width ∆ω/ω
relations of Fourier transform pairs (see, again, Fig. 3).

∆ω−1

∼

≃

2.2

Second-order correlations in space-frequency domain

We start our discussion in the most generic way possible, considering a ﬁxed
polarization component of the Fourier transform at frequency ω of the electric
ﬁeld produced at location (zo, ~r⊥o), in some cartesian coordinate system, by a
given collection of sources. We will denote it with ¯E⊥(zo, ~r⊥o, ω) and it will be

11

linked to the time domain ﬁeld E⊥(zo, ~r⊥o, t) through the Fourier transform

¯E⊥(ω) =

dtE⊥(t)eiωt ,

so that

E⊥(t) =

dω ¯E⊥(ω)e−iωt .

∞

Z−∞

1
2π

∞

Z−∞

(1)

(2)

This very general collection of sources includes the case of an ultra relativistic
electron beam going through a certain magnetic system and in particular an
undulator, which is our case of interest. In this case zo is simply the observa-
tion distance along the optical axis of the system and ~r⊥o are the transverse
coordinates of the observer on the observation plane. The contribution of the
k-th electron to the ﬁeld Fourier transform at the observation point depends on
the transverse oﬀset (lxk, lyk) and deﬂection angles (ηxk, ηyk) that the electron
has at the entrance of the system with respect to the optical axis. Moreover,
an arrival time tk at the system entrance has the eﬀect of multiplying the ﬁeld
Fourier transform by a phase factor exp (iωtk) (that is, in time domain the
electric ﬁeld is retarded by a time tk). At this point we do not need to spec-
ify explicitly the dependence on oﬀset and deﬂection. The total ﬁeld Fourier
transform can be written as

¯E⊥(zo, ~r⊥o, ω) =

¯Es⊥(~ηk,~lk, zo, ~r⊥o, ω) exp (iωtk) ,

(3)

N

Xk=1

where ~ηk,~lk and tk are random variables and N is the number of electrons
in the beam. It follows from Eq. (3) that the Fourier transform of the Syn-
chrotron Radiation pulse at a ﬁxed frequency and a ﬁxed point in space is a
sum of a great many independent contributions, one for each electron, of the
form ¯Es⊥(~ηk,~lk, zo, ~r⊥o, ω) exp (iωtk). For simplicity we make three assump-
tions about the statistical properties of elementary phasors composing the
sum, which are generally satisﬁed in Synchrotron Radiation problems of in-
terest.

1) We assume that for a beam circulating in a storage ring random variables
tn are independent from ~ηn and ~ln. This is always veriﬁed, because the random
arrival times of electrons, due to shot noise, do not depend on the electrons
oﬀset and deﬂection with respect to the z-direction. Eq. (3) states that the
k-th elementary contribution to the total ¯E⊥ can be written as a product of
the complex phasors exp (iωtk), and ¯Es⊥ that, in its turn, can be written as
a product of modulus and phase as ¯Es⊥(~ηk,~lk, zo, ~r⊥o, ω) =
exp (iφk).

¯Es⊥k |

|

12

Under the assumption of statistical independence of tn from ~ηn and ~ln the
complex phasors exp (iωtk), and ¯Es⊥ are statistically independent of each other
and of all the other elementary phasors for diﬀerent values of k. The ensemble
average of a given function f of random variables ~ηn, ~ln and tn is by deﬁnition:

∞

∞

∞

∞

∞

f (~ηn,~ln, tn)

=

i

h

dηxn

dηyn

dlxn

dlyn

dtn

Z−∞

Z−∞

Z−∞

Z−∞

Z−∞

f (~ηn,~ln, tn)P (~ηn,~ln, tn) , (4)

×

where P (~ηn,~ln, tn) is the probability density distribution in the joint random
variables ~ηn, ~ln, tn. Independence of tn from ~ηn and ~ln allows us to write

P (~ηn,~ln, tn) = Fηx,lx(ηxn, lxn)Fηy,ly(ηyn, lyn)Ft(tn) ,

(5)

where we also assumed that the distribution in the horizontal and vertical
planes are not correlated. Since electrons arrival times are completely uncor-
related from transverse coordinates and oﬀsets, the shapes of Fηx,lx, Fηy ,ly and
Ft are the same for all electrons.

2) We assume that the random variables
identically distributed for all values of k, with a ﬁnite mean
¯Es⊥k |
2
ﬁnite second moment
electrons are identical particles.

(at ﬁxed frequency ω), are
and a
. This is always the case in practice because

¯Es⊥k |i

h|

h|

i

|

¯Es⊥k |

3) We assume that the electron bunch duration σT is large enough so that
1: under this assumption the phases ωtk can be regarded as uniformly
ωσT ≫
distributed on the interval (0, 2π). The assumption ωσT ≫
1 is justiﬁed by
the fact that ω is the undulator resonant frequency, which is high enough to
1 for any practical choice of σT .
guarantee that ωσT ≫
The formal summation of phasors with random lengths and phases is illus-
trated in Fig. 4. Under the three previously discussed assumptions we can use
the central limit theorem to conclude that the real and the imaginary part
of ¯E⊥ are distributed in accordance to a Gaussian law. Detailed proof of this
fact is given in Appendix A. As a result, Synchrotron Radiation is a Gaussian
random process and second-order ﬁeld correlation function is all we need in
order to specify the ﬁeld statistical properties. In fact, as already remarked,
higher-order correlation functions can be expressed in terms of second-order
correlation functions.

In Synchrotron Radiation experiments with third generation light sources de-
tectors are limited to about 100 ps time resolution and are by no means able
to resolve a single X-ray pulse in time domain: they work, instead, by count-
ing the number of photons at a certain frequency over an integration time

13

Fig. 4. Amplitude and phase of the resultant vector (total complex amplitude)
formed by a large number of complex phasors having random length and random
phase.

longer than the pulse. Therefore, for Synchrotron Radiation related issues the
frequency domain is much more natural a choice than the time domain, and
we will deal with signals in the frequency domain throughout this paper. The
knowledge of the second-order ﬁeld correlation function in frequency domain

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) =

⊥(zo, ~r⊥o2, ω′)

,

(6)

¯E⊥(zo, ~r⊥o1, ω) ¯E∗
D

E

is all we need to completely characterize the signal from a statistical view-
point. For the sake of completeness it is nonetheless interesting to remark
that it is possible (and often done, in Statistical Optics) to give equivalent
descriptions of the process in time domain as well. First, note that the time
domain process E⊥(t) is linked to ¯E⊥(ω) by Fourier transform, and that a lin-
early ﬁltered Gaussian process is also a Gaussian process (see [5] 3.6.2). As a
result, E⊥(t) is a Gaussian process as well. Second, the operation of ensemble
average is linear with respect to Fourier transform integration. This guaran-
tees, that the knowledge of Γω in frequency domain is completely equivalent to
the knowledge of the second-order correlation function between E⊥(zo, ~r⊥o1, t1)
and E⊥(zo, ~r⊥o2, t2). The latter is usually known as mutual coherence function
and was ﬁrst introduced in [9]:

Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) =

E⊥(zo, ~r⊥o1, t1)E∗

⊥(zo, ~r⊥o2, t2)

.

(7)

h

i

For the rest of this paper we will abandon almost entirely any reference to the
time domain and work consistently in frequency domain with the help of Eq.
(6) because, as has already been said, this is a natural choice for Synchrotron

14

Radiation applications. In particular, as has already been anticipated, under
non-restrictive assumptions on characteristic bandwidths of the process, it is
possible to break the correlation function Γω(ω, ω′) in space-frequency domain
ω′) ,
in the product of two factors, the spectral correlation function Fω(ω
and the cross-spectral density of the process Gω(zo, ~r⊥o1, ~r⊥o2, ω) [6]. The cross-
spectral density can be studied independently at any given frequency giving
information on the spatial correlation of the ﬁeld. Subsequently, the knowledge
of the spectral correlation function brings back the full expression for Γω.

−

Substituting Eq. (3) in Eq. (6) one has

N

*

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) =

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω)

Xm=1
s⊥(~ηn,~ln, zo, ~r⊥o2, ω′) exp [i(ωtm −
¯E∗

ω′tn)]

. (8)

+

N

×

Xn=1

Expanding Eq. (8) one has

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) =

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω)

N

Xm=1 *
s⊥(~ηm,~lm, zo, ~r⊥o1, ω′) exp [i(ω

¯E∗

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω) exp (iωtm)

ω′)tm]

−

+

+

×

+

Xm6=n *
¯E∗

×*

s⊥(~ηn,~ln, zo, ~r⊥o2, ω′) exp (

iω′tn)

. (9)

−

+

With the help of Eq. (4) and Eq. (5), the ensemble average
it can
be written as the Fourier transform of the bunch longitudinal proﬁle function
Ft(tk), that is

exp (iωtk)

h

∞

exp (iωtk)

h

it =

Z−∞

dtkFt(tk)eiωtk = Fω(ω) .

(10)

Using Eq. (10), Eq. (9) can be written as

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) =

Fω(ω

ω′)

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω)

N

Xm=1
s⊥(~ηm,~lm, zo, ~r⊥o2, ω′)

¯E∗

−

*

×

+

Fω(ω)Fω(

ω′)

−

+~η,~l

Xm6=n

15

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω)

¯E∗

s⊥(~ηn,~ln, zo, ~r⊥o2, ω′)

, (11)

+~η,~l*

+~η,~l

×*

−

−

ω(ω′) = Fω(

where F ∗
ω′) because Ft is a real function. When the radiation
wavelengths of interest are much shorter than the bunch length we can safely
neglect the second term on the right hand side of Eq. (11) since the form fac-
ω′) goes rapidly to zero for frequencies larger than the
tor product Fω(ω)Fω(
characteristic frequency associated with the bunch length: think for instance,
at a centimeter long bunch compared with radiation in the Angstrom wave-
length range. It should be noted, however, that when the radiation wavelength
of interested is longer than the bunch length the second term in Eq. (11) is
dominant with respect to the ﬁrst, because it scales with the number of par-
ticles squared : in this case, analysis of the second term leads to a treatment
of Coherent Synchrotron Radiation phenomena (CSR). In this paper we will
not be concerned with CSR and we will neglect the second term in Eq. (11),
assuming that the radiation wavelength of interest is shorter than the bunch
ω′) depends on the diﬀerence
length: then, it should be noted that Fω(ω
between ω and ω′, and the ﬁrst term cannot be neglected. We can therefore
write

−

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) =

N

Fω(ω

ω′)

−

Xm=1
s⊥(~ηm,~lm, zo, ~r⊥o2, ω′)

¯Es⊥(~ηm,~lm, zo, ~r⊥o1, ω) ¯E∗

×*

= NFω(ω

ω′)

¯Es⊥(~η,~l, zo, ~r⊥o1, ω) ¯E∗

s⊥(~η,~l, zo, ~r⊥o2, ω′)

. (12)

−

*

+~η,~l

+~η,~l

s⊥(~η,~l, zo, ~r⊥o2, ω′) with ¯E∗

As one can see from Eq. (12) each electron is correlated just with itself: cross-
correlation terms between diﬀerent electrons was, in fact, included in the sec-
ond term on the right hand side of Eq. (11), which has been dropped. It is
important to note that if the dependence of ¯Es⊥ on ω and ω′ is slow enough,
so that ¯Es⊥ does not vary appreciably on the characteristic scale of Fω, we
s⊥(~η,~l, zo, ~r⊥o2, ω) in Eq. (12). The
can substitute ¯E∗
situation is depicted in Fig. 5. On the one hand, the characteristic scale of
Fω is given by 1/σT , where σT is the characteristic bunch duration. On the
other hand, the bandwidth of single particle undulator radiation at resonance
is given by ωo/Nw, where ωo is the resonant frequency and Nw is the number
103). In the case of an electron beam the
of undulator periods (of order 102
undulator spectrum will exhibit a longer tail, as has been shown in [3], which
guarantees that ωo/Nw is, indeed, a minimum for the radiation bandwidth,
and is the right quantity to be compared with 1/σT . As an example, for wave-
lengths of order 1˚A, Nw ∼
1016 Hz
1010 Hz. As a result we can simplify Eq.
which is much larger than 1/σT ∼
(12) to

30 ps (see [1]), ωo/Nw ∼

103 and σT ∼
3

−

2

·

·

16

Fig. 5. Schematic illustration of the relative frequency dependence of the spec-
ω′) and of the cross-spectral density function (the
tral correlation function Fω(ω
cross-power spectrum) Gω(zo, ~r⊥o1, ~r⊥o2, ω) of the Synchrotron Radiation at points
~r⊥o1 and ~r⊥o2 at frequency ω.

−

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) = NFω(ω

ω′)Gω(zo, ~r⊥o1, ~r⊥o2, ω)

(13)

where

Gω(zo, ~r⊥o1, ~r⊥o2, ω) =

¯Es⊥(~η,~l, zo, ~r⊥o1, ω) ¯E∗

s⊥(~η,~l, zo, ~r⊥o2, ω)

. (14)

*

+~η,~l

Eq. (13) fully characterizes the system under study from a statistical view-
point. However, in practical situations, the observation plane is behind a
monochromator or, equivalently, the detector itself is capable of analyzing
the energy of the photons. The presence of a monochromator simply modiﬁes
the right hand side Eq. (13) for a factor T (ω)T ∗(ω′), where T is the monochro-
mator transfer function:

Γω(zo, ~r⊥o1, ~r⊥o2, ω, ω′) = NFω(ω

ω′)T (ω)T ∗(ω′)Gω(zo, ~r⊥o1, ~r⊥o2, ω) .(15)

Independently on the characteristics (and even on the presence) of the monochro-
mator, it should be noted that both in Eq. (13) and Eq. (15), correlation in
frequency and space are expressed by two separate factors. In particular, in
both these equation, spatial correlation is expressed by the cross-spectral den-
sity function Gω(zo, ~r⊥o1, ~r⊥o2, ω). In other words, we are able to deal separately
with spatial and spectral part of the correlation function in space-frequency
1/σT . From
domain with the only non-restrictive assumption that ωo/Nw ≫
now on we will be concerned with the calculation of the correlation function
Gω(zo, ~r⊥o1, ~r⊥o2, ω), independently on the shape of the remaining factors on
the right hand side of Eq. (15) which can have a simple or a complicated
structure, accounting for the characteristics of the monochromator.

−

−

17

Before proceeding with the analysis of Gω(zo, ~r⊥o1, ~r⊥o2, ω) though, let us spend
some words on these remaining factors; the presence of a monochromator in-
troduces another bandwidth of interest. If we indicate the bandwidth of the
monochromator with ∆ωm and the central frequency of interest at which the
monochromator is tuned with ωo (typically, the undulator resonant frequency),
then T is peaked around ωo and goes rapidly to zero as we move out of the
∆ωm/2, ωo + ∆ωm/2). Now, if the characteristic bandwidth of the
range (ωo −
monochromator, ∆ωm, is large enough so that T does not vary appreciably on
ω′) is peaked at
the characteristic scale of Fω, i.e. ∆ωm
ω = ω′. In this case the process resembles more and more a stationary process,
although it will be still intrinsically non-stationary. Consider a signal observed
for a time much shorter than its duration, but much longer than its coherence
time, and such that the stationary model applies to it. Now imagine that we
extend the observation time to a duration which is still much shorter than
the signal duration, but long enough that we need to account for the intrin-
sical non-stationarity of the process due to ﬁnite signal duration. In this case
the stationary model does not apply anymore strictly. To describe this situa-
tion, we can deﬁne a property weaker than stationarity, but nonetheless very
interesting from a physical standpoint: quasi-stationarity. The time domain
correlation function (that is, the mutual coherence function) can be written
as

1/σT , then Fω(ω

≫

−

Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) =

N
(2π)2

∞

∞

dω

dω′Fω(ω

Z−∞

Z−∞

Gω(zo, ~r⊥o1, ~r⊥o2, ω) exp (

−

×

ω′)T (ω)T ∗(ω′)

−
iωt1) exp (iω′t2) . (16)

≫

1/σT , and with the help of new variables ∆ω = ω

When ∆ωm
can simplify Eq. (16) accounting for the fact that Fω(ω
around ∆ω = 0. In fact we can consider T (ω)T ∗(ω′)Gω(zo, ~r⊥o1, ~r⊥o2, ω)
T (ω)
|
to obtain

≃
2Gω(zo, ~r⊥o1, ~r⊥o2, ω), so that we can integrate separately in ∆ω and ω

ω′ and ω, we
ω′) is strongly peaked

−

−

|

N
(2π)2

∞

Z−∞

Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) =

d∆ω Fω(∆ω) exp (

i∆ωt2)

∞

×

Z−∞

dω

T (ω)

2Gω(zo, ~r⊥o1, ~r⊥o2, ω) exp [

iω(t1

t2)]

|

|

= Ft (t2) Gt (zo, ~r⊥o1, ~r⊥o2, t1

t2) . (17)

−

−

−

−

In other words, in the quasi-stationary case, Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) is split on
the product of two factors, a ”reduced mutual coherence function”, that is
Gt(zo, ~r⊥o1, ~r⊥o2, t1

t2), and an intensity proﬁle, that is F (t2).

−

18

1 (that is usually true), Gω(zo, ~r⊥o1, ~r⊥o2, ω) =
If we now assume ∆ωmNw/ωo ≪
Gω(zo, ~r⊥o1, ~r⊥o2, ωo) is a constant function of frequency within the monochro-
mator line. In this case, Gω contains all the information about spatial corre-
lations between diﬀerent point and is, in fact, the quantity of central interest
in our study, but it is independent on the frequency ω. As a result we have

Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) = Ngt(t1

t2)Ft (t2) Gω (zo, ~r⊥o1, ~r⊥o2, ωo) ,

(18)

−

−

which means that the mutual coherence function Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) is re-
ducible, in the sense that it can be factorized as a product of two factors,
t2)Ft(t2), characterizing the temporal coherence and the
the ﬁrst Ngt(t1
second Gω(zo, ~r⊥o1, ~r⊥o2, ωo) describing the spatial coherence of the system 2 .
This case is of practical importance. In fact for 1˚A radiation we typically have
102
∆ωm/ωo ≃
1. It should
be noted that, although Eq. (18) describes the case when ∆ωmNw/ωo ≪
1
and ∆ωm
1/σT , only the former assumption is important for the mutual
coherence function to be reducible. In fact, if the former is satisﬁed but the
latter is not, from Eq. (16) one would simply have:

103, i.e. ∆ωmNw/ωo ≪

10−5 and Nw ≃

10−4

≫

÷

÷

Γt(zo, ~r⊥o1, ~r⊥o2, t1, t2) = N

gt(t1, t2)Gω (zo, ~r⊥o1, ~r⊥o2, ωo) ,

(19)

that is still reducible.

e

Eq. (17) contains two important facts:

(a) The temporal correlation function, that is Gt(zo, ~r⊥o1, ~r⊥o2, t1
t2), and
the spectral density distribution of the source, that is H(zo, ~r⊥o1, ~r⊥o2, ω) =
N

2Gω(zo, ~r⊥o1, ~r⊥o2, ω), form a Fourier pair.

T (ω)

−

|

|

(b) The intensity distribution of the radiation pulse Ft(t2) and the spectral
correlation function Fω(∆ω) form a Fourier pair.

The statement (a) can be regarded as an analogue, for quasi-stationary sources,
of the well-known Wiener-Khinchin theorem, which applies to stationary sources
and states that the temporal correlation function and the spectral density are

2 It is interesting, for the sake of completeness, to discuss the relation between Gω
and the mutual intensity function as usually deﬁned in textbooks [5, 6] in quasi-
1/σT in the limit σT −→ ∞
monochromatic conditions. The assumption ∆ωm
0 slowly enough so that
describes a stationary process. Now letting ∆ωm −→
2 become approx-
∆ωm
T (ω)
1/σT , Eq. (17) remains valid while both Fω and
|
|
≫
imated better and better by Dirac δ-functions, δ(∆ω) and δ(ω
ωo), respectively.
−
t2)]. Aside for an unessential factor, depending on the
Then Γt ∼
−
2, this relation between Γt and Gω allows identiﬁca-
normalization of Fω and
T (ω)
|
|
tion of the mutual intensity function with Gω as in [5, 6].

Gω exp[

iωo(t1

≫

−

19

a Fourier pair. Since there is symmetry between time and frequency domains,
a ”anti” Wiener-Khinchin theorem must also hold, and can be obtained by the
usual Wiener-Khinchin theorem by exchanging frequencies and times. This is
simply constituted by the statement (b).

The assumption of quasi-stationarity is not vital for the following of this work,
since the cross-spectral density can be studied in any case as a function of fre-
quency. In this respect it should be noted that, although in the large majority
of the cases monochromator characteristics are not good enough to allow res-
olution of the non-stationary process, there are cases when it is not allowed
to treat the process as if it were quasi-stationary. For instance, in [8] a partic-
ular monochromator is described with a relative resolution of 10−8 at wave-
lengths of about 1˚A, or ωo ∼
1019 Hz. Let us consider, as in [8], the case
of radiation pulses of 32 ps duration. Under the already accepted assumption
ωo/Nw, we can identify the radiation pulse duration with σT . Then
1/σT ≪
1011 Hz: this means
1011 Hz which is of order of 2π/σT ∼
we have ∆ωm
that the monochromator has the capability of resolving the non-stationary
processes in the frequency domain. On the contrary, also in this case, the
mutual coherence function is reducible, in the sense speciﬁed before, because
∆ωm/ωo ≃
1. However, such
÷
accuracy level is not usual in Synchrotron Radiation experiments.

103, i.e. ∆ωmNw/ωo ≪

10−8 and Nw ≃

102

∼

2

2

2

·

·

·

1/σT alone allows separate treatment of
To sum up, condition ωo/Nw ≫
transverse coherence properties at a given frequency through the function
Gω(zo, ~r⊥o1, ~r⊥o2, ω). The condition for the monochromator bandwidth ∆ωm
≫
1/σT deﬁnes a quasi-stationary process. If the monochromator bandwidth is
such that ∆ωm > ωo/Nw, the ratio Nw/(ωoσT ) gives us a direct measure of the
accuracy of the stationary approximation which does not depend, in this case,
on the presence of the monochromator. When a monochromator is present,
with a bandwidth ∆ωm < ωo/Nw, it is the ratio 1/(∆ωmσT ) which gives such
a measure. The condition ∆ωm
ωo/Nw ensures, instead, that the mutual co-
≪
herence function of the signal is reducible, in the sense speciﬁed by Eq. (19). In
1/σT . In
the following we will need only the ﬁrst of these conditions, ωo/Nw ≫
fact, this is all we need in order to separate transverse and temporal coherence
eﬀects, as shown in Eq. (15).

Once transverse and temporal coherence eﬀects are separated one can focus on
the study of transverse coherence through the function Gω(zo, ~r⊥o1, ~r⊥o2, ω).

There exists an important class of sources, called quasi-homogeneous. As we
will see, quasi-homogeneity is the spatial analogue of quasi-stationarity.

In general, quasi-homogeneous sources are a particular class of Schell’s model
sources. Schell’s model sources are deﬁned by the condition that their cross-
spectral density at the source plane (that is for a particular value of zo) is of

20

Fig. 6. Illustrating the concept of quasi-homogeneous source. Spectral density varies
so slowly with the position that it is approximatively constant over distances of the
order of the correlation length ∆ across the source.

the form

Gω(~r⊥o1, ~r⊥o2, ω) =

E(~r⊥o1, ω)

|

D

2
|

E

1/2

×

E(~r⊥o2, ω)

|
g(~r⊥o2
D

−

1/2

2
|

~r⊥o1, ω) , (20)
E

−

where g(~r⊥o2
~r⊥o1, ω) is the spectral degree of coherence (that is normalized
to unity by deﬁnition, i.e. g(0, ω) = 1) 3 . Equivalently one may simply deﬁne
Schell’s model sources using the condition that the spectral degree of coherence
depends on the positions across the source only through the diﬀerence ~r⊥o2
~r⊥o1 (see [6], 5.2.2) from which Eq. (20) follows.

−

Quasi-homogeneous sources are Schell’s sources obeying the following extra-
assumption: the spectral density Gω(~r⊥o, ~r⊥o, ω) at the source plane, consid-
ered as a function of ~r⊥o, varies so slowly with the position that it is approxi-
matively constant over distances across the source, which are of the order of
, see
the correlation length ∆ (that is the eﬀective width of
Fig. 6 for a qualitative illustration in one dimension).

Gω(~r⊥o1, ~r⊥o2, ω)

|

|

Since for quasi-homogeneous sources the spectral density is assumed to vary
slowly we are allowed to make the approximation

Gω(~r⊥o1, ~r⊥o2, ω) = I (~r⊥o1, ω) g(~r⊥o2

~r⊥o1, ω) ,

(21)

3 Sometimes, loosely speaking, we will refer to g as to ”the cross-spectral density”,
or to ”the ﬁeld correlation function” the diﬀerence being just a normalization factor.

−

21

Fig. 7. Measurement of the cross-spectral density of a undulator source. (a) Young’s
double-pinhole interferometer demonstrating the coherence properties of undula-
tor radiation. The radiation beyond the pinholes must be spectrally ﬁltered by
a monochromator or detector (not shown in ﬁgure). (b) The fringe visibility of
the resultant interference pattern is equal to the absolute value of the normalized
.
~r⊥o1, ω)
cross-spectral density V =
|

g(~r⊥o2
|

−

where

I (~r⊥o1, ω) =

E (~r⊥o1, ω)
|

|

D

2

E

(22)

is the ﬁeld intensity distribution. A schematic illustration of the measurement
of the cross-spectral density of a undulator source is given in Fig. 7.

We reported deﬁnitions and diﬀerences between Schell’s sources and quasi-
homogeneous sources as treated in [6] in order to review some conventional
language. However, in our paper we will study and classify sources with the
help of parameters from dimensional analysis of the problem. In particular, in
the following we will introduce quantities that model, in dimensionless units,
the electron beam dimension and divergence in the x and y directions ( ˆNx,y
and ˆDx,y, respectively). When some of these parameters are much larger or
much smaller than unity, in certain particular combinations discussed in the
following part of this work, we will be able to point out simpliﬁcations of an-
alytical expressions. These simpliﬁcations do not depend, in general, on the
fact that the source is quasi-homogeneous or not, but simply on the fact that
some of the above parameters are large or small. It will be possible to de-
scribe some parameter combination in terms of Schell’s or quasi-homogeneous
model, but this will not be the case, in general. In order to link the physical
properties of certain kind of sources to a certain range of parameters we will

22

ﬁnd it convenient to extend the concept of quasi-homogeneity to the concept
of ”weak quasi-homogeneity”. It is better to familiarize with our new deﬁni-
tion already here: a given wavefront at ﬁxed position ˆzo will be said to be
weakly quasi-homogeneous, by deﬁnition, when the modulus of the spectral
depends on the position across the source only through
degree of coherence
|
the diﬀerence ~r⊥o2
~r⊥o1, ω). This is equivalent to
−
generalize Eq. (21) to

|
~r⊥o1, i.e.

= w(~r⊥o2

−

g

g

|

|

Gω(~r⊥o1, ~r⊥o2, ω)

= I (~r⊥o1, ω) w(~r⊥o2

~r⊥o1, ω) .

|

|

−

(23)

As a remark to both the deﬁnitions of quasi-homogeneity and weak quasi-
homogeneity, it should be noted that they only involve conditions on the cross-
spectral densities through Eq. (21) or Eq. (23): one can apply these deﬁnitions
to any wavefront at any position zo. This is consistent with what has been re-
marked in the Introduction: the choice of a source plane down the beamline
is just a convention. Therefore, our deﬁnition of weak quasi-homogeneity is
completely separated from the concept of source plane. It may seem, at ﬁrst
glance, that the deﬁnition of ”weak quasi-homogeneity” is somehow artiﬁ-
cial but it is, on the contrary, very convenient from a practical viewpoint.
In fact, in any coherent experiment, the specimen is illuminated by coherent
light from some kind of aperture, or diaphragm. Think, for instance, to the
usual process of selection of transversely coherent light through a spatial ﬁl-
ter, where a diaphragm is placed downstream a pinhole. Physically, when the
modulus of the spectral degree of coherence depends only on the coordinate
~r⊥o1 the coherence properties of the beam do not depend on
diﬀerence ~r⊥o2
the position of the diaphragm with respect to the transverse coordinate of
the center of the pinhole, which we may imagine on the z axis: for instance,
~r⊥o1 and not on the average
the coherence length will depend only on ~r⊥o2
position (~r⊥o2 + ~r⊥o1)/2. Mathematically, as has already been said, the deﬁni-
tion of weak quasi-homogeneity is linked with particular combination of small
and large parameters which will lead to simpliﬁcations of equations and to
analytical treatment of several interesting cases.

−

−

After having introduced the deﬁnition of ”weak quasi-homogeneity” we should
go back to the concept of usual quasi-homogeneity to describe a vary particu-
lar feature of it: quasi-homogeneity can be regarded as the spatial equivalent
of quasi-stationarity, as anticipated before. Exactly as the time domain has a
reciprocal description in terms of frequency, the space domain has a reciprocal
description in terms of transverse (two-dimensional) wave vectors. However,
since the frequency is ﬁxed, the ratio between the horizontal or vertical com-
ponent of the wave vector and the longitudinal wave number is representative
of the propagation angle of a plane wave at ﬁxed frequency. Therefore any
given signal on a two-dimensional plane can be represented in terms of su-
perposition of plane waves with the same frequency and diﬀerent angles of
propagation, which goes under the name of angular spectrum. This deﬁnes an

23

angular domain which is the reciprocal of the space domain. Intuitively the
angular spectrum representation constitutes a picture of the eﬀects of propa-
gation in the far zone whereas the near zone is described by the space domain.
In this Section, an analogous of the Wiener-Khinchin theorem and its recip-
rocal form for quasi-stationary processes has been discussed. Substitution of
times with position vectors and frequencies with angular vectors allows to de-
rive similar statements for the near (space domain) and far (angular domain)
zone [6]. If we use ~θ = ~r⊥o/zo (and ~θ1,2 = ~r⊥o1,2/zo) as variables to describe
radiant intensity and cross-spectral density in the far ﬁeld, and if we identify
points on the source plane with ~r⊥ (and ~r⊥1,2), we have:

(a’) The cross-spectral density of the ﬁeld at the source plane g(~r⊥2
~r⊥1)
and the angular distribution of the radiant intensity I(~θ) are a Fourier Pair.

−

~θ1) and the source-intensity
(b’) The cross-spectral density of the far ﬁeld g(~θ2
distribution I(~r⊥) are, apart for a simple geometrical phase factor, a Fourier
Pair.

−

The statement (b’) can be regarded as an analogue, for quasi-homogeneous
sources, of the far-zone form of the van Cittert-Zernike theorem. The statement
(a’) instead, is due to the symmetry between space and angle domains, and
can be seen as an ”anti” VCZ theorem. This discussion underlines the link
between the VCZ theorem and the Wiener-Khinchin theorem.

Many undulator radiation sources are quasi-homogeneous sources in the usual
way. In the case of a quasi-homogeneous source of typical linear dimension d,
the angular spectrum at distance zo ≫
dω∆/c is expected to exhibit speckles
with typical linear dimension zo(dω/c)−1, as illustrated in Fig. 8, which shows
an intuitive picture of the propagation of transverse coherence.

They generate ﬁelds which are relatively simple to analyze mathematically and
still rich in physical features. Although both VCZ and ”anti” VCZ theorem
are based on the assumption of usual quasi-homogeneity we will see that these
are often applicable, at least in some sense, also in the case of ”weakly quasi-
homogeneous” wavefronts.

3

Evolution of the cross-spectral density function through the

undulator beamline

In our work [3] we presented an expression for the reduced ﬁeld ˜E⊥(ω) =
iωzo/c) of a single particle with oﬀset ~l and deﬂection ~η with
¯E⊥(ω) exp (
respect to the optical axis z in an undulator. In order to derive our result,
we used a Green’s function approach to solve the paraxial Maxwell equations

−

24

Fig. 8. Geometry for propagation of transverse coherence in the case of a
quasi-homogeneous source.

for the Fourier transform of the electric ﬁeld and we took advantage of a
consistent use of the resonance approximation. The ﬁeld ˜E⊥ diﬀers from ¯E⊥
for a phase factor which depends on the variable zo and on the frequency ω
only: therefore, the use of one expression instead of the other in the equation
for G does not change the result. In [3], we presented results in normalized
units in the far ﬁeld zone for a particle with oﬀset and deﬂection. Based on
that work we can calculate the ﬁeld in normalized units for a particle with
oﬀset and deﬂection at any distance from the exit of the undulator, where the
center of the undulator is taken at z = 0, as speciﬁed in Fig. 9:

ˆEs⊥ = ˆzo

1/2

Z−1/2

dˆz′

1
ˆzo −

ˆz′ exp 



i 









ˆC +

ˆz′ + (cid:18)

2

~ˆη
2 


~ˆl
~ˆr⊥o −
−
2(ˆzo −

~ˆηˆz′

ˆz′)

2

(cid:19)

.(24)












Eq. (24) is valid for the system tuned at resonance with the fundamental har-
monic ωo. This means that we are considering a large number of undulator
periods Nw ≫
1 and that we are looking at frequencies near the fundamen-
tal and at angles within the main lobe of the directivity diagram. In this
situation one can neglect the vertical y-polarization of the ﬁeld with an accu-
racy (4πNw)−1. This constitutes a great simpliﬁcation of the problem since,
at any position of the observer, we may consider the electric ﬁeld Fourier
transform, ˆEs⊥, as a complex scalar quantity corresponding to the surviving
x-polarization component of the original vector quantity. Normalized units
were deﬁned as

25

y

x

(xo1,yo1,zo)

(xo2,yo2,zo)

-Lw/2

O

Lw/2

x

x

z

Fig. 9. Illustration of the undulator geometry and of the observation plane.

ˆEs⊥ =

−

c2zoγ ˜Es⊥
KωeLwAJJ
ωLw
c
ωo

~ˆη = ~η
s
ω

ˆC = LwC = 2πNw

,

,

,

,

,

−
ωo
ω
Lwc
ω
Lwc
z
Lw

~ˆr⊥o = ~r⊥o

s
~ˆl = ~l
s

ˆz =

. (25)

K being the deﬂection parameter, Lw being the undulator length,

K 2

AJJ = J0

4 + 2K 2 ! −

 

J1

K 2
4 + 2K 2 !

 

,

ωo =

4πcγ2
λw (1 + K 2/2)

(26)

(27)

being the resonant frequency, Jn the Bessel function of the ﬁrst kind of order
e) the electron charge and γ the relativistic
n, λw the undulator period, (
~ˆl is the normalized oﬀset in the center of the undulator. Finally,
Lorentz factor.
the parameter ˆC represents the normalized detuning, which accounts for small
deviation in frequency from resonance.

−

26

q
D
q
As it is shown in Appendix B, Eq. (24) can be rewritten as

ˆEs⊥ =

1/2

Z−1/2

ˆzodˆz′
ˆzo −

ˆz′ exp 


i 

ΦU + ˆC ˆz′ +






ˆzo ˆz′
2(ˆzo −

~ˆθ
ˆz′) 



~ˆl
ˆzo −

−

2

~ˆη













represents the observation angle and ΦU is given by

where

~ˆθ =

~ˆr⊥o
ˆzo

~ˆθ
ΦU = 

~ˆl
ˆzo

−

2






ˆzo
2

.




Eq. (28) is of the form

ˆC, ˆzo,

~ˆθ

~ˆl
ˆzo −

−

~ˆη



ˆEs⊥ 



= exp (iΦU )S 

.

(31)

~ˆθ
ˆC, ˆzo, 





~ˆl
ˆzo −

−

2

~ˆη








Starting from the next Section we will restrict our attention to the case ˆC = 0
for simplicity. Therefore, it may be interesting to note that in the particular
case ˆC = 0, the function S can be represented in terms of the exponential
integral function Ei as:

S

0, ˆzo, ζ 2
(cid:16)

(cid:17)

= exp(

iˆzoζ 2/2)ˆzo

−

Ei
"

 

−

o ζ 2

iˆz2
1 + 2ˆzo ! −

Ei

iˆz2
oζ 2
1 + 2ˆzo !#

 

(32)

It is easy to show that the expression for the function S(
function as ˆzo ≫
ﬁeld from a single particle, given in Eq. (24) is simpliﬁed to

)
) reduces to a sinc(
·
1 . In fact, in this limiting case, the expression for the electric

·

1/2

ˆEs⊥ = exp (iΦU )

dˆz′ exp 


Z−1/2

iˆz′

ˆC +


Eq. (33) can be integrated analytically giving

~ˆlx
ˆzo −

−

1
~ˆθ
2 



2

~ˆη



,











ˆEs⊥ = exp (iΦU ) sinc






ˆC
2

 

+

ζ 2
4 !

,

27

(28)

(29)

(30)

(33)

(34)

f( )

1,2

1,0

0,8

0,6

0,4

0,2

0,0

-0,2

0

2

4

6

8

10

12

14

Fig. 10. Comparison between f (ζ) = sinc(ζ 2/4) (solid line), the real (dashed line)
and the imaginary (dash-dotted line) parts of f (ζ) = S(0, ˆzo, ζ 2) at ˆzo = 1.

where

ζ =

~ˆθ

~ˆl
ˆzo −

−

~ˆη .

(35)

A comparison between sinc(ζ 2/4) and the real and imaginary parts of S(0, ˆzo, ζ 2)
for ˆzo = 1 is given in Fig. 10.

Let us now go back to the general case for ˆzo > 1/2 and use Eq. (28) to
calculate the cross-spectral density. The cross-spectral density Gω is given Eq.
(14) in dimensional units and as a function of dimensional variables. Since the
ﬁeld in Eq. (28) is given in normalized units and as a function of normalized
~ˆθx,y and ˆC, it is convenient to introduce a version of Gω deﬁned

variables ˆzo,
by means of the ﬁeld in normalized units:

ˆG(ˆzo,

~ˆθ1,

~ˆθ2, ˆC) =

*

ˆEs⊥ 



ˆC, ˆzo,

~ˆθ1

~ˆl
ˆzo −

−

ˆE∗

s⊥ 

ˆC, ˆzo,

~ˆθ2

~ˆl
ˆzo −

−

~ˆη






.

+~η,~l

~ˆη



(36)

Transformation of Gω in Eq. (14) to ˆG (and viceversa) can be easily performed
shifting from dimensional to normalized variables and multiplying Gω by an

28

inessential factor:

ˆG =

2

c2zoγ
KωeLwAJJ !

 

Gω .

(37)

As a result, we can always use ˆG in stance of Gω. Substituting Eq. (28) in Eq.
(36) we obtain:

ˆG(ˆzo,

~ˆθ1,

~ˆθ2, ˆC) =

S 

*




~ˆθ1

−

ˆC, ˆzo, 


exp 


×

2

~ˆη



−





~ˆl
ˆzo

~ˆl
ˆzo −

~ˆθ1


i 







~ˆθ2

S∗

ˆC, ˆzo, 








2

−

2

~ˆl
ˆzo −

2

~ˆη








~ˆθ2

−

~ˆl
ˆzo
















− 



ˆzo
2 


(38)

+~η,~l


Expanding the exponent in the exponential factor in the right hand side of
Eq. (38), it is easy to see that terms in ˆl2
x,y contribute
for a common factor, and only linear terms in ˆlx,y remain inside the ensemble
average sign. Substitution of the ensemble average with integration over the
beam distribution function leads to

x,y cancel out. Terms in ˆθ2



ˆzo
2 # Z
!
~ˆl
ˆzo −

ˆG(ˆzo,

~ˆθ1,

~ˆθ2, ˆC) = exp

2
~ˆθ
1 −
 

~ˆθ

2

2

i
"

d~ˆηd

~ˆl F~ˆη,
~ˆl

~ˆl
~ˆη,
(cid:18)
(cid:19)

2

exp

~ˆθ2
i(

(cid:20)

~ˆθ1)

2

~ˆl
(cid:21)

·

−

~ˆθ1

×

S 

ˆC, ˆzo, 
ˆC, ˆzo, 











~ˆl are to be intended as integrals over the entire plane
Here integrals d~ˆη and in d
~ˆl vectors. Eq. (39) is very general and can be used as a
spanned by the ~ˆη and
starting point for computer simulations.

~ˆη



~ˆη



S∗

−

−








~ˆθ2

~ˆl
ˆzo −

. (39)

We already assumed that the distribution in the horizontal and vertical planes
= Fˆηx,ˆlxFˆηy,ˆly. If the transverse phase space is
are not correlated, so that F~ˆη,
~ˆl
speciﬁed at position ˆzo = 0 corresponding to the minimal values of the β-
functions, we can write Fˆηx,ˆlx = FˆηxFˆlx and Fˆηy,ˆly = Fˆηy Fˆly with

Fˆηx(ˆηx) =

Fˆηy (ˆηy) =

1
2π ˆDx
1
2π ˆDy

exp

 −

exp

 −

ˆη2
x
2 ˆDx !
ˆη2
y
2 ˆDy !

,

,

q

q

29

Fˆlx(ˆlx) =

Fˆly (ˆly) =

1
2π ˆNx
1
2π ˆNy

q

q

exp

 −

exp



−



,

ˆl2
x
2 ˆNx !
ˆl2
y
2 ˆNy





. (40)

From Eq. (25) and Eq. (29) it is easy to see that

ˆDx,y = σ2

x′,y′

ˆNx,y = σ2
x,y

ωLw
c

ω
cLw

(41)

(42)

where σx,y and σx′,y′ are the rms transverse bunch dimension and angular
spread. Parameters ˆNx,y will be indicated as the beam diﬀraction parameters
and are, in fact, analogous to Fresnel numbers and correspond to the normal-
ized square of the electron beam sizes, whereas ˆDx,y represent the normalized
square of the electron beam divergences.

Substitution of relations (40) in Eq. (39) yields, at perfect resonance ( ˆC = 0):

ˆG(ˆzo,

~ˆθ1,

~ˆθ2) =

exp

i
"

4π2
∞

Z−∞

2

2

#

!

~ˆθ

ˆzo/2

2
~ˆθ
1 −
 
ˆDx ˆDy ˆNx ˆNy
ˆl2
x
2 ˆNx !
2

q
dˆlx exp

∞

Z−∞
∞

Z−∞

ˆη2
y
2 ˆDy !
 −
2

 −
~ˆl
ˆzo −

~ˆη








S∗

ˆzo, 


~ˆθ2

−







exp

~ˆθ2
i(

(cid:20)

~ˆη








∞

×

Z−∞

S 

ˆzo, 

~ˆθ1







dˆηy exp

~ˆl
ˆzo −

−

dˆηx exp

 −

dˆly exp

ˆη2
x
2 ˆDx !
ˆl2
y
2 ˆNy





~ˆl
(cid:21)

·



−


~ˆθ1)

−

. (43)

~ˆθ1,

~ˆθ2, ˆC) with the simpliﬁed dependence ˆG(ˆzo,

For notational simplicity, in Eq. (43) we have substituted the proper notation
~ˆθ1,
~ˆθ2) because we will be
ˆG(ˆzo,
~ˆl/ˆzo −
~ˆθ
~ˆη)2] is to be
treating the case ˆC = 0 only. Consistently, also S[ˆzo, (
~ˆl/ˆzo −
~ˆθ
~ˆη)2] calculated at
understood as a shortcut notation for S[ ˆC, ˆzo, (
ˆC = 0.

−

−

4 Undulator radiation as a quasi-homogeneous source

When describing physical principles it is always important to ﬁnd a model
which provides the possibility of an analytical description without loss of es-

30

sential information about the feature of the random process.

x′,y′βo

x,yǫx,y, where βo

x,y or, in normalized units, ˆǫx,y = ˆDx,y ˆβx,y, where ˆβx,y = βo

In order to get a feeling for some realistic magnitude of parameters we start
noting that the geometrical emittances of the electron beam are simply given
by ǫx,y = σx,yσx′,y′. Here they will be normalized as ˆǫx,y = 2πǫx,y/λ. Then
σ2
x,y = βo
x,y are the minimal values of the horizontal and verti-
cal betatron functions. In this paper we will assume that the betatron func-
tions will have their minimal value at the undulator center. Therefore we have
ǫx,y = σ2
x,y/Lw.
ˆDx,y ˆNx,y. It follows that ˆNx,y = ˆǫx,y ˆβx,y.
Equivalently we can write ˆǫx,y =
Now taking λ = 1 ˚A, ǫx = 1
q
10Lw one
obtains, in normalized units, ˆǫx = 102
10:
÷
therefore ˆDx ≫
1, ˆNx ≫
1. This is always the case in situations of practical
interest, with ˆNx which may range from values much smaller to much larger
than ˆDx.
1, independently on the values of ˆDy and ˆNy,
Assuming ˆDx ≫
introduces simpliﬁcations in the expression for the cross-correlation function
and allows further analytical investigations. As we will see, in particular, a
model of the electron beam based on these assumptions contains (but it is not
limited to) the class of quasi-homogeneous sources discussed in Section 2.2.

x = 10−1
3 and ˆβx = 10−1

3 nm, ǫy = 10−2ǫx and βo

1 and ˆNx ≫

102, ˆǫy = 1

÷

÷

÷

÷

3

·

In the next Sections 4.1 and 4.2 and later in Section 5, we will see what are the
conditions in terms of the dimensionless parameters ˆNx,y and ˆDx,y for some
undulator radiation wavefront at position ˆzo, to be quasi-homogeneous in the
usual and in the weak sense (according to the deﬁnition in Section 2.2), we
will justify the introduction of the concept of weak quasi-homogeneity itself
and we will discuss the applicability regions of the VCZ (and ”anti” VCZ)
theorem. Then, in Section 6, we will also discuss some case characterized by
non weakly quasi-homogenous ﬁelds.

4.1 A simple model

To provide a ﬁrst analysis of the problem we adopt some simplifying assump-
tions that are only occasionally met in practice.

As already assumed vertical emittance is much smaller than horizontal emit-
tance. For notational simplicity we will make the assumptions ˆNy ≪
1 and
1 and ˆly ≪
ˆDy ≪
1. This means that we theoretically assume ˆηy ≪
1. As a
result, the terms in ˆηy and ˆly can be neglected in the S(
) term on the right
·
hand side of Eq. (43). Although this model includes obvious schematization
it is still close to reality in many situations, and it is only to be considered
as a provisory model for physical understanding to be followed, below, by

31

more comprehensive generalizations. In this Section we will restrict our atten-
tion at the correlation function for ˆθy1 = ˆθy2 that is on any horizontal plane.
Here again, for notational simplicity, we will substitute the proper notation
ˆG(ˆzo, ˆθx1, 0, ˆθx2, 0) with ˆG(ˆzo, ˆθx1, ˆθx2). Eq. (43) can be greatly simpliﬁed lead-
ing to

ˆG(ˆzo, ˆθx1, ˆθx2) =

∞

×

Z−∞

dˆηx exp

ˆη2
x
2 ˆDx !

 −

Z−∞

2π

∞

q
dˆlx exp

exp

1
ˆDx ˆNx
ˆl2
x
2 ˆNx !

 −

i

ˆθ2
x1 −
(cid:16)

h

ˆθ2
x2

ˆzo/2

(cid:17)

exp

i(ˆθx2
h

−

ˆθx1)ˆlx

i

i

S

ˆzo,

×(

(cid:20)

(cid:16)

ˆθx1

ˆlx/ˆzo −

−

ˆηx

2

S∗

ˆzo,

(cid:21)

(cid:17)

(cid:20)

ˆθx2
(cid:16)

ˆlx/ˆzo −

−

ˆηx

2

(cid:21))

(cid:17)

. (44)

Let us now introduce

∆ˆθ =

ˆθx1

ˆθx2

−
2

¯θ =

ˆθx1 + ˆθx2
2

(45)

(46)

With this variables redeﬁnition we obtain

ˆG(ˆzo, ¯θ, ∆ˆθ) =

∞

×

Z−∞

dˆlx exp

ˆl2
x
2 ˆNx !

 −

2π

q
exp

−
h

1
ˆDx ˆNx

exp

i2¯θ∆ˆθˆzo
(cid:16)

Z−∞

(cid:17)

∞

dˆηx exp

ˆη2
x
2 ˆDx !

 −

2i∆ˆθˆlx

S

ˆzo,

¯θ + ∆ˆθ

ˆlx/ˆzo −

ˆηx

2

(cid:21)

(cid:17)

(cid:20)

(cid:16)

¯θ

ˆzo,

i (cid:26)
S∗

−
ˆlx/ˆzo −
−
×
ˆη + ¯θ followed by ˆlx/ˆzo −→

∆ˆθ

−

(cid:16)

(cid:20)

(cid:21)(cid:27)

(cid:17)

2

ˆηx

ˆφ

−

. (47)

ˆη yields

A double change of variables ˆηx −→

ˆG(ˆzo, ¯θ, ∆ˆθ) =

exp

(cid:16)

2π

q

i2¯θ∆ˆθˆzo
ˆD ˆN/ˆz2
o
∞

∞

(cid:17)

Z−∞

dˆη exp

(ˆη + ¯θ)2
2 ˆD

 −

+ 2i∆ˆθˆzo ˆη
!

×

Z−∞

d ˆφ exp

S∗

×

( ˆφ
ˆη)2
−
2 ˆN/ˆz2
∆ˆθ)2

−

o !

S
i

 −
ˆzo, ( ˆφ
h

exp

2i∆ˆθˆzo ˆφ
(cid:17)
. (48)

−
(cid:16)
ˆzo, ( ˆφ + ∆ˆθ)2
h

i

where we have posed ˆD = ˆDx and ˆN = ˆNx for notational simplicity. Eq. (48)
can be also written as

32

ˆG(ˆzo, ¯θ, ∆ˆθ) =

exp

(cid:16)

2π

q

exp

exp

(cid:17)

i2¯θ∆ˆθˆzo
ˆD ˆN/ˆz2
o
ˆφ
2i∆ˆθˆzo
−
(cid:17)
(cid:16)
ˆN /ˆz2
o + ˆD
2 ˆD ˆN /ˆz2
o

 −

¯θ2
2 ˆD !
ˆzo, ( ˆφ
h
ˆφ
ˆη2 +
ˆN/ˆz2
o

S∗

∞

d ˆφ

 −

exp
"

ˆφ2
2 ˆN /ˆz2
o !
ˆzo, ( ˆφ + ∆ˆθ)2
h

Z−∞
∆ˆθ)2
S
i
¯θ
ˆη + 2i∆ˆθˆzo ˆη
ˆD

−

ˆη

−

 −

×

∞

dˆη exp

×

Z−∞

i
. (49)

!


The integral in ˆη can be performed analytically thus leading to

exp

×
ˆφ2 + 2 ˆφ

"−
¯θ + 2i( ˆN /ˆzo)∆ˆθ
(cid:17)
o + ˆD)

(cid:16)
2( ˆN /ˆz2

∞

×

Z−∞

d ˆφ exp



−



exp

i2¯θ∆ˆθˆzo
(cid:16)
2π( ˆN/ˆz2

ˆG(ˆzo, ¯θ, ∆ˆθ) =

(cid:17)
o + ˆD)
¯θ2 + 4 ˆN∆ˆθ2 ˆD + 4i( ˆN/ˆzo)¯θ∆ˆθ
q
o + ˆD)
2( ˆN /ˆz2

#

ˆzo, ( ˆφ

∆ˆθ)2

−

h
ˆzo, ( ˆφ + ∆ˆθ)2

i
. (50)

S∗



S
×

h

i

±

±

1 can

∆ˆθ)2] with sinc[( ˆφ

It is important to remember again that an asymptotic formula for ˆzo ≫
be obtained from Eq. (50) simply substituting S[ˆzo, ( ˆφ
±
∆ˆθ)2/4]. Then, it is easy to understand that S is bound to go to zero for values
of ( ˆφ
∆ˆθ)2 larger than unity, exactly as the asymptotic terms in sinc(
) would
·
do. In fact, once ˆC is set to zero, S depends parametrically on the normalized
∆ˆθ)2], and gives the previously found
distance ˆzo alone, that is S = S[ˆzo, ( ˆφ
asymptotic expression of sinc[( ˆφ
1. Since here
ˆzo is supposed to be at least of order unity (ˆzo > 1/2), we can conclude that S
∆ˆθ)2 of order unity (to be
must be diﬀerent from zero only for values of ( ˆφ
more precise, for values ( ˆφ
∆ˆθ)2/4 being the arguments of
±
the sinc function) as it can be seen, for instance, from Fig. 10 for a particular
case. Thus Eq. (50) and its asymptotic equivalent for ˆzo ≫
1 share the same
mathematical structure.

∆ˆθ)2/4] in the limit for ˆzo ≫

4, ( ˆφ

∆ˆθ)2

≃

±

±

±

±

Let us now introduce the non-restrictive assumptions:

ˆN

1 ,

≫
and deﬁne

ˆD

1

≫

ˆA =

ˆN
ˆz2
o

.

(51)

(52)

The physical interpretation of ˆA follows from that of ˆσ/ˆzo: ˆA is the dimen-

33

≫

1 we have (2 ˆAˆz2
o

sionless square of the apparent angular size of the source at the observer point
position, calculated as if the source was positioned at ˆzo = 0. If ˆN
1 and
≫
ˆD
ˆD)/( ˆA + ˆD)
1 for any value of ˆzo and any choice of
o∆ˆθ2 ˆD/( ˆA + ˆD)]
2 ˆAˆz2
ˆN and ˆD. As a result, from the exponential factor exp [
outside the integral sign in Eq. (50) we have that Gω(ˆzo, ¯θ, ∆ˆθ) is diﬀerent
from zero only for ∆ˆθ
1. Then we can neglect terms in ∆ˆθ in the factors
S(

) within the integral sign thus getting

≫

≪

−

·

ˆG(ˆzo, ¯θ, ∆ˆθ) =

exp

i2¯θˆzo∆ˆθ
(cid:16)
(cid:17)
2π( ˆA + ˆD)

exp

"−

¯θ2 + 4 ˆAˆz2

o∆ˆθ2 ˆD + 4i ˆA¯θˆzo∆ˆθ
2( ˆA + ˆD)

#

∞

q
d ˆφ exp

ˆφ2 + 2 ˆφ¯θ
2( ˆA + ˆD) #

"−

exp

i
"−

2 ˆφ ˆAˆzo∆ˆθ
ˆA + ˆD #

×

Z−∞

2

. (53)

S

ˆzo, ˆφ2
h

(cid:12)
(cid:12)
(cid:12)

i(cid:12)
(cid:12)
(cid:12)

The maximal value of ¯θ is related with the width of the exponential function
¯θ2 /(2 ˆA +2 ˆD)] outside the integral sign in Eq. (53). It follows that in the
exp [
−
limit for ˆD
within the integral sign: in fact, its argument assumes values of order unity for
ˆφ
2 cuts oﬀ the integrand for ˆφ & 1. Therefore
Eq. (53) can be simpliﬁed as follows:

1 we can neglect the exponential factor exp [

1, but the factor

S[ˆzo, ˆφ2]

≫

≫

−

|

|

( ˆφ2 + 2 ˆφ¯θ)/(2 ˆA + 2 ˆD)]

ˆG(ˆzo, ¯θ, ∆ˆθ) =

exp

i2¯θˆzo∆ˆθ
(cid:16)
(cid:17)
2π( ˆA + ˆD)
∞

exp

"−

¯θ2
2( ˆA + ˆD) #

exp

"−

2i ˆA¯θˆzo∆ˆθ
ˆA + ˆD #

exp

×

"−

2 ˆA ˆDˆz2

q
o ∆ˆθ2
ˆA + ˆD #

d ˆφ exp

2 ˆA
ˆA + ˆD

i
"

 −

ˆzo∆ˆθ
!

ˆφ
#

Z−∞

S

ˆzo, ˆφ2

2

. (54)

h

(cid:12)
(cid:12)
(cid:12)

i(cid:12)
(cid:12)
(cid:12)

|

|

S[ˆzo, ˆφ2]

2 with respect to the variable

The integral in Eq. (54) is simply the Fourier transform of the function
f ( ˆφ) =
2 ˆAˆzo∆ˆθ/( ˆA + ˆD). Since
the function f ( ˆφ) has values sensibly diﬀerent from zero only as ˆφ is of order
unity or smaller, its Fourier Transform will also be suppressed for values of
/( ˆA + ˆD) larger than unity, by virtue of the Bandwidth Theorem.
2 ˆAˆzo|
This means that the integral in Eq. (54) gives non-negligible contributions
:
only up to some maximal value of

∆ˆθ
|

−

∆ˆθ
|

|

∆ˆθ
|

|

max

∼

1
2ˆzo  

1 +

ˆD
ˆA !

.

On the other hand, the exponential factor outside the integral in Eq. (54) will
cut oﬀ the function ˆG around some other value

(55)

(56)

∆ˆθ
|

|

max2

∼

1
2ˆzo (cid:18)

1
ˆD

+

1
ˆA (cid:19)

1/2

.

34

It is easy to see that, for any value of ˆzo,

max2. In fact we have

∆ˆθ
|

|

max

∆ˆθ
|

≫ |

∆ˆθ
max
|
|
∆ˆθ
max2 ∼ q
|

|

q

ˆD

1 + ( ˆD/ ˆA) >

ˆD

1 ,

q

≫

in the limit for ˆD
signiﬁcant only for values of the variable
contributes to ˆG only by the inessential factor

1. As a result the Fourier transform in Eq. (54) is
2 ˆAˆzo∆ˆθ/( ˆA + ˆD) near to zero and

≫

−

(57)

(58)

∞

Z−∞

d ˆφ

S

ˆzo, φ2

= constant .

2

i(cid:12)
(cid:12)
(cid:12)

h

(cid:12)
(cid:12)
(cid:12)

In order to use the correlation function ˆG for calculation of coherence length
and other statistical properties, one has to use the spectral degree of coherence
g, which can be presented as a function of ¯θ and ∆ˆθ instead of x⊥o2 and x⊥o1:

g

¯θ, ∆ˆθ
(cid:17)

(cid:16)

=

ˆG

2

¯θ, ∆ˆθ
(cid:16)
(cid:17)
1/2
E

(cid:29)

(cid:17)(cid:12)
(cid:12)
(cid:12)

(cid:28)(cid:12)
(cid:12)
(cid:12)

∆ˆθ

¯θ
(cid:16)

−

(cid:29)

(cid:17)(cid:12)
(cid:12)
(cid:12)

ˆEs⊥

¯θ + ∆ˆθ

(cid:28)(cid:12)
(cid:12)
(cid:12)

(cid:16)

From Eq. (54) we obtain :

1/2 .

2

(59)

g(ˆzo, ¯θ, ∆ˆθ) = exp

i2¯θˆzo∆ˆθ
(cid:16)
(cid:17)
In the asymptotic limit for a large value of ˆzo, ˆA
to

exp

"−

≪

2i ˆA¯θˆzo∆ˆθ
ˆA + ˆD #

exp

"−

2 ˆA ˆDˆz2

o∆ˆθ2
ˆA + ˆD #

. (60)

1, Eq. (60) can be simpliﬁed

g(ˆzo, ¯θ, ∆ˆθ) = exp

i2¯θˆzo∆ˆθ
(cid:17)
(cid:16)

exp

"−

2i ˆA¯θˆzo∆ˆθ
ˆD

#

exp

2 ˆAˆz2

o∆ˆθ2

.

(61)

−

h

i

From Eq. (54) it is easy to see that the region of interest where the ﬁeld
intensity is not negligible is when ¯θ .
ˆD. Therefore, Eq. (61) can be further
approximated to

q

i2¯θˆzo∆ˆθ
(cid:17)
(cid:16)

g(ˆzo, ¯θ, ∆ˆθ) = exp

exp

2 ˆAˆz2

o∆ˆθ2

.

−
h
It is interesting to calculate the transverse coherence length ˆξc as a function of
the observation distance ˆzo. For any experiment, complete information on the
coherence properties of light are given by the function g. When calculating the

i

(62)

35

coherence length one applies a certain algorithm to g thus extracting a single
number. This number does not include all information about the coherence
properties of light, and the algorithm applied to g is simply a convenient
deﬁnition. Then, in order to calculate a coherence length one has, ﬁrst, to
choose a deﬁnition among all the possible convenient ones. In this paper we
will simply follow the approach by Mandel, originally developed for the time
domain, but trivially extensible to any domain of interest, in our case the
angular domain. The coherence length, naturally normalized to the diﬀraction
length

Lwc/ω is deﬁned as

q

ˆξc(ˆzo) = 2

g(∆ˆθ)

2d(ˆzo∆ˆθ) ,

|

∞

|

Z−∞

where the factor 2 in front of the integral on the right hand side is due to the
fact that we chose Mandel’s approach and that our deﬁnition of ∆ˆθ diﬀers of
a factor 1/2 from his deﬁnition. Performing the integration in Eq. (63) with
the help of Eq. (60) yields:

(63)

(64)

ˆξc(ˆzo) = √π

1
ˆA

(cid:18)

+

1
ˆD (cid:19)

1/2

.

4.2 Discussion

q

1/

ˆD, because ˆN

π/ ˆN ˆzo while for ˆzo −→

The coherence length in Eq. (64) exhibits linear dependence on ˆzo, that is
ˆξc −→ q
1/2 that is at the end of the undulator, it
converges to a constant ˆξc −→
[π/(4 ˆN)+π/ ˆD]1/2. Eq. (64) and its asymptotes
are presented in Fig. 11 and Fig. 12 for the case ˆN = 103, ˆD = 10. It is evident
that at the exit of the undulator, ˆξc ∼
ˆD. On the other
ˆN
hand, horizontal dimension of the light spot is simply proportional to
as it is evident from Eq. (60). This means that the horizontal dimension of
the light spot is determined by the electron beam size, as is intuitive, while
the beam angular distribution is printed in the ﬁne structures of the intensity
function, that are of the dimension of the coherence length. In the limit for
ˆzo ≫
1 the situation is reversed. The radiation ﬁeld at the source can be
presented as a superposition of plane waves, all at the same frequency ωo, but
with diﬀerent propagation angles with respect to the z-direction. Since the
radiation at the exit of the undulator is partially coherent, a spiky angular
spectrum is to be expected. The nature of the spikes is easily described in
terms of Fourier transform theory, in perfect analogy with what has been said
about the frequency spectrum in Section 2.1. From Fourier transform theorem

≫

q

36

(

z

)

c

o

3,0

2,5

2,0

1,5

 

1,0

0,5

0,0

0

10

20

30

40

50

 

z

o

1/2 and ˆzo ≫

Fig. 11. Coherence length ˆξc as a function of ˆzo and asymptotic behaviors for
ˆzo −→
or, directly, from Eq. (54) or from geometrical optics arguments we can expect
an angular spectrum envelope with Gaussian distribution and rms width of

1. Here ˆN = 103 and ˆD = 10.

ˆD.

q
Also, the angular spectrum should contain spikes with characteristic width
ˆN, as a consequence of the reciprocal width relations of Fourier transform
1/
pairs (see Fig. 13). This can be seen realized in mathematical form from the
expression for the cross-spectral density, Eq. (60) and from the equation for
the coherence length, Eq. (64). Since ˆN
1, the horizontal width of the
coherence spot is much smaller than the vertical one.

≫

q

It is also important to remark that the asymptotic behavior for ˆA
Eq. (62) and ˆξc

≪

1 of g in

ˆξc −→ s

π
ˆN

ˆzo

(65)

are direct application of van Cittert-Zernike theorem. In fact, the last expo-

37

(

z

)

c

o

1,1

0,8

 

1,0

0,9

0,7

0,6

0,5

0

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

 

z

o

Fig. 12. Enlarged view of the initial part of Fig. 11.

≫

≫

ˆD

1 and ˆD

nential factor on the right hand side of Eq. (61) is simply linked with the
Fourier transform of Fˆlx(ˆlx). We derived Eq. (61) for ˆN
1, with
ˆN : in non-normalized units these conditions mean that the VCZ the-
ˆz2
o
orem is applicable when the electron beam divergence is much larger than the
diﬀraction angle, i.e. σ2
λ/(2πLw), the electron beam dimensions are much
x′
σ2
λLw/2π, and (σx′zo)2
larger than the diﬀraction size, i.e. σ2
x. On the
x ≫
contrary, authors of [4] state that, in order for the van Cittert-Zernike theorem
to be applicable, ”the electron-beam divergence must be much smaller than
the photon divergence”, that is our diﬀraction angle, i.e. σx′
λ/(2πLw)
(reference [4], page 571, Eq. (57)). Our derivation shows that this conclusion
is incorrect.

≫

≫

≪

≫

q

In [5] (paragraph 5.6.4) a rule of thumb is given for the applicability region
of the generalization of the VCZ theorem to quasi-homogeneous sources. The
rule of thumb requires zo > 2d∆/λ where d is ”the maximum linear dimen-
sion of the source”, that is the diameter of a source with uniform intensity
and ∆ ”represents the maximum linear dimension of a coherence area of the
2σx, since σx is the rms source dimension, and from
source”. In our case d
λ/(2√πσx′). The rule of thumb then requires
Eq. (64) we have ∆ = ξc ≃

≃

38

Fig. 13. Physical interpretation of the generalized van Cittert-Zernike theorem. If
the radiation beyond the source plane is partially coherent, a spiky angular spectrum
is expected. The nature of the spikes in the angular spectrum is easily described
in Fourier transform notations. We can expect that typical width of the angular
spectrum should be of order (ω∆/c)−1, where ∆ is the typical linear dimension
of spatially random intensity ﬂuctuations. Also an angular spectrum of the source
having transverse size d should contain spikes with typical width of about (ωd/c)−1,
a consequence of the reciprocal width relations of Fourier transform pairs.

q

q
≫

ˆN/ ˆD. This is paramet-
zo > 2σx/(√πσx′): in dimensionless this reads ˆzo &
ˆN , even though these
ˆD
rically in agreement with our limiting condition ˆz2
o
two conditions are obviously diﬀerent when it come to actual estimations:
our condition is, in fact, only an asymptotic one. To see how well condition
ˆN/ ˆD works in reality we might consider the plot in Fig. 11. There
ˆzo &
ˆN = 103 and ˆD = 10 so that, following [5] we may conclude that a good con-
dition for the applicability of the VCZ theorem should be ˆzo & 10. However
as it is seen from the ﬁgure, the linear asymptotic behavior is not yet a good
approximation at ˆzo ≃
10. This may be ascribed to the fact that the deriva-
tion in [5] is not generally valid, but has been carried out for sources which
drop to zero very rapidly outside the maximum linear dimension d and whose
correlation function also drops rapidly to zero very rapidly outside maximum
linear dimension ∆.

ˆD

However, at least parametrically, the applicability of the VCZ theorem in
ˆN can be also expected from the condition
the asymptotic limit ˆz2
o
zo > 2d∆/λ in [5]. In other words, with the help of our approach we were
able to specify an asymptotic region where the VCZ theorem holds. Such
a region overlaps with predictions from Statistical Optics. Statistical Optics
can describe propagation of the cross-spectral density only once it is known

≫

39

at some source plane position. Our treatment allows us to specify the cross-
spectral density at the exit of the undulator, but it should be noted that we
do not need to use customary results of Statistical Optics and propagate the
cross-spectral density from the exit of the undulator in order to obtain the
cross-spectral density at some distance along the beamline. In fact our ap-
proach, which consists in taking advantage of the system Green’s function in
paraxial approximation and, subsequently, of the resonance approximation,
allows us to calculate the cross-spectral density directly at any distance from
the exit of the undulator.

Let us now consider the structure of Eq. (60) and discuss the meaning of the
phase terms in ¯θ∆ˆθ. These are important in relation with the condition for
quasi-homogeneous source: their presence couples the two variables ¯θ and ∆ˆθ
4 ,
and prevents the source to be quasi-homogeneous at any given value of ˆzo
unless they compensate each other in some parameter region.

≫

≫

≫

ˆD

Let us discuss the limit, ˆA
1. We may consider two subcases. First, consider
ˆA
1. In this case, inspection of Eq. (60) shows that the two phase
terms compensate and the source is quasi-homogeneous, because the cross-
spectral density is factorized in a function of ¯θ and a function of ∆ˆθ. It should
be noted that if condition ˆA
1 is not satisﬁed at the exit of the undulator,
where ˆzo ∼
1 we have a quasi-
≫
homogeneous source at the exit of the undulator.

≫
1, then it is never satisﬁed. If ˆN

ˆD

≫

ˆN

≫

≫

Second, consider ˆD
1. This correspond to a situation with a low
value of the normalized betatron function in the horizontal direction. Figure
14 shows a numerical example with ˆǫx = 100 and ˆβx = 0.3 that is ˆN = 30 and
ˆD = 300: the value for the horizontal betatron function is similar to the low-β
case reported at page 12, Table 2.2.2 in [1], where βx = 1.3 m for a 5m-long
insertion device. The value ˆǫx = 100 corresponds to a wavelength of about 0.6˚A
for the PETRA III case. When ˆD
ˆN
1 no compensation of the phase
terms in Eq. (60) is possible, not even at the exit of the undulator. In this case,
whatever the value of ˆzo we can never have a quasi-homogeneous wavefront.
This constitutes no problem. Simply, the wavefront is not-quasi-homogeneous
in this case. However, we may interpret the situation by saying that a ”virtual”
quasi-homogeneous source placed in the center of the undulator would result in
the non-homogeneous source described by Eq. (60) at the exit of the undulator.
Although it physically makes no sense to discuss about Eq. (60) inside the
undulator, the ”virtual” source analogy is suggested by the fact that setting
ˆzo = 0 in Eq. (60), both phase terms become zero.

≫

≫

4 Note, again, that the deﬁnition of ”source plane” is just conventional. One may
deﬁne the source plane at the exit of the undulator, that is at ˆzo = 1/2, but there
is no fundamental reason for such a deﬁnition: one may pick any value of ˆzo as the
source position.

40

(

z

)

c

o

1,50

0,75

 

1,25

1,00

0,50

0,25

0,00

0

1

2

3

4

5

z

o

Fig. 14. Coherence length ˆξc as a function of ˆzo in the case ˆD
1. In
particular, here, ˆN = 30 and ˆD = 300. The linear dependence on ˆzo starts already
from the exit of the undulator, because ˆD

ˆN .

ˆN

≫

≫

≫

≫

≪

≫
≪

o + y2

1 and ˆD
Note that in general, whatever the values of ˆN
1, one never has
quasi-homogeneous sources in the limit for ˆA
1. In fact, in the asymptotic
1 only the phase factor exp(i2¯θ∆ˆθˆzo) contributes, which couples ¯θ and
ˆA
∆ˆθ. Such a factor is connected with phase of the ﬁeld from a single electron in
an undulator in the far zone, ω(x2
o)/(2czo), which represents, in paraxial
approximation, the phase diﬀerence between the point (xo, yo, zo) and the point
(0, 0, zo): in the asymptotic for large values of ˆzo, the electric ﬁeld generated
by a single electron with oﬀset and deﬂection in an undulator has a spherical
wavefront (see [3]). When one calculates the ﬁeld correlation function at two
diﬀerent points, he ends up with a contribution equal to the diﬀerence (due
to complex conjugation) between ω(x2
o1)/(2czo),
that for the vertical (and separately, the horizontal) direction gives exactly the
shift 2¯θ∆ˆθˆzo in normalized units. It should be noted that such a reasoning is
not limited to Synchrotron Radiation sources, but it is quite general since, as
already discussed, it relies on the fact that the wavefront of a single radiator
(in our case, an electron) produces a spherical wavefront in the far ﬁeld. This
is, for instance, the case of thermal sources as well. In other words, if the far

o2)/(2czo) and ω(x2

o2 + y2

o1 + y2

41

ﬁeld radiation of a quasi-homogeneous source is taken as a new source, that
new source will never be quasi-homogeneous.

|

g

ˆN

≫

≫

≫

≫

1 and ˆD

A common property of all situations with ˆN
1 is that, for
, is always independent on ¯θ. More-
any value of ˆzo, the modulus of g, i.e.
|
over, it is always possible to apply the VCZ theorem starting either from
a virtual quasi-homogeneous source placed at center of the undulator when
ˆD
1, or otherwise from a real one placed at the exit of the undulator
(or at any other position ˆzo close enough to the exit of the undulator to guar-
antee a quasi-homogeneous wavefront). These observations suggest to extend
the concept of quasi-homogeneity, and introduce the new concept of ”weak
quasi-homogeneity” as discussed before. With respect to the new coordinates
¯θ and ∆ˆθ, a given wavefront at ﬁxed position ˆzo is said to be weakly quasi-
is independent of ¯θ. With this new deﬁnition at hand
homogeneous when
we can restate some of our conclusions in a slightly diﬀerent language. We have
seen that in the far ﬁeld, when the VCZ theorem holds, the wavefronts are
weakly quasi-homogeneous, but never quasi-homogeneous in the usual sense.
In the case ˆN
1 we pass from quasi-homogeneous wavefronts (in
the usual sense) in the near ﬁeld to weakly-quasi homogeneous wavefronts
(but not quasi-homogenous in the usual sense) in the far ﬁeld. Note that the
wavefronts are always weakly quasi-homogeneous, even during the transition
from near to far zone. In the case ˆD
1 instead, the VCZ theorem is
≫
applicable already from the exit of the undulator, as it can be seen from Fig.
14, and the wavefront is not quasi-homogeneous in the usual sense, but still
weakly quasi-homogeneous from the very beginning.

ˆD

≫

≫

≫

ˆN

g

|

|

|

|

g

≫

≫

1 and ˆD

The weak quasi-homogeneity of the wavefronts at any value of ˆzo, i.e. the fact
is independent of ¯θ for any value of ˆzo guarantees that the plot in
that
Fig. 14 is universal. It should be noted that this fact depends on the choice
of large parameters ˆN
1, but it is also strictly related with the
Gaussian nature of the electron distribution in angles and oﬀsets, that is a
well-established fact for storage-ring beams. If angles or oﬀsets were obeying
diﬀerent distribution laws, in general, one could not perform the integral in ˆη in
would have shown a dependence on ¯θ: our notice-
Eq. (48) and, in general,
able result is linked with the properties of the exponential elementary function.
However, it should be clear that even in the case when angles or oﬀsets were
obeying diﬀerent distribution laws, i.e when the plot in Fig. 14 is not univer-
sal, we could have situations when wavefronts are quasi-homogeneous in the
usual sense near the exit of the undulator and are weakly quasi-homogeneous
in the far ﬁeld limit, but not along the transition between these two zones. A
more detailed discussion of this issue will be given in Section 5, where we will
be discussing conditions for the source to be quasi-homogeneous.

g

|

|

Another remark to be made pertains the applicability of the VCZ theorem. As
we deal with a quasi-homogenous source (in the usual sense) the knowledge of

42

I(¯θ) and g(∆ˆθ) in the far zone allow, respectively, the calculation at the source
plane of g(∆ˆx) through the ”anti” VCZ theorem and of I(¯x) through the VCZ
theorem (here we consider only one dimension, the horizontal one x). Viceversa
the knowledge of I and g at the source allow calculation of I and g in the
far ﬁeld. In terms of intensity, all information regarding wavefront evolution
(assuming a quasi-homogeneous source, in the usual sense) is included in I(¯θ)
and I(¯x). For instance, the knowledge of I(¯θ) allows calculation of g(∆ˆx)
at the source plane through the ”anti” VCZ theorem. Then, the knowledge
of g(∆ˆx) and I(¯x) allow the calculation of the cross-spectral density, which
can be propagated at any distance, and allow to recover g(∆ˆθ). So, complete
characterization of the undulator source is given when I(¯θ) and I(¯x), when
the source is assumed quasi-homogenous.

≫

≫

≫

1 and ˆD

1, the VCZ theorem holds also in the case ˆD

Yet we have seen that, when the electron distribution in angles and oﬀsets are
Gaussian and ˆN
≫
ˆN
1, when the source is non quasi-homogeneous in the usual sense. We have
seen that the situation can be equivalently described with the help of a virtual
quasi-homogeneous source in the middle of the undulator. However, such an
interpretation is only valid a posteriori. For the case ˆN
1 there is
a non quasi-homogeneous wavefront at the undulator exit; before our approach
was presented one would have concluded that the VCZ theorem cannot be
applied, since the spectral degree of coherence does not form a Fourier pair
with the intensity distribution at the undulator exit. Our approach is based
on the simpliﬁcation of mathematical results through the use of small and
large parameters and subsequent understanding and interpretation of these
simpliﬁed results: in our analysis we were never limited to the treatment of
quasi-homogenous cases alone.

1 and ˆD

≫

≫

1 and ˆD

cLw/ω and angle

As a closing remark about the coherence length we like to draw the reader’s
attention on the fact that the dimensional form ξc of the coherence length,
given in normalized units by ˆξc in Eq. (64), does not include the undulator
length. This is to be expected since, in the limit ˆN
1, the
typical size and divergence of the electron beam are much larger than the
c/(ωLw), which are intrinsic properties
diﬀraction size
of the undulator radiation. As a result, in this limit, the evolution of the
radiation beam is a function of the electron beam parameters only, and does
not depend on the undulator length. In the following Section 5, where we
will extend our model to a two-dimensional case, we will see that the quasi-
homogeneous approximation is valid in many practical situations, but we will
have to account for diﬀraction of undulator radiation in the vertical direction.
In this case the dimensional coherence ξc length will be a function of the
undulator length Lw as well.

≫

≫

q

q

43

5

Eﬀect of the vertical emittance on the cross-spectral density

Up to now we were dealing with the ﬁeld correlation function g within the
framework of a one-dimensional model.
In fact we considered the limit for ˆǫy ˆβy ≪
1 and we calculated
g for ˆθy1 = ˆθy2 = 0 and ˆC = 0, so that our attention was focused on coherent
eﬀects in the horizontal direction. We will now extend our considerations to a
two-dimensional model always for ˆC = 0. This can be done by a straightfor-
ward generalization of Eq. (50) which can be obtained from Eq. (43) following
the same steps which lead to Eq. (50), but this time without assumptions on
ˆNy, ˆDy, ˆθy1 and ˆθy2. Finally, at the end of calculations, our ﬁnal expression
for ˆG should be normalized to

1 and ˆǫy/ ˆβy ≪

ˆW =

ˆEs⊥

~ˆθ1
(cid:18)

1/2

2

+

ˆEs⊥

~ˆθ2
(cid:18)

1/2

2

+

.

*(cid:12)
(cid:12)
(cid:12)
(cid:12)

*(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)
As has already been seen in Section 4, after normalization to ˆW we will obtain
the spectral degree of coherence g. With this in mind we will neglect, step after
step, unnecessary multiplicative factors that, in any case, would be ﬁnally
disposed after normalization of the ﬁnal result. Retaining indexes x and y in
our notation we obtain

(66)

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

"−

exp



−

×

×

∞

∞

d ˆφx

×

Z−∞

Z−∞


d ˆφy exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
o∆ˆθ2
¯θ2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
x
2( ˆAx + ˆDx)
o∆ˆθ2
2( ˆAy + ˆDy)

ˆDy + 4i ˆAy ¯θy ˆzo∆ˆθy

¯θ2
y + 4 ˆAy ˆz2



#

y

x + 2 ˆφx
ˆφ2

¯θx + 2i ˆAx ˆzo∆ˆθx
(cid:16)
2( ˆAx + ˆDx)

y + 2 ˆφy
ˆφ2

¯θy + 2i ˆAy ˆzo∆ˆθy



(cid:17)







−



exp

h

(cid:17)



×

S∗

(cid:16)
2( ˆAy + ˆDy)

×
∆ˆθy)2

∆ˆθx)2 + ( ˆφy −


−
ˆzo, ( ˆφx + ∆ˆθx)2 + ( ˆφy + ∆ˆθy)2
ˆzo, ( ˆφx −

h
We will still assume ˆNx ≫
1. This allows to factorize the right
hand side of Eq. (67) in the product of contribution depending on horizontal
(¯θx, ∆ˆθx) coordinates only with a second depending on vertical (¯θy, ∆ˆθy) co-
ordinates only. In fact, from the exponential factor outside the integral sign
in Eq. (67) it is possible to see that the maximum value of ∆ˆθ2
x is of order
1. As a result, ∆ˆθx can be neglected inside the S func-
( ˆAx + ˆDx)/( ˆAx ˆDx ˆz2
o)

1 and ˆDx ≫

S
i

i


. (67)

≪

44

tions in Eq. (67). Moreover, since ˆDx ≫
factor in ˆφ2

x + 2 ˆφx

¯θx inside the integral sign. This leads to

1 one can also neglect the exponential

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
(cid:17)i

x

i2
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
h
(cid:16)
2( ˆAx + ˆDx)
o∆ˆθ2
2( ˆAy + ˆDy)

¯θ2
y + 4 ˆAy ˆz2

y

ˆDy + 4i ˆAy ¯θy ˆzo∆ˆθy

y + 2 ˆφy
ˆφ2

¯θy + 2i ˆAy ˆzo∆ˆθy
(cid:16)
2( ˆAy + ˆDy)

(cid:17)



#





exp

×

"−

exp



−

∞


d ˆφy exp



−

∆ˆθy)2

∞

×

Z−∞

d ˆφx exp

i ˆφx
"

2 ˆAx ˆzo∆ˆθx
ˆAx + ˆDx #
S∗

Z−∞
ˆzo, ˆφ2
h

x + ( ˆφy −
Based on the same reasoning in Section 4.1, that we repeat here for complete-
ness, we can also neglect the phase factor in ˆφx under the integral in d ˆφx in
Eq. (68). Such integral in d ˆφx is simply the Fourier transform of the function

x + ( ˆφy + ∆ˆθy)2

ˆzo, ˆφ2
h

S
i

×

i


. (68)

∞

y + 2 ˆφy
ˆφ2

¯θy + 2i ˆAy ˆzo∆ˆθy

f ( ˆφx) =

d ˆφy exp

Z−∞
ˆzo, ˆφ2
h

S∗

×

x + ( ˆφy −



−

∆ˆθy)2

S

ˆzo, ˆφ2
h

(cid:16)
2( ˆAy + ˆDy)

(cid:17)



x + ( ˆφy + ∆ˆθy)2


. (69)

−

i
i
2 ˆAx ˆzo∆ˆθx/( ˆAx + ˆDx). In the argument of the S
with respect to the variable
functions on the right hand side of Eq. (69), ˆφ2
x is always summed to positively
deﬁned quantities. This remark allows one to conclude that f ( ˆφx) has values
sensibly diﬀerent from zero only as ˆφx is of order unity or smaller. Therefore, its
Fourier Transform will also be suppressed for values of 2 ˆAx ˆzo|
/( ˆAx + ˆDx)
larger than unity, by virtue of the Bandwidth Theorem. This means that the
integral in d ˆφx in Eq. (68) gives non-negligible contributions only up to some
maximal value of

∆ˆθx|

:

∆ˆθx|

|

∆ˆθ

|

|xmax

∼

1
2ˆzo  

1 +

ˆDx
ˆAx !

.

On the other hand, the exponential factor outside the integral in Eq. (68) will
cut oﬀ the function ˆG around some other value

(70)

(71)

∆ˆθ

|

|xmax2

∼

1
2ˆzo  

1
ˆDx

+

1
ˆAx !

1/2

.

It is easy to see that, for any value of ˆzo,

∆ˆθ

|

|xmax

≫ |

∆ˆθ

|xmax2. In fact we

45

have

∆ˆθ
|
∆ˆθ
|

|xmax
|xmax2 ∼ q

q

ˆDx

1 + ( ˆDx/ ˆAx) >

ˆDx ≫

1 ,

q

(72)

in the limit for ˆDx ≫
signiﬁcant only for values of the variable
As a result we obtain the following equation for ˆG:

1. As a result the Fourier transform in Eq. (68) is
2 ˆAx ˆzo∆ˆθx/( ˆAx + ˆDx) near to zero.

−

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

x

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
o ∆ˆθ2
¯θ2
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o∆ˆθ2
2( ˆAy + ˆDy)

¯θ2
y + 4 ˆAy ˆz2

ˆDy + 4i ˆAy

¯θy ˆzo∆ˆθy



#

y

y + 2 ˆφy
ˆφ2

¯θy + 2i ˆAy ˆzo∆ˆθy



(cid:16)
2( ˆAy + ˆDy)

(cid:17)



exp

×

"−

exp



−

∞


d ˆφy exp

×

Z−∞

∞

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

×

Z−∞

S

ˆzo, ˆφ2
h

i

x + ( ˆφy + ∆ˆθy)2


, (73)

i



−


∆ˆθy)2

where horizontal and vertical coordinates are obviously factorized.

1 and ˆDx ≫

Eq. (73) has been derived assuming ˆNx ≫
1. Note that assuming
setting ∆ˆθy = ¯θy = 0 one can obtain Eq. (60) from Eq. (73). This proves that
Eq. (60) has a wider range of validity than that for ˆNy ≪
1 (as
the reader will remember, these assumptions were made just for notational
simplicity). In fact, as ˆNx ≫
1 horizontal and vertical direction
factorize and the horizontal factor is always that in Eq. (60), independently
on ˆNy and ˆDy.

1 and ˆDx ≫

1 and ˆDy ≪

1 or ˆDy ≫

Under one of the two extra assumptions ˆNy ≫
1, Eq. (73) can be
further simpliﬁed and often describes a weakly quasi-homogeneous wavefront
according to the deﬁnition given at the end of Section 4.1. At the end of
the Section we will show that as ˆDy ≫
1 we always have a weakly quasi-
homogeneous wavefront, for any value of ˆNy. It will also be seen that the same
applies when ˆNy ≫
1 (near ﬁeld) for any
value of ˆDy. However, as ˆNy ≫
1 we have an intermediate
region between the near and far region were, in general, wavefronts are not
quasi-homogeneous, not even in the weak case.

1 (far ﬁeld) or ˆAy ≫

1, ˆDy . 1 and ˆAy ∼

1 and ˆAy ≪

For simplicity of discussion we will set ¯θx = ¯θy = 0 thus obtaining from Eq.
(73)

46

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

"−

x

o∆ˆθ2
ˆDx
2 ˆAx ˆz2
( ˆAx + ˆDx) #

−
y + 2 ˆφy
ˆφ2


exp

∞

ˆDy

o∆ˆθ2
2 ˆAy ˆz2
y
( ˆAy + ˆDy) 
2i ˆAy ˆzo∆ˆθy


∞

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

×

Z−∞

∆ˆθy)2

S

x + ( ˆφy + ∆ˆθy)2

,

(74)

i

d ˆφy exp

×

Z−∞



−


ˆzo, ˆφ2
h

i

(cid:16)
2( ˆAy + ˆDy)

(cid:17)





which is easier to manipulate. It should be reminded that, if one is interested in
ascertaining the weak quasi-homogeneity of a wavefront, one has to deal with
the full Eq. (73). Moreover, it should be noted that on the one hand, within
the weak quasi-homogeneous case, Eq. (74) is quite general and we can extract
from it all important information on the transverse coherence independently
on the values of ¯θx and ¯θy . On the other hand though, in the case the weakly
quasi-homogeneous assumption fails, Eq. (74), e.g. when ˆNy ≫
1, ˆDy . 1 and
depends on ¯θy and the study of Eq. (74) has a more
ˆAy ∼
restricted range of validity, namely for the particular value of ¯θy = 0.

1 as we will see,

g

|

|

1 and arbitrary ˆDy, while in Section 5.2

In Section 5.1 we will assume ˆNy ≫
we will study the case with arbitrary ˆNy and ˆDy ≫
In general, the coherence length in the ˆy direction (calculated at ∆ˆθx = 0, but
= 0), ˆξcy is a function of ˆDy, ˆNy and ˆzo, as
trivially extendible to the case ∆ˆθx 6
it can be concluded by inspection of the general expression for ˆG in Eq. (67).

1.

1 and ˆDy is arbitrary we will demonstrate that ˆξcy can be approxi-

As ˆNy ≫
mated as

ˆξcy = Φ

ˆDy, ˆAy
h

i

,

(75)

1 and ˆDy ≪

where Φ is a universal function of the dimensionless parameters ˆDy and ˆAy.
We will ﬁrst study the asymptotic cases ˆDy ≫
1, which are useful
for physical understanding. Then we will generalize our results accounting for
the inﬂuence of a ﬁnite divergence of the electron beam on the cross-spectral
density. An analytical approximation for the function Φ will be proposed. This
will be chosen to match in a very simple way both asymptotic expressions for
1: we will demonstrate that for any value of ˆDy, dis-
ˆDy ≫
crepancies between the approximated and the actual (numerically calculated)
expression are less than 10%, though there is no theoretical reason to assume,
a priori, this relatively good accuracy. Also, at ˆAy ≪
1) we will
see that the VCZ theorem always hold.

1 and ˆDy ≪

1 (and ˆNy ≫

As ˆNy is arbitrary and ˆDy ≫

1 we will show, instead, that the coherence length

47

(calculated again at ∆ˆθx = 0, but trivially extendible to the case ∆ˆθx 6
can be approximated as

= 0)

ˆξcy = Ψ

o/ ˆNeﬀ( ˆNy)

,

ˆDy, ˆz2
h

i

(76)

ˆNeﬀ( ˆNy) being a universal function of the Fresnel number ˆNy. Ψ is a universal
function of the dimensionless parameters ˆDy, ˆNy and ˆzo. As usual in this
paper, we will ﬁrst study the asymptotic cases ˆNy ≫
1. Then
we will generalize our results accounting for any value of ˆNy. As before, an
analytical approximation for Ψ will be proposed. This will be chosen to match
in a very simple way both asymptotic expressions for ˆNy ≫
1:
again, we will demonstrate that for any value of ˆNy, discrepancies between the
approximated and the actual (numerically calculated) expression are less than
13% though there is no theoretical reason to assume, a priori, this relatively
good accuracy.

1 and ˆNy ≪

1 and ˆNy ≪

The case for a large Fresnel number with a ﬁnite electron beam divergence,
or viceversa of a large beam divergence and a ﬁnite Fresnel number, is of
practical importance. To give a numerical example, let us put λ = 1 ˚A, and
consider a typical vertical emittance (for third generation sources in operation)
10−11 m, that is ˆǫy ≃
ǫy ≃
0.6
3
·
and ˆNy ≃
6 and
ˆNy ≃
0.6.

6. On the other hand, if ˆβy = 0.3 we have, viceversa, ˆDy ≃

2. On the one hand, if ˆβy = 3, we have ˆDy ≃

5.1 Very large Fresnel number ˆNy ≫

1, arbitrary divergence parameter ˆDy

As a matter of fact, the only important assumptions used to derive results
Section 4.1 were that ˆNx ≫
1 that are valid here as well. When
these assumptions are granted, results can be factorized as a product of factors
dependent separately on the x and on the y directions. Then the spectral
degree of coherence in the horizontal direction will always be the same as in
Section 4.1. Diﬀerences will arise here, of course, due to ˆθy1

1 and ˆDx ≫

= ˆθy2.

1.

5.1.1 Case with divergence parameter ˆDy ≫
This case is the easiest to analyze, because one can follow step by step the
derivation for the one dimensional model given in the previous Section 4.1.
Calculations in the vertical direction y simply follow the derivation for the
horizontal direction x. As a result, one can start from Eq. (67) and perform,
separately for the x and the y directions, the same simpliﬁcations which hold

48

6
for the one-dimensional model. By comparison with Eq. (60), one obtains
directly the result

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDx
ˆAx + ˆDx

"−

o∆ˆθ2
ˆz2

x

exp

#

"−

2 ˆAy ˆDy
ˆAy + ˆDy

o∆ˆθ2
ˆz2

y

#

.

(77)

Normalization of Eq. (77) according to Eq.(66) has been obtained simply
setting ˆG(ˆzo, 0, 0) = 1. In this case as well, two-dimensional Fourier Transform
2 ˆAx ˆzo∆ˆθx /( ˆAx+ ˆDx)
of
|
2 ˆAy ˆzo∆ˆθy /( ˆAy + ˆDy) gives, in analogy with Eq. (58), an unessential
and
−
factor

2 calculated with respect the variables

x + ˆφ2
y]
|

S[ˆzo, ˆφ2

−

∞

∞

d ˆφx

d ˆφy

Z−∞

Z−∞

x + ˆφ2

y

ˆzo, ˆφ2
h

S
(cid:12)
(cid:12)
(cid:12)

2

i(cid:12)
(cid:12)
(cid:12)

= constant ,

(78)

which has been included in the normalization. Again, similarly as before one
can calculate the coherence area ˆΩc(ˆzo) deﬁned in analogy with ˆξc(ˆzo) as

ˆΩc(ˆzo) = ˆξcx(ˆzo) ˆξcy(ˆzo)

Performing the integration yields:

ˆΩc = π

1/2

1
ˆAx

 

+

1
ˆDx !

1
ˆAy

 

+

1
ˆDy !

1/2

In the limit for a large value of ˆzo the coherence area exhibits quadratic de-
pendence on ˆzo, that is ˆΩc −→
1/2, that
is at the end of the undulator, it converges to the constant value ˆΩc −→
π

o/( ˆNx ˆNy)1/2 while for ˆzo −→

1/(4 ˆNy) + 1/ ˆDy

πˆz2

1/2

1/2

.

1/(4 ˆNx) + 1/ ˆDx
h

i

h

It should be noted as before that the asymptotic behavior for ˆzo ≫

1 of g

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆz2

o ∆ˆθ2

x

exp

2 ˆAy ˆz2

o∆ˆθ2

y

−
h

−
h

i

(79)

(80)

(81)

(82)

and ˆΩc

ˆΩc =

πˆz2
o
ˆNx ˆNy

q

are direct application of van Cittert-Zernike theorem, as it must be since
ˆAx,y ≪
1. In fact, Eq. (81) is simply linked with the two-dimensional Fourier

i

i

49

transform of Fˆlx(ˆlx)Fˆly (ˆly).

1.

5.1.2 Case with divergence parameter ˆDy ≪
With respect to the situation treated in Paragraph 5.1.1, this case requires a
more careful analysis of the relations between diﬀerent parameters. In fact, on
the one hand ˆDy ≪
1 implies that the electron beam divergence drops out of
the problem parameters, but on the other hand in this case the divergence of
the radiation is described by the intrinsic divergence of undulator radiation,
that is described by a more complicate mathematical function, compared with
a Gaussian. In relation with this, it should be noted that simpliﬁcations in
Section 4.1 pr 5.1.1 were based on the very speciﬁc properties of the Gaus-
sian function representing the electron distributions in oﬀset and deﬂection.
Luckily, this is a realistic description in storage ring beam physics.

1 and ˆDx ≫

Let us consider Eq.(74). In order to derive it we only used the assumptions
1, for ¯θx = ¯θy = 0. The result of operations on the right
ˆNx ≫
hand side of Eq. (74) depend on how ˆNy scales with respect to ˆz2
o. The cases for
ˆAy > 1 cannot be dealt with fully analytically. In the following we will analyze
the asymptotic situation ˆAy ≪
1 and then we will treat semi-analytically the
generic situation for all values of ˆAy. As we will see, as soon as ˆAy < 1 we
start to be in the applicability region of the VCZ theorem.

It should be noted that the dependence in ∆ˆθx and ∆ˆθy in Eq. (74) are already
separated. Therefore, what has been said in Section 4.1 regarding the behavior
of coherence properties in the horizontal direction hold independently of the
behavior of coherence properties in the vertical direction.

1. — Since ˆNy ≫

(A) Far zone case: ˆAy ≪

1 in
order to allow for ˆAy ≪
1. Since we are working in quasi-homogeneous source
condition ( ˆNx,y ≫
1 we should recover VCZ
theorem: this is the far ﬁeld case. Even in the presence of the extra parameter
ˆDy we can treat the generic case ˆAy ≪
1 independently on how ˆAy compares
with respect to ˆDy.

1) in the limiting situation ˆAy ≪

1 it must be ˆz2

ˆNy ≫

o ≫

Eq. (74) can be simpliﬁed on the assumptions ˆAy ≪
1. In fact,
the Gaussian exponential factor inside the integral in d ˆφy in Eq. (74) imposes
a maximal value ˆφ2
ˆAy + ˆDy ≪

1 and ˆDy ≪

y ∼

1.

Simultaneously, from the oscillating factor, always inside the integral in d ˆφy,
we have a condition for the maximal value of ∆ˆθ2
1: in fact, if this
condition is not fulﬁlled the integrand will be highly oscillatory. Alternatively,
we can obtain a similar condition from the Gaussian exponential factor in ∆ˆθy

1/ˆz2

o ≪

y ∼

50

outside the integral, since ∆ˆθ2

1/( ˆAy ˆz2
o )

1.

≪

y ∼

As a result, the dependence of S on ( ˆφ + ∆ˆθy)2 can be dropped giving

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o∆ˆθ2
2 ˆAx ˆz2
ˆDx
( ˆAx + ˆDx) #

x

"−

exp



−

∞


ˆDy

o∆ˆθ2
2 ˆAy ˆz2
y
( ˆAy + ˆDy) 

2

S

d ˆφx

ˆzo, ˆφ2
x
h
2i ˆAy ˆzo∆ˆθy

(cid:12)
(cid:12)
(cid:12)

i(cid:12)
(cid:12)
(cid:12)

×
Z−∞
y + 2 ˆφy
ˆφ2

(cid:16)
2( ˆAy + ˆDy)

. (83)

(cid:17)





∞

×

Z−∞

d ˆφy exp



−



The integral in d ˆφy can be performed giving

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

ˆDy

2 ˆAy ˆz2

o∆ˆθ2
y
ˆAy + ˆDy

exp

×



−



"−

exp



∞




d ˆφx

×

Z−∞

2 ˆAx ˆz2

ˆDx

o ∆ˆθ2
x
ˆAx + ˆDx
o∆ˆθ2
2 ˆA2
y ˆz2
y
ˆAy + ˆDy

#





−

2


. (84)

S

ˆzo, ˆφ2
h

x

(cid:12)
(cid:12)
(cid:12)

i(cid:12)
(cid:12)
(cid:12)

Normalizing ˆG in such a way that ˆG(ˆzo, 0, 0) = 1 we obtain the following
expression for the spectral degree of coherence g:

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

ˆDy

2 ˆAy ˆz2

o∆ˆθ2
y
ˆAy + ˆDy

exp

×



−



ˆDx

2 ˆAx ˆz2

o∆ˆθ2
x
ˆAx + ˆDx
o∆ˆθ2
2 ˆA2
y ˆz2
y
ˆAy + ˆDy

#





"−

exp







−



. (85)

Finally, combination of the second and the third exponential functions yields
the result

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o∆ˆθ2
2 ˆAx ˆz2
ˆDx
( ˆAx + ˆDx) #

x

"−

exp

2 ˆAy ˆz2

o∆ˆθ2

y

,

−
h

i

that is, again, a direct application of the van Cittert-Zernike theorem. For
∆ˆθx = 0 we have

(86)

(87)

ξcy =

1/2

.

π
ˆAy !

 

51

1.

1 as

1. — This case encompasses situations with ˆzo ∼

(B) Case ˆAy ≫
well as situations with ˆzo ≫
1. Looking at the integral in ˆφy in Eq. (74) it is easy
Let us ﬁrst consider ˆzo ≫
to recognize that its integrand is highly oscillatory in ˆφy when 2 ˆφy ˆzo∆ˆθy ≫
1,
since ˆAy/( ˆAy+ ˆDy) < 1. Therefore, the integrand will contribute to the integral
signiﬁcatively only up to values 2 ˆφy ˆzo∆ˆθy . 1. On the other hand, the terms
in S give non negligible contributions only for values of ˆφy up to order unity.
As a result, it must be 2ˆzo∆ˆθy . 1. As ˆzo ∼
1 the width of g in ∆ˆθy is then
of order unity. When ˆzo becomes larger than unity, the angular width ∆ˆθy
will decrease and asymptotically, as ˆzo ≫
1, one will have a rapidly oscillating
1. However note that ∆ˆθy must be multiplied
integrand for ∆ˆθy ∼
1/ˆzo ≪
by ˆzo in order to obtain the correlation length which means that this remains
cLw/ω as ˆzo increases.
constant and comparable with the diﬀraction length
1, terms in ∆ˆθy can be dropped in the
As a result, under the assumption ˆzo ≫
) of Eq. (74), and the functions S can be substituted with their
functions S(
limiting form sinc. Moreover, in the limit for ˆAy ≫

1 and ˆDy ≪

1 we have

q

·

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDxˆz2

o ∆ˆθ2

x

"−

ˆAx + ˆDx
∞

exp

#

2 ˆDy ˆz2

o∆ˆθ2

y

i

−
h
x + ˆφ2
ˆφ2

y

/4

, (88)

∞

×

Z−∞

d ˆφy exp

2ˆzo∆ˆθy

ˆφy

d ˆφx sinc2

i
−

h

(cid:16)

(cid:17)

Z−∞
i

h(cid:16)

(cid:17)

i

1 and the exponential function exp [

where the simpliﬁcation in the phase under the integral in d ˆφy is possible
ˆφ2
for ˆzo∆ˆθy ˆφy ˆDy/ ˆAy ≪
y/2( ˆAy + ˆDy)]
−
under the integral in d ˆφy can be neglected because the sinc(
) function has
characteristic length in ˆφy of order unity. Eq. (88) is therefore valid in the
1. The integral in d ˆφy in Eq. (88) is
limit for ˆAy ≫
simply the Fourier transform of the universal function

1 and ˆzo ≫

1, ˆDy ≪

·

IS( ˆφy) =

d ˆφx sinc2

x + ˆφ2
ˆφ2

y

/4

.

h(cid:16)

(cid:17)

i

∞

Z−∞

(89)

done with respect to the variable 2ˆzo∆ˆθy, conjugate to ˆφy, that is

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDx ˆz2

o∆ˆθ2

x

ˆAx + ˆDx

"−
∞

d ˆφy exp

i
−
h

(cid:16)

×

Z−∞

exp

#

−
h
2ˆzo∆ˆθy

2 ˆDy ˆz2

o ∆ˆθ2

y

i
IS( ˆφy) . (90)
i

ˆφy

(cid:17)

52

Fig. 15. The normalized radiant intensity IS, calculated from Eq. (89), as a function
of the normalized vertical angle ˆφy.

It is not diﬃcult to see that the width of this Fourier transform in ∆ˆθy ˆzo is
much smaller than the characteristic width imposed by the Gaussian expo-
nentials outside the integration sign, their ratio being of order ˆDy ≪
1. This
means that the Gaussian in ∆ˆθ2
y outside the integral sign is almost constant
with respect to the behavior of the Fourier transform, and can be neglected,
to obtain

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDx ˆz2

o∆ˆθ2

x

"−

ˆAx + ˆDx

∞

#
Z−∞

d ˆφy exp

2ˆzo∆ˆθy

ˆφy

i
−
h

(cid:16)

IS( ˆφy) .
i

(cid:17)

(91)

The assumption ˆzo ≫
1 was vital for the derivation of Eq. (91). However,
for all values of ˆzo such that ˆAy ≫
1 (and, therefore, up to the exit of the
undulator at ˆzo = 1/2), it is easy to see from Eq. (67) that the source is quasi-
homogeneous, so that the ”anti” VCZ theorem applies and the cross-spectral
density of the ﬁeld at the source plane forms a Fourier couple with the angular
distribution of the radiant intensity, which is simply given by IS as deﬁned in
Eq. (89).

53

It is interesting to justify the fact that IS is in fact the angular distribution of
the radiant intensity. To this purpose, it is suﬃcient to note that IS is simply,
normalization factors aside, Eq. (176) of [3], which represents the intensity
0. A representation of IS( ˆφy) is given in
from a beam with ˆǫx → ∞
Fig. 15.

and ˆǫy →

As a result, one may therefore conclude that Eq. (91) is valid in general, for
any value of ˆzo such that ˆAy ≫
It is important to note that Eq. (91) can be written as

1, in the asymptotic limit ˆDy ≪

1.

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o ∆ˆθ2
2 ˆAx ˆDxˆz2
x
( ˆAx + ˆDx) #

"−

γ(ˆzo∆ˆθy) ,

where γ(ˆzo∆ˆθy), given by

γ(ˆzo∆ˆθy) =

d ˆφy exp

2ˆzo∆ˆθy

ˆφy

i
−
h

(cid:16)

IS( ˆφy) ,
i

(cid:17)

1
2π2

∞

Z−∞

(92)

(93)

is a universal function normalized to unity. It is possible to calculate Eq. (93)
analytically. To this purpose, it is suﬃcient to note that the Fourier Transform

∞

∞

d ˆφx

γ1(ξ, η) =

y
4 

can be evaluated with the help of the Bessel-Fourier formula as

i(ξ ˆφx + η ˆφy)
h

sinc2
i

d ˆφy exp

Z−∞

Z−∞





x + ˆφ2
ˆφ2

(94)

γ1(λ) = 2π

dφ φJ0 (φλ) sinc2

∞

Z0

= 2π

π + λ2Ci
"

 

λ2
2 ! −

2 sin

λ2
2 ! −

 

2Si

φ2
4 !
λ2
2 !#

 

 

(95)

where λ2 = ξ2 + η2, φ2 = φ2
is the cosine integral function. As a result one has

x + φ2

y, Si(

) is the sine integral function and Ci(
·

·

)

γ(ˆzo∆ˆθy) =

+ 2ˆz2

o∆ˆθ2

yCi

2ˆz2

o∆ˆθ2

y

sin

2ˆz2

o∆ˆθ2

y

Si

2ˆz2

o∆ˆθ2

y

.

(cid:16)

−

(cid:17)

(cid:16)

−

(cid:17)

(cid:16)

2
π (cid:20)

π
2

(cid:17)(cid:21)

(96)

The function γ(ˆzo∆ˆθy) is illustrated in Fig. 17.

54

^
^

F
F

s
s

(
(

)
)

y
y

5

4

3

2

1

0

-10

-8

-6

-4

-2

0

2

4

6

8

10

^

y

Fig. 16. Values of exp[
the plot is still similar to Fig. 15. Dashed line: ˆAy = 1.0.

−

ˆφy/(2 ˆAy)]IS( ˆφy) as a function of ˆφy. Solid line: ˆAy = 10,

It should be noted that γ(ˆzo∆ˆθy) is the spectral degree of coherence g calcu-
lated for ∆ˆθx = 0 in the limit for ˆAy ≫
1, in agreement with Eq.
(92).

1 and ˆDy ≪

(C) Case ˆAy ∼

1. — In case (B) we have shown that terms in ∆ˆθy can
be dropped in the functions S(
) of Eq. (74), for every value of ˆzo, and the
functions S can be substituted with their limiting form sinc. In the case of
ˆAy ∼

1 and ˆDy ≪

1 we have

·

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDx ˆz2

o∆ˆθ2

x

ˆAx + ˆDx

#

"−

∞

exp

2 ˆDy ˆz2

o ∆ˆθ2

y

−
h

d ˆφy exp

i2ˆzo∆ˆθy

ˆφy

exp

i



ˆφ2
y
2 ˆAy

×

Z−∞

−
h
∞

d ˆφx sinc2

h(cid:16)

×

Z−∞



−

i


x + ˆφ2
ˆφ2

y


. (97)

/4

(cid:17)

i

55

| |

1,0

0,8

0,6

0,4

0,2

0,0

0,0

0,5

1,0

1,5

2,0

2,5

3,0

as a function of ˆzo∆ˆθy. This universal plot illustrates the
calculated for ∆ˆθx = 0 in the

Fig. 17. Behavior of
|
absolute value of the spectral degree of coherence
limit for ˆAy ≫
The integral in d ˆφy in Eq. (97) is the Fourier transform of

γ
|
1 and ˆDy ≪

g
|

1 .

|

^ ^

z

o

y

(98)

FS( ˆφy) = IS( ˆφy) exp

ˆφ2
y
2 ˆAy







−



done with respect to the variable 2ˆzo∆ˆθy, conjugate to ˆφy. Similarly as before,
it is not diﬃcult to see that the width of this Fourier transform in ∆ˆθy ˆzo is
much smaller than the characteristic width imposed by the Gaussian expo-
nentials outside the integration sign, their ratio being of order ˆDy ≪
1. This
means that the Gaussian in ∆ˆθ2
y outside the integral sign is almost constant
with respect to the behavior of the Fourier transform, and can be neglected.
Using the deﬁnition of FS in Eq. (98) we have

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

2 ˆAx ˆDx ˆz2

o∆ˆθ2

x

"−

ˆAx + ˆDx

∞

#

Z−∞

d ˆφy exp

i2ˆzo∆ˆθy ˆφy

−
h

FS( ˆφy) .
i

(99)

56

|g|

1,0

0,8

0,6

0,4

0,2

0,0

0,0

0,5

1,0

1,5

2,0

2,5

3,0

^ ^

z

o

y

Fig. 18. The behavior of the absolute value of the spectral degree of coherence g
(at perfect resonance) as a function of ˆzo∆ˆθy. Here ˆzo = 1/2, ˆNy = 10 and ˆDy is
negligible. The black circles represent actual numerical data.

At this point, no simpliﬁcation is possible and numerical analysis of the prob-
lem should be undertaken in order to calculate ˆG, followed by normalization
according to

ˆG(ˆzo, 0, 0) =

d ˆφyFS( ˆφy) ,

∞

Z−∞

(100)

as already said, in order to ﬁnd an expression for the complex degree of coher-
ence g. This discussion underlines again how the correlation angle ∆ˆθy in the y
direction behaves. It starts from a constant value equal to the diﬀraction angle
c/(ωLw) when ˆzo ∼
1, which corresponds to the maximal possible value of
ˆAy once ˆNy is ﬁxed. Then it decreases as ˆzo grows. Asymptotically in limit for
q
o . ˆNy), it behaves as
ˆzo ≫
1/ˆzo, as it is clear from
the fact that the function FS, which is Fourier Transformed in Eq. (99), does
not depend on any parameter. However, it should be noted that ∆ˆθy must be
multiplied by ˆzo in order to obtain the correlation length, which means that
cLw/ω as
this remains constant and comparable with the diﬀraction length
ˆzo increases. Correlation length in the x direction is governed instead by the

1 (but still such that ˆz2

∼

q

57

(

z

)

c

o

 

4

8

6

2

0

0

2

4

6

8

10

12

14

 

z

o

Fig. 19. Normalized coherence length ˆξcy as a function of the normalized distance
ˆzo when the electron beam divergence is negligible. Here ˆNy = 10. The black circles
represent actual numerical calculations. The asymptotic limit for ˆAy ≪
1 (VCZ
theorem) is shown with a dotted line. Finally, the solid line is calculated with the
approximated formula (101).

Gaussian exponential function in ∆ˆθx outside the integral sign in Eq. (99),
exactly as in the simpliﬁed model treated in Section 4.1.

≪

We performed some numerical calculation with the aim of giving the reader
an exempliﬁcation. We set ∆ˆθx = 0 and ˆNy = 10. Assuming that we are in the
asymptotic limit ˆD
1 we can rely on what has been said in this paragraph
to calculate g and on Eq. (63) to calculate the correlation length ξcy in the
vertical direction for any value of ˆzo. These numerical results must agree with
the Van Cittert-Zernike limit for ˆAy ≪
1 treated in paragraph 5.1.1 (A): in
fact, Eq. (86) and Eq. (63) yield immediately a linear dependence of ξcy on
ˆzo as ˆAy ≪
1. Then, using paragraph 5.1.1 (B) we can extend the function
ξcy(ˆzo) to all values of ˆzo. In this way we obtain ξcy(ˆzo) for every value of ˆzo.
In Fig. 16 we plot Eq. (98) for two particular values of ˆAy: ˆAy = 10 (solid
line) and ˆAy = 1 (dashed line). Note that the solid line Fig. 16 is still similar
to Fig. 15, although the tails are changing and the width is already smaller.

58

The following step is to calculate the Fourier Transform of FS according to
Eq. (99) after normalization procedure according to Eq. (100). This gives g
calculated for ∆ˆθx = 0. Fig. 18 illustrates
for ˆzo = 1/2 as a function of
ˆzo∆ˆθy at ∆ˆθx = 0. Note that for this parameter choice we are still in the limit
for ˆAy ≫
1, which explains why Fig. 18 is practically identical to the universal
plot Fig. 17.

g

|

|

One can calculate the coherence length ˆξcy(ˆzo) straightforwardly by means of
Eq. (63). The curve obtained can be then compared, in the limit for ˆAy ≪
1,
with the van Cittert-Zernike behavior illustrated in Paragraph 5.1.2 (A). Fig.
19 shows our results. The black circles represent actual numerical calculations.
The asymptotic limit for ˆAy ≪
1 (VCZ theorem) is shown with a dotted line.
1, the coherence length ˆξcy(ˆzo) can be calculated
When ˆNy ≫
with the approximated formula

1 and ˆDy ≪

ˆξcy ≃ "

a2 +

1/2

.

π
ˆAy #

(101)

Under the approximation of negligibly small electron beam divergence in the
vertical direction, the normalized coherence length is thus a universal function
of one dimensionless parameter, ˆAy. On the one hand, Eq. (101) accounts for
the asymptotic behavior as ˆAy ≪
1 (VCZ theorem). On the other hand, the
value of ˆξcy in Eq. (101) approaches the constant value ˆξcy −→
a for asymp-
totically large values of ˆAy. Beside accurately reproducing the asymptotes for
small and large values of ˆAy, Eq. (101) provides an accuracy of several per
cent with respect to the result of numerical calculations (when ˆAy is within
)), in the whole range of the parameter ˆAy. The solid line in
the limits (0,
Fig. 19 is calculated with the approximated formula (101), where calculated a
numerically using Eq. (91) to calculate ˆξcy and obtaining a
1.12. Therefore,
1, we have ˆξcy = const = 1.12
according to Eq. (101), when ˆNy ≫
1 and 1/ ˆNy ≪
at the undulator exit (with accuracy ˆDy ≪
1) and, in dimen-
sional units, ξcy = 1.12
Lwc/ω. In this case the coherence length is a function
of undulator length and wavelength due to the intrinsic divergence of the
undulator radiation and a = 1.12 is a universal constant.

1 and ˆDy ≪

∞

≃

q

5.1.3 Case with ﬁnite divergence parameter ˆDy.

We will ﬁrst discuss, in Paragraph 5.1.3 (A), the limit for ˆAy ≪
1: in this
case, whatever the value of ˆDy, we will recover the VCZ theorem. Note that,
although we are discussing the limit ˆNy ≫
1 there always be values of ˆzo large
enough so that ˆAy ≪
1. Further on, in Paragraph 5.1.3 (B), we will discuss
the case ˆAy ≫
1, this

1: note that, since we are discussing the limit for ˆNy ≫

59

will always be the case near the exit of the undulator at ˆzo = 1/2. We will be
particularly interested to this situation; in fact, the study of the case ˆAy ≫
1
near the exit of the undulator will allow us to give an explicit representation
of Eq. (75).

(A) Far zone case ˆAy ≪

1. — Eq. (74) is still valid and can be calcu-
lated numerically, in principle, for any value of ˆzo. In the case ˆAy ≪
1 it can
be further simpliﬁed. In fact, in this situation, the second exponential func-
tion of the right hand side of Eq. (74) limits the possible values of ∆ˆθy to
∆ˆθy ≪
1 so that Eq. (97) is valid in this case. In particular,
remembering the deﬁnition of FS( ˆφy) in Eq. (98) we have

1. Moreover ˆzo ≫

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o∆ˆθ2
ˆDx
2 ˆAx ˆz2
( ˆAx + ˆDx) #

x

exp



−

ˆDy

o∆ˆθ2
2 ˆAy ˆz2
y
( ˆAy + ˆDy) 


d ˆφy exp


2 ˆAy ˆzo∆ˆθy
ˆAy + ˆDy

i
"−

ˆφy

FS( ˆφy) .

#

(102)

"−
∞

×

Z−∞

It is not diﬃcult to see that the ratio between the characteristic width in
∆ˆθy of the exponential function outside the integral sign and the exponential
ˆAy/ ˆDy and it is
function in inside the integral sign in Eq. (102) is of order
always much smaller than unity unless ˆDy ≪
1: such a case has already been
treated before in Paragraph 5.1.1 (A), and has been shown to obey the VCZ
theorem 5 . For all other values of ˆDy we have, automatically, ˆDy ≫
ˆAy, so
that we can neglect the integral in d ˆφy and we get back once more the Van
Cittert-Zernike regime. To sum up, we obtain the following expression for g,
1 with no restrictions on ˆDy:
which is valid for ˆAy ≪

q

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o∆ˆθ2
ˆDx
2 ˆAx ˆz2
( ˆAx + ˆDx) #

x

"−

exp

2 ˆAy ˆz2

o∆ˆθ2

y

.

(103)

−
h

i

Calculation of the coherence length from Eq. (103) at ∆ˆθx = 0 gives once
more the behavior

ξcy =

1/2

,

π
ˆAy !

 

(104)

5 Alternatively one may note directly that ˆφy can only range over values much
smaller than unity. As a result, the dependence of IS on ˆφy can be dropped, giving an
extra normalization constant to be disposed of. Then, the integral in d ˆφ performed
y/( ˆAy + ˆDy)] to be combined with
2 ˆA2
giving, as in Paragraph 5.1.1 (A), exp [
o ∆ˆθ2
the exponential function in ∆ˆθy outside the integral sign, giving exp [
y].

2 ˆAy ˆz2

o ∆ˆθ2

y ˆz2

−

−

60

which is consistent with the partial result in Paragraph 5.1.1 (A).

(B) Near zone, ˆAy ≫

1. — Equation (97) is still valid in this case and

following the same line of reasoning as paragraph 5.1.2 (B) one gets

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

o ∆ˆθ2
2 ˆAx ˆDxˆz2
x
( ˆAx + ˆDx) #

"−

exp

y

o ∆ˆθ2
2 ˆAy ˆDy ˆz2
( ˆAy + ˆDy) 




−



γ(ˆzo∆ˆθy) ,

(105)

−

o∆ˆθ2

1, for ˆzo = 1/2 we have ˆAy ≫

1 and arbitrary ˆDy. Note that since we are working in the limit
valid for ˆAy ≫
for ˆNy ≫
1. We can see from Eq. (105) that,
for ﬁnite values of ˆDy, the cross-spectral density g, evaluated at the exit of
the undulator for ∆ˆθx = 0, is given by the product of the exponential func-
2 ˆDy ˆz2
y] with the function illustrated in Fig. 18. This remark is
tion exp [
intuitively sound. Since ˆNy ≫
1 in fact we have weakly quasi-homogeneous
wavefronts near the exit of the undulator, and we can use the ”anti” VCZ
theorem to conclude that g must for a Fourier couple with the intensity distri-
bution in the far zone. This will simply be, for any arbitrary ˆDy, a convolution
ˆDy and IS, which
between a Gaussian distribution with rms width equal to
is the angular distribution of radiant intensity for a beam with ˆǫx −→ ∞
and
ˆǫy −→
0. Finally, the Fourier transform of such a convolution between two
function is simply given by the product of the Fourier transforms of the two
functions.

q

(C) Approximate formula. — With in mind Eq. (80), Eq. (101) and Eq.

(104) we make the working hypothesis that Eq. (75) has the form

ˆξcy =

π
ˆDeﬀ( ˆDy)

 

+

π
ˆAy !

1/2

.

(106)

1, we have seen that if ˆDy ≫

Within the assumption ˆNy ≫
1 Eq. (80) is valid
with relative accuracy 1/ ˆDy. This means that, in this limit, ˆDeﬀ( ˆDy) = ˆDy.
Then we have seen that if ˆDy ≪
1 Eq. (101) holds with accuracy 1/ ˆNy. This
means that ˆDeﬀ(0) = 2.50. Moreover we have seen that in the far zone case,
in the limit for ˆAy ≪
1, the VCZ theorem holds, in agreement with Eq. (104).
We are now in position to calculate ˆDeﬀ = f ( ˆDy) for any value of ˆDy. Eval-
uation of Eq. (105) at ˆzo = 1/2, followed by normalization according to
ˆG(ˆzo, 0, 0) = 1 gives the function g. Further integration of
2 to calculate
the correlation function allows to recover ˆDeﬀ = f ( ˆDy) as plotted in Fig. 20.

g

|

|

One may choose to calculate ˆDeﬀ = f ( ˆDy) numerically, but it is also possible

61

^

^

D

(D

)

eff

y

25

20

15

10

5

0

0

2

4

6

8

10

12

14

16

18

20

^

D

y

Fig. 20. Comparison between exact and interpolated ˆDeﬀ functions. Solid line: plot
of the exact result. Circles: approximation according to Eq. (107).

to use, with reasonable accuracy, the following analytical interpolation of ˆDeﬀ:

ˆDeﬀ

ˆDeﬀ(0) + ˆDy = 2.50 + ˆDy .

≃

There is of some interest to compare the exact and interpolated ˆDeﬀ( ˆDy)
functions. Fig. 21 shows the function

(107)

(108)

∆( ˆDy) =

1

ˆDeﬀ( ˆDy)
ˆDeﬀ(0) + ˆDy (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

−

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

There is seen to be good agreement between the interpolated and exact ˆDeﬀ
functions for small and large value of ˆDy. Noticeable discrepancies for ˆDy close
to unity are, anyway, less than 10%.

Our conclusive result is, therefore, the following: when ˆNy ≫

1 and ˆDy assumes

62

^

(D

)

y

0,05

0,04

0,03

0,02

0,01

0,00

0

5

10

15

20

25

30

35

40

45

50

^

D

y

Fig. 21. Relative accuracy ∆( ˆDy) of the match between true and interpolated ˆDeﬀ
functions.

arbitrary values we have:

ˆξcy ≃  

π
2.50 + ˆDy

+

π
ˆAy !

1/2

.

(109)

Also, it is important to remember that under conditions ˆNy ≫
1 and arbitrary
ˆDy the spectral degree of coherence is given by Eq. (105) in the near zone,
and by Eq. (103) in the far zone.

The ﬁnal step is to check that our main work hypothesis, i.e. that the coherence
length has the form in Eq. (106) is correct. This can be done comparing Eq.
(109) with numerical calculations for any given value of ˆNy ≫
1 and a ﬁnite
ˆDy, which give a good agreement.

63

5.2 Very large divergence ˆDy ≫

1, arbitrary Fresnel number ˆNy

We now move on to treat the case with arbitrary beam transverse size com-
pared with the diﬀraction size (i.e. arbitrary Fresnel number ˆNy) and large
divergence compared with the diﬀraction angle (i.e. ˆDy ≫
1). The partic-
ular case for ˆNy ≫
1 overlaps with the previous Section 5.1
and has already been treated in Section 5.1.1. The conclusion was that ξcy =
(π/ ˆDy + π/ ˆAy)1/2. In all the other remaining cases Eq. (74) can be simpliﬁed
as follows:

1 and ˆDy ≫

ˆG(ˆzo, ∆ˆθx, ∆ˆθy) = exp

∞

∞

ˆDx

2 ˆAx ˆz2

o∆ˆθ2
x
ˆAx + ˆDx

#

"−

exp

ˆDy

2 ˆAy ˆz2

o∆ˆθ2
y
ˆAy + ˆDy



−







d ˆφy

d ˆφxS∗

ˆzo, ˆφ2

×

Z−∞

Z−∞

h

x + ( ˆφy −

∆ˆθy)2

S
i

ˆzo, ˆφ2
h

x + ( ˆφy + ∆ˆθy)2

,

(110)

i

that is

where

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

ˆDx

2 ˆAx ˆz2

o∆ˆθ2
x
ˆAx + ˆDx

#

"−

exp

ˆDy

2 ˆAy ˆz2

o∆ˆθ2
y
ˆAy + ˆDy

˜f (ˆzo, ∆ˆθy) ,



−







(111)

˜f (ˆzo, ∆ˆθy) =

1
2π2

∞

∞

d ˆφy

d ˆφxS∗

Z−∞

Z−∞

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S
i

ˆzo, ˆφ2
h

x + ( ˆφy + ∆ˆθy)2

, (112)

i

As is shown in Appendix C, having deﬁned

β(∆ˆθy) =

d ˆφy

d ˆφxsinc

1
2π2

∞

∞

Z−∞

Z−∞

x + ( ˆφy −
ˆφ2
4

"

∆ˆθy)2

x + ( ˆφy + ∆ˆθy)2
ˆφ2
4

#

sinc

#

"

, (113)

we have the important result

˜f (ˆzo, ∆ˆθy) = β(∆ˆθy)

(114)

for every choice of ˆzo. β is deﬁned in such a way to be normalized to unity. If
we account for Eq. (114) we obtain the following expression for the spectral
degree of coherence g:

64

Fig. 22. Plot of
value of the spectral degree of coherence
ˆNy ≪
1.

β
|
|
1 and ˆDy ≫

g
|

|

as a function of ∆ˆθy. This universal plot illustrates the absolute
calculated for ∆ˆθx = 0 in the limit for

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

ˆDx

2 ˆAx ˆz2

o∆ˆθ2
x
ˆAx + ˆDx

#

"−

exp

ˆDy

2 ˆAy ˆz2

o∆ˆθ2
y
ˆAy + ˆDy



−



β(∆ˆθy) .





(115)

It should be noted that, as ˆNy ≫
1, the width of the gaussian function in
∆ˆθy in Eq. (115) becomes much smaller than unity and the function β can be
considered constant and drops out of the normalized expression for g. So, even
if we did not analyze here the limit for ˆNy ≫
1 (we did it in Paragraph 5.1.1),
we see that the limit of Eq. (115) for ˆNy ≫
1 restitutes the results found in
Paragraph 5.1.1. Therefore we conclude that Eq. (115) is valid for any value
of ˆNy.

As is shown in Appendix C, the function β(∆ˆθy) can also be calculated as

β(∆ˆθy) =

∞

1
π

Z0

dα αJ0

α

 

∆ˆθy
2 !

π

h

−

2Si(α2)

2

.

i

(116)

65

^^

N

(N )

eff

y

 

10

8

6

4

2

0

0

1

2

3

4

5

6

7

8

9

10

^
^

y
y

Fig. 23. Comparison between exact and approximated ˆNeﬀ ( ˆNy) functions. Solid
line: plot of the exact results. Circles: interpolation according to Eq. (121).

where Si indicates the sine integral function. The representation of β in Eq.
(116) is easier to deal with numerically, because it involves a one-dimensional
to obtain the
integration only. Performing the integral, one can tabulate
plot in Fig. 22. This is an universal plot. It should be noted that β(∆ˆθy) is
the spectral degree of coherence g calculated for ∆ˆθx = 0 in the limit for
1. Its generalization for arbitrary ˆNy is given by Eq. (115).
ˆNy ≪
Using Eq. (115) and the tabulated values for the universal function β we can
therefore calculate g numerically for any choice of ˆNy and subsequently, we
can calculate the coherence length ξcy(ˆzo). For instance, in the particular case
ˆNy = 10 and ∆ˆθx = 0 we obtain the simple linear behavior

1 and ˆDy ≫

β

|

|

For a generic value of ˆNy, one can introduce an eﬀective function ˆNeﬀ( ˆNy) so
that

ξcy(ˆzo) = 0.54ˆzo

ξcy(ˆzo) =

π
ˆNeﬀ( ˆNy)

ˆzo

s

66

(117)

(118)

On the one hand, the function ˆNeﬀ( ˆNy) can be computed numerically, similarly
as we did for the particular case ˆNy = 10. ˆNeﬀ( ˆNy) is represented by the solid
line in Fig. 23.

On the other hand, one may also use an interpolation for ˆNeﬀ( ˆNy). First,
numerical calculations tell us that, in the particular case ˆNy −→
0, we have

ξcy(ˆzo) =

π
0.35

ˆzo .

r

Second, as ˆDy ≫

ξcy(ˆzo)

−→ s

1 and ˆNy ≫
π
ˆNy

ˆzo .

ˆDy we have

The simpler interpolated formula which satisﬁes both asymptotes is therefore:

ˆNeﬀ( ˆNy)

ˆNy + 0.35 ,

≃

The interpolation of ˆNeﬀ( ˆNy) is represented by black circles line in Fig. 23.

There is of some interest to compare the exact and interpolated ˆNeﬀ( ˆNy)
functions. Fig. 24 shows the function

∆( ˆNy) =

1

ˆNeﬀ( ˆNy)
ˆNeﬀ(0) + ˆNy (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

−

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

There is seen to be good agreement between the interpolated and exact ˆNeﬀ
functions for small and large value of ˆNy. Noticeable discrepancies for ˆNy close
to unity are, anyway, less than 13%.

Since in the case ˆDy ≫
π/ ˆAy)1/2, we can formulate the hypothesis that, for ˆDy ≫
of ˆNy one has

1 and ˆNy ≫

1 we concluded that ξcy = (π/ ˆDy +
1 and generic value

ξcy(ˆzo) =

π
ˆDy

 

+

π
0.35 + ˆNy

ˆz2
o

!

1/2

.

The ﬁnal step is to check that such hypothesis is correct. This can be done
comparing Eq. (123) with numerical calculations for any given value of ˆDy ≫
1
and ﬁnite ˆNy, which give a good agreement.

67

(119)

(120)

(121)

(122)

(123)

^

(N

)

y

0,12

0,10

0,08

 

0,06

0,04

0,02

0,00

0

1

2

3

4

5

6

7

8

9

10

^
^

y
y

Fig. 24. Relative accuracy ∆( ˆNy) of the match between exact and interpolated ˆNeﬀ
functions.

5.3 Conditions for the source to be quasi-homogeneous

Up to this moment we discussed, for simplicity, the case ¯θx = ¯θy = 0. We
will now treat the generic case with arbitrary ¯θx and ¯θy. This discussion will
reduce to the relation between the weakly quasi-homogeneous condition and
our assumptions ˆNx ≫
1. When
we deal with weakly quasi-homogeneous wavefront, the results found for ¯θx =
¯θy = 0 have extended validity for generic values of ¯θx and ¯θy. As already said
before though, we will ﬁnd that the wavefronts are not always weakly quasi-
homogeneous in the vertical y direction. In this case, previously found results
are only valid in the particular case ¯θy = 0. Let us consider the situation in
more detail. We will start with Eq. (73), that may also be written as

1 and either ˆNy ≫

1 or ˆDy ≫

1, ˆDx ≫

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
o ∆ˆθ2
¯θx ˆzo∆ˆθx
¯θ2
ˆDx + 4i ˆAx
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)

#

x

exp

×

"−

68

exp



−

∞


d ˆφy exp

2 ˆAy ˆz2

y

o∆ˆθ2

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy
(¯θy + ˆφy)2 + 4i ˆφy ˆAy ˆzo∆ˆθy
2( ˆAy + ˆDy)





#

"−

×

Z−∞

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S

ˆzo, ˆφ2
h

i

×

Z−∞

x + ( ˆφy + ∆ˆθy)2

. (124)

5.3.1 Very large divergence parameter ˆDy ≫
Because of the properties of the S function ˆφy can only change of a quantity
∆ ˆφy ∼
1, otherwise the S functions will drop to zero. Then, since ˆDy ≫
1 we
have from Eq. (124)

1

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

x

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
o ∆ˆθ2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
¯θ2
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy

−





#

y

exp

exp

×

"−



¯θ2
y
2( ˆAy + ˆDy) #

∞

Z−∞

d ˆφy exp



2i ˆφy ˆAy ˆzo∆ˆθy
( ˆAy + ˆDy) #

"−

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S

ˆzo, ˆφ2
h

i

×

Z−∞

x + ( ˆφy + ∆ˆθy)2

. (125)

that is obviously weakly quasi-homogeneous.

∞

∞

i

i

5.3.2 Very large Fresnel number ˆNy ≫

1.

(A) Case ˆAy ≫

1 we can follow the same line of
reasoning in Section 5.3.1 simply replacing the roles of ˆDy with ˆAy, obtaining

1.— In the case ˆAy ≫

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

x

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
o ∆ˆθ2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
¯θ2
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy

−





#

y



exp



69

exp

×

"−

¯θ2
y
2( ˆAy + ˆDy) #

∞

Z−∞

d ˆφy exp

2i ˆφy ˆAy ˆzo∆ˆθy
( ˆAy + ˆDy) #

"−

∞

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S

ˆzo, ˆφ2
h

i

×

Z−∞

x + ( ˆφy + ∆ˆθy)2

. (126)

i

that is obviously weakly quasi-homogeneous.

(B) Case ˆAy ≪

1.— In this situation it must be ˆzo ≫

can substitute all S functions with sinc functions. The case ˆDy ≫
already treated. Let us, therefore, ﬁrst assume ˆDy ∼
∆ˆθ2
1, Eq. (124) gives directly

1/ˆz2

1. Therefore we
1 has been
1. Using the fact that

y ≪

o ≪

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
2( ˆAx + ˆDx)
∞

x

ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx

i2
h

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
(cid:16)

2 ˆAy ˆz2

(cid:17)i
o∆ˆθ2

y

exp

×

"−

exp

−
#
h
( ˆφy + ¯θy)2
2 ˆDy

i
IS( ˆφy) , (127)
#

d ˆφy exp

"−

×

Z−∞

that is obviously weakly quasi-homogeneous.

1 and ˆDy ≪

1. Eq. (124) can be simpliﬁed on the
1. In fact, the Gaussian exponential factor

Now let us consider the case ˆDy ≪
assumptions ˆAy ≪
inside the integral in d ˆφy in Eq. (124) imposes a maximal value (¯θy + ˆφy)2
ˆAy + ˆDy ≪
Simultaneously, from the Gaussian exponential factor in ∆ˆθy outside the in-
tegral, we have a condition for the maximal value of ∆ˆθ2
1 since
∆ˆθ2

o ≪

1/ˆz2

y ∼

∼

1.

1.

1/( ˆAy ˆz2
o)

y ∼

≪

As a result, the dependence of S on ( ˆφ + ∆ˆθy)2 can be substituted by a depen-
dence on ¯θy and, as has already been said, the S functions can be substituted
with sinc functions, giving

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
(cid:17)i

x

i2
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
h
(cid:16)
2( ˆAx + ˆDx)
ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy

o∆ˆθ2

2 ˆAy ˆz2

y

IS(¯θy)


#



exp

×

"−

exp

×



−



70

∞

×

Z−∞

d ˆφy exp



−

(¯θy + ˆφy)2 + 2 ˆφy

2i ˆAy ˆzo∆ˆθy

2( ˆAy + ˆDy)

(cid:16)

. (128)

(cid:17)






The integral in d ˆφy can be performed giving

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
(cid:17)i

i2
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
h
(cid:16)
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

x

#



y

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy
2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy

#


IS(¯θy) . (129)

exp


×
−
o∆ˆθ2
2 ˆA2

y ˆz2
y
ˆAy + ˆDy

exp

"





exp

×



−



Normalizing ˆG in such a way that ˆG(ˆzo, ¯θx, ¯θy, 0, 0) = 1 we obtain the following
expression for the spectral degree of coherence g:

g(ˆzo, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
(cid:16)

i2

h

¯θ2
x + 4 ˆAx ˆz2

x

o∆ˆθ2
2( ˆAx + ˆDx)

2 ˆAy ˆz2

o∆ˆθ2

y

, (130)

exp

#

−
h

(cid:17)i

i

exp

×

"−

which generalizes Eq. (85) for any value of ¯θx and ¯θy, and shows weak quasi-
homogeneity of the wavefronts.

(C) Case ˆAy ∼

1.— Since ˆNy ≫
in ∆ˆθy outside the integral sign of Eq. (73) impose ∆ˆθy ≪

1 and ˆzo ≫

1, the exponential function
1 so that

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
(cid:17)i

i2
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
h
(cid:16)
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

x

y

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy

#



exp



−

∞

×

Z−∞

d ˆφy exp



(¯θy + ˆφy)2 + 4i ˆφy ˆAy ˆzo∆ˆθy
2( ˆAy + ˆDy)


IS( ˆφy) . (131)
#

"−

The intensity distribution can be found from Eq. (131) setting ∆ˆθx = ∆ˆθy = 0
thus obtaining

71

I(ˆzo, ¯θx, ¯θy) = exp

¯θ2
x
2( ˆAx + ˆDx) #

"−

∞

Z−∞

d ˆφy exp

(¯θy + ˆφy)2
2( ˆAy + ˆDy) #

"−

IS( ˆφy) .

(132)

=
It is evident by inspection that we cannot factorize Eq. (131) to obtain
I(ˆzo, ¯θx, ¯θy)w(ˆzo, ∆ˆθx, ∆ˆθy) (where have put
= w(ˆzo, ∆ˆθx, ∆ˆθy)). As a result
we conclude that, in this case, the wavefront is not quasi-homogeneous, not
even in the weak sense.

g

|

|

|

ˆG
|

5.3.3 Discussion.

Let us discuss the results obtained in this analysis of quasi-homogeneity.

In Section 4.1 we have seen that weakly quasi-homogeneous wavefronts which
are not quasi-homogeneous in the usual sense are present in the far ﬁeld, when
the VCZ theorem holds. From our analysis in the one-dimensional framework,
the notion of far zone arises in the x direction, when the apparent angular
dimension ˆAx of the source is much smaller than the divergence of the radiation
beam that, in this case, can be identiﬁed with the electron beam divergence
ˆDx the wavefront is quasi-
1. Both ˆNx ≫
ˆDx ≫
homogenous but only in the weak sense, one is in the far zone and the VCZ
ˆDx one is in the near ﬁeld zone and the wavefront
theorem applies. If ˆAx ≫
is quasi-homogeneous in the usual sense. Transition from the near to the far
zone always involves, in this case, weakly quasi-homogeneous wavefront.

1 and ˆDx ≫

1. If ˆAx ≪

In the two-dimensional framework studied in the present Section, as for the
one-dimensional model, both ˆNx and ˆDx ≫
1. The x and the y coordinates
appear factorized and the far zone applies now separately to both x and y
directions, meaning that ˆAx,y of the source is much smaller than the divergence
of the radiation beam. In other words, we are in the far zone as soon as
the (square of the) beam size at a given ˆzo begins to be much larger than
the (square of the) initial size of radiation (i.e. much larger than the Fresnel
numbers ˆNx,y).

1, independently on the value of ˆNy, we will always have
In the case ˆDy ≫
weakly quasi-homogeneous (but not always quasi-homogeneous in the usual
sense!) wavefronts at any distance ˆzo. This is exactly the situation discussed
for the x direction, where transitions from the near ( ˆAy ≫
ˆDy) to the far ﬁeld
ˆDy) involve only weakly quasi-homogeneous wavefronts. Moreover, in
( ˆAy ≪
the far ﬁeld zone, the VCZ theorem is valid.

In the case with ˆDy . 1, ˆNy ≫
the usual sense at ˆzo ∼
in the far zone, at ˆzo ≫

1 we will have quasi-homogeneous wavefronts in
1 (near zone) and weak quasi-homogeneous wavefronts
1.

72

ˆNy, we have
Finally, if ˆNy ≫
seen that the wavefront is non quasi-homogenous, not even in the weak sense.

1, i.e. for distances ˆzo ∼

1, ˆDy . 1 and ˆAy ∼

q

These results can be seen in terms of convolution between the Gaussian dis-
tribution of intensity associated to the electron beam emittance and the dis-
tribution of intensity due to intrinsic properties of undulator radiation. The
only case, among those treated up to now, when such a convolution does not
simplify into the product of separate factors is when ˆNy ≫
1, ˆDy not much
larger than unity and ˆAy ∼
1: in this case we do not have quasi-homogeneous
wavefronts, not even in the weak sense.

6 Radiation from some non-homogeneous undulator sources

1, ˆDx ≫
In Section 4.1 we treated a simpliﬁed situation with ˆNx ≫
1 and
ˆθy1 = ˆθy2. Moreover, for simplicity of calculations we assumed ˆNy ≪
1 and
ˆDy ≪
1. In Section 5, instead, we treated the case of electron beams with
1 or ˆDy ≫
1, ˆDx ≫
ˆNx ≫
1 (or both). It is important to
note that, in the x direction, the results obtained in Section 4.1 are the same
as the one in Section 5. In fact as ˆNx ≫
1, the cross-spectral
density factorizes in the product of two contributions depending separately on
the x and y coordinates, and under ˆNx ≫
1 the derivation of the
x-dependent factor is always the same.

1 and ˆDx ≫
1 and ˆDx ≫

1 and either ˆNy ≫

1, ˆDx ≫

1 or ˆDy ≫

1 and either ˆNy ≫

We have seen that in some of the cases discussed in Section 5.3, the assump-
tions ˆNx ≫
1 (or both) were enough to
guarantee that the wavefront is weakly quasi-homogeneous in the sense speci-
ﬁed by Eq. (23). In this Section we will extend our analytical investigations to
some cases outside the range of parameters treated before, where the weakly
quasi-homogeneous assumption is not fulﬁlled in the far zone. In particular,
we will demonstrate that, under conditions ˆNx ≫
1 and both ˆNy ≪
1, ˆDx ≫
1
and ˆDy ≪
1, wavefronts are not weakly quasi-homogenous in the vertical y
direction (although they are in the horizontal x direction).

1, ˆDx ≪
1 and ˆDy ≪

First, in Section 6.1 we will analyze the case ˆNx ∼
1. Assuming
a vertical emittance of the electron beam much smaller than the horizontal
ˆǫx, we have, automatically ˆNy ≪
emittance ˆǫy ≪
1. This cor-
responds to a practically important situation. For instance, consider a VUV
10−9 m,
beamline at a third generation light source with λ = 30 nm, ǫx = 3
10−3. If ˆβx = 3 we would
10−9 m, i.e. ˆǫx = 0.6 and ˆǫy = 6
and ǫy = 0.03
have ˆNx = 2 and ˆDx = 0.2. Second, in Section 6.2 we will study the situation
ˆNy . 1 and ˆDy ≪
1 and ˆDx ≫
1, that will give us back also
1 and ˆDx ≫
the limiting case for ˆNy ≪
1 (already

1 with ˆNx ≫

1 with ˆNx ≫

1 and ˆDy ≪

·

·

·

73

discussed in Section 4.1). The situation with ﬁnite vertical Fresnel number and
negligible vertical divergence (compared with the diﬀraction angle) is a very
practical one: for instance, given a third generation light source with λ = 1˚A
and ǫy = 10−11 m, i.e. ˆǫy = 0.6, a value ˆβy = 6 corresponds to ˆDy = 0.1 and
ˆNy = 3.6.

Although in these two cases, the weakly quasi-homogeneous assumption is not
fulﬁlled we will see that the choice ˆzo ≫
1 will allow us to treat these situations
in analogy with respect to some weakly quasi-homogeneous case we already
dealt with.

6.1 Case ˆNx ∼

1, ˆDx ≪

1.

Assuming a vertical emittance of the ring much smaller than the horizontal
emittance ˆǫy ≪
1. We start
with Eq. (67), that can be specialized to an equation dependent on the x
coordinates only and, in the case for ˆzo ≫

1 and ˆDy ≪
1, can be written as

ˆǫx, we have, automatically, ˆNy ≪

ˆG(ˆzo, ¯θ, ∆ˆθ) =

exp

i2¯θ∆ˆθˆzo
(cid:16)
2π( ˆN/ˆz2

(cid:17)
o + ˆD)

exp

"−

q

4 ˆN ∆ˆθ2 ˆD + 4i( ˆN/ˆzo)¯θ∆ˆθ

ˆφ + ¯θ
(cid:17)
2( ˆN /ˆz2

2( ˆN/ˆz2
2

o + ˆD)
+ 4i ˆφ( ˆN /ˆzo)∆ˆθ
o + ˆD)
( ˆφ + ∆ˆθ)2/4

#



∆ˆθ)2/4

sinc
i

h



, (133)

i

∞

×

Z−∞

d ˆφ exp 
− (cid:16)


−

( ˆφ
h

sinc

×

where we systematically omitted x subscripts. Since ˆA + ˆD
1, the expo-
nential factor in (φ + ¯θ)2 inside the integral sign in Eq. (133) behaves like a
δ-Dirac function with respect to the sinc(
) functions inside the same integral:
·
as a result we can substitute φ with ¯θ in the sinc(
) functions, which drop out
of the integral sign. Then, the integral in d ˆφ can be calculated analytically so
that we have:

≪

·

ˆG(ˆzo, ¯θ, ∆ˆθ) = exp

i2¯θ∆ˆθˆzo

exp

sinc

×

(cid:16)
(¯θ
h

−

(cid:17)
∆ˆθ)2/4

exp

×

"−

"−

2 ˆN∆ˆθ2 ˆD
ˆN/ˆz2
o + ˆD #
(¯θ + ∆ˆθ)2/4
o)∆ˆθ2
2( ˆN 2/ˆz2
h
o + ˆD #
ˆN/ˆz2

sinc
i

i
. (134)

Combination of the second and the third exponential function yields

74

ˆG(ˆzo, ¯θ, ∆ˆθ) = exp
sinc

(¯θ
h

−

i2¯θ∆ˆθˆzo
(cid:17)
sinc
i

2 ˆN ∆ˆθ2
exp
−
(¯θ + ∆ˆθ)2/4
h
h

i

∆ˆθ)2/4
(cid:16)

×

i
. (135)

Finally, in order to obtain the degree of spectral coherence g we should nor-
malize ˆG according to Eq. (66) 6 thus obtaining

g(ˆzo, ¯θ, ∆ˆθ) = exp

i2¯θ∆ˆθˆzo
(cid:16)

(cid:17)

exp

2 ˆN∆ˆθ2

.

−

h

i

(136)

|

|

g

1 and ˆDx ≪

According to Eq. (136) the spectral degree of coherence g is such that
is
only function of ∆ˆθ. Moreover, the dependence of g on the phase 2¯θ∆ˆθˆzo is a
feature for radiation from Schell’s model sources in the far ﬁeld, that we have
already encountered many times in the study of weakly quasi-homogenous
cases. As a result we can conclude that the radiation of the undulator source
at ˆNx ∼
1 represents the far ﬁeld radiation of a Schell’s model
source. Finally, it should be noted that in a two-pinhole experiment, for any
vertical position of the pinholes, the fringe visibility, i.e. the modulus of the
spectral degree of coherence depends only on the separation along the hori-
zontal x direction. As a result, while in Section 4.1 we put ˆθy1 = ˆθy2, thus
selecting from the very beginning a horizontal plane, the present case can be
fully described by a one-dimensional model, independently on the choice of
transverse coordinates of the pinholes.

6.2 Case ˆNy . 1 and ˆDy ≪

1 with ˆNx ≫

1, ˆDx ≫

1

1 we
1, which is the limiting case treated in Paragraph 5.1.2 (A): the

In this situation we go back to a two-dimensional model. When ˆzo ≫
have ˆAy ≪
diﬀerence is that, now ˆNy ∼

1. Let us start with Eq. (73) written as

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
o ∆ˆθ2
¯θ2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

#

x

y

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy
(¯θy + ˆφy)2 + 4i ˆφy ˆAy ˆzo∆ˆθy
2( ˆAy + ˆDy)





#



−

"−

exp

∞


d ˆφy exp

×

Z−∞

6 Note that, in this case, we are dealing with non quasi-homogeneous wavefronts
and, as has already been said, normalizing according to ˆG(ˆzo, ¯θ, 0) = 1 is not the
same of normalizing according to Eq. (66).

75

∞

d ˆφxS∗

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S

ˆzo, ˆφ2
h

i

×

Z−∞

x + ( ˆφy + ∆ˆθy)2

, (137)

i

1 impose a maximal value of (¯θy + ˆφy)2
ˆAy ≪
1 and ˆDy ≪
1.
Moreover the S functions can be substituted with sinc functions since we are
working in the limit for ˆzo ≫

1. Then, from Eq. (137) we obtain

ˆAy + ˆDy ≪

∼

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o ∆ˆθ2

2 ˆAy ˆz2

#

x

y

exp



−
∆ˆθy)2
x + (¯θy −
ˆφ2
4



sinc
#

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy
x + (¯θy + ∆ˆθy)2
ˆφ2
4

"





#

∞

×

Z−∞

d ˆφxsinc

"

∞

×

Z−∞

d ˆφy exp

(¯θy + ˆφy)2 + 4i ˆφy ˆAy ˆzo∆ˆθy
2( ˆAy + ˆDy)

#

"−

, (138)

As done before, the integral in d ˆφy can be performed giving

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

×

"−

x

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
¯θx ˆzo∆ˆθx
o ∆ˆθ2
¯θ2
ˆDx + 4i ˆAx
x + 4 ˆAxˆz2
h
(cid:16)
(cid:17)i
2( ˆAx + ˆDx)
o∆ˆθ2

2 ˆAy ˆz2

ˆDy + 2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy





#

y

exp



−
o∆ˆθ2
2 ˆA2
y ˆz2
y
ˆAy + ˆDy

exp



×
−
∆ˆθy)2
x + (¯θy −
ˆφ2
4



"



#





"

exp

2i ˆAy ¯θy ˆzo∆ˆθy
ˆAy + ˆDy
x + (¯θy + ∆ˆθy)2
ˆφ2
4

#

sinc
#

"

, (139)

∞

×

Z−∞

d ˆφxsinc

that is

exp

×

ˆDx + 4i ˆAx ¯θx ˆzo∆ˆθx

ˆG(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp
o∆ˆθ2
¯θ2
x + 4 ˆAx ˆz2
2( ˆAx + ˆDx)
x + (¯θy −
ˆφ2
4

d ˆφxsinc

∆ˆθy)2

x

"

"−
∞

×

Z−∞

i2
h

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
(cid:16)

exp

2 ˆAy ˆz2

(cid:17)i
o∆ˆθ2

y

−
#
h
x + (¯θy + ∆ˆθy)2
ˆφ2
4

#

i

sinc

#

"

. (140)

76

Finally, normalization according to Eq. (66) yields

exp

×

"−

∞

g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp
o∆ˆθ2

2 ˆAx ˆz2

i2
¯θx ˆzo∆ˆθx

h

x

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
(cid:16)

ˆDx + 2i ˆAx
ˆAx + ˆDx
x + (¯θy −
ˆφ2
4

∆ˆθy)2

exp

2 ˆAy ˆz2

(cid:17)i
o∆ˆθ2

y

−
h

#
x + (¯θy + ∆ˆθy)2
ˆφ2
4

"

i

#

sinc

#

d ˆφxsinc

"

×

Z−∞

d ˆφxsinc2

x + (¯θy −
ˆφ2
4

(

∆ˆθy)2

d ˆφxsinc2

x + (¯θy + ∆ˆθy)2
ˆφ2
4

(

∞

× 
Z−∞

∞

×
Z−∞


−1/2

)

−1/2

)


. (141)

|

|

g

is a function of both ¯θy and ∆θ, so that in this case we have
Obviously
neither weak quasi-homogeneity, neither wavefronts which can be described
by Schell’s model. However it should be noted that the integrals in Eq. (141)
do not contain any parametric dependence.

It is interesting to have some ﬁnal comment on Eq. (141). In the limit for
ˆNy ≪
1, we recover the case discussed in Section 4.1, the only diﬀerence
being that we did not set ˆθy1 = ˆθy2 = 0: in Section 4.1 we chose to deal
with a one-dimensional model putting ourselves on the horizontal plane. Now,
Eq. (141) allows to study the full two-dimensional situation in the limit for
o∆ˆθ2
2 ˆAy ˆz2
ˆNy ≪
y]
1. In this case we see that the exponential function exp [
can be neglected because we have a maximum value of ∆ˆθy ∼
1. As a result
we obtain:

−

g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

i2¯θx ˆzo∆ˆθx

exp

×

"−

2 ˆAx ˆz2

o∆ˆθ2

x

ˆDx + 2i ˆAx ¯θx ˆzo∆ˆθx
ˆAx + ˆDx

exp
#

i2¯θy ˆzo∆ˆθy
h

i

h
χ(¯θy, ∆ˆθy) , (142)
i

where

χ(¯θy, ∆ˆθy) =

d ˆφxsinc

x + (¯θy −
ˆφ2
4

"

∆ˆθy)2

x + (¯θy + ∆ˆθy)2
ˆφ2
4

#

sinc
#

"

∞

Z−∞

d ˆφxsinc2

x + (¯θy −
ˆφ2
4

(

∆ˆθy)2

d ˆφxsinc2

x + (¯θy + ∆ˆθy)2
ˆφ2
4

(

∞

× 
Z−∞

∞

×
Z−∞


−1/2

)

−1/2

)


. (143)

77

1
0.5
0
-0.5
-1
0
0

5

4

3
_

2

y axis

1
1

2
2

^

3
3
y axis

1

4
4

5 0

Fig. 25. Three-dimensional representation of χ as a function of ¯θy and ∆ˆθy.

It should be noted that Eq. (143) does not depend on parameters and is, in fact,
a universal function. Besides a geometrical factor exp [i2¯θy ˆzo∆ˆθy], the function
χ represents the spectral degree of coherence in the vertical direction, once the
horizontal coordinates are ﬁxed. The fact that it is a universal function means
that even in the case of zero vertical emittance we never have full coherence
in the vertical direction. On the one hand, this phenomenon can be seen to be
an inﬂuence of the presence of horizontal emittance on the vertical coherence
properties of the photon beam, as the integral in d ˆφx in χ comes from an
integration over the horizontal electron beam distribution. On the other hand,
being χ a universal function, the inﬂuence of the horizontal emittance on the
vertical coherence does not depend, in the limit for ˆNx ≫
1, on
the actual values of ˆNx and ˆDx. It is straightforward to see that χ is symmetric
with respect to ∆ˆθy and with respect to the exchange of ∆ˆθy with ¯θy. When
¯θy = 0, i.e. ˆθy1 =
ˆθy2, we obviously obtain χ(0, ∆ˆθy) = 1 that corresponds to
complete coherence. In Fig. 25 we plot the three-dimensional representation
of χ(¯θy, ∆ˆθy). In order to get a feeling for the behavior of χ we also plot, in
Fig. 26 and Fig. 27, two cuts of Fig. 25 illustrating, respectively, the behavior
of χ for a ﬁxed ¯θy = 0.5 (or ﬁxed ∆ˆθy = 0.5) and at ¯θy = ∆ˆθy.

1 and ˆDx ≫

−

As it is evident from Fig. 25, χ exhibits, for any ﬁxed value of ∆ˆθy, many
diﬀerent zeros in ¯θy. In Fig. 28 we illustrate some of these zeros as a function

78

D
q
c
q
Fig. 26. Plot χ(0.5, x), illustrating the cut of Fig. 25 at ¯θy = 0.5 (or ﬁxed ∆ˆθy = 0.5).
of ∆ˆθy, ¯θy,Z(∆ˆθy). The interest of this plot is that, once a certain distance
ˆzo∆ˆθy between two pinholes is ﬁxed, it illustrates at what position of the
pinhole system, ¯θy,Z, the spectral degree of coherence drops from unity to zero
for the ﬁrst time.

≫

It is interesting to compare Fig. 28, with the directivity diagram of the radiant
intensity IS(¯θy). This comparison is shown in Fig. 29. In the limit for ˆNy ≪
1
and ˆDy ≪
1, one may increase the degree of coherence of the beam by spatially
ﬁltering the radiation in the far ﬁeld. If a vertical slit is used with aperture d
ˆξcx, one would have
much larger than the horizontal coherence length, i.e. d
poor coherence. Decreasing the aperture of the slit will increase the coherence
of the X-ray beam up to some value d smaller than ˆξc. Within our assumption
1 one has the far ﬁeld approximation ˆξcx = (π/ ˆNx)1/2 ˆzo. When d
ˆNx ≫
becomes smaller and smaller with respect to (π/ ˆNx)1/2 ˆzo the spectral degree
of coherence g can be identiﬁed with the universal function χ, as once can see
by inspecting Eq. (142). As a result, as d becomes smaller one loses photons,
but the X-ray beam transverse coherence ceases to improve because, as is seen
in Fig. 29, the transverse degree of coherence g = χ drops to zero along the
vertical radiation pattern of the ﬁltered X-ray beam: for instance, from Fig.
29 one can see that χ drops to zero for the ﬁrst time at ∆ˆθ
2,
where the X-ray ﬂux is still intense. This behavior of the degree of coherence
should be taken into account at the stage of planning experiments. To give

1 ¯θy ∼

∼

79

Fig. 27. Plot χ(x, x), illustrating the cut of Fig. 25 at ¯θy = ∆ˆθy.

an example, after spatial ﬁltering, one may conduct a two-pinhole experiment
(like the one illustrated in Fig. 7) and ﬁnd, surprisingly, that for some vertical
position ¯θy of the pinholes (at ﬁxed ∆ˆθy) well within the radiation pattern
diagram he will have no fringes, but for some other vertical position he can
ﬁnd perfect visibility. So, without the knowledge of the function χ a user would
not even have the possibility to predict the outcomes of a simple two-pinhole
experiment.

From the deﬁnitions of χ, β, γ and IS it can be seen that all universal functions
introduced in this work are partial cases of the more generic

M(¯θy, ∆ˆθy) =

d ˆφxsinc

x + (¯θy −
ˆφ2
4

"

∆ˆθy)2

x + (¯θy + ∆ˆθy)2
ˆφ2
4

sinc

#

"

.(144)
#

∞

Z−∞

In fact

χ(¯θy, ∆ˆθy) =

M(¯θy, ∆ˆθy)

1/2

M(¯θy + ∆ˆθy, 0)
i
h

1/2

M(¯θy −

∆ˆθy, 0)
i

h

80

Fig. 28. Plot of ¯θy,Z as a function of ∆ˆθy. ¯θy,Z are some zeros of χ, i.e. some of the
values of ¯θy such that χ(∆ˆθy, ¯θy,Z) = 0.

IS(¯θy) = M(¯θy, 0)

β(∆ˆθy) =

dξM(ξ, ∆ˆθy)

1
2π2

∞

Z−∞

−

1
2π2

∞

Z−∞

γ(x) =

dξ exp[

i(2x)ξ]M(ξ, 0) . (145)

The knowledge of M is all one needs to calculate coherence properties out of
many experimental setups, in very practical situations. It is therefore worth
to tabulate M. We present a 3D plot of M, obtained from such tabulation, in
Fig. 30.

Finally, it is interesting to sum up and compare results for the far ﬁeld region
obtained in this Section (non-homogeneous undulator source) with results ob-
tained in Section 5. Many users performing coherent experiments with X-ray
beams are interested in the beam coherence properties in the far ﬁeld. We have
seen that in the most general situation for third generation light sources one
is interested in the case ˆNx ≫
1 and ˆDx ≫
1, which guarantees factorization
of results in the x and y direction, with arbitrary ˆNy and ˆDy. In this case we

81

Fig. 29. Comparison between some zeros of χ, ∆ˆθz(¯θy) (black circles), and the di-
rectivity diagram of undulator radiation in the vertical direction at very large hori-
1 and negligible vertical divergence ˆDy ≪
zontal electron beam divergence ˆDx ≫
1
(solid line).

will not have, in general, weakly quasi-homogeneous radiation in the vertical
direction. The spectral degree of coherence can be found by simplifying Eq.
(73) in the mathematical limit ˆzo −→ ∞

:

g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy

i2
h

"−

(cid:16)
(¯θy + ˆφy)2
2 ˆDy

(cid:17)i
M( ˆφy, ∆ˆθy)
#

2 ˆNx∆ˆθ2
x

exp

2 ˆNy∆ˆθ2
y

d ˆφy exp

exp

×

−
h

i

−

h

( ˆφy + ¯θy + ∆ˆθy)2
2 ˆDy
"−
( ˆφy + ¯θy −
2 ˆDy

∆ˆθy)2

"−

−1/2



−1/2


IS( ˆφy)
#

IS( ˆφy)
#






. (146)

We can see that for any value of ˆNy and ˆDy, in the far ﬁeld limit we obtain
a contribution to the cross-spectral density for the x and for the y direction.

∞

Z−∞
i

∞

d ˆφy exp

d ˆφy exp

× 
Z−∞

∞


× 


Z−∞



82

4

2

0

0
0

5

4

3
_

2

y axis

1
1

^

2
2
3
3
y axis

1

4
4

0

5

Fig. 30. Three-dimensional representation of M as a function of ¯θy and ∆ˆθy.

The contribution for the y direction can be expressed in terms of the product
of an exponential function and convolutions between the (Gaussian) electron
beam divergence and universal functions.

On the one hand, as ˆDy ≪

1 we have

g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

exp

2 ˆNx∆ˆθ2
x

−
h

×
On the other hand, as ˆDy ≫
and

i2
h
exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
2 ˆNy∆ˆθ2
(cid:16)
y
−
h

χ(¯θy, ∆ˆθy) . (147)
i

(cid:17)i

i

1 we have weakly quasi-homogeneous wavefronts

g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp
i2
2 ˆNx∆ˆθ2
h
x

exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
2 ˆNy∆ˆθ2
(cid:16)
exp
y

×

−

i
where β(∆ˆθy) is given in Eq. (116).

h

−
h

β(∆ˆθy) (148)
(cid:17)i
i

Moreover, as ˆNy ≫

1, and for arbitrary ˆDy we have:

83

D
q
M
q
g(ˆzo, ¯θx, ¯θy, ∆ˆθx, ∆ˆθy) = exp

¯θx ˆzo∆ˆθx + ¯θy ˆzo∆ˆθy
i2
2 ˆNy∆ˆθ2
2 ˆNx∆ˆθ2
h
(cid:16)

exp

x

y

i

−

h

(cid:17)i

. (149)

i

exp

×

−
h

It should be noted that Eq. (149) is simply a consequence of the application
of the VCZ theorem in both horizontal and vertical directions.

7 Application: Coherent X-ray beam expander scheme

In this Section we show how transverse coherence properties of an X-ray beam
can be manipulated to obtain a larger coherent spot-size on a sample.

q

The idea of increasing the horizontal width of the coherence spot is based
on the use of a downstream slit for selection of the transversely coherent
fraction of undulator radiation. Imagine a slit very close to the exit of the
undulator with an aperture d comparable with the coherent length of the
radiation at the exit of the undulator ˆξcx =
π/ ˆDx, as illustrated in Fig. 31.
The new radiation source after the slit is now coherent and characterized by
π/ ˆDx. In the far ﬁeld one
a horizontal dimension of the light spot equal to
can take advantage of the reciprocal width relations of Fourier transform pairs
or, equivalently, the expression for the Fraunhoﬀer diﬀraction pattern from a
slit, i.e. a sinc function, to calculate the magnitude of the coherence spot.
There is, of course, some arbitrary convention to agree upon when it comes to
the deﬁnition of the width of the sinc function but, numerical factors aside,
ˆDx ˆzo
this reasoning shows qualitatively that the coherence spot is of order
which is ˆǫx times larger than the spot size dimension in the case of free-
ˆNx. The radiation beyond the slit must be
space propagation, of order ˆzo/
then spectrally ﬁltered by a monochromator (not shown in Fig. 31) to further
narrow the spectral bandwidth. Here we assume that the radiation frequency
ω is equal to the fundamental frequency ωo. The radiation beyond the slit is
transversely coherent when the aperture d is equal (at most) to the coherence
length ξcx.

q

q

q

Let us present a numerical example illustrating the improvement of the hori-
zontal coherence length obtained by slit application. Let us consider the case
when the electron horizontal emittance is large ˆǫx ≫
1 and the vertical emit-
ˆDx. Since ˆNx = ˆǫx ˆβx and ˆDx = ˆǫx/ ˆβx, this
1, with ˆNx ≫
tance is small ˆǫy ≪
is the case, for instance when ˆβx ≃
10. Then, for ˆǫx = 100 we have ˆNx = 1000
and ˆDx = 10. This particular numerical example has been considered in Sec-
tion 4.1 to illustrate, in free space, the behavior of the coherence length as
a function of the position along the beamline, given in Eq. (64). Suppose we
install the slit at ˆzo = 2. From Eq. (64) we have ˆξcx|ˆzo=2

0.6.

π/ ˆDx ∼

∼ q

84

Fig. 31. Undulator radiation with a coherent X-ray beam expander.

∼ q

ˆDx ˆzo ∼

At ˆzo = 12 we have a situation close to the asymptotic behavior where the
ﬁeld diﬀracted by the slit can be treated in the Fraunhofer approximation and
ˆξcx|ˆzo=12
30. Comparison of the asymptotic behaviors after spatial
ﬁltering with respect to the free-space propagation case is given in Fig. 32.
Note that only the asymptotic behaviors near the slit and at large distance
ˆzo ≫
1 are plotted for the spatially ﬁltered radiation. What is important is, in
fact, the comparison between the coherent distance at large values of ˆzo with
and without spatial ﬁltering in the near zone.

This is an example in which evolution of transverse coherence through the
beam line plays an important role. In fact, the ability of spatially ﬁlter ra-
diation by a slit requires the knowledge of the transverse coherence length
variation along the beamline.

Let us calculate the number of coherent photons observed beyond the aperture.
In the region of parameters where ˆNx ≫
1, the number of
transversely coherent photons into the slit aperture d = ξcx can be calculated
as

1 and ˆDx ≫

In the near-zone limit the slit is positioned at a position down the beamline
zs ≃

βx so that, from Eq. (64) and Eq. (50) we have:

(Nph)coh =

dNph
dx

ξcx .

dNph
dx

=

Nph
2πσ2
x

q

85

(150)

(151)

(

z

)

c

o

10

 

1

0,1

0

1

2

3

4

5

6

7

8

9

10

11

12

z

o

Fig. 32. Behavior of the horizontal coherence length as a function of distance for
free space (dashed line) and comparison with asymptotic behaviors near the slit and
at large distances (solid lines).

and

ξcx = √π

λ
2πσx′

.

Therefore we can write

dNph
dx

ξcx = √π

λNph
(2π)3σ2

xσ2
x′

.

q

dNph
dx

=

Nph
2πz2

s σ2
x′

q

86

At the opposite extreme, with the distance zs much larger than βx we ﬁnd
that, always from Eq. (64) and Eq. (50)

(152)

(153)

(154)

and

ξcx = √π

λzs
2πσx

.

Therefore we can write

dNph
dx

ξcx = √π

λNph
(2π)3σ2

xσ2
x′

.

q

(155)

(156)

Thus, the number of transversely coherent photons into the slit aperture d =
ξcx will be independent of the distance zs. This means that operation of spatial
ﬁltering in the near ﬁeld region, as proposed by us, will not diminish the
number of coherent photons with respect to the usual practice in which spatial
ﬁltering to obtain coherent radiation is performed in the far ﬁeld: its eﬀect will
only be that of increasing the horizontal dimension of the coherent spot size.
This possibility to create transversely coherent radiation with large divergence
in the horizontal direction is important for many experiments. The distance
of the slit from the exit of the undulator sets a limit to achievable linear
dimension of coherence area. If we build a coherent X-ray beam line, we want
to have large linear dimension of coherence area at the specimen position.
Therefore, in order to have a largest linear dimension of coherence area at the
σx′zo we must have a slit aperture of at most of
specimen position ξcx(zo)
βx. In order not
λ/(2πσx′) installed in the near zone at zs ≃
the size d
to loose coherent photons instead, the slit aperture must be at least of the
size d
λ/(2πσx′). The right compromise is thus a slit aperture of the size
d

λ/(2πσx′) installed in the near zone at zs ≃

βx.

≃

≃

≃

≃

8 Conclusions

Before this work, no satisfactory theory describing spatial coherence from
undulator radiation sources has been built. In this paper we developed such
a theory of transverse coherence dealing with X-ray beams, with particular
attention to third generation light sources.

First we studied Synchrotron Radiation as a random statistical process using
the language of Statistical Optics. Statistical Optics developed around Gaus-
sian, stationary processes characterized by quasi-homogeneous sources; under
these assumptions, the characterization of statistical properties of the process
are greatly simpliﬁed and the van Cittert-Zernike theorem (or its generalized
version) can be used in order to describe the X-ray beam partial coherence
properties in the far ﬁeld region. However, for Synchrotron Radiation, there
is no a priori reason to hold these assumptions satisﬁed.

87

We showed that Synchrotron Radiation is a Gaussian random process. As a
result, statistical properties of Synchrotron Radiation are described satisfac-
tory by second-order ﬁeld correlation functions. We used a frequency domain
analysis to describe them from a mathematical viewpoint. This choice is very
natural. In fact, up-to-date detectors are limited to about 100 ps time reso-
lution: therefore, in real-life experiments with third generation light sources,
detectors are by no means able to resolve a single X-ray pulse in time domain
and work, instead, by counting the number of photons at a certain frequency
over an integration time longer than the radiation pulse. As a consequence
of the frequency domain analysis we could study the spatial correlation for a
given frequency content using the cross-spectral density of the system which,
independently of the spectral correlation function, can be used to extract use-
ful information even if the process is not stationary.

We gave an expression for the process cross-spectral density dependent on
six dimensionless parameters. Subsequently we tuned parameters at perfect
resonance, thus obtaining a simpliﬁed expression.

First we studied the limit of applicability of the quasi-homogeneous model
from an analytical viewpoint, within the framework of simplifying assump-
tions, namely in the limit of small electron beam divergence and Fresnel num-
ber in the vertical direction, of large electron beam divergence and Fresnel
number in the horizontal direction, and performing calculations for the cross-
spectral density on the horizontal plane only. This simpliﬁed study allowed us
to introduce the concept of weakly quasi-homogeneous radiation and virtual
quasi-homogeneous source while discussing the applicability region of the VCZ
theorem.

Second, we studied the eﬀect of the vertical emittance on the cross-spectral
density. This study led us to analyze both cases in which the sources are
weakly quasi-homogeneous and cases when they are not quasi-homogeneous
at all. In the limit for large horizontal beam divergence and Fresnel number,
which is always satisﬁed for third generation light sources, we found that the
spectral degree of coherence factorizes in the product of factors depending
separately on the horizontal and on the vertical coordinates. In the far ﬁeld
limit the vertical part of the spectral degree of coherence can be expressed in
terms of the product of an exponential function (which, alone, would simply
satisfy the VCZ theorem) and convolutions between the electron beam diver-
gence in the vertical direction and a universal functions, that we introduced
in our work. The universality of such a function implied that even for zero
vertical emittance we never have full coherence in the vertical direction. This
unexpected result is due to the inﬂuence of the horizontal emittance on the
vertical coherence properties of the photon beam. Because of this, the degree
of coherence changes between zero and unity within the diﬀraction angle. We
also studied the near ﬁeld zone. When one is interested in the evolution of the

88

degree of coherence along the beamline back up to the exit of the undulator
the situation becomes much more complicated with respect to the far zone
case, as the observation distance is one of the problem parameters. There are
many more asymptotic situations which can be studied, and a large part of
our paper is devoted to the calculation of these asymptotic situations. We
provided approximate estimations for the vertical coherence length that are
valid from the far zone and back, up to the exit of the undulator in the case
when either the vertical Fresnel number or the vertical electron beam diver-
gence are much larger than unity. These can be used at the stage of planning
experiments.

It should be noted that, throughout this work, we did not discuss the accuracy
of the approximation of small and large parameters. In order to do so, one
needs to develop a perturbation theory for each asymptotic case studied here,
which would considerably increase the size of this paper. As a result we leave
this issue for future work.

Finally, we selected an application to show the power of our approach. We
discussed how the transverse coherence properties of an X-ray beam can be
manipulated to obtain a convenient coherent spot-size on the sample with the
help of a simple vertical slit; this invention was predicted almost entirely on
the basis of theoretical ideas of rather complex and abstract nature discussed
in the previous parts of the paper.

89

Appendix A: Random phasor sum

The ﬁeld of thermal light can be regarded as a sum of a great many indepen-
dent contributions. The complex envelope of polarized thermal light at ﬁxed
time and a ﬁxed point in space is a sum of a very large number of complex
phasors

E(~r, t) =

αkeiψk ,

N

Xk=1

(157)

where N is the number of radiating atoms. Statistical properties of elementary
phasors that are generally satisﬁed in thermal light problems of interest are
as follows:

a) The amplitudes αk = Re(αk) and the phases ψk are statistically indepen-
dent of each other and of the amplitudes and phases of all other elementary
phases for diﬀerent values of k.

b) The random variables αk are identically distributed for all k with mean
value < α > and second moment < α2 >.

c) The phases ψk are uniformly distributed over the interval (0, 2π).

The reader can ﬁnd in [5] that when assumptions from a) to c) are satisﬁed,
the real (Re(E)) and imaginary (Im(E)) parts of the ﬁeld are distributed in
accordance with the Gaussian law in the limit for N

, so that

−→ ∞

[Re(E)]2

=

D

E

D

p(Re(E), Im(E)) =

1
2πσ2 exp

"−

Re(E)

h
i
[Im(E)]2

=

h
= h

Im(E)
α2
2

i

i

= 0 ,

N = σ2 ,
= 0 ,

E

Re(E)Im(E)
h
[Re(E)]2 + [Im(E)]2
2σ2

i

#

, (158)

where p(Re(E), Im(E)) is the joint probability density function.

In Section 2.1 we discussed statistical properties of Synchrotron Radiation and
we were led to assumptions 1), 2) and 3) which are weaker than a), b) and c).
Here we will demonstrate that assumptions from a) to c) can be relaxed to
assumptions from 1) to 3) without changes in results. We will derive results
valid when the amplitudes αk are complex αk =

exp (iφk).

αk|

|

After denoting with r and i the real and imaginary parts of the ﬁelds and
with ¯Q we ﬁrst demonstrate that ¯r = ¯i = 0.
after substituting notation

Q
i

h

90

We have straightforwardly

¯r =

¯i =

1
N

1
N

N

Xk=1  |

N

Xk=1  |

αk |

αk |

cos φk cos ψk − |

αk |

sin φk sin ψk

= 0 ,

cos φk sin ψk +

sin φk cos ψk

= 0 , (159)

αk |

|

!

!

because all averages over trigonometric functions are zero.

Second, we demonstrate that r2 = i2 = α2/2. Again, direct calculation shows

N

¯r2 =

1
N

Xk,n=1  |
+

αk ||
αk ||
|
αk ||
−|
αk ||

αn |
αn |
αn |
αn |

−|
1
2N

N

=

2

αk |

cos φk cos φn cos ψk cos ψn

sin φk sin φn sin ψk sin ψn
cos φk sin φn cos ψk sin ψn

sin φk cos φn sin ψk sin ψn

cos2 ψk + sin2 ψk

=

. (160)

!

α2
2

(cid:17)

Xk=1 |
Moreover it is easy to see that i2 = r2.

(cid:16)

Finally, we show that ri = 0. In fact

N

ri =

1
N

cos φk cos φn cos ψk sin ψn

cos φk sin φn cos ψk cos ψn
sin φk cos φn sin ψk sin ψn

sin φk sin φn sin ψk cos ψn

!

αn |
αk ||
Xk,n=1  |
αn |
αk ||
+
|
αn |
αk ||
−|
αk ||
αn |
2 (cos φk sin φk −

−|
αk|

Xk |

sin φk cos φk) = 0 . (161)

=

1
2N

As a result we have that real and imaginary parts have zero means, equal
variances and are uncorrelated. Use of the central limit theorem allows to
conclude that the resulting phasor sum is a circular complex Gaussian random
variable.

91

Appendix B: A useful transformation of the expression for the un-
dulator radiation ﬁeld

We start reporting here, for convenience, Eq. (24), that represents the ﬁeld
(in normalized units) produced by a particle with oﬀset and deﬂection at any
distance ˆzo > 1/2 from the exit of the undulator, where the undulator center
is taken at ˆzo = 0:

ˆEs⊥ = ˆzo

1/2

Z−1/2

dˆz′

1
ˆzo −

ˆz′ exp 



i 









ˆC +

ˆz′ + (cid:18)

2

~ˆη
2 


~ˆl
~ˆr⊥o −
−
2(ˆzo −

~ˆηˆz′

ˆz′)

2

(cid:19)









.(162)



In this Appendix we show that ˆEs⊥ as reported in Eq. (162) may be described
as

ˆEs⊥ =

1/2

Z−1/2

ˆzodˆz′
ˆzo −

ˆz′ exp 


i 

ΦU + ˆC ˆz′ +






~ˆl
ˆzo −

−

ˆzo ˆz′
2(ˆzo −

~ˆθ
ˆz′) 



2

~ˆη













(163)

where ΦU is given by

ΦU =



 



2

ˆlx
ˆzo !

ˆθx −

+

ˆθy −

 

2

ˆly
ˆzo !

ˆzo
2

.





This means that ˆEs⊥ is of the form

(164)

ˆEs⊥

~ˆθ

ˆC, ˆzo,
(cid:18)

−

~ˆl/ˆzo)
(

~ˆη
(cid:19)

−

= exp(iΦU )S

~ˆθ

ˆC, ˆzo,
(cid:18)

−

~ˆl/ˆzo)
(

~ˆη
(cid:19)

−

.

(165)

~ˆl and
Let us introduce in this Appendix, for simplicity of notation,
~ˆφ = ~ξ/ˆzo. It is easy to rewrite the phase in the integrand of Eq. (162), which
we denote with ΦT as

~ˆξ = ~ˆr⊥o −

ΦT = ˆC ˆz′ +

ˆz′ +

2

~ˆη
2

ˆzo −

~ˆφ
2

·

~ˆηˆz′ +

2

~ˆφ


1
2 






2
~ˆη

ˆz′2
ˆzo 


1 +
"

n

ˆz′
ˆzo !

∞

Xn=1  

.(166)

#




Further algebraic manipulation of Eq. (166) yields

92

ΦT = ˆC ˆz′ +

2

~ˆφ

ˆzo
2

+

ˆz′
~ˆφ
2 (cid:18)
~ˆφ
+

2

−

ˆzo

~ˆη
(cid:19)
∞

2

+

1
2 

n
ˆz′

ˆzo !

Xn=2  

2
~ˆη

ˆz′2
ˆzo

+

2
~ˆη

ˆz′2
ˆzo

∞

~ˆφ
2

~ˆηˆz′

−

·

n

ˆz′
ˆzo !
n

∞

Xn=1  
ˆz′
ˆzo !

Xn=1  

. (167)

)

It is easy to recognize ΦU in the second term on the right hand side of Eq.
(167). Furthermore, the fourth term on the right hand side of Eq. (167) can
be further manipulated, leading to

+

1
2 (

ˆzo

2

~ˆφ
 

2
+ ~ˆη

∞

!

Xn=2  

ˆz′
~ˆφ
ΦT = ˆC ˆz′ + ΦU +
2 (cid:18)
∞
ˆz′
ˆz′
ˆzo !
ˆzo !

~ˆηˆzo

~ˆφ
2

−

n

·

2

~ˆη
−
(cid:19)
n

)

Xn=2  

, (168)

ΦT = ˆC ˆz′ + ΦU +

ˆz′
~ˆφ
2 (cid:18)

~ˆη
(cid:19)

−

2

+

ˆzo
~ˆφ
2 ((cid:18)

~ˆη
(cid:19)

−

2 ∞

Xn=2  

n

ˆz′
ˆzo !

)

that is

or

ΦT = ˆC ˆz′ + ΦU +

ˆzoˆz′
2(ˆzo −

2

~ˆφ
ˆz′) (cid:18)

~ˆη
(cid:19)

−

Therefore, since

~ˆφ

~ˆη =

~ˆθ

−

−

~ˆl
ˆzo −

~ˆη

we have

(169)

(170)

(171)

ˆEs⊥ =

1/2

Z−1/2

ˆzodˆz′
ˆzo −

ˆz′ exp 


i 

ΦU + ˆC ˆz′ +






~ˆl
ˆzo −

−

ˆzo ˆz′
2(ˆzo −

~ˆθ
ˆz′) 



2

~ˆη













(172)

that is Eq. (163), quantum erat demonstrandum.

93

Appendix C: Autocorrelation function for undulator sources

In this Appendix we demonstrate the validity of Eq. (114). Having deﬁned

˜f (ˆzo, ∆ˆθy) =

1
2π2

∞

∞

d ˆφy

d ˆφxS∗

Z−∞

Z−∞

ˆzo, ˆφ2
h

x + ( ˆφy −

∆ˆθy)2

S
i

ˆzo, ˆφ2
h

x + ( ˆφy + ∆ˆθy)2

, (173)

i

and

β(∆ˆθy) =

d ˆφy

d ˆφxsinc

1
2π2

∞

∞

Z−∞

Z−∞

x + ( ˆφy −
ˆφ2
4

"

∆ˆθy)2

x + ( ˆφy + ∆ˆθy)2
ˆφ2
4

#

sinc

#

"

, (174)

we have want to demonstrate that Eq. (114) holds, that is

˜f (ˆzo, ∆ˆθy) = β(∆ˆθy) .

(175)

The proof is based on the autocorrelation theorem, which states that if the
(two-dimensional) Fourier Transform of a function w(x, y) with respect to
variables αx and αy is indicated by ¯w(αx, αy), then the Fourier transform of
the two-dimensional autocorrelation function of w(x, y) with respect to the
2. In formulas, after deﬁnition
same variables αx and αy is given by
of the autocorrelation function

¯w(αx, αy)

|

|

[w](x, y) =

dη

dξw(η + x, ξ + y)w∗(η, ξ) ,

(176)

A

A

∞

∞

Z−∞

Z−∞

∞

∞

Z−∞

Z−∞

which is equivalent to

[w](x, y) =

dη

dξw(η + x/2, ξ + y/2)w∗(η

x/2, ξ

y/2) , (177)

−

−

the autocorrelation theorem states that

∞

∞

Z−∞

Z−∞

dx

dy exp [i(αxx + αyy)]

[w](x, y) =

¯w(αx, αy)

(178)

A

|

2 .

|

First we extend the deﬁnition of ˜f

94

˜f (ˆzo, ∆ˆθ′

x, ∆ˆθ′

y) =

∞

∞

d ˆφy

d ˆφxS∗

1
2π2

Z−∞

ˆzo, ( ˆφx −

∆ˆθ′

x/2)2 + ( ˆφy −
y/2)2

x/2)2 + ( ˆφy + ∆ˆθ′

h
ˆzo, ( ˆφx + ∆ˆθ′

∆ˆθ′

y/2)2

i

(179)

,

i

Z−∞
S

×

h

where we changed variables from ∆ˆθx,y to ∆ˆθ′
x,y = 2∆ˆθx,y Then we can apply
the autocorrelation theorem in Eq. (178) to the function ˜f thus obtaining the
following relation:

d∆ˆθ′
x

d∆ˆθ′

y exp [i(αx∆ˆθ′

x + αy∆ˆθ′

y)] ˜f (ˆzo, ∆ˆθ′

x, ∆ˆθ′
y)

∞

∞

Z−∞

Z−∞

=

∞

1
2π2 (cid:12)
(cid:12)
Z−∞
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∞

Z−∞

d ˆφx

d ˆφy exp [i(αx ˆφx + αy ˆφy)]S

x + ˆφ2

y

ˆzo, ˆφ2
h

, (180)

where αx,y are now conjugated variables with respect to the angles ˆφx,y on
which S depends. We will denote with ¯S the two-dimensional Fourier Trans-
form of S, that is:

2

(cid:12)
(cid:12)
i
(cid:12)
(cid:12)
(cid:12)
(cid:12)

¯S(αx, αy) =

d ˆφx

d ˆφy exp [i(αx ˆφx + αy ˆφy)]S

x + ˆφ2

y

.

ˆzo, ˆφ2
h

i

(181)

The relation between the function S and the undulator ﬁeld is given by Eq.
(31), and one has

∞

∞

Z−∞

Z−∞

∞

∞

Z−∞

Z−∞

¯S(αx, αy) =

d ˆφx

d ˆφy exp [i(αx

ˆφx + αy

ˆφy)] exp [

i( ˆφ2

x + ˆφ2

y)ˆzo/2]

−
ˆEs⊥

×

x + ˆφ2

y

ˆzo, ˆφ2
h

i

. (182)

After deﬁnition of ¯αx,y = αx,y/ˆzo one can write ¯S, as a function of ¯αx,y instead
of αx,y. Then, one can switch to the new integration variables ˆx = ˆφxˆzo and
ˆy = ˆφy ˆzo to obtain:

¯S( ¯αx, ¯αy) =

dˆx

dˆy exp [i( ¯αx ˆx + ¯αy ˆy)] exp [

i(ˆx2 + ˆy2)/(2ˆzo)]

1
ˆz2
o

∞

∞

Z−∞

Z−∞

−
ˆEs⊥

×

ˆzo, ˆx2 + ˆy2
h

i

.

(183)

where the expression for ˆEs⊥[ˆzo, ˆx2 + ˆy2] is given in Eq. (24). Now we have to
calculate the Fourier transform of the product of two factors: exp [

i(ˆx2 + ˆy2)/(2ˆzo)]

−

95

and ˆE⊥s. Let us look for the Fourier transform of each factor.

A direct calculation shows that

∞

∞

Z−∞

Z−∞

dˆx

dˆy exp [i( ¯αx ˆx + ¯αy ˆy)] ˆEs⊥

ˆzo, ˆx2 + ˆy2
(cid:16)

(cid:17)

= 2iπˆzo exp

y)ˆzo

( ¯α2

x + ¯α2
2

i
"−

sinc
#

"

x + ¯α2
¯α2
y
4

#

. (184)

Second, let us deal with the Fourier transform of exp [

i(ˆx2 + ˆy2)/(2ˆzo)]:

−

∞

∞

Z−∞

Z−∞

dˆx

dˆy exp [i( ¯αx ˆx + ¯αy ˆy)] exp [

i(ˆx2 + ˆy2)/(2ˆzo)]

−

4iˆzo exp [i( ¯α2

x + ¯α2

y)ˆzo/2] . (185)

=

−

Since the Fourier transform of a product is equal to the convolution of the
Fourier transforms of the factors we have

¯S( ¯αx, ¯αy) = 8π

du

dw exp

∞

∞

Z−∞

Z−∞

exp [

−

×

{

i[( ¯αx −

u)2 + ( ¯αy −
i(u2 + w2)ˆzo/2]sinc[(u2 + w2)/4] . (186)

w)2]ˆzo/2

}

and therefore we have

∞

∞

|

= 8π

¯S( ¯αx, ¯αy)

(cid:12)
(cid:12)
Z−∞
(cid:12)
(cid:12)
(cid:12)
Going back to old variables αx,y we obtain
(cid:12)

dw exp [i( ¯αxu + ¯αyw)ˆzo]sinc[(u2 + w2)/4]
.(187)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Z−∞

du

|

¯S(αx, αy)

= 8π

|

|

∞

∞

du

Z−∞

(cid:12)
(cid:12)
Z−∞
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dw exp [i(αxu + αyw)]sinc[(u2 + w2)/4]
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.(188)

which is independent of ˆzo. As a result Eq. (180) is also independent on ˆzo,
i.e. the Fourier transform of ˜f is independent of ˆzo.

the function ˜f transforms
Now, on the one hand in the limit for ˆzo −→ ∞
into β, because the S functions in ˜f tend asymptotically to the sinc functions
in β. On the other hand, if the Fourier transform of ˜f is independent of ˆzo,
also ˜f is independent of ˆzo. As a result it can only be ˜f (∆ˆθ′
y), and
˜f (∆ˆθy) = β(∆ˆθy) that is Eq. (175) holds, quantum erat demonstrandum.

y) = β(∆ˆθ′

96

Note that, based on the autocorrelation theorem, it is also possible to give
an analytic expression for the Fourier transform of β. After deﬁnition of β =
β(ˆzo, ∆ˆθ′
y) as in Eq. (179), application of the autocorrelation theorem
simply states that the two-dimensional Fourier Transform of β, that will be
indicated with ¯β can be written as

x, ∆ˆθ′

¯β(αx, αy) =

d ˆφx

d ˆφy exp [i(αx

ˆφx + αy

ˆφy)]sinc

.(189)

x + ˆφ2
ˆφ2
4

y





2





(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∞

Z−∞

∞

1
2π2 (cid:12)
(cid:12)
Z−∞
(cid:12)
(cid:12)
(cid:12)
(cid:12)
x +α2

Introducing α2 = α2
form of β in terms of Fourier-Bessel transform we obtain

y and representing the two-dimensional Fourier Trans-

∞

2π

¯β(α) =

dr rJ0(rα)sinc

r2
4 !(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
where Si indicates the sine integral function.

1
2π2 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

 

Z0

2

= 2

π
h

−

2Si(α2)

2

,

i

(190)

Finally, one can get back a simpler representation of the function β in terms of
a one-dimensional integration simply performing an anti Fourier-Bessel trans-
form:

β(∆ˆθ′) =

dα αJ0(α∆ˆθ′) ¯β(α) ,

1
2π

∞

Z0

where ∆ˆθ

′2
′2
′2 = ∆ˆθ
y . For ∆ˆθx = 0 we obtain
x + ∆ˆθ

β(∆ˆθy) =

∞

1
π

Z0

dα αJ0

α

 

∆ˆθy
2 !

π

h

−

2Si(α2)

2

.

i

(191)

(192)

97

Acknowledgements

The authors wish to thank Hermann Franz, Petr Ilinski and Ivan Vartanyants
for many useful discussions, Jochen Schneider and Edgar Weckert for their
interest in this work.

References

[1] PETRA III Technical Design Report, ISSN 0418-9833, edited by K.

Balewski et al., DESY, Hamburg (2004)

[2] C. Chang, P. Naulleau et al., Appied Optics, 14 (2003)
[3] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, Paraxial Green’s
functions in Synchrotron Radiation theory, DESY 05-032, ISSN 0418-9833
(2005)

[4] Y. Takatama et al., Nucl. Instr. Meth. in Phys. Res. A 441, 565 (2000)
[5] J. W. Goodman, Statistical Optics, John Wiley & Sons, Inc., 1985
[6] L. Mandel and E. Wolf, Optical Coherence and Quantum Optics, Cam-

[7] D. Attwood, Soft X-rays and extreme ultraviolet radiation, Cambridge

bridge University Press, 1995

University Press, 1999

[8] M. Yabashi, K. Tamasku et al., Phys. Rev. Lett., 88, 24 (2000)
[9] E. Wolf, Nature, 172, 535 (1953)
[10] E. O’Neill, Introduction to Statistical Optics, Dover Publications Inc.,

Mineola, New York (1991)

98

