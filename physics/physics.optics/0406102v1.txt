4
0
0
2
 
n
u
J
 
3
2
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
2
0
1
6
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Methods for 3-D vetor miroavity

problems involving a planar

dieletri mirror

David H. Foster and Jens U. Nökel

Department of Physis

University of Oregon

Eugene, OR 97403

http://darkwing.uoregon.edu/~noekel

Published in Opt. Commun. 234, 351-383 (2004)

We develop and demonstrate two numerial methods for solving the lass

of open avity problems whih involve a urved, ylindrially symmetri on-

duting mirror faing a planar dieletri stak. Suh dome-shaped avities

are useful due to their tight fousing of light onto the (cid:29)at surfae. The (cid:28)rst

method uses the Bessel wave basis. From this method evolves a two-basis

method, whih ultimately uses a multipole basis. Eah method is developed

for both the salar (cid:28)eld and the eletromagneti vetor (cid:28)eld and expliit

(cid:16)end user(cid:17) formulas are given. All of these methods haraterize the ar-

bitrary dieletri stak mirror entirely by its 2 × 2 transfer matries for s-

and p-polarization. We explain both theoretial and pratial limitations to

our method. Non-trivial demonstrations are gi ven, inluding one of a stak-

indued e(cid:27)et (the mixing of near-degenerate Laguerre-Gaussian modes) that

may persist arbitrarily far into the paraxial limit. Cavities as large as 50λ

are treated, far exeeding any vetorial solutions previously reported.

Contents

1. Introdution

3

2. Overview of the Model and Notation

5

1

3. Plane Wave Bases and the Bessel Wave Method

8

3.1. The Field Expansion in the Simple Plane Wave Bases . . . . . . . . . . .

8

3.1.1. Salar basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

3.1.2. Vetor basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10

3.2. The Field Expansion in the Bessel Wave Bases . . . . . . . . . . . . . . .

12

3.2.1. Salar basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12

3.2.2. Vetor basis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

14

3.3. The Linear System of Equations for the PWB . . . . . . . . . . . . . . .

16

3.3.1. The planar mirror (M1) boundary equations . . . . . . . . . . . .

16

3.3.2. The urved mirror (M2) boundary equations

. . . . . . . . . . .

17

3.3.3. The seed equation . . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.3.4. Solution of Ay=b . . . . . . . . . . . . . . . . . . . . . . . . . . .

19

3.3.5. Calulating the (cid:28)eld from y . . . . . . . . . . . . . . . . . . . . .

19

4. Multipole Bases and the Two-Basis Method

20

4.1. The Salar Multipole Basis . . . . . . . . . . . . . . . . . . . . . . . . . .

21

4.2. The M1 Equations in the Salar MB . . . . . . . . . . . . . . . . . . . .

21

4.2.1. Variant 1

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

22

4.2.2. Variant 2

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

22

4.3. The Linear System of Equations in the Salar MB . . . . . . . . . . . . .

23

4.4. Calulating the Field in the Layers with the Salar MB . . . . . . . . . .

24

4.5. The Vetor Multipole Basis

. . . . . . . . . . . . . . . . . . . . . . . . .

24

4.6. The M1 Equations in the Vetor MB . . . . . . . . . . . . . . . . . . . .

25

4.6.1. The M1 equations for s-polarization . . . . . . . . . . . . . . . . .

27

4.6.2. The M1 equations for p-polarization . . . . . . . . . . . . . . . .

27

4.6.3. Variant 1

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

28

4.6.4. Variant 2

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

28

4.7. The Linear System of Equations in the Vetor MB . . . . . . . . . . . . .

29

4.8. Calulating the Field in the Layers with the Vetor MB . . . . . . . . . .

30

5. Demonstrations and Comparisons

30

5.1. The (cid:16)V(cid:17) Mode: A Stak E(cid:27)et

. . . . . . . . . . . . . . . . . . . . . . .

30

5.2. Persistent Stak-Indued Mixing of Near-Degenerate Laguerre-Gaussian Mode Pairs 32

5.2.1. Paraxial Theory for Vetor Fields . . . . . . . . . . . . . . . . . .

34

5.2.2. A demonstration of persistent mixing . . . . . . . . . . . . . . . .

36

5.3. Modes with m 6= 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4. Ndirs

and lmax

: Comparing the Two Primary Methods . . . . . . . . . . .

37

39

5.5. Almost-Real MB Coe(cid:30)ients . . . . . . . . . . . . . . . . . . . . . . . . .

43

6. Conlusions

43

A. Further Explanations and Limitations of the Model

45

A.1. Exlusion of High-Angle Plane Waves

. . . . . . . . . . . . . . . . . . .

45

A.2. The Hat Brim . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

45

2

A.2.1. The in(cid:28)nitesimal hat brim . . . . . . . . . . . . . . . . . . . . . .

45

A.2.2. The in(cid:28)nite hat brim and the 1-D half-plane avity . . . . . . . .

46

B. Negative m Modes and Sine and Cosine Modes

47

B.1. Plotting with -m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

48

B.2. Plotting osine and sine modes

. . . . . . . . . . . . . . . . . . . . . . .

48

C. Staks used in Setion 5

49

1. Introdution

There is urrently onsiderable interest in the nature of eletromagneti (vetor) modes

both for free spae propagation [1, 2, 3, 4℄ and in avity resonators [5℄. In partiular,

reent advanes in fabriation tehnology have given rise to optial avities whih annot

be modeled by e(cid:27)etively two-dimensional, salar or pseudo-vetorial wave equations [6℄.

The resulting modes may exhibit non-paraxial struture and nontrivial polarization, but

this added omplexity also gives rise to desirable e(cid:27)ets; an example from free-spae

optis is the observation of enhaned fousing for radially polarized beams [4℄. This

e(cid:27)et is shown here to arise in avities as well, among a rih variety of other modes that

depend on the three-dimensional geometry. The main goal of this paper is to present a

set of numerial tehniques adapted to a realisti avity design as desribed below.

Muh work involving optial avity resonators utilizes mirrors that are omposed of

thin layers of dieletri material. These dieletri stak mirrors o(cid:27)er both high re(cid:29)etivity

and a low ratio of loss to transmission, whih are desirable in many appliations. The

simplest model of suh avities treats the mirrors as perfet ondutors (Etangential =
0, Hnormal = 0). In appliations involving paraxial modes and highly re(cid:29)etive mirrors,

it is often aeptable to use this treatment. The mature theory of Gaussian modes (.f.

Siegman [7℄) is appliable for this lass of avity resonator. When an appliation requires

going beyond the paraxial approximation to desribe the optial modes of interest, the

problem beomes signi(cid:28)antly more involved and modeling dieletri stak mirrors as

onduting mirrors may beome a poor approximation. Also, one is often interested in

the (cid:28)eld inside the dieletri stak and for this reason must inlude the stak struture

into the problem.

In this paper we present a group of improved methods for resonators with a ylin-

drially symmetri urved mirror faing a planar mirror. The paraxial ondition is not

neessary for these methods; tightly foused modes an be studied. Furthermore, the

true vetor eletromagneti (cid:28)eld is used, rather than a salar (cid:28)eld approximation. The

planar mirror is treated as in(cid:28)nite and is haraterized by its polarization-dependent

re(cid:29)etion funtions rs(θin) and rp(θin) for plane waves with inident angle θin

. Our

model enompasses both avities for whih the planar mirror is an arbitrary dieletri

stak, and avities for whih the planar mirror is a simple mirror (onduting with

rs/p(θin) = −1 or (cid:16)free(cid:17) with rs/p(θin) = +1). The opposing urved mirror is always

treated as a ondutor. It should be noted that, for most modes whih are highly fo-

3

used at the planar mirror, (modes whih are likely to be of interest in appliations),

this limitation an be expeted to ause little error beause the loal wave fronts at the

urved mirror are mostly perpendiular to its surfae. (Of ourse, for appliations in

whih the urved mirror is indeed onduting, our model is very well suited.) On the

other hand, the orret treatment of the planar mirror an be a great improvement over

the simplest model. Appliations with both dieletri and onduting urved mirrors

have been and are urrently being used experimentally [5, 8, 9℄.

The methods desribed here belong to a lass of methods whih we refer to as (cid:16)basis

expansion methods(cid:17). In basis expansion methods, a omplete, orthogonal basis (suh

as the basis of eletromagneti plane waves) is hosen. Eah basis funtion itself obeys

Maxwell's equations. The equations that determine the orret value of the basis oef-

(cid:28)ients are boundary equations, resulting from mathing appropriate (cid:28)elds at dieletri

interfaes, setting appropriate (cid:28)eld omponents to zero at ondutor-dieletri interfaes,

and setting ertain (cid:28)elds to be zero at the origin or in(cid:28)nity. In the usual appliation of

this method, eah homogenous dieletri region is alloated its own set of basis oe(cid:30)-

ients. Our methods use a single set of basis oe(cid:30)ients; the mathing between dieletri

layers is handled by the 2 × 2 transfer matries of the stak.

As dieletri staks have nonzero transmission, optial avities with this type of mirror

are neessarily open, or lossy. The methods desribed here deal with the openness due to

the stak and the solutions are quasimodes, with disrete, isolated omplex wavenumbers

whih denote both the optimal driving frequeny and the resonane width

. While

1

the dieletri mirror is partially responsible for the openness of our model system, the

openness is not primarily responsible for mode pattern hanges resulting from replaing

a dieletri stak mirror with a simple mirror. The phase shifts of plane waves re(cid:29)eted

o(cid:27) a dieletri stak an vary with inident angle, and it is this variation whih an

ause signi(cid:28)ant hanges in the modes, even though re(cid:29)etivities may be greater than

0.99. Generally speaking, the deviation of |rs/p(θin)| from 1 is not as important as the
deviation of arg(rs/p(θin)) from, say, arg(rs/p(0)).

We develop two general methods, the two-basis method and the Bessel wave method.

The salar (cid:28)eld versions of both methods are also developed and are disussed (cid:28)rst, ating

as pedagogial stepping stones to the vetor (cid:28)eld versions. The Bessel wave method uses

the Bessel wave basis whih is the ylindrially symmetri version of the plane wave basis.

This method is desribed in Setion 3. The two-basis method ultimately uses the vetor

or salar multipole basis. The multipole basis has an advantage in that it is the eigenbasis

of a onduting hemisphere, the (cid:16)anonial(cid:17) dome-shaped avity. The unusual aspet of

the two-basis method is the intermediate use of the Bessel wave basis. The two-basis

method is developed in Setion 4. We have implemented both methods and have used

them as numerial heks against eah other. Various demonstrations and omparisons

1

For many modes, there is also loss due to lateral esape from the sides of the avity. While our

model intrinsially inorporates the openness due to lateral esape in the alulation of the (cid:28)elds

(by simply not losing the urved mirror surfae, or extending its edge into the dieletri stak),

this loss is not inluded in the alulated resonane width or quality fator, Q. Beause a single set

of basis vetors is used to desribe the (cid:28)eld in the half-plane above the planar mirror, this entire

half-plane is the (cid:16)avity(cid:17) as far as the alulation of resonane width is onerned.

4

are given in Setion 5. Our implementations of all methods are programmed in C++, use

the GSL, LAPACK, SLATEC, and PGPlot numerial libraries, and run on a Maintosh

G4 with OS X. Limitations of our model and methods are disussed in Appendix A.

Appendix B disusses plotting modes that are assoiated with linear polarization and

Appendix C spei(cid:28)es dieletri staks that are used in Setion 5.

2. Overview of the Model and Notation

Figure 1: The avity model.

A diagram of the model is shown in Figure 1. The onduting surfae is indiated

by the heavy line. The annular portion of this surfae extending horizontally from the

dome edge will be referred to as the (cid:16)hat brim(cid:17). The dome is ylindrially symmetri

with maximum height z = R and edge height z = ze . The shape of the dome is arbitrary,

but in our demonstrations the dome will be a part of an origin-entered sphere of radius

Rs = R unless otherwise spei(cid:28)ed. The region surrounding the urved mirror will be
referred to as layer 0. The dieletri interfae between layer 0 and layer 1 has height
z = z1 . The last layer of the dieletri stak is layer N and the exit layer is alled layer
X . The depition of the stak layers in the (cid:28)gure suggests a design in whih the stak

onsists of some layers of experimental interest (perhaps ontaining quantum wells, dots,

or other strutures [5, 8℄) at the top of the stak where the (cid:28)eld intensity is high, and a

highly re(cid:29)etive periodi struture below.

At the heart of the proedure to solve for the quasimodes is an overdetermined, om-

plex linear system of equations, Ay = b. The olumn vetor y is made up of the
oe(cid:30)ients of eigenmodes in some basis B. The (cid:28)eld in layer 0 is given by expansion in
B using these oe(cid:30)ients. For a given wavenumber, k , a solution vetor y = ybest

an

5

be found so that |A(k) y − b|2
is minimized with respet to y . Dips in the graph of the
residual quantity, ∆r ≡ |A(k) ybest − b|, versus k signify the loations of the isolated
eigenvalues of k (theoretially ∆r should beome 0 at the eigenvalues). The solution
vetor ybest(k) at one of these eigenvalues desribes a quasimode. The system of equa-

tions is made up of three parts (as shown below): M1 equations, M2 equations and an

arbitrary amplitude or (cid:16)seed(cid:17) equation.

A y =

y

=

.

(1)



(cid:20)

(cid:20)






(cid:2)

M1

M2

(cid:21)



·

(cid:21)






(cid:3)

s. eqn.









0

.

.

.














.

.

.





0


1



Heneforth M1 refers to the planar mirror and M2 to the urved mirror.

The M1 boundary ondition for a plane wave basis is expressed simply in terms of

the 2 × 2 stak transfer matries Ts(θin) and Tp(θin), as suggested by the M1 region

(enlosed by the dashed line) in Fig. 1. In the salar and vetor multipole bases, a sort

of onversion to plane waves is required as an intermediate step. The dashed k vetors

in the (cid:28)gure (inoming from the bottom of the stak) represent plane waves that are

given zero amplitude, in order to de(cid:28)ne a quasimode problem rather than a sattering

problem. The plane waves denoted by the solid k vetors have nonzero amplitude.

The M2 boundary ondition is implemented as follows. A number of loations on the

urved mirror are hosen (the (cid:16)X(cid:17) marks in Fig. 1). The width of the hat brim is wb as
shown. An (cid:16)in(cid:28)nitesimal(cid:17) hat brim (wb ≪ λ) is introdued to give the dome a di(cid:27)rative

edge. An (cid:16)in(cid:28)nite(cid:17) hat brim an be introdued theoretially and an make the model

more easily understandable in ertain respets. More about the model in relation to the

hat brim is disussed in Appendix A.2. The M2 equations are the equations in basis B

setting the appropriate (cid:28)elds at these loations to zero. For a problem not possessing

ylindrial symmetry, these loations would be points. The simpli(cid:28)ation due to this

symmetry, however, allows these loations to be entire rings about the z axis, spei(cid:28)ed
by a single parameter suh as the ρ oordinate. Finally, the seed equation sets some

ombination of basis oe(cid:30)ients equal to one and is the only equation with a nonzero

value on the right hand side (b).

The ylindrial symmetry of the boundary onditions allows one to always (cid:28)nd solu-

tions whih have a φ dependene of exp(ımφ), where m is an integer. This in turn leads

to a dimensionally redued version of the plane wave basis alled the Bessel wave basis,

in whih eah basis funtion is a superposition of all the plane waves with the same

wavevetor polar angle, θk . The weight funtion of the superposition is proportional
to exp(ımφk). We will refer to the non-redued basis as the (cid:16)simple plane wave basis(cid:17).

The unadorned phrase (cid:16)plane wave basis(cid:17) (PWB; same abbreviation for plural) will re-

fer heneforth to either or both of the Bessel wave and simple plane wave bases. When

using the salar or vetor multipole basis (MB; same abbreviation for plural), ylindrial

symmetry allows the problem to be solved separately for eah quantum number m of

6

interest

. The dimensional redution in this ase amounts to the removal of a summation

2

over m in the basis expansion.

The refrative index in region (layer) q is denoted ˜nq . Layers are also denoted with an
means the eletri vetor (cid:28)eld in layer q . Sometimes

upper subsript in parenthesis: E(q)
(cid:16)fs(cid:17) is used as a value of q , meaning (cid:16)in free spae(cid:17) (e.g. ˜nfs
layers in the model we are onsidering atually are free spae. We note here that ˜nfs = 1

), whether or not any of the

only in (cid:16)avity type I(cid:17) disussed below.

The symbol k , where not in a super/subsript and not bold nor having any su-

per/subsripts, always refers to what may be alled the (cid:16)wavenumber in free spae(cid:17),

although it wil l have an imaginary part if M1 is a dieletri mirror. An imaginary part

in wavenumber, refrative index, and/or frequeny is often introdued (as it is in this

problem) to turn open avity problems into eigenvalue problems. The de(cid:28)nition of k is
as follows. De(cid:28)ne −k2
equations from the wave equation for layer q :

q as the onstant of separation used to separate spae and time

∇2

(q) =

˜n2
q
c2

(q)

∂2

X

∂t2

.

X

(2)

(q)

Here X

may be a vetor or salar (cid:28)eld.

In a few steps, the seletion of a global

monohromati time dependene exp(−ıωt) reveals that the ratio kq/˜nq is independent
of q . Then k is de(cid:28)ned as k ≡ kfs
the index ratios nq are assumed to be real. The single plane wave solution to (2) has the

, so that kq = nqk where nq ≡ ˜nq/˜nfs

. In the model,

(q) = C (q)eık(q)·xe−ıωt

where C (q)

form X

is a onstant vetor or salar and the omplex

is given by k(q) ≡ kqΩ(q)
wave vetor k(q)
vetor of the plane wave, spei(cid:28)ed by θ(q)
given by ω = ckq/˜nq . At a refrative interfae, the angle θ(q)
k

k = knqΩ(q)
k being the unit diretion
k and φk . The generally omplex frequeny is

k with Ω(q)

hanges as given by Snell's

law.

To understand the meaning of a omplex k , it is helpful to realize that the spatial

dependene of the quasimodes are idential

in the following two physial avities:

I :
II :

˜nfs = 1, ˜nq = nq,
˜nfs = Υ, ˜nq = Υnq, Υ ∈ C.

(3)

(The shape and size of eah dieletri and onduting region are the same for avities

I and II.) Cavity I is omposed of of ondutors and zero-gain regions of real refrative

index. Cavity II is onstruted by taking avity I and multiplying the refrative index of

The modes with low |m| are likely to be of pratial interest sine they have the simplest transverse
polarization struture. The |m| = 1 family of vetor eigenmodes is exeptional beause the pro-
portionality of Eρ and Eφ to exp(ımφ) means that modes for |m| 6= 1 have no average transverse
eletri (cid:28)eld, even instantaneously. (It is straightforward to show that hReExiφ = hReEyiφ = 0 if
|m| 6= 1.) Thus a uniformly polarized, foused beam entered on the avity axis an not ouple to
avity modes with |m| 6= 1 !

2

3

There is the minor di(cid:27)erene for the magneti (cid:28)eld (cid:28)rst noted in Eqn. (12). Sine the disrepany

is a onstant fator multiplying H , however, this di(cid:27)erene is not neessarily part of the spatial

dependene.

3

7

eah region, inluding free spae, by an arbitrary omplex number Υ. The ongruene
of the spatial quasimodes follows from separating the variables in (2). The values of k ,
kq , and nq for a given quasimode are the same in avities I and II. The frequeny in
avity II is ωII = ωI/Υ. If we heneforth onsider only the spei(cid:28) avity II for whih Υ
= (1 − ıg ) where g is tuned to be the ratio (−Imk/Rek) (for a given quasimode), we see
that ωII = cRek = ReωI

. While in avity I the quasimode deays in time, in avity II

the quasimode is a steady state beause the gain exatly o(cid:27)sets the loss. Either of the

two avity types may be imagined to be the ase in our treatment. The only di(cid:27)erene

is the existene of the deay fator exp(cIm(k)t) for avity I. (The inequality Imk ≤ 0

always turns up for an eigenvalue problem with onduting and/or dieletri interfae

boundary onditions.) We note that the relation of k to the free spae wavelength (always
real) of a plane wave is k = (1 − ıg)2π/λ. The quality fator, Q, of the quasimode is
Rek/(2|Imk|) = 1/(2g).

We note that Snell's law, ˜nq sin θ(q)

k = ˜nq+1 sin θ(q+1)

k

, is independent of whether we

have a avity of type I or II beause the quantity (1 − ıg), if present, divides out. One
of the limitations of our method is the omission of evanesent waves in layer 0 and
in layers where nq ≥ n0 (see Appendix A.1). Snel l's law may ause θ(q)
k
In this ase sin θ(q)
k > 1 and
omplex for layers with index ratios nq less than n0 .
cos θ(q)

k = ısgn(cos θ(0)

k )[sin2 θ(q)

k − 1]1/2

In most ases the symbols ψ , E , and H stand for omplex-valued (cid:28)elds. The time
dependene is exp(−ıωt) and it is usually suppressed. Physial (cid:28)elds are obtained by

to beome

.

multiplying by the time dependene and then taking the real part.

Throughout this paper, the ommon funtions denoted by Ylm , P m
l

, Pl , Jn , jl , and nl

are de(cid:28)ned as they are in the book by Jakson [10℄.

In the implementation, c and the related onstants ǫ0 , µ0 , and Z0 are all unity, and

they will usually be dropped in our treatment. We also assume non-magneti materials

so that µq = µ0 = 1.

3. Plane Wave Bases and the Bessel Wave Method

Although this ma jor setion desribes the Bessel wave method, muh of what is disussed

here is appliable to the two-basis method with little alteration. The disussion in Setion

4 is greatly shortened due to this overlap of onepts and proedures.

3.1. The Field Expansion in the Simple Plane Wave Bases

3.1.1. Salar basis

A single salar plane wave in layer q has the form ψ = C exp (ık(q) · x − ıωt). For a
general monohromati (cid:28)eld, k and ω are (cid:28)xed and the (cid:28)eld an be expressed (due to

the ompleteness of the salar PWB) uniquely (due to the orthogonality of the salar

PWB) as a sum over plane waves in di(cid:27)erent diretions. In our treatment however, we

omit plane waves in layer q whih would only exist as evanesent waves when refrated

8

into layer 0. The expansion for the (cid:28)eld in layer q is

2π

π

ψ(q)(x) =

dφk

dθ(0)
k

sin(θ(0)

k ) ˜ψ(q)

k eık(q)·x.

0

Z

0
Z

˜ψ(q)
k

Here the basis expansion oe(cid:30)ients are the

(ontinuous oe(cid:30)ients in the integral,

and disrete oe(cid:30)ients in implementation). The above expansion e(cid:27)etively propagates

eah plane wave existing in the avity down (whether forward or bakward) into the stak

layers, and adds up al l of their ontributions. In order to express the

in terms of

˜ψ(0)
k , it is (cid:28)rst neessary to separate the oe(cid:30)ients with kz > 0 from those with kz < 0

and write the above expansion as

˜ψ(q)
k

2π

π/2

ψ(q) =

dφk

0
Z
×

0
Z
u eık(q)
u ·x + ˜ψ(q)
˜ψ(q)

dα(0)

k sin(α(0)
k )
d eık(q)

·x

d

.

(cid:16)

(cid:17)

The u and d refer to the plane waves going upward or downward, e.i.
z ) = sgn(k(0)

z > 0, sine sgn(k(q)

z > 0 (or k(0)

oe(cid:30)ient

˜ψ(q)
k
for k(0)

for k(q)
z < 0. The wavevetor k(q)

˜ψ(q)
d
in ylindrial oordinates is (k(q)
ρ , k(q)

˜ψ(q)
u is the expansion
z )) and

takes the

plae of

φ , k(q)
z ),

˜ψ(q)
k

for whih the following relationships hold:

ρ = kq sin θ(q)
k(q)
z = kq cos θ(q)
k(q)

k = kn0 sin θ(0)
k = knq sgn(cos θ(0)

k = kn0 sin α(0)
k ) cos α(q)

k

k = k(0)
ρ ,

= knq sgn(cos θ(0)
k )

s
k(q)
φ = φk (indep. of q).

1 −

n0
nq

(cid:18)

sin α(0)
k

2

,

(cid:19)

This leads to

where

2π

π/2

ψ(q) =

dφk

dα(0)

k sin(α(0)

k )eıϕρ

0
Z
×

0
Z
u eıϕz + ˜ψ(q)
˜ψ(q)

d e−ıϕz

(cid:16)

,

(cid:17)

ϕρ ≡ ρkn0 sin(α(0)
k ) cos(φ − φk),
ϕz ≡ zknq cos α(q)
k .

From standard theory regarding plane waves and layered media[11℄, one an alulate

the 2 × 2 omplex transfer matrix, T (q)

s

, that obeys the following equation

˜ψ(q)
d e−ıϕz
˜ψ(q)
u eıϕz !

 

= T (q)
s

·

˜ψ(0)
d
˜ψ(0)
u !

.

 

9

(4)

(5)

(6)

(7)

(8)

(9)

De(cid:28)ning the olumn sums +β(q)

s ≡ T (q)

s,12 + T (q)

s,22 and +γ(q)

s ≡ T (q)

s,11 + T (q)

s,21 allows us to

write the expansion of the salar wave in the layers as

2π

π/2

ψ(q) =

dφk

dα(0)

k sin(α(0)
k )

0
Z
× eıϕρ

0
Z
+β(q)
s

(cid:16)

˜ψ(0)
u + +γ(q)
s

˜ψ(0)
d

.

(cid:17)

The reason for the notation with the subsripts (cid:16)+(cid:17) and (cid:16)s(cid:17) will beome apparent in the

vetor disussion. The (cid:16)s(cid:17) refers to s-polarization.

The variables in the simple PWB for salar (cid:28)elds are the omplex

(the

supersript will often be dropped). Next we onsider the simple PWB for vetor (cid:28)elds.

(10)

˜ψ(0)

u and

˜ψ(0)
d

3.1.2. Vetor basis

We assume that for our purposes a general monohromati eletromagneti (cid:28)eld an be

expressed uniquely as a sum of vetor (eletromagneti) plane waves. For every given

eah spatial diretion we need two,

(as opposed to a single plane wave in the salar ase). Instead of a single oe(cid:30)ient

frequeny and wavevetor diretion Ωk there are two orthogonally polarized plane waves
˜ψk for
˜Sk is the
amplitude of the vetor plane wave propagating in diretion Ωk whih has its eletri
(cid:28)eld polarized in the x-y plane (Ez = 0). Thus, this plane wave is an (cid:16)s-wave(cid:17) with
˜Pk is the amplitude of the (cid:16)p-wave(cid:17), the vetor plane wave
in diretion Ωk whih has its eletri (cid:28)eld polarized in the plane of inidene (Eφ = 0).

˜Pk , whih we an de(cid:28)ne as follows.

˜Sk and

regard to the planar mirror.

The oe(cid:30)ients

˜Sk and

˜Pk will be separated into

˜Su ,

˜Sd ,

˜Pu , and

˜Pd .

To speify the polarization of the (cid:28)elds we will use unit vetors denoted by ǫ. The

s,k denotes the diretion of the eletri (cid:28)eld assoiated with the plane wave

and s-polarization. We take the diretion of the unit vetors to be:

unit vetor ǫ(q)
with wavevetor k(q)
ǫ(q)
s,k = − ˆφk

p,k = ˆθ(q)
ǫ(q)

= ˆx sin φk − ˆy cos φk,
k sgn(cos θ(q)
k )
k ) cos θ(q)
= ˆρk sgn(cos θ(0)

k − ˆzsgn(cos θ(0)

k ) sin θ(q)
k .

(11)

In this phase onvention (used by Yeh[11℄), the pro jetions of the ǫ(q)
p,k vetors for the
inident and re(cid:29)eted waves onto the x-y plane are equal. The other ommon phase

onvention has these pro jetions being in opposite diretions.

The entire eletri and magneti (cid:28)eld an be broken up into two parts: E(q) = E(q)
E(q)
s
p
(Hz = 0) and H (q)
p

s + H (q)
is the (cid:28)eld with magneti p-polarization (Hφ = 0). We an now

and H (q) = H (q)

p where H (q)

s +

is the (cid:28)eld with magneti s-polarization

write down the most ompat expansion of the vetor (cid:28)eld.

E(q)

s =

dΩ(0)
k

k ǫ(q)
˜S(q)

s,keık(q)·x,

E(q)

p =

dΩ(0)
k

˜P (q)
k ǫ(q)

p,keık(q)·x,

Z

Z

10

H (q)

s = −˜nq

dΩ(0)
k

˜P (q)
k ǫ(q)

s,k sgn(cos θ(0)

k )eık(q)·x,

H (q)

p = ˜nq

˜S(q)
k ǫ(q)

p,k sgn(cos θ(0)

k )eık(q)·x.

(12)

Z
dΩ(0)
k

Z

The fators of ˜nq in the H equations ome from the physial relation of H to E for a
plane wave. Note that ˜nq is di(cid:27)erent for avity types I and II (as given in Eqn. (3)).

Separating up and down oe(cid:30)ients yields

2π

π/2

E(q)

s =

dφk ǫ(q)
s,k

dα(0)

k sin(α(0)

k )eıϕρ

0

Z
×

0
Z

u eıϕz + ˜S(q)
˜S(q)
(cid:16)
2π

π/2

d e−ıϕz

,

(cid:17)
k sin(α(0)

dα(0)

k ) eıϕρ

E(q)

p =

dφk

Z
×

0

0
Z
ˆρk cos(α(q)
k )
h

+ ˆz sin(α(q)
k )

u eıϕz + ˜P (q)
˜P (q)
(cid:16)
u eıϕz + ˜P (q)
− ˜P (q)
(cid:16)

d e−ıϕz

d e−ıϕz

(cid:17)

.

(cid:17)i

These expressions expliitly use oordinate vetors only where neessary due to a de-

pendene of the ǫk vetors on the sign of cos θ(0)

k . The expressions for H (q)

are omitted

for brevity.

To relate

˜P (0)
u/d we an use the transfer matries: Ts for
s-polarized light and Tp for p-polarized light. The transfer matrix used for the salar

˜S(0)
u/d and

˜S(q)
u/d and

˜P (q)

u/d to

(cid:28)eld in Eqn. (9) is the same matrix we will use here for s-polarization. These matries

perform the following transformations

We de(cid:28)ne

˜S(q)
d e−ıϕz
˜S(q)
u eıϕz !
˜P (q)
d e−ıϕz
˜P (q)
u eıϕz !

 

 

= T (q)
s

= T (q)
p

·

·

˜S(0)
d
˜S(0)
u !
˜P (0)
d
˜P (0)
u !

,

.

 

 

±β(q)
±γ(q)
±β(q)
±γ(q)

s ≡ T (q)
s ≡ T (q)
p ≡ T (q)
p ≡ T (q)

s,12 ± T (q)
s,22,
s,21 ± T (q)
s,11,
p,12 ± T (q)
p,22,
p,21 ± T (q)
p,11.

11

Note +β(q)
s
and z1 and not of ρ or φ. They are funtions of k and α(0)

and +γ(q)
s

are de(cid:28)ned as before. The β and γ quantities are funtions of z

k but not of φk .

(13)

(14)

(15)

Now the (cid:28)eld expansions beome

2π

π/2

E(q)

s =

dφk ǫ(q)
s,k

dα(0)

k sin(α(0)

k )eıϕρ

0
Z
×

+β(q)
s

(cid:16)
2π

dφk

0
Z
˜S(0)
u + +γ(q)
s
π/2

˜S(0)
d

,

(cid:17)
k sin(α(0)
k ) eıϕρ

dα(0)

E(q)

p =

0

0
Z
×

Z
ˆρk cos(α(q)
k )
h

+ ˆz sin(α(q)
k )

+β(q)
p

˜P (0)
u + +γ(q)
p

˜P (0)
d

(cid:16)
−β(q)
p

˜P (0)
u − −γ(q)
p

˜P (0)
d

(cid:17)
,

H (q)

s = ˜nq

2π

(cid:16)
dφk ǫ(q)
s,k

π/2

dα(0)

k sin(α(0)

(cid:17)i
k )eıϕρ

0
Z
−β(q)
p

×

(cid:16)

2π

0
Z
˜P (0)
u − −γ(q)
p
π/2

˜P (0)
d

,

(cid:17)
k sin(α(0)

dα(0)

k ) eıϕρ

H (q)

p = ˜nq

dφk

×

0
0
Z
Z
ˆρk cos(α(q)
k )
h

− ˆz sin(α(q)
k )

s

− −β(q)
(cid:16)
+β(q)
s

˜S(0)
u + −γ(q)
s

˜S(0)
d

˜S(0)
u + +γ(q)
s

˜S(0)
d

(cid:17)

.

The variables in the simple PWB for vetor (cid:28)elds are the omplex

˜P (0)
d

(the supersript will often be dropped).

(cid:16)

(16)

(cid:17)i

˜S(0)
u ,

˜S(0)
d ,

˜P (0)

u , and

3.2. The Field Expansion in the Bessel Wave Bases

3.2.1. Salar basis

We have already assumed a time dependene of exp(−ıωt). As mentioned in the

Overview, a ylindrially symmetri set of boundary onditions allows us to assume

an azimuthal dependene of exp(ımφ) with m being an integer. Consider the expansion
k whih ause the entire dependene of ψ(x)

˜ψ(q)

(4). We wish to (cid:28)nd the onditions on

on φ to be exp(ımφ).

The general Fourier series expansion of

is

k (θ(0)
˜ψ(q)

k , φk) =

n (θ(0)
f (q)

k ) eınφk.

(17)

We an then write (4) as

ψ(q) =

dθ(0)
k

sin(θ(0)

k )eı ˜ϕz f (q)

n (θ(0)
k )

dφk eıρkn0 sin(θ(0)

k ) cos(φ−φk)eınφk ,

(18)

˜ψ(q)
k

n
X

12

π

0

n Z
2π

X
×

0

Z

where

˜ϕz ≡ zknq cos θ(q)
k .

The last integral is of the solved form

′

′

′

eıy cos(φ

−φ)eınφ

dφ

= 2π(ı)nJn(y)eınφ,

2π

0
Z

ψ(q) = 2π

(ı)neınφ

dθ(0)
k

sin(θ(0)
k )

n
X

× eı ˜ϕz Jn(ρkn0 sin θ(0)

k )f (q)

n (θ(0)
k ).

π

0
Z

where Jn denotes the regular Bessel funtion of order n (n an be negative). This yields

In order to have only exp(ımφ) dependene on φ, the integral on the right hand side
must be zero for n 6= m. Beause f (q)
k ) annot be a funtion of z or ρ, the only way to
k (θ(0)
˜ψ(q)
k )eımφk
have this for all z and ρ is to pik fn = 0 for n 6= m. Thus
At this point we de(cid:28)ne the symbol ψ(q)
m . The ylindrially
k

to mean the oe(cid:30)ient f (q)

k , φk) = f (q)

m (θ(0)

n (θ(0)

.

symmetri expansion is

ψ(q) = ξ

dθ(0)
k

sin(θ(0)

k )eı ˜ϕz Jm(ρkn0 sin θ(0)

k )ψ(q)

k (θ(0)
k ),

π

0
Z

where

ξ ≡ 2π(ı)meımφ.

This is an expansion in salar Bessel waves, de(cid:28)ned to be

ξ exp(ızknq cos θ(q)

k )Jm(ρkn0 sin θ(0)
k ),

k (θ(0)

with {ψ(q)
k )} being the set of oe(cid:30)ients. Eah Bessel wave is a set of simple plane
waves with (cid:28)xed polar angle but having the full range (0 to 2π) of azimuthal angles,
φk . The weight fators of the plane waves are proportional to exp(ımφk). The (cid:28)nal

ylindrially symmetri salar expansion with up and down separated is

ψ(q)(x) = ξ

dα(0)

k sin(α(0)

k )Jm(ρkn0 sin α(0)
k )

π/2

0

Z
×

(cid:16)

+β(q)

s ψ(0)

u + +γ(q)

s ψ(0)

d

.

(cid:17)

u and ψ(0)

The ψ(0)
they make up the solution vetor y in (1).

d are the (omplex) variables in the Bessel wave method for salar (cid:28)elds;

(19)

(20)

(21)

(22)

(23)

(24)

(25)

13

3.2.2. Vetor basis

For ylindrially symmetri boundary onditions, the φ dependene of Eρ , Ez , Eφ , Hρ ,
Hz , and Hφ an be taken (for a single mode) to be exp(ımφ).

Consider doing the φk integrations in (12) or (16). The unit vetors ǫ(q)

s/p,k and ˆρk
depend on φk . The z omponents do not depend on φk so we will look at these (cid:28)rst.
There is no ontribution to the z omponent of the eletri (cid:28)eld from E(q)
s nor is there
any ontribution to the z omponent of the magneti (cid:28)eld from H (q)

. We de(cid:28)ne

s

Requiring that these quantities have an exp(ımφ) dependene produes results similar

to the salar ase. De(cid:28)ning

zP (q)(x) ≡ E(q) · ˆz = E(q)
p
z P (q)(x) ≡ H (q) · ˆz = H (q)
H

p

· ˆz,
· ˆz.

S(q)
k eımφk ≡ ˜S(q)
k ,
k eımφk ≡ ˜P (q)
P (q)
k ,

and using (16), we have the (cid:28)nal, useful expansions for zP (q)
π/2

and

:

z P (q)
H

zP (q) = ξ

dα(0)

k sin(α(0)

k ) sin(α(q)
k )

−β(q)

p P (0)

u − −γ(q)

p P (0)

d

,

z P (q) = − ξ ˜nq
H

(cid:16)
k sin(α(0)

dα(0)

k ) sin(α(q)
k )

0
Z

× Jm(ρkn0 sin α(0)
k )
π/2

0
Z
× Jm(ρkn0 sin α(0)
k )

(cid:16)

(cid:17)

(cid:17)

+β(q)

s S(0)

u + +γ(q)

s S(0)

d

.

(28)

To deal with the transverse part of the eletromagneti (cid:28)eld it is helpful to use quan-

tities related to irular polarization. We de(cid:28)ne

±S(q) ≡ ±ıE(q)
s
= e±ıφ(±ıE(q)

±S(q) ≡ ±ıH (q)
H
s
= e±ıφ(±ıH (q)

±P (q) ≡ E(q)
p
= e±ıφ(E(q)
p

±P (q) ≡ H (q)
H
p
= e±ıφ(H (q)

p

· ˆφ),

· ˆφ),

s

s

· ˆx − H (q)

· ˆx − E(q)
s

· ˆy
· ˆρ − E(q)
s
· ˆy
· ˆρ − H (q)
s
· ˆy
· ˆx ± ıE(q)
p
· ˆρ ± ıE(q)
p
· ˆy
p
· ˆρ ± ıH (q)

· ˆx ± ıH (q)

s

p

· ˆφ),

· ˆφ).

E(q)
s

· ˆρ =

( +S(q)e−ıφ − −S(q)eıφ),

E(q)
s

· ˆφ =

( +S(q)e−ıφ + −S(q)eıφ),

−ı
2
−1
2

14

Inverting (29) yields

(26)

(27)

(29)

E(q)
p

· ˆρ =

E(q)
p

· ˆφ =

1
( +P (q)e−ıφ + −P (q)eıφ),
2
−ı
2

( +P (q)e−ıφ − −P (q)eıφ),

(30)

with the magneti (cid:28)eld quantities having similar relations. Now we use (12) and (11)

with (29). The resulting eletri (cid:28)eld quantities are

±S(q) =

dθ(0)
k

sin(θ(0)

k )eı ˜ϕz

dφke±ıφkeıρkn0 sin(θ(0)

k ) cos(φ−φk) ˜S(q)
k ,

±P (q) =

dθ(0)
k

sin(θ(0)

k ) cos(θ(q)

k )sgn(cos θ(0)

k )eı ˜ϕz

π

2π

2π

0

Z
×

0

Z
×

0
Z
π

0
Z

dφke±ıφkeıρkn0 sin(θ(0)

k ) cos(φ−φk) ˜P (q)
k .

(31)

It is the exp(±ıφk) fators in the integrands here that motivated the de(cid:28)nitions of ±S/P
(29). We see that the substitution of (27) into (31) results in φk integrals of the form

(20). Performing this substitution, doing the integrals, and separating the up and down

parts gives the (cid:28)nal expansions:

π/2

±S(q) = ξ±

dα(0)

k sin(α(0)

k )Jm±1(ρkn0 sin α(0)
k )

0
Z
+β(q)

×

s S(0)

u + +γ(q)

s S(0)

d

,

(cid:16)
±P (q) = ξ±

π/2

dα(0)

k sin(α(0)

k )Jm±1(ρkn0 sin α(0)
k )

+β(q)

p P (0)

u + +γ(q)

p P (0)

d

,

(cid:17)

±S(q) = ξ±˜nq
H

k sin(α(0)

k )Jm±1(ρkn0 sin α(0)
k )

u − −γ(q)

p P (0)

d

,

(cid:16)
±P (q) = ξ±˜nq
H

dα(0)

k sin(α(0)

k )Jm±1(ρkn0 sin α(0)
k )

(cid:16)
dα(0)

0
Z
× cos(α(q)
k )
π/2

×

0
Z
p P (0)
−β(q)
π/2

0
Z
× cos(α(q)
k )

(cid:17)

(cid:17)

s S(0)

u + −γ(s)

s S(0)

d

,

− −β(q)
(cid:16)

(cid:17)

where

ξ± ≡ 2π(ı)m±1eı(m±1)φ.

At this point one an quikly verify, using (30) and the above equations, that Eρ , Eφ ,
Hρ , and Hφ do indeed have a φ-dependene of exp(ımφ).

(32)

(33)

15

The S(0)

u , S(0)

d , P (0)

u , and P (0)

d

and make up the solution vetor y in (1). They are essentially oe(cid:30)ients of eletro-

are the (omplex) variables in the Bessel wave method

magneti Bessel waves, although we need not expliitly ombine (32), (30), (28), and

(26) to obtain an expliit expression for the E and H vetor Bessel waves as we did for

the salar ase (24).

3.3. The Linear System of Equations for the PWB

Until now the PWB oe(cid:30)ients have been treated as ontinuous, when in pratie they

must be hosen disrete. Let us keep in mind this disrete nature in the following

subsetions. We denote by Ndirs
are 2Ndirs
vetor problem. The distribution of the α(0)

oe(cid:30)ient variables for a salar problem and 4Ndirs

the number of diretions α(0)

k on [0, π/2] need not be uniform, and the

oe(cid:30)ient variables for a

k we hoose. Thus there

e(cid:27)et of distribution hoie will be brie(cid:29)y mentioned later.

3.3.1. The planar mirror (M1) boundary equations

The M1 equations (planar mirror boundary ondition equations) in the PWB are very

simple. In fat, beause of this simpliity, the M1 equations in the MB are basially a

transformation to and from the PWB with the M1 equations for the PWB sandwihed

between. The re(cid:29)etion of a plane wave o(cid:27) of a layered potential is a well known

problem. For the purpose of determining the (cid:28)eld in layer 0, the entire dieletri stak
is haraterized by the omplex rs and rp oe(cid:30)ients ating at the (cid:28)rst surfae of the
stak. For the salar ase with the layer 0(cid:21)layer 1 interfae at z1 = 0, the boundary
d where rs(α) is the stak re(cid:29)etion funtion. Sine

˜ψ(0)
u = rs(α(0)

k ) ˜ψ(0)

ondition is just

Bessel waves are linear superpositions of many plane waves with the same θ(0)

k parameter,

this equations is true for Bessel waves:

u = rs(α(0)
ψ(0)

k )ψ(0)
d .

For a onduting mirror, set rs = −1 and for a free mirror set rs = 1.

If the interfae is at a general height z1 , then the same rs funtion is used at this

surfae yielding

or

where

u eız1kn0 cos α(0)
ψ(0)

k = rs(α(0)

k )ψ(0)

d e−ız1kn0 cos α(0)
k ,

u − ¯rs(α(0)
ψ(0)

k )ψ(0)

d = 0,

¯rs/p(α(0)

k ) ≡ rs/p(α(0)

k )e−ı2z1kn0 cos α(0)
k .

(34)

(35)

(36)

16

(37)

(38)

(39)

(40)

(41)

(The equation is given for both s- and p-polarization sine we will shortly be using the

rp quantities.) The quantities rs/p(α(0)
dieletri stak mirror, the ¯rs/p(α) are determined by T (q=layer X)

k ) are independent of z and z1 . When M2 is a

aording to

s/p

For the vetor ase the equation for the s-polarized plane waves is

where E(0)
u/d is the total eletri (cid:28)eld of the two plane waves going in the diretion spei(cid:28)ed
by αk , φk , and u or d. Shifting to our urrent notation and to Bessel waves, the equation

beomes

For p-polarization there is an arbitrary onventional sign.

In our phase onvention

(hosen in (11)) the equation is

¯rs/p(α) = −T (X)

s/p,21/T (X)

s/p,22.

E(0)
u

· ǫ(0)

s,u = ¯rs(α(0)

k )E(0)

d

· ǫ(0)
s,d,

u − ¯rs(α(0)
S(0)

k )S(0)

d = 0.

E(0)
u

· ǫ(0)

p,u = ¯rp(α(0)

k )E(0)

d

· ǫ(0)
p,d,

u − ¯rp(α(0)
P (0)

k )P (0)

d = 0.

or

The vetor ǫ(0)

p,u/d is ǫ(0)

p,˜k with

˜k being k fored into the up/down version of itself.

For a simple mirror, set rp = rs = {−1 for onduting, +1 for free} and use (36)
instead of (37) to determine ¯rs/p . Sometimes we will use cos αk as the expliit argument
to ¯rs/p or rs/p instead of αk .

(39) and (41), given for eah disrete α(0)

k , form the M1

Equation (35) or Eqns.

equations.

3.3.2. The urved mirror (M2) boundary equations

As mentioned in Setion 2, the M2 equations ome from setting the appropriate (cid:28)eld

omponents equal to zero at some number of loations on the urved mirror and the hat

brim. If we hose individual points on the two dimensional surfae, the φ-dependene
fator, exp(ımφ), ould be divided away. Thus piking loations with the same ρ and z
but di(cid:27)erent φ yields idential boundary equations. Therefore we simply set φ = 0 (and
t = 0) and pik equations by inrementing a single parameter (suh as ρ) on the one
dimensional urve given by the intersetion of the onduting mirror and the x-z plane.
The number of loations, NM2 lo
All of the loations are taken to lie in layer 0.

, determines the number of M2 boundary equations.

We obtain the M2 equations by, in e(cid:27)et, doing the α(0)
k

integrals in (25) or in (28) and

(32). Before making the integrals disrete, the distribution of representative diretions

17

must be hosen. If the interval ∆α(0)
integral over α(0)

k between suessive diretions is not onstant, the
k must be transformed to an integral over a new variable, x, where ∆x

is onstant. Suh a transformation will generate a new integration fator. At this point

the integral is turned into a sum aording to:

the diretion distribution to be uniform in α(0)
k
and yields a (cid:16)summation fator(cid:17) of π/(2Ndirs).

R

j , dx → (b − a)/N . Choosing

requires no hange in integration fator

b
a →

P

Using (25) and (23), the M2 equations for the salar problem are

Ndirs

2π

π
2Ndirs (cid:19)
(cid:18)
z=z∗ψuj + +γ(0)
+β(0)
s
(cid:12)
An equation is added to the linear system for eah hosen loation spei(cid:28)ed by (ρ∗, z∗).
(cid:12)
All phase fators have been divided out of (42) but the sale fator π2/Ndirs

Jm(ρ∗kn0 sin α(0)
kj )

z=z∗ψdj
(cid:12)
(cid:12)

× sin(α(0)
kj )

j=1 h
X

= 0.

(cid:17)i

(cid:16)

s

has been kept

(42)

for representative weighting. Of ourse there is also an e(cid:27)etive weight produed by the

distribution of the evaluation loations on the onduting mirror. In our implementation,

we hoose equal steps of θ to over the dome and equal steps of ρ to over the hat brim

(see Fig. 1).

For the vetor problem there are three equations assoiated with eah loation: Eφ =
0, Ek = 0, and H⊥ = 0. (Here the subsript (cid:16)k(cid:17) refers to the diretion that is both
ˆφ.) From (30) the Eφ = 0 equation

tangential to the M2 surfae and perpendiular to

is

−1
2

(cid:0)

+S(0) + −S(0) + ı( +P (0) − −P (0))

= 0.

(43)

The expansions for ±S/P in terms of the unknowns S/P (0)

(cid:1)

u/d in equation (32) must now

be used, along with the idential integral-to-sum onversion used in the salar problem

(42). It is probably not bene(cid:28)ial to work out the long form of this boundary equation,

as its omputer implementation an be done with substitutions.

The Ek = 0 equation depends on the shape of the mirror. If η is the angle that the

outward-oriented surfae normal makes with the z axis, then Ek is given by

where Ez = zP (0)

and, using (30),

Ek = Eρ cos η − Ez sin η,

Eρ =

ı( −S(0) − +S(0)) + +P (0) + −P (0)

.

(cid:1)

1
2

(cid:0)

Again equation (32) and the integral-to-sum onversion must be used to obtain the

expliit row equation. The H⊥ = 0 equation is obtained by doing the same type of

substitutions with

(44)

(45)

(46)

H⊥ = Hρ sin η + Hz cos η.

18

Here Hz = H

z P (0)

and

Hρ =

ı( H

−S(0) − H

+S(0)) + H

+P (0) + H

−P (0)

.

(47)

For loations on the hat brim, η = 0.

(cid:1)

1
2

(cid:0)

3.3.3. The seed equation

All the M1 and M2 equations have no onstant term. Thus the best numerial solution

will be the trivial solution ybest = 0. To prevent 0 from being a solution, an equation

with a onstant term must be added. One simple type of equation sets a single variable

equal to 1, for instane Su(j=5) = 1. Another simple type sets the sum of all of the

oe(cid:30)ients equal to 1. A more ompliated type sets the (cid:28)eld (or a (cid:28)eld omponent)

at a ertain point in spae equal to a onstant. No one type of seed equation is always

best.

3.3.4. Solution of Ay=b

As depited in (1), the matrix A is made up of the left hand sides of the M1, M2, and
seed equations. For the salar ase there are 2Ndirs
olumns and (Ndirs + NM2 lo + 1)
rows. For the vetor ase there are 4Ndirs
olumns and (2Ndirs + 3NM2 lo + 1) rows. The
is piked so that A has several times as many rows as olumns. A value
value of NM2 lo
of k is piked and the overdetermined system of equations is (cid:16)solved(cid:17) as well as possible

by a linear least squares method. The best suh methods rely on a tehnique known as

singular value deomposition [12℄. Our implementation relies on the funtion zgelsd of

the LAPACK fortran library. To (cid:28)nd the eigenvalues of k , the imaginary part of k is
set to zero and the real part of k is sanned. As mentioned in the Overview, this results
in dips in the value of ∆r . Using Brent's method [12℄ for minimization, the minimum
of the dip is found. The real part of k is now (cid:28)xed and Brent's method is used again
to (cid:28)nd the best imaginary part of k . Then Brent's method may again be used on the
real part of k . By this alternating method, the omplex eigenvalue of k is found, along
with the eigenmode, y . In pratie Brent's method need only be used two to four times
per san dip to get an aurate omplex k . We usually normalize eah row of A to 1

so that the normalized error per equation in the system an be expeted to be around

∆n ≡ ∆r/[|y| × (number of rows in A)1/2]. ∆n is one indiator of the auray of the

solution.

3.3.5. Calulating the (cid:28)eld from y

One y is alulated for a quasimode, the values of the (cid:28)eld in any layer an found by

using the expansion (25) for the salar (cid:28)eld and equations (32), (30), (28), and (26) for

the vetor (cid:28)eld. Of ourse the integrals over α(0)

k must be made disrete as disussed

previously. Appendix B explains more regarding the plotting of the (cid:28)elds.

19

4. Multipole Bases and the Two-Basis Method

As mentioned in the Introdution, the two-basis method ultimately uses the salar or

vetor MB. The MB is the eigenbasis for the losed, onduting hemisphere or sphere.

Both the vetor and salar multipole bases have known forms whih we will use but

not derive. The basis funtions already possess an azimuthal dependene of exp(ımφ)

and the dimensional redution due to ylindrial symmetry is aomplished by piking

a value for m instead of summing over basis funtions with many m.

The method of stepping along a one-parameter loation urve to obtain the M2 equa-

tions is the same as for the PWB. Expliit formulas in the MB of ourse will be ompletely

di(cid:27)erent and will be given in this ma jor setion. The methods of solution to the linear

system of equations are the same as for the PWB. The development of the M1 equations

in the MB, however, requires onsiderable work. After the system of equations has been

solved, using the resulting solution vetor y to alulate/plot the (cid:28)elds in layers other
than layer 0 also requires signi(cid:28)ant work. We use the term (cid:16)two-basis method(cid:17) beause

of the role of plane waves in these two alulations. Figure 2 represents the linear system

of equations of the two primary methods and how they are related.

Figure 2: Diagram for the two primary methods. The losed loops suggest the self-

onsisteny or (cid:16)onstrutive interferene(cid:17) of the quasimode solutions. Grey

regions indiate intersetion between PWB and MB methods. Size roughly

indiates the (cid:16)post-basis-derivation work(cid:17) required to get the equations. The

variable oe(cid:30)ients for the vetor problem are shown.

20

4.1. The Salar Multipole Basis

The salar MB funtions we use are the ψlm = jl(kn0r)Ylm(θ, φ) where jl denotes the
spherial Bessel funtion of the (cid:28)rst kind and Ylm is the spherial harmoni funtion.

The salar MB funtions, like the salar PWB funtions, satisfy the wave equation. We

assume the (cid:28)eld in layer 0, in a region large enough to enompass the avity, an be

expanded uniquely in terms of the salar MB funtions. Using the ylindrial symmetry

of the avity to solve the problem separately for eah value of m, we expand the (cid:28)eld in

the avity as

lmax

ψ(0)(x) =

cljl(kn0r)Ylm(θ, φ).

Xl=|m|
The expansion oe(cid:30)ients, cl , are omplex. One should never need to hoose lmax
larger than Re(k)n0rmax

where rmax

is the maximum radial extent of the dome (not the

(48)

muh

hat brim). (Semilassially, the maximum angular momentum a sphere or hemisphere of

radius Rs an support (for a given k) is ∼ Re(k)n0Rs , whih orresponds to a whispering-

gallery mode.)

The salar MB funtions are the exat eigenfuntions of the problem of a hypothetial

spherial ondutor spei(cid:28)ed by r = Rs = R, with eigenvalues given by the zeros of
jl(kn0R). The basis funtions for whih (l + m) is odd are the eigenfuntions of the

losed hemispherial ondutor. This is beause

Ylm has parity (−1)l+m

in cos θ

(49)

and thus is zero at θ = π/2. It an also be shown, using the power series expansion of
Pl(x) given in Ref. [13℄, that Ylm(π/2, φ) is nonzero if (l + m) is even.

4.2. The M1 Equations in the Salar MB

The expansion of a plane wave in terms of the (monohromati) salar MB funtions is

[10℄:

eık·x = 4π

(ı)lY ∗

lm(θ, φ)jl(kr)Ylm(θk, φk).

(50)

∞

l

Xl=0

Xm=−l

The inverse of this relation, the expansion of a salar MB funtion in terms of monohro-

mati plane waves, is

jl(kr)Ylm(θ, φ) =

dΩk

Ylm(θk, φk)

eık·x.

(51)

(−ı)l
4π

Z

(cid:18)

(cid:19)

This equation is easy to verify by inserting (50) into the right hand side. The use of

Ylm = (−1)mY ∗
l,−m and the orthogonality relation for the Ylm leads diretly to the left
hand side. The expansion (51), applied to layer 0 (k → k0 = kn0 ), is the foundation for

this setion and its ounterpart for vetor (cid:28)elds.

21

Using (48) and (51) yields the salar (cid:28)eld expansion for a given m:

ψ(0) =

dΩ(0)

k eık(0)·x

cl

(−ı)l
4π

Ylm(θ(0)

k , φk)

.
(cid:19)

Z

(cid:18) Xl=|m|
The quantity in the urved brakets is ψk , the simple plane wave oe(cid:30)ient (ompare
to Eqn. (4) with q set to 0). We an now use (35). For kz > 0, ψu = ψk and ψd = ψk
where in ylindrial oordinates k
ψu = ψk
. Using (49), one gets ψk
derive an equation that expresses (35) and holds for all Ω(0)
k :

(k) ≡ (kρ, kφ, −kz). For kz < 0, ψd = ψk and
l clYlm(θ(0)
k , φk)(−1)l+m(−ı)l/(4π). We an now

= k

′ =

′

′

′

′

,

P

(52)

cl

(−ı)l
4π

Ylm(θ(0)

k , φk)

Xl=|m|

1 − ¯rs,

sgn(cos θ(0)

k ) (1 + ¯rs) ,

×

(cid:26)

l + m is even
l + m is odd (cid:27)

= 0.

(53)

At this point there are two ways to proeed.

4.2.1. Variant 1

One way to onstrut the M1 portion of the matrix A is to pik some number NM1 dirs
of disrete diretions, θ(0)
k , and use (53) for eah diretion (the φk dependene divides
out). Inspetion of the equation reveals that it is even in cos θ(0)
in the domain [0, π/2] are needed. Using α(0)

k ; thus only polar angles

k as before to denote this redued domain,

the M1 equations in this variant beome:

cl

(−ı)l
4π

lmax

Xl=|m|

Ylm(α(0)

k , 0)

×

1 − (−1)l+m rs(cos α(0)
(cid:16)

k )e−ı2z1kn0 cos α(0)

k

= 0.

(54)

(cid:17)

We note for later omparison that for eah α(0)
k we need only evaluate a single assoi-
ated Legendre funtion (inside the Ylm), beause the reursive alulation tehnique for
omputing P m

(x) also omputes P m

l (x) for |m| ≤ l ≤ lmax

lmax

. Sine eah step of this

reursive alulation involves a onstant number of (cid:29)oating point operations, we may

say that the omplexity assoiated with the P m
Generally NM1 dirs ∼ lmax
evaluations of ¯rs is O(lmax).

so the P m

l
omplexity is O(l3

l

alulations for eah α(0)
max).
k
) and the overall number of

is O(l2

max

4.2.2. Variant 2

Rather than piking disrete diretions to turn (53) into many equations, we ould

pro jet the entire left hand side onto the spherial harmoni basis, {Yl

′

m

′ }, (that is,

22

′ (Ω(0)
integrate (53) against Y ∗
l
m
) pair must be zero. The integrals for m
the integral for eah (l
, m
′ = l
an be negleted. Thus the number of equations generated is Nl
set l

k ). Due to the uniqueness of the basis expansion,
6= m are zero and
− |m| + 1. We

k ) in Ω(0)

= lmax

′

′

′

′

′

′

max

.

max

Sine (53) is even in cos θ(0)
+ m is odd, halving
m gives 0 if l
the number of equations. When l
+ m is even the integration must be done numerially.
The most analytially simpli(cid:28)ed version of the oe(cid:30)ients of cl in the M1 equation
orresponding to l

k , integrating against Y ∗
l

+ m even) is:

(for l

′

′

′

′

′

where

M1l

′

,l = ζ

P |m|
l

(x)P |m|
l

′

(x)

1 − (−1)l+m¯rs(x)

dx,

1

0

Z

(cid:0)

ζ ≡

(−ı)l
4π

(cid:18)

(2l + 1)(2l

+ 1)

′

′

(l − |m|)!
(l + |m|)!

− |m|)!
(l
(l′ + |m|)!

1/2

.

(cid:1)

(cid:19)

(55)

(56)

This omes from using the properties of Ylm under a sign hange of m, using the de(cid:28)nition
of Ylm , doing the φk integral, and halving the domain of the even integral over x =
cos α(0)
k . Noting that the number of unknowns in the solution vetor y is Nl = lmax −
|m| + 1, the number of (omplex) oe(cid:30)ients that must be alulated is about N 2
l /2.
+ m are both even, the alulation
,l when l + m and l
l /4 real-valued integrations.

Noting that M1l,l
is redued to about 3N 2

′ = (−ı)l

M1l

−l

′

′

′

While this variant of the method is in some ways the most elegant, the numerial

integrals are extremely omputationally intensive. Our implementation used an adaptive

Gaussian quadrature funtion, gsl_integration_qag of the GSL. (Adaptive algorithms

hoose a di(cid:27)erent set of evaluation points for eah integration and ahieve a presribed

auray; in a sense the integral is done in a ontinuous rather than a disrete manner.)

For an adaptive algorithm, the omplexity

),
where ν ≥ 1. The number of evaluations of ¯rs is O(l2+ν
max). In pratie, variant 2 is muh
slower than variant 1 even for avities as small as R/λ ≈ 5 with simple mirrors. Cheking

l alulation is O(l3+ν

assoiated with the P m

max

4

between the two variants has generally shown very good agreement.

4.3. The Linear System of Equations in the Salar MB

The M1 equations have been given in the previous setion. Using (48) yields an M2

equation

cljl(kn0r∗)Ylm(θ∗, 0) = 0,

(57)

lmax

Xl=|m|

4

The exponent ν is de(cid:28)ned so that the number of integration points that must be sampled (for the
most ompliated integrals where l ∼ l
(This de(cid:28)nition may not be rigorous if ν is a funtion of lmax
P m
l

for m > 0 are even more ompliated, it is reasonably ertain that ν ≥ 1.

) to maintain a onstant auray goes like lν

l (x) has O(l) zeros and the

.) Sine P 0

∼ lmax

′

max

.

23

for eah loation (r∗, θ∗). The disussions from Setion 3.3 regarding the M2 equations,
the seed equation, and the method of solution to Ay = b apply here. The number of
olumns in A is Nl and the number of rows is (NM1 dirs + NM2 lo + 1) for variant 1 or
about (Nl/2 + NM2 lo + 1) for variant 2.

4.4. Calulating the Field in the Layers with the Salar MB

To alulate the omplex (cid:28)eld anywhere in layer 0 one a quasimode solution y has been

found, Eqn. (48) an be used diretly. To alulate the (cid:28)eld in the layers below the

avity (q > 0) where the expansion does not apply, the Bessel waves must be used, along
with the T (q)
s matrix that propagates them. Performing the φk integration in (52), using
(49), and then omparing with (9) and (25) with q = 0 in both of these yields the Bessel

wave oe(cid:30)ients:

Ylm(α(0)

k , 0),

ψ(0)

u =

ψ(0)

d =

cl

(−ı)l
4π

cl

(−ı)l
4π

Xl

Xl

Ylm(α(0)

k , 0)(−1)l+m.

(58)

Now (25) an be used with q > 0 yielding

ψ(q)(x) =

eımφ

(ı)m
2

π/2

dα(0)

k sin(α(0)
k )

0

Z
× Jm(ρkn0 sin α(0)
k )

cl(−ı)lYlm(α(0)

k , 0)

×

+β(q)

s + (−1)l+m

(cid:0)

hXl
+γ(q)
s

.
(cid:1)i

This is a ostly numerial integration to do with an adaptive algorithm. For every

sampled α(0)

k , the quantities Ts , P m
lmax

and Jm must be alulated one. For displaying

large regions of the (cid:28)eld in the stak, it is su(cid:30)iently aurate to simply onvert the

solved MB solution vetor y into a PWB solution vetor (with Ndirs ∼ lmax

) by means

of a separate program using (58), and then use the disrete form of (25) to plot.

4.5. The Vetor Multipole Basis

We expand the eletromagneti (cid:28)eld in layer 0 (at least in a (cid:28)nite region surrounding

the avity) in the vetor multipole basis using spherial Bessel funtions of the (cid:28)rst kind

(jl ). The multipole basis uses the vetor spherial harmonis (VSH; same abbreviation

for singular), whih are given by[14℄

(59)

(60)

Mlm(x) = −jl(kn0r) x × ∇Ylm(θ, φ),

Nlm(x) =

∇ × Mlm.

1
kn0

24

The VSH are not de(cid:28)ned for l = 0. The nature of the eletromagneti multipole ex-

pansion is developed in setion 9.7 of the book by Jakson[10℄ using somewhat di(cid:27)erent

terminology. The multipole expansion of the eletromagneti (cid:28)elds is

E(0)(x) =

(−alNlm + ıblMlm) ,

lmax

Xl=lmin

lmax

Xl=lmin

H (0)(x) = ˜n0

(ıalMlm + blNlm) ,

(61)

where ylindrial symmetry has been invoked to remove the sum over m, and lmin =
max(1, |m|). The al and bl are omplex oe(cid:30)ients and there are Nl = lmax − lmin + 1 of
eah of them. The al oe(cid:30)ients orrespond to eletri multipoles and the bl oe(cid:30)ients

orrespond to magneti multipoles. The expliit forms of the VSH are

Mlm(x) = ˆθ

jl(kn0r)Ylm(θ, φ)

ım
sin θ

Nlm(x) = ˆr

jl(kn0r)Ylm(θ, φ)

−jl(kn0r)

Ylm(θ, φ)

,

(cid:17)

(cid:19)

(cid:16)
+ ˆφ

(cid:18)
+ ˆθ

+ ˆφ

(cid:18)
l(l + 1)
kn0r
1
kn0r

(cid:18)

∂
∂r
ım
kn0r sin θ

(cid:18)

∂
∂θ

∂
∂r

(rjl(kn0r))

(cid:19)
Ylm(θ, φ)

∂
∂θ

(cid:19)
(rjl(kn0r)) Ylm(θ, φ)

.

(cid:19)

(62)

4.6. The M1 Equations in the Vetor MB

The goal of the alulation here is to transform the M1 relations, (38) and (40), into

equations suh that eah dot produt is written in the form

l(alfa(k) + blfb(k)). The
resulting (two) equations will be the vetor analogues of (53) and will hold for all Ω(0)
k ,

P

leading to two variants of solution method in the same manner as before. First we must

Fourier expand E(0)
is (51) whih expands the quantity jlYlm(x). We must therefore break Mlm into terms

as we expanded ψ(0)

to get (52). The only Fourier relation we have

ontaining this quantity.

Here we an make use of the orbital angular momentum operator L = −ı(x × ∇).
Using the ladder operators, L± = Lx ± ıLy , the VSH Mlm = −ıjlLYlm an be shown to

be

where

Mlm = (−ıjl) ×

ˆx

lmYlm+1 + d−
d+

lmYlm−1

1
2

+ ˆy

ı
2

h
lmYlm+1 + d−
−d+

(cid:0)

lmYlm−1

(cid:1)
+ ˆz (mYlm)

,

(cid:1)

i

(63)

(64)

(l ∓ m)(l ± m + 1).

(cid:0)

d±
lm ≡

p

25

(65)

(66)

(67)

(68)

Using (51) multiple times yields

with

where

Mlm =

dΩ(0)
k

˜Mlmeık(0)·x,

Z

(−ı)l
8π
(−ı)l
4π

+ ˆz

˜Mlm = ˆx

(−ı)e+

lm + ˆy

(−1)e−
lm

(−ı)l
8π

mYlm(Ω(0)

k ),

lm ≡ d+
e±

lmYlm+1(Ω(0)

k ) ± d−

lmYlm−1(Ω(0)
k ).

We an avoid the task of expanding Nlm into jlYlm terms by just using

Nlm =

∇ × Mlm
kn0

=

dΩ(0)
k

k(0) × ˜Mlmeık(0)·x.

ı
kn0

Performing the ross produt and substituting into (61) using (65-66) yields

Z

(cid:16)

(−ı)l
4π

(−ı)l
4π

(−ı)l
4π

(cid:20)

(cid:20)

(cid:20)

(cid:26)Xl

(cid:26)Xl

(cid:26)Xl

al

(cid:16)

(cid:16)

ı
2

Ex(x) =

dΩ(0)

k eık(0)·x

al

−m sin θ(0)
k

sin φkYlm −

cos θ(0)

k e−

lm

+ bl

Ey(x) =

dΩ(0)

k eık(0)·x

al

m sin θ(0)

k cos φkYlm −

cos θ(0)

k e+

lm

Ez(x) =

dΩ(0)

k eık(0)·x

sin θ(0)

k cos φk e−

lm +

sin θ(0)
k

ı
2

1
2

1
2

(cid:17)
+ bl

1
2

e+
lm

(cid:16)
−ı
2

e−
lm

,

(cid:17)(cid:21)(cid:27)
,

(cid:17)(cid:21)(cid:27)
mYlm

(cid:16)

(cid:17)
sin φk e+
lm

+ bl

(cid:17)

(cid:16)

(69)

,

(cid:17)(cid:21)(cid:27)

Z

Z

Z

where Ylm is understood to mean Ylm(Ω(0)
˜Ey(k), and
˜E(k

˜Ex(k),

been dropped. We will also need

(69) wil l be denoted by

′

k ). The quantities inside the urly braes in
˜Ez(k), where the (cid:16)(0)(cid:17) supersript on k has
(k) = (kρ, kφ, −kz) as before. Again

) where k

′

using (49) we (cid:28)nd

′

′

′

(−ı)l
4π

(−ı)l
4π

(−ı)l
4π

Xl

Xl

Xl

˜Ex(k

) =

(−1)l+m

sin φkYlm −

cos θ(0)

k e−

lm

+ bl

˜Ey(k

) =

(−1)l+m

k cos φkYlm −

cos θ(0)

k e+

lm

˜Ez(k

) =

(−1)l+m

sin θ(0)

k cos φk e−

lm +

sin θ(0)
k

ı
2

1
2

−1
2

(cid:17)
+ bl

(cid:16)
ı
2

(cid:17)
(cid:16)
sin φk e+
lm

−1
2

e+
lm

,
(cid:17)(cid:21)

e−
lm

,
(cid:17)(cid:21)
+ bl

(cid:17)

(cid:16)

mYlm

.
(cid:17)(cid:21)

(70)

al
(cid:20)

al
(cid:20)

al
(cid:20)

−m sin θ(0)
k
(cid:16)
m sin θ(0)
(cid:16)

−ı
2

(cid:16)

26

4.6.1. The M1 equations for s-polarization

We will now de(cid:28)ne flm and glm by

˜E(k) · ǫs,k ≡

(alglm + blflm) .

(71)

(−ı)l
4π

Xl

Performing the dot produt using (11) yields

flm =

lmYlm+1e−ıφk − d−
d+

lmYlm−1eıφk

,

glm =

d+
lmYlm+1e−ıφk + d−

(cid:1)
lmYlm−1eıφk

ı
2
1
2
− m sin θ(0)
(cid:0)
k Ylm

(cid:0)
cos θ(0)
k

2l + 1
2l − 1

(cid:18)

p

=

1
2r
+

p

(l − m)(l − m − 1)Yl−1,m+1e−ıφk

(l + m)(l + m − 1)Yl−1,m−1eıφk

(cid:1)

.
(cid:19)

′

˜E(k

) · ǫs,k =

(−1)l+m (alglm − blflm) .

′

˜E(k

) yields

(−ı)l
4π

Xl

The simpli(cid:28)ation in the last step has been done using reursion relations for the P m
l

.

Performing the dot produt for

The M1 relation (from (38)) is

˜E(k
¯rs ˜E(k) · ǫs,k for kz < 0. These lead to an M1 equation that holds for all Ω(0)
k :

) · ǫs,k for kz > 0 and

˜E(k) · ǫs,k = ¯rs ˜E(k

′

′

) · ǫs,k =

lmax

Xl=lmin

(−ı)l
4π

(cid:26)

als1glm + bls2flm,
als2glm + bls1flm,

l + m even
l + m odd (cid:27)

= 0,

where s1 ≡ 1 − ¯rs(| cos θ(0)

k |) and s2 ≡ sgn(cos θ(0)

k )(1 + ¯rs(| cos θ(0)

k |)).

4.6.2. The M1 equations for p-polarization

The M1 equation for p-polarization is obtained the same way as above. The alulation

is simpli(cid:28)ed by temporarily swithing phase onventions. We de(cid:28)ne the unit vetor

˜ǫp,k ≡ sgn(cos θ(0)

k )ǫp,k (using (11)) so that

˜ǫp,k = ˆx cos θ(0)
˜ǫp,k

′ = − ˆx cos θ(0)

k cos φk + ˆy cos θ(0)

k

sin φk − ˆz sin θ(0)
k ,

k cos φk − ˆy cos θ(0)

k

sin φk − ˆz sin θ(0)
k .

(75)

The M1 relation is now

′ =
(−¯rp) ˜E(k) · ˜ǫp,k for kz < 0, where ¯rp has not hanged in any way. Performing the dot

for kz > 0 and

˜E(k) · ˜ǫp,k = (−¯rp) ˜E(k

) · ˜ǫp,k

) · ˜ǫp,k

˜E(k

′

′

′

27

(72)

(73)

(74)

produts, we (cid:28)nd that

˜E(k) · ˜ǫp,k =

(−alflm + blglm),

Xl

(−ı)l
4π

(−ı)l
4π

′

˜E(k

) · ˜ǫp,k

′ =

(−1)l+m(alflm + blglm).

Xl
This leads to the M1 equation for p-polarization whih holds for all Ω(0)
k :

lmax

Xl=lmin

(−ı)l
4π

(cid:26)

−alp2flm + blp1glm,
−alp1flm + blp2glm,

l + m even
l + m odd (cid:27)

= 0,

where p1 ≡ 1 + ¯rp(| cos θ(0)

k |) and p2 ≡ sgn(cos θ(0)

k )(1 − ¯rp(| cos θ(0)

k |)).

4.6.3. Variant 1

(76)

(77)

Variant 1 for the vetor ase proeeds exatly as it does for the salar ase. The M1

equations (74) and (77) are seen to be even in cos θ(0)
only in the domain [0, π/2]. Thus for eah disrete diretion α(0)
k we get one equation (in
the M1 portion of A) for eah polarization. No modi(cid:28)ation of (74) or (77) is needed,
exept that we an take φk = 0 and cos θ(0)

k , allowing us to pik diretions

k = cos α(0)

k ≥ 0.

The omplexity of alulating the M1 portion of A is of the same order in lmax

as it is

for the salar MB. However, numerous onstant fators make the omputation time an

order of magnitude longer, as there are more P m
omputed in addition to ¯rs .

l

funtions to ompute and ¯rp must be

4.6.4. Variant 2

In this minor setion, we assume that m ≥ 0 (see Appendix B for plotting negative m
modes from positive m solutions). We follow the same proedure used in variant 2 for
6= m
the salar (cid:28)eld. Integrating (74) and (77) against Yl
or l
+ m even, the M1 equation assoiated with eah l
in {|m|, |m| + 1, . . . , lmax} for s-polarization is

k ) yields zero if either m

+ m is odd. For m

= m and l

′ (Ω(0)
m

′

′

′

′

′

′

lmax

1

Xl=lmin
+ bl(ı)

−

ζ

1
2

1

0
Z

(cid:16)

(cid:20)

al

0
Z

1 − (−1)l+m ¯rs
(cid:16)
1 + (−1)l+m ¯rs

P m+1
l

(cid:17)(cid:16)

P m+1
l−1 (x) + (l + m)(l + m − 1)P m−1

l−1 (x)

P m
l

′ (x) dx

(cid:17)(cid:16)
(x) − (l + m)(l − m + 1)P m−1

(cid:17)

(x)

P m
l

′ (x) dx

= 0,

l

(cid:17)

(cid:21)

(78)

28

and the M1 equation for p-polarization is

lmax

Xl=lmin
+ bl

1
2

1

(cid:20)

1

0
Z

(cid:16)

1 + (−1)l+m ¯rp
(cid:16)

(cid:17)(cid:16)

0
Z

−

ζ

al(−ı)

1−(−1)l+m ¯rp

P m+1
l

(x)−(l+m)(l−m+1)P m−1

(x)

l

P m
l

′ (x) dx

(cid:17)(cid:16)

(cid:17)

l−1 (x) + (l + m)(l + m − 1)P m−1
P m+1

l−1 (x)

P m
l

′ (x) dx

= 0,

(cid:17)

(cid:21)

(79)

where P n

µ = 0 for |n| > µ. Note that if m = 0 the equations for l

= 0 are inluded. We

′

implemented this by alulating an array of eah of the following types of integrals:

P m
ν dx,
P m
ν ¯rs dx,
P m
ν ¯rp dx,

1

µ

µ

0 P m+1
1
0 P m+1
R
1
0 P m+1
R
R

µ

1

µ

µ

0 P m−1
1
0 P m−1
R
1
0 P m−1
R
R

µ

P m
ν dx,
P m
ν ¯rs dx,
P m
ν ¯rp dx.

The integrals in the (cid:28)rst row an be alulated ahead of time and stored in a data

(cid:28)le. The other integrals must be alulated eah time the matrix A is alulated. The
omplexity of the alulation is of the same order in lmax

as for variant 2 in the salar

ase. These integrals are very numerially intensive and in pratie variant 2 takes

muh longer than variant 1. We have found good agreement between the two variants,

indiating that variant 1 an be used all or most of the time.

4.7. The Linear System of Equations in the Vetor MB

The M2 equations are found in the usual way, hoosing loations (ρ∗, θ∗) with φ = 0
and onstruting the equations Eφ = 0, Ek = Eρ cos η − Ez sin η = 0, and H⊥ =
Hρ sin η + Hz cos η = 0. The (cid:28)elds E and H are found by substituting (62) into (61).

The derivatives in (62) are

(rjl(kn0r)) = kn0rjl−1(kn0r) − ljl(kn0r),

(80)

∂
∂r

and, for m ≥ 0,

∂
∂θ

Ylm(θ, φ) =

1
2

(2l + 1)(l − m)!
4π(l + m)!

(cid:20)

1/2

(cid:21)

×

P m+1
l

− (l + m)(l − m + 1)P m−1

eımφ,

l

(81)

l = 0. (For negative m use Yl,−m = (−1)mY ∗

where P l+1
lm .) The number of olumns in
A is 2Nl and the number of rows is (2NM1 dirs + 3NM2 lo + 1) for variant 1 and about
(Nl + 3NM2 lo + 1) for variant 2.

(cid:0)

(cid:1)

29

4.8. Calulating the Field in the Layers with the Vetor MB

To alulate the (cid:28)eld in layer 0, the expansion (61) is used diretly, with (62), (80), and

(81) being used to obtain the expliit form. As for the salar ase, there is no diret

expansion for the layers q > 0 in the MB, and we must use the Bessel wave basis. Using

(71), (73), and (76), the onversion is seen to be

Su =

Sd =

Pu =

Pd =

(−ı)l
4π

lmax

Xl=lmin

(−ı)l
4π

(−ı)l
4π

(−ı)l
4π

Xl

Xl

Xl

(alglm + blflm)

,

k =α(0)
θ(0)

k ,φk=0

(−1)l+m (alglm − blflm)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(−alflm + blglm)

k =α(0)
θ(0)

k ,φk=0

(cid:12)
(cid:12)
(cid:12)
(cid:12)
k =α(0)
θ(0)
k ,φk=0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

,

,

.

k ,φk=0

k =α(0)
θ(0)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(−1)l+m (alflm + blglm)

(82)

This is the vetor ase analogue of Eqn. (58).

At this point the Bessel wave oe(cid:30)ients Su , et., are ontinuous funtions of α(0)
k ,

not disrete as they were in the Bessel wave method. These ontinuous oe(cid:30)ients are

substituted into the integrals (32), and (cid:28)nally (30) is used to give the vetor (cid:28)elds in the

layers. As in the salar ase, however, doing the integrals with an adaptive algorithm is

impratial if one is plotting the vetor (cid:28)elds in a sizable region. In this ase, it is best

to make the Bessel wave oe(cid:30)ients disrete and use a simple integration method, or,

as was suggested in the salar ase, to pik a Ndirs

and reate a PWB solution vetor

that an then be plotted via a PWB plotting routine.

5. Demonstrations and Comparisons

In this setion we will demonstrate, but not thoroughly analyze, several results that we

have obtained using our model and methods. The modes shown here all have ∆n <
0.0002 and do not ontain large amounts of high-angle plane waves, whih in priniple

an ause problems (see Appendix A.1). The authors expet to publish a separate

paper fousing on the modes themselves.

In this setion we will also ompare our

implementations of the two-basis method and the Bessel wave method. Before reading

this setion it may be helpful to look at Appendix B.

5.1. The (cid:16)V(cid:17) Mode: A Stak E(cid:27)et

As mentioned several times in the Introdution, the orret treatment of a dieletri

stak an be essential for getting results that are even qualitatively orret

. One of

5

5

It is not always essential however, see Note Added in Proof.

30

Figure 3: Contrast-enhaned plot of ReEx in the y -z plane for a (cid:16)V(cid:17) mode (m = 1, k =
8.1583 − ı0.000019). M2 is spherial and origin-entered; R = 40; z1 = 0.3;
ze = 3; M1 = stak II; ks = 8.1600; Ns = 20. In this and other side view plots,

the (cid:28)eld outside the avity has been set to zero.

the most remarkable di(cid:27)erenes that we have observed when swithing from simple to

dieletri M1 mirrors ours right where someone looking for highly-foused, drivable

modes would be interested: the widening behavior of the fundamental Gaussian mode

(the 00 mode). A Gaussian mode of a near-hemispherial avity will beome more and

more foused (wide at the urved mirror and narrow at the (cid:29)at mirror) as z1 is dereased

(from a starting value for whih the Gaussian mode is paraxial). As the mode beomes

more foused, of ourse, the paraxial approximation beomes less valid and at some

point Gaussian theory no longer applies. We have found, using realisti Al1−xGaxAs(cid:21)

AlAs stak models (staks I and II desribed in Appendix C), that the 00 mode splits

into two parts, so that in the side view a (cid:16)V(cid:17) shape is formed. Figure 3 shows a split

mode and Fig. 4 shows the physial transverse eletri (cid:28)eld, ReET ≡ ReEx ˆx + ReEy ˆy ,
for this mode near the foal region. Figure 5 shows the values of Re(kR) as z1 is hanged

from 0.3 to about 0.63. Figure 6 shows a zoomed view of the (cid:28)eld at the fous of the

mode at z1 = 0.63, where it is qualitatively a 00 mode. If a onduting mirror is used,

the entral one simply grows wider and wider, but does not split. The V mode is

predominately s-polarized and appears in the salar problem as well. Thus it appears

that the V mode is a result of the non-onstany of arg(rs(α)) for a dieletri stak.
We note here that following the 00 mode as z1 is hanged is an imperfet proess:

it

is possible that the following proedure may skip over narrow antirossings that are

di(cid:30)ult to resolve. However, the harater of the mode is maintained through suh

antirossings.

The apparent splitting of the entral one/lobe for higher order Gaussian modes has

also been observed. In the next setion we look at some higher order Gaussian modes,

fousing not on what ours at the breaking of the paraxial ondition, but on what is

allowed and observed for modes that are very paraxial.

31

Figure 4: An x-y ross setion of the mode in Fig. 3 at z = 1.58. Units are in µm
as usual. For m = +1, the forward time evolution is simply the ounter-
lokwise rotation of the entire vetor (cid:28)eld. If m = +1 and m = −1 are mixed

to reate a osine mode, the arrow diretions remain (cid:28)xed and their lengths

simply osillate sinusoidally in time so that the mode is assoiated with x

polarization. The inset shows the loation of the ross setion in the view of

Fig. 3. (The (cid:28)eld is plotted only in layer 0.)

5.2. Persistent Stak-Indued Mixing of Near-Degenerate

Laguerre-Gaussian Mode Pairs

As mentioned in the previous setion, we do observe the fundamental Gaussian mode

for paraxial avities with both dieletri and onduting planar mirrors. The situation

beomes more interesting when we look at higher order Gaussian modes.

It is true

that, as modes beome inreasingly paraxial, Gaussian theory must apply. However,

the way in whih it applies allows the design of M1 to play a signi(cid:28)ant role. Here

we will demonstrate the ability of a dieletri stak (stak II) to mix near-degenerate

32

Figure 5: Following kR as z1 is varied. The points of the two graphs orrespond one-to-
one, with the parameter z1 inreasing from left to right in both graphs. The

peaks in resonane width have not yet been analyzed.

pairs predited by Gaussian theory into new, more ompliated near-degenerate pairs

of modes. We must provide onsiderable bakground to put these modes into ontext.

Our disussion applies to modes with paraxial geometry, modes for whih the paraxial

parameter h ≡ λ/(πw0) = w0/zR is muh less than 1. (Here w0 is the waist radius and
zR is the Rayleigh range, as used in standard Gaussian theory.) In this setion, the
solutions we are referring to are always the +m or −m modes disussed in Appendix B,

and never mixtures of these, suh as the osine and sine modes disussed in the same

setion.

33

Figure 6: The (cid:28)eld in layers 0(cid:21)X for the mode at z1 = 0.63. The inset shows the

entire mode. The (cid:16)V(cid:17) nature of the mode has been lost as it has beome

more paraxial and more like the fundamental Gaussian. ReET everywhere lies
nearly in a single diretion at any instant (here it is in the x diretion). The
x-z plane is shown here, although the plots of Ex in any plane ontaining the
z axis are very similar. Here k = 8.2098 − ı0.0000401.

5.2.1. Paraxial Theory for Vetor Fields

From Gaussian theory, using the Laguerre-Gaussian (LG) basis, we expet that the

transverse eletri (cid:28)eld of any mode in the paraxial limit is expressible in the form:

N

ET =

A+
j

1
ı

+ A−
j

1
−ı

2j−N
min(j,N −j)(x).

LG

(83)

j=0h
X

(cid:16)

(cid:17)

(cid:16)

(cid:17)i

34

Here N ≥ 0 is the order of the mode. The A±

j are omplex oe(cid:30)ients and

and

1
ı

expliit forms of the normalized LG

are the Jones' vetors for right and left irular polarization, respetively. The

(cid:1)

(cid:0)
[15℄ as (cid:16)uLG
nm (cid:17)
(cid:0)
2j−N
with the substitutions n → N −j and m → j . The important aspets of the LG
min(j,N −j)
funtions are that the φ-dependene is exp(ı(2j − N)φ), and the ρ-dependene inludes
the fator L|2j−N |
p is a generalized Laguerre funtion and w(z) is

2j−N
min(j,N −j) funtions are given in Ref.

min(j,N −j)(2ρ2/w(z)2) where Ll

(cid:1)

the beam radius. In the paraxial limit the vetor eigenmodes of the same order beome

degenerate. There are 2(N + 1) independent vetor eigenmodes present in the expansion

1
−ı

(83).

Table 1: Vetor Laguerre-Gaussian modes.

Independent from the disussion above, ET = Eρ ˆρ + Eφ ˆφ an be written as

ET =

(Eρ + ıEφ)

eıφ

+

(Eρ − ıEφ)

e−ıφ

(84)

1
2

1
−ı

(cid:16)

(cid:17)

1
2

∝ exp(ımφ)

∝ exp(ımφ)

1
ı

.

(cid:16)

(cid:17)

Sine the Eρ and Eφ (cid:28)elds have a sole φ-dependene of exp(ımφ), omparing with (83)
and A+
reveals that, for a given m, at most two terms in (83) are present: the A−
j
j

{z

{z

|

|

}

}

′
−

′
+

35

terms where j

± = (N + m ± 1)/2. Expliitly,

′

(Eρ ± ıEφ)/2 ≈ A∓
j

′
±

m±1
[N +min(m±1,−m∓1)]/2.

LG

(85)

If the solution (84) has both terms nonzero for almost all x, the onstraints 0 ≤ j ≤ N
fore N to have a value given by N = |m| + 1 + 2ν, ν = 0, 1, 2, . . . . However, if only right
(left) irular polarization is present in the solution, N = |m|−1 is also allowed, provided
that m ≥ +1 (m ≤ -1). So, given a (paraxial) numerial solution with its m value, we

an determine whih orders the solutions an belong to. The reverse proedure, piking

N and determining whih values of m are allowed and how many independent vetor
solutions are assoiated with eah m, an be done by stepping j in (83) and omparing

with (84) or (85). The results for the (cid:28)rst four orders are summarized in Table 1. The

LG

and LG

1
ı

0
0

1
−ı

0
0
Sine the avity modes are not perfetly paraxial, the 2(N + 1)-fold degenerate modes
from the Gaussian theory are broken into N + 1 separate degenerate pairs. The truly
degenerate pairs for m 6= 0 of ourse onsist of a +m and a −m mode whih are related

(cid:0)

(cid:1)

(cid:0)

(cid:1)

modes are the fundamental Gaussian modes.

by re(cid:29)etion (see Appendix B). The pairings are shown in the last olumn of Table 1.

The dashed boxes in Table 1 enlose pairs of modes whih may be mixed in a single

solution for (cid:28)xed m (Eqn. (84)). Only the mixable m = 0 modes are exatly degenerate

and may be arbitrarily mixed. For the other mixable pairs, the degree of mixing will

be (cid:28)xed by the avity, in partiular by the struture of M1. We now disuss our results

regarding the mixing of the two modes with N = 2 and m = +1.

5.2.2. A demonstration of persistent mixing

Figure 7 shows the ross setions of two near-degenerate m = 1 modes found for a
onduting avity. Here z1 = ze = 0 and M2 is spherial with radius Rs = 70 but is
entered at z = −59.5 instead of the origin, so that R = 10.5. The paraxial parameter
h is at least as small as 0.1 (see the side views in the inset plots). Mode A orresponds

very well to the pure LG

mode, while mode B orresponds very well to the pure

2
0

1
−ı

(cid:0)

(cid:1)

0
1

1
ı

(cid:0)

(cid:1)

LG

mode. These are mixable modes, as indiated in Table 1, and the onduting

avity has (cid:16)hosen(cid:17) essentially zero mixing. Note that mode B would have zero overlap

with an inident fundamental Gaussian beam entered on the z axis, while mode A

would have nonzero overlap.

Pitures C and D in Figure 8 are ross setions of near-degenerate m = 1 modes for a

avity with stak II. To show that the transverse part of these modes are mixtures of A

and B, we have added and subtrated the solution vetors yA

and yB

to reate the new

(non-solution) vetors:

y

′ = yA + ηyB,

y

′ = yA − (0.225)ηyB,

(86)

C

D

and have plotted these (cid:28)elds (C

) using k = (kA + kB)/2. (The saling fator
η , here ≈ 0.07, is unphysial and related to the e(cid:27)et of the seed equation on overall

and D

′

′

′

′

amplitude.) Comparing C

and D

with C and D shows that we have reonstruted the

mode ross setions quite well (up to a onstant fator). Modes C and D are not pure

36

Figure 7: 8 × 8 µm ross setions of modes of a onduting avity near maximum
amplitude (z = 0.25). kA = 7.89285 and kB = 7.89290. The inset plots show
ReEx in the x-z plane with horizontal and vertial tik marks every 1 µm.

Hermite-Gaussian (HG) modes, but their resemblane to the HG02 and HG20 modes is

not an aident. Mode onversion formulas in Ref.

[15℄ show that LG

HG02 , HG11 , and HG20 modes while LG

0
1 ontains only HG02 and HG20 . Note that both

2
0 is made of the

modes C and D would ouple to a entered fundamental Gaussian beam.

An interesting property of the mixed modes C and D is that their general forms

appear to be persistent as h is varied, provided that the paraxial approximation remains

su(cid:30)iently appliable. Furthermore, we do not have to be partiularly areful about

setting λs to orrespond very losely to 2π/Rek . The modes shown in Figure 9 are not
nearly as paraxial as the C and D modes. Here ks = 8.1600 whih is not lose to the
k values of the modes. Furthermore, stak I was used whih is missing the spaer layer

of stak II. Nevertheless the modes of Fig. 9 bear a strong resemblane to the more

arefully piked C and D modes.

5.3. Modes with m 6= 1

The m = 0 modes may be irularly polarized, suh as the paraxial m = 0 modes of
Table 1. The more interesting polarization, perhaps, is the m = 0 analogue of x and y

polarization: radial and azimuthal polarization. The mode shown in Fig. 10 is radially

polarized, although it is impossible to tell this from the plots beause the left and right

irularly polarized modes are radial (idential to the plot) at t = 0 and azimuthal
(like a vortex) at ωt = π/2. The radial or azimuthal polarizations are easier to obtain

numerially than the right or left polarizations beause radially (azimuthally) polarized

modes have all of the bl (al ) MB oe(cid:30)ients equal to zero and thus an be seleted by

the seed equation (see Appendix B).

37

Figure 8: Cross setions of true modes (C and D) of a avity with stak II near maximum

′

′

amplitude (z = 0.05), and onstruted modes (C
amplitude (z = 0.25). The onstruted ross setions are nearly idential to
the true ross setion. kC = 7.74685−ı0.00005415, kD = 7.74680−ı0.00005516,
′ = 7.8929, the average of kA
and the onstruted modes are plotted with k
and kB
. The inset plots show ReEx in the x-z plane. The stak parameters
are Ns = 22 and ks = 7.746814.

/D

′

and D

) near their maximum

C

38

Figure 9: Cross setions of neighboring, poorly paraxial modes near maximum am-

plitude (z = 1.33). M2 is spherial and origin-entered with R = 10. M1
is stak I with Ns = 20, ks = 8.1600, and z1 = ze = 1.0. The mode
on the left has k = 8.51160 − ı0.0002491 and the mode on the right has
k = 8.51540 − ı0.0003184.

1
Figure 11 shows a m = 2 mode that orresponds to the LG
1

1
ı

2
theory. We also have ompleted the N = 2 near-degenerate family by (cid:28)nding the LG
0
(m = 3) mode for both the avity used in Fig. 7 (k = 7.8926 ≈ kA ≈ kB ) and the avity
(cid:1)
used in Fig. 8 (k = 7.7466−ı0.00005466 ≈ kC ≈ kD ). The ross setions of this mode for

(cid:0)

(cid:1)

(cid:0)

1
ı

mode from Gaussian

the two avities, whih are not shown to onserve spae, appear idential, as predited

by the absene of a m = +3 near-degenerate partner for this mode (Table 1).

5.4. Ndirs

and lmax

: Comparing the Two Primary Methods

The authors of this paper (cid:28)rst implemented the more ompliated two-basis method,

believing that many more PWB oe(cid:30)ients than MB oe(cid:30)ients would be required to

expand dome-shaped avity (cid:28)elds. When the Bessel wave method was implemented as

a hek, it was disovered that the PWB works surprisingly well, with usable values

being of the same order of magnitude as usable values of lmax

of Ndirs
of seed equation, Ndirs
narrowness of the dips in the graph of ∆r versus Rek . This makes it di(cid:30)ult to perform

or lmax

, and other parameters an both a(cid:27)et the depth and

. The hoie

a omprehensive and onlusive omparison of the two methods.

One pratial problem with the Bessel wave method is that its performane is some-

times quite sensitive to the value of Ndirs
funtion too high results in a failure to solve for ybest

. In both methods, setting the number of basis

; the program ats as if Ay = b

were underdetermined, even though the number of equations is several times the num-

39

Figure 10: Tightly foused, radially polarized m = 0 modes of a onduting avity.
The fousing has aused Ez to be greater than the Eρ . The spot size of the
dominant Ez (cid:28)eld for suh modes an be surprisingly small, as has reently

been demonstrated experimentally by Dorn et al.[4℄ (for a foused beam with

no avity). Parameters of the non-inset avity and mode are R = 10, z1 =
0.05, and k = 7.2481 (λ = 0.867). The ross setion is at z = 0.3. The insets
show the mode after it was followed to the perfetly hemispherial z1 = 0
avity shape; here the mode has an even smaller entral spot and Ez ≫ Eρ .

We expet a hemispherial mode to have only a single nonzero MB oe(cid:30)ient

and this was veri(cid:28)ed by the solution: a1 = 1.0 and |al| < 1.1 × 10−7
The hemispherial mode has k = 7.2243 (λ = 0.870).

for l 6= 1.

ber of unknowns. When inreasing lmax
toward its problemati value, the ∆r
values for al l k dramatially derease, sharply lowering the ontrast needed to loate
the eigenvalues of k . The solutions that are found begin to attempt to set the (cid:28)eld to

or Ndirs

zero in the entire avity region, with some regions of layer 0 outside the avity having

(cid:28)eld intensities that are orders of magnitude larger than the (cid:28)eld inside the avity. In

our experiene this problem has not ourred in the two-basis method for lmax
semilassial limit of l, Re(kR), and thus has never been a pratial annoyane. On the
. Yet taking Ndirs
other hand, the problem an our at surprisingly low values of Ndirs

near the

to be too low an often ause solutions to simply not be found: dips in the graph of

∆r vs. Rek an simply disappear. The window of good values of Ndirs
as narrow as Ndirs/10. The window of good lmax
wider (for many modes, it is su(cid:30)ient to take lmax

values for the MB seems to be muh

to be half of Re(kR) or less). In this

an be at least

respet, the two-basis method is easier to use than the Bessel wave method.

On the other hand, there were situations when a san of ∆r versus Rek with the

Bessel wave method revealed a mode that was skipped in the same san with the two-

40

Figure 11: A m = 2 mode for a onduting avity (k = 7.885463). M2 is spherial and
origin-entered with R = 10. M1 is a ondutor; z1 = 1.0. The inset shows
ReEx in the x-z plane.

basis method, due to the narrowness of the dip feature. To the best of our reolletion,

we have always been able to (cid:28)nd a mode by both methods if we have made an e(cid:27)ort to

searh for it.

A diret omparison of the methods by looking at the solution plots rarely reveals (cid:28)eld

value di(cid:27)erenes greater than 1% of the maximum value when the modes are restrited

to those that do not have a large high-angle omponent. The eigenvalues of k loated

by the two methods are usually quite lose. Here we show one ase in whih there is a

small but visible di(cid:27)erene between the mode plots for the Bessel wave method and the

two-basis method.

41

Figure 12: Top: Solution obtained with Bessel wave method. k = 8.57073 − ı0.05857;
k ), not
k ). Bottom: Solution obtained with two-basis method. k = 8.57086 −

k distribution is uniform in ∆(sin α(0)

, Ndirs = 30; α(0)

∆n = 2.8 × 10−5
∆(α(0)
ı0.05900; ∆n = 2.9 × 10−5

; lmax = 86. The (cid:28)eld in layer X is not plotted.

Figure 12 shows Ex in the x-z plane for a mode in a avity with n0 = 1.0 and nX = 0.5

and no stak layers at all. This situation is meant to model a dieletri-(cid:28)lled dome avity

surrounded by air. (Our program assumes that layer 0 is free spae (n0 = 1), so we have
set nX < n0 to ahieve this e(cid:27)et.) Here M2 is spherial and entered at the origin with
R = 10 and ze = z1 = 0.5. The reason for the disagreement between the two methods

for this ase is not known. This was the only low (cid:28)nesse avity we have tried, as well

as being the only avity with a (cid:16)high(cid:17) index of refration in layer 0. Another unusual

property of this mode solution, whih looks similar to a fundamental Gaussian, is that its

eletri (cid:28)eld in the x-y plane atually spirals: its instantaneous linear diretion rotates
with z as well as with t. The other modes we show throughout the demonstrations

setion give extremely good agreement between the two primary methods.

In our implementation, omputation time to set up and solve Ay = b is of the same

order for the Bessel wave method and the two-basis method (with variant 1). For the

large avity shown in Fig. 3, the Bessel wave method took about 10 s with Ndirs = 100
and about 600 loations hosen on M2. Variant 1 with lmax = 200, 600 M2 loations,
and 600 uniformly spaed α(0)
2 hours (ahieving a 10−6

k , took about 15 s. For omparison, Variant 2 took about

relative auray for eah α(0)
k

integral).

42

5.5. Almost-Real MB Coe(cid:30)ients

When M1 is a ondutor we (cid:28)nd that the imaginary parts of al and bl are essentially

zero. Furthermore, we often (cid:28)nd that for dieletri M1 mirrors, the imaginary parts of

al and bl are one or more orders of magnitude smaller than their real parts. We show

one way in whih this tendeny simpli(cid:28)es the interpretation of mode polarization in

Appendix B.

There is a an argument that suggests that al and bl should be real for a onduting
avity. A onduting avity has a real eigenvalues, k , and real re(cid:29)etion funtions,
rs/p = −1.
It is not di(cid:30)ult to see that for real k the three types of M2 equations,
Eφ = 0, Ek = 0, and H⊥ = 0, an be satis(cid:28)ed with real al and bl . The seed equation of

ourse an also be hosen so that it an be satis(cid:28)ed by real variables. The M1 equations,

beause of the omplex nature of ¯rs/p = rs/p exp(−ı2z1kn0 cos α(0)
k ) when z1 6= 0, are not
obviously satis(cid:28)ed by real al and bl . However, for a onduting avity, the M1 boundary

ondition an be given as a real spae boundary ondition (like M2) instead of a Fourier

spae boundary ondition. In this ase, loations on M1 are hosen just as they are on

M2. The same argument that the M2 equations an be satis(cid:28)ed by real al and bl now

applies. Thus the M1 boundary ondition for a onduting avity should not, in any

basis, fore al and bl to be omplex.

6. Conlusions

The two methods presented in this ommuniation have proved to be useful tools for

modeling small optial dome-shaped avities. As yet we have no general verdit on whih

method is best. Overall, it was quite helpful to have both methods available for (cid:28)nding

all of the modes. One a mode was found, agreement of both eigenvalue and eigenmode

between the two methods was quite good.

The primary advantage of both of these methods is the treatment of the dieletri

stak through its transfer matries. First of all, inluding the dieletri stak in the

model is essential to obtain a number of qualitative features of the modes. A model

with a mirror of onstant phase shift is inadequate, exept in speial ases suh as the

fundamental Gaussian mode in its paraxial regime. In addition, inluding the stak in

the model allows one to alulate the (cid:28)eld inside the stak, whih may be the loation of

interest for the engineer of an optial devie. Seondly, the use of the transfer matries is

the most natural way to inlude a dieletri stak that is of large lateral extent ompared

to the wavelength. The only alternative that we know of would involve a separate basis

for eah stak layer, resulting in an inrease of both dimensions of the matrix A by about
N times, where N is the number of stak layers.

Another advantage of the methods we have presented is their speed. Eah point in

Fig. 5, whih was generated in a few hours or less, required Ay = b to be onstruted
and solved 20(cid:21)60 times for a avity with R ≈ 50λ. The ombination of using a basis

expansion method, taking advantage of ylindrial symmetry, using one basis set for all

the layers, avoiding numerial integrals, and using C++ inline funtions for omplex

43

arithmeti has resulted in a fast implementation.

Several (cid:16)stak-indued(cid:17) e(cid:27)ets that we have demonstrated here will be more thor-

oughly treated in a separate publiation. The splitting of the fundamental Gaussian

(and other Gaussian modes) into a non-axisymmetri (cid:16)V(cid:17) shape may be of pratial

interest to workers who wish to ahieve a tight fous. The m = 0 modes, whih have

the greatest potential for tight fousing, are also of interest. The ability to analyze the

persistent stak-indued mixing is a result that stands in its own right. This stak e(cid:27)et

persists arbitrarily far into the paraxial limit; it exists as long as the resonane widths of

both the avity and the laser soure are smaller than the splitting of the near-degenerate

pair. This e(cid:27)et should exist for a wide range of avity lengths, and is of interest to

anyone engineering higher-order Gaussian modes.

Perhaps the greatest limitation to the pratial appliation of our methods is its rigid

treatment of the urved mirror as a ondutor. As mentioned in the Introdution, it is

reasonable to expet highly foused modes, suh as those shown in Figs. 3, 6 and 10, to

undergo little hange when the urved onduting mirror is exhanged for a dieletri

one (with an appropriate hange of mirror radius by −λ/4 < δ < λ/4 to aount for a

phase shift). This is beause the loal wave fronts are primarily perpendiular to the

urved mirror for suh modes (imagine a Wigner funtion evaluated at the surfae of

M2). For paraxial geometries suh as those in our disussion of stak-indued mixing,

this argument says nothing about how replaing M2 with a urved dieletri stak will

a(cid:27)et the modes. A pursuit of this question may require a more brute fore approah.

Despite all limitations, we (cid:28)nd our methods to be extremely versatile and powerful

(fast and allowing for relatively large avities). The full vetor eletromagneti (cid:28)eld is

used. Exatly degenerate modes an be separated. The shape of the urved mirror is

arbitrary and we have implemented paraboli shapes as well as spherial shapes with

no di(cid:30)ulties. A (cid:28)rst-try san of ∆r versus Rek using either method with a non-

ontrived seed equation will loate the vast ma jority of modes that exist. Reasonable

results are obtained when the interior of the avity is a dieletri. Hopefully, the expliit

development of the two methods given here an bene(cid:28)t a number of workers in optis-

related (cid:28)elds.

Note Added in Proof

We note that we have not found signi(cid:28)ant stak-indued e(cid:27)ets (the V mode of Setion

5.1 and the mixing of Setion 5.2) for a (cid:16)standard(cid:17) quarter-wave dieletri stak whih has

design ABAB. . .AB with front surfae A and nA > nB . If nA < nB , we do (cid:28)nd both types
of stak-indued e(cid:27)ets. The standard (nA > nB ) quarter-wave layer struture exhibits
less variation in arg(rs/p(αk)) than our mirrors (f. Fig. 15), and therefore behaves muh

like a perfet ondutor exept at high angles of inidene. The methods presented here,

whih model the urved dome mirror (M2) as a ondutor, should therefore arry over

to standard dieletri M2 mirrors. The planar mirror will in general have a (cid:16)funtional(cid:17)

layer design, leading to the stak-indued e(cid:27)ets reported above.

44

Aknowledgments

We would like to thank Prof. Mihael Raymer for getting us interested in the realisti

avity problem. This work is supported by the National Siene Foundation through

CAREER Award No. 0239332.

A. Further Explanations and Limitations of the

Model

A.1. Exlusion of High-Angle Plane Waves

As mentioned in the Introdution, in the usual appliation of a basis expansion method,

the (cid:28)eld is expanded in eah dieletri region separately and heneforth eah region gets

its own omplete basis and its own set of oe(cid:30)ients. However, our methods, when (cid:16)ast(cid:17)

into the PWB, use a single set of plane waves, omplete in layer 0, whih are propagated

down into the other layers via the transfer matries. There are several advantages to this

approah. The Bessel wave method beomes simpler, as there are far fewer unknowns.

This approah is also ideal for inorporating the use of the MB for layer 0, as in the

two-basis method, although a straightforward use of the MB for layer 0 and a separate

PWB for eah layer q , q > 0, ould be implemented.

One drawbak to our approah is that ertain high-angle or evanesent plane waves

are not inluded. No plane wave basis vetors are allowed for whih nq sin θ(q)

k > n0 . If

the true quasimode expansion in any layer has signi(cid:28)ant weight for these high-angle or

evanesent waves, the alulated solution of the (cid:28)eld ould be erroneous.

Probably the best way to determine whether or not suh intrinsi error is present at

a signi(cid:28)ant level is to look at the plane wave distribution in layer 0 (using (58) or (82)

to get this if one is using the two-basis method) and to see whether the distribution dies

o(cid:27) as α(0)

k approahes π/2. If it does, the solution should be reasonably error free.

We note here that Berry [16℄ has shown how evanesent waves, in a (cid:28)nite region near

the origin, an be expressed in the PWB (using plane waves with real-valued diretions,

as usual). Thus the fat that no evanesent waves are inluded in layer 0 may not be a

problem in itself for depiting the (cid:28)eld in layer 0.

A.2. The Hat Brim

A.2.1. The in(cid:28)nitesimal hat brim

For the vetor (cid:28)eld solution, a tiny hat brim must be added to M2 to orretly model

a onduting edge. Figure 13 shows a ross setion of the edge of M2 for inreasingly

better approximations of a real onduting mirror. In (a), Eρ an be nonzero at the
edge, whih is unphysial. In (b), a small hat brim has been added and E = 0 at the

inside edge, as it should be. In (), loations are hosen on a (losed) ondutor with

(cid:28)nite thikness. As the thikness of M2 beomes insigni(cid:28)ant ompared to λ, model (b)

45

Figure 13: Modeling the edge of the dome.

should approximate model () arbitrarily losely. Usually 2(cid:21)10 loations are hosen on

the hat brim (the density of ourse is muh greater on the hat brim than on the dome).

We have taken ωb ≈ 0.0001µm for our demonstrations.

A.2.2. The in(cid:28)nite hat brim and the 1-D half-plane avity

The way in whih our model inludes the interior of the avity and the entire z > z1

half-plane in a single region, layer 0, is somewhat unorthodox. We believe our method

produes the orret (cid:28)eld in a (cid:28)nite region surrounding the avity, but not at z → ∞.

A somewhat less strange model is obtained if one imagines an in(cid:28)nite hat brim. The

upper half-plane is then no longer in the problem. Layer 0 still extends in(cid:28)nitely in ρ

as do the other layers, but the vertial on(cid:28)nement makes it easier to see that this is

an eigenproblem and not a sattering problem. Unfortunately our implementation does

not allow an in(cid:28)nite hat brim (unless M1 is a ondutor and ze = z1 , for whih the hat

brim ondition is already set in the M1 equations). At least for some solutions, taking

wb ≈ R and giving the hat brim roughly the same number of loations as the dome,

produes no visible hanges in the mode struture (from the solution obtained with a

tiny hat brim). The mode shown in Fig. 3 is one of these.

If we allow that some solutions are not a(cid:27)eted by the value of wb , we an take the

in(cid:28)nite hat brim more seriously. The problem beomes similar in some respets to the

1-D half-plane problem, in whih x < 0 is a ondutor, x > L has a onstant refrative
index, and the [0, L] region is segmented into several 1-D dieletri layers. The solutions

of the 1-D problem form a set of quasimodes, (or quasinormal modes), whih are omplete

in [0, L] and obey an orthogonality ondition on the same interval. The onditions for

ompleteness, and the haraterization of the inompleteness of the quasinormal mode

for problems whih do not meet the ompleteness onditions, are disussed in Ching et

al. [17℄ and Leung et al. [18℄. The model with the in(cid:28)nite hat brim does not rigorously

meet the the ompleteness ondition (for 3-D avity resonators). We note that it appears

from the referenes mentioned above that the situation depited in Fig. 14 would meet

the ompleteness ondition, with the quasinormal modes being omplete in layers 0(cid:21)
N . We do not attempt to resolve this further, as the use of our mode solutions as a

basis for time-dependent problems is beyond the sope of what we have been trying to

46

Figure 14: Inluding the sides of the stak at radius ρ(cid:28)nite

.

aomplish.

B. Negative m Modes and Sine and Cosine Modes

The ylindrial symmetry group onsists of φ-rotations and re(cid:29)etions about the x-z or
y -z planes. For solutions with a (cid:28)xed, nonzero m, rotations are equivalent to multiplying

the (cid:28)eld by a omplex phase, whih is of ourse equivalent to a translation in time. (This

means that, when looking at any ross setion plot in Setion 5 for a (cid:28)xed m 6= 0, the time
evolution an be realized by simply rotating the (cid:28)gure: ounter-lokwise for m > 0 and
lokwise for m < 0.) Thus we say that for m 6= 0, re(cid:29)etions generate a new solution but

rotations do not. (If we were onsidering the sine and osine modes disussed later in the

setion, instead of the ±m modes, we would say that a π/(2m) rotation generates a new

solution but a re(cid:29)etion does not.) Hene the symmetry of the avity auses modes to

ome in truly degenerate pairs. It an be shown that a re(cid:29)etion is equivalent to taking

m to −m (up to a π rotation). For m 6= 0, general omplex linear superpositions of the
±m pair of modes are equivalent to arbitrary omplex superpositions of any number of
φ-rotations, re(cid:29)etions, and ombinations of these ating on a single +m mode. We note
that sine our methods solve y for a (cid:28)xed m, we are able to separate the ±m pairs.

The m = 0 modes also ome in degenerate pairs, but the interrelation an be more
ompliated than a re(cid:29)etion. The m = 0 pairs an be separated easily in the two-basis
method by hoosing a seed equation that ontains only al or only bl oe(cid:30)ients, sine
the M1 and M2 equations do not ouple al and bl oe(cid:30)ients if m = 0. Thus all of the

true (non-aidental), exat (not obtained only in a limit, suh as the paraxial limit)

degeneraies that exist an be separated.

In onstruting the M1 and M2 equations, it is easiest to write ode that assumes

that m ≥ 0. For presentations and movies, it is nie to be able to plot both +m and

47

−m solutions, as well as the linear ombinations adding and subtrating these modes.
All four of these modes an be plotted from a solution y+m that has been been found
using the positive azimuthal quantum number +m. Here we brie(cid:29)y disuss how to do
this (for m 6= 0).

B.1. Plotting with -m

To plot the −m modes, we use simple rules, allowed by the M1 and M2 equations, to
reate a new solution vetor y−m from the solution y+m . To obtain the (cid:28)eld, the new
oe(cid:30)ients from y−m are simply inserted into the various expansion (or basis onversion)
equations from Setions 3 and 4, using (−m) as the (cid:16)m(cid:17) argument in these equations.
(All of these equations work for negative values of their m argument.) The relations
lm , J−m = (−1)mJm , fl,−m = (−1)mflm , and gl,−m = −(−1)mglm are
Yl,−m = (−1)mY ∗

useful. The rules for the new solution vetors are given in Table 2. (There is a ertain

arbitrariness to these rules, sine (αy), with α being an arbitrary onstant, satis(cid:28)es the

M1 and M2 equations.)

Table 2: Rules for taking y+m → y−m .

salar:

vetor:

PWB

MB

ψu,−m = (−1)mψu,+m
Su/d,−m = −(−1)mSu/d,+m
Pu/d,−m = (−1)mPu/d,+m

cl,−m = cl,+m
al,−m = al,+m
bl,−m = −bl,+m

B.2. Plotting osine and sine modes

We an de(cid:28)ne the (cid:16)osine(cid:17) and (cid:16)sine(cid:17) modes as X(c) ≡ (X(+m) + (−1)mX(−m))/2, and
X(s) ≡ (X(+m) − (−1)mX(−m))/2, where X stands for ψ , E , or H . By adding expliit
expansion expressions for the +m and −m modes, one an obtain expressions for X(c)
and X(s) . For example, using (61), (62), and the above rules one (cid:28)nds that

E(0)

(c) (x, t) = e−ıωt

al

−l(l + 1)
kn0r

jlReYlm

(cid:21)

−1
kn0r

∂
∂r

∂
∂θ

ˆr
Xl (
(cid:20)
+ ˆθ
al
(cid:20)

(rjl)

(ReYlm) + bl

jlReYlm

−m
sin θ

al

+ ˆφ
(cid:20)

m
kn0r sin θ

∂
∂r

(rjl)ImYlm + bljl

(ImYlm)

,
(cid:21))

(cid:21)

∂
∂θ

where al and bl ome from the original y+m . When al and bl are predominately real

(see Setion 5.5), we an see from the above equation that the real-valued physial (cid:28)elds

Eρ and Ez are proportional to cos mφ cos ωt while Eφ is proportional to sin mφ cos ωt.

48

(The osine time-dependene of E is why we all this the osine mode.) Thus for the
osine mode with |m| = 1, the transverse portion of E has an average linear polarization
along the x axis (note hEyiφ = 0 ∀t), as opposed to the average irular polarization
(For the m = +1 mode, hE · ˆqiφ = 0 ∀t where
the m = ±1 modes would have.
ˆq ≡ − ˆx sin ωt + ˆy cos ωt.) Due to their separating of time and φ-dependene for the

physial (cid:28)elds, the sine and osine modes are very useful (cid:28)nal forms of the (cid:28)eld (when

al and bl are predominately real).

C. Staks used in Setion 5

Staks I and II are similar to Al1−xGaxAs(cid:21)AlAs staks that Raymer has used experimen-

tally [8℄. Figure 15 shows the re(cid:29)etion phases for stak II. The stak parameters that

are varied in our demonstrations are Ns and ks ≡ 2π/λs . The meaning of these param-

eters an be inferred from the stak de(cid:28)nitions below. The normal re(cid:29)etion oe(cid:30)ient

for stak II with Ns = 20 is |rs/p(αk = 0)| = 0.9964. For Ns = 22, |rs/p| = 0.9981.

Figure 15: Plane wave re(cid:29)etion phases (rad.) of stak II (Ns = 20) as a funtion of αk

(deg.). The solid (dashed) line is for s (p) polarization. The wavelength of

the plane wave, λtest

, is set at λs . The graph for stak I is similar.

Stak I: n0 = nX = 1; n1 = n3 = . . . = n(2Ns−1) = 3.003; n2 = n4 = . . . = n(2Ns) =

3.51695. Layers 1(cid:21)(2Ns) are quarter-wave layers (optial thikness = λs/4).

Stak II: n0 = nX = 1; n1 = n3 = . . . = n(2Ns+1) = 3.51695; n2 = n4 = . . . = n(2Ns) =
3.003. Layers 2(cid:21)(2Ns + 1) are quarter-wave layers. Layer 1 is a spaer layer that has
optial thikness 1λs .

49

Referenes

[1℄ P. L. Greene and D. G. Hall, (cid:16)Foal shift in vetor beams(cid:17), Opt. Expr. 4 (1999) 411.

[2℄ P. L. Greene and D. G. Hall, (cid:16)Properties and di(cid:27)ration of vetor Bessel-Gauss

beams(cid:17), J. Opt. So. Am. A 15 (1998) 3020.

[3℄ C. J. R. Sheppard and P. Török, (cid:16)E(cid:30)ient alulation of eletromagneti di(cid:27)ration

in optial systems using a multipole expansion(cid:17), J. Mod. Opt. 44 (1997) 803.

[4℄ R. Dorn, S. Quabis, and G. Leuhs, (cid:16)Smaller, sharper fous for a radially polarized

light beam(cid:17), Phys. Rev. Lett. 91 (2003) 233901.

[5℄ J. U. Nökel, G. Bourdon, E. Le Ru, R. Adams, I. Robert, J-M. Moison, I. Abram,

(cid:16)Mode struture and ray dynamis of a paraboli dome miroavity(cid:17), Phys. Rev. E

62 (2000) 8677.

[6℄ J.U. Nökel and R.K. Chang, (cid:17)2-d Miroavities: Theory and Experiments(cid:17), in

Cavity-Enhaned Spetrosopies, Roger D. van Zee and John P. Looney, eds. (Exper-

imental Methods in the Physial Sienes 40), Aademi Press, San Diego (2002),

185(cid:21)226.

744(cid:21)76.

ation).

[7℄ A. E. Siegman, Lasers, University Siene Books, Sausalito, CA, 1986, pp. 626(cid:21)97,

[8℄ M. G. Raymer (olloquium, University of Oregon, 4/24/03, and private ommuni-

[9℄ M. Aziz, J. Pfei(cid:27)er, and P. Meissner, (cid:16)Modal Behaviour of Passive, Stable Miro-

avities(cid:17), Phys. Stat. Sol. (a) 188 (2001) 979.

[10℄ J. D. Jakson, Classial Eletrodynamis, Third Edition, John Wiley & Sons, In.,

New York, 1999, pp. 107(cid:21)10, 113(cid:21)4, 426(cid:21)32, 471(cid:21)73.

[11℄ P. Yeh, Optial waves in layered media, Wiley, New York, 1988, pp. 60(cid:21)64, 102(cid:21)15.

[12℄ W. H. Press, S. A. Teukolsky, W. T. Vetterling, B. P. Flannery, Numerial Reipes

in C: The Art of Sienti(cid:28) Computing, Seond Edition, Cambridge University Press,

Cambridge, 1992, pp. 59(cid:21)70, 359(cid:21)62.

[13℄ G. B. Arfken and H. J. Weber, Mathematial Methods for Physiists, Fifth Edition,

Harourt Aademi Press, San Diego, 2001, p. 767.

[14℄ G. Videen, (cid:16)Light Sattering from a partile on or near a perfetly onduting

surfae(cid:17), Optis Communiations 115 (1995) 1.

[15℄ M. W. Beijersbergen, L. Allen, H. E. L. O. van der Veen, and J. P. Woerdman,

"Astigmati laser mode onverters and transfer of orbital angular momentum".

Optis Communiations 96 (1993) 123.

50

[16℄ M. V. Berry, (cid:16)Evanesent and real waves in quantum billiards and Gaussian beams(cid:17),

J. Phys. A: Math. Gen. 27 (1994) L391.

[17℄ E. S. Ching, P. T. Leung, A. Maassen van den Brink, W. M. Suen, S. S. Tong, K.

Young, (cid:16)Quasinormal-mode expansion for waves in open systems(cid:17), Rev. Mod. Phys.

70 (1998) 1545.

[18℄ P. T. Leung, S. Y. Liu, and K. Young, (cid:16)Completeness and orthogonality of quasi-

normal modes in leaky optial avities(cid:17), Phys. Rev. A 49 (1994) 3057.

51

