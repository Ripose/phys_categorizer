5
0
0
2
 
r
p
A
 
3
1
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
8
8
0
4
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Light propagation in ﬁnite and inﬁnite photonic crystals: The recursive Green’s
function technique.

A. I. Rahachou and I. V. Zozoulenko
Department of Science and Technology, Link¨oping University 601 74, Norrk¨oping, Sweden
(Dated: January 27, 2014)

We report a new computational method based on the recursive Green’s function technique for
calculation of light propagation in photonic crystal structures. The advantage of this method in
comparison to the conventional ﬁnite-diﬀerence time domain (FDTD) technique is that it computes
Green’s function of the photonic structure recursively by adding slice by slice on the basis of Dyson’s
equation. This eliminates the need for storage of the wave function in the whole structure, which
obviously strongly relaxes the memory requirements and enhances the computational speed. The
second advantage of this method is that it can easily account for the inﬁnite extension of the
structure both into the air and into the space occupied by the photonic crystal by making use of
the so-called “surface Green’s functions”. This eliminates the spurious solutions (often present in
the conventional FDTD methods) related to e.g. waves reﬂected from the boundaries deﬁning the
computational domain. The developed method has been applied to study scattering and propagation
of the electromagnetic waves in the photonic band-gap structures including cavities and waveguides.
A particular attention has been paid to surface modes residing on a termination of a semi-inﬁnite
photonic crystal. We demonstrate that coupling of the surface states with incoming radiation may
result in enhanced intensity of an electromagnetic ﬁeld on the surface and very high Q factor of the
surface state. This eﬀect can be employed as an operational principle for surface-mode lasers and
sensors.

PACS numbers: 42.70.Qs, 41.20.Jb, 78.67.-n

I.

INTRODUCTION

Optical microcavities and photonic crystals (PC) have
received increased attention in recent years because of
the promising prospects of applications in future gener-
ation of optical communication networks1,2. Examples
of successfully demonstrated devices include lasers, light
emitting diodes, waveguides, add-drop ﬁlters, delay lines,
and many other3.

By far the most popular method for the theoreti-
cal description of light propagation in these systems is
the ﬁnite-diﬀerence time-domain method (FDTD) intro-
duced by Yee4. The success of the FDTD method is due
to its speed, ﬂexibility and ease of computational storage
requirements. The limitation of the FDTD technique is
related to the fact that the computational domain is ﬁ-
nite. As the result, an injected pulse experiences spurious
reﬂections from the domain boundaries, which leads to
mixing between the incoming and reﬂected waves.
In
order to overcome this limitation the so-called perfectly
matched layer condition has been introduced5. However,
even with this technique, a sizable part of the incoming
ﬂux can still be reﬂected back6. In many cases the sepa-
ration of spurious pulses is essential for the interpretation
of the results, and this separation can only be achieved
by increase of a size of the computational domain7. This
may lead to a prohibitive amount of computational work,
because the stability of the FDTD algorithm requires a
suﬃciently small time step.

The problem of the spurious reﬂections from the com-
putational domain boundaries does not arise in the meth-
ods based on the scattering matrix technique, where the

incident and outgoing ﬁelds are related with the help of
the scattering matrix8–12. Other approaches where the
spurious reﬂections are avoided include e.g. a multiple
multipole method13, and a Green’s function method14
based on the analytical expression for the Green’s func-
tion for an empty space. The main objective of the
present paper is to present a novel computational ap-
proach based on the recursive Green’s function technique
that can account for an inﬁnite extension of a photonic
crystal. In this technique the Green’s function of the pho-
tonic structure is calculated recursively by adding slice
by slice on the basis of Dyson’s equation. In order to ac-
counts for the inﬁnite extension of the structure both into
the air and into the space occupied by the photonic crys-
tal we make use of the so-called “surface Green’s func-
tions” that propagate the electromagnetic ﬁelds into in-
ﬁnity. In this paper we present a method for calculation
of the surface Green’s functions both for the case of a
semi-inﬁnite homogeneous dielectrics, as well as for the
case of a semi-inﬁnite periodic structure (photonic crys-
tal). This makes it possible to apply the Green’s func-
tion technique for investigation of a variety of important
structures including waveguides and cavities in inﬁnite
or semi-inﬁnite photonic crystals, as well as to study the
eﬀect of the surface states and the coupling of waveguide
Bloch modes to the external radiation. Note that the
recursive Green’s function technique is widely used for
quantum mechanical transport calculations15,16

The article is organized as follows.

In Section II we
present a general formulation of the problem. A descrip-
tion of the recursive Green’s function technique is given
in Section III. This section also provides a recipe for the
calculation of Bloch states in a periodic structure as well

as the surface Green’s function. Technical details of the
calculations are given in the Appendices A,B. Several ex-
amples of the application of the developed method are
given in Section IV. The conclusions are presented in
Section V.

II. GENERAL FORMULATION OF THE
PROBLEM

We start with Maxwell’s equations in two dimensions

E(r) =

E(r)

(1)

εr(r) ∇ × ∇ ×

1

1

ω2
c2
ω2
c2

∇ × (cid:26)

εr(r) ∇ ×

(cid:27)

H(r)

=

H(r),

∇

= ∂

∂x i + ∂

∂y j, εr(r) is the
where r = xi + yj,
relative dielectric constant, and the electric and mag-
iωt), H(r, t) =
netic ﬁeld vectors E(r, t) = E(r) exp(
H(r) exp(
iωt). If the dielectric constant εr(r) is inde-
pendent on z, the Maxwell’s equations decouple in two
sets of equations for the TE modes (Hz, Ex, Ey),

−

−

1
εr

∂
∂y

Hz +

ω2
c2 Hz = 0,

(2)

and for the TM modes (Ez, Hx, Hy),

∂2Ez
∂y2 (cid:19)

+

ω2
c2 Ez = 0,

(3)

∂
∂x

1
εr

Ex =

Hz +

∂
∂x
i
ωε0εr
i
ωε0εr

∂
∂y
∂Hz
∂y
∂Hz
∂x

,

,

Ey = −

1
εr (cid:18)

∂2Ez
∂x2 +
i
ωµ0
i
ωµ0

∂Ez
∂y
∂Ez
∂x

,

.

Hx = −

Hy =

Let us rewrite the equations for Hz, Ez (2), (3) in an

operator form2

Lf =

2

ω
c (cid:17)

f

(cid:16)
where the Hermitian diﬀerential operator L and the func-
tion f reads,

and

TE modes: f

Hz, LT E =

≡

∂
∂x

1
εr

∂
∂x −

∂
∂y

1
εr

∂
∂y

,

−

(4)

(5)

(6)

the following discretization of the diﬀerential operators in
Eqs. (5),(6)17,

a2 ∂
∂x
a2 ∂2

∂f (x)

ξ(x)

∂x →

ξm+ 1

2

(fm+1 −

fm)

−

ξm− 1

2

(fm

−

fm−1)

∂x2 ξ(x)f (x)

ξm+1fm+1 −

→

2ξmfm + ξm−1fm−1

we arrive to the ﬁnite diﬀerence equation

vm,nfm,n

um,m+1;n,nfm+1,n

um,m−1;n,nfm−1,n

−

−

um,m;n,n+1fm,n+1 −

−

um,m;n,n−1fm,n−1 = k2fm,n,

where the coeﬃcients v, u are deﬁned for the cases of TE
and TM modes as follows

TE modes: fm,n = Hz mn; ξm,n =

,

1
εr m,n
2 ,n + ξm,n+ 1
2 ,n + ξm− 1
2 ,n, um,m−1;n,n = ξm− 1

+ ξm,n− 1
2 ,n,
;
, um,m;n,n−1 = ξm,n− 1

2

2

2

(9)

,

vm,n = ξm+ 1
um,m+1;n,n = ξm+ 1
um,m;n,n+1 = ξm,n+ 1

2

TM modes:fm,n = √εr m,nEz mn; ξm,n =

1
√εr m,n

(10)

vm,n = 4ξ2

m,n,

um,m+1;nn = ξm,nξm+1,n, um,m−1;nn = ξm−1,nξm,n,
um,m;n,n+1 = ξm,n+1ξm,n, um,m;n,n−1 = ξm,nξm,n−1.

A convenient and common way to describe ﬁnite-
diﬀerence equations on a numerical grid (lattice) is
to introduce the corresponding tight-binding operator.
For this purpose we ﬁrst introduce creation and an-
nihilation operators, a+
i ≡
describe an empty lattice, and the
0, . . . , 0m,n, . . . , 0
|
describe an excitation at the
state
i
site m, n. The operators a+
m,n, am,n act on these states
according to the rules16

0, . . . 0, 1m,n, 0, . . . , 0
|

m,n, am,n. Let the state

0
|

i

a+
0
m,n|
a+
m,n|

=

0, . . . 0, 1m,n, 0, . . . , 0
|

i
0, . . . 0, 1m,n, 0, . . . , 0

= 0,

,
i

i

am,n
am,n

= 0,

0
|
i
0, . . . 0, 1m,n, 0, . . . , 0
|

i

=

0
|

.
i

and they obey the following commutational relations

2

(7)

−(8)

(11)

(12)

(14)

TM modes: f = √εrEz, LT M =

1
√εr (cid:18)

∂2
∂x2 +

∂2
∂y2 (cid:19)

1
√εr

−

m,n] = am,na+

[am,n, a+
[am,n, am,n] = [a+

m,n, a+

m,n −

m,n] = 0.

a+
m,nam,n = δm,n;

(13)

For the numerical solution, Eqs. (4)-(6) have to be dis-
m∆, n∆, where ∆ is the grid step. Using
cretized, x, y

→

Consider an operator equation

=

2

ω
c (cid:17)

(cid:16)

f
|

,
i

f
L |
b

i

3

where the Hermitian operator

(vm,na+

m,nam,n

−

Xm,n
um,m+1;n,na+
um,m;n,n+1a+

L
b

=

−

−

acts on the state

m,nam+1,n
−
m,nam,n+1 −

um+1,m;n,na+
um,m;n+1,na+

m+1,nam,n
−
m,n+1am,n)

(15)

(16)

=

f
|

i

Xm,n

fm,na+

0
m,n|

.
i

i

f
|

and

L
b

Substituting the above expressions for
in Eq.
(14), and using the commutation relations and the rules
Eqs. (11)-(13), it is straightforward to demonstrate that
the operator equation (14) is equivalent to the ﬁnite dif-
ference equation (8). Note an apparent physical meaning
of the last four terms in Eq. (15): they describe hopping
to the site m, n from its four closest neighbors. In the
next section we outline the Green’s function formalism
for solution of Eq. (14).

III. THE RECURSIVE GREEN’S FUNCTION
TECHNIQUE

A. Basics

≤

≤

Let us ﬁrst specify structures under investigation. We
consider light propagation through a photonic structure
deﬁned in a waveguide (supercell) of the width N, where
we assume the cyclic boundary condition (i.e. the slice
n = N + 1 coincides with the slice n = 1). The photonic
structure occupies a ﬁnite internal region consisting of M
slices (1

M ).

m

≤

0 and m

The external regions are semi-inﬁnite waveguides (su-
percells) extending into regions m
M + 1.
The waveguides can represent air (or a material with a
constant refractive index), or a periodic photonic crys-
tal. Figure 1 shows two representative examples where
(a) the semi-inﬁnite waveguides represent a periodic pho-
tonic crystal with the period
, where one row of cylin-
ders is missing, and (b) a photonic structure is deﬁned at
the boundary between air and the semi-inﬁnite photonic
crystal.

M

≥

Let us ﬁrst deﬁne the scattering states for the struc-
tures under consideration. The translation invariance
along the supercell dictates the Bloch form for the αth
incoming state

ψi
|

,
αi

ψi
|

αi

=

Xm≦0

eik+

α m

N

Xn=1

φα
m,n a+

0
m,n|

,
i

(17)

α (k−

where k+
α ) is the Bloch wave vector of the righ-
propagating (left-propagating) state α, and φα
m,nis the
corresponding Bloch transverse eigenfunction satisfying
the Bloch condition

FIG. 1: Schematic illustration of the system under study de-
ﬁned in a waveguide (supercell) of the width N. An internal
region of the structure occupies M slices. Two representative
cases are shown, (a) external regions are semi-periodic pho-
tonic crystals with the period M, where one row of cylinders
(deﬁning a waveguide) is missing, (b) external regions repre-
sent a semi-inﬁnite periodic photonic crystal with the period
M to the right and air to the left.

The transmitted and reﬂected states,
can be written in a similar form,

ψt
|

βαi

and

ψr
|

,
βαi

ψt
|

βαi

=

Xm≧M Xβ

tβαeik+

β (m−(M+1))

N

Xn=1

φβ
m,n a+

0
m,n|

,
i

ψr
|

βαi

=

Xm≦0 Xβ

rβαeik

−
β m

N

Xn=1

φβ
m,n a+

0
m,n|

,
i

(19)

(20)

where tβα (rβα) stands for the transmission (reﬂection)
amplitude from the incoming Bloch state α to the trans-
mitted (reﬂected) Bloch state β. Note that in general case
the wave vectors k±
m,n can be dif-
ferent in the left and right waveguides (see e.g. Fig. 1(a),
when the photonic structure is deﬁned at the boundary
air/photonic crystal). The method of calculation of the
Bloch states for arbitrary periodic structure is described
below in Chapter IIIC.

α and the Bloch states φα

m,n = φα
φα

m+M,n.

(18)

We deﬁne Green’s function of the operator

in a

L
b

standard way,

(ω/c)2

(cid:16)

−

L (cid:17)
b

G(k) =

1 ,

(21)

b

b

1 is the unitary operator18. The knowledge of the
where
Green’s function allows one to calculate the transmission
coeﬃcient. Indeed, let us write down the solution of Eq.
(14) as a sum of two terms, the incoming state
and
representing whether the trans-
the system response
ψt
mitted or reﬂected states,
.
f
i
|
|
Using the deﬁnition of the Green’s function, the formal
solution of Eq. (14) can be written in the form

ψi
|
ψi
|

ψr
|

ψ
|

ψ
|

,
i

or

+

=

i

i

i

i

i

= G

ψ
|

i

(cid:16)

L −
b

(ω/c)2

ψi

.
i

(cid:17) |

and

aM+1,nψ
|

M + 1, n
Calculating the matrix elements
h
i ≡
, of the rigth and
ψ
0
i
h
|
left hand side of Eq. (22), we arrive to the N
N sys-
tem of linear equations for the transmission and reﬂection
amplitudes (see for details Appendix A),

0
i ≡ h

a0,nψ
|

0, n
h

ψ
|

×

i

ΦM+1T =

Φ0R =

GM+1,0(U0,1Φ1Kl
G0,0(U0,1Φ1Kl

Γl
−
−1Φ0)
Γl

−1Φ0)
I

−

−

−

−

where the matrix elements (T )βα = tβα, (R)βα = rβα;
GM+1,0 and G0,0 are the Green’s function matrixes with
the elements

(Gm,l)n,p =

0
h
GM+1,M+1

am,nG a+
|

0
l,p|

.
i

G0,0

wg

≡

≡

wg and Γr

are the “surface Green’s
Γl
functions” corresponding only to part of the whole struc-
ture, namely, to the semi-inﬁnite waveguides that extend
in the regions
. The
matrixes K and Φm are given by the right-propagating
Bloch eigenvectors k+
α and the corresponding eigenstates
φα

m,n in the waveguides,

0, and M + 1

< m

m <

−∞

∞

≤

≤

(K)αβ = exp(ik+

α ) δαβ; (Φm)nα = φα

m,n

(26)

and the diagonal “hopping matrix” U0,1 is deﬁned as

(22)

(23)

(24)

(25)

(U0,1)n,n′ = u0,1;n,n′δn,n′.

(27)

In the following sections we describe the recursive
Green’s function technique based on the successive use
of the Dyson’s equation, introduce the method for the
calculation of Bloch states in a periodic structure, and
outline the way to calculate the surface Green’s function
Γ.

B. Recursive technique based on Dyson’s equations

In order to calculate Green’s function of the internal
structure (i.e. for the slices 1
M ) we utilize the
recursive technique based on Dyson’s equation, see Fig.
2.

m

≤

≤

4

FIG. 2: Schematic illustration of the application of Dyson’s
equation for calculation of Green’s function for a composed
structure consisting of m+1 slices (see text for details). The
0
m+1 describe respectively the structure
operators
composed of m + 1 slices, and the (m + 1)-th slice. The oper-
V corresponds to the composed
L
ator
V is the perturbation operator
structure of m+1 slices, where
b
b
describing the hopping between mth and (m + 1)-th slices.

0
m and

0
m+1 +

b
0
l
m +

L m+1 =

L

b

b

b

l

b

In order to illustrate this technique let us consider a
0
m de-

structure consisting of m slices. The operator

L
b

scribing this structure can be written down in the form

0
m =

vra+

r ar

ur,r+∆a+

r ar+∆,

(28)

m′

Xr

− Xr,∆

L
b
where r = m′, n′ (1
N ), and the
≤
summation over ∆ in the second term is performed over
all available nearest neighbors. Suppose we know Green’s
0
function G0
m, as well as Green’s func-
0
tion g0
l
m+1 corresponding to a
single (m + 1)-th slice

m of the operator
L
m+1of the the operator
b

m; 1

n′

≤

≤

≤

b

0
m+1 =

l

b

(vm+1,m+1a+

m+1,nam+1,n

(29)

−

Xn
um+1,m+1;n,n+1a+
um+1,m+1;n+1,na+

−

−

m+1,nam+1,n+1−
m+1,n+1am+1,n).

(The method of calculation of Green’s function for a sin-
gle slice is outlined in Appendix B). Our aim is to calcu-
late Green’s function of the composed structure, Gm+1,
consisting of m + 1 slices. The operator corresponding to
this structure can be written down in the form

m+1 =

0
m +

0
m+1 +

l

,

(30)

L
b

L
b
b
0
0
m+1are given by the ex-
where the operators
l
m and
pressions Eqs. (30), (29), and
m,m+1+
m+1,m
b
is the perturbation operator describing the hopping be-

L
b

V
b

=

V
b

V
b

V
b

5

(31)

(32)

tween mth and (m + 1)-th slices,

=

=

V
b

m+1,m +

m,m+1 =

V
(um,m+1;n,na+
b

V
b
− Xn

+ um+1,m;n,na+

m+1,nam,n).

m,nam+1,n+

The Green’s function of the composed structure, Gm+1,
can be calculated on the basis of Dyson’s equation18

Gm+1 = G0 + G0
V
Gm+1 = G0 + Gm+1
b

Gm+1,
G0,

V
b
where G0 is the ‘unperturbed’ Green’s function corre-
0
m+1. Thus, starting
sponding to the operators
L
from Green’s function for the ﬁrst slice g0
1 and adding re-
b
cursively slice by slice we are in the position to calculate
Green’s function of the internal structure consisting of
M slices. Explicit expressions following from Eqs. (32)
and used for the recursive calculations are given below,

0
m or

b

l

Gm+1,m+1
m+1

= (I

m+1Um+1,m(G0
g0

m)m,mUm,m+1)g0

−

Gm+1,1

m+1 = Gm+1,m+1

m+1

Um+1,m(G0

m+1,
(33)
m)m,1,

G1,1

m+1 = (G0

m)1,1 + (G0

m)1,mUm,m+1Gm+1,1
m+1 ,

G1,m+1

m+1 = (G0

m)1,mUm,m+1Gm+1,m+1

m+1

,

where the matrix elements of the Green’s function are
deﬁned according to Eq. (25).

C. Bloch states of the periodic structure

In this section we describe the method for calculation
of the Bloch states in the periodic waveguides using the
Green’s function technique. Similar method was used
for calculation of Bloch states in quantum-mechanical
structures19.

Consider a unit cell of a periodic waveguide occupying

slices, 1

m

, see Fig. 3.

M

≤

≤ M

Rewrite the operator corresponding to the whole struc-

ture in the form

,

=

V
b

L
b

(34)

L cell +
b
where the operators
L cell and
the cell under consideration (1
m
b
side region including all other slices
0
cell and slices m = 0 and m =
ψ
wave function
|

L out +
b
L out describe respectively
), and the out-
≤
b
0 and
< m
is the hopping operator between the
+ 1. Write the total
in the form

≤ M
−∞

V
b
=

, and

m >

∞

≤

≥

i

i

M
m,n ψm,na+
0
m,n|
,
ψouti
|

ψcelli
|

+

P
=

ψ
|

i

FIG. 3: Schematic illustration of the calculation of Bloch
states in an inﬁnite periodic structure (see text for details).
L cell describes a unit cell under consideration,
The operator
1 ≤ m ≤ M, and
L out describes the rest of the structure.
The hopping between the cell and the rest of the structure is
described by the operator

V .

b

b

and

ψouti
|

ψcelli
|

b
where
are respectively wave functions
in the cell and in the outside region. Substituting Eqs.
ψouti
,
(34),(35) into Eq. (14), we obtain
V |
where Gcell is the Green’s function of the operator
L cell.
b
Calculating the matrix elements
,
ψ
, n
i
|
hM
b
this equation can be written in the matrix form,
cellU1,0ψ0 + G1,M
ψ1 = G1,1
M,1
cell U1,0ψ0 + G
ψM = G

cell U1,0ψM+1
M,M
cell U1,0ψM+1,

ψcelli
|
ψ
1, n
|
h

= Gcell

(36b)

(36a)

and

i

where the vector column ψm = (ψm,1 . . . ψm,N )T , and
where we used UM,M+1 = U0,1 (because of the period-
icity) and U0,1 = U1,0 (according to the deﬁnition of U ,
Eq.(27)). It is convenient to rewrite Eq. (36a) in a com-
pact form

T1 (cid:18)

T1 =

ψ1
ψ0 (cid:19)

ψM+1
ψM (cid:19)
G1,M
−
M,M
cell U1,0
G

= T2 (cid:18)
cell U1,0 0

(cid:18)

I(cid:19)

, T2 =

, where

(37)

I
−
−
0 G

(cid:18)

G1,1
cellU1,0
M,1
cell U1,0 (cid:19)

,

with I being the unitary matrix. The wave function of
the periodic structure has Bloch form,
ψM+m = eikxMIψm.

(38)

Combining Eqs.
eigenequation for Bloch wave vectors and Bloch states,

(37) and (38), we arrive to the

T −1
1 T2 (cid:18)

ψ1
ψ0 (cid:19)

= eikxM

ψ1
ψ0 (cid:19)

,

(cid:18)

(39)

determining the set of Bloch eigenvectors kα
functions ψα, 1

N.

α

x and eigen-

To improve numerical stability of Eq. (39), it may be

≤

≤

rewritten in the form11:

(35)

(T1 + T2)T1 (cid:18)

ψ1
ψ0 (cid:19)

= (eikxM + 1)−1

ψ1
ψ0 (cid:19)

.

(cid:18)

(40)

6

G1,1

where Γ
wg is the surface Green’s function. (Note
≡
that because the waveguide is inﬁnitely long and peri-
wg = GM+1,M+1
odic, G1,1
etc.).
= ...
Taking the matrix elements
of Eq. (43) and mak-
1, n
h
ing use of Eq. (44), we obtain for an each Bloch state
α, ψα
1 = ΓU1,0ψα
0 . The latter equation can be used for
determination of Γ,

= G2M+1,2M+1

wg
ψ
|

wg

i

ΓU1,0 = Ψ1Ψ−1
0 ,

(45)

where Ψ1 and Ψ0 are the square matrixes composed of
matrix-columns ψα
(39). Note that for
the case of the waveguide deﬁned in the air the surface
Green’s function (45) simpliﬁes to ΓU1,0 = K .

1 and ψα

0 , Eq.

IV. APPLICATIONS OF THE METHOD

To reveal the power of the method we study three
model systems deﬁned in 2D square-lattice photonic crys-
tal. First, we calculate a transmission coeﬃcient and
quality factor (Q factor) of several representative types
of microcavities in inﬁnite PCs. Then we focus on semi-
inﬁnite crystals where we investigate the eﬀect of surface
states, and, ﬁnally, we consider a semi-inﬁnite PC with a
waveguide opening on a surface. For the bulk crystal we
choose a structure composed of cylindrical rods with the
permittivity εr = 8.9 and the diameter of a rod d = 0.4a
in a vacuum background, where a is the size of the unit
cell.

Most of photonic crystal devices operate in a bandgap.
The structure at hand has a complete bandgap for TM-
modes in the frequency range 0.32 . ωa/2πc . 0.441,
and does not have a complete bandgap for the TE-
polarization. Because of this, we will hereafter consider
the TM-modes only.

The developed method allows one to treat structures
unlimited in x-direction, whereas in y-direction the struc-
ture of interest is conﬁned within a supercell with im-
posed cyclic boundary conditions. This leads to the ﬁnite
size eﬀects in a photonic band structure. If the super-
cell consists of more than one elementary cell, additional
bands appear along with the bands for inﬁnite PC (Fig. 5
(a,b)), as the result of the imposed boundary conditions
in the transverse direction.

A similar ﬁnite-size eﬀect emerges when the air “leads”
are attached to the system of interest. Even though we
send a wave from an open space, we use a ﬁnite number of
propagating modes. Solution of the eigenvalue problem
(40) for the air supercell gives a discrete set of right-
propagating eigenstates km
(πm/W )2
where W is the width of the supercell, and m = [
].
,
−∞
Thus, a wave incident from the air eﬀectively propa-
gates only at a certain incidence angles, determined by
the ratio of the longitudinal and transverse wave vectors
tan α = km

x , as illustrated in Fig. 6.

y /km

ω2/C2

x =

p

∞

−

FIG. 4: A schematic diagram illustrating calculation of the
surface Green’s function Γ of a periodic structure (see text
for details).

| ≫

1 and

eikxM
|

1 are calculated.

This tecnique allows one to avoid overﬂows and under-
ﬂows in the eigensolver routine when eigenvalues with
eikxM
|

In order to separate the left- and right-propagating
states we compute the Poynting vector integrated over
transverse direction, whose sign determines the direction
of propagation. Bloch state propagating in a waveguide
beﬁned in a photonic crystal is illustrated below in Fig.
5(c).

| ≪

For TM and TE polarizations Poynting vector can be

expressed as follows2,

Sα

T M (y) =

[Eα

z (y)

H∗

α(y)]

×

Sα

T E(y) =

[H α

z (y)E∗

α(y)]

1
2 ℜ

1
2 ℜ

(41)

(42)

where H = (Hx, Hy, 0) and E = (Ex, Ey, 0). Note that
for the case of the waveguide deﬁned in the air,
= 1,
and Green’s functions Gcell in Eq. (37) is simply given
by Green’s function of a single slice g0 (see Appendix B
for details of calculation g0).

M

D. The surface Green’s function Γ.

Consider a semi-inﬁnite Bloch waveguide of the peri-
as

extending in the region

M

m

−

≤

≤ ∞

odicity
M
depicted in Fig. 4

−

M .

Suppose that an excitation

m =
sponding to the operator
one can write down the response to the excitation
the form

is applied to its ﬁrst slice
Introducing the Green function Gwg corre-
L wg describing the waveguide,
in
b

s
|

s
|

i

i

ψ
|

,
i
is the wave function that has to satisfy Bloch
where
conditions (38). Applying Dyson’s equation between the
slices 0 and 1 we get

s
= Gwg|

(43)

ψ
|

i

i

G1,−M

wg = ΓU1,0G0,−M

wg

,

(44)

7

FIG. 5: (a) Band diagram for the right-propagating TM-mode
of an inﬁnite 2D photonic crystal (εr = 8.9, d = 0.4a) in ΓX-
direction. PC has a fundamental bandgap in the frequency
range 0.28 . ωa/2πC . 0.44 (ﬁlled with gray in the ﬁgure).
Green line in the fundamental bandgap corresponds a guided
mode in a waveguide created by removing a single row of rods
from the PC. (b) Band diagram of a truncated photonic crys-
tal. Additional bands (encircled with red) for 3 × 1 supercell
originated from the ﬁnite size of the PC structure. Insets illus-
trate the shape of the supercell used in calculations. (c) Bloch
state propagating in the PC waveguide at ωa/2πC = 0.38

FIG. 6: Dispersion relation for the air supercell of the width
of 9 a. Eﬀective angles of incidence are determined by angular
wavenumber m. Inset shows the permitted angles of incidence
for m = −2, −1, 0, 1, 2.

A. Microcavity

In this section we consider a microcavity placed into a
waveguide in an inﬁnite PC. The waveguide is created by
removing a single row of cylinders, such that in energy
range corresponding the fundamental bandgap only one
waveguide mode can propagate. Band diagram of the
waveguide mode is shown in Fig.5(a) as a green line.

FIG. 7: (a) Transmission coeﬃcient of three cavity structures
versus frequency. (b) Intensity of the Ez-component of the
electromagnetic ﬁeld in the double-wall cavity at the reso-
nance (ωa/2πc = 0.3952).

Three diﬀerent cavities are introduced in order to show
the eﬀect of geometry and demonstrate the importance
of proper design of a cavity. The ﬁrst cavity is deﬁned by
two rods placed on the lattice sites, see insets in Fig.7.
In another structure the diameter of the rods is doubled,
and for the third cavity we place two rods from each side
of the cavity to achieve better conﬁnement. Dependence
of the transmission coeﬃcient on the incoming wave fre-
quency is depicted in Fig.7(a). We would like to stress
that in the calculation of the transmission coeﬃcient, the
incoming, transmitted and reﬂected states are the Bloch
states of a waveguide (shown in Fig.5(c)), such that all
spurious reﬂections from PC interfaces or computational
domain boundaries are avoided.

The fundamental parameter of cavity resonances
is
their Q-factor deﬁned as Q=2πω*(stored en-
ergy)/(energy lost per cycle), which can be rewritten in
the following form:

Q = ω

4

Ω
Sindy

(46)

R

Hy
|

R
2)]dxdy and
2 +
2 + µ0(
Hx
where ΩT M =
[εε0|
Ez
|
|
|
|
2)]dxdy characterizes
2 +
2 + εε0(
Ey
[µ0|
ΩT E =
Ex
Hz
R
|
|
|
|
|
the energy stored in a system respectively for TM and
TE polarizations and the integral over Sin is the incom-
ing energy ﬂux. Eq.
(46) can be also expressed as a
well-known relation Q = ω/∆ω where ω is the resonant
frequency and ∆ω is the width of the resonant peak at
half-maximum.

Resonance peak for the single-wall cavity is centered at
ωa/2πc = 0.3952 and has Q factor 35.5. As expected, the

highest Q factor (327.7) is achieved for the case of double-
rod walls. Resonance peak in the case of larger rods is
shifted to the higher energy values (ωa/2πc = 0.4281)
because of the decrease of the eﬀective size of the cavity.
The lower Q factor in this case (25.07) is because larger
rods disrupt destructive interference in a bandgap of the
PC.

Note that the width of the supercell used in the com-
putations has to be large enough to ensure that the in-
tensity of the ﬁeld decays to zero at the domain bound-
ary. At the same time, it is desirable to make the size
of the computational domain as small as possible. For
the present computations, keeping this trade-oﬀ in mind,
we have chosen a supercell consisting of 7 unit cells in
y-direction. This choice seems to be suﬃcient, as the
ﬁeld intensity decreases by 5 orders of magnitude within
the length of two lattice constants from the waveguide
towards the supercell boundaries.

Finally, to conﬁrm our results and to verify the devel-
oped method, we performed calculations for the cavities
and waveguides in PC studied by Li et al.11 and found a
full agreement with their results.

B. Surface states

In the previous section we considered wave propaga-
tion in an inﬁnite photonic crystal. Another aspect of
interest is the eﬀect of the surface in semi-inﬁnite pho-
tonic crystals that can accommodate a localized state
(surface mode) decaying both into air and into a space
occupied by the photonic crystal1,20. In the present sec-
tion we study the coupling between an incident radiation
and the surface states. In particularly, using the devel-
oped method, we calculate the Q factor of the surface
modes. Our ﬁndings indicate that the surface modes,
thanks to their high Q factors, can be used for lasing
and sensing applications.

We study two semi-inﬁnite photonic crystal structures
that support localized surface modes.
In the ﬁrst case
a surface row of cylinders is composed of half-truncated
rods1 (structure 1), and in the second case the cylindri-
cal and half-truncated rods in the surface row are inter-
changed as shown in Fig. 8 (structure 2). In order to
calculate Q factor of the structures at hand, we illumi-
nate the semi-inﬁnite photonic crystal by an incidence
wave (that excites the surface modes) and compute the
intensity of the ﬁeld distribution. Note that the calcu-
lated ﬁeld distribution includes the contributions from
both the surface mode exited by the incident light, as
well as the incident and reﬂected waves. This leads to a
nearly constant oﬀ-resonance background in the depen-
dence Q = Q(ω) that is caused by the contribution of the
incident and reﬂected waves in the total ﬁeld intensity in
Eq. (46). To remove this background we calculate the Q
factor of a structure without surface states. We choose
this structure as a semi-inﬁnite photonic crystal with all
identical cylindrical rods, which is known not to support

8

surface modes1. Then the obtained value is subtracted
from the calculated value of the Q factor of the system
under study. Note that in the calculation of the Q factor,
the surface integration in Eq. (46) is performed over the
area depicted in Fig. 8.

∼

Figure 9 shows a Q factor of structures 1 and 2 as
a function of the frequency of the illuminating light.
104. Note that
For both structures Q factor reaches
for structure 2 the peak is split, which is the conse-
quence of the ﬁnite size eﬀect discussed above. Figures 8
(a),(c) show Ez-ﬁeld distribution for structures 1 and 2
at the resonance. For a comparison, a ﬁeld distribution
for a structure that does not support a surface mode
(semi-inﬁnite photonic crystal with all identical cylindri-
cal rods) is shown in Figure 8 (e). In the latter case the
ﬁeld intensity rapidly decays into the bulk of the pho-
tonic crystal, whereas for the structures supporting the
surface modes, the intensity is strongly localized at the
boundary row of rods. It is also worth to mention that
for the latter case the intensity of the ﬁeld in the surface
mode exceeds the incoming light intensity by 4 orders of
magnitude, such that the light intensity in the air region
is not visible in the ﬁgures (compare 8 (a),(c) with (e)).

Figures 8 (b),(d) show Poynting vector distribution
for both structures at the resonance. For the struc-
ture 1 the Poynting vector is “curling” along the bound-
ary, showing a low speed of the surface state.
In con-
trast, for the structure 2, the Poynting vector exhibits a
rapid ﬂow of energy along the boundary. Another diﬀer-
ence between these structures is a very broad and rather
strong “background” peak in the structure 2 in the region
0.34 . ωa/2πc . 0.35 (with Q factor up to
100). The
presence of such the peak indicates that the correspond-
ing surface state can be rather robust to various kinds
of imperfections that are always present in real struc-
tures and which are known to broaden the resonances
and lead to decrease of the Q factor12. These two ex-
amples of photonic crystals illustrate, that with proper
structure design one can engineer and tailor properties of
the surface states to the required needs.

∼

High values of Q factors of the surface modes residing
at the interface of the photonic crystal structure indi-
cate that these systems can be used for lasing and sensor
applications. Lasing eﬀect has been demonstrated for
diﬀerent photonic crystal structures including band-gap
defect mode lasers21, distributed feedback lasers22, and
bandedge lasers23. Utilization of the high-Q factor of
the surface modes represent a novel way to sustain las-
ing emission. To achieve lasing eﬀect careful design of
the surface and surface mode engineering should be per-
formed and the developed method seems to be a suitable
tool for this purpose. A detailed study of the surface
modes for various surface terminations, their Q-values,
and dispersion relations will be reported elsewhere.

9

FIG. 8: (a)-(d) Ez ﬁeld and Poynting vector distributions for the structures 1 and 2 at resonant frequencies (marked by arrows
in Fig. 9). (e) Ez ﬁeld distributions for the structure that does not support surface modes (a semi-inﬁnite photonic crystal
with all identical cylindrical rods). In all cases the structures are illuminated by the incoming wave with the incidence angle
α = arctan ky/kx = 34.7

.

◦

surface modes in the photonic band-gap structures that
can eventually open up the possibilities to integrate such
the devices with conventional ﬁber optic devices.

In the present section we consider two diﬀerent crys-
tal terminations to illustrate the eﬀect of the surface on
propagation of the light emitted from the waveguide. In
the ﬁrst case the surface is composed of cylinders with
parameters identical to those in the bulk of the crystal,
and in the second case the surface cylinders are two times
smaller than the cylinders in the bulk.

FIG. 9: Dependencies Q = Q(ω) for structures 1 and 2 (solid
and dashed lines respectively). Arrows indicate resonances for
which the ﬁeld intensities and Poynting vectors are visualized
in Fig. 8

C. Waveguide coupled to the open space

The last example of application of the method pre-
sented here is a semi-inﬁnite photonic crystal with a
waveguide coupled to the surface, see Fig. 10. It has been
recently demonstrated that a surface of a photonic crystal
can serve as a kind of antenna to beam the light emit-
ted from the waveguide in a single direction24,25. These
ﬁndings outline the importance of investigation of the

FIG. 10: Ez ﬁeld distributions at the surface of a truncated
photonic crystal with a waveguide. (a) The surface is com-
posed of cylinders with parameters identical to those in the
bulk of the crystal, and (b)the surface cylinders are two times
smaller than the cylinders in the bulk.

The Bloch state propagating in a waveguide in the pho-
tonic crystal couples with the states in the air and the
resulting ﬁeld distributions is shown in Fig. 10. The ﬁrst
structure does not support the surface mode, and hence
the light intensity distribution in the air region exhibits
a typical diﬀraction pattern. However, for the case of the
second structure the ﬁeld distribution in the air region is
drastically diﬀerent. In this case the Bloch sate in the
waveguide couples with the surface state localized at the
crystal termination, such that the whole surface acts as
a source of radiation.

V. CONCLUSIONS

We have developed a method based on the recursive
Green’s function technique for the numerical study of
photonic crystal structures. The method is proven to be
an eﬀective and numerically stable tool for design and
simulation of both inﬁnite photonic crystals and pho-
tonic crystals with boundaries.
In the present method
the Green’s function of the photonic structure is calcu-
lated recursively by adding slice by slice on the basis
of Dyson’s equation.
In order to account for the inﬁ-
nite extension of the structure both into the air and into
the space occupied by the photonic crystal we make use
of so-called “surface Green’s functions” that propagate
the electromagnetic ﬁelds into inﬁnity. This eliminates
the spurious solutions (often present in the conventional
FDTD methods) related to e.g. waves reﬂected from the
boundaries deﬁning the computational domain. The de-
veloped method has been applied to scattering and prop-
agation of electromagnetic waves in photonic band-gap
structures including cavities and waveguides. In partic-
ularly, we have shown that coupling of the surface states
with incoming radiation may result in enhanced inten-
sity of the electromagnetic ﬁeld on the termination of
the photonic crystal and very high Q-factor of the sur-
face modes localized at this termination. This eﬀect can
be employed as an operational principle for surface-mode
lasers and sensors.

10

Consider now the incoming state
, Eq. (17). Sub-
stituting Eq. (17) into Eq. (14) and using Eq. (A2) we
obtain

αi

ψi
|

2

ω
c (cid:17)

sα

i

(cid:19) |

(cid:18)L − (cid:16)

= eikα

u0,1;n,nφα

1,na+

0
0,j|

i−

(A3)

Xj
u1,0;n,nφα

0,na+

0
1,j|

.
i

− Xj

Substituting this equation into Eq. (22), calculating the
matrix elements
, and using the
ψ
i
|
relations

M + 1, n
h

0, n
h

and

ψ
|

i

GM+1,0 =

−
G0,0 = Γl

GM+1,1U1,0Γl,
G0,1U1,0Γl,

−

(A4)

(A5)

that follow from Dyson’s equation, we arrive to Eqs.
(23),(24) determinig the transmission and reﬂection am-
plitudes.

APPENDIX B: THE GREEN’S FUNCTION FOR
A SINGLE SLICE

The operator describing the m-th slice has the form

N

lm =

c

−

(vm,na+

m,nam,n

Xn=1
um,m;n,n+1a+

−
m,nam,n+1 −

(B1)

um,m;n+1,na+

m,n+1am,n).

Using this operator in the deﬁnition of Green’s function
(21), and calculating the matrix elements (...)m,m;n,n′
≡
0
N system of linear
, we arrive to the N
h
i
equations for the matrix elements of the Green’s function
of a single slice gm,

am,n... a+
|

m,n′

0
|

×

APPENDIX A: CALCULATION OF THE
TRANSMISSION COEFFICIENT

In this appendix we provide a detailed derivation of
Eqs. (23), (24). Consider ﬁrst an inﬁnite periodic struc-
ture waveguide (supersell). The α-th Bloch state in the
lattice can be written in the form

ψα
|

i

=

Xm,n

eik+

α mφα

m,n a+

0
m,n|

,
i

where summation is performed over all lattice sites and
the function φα
m,n satisﬁes the conditions (18). Substi-
tuting Eq. (A1) into Eq. (14), we arrive to the ﬁnite
diﬀerence equation valid for all sites m, n
um,m+1;n,neikαφα
vm,nφα

um,m−1;n,neikα φα

m,n −

m+1,n −

m−1,n−
(A2)

um,m;n,n+1φα

−

m,n+1 −

um,m;n,n−1φα

m,n−1 =

2

ω
c (cid:17)

(cid:16)

φα
m,n.

N

2

ω
c (cid:17)

Xn′′=1

(cid:18)(cid:16)

δn,n′′

lm,m;n,n′′

gm,m;n′′,n′ = δn,n′ ,

−

(cid:19)

where the matrix element of the operator

lm reads,

lm,m;n,n′′ = vm,nδn,n′′

−

(A1)

um,m;n′′−1,n′′δn,n′′−1 −

−

um,m;n′′+1,n′′ δn,n′′+1.

b

(B2)

(B3)
(B4)

Note that because of the cyclic boundary conditions
in the n-direction, the matrix elements um,m;1,N and
um,m;N,1 are distinct from zero and deﬁned according to
um,m;N,1 = um,m;0,1, and um,m;1,N = um,m;N +1,N .

11

1 J. D. Joannopoulos, R. D. Meade, and J. N. Winn,
“Molding the Flow of Light”, (Princeton University Press,
Princeton, 1995).

2 K. Sakoda, “Optical properties of photonic crystalls”

(Springer, Berlin, 2001).

3 L. Thylen, M. Qiu, S. Anand, Chem. Phys. Chem. 5, 1268-

1283 (2004).

4 K. K. Yee, IEEE Trans. Antennas Propag. 14, 302 (1966).
5 J.-P. Berenger, J. Comput. Phys. 114, 185 (1994).
6 A. Mekis, J. C. Chen, I. Kurland, S. Fan, P. R. Villeneuve,
and J. D. Joannopoulos, Phys. Rev. Lett. 77, 3787 (1996).

7 X. Yu and S. Fan, Appl. Phys. Lett. 83, 3251 (2003).
8 D. Felbacq, G. Tayeb, and D. Maystre, J. Opt. Soc. Am.
A 11, 2526 (1994); G. Tayeb and D. Maystre, J. Opt. Soc.
Am. A 12, 3323 (1997).

9 D. M. Whittaker and I. S. Culshaw, Phys. Rev. B 60, 2610

(1999).

10 Z.-Y. Li and K.-M. Ho, Phys. Rev. B 68, 045201 (2003).
11 Z.-Y. Li and K.-M. Ho, Phys. Rev. B 68, 155101 (2003).
12 A. I. Rahachou and I. V. Zozoulenko, J. Appl. Phys. 94,
7929 (2003); A. I. Rahachou and I. V. Zozoulenko, Applied
Optics 43, 1761 (2004).

13 E. Moreno, D. Erni, and C. Hafner, Phys. Rev. E 66,

036618 (2002).

14 O. J. F. Martin, C. Girard, and A. Dereux, Phys. Rev.
Lett. 74, 526 (1995); O. J. F. Martin and N. B. Piller,

Phys. Rev. E 58, 3909 (1998).

15 S. Datta, “Electronic Transport in Mesoscopic Systems”

(Cambridge University press, Cambridge, 1995).

16 D. K. Ferry, S. M. Goodnik, “Transport in Nanostructures”

(Cambridge University press, Cambridge, 1997).

17 W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P.
Flannery, “Numerical Recipes. The art of scientiﬁc com-
puting” (Cambridge University press, Cambridge, 1992).
18 E. N. Economou, “Green’s Functions in Quantum Physics”

(Springer-Verlag, Berlin, 1990).

19 I. V. Zozoulenko, F. A. Maa and E. H. Hauge, Phys. Rev.

B 53, 7975 (1996); ibid., 7987 (1996).

20 J. M. Elson and K. Halterman, Opt. Express 12, 4855

(2004).

21 O. Painter, R. K. Lee, A. Scherer, A. Yariv, J. D. O’Brien,
P. D. Dapkus, and I. Kim, Science 284, 1819 (1999).
22 M. Meier, A. Mekis, A. Dodabalapur, A. Timko, R. E.
Slusher, J. D. Joannopoulos, and O. Nalamasu, Appl.
Phys. Lett. 74, 7 (1999)

23 S.-H. Kwon, H.-Y Ryu, G.-H. Kim, Y.-H. Lee, and S.-B.

Kim, Appl. Phys. Lett. 83, 3870 (2003).

24 E. Moreno, F. J. Garcia-Vidal, and L. Martin-Moreno,

Phys. Rev. B 69, 121402 (2004).

25 P. Kramper et al., Phys. Rev. Lett. 92, 113903-1 (2004).

