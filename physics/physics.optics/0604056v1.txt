6
0
0
2
 
r
p
A
 
7
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
6
5
0
4
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Optical measurements of phase steps in segmented mirrors -
fundamental precision limits

L. Noethea and H.-M. Adorfb

a European Southern Observatory, Garching bei M¨unchen, Germany
b Max-Planck-Institut f¨ur Astrophysik, Garching bei M¨unchen, Germany

Abstract Phase steps are an important type of wavefront aberrations generated by large telescopes with seg-
mented mirrors. In a closed-loop correction cycle these phase steps have to be measured with the highest possible
precision using natural reference stars, that is with a small number of photons. In this paper the classical Fisher
information of statistics is used for calculating the Cram´er-Rao bound, which determines the limit to the precision
with which the height of the steps can be estimated in an unbiased fashion with a given number of photons and
a given measuring device. Four types of measurement devices are discussed: a Shack-Hartmann sensor with one
small cylindrical lenslet covering a sub-aperture centred over a border, a modiﬁed Mach-Zehnder interferometer,
a Foucault test, and a curvature sensor. The Cram´er-Rao bound is calculated for all sensors under ideal con-
ditions, that is narrowband measurements without additional noise or disturbances apart from the photon shot
noise. This limit is compared with the ultimate quantum statistical limit for the estimate of such a step which
is independent of the measuring device. For the Shack-Hartmann sensor, the eﬀects on the Cram´er-Rao bound
of broadband measurements, ﬁnite sampling, and disturbances such as atmospheric seeing and detector readout
noise are also investigated. The methods presented here can be used to compare the precision limits of various
devices for measuring diﬀerential segment phases and for optimising the parameters of the devices. Under ideal
conditions the Shack-Hartmann and the Foucault devices nearly attain the ultimate quantum statistical limits,
whereas the Mach-Zehnder and the curvature devices each require approximately twenty times as many photons
in order to reach the same precision.

1

Introduction

In future extremely large telescopes at least one of the mirrors will probably be segmented. During the operation
of such a telescope the wavefront errors introduced by segmentation have to be reduced to the order of a few
tens of nanometers. If the segments are regarded as rigid bodies, the wavefront errors can only be generated by
tip-tilt errors of individual segments or diﬀerential axial displacements. This paper assumes that the segments are
already perfectly aligned in tip and tilt. A correction of remaining piston errors – from now on called diﬀerential
segment phases – requires measurements of the heights of the wavefront steps at the borders of adjacent segments
with a precision of a few nanometers, and the suppression of the relative segment phases by appropriate rigid
body movements of the segments.

Several methods are used or have been proposed for the measurement of diﬀerential segment phases in seg-
mented mirrors. One method is based on the Shack-Hartmann technique and applied in a slightly modiﬁed
fashion at the Keck telescope [1][2][3].
In an image of the segmented mirror a circular lens is placed over a
sub-aperture centred on an intersegment border. The phase step across the border is estimated from the form
of the diﬀraction pattern, for narrowband and broadband measurements and in the presence of atmospheric
disturbances. Other methods proposed in the literature use spatial ﬁltering in a modiﬁed Mach-Zehnder interfer-
ometer [4], measurements in defocussed images and pupils [5] [6] [7] [8], phase ﬁltering techniques [9], or a knife
edge technique in the pyramid wavefront sensor [10][11][12][13].

1

All the sensors discussed in this paper generate diﬀraction patterns in the plane of a detector. These can
be regarded as likelihood functions p(x
θ) describing the “likelihood” to register a photon on the detector as a
function of the spatial variable x on the detector, given a certain value of a parameter, in this paper the relative
segment phase θ. There are various possibilities to deﬁne, based on the derivatives of the p(x
θ) with respect to
θ, an information content in the likelihood function ˙One of them is the classical Fisher information [14]:

|

|

IF =

dx p(x

θ)

+∞

−∞

Z

θ)

∂ ln p(x
∂θ

|

2

.

(cid:19)

|

(cid:18)

Estimating the diﬀerential segment phases is particularly diﬃcult at low light levels, e.g. when only the light
of faint stars is available for the measurements. The question arises what precision can ultimately be obtained
with a given number of detected photons. In statistics, precision is characterized by the conditional variance of
a quantity. For a parameter of interest, in this paper the relative segment phase θ, the minimum variance of an
unbiased estimate of the parameter, the so-called Cram´er-Rao minimum variance bound σ2
CRB [14], is given by
the inverse of the classical Fisher information IF(θ):

σ2
CRB(θ) = 1/IF(θ)

.

In the following the shorter expression Cram´er-Rao bound will be used for the square root σCRB of the Cram´er-
Rao minimum variance bound.

Two of the assumptions in the derivation of equation (2) are, unless it is obvious, checked for all cases
investigated in this paper. First, the integral of the likelihood function over the interval for which it is deﬁned
must not depend on θ, at least for a given value of θ for which the Fisher information is calculated. Second, the
likelihood function must be regular with respect to θ. Under the ﬁrst assumption the likelihood function can be
normalised:

This is equivalent to the assumption that one photon passes through the aperture.

If q(x

θ) denotes the real-valued likelihood amplitude, deﬁned by

|

the integrand in equation (1), which we will call the Fisher information density iF(x

θ), can be written as

|

+∞

−∞

Z

dx p(x

θ) = 1.

|

q(x

θ) =

p(x

θ),

|

|

p

iF(x, θ) = 4

θ)

∂q(x
|
∂θ

2

.

(cid:19)

(cid:18)

In principle there is an ambiguity related to the deﬁnition of the Fisher information density. This is due the

identity

which can be obtained by diﬀerentiating equation (3) twice with respect to θ. The Fisher information deﬁned as

+∞

−∞

Z

θ)

∂q(x
|
∂θ

dx

(cid:18)

2

=

(cid:19)

−

−∞

Z

+∞

dx q(x

θ)

θ)

∂2q(x
|
∂θ2

IF = 4

+∞

−∞

Z

dx

A

"

(cid:18)

2

θ)

∂q(x
|
∂θ

−

(cid:19)

B q(x

θ)

θ)

∂2q(x
|
∂θ2

#

|

|

would be independent of the choice of A and B provided that A + B = 1. However, the term following the
coeﬃcient B can be negative, possibly giving rise to a negative Fisher information density. Since this seems
unreasonable, B is set to zero and the Fisher information density is deﬁned as in equation (5). The Fisher
information will therefore be computed as

(1)

(2)

(3)

(4)

(5)

(6)

(7)

(8)

IF = 4

+∞

−∞

Z

θ)

∂q(x
|
∂θ

2

.

(cid:19)

dx

(cid:18)

2

According to equation (2) the computation of the Fisher information oﬀers a possibility to calculate analytically
the potential precision limits of various measurement methods. These limits can then be compared with the
ultimate limit which is independent of any measuring device. The latter is calculated in section 3 from ﬁrst
principles by introducing the wave function describing the wavefront immediately after the reﬂection by the
mirror, generating a relative segment phase, into the quantum statistical counterpart of the expressions (1) or
(8) for the Fisher information.

Section 4 discusses the Cram´er-Rao bounds for the Shack-Hartmann, the Mach-Zehnder, the Foucault and
the curvature sensor under ideal conditions, that is for monochromatic light and without any eﬀects introducing
additional noise or light losses or aberrations. The eﬀects of broadband measurements, ﬁnite sampling, and
external disturbances such as seeing and detector readout noise can also be included in the calculations. The
methods are outlined in detail only for the Shack-Hartmann sensor in section 6, but could readily be applied to
the other sensors as well.

In general, the limits given by the Cram´er-Rao bound can only be reached if eﬃcient estimators are available
for the analysis of the data. This issue will, however, not be discussed in this paper. Furthermore, all calculations
will be carried out for the one-dimensional case.

2 Deﬁnition of the wavefront error

Let, as shown in ﬁgure 1, the pupil be deﬁned by the interval [
a, +a] with the spatial variable in the pupil
denoted by xp. An out-of-phase segment with its centre at c generates a constant wavefront error or phase
diﬀerence ϕ(xp) = θ over its full width 2w compared to a phase, also constant, over the rest of the pupil. There

−

ϕ

θ

2w

−a

c

+a

xp

Figure 1: Wavefront phase ϕ with a relative segment phase θ generated by a segment of width 2w and a centre at c
within a subaperture of width 2a.

are two wavefront discontinuities, that is phase steps of height θ, at the segment borders. Apart from an irrelevant
average phase, the complex amplitude describing the wavefront is given by

with

and

Us(xp |

θ) =

1
√2a

eikϕ(xp) W (xp,

a, +a)

,

−

ϕ(xp) =

0
θ
0






for
for
for

a

−
c
−
c + w

a

w

≤

xp ≤

c
≤
−
w < xp < c + w
xp ≤
a
−
xp ≤

≤

a

+a

0 for xp <
1 for
−
0 for +a < xp












,

W (xp,

a, +a) =

−

+a

−a

Z

dxp U ∗

s (xp |

θ) Us(xp |

θ) = 1

,

3

(9)

(10)

(11)

(12)

where k = 2π/λ is the wavenumber and λ is the wavelength of the light. The restriction of the deﬁnition to
the interval [
a, +a] signiﬁes that only the photons passing through the aperture of width 2a will be used for
estimating the relative segment phase param, and the factor in front of the exponential in equation (9) normalizes
the wave function such that the number of photons within this sub-aperture is equal to 1, that is





−

a, +a], that is if c = a

where U ∗
s is the complex conjugate of Us. Apart from the general or two-border conﬁguration shown in ﬁgure 1,
two special conﬁgurations will be discussed in more detail. One is given if the segment is located at the edge
w. This conﬁguration will subsequently be called the single-border
of the aperture [
conﬁguration. The second special conﬁguration, which is a special case of the single-border conﬁguration, is
given if the border is at the centre of the aperture [
a, +a], that is if c = w = a/2. This conﬁguration, which is
of particular interest for the Shack-Hartmann type sensor, will be called the centred single-border conﬁguration.
For the general conﬁguration the parameter θ will be referred to as the relative segment phase, and for the
single-border conﬁgurations as the phase step.

−

−

−

3 Quantum statistical precision limit for the estimate of a relative

segment phase

The ultimate precision limit for the measurement of diﬀerential segment phases can, if at all, be obtained with a
measuring device which is capable of transferring the maximum relevant information contained in the source to
the data. In addition, one needs an appropriate, that is eﬃcient data analysis procedure.

As stated in the introduction, the limit on the data side can be obtained from the Fisher information which
is derived from a classical, real-valued likelihood function. However, on the source side, immediately after the
reﬂection of an incoming monochromatic plane wavefront by the mirror conﬁguration shown in ﬁgure 1, the
full information is contained in a complex quantum statistical wave function ψ(x
θ), which is equivalent to the
complex amplitude function (9) familiar from optical theory. Therefore, the calculation of the information in the
source requires the quantum statistical equivalent of the expression (8) for the Fisher information. For a pure
state ψ and its complex conjugate ψ∗ this is given [15] by

|

IQM(θ) = 4

+a

−a

 Z

dxp

∂
∂θ

ψ∗(xp |

θ)

∂
∂θ

ψ(xp |

θ)

−

+a

dxp ψ∗(xp |

θ)

∂
∂θ

ψ(xp |

.

(13)

The ﬁrst term on the right hand side is similar to the deﬁnition of the classical Fisher information density in
equation (8). The second term, in eﬀect, suppresses a dependence of IQM on an undetectable average phase
across the full aperture [

a, +a].

−

By replacing the complex wave function ψ in equation (13) by the complex amplitude Us of equation (9) one
obtains the quantum statistical equivalent of the Fisher information about the relative segment phase contained
in the complex amplitude immediately after the reﬂection by the mirrors:

−a

Z

(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

!

θ)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

The quadratic dependence of the quantum statistical information about the segment width, which is independent
of the segment position, is shown in ﬁgure 13 by the solid line. The maximum

is obtained if the segment covers half of the aperture, that is for w = a/2.

For a single photon, the lower bound for the root-mean-square (RMS) of the uncertainty in the estimate of
the parameter θ, that is the quantum statistical equivalent of the square of the classical Cram´er-Rao minimum
variance bound, is given by

The minimum value is obtained, if the segment covers half of the pupil:

IQM(θ) = 4 k2 w
a

w
a

1

−

.

(cid:16)

(cid:17)

IQM,max(θ) = k2

σQM,CRB,1(θ) =

1
2k

a

w(a

w)

−

.

p

1
k

λ
2π

σQM,CRB,1,min(θ) =

=

.

4

It depends only on the wavelength of the light, and is of the order of 100 nm for visible wavelengths. For Nphot
registered photons the Fisher information increases by a factor of Nphot, the quantum statistical Cram´er-Rao

(14)

(15)

(16)

(17)

bound decreases by 1/
parameter θ is correspondingly given by

p

Nphot, and the lower bound for the RMS of the uncertainty in the estimate of the

σQM,CRB,min(θ) =

(18)

This fundamental limit does not refer to a particular measurement device or a particular data analysis procedure.
It is based on the maximum information that can potentially be extracted from the wavefront, without necessarily
implying that such an eﬃcient measurement process exists.

1
Nphot

λ
2π

.

p

4 Cram´er-Rao bounds for the measurement of piston steps with dif-

ferent sensors under ideal conditions

The Cram´er-Rao bounds for measuring the relative segment phase or phase step θ are calculated for the four
sensors mentioned above, under ideal conditions, that is under the following assumptions:
light from a quasi-
monochromatic source, an inﬁnitely ﬁne sampling, and, apart from the inevitable photon shot noise, no additional
noise introduced by atmospheric eﬀects or the readout characteristics of the detector.

The phasing in a segmented mirror is done in two steps. First, after the installation of new segments, initial
large diﬀerential segment phases of the order of possibly several wavelengths have to be reduced to steps of the
order of a fraction of a wavelength. Usually, this only needs to be performed once and can therefore be done with
bright stars. Since they supply a large number of detectable photons, high accuracies can be obtained during this
process. Second, during observations, one has to be content with small number of photons, but has to correct
only comparatively small diﬀerential segment phases. The precision limits or Cram´er-Rao bounds therefore need
to be calculated only for the case of very small diﬀerential segment phases or phase steps, that is for θ

0.

→

4.1 Shack-Hartmann method

Usually, the Shack-Hartmann method used for phasing measurements consists of placing a circular lens across
the border between two segments. The information on the phase step is contained in the diﬀraction pattern of
the lens. In a one-dimensional setting, a cylindrical lens is used with its axis being parallel to the border, and its
center ideally exactly on the border. The normal conﬁgurations for the Shack-Hartmann sensor are therefore the
single-border and the centred single-border conﬁguration. However, to be able to compare the Shack-Hartmann
sensor with the other phasing wavefront sensors, the computation of the likelihood function in the focal plane and
the Fisher information, presented in appendix A1, are done also for the general conﬁguration shown in ﬁgure 1,
that is for a single lens covering the full aperture with one out-of-phase segment in an arbitrary location. The
θ) are both functions of the phase step θ, and a is
likelihood function p(ξ
a dimensionless position variable ξ, which is related to a true position variable x in the focal or detector plane
by ξ = x/f , where f is the focal length of the lens. The general as well as the special conﬁgurations will be
discussed in this section.

θ) and the Fisher information iF(ξ

|

|

Section 4.1.1 discusses the likelihood function, the Fisher information density, and the Fisher information. A
variation of the parameter θ causes a shift of the maximum of the diﬀraction pattern as well as a change of its
form. From both characteristics partial information about θ can be obtained. Section 4.1.2 shows that most of
the information is contained in the shift of the maximum, and section 4.1.3 that a quarter of the full information
is contained in the change of the form, that is, independent of the horizontal position of the likelihood function.

4.1.1 Likelihood function, Fisher information density and Fisher information

Figure 2a shows for the centred single-border conﬁguration the diﬀraction patterns, or equivalently the likelihood
θ), for four diﬀerent phase steps θ ranging from zero to λ/2. The location of the ﬁrst zero in the
functions p(ξ

|

5

Figure 2: Shack-Hartmann sensor: (a) Likelihood functions for four diﬀerential segment phases θ as a function of a the
normalised angular coordinate in the focal plane of the Shack-Hartmann lens. (b) Likelihood function and corresponding
functions related to the Fisher information for θ = 0: normalised likelihood function p(ξ | θ)ξ0 (dotted), normalised Fisher
information density iF(ξ | θ)ξ0/k2 (solid), integrated likelihood function and dashed : integrated Fisher information density
divided by k2 )dashed-dotted).

diﬀraction pattern for θ = 0 will be denoted by ξ0 = λ/(2a). For the centred single-border conﬁguration and for
arbitrary θ the Fisher information density and the likelihood function are related by

iF(ξ

θ) = k2 p(ξ

|

θ

|

−

λ/2)

.

Figure 2b shows that for the case θ = 0 the ﬁrst maxima of the Fisher information density on both sides of
the origin are lying just inside the ﬁrst minima of the likelihood function, represented by the dotted curve. The
dashed line in ﬁgure 2b shows the Fisher information density integrated from ξ = 0 to the ξ value on the abszissa
and divided by k2, and the dashed-dotted line the corresponding integrated likelihood function. The likelihood
function is more concentrated around the origin than the corresponding Fisher information density. For the case
θ = λ/2 the likelihood function has a minimum at ξ = 0 and the Fisher information density consequently its
maximum at ξ = 0. Therefore, for θ = λ/2, the Fisher information density is more concentrated around the
origin than the corresponding likelihood function.

The Fisher information is obtained by integrating the Fisher information density from ξ =

.
∞
0 the integration of the Fisher information density given

to ξ = +

−∞

For the general conﬁguration in the limiting case θ
→
in equation (A-5) can be done analytically and yields

(19)

(20)

IF,SH = k2 2
a

min(w,

c
|

)
|

.

Since the maximum of min(w,
) equals a/2, the Fisher information in equation (20) is always bounded by the
|
quantum statistical information given in equation (15). For the special case of the single-border conﬁguration
this can be seen in ﬁgure 13a where the dashed line shows the linear dependence of the Fisher information for
the Shack-Hartmann sensor on the segment width 2w.

c
|

For the general conﬁguration and for a given w = 0.1a, ﬁgure 13b shows the Fisher information for the
Shack-Hartmann sensor as a function of the location of the segment centre. Surprisingly the Fisher information
is zero for a segment in the centre of the aperture.

The Fisher information for the Shack-Hartmann sensor attains its maximum for the centred single-border

conﬁguration, that is for w =

= a/2:

c
|

|

IF,SH,max = k2

,

(21)

and is identical to the quantum statistical Fisher information. Therefore, if all of the relevant information about
the relative segment phase in the diﬀraction pattern could be extracted with an eﬃcient estimator, one could
reach the maximum possible precision, that is the fundamental bound (15) for the estimate of the phase step θ.

6

The formulae given above have been derived for one lens covering the full aperture [

a, +a]. However, in a
phasing wavefront sensor, a single lenslet will only cover a subaperture across a border. For these lenslets the
conﬁguration will ideally be the centred single-border conﬁguration. It can readily be veriﬁed that due to the
linear dependence of the Fisher information on the segment width, the information IF obtained with a single
lens across the full aperture is identical to the information obtained with lenslets across the borders and centred
on the borders, provided that the lenslets cover the full segment width and the segment centre is not too close
to the centre of the aperture. Since the other sensors work over the full aperture, the Fisher information for the
Shack-Hartmann method can therefore be compared with the other methods by using the results for a single lens
covering the full aperture.

−

4.1.2 Information contained in the shift of the maximum of the likelihood function

Figure 2b, applying to the centred single-border conﬁguration, shows that in the most interesting case of θ
λ
nearly 50% of the Fisher information is contained in the interval between the ﬁrst zeroes of the likelihood function
on both sides of the origin. The maximum of the likelihood function is well deﬁned, even in the case of broadband
measurements or in the presence of atmospheric disturbances as shown in sections 6.1 and 6.2. Furthermore,
the position of the maximum depends on the phase step θ. In addition, the position of the maximum is not too
sensitive to small misalignments between the centre of the lens and the border between segments. For small phase
steps θ and small deviations from the centred single-border conﬁguration, described by the diﬀerence c
a/2,
that is for kθ
1, one obtains for the location ξmax(θ) of the maximum of the likelihood
function

1 and k(c

θ
a
This equation shows that the location of the maximum is only weakly aﬀected by the misalignment c
provided that c
≪
in [2] for circular lenslets.

a/2
a. A similar expression for ξmax(θ) without the eﬀect of the decentring has been given

ξmax(θ) =

a/2)2
a2

a/2)

(22)

a/2

3
4

≪

≪

≪

(1

(c

−

−

−

−

−

−

−

4

)

.

For all these reasons, it is of interest to estimate the phase step θ only from the core of the likelihood function
which is deﬁned here as the interval where the likelihood function exceeds 20% of its maximum value at the
centre of the core. Figure 2b shows that for the centred single-border conﬁguration the integral of the Fisher
information density over that interval is approximately 0.3IF,SH,max, that is approximately 30% of the maximum
information can be extracted from the core.

The central core can quite accurately be ﬁtted by a Gaussian

pgauss(ξ

θ) =

|

0.6ka
√π

e−[0.6ka(ξ−3θ/(4a))]2

.

Its Fisher information is given by

≈
This is only marginally larger than the information content 0.3IF,SH,max in the core in the mentioned above. The
reason for the small diﬀerence is probably that the integration of the Gaussian probability function extends from

IF,gauss = 0.4 k2

0.4 IF,SH,max

.

to +

, whereas the one of the diﬀraction pattern only over the central core.

−∞

∞

The shift ξmean of the mean position, i.e. the centre of gravity of the likelihood function, is not identical to
the shift of the central maximum of the diﬀraction pattern. ξmean should be smaller than ξmax since the shift of
ξmax to one side is accompanied by an increase of the ﬁrst peak on the opposite side. For the centred single lens
conﬁguration one obtains from equation (A-4) for the centre of gravity

For kθ

1 this becomes

≪

A comparison with equation (22) shows that this is indeed smaller than the shift ξmax of the maximum by a
factor of 1.5. It is equal to half of the average tilt of the wavefront ϕ(xp) over the aperture in the pupil.

ξmean =

sin(kθ)

.

1
2ka

−

ξmean =

θ
2a

−

.

7

(23)

(24)

(25)

(26)

4.1.3 Information contained in the form of the likelihood function

In some applications a reference pattern generated by the Shack-Hartmann lenslet array may not be available.
Furthermore, an adaptive optics system may partially correct a phase step, in the simplest case by introducing
a constant tilt over a subaperture covered by a lenslet. Such a tilt, the amount of which may not be known, will
lead to a shift of the diﬀraction pattern. Under such circumstances no information can be obtained from the
position of the diﬀraction pattern, and the parameter θ can only be estimated from the changes in the form of
the likelihood function.

The Fisher information contained in the form, from now on called the form-only Fisher information, can be
calculated as follows. The likelihood function for a given phase step θ can be shifted such that its maximum is
closer to the origin. The Fisher information can then be calculated as a function of this shift, with the information
contained in the form being deﬁned as the minimum of the Fisher information as a function of the shift. For the
centred single-border conﬁguration a likelihood function ps shifted by αθ/a is described by

ps(ξ

1
αθ/a)2 [sin(πξ/ξ0 −
Figure 3a shows for a few values of α the Fisher information densities for θ = 0. For arbitrary values of θ the

1
α2πθ/λ)2

α2πθ/λ + 2πθ/λ)

sin(2πθ/λ)]2

(πξ/ξ0 −

1
ξ0

θ) =

(27)

(ξ

−

−

.

|

Figure 3: Shack-Hartmann sensor: (a) Normalised Fisher information density iF(ξ | θ)ξ0/k2 compensated by various
shifts of αθ/a for the limit θ → 0. The values for α are given in the ﬁgure. (b) Normalised Fisher information density in
the form of the likelihood function for four phase steps θ.

minimum Fisher information is analytically obtained for α = 3/4. According to equation (22), for θ
λ such
a shift is equivalent to moving the maximum of the likelihood function back to ξ = 0. Figure 3b shows the
form-only Fisher information densities for four phase steps ranging from θ = 0 to θ = λ/2. A comparison with
ﬁgure 2b shows that for θ = 0 the peaks of the Fisher information densities are much lower than in the case of
the full information and are further from the origin.

≪

For all values of θ the minimum Fisher information in the centred single-border conﬁguration is given by

IF,SH,form = k2/4 .

(28)

Therefore, if an estimate of the phase step θ can only be based on the form of the likelihood function, one needs
four times the number of photons to reach the same precision as is obtainable from the full information, which
includes the information from the position.

4.2 Mach-Zehnder interferometer

The principle of the Mach-Zehnder interferometer as used for the detection of diﬀerential segment phases [4] is
shown in ﬁgure 4. The incoming light is focussed and split into two beams. One of them, which serves as the

8

Telescope
focus

U
1

U1

Phase
plate

Pinhole

U2

U
1

Interfero−
gram 2

Interferogram 1

Figure 4: Mach-Zehnder sensor: Principle of a Mach-Zehnder interferometer as used for the detection of diﬀerential
segment phases.

reference beam, contains a spatial ﬁlter in the focal plane and a phase plate introducing a phase shift φ. The
light from the two beams is then recombined behind a second beam splitter, collimated and registered on two
detectors in planes which are conjugated to the entrance pupil. The spatial ﬁlter is either a pinhole with a sharp
edge or with a Gaussian transmission function with 100% transmission at the centre. If ξ is an angular coordinate
in the focal plane, the transmission functions of the ﬁlters are given by

t(ξ) = 


(cid:26)

1 for
0 for

exp(

−

ξ
|
ξ
|

ζ
> ζ

| ≤
|
ξ2/(2ζ2))

(cid:27)

Sharp

edge

−

Gaussian

,




(29)



where ζ, also in angular coordinates, is either half of the diameter of the sharp pinhole or the RMS of the
Gaussian transmission function. The computation of the likelihood function and the Fisher information density
is outlined in appendix A2. For a sharp-edge pinhole and θ = λ/10, ﬁgure 5a shows the likelihood functions
for four diﬀerent half-diameters ζ of the sharp-edge pinhole, expressed as fractions or multiples of ξ0 = λ/(2a),
and ﬁgure 5b the corresponding Fisher information densities. Similar curves for a Gaussian pinhole are shown in
ﬁgures 6a and 6b.



Obviously, the Fisher information is maximised for some intermediate values of ζ. On the one hand, for very
small pinhole widths the form of the likelihood functions resembles closely the form of the phase in the wavefront
after the reﬂection by the mirrors. However, the Fisher information is small, since only a small fraction of the
light entering the second beam interferes with the light from the reference beam. In the limit ζ
0 one has
ζ2. On the other hand, for large pinholes the form in the interference pattern and the Fisher information
IF,MZ ∝
density are concentrated around the borders between the segments. In the limit of very large pinhole sizes the
two beams are, apart from a constant phase shift, identical and the information content goes to zero as 1/ζ for
. The maximum Fisher information must therefore be obtained for an intermediate size of the pinhole.
ζ
For a segment half-width of w = 0.2a this maximum is obtained for ζ
0.8ξ0 in the case of a sharp pinhole
and for ζ
0.4ξ0 in the case of a Gaussian pinhole, indicated by the dashed-dotted lines in the ﬁgures 5 and 6,
≈
respectively.

→ ∞

→

≈

For the centred single-border conﬁguration the maxima can be obtained from ﬁgure 7a which shows the
normalised sum IF/k2 of the Fisher information in the two beams as a function of the ratio of ζ to ξ0 . In this
case the maximum of the Fisher information is obtained for ζ
0.465ξ0 in the case of a sharp-edge pinhole and
ζ
0.235ξ0 in the case of Gaussian pinhole. Figure 7b shows that these sizes of the pinholes maximising the
Fisher information are for both types of pinholes comparable to the size of the core of the image in the focal
plane. However, even under ideal conditions the maximum Fisher information is only approximately 12% of the
quantum statistical Fisher information in the case of the sharp-edge pinhole and 9% in the case of the Gaussian
pinhole.

≈

≈

9

Figure 5: Mach-Zehnder sensor: (a) Likelihood functions generated by a Mach-Zehnder interferometer with sharp
edge pinholes with radii of 0.1 (dotted), 0.8 (dashed-dotted), 4 (dashed) and 10 times λ/(2a) (solid), for a relative segment
phase θ = λ/10. (b) Corresponding normalised Fisher information densities iF/k2 for θ = 0.

Figure 6: Mach-Zehnder sensor: (a) Likelihood functions generated by a Mach-Zehnder interferometer with Gaussian
pinholes with RMS values of 0.1 (dotted), 0.4 (dashed-dotted), 2 (dashed) and 5 times λ/(2a) (solid), for a relative segment
phase θ = λ/10. (b) Corresponding normalized Fisher information densities iF/k2 for θ = 0.

For the single-border conﬁguration and a width of the pinhole which maximizes the Fisher information the
dotted line in ﬁgure 13a shows that IF,MZ(θ) depends quadratically on the segment width, and ﬁgure 13b shows
that for the general conﬁguration the Fisher information is slighly larger for segments closer to the centre of the
aperture.

However, if the Mach-Zehnder method is applied in a telescope with several segments, the signals from
neighbouring borders have to be well separated. Quite arbitrarily it will be deﬁned that this condition is fulﬁlled,
if the distances between the border and, in the case of the sharp-edge pinhole, the ﬁrst zero, or, in the case of
the Gaussian pinhole, the x-coordinate where the signal has dropped to 10% of the value at the border, are both
approximately equal to w/3, as shown by the solid lines in the ﬁgures 5 and 6. This requires widths of ζ = λ/w
for the sharp-edge pinhole and ζ = λ/(2w) for the Gaussian pinhole. Figure 8 shows that with these choices of
the pinhole widths the Fisher information for the single-border conﬁguration is now proportional to the segment
width w. However, for such widths of the pinholes the Fisher information is much lower than for the widths
maximising the Fisher information.

For well separated signals the Fisher information densities in the neighbourhood of a border are independent
of the segment position. As long as the signals from both borders in a two-border conﬁguration are well within
the aperture, the Fisher information is therefore also independent of the segment location.

10

Figure 7: Mach-Zehnder sensor: (a) Normalised Fisher information IF,MZ/k2 as a function of the normalised pinhole
radius ζ/ξ0 for pinholes with a sharp edge (solid) and with a Gaussian transmission function (dashed) for the centred single-
border conﬁguration. (b) Intensities ﬁltered with a sharp-edge pinhole (solid), and with a Gaussian pinhole (dashed) with
widths which maximise the Fisher information. The dashed-dotted curve represents the unﬁltered diﬀraction pattern for
a phase step θ = 0.

Figure 8: Mach-Zehnder sensor: Normalised Fisher information IF,MZ/k2 as a function of half of the segment width w
in a single-border conﬁguration with pinhole sizes of λ/w for the sharp edge pinhole (solid), and λ/(2w) for the Gaussian
pinhole (dashed).

4.3 Foucault knife-edge test

Diﬀerential segment phases can also be measured by a Foucault test. The incoming beam is focussed, a knife-edge
is placed in the centre of the focal plane, and ﬁnally the beam is collimated and detected in a plane conjugated
to the pupil. By replacing the knife-edge with a glass prism both halves of the beam can be used for the
analysis [10][11][12]. The computation of the likelihood function and the Fisher information density is outlined in
appendix A3. Figure 9a shows the likelihood functions for three locations of the segment centre with a segment
half-width of w = 0.2a and for θ/λ = 0.1, and ﬁgure 9b the Fisher information densities for θ = 0. The widths
of the peaks in the Fisher information densities in the neighbourhood of the borders are approximately equal
to the widths of the peaks in the likelihood functions. The ratio of the width of the Fisher information density
in the neighbourhood of a border to the width 2w of the segment is independent of the other parameters and
approximately equal to 0.2. The information from adjacent borders can therefore always be well separated.

A numerical integration shows that for the centred single-border conﬁguration the Fisher information in one
of the exit pupil equals k2/4. This may intuitively be expected, since only half of the light enters one of the two
exit pupils and only half of the image in the focal plane is used to retrieve information. Adding up the information

11

Figure 9: Foucault sensor: (a) Likelihood function for a relative segment phase θ = λ/10. (b) Normalised Fisher
information density for a relative segment phase θ = 0 and w = 0.2a, and, for both plots, three diﬀerent positions c = 0
(solid), c = 0.5a (dashed) and c = 0.8a (dashed-dotted) of the segment centre.

in both channels gives IF,FC = k2/2. The Foucault sensor with a glass prism therefore extracts potentially half
of the quantum statistical information.

The dashed-dotted line in ﬁgure 13a shows the Fisher information as a function of the segment width in
the single-border conﬁguration. The dependence is quadratic, similar to the case of the quantum statistical
information. For all segment widths the Fisher information of the Foucault sensor equals half of the quantum
statistical information. For the general conﬁguration ﬁgure 13b shows that the Fisher information is eﬀectively
independent of the segment location. Figure 9b shows therefore that the Fisher information density is larger in
the neighbourhood of the single-border in the single-border conﬁguration than in the neighbourhood of the two
borders in the general conﬁguration.

4.4 Curvature sensor

In a curvature sensor the detector is placed at a distance l in front or behind the focal plane, as shown in ﬁgure 10.
Since the diﬀraction pattern is spread over an interval of approximately 2af /l and the intensities are therefore
approximately proportional to l/f , the detector coordinates in the ﬁgures are normalised by a multiplication with
f /(la) and the likelihood function and the Fisher information density are normalised by a multiplication with
l/f . Except for detector positions very close to the aperture, the diﬀraction pattern can be calculated with the

Pupil

2a

Detector

Focal
plane

l

f

12

Figure 10: Curvature sensor: Principle of the curvature wavefront sensor with the detector plane being out-of-focus
by a distance l with respect to the focal plane of the telescope.

Fresnel approximation, which is outlined in appendix A4. In the limit l
0 the expressions for the likelihood
functions and for the Fisher information densities converge to the respective expressions for the Shack-Hartmann
sensor derived in appendix A1. However, the curvature method requires the signals from the two segment borders
to be clearly separated. In other words, the Fisher information densities corresponding to the two borders should
not overlap. For w = 0.2a such a separation in the likelihood function as well as in the Fisher information density
0.002, as shown in the ﬁgures 11a and 11b.
seems to be established for l/f

→

≥

Figure 11: Curvature sensor: (a) Normalised likelihood function for a defocussing ratio l/f = 0.002 and θ = λ/10. (b)
Normalised Fisher information density for l/f = 0.002, both as functions of the normalised detector coordinate xf /(la).
For both plots : a = 1m, f = 20m, c = 0.3a, and w = 0.2a.

Figure 12: Curvature sensor: Normalised Fisher information as a function of the defocussing ratio l/f , and a = 1m,
f = 20m, c = 0.3a, and w = 0.2a.

Figure 12 shows in a log-log-plot the Fisher information as a function of the ratio l/f , and for the same
parameters as in ﬁgure 11. The regime where IF,CV is approximately constant is the Fraunhofer regime. Let the
pure curvature regime be deﬁned as the regime where the signals from two adjacent borders are well separated.
The ratio l/f = 0.002, which is the lower limit for which a separation is guaranteed, lies at the beginning of the
0.1.
regime with a constant slope in the log-log-plot, where IF,CV ∝
With a choice of l/f > 0.002 one is well outside the caustic, that is, the correlation of the subapertures is identical
with that in the pupil.

f /l and which extends at least up to l/f

p

≈

A precise deﬁnition of the signal width which guarantees a separation of signals from adjacent borders is
somewhat arbitrary. Requiring the distance of the ﬁrst zero of the oscillating pattern to be less than a fraction

13

1/z of the segment half-width w leads to the condition

l
f

>

1 +

(cid:18)

w2
0.8z2λf

(cid:19)

−1

.

(30)

If, for diﬀerent widths 2w of the segment, the parameter l/f is always chosen such that the condition (30) is
fulﬁlled for z = 10, the dependence of the Fisher information on the segment width is linear, as in the case of
the Shack-Hartmann sensor, that is in the Fraunhofer limit. However, for the chosen non-overlap condition (30)
the values for the Fisher information are approximately 30 times lower than in the Fraunhofer limit.

IF,CV(θ) is eﬀectively independent of the segment location. This is similar to the case of the Shack-Hartmann
sensor, except that the central dip in the curve for the Shack-Hartmann sensor in ﬁgure 13 is not present in the
case of the curvature sensor with suﬃcient defocussing.

5 Comparison between the four sensors

Figure 13: All sensors: Normalised Fisher information IF/k2 for the single-border conﬁguration as a function of (a) the
segment width 2w and (b) of the segment location for w = 0.1a. The curve for the Mach-Zehnder was obtained with a
sharp-edge pinhole with ζ = 0.465ξ0. The curves for the curvature sensor are calculated for a defocussing which guarantees
that the half width of the segment is approximately ten times larger than the distance from the coordinate corresponding
to a border to the ﬁrst zero of the oscillating pattern.

The Cram´er-Rao bounds for the four types of sensors have been discussed in detail in the preceeding sections.
This section provides a comparison of the relative precision limits which can, in principle, be achieved with these
sensors for the detection of diﬀerential segment phases. Figure 13a shows that for the single-border conﬁguration
under ideal conditions the performance, deﬁned by the Cram´er-Rao bound, of the Shack-Hartmann sensor is
superior to the performance of the Foucault sensor, which in turn outperforms the Mach-Zehnder sensor for all
segment widths. For small segment widths the Fisher information of the Shack-Hartmann and the Foucault
sensors are eﬀectively identical. However, except for the Shack-Hartmann sensor in the centred single-border
conﬁguration with w = a, none of the sensors attains the quantum statistical limit.

For the Shack-Hartmann sensor the Fisher information depends linearly on the segment widths. The de-
pendence is quadratic for the quantum statistical limit, the Foucault sensor, and the Mach-Zehnder sensor with
pinholes diameters maximising the Fisher information.

For a Mach-Zehnder sensor with large pinhole diameters, which guarantee that the signals from adjacent
borders are well separated, the Fisher information is a linear function of the segment width. The maximum value
which is attained for the centred single-border conﬁguration is approximately 0.03 if the signals from adjacent
borders are just separated, and decreases with a better separation of the signals. Also the Fisher information of the
curvature sensor depends, like the Shack-Hartmann sensor as its limiting case for small amounts of defocussing,

14

linearly on the segment width. However, the slope depends strongly on the amount of defocussing, and the
curve in ﬁgure 13 has been calculated for a defocussing which guarantees that the half width of the segment is
approximately ten times larger than the distance from the coordinate corresponding to a border to the ﬁrst zero
of the oscillating pattern. See section 4.4 for further details.

Figure 13b shows that for all sensors, except for the Mach-Zehnder device, the Fisher information is eﬀectively
independent of the segment location within the pupil. However, for large pinhole diameters this also applies to
the Mach-Zehnder sensor. The dip in the curve for the Shack-Hartmann sensor is irrelevant: when such a sensor is
used in a telescope the subapertures would always be deﬁned by smaller lenslets covering only the neighbourhood
around a segment border, and the conﬁguration would then be the single-border conﬁguration.

6 Eﬀects of noise and other parameters

The eﬀects of broadband illumination, atmospheric disturbances, detector readout noise, and discrete sampling
of the likelihood function will only be discussed for the Shack-Hartmann sensor in the centred single-border
conﬁguration. However, the methods used in this section can readily be applied to all other types of sensors and
conﬁgurations.

6.1 Eﬀects of broadband measurements

Figure 14: Shack-Hartmann sensor:
(a) Likelihood functions for a phase step θ = λ/5, (b) normalised Fisher
information densities for θ = 0, integrated over diﬀerent bandpass ratios ∆λ/λc: Monochromatic (solid), ∆λ/λc = 0.25
(dashed), ∆λ/λc = 0.5 (dashed-dotted). The dotted curve in (a) is the limit to which the likelihood functions converge
for very large phase steps, that is kθ ≫ 1, and a bandpass ratio of ∆λ/λc = 0.5.

The number of available photons can be increased with broadband measurements, that is by using a larger
bandpass of the light. The corresponding gain in the information is, however, partially compensated by a loss of
information due to a loss of form in the likelihood function. As shown below, the Cram´er-Rao bound decreases
with an increase of the bandpass strongly initially small bandpasses, but only slowly at large bandpasses.

The likelihood function for a broadband measurement is obtained by integrating the monochromatic likelihood
function over the wavenumber k around a central wavenumber kc with a suitable prior probability distribution
or spectral density pk(k) as a weight function. In the following calculations pk(k) = const is assumed for any
bandpass. Figure 14a shows the likelihood function for three bandpasses and a phase step θ = λ/5. Apparently,
for small phase steps, the position of the maximum of the likelihood function and the width of the central core
are only weakly aﬀected by the bandpass.

The dotted line in ﬁgure 14 shows the limit to which all curves converge for very large phase steps. For such
1, the sine and cosine functions in equation (A-4) containing kθ vary rapidly

large phase steps, that is for kθ

≫

15

with k. The terms containing kθ can therefore be replaced by their average values which are 1/2 for the two
quadratic terms and (1

cos(kaξ))/2 for the mixed term. The dotted curve is then given by

−

pkθ≫1(ξ) =

1
(πka)2

1
k2 −

k1 Z

k1

k2

dk

1
ξ2 [1

−

where k1 and k2 are the integration limits.

cos(ckξ) cos(kξa)]

,

(31)

Figure 15: Shack-Hartmann sensor: (a) Normalised Fisher information IF/k2 and (b) normalised Cram´er-Rao bound
σCRB as functions of the ratio of the width ∆λ of the bandpass to the central wavelength λc. Solid: full information,
dashed: form-only information.

Figure 14b shows the curves for the Fisher information densities for the same bandpasses as in ﬁgure 14a,
but for θ = 0. In the ideal case the peaks in the Fisher information density are, according to equation (1), due
to the zeroes or small values of the likelihood function at those locations. The peaks are now reduced because
the zeroes and the small values of the likelihood functions are washed out by the averaging process. The Fisher
information densities around the second maxima in the curves for θ = 0 disappear nearly completely for larger
bandpasses, and the Fisher information density is therefore concentrated closer to the origin.

Figure 15a shows that, due to the weak dependences of the form of the core and the position of the maximum
on the bandpass, the Fisher information per photon as a function of the bandpass decreases only weakly with
the bandpass. This is true for the full information (solid line) as well as for the form-only information (dashed
line). See section 4.1 for the deﬁnition of form. The decrease of the Fisher information per photon with an
increase of the bandpass is slower than the proportional increase with the number of photons. Therefore the
Cram´er-Rao bound σCRB of the error in the estimate of the phase step decreases continuously with an increase
of the bandpass. This can also be seen in ﬁgure 15b which shows σCRB in units of λ/(2π) for one photon per
nanometer of the bandpass.

6.2 Eﬀects of atmospheric turbulence

Turbulence and temperature inhomogeneities in the atmosphere lead to a non-planarity of the incoming wavefront.
These disturbances reduce the Fisher information, and consequently reduce the precision with which the phase
step can be estimated.

The eﬀects of the atmosphere can be taken into account by writing the complex amplitude U (x) in equa-
tion (A-2) as a product of the complex amplitude Us(x) related to the relative segment phase and a stochastic
function Uatm(x) describing the disturbance introduced by the atmosphere. The likelihood function in equa-
tion (A-3) can then be written as

p(ξ

θ) =

πa

|

k
4

+a

+a−xp

−a

Z

−a−xp

Z

′

dxp

dxp U ∗

s (xp

′)Us(xp

′ + xp) < U ∗

atm(xp

′ + xp)Uatm(xp

′) > eikξxp

.

(32)

16

Figure 16: Shack-Hartmann sensor: (a) Likelihood functions for a phase step θ = 0.1λ under diﬀerent seeing con-
ditions, (b) corresponding normalised Fisher information densities for θ = 0. Seeing conditions: Dotted: no atmosphere,
Dashed-dotted: r0/2a = 2.25 , Dashed: r0/2a = 1.5 , Solid: r0/2a = 0.75 .

The expression in the brackets is the atmospheric structure function. For Kolmogorov turbulence and neglecting
the eﬀects of the inner and outer scales it is given by

< Uatm(xp

′ + xp)Uatm(xp

′) >= exp

3.44

(33)

5/3

xp
r0 (cid:19)

(cid:18)

,

#

"−

where r0 is the atmospheric coherence length. For a given wavelength it can be shown that the likelihood function
depends on ξ and ξ0 only through the ratio ξ/ξ0 and on r0 and a only through the ratio r0/a.

Figure 16a shows for a phase step of θ = 0.1λ the inﬂuence of the atmosphere on the likelihood function
for four diﬀerent seeing conditions, expressed as ratios r0/(2a). As in the case of the integration over a ﬁnite
bandpass the location of the maximum does not depend on the seeing conditions. However, the second maxima
are washed out and the width of the central core increases strongly with deterioration of the seeing.

The Fisher information densities for θ = 0 and four diﬀerent seeing conditions are shown in ﬁgure 16b. As
in the case of larger bandpasses and for similar reasons as given in the corresponding section 6.1, under the
inﬂuence of the atmosphere the Fisher information density is more concentrated near the origin than the Fisher
information density under ideal conditions.

Figure 17: Shack-Hartmann sensor: (a) Normalised Fisher information IF/k2 and (b) normalised Cram´er-Rao bound
σCRB as functions of the ratio of the aperture width 2a to the atmospheric coherence length r0.

For a design of the wavefront sensor one would usually assume a given seeing, that is a given value for r0, and
then deﬁne the width of the lens. Therefore, ﬁgure 17a shows the normalised Fisher information as a function

17

of the ratio 2a/r0, the full information as the solid line and the form-only information as the dashed line. The
strong dependence of the width of the core on the seeing, mentioned above, also explains the strong decrease of
the Fisher information with an increase of the ratio 2a/r0. If the diameter of the aperture is equal to r0 the
Fisher information is already reduced by a factor of approximately 10 compared to the Fisher information under
ideal conditions.

On the one hand the increase of the width of the lens increases the Fisher information due to the larger
number of photons. On the other hand, the Fisher information per photon decreases rapidly with the size of the
lens. The combined eﬀect is given by the product of the Fisher information per photon times the width of the
lens. The corresponding curves for the Cram´er-Rao bounds in units of λ/(2π) are plotted in ﬁgure 17b for a ﬂux
density of one photon per millimeter of the subaperture. Contrary to the situation for broadband measurements,
the Cram´er-Rao bound has a minimum, which is attained for a ratio 2a/r0 ≈

0.4.

Figure 18: Shack-Hartmann sensor: (a) Normalised Fisher information as a function of the readout ﬂux in units of
the ﬂux from the sky source. (b) Normalised Fisher information as a function of the pixel half-width δ.

6.2.1 Eﬀects of detector readout noise

The eﬀect of the readout noise of the detector can be modelled by adding a constant background cbg to the
likelihood function in equation (A-4):

p(ξ

θ) =

+ p0(ξ

θ)

.

cbg
ξ0

|

|

(34)

Here p0(ξ
is the ratio of the constant background to the peak in the ideal likelihood function for θ = 0.

θ) is the likelihood function for one photon without background noise. The value of the constant cbg

|

Figure 18a shows for a narrowband measurement the full Fisher information (solid lines) and the form-only
Fisher information (dashed lines) as functions of cbg. The full Fisher information declines initially much faster
than the form-only Fisher information. The reason for this is that the zeroes in the likelihood function, which
are, according to equation (1), responsible for the strong peaks in the full Fisher information density, disappear
because of the constant background. Since, for large backgrounds, the ratio of the full to the form-only Fisher
information only equals approximately two, the full Fisher information is also more strongly aﬀected than the
form-only Fisher information for large backgrounds. Regarding ﬁgure 18b, see next section.

6.2.2 Eﬀects of the detector pixelization

The eﬀect of ﬁnite pixel sizes δ can be modelled by a product of a comb function, describing the positions of the
centres of the pixels, and a continuous likelihood function which is obtained by averaging, for each ξ, the initial
0 (solid),
likelihood function over the interval [ξ

δ/2, ξ + δ/2]. Figure 19a shows the likelihood functions for δ

→

−

18

Figure 19: Shack-Hartmann sensor: (a) Likelihood functions for pixel half-width of δ → 0 (solid), δ = 0.5ξ0 (dashed),
δ = ξ0 (dashed-dotted), and δ = 1.5ξ0 (dotted). (b) Corresponding Fisher information densities.

δ = 0.5ξ0 (dashed), δ = ξ0 (dashed-dotted), and δ = 1.5ξ0 (dotted). The corresponding Fisher information
densities are shown in ﬁgure 19b for the full information. The strong decline of the Fisher information densities
with the pixel size is also apparent from ﬁgure 18b, which shows that the decrease is linear for small pixel widths.
The eﬀect of the ﬁnite pixels size is similar for the full Fisher information and the form-only Fisher information.

7 Conclusions

This paper has shown that the quantum statistical information relating to a relative segment phase depends
quadratically on the ratio of the segment width to the width of the aperture. The maximum, given by the square
of the wavenumber per photon passing through the aperture, is attained for the case where the segment covers
half of the aperture. In this special case the limiting precision for the measurement of the relative segment phase
error is equal λ/(2π), where λ is the wavelength of the light. Under ideal conditions, that is with narrowband
measurements and negligible atmospheric or detector noise, both the Shack-Hartmann and the Foucault sensor
can, for small ratios of the segment size to the diameter of the full aperture, potentially extract approximately
half of the ultimate quantum statistical information. For the special case that the aperture is only ﬁlled by
two segments with the phase step at the centre of the aperture, the Shack-Hartmann device even reaches the
ultimate precision, and the precision obtained by the Foucault sensor is smaller by a factor of √2. The other
two sensors, Mach-Zehnder and curvature, require in general approximately ten to twenty times the number
of photons in order to reach the same precision as the ﬁrst two sensors. In the case of the Shack-Hartmann
sensor, broadband measurements always increase the precision, whereas the optimum width for the subaperture
corresponding to one lenslet in the presence of atmospheric disturbances is approximately equal to half of the
atmospheric coherence length. Also detector readout noise and the eﬀects of a ﬁnite sampling strongly reduce
the precision. The eﬀects of these disturbances on the other sensors may be diﬀerent from the eﬀects on the
Shack-Hartmann sensor and remain to be investigated.

Acknowledgements

The authors would like to thank R.N. Wilson, R. Mazzoleni, and N. Yaitskova for useful suggestions on the
manuscript and a critical reading of the ﬁnal version.

19

Appendix A : Expressions for the likelihood function and Fisher in-
formation density for the four sensors

In this appendix the expressions for the likelihood functions and Fisher information densities for the four sensors
discussed in the main text are derived.

A1: Shack-Hartmann sensor

For monochromatic light with wavelength λ the Fraunhofer diﬀraction pattern in the focal plane of an inﬁnitely
long cylindrical lens covering a one-dimensional subaperture of width 2a on the mirror can be calculated with a
Fourier transformation. The diﬀraction pattern may be viewed as a likelihood function p(ξ
θ) for the detection
of a photon at a coordinate ξ in the focal plane. ξ is a unitless position variable, related to a true position variable
′ are coordinates
x in the focal or detector plane by ξ = x/f , where f is the focal length of the lens. If xp and xp
perpendicular to the axis of the cylindrical lens, and U the complex ﬁeld in the plane of the cylindrical lens, the
likelihood function is given by

|

p(ξ

θ) =

<

|

+a

−a

Z
+a

k
2π

k
2π

=

dxpU ∗(xp

′′)e−ikξxp

dxp

′U (xp

′)eikξxp

′

>

′′

+a

+a

′

dxp

dxp < U ∗(xp

′) > eikξ(xp

′−xp

′′

)

.

−a

Z
′′)U (xp

−a

Z

−a

Z

(A-1)

(A-2)

The bracket denotes a statistical average over a possibly stochastic ensemble of complex amplitudes U . In this
paper such a stochastic ensemble is used for the treatment of atmospheric eﬀects in section 6.2.

After the substitution xp = xp

′

xp

′′ one gets

p(ξ

θ) =

|

k
2π

−
+a

+a−xp

−a

Z

−a−xp

Z

′

dxp

dxp < U ∗(xp

′)U (xp

′ + xp) > eikξxp

.

(A-3)

Next, the non-stochastic wave function Us related to the relative segment phase as deﬁned in equation (9), is
introduced for U in equation (A-3). With ξ0 = λ/(2a) as the location of the ﬁrst zero in the diﬀraction pattern
for θ = 0 one gets

p(ξ

θ) =

|

1
ξ0

1
(πξ/ξ0)2

+2 sin(πξ/ξ0) sin(π

ξ/ξ0)

cos(π

2πθ/λ)

cos(

ξ/ξ0)

.

(A-4)

sin2(πξ/ξ0) + 2 sin2(π
h

w
a

(cid:16)

w
a
ξ/ξ0 −

c
a

ξ/ξ0)(1

cos(2πθ/λ))

−

c
a

−

(cid:17)i

The Fisher information can easily be computed by introducing the amplitude q(ξ
θ), calculated from equation (A-
4) following equation (4), into equation (8). The lengthy expression for arbitrary values of c, w, and θ is not
quoted here. For the special case of θ

0 one obtains the following much shorter expression:

|

→

iF(ξ

θ

0) =

|

→

4
π2

k2
ξ0

1

(ξ/ξ0)2 sin2(π

w
a

ξ/ξ0) sin2(π

ξ/ξ0)

.

c
a

A2: Mach-Zehnder sensor

The amplitude U1 in the ﬁrst, unmodiﬁed beam in ﬁgure 4 is given by equation (9). After the light in the second
beam passed through the phase plate and the spatial ﬁlter, the amplitude U2 is given by the convolution

(A-5)

(A-6)

U2(x) =

1
√λ

∞

−∞

Z

dx′ U1(x′)T (x

x′)

,

−

20

where T (x) is the inverse Fourier transform of the transmission function (29) of the pinhole. Since the detectors
are in image planes of the pupil, the same coordinates can be used as for the pupil, that is x = xp. The likelihood
functions on the two detectors are then

p1,2(x

θ) =

U1(x

|
where the plus sign refers to p1 and the minus sign to p2. With the special choice of the phase shift of φ = π/2
and the abbreviations

±

|

|

|

|

2 +
θ)
|

U2(x
|

2
θ)
|

2 Re[U ∗

1 (x

θ)U2(x

θ)eiφ]
}

,

(A-7)

1
2 {|

b = kζ
ΨL = Φ(
−
ΨM = Φ(b(c
w
ΨH = Φ(b(c + w

−

−

b(a + x), b(c

w

x))

−
−
x), b(c + w

x))

−
x))

−

x), b(a
−
v
u dz sin z / z
(2/π)
v
(2/√π)
u dz exp(
R
−
R

(cid:26)

Φ(u, v) =

sharp edge pinhole

z2) Gaussian pinhole

,

(cid:27)

(A-8)

(A-9)
(A-10)

(A-11)

(A-12)

one obtains for the two likelihood functions

p1,2(x

θ) =

|

1
8a {

±

W (x, a,

a) +

−

sin(kθ) [W (x, c

−
(W (x,

(ΨL + ΨH)2 + Ψ2

1
4
w, c + w)(ΨL + ΨH)
(cid:2)
a, c

M + 2 cos(kθ)(ΨL + ΨH)ΨM

−
One of the assumptions for the derivation of equation (2) was that the integrated intensity is independent of θ.
0. For both types of pinholes
In the case of the Mach-Zehnder interferometer this is strictly only true for θ
the integrated intensity is a symmetric function of θ with, according to numerical calculations, a quasi parabolic
behaviour around θ = 0. Around the maximum at θ = 0 the derivative of the integrated intensity with respect
to θ is therefore zero.

→

−

−

w) + W (x, c + w, a))ΨM]
}

(cid:3)

(A-13)

The Fisher information is identical in the two beams behind the second beamsplitter. With the deﬁnition

Ψ2 = Ψ2

L + Ψ2

M + Ψ2

H ,

(A-14)

the total Fisher information as a sum of the Fisher information from both beams behind the second beamsplitter
is, in the limit θ

0, given by

IF,MZ =

dx Ψ2

M/

1 + Ψ2/4

+

dx

(Ψ2

L + Ψ2

H)2

Ψ2
M

/

1 + Ψ2/4

.

(A-15)

(cid:0)

c−w

Z

(cid:1)

(cid:0)

−

(cid:1)

(cid:0)

(cid:1) (cid:3)

c+w

→
k2
4a

+a

−a

Z

(cid:2)

A3: Foucault sensor

The Fourier transform T (x) of a Heaviside step function representing the eﬀect of the knife edge in the focal
plane is given by

where the signs + and
respectively. Introducing equation (A-16) into equation (A-6) gives with the deﬁnitions

refer to the two channels with the transmission equal to zero for ξ < 0 and ξ > 0,

−

T (x) =

+ πδ(x)

,

√λ
2π

1
ix

±

(cid:18)

(cid:19)

Y1 = ln

Y2 = ln

x)2
x)2

(c + w
−
w
(c
−
−
x)2
(a
−
(a + x)2

the expression for the likelihood function on the two detectors

U2,FC(x
|

|

2 =
θ)
|

1
8aπ2 {

1
4

±

1 + π2W (x,
Y 2
−
sin(kθ)π(W (x,

1
a, a) +
(1
2
a, a)Y2 −

−

−
W (x, c

cos(kθ)) Y2(Y2 −

Y1)

w, c + w)Y1)
}

−

.

21

(A-16)

(A-17)

(A-18)

(A-19)

The inversion of the sign in front of the sine-term can be understood from the fact that the intensity distribution
must be symmetric with respect to a change of the transmission from ξ < 0 to ξ > 0 and a simultaneous change
of the sign of the phase step θ. A similar expression for the centred single-border conﬁguration has been derived
in [12].

For one channel alone the requirement for the integrated intensity to be independent of θ is not fulﬁlled, since
the centre of gravity of the diﬀraction pattern in the focal plane depends linearly on θ around θ = 0, as shown by
equation (26). However, the requirement is obviously fulﬁlled for the sum of the integrated intensities in the two
channels. Therefore, the formalism has to use the sum of the Fisher information densities in the two channels,
which are, however, in the limit θ
0 the sum of the Fisher information
in the two channels is given by

0, independent of the channel. For θ

→

→

IF,FC =

k2
4a

+a

−a

Z

(Y2 −

W (x, c

w, c

−

−

w)Y1)2

π2 + Y 2

1 /4

(cid:14) (cid:0)

(cid:1)

A4: Curvature sensor

The one-dimensional equivalent of the two-dimensional expression for the complex amplitude in the plane of the
detector given in [5] [7] is

UCV(x

θ) =

|

1

λ(f

l)

−

+a

−a

Z

dxp U (xp |

eikf eiπx2/(λf )

θ) ei π

2 (xp−f x/l)2/ρ2

,

(A-21)

where U is the complex amplitude in the pupil and

p

With the deﬁnition

equation (A-21) can be written as

λf (f
2l

−

l)

.

ρ =

r

η = (xp −

x)/ρ

f
l

UCV(x

θ) =

|

i
2 r

f
l

r

eikf eiπx2/(λf )

(+a−f x/l)/ρ

(−a−f x/l)/ρ

Z

dη Us(η

θ) eiπη2/2

.

|

The expression for UCV has been normalised such that

+∞

∞

Z

dx

UCV(x
|

|

2 = 1
θ)
|

Introducing Us from equation (9) for U in equation (A-24) one obtains with the abbreviations

a

C1 =
((
−
−
C2 =
((c
w
−
C3 =
((c + w
C4 =
((a
−
Ci
Cij = Cj −

C
C
C
C

−
−

f x/l)/ρ)

a

S1 =
((
−
−
f x/l)/ρ) S2 =
((c
w
−
f x/l)/ρ) S3 =
((c + w
S4 =
((a
Sij = Si −

S
S
S
S

−
Sj

f x/l)/ρ)

f x/l)/ρ

f x/l)/ρ
f x/l)/ρ

−
−
f x/l)/ρ

,

(A-26)

where

and

denote the Fresnel integrals, the following expression for the likelihood function:

C

S

UCV(x
|

|

2 =
θ)
|

f
4al

(C2

21 + S2

32 + S2

21 + C2

43 + S2
43

32 + C2
+2 cos(kθ) [C21C32 + S21S32 + C32C43 + S32S43]
C32C43]
+2 sin(kθ) [S12C32 −
+2C21C43 + 2S21S43)

C21S32 + S32C43 −

.

The corresponding expression for the Fisher information density can be readily calculated from the equations (5),
and (A-27) and is not presented here.

22

(A-20)

(A-22)

(A-23)

(A-24)

(A-25)

(A-27)

References

[1] Chanan, G., Troy, M., Dekens, F., Nelson, J., Mast, T.,and Kirkman, D., 1998, Applied Optics, 37, 140

[2] Chanan, G., Ohara, C., and Troy, M., 2000, Applied Optics, 39, 4706

[3] Chanan, G. and MacMartin, D.G., Applied Optics, 43, 608

[4] Yaitskova, N., Dohlen, K., Dierickx, P., Montoya, L., 2005, J. Opt. Soc. Am. A, 1093

[5] Roddier, F., Curvature sensing: a diﬀraction theory, NOAO Advanced Development Program, 87-3

[6] Chanan, G., Troy, M., and Sirko, E., 1999, Applied Optics, 38, 704

[7] Gonzalez, J.M.R., Sensor de curvatura en telescopios con espejo segmentado, 2001, Thesis, Departamento

de Astroﬁsica, Universidad de La Laguna, Spain

[8] Schumacher, A., Devaney, N., 2005, Mon. Not. R. Astron. Soc, 366, 537

[9] Dohlen, K., Langlois, M., Lanzoni, P., Ferrari, M., Journ´ee Scientiﬁque de l’ONERA, Optique Adaptative

Multiconjug´ee pur le Grands et Extrˆemement Grands T´elescopes

[10] Esposito, S., Devaney, N., 2001, ESO Proc. vol. 58, Beyond Conventional Adaptive Optics, 161-166

[11] Esposito, S., Pinna, E., Tozzi, A., Stafanini, P., Devaney, N., 2003, Proc. SPIE, Vol. 5169

[12] Pinna, E., Applicazione del sensore a piramide alla misura di discontinuita del fronte d’onda, Ph.D. thesis,

Universita degli Studi di Firenze, Italy

[13] Esposito, S., Pinna, E., Puglisi, A., Pozzi, A. and Stefanini, P., 2005, Optics Letters, 30(19), 2772

[14] Kendall, M., Stuart, A. (1979), “The Advanced Theory of Statistics”, Vol. 2, Macmillan, New York

[15] Braunstein, S.L., Caves, C.M., and Milburn, G.J., 1996, Annals of Physics, 247, 135

23

