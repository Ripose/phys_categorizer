4
0
0
2
 
r
a

M
 
8
1
 
 
]
s
c
i
t
p
o
.
s
c
i
s
y
h
p
[
 
 
1
v
1
9
0
3
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Acta Crystallographica Section A
Foundations of
Crystallography

ISSN 0108-7673

Received 0 XXXXXXX 0000
Accepted 0 XXXXXXX 0000
Online 0 XXXXXXX 0000

SPEDEN: Reconstructing single particles from their
diffraction patterns

Stefan P. Hau-Riege,a* Hanna Szoke,a Henry N. Chapman,a Abraham Szoke,a
Stefano Marchesini,a Alexander Noy,a Haifeng He,b Malcolm R. How-
ells,b Uwe Weierstallc and John C. H. Spencec

research papers

aLawrence Livermore National Laboratory, USA., bAdvanced Light Source, Lawrence Berkley National
Laboratory, USA., and cDepartment of Physics and Astronomy, Arizona State University, USA.. Corre-

spondence e-mail: E-mail: hauriege1@llnl.gov

SPEDEN is a computer program that reconstructs the electron density of single
particles from their x-ray diffraction patterns, using a single-particle adaptation of
the Holographic Method in crystallography. (Szoke, A., Szoke, H., and Somoza,
J.R., 1997. Acta Cryst. A53, 291-313.) The method, like its parent, is unique that
it does not rely on “back” transformation from the diffraction pattern into real
space and on interpolation within measured data. It is designed to deal success-
fully with sparse, irregular, incomplete and noisy data. It is also designed to use
prior information for ensuring sensible results and for reliable convergence. This
article describes the theoretical basis for the reconstruction algorithm, its imple-
mentation and quantitative results of tests on synthetic and experimentally ob-
tained data. The program could be used for determining the structure of radiation
tolerant samples and, eventually, of large biological molecular structures without
the need for crystallization.

c(cid:13) 2004 International Union of Crystallography
Printed in Great Britain – all rights reserved

1. Introduction

This paper describes our computer program SPEDEN that re-
constructs the density from the diffraction patterns of individ-
ual particles. SPEDEN is of interest for three reasons. Diffrac-
tive imaging promises to improve the resolution, sensitivity,
and practical wavelength range in X-ray microscopy, for three-
dimensional objects that are tolerant to X-rays. A few exam-
ples are defects in semiconductor structures, phase separation
in alloys, nano-scale machines and laser fusion targets. A long-
term vision is the possibility of high-resolution reconstruction
of diffraction patterns of single bio-molecules. Of broad theo-
retical interest is SPEDEN’s unique approach to the reconstruc-
tion of scatterers - a difﬁcult mathematical problem. In the rest
of this section we expand on these three topics.

Reconstruction of the electron density from non-uniformly
sampled, three-dimensional diffraction patterns is of wide in-
terest and applicability with present-day sources. In radiation-
tolerant samples, x-ray diffraction and diffraction tomography
are capable of higher resolution than (straight- or cone-beam)
tomography alone. In tomography, resolution is limited by the
quality of the incident beam and by the spatial resolution of
the detector; in diffraction the resolution can be as ﬁne as the
wavelength of the incident radiation. Experimentally, diffrac-
tion imaging has already produced X-ray images at higher res-
olution than possible with available X-ray optics (Miao et al.,
1999, and He et al., 2002). The price to be paid for these ben-
eﬁts is the intrinsic difﬁculty of the reconstruction. Neverthe-
less, several successful reconstructions from experimental X-
ray data, using the iterative hybrid input-output version of the
Gerchberg-Saxton-Fienup (GSF) algorithm, have been reported
recently (Miao et al., 2002, and Marchesini et al., 2003). The
ﬁrst successful application of this algorithm to electron diffrac-

tion data was reported in 2001 (Weierstall et al., 2002), and
it has been used more recently to produce the ﬁrst atomic-
resolution image of a single carbon nanotube (Zuo et al., 2003).
In biology, the use of the GSF has recently been shown to dra-
matically reduce the number of images needed for tomographic
cryoelectronmicroscopy of protein monolayer crystals, so that
phasing can be based mainly on the three-dimensional diffrac-
tion data (Spence et al., 2003).

The development of SPEDEN was also prompted by the
promise of new ways to image bio-molecules. Free-electron
lasers can, in principle, provide X-ray pulses of tens to hundreds
of femtoseconds in length and brightness up to ten orders of
magnitude greater than synchrotron radiation. It was predicted
that, under such circumstances, it should be possible to dispense
with crystals and reconstruct the electron density of single bi-
ological particles from their diffraction pattern (Neutze et al.,
2000). In proposed experiments, a large number of single parti-
cles will be injected into the X-ray beam in random orientation
and their diffraction patterns will be recorded, each in a single
shot of the free-electron laser. Such diffraction patterns will be
very noisy and their resolution will be limited by the signal to
noise (S/N) ratio. The measured diffraction patterns that corre-
spond to different orientations of the particle will be classiﬁed
into a number of mutually exclusive classes. The images within
each class will then be averaged and the class averages assem-
bled into a three-dimensional diffraction pattern by ﬁnding their
mutual orientation relationships. Finally, the three-dimensional
diffraction pattern will be reconstructed to yield the electron
density of the molecule.

We have worked on the analysis of all three steps of such an
experiment. The essence of the ﬁrst analysis is that the maxi-
mum X-ray intensity at a given pulse length is limited by the

1

research papers

requirement that the molecule stay intact during the pulse, even
though it eventually disintegrates (Hau-Riege et al., 2003). The
second analysis discusses the division of noisy diffraction pat-
terns into a number of distinct classes. If the images are divided
into too few classes, the available resolution is not realized. If
the patterns are divided into too many classes, the class averages
will be poor and the pattern quality suffers. The individual class
averages, each corresponding to a well-deﬁned orientation of
the particle, will be assembled into a three-dimensional diffrac-
tion pattern. The result will be a three-dimensional diffraction
pattern that is measured at a limited number of orientations. It
will be, therefore, sparse, irregular and will have a limited signal
to noise ratio (Huldt et al., 2003).

The program SPEDEN, described in this paper, provides a
way to optimally determine the electron density from such a
three-dimensional ensemble of continuous diffraction patterns.
We ﬁrst give an analysis of their properties and discuss the
methods and the expected difﬁculties of reconstructing a “sen-
sible” electron density from them. We then describe how SPE-
DEN adapts the Holographic Method (Szoke et al., 1997a) in
crystallography to deal with continuous diffraction patterns as
opposed to discrete Bragg spots; this will be discussed in the
next section. We then report quantitative results of preliminary
tests for verifying the correctness of our method. These tests
use computed and measured diffraction patterns from samples
of inorganic particles.

2. SPEDEN: The Program

2.1. Theoretical Considerations

2.1.1. Mathematical background The reconstruction of the
density of scatterers from its diffraction pattern is an “inverse
problem”. Other, well-studied inverse problems are those of
computed tomography, image deblurring, phase recovery in as-
tronomy, and crystallography. In tomography, for example, an
inversion algorithm (e.g. ﬁltered back projection) is used to re-
cover the density of scatterers from the measured tomograms. It
is widely recognized that the reconstructed density is very sen-
sitive to inaccuracies in the measurement. Small errors in the
diffraction pattern cause large errors in the reconstruction. This
property is called ill-posedness or ill conditioning.

The reconstruction of the electron density from x-ray diffrac-
tion patterns is indeed ill conditioned. It also has two additional
difﬁculties. First, in contrast to tomography, there are no direct
inversion algorithms – not even approximate ones. Second, the
reconstructed electron density at any sample point is inﬂuenced
strongly by the electron densities of all sample points, as op-
posed to a limited number of them. Therefore, errors in density
are non-local and “propagate” far.

Fortunately, very good fundamental discussions of these sub-
jects are provided in the books of Daubechies (Daubechies,
1992), Bertero and Boccacci (Bertero et al., 1998, Bertero,
1989) and Natterer (Natterer, 1996, Natterer and W¨ubbeling,
2001). In somewhat simpliﬁed terms, the reconstruction of
the electron density is similar to ﬁnding the inverse of an ill-
conditioned non-square matrix, a subject thoroughly discussed

2

in Golub and van Loan (Golub et al., 1996). We consider these
mathematical properties to be essential for understanding the
successes and limitations of reconstruction algorithms; we will
try to be fully cognizant of them in the discussion that follows.

2.2. The phase problem of crystallography, oversampling

The crystallographic phase problem is a good starting point
for further discussion. It was ﬁrst realized by Sayre (Sayre,
1952) that the number of observable complex structure factors,
limited by the Bragg condition, is equivalent to a critical sam-
pling of the electron density in the unit cell of the crystal. The
sampling theorem of Whittaker and Shannon teaches us that,
if the amplitudes and phases of all the diffraction peaks were
accurately measured, the electron density could, in principle,
be reconstructed everywhere (Bricogne, 1992). Unfortunately,
only the amplitudes of the Bragg reﬂections are measured, not
their phases. Therefore there is not enough information in the
diffraction pattern for a unique reconstruction of the electron
density. Sayre proposed (Sayre, 1980) that if we could mea-
sure the diffraction amplitudes “in between” the Bragg peaks,
we should have enough information to reconstruct the electron
density, or to “phase” the diffraction pattern. This is exactly the
situation in diffraction from a single particle.

Nevertheless, it is still difﬁcult to reconstruct the electron
density, even from a well “oversampled” diffraction pattern.
One corollary of critical sampling is that the amplitudes and
phases of the Bragg reﬂections of a crystal are independent of
one other, but any structure factor in between them depends on
the surrounding ones to some extent. Therefore, too much over-
sampling does not help to obtain independent data, although it
does improve the S/N ratio by reducing the noise. Ill posedness
is still with us, although with oversampling, the error propagates
less. An additional difﬁculty with diffraction patterns from a set
of discrete orientations of a particle is that at low resolution the
diffraction pattern is well oversampled while at high resolution
the sampling is sparse. A fundamental property of diffraction
is that the position and the handedness of the electron density
are undetermined, resulting sometimes in stagnation of the al-
gorithm and drift in the position of the results (Stark, 1987).

There are two well-known, necessary remedies for the lack of
information and for the ill posedness of the reconstruction prob-
lem. The more important one is the need for more information.
For example, one way to include a priori knowledge is to accept
reconstructed electron densities only if they are “reasonable”.
The second remedy is to use “stabilized” or pseudo-inversion
algorithms. In the next section we introduce our version of a
real space reconstruction algorithm; we will argue that our al-
gorithm deals with all these problems optimally, at least in some
sense. We return to the comparison of our algorithm with other
methods for phase-recovery in Section 2.3.
subsectionSpeden, a real-space algorithm
In this section we outline the workings of our reconstruction
program, SPEDEN. SPEDEN uses a real-space method for recon-
struction; its acronym stands for Single Particle Electron DEN-
sity. For computational efﬁciency the particle to be recovered
is put into a ﬁctitious unit cell that is several times larger than

the particle itself. All reconstruction algorithms use this artiﬁce
in order to be able to calculate structure factors by fast Fourier
transform techniques. The resulting similarity with crystallogra-
phy enables the use of many crystallographic concepts. In fact,
the recognition of this similarity enabled us to write a program,
SPEDEN, based on our crystallographic program, Eden, with
relatively small modiﬁcations.

The most signiﬁcant difference between the two programs
is that in crystallography the Bragg condition restricts the re-
ciprocal lattice vectors to integer values, while the continuous
diffraction pattern can be - and usually is - measured at arbitrary,
non-integer values of the reciprocal lattice vectors.

In SPEDEN, in common with EDEN, the (unknown) electron
density is represented by a set of Gaussian basis functions, with
unknown amplitudes, that ﬁll the ﬁctitious unit cell uniformly.
This way the recovery is reduced to the solution of a large set
of quadratic equations. The program “solves” these equations
by ﬁnding the number of electrons in each basis function so
as to agree optimally with the measured diffraction intensities
as well as with other “prior knowledge”. Prior knowledge in-
cludes the emptiness of the unit cell outside the molecule, the
positivity of the electron density, possibly some low-resolution
image of the object, etc. Each one of those conditions is de-
scribed by a cost function that measures the deviation of the cal-
culated data from the observed data. One of the cost functions
describes the deviation of the calculated diffraction pattern from
the measured one; others depend on the deviation of the recov-
ered density from prior knowledge. Measured data are weighted
by their certainty (inverse uncertainty), other prior knowledge is
weighted by its “reliability”. The mathematical method used is
(constrained) conjugate gradient optimization of the sum of cost
functions. At each step of the optimization, there is a set of am-
plitudes available that describe the current electron density in
the full unit cell. A full set of structure factors is calculated by
Fourier transforming the current electron density. When the unit
cell is larger than the particle, the structure factors can be sta-
bly interpolated to compare them with measured structure factor
amplitudes.

We refer to the cited literature that shows that the procedure
we outlined is equivalent to a stabilized (quasi) solution of the
inverse problem (Daubechies, 1992; Bertero et al., 1998; and
Natterer et al., 2001). As such, it is optimally suited for sparse,
irregular, incomplete and noisy data.

In the following subsections we describe very brieﬂy the
common features of Eden and Speden as well as their differ-
ences. A more complete description of Eden can be found in
previous papers (Szoke et al., 1997a, and Szoke, 1998).

2.2.1. Representation of the electron density The electron
density is represented as a sum of basis functions, adapted to
the resolution of the data. Speciﬁcally, we take little Gaussian
“blobs” of width comparable to the resolution, and put their cen-
ters on a regular grid that ﬁlls the “unit cell” and whose grid
spacing is comparable to the resolution. The amplitudes of the
Gaussians are proportional to the local electron density. In fact,
the number of electrons contained in each Gaussian constitutes

research papers

the set of our basic unknowns. The above is identical to the rep-
resentation of the electron density in EDEN.

Some mathematical details follow. The actual formula for the
representation of the electron density as a sum of Gaussians is

ρunknown(r) ≃

1
(πηD r2)3/2

P

Xp=1

n(p) exp

−|r − r(p)|2
ηD r2

(cid:20)

(cid:21)

.

(1)

The centers of the Gaussians are positioned at grid points,
r(p), where p is a counting index. In our ﬁctitious unit cell,
the grid is orthogonal, the grid spacing is D r and the centers of
the Gaussians are usually on two intercalating (body centered)
grids for best representation of the electron density. The num-
ber η of the order unity, determines the width of the Gaussians
relative to their spacing, D r. Finally and most importantly, n(p)
is the unknown number of electrons in the vicinity of the grid
point r(p). The values of n(p) are real, and in future may also
be complex-valued to allow for photo-absorption in addition to
scattering. (The latter can be signiﬁcant when diffraction mea-
surements are made at longer X-ray wavelengths.)

Given n(p) the structure factors can be calculated by

Fcalc(h) = e−η(πD r|F T h|)2

n(p) exp [2πih · Fr(p)] ,

(2)

P

Xp=1

using a fast Fourier transform. The vector h, a triplet of inte-
gers, denotes the reciprocal lattice vector, the operator F trans-
forms from real space (Cartesian) coordinates to fractional co-
ordinates, and F T denotes the dual transformation.

The constants appearing in Eqs. (1, 2) were discussed in some
detail previously (Szoke et al., 1997b). For completeness, we
deﬁne them here. The crystallographic B factor is given by
B = (2πD r)2 η. The “crystallographic resolution”, d, deter-
mines the grid spacing, D r by the relation, D r ≈ fspaced, where
fspace is a constant of the order unity. For a body-centered lattice
we set fspace = 0.7 and η = 0.6. For a simple lattice, we use fspace
= 0.6 and η = 0.8.

Note that the Gaussian basis functions are not used in a one-
to-one correspondence with single atoms, but are simply used
to describe the 3D electron density at the resolution that is ap-
propriate to the data resolution. In the special case that the reso-
lution was about the size of an atom and an atom happened to be
sitting exactly on a grid point, that atom would be represented
by a single basis function. If the atom is not on a grid point,
or if the atom happens to be fat, because of thermal motion,
that same atom would be represented by many basis functions.
Similarly, at lower resolution, a single basis function represents
assemblies of atoms.

2.2.2. Reciprocal space knowledge The measured diffrac-
tion pattern of the molecule is proportional to the absolute
square of the structure factors. In SPEDEN we do account for
the curvature of the Ewald sphere. There are two subtle points:
the diffraction pattern is measured only in a ﬁnite number of di-
rections, H(i); and as a rule, those directions are not along the
reciprocal lattice vectors of the (ﬁctitious) unit cell for a single

3

research papers

particle. In other words, the measurement directions, H(i), are
usually not integers and they are not uniformly distributed in
reciprocal space. This is the main difference between crystal-
lography and single particle diffraction and, therefore, between
EDEN and SPEDEN. The essence of any reconstruction algo-
rithm is to try to ﬁnd an electron density distribution such that
the calculated diffraction pattern matches the observed one. In
our representation, we try to ﬁnd a set of n(p), such that

|Fobs(H(i))|2 = |Fcalc(H(i))|2 ,

(3)

for each measurement direction, H(i). Let us assume for a mo-
ment that H(i) are integers. When the representation of the un-
known density is substituted from (2), for each measured value
of H(i), equation (3) becomes a quadratic equation in the un-
knowns, n(p). The number of equations is the number of mea-
sured diffraction intensities. It is usually not equal to the number
of independent unknowns that are the number of grid points in
the unit cell. The equations usually contain inconsistent infor-
mation, due to experimental errors. The equations are also ill
conditioned and therefore their solutions are extremely sensi-
tive to noise in the data. Under these conditions the equations
may have many solutions or, more usually, no solution at all.
Our way of circumventing these problems is to obtain a “quasi
solution” of (3) by minimizing the discrepancy, or cost function
(see e.g. Stark, 1987, and Bertero et al., 1998)

χSpeden =

w′(H(i))2 [|Fobs(H(i))| − |Fcalc(H(i))|]2

(4)

Xi

The weights, w′(H(i))2, are usually set to be proportional to
the inverse square of the uncertainty of the measured structure
factors, 1/σ2(H(i)). As discussed by Szoke (Szoke, 1999), this
is equivalent to a maximum likelihood solution of the equations.
Let us now discuss the ﬁrst, previously ignored difﬁculty in
the reconstruction. When we try to reconstruct the electron den-
sity from real experimental data, we have to compare the set of
measured |Fobs(H(i))|, where H(i) are not necessarily integers,
with the calculated structure factor amplitudes, |Fcalc(h)|, that
are on a regular grid, i.e. have integer h. In principle, given
an electron density of the molecule, one could calculate the
structure factors in the experimental directions. Nevertheless,
for computational efﬁciency, we put the (unknown) molecule or
particle into a ﬁctitious unit cell that is larger than the molecule.
We will also demand that the Gaussians outside the molecular
envelope be empty. (In practice, sizes of molecules are known
from their composition; particle sizes and shapes may be known
from lower-resolution imaging.) As long as the distances of the
Gaussian basis functions are kept to be the experimental resolu-
tion, the number of “independent” unknowns neither increases
nor decreases, in principle, by this computational device. The
structure factors are calculated on an integer grid in the large
unit cell, so they are essentially oversampled in each dimension
by the same factor of the size of the large cell to the size of the
molecule. The oversampling allows stable interpolation of the
calculated structure factor amplitudes from integer h to the frac-
tional H(i) everywhere, independent of the density of the actual

4

measurements. Note that interpolation from fractional H(i) to
integer h is not always a stable procedure!

In the present implementation of SPEDEN, we get sufﬁcient
accuracy with the simplest, tri-linear interpolation in the ampli-
tudes of |Fcalc(h)| if we choose the ﬁctitious unit cell to be three
times larger than the molecule in each dimension. Now, some
mathematical details: the reciprocal space vector H(i) is within
a cube, bounded by eight corners h(i, j), , { j = 1, 8} with inte-
ger values. Let us denote the fractional parts of the components
of H(i) as (H, K, L). We deﬁne weights for the eight corners,
w(i, j), by taking the products of the fractional parts of H, or
(1 − H) with those of K or (1 − K) and L or (1 − L). The cost
function to be minimized now becomes

χSpeden =

w′(H(i))2 ·

Xi



8

Xj=1



|Fobs(H(i))| −

w(i, j)|Fcalc(h(i, j))|

.(5)

2



A similar approach of applying crystallographic algorithms
to continuous diffraction data has been done with direct meth-
ods [Spence et al., 2003]. In this case, however, the Ewald
sphere was approximated by a plane.

2.2.3. Real space knowledge (targets) Let us assume that
we have some, possibly uncertain, knowledge of the electron
density in parts of the unit cell from an independent source, i.e.
one that does not come from the X-ray measurement itself. This
is the kind of knowledge present when the unknown molecule
is placed into a larger unit cell and we demand that the unit cell
be empty outside the molecule. This kind of knowledge was
also referred to as a “sensible” electron density in the introduc-
tion. We represent this knowledge by a target electron density
ntarget(p) and by a real-space weight function w′(p)2. It will be
desirable that the actual electron density of the molecule, ρ(r),
as represented by n(p), be close to the target electron density;
the weight function w′(p)2 expresses the strength of our belief
in the suggested value of the electron density. Note that target
densities can be assigned in any region of the unit cell indepen-
dently of those in any other region. The simplest way to express
the above statement mathematically is to minimize the value of
the cost function

χspace =

λspace

w′(p)2 [n(p) − ntarget(p)]2 ,

(6)

A
2

P

Xp=1

where λspace is a scale factor and A is a normalizing constant,
described in Somoza et al., 1995. (In the absence of information
at and around the molecule, weights are generally unity where
it is known that there is no molecule and zero elsewhere.) The
same procedure is used in EDEN.

2.2.4. Low resolution target (phase extension) The knowl-
edge of the electron density at low resolution can be expressed
by a low-resolution spatial target. Crystallographers call this
phase extension. The essence is that, during the process of the
search for an optimal electron density, we try to keep its low
resolution component as close to the known density as possible.
A convenient way to accomplish this is the following. Given
n(p), we smear out its Gaussian representation and compare it
to the equally smeared out target. Actually, it is easier to carry
out the computation in reciprocal space. We deﬁne

χphasext = λphasext

w′(h)2 |Fsmear(h) − Ftar(h)|2 ,

(7)

Xi

where the current “smeared” structure factors are calculated us-
ing the low resolution, D R,

P

Xp=1

Fsmear(h) = exp[−η(πD R|F T h|)2]

n(p) exp[2πih · Fr(p)].

(8)
The original low-resolution target is prepared analogously
from the (presumably) known electron density, ntar(p). The
same procedure is used in EDEN.

2.2.5. Minimization of the cost function In the presence of
a target density, the actual cost function used in the computer
program is the sum of χSpeden (5), χspace (6) and χphasext (7)

χtotal = χSpeden + χspace + χphasext .

(9)

The fast algorithm described in Somoza et al., 1995, and
Szoke et al., 1997b, is always applicable to the calculation of
the full cost function, (9). There is a clear possibility of deﬁn-
ing more target functions. They are all added together to form
χtotal that is minimized to ﬁnd the optimum electron density.

The minimization of the cost function (9) is carried out in
SPEDEN (as in EDEN) by D. Goodman’s conjugate gradient al-
gorithm (Goodman, 1991). It has proven to be very robust and
efﬁcient in years of use in EDEN. The essential properties of the
algorithm that make it so advantageous for our application is
that the positivity of the electron density, n(p) ≥ 0, is always
enforced and that the gradient vector in real space can be calcu-
lated by fast Fourier transform. The gradient calculation needed
only a very simple modiﬁcation for the interpolation in recip-
rocal space, Eq. (5). The line search algorithm does not use the
Hessian, so matrices are never calculated.

As with any local minimization, global convergence is not
achieved. We discussed this problem in our previous papers and
came to the conclusion that, usually, the minimum surface of
the cost function (7) is so complicated that ﬁnding a global min-
imum would take more computer time than the existence of the
universe.

2.3. Comparison to iterative algorithms

research papers

The “recent” period of algorithms started with the work of
Miao, Sayre and Chapman (Miao et al. 1998) who pointed out
that the fraction of the unit cell where the density is known is an
important parameter for convergence. In somewhat later work,
with oversampled structure factors calculated on a regular grid,
the crystallographic program EDEN successfully demonstrated
the recovery of the electron density using a simulated data set
from the Photoactive Yellow Protein (Szoke, 1999). The protein
was put into a ﬁctitious unit cell, twice the size of the original
one, and a target with zero density was used outside the orig-
inal unit cell of the protein. Similarly, Miao and Sayre (Miao
et al., 2000) have studied empirically how much oversampling
is required in two- and three-dimensional reconstructions of a
simulated data set; using a version of the Gerchberg – Saxton
– Fienup (GSF) algorithm. Among recent articles we mention
Robinson et al (2001), Williams et al (2003), Marchesini et al.
(2003) and references therein, in addition to those mentioned in
the Introduction.

All reconstruction algorithms of oversampled diffraction pat-
terns use a priori information on the shape and size of the parti-
cle. In our previous studies in crystals we found that such infor-
mation is very valuable. For example, EDEN converges surpris-
ingly well for proteins at low resolution where the only infor-
mation used is that the molecule is a single “blob”. EDEN also
converges for synthetic problems with a good knowledge of the
solvent volume, which is greater than 50% (Beran et al., 1995)
or 60% (EDEN). A similar conclusion was reached in Miao et
al. (1998). In comparison, when a molecule is embedded in a
3-fold larger ﬁctitious unit cell, the empty “solvent” occupies
∼96% of the cell volume.

As discussed previously, the reconstruction of scatterers from
their diffraction pattern is a difﬁcult mathematical problem. In
many cases the indeterminacy of the absolute position of the
object and of its handedness causes difﬁculties in convergence.
That is deﬁnitely the case with SPEDEN so, in that sense, SPE-
DEN is not a good algorithm. Empirically, the GSF algorithm
has a larger radius of convergence and deals better with stagna-
tion (Marchesini et al. 2003)

Another family of difﬁculties arises when there is a priori in-
formation available, but there is only incomplete and noisy data.
Under such conditions the main questions are how to ﬁnd a so-
lution that optimally takes into account the available informa-
tion and that is the best “sensible” one that reproduces the noisy
and incomplete data to its limited accuracy. It is this second set
of conditions for which SPEDEN was written. Although, in this
paper, we show only its performance for artiﬁcial and “easy” but
incomplete data, SPEDEN’s older sister, EDEN has been shown
to have those properties on a large range of crystallographic data
sets, ranging from CuO2 to the ribosome. We expect that such
properties of EDEN will be inherited by SPEDEN, considering
that their fundamental mathematical properties are sufﬁciently
similar.

Reconstruction of the scatterer from a continuous diffraction
pattern has a tangled history replete with repeated discoveries.
Some of the present authors are also guilty of ignorance of prior
work. We referred to the pioneering insights in Section 2.1.2.

The best known, and successful class of algorithms is the
group of iterative transform algorithms that we refer to as
Gerchberg-Saxton (GS) (Gerchberg et al., 1972), and its devel-
opment, in which support constraints and feedback are added,

5

research papers

the GS-Fienup (GSF) or hybrid input-output algorithm (Fienup
et al., 1982; Aldroubi et al., 2001; Bauschke et al., 2002;
Bauschke at al., 2003). The essence of the GSF algorithms is
that they iterate the N-pixel data between real and reciprocal
spaces via FFTs and enforce the known constraints in each of
these spaces.

Depending on the degree of noise in the data, these algo-
rithms usually converge in about a hundred to a thousand it-
erations. The weak convergence (non divergence) of the GS
algorithm has been proven in the absence of noise (Fienup et
al., 1982). There is no mathematical proof that these algorithms
will converge in general, but it is reasonable that by sequen-
tially projecting onto the set that satisﬁes the real space con-
straints and the set that satisﬁes the reciprocal space constraints,
the intersection (corresponding to a valid solution) should be
approached. This is deﬁnitely true for projections onto convex
sets, but unfortunately these sets are not convex (Stark, 1987).
In practice, despite the fact that the modulus constraint is non-
convex, the algorithms often converge even in the presence of
noise in about several hundred iterations.

The main difference between the GSF algorithms and
SPEDEN is that SPEDEN does not iteratively project onto the
sets of solutions that satisfy the real-space or reciprocal space
constraints separately, but rather it minimizes a cost function
that includes all the constraints of both spaces. It does this by
varying quantities in real space only (the n(p)’s) and the cost
evaluation only requires a forward transform from real space to
reciprocal space. As the cost function never increases, SPEDEN
reaches only a local minimum.

In spite of its “small” radius of convergence, there are some
expected advantages to SPEDEN’s algorithm.. In SPEDEN we
compare the Fcalc to the Fobs by interpolating from the samples
of Fcalc(h), calculated on a regular grid, to the measured sample
vectors H. Since the gridded |Fcalc(h)| are a complete set (due to
the fact they are sampled above the Nyquist frequency) the in-
terpolation is stable and performed with little error. Since an in-
verse transform is required in the GSF algorithms, the measured
diffraction data |Fobs(H(i))| (recorded on Ewald spheres in re-
ciprocal space) must be interpolated to the gridded data points
h. The observed data might not be a complete set, especially at
high resolution where the density of samples is sparser: this may
lead to error. An additional possible difﬁculty with the GSF al-
gorithms is that the effective number of unknowns may increase
with the size of the ﬁctitious unit cell, while in SPEDEN the ef-
fective number of unknowns is constant. Finally, in SPEDEN,
weightings can be properly applied to all data and knowledge.
The measured data is inversely weighted by its uncertainty; it
is a procedure equivalent to maximum likelihood methods and
it should be optimal, at least in theory. As a side effect, when
the constraints are inconsistent, SPEDEN still converges to a
well-deﬁned and correct solution. (Note that for noisy data the
constraints are almost always inconsistent.) Weightings are also
applied to reﬂect our conﬁdence in real-space constraints, and
these weightings are consistently used in real space.

Tests
SPEDEN has certain built-in limitations. In particular, of

6

course, reconstruction is only as good as the diffraction mea-
surements and derived structure factor amplitudes are reliable.
There are also other less obvious limitations. For example, there
are inherent inaccuracies due to the Gaussian representation of
the electron density in real space. (Szoke et al., 1997a) Also,
the trilinear interpolation for representing integer (hkl) structure
factor amplitudes on a non-integer grid is only approximate. Fi-
nally, as a fundamental limitation of any reconstruction method,
both the absolute position and the handedness of the molecule
are undeﬁned.

We performed preliminary tests to verify the capabilities and
limitations of our reconstruction method using computed and
experimentally obtained diffraction patterns. In this section, we
ﬁrst describe the reconstruction of simple “molecules” from
synthetic diffraction patterns with SPEDEN. Speciﬁcally, we
discuss how the convergence of SPEDEN is affected by the er-
rors due to interpolation in reciprocal space, by the quantity of
observed structure factors, |Fobs|, by the extent of the “known”
starting model, and by the uniformity of sampling in recipro-
cal space. We then describe the reconstruction of simple two-
dimensional objects from synthetic and measured diffraction
patterns with SPEDEN.

2.4. Generation of Synthetic Test Data

We created synthetic “molecules” in the format of the Pro-
tein Data Bank (pdb) ﬁles (Berman et al., 2000). Each molecule
was composed of 15 point-like carbon atoms, placed at random
positions within a cube measuring 16.8 ˚A in each dimension
and “measured” to 4 ˚A resolution; these values correspond to
crystallographic B factors of 185.7 ˚A2. The molecule was then
shifted so that its center-of-mass was at the center of the cube.
All our simulations were repeated using molecules with several
different random arrangements. Initially, the “unit cell” coin-
cided with the dimensions of the cube in which the atoms were
placed; later, larger cells were used and the atoms were posi-
tioned in their center. We also generated “starting models” by
removing atoms from the full ”molecule”.

Both full and partial molecules served to generate structure
factors (Fcalc), using the atomic positions and the B factors.
Starting models were generated from the Fcalc, using SPEDEN’s
preprocessor, BACK, which ﬁnds the optimal real-space repre-
sentation for an input Fcalc. Initially, sets of “measurements”
(|Fobs|) were generated by deleting the phases of the calculated
structure factors of the full or partial molecule. The Fobs ﬁles so
generated had all integer H(i). The uncertainty of the measured
structure factors, σ(h), were chosen to be

σ (h) = α

hFobs(h′)ih′ /10 + Fobs(h),

(10)

q

with α = 0.1 for h 6= (0, 0, 0), and α = 0.01 for h = (0, 0, 0).
We used two alternate methods to generate Fobs ﬁles for non-
integer H(i): In the ﬁrst method, we used a unit cell whose di-
mensions were incommensurate with one another and with the
edge of the cube, but whose volume equaled that of the cube.
The resulting Fobs ﬁle, generated again from Fcalc ﬁles by delet-
ing the phases, then had its indices scaled back appropriately,
yielding fractional H(i). A different second method was used to

sample the reciprocal H(i) space non-uniformly: |Fobs| at frac-
tional H(i) were calculated using tri-linear interpolation from
|Fobs| data on a regular grid that, in turn, was at four times the
regular resolution in reciprocal space.

For each of these Fobs ﬁles, some constraining information is
required in order to ﬁnd the atom positions. We used two types
of constraints: one of them identiﬁed the (approximate) empty
region; the other one used Fcalc at a considerably lower reso-
lution. We call them the empty target and the low-resolution
target, respectively. Both are based on the assumption that at
a considerably lower resolution, the general position of atoms
as one or more “blobs” in empty space is known. The low-
resolution FScalc was prepared by smearing the full Fcalc ﬁle
to 10 ˚A. The empty target identiﬁed the empty points in terms
of a mask. Then, throughout SPEDEN’s iteration process, using
the solver SOLVE, the program attempted to match the current
electron/voxel values in masked-in regions to empty (n(p) = 0)
values. The phase-extension target used the same FScalc ﬁle;
during the iteration process, at each step, the current real-space
solution was smeared to that low resolution in reciprocal space
and restrained to agree with that target.

2.5. Assessment of Quality of Reconstruction

Besides inspecting the reconstructed electron density visu-
ally, we used four quantitative measures to compare the recon-
structed image with the electron density from the full molecule
at 4 ˚A:

a. Real-space RMS error: We calculated the real-space elec-
tron density from the electron/voxel ﬁles, a process we
call regridding. We then calculated the root-mean-square
(RMS) error of the electron densities, ρx and ρ2, deﬁned
as

(ρ1(r) − ρ2(r))2

RMS =

rPr

,

(11)

ρ2
1(r′)+

ρ2
2(r”)

rPr′

Pr”

We permitted one ﬁle to be shifted with respect to the
other ﬁle, in order to minimize the distance.

b. Phase difference: We calculated the average (amplitude-
weighted) phase difference between the Fcalc at the end
of the run and the corresponding Fcalc generated from the
full molecule.

c. Final R factor: We calculated the crystallographic R fac-

tor (Giacovazzo et al., 2002) at the end of the run.

d. Count error: We compared the integrated real-space elec-
tron density generated from a run result with the true
number of electron as identiﬁed in the pdb ﬁle, on
an atom-by-atom basis. The integration was performed
around each atom over a sphere with a radius that was 1.5
times the grid spacing. The ﬁgure-of-merit is the RMS er-
ror.

Of all these measures, the ﬁnal R factor was the least useful
to assess the quality of the reconstructed image. The R factor

research papers

tends to be lower for a small number of entries in the obser-
vation ﬁle since there are fewer equations to satisfy during the
reconstruction. In such a case, a visual inspection shows that
the reconstructed electron density may have little resemblance
to the 15 carbon atoms. However, there was a good correlation
among the other three measures. The solutions looked correct
when the phase difference between solution and full Fcalc was
less than 20 ˚ , the count error between solution and pdb model
was 0.2 or lower (out of 6), and the RMS distance measure was
less than 0.2.

2.6. Overcoming Inaccuracies due to Tri-Linear Interpolation

Through Oversampling

For computational purposes, we placed the (unknown)
molecule or particle into a ﬁctitious unit cell that is larger than
the molecule, and calculated the structure factors on an integer
grid in the large unit cell, oversampled by the same ratio: the
size of the large cell to the size of the molecule. We then cal-
culated the structure factor at fractional H from the structure
factor at integer h using tri-linear interpolation. The interpola-
tion error becomes smaller when larger unit cells are used (at
the expense of computation time). We studied the effect of the
unit cell size on convergence of SPEDEN.

In the initial tests, the unit cell was the same size as the orig-
inal molecule, and the starting (known) part of the molecule
consisted of the full molecule. When the molecule consisted of
atoms on grid points and the Fobs ﬁles had integer H(i), unsur-
prisingly SPEDEN converged, as did EDEN on the same data set.
However, we found that SPEDEN did not converge to a unique
solution if either the atoms were not on grid points or when the
Fobs ﬁle had non-integer H(i), or both, since the solution mean-
dered in real space.

In subsequent tests, we generated larger unit cells and applied
a target over the empty part of the unit cell, in an attempt to re-
strain the meandering problem. We embedded the molecule in a
cell that was 2 or 3 times greater in each dimension. An empty
target was used that essentially covered the empty 7/8-th or
26/27-th of the unit cell, respectively. We applied a high relative
weight for this empty target, and we still used the full molecule
as a starting position. We found that both the larger cell and the
empty target are of critical value in enabling SPEDEN to con-
verge to the correct solution. Comparing the 2-fold larger unit
cell versus the 3-fold unit cell, there was a great improvement
in the latter case. These results show that for tri-linear interpo-
lation, it is adequate to use a unit cell that is 3 times greater in
each dimension. We expect that more sophisticated interpola-
tion algorithms should allow using smaller unit cells.

2.7. Dependence of Reconstruction on the Quantity of Input

Data

A three-fold enlarged unit cell increases the number of un-
known amplitudes of the Gaussians, n(p), by a factor of 27. In
principle, the emptiness of the volume around the molecule re-
strains the effective number of independent unknowns. Never-
theless, if the number of equations, which is given by the num-
ber of entries in the Fobs ﬁle, is not increased, it is easy for

7

research papers

the solver to “hide” electrons among the large number of un-
knowns in the system, even when the empty target constraint is
used. In fact we found that when we compared the ﬁnal Fcalc
from Solve against the starting Fcalc, on the one hand, and the
correct Fcalc on the other, Solve’s ﬁnal Fcalc was closer to the
starting one than to the correct one. In other words, the cost
function in reciprocal space was not a sufﬁciently strong con-
straint in SPEDEN’s algorithm, for this synthetic problem. In
a similar real case, more experimental diffraction patterns need
to be collected in order that SPEDEN would be able to ﬁnd the
corresponding image without other information.

2.8. Recovery of Missing Atoms

In the next set of synthetic tests, we attempted to recover
missing information by starting from a partial model that con-
tained less than the full complement of 15 atoms. In these sim-
ulations, we used Fobs ﬁles with non-integer H(i), a three-fold
enlarged unit cell, an empty target or a phase extension target,
and randomly positioned atoms.

We found that a low-resolution spatial target signiﬁcantly
helps SPEDEN to converge. Figure 1 (a) shows the results of the
comparison of the reconstructed image with the electron den-
sity from the full pdb ﬁle when a phase extension target is used.
The phase extension target was calculated at a resolution of 10
˚A. We found that it was generally possible to recover 5, 10, or
even all 15 of the atoms. Please note that the amount of infor-
mation in such a phase extension target is (4 ˚A/10 ˚A)3 ≈ 6%
of the information in the perfect solution.

It was more difﬁcult to reconstruct the original electron den-
sity when we used an empty target, as shown in Figure 1 (b).
SPEDEN was able to recover 5 out of the 15 atoms, but did
not converge when 10 atoms were unknown. Perhaps surpris-
ingly, the case where there was no starting model at all (0 atoms
known) did consistently better than those cases where a partial
model was given as a starting condition.

2.9. Effect of Non-Uniform Sampling on Recovery

In this set of synthetic tests, we addressed the question of how
difﬁcult it is to recover the molecule from a non-uniform set of
samples in reciprocal space, similar to real data sets, and how
the results compare with the reconstruction from a uniformly-
sampled data set.

We generated two-dimensional diffraction patterns of the
synthetic carbon molecule for different particle orientations,
corresponding to recorded diffraction patterns in a “real” exper-
iment. The two-dimensional diffraction patterns were linearly
interpolated from a three-dimensional diffraction pattern; the
latter was calculated on an additionally double-ﬁne grid over
the already triple-sized unit cells, i.e. using a unit cell that was a
total of six times larger than the molecule in each direction. Fur-
ther reﬁning the grid of the three-dimensional diffraction pat-
tern did not alter the results signiﬁcantly. The three-dimensional
diffraction pattern, in turn, was the Fourier transform of the
gridded electron density of the synthetic molecule.

Two-dimensional patterns do not sample the diffraction space
uniformly. The sampling density near the center of the diffrac-

8

tion space is much larger than the sampling density further
away. We used a completeness measure to characterize the sam-
pling uniformity. The reciprocal space is divided into cells that
are 4π/a by 4π/b by 4π/c in size, where a, b, and c are the
molecule sizes in each dimension. The completeness then is
the ratio of cells in reciprocal space that contain at least one
measurement over the total number of cells. Figure 2 shows the
completeness of the input observation ﬁles as a function of the
number of diffraction patterns. Also shown in Figure 2 is the
number of calculated diffraction intensities.

We then used SPEDEN to recover 7 out of the 15 atoms. The
molecule was embedded in a unit cell that was three times larger
in each dimension, and we used an empty solvent target. Fig-
ure 3 shows the errors of the reconstructed electron density as
a function of the number of two-dimensional diffraction pat-
terns. The orientations of the diffraction patterns were chosen
at random, and the calculations were repeated for four differ-
ent molecules. For comparison, also shown in Figure 3 are the
errors of the electron density of the 8 known atoms (“partial
model”), and the errors of the reconstructed electron densities
when a three-dimensional diffraction pattern is used which was
oversampled three times (“integer hkl”) or six times (“fractional
hkl”).

As discussed above, the R factor is not a useful measure to
assess the quality of the reconstructed image, but the RMS and
count errors are better measures for the reconstruction qual-
ity. Surprisingly, we found that four two-dimensional patterns
are sufﬁcient to reconstruct the electron density as well as in
the case the full three-dimensional diffraction pattern is given.
Four two-dimensional patterns have a remarkably low sampling
completeness of only 14%. Further increasing the complete-
ness or the number of observations does not improve the qual-
ity of the reconstruction. We would like to note, however, that
these results could be dependent on the choice of the test model,
and that for different test models the number of required two-
dimensional patterns may be larger.

2.10. Recovery of Two-Dimensional Data

In the ﬁnal set of tests, we demonstrate SPEDEN‘s ability to
recover missing information for a two-dimensional conﬁgura-
tion of 37 Au balls in a plane. We reconstructed the Au balls us-
ing (i) a synthetic diffraction pattern and (ii) an experimentally
obtained diffraction pattern as discussed by He et al., 2003. In
the following we will discuss both cases, starting with the syn-
thetic diffraction data.

The 37 Au balls are arranged in a plane as shown in Figure 4.
The arrangement of the balls is similar to the experimental case
discussed by He et al., 2003. The Au balls were 50 nm in diam-
eter. We generated an artiﬁcial set of “measurements” (|Fobs|)
by calculating the structure factors (Fcalc) to 30 nm resolution
and deleting the phases. The uncertainty of the measured struc-
ture factors, σ(h), were chosen according to Equation (10). We
generated an initial model by smearing the full Fcalc ﬁle to 90
nm, and running BACK on it. The initial model is shown in Fig-
ure 5. In Figures 5 –7, we only show one plane. We also used
this smeared Fcalc to generate a low-resolution spatial target as

well as an empty target outside the molecule. The correspond-
ing weight function is shown in Figure 6.

We then used SPEDEN to reconstruct the Au balls. As shown
in Figure 7, SPEDEN reconstructed the electron density success-
fully. However, we further found that if we use an empty starting
model, SPEDEN has difﬁculties converging to the correct elec-
tron density. There are two reasons for this behavior. First, with-
out an initial model, the symmetry of the system is not broken,
and SPEDEN stagnates since the support does not distinguish
between the object and its centrosymmetric copy. Second, the
mask and the reconstructed electron density are possibly shifted
with respect to each other. If the initial model is empty, the posi-
tion of the reconstructed electron density is mostly determined
in the early iteration of the SOLVE algorithm and can be par-
tially cut off by the solvent. The algorithm has difﬁculty shifting
the result. It is necessary to provide information about the loca-
tion of the electron density to a certain degree, for example in
the form of a smeared model. Note that the GSF algorithms are
designed to overcome these problems when there is abundant
and accurate data available.

We will now discuss the reconstruction of the Au balls using
experimental data. To generate a starting model, we took the
experimental |Fobs| data along with the phases obtained by He
at al., 2003 using a version of the GSF algorithm, and smeared
this data to 80 nm. The starting model is shown in Figure 8.
We used the same data to generate a real space target with a
target fraction of 99.7%, shown in Figure 9. Similar to the case
of the synthetic test data, we chose σ(h) according to Equation
(10). We then used SPEDEN to reconstruct the Au balls. Fig-
ure 10 (a) shows the reconstructed electron density, and Figure
10 (b) shows a scanning electron microscope (SEM) picture of
the sample. We found that SPEDEN reconstructed the electron
density from the experimental data successfully.

3. Summary and Conclusions
In this paper we presented SPEDEN, a method to reconstruct
the electron density of single particles from their x-ray diffrac-
tion patterns, using an adaptation of the Holographic Method in
crystallography. Unlike existing GSF algorithms, SPEDEN min-
imizes a cost function that includes all the constraints of both
real space and reciprocal space, by varying quantities in real
space only, so that the cost evaluation requires only a forward
transform from real space to reciprocal space. SPEDEN ﬁnds a
local minimum of the cost function using the conjugate gradient
algorithm. We implemented SPEDEN as a computer program,
and tested it on synthetic and experimental data. Our initial re-
sults indicate that SPEDEN works well.

Acknowledgments. This work was performed under the aus-
pices of the U.S. Department of Energy by University of Cal-
ifornia, Lawrence Livermore National Laboratory under Con-
tract W-7405-Eng-48 and DOE Contract DE-AC03-76SF00098
(LBL). SM acknowledges funding from the National Science
Foundation. The Center for Biophotonics, an NSF Science and
Technology Center, is managed by the University of California,
Davis, under Cooperative Agreement No. PHY0120999.

References

research papers

Aldroubi, A, Grochenig, K., 2001. Nonuniform sampling and recon-

struction in shift-invariant spaces. SIAM Rev 43, 585-620.

Bauschke, H., Combettes, P. Luke, D. R., 2002. J. Opt Soc Am. A 19,

p. 1334 - 1345.

Bauschke, H.H., Combettes P.L., Luke D.R., 2003. Hybrid projection-
reﬂection method for phase retrieval. J. Opt. Soc Am. A 20, 1025-
1034.

B´eran, P., Sz¨oke, A., 1995. Simulated annealing for phasing using spa-

tial constraints. Acta Cryst. A51, 20-27.

Berman, H.M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T.N., Weis-
sig, H., Shindyalov, I.N., Bourne, P.E., 2000. The Protein Data
Bank. Nucleic Acids Research 28, 235-242.

Bertero, M., 1989. Linear inverse and ill posed problems. Advances in
electronics and electron physics 75, Academic Press, New York.
Bertero, M., Boccacci, P., 1998. Introduction to inverse problems in

imaging. Institute of Physics, Bristol.

Bricogne, G., 1992. International Tables for Crystallography Vol. B.
Edited by U. Shmueli. Kluwer Academic Publishers, Dordrecht.
Dainty, J. C., Fienup, J. R. (1987). Image Recovery: Theory and Ap-
plications. Edited by H. Stark, Ch. 7. Academic Press, Orlando.
Daubechies, I., 1992. Ten Lectures on Wavelets. CBMS-NSF Regional
Conference Series in Applied Mathematics 61, Society for Indus-
trial & Applied Mathematics, Philadelphia, PA.

Fienup, J.R., 1982. Phase retrieval algorithms: a comparison. Appl.

Opt. 21, 2758-2769.

Gerchberg, R.W., Saxton, W.O., 1972. A practical algorithm for the
determination of phase from image and diffraction plane pictures.
Optik 35, 237-246.

Giacovazzo, C., Monaco, H.L., Artioli, G., Viterbo, D., Ferraris, G.,
Gilli, G., Zanotti, G., Carri, M, 2002. Fundamentals in Crystallog-
raphy. 2nd Edition, Oxford Science Publications (2002).

Golub, G.H., Van Loan, C.F., 1996. Matrix Computations. 3RD Edi-

tion, Johns Hopkins University Press.

Goodman, D. M. (1991). In Proceedings of 7th Workshop on Multi-
Dimensional Signal Processing, Sept. 1991, Lake Placid, New
York. IEEE Signal Processing Society.

Hau-Riege, S.P., London, R.A., Szoke, A., 2003. Dynamics of X-ray

Irradiated Biological Molecules. Submitted for publication.

He, H., Marchesini, S., Howells, M., Weierstall, U., Chapman, H.,
Hau-Riege, S., Noy, A., Spence, J.C.H, 2003. Inversion of X-ray
diffuse scattering to images without secondary imaging. Phys. Rev.
B 67, 174114.

Huldt, G., Szoke, A., Hajdu, J., 2003. Single Particle Diffraction Imag-

ing: Image Classiﬁcation. To be published in J. Struct. Biol.

Marchesini, S., He, H., Howells, M., Weierstall, U., Chapman, H.,
Hau-Riege, S., Spence, J.C.H., 2003. Opt. Expr. 11, 2344-2353
[arXiv:physics.optics/0308064]

Miao, J., Charalambous, P., Kirz, J., Sayre, D., 1999. Extending
the methodology of X-ray crystallography to allow imaging of
micrometre-sized non-crystalline specimens. Nature 400, 342-344.
Miao, J., Ishikawa, T., Johnson, B., Anderson, E.H., Lai, B., Hodgson,
K.O., 2002. High Resolution 3D X-Ray Diffraction Microscopy,
Phys. Rev. Lett. 89, 088303-1-4.

Miao, J., Sayre, D., 2000. On possible extensions of X-ray crystallog-
raphy through diffraction-pattern oversampling. Acta Cryst. A56,
596-605.

Miao, J., Sayre, D., Chapman, H.N., 1998. Phase retrieval from the
magnitude of the Fourier transforms of nonperiodic objects. J Opt
Soc Am. A15, 1662-1669.

Natterer, F., 1996. The mathematics of computerized tomography. Wi-

ley, Chichester.

Natterer, F., Wubbeling, F., 2001. Mathematical methods in image
reconstruction. Society for Industrial & Applied Mathematics,
Philadelphia, PA.

9

research papers

Neutze, R., Wouts, R., van der Spoel, D., Weckert, E., Hajdu, J., 2000.
Potential for biomolecular imaging with femtosecond X-ray pulses.
Nature 406, 752-757.

Robinson, I.K., Vartanyants, I.A., Williams, G.J., Pfeifer, M.A., Pitney,
J.A., 2001. Reconstruction of the shapes of gold nanocrystals using
coherent x-ray diffraction. Phys. Rev. Lett. 87, p. 195505.

Sayre, D., 1952. Some implications of a theorem due to Shannon. Acta

 

Cryst. 5, 843-843.

Sayre, D., 1980. Image processing and coherence in Physics. Springer

Lecture Notes in Physics 112, Ed. M. Schlenker, 229-235.

Somoza, J.R., Szoke, H., Goodman, D.M., Beran, P., Truckses, D.,
Kim, S.-H., Szoke, A., 1995. Holographic methods in X-ray crys-
tallography. IV. A fast algorithm and its application to macromolec-
ular crystallography. Acta Cryst. A51, 691-708.

2003.

SPEDEN,
the
Its
http://www.edencrystallography.org.

SPEDEN is
predecessor,

authors.

available
EDEN,

from any
available
is

of
at

Spence, J., Weierstall, U., Fricke, T., Glaeser, R. Downing, K., 2003. J.

Struct. Biol., in press.

Spence, J. C. H., Wu, J.S., Giacovazzo, C., Carrozzini, B., Cascarano,
G.L., Padmore, H.A., 2003. Solving non-periodic structures using
direct methods: phasing diffuse scattering. Acta Cryst. A59, 255-
261.

Stark, H., 1987. Image Recovery: Theory and applications. Academic

Press, New York.

Szoke, A., 1997a. Holographic microscopy with a complicated refer-
ence. Journal of Imaging Science and Technology 41, 332-341.

0.5

0.4

0.3

0.2

0.1

0.0

0.5

0.4

0.3

0.2

0.1

0.0

 

 

Left Axis:

Count Error
RMS Error
R Factor

Right Axis:

 Phase Error

 

40

80

60

20

0

80

60

20

0

15

10

5

0

 Number of Atoms in Starting Model

Left Axis:

Count Error
RMS Error
R Factor

Right Axis:

 Phase Error

 

 

40

15

10

5

0

 Number of Atoms in Starting Model

Szoke, A., Szoke, H, Somoza, J.R., 1997b. Holographic Methods in X-
ray Crystallography. V. Multiple Isomorphous Replacement, Mul-
tiple Anomalous Dispersion and Non-crystallographic Symmetry.
Acta Cryst. A53, 291-313.

Figure 1
(a) Results of the comparison of the reconstructed image with the electron den-
sity from the full pdb ﬁle in the cases (a) a phase extension target and (b) low-
resolution target are used. The phase error is given in units of degrees.

Szoke, A., 1998. Use of Statistical Information in X-ray C rystallogra-
phy with Application to the Holographic Method. Acta Cryst. A54,
543-562.

Szoke, A., 1999. Time resolved holographic diffraction with atomic

resolution. Chem. Phys. Letters 313, 777-788.

Szoke, A., Szoke, H., Somoza, J.R., 1997. Holographic Methods in X-
ray Crystallography. V. Multiple Isomorphous Replacement, Mul-
tiple Anomalous Dispersion, and Non-crystallographic Symmetry.
Acta Cryst. A53, 291-313.

Williams, G.J., Pfeifer, M.A., Vartanyants, I.A., Robinson, I.K., 2003.
Three-dimensional imaging of microstructure in Au nanocrystals.
Phys. Rev. Lett. 90, p. 175501.

Weierstall, U., Chen, Q., Spence, J.C.H., Howells, M.R., Isaacson, M.,
Panepucci, R.R., 2002. Image reconstruction from electron and X-
ray diffraction patterns using iterative algorithms: experiment and
simulation. Ultramiscroscopy 90, 171-195.

Zuo, J., Vartanyants, I., Gao, M., Zhang, M., Nagahara, L., 2003.
Atomic resolution imaging of a carbon nanotube from diffraction
intensities. Science 300, p. 1419.

10

Figure 2
The completeness and length of the input observation ﬁles used for the calcu-
lations shown in Figure 3.

 

Count Error
RMS Error
R Factor

 

 

0.5

0.4

0.3

0.2

0.1

0.0

l

e
d
o
m

 
l

a
i
t
r
a
p

n
r
e

t
t

a
P
1

 

s
n
r
e

t
t

a
P
2

 

s
n
r
e

t
t

a
P
3

 

s
n
r
e

t
t

a
P
4

 

s
n
r
e

t
t

a
P
5

 

s
n
r
e

t
t

a
P
6

 

s
n
r
e

t
t

a
P
7

 

s
n
r
e

t
t

a
P
8

 

s
n
r
e

t
t

a
P
9

 

s
n
r
e

t
t

a
P
0
1

 

s
n
r
e

t
t

a
P
0
2

 

s
n
r
e

t
t

a
P
0
5

 

s
n
r
e

t
t

 

a
P
0
0
1

l

k
h
 
r
e
g
e

t

n

i

l

k
h

 
l

a
n
o

i
t
c
a
r
f

Figure 3
The error in the reconstructed electron density, as a function of the number
of two-dimensional diffraction patterns. The orientation of the diffraction pat-
terns was chosen at random, and the results were repeated for four different
molecules. Also shown are the error of the electron density of the 8 known
atoms (“partial model”), and the error of the reconstructed electron densi-
ties for a three-times (“integer hkl”) and six-times (“fractional hkl”) in-each-
dimension-oversampled three-dimensional diffraction pattern.

research papers

Figure 5
Initial starting model used for two-dimensional reconstruction from synthetic
data.

Figure 4
Planar arrangement of 37 Au balls for two-dimensional reconstruction.

Figure 6
Weight function used for two-dimensional reconstruction from synthetic data.

11

research papers

Figure 7
Reconstructed electron density using synthetic data.

Figure 9
Weight function used for two-dimensional reconstruction from experimental
data.

Figure 8
Initial starting model for two-dimensional reconstruction from experimental
data.

Figure 10
(a) Reconstructed electron density using experimental data. (b) SEM Image of
Au balls.

12

