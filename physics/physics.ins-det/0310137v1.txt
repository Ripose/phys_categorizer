3
0
0
2
 
t
c
O
 
8
2
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
7
3
1
0
1
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

On image reconstruction with the
two-dimensional interpolating resistive
readout structure of the Virtual-Pixel
detector ⋆

H. Wagner a,

∗, A. Orthen a, H.J. Besch a, S. Martoiu a,

R.H. Menk b, A.H. Walenta a, U. Werthenbach a

aUniversit¨at Siegen, Fachbereich Physik, Emmy-Noether-Campus, Walter-Flex-Str.
3, 57068 Siegen, Germany
bSincrotrone Trieste, S.S. 14, km 163.5, Basovizza, 34012 Trieste, Italy

Abstract

The two-dimensional interpolating readout concept of the Virtual-Pixel detector
(ViP detector) goes along with an enormous reduction of electronic channels com-
pared to pure pixel devices. However, the special concept of the readout structure
demands for adequate position reconstruction methods. Theoretical considerations
reﬂecting the choice and the combination of linear algorithms with emphasis on
correct position reconstruction and spatial resolution are presented. A subsequent
two-dimensional coordinate transformation further improves the image response of
the system. Measured images show how far the theoretical predictions of the simu-
lations can be veriﬁed and to what extent they can be used to improve the position
reconstruction.

PACS: 29.40.Gx, 02.60.Cb

Key words: Two-dimensional interpolating resistive readout structure; Position
reconstruction; Algorithms; Spatial resolution; Population density

supported

⋆ Work
ERBFMGECT980104).
∗ Corresponding author. Tel.: +49 271-740-3563; fax: +49 271-740-3533; e-mail:
wagner@alwa02.physik.uni-siegen.de.

Community

European

(contract

the

no.

by

Preprint submitted to Elsevier Preprint

12 August 2013

1 Introduction

In general, position sensitive pixel detectors feature the advantages of par-
allel and asynchronous readout which means i.e. a proportional increase of
the maximum incoming rate with the sensitive detection area. However, these
pure pixel devices suﬀer from the enormous number of electronic channels
leading either to high costs and eﬀort or essential size limitation of the sensi-
tive area. In contrast to that, interpolating readout concepts which can cover
large areas with a position resolution comparable to pure pixel devices can
also be carried out with parallel and asynchronous readout. They combine the
advantages of pixel detectors with a reduction of electronics and costs at the
same time. For example the interpolating readout can be realised by strips or
pads [1,2,3,4]. We have developed a truly two-dimensional interpolating read-
out concept based on resistive charge division [5]. Since this concept requires
to count single photons the signal of each event has to be ampliﬁed, e.g. by
gas ampliﬁcation. For that purpose e.g. micro pattern devices like GEM 1 [6],
micromegas 2 [7] and CAT 3 [8] can be applied. We have combined the readout
structure with (optimised) MicroCAT gas gain structures [9,10] and a triple-
GEM conﬁguration [11]. In combination with the triple-GEM conﬁguration
this readout concept has already proven its possible application in biological
and chemical diﬀraction measurements [12]. In principle this resistive interpo-
lating readout structure can also be applied with vacuum devices like micro
channel plates.

Beside the advantages of a good time resolution [13] and high rate capability
this two-dimensional interpolation concept demands on the other hand for
a sophisticated choice of position reconstruction algorithms and correction
functions.

2 Detector setup and working principle

−

Primary charge generated in the gas conversion region by incoming photons
(typical energy range: 5
25 keV) via photoelectric eﬀect is led by an homoge-
neous electric drift ﬁeld towards the gas gain region where it is multiplied in
an avalanche process. This charge cluster (a so called event) hits the readout
plane, designed as a two-dimensional resistive structure, where the sensitive
8 mm2 sized cells (Fig. 1). Each cell
area is subdivided into 7
is provided with two diﬀerent surface resistivities in order to obtain both an

7 square, 8

×

×

1 GEM = gas electron multiplier
2 micromegas = micro mesh gaseous structure
3 CAT = compteur `a trous

2

×

7 cells, corresponding to a sensitive area of 56

Fig. 1. Schematic of the two-dimensional
interpolating resistive readout anode
printed on a ceramic substrate. The gas gain structure (e.g. GEM or MicroCAT) is
9 cells, whereby the
mounted above the anode. The structure is subdivided into 9
56 mm2, can be read out.
inner 7
A detailed magniﬁcation of one single cell of the interpolating readout structure
on a ceramic substrate is illustrated on the right hand side. The charge, generated
by a photon, is collected by readout nodes situated at the cell corners (represented
by the black circles). The robust readout structure itself is absolutely insensitive
against sparking or uncontrolled discharges.

×

×

almost linear charge division behaviour in both coordinates and a good electri-
cal shielding to avoid too large charge distributions over several cells. The high
resistivity centres of the cells are surrounded by low resistivity narrow border
strips (s. detail in Fig. 1). This leads to an almost perpendicular projection of
the charges in x- and y-direction onto the low resistivity strips. The surface
resistances of the high resistivity cell centres and the low resistivity strips are
typically R1 = 100–1000 kΩ/✷ and R2 = 1–10 kΩ/✷, respectively. Each cell
is read out at its four corners by low input impedance readout nodes. The
charges collected at the particular nodes are used to determine the event po-
sition within the cell by means of a suitable algorithm. All 64 readout nodes
are equipped with charge sensitive ampliﬁers and 12-bit FADCs which are
linked to a dedicated DAQ system which transfers the preprocessed data for
visualisation to a PC [14].

3 The choice of reconstruction algorithms

The ﬁrst subsection describes the simulation tool which provides the charge
distribution within the readout structure. These theoretical data will be used
in the following to study the partly unfavourable behaviour of diﬀerent linear
algorithms concerning position reconstruction and spatial resolution. After-
wards, the treated algorithms are combined to one more complex algorithm

3

which uniﬁes the advantages of the individual algorithms.

A remark concerning the notation: The expressions for the derivatives ∂x/∂u
and ∂ux are used synonymous.

3.1 The diﬀusion simulation model

Due to the surface resistances and the underlying distributed capacitance the
readout structure behaves like an integrating RC-element resulting in a tem-
poral broadening of the input signal. The simulation of this dynamic charge
diﬀusion process on the readout structure has been realised by means of a
4-cells into account in order
numerical computation programme, taking 4
to include charge ﬂow into adjacent cells (boundary eﬀects). A very detailed
derivation of the diﬀusion model and its numerical solution can be found in
Ref. [15]. In the diﬀusion model a space and time dependent driving current
can be impinged at every grid point. In the simulation, presented here, we
assumed a typical two-dimensional gaussian-like transverse extension of the
charge cloud of σ = 200 µm (mainly caused by the transverse diﬀusion of the
primary electrons in the conversion gap).

×

×

×

4-cell model provides 161

The 4
161 grid points which correspond to a
homogeneous grid point spacing of ∆x = ∆y = 200 µm. The low resistivity
border strips have a width of w = 200 µm, hence they are represented by
one single line of grid points. If not stated diﬀerently the readout nodes are
200 µm2. Since the
represented by one grid point which corresponds to 200
readout nodes can be well approximated as ideal drains [15] the potential at
the nodes is equal to zero at all times.

×

This time-depending diﬀusion simulation is able to provide the currents In(t)
and the charges Qn(t) at every particular node n for all times t. These simu-
lated charges Qn(t) can now be used to reconstruct the event position (u, v) by
means of a suitable algorithm. Depending on the algorithm the reconstructed
position (u, v) will diﬀer up to a certain extent from the (true) impact posi-
tion (x, y). Since this simulation model has proven that its results are in good
accordance to the measurements [15] it is used in the following to obtain the
relationship between the two spaces (u, v) and (x, y) to optimise the applied
reconstruction algorithms. For that reason all further steps are directly based
on the predictions of the diﬀusion simulation.

4

g

cell 0

cell 1

g

0

3

6

1

4

7

2

5

8

cell 2

cell 3

x-direction

y-direction

Fig. 2. This ﬁgure shows the node- and the cell-numeration. The origin of the
coordinate system for the 6- and the 3-node algorithm is located at node 4. For the
4-node algorithm the origin is chosen in the centre of cell 1. The cell size is denoted
with g.

3.2 The linear reconstruction algorithms

∞

Only in the theoretical case of R1/R2 =
the charge division in two dimen-
sions is exactly linear. The required high rate capability limits R1 upwards
since large values of R1 lead to stronger temporal charge diﬀusion and hence to
a slower charge collection at the readout nodes. On the other hand the paral-
lel resistive noise which determines the spatial resolution signiﬁcantly restricts
R2 downwards. Therefore, only ﬁnite resistivity ratios of R1/R2 will be re-
alised in practice. For that reason any linear reconstruction method produces
approximate positions only.

All our attempts introducing non-linear terms of the collected charges Qn in
a position reconstruction algorithm were not successful under the boundary
condition of correct reconstruction at certain symmetry points of a cell. The
discontinuity caused by the low resistivity cell borders which have been in-
troduced to prevent the charge from leaving the cell and thus to improve the
high rate behaviour obviously complicate this attempt enormously. Therefore
these non-linear approaches are not further considered.

The simplest and most obvious linear reconstruction methods are the so called
4-, 6-, and 3-node reconstruction algorithms, whereby the node indications
and the coordinate systems of the particular algorithms are given in Fig. 2.
The correlation between the collected charges Qn at the particular nodes n
and the reconstructed event positions (u, v) can be realized for the particular
algorithms in the x- and y-direction as follows:

5

(1)

(2)

(3)

4-node algorithm (events somewhere in cell 1; x, y

g
2 , g

2 ]) :

[
−

∈

(Q2 + Q5)

(Q1 + Q4)

with Qxy4 = Q1 + Q2 + Q4 + Q5

u4 =

v4 =

g
2 ·

g
2 ·

−
Qxy4

−
Qxy4

(Q4 + Q5)

(Q1 + Q2)

6-node algorithm (node 1 and 4 (node 4 and 5) carry maximum signal for
reconstruction in x-direction (y-direction); x

[0, g

2 ] and y

g
2 , 0]):

∈

[
−

∈

(Q2 + Q5)

(Q0 + Q3)

with Qx6 = Q0 + Q1 + Q2 + Q3 + Q4 + Q5

(Q7 + Q8)

(Q1 + Q2)

with Qy6 = Q1 + Q2 + Q4 + Q5 + Q7 + Q8

u6 = g

v6 = g

·

·

−
Qx6

−
Qy6

3-node algorithm (node 4 carries maximum signal; x, y

g
2 , g

2 ]):

[
−

∈

Q5

Q3

u3 = g

−
Qx3

−
Qy3

·

·

Q7

Q1

v3 = g

with Qx3 = Q3 + Q4 + Q5

with Qy3 = Q1 + Q4 + Q7

The sum of the collected charges in x- and y-direction of the particular al-
gorithms are abbreviated with Qxy4, Qx6, Qy6, Qx3 and Qy3. The higher the
ratio of R1/R2 the more pronounced is the cell like character and the electrical
screening among the cells. This leads to a treatment of the readout structure
consisting of strongly separated cells which makes the application of the 4-
node algorithm stressing this cell structure most favourable. In practise the
charge screening of the cells is always ﬁnite. Therefore, the application of other
algorithms featuring symmetry planes at the cell border (6-node algorithm)
and the readout node (3-node algorithm) is sensible.

The most simplest algorithm imaginable is the 2-node algorithm. But since
this algorithm only takes two nodes into account it is strongly aﬀected by sys-
tematic eﬀects (like cross-talk or variations of the ampliﬁcation of the pream-
pliﬁers). Therefore, the 2-node algorithm, when applied in practise, is inferior
to the other algorithms and is not further considered.

6

8 mm2 cell (R1 = 100 kΩ/✷ and
Fig. 3. Reconstructed positions within a 8
R2 = 2 kΩ/✷) by means of a) the 4-node algorithm, b) the 6-node algorithm and
c) the 3-node algorithm.

×

3.3 Reconstruction properties of the linear algorithms

3.3.1 Position reconstruction

×

4-cell diﬀusion simulation it is possible to investigate
By means of the 4
the reconstruction behaviour of the three algorithms. A series of individual
simulations has been carried out impinging a short driving current successively
at every grid point (homogeneous grid point spacing ∆x = ∆y = 200 µm).
4-cells have collected
All positions are calculated after the 25 nodes of the 4
almost 100 % of the impinged charge. Altogether one obtains therefore 41
41
possible positions within one single cell.

×

×

×

In Fig. 3 the reconstructed positions of the 4-, 6- and 3-node algorithm are
8 mm2 cell for R1/R2 = 50. The 4-node algorithm shows
shown within a 8
large distortions close to the cell borders which means large deviations between
the elements of the two spaces (x, y) and (u, v), whereas this algorithm is nearly
distortion free in the centre of a cell. On the other hand both the 6-node
and the 3-node algorithm have their maximum distortions in the cell centre.
Close to the cell borders they are more favourable for position reconstruction
since their distortions are much smaller compared to the 4-node algorithm.
Obviously, the reconstruction behaviour of the 6- and the 3-node algorithm is
quite similar, since they use comparable symmetry planes and readout nodes.

For a homogeneous input illumination – we impinged charges on every grid
point – a perfect reconstruction algorithm would result in a homogeneous
output population density. Since none of the introduced algorithms is a per-
fect reconstruction algorithm (s. Fig. 3) variations in the population density
become obvious. Mathematically the correlation between the true positions
(x(u, v), y(u, v)) and the reconstructed positions (u, v) is given by a two-

7

dimensional Jakobi-determinant J(u, v) (coordinate transformation), which
correlates the two population densities B(x, y) and

B(u, v):

dx dy B(x, y) =

du dv J(u, v)

B

e
x(u, v), y(u, v)

=

du dv

B(u, v) (4)

·

(cid:16)

(cid:17)

Z

e

Z

Z

Therfore, we obtain

B(u, v) = J(u, v)

B

x(u, v), y(u, v)

B(x, y)

(5)

e

·

(cid:16)

with the Jakobi-determinant J:

∂x(u, v)
∂u

∂y(u, v)
∂u

∂x(u, v)
∂v

∂y(u, v)
∂v

·

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:17)

= (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

J =

∂x
∂u

∂y
∂v −

∂x
∂v

∂y
∂u

=

1

,

∂u
∂x

∂v
∂y −

∂u
∂y

∂v
∂x

(6)

J(x, y)

whereby the second relationship for J can be derived by the back-trans-
formation B(x, y) =
B(u(x, y), v(x, y)). The derivatives with respect
to the true positions ∂x and ∂y are easier to calculate in a numerical fashion
since the positions (x, y) are placed on an equidistant lattice in the case of a
homogeneous illumination. Therefore the second relationship for J from Eq.
(6) is used for further numerical calculations.

e

e

·

A homogeneous illumination like in this simulation means B(x, y) = const.
which is set in the following (arbitrarily) to B(x, y) = 1. This leads to
B(u, v) =
J(u, v) (Eq. (5)). In Fig. 3 the relationship between the true positions (x, y)
and the reconstructed positions (u, v) is shown for quantised distances. It is
obvious that J is unequal to one which directly leads to an inhomogeneous
B(u, v). This is also visible by the variation of the density
population density
of the black points in Fig. 3. A higher density of points (u, v) is equivalent to a
B(u, v) for
higher population density
the 4-node algorithm is shown as an example. A perfect algorithm which con-
nects the reconstructed positions with the true positions x(u, v) and y(u, v) by
B(u, v) = B(x, y).
x(u) = u and y(v) = v would lead to a population density

B(u, v). In Fig. 4 the population density

e

e

e

e

e

Unfortunately, it is a non-trivial task to ﬁnd a suitable transformation between
the two spaces (x, y) and (u, v) since the functions x(u, v) and y(u, v) are ex-
plicitly needed. Starting with one of the linear algorithms (e.g. the 4-node al-
gorithm) one will end up in major problems: Since all the data were calculated
numerically with a ﬁnite grid spacing (e.g. 200 µm) one has to approximate
the functions x(u, v) and y(u, v) e.g. by polynomials or Fourier series to get
an analytical approach. Thereby, it showed up that one has to take too many
orders into account to decrease the deviation between positions reconstructed
by the simulation and the polynomials. But even if there exists a satisfying

8

Population density

Fig. 4.
the 4-node algorithm for
R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷ obtained by Eq. (5) with a homogeneous il-
lumination B(x, y) = 1.

B(u, v) plotted for

e

solution of an analytical expression for x(u, v) and y(u, v) another much more
serious problem arises. One has to take carefully the spatial resolution into
account. As it will be seen later on, the transformation for x(u, v) and y(u, v),
which will correct the reconstructed positions (u, v), will dramatically deteri-
orate the spatial resolution at the positions where larger corrections have to
be applied. This will be for example the case at the cell borders when using
the 4-node algorithm where we have larger population densities (s. Fig. 4) and
therefore larger position corrections.

Also the access via a direct measurement is closed since an extensive mechan-
ical scan has to be done; e.g. by means of a ﬁne needle impinging a certain
amount of charge onto the readout structure. At least one has to scan – de-
pending on the desired accuracy – a few thousand positions which will lead
to an enormous eﬀort. Besides, the true positions (x, y) are hard to determine
due to the ﬁnite mechanical accuracy of the setup.

3.3.2 Spatial resolution

In most position sensitive detector systems the spatial resolution represents
an important parameter which has to be optimised depending on the desired
application. Since in interpolating systems like in our case the reconstruction
algorithms themselves aﬀect the spatial resolution additionally (besides e.g.
the signal-to-noise ratio (SNR) or the pixel-size for pure pixel detectors), the
inﬂuence of the algorithms has to be analysed separately in this respect.

The absolute values of the spatial resolution of the diﬀerent algorithms are
determined by the SNR. Since the spatial resolution of all algorithms is
SNR

∝
−1 (s. b.) the absolute noise resistance R is not explicitly needed when

9

the various algorithms are compared to each other. In the following we treat
the parallel noise of the readout structure as the dominant noise source, which
mainly determines the spatial resolution. Every readout node collecting the
charge Qi is subjected to Nyquist-Johnson noise

∆Q(t) =

4 kBT
R

s

t

·

,

(7)

with t denoting the charge integration time. Thereby, the collected charge
including the noise contribution is normally distributed around Qi(t). For the
total spatial resolution the electronic noise would also have to be considered.
It has deliberately not been included in the calculations to leave the discussion
independent from the electronics used. For most practical cases it will be in
the same order of magnitude or smaller than the noise contribution, presented
here.

Taking into account the particular algorithms (Eqs. (1)–(3)) and assuming a
constant gaussian charge noise ∆Q (Eq. (7)) error propagation leads to the
spatial resolution in u-direction:

σu(u, t) =

∆Q(t)

,

(8)

∂u
∂Qi(x, y, t)


Xi  


2

1/2

!





where (x, y) and t indicate the true event position (impact position) upon the
readout plane and the charge integration time, respectively. The calculation
in v-direction behaves correspondingly. The sum runs over all participating
nodes of the particular algorithms. Since some charges Qi appear both in the
u- and the v-coordinate the two coordinates are correlated. Therefore, the
noise causes a spatial smearing which can be expressed by a two-dimensional
gaussian distribution with ̺ describing the strength of the correlation (e.g.
[16]):

E(x, y) =

1

2π σuσv√1

−

1

1
2 ·

̺2 ·
1

̺2

 

−

exp

( −

(x

u)2

−
σ2
u

(y

+

−
σ2
v

v)2

2̺(x

−

u)(y
−
σuσv

v)

−

!)

(9)

For the 4-, 6- and 3-node algorithms one obtains for the spatial uncertainty
(corresponding coordinate systems s. Fig. 2):

10

4-node algorithm:

σu4(u4(t), t) =

4u4(t)2 + g2

= fu4(u4(t), g)

(SNRxy4)−1

σv4(v4(t), t) =

4v4(t)2 + g2

= fv4(v4(t), g)

(SNRxy4)−1

q

q

∆Q(t)
Qxy4(x, y, t)
∆Q(t)
Qxy4(x, y, t)

·

·
2

·

·

cov(u4, v4, t) = 4u4v4

̺(u4, v4, t) =

(4u2

q

= 4u4v4

(SNRxy4)−2

·

 

∆Q
Qxy4 !
4u4v4
4 + g2)(4v2

4 + g2)

6-node algorithm:

σu6(u6(t), t) =

6u6(t)2 + 4g2

= fu6(u6(t), g)

σv6(v6(t), t) =

6v6(t)2 + 4g2

= fv6(v6(t), g)

∆Q(t)
Qx6(x, y, t)
∆Q(t)
Qy6(x, y, t)

·

·

−1

(SNRx6)

·
(SNRy6)−1

·

cov(u6, v6, t) =

̺(u6, v6, t) =

4u6v6 + 2g(u6
(cid:16)
4u6v6 + 2g(u6

−
6 + 4g2)(6v2

(6u2

g2

(cid:17)

−

v6)

−
g2
v6)
−
6 + 4g2)

(∆Q)2
Qx6 Qy6

3-node algorithm:

σu3(u3(t), t) =

3u3(t)2 + 2g2

= fu3(u3(t), g)

(SNRx3)−1

σv3(v3(t), t) =

3v3(t)2 + 2g2

= fv3(v3(t), g)

(SNRy3)

−1

∆Q(t)
Qx3(x, y, t)
∆Q(t)
Qy3(x, y, t)

·

·

·

·

cov(u3, v3, t) = u3v3

(∆Q)2
Qx3 Qy3

̺(u3, v3, t) =

u3v3
3 + 2g2)(3v2

(3u2

3 + 2g2)

The cell size is denoted by g. Again the reconstructed positions are indicated
by (u(x, y), v(x, y)) together with a number as a subscript for the particular
algorithm. The terms of the spatial resolutions can be separated into a geomet-
rical factor f and a factor consisting of the SNR. Fig. 5 shows schematically
the results of the spatial resolutions du = 2.355
σu (fwhm) as a function of
the distorted reconstructed position (un, vn) for all three algorithms within
8 mm2-cell taking both the geometrical factor f and the SNR-
a single 8
factor into account. Obviously, the 4-node algorithm shows up to be the most
favourable algorithm since it provides the best spatial resolution. Since the
3-node algorithm collects in the cell centre only about half of the impinged

×

·

(10)

(11)

(12)

q

q

q

q

q

q

11

Fig. 5. Spatial resolution du = 2.355
σu (fwhm) for the 4-, 6- and 3-node al-
·
gorithm as a function of the reconstructed positions (un, vn) for R1 = 100 kΩ/✷
and R2 = 2 kΩ/✷ after the complete charge has been integrated (t = 500 ns). The
106 e−. The parallel noise
driving current contains a charge equivalent of about 1.7
13.6 kΩ.
resistance of the readout structure has been numerically calculated to R

·

≈

charge the SNR-factor decreases and therefore the spatial resolution deteri-
orates in comparison to the other algorithms. Only at the nodes the spatial
resolution for the 3- and the 4-node algorithm becomes similar, since the geo-
metric factors f = √2 g (cf. Eqs. (10) and (12)) and the SNR-factors are the
same.

Actually, the spatial resolution in Fig. 5 is plotted as a function of the recon-
structed positions (u, v) and not of the true positions (x, y). If one corrects
the reconstructed positions by means of a coordinate transformation which
transforms (u, v)
(x, y) the spatial resolution of the corrected positions σx
→
can be estimated by:

σx(x, y)

=

(cid:16)

2

(cid:17)

1

∂u
∂x

∂v
∂y −

∂u
∂y

∂v
∂x !

 

2 ·

2

∂v
∂y !

 

(σu)2 +

2

∂u
∂y !

 

(σv)2

∂v
∂y

∂u
∂y

2

−

cov(u, v)






(13)






Eq. (13) determines the spatial resolution σx of the corrected positions as a
function of the covariance, the spatial resolutions σu and σv of the applied
algorithm (cf. Eqs. (10)–(12)) and the derivatives between the coordinates
(u, v) and (x, y). In this equation all appearing (u, v) should be treated as
(u(x, y), v(x, y)). Fig. 6 shows exemplarily the numerically calculated spatial

12

σx (fwhm) for the 4-node algorithm as a
Fig. 6. Spatial resolution dx = 2.355
function of the true positions (x, y) for R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷. The
graph is plotted for the same parameters like in Fig. 5. Since both the 6- and the
3-node algorithm show quite the same behaviour close to the cell borders only the
4-node algorithm is plotted exemplarily.

·

·

resolution dx = 2.355
σx (fwhm) obtained by Eq. (13) as a function of the
true positions (x, y) for the 4-node algorithm. Since at the cell borders where
the population density of all algorithms is relatively high (s. Fig. 3) larger
corrections have to be applied the spatial resolution deteriorates by almost a
factor of 3–4 for all algorithms.

3.4 Introduction of the optimised 463-node algorithm

In the following we present a possible solution which takes care of both the
correct position reconstruction and the spatial resolution, by combining the
4-, 6- and 3-node algorithms to one 463-node algorithm.

e

B(u, v)

All algorithms converting a homogeneous population density B(x, y) = 1 into
= 1 which is equivalent to a
an inhomogeneous population density
wrong position reconstruction are not favourable. Even for the case of a later
position correction these algorithms will always suﬀer from a bad spatial reso-
lution at the positions where larger position corrections have to be applied (cf.
end of Sec. 3.3.2). Therefore, it would be much more advantageous to ﬁnd an
algorithm which is capable to reconstruct almost the correct positions which
require only small subsequent position corrections and which therefore only
weakly inﬂuence the spatial resolution. The idea of combining the 4-, 6- and
3-node algorithm to the 463-node algorithm shows up to be a possible solution
fulﬁlling almost the requirements mentioned above.

13

6
ija  = 0

a  = 1
ij

 s

 s

     >
u6
b  = 0
ij

u3

 s

£ s

u6

u3
b  = 1
ij

4-node
algorithm

3-node
algorithm

6-node
algorithm

0, 1
}

is given by the spatial resolution σu6 and σu3.

Fig. 7. Choice of the mixing matrices Ax and Bx. The ﬁrst bifurcation mixes
between the 4-node and either the 6- or the 3-node algorithm. The criterion for
[0, 1] is an optimised position reconstruction which will be described in the
aij ∈
text. The second bifurcation distinguishes between the 6- and the 3-node algorithm.
The criterion for bij ∈ {
Based on the results of the simulation model giving a relationship between
(u, v) and (x, y) the combination of the algorithms in x-direction is done by
mixing matrices Ax = ((aij)x) and Bx = ((bij)x), deﬁned for every grid point
8 mm2 cell. The elements aij ∈
[0, 1] mix the 4-node algorithm
in the 8
continuously with either the 6-node or the 3-node algorithm, whereby the
elements of the second mixing matrix bij ∈ {
consisting only of the values
0 or 1 choose either the 6-node (bij = 1) or the 3-node (bij = 0) algorithm. The
following equation deﬁnes the complete 463-node algorithm, whereby ax = aij
and bx = bij are those elements of the matrices corresponding to the true
position (x, y). The origin of the 4-node algorithm is now shifted to readout
node 4 (cf. Fig. 2):

0, 1

×

}

u463 = axu4 + (1

ax)

bxu6 + (1

bx)u3

= ax

g
2 · (

−

n

−

(Q2 + Q5)

(Q1 + Q4)

−
Qxy4

o
+ 1

+

)

(1

ax) g

−

bx ·

· (

−
Qx6

(Q2 + Q5)

(Q0 + Q3)

+ (1

bx)

−

Q5

Q3
−
Qx3 )

·

(14)

For symmetry reasons the relationship between the mixing matrices in x-
and y-direction is simply: Ay = AT
x . The procedure for the
combination of Ax and Bx is shown in the schematic diagram in Fig. 7. In
the following the derivation of the matrices Ax and Bx is discussed for the
x-direction. The y-direction behaves correspondingly.

x and By = BT

The spatial resolution σu6 and σu3 of the 6- and the 3- node algorithm is
the criterion for the matrix Bx with bij ∈ {
(cf. Eqs. (11) and (12)). If
σu3 the 6-node algorithm is used (bij = 1); if σu6 > σu3 the 3-node
σu6

0, 1

}

≤

14

algorithm is used (bij = 0). Since the deviations between the reconstructed
positions of the 6-node and the 3-node algorithm are small (s. Fig. 3) also the
inﬂuence of the points of discontinuity (bij = 0
bij = 1) is expected to be
negligible.

⇔

The criterion for the combination between the 4-node and the 6- or the 3- node
algorithm is an optimised position reconstruction which means a minimum
bx)u3 we get
deviation ∆ between u and x. Together with u6,3 = bxu6 + (1
as a criterion:

−

min ∆ = min

x

u463

= min

2

−

x

−

(

axu4

(1

−

−

ax)u6,3

2

,

)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:16)
(cid:12)
(cid:12)
whereby again ax = aij and bx = bij. The minimum condition leads to
∂∆/∂ax = 0. Since ∂2∆/∂a2
0 the criterion for a minimum is fulﬁlled.
As a result we obtain for the matrix elements ax:

x ≥

(cid:17)

(15)

(16)

(17)

ax =

x
u4

u6,3
u6,3 


−
−

if ax > 1 then ax is set to 1
if ax < 0 then ax is set to 0

The constraint



0

ax ≤

≤

1 ,

has to be set because for some positions mixing factors
1 would end
up in additional distortions due to noise or systematic eﬀects (cf. Sec. 4).
Consequently, this constraint leads to the fact that some positions (u, v) are
still not reconstructed correctly.

ax| ≫

|

A graphical illustration of the matrices Ax and Bx are shown in Figs. 8 and 9.
The 4-node algorithm determines already the optimum positions in x-direction
close to the low resistivity cell borders (except close to the readout nodes),
therefore it is the only algorithm applied (ax = 1). In y-direction close to the
cell borders the 4-node algorithm becomes unfavourable (cf. Fig. 3 a)) and
the other participating algorithms are more emphasised (ax ≈
0). As expected
the 6-node algorithm oﬀers the best spatial resolution close to the symmetry
axis of the cell, whereas the 3-node algorithm becomes more favourable in
x-direction close to the low resistivity cell borders and the readout nodes
(cf. also Fig. 5). Fig. 10 shows the reconstructed positions obtained with the
463-node algorithm by means of Eq. (14). The slight distortions for some
positions mainly close to the nodes are due to the constraint in Eq. (17)
and can be directly revealed in the population density plot (Fig. 11). A very
slight inhomogeneity is also visible close to the low resistivity strips at the cell
borders. In comparison with the population density of the 4-node algorithm
(Fig. 4) the population density of the 463-node algorithm is nearly ﬂat and
especially close to the cell borders and the readout nodes improved by a factor
2–4.

15

[0, 1] calculated with Eq. (16) for R1 = 100 kΩ/✷ and
Fig. 8. Matrix Ax with ax ∈
R2 = 2 kΩ/✷ (aij = 1 corresponds to the full usage of the 4-node algorithm, aij = 0
corresponds to the pure use of either the 6- or the 3-node algorithm).

4

3

2

1

0

-1

-2

-3

-4

]

m
m

[
 

i

t

e
a
n
d
r
o
o
c
-
y

-4

-3

-1

0
-2
2
x-coordinate [mm]

1

3

4

plotted for R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷
Fig. 9. Matrix Bx with bx ∈ {
(bij = 1 (black area) corresponds to the full application of the 6-node algorithm and
bij = 0 (white area) corresponds to the full application of the 3-node algorithm).

0, 1
}

Besides this as a consequence also the spatial resolution is improved. In Fig.
12 the spatial resolution of the 463-node algorithm is plotted as a function of
the reconstructed positions (u, v). In fact the error propagation (Eq. (8) and
Eq. (14)) leads for the 463-node algorithm to a non-trivial equation for the
spatial resolution. However, as expected due to the mixing matrices Ax and
Bx close to the nodes and the cell borders in v-direction the spatial resolution
is comparable to that obtained by the single 3-node and 6-node algorithm (cf.

16

Fig. 10. Reconstructed positions by means of the 463-node algorithm within a
8 mm2 cell (R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷). The corresponding mixing
8
matrices Ax and Bx are shown in Figs. 8 and 9, respectively.

×

Fig. 11. Population density
B(u, v) plotted for the 463-node algorithm for
R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷ obtained by Eq. (5) with a homogeneous il-
lumination B(x, y) = 1.

e

Fig. 5). Close to the cell borders in u-direction the behaviour of the single 4-
node algorithm is reﬂected. Since the positions are indeed well reconstructed
(Fig. 10) the spatial resolution of the 463-node algorithm as a function of the
true positions (x, y) is very similar to that of the reconstructed positions (u, v)
(Fig. 12). Only close to the nodes the spatial resolution is slightly deteriorated
caused by the small position corrections (s. Eq. (13)).

17

σu (fwhm) for the 463-node algorithm as a
Fig. 12. Spatial resolution du = 2.355
function of the reconstructed positions (u, v) for R1 = 100 kΩ/✷ and R2 = 2 kΩ/✷.
The graph is plotted for the same parameters like in Fig. 5.

·

3.5 Application of the 463-node algorithm on measured data

The application of the 463-node algorithm (Eq. 14) demands for the mixing
matrices A and B. Since these matrices are actually a function of the true po-
sitions (x, y) which are not known a priori in a measurement we have to apply
an iterative technique. To obtain a ﬁrst approximate position an assumption
for suitable elements aij and bij is needed. For that reason the reconstructed
position is calculated ﬁrstly both by means of the 6-node and the 4-node al-
gorithm. At a distance of d = 0.1 g (with g as the cell size) around the cell
borders the 6-node algorithm (u6, v6) is used for a ﬁrst estimation of i, j to
obtain the matrix elements aij and bij. Else the 4-node algorithm (u4, v4) is
used for the estimation of aij and bij. Then, the 463-node algorithm posi-
tion is calculated for the ﬁrst time, which gives new positions and therefore
an estimation of new aij and bij. This iterative procedure is repeated several
times until the reconstructed positions (u463, v463) converge. Since the diﬀu-
sion simulation gives matrices A and B with 41
41 elements corresponding
to a grid spacing of 200 µm (Figs. 8 and 9) we have used an interpolation
routine of IDL [17] to achieve a ﬁner resolution. If the virtual pixel size is e.g.
200 µm2 we use ﬁner matrices A and B with 81
chosen to 200
81 elements,
corresponding to 100 µm grid spacing to allow a better convergence of the 463-
node algorithm. Since this method converges at almost all positions within the
cell this iterative loop is used for all image reconstructions of measured data
presented in the following.

×

×

×

40 mm2) of a
Fig. 13 shows the response of the inner 5
detector with a PCB-readout structure to an uniform illumination (B(x, y) =
1) reconstructed with the 4-node algorithm (Eq. 1). A 55Fe-source has been

5 cells (

= 40

×

×

b

18

Fig. 13. Reconstructed image of a ﬂatﬁeld illumination using the 4-node algorithm.
106
A virtual pixel size of 200
114. The stan-
photons corresponding to a mean number of photons per pixel N
dard deviation of the intensity per pixel distribution amounts to 54.9.

200 µm2 is chosen. The image contains about 4.57

×

≈

·

used for illumination (Eγ = 5.9 keV). The detector has been operated with an
Ar/CO2 (90/10) gas ﬁlling at standard pressure.

±

The low resistivity cell borders of the PCB-structure have a width of about
5 µm). The special resistive materials used for the silk-screen print-
(170
ing process have surface resistances of R1 = 100 kΩ/✷ and R2 = 1 kΩ/✷,
respectively. Unfortunately the printing and burning processes have a strong
inﬂuence on the resistances and the exact ratio of R1/R2 is hardly predictable.
Since the depletions at the cell borders when using the 4-node algorithm show
a good regularity in all cells (Fig. 13) we conclude that the relative accu-
racy of the surface resistances is in the percent range. The resulting image
when using the 463-node algorithm is shown in Fig. 14. The matrices A and
B are created for R1 = 100 kΩ/✷ and R2 = 10 kΩ/✷ since this ratio sim-
ply ﬁts best, whereby the distortions of the 4-node algorithm depend less
than linear on the ratio R1/R2. This means that one obtains e.g. only lit-
tle changes concerning the distortions when treating a ratio of R1/R2 = 10
instead of R1/R2 = 20. The population density B(u463, v463) becomes much
more homogeneous in comparison to the 4-node algorithm. In addition the
standard deviation of the intensity per pixel is dramatically reduced from
σN = 54.9 to σN = 16.2 which is indeed much closer to the theoretical limit
of σN −Poisson = √114

10.7.

≈

19

Fig. 14. Reconstructed image from the same data as in Fig. 13 using the 463-node
200 µm2 is chosen. The standard deviation
algorithm. A virtual pixel size of 200
of the intensity per pixel distribution amounts to 16.2. The dotted circles indicate
systematic eﬀects. Uppermost circle: not properly working preampliﬁer. Middle cir-
cle: low resistivity strip is interrupted. Lowermost circle: defect in a copper layer in
one of the three GEM structures used for gas ampliﬁcation.

×

4 Non-linear corrections

Although the reconstructed image with the 463-node algorithm (Fig. 14) rep-
resents a mentionable progress compared to images reconstructed e.g. with the
4-node algorithm (Fig. 13) still some inhomogeneities in the population den-
sity are obvious. These artifacts can mainly be attributed to systematic eﬀects
(which partly occur during the measurement). As already described, even in
the theoretical case the 463-node algorithm leads to a slight overpopulation
close to the cell borders and especially around the nodes (cf. Fig. 11). System-
atic electronic eﬀects, like gain variations of the preampliﬁers and cross-talk in
the preampliﬁers/cables can possibly inﬂuence the image. Besides this, a too
short integration time of the preampliﬁers can lead to an overpopulation (as
can be shown by simulations) of the cell borders. Further systematic eﬀects
stem from the readout structure itself, like the ﬁnite dimensions of the readout
nodes, the ﬁnite accuracy of the width of the low resistivity strips and local
inhomogeneities of the surface resistances.

4.1 Homogeneous population density

In order to decrease the remaining inhomogeneities around the readout nodes
and the cell borders (cf. Fig. 14) an ansatz is made for x(u, v) and y(u, v),

20

Fig. 15. Measured averaged population density
The average value of the population density is normalised to unity.

B(u, v) of the 5

×

5 cells of Fig. 14.

e

whereby the abbreviation u = u463 and v = v463 is used in the following.
Since we know that the incident population density B(x, y) for a homogeneous
illumination is equal to unity Eq. (5) reads as follows:

B(x, y) = 1 =

B(u, v)
∂x
∂y
e
∂v
∂v −

∂x
∂u

∂y
∂u

⇐⇒

e

B(u, v) =

∂x
∂u

∂y
∂v −

∂x
∂v

∂y
∂u

(18)

e

×

−

∈
e

B(u, v). Fig. 15 shows the measured mean population density

The functions x(u, v) and y(u, v) have now to be optimised in such a fashion
∂vx ∂uy correspond to the measured population
that the derivatives ∂ux ∂vy
B(u, v)
density
5 cells shown in Fig. 14. The mean
obtained by the superposition of the 5
e
B(u, v) is normalised to unity; also the cell size g is normalised to
value of
one (u, v
[0, 1]). We have composed the coordinate transformation func-
tions x(u, v) and y(u, v) by suitable combinations of diﬀerent one- and two-
dimensional Gaussian functions with the cell centre as the point of symmetry.
The ﬁnal coordinate transformation functions x(u, v) and y(u, v) have alto-
gether 6 independent parameters. Fig. 16 shows the population density as a
2. The measured
result of the minimisation of
B(u, v) (Fig. 15) and the population density obtained by
population density
the coordinate transformation functions x(u, v) and y(u, v) (Fig. 16) are in
good agreement. The knowledge of x(u, v) and y(u, v) allows now to correct
for the small inhomogeneities around the nodes and the cell borders. By this
procedure, the reconstructed positions of the 463-node algorithm (u, v) are
transformed into the corrected positions x(u, v) and y(u, v). Fig. 17 shows the
resulting non-linear corrected image. The standard deviation of the intensity
per pixel is further reduced from σN = 16.2 (Fig. 14) to σN = 13.6 which is
even closer to the theoretical limit of σN −Poisson = √114

∂vx ∂uy)

(∂ux ∂vy

B(u, v)

10.7.

−

−

e

e

|

|

≈

21

Fig. 16. Population density
transformation functions x(u, v) and y(u, v).

B(u, v) = ∂ux ∂vy

−

∂vx ∂uy obtained by the coordinate

e

Fig. 17. Reconstructed image of the ﬂatﬁeld illumination using the 463-node algo-
rithm with subsequent non-linear corrections. The standard deviation of the inten-
sity per pixel distribution amounts to 13.6.

4.2 Inhomogeneous population density

Since all assumptions made in the previous sections are based on a homoge-
neous population density B(x, y) = 1 we have to test the 463-node algorithm
(Sec. 3.4) and the corresponding non-linear corrections separately with an
inhomogeneous population density. This can e.g. be performed with a suit-
able collimator. More images (even time-resolved measurements) in the ﬁeld
of biological and chemical diﬀraction samples recorded with the ViP-detector
prototype can be found in Ref. [12].

22

Fig. 18. On the left hand side the image of the “SAXS” aperture recorded with a
PCB-readout structure is shown. On the right hand side a photo of the aperture
taken with a standard digital camera against the sunlight is depicted. The distance
between detector and source amounted to about 2.5 m, therefore parallax is very
small. The illuminated spots at the bottom correspond to holes in the aperture with
diameters of 280, 380, 480, 580 and 680 µm. The aperture is slightly tilted by an
angle of about 0.6◦, which can be recognised for example by the vertical pixel jump
(pixel quantisation) at the bottom of the “2” (dashed-dotted line). The sizes of both
depicted images amount to 4.4

4.4 cm2.

×

Fig. 18 shows the image of a laser cut 1 mm thick stainless steel aperture
containing “SAXS 2D” letters (Small Angle X-ray Scattering) and ﬁve holes
with increasing hole diameters. The image has been recorded with a PCB-
readout structure using photons of an energy of 6.4 keV (ﬂuorescence of a Fe-
target in a 8 keV synchrotron beam). The detector was ﬁlled with a Xe/CO2
(90/10) gas mixture at a pressure of 1.3 bar. The image has been reconstructed
with the linear 463-node algorithm with subsequent non-linear corrections
at the nodes and at the cell borders. We performed an additional ﬂatﬁeld
correction with a ﬂatﬁeld image recorded in our laboratory one week after the
aperture measurement with a diﬀerent gas ﬁlling and a diﬀerent X-ray source.
Since this ﬂatﬁeld image is diﬀerent from one which we would have obtained at
the beamline directly after the aperture measurement (with identical detector
parameters), the corrected image still shows up some artifacts like visible areas
around the readout nodes (marked with dotted lines) which should have been
suppressed by the correction of the proper ﬂatﬁeld image.

However, the recorded image compares well to the image of the aperture (right
hand side image in Fig. 18). Only the middle part of the second “S” (dashed
line) looks slightly distorted; at this readout channel the preampliﬁer was not
working optimally (compare to uppermost dotted circle in Fig. 14). Also the
reproduction of the holes shows a good agreement.

23

5 Conclusion

The simplest linear algorithms do not reconstruct the event positions correctly.
This leads to distortions since the true positions (x, y) and the reconstructed
positions (u, v) diﬀer up to a certain extent. When these algorithms are cor-
rected afterwards by a suitable coordinate transformation connecting the two
spaces (u, v) and (x, y) the spatial resolution becomes worse especially next
to the cell borders and the readout nodes.

Therefore, the 463-node algorithm is introduced. This complex algorithm con-
sisting of combinations of linear algorithms is a possible solution for posi-
tion reconstructions using the two-dimensional interpolating resistive readout
structure described above. This algorithm has been optimised with respect to
both the correct position reconstruction and the spatial resolution. Indeed,
the reconstruction of a homogeneous population density as a measure for the
quality of an image has been considerably improved – even close to the Poisson
limit – when the 463-node algorithm with subsequent non-linear corrections
was applied. Nevertheless, some inhomogeneities mainly caused by systematic
eﬀects are still visible in the images. Since these disturbing eﬀects can not be
corrected afterwards they should be kept as small as possible.

References

[1] A. Bressan, R. De Oliveira, A. Gandi, J.-C. Labb´e, L. Ropelewski, F. Sauli,
D. M¨ormann, T. M¨uller, H. J. Simonis, Two-dimensional readout of GEM
detectors, Nucl. Instr. and Meth. A425 (1999) 254–261.

[2] S. Bachmann, S. Kappler, B. Ketzer, T. M¨uller, L. Ropelewski, F. Sauli,
E. Schulte, High rate X-ray imaging using multi-GEM detectors with a novel
readout design, Nucl. Instr. and Meth. A478 (2002) 104–108.

[3] J. P. Cussonneau, M. Labalme, P. Lautridou, L. Luquin, V. Metivier,
A. Rahmani, T. Reposeur, 2D localization using resistive strips associated to
the Micromegas structure, Nucl. Instr. and Meth. A492 (2002) 26–34.

[4] R. Lewis, Multiwire Gas Proportional Counters: Decrepit Antiques or Classic

Performers?, J. Synchrotron Rad. 1 (1) (1994) 43–53.

[5] H. J. Besch, M. Junk, W. Meißner, A. Sarvestani, R. Stiehler, A. H. Walenta,
An interpolating 2D pixel readout structure for synchrotron X-ray diﬀraction
in protein crystallography, Nucl. Instr. and Meth. A392 (1997) 244–248.

[6] F. Sauli, GEM: A new concept for electron ampliﬁcation in gas detectors, Nucl.

Instr. and Meth. A386 (1997) 531–534.

24

[7] Y. Giomataris, P. Rebourgeard, J. P. Robert, G. Charpak, MICROMEGAS:
a high-granularity position-sensitive gaseous detector for high particle-ﬂux
environments, Nucl. Instr. and Meth. A376 (1996) 29–35.

[8] F. Bartol, M. Bordessoule, G. Chaplier, M. Lemonnier, S. Megtert, The C.A.T.
Pixel Proportional Gas Counter Detector, J. Phys. III France 6 (1996) 337–347.

[9] A. Sarvestani, H. J. Besch, M. Junk, W. Meißner, N. Sauer, R. Stiehler, A. H.
Walenta, R. H. Menk, Study and application of hole structures as gas gain
devices for two dimensional high rate X-ray detectors, Nucl. Instr. and Meth.
A410 (1998) 238–258.

[10] A. Orthen, H. Wagner, H. J. Besch, R. H. Menk, A. H. Walenta,
U. Werthenbach, Investigation of the performance of an optimised MicroCAT,
a GEM and their combination by simulations and current measurements, Nucl.
Instr. and Meth. A500 (2003) 163–177.

[11] A. Orthen, H. Wagner, H. J. Besch, S. Martoiu, R. H. Menk, A. H. Walenta,
U. Werthenbach, Gas gain and signal length measurements with a triple-GEM
at diﬀerent pressures of Ar-, Kr- and Xe-based gas mixtures, Nucl. Instr. and
Meth. A512 (2003) 476–487.

[12] A. Orthen, H. Wagner, S. Martoiu, H. Amenitsch, S. Bernstorﬀ, H. J. Besch,
R. H. Menk, K. Nurdan, M. Rappolt, A. H. Walenta, U. Werthenbach,
Development of a two-dimensional virtual pixel X-ray imaging detector for time-
resolved structure research, submitted to J. Synchrotron Rad. (2003).

[13] A. Sarvestani, N. Sauer, C. Strietzel, H. J. Besch, A. Orthen, N. Pavel, A. H.
Walenta, R. H. Menk, Microsecond time-resolved 2D X-ray imaging, Nucl. Instr.
and Meth. A465 (2001) 354–364.

[14] S. Martoiu, A. Orthen, H. Wagner, H. J. Besch, R. H. Menk, K. Nurdan, A. H.
Walenta, U. Werthenbach, Intelligent local trigger technique for a multi-cell 2D
interpolating resistive readout, to be submitted to Nucl. Instr. and Meth. A
(2003).

[15] H. Wagner, H. J. Besch, R. H. Menk, A. Orthen, A. Sarvestani, A. H.
Walenta, H. Walliser, On the dynamic two-dimensional charge diﬀusion of
the interpolating readout structure employed in the MicroCAT detector, Nucl.
Instr. and Meth. A482 (2002) 334–346.

[16] S. Brandt, Data Analysis, Spinger, New York, 1999.

[17] IDL 5.3, Research Systems Inc., Boulder, CO, USA.

25

