The HERMES Dual-Radiator
Ring Imaging ˇCerenkov Detector

The HERMES RICH group

N. Akopov 9, E.C. Aschenauer 4, K. Bailey 1, S. Bernreuther 8,
N. Bianchi 5, G. P. Capitani 5, P. Carter 3, E. Cisbani 7,
R. De Leo 2, E. De Sanctis 5, D. De Schepper 1, V. Djordjadze 4,
B.W. Filippone 3, S. Frullani 7, F. Garibaldi 7, J.-O. Hansen 1,

B. Hommez 6, M. Iodice 7, H. E. Jackson 1,

∗, P. Jung 4,

R. Kaiser 4, J. Kanesaka 8, R. Kowalczyk 1, L. Lagamba 2,
A. Maas 4, V. Muccifora 5, E. Nappi 2, K. Negodaeva 4,
W.-D. Nowak 4, T. O’Connor 1, T. G. O’Neill 1,
D. H. Potterveld 1, D. Ryckbosch 6, Y. Sakemi 8, F. Sato 8,
A. Schwind 4, T.-A. Shibata 8, K. Suetsugu 8, E. Thomas 5,
M. Tytgat 6, G.M. Urciuoli 7, K. Van de Kerckhove 6,
R. Van de Vyver 6, S. Yoneyama 8, H. Zohrabian 9, L. F. Zhang 8

1Physics Division, Argonne National Laboratory, Argonne, IL 60439, USA
2INFN, Sezione di Bari, 70124 Bari, Italy
3W.K.Kellogg Radiation Lab, California Institute of Technology,
Pasadena, CA 91125, USA
4DESY Zeuthen, 15738 Zeuthen, Germany
5INFN, Laboratori Nazionali di Frascati, 00044 Frascati, Italy
6Dept. of Subatomic and Radiation Physics, University of Gent,
9000 Gent, Belgium
7INFN, Sezione Roma1 - Gruppo Sanit`a, 00161 Roma, Italy
8Department of Physics, Tokyo Institute of Technology, Tokyo 152-8551, Japan
9Yerevan Physics Institute, 375036 Yerevan, Armenia

1
0
0
2
 
r
p
A
 
8
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
3
3
0
4
0
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

∗ Corresponding author. Tel.:+630-252-4013. e-mail:HAL@anl.gov

Preprint submitted to Elsevier Preprint

2 February 2008

Abstract

The construction and use of a dual radiator Ring Imaging ˇCerenkov (RICH) detec-
tor is described. This instrument was developed for the HERMES experiment at
DESY which emphasises measurements of semi-inclusive deep-inelastic scattering.
It provides particle identiﬁcation for pions, kaons, and protons in the momentum
range from 2 to 15 GeV, which is essential to these studies. The instrument uses
two radiators, C4F10, a heavy ﬂuorocarbon gas, and a wall of silica aerogel tiles.
The use of aerogel in a RICH detector has only recently become possible with the
development of clear, large, homogeneous and hydrophobic aerogel. A lightweight
mirror was constructed using a newly perfected technique to make resin-coated
carbon-ﬁber surfaces of optical quality. The photon detector consists of 1934 photo-
multiplier tubes (PMT) for each detector half, held in a soft steel matrix to provide
shielding against the residual ﬁeld of the main spectrometer magnet.

2

1 Introduction

The HERMES experiment[1] is a study of
the spin structure of the nucleon which em-
phasizes on an unambiguous measurement
of pion, kaon, and proton semi-inclusive
spin asymmetries in deep-inelastic scatter-
ing (DIS). These asymmetries provide in-
formation on the ﬂavor dependence of po-
larized structure functions and the sea po-
larization. However, most of the hadrons
produced in HERMES [2] lie between 2 and
10 GeV, a region in which it has not been
feasible to separate pions, kaons, and pro-
tons with standard particle identiﬁcation
(PID) techniques. Ring imaging ˇCerenkov
(RICH) and threshold ˇCerenkov systems
using heavy gases [3], such as C4F10, at at-
mospheric pressure are useful only for en-
ergies above 10 GeV since the kaon
threshold for ˇCerenkov radiation is typi-
cally higher than 9 GeV. Because of sub-
stantial multiple scattering and brems-
strahlung, the use of a high pressure gas
system is not technically feasible in HER-
MES. Clear liquid radiators are only use-
ful for hadron identiﬁcation below roughly
2 GeV because of their very low ˇCerenkov
light thresholds and large chromatic dis-
persion.

With the recent development[4,5] of new
clear silica aerogel with a low index of re-
fraction, this diﬃcult energy region can now
be spanned. Aerogels have long been used
in threshold ˇCerenkov counters [6], but their
use as a radiator in a RICH system is a
recent development [7] which has resulted
from the availability of material with ex-
cellent optical properties. This paper re-
ports the successful use, for the ﬁrst time,
of clear aerogel in combination with a heavy
gas, C4F10, in a RICH detector. This dual-
radiator RICH detector provides clean sep-

aration of pions, kaons, and protons over
most of the kinematic acceptance of the
HERMES experiment. Such a conﬁgura-
tion was ﬁrst proposed for the planned
LHCb experiment [8].

The following section 2 describes the gen-
eral design of the HERMES RICH detec-
tor and the properties of its key compo-
nents. Section 3 describes brieﬂy the on-
line monitoring of the system, section 4 the
reconstruction and particle identiﬁcation
and section 5 the necessary software cor-
rection of the mirror alignment. Section 6
ﬁnally is dedicated to the performance of
the detector.

2 Detector Design

2.1 Design Requirements

HERMES is located in the East hall of
the HERA storage ring complex. The spec-
trometer is split into two halves above and
below a central horizontal magnetic shield-
ing plate through which the HERA beams
pass [1]. As a result, the RICH detector
also consists of two symmetric RICH mod-
ules, the top and the bottom RICH sec-
tions. The RICH is positioned between the
two rear tracking chambers, so that the
free space is only 1.25 m deep. The outer
body and the gas control system were taken
unchanged from the previous threshold
ˇCerenkov counters.

Figure 1 shows the hadron momentum spec-
tra in the HERMES acceptance obtained
from a GEANT based Monte Carlo (MC)
simulation of the deep inelastic scattering
of 27.5 GeV positrons oﬀ a hydrogen tar-
get. The fall-oﬀ of the spectra at low mo-

3

s
t
n
u
o
c

30000

20000

10000

s
t
n
u
o
c

s
t
n
u
o
c

0
3000

2000

1000

0

8000

6000

4000

2000

0

pions

kaons

protons

e

0.05

]
d
a
r

[

 

e

0.25

0.2

0.15

0.1

0

0

2

4

6

8

10

12

14
16
p [GeV]

Fig. 1. Monte Carlo hadron momentum spec-
tra within the HERMES acceptance.

menta is due to the ﬁeld of the spectrom-
eter magnet, which severely limits the ac-
ceptance at lower momenta. About 95% of
all hadrons in the acceptance are found in
the range of 2.0 to 15.0 GeV. This deﬁnes
the momentum range over which clear par-
ticle identiﬁcation should be provided.

The low end of this range determines the
index of refraction necessary for the aero-
gel. A value of n(λ=633 nm)=1.03 was cho-
sen since it leads to a kaon threshold of
2 GeV. The ˇCerenkov angles produced by
the combination of this aerogel and the
heavy gas (C4F10) for pions, kaons and pro-
tons are plotted in ﬁgure 2 as a function
of particle momentum. The corresponding
threshold momenta are listed in table 1.
All pion momenta within the spectrometer
acceptance are above the pion threshold
momentum for aerogel of 0.6 GeV, 90% of
the kaon and 78% of the proton momenta
are above the kaon threshold of 2.0 GeV.

The high end of the momentum range ﬁxes
the number of photons that must be de-
tected for full hadron separation. The pa-

4

K

p

aerogel, n=1.0304

C4F10, n=1.00137

0

2

4

6

8

10

12

14

16

K

p

18
20
p [GeV]

Fig. 2. The ˇCerenkov angle θ versus hadron
momentum for the aerogel and C4F10 gas ra-
diators.

aerogel

C4F10

n

1.0304

1.00137

βtγt

4.03

19.10

π

K

p

0.6 GeV 2.7 GeV

2.0 GeV 9.4 GeV

3.8 GeV 17.9 GeV

Table 1
ˇCerenkov light thresholds for pions, kaons and
protons. The index of refraction n is given at
633 nm, βt = 1/n is the threshold velocity
and γt = 1/

1

β2
t .

p

−

rameter to be considered is pmax, the max-
imum separation momentum [9]. This is
deﬁned as the maximum momentum for
which the average photon emission angle
of two particle types (with masses m1 and
m2) is separated by a number of standard
deviations nσ :

pmax = v
u
u
t

m2
1

m2
2
−
2kf nσ

(1)

Q
p
p
·

σθ/√N is the RICH de-
where kf = tan θ
tector constant, N is the number of sepa-
rately detected photons, θ is the ˇCerenkov
angle and σθ the standard deviation of the
reconstructed photon angle distribution. In
the design, nσ = 4.652 was chosen, as it
corresponds to a misidentiﬁcation of the
particle in 1% of the cases, assuming equal
ﬂuxes for the two particle types, an average
detector response (in yield and resolution)
and no background.

Assuming σθ to be 7 mrad (see tables 3
and 4) it follows from (1) that pmax(π, K)
= 15 GeV requires N for the gas to be
12. This requirement leads to the design
values for pmax given in table 2. In this es-
timate it was assumed that the number of
separately detected photons from the aero-
gel is 10. Figure 3 illustrates the overlap
between the momentum regions for both
radiators. The lightly shaded region indi-
cates where the particle can be identiﬁed
based on whether or not a ring is present

kf

pmax(π/K)

aerogel

C4F10

5.46

10−4

·
6.7 GeV

1.07

10−4

·
15.0 GeV

pmax(K/p)

11.2 GeV

25.3 GeV

Table 2
Maximum separation momenta pmax.

/K  aerogel

K/p   aerogel

/K  gas

K/p   gas

5

10

15

GeV

effective threshold 

average angle

Fig. 3. Momentum ranges for hadron sep-
aration in aerogel and C4F10. Between the
dashed lines the hadrons can be separated.

at all. In this region the detector acts like a
threshold ˇCerenkov. In the darkly shaded
region the identiﬁcation is based on the av-
erage reconstructed angles. The plot con-
siders each radiator separately, but the PID
algorithms will combine the information
from the two. The momentum region for
which the identiﬁcation of pions, kaons and
protons is possible is limited by the kaon
threshold momentum for aerogel at 2.0 GeV
and by the maximum separation momen-
tum for π/K separation in C4F10 at 15.0
GeV.

2.2 General Design Parameters

The geometry which was adopted for the
ˇCerenkov radiators and ring imaging sys-
tems is shown in ﬁgure 4 [10]. The body
of the counter is constructed of aluminum,
with entrance and exit windows made of 1
mm thick aluminum. The volume of each
half is approximately 4000 l. The size of
the entrance window is 187.7 cm by 46.4 cm
and the exit window 257.0 cm by 59.0 cm.

PMT plane

Dry N
2

Lucite

Aluminum

Photons

Particle

Mirror

C   F10
4

Aerogel Tiles

Fig. 4. Basic geometry and radiator con-
ﬁguration for the HERMES dual radiator
RICH (not to scale).

5

p
p
PMT matrix

soft steel plate

mirror array

aerogel tiles

aluminum box

Fig. 5. A cutaway schematic view of the (top) RICH counter.

A gas control system recirculates the radi-
ator gas through the main volume, keep-
ing the gas at a slight overpressure with
respect to atmosphere. The aerogel radia-
tor is an assembly of tiles conﬁgured to ﬁll
the entrance of the detector with an aero-
gel thickness of 5.5 cm. The unoccupied
volume of the detector behind the aerogel
is ﬁlled with the gas radiator, C4F10. A
spherical mirror array located at the rear
of the radiator box images the ˇCerenkov
light cones onto a focal surface located
above (below) the active volume.

The radius of curvature of the mirror ar-
ray is 2.20 m. It was chosen to give a fo-
cal surface location in the accessible re-
gion above (below) the forward region of
the radiator boxes and to provide a de-
tector plane of tractable dimensions. The
optical axis of the array, the perpendicu-
lar to the mirror surface at the center of
the array, is inclined at an angle of 26 de-
grees to the horizon. The photon detector
is located outside of the mirror optical axis
with its axis inclined at an angle of 40 de-
grees to the horizon so as to intercept the
mirror surface at a distance of 90 cm. The

6

focal length of the mirror is 110 cm. The
boxes are ﬁtted with gas connections and
pressure regulators which provide a con-
tinuous controlled ﬂow of recirculating gas.
An open section of one of the RICH coun-
ters is shown in ﬁgure 5.

The size of a useful detector surface was
evaluated by an MC simulation which in-
cluded an early version of the RICH ge-
ometry described above. The simulation
showed that 95% of the centers of the rings
and 90% of all the photons are contained
in a planar surface 60 cm high and 120 cm
wide (0.72 m2 surface area). These dimen-
sions were used as lower limits in the ﬁnal
design of the photon detector.

The inner walls of the box are blackened to
reduce wall reﬂections. An array of green
light-emitting diodes (LED) is installed to
provide test and calibration pulses for the
photon detector. They are located on the
face of the mirror, so as to provide an ap-
proximately uniform illumination of the
photon detector surface.

As explained below, most of the useful pho-

tons contained in rings emitted from the
aerogel are in the visible light region. A
good choice for the photon detector is then
an array of photomultiplier tubes (PMTs).
In the present design 3/4 inch tubes were
used, leading to a pixel size of 23.3 mm. A
total of 1934 PMTs is necessary to cover
the photon detector area.

Table 3 lists estimates for the diﬀerent con-
tributions to the single photon resolution.
∆θem results from the uncertainty in the
emission vertex along the track in the radi-
ator. The detector granularity determines
∆θpix, which follows from the size of the
“pixels”. These two contributions aﬀect
both the aerogel and the gas angles. The
chromatic aberration ∆θchr derives from
the variation of the index of refraction with
respect to the wavelength and is only im-
portant for the resolution in the aerogel.
These quantities do not add quadratically
and are only listed separately to indicate
their relative importance. Their combined
eﬀect is calculated in the MC and is listed
as ∆θM C. The resolution is dominated by
the pixel size, which is determined by the
size of the PMT and how much material
must surround it to provide adequate mag-
netic shielding.

aerogel

C4F10

∆θem

∆θpix

1.8 mrad 2.2 mrad

5.6 mrad 5.2 mrad

∆θchr

2.5 mrad

-

∆θM C

7.1 mrad 7.2 mrad

Table 3
Individual contributions to the single photon
resolution in aerogel and C4F10.

2.3 Aerogel Radiator

−

New production techniques [4,5] have yiel-
ded aerogels with much more uniform and
smaller colloidal SiO2 particle structure.
The more uniform granular structure sup-
presses Rayleigh scattering of visible light
and greatly enhances its transmission. Ma-
terial with a refractive index in the range
1.01
1.10, suitable for use in the mo-
mentum range of interest in HERMES, is
now commercially available from Matsu-
shita Electric Works 1 in the form of tiles
of average dimensions 114 by 114 by 11.3
mm3. The optical properties of the aero-
gel tiles have been studied in detail using a
sample of 200 tiles. The transmittance was
measured for each tile for the wavelength
range of 200-900 nm. Typical values for in-
dividual tiles at 400 nm are around 0.67.
The transmittance T was parameterized
as a function of wavelength λ and aerogel
thickness t by the Hunt formula [13]:

−C·t
λ4

T = A

e

·

(2)

The measurements can be described well
t = 0.0094 µm4 and
with a value of C
A = 0.964. More details on the optical
properties of the aerogel tiles can be found
in [11–14].

·

Out of 1680 tiles produced in a single pro-
duction batch, 1020 tiles were judged to
be usable for the HERMES RICH. The se-
lection was based on the measured refrac-
tive index and the sizes of the individual
tiles [11]. Of the 1020 tiles, 850 were ac-
tually used. For those tiles, the average in-
dex of refraction is 1.0304, with a spread of

1 Advanced Technology Research Labora-
tory, 1048 Kadoma, Kadoma-shi, Osaka-fu,
Japan 571, contact: M. Yokoyama, email:
yokoyama@crl.mew.co.jp

7

·

10−4 [12,11]. The tiles are stacked in a
3.6
container consisting of an aluminum frame
with a 1 mm aluminum entrance window
and a 3.2 mm UVT-lucite exit window.
To guard against possible degradation of
the aerogel by the C4F10 environment, the
aerogel container is sealed gas tight and
dry nitrogen is continuously circulated
through the box at a slow rate.

The aerogel tiles are stacked in 5 layers,
with 5 horizontal rows, and 17 vertical co-
lumns as required to span the spectrom-
eter acceptance. Black plastic spacers of
appropriate thicknesses between the alu-
minum frame and the tiles prevent them
from shifting while the radiator is moved.
The aerogel wall thickness was chosen as
the optimal point for maximizing the un-
scattered light yield relative to scattered
background photons [13,14]. The tiles are
stacked according to their measured refrac-
tive index, thickness, and surface quality.
To achieve the best ring resolution, tiles
with similar refractive indices are placed
together in the same stack, so that par-
ticles passing through the radiator emit
photons with very similar ˇCerenkov angles.
Opaque black sheets of tedlar between the
aerogel stacks reduce distortions by absorb-
ing photons that cross stack boundaries.

The choice of the material for the exit win-
dow was driven by its transmission proper-
ties. Due to the proportionality to λ−4 of
the Rayleigh scattering cross section, the
low wavelength end of the light yield spec-
trum is dominated by rescattered photons.
Since they only contribute to the back-
ground, the exit window material was se-
lected to absorb most of them. A good
match was found in ultraviolet-transmitting
(UVT) lucite, which has an absorption cut-
oﬀ of 290 nm [14](see ﬁgure 6). The thick-
ness of the UVT window, 3.2 mm, was

chosen to be as small as possible while
still providing suﬃcient mechanical stabil-
ity. It contributes less than 1% of a radia-
tion length. The ˇCerenkov light generated
in the lucite itself is emitted at such high
angles that it is eﬀectively trapped by total
internal reﬂection for most forward tracks.

2.4 Mirror Array

The mirror arrays each consist of eight seg-
ments that are mounted in two rows of four
(see ﬁgure 5). Both the mirrors and the
mounting frame were fabricated by Com-
posite Mirror Applications (Tucson, Ari-
zona, USA) 2 . The backing of the segments
is fabricated from a graphite ﬁber compos-
ite [15] coated with an epoxy ﬁlm yield-
ing an optically smooth surface. Surface
roughness was speciﬁed to be less than 5 nm.
The surface is aluminized to provide a re-
ﬂectivity above 85% for light in the 300-
600 nm range (see ﬁgure 6). The segments
are held on a carbon-ﬁber frame with indi-
vidual adjustable three point mounts. The
dimensions of each array are 252.4 cm by
79.4 cm; each weighs less than 13 kg. This
guarantees that the mirrors contribute neg-
ligibly (less than 1.0% of a radiation length)
to the total radiation length of the detec-
tor, which is dominated by the freon gas
(5%), the aluminum windows (3%) and the
aerogel (2.8%).

The short time scale of the RICH installa-
tion (13 months from approval to installa-
tion) only allowed for a simple alignment
procedure when the mirrors were installed.
A point light source at the nominal radius
of curvature of the array was imaged on a

2 web: http://home.earthlink.net/
contact: R. Romeo, email: bromeo@earthlink.net

bromeo/

∼

8

)

(
 

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

)

(
 

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

loss

mirror

loss

mirror

bialkali cathode

bialkali cathode

lucite

cone

aerogel total

200

400

600

l  [nm]

cone

gas total

200

400

600

l  [nm]

Fig. 6. Eﬃciencies for transmission and detection of aerogel (left) and gas photons (right). The
included contributions are the mirror reﬂectivity (mirror), the PMT cone eﬃciency (cone), the
eﬀect of the air gap between PMT and quartz window (loss), the light transmission through
lucite and the quantum eﬃciency of the PMT bialkali cathode. The sharp edge in the cone
eﬃciency results from the sharp cutoﬀ in reﬂectivity at 200 nm. The shaded histogram is the
total eﬃciency to detect an emitted photon.

screen. The mirror segments were then ad-
justed to minimize the size of the reﬂected
image. To neutralize the unexpected ﬂex-
ibility of the mirrors, their mounting was
ﬁne-tuned by adjusting additional pressure
points where necessary. A nominal 90% of
the reﬂected light was contained in a spot
corresponding in size to the pixel size of
23 mm. The actual mirror alignment was
determined from the data itself (see sec-
tion 5).

2.5 Photon Detector

As discussed, the useful photons emitted
in the aerogel are largely limited to visible
wavelengths. The radiation emitted in the
gas does have a component extending into
the UV region, but since the photon yield
from the gas is suﬃciently high, the detec-
tor response in the UV is not crucial. Con-
sequently, photon-to-electron conversion by
photocathodes typical of commercial pho-
tomultipliers provides a simple and robust

photon detector technology.

While photomultipliers with a diameter of
0.5 inch are commercially available, their
cost and the time of construction for two
large 0.5 inch arrays were unacceptable.
Instead, Philips XP1911 photomultipliers
were chosen, with a diameter of 18.6 mm
(0.75 inch) and a guaranteed minimum ac-
tive photocathode diameter of 15 mm [16].
This led to a pixel size of 23.3 mm. ∆θpix
can be estimated at the center of the de-
tector by assuming that both the radia-
tor and the detector are at the focal plane.
This gives ∆θpix = s/(4f ) = 5.3 mrad (for
circular pixels), where f is the focal length
(110 cm) and s is the linear pixel size. How-
ever, this is a simplifying assumption and
an MC simulation leads to the values in
table 3.

The XP1911/UV (green enhanced) PMT
was chosen for its broad quantum eﬃciency
curve that matches the ˇCerenkov light spec-
trum of the aerogel well. Since the eﬃ-
ciency extends into the UV, it is also a

9

e
l
e
l
good choice for the gas photons, as is clear
from ﬁgure 6. This ﬁgure shows the diﬀer-
ent contributions to the total photon de-
tection eﬃciency for both radiators.

An automated PMT testing procedure was
used to select PMTs with a broad plateau.
High voltage (HV) plateau curves were mea-
sured for each tube with a 470 nm light
emitting diode pulser. In addition, a low
dark current single photoelectron pulse rate
was required. After the installation of the
RICH in the HERMES spectrometer a noise
rate of about 1 kHz was reached, corre-
sponding to 1 PMT ﬁring per detector half
every ﬁve events (gate length 100 ns). The
PMTs were sorted according to their gain
characteristics and their noise level. With
an especially developed low current (0.040
mA at 1300 V) high voltage divider it was
possible to supply 32 PMTs from a single
HV channel. The divider also limited the
heat generated in the base of the PMTs,
thereby signiﬁcantly reducing the cooling
requirements of the detector.

The photomultipliers were arranged in a
hexagonal closed packed matrix of 147.4 cm
by 62.8 cm, centered on the mirror focal
point. This conﬁguration was ﬁrst used by
the experiment E781-SELEX at FNAL [17].
The elementary cell of the array is a hexagon
with the photomultiplier at the center. A
light-gathering cone is used to increase the
photon collection eﬃciency by reducing the
dead space between the photocathodes. The
distance between two adjacent cell centers
is 23.3 mm, yielding an elementary cell sur-
face of 426 mm2. The 1934 PMTs in each
detector half are arranged in 73 columns
of alternately 26 and 27 PMTs each. A
section of the soft steel matrix plate and
PMT packing design is shown in ﬁgure 7.
The matrix plate provides the gas seal for
the C4F10 volume. The gas seal for indi-

184.15

threaded
copper rod

(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
23.3

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)
(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

21.3

82.55

15.0

0.0

top plate
1008 low carbon

Phillips PMT
XP1911/UV
mu-metal &
mylar wrap

bottom plate
1008 low carbon

mylar spacer ring
(0.5 mm)
quartz window
slip-fit insert
1008 low carbon

Fig. 7. Schematic photon detector design. All
units are in mm.

vidual PMT cavities was provided by thin
quartz windows which were glued to soft
steel cone-shaped inserts that in turn were
glued into the inner face of the PMT ma-
trix plate.

Only 38% of the area of the focal plane
is covered by the PMT photocathodes. An
aluminized plastic foil funnel was inserted
into each soft steel entrance cone to in-
crease the coverage to 91% of the pho-
ton detector surface and to improve the
reﬂectivity of the cone surface. The fun-
nels extend beyond the steel plate with
an opening diameter of 23.3 mm, so mini-
mizing the dead space between the PMTs.
They provide a high reﬂectivity above λ =
200 nm. Their eﬀect on the geometric col-
lection eﬃciency is shown in ﬁgure 8 as a
function of the angle between the incom-
ing photon and the normal to the detec-
tor plane (incident angle). The inﬂuence
of the funnels is found from the diﬀerence
between the total eﬃciency and the eﬃ-
ciency for ”direct” detection.

10

Total

3-bounce

2-bounce

1-bounce

Direct

y
c
n
e
i
c
i
f
f
E

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

1
Incident angle (rad)

0.9

Fig. 8. Collection eﬃciency of the funnels ver-
sus incident angle (solid points) from a Monte
Carlo simulation. The other curves show the
components of the eﬃciency in terms of the
number of “bounces”, i.e. reﬂections from the
foil surface.

The stray ﬁelds from the HERMES spec-
trometer magnet at the location of the pho-
ton detector matrix can reach up to 90 G
perpendicular to the detector plane, requir-
ing careful magnetic shielding of the PMTs.
Individual PMTs were wrapped in a 100µm
thick µ-metal sheet and the matrix plates
holding the PMTs were constructed from
high permeability (C-1008) steel. The soft
steel matrix, combined with the µ-metal
shielding and the soft steel inserts, reduces
the magnetic ﬁelds to negligible levels, which
guarantees that the PMT gains are not sig-
niﬁcantly aﬀected.

out by a set of 8 symmetric backplane sec-
tions, each housing 15 or 16 PCOS4 cards.
Each card in turn processes signals from 16
PMTs. This reduces the number of cables
needed to 10 twisted pairs cables. Only
digital information - when the pulse ex-
ceeds the threshold of 0.1 photoelectrons
- is recorded. The system is characterized
by high input sensitivity (the threshold is
3000 electrons) and high ampliﬁcation
4.3 µV per electron). Because of the 650
(
−
W power dissipated per detector half, each
RICH section has a cooling system inte-
grated into the RF-shield and electronic
enclosure. A closed stream of cooling air
(360 m3/h) is guided over the PCOS4 elec-
tronics on both sides of the PM-matrix
and over the PMT matrix itself. The heat
transferred to the air ﬂow is removed by a
water-cooled heat exchanger.

The data from both RICH detector halves
are treated in the same manner as spec-
trometer chamber data. The PCOS4 sys-
tem generates a data stream on an event-
by-event basis. The RICH data consists of
a RICH hit table for each detector half,
where a PMT ‘hit’ simply refers to a PMT
that ﬁred during the event time window. A
RICH mapping ﬁle is used to link the data
channel numbers computed in the decod-
ing process to the PMT location in the de-
tector matrix. This information can then
be used to generate the spatial hit coor-
dinates and the hit pattern in the focal
plane.

2.6 Detector Readout and Event Format

3 Online Monitoring

The readout of the photon detector is per-
formed by the commercial LeCroy PCOS4
acquisition system, upgraded for the HER-
MES application. Each detector half is read

HERMES uses a client-server based sys-
tem for the monitoring of detector operat-
ing parameters [18,19]. In the case of the
RICH this includes high and low voltages,

11

Electrons and positrons that are detected
in the RICH always have momenta above
both radiator thresholds. They should there-
fore always have both rings present, which
makes them ideal for the online monitor-
ing of the data quality. The average num-
ber of PMT hits for single lepton events in
a run is used as the monitoring parameter;
it is usually about 20. Figure 11 shows this
parameter in a typical online data quality
plot.

Fig. 10. Online display of a single event.

Fig. 11. Average number of hit PMTs per sin-
gle lepton event plotted versus run number.

Run

4 Reconstruction and Particle Iden-

tiﬁcation

4.1 Principles of the Reconstruction

Since the sensitive face of the ﬂat photon
detector does not conform to the true mir-

n
o
t
p
e
l
/
)
s
t
i
h
 
T
M
P
(

12

Fig. 9. Two-dimensional tubemap of relative
yield for the bottom RICH detector.

gas pressure and composition, and the tem-
peratures at the photon detectors. The in-
formation is available in the form of Tcl/Tk
based displays [20].

In analogy to wiremaps for the tracking
chambers, “tubemaps” are used to moni-
tor the performance of the PMTs, the high
voltage and the electronics. An example of
the standard two-dimensional overview is
shown in ﬁgure 9. The increased hit den-
sity in the center is due to the gas rings.
This plot shows that more than 99% of the
tubes are functional. More detailed maps
are available for diagnosing operational prob-
lems.

The RICH data have also been integrated
into the online HERMES event display sys-
tem to allow the online analysis of events.
Figure 10 shows the standard view for the
case of a clean single electron event. The
event display combines top and side views
of the spectrometer with views of the top
and bottom RICH photon detectors. It rep-
resents the grid of 1934 PMTs in the form
of dots. All PMTs that ﬁre are marked by
ﬁlled circles. In general particles with mo-
menta above both the aerogel and C4F10
thresholds will generate roughly concentric
rings: a small inner ring resulting from the
photons generated in the gas and a larger
outer ring formed by the aerogel photons.

ror focal surface, the detected ‘rings’ are
not circles, but in general asymmetrically
distorted ellipses. Hence a ring ﬁtting pro-
cedure is not feasible for an accurate re-
construction of the ˇCerenkov angles. The
raw data that provide the input for any re-
construction procedure are the list of PMT
hits per event and the parameters of the
particle tracks determined by the tracking
detectors [1].

≈

In the case of the aerogel rings on average
only about 10% of the PMTs that lie on
the aerogel ring will be hit. Hence mul-
tiple hits are infrequent and each PMT
hit represents one photoelectron. The av-
erage number of hits on the aerogel ring of
an ultra-relativistic (β
1) particle that
suﬀers no acceptance eﬀects (aerogel tiles,
mirror) is about 10. The sparsity of the
hits on the aerogel ring makes the detec-
tion of this ring susceptible to background,
noise and acceptance problems. The situa-
tion for gas rings is very diﬀerent. The av-
erage multiplicity of photoelectrons per hit
for the gas rings is about 2 (based on MC
simulations). This might lead to the as-
sumption that all PMTs that lie on the gas
ring will be hit. However, due to Poisson-
statistics this is not correct. On average
about 23 PMTs are touched by the gas ring
of an ultra-relativistic particle, but only 12
of those PMTs actually ﬁre. Most of them
are hit by several photo-electrons.

Figure 12 shows the oﬄine RICH event
display for a three-track event that illus-
trates several typical features of HERMES
RICH events. The event shown has a 14.6
GeV electron 3 and a 1.5 GeV pion in the

3 Electrons and positrons are identiﬁed by
a combination of calorimeter, preshower and
TRD with an average eﬃciency of 99% and a
hadron contamination below 1% [1].

Fig. 12. HERMES RICH event display for an
event with a 14.6 GeV electron (right) and
a 1.5 GeV π− (left) in the lower half and a
5.5 GeV K+ in the upper half. See text for
detailed description.

lower half, and a 5.5 GeV kaon in the upper
half of the detector. The solid black points
mark the PMT hits, while the markers in
the ring centers indicate the virtual track
hit points, i.e. the points where the particle
tracks would intersect the photon detec-
tor if they were imaged by the mirror. The
solid lines are spline ﬁts to a few simulated
photon hits. They indicate where, based on
the track parameters and the particle type,
hits could be expected for this event. The
electron track is easily identiﬁable as the
only one with a gas ring; a comparison to
ﬁgure 2 shows that only for the electron a
gas ring is expected. The momentum of the
pion is below the pion gas threshold and
thus it only exhibits an aerogel ring. How-
ever, the particle clearly must be a pion,
because the particle momentum is below
the aerogel threshold for kaons. The kaon
in the top detector has a well deﬁned aero-
gel ring, but no gas ring - as is expected for
a kaon at 5.5 GeV. Any pion at this mo-
mentum would certainly have produced a
gas ring, while the aerogel ring for a proton
would have a much smaller radius.

13

D

The task of the pattern recognition algo-
rithm is in principle to associate the vari-
ous hits in the photon detector of the RICH
with a ring assigned to a certain track.
In practice this detailed assignment is not
needed and only the information relevant
to the track identiﬁcation is extracted. The
relatively low track multiplicity in the HER-
MES experiment simpliﬁes this task con-
siderably.

C

E

S ??

mirror surface

Fig. 13. The problem of inverse ray tracing.

~CS

(2)
(3) ∢( ~ES, ~CS) = ∢( ~CS, ~DS)

= R

|

|

For the mathematical formulation of the
problem it is easier to switch to an Eu-
clidean base with C as the origin. The u
axis is deﬁned along ~CE. The v axis is
coplanar with ~CE and ~CD, and oriented
~CD > 0. The usual caret nota-
such that ˆv
tion is used to indicate a unit vector. The
third axis (w) is deﬁned such that the base
deﬁnes a right-handed coordinate system.
The components of the vectors are then:

·

~CE = (a,
0,0)
~CD = (d cos α, d sin α,0)
~CS = (R cos β,R sin β,0)

(3)

~CD
Clearly
|
gles are deﬁned in ﬁgure 14.

= a and

~CE

|

|

|

= d. The an-

The coplanarity requirement has been sat-
isﬁed by the choice of the axes. The para-
meterization of S ensures that it will be
located on the mirror surface. The remain-
ing parameter β now must be determined
from the equality of the incident and re-
ﬂected angles. This leads to two (redun-
dant) equations for the unit vectors:

4.2 Inverse Ray Tracing

The analysis of the hit patterns is intrin-
sically complex since the non-linearities of
the imaging system distort the simple ring
structure of the emitted light. The inﬂu-
ence of the imaging system can be removed
by inverse ray tracing (IRT) [8,9]. In this
method the ˇCerenkov angle corresponding
to each PMT hit is reconstructed from the
track parameters and the position of the
PMT.

The inverse ray tracing problem can be
formulated as follows: given a track and
a hit in the RICH photon detector plane,
at which angle was the photon emitted?
Assume that the emission point can be es-
timated. This assumption will be discussed
below.

The geometrical problem can be formu-
lated as follows using the terminology of
ﬁgure 13. Given point E, the likely emis-
sion point, point D, the detection point
and C, the center of the spherical mirror
the photon scatters from, ﬁnd the point
S on the surface of the mirror where the
photon scattered. The properties of point
S are, in vector notation:

(1) ~CS is coplanar with ~CE and ~CD.

14

D

v-a xis

S

C

u

-

a

x

i
s

E

Fig. 14. Deﬁnition of the base and the angles

ˆSC
ˆSC

·

ˆSE = ˆSD
ˆSE = ˆSD

·

ˆSC
ˆSC

(4)

(5)

×

×
The second equation is a vector equation,
but since all three vectors are coplanar, the
only parameter is the length of the vector
product.

The ﬁrst equation reduces to:

~SD
|
~SE
|

|

|

=

·

d

(cos α cos β + sin α sin β)

R

a cos β

R

−

−

(6)

The vector equation represents the equal-
ity of the sines of the angles, and has only a
non-zero component along the w-axis. This
component reduces to:

~SD
|
~SE
|

|

|

d(

cos α sin β + sin α cos β)

=

−

(7)

a sin β

Combining the two equations yields:

The reﬂection point on the mirror can then
be found as follows:

~S = ~C + (

R cos β
a

R sin β
a

−

cos α

·
sin α
·
R sin β
d sin α ·

+

)

~CE

·
~CD (9)

The inverse ray tracing method reconstructs
the emission angle for each hit, provided
the emission vertex is known. For each track
it is assumed that the hit could be com-
ing from the aerogel or the gas, and the
emission vertex is estimated accordingly.
For each radiator hypothesis, the emission
angle is then reconstructed. This results
in a spectrum of reconstructed angles, as
shown in ﬁgure 15, which is clearly depen-
dent on the radiator hypothesis. Due to
the very diﬀerent index of refraction, it is
rarely a problem to distinguish which radi-
ator hypothesis is correct. The remaining
uncertainty in the emission vertex due to
the ﬁnite length of the radiator is unavoid-

‘aerogel‘

‘gas‘

ad

·

sin(α
R

2β) +
(a sin β

−
·

d sin(α

β)) = 0 (8)

−

−

0

0.05

0.1

0.15

0.2

0.25

0.35

0.3
 [rad]

The solution to the equation can now be
found from Newton-Raphson iterations.
Since the result will be the angle β, no fur-
ther work is necessary. Using half of the
angle α as the starting point, convergence
is usually achieved within three iterations.

Fig. 15. Reconstructed angle spectra for the
assumption that the photon was emitted in
the aerogel (top) or in the gas (bottom). The
data are from single track, low background
electron events with p > 5 GeV.

s
t
n
u
o
c

s
t
n
u
o
c

30000

25000

20000

15000

10000

5000

0
30000

25000

20000

15000

10000

5000

0

15

b
a
Q
able and results in the contribution ∆θem
to the resolution in table 3.

Another diﬀerence in the treatment of re-
constructed aerogel and gas angles lies in
the refraction of aerogel photons at the
aerogel-gas boundaries. This is approxima-
tely corrected for under the assumption of
a ﬂat aerogel-gas boundary and coplanar
refraction.

4.3 Likelihood Analysis

The selection of a most probable particle
type is made by calculation of the likeli-
hood that each particle type would gener-
ate the measured IRT spectrum. Due to
aerogel edge eﬀects and the ﬁnite mirror
size, the yields of aerogel and gas hits vary
strongly over the spectrometer acceptance.
As a result the particle identiﬁcation is
largely based on the reconstructed aver-
age angles, which are less susceptible to
these eﬀects. The theoretically expected
angles θth are calculated for each parti-
cle type hypothesis i from the track mo-
menta. For each particle type hypothesis
a window is imposed on the spectrum of
reconstructed angles around this expected
value. The width of this window (σw) is set
to 4 times the single photon resolution σθ.
However, it is in principle a free parame-
ter that can be adjusted to optimize the
performance of the particle identiﬁcation
algorithm. The average angle is then de-
termined from the reconstructed angles in
the window [θth

σw; θth + σw].

−

The distribution of measured average an-
gles for a given particle type and momen-
tum can be normalized to form a condi-
tional probability. For known relative par-
ticle ﬂuxes a particle type probability can

then be calculated. If the relative parti-
cle ﬂuxes are not known, the conditional
probability can itself be used as a likeli-
hood. Furthermore, if the average angle
resolution is assumed to be independent
of the particle type, the overall normaliza-
tion of the conditional probability distri-
bution does not matter. It may be chosen
so that the maximum value of the likeli-
hood is 1. With a Gaussian shape of the
average angle distribution the likelihood is
then calculated as

) = exp 

L(

θ

h

i

(θth

θ

)2

i





− h
2σ2
hθi

−

(10)

where σhθi is the average angle resolution,
which is calculated from the single photon
resolution as

σhθi =

σθ
√N

(11)

The likelihoods for the two radiators, aero-
gel and gas, are combined to an overall
likelihood by multiplication. For this pa-
per, the particle is assigned the type with
the highest likelihood. Obviously, this re-
quirement will allow more contamination
than is acceptable for most physics analy-
ses. A detailed discussion of the “quality”
of the particle identiﬁcation and the result-
ing tradeoﬀ between contamination and ef-
ﬁciency will be the subject of a subsequent
paper.

5 Mirror Alignment

The alignment of the mirror array within
the detector volume was determined from
the data. It consisted of three steps: global
alignment, individual mirror alignment and
local alignment.

16

Fig. 16. Focusing quality
and local mirror alignment. The lines indicate the boundaries of the individual mirrors.

for pion gas rings (4.5-5.5 GeV) before and after the individual

θ
−h

θi
|

i|

For global mirror alignment the mirror ar-
ray was treated as one unit. A three-dimen-
sional scan of the assumed position of the
mirror center was performed (in software)
and the inﬂuence on the reconstructed aero-
gel and gas rings was studied using a set of
high energy single electron tracks. The per-
formance was characterized using 24 pa-
rameters, including the average angles, their
spread, the single photon resolution, the
yields and the azimuthal uniformity of the
gas rings. A careful study resulted in a
small range of acceptable values for the
position of the mirror center and a shal-

low optimum was selected.

However, both mirror arrays consist of eight
individual mirrors each, whose alignment
relative to one another is not necessarily
perfect. In addition, the construction of
the mirror allows for local variations of the
radius of curvature of the surface, espe-
cially around the stress points introduced
to compensate for the ﬂexibility of the in-
dividual mirror segments (positioned at the
edges of the mirrors). These variations in
the mirror radius introduce local variations
in the reconstructed angle. This translates

17

into a larger spread on the reconstructed
angle, and (if not corrected) a diﬀerent av-
erage angle for some parts of the mirror. In
certain momentum ranges this can lead to
a misidentiﬁcation of the particle.

For this reason in the next two steps of
the alignment determination the individ-
ual mirrors are aligned relative to one an-
other and then each mirror is further sub-
divided and the pieces are individually ad-
justed. Steps two and three are based on
two geometric properties of the mirrors:
the position of a spherical mirror with
known radius is unambiguously determined
by the position of the mirror center. Fur-
thermore, if it is known how a single pho-
ton is reﬂected by the mirror, the mirror
center can be determined for a given ra-
dius.

While the actual track of a photon in the
detector cannot be determined, it is pos-
sible to determine approximately how a
charged particle track would reﬂect in the
mirror. This is done by measuring the cen-
ter of the gas ring created by the track.
This center can be related to the point
where a reﬂected track would hit the pho-
ton detector by comparing it to an MC
simulation. For a single track the recon-
struction of the individual mirror centers is
still underdetermined. However, it is pos-
sible to use a large number of tracks with
gas rings that were reﬂected on the same
individual mirror and then calculate the
optimal mirror center to account for their
behavior. This optimum is not unique and
depends somewhat on the starting point.

For the third step the individual mirrors
were artiﬁcially divided into 3
3 parts
that were treated as if they were individual
mirrors. The limiting factor here is the size
of the gas rings. This ‘local alignment’ al-

×

i

θ

i|

− h

, where θi

lows for a better approximation of the real
mirror surfaces. The result is illustrated for
the top mirror array in ﬁgure 16. The plot-
ted quantity is the focusing quality
θi
is the reconstructed
|
ˇCerenkov angle for a single PMT hit and
θ
is the average angle for the correspond-
h
ing track. This quantity approximately cor-
responds to a local derivative of the mirror
surface. Individual mirror and local align-
ment are based on a large sample of pions
with momenta between 4.5 and 5.5 GeV.
They were selected to cover as much as
possible of the mirror surface while having
well deﬁned gas rings.

6 Detector Performance

The detector performance ultimately is mea-
sured by how well the various particle types
are identiﬁed. For a given particle identiﬁ-
cation algorithm this performance is deter-
mined by the number of detected gas and
aerogel photons, as well as the single pho-
ton resolution. Complications arise from
overlapping rings and background hits.

6.1 Yields

The number of aerogel photons detected
strongly depends on how much the track
is aﬀected by acceptance eﬀects from the
ﬁnite size of the mirror array and the tile
structure of the aerogel radiator. Figure 17
illustrates the inﬂuence of the tile struc-
ture. The bottom plot is a projection of
of a horizontal band of tile in the top plot
between y=30 cm and 36 cm, showing the
edges of the aerogel tile stacks. The slightly
lower average yield in the top left tile arises
from a lower incident electron ﬂux. With
the given size of the aerogel tiles about

18

Figure 18 shows the number of aerogel PMT
hits N(aero) and gas PMT hits N(gas) ver-
sus particle momentum for ‘ideal’ pion
tracks that do not suﬀer from acceptance
or overlap eﬀects. The two plots show the
rise towards the asymptotic values of 10
aerogel hits and 12 gas hits. As a result
of the acceptance eﬀects, the asymptotic
number of aerogel hits for all tracks is re-
duced to about 8.

6.2 Background

An inspection of all events from a single
run (1861 events) showed that roughly one
third of all particles that produce clear rings
in the detector do not have a full recon-
structed track that is associated with them.
These tracks are low momentum particles
that do not pass through the entire spec-
trometer and particles produced in ﬂight
within the spectrometer. Examples of the
latter are delta electrons and electron-posi-
tron pairs. These ‘trackless rings’ act as
background for the rings that are associ-
ated with tracked particles. In events with
more than one track in one detector half
the rings of the tracked particles of course
are ‘background’ for one another in the
same way.

In addition to the trackless rings, there are
several sources of background photons that
do not necessarily result in ring structures.
These include Rayleigh scattered photons,
ˇCerenkov photons produced in the lucite
window, proton beam correlated back-
ground showers that hit the PMT matrix
directly and scintillation in the gas. The
electronic and PMT noise in the detector
is a very small eﬀect, amounting to only
about 1 ﬁred PMT every 5 events.

Fig. 17. Dependence of electron aerogel yield
on track position at the aerogel radiator.

12

10

)
o
r
e
a
(
N

)
s
a
g
(
N

12

10

8

6

4

2

0

8

6

4

2

0

0

0.5

1

1.5

2

2.5

3

3.5
p [GeV]

0

1

2

3

4

5

6

7

8
9
p [GeV]

Fig. 18. Number of ﬁred aerogel (top) and
gas PMTs (bottom) versus particle momen-
tum for ‘ideal’ pion tracks.

45% of all tracks are aﬀected by the tile
structure. It would be desirable to develop
larger aerogel tiles of the same optical qual-
30 cm2
ity. For example, in the case of 20
tiles only about 20% of the tracks would
be aﬀected.

×

19

6.3 Average Angles and Resolution

As the likelihood analysis is based on the
average angles, it is of particular impor-
tance that the angles are correctly recon-
structed and that their momentum depen-
dence is understood. Figure 19 shows the
reconstructed average aerogel angle for pi-
ons. The data were ﬁt with a theoretical
curve with the aerogel index of refraction
as the only free parameter. The resulting
curve and index of refraction (n=1.0304)
are in excellent agreement with the theo-
retical expectation and the optically mea-
sured index of refraction. Figure 20 shows
the reconstructed gas angles for pions to-
gether with the theoretical curve for an in-
dex of refraction of 1.00137. The system-
atic diﬀerence between data and theoret-
ical curve at low momenta is due to the
ﬁnite size of the PMTs.

The MC simulation of the RICH detec-
tor plays an important role in the under-
standing of eﬃciency and contamination
values for the RICH particle identiﬁcation.
Hence, it is necessary that the detector re-
sponse is adequately described by the sim-

n

]
d
a
r
[
 

0.3

0.275

0.25

0.225

0.2

0.175

0.15

0.125

0.1

ulation. Figures 21 and 22 show the com-
parison of reconstructed aerogel and gas
angles
electrons
(p > 5 GeV).

ultra-relativistic

for

For the comparison the data and the MC
results were normalized to the same max-
imum value.

Figure 21 shows the excellent agreement
in the central part of the distribution. The
wider tails of the experimental distribution
are due to several eﬀects that will be dis-
cussed below. The ﬂat background past the
tails is another important diﬀerence be-
tween the MC and the data. The diﬀer-
ence in the aerogel spectra is due to the
presence of additional contributions to the
resolution, which are listed in table 4. A
signiﬁcant eﬀect comes from the aerogel
tiles, which have sharply curved surfaces
near the edge. This refracts the photon in
an unpredictable way, which gives rise to
the ∆θtile contribution. It also contributes
to the background. ∆θtile was estimated

]
d
a
r

[

 

0.06

0.055

0.05

0.045

0.04

0.035

0.03

0.025

n = 1.00137

p  data

0

1

2

3

4

5

6

7

8

9

10

p [GeV]

Fig. 19. Reconstructed average aerogel an-
gle versus particle momentum for pions. The
solid line represents a ﬁt with n=1.0304.

20

0.02

0

2

4

6

8

10

12

14

16
p [GeV]

Fig. 20. Reconstructed average gas angle
versus particle momentum for pions. The
solid line represents a theoretical curve with
n=1.00137.

q
q
0.05

0.04

0.03

0.02

0.01

0

0.05

0.04

0.03

0.02

0.01

0

0.2

0.21 0.22 0.23 0.24 0.25 0.26 0.27 0.28 0.29

0.3
 [rad]

Fig. 21. Normalized distributions of recon-
structed aerogel angles for single, low back-
ground electrons (p > 5 GeV). Histogram:
MC, points: data.

0

0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09

0.1
 [rad]

Fig. 22. Normalized distributions of recon-
structed gas angles for single, low background
electrons (p > 5 GeV). Histogram: MC,
points: data.

from comparing the resolution for tracks
that are not aﬀected by the tile edges to
those that are. ∆θnvar accounts for varia-
tions in the index of refraction between the
aerogel tiles. Its value is determined from
the measured indices of refraction. There
is also a ‘forward scattering’ contribution
∆θf w [21], which must be taken into ac-

21

count, but which, unlike the contribution
∆θchr, is not included in the Monte Carlo
simulation.

For the reconstructed gas angles in ﬁgure
22, the width and shape of the distribu-
tions is basically in good agreement. The
MC distribution is slightly wider and less
‘Gaussian’ than the experimental data. As
this is the distribution of the individual
reconstructed angles (with one entry per
ﬁred PMT), this is likely an eﬀect of the
MC overestimating the photoelectron yield
for the gas. Due to the non-linear relation-
ship between the number of photoelectrons
and the number of ﬁred PMTs the addi-
tional photoelectrons add relatively more
to the sides than to the center of the dis-
tribution.

Pressure and temperature ﬂuctuations
change the density of the gas, and there-
fore its index of refraction. This contri-
bution, ∆θpress, was determined from the
observed maximum pressure ﬂuctuations.
This error can be eliminated by taking the
measured pressures into account in the re-
construction.

aerogel

C4F10

∆θtile

3.0 mrad

∆θnvar

1.1 mrad

∆θf w

0.9 mrad

-

-

-

∆θpress

-

∆θexp

7.6 mrad

1.0 mrad

∼
7.5 mrad

∼

∼

∼

∼

∆θmirr

2.3 mrad

2.2 mrad

∼

Table 4
Additional contributions to the single photon
resolution in aerogel and C4F10. The contri-
bution to the resolution related to the mirrors
(∆θmirr) has been obtained by subtracting
the other relevant contributions from ∆θexp.

Q
Q
The experimental value of the total an-
gular resolution for single photons, ∆θexp,
was determined for high energy single lep-
ton tracks that are not aﬀected by any
tile edge or mirror acceptance eﬀects (ta-
ble 4). The data were taken from a period
of stable atmospheric pressure and events
with a large background were excluded.
The reconstructed angle spectra were ﬁt-
ted with a Gaussian plus a linear back-
ground. As a result of the selection of these
‘ideal’ tracks the aerogel tile eﬀects (∆θtile)
do not contribute to ∆θexp for aerogel and
∆θpress does not contribute to ∆θexp for
gas. The experimental gas resolution there-
fore is a combination of the eﬀects that
are collected in ∆θM C (cf. table 3) and the
hitherto unknown contribution of the mir-
ror imperfections ∆θmirr. This contribu-
tion in particular refers to the non-sphericity
of the mirror array and the diﬀuse reﬂec-
tion component of its surface. Under the
assumption that the quadratic sum of ∆θM C
and ∆θmirr yields the experimental value
∆θexp for gas, the mirror contribution is
calculated to be about 2.2 mrad. In the
case of the aerogel also ∆θnvar and ∆θf w
must be included. The assumption that ∆θexp
for aerogel is the quadratic sum of these
contributions with ∆θM C (cf. table 3) leads
to a value of 2.3 mrad for ∆θmirr, in good
agreement with the value extracted from
the gas angles.

A comparison of tables 3 and 4 shows that
the dominant contribution to the resolu-
tion comes from the pixel size (∆θpix).

6.4 Eﬃciencies

Monte Carlo predictions for the eﬃcien-
cies and purities of the hadron identiﬁca-
tion using the IRT likelihood algorithm are

given in table 5. The MC simulation of
the RICH detector used for this predic-
tion contains a detailed simulation of the
aerogel radiator geometry as well as exper-
imental background data extracted from
trackless events. The data are from 1.84
million MC events using a deep inelastic
scattering generator. The particles are iden-
tiﬁed as the particle type with the high-
est IRT likelihood. As mentioned before,
stronger constraints on the particle likeli-
hoods will improve the purity of the sam-
ple, albeit at the expense of the eﬃciency.

π

K

p

ε

id. as

π

K

p

purity

619390

8050

23008

17282

58390

16757

7461

5612

80113

0.95

0.63

0.86

no id.

10802

6647

29634

0.95

0.74

0.54

Table 5
Typical eﬃciencies and purities for the RICH
hadron identiﬁcation based on the IRT likeli-
hood analysis of 1.84 million DIS MC events,
p > 2 GeV.

Decay

Eﬃciency

π+π−

π+π−

→
K +K −

ρ0

Ks

→

φ

Λ

→

→

pπ−

επ = 0.915

0.024

επ = 0.900

0.005

εK = 0.750

0.007

εp = 0.726

0.010

επ = 0.890

0.011

±

±

±

±

±

Table 6
Typical momentum integrated eﬃciencies de-
termined from decaying particles based on the
IRT likelihood analysis.

It is not possible to use another detector to
create clean hadron samples to study the
detector performance. However, it is possi-
ble to use decaying particles for the same

22

Pp

Pp K

Pp p

1

0.98

0.96

0.94

0.92

0.06

0.04

0.02

0

0.06

0.04

0.02

0

0.04

0.02

0

purpose. Samples of ρ, φ and Ks mesons
as well as Λ hyperons were used to deter-
mine the identiﬁcation eﬃciencies for pi-
ons, kaons and protons. The momentum
integrated results (p>2 GeV) are shown in
table 6. The MC values in table 5 and the
experimental values in table 6 cannot be
compared directly, because the eﬃciencies
depend strongly on the particle momen-
tum as well as on the event topology.

plots show the identiﬁcation probabilities
P i
π that a pion is identiﬁed as pion, kaon,
proton or not identiﬁed (X). The pion iden-
tiﬁcation eﬃciency P π
π for single tracks is
above 92% even at low momenta, and above
98% for momenta larger than 4 GeV. The
MC data are taken from the sample also
used for table 5, while the experimental
data are from ρ0-decays. MC and experi-
mental results agree well,with the possible
exception of the lowest moment bin.

The comparison of MC and experimental
data becomes more involved for event topolo-
gies with overlapping rings and as the open-
ing angle for φ-decays in HERMES is small
there are basically no experimental data
with one single kaon per detector half. A
detailed evaluation of the detector perfor-
mance that takes the event topology and
momentum dependence into account in de-
tail will be included in a forthcoming pa-
per.

Pp X

0.06

7 Conclusion and Outlook

2

4

6

8

10

12

14
p [GeV]

Fig. 23. Identiﬁcation probabilities P i
π that a
pion is identiﬁed as pion, kaon, proton or not
identiﬁed (X) for single tracks per detector
half. DIS MC simulation (circles) in compar-
ison with experimental data from ρ0-decays
(solid squares); both results are based on the
IRT likelihood analysis.

This dependence on the event topology can
be excluded by comparing subsamples with
only one track per detector half. Figure 23
compares MC and experimental data for
the case of single track pions. The four

The HERMES RICH detector has been
constructed and installed within 13 months
after its approval. It has been operating
routinely as part of the HERMES experi-
ment since its installation in May 1998. Its
operation has been stable and reliable for
more than two years. The single photon
resolution for ideal tracks is close to the
MC predictions. The particle identiﬁcation
based on the inverse ray tracing technique
has been implemented and its likelihood
analysis has been optimized. More elabo-
rate particle identiﬁcation schemes are un-
der development. Hadron identiﬁcation by
the RICH detector will be a crucial feature
of the analysis of the current (1998 - 2000)
and future HERMES data.

23

p
8 Acknowledgements

[7] D.E. Fields et al.,

We gratefully acknowledge the DESY man-
agement for its support and the DESY staﬀ
and the staﬀs of the collaborating institu-
tions for their strong and enthusiastic sup-
port. It is a pleasure to acknowledge the as-
sistance of R. Romeo of Composite Mirror
Applications in the installation and initial
alignment of the mirror array, and valu-
able consultations with the SELEX group
at FNAL during the design of the HER-
MES RICH. This work was supported by
the FWO-Flanders, Belgium; the INTAS
(project 96-274), HCM, and TMR network
contributions (ERBFMRXCT960008) from
the European Community: The German
Bundesministerium f¨ur Bildung, Wissen-
schaft, Forschung and Technologie; the
Deutscher Akademischer Austauschdienst
(DAAD); the Italian Istituto Nazionale di
Fisica Nucleare (INFN); Monbusho, JSPS,
and Toary Science Foundation of Japan;
the U.S Department of Energy; and the
U.S. National Science Foundation.

References

[2] E. Cisbani et al.,

HERMES internal note 97-003(1997)

[3] J. Seguinot and T. Ypsilantis,

Nucl. Instr. and Meth. A343 (1994) 1.

[4] H. Yokogawa and M. Yokoyama.,

J. Non-Cryst. Solids 186 (1995) 23.

[5]

I. Adachi et al.,
Nucl. Instr. and Meth. A355 (1995) 390.

[6] H. Burkhardt et al.,

Nucl. Instr. and Meth. 184 (1981) 319.

24

Nucl. Instr. and Meth. A349 (1994) 431.

[8] R. Forty and O. Schneider,
internal note LHCb/98-40

[9] T. Ypsilantis and J. Seguinot,

Nucl. Instr. and Meth. A343 (1994) 30.

[10] E. Cisbani, PhD thesis,

La Sapienza University, Rome, 1998.

[11] L.F. Zhang, Thesis,

Tokyo Institute of Technology, 1999
HERMES internal note 99-064

[12] E. Aschenauer et al.,

Nucl. Instr. and Meth. A440 (2000) 338.

[13] R. De Leo et al.,

Nucl. Instr. and Meth. A401 (1997) 187.

[14] P. Carter, PhD thesis, CalTech, 1999.

[15] P.C. Chen, T.T. Saha, A.M. Smith,
R.C. Romeo, Optical Eng. 37, No. 2
(1998).

[16] E. Aschenauer et al.,

Nucl. Instr. and Meth. A433 (1999) 168.

[17] M. Pommot Maia et al.,

Nucl. Instr. and Meth. A326 (1993) 496.

[18] R. Kaiser et al.,

Online Monitoring at HERMES,
Proc. of CHEP97, Berlin, April 1997.

DAD-Distributed ADAMO Database
System at HERMES, Proc. of CHEP95,
Rio de Janeiro, 1995

[20] K. Ackerstaﬀ and M.-A. Funk,

PinK: A Tcl/Tk
based Database
Interface to ADAMO and DAD, Proc. of
CHEP95, Rio de Janeiro, 1995

[21] R. De Leo et al.,
Chromatic
scattering of light in silica aerogel,
Nucl. Instr. and Meth., in press

aberration

and

forward

[1] HERMES Collaboration, K. Ackerstaﬀ et
al., Nucl. Inst. Meth. A417 (1998) 230.

[19] W. Wander,

