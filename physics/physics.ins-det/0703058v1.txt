EUDET-Report-2007-01

7
0
0
2
 
r
a

M
 
6
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
8
5
0
3
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

EUDET Telescope Geometry and Resolution Studies

EUDET

A.F. ˙Zarnecki∗, P.Nie˙zurawski∗

February 12, 2007

Abstract

Construction of EUDET pixel telescope will signiﬁcantly improve the test beam
infrastructure for the ILC vertex detector studies. The telescope, based on the
Monolithic Active Pixel Sensors (MAPS), will consist of up to six readout planes
and will be initially installed at an electron beam line at DESY. A dedicated
study was performed to understand the position measurement in the telescope and
optimize its performance by suggesting the best plane setup. The approach based
on the analytical track ﬁtting method allows for determination of the expected
measurement uncertainty and for comparison of diﬀerent telescope setups without
time consuming event simulation. The proposed method also turns out to be little
sensitive to the possible telescope misalignment.

∗Institute of Experimental Physics, Warsaw University, Warsaw, Poland

1

1 Introduction

The goal of the EUDET project [1] is the improvement of infrastructures to enable R&D
on detector technologies for ILC with large scale prototypes. The project is supported
by the European Union in the Sixth Framework Programme structuring the European
Research Area [2]. One of the research activities, aiming at improving the test beam
infrastructure for the vertex detector studies, includes construction of a beam telescope
based on Monolithic Active Pixel Sensors (MAPS) [3]. The telescope will consist of up
to six sensor planes and will be initially installed at a 6 GeV/c electron beam line at
DESY. However, the device should be built in such a way that it could later be used
at other laboratories, for instance at high energy hadron beam at CERN. To meet all
the requirements and provide a universal test environment for a wide variety of diﬀerent
sensor prototypes, the telescope has to be designed very carefully. One of the important
issues is the choice of the telescope plane conﬁguration.
The main aim of the presented study was to understand the position measurement in the
telescope and optimize its performance by suggesting the best plane setup. A dedicated
track ﬁtting method was developed taking into account multiple scattering. Use of
analytical approach allowed us to identify main factors determining the measurement
error and compare diﬀerent telescope setups without time consuming MC simulations.

2 Analysis method

2.1 Assumptions

The approach presented in this paper is based on few simplifying assumptions. These
assumptions seem to be realistic for the considered telescope parameters.
The most important assumption is that for the angle between the actual particle track
and the nominal beam direction is always small. This is fulﬁlled if the incoming beam
has a limited angular spread and if the particle scattering angles in subsequent telescope
layers are small. We also assume that the beam is perpendicular to the sensor planes,
so that the track length between planes and the eﬀective thickness of the material layer
crossed by the particle are the same for all particles and given by telescope geometry.
Thicknesses of all material layers are very small compared to the distances between
planes and we assume they can be neglected when calculating the particle scattering
angle.
The distribution of the scattering angle is assumed to be Gaussian and the expected
width of the distribution can be estimated from the formula [4]:

∆Θplane =

13.6 MeV
βcp

dx
X0 "

z

s

1 + 0.038 ln

dx
X0 !#

 

(1)

where p, βc and z are the momentum, velocity and charge of the incident particle, and
dx/X0 is thickness of the scattering medium in radiation lengths. For the telescope
planes we use the radiation length of silicon, X Si
0 = 9.36 cm. We also assume that the

2

y

1

DUT
i

DUT

N

x

Figure 1: Schematic view of the EUDET beam telescope setup.

position measurement errors in all planes are Gaussian and that there are no correlations
between the horizontal and vertical position measurements.
With all the above assumptions the particle track reconstruction in the telescope can
be separated into two independent problems of track ﬁtting in horizontal and vertical
planes.

2.2 Geometry description

The schematic view of the EUDET beam telescope is presented in Figure 1. We use
the right-handed Cartesian coordinate system with the X axis pointing in the nominal
beam direction and Z axis pointing up. In the presented analysis we use the following
variables to describe the telescope geometry:

• N - number of telescope planes; all sensor planes as well as nonactive material

layers and included, position of the tested detector plane is denoted by iDU T ,

• xi - position of each plane along the beam direction (i = 1 . . . N),

• ∆i - thickness of each plane in radiation lengths,

• ∆θi - average scattering angle in each plane, calculated from formula (1),

• σi - position measurement resolution (for sensor planes).

In the following we will assume that the telescope consists only of DUT and N − 1 active
sensor planes (i 6= iDU T ) and there is no additional nonactive material, which could aﬀect
the performance of the telescope. We also assume that all detector layers are perfectly
aligned. The inﬂuence of the possible telescope misalignment and the eﬀects expected
due to additional material layers in front of and behind DUT (beam windows) will be
discussed in the later part of this paper.

2.3 Track ﬁtting

With the expected distances between telescope planes of the order of 10–100 mm and
the scattering angles of the order of 0.1 mrad (e.g. for 500µm layer and 5 GeV electron
beam), the expected track displacement due to scattering can be of the order of few

3

y

i−1

i

i+1

pi

Θ

i−1

pi−1

x
pi+1

iΘ

Figure 2: Deﬁnition of angles used to calculate particle multiple scattering in plane i.

micrometers.
It is comparable with the expected position resolution of the telescope
sensor layers (∼ 2 µm) and can not be neglected. The track ﬁtting method described
below takes it fully into account. Similar approach was previously described in [5].
As mentioned above, track ﬁtting can be considered separately for horizontal and vertical
plane (or any two perpendicular planes parallel to the beam axis). Therefor, in the
description of the method we will limit ourselves to the two dimensional problem in the
horizontal (X − Y ) plane.
The aim of the ﬁt is to determine particle positions in each telescope plane (including
DUT), i.e. N parameters (pi, i = 1 . . . N), from N − 1 positions measured in telescope
planes (yi, i 6= iDU T ). The problem can be solved, because we can use additional con-
straints on the angles of multiple scattering. Contribution of plane i to χ2 of the ﬁt can
be written as:

∆χ2

i =

yi − pi

2

(cid:18)

σi (cid:19)

+

=iDU T
i

(cid:18)

Θi − Θi
∆Θi

1

−

2

(cid:19)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
=1,N
i
(cid:12)
(cid:12)
(cid:12)
(cid:12)

where Θi denotes the angle between the direction perpendicular to the telescope planes
(nominal beam direction) and the particle track direction between planes i and i + 1 (see
Figure 2). The track angle can be calculated from particle positions in these planes:

(2)

Θi =

pi+1 − pi
xi+1 − xi

.

The ﬁrst term in (2) is due to the uncertainty of the position measurement and the
second one reﬂects the expected distribution of the angle of particle multiple scattering
in plane i. The measurement term drops out for DUT (and other nonactive telescope
layers, if considered), whereas the scattering term is missing for the ﬁrst and the last
plane, as the scattering angle can not be determined1.
After summing over all telescope layers we get general the following formula for χ2:

χ2 =

εi(yi − pi)2 +

N

i=1
X

N

1

−

(ai + ai

i=2  
X

−

1)pi − ai
−
∆Θi

1pi

1 − aipi+1

−

2

!

1 Constraint on the multiple scattering angle in the ﬁrst plan can be included, if the angular spread of
the incoming beam is known and can be approximated by the Gaussian distribution. This additional
constrain inﬂuences the results only if the angular spread of the incoming beam is comparable or
smaller than the expected scattering angles in telescope planes. It was not considered in the presented
analysis

4

6
6
where the coeﬃcients εi and ai are deﬁned as

εi =

ai =

1
σ2
i
0

(

for i 6= iDU T
for i = iDU T

1
xi+1 − xi

(sensor planes)

Fitting a track implies ﬁnding most probable values of particle positions in telescope
planes, i.e. ﬁnding minimum of χ2. It is equivalent to solving the set of N equations:

The advantage of the presented approach is that the derivatives of χ2 can be calculated
analytically. First derivatives are linear functions of particle positions pi and the problem
can be further reduced to solving a matrix equation:

where:

The general formula for A is quite complicated, but the matrix can be calculated ana-
lytically. Moreover, all elements of A depend only on the assumed telescope geometry
and do not depend on the measured particle positions yi. Therefor the matrix A needs
to be calculated only once. To solve the equation (i.e. ﬁt the track) we only need to ﬁnd
the inverse matrix:

which can then be used to ﬁt tracks for all collected events. Reconstructed particle
position in plane i is given by a linear combination of measured positions yj in all active
layers:

pi =

Sij εj yj

Xj

(3)

Position measurement at DUT, although formally included in the general formula, does
not contribute to the results as εiDU T = 0 (same is true for other nonactive telescope
layers, if considered).
The diagonal elements of S correspond to the expected precision of the particle position
reconstruction. The error on the particle position at plane i is given by:

∂χ2
∂pi

= 0,

i = 1 . . . N.

Aij pj = εi yi

j
X

Aij =

1
2

∂2χ2
∂pi ∂pj

S = A−

1

˜σi =

Si i

q

5

m
 
µ
 
 
0
2
1

m
 
µ
 
 
0
2
1

m
 
µ
 
 
0
2
1

m
 
µ
 
 
0
0
5

m
 
µ
 
 
0
2
1

m
 
µ
 
 
0
2
1

m
 
µ
 
 
0
2
1

100mm

20mm 17mm

100mm

100mm

3mm

Figure 3: The telescope conﬁguration as used in the simulation studies.

Again, it turns out that the uncertainties of reconstructed particle positions depend
only on the assumed telescope geometry and do not depend on the measured particle
positions. This feature of the proposed analysis method is of great importance, as it
allows us to compare the precision of position determination at DUT, σDU T ≡ ˜σiDU T ,
for diﬀerent telescope geometries and beam energies, without time consuming event
generation based on Monte Carlo methods.

3 Simulation results

3.1 Telescope conﬁguration

To verify the validity of diﬀerent assumptions used in the proposed track ﬁtting method,
a dedicated simulation study based on Geant 4 has been performed. The telescope
conﬁguration used in the simulation is presented in Figure 3. Telescope consists of 7
layers: 6 sensor layers with thickness of 120µm and a DUT, 500 µm thick, placed as
a middle layer (indicated in magenta). The ﬁrst two and the last two sensor planes
(indicated in red) are assumed to have the position resolution of 2µm (standard sensor
planes), whereas for the sensor planes adjacent to DUT (indicated in blue) resolution
of 1µm is assumed (high-resolution planes). Distances between planes, as indicated in
the plot, correspond to the conﬁgurations which turned out to result in best particle
position determination at DUT. Detector response is simulated by a Gaussian smearing
of the particle position with the assumed detector resolution. True particle position at
given layer is taken as the mean value of the positions at the entry and exit points, as
obtained from simulation. Simulation was performed for two incident beam energies:
electron beam of 6 GeV and pion beam of 100 GeV. A sample event from the 6 GeV
electron beam simulation is presented in Figure 4.

3.2 Reconstruction results

Also shown in Figure 4 is the result of particle track reconstruction with the described
method (solid blue line). Reconstructed track follows very closely the ”true” particle tra-

6

]

m
µ
[

 

y

]

m
µ
[

 
z

50

0

-50

50

0

-50

-150

-100

-50

0

50

100

150

200

-150

-100

-50

0

50

100

150

200

x [mm]

x [mm]

Figure 4: Simulation results in horizontal (upper plot) and vertical (lower plot) plane, for
6 GeV electron passing through the telescope. Black dashed line corresponds to
the simulated particle trajectory, green dots represent the simulated position
measurements, blue solid line is the output of the described reconstruction
method.

jectory (indicated by dashed line) properly describing particle deﬂection due to multiple
scattering both in DUT and in the sensor layers. The diﬀerence between the recon-
structed and generated particle position at DUT is presented in Figure 5. As expected,
distribution of the position reconstruction error has a Gaussian shape, as indicated by
the ﬁtted Gaussian distribution. Only very few events populate non-Gaussian tails,
which are probably due to the events with large multiple scattering, not described by
the approximate formula (1).
The quality of the track reconstruction is also illustrated in Figure 6. Distribution of
the total χ2 of the track, calculated as a sum of χ2 from ﬁts in the horizontal and
vertical plane, is compared with the expected χ2 distribution. Results of the simulation
are very well described by the distribution expected for 8 degrees of freedom. This is
consistent with our expectations, as we ﬁt 14 parameters (particle position in Y and Z,
in 7 telescope planes) using 12 measurements (from 6 sensor planes) and 10 constraints
on multiple scattering (5 inner telescope planes). In the general case, number of degrees
of freedom is given by

Ndf = 2 · Ns − 4,

where Ns is the number of active sensor layers.
Precision of particle position determination at the DUT plane, as obtained from the
Gaussian distribution ﬁt to all simulated events (see Figure 5) is 0.84µm. However, for
few percent of events we observe χ2 values larger than expected (see Figure 6). If we

7

N

10 3

10 2

10

1

s
t
n
e
v
e
#

400

200

-10

-5

0

5
10
yfit - ygen [µm]

Figure 5: Reconstruction error distribution for the particle position at DUT, for 6 GeV
electron beam. Simulation results (blue histogram) are compared with the
ﬁtted Gaussian distribution (red line).

0

0

10

20

30

40
χ2

Figure 6: Distribution of the total χ2 of the track ﬁt, for 6 GeV electron beam, compared

with the expected χ2 distribution for 8 degrees of freedom.

8

line / 6 planes

line / 4 planes

full fit / 6 planes

expected

2

]

m
µ
[

 

T
U
D

σ

1.5

1

10

2
10
χ2 cut efficiency [%]

Figure 7: Obtained position resolution at DUT, σDU T , as a function of the fraction of
events accepted after χ2, Results from the described method taking into ac-
count multiple scattering (green points) are compared with position resolution
obtained from the straight line ﬁt to 6 sensor planes and to 4 inner sensor
planes.

reject these events, position reconstruction uncertainty of about 0.81µm is obtained, in
very good agreement with 0.80µm expected from the analytical calculation. The de-
pendence of the obtained position resolution at DUT, σDU T , on the fraction of events
accepted after χ2 cut, is presented in Figure 7. After rejecting of about 10% of events
with highest χ2 values, telescope position resolution remains ﬂat and agrees very well
with the expected precision (indicated by yellow line). For comparison, position reso-
lution at DUT, as obtained from the straight line ﬁt to 6 sensor planes and to 4 inner
sensor planes is also shown in Figure 7. Line ﬁt to 4 planes results in much better
position determination than the ﬁt to 6 planes. This is because the measurements in
the ﬁrst and the last plane are least correlated with the particle position at DUT due
to eﬀects of multiple scattering. Reconstruction method presented in this paper takes
these eﬀect into account and allows us to obtain optimum position measurement for 90%
of events, whereas for the line ﬁt the corresponding precision could only be reached for
about 10% of events with smallest multiple scattering.

3.3 Comparison with analytical error estimates

Results presented so far were based on the simulation assuming position measurement
resolution of 1µm for two sensor planes adjacent to DUT (high-resolution planes) and
2µm for the remaining standard sensor planes. To test the validity of analytical ap-
proach to position error determination, simulation of detector response was repeated for

9

STD = 2 µm
σ

STD = 3 µm
σ

GEANT   90%

with beam spread

]

m
µ
[

 

σ

1.4
T
U
D

1.2

1

0.8

0.6

1

1.5

2
HR [µm]
σ

Figure 8: Precision of position determination at DUT, for 6 GeV electron beam, as a
function of the position resolution in the high-resolution planes, σHR, for stan-
dard planes resolution of 2µm (blue) and 3µm (red). Results of the Geant
4 simulation (points) are compared with expectations from the analytical cal-
culations (lines).

diﬀerent values of the assumed sensor plane position resolutions. Shown in Figure 8
is the precision of position determination at DUT, σDU T , expected for 6 GeV electron
beam, as a function of the position resolution in the high-resolution planes, σHR. Results
of the Geant 4 simulation, for 90% of events, i.e. after rejecting 10% of events with the
highest χ2 values (points) are compared with the resolution expected from the analytical
calculations (lines). Standard planes resolution of 2µm and 3µm is considered. Simu-
lation results agree very well with the model expectations if no angular spread of the
incident electron beam is included simulation (ﬁlled points). When the angular spread
of 0.1µm is assumed (open points), precision of position determination obtained from
the simulation worsens by 1–2%. This indicates the level of systematic uncertainty of
the analytical error estimate due to the simplifying assumptions used in the described
method.
Although the method is based on the assumption of the Gaussian position resolution in
each plane, this assumption is not crucial for the reliable error estimates. This is demon-
strated in ﬁgure Figure 9. As before, precision expected from analytical calculation is
compared with results of Geant 4 simulation. However, the position measurement er-
ror in the standard planes is modeled by the uniform distribution, corresponding to the
binary readout option considered for these planes. The error used in analytical calcula-
tions is set to 1
√12 of the distribution width, which is given by the sensor pitch of 6µm
or 16µm.
To verify the description of the energy dependence, the Geant 4 simulation was also

10

STD =   6µm / √12
σ

STD =   16µm / √12
σ

GEANT   90%

perfect alignment

]

m
µ
[

 

σ

1.4
T
U
D

1.2

1

0.8

0.6

1

1.5

2
HR [µm]
σ

Figure 9: Precision of position determination at DUT, for 6 GeV electron beam, as
a function of the position resolution in the high-resolution planes, σHR, for
standard planes with binary readout and pitch of 6µm (blue) and 16µm (red).
Results of the Geant 4 simulation (points) are compared with expectations
from the analytical calculations (lines).

performed for 100 GeV pion beam. Dependence of the expected position uncertainty at
DUT on the incident beam energy is shown in Figure 10. The agreement of analytical
error estimates with the uncertainty calculated from the Geant 4 simulation is very
good.

4 Telescope conﬁguration studies

As demonstrated in the previous section, presented method gives reliable results for
the precision of position measurement at DUT. The position error depends only on the
assumed telescope parameters and can be calculated without any event simulation. This
allows us to make a quantitative comparison between diﬀerent telescope conﬁgurations.
We tried to optimize the telescope setup, by ﬁnding telescope geometry which results
with the best position determination at DUT. For given number and resolutions of
sensor planes, order and distances between planes were varied to ﬁnd minimum of σDU T .
If no constraints are put on plane separation, smallest error is always obtained when all
distances go to zero. Therefor, to obtain realistic results, one has to take into account
constraints which result from the mechanical structure of the telescope.

11

]

m
µ
[

 

T
U
D

σ

2

1.5

1

0.5

1

HR = 1 µm
σ

HR = 2 µm
σ

GEANT   90%

with beam spread

10

2

10
E [GeV]

Figure 10: Precision of position determination at DUT, for position resolution in the
high-resolution planes of 1µm (blue) and 2µm (red), as a function of the inci-
dent beam energy. Results of the Geant 4 simulation (points) are compared
with expectations from the analytical calculations (lines).

4.1 Realistic telescope geometry

Distances between planes are mainly restricted by the mechanical structure of their
support frames. For standard sensor layers the minimum distance between two sensors
is expected to be of the order of 15 mm. It is assumed that the telescope should comprise
at least one high-resolution plane. This plane could be placed as close as 2–5 mm to
DUT. We assume that it will be places in front of DUT2. Minimum distance between
two planes adjacent to DUT is about 20 mm. Figure 11 shown the schematic view
of the telescope with minimum distances between sensor planes indicated. As for the
maximum distance, we assume that two subsequent planes should not be separated by
more than 100 mm.
The choice of optimum telescope conﬁguration was studied for telescope consisting of 4
or 6 sensor planes (and DUT). Moreover, possibility of having one or two high-resolution
sensor planes was considered. General conclusion from all studies is that DUT should
always be placed between two sensor planes, and the distance between these two planes
should be as short as possible.
In most cases, to get the best position measurement
separations between other sensor planes should either be equal to the minimum or to
the maximum allowed distance between them, depending on the energy, sensor and DUT
parameters. High-resolution plane is always the one closest to DUT (we assume that
These observation led to the following scheme for the labeling of telescope conﬁgurations:

2As we do not consider beam energy losses in the telescope planes, same results are obtained if the

order of all planes is reversed.

12

StdRes StdRes

HiRes

DUT

StdRes

StdRes StdRes

min. distance [mm]

15

20

20

20

15

2−5

Figure 11: Schematic view of the realistic conﬁguration for the telescope consisting
of DUT (magenta), one high-resolution sensor plane (blue) and 5 standard
sensor layers (red). Minimum distances between sensor planes are indicated.

• DUT and two sensor planes close to it are always denoted by –,

• any other sensor plane in front of or behind these 3 planes is denoted by N, if

placed at the minimum allowed distance (narrow conﬁguration)

• or by W, if placed at the maximum distance (wide conﬁguration).

All results presented in this section were obtained assuming the thickness of telescope
sensors of 120 µm, both for standard and for high-resolution planes.
If not stated
otherwise, the resolution of standard sensor planes is assumed to be 2 µm. For high-
resolution sensors the default position determinations uncertainty considered is 1 µm.

4.2 Results for 1+3 conﬁguration

This section describes the results obtained for the telescope consisting of one high-
resolution plane (placed in front of DUT) and three standard sensor planes (1+3 conﬁgu-
ration). Figure 12 shows the expected precision of position determination at DUT, σDU T ,
as a function of the position resolution in high-resolution plane, σHR, for diﬀerent tele-
scope geometries, for 6 GeV electron beam. Minimum distance between DUT and high-
resolution plane is set to be 5 mm and the DUT thickness assumed is ∆DU T = 500µm.
For σHR ≥ 1µm the best measurement is obtained in the WN– conﬁguration, i.e. when
two standard and a high-resolution plane are placed in front of DUT and only one plane
behind it. The conﬁguration scheme is shown in Figure 13 (middle plot).
However, this conﬁguration choice is optimal only for the limited range of σHR and ∆DU T ,
and of the beam energy. This is shown in Figure 14, where the best choice of telescope
conﬁguration is shown as a function of the assumed DUT thickness, ∆DU T and the high-
resolution plane measurement precision, σHR, for electron beam energy of 5 GeV. For
very thin DUT, ∆DU T < 150µm, when the eﬀects of multiple scattering are small, the
best measurement precision can be obtained with N–N conﬁguration. On the other

13

]

m
µ
[

 

σ

T
U
D

1.5

dHR = 5. mm

∆

DUT = 500. µm

1

0.5

0

0

Configuration

N-N
W-W
N-W
W-N
-NN
-NW
-WN
-WW
NN-
WN-
NW-
WW-

1

2

HR [µm]
σ

Figure 12: Expected precision of position determination at DUT, σDU T , as a function of
the position resolution in high-resolution plane, σHR, for diﬀerent telescope
conﬁgurations, for 6 GeV electron beam.

W–W

WN–

N–N

Figure 13: Conﬁgurations resulting in the best position measurement at DUT (in dif-
ferent ranges of parameters), for telescope consisting one high-resolution and
three standard sensor planes. High-resolution plane is indicated in blue, stan-
dard planes in red and the DUT in magenta.

14

2

]

m
µ
[

 
 

R
H

σ

1.5

1

1 HR layer + 3 standard layers, dmin = 5 mm

5 GeV

-NW

-WW

W-W

N-W

N-N

WN-

NN-

WW-

0

250

500

750

1000
∆
DUT [µm]

Figure 14: Telescope conﬁguration resulting in the is best position measurement at
DUT, as a function of the assumed DUT thickness, ∆DU T and the high-
resolution plane measurement precision, σHR, for electron beam energy of
5 GeV. Conﬁgurations with one high-resolution and three standard sensor
planes are considered.

hand, for very thick DUT, when multiple scattering gives dominant contribution to the
position uncertainty, and for small σHR values W–W layout turns out to be a preferred
choice (for conﬁguration schemes refer to Figure 13).
The position uncertainty due to multiple scattering depends on the particle energy.
The expected precision of position determination at DUT, σDU T , as a function of the
beam energy, for the three selected telescope conﬁgurations is shown in Figure 15, for
the assumed DUT thicknesses of 800 and 300µm, and the distance between the high-
resolution plane and DUT of 5 mm. W–W layout gives the best precision measurement
at lowest energies, when the eﬀects of multiple scattering are dominant. Large distances
between sensor planes allow for a better estimate of the particle track direction before
and after DUT, resulting in better extrapolation of the position measured in the high-
resolution plane and in the plane behind DUT to the DUT surface. At high energies
inﬂuence of multiple scattering is small and the position error at DUT is dominated
by the position uncertainties in sensor planes.
In this case it is preferable to put all
planes as close to each other as possible, and the N–N conﬁguration should be chosen.
In addition, there is an intermediate energy range (depending on the assumed value
of ∆DU T ) where the WN– conﬁguration results in the best measurement. In the high
energy limit the multiple scattering can be neglected and conﬁgurations W–W and
N–N are expected to give same measurement precision.
If the distance between the high-resolution plane and DUT is reduced to 2 mm, expected
measurement precision improves, as shown in Figure 16. Signiﬁcant improvement is

15

∆DU T = 800µm

10

∆DU T = 300µm

W-W

WN-

N-N

2

10
E [GeV]

W-W

WN-

N-N

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

0.5

1

10

2

10
E [GeV]

Figure 15: Expected precision of position determination at DUT, σDU T , as a function of
the beam energy, for the assumed DUT thicknesses of 800µm (upper plot) and
300µm (lower plot) and the distance between the high-resolution plane and
DUT of 5 mm. Conﬁgurations with one high-resolution and three standard
sensor planes are considered.

16

∆DU T = 800µm

10

∆DU T = 300µm

W-W

WN-

N-N

2

10
E [GeV]

W-W

WN-

N-N

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

0.5

1

10

2

10
E [GeV]

Figure 16: Expected precision of position determination at DUT, σDU T , as a function of
the beam energy, for the assumed DUT thickness of 800µm (upper plot) and
300µm (lower plot) and the distance between the high-resolution plane and
DUT of 2 mm. Conﬁgurations with one high-resolution and three standard
sensor planes are considered.

17

2

]

m
µ
[

 
 

R
H

σ

1.5

1

2 HR layer + 2 standard layers, dmin = 5 mm

6 GeV

-NW

-WW

W-W

N-W

N-N

WN-

NN-

WW-

0

250

500

750

1000
∆
DUT [µm]

Figure 17: Telescope conﬁguration resulting in the is best position measurement at
DUT, as a function of the assumed DUT thickness, ∆DU T and the high-
resolution plane measurement precision, σHR, for electron beam energy of
6 GeV. Conﬁgurations with two high-resolution and two standard sensor
planes are considered.

observed especially at low energies, where large uncertainty is expected from multiple
scattering. Uncertainty in particle direction determination is large, bu smaller distance
reduces the error in extrapolating the position measured in the high-resolution plane to
the DUT surface.

4.3 Results for 2+2 conﬁguration

Analysis presented in the previous section was repeated for the telescope consisting of two
high-resolution planes and two standard sensor planes (2+2 conﬁguration). The optimal
choice of telescope conﬁguration for electron beam energy of 6 GeV, as a function of the
assumed DUT thickness, ∆DU T , and the high-resolution plane measurement precision,
σHR, is shown in Figure 17. For σHR < 1.5µm the high-resolution planes should always
be placed in front of and behind DUT, whereas for large σHR and large ∆DU T (the
parameter range indicated by dashed line in Figure 17) best measurement is obtained
when both planes are put in front of DUT.
Conﬁgurations resulting in the best position measurement, for diﬀerent beam energies
and thicknesses of DUT, assuming high-resolution planes resolution σHR ∼ 1µm are
shown in Figure 18. The expected precision of position determination for these telescope
conﬁguration, as a function of the beam energy, is shown in Figure 19, for the DUT
thicknesses of 800 and 300µm, and the distance between the ﬁrst high-resolution plane
and DUT of 5 mm.

18

W–W

N–W

NN–

N–N

Figure 18: Conﬁgurations resulting in the best position measurement at DUT (in dif-
ferent ranges of parameters), for telescope consisting two high-resolution and
two standard sensor planes. High-resolution planes are indicated in blue,
standard planes in red and the DUT in magenta.

The dependence of the optimal conﬁguration choice of the beam energy is similar to
the case with one high-resolution plane. At lowest energies, when the eﬀects of multiple
scattering are dominant, best measurement is expected with W–W conﬁguration. At
highest energies, when eﬀects of the multiple scattering are small, N–N conﬁguration
should be chosen. Contrary to the case with one high-resolution plane and to conﬁg-
urations optimal at lower energies, in this case DUT should be placed in the middle
between two high-resolution planes.
Including second high-resolution plane signiﬁcantly improves position resolution. For
beam energy of 6 GeV and high-resolution plane resolution σHR ∼ 1µm expected pre-
cision of position determination improves by about 0.1µm. This is shown in Figure 20
where the position resolution σDU T is shown as a function of the assumed DUT thick-
ness, ∆DU T and the high-resolution plane measurement precision, σHR, as obtained in
the conﬁguration optimal for given parameter values. Conﬁgurations with one and two
high-resolution planes are compared. Largest improvement due to second high-resolution
plane is expected at highest energies, when multiple scattering can be neglected and the
precision is determined by the position measurement errors in telescope sensors (compare
Figure 15 and Figure 19).

19

∆DU T = 800µm

10

∆DU T = 300µm

W-W

N-W

N-N sym
NN-

2

10
E [GeV]

W-W

N-W

N-N sym
NN-

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

0.5

1

10

2

10
E [GeV]

Figure 19: Expected precision of position determination at DUT, σDU T , as a function
of the beam energy, for the assumed DUT thicknesses of 800µm (upper plot)
and 300µm (lower plot) and the distance between the ﬁrst high-resolution
plane and DUT of 5 mm. Conﬁgurations with two high-resolution and two
standard sensor planes are considered.

20

1 HR layer + 3 standard layers, dmin = 5 mm

0

250

500

750

1000
∆
DUT [µm]

2 HR layer + 2 standard layers, dmin = 5 mm

2

]

m
µ
[

 
 

R
H

σ

1.5

]

m
µ
[

 
 

R
H

σ

1

2

1

1.5

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

1.5

1.4

1.3

1.2

1.1

1

0.9

0.8

0.7

0.6

0.5

21

0

250

500

750

1000
∆
DUT [µm]

Figure 20: Position resolution at DUT, σDU T , obtained for the optimal conﬁguration
choice, as a function of the assumed DUT thickness, ∆DU T and the high-
resolution plane measurement precision, σHR. Conﬁguration with one high-
resolution and three standard sensor planes (upper plot) and with two high-
resolution and two standard sensor planes (lower plot) are compared.

NW–WN

WN–NW

WNN–N

NN–NN

Figure 21: Conﬁgurations resulting in the best position measurement at DUT (in diﬀer-
ent ranges of parameters), for telescope consisting one high-resolution and ﬁve
standard sensor planes. High-resolution plane is indicated in blue, standard
planes in red and the DUT in magenta.

4.4 Results for 1+5 and 2+4 conﬁgurations

We also considered telescope consisting of 6 sensor planes including one or two high
resolution planes (conﬁgurations referred to as 1+5 and 2+4). Conﬁgurations resulting
in the best position measurement, for diﬀerent beam energies and thicknesses of DUT,
assuming high-resolution planes resolution σHR ∼ 1µm are shown in Figure 21 and
Figure 22 respectively.
The expected precision of position determination for these conﬁgurations, as a function
of the beam energy is shown in Figure 23 and Figure 24. DUT thicknesses of 800 and
300µm is considered and the distance between the (ﬁrst) high-resolution plane and the
DUT is 5 mm.
As for 1+3 and 2+2 conﬁgurations, the best measurement in the low energy range is
expected for the arrangement which provides long ”arms” for precise determination of
particle directions before and after DUT. This is required to minimize the error from
multiple scattering on the position extrapolation from the sensor planes to DUT. For
telescope consisting of six sensor layers it is obtained for the NW–WN conﬁguration.
In the intermediate energy range three to ﬁve sensor planes should be placed close
to DUT. The choice depends on the DUT thickness and diﬀerences between diﬀerent
conﬁgurations are not large. In the high energy domain the situation is again similar to

22

NW–WN

WN–WW

N–NWW

NN–NN

Figure 22: Conﬁgurations resulting in the best position measurement at DUT (in dif-
ferent ranges of parameters), for telescope consisting two high-resolution and
four standard sensor planes. High-resolution planes are indicated in blue,
standard planes in red and the DUT in magenta.

that for the telescope with four sensor planes. As the position error at DUT is dominated
by the position uncertainties in sensor planes it is preferable to put all planes as close to
each other as possible, which is denoted as NN–NN conﬁguration. For the NN–NN
conﬁguration with two high-resolution planes (2+4) DUT should be placed in the middle
between two high-resolution planes, as indicated in Figure 22.

4.5 Comparison of diﬀerent telescope conﬁgurations

It is clear that more telescope planes with better position resolution always result in
better precision for position determination at DUT. However, it is important to under-
stand which factor results in a signiﬁcant improvement of telescope performance and
which gives only a marginal eﬀect.
Comparison of the expected position determination precision for telescope with four
and six sensor planes is shown in Figure 25. Two additional sensor planes improve
position resolution at DUT only for energies above 4 GeV, when more than two planes
should be placed close to DUT. The improvement is largest at the highest energies. For
lowest energies, when ”wide” conﬁgurations are preferred only marginal improvement is
observed between W–W and NW–WN conﬁgurations.
Large improvement, up to about 0.15µm, is expected due to second high-resolution

23

∆DU T = 800µm

NW-WN

WN-NW

NN-NN

WNN-N

NW-WN

WN-NW

NN-NN

WNN-N

10

2

10
E [GeV]

∆DU T = 300µm

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

0.5

1

10

2

10
E [GeV]

Figure 23: Expected precision of position determination at DUT, σDU T , as a function
of the beam energy, for the assumed DUT thicknesses of 800µm (upper plot)
and 300µm (lower plot) and the distance between the high-resolution plane
and DUT of 5 mm. Conﬁgurations with one high-resolution and ﬁve standard
sensor planes are considered.

24

∆DU T = 800µm

NW-WN

WN-WW

NN-NN

NNN-N

NW-WN

WN-WW

NN-NN

NNN-N

10

2

10
E [GeV]

∆DU T = 300µm

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

0.5

1

10

2

10
E [GeV]

Figure 24: Expected precision of position determination at DUT, σDU T , as a function
of the beam energy, for the assumed DUT thicknesses of 800µm (upper plot)
and 300µm (lower plot) and the distance between the ﬁrst high-resolution
plane and DUT of 5 mm. Conﬁgurations with two high-resolution and four
standard sensor planes are considered.

25

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

10

2

10
E [GeV]

NW-WN

WN-NW

WNN-N

NN-NN

W-W

WN-

N-N

NW-WN

WN-WW

N-NWW

NN-NN

W-W

N-W

N-N

2

10
E [GeV]

26

0.5

1

10

Figure 25: Expected precision of position determination at DUT, σDU T , as a function of
the beam energy, for the assumed DUT thicknesses of 500µm and the distance
between the (ﬁrst) high-resolution plane and DUT of 5 mm. Conﬁgurations
with six (solid lines) and four (dashed lines) sensor planes are compared, for
telescope with one (upper plot) or two (lower plot) high-resolution planes.

plane, as shown in Figure 26. Both at the intermediate and at high beam energies
precision obtained with two high-resolution sensors is signiﬁcantly better than with one
high-resolution sensor only. In the intermediate energy range, the eﬀect is stronger for
the larger distance between DUT and ﬁrst high-resolution plane. As before, for lowest
beam energies, below about 2 GeV, improvement due to second high-resolution plane is
marginal. In this energy range the precision is determined by the measurement in the
closest telescope plane.
Show in Figure 27 is a comparison of expected position resolution for diﬀerent distances
between the high-resolution plane and DUT. For lowest beam energies minimizing this
distance is crucial for the precise position determination. By reducing the distance
between ﬁrst high-resolution plane and DUT from 5 to 2 mm the position uncertainty
can be reduced by over 30%. With one high-resolution plane improvement is observed
up to energies of about 20 GeV. For highest beam energies conﬁguration with 2 mm
distance gives results slightly worse than with 5 mm. This is because more symmetric
plane setup is preferred when multiple scattering can be neglected. This is event more
visible for conﬁgurations with two high-resolution planes. For highest energies best
position determination is obtained when DUT is placed in the middle between two high-
resolution planes.
One of the considered solutions for standard telescope sensors are the sensors with binary
readout. Proposed 16µm pitch corresponds to the position resolution of about 5µm (see
also Section 3.3). Expected precision of position determination at DUT, for standard
planes with 2 µm and 5 µm resolution, is compared in Figure 28. For telescope with one
high-resolution plane, resolution of standard planes have large impact on the expected
position reconstruction precision. Eﬀects of up to 30% are expected at high energies.
However, if telescope is equipped with two high-resolution planes, no signiﬁcant loss of
resolution is expected below 5 GeV.

5 Telescope alignment studies

All results presented so far were obtained assuming perfect telescope alignment.
It
could be expected that they remain valid only if the sensor alignment is performed with
precision much better than the single plane resolution. Surprisingly, proposed track
ﬁtting method turned out to be little sensitive to telescope misalignment.
Simulation results described in Section 3 has been used to verify inﬂuence of telescope
alignment on the track ﬁtting. Many ’experiments’ were performed by generating ran-
dom sensor shifts (in the plane perpendicular to the beam direction) according to the
assumed alignment accuracy. For each set of plane positions simulated sensor responses
were reevaluated and track ﬁt was repeated for every Geant 4 event. Longitudinal
position uncertainties should have much smaller eﬀect on the telescope performance and
were not considered. Possible plane rotations were also not considered in the presented
study.
Shown in Figure 29 are the obtained distributions of position reconstruction error at
DUT (the diﬀerence between reconstructed and true particle position), for four diﬀerent

27

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

NW-WN

WN-WW

N-NWW

NN-NN

2

10
E [GeV]

NW-WN

WN-WW

N-NWW

NN-NN

10

28

0.5

1

10

2

10
E [GeV]

Figure 26: Expected precision of position determination at DUT, σDU T , as a function
of the beam energy, for the assumed DUT thicknesses of 500µm and the
distance between the (ﬁrst) high-resolution plane and DUT of 2 mm (upper
plot) and 5 mm (lower plot). Conﬁgurations with two (solid lines) and one
(dashed lines) high-resolution planes are compared, for telescope consisting
of six sensor planes.

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

NW-WN

WN-WW

N-NWW

NN-NN

2

10
E [GeV]

NW-WN

WN-WW

N-NWW

NN-NN

10

29

0.5

1

10

2

10
E [GeV]

Figure 27: Expected precision of position determination at DUT, σDU T , as a function of
the beam energy, for the assumed DUT thicknesses of 500µm. Conﬁgurations
with the assumed distance between the (ﬁrst) high-resolution plane and DUT
of 2 mm (solid line) and 5 mm (dashed line) are compared, for telescope
consisting of six sensor planes including one (upper plot) or two (lower plot)
high-resolution planes.

]

m
µ
[

 

T
U
D

σ

1.5

0.5

1

]

m
µ
[

 

T
U
D

σ

1.5

1

1

NW-WN

WN-WW

N-NWW

NN-NN

2

10
E [GeV]

NW-WN

WN-WW

N-NWW

NN-NN

10

30

0.5

1

10

2

10
E [GeV]

Figure 28: Expected precision of position determination at DUT, σDU T , as a function of
the beam energy, for the assumed DUT thicknesses of 500µm. Conﬁgurations
with the assumed standard plane position resolution of 2 µm (solid line)
and 5 µm (dashed line) are compared, for telescope consisting of six sensor
planes including one (upper plot) or two (lower plot) high-resolution planes.
Distance between the (ﬁrst) high-resolution plane and DUT is 5 mm.

al = 4 µm
σ

N
1000

750

500

250

0

-10

-5

0

5
10
yfit - ygen [µm]

Figure 29: Diﬀerence between reconstructed and true particle position at DUT, for
6 GeV electron beam. Open histograms show simulation results for four ex-
periments with the assumed alignment uncertainty of 4µm. For comparison,
results obtained assuming perfect telescope alignment are shown as a ﬁlled
histogram.

sets of telescope plane positions generated assuming alignment uncertainty of 3µm. For
comparison, results obtained assuming perfect telescope alignment are also shown. The
telescope misalignment results only in the systematic shift in the position determined
at DUT. This shift is equivalent to the shift in DUT position. The width of the distri-
bution, which determines the precision of the measurement is unchanged. This follows
from the equation (3). Reconstructed position at DUT is given by a linear combination
of positions measured in telescope layers, with coeﬃcients (elements of matrix S) de-
pending on the telescope geometry and position resolutions in single planes. Therefor,
any constant shift in measured position results in a constant shift in the reconstructed
position at DUT.
Although the telescope resolution is not directly aﬀected, alignment uncertainties do
inﬂuence the track reconstruction. This is because plane misalignment results in large
χ2 values, not related to the actual measurement. This is illustrated in Figure 30,
where χ2 distributions for simulated Geant 4 events are shown for four experiments
with the assumed alignment uncertainty of 4µm. For comparison, results obtained
assuming perfect telescope alignment are also shown.
In two of this experiments no
event would pass the χ2 < 20 cut which was imposed to select well ﬁtted events when
perfect alignment was assumed (see Section 3). We have to conclude that with large
alignment uncertainties χ2 cut can no longer be used to remove poorly reconstructed
tracks. Therefor, eﬀective telescope resolution can deteriorate slightly. It will also be
much more diﬃcult to match hits to the track, if multiple hits are reconstructed in

31

al = 4 µm
σ

N

10 3

10 2

10

1

10

2

10

3

10

χ2

Figure 30: χ2 distribution for simulated Geant 4 events, for 6 GeV electron beam.
Open histograms show results for four experiments with the assumed align-
ment uncertainty of 4µm. For comparison, results obtained assuming perfect
telescope alignment are shown as a ﬁlled histogram.

single telescope layer. In order to be able to use χ2 as a measure of track quality we
should reduce alignment error to the level comparable with position resolution in single
telescope planes i.e. few µm.
Precise telescope alignment, taking into account not only transverse but also longitudinal
sensor shifts and rotations, requires dedicated analysis of collected data. However, based
on the described track ﬁtting algorithm we can propose a very simple method, which
can be used to verify the transverse plane alignment with adequate accuracy.
The expected beam spot size is too large to allow for precise plane positioning. Also the
beam direction can not be used as a constraint, due to angular spread of incident beam
and multiple scattering in subsequent planes (especially at low energies). Therefor only
relative plane positioning is possible. We have to choose two planes and use them as the
reference for aligning the remaining sensors.
For telescope consisting of seven planes (DUT and six sensors) the best choice is to use
second and the last but one plane as a reference. Only for the highest beam energies,
when the multiple scattering can be neglected, selecting ﬁrst and last plane gives slightly
better results. Results of multiple Geant 4 simulations with the assumed 10 µm align-
ment uncertainty are shown in Figure 32. For each experiment, diﬀerence between the
particle position measured in the third telescope plane and the expected position (from
the ﬁt to the second and last but one plane) has an approximately Gaussian distribu-
tion with a width of about 3.6µm. From this distribution position of the plane can be
established with accuracy of the order of 0.1µm already with about 1000 reconstructed
particle tracks.

32

g
o

l

>
2
χ
<

10 4

10 3

10 2

10

N

2000

1000

1

10

al [µm]
σ

Figure 31: χ2 value corresponding to the value of log χ2 averaged over many Monte
Carlo experiments, as a function of the assumed alignment uncertainty, σal.
Band width corresponds to the RMS of log χ2 distribution.

0

-50

-25

0

25
ymeas - yexp [µm]

50

Figure 32: Diﬀerence between particle position measured in the 3rd telescope plane and
the expected position, as obtained from the ﬁt to the second and the last but
one plane, for 6 GeV electron beam. Open histograms show simulation results
for four experiments with the assumed alignment uncertainty of 10µm. For
comparison, results obtained assuming perfect telescope alignment are shown
as a ﬁlled histogram.

33

Shown in Figure 33 is the expected precision of particle position determination from the
considered ﬁt to two planes, as a function of beam energy. Two telescope conﬁgurations
are considered, corresponding to smallest (NN-NN) and largest (WN-WW) ﬁt errors.
Even for wide telescope conﬁguration and low beam energies, plane alignment with
accuracy of the order of 1µm should be possible with reasonable event statistics. It is
clear that the alignment procedure gives best results for highest beam energy available.

6 Conclusion

The main aim of the presented study was to understand the position measurement in the
EUDET pixel telescope and suggest the optimum telescope plane setup, resulting in the
best position measurement. Analytical method for particle track ﬁtting with multiple
scattering has been developed and veriﬁed using Geant 4 simulation. The method
gives qualitative improvement as compared to straight line ﬁts, and allows to use all
collected events in the analysis analysis. The approach allows for analytical calculation
of the expected measurement uncertainty, so the telescope performance could be studied
in detail without time-consuming MC simulation.
Telescope performance was studied for setups consisting of four or six readout planes,
including one or two high-resolution sensors. For each setup considered, diﬀerent tele-
scope conﬁgurations (corresponding to diﬀerent distances between planes or diﬀerent
plane order) has been compared. It turned out that the optimum plane conﬁguration is
not uniquely deﬁned and depends not only on the telescope parameters but also on the
beam energy and the assumed DUT thickness. However, diﬀerences between conﬁgu-
rations optimal at diﬀerent parameter ranges are not large. If one conﬁguration has to
be chosen, conﬁguration with wide telescope “arms” (W–W or NW–WN) should be
used, as it gives much larger gain in resolution at low energies than the loss at higher
energies (as compared to other conﬁgurations).
It was also conﬁrmed that with appropriate track ﬁtting method conﬁguration with 6
sensor planes always give better position resolution than 4 planes, but the diﬀerence is
signiﬁcant only at high energies.
One of the important advantages of the analytical track ﬁtting method is that it is
hardly sensitive to telescope misalignment. Transverse displacements of telescope sensors
result only in the systematic shift in the reconstructed particle position at DUT, but the
position resolution remains unchanged. Therefor, possible small telescope misalignment
aﬀects only the track quality estimate based on χ2 calculation. For proper selection of
good tracks plane alignment with accuracy of few µm is suﬃcient. This can be achieved
with a simple procedure of relative plane alignment, based on track ﬁtting to two selected
planes.

34

]

m
µ
[

 

t
n

i

σ

NNNN

1st plane

3rd plane

DUT

5th plane

7th plane

1st plane

3rd plane

DUT

5th plane

7th plane

10

E [GeV]

WNWW

0

1

]

m
µ
[

 

t
n

i

σ

40

20

40

20

0

1

10

E [GeV]

Figure 33: Expected precision of particle position determination from line ﬁt to mea-
surements in the second and the last but one telescope planes as a function
of beam energy, for the assumed DUT thicknesses of 500µm. Position deter-
mination in remaining telescope planes as well as in DUT are considered for
NN-NN (upper plot) and WN-WW (lower plot) conﬁgurations.

35

Acknowledgement

This work is partially supported by the Polish Ministry of Science and Higher Education,
project number EUDET/217/2006 (2006-2009) and by the Commission of the European
Communities under the 6th Framework Programme ”Structuring the European Research
Area”, contract number RII3-026126.

References

[1] More

information

about

the

project

can

be

found

at

the URL

http://www.eudet.org/

[2] More information on the framework programmes of the European Union can be

found at the URL http://cordis.europa.eu/

[3] T. Haas, Nucl.Instrum.Meth.A569:53,2006.

[4] V.L. Highland, Nucl. Instrum. Methods 129:497, 1975, and Nucl. Instrum. Methods
161:171, 1979; G.R. Lynch and O.I Dahl, Nucl. Instrum. Methods B58:6, 1991.

[5] G. Lutz, Nucl.Instrum.Meth.A273:349,1988.

[6] W.Dulinski, private communication.

36

