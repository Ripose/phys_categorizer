5
0
0
2
 
b
e
F
 
5
2
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
3
4
1
2
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Leeson Eﬀect
—
Phase Noise in Quasilinear Oscillators

Enrico Rubiola

Universit´e Henri Poincar´e, Nancy, France
esstin and lpmia

web page www.rubiola.org
e-mail enrico@rubiola.org

Rev. 1.0, February 23, 2005

Contents

Most used symbols

0 Preface

1 Heuristic approach to the Leeson eﬀect

1.3.1 Delay-line oscillator

1.1 Phase noise fundamentals . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . .
1.2 Oscillator fundamentals
1.2.1 Pulling the oscillator frequency . . . . . . . . . . . .
1.3 The Leeson formula . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . .
1.4 Ampliﬁer noise . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.1 Additive white noise . . . . . . . . . . . . . . . . . .
1.4.2 Flicker noise
. . . . . . . . . . . . . . . . . . . . . .
1.4.3 Other noise types . . . . . . . . . . . . . . . . . . . .
1.4.4 Phase noise spectrum . . . . . . . . . . . . . . . . .
1.4.5 Noise-corrected ampliﬁers . . . . . . . . . . . . . . .
1.5 The phase noise spectrum of real oscillators . . . . . . . . .
. . . . . . . . . . .
. . . . . . . . . . . .

1.5.1 The eﬀect of the resonator noise
1.5.2 The eﬀect of the output buﬀer

2 Oscillator hacking

2.1 Miteq DRO mod. D-210B . . . . . . . . . . . . . . . . . . .
2.2 Poseidon DRO-10.4-FR (10.4 GHz) . . . . . . . . . . . . . .
2.3 Poseidon Shoebox (10 GHz sapphire resonator) . . . . . . .

iii

v

1

3
3
7
10
12
16
17
17
18
20
21
21
22
23
24

27
30
32
35

iv

E. Rubiola The Leeson eﬀect

February 2, 2008

2.4 Oscilloquartz OCXO 8600 (5 MHz AT-cut BVA) . . . . . .
. . . . . .
2.5 FEMTO-ST prototype (10 MHz LD-cut quartz)
2.6 Wenzel 501-04623 (100 MHz SC-cut quartz) . . . . . . . . .
2.7 Oewaves Tidalwave (10 GHz OEO) . . . . . . . . . . . . . .

3 Phase noise and linear feedback theory

3.1 Oscillator and Laplace transforms . . . . . . . . . . . . . . .
3.2 Resonator in the phase space . . . . . . . . . . . . . . . . .
Input signal tuned at the exact natural frequency . .
3.2.1
3.2.2 Detuned input signal . . . . . . . . . . . . . . . . . .
3.3 Another derivation of the resonator phase response . . . . .
3.4 Phase noise in the oscillator loop . . . . . . . . . . . . . . .
Formal derivation of the Leeson formula . . . . . . . . . . . . . .
3.4.1 Pulling the oscillator frequency . . . . . . . . . . . .
. . .

3.5 Spectrum of frequency ﬂuctuation and Allan variance

39
43
46
48

53
54
58
59
61
68
71
72
76
77

4 Noise in the delay-line oscillator

79
79
4.1 Basic delay-line oscillator
. . . . . . . . . . . . . . . . . . .
83
4.2 Mode selection . . . . . . . . . . . . . . . . . . . . . . . . .
85
4.2.1 Amplitude-only ﬁlter . . . . . . . . . . . . . . . . . .
85
. . . . . . . . . . . . . . . . . . . .
4.2.2 Phase-only ﬁlter
87
4.3 The use of a resonator as the selector ﬁlter
. . . . . . . . .
92
4.4 Phase response . . . . . . . . . . . . . . . . . . . . . . . . .
96
. . . . . . . . . .
4.5 Close-in noise spectra and Allan variance
4.6 Examples
97
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.7 Phase noise in lasers . . . . . . . . . . . . . . . . . . . . . . 101
4.8 Saturation and multimode oscillation . . . . . . . . . . . . . 103

A Resonator model and parameters

105
A.1 Laplace plane . . . . . . . . . . . . . . . . . . . . . . . . . . 105
A.2 Frequency domain . . . . . . . . . . . . . . . . . . . . . . . 106
A.3 Time domain . . . . . . . . . . . . . . . . . . . . . . . . . . 107

References

107

Most used symbols

bi

b(t)
f
fc
fL
h(t)
hi

j
k
m
n
n(t)
v(t)
x
x(t)
y(t)
A
B(s)

D
F
H(s)
(s)

H

1

−

coeﬃcients of the power-law approximation of Sϕ(f ),
Eq. (1.5), Fig. 1.1
resonator phase response
Fourier frequency, Hz
ampliﬁer corner frequency, Hz, Fig. 1.13
Leeson frequency, Hz, Eq. (1.28)
impulse response
coeﬃcients of the power-law approximation of Sy(f ),
Eq. (1.10), Fig. 1.1
imaginary unit, j2 =
Boltzmann constant, k = 1.38
harmonic order (Chapter 4)
harmonic order (Chapter 4)
random noise, as a function of time
voltage, as a function of time
a generic variable
phase time ﬂuctuation, Eq. (1.6)
fractional frequency ﬂuctuation, Eq. (1.7)
ampliﬁer voltage gain
resonator phase response, B(s) =
denominator of a transfer function
ampliﬁer noise ﬁgure, Eq. (1.35)
transfer function, Eq. (3.1)
phase transfer function

b(t)
}

23 J/K

L{

10

×

−

v

vi

E. Rubiola The Leeson eﬀect

February 2, 2008

·

R

δ(t′) dt′

single-sideband noise spectrum, Eq. (1.4), dBc/Hz
Laplace transform operator
noise spectrum density, esp. RF/microwave, W/Hz
power, W, esp. carrier power
resonator merit factor

(f )
L
)
(
L
N
P
Q
Sa(f ), Sa(ω) power spectral density of the quantity a
T
U (t)
V
V (s)
α(t)
β(s)
δ(t)
θ
µ
ν
ρ
σ
σy(τ )

period, T = 1/ν, s; also, absolute temperature
Heaviside (step) function, U (t) =
either dc voltage (constant) or phasor
Laplace transform of v(t)
(normalized) amplitude noise, Eq. (1.1)
transfer function of the feedback path, Fig. 3.1
Dirac delta function
argument of the resonator transfer function ρejθ
harmonic order in the phase space, (Chapter 4)
frequency (Hz), used for carriers, Eq. (1.1)
modulus of the resonator transfer function ρejθ
real part of the complex variable s = σ + jω
Allan deviation, square root of the Allan variance σ2
(used only with the fractional frequency ﬂuctuation y
measurement time, in σ(τ )
resonator relaxation time, or delay of a delay line
phase noise, Eq. (1.1)
dissonance, Eq. (A.6)
ampliﬁer phase noise; also, a constant phase
angular frequency (both carrier and Fourier)
phase noise, Φ(s) =
ϕ(t)
}
ampliﬁer phase noise, Ψ(s) =
detuning angular frequency

τ
τ
ϕ(t)
χ
ψ(t)
ω
Φ(t)
Ψ(t)
Ω
Note: ω is used as a shorthand for 2πf or 2πf , and viceversa

ψ(t)
}

L{

L{

y(τ )

Chapter 0

Preface

Time, and equivalently frequency, is the most precisely measured physical
quantity. It is therefore inevitable that virtually all domains of engineering
and physics need reference oscillators. The oscillator noise can be decom-
posed into amplitude noise and phase noise. The latter, far more important,
aﬀects timing, for it is related to precision and accuracy of measurements.
The oscillator, inherently, turns the phase noise of the internal parts
into frequency noise. This is a necessary consequence of the Barkhausen
condition, which states that the loop gain must be of one, with zero phase,
for stationary oscillation. There follows that oscillator phase noise, which
is the integral of the frequency noise, diverges in the long run. This phe-
nomenon is often referred to as the “Leeson model” after a short article
published in 1966 by David B. Leeson [Lee66], and called Leeson eﬀect
here, in order to emphasize that it is far more general than model. In 2001,
David B. Leeson received the W. G. Cady award of the IEEE International
Frequency Control Symposium “For clear physical insight and model of the
eﬀects of noise on oscillators”.

Since spring 2004, I had the opportunity to give some seminars on noise
in oscillators at the Jet Propulsion Laboratory, at the IEEE Frequency
Control Symposium, at the FEMTO-ST Laboratory, and at the Universit´e
Henri Poincar´e. These seminars had the purpose to provide a tutorial, as
opposed to a report on advanced science, addressed to a variety of people

1

2

E. Rubiola The Leeson eﬀect

February 2, 2008

including technicians, PhD students, and senior scientists. This monograph
derives from these seminars, and from numerous discussions with colleagues.
The topics covered can be divided into three parts. Chapter 1 addresses
language and general physical mechanisms. Chapter 2 aims at understand-
ing the inside of commercial oscillators through the analysis of the speci-
ﬁcations. Chapter 3 and 4 focus on the use of the Laplace transform to
describe the oscillator and its phase noise.

Nancy, Feb 23, 2005

Enrico Rubiola

Chapter 1

Heuristic approach to the Leeson eﬀect

1.1 Phase noise fundamentals

This introductory section provides a summary about phase noise and of
its properties. The material is available in many classical references, such
[Rut78, CCI90, VA89, Vig99].

The quasi-perfect sinusoidal signal of oscillators is modeled as

v(t) = V0[1 + α(t)] cos[2πν0t + ϕ(t)] ,

(1.1)

where ν0 is the carrier frequency; the random variables α(t) and ϕ(t) are the
fractional amplitude noise and the phase noise, respectively. The physical
dimension of ϕ(t) is rad, α(t) is dimensionless.

It is sometimes convenient to rewrite the signal (1.1) in the equivalent

Cartesian form

v(t) = V0 cos(2πν0t) + vc(t) cos(2πν0t)

vs(t) cos(2πν0t) .

(1.2)

α
In low noise conditions (
|

1 and

ϕ
|

| ≪

| ≪
vc(t)
V0

−
1), it holds that

vs(t)
V0

.

α(t) =

and

ϕ(t) =

(1.3)

In the absence of noise, the spectrum of v(t) is a Dirac V 2
ν0)
0
function. Noise broadens the spectrum. Most of the art of measuring the

1
2 δ(ν

−

3

4

E. Rubiola The Leeson eﬀect

February 2, 2008

oscillator noise is related to the ability to measure extremely narrow-band
signals, for the radiofrequency spectrum turns out to be a poor tool. The
oscillator noise is better described in terms of the power spectrum density
S(f ) of the amplitude and phase noise, thus Sα(f ) and Sϕ(f ), as a function
of the Fourier frequency f . Only phase noise is analyzed here. Nonetheless,
one should be aware that the eﬀect of amplitude noise may not be negligible,
and that the resonant frequency of some resonators may be aﬀected by the
amplitude.

The physical unit of Sϕ(f ) is rad2/Hz. Phase noise spectra are (almost)
always plotted on a log-log scale. The technical unit “decibel”, SdB =
10 log10(S), is commonly used. Manufacturers prefer the quantity
(f )
(pronounce ‘script-ell’) to Sϕ(f ).
In physics and mathematics Sϕ(f ) is
preferred.

(f ) and Sϕ(f ) are equivalent since

(f ) is now1 deﬁned as

L

L

(f ) is always given in dBc/Hz, which stands for dB below the carrier in
(f ) = Sϕ(f )

L
1-Hz bandwidth. In decibels,

3 dB.

A model that has been found useful in describing the oscillator noise

−

spectra is the power-law

L

(f ) =

Sϕ(f ) .

1
2

L

L

Sϕ(f ) =

bif i .

−4

Xi=0

(1.4)

(1.5)

Table 1.1 shows the phase noise terms of (1.5). If needed, the sum (1.5)
may be extended adding additional negative terms.

Two other quantities are often used to characterize the oscillator noise,

x(t) =

y(t) =

ϕ(t)
2πν0
˙ϕ(t)
2πν0

phase time

(1.6)

fractional frequency ﬂuctuation .

(1.7)

1Formerly, L(f ) was deﬁned as the single-sideband noise power in 1 Hz bandwidth
divided by the carrier power. This deﬁnition has been superseded by (1.4) because it was
ambiguous when amplitude noise and phase noise have not the same spectrum.

February 2, 2008

E. Rubiola The Leeson eﬀect

5

Table 1.1: Noise types, power spectral densities, and Allan variance.

noise type

white ϕ

ﬂicker ϕ

white f

ﬂicker f

rand. walk f

h1f

Sϕ(f )

Sy(f )
h2f 2

Sϕ ↔
Sy
h2 = b0
b0
ν2
0
h1 = b−1
b−1f −1
ν2
0
h0 = b−2
b−2f −2
h0
ν2
0
b−3f −3 h−1f −1 h−1 = b−3
ν2
0
b−4f −4 h−2f −2 h−2 = b−4
ν2
0

∝

σ2
y(τ )
τ −2
τ −2
∝
1
2 h0τ −1
2 ln(2) h−1

4π2
6 h−2τ

mod σ2

y(τ )

∝

τ −3
τ −2
∝
1
4 h0τ −1
27
20 ln(2) h−1
4π2
6 h−2τ

The phase time (ﬂuctuation) x(t) is the phase ﬂuctuation ϕ(t) converted
into time, and measured in seconds. The fractional frequency ﬂuctuation
y(t) is the instantaneous frequency ﬂuctuation normalized to the nominal
carrier frequency ν0. y(t) is dimensionless. The power spectral densities
are

Sx(f ) =

Sϕ(f )

Sy(f ) =

Sϕ(f ) .

1
ν2
0
f 2
ν2
0

(1.8)

(1.9)

Sy(f ) [Eq.(1.9)] is obtained from the deﬁnition (1.7) using the property
that the time-domain derivative maps into a multiplication by jω = j2πf
in the Fourier transform domain, thus by ω2 = 4π2f 2 in the spectrum.

The power-law model applies to Sx(f ) and Sy(f ). The coeﬃcients of

Sy(f ) are denoted by hi in the literature, hence

Sy(f ) =

hif i .

(1.10)

−2

Xi=2

Table 1.1 helps in conversions between Sϕ(f ) and Sy(f ).

6

E. Rubiola The Leeson eﬀect

February 2, 2008

)
f
(
ϕ
S

r. w. freq.
f−4
b−4

f−3
b−3
flicker freq.

white freq.
f−2
b−2

x

f2/

2ν
0

flicker phase.

b−1

f−1

white phase

b0

f

h−2

f−2

h2f2

white phase

r. w. freq.

h−1

f−1

h0

h1f

flicker freq.

flicker phase

white freq.

)
f
(

y
S

)
τ
(
y2
σ

f

τ

freq.
drift

w
a
l
-
r
e
w
o
p
-
e
l

flicker phase
white phase

white freq.

flicker freq.

r. w. freq.

Figure 1.1: Power-law, spectra, and Allan variance.

Another tool often used in the oscillator characterization is the Allan
variance σ2
y(τ ), as a function of the measurement time τ . The Allan vari-
ance is always estimated by averaging. Given a stream of M data y, each
representing a measure of the quantity y(t) averaged over a duration τ

February 2, 2008

E. Rubiola The Leeson eﬀect

7

0V

+

Σ
+

in

A

out

out

resonator
β

in

oscillator
output

ω = ω0

/ω = ω0

a period is reproduced
after a round trip

each round−trip attenuates
the signal

n
e
s
u
a
h
k
r
a
b
-
e
l

|Αβ|

ω
0

arg(Αβ)

1

ω

ω

Figure 1.2: Basic feedback oscillator.

ending at the time t = kτ , the estimated Allan variance is

σ2
y(τ ) =

1
2(M

M −1

1)

−

Xk=1

(cid:0)

yk+1 −

yk

2 .

(cid:1)

(1.11)

Table 1.1 provides some conversion formulae to calculate σ2
y(τ ) from Sy(f ).
It is important to understand that σ2
y(τ ) can always be calculated from
Sy(f ), but the inverse is not free from errors [Gre98] in the general case.
The modiﬁed Allan variance, not analyzed here, is also commonly used.
Figure 1.1 provides a summary of the power-law spectra and Allan variance.

1.2 Oscillator fundamentals

The basic feedback oscillator (Fig. 1.2) is a loop in which the gain A of the
sustaining ampliﬁer compensates for the loss [gain β(ω) in the ﬁgure] of the
resonator at a given angular frequency frequency ω0. The condition for the
oscillation to be stationary, known as the Barkhausen condition, is

Aβ(ω) = 1

= 1

Aβ(ω)
|
|
arg[Aβ(ω)] = 0

Barkhausen

(1.12)

(1.13)

(1.14)

at ω = ω0.

E. Rubiola The Leeson eﬀect

February 2, 2008

amplifier

resonator

amplifier

resonator

R<0

I=GmV

I

V

8

l
a
t
x
-
e
l

Figure 1.3: Negative-resistance oscillator.

The unused input (0 V) in Fig. 1.2 serves to set the initial condition

that triggers the oscillation, and to introduce noise in the loop.

It is often convenient use a constant-gain ampliﬁer (A is independent of
frequency), and a bandpass ﬁlter as β = β(ω) in the feedback path. Some
small frequency dependence of the ampliﬁer gain, which is always present
in real-world ampliﬁer, can be moved from A to β = β(ω). The function
β(ω), still unspeciﬁed, is described graphically in Fig. 1.2.

The model of Fig. 1.2 is general.

It applies to a variety of systems,
electrical, mechanical, and others. A little eﬀort may be necessary to iden-
tify A and β. If for example the resonator is a two-port microwave cavity
connected to an ampliﬁer in closed loop, matching it to Fig. 1.2 is trivial.
A less trivial example is the negative-resistance oscillator shown in Fig. 1.3.
The feedback function β(ω) is the resonator impedance Z(ω) = V (ω)
I(ω) , thus
I(ω) is the input and V (ω) the output. The resonator impedance is a com-
plex function of frequency that takes a real value (a resistance) at ω = ω0.
A negative conductance G plays the role of the ampliﬁer. We match the
oscillator of Fig. 1.3 to the general scheme (Fig. 1.2) by observing that the
controlled current generator is a transimpedance ampliﬁer that senses the
voltage V across the resonator and delivers a current I = GmV . The game
of signs deserves some attention. The condition
= 1 requires that
Gm > 0. The sign of the current can follow two conventions, in a generator
the current is positive when it exits, in a load the the current is positive
when it enters. Interpreting the controlled generator as a resistor, the sign
of the current is to be changed. Thus Gm =

Aβ
|

G.

|

Oscillation starts from noise or from the switch-on transient.

In the

−

February 2, 2008

E. Rubiola The Leeson eﬀect

9

out

|Αβ|

small signal

large signal

+

Σ
+

A

β

tuning range

arg

(Αβ)

1

ω

ω

Figure 1.4: Starting the oscillator.

ω0

l
a
e
r
-
n
e
s
u
a
h
k
r
a
b
-
e
l

Aβ(ω)
|
|

spectrum of such random signal, only a small energy is initially contained
at ω0. For the oscillation to grow up to a desired amplitude, it is necessary
> 1 at ω = ω0 for small signals (Fig. 1.4). In such condition,
that
oscillation at the frequency ω0 that derives from arg[Aβ(ω)] = 0 rises ex-
ponentially. As the oscillation amplitude approaches the desired value, an
amplitude control (not shown Fig. 1.4) reduces the loop gain, so that the
loop reaches the stationary condition Aβ(ω) = 1. The amplitude can be
stabilized by an external AGC (automatic gain control), or by the large-
signal saturation of the ampliﬁer. Figure 1.5 shows the eﬀect of saturation.
When the input amplitude exceeds the saturation level, the output signal is
clipped. Further increasing the input level, the gain decreases at the funda-
mental frequency ω0, and the excess power is squeezed into the harmonics
at frequencies multiple of ω0.

In summary, it is important to understand that in real-world oscillators

1. it is necessary that

> 1 for small signals,

Aβ(ω)
|
|
Aβ(ω)
|
|

2. the condition

= 1 results from large-signal gain saturation,

3. the oscillation frequency is determined only by the phase condition

arg[Aβ(ω)] = 0.

10

E. Rubiola The Leeson eﬀect

February 2, 2008

v(t)

clipping

S( ω)

excess power goes
to higher frequencies

g
n
i
p
p
i
l
c
-
e
l

t

ω0

3ω

0

5ω

0

7ω

0

ω

Figure 1.5: Time-domain clipping results in power squeezed to higher har-
monics. In the example shown clipping is almost symmetric, for the odd
harmonics are privileged, but the even harmonics are still present.

If a static phase ψ is inserted in the loop (Fig. 1.6 right), the Barkhausen
phase condition becomes arg β(ω) + ψ = 0. Hence the loop oscillates at the
frequency

ω0 + ∆ω

at which

arg β(ω) =

ψ .

(1.15)

−

The eﬀect of ψ on the oscillation frequency is obtained by inverting Eq. 1.15.
Within the accuracy of linearization, it holds that

∆ω =

ψ
d
dω arg β(ω)

.

−

(1.16)

If the resonator is a simple circuit governed by a second-order diﬀerential
equation with low damping factor (i.e., large merit factor Q), in the vicinity
of the resonant frequency ω0 it holds that d

. Thus

dω arg β(ω) =
∆ω
ω0 ≪

−
1
2Q

2Q
ω0

.

resonator, for

(1.17)

∆ω
ω0

=

∆ν
ν0

=

ψ
2Q

For reference, ψ > 0 means that the loop leads in the time domain, conse-
quently the oscillator is pulled to a frequency higher than the exact reso-
nance.

1.2.1 Pulling the oscillator frequency

There exist (at least) two ways to tune an oscillator to the desired frequency.

February 2, 2008

E. Rubiola The Leeson eﬀect

11

static phase
e jψ

A

out

+

Σ
+

β

g
n
i
n
u
t
-
e
l

small signal

|Αβ|

large signal

|Αβ|=1

1

ω

ω

arg

(Αβ)

tuning range

arg

(Αβ)+ψ=0

−ψ

oscillation

ω0
0+∆ω
ω

Figure 1.6: Tuning the oscillation frequency by insertion of a static phase.

Introduce a static phase shift in the loop The ﬁrst method consists
of introducing a static phase lead or lag ψ in the loop, as in Fig. 1.6.
Oscillation is ruled by the Barkhausen condition (1.12), with saturated
amplitude. Therefore, the oscillator tuning range the frequency range in
which

Aβ(ω)
|
|

> 1

(small signal) .

(1.18)

In this region, the gain can be reduced by saturation and the phase de-
termines the oscillation frequency. Out of this range, the response to a
perturbation decays exponentially, hence no oscillation is possible. This
method is used in microwave oscillators, where a phase shifter is used to
set the static phase ψ.

Change the natural frequency of the resonator The second method
consists of pulling the natural frequency of the resonator by modifying the
parameters of the resonator diﬀerential equation. The adjustment circuit
is no longer distinct from the resonator, and there is no reason to introduce
the static phase ψ. This method is often used in quartz oscillators, where a

12

E. Rubiola The Leeson eﬀect

February 2, 2008

quartz resonator
equivalent

electrode
capacitance

C0

Rs

Cs

Ls

motional parameters

g
n
i
n
u
t
-
l
a
t
x
-
e
l

Figure 1.7: Typical tuning scheme for quartz oscillators.

external
frequency adjustment

variable capacitor is used to alter on the resonator natural frequency (Fig.
1.7).

The eﬀect on phase noise Analyzing noise, the two methods are quite
diﬀerent. The static phase ψ, inherently, increases the noise bandwidth of
the resonator. Conversely, the reactance used to pull the natural frequency
of the resonator has not such intrinsic eﬀect. Nonetheless, in practice the
resonator noise bandwidth still increases because the additional loss intro-
duced by the external reactance reduces the merit factor. More details are
given in Section 3.4.1.

1.3 The Leeson formula

Let us consider an oscillator in which the feedback circuit β is an ideal
resonator, free from frequency ﬂuctuations, with a large2 merit factor Q.
The resonator relaxation time is

τ =

T0 =

Q
π

Q
πν0

=

2Q
ω0

(1.19)

Let us then replace the static phase ψ of Eq. (1.16) with a random phase
ﬂuctuation ψ(t) (Fig. 1.6) that accounts for all the phase noise sources in

2Strictly, only Q ≫ 1 is necessary.

February 2, 2008

E. Rubiola The Leeson eﬀect

13

c
i
t
s
i
r
u
e
h
-
e
l

and

random phase
e jψ

A

Σ+
+

out

β

Figure 1.8: The phase noise of the ampliﬁer and of all other components of
the loop is modeled as a random phase ψ at the input of the ampliﬁer.

the loop. There follows an oscillator output signal of the form

v(t) = V0 cos[ω0t + ϕ(t)] ,

(1.20)

where ϕ(t) is the eﬀect of ψ(t). We analyze the mechanism with which the
power spectrum density of ψ is transferred into ϕ.

For the slow components of ψ(t), slower than the inverse of the relax-

ation time, ψ can be treated as quasi-static perturbation. Hence

∆ν =

ψ(t)

ν0
2Q

(1.21)

S∆ν(f ) =

Sψ(f ) .

(1.22)

The instantaneous output phase is

ϕ(t) = 2π

(∆ν) dt .

(1.23)

The time-domain integration maps into a multiplication by 1
transform domain, thus into a multiplication by
Consequently, the oscillator spectrum density is

jω in the Fourier
(2πf )2 in the spectrum.

1

Sϕ(f ) =

Sψ(f ) .

(1.24)

2

ν0
2Q

(cid:18)

(cid:19)

Z

2

1
f 2

ν0
2Q

(cid:18)

(cid:19)

14

E. Rubiola The Leeson eﬀect

February 2, 2008

For the fast ﬂuctuations of ψ, faster than the inverse of the relaxation
time, the resonator is ﬂywheel that steers the signal. Loosely speaking,
it is open circuit for the phase ﬂuctuation. The ﬂuctuation ψ(t) crosses
the ampliﬁer and shows up at the output, without being fed back at the
ampliﬁer input. No noise regeneration takes place in this conditions, thus
ϕ(t) = ψ(t), and

Sϕ(f ) = Sψ(f ) .

(1.25)

Under the assumption that there is no correlation between fast and slow
ﬂuctuations, we can add the eﬀects stated by Equations (1.24) and (1.25)

Sϕ(f ) =

1 +

"

2

1
f 2

ν0
2Q

(cid:18)

#

(cid:19)

Sψ(f )

Leeson
formula

.

(1.26)

The above can be rewritten as

Sϕ(f ) =

1 +

Sψ(f ) ,

f 2
L
f 2

(cid:21)

(cid:20)

where

(1.27)

fL =

ν0
2Q

=

1
2πτ

Leeson frequency

(1.28)

is the Leeson frequency. By inspection on Eq. (1.27), the oscillator behavior
is that of a ﬁrst-order ﬁlter with a perfect integrator (a pole in the origin in
the Laplace transform domain) and a cutoﬀ frequency fL (a zero on the real
left-axis), as shown in Fig. 1.9. The ﬁlter time constant is the relaxation
time τ of the resonator.

It is to be made clear that Eq. (1.26), and equivalently Eq. (1.27),
accounts only for the phase-to-frequency conversion inherent in the loop.
The resonator noise is still to be added for the noise spectrum to be correct.
To summarize, the Leeson eﬀect [Eq. (1.26)–(1.27)] consists of the mul-
tiplication by f −2 of the ampliﬁer phase noise spectrum below the Leeson
frequency fL = ν0
2Q . This behavior is quite general since the ampliﬁer noise

February 2, 2008

E. Rubiola The Leeson eﬀect

15

S (f)ϕ
Sψ(f)

=

+1

2

1 ν0
f 2
2Q

Leeson effect

Sϕ(f)
Sψ(f)

log−log
scale

1

f−2

f−2

x

fL

f

Figure 1.9: The Leeson-eﬀect transfer function.

)
f
(
ϕ
S

f−2

x

f−2

b−3
flicker frequency

oscillator noise

amplifier noise

o

s

c
i
l
l
a
t

o

r

L

e

e

s

o

n effe
amplifier flicker

ct

f−2

x

b−2

f−2

white frequency

white phase

b0

amplifier white

n
o
i
t
c
n
u
f
-
r
e
f
x
-
e
l

t
c
e
f
f
e
-
e
l

Figure 1.10: The Leeson eﬀect, shown for a typical microwave oscillator.

fL

f

is still unspeciﬁed. Figure 1.10 shows the Leeson eﬀect in a typical case
(microwave oscillator), in which the ampliﬁer shows white and ﬂicker phase
noise.

The formula (1.26) was originally proposed by David B. Leeson [Lee66]
as a model for short-term frequency ﬂuctuations, inspired to the magnetron
for radar applications. It was perfectly sound from this standpoint to con-
sider the cavity ideally stable in the short term (1 ms corresponds to a
round-trip of 300 km), and to ascribe all the noise to the ampliﬁer, which

16

E. Rubiola The Leeson eﬀect

February 2, 2008

relies on an electron beam.

1.3.1 Delay-line oscillator

The frequency reference can be a delay line instead of the resonator, as
shown in Fig. 1.11. In the frequency domain, the delay line is described
by β(ω) = e−jωτ . Thus the loop can sustain any oscillation frequency for
which arg β(ω) = 0. A selector circuit, not shown in Fig. 1.11, is therefore
necessary to select a speciﬁc oscillation frequency ω0.

The Leeson eﬀect is derived in quasistatic conditions from Eq. (1.16)

In the case of the delay line it holds that d
τ . Interestingly,
the delay line is equivalent to a resonator of resonant frequency ν0 and
merit factor

dω arg β(ω) =

−

thus

to the extent that it has the same slope d
For slow ﬂuctuations it holds that

dω arg β(ω) of the resonator.

and therefore

Sϕ(f ) =

4π2τ 2 Sψ(f )
The noise propagation of fast phase ﬂuctuations (f & fL) from the ampliﬁer
input to the oscillator output is far more complex. Chapter 4 is devoted to
this topic.

(1.33)

fL .

≪

f

∆ω =

ψ
d
dω arg β(ω)

.

−

Q = πν0τ ,

fL =

1
πτ

ψ
2πτ

1

∆ν =

1
f 2

f

≪

fL ,

(1.29)

(1.30)

(1.31)

(1.32)

February 2, 2008

E. Rubiola The Leeson eﬀect

17

0V

+

Σ
+

in

A

out

out

delay line
β(ω)

in

oscillator
output

Feedback sustains oscillation at
any

ω at which arg (Αβ)=π

|Αβ|

1

+π
0
−π

A selector circuit (not shown) is needed
to select the oscillation frequency

0

2π
τ

4π
τ

Figure 1.11: Basic delay-line oscillator.

arg (Αβ)

ω0

c
i
s
a
b
-
y
a
l
e
d
-
e
l

ω

ω

1.4 Ampliﬁer noise

1.4.1 Additive white noise

The ampliﬁer noise is described in terms of the noise temperature Ta deﬁned
as follows. When the ampliﬁer is input-terminated to a resistor at the
temperature T0, the equivalent spectrum density at the ampliﬁer input is
N = k(Ta + T0). The ampliﬁer noise is therefore

The spectrum density of the equivalent input noise can also be written as

The above Eq. (1.35) deﬁnes the noise ﬁgure F . By equating (1.34) and
(1.35), we ﬁnd

Na = kTa .

Na = F kT0 ,

Na = (F

1)kT0 ,

−

F =

Ta + T0
T0

.

(1.34)

(1.35)

(1.36)

(1.37)

and

18

E. Rubiola The Leeson eﬀect

February 2, 2008

The unambiguous deﬁnition of F requires that the temperature T0 is spec-
iﬁed. The standard value is 290 K (17 ◦C). Accordingly, it holds that
kT0 = 4

174 dBm in 1 Hz bandwidth.
When ampliﬁers are cascaded, the input noise Fn −

1 of the n-th am-
m of the preceding ampliﬁers.

pliﬁer is divided by the power gain
The noise ﬁgure of the chain is given by the Friis formula [Fri44]

10−21 J, that is,

n−1
m=1 A2

−

×

F = F1 +

1

F2 −
A2
1

+

Q
F3 −
1
A2
1A2
2

+ . . .

Friis
formula

(1.38)

The typical noise ﬁgure of low-noise ampliﬁers is of 1–2 dB, depending
on technology, on frequency, and on bandwidth. The eﬀect of bandwidth
shows up clearly in microwave ampliﬁers, where the active devices have
low noise temperature and capacitive input. The loss of the impedance-
matching network necessary to match the resistive ampliﬁer input (50 Ω)
to the capacitive transistor gate turns into increased noise ﬁgure. Needless
to say, larger bandwidth design turns into higher input loss, thus into higher
noise ﬁgure.

The deﬁnitions of Ta and F implicitly assume that the ampliﬁer noise
is a random process added to the useful signal, and not correlated to it. In
the presence of a sinusoidal carrier of power P0, the phase noise is

Sϕ(f ) = b0 =

F kT0
P0

constant.

(1.39)

1.4.2 Flicker noise

It has been experimentally observed [HWB68, WFJ97, HHWW03] that
phase ﬂickering of diﬀerent ampliﬁer types falls in a relatively narrow range,
and that for a given ampliﬁer the phase ﬂickering is about independent of
the carrier power. Consequently the ﬂicker noise of m cascaded ampliﬁers of
the same type is about m times the noise of one ampliﬁer. This is radically
diﬀerent from the case white noise, where the noise of a stage referred to
the input is divided by the gain of all the preceding stages.

Table 1.2 shows the typical phase ﬂickering of commercial ampliﬁers.

February 2, 2008

E. Rubiola The Leeson eﬀect

19

Table 1.2: Typical phase ﬂickering of ampliﬁers.

RATE

fair
good
best

MOS
microwave
100
110
120

−
−
−

bipolar HF
HF/UHF
120
130
140

−
−
−

dBrad2/Hz

no carrier

S(f)

S(f)

parametric
up−conversion

near−dc
flicker

e
l
a
c
s
 
n
i
l
 

 

−
n
i
l

e
s
i
o
n
-
m
a
r
a
p
-
e
l

e
l
a
c
s
 
n
i
l
 

 

−
n
i
l

ν
0

ν

ν0

ν

Figure 1.12: Parametric up-conversion of near-dc ﬂicker in ampliﬁers.

The mechanism that originates phase ﬂickering is a low-frequency (close
to dc) random process with spectrum of the ﬂicker type that modulates
the carrier (Fig. 1.12). This mechanism is often called parametric noise 3
because the near-dc ﬂickering modulates a parameter of the device high-
frequency model.

A simpliﬁed nonlinear model provides insight in the counterintuitive
behavior of phase noise. Let us consider a signal x(t) = V0 cos(ω0t) + n(t)
inside a device, where the sinusoid is the input signal, and n(t) is the near-
dc ﬂickering of the dc bias. Additionally, let us assume that the device
is slightly nonlinear, and that the nonlinearity can be expanded as the
2nd-degree polynomial P (x) = a0 + a1x + a2x2. Feeding x(t) into the
polynomial, we get a carrier term a1V0 cos(ω0t), plus a close-in noise term
3Of course, the term parametric noise is more general than the phase ﬂickering.

20

E. Rubiola The Leeson eﬀect

February 2, 2008

a2V0n(t) cos(ωt). Inspecting on the radio-frequency spectrum around ω0, we
ﬁnd that the power of the noise sidebands is proportional to V 2
0 , thus to the
power of the input signal. This is in agreement with the simple observation
that there can not be close-in noise in the absence of a carrier. As a
consequence, the fractional amplitude ﬂuctuation, i.e., the close-in noise
divided by the carrier, is α(t) = 2a2
n(t), independent of the carrier power.
a1
Similarly, a 2nd-degree nonlinear model that involves a variable reactance
mechanism (varactor eﬀect in transistors and MOS) leads to close-in phase
noise independent of the carrier power.

Phase ﬂickering depends on the physical size of the ampliﬁer active
region. This can be proved through a gedankenexperiment in which we split
the input signal into n equal branches, amplify and recombine. The power
gain is that of a single branch. Conversely, the ﬂicker noise is (b−1)tot =
1
n (b−1)branch because the branch ampliﬁers are independent and the phase
ﬂickering of each is not aﬀected by having reduced the power by n. If we join
the n ampliﬁers in a single one that employs an active region (base in the
case of bipolar transistor, or channel in the case of ﬁeld-eﬀect transistors) n
times larger, the phase noise reduction is kept. The additional hypothesis
is required, that the near-dc ﬂickering takes place at microscopic scale, for
there is no correlation between the diﬀerent regions of the n-volume device.
This hypothesis is consistent with the two most accredited models for the
ﬂicker noise [Hoo69, McW57].

Finally, phase ﬂickering is related to the ampliﬁer gain. This is a side
eﬀect of the number of stages needed for a given gain, rather than a gain
eﬀect in a single stage.

1.4.3 Other noise types

Noise phenomena with a slope signiﬁcantly steeper than
1 in the spec-
trum, say f −2, do not exist in ampliﬁers. If such phenomenon was present,
the delay of the ampliﬁer would diverge rapidly. This never happens in
practice. This general statement does not exclude some bumps in the spec-
trum, for example due to the environment temperature, which in some
frequency range yield a spectrum locally steeper than f −1.

−

February 2, 2008

E. Rubiola The Leeson eﬀect

21

S (f)ϕ

b

_1f−1

b−1 about
constant

e
s
i
o
n
-
i
l
p
m
a
-
e
l

b0=

lower power
FkT0/P0
higher power

fc

range of

fc

f

Figure 1.13: Typical phase noise of an ampliﬁer.

1.4.4 Phase noise spectrum

The total phase noise spectrum results from adding the white and the ﬂicker
noise spectra, as in Fig. 1.13. This relies on the assumption that white and
ﬂicker phenomena are independent, which is true for actual ampliﬁers.

It is important to understand that b0 (white) is proportional to the
inverse of the carrier power P0, while b−1 (ﬂicker) is about independent of
P0. The corner frequency fc depends on the input power. The belief that
fc is a noise parameter of the ampliﬁer is a common mistake.

1.4.5 Noise-corrected ampliﬁers

The ampliﬁer ﬂicker noise is of paramount importance to the oscillator
frequency stability. Reducing the ﬂicker, even if this is done at expense of
higher white noise, results in improved oscillator stability. A new generation
of oscillators make use of a noise-corrected ampliﬁer in the loop. This
technique is based on a bridge scheme that takes the diﬀerence between
the input and output of the ampliﬁer, compensating for gain and delay.
Balancing the bridge, the diﬀerential signal is the ampliﬁer distortion and
noise. The latter is ampliﬁed, detected, and used to compensate for the
ampliﬁer noise in closed loop.

In a noise-corrected ampliﬁer the input is split into two branches, that is,

22

E. Rubiola The Leeson eﬀect

February 2, 2008

Type 1

fL > fc

Type 2

fL < fc

)
f
(
ϕ
S

b−3

f−3

flicker
freq

f−2

x

f−2

b−2
white
freq

amplifier

f−2

x

b0
white phase

s
e
p
y
t
-
l
a
e
d
i
-
e
l

)
f
(
ϕ
S

b−3

f−3

f−2

x

flicker
freq

amplifier

b−1

f−1

flicker
phase

b0
white phase

fc

fL

f

fL

fc

f

Figure 1.14: With a ﬂickering ampliﬁer, the Leeson eﬀect yields two types
of spectrum, type 1 for fc < fL and type 2 for fc > fL. A noise-free
resonator is assumed.

the main ampliﬁer and the noise-correction ampliﬁer. A directional coupler
may be necessary, which introduce a loss of 3 dB, plus the dissipative loss.
Such loss turns into an increase in noise ﬁgure of the same amount. If the
noise ﬁgure of the internal ampliﬁer is of 1–2 dB and the total loss of the
coupler is of 4 dB, the noise ﬁgure of the corrected ampliﬁer is of 5–6 dB.
On the other hand, the correction results in a reduction of 20–40 dB in the
phase ﬂickering.

1.5 The phase noise spectrum of real oscillators

For a given ampliﬁer, the phase noise (Fig. 1.13) is white at high f , and of
the ﬂicker type below the cutoﬀ frequency fc that results from the carrier
power P0. When such ampliﬁer is inserted in an oscillator, it interacts with
the resonator in the way shown in Fig. 1.14. Two basic types of interaction
are possible.

Type 1 is the most frequently encountered. It is typical of microwave os-
100 MHz) piezoelectric oscillators, in which
cillator and high-frequency (
fL is made high by the high resonant frequency and by the low merit factor
Q. Looking at Fig. 1.13 from right to left, the ampliﬁer phase noise is white

≥

February 2, 2008

E. Rubiola The Leeson eﬀect

23

frequency rw
of the resonator

Type 1

fL > fc
total noise

frequency rw
of the resonator

Type 2

fL < fc
total noise

frequency flicker
of the resonator

)
f
(
ϕ
S

Leeson effect
amplifier

intersection

f > f

L

intersection

f > f

L

)
f
(
ϕ
S

l

o

w

e

r

−

frequency flicker
of the resonator

n

o

i
s

e
 
r

e

s

o

n

a
t
.

Leeson effect
amplifier

r
o
t
a
n
o
s
e
r
-
y
s
i
o
n
-
e
l

fc

f

L

f

fL

fc

f

Figure 1.15: Eﬀect of the resonator frequency ﬂuctuations on the oscillator
noise.

and the Leeson eﬀect originates white frequency noise (b−2f −2). At lower
frequencies the ampliﬁer phase noise turns into ﬂicker, hence the oscillator
noise turns into frequency ﬂickering (b−3f −3). No ﬂicker is present in the
output phase spectrum.

Type 2 is found in low-frequency (5–10 MHz) high-stability quartz os-
cillator, in which the merit factor may exceed 106. Looking at Fig. 1.13
from right to left, the ampliﬁer phase noise turns from white to ﬂicker at
f = fc. Accordingly, phase ﬂickering (b−1f −1) is visible at the oscillator
output. At lower frequencies the Leeson eﬀect takes place, hence the os-
cillator noise turns into frequency ﬂickering (b−3f −3). No white frequency
noise (b−2f −2) is present in the output phase spectrum.

By inspection on Fig. 1.13, there can be either the f −1 or the f −2 noise

types, not both.

1.5.1 The eﬀect of the resonator noise

The dissipative loss of the resonator, inherently, originates white noise. Yet,
the noise phenomena most relevant to the oscillator stability are the ﬂicker

24

E. Rubiola The Leeson eﬀect

February 2, 2008

and the random walk of the resonant frequency ν0. Thus, the spectrum
Sy(f ) of the fractional frequency ﬂuctuation y = ∆ν/ν0 shows a term
h−1f −1 for the frequency ﬂicker, and h−2f −2 for the frequency random
walk. The relationship4 between Sϕ(f ) and Sy(f ) is

Sy(f ) =

f 2
ν2
0
Accordingly, the term h−1f −1 of the resonator ﬂuctuation yields a term
proportional to f −3 in the phase noise, and the term h−2f −2 yields a term
f −4. The resonator ﬂuctuation is independent of the ampliﬁer noise, for it
adds to the oscillator noise.

Sϕ(f ) .

(1.40)

Figure 1.15 shows the two basic spectra of Fig. 1.14, after introducing
the resonator frequency ﬂuctuation. The resonator ﬂuctuation may hide the
ampliﬁer corner frequency fc, the Leeson eﬀect, or both. Three behavior
types deserve attention.

1. The resonator noise hides fc but not fL. This is found in type-1
spectra. The cross point of the f −3 resonator noise and the f −2 noise
due to the Leeson eﬀect has the same graphical signature of fc, but
is not.

2. The resonator noise hides fc and fL. This is found in type-1 and
type-2 spectra. Only one corner is visible on the plot, where the f −3
resonator noise crosses the f 0 ampliﬁer noise. This behavior is found
for example in VHF quartz oscillators.

3. The resonator noise hides fL, but not fc. This is expected5 in type-2

spectra.

1.5.2 The eﬀect of the output buﬀer

It is interesting to analyze the case of an oscillator with ideal resonator and
noisy ampliﬁer, followed by a noisy output buﬀer (Fig. 1.16). Of course

4Start from the fractional frequency ﬂuctuation y = 1

dϕ(t)
dt

2πν0

. The time-domain

derivative maps into a multiplication by ω2, thus by (2πf )2, in the spectrum.

5This case needs some more theoretical analysis.

February 2, 2008

E. Rubiola The Leeson eﬀect

25

oscillator

random phase
ψ
e j 1

A1

output buffer

random phase
e 2jψ

A2

out

β

Type 1A

fL > fc
total noise

output
buffer

the output buffer
noise is not visible

)
f
(
ϕ
S

Type 2A

fL < fc
total noise

output
buffer

intersection f < fL

amplifier

)
f
(
ϕ
S

)
f
(
ϕ
S

amplifier

output
buffer

amplifier

r
e
f
f
u
b
-
f
o
-
t
c
e
f
f
e
-
e
l

fc

f

L

Type 1B

fL > fc
total noise

low−flicker sustaining
amplifier (noise corrected)
and normal output buffer

f−1 noise appears

f

f

fc

fL

f

L

fc

f

Type 2B

fL < fc

low−flicker sustaining
amplifier (noise corrected)
and normal output buffer

Figure 1.16: Eﬀect of the output buﬀer on the oscillator noise.

the output buﬀer is independent of the oscillator, for the two noise spectra
barely add.

The white noise comes from the additive white noise N referred to the

26

E. Rubiola The Leeson eﬀect

February 2, 2008

carrier power P0. The noise F kT0 of the sustaining ampliﬁer is ampliﬁed
at the input of the buﬀer. Therefore, the white phase noise of the buﬀer
ends up to be negligible in virtually all practical cases. On the other hand,
the ﬂicker phase noise of ampliﬁers is about independent of the carrier
power, hence the phase noise of the buﬀer is not expected to be negligible.
Accounting for the buﬀer noise, the spectra of Fig. 1.14 are to be modiﬁed
as shown in Fig. 1.16.

In type 1A and 2A spectra, the sustaining ampliﬁer and the buﬀer have
similar ﬂicker characteristics. In type 1A (fL > fc), the phase ﬂickering of
the buﬀer is hidden by the Leeson eﬀect. The insertion of the output buﬀer
lets the spectrum is substantially unchanged.

In type 2A (fL < fc), the phase ﬂickering of the buﬀer adds to the phase
ﬂickering of the oscillator. As a consequence, the corner point at which the
f −1 noise turns into f −3 is pushed towards lower frequencies. This corner
point can be easily mistaken for the Leeson frequency because it has the
same graphical signature.

In type 1B spectrum, the sustaining ampliﬁer exhibits low phase ﬂick-
ering, signiﬁcantly lower than that of the buﬀer. As a result, fc is a low
frequency. This is the case of some low-noise microwave oscillators, thus we
assume fL > fc even in the case of large merit-factor oscillators. A simple
ampliﬁer is used as the buﬀer. If the merit factor of the resonator is large
enough (low fL), the f −1 phase noise of the buﬀer shows up, hiding the f 0
to f −2 slope transition characteristic of the Leeson eﬀect. Yet, the Leeson
frequency can be estimated extrapolating the f −2 segment still visible.

If we assume that fL < fc, the case of the noise corrected ampliﬁer
and simple buﬀer is similar to the type 2A, but for a larger buﬀer noise.
Consequently, the f −1
f −3 corner slides leftwards, farther from the true
Leeson frequency.

→

Chapter 2

Oscillator hacking

The combined knowledge of the oscillator noise theory, of general physics,
and of electronic technology, enables to understand the inside of an oscil-
lator from the data sheet, and to guess some relevant internal parameters
like P0, Q, fL, ampliﬁer 1/f noise, etc. We describe the guidelines of this
process and show some examples. The need of guessing the internal tech-
nology is a source of diﬃculties and of inconsistencies which may make
the interpretation only partially reliable. Coping with this is a part of the
message addressed to the reader.

Inspection on the data sheet. The ﬁrst step consists of reading care-
fully the data sheet focusing on the resonator and on the ampliﬁer tech-
nology, and bringing up to the mind as many related facts as possible. For
example, a 5 MHz quartz can have a merit factor in excess of 106, but it
must be driven at very low power, say 10–20 µW, for best long-term sta-
bility. The merit factor of a dielectric resonator can be of 1000 or more,
depending on size and frequency. So on for the other resonator types, and
for the ampliﬁers. Similar oscillators encountered in the past may have a
similar spectrum, or be surprisingly diﬀerent.

Parametric estimation of the spectrum. This part of the process
consists of matching the phase noise spectrum with the polynomial Sϕ(f ) =

27

28

E. Rubiola The Leeson eﬀect

February 2, 2008

0
i=−4 bif i in order to identify the coeﬃcients bi. A term bif i on a log-log

plot appears as a straight line
P

noise type
white phase
ﬂicker phase
white frequency
ﬂicker frequency
frequency r. w.

term
b0
b−1f −1
b−2f −2
b−3f −3
b−4f −4

slope
0
10 dB/dec
20 dB/dec
30 dB/dec
40 dB/dec

−
−
−
−
0
i=−4 bif i +

P

j sj(f ), where
The actual spectra are of the form Sϕ(f ) =
the terms sj(f ) account for the residuals of the mains (50 Hz or 60 Hz
and multiples), for bumps due to feedback and for other stray phenomena.
Figures 2.1 to 2.9 provide some examples of actual phase noise spectra.
The mathematical process of matching the spectrum to a model is called
parametric estimation [PW98, JW68]. Some a-priori knowledge of the na-
ture of the stray signals may be necessary to match the complete model
j sj(f ) to the observed spectrum. Although (almost) only in
the power-law coeﬃcients bi are relevant in the end, the sj(f ) are essential
P
in that they reduce the bias and residuals of the estimation.

0
i=−4 bif i+

P

P

Whereas computers provide accuracy, a general parametric estimator is
not easy to implement. Conversely, the human eyes do well in ﬁltering out
the stray signals and getting a good straight-line (polynomial) approxima-
tion. The inspection on a log-log plot by sliding old-fashion squares and
(f ),
rulers proves to be surprisingly useful. Spectra are often shown as
2 Sϕ(f ). Pick up the reference slope f i using the
don’t forget that
largest possible area on the coordinate frame, slide the square until its side
coincides to the corresponding portion of the spectrum (bif i), and get the
coeﬃcients bi. Proceed from right to left, thus from b0 to b−4.

(f ) = 1

L

L

Generally, at the corner between two straight lines the true spectrum
is 3 dB above the corner point. This is due to either one of the following
reasons. In the ﬁrst case, the diﬀerence in slope is 1 at the corner point.
When this occurs, there are two independent random processes whose spec-
trum takes the same value (bif i = bi+1f i+1) at the corner point. In the
second case the diﬀerence in slope is of 2, for at the corner point it holds

February 2, 2008

E. Rubiola The Leeson eﬀect

29

that bif i = bi+2f i+2. This occurs when a single noise process is ﬁltered,
due to the Leeson eﬀect. The factor 2 (3 dB) at the corner point results
from a single real zero of the complex transfer function.

In some cases the diﬀerence between the spectrum and the straight-line
approximation at a corner is not of 3 dB. When this occurs, one should
work two estimations, one based on the straight-line ﬁtting, and the other
based on the 3 dB diﬀerence between straight lines and true spectrum at
the corner frequencies. The best estimate is a weighted average of the two
worked-out spectra. Physical judgment should be used to assign unequal
weights.

Interpretation. This part of the process starts from the identiﬁcation of
the spectrum type, among those analyzed in the previous chapter. Then we
get into the learning process, in which each oscillator is a unique case. As a
general rule, one should proceed from the right-hand side of the spectrum
to left, thus from white phase noise to frequency ﬂicker or to random walk.
Starting from the white phase noise, we evaluate the power P0 at the
input of the sustaining ampliﬁer using Sϕ(f ) = b0 = F kT0/P0 [Eq. (1.39)].
Thus,

One may admit a noise ﬁgure F = 1 dB for conventional ampliﬁers, and
of F = 5 dB for noise-corrected ampliﬁers, due to the input power splitter.
Thanks to the gain of the sustaining ampliﬁer, the white noise of the output
buﬀer can generally be neglected.

The next step is to evaluate fc (ﬂicker of the sustaining ampliﬁer) and
fL, in order of occurrence from right to left. It is then necessary to guess
the oscillator sub-type (Fig. 1.16). A major diﬃculty is to understand
whether the oscillator stability derives from the Leeson eﬀect or from the
resonator ﬂuctuation. Inverting Eq. (1.28), the Leeson frequency gives the
merit factor

P0 =

F kT
b0

Q =

ν0
2fL

.

(2.1)

(2.2)

30

E. Rubiola The Leeson eﬀect

February 2, 2008

 Phase noise of the 10 GHz DRO Miteq D210B 

www.miteq.com/micro/fresourc/d210b/droTyp.html

Spectrum downloaded from

−30dB/dec

fc =70kHz

3dB difference

−20dB/dec

=−146

dBrad2/Hz

b0

(b−1)ampli=−98 dBrad2/Hz

4dB difference

d
o
m
-
o
r
d
-
q
e
t
i
m
-
e
l

Figure 2.1: Phase noise of the 10 GHz DRO Miteq D210B. Courtesy of
Miteq Inc. Interpretation, comments and mistakes are of the author.

fL=4.3MHz

The corner frequency fc reveals the phase ﬂickering of the ampliﬁer

(b−1)ampli = b0fc

(2.3)

If the the spectrum is of the type 1B (noise-corrected sustaining ampliﬁer),
the 1/f noise is the phase noise of the output buﬀer.
Finally, the Allan variance of the fractional

frequency ﬂuctuation

(Tab. 1.1), i.e., the oscillator stability, is

σ2
y(τ ) = . . . +

1
2

b−2
ν2
0

1
τ

b−3
ν2
0

4π2
6

b−4
ν2
0

+ 2 ln(2)

+

τ + . . .

(2.4)

2.1 Miteq DRO mod. D-210B

Figure 2.1 shows the phase noise spectrum of the dielectric-resonator oscil-
lator (DRO) Miteq D-210B, taken from the device data sheet. The plot is
ﬁtted by the polynomial

0
i=−3 bif i, with

P

February 2, 2008

E. Rubiola The Leeson eﬀect

31

146 dB

b0
−
b−1
11 dB
b−2 −
b−3 +37 dB

10−15
2.5
(not visible)

×

10−2
103

7.9
×
5.0
×

rad2/Hz

rad2/Hz
rad2/Hz

This indicates that the spectrum is of the type 1A of Fig. 1.16.

One might be tempted to ﬁt the spectrum with a smaller b0 (say,

147
−
dBrad2/Hz) and to add a term b−1f −1 tangent to the curve at f
2 MHz.
In this case the spectrum would be of the type 1B, which contains the signa-
ture of the output buﬀer. We discard this alternate interpretation because
80 dB),
the noise of the output buﬀer would be b−1 ≈
which is too high for a microwave ampliﬁer (Table 1.2).
The spectrum gives the following indications.

10−8 rad2/Hz (

−

≈

1. The coeﬃcient b0 derives from the ampliﬁer noise F kT referred
to the carrier power P0 at the input of the sustaining ampliﬁer,
that is, b0 = F kT
. Assuming that the noise ﬁgure is F = 1 dB,
P0
10−21 rad2/Hz (
173 dBrad2/Hz), it follows that
thus F kT = 5.1
P0 = F kT
27 dBm).
b0

= 2 µW (

×

−

−

2. However arbitrary the assumption F = 1 dB may seem, it is repre-
sentative of actual microwave ampliﬁers. Depending on bandwidth
and technology, the noise ﬁgure of a “good” ampliﬁer is between 0.5
dB and 2 dB. In this range, we ﬁnd P0 between 1.8 µW and 2.5 µW.

3. The spectrum changes slope from f 0 to f −2 at the Leeson frequency
fL ≃
4.3 MHz. At this frequency, the asymptotic approximation is
some 4 dB lower than the measured spectrum, instead of the expected
4.3 MHz, it follows
3 dB. This discrepancy is tolerable. From fL ≃
that Q = ν0

1160, quite plausible for a dielectric resonator.

4. The white frequency coeﬃcient

is b−2 = 7.9

10−2

rad2/Hz

×

2fL ≃

11 dBrad2/Hz).

(
−

5. The corner point at which the slope changes from

3 is 70 kHz.
This is the corner frequency fc of the ampliﬁer, at which it holds that

2 to

−

−

32

E. Rubiola The Leeson eﬀect

February 2, 2008

(b−1)amplif −1 = (b0)ampli. Hence (b−1)ampli = 1.8
(
−

98 dBrad2/Hz).

×

10−10 rad2/Hz

6. The ﬂicker

frequency coeﬃcient

is

b−3 = 5

103

rad2/Hz

×

(+37 dBrad2/Hz).

7. The white and ﬂicker frequency noise, transformed into Allan variance

(Table 1.1), is

σ2
y(τ ) =

+ 2 ln(2) h−1

h0
2τ
b−2
ν2
0
7.9
2

×

=

≃

1
2τ

+ 2 ln(2)

b−3
ν2
0

10−2
×
(1010)2

1
τ

+ 1.39

103
5
(1010)2 ,
×

×

σ2
y(τ )

σy(τ )

4
×

2
×

10−22
τ
10−11
√τ

≃

≃

+ 6.9

10−17

+ 8.3

10−9 .

×

×

thus

Finally, one should note that the oscillator ﬂicker shows up in the 1–100 kHz
region. Common sense suggests that temperature and other environmental
ﬂuctuations have no eﬀect at this time scale, and that the ﬂickering of
the dielectric constant in the resonator will not exceed the ampliﬁer noise.
Consequently, in this region the oscillator ﬂicker is due to the ampliﬁer
through the Leeson eﬀect, rather than to the resonator.

2.2 Poseidon DRO-10.4-FR (10.4 GHz)

The Poseidon DRO-10.4-FR is another example of oscillator based on a
dielectric resonator. Figure 2.2 shows the phase noise spectrum, from a
0
i=−3 bif i, with
preliminary data sheet. Sϕ(f ) is ﬁtted by the polynomial

P

February 2, 2008

E. Rubiola The Leeson eﬀect

33

Phase noise of two PSI DRO−10.4−FR

−30dB/dec

dBrad2/Hz

D

b−3 =+4
O−10.4−FR

R

D

R

O−10.4−XPL

slope
−25 dB/dec

b−1=−165dBrad2/Hz

z
H
/
c
B
d
 
,
e
s
i
o
n
 
e
s
a
h
p
B
S
S

 

−50
−60
−70
−80
−90
−100
−110
−120

−130
−140
−150
−160
−170
−180

t
s
1
-
d
o
m
-
o
r
d
y
m
-
n
o
d
i
e
s
o
p
-
e
l

7dB

slope close to −25dB/dec 

−20dB/dec

3dB difference

b0=−165dBrad2/Hz

102

103

104

105

106

107

fc =9.3kHz

Fourier frequency, Hz

fL =3.2MHz

Figure 2.2: Poseidon DRO 10.4-FR. The spectra are plotted using the
preliminary data available on the manufacturer web site. Interpretation,
comments and mistakes are of the author.

165 dB

b0
−
b−1
b−2 −
b−3

35 dB
+4 dB

10−17
3.2
(not visible)

×

3.2

10−4

×
2.5

rad2/Hz

rad2/Hz
rad2/Hz

Once again, the spectrum is of the type 1A (Fig. 1.16), typical of microwave
oscillators. Yet, the discrepancy with respect to the theoretical model is
larger than in the case of the Miteq oscillator. The spectrum gives the
following indications.

1. The spectrum results from the comparison of two DRO-10.4 oscilla-
tors. In the absence of other indications, we believe that the numerical
data refer to a single oscillator, after taking away 3 dB from the raw
data.

2. The white phase noise is b0 = 3.2

10−17 rad2/Hz (

165 dBrad2/Hz).

160 µW (

8 dBm), assuming that F = 1 dB.

−

Thus P0 = F kT

b0 ≃

×

−

34

E. Rubiola The Leeson eﬀect

February 2, 2008

3. The Leeson frequency is fL = 3.2 MHz. Accordingly, the merit factor

1625, which is reasonable for a dielectric resonator.

is Q = ν0

2fL ≃

4. In a type-1A spectrum it holds that b−2f −2 = b0 at f = fL. Thus, the
35 dBrad2/Hz).
3.2

10−4 rad2/Hz (

white frequency noise is b−2 ≃

−

×

5. There is some discrepancy between the Leeson model and the true
spectrum. In the region from 2 kHz to 200 kHz, the spectrum seems
to be close to a line of slope f −5/2, rather than f −3 or f −2. At
10 kHz) is
the present time this discrepancy, (up to 4 dB at f
unexplained.

≈

6. The corner frequency of the ampliﬁer (i.e., the frequency at which
the oscillator spectrum changes from f −2 to f −3) is fc = 9.3 kHz.
Accordingly, the phase noise spectrum of the ampliﬁer, on the
10−13 rad2/Hz
left hand of f = fc,
125 dBrad2/Hz).
(
−

is (b−1)ampli = b0fc = 2.9

×

7. The ampliﬁer ﬂickering, 5 dB lower than the best in Table 1.2 is
surprisingly low for a microwave ampliﬁer contained a commercial
product. Such a low noise could be obtained with SiGe technology,
with a single-stage ampliﬁer employing a large-volume transistor, or
with some feedback or feedforward noise degeneration scheme. A
noise degeneration scheme seems incompatible with the size of the
packaged oscillator. Yet, nothing can be taken for sure on the basis
of the available information.

8. The ﬂicker

frequency coeﬃcient

is

b−3 = 2.5

rad2/Hz

9. The white and ﬂicker frequency noise, transformed into Allan variance

(+4 dBrad2/Hz).

(Table 1.1), is

σ2
y(τ ) =

+ 2 ln(2) h−1

h0
2τ
b−2
ν2
0

1
2τ

=

+ 2 ln(2)

b−3
ν2
0

February 2, 2008

E. Rubiola The Leeson eﬀect

35

2.5
(10.4

≃

2

×

109)2

×

1
τ

+ 1.39

103
109)2 ,

5
×
(10.4
×

×

thus

σ2
y(τ )

σy(τ )

1.5

1.2

10−24
×
τ
10−12
×
√τ

≃

≃

+ 3.2

10−20

+ 1.8

10−10 .

×

×

Figure 2.2 also reports the phase noise spectrum of the DRO-10.4-XPL os-
cillator, which is a diﬀerent version of the same base design, intended for
phase-locked loops. Below a cutoﬀ frequency of about 70 kHz, this oscilla-
tor is locked to an external reference, for the spectrum gives no additional
information in this region. Nonetheless, it is to be noted that the spec-
trum is proportional to f −5/2, i.e.,
25 dB/decade below the loop cutoﬀ
−
frequency of 10 kHz. This is the signature of a fractional-order control
system, like that proposed in [CM85].

2.3 Poseidon Shoebox (10 GHz sapphire res-

onator)

The Poseidon Shebox integrates a sapphire whispering gallery (WG) res-
onator and an interferometric noise degeneration scheme. There results
a low-noise oscillator intended for high short-term stability applications.
Figure 2.3 shows the phase noise spectrum with a tentative interpretation.
The spectrum seems to be of the type 2 (Fig. 1.14), with fL < fc. Qualita-
tively, this is consistent with the fact that the WG resonator features high
Q. Yet this interpretation suﬀers from three problems.

1. From Q = ν0
2fL

106 at ν0 = 10 GHz. This value is
incompatible with the dielectric loss of the sapphire. For comparison,
the typical merit factor of a 10 GHz WG resonator is in the range of

, we get Q

1.9

×

≈

36

E. Rubiola The Leeson eﬀect

February 2, 2008

Poseidon Shoebox
10 GHz sapphire WG resonator
noise correction

oscillator

b−3f−3

instrument background

d ~ 6dB

b−1f−1

−90

−100

−110

−120

−130

−140

−150

−160

−170

−180

z
H
/
c
B
d
 
,
e
s
i
o
n
 
e
s
a
h
p

g
n
o
r
w
-
x
o
b
e
o
h
s
m
-
n
o
d
i
e
s
o
p
-
e
l

100

1000

fL=2.6kHz

10000

100000

Fourier frequency, Hz

Figure 2.3: Poseidon Shoebox, ﬁrst attempt to interpret the spectrum.
Interpretation, com-
Data are taken from the manufacturer data sheet.
ments and mistakes are of the author.

105
107
109

2
×
3
×
5
×

295 K room temperature
77 K liquid N
liquid He
4 K

The dielectric loss of the sapphire is a reproducible function of tem-
perature. Thus, the loss of the resonator depends on the space dis-
tribution of the electric ﬁeld, i.e., on the mode, in a narrow range.
106 can not be obtained by moderate cooling
A merit factor of 1.9
(Peltier cells). Finally, the size and weigh (3 dm3 and 6.5 kg) in-
dicate that the oscillator works at room temperature, at most with
temperature stabilization.

×

2. The phase ﬂicker of the sustaining ampliﬁer is b−1f −1 with b−1 ≈
160 dBrad2/Hz at
10−12
f = 10 kHz with slope f −1, thus
120 dBrad2/Hz at 1 Hz. This
value is too high for a sophisticated ampliﬁer that makes use of the

rad2/Hz. This is seen on the plot,

−

−

February 2, 2008

E. Rubiola The Leeson eﬀect

37

f−1 to f −3 conversion

oscillator

(b−1)ampli=−140 dBrad2/Hz

instr. background

fc =850Hz

f0 to f −2 conversion

Poseidon Shoebox
10 GHz sapphire WG resonator
noise correction

(b−1)buffer =−120dBrad2/Hz

(b0)ampli=−169
dBrad2/Hz

z
H
/
c
B
d
 
,
e
s
i
o
n
 
e
s
a
h
p

−90

−100

−110

−120

−130

−140

−150

−160

−170

−180

t
h
g
i
r
-
x
o
b
e
o
h
s
m
-
n
o
d
i
e
s
o
p
-
e
l

100

1000

10000

fL=25kHz

100000

Fourier frequency, Hz

Figure 2.4: Poseidon Shoebox, revised interpretation. Interpretation, com-
ments and mistakes are of the author.

interferometric noise correction technique.

3. At fL, where b−3f −3 = b−1f −1, the true spectrum diﬀers from the
asymptotic approximation by 6 dB instead of 3 dB. This discrepancy
is an additional reason to reject the interpretation of Fig. 2.3.

The above diﬃculties make us understand that the spectrum is of the type
2A (Fig. 1.16), in which the ﬂicker noise of the output buﬀer shows up in
the region around fL. There follows new interpretation, shown in Fig. 2.4.

1. As usual, we start from the white noise ﬂoor. On the Figure, we
169 dBrad2/Hz). This is
10−17 rad2/Hz (

observe that b0 = 1.3
ascribed to the sustaining ampliﬁer.

×

−

2. The sustaining ampliﬁer makes use of an interferometric noise degen-
eration circuit to reduce the ﬂicker noise. In this circuit there are two
ampliﬁers, the ﬁrst ampliﬁes the input signal, and the second ampli-
ﬁes the noise of the ﬁrst, at the output of a carrier suppression circuit.

38

E. Rubiola The Leeson eﬀect

February 2, 2008

The second ampliﬁer corrects for the noise of the ﬁrst by means of
a feedback circuit. We guess a noise ﬁgure F = 5 dB, which results
from the intrinsic loss of the power splitter at the input of the noise
corrected ampliﬁer (3 dB), from the resistive loss of the power split-
ter and of the lines (1 dB), and from the noise ﬁgure of the second
ampliﬁer (1 dB).

3. From b0 = F kT
P0

, we get P0 = 1 mW (0 dBm).

4. The phase ﬂickering of the output buﬀer shows up on the right-
hand part of the spectrum, at 105–106 Hz. The noise coeﬃcient is
120 dBrad2/Hz). The output buﬀer is
10−12 rad2/Hz (
(b−1)buf ≃
a good microwave ampliﬁer.

−

5. After removing the buﬀer phase noise, the white frequency noise
b−2f −2 of the oscillator is clearly identiﬁed. The decade centered
81 dBrad2/Hz)
at 4 kHz is used to ﬁnd b−2 = 7.9
on the plot.

10−17 rad2/Hz (

−

×

6. From b−2f −2 = b0, found on the plot, it follows that fL ≃

25 kHz.
105. This is the typical value for a room-

Hence, Q = ν0
temperature WG sapphire resonator.

2fL ≃

2
×

×

7.9

10−6 rad2/Hz (

7. It is seen on the plot that b−3 ≃
8. In the spectrum of the type 2A, the corner frequency fc of the sus-
taining ampliﬁer is the frequency at which the oscillator noise changes
slope from f −3 to f −2. Thus, fc ≃
850 Hz. The ﬂicker noise of the
sustaining ampliﬁer is (b−1)amplif −1 with (b−1)ampli = b0fc. Thus,
(b−1)ampli ≃

140 dBrad2/Hz).

10−14 rad2/Hz (

51 dBrad2/Hz).

−

−

9. The white and ﬂicker frequency noise, transformed into Allan variance

February 2, 2008

E. Rubiola The Leeson eﬀect

39

(Table 1.1), is

σ2
y(τ ) =

+ 2 ln(2) h−1

=

+ 2 ln(2)

b−3
ν2
0

h0
2τ
b−2
ν2
0
7.9

1
2τ

10−9

≃

2

×
(10

×

×

109)2

1
τ

+ 1.39

7.9
(10

10−6
109)2 ,
×
×

×

thus

σ2
y(τ )

σy(τ )

4
×

10−29
τ

6.3

10−15
×
√τ

≃

≃

+ 1.1

10−25

×

+ 3.3

10−13 .

×

10. The bump at f = 40 kHz is ascribed to the feedback control of the

noise degeneration circuit.

2.4 Oscilloquartz OCXO 8600 (5 MHz AT-cut

BVA)

Figure 2.5 shows the phase noise of the oven-controlled quartz oscillator
Oscilloquartz OCX0 8600. This oscillator has been chosen as an example
because of its outstanding stability in the 0.1–10 s region. The spectrum
is of the type 2 (fL < fc), typical of low-frequency oscillators with high-Q
resonators. The plot is ﬁtted by the polynomial

0
i=−3 bif i, with

b0
−
b−1 −
b−2
b−3 −

155 dB
131 dB

124 dB

10−16
3.2
10−14
7.9
(not visible)

×
×

10−13

4
×

P
rad2/Hz
rad2/Hz

rad2/Hz

A preliminary interpretation the spectrum as follows.

40

E. Rubiola The Leeson eﬀect

February 2, 2008

b−3 =−124dBrad /Hz

2

b−1 =−131dBrad /Hz

2

Oscilloquartz OCXO 8600

=−155dBrad

2
/Hz

b0

t
s
1
-
d
o
m
-
0
0
6
8
-
a
s
o
-
e
l

Lf ’ =2.2Hz

cf ’ =250Hz

Figure 2.5: Phase noise of the oven-controlled quartz oscillator Oscillo-
quartz OCX0 8600, with a preliminary (wrong) interpretation. Courtesy
of Oscilloquartz S.A.
Interpretation, comments and mistakes are of the
author.

1. The white phase noise is b0 = 3.2

10−16 rad2/Hz (

155 dBrad2/Hz).

×

−

Thus

P0 =

F kT

b0 ≃

16 µW (

18 dBm) ,

−

assuming that F = 1 dB. This power level is consistent with the
general experience on 5–10 MHz oscillators, in which the power is
kept low for best stability.

250 Hz (from the plot), hence (b−1)ampli = 7.9

2. fc ≃
3. On the plot we observe that fL ≃

2.2 Hz (f ′

L in Fig. 2.5), and b−3 ≃

10−14.

×

10−13.

4
×
4. Q = ν0
2FL

, hence Q

1.1

106.

≃

×

February 2, 2008

E. Rubiola The Leeson eﬀect

41

resonator instability
b−3 =−124dBrad /Hz

2

Leeson effect (hidden)

Oscilloquartz OCXO 8600

sust. ampli + buffer
b−1 =−131dBrad /Hz

2

=−155dBrad

2
/Hz

b0

d
o
m
-
0
0
6
8
-
a
s
o
-
e
l

sustaining amplifier
b−1 =−136dBrad /Hz

2

Lf ’’=3.8Hz

Lf =1.4Hz
(guessed)

f =80Hz
c

Figure 2.6: Phase noise of the oven-controlled quartz oscillator Oscillo-
quartz OCX0 8600, with revised interpretation. Courtesy of Oscilloquartz
S.A. Interpretation, comments and mistakes are of the author.

The item 1 is correct because the eﬀect of the output buﬀer on the white
noise is divided by the gain of the sustaining ampliﬁer, thus it is negligible.
The white noise originates in the series resistance of the resonator and in
the sustaining ampliﬁer input. Conversely, the ﬂicker noise of the output
buﬀer is not negligible because it results from parametric modulation. Thus
we change the interpretation (Fig. 2.6) as follows.

1. Section 1.5.2 indicates that the eﬀect of the output buﬀer can not be
neglected if phase ﬂickering shows up in the phase-noise spectrum.
We guess that there are two stages between the sustaining ampliﬁer
and the output and that the 1/f noise of each stage is at least equal
to that of the sustaining ampliﬁer. Thus the 1/f noise of the sus-
taining ampliﬁer is not higher than 1/3 of the total noise. Let us
take away 5 dB. In reality, the diﬀerence could be more then 5 dB
because the output ampliﬁer can be more complex, and because su-

42

E. Rubiola The Leeson eﬀect

February 2, 2008

perior technology can be used in the sustaining ampliﬁer, rather than
in the buﬀers.

2. The new estimate of the ﬂickering of the sustaining ampliﬁer is
136 dBrad2/Hz). This aﬀects
(b−1)ampli = 2.5
the corner frequency and in turn the Leeson frequency. The new
values are

10−14 rad2/Hz (

−

×

fc ≃

80 Hz

and fL ≃

3.8 Hz (f ′′

L in Fig. 2.6). The latter is still provisional.

3. Using fL = 3.8 Hz in fL = ν0

2Q , we get Q

6.6

105.

≃

×

4. Q

6.6

literature suggests that the product ν0Q is between 1013 and 2

105 is a too low value for a top-technology oscillator. The
1013.

×

≃

×

5. Q is higher than value of 6.6

105. This means that the Leeson eﬀect
is hidden, and that we are not able to calculate Q. Henceforth, our
knowledge about Q relies only upon experience and on the literature.

×

6. If we guess Q = 2.5

106, reduced to Q = 1.8
dissipative eﬀect of the ampliﬁer input, we get

×

×

106 (loaded) by the

fL =

1.4 Hz

ν0
2Q ≈

1013
This indicates that the oscillator frequency ﬂicker b−3 ≃
is due to frequency ﬂickering in the resonator. The Leeson eﬀect
is hidden by the resonator instability and by the phase noise of the
output buﬀer. Thus, the corner frequency f ′′
3.8 Hz of Fig. 2.6 is
not the Leeson frequency.

L ≃

3.2

×

7. The ﬂicker noise of the sustaining ampliﬁer combined with the Leeson
frequency gives the stability limit of the electronics of the oscillator.
This is the solid line f −3 in Fig. 2.6, some 10 dB below the phase
noise.

February 2, 2008

E. Rubiola The Leeson eﬀect

43

8. The frequency ﬂicker turned into Allan variance (Table 1.1), is

σ2
y(τ ) = 2 ln(2) h−1 = 2 ln(2)

= 1.39

b−3
ν2
0

10−13
106)2 ,

4
×
(5
×

×

thus

σ2
y(τ )

2.2

10−26

≃

×

σy(τ )

1.5

10−13 .

≃

×

This is lower than the value σy(τ ) < 3
30 s.
given in the speciﬁcations. On the other hand, speciﬁcations are
conservative, while a sample can be better.

10−13 for 0.2 s

≤

≤

×

τ

2.5 FEMTO-ST prototype (10 MHz LD-cut

quartz)

The interest of the LD cut is the low isochronism defect ∆ν
ν0∆P , i.e., the
low dependence of frequency on the drive power [GBB02]. For comparison,
10−11 / µW (typical) for the popular
the isochronism defect can be of 1.2
×
SC-cut crystals, and as low as 10−11 / µW for the LD cut. This oscillator is
a laboratory prototype. It has been included in this Section otherwise de-
voted to commercial oscillators because we know some internal parameters,
for the analysis process is somewhat diﬀerent.

Figure 2.7 shows the phase noise spectrum. The spectrum is the total
noise obtained by comparing two equal devices, and divided by two. The
plot is ﬁtted by the polynomial

P

147 dB
130 dB

b0
−
b−1 −
b−2
b−3 −
We interpret the spectrum as follows.

116.6 dB

0
i=−3 bif i, with
10−15
10−13

2
×
1
×

(not visible)
10−12
2.2

×

rad2/Hz
rad2/Hz

rad2/Hz

1. The white phase noise is b0 = 2

147 dBrad2/Hz).
As we know the power at the ampliﬁer input, P0 = 340 µW, we

10−115 rad2/Hz (

−

×

z
H
2
d
a
r
B
d
 
 
 
 
 
)
f
(
 
ϕ
S

d
o
m
-
t
s
o
t
m
e
f
-
e
l

44

E. Rubiola The Leeson eﬀect

February 2, 2008

resonator instability
b−3=−116.6dBrad2/Hz

Leeson effect (hidden)
b−3=−122.2dBrad2/Hz

sustaining amplifier
b−1=−135dBrad2/Hz

FEMTO−ST prototype
LD cut, 10 MHz, Q=1.15E6

sust. ampli + buffer
b−1=−130dBrad2/Hz

3dB

3dB

apparent
b0=−147dBrad2/Hz

fL=4.3Hz
calculated

f’
L=8.9Hz
apparent

Fourier frequency, Hz

Figure 2.7: Phase noise of a FEMTO-ST oscillator prototype based on a
LD-cut resonator. Courtesy of the FEMTO-ST laboratory. Interpretation,
comments and mistakes are mine.

can calculate the noise ﬁgure F = b0
167 (+22 dB). This value
is far too high for the noise ﬁgure of a HF-VHF ampliﬁer, thus the
observed ﬂoor can not be the noise ﬂoor b0 of the oscillator. Therefore
we ascribe it to the white noise ﬂoor of the instrument, used at low
input power.

kT ≃

2. As b0 is hidden, the corner frequency fc of the ampliﬁer is also hidden.

3. The phase ﬂickering is clearly visible on a span of one decade. At
the corner frequencies, 5 Hz and 50 Hz, the diﬀerence between exper-
imental data and asymptotic approximation is of 3 dB as expected.
The residual noise of the instrument is not shown on the plot. Yet ex-
perience suggests that the value (b−1)osc = 10−13 is suﬃciently larger
than the noise of a HF-VHF mixer. This elements indicate that the
value (b−1)osc = 10−13 can be trusted.

February 2, 2008

E. Rubiola The Leeson eﬀect

45

4. From the plot, the frequency ﬂicker is b−3 = 2.2

10−12. We use it
to estimate the Leeson frequency, at which b−3f −3 = b−1f −1. There
results the value f ′

×

L = 8.9 Hz.

5. Let us assume that the sustaining ampliﬁer contributes 1/3 of the
total phase ﬂickering, guessing that there are two buﬀer stages (Sec-
tion 1.5.2) based on the same technology of the sustaining ampliﬁer.
There follows that (b−1)ampli = 3.16

10−13.

×

6. The merit factor of the resonator in the circuit load conditions is

known, Q = 1.15

106. The calculated Leeson frequency is

×

fL =

= 4.35 Hz .

ν0
2Q

This value suﬀers from the uncertainty with which we guess the phase
ﬂickering of the sustaining ampliﬁer as a fraction of the total phase
ﬂickering. Nonetheless, the buﬀer is necessary, which ensures that
only a fraction of the phase ﬂickering is due to the sustaining ampliﬁer.

7. The calculated Leeson frequency (4.35 Hz) is suﬃciently lower than
the apparent value (8.9 Hz) to provide evidence that the Leeson eﬀect
is not visible on the spectrum, and that the 1/f 3 line is the frequency
ﬂickering of the resonator.

8. The frequency ﬂicker turned into Allan variance (Table 1.1), is

σ2
y(τ ) = 2 ln(2) h−1 = 2 ln(2)

b−3
ν2
0

= 2

×

10−12
106)2 ,

2.2
(10

×
×

hence

σ2
y(τ )

10−26

3
×

≃

σy(τ )

1.74

10−13 .

≃

×

9. The total 1/f 3 noise results from the ampliﬁer noise through the

Leeson eﬀect and from resonator frequency ﬂickering

(b−3)osc = (b−3)Le + (b−3)reson .

(2.5)

46

E. Rubiola The Leeson eﬀect

February 2, 2008

Thus we can infer and the resonator stability

σ2
y(τ ) = 2 ln(2)

(b−3)osc
ν2
0

−

(b−3)Le
ν2
0 (cid:19)

(cid:18)

The numerical result

σ2
y(τ )

2.2

10−26

≃

×

σy(τ )

1.5

10−13 .

≃

×

should be taken as an indication only, rather than as a measure,
because it suﬀers from uncertainty enhancement of the diﬀerence,
and from the lack of reliable measurement of the sustaining ampliﬁer.

Remark 2.1 This example provides a method for the independent mea-
surement of the resonator stability. The accurate measurement of the am-
pliﬁer ﬂicker (b−1)ampli and of the merit factor Q in the appropriate load
conditions turns into a reliable measure of fL and of (b−3)Le to be fed in
N
Eq. 2.5.

2.6 Wenzel 501-04623 (100 MHz SC-cut quartz)

The Wenzel 501-04623 oscillator is chosen as an example because of its
outstanding low phase noise ﬂoor, and because of its high carrier frequency
(100 MHz). These two features are necessary for low noise after frequency
multiplication. A table of the values of phase noise is given by the manu-
facturer, instead of the complete spectrum. These values are used to plot
the spectrum (Fig. 2.8)

−

b0
b−1
b−2
b−3 −

173 dB

97 dB

10−18

5
×

(not visible)
(not visible)

10−10

2
×

rad2/Hz

rad2/Hz

and to interpret it as follows.

−100

−110

−120

−130

−140

−150

−160

−170

−180

z
H
/
2
d
a
r
B
d
 
,
e
s
i
o
n
 
e
s
a
h
P

February 2, 2008

E. Rubiola The Leeson eﬀect

47

−30dB/dec
b−3 =−97 dBrad2/Hz

Wenzel 501−04623
specifications

Leeson effect (hidden)
is about here

ampli noise (?)

b0=−173

dBrad2/Hz

l
e
z
n
e
w
y
m
-
e
l

101

102

guess

Q=8x104 =>

f

L =625Hz

103

104

f ’
L =3kHz

105

Fourier frequency, Hz

Figure 2.8: Phase noise of the 100 MHz oscillator Wenzel 501-04623. Data
are from the manufacturer web site. Interpretation, comments and mistakes
are mine.

1. The white phase noise is b0 = 5

10−17 rad2/Hz (

173 dBrad2/Hz).

Thus

×

−

1 mW (0 dBm) ,

P0 =

F kBT

b0 ≃

assuming that F = 1 dB. This relatively large power is necessary for
low short-term noise, although it may be detrimental to the medium-
term and long-term stability.

2. The terms b−2f −2 and b−1f −1 are virtually absent, as there is no
room for them in the region between the two speciﬁed points, 1 kHz
and 10 kHz. A conﬁrmation comes from the measurement of some
samples. Consequently, the point at which the slope changes by 2
f −3) is not visible. This indicates that
(either f 0

f −2 or f −1

→

→

48

E. Rubiola The Leeson eﬀect

February 2, 2008

the Leeson eﬀect is hidden by the frequency ﬂicker of the resonator.

3. Of course, the corner point between the ﬂicker of frequency and the
L in Fig. 2.8),

white noise, b−3f −3 = b0, which occurs at f = 3 kHz (f ′
is not the Leeson frequency.

4. As the Leeson eﬀect is hidden, we are not able to calculate Q. Relying
upon the literature, we can guess that a high-stability 100 MHz quartz
104
resonator can have a merit factor of 1.2
(loaded) by the power dissipation at the ampliﬁer input. Accordingly,
the Leeson frequency is

105, reduced to Q = 8

×

×

FL =

625 Hz .

ν0
2Q ≃

3.2

5. The ﬂicker noise of a state-of-the-art HF/VHF ampliﬁer

is
135 dBrad2/Hz). This value,
(b−1)ampli ≈
combined with the Leeson frequency, gives the stability limit of the
electronics of the oscillator. This is the dashed line f −3 in Fig. 2.8,
some 10 dB below the phase noise.

10−14 rad2/Hz (

×

−

6. The frequency ﬂicker turned into Allan variance (Table 1.1), is

σ2
y(τ ) = 2 ln(2) h−1 = 2 ln(2)

= 1.39

b−3
ν2
0

2
×
(100

10−10
106)2 ,

×

×

thus

σ2
y(τ )

2.8

10−26

≃

×

σy(τ )

1.7

10−13 .

≃

×

2.7 Oewaves Tidalwave (10 GHz OEO)

The unique feature of the opto-electronic oscillator (OEO) is that the fre-
quency reference is an optical delay line instead of a traditional resonator.
The basic structure consists of a loop in which the microwave sinusoid
modulates a laser beam. After traveling through a long optical ﬁber, the

February 2, 2008

E. Rubiola The Leeson eﬀect

49

b−4 =+11

dBrad2/Hz

~~fL 7kHz ?
(wild guess)

b−3 =−21

dBrad2/Hz

~~b0 −138

dBrad2/Hz

b−2 =??

d
o
m
-
o
e
o
-
w
e
o
-
e
l

Figure 2.9: Phase noise spectrum of the Oewaves Tidalwave photonic os-
cillator Courtesy of Oewaves Inc. Interpretation, comments and mistakes
are of the author.

microwave signal is reconstructed by a high-speed photodetector, and fed
back into the ampliﬁer. Yet the actual structure may be more complex.
Beside laboratory prototypes, Oewaves is up to now the only one manufac-
turer of this type of oscillator. Studying the noise in oscillators, this is a
challenging example because the general experience earned with traditional
oscillators is of scarce usefulness. The phase noise spectrum (Fig; 2.9) is
ﬁtted by the polynomial

0
i=−3 bif i, with

−

138 dB
P

b0
b−1
b−2
21 dB
b−3 −
b−4 +11 dB

×

10−14
1.6
(not visible)
(not visible)

7.9
×
1.26

10−3
101

×

rad2/Hz

rad2/Hz
rad2/Hz

1. In a delay-line oscillator with a delay τ we expect (Chapter 4) a
“clean” comb of spectral lines at fi = i/τ , integer i
1. This struc-
ture is not present in the spectrum of Fig; 2.9. Instead, there is a

≥

50

E. Rubiola The Leeson eﬀect

February 2, 2008

series of smaller bumps and spectral lines. This indicates that the
Tidalwave is not a simple delay-line oscillator, and that it contains
some additional circuits that reduce or almost eliminate the spectral
lines at fµ = µ/τ , integer µ. The remedy suggested by the literature
is the dual-loop oscillator, in which a second delay line, signiﬁcantly,
is used to remove the largest peaks. One conference article [EM03]
provides some interesting details, yet insuﬃcient to identify clearly
the inside of this speciﬁc oscillator.

2. The right-hand side of the spectrum, in the white-noise region, an
horizontal b0 is only a poor approximation of the spectrum. This is
inherent in the delay-line oscillator. Discarding the peaks, we take
b0 ≈

138 dBrad2/Hz).

10−14 rad2/Hz (

1.6

×

−

3. The equivalent noise ﬁgure used to estimate the microwave power
must be referred to the lowest-power point of the circuit, which is
the output of the photodetector. Noise includes at least the intensity
ﬂuctuation of the laser, the shot noise, and the noise of the microwave
ampliﬁer. Let us guess that F = 6 dB. Consequently, the microwave
power P0 = F kT
30 dBm).
b0

at the phodetector output is P0 = 1 µW (

−

4. One may think that the transition f −3

f 0 around f = 7 kHz is the
signature of the frequency ﬂicker of the reference, as in the Wenzel
quartz oscillator. Yet an alternate interpretation is possible in this
case because fc and fL might be close to one another and fall in this
region.

→

5. A corner frequency fc ≈

10−14 rad2/Hz requires
100 dBrad2/Hz). The latter value can
that b−1 = 10−10 rad2/Hz (
be ascribed to the microwave ampliﬁer (Tab. 1.2), or to the optical
system.

7 kHz with b0 ≈

1.6

−

×

6. The delay τ is related to the Leeson frequency by fL = 1
2πτ Thus
23 µs, hence a ﬁber length l = c
4.7
n τ

7 kHz requires that τ

fL ≈
km, which is likely.

≈

≈

February 2, 2008

E. Rubiola The Leeson eﬀect

51

7. The f −3

→

f 0 transition at f

7 kHz can be ascribed either to the
fL, or to the ﬂickering of the delay. The analysis of

≈

fact that fc ≈
the spectrum is not suﬃcient to say more.

8. The frequency ﬂicker and random walk, turned into Allan variance

(Table 1.1), is

σ2
y(τ ) = 2 ln(2) h−1 +

h−2τ

4π2
6
4π2
b−3
ν2
6
0
10−3
7.9
(1010)2 +
×

+

τ

b−4
ν2
0
4π2
6 ×

= 2 ln(2)

= 1.39

×

12.6
(1010)2 τ ,

thus

σ2
y(τ )
σy(τ )

≃

≃

1.1

×
1.05

10−22 + 8.3
10−11 + 9

10−18 τ
×
10−9 √τ

×

×

52

E. Rubiola The Leeson eﬀect

February 2, 2008

Chapter 3

Phase noise and linear feedback theory

Figure 3.1 proposes a model for the oscillator loop in the domain of the
Laplace transforms. The ampliﬁer of gain A (constant) and feedback path
β(s) are the blocks we are familiar with. The signal Vi(s) at the input of the
summer Σ allows initial conditions and noise to be introduced in the loop.
Interestingly, if Vi(s) is a driving signal, Fig. 3.1 models for the injection-
locked oscillator. Figure 3.1 diﬀers form the classical control theory in
that the at the feedback input of Σ positive, and in that the output is
taken at the ampliﬁer input instead of at the output. This choice simpliﬁes
some equations without aﬀecting the phase noise. The elementary feedback
theory tells us that the transfer function is

H(s) =

def. of H(s)

(3.1)

is

H(s) =

Fig. 3.1 .

(3.2)

From this standpoint, an oscillator is a system that has (at least) a pair
of imaginary conjugate poles, excited with suitable initial conditions. One
may also interpret frequency stability as the stability of the poles. We
ﬁrst study the properties of Eq. (3.2) when β(s) is the transfer function

Vo(s)
Vi(s)

1
Aβ(s)

1

−

53

54

E. Rubiola The Leeson eﬀect

February 2, 2008

Vi (s)

+

Σ
+

p
o
o
l
-
e
l

out

Vo(s)

oV’

(s)

oscill.
out

noise
free

A

resonator
(s)β

Figure 3.1: Oscillator loop.

of a simple resonator, ruled by a second-order diﬀerential equation. Then,
we extend the analysis to the phase space in the Laplace domain, which
describes phase noise.

3.1 Oscillator and Laplace transforms

The normalized transfer function of a resonator (Appendix A) is

β(s) =

ω0
Q

s
sp)(s

(s

−

s∗
p)

−

resonator

poles 


sp = σp + jωp
s∗
jωp
p = σp −
σ2
p + ω2
p = ω2
0

By replacing β(s) in Eq. (3.2), we get



H(s) =

(s

(s
−
sp)(s

sp)(s
−
s∗
p)

s∗
p)
A ω0

Q s

−
The above H(s) = N (s)
D(s) is a second-order rational function with real coeﬃ-
cients. It has two poles, either real or complex conjugates, depending on the
gain A. The root locus, shown in Figure 3.2, has the following properties.

−

−

1. The poles are imaginary conjugates for A = 1.

2. The poles are complex conjugates for 1

σp =

−

ω0
2Q ; real elsewhere.

ω0
σp

< A < 1 + ω0
σp

, with

−

(3.3)

(3.4)

February 2, 2008

E. Rubiola The Leeson eﬀect

55

A − Phase transfer function H(s)

B − Root locus of the denominator of H(s)

constant zeros

poles function of A

j ω

A=0
open loop

A=1

oscillation

ω

j

n
i
a
g

 
t
n
e
i
c
i
f
f
u
s
n
i

n
i
a
g
 
e
v
i
s
s
e
c
x
e

increasing A

A=1−

ω0
σp

σ

n
i
a
g

 
t
n
e
i
c
i
f
f
u
s
n
i

n
i
a
g
 
e
v
i
s
s
e
c
x
e

A=1+

ω0
σp

σ

e
l
c
r
i
c
-
e
l

A=0

A=1

Figure 3.2: A: Noise transfer function H(s) [Eq. (3.4)], and B: root locus
of the denominator of H(s), as a function of the gain A.

3. The complex conjugate poles are on a circle of radius ω0 centered in

the origin.

The proof is given underneath.

Property The poles are imaginary conjugates for A = 1.

Proof. W e ﬁrst rewrite the denominator

(s) in a more convenient form

(s) = (s

sp)(s

D

s∗
p)

−

−

D
ω0
Q

A

s

−

−

−

−

= (s

= (s

= s2

A

ω0
Q

s

−

σp −
p) + ω2
σ2

jωp)(s

σp + jωp)

−

ω0
p −
Q
p + ω2
2σps + σ2
p + 2Aσps

A

s

56

E. Rubiola The Leeson eﬀect

February 2, 2008

and ﬁnally

(3.5)

(3.6)

(s) = s2 + 2σp(A

1)s + ω2
0

−

D

To obtain the above, we have used the properties σ2

ω0
2Q . The poles of H(s) are the solutions of

p + ω2
(s) = 0, thus

p = ω2

0, and σp =

−

s1, s2 =

σp(A

−

1)

−

±

σ2
p(A

1)2

ω2
0

−

−

D

q

Condition for stationary oscillation. Stationary oscillation requires that
the poles are imaginary conjugates

A = 1

which yields

s =

jω0

±

This is obtained by replacing A = 1 in Eq. 3.5. The discriminator

reduces to

ω2

0, and the real part

−

= σ2

p(A

∆

D

1)2

ω2
0

−

−
σp(A

−

Property The poles are complex conjugates for 1
σp =

ω0
2Q ; real elsewhere.

−

−

1) of the solutions s1, s2 vanishes.
N

ω0
σp

< A < 1 + ω0
σp

, with

Proof. The poles of (3.4) are complex conjugates when the discriminator
∆

< 0, thus

−

D

We ﬁrst solve ∆

= 0, which yields

D

σ2
p(A

1)2

−

−

ω2

0 < 0 .

A1, A2 = 1

ω0
σp

.

±

As the coeﬃcient of A in ∆

is positive, we conclude that

D
< 0

∆

D

for A1 < A < A2 .

February 2, 2008

E. Rubiola The Leeson eﬀect

57

The poles of H(s) are real coincident when ∆

= 0. We replace A = A1

D

and A = A2 in

D

s2 + 2σp

1

±

(cid:18)

ω0
σp −

1
(cid:19)

+ ω2

0 = 0 .

Hence the poles are real coincident for s2 + 2ω0s + ω2

0 = 0, thus

s3, s4 =

ω0 .

±

Property The complex conjugate poles are on a circle of radius ω0 centered
in the origin.

Proof. The complex conjugate solutions of

= 0 are

D

s =

σp(A

−

1)

j

±

−

ω2

0 −

σ2
p(A

−

1)2 .

(3.7)

q
This is an alternate form of Eq. (3.6), which makes the square root real
when ∆

< 0. The square distance R2 of the poles from the origin is

D

R2 = [

(s)]2 + [

ℜ
= σ2
p(A

−

(s)]2
ℑ
1)2 + ω2

σ2
p(A

1)2 ,

−

0 −

which simpliﬁes as

R2 = ω2
0.

N

(3.8)

N

Remark 3.1 That the poles of H(s) are on a circle centered in the origin
has an important consequence in metrology.
In the real world the gain
ﬂuctuates around the value A = 1. For small ﬂuctuations of A, the poles
ﬂuctuate perpendicularly to the imaginary axis. The eﬀect on the oscilla-
N
tion frequency is of the second order only.

58

E. Rubiola The Leeson eﬀect

February 2, 2008

phase impulse in
the voltage domain

cos[

ωt+

δ

(t)

]

phase impulse in
the phase domain

δ (t)

resonator

resonator

phase impulse in
the voltage domain

cos[

ωt+

U(t)]

resonator

β (t)

b(t)

β

(t)

U

phase step in
the phase domain

U(t)

resonator

bU(t)

=

b(t) dt

Figure 3.3: Resonator response to a phase impulse δ(t).

e
s
n
o
p
s
e
r
-
e
s
a
h
p
-
e
l

Remark 3.2 The exact condition A = 1 can not be ensured without a
gain control mechanism. The latter can be interpreted as a control that
stabilizes the oscillator poles onto the imaginary axis.

The gain control can be a feedback that sets A for the output voltage
to be constant. This approach was followed in early times of electronics
in the Wien bridge oscillator [Pac39]. Yet ampliﬁer saturation proved to
be an eﬀective amplitude control, even in ultra-stable oscillators. When
the ampliﬁer saturates, the output signal is clipped more or less smoothly.
Power leakage from the fundamental to the harmonics reduces the gain,
and in turn stabilizes the output amplitude. The resonator prevents the
N
harmonics from being fed back to the ampliﬁer input.

3.2 Resonator in the phase space

We analyze the resonator phase response b(t), and its Laplace transform
B(s), in quasi-stationary conditions. The resonator is driven with a sinu-
soidal signal at the frequency ω, which can be the natural frequency ω0 or

February 2, 2008

E. Rubiola The Leeson eﬀect

59

any other frequency. In the time domain, the phase transfer function b(t)
is the phase of the resonator response to a Dirac δ(t) function in the phase
of the input. More precisely, b(t) is deﬁned as follows (Fig. 3.3)

vi(t) = cos[ω0t + δ(t)]
vo(t) = cos[ω0t + b(t)]

input with phase impulse

output response, deﬁnes b(t) .

We ﬁnd b(t) from the response bU (t) to the Heaviside function (unit step)

U (t) =

δ(t)dt =

Heaviside

(3.9)

∞

−∞

Z

0 t < 0
1 t > 0

(

using the property of linear systems that the impulse response is the deriva-
tive of the step response bU (t)

d
dt
We calculate the response in small signal conditions, using a phase step
0, so that some functions can be linearized. This is physically
κU (t), κ
correct because phase noise in actual oscillators is a small signal.

bU (t) .

b(t) =

(3.10)

→

The method (Fig. 3.4) consists of breaking the input sinusoid vi(t) at

the time t = 0
vi(t) = v′
v′
i(t) = vi(t)U (
−
v′′
i (t) = vi(t)U (t)

i(t) + v′′
i (t)
t)

vo(t) = v′
v′
o(t)
i(t), for t > 0
v′′
i (t), for t > 0 ,
o (t)
so that the phase step κU (t) can be introduced in the phase of v′′
terms v′
transient response for t > 0.

i (t). The
o(t) and v′′(t) are, respectively, the switch-on and the switch-oﬀ

o(t) + v′′
o (t),
response to v′
response to v′′

output, for t > 0

3.2.1 Input signal tuned at the exact natural frequency

Property The impulse response of the resonator in the phase space is

b(t) =

e−t/τ

1
τ

impulse
response

(3.11)

60

E. Rubiola The Leeson eﬀect

February 2, 2008

v’I (t)

v’’I (t)

initial phase κ

t

t

t

t

v’

O(t)

v(t)

envelope

τ

p
e
t
s
-
e
s
a
h
p
-
e
l

v’’O

(t)

v(t)

envelope

τ

Figure 3.4: A sinusoid with a phase step can be decomposed into a sinusoid
switched oﬀ, plus a shifted sinusoid switched on. The step response is the
linear superposition of the two responses.

and its Laplace transform is

B(s) =

1
sτ + 1

transfer
function

(3.12)

Proof. Let

vi(t) = cos

ω0t + κU (t)

= cos(ω0t)U (
(cid:2)

−

(cid:3)

t) + cos(ω0t + κ)U (t)

the input signal. The resonator response v′
is the exponentially decaying sinusoid

o(t) to the sinusoid switched oﬀ

o(t) = cos(ω0t)e−t/τ
v′

t > 0 ,

where τ = 2Q
ω0
the response v′′

is the resonator relaxation time (Appendix A). Similarly,
o (t) to the switched-on sinusoid is the exponentially growing

February 2, 2008

E. Rubiola The Leeson eﬀect

61

sinusoid

v′′
o (t) = cos(ω0t + κ)

1

e−t/τ

t > 0 .

−

(cid:2)

(cid:3)

The total output signal is

vo(t) = v′

o(t) + v′′
o (t)
= cos(ω0t)e− t
e− t

= cos(ω0t)
h

→

t > 0

τ +

cos(ω0t) cos(κ)

sin(ω0t) sin(κ)

1

h

τ + cos(κ)

cos(κ)e− t

τ

−

−

ih

−
sin(ω0t) sin(κ)
h

−

i

e− t

τ

1

−

i
e− t

τ

.

i

For κ

0 we replace cos(κ) = 1 and sin(κ) = κ, thus

vo(t) = cos(ω0t)

κ sin(ω0t)

1

−

e−/τ

−

Deleting ω0t, the above can be seen as a slowly varying phasor

(cid:2)

(cid:3)

Vo(t) = 1 + jκ

1

e−t/τ

−

κ

1 .

≪

The angle arctan ℑ{Vo(t)}

ℜ{Vo(t)} , normalized on κ, is the step response

(cid:2)

(cid:3)

bU (t) = 1

e−t/τ

−

step response

Taking the derivative, we obtain the impulse response

b(t) =

e−t/τ ,

1
τ

(3.13)

which is Eq. (3.11). The Laplace transform [Eq. (3.12)] is found in common
N
mathematical tables. The proof is omitted.

3.2.2 Detuned input signal

Property The step response of the resonator in the phase space is

bU (t) = 1

cos(Ωt)e−t/τ

−

step response
(Fig. 3.5)

,

(3.14)

62

E. Rubiola The Leeson eﬀect

February 2, 2008

Step response b_u(t)

tau=1

Omega=2

Omega = 0, 0.5, 1, 1.5, 2

Omega=0

1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

u
b
-
c
l
a
c
-
e
l

1

2

3

4

5

time

Figure 3.5: Step response bU (t) evaluated for τ = 1.

and the impulse response impulse is

b(t) =

Ω sin(Ωt) +

cos(Ωt)

e−t/τ

1
τ

i

h

where

impulse response
(Fig. 3.6)

,

(3.15)

Ω = ω1 −

ω0

def. of Ω .

(3.16)

is the frequency oﬀset (or detuning), i.e., the diﬀerence between the oper-
ating frequency ω1 and the natural frequency ω0 of the resonator.

) to the detuned input
Proof. The resonator asymptotic response (t
= ω0, is vo(t) = V∞ cos(ω1t + φ), with V∞ and
sinusoid vi(t) = cos(ω1t), ω1 6
φ constants (cfr. Appendix A, p. 105). Without loss of generality, we can
scale and shift the input signal

→ ∞

vi(t) =

cos(ω1t

φ) ,

−

1
V∞

February 2, 2008

E. Rubiola The Leeson eﬀect

63

Impulse response b(t)

tau=1

Omega=2

0.5

Omega=0

Omega = 0, 0.5, 1, 1.5, 2

1.5

1

0

b
-
c
l
a
c
-
e
l

-0.5

0

1

2

3

4

5

time

Figure 3.6: Impulse response b(t) evaluated for τ = 1.

in order to get the asymptotic response of the form

vo(t) = cos(ω1t)

t

.

→ ∞

We use the method of the small phase step κU (t). Yet we need some
preliminary results before introducing the step.
Input signal switched oﬀ at the time t = 0. The input signal

v′
i(t) =

1
V∞

cos(ω1t

φ)U (

t) ,

−

−

switched oﬀ at t = 0 by U (

t), yields the output

−

o(t) = cos(ω0t)e−t/τ
v′

t > 0 .

(3.17)

64

E. Rubiola The Leeson eﬀect

February 2, 2008

Input switched on at the time t = 0.
equation theory that, in the presence of the input signal

It is known from the diﬀerential

v′′
i (t) =

1
V∞

cos(ω1t

φ)U (t)

−

switched on at t = 0 by U (t), the output is of the form

o (t) = a cos(ω0t)e− t
v′′

τ + b sin(ω0t)e− t

τ + c cos(ω1t) + d sin(ω1t)

t > 0

with a, b, c, and d constants to be determined. As for t
it holds
that vo(t) = cos(ω1t), we conclude that c = 1 and d = 0. Then, a and
b are found by assessing the continuity of the output at t = 0 when the
input signal is vi(t) = 1
φ). The continuity condition is met for
1 and b = 0.
a =

V∞ cos(ω1t

→ ∞

−

−
In summary, it holds the following input-output relationship

(3.18)

(3.19)

in/out pair

i (t) = 1
v′′
v′′
o (t) =

−

V∞ cos(ω1t

φ)U (t)

−

cos(ω0t)e−t/τ + cos(ω1t)

U (t)

(cid:2)
and, as an obvious extension,

(cid:3)

in/out pair

i (t) = 1
v′′
v′′
o (t) =

−

V∞ sin(ω1t

φ)U (t)

−

sin(ω0t)e−t/τ + sin(ω1t)

U (t)

(cid:2)
Phase step at t = 0. Let us deﬁne the input signal vi(t) = v′

(cid:3)

i(t) + v′′

i (t)

v′
i(t) = 1
v′′
i (t) = 1

V∞ cos(ω1t
V∞ cos(ω1t

φ)U (

t)

−
φ + κ)U (t)

−

−

κ

1 .

≪

The input v′′

i (t) can be rewritten as

v′′
i (t) = 1
V∞
= 1
V∞

cos(ω1t

φ) cos κ

sin(ω1t

φ) sin κ

U (t)

−

−

φ)

−

−
κ sin(ω1t

−
φ)

U (t)

κ

(cid:3)

≪

1 .

cos(ω1t
(cid:2)

(cid:2)

−

(cid:3)

February 2, 2008

E. Rubiola The Leeson eﬀect

65

Using Eq. (3.17) and the pairs (3.18) and (3.19), we get the output signal

vo(t) = v′

o(t) + v′′
o (t)
= cos(ω0t)e−t/τ
+

cos(ω0t)e−t/τ + cos(ω1t)
−
sin(ω0t)e−t/τ
sin(ω1t)

−

(cid:3)

(cid:3)

+ κ
(cid:2)

(cid:2)

hence

t > 0
response to v′
i
response to v′′
i , 1st part
response to v′′
i , 2nd part

vo(t) = cos(ω1t)

κ sin(ω1t) + κ cos(ω0t)e−t/τ

t > 0 .

(3.20)

−
Let us deﬁne the detuning frequency Ω = ω1 −
Ω, hence sin(ω0t) = sin(ω1t
ω0 = ω1 −

−
sin(ω0t) = sin(ω1t) cos(Ωt)

ω0 Accordingly, it holds that

Ωt), and consequently

cos(ω1t) sin(Ωt) .

−

The output signal (3.20), written in terms of ω1 and Ω, is

vo(t) = cos(ω1t)

κ sin(ω1t)+

−
+ κ sin(ω1t) cos(Ωt)e− t

τ

κ cos(ω1t) sin(Ωt)e− t

τ

−

which simpliﬁes as

vo(t) = cos(ω1t)
h

1

−

κ sin(Ωt)e− t

τ

cos(Ωt)e− t

τ

. (3.21)

1

κ sin(ω1t)
h

−

i

−

i

Output phase response. Freezing the oscillation ω1t, the output signal (3.21)
turns into a slow-varying phasor

Vo(t) = 1 + jκ

1

cos(Ωt)e−t/τ

κ

1.

≪

−

(cid:2)

The angle arctan ℑ{Vo(t)}

ℜ{Vo(t)} , normalized on κ, is the phase-step response

(cid:3)

bU (t) = 1

cos(Ωt)e−t/τ

−

step response
(Fig. 3.5)

.

66

E. Rubiola The Leeson eﬀect

February 2, 2008

Using the property b(t) = d

dt bU (t) [Eq. (3.10)], we ﬁnd the impulse response

b(t) =

Ω sin(Ωt) +

cos(Ωt)

e−t/τ

h

i

1
τ

impulse response
(Fig. 3.5)

.

N

Remark 3.3 In some unusual cases, a resonator may need a pump signal,
for the measurement of the resonator parameter is diﬃcult or impossible
if the resonator is not in the oscillator loop. This occurs in the domain
of photonics with the coupled opto-electronic oscillator (COEO) [YM97].
In such case the phase step introduced in the oscillator loop proved to be
a useful method for the measurement of the resonator parameters. A mi-
crowave phase modulator (varactor) was inserted in series to the resonator
N
and driven with a square-wave generator at a low frequency.

Property The phase transfer function of the resonator in the presence of
a detuned driving signal is

B(s) =

1
τ

(cid:0)

s + 1
jΩ

τ + Ω2τ
s + 1

τ + jΩ

s + 1

τ −

(cid:1) (cid:0)

(cid:1)

transfer function
(Fig. 3.7 and 3.8)

.

(3.22)

Proof. The Laplace transform B(s) =
identities

L

b(t)

is found using the Euler

and the properties of the Laplace transform

cos(Ωt) = 1
2
sin(Ωt) = 1
(cid:0)
j2

(cid:9)
(cid:8)
ejΩt + e−jΩt
e−jΩt
ejΩt
(cid:1)

−

(cid:0)

(cid:1)

e−t/τ

L
(cid:8)
(cid:9)
eatf (t)

=

1
s + 1/τ

= F (s

a) .

−

L

(cid:8)

(cid:9)

February 2, 2008

E. Rubiola The Leeson eﬀect

67

A − resonator duned

B − resonator detuned

resonator
tuned at

ω0

B(s)

ω

j

resonator
detuned by

Ω<<ω0

B(s)

j ω

−ω

L

+Ω

−Ω

σ

σ

−ω

L

−ω

L

(1+Ω2

τ2)

Figure 3.7: Phase noise transfer function B(s) on the Laplace plane.

b
g
i
b
-
e
n
a
l
p
l
-
e
l

Thus

B(s) =

ejΩt

e−jΩt

+

ejΩt + e−jΩt

e−t/τ

Ω

1
j2

L

nh

(cid:0)

−

1
τ

1
2

(cid:1)

(cid:0)

(cid:1)i

o

and ﬁnally

B(s) =

1
τ

(cid:0)

s + 1
jΩ

τ + Ω2τ
s + 1

τ + jΩ

s + 1

τ −

(cid:1) (cid:0)

(cid:1)

transfer function
(Fig. 3.7 and 3.8)

.

Remark 3.4 The phase noise bandwidth of the resonator increases when
the resonator is detuned (Fig. 3.8). This is related to the following two
interesting facts.

1. At ω

= ω0, the slope

is lower than at ω0 (Fig. A.1).
Hence, oﬀ the exact resonance, the resonator becomes less dispersive.
(cid:12)
(cid:12)
(cid:12)

2. The step response is faster when the resonator is detuned, as it is seen

(cid:12)
(cid:12)
(cid:12)

d arg[β(jω)]
dω

in Fig. 3.5.

N

N

6
68

E. Rubiola The Leeson eﬀect

February 2, 2008

Phase transfer function |B(jomega)|^2

tau=1  ->  omega_L=1
Omega =
[0, 0.5, 1, 1.5, 2] omega_L

Omega=2omega_L

1.5

2

1

0.5

Omega=0

0

0

omega

1

2

3

4

5

b
g
i
b
-
c
l
a
c
-
e
l

2 [Eq. (3.22)] evaluated
Figure 3.8: Phase noise transfer function
B(jω)
|
|
for τ = 1, thus ωL = 1. We observe that the transformation τ = 1
2π instead
of τ = 1 (hence fL = 1), Ω
f , lets the plot
2π = ν1 −
unchanged. In other words, if the resonator Leeson frequency is the fL = 1
and one reads f instead of ω on the horizontal axis, the curves are the phase
2 of the resonator tuned, detuned by 1
B(jf )
response
|
|

2 fL, by fL, etc.

ν0, and ω

→

→

Ω

3.3 Another derivation of the resonator phase re-

sponse

The low-frequency phase transfer function of the resonator is

(jω) =

H

1
H(jω1)

2

|

| h

H(j(ω

−

ω1)) + H(j(ω + ω1))
i

(3.23)

The derivation1 of the resonator phase response given here is more general
than that shown in Section 3.2, which holds only for resonator.

1Thanks to Charles (Chuck) Greenhall, JPL, Pasadena, CA.

February 2, 2008

E. Rubiola The Leeson eﬀect

69

Proof. Let h(t) the voltage impulse response of the resonator and H(jω)
its Fourier transform. Let vi(t) = cos[ω1t + θ + ϕ(t)] the input voltage. The
output voltage is

vo(t) = (h

vi)(t)

convolution

h(u)vi(u) du

∗
∞

=

=

=

Z

−inf ty
∞

ℜ

−∞

(cid:26)Z

ℜ

(cid:26)

h(u)ej[ω1(t−u)+θ+ϕ(t−u)] du

ej(ω1t+θ)

h(u)ej[−ω1u+ϕ(t−u)] du

∞

−∞

Z

(cid:27)

(cid:27)

Linearize for ϕ

1

≪

∞

vo(t) =

ej(ω1t+θ)

h(u)e−jω1u [1 + jϕ(t

u)] du

ℜ

(cid:26)

ℜ

(cid:26)

−∞

Z
H(jω1) + j

(cid:20)

∞

−∞

Z

=

ej(ω1t+θ)

h(u)e−jω1uϕ(t

(cid:27)
u) du

−

(cid:21)(cid:27)

Replace H(jω1) = H1ejα1

vo(t) =

ej(ω1t+θ)

H1ejα1 + j

h(u)e−jω1uϕ(t

u) du

∞

ℜ

(cid:26)

(cid:20)
ej(ω1t+θ)H1ejα1

−∞

Z

∞

1
H1ejα1

1 +

(cid:20)

−∞

Z

=

ℜ

(cid:26)

h(u) je−j(ω1u+α1)ϕ(t

u) du

(cid:21)(cid:27)

−

(cid:21)(cid:27)

Observe that je−j(ω1u+α1) = sin(ω1u + α1) + j cos(ω1u + α1). Deﬁne

−

−

hc(t) = h(t) cos(ω1u + α1)
hs(t) = h(t) sin(ω1u + α1)

Thus

vo(t) =

ej(ω1t+θ)H1ejα1

(cid:26)
1 +

ℜ

(cid:20)

∞

−∞

1
H1 Z

hs(u)ϕ(t

u) du + j

−

∞

−∞

1
H1 Z

hc(u)ϕ(t

u) du

−

(cid:21)(cid:27)

70

E. Rubiola The Leeson eﬀect

February 2, 2008

Use 1 + a + jb

vo(t) =

ℜ

(cid:26)

≈

(1 + a)ejb for small a and b
(hs ∗
H1

ej(ω1t+θ+α1)H1ejα1H1

1 +

ϕ)(t)

(cid:20)

Taking α1 = 0, the equivalent ﬁlters are

ϕ)(t)

(hc ∗
H1

exp

j

(cid:21)

(cid:20)

(cid:21)(cid:27)

AM:

hs(t)
H1 ∗

PM:

hc(t)
H1 ∗

From cos(x) = 1
2

ejx + e−jx

it follows that

(cid:2)

(cid:3)
hc(t) =

ejx + e−jx

h(t)

1
2

h

i

Consequently

(jω) =

H

1
2H1

h

H(j(ω

−

ω1)) + H(j(ω + ω1))
i

which is equivalent to Eq. (3.23).

N

H

(s) translated by

Remark 3.5 Eq. (3.23) states that the poles (and the zeros, if any) of
ω1. H(s) has (at least) a pair of
H(s) appear in
ω0. A copy
complex conjugate poles on the left-hand half-plane at about
(s) translated close to the real axis. Another copy
of them is present in
translated in the opposite direction is present in
2ω1. This
second copy should be discarded because it results from the approximations
taken. Anyway, questioning about the phase noise at a “close-in” frequency
N
twice the carrier frequency is a nonsense.

(s), about

H

H

±

±

±

Remark 3.6 If ω1 6
= ω0, the resonator natural frequency, there results
a zero on the real axis, in the negative half plane. This is still to be
N
demonstrated with the formalism of this Section.

Property The resonator converts phase noise into amplitude noise. The
transfer function of this process is

HX(jω) =

1
H(jω1)

2

|

| h

H(j(ω

ω1)

−

−

H(j(ω + ω1)
i

(3.24)

February 2, 2008

E. Rubiola The Leeson eﬀect

71

A − Voltage space

B − Phase space

Vi(s)

+

Σ
−

p
o
o
l
-
e
s
a
h
p
-
e
l

Vo(s)
out

oV’ (s)

oscill.
out

noise
free

A

resonator
β(s)

(s)Ψ

phase
noise

Σ+
+

(s)Φ

out

1

resonator
B(s)

Figure 3.9: Derivation of the oscillator phase-noise model (B) from the
voltage-noise oscillator model (A).

Proof. Proving Eq. (3.23), we come across the AM ﬁlter hs(t)
. This
is the amplitude response to a phase modulation. Using sin(x) =
1
2j

, we get

H1 ∗

e−jx

ejx

−

(cid:2)

(cid:3)

hs(t) =

ejx

e−jx

h(t)

1
j2

h

−

i

Eq. (3.24) follows immediately.

N

3.4 Phase noise in the oscillator loop

Whereas phase noise can be analyzed with the generic model of Fig. 3.1, we
turn our attention to the model of Fig. 3.9 B, speciﬁc to phase noise. The
physical quantities of Fig. 3.9 B are the Laplace transform of the oscillator
phase ﬂuctuations. Thus the input signal Ψ(s) models the ampliﬁer phase
noise. Additionally Ψ(s) can be used to introduce the resonator ﬂuctu-
ations, or the phase noise of an external signal to which the oscillator is
locked by injection. The ampliﬁer gain is 1 because the ampliﬁer repeats
the input phase to the output. The ﬁlter transfer function β(s) is replaced
with B(s), which is the Laplace transform of the resonator phase response.

72

E. Rubiola The Leeson eﬀect

February 2, 2008

A

B

resonator
tuned at

ω0

H(s)

j ω

resonator
detuned by

Ω<<ω0

H(s)

ω

j

−ω

L

e
n
a
l
p
l
-
e
l

+Ω

−Ω

σ

−ω

L

Figure 3.10: Oscillator phase-noise transfer function

(s).

H

The phase-noise transfer function is

(s) =

(s) =

H

H

Φ(s)
Ψ(s)
1
B(s)

1

−

def. of

(s)

H

oscillator .

Property The phase transfer function of the oscillator tuned at the exact
resonant frequency ω0 is

(s) =

H

2 =
(jω)
|

|H

1 + sτ
sτ
τ 2ω2 + 1
τ 2ω2

exact natural
frequency ω0

Proof. Replace B(s) given by Eq. (3.12) in (3.26). Using
the result (3.27) follows immediately. The proof for

|H
Leeson formula The oscillator phase noise spectrum

1

1−n/d = d
d−n ,
2 is omitted. N
(jω)
|

Sϕ(f ) =

1 +

"

2

1
f 2

ν0
2Q

(cid:18)

#

(cid:19)

Sψ(f ) .

[Eq. (1.26)]

(3.29)

σ

(3.25)

(3.26)

(3.27)

(3.28)

February 2, 2008

E. Rubiola The Leeson eﬀect

73

where Sψ(f ) is the spectrum of the phase ﬂuctuation ψ(t).

Proof. From the deﬁnition of

(s) [Eq. (3.25)], it follows that

Sϕ(ω) =

2 Sψ(ω) .
(jω)
|

|H

We replace Eq. (3.28) in the above

Then, we replace ω = 2πf and τ = 2Q
ω0

[Eq. (A.14)]

Sϕ(ω) =

1 +

Sψ(ω) .

1
ω2τ 2

(cid:21)
= Q
πν0

H

(cid:20)

Sϕ(f ) =

1 +

1
4π2f 2

π2ν2
0
Q2

Sψ(f )

(cid:21)

2

=

1 +

1
f 2

ν0
2Q

(cid:18)

#

(cid:19)

Sψ(f ) .

(cid:20)

"

Property The phase transfer function of the detuned oscillator, oscillating
at the frequency ω1 = ω0 + Ω is

(s) =

H

(sτ + 1)2 + Ω2τ 2
s(sτ + 1)

s + 1

τ −

jΩ
s

s + 1
(cid:1) (cid:0)
τ

=

(cid:0)

s + 1

τ + jΩ

(cid:1)

detuned
by Ω

alternate
form

(cid:0)
τ 4ω4 + 2(τ 2

(cid:1)

Ω2τ 4)ω2 + (Ω4τ 4 + 2Ω2τ 2 + 1)

2 =
(jω)
|

|H

−

τ 4ω4 + τ 2ω2

N

(3.30)

(3.31)

(3.32)

74

E. Rubiola The Leeson eﬀect

February 2, 2008

Proof. Replace B(s) given by Eq. (3.22) in (3.26). Use

1

1−n/d = d

d−n .

(s) =

H

τ

s + 1

(cid:0)

(sτ + 1

τ

s + 1

τ + jΩ

jΩ
τ −
s + 1
τ + jΩ
(cid:1) (cid:0)
−
jΩτ )(sτ + 1 + jΩτ )

s + 1
jΩ
(cid:0)
τ −
(sτ + 1
(cid:1) (cid:0)
jΩτ )(sτ + 1 + jΩτ )
(sτ + 1)2 + Ω2τ 2

−

−

−

(cid:0)

(cid:1)

s + 1
τ + Ω2τ
(cid:1)

(cid:1)

(sτ + 1 + Ω2τ 2)

(sτ + 1)2 + Ω2τ 2
(sτ + 1)2 + Ω2τ 2
s(sτ + 1)

−

(sτ + 1)

Ω2τ 2

−

=

=

=

The proof for

2 is omitted.
(jω)
|

|H

N

Remark 3.7 Eq. (3.32) extends the Leeson formula to the case of the
N
detuned oscillator.

−

−

Figure 3.10 shows

H
ωL ±

jΩ, leaving a real pole at s =

(s) on the Laplace plane. When the oscillator
ωL splits into a pair of complex
is pulled out of ω0, the real zero at s =
conjugate zeros at s =
ωL in between.
The pole at s = 0 in Fig. 3.10 is an ideal integrator in the time domain.
ωL,
This is the Leeson eﬀect, which makes the phase diverge. At ω
(s) appears as a small cluster with equal number of poles and zeroes that
H
null one another, for
(jω) is constant. The resonator is a ﬂywheel that
blocks the phase ﬂuctuations, for the oscillator is open loop. Accordingly,
the ampliﬁer phase noise Ψ(s) is repeated as the output.

≫

H

−

The plot of

2 (Fig. 3.11) reveals that the noise response is a
(jω)
|
function of Ω, and increases as Ω increases. This is best shown in terms of
the normalized noise transfer function

|H

2, deﬁned as
|Hn(jω)
|

2 =
|Hn(jω)
|

2

H
(jω)

(jω)
2
(cid:12)
Ω=0
(cid:12)

(cid:12)
H
(cid:12)
(cid:12)
2
Ω=0 is evaluated at Ω = 0.
(jω)
(cid:12)
|

(cid:12)
(cid:12)

|H

def. of

2
|Hn(jω)
|
Fig. 3.12 .

(3.33)

2 has an
|Hn(jω)
|

The denominator

February 2, 2008

E. Rubiola The Leeson eﬀect

75

Phase transfer function |H(jf)|^2

tau=1 -> omega_L=1
Omega =
[0, 0.5, 1, 1.5, 2] omega_L

Omega=0

Omega=2

6

5

4

3

2

1

0

0

h
g
i
b
-
c
l
a
c
-
e
l

0.2

0.4

0.6

0.8

1

frequency f

Figure 3.11: Phase-noise transfer function

2 evaluated for τ = 1.
(jω)
|

|H

horizontal asymptote at
After translating the horizontal asymptote to zero, we deﬁne

2 = 1, for can not be integrated to inﬁnity.
|Hn(jω)
|

(Ω) =

M

2
|Hn(jω)
|

−

1

dω

∞

0
Z

(cid:2)

∞

=

2

H
(jω)

(jω)
2
(cid:12)
Ω=0
(cid:12)

(cid:3)

dω ,

1
#

−

0 " (cid:12)
Z
H
(cid:12)
(cid:12)
(cid:12)
M
Ω, which converges with actual resonators. Interestingly, it holds that

(Ω) is a parameter that describes the noise increase due to the detuning

(cid:12)
(cid:12)

(3.34)

(3.35)

(3.36)

(Ω) =

Ω4τ 3 .

M

π
4

76

E. Rubiola The Leeson eﬀect

February 2, 2008

6

5

4

3

2

1

0

0

Normalized phase transfer function
|H(jf)|^2 / (|H(jf)|^2)_Omega=0

tau=1 -> omega_L=1
Omega =
[0, 0.5, 1, 1.5, 2] omega_L

Omega=2

Omega=0

0.2

0.4

0.6

0.8

1

frequency f

n
h
g
i
b
-
c
l
a
c
-
e
l

Figure 3.12: Normalized phase noise transfer function
evaluated for τ = 1.

2/
(jω)
|

|H

2
(jω)
Ω=0
|

|H

3.4.1 Pulling the oscillator frequency

The oscillator can be pulled to a desired frequency in an interval around
ω0, as shown in Section 1.2.1.

If the oscillator is pulled by inserting a static phase in the loop, the
oscillation frequency is not equal to the resonator natural frequency. In this
conditions it holds that Ω
= 0. Equation (3.36) indicate that the oscillator
phase noise increases. On the other hand, if ω0 is changed by making the
resonator interact with an external reactance, there is no reason for Ω to
be changed. Thus, the phase noise does not increase. The following cases
are of interest.

Quartz oscillator The quartz oscillator usually pulled by means of the
external reactance, as in Figure 1.7, for Ω is not aﬀected. Yet, the additional
loss introduced by the external reactance may lower the merit factor, and

6
February 2, 2008

E. Rubiola The Leeson eﬀect

77

in turn increase the resonator noise bandwidth.

Low-noise microwave oscillators
In low-noise schemes, like the Galani
oscillator [GBW+84], it often happens that the resonator can not be tuned,
for a phase shifter is used to pull the oscillation frequency. There follows
that Ω

= 0, and additional noise is taken in.

Pound-stabilized oscillator
In the Pound scheme [Pou46], the mod-
ulation and detection mechanism ensures that the resonator is tuned at
the exact natural frequency ω0 by equating amplitude of the reﬂected side-
bands. In this oscillator it holds that Ω = 0.

3.5 Spectrum of frequency ﬂuctuation and Allan

variance

If the phase noise spectrum inside the loop is Sψ(f ) = b0 + b−1f −1 + . . .,
the oscillator fractional frequency spectrum is

Sy(f ) =

f 2 +

f +

b0
ν2
0

b−1
ν2
0

b0
4Q2 +

b−1
4Q2

1
f

and the Allan variance is

σ2
y(τ ) =

1/τ 2
terms

(cid:20)

(cid:21)

+

1
2

1
4Q2 b0

1
τ

+ 2 ln(2)

1
4Q2 b−1 + . . .

The proof extends this result to higher order terms, b−2f −2, etc.
Proof (Spectrum)

(3.37)

(3.38)

Sy(f ) =

Sϕ(f )

derivative

=

1 +

Sψ(f )

Leeson

f 2
ν2
0
f 2
ν2
0 (cid:20)

1
f 2

ν2
0
4Q2

(cid:21)

6
78

E. Rubiola The Leeson eﬀect

February 2, 2008

f 2
ν2
0

+

1
4Q2

Sψ(f )

=

=

=

(cid:20)
b0
ν2
0

b0
ν2
0

(cid:21)
b−1
ν2
0

b−1
ν2
0

f 2 +

f +

f 2 +

f +

b−1
ν2
0

ν2
0
4Q2

1
f

b0
ν2
0

ν2
0
4Q2 +
b−1
4Q2

b0
4Q2 +

1
f

Proof (Allan variance) Match Eq. 3.37 to Sy(f ) =
tify the terms

N
i hif i, and iden-

P

h0 =

h−1 =

1
2Q2 b0
1
2Q2 b−1 .

Use Table 1.1 (page 5).

Remark 3.8 For the reasons detailed in Section 1.4, terms steeper than
b−2f −2 can not be present in the ampliﬁer noise. They can be added to for
completeness, because ψ(t) models all the phase ﬂuctuations present in the
N
loop.

Example 3.1 Calculate the Allan variance of a microwave DRO in which
the resonator merit factor is Q = 2500, and the ampliﬁer noise is Sϕ(f ) =
150 dBrad2/Hz, which results from f = 4 dB and
10−15 + 10−11/f (white
150 dBrad2/Hz at 1 Hz). Using Eq. (3.38)
P0 =

20 dBm, and ﬂicker

−

−

σ2
y(τ ) =

2
×

10−23
τ

−

×

+ 5.55

10−19

σy(τ ) =

4.47

10−12

×
√τ

+ 7.45

10−10

×

N

N

Chapter 4

Noise in the delay-line oscillator

The delay-line oscillator (Fig. 4.1 A) is an oscillator in which the feedback
path is a mere delay τ , for if the gain is A = 1 oscillation can take place at
any frequency ωn multiple of 2π
in a range. A selector ﬁlter selects a given
τ
mode ωm = 2π
τ m by introducing attenuation at all other frequencies but
ωm. The delay-line oscillator has the relevant property that the oscillation
frequency can be switched between modes by tuning the selector, like a
synthesizer. Of course, the pitch is ∆ω = 2π
τ .

We analyze the phase noise mechanism in the delay-line oscillator fol-
lowing the same approach of previous chapter, based on the elementary
theory of linear feedback systems.

4.1 Basic delay-line oscillator

The delay-line oscillator can be represented as the feedback model of Fig.
4.1 A. This is similar to Fig. 3.1 but for the resonator replaced with a delay
line of delay τ . The signal Vi(s) allows initial conditions and noise to be
introduced in the system, as well as the driving signal if the oscillator is
injection locked. We ﬁrst study the voltage-noise transfer function, deﬁned
as H(s) = Vo(s)

Vi(s) [Eq. (3.1)]. In our system, it holds that H(s) =

1
1−Aβ(s)

79

80

E. Rubiola The Leeson eﬀect

February 2, 2008

A − Voltage space

B − Phase space

Vi(s)

Σ+
+

p
o
o
l
-
y
l
d
-
e
l

noise
free

A

delay
β(s)

Vo (s)
out

oV’ (s)

oscill.
out

(s)Ψ

phase
noise

Σ+
+

(s)Φ

out

1

delay
B(s)

Figure 4.1: Voltage-noise (A) and phase-noise (B) oscillator model.

[Eq. (3.2)]. In the Laplace transforms, a delay τ maps into e−sτ . Thus

H(s) =

(Fig. 4.2 A) .

(4.1)

1
Ae−sτ

1

−

H(s) has an inﬁnite array of poles that are solutions of

(s) = 0, with

D

(s) = 1

Ae−sτ = 1

Ae−σe−jωτ .

D

−

−

The poles are located at s = sn,

sn =

ln(A) + j

n

integer n .

(4.2)

1
τ

2π
τ

Figure 4.2 A shows the poles of H(s) on the complex plane. The poles are
in the left half plane for A < 1, move rightwards as A increases, and reach
the imaginary axis for A = 1. The derivative dsn
τ A indicates that a gain
change δA cause the poles to move by δsn = 1
δA
A . Thus, the poles move
τ
δA
δA
horizontally by δσn = 1
A if δA
τ
is imaginary. Yet for notation consistency, we will keep A a real constant,
and introduce a separate function ρejθ (Sec. 4.2).

A if δA is real, and vertically by jδωn = 1

dA = 1

τ

A pair of imaginary conjugate poles represents a loss-free resonator that
sustains a pure sinusoidal oscillation in the time domain if excited by an
appropriate initial condition. Consequently, the delay-line oscillator can
oscillate at any frequency ωn = 2π
τ n. If more than one pole pair is excited,
the oscillation is a linear superposition of sinusoids at the frequencies ωn.

February 2, 2008

E. Rubiola The Leeson eﬀect

81

A − voltage space

B − phase space

H(s)
phase
space

n=m

j ω

. . . .

+6π/τ

+4π/τ

+2π/τ

0

−2π/τ

−4π/τ

−6π/τ

. . . .

µ=+3

µ=+2

µ=+1

µ=0

µ=−1

µ=−2

µ=−3

. . . .

. . . .

σ

σ

j ω

. . . .

+6π/τ

+4π/τ

+2π/τ

0

−2π/τ

−4π/τ

−6π/τ

. . . .

. . . .

n=+3

n=+2

n=+1

n=0

n=−1

n=−2

n=−3

. . . .

1 ln(A)
τ

H(s)

y
l
d
-
e
n
a
l
p
l
-
e
l

H

Figure 4.2: Noise transfer function H(s), and phase noise transfer function

(s) on the Laplace plane.

This is the Fourier series expansion of an arbitrary periodic waveform. The
property of completeness of the Fourier series tells us that the delay-line
oscillator can sustain any periodic waveform.

Let us now choose one oscillation frequency, ωm. This means that only
one pair of poles of H(s) is excited by appropriate initial conditions, at
2π
τ m. Having deﬁned the carrier frequency ωm,
the frequencies ω±m =
we are now able to analyze the phase-noise transfer function, deﬁned as
Ψ(s) [Eq. (3.25)]. The phase noise model of the oscillator is shown
H
in Fig. 4.1 B. Once again, the ampliﬁer gain is 1 because the ampliﬁer just
“copies” the input phase to the output. Thus it holds that

(s) = Φ(s)

±

(s) =

H

1

−

1
B(s)

,

82

E. Rubiola The Leeson eﬀect

February 2, 2008

Phase transfer function |H(jf)|^2

tau=1

5

4

3

2

1

0

0

y
l
d
h
-
c
l
a
c
-
e
l

1

2

3

4

5

frequency f

Figure 4.3: Phase noise transfer function

2 evaluated for τ = 1.
(jf )
|

|H

which is the same as Eq. (3.26). Yet, the phase transfer function is now
B(s) = e−sτ , independent of the carrier frequency. A proof can be obtained
following the approach of Section 3.2. Nonetheless, we observe that the
delay line has inﬁnite bandwidth, for the group delay is the same at all
frequencies, and equal to the line delay τ . Hence the phase, as well as any
information-related parameter of the signal, take a time τ to propagate
through the delay line. Consequently it holds that

B(s) = e−sτ .

By substituting B(s) = e−sτ in

(s), we get

(s) =

H

1

H
1
e−sτ

delay-line
oscillator

.

−
(s) has an inﬁnite array of poles that are solutions of 1

H
Introducing the mode oﬀset

e−sτ = 0.

−

(4.3)

(4.4)

(4.5)

µ = n

m

mode oﬀset ,

−

February 2, 2008

E. Rubiola The Leeson eﬀect

83

i.e., the integer frequency oﬀset from the carrier, the poles (Fig. 4.2 B) are
located at s = sµ,

sµ = j

2π
τ

µ

integer µ .

(4.6)

In the spectral domain, the square modulus of the phase noise transfer
function is

(Fig. 4.3)

(4.7)

(jω)
|

|H

2 =

2 (1

1
cos ωτ )

.

−
min = 1
2
(jf )
4 .
|

|H

Interestingly, it holds that

4.2 Mode selection

A pure delay-line oscillator, with an inﬁnite array of poles on the imaginary
axis, is a nice exercise of mathematics with scarce practical usefulness. A
mode selector is necessary, which ensures that that the Barkhausen con-
dition Aβ = 1 is met at the privileged m only, thus at the frequencies
m, are on the left-
ω±m =
±
hand half plane (

2π
τ m, and that all the other poles sn, n

< 1). Thus we replace

=

±

sn}

ℜ{

in Eq. (4.1), with

β(s)

βd(s)βf (s)

→

βd(s) = e−sτ
βf (s) = ρ(s)e−jθ(s)

delay line

selector ﬁlter

The function βf (s), as any network function, has the following properties

βf (s) = β∗

f (s∗)

ρ(s) = ρ(s∗)
θ(s) =

θ(s∗)

−

βf (s)
}
βf (s)
}

ℜ{
ℑ{

=
=

βf (s∗)
}
βf (s∗)
}

ℜ{
−ℑ{

(cid:26)
the modulus ρ(s) is even in ω

the argument θ(s) is odd in ω

even in ω
odd in ω

(4.8)

(4.9)

(4.10)

(4.11)

(4.12)

(4.13)

6
84

E. Rubiola The Leeson eﬀect

February 2, 2008

These conditions are necessary for βf (s) to be a real-coeﬃcient function,
or by extension a function whose series expansion has real coeﬃcients of s,
and ultimately for the inverse transform (i.e., the time-domain response)
to be a real function of time.

Introducing the selector ﬁlter, the transfer function [Eq. (4.1)] becomes

The poles of H(s) are the solutions of

(s) = 0, with

H(s) =

Aρ(s)ejθ(s)e−sτ

1

−

.

1

D

(s) = 1

Aρ(s)ejθ(s)e−sτ

D

−

Splitting

(s) into real and imaginary parts, we get

(4.14)

(4.15)

D

Aρe−στ = 1
ejθe−jωτ = 1

and ﬁnally

=

⇒

−

θ

ωτ = 0

mod 2π

σ =

ln(Aρ)

ω =

mod

2π
τ

1
τ
θ
τ

poles of H(s) .

(4.16)

As a consequence, the modulus ρ aﬀects only the real part σ of the pole,
thus the damping; the argument θ aﬀects only the imaginary part, thus the
frequency. The poles of H(s) are located at s = sn

sn =

ln(Aρ) + j

n + j

poles of H(s)

(4.17)

1
τ

2π
τ

θ
τ

The above Eq. (4.17) will be used to analyze some relevant types of selector
ﬁlter.

February 2, 2008

E. Rubiola The Leeson eﬀect

85

f
t
c
e
l
e
s
-
y
l
d
-
e
l

1

ε

ω−j

m

β

f

ω)

(j

ε

ε

1

ε

ω+j

m

ω

j

Figure 4.4: Amplitude-only selector ﬁlter.

(Fig. 4.4) .

(4.18)

4.2.1 Amplitude-only ﬁlter

This selector ﬁlter is deﬁned as

1

ǫ

1

≪

βf (s) = 



≈ ±
±

ωm
ω
m)
(n =
elsewhere
m)
=
(n

±

1 all the signals but those in the
ωm. Needless to say, this ﬁlter is an abstraction, which can

≪

Such ﬁlter attenuates by a factor ǫ
vicinity of
not be implemented with real-world devices.
The poles of H(s) are the solution of

±

(s) = 0, that is,

D

Ae−sτ = 0

ǫAe−sτ = 0

1

1

−

−

ω
(n =

≈ ±
±

ωm
m)

elsewhere
m)
(n

=

±

Hence the poles (Fig. 4.5 A) are located at s = sn,

1

τ ln(A) + j 2π
τ n
τ ln(ǫA) + j 2π
τ n n

1

±

±

=

m

n =

m (ω =

ωm)

±

sn =






4.2.2 Phase-only ﬁlter

The phase-only ﬁlter is deﬁned by

(4.19)

(4.20)

(4.21)

βf (s) = ej sgn(ω) θ .

(4.22)

6
6
6
86

E. Rubiola The Leeson eﬀect

February 2, 2008

A − amplitude−only filter

B − phase−only filter

j ω

(+2π/τ)

(+m+1)

(+2π/τ)(+m)

(+2π/τ)(+m−1)

. . . .

. . . .

+4π/τ

+2π/τ

0

−2π/τ

−4π/τ

. . . .

. . . .

(+2π/τ)

(−m+1)

(+2π/τ)

(−m)

(+2π/τ)

(−m−1)

∆ω=+θ/τ

∆ω=+θ/τ

∆ω=+θ/τ

∆ω=+θ/τ

∆ω=−θ/τ

∆ω=−θ/τ

∆ω=−θ/τ

∆ω=−θ/τ

σ

∆ω=0

j ω

. . . .

. . . .

. . . .

. . . .

. . . .

+4π/τ

+2π/τ

0

σ
−2π/τ

−4π/τ

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

n=+m+1

n=+m

n=+m−1

. . . .

. . . .

n=+2

n=+1

n=0

n=−1

n=−2

. . . .

. . . .

n=−m+1

n=−m

n=−m−1

. . . .

t
c
e
l
e
s
-
y
l
d
-
e
l

1
τ

ln( εA)

1 ln(A)
τ

1 ln(A)
τ

Figure 4.5: Transfer function H(s) of the delay-line oscillator with a selector
ﬁlter βf (s) inserted in the oscillator loop.

This ﬁlter shifts the signals by θ for ω > 0, and by
signum function sgn(ω) is necessary for the condition βf (s) = β∗
satisﬁed. Once again, this ﬁlter is an abstraction.

θ for ω < 0. The
f (s∗) to be

−

February 2, 2008

E. Rubiola The Leeson eﬀect

87

By replacing the above βf (s) in H(s), we get

H(s) =

.

(4.23)

The poles are the solution of

By splitting the modulus and the argument of

, we ﬁnd

1

1

Aej sgn(ω) θe−sτ

−
= 0, where

D

(s) = 1

Aej sgn(ω) θe−sτ

D

−

Ae−στ = 1
sgn(ω) θ

−

ωτ = 0 mod 2π .

There follows that the poles (Fig. 4.5 B) are located at s = sn

sn =

ln(A) + j

n +

sgn(n)

integer n

(4.24)

1
τ

2π
τ

(cid:20)

θ
τ

In conclusion, the real part of the poles is not aﬀected, for the gain condition
is still A = 1. On the other hand, the phase θ results in a frequency shift

∆ω =

for ω > 0

and

∆ω =

for ω > 0 .

(4.25)

θ
τ

4.3 The use of a resonator as the selector ﬁlter

The practical reason to choose a resonator as the selector ﬁlter is that it
is simpler and easier to tune, as compared to other types of ﬁlter. Let us
assume that the resonator is tuned at the exact frequency ωm = 2π
τ m of
our interest, among the permitted frequencies of the delay-line oscillator.
Thus, the feedback function is

β(s) = βd(s)βf (s)

[Eq. (4.8)] ,

(4.26)

D

(cid:21)

θ
τ

−

E. Rubiola The Leeson eﬀect

February 2, 2008

88

with

βd(s) = e−sτ

βf (s) =

ωm
Q

s
s2 + ωm
Q s + ω2
m

delay line
[Eq. (4.3)]

ﬁlter
[Eq. (A.1)]

(4.27)

(4.28)

It is important to understand the role of delay line and of the ﬁlter. As a
consequence of the Leeson eﬀect, stable oscillation frequency requires high
slope d
dω arg β(jω), i.e., long group delay. Nonetheless, the oscillator tracks
the natural frequency of the feedback network, which is sensitive to the
environment parameters, chieﬂy the ambient temperature. When βd and
βf are cascaded, the frequency ﬂuctuations are weighted by the phase slope
d
dω arg β(jω) because the Barkhausen condition requires arg β(jω) = 0. The
appropriate choice for the delay-line oscillator is therefore

,

(4.29)

d
dω

ω=ωm ≫

d
dω

arg βd(jω)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

arg βf (jω)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ω=ωm

which means that the oscillator frequency is stabilized to the delay line,
while the resonator serves only as the mode selector. The main technical
reason to choose a delay-line oscillator is the availability of a delay line that
exhibit much higher stability than the resonator. Accordingly, the resonator
merit factor must be suﬃciently low to prevent the resonator from impairing
the oscillator stability. Another reason for the condition (4.29) is that it
makes easy to switch between the delay-line modes, allowing the resonator
to be tuned in a narrow range around the exact frequency.

1

By replacing β(s) = βd(s)βf (s) in H(s) =

1−Aβ(s) , under the assump-
tion that the ampliﬁer gain is A = 1, we ﬁnd the oscillator transfer function
s2 + ωm
Q s + ω2
This function has a pair of complex conjugate zeros at s = sz and s = s∗
z

Q s + ω2
m
ωm

Q se−sτ .

s2 + ωm

H(s) =

(4.30)

m −

sz, s∗

z =

ωm
2Q ±

−

jωm ,

February 2, 2008

E. Rubiola The Leeson eﬀect

89

and a series of complex conjugate poles. As a consequence of the condition
(4.29), the resonator bandwidth ωm
Q is large as compared to the mode pitch
2π
τ . This means that in a frequency range
around ωm, and also around
ωm, the resonator dissonance χ is such that Qχ

1. The range

F

−
contains a few modes ωn around ωm. In
is about constant and close to 1. Thee follows that in

F

F
the resonator function βf (jω)

≪

F

1. The poles of H(s) are chieﬂy determined by the oscillation of βd(s);
τ n, which is the result already obtained without

they are close to j 2π
the selector ﬁlter.

2. An approximate solution for the poles is found by replacing βf (s)

with βf (jω) = ρ(ω)ejθ(ω)

ρ(ω) =

θ(ω) =

p
−

χ =

1
1 + Q2χ2
arctan (Qχ)
ω
2
ωm −

ωm
ω

(cid:16)

(cid:17)
1 it follows that χ

modulus

phase

dissonance

3. From Qχ

≪

θ(ω) can be further approximated as

2 ω−ωm
ωm

≃

. Consequently ρ(ω) and

ρ(ω) = 1

2Q2

−

θ(ω) =

2Q

−

ω

ωm

(cid:16)
−
ωm

ω

ωm

2

−
ωm

(cid:17)

Thus, the poles of H(s) are found by inserting the above ρ(ω)
θ(ω)

|ω=ωn and
|ω=ωn in Eq. (4.17), with A = 1. The poles are at s = sn = σn + jωn

σn =

ln

1

2Q2

1
τ
2π
τ

(cid:20)
n +

−
θ
τ ≃

ωm

2

ωn −
ωm

(cid:16)
2π
τ

2Q
τ

n

−

≃ −
ωm

(cid:21)
(cid:17)
ωn −
ωm

,

ωn =

2Q2
τ

ωn −
ωm

ωm

2

(cid:16)

(cid:17)

(4.31)

(4.32)

E. Rubiola The Leeson eﬀect

February 2, 2008

90

hence

sn =

2Q2
τ

−

ωn −
ωm

ωm

2

+ j

2π
τ

j

2Q
τ

ωn −
ωm

ωm

,

n

−

(cid:16)

(cid:17)

Additionally, the pols can be given in terms of the mode oﬀset µ = n
[Eq. (4.5)] through the simple property that ωn−ωm

= µ

−

m

ωm

m . Hence

sn =

2Q2
τ

−

µ
m

2

+ j

2π
τ

j

2Q
τ

µ
m

.

n

−

(cid:16)

(cid:17)

Figure 4.6 shows the poles of H(s), located on a horizontal parabola cen-
µ
m with respect to
tered at ωm. The pole frequencies are shifted by
the exact mode 2π
τ n of the delay line. This frequency shift results from
the oﬀ-resonance phase of the ﬁlter. The negative-frequency part of the
Laplace plane follows by symmetry.

2Q
τ

−

Interestingly, every pair of complex conjugate poles of H(s) can be
seen as a separate resonator [Fig. A.1, and Eq. (A.1)], whose merit factor is
enhanced by the positive feedback. The pole pair selected by the resonator,
denoted with the subscript m, is onto the imaginary axis, for the equivalent
merit factor is Qm =
. The other pole pairs, denoted with the subscript
n, yield a merit factor

∞

(4.33)

(4.34)

(4.35)

or equivalently

Qn =

2

τ ωn
4Q2

m
µ

(cid:16)

(cid:17)

Qn =

πn
2Q2

m
µ

2

.

(cid:16)

(cid:17)

In the presence of noise, these poles are excited by random signal. Thus,
the radio-frequency spectrum shows a series of sharp lines at frequency ωµ
oﬀ the carrier frequency ωm, on both sides because µ takes positive and
negative values. These lines are easily mistaken for competitor oscillation
modes, which they can not be1. The relevant diﬀerences are that random
1Mode competition and multimode oscillation do exist, yet under diﬀerent hypotheses.

This behavior is commonly found in lasers.

February 2, 2008

E. Rubiola The Leeson eﬀect

91

σ=−

2

2Q2 µ
τ
m

ω

m
2Q

∆ω=−

2Q
τ

µ
m

∆ω=−

2Q
τ

µ
m

∆ω=−

2Q
τ

µ
m

∆ω=−

2Q
τ

µ
m

ω

j

(2π/τ)

(m+µ)

ω

m

=

(2π/τ) m

(2π/τ)

(m+µ)

(2π/τ)

(m+µ)

ω

−

m

=

−

(2π/τ) m

(2π/τ)

(m+µ)

. . . .

µ=+2

µ=+1

µ=0

µ=−1

µ=−2

. . . .

σ

. . . .

µ=+2

µ=+1

µ=0

µ=−1

µ=−2

. . . .

n
o
s
e
r
-
y
l
d
-
e
l

Figure 4.6: Transfer function H(s) of the delay-line oscillator with a res-
onator as the selector ﬁlter.

excitation causes incoherent oscillation, and that such oscillation is damped.
With the µ = 0 pair, coherent and incoherent oscillation coexist. This is
the Leeson eﬀect.

With the operating parameters of actual or conceivable oscillators,
the equivalent merit factor Qn is so high that the noise transfer function
2 [Eq. 4.30] can hardly be plotted. Examples are provided in Section
H(jω)
|
|
4.6.

92

E. Rubiola The Leeson eﬀect

February 2, 2008

Remark 4.1 (Multi-pole ﬁlters) In the domain of telecommunications,
multi-pole passband ﬁlters are widely used, which exhibit nearly ﬂat re-
sponse in a bandwidth. The experimentalist may be inclined to use such
ﬁlters as the mode selector because of their easy commercial availability,
and out of the common belief that the ﬂat response is the most desirable
one for a bandpass ﬁlter. But the maximally ﬂat ﬁlter is the worst choice
for an oscillator. In fact, with a ﬂat ﬁlters the µ
= 0 poles are maximally
close to the imaginary axis. There follow that

1. selecting the desired oscillation frequency is maximally diﬃcult,

2. mode jump can occur,

3. close-in noise peaks are maximally high.

4.4 Phase response

Let the delay-line oscillator oscillate at the frequency ωm = 2π
τ , thanks to
a resonator in the feedback loop tuned at the exact frequency ωm. Under
(s) = Ψ(s)
this condition, we analyze the phase-noise transfer function
Φ(s
[Eq. (3.25)], i.e.,

H

(s) =

H

1

−

1
B(s)

.

Introducing the resonator as the selector ﬁlter, the feedback function is

B(s) = Bd(s)Bf (s)

with

Bd(s) = e−sτd
1
1 + sτf

Bf (s) =

delay

ﬁlter

N

(4.36)

(4.37)

(4.38)

(4.39)

6
February 2, 2008

E. Rubiola The Leeson eﬀect

93

ω

m

=

(2π/τ) m

ω

j

∆ω=−

2Q
τ

µ
m

∆ω=−

2Q
τ

µ
m

ω

m
2Q

(2π/τ)µ

(2π/τ)µ

. . . .

µ=+2

µ=+1

µ=0

µ=−1

µ=−2

. . . .

σ

σ=−

2

2Q2 µ
τ
m

e
s
a
h
p
h
-
n
o
s
e
r
-
y
l
d
-
e
l

Figure 4.7: Phase-noise transfer function
with a resonator as the selector ﬁlter.

H

(s) of the delay-line oscillator

The subscript ‘d’ and ‘f ’ are introduced in order to prevent confusion be-
tween the delay of the line (τd) and the relaxation time τf = 2Q
[Eq. (A.14)]
ωm
of the resonator.

Expanding the phase-noise transfer function, we ﬁnd

(s) =

H

1 + sτf
1 + sτf −
=

e−sτd

(4.40)

−

−

1
τf

(s) has a real zero at s =

ωm
2Q , a pole at s = 0, and a series of
−
H
complex conjugate poles in the left half-plane. The location of these poles is
B(s), without using the simpliﬁed
best found by searching for the zeros of 1
, the poles
form (4.40). As a consequence of the design choice τd ≫
are expected to be close to the position already found in the absence of the
selector, that is, j 2π
µ. In other words, in a region around the origin that
τd
contains a few pole pairs, the selector has a small eﬀect on the modulus
and on the phase of B(s). This is exactly the same situation already found
searching for the poles of H(s), transposed from
In order to the ﬁnd poles, solution of 1

ωm to the origin.
B(s) = 0, we ﬁrst focus on
the low-pass phase ﬁlter Bf (s). The poles are expected to be close to the

τf = 2Q
ωm

−

±

94

E. Rubiola The Leeson eﬀect

February 2, 2008

imaginary axis. Thus we can approximate Bf (s)
polar form

≃

Bf (jω), and write in

Bf (s) = ρ(ω)ejθ(ω)

ρ(ω) =

1
1 + ω2τ 2
f

s

−

θ(ω) =

arctan (ωτf ) .

ρ(ω) = 1

2Q2

−

θ(ω) =

2Q

−

(cid:16)
ω
ωm

ω
ωm

2

(cid:17)

Then we replace the low-pass time constant τf as τf = 2Q
ωm
for ωτf ≪

1

, and we expand

The equation 1

B(s) = 0 can be rewritten as

−

ρ(ω)ejθ(ω) e−στd e−jωτd = 1 ,

and further split into modulus and phase. The poles are the solutions of

ρ(ω)e−στd = 1
θ(ω)

−

ωτd = 0 mod 2π

modulus

phase .

The modulus condition yields

= 1

(cid:17)

2Q2 ω2
ω2
m
2Q2 ω2
ω2
m
2Q2 ω2
ω2
m

e−στd

1

(cid:16)

eστd = 1

−

−

στd = ln

1

σ =

(cid:16)
2Q2
τd

−

−
ω2
ω2
m

(cid:17)

for 2Q2 ω2
ω2

m ≪

1 .

(4.41)

February 2, 2008

E. Rubiola The Leeson eﬀect

95

The phase condition yields

ωτd + 2Q

= 0 mod 2π

ω
ωm

ω =

2π
τd

µ

−

2Q
τd

ω
ωm

integer µ .

(4.42)

The poles are located at s = sµ = σµ + jωµ, which results from Eq. (4.41)
and (4.42)

−

sµ =

2Q2
τd
Additionally, by replacing ωµ
ωm
2Q2
τd

sµ =

−

ω2
µ
ω2
m

+ j

2π
τd

µ

−

j

2Q
τd

ωµ
ωm

= µ we ﬁnd

µ
m

2

+ j

2π
τd

µ

−

2Q
τd

µ
m

.

(cid:16)

(cid:17)

(s) on the Laplace
Figure 4.7 shows the phase-noise transfer function
plane. The pole in the origin represents a pure integrator in the time
domain, which causes the Leeson eﬀect. The other poles are on a horizontal
µ2 from
parabola centered in the origin, at a small negative distance σ
the imaginary axis. It is easily seen by comparing Fig. 4.7 to Fig. A.1 that
each complex conjugate pair is equivalent to a resonator of merit factor

∝ −

H

which can be rewritten as

Qµ =

ωµτd
4Q2

m
µ

2 ,

(cid:16)

(cid:1)

Qµ =

π
2Q2

m2
µ

(4.43)

(4.44)

(4.45)

(4.46)

because ωµ = 2π
τd

µ.

From Eq. (4.40), after some tedious algebra it is proved that

(jω)
|

|H

2 =

2

−

1 + ω2τf

2 cos(ωτd) + ω2τ 2

f + 2ωτf sin(ωτd)

(Fig. 4.8).

(4.47)

96

E. Rubiola The Leeson eﬀect

February 2, 2008

Phase transfer function |H(f)|^2

1e+07

1e+06

1e+05

parameters
tau = 20 mus
m = 2E5
nu_m = 10 GHz
selector Q = 2000

.1e5

.1e4

.1e3

.1e2

1.

.1

.1e-1

.1e4

e
s
a
h
p
h
-
y
l
d
-
c
l
a
c
-
e
l

.1e5

1e+05

1e+06

frequency, Hz

Figure 4.8: Phase transfer function
m = 2

|H
105 (thus νm = 10 GHz), and Q = 2000 (data of Example 4.1).

2 evaluated for τd = 20 µs,
(jf )
|

×

µ, or f = 1
τd

2 shows a series of sharp peaks at ω = 2π
(jω)
τd
|

µ, integer
|H
µ, around which phase noise taken in is enhanced. The peaks derive from
(s)2 close to the imaginary axis, but not on the axis, for
the poles of
they are not the signature of competing oscillation modes. The minima of
µ, µ = 1
2 , . . .. Interestingly,
1
4 . Finally, at low frequencies
|H
2 is approximated as
(jω)
|

2π
2 are located at ω
(jω)
τd
|
|H
at these minima it holds that
)
(ω

≃
2
(jω)
|

2π
τd ≪

µ, or f

2 , 3

2 , 5

2π
τf

|H

1
τd

≪

H

≃

≃

2

(jω)
|

|H

≃

1
τ 2
d

1
ω2 +

1
12

.

4.5 Close-in noise spectra and Allan variance

The phase noise spectrum is

Sϕ(f ) =

(jf )
|

|H

2 Sψ(f )

(4.48)

(4.49)

February 2, 2008

E. Rubiola The Leeson eﬀect

97

At low frequencies, it holds that

Sϕ(f )

1
4π2τ 2
d
ν2
m
4π2m2
ν2
mb0
4π2m2

1
f 2 Sψ(f )
1
f 2 Sψ(f )
ν2
mb−1
1
f 2 +
4π2m2

≃

=

=

ω

≪

2π
τd

use νm = m
τd

ampliﬁer
noise

The spectrum of the fractional frequency ﬂuctuation y is found using
Sy(f ) = f 2
ν2
m

Sϕ(f )

Sy(f ) =

4π2m2 Sψ(f )

By replacing Sψ(f ) = b0 + b−1f −1 and matching the above to Sy(f ) =

i hif i, we ﬁnd

P

h0 =

b0
4π2m2

and

h−1 =

b−1
4π2m2

(4.50)

(4.51)

(4.52)

(4.53)

1
f 3

1

Using Table 1.1, the Allan variance is

σ2
y(τ ) =

1/τ 2
terms

(cid:20)

(cid:21)

+

b0
4π2m2

1
2τ

+

b−1
4π2m2 2 ln(2)

4.6 Examples

Example 4.1 Photonic delay-line oscillator We analyze a photonic
delay-line oscillator based on the following parameters

4-km optical ﬁber, refraction index of 1.5

τd = 20 µs
1/τd = 50 kHz mode spacing
νm = 10 GHz
m = 2
×
Q = 2
×
b0 = 3.2
b−1 = 10−10

10−14 white phase noise,
ﬂicker phase noise,

105
103

×

selected frequency
mode order, equal to νmτd
selector ﬁlter (tunable microwave cavity)

135 rad2/Hz
100 dBrad2/Hz at f = 1 Hz.

−
−

98

E. Rubiola The Leeson eﬀect

February 2, 2008

2. A series of
Figure 4.8 shows the phase noise transfer function
(jf )
|
spectral lines due to noise is evident at f = 1
τ d = 50 kHz and multiples.
The following table shows the relevant parameters of the resonance due to
the neighboring modes of the delay line.

|H

µ
0
1
2
3
4
5

±
±
±
±
±

ν
|

νm|
−
0
104
104
104
104
104

5
×
10
×
15
×
20
×
25
×

Qχ
0
0.02
0.04
0.06
0.08
0.10

σµ
0
10
40
90
160
250

−
−
−
−
−

Qn

Qµ

3.14
785
349
196
126

∞
×
×
×
×
×

109
106
106
106
106

15.7
7.85
5.24
3.93
3.14

∞
×
×
×
×
×

103
103
103
103
103

The reader should observe the high equivalent merit factor Qµ of the phase-
noise response, which explains the sharp resonances of Fig. 4.8.

The ampliﬁer corner frequency is fc = 3.16 kHz, as results from
b−1f −1 = b0. The estimated phase noise spectrum is shown in Fig. 4.9.
Restricting our attention to the white and ﬂicker frequency noise, the os-
cillator phase noise is

The spectrum of the fractional frequency ﬂuctuation is

Sϕ(f ) =

10−6
2
f 2 +
×

6.3

10−3
×
f 3

.

Sy(f ) = 2

10−26 +

×

6.3

10−23
×
f

,

and the Allan variance

σ2
y(τ ) =

10−26
τ

+ 8.8

10−23

×

thus

σy(τ ) =

10−13
√τ

+ 9.4

10−12

×

N

Remark 4.2 The numerical values of Example 4.1 are inspired to the ref-
N
erences [EM03] and [YM96].

February 2, 2008

E. Rubiola The Leeson eﬀect

99

1e-05

1e-06

1e-07

1e-08

1e-09

1e-10

1e-11

1e-12

1e-13

1e-14

Oscillator phase noise S_phi(f)

parameters
tau = 20 mus
m = 2E5
nu_m = 10 GHz
selector Q = 2000
b_0 = -135 dB (white)
b_-1 = -100 dB (flicker)

oscillator

amplifier

i
h
p
s
-
y
l
d
-
c
l
a
c
-
e
l

1e-15

.1e4

.1e5

1e+05

1e+06

frequency, Hz

Figure 4.9: Expected phase noise spectrum Sϕ(f ) for a photonic delay-line
105 (thus νm = 10 GHz), and
oscillator. Parameters: τ = 20 µs, m = 2
Q = 2000. Data refer to Example 4.1.

×

Example 4.2 SAW delay-line oscillator We analyze a SAW delay-line
oscillator based on the following parameters

15 mm SAW, sound speed 3 km/s

τ = 5 µs
1/τ = 200 kHz mode spacing
νm = 900 MHz
m = 4500
Q = 80
b0 = 3.2
b−1 = 10−13

10−15 white phase noise,
ﬂicker phase noise,

selected frequency
mode order, equal to νmτ
selector ﬁlter (LC ﬁlter)

×

145 rad2/Hz
100 dBrad2/Hz at f = 1 Hz.

−
−

The ampliﬁer corner frequency is fc = 31.6 Hz, as results from b−1f −1 =
b0. Figure 4.8 shows the expected phase noise Sϕ(f ). The neighboring
resonances show up at f = 1
τ = 200 kHz and multiples. The following table
shows the relevant resonance parameters.

100

E. Rubiola The Leeson eﬀect

February 2, 2008

Oscillator phase noise S_phi(f)

parameters
tau = 5E-6 s
m = 4500
nu_m = 900 MHz
selector Q = 80
b_0 = -145 dB (white)
b_-1 = -130 dB (flicker)

oscillator

amplifier

1e-07

1e-08

1e-09

1e-10

1e-11

1e-12

1e-13

1e-14

1e-15

1e-16

.1e2

.1e3

.1e4

.1e5

1e+05

1e+06

frequency, Hz

i
h
p
s
-
w
a
s
-
c
l
a
c
-
e
l

Figure 4.10: Expected phase noise spectrum Sϕ(f ) for a SAW delay-line
105 (thus νm = 10 GHz), and
oscillator. Parameters: τ = 20 µs, m = 2
Q = 2000. Data refer to Example 4.2.

×

µ
0
1
2
3
4
5

±
±
±
±
±

ν
|

νm|
−
0
105
105
105
105
105

2
×
4
×
8
×
10
×
12
×

Qχ
0
0.035
0.071
0.107
0.142
0.178

σµ
0
126
506
1138
2023
3160

−
−
−
−
−

Qn

2.24
5.59
2.49
1.40
8.95

∞
×
×
×
×
×

107
106
106
106
106

Qµ

∞
4970
2485
1657
1243
994

The estimated phase noise spectrum is shown in Fig. 4.10. Focusing
our attention to the white and ﬂicker frequency noise, the oscillator phase
noise is

Sϕ(f ) =

2.5

10−6
×
f 2

+

8
×

10−5
f 3

.

February 2, 2008

E. Rubiola The Leeson eﬀect

101

The spectrum of the fractional frequency ﬂuctuation is

Sy(f ) = 3.96

10−24 +

×

1.25

10−22
×
f

,

and the Allan variance

σ2
y(τ ) =

2
×

10−24
τ

+ 1.7

10−22

×

thus σy(τ ) =

1.4

10−13
×
√τ

+ 1.3

10−12

×

N

Remark 4.3 The numerical values of Example 4.2 are inspired to the eu-
ropean GSM standard for mobile phones, which operates in the 900 MHz
band with a channel spacing of 200 kHz. By tuning the selector ﬁlter, the
SAW oscillator can be used as a frequency synthesizer that works at the
N
appropriate frequency, with the appropriate step.

4.7 Phase noise in lasers

Figure 4.11 sketches the optical system and the equivalent electric circuit
of a laser. T and R are the mirror transmission and reﬂection coeﬃcients,
A is the round-trip gain, and τ is the round-trip transit time. Gain and
transmission coeﬃcients refer to electric ﬁeld, thus to voltage in the equiv-
alent circuit of Fig. 4.11 B. We have to prove that the laser is equivalent to
the feedback scheme of Fig. 4.1, for all the framework of Sections 4.3, 4.4
and 4.5 applies.

At the reference plane, the input signal (electric ﬁeld) is added to the
signal ampliﬁed and fed back after delay τ . Without loss of generality, we
drop the trivial factor T1. This means that the true input signal is Vi on
the reference plane, instead of the external signal V ′
i . Then, we take the
output signal Vo at the reference plane, instead of V ′
o after the mirror 2.
The transfer function is deﬁned as

H(s) =

[def. of H(s)] .

(4.54)

Vo(s)
Vi(s)

102

E. Rubiola The Leeson eﬀect

February 2, 2008

A − Optical system

B − equivalent circuit

reference
plane

iV’

T1

T
2

oV’

’

A
 
n
i
a
g

R2

R1

r
e
s
a
l
-
e
l

roundtrip
time τ

mirror 1

mirror 2

reference
plane

Vo

out

R1

A’

T2

oV’

(out)

τdelay

Vi
+

T1

iV’

in

Σ
+

R2

Figure 4.11: A laser can be regarded as a feedback system.

By breaking the circuit at the reference plane and equating the left-hand
signal to the right-hand signal, we ﬁnd

Vo(s) = Vi(s) + Vo(s)

1

A′(s)βd(s)R1R2)

where βd(s) = e−sτd is the delay. Hence

(cid:2)

(cid:3)

−

1

H(s) =

A′(s)βd(s)R1R2

1

−

We observe that in actual lasers the gain A′ of the active medium is a
smooth function of frequency, wide as compared to the mode spacing of
the optical cavity, which shows a maximum centered at the laser frequency.
This is the same analysis/design criterion that we have adopted in Section
4.3, introducing the mode-selector ﬁlter. Thus

February 2, 2008

E. Rubiola The Leeson eﬀect

103

1. We move the frequency dependence from A′(s) to a new ﬁlter function
βf (s). The latter is normalized for the maximum to be equal one, at
the laser frequency.

2. We approximate βf (s), wide and smooth around the laser frequency,

with a resonator.

3. We introduce the gain A that accounts for the maximum

for the two reﬂection coeﬃcients R1 and R2.

, and
A(jω)
|
|

After these manipulations, the laser transfer function takes the form

H(s) =

1

Aβf (s)βd(s)

1

−

,

which is equivalent to Eq. (4.30). Needless to say, the Barkhausen condition
still holds, for the loop gain must be equal to one as a result of some
saturation phenomena.

4.8 Saturation and multimode oscillation

Multimode oscillation requires that the Barkhausen condition Aβ = 1 is
met at more than one frequency. This is of course possible.

Single-mode oscillation In the ampliﬁers of the ﬁrst type, when the sig-
nal exceeds a threshold the gain drops more or less smoothly, yet uniformly
in the pass band (Fig. 4.12 A). This is always the case of the oscillators
in which the power is controlled in closed loop by measuring the output
power and by acting on a variable-gain element. This behavior is also
typical of saturated electronic ampliﬁers, either vacuum or solid state. In
this case, distortion reduces the gain and squeezes power into higher har-
monics, at frequencies multiple of ω0. Additionally, this is found in the
quantum ampliﬁers (masers and lasers) in which ampliﬁcation is due to a
single pumped level, or to a cluster of levels that act as a single one be-
cause of the linewidth. Oscillation sinks atoms from the pumped level, for

104

E. Rubiola The Leeson eﬀect

February 2, 2008

A − single gain

(Αβ) =0
arg
largest gain

B − gain cluster

large signal

|Αβ|=1

arg (Αβ) =0

|Αβ|

small signal

large signal

|Αβ|

small
signal

1

1

ω

ω

arg (Αβ)

|Αβ|=1
arg (Αβ) =0

arg (Αβ)

ω

ω

r
u
t
a
s
-
y
l
d
-
e
l

ω1

ω2

ω3

ω4

ω5

ω1

ω2

ω3

ω4

ω5

Figure 4.12: Diﬀerent types of saturation in ampliﬁer.

the active population is reduced. With these ampliﬁers, the gain condition
can only be met at one frequency. Generally, the oscillation frequency is
that at which the small-signal gain is the highest among those at which the
loop phase is zero. In the example of Fig. 4.12 A, ω1 is not in the mode
competition because of the insuﬃcient the small-signal gain, and ω3 wins.

Multimode oscillation In the ampliﬁer of the second type, found in
some lasers, the bandwidth is due to a cluster of energy levels narrow enough
for power to sink population selectively (Fig. 4.12 B). When oscillation takes
place at a given frequency, the active population decreases only in the
neighbors. Thus oscillation can also rise at the other frequencies at which
the phase condition is met and the small-signal gain is greater than one.
In the example of Fig. 4.12 B, the small-signal gain is insuﬃcient at ω1;
oscillation takes place at ω2, ω3, ω4, and ω5.

Appendix A

Resonator model and parameters

A.1 Laplace plane

Around the resonant frequency, real world resonators are well described
by a linear second-order diﬀerential equation with constant coeﬃcients.
Accordingly The Laplace transform of the impulse response is a rational
function of the form

Hr(s) =

ω0
Q

s
s2 + ω0
Q s + ω2
0

,

which can be rewritten as

Hr(s) =

ω0
Q

s
sp)(s

(s

−

s∗
p)

−

sp = σp + jωp
s∗
jωp
p = σp −

with

σp =

ω0
2Q

−

4Q2

ωp =

ω0
2Q
p
p = ω2
p + ω2
σ2
0 .

−

1 = ω0

1

−

r

1
4Q2

105

(A.1)

(A.2)

(A.3)

(A.4)

(A.5)

106

E. Rubiola The Leeson eﬀect

February 2, 2008

|H(j ω)|

1

arg H(j ω)

r
o
t
a
n
o
s
e
r
-
e
l

+π

−π

ω0

ω0/Q

1/   2
(−3dB)

ω

ω

+π/2

−π/2

ωj

ω0

ω0
2Q

0ω

4Q2−1

1−

1
4Q2

ω

0
2Q

σ

ω0
2Q

0ω

4Q2−1

1−

1
4Q2

Figure A.1: Resonator transfer function in the frequency domain and on
the Laplace plane.

Figure A.1 shows the resonator transfer function in the frequency domain
and on the Laplace plane.

A.2 Frequency domain

The frequency response is easily found by replacing s = jω in the Laplace
transform. Deﬁning the dissonance χ as

χ =

ω
ω0 −
ω

ω0
ω
ω0

χ

2

≃

−
ω0

dissonance

for

ω

|

ω0| ≪

−

ω0
Q

we ﬁnd the following relevant relationships

Hr(jω) =

R(jω) =

1
1 + jQχ
1
1 + Q2χ2

frequency response

real part

Hr(jω)
}

ℜ{

(A.6)

(A.7)

(A.8)

(A.9)

February 2, 2008

E. Rubiola The Leeson eﬀect

107

I(jω) =

−

ρ(jω) =

θ(jω) =

p
−

Qχ
1 + Q2χ2
1
1 + Q2χ2
arctan Qχ

imag. part

Hr(jω)
}

ℑ{

modulus

Hr(jω)
|
|

(A.10)

(A.11)

argument arg [Hr(jω)]

(A.12)

A.3 Time domain

In the time domain, the impulse response of the resonator an exponentially
decaying sinusoid of the form

vo(t) = cos (ω0t) e−t/τ ,

(A.13)

where the relaxation time τ is related to the other resonator parameters by

τ =

T0 =

=

=

=

Q
πν0

2Q
ω0

1
ωL

Q
π

1
2πfL

relaxation
time

.

(A.14)

108

E. Rubiola The Leeson eﬀect

February 2, 2008

Bibliography

[CCI90]

[CM85]

[EM03]

[Fri44]

[GBB02]

CCIR Study Group VII, Characterization of frequency and
phase noise, Report no. 580-3, Standard Frequencies and Time
Signals, Recommendations and Reports of the CCIR, vol.
VII (annex), International Telecommunication Union (ITU),
Geneva, Switzerland, 1990, pp. 160–171. 1.1

Bernard Cretin and Jean Claude Mollier, Design of a 3/2-
order phase-locked loop for improved laser probe resolution,
IEEE Trans. Instrum. Meas. 34 (1985), no. 4, 660–664. 2.2

Danny Eliyahu and Lute Maleki, Low phase noise and spu-
rious level in multi-loop opto-electronic oscillators, Proc. Eu-
rop. Freq. Time Forum and Freq. Control Symp. Joint Meeting
(Tampa (FL, USA)), May 5–8, 2003, pp. 405–410. 1, 4.2

H. T. Friis, Noise ﬁgure of radio receivers, Proc. IRE 32
(1944), 419–422. 1.4.1

Nicolas Guﬄet, Roger Bourquin, and Jean-Jacques Boy,
Isochronism defect for various doubly rotated cut quartz res-
onators, IEEE Trans. Ultras. Ferroel. and Freq. Contr. 49
(2002), no. 4, 514–518. 2.5

[GBW+84] Zvi Galani, Michael J. Bianchini, Raymond C. Waterman, Jr.,
Robert Dibiase, Richard W. Laton, and J. Bradford Cole,

109

110

E. Rubiola The Leeson eﬀect

February 2, 2008

Analysis and design of a single-resonator GaAs FET oscil-
lator with noise degeneration, IEEE Trans. Microw. Theory
Tech. 32 (1984), no. 12, 1556–1565. 3.4.1

[Gre98]

Charles A. Greenhall, Spectral ambiguity of Allan variance,
IEEE Trans. Instrum. Meas. 47 (1998), no. 3, 623–627. 1.1

[HHWW03] Archita Hati, David Howe, D. Walker, and Fred Walls, Noise
ﬁgure vs. PM noise measurements: A study at microwave fre-
quencies, Proc. Europ. Freq. Time Forum and Freq. Control
Symp. Joint Meeting, May 5–8, 2003. 1.4.2

[Hoo69]

Friits N. Hooge, 1/f noise is no surface eﬀect, Phys. Lett. A
29 (1969), 139–140. 1.4.2

[HWB68]

[JW68]

[Lee66]

[McW57]

[Pac39]

[Pou46]

Donald Halford, A. E. Wainwright, and Jams A. Barnes,
Flicker noise of phase in RF ampliﬁers: Characterization,
cause, and cure, Proc. Freq. Control Symp., April 22–24, 1968,
Abstract only is published, pp. 340–341. 1.4.2

Gwilyn M. Jenkins and Donald G. Watts, Spectral analysis
and its applications, Holden Day, San Francisco, CA, 1968. 2

David B. Leeson, A simple model of feed back oscillator noise
spectrum, Proc. IEEE 54 (1966), 329–330. 0, 1.3

A. L. McWhorter, 1/f noise and germanium surface prop-
erties, Semiconductor Surface Physics (R. H. Kingston, ed.),
University of Pennsylvania Press, Philadelphia, 1957, pp. 207–
228. 1.4.2

William Redington Packard, A new type of resistance-capacity
oscillator, Graduate thesis, Leland Stanford Junior University,
Paloalto, CA, June 1939. 3.2

Robert V. Pound, Electronic frequency stabilization of mi-
crowave oscillators, Rev. Sci. Instrum. 17 (1946), no. 11, 490–
505. 3.4.1

February 2, 2008

E. Rubiola The Leeson eﬀect

111

[PW98]

[Rut78]

[VA89]

[Vig99]

Donald B. Percival and Andrew T. Walden, Spectral analysis
for physical applications, Cambridge, Cambridge, UK, 1998.
2

Jacques Rutman, Characterization of phase and frequency
instabilities in precision frequency sources: Fifteen years of
progress, Proc. IEEE 66 (1978), no. 9, 1048–1075. 1.1

Jacques Vanier and Claude Audoin, The quantum physics of
atomic frequency standards, vol. 2 vol., Adam Hilger, Bristol,
UK, 1989. 1.1

John R. Vig (chair.), IEEE standard deﬁnitions of physi-
cal quantities for fundamental frequency and time metrology–
random instabilities (IEEE standard 1139-1999), IEEE, New
York, 1999. 1.1

[WFJ97]

Fred L. Walls, Eva S. Ferre-Pikal, and S. R. Jeﬀerts, Origin
of 1/f PM and AM noise in bipolar junction transistor ampli-
ﬁers, IEEE Trans. Ultras. Ferroel. and Freq. Contr. 44 (1997),
no. 2, 326–334. 1.4.2

[YM96]

X. Steve Yao and Lute Maleki, Optoelectronic microwave os-
cillator, J. Opt. Soc. Am. B - Opt. Phys. 13 (1996), no. 8,
1725–1735. 4.2

[YM97]

, Dual microwave and optical oscillator, Optics Lett.

22 (1997), no. 24, 1867–1869. 3.3

