6
0
0
2
 
g
u
A
 
4
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
6
4
0
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Design Guide for Electronics for Resistive Charge
Division in Thermal Neutron Detection.

Patrick Van Esch
Thomas Gahl
Bruno Gu´erard

February 2, 2008

Abstract

An ampliﬁer has been designed for optimal use of position sensitive
thermal neutron detectors using the principle of resistive charge division.
The important points in this optimization are: high counting rates and
good spatial resolution. This ampliﬁer is built as a hybrid circuit and
is now used on several new instruments at the ILL. It consists of a fast
low noise current pre-ampliﬁer, a gaussian shaping circuit based on a
4th order active ﬁlter and an essentially noiseless baseline reconstruction.
In this paper, we present a rather complete theoretical analysis of the
problem that lead us to the choices made above, and allows for an optimal
adaptation to other situations. An analysis of unwanted, secondary eﬀects
is also worked out.

1 Introduction.

The original motivation for the design of this electronics was given by a project
called SANS-2MHZ, in the framework of the Millennium program at the Institut
Laue Langevin, the large instrument renewal eﬀort the ILL is making in order
to be competitive in the 21st century. The aim of the project was to make
a large area neutron detector with a counting rate of at least 2M Hz at 10%
dead time correction. One of the possibilities considered was to have an array
of independent, 1 meter long, 1-dim position sensitive proportional detectors.
These detectors are thin (8 mm diameter) and are based upon resistive charge
division. We will present a general analysis of the problem of spatial resolution
as a function of the electronic noise sources and take this as a guiding principle
to explain our design.

We will also analyze unwanted secondary eﬀects. Four diﬀerent contributions
are considered: extra passive resistance, the presence of a blocking capacitor, the
ﬁnite input impedance of the ampliﬁers and the presence of a certain capacitive
load on both sides.

1

2 Noise analysis of the resistive charge division

problem.

Position sensitive detection based upon charge division is a very old and well-
known technique, described in, for example, [1], or in [2]. In a classical publica-
tion by Radeka [3], it is shown that the spatial resolution that can be obtained
by resistive charge division along an RC line is determined by the temperature
T , the capacity C and the collected charge Qs in the detector:

L. /L =

2.54√kT C
Qs

(1)

when using perfect ampliﬁers and a signal shaping that is optimal with respect
to this problem. However, the fundamental hypothesis formulated to obtain
that result is that the generated charge along the electrode is fast compared
to the time scale of RC. For thermal neutron detection in cylindrical position
sensitive detectors, using a wire and He-3 gas conversion, this hypothesis is
not satisﬁed at all. Indeed, a typical detector has, say, 6KΩ/m resistance and
10pF/m capacity. The total charge collection time is not negligible compared to
the time constant, which is about 60 ns ; on the contrary, these 60 ns are almost
insigniﬁcant compared to the charge collection time. This charge collection time
is of the order of hundreds of nanoseconds, and is essentially determined by the
diﬀerence in time of arrival between the ﬁrst and the last primary charges along
the tritium and proton tracks arriving in the ampliﬁcation region on one side,
and the ﬁnite drift time of the avalanche ions in the high ﬁeld region, which
generates the current signal, on the other side.

Anticipating an (evident) result which will follow in our analysis, the spatial
resolution will improve with a higher signal (collected total charge) level ; so we
will have to work with shaping functions which are broad (in the time domain)
compared to the time constant of the RC line in order to collect most of the
useful signal. This, on one hand, invalidates the result in equation 1 in our case,
but on the other hand, simpliﬁes strongly the analysis ; indeed, we do not have
to consider the dynamic behavior of an RC line, with all its Bessel responses
and so on [4]. In the low-frequency limit where we are have to work in order to
collect our charges, the detector essentially behaves as a lumped resistor.

The preampliﬁer noise contribution can always be modelled as a series volt-
age noise source and a parallel current noise source. The voltage v(t) and the
current i(t) of both sources are random processes which are supposed to be
stationary, and gaussian. They are hence described by their spectral noise den-
sities. They could be correlated because they are obtained as equivalent sources
of the noise sources internal to the preampliﬁer, but this correlation will be
neglected. When the ﬁrst stage of the preampliﬁer consists of an operational
ampliﬁer, the constructor of the circuit gives those spectra in the data sheets.
For all practical purposes, they are a constant (it is white noise). Only in the
case of a MOSFET entry, the 1/f noise could have a signiﬁcant contribution.
We will suppose in a ﬁrst approach that the ampliﬁer is perfect if we put the

2

ith1

Rfb1

-

+

node 1

v1

ith

node 2

v2

ith2

Rfb2

-

+

amp1

amp2

Ranode

i1

i2

Figure 1: Equivalent diagram describing the noise sources in the charge division
problem in the ideal case.

noise sources outside.

The ﬁnal element which will complete our noise analysis is a feedback resis-
tor going from the output to the input. The Johnson noise of that resistor will
add quadratically to the parallel noise source of the ampliﬁer. We have now
completed the description of our basic noise circuit in resistive charge division
which is shown in ﬁgure 1. Although the ampliﬁers are modelled as operational
ampliﬁers (and in our case, we really do use such ampliﬁers), our analysis ap-
plies to just any feedback ampliﬁer structure. All sources are considered to be
independent of each other. The measured quantities are the currents in Rf b1
and Rf b2. We consider the ampliﬁers amp1 and amp2 to be perfect. Node 1
is hence kept at v1 and node 2 at v2. Solving for the current in the feedback
resistors, we have:

I1 = ith1 + i1 −

ith +

I2 = ith2 + i2 + ith +

v2 −
v1
Ranode
v1 −
v2
Ranode

Let us consider that i1 includes ith1 and that i2 includes ith2. When calcu-

lating the sum and the diﬀerence of both signals:

I− = I1 −
I+ = I1 + I2 = i1 + i2

I2 = i1 −

i2 −

2ith −

2

(v2 −
v1)
Ranode

The spectral densities of the signals combine in square and the cross terms drop

(2)

(3)

(4)

3

out, so we ﬁnd, using the Johnson noise expression for the resistor noise sources:

16kT
Ranode

+ 8

v2
noise
R2

anode

− = 2i2
I 2

noise +

I 2
+ = 2i2

noise
noise = i2

Here, it is understood that i2
amp +4kT /Rfb, iamp being the equivalent
current noise density of the ampliﬁer, and vnoise is the equivalent voltage noise
density of the ampliﬁer. Although these expressions are in general spectral
quantities, in the adopted hypothesis of white noise, they reduce to numbers.
In order for the thermal noise to be the dominant contribution, Ranode should
be in the range:

v2
noise
2kT ≪

Ranode ≪
If we take as an example an ampliﬁer and feedback current noise of 2.0pA/√Hz
and a voltage noise of 1nV /√Hz, this interval goes from 125Ω to 8KΩ.

(7)

If the time-invariant transfer function from input current to output voltage

is H(f ), then the root mean square (r.m.s.) of the output noise is given by:

8kT
i2
noise

In our case of white noise, this reduces to:

v2
r.m.s. =

i2
n|

2df
H(f )
|

∞

f =0

Z

vr.m.s. = in

∞

2df
H(f )
|

f =0 |

sZ
So knowing the input current noise spectral density, we have to multiply by a
number which depends only on the overall transfer function (shaping function)
to ﬁnd the 1 sigma deviation on the output voltage. Of course, this operation
also applies to the sum and the diﬀerence signals. The contribution of the
electronic noise on the spatial resolution of the detector can be determined as
follows. Consider the dimensionless parameter p = (A
B)/(A + B). Here, A
and B are instantaneous samples of the output signals of the ampliﬁers at their
peaking value. In the ideal case, p runs from -1 to 1 when the physical position
runs from 0 to length L. The error on p due to the noise, considering that the
noise on A-B and A+B is not correlated (as can easily be veriﬁed assuming
identical transfer functions), is given by:

−

δrmsp =

p2v2

+r.m.s. + v2
A + B

q

−r.m.s.

This translates in a FWHM position resolution of:

δFWHMx = √2 ln 2L

p2v2

+r.m.s. + v2
vsignal

q

−r.m.s.

4

(5)

(6)

(8)

(9)

(10)

(11)

Here, vsignal is the sum of both voltage signals for an ”average” event.

Let us now analyze the general behavior of the inﬂuence of the shaping
function on the spatial resolution. Imagine an initial charge q, which is deposited
instantaneously at the entrance of the ampliﬁer, so i(t) = qδ(t). The output of
the ampliﬁer is nothing else but the impulse response of the system times q, and
H(f) is the Fourier transform of that impulse response. Of course, an overall
ampliﬁcation factor doesn’t inﬂuence the spatial resolution as the signal and the
noise are multiplied by it, so in order to compare transfer functions, one should
normalize them such that the peak value (the maximum of the impulse response)
is always equal to 1. It is easy to work out that the amplitude normalized impulse
response scales in time as:

and:

hτ (t) = h1(t/τ )

Hτ (f ) = τ H1(τ f )

(12)

(13)

In these expressions, the subscript 1 corresponds to a time-normalized impulse
response, and τ corresponds to the time scale parameter (the shaping time
constant).

The input noise calculations are independent of the transfer function, and
are related to the output noise by the factor given in equation 9. For an am-
plitude normalized transfer function, this factor then gives the absolute ”noise
performance” of a shaping function, so we will call this factor the absolute noise
performance factor (ANPF) of the shaping function.
It should be as low as
possible. It is easy to determine that the ANPF scales as √τ when using the
expression 13. So we have the at ﬁrst sight remarkable conclusion that the faster
the ampliﬁer (the shorter the shaping time) the better the position resolution.

If we can deﬁne a time scale parameter which is independent of the shape of
the impulse response, then we can deﬁne a ’relative noise performance factor’
by dividing its ANPF by √τ . We then have a quantity which can compare
diﬀerent shapes of transfer functions according to their merit. The problem
with this deﬁnition is of course that a judicious choice of time scale parameter
can artiﬁcially give an advantage to one or another shape so one should be
prudent in drawing conclusions.

We can deﬁne the gain G of the ampliﬁer as the maximum of the impulse
response. Writing H(f ) the normalized transfer function, the full transfer func-
tion of an ampliﬁer is then GH(f ). In that case, vsignal in formula 11 is equal to
GQs. As expected, this factor G drops out of the expression for the resolution.

δFWHMx = √2 ln 2L√τ RNPF

2i2

noise(1 + p2) + 16kT
Ranode

+

s

8v2

R2

noise
anode

Qs

(14)

Expression 14 expresses the resolution due to electronic noise as a function of the
shape and time scale of the overall transfer function, the event charge produced
by the detector, the anode resistance and the equivalent voltage and current
noise sources of the preampliﬁer. The hypothesis is put forward of an otherwise

5

ideal ampliﬁer and full dynamics. If the sensitive region occupies only a fraction
D (0 < D < 1) of the whole dynamics of the quantity p = (A
B)/(A + B),
then the resolution will have to be scaled up with an extra factor equal to 1/D,
see section 5. As long as D is not too far from 1, we can neglect the inﬂuence
of these extra components in the equivalent circuit on the noise calculation.

−

3 Gaussian Shaping Function.

Although the pure pole approximation to a gaussian ﬁlter is a well-known item,
we shortly sketch its derivation in order to make clear all our normalization
conventions. The ideal gaussian shape as an impulse response would be propor-
tional to:

hperfect(t) =

exp(

t2/2)

−
√2π

(15)

ω2/2),
its associated transfer function (in the variable ω = 2πf ) equals exp(
or, in the Laplace variable s, exp(s2/2). Of course, as such, it is not realizable.
Using the well-known approximation scheme [6] of this transfer function into a
stable, pure-pole ﬁlter by expanding D(s) = 1/(H(s)H(
s)) as a polynomial up
to order 2n, and constructing H(s) = 1/D+(s), where D+(s) is the polynomial
of order n with the same zeros as D(s) in the left half complex s-plane, we ﬁnd
for n = 4:

−

−

1/D+(s) =

4.90...
4.90... + 11.42...s + 10.86...s2 + 5.07...s3 + s4

(16)

where we took the value of the numerator such that H(0) = 1 (because in the
process, the amplitude normalization became arbitrary). The impulse response
(the inverse Laplace transform of H(s)) approaches the perfect gaussian response
(up to a time shift) and corresponds to a realizable, stable pure pole ﬁlter of
4th order. We arbitrarily deﬁne its time scale τ to be equal to 2π, which
corresponds to about the time where the response is ”signiﬁcantly diﬀerent from
0” (eg, the total visible width of the pulse). 1/τ also corresponds closely to the
cut-oﬀ frequency of this low pass ﬁlter. The ﬁnal thing to do is to normalize
the amplitude of the impulse response to 1. The peaking time of the impulse
response occurs at 0.3114τ , and it turns out that we have to divide the above
transfer function by 2.507 in order to obtain this amplitude normalization. So
we obtain ﬁnally:

hτ (t) = 3.86e

−8.52t/τ cos

3.86e

−7.42t/τ cos

(17)

+ 35.33e

−8.52t/τ sin

10.29e

−7.42t/τ sin

6.66t
τ
6.66t
τ

The corresponding transfer function is:

Hτ (s) =

3046.1τ
7635.2 + 2833.4sτ + 429.0s2τ 2 + 31.9s3τ 3 + s4τ 4

(18)

2.06t

τ −
2.06t

τ −

6

Now that we have the normalized transfer function of this ﬁlter, we can calculate
the ANPF (by using H(s = i2πf ) ) and it turns out to be:

AN P F = 0.3788√τ

Filling this into the expression for the spatial resolution, we obtain:

2i2

noise(1 + p2) + 16kT
Ranode

+

s

8v2

R2

noise
anode

δFWHMx = 0.446L√τ

Qs

Let us take as an example a 1KΩ resistance, and the same noise sources as
cited earlier. If we have a detector that delivers a harmonic average of 0.4pC
per event and we apply a gaussian shaping time of 1.4µs, then on a 1 m long
detector we should be able to achieve a resolution of 12 mm along the detector.
If the resistance is 6.5KΩ, the resolution in the middle of the detector is 5.6
mm, and on the borders 6.7 mm. The numbers in this last example have not
been chosen at random: they correspond to an experimental situation we have
set up. Measurements using a narrow neutron beam on a prototype Reuter
Stokes detector with an overall resistance of 6.5KΩ lead to an observed FWHM
resolution 5.7 mm in the middle of the detector and a deterioration towards
7 mm near the ends of the detector, conﬁrming our calculation. In this mea-
surement, wide word lengths (10 bits) were used to code the position. If we
measure the r.m.s. noise of the sum and diﬀerence output signals of gaussian
ampliﬁers having a gain of 3V /pC in this setup, we measure 6.0mVrms for the
diﬀerence and 4.1mVrms for the sum signal. Calculations give 5.7mVrms for the
diﬀerence signal, and 3.8mVrms for the sum signal, showing an agreement with
the measurements with less than 10% deviation.

Let us compare this gaussian transfer function with the ”standard” RC-CR

function: its amplitude normalized impulse response is given by :

where τ is its peaking time and its transfer function equals:

hrccr(t) =

e1− t

τ

t
τ

Hrccr(s) =

e
τ (1/τ + s)2

(19)

(20)

(21)

(22)

The ANPF of this RC-CR ﬁlter equals e/(2√2)√τ = 0.961√τ . However, in
order to really compare the ANPF values, we should adapt the τ in this deﬁni-
tion to the one we used in the gaussian ﬁlter. We will propose identical peaking
times: in that case, we have to replace τ by τ = 0.311441τ ′ in the above ANPF
expression, leading to AN P F = 0.536√τ ′. So we observe that the gaussian
ﬁlter, for identical peaking times, improves the spatial resolution by about 42%
over the result one would obtain using the standard RC-CR ﬁlter.

If we take a rectangular shaping function with width τ ,

hsquare(t) = 1

step(t

τ )

−

−

(23)

7

the transfer function is:

Hsquare(s) =

1

−

e−τ s
s

(24)

p

τ /2 = 0.707√τ . Again, in order to compare the τ
and the ANPF equals
values, we take the width of the square function to be the FWHM, the peaking
time not being applicable in this case, of the gaussian approximation which
equals 0.38171τ . So we should ﬁll in τ = 0.38171τ ′ in the expression of the
ANPF, to obtain that the AN P F = 0.4369√τ ′. Again, the gaussian ﬁlter
improves the spatial resolution by 15% over the result one would obtain with a
square ﬁlter for identical FWHM times.

All this indicates that the gaussian transfer function as derived above is a

very acceptable solution to the shaping problem for resistive charge division.

4 The electronic implementation.

The analogue part of the circuit implemented at the I.L.L. in the frame of the
SANS-2MHZ program takes on the following form: a pre-ampliﬁer which acts
as a current ampliﬁer, a gaussian ﬁlter implemented as an active ﬁlter and a
baseline correction circuit.

4.1 The preampliﬁer

The preampliﬁer needs to satisfy 3 criteria: the ampliﬁer noise contributions
have to be such that they don’t deteriorate signiﬁcantly the spatial resolution,
the input impedance has to be as low as possible and it has to stand very
high counting rates. The fact that there is anyway a resistive noise source (the
resistive anode) eliminates the noise advantages a charge ampliﬁer has. Indeed,
in order to stand very high counting rates, we opted for a current ampliﬁer,
which suﬀers no pile up eﬀects. The transfer function of the circuit is chosen to
be a ﬁrst order system with a time constant of the order of the time constant
of the detector, about 60 ns. In order to achieve a very low input impedance,
a high open loop gain is required, as explained in subsection 5.3. The high
bandwidth combined with the high open loop gain made us decide to go for a
bipolar operational ampliﬁer.

Expression 20 is the guiding principle to select the operational ampliﬁer,
which has to have a very high open loop unity gain bandwidth. The best values
one can obtain for the current noise are around 1.5pA/√Hz, which doesn’t
contribute signiﬁcantly to the resolution as long as the anode resistance is below
10KΩ. This comforts our choice of a bipolar circuit, such as the CLC425 from
∼
National Semiconductor, unfortunately now not in production anymore. The
feedback resistor doesn’t have a signiﬁcant inﬂuence compared to the current
noise of the ampliﬁer as long as it is above about 12KΩ. A feedback capacitor of
about 5 pF lets us obtain the right bandwidth in this case, which is a satisfying
value.

8

Cfb

Rfb

Input

Rp

Rp

Dp

Dp

-

+

protection
circuit

RT1

RT2

Output

T =
(RT1+RT2)
RT2

Figure 2: Basic scheme of the preampliﬁer.

The basic scheme that we obtain for the structure of the preampliﬁer is

shown in ﬁgure 2.

∼

As long as the voltage noise is a few nV /√Hz, and the anode resistance is
1KΩ) this term doesn’t contribute signiﬁcantly to the
not too low (above
spatial resolution. If a resistive protection circuit against accidental discharges
is required, care should be taken to include it in the feedback loop (as shown in
ﬁgure 2), otherwise its resistance adds to the input impedance. One should be
warned, however, that the resistive part of such a circuit will add to the voltage
noise of the circuit.

In order to obtain a larger gain, a T-type feedback structure can be used
(see ﬁgure 2). An extra advantage of using a current ampliﬁer over a charge
ampliﬁer is that no pole-zero cancellation network is needed. The preampliﬁer
is AC coupled to the gaussian ﬁlter.

4.2 The gaussian ﬁlter.

The fact that for neutron detection, time constants of the order of the microsec-
ond are used allows us to use operational ampliﬁers (designed for the telecom
industry) in active ﬁlters to implement the gaussian transfer function. Fac-
torizing expression 18 into two second-order contributions, we notice that the
Q-factors of both circuits are quite low and that hence a simple Multiple Feed-
back Network [5] can be used to implement them. Although possible, passive
LC ﬁlters require rather large self inductance values on this time scale, so we
reserve that kind of ﬁlters to faster circuits.

9

R1

R2

-

+

Input

Rin

Output

D1

D2

Figure 3: The baseline correction circuit: extraction of the baseline.

4.3 The baseline correction circuit.

Given the fact that the gaussian impulse response is unipolar, there is a problem
of a shifting baseline at high counting rates. A simple clamping circuit has
the disadvantage of clamping on the noise, so we would have a noisy baseline
correction. In order to solve this problem, we use the circuit displayed in ﬁgure
3. In that ﬁgure, Rin translates the input voltage into a current. If the voltage
is positive, the feedback loop is closed through resistor R2 and diode D2 ; the
voltage at the output is 0. If the input voltage is negative, the loop is closed
R1/RinVin, which is a positive
through R1 and D1. The output voltage is now
quantity. Taking Rin = R1, if the signal from the gaussian shaper is applied to
this circuit, then the output equals minus the baseline which is negative. It is
now suﬃcient to low pass ﬁlter this output and add it to the input signal with a
simple active adder circuit to restore the baseline. The path R2/D2 prevents the
feedback loop from ever opening completely, and hence keeps the operational
ampliﬁer from saturating.
If the application is continuous irradiation, then
the baseline will vary very smoothly and a simple ﬁrst order low pass (RC)
circuit with a cutoﬀ frequency below say 1KHz can do. However, in pulsed
time of ﬂight applications, the baseline also ﬂuctuates more rapidly, and a more
sophisticated ﬁlter might be necessary in order to ﬁlter all noise and glitches,
but reacting fast enough to the changing baseline.

−

4.4 The conversion circuitry.

An analogue peak detector with threshold on the sum signal triggers 2 single shot
12 bit ADC converters with a dynamic range of 5 V. The 11 most signiﬁcant

10

Zi

Cbloc

Cbloc

Zi

rpara

q1

rpara

q2

R

qin

r1

r2

Ccable

Ccable

0

x

L

Figure 4: Equivalent circuit of all secondary eﬀects we are considering.

bits of each conversion are used to compose a 22 bit word which serves as
an address in a position lookup table. This lookup table is materialized by
an EPROM circuit ; the result of the lookup operation is the position of the
impact in an 8-bit word. The quantization noise of the ADC (= 5V /2111/√12 =
0.7mVrms ) should be smaller than the noise at the output of the ampliﬁers.
It should be noted that here, the right choice of the gain to map the signal
range to the dynamic range, is important. The quantization noise added to
the resolution by truncating the result to an 8 bit word results in a FWHM
resolution of L/281/√12√8 ln 2 = 0.00266L, which should be added in square
to the resolution obtained in 20. Taking our measurements again, which had a
spatial resolution of 5.7 mm using wide word lengths, when coding on 8 bits,
using the above formula, we should increase theoretically the resolution to 6.3
mm. Measurements lead to 6.6 mm of resolution when coding on 8 bits.

5 Secondary eﬀects.

In order to perform the above analysis, we used a ”perfect” circuit. In reality,
there are unavoidable secondary eﬀects which have an inﬂuence on the perfor-
mance. We will study the 4 most prominent ones, and make the assumption
that the situation remains symmetrical. First we will study the presence of an
additional passive resistance. Interesting in its own right, it also introduces the
notion of ”equivalent resistance” for any other contribution to the reduction of
the dynamics, and hence makes it possible to compare the importance of several
diﬀerent contributions. A most important inﬂuence is played by the blocking
capacitor, which is a necessary component to protect the electronics from the
high bias potential applied to the resistive electrode. It has two eﬀects: one is
a reduction of dynamics (just as the extra resistance), the other is to introduce
an undershoot in the signal. The ﬁnite input impedance of the preampliﬁer
can also contribute signiﬁcantly to the loss in dynamics. Finally, the presence
of a capacitive load (due to the wiring up of the detector) will not inﬂuence
the dynamics, but will introduce a noise contribution that can deteriorate the
spatial resolution.

We will study all these eﬀects one by one but we will not study their combined
eﬀects. The overall scheme is displayed in ﬁgure 4. The ideal case would give us

11

a relationship between the position x and the collected charges q1 and q2 given
as follows:

−
We can hence introduce an ideal dimensionless position p as follows:

(cid:16)

(cid:17)

q1 =

1

qin; q2 =

qin

x
L

x
L

When p =
We will observe that several eﬀects change this relationship into:

1, we hit position x = 0, and when p = +1, we hit position x = L.

−

p =

q1
q2 −
q1 + q2

=

r2
r1 −
r1 + r2

p =

q1
q2 −
q1 + q2

= D

r2
r1 −
r1 + r2

where D is a number between 0 and 1, and is called the dynamical factor.

5.1 Additional resistance.

Imagine that the resistive electrode continues to be resistive beyond the sen-
sitive area, or that some resistance is present in the conducting circuit before
reaching the — supposed perfect — current ampliﬁer at 0 impedance (virtual
ground). Let us suppose that the case is symmetrical and that an extra resis-
tance rparasite is added at both sides. We have now, for an injection at point
x of a total length L:

q1 = qin

q2 = qin

r2 + rparasite
R + 2rparasite
r1 + rparasite
R + 2rparasite

If we now calculate the range that can be taken up by p = (q2 −
r2

r1 −
R + 2rparasite

=

R
R + 2rparasite

r2
r1 −
r1 + r2

p =

q1)/(q1 + q2):

we observe that the dynamical factor is:

D =

R
R + 2rparasite ≃

rparasite
R

2

1

−

r2)/(r1 + r2),
So the calibration, (q2 −
stays linear, but the slope is reduced. The second approximation is valid if the
parasitic resistance is small compared to the useful resistance of the resistive
electrode.

q1)/(q1 + q2) as a function of (r1 −

(25)

(26)

(27)

(28)

(29)

(30)

(31)

12

5.2 Blocking capacitor.

If we introduce a blocking capacitor Cbloc, or shortly C, on each side (see ﬁgure
4), we ﬁnd as current transfer functions (injected current to collected current):

i1(s) =

i2(s) =

1 + Cr2s
2 + C(r1 + r2)s
1 + Cr1s
2 + C(r1 + r2)s

(32)

(33)

(34)

(35)

(36)

(37)

(38)

If we look at the time domain responses of these transfer functions:

i1(t) =

i2(t) =

−

e

C(r

2t
1 +r

2) (r1 −
C(r1 + r2)2
2) (r2 −
C(r1 + r2)2

2t
1 +r

r2)

r1)

+

+

r2
r1 + r2

r1
r1 + r2

δ(t)

δ(t)

−

e

C(r

The time signals clearly contain two parts: the second term is exactly what we
would have if we were in the ideal case, and the ﬁrst term is the eﬀect of the
capacitors. It is an exponential decay with a time constant of C(r1 + r2)/2.
It has moreover the opposite amplitude behavior than the ideal term: indeed,
when the injection point goes more to the left, so that the i1 current increases,
the extra term becomes more and more negative. On the other hand, when the
injection point goes to the right, so that the ideal term almost vanishes, the
extra term becomes positive and more and more important.

The two extra terms in i1 and i2 are opposite, so that they cancel in the sum.
This is something important: on the sum signal, the eﬀect of the extra capacitors
vanishes. This means that the sum signal contains the timing information,
independent of the position of the impact.

We should of course convolve this injected current with the overall impulse

response of the shaping ampliﬁer. There are two contributions:

i1 ⋆ h(t) = (r1 −
i2 ⋆ h(t) = (r2 −

r2)V (t) +

r1)V (t) +

r2
r1 + r2
r1
r1 + r2

h(t)

h(t)

In these expressions, we introduced the function V(t):

V (t) =

RC

e−2 t
CR2 ⋆ h(t)

V(t) doesn’t depend on the injection point along the electrode, but only on
R = r1 + r2. We notice two things: while the second term in each expression
gives exactly what we wanted to obtain, the ﬁrst one disturbs the response
in a non-proportional way. This means that the individual maxima of the two
functions will in general not occur together in time, and the relative deformation
of the signal will depend on the injection point. If we would take those individual

13

maxima as charges to be collected, the calibration curve would be non-linear.
However, if we can take a common sample time T for both curves which is
independent of the injection point, and which corresponds to the maximum of
the impulse response (G), we ﬁnd the following:

(39)

(40)

(41)

(42)

(43)

(44)

(45)

q1 = (r1 −
q2 = (r2 −

r2)V (T ) +

r1)V (T ) +

r2
r1 + r2
r1
r2 + r1

G

G

p =

q1
q2 −
q2 + q1

=

r1 −
r2
1
r1 + r2 (cid:18)

2(r1 + r2)V (T )
G

−

(cid:19)

So we see here that the calibration curve corresponds to a straight line, with a
reduction factor of the dynamics that is equal to:

D = 1

2RV (T )
G

−

= 1

2

1
GRC

−

−2 t

e

RC ⋆ h(t)

(cid:16)

t=T

(cid:17)

When we compare the expression of the loss in dynamics with the one for a re-
sistor at both ends, we can identify both formulas in the approximation of small
deviation from unity. In that case, it is as if the coupling capacitor introduced
an equivalent parasitic resistance:

req =

−2 t

e

RC ⋆ h(t)

1
GC

(cid:16)

t=T

(cid:17)

If we assume that the time constant CR is larger than the time scale (and of
course the sampling time) of the shaping function, then the exponential with
which we have to convolve looks essentially like a unit step function.
If we
replace it in the convolution integral, we have:

req

≃

1
GC

T

t=0

h(t)dt

Z
The equivalent resistance of the coupling capacitor turns out to be simply in-
versely proportional to the capacity times a constant that only depends on the
shaping function. It really has a meaning of an equivalent resistance. It turns
out that for a Gaussian 4th order ﬁlter function, this expression is numerically
equal to:

req

≃

0.1576

τ
C

Here, τ is the time scale of the Gaussian shaper as we deﬁned it.

A remark of a technical nature is maybe due: the capacitance is of course the
dynamic capacitance (small signals) for the capacitor under the static bias load
that one has in mind. For a perfect capacitor, that doesn’t make any diﬀerence,
of course ; however, for ceramic capacitors using the X7R dielectric, for example,
that dynamic capacity is reduced by 40% when working at the nominal voltage
!

14

A second problem, introduced by the presence of blocking capacitors, is the
fact that there can be an undershoot on the ”large” signal. This undershoot
is a problem in the case a baseline correction is used. We can estimate an
upper boundary of the value of the undershoot as follows: given that we are
just outside of the time lapse where the shaper function is important (if it is
a well-peaked function such as a Gaussian), the undershoot is essentially the
sample value of the ”non-ideal” part of the impulse response at that moment.
Of course, there will be a slight contribution of the shaper response, so the
actual undershoot will be slightly less than this value. But we will obtain a
reliable upper boundary. Let us calculate this value now for r1 = 0 and r2 = R:

RV (T

′

)

u1 ≃

(46)

We sample at t = T ′, assuming that h(t) has no contribution anymore there.
This can be worked out as follows:

u1 ≃

R

RC

e−2 t
CR2 ⋆ h(t) =

1
RC

e

− 2

RC T

′

′

T

t=0

Z

h(t)e

2t
RC dt

(47)

The last integral can be extended to inﬁnity (because h is supposed to be neg-
ligible outside of the range 0-T’). As H(s) normally has poles with a real value
much more negative than the exponential coeﬃcient, this operation is allowed.
We can replace the integral by a sample point of the Laplace transform of h
(the shaper transfer function). In that case, we ﬁnally obtain as our undershoot
estimation (in absolute value):

u1 ≃

1
RC

e

− 2

RC T

′

H

s = −

2
RC

(cid:19)

(cid:18)

(48)

(50)

To obtain the relative undershoot, we have to divide that expression by the gain
of the shaper function. Knowing the scaling relations of the transfer function
in the case of unity gain, we see that the undershoot only depends on the
ratio of T ′/(RC). In the case of a gaussian ﬁlter, then taking T ′ = τ gives us
numerically:

3046.1xe−2x
7635.3 + 2833.4(2x) + 429.01(2x)2 + 31.9(2x)3 + (2x)4 ≃

u1 ≃

0.399x (49)

where:

x =

τ
RC ≪

1

The undershoot introduces an essentially random error in the case of a baseline
correction, with an amplitude limited to the above amount. It depends on the
image that is projected onto the detector. It should hence be smaller than the
relative error introduced by the noise over the full dynamics of the signals.

We use 68nF capacitors as blocking capacitors in our application. With
1.4µs gaussian shaping, this corresponds to an equivalent resistance of 3.2Ω
which is really negligible. The maximal undershoot, given a dynamics of 5V,

15

and a detector resistance of 6.5KΩ, is 6.3mV . This is of the same order of
magnitude as the noise levels (see our previously calculated example). We see
here that it is in fact the undershoot which gives us the most severe condition
on the value of the blocking capacitor.

5.3 Input impedance.

The input impedance of the preampliﬁer circuit also has as an eﬀect to reduce
the eﬀective dynamics of the charge division. We will give an estimation of this
eﬀect. The input impedance of a current ampliﬁer with a transimpedance Z(s)
determined by a passive feedback loop, is easily found out to be equal to:

Zin(s) =

Z(s)
A(s)

where A(s) is the open loop transfer function of the ampliﬁer. We will take it
that Z(s) is represented by a ﬁrst order system. In ﬁgure 2, this is the feedback
resistor Rfb times the gain factor T of the T-network, and the time constant
tpre is given by the feedback resistor and its parallel capacitor. It is a bit more
delicate to write down the open loop transfer function A(s) of the operational
ampliﬁer: indeed, large bandwidth ampliﬁers usually have very complicated and
not very well known transfer functions. However, because of the gaussian ﬁlter,
we only use a limited part of that bandwidth, and we will assume that we can
model the open loop gain by a ﬁrst order system with dc gain Aol and time
constant tol. The impedance then becomes:

If we now deﬁne the following equivalent elements:

Zin(s) =

TfbRfb(1 + tols)
Aol(1 + tpres)

r =

l =

TfbRfb
Aol
TfbRfbtol
Aol

= tolr

Zin(s) =

r + ls
1 + tpres

we can rewrite the input impedance as:

(51)

(52)

(53)

(54)

(55)

At ﬁrst sight, one would be inclined to neglect the pole in this expression.
Indeed, the preampliﬁer is supposed to represent a current ampliﬁer, and hence
be much faster than the gaussian shaping ﬁlter that follows. In that case, the
input impedance of the ampliﬁer is equivalent to the series circuit of a resistor of
value r and an inductor of value l. We tried this, and to our surprise the results
are numerically quite diﬀerent from the results obtained when we don’t neglect
this pole. So this pole cannot, in the cases we’re interested in, be neglected.

16

r

l

tpre / r

l / tpre

17

Figure 5: The equivalent circuit of the input impedance of the ampliﬁer.

If we analyze the structure of the input impedance, we can easily show [6]
that this corresponds to the passive circuit displayed in ﬁgure 5. Using the same
approach as in the case of the blocking capacitor, we ﬁnd that the currents take
on the form:

i1(t) =

i2(t) =

r2)(l

(r1 −
rtpre)
−
(2l + (r1 + r2)tpre)2 e
−
(r1 −
rtpre)
−
(2l + (r1 + r2)tpre)2 e

r2)(l

− 2r+r
1 +r
2l+(r

2

1 +r
2)tpre t

− 2r+r
1+r
2l+(r

2

1+r
2)tpre t

+

l + r2tpre
2l + (r1 + r2)tpre

δ(t)(56)

+

l + r1tpre
2l + (r1 + r2)tpre

δ(t)(57)

Again, the sum of both signals is not aﬀected by the presence of this input
impedance. We next convolve these expressions with the transfer impedance of
the shaping ampliﬁer, which in our case is the 4th order gaussian ﬁlter function.
Finally, sampling at the time when the sum signal attains its maximum, we
obtain the sampled charges q1 and q2 at each side. The calibration remains
linear, but a reduction of dynamics is introduced by this input impedance.
This allows us to deﬁne an equivalent resistance. The result of these algebraic
operations is:

requi = R

rRtpreV (α) + l(2r + R
Rtpre + 2rtpre(1

RV (α))
V (α)) + 2lV (α)

−

−

In this expression, we deﬁned R = r1 + r2 the anode resistance, and:

α =

2r + R
2l + Rtpre

τgauss

The function V (α) is now deﬁned as follows:

V (α) = αe(−0.3114α)

0.3114

h1(t)eαtdt

t=0

Z

using the time normalized gaussian ﬁlter function h1(t). We observe that the
equivalent resistance doesn’t depend on the injection point (is no function of r1
or r2 individually), which conﬁrms the linearity of the calibration, but it is a
function of the total anode resistance R. Working out numerically the integral,
we ﬁnd:

V (α) =

α(3046.1e−0.3114α + (α

12.02)(153.3

19.9α + α2))

(76.8

−

−
17.0α + α2)(99.5

−
14.8α + α2)

−

We can obtain an interesting result when we take the limit of big R, meaning,

much bigger than 2l/tpre or r. α then converges to a limiting value given by:

and the expression for the equivalent resistance reduces to:

αlim =

τgauss
tpre

rlim
equi =

l(1

−

V (αlim))
tpre

+ rV (αlim)

18

(58)

(59)

(60)

(61)

(62)

(63)

We now observe that for large enough detector resistance R, the equivalent
input resistance of the circuit is a well-deﬁned quantity.
In cases where the
input impedance is a crucial parameter, we should optimize the ratio of the
gaussian shaper and the preampliﬁer time constant such that the associated
equivalent resistance is minimized. In fact, the perfect match occurs when the
preampliﬁer time constant is equal to l/r = tol. Usually, this time constant is
too big to be used (it should still be smaller than the gaussian shaping time), so
a less optimal choice has to be made. Diminishing the gain of the preampliﬁer
also reduces the input impedance.

As an example, we have taken a preampliﬁer based on a CLC425 opera-
tional ampliﬁer (modelled with open loop dc gain of 20000 and corner frequency
100kHz), a feedback resistor of 12KΩ in parallel with a 5.6pF feedback capaci-
tor, and a T-factor of 13.0. With a 1.4µs gaussian shaping, the above calculation
leads to an equivalent resistance of 26.9Ω when the detector is 500Ω ; we have
measured 26Ω. The limiting value is 21.0Ω.

5.4 Capacitive load.

We will now analyze the eﬀect of an extra load capacitor on both sides of
the detector, as displayed in ﬁgure 4. This corresponds partly to the detector
capacity itself, but mainly to the extra capacitive load that is introduced by the
conductors leading from the sensitive electrode up to the input of the ampliﬁers.
An order of magnitude is 1 pF per cm of (coaxial) connection wire. If we add
this capacity C on both sides of the noise equivalent network in ﬁgure 1, the
noise currents now become:

I1 = ith1 + i1 −

ith +

I2 = ith2 + i2 + ith +

v2 −
v1
Ranode −
v1 −
v2
Ranode −

sCv1

sCv2

The spectral densities of the sum and diﬀerence signals then take on the follow-
ing form:

−(f ) = 2i2
I 2

noise +

+ 8v2

noise(π2f 2C2 +

16kT
Ranode

1

R2

anode

)

(65)

+(f ) = 2i2
I 2

noise + 8v2

noiseπ2f 2C2

So to both densities, we add the quantity:

C(f ) = 8v2
i2

noiseπ2f 2C2

This time it is clear that these noise spectral densities are a function of frequency
f. We cannot apply the simple factor anymore as in equation 9. In fact, our
noise formulas are of the form: a + bf 2, so we can still use 9 for the a-part, but
we now need a second number for the b-part. The extra part equals:

r.m.s.−C = 8π2v2
v2

noiseC2

f 2

2df
H(f )
|
|

∞

f =0

Z

19

(64)

(66)

(67)

(68)

(69)

(70)

(71)

(72)

We deﬁne now the capacitive noise number η:

η =

∞

f =0

Z

f 2

2df
H(f )
|
|

It can easily be veriﬁed that η scales as 1/τ , and not, as is the case for the white
noise contribution, as τ . So this capacitive load noise becomes more and more
important when the time scale becomes small. We can call √η the capacitive
noise performance factor (CNPF) if we work with the amplitude normalized
transfer function. For the gaussian 4th order approximation, we can work out
that:

CNPF =

0.2856
√τ

This means that we have an eﬀective extra contribution to the sum and diﬀer-
ence noise current densities (considered as white noise), equal to:

For the gaussian shaping function, this turns out to be:

ieﬀ
C =

2√2πCNPFvnoiseC
ANPF

ieﬀ
C = 6.70

vnoiseC
τ

As an example, a 1.0nV /√Hz voltage noise density over a capacity of 100 pF
(1 meter of coaxial cable) and a time constant of 1µs gives us an eﬀective
noise current of 0.67pA/√Hz. This is still smaller than the other noise current
contributions (but its eﬀect should start to become visible).

In order to add this eﬀect to the spatial resolution, it is suﬃcient to replace
the sum and diﬀerence currents by their combination, squared, with this eﬀective
current.

6 Conclusion.

The principles leading to the design of the front end electronics for resistive
charge division in thermal neutron detection in high counting rate applications
are exposed. The choice we made for the analogue part consists of three sub
functions: a preampliﬁer which acts as a current ampliﬁer, based upon a fast,
bipolar operational ampliﬁer ; a 4th order gaussian shaping circuit based upon
simple active ﬁlter circuits, and a noiseless baseline correction. A detailed anal-
ysis is presented leading to the expression (equation 14) which gives the spatial
resolution as a function of the detector signal, the noise sources of the pream-
pliﬁer and the gaussian shaping time constant. A comparison of the gaussian
transfer function with the standard RC-CR and the square pulse serves as a
motivation for the gaussian shape. A short description of the practical imple-
mentation as hybrid circuits follows.

20

A profound analysis of several secondary eﬀects are given. Two important
eﬀects are due to the blocking capacitor. Its equivalent dynamical resistance is
given in equation 45, and an upper boundary to the undershoot it introduces
is given in equation 49. Also a detailed analysis of the inﬂuence of the input
impedance of the ampliﬁer is presented, leading to indications how to optimize
this quantity if necessary. Finally, the noise contribution due to the capacitive
load is worked out in equation 72.

Some experimental results conﬁrm the calculations presented here.
Although our analysis was focussed on the design of the front end electronics
for the SANS-2MHz project at the Institut Laue Langevin, the results are of
a suﬃciently general nature to allow them to be a guide for other designs in
position sensitive detection.

References

[1] K. H. Lauterjung et al., Nucl. Instr. Methods 22, 117 (1963)

[2] W. R. Kuhlmann et al., Nucl. Instr. Methods 40, 109 (1966)

[3] Radeka V. 1974, IEEE Trans. Nucl. Sci. NS-21, 51

[4] F. Schneider, CERN 82-06, 4 June 1982

[5] Johnson, Johnson and Moore, A Handbook of Active Filters

1980

c
(cid:13)

Prentice-Hall, Inc.

[6] M. E. Van Valkenburg, Introduction to Modern Network Synthesis, c
(cid:13)

1960

John Wiley and Sons.

21

