7
0
0
2
 
n
a
J
 
0
1
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
2
2
1
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Outer Tracker Detector of the HERA-B
Experiment.
Part III: Operation and Performance

HERA-B Outer Tracker Group

H. Albrecht h, T.S. Bauer a,m, M. Beck ℓ, K. Berkhan n,
G. Bohm n, M. Bruinsma a,m, T. Buran k, M. Cape´ans h,
B.X. Chen d, H. Deckers e, X. Dong c, R. Eckmann b,
D. Emeliyanov h, G. Evgrafov h,1, I. Golutvin g, M. Hohlmann h,
K. H¨opfner h, W. Hulsbergen a, Y. Jia c, C. Jiang c,
H. Kapitza f,∗, S. Karabekyan ℓ,3, Z. Ke c, Yu. Kiryushin g,
H. Kolanoski e, D. Kr¨ucker e, A. Lanyov g, Y.Q. Liu d,
T. Lohse e, R. Mankel e, G. Medin e, E. Michel h, A. Moshkin g,
J. Ni d, S. Nowak n, M. Ouchrif a,m, C. Padilla h, R. Pernack ℓ,
A. Petrukhin h,j, D. Pose g,i, B. Schmidt h, A. Schreiner n,
H. Schr¨oder h,ℓ, U. Schwanke n, A.S. Schwarz h, I. Siccama h,
K. Smirnov n, S. Solunin g, S. Somov h, V. Souvorov n,
A. Spiridonov n,j, C. Stegmann n,e, O. Steinkamp a, N. Tesch h,
I. Tsakov h,2, U. Uwer e,i, S. Vassiliev g, D. Vishnevsky g,
I. Vukoti´c e, M. Walter n, J.J. Wang d, Y.M. Wang d, R. Wurth h,
J. Yang d, Z. Zheng c, Z. Zhu c, R. Zimmermann ℓ

aNIKHEF, 1009 DB Amsterdam, The Netherlands 4
bDepartment of Physics, University of Texas at Austin, RLM 5.208, Austin TX
78712-1081, USA 5
cInstitute for High Energy Physics, Beijing 100039, P.R. China
dInstitute of Engineering Physics, Tsinghua University, Beijing 100084 , P.R.
China
eInstitut f¨ur Physik, Humboldt-Universit¨at zu Berlin, D-12489 Berlin, Germany 6
f Institut f¨ur Physik, Universit¨at Dortmund, D-44221 Dortmund, Germany 6
gJoint Institute for Nuclear Research, 141980 Dubna, Russia
hDESY, D-22603 Hamburg, Germany
iPhysikalisches Institut, Universit¨at Heidelberg, D-69120 Heidelberg, Germany 6
jInstitute of Theoretical and Experimental Physics, 117259 Moscow, Russia

Preprint submitted to Elsevier

21 February 2014

kDept. of Physics, University of Oslo, N-0316 Oslo, Norway 7
ℓFachbereich Physik, Universit¨at Rostock, D-18051 Rostock, Germany 6
mUniversiteit Utrecht/NIKHEF, 3584 CB Utrecht, The Netherlands 4
nDESY, D-15738 Zeuthen, Germany

Abstract

In this paper we describe the operation and performance of the HERA-B Outer
Tracker, a 112 674 channel system of planar drift tube layers. The performance of
the HERA-B Outer Tracker system fullﬁlled all requirements for stable and eﬃ-
cient operation in a hadronic environment, thus conﬁrming the adequacy of the
honeycomb drift tube technology and of the front-end readout system. The detec-
tor was stably operated with a gas gain of 3 · 104 in an Ar/CF4/CO2 (65:35:5) gas
mixture, yielding a good eﬃciency for triggering and track reconstruction, larger
than 95 % for tracks with momenta above 5 GeV/c. The hit resolution of the drift
cells was 300 to 320 µm and the relative momentum resolution can be described as:
σ(p)/p(%) = (1.61± 0.02)+ (0.0051± 0.0006)·p. At the end of the HERA-B running
no aging eﬀects in the Outer Tracker cells were observed.

Key words: Drift chamber, gas gain, calibration, alignment, eﬃciency, resolution
PACS: 29.30Aj, 29.40Cs, 29.40.Gx

∗ Corresponding author. DESY, Notkestr. 85, D-22607 Hamburg, Germany. Tel.:
+49 8998 3972; fax: +49 8998 4018. E-mail address: herbert.kapitza@desy.de (H.
Kapitza).
1 Visitor from Moscow Physical Engineering Institute, 115409 Moscow, Russia.
2 Visitor from Institute for Nuclear Research, INRNE-BAS, Soﬁa, Bulgaria.
3 Visitor from Yerevan Physics Institute, Yerevan, Armenia.
4 Supported by the Foundation for Fundamental Research on Matter (FOM), 3502
GA Utrecht, The Netherlands.
5 Supported by the U.S. Department of Energy (DOE).
6 Supported by Bundesministerium f¨ur Bildung und Forschung, Germany, un-
der contract numbers 05-7BU35I, 05-7DO55P, 05-HB1KHA, 05-HB1HRA, 05-
HB9HRA, 05-7HD15I.
7 Supported by the Norwegian Research Council.

2

1 Introduction

HERA-B is a ﬁxed target experiment at the 920 GeV proton beam of the
HERA electron-proton collider [1,2]. Proton-nucleus interactions are produced
using an internal wire target in the halo of the proton beam. The experiment
was designed to study CP violation in B meson systems, requiring high inter-
action rates, good particle identiﬁcation, and eﬃcient triggering.

The main components of HERA-B are a silicon vertex detector (VDS), a dipole
magnet with a ﬁeld integral of 2.1 Tm, a tracking system consisting of an Inner
Tracker (ITR) using microstrip gas chambers and an Outer Tracker (OTR)
using drift tubes, and for particle identiﬁcation a ring imaging Cherenkov
counter (RICH), an electromagnetic calorimeter (ECAL), and a muon iden-
tiﬁcation system (MUON) made of absorbers and drift chambers. Figure 1
shows a schematic top view of the experiment together with the used coordi-
nate system.

     HERA - B                             Outer Tracker Chambers

  

   Magnet        Pattern                       Trigger          

Top View

x

y

z

Fig. 1. Schematic top view of the HERA-B experiment with the Outer Tracker cham-
bers indicated as black bars. The z-axis of the coordinate system coincides with the
proton beam axis.

The Outer Tracker of HERA-B serves charged particle detection from the outer
acceptance limit of the experiment, deﬁned by a 250 mrad opening angle in
the bending plane of the magnet, down to a distance of 20 cm from the HERA
proton beam. The OTR consists of 13 superlayers containing variable numbers
of planar honeycomb drift tube layers which provide three diﬀerent stereo
views (wires at 0 and ±80 mrad w.r.t. vertical). Seven superlayers are located
inside the magnet (labelled MC1–6,8), four between magnet and RICH (PC1–

3

4), and two between RICH and ECAL (TC1–2). Each superlayer consists of
two chambers which can be retracted from each other in x-direction. They
are distinguished by appending + or − to the superlayer label, depending
on which side of the proton beam tube the chamber is located. Around the
proton beam the drift cell diameter is 5 mm, and the outer detector parts are
equipped with 10 mm cells. In total 112 674 electronic channels provide drift
time information for tracking. The detector is operated with the fast counting
gas Ar/CF4/CO2 (65:30:5). The details of the detector and of the electronics
are described in the ﬁrst two papers of this series [3, 4]. Pattern recognition
and track ﬁt algorithms for the HERA-B tracking system are treated in [5].

This paper is organized as follows: The next section describes the operating
conditions of the Outer Tracker. The long-term stability of several detector
components, including some results on chamber aging are also presented. Its
calibration and alignment, as well as the achieved spatial resolution will be
discussed in Section 3. Section 4 summarizes the detector performance in terms
of hit and track eﬃciency and momentum resolution. Finally the paper is
summarized.

2 Detector Operation

2.1 Running Periods and Conditions

The Outer Tracker was routinely operated during two data taking periods of
HERA-B which were separated by a long shutdown for the luminosity upgrade
of HERA.

2.1.1 Run Period 2000 (July 1999 – August 2000)

This run period started with an only partially installed OTR. After completion
in January 2000, the up-time of the detector was 2200 h. The ﬁrst installed
chambers had been operated for an additional 1100 h.

By steering the movable wire target, the proton-target interaction rate was set
to values between 4 and 5 MHz most of the time, resulting in maximum channel
occupancies of about 2 %. For about 20 h data were also taken at high rates
of 30 and 40 MHz. Since the HERA bunch separation is only 96 ns, the high
rate data contain multiple interactions per event. In total the target produced
about 33000 MHz h corresponding to 1.2 · 1014 proton-nucleus interactions in
this run period.

4

Despite the stable performance of HERA and the good quality of the proton
beam, both resulting in very stable target rates, the OTR suﬀered from severe
HV stability problems during this run period (see Section 2.6.1). In order to
study these problems, the gas composition and the HV settings were varied.
As a result, not all data were taken with the OTR operating at its nominal
gas gain of 3 · 104.

2.1.2 Run Period 2002 (December 2001 – February 2003)

For this run period the HERA-B physics programme focused on charm physics
[6]. A re-optimization of the detector for the new physics goal led to the
removal of the OTR superlayers MC2–8, with the aim to minimize the material
in front of the ECAL.

Until the end of October 2002 priority was given to commissioning the up-
graded HERA accelerator and only 470 h of beam time could occasionally be
used by HERA-B. In the following more continuous run the OTR was operated
for another 760 h.

Except for short tests, the detector was not operated at target rates beyond
5 MHz during this run period. But instabilities of HERA operation, with spikes
of up to 2 GHz in the proton-target interaction rate and strong positron beam
background, caused large temporary charge depositions in the Outer Tracker
chambers. Occasionally currents of more than 50 times the nominal value were
observed in the most exposed sectors of the detector. Usually this triggered
an automatic HV switch-oﬀ procedure. Providing one chamber current as a
feedback signal for beam steering to the HERA control room strongly improved
the running conditions for the Outer Tracker.

Due to the improved HV stability the operational parameters of the OTR
could be kept stable during this run. However, during periods of high back-
grounds the detector performance suﬀered from distorted TDC spectra and
reduced hit eﬃciencies. Data from such periods were excluded from physics
analyses and performance studies. The useful data from this run period include
210·106 minimum bias and 148·106 lepton-triggered events. Most performance
results in this paper have been obtained from these datasets.

2.2 Slow Control System

During data taking most of the HERA-B hardware is monitored and controlled
by the Slow Control System [7]. From the Outer Tracker the ASD-8 ampliﬁer
boards, TDC crates, temperature sensors, the high voltage system, and the gas
gain control are included. The system allows to remotely read and set values

5

and to check the status of signals. The correctness of the controlled parameters
is monitored by the system. If a parameter value is outside a predeﬁned range,
an alarm message is generated. The high voltage control is described in [4],
the gas gain control is discussed in section 2.4. The OTR gas system [8] has its
own dedicated control hardware which is also connected to the detector safety
system. The system operates independently and only the gas parameters are
transmitted to the general HERA-B Slow Control system.

2.2.1 ASD-8 Board Control

Low voltage distribution boards are mounted on all superlayer frames. Each
board supplies up to 48 ASD-8 boards of similar sensitivity with power, thresh-
olds, and test pulses, and monitors voltages and currents. A CAN bus connects
the boards to the Slow Control System. More details can be found in [4].

Theshold, mV
Theshold, mV

Entries 
Entries 

 0
 0

Mean  
Mean  

  663.8
  663.8

RMS   
RMS   

  13.73
  13.73

Constant    4046
Constant    4046

Mean     
Mean     

 664.2
 664.2

Sigma    
Sigma    

 12.33
 12.33

5000

s
t
n
u
o
C

4000

3000

2000

1000

0

600

620

640

660

680

700

720
Threshold, mV

Fig. 2. Threshold voltage distribution for a group of ASD-8 boards for the whole run
period. A voltage of 660 mV corresponds to a charge of 2.6 fC.

Threshold stability is an important prerequisite for reliable OTR resolutions
and eﬃciencies. The eﬀective threshold voltage also depends on the ASD-8
supply voltages which are allowed to vary by about ±10 % (±300 mV) before
a warning is issued. Figure 2 shows the distribution of a particular thresh-
old voltage for the whole run period. The observed r.m.s. width of 14 mV
corresponds to a threshold charge uncertainty of about 0.1 fC.

2.2.2 TDC Crate Control

Each of the crates mounted on the OTR superlayer frames contains TDC
boards and a daughter board of the Fast Control System (FCS) [9, 10]. The

6

crate control monitors the voltage and temperature of the power supply and
the speed of the cooling fan. It also allows to reset values of timing delays and
to control the crate power.

2.3 Electronics Noise and Ampliﬁer Thresholds

The analysis of single channel TDC spectra is the key tool to monitor the
performance of every Outer Tracker channel. A normal spectrum is shown in
Fig. 3 (A), while the other plots show the spectra of three classes of mal-
functioning channels: Channels with asynchronous noise (B), channels with
bad connections or shorts to ground (C), and channels with oscillations (D).
For the data sample underlying the plots their fractions are 0.1 %, 1.8 %, and
8.8 %, respectively.

Fig. 3. Typical examples of TDC spectra. A time range of 256 TDC counts corre-
sponds to 100 ns.

The asynchronous noise of type (B) is generated by other electrical devices
operating in the neighbourhood of the corresponding ampliﬁer board. Because
of diﬀerent ground connections certain ASD-8 boards and channels are more
aﬀected than others. Since the timing of the electromagnetic noise is not cor-
related with the TDC clock, the time distribution of the noise hits is ﬂat.
Improved ground connections between the gas boxes and their ASD-8 boards
almost completely eliminated this problem.

7

Most of the type (C) channels belonged to badly plugged ASD-8 boards. Such
faulty connections were regularly ﬁxed during access days. Just a few of them
(0.014 %) were permanent due to a short to ground inside the gas box or on
the feedthrough board.

Bad ground connections of ASD-8 boards to the gas box and badly shielded
signal cables lead to oscillations of the ampliﬁers with a characteristic fre-
quency of about 50 MHz which clearly shows up in Fig. 3 (D). This type of
noise can only be suppressed by increasing the thresholds of the corresponding
ASD-8 boards.

For threshold speciﬁcation in the experiment a parameter ∆Uthr is used. It is
added to the Unoise value of each ASD-8 board. 8 Using this parametrization
one can use a common threshold parameter for all boards of one chamber
which usually come from several quality classes. This makes it easy to react to
changing noise conditions in the experiment. The conversion factor between
threshold voltages and charges is 250 mV/fC.

In order to keep the thresholds ∆Uthr low and the loss of resolution and hit
eﬃciency as small as possible, the following measures were taken: A direct
connection of the analog ground of an ASD-8 board to the shielding of its
output cable, a shielding of the ASD-8 board input connector to reduce the
capacitive feedback from the digital output, a direct connection of the digital
and analog grounds right on the ASD-8 board, and modiﬁcations of the TDC
boards which reduced the feedback from their hit outputs. All these measures
reduced the number of noisy channels and allowed to set lower thresholds on
all chambers (see Table 1).

2.4 Gas Gain Control

Tests had shown that with the achievable thresholds for the frontend electron-
ics a gas gain of about 3 · 104 represents an optimum in terms of eﬃciency,
resolution, and operational safety of the Outer Tracker chambers. Some eﬀorts
have been taken to monitor and to control this important parameter.

2.4.1 Direct Gain Measurement

A direct measurement of the gas gain has been performed at the beginning of
the 2002 run period. To determine the gas gain, the current in the OTR was

8 The ASD-8 boards for the Outer Tracker are sorted into 12 quality classes, using
two characteristic threshold voltages: Uref which describes the response to a 4 fC
test pulse, and Unoise which describes the noise susceptibility (see [4] for the details).

8

Table 1
Thresholds ∆Uthr of all OTR chambers after modiﬁcation of the TDC boards. The
old values are given in parentheses.

Chamber ∆Uthr [mV] Chamber ∆Uthr [mV]

MC1–

100 (200)

MC1+

100 (200)

PC1–

PC2–

PC3–

PC4–

TC1–

TC2–

400 (600)

PC1+

400 (600)

500 (500)

PC2+

400 (500)

400 (500)

PC3+

400 (500)

400 (700)

PC4+

400 (600)

300 (600)

TC1+

300 (500)

300 (600)

TC2+

300 (500)

measured as a function of the voltage applied to the chambers. In order to
reduce the uncertainty of the measurement at low voltages, where the current
approaches the ionization value, the total current from about 10000 drift cells
(5 mm) was measured. During the HV scan the interaction rate was kept as
stable as possible.

The result is shown in Fig. 4. The gas gain G, deﬁned as the ratio of the
current determined at the working point and the ionization current, is found
to be

G =

I(1950 V)
I(150 V)

= (3.3 ± 1.0) · 104

This value agrees well with the results of previous gain measurements using
radioactive 55Fe sources. The large error arises from uncontrollable ﬂuctuations
of the running conditions among the points in Fig. 4 which were measured over
a period of several hours.

2.4.2 Gas Gain Monitoring

The ampliﬁcation in the gas mixture strongly depends on ambient conditions
like atmospheric pressure and temperature, as well as on the exact composition
of the counting gas. In particular the presence of oxygen has a large inﬂuence
on the gas gain. For the Outer Tracker gas mixture Ar : CF4 : CO2 the allowed
limits for variation of the fractions are (65 ± 1 : 30 ± 1 : 5 ± 0.2) %, which
correspond to gain variations of about 15 %. An Outer Tracker gas monitoring
system was installed to control these parameters and to act as an additional
interlock if they exceed the limits [3, 8].

9

Fig. 4. Sum current of ≈ 104 drift cells (5 mm) as a function of the voltage applied
to the chambers.

For gain monitoring a small chamber with 5 and 10 mm honeycomb drift cells
of the OTR type is installed in parallel to the main gas input. The overlap
region of both cell types is irradiated by an 55Fe source. From the measured
pulse height spectrum the positions of the pedestal (Aped) and of the 5.9 keV
gamma line (Apeak) are determined. The gain value is given in % with respect
to a nominal one

G =

Apeak − Aped
Anom

· 100 %.

Anom is the spectral position of the nominal gain. The used technique allows
to measure gains in the range (40–150) % with an accuracy of 3 %. The mea-
surement takes up to 15 minutes.

In order to eliminate the large but trivial inﬂuence of the atmospheric pressure
on the gas gain, thus making smaller eﬀects visible, a pressure correction is
introduced. For small pressure variations this correction can be approximated
by

∆G
G

= −K

∆p
p

.

10

The corrected gain is obtained as

Gcorr = G[1 + αp(p − pnom)],

where G and p are the measured gain and pressure values, αp = K/pnom =
0.6 % per mbar is a pressure correction factor, and pnom = 1008 mbar is the
nominal atmospheric pressure in Hamburg, averaged over a year.

The gas gain monitoring system is fully integrated in the HERA-B Slow Con-
trol environment. Parameters like the atmospheric pressure, the high voltage
settings, the measured and the pressure corrected gains are stored in a data
base with a corresponding time stamp. The desired voltages for the two Outer
Tracker cell types, which follow from the high voltage dependence of the gain,
are also recorded. Figure 5 illustrates the performance of the system and shows
that the largest gain variations are caused by the varying atmospheric pres-
sure. It also shows the stability of the mixing ratio and the levels of O2 and
N2 contamination.

2.4.3 Online High Voltage Steering

In order to operate the detector at an approximately constant gas gain, an
automatic adjustment of the high voltage is implemented in the OTR Slow
Control. The modiﬁed high voltage server retrieves the desired voltages from
the data base. A modiﬁcation of the high voltage is considered to be necessary
if the currently applied voltages diﬀer from the desired ones by at least 5 or
6 V for the 5 or 10 mm drift cells, respectively. Smaller diﬀerences are not
signiﬁcant with the given gain measurement errors. The new high voltage
settings are not applied immediately but only when the Outer Tracker HV is
turned on next time.

For safety reasons the steering procedure is only used to balance gains in the
range (70 . . . 140) %, corresponding to required voltage variations of (+1.4 . . .−
2.7) %. In addition, the desired voltage records from the data base must not
be older than one hour.

2.5 Aging Investigations

Aging of the Outer Tracker drift chambers was an extensively studied R & D
subject [11, 12] because of the high radiation load near the beam pipes and
since there was only little experience with the fast but aggressive CF4 gas
component.

11

%

r
a
b
m

%

m
p
p

Gas Gain

measured

✁
✁

✁✁☛

pressure corrected −20 %

❏

❏

❏

❏❏❫

Atmospheric Pressure

Argon Content

❏❏❪

Gas leak

❏

Nitrogen and Oxygen Content

❏❏❪

Gas leak

❏

✁✁✕
Nitrogen✁

Oxygen

✡

✡✢

Days

Days

Days

Days

Fig. 5. Monitoring important gas system parameters. For clarity the pressure cor-
rected gas gain curves for the 5 and 10 mm cells are drawn with an oﬀset of –20 %.
Day 0 corresponds to August 20, 2002.

After exposure to a large radiation dose a wire chamber may exhibit an irre-
versible gas gain reduction. Since the chamber current at a given particle rate
is proportional to the gas gain, the measured current can be used to monitor
the gas gain.

The current density (current per cm of wire normalized to a target rate of
1 MHz) as a function of the accumulated charge density is shown in Fig. 6. This
dependence was measured in sector 4 of superlayer PC1 which is situated close
to the proton and electron beam pipes where the density of the accumulated
charge is maximal (see [3] for sector deﬁnitions). As follows from Fig. 6, there
is no visible decrease of the current (and therefore of the gas gain) within an
accuracy of 5 % for an accumulated charge density up to about 7 mC/cm. This

12

)
z
H
M
m
c
(
/

 

A
n

 
 
 
 
 
y
t
i
s
n
e
d
 
t
n
e
r
r
u
c

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

0

1

2

3

4

5

6

7

8

Accumulated charge density      mC/cm

Fig. 6. Current density as a function of accumulated charge. 7 mC/cm corresponds
to 1000 hours of operation of HERA-B.

charge density corresponds to the operation of the HERA-B detector for more
than 1000 hours during the 2002 run period. During its entire operation time
the Outer Tracker accumulated an average charge density of 24 mC/cm on the
anode wires in the hottest regions.

Due to the much shorter than scheduled run of HERA-B and to mostly running
at target rates of 5 MHz or even less, the accumulated charge density does
not seriously probe the OTR design criterion of being able to collect up to
1.5 C/cm during ﬁve years of running at 40 MHz.

After the run end an anode wire which was located near the proton beam
pipe was taken out of the MC8 chamber and investigated using an electron
microscope. The wire surface is mostly clean, some very isolated depositions
contain oxygen, silicon, chlorine, potassium, and sodium. There is no hint for
wire etching which had been observed as a function of gas humidity in earlier
studies [12].

2.6 Detector Stability

2.6.1 High Voltage Stability

The most disturbing OTR problem during the 2000 run was the continued
loss of high voltage groups. From the very beginning of OTR operation in

13

July 1999 it was observed that HV groups occasionally failed. The average
long term rate of these failures was one HV group per 5 hours up-time of the
Outer Tracker, but there were strong ﬂuctuations. Since a HV group supplies
16 wires, the failure of a single wire causes a channel loss which is a factor 16
higher.

2.6.1.1 Mechanical Instabilities: The failure rate was especially high
in TC2–, the ﬁrst assembled and installed large chamber. Here it was sus-
pected that this was caused by mechanical instabilities of the modules, none
of which was reinforced yet with carbon ﬁbre rods. Most modules in all later
installed chambers had this reinforcement [3]. In a complete overhaul of TC2–
in December 1999 the chamber was disassembled, all modules were reinforced
and subjected to a more rigorous HV test than before. With reference to a ﬂat
table, the module was bent with a sagitta of 8 mm, a condition similar to what
was observed on modules installed in TC2– during the ﬁrst assembly. All wires
which then showed shorts or excessive dark currents were disabled. Compared
to the original test procedure which only checked perfectly ﬂat modules, the
number of eliminated wires roughly doubled, raising the fraction from 0.6 to
1.1 %. During the 8 months of running time after this repair only 16 of 606
HV groups in TC2– showed problems, compared to 115 groups during the 5
months before the repair.

2.6.1.2 Shorts on HV Boards: By the end of the 2000 run there were
499 defect HV groups (out of 7219 in total) in the whole Outer Tracker, not
counting the TC2– problems in 1999. The inspection of damaged modules re-
vealed a somewhat unexpected major source of the problems: In more than
90 % of the cases the “short” was caused by a burnt-in carbon trace of varying
resistance across either of two capacitors on the bottom side of the HV distri-
bution board. In no case any of the 15 top side capacitors caused the problem.
This systematic diﬀerence had to do with the diﬀering mounting techniques
used for top and bottom side components in the SMD soldering process [4].
Less than 10 % of the faulty HV groups had genuine drift cell shorts which
were caused by mechanical module damage during installation, wire instabili-
ties in modules without reinforcement, and instantaneous wire breaking under
extremely high radiation load (rate spikes related to beam loss).

During the 10 months of the shutdown all chambers were disassembled and the
modules were subjected to the same repair steps as described above for TC2–.
The most time-consuming step in this procedure was the manual exchange of
12 000 SMD ﬁlter capacitors on the HV distribution boards.

14

2.6.1.3 Other losses of HV groups: Repaired and reinstalled chambers
were kept at nominal high voltage for at least three days, but the ﬁrst repaired
chambers were trained for as long as 82 days. During this phase 55 HV groups
were lost, mostly due to installation damage. During the ﬁrst phases of the
2002 run, when the OTR was only occasionally operated, 33 HV groups were
damaged. This was mostly related to special events like a HV scan up to
twice the nominal gas gain, or frequent chamber movement for maintenance.
For certain types of modules the internal stability was not good enough to
withstand the vibrations during chamber handling. During the ﬁnal 760 h of
regular OTR operation in 2002/2003 only 10 HV groups developed shorts,
and more than half of these occurred during extreme background conditions
at the accelerator.

2.6.2 Component Stability

From 1999 to 2003 the complete OTR was operated for more than 3400 h,
some chambers saw up to 1100 h additional beam time (see Sec. 2.1). This
makes quantitative statements about the long term stability of various system
components possible.

2.6.2.1 Detector Modules: The OTR was assembled from about 150
diﬀerent types of detector modules [3]. After reinforcement with carbon ﬁbre
rods the vast majority of these showed suﬃcient mechanical rigidity, resulting
in good electrostatical stability during operation. In retrospect it must be
said, however, that the modules with 5 mm cells were designed too close to
the stability limit, with free wire lengths of 59 and 68 cm between support
strips [3] in the PC and TC chambers, respectively. Most HV instabilities were
observed in this region of the detector and 80 of 978 modules were rebuilt when
repairing the detector during the HERA shutdown.

2.6.2.2 Gas System: The most problematic components of the gas sys-
tem were the metal bellow circulation pumps [8]. At times 5 of the 15 pumps
were out of order thus reducing the gas ﬂow rate to only 70 % of the nominal
value. In all cases the problems were caused by leaking bellows. These leaks
were most probably induced by solid contaminants inside the closed gas loop.
Occasional problems in the gas mixing system and in the pressure regulation
loops were mostly solved by recalibrating the mass ﬂow controllers. Only once
such a problem was caused by the complete breakdown of the steering unit.

15

3 Detector Calibration

In order to obtain the spatial coordinates of the track hits from the measured
TDC values, several sets of calibration and alignment constants are necessary:

(1) Bad channels are identiﬁed and excluded from being used by means of

channel masks.

(2) The TDC spectra from all detector channels are corrected for individual
time shifts t0. These constants are generated by the t0-calibration.
(3) The translation of TDC counts to drift distances is done by means of a
drift time to distance relation r(t). The resolution function σ(t) provides
the errors of the measured distances. For each cell type both functions
are generated by the rt-calibration.

(4) Finally, the measured coordinates must be corrected by alignment con-
stants which account for deviations of detector elements from their nom-
inal geometry. The internal alignment determines Outer Tracker distor-
tions, the global alignment the OTR displacement in HERA-B.

A set of calibration constants remains valid as long as the corresponding de-
tector properties do not change. Failing hardware, threshold manipulation,
and chamber movements during the run periods call for several instances of
all sets. They are all stored in the HERA-B Calibration-and-Alignment (CnA)
Database [13].

3.1 Masking of Bad Channels

Bad Outer Tracker channels must be excluded from being used in pattern
recognition and track ﬁt because they can disturb the procedures. They are
best identiﬁed in occupancy maps of the OTR chambers. An occupancy map
is a normalized hit map. For each wire it gives the number of recorded hits
divided by the number of analyzed events (channel occupancy). Bad channels
are found by comparing for every wire the measured channel occupancy with
the occupancy predicted by a Monte Carlo (MC) simulation. Depending on
whether their occupancies are much higher or much lower than expected, bad
channels are called either noisy or dead.

Measured occupancies strongly depend on the interaction rate and on the
trigger conﬁguration. In order to compare arbitrary experimental data with a
standard MC sample, measured channel occupancies are scaled by the ratio
of the total numbers of hits in simulation and data. When this scaling is
applied, there remains only a small inﬂuence of the trigger conﬁguration, as
was assessed by analyzing runs using diﬀerent triggers. The inﬂuence of the
material and the position of the target is also small.

16

In the MC simulation 300 000 minimum bias events were generated and pro-
cessed through a detailed GEANT detector simulation [14]. This is done only
once per run period, assuming a stable geometry of HERA-B. The calculated
wire occupancies, the number of events, and the total number of hits are
stored.

For each set of experimental data 50 000 events are analyzed. The measured
occupancies are properly scaled and compared to the MC reference. Noisy
and dead wires are identiﬁed using the cuts described below. The generated
channel mask is stored in the calibration database.

An example for the distribution of measured versus MC predicted occupancies
for each wire is shown in Fig. 7. Wires with measured occupancies Ωmeas

5mm cells occupancies

10

noisy

]

%

[
 
a
t
a
d
 
l
a
e
r

]

%

[
 
a
t
a
d
 
l
a
e
r

8

6

4

2

0

8

6

4

2

0

good

dead

8

10

MC [%]

0

2

4

6

10 mm cells occupancies

10

noisy

0

2

4

6

good

dead

8

10

MC [%]

Fig. 7. Distributions of measured vs. MC predicted occupancies for 5 and 10 mm
cells. Most noisy wires have occupancies close to 100 % and are out of range in this
plot.

smaller than 10 % of the MC predicted value ΩM C are marked as dead. This
cut is indicated by the lower lines in Fig. 7. The optimal cuts to deﬁne noisy
wires are

17

Ωcut = ΩM C + hΩmeasi · 1.5 for 5 mm cells,
Ωcut = ΩM C + hΩmeasi · 0.8 for 10 mm cells.

They are indicated by the upper lines in Fig. 7. These deﬁnitions accept a
relatively large fraction of noise hits on wires for which the simulation predicts
small occupancies. This helps to maximize the number of usable channels and
is tolerated by the track reconstruction algorithms as long as the absolute
number of hits remains low. More details and comparisons with other masking
methods can be found in [15].

Table 2 shows for a typical run the fractions of good, noisy, and dead wires in
all chambers of the Outer Tracker.

Table 2
Fractions of good, noisy, and dead wires in all chambers of the Outer Tracker for a
typical run.

Superlayer

good [%]

noisy [%]

dead [%]

side

+x −x +x −x +x −x

MC1

93.1

94.5

93.1

94.7

94.2

94.1

94.1

94.8

91.7

95.9

90.4

93.2

91.2

90.8

0.1

0.4

1.2

3.0

0.8

0.5

0.7

0.1

0.5

0.6

1.1

0.3

0.3

3.0

6.8

6.5

4.6

3.0

7.5

9.2

8.1

5.4

4.8

5.2

4.2

3.8

6.5

6.2

PC1

PC2

PC3

PC4

TC1

TC2

It should be noted that masked cells are treated diﬀerently in the diﬀerent
parts of the trigger chain and in the track reconstruction. In order to prevent
an unacceptable loss of trigger eﬃciency, the First Level Trigger considers
noisy wires as good and dead cells as always having a hit, even though this
leads to an increased number of trigger messages. Contrary to this, masked
cells are excluded from the Second Level Trigger and from the online and
oﬄine track reconstruction.

3.2 TDC Spectrum Shifts

The hardware calibration of the TDCs maps a time interval of 100 ns linearly
to 256 TDC counts [4]. Linearity and stability of the conversion factor are so
good that it adds negligibly to the ﬁnal uncertainty of the time measurement.

18

The origin of the time scale is not so well deﬁned, the absolute timing depends
on the channel. In order to be able to use a common drift time scale throughout
the Outer Tracker, the TDC spectra of all detector channels are time aligned
using individual time shifts t0. These calibration constants absorb systematic
eﬀects arising e.g. from diﬀerences in cell position or signal propagation time.

The t0 calibration procedure evaluates the truncated means of the TDC spec-
tra [16]. The truncation limits tmin and tmax, given in Table 3, are chosen to
accept 95 % of all hits. The diﬀerence of the truncated mean and the reference
value tref yields the time oﬀset t0 for each channel. The tref values shown in
Table 3 were chosen at the beginning of the run to minimize the average t0.
Due to the truncation this extremely simple procedure must be iterated, but

Table 3
Limits for the truncation of the TDC spectra and reference values for the t0 calcu-
lation (all in TDC counts).

Cell Size

tmin

tmax

tref

5 mm

10 mm

130

50

230

250

180

150

already after the third iteration the t0 values are stable within 0.5 ns, the time
measurement bin of the TDC.

The quality of this t0 calibration procedure can be assessed by comparing
summed TDC spectra before and after application of the t0 corrections. As
is shown in Fig. 8 for both types of drift cells, the corrected spectra have a
higher peak and a steeper rising edge than the uncorrected ones, just as one
would expect from improving the overlap of the single wire spectra. On the
other hand, the eﬀect is small which shows that the rough t0 calibration done
by setting delays on the Fast Control System (FCS) daughter boards in the
TDC crates is already quite good (see section 2.2.2).

The t0 constants were determined for each run with more than 300 000 events.
As an illustration of the long term stability of the t0 calibration, the diﬀerences
of the values obtained for three runs in a period of six weeks are shown in
Fig. 9. The shift of the left spectrum by −2.25 TDC counts is a consequence
of changed operational parameters. The small structures at +10 and −20 TDC
counts are attributed to instabilities of the FCS delays for single crates. These
were cured by resetting the aﬀected TDC crates.

19

Fig. 8. Summed TDC spectra of all cells (dotted line without, solid line with t0
correction). Since the TDCs operate in “Common Stop” mode, the time scale is
inverted, i.e. large TDC counts correspond to short drift times and vice versa.

m = -2.25
s

= 2.28

0.02±

0.02±

m = 0.016
s

= 1.94

0.01±

0.01±

3000

2000

1000

3000

2000

1000

0

-20

0
(20340)-t

20
(20653) [TDC counts]

0

0t

0

-20

0
(20653)-t

20
(20746) [TDC counts]

0

0t

Fig. 9. Long term stability of the t0 calibration: Diﬀerences of t0 values determined
for the runs 20340, 20653, and 20746, taken during a time period of six weeks.

3.3 Drift Time to Distance Calibration

The drift time to distance relation r(t), or rt-relation for short, transforms
a measured drift time t into a distance r from the hit wire. The resolution
function σ(t) provides the errors of the measured distances r(t). Both functions
are needed when preparing hits for pattern recognition and track ﬁt. They are
determined in a common rt-calibration procedure. A detailed description of
the HERA-B Outer Tracker rt-calibration is given in [16]. Here only the main
features of the procedure are summarized and some results on the average hit
resolution are presented.

3.3.1 Calibration Procedure

Using the drift distances r(ti) of all hits i found by the pattern recognition
for a certain track, the track ﬁt yields ﬁve parameters which fully describe

20

the track [5]. Using these parameters, one can calculate distances of closest
approach di of the track to the anode wires of all used drift cells. While r(ti) is
an unsigned quantity, namely the radius of a cylinder around the wire which
the particle track must be tangent to, the calculated distance di has a sign
that tells on which side the track has passed the wire. For a quantitative
comparison of measured and predicted distances the left-right ambiguity of
r(ti) is solved in the track ﬁt by applying a sign parameter ǫi such that the
square of the residual

∆i = ǫi r(ti) − di

(1)

becomes minimal. After convergence of the track ﬁt one has ǫi = sign(di) for
every hit.

The predicted distance di depends on all hits participating in the track ﬁt and
therefore is a good estimator for the “true” distance of the track from the wire.
Hence, if only an approximate r(t) is used for the hit preparation, an improved
rt-relation can be obtained from the correlation of predicted distances d and
measured drift times t. Figure 10 shows examples of this two-dimensional
distribution for 5 and 10 mm drift cells in the PC superlayers.

 
5 mm cells

 
10 mm cells

]

m
c
[
 
e
c
n
a
t
s
i
d

0.4

0.3

0.2

0.1

-0

-0.1

-0.2

-0.3

-0.4

100

120

140

160

180

200

220
drift time [counts]

240

40 60 80 100 120 140 160 180 200 220

drift time [counts]

Fig. 10. Signed reconstructed distance versus measured drift time for 5 and 10 mm
cells in the PC chambers. One TDC count is 100/256 ns. Because of operation in
“Common Stop” mode high TDC counts correspond to short drift distances.

In each drift time bin the average value h|d|i of the unsigned predicted dis-
tances is calculated. The resulting data points are smoothed in a least squares
ﬁt using third order B-spline polynomials. These eventually yield the values of
the new rt-relation. Figure 11 illustrates such an rt-calibration step. From the
plots one can also deduce quite high drift velocities of about 115 and 90 µm/ns
in the centers of the 5 and 10 mm drift cells, respectively.

]

m
c
[
 
e
c
n
a
t
s
i
d

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

21

 
5 mm cells

0
140 150 160 170 180 190 200 210 220

drift time [counts]

 
10 mm cells

]

m
c
[
 
e
c
n
a
t
s
i
d

0.3

0.25

0.2

0.15

0.1

0.05

]

m
c
[
 

e
c
n
a
t
s
d

i

0.5

0.4

0.3

0.2

0.1

0

60

80 100 120 140 160 180 200 220

drift time [counts]

Fig. 11. Interpolated points of the r(t) functions for 5 and 10 mm cells. The input
distributions |d|(t) are shown as well.

The value of the resolution function σ(t) in a given drift time bin follows from
the RMS width of the distribution of residuals (1) in that time bin. Also here
the measured points are smoothed using a B-spline ﬁt. Since all hits which
populate the residual distributions are also used in the track ﬁt, an individual
scaling factor must be applied to each residual, in order to compensate for
the introduced bias [16]. Figure 12 shows distributions of scaled residuals as
a function of the measured drift times for both types of drift cells. For each
time bin the RMS width of the residual distribution, i.e. the value of the new
resolution function is shown as a point.

The described steps of obtaining new functions r(t) and σ(t) deﬁne an iterative
procedure. Typically ﬁve iterations are suﬃcient to converge to the required

22

5 mm cells

10 mm cells

]

l

m
c
[
 
n
o
i
t
u
o
s
e
r
/
l
a
u
d
i
s
e
r

0.15

0.1

0.05

0

-0.05

-0.1

-0.15

]

m
c
[
 
n
o
i
t
u
o
s
e
r
/
l

l

a
u
d
s
e
r

i

0.15

0.1

0.05

0

-0.05

-0.1

-0.15

-0.2

-0.25

140 150 160 170 180 190 200 210 220

60 80 100 120 140 160 180 200 220

drift time [counts]

drift time [counts]

Fig. 12. Resolution functions σ(t) for 5 and 10 mm drift cells (dotted lines). The
input distributions ∆(t) are shown as well.

precision. For track reconstruction in the ﬁrst iteration r(t) is obtained by in-
tegrating the drift time spectrum and the resolution is assumed to be constant
at 1 mm.

The rt-relation discussed here is a tabulated function which is used for the
transformation of TDC counts to distances. It is determined using tracks going
through the whole detector and thus is inﬂuenced by global eﬀects like vari-
ations between drift cells, misalignment, variations in interaction time, and
by properties of the track reconstruction procedure itself. In certain details
this phenomenological function may be quite diﬀerent from the physical rt-
relation of a drift cell which is deﬁned by the operating parameters of the cell
(e.g. electric and magnetic ﬁeld, drift gas mixture, pressure, temperature) and
modiﬁed by properties of the attached readout electronics (e.g. impedance,
threshold, pulse shaping).

The same arguments apply for the resolution function. The improvement of
σ(t) towards the sense wire (large TDC counts in Fig. 12) which contradicts the
expectation from drift chamber physics, results from the described method of
resolving the left-right ambiguity. This method suppresses negative residuals
∆(t) < −r(t) and leads to asymmetric and artiﬁcially narrow distributions
close to the wire. Here σ(t) still yields the correct hit weight for the track ﬁt,
but it is no longer identical to the physical drift chamber resolution.

The technical nature of both functions is emphasized by using a hardware
deﬁned time scale of TDC counts instead of proper drift times in nanoseconds.

23

3.3.2 Performance on Data

Figure 13 shows the distributions of scaled residuals for 5 and 10 mm cells
in the PC chambers of the Outer Tracker. In both types of cells an average
resolution of about 370 µm is obtained. This includes a substantial contribu-
tion from multiple scattering because the chambers in the PC region represent
an average thickness of 0.15 radiation lengths while for statistics reasons the
calibration procedure uses a track momentum cut of only 5 GeV/c.

5 mm cells

10 mm cells

1200

1000

800

600

400

200

0

-0.2 -0.15 -0.1 -0.05 -0 0.05 0.1 0.15 0.2

residual [cm]

-0.4 -0.3 -0.2 -0.1

-0

0.1

0.2

0.3
0.4
residual [cm]

Fig. 13. Distributions of scaled residuals for 5 and 10 mm cells in the PC chambers of
the Outer Tracker. The dashed lines represent Gaussian ﬁts. The average resolution
is about 370 µm in both cell types.

In order to investigate this further, the average resolution of the 5 mm cells is
determined as a function of track momentum. For this purpose high quality
tracks are selected which have at least 20 hits in the PC chambers and which
are also observed in the silicon vertex detector and in the TC chambers. In each
of the chambers PC2 and PC3 one layer is excluded from pattern recognition
and track ﬁt. In these layers distributions of unbiased residuals are accumu-
lated in bins of track momentum. The result is shown in Fig. 14. The measured
data are compatible with a chamber resolution of 300 µm and multiple scat-
tering contributions of 80 and 310 µm at p = 20 and 5 GeV/c, respectively.

A chamber resolution of 300 µm falls outside the range 150–250 µm, the design
target in the proposal [1], which was veriﬁed in several series of test measure-
ments [17]. This is mostly due to the elevated noise level in the full detector
compared to limited test setups (see Sec. 2.3). The required higher settings for
the discriminator thresholds worsen the resolution. For a large system with
more than 100 000 channels also the threshold granularity becomes impor-
tant [4] because it deﬁnes how closely the detector can be adapted to spatially
varying noise conditions. Finally, a full tracking system of independent cham-
bers also suﬀers more from alignment and calibration uncertainties both of
which adversely aﬀect the spatial resolution.

2500

2000

1500

1000

500

0

24

]

m
c
[
 
a
m
g
i
s

0.06

0.05

0.04

0.03

0.02

0.01

0
0

2

4

6

8

10

12

14

16

18

20
p [GeV]

Fig. 14. R.m.s. width of the residual distribution for 5 mm drift cells as a function
of track momentum.

3.4 Alignment

There are two independent alignment tasks: The internal alignment deals with
the relative positions of the individual OTR modules, while the global align-
ment determines the spatial position of the OTR with respect to the other
components of HERA-B.

3.4.1 Internal Alignment Considerations

An internal alignment procedure for the HERA-B Outer Tracker must meet
certain demands:

• It must use tracks reconstructed in the OTR itself because there are no

external tracks of suﬃcient precision available.

• It must be able to work with hadronic tracks that are found in typical
HERA-B events with only a moderate momentum cut being applied (typi-
cally 5 GeV/c). Such a track sample can be collected within a few hours and
covers the full acceptance of the detector. This is adequate for the sometimes
quite short intervals of stable detector geometry.

• It must be robust against a possible bias introduced by the track recon-
struction procedure. The problem with the above track sample is the large
spatial track density per event and hence the proper assignment of hits to
tracks. If no measures are taken any track reconstruction algorithm will pick

25

up the nearest hits and will prefer left-right signs for the drift distances that
minimize the residual squares, thus creating a background in the residual
distribution that peaks at zero.

In the following section an iterative algorithm is described which meets the
above demands. Possible improvements by other algorithms have been inves-
tigated [18] but have not become relevant for the HERA-B data analysis.

3.4.2 Iterative Method of Internal Alignment

The HERA-B geometry is described by a data structure called GEDE (GE-
ometry of DEtector). In the following this name will be used to denote the
smallest OTR units to be aligned, the sensitive sectors of OTR modules [3].
There are in total 1380 GEDE units within the PC/TC area. GEDE units be-
longing to the same module are mechanically coupled but for simplicity such
constraints are neglected. Each GEDE unit k is treated as a rigid body and
two alignment constants are considered: au
k, where u means the direction
orthogonal to the wire, z is the direction along the beam. The stereo angle α
is treated as a constant.

k, az

If the alignment is based on internal tracks, all GEDE parameters become
correlated. Instead of a proper treatment of the large correlated system we
simplify the problem and consider each GEDE as an independent unit. The
algorithm is then based on the residual distributions for each individual GEDE
plane. To avoid the above mentioned uncertainties of the track-to-hits associ-
ation, for each track the residuals are calculated for all hits in the traversed
GEDE. Also for the left-right ambiguity of the drift distance measurement
no decision is made at this point, but both signs are accepted. This is done
by creating two residual histograms h+ and h− per GEDE plane, which are
ﬁlled using always the positively or negatively signed drift distance, respec-
tively. The left hand plots in Fig. 15 show the characteristic shapes of these
histograms: There is a ﬂat background from calculating residuals using hits in
wrong cells, a shoulder from calculating residuals using hits from the right cell
but with wrongly signed drift distances, and a peak resulting from properly
calculated residuals. The peak occurs at the same position in both histograms.

+, hi

In order to improve the computational robustness of automatic peak ﬁtting,
after processing all events the histograms are combined binwise: For each bin i
we set hi = min(hi
−). This symmetric histogram (see Fig. 15) does neither
depend on the hit-to-track association nor on the left-right ambiguity resolu-
tion, and even for large oﬀsets a clear peak can be observed. The ﬁtted peak
position is used as an alignment correction au
k and the track reconstruction
is repeated iteratively as long as there is an improvement. Beyond a certain
alignment accuracy the residual width is dominated by multiple scattering.

26

s
e
i
r
t
n
E

s
e
i
r
t
n
E

-h

+h

-1

-0.8

-0.6

-0.4

-0.2

-0

0.2

0.4

0.6

0.8

1
r/cm

s
e
i
r
t
n
E

min(h

)+,h-

-1

-0.8 -0.6 -0.4 -0.2

-0

0.2

0.4

0.6

0.8

1
r/cm

-1

-0.8

-0.6

-0.4

-0.2

-0

0.2

0.4

0.6

0.8

1
r/cm

Fig. 15. Combining two residual histograms using always positive or negative drift
distance signs.

Therefore the standard deviation of the residual mean distribution is used as
a control parameter. Typically after 20 iterations this quantity is less than
50 µm and does not improve any further.

3.4.3 External Degrees of Freedom and Layer z Corrections

The described algorithm does not ﬁx the alignment constants uniquely. In gen-
eral any global transformation that maps straight tracks into straight tracks
will give a valid set of alignment constants:

k = au
˜au

k + [T x + Sxzzk] cos αk − [T y + Syzzk] sin αk

Here T x and T y are global oﬀsets in x and y, Sxz and Syz are shearings, i.e.
oﬀsets that depend linearly on z. The stereo angle for a given GEDE is denoted
by αk. For each iterative step we choose the global oﬀsets and shearings such
k)2.
that they minimize the summed squares of the alignment constants

k(˜au

Finally from the alignment constants ˜au
shift az
for this layer can be estimated by minimizing
l
Here htan θkli is the average track slope for the GEDE plane kl.

kl belonging to layer l the average z
l + ˜au
kl.

klhtan θkliaz

P

P

27

3.4.4 Global Alignment

The above procedure does not deﬁne the position of the OTR within the
HERA-B coordinate system. To deﬁne this global alignment, external tracks
are necessary. Here the problem appears that the tracking through the HERA-
B magnetic ﬁeld depends on the track momentum and the measurement of
the track momentum depends on the global alignment. To avoid this circular
argument, special sets of alignment data have been taken with the magnet
switched oﬀ. This allows for a straightforward determination of the relative
position of the OTR.

4 Detector Performance

4.1 Cell Hit Eﬃciency

The cell hit eﬃciency is the probability to register a signal in an Outer Tracker
drift cell after the passage of a charged particle. This is one of the essen-
tial quantities which characterises the detector performance and which has a
strong impact on the track and trigger eﬃciencies. A charged particle passing
a stereo layer should hit at least one cell in each single layer and two cells
in each double layer. Counting the layers, the expected number of hits would
be 30 in the PC and 12 in the TC chambers. Due to the overlap of cells and
modules, the real number of hits can be larger.

In order to study the cell hit eﬃciency, high statistics track samples have been
selected using the following requirements:

• Events must be reasonably populated, with a total number of hits 900 <

Nhits < 8000 in the OTR chambers.

• Tracks must traverse the whole detector, with segments in the Vertex De-

tector (VDS) and in the PC and TC Outer Tracker superlayers.

• Tracks must have enough hits per segment, with N V DS > 6, N T C + N P C >

20, and N T C > 6.

small.

• Tracks must have a momentum p > 5 GeV/c to keep multiple scattering

• Track segments must point to the target, with a vertical coordinate of the

extrapolated segment at the target position |ytarget| < 25 cm.

A segment is approximated by a straight line connecting the ﬁrst and last point
of the segment. This line is used to predict the hit positions in all traversed
drift cells. For each cell two histograms are ﬁlled: N f ound(x) and N expect(x),
i.e. the found and expected numbers of hits, respectively, at the distance x

28

from the segment to the wire. The hit eﬃciency is calculated as

ǫhit(x) =

N f ound(x)
N expect(x)

Fig. 16 shows an example of such a cell eﬃciency proﬁle.

y
c
n
e
i
c
i
f
f

E

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
-2

-1.5

-1

-0.5

0

0.5

1

2
Distance to wire, cm

1.5

Fig. 16. Example of an eﬃciency proﬁle for a 5 mm drift cell.

To extract the single cell eﬃciency, the measured eﬃciency proﬁle is ﬁtted by a
function with six free parameters. The most important ones are the maximum
of the eﬃciency proﬁle, the smearing of its edges due to cell geometry and track
parameter errors, the background level which describes the average occupancy,
and the shift of the cell proﬁle due to misalignment. The method and the ﬁtting
procedure are described more detailed in [19, 20].

The resulting average cell eﬃciency per chamber, i.e. the mean value of the cell
eﬃciency proﬁle maxima, for 5 and 10 mm cells is summarized in Table 4 for
a typical run. The average hit eﬃciency is about 94 % for 5 mm cells and 97 %
for 10 mm cells. This is consistent with the expectation of a higher eﬃciency
for a larger drift cell at the same gas gain. The observed lower eﬃciencies of
superlayer TC2 are not completely understood.

Hits which are used twofold, ﬁrst deﬁning the track and then estimating the
eﬃciency, can bias the hit eﬃciency result. This was studied by exclusion of
a stereo layer from tracking and showed the bias to be less than 1 %.

29

Table 4
Average cell eﬃciencies (in %) for 5 and 10 mm cells in all PC and TC chambers
for a standard run.

Superlayer

−x

+x

5 mm 10 mm 5 mm 10 mm

95.8

95.0

96.2

95.0

95.6

92.2

97.5

97.2

98.2

96.8

97.7

95.4

94.9

92.3

96.3

94.2

94.4

89.8

98.2

98.2

98.5

94.7

96.9

93.2

PC1

PC2

PC3

PC4

TC1

TC2

4.2 Tracking Eﬃciency

The tracking eﬃciency is a basic quantity for most of the physics analyses. The
evaluation method developed for the OTR of HERA-B [21] uses a sample of
reference tracks which are reconstructed without using the OTR. A reference
track consists of a track segment in the VDS together with an associated RICH
ring or ECAL cluster. 9 In order to keep the contamination by unphysical
tracks (e.g. detector or reconstruction artefacts) in the reference sample low,
S → π+π−
each reference track must be consistent with originating from a K 0
decay. For all pairwise combinations of reference tracks and partner tracks
with at least a VDS and an OTR segment the invariant mass is calculated,
and the ﬁtted number of K 0
S particles in the mass spectrum is deﬁned to be
the number of reference tracks N RICH

.

ref

Then in the vicinity of each reference track an OTR segment matching with
the same VDS segment is searched. If one is found, the track momentum is
recalculated, and another invariant mass spectrum is generated as described
above. A ﬁt to this spectrum yields the number of reference tracks conﬁrmed
by the OTR, N OT R

.

ref

Figure 17 shows an example of corresponding mass spectra and ﬁts. The sur-
prising fact that N OT R
ref > N RICH
is due to the higher probability for wrong
matches in the VDS-RICH track sample. There are K 0
S candidates which only
show up when the better quality VDS-OTR track is used in the invariant mass
calculation. This eﬀect can be observed in Fig. 18 where side band events in

ref

9 For the purpose of a simpliﬁed notation, the following description uses VDS-RICH
tracks. It likewise holds for VDS-ECAL tracks by replacing every occurrence of the
term “RICH” by “ECAL”.

30

]

2

c
/
V
e
M
2
/
1
[
 
s
e
i
r
t
n
e

800

600

400

200

a)

p+p
-
 / +p+p
Fit

p-

-

NRICH
ref

2c

N

m

/ndf = 122/94
 94

 = 5752 
0
sK

 = 0.4968 
0
sK
 = 0.0071 
0
sK

 1e-4

 1e-4

NOTR
ref

2c

N

m

/ndf = 249/94
 87

 = 6511 
0
sK

 = 0.4964 
0
sK
 = 0.0062 
0
sK

 9e-5

 8e-5

]

2

1000

c
/
V
e
M
2
/
1
[
 
s
e
i
r
t
n
e

800

600

400

200

b)

p+p
-
 / +p+p
Fit

p-

-

0
0.4

0.45

0.5

0
0.4

0.45

0.5

0.55
RICH
p+pm
-

 [GeV/c

2

]

0.55
OTR
p+pm
-

 [GeV/c

2

]

Fig. 17. Determination of N RICH
. (a) All particle candidates with VD-
ref
S-RICH reference tracks which survive the selection cuts. (b) Particle candidates
with OTR segments matching the reference tracks. The momentum of the reference
track is replaced by the momentum of the corresponding VDS-OTR track.

and N OT R

ref

mass correlation

]

2

c
/
V
e
G

[
 
R-
T
O
m

p+

0.55

0.5

0.45

0.4

0.4

0.45

0.5

0.55
RICH
-

p+pm

 [GeV/c

2
]

Fig. 18. Correlation between the invariant masses of reference particles computed
with the momenta from VDS-RICH and VDS-OTR tracks, respectively.

the VDS-RICH sample have the proper invariant mass for the correspond-
ing VDS-OTR tracks. The eﬀect of such tracks must be excluded from the
eﬃciency calculation.

The determination of the number of reference particles N OT R
side which contribute
π+π− spectrum, but are in the side bands of the mRICH
S peak of the mOT R
to the K 0
π+π−
spectrum, is similar to that of N OT R
described above. The only diﬀerence is
that all VDS-RICH reference particle candidates with masses in the range

ref

31

–
–
–
s
p
–
–
–
s
p
p
± 3σRICH
K 0
S

mRICH
(see Fig. 17a) are excluded. A scaling factor f must be
K 0
S
introduced to extrapolate the number N OT R
side , which is determined in the side
bands, to the full mass range. Then the tracking eﬃciency can be calculated
as

ǫ =

N OT R

ref − f · N OT R
side
N RICH
ref

.

The eﬃciencies evaluated for the OTR in the 2002 running period are about
95–97 %, as shown in Table 5.

Table 5
An example of tracking eﬃciency results for data from the 2002 running period.

Mode

N M ode
ref

N OT R
ref

N OT R
side

f

ǫ

RICH 7031 ± 94

8230 ± 93

1095 ± 35

1.34 ± 0.02

0.965 ± 0.020

ECAL 4588 ± 78

5417 ± 77

787 ± 30

1.35 ± 0.02

0.954 ± 0.026

An important point to be noticed is that the eﬃciency estimation with this
method includes both the OTR tracking eﬃciency and the matching eﬃciency
between VDS and OTR segments. This is no disadvantage because the physics
analyses require the total eﬃciency anyway. In Sec. 4.3 the VDS-OTR match-
ing eﬃciency is estimated to be 98 % for pion tracks, which means that the
proper OTR tracking eﬃciency is even about 2 % higher than the numbers
displayed in Table 5.

4.3 Eﬃciency of Track Matching

Track segments are reconstructed independently in the VDS and in the OTR
PC chambers. The vector of track segment parameters at a reference z coor-
dinate is

VT = (x, y, tx, ty, q),

where x and y are the transverse coordinates, tx = px/pz and ty = py/pz are
the track slopes, and q = Q/ |~p| is the ratio of the charge Q and the particle
momentum |~p|.

Matching VDS and PC track segments goes through the following steps:

(1) Initially the vectors of segment parameters in the VDS (Vi

V DS) and in
P C) together with their covariance matrices are only

the PC region (Vj

32

partially known, because the component q is not yet deﬁned.

(2) A function performing a Kalman ﬁlter ﬁt ﬁnds all pairs Vi

P C
which ﬁt to each other. The χ2 of the ﬁt is a measure of the matching
quality.

V DS and Vj

(3) For each matched pair the ﬁt yields a track parameter q, which is common

to both segments.

The matching χ2 in step 2 does not follow a χ2 distribution because the track
parameter diﬀerences from the Kalman ﬁlter step are not Gaussian distributed.
The reasons are Moli`ere scattering of particles, hit corruption by background
particles, and failures of pattern recognition due to erroneous hit-segment
assignment or wrong left-right assignment of drift distances in the OTR.

In order to ﬁnd a reasonable cut value for the matching χ2, the reconstruction
S → π+π− and J/ψ → µ+µ− decays were investigated for
eﬃciencies of K 0
diﬀerent cuts on the matching χ2 [23]. From the invariant mass spectra of
π+π− and µ+µ− combinations the number of events in the corresponding peaks
and the combinatorial background underneath were evaluated. The results are
shown in Fig. 19.

25000

)
(

S

d
n
u
o
r
g
k
c
a
B
d
n
a
 

 

K

 
f
o
 
l
a
n
g
i
S

40000

35000

30000

20000

15000

10000

5000

(p
Number of events in KS
Background under the peak

p)

 peak

Number of events in J/y(m

+m

- ) peak

Background under the peak

a)

b)

0

0

200

400

600

800
1000
Cut on matching c 2

0

20

40

60

80 100 120 140 160 180 200
Cut on matching c 2

S → π+π− decays and (b) J/ψ → µ+µ− decays to-
Fig. 19. The number of (a) K 0
gether with the combinatorial backgrounds underneath the signal peaks as functions
of the cut on the matching χ2.

For very soft cuts on the matching χ2 all proper pairs of segments are matched
and the number of events in the peak reaches a plateau, but also the probability
to match wrong pairs becomes large and the background increases. Cutting
the matching χ2 at 200, the default value for data processing, the number of
reconstructed K 0
S decreases by only (3.3 ± 0.1) % from the plateau value (see
Fig. 19a). This results in a matching eﬃciency of about 98 % for a single pion
track.

d
n
u
o
r
g
k
c
a
B
d
n
a
 

 

/
J
 
f
o
 
l
a
n
g
i
S

6000

5000

4000

3000

2000

1000

33

p
p
y
The muons from the J/ψ decays are more energetic than the pions and also
have better chances to be reconstructed and matched because they have al-
ready been selected by the trigger. As can be seen in Fig. 19b, the number
of reconstructed J/ψ particles already reaches a plateau for matching χ2 cuts
much smaller than 200. Hence with the default cut the matching eﬃciency for
energetic muons is close to 100 %.

4.4 Momentum Resolution

The momentum resolution is one of the most important characteristics of a
forward spectrometer [24]. It deﬁnes not only the mass resolution, but also
the resolutions of kinematic variables, like the Feynman variable xF and the
transverse momentum pT .

The performance of the momentum reconstruction procedure was investigated
on a sample of J/ψ → µ+µ− decays. This sample was sorted into a 4 × 4 grid,
binned in momenta of the µ+ and the µ−. The mean momentum values of
each bin were 14, 26, 44, and 72 GeV/c. The mean mass values of the J/ψ in
Fig. 20a show good agreement with the nominal value in all momentum bins,
with a maximal relative deviation of less than 3 · 10−3.

The mass resolution of the J/ψ can be expressed by the momentum resolution
of muons approximately as

σ(Mij)
Mij

=

1
2  

σ(pi)
pi

⊕

σ(pj)

,

pj !

(2)

where i, j are the indices of the momentum bins for µ+ and µ−, respectively.
The momentum resolution is evaluated by ﬁtting the mass resolution in diﬀer-
ent bins using the formula (2), where the σ(pi)/pi are kept as free parameters
identical for both muon charges. The momentum resolution of the HERA-B
spectrometer as a function of momentum is presented in Fig. 20b. The function

σ(p)
p

(%) = (1.61 ± 0.02) + (0.0051 ± 0.0006) · p,

(3)

where the momentum p is in GeV/c, parametrises the momentum resolution
rather well.

34

< P(
< P(
< P(
< P(

+m
+m
+m
+m

) > = 14 GeV/c
) > = 26 GeV/c
) > = 44 GeV/c
) > = 72 GeV/c

]

2

c
/
V
e
M

[
 
 
 
)
-

+

(
 

/
J

 
 
f
o
 
s
s
a
M

3130

3120

3110

3100

3090

3080

3070

]

%

[
 
 
 
 
)

(
P

 
/
 
)
)

(
P
(

2.2

2.1

2

1.9

1.8

1.7

1.6

1.5
0

a)

b)

0

10

20

30

40

50

60

< P(

70
-
) >    [GeV/c]

80

10

20

30

40

50

60

70
) >    [GeV/c]

80

< P(

Fig. 20. Characteristics of the HERA-B spectrometer evaluated on a sample of
J/ψ → µ+µ− decays. a) The mean value of the J/ψ mass as a function of the mean
µ− momentum for the given bins of the µ+ momentum. The dashed line shows the
nominal value of the J/ψ mass. b) The momentum resolution versus momentum.
The dashed line shows the parametrisation (3).

5 Conclusions

In this paper we describe the operation and performance of the HERA-B Outer
Tracker, a 112 674 channel system of planar drift tube layers. The design and
construction of the detector is described in [3], the electronics in [4] and the
aging investigations in [11].

The Outer Tracker was run for about 3500 hours in the HERA-B experiment
at target rates of typically 5 MHz, corresponding to channel occupancies of
about 2 % in the hottest regions. In a ﬁrst running period the detector showed
various operational problems which could be overcome by major repairs and
improvements in a longer shutdown. After that the detector was stably op-
erated at a gas gain of 3 · 104 using an Ar/CF4/CO2 (65:35:5) gas mixture.
At this working point a good trigger and track reconstruction eﬃciency was
measured. At the end of the HERA-B running no aging eﬀects in the Outer
Tracker cells were observed. However, the total irradiation stayed far below
the originally anticipated exposure.

About 95 % of all drift cells were well functioning, losses were mainly due to
dead channels while the fraction of noisy channels stayed below 1 % in most
chambers. Due to the high redundancy of the tracking system this caused
essentially no loss in tracking eﬃciency which was more than 95 % for tracks
with momenta above 5 GeV/c.

The hit resolution of the drift cells was 300 to 320 µm. Due to the large lever
arm of the tracking system and the high redundancy the single cell resolution
has no large inﬂuence on the momentum resolution which as a function of the

35

m
m
m
y
m
m
m
s
momentum was determined to be

σ(p)
p

(%) = (1.61 ± 0.02) + (0.0051 ± 0.0006) · p

In summary, the performance of the HERA-B Outer Tracker system fullﬁlled
all requirements for stable and eﬃcient operation in a hadronic environment,
thus conﬁrming the adequacy of the honeycomb drift tube technology and
of the front-end readout system. Although the detector has not really been
challenged regarding radiation exposure and occupancies, the performance
studies allow to conclude that a suitable tracking concept for a high rate
environment was found.

Acknowledgements

We thank our colleagues of the HERA-B Collaboration who made in a common
eﬀort the running of the detector possible. The HERA-B experiment would
not have been possible without the enormous eﬀort and commitment of our
technical and administrative staﬀ. It is a pleasure to thank all them.

We express our gratitude to the DESY laboratory for the strong support in
setting up and running the HERA-B experiment. We are also indebted to
the DESY accelerator group for the continuous eﬀorts to provide good beam
conditions.

References

[1] T. Lohse et al., HERA-B: An Experiment to Study CP Violation in the B System
Using an Internal Target at the HERA Proton Ring, Proposal, DESY-PRC
94/02 (1994).

[2] E. Hartouni et al., HERA-B: An Experiment to Study CP Violation in the B
System Using an Internal Target at the HERA Proton Ring, Design Report,
DESY-PRC 95/01 (1995).

[3] H. Albrecht et al. (HERA-B Outer Tracker Group), Nucl. Instr. and Meth. A

[4] H. Albrecht et al. (HERA-B Outer Tracker Group), Nucl. Instr. and Meth. A

555 (2005) 310.

541 (2005) 610.

[5] R. Mankel, Nucl. Instr. Meth. A 395 (1997) 169.

36

[6] The HERA-B Collaboration, HERA-B Report on Status and Prospects,

October 2000, DESY-PRC 00/04.

[7] V. Rybnikov et al., Proc. 7th International Conference on Accelerator and Large
Experimental Physics Control Systems (ICALEPCS 99), Trieste, Italy, 1999,
630-632.

[8] M. Hohlmann, Nucl. Instr. and Meth. A 515 (2003) 132.

[9] M. Dam et al., Nucl. Instr. and Meth. A 525 (2004) 566.

[10] T. Fuljahn, G. Hochweller and D. Ressing, IEEE Trans. Nucl. Sci., Vol. 46 (1999)

920.

[11] M. Cape´ans et al., Nucl. Instr. and Meth. A 515 (2003) 140.
H. Albrecht et al., Nucl. Instr. and Meth. A 515 (2003) 155.
K. Berkhan et al., Nucl. Instr. and Meth. A 515 (2003) 185.

[12] A. Schreiner et al., Nucl. Instr. and Meth. A 515 (2003) 146.

[13] J. M. Hern´andez et al., Nucl. Instr. and Meth. A 546 (2005) 574.

[14] GEANT, Detector Description and Simulation Tool, CERN Program Library

W5013 (1994).

[15] I. Vukoti´c, Measurement of J/ψ and ψ(2S) Production in Proton-Nucleus
Interactions Using the HERA-B Experiment, Ph.D. Thesis, Humboldt
Universit¨at zu Berlin (2005).

[16] W. Hulsbergen, A Study of Track Reconstruction and Massive Dielectron
Production in HERA-B, Ph.D. Thesis, Universiteit van Amsterdam (2002).

[17] R. Zimmermann, Zeitmesselektronik f¨ur den HERA-B Detektor, Ph.D. Thesis,

Universit¨at Rostock (1999).

[18] I. Belotelov, A. Lanyov and G. Ososkov, Alignment of HERA-B Outer Tracker
with simultaneous ﬁt of track and alignment parameters, HERA-B 05-009
(2005).

[19] A. Abyzov et al., Study of the Hit Eﬃciency of the OTR PC Chambers, HERA-

B 02-034 (2002).

Rostock (2004).

[20] A. Abyzov et al., Part. Nucl. Lett. 5 (2002) 40.
[21] R. Pernack, J/ψ- und ψ′-Produktion bei HERA-B, Ph.D. Thesis, Universit¨at

[22] A.A. Bel’kov et al., Tracking Performance of the HERA-B Outer Tracker PC

Cambers, HERA-B 02-040 (2002).

[23] N. Karpenko and A. Spiridonov, Eﬀects of Matching on Signals and

Backgrounds, HERA-B 03-019 (2003).

[24] A. Spiridonov, Uncertainties in Track Momentum due to Multiple Scattering in

a Forward Spectrometer, DESY 02-151 (2002).

37

