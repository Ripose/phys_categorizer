Èíñòèòóò

Òåîðåòè÷åñêîé

è

Ýêñïåðèìåíòàëüíîé

Ôèçèêè

21–06

7
0
0
2
 
n
a
J
 
9
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
8
0
1
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

I.G. Alekseev, V.A. Andreev, P.E. Budkovsky, E.A. Filimonov,
V.V. Golubev, V.P. Kanavets, M.M. Kats, L.I. Koroleva,
A.I. Kovalev, N.G. Kozlenko, V.S. Kozlov, A.G. Krivshich,
V.V. Kulikov, B.V. Morozov, V.M. Nesterov, D.V. Novinsky,
V.V. Ryltsov, M.E. Sadler, V.A. Sakharov, D. Soboyede,
A.D. Sulimov, V.V. Sumachev, D.N. Svirida, V.Yu. Trautman,
E. Walker, S. Watson.

Cost Eﬀective Electronics
for Proportional and
Drift Chambers of
’EPECUR’ Experiment

Ìîñêâà 2006

ÓÄÊ 539.1.075

Ì-16

Cost Eﬀective Electronics for Proportional and Drift Chambers of ’EPECUR’ Experiment. Preprint ITEP
21-06/

I.G. Alekseev, V.A. Andreev, P.E. Budkovsky, E.A. Filimonov, V.V. Golubev, V.P. Kanavets,
M.M. Kats, L.I. Koroleva, A.I. Kovalev, N.G. Kozlenko, V.S. Kozlov, A.G. Krivshich, V.V. Ku-
likov, B.V. Morozov, V.M. Nesterov, D.V. Novinsky, V.V. Ryltsov, M.E. Sadler, V.A. Sakharov,
D. Soboyede, A.D. Sulimov, V.V. Sumachev, D.N. Svirida, V.Yu. Trautman, E. Walker, S. Watson.
M., 2006-23 p.

’EPECUR’ experiment setup is under construction at the beam line 322 of the ITEP proton syn-
chrotron. The experiment requires several large area drift chambers to provide reasonable acceptance
and ﬁne pitch proportional chambers for beam particle tracking with total number of electronic chan-
nels of about 7000. New compact and cost eﬀective readout system for these gaseous detectors was
designed, prototyped and tested in the latest two years based on the modern technologies in analog
and digital electronics, as well as in data transfer protocols. Mass production of the proportional
chamber electronics is close to the end, while the boards for the drift chambers are manufactured in
the amount to equip one 8-plane module. The paper presents the functional description of the whole
DAQ system and its main parts together with some of the test results as an illustration of the excellent
performance of the system. The appendix contains speciﬁc information which may be useful for the
system users or code developers.

ÍÅÄÎÎÀß ÝËÅÊÒÎÍÈÊÀ ÄËß ÏÎÏÎÖÈÎÍÀËÜÍÛÕ È ÄÅÉÔÎÂÛÕ ÊÀÌÅ ÝÊÑÏÅÈ-

ÌÅÍÒÀ "ÝÏÅÊÓ".

È.. Àëåêñååâ, Â.À. Àíäðååâ, Ï.Å. Áóäêîâñêèé, Â.Â. îëóáåâ, Â.Ï. Êàíàâåö, Ì.Ì. Êàö, Ë.È. Êî-

ðîëåâà, À.È. Êîâàëåâ, Í.. Êîçëåíêî, Â.Ñ. Êîçëîâ, À.. Êðèâøè÷, Â.Â. Êóëèêîâ, Á.Â. Ìîðîçîâ,

Â.Ì. Íåñòåðîâ, Ä.Â. Íîâèíñêèé, Â.Â. ûëüöîâ, Ì.Å. Ñàäëåð, Â.À. Ñàõàðîâ, Ä. Ñîáîåäå, À.Ä. Ñó-

ëèìîâ, Â.Â. Ñóìà÷åâ, Ä.Í. Ñâèðèäà, Â.Þ. Òðàóòìàí, Å. Óîëêåð, Ñ. Óàòñîí, Å.À. Ôèëèìîíîâ.

Ì., 2006(cid:21)23 ñòð.

Êîíñòðóèðîâàíèå ýêñïåðèìåíòàëüíîé óñòàíîâêè "ÝÏÅÊÓ" èäåò ïîëíûì õîäîì íà 322-ì ïó÷-

êå ïðîòîííîãî ñèíõðîòðîíà ÈÒÝÔ. Äëÿ ïðîâåäåíèÿ ýêñïåðèìåíòà òðåáóåòñÿ íåñêîëüêî áîëüøèõ

äðåéîâûõ êàìåð, ÷òîáû îáåñïå÷èòü íåîáõîäèìûé àêñåïòàíñ, à òàêæå ïðîïîðöèîíàëüíûå êàìåðû

ñ ìåëêèì øàãîì ïðîâîëî÷åê äëÿ ðåãèñòðàöèè ÷àñòèö ïó÷êà. Îáùåå ÷èñëî íåîáõîäèìûõ êàíàëîâ

ýëåêòðîíèêè ñîñòàâëÿåò îêîëî 7000. Íîâàÿ êîìïàêòíàÿ è íåäîðîãàÿ ñèñòåìà ñ÷èòûâàíèÿ ñ ýòèõ

ãàçîâûõ äåòåêòîðîâ áûëà ðàçðàáîòàíà è îïðîáîâàíà â òå÷åíèå äâóõ ïîñëåäíèõ ëåò. Ñèñòåìà èñ-

ïîëüçóåò íîâåéøèå äîñòèæåíèÿ òåõíîëîãèé â îáëàñòè àíàëîãîâîé è öèðîâîé ýëåêòðîíèêè, à

òàêæå â îáëàñòè ïðîòîêîëîâ ïåðåäà÷è äàííûõ. Ìàññîâîå ïðîèçâîäñòâî ýëåêòðîíèêè äëÿ ïðîïîð-

öèîíàëüíûõ êàìåð áëèçèòñÿ ê çàâåðøåíèþ, òîãäà êàê ïëàòû äëÿ äðåéîâûõ êàìåð ïðîèçâåäåíû

â êîëè÷åñòâå, íåîáõîäèìîì äëÿ îñíàùåíèÿ îäíîãî 8-ïëîñêîñòíîãî ìîäóëÿ. Â ðàáîòå ïðåäñòàâëåíî

óíêöèîíàëüíîå îïèñàíèå ñèñòåìû ñáîðà äàííûõ è åå îñíîâíûõ ÷àñòåé, à òàêæå ðåçóëüòàòû ðàç-

ëè÷íûõ òåñòîâ êàê èëëþñòðàöèÿ ïðåâîñõîäíîé ðàáîòû îáîðóäîâàíèÿ. Â ïðèëîæåíèè ñîäåðæèòñÿ

ñïåöèè÷åñêàÿ èíîðìàöèÿ, êîòîðàÿ ìîæåò áûòü ïîëåçíà ïîëüçîâàòåëþ ñèñòåìû èëè ðàçðàáîò-

÷èêó ïðîãðàììíîãî îáåñïå÷åíèÿ.

Fig. – 14, refs. – 6 names.

c(cid:13) Èíñòèòóò òåîðåòè÷åñêîé è ýêñïåðèìåíòàëüíîé èçèêè, 2006

1.

Introduction

’EPECUR’ experiment is primarily aimed at the search of the cryptoexotic narrow nucleon resonance N10, the
non-strange neutral member of the pentaquark antidecuplet [1]. General search for narrow pion-nucleon reso-
invariant mass of π−p system in
nances
s-channel in the region (1610–1770) MeV with the explicit detection of π−p and K 0Λ ﬁnal states, which is
essentially a very accurate cross-section measurement of the mentioned processes in very ﬁne steps in energy.

is also implied.

The method is

scan of

the

the

is

The

setup

under

construction

the
U-10 synchrotron (ITEP, Moscow). The beam line ideally ﬁts the experiment requirements due to its very
good momentum resolution of better than 0.1 % [2] and reasonably high typical intensity of 2 · 105 negative
pions per accelerator cycle (every 4 seconds). The project is a united eﬀort of ITEP (Moscow), PNPI (St.
Petersburg) and ACU (Abilene, USA). The construction started in 2005 from scratch and the beginning of data
taking is scheduled on early 2008.

universal

beam

line

322

the

at

of

To reach the goal of the experiment two types of tracking detectors are required:

a) small but fast detectors for incident particle tracking and its momentum measurement;
b) large acceptance high accuracy detectors for the tracking of the reaction products.

Both detectors should have as little matter as possible on the way of the particles to minimize multiple scattering
and maintain the beam momentum resolution.

Fine pitch proportional chamber is a good solution for a). In addition such detector provides fast trigger
capability, allowing to minimize the number of scintillation counters in the beam. Two-coordinate chamber
with 1 mm pitch and 200×200 mm2 sensitive area has 400 sensitive wires.

Wire drift chambers with hexagonal cell structure [3] and 20 mm cell diameter were selected as the best choice
for b). Typical drift chamber module covers 800×1200 mm2 area and is a stack of 4 submodules with horizontal,
vertical and tilted wire directions. Each submodule has two planes of drift cells, resulting in approximately 530
sensitive wires per module.

The setup at its ﬁnal stage includes 6 proportional chambers, 5 drift modules of the mentioned size, as well
as a twice larger drift module and 4 smaller modules. This gives 2400 proportional and approximately 4300
drift sensitive wires and corresponding number of electronic channels.

Limited funding of the project together with the relatively large number of required electronic channels put
out a challenge to built a cost eﬀective data acquisition system for the experiment. To lower the cost the simplest
and most compact solution was implemented using only commercially available components. Variety of modern
integrated circuits, both analog and digital, together with advanced PCB technology allowed to develop best
quality devices meeting the experiment requirements. Interconnection between the parts of the DAQ is based
on the wide spread protocols such as USB and Ethernet, allowing application of standard interfacing modules.
During 2005-2006 all parts of the DAQ were designed, manufactured and successfully tested with the pro-
totype detectors. Mass production of proportional chamber electronics and auxiliary hardware is close to the
end, while the boards for the drift chambers are in production in the quantity necessary to equip two prototype
submodules.

This paper describes the structure of the ’EPECUR’ data acquisition system, as well as the principles of

operation of its main components. Selected test results are also presented.

2.

’EPECUR’ DAQ Structure

The data acquisition system is illustrated by Fig. 1 and includes:

1. 100-channel proportional boards performing the following functions:

• wire signal ampliﬁcation and conditioning;
• leading edge pulse discrimination;
• latching of the signals on the arrival of late trigger by means of the digital delay line;
• encoding of the hit wire numbers into the digital data ﬂow;
• transfer of the data through a high speed USB connection;
• forming of the fast trigger output as an OR of all wire hit signals;

DRIFT BOARD 24

USB CABLES

PROP. BOARD 16

PROP. BOARD 3

PROP. BOARD 2

PROP. BOARD 1

DRIFT BOARD 3

DRIFT BOARD 2

DRIFT BOARD 1

DRIFT BOARD 24

DRIFT BOARD 3

DRIFT BOARD 2

DRIFT BOARD 1

2

I

N
O
T
U
B
R
T
S
D

I

I

I

N
O
T
U
B
R
T
S
D

I

I

I

N
O
T
U
B
R
T
S
D

I

I

1
 
X
O
B

2
 
X
O
B

 

0
1
X
O
B

USB CABLES

TRIGGER AND
POWER CABLES

TRIGGER AND
POWER CABLES

USB CABLES

TRIGGER AND
POWER CABLES

R
E
H
T
O

S
E
C
R
U
O
S

FAST
TRIGGER
LOGIC

TRIGGER
FANOUT

1 Gbit/s
ETHERNET
HUB(S)

S
R
E
T
U
P
M
O
C
Q
A
D
R
E
H
T
O

 

 

E
N
I
L
 
R
E
W
O
P
C
A

 

1 Gbit/s
ETHERNET
HUB

DAQ

SERVER

Figure 1. ’EPECUR’ data acquisition system block diagram.

2. 24-channel drift boards with similar functionality, but with added time digitization capability and no fast

3. locally placed distribution boxes providing power, trigger and USB connections for the boards, as well as

4. DAQ server computer and several workstations for control and monitoring, connected into a local fast

trigger output;

the Ethernet interface for the data;

Ethernet network.

Proportional and drift boards are mounted directly on the chamber frames close to the sensitive wire ends.
Each of the boards is connected to a distribution box with a 4-wire USB cable and a 4-pair UTP (Unshielded
Twisted Pair) cable carrying power and diﬀerential trigger signals.

3.

100-Channel Proportional Chamber Board

Proportional chamber board (Fig. 2) contains 100 identical analog channels, Xilinx FPGA chip, Cypress USB
microprocessor, discriminator level DAC and power conditioning components.

The input of each channel is resistively connected to the ground to provide zero potential to the signal
wire. The diode-based low capacitance protection circuit prevents the input from over-voltage in case of spark
discharge in the chamber. The fast current sensitive transimpendance ampliﬁer is based on a 1.2 GHz IC chip
and provides the signal ampliﬁcation of 5 mV/µA. The RC shaper-ﬁlter is designed to cut out the long tail of
the charge collection signal and to reduce the high frequency noise component on the ampliﬁer output.

A fast comparator with TTL output is used to form the leading edge discriminator. All channels have
common discrimination threshold programmable in 1 mV steps by means of a serial DAC controlled by the
microprocessor. The amplitude spread of the signals at the comparator input is in the range of 10 mV to 50 mV.
Rather low ampliﬁcation allows to avoid oscillation problem and makes the ampliﬁer stage cost eﬀective. At
the same time a careful choice of the comparator with low oﬀset voltage of several mV is necessary.

Figure 3 shows the typical results of a board threshold spread test. Due to the bias currents ﬂowing into the
comparator inputs, the actual discriminator level is always several mV below the common voltage, applied to the
negative comparator inputs. The software can read each channel level state at various DAC settings and thus
count the number of trigged channels (with no input signal) as a function of applied threshold voltage. Solid
and dashed lines present the number of trigged channels when the threshold voltage is changed in steps of 1 mV

e
r
i

W

 
 
 

m
o
r
F

e
r
i

W

 
 
 

m
o
r
F

e
r
i

W

 
 
 

m
o
r
F

e
r
i

W

 
 
 

m
o
r
F

3

Protection
Circuit

Trans−
impendance
Amp.

Shaper−
Filter

Level
Comparator

Protection
Circuit

Trans−
impendance
Amp.

Shaper−
Filter

Level
Comparator

CH1

CH2

CH3

Protection
Circuit

Trans−
impendance
Amp.

Shaper−
Filter

Level
Comparator

TRIGGER IN

TRIGGER OUT

Power &
Trigger
Connector

Protection
Circuit

Trans−
impendance
Amp.

Shaper−
Filter

Level
Comparator

CH100

Test signal
Buffer

DAC

CYPRESS
USB
processor

USB
Connector

Figure 2. Proportional chamber board block diagram.

3
 
N
A
T
R
A
P
S

A
G
P
F

L
O
R
T
N
O
C

A
T
A
D

from 0 to 15 mV and back, correspondingly. The range of 3 to 5 mV is the region of instability, where many of
the channels are very close to their thresholds and start switching synchronously causing positive feedback from
the TTL output to the ampliﬁer input. This is the reason why the solid and dashed lines do not coincide. The
software can also identify the region where the oscillating switching of the comparator outputs occur; the half
number of oscillating channels is presented by the dash-dotted and dotted lines for ascending and descending
threshold voltages. As it’s seen from Fig. 3, at threshold voltages above 7 mV all 100 channels are not trigged
and ready to accept small signals, while the total threshold spread is 6 mV.

All comparator outputs are tied to the inputs of the Spartan-3 [4] Field Programmable Gate Array (FPGA)
chip and all subsequent signal processing is done digitally inside this chip. Figure 4 illustrates the the idea of
the conﬁguration implemented in th FPGA.

The leading edge of the signal from the comparator is captured by the ’edge detector’ and starts two counters.
The ’length counter’ is intended for producing a signal of several clock periods1 which is then put to the digital

1The internal clock frequency of the FPGA is 96 MHz, corresponding clock period is about 10 ns.

Channels versus threshold 

 
s
l
e
n
n
a
h
C
N

 

100

90

80

70

60

50

40

30

20

10

0

0

2

4

6

8

10

12

14

Threshold, mV 

Figure 3. Typical results of the proportional board threshold spread test.

m
F
i
g
u
r
e

4
.

P
r
o
p
o
r
t
i
o
n
a
l

b
o
a
r
d
F
P
G
A
b
l
o
c
k

d
i
a
g
r
a
m

.

 

F
R
O
M
T
R
G
G
E
R

I

 
I

N
P
U
T

C
H
1
0
0

Edge
Detector

Dead Time
Counter

Length
Counter

F
R
O
M

C
O
M
P
A
R
A
T
O
R

M
A
S
K
1
0
0

O
R
M
S
K
1
0
0

F
R
O
M

C
O
M
P
A
R
A
T
O
R

M
A
S
K
2

O
R
M
S
K
2

F
R
O
M

C
O
M
P
A
R
A
T
O
R

M
A
S
K
1

O
R
M
S
K
1

C
H
2

C
H
1

Edge
Detector

Edge
Detector

Dead Time
Counter

Dead Time
Counter

Length
Counter

Length
Counter

100 BIT  WIDE  DIGITAL  DELAY  LINE

ENCODER FIFO

100

100

ENCODER

8

Trigger
Counter

G
a
t
e

1
6

8

OUTPUT FIFO

TO USB        PROCESSOR

O
R
1
0
0

L
e
n
g
t
h

l

D
e
a
y
 
a
n
d

T
r
i
g
g
e
r

O
u
t
p
u
t

 

T
O
T
R
G
G
E
R

I

O
U
T
P
U
T

S
P
A
R
T
A
N
3

4

5

delay line. The ’dead time counter’ blocks the further acceptance of signals by the channel for a certain amount
of time. This is done to suppress ’ringing’ on the input line caused by the crossing of the comparator threshold
by the long and slowly changing charge collection tail. Both counters are separately programmable, but to the
same values for all channels (see Table A4). A pulse of one clock period from each channel is used to form the
grand OR trigger output. The duration and the delay of the signal on this output are also programmable in
one clock period steps. A channel may be completely disabled, or its participation in the grand OR may be
forbidden, by setting corresponding MASK or ORMSK bits.

The state of all 100 ’length counter’ outputs is continuously piped through the digital delay line. On the
(late) arrival of the actual system trigger a time slice is retrieved from a certain (programmable) depth of the
delay line, representing the state of all channels on the time of the event which caused the trigger. This 100-bit
wide time slice is stored to the encoder FIFO which provides buﬀering and ensures dead-timeless operation.
The encoder converts the nonzero bit positions in the slice into the sequence of their numbers and directs it to
the output FIFO preceded by some control information including the sequential trigger number (see Table A2
for details).

The data is then transferred to the USB microprocessor [5] and buﬀered there to form an USB packet [6]
which can be retrieved on the request from the host computer. Another data line is used by the processor to load
and read the programmable registers inside the FPGA. The microprocessor is also responsible for generating
the test pulse which is distributed to each analog channel input through a small capacitance.

The microprocessor code and the FPGA conﬁguration ﬁrmware is not stored on the board thus eliminating
additional cost expenses for the large ﬂash memory chip and saving the board space. Instead, on power up the
bootloader hardcoded into the microprocessor retrieves the application code through the USB from the host
computer. In turn, this code provides the possibility to conﬁgure the FPGA chip with the ﬁrmware downloaded
by the USB host. In addition such approach gives an extreme ﬂexibility of changing the microprocessor code
as well as the FPGA conﬁguration. A very small I2C ﬂash memory is used to keep the board identiﬁcation and
serial numbers which are programmed at the production time.

The summary of USB requests served by the application code is presented in Table A1.
The board dimensions are 275×120 mm2 (Fig. 5) and the connection to the chamber is done via the 200 pin
two row 90o male header connector (all pins in the second row are the signal ground). Several LED indicators
(see Table A6) visualize the board status. Power requirements are listed in the Table 1. The power is supplied
to the board through an RJ45 8 pin connector (Table A7) which also provides the trigger connection. Natural
convection airﬂow is enough at room temperature for the board cooling in any position, but forced ventilation
is required if the board is placed in a closed volume.

Table 1. Power requirements for the 100-channel proportional chamber board.

Range Current Power dissipation

Supply
+6 V
5.5–6.5 V
–6 V –(5.5–6.5) V
3.6–4.3 V
+4 V

1.4 A
1.3 A
0.4 A
Total power dissipation:

8.4 W
7.8 W
1.6 W
17.8 W

4.

24-Channel Drift Chamber Board

The structure of the drift chamber board is very similar to that of the proportional one, discussed in the previous
section (Fig. 2). The main diﬀerences are:

• only 24 analog channels per board;
• faster transimpendance ampliﬁer;
• completely diﬀerent FPGA conﬁguration with individual channel timing capability;
• additional circuity for temperature and power monitoring;
• smaller board size.

The FPGA conﬁguration for the drift chamber board is presented in Fig 6. The input stage of each channel
is similar to that of the proportional design and includes ’edge detector’ and ’dead time counter’. On the
detection of the signal the value of the 13-bit absolute time counter is latched and stored to an intermediate ’2
word FIFO’. The equivalent frequency of the counter is 576 MHz, corresponding to 1.74 ns time measurement

6

S

S

S

S

S

S

S

(cid:16)(cid:16)(cid:16)(cid:16)(cid:16)(cid:16)(cid:16)(cid:16)(cid:16))

POWER&TRIGGER
CONNECTOR

0 cm

5 cm

10 cm

Z}

Z

CHAMBER
CONNECTOR

Z

Z

Z

Z

Z

XXXXXXXXXy
(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)9

Z

Z

S

SSw

(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24):
XXXXXXXXXXXXXXXXXXXz

(cid:26)(cid:26)>

(cid:26)

ANALOG
CHANNELS

(cid:26)

(cid:26)

(cid:26)

(cid:26)

(cid:8)(cid:8)

(cid:8)(cid:8)(cid:25)

(cid:8)

(cid:8)(cid:8)

(cid:8)(cid:8)

(cid:8)

(cid:8)(cid:8)

(cid:8)

(cid:8)(cid:8)(cid:8)(cid:25)

USB
CONNECTOR

CYPRESS USB
µPROCESSOR

(cid:0)(cid:0)(cid:18)

(cid:0)

(cid:0)

(cid:0)

(cid:0)

(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24)(cid:24):

SPARTAN3
FPGA

(cid:8)(cid:8)

(cid:8)(cid:8)

(cid:8)(cid:8)

(cid:8)(cid:8)(cid:8)(cid:25)

CHAMBER
CONNECTOR

(cid:0)(cid:0)(cid:18)

(cid:0)

(cid:0)

(cid:0)

(cid:0)

(cid:0)

CHAMBER CONNECTOR

Figure 5. Proportional (right) and drift (left) chamber boards. Chamber connectors are not mounted on both
board views.

7

FALSE

SPARTAN3

MASK1

FROM
COMPARATOR

MASK2

FROM
COMPARATOR

MASK24

FROM
COMPARATOR

FROM
TRIGGER INPUT

CH1

CH2

CH24

e
g
d
E

r
o
t
c
e
t
e
D

TRIG

e
g
d
E

r
o
t
c
e
t
e
D

e
g
d
E

r
o
t
c
e
t
e
D

e
g
d
E

r
o
t
c
e
t
e
D

13 Bit Latch

576 MHz
Absolute
Time
Counter

13 Bit Latch

576 MHz
Absolute
Time
Counter

13 Bit Latch

576 MHz
Absolute
Time
Counter

i

e
m
T
 
d
a
e
D

r
e
t
n
u
o
C

i

e
m
T
 
d
a
e
D

r
e
t
n
u
o
C

i

e
m
T
 
d
a
e
D

r
e
t
n
u
o
C

I

O
F
F
 
d
r
o
W
 
2

I

O
F
F
 
d
r
o
W
 
2

I

O
F
F
 
d
r
o
W
 
2

r
e
t
t
i

b
r
A

r
e
t
t
i
b
r
A

r
e
t
t
i
b
r
A

N
E
L
N
W

I

>0

>0

O
F
F

I

 
 

E
M
T

I

 
 

I

T
H

i

i

 

n
g
e
B
w
o
d
n
W
 
o
t
 
e
v
i
t
a
e
R
 
e
m
T

l

i

 
t
i

H

Window Begin Absolute Time

WR

WINBEG

OLD Hits Removal
Logic

13 Bit Latch

576 MHz
Absolute
Time
Counter

R
O
S
S
E
C
O
R
P

 
 
 
 
 
 
 
 

B
S
U
O
T

 

O
F
F

I

 
 

T
U
P
T
U
O

WR

Gate

r
e
g
g
i
r
T

r
e
t
n
u
o
C

Figure 6. Drift board FPGA block diagram.

"OLD" −− Dropped

IN WINDOW −− To output

"YOUNG" −− Left in FIFO

8

THIT

WINLEN

WINBEG

HITS

WINDOW

TRIGGER

Figure 7. Drift board timing.

unit. Each channel has its locally placed absolute time counter to minimize the connection delays on the FPGA
crystal. All counters are synchronized on the system initialization and at the beginning of each accelerator
cycle period. Nonempty intermediate FIFOs store their content to the main ’hit time FIFO’ arbitrating on the
’channel number priority’ basis. Channel number is stored to the main FIFO together with the absolute time
value latched by this channel.

Only those channel hits that fall into a certain window are processed. Two programmable registers (Table A5)
are responsible for the deﬁnition of this window: WINBEG designates the beginning of the window prior to the
arrival of the system trigger, while WINLEN is the window length (see Fig 7).

The absolute time value of the oldest (ﬁrst in the queue) hit is always present on the main FIFO output.
The running value of the ’age threshold’ is continuously calculated by the ’old hits removal logic’ as the absolute
time decreased by the WINBEG setting (actually this is ’window begin’ given the trigger arrives at the current
moment). The two values are continuously compared and the hit is removed from the FIFO as soon as it
becomes older than the ’age threshold’. Thus the oldest hit in the FIFO on the moment of actual trigger arrival
will be the ﬁrst hit falling into the trigger window. The procedure also ensures that the FIFO is never overﬂown
in case no triggers follow the wire signals.

On the detection of the system trigger processing of the channel signals arrived by this time starts. The
trigger arrival time is digitized by the separate channel also in terms of the absolute time. The beginning of the
actual window is calculated and this value is then subtracted from the consequent hit values from the FIFO to
form the hit time values THIT , relative to the window begin. These resulting values are passed to the output
FIFO preceded by the sequential trigger number. The procedure stops and the trigger is considered to be served
when the main FIFO is empty or a hit value later than the window end is encountered. The hits left in the
FIFO will either become ’old’ and be removed or picked up by the next trigger window.

Processing of each hit in the window takes one CLK2 period2, so the trigger service time is proportional to
the number of hits in the window. During this service time other triggers appearing on the input do not start
the hit selection procedure, but increment the trigger counter. During the data taking, if even some triggers
are lost, probably diﬀerently in diﬀerent boards, the trigger number preceding the data of a certain event will
always be the same in all boards.

In case of frequent triggers, the trigger windows of the consequent triggers may overlap. In this case the
earlier trigger will sweep the hits from the main FIFO, which might also correspond to the later one. This
possibility should be taken into account in the data processing.

The further data transferring in the drift chamber board is essentially the same as in the proportional one,

except that the structure of the data ﬂow is diﬀerent reﬂecting the timing capability (Table A3).

The board dimensions are 300×50 mm2 (Fig. 5), connection to the chamber is done via the two 24 pin
two row 90o male header connectors (as in the proportional design, every second pin is signal ground). LED
indicators are similar to those of the proportional board (Table A6). Power requirements are listed in the
Table 2. Power and trigger connection is the same as in the proportional design (Table A7), so that the same
cables can be used for both types of the boards. Power dissipation is more than 3 times less than that of the
proportional board, yet forced airﬂow should be used for cooling if many of the boards are placed in a closed

2CLK2 frequency is 48 MHz, corresponding period is about 20 ns

9

24 Power/Trigger
Connectors

+6.5V
+4.2V

Control
Monitor

−6.5V

Control
Monitor

+5V

NIM  NIM
TRIN TROUT

POWER & TRIGGER

DISTRIBUTION
BOARD

AND PROP. CHAMBER

TRIGGER LOGIC

MODIFIED

PC PS

 

C
A
V
0
2
2

MODIFIED

PC PS

REGULAR
PC PS

MB POWER

PS Control
& Monitor

100 Mbit/s Ethrnet

PC MOTHERBOARD

With LAN BootROM

4 USB Connectors on MB

Figure 8. Distribution box block diagram.

b
u
h
 
B
S
U

 
t
r
o
p
 
7

b
u
h
 
B
S
U

 
t
r
o
p
 
7

b
u
h
 
B
S
U

 
t
r
o
p
 
7

s
r
o
t
c
e
n
n
o
C
B
S
U
 
1
2

 

Table 2. Power requirements for the 24-channel drift chamber board.

Range Current Power dissipation

Supply
+6 V
5.5–6.5 V
–6 V –(5.5–6.5) V
3.6–4.3 V
+4 V

0.33 A
0.31 A
0.4 A
Total power dissipation:

2.0 W
1.9 W
1.6 W
5.5 W

volume.

5. Distribution Box

In the framework of ’EPECUR’ DAQ system the data is transferred from the chamber boards by means of
universal serial bus (USB) [6]. This approach has many obvious advantages, based on the fact that USB is well
developed and widely spread:

• high transfer speed 480 Mbit/s;
• thin 4 wire connection cable;
• up to 127 ’devices’ on one branch;
• ’device’ side controller chips are readily available and relatively cheap;
• software development tools are well developed for both ’host’ and ’device’ sides;
• many standard items are commercially available (i.e. cables, connectors, hubs etc.).

The main disadvantage of USB is the 5 m limit on a single connection cable length, while the experiment

requires transferring of the data for distances up to 100 m.

To solve this problem the distribution boxes were developed, which are placed locally near the chambers
and serve as an intellectual interface collecting data from the boards through the USB and sending them to the
server computer by means of fast Ethernet.

At the same time power and trigger signals need to be delivered to the boards. Placing of the power supplies
and trigger distribution logic into the same box with the data interface allows to make the system most compact.
To achieve minimum cost most of the components used in the distribution box are just commercially available

blocks. The distribution box contents is illustrated in Fig. 8 and includes:

10

• standard Pentium based motherboard with USB, Ethernet LAN, parallel and serial controllers on it and

• regular PC power supply (PS) providing power to the motherboard and control circuits on the distribution

• two equally modiﬁed standard 300 W PC power supplies, capable of up to 25 A current on main low

• 3 USB hubs, 7 port each, allowing up to 25 USB connections together with 4 USB ports on the mother-

enabled ’LAN boot’ feature;

board;

board;

voltage supply lines;

• specially designed distribution board, performing the following functions:

– power distribution for up to 24 boards through RJ45 connectors;
– additional power ﬁltering and reverse voltage protection;
– conversion of the NIM system trigger signal to LVDS and its multiplication for individual boards;
– reception of the LVDS grand OR triggers from the proportional chambers, performing majority
coincidence function on them and conversion of the resulting signal to NIM for further use by the
fast system trigger logic;

– conditioning of the PS status signals and making them available for the motherboard through the

serial port modem lines;

– providing remote board power control (on/oﬀ) using another serial port line;
– programming of the fast Xilinx CPLD [7], which performs majority coincidence, by means of the

motherboard parallel port;

– visible LED indication of all power lines and trigger signals.

The distribution box is capable of serving up to 24 drift chamber boards, but only up to 16 proportional
chamber boards due to the current limit of the power supplies. The box is connected to the outer world by
means of only 4 cables:

• AC line cable;
• fast Ethernet cable;
• two coaxial cables, transferring NIM triggers to and from the box.
The box dimensions are 500 × 200 × 350 mm3 (W×H×D). The power consumption from the AC line strongly
depends on the number of boards connected to the box but does not exceed 400 W. Three power supply fans
provide suﬃcient cooling airﬂow inside the whole box.

6. Selected Test Results

Both types of boards and the whole DAQ system underwent a lot of various tests both on laboratory tabletop
and in real beam conditions. The detailed description of the test procedures is beyond the scope of this paper,
yet some of the test results would give a good illustration of the system performance.

The proportional boards were tested with 1 mm pitch 200×200 mm2 proportional chambers both with a
radioactive β-source and with proton beams of the ITEP synchrotron and of the PNPI cyclotron. Two gas
mixtures were tried: Ar(67%)CO2(33%) and Ar(75%)C4H10(24.7%)CF3Br(0.3%), so called ’magic mixture’.
Both variants showed excellent performance in various beam conditions, except that the ﬁrst gas mixture is
eﬃcient at potential plane voltages about 300 V higher than that for the ’magic mixture’.

The ﬁgures below illustrate the typical performance of the proportional system under the following condi-

tions:

• collimated β-source;
• chamber load 1 · 105 e/s;
• trigger rate 2.5 · 103 s−1;
• ’magic’ gas.

Figure 9 shows the eﬃciency of the chamber as a function of the applied high voltage at various discriminator
threshold settings. The maximum value is lower than 100% due to the relative geometry of the chamber and
the trigger scintillation counter. Yet a reliable plato of 100–200 V can be observed for all threshold values.

The distribution of the number of hits detected in the chamber for a given trigger is shown in Fig. 10a.
Some events in zero bin account for the geometrical ineﬃciency. Nearly 60% of particles produce exactly one
hit in the chamber. About 30% of the events give two hits, which is natural if charge division between adjacent
wires for inclined tracks is taken into account. Figure 10b is obtained at the same conditions and represents

11

Figure 9. Proportional chamber eﬃciency as a function of high voltage and discriminator threshold setting.

the proﬁle distribution of the source beam. Only one 100-channel board is active and the source is centered in
the half-plane, corresponding to this board. The leftmost 6 wires are insensitive by the chamber design.

1 mm pitch proportional chambers are considered to be diﬃcult to work with, compared to commonly used

2 mm ones. Yet the designed system shows excellent performance even in this case.

The drift chamber boards are more complicated in functionality. Their time measurement capability was
paid special attention to during the testing. One of the tests is brieﬂy described below. A random pulse derived
from a PMT noise was applied to one or several channel inputs, while the trigger was made of this signal by
delaying it on a ﬁxed cable line for a few hundred nanoseconds. The drift board essentially measures the time
between the signal and the trigger, so one would expect constant measured time for this test. The result of
this test is presented in Fig. 11. The signal and trigger arrival times are digitized independently, so it’s quite
natural that the measured diﬀerence is distributed between two adjacent bins. Monotonicity and linearity of
the conversion was also checked by changing the cable delay in 0.5 ns steps and recording the peak positions.

Most of the beam tests of the drift board were performed with a small prototype drift chamber with
hexagonal structure, which is designed in a form of a barrel. Cell diameter is 20 mm and 24 cells are arranged
into 4 sensitive planes, two of them shifted half cell diameter. Such design allows to perform best χ2 track
reconstruction like it is shown in Fig. 12.

Hits per trigger 12

310·

sparks12
sparks12
Entries   419738
Entries   419738
Mean  
Mean  
  1.442
  1.442
  1.086
RMS   
  1.086
RMS   

Hits distribution 12

prof12
prof12
Entries   611929
Entries   611929
  53.06
Mean  
  53.06
Mean  
  17.78
RMS   
  17.78
RMS   

250

200

150

100

50

0
0

14000

12000

10000

8000

6000

4000

2000

0

0

Eff = 0.954
1sp = 0.604

2

4

6

8

10

12

14

16

18

20

10

20

30

40

50

60

70

80

90

100

a)

b)

Figure 10. Number of hits per trigger in the proportional chamber (a) and β-source proﬁle distribution (b);
HV=3.5 kV, discriminator threshold is 25 mV.

12

time
time

Entries 
Entries 
Mean  
Mean  
RMS   
RMS   

 62958
 1339529
  69.62
  69.62
  0.355
  0.358

Drift time
310·

1200

1000

800

600

400

200

0
60

62

64

66

68

70

72

74

76

78

80

Figure 11. Time distribution for ﬁxed delay pulses, bin width is 1.74 ns.

Figure 12. 4-hit track in the barrel; circles denote the sensitive wire positions in 4 planes, crosses – hits on both
sides of the wire, squares – hits, selected for the track, vertical line – best χ2 straight track.

13

Looking at Fig. 13a which presents the number of hits per trigger in the barrel exposed to a focused beam
perpendicular to the sensitive planes, one can make conclusions on the chamber eﬃciency. About 67% of events
give exactly one hit in each plane, resulting in strong maximum at 4 hits per trigger. Small fraction of 5- and
6-hit events (about 20%) represents the cases, when in one or two planes charge division between adjacent cells
occurred. Number of 3-hit events is a real measure of a single plane ineﬃciency and the resulting number is
(1 − ε) =4.7%. Noticeable amount of zero-hit events can be accounted by the trigger quality as well as by
the eﬀect of the trigger window overlapping, which becomes not negligible at trigger rates as high as 105 s−1
and 1 µs window length. It’s worth mentioning that the eﬃciency picture remains essentially the same in wide
ranges of applied high voltages and discriminator threshold settings.

Figure 13b presents the distribution of the drift time in the cells with defocused perpendicular beam (nearly
ﬂat beam density over the cell size). Due to the 1/r dependence of the drift ﬁeld the distribution density
signiﬁcantly increases for small drift times, while the bump on the right side of the ﬁgure corresponds to the
very long drift times of the charges, produced in the area of zero ﬁeld close to the cell boundary. This distribution
can be used for building the drift function X(tDRIF T ) giving the hit spatial coordinate by the measured drift
time.

The ﬁnal goal of the tests of the drift chamber in conjunction with the designed electronic boards was
to understand the spatial accuracy of the whole system. The capability of the barrel for the straight track
reconstruction allows to perform the accuracy analysis. For 4-hit tracks the distribution of sums of deviations
squared should be a χ2 distribution with 2 degrees of freedom which has a form of exponential function. If
properly normalized, the exponent value gives the average hit deviation from the best straight track, i.e. the
coordinate accuracy of a single drift cell. Such a χ2 distribution together with its exponential ﬁt is presented

Drift time in the barrel

NHits
NHits
Entries   52305
Entries   52305
  4.202
Mean  
  4.202
Mean  
  1.233
RMS   
  1.233
RMS   

dtime
dtime

Entries 
Entries 
Mean  
Mean  
RMS   
RMS   
Underflow 
Underflow 
Overflow  
Overflow  

 209360
 209360
  167.7
  167.7
  106.4
  106.4
      0
      0
      0
      0

2

4

6

8

10

12

14

16

18

50

100

150

200

250

300

350

400

Figure 13. Number of hits per trigger (a) and drift time distribution (b) in the barrel.

12000

10000

8000

6000

4000

2000

0

0

b)

hi2
hi2

Entries 
Entries 
Overflow  
Overflow  
2c
2c
 / ndf 
 / ndf 
Constant 
Constant 
Sigma    
Sigma    

 18771
 18771
   1214
   1214
   831 / 48
   831 / 48
 50.7
 50.7
 0.00011
 0.00011

  3849 
  3849 

 0.02087 
 0.02087 

   NHits

35000

30000

25000

20000

15000

10000

5000

0
0

a)

Sum of delta^2

3500

3000

2500

2000

1500

1000

500

0
0

0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009

0.01

Figure 14. Spatial accuracy of the drift chamber prototype. Fit parameters:
’Constant’ – the normalization factor.

’Sigma’ – the exponent value,

–
–
–
–
14

in Fig. 14. The cell radius is taken for the coordinate measurement unit, so that the resulting exponent value
should be multiplied by 8.5 mm to get the cell accuracy (180 µm). The accuracy has only very weak dependence
on the high voltage on the potential wires (i.e. the gaseous ampliﬁcation) and on the discriminator threshold
setting, even in cases when the cell eﬃciency signiﬁcantly drops. This result is not completely understood
yet, since all the empirical considerations state that the accuracy should decrease when the signal amplitude
becomes smaller.

7. Conclusions

The data acquisition system for the proportional and drift chambers of the ’EPECUR’ experiment was designed,
tested and produced in ITEP in less than 2 years. Taking advantages of modern electronic technologies a really
cost eﬀective and compact DAQ system was build and showed excellent performance features. Tests with
chamber prototypes showed good eﬃciency even with 1 mm proportional chmabers and resulted in 180 µm
spatial accuracy in hexagonal drift cells.

The system is a keystone of the ’EPECUR’ experiment and the ’EPECUR’ team hopes that the fast progress

in the setup construction in spite of all diﬃculties will lead them soon to excellent physics results.

8. Acknowledgments

The authors express heartiest thanks to Dr. Nikolay Bondar’, the member of PNPI HEPD Radio Electronic
Department, for useful discussions on the chamber electronics.

’EPECUR’ project is carried out under the ﬁnancial support of the Russian Federal Agency on Atomic

Energy. The work is also partially supported by the Russian Fund for Basic Research grant 05-02-17005a.

Appendix.
Programming Reference

15

Proportional

and

Drift

Boards

Table A1. Proportional and drift boards USB endpoints and requests.

Endpoint 0x0/0x80: Standard control endpoint1 with added speciﬁc requests

RqType Request Value

0x40

0x20

X

Index
X

Length
0

0x40

0x22

X

0x40
0x40
0x40

0x40
0x40
0x40
0x40
0x40

0xC0

0xC0

0x21
0x22
0x22

0x22
0x22
0x22
0x23
0x24

0x20
0x21

0x22

0xC0
0xC0

0x23
0x24

X
data
X

X
X
X
X
data

X

X

X
X

X
0
1

2

X

X

3
4
5
0
addr

0
addr

len
0
0

0

0
0
0
16
0

1

4

16
1

–

Data
–

data[len]
–
–

Description
Generate PROG pulse to FPGA to start
conﬁguration
Load bitstream of ’len’ bytes to FPGA
Write low byte of ’data’ to threshold DAC
Enable dataﬂow from FPGA to USB End-
point 0x82
Disable dataﬂow from FPGA to USB End-
point 0x82
Generate a test pulse on the internal line
Generate a pulse on the test output
Send ’Packet End’ to USB Endpoint 0x82
data[16] Write 16 bytes of ’data’ to I2C EEPROM
Write low byte of ’data’ to FPGA register
#’addr’
Read FPGA DONE condition

done

–
–
–

–

data[4]

Read status
(data[1])
(data[2]&data[3], 10 bit left justiﬁed)

(data[0]), DAC setting
temperature2

board

and

data[16] Read 16 bytes from I2C EEPROM

data

Read byte from FPGA register #’addr’

Endpoint 0x82: Bulk endpoint (only IN direction)
Main data endpoint, for the dataﬂow structure see Table A2

Notes:

1. For USB standard and speciﬁc to CYPRESS µprocessor Endpoint 0x0/0x80 requests see [6] and [5].
2. Board temperature ﬁelds are only meaningful for the drift chamber board.

16

Table A2. Proportional board dataﬂow structure.

Byte# Bit7 Bit6

Bits[5:0]

Description

0

TRNUM1[12:7] Trigger signature and upper part of trigger number

0
1
2
. . .
n+2
n+3
n+4
n+5
. . .
. . .
m-1
m
. . .

1
0
0
0
0
1
0
0
0
. . .
1
0
. . .

0

TRNUM2[12:7] Trigger signature and upper part of next trigger number

TRNUM1[6:0]
CHNUM1[6:0]
. . .
CHNUMn[6:0]

TRNUM2[6:0]
CHNUM[6:0]
. . .
. . .

1

CYNUM[12:7]

CYNUM[6:0]
. . .

Lower part of trigger number
Number of ﬁrst channel hit in this trigger
Numbers of other channels hit in this trigger
Number of last channel hit in this trigger

Lower part of next trigger number
Number of ﬁrst channel hit in this trigger
Numbers of other channels hit in this trigger
Other trigger blocks in this cycle
Cycle signature and upper part of cycle number
Lower part of cycle number
Next cycle data

Byte# Bit7 Bit6

Table A3. Drift board dataﬂow structure.

1
0
0
1
0
0

1
0
0
1
0
0

0
0
0

Bits[5:0]
111111b
TRNUM1[5:0]
TRNUM1[11:6]
0 & CHNUM1[4:0]
TIME1[5:0]
TIME1[11:6]
. . .

0 & CHNUMn[4:0]
TIMEn[5:0]
TIMEn[11:6]
111111b
TRNUM2[5:0]
TRNUM2[11:6]

. . .
. . .

. . .

111111b
CYNUM[5:0]
CYNUM[11:6]

Description
Trigger signature
Lower part of trigger number
Upper part of trigger number
First hit channel number
Lower part of this channel time
Upper part of this channel time
Numbers and times of other channels hit in this trigger
Last hit channel number
Lower part of this channel time
Upper part of this channel time
Next trigger signature
Lower part of next trigger number
Upper part of next trigger number
Numbers and times of channels hit in this trigger
Other trigger blocks in this cycle
Cycle signature
Lower part of cycle number
Upper part of cycle number
Next cycle data

0
1
2
3
4
5
. . .
3n
3n+1
3n+2
3n+3
3n+4
3n+5
. . .
. . .
3k
3k+1
3k+2
. . .

1
0
0
0
0
0
0
0
0
0
1
0
0
0
. . .
1
0
0
. . .

17

Address Name
CSR0
0 RW
CSR1
1 RW

2 RW

CSR2

3 RW

CSR3

4 W

RST

Table A4. Proportional board FPGA 8 bit registers.

Fields and description
CSR0[7:0]=DLY[7:0] – The delay of the 100-bit digital delay line, CLK1 periods
CSR1[0]=DLY[8]
CSR1[3:1]=DTIM[2:0] – Channel dead time: TDEAD = 2 + DT IM ∗ 9 CLK periods
CSR1[5:4]=OLEN[1:0] – Channel output duration for putting to the digital delay line,
2OLEN CLK periods
CSR1[6] – Trigger source select: 0 – External from RJ45 connector; 1 – Internal, grand
OR of all channels OR generated by SFT TR
CSR1[7] – Enable data transfer to the µprocessor
CSR2[7:0]=TRGDLY[7:0] – Additional delay of the grand OR trigger to the output, CLK
periods; if TRGDLY=0, output is forbidden
CSR3[3:0]=TRGLEN[3:0] – Length of the grand OR trigger on the output, TRGLEN+1
CLK periods
CSR3[6:4] – Reserved
CSR3[7] – Enable accelerator cycle emulator (period 2.8 s, inhibit 0.35 s)
Various resets, selected by the written mask:
RST[0] – Reset all FIFOs
RST[1] – Trigger counter clear
RST[2] – Cycle counter clear
RST[7:3] – Reserved

SFT TR Writing of any number causes a trigger if enabled with CSR1[6]
CYNUM CYNUM[15:0] – Last cycle number
ORMSK ORMSK[99:0]2 – Bit mask inhibiting individual channel participation in the grand OR

5 W
4–5 R
6–18
RW
19–31
RW
INLVL[99:0]3 – Bit representation of logic levels on individual channel inputs
32–44 R INLVL
45 R
Always read 0
46–47 R TRNUM TRNUM[15:0] – Last trigger number

trigger output;
MASK[99:0]2 – Bit mask completely inhibiting individual channels

MASK

0

Notes:

1. CLK frequency is 96 MHz.
2. 4 most signiﬁcant bits are RW, but have no eﬀect.
3. 4 most signiﬁcant bits always read 0

18

Table A5. Drift board FPGA 8 bit registers.

Address
0 RW

Name
CSR0

1 RW

CSR1

2 RW

CSR2

3 RW

CSR3

Fields and description
CSR0[7:0]=WINBEG[7:0] – Trigger window start prior to the trigger,
CLK11 periods
CSR1[2:0]=WINBEG[10:8] – Trigger window start, upper part
CSR1[7:3]=WINLEN[4:0] – Trigger window length2, lower part, CLK11 periods
CSR2[4:0]=WINLEN[9:5] – Trigger window length, upper part
CSR2[7:5]=DTIM[2:0] – Channel dead time: TDEAD = 2 + DT IM ∗ 5 CLK23 periods
CSR3[0] – Trigger source select: 0 – External from RJ45 connector; 1 – Internal, from
the µprocessor
CSR3[2:1] – Power monitor select:0 - positive analog supply

lower part,

4 W

RST

1 - comparator digital supply
2 - FPGA core supply
3 - negative analog supply

CSR3[6:3] – Reserved
CSR3[7] – Enable data transfer to the µprocessor
Various resets, selected by the written mask:
RST[0] – Reset all FIFOs, emulate cycle end
RST[1] – Trigger counter clear
RST[2] – Cycle counter clear
RST[7:3] – Reserved
MASK[23:0] – Bit mask completely inhibiting individual channels
INLVL[23:0] – Bit representation of logic levels on individual channel inputs

5–7 RW
8–10 R
11 R
12–13 R
14–15 R

MASK
INLVL
PWMON Power monitor reading, selected by CSR3[2:1]
CYNUM CYNUM[15:0] – Last cycle number
TRNUM TRNUM[15:0] – Last trigger number

1. CLK1 frequency is 144 MHz.
2. The trigger window ends not later than the actual trigger comes, so that values greater than WINBEG

Notes:

are useless.

3. CLK2 frequency is 48 MHz.

Table A6. Proportional and drift board LED indicators.

Prop. Drift
D2
D53
D3
D54
D4
D60
D30 Yellow Heartbeating:
D56

Color
Description
Green +5V Analog power
Green
-5V Analog power
Green +3.3V Digital power

µprocessor

cycles

D57
D58

D59
D61

regularly ﬂashes when the application code is running in the

D31 Yellow Flashes on USB control endpoint requests
D32 Yellow Flashes on a trigger from any source accepted by the board, lights between accelerator

D33 Yellow Flashes on data transfers from FPGA to the µprocessor
Lights when the FPGA is not conﬁgured
D1

Red

19

Table A7. Proportional and drift board power and trigger connector pinout.

Pin# Description

1
2
3
4
5
6
7
8

LVDS trigger input
LVDS trigger input complimentary
Power +6 V
Power +4 V
Power −6 V
Power return ground
LVDS trigger output1
LVDS trigger output complimentary1

Notes:

1. In drift chamber boards the LVDS trigger outputs are always driven passive.
2. A standard UTP Ethernet cable can be used for the power and trigger connection.

References

[1] I.G. Alekseev et al. Search for the Cryptoexotic Member of the Baryon Antidecuplet 1/2+ in the Reactions

π−p → π−p and π−p → KΛ. Preprint ITEP 2-05; hep-ex/0509032.

[2] L.Z. Barabash et al. Methods and Results of Tuning the Universal Secondary Particle Channel of the

Reconstructed ITEP Proton Synchrotron. Preprint ITEP 115-1975.

[3] G.D. Alkhazov et al. Forward Spectrometer for Study of Low-lying Baryon Resonances. SPES4-π Experiment

at Saturne-II Accelerator (Saclay). Preprint PNPI 2352-EP-9-2000.

[4] Spartan-3 Complete Data Sheet. http://direct.xilinx.com/bvdocs/ publications/ds099.pdf.
[5] EZ-USB

http://download.cypress.com/

Microcontroller.

FX2LPTM

USB

published-content/publish/design resources/datasheets/con- tents/cy7c68013a 8.pdf.

[6] Universal Serial Bus Revision 2.0 Speciﬁcation.

http://www.usb.org/developers/docs/usb 20 05122006.zip.

[7] XC2C32A CoolRunner-II CPLD.

http://direct.xilinx.com/bvdocs/publications/ds310.pdf.

Ïîäïèñàíî ê ïå÷àòè 14.12.06.

Ôîðìàò 60õ90

1/16

Óñë.-ïå÷. ë. 1,5

Ó÷.-èçä. ë. 1,1

Òèðàæ 120 ýêç.

Çàêàç 21

Èíäåêñ 3649

Îòïå÷àòàíî â ÈÒÝÔ, 117218, Ìîñêâà, óë. Á. ×åðåìóøêèíñêàÿ, ä. 25

Èíäåêñ 3649

Ïðåïðèíò 21(cid:21)06, ÈÒÝÔ, 2006

