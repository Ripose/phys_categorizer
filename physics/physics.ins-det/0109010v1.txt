1
0
0
2
 
p
e
S
 
5
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
0
1
0
9
0
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

A High Granularity Imaging Calorimeter for
Cosmic-Ray Physics

M. Boezio ∗, V. Bonvicini, E. Mocchiutti 1, P. Schiavon,
G. Scian, A. Vacchi, G. Zampa, N. Zampa

INFN Section and Physics Department, University of Trieste, Via A. Valerio 2,
34127 Trieste, Italy

Submitted to Nuclear Instruments & Methods in
Physics Research

Abstract

An imaging calorimeter has been designed and is being built for the PAMELA
satellite-borne experiment. The physics goals of the experiment are the measurement
of the ﬂux of antiprotons, positrons and light isotopes in the cosmic radiation.

The calorimeter is designed to perform a precise measurement of the total energy
deposited, to reconstruct the spatial development of the showers (both in the lon-
gitudinal and in the transverse directions), and to measure the energy distribution
along the shower itself. From this information, the calorimeter will identify antipro-
tons from a electron background and positrons in a background of protons with an
eﬃciency of about 95% and a rejection power better than 10−4. Furthermore, a self-
trigger system has been implemented with the calorimeter that will be employed to
measure high-energy (from about 300 GeV to more than 1 TeV) electrons.

The instrument is composed of 22 layers of tungsten, each sandwiched between
two “views” of silicon strip detectors (X and Y). The signals are read out by a custom
VLSI front-end chip, the CR1.4P, speciﬁcally designed for the PAMELA calorimeter,
with a dynamic range of 7.14 pC or 1400 mip (minimum ionizing particle).

We report on the simulated performance and prototype design.

Key words: Calorimetry, Satellite instrumentation, Cosmic rays
PACS: 29.40.Vj, 95.55.Vj, 98.70.Sa

∗ Corresponding author. Tel.: +39-040-3756224; fax: +39-040-3756258

Email address: Mirko.Boezio@trieste.infn.it (M. Boezio).

1 Now at Royal Institute of Technology, Stockholm, Sweden

Preprint submitted to Elsevier Science

2 February 2008

1 Introduction: motivation for an Imaging Calorimeter in PAMELA

The PAMELA experiment is part of the Russian Italian Mission (RIM) pro-
gram, which foresees several space missions with diﬀerent scientiﬁc objectives.
Two missions have already been carried out. The ﬁrst one [1] studied the
anomalous light ﬂashes perceived by astronauts in orbit by employing silicon
detectors placed around the astronaut’s head and it was conducted on-board
the space station MIR (RIM-0 experiment). The other studied the low energy
isotopic composition of cosmic nuclei by means of the silicon telescope NINA
[2], carried by the Russian polar orbit satellite Resource-04 (RIM-1 exper-
iment). The NINA instrument was launched successfully from Bajkonur on
July 10th, 1998 and has collected a signiﬁcant amount of data [3].

The PAMELA [4] experiment (RIM-2 mission) has the scientiﬁc goal of mea-
suring the cosmic radiation over a wide energy range. The PAMELA apparatus
will be installed on board of a Russian satellite of the Resource series and will
be launched in early 2003. Its sun-synchronous, 600 km nearly polar orbit will
allow the low energy cosmic rays to be measured while the instrument is near
the poles. The main objectives of the experiment are the precise measurement
of the positron ﬂux from 50 MeV to 270 GeV and the antiproton ﬂux from
80 MeV to 190 GeV, as well as the search for anti-helium with a sensitivity of
10−7 in the He /He ratio. For further details see [4].

Fig. 1. The PAMELA telescope

2

PAMELA has a detector layout similar to the one used by the WiZard Col-
laboration in its balloon experiments [5]. The apparatus is composed of the
following subdetectors, arranged as in ﬁg. 1:

•

•

•

•

•

a plastic scintillator system that includes a time of ﬂight counter (TOF),
which provides energy loss, timing information and the trigger for the data
acquisition system, and an anti-coincidence system (ANTI), which identi-
ﬁes those particles entering the spectrometer from outside its geometrical
acceptance;
a Transition Radiation Detector (TRD), which provides a threshold velocity
measurement, complementing the calorimeter in the particle identiﬁcation;
a magnetic spectrometer (SPE), formed by a permanent magnet (supplying
a ﬁeld of 0.4 T) and a tracking system equipped with 6 layers of double-
sided silicon microstrip detectors for precise track reconstruction, capable
of determining the sign and the absolute value of the electric charge with
a very high conﬁdence level and measuring the momentum of the particles
up to the highest energies;
an electromagnetic imaging calorimeter (CAL), which measures the energy
released by the interacting electrons and positrons and reconstructs the
spatial development of the shower, allowing to distinguish electromagnetic
showers from hadronic showers and from non-interacting particles;
a plastic scintillator counter mounted under the calorimeter for triggering
of high energy (> 100 GeV) electrons.

The total height of the apparatus is 123.6 cm and the lateral dimensions of the
detectors have been determined in such a way to fully cover the acceptance
of the magnet spectrometer. Furthermore, a neutron counter is foreseen to be
installed in the payload along with the PAMELA apparatus and just below the
calorimeter. This additional detector will work together with the calorimeter
to measure very-high-energy electrons (see section 6).

The apparatus has been carefully designed taking into account the strict mass
(430 kg) and power consumption (350 W) limitations imposed by the satellite
environment as well as the need for mechanical stability to withstand the
vibration and shock loads occurring during the launch phase. In the following,
we present the prototype design and the simulated performance.

2 General characteristics of the calorimeter

The PAMELA Imaging Calorimeter is a sampling calorimeter made of silicon
sensor planes interleaved with plates of tungsten absorber. The application of
silicon detectors as active layers for sampling calorimeters is a well established
technique in experimental high-energy physics [6]. Among the advantages of

3

these detectors are excellent stability, linearity, eﬃciency, low-voltage opera-
tion. These features allow to extend their use also to cosmic-ray experiments
on satellites.

The instrument was designed aiming to a high segmentation, both in the lon-
gitudinal (Z) and in the transversal (X and Y) directions. In the Z direction,
the granularity is determined by the thickness of the layers of absorbing ma-
terial. Each tungsten layer has a thickness of 0.26 cm, which corresponds to
0.74 X0 (radiation lengths). Since there are 22 tungsten layers, the total depth
is 16.3 X0 (i.e. about 0.6 interaction lengths). The depth of the instrument is
not suﬃcient to fully contain high-energy electromagnetic showers. However,
the granularity, along with the energy resolution of the silicon detectors, allows
an accurate topological reconstruction of the shower development, making the
calorimeter a powerful particle identiﬁer, as conﬁrmed by simulation results
(see section 5). The transverse granularity is given by the segmentation of the
silicon detectors into strips. The silicon detectors for the PAMELA calorimeter
8 cm2 each), 380 µm thick and segmented into 32
are large area devices (8
large strips with a pitch of 2.4 mm. They are fabricated on high-purity, high-
resistivity (
cm), n-type silicon substrate. In order to avoid the use of a
conductive epoxy glue for gluing the detectors onto the printed circuit boards
(and therefore protecting the devices from the mechanical stress that this type
of glues can induce during polymerization), a special design allows bringing
the bias voltage directly on the junction side of the devices via wire bonding.

7kΩ
·

≥

×

Each tungsten plane is sandwiched between two layers of silicon detectors,
i.e. the layout of a single plane is Si-X/W/Si-Y. Either type of view (X or
Y) is made by nine silicon detectors, arranged in a square matrix of 3
3
24 cm2. Each of the 32 strips
detectors. The total sensitive area is about 24
of a detector is connected to those belonging to the other two detectors of the
same row (or column) forming 24 cm long strips. The number of electronics
channels per plane is 32
2 = 192 and the total number of channels is
22 = 4224.
192

×

×

×

×

3

×

3 Mechanical structure and assembly techniques

In order to be qualiﬁed for a space ﬂight, the mechanical structure of the
calorimeter (as for any other PAMELA sub-detector) must be able to with-
stand the vibrations and shocks occurring during the launch phase. Given the
above mentioned constraints on the available mass budget, the calorimeter
mechanics has been designed aiming at a robust and light structure, allowing
simple operations and easy access to the single planes. On the basis of care-
ful simulations, we chose a special, space-qualiﬁed aluminium alloy, since it
allowed to have a light, robust and cheap solution. The mechanical structure

4

was designed on the basis of a modular concept. The basic unit is called a
”detection plane”, and it consists of an absorber plate (made by a special sin-
tered tungsten alloy, 2.6 mm thick), two multi-layer printed circuit boards (for
X and Y views, supporting the silicon detectors and the front-end electron-
ics up to the ADC and called ”FE boards”) and the two matrices of silicon
sensors. Two such detection planes form a ”detection module”. In a module,
the two detection planes are kept together by special aluminium frames to
which they are bolted at the edge of the absorber plates. All modules are
independent and fully extractable; they are inserted like “drawers” into the
mainframe through precisely machined guides and then locked in place by a
cover (Fig. 2). As previously described, there are 22 tungsten plates in the

Fig. 2. Schematic of the calorimeter mechanical structure

calorimeter, which correspond to 11 modules. There is also a 12th module,
formed by two aluminium “dummy plates”, that has the sole purpose of sup-
porting the four read-out boards (see next section). The total calorimeter mass
is about 110 kg.

The interconnection and assembly technique for the detection planes has been
deﬁned and optimised through numerous tests 2 . The silicon detectors are
glued in rows of three on a specially designed, 50 µm thick kapton layer using
a siliconic glue. Then, the wire bonding of the corresponding strips on each

2 In
http://www.mipot.com/).

collaboration

with

the

ﬁrm

MIPOT

(Cormons,

Italy,

5

detector is performed. This realises a “ladder”. The wire bondings are then
coated by a deposition of a layer of siliconic glue. As a next step, the FE boards
are ﬁrst equipped with all electronic components by using an automatic placing
and soldering procedure, and then ﬁxed to the corresponding tungsten plates
by means of a silicon glue. Afterwards, three ladders are glued onto each FE
circuit board, again by using a special siliconic glue, to form the 3
3 silicon
detector matrix of either view. Finally, the wire bonding of the strips to the
preampliﬁers is performed. Fig. 3 shows a complete front-end board mounted
in a module.

×

Fig. 3. Front-end board.

4 Signal processing and data acquisition electronics

4.1 Front-end electronics

The front-end electronics is based on a VLSI ASIC speciﬁcally designed for
the PAMELA calorimeter: the CR1.4P [7]. The ﬁnal version of the chip was
attained after an R&D phase that went through the production and charac-
terisation of three diﬀerent prototypes. The use of an ASIC for processing
the analog signals from the silicon detectors allows considerable weight saving
and design compactness with respect to the discrete preampliﬁers previously
used in the calorimeters for balloon ﬂights [8]. The main design characteris-
tics of this chip, which is fabricated in a CMOS 2 µm mixed analog/digital
technology, are the wide dynamic range (1400 minimum ionising particles,

6

≃
≃

5.1 fC for 380 µm thick silicon detectors), the ability to cope with a
180 pF) detector capacitance, the good noise performance (ENC

1 mip
large (
≃
2700 e− rms + 5 e−/pF) and the low power consumption (6 mW/channel).
Fig. 4 shows the measured linear range in one channel of the chip. Over the

Fig. 4. Measured linear range in one channel of the CR1.4P chip.

full range, the maximum deviation from the ﬁtted line is < 2.5% and the aver-
age linearity is better than 1%. One circuit has 16 channels, each comprising
a charge sensitive preampliﬁer (CSA), a shaping ampliﬁer/ﬁlter, a track-and-
hold circuit and an output multiplexer. A self-trigger system and an input
calibration circuit are also integrated on chip. Fig. 5 shows the general archi-
tecture of a single channel. The CSA, based on a folded-cascode architecture,

integrates the charge from the silicon detector. An MOS transistor is used
in the feedback loop to reset the charge from the integrating capacitor. The
output of the CSA is fed into a CR-RC shaping ampliﬁer. The shaper peaking
time can be adjusted from about 800 ns to 1.2 µs by acting on the shaper bias
voltage and current. In such a way, the signal-to-noise ratio can be optimised
(within a certain range) for a speciﬁc application. In PAMELA, we use a
peaking time of 1.2 µs. A track-and-hold (T/H) circuit follows the shaper and
stores the peak value of the signal. The control of the T/H switch is done with a
diﬀerential signal. A multiplexer (MUX), formed by a 16-bit shift register that
controls an array of analog switches, connects one analog channel at a time
to the output stage. This is composed by an ampliﬁer with dc-biased output
and by an output buﬀer. Another shift register allows to apply a calibration

7

R B

VREF

R A

MUX

BUFFER

CSA

SHAPER

T/H

MUX

Fig. 5. Architecture of a single channel of the CR1.4P chip.

signal to any of the inputs (or any pattern of them) through a 2 pF injection
capacitor. Therefore, by performing periodic calibration runs, it is possible
to monitor the behaviour of the device and its stability after the launch and
during its operation in space.

The high energy resolution needed to identify minimum ionizing particles de-
mands a 16 bit analog to digital converter. Such ADCs are usually slow and
require careful board design to be able to exploit their full potential. For these
reasons it has been decided to place them as close as possible to the CR1.4P
chips on the FE board (a block scheme of which is depicted in Fig. 6). To
separate the data paths, thus minimizing the possible failure points, an ADC

CAL1

CAL2

CAL3

CAL4

CAL5

CAL6

CR1.4P

CR1.4P

CR1.4P

CR1.4P

CR1.4P

CR1.4P

ANALOG
MULTIPLEXER

−

+

BUFFER

ADC
16 bit

DATA

CLOCK

CONV

CONTROL
SIGNALS

PULSE
GENERATORS

INJECT

VCAL

HOUSE  KEEPING
CIRCUITRY

(currents, voltages,
temperature)

CAL1
CAL2
CAL3
CAL4
CAL5
CAL6

Fig. 6. Block scheme of the FE board.

8

converter with a serial interface (AD977A by Analog Devices Inc.) has been
chosen. Among the available ADC’s voltage ranges, the most suited one is the
6.66V, which maximizes the energy resolution at an acceptable dynamic range
loss of about 18% (1150 mip instead of 1400 mip). The six CR1.4P are con-
nected to the ADC through an 8:1 multiplexer and a unity-gain buﬀer which
drives the relatively low input impedance of the converter (about 5 KΩ). The
two other inputs of the multiplexer can be advantageously used to acquire
some useful electrical quantities (so-called House Keepings, HK) that allow to
monitor the functionality of the calorimeter. The ﬁrst of this channels mea-
sures the current of the detector’s active area, while the other is connected
to one of the other signals (temperature, calibration voltage, analog supply
voltages). Each FE board has a sensor which provides an alarm when the
temperature rises above a given threshold: its output is open collector, so that
several alarms can be combined to simplify the circuitry. Then the alarms
are fed to the CPU where appropriate actions can be taken. The interface to
the read-out has been realized through digital signals arranged into an input
control bus, connected in parallel to all the FE boards, and the ADC’s out-
put signals (data and clock). A 10 KΩ resistor has been placed in series at
each input to limit the bus load in the event of a component’s failure that
would otherwise block the FE controls. A 22 pF capacitor is connected in par-
allel to these resistors to pass the signal edges. The same circuitry has been
implemented on the CR1.4P control bus.

4.2 Read-out electronics

The tasks of the read-out electronics are to collect and analyse the data prior
to their transmission to the main CPU. Four read-out boards are housed in
the 12th, and last, “dummy” calorimeter module.

The read-out boards are connected to the front-end electronics by means of
four bus boards: this solution exploits the mechanical design to divide the
calorimeter into four independent sections (odd X-views, odd Y-views, even
X-views and even Y-views), each one read out by one board. Each read-out
board consists of a micro-controller dedicated to the “slow control” of the
calorimeter, an ADSP2181 (Analog Devices Inc.) which controls the acquisi-
tion sequence and elaborates the data, and an FPGA to parallelise the ADC
data and generate some of the control signals.

Inside the FPGA a pipeline memory has been realized. It consists of several
shift registers that parallelise the ADC data (“horizontal shift”) connected
together to form a second level shifter which brings the data to the DSP
(“vertical shift”). The shifting direction is selected by the DSP: horizontal
during conversion, vertical otherwise. To account for a possible loss of perfor-

9

mance of the ADC due to radiation eﬀects, the Least Signiﬁcant Bit (LSB) of
the conversion is discharged.

The micro-controller is connected to the main CPU via a low speed serial link
and its tasks are to bootstrap the DSP, control its activity by means of a
“watchdog” mechanism, and monitor the temperature alarms. It is connected
to the DSP through the IDMA port to have access to its internal memory,
providing also a backup solution to read the event data in case of a failure in
the fast DSP link. As soon as a trigger signal is received, the DSP starts the
acquisition procedure enabling the ﬁrst channel of the CR1.4P chips, selecting
the appropriate multiplexer channel and starting a conversion. The sequence
does not rely on the ADCs busy signals, instead the DSP program has been
designed to perform some calculations during the conversion time.

At the end of a conversion, the processor reads the data coming from the
eleven FE boards, selects the next channel to acquire, and starts a new con-
version. Waiting for the ADC to ﬁnish its task, the DSP proceeds comparing
the new data with the thresholds of the various channels in order to perform a
zero suppression, thus reducing the amount of memory occupied by an event.
Every value that exceeds the threshold is recorded together with the address
of the channel. In the same process, the DSP calculates also the classiﬁcation
variables used by the main CPU of PAMELA to sort the events according to a
pre-deﬁned priority: these variables are the number of strips above threshold,
the number of clusters, i.e. contiguous strips with a signal, and the amount of
energy detected in the FE board. The threshold is determined by the pedestal
value of the channel (the output of the preampliﬁer with a zero input signal)
and its noise measured during the calibration of the calorimeter. Every data
to be transmitted to the central memory is written on a buﬀer: an interrupt-
driven process periodically checks this buﬀer and sends any new data to the
DSP’s serial link connected with the mass memory system. Merging the frame
synchronizer, which provides the start bit, to the data line converts this syn-
chronous link to an asynchronous one, allowing us to avoid the transmission
of a clock signal. The DSP also formats the event data packet adding a header
and a trailer: the ﬁrst is a word that speciﬁes the type of acquisition (com-
pressed event, full event or calibration) while the last includes the number of
words in the packet and a checksum. A full event acquisition is provided for
test purposes, in this mode the program does not perform the zero suppres-
sion and sends all the data without the channel addresses. The calibration of
the calorimeter is done acquiring pedestals (1024 events) and injecting two
diﬀerent charges in the preampliﬁer’s channels (128 events for each signal) to
measure the gain in two points of the dynamic range (20% and 80%). The
statistic is suﬃcient to measure with good accuracy these important data and
also allows the determination of the system noise (the RMS of the pedestal
distributions).

10

The connection between the calorimeter and the main CPU/mass memory is
based on TIA/EIA-485 diﬀerential lines whose transceivers are located on the
bus boards.

5 Simulation

Similar silicon-tungsten calorimeters, diﬀering only in layout and number of ra-
diation lengths, were developed and extensively studied by our group through
simulations, beam tests [9,10] and balloon ﬂights [11–13]. The simulated data
were compared with experimental data ﬁnding excellent agreement [9,10,13].

From these simulations, a Monte Carlo program based on the CERN GEANT-
/FLUKA-3.21 code [14] was developed to study the capability of the PAMELA
calorimeter. In particular, it was studied the performance of the calorimeter
concerning the primary scientiﬁc goals of the PAMELA experiment, that is
energy reconstruction for electrons and identiﬁcation of positrons and antipro-
tons in a vast background of protons and electrons, respectively.

Figure 7 shows the simulation of the total detected energy (expressed in mip
units) in the calorimeter for electrons at several energies. The response of

Fig. 7. Reconstructed energy as a function of input energy for simulated electrons
in the PAMELA conﬁguration. The solid line is a linear ﬁt to the ﬁrst four points.

11

the calorimeter, in this energy range, shows a quasi-linear behaviour with
deviations accounting for the partial containment at the highest energies. The
solid line is a linear ﬁt to the simulated data points below 100 GeV. Figure 8
shows the energy resolution for electrons. The resolution reaches a constant
value above 20 GeV of about 5%.

Fig. 8. Energy resolution as a function of input energy for simulated electrons in
the PAMELA conﬁguration.

In a cosmic-ray experiment like PAMELA, the proton background accounts
for about 103 times the positron component at 1 GeV, increasing with energy
to more than 104 above 10 GeV. Electrons are about 102 more abundant than
antiprotons at 1 GeV, decreasing with energy but still being about 30 times
more at 10 GeV. For this reason powerful particle identiﬁers are needed. The
PAMELA calorimeter is well suited to identify these particles in the cosmic
radiation.

The longitudinal and transverse segmentation of the calorimeter combined
with the measurement of the energy lost by the particle in each silicon strip
results in a high identiﬁcation power for electromagnetic showers. Thus, the
calorimeter, in the electron and positron analysis, is used to identify electro-
magnetic showers, while in the antiproton analysis the calorimeter is used to
reject these events.

Selection criteria were developed based on the following information of the

12

electromagnetic showers [10]:

(1) the starting point of the shower;
(2) the energy-momentum match;
(3) the longitudinal proﬁle;
(4) the transverse proﬁle;
(5) the topological development of the shower.

The eﬃciency and contamination of the selections were studied simulating a
large number of electrons (electrons and positrons were assumed to be equiv-
alent at the energy of interest here), antiprotons and protons.

Figure 9 shows a quantity related to the topological development of the shower

Fig. 9. The topological development of the shower. The ﬁgure shows the sum of
the number of hits inside 2 Moli`ere units around the track multiplied by the corre-
sponding calorimeter plane number for simulated 100 GeV/c (a) electrons and (b)
protons.

in the calorimeter for simulated 100 GeV/c (a) electrons and (b) protons . This
quantity is the product of the sum of the number of hits inside a cylinder,
of radius about 2 Moli`ere units (8.5 calorimeter strips) with its axis along
the particle direction, and the corresponding calorimeter plane number. The
direction of the particle in the calorimeter was assumed known since in the
PAMELA experiment it will be obtained from an extrapolation of the ﬁtted
track in the tracking system.

13

Table 1
Simulated performances: eﬃciencies in antiproton and electron detection versus elec-
tron and proton contamination, respectively.

Momentum

e−

p

(GeV/c)

eﬃciency

contamination

eﬃciency

contamination

0.9192

0.0009

(2.5

0.2)

10−3

0.899

0.001

1

5

20

100

200

0.9588

0.0005

0.9767

0.0004

0.963

0.954

0.001

0.002

±
(4+5
−2)
< 6.2

< 1.4

< 1.5

×
10−5
10−5
10−4
10−4

×

×

×

0.9533

0.0009

0.970

0.944

0.955

0.001

0.002

0.002

10−4
×
10−5

0.4)

(1.9
±
(1.4+1.8
−0.9)
(3+2
−1)
< 3.3

×

×

< 1.2

×
10−5
10−5
10−4

×
×
Table 1 shows the resulting values for various momenta spanning the range of
interest for PAMELA.

±

±

e+

±

±

±

±

p

±

±

±

±

6 Self-triggering calorimeter

A self-trigger system using the PAMELA imaging calorimeter was imple-
mented to measure high-energy (from
300 GeV to more than 1 TeV) elec-
≃
trons in the cosmic radiation. Till now very few measurements have covered
this energy range [15]. Since these events are quite rare in comparison with the
normal event rate of PAMELA, it is important to have a large geometric fac-
tor in order to collect a reasonable statistics during the three year estimated
lifetime of the mission. Requiring only that the particles enter from one of
the ﬁrst four planes and cross at least 10 radiation lengths in the calorimeter,
600 cm2sr) becomes about a factor 30 larger than
the overall acceptance (
the normal acceptance of PAMELA. For this reasons the CR1.4P front-end
chip was designed to work not only with an external trigger signal (“normal”
operation mode), but was also provided with a “self-trigger” option.

∼

Figure 10 shows a simpliﬁed block scheme of the self-trigger circuit. The
output of each preampliﬁer is transformed into a current by a voltage-to-
current converter (V/I1 1,...V/I1 16). The output current of these stages is
then summed and changed back to a voltage signal (across the 330 kΩ resis-
tor). Another voltage-to-current converter (V/I2) is used to reach the desired
22 mV/mip). A comparator gives a binary output signal if the sum
gain (
of the signals in a chip exceeds a given threshold. This kind of circuit, though
performing well within its operational capabilities, has nonetheless some lim-
itations, which are inherent in its architecture:

≃

There is a minimum usable threshold (about 30 mip).
The time delay TD from the injection of the input charge and the trig-

•
•

14

INPUT 1

1I

CSA1

shaper1

to following stages
U1

INPUT 16

16I

CSA16

shaper16

to following stages

U16

V/I1_1

4 pF

250 k

Ω

gnd

4 pF

250 k

Ω

gnd

V/I1_16

V/I2

outself

comp.

330 k

Ω

vss

300 k

Ω

vss

treshold

Fig. 10. Simpliﬁed block scheme of the self-trigger circuit in a CR1.4P chip.

ger output signal (comparator output) depends on the amount of injected
charge (see Figure 11) and on the selected comparator threshold.
Due to saturation of V/I2 output, there is an upper limit to the usable
threshold (about 300 mip).

•

The delay time is an important feature of the chip since a precise reconstruction
of the energy losses requires that the charge released in each channel is read
out at a sampling time no more than 100 ns diﬀerent from the peaking time.
Figure 11 shows the delay time as a function of injected charge for three dif-
ferent chips with a 150 mip threshold. A strong dependence of the delay time
on the input charge was found for low injected charge values, however above
about 1000 mip the delay time is essentially constant. This means that in case
of high energy losses (as it happens around the maximum of showers induced
by high energy electrons) a precise sampling of the energy is achievable. It is
worth noticing the small diﬀerences, less than 20 ns, between the delay times
of the three chips.

It was found that the delay time depends also on the number of channels in
which the charge is injected. Figure 12 shows the delay time as a function of
the total charge for a 150 mip threshold when the charge is injected in just
one, or split in two and four channels (the behaviour of the delay time for a
larger number of channels coincides with the four channel case). The maxi-
mum value of the injected charge in each single channel was about 2000 mip. It
can be noticed that the asymptotic value varies with number of channels and
it diﬀers by about 50 ns between two and four injected channels. Furthermore,
along with a dependence on the number of injected channels it was found a
dependence of the delay time on how the charge was distributed among the
channels. Because of these eﬀects, the variation of the delay time was mea-

15

Fig. 11. Dependence of the self-trigger signal delay TD on the input charge for a
comparator threshold of 150 mip and for three diﬀerent chips.

sured injecting charge in the channels of the chip according to the simulated
distribution for electrons with energies greater than 300 GeV. The best ﬁt of
these data is indicated with a solid line in Figure 12.

As it can be seen from Figure 12, the delay time depends on how the injected
charge is distributed among the channels but the diﬀerences are of the order
of 50 ns. Moreover, the behaviour of diﬀerent CR chips is very similar (see
Figure 11), within only a few ns. These facts were exploited to deﬁne the
self-trigger logic. It is worth pointing out that the trigger logic was designed
to reject protons while keeping as large a fraction as possible of high energy
electrons. It is essential to minimize the trigger rate due to protons, in order not
to signiﬁcantly aﬀect the normal PAMELA operation. Moreover, the problem
of the quantity of mass memory occupied by the events acquired in self-trigger
mode has to be taken into account. Hence, a good event selection already at
the trigger level is very important.

For these reasons we imposed a threshold of 150 mip on a deﬁned set of
planes and we required that the trigger output from these planes occurred
within a given time window. Of course, the duration of this time window was
determined on one hand by the desired sensitivity at low energies (i.e., 300
GeV) and on the other hand by the spread in the threshold curves. In fact,
it is clear that the duration of this coincidence should be large enough to

16

Fig. 12. Delay time as a function of total injected charge for a comparator threshold
of 150 mip. The charge is injected in one (open circles), two (full boxes) and four
(open boxes) channels. The solid line is obtained injecting charge in the channels of
the chip according to the simulated distribution for high energy electrons.

include all trigger outputs (due to electromagnetic showers) from all the chips
involved.

As said above, the behaviour of the calorimeter in self-trigger mode was studied
using simulations. First of all, we studied the longitudinal development of the
electromagnetic shower to determine the detected energy in each preampliﬁer
of every plane of the calorimeter. Figure 13 shows the average detected energy,
with the corresponding rms, as a function of the longitudinal depth for the X
views (the picture for the Y views is similar, just shifted by one plane). The
ﬁgure shows only the energy detected in the preampliﬁer reading the highest
energy loss in the plane. This preampliﬁer is the ﬁrst to give an output trigger
pulse. From the ﬁgure it can be seen that, after plane 6, more than 90% of
the electrons give an energy loss greater than 150 mip (solid line). From this
result we derived that the best trigger conﬁguration is a logic AND between
the 6 planes: 7X, 9X, 11X, 13X, 15X, 17X; 7Y, 9Y, 11Y, 13Y, 15Y, 17Y; 8X,
10X, 12X, 14X, 16X, 18X; 8Y, 10Y, 12Y, 14Y, 16Y, 18Y. The required AND
is actually a coincidence within a time window of 100 ns.

With this conﬁguration, we simulated electrons from 300 GeV to 1 TeV and
protons impinging also from all sides for energies from 1 GeV to 1 TeV. The

17

]
p
i
m

[
 
y
g
r
e
n
E
 
e
g
a
r
e
v
A

Fig. 13. Average energy detected in the preampliﬁer reading the highest energy loss
per plane (X views). The solid line indicates the 150 mip threshold.

X-plane

self-trigger response was simulated identifying the preampliﬁer with the high-
est detected energy in each plane, requiring that this energy was greater than
150 mip, converting this energy to a time TD using the curve of Figure 12
and ﬁnally requiring that these six TD coincided within 100 ns. We found
that (99.6
0.2)% of the simulated electrons satisﬁed the trigger conditions.
To estimate the proton contamination we took into account an experimental
proton energy spectrum [16], the acceptance of the calorimeter (protons im-
pinging from all sides) and the fraction of simulated protons which passed the
trigger conditions. From this calculation we estimated a trigger frequency due
to protons of about 10 mHz, which is 2 orders of magnitude lower than the
expected normal PAMELA acquisition rate.

±

Considering that the calorimeter in self-trigger condition will work as a stand
alone detector, in combination with a neutron detector, it will have to identify
electrons in a vast background of other particles (mostly protons) and recon-
struct their energy. This was studied with simulations and is detailed in the
next sections.

18

6.1 Direction reconstruction

For a precise determination of the electron energy a good reconstruction of
the electron trajectory is needed. Furthermore, this allows to determine the
amount of material, present around the calorimeter, traversed by the electron
before entering the detector.

A method based on the centre of gravity of the energy losses in each plane
for both view was used to reconstruct the direction. However, it was found
that the simple ﬁt of the centres of gravity gave biased results for those elec-
trons having large values of the zenith angle. The reconstructed zenith angles
resulted systematically shifted with respect to the input ones by an amount
increasing with the input zenith angle. This can be seen in Figure 14 that
shows the lateral proﬁle averaged over 4000 electrons of 300 GeV and input

p
i
m

p
i
m

Fig. 14. Average lateral proﬁle of electromagnetic showers induced by 300 GeV
electrons impinging with a zenith inclination of 35◦. From left to right and from top
to bottom the lateral proﬁle at the third, ﬁfth, 10th and 22nd calorimeter plane (X
views).

incidence angle of 35◦. The impact point on the ﬁrst plane was the same for

p
i
m

p
i
m

19

all the 4000 electrons. The ﬁgure shows the proﬁle at the third, ﬁfth, 10th and
22nd calorimeter plane. The shower maximum was located close to the 10th
plane. It can be observed that, except for the 10th plane, the distributions are
not symmetrical and, consequently, the centre of gravity does not provide the
correct position of the maximum that is located along the electron trajectory.
This asymmetry is due to two eﬀects:

1. for an inclined shower the secondary particles traverse asymmetric amounts
of materials;
2. the transverse sampling is not orthogonal to the axis of inclined shower.

The second, geometrical, eﬀect is more important. These eﬀects were studied
and a relation was found between the displacements of the centres of gravity
from the shower axis and the incidence angle. A smaller dependence on the
energy of the incident electron was also found and it was introduced as a
second order correction. Consequently an iterative procedure was developed
to correct for this bias:

1. A ﬁrst estimation of the angles θzx and θzy was obtained ﬁtting with a
straight line the centres of gravity of the detected energy in each plane
around one Moli`ere radius (4 strips) of the cluster of three strips with the
highest energy loss. For the ﬁt, the centres of gravity were weighted with
the traversal energy loss (Etr), i.e.:

σ(xi) =

xi
E0.79
tr

,

with σ(xi) the error used for the centre of gravity (x) of the i plane (i =
1, . . . , 22).
2. A new set of centres of gravity was calculated using the detected energy
inside one Moli`ere radius along the ﬁtted trajectory.
3. Then, these centres of gravity were modiﬁed using the functional depen-
dence on the direction and the initial energy previously determined. For this
correction the trajectory and initial energy (see next section) evaluated at
point 1 were used.
4. A new straight line ﬁt was performed using these modiﬁed centres of
gravity.
5. The procedure was reiterated back from point 2 until the reconstructed
angles varied less than 1 mrad from two consequent iterations.

This method permitted to reconstruct the trajectory angle from 0 to about
60◦ degrees with a resolution better than 3 mrad. Figure 15 shows the relative
angular resolution as a function of input zenith angle for two electron ener-
) and 1000 GeV (2). The two lines are best ﬁts of the data
gies: 300 GeV (
•

20

Fig. 15. Relative angular resolution as a function of input zenith angle for two
electron energies: 300 GeV (
). The two lines are best ﬁts of the
) and 1000 GeV (
◦
•
data according to equation 1.

according to equation:

σ(θ)
θ

=

a
√θ −

b,

(1)

where a = 0.29
a = 0.183

0.01 and b = (0.67
0.04)

0.009 and b = (0.45

±

0.06)
±
10−2 at 1000 GeV.
·

·

±

±

10−2 at 300 GeV and with

The diﬀerence between the reconstructed angle and the input zenith angle is
shown in Figure 16 as a function of zenith angle for 300 GeV electrons.

6.2 Energy reconstruction

A large fraction of the energy of electromagnetic showers induced by high
energy electrons (above 100 GeV) leaks out the PAMELA calorimeter. This
limits the energy reconstruction and resolution. Hence, for the energy recon-
struction in self-trigger mode we used the following procedure. We identiﬁed
the plane with the maximum detected energy and summed all the detected
energies up to three planes after this one. In fact, up to energies of the order

21

Fig. 16. Diﬀerence between the reconstructed angle and the input zenith angle as a
function of zenith angle for 300 GeV electrons.

of one TeV the maximum of the shower is well contained into the calorimeter
also in the self-trigger geometry. Then we related this energy with the input
energy in GeV as it is shown in Figure 17 (open circles). The ﬁgure shows
that a linear relation exist up to at least about 1 TeV. The energy resolution
obtained with this method is shown in Figure 18 (solid circles).

However, the calorimeter, along with a longitudinal measurement of the en-
ergy loss, provides information on the lateral energy. This was used to improve
the energy resolution. In fact, we determined a relation between the energy
detected up to the third plane after the one of maximum energy loss and the
amount of matter traversed, obtained from the trajectory reconstruction, and
we used it to correct the detected energy. This relation was found to be depen-
dent on the incident energy and hence, an iterative procedure was used. This
procedure was embedded into the angular reconstruction described in the pre-
vious section, hence the method was reconstructing both the direction and the
energy of the incoming electron. The results from this method are presented
in Figure 17 (solid circles), the error bars are one sigma errors derived from
the energy distribution. It can be noticed that this method provides a more
precise measurement of the primary energy.

Furthermore, the energy resolution improves as can be seen in Figure 18.
12% up to about 800 GeV. At higher
The energy resolution is constant at

≃

22

c
e
r

in

Fig. 17. Reconstructed energy as a function of input energy for the calorimeter in
self-trigger conﬁguration. The solid line is the identical function. The open circles
indicate the total energies detected up to three planes after the maximum. The solid
circles are the total energies corrected for the amount of matter traversed.

energies the resolution decreases because of increasing longitudinal leakage and
decrease of information on the energy loss due to saturation of the signal from
the strips (
1100 mip). The resolution was ﬁtted by the following function
∼
(solid line in Figure 18):

σ(E)
E

= p1 + p2

e− p3
E ,

·

(2)

with E kinetic energy in GeV and p1 = (11.9
p3 = (5.7

103.

0.4)

±

×

0.1)

10−2, p2 = 7.6

3.1 and

±

±

×

Compared to the energy resolution of the calorimeter in the PAMELA normal
trigger mode, the resolution for the self-trigger conﬁguration is worse, about
12% instead of about 5% at 200 GeV (see section 5). This worsening is due
to the diﬀerent acceptance condition. In the PAMELA normal conﬁguration,
events impinge nearly orthogonal to the ﬁrst plane of the calorimeter while in
the self-trigger conﬁguration particles are accepted with zenith angles as large
as 60◦ degrees and are allowed to enter also from the side as long as they cross
at least the fourth plane.

23

in

Fig. 18. Energy resolution as a function of input energy for the energy reconstructed
) the total energies detected up to three planes after the maximum and
using: (
◦
(
) the total energies corrected for the amount of matter traversed. Self-trigger
•
conﬁguration.

Figure 19 shows the distributions of the reconstructed energy for three mono-
chromatic electron samples at 300 GeV (solid histogram), 700 GeV (dashed
histogram) and 900 GeV (dotted histogram). The distributions can be ﬁtted
by Gaussian functions which sigmas provide the energy resolution.

6.3 Particle identiﬁcation

In the self-trigger conﬁguration the calorimeter will have to reconstruct the
energy of the high energy electrons but also identify them in a vast background
of protons and heavier particles. Particle identiﬁcation was also studied us-
ing simulations. A large number of electrons with energies between 300 and
1000 GeV and protons with energies from 300 GeV to 3.3 TeV were simulated.
The electrons were simulated with the acceptance of the self-trigger conﬁgu-
ration, while protons were allowed to impinge the calorimeter also from the
lateral sides. The electron selection criteria were based on the features of the
electromagnetic showers, as described in section 5, however without energy-
momentum match, since the calorimeter will work in stand-alone conﬁgura-
tion.

24

s
t
n
e
v
e
 
f
o
 
r
e
b
m
u
N

Fig. 19. Distribution of the reconstructed energy for three monochromatic electron
samples at 300 GeV (solid histogram), 700 GeV (dashed histogram) and 900 GeV
(dotted histogram).

rec

±

The selection eﬃciency for electrons was found to be (74.7
0.7)% independent
on the energy of the incident electron. The proton contamination was found
0.02)% resulting in an proton rejection factor of about 500.
to be (0.15
Considering the relative abundances of protons and electrons in the cosmic
radiation, the estimated contamination ﬂux of protons is of the same order of
the electron ﬂux. However, it is worth reminding that the calorimeter in self-
trigger conﬁguration will work with a neutron counter device that is expected
to provide a proton rejection factor of about 1000.

±

7 Conclusion

The imaging calorimeter for PAMELA has been designed and is presently un-
der construction. Laboratory tests and simulations show that the instrument
can fulﬁl all design requirements for PAMELA.

25

Acknowledgements

We would like to thank Aerostudi Trieste (http://www.aerostudi.it/) for help-
ing us designing and constructing the mechanics of the calorimeter. We wish
to thank Dennis Matveev and Alexandre Pilyar for the help on designing the
electronics and Luigi Vecchiet of Mipot Cormons for technical support on the
assembly of the detectors.

References

[1] V. Bidoli et al., Advances in Space Research 25 (2000) 2075.

[2] A. Bakaldin et al., Astropart. Phys. 8 (1997) 109.

[3] V. Bidoli et al., Astrophys. J. Suppl. 132 (2001) 365, astro-ph/0012286.

[4] V. Bonvicini et al, Nucl. Instrum. and Meth. A461 (2001) 262.

[5] M. Ambriola et al., Nucl. Phys. (Proc. Suppl.) B 78 (1999) 32.

[6] P. G. Penzotti et al., Nucl. Instr. and Meth. A265 (1988) 266.

[7] J. H. Adams et al., Proc. 26th Int. Cosmic Ray Conf., Salt Lake City, 5 (1999)

[8] M. Bocciolini et al., Nucl. Instr. and Meth. A370 (1996) 403.

[9] M. Bocciolini et al., Nucl. Instr. and Meth. A333 (1993) 560.

[10] M. Boezio, Ph.D. thesis Royal Institute of Technology, Stockholm, (1998)

http://msia02.msi.se/group docs/astro/research/references.html

[11] R. Golden et al., Astrophys. J. 457 (1996) L103

[12] M. Boezio et al., Astrophys. J. 487 (1997) 415.

[13] M. Boezio et al., Astrophys. J. 532 (2000) 653.

[14] R. Brun et al, Detector Description and Simulation Tool, CERN program library

[15] T. Kobayashi et al., Proc. 26th Int. Cosmic Ray Conf., Salt Lake City, 3 (1999)

[16] M. Boezio et al., Astrophys. J. 518 (1999) 457.

69.

61.

26

