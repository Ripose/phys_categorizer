4
0
0
2
 
n
u
J
 
2
2
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
8
9
0
6
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

An automated and versatile ultra-low temperature SQUID magnetometer

A. Morello, W. G. J. Angenent, G. Frossati, and L. J. de Jongh∗
Kamerlingh Onnes Laboratory, Leiden Institute of Physics,
Leiden University, P.O. Box 9504, NL-2300 RA Leiden
(Dated: February 2, 2008)

We present the design and construction of a SQUID-based magnetometer for operation down to
temperatures T ≃ 10 mK, while retaining the compatibility with the sample holders typically used
in commercial SQUID magnetometers. The system is based on a dc-SQUID coupled to a second-
order gradiometer. The sample is placed inside the plastic mixing chamber of a dilution refrigerator
and is thermalized directly by the 3He ﬂow. The movement though the pickup coils is obtained by
lifting the whole dilution refrigerator insert. A home-developed software provides full automation
and an easy user interface.

I.

INTRODUCTION

which constitutes an obvious advantage.

The use of Superconducting QUantum Interference De-
vices (SQUIDs) [1] in ultra-sensitive magnetic measure-
ments systems may nowadays be considered as a standard
technique, to the extent that several companies oﬀer reli-
able and automated commercial SQUID magnetometers.
However, no commercial magnetometer has yet become
available for operation at millikelvin temperatures utiliz-
ing a dilution refrigerator. A few systems have been con-
structed that combine the sensitivity of SQUID magne-
tometery with the millikelvin temperature range attain-
able by means of 3He/4He dilution refrigerators [2, 3, 4],
at the cost of requiring the sample to be mounted on ded-
icated sample holders, which ensure the thermalization to
the cold plate of the refrigerator by means of conducting
thermal links.

We describe here a SQUID magnetometer designed to
allow high-sensitivity measurements down to T ∼ 10
mK, while retaining the compatibility with the sample
holders used in commercial magnetometers. Moreover,
we wanted to avoid building a system dedicated exclu-
sively to SQUID magnetometery. Our setup can accom-
modate several diﬀerent experimental probes, e.g.
for
nuclear magnetic resonance [5], inductance-bridge-based
ac-susceptometery [6] and resistivity measurements. Fi-
nally, we wrote a software that fully automates the sys-
tem and oﬀers a very user-friendly interface to program
the measurement sequences and analyze the data.

An example of research for which our setup was partic-
ularly designed is the ﬁeld of metallic nanoclusters, which
show spectacular quantum-size eﬀects in their thermody-
namic properties [7] at very low temperatures, as a con-
sequence of which their magnetic susceptibility is very
small in this regime. Furthermore, since most of these
materials are highly air-sensitive, it is a necessity to in-
troduce and keep the sample in a sealed glass tube, that
allows at the same time to perform preliminary measure-
ments at T > 1.8 K in commercial SQUID magnetome-
ters and pre-check the quality of the sample in a fast and
cheap way. The sample, in its sample holder, can there-
upon be inserted in the ultra-low temperature SQUID
magnetometer without need of any further manipulation,

The really challenging part of the design consists in the
fact that, like in most commercial and non-commercial
[8, 9] magnetometers, to obtain the absolute value of the
magnetization we need to move the sample through a
gradiometer pick-up coil, but in our case the sample is
at T ≥ 10 mK inside the mixing chamber of the dilution
refrigerator! The sample movement is needed because the
coils of the gradiometer will never perfectly compensate
one another, leaving an empty-coil signal that will add a
spurious contribution to the measured magnetic moment,
or even wash out the signal of the sample to be measured.
As we shall discuss below, this has required a system that
moves the whole dilution refrigerator insert.

II. DILUTION REFRIGERATOR

Our ultra-low temperature setup is based on a Leiden
Cryogenics MNK126-400ROF dilution refrigerator.
In-
stead of the standard copper mixing chamber, we ﬁtted
the system with a specially designed plastic mixing cham-
ber that allows the sample to be thermalized directly by
the 3He ﬂow. A scheme of the low-temperature part of
the refrigerator is shown in Fig. 1. The mixing cham-
ber consists of two concentric tubes, obtained by rolling
a Kapton foil coated with Stycast 1266 epoxy. The tops
of each tube are glued into concentric Araldite pots: the
inner pot receives the downward ﬂow of condensed 3He
and, a few millimeters below the inlet, the phase separa-
tion between pure 3He phase and dilute 3He/4He phase
takes place. The circulation of 3He is then forced down-
wards along the inner Kapton tube, which has openings
on the bottom side to allow the return of the 3He stream
through the thin space in between the tubes. Both the
bottom of the Kapton tail and the outer pot are closed
by conical Araldite plugs smeared with Apiezon N grease.
The sample is typically placed inside a capsule ﬁlled with
cotton and inserted in a plastic straw, ﬁxed onto the bot-
tom Aradite plug. Alternatively, for samples being air
sensitive or having very small magnetic signal, one may
largely reduce the background contribution of the holder
by placing the sample between two Suprasil glass rods
inside a Suprasil tube [10], as shown in Fig. 2. In this

3

(a) He distillator ("still")
with cold plate.

(b) Upper heat exchanger.
(c) 80 mK pot.
(d) Lower heat exchanger.
(e) Copper joint with
heating wire

(f) Araldite mixing chamber.
(g) Thermometer.
(h) Conical vacuum plugs.
3
(i) Pure He phase.
(j) Forced downwards flow

3

of He in the dilute phase.

(k) Double-wall Kapton tail.
(l) Sample holder.
(m) Openings in the inner

Kapton tube to allow the
3
return of the He flow.

a

e

f

j

l

m

b

c

d

g

h

i

k

h

FIG. 1: Scheme of the low-T part of the dilution refrigera-
tor. For clarity we omit the vacuum can and the radiation
shields anchored at the still and at the 80 mK pot. Only the
narrow tail of the refrigerator is inserted in the bore of a 9 T
superconducting magnet (not shown).

way, the sample is placed in a symmetric conﬁguration
with respect to the pick-up coil systems, so that the only
signal induced by the vertical movement is that originat-
ing from the sample space and the sample itself. Both
types of sample holders are compatible with the commer-
cial SQUID magnetometers (Cryogenic Consultant Lim-
ited S600c, Quantum Design MPMS-5 and MPMS-XL)
available in our laboratory for magnetic measurements at
T > 1.8 K.

The Kapton tail, which is about 35 cm long, is sur-
rounded by two silver-plated brass radiation shields, one
anchored at the 80 mK pot, the other at the still. The
whole low-T part of the refrigerator is closed by a vac-
uum can, which has itself a thin brass tail to surround the
Kapton part of the mixing chamber, and is inserted into
the bore of an Oxford Instruments 9 Tesla NbTi super-
conducting magnet. In this way, only Kapton and brass
cylinders (plus the lowest Araldite plug) are placed in

2

FIG. 2: Sketch of the symmetric Suprasil glass sample holder.

the high-ﬁeld region, whereas all other highly-conducting
metal parts (heat exchangers, 80 mK pot, 3He distillator,
etc.) are outside the magnet bore and subject only to a
small stray ﬁeld. This design minimizes the eddy current
heating resulting from moving the refrigerator through
the pick-up coil of the SQUID magnetometer, while at
the same time thermalizing the sample directly by the
contact with the 3He ﬂow. The excellent sample ther-
malization obtained is this way has already proven to
be essential for NMR experiments on molecular magnets
performed in the same refrigerator down to T ≃ 15 mK,
whose success depends crucially on the eﬃcient cooling
of the nuclear spins [5].

The temperature inside the mixing chamber is moni-
tored by measuring, with a Picowatt AVS-47 bridge, the
resistance of a Speer carbon thermometer placed in the
outer part of the top Araldite pot. By adding an extra
Speer thermometer (calibrated against the previous one)
in the bottom of the Kapton tail, we have veriﬁed that
the temperature is very uniform along the whole cham-
ber (except in the presence of sudden heat pulses): even
at the lowest T , the mismatch between the measured
values is typically . 0.5 mK. During normal operation,
the thermometer in the bottom of the tail is obviously
omitted, to avoid its contribution to the measured mag-
netic signal. A Leiden Cryogenics Triple Current Source
is used to apply heating currents to a manganin wire,
anti-inductively wound and glued around a copper joint
just above the 3He inlet in the mixing chamber. In this
way we can heat the incoming 3He stream and uniformly
increase the mixing chamber temperature.

For the 3He circulation we employ an oil-free pumping
system, consisting of a Roots booster pump (Edwards
EH500) with a pumping speed of 500 m3/h, backed by
two 10 m3/h dry scroll pumps (Edwards XDS10) in par-
allel. The main pumping line is a ∅ 100 mm solid tube,
ﬁxed at the pump side with a ﬂexible rubber joint that
allows for an inclination of a few degrees, and is con-
nected to the head of the fridge by a “T” piece with two
extra rubber bellows, to reduce the vibrations transmit-
ted by the pumping system.
In this conﬁguration, the
system reaches a base temperature of 9 mK. The typical
3He circulation rate at the base temperature is ˙n ∼ 350
µmol/s, and the cooling power at 100 mK is ˙Q ∼ 150
˙Q
µW. When the Kapton tail is replaced by a ﬂat plug,
can be increased up to 700 µW @ 100 mK and ˙n ∼ 1200
µmol/s by applying extra heat to the still; with the tail

3

Ibias

V

in place it’s more diﬃcult to increase the circulation rate,
and ˙Q @ 100 mK hardly exceeds 250 µW.

Ibias

ext

V

I

Ic

III. PRINCIPLES OF SQUID
MAGNETOMETERY

A SQUID (Superconducting QUantum Interference
Device) is basically an ultra-sensitive ﬂux-to-voltage con-
verter, that exploits the peculiar quantum properties of
closed superconducting circuits. A detailed description of
its working principle can be found in textbooks [1, 11],
[12]. Here we just recall that a dc-
or in §2.4.1 of Ref.
SQUID, like the one used in our system, consists of a
superconducting ring interrupted by two Josephson junc-
tions, J1 and J2, each characterized by a critical current
Ic, which represents the maximum current that may ﬂow
through the junction without dissipation. The dc-SQUID
is operated by biasing the junctions J1 and J2 with a
current Ibias > Ic, such that a voltage V develops across
them (Fig. 3). The essential feature is that the voltage
can be modulated by an applied magnetic ﬂux Φ, since
the critical current Ic also depends on Φ. One ﬁnds that
the screening current Is that circulates in the SQUID
ring is related to the critical current Ic of the junctions
(assumed to be identical) by:

Is =

′
sin ϕ

− sin

′
ϕ

− 2π

Φext + LIs
Φ0

(cid:19)(cid:21)

,

(1)

(cid:18)

Ic
2

(cid:20)

where Φ0 = h/2e = 2.07×10−15 Wb is the ﬂux quantum,
L is the self-inductance of the ring and ϕ′ is the shift in
the phase of the superconducting order parameter which
develops across each junction. Ic is obtained by maxi-
mizing Is, yielding the periodic form of Ic(Φext) shown in
Fig. 3. By properly choosing the bias conditions, the dc-
SQUID operates therefore as a ﬂux-to-voltage converter,
where the external ﬂux can be applied by injecting a cur-
rent in the input coil. Notice that a small fraction of a
ﬂux quantum can produce voltage changes of the order of
millivolts! In the practice a dc-SQUID is used in feedback
mode by employing a so-called Flux-Lock Loop (FLL),
i.e. adding a feedback coil that produces a compensating
ﬂux such that V = const. This increases the accuracy
and the dynamic range of the measurement, and allows
to implement noise-reducing detection schemes.

To use a dc-SQUID in an actual magnetometer, it is
still necessary (except in a rather radical design like the
“microSQUID” [3]) to produce a current proportional
to the magnetic moment of the sample to be measured.
Such a current can be injected in the input coil to produce
a ﬂux that is coupled to the SQUID ring by the mutual
inductance M. Typically, the input current is obtained
by constructing a closed superconducting circuit which
includes the SQUID’s input coil on one side, and termi-
nates with a pick-up coil on the other side. Once the
circuit has been cooled down below the superconducting
critical temperature, the enclosed ﬂux is constant. Any
change in the magnetic permeability of the circuit, for

-1

0

1

ext

0

ext

D V

FIG. 3: Working principle of a dc-SQUID as ﬂux-to-voltage
converter.

instance due to the sample, will result in a screening cur-
rent that, while keeping the total ﬂux constant, produces
the required ﬂux in the input coil. In our case, the change
in permeability of the pick-up circuit is obtained by ver-
tically moving the whole dilution refrigerator, whose tail,
that contains the sample, is inserted in the pick-up coil.
Because of the high sensitivity, it is essential to make
sure that no sources of ﬂux other than the sample may
couple with the SQUID. This can be done by employ-
ing a gradiometer, which in its simplest form consists of
two coils wound in opposite direction, so that the ﬂux
produced by any uniform magnetic ﬁeld cancels out, and
only the gradient of B can be detected (ﬁrst-order gra-
diometer). A further improvement is the second-order
gradiometer, shown in Fig. 4, which is obtained by in-
serting a coil with 2N windings between two coils with
N turns each, wound opposite to the central one. This
design eliminates also the eﬀects of linear ﬁeld gradients.
Furthermore, according to the reciprocity principle [13],
the ﬂux Φ produced in a coil of arbitrary geometry by a
magnetic moment µ at position ~r is related to the ﬁeld
~B(~r) produced by the same coil in ~r when carrying a
current I such that:

~B · ~µ = ΦI.

(2)

The ﬁeld produced by a single-loop coil is equivalent to
the ﬁeld of a magnetic dipole, whereas a ﬁrst-order gra-
diometer is a magnetic quadrupole, and a second-order
is an octupole, so that the ﬁelds they produce vary in
space like r−3, r−4 and r−5, respectively. From Eq.(2)
it is clear that a second-order gradiometer is the least
sensitive to magnetic ﬁelds produced outside of the coil
system.

F
F
F
F
F
D
F
D
F
D
F
D
F
D
D
D
F
where ftr is the ﬂux-transfer ratio [14].

4

IV. DESIGN AND CONSTRUCTION OF THE
PICK-UP CIRCUIT

The circuitry for our SQUID magnetometer is, with a
few additions, based on the principles discussed above.
The niobium dc-SQUID sensor is part of a Conductus
LTS iMAG system, which includes a FLL circuitry to be
placed just outside the cryostat, and is connected to the
SQUID controller by a hybrid optical-electrical cable. To
couple a magnetic signal to the SQUID we constructed a
second-order gradiometer by winding a ∅ 100 µm NbTi
wire on a brass coil-holder, to be inserted in the bore of
the Oxford Instruments 9 T NbTi superconducting mag-
net. The gradiometer coils have ∅ 36 mm (a = 18 mm)
and d = 9 mm. The choice of the diameter is constrained
by the ∅ 34 mm vacuum can of the refrigerator that con-
tains the sample. The leads of the pick-up circuit, which
are tightly twisted and shielded by a Nb capillary, are
screwed onto the input pads of the SQUID to obtain a
closed superconducting circuit. The input inductance of
the SQUID sensor is Lin = 600 nH; since Lleads ∼ 200
nH and, given the dimensions, Lpu ∼ Lin + Lleads already
with N = 1, it follows from Eq. (7) that the most con-
venient choice of windings for the gradiometer is 1-2-1
(recall that Φpu ∝ N but Lpu ∝ N 2). The mutual in-
ductance between SQUID ring and input coil is M = 10
nH, which means that ftr ∼ 1/200.

The FLL included in the Conductus electronics is able
to compensate for 500 Φ0 at the SQUID ring, which
means that a maximum ﬂux Φ(max)
= 500/ftr ∼ 105
Φ0 can be picked up by the gradiometer without satu-
rating the system. The maximum measurable magnetic
moment µ(max) is therefore [cf. Eq. (5) and Fig. 4]:

pu

µ(max) ≈

Φ(max)

pu ∼ 1018µB ∼ 10

−5 Am2.

(8)

2a
0.6µ0

In order to extend the dynamic range, we have built an
extra ﬂux transformer on the pick-up circuit, which al-
lows to introduce a magnetic ﬂux from the outside to
compensate for the ﬂux induced by the sample. By using
the SQUID as a null-meter, there is the extra advantage
that no current circulates in the pick-up circuit, thus the
ﬁeld at the sample is precisely the ﬁeld produced by the
magnet, without the extra ﬁeld that would be produced
by a current in the gradiometer. The ﬂux transformer
consists of 16 turns of NbTi wire, wound on top of one
loop of the pick-up wire and shielded by a closed lead box.
In the same box we tightly glued the pick-up leads on top
of a 100 Ω chip resistor, which is used to locally heat the
circuit above the superconducting Tc and eliminate the
trapped ﬂux. The ﬂux transformer is fed by a Keithley
220 current source, whereas the heater is operated by
one of the three current sources in the Leiden Cryogen-
ics Triple Current Source used for the refrigerator. Both

FIG. 4: A second-order gradiometer in Helmoltz geometry
(a = 2d) and the magnetic ﬂux induced by a dipole moving
along z. Notice that the side peaks in Φ(z) do not coincide
with the positions of the external coils. The factor a in the
x-axis scale is obtained by using the second form of Eq. (4).

The magnetic moment of the sample can be detected
by moving it through the pick-up coil. The enclosed ﬂux
is easily obtained from the ﬂux induced by a dipole with
magnetic moment ~µ k ~z at a position z along the axis in
a loop of radius a placed at z = z0:

f (z − z0) =

Φloop(z) =

f (z − z0)µ,

µ0
2
a2
[a2 + (z − z0)2]3/2 =
z2
0
a2

−3/2

− 1

z
z0

2

.

#

(cid:19)

(cid:18)

1
a "

1 +

(3)

(4)

If the upper and lower coils of the gradiometer are placed
at z = d and z = −d, respectively, then the total picked-
up ﬂux is:

Φpu(z) = N

[f (z − d) − 2f (z) + f (z + d)]µ.

(5)

µ0
2

When adopting the Helmoltz geometry, a = 2d, the re-
sulting Φ(z) is shown in Fig. 4.

The picked-up ﬂux is related to the screening current

in the pickup circuit, IS, by:

Φpu = (Lpu + Lleads + Lin)IS,

(6)

where Lpu, Lleads and Lin are the inductances of the pick-
up coil, the leads and the SQUID input coil, respectively.
The ﬂux at the SQUID sensor ΦSQUID is thus given by:

ΦSQUID = MIs = ftrΦpu,

ftr =

M
Lpu + Lleads + Lin

,

(7)

5

V. VERTICAL MOVEMENT

The movement of the sample through the gradiome-
ter is obtained by lifting the whole dilution refrigerator.
For this purpose, the refrigerator is ﬁxed on a movable
ﬂange, while the top of the cryostat is closed by a rub-
ber bellow. On the ﬂange we screwed the nuts of three
recirculating balls screws (SKF SN3 20 × 5R), which al-
low a very smooth displacement of the nut by turning
the screw. The base of each screw is mounted on ball
bearings and is ﬁtted with a gearwheel. The gearwheels
are connected by a toothed belt (Brecoﬂex 16 T5 / 1400)
driven by a three-phase AC servomotor (SEW DFY71S
B TH 2.5 Nm) that can exert a torque up to 2.5 Nm.
In this way, the rotation of the servomotor is converted
into the vertical movement of the dilution refrigerator
insert. The movement is so smooth that the consequent
vibrations are hardly perceptible and do not exceed the
vibrations due to the 3He pumping system.

The motor is driven by a servo-regulator (SEW
MDS60A0015-503-4-00) that can be controlled by a com-
puter. For safety reasons an electromagnetic brake is ﬁt-
ted, that blocks the motor in case of power failure. In
addition, a set of switches is mounted along one of the
pillars that support the screws: when the ﬂange reaches
the highest or the lowest allowed position, the switches
force the motor to brake, independently of the software
instructions. The maximum allowed vertical displace-
ment is 10 cm.

A picture of the top of the cryostat with the vertical

movement elements is shown in Fig. 6.

VI. GROUNDING AND SHIELDING

The shielding of the SQUID sensor and electronics is
of course a crucial issue for the successful design of a
SQUID-based magnetometer. As mentioned in §IV, the
low-temperature parts are shielded by superconducting
Pb boxes or Nb capillaries. As for the electronics out-
side the cryostat, the Conductus iMAG system provides
hybrid optical-electrical cables for the communication be-
tween the SQUID controller and the FLL electronics on
top of the cryostat, but in the cable that connects the
FLL to the SQUID sensor, the ground is used as return
line for the signals. This means that any ground loop
involving the SQUID electronics will completely destroy
the functionality of the system. Obviously, all the outer
metallic parts in the system (e.g. the case of the SQUID
sensor, the vacuum feedthrough for the cryocable, etc.)
are connected to the same electrical ground, including
the GPIB communication terminals.

The best way to avoid ground loops in the SQUID
system would be to ground the SQUID sensor and its ca-
ble at the cryostat (and take care that it remains a very
clean ground), and connect the controller to an isolation
transformer [16]. This method is not practicable when
communication with the computer via the GPIB bus is

FIG. 5: Picture and scheme of the SQUID circuitry. (a) Su-
perconducting magnet. (b) Coil holder. (c) Flux transformer
(d) 3 Hz lead shielded low-pass
and heater in lead shield.
ﬁlter. (e) SQUID sensor. (f) Pick-up leads with Nb capillary
shield. (g) SQUID cryocable.

sources are controlled by the software described in Sect.
VII.

Despite the eﬀorts to isolate the system from exter-
nal vibrations, the powerful pumps for the dilution re-
frigerator still provide a non-negligible mechanical noise.
In particular, the Roots pump has a vibration spectrum
with a lowest peak at ∼ 25 Hz. To prevent the possible
ﬂux changes induced by such vibrations when coupled to
a magnetic ﬁeld, we added an extra low-pass ﬁlter on the
pick-up circuit[15] in the form of a 17 mm long ∅ 0.3 mm
copper wire in parallel with the pick-up leads. At T = 4.2
K such a wire has a resistance R ≃ 11 µΩ, which together
with the input inductance Lin = 600 nH of the SQUID
yields a cutoﬀ frequency fl.p. = (1/2π)(R/Lin) ≃ 3 Hz.
The ﬁlter is contained in a separate Pb-shielded box in-
serted between the ﬂux transformer and the SQUID. The
pick-up leads and the copper wire are contacted via Nb
pads.

A picture of the SQUID circuitry is shown in Fig.
5. The SQUID, the ﬁlter and the ﬂux transformer are
mounted on a radiation shield of the magnet hanging.
The whole system is inserted in a 90 liter helium cryo-
stat produced by Kadel Engineering. The magnet hang-
ing is stabilized by triangular phosphor-bronze springs
(not shown in Fig. 5) that press against the inner walls
of the cryostat.

6

FIG. 7: A screenshot of the application’s user interface. In-
formation about temperature, vertical position, applied mag-
netic ﬁeld, SQUID voltage and status of the program is con-
stantly provided in the workspace. Additional windows are
open, in this case, to monitor the result of the measurement
and the nulling of the SQUID voltage.

tionality of the magnetometer was reached by enclosing
the FLL and the room-temperature SQUID cables into
an extra copper shield, grounded at the cryostat but sep-
arated from the SQUID ground.

VII. AUTOMATION

The automation of the measurement system is achieved
by connecting to a PC the iMAG SQUID controller,
the Keithley 220 current course, the LC Triple Current
Source, the Picowatt AVS 47 resistance bridge, and the
SEW servo-regulator. The PC runs a home-written soft-
ware, which provides an application with a single but
ﬂexible Graphical User Interface (GUI), containing all
the required functionality: setup management, monitor-
ing, measurement, automated sequence execution and
data analysis. The application is written in Borland Del-
phi because of its power, ease of use, good documen-
tation and rapid GUI development possibilities. The
Windows user interface is primarily inspired upon the
Quantum Design’s MultiVU application, included with
their commercial Magnetic Property Measurement Sys-
tem (MPMS). This has the advantage of oﬀering an in-
terface that looks familiar to many users. The GUI con-
sists of a Multiple Document Interface (MDI) with among
other things a menu, a toolbar, a status bar, and remov-
able panels. The MDI workspace is where the actual
work is done in several subwindows, as shown in Fig. 7.
A set of tools are available for e.g. positioning the sam-
ple, setting a magnetic ﬁeld, monitoring the temperature
and performing “zero ﬁeld oscillations”, i.e. oscillations
of the applied ﬁeld which are used to reduce the trapped
ﬂux in the magnet coil.

FIG. 6: Picture of the top of the cryostat, with the elements
for the vertical movement. (a) Head of the dilution refrigera-
tor. (b) Movable ﬂange. (c) Rubber bellow. (d) Screws. (e)
Nut with recirculating balls. (f) Gearwheels. (g) Belt. (h)
Servomotor. (i) SQUID FLL electronics. (j) Feedthrough to
the SQUID cryocable.

needed, and the same computer is connected to another
instrument that requires a common ground with the cryo-
stat (this is the case for the Picowatt AVS-47 resistance
bridge). The only choice is therefore to ground the con-
troller at its power cord and ﬂoat the whole SQUID cir-
cuitry, all the way to the SQUID sensor inside the cryo-
stat and the shields of the pick-up circuit (which must
be connected to the SQUID ground). This is already a
rather cumbersome operation, but it’s not yet suﬃcient.
We found out that, in this conﬁguration, the FLL elec-
tronics and the room-temperature cables around it are
not enough shielded from the electromagnetic interfer-
ence generated by the motor during the vertical move-
ment of the dilution refrigerator (we obviously took care
that the motor does not touch the cryostat ground). This
sort of interference does not annihilate the functionality
of the SQUID like a ground loop would do, nor does it
simply induce an increase of the instrumental noise: the
eﬀect of bad shielding is that the SQUID system behaves
as if it were connected to a non-superconducting, induc-
tive circuit. This fault is hard to discover, since the in-
ductive behavior of the pick-up system is one of the most
expectable failures, which can be due to any weakening of
the superconductivity in the circuit, for instance because
of a bad contact on the SQUID input pads. The full func-

7

ple scans and the other containing the single ﬁtted scans.
In the end, the ﬁtted dipole moment obtained from a
set of scans which have been interpolated, averaged and
ﬁtted, represents one data point at a certain temperature
and applied magnetic ﬁeld. In general, we are interested
in measuring the sample magnetization at several values
of temperature and/or ﬁeld. To do this automatically,
an elementary scripting language has been implemented
very similar to the way done in the MPMS MultiVU ap-
plication. There are commands for, among other things,
changing the sample position, setting a temperature, set-
ting a ﬁeld, heating and retuning the SQUID sensor, per-
forming zero ﬁeld oscillations and running a subsequence.
All these commands can be nested in for-loop structures
for measuring as a function of temperature or ﬁeld. The
sequence ﬁles are edited using a built-in sequence editor
which supports the most common editing functions such
as cut, copy, paste and undo. When a sequence is run,
it can be paused, resumed, aborted and the execution
status can be monitored.

As for the implementation, the application consists of
a main core structure and modular components called
“applets”. The core structure implements routines for
the starting and stopping of the program, user interface,
device initialization and communication, and the neces-
sary menu items, tool buttons and shortcuts for starting
the various components of the application. The applets
are started from the main program and do all the work
involving device communication, e.g. provide a tool for
magnet management, monitor the status of the setup,
null the SQUID using the FLL, do a set of scans, or ex-
ecute a sequence. The applets which communicate with
devices run in separate parallel threads to ensure com-
munication without sacriﬁcing performance of the main
program. There are, for example, typically four threads
running during a null-mode measurement:

• The main GUI thread
• A thread which monitors and displays the mix-
ing chamber temperature, vertical sample position,
magnet status and SQUID voltage. This thread
communicates with devices not used by other ap-
plets.

• The measurement thread, which communicates
with the servo regulator and the SQUID (in direct
mode)

• The nuller thread which communicates with the

SQUID and Keithley 220 current source

When an applet obtains information from a device, e.g.
servomotor position, magnetic ﬁeld or SQUID voltage,
this information is shared with the other applets so that
all applets stay informed about the global status of the
system.

The applets communicate with the devices through a
central abstract layer which encapsulates the device spe-
ciﬁc hardware communication and protocols. This cen-
tral layer also makes it possible to start and stop the

FIG. 8: A screenshot of the data viewer. On the left-hand side
we analyzed the ﬁeld dependence of the magnetization of a
Pb sample between 0 and 80 mT at T = 11 mK. On the right-
hand side, a sequence of magnetization curves of MnApy (see
text) between 0 and 100 mT at four diﬀerent temperatures.

In order to measure the magnetic moment of a sample,
the response of the SQUID is measured while vertically
moving the sample (i.e. the whole dilution refrigerator
insert) along the gradiometer, as illustrated in Fig. 4.
The sample can be positioned in two ways, using the
so-called continuous or hold mode.
In the continuous
mode, the sample is positioned at the start of the tra-
jectory and then set into a continuous motion. During
the movement, readings are made at ﬁxed time intervals.
When the sample reaches the end of the trajectory, the
movement is stopped. In the hold mode, the sample is
moved for a short interval of time after which the motor
is stopped and the SQUID reading is done, repeating this
sequence until the ﬁnal position is reached.

A reading can be done in direct or null mode. In the
direct mode, one reads directly the SQUID voltage, which
is proportional to the screening current that circulates in
the pickup system. In null mode, the compensation cur-
rent in the ﬂux transformer is continuously being regu-
lated by the software, using a proportional feedback con-
troller which runs in the background, until the SQUID
voltage is zero. A reading in null mode consists there-
fore of the current necessary to null the SQUID voltage.
At the start of each measurement (“scan”), the sample
is ﬁrst accurately positioned at the starting point and
then, if used, the nulling process is started. The mea-
surement will then start and continue until the end point
is reached. Typically two scans are done, an upward and
a downward scan; the results of the two scans are cor-
rected for the drift of the SQUID voltage, averaged and
ﬁtted to obtain the dipole moment.

Measurements can be managed, viewed and ﬁtted us-
ing the built-in data viewer: an example is shown in Fig.
8. The data viewer consists of a set of controls and two
graphs, one containing the ﬁtted dipole moment of multi-

 

)

2

m
A

 

6
-
0
1
(
 
 
t
n
e
m
o
m
 
c
i
t
e
n
g
a
M

1

0

-1

-2

-3

-4

-5

-6

-7

-8

0

10

20

30

40
Applied field  (mT)

50

60

70

80

90

FIG. 9: The magnetic moment of a small Pb grain, as mea-
sured in our setup (full symbols) and in a Quantum Design
MPMS-XL magnetometer (open symbols). Squares: T = 4.5
K, circles: T = 11 mK.

devices while the application is running. All the device’s
functionality can additionally be simulated, which was
very useful during the implementation phase: most of the
application was written without using the experimental
setup.

VIII. PERFORMANCE

In order to check the performance of our instrument,
we ﬁrst measured the magnetization of a small lead grain
in a Quantum Design MPMS-XL magnetomter, then we
mounted the sample, with the same sample holder, inside
the mixing chamber of the dilution refrigerator. The re-
sults are shown in Fig. 9: at T = 4.5 K, the data in our
setup and in the MPMS-XL can be accurately superim-
posed, provided the correct calibration factor is chosen.
By cooling down to T = 11 mK, we still ﬁnd the same
slope of M (H) and an expectedly higher critical ﬁeld.

As an example of dc-susceptibility experiment, we
show in Fig.
10 a dataset obtained by measuring
1.9 mg of the paramagnetic salt manganese antipyrine
Mn(C11H12ON2)6(ClO4)2 (MnApy), in a constant ap-
plied ﬁeld µ0Ha = 2 mT while slowly cooling down the
refrigerator. The paramagnetic centers in MnApy are the
Mn2+ ions, with spin S = 5/2 and gyromagnetic factor
g = 2.00. In this sort of measurements we typically use
the “continuous + direct” mode, which allows to perform
the scans rather quickly (∼ 1 min) as compared to the
timescale of the temperature changes. The volume sus-
ceptibility χ = M/H = µρ/(mH) (m is the mass of the
sample and ρ = 1.361 × 103 kg/m3 is the density) can
be obtained from the measured magnetic moment µ and
compared with the expected behavior of a Curie para-

magnet χ = C/T , where C = µ0N g2µ2
BS(S + 1)/(3kB)
is the Curie constant and N = 5.927 × 1026 m−3 is the
In view of the high
number of spins per unit volume.
value of χ obtained at very low temperature, the com-
parison is meaningful only after having corrected the raw
data for demagnetizing eﬀects:

 

χcorr =

χraw
1 − Dχraw

,

8

(9)

where D is the demagnetizing factor.

Since the sample is in powder form, D will be an eﬀec-
tive demagnetizing factor appropriate for the container
(in this case a cylindrical capsule) ﬁlled with the grains.
This is a notoriously complex problem that can only be
solved in an approximate way. In a ﬁrst step the rela-
tion should be found between the applied ﬁeld Ha and
the local ﬁeld Hcont acting on a grain in the container.
The dipolar contributions from the other grains can be
divided in a shape-dependent part given by the demag-
netizing factor Dcont of the container, and a “structural”
part given by the packing of the grains. In a second step
the relation between Hcont and the local ﬁeld Hloc inside
a grain should be found. The diﬀerence between Hcont
and Hloc will now be due to the shape-dependent con-
tribution related to the demagnetizing factor Dgrain of
the grain and the structural part arising from the crystal
structure of the material.

In view of all the uncertainties involved, the simplest
solution for the present purpose appears to assume all
grains to have identical shape and to adopt, for both
steps, the Lorentz approximation to estimate the contri-
butions depending on the structural aspects. Thereby
we shall also neglect the contributions from the dipoles
inside the spheres. One then obtains:

D = Dgrain −

+ f

Dcont −

= f

Dcont −

,(10)

1
3

1
3

(cid:18)

(cid:19)

(cid:18)

1
3

(cid:19)

where f is the ﬁlling fraction (volume) of the container
and where the last equality follows from the assumption
Dgrain = 1/3, i.e. we assume all grains to have a spherical
shape. Given the shape of the sample holder, we estimate
the demagnetizing factor of the container Dcont ≃ 0.7,
which yields D ≃ 0.37f . Taking for the ﬁlling factor
f ≃ 0.5 (ideally packed spheres would yield f ≃ 0.64), we
obtain the corrected volume susceptibility shown in Fig.
10. χcorr closely follows the calculated ideal Curie law,
except for some small deviations below ∼ 0.2 K. Such de-
viations are better appreciated when plotting 1/χcorr vs
T , as shown in the inset of Fig. 10. As it appears, the sus-
ceptibility remains always slightly lower than the value
for an ideal Curie paramagnet. This can be attributed
to a small crystal ﬁeld anisotropy of the Mn2+ electron
spins, which causes a reduction of the eﬀective Curie con-
stant at very low temperatures due to the depopulation
of the excited energy levels in the zero-ﬁeld split man-
ifold [17]. Another reason for the deviation may be an
(antiferromagnetic) ordering of the moments, e.g. due to

 

 

6

4

2

 c
/
 
1

2.5

2.0

1.5

1.0

0.5

y
t
i
l
i

b
i
t
p
e
c
s
u
s
 
e
m
u
o
V

l

 

 

0
0.00

0.05

0.10

0.20

0.25

0.15
T  (K)

0.0

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

Temperature  (K)

FIG. 10: Full triangles: measured dc-susceptibility of MnApy
in an applied ﬁeld µ0Ha = 2 mT. Open circles: data corrected
for the demagnetizing factor (see text). Solid line: calculated
susceptibility according to the Curie’s law. Inset: inverse of
the corrected susceptibility (open circles), ﬁtted by the Curie-
Weiss law (solid line), yielding Θ ≃ 14 mK.

9

i.e. while all the pumps are running and the dilution
refrigerator insert is being moved, is ∼ 1 mV, which
translates into an equivalent magnetic noise ∼ 10−9 Am2
(10−6 emu). Measuring a magnetic moment ∼ 10−4 Am2
(0.1 emu) in “null mode” requires a compensation current
∼ 30 mA, which poses no problems to the compensation
circuitry; this means that our system can easily cover a
dynamic range of ﬁve orders of magnitude in magnetic
moment.

As for the maximum applicable magnetic ﬁeld, al-
though the magnet itself can produce 9 T, the SQUID
circuitry tends to become unstable above ∼ 0.2 T. This
a rather typical value when no special cautions are taken
to stabilize the ﬁeld and screen the SQUID circuitry from
the stray ﬁelds: in specialized systems[2, 9], operation up
to 8 T has been achieved by designing a dedicated mag-
net with large bore and by adding a NbTi superconduct-
ing shield around the sample- and pickup coils- space.
We recall that our system is not dedicated uniquely to
SQUID magnetometery and can accommodate, for in-
stance, NMR experiments where the possibility of pro-
ducing continuous ﬁeld sweeps is essential.

Acknowledgments

the dipolar interactions between them. As an estimate
of the interaction energy, U , we may consider the dipo-
lar coupling between two Mn2+ spins 5/2 at a distance
r ≃ 1 nm in the MnApy compound. One then obtains
U = (µ0/4π)(gµBS)2/(kBr3) ≃ 15 mK. Although this
estimate is very rough, it is an indication that such an
ordering phenomenon may not be excluded.

The uncertainty in the choice of D makes it rather
delicate to analyze the data in more detail, but for the
purpose of the present discussion we may state that the
thermalization of the sample does not pose any special
problem down to our lowest achievable temperature.

We thank J. Sese for the precious advice about SQUID
sensors, K. Siemensmeyer for the suggestions on the de-
sign of the pickup system, T. G. Sorop for the high-T
measurements and the fruitful discussions, and F. Luis
for his contributions in the early stage of the project. The
technical support of A. Kuijt, E. de Kuyper, R. Hulstman
and M. Pohlkamp has been invaluable and is gratefully
acknowledged. This work is part of the research program
of the “Stichting voor Fundamenteel Onderzoek der Ma-
terie” (FOM).
∗ Corresponding author:

The typical noise at the SQUID in normal operation,

L.J. de Jongh, e-mail: dejongh@phys.leidenuniv.nl

[1] J. C. Gallop, SQUIDs, the Josepshon Eﬀects and Super-
conducting Electronics, IOP publishing (Bristol, 1991).
[2] C. Paulsen, chapter in Introduction to Physical Tech-
niques in Molecular Magnetism: Structural and Macro-
scopic Techniques, Servicio de Publicaciones de la Uni-
versidad de Zaragoza (Zaragoza, 2001).

[8] S. E. Nave and P. G. Huray, Rev. Sci. Instr. 51, 591

(1980).

[9] J. C. Genna, S. Biston, J. C. Cotillard, P. Lethuillier, C.
Faurin, P. Hostachy, R. Rocca-Valero, and J. Rouiller,
Rev. Sci. Instr. 62, 1824 (1991).

[10] J. Sinzig, Magnetism of Nanometer-Sized Particles,

[3] W. Wernsdorfer, D. Mailly, and A. Benoit, J. Appl. Phys.

Ph.D. thesis, Leiden University (April 1997).

87, 5094 (2000).

[11] O. V. Lounasmaa, Experimental Principles and Methods

[4] P. G. Bj¨ornsson, B. W. Gardner, J. R. Kirtley, and K.

Below 1 K, Academic Press (London, 1974).

A. Moler, Rev. Sci. Instr. 72, 4153 (2001).

[5] A. Morello, O. N. Bakharev, H. B. Brom, R. Sessoli,

arXiv:cond-mat/0403107 (2004).

[6] A. Morello, F. L. Mettes, F. Luis, J. F. Fern´andez, J.
Krzystek, G. Arom´ı, G. Christou, and L. J. de Jongh,
Phys. Rev. Lett. 90, 017206 (2003).

[7] Y. E. Volokitin, J. Sinzig, L. J. de Jongh, G. Schmid, M.
N. Vargaftik, and I. I. Moiseev, Nature 384, 621 (1996).

[12] A. Morello, Quantum Spin Dynamics in Single-Molecule
Magnets, Ph.D. Thesis, Leiden University (March 2004);
arXiv:cond-mat/0404049.

[13] J. Mallinson, J. Appl. Phys. 37, 2514 (1966).
[14] J. H. Claassen, J. Appl. Phys. 46, 2268 (1975).
[15] M. Meschke, Untersuchung der magnetischen Eigen-
schaften kubischer Antiferromagnete, Ph.D. thesis, Tech-
nical University Berlin (January 2001).

c
c
c
[16] B. J. Vleeming, The Four-Terminal SQUID, Ph.D. the-

92B, 258 (1977).

sis, Leiden University (March 1998).

[17] H. A. Algra, L. J. de Jongh, and R. L. Carlin, Physica

10

