5
0
0
2
 
y
a
M
 
8
1
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
7
2
1
5
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Position resolution and particle identiﬁcation
with the ATLAS EM calorimeter

J. Colas a, L. Di Ciaccio a, M. El Kacimi a,1, O. Gaumer a,
M. Gouan`ere a, D. Goujdami a,1, R. Lafaye a, C. Le Maner a,
L. Neukermans a, P. Perrodo a, L. Poggioli a, D. Prieur a,
H. Przysiezniak a, G. Sauvage a, I. Wingerter-Seez a, R. Zitoun a,
F. Lanni b, H. Ma b, S. Rajagopalan b, S. Rescia b, H. Takai b,
A. Belymam c, D. Benchekroun c, M. Hakimi c, A. Hoummada c,
E. Barberio d,2, Y.S. Gao d, L. Lu d, R. Stroynowski d,
M. Aleksa e, J. Beck Hansen e,3, T. Carli e, P. Fassnacht e,
F. Gianotti e, L. Hervas e, W. Lampl e, B. Belhorma f, J. Collot f,
M.L. Gallin-Martel f, J.Y. Hostachy f, F. Ledroit-Guillon f,
P. Martin f, F. Ohlsson-Malek f, S. Saboumazrag f, S. Viret f,
M. Leltchouk g, J.A. Parsons g, M. Seman g, F. Barreiro h,
J. Del Peso h, L. Labarga h, C. Oliver h, S. Rodier h,
P. Barrillon i, C. Benchouk i, F. Djama i, P.Y. Duval i,
F. Henry-Couannier i, F. Hubaut i, E. Monnier i, P. Pralavorio i,
D. Sauvage i,4, C. Serfon i, S. Tisserant i, J. Toth i,5, D. Banﬁ j
L. Carminati j, D. Cavalli j, G. Costa j, M. Delmastro j,
M. Fanti j, L. Mandelli j, G. F. Tartarelli j, K. Kotov k,
A. Maslennikov k, G. Pospelov k, Yu. Tikhonov k,
C. Bourdarios ℓ, C. de La Taille ℓ, L. Fayard ℓ, D. Fournier ℓ,
L. Iconomidou-Fayard ℓ, M. Kado ℓ, M. Lechowski ℓ,
G. Parrour ℓ, P. Puzo ℓ, D. Rousseau ℓ, R. Sacco ℓ,6,7,
N. Seguin-Moreau ℓ, L. Serin ℓ, G. Unal ℓ, D. Zerwas ℓ,
B. Dekhissi m, J. Derkaoui m, A. El Kharrim m, F. Maarouﬁ m
A. Camard n, D. Lacour n, B. Laforge n, I. Nikolic-Audit n,
Ph. Schwemling n, H. Ghazlane o, R. Cherkaoui El Moursli p,
A. Idrissi Fakhr-Eddine p, M. Boonekamp q, B. Mansouli´e q,
P. Meyer q, J. Schwindling q, B. Lund-Jensen r, Y. Tayalati r

aLaboratoire de Physique de Particules (LAPP), IN2P3-CNRS,
F-74941 Annecy-le-Vieux Cedex, France.

Preprint submitted to Elsevier Science

30 December 2013

bBrookhaven National Laboratory (BNL), Upton, NY 11973-5000, USA.
cFacult´e des Sciences A¨ın Chock, Casablanca, Morocco.
dSouthern Methodist University, Dallas, Texas 75275-0175, USA.
eEuropean Laboratory for Particle Physics (CERN), CH-1211 Geneva 23,
Switzerland.
f Laboratoire de Physique Subatomique et de Cosmologie, Universit´e Joseph
Fourier, IN2P3-CNRS, F-38026 Grenoble, France.
gNevis Laboratories, Columbia University, Irvington, NY 10533, USA.
hPhysics Department, Universidad Aut´onoma de Madrid, Spain.
iCentre de Physique des Particules de Marseille, Univ. M´editerran´ee,
IN2P3-CNRS, F-13288 Marseille, France.
jDipartimento di Fisica dell’Universit`a di Milano and INFN, I-20133 Milano,
Italy.
kBudker Institute of Nuclear Physics, RU-630090 Novosibirsk, Russia.
ℓLaboratoire de l’Acc´el´erateur Lin´eaire, Universit´e de Paris-Sud, IN2P3-CNRS,
F-91898 Orsay Cedex, France.
mLaboratoire de Physique Theorique et de Physique des Particules, Universit´e
Mohammed Premier, Oujda, Morocco.
nUniversit´es Paris VI et VII, Laboratoire de Physique Nucl´eaire et de Hautes
Energies, F-75252 Paris, France.
oFacult´e des Sciences and Centre National de l’ ´Energie des Sciences et des
Techniques Nucl´eaires, Rabat, Morocco.
pUniversit´e Mohamed V, Facult´e des Sciences, Rabat, Morocco.
qCEA, DAPNIA/Service de Physique des Particules, CE-Saclay,
F-91191 Gif-sur-Yvette Cedex, France.
rRoyal Institute of Technology, Stockholm, Sweden.

Abstract

In the years between 2000 and 2002 several pre-series and series modules of the
ATLAS EM barrel and end-cap calorimeter were exposed to electron, photon and
pion beams. The performance of the calorimeter with respect to its ﬁnely segmented
ﬁrst sampling has been studied. The polar angle resolution has been found to be
E (GeV). The π0 rejection has been measured to
in the range 50
be about 3.5 for 90% photon selection eﬃciency at pT = 50 GeV/c. e-π separation
studies have indicated that a pion fake rate of (0.07-0.5)% can be achieved while
maintaining 90% electron identiﬁcation eﬃciency for energies up to 40 GeV.

60 (mrad)/

p

−

Key words: Calorimeters, particle physics
PACS: 29.40.Vj, 06.30.Bp

2

1 Introduction

The CERN Large Hadron Collider (LHC) is a proton-proton collider with
14 TeV centre of mass energy and design luminosity of 1034cm−2s−1. ATLAS
is a LHC experiment designed to maximise the discovery potential for new
physics phenomena such as Higgs bosons and supersymmetric particles, while
keeping the capability of high-accuracy measurements of known objects such
as heavy quarks and gauge bosons.

A very challenging mass region for Higgs discovery at the LHC lies between the
limit reached by the LEP2 detectors at 114.4 GeV [1] and 2 mZ ∼
180 GeV.
In this region, the decay H
γγ is one of the most promising discovery chan-
nels. Its observation requires an excellent performance of the electromagnetic
calorimeter in terms of energy resolution, precision of angular measurement
and particle identiﬁcation capability.

→

The electromagnetic calorimeter in the ATLAS experiment is a lead-liquid
argon sampling calorimeter with accordion shaped absorbers and electrodes.
Liquid argon technology has been chosen because of its intrinsic linear be-
haviour as function of the deposited energy, stability of the response and
radiation tolerance.

−

−

In the following, the beam direction deﬁnes the z axis, and the x
y plane is
transverse to the beam direction. The azimuthal angle φ is measured around
the beam axis, and the polar angle θ is the angle from the beam axis; the
pseudorapidity is deﬁned as η =
ln tan θ/2. The calorimeter has a cylindrical
symmetry with a longitudinal segmentation along the radius of the cylinder
and transverse segmentation along the pseudorapidity η. The central part
1.5 < η < 1.5 is housed in a separate barrel cryostat. The two
covering
end-caps cover the region of 1.5 <
< 2.5. The transverse momentum pT
y plane. The optimisation of the longitudinal and
is measured in the x
transverse segmentation of the calorimeter involves balancing performance
issues such as electron and photon identiﬁcation, position resolution, and pile-
up and electronic noise contributions against cost and technical constraints
such as routing of the signals from the calorimeter volume.

−

−

η

|

|

1 Visitor from LPHEA, FSSM-Marrakech (Morroco).
2 Now at university of Melbourne, Australia.
3 Now at Niels Bohr Institute, Copenhagen.
4 Deceased.
5 Also at KFKI, Budapest, Hungary. Supported by the MAE, France, the HNCfTD
(Contract F15-00) and the Hungarian OTKA (Contract T037350).
6 E-mail: roberto.sacco@cern.ch.
7 Now at Queen Mary, University of London.

3

The dominant backgrounds for the electrons and photons identiﬁcation arise
from the production of hadronic jets. The segmentations of the calorimeter [2],
sketched in Fig. 1, allow a measurement of the shower shape that are an
essential tool in background rejection. In addition, the rejection of spatially
isolated signals from high-pT π0’s coming from hadronic jet fragmentation is
especially important: ATLAS design goal calls for a factor of three rejection
of π0 at a single-photon eﬃciency of 90% .

−

At the LHC design luminosity, the beam spread in the z coordinate is about a
few centimetres. The beam spread contributes to the angular resolution of the
the γγ invariant mass. In order to minimise its eﬀects, the photon direction
has to be measured in η, with a resolution of about 50 mrad/
E(GeV). In the
φ direction, the interaction point is known with a precision of a few microns
y plane, and the azimuthal angle measurement is well constrained.
in the x
All this requires a ﬁne-grained position-sensitive device to perform angular
measurements and discriminate against the two merged photons from the π0
decay. This is done by segmenting the ﬁrst longitudinal sampling of the barrel
0.1 . For
(front compartment) into narrow cells of size ∆η
≃
the end-cap, the segmentation of the ﬁrst sampling is ∆η
0.003
0.006
with towers of size ∆η
(third) sampling.

−
0.1. The other two compartments (middle and back) are segmented
0.05) in the second

0.025 (0.025

∆φ = 0.025

0.003
∆φ

×
≃

∆φ

×

×

×

×

×

×

q

In this paper the performances of barrel and end-cap modules, with respect
to the η segmentation of their ﬁrst compartment, are presented. The results
are based on analyses of test-beam data taken in 2000 with barrel module 0
(for the π0 rejection calculation, section 4) and between 2001 and 2002 with
series modules.

2 Experimental setup

A detailed description of barrel and end-cap modules of the ATLAS elec-
tromagnetic calorimeter, and of the signal reconstruction techniques can be
found in Refs [3,4]. Two production modules, P13 for the barrel calorimeter
and ECC1 for the end-cap were tested in the CERN H6 and H8 beam lines
during several months of tests during 2001-2002. The test setup is similar to
the one described in Refs [3,4].

4

0

0.325

0.8

1.25

1.4 η

1.375

1.5

1.6

1.8

2.3

2.5

η

Fig. 1. Segmentation of barrel and end-cap electrodes.

2.1 Electron run setup

The calorimeter performance was tested using secondary or tertiary electron
and pion beams, with momenta ranging from 20 to 245 GeV/c for barrel mod-
ules and from 20 to 150 GeV/c for end-cap modules. The beam lines (Fig. 3)
were equipped with three scintillators (S1 to S3) in front of the calorimeter
for triggering purposes. Four multi-wire proportional chambers(BC1 to BC4)
allowed to determine the beam impact point at the calorimeter with a resolu-
tion of about 250 µm in the η direction. The size of the last two scintillators,
4 cm2, deﬁned the beam acceptance. Cryostats housing the modules were
4
mounted on remotely controlled rails that allowed movements in η and φ while
ensuring incident angles similar to the ones expected in ATLAS for all posi-
tions. A 3X0 lead absorber, a pion counter, a 5λI iron absorber and a muon
counter were placed downstream of the cryostat. η-scans were done at an elec-
tron energy of 245 GeV for the barrel and 120 GeV for the end-cap. Energy
scans at ﬁxed positions were also carried out.

×

5

Photons
Deflected electrons (E=50,180 GeV)
Electrons radiating a photon

Magnetic Field

Target

BC1 S1

BC3

S2

BC2

M

o

d

u

l

e

 

M

0

S3

Converter

Fig. 2. Photon beamline setup.

Virtual ATLAS IP

r
e
t
n
u
o
c
 
n
o
i
P

r
e
t
n
u
o
c
 
n
o
u
M

S1

S3

S4

BC1

BC2

BC3

BC4

3X   lead
 0 

5 λ  iron
I

η = 1,4

η = 0,6

η = 0

Fig. 3. Electron beamline setup.

2.2 Photon run setup

·

The calorimeter response to the incident photons was measured using the pro-
totype module M0. The beam line arrangement is illustrated in Fig. 2. Elec-
trons, with a momentum of 50 or 180 GeV/c impinged on a 0.1 X0 lead target
and produced bremsstrahlung photons. A 4 T
m magnet, placed downstream
of the target swept away the charged tracks from the photon trajectory. The
unaﬀected photon beam was incident on the module at an angle and position
corresponding to η = 0.69 and φ = 0.26 rad. A beam chamber, BC1, was
placed before the target and two more, BC2-BC3, downstream of the magnet,
in order to reject out of time counts. Beam trigger was provided by a coinci-
dence of signal from two scintillator counters S1 and S2. This second counter
could be displaced in the transverse direction with respect to the beam line
in order to trigger on deﬂected electrons of diﬀerent energy. A 1 X0 thick
converter, followed by scintillator S3 to detect photon conversions into e+e−
pairs, was placed in the photon beam to enrich the data sample of events in
which no more than one photon was present; its eﬀect is described more in
detail in section 4.5. The calorimeter was positioned 25 m downstream of the
It was found that about 0.3 X0 of material was present along the
target.
beamline and acted as additional source of photons [5]. In order to estimate

6

the amount of events for which more than one photon was present, a sample
of photons produced with the 180 GeV beam was also recorded without the
photon converter.

2.3 Pion run setup

Positively charged pion beams of 20 and 40 GeV/c momentum, provided by the
CERN H8 beamline, were used. The beam impinged on series barrel module
P15 of the calorimeter at ﬁxed incident angle and position corresponding to
η = 1.00 and φ = 0.28 rad. In addition to the usual test-beam setup, a
ˇCerenkov counter was placed in the beam line and ﬁlled with He gas at the
pressure of 10−1 bar. The momentum threshold for a pion to generate ˇCerenkov
light was 80 GeV/c and the counter provided an eﬃcient discrimination of
incident pions and electrons at 20 and 40 GeV/c beam momenta.

3 Position and polar angle resolution

The data were processed using the signal processing and pattern recognition
software EMTB [6] to calculate the position and polar angle resolutions. The
event energy and position were reconstructed using the optimal ﬁltering tech-
∆φ of 24
nique [7,8], with a cluster size ∆η
3 cells
for the middle layer. Random, muon- and pion-like events were discarded using
trigger and scintillator information. To correct for the energy loss upstream
of the calorimeter, the energy deposited in the presampler was weighted by a
factor α when calculating the total energy deposited (ECluster). Longitudinal
energy leakage induces a deterioration of the energy resolution, therefore a
weight β was also applied to the energy deposited in the back sampling:

1 cells for the front and 3

×

×

×

ECluster = αEPresampler + EFront + EMiddle + βEBack

(1)

The parameters α and β were obtained by minimising the energy resolution
for every η position [9].

3.1 Position resolution in the η direction

η-scans with cells at φ = 0.26 rad for the barrel and φ = 0.18 rad for the
end-cap were taken to study the variation of the position resolution in the
η direction. Cells for which no optimal ﬁltering coeﬃcients were available
were excluded from the analysis; the scanned region was therefore reduced to
2.40 (end-cap). In addition, cells in
0

1.14 (barrel) and 1.50

η

η

≤

≤

≤

≤

7

500

400

300

200

100

V
e
G
 
7
.
0
 
r
e
p
 
s
e
i
r
t
n
E

0
210

215

220

225

230

235

240

245

Energy (GeV)

Fig. 4. Typical energy distribution before the energy cut. The accepted window in
the distribution is shown by the vertical lines.

the barrel at φ = 0.28 rad, η = 0.34, 0.69 and 0.96, where a large number of
events was accumulated, were used to evaluate the variation of the position
resolution with respect to the impact point in the cell.

Pions in the beam are expected to deposit lower energy in the calorimeter
than electrons. In order to improve the pion rejection, it was required that
the peak value of the energy distribution ﬁtted (Fig. 4) to a Gaussian shape
with peak value Epeak and width σ is in the range
E)/σ < 3.
Additional constraints were imposed on the timing signal coming from the
four beam chambers to guarantee a good track reconstruction and rejection of
accidental background. Finally, the barycenters of the reconstructed showers
in η and φ were required to be within the central cell of a 3
3 cluster in the
middle compartment. About 12% of the events for the barrel module and 9%
of the events for the end-cap module remained after all these requirements.

2 < (Epeak −
−

×

The electron impact position of the beam particle on the calorimeter was
calculated performing a linear ﬁt through the points identiﬁed by the beam
chambers in each event. The resolution for each chamber, obtained from the
distribution of the residuals, was used to estimate the uncertainty in the track
extrapolation to the front face of the calorimeter. Fitted tracks were extrapo-
lated to the shower barycenter in both front and middle compartments. Except
in the case where the electron track originated at the virtual ATLAS interac-

8

tion point, the diﬀerent depths of the shower barycenters and the electrodes’
geometry resulted in diﬀerent extrapolated values of η in the front and middle
compartments. The chambers’ resolution was estimated to be about 250 µm
(i.e. 1.5

10−4 in units of pseudorapidity) for both beamlines.

×

Two methods were used to calculate the cluster η position in the calorimeter.

In the ﬁrst method, the position of an electron cluster in the samplings is the
energy-weighted average of the positions of the cells included in the cluster.
Due to the steeply falling lateral proﬁle of the EM shower, the ﬁnite gran-
ularity of the calorimeter induces a systematic shift of the measured shower
barycenter towards the centre of the cell. This eﬀect is stronger in the η di-
rection, while the energy sharing is larger in the φ direction because of the
accordion shape. In test-beam data, the shower barycenter position measured
by the calorimeter can be compared to the position measured by the beam
chambers. The resulting distortions of the measured positions were ﬁtted and
used to correct the barycenter position. The corrections depended on the beam
energy and the (η, φ) direction.

The second method took into account the exponential transverse proﬁle of the
shower. Here the average of the positions of the cells included in the cluster
was calculated by weighting the individual contributions with the logarithm
of the cell energy, according to [10]:

ηC =

i wiηi
i wi

,

P

(2)

P
where the index i runs over cells belonging to a given cluster in a compartment.
In this case,

wi = max(0, w0 + ln(Ei/EC)),
EC is the total energy deposited in a given compartment, and w0 is a parameter
that deﬁnes a minimum fraction of the shower energy in the cell and sets the
relative importance of the tails of the shower in the weighting procedure. With
this reconstruction the position distortion practically disappears and ηC can
be directly compared with ηBC without further corrections.

(3)

A comparison of ηC versus ηBC distributions for the cases of standard and
logarithmic weighting (LW) is presented in Fig. 5. Here, the value of w0 was
chosen such that it gives a minimum for the position resolution. For the barrel
module, the best value was found to be 2.0 for the front and 4.4 for the middle
compartment at φ = 0.26 rad. For the end-cap module, at φ = 0.18 rad in the
front compartment, the value of w0 was 2.2. A plot showing the variation of
the resolution for the front and middle compartments as a function of w0 at
φ = 0.26 rad is presented in Fig. 6.

In the middle compartment the accumulated statistics per cell was suﬃcient

9

*

C

η

0

0.4

0.3

0.2

0.1

-0.1

-0.2

-0.3

-0.4

3
0
1
 
x
 
.
l
o
s
e
r
 
s
p
i
r
t
s

0.28
0.26
0.24
0.22
0.2
0.18
0.16
0.14
0.12
0.1

Standard weighting
Logarithmic weighting

3
0
1
 
x
 
.
l
o
s
e
r
 
e
d
d
m

i

l

0.6
0.55
0.5
0.45
0.4
0.35
0.3
0.25
0.2

10

-0.4 -0.3 -0.2 -0.1

0.1

0.2

0.3

0.4

0
η

*
BC

Fig. 5. ηC versus ηBC distribution for standard and logarithmic weighting in the
barrel front compartment at η = 0.69, φ = 0.28 rad, E = 245 GeV. The bias in ηC
disappears when using formula 3 for the weighting and the points are distributed
along a line of unit slope.

1.8

2.2

2
W0

4.2 4.4 4.6
W0

Fig. 6. Variation of the η resolution for the front (a) and middle (b) compartment
as a function of the parameter w0 at φ = 0.26 rad, E = 245 GeV.

to perform a good ﬁt of the position distortion. It was found that the position
correction done using LW for the middle compartment gave results worse by
20 to 60% [11] at 245 GeV.

The case is diﬀerent for the front compartment; its ﬁner segmentation with
respect to the middle compartment implied a much smaller number of events
populating a given strip. The ﬁts were therefore more diﬃcult to perform and
only possible for the two strips nearest to the impact point of the electron.
For these strips it was found that the two weighting methods gave compara-
ble results. In order to analyse the highest possible number of strips, it was
decided to use the LW method to correct the reconstruction bias in the front
compartment.

3.1.1 Monte Carlo samples

GEANT3 simulation [12], adapted to reproduce ATLAS test-beam events,
was used to generate Monte Carlo samples for the barrel module. For each cell
φ = 0.26 rad, about 3000 events were generated. Three samples at φ = 0.28 rad
containing about 10000 events were also used to study cells for which a large
number of events was available at η = 0.34, 0.69 and 0.96. The Monte Carlo
samples were analysed with the EMTB package in which the clustering routine
was modiﬁed to take into account electronic noise and cross-talk. The cell noise
level for presampler, front, middle and back compartments was set to 45, 15,
30 and 25 MeV respectively. The cross-talk was set to 4.1% (1%) between
neighbouring front (middle) compartment cells. The comparison of the data
and Monte Carlo is illustrated in Fig. 7 and shows a good agreement.

3.1.2 Resolution calculation

For the middle compartment, the correction’s shape was ﬁtted to the function:

S(η∗

C) = P1 + P2 η∗

C + P3 arctan(P4 η∗

C),

(4)

where η∗
C is ηC normalised to the cell width, as illustrated in Fig. 7. For the
barrel, the ﬁt was performed to the Monte Carlo samples and the resulting
correction applied directly to the data. For the end-cap, the ﬁt was performed
directly to the data. The corrected value for the barycenter was then compared
ηBC distri-
with the one obtained by track extrapolation. The resulting ηcorr
bution was ﬁtted with a sum of two Gaussians, in order to take into account
the non-Gaussian tails due to residual accidental hits in the beam chambers,
as shown in Fig. 8. The parameters of the two Gaussians were deﬁned by

−

f (x) = P1 e−

1

2 ( x−P2

P3 )2

+ P4 e−

1

2 ( x−P5

P6 )2

.

(5)

11

Simulation
Data

Simulation
Data

-0.4 -0.2

0.2

0.4

0
η
*
C

-6
-0.4 -0.2

0.2

0.4

0
η
*
C

6

4

2

0

0
0
0
1
 
×
 

η
-

C

C
B

-2

η

-4

6

4

2

0

0
0
0
1
 
×
 

η
-

C

C
B

-2

η

-4

0
0
0
1
 
×
 

η
-

C

C
B

η

0
0
0
1
 
×
 

η
-

C

C
B

η

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

-0.4 -0.2

0.2

0.4

0
η
*
c

-6
-0.4 -0.2

0.2

0.4

0
η
*
c

Fig. 7. S-shape comparison between data and Monte Carlo for front (a) and middle
compartment (b) of a typical cell of the barrel module, at E = 245 GeV. The
corresponding plots for the end-cap module, at E = 150 GeV, are shown in plots
(c) and (d). The solid lines represent the S-shape ﬁt.

The resolution of the beam chambers was subtracted in quadrature. The re-
sults for the middle and front compartments are summarised in Fig. 9 for barrel
and end-cap modules. In the barrel, the position resolution for both compart-
ments does not have strong variation with η and agrees well with Monte Carlo
simulation. The ﬁner granularity of the front compartment results in a better
position resolution. Using the value of the resolution at small η for the barrel
and the appropriate extrapolation distance for the two compartments, it was
possible to estimate the resolution as 240 µm for the front and 540 µm for the
middle compartment. In the end-cap, the worsening of the resolution at large

12

4
-
0
1
 
r
e
p
 
s
e
i
r
t
n
e

350
300
250
200
150
100
50
0
-0.002 0 0.002
corr-η

BC

η

4
-
0
1
 
r
e
p
 
s
e
i
r
t
n
e

250

200

150

100

50

0

-0.002 0 0.002
corr-η

BC

η

Fig. 8. Double Gaussian ﬁt to the ηcorr
−
(a) and the end-cap (b) at 150 GeV. The parameters are deﬁned in equation 5.

ηBC distribution for the barrel at 245 GeV

η is expected and is due purely to geometrical eﬀects.

3.1.3 Resolution variation within a cell

Using the runs for which a large number of events was accumulated, it was
possible to check how the resolution varied within a single cell of the middle
compartment. After obtaining the correction from a ﬁt to the Monte Carlo
sample, the cell was divided into 10 slices in η and the correction applied.
Again, the ηcorr
ηBC distribution was ﬁtted for each slice to a sum of two
Gaussians, and the width of the narrower Gaussian was compared to the
prediction of Monte Carlo. The variation of the resolution across a single
cell is shown in Fig. 10 for the barrel module at η = 0.69, φ = 0.26 rad. As
expected, the resolution is better at the border of the cell because of the better
energy sharing among cells in the cluster; the lopsided symmetry is due to the
geometric shape of the cell and the variation of the amount of material along
η.

−

3.1.4 Resolution energy dependence

For the barrel module, several data samples were studied for a position η =
0.69, φ = 0.28 rad and at several diﬀerent beam energies in the range of 20 GeV
to 245 GeV. The η resolution was calculated as described in section 3.1.2, and
the resulting variation of the resolution for diﬀerent beam energy was ﬁtted

13

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

)
0
0
0
1
 
×
 
s
t
i

 

n
u
η
(
 

n
o

i
t

l

u
o
s
e
r
 
η

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

)
0
0
0
1
 
×
 
s
t
i
n
u
 
η
(
 
n
o
i
t
u
o
s
e
r
 
η

l

0.

0.23

0.45

0.68

0.91

1.14

η

0
1.5 1.6 1.7 1.8 1.9
η

2

2.1 2.2 2.3

Fig. 9. (a) η resolution as function of η, at φ = 0.26 rad, E = 245 GeV for the front
(squares) and middle compartments (triangles) of barrel module P13, superimposed
on the Monte Carlo prediction.(b) η resolution as function of η, at φ = 0.18 rad,
E = 150 GeV for the front (squares) and middle (triangles) compartments of the
end-cap module ECC1.

14

0
0
0
1
 
×
 
n
o
i
t
u
o
s
e
r
 
η

l

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0
0
0
1
 
×
 
n
o
i
t
u
o
s
e
r
 
η

l

1.4

1.2

1

0.8

0.6

0.4

0.2

0

Data
Simulation

-0.4

-0.2

0.2

0.4

0
η*

Fig. 10. Variation of η resolution across cell η = 0.69, φ = 0.28 rad, for the barrel
module P13, at E = 245 GeV.

Middle Compartment
Front Compartment

Middle Compartment
Front Compartment

25 50 75 100 125 150 175 200 225 250

20

40

60

80

100 120 140 160

Energy (GeV)

Energy (GeV)

Fig. 11. (a) η resolution as function of the beam energy for the middle (triangles)
and front (squares) compartment of barrel module P13 at η = 0.69, φ = 0.28 rad; the
results of the ﬁt are presented in Table 1. (b) η resolution as function of the beam
energy, at η = 1.74, φ = 0.18 rad for the middle (triangles) and front (squares)
compartments of end-cap module ECC1. The results of the ﬁt are presented in
Table 2.

with a function:

σ(E) = C1

C2
√E ⊕

C3
E

,

⊕
where E is the beam energy. The result of the ﬁt is presented in Fig. 11 and
Table 1. For the end-cap module, several samples were studied at η = 1.74, φ =
0.18 rad and diﬀerent energies in the range of 20 GeV to 150 GeV. The results
of the ﬁt are shown in Fig. 11 and Table 2.

(6)

0
0
0
1
 
×
 
n
o
i
t
u
o
s
e
r
 
η

l

1.4

1.2

1

0.8

0.6

0.4

0.2

0

15

C1

C2 (√GeV)

C3 (GeV)

Strips

(0.40

0.88)

(1.91

0.22)

(1.03

0.13)

Middle

(1.20

0.50)

(5.05

0.20)

(0.65

1.14)

10−3
10−3

×

×

±

±

10−2
10−2

×

×

Table 1
Parameters deﬁned in equation 6 for front and middle compartment of barrel module
P13.

C1

C2 (√GeV)

C3 (GeV)

Strips

(0.43

0.16)

(0.17

0.03)

(0.17

23)

Middle

(0.19

0.03)

(0.27

0.03)

(1.15

0.10)

10−2
10−2

×

×

10−4
10−2

×

×

±

±

Table 2
Parameters deﬁned in equation 6 for front and middle compartment of end-cap
module ECC1.

±

±

±

±

10−4
10−4

×

×

10−4
10−3

×

×

Middle+Back

±

±

±

±

Barycentre Front

(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
Barycentre Middle
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)

Z1

dZ

Z2

R2

dR

R1

θ=arctan(dR/dZ)

Z

Fig. 12. Schematic drawing of a barrel module in the Z, R plane and deﬁnitions of
related quantities.

3.2 Polar angle resolution

The knowledge of the shower barycenters in the ﬁrst two compartments of
the calorimeter allowed an extraction of the vertex position and the direction
of the incident electron, relying only on calorimeter information. These values
can be compared with values measured by the beam chambers (for the data) or
generated (for the simulation). The (Z, R) reference frame used in the following
is described in Fig. 12. Here, Z is the coordinate along the ATLAS beam line
and R is the radial coordinate with respect to the same beam line, found for
each cell in η using the extrapolation distance to the shower barycenter. The

16

Front

R

IP

E
 
√
×
)
d
a
r
m

(
θ

σ

80

70

60

50

40

30

20
0

data
simulation
simulation

data
simulation
simulation

20

17.5

15

12.5

10

7.5

5

2.5

)

m
m

(
 

Z

σ

0
0

0.23

0.45

0.68

0.91

1.14

η

0.23

0.45

0.68

0.91

1.14

η

Fig. 13. Angular resolution in θ times the square root of the beam energy (a) and
zvertex resolution (b) as function of η for barrel module P13, obtained using infor-
mation from the front and middle compartments at φ = 0.26 rad, at E = 245 GeV.

vertex position in Z is given by:

Z2

Zvertex
Z1

−
Z2

=

R2

R2

R1 ⇒

Zvertex =

−
The direction of the incident electron can be calculated as

−

Z1R2
R2

−
−

Z2R1
R1

.

θ = arctan

Z2 tan θ2
Z2

Z1 tan θ1
Z1

,

−
−

where θi are the angles pointing to the barycenter for the front and middle
compartment respectively. The polar angle resolutions were also calculated as
function of the beam energy using the energy scan at η = 0.69, φ = 0.28 rad
for the barrel and η = 1.74, φ = 0.18 rad for the end-cap. The resulting
resolutions are plotted in Figs. 13 and 14. For both barrel and end-cap, the
E(GeV), in good
measured polar angle resolution is in the range 50-60 mrad/
agreement with the design expectations.

q

4 π0 rejection

The π0 rejection is deﬁned as

at ﬁxed photon selection eﬃciency, where ǫπ0 is the pion selection eﬃciency, P0
and P the number of neutral pions before and after the selection requirements.
In the present analysis, the requirements were chosen such that the photon

R =

1
ǫπ0

=

P0
P

,

17

(7)

(8)

(9)

E
 
√
)
d
a
r
m

(
θ

σ

65

60

55

50

45

40

35

)

E
(
√
)
d
a
r
m

(
 

 
θ

σ

45

65

60

55

50

40

35

25 50 75 100125150175200225250
Energy (GeV)

20

40 60 80 100 120 140 160

Energy (GeV)

Fig. 14. Variation of the polar angle resolution with energy for barrel at
η = 0.69, φ = 0.28 rad (a) and end-cap at η = 1.74, φ = 0.18 rad (b).

selection eﬃciency on a pT = 50 GeV/c photon sample was 90%. As no π0
beam was available, a π0-like sample has been produced by superimposing
photons according to the kinematics of the π0 decay.

4.1 Event selection

In order to have a sample of photons as clean as possible, only runs taken
with the converter placed in the photon beam were used to compute the π0
rejection. To allow tagging, the electron had to hit the sensitive area of the
last two beam chambers. The rejection of accidental background and events
in which the electron showered before reaching the calorimeter was ensured
by the requirement that the signal coming from the beam chambers’ TDCs
be consistent with the passage of a single electron. About 30% of the events
satisﬁed all these requirements. To avoid shower overlap, the electron and
photon positions had to be separated by more than 3 cells in the middle
compartment (i.e. ∆η > 0.075). The sum of the photon and electron energies
had to be consistent with the beam energy, thus allowing the rejection of events
in which the photon was lost in the collimator. All these requirements reduced
the sample to 5% of its initial size. The rejection of most multi-photon events
(i.e. events for which more than one photon was present) was done using as
photon veto the scintillator S3 located downstream of the photon converter.
In ﬁg. 15 is shown the photon energy as function of the distance between the
photon and electron clusters for the two beam energies. Events more than
2.5σ away from the expected distribution were rejected. This last requirement
reduced the sample by an additional factor of 3. The energy for each strip was
corrected to take into account the 4.1% cross-talk described in section 3.1.1.
Finally, further multi-photon event rejection was achieved by requiring the

18

)

V
e
G

(
 
γ

E

25

20

15

10

5

0

80

60

40

)

V
e
G

(
 
γ

E

20

30

50

60

30

40

50

60

40
ηγ-η

e

ηγ-η

e

Fig. 15. Photon energy versus distance between photon and electron clusters, in strip
units, for beam energy of 50 GeV (a) and 180 GeV (b). The solid lines represent
the expected behaviour.

height of the second maximum in the strip energy distribution to be less than
200 MeV, value determined from Monte Carlo simulation (see section 4.3).
After all cuts, about 6450 photon events were kept in the sample.

→

In order to calculate the π0 rejection, pairs of test-beam photons were used to
build a π0
γγ decay, modelled according to a simple kinematic simulation
at pT = 50 GeV/c and η = 0.69. The simulation provided a set of kinematic
conﬁgurations, i.e., photon momenta in the laboratory reference frame. The
selection was performed in terms of energy and distance between the two
photons in the η direction. The energies had to match within
2 GeV with
the values expected from the kinematic simulation. Their relative distance had
to be within 0.03 strip widths in η. After this selection, the π0-like sample was
made by superimposing the two photons: their energy deposit was summed
strip by strip.

±

4.2 Monte Carlo samples

GEANT3 simulation [12], adapted to reproduce ATLAS test-beam events,
was used to generate a Monte Carlo photon sample, consisting of about 8000
events, at φ = 0.26 rad, η = 0.69 and in the energy range 0-70 GeV. A sample
of direct π0
γγ decays was also generated at φ = 0.26 rad, η = 0.69, pT =
50 GeV/c to check the consistency of the method described above.

→

These Monte Carlo samples were analysed with the EMTB package as de-
scribed in section 3.1.1. The cross-talk between strips was corrected for in the

19

data, but a consistency check was carried out by introducing cross-talk in the
simulated samples instead; the resulting agreement between data and Monte
Carlo for the γ/π0 separation was unchanged with respect to the standard
analysis.

4.3 π0 rejection calculation

Photons and neutral pions can be separated by analysing the shower shapes in
the ﬁrst sampling of the calorimeter in the region around the shower direction
0.025 cluster. A shower generated by a π0
deﬁned by a ∆η
is expected to be wider than a shower generated by a single photon, and may
have a second peak in its energy spatial distribution. Several discriminating
variables were deﬁned [2,13]:

∆φ = 0.075

×

×

shower width on n strips in strip units:

ωnst =

i Ei(i

imax)2

,

−
i Ei

s P

P

where i is an index running over the selected number of strips, imax the
strip corresponding to the maximum energy deposit (in the present analysis,
shower widths over 3 and 21 strips were considered, called w3st and w21st
respectively) ;
energy of the second maximum in the cluster, e2max ;
diﬀerence of the energy in the strip with the second maximum and the
energy deposit in the strip with the minimal value between the ﬁrst and
second maximum, edmax ;
energy deposited outside of the shower core,

•

•
•

•

eocore =

E(

±

3)
E(

1)

,

±

E(
1)

−
±

where E(
n) is the energy deposit in
strip with maximum energy deposit.

±

±

n strips around (and including) the

The distributions of the discriminating variables, for samples of real and sim-
ulated photons, are shown in Fig. 16. The choice of a cut at 200 MeV for
e2max, to reject multi-photon events, was justiﬁed by the data/simulation
discrepancy in the tails of both the e2max and edmax distributions; the π0
rejection on the simulated sample was not aﬀected by this requirement. As can
be seen in Fig. 16-e, due to the ﬁnite granularity of the detector, the width
calculated on 3 strips depends on the impact position of the photon within the
strip. This eﬀect was corrected by ﬁtting the distribution of w3st versus the
impact position of the photon within the strip, with a polynomial of degree 6;
the resulting w3st distribution is presented in Fig. 16-f.

20

10 3

10 2

10

V
e
M
 
0
1
 
r
e
p
 
s
e
i
r
t
n
e

1200

1000

800

600

400

200

V
e
M
 
0
2
 
r
e
p
 
s
e
i
r
t
n
e

0

0

0.8

0.75

0.7

0.65

0.6

0.55

)
s
p
i
r
t
s
(
 
t
s
3
w

0.5

0

0

0.05

0.1
e2max (GeV)

0.15

0.2

0

0.2
0.1
edmax (GeV)

0.3

MCMC
Data

MCMC
Data

0.2

0.4

0.6

0

1

2

3

4

5

eocore

w21st (strips)

MC
Data

MCMC
Data

MCMC
Data

MCMC
Data

10 3

10 2

V
e
M
 
0
1
 
r
e
p
 
s
e
i
r
t
n
e

10

1

s
p
i
r
t
s
 
2
.
0
 
r
e
p
 
s
e
i
r
t
n
e

2000
1750
1500
1250
1000
750
500
250
0

1200

1000

800

600

400

200

s
p
i
r
t
s
 
2
0
.
0
 
r
e
p
 
s
e
i
r
t
n
e

0

0

21

0.2 0.4 0.6 0.8
position in the strip

1

0.2 0.4 0.6 0.8
w3st (strips)

1

Fig. 16. Discriminating variables for test-beam and simulated photons: (a) energy
of second maximum e2max, (b) energy diﬀerence between the minimum in the
valley and the energy of second maximum edmax, (c) energy deposited outside the
shower core eocore, (d) shower width computed over 21 strips w21st, (e) shower
width computed over 3 strips w3st versus position in the cell and (f) w3st after
correction.

The same variables were calculated for the π0-like energy distributions, and are
presented in Fig. 17. In the case of direct π0 simulation (whose distributions
in Fig. 17 are labelled as ‘π0 MC’), the noise contribution was multiplied by
√2. It can be seen that, due to the separation between the two photons, the
average values for the distributions are larger for π0-like distributions than for
photon-like ones. For the present analysis, a π0 candidate was rejected when
the values of the discriminating variables were larger than the limits deﬁned
by the vertical lines in Fig. 17. Sets of cuts were determined by independently
varying the limit for each variable, while retaining 90% selection eﬃciency on
the single photon subsample with pT = 50 GeV/c. The set shown in Fig. 17
was the one that yielded the best π0 rejection.

The discrepancy between data and simulation, especially for the variables
eocore and w21st, can be explained by looking at the data/simulation com-
parisons for the lateral shower proﬁle. In Fig. 18 is shown that the agreement
is good for the shower core, i.e., the 3 strips around the maximum, but the
discrepancy increases with the distance from the maximum. The non-uniform
distribution of dead material located in the beam-line and not described in
the Monte Carlo might explain this discrepancy.

As only electron beam energy of 50 and 180 GeV were used to produce the
photon beam, the resulting photon energy spectrum was not uniform, but
showed a lack of photons with energy around 15 GeV, as detailed in Fig. 19.
This aﬀected the reconstruction of pions shown in Fig. 20-a, where the vari-
able min(Eγ1, Eγ2)/Eπ0, describing the energies of the photons coming from
the π0 decay, is plotted for data and simulation. The lack of photons in the
distribution for data is reﬂected by a large dip at 0.25: the π0 rejection was
therefore calculated in 6 bins of this variable, in the range 0 to 0.5.

4.4 Results

The photon eﬃciency was calculated for the photon sample at a pT = 50 GeV/c.
A bias in the calculation of the π0 rejection was introduced by the diﬀerent
starting points of the photon energy distributions for data and for the Monte
Carlo shown in Fig. 19. The number of photons is signiﬁcant only for energies
greater than 1 GeV in data, making it impossible to estimate the π0 rejection
for very asymmetric π0 decays, where one photon carries most of the pion en-
ergy. Assuming that the simulation correctly reproduces the photon spectrum
at low energy, the min(Eγ1, Eγ2)/Eπ0 distribution for data can be extrapo-
lated using the expected MC shape, and the rejection recalculated taking this
correction into account. The diﬀerence between the rejection calculated in
the second half of the ﬁrst bin of the min(Eγ1, Eγ2)/Eπ0 distribution and the
extrapolation to the full bin was -0.15.

22

0

0.2
0.4
e2max (GeV)

0.6

0

0.1
0.2
edmax (GeV)

0.3

MCMC
Data
π0 MC

MCMC
Data
π0 MC

MCMC
Data
π0 MC

MCMC

Data
π0 MC

10 3

10 2

10

V
e
M
 
0
2
 
r
e
p
 
s
e
i
r
t
n
e

700

600

500

400

300

200

100

s
p
i
r
t
s
 
6
1
.
0
 
r
e
p
 
s
e
i
r
t
n
e

0

0

0.2 0.4 0.6 0.8
eocore

1

0

0

2

4

w21st (strips)

10 3

10 2

V
e
M
 
0
2
 
r
e
p
 
s
e
i
r
t
n
e

10

1

300

250

200

150

100

50

V
e
M
 
0
2
 
r
e
p
 
s
e
i
r
t
n
e

0.8

0.75

0.7

0.65

0.6

)
s
t
i
n
u
 
l
l

e
c
(
 
t
s
3
w

0.55

0

MC

Data

MCMC
Data
π0 MC

s
p
i
r
t
s
 
2
0
.
0
 
r
e
p
 
s
e
i
r
t
n
e

500
450
400
350
300
250
200
150
100
50
0
0.2

23

0.2 0.4 0.6 0.8
position in the strip

1

0.4

0.6
w3st (strips)

0.8

1

Fig. 17. Discriminating variables for test-beam and simulated pions: (a) energy of
second maximum e2max, (b) energy diﬀerence between the minimum in the valley
and the energy of second maximum edmax, (c) energy deposited outside the shower
core eocore, (d) shower width computed over 21 strips w21st, (e) shower width
computed over 3 strips w3st versus position in the cell and (f) w3st after correction.
The vertical lines deﬁne the cuts on each variable.

Data

MCMC

1

n
o

i
t
c
a
r
f
 
y
g
r
e
n
e

-1

10

-2

10

-3

10

2

4

6

10 12 14 16 18 20

8
strip number

Fig. 18. Lateral shower proﬁle for data and simulation. The energy fraction for each
strip is plotted versus the strip number, the shower maximum being at strip number
11. The energy fractions have been normalised to the energy deposit in the 3 strips
around the maximum.

The distribution of the binned rejection factor is presented in Fig. 20-b. The
average value, obtained with a sample of 2300 reconstructed pions, was:

R =

= 3.54

0.12stat,

±

(10)

n

1
Ri

i

P

where n is the number of bins and Ri the rejection in each bin. This value
agrees with expectations in Ref [2].

The same procedure was applied to simulated photons. They were paired up
to reproduce the kinematic simulation, and the requirements were adapted to
take into account the diﬀerences between real and simulated distributions. In
particular, the cuts were varied in such a way that the same fraction of events
was kept after each cut in data and simulation, resulting in an overall photon
selection eﬃciency of (90
1)%. From the sample of 8000 simulated photons,
about 3600 π0 events were reconstructed. The rejection factor , calculated us-
ing the same binning as for data, was RMC = 3.66
0.10. The good agreement
of the calculated values of this rejection factor for the data and Monte Carlo
is shown in Fig. 20-b

±

±

24

Data
MC

60

50

40

30

20

10

0

0

0.5

1

1.5

2

2.5

400

350

300

250

200

150

100

50

V
e
G
 
2
 
r
e
p
 
s
t
n
e
v
E

0
0

10 20 30 40 50 60 70 80

Eγ (GeV)

Fig. 19. Photon energy spectrum for data and simulation. In the inset, the region
between 0 and 2.5 GeV has been enlarged and a diﬀerent binning has been used.

MC

Data

225
200
175
150
125
100
75
50
25
0
0 0.1 0.2 0.3 0.4 0.5
min(Eγ1,Eγ2)/Eπ

6

5

4

3

2

1

n
o
i
t
c
e
e
R

j

Data
MC

0
0 0.1 0.2 0.3 0.4 0.5
min(Eγ1,Eγ2)/Eπ

Fig. 20. a) min(Eγ1 , Eγ2 )/Eπ0 distribution and b) π0 rejection calculated in bins of
min(Eγ1, Eγ2 )/Eπ0, for data and simulation.

4.5 Systematic uncertainties

The impact of the cross-talk was studied by removing the 4.1% cross-talk
contribution described in section 4.1. The pion rejection degraded to R = 3.28,
in good agreement with expectations [14].

25

The residual contamination of multi-photon events in the data sample could
introduce a bias in the determination of the π0 rejection factor. As the amount
of matter before the target was not well known, the contamination could
be estimated by comparing the standard sample, in which the converter on
the photon beam was present, with another sample where the converter was
removed. Assuming that the distribution of events with a certain number of
photons is Poissonian, and knowing the converter thickness and, therefore, the
photon conversion probability, it is possible to estimate the fraction of multi-
photon events in both samples by comparing the absolute number of counts. It
was found that the sample without converter contained 72% of single photons,
23% of double photons, 5% of triple photons. For the sample with converter,
these fractions were 84%, 14% and 2% respectively. In principle, from these
ﬁgures it should be possible to extrapolate the value of the rejection to the
case without multi-photon contamination; in practice, due to the fact that no
runs without converter were taken at low energy, only a comparison for sub-
samples could be done. In fact, if one restricts the calculation of the rejection
0.5, both photons building the π0
to the region 0.4
come from the sample at high energy, for which the two setup conditions (with
or without converter) were present. The linear extrapolation to no background
coming from multiphotons induces a variation in the last bin of +0.6

min(Eγ1, Eγ2)/Eπ0

0.3.

≤

≤

±

Finally, the pairing of the photons to build a π0 was tested by calculating the
diﬀerence in rejection between the direct π0 simulation and the π0 Monte Carlo
sample obtained with the method described in section 4. To allow a direct
comparison between the samples, the noise level for the direct π0 simulation
was multiplied by a factor √2. The diﬀerence in the rejections was found to
be +0.23.

5 e-π separation

Electromagnetic showers initiated by electrons are expected to be fully con-
tained in the electromagnetic calorimeter. The hadronic showers start at a
larger depth of the module and there is often a substantial fraction of the
total energy shower leaking into the hadronic calorimeter. However, a frac-
tion of hadron-initiated showers may be fully contained creating a potential
for particle misidentiﬁcation. Therefore it is necessary to use the longitudinal
and lateral segmentation of the electromagnetic calorimeter to minimise pion
misidentiﬁcation as electrons while maintaining high electron identiﬁcation
eﬃciency.

26

5.1 Clustering and shower proﬁles

Data were analysed using the standard clustering procedure described in sec-
tion 3. The shape of the longitudinal shower proﬁle was contained in the infor-
mation of the energy Ei deposited in each layer of the calorimeter. Additional
information was contained in the lateral shower proﬁle, characterised by the
number of “hit” cells in each layer, NH(i), i.e. the number of cells that contain
energy above the noise level. For each cell the noise level was obtained using
the random trigger. The noise distribution was ﬁtted with a Gaussian function
and the noise level was given by the standard deviation of the ﬁt. It was found
to correspond to 44, 12, 32, 21 MeV respectively for the four samplings of the
calorimeter in this rapidity region. The minimum energy required for a cell to
register a hit corresponded to a 5σ cut above the noise level.

In this analysis, the number of hit cells in a given layer was calculated only
within the selected cluster. The number of hit cells is quite diﬀerent for elec-
trons and pions, for the 20 and 40 GeV/c beams, as shown in Fig. 21, and
may provide additional discrimination power.

Instead of total energy deposits in the calorimeter, ratios of the energy in
each individual layer to the total energy deposited in the cluster, Ei/ECluster,
were used. In general, the number of hit cells and the energy fraction in a
given layer are correlated. This correlation shown in Fig. 22 is weak. Thus the
number of hit cells provides additional information to a longitudinal proﬁle
analysis. The additional information allows for signiﬁcantly better pion rejec-
tion. Another variable used in the analysis is the fraction of energy deposited
in the shower core. To obtain it, the central cell of the middle sampling cluster
was projected onto the other layers, and the total energy E11 corresponding
to such calorimeter tower calculated. The fraction of energy deposited in the
shower core was then deﬁned as E11/ECluster.

5.2 Sample purity

To select the electron sample, the ADC counts from the ˇCerenkov counter
were required to be greater than 400, above the pedestal, Pion run samples
were normalised to the electron run samples with ADC counts less than 400
according to their total area. The tail of the ADC counts distribution of the
pion sample above 400 gave the maximum contamination in the electron sam-
ple. The purity of the electron sample was deﬁned as the number of electron
sample counts with pion contamination subtracted, divided by the number of
electron sample counts, and was found to be better than 99.9%.

The pion sample was selected by requiring the ˇCerenkov ADC counts to be

27

20 GeV number of hits for each layer

0

1

2

3

4

5

10

15

20

25

0

0

0

2

4

6

8

10

0

2

4

6

40 GeV number of hits for each layer

0

1

2

3

4

5

10

15

20

25

0

0

a

c

a

c

b

d

b

d

0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

0.35
0.3
0.25
0.2
0.15
0.1
0.05
0

0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

0.35
0.3
0.25
0.2
0.15
0.1
0.05
0

0

2

4

6

8

10

0

2

4

6

Fig. 21. Number of hit cells for 20 and 40 GeV/c electrons and pions for a) pre-
sampler, b) front sampling, c) middle sampling and d) back sampling of the EM
calorimeter. All plots are normalised to 1. Solid line stands for electrons and dashed
line stands for pions.

less than 400 for the pion run data, and its purity was calculated to be better
than 99% for all momenta.

5.3 Analysis strategy

The variables used in the analysis are the four energy fractions Ei/ECluster, the
fraction of energy deposited in the shower core E11/ECluster, and the number of
hit cells in each layer NH(i). Assuming that the track momentum p is known,

0.5

0.4

0.3

0.2

0.1

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

0.5

0.4

0.3

0.2

0.1

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

28

0.5

0.4

0.3

0.2

0.1

0

l

r
e
t
s
u
c
E
1
r
e
y
a
E

/

l

-0.1

-0.2

0

0.5

0.4

0.3

0.2

0.1

0

l

r
e
t
s
u
c
E
1
r
e
y
a
E

/

l

-0.1

-0.2

0

20 GeV e

20 GeV pion

10

20
5
Layer 1 Hit Cells

15

25

0

10

20
5
Layer 1 Hit Cells

15

25

40 GeV e

40 GeV pion

10

20
5
Layer 1 Hit Cells

15

25

0

10

20
5
Layer 1 Hit Cells

15

25

Fig. 22. Number of hit cells in the front sampling (Layer 1) vs ELayer1/ECluster for
20 and 40 GeV/c electron and pion samples.

one may use it as additional variable, and study e
of the same momentum.

−

π separation with samples

Two analysis methods [15] made use of the variables deﬁned so far. The ﬁrst
method was based on simple cuts to separate electrons of pion signals while
keeping the electron identiﬁcation eﬃciency at about 90%. The second method
relied on a Neural Network (NN) approach using the same variables. In partic-
ular, a multi-layer perceptron (MLP) with one hidden layer was used to build
the NN. Monte Carlo data were divided into three equal subsamples of a spe-
ciﬁc momentum and particle type, serving as NN training sample, veriﬁcation
sample and a testing sample. The number of neurons varied with the number
of input variables, following the rule of thumb that the number of hidden neu-
rons should be about twice the number of input variables. The neural network
results were stable when changing the number of hidden neurons. The error
of the output of the NN was checked to avoid over-training.

0.5

0.4

0.3

0.2

0.1

0

-0.1

-0.2

0.5

0.4

0.3

0.2

0.1

0

-0.1

-0.2

29

5.4 Results

The results are summarised in Tables 3 and 4 for analyses based on cuts
and Neural Network approach, applied to 20 and 40 GeV electron and pion
samples. The pion fake rates for ﬁxed electron eﬃciency of 90 % are compared
for the two methods. For the NN method, a single cut applied on the NN
output provides the result. For the cut method, the thresholds were varied
on all variables in order to minimise the pion fake rates while preserving the
electron identiﬁcation eﬃciency.

20 GeV with 90% electron eﬃciency Fake rate (CUT) Fake rate (NN)

Energy ratio

(6.88

0.27)%

(4.07

0.29)%

Energy ratio + hit cells

(3.18

0.18)%

(2.42

0.22)%

Ratio + hit cells + ECluster/p

(0.50

0.07)%

(0.34

0.08)%

Table 3
Results for 20 GeV samples using simple cuts (CUT) and Neural Network (NN)
methods.

40 GeV with 90% electron eﬃciency Fake rate (CUT) Fake rate (NN)

Energy ratio

(6.35

0.15)%

(3.52

0.14)%

Energy ratio + hit cells

(4.26

0.12)%

(1.88

0.10)%

Ratio + hit cells + ECluster/p

(0.38

0.04)%

(0.07

0.02)%

Table 4
Results for 40 GeV samples using simple cuts (CUT) and Neural Network (NN)
methods.

±

±

±

±

±

±

±

±

±

±

±

±

6 Conclusions

−

10−4 and 3.3

Test-beam data collected in the years 2000-2002 with pre-series and series
modules of the ATLAS EM barrel and end-cap calorimeter have shown that
the design goals in terms of position and polar angle resolution, π0 rejection
π separation can be reached. The position resolution along η was
and e
10−4 (in units of pseudorapidity)
measured to be about 1.5
for front and middle compartment respectively, allowing to achieve a polar
E (GeV). The π0 rejection,
angle resolution in the range 50
in test-beam conditions, was calculated to be 3.54
0.12stat for 90% photon
selection eﬃciency at pT = 50 GeV/c, with room for improvement when the
0.3) and
systematic errors from irreducible multi-photon background (+0.6
π0 building strategy (+0.23) are taken into account. Finally, the study of e
π
−
0.07)%
separation performed at 20 and 40 GeV yielded a fake rate of (0.50

60 (mrad)/

×

×

±

±

−

q

±

30

±

0.04)% with a simple cuts method, (0.34

0.02)%
and (0.38
with a Neural Network method, while maintaining in both cases 90% electron
identiﬁcation eﬃciency. Signiﬁcant improvement in e
π separation can be
achieved by using the lateral shape of the shower described by the number of
hit cells.

0.08)% and (0.07

−

±

±

Acknowledgements

We are indebted to our technicians for their contribution to the construction
and running of the barrel and end-cap modules and the electronics. We would
like to thank the accelerator division for the good working conditions in the
H6 and H8 beamlines. Those of us from non-member states wish to thank
CERN for its hospitality.

References

[1] R. Barate et al., “Search for the Standard Model Higgs Boson at LEP.” Phys.

Lett. B565:61-75,2003.

[2] ATLAS collaboration, ATLAS: Detector and Physics Performance; Technical
Design Report, Volume I and II, CERN LHCC-99-014 and LHCC-99-015.

[3] B. Aubert et al., “Performance of the ATLAS electromagnetic calorimeter end-

cap module 0.” Nucl. Instrum. Meth. A500:178-201,2003.

[4] B. Aubert et al., “Performance of the ATLAS electromagnetic calorimeter barrel

module 0.” Nucl. Instrum. Meth. A500:202-231,2003.

[5] S. Viret, “ATLAS electromagnetic barrel photon testbeam response compared

to GEANT4 simulation.” ATL-LARG-2004-011 (2004).

[6] R. Lafaye et al., “EMTB User Guide Version 1-9.” ATLAS documentation.

[7] W.E. Cleland and E.G. Stern, “Signal processing considerations for liquid
ionization calorimeters in a high rate environment.” Nucl. Instrum. Meth.
A338:467-497, 1994.

[8] L. Neukermans, PhD Thesis, Laboratoire d’Annecy-le-Vieux de Physique des

Particules (LAPP), 2002.

[9] D. Banﬁ, M. Delmastro, M. Fanti, “Energy resolution optimization through
layers measurements weighting: analytical solutions and numerical strategies.”
ATL-LARG-2002-002 (2002).

[10] T.C. Awes et al., “A simple method of shower localization and identiﬁcation in
laterally segmented calorimeters.” Nucl. Instrum. Meth. A311:130-138, 1992 .

31

[11] R. Sacco, “Position resolution of an ATLAS electromagnetic calorimeter

module.” ATL-LARG-2003-008 (2003).

[12] “GEANT: Detector Description and Simulation.” CERN Program Library Long

Writeup W5013.

[13] M. Wielers, “Isolation of Photons.” ATL-PHYS-2002-004 (2002).

[14] ATLAS collaboration, “Detector and Physics Performance Technical Design

Report.” CERN/LHCC 99-14 (1999).

[15] L. Liu, Y. Gao and R. Stroynowski, “e

π Separation in the Barrel
Electromagnetic Calorimeter with 2002 Test Beam Data.” ATL-LARG-2003-
013 (2003).

−

32

