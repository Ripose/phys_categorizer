5
0
0
2
 
r
a

M
 
1
 
 
]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[
 
 
1
v
1
0
0
3
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

BESII Detector Simulation

M. Ablikim a, J.Z. Bai a, Y. Ban b, J.G. Bian a, X. Cai a,
J.F. Chang a, H.F. Chen c, H.S. Chen a, H.X. Chen a,
J.C. Chen a, Jin Chen a, Jun Chen d, M.L. Chen a, Y.B. Chen a,
S.P. Chi e, Y.P. Chu a, X.Z. Cui a, H.L. Dai a, Y.S. Dai f,
Z.Y. Deng a, L.Y. Dong a,1, Q.F. Dong g, S.X. Du a, Z.Z. Du a,
J. Fang a, S.S. Fang e, C.D. Fu a, H.Y. Fu a, C.S. Gao a,
Y.N. Gao g, M.Y. Gong a, W.X. Gong a, S.D. Gu a, Y.N. Guo a,
Y.Q. Guo a, Z.J. Guo h, F.A. Harris h, K.L. He a, M. He i,
X. He a, Y.K. Heng a, H.M. Hu a, T. Hu a, G.S. Huang a,2,
X.P. Huang a, X.T. Huang i, X.B. Ji a, C.H. Jiang a, X.S. Jiang a,
D.P. Jin a, S. Jin a, Y. Jin a, Yi Jin a, Y.F. Lai a, C.G. Li a,3,
F. Li a, G. Li e, H.H. Li a, J. Li a, J.C. Li a, Q.J. Li a, R.Y. Li a,
S.M. Li a, W.D. Li a, W.G. Li a, X.L. Li j, X.Q. Li k, Y.L. Li ℓ,
Y.F. Liang m, H.B. Liao n, C.X. Liu a, F. Liu n, Fang Liu c,
∗, J. Liu b, J.P. Liu o, R.G. Liu a,

H.H. Liu a, H.M. Liu a,

Z.A. Liu a, Z.X. Liu a, F. Lu a, G.R. Lu p, H.J. Lu c, J.G. Lu a,
C.L. Luo q, L.X. Luo ℓ, X.L. Luo a, F.C. Ma j, H.L. Ma a,
J.M. Ma a, L.L. Ma a, Q.M. Ma a, X.B. Ma p, X.Y. Ma a,
Z.P. Mao a, X.H. Mo a, J. Nie a, Z.D. Nie a, S.L. Olsen h,
H.P. Peng c, N.D. Qi a, C.D. Qian r, H. Qin q, J.F. Qiu a,
Z.Y. Ren a, G. Rong a, L.Y. Shan a, L. Shang a, D.L. Shen a,
X.Y. Shen a, H.Y. Sheng a, F. Shi a, X. Shi b,4, H.S. Sun a,
J.F. Sun a, S.S. Sun a, Y.Z. Sun a, Z.J. Sun a, X. Tang a, N. Tao c,
Y.R. Tian g, G.L. Tong a, G.S. Varner h, D.Y. Wang a,
J.Z. Wang a, K. Wang c, L. Wang a, L.S. Wang a, M. Wang a,
P. Wang a, P.L. Wang a, S.Z. Wang a, W.F. Wang a,5,
Y.F. Wang a, Z. Wang a, Z.Y. Wang a, Zhe Wang a,
Zheng Wang e, C.L. Wei a, D.H. Wei a, N. Wu a, Y.M. Wu a,
X.M. Xia a, X.X. Xie a, B. Xin j,6, G.F. Xu a, H. Xu a, S.T. Xue a,
M.L. Yan c, F. Yang k, H.X. Yang a, J. Yang c, Y.X. Yang s,
M. Ye a, M.H. Ye e, Y.X. Ye c, L.H. Yi d, Z.Y. Yi a, C.S. Yu a,
G.W. Yu a, C.Z. Yuan a, J.M. Yuan a, Y. Yuan a, S.L. Zang a,

Preprint submitted to Nucl. Instr. and Meth. A

17 January 2014

Y. Zeng d, Yu Zeng a, B.X. Zhang a, B.Y. Zhang a, C.C. Zhang a,
D.H. Zhang a, H.Y. Zhang a, J. Zhang a, J.W. Zhang a,
J.Y. Zhang a, Q.J. Zhang a, S.Q. Zhang a, X.M. Zhang a,
X.Y. Zhang i, Y.Y. Zhang a, Yiyun. Zhang m, Z.P. Zhang c,
Z.Q. Zhang p, D.X. Zhao a, J.B. Zhao a, J.W. Zhao a,
M.G. Zhao k, P.P. Zhao a, W.R. Zhao a, X.J. Zhao a,
Y.B. Zhao a, Z.G. Zhao a,7, H.Q. Zheng b, J.P. Zheng a,
L.S. Zheng a, Z.P. Zheng a, X.C. Zhong a, B.Q. Zhou a,
G.M. Zhou a, L. Zhou a, N.F. Zhou a, K.J. Zhu a, Q.M. Zhu a,
Y.C. Zhu a, Y.S. Zhu a, Yingchun Zhu a,8, Z.A. Zhu a,
B.A. Zhuang a, X.A. Zhuang a, B.S. Zou a

(BES Collaboration)

aInstitute of High Energy Physics, Beijing 100049, People’s Republic of China
bPeking University, Beijing 100871, People’s Republic of China
cUniversity of Science and Technology of China, Hefei 230026, People’s Republic
of China
dHunan University, Changsha 410082, People’s Republic of China
eChina Center for Advanced Science and Technology(CCAST), Beijing 100080,
People’s Republic of China
f Zhejiang University, Hangzhou 310028, People’s Republic of China
gTsinghua University, Beijing 100084, People’s Republic of China
hUniversity of Hawaii, Honolulu, Hawaii 96822, USA
iShandong University, Jinan 250100, People’s Republic of China
jLiaoning University, Shenyang 110036, People’s Republic of China
kNankai University, Tianjin 300071, People’s Republic of China
ℓGuangxi University, Nanning 530004, People’s Republic of China
mSichuan University, Chengdu 610064, People’s Republic of China
nHuazhong Normal University, Wuhan 430079, People’s Republic of China
oWuhan University, Wuhan 430072, People’s Republic of China
pHenan Normal University, Xinxiang 453002, People’s Republic of China
qNanjing Normal University, Nanjing 210097, People’s Republic of China
rShanghai Jiaotong University, Shanghai 200030, People’s Republic of China
sGuangxi Normal University, Guilin 541004, People’s Republic of China

2

Abstract

A Monte Carlo program based on Geant3 has been developed for BESII detector
simulation. The organization of the program is outlined, and the digitization proce-
dure for simulating the response of various sub-detectors is described. Comparisons
with data show that the performance of the program is generally satisfactory.

Key words: Monte Carlo simulation, Detector response
PACS: 07.05.Tp

1 Introduction

To understand the intrinsic characteristics and performance of a detector, for
both detector design and physics analysis in experimental high energy particle
physics, reliable Monte Carlo (MC) simulation is essential.

The Beijing Spectrometer (BES [1,2]) detector started to take data in 1989 at
the Beijing Electron Positron Collider (BEPC), which operates in the center-
of-mass energy range from 2 to 5 GeV. The early simulation program was EGS
[3] based and thus did not generate hadronic interactions of the secondary
particles in the detector. Some eﬀects, like fake photons produced by hadrons,
were not properly described. For the detector response, simple parametric
models for sub-detectors were used in the simulation. As the program grew, the
hard-coded structure made it diﬃcult to maintain and make improvements.

With the upgrade of the BES detector (BESII) [4] and BEPC in 1996, the
development of a new Monte Carlo program, SIMBES, based on the Geant3
package [5], was begun. The decision was motivated by many reasons. First,
larger data samples require better detector simulation to reduce systematic un-
certainties. Second, some sub-systems of BESII were partly changed and some
totally new, and it was diﬃcult to make the required software changes within
the old program structure. Meanwhile, the Geant framework had proven to be

∗ Corresponding author

Email address: liuhm@ihep.ac.cn (H.M. Liu).

1 Current address: Iowa State University, Ames, Iowa 50011-3160, USA.
2 Current address: Purdue University, West Lafayette, Indiana 47907, USA.
3 Current address: 12175 Eastbourne Road, San Diego, California 92128, USA.
4 Current address: Cornell University, Ithaca, New York 14853, USA.
5 Current address: Laboratoire de l’Acc´el´eratear Lin´eaire, F-91898 Orsay, France.
6 Current address: Purdue University, West Lafayette, Indiana 47907, USA.
7 Current address: University of Michigan, Ann Arbor, Michigan 48109, USA.
8 Current address: DESY, D-22607, Hamburg, Germany.

3

a powerful tool for detector description and particle tracking in high energy
physics.

Geant3.21, the last version of Geant3, is used in SIMBES. Much eﬀort is made
to model the signal generation, since the digitization procedure is highly de-
tector dependent. BESII data is used for tuning parameters to describe the
detector response. Many physics channels are compared with data to check the
simulation, and the agreement is reasonably good. In this paper, the general
organization and features of SIMBES are described in Section 2. Detailed sim-
ulations of detector response, as well as comparisons with data, are presented
in Section 3.

2 The BESII Simulation Program - SIMBES

2.1 The BESII Detector

BESII is a conventional solenoidal magnetic detector that is described in de-
tail in Ref. [4]. A 12-layer vertex chamber (VC) surrounding the beam pipe
provides trigger and coordinate information. A 40-layer main drift chamber
(MDC), located radially outside the VC, provides trajectory and energy loss
( dE/ dx) information for charged tracks over 85% of the total solid angle. The
momentum resolution is σp/p = 0.017√1 + p2 (p in GeV/c), and the dE/ dx
resolution for hadron tracks is
8%. An array of 48 scintillation counters
surrounding the MDC measures the time-of-ﬂight (TOF) of charged tracks
200 ps for hadrons. Radially outside the TOF system is
with a resolution of
a 12 radiation length, lead-gas barrel shower counter (SC). This measures the
energies of electrons and photons over 80% of the total solid angle with an
energy resolution of σE/E = 22%/√E (E in GeV). Outside of the solenoidal
coil, which provides a 0.4 Tesla magnetic ﬁeld over the tracking volume, is
an iron ﬂux return that is instrumented with three double layers of counters
which identify muons with momentum greater than 0.5 GeV/c.

∼

∼

The geometrical and material descriptions of the detector are given in Section
3. The experimentally measured ﬁeld map is used in the simulation.

2.2 Program Structure

Built into the design of Geant is the separation of geometry, tracking, and
digitization. SIMBES respects this feature as illustrated in Fig. 1. In the ini-
tialization stage, three kinds of data ﬁles are loaded: the material and geometry

4

Initialization
Detector Definition

Geometry

Kinematics

Event Generator
(GENBES)

Tracking

Hits

Digitization

Trigger

Raw Data

Fig. 1. Schematic structure of SIMBES, dashed boxes mean optional.

conﬁguration data used to deﬁne the detector, the digitization constants to
describe the detector response, and the realization constants (such as dead
channels and wire eﬃciency) to simulate the real detector performance. Input
values of these parameters can be easily changed by experts or users using
control cards without relinking the program.

The BESII event generator package (GENBES) is a stand-alone program that
can be executed from within SIMBES to provide kinematic quantities for pri-
mary events. The generators for radiative QED processes [6], selected decays
of J/ψ, ψ(2S), and charmed meson pair production [7] were taken from other
experiments. The BES developed generators, LUND-CRM for inclusive decays
of J/ψ and ψ(2S) [8] and PPGEN for some exclusive decays of the ψ(2S), as
well as some standard generators like JETSET, are also included in GENBES.

At the end of each stage of processing (see Fig. 1), the intermediate output
(the geometry or hit information in the Geant data structure) can be saved
to a disk ﬁle, and used as input for later SIMBES execution. SIMBES code
structure is hierarchical and modularized. Therefore, each sub-detector stands
alone and can be turned on or oﬀ by the user. The BESII trigger logic is also
implemented in a single module; the user has an option to switch it on or oﬀ
when the digitization stage is ﬁnished. SIMBES is usually run in batch mode
to generate raw data and “MC-truth” data. The interactive mode is used for
graphic event display.

5

2.3 Tracking and Hits

The tracking of particles through the BESII detector is essentially done ac-
cording to the Geant standard. Tracking cutoﬀs and parameters are carefully
tuned for each sub-detector to provide a compromise between simulation pre-
cision and computing speed. To correctly simulate electromagnetic shower
development in the shower counter, the kinetic energy cutoﬀs of electrons and
photons have been set to Geant’s limit (10 KeV).

When a charged particle traverses a sensitive volume (a cell or readout chan-
nel), the hit information, such as the particle position, energy deposit, etc.,
are saved for the digitization procedure which is discussed in the next section.

2.4 Hadronic Interaction

For hadronic interactions, several models have been tried and compared with
BESII data; each has advantages for speciﬁc channels. Fluka [9] and Gcalor
[10] are the two hadronic models that users can choose in SIMBES.

Extra photons produced by hadronic interactions in the shower counter are
π+π−µ+µ− (only 4
studied by a very clean channel ψ(2S)
charged tracks in the ﬁnal state). The neutral tracks observed come mainly
from pion hadronic interactions in the SC material. Fig. 2 shows comparisons

π+π−J/ψ

→

→

a)

b)

7000

6000

5000

4000

3000

2000

1000

0

1

2

3

4

1

2

3

4

Nneu

Nneu

2. Number

Fig.
ψ(2S)
with (a) Fluka or (b) Gcalor, and points with error bars are for data.

neutral
for
the
π+π−µ+µ− decays. Histograms are for MC data

π+π−J/ψ

counter

shower

tracks

→

→

in

of

between data and MC data for diﬀerent hadronic packages. Gcalor reproduces
the number of neutral tracks in the SC better than Fluka.

7000

6000

5000

4000

3000

2000

1000

0

6

1600

1400

1200

1000

800

600

400

200

0

0

In Fluka, inelastic cross sections for anti-nucleon-nucleus annihilation are set to
zero if the anti-nucleon (¯n or ¯p) kinetic energy is below 50 MeV (corresponding
to a momentum of 310 MeV/c); this is, of course, not satisfactory for the
BEPC energy domain. Therefore, the parametrization given in [11] is used
instead to approximate the cross-sections for anti-nucleons at low momentum.
For other particles and for elastic cross-sections, standard Fluka is used. Fig.
3 shows the energy deposition in the SC for low momentum (less than 0.8

a)

b)

1

2

ESC

3
GeV

0

0

1

2

ESC

3
GeV

π+π−p¯p decays.
Fig. 3. Energy deposited by ¯p in the shower counter for J/ψ
Histograms are for MC data with (a) Fluka or (b) Gcalor, and points with error
bars are for data.

→

GeV/c) anti-protons for J/ψ
than Gcalor’s.

→

π+π−p¯p decays. Fluka’s simulation is better

3 Simulation of Detector Response

3.1 Vertex of event and Vertex Chamber

The location of the primary event vertex is determined by the interaction
point (IP) of the beam bunches, which varies with each beam collision. The
IP location and beam size distributions are obtained from experimental data
for diﬀerent running periods, and they are used to sample the primary vertex
in MC event generation. A T0 ﬂuctuation caused by the extended beam bunch
size is taken into account in the TOF simulation (see Section 3.3).

The vertex chamber (VC), which is built around the beryllium beam-pipe, is
composed of 12 layers of straw-tubes. Its hit (time) information is used for
the trigger. When a charged particle traverses a straw-tube, the minimum
distance between the track and the wire is taken as the drift distance and

1600

1400

1200

1000

800

600

400

200

7

140

120

100

80

60

40

20

0

0

smeared according to the wire space resolution. The drift time of the ioniza-
tion electrons is obtained by dividing the drift distance by an eﬀective drift
velocity. The wire eﬃciency and the wire sag due to gravity are also taken
into consideration in this calculation. The VC simulation is checked using the
decay J/ψ
KSKL [12], which may lose events in the VC trigger because of
the long decay length of the KS particles. The agreement between data and
MC simulation is good when the VC trigger is applied (Fig. 4).

→

a)

b)

0.1

LXY

0.2

m

0

0

0.1

0.2

LXY

m

Fig. 4. Comparison of the K 0
KSKL decays) decay length distribu-
tions between data and MC data. Histograms are for MC, and points with errors
for data (a) without the trigger and (b) with the trigger.

S (from J/ψ

→

3.2 Main Drift Chamber

The main drift chamber, which is used to determine trajectories and measure
energy losses of charged particles, is the main tracking detector of BESII. It
is cylindrical with 10 super layers with 4 sense wires (axial or stereo) in each
superlayer. The axial layer is described by Geant’s TUBE volume. For stereo
layers, the shape of the hyperbolic tube (HYPE) in Geant cannot reproduce
the geometry. Instead, the subtraction technique is used on two HYPEs for the
stereo-layer description. In the simulation, the wires (sense, ﬁeld and guard)
are not put into SIMBES individually, but an equivalent material inside the
MDC, taken as a mixture of gas and wires, is used.

The energy loss calculated by Geant for a thin layer is not used in simulating
the energy loss by charged tracks in the MDC. Instead, the energy loss (Q) at
a sense wire is simulated according to the distribution obtained from real data,
smeared with an experimentally determined Landau distribution. Fig. 5 shows
dE/ dx distributions for diﬀerent particles, where dE/ dx is the truncated
mean of the energy loss for each track.

140

120

100

80

60

40

20

8

C
D
A
 
x
d
E
d

/

4000

3000

2000

1000

0

0

2000

1500

1000

500

(a)

(b)

1

P                     GeV/c

c)

1

P                     GeV/c

d)

C
D
A
 
x
d
E
d

/

4000

3000

2000

1000

0

0

300

200

100

0

-5

0

5

0

-5

0

K

5

Fig. 5. Top: dE/ dx (pulse-height) versus momentum for (a) MC and (b) data.
Bottom: The χi (( dE/ dx)measured
( dE/ dx)expected)/σ) distributions for (c) π
(d) K particles from inclusive J/ψ decays. Histograms are for MC data, and points
with error bars are for data.

−

Using wire hit information, the minimum distance between a track and each
wire is calculated including the eﬀects of the Lorentz angle (αL = 26o) and
gravitational sagging of the wires. The drift distance of the ionization is taken
as the minimum distance and is smeared by the wire space resolution (σw). It
is observed from data that the residual of the drift distance is dependent on
Q, and even for a given Q, it cannot be simply ﬁtted with a single Gaussian
(see Fig. 6). Therefore, the drift distance is smeared according to a combined
distribution of two Gaussians (ﬁt from data) with the amount of smearing
determined by the Q value and tracking layer. The wire eﬃciency is included
in the σw simulation. When there are multiple hits in a cell, the time signal is
taken as the minimum drift time, while the pulse height is determined from
the sum of energy losses.

Fig. 7 shows momentum distributions (after track reconstruction) for data and
MC data. The comparison of momentum resolutions for data and Monte Carlo
is shown in Table 1. The pion tracking eﬃciency (see Fig. 8) for simulated

9

c
p
c
160
140
120
100
80
60
40
20
0

700
600
500
400
300
200
100
0

1000

800

600

400

200

(a)

(b)

-2

0

d

-2

0

d

2

mm

(c)

2

mm

(d)

-2

0

d

2

mm

-2

0

d

2

mm

Fig. 6. Distributions of drift distance residuals ∆d for diﬀerent pulse heights, Q,
corresponding to ADC counts of (a) 100-500, (b) 900-1100, (c) 1900-2100, and (d)
3700-4000. Points with error bars are from Bhabha events at the J/ψ, and curves
are ﬁts with combined distributions of two Gaussians.

1000

a)

b)

0

1

1.1

1.2

0

1

1.1

1.2

1.3

1.5
P              GeV/c

1.4

1.3

1.5
P              GeV/c

1.4

Fig. 7. Momentum distributions for (a) protons and (b) anti-protons from J/ψ
decay. Histograms are for MC, and points with error bars are for data.

→

p¯p

data is also found to be consistent with data. In general, an error of 2% per
track is taken as the systematic error from the tracking eﬃciency. Alternative
algorithms for the MDC wire resolution simulation have also been tested, and
their performances are slightly worse; however, they can be used to determine
the systematic uncertainties from the MDC wire resolution simulation.

1200
1000
800
600
400
200
0

160
140
120
100
80
60
40
20
0

800

600

400

200

10

D
D
D
D
Table 1
Comparison of momentum resolutions for data and Monte Carlo data.

Channel

σM C (MeV/c) σDT (MeV/c)

e+e−

µ+µ− at J/ψ

47.01

0.06

46.70

0.08

33.22

0.28

34.18

0.12

±

±

→
J/ψ

100

p¯p

→

±

±

DATA

MC

)

%

(

k
r
t

90

80

70

60

50

40

30

0

0.2

0.4

0.6

0.8

1

1.2

1.4

Pp

GeV/c

Fig. 8. π tracking eﬃciency in the MDC versus momentum. The ﬁrst three points
π+π−p¯p, and the others are from J/ψ
are from J/ψ

π+π−π0.

Λ¯Λ

→

→
3.3 Time of Flight System

→

The TOF system provides precise time measurements for particle identiﬁca-
tion and the trigger. It consists of two parts, the barrel (BTOF) and the
end-caps (ETOF). The BTOF, located just outside of the MDC, employs 48
scintillation counters with photo-multiplier tubes (PMT) at each end. Each
ETOF contains 24 scintillators with PMTs at one end. In SIMBES, the TOF
system is described simply by trapezoidal scintillator bars with small gaps
between adjacent ones.

After the track passes through the scintillator, the TOF hit information con-
tains the particle’s position, Z, at the entry point, its energy deposition, Eloss,
in the scintillator, and the time of ﬂight, Tf , from the IP. Eloss is determined
using energy loss with δ-ray generation and applying Birk’s law for saturation,
while for Tf , the time spread due to the sizable beam bunch is taken into ac-
count. A parameterized model is used to simulate the ADC and TDC outputs;
it assumes the light produced at the entry point propagates with attenuation
to the two ends. The amplitude and arrival time are obtained according to

Q = f

Eloss

exp(Z/Latte), T = Tf + Z/vc + Tc(Q, Z),

(1)

×

×

where f is a conversion constant, Latte the attenuation length (about 3m), vc

11

e
the eﬀective light velocity in scintillator, the last term in T is a correction
for Q and Z which is obtained from the calibration. The time walk eﬀect is
included in Tc.

ADC and TDC counts are generated by smearing Q and T according to their
resolutions, and a Q threshold is applied to the signal. The resolutions for
each counter are obtained using Bhabha events; in the smearing, the time
resolution dependence with amplitude and hit position is taken into account.
For multiple hits in a single counter, taking the time walk eﬀect as a good
approximation, only the hits with Q over threshold contribute to the TDC
count, while all pulse heights are summed to give the ADC count.

Fig. 9 shows the ∆T distributions for Bhabha and dimuon events, and the

a)

b)

16000

14000

12000

10000

8000

6000

4000

2000

0

-0.5

0
D T                ns

0.5

-0.5

0
D T                ns

0.5

Fig. 9. ∆T (Tmeasured
Texpected) distributions for (a) Bhabha and (b) dimuon events
at the J/ψ energy. Histograms are for MC data, and points with error bars are for
data.

−

pion particle identiﬁcation (PID) eﬃciency for the BTOF as a function of
momentum is shown in Fig. 10. The simulation is in a good agreement with
data, and an uncertainty of 1% per track is usually taken as the systematic
error for PID with the TOF.

3.4 Shower Counter

The shower counter consists of two parts, the barrel (BSC) and the end-
caps (ESC). In this section, BSC is taken as an example to demonstrate the
simulation procedure. The cylindrical BSC consists of 24 layers of gas tubes
interleaved with 23 layers of lead absorbers. There are 560 cells (tubes made
of Aluminum) in each gas layer. In order to reduce the number of electronic
readout channels, layers with the same φ angle are grouped into six readout
layers in the r direction. To save computation time, the absorber layer is

16000

14000

12000

10000

8000

6000

4000

2000

0

12

110

100

90

80

)

%

(

F
O
T

70

60

50

40

DATA

MC

0.2

0.4

0.6

1

1.2

1.4

1.6

0.8
Pp

GeV/c

Fig. 10. Pion identiﬁcation eﬃciency as a function of momentum for the TOF from
J/ψ

π+π−π0).

→

modeled using a mixture of Al-Pb-Al sandwiches as its material, while the
sensitive layer (cell) is ﬁlled with gas working in self-quenching streamer (SQS)
mode. The support ribs and some insensitive regions around them are properly
described in SIMBES.

When a charged particle hits a gas tube, the energy deposited (total charge)
is sampled according to the SQS spectrum which can be parameterized by a
Landau distribution. Corrections are made to this charge for the angle depen-
dence of the track and for diﬀerent layers. The pulse heights at the two ends
of the tube are derived by charge division, and the ﬁnal ADC outputs are
obtained by smearing the pulse heights with a Gaussian which accounts for
the contribution from the electronics. In the case of multiple hits in a tube, if
two hits are close enough, they are merged as one hit.

The simulated hit proﬁles (number of hits in diﬀerent layers) of an electro-
magnetic shower are in close agreement with data. Fig. 11 shows the energy
deposition (using Gcalor) in the BSC for diﬀerent particles after the energy
calibration with Bhabha events. Fig. 12 [13] shows the ratio of photon detec-
tion eﬃciency in the BSC for data and MC data. The comparison indicates
reasonable agreement, and 2% per photon is taken as the systematic error for
the photon detection eﬃciency.

3.5 Muon Counter

The muon identiﬁer is the outermost component of BES and is composed
of three layers of iron absorber and three layers of proportional chambers.
There are 189 chambers distributed in an octagonal structure, each chamber
consists of 8 proportional gas tubes which are arranged into two sub-layers.

13

e
0.04

0.03

0.02

0.01

0.1

0.05

0.15

0.1

0.05

0

0

0.5

1.5

1
EBSC

2

2.5

GeV

0.2

0.4

0.6

EBSC

GeV

0

0

0.25

0.5
EBSC

0.75

1
GeV

0

0

0.25

0.5
EBSC

0.75

1
GeV

b)

d)

f)

a)

c)

e)

0.15

0.1

0.05

0

0

0.1

0.075

0.05

0.025

0.08

0.06

0.04

0.02

0

0

0

0

0.25

0.5
EBSC

0.75

1
GeV

1

2

EBSC

3
GeV

Fig. 11. Particle energy deposited in the BSC, (a) and (b) for e and µ from Bhabha
and dimuon events at the J/ψ, (c) and (d) for π and K from inclusive J/ψ decays,
and (e) and (f) for p and ¯p from J/ψ
p¯p. Histograms are for MC data, and points
with error bars are for data.

→

The complex geometrical structure and magnetic ﬁeld [14] of the muon system
are well described in SIMBES.

In the simulation, the hit position (Z) along the tube is smeared by the res-
olution (obtained from data), the ADC signals at the two ends are obtained
from charge division of the energy deposit from Geant, and the wire eﬃciency
from data is also included. Fig. 13 shows the comparison of the hit positions
in the muon chamber for data and MC data. The agreement is satisfactory.

4 Summary

A Monte Carlo program SIMBES has been developed for BESII simulation.
Special eﬀorts are made to accurately simulate the response of the detector.
For each sub-detector, some key physics quantities are compared with BE-

14

1.1

1

C
M

T
D

/

0.9

0.8

0.7

0.6

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

Eg                                GeV

Fig. 12. The ratio of photon detection eﬃciency between data and MC (ǫDT /ǫM C)
π+π−π0 decays.
versus photon energy. ǫDT and ǫM C are calculated using J/ψ
The solid line is a ﬁt to the points.

→

(a)

1000

(b)

(c)

1000

750

500

250

0

800

600

400

200

0

400

200

750

500

250

0

800

600

400

200

400

200

(d)

(g)

-20

0
D x         mm

20

-20

0
D y         mm

20

0

-20

0
D z         mm

20

(e)

(f)

-20

0
D x         mm

20

0

-20

0
D y         mm

20

0

-20

0
D z         mm

20

(h)

(i)

1000

500

800

600

400

200

400

200

0

-20

0
D x         mm

20

0

-20

0
D y         mm

20

0

-20

0
D z         mm

20

Fig. 13. Hit position residuals for three Muon layers; the top, middle, and bottom
plots correspond to layers 1, 2, and 3, respectively. Muons are from e+e−
µ+µ−
at J/ψ events. Histograms are for MC data, and points with error bars are for data.

→

SII data to test the simulation quality. It is shown from many checks that the
overall performance of the current SIMBES is satisfactory and that the results
from simulation are generally consistent with data. On the other hand, there
is still room for further improvement. For example, the digitization of MDC
should be regarded as an ‘eﬀective’ simulation where many physics mecha-

15

e
e
nisms are hidden, and noise in the MDC is not considered at present.

The new Monte Carlo package (SIMBES) has signiﬁcant impact on physics
π+π−π0 measured by
results. As an example, the branching ratio of J/ψ
0.12)% [15], which is signiﬁcantly higher than the PDG value
BES is (2.10
of (1.50
0.20)% [16]. In this measurement, it is found that the eﬃciency
using a two-Gaussian resolution function in the MDC wire simulation is about
20% lower than that using a single Gaussian function, and that the eﬃciency
including hadronic interactions is about 10% lower than without them.

→

±

±

Acknowledgements

We would like to thank Dr. S. Banerjee for helpful discussions and suggestions.
We also acknowledge the contribution of many other past members of the BES
Collaboration. This work is supported in part by the National Natural Science
Foundation of China under contracts Nos. 10491300, 10225524, 10225525, the
Chinese Academy of Sciences under contract No. KJ 95T-03, the 100 Talents
Program of CAS under Contract Nos. U-11, U-24, U-25, and the Knowledge
Innovation Project of CAS under Contract Nos. U-602, U-34 (IHEP); by the
National Natural Science Foundation of China under Contract No. 10175060
(USTC), and No. 10225522 (Tsinghua University); and by the Department of
Energy under Contract No. DE-FG02-04ER41291 (U Hawaii).

References

[1] J.Z. Bai, et al. (BES Collab.), Nucl. Instr. and Meth. A 344 (1994) 319.

[2] Ding Hui-Liang, et al. (BES Collab.), HEP & NP 16 (1992) 769.

[3] W.R. Nelson, H. Hirayama and D.W.O. Rogers, The EGS4 Code System,

SLAC-265, 1992.

[4] J.Z. Bai, et al. (BES Collab.), Nucl. Instr. and Meth. A 458 (2001) 627.

[5] CERN Program Library Long Writeup W5013, CERN, 1993.

[6] The generators, written by F.A. Berends et al., include the processes of radiative

Bhabha, radiative muon pair and radiative two photons.

[7] The generators were originally developed by the MARKIII Collaboration.

[8] J.C. Chen, et al., Phys. Rev. D 62 (2000) 034003.

[9] A. Ferrari, P.R. Sala, G. Guaraldi and F. Padoani, Nucl. Instr. Meth. B 71

(1992) 412.

16

[10] C. Zeitnitz and T.A. Gabriel, Nucl. Instr. and Meth. A 349 (1994) 106.

[11] M. Astrua, et al. Nucl. Phys. A 697 (2002) 209.

[12] X. Shi, et al., HEP & NP 28 (2004) 982.

[13] S.M. Li, et al., HEP & NP 28 (2004) 859.

[14] Z. Wang, et al., HEP & NP 27 (2003) 716.

[15] J.Z. Bai, et al. (BES Collab.), Phys. Rev. D 70 (2004) 012005.

[16] Particle Data Group, S. Eidelman,et al., Phys. Lett. B 592 (2004) 60.

17

