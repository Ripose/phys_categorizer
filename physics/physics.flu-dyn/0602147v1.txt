6
0
0
2
 
b
e
F
 
1
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
7
4
1
2
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Magnetohydrodynamic activity inside a sphere

Pablo D. Mininni1 and David C. Montgomery2
1 National Center for Atmospheric Research, P.O. Box 3000, Boulder, Colorado 80307 and
2 Dept. of Physics and Astronomy, Dartmouth College, Hanover, NH 03755
(Dated: February 21, 2014)

We present a computational method to solve the magnetohydrodynamic equations in spherical
geometry. The technique is wholly spectral and uses an expansion basis that is adapted to the
geometry: the Chandrasekhar-Kendall vector eigenfunctions of the curl. In this work, simulations
for isolated spheres are presented, although diﬀerent boundary conditions can be studied using the
same method. The intent is to be able to study those aspects of the nonlinear dynamical evolution
that are aﬀected by the spherical geometry at moderate Reynolds number. The parallel code
preserves with high accuracy the ideal invariants of the system. Examples of results for selective
decay and dynamo simulations are discussed.
In dynamo simulations, spontaneous ﬂips in the
direction of the magnetic ﬁeld are observed.

PACS numbers: 47.11.-j; 47.11.Kb; 91.25.Cw; 95.30.Qd

I.

INTRODUCTION

Magnetohydrodynamic “dynamo” processes are those
in which the motions of an electrically conducting ﬂuid
amplify and maintain a ﬁnite magnetic ﬁeld, starting
from an arbitrarily small one. They have long been of
interest for geophysics and astrophysics [1, 2, 3, 4, 5, 6],
and have more recently become of interest with regard
to laboratory attempts to generate dynamo magnetic
ﬁelds in liquid metals [7, 8, 9, 10, 11, 12]. The relevant
theoretical and computational literature is vast, and ex-
tensive reviews have recently been given (see e.g. Refs.
[4, 13, 14, 15]).

In our own work, we have lately been studying dynamo
processes numerically, using turbulent three-dimensional
magnetohydrodynamic (hereafter, “MHD”) codes of the
familiar Orszag-Patterson pseudospectral variety [16, 17,
18, 19, 20]. Such codes treat homogeneous turbulence
eﬃciently, but are mainly useful in situations involving
spatially periodic boundary conditions. Particularly for
the case of planetary dynamos and laboratory experi-
ments, restrictions to periodic boundary conditions are a
severe limitation. Essential ingredients, such as rotation,
global angular momentum, and the interfaces between
conducting and non-conducting regions are not readily
included.
It is to be expected that all of these play a
role in the physical situations of interest, and give rise to
qualitatively new physical processes not accessible with
periodic boundaries.

This present paper represents our attempt to begin
a study of these processes by introducing, and display-
ing some results from, a computational method that is
adapted to the geometry of isolated spheres. Our goal
is not to reach realistic geophysical parameter regimes
(out of the question for the foreseeable future, in any
case), but rather to isolate and study those new physical
processes that appear in this geometrically more realis-
tic setting. Our eﬀorts are to be distinguished from such
impressive geo-dynamo computations as those of Glatz-
maier and Roberts (e.g. Refs. [2, 21]), the goal of which

has been and is the reproduction of observational char-
acteristics of the magnetic ﬁeld of the Earth. Such com-
putations must resort to modeling some of the processes
involved in order to cope with the necessarily coarse res-
olution. We will consider it to be no limitation on our
present computations if we are unable to reach realistic
geophysical Reynolds numbers, for example. We think
of these eﬀorts as studies of MHD dynamo behavior in
spherical geometry somewhat in the abstract, with an
emphasis on ﬂexibility and clarity, and intending to ex-
amine eﬀects that have not been explored in this way
before.

The technique is wholly spectral, using an expansion
basis that is speciﬁcally adapted to spherical geome-
try: the Chandrasekhar-Kendall (hereafter, “C-K”) vec-
tor eigenfunctions of the curl [22, 23, 24, 25, 26]. We be-
lieve these to be complete for solenoidal vector functions,
but a proof has only been given for the cylindrical case
[25]. Some years ago, we found C-K functions to be useful
for computing nonlinear MHD behavior inside a conduct-
ing periodic cylinder and for studying processes believed
to be involved in disruptions of fusion conﬁnement de-
vices [27, 28, 29, 30, 31]. Their advantages lie mainly in
their natural geometrical relation to processes that can go
on in the speciﬁc geometries to which they are adapted,
and in the fact that boundary conditions can be built
into the individual expansion functions themselves, and
so require no further numerical eﬀort to enforce. It will be
noticed that far more periodic Fourier coeﬃcients would
be necessary, for example, to resolve the processes we will
exhibit than coeﬃcients required by the C-K Galerkin ex-
pansion. The principal disadvantage is that the size of
the convolution sums generated by the nonlinear terms
in the MHD equations grows rapidly with the resolution.
This is precisely the diﬃculty that periodic pseudospec-
tral codes were designed to remedy. But we have no
“fast” transforms for the spherical Bessel functions that
arise, and this limitation must be regarded as a trade-oﬀ
against the geometric realism and the ease of satisfying
boundary conditions. We further remark that diﬃcul-

ties associated with singularities at r = 0 in spherical
polar coordinates largely disappear when the C-K basis
is used. We have noted this convenience previously in
solutions to the two-dimensional Navier-Stokes equation
inside a circle with no-slip boundaries [32, 33]. Further-
more, the code may be readily parallelized, there are no
potential aliasing problems, and the accuracy with which
the Galerkin approximations can preserve ideal invari-
ants is a great advantage when attempting long-duration
runs.

An outline of the paper is as follows. Section II intro-
duces the expansion basis and shows how the nonlinear
partial diﬀerential equations can be reduced to a set of
ordinary diﬀerential equations for the expansion coeﬃ-
cients. We include a mention of the possible boundary
conditions that could be introduced before settling on one
set to illustrate the operation of the code. Some numer-
ical subtleties are discussed in Section III. Sections IV
and V illustrate the ﬁrst applications of the code to some
MHD problems we consider interesting and that are pe-
culiar to spherical geometry. Section VI summarizes the
results and discusses possible future applications of the
method.

II. THE SPECTRAL DECOMPOSITION

C-K functions are constructed from a solution of the

scalar Helmholtz equation:

2 + λ2

ψ = 0,

∇
(cid:0)

(cid:1)

(1)

where we are referring to spherical polar coordinates
(r, θ, φ) and λ is an eigenvalue that will eventually be
determined by boundary conditions. Vector eigenfunc-
tions of the curl appropriate to spherical geometry may
be constructed according to the recipe

J = λ

rψ +

(
∇ ×

rψ) .

(2)

∇ ×

∇ ×
J = λJ.
From this, it may readily be veriﬁed that
Thus any single J is a “force-free” or “Bernoulli” ﬁeld,
though the sum of two or more of them is not. The
relevant scalar ψ is

∇ ×

(3)

r)Ylm(θ, φ).

λql|
ψqlm = Cql jl(
|
Here, Cql is a normalization constant, jl is a spherical
Bessel function of order l, and Ylm is the normalized
spherical harmonic expressed in terms of the polar angle
θ and the azimuthal (longitudinal) angle φ. The number
J∗
Cql is chosen to make the volume integral of Jqlm ·
qlm
over the computational domain equal to unity (the aster-
isk denotes complex conjugate). The explicit expression
for Cql in a sphere of radius R is

Cql =

λql|
λql jl+1(
|
|

−1
R)
|
The integer l is 1, 2, 3, . . . and m runs in integer steps
l to l. An inﬁnite sequence of values of λql, labeled

l(l + 1)R3

(4)

(cid:2)

(cid:3)

.

−1/2

from

−

2

−

−

1,

2,

by q = 1, 2, 3, . . . and q =
3, . . . is determined
−
by an appropriate radial boundary condition on J for a
given l; λql may be positive or negative, and this deter-
mines the sign of the helicity of any given eigenfunction.
Positive or negative q is to be associated with positive
or negative λql according to λ−q,l =
λql. For a variety
of radial boundary conditions, the Jqlm functions cor-
responding to diﬀering indices q, l, or m can be shown
to be orthogonal. Boundary conditions at two diﬀerent
radii can be imposed if spherical Neumann functions are
also permitted in ψ. It is believed that the J functions
constitute a complete set for solenoidal vector functions,
though the result has only been proved for cylindrical
geometry.

−

Assuming the completeness of the C-K functions so
deﬁned, they are then appropriate for expanding various
vector ﬁelds of incompressible MHD: the magnetic ﬁeld,
ﬂuid velocity, vorticity, electric current density, and vec-
tor potential in the Coulomb gauge. We consider these to
be the most important set of functions for spherical MHD
and planetary dynamos in the class of problems we want
to study. The ones of slowest spatial variation (smaller
q, low l and m) contain the dipole and low-order multi-
pole components of the ﬁelds and so, like Fourier series,
provide a natural ordering of the spectral contributions
from various spatial scales. The components of highest
relative helicity are also included in these modes of least
spatial variation. They may be matched on to external
vacuum magnetostatic ﬁelds. In principle, they contain
all the contributions to the ﬁelds from the largest spa-
tial scales to the smallest; but unlike Fourier series, the
larger spatial scales have a natural representation in the
geometry of the physical system we wish to represent.

The MHD equations to be solved are, in familiar di-
mensionless (“Alfv´enic”) units, an equation of motion for
the ﬂuid velocity v,

∂v
∂t

= v

ω + j

B

×

×

− ∇ (cid:18)P

+

v2
2 (cid:19)

+ ν

2v + f ,

(5)

∇

and the induction equation for advancing the magnetic
ﬁeld B,

∂B
∂t

=

(v

B) + η

∇ ×

×

2B,

∇

(6)

P

Here,
is the dimensionless ratio of pressure to density
(the mass density is assumed spatially uniform), and j is
B. A forcing function
the electric current density, j =
f has been written on the right hand side of Eq.
(5)
to represent any externally applied mechanical force, a
frequent convention in dynamo-motivated computations.
Both B and v are divergenceless. The vorticity ω is the
curl of v, and an evolution equation for it can be obtained
by taking the curl of Eq. (5):

∇×

∂ω
∂t

=

(v

ω) +

(j

B) + ν

2ω +

f . (7)

∇ ×

×

∇ ×

×

∇

∇ ×

With appropriate boundary conditions, the vorticity
ω determines the velocity v. The dimensionless viscosity

ν and magnetic diﬀusivity η can be interpreted, respec-
tively, as reciprocals of kinetic and magnetic Reynolds
numbers, where the relevant velocity might be the rms
value of v and the relevant length might be the energy-
containing scale of v (to be deﬁned below).

The numerical scheme is to solve Eqs. (5) or (7) and
(6) by representing v and B as the Galerkin expansions,

v(r, t) =

ξv
qlm(t)
λql

Jqlm(r)

(r

R)

≤

B(r, t) =

ξB
qlm(t) Jqlm(r).

Xqlm

Xqlm

(8)

(9)

Here, the unknowns are the complex, time-dependent ex-
pansion coeﬃcients ξv

qlm and ξB

qlm.

Next, we may substitute Eqs. (8) and (9) into Eqs.
(6) and (7), say, and take inner products one at a time
with the functions Jq′l′m′. Using their orthonormality,
the dynamical equations become

∂ξv
i
∂t

∂ξB
i
∂t

=

=

Xj,k (cid:0)

Xj,k

Ai

jkξv

j ξv

k + Bi

jkξB

j ξB
k

νλ2

i ξv

i + ξf

i (10)

−

(cid:1)

Ci

jkξv

j ξv

k −

ηλ2

i ξB
i .

(11)

The indices i, j, k are regarded as shorthand; each one
of them represents the triple of numbers q, l, m neces-
sary to identify a single member of the family of the C-K
functions Jqlm. The sum is over all the values retained
in the Galerkin expansion. As previously mentioned, the
C-K functions will become orthogonal after imposing the
boundary conditions. Boundary conditions diﬀerent than
the one studied here may also lead to an orthogonal set
of Jqlm.

jk, Bi

jk, and Ci

The nonlinearities, both in the original partial diﬀeren-
tial equations and in the ordinary diﬀerential equations
(10) and (11), are quadratic. The kinematic coupling co-
eﬃcients (which do not contain the ξ) Ai
jk,
are numerical integrals of considerable complexity. Their
evaluation and storage as a table is one of the most de-
manding parts of the computation, and some features of
that evaluation are described in Section III. On the right
hand side of Eq. (10), we have represented the forcing
function f , if any, by its expansion over the retained C-K
functions. The coeﬃcients ξf , if non-zero, are to be re-
garded as known, possibly time-dependent functions that
may excite the velocity ﬁeld, and may stand for a variety
of possible mechanical processes.

It remains to specify the set of boundary conditions
we are using, thereby determining the λql. We demand
that the radial components of v, ω, B, and j shall vanish
at the radius r = R. This boundary at r = R is being
regarded as a perfectly conducting spherical shell, coated
on the inside with a very thin layer of insulating dielec-
tric. It is impenetrable, as evidenced by the vanishing of
the normal component of v. The vanishing of the normal

3

FIG. 1: Speed-up of the code in two Linux clusters in parallel
simulations with max{q} = max{l} = 7. The dotted line
indicates the ideal scaling.

component of ω is implied by, but does not imply, no-
slip boundary conditions on v. It is a limitation of this
method (and many others) that the satisfaction of no-
slip boundary conditions introduces very complex con-
siderations into the development. We consider that the
fact that these complexities are present in much simpler
problems and remain controversial there gives us license
not to attempt no-slip boundaries in the present situa-
tion, though we mean to consider a variety of boundary
conditions in later papers.

The vanishing of the normal components of all four of
the vector ﬁelds, term by term, at r = R is achieved by
choosing the λql so that

R) = 0

λql|
jl(
|
which determines the doubly-inﬁnite sequence of λql val-
ues. Each solution to Eq. (12) has associated with it the
values λql and
λql. These will be distinguished by the
choice of sign of the identifying index q.

(12)

−

With these boundary conditions, the coupling coeﬃ-

cients reduce to

Ai

jk = Ci

jk =

I i
jk ,

Bi

jk = λiλjI i

jk ,

(13)

λi
λj

where

I i
jk =

J∗
i ·

(Jj ×

Z

Jk) d3x.

(14)

III. NUMERICAL METHOD

Equations (10) and (11) are solved numerically with
double precision in a sphere of radius R = 1. The ex-
pansion coeﬃcients ξ are in general complex, and since
the ﬁelds are real, the coeﬃcients satisfy the condition

1)mξ∗

qlm. As a result, only the coeﬃcients
ξq,l,−m = (
for non-negative values of m are stored and evolved in
time.

−

−

Before the simulation is started, for a given resolution
in q and l (and all possible values of m) all required val-
ues of the normalization coeﬃcients Cql are computed
using Eq. (4) and stored. The values of λql are com-
puted numerically as the roots of the spherical Bessel
functions [see Eq. (12)] using a combination of bisection
and Newton-Raphson [34]. Finally, the coupling coeﬃ-
cients I i

jk are computed and stored.

The coupling coeﬃcients are complex, and from Eq.
(14) satisfy the relation I i
I i
kj . The integral in Eq.
jk =
(14) is separable in spherical coordinates. In the φ direc-
mj;
tion, the integral reduces to the condition mk = mi −
in any other case the coupling coeﬃcients I i
jk are zero.
The radial integral reduces to seven integrals involving
three spherical Bessel functions or their derivatives, and
the integral in the polar angle reduces to seven integrals
on three Legendre functions and their derivatives. Ra-
dial integrals are computed numerically with high preci-
sion using Gauss-Legendre quadratures, while integrals
in θ are computed using Gauss-Jacobi quadratures [34].
Due to symmetry properties of the Legendre functions,
all coupling coeﬃcients with li + lj + lk + mi + mj + mk
even are purely real, while the remaining coeﬃcients are
purely imaginary, another property that can be used to
save memory.

Once tables containing all these values are stored, the
evolution of the system reduces to solving the set of or-
dinary diﬀerential equations deﬁned by Eqs.
(10) and
(11). These equations are evolved using a Runge-Kutta
method of fourth order [35]. The MHD equations have
three quadratic ideal invariants: the total energy E, the
magnetic helicity H, and the cross helicity K. In spectral
space the invariants can be computed as

+

2
ξB
i |
|

(cid:19)

,

E =

H =

K =

1
2 Xi
1
2 Xi
1
2 Xi

2
ξv
i |
|
λ2
i

(cid:18)

,

2
ξB
i |
|
λi
i ξB∗
ξv
i
λi

.

(15)

(16)

(17)

q

The conservation of these quantities up to the numerical
precision serves as a test of the code and have been veri-
ﬁed in simulations with ν = η = 0. In a simulation with
max
= 5, the invariants were conserved up
to the sixth decimal place after 200 turnover times. The
turnover time is deﬁned as T = L/U where L is a char-
acteristic length (L
R = 1 for these tests) and U is the
rms velocity.

= max

≈

}

{

{

}

l

The system is evolved entirely in spectral space and all
global quantities are also computed spectrally. To obtain
representations of the ﬁelds in conﬁguration space, Eqs.
(8) and (9) are used.

The reciprocal of the smallest

may be identiﬁed

λ
|
|

4

(18)

(19)

with the largest length scale in the dynamics allowed by
the boundary conditions, and the reciprocal of the largest
retained may be considered to be the smallest re-
λ
|
|
solvable spatial scale. In a typical computation (see e.g.
Section V), these numbers may be
41.3,
respectively. The minimum and maximum wavenumbers
in our previous 3D periodic dynamo computations (e.g.
in a 2563 dealiased simulation using the 2/3-rule [35])
have typically been 1 and 85 in dimensionless units, by
comparison.

4.59 and

≈

≈

Besides the quadratic ideal invariants and the recon-
struction of the ﬁeld components, two vector quantities
will be of interest. The angular momentum L is deﬁned
as

where a unity mass density is assumed, and the magnetic
dipole moment µ is given by

L =

r

×

Z

v d3x ,

µ =

1
2 Z

r

×

j d3x .

In terms of the C-K functions, these two quantities be-
come

L = 4R3

r

+√2Re

µ = 2R3

r

Cq,1

π
3 Xq
ξv
q,1,1

(cid:1)
Cq,1

(cid:0)

π
3 Xq
ξB
q,1,1

(cid:0)

ξv
q,1,0 ˆz+

j′
λq,1
1(
|
λq,1
|

−

R)
|
|
√2Im

(cid:2)
ξv
q,1,1
(cid:0)
′
λq,1
1(
j
|
|

R)
|

ˆx

−

λq,1
|

(20)

(cid:1)

,

ˆy
i
ξB
q,1,0 ˆz+

−
(cid:2)

(21)

+√2Re

ˆx

−

(cid:1)

√2Im

ξB
q,1,1
(cid:0)

(cid:1)

.

ˆy
i

±

As previously mentioned, in the code a sphere with
R = 1 is used. Note that only modes with l = 1 and
m = 0,
1 give a contribution to the angular momentum
and the dipole moment. With the boundary conditions
considered in this work, the angular momentum is not a
conserved quantity unless ν = 0. Other choices of the
boundary conditions can lead to a conservation of the
angular momentum even in the non-ideal case. Those
boundary conditions apply to the case when the sphere
of magnetoﬂuid is isolated from torques, but we will defer
consideration of that situation to a later paper.

The code is written in Fortran 90 and parallelized us-
ing MPI. Since most of the computing time is spent in the
sums in Eqs. (10) and (11), the parallelization is done
as follows. Each processor contains a complete copy of
the expansion coeﬃcients ξ, but only a portion of the
coupling coeﬃcients I i
jk is distributed in
q if the number of processors is smaller or equal than 2q,
and distributed in q, l, m in any other case. Each pro-
cessor computes the sums in Eqs. (10) and (11) locally
for the corresponding values of q, l, m, and after each it-
eration of the Runge-Kutta method the coeﬃcients ξ are

jk. The array I i

5

FIG. 2: Total energy (dotted line), magnetic energy (solid
line), and kinetic energy (dashed line) as a function of time
in run II. At late times the system is dominated by magnetic
energy.

FIG. 3: Relative magnetic helicity as a function of time
for runs I (solid line) and II (dashed line). The relative
helicity at late times increases with the Reynolds number.
Note the maximum possible value for the relative helicity is
min−1{|λ|} ≈ 0.22.

synchronized between all processors. The required com-
munication is minimal and the scaling of the code as the
number of processors is increased is close to ideal.

l

q

{

{

}

}

= max

Figure 1 shows the speed-up vs. the number of proces-
sors in two diﬀerent Linux clusters, in a simulation using
max
= 7. The clusters diﬀer in the net-
work conﬁguration. The speed-up is deﬁned as the time
required to do one time step in N processors divided by
the time required in one processor. The code shows ideal
scaling up to N
. A drop is then observed
q
}
and is related to the change in the parallel distribution
of the array I i
jk. However, after this drop a linear scaling
is again recovered.

2 max
{

≈

IV. SELECTIVE DECAY

Selective decay refers to a situation where an MHD
system with some initial magnetic helicity evolves with a
rapid decay of total energy relative to the magnetic he-
licity. The late-time state is a quasi-steady conﬁguration
in which the remaining energy is nearly all magnetic and
is condensed into the longest wavelength modes allowed
by the boundary conditions. Selective decay has been
extensively studied in periodic boundary conditions (see,
e.g., [36, 37, 38]). In Ref.
[39] it was found that given
isotropic initial conditions in a periodic box, the ﬁnal
state of the magnetic ﬁeld corresponds to an Arn’old-
Beltrami-Childress (ABC) ﬁeld at the largest possible
scale with A, B, and C equal. It is therefore of inter-
est to test selective decay in a sphere, and to observe
the geometry of the magnetic and velocity ﬁelds in the
late-time state.

Two runs were done, the ﬁrst (run I) with ν = η =
10−3.
10−2, and the second (run II) with ν = η = 6
×
= 7 (a total of

1
Run I was done with max

×

q

l

= max
{

}

{

}

q

= max

882 independent expansion coeﬃcients), and run II with
= 9 (1620 expansion coeﬃcients). In
max
{
both simulations, no external force was applied, and the
system was allowed to evolve for a long time (20 initial
large scale turnover times).

{

}

}

l

The non-vanishing initial expansion coeﬃcients in both

simulations are

3,3,0 = 5
3 ξB
3,3,0 = ξv
ξv
u0, ξB
−3,3,0 =
−
3,3,m = ξv
ξv
−3,3,m = u0(1 + i),
3,3,m = 5
ξB
3 ξB
i),
−3,3,m = B0(1

−3,3,0 = B0, (22)
(23)

(24)

−

−

1)mξ∗

where m runs from 1 to 3 and negative values of m are
qlm. The amplitudes u0 and
given by ξq,l,−m = (
B0 were chosen to have initial kinetic and magnetic en-
ergies of order unity (u0 = 4 and B0 = 0.4). These
initial conditions correspond to a small cross correla-
tion between the velocity and magnetic ﬁelds, a non-
helical velocity ﬁeld at an intermediate scale, and a (non-
maximally) helical magnetic ﬁeld at the same scale. The
initial angular momentum is zero and remains negligible
during the complete simulation. The kinetic and mag-
netic Reynolds numbers, based on the length R = 1 and
the initial rms velocity, are respectively deﬁned as

RV =

RM =

RU
ν
RU
η

,

.

(25)

(26)

98, and in run II RV = RM ≈

In run I RV = RM ≈
165.
Figure 2 shows the time history of the kinetic, mag-
netic, and total energies in run II. At late times, the
kinetic energy is negligible and the system is dominated
by magnetic energy. The magnetic helicity decays slowly

6

FIG. 4: Spectrum of kinetic energy as a function of λ for run
II, at t = 0.1 (solid line), t = 1.5 (dotted line) and t = 3
(dashed line).

FIG. 5: Spectrum of magnetic energy as a function of λ for
run II, at t = 0.1 (solid line), t = 1.5 (dotted line) and t = 3
(dashed line).

compared to the energy, as indicated by the evolution
of the relative helicity HM /EM (Fig.
3). As time
evolves, the ratio HM /EM increases until a steady state
is reached. The ﬁnal state reached by the system is not a
“Taylor state”, a state of maximum possible helicity for
the given energy (the maximum possible value for the
relative helicity is min
In run I, this
λ
is because after t
5 most of the kinetic energy has
decayed, and as a result the spectral exchange between
modes stopped. In run II the decay of the kinetic energy
takes place at a later time, and as a result the ﬁnal value
of the relative helicity is larger than in run I. Larger ﬁ-

0.22).

|} ≈

−1

{|

≈

FIG. 6: Amplitude of the coeﬃcients ξB
in run II at t = 10 as
a function of q and l (summed over all values of m). Most of
the magnetic energy is at the largest available scale, and an
asymmetry is observed between positive and negative values
of q.

nal values of the relative helicity can be expected if the
Reynolds numbers are further increased.

λ
|
|

λ
|
|

in run II at three diﬀerent times.

Since the C-K functions are eigenfunctions of the curl
with eigenvalue λ, the Laplacian operators in the diﬀu-
sion terms in Eqs. (5-7) are proportional to λ2. As a
plays in this case the role of the wavenumber
result,
k in the Fourier base. To deﬁne the energy spectrum, we
linearly bin the spectral space in shells of constant
and
sum the power of all the coeﬃcients in each shell, in anal-
ogy with the usual procedure in Fourier-based spectral
methods. Figures 4 and 5 show respectively the result-
ing kinetic and magnetic energy spectrum as a function
of

λ
|
|
At early times (t = 0.1), the signature of the ini-
tial conditions in the spectrum can be easily recognized.
Both spectra peak at
14, corresponding to the non-
vanishing initial perturbation at q = 3 and l = 3. As time
evolves, the amplitude of the kinetic energy spectrum de-
cays but the position of the peak remains approximately
constant. On the other hand, the peak in the magnetic
energy spectrum moves to smaller values of
, corre-
λ
|
|
sponding to larger scales. At late times the system is
dominated by magnetic energy, and most of it is concen-
trated in the largest available scale in the domain.

λ
|

| ≈

Based on the deﬁnition of the energy spectrum, we can

also introduce an energy-containing lengthscale as

ℓ =

R min
E

λ

{|

|}

Z

−1 d
λ
λ
)
λ
E(
|
|
|
|
|
|

,

(27)

7

FIG. 7: Above: kinetic energy density and velocity ﬁeld lines in run II, at t = 1.5 (left) and at t = 15 (right). Below: magnetic
energy density and magnetic ﬁeld lines in the same run, at t = 1.5 (left) and at t = 15 (right).

and a Taylor lengthscale

λT = R min

λ

E

{|

|} (cid:20)

(cid:30) Z

2 d
λ
λ
)
λ
E(
|
|
|
|
|

|(cid:21)

1/2

,

(28)

≈

λ
|
|

λT ≈

where E is the energy, and E(
) is the energy spectrum
λ
|
|
as a function of
(the sums are represented symboli-
cally as integrals). Using the kinetic and magnetic en-
ergies, these characteristic lengths can be computed for
the velocity and magnetic ﬁelds. In both runs, at t = 0
ℓ
0.33 for both ﬁelds. As the system evolves
these quantities grow monotonically, but while at t = 20
1.
for the velocity ﬁeld ℓ
As a criterion to decide if the simulations were well re-
solved in spectral space, the scales where the kinetic and
magnetic enstrophy spectrum peaked were observed as a
function of time, and it was asked that their correspond-
ing wavenumbers
at all
times.

0.5, for the magnetic ﬁeld ℓ

were smaller than max

λ
|
|

{|

≈

≈

|}

λ

Figure 6 shows the amplitude of the individual modes
ξB in run II at t = 10 as a function of q and l (all val-
ues of m for each value of l are summed). Most of the
magnetic energy is concentrated in the shell with l = 1,
and the modes with q =
1 in this shell have the largest
amplitude. Note the imbalance between the mode with
1, indicating some helicity is present in
q = 1 and q =
the magnetic ﬁeld.

−

±

The dominance of a helical large scale magnetic ﬁeld
at late times can also be identiﬁed in an inspection of

the ﬁelds in conﬁguration space. Figure 7 shows ﬁeld
intensity and a few ﬁeld lines for the velocity and mag-
netic ﬁeld at t = 1.5 (left) and t = 15 (right) in run
II. While at early times both ﬁelds show small scale fea-
tures, at late times the velocity ﬁeld looks reminiscent of
a quadrupole and the magnetic ﬁeld looks like a dipole
oriented roughly in the z direction. However, the mag-
netic ﬁeld at t = 15 is helical and the magnetic ﬁeld lines
are not purely poloidal. There is a small toroidal compo-
nent to the magnetic ﬁeld, and the magnetic ﬁeld lines
proceed slowly in the φ-direction in a helical fashion.

In Fig. 7 and in the following visualizations the labels
are as follows. The x, y, and z directions are indicated by
the arrows (in the online version, these are respectively
red, green, and blue). The fog opacity is proportional to
the intensity of the ﬁeld (in the online version, the inten-
sity is also indicated by the fog color, with red, green,
blue, and magenta from less intense to more intense).
Field lines are computed taking a snapshot of the ﬁeld at
a ﬁxed instant in time, and integrating a trajectory from
four selected and ﬁxed spatial points in the surroundings
of the center of the sphere. The ﬁeld is not evolved in
time as the lines are integrated. To indicate the direc-
tion of the ﬁelds, in the online version the lines change
color according to the distance integrated from the ﬁxed
initial point; from brown to dark green, dark blue, and
dark magenta.

8

FIG. 8: Kinetic (dashed line) and magnetic energy (solid line)
as a function of time in run III.

FIG. 10: Above: kinetic energy density and velocity ﬁeld lines
in run III, at t = 915. Below: magnetic energy density and
magnetic ﬁeld at the same time.

observe ampliﬁcation of magnetic energy due to dynamo
action.

Three dynamo simulations were done, in which the
Reynolds numbers and the number of modes excited in
the velocity ﬁeld were progressively increased. We discuss
ﬁrst two simulations in which only a few modes were ex-
cited. While in the ﬁrst case the system reaches a steady
state with a stable dipole moment, in the second run the
dipole spontaneously changes direction. Then, we ﬁnally
present a dynamo computation where more modes are
excited and the direction of the dipole moment changes
erratically in time.

l

q

{

}

= max
{

A resolution of max

= 9 was used in all
the runs. The same criteria than in the previous section
was used to decide if a simulation was well resolved. For
the last run, a simulation with higher resolution was also
done to verify the results were not modiﬁed by the change
in the resolution.

}

A. Laminar runs

In this section we present results from two runs with
10−3. In run III, the external forcing f in

ν = η = 3

×

FIG. 9: Time evolution of the three components of the dipole
moment in run III: x component (solid line), y (dotted line)
and z (dashed line).

V. DYNAMO EFFECT

In a magnetohydrodynamic dynamo, a small magnetic
ﬁeld is ampliﬁed and sustained against Ohmic dissipation
solely by the motions of a conducting ﬂuid. As mentioned
in the Introduction, magnetic ﬁelds observed in planets
and stars are believed to be the result of a dynamo pro-
cess. In this subsection, we study dynamo action in the
sphere.

In the simulations discussed in this section, energy is
injected in the system through the mechanical forcing f
in Eq. (5). In all cases, a hydrodynamic simulation was
conducted ﬁrst until reaching a steady state. The ampli-
tude of the external forcing was chosen to have kinetic
energy of order one in the steady state. Then, a random
10−6 was loaded in the
magnetic ﬁeld with energy EM ≈
modes with q = l = 4. The simulations were continued to

(29)

(30)

(31)

Eq. (5) is given by the coeﬃcient

ξf
2,2,1 = f0(1 + i),

with f0 = 1.4, which corresponds to one C-K mode and
as a result injects maximum kinetic helicity in the system.
In run IV, the external forcing is

ξf
2,2,0 = 5ξf
ξf
2,2,m = 5ξf

−2,2,0 = f0,
−2,2,m = f0(1 + i),

where m runs from 1 to 2 and negative values of m are
again given by ξq,l,−m = (
qlm. The amplitude of
−
the forcing is f0 = 0.9. This forcing injects non-maximal
kinetic helicity as well as kinetic energy into the system.
The phase and amplitude of the external force f were
kept constant during the entire simulations.

1)mξ∗

Figure 8 shows the time history of the magnetic and
kinetic energy in run III. The Reynolds numbers based
on the length R = 1 and the rms velocity are RV =
290, and the energy containing scale of the ﬂow is
RM ≈
ℓ
0.5. Before the magnetic ﬁeld is introduced, only the
≈
forced mode is excited.

After the magnetic seed is introduced, the magnetic
energy is ampliﬁed exponentially in a kinematic regime.
Then the magnetic ﬁeld saturates around t
150 and
the Lorentz force quenches the velocity ﬁeld. In the ﬁnal
steady state, more mechanical modes besides the forced
mode are excited. This is the result of an instability of
the ﬂow, triggered by the Lorentz force as the magnetic
ﬁeld grows exponentially.

≈

Figure 9 shows time evolution of the three Cartesian
components of the magnetic dipole moment in run III.
The dipole moment grows during the kinematic regime,
and after t
300 the dipole seems to converge slowly to
a steady state. Except for a small oscillation in the y
component, no spontaneous change in the direction of µ
is observed.

≈

A visualization of the velocity and magnetic ﬁelds in
conﬁguration space in the steady state of run III is shown
in Fig. 10. The kinetic energy is concentrated in two
counter-rotating regions, located in the center of each
hemisphere. The velocity ﬁeld in these regions is mostly
toroidal, as indicated by the velocity ﬁeld lines. The
magnetic energy is larger in the center of the sphere, and
along the axis deﬁned by the two counter-rotating eddies.
In the interior, but away from the axis, magnetic ﬁeld
lines are mostly toroidal, as the result of the stretching
by the two counter-rotating eddies. Along the axis and
close to the boundaries, the ﬂow is mostly poloidal.

The time history of the kinetic and magnetic energy in
run IV is shown in Fig. 11. The Reynolds numbers for
280, and the energy containing
this run are RV = RM ≈
scale of the ﬂow is ℓ
0.48. Although the kinematic
≈
viscosity and magnetic diﬀusivity are the same as in run
III, the external forcing injects energy in a larger num-
ber of modes and even before the magnetic ﬁeld is intro-
duced non-forced modes have some mechanical energy.

9

FIG. 11: Kinetic (dashed line) and magnetic energy (solid
line) as a function of time in run IV.

FIG. 12: Time evolution of the three components of the dipole
moment in run IV. Same labels as in Fig. 9.

After the magnetic seed is introduced, the magnetic en-
150 saturates. The
ergy grows exponentially until at t
system seems to reach a steady state but suddenly at
500 the magnetic energy decreases by a factor of
t
1.1, and the

≈
1.8, the kinetic energy increases by

≈

≈
system reaches a second steady state.

≈

≈

The abrupt change in the kinetic and magnetic energy
in run IV at t
500 is associated with a reorientation of
the magnetic dipole moment. Figure 12 shows the time
evolution of the three components of the magnetic dipole
moment. In the kinematic stage the dipole moment grows
until reaching a ﬁrst quasi-steady state. The components
of the dipole moment are approximately constant until
at t
500 the magnetic ﬁeld evolves rapidly to a second
attractor and the dipole moment changes direction. The
angle the dipole ﬂips by is close to π/2. The amplitude
of the dipole moment also changes as the dipole shifts;
0.36, at t
while at t

0.54.

1000

300

≈

≈

µ
|

| ≈

≈

µ
|

| ≈

10

5

×

III and IV, as a result of the higher Reynolds numbers.
Figure 16 shows the time evolution of the three Carte-
sian components of the dipole moment in run V. All com-
ponents of µ ﬂuctuate randomly, and change sign with
a characteristic time of the order of 100 turnover times.
The angular momentum is small, and ﬂuctuates around
10−3. However, unlike run III, in this sim-
2/EV ≈
L
|
|
ulation the angle between the dipole moment and the an-
gular momentum is not constant and ﬂuctuates randomly
between 0 and π. In previous studies of α2 geodynamos,
it was found that the α eﬀect favors an equatorial dipole
ﬁeld [40], and it was shown that small scale ﬂuctuations
can give an axial dipole. The results in Ref.
[40] were
obtained for kinematic simulations, while the alignment
observed here is for the nonlinear MHD regime. This
point deserves further study in simulations with larger
angular momentum.

The kinetic and magnetic energy spectra in run V at
several times are shown in Fig. 17. More modes are
excited in the velocity ﬁeld, in accordance with the strong
ﬂuctuations in time observed in the kinetic energy. While
in runs III and IV the magnetic energy spectrum peaks
at large scales even during the kinematic regime, in run
V at early times the magnetic energy peaks at scales
smaller than the forcing scale. Also, after the nonlinear
saturation of the dynamo, a ﬂuctuation in the amplitude
of the large scale magnetic ﬁeld is observed. The minima
are correlated with times of minima of µ2, when the three
components of the dipole moment ﬂuctuate around zero.
Most of the activity in this run is in small scales and
ﬂuctuations in the ﬂow are larger than in runs III and IV.
Even at late times when a large scale magnetic ﬁeld has
developed, intermediate scales give a large contribution
to the magnetic energy. This also explains the strong
ﬂuctuations observed in the dipole moment. Since µ is
proportional to the current density, the small scales give
a large contribution to the dipole moment.

Figure 18 shows the magnetic and velocity ﬁeld in real
space at two diﬀerent times in run IV. The ﬁelds have
more small scale structure than in run III. Also, in the
kinematic regime (see e.g. the magnetic ﬁeld at t = 75)
the magnetic energy is mostly in the small scales, as also
indicated by the magnetic energy spectrum.

VI. DISCUSSION

We have provided some computational machinery that
is intended to open a quantitative discussion of nonlinear
magnetohydrodynamics inside a rigid sphere, for essen-
tially arbitrary parameter ranges and initial conditions.
The attempt is to be distinguished both from previous
computations of magnetic dynamo processes in rectangu-
lar periodic boundary conditions, where material bound-
aries are not involved, and from those geo-dynamo com-
putations whose main goal is a numerical reproduction of
the Earth’s magnetic ﬁeld behavior. We are interested in
the physical processes involved in the mechanical excita-

FIG. 13: Kinetic energy spectrum at t = 52 [thick (blue) solid
line] and at t = 500 [thick (blue) dash-dotted line] in run IV;
the thin lines correspond to the magnetic energy spectrum at
t = 52 (solid), t = 82 (dotted), t = 250 (dashed), and t = 500
(dash-dotted).

| ≈

λ
|

Figure 13 shows the kinetic and magnetic energy spec-
tra in run IV at diﬀerent times. The kinetic energy spec-
trum peaks at
9, corresponding to the forced modes
with q = 2 and l = 2. The energy in the remaining modes
is at least two orders of magnitude smaller than in the
forced modes. At late times, some kinetic energy is ex-
cited in the largest available scale, as well as a small an-
2/EV ≈
L
600).
gular momentum (
|
|
The angle between the dipole moment and this small an-
gular momentum remains constant after t = 100 and is
π/2. Visualizations of the velocity and magnetic ﬁelds
in conﬁguration space are shown in Fig. 14. The ge-
ometry of the velocity ﬁeld is more complex than in run
III. Note at t = 315 the magnetic ﬁeld lines are mostly
poloidal in the center of the sphere, and toroidal close to
the boundary.

10−4 after t

1.5

≈

×

B. A chaotic simulation

×

forcing f

0.4 and λT = 0.35.

In run V the external

is given by Eqs.
(30,31), but the kinematic viscosity and magnetic dif-
10−4. The kinetic and mag-
fusivity are ν = η = 3
2300, and
netic Reynolds numbers are RV = RM ≈
the energy-containing and Taylor scales are respectively
ℓ

≈
The evolution of the kinetic and magnetic energy in run
V is shown in Fig. 15. Again, after an initial kinematic
regime where the magnetic energy is ampliﬁed exponen-
tially, the system reaches a statistical steady state. Note
that in this simulation both the kinetic and magnetic
energy ﬂuctuate strongly with time, indicating the non-
linear coupling between modes is stronger than in runs

11

FIG. 14: Above: kinetic energy density and velocity ﬁeld lines in run IV, at t = 315 (left) and at t = 1065 (right). Below:
magnetic energy density and magnetic ﬁeld lines in the same run, at t = 315 (left) and at t = 1065 (right). The black arrows
indicate the direction of the dipole moment.

FIG. 15: Kinetic (dashed line) and magnetic energy (solid
line) as a function of time in run V.

tion of magnetic ﬁelds in spherically-bounded electrically
conducting ﬂuids. In addition to the spherical geometry,
there are also other features that become important, such
as angular momentum, rotation of the boundary (omit-
ted here, the inclusion of rotation is intended in future
investigations), and diﬀerent types of mechanical exci-
tations. The pathway is also open to the inclusion of
diﬀerentially rotating inner solid cores with the addition

FIG. 16: Time evolution of the three components of the dipole
moment in run V. Labels are as in Fig. 9. Note that the x
and z components are out of phase and change sign approxi-
mately at the same time, while the y component seems to be
ﬂuctuating around zero.

of spherical Neumann functions into Eq. (3).

The operation of the wholly spectral code, which had
a precedent in periodic circular-cylinder geometry, has
been illustrated by two examples: “decay” turbulence
computations in which relaxation to a helical magnetic
state with negligible kinetic energy has been observed,

12

to “ﬂip,” spontaneously changing direction at an unpre-
dictable time. Under these circumstances, the change in
orientation of the dipole moment appears to be an easily
achievable process: it has happened virtually every time
we have tried it if some ﬂuctuations were present in the
velocity ﬁeld. Its ease of achievement, in relation to the
level of turbulence it occurs in, and its possible restric-
tion by the eﬀects of rotation and/or large net angular
momentum (they are not the same thing) remain to be
investigated. It is our plan to continue to study this prob-
lem, putting in new eﬀects and boundary modiﬁcations
in an attempt to understand them one at a time, even
though one knows that in the planetary dynamo prob-
lem, they are likely to all be present at once. We have
also done relatively little exploration of the eﬀects of dif-
ferent kinds of forcing mechanisms on the form of the
magnetic ﬁelds generated, and that, too, needs further
consideration.

Acknowledgments

The authors would like to express their gratitude to
A. Pouquet for valuable discussions and his careful read-
ing of the manuscript. Computer time was provided
by NCAR. The NSF grants CMG-0327888 at NCAR
and ATM-0327533 at Dartmouth College supported this
work in part and are gratefully acknowledged. Three-
dimensional visualizations of the ﬂow were done using
VAPoR [41], a software for interactive visualization and
analysis of large datasets.

FIG. 17: Kinetic energy spectrum at t = 75 [thick (blue) solid
line] and at t = 600 [thick (blue) dash-triple dotted line] in run
V; the thin lines correspond to the magnetic energy spectrum
at t = 75 (solid), t = 168 (dotted), t = 240 (dashed), t = 544
(dash-dotted), and t = 500 (dash-triple dotted).

and “dynamo” computations that have been performed
by mechanically driving the velocity ﬁeld, resulting in
the generation of magnetic energy and a magnetic dipole
moment. The dipole moment, unregulated by the in-
clusion of either rotation or possible thermally convec-
tive rolls with a preferred orientation, has been seen

[3] M. Dikpati and P. Charbonneau, Astrophys. J. 518, 508

1 (2005).

[1] H. K. Moﬀatt, Magnetic ﬁeld generation in electrically
conducting ﬂuids, Cambridge Univ. Press, Cambridge,
1978.

[2] G. A. Glatzmaier and P. H. Roberts, Nature 377, 203

(1995).

(1999).

(2002).

1065 (2004).

[4] M. Kono and P. H. Roberts, Rev. Geophys. 40, 1 (2002).
[5] D. Nandy and A. R. Choudhuri, Science 296, 1671

[6] P. D. Mininni and D. O. G´omez, Astron. Astrophys. 426,

[7] A. Gailitis, O. Lielausis, E. Platacis, S. Dement’ev,
A. Cifersons, G. Gerbeth, T. Gundrum, F. Stefani,
M. Christen, and G. Will, Phys. Rev. Lett. 86, 003024
(2001).

[8] R. Steiglitz and U. M¨uller, Phys. Fluids 13, 561 (2001).
[9] K. Noguchi, V. I. Pariev, S. A. Colgate, H. F. Beckley,

and J. Nordhaus, Astrophys. J. 575, 1151 (2002).
[10] F. P´etr´elis, M. Bourgoin, L. Mari´e, J. Burguete, A. Chif-
faudel, F. Daviaud, S. Fauve, P. Odier, and J.-F. Pinton,
Phys. Rev. Lett. 90, 174501 (2003).

Kendrick, Observation of a turbulence-generated large
scale magnetic ﬁeld, Submitted to Phys. Rev. Lett.
[13] P. H. Roberts and G. A. Glatzmaier, Geophys. Astro-

phys. Fluid Dyn. 94, 47 (2001).

[14] A. Brandenburg and K. Subramanian, Phys. Rep. 417,

[15] P. Charbonneau, Living Rev. Solar Phys. 2 (2005),

http://www.livingreviews.org/lrsp-2005-2.

[16] Y. Ponty, P. D. Mininni, D. C. Montgomery, J.-F. Pinton,
H. Politano, and A. Pouquet, Phys. Rev. Lett. 94, 164502
(2005).

[17] P. D. Mininni, Y. Ponty, D. C. Montgomery, J.-F.Pinton,
H. Politano, and A. Pouquet, Astrophys. J. 626, 853
(2005).

[18] P. D. Mininni and D. C. Montgomery, Phys. Rev. E 72,

[19] A. Alexakis, P. D. Mininni, and A. Pouquet, Phys. Rev.

[20] P. D. Mininni, A. Alexakis, and A. Pouquet, Phys. Rev.

[21] G. A. Glatzmaier and P. H. Roberts, Science 274, 1887

056320 (2005).

E 72, 046301 (2005).

E 72, 046302 (2005).

(1996).

457 (1957).

[11] D. R. Sisan, W. L. Shew, and D. P. Lathrop, Phys. Earth

[22] S. Chandrasekhar and P. C. Kendall, Astrophys. J. 126,

Plan. Int. 135, 137 (2003).

[12] E. J. Spence, C. B. Forest, M. D. Nornberg, and R. D.

[23] L. Turner, Ann. Phys. 149, 58 (1983).

13

FIG. 18: Above: kinetic energy density and velocity ﬁeld lines in run IV, at t = 75 (left) and at t = 1035 (right). Below:
magnetic energy density and magnetic ﬁeld lines in the same run, at t = 75 (left) and at t = 1035 (right).

[24] Z. Yoshida, Prog. Theor. Phys. 86, 45 (1991).
[25] Z. Yoshida, J. Math. Phys. 33, 1252 (1992).
[26] J. Cantarella, D. DeTurck, H. Gluck, and M. Teytel,

Phys. Plasmas 7, 2766 (2000).

[35] C. Canuto, Y. Hussaini, A. Quarteroni, and T. Zang,
Spectral methods in ﬂuid dynamics, Springer Verlag, New
York, 1988.

[36] W. H. Matthaeus and D. Montgomery, Ann. N. Y. Acad.

[27] D. C. Montgomery, L. Turner, and G. Vahala, Phys.

Sci. 357, 203 (1980).

[28] X. W. Shan, D. Montgomery, and H. D. Chen, Phys.

Fluids 29, 3261 (1986).

[29] X. W. Shan and D. Montgomery, Plasma Phys. Cont.

Plasmas 2, 3623 (1995).

[30] X. W. Shan and D. Montgomery, Plasma Phys. Cont.

Rev. E 71, 046304 (2005).

[31] X. W. Shan and D. Montgomery, Phys. Rev. Lett. 73,

(2004).

Fluids 21, 757 (1978).

Rev. A 44, 6800 (1991).

Fus. 35, 619 (1993).

Fus. 35, 1019 (1993).

1624 (1994).

(1996).

[37] A. C. Ting, W. H. Matthaeus, and D. Montgomery, Phys.

[38] R. Kinney, J. C. McWilliams, and T. Tajima, Phys.

[39] P. D. Mininni, D. C. Montgomery, and A. Pouquet, Phys.

[40] A. Tilgner, Geophys. Astrophys. Fluid Dyn. 98, 225

[41] J. Clyne and M. Rast, A prototype discovery environ-
ment for analyzing and visualizing terascale turbulent
in Visualization and data analy-
ﬂuid ﬂow simulations,
sis 2005, edited by R. F. Erbacher, J. C. Roberts, M. T.
Grohn, and K. Borner, pp. 284–294, Bellingham, Wash.,
2005, SPIE, http://www.vapor.ucar.edu.

[32] S. J. Li and D. Montgomery, Phys. Lett. A 218, 281

[33] S. J. Li, D. Montgomery, and W. B. Jones, Theor. Comp.

Fluid Dyn. 9, 167 (1997).

[34] W. H. Press, B. P. Flannery, S. A. Teukolsky, and W. T.
Vetterling, Numerical Recipes in FORTRAN 77, Cam-
bridge Univ. Press, Cambridge, 1992.

