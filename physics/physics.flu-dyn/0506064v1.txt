5
0
0
2
 
n
u
J
 
7
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
4
6
0
6
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Deriving thermal lattice-Boltzmann models
from the continuous Boltzmann equation:
theoretical aspects

P. C. Philippi,

L. A. Hegele Jr., L. O. E. dos Santos, R. Surmas

Mechanical Engineering Department. Federal University of Santa Catarina.
88040-900 Florian´opolis. SC. Brazil.

Abstract

The particles model, the collision model, the polynomial development used for the
equilibrium distribution, the time discretization and the velocity discretization are
factors that let the lattice Boltzmann framework (LBM) far away from its conceptual
support: the continuous Boltzmann equation (BE). Most collision models are based
on the BGK, single parameter, relaxation-term leading to constant Prandtl num-
bers. The polynomial expansion used for the equilibrium distribution introduces an
upper-bound in the local macroscopic speed. Most widely used time discretization
procedures give an explicit numerical scheme with second-order time step errors.
In thermal problems, quadrature did not succeed in giving discrete velocity sets
able to generate multi-speed regular lattices. All these problems, greatly, diﬃcult
the numerical simulation of LBM based algorithms. In present work, the systematic
derivation of lattice-Boltzmann models from the continuous Boltzmann equation
is discussed. The collision term in the linearized Boltzmann equation is modeled
by expanding the distribution function in Hermite tensors. Thermohydrodynamic
macroscopic equations are correctly retrieved with a second-order model. Velocity
discretization is the most critical step in establishing regular-lattices framework. In
the quadrature process, it is shown that the integrating variable has an important
role in deﬁning the equilibrium distribution and the lattice-Boltzmann model, lead-
ing, alternatively, to temperature dependent velocities (TDV) and to temperature
dependent weights (TDW) lattice-Boltzmann models.

Key words: Continuous Boltzmann equation, Lattice Boltzmann, discretization.

Email address: philippi@lmpt.ufsc.br (P. C. Philippi).

Preprint submitted to Elsevier Science

2 February 2008

Introduction

Following Lallemand & Luo, [1], the presently known lattice-Boltzmann equa-
tion (LBE) has not been able to handle realistic thermal (and fully compress-
ible) ﬂuids with satisfaction. Simulation of thermal lattice-Boltzmann equa-
tion is hampered by numerical instabilities when the local velocity increases.
Readers are referred to this work for an excellent review of known works on
thermal and compressible lattice-Boltzmann schemes.
Rigorously, ﬂuid ﬂow is never isothermal. Consider, for instance, a channel
Poiseuille ﬂow between two adiabatic solid surfaces. Due to the viscous con-
version of mechanical in thermal energy, temperature will vary, attaining a
minimum at the channel symmetry axis, where the local speed is a maximum.
This temperature variation can be very small, but increases with the local
average speed u and with the ﬂuid viscosity. If it is agreed that the tempera-
ture in a given site is related to the expected value E of the lattice-particles
ﬂuctuation kinetic energy, this temperature variation is drafted in LB ather-
mal simulation, since E varies from site to site in accordance with the local
macroscopic speed, u, attaining a minimum where u is maximum. However,
in athermal lattice-Boltzmann models, this thermal spatial non-equilibrium
is not properly compensated by heat ﬂow because athermal models were not
conceived for correctly describing energy transfer. In this manner, since tem-
perature gradients cannot be avoided in athermal LB simulation, in contrast
with classical CFD isothermal simulation, they may become sources of numer-
ical instability.
In conclusion, lattice-Boltzmann athermal equation, actually, deals with ther-
mal problems and thermal and athermal lattice-Boltzmann models will be
here considered using a single approach.
There are several features that let the lattice Boltzmann, regular-lattice based,
framework far away from what it would desirable to be its starting point: the
continuous Boltzmann equation. These features include the particles model,
the collision model, the polynomial development used for the equilibrium dis-
tribution, the time discretization and the velocity discretization. Some of these
main features are discussed in the following.
Collision model. More widely used lattice-Boltzmann collision models are
based on a Bhatnagar, Gross and Krook (BGK) relaxation term, [2], ﬁrstly
introduced in the lattice-Boltzmann framework by Qian et al., [3], and Chen
et al., [4]. Thermal lattice-Boltzmann schemes based on the BGK collision
model use an increased number of discrete velocities and/or include higher
order non-linear terms in the equilibrium distribution function ([5], [6], [7]),
temperature dependent weights, [5], and temperature dependent velocities,
[12]. BGK single relaxation time collision term restricts the models to con-
stant Prandtl number. The correct description of ﬂuids and ﬂuid ﬂow requires
multiple relaxation time models (MRT). A two-parameters model was intro-
duced by He et al., [8], using two sets of distributions for the particles number

2

density and for the thermodynamic internal energy, coupled through a viscous
dissipation term. Full MRT models were ﬁrstly introduced in the LBE frame-
work by d’Humi`eres, [9], derived from the moments method, by making the
moments and the velocity spaces isomorphic, [10]. The main criticism to the
moments method is that the highest order of the kinetic moments possible
to be correctly described with the LBE equation is limited by the number
of lattice velocities, [11], and high-order kinetic moments are not correctly
described when all the b-moments in a b-discrete velocities set are consid-
ered. In currently produced works dealing with applications of the moments
method, e.g. [1], the main worry is numerical stability and not the description
of non-isothermal, multicomponent or immiscible ﬂuids ﬂows, which, eﬀec-
tively, require additional relaxation parameters with respect to BGK models.
Dispersion equations are used as constraints for the adjustable parameters
related to the short wave-length non-hydrodynamic moments and numerical
stability is assured by buﬀering these higher frequency moments. This ar-
tiﬁcial shielding can be too dangerous for the complex ﬂow structures that
naturally appear when the Reynolds number increases. A correct description
of the growing of these ﬂow structures with the Reynolds number requires to
increase the lattice dimensionality.
Time discretization. Most lattice-Boltzmann simulations are based on an
explicit numerical scheme, with second order time-step, δ, errors. Lattice BGK
models, have been simulated with implicit numerical schemes, [13], [14], or
LBE modiﬁed explicit numerical schemes, [8], with third order time step,
O(δ3), errors. In spite of the fact that, in athermal models, this truncation
error can be totally absorbed into the physical viscous term, in thermal mod-
els errors O(δ2) seriously aﬀects the viscous heat dissipation term, [8].
Velocity discretization. Lattice-Boltzmann method is based on a ﬁnite set
of discrete velocities ~ci and weights ωi, judiciously chosen so as to ensure
isotropy for the even-parity rank velocity tensors and, consequently, for the
ﬂuid transfer properties. He & Luo,[11], have directly derived some widely
used lattices (D2Q9, D2Q6, D2Q7, D3Q27) from the continuous Boltzmann
equation by discretization of the velocity space, using the Gauss-Hermite and
Gauss -Radau quadrature of the Maxwellian ~u-polynomial expansions. Unhap-
pily, excluding the above mentioned lattices, the discrete velocity sets obtained
by quadrature do not generate regular lattices. In this sense, Pavlo et al., [12],
proposed a temperature dependent velocity model based on an octagonal lat-
tice which is not space-ﬁlling but ensures the isotropy of 6th- rank velocity
tensors.
In this work, we present an attempt for deriving the lattice-Boltzmann equa-
tion, from the continuous Boltzmann equation trying to combine the following
main features: multiple relaxation-times, O(δ3) time step errors and thermo-
dynamic consistency in non-isothermal ﬂow.
In contrast with the moments method, in present conception higher Reynolds
ﬂows (and non-isothermal ﬂows) require to increase the number of the lattice
discrete velocities and to increase the accuracy of the LBE equation with re-

3

D

C

H

H

generated by h :

spect to its continuous counterpart.
The collision term Ω in the linearized Boltzmann equation is modeled by ex-
panding the distribution function f in Hermite polynomial tensors Ψθ, which
,
forms an orthogonal basis in the Hilbert space
→ R
D being the dimension of the velocity space. Considering that each term
L
(Ψθ ) is, itself, an element of
, this term is expanded as a linear combina-
tion of the same order-θ Hermite tensors through 2θ-order relaxation tensors.
Isotropy properties are used to reduce these tensors. The inﬁnite series f eq
L
(φ) is not truncated. Instead, after a chosen tensor order N, a Gross-Jackson
procedure is used, [15], and the relaxation tensors are diagonalized.
It is shown that d ´Humi`eres moment equations [10] are particular discrete
forms of the derived model when the diagonalization constant is considered to
be zero.
By performing a Chapman-Enskog analysis of the derived continuous model it
is shown that the thermo-hydrodynamic macroscopic equations are correctly
retrieved with a second-order model. Third-order models are only required for
describing third-order coupling (Soret and Dufour eﬀects) in multi-component
systems ([16]).
The derived kinetic model of the continuous Boltzmann equation is then dis-
cretized.
It is shown that an explicit numerical scheme with O(δ3) time step errors can
be derived, using He at al. procedure,
Velocity discretization is the most critical step in deriving lattice-Boltzmann
equations.
For each N, the equilibrium distribution is taken as an nth-degree Hermite
development of the Maxwell-Boltzmann (MB) equilibrium distribution, in ac-
cordance with the constraints that are imposed by the physical problem.
Although, as it was shown in [11], velocity discretization of the most widely
known lattices can be achieved by Gauss-Hermite and related quadratures,
quadrature schemes did not succeed in generating multi-speed regular lat-
tices, suitable for thermal problems, placing an, still, open question in the
LBM framework. In present paper, it is shown that the integrating variable
has an important role in deﬁning the equilibrium distribution and the lattice-
Boltzmann model: a) discretization based on the particles velocity ~c, giving a
set of discrete, constant, particle velocities ~ci, leads to temperature dependent
weights ωi (TDW), b) discretization based on the, temperature dependent,
dimensionless velocity ~
gives a set of temperature dependent particle veloc-
C
ities ~ci (TDV).
In this context, it is shown that the thermal part geq
i
model,
approximation with errors O (uΘ) where Θ is the temperature deviation.
Although a more complete theoretical analysis is still necessary, the consider-
ation of TDV models appears to be suitable for thermal problems. However,
in this case, the particles allocation rules, required for the local conservation

[8], can be formally retrieved from TDW models, as an ~u-polynomial

[8].

in He et al. two-distributions

4

of mass, momentum and energy, make the particles number-density, n, to be
temperature dependent and the implicit temperature dependence of n is dif-
ﬁcult to manage, when performing a Chapman-Enskog analysis of the kinetic
models. Finding the macroscopic behavior of these models is, still, in progress.
A simulation scheme suitable for non-isothermal problems is presented for the
TDV model.

1 Boltzmann equation in the continuous velocity space

1.1 Development of the distribution function in Hermite polynomials

The Maxwell-Boltzmann equilibrium distribution, [15], can be written as an
inﬁnite series of Hermite polynomial tensors Ψθ,(rθ ), [17],

f eq =

D/2

e−C2
πD/2

m
2kT (cid:19)

(cid:18)

Xθ

aeq
θ,(rθ )Ψθ,(rθ ),

(1)

(cid:16)

(cid:17)

where (rθ) is a sequence of indexes r1, r2, ...rθ and repeated index means sum-
mation, Ψ0 = 1, Ψ1,α = 2
CαCβCγ −
1
2δβγCα) and so on. The dimensionless particle velocity is
2δαγCβ −
2δαβCγ −
~
, satisfying
=
C

~c. These tensors are orthogonal in the Hilbert space

2δαβ), Ψ3,αβγ = 4
3(

Cα, Ψ2,αβ = 2(

CαCβ −

m
2kT

H

1/2

1

1

1

e−C2

Z

(cid:17)

1/2

(2)

m
2kT

where ∆2θ

Uα, aeq

= λθ∆(rθ )(sθ ),

Ψθ,(rθ )Ψθ,(sθ )d ~
C
(rθ )(sθ ) is a 2θ-order isotropic tensor, [18], and λθ is a constant. With
~
0 = n,
=
U
aeq
1,α = n
UαUβUγ and so on, which are dependents
(cid:16)
on the volumetric number of particles n, on the dimensionless macroscopic
velocity ~
U
For each point ~x the distribution function φ in the non-equilibrium part f neq
= f eqφ can be developed in terms of the orthogonal basis Ψθ,(rθ ), [16], [19],
written in terms of the velocity ﬂuctuation ~
~
U

~u, the coeﬃcients aeq
UαUβ, aeq
2,αβ = n
3,αβγ = n
and on the temperature T .

θ,(rθ ) in Eq. (1) are the moments aeq

Cf = ~c−~u

m )1/2 = ~

m )1/2 =
( 2kT

~C
( 2kT

C −

φ =

aφ
θ,(rθ ) (~x, t) Ψθ,(rθ )

Xθ

,

~
Cf
(cid:16)

(cid:17)

and coeﬃcients aφ
way, aφ
tensor ταβ through

0 = 0, aφ

θ can be related to the macroscopic moments of f . In this
2,αβ is related to the viscous stress

1,α = 0. The coeﬃcient aφ

(3)

(4)

aφ
2,αβ =

ταβ
2P

,

5

(5)

(6)

(7)

(8)

(9)

(10)

(11)





(13)

where P = nkT is the thermodynamic pressure.
The ﬂuctuation kinetic energy E(~x, t) is given by

E(~x, t) =

f

m (~c

~u)2 d~c =

1
2

Z

f eq 1
2

m (~c

~u)2 d~c.

−

−

f neq 1
2

Z

f neq 1
2

Z

m (C)2 d ~C = 0,

mCαCαd ~C =

tr (τ ) = 0.

Z

1
2

In this way

In two-dimensions

τxx + τyy = 0,

aφ
2,xx + aφ

2,yy = 0.

For third-order moments

Sαβγ =

f mcαcβ cγd~c =
αβγ + Sneq
αβγ,

Z
= Seq

Z

f eqmcαcβ cγd~c +

f neqmcαcβ cγd~c

Z

or

or

with

Seq
αβγ = ρuαuβuγ + P (δβγuα + δαγuβ + δαβuγ) .

For the non-equilibrium part,

Sneq
αβγ =

Z

resulting, using aφ
mutation and Eq. (11):

f neqmcf αcf βcf γd~c + (τβγuα + ταγuβ + ταβuγ) ,

(12)

1,α = 0, the invariance property with respect to index per-

1
2

P

2kT
m !

 

aφ
3,αβγ =

Sαβγ

2 − 



qαβγ.

≡

1

2ρuαuβuγ + 1
+ 1

2 P (δβγuα + δαγuβ + δαβuγ)

2 (τβγuα + ταγuβ + ταβuγ)

When β and γ are contracted, deﬁning ǫα to be the total energy ﬂux along
the direction α,

1
2

P

2kT
m !

 

aφ
3,αββ = ǫα − (cid:20)

1
2

ρu2uα + P

+ 1

uα + ταβuβ

= qα,

(14)

(cid:19)

(cid:21)

D
2

(cid:18)

where qα is the net heat ﬂux along the direction α, i.e., the total energy ﬂux
ǫα, subtracting from it, the ﬂow of macroscopic kinetic energy 1
2ρu2uα, the
compression work P

uα and the viscous work ταβuβ.

D
2 + 1

(cid:16)

(cid:17)

6

1.2 Collision term

Particles are supposed to be material points without volume and only able
to exchange translational kinetic energy, but the collision term Ω is, here,
considered to take multiparticles collisions into account. Since, in this case,
the collision term structure is not known, some assumptions are required. In
this manner, near the equilibrium, Ω is considered to be f eq
(φ), the operator
being a linear operator. This property was shown to be true for binary
L
collisions, [14] and is, here, extended for multiparticles collisions. When f is
near f eq, Boltzmann equation reads

L

(15)

(16)

(17)

(18)

(19)

Using the development, Eq. (3) ,

∂tf + ~c.

f = Ω = f eq

(φ).

∇

L

(φ) =

L

aφ
θ,(rθ)L

Ψθ,(rθ)
(cid:16)

(cid:17)

.

Xθ

D space and can
The θ-order tensor
the θ-order Hermite tensors that belong to the
be developed in terms of
(cid:17)
orthogonal basis of this space,

is, itself, an element of the

Ψθ,(rθ)
(cid:16)

L

C

L

Ψθ,(rθ )
(cid:16)

(cid:17)

=

X(sθ)

γ(rθ),(sθ )Ψθ,(sθ ),

where γ(rθ),(sθ) designate the (rθ), (sθ) components of 2θ-order relaxation ten-
sors. Considering, as for binary collision,
to be a self-adjoint operator, with
non-positive eigenvalues,

L

γ(rθ),(mθ ) =

R

−C2
e
f

Ψθ,(rθ )
L
(cid:16)
−C2
e
f

(cid:17)
Ψθ,(mθ )

R

(cid:16)

Ψθ,(mθ )d ~
Cf
d ~
Cf

2

(cid:17)

0.

≤

Using Einstein´s notation

(φ) =

L

Xθ

γ(rθ ),(sθ )aφ

θ,(rθ)Ψθ,(sθ ),

where repeated indexes mean summation.
Above equation is an inﬁnite summation on θ. When the terms above a chosen
order N are diagonalised, following a Gross-Jackson procedure, [15],

(φ) =

L

γ(rθ ),(sθ )aφ

θ,(rθ)Ψθ,(sθ ) −

γN+1

δ(rθ ),(sθ )aφ

θ,(rθ)Ψθ,(sθ ),

(20)

N

Xθ=0

where

δ(rθ ),(sθ ) = δr1 s1

....δrθ sθ

.

(21)

∞

Xθ=N +1

7

In this way, using Eq. (3)

(φ) =

L

N

− "

Xθ=0

λ(r

),(s

θ

θ

)aφ

θ,(rθ )Ψθ,(s

γN+1φ,

)

θ

# −

(22)

θ

θ

θ

θ

(cid:17)

),(s

),(s

−

−

γ(rθ ),(sθ ) + γN+1δ(rθ ),(sθ )
(cid:16)

is positive for all rθ, sθ, since a)
where λ(r
) =
γ(rθ ),(sθ ) for all oﬀ-diagonal components and b) the diagonal com-
λ(r
) =
ponents γ(rθ ),(rθ) are negative with an absolute value that is greater than γN+1
for all θ smaller or equal to N. Eq. (22) can be considered as an Nth-order ki-
netic model to the collision term, with an absorption term γN φ resulting from
the diagonalization of the relaxation tensors after the given N. Therefore, all
the moments of order higher than N are collapsed into a single non-equilibrium
term minimizing the truncation eﬀects on the ﬁne structure of the operator
spectrum.
Although very little is known about the true collision term Ω when multiple
collisions are considered, Eq. (22) generates increasing accuracy models to Ω
when the distribution function f is near the Maxwell-Boltzmann equilibrium
distribution, f eq. The only restrictions are: a) particles were considered as ma-
terial points without volume and b) particles internal energy and long-range
forces among the particles were not considered in the derivation.
When N = 0 or N = 1, Eq. (22) gives the well known BGK model, when all
the collision operator spectra is replaced by a single relaxation term.
Each term in the sum, in Eq. (22), gives the relaxation to the equilibrium of
second or higher order kinetic moments Mθ that are not preserved in collisions,
modulated by a λθ relaxation tensor. In Section 1.3, explicit expressions are
given for the collision models. When the diagonalization constant is consid-
ered to be zero, i.e., when the series, Eq. (19), is truncated above N, replacing
Ω = f eq
(φ) in the Boltzmann equation, the inner products of the resulting
equation by Ψχ,(sχ) give

L

L

where the distribution function f was developed following

∂taf

χ,(rχ) + ~c.

χ,(rχ) = λ(rχ)(sχ)aneq
af

χ,(sχ),

∇

Xθ

f =

−C2
e

f af

θ,(rθ)Ψθ,(rθ),

(23)

(24)

and

D/2

aneq
θ,(rθ) = n

m
2πkT (cid:19)
It can be easily seen that D ´Humi`eres moment equations ([9], [10]) are partic-
ular discrete forms of Eq. (23). Nevertheless, in d ´Humi`eres moments method,
all the b-moments in a b-discrete velocities set are considered. It was shown
in [11], that the number of degrees of freedom of a given lattice restricts the
order n of the kinetic moments with exact quadrature. This means that all

aφ
θ,(rθ).

(25)

(cid:18)

8

the moments which order are greater than n cannot be correctly described
in this given lattice. As it was mentioned in the Introduction, in the mo-
ments method these high-frequency moments are forced to give consistent and
numerical stable low-frequency macroscopic equations by using dispersion re-
lations, decreasing the eﬀect of numerical instability sources, but buﬀering the
appearance of complex ﬂow structures, when the Reynolds number increases.

1.3 Collision models for the continuous Boltzmann equation

In present section, the isotropy of 4th and 6th rank tensors will be used to
give explicit forms for the second and third-order collision models, Eq. (22).
Without any loss in the generality, we restrict ourselves to two-dimensional
spaces.

1.3.1 Second order model in the two-dimensional space

From Eq. (22)

λ(r2 ),(s2 )aφ

2,(r2)Ψ2,(s2) = λαβγδaφ

2,αβΨ2,γδ .

(26)

Requiring isotropy of 4th rank tensors and considering the symmetry with
respect to index permutation,

λαβγδ = λµ (δαβδγδ + δαγδβδ + δαδδβγ) .

(27)

In this way,

λαβγδaφ

2,αβΨ2,γδ = λµ

aφ
2,ααΨ2,γγ + aφ

2,αβΨ2,αβ + aφ

2,αβΨ2,βα

= λµ 

aφ
2,xx

2
f x −
C
(cid:16)

h




2,yy

+ aφ

1
2
f y −
2
C
(cid:16)
(cid:17)
2aφ
2,xyCf xCf y

i
+

1
2

(cid:17)

,






(28)

since aφ

2,αα = 0. Using Eq.(4)

λαβγδaφ

2,αβΨ2,γδ =

λµ
P (cid:20)

τxx

2
f x −

(cid:18)C

1
2 (cid:19)

+ τyy

2
f y −

(cid:18)C

1
2 (cid:19)

+ 2τxyCf xCf y

,

(cid:21)

(29)

9

or, from Eq. (8), τxx =

τyy

−

λαβγδaφ

2,αβΨ2,γδ =

λµ
P

τxx
h

2
f x − C
C
(cid:16)

2
f y

(cid:17)

+ 2τxyCf xCf y

.

i

(30)

Second order model in two dimensions will be written as

(2)(φ) =

L

λµ
P (cid:20)

−
γ3φ.

τxx

2
f x −

(cid:18)C

1
2 (cid:19)

+ τyy

2
f y −

(cid:18)C

1
2 (cid:19)

+ 2τxyCf xCf y

(cid:21) −

(31)

1.3.2 Third-order model

From Eq. (22)

λ(r3 ),(s3 )aφ

3,(r3)Ψ3,(s3) = λαβγδζη aφ

3,αβγΨ3,δζη .

(32)

For isotropic ﬂuids, tensor λαβγδζη is a linear combination of ﬁve 6th order
tensors given by the recurrence relation, [18],

∆(6)

r1....r6 = δr1rj ∆(4)

r1...rj−1,rj+1....r4,

(33)

resulting

λαβγδζη aφ

3,αβγΨ3,δζη = λ1aφ

3,αβγΨ3,αβγ + λ2aφ

3,αββΨ3,αββ

(34)

1.4 Macroscopic thermohydrodynamic equations

Macroscopic thermohydrodynamic equations may be obtained from the Boltz-
mann equation by multiplying this equation by the mass m, the momentum
m~c and the kinetic energy 1
2mc2 of the particles and integrating the resulting
equations in the ~c velocity space.
The mass conservation reads, as usually,

∂tρ + ∂α (ρuα) = 0.

(35)

10

(cid:19)

(cid:21)

¿From the momentum preservation in collisions

∂t (ρuα) + ∂α (ρuαuβ + P δαβ + ταβ) = 0,

(36)

where P is the thermodynamics pressure, P = nkT and ταβ is the viscous
stress tensor.
When Eq.(36) is multiplied by uα, the macroscopic kinetic energy, 1
ance equation is obtained

2ρu2, bal-

∂t

1
2

(cid:18)

ρu2
α

(cid:19)

= P ▽.u + ταβ∂βuα −

∂β

1
2

(cid:18)

ρu2

αuβ + P δαβuα + ταβuα

.

(37)

The total energy conservation equation reads

∂t

E +

(cid:18)

1
2

ρu2
α

(cid:19)

=

∂β

−

1
2

(cid:20)(cid:18)

ρu2

α + E

(cid:19)

uβ + (P δαβ + ταβ) uα + qβ

,

(38)

where E is the thermodynamics internal energy

E =

m (~c

~u)2 f d~c =

m (~c

~u)2 f eqd~c =

nkT.

(39)

1
2

Z

−

1
2

Z

D
2

The internal energy balance equation is obtained by subtracting Eq. (37) from
Eq. (38),

∂t (E) =

(P ▽.u + ταβ∂βuα)

∂β [Euβ + qβ] ,

(40)

−

where

(P ▽.u + ταβ∂βuα) is the source term of internal energy.

−

Equations (35, 36 and 40) form a closed set of equations when the viscous
stress tensor ταβ and the heat ﬂux vector qβ are known in terms of the spa-
tial gradients of the ﬁrst macroscopic moments, ρ, ~u and T of the distribution
function. This is accomplished when the Knudsen number, Kn
0, by per-
forming a Chapman-Enskog asymptotic analysis of the modelled Boltzmann
equation.

−→

−

−

11

1.5 Chapman Enskog analysis for the continuous model

Considering f 0 in the asymptotic expansion

f = f 0 + Knf 1 + ...,
(41)
to be the Maxwell-Boltzmann equilibrium distribution f eq(n, ~u, T ), the zeroth
order time derivative resulting from the Chapman-Enskog induced decompo-
sition of the time derivative reads,

1
f 0

d0f 0
dt

= 2

(cid:18)Cf αCf β −
2kT
m !

 

1/2

+

1
2

δαβ

(cid:19)

2
f −

(cid:18)C

∂βuα −
D + 2

2 (cid:19)

2
f α −

2
D (cid:18)C
~
Cf .▽ ln T.

D
2 (cid:19)

▽.~u

(42)

1.5.1 Second order model in two dimensions

Using Eqs. (42 and 31)

2

2
f x −

(cid:18)C

∂xux + 2

(cid:18)C

1
2 (cid:19)
1
2 (cid:19)
2
f x −

+

(cid:18)C

2
f y −
(cid:18)C
1
2 (cid:19)

2
f x −

τxx

− (cid:20)(cid:18)C
2λµ
P (cid:20)

−

=

1
2 (cid:19)
▽.~u +

2
f y −
1
2 (cid:19)(cid:21)

∂yuy + 2

Cf xCf y (∂xuy + ∂yux)
~
Cf .▽ ln T

2
f −
C

1/2

2

2kT
m !

(cid:16)

(cid:17)

+ τyy

2
f y −

(cid:18)C

+ 2τxyCf xCf y

(cid:21) −

γ3φ.

(43)

 
1
2 (cid:19)

For ﬁnding the correct expression of ταβ, in terms of the spatial derivatives
of the macroscopic variables, the inner product of the above equation by
Cf velocity space is performed. By multiplying the
Cf αCf β −
(cid:16)
above equation by

1
2 δαβ

(cid:17)

in the
2
f x −
C

(cid:16)

1
2

(cid:17)

(λµ + γ3)

τxx
P

=

∂xux +

−

▽.~u =

1
2

1
2

(∂yuy −

∂xux) .

Similarly

(44)

(45)

(λµ + γ3)

τyy
P

=

1
2

(∂xux −

∂yuy) ,

12

and

But

(λµ + γ3)

(∂xuy + ∂yux) .

(46)

τxy
P

=

1
2

−

These results give for the ﬁrst and second viscosity coeﬃcients,

in the relation

µ = η =

nkT
2λµ + γ3

,

ταβ =

µ (∂αuβ + ∂βuα) + η▽.~u.

−

Eq. (47) means that the ﬁrst and the second viscosity coeﬃcients are not
independent quantities and this result must be considered as a limitation
resulting from the continuous collision term itself, where the particles were
considered as material points with translational degrees of freedom. In fact,
this same result will be retrieved when using the third or higher order model
for the collision term. The consideration of internal energy modes would be
necessary for an up-grade of Eq. (47), [16].
The third-order moment aφ
Cf x. In this way,

3,xxx may be obtained by multiplying Eq. (43) by

2
f x −
C

3
2

(cid:16)

(cid:17)

Multiplying Eq. (43) by

2
f y −
C

1
2

Cf x,

(cid:17)

(cid:16)

aφ
3,xxx =

1/2

3
4 (cid:16)

2kT
m
(cid:17)
γ3

−

∂x ln T.

aφ
3,yyx =

1/2

1
4 (cid:16)

2kT
m
(cid:17)
γ3

−

∂x ln T.

qx = P

1/2

2kT
m !

 

(cid:16)

aφ
3,xxx + aφ

3,yyx

=

(cid:17)

P

2kT
m
(cid:16)
γ3T

−

∂xT,

(cid:17)

giving for the thermal conductivity

(47)

(48)

(49)

(50)

(51)

(52)

K =

(D + 2) nk2T
2m

1
γ3

.

13

In this manner, present second-order continuous kinetic model is thermody-
namic consistent and able for analyzing non-isothermal and fully compressible
ﬂows. The thermal conductivity is related to γ3 diagonalization constant. Con-
sideration of third-order models will be, only, necessary in multi-component
systems, for correctly describing third-order coupling: the Soret and Dufour
eﬀects, [16].

2 Discretization

In present sections an analysis is performed, trying to emphasize the theo-
retically identiﬁable eﬀects of time and velocity discretization on the ability
of the derived discrete models in retrieving the correct thermohydrodynamic
equations, i.e., the full compressible Navier-Stokes equations and the thermo-
dynamic internal energy balance equation, with the Fourier heat ﬂux term.

2.1 Time discretization

Boltzmann equation with the kinetic model Eq. (22)becomes

f + γN f = f eq

λ(r

),(s

θ

θ

)aφ

θ,(rθ )Ψθ,(s

θ

) + γN f eq.

(53)

N

Xθ=0

(δ2), Boltzmann equation is integrated be-
For avoiding time-step errors
tween t and t + δ, considering linear approximations for f eq (~x + ~ct′, ~c, t + t′)
and, also, for aneq
δ, [8]. The
result is

O
θ,(rθ ), since aneq

θ,(rθ ) (~x + ~ct′, t + t′), when 0

≤

≤

t′

f (~x + ~cδ, ~c, t + δ)

f (~x, ~c, t)

−

= (γN δ)

[f eq (~x + ~cδ, ~c, t + δ) + f eq (~x, ~c, t)]

N

−

+

X

(γN δ)

[f (~x + ~cδ, ~c, t + δ) + f (~x, ~c, t)]

δλ(r

),(s

)

θ

θ

Ψθ,(s

θ

)f eq (~x, ~c, t) X

(cid:17)

Xθ=0 (cid:16)
1
θ,(rθ ) (~x + ~cδ, t + δ) + aφ
aφ
2
h

θ,(rθ ) (~x, t)

.

i

(54)

This corresponds to an implicit numerical scheme (in fact, a Crank-Nicholson
scheme). Although implicit schemes are very easily manageable in the lattice-

14

d
dt

1
2

1
2

Boltzmann context, [13], [14], if one wants to avoid implicitness a new distri-
bution can be deﬁned as,

f = f + γN

δ (f

1
2

f eq)

−

N

δ
2

−

Xθ=0

λ(r

),(s

θ

θ

)aφ

θ,(rθ )Ψθ,(s

θ

)f eq,

(55)

resulting

e

=

f (~x, ~c, t) +

e

f (~x + ~cδ, ~c, t + δ)

δ
e
τN + 1
2δ
δ
τN + 1
2δ

f

+

f eq
(cid:16)
N

−

(cid:17)
e
τN λ(r

)aφ

θ,(rθ )f eqΨθ,(s

θ

),

),(s

θ

θ

(56)

Xθ=0
. It must be observed that aφ
f . Nevertheless, it can be shown from Eq. (55) that

θ,(rθ ) are the macroscopic moments
aφ
θ,(sθ ) and

where τN = 1
γN
of f and not of
aφ
θ,(rθ ) are directly related by

e

e

aφ
θ,(sθ ) =

1 +

 

δ
2τN !

aφ
θ,(sθ ) −

δ
2

λ(r

),(s

θ

θ

)aφ

θ,(rθ ),

e

Consider, for instance, the second order model. In this case, it can be shown
that

λ(r

),(s

θ

θ

)aφ

θ,(rθ ) = λαβγδaφ
2λµ
=

2,αβ =
aneq
2,γδ

−
,

−

(cid:16)

(cid:17)

λµ (δαβδγδ + δαγδβδ + δαδδβγ) aφ

2,αβ

since aneq

2,αα = 0 and λµ is required to be positive. Eq. (57) means

(57)

(58)

(59)

aφ
2,γδ =

1 +

 

δ
2τN

+ δλµ

aφ
2,γδ.

!

e

2.2 Velocity discretization

Velocity discretization is the most critical step in presently proposed proce-
dure. For athermal problems He and Luo, [11], have shown that some widely
~ci, i = 1, ...b
may be derived from the con-
used sets of discrete velocities
}
{
tinuous velocity space by Gauss-Hermite (D2Q9, D3Q27) and Gauss-Radau
(D2Q7) quadrature. All these sets are space-ﬁlling, in the sense that for every

15

lattice site ~x, ~x + ~ci points to another site in the lattice.
If it is agreed that quadrature is the bridge connecting the continuous and the
discrete velocity space, discretization means to replace the entire continuous
velocity space cD by some discrete velocities ~ci satisfying the quadrature for
all the kinetic moments of interest, i.e., for all the kinetic moments that are to
be correctly described in lattice-Boltzmann simulation. Although it is highly
desirable set ~ci to be space-ﬁlling, this condition is not essential for the dis-
cretization itself.
When performing the quadrature, an integration variable must be chosen. If
the dimensionless ﬂuctuation velocity ~
is chosen as the integrat-

Cf = ~c−~u
m )1/2

( 2kT

ing variable, considering χ to be a polynomial of degree r in the velocity,

b

1
πD/2

,

−C2
e

f χ′

ωiχ′

Z

Z

(cid:16)

(cid:17)

(cid:17)

Xi=1

(60)

< χ >=

f χd~c = n

~
Cf i
(cid:16)

d ~
Cf = n

~
Cf
where ~
Cf i is a discrete velocity (a constant vector), dependent, basically, on
b and on the kind of quadrature operation it is being performed, χ′
is
a polynomial in ~
Cf of degree rp = r +s when it is related to a preserved
moment and rp = r+s+1, otherwise, [11], s being the degree of the polynomial
approximation to f eq and ωi are the constant weights to be attributed to each
discrete velocity ~
Cf i. Exact quadrature restricts the highest value of rp to rpm.
For a given class of quadrature we can write rpm = rpm(b), in the sense that
increasing b enables higher degree polynomials to have exact quadrature.
For the ﬁrst kinetic moment, n,

~
Cf
(cid:16)

(cid:17)

n =< 1 >= n

ωi1 = n

ωi,

(61)

1
πD/2

Z

−C2
e

f 1d ~

Cf = n

b

Xi=1

b

Xi=1

resulting,

This means that the discrete equilibrium distribution does not depend, explic-
itly, on the macroscopic velocity ~u and on the temperature T . These depen-
dences are included in the particle velocities through,

~ci = ~u +

1/2

2kT
m !

 

~
Cf i = ~ci (T, ~u) .

When the ~
Cf i generate a regular lattice, this choice is possible in LB frame-
work, since LB simulation may, at least in principle, be performed in the
(~x, ~
Cf i) space. Nevertheless, the physical grid (~x, ~ci), i.e., the physical grid

(62)

(63)

f eq
i = ωin.

16

points where the particles will be located after each time step, will be time de-
pendent, simulation tends to be very cumbersome and, at a ﬁrst sight, bound-
ary conditions will be diﬃcult to satisfy.
Another choice is the dimensionless particle velocity ~
C

~c
m )1/2 . This re-
( 2kT
quires to rewrite the equilibrium distribution as in Eq. (1), but, now, the
series

=

θ,(rθ )(n, ~
aeq
U

, T )Ψθ,(rθ ),

Xθ

(64)

must be truncated somewhere. This is an important distinguishing point of
discrete models, since in each continuous model presented in Section 1.3, al-
though the full collision term is replaced by its Nth-order approximation, the
equilibrium distribution is, always, the full MB distribution.
Second-order approximations are widely used in athermal simulation, but ther-
mohydrodynamics require third (or higher) order approximations for the equi-
librium distribution,

f eq = n

e−C2
πD/2

m
2kT (cid:19)

(cid:18)

D/2

1 + 2

CαUα + 2
CαCβ −
(cid:16)
3
2δαβ
CαCβ −
(cid:16)

4
3

(cid:17)

1
2δαβ

UαUβ+

(cid:17)

CγUαUβUγ

,











(65)

which can be viewed as a third-degree polynomial expansion of the f eq depen-
dence on ~
U
U
After quadrature, the equilibrium distribution becomes

, with errors O(

4).

1
2δαβ)

UαUβ

,



(66)

f eq
i = ωin 

1 + 2

CiαUα + 2(
CiαCiβ −
(cid:16)

CiαCiβ −
3
2 δαβ




+ 4
CiγUαUβUγ
3
where, as above, the weights ωi and the velocity vectors ~
Ci are dependent on
b and on the kind of quadrature that was performed.
When ~u = 0, the equilibrium distribution is only dependent on the tempera-
ture T through the number density of particles, n. Nevertheless, the particle
velocities are temperature dependent,




(cid:17)

1/2

~ci =

2kT
m !

 

~
Ci = ~ci (T ) .

(67)

A simulation alternative is presented, in this case, by redistributing the par-
ticles among adjacent sites, in accordance with allocation rules, locally pre-
serving the mass, momentum and kinetic energy of the original packet. This
strategy will be discussed in Section 2.3, leading to the establishment of tem-
perature dependent velocity models (TDV).

17

Pavlo et al., [12], developed a TDV model based on an octagonal lattice,
which is not space-ﬁlling but assures the isotropy of 6th rank tensors. It can
be shown that this octagonal discrete velocities set can be retrieved using a
Gauss-Radau quadrature, with 8 angular directions, giving rpm = 7, instead
of 5 as in the D2Q7 model and assuring the exact quadrature of third-order
moments. Additional considerations can be found in Section 2.4.
Avoiding the ~ci temperature dependence requires to consider the particles ve-
locity ~c as the integrating variable when performing the quadrature, i.e., to
let c2 free from T in the exponential part e−C2of the equilibrium distribution.
This can be accomplished by writing

− (c−u)2
2kT
e

m =

−C2
e
f o

T0
T ,

(cid:16)

(cid:17)

(68)

where T0 is a reference (and constant) temperature and ~

Cf o = ~c−~u
m )1/2 is a
( 2kT0
new dimensionless ﬂuctuation velocity referred to the temperature To. When
T is near T0, i.e., when the departures from thermal equilibrium are small,
the above expression may be developed in a Taylor series around T
= 1.
To
Considering Θ = T
1, this development gives

To −

−C2
e
f o
(cid:16)

T0
T = e

−C2
f o

1 +
(cid:20)

2
f oΘ +
C

1
2 C

2
f o

(cid:17)
which terms are increasing powers of
In this way, retaining just the ﬁrst power in θ,

2
f o.
C

2

2
f o −
C
(cid:16)

(cid:17)

Θ2 + ...
(cid:21)

,

(69)

f eq = n

D/2

T0
T (cid:19)

(cid:18)

D/2

h
1 + 2

1 +

i

(cid:18)

m
2kT0 (cid:19)

1
2
f oΘ
πD/2
C
C0,αU0,α + 2
C0,αC0,β −
(cid:16)
3
+ 4
2δαβ
C0αC0β −
3

(cid:16)

1
2 δαβ

U0,αU0,β

(cid:17)

C0γU0αU0βU0γ

(cid:17)

,






e−C2

o

×






(70)

where ~

U0 =

~u
m )1/2 .
( 2kT0

In this case, the quadrature will give for the discrete equilibrium distribution,

f eq
i = gi

T,

2
f 0,i

C

(cid:16)

(cid:17)

ωin 

1 + 2

C0,iαU0,α + 2
C0,iαC0,iβ −
(cid:16)
+ 4
3
2 δαβ
CiαCiβ −
3

(cid:16)

CiγU0αU0βU0γ

(cid:17)

1
2δαβ

U0,αU0,β

(cid:17)









, (71)

18

where

D/2

(cid:16)

(cid:17)

(cid:18)

C

gi

=

T,

1 +

2
f 0,i

T0
T (cid:19)
is a temperature dependent weight. When T > T0, gi reduces the amount
of particles with zero velocity, redistributing them to the kinetic modes i in
2
f 0,i and inversely when T < T0. It is well known by LB
accordance with
C
practitioners that this redistribution is highly desirable in LB simulation and
redistribution rules were empirically found by some authors (e.g., [5]).
Considering a linear approximation to the temperature non-equilibrium,

2
f o,iΘ
C

(72)

h

i

,

D/2

T0
T (cid:19)

(cid:18)

1

≈

−

D
2

Θ.

Eq. (72) can also be written as

gi

T,

(cid:16)

2
f 0,i

C

(cid:17)

= 1

D
2

−

Θ +

2
f 0,iΘ + O
C

Θ2

,

(cid:16)

(cid:17)

and the equilibrium distribution may be written as a sum of two distributions

where, dropping-out the third-order term,

i = f eq
f eq

i,n + f eq
i,T ,

f eq
i,T = Θ

2
f 0,iωin
C

1 + 2
(cid:20)

C0,iαU0,α + 2

(cid:18)C0,iαC0,iβ −

1
2

δαβ

(cid:19) U0,αU0,β

(cid:21)

.

(76)

This equilibrium distribution is related to the thermal distribution function
g in He et al. two-distributions model, [8]. To ﬁt the model into a D2Q9
lattice, He et al. have, further, replaced
, truncating all

2

2
f 0,i by
C

~
C0,i −

~
U0

3
0,i

(cid:17)

C
(cid:16)

the terms O
and higher, after the multiplication. It can be easily seen
that the resulting expression has second-order errors O (Θ
U0) limiting He et
al.’s model to low local speeds.
We have preferred a somewhat diﬀerent decomposition in Eq. (68), working
with the particles velocity ~c and not with the ﬂuctuation velocity (~c
~u),
making

−

(cid:17)

(cid:16)

(73)

(74)

(75)

(77)

− c2
2kT
e

m =

e−C2

o

T0
T ,

(cid:16)

(cid:17)

19

resulting in a temperature dependent weights model (TDW), which equilib-
rium distribution is given by

1 + 2

C0,iαU0,α
T
T0

+ 2

C0,iαC0,iβ −
(cid:16)

+ 4
3

C0iαC0iβ −
(cid:16)

3
2

T
T0

δαβ

(cid:17)

1
2

T
T0

δαβ

U0,αU0,β
2

T
T0

C0iγ U0αU0βU0γ
(cid:16)

(cid:17)

(cid:17)

3

T
T0

(cid:16)

(cid:17)

ωin 






,

(78)









f eq
i = gi

2
0,i

C

T,
(cid:16)

(cid:17)

where

gi

T,

(cid:16)

2
0,i

C

(cid:17)

= 1 +

2
0,i −

(cid:18)C

D
2 (cid:19)

Θ.

(79)

2

,

T
T0

Since T
, ... in Eq. (78), appears inside the polynomial expansion these
T0
terms must be, also, developed in θ for preserving consistency in the order of
approximation. After multiplication, an expression for the equilibrium distri-
bution in 2D problems can be written as

(cid:16)

(cid:17)

(cid:16)

1

2

+2

Θ + 2

(cid:17)
− U

f eq
i = ωin 


2
1 +
0,i −
C
3
h
(cid:16)
C0,i ~.
~
0 + 4
2
U 0
3

2
1 +
0,i −
C
2
C0,i ~.
~
U 0
(cid:16)
(cid:17)
with errors O (Θ2,
2
0 Θ). A redistribution expression similar to the above one
was obtained by Shan and He, [19]. Large temperature deviations require to
consider additional powers in Θ, in the Taylor expansion, Eq. (79) and to
increase the number of discrete velocities in the lattice. This will be discussed
in Section 2.4.3.

C0,i. ~
~
Θ
U0
i
C0,i. ~
~
U0

2
0
U

(80)








−

(cid:17)
2

U

(cid:16)

(cid:17)

(cid:17)

(cid:16)

,

2.3 TDV model: allocation rules and collision step

Considering the analysis shown in the last section, TDV models appear to be a
promissing alternative for LB simulation of non-isothermal problems, since no
theoretical limitations were identiﬁed, related to the thermal non-equilibrium
deviation Θ, as in the TDW models, Eq. (80), where the Taylor series in Θ, Eq.
(79) was truncated after the ﬁrst-order term. In present section this model is
discussed, considering that temperature-dependent velocities require to mod-
ify the propagation step in the LB simulation scheme.
After quadrature, the third-order approximation to the equilibrium distribu-

20

tion Eq. (66) can be written in a general form as

f eq
k
ωkn

=

1 + 2a2 c∗

α

kαu∗
T
T0

+ 2a4

+ 4

3 a6

kαc∗
c∗
(cid:16)

kβ −

kαc∗
c∗
(cid:16)

kβ −

3
4a2

T
T0

δαβ

1
2a2

T
T0

δαβ

kγ u∗
c∗

αu∗

(cid:17)
βu∗
(cid:16)
γ

3

αu∗
u∗

β

2

T
T0

,

(cid:17)

(cid:17)

T
T0

(cid:16)

(cid:17)

where a is a lattice constant related to the lattice symmetry. The ωk are the
lattice-weights, deﬁning the inner product

f.g =

ωkfkgk.

Xk

In general, the discrete velocities set generated by quadrature will be not space-
ﬁlling requiring simulation strategies similar to the one proposed by Pavlo et
al., [12]. In space-ﬁlling lattices such as, e.g., the D2Q13H, the equilibrium
distribution will keep the form given by Eq. (81) but the weights ωk must be,
empirically chosen for ensuring isotropy of even-parity rank velocity tensors
up to the 6th-rank.
Particle velocities are given by

h
δ
where the lattice dimension h is given by

~ck =

~c∗
k.

and

h
δ

= a

2kT0

 

m !

1/2

,

~c∗
k =

T
T0

s

~ek,

where

~ek, k = 0, ..., b
}
{

are the lattice unity-vectors.

In present scheme, macroscopic velocity ~u∗ = ~u/

k fk~c∗

k where n =

k fk. Temperature is found to be such that

(cid:16)

h
δ

, is calculated as n~u∗ =
(cid:17)

P

P

n

T
T0

= a2

Xk

fk (~c∗

k −

~u∗)2 .

After discretization, the second-order model reads, in two-dimensions reads

21

(81)

(82)

(83)

(84)

(85)

(86)

(87)

(88)

(89)

fk (~x + ~c∗
δ
τ3 + 1
2δ

kδ, t + δ)
f eq
k −

(cid:16)

=

fk (~x, t) +
f

f

6a2 τ3
τµ
×

1

T
T0

(cid:16)

(cid:17)

2 f eq

k 

τ ∗
yy




e

(cid:16)

where τ3 = 1/γ3 and τµ = 1/λµ.

δ
τ3 + 1
2 δ

−

fk

(cid:17)

e

τ ∗
xx

(cid:16)
c∗2
f k,y −
e

c∗2
f k,x −
1
T
2a2
T0

(cid:17)

1

1 + δ
2τ3

+ δ
2τµ

(cid:18)

(cid:19)

1
2a2

+ 2

T
+
T0
(cid:17)
f k,xc∗
xyc∗
τ ∗

f k,y

,






e

The dimensionless viscous stress tensor is calculated as,

τ ∗
αβ =

ταβ
2a2nkT0

=

1
n

f neq
k

kαc∗
c∗

kβ,

Xk

and the heat ﬂux, as

q∗
γ =

qγ
a2kT0

h
δ

=

Xk

f neq
k

f kγc∗2
c∗
f k.

The modiﬁed ﬂuxes
sions in terms of

τ ∗
αβ and
f neq
.
k
e

e

q∗
γ needed in the simulation have similar expres-

e

q

q

T
T0

i =

fi (~x, t)

T
T0 ≤

~ei. When

The particles that are present at site ~x after the collision step have a ve-
locity ~c∗
1, the kinetic energy these particles have
is just enough to enable them to jump to some intermediate position be-
tween ~x and ~x + ~ei. In present discrete model these particles are redistributed
to the next contiguous sites ~x and ~x + ~ei preserving the mass, kinetic en-
fi (~x, t). This is per-
ergy and the momentum of the original particles packet
fi (~x, t)
fi,0 (~x, t + δ) =
and
formed by using a lever´s rule, making
e

T
T0
fi,0 and
fi,−1 (~x + ~ei, t + δ) =
e
fi,−1 the same non-integer velocity ~c∗
i related to the particles-packet before
e
the propagation. In this way model particles are velocity-memory particles in
e
fij, the index i is related to the site
the propagation step. In the notation
direction and j means from what site these particles were come: j = 0 means
that the particles were come from the same site, j =
~ei,
j =
In this manner, the particles propagated along the direction i are redistributed
among the departure site and the next-one contiguous site, but have their ve-
locity unaltered, after the propagation. These rules preserve, locally, mass,
momentum and energy and non-physical convection is avoided.

−
, and by imposing to both amounts

2, from the site ~x

1, from the site ~x

2~ei and so on.

T
T0

−

−

−

−

1

(cid:17)

(cid:16)

(cid:17)

(cid:16)

e

e

e

e

22

When 1

2 , particles will be redistributed following

T
T0 ≤

≤

q

fi,−1 (~x + ~ei, t + δ) =

fi (~x, t)

and

e

e

1
4
3 (cid:18)

−

T
T0 (cid:19)

,

1
3 (cid:18)

T
T0 −

1

.

(cid:19)

(90)

(91)

fi,−2 (~x + 2~ei, t + δ) =

fi (~x, t)

e

q

T
T0

greater than 2 are not expected in present work,

e
Temperature ratios
since they would represent very strong thermal non-equilibrium.
After propagation, at time step t, all the distributions
fi,j (~x, t) are known in
fi,j (~x, t) enable to calculate the equilibrium moments
each site ~x. The amounts
n(~x, t), u∗(~x, t) and T (~x, t) and the equilibrium distribution, Eq. (81), with
k = (i, j).
f eq
ij and the viscous
The non-equilibrium distributions are given by
stress tensor can be thus calculated. In the collision step, collision will give a
e
single distribution
fi,j in the direction i
(~x, t) from the several j amounts
of the site ~x at time t,

f neq
i,j =

fi,j −

fi

e

e

e

′

′

fi

e

(~x, t) =

Xj

e






fi,j + δ
τN + 1
2 δ

e

1

T
T0

(cid:16)

(cid:17)

τ ∗
xx

2 f eq

ij 

e




fi,j

f eq
ij −
(cid:17)
(cid:16)
e
c∗2
1
f,ij,x −
2a2
(cid:16)

+2

δ
τN + 1
2 δ

−

(cid:16)

τ ∗
T
+
yy
T0
(cid:16)
(cid:17)
f,ij,xc∗
xyc∗
τ ∗
f,ij,y
e

e

e

6a2 τ3
τµ
+ δ
2τµ

1+ δ
2τ
N

×

c∗2
f,ij,y −

(cid:17)
1
2a2

T
T0

.






(92)

(cid:17)






q

T
T0

i =

These particles will move to the next sites with the site velocity ~c∗
~ei,
where T = T (~x, t) is the site temperature, calculated using Eq.( 86), just after
the propagation step and with k replaced by (i, j).
In the propagation step, a fraction of the low-speed particle-packets, in sites
where T is small, will remain in its departure site. The overall eﬀect is to
increase the number-density of particles in the sites where the temperature
is small and to decrease it in the sites where the temperature is high, emu-
lating the temperature dependence of the MB distribution. In this way, the
equilibrium distribution is temperature dependent even when the macroscopic
velocity ~u is zero, i.e., when f eq
i = ωin, because n is temperature dependent.
Also, the temperature derivative of the equilibrium distribution will vary in-
versely with the temperature, similarly to its continuous counterpart. This is
an important condition for retrieving the temperature derivative term in the
second member of Eq.(42).
Nevertheless, the temperature dependence of n is related to the particles al-
location rules used and further theoretical analysis of presently proposed pro-

23

cedure leading to a correct Chapman-Enskog analysis of TDV model is, cur-
rently, under investigation.

In this section, the TDW and TDV models are explicitly written for the D2Q9
lattice and their feasibility for simulating isothermal and non-isothermal prob-
lems in this lattice is discussed.

2.4 The nine bits lattice

2.4.1 TDW model

The D2Q9 lattice is not suitable for thermal problems since: i) 6th rank ten-
sors are not isotropic, ii) energy transfer qαβγ is not correctly described in
this lattice and iii) the lattice-dimensionality is too small. However, the use of
thermal models in the D2Q9 lattice can, possibly, be shown to be a promising
alternative for simulating near -isothermal problems, when the main interest
is to increase numerical stability, with respect to athermal simulation. In fact,
in its kinetic theory concept, temperature is varying from site to site, with the
local velocity ~u. When this variation is not considered, i.e., when the growing
of temperature gradients are not annihilated by heat ﬂow, they can, possi-
bly, become instability sources in the numerical scheme. Actually, in contrast
with classical CFD simulation of isothermal Navier-Stokes equations, lattice-
Boltzmann simulation is never isothermal and the consideration of heat ﬂow
should be helpful in the simulations.
For the D2Q9 lattice, rpm(b) = 5 = 2X3
[11]

1. Gauss-Hermite quadrature gives,

−

~
C0,i =

s

3
2

~ei

(93)

−

1, 0), (0,

1), (1, 1), (

where ~ei = (0, 0), (1, 0), (0, 1), (
1).
The weights ωi are found to be ω0 = 4/9, ωi = 1/9, i = 1, ..., 4 for the main
axes and ωi = 1/36, i = 5, ..., 8, for the diagonals.
Using a dimensionless macroscopic velocity ~u∗ = ~u
and dropping-out the
third-order term, since, as commented above, the exact description of energy
transfer is out of thought in this lattice, the equilibrium distribution in the

1, 1), (

1), (1,

−

−

−

−

−

1,

h
δ

24

(94)

(95)

(96)

(97)

(98)

(99)

TDW model will read

f eq
i = ωin 

1 + 3
2

e2
i −

(cid:16)




1 + 3
2
Θ + 3
3
2
(cid:17)
h
2 (~ei.~u∗)2
+ 9

e2
i −
(cid:16)
2 (u∗)2

3

4
3

−

Θ

~ei.~u∗

(cid:17)

i

.






It can be easily seen that the equilibrium distribution given by Eq. (94) satisﬁes

n =

f eq
i

,

Xi

Xi

n~u =

f eq
i ~ci,

P = nkT.

The internal energy

the momentum ﬂux

and the heat ﬂux

f eq
i

1
2

m(~ci −

~u)2,

E =

Xi

Πeq

αβ =

f eq
i mciαciβ,

Xi

qeq
α =

f eq
i

1
2

Xi

uα) ,

~u)2 (ciα −

m(~ci −
2 nkT , P δαβ + ρuαuβ and 0, with errors

(100)

are also retrieved as, respectively, D
O (

0 Θ, Θ2).
2
U

2.4.2 TDV model

All the restrictions given by Eqs.(95-97 and 98-100) are satisﬁed when the
equilibrium distribution is given by Eq. (81), dropping-out the third-order

25

term, i.e.,

f eq
k = ωkn 

1 + 3

kαu∗
c∗

α

T
T0

+

9
2 (cid:18)

kαc∗
c∗

kβ −

1
3

T
T0

δαβ




αu∗
u∗

β
2 

.

(cid:19)

T
T0

(cid:16)

(cid:17)




(101)

Particles redistribution in TDV model should increase numerical stability with
respect to the athermal simulation method, since, in this last scheme, particle
allocation is not temperature dependent and sites with higher T will rest with
an excess amount in the number of particles, contributing to the enhancement
of non-physical source-terms.
In Pavlo et al. , [12], TDV model, the use of an octagonal lattice, instead
of the D2Q9 lattice, was considered for ensuring isotropy for the 6th-rank
tensors. A second-order interpolation scheme is used for allocating the particles
among adjacent sites in the propagation step, following a procedure that is
similar to the one exposed in Section 2.3, but the model particles are not
velocity-memory particles and the D2Q9 ~ei lattice-velocities are attributed to
the redistributed packets. This is performed preserving mass, momentum and
energy. After the propagation, the number density, the momentum and the
kinetic energy are calculated in each site. Previously to the collision step, the
distributions fi are renormalized to account for the octagonal lattice velocities,
satisfying the new local moment constraints. Successive transitions between
the D2Q9 and the octagonal lattice can aﬀect the isotropy properties of the
6th-rank tensors and, in our opinion, this is the only question that remains
to be answered, since numerical viscosity eﬀects can be avoided by reducing
the spatial scale. In this manner, the problem is, nearly, the same as above,
because the correct description of the heat ﬂow vector cannot be assured in
this model.

2.4.3 Increasing the number of discrete velocities

After the very promising results of He and Luo’s work, [11], when the D2Q9,
D2Q7 and D3Q27 lattices were found by exact quadrature, it is, now, appar-
ent that the integer multiplicative factors that are required by regular-lattice
velocity components are a too strong restriction: for their exact quadrature,
Maxwellian-shaped curves require the roots ciα to be progressively close when
their absolute values increase.
For some regular lattices, the weights ωi can be found to give even-parity
isotropic tensors. In this manner, isotropy up to the 6th-rank tensors is as-
sured for the D2Q13H lattice by choosing ω0 = 132/300, for the zero velocity,
= 1 and ω2 = 1/300 for
ω1 = 27/300 for the ﬁrst 6 velocity vectors, with
the next 6 velocity vectors, with
Simulation of non-isothermal problems is possible in this lattice by using third-

~ei|
|
= √3. In this lattice h/δ =

10kT0
3m .

~ei|
|

q

26

order approximations to the MB equilibrium distribution, derived, alterna-
tively, from Eq. (80) in the TDW model or from Eq. (81) in the TDV model.
In TDW models, improving the approximation, Eq. (80), to the MB equilib-
rium distribution, considering Θ2 powers in Eq. (69), also requires to take
C0 into account and, consequently, to consider 4th- de-
4th-degree powers of
gree polynomial expansions in
U0 for the equilibrium distribution. This has
been performed for a D2Q21S lattice, choosing the weights ωi for giving even-
parity isotropic tensors up to the 6th-rank and for retrieving the equilibrium
U0Θ2, ...). The
conditions, Eqs.(95-97 and 98-100), with errors O (
D2Q21S is composed by the zero velocity and by the superposition of ﬁve
square lattices with a 450 shift between each two sequential lattices, with
speeds 0, 1, √2, 2, 2√2 and 3. The equilibrium distribution was found as

0 Θ, Θ3,
3
U

5
0 ,

U

f eq
i = ωin













1 + (e2

2e2
1) Θ + (1
i −
+2 (~ei.~u∗)2 (1 + (e2

−

i + e4

i /2) Θ2 + 2 [1 + (e2
(u∗)2 (1 + (e2

3) Θ)

2) Θ] ~ei.~u∗

2) Θ)

+ 4

3 (~ei.~u∗)3

i −

−
2 (~ei.~u∗) (u∗)2 + 2
2 (u∗)4

2 (~ei.~u∗)2 (u∗)2 + 1

−

−

i −
i −
3 (~ei.~u∗)4



.










(102)

with weights ωi =

379

1152 , 41

384 , 5

96 , 31

3840 ,

1
1536 ,

1
5760

.

n

o

3 Conclusion

As a kinetic method, LBM is based on a discrete and ﬁnite approximation to
the continuous Boltzmann equation giving an approximated solution to the
particles distribution function. In this manner, all the macroscopic moments
of interest will be aﬀected by the accuracy of the modelled LBE when com-
pared to its full continuous counterpart.
MRT increasing accuracy models to the collision term Ω were derived col-
lapsing the higher-order terms, related to the relaxation of the higher-order
moments, into a single non-equilibrium term, minimizing the truncation ef-
fects on the ﬁne structure of the collision operator spectrum.
Thus, in contrast with the moments method, only the hydrodynamic moments
that are required to be correctly described, are considered in the present mod-
els. This strategy avoids the use of dispersion relations for buﬀering undesir-
able eﬀects of the high-frequency, non-hydrodynamic moments, but claims to
increase the lattice dimensionality.
Time discretization requires implicit or modiﬁed explicit numerical schemes
(δ2) time step errors and non-physical source terms in the in-
for avoiding

O

27

ternal energy balance equation.
For the discretization of the velocity space, the requirements for the Boltzmann
equation quadrature to be exact establishes the minimal discrete velocity set
that is needed for the lattice, in accordance with the order of approximation
for the kinetic model that is intended to be used. Nevertheless, these sets do
not generate regular lattices when multi-speed models appropriated for ther-
mal problems are considered.
When performing the quadrature, it was shown that the integrating variable
has an important role in deﬁning the equilibrium distribution and the lattice-
Boltzmann model, leading, alternatively, to temperature dependent velocities
(TDV) and to temperature dependent weights (TDW) lattice-Boltzmann mod-
els.
In TDV models no theoretical limitations were identiﬁed, related to the ther-
mal non-equilibrium deviation Θ, as in the TDW models.
Finding the macroscopic behavior of TDV models through a rigorous Chapman-
Enskog analysis is diﬃcult due to the implicit number density of particles
dependence on the temperature and is, still, in progress.

Acknowledgements

Authors are greatly indebted to ANP (Brazilian Petroleum Agengy), CNPq
(Brazilian Research Council), Finep (Brazilian Agency for Research and Projects)
and Petrobras (Brazilian Petroleum Company) for the ﬁnancial support.

References

[1] Lallemand, P. and Luo, L. S.: Theory of the lattice Boltzmann method: Acoustic
and thermal properties in two and three dimensions, Phys. Rev. E, 68(3):036706,
2003.

[2] Bhatnagar, P.L., Gross, E.P. and Krook, M.: A model for collisional processes in
gases: small amplitude processes in charged and neutral one-component system,
Phys. Rev. 94, 511, 1954.

[3] Qian, Y.H., D’Humi`eres, D. and Lallemand, P.: Lattice BGK models for Navier-

Stokes equation. Europhys. Lett., 17(6): 479-484, 1992.

[4] Chen, H., Chen, S. and Mathaeus, W.: Recovery of the Navier-Stokes equation

using a lattice-gas Boltzmann method. Phys. Rev. A, 45(8): 5339-5342, 1992.

[5] Alexander,

J.D.:
themohydrodynamics, Phys. Rev. E 47, R2249, 1993.

Sterling,

Chen,

F.J.,

S.,

Lattice

Boltzmann

[6] McNamara, G. and Alder, B. J.: Analysis of the lattice Boltzmann treatment

of hydrohynamics, Physica A, 194: 218-228, 1993.

28

[7] Chen, Y., Ohashi, H. and Akyama, M.: Thermal lattice Bhatnagar-GrossKrook
model without non-linear deviations in macrodynamic equations, Phys. Rev. E
50, 2776-2783, 1994.

[8] He, X., Chen, S. Doolen, G.D.: A novel thermal model for the lattice Boltzmann

method in incompressible limit, J. Comp. Phys. 146, 282-300, 1998.

[9] d’Humi`eres, D.: Generalized Lattice Boltzmann Equations, in : Rareﬁed Gas
Dynamics: Theory and Simulations, Prog. Astronau. Aeronaut. 159, 450-458,
1992.

[10] d’Humi`eres, D., Bouzidi, M. and Lallemand, P.: Thirteen-velocity three-

dimensional lattice Boltzmann model, Phys. Rev. E 63: 66702, 2001.

[11] He, X., Luo, L.S.: Theory of the lattice-Boltzmann method: ¿From the
Boltzmann equation to the lattice-Boltzmann equation, Phys. Rev. E 56, 6811-
6817, 1997.

[12] Pavlo, P., Vahala, G. , Vahala, L.: Preliminary results in the use of energy-
dependent octagonal lattices for thermal lattice Boltzmann simulations,J. Stat.
Phys. 107, 499-519, 2002.

[13] Toelke, J., Krafczyk, M., Schulz, M., Rank, E., Berrios, R.:
approaches

Implicit
discretization and non-uniform mesh reﬁnement
for FD
discretizations of LBGK Models, Int. J. of Mod. Physics C 9, 1143-1157, 1998.

[14] Sankaranarayanan, K., Shan, X., Kevrekidis, I.G., Sundaresan, S.: Analysis of
drag and virtual mass forces in bubbly suspensions using an implicit formulation
of the lattice Boltzmann method, J. Fluid. Mech 452, 61-96, 2002.

[15] Cercignani, C.: Mathematical Methods in Kinetic Theory, First edition,

Macmillan, London, 1969

[16] Philippi, P. C. and Brun, R.: Kinetic modeling of polyatomic gas mixtures,

Physica A, 105(1-2): 147-168 , 1981.

[17] Grad, H.: Principles of the Kinetic Theory of Gases, in : Handbuch der Physik

12, Springer, New York, 205-294, 1958.

[18] Wolfram, S.: Cellular automation ﬂuids 1: basic theory, J. Stat. Phys. 45, 471-

526, 1986.

[19] Shan, X. and He, X.: Discretization of the velocity space in the solution of the

Boltzmann equation, Phys. Rev. Lett. 80,65-68, 1998.

29

