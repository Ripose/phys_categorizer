Simulating temporal evolution of pressure in two-phase ﬂow in porous media

Eyvind Aker∗, Knut Jørgen M˚aløy
Department of Physics, University of Oslo, N-0316 Oslo, Norway

Alex Hansen†
Department of Physics, Norwegian University of Science and Technology, N-7034 Trondheim, Norway
(February 2, 2008)

We have simulated the temporal evolution of pressure due to capillary and viscous forces in
two-phase drainage in porous media. We analyze our result in light of macroscopic ﬂow equations
for two-phase ﬂow. We also investigate the eﬀect of the trapped clusters on the pressure evolution
and on the eﬀective permeability of the system. We ﬁnd that the capillary forces play an important
role during the displacements for both fast and slow injection rates and both when the invading ﬂuid
is more or less viscous than the defending ﬂuid. The simulations are based on a network simulator
modeling two-phase drainage displacements on a two-dimensional lattice of tubes.

47.55.Mh, 07.05.Tp, 05.40.+j

I. INTRODUCTION

Fluid ﬂow in porous media such as sand, soil and fractured rock is an important process in nature and has a huge
number of practical applications in engineering. Most often mentioned is oil recovery and hydrology. Fluid ﬂow in
porous media has also been of great interest in modern physics. In particular, the diﬀerent structures of the interface
between the ﬂuids in two-phase displacements have been extensively studied. Despite this attention there are still
many open questions concerning ﬂuid ﬂow in porous media.

In this paper we report on simulations of the temporal evolution of pressure during two-phase drainage in a model
porous medium, consisting of a two-dimensional lattice of tubes. The network model has been developed to measure
the time dependence of diﬀerent physical properties and to study the dynamics of the ﬂuid movements. Especially,
we focus on the dynamics of the temporal evolution of the pressure due to capillary and viscous forces and the time
dependence of the front between the two liquids. The discussion is restricted to drainage displacement, i.e. the process
where a non-wetting ﬂuid displaces a wetting ﬂuid in a porous medium.

During the last two decades an interplay between experimental results and numerical simulations has improved
the understanding of the displacement process.
It has been shown that the diﬀerent structures observed when
changing the physical parameters of the ﬂuids like viscosity contrast, wettability, interfacial tension and displacement
rate [1–6] divide into three ﬂow regimes. These three major regimes are referred to as viscous ﬁngering [1,2] stable
displacement [3] and capillary ﬁngering [7]. There exist statistical models such as DLA [8], anti-DLA [9] and invasion
percolation [10] that reproduce the basic domains in viscous ﬁngering, stable displacement and capillary ﬁngering
respectively. However, these models do not contain any physical time for the front evolution and they cannot describe
the crossover between the diﬀerent ﬂow regimes.

Much eﬀort has gone into making better models whose properties are closer to that of real porous media. This
has resulted in several network simulators, modeling ﬂuid ﬂow on a lattice of pores and throats [2,3,11–19]. Most
of the network models have been used to obtain new information on the diﬀerent ﬂow regimes and to study the
statistical properties of the displacement structures. Some others, have been used to calculate macroscopic properties
like ﬂuid saturations and relative permeabilities and compare them with corresponding experimental data. However,
to our knowledge no network model has been capable of simulating the dynamics of the ﬂuid pressures during the
displacement process. This is the goal of the present work.

We have simulated the temporal evolution of the pressure in all the three regimes of interest: viscous ﬁngering,
stable displacement and capillary ﬁngering. The injection rate in the displacements has been systematically varied
and we have analyzed the behavior of the pressure in the crossover between the three regimes. Moreover, we discuss
what eﬀect trapped clusters have on the evolution of the pressure in the system and we relate the data to macroscopic

8
9
9
1
 
n
a
J
 
8
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
8
2
0
1
0
8
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

∗Also at: Norwegian University of Science and Technology, N-7034 Trondheim, Norway
†Also at: IKU Petroleum Research, N-7034 Trondheim, Norway

1

ﬂow equations. We ﬁnd that capillary forces play an important role in two-phase ﬂow at both high and low injection
rates.

The paper is organized as follows. In Sec. II we present the network model, in Sec. III we show the simulation

results and in Sec. IV we present our conclusions and related the ﬁndings to macroscopic quantities.

The network model has been presented in [20] and we will restrict ourself to a short sketch here.

II. THE NETWORK MODEL

A. Geometry and boundary conditions

The porous medium is represented by a square lattice tubes connected at the nodes. At each node four tubes meet
and there is no volume assigned to the nodes: the tubes represent the volume of both pores and throats. The tubes
are cylindrical with length d. Each tube is assigned an average radius r which is chosen at random in the interval
[λ1d, λ2d], where 0 ≤ λ1 < λ2 ≤ 1. The randomness of the radii represents the disorder in the model.

The liquids ﬂow from the bottom to the top of the lattice and we implement periodic boundary conditions in the
horizontal direction. The pressure diﬀerence between the bottom row and the top row deﬁnes the pressure across the
lattice. Gravity eﬀects are neglected, and consequently we consider horizontal ﬂow in a two-dimensional network of
tubes.

B. Fluid ﬂow through the network

Initially, the system is ﬁlled with a defending ﬂuid with viscosity µ1. The invading ﬂuid with viscosity µ2 is injected
along the bottom row with a constant injection rate. We model drainage, i.e. the invading ﬂuid is non-wetting and the
defending ﬂuid is wetting. Furthermore, we assume that the ﬂuids are incompressible and immiscible. Consequently,
the volume ﬂux is conserved everywhere in the lattice and a well deﬁned interface develops between the two phases.
The capillary pressure pc due to the interface between the non-wetting and wetting ﬂuid inside a tube (a meniscus)

is given by the Young-Laplace law

Here r is the radius of the tube, γ is the interfacial tension and θ denotes the wetting angle between the non-wetting
and wetting phases. θ is in the interval (0, π/2) for drainage displacements.

We assume that the tubes are hour glass shaped where the eﬀective radii of the tubes follow a smooth function.
Thus, the capillary pressure becomes a function of the position of the meniscus in the tube and we assume that the
Young-Laplace law (1) takes the form

Here ˆx is the dimensionless value of the meniscus’ position in the tube (0 ≤ ˆx ≤ 1), and θ = 0 (perfect wetting).
From Eq. (2) pc = 0 at the ends of the tube while pc approaches its maximum of 4γ/r in the middle of the tube.

The volume ﬂux qij through a tube from the ith to the jth node in the lattice (Fig. 1) is found from the Washburn

equation for capillary ﬂow [21]. As an approximation we treat the tubes as if they were cylindrical and obtain

pc =

cos θ .

2γ
r

pc =

[1 − cos(2πˆx)] .

2γ
r

qij = −

·

(∆pij − ˜pc) .

πr2
ij kij
µef f

1
d

(1)

(2)

(3)

Here kij is the permeability of the tube given by kij = r2
ij /8 where rij is the average radius of the tube. ∆pij = pj − pi
is the pressure diﬀerence between the ith and jth node. A tube partially ﬁlled with both of the liquids is allowed to
contain either one or two menisci leading to four diﬀerent arrangements as shown in Fig. 2. The eﬀective viscosity
of those tubes, denoted as µef f in Eq. (3), becomes a sum of the amount of each ﬂuid multiplied by their respective
viscosities. The total capillary pressure, ˜pc in Eq. (3), is the sum of the capillary pressures of the menisci that are
inside the tube. The absolute value of the capillary pressure of each meniscus is given by Eq. (2), while its sign
depends on whether the meniscus is pointing upwards like in Fig. 2 (a) or downwards like in Fig. 2 (b). In the simple
case where the tube only contains one meniscus (Fig. 1) µef f = µ2 ˆxij + µ1(1 − ˆxij) and ˜pc = pc. For a tube without
menisci ˜pc = 0, and Eq. (3) reduces to that describing Hagen-Poiseuille ﬂow with µef f = µ1 or µ2.

2

(4)

(5)

(6)

(7)

There is no volume assigned to the nodes giving conservation of volume ﬂux at each node

C. Determining the ﬂow ﬁeld

qij = 0 .

j
X

The summation on j runs over the nearest neighbor nodes to the ith node while i runs over all nodes that do not
belong to the top or bottom rows, that is, the internal nodes.

Eqs. (3) and (4) constitute a set of linear equations which are to be solved for the nodal pressures pj with the
constraint that the pressures at the nodes belonging to the upper and lower rows are kept ﬁxed. The set of equations
is solved by using the Conjugate Gradient method [22].

We want to study the dynamics of the pressure ﬂuctuations at constant displacement rate. Therefore, we need to
ﬁnd the pressure across the lattice for a desired injection rate and then use that pressure to solve ﬂuid ﬂow through
the network. For two-phase displacement the pressure across the lattice ∆P is related to the injection rate Q through
the equation

Q = A∆P + B .

∆pij = Γij ∆P + Πij .

qij = ˜aij∆P + ˜bij .

Here A and B are parameters depending on the geometry of the medium and the current conﬁguration of the liquids.
The ﬁrst part of Eq. (5) is simply Darcy’s law for one phase ﬂow, while the last part B results from the capillary
pressure between the two phases. As long as the menisci do not move B is constant.

The pressure ∆pij across each tube can be related to the pressure across the lattice ∆P . All the equations calculating
the ﬂuid ﬂow in the system, have the functional form f (x) = ax + b. As a consequence ∆pij becomes a function of
∆P ,

Γij is a dimensionless quantity depending on the mobilities (k/µef f ) of the tubes and Πij is a function of the capillary
pressures of the menisci inside the tubes. If no menisci are present Πij is zero. Eq. (6) can easily be deduced for two
cylindrical tubes with diﬀerent radii connected in series.

By inserting Eq. (6) into Eq. (3) we obtain after some algebra a relation between the local ﬂow rate qij and the

pressure ∆P across the network

The parameter ˜aij is proportional to Γij and the mobility (kij /µef f ) of the tube ij. ˜bij contains the capillary pressures
of the menisci.

The solution due to a constant injection rate can now be summarized into the following steps:
1. We ﬁrst ﬁnd the nodal pressures for two diﬀerent pressures ∆P
2. From the two solutions of the nodal pressures the corresponding injection rates Q

applied across the lattice.
and Q

and ∆P

′′

′′

′

′

and the local ﬂow

rate q′

ij and q′′

ij are calculated.

, ∆P
3. A and B is calculated by solving the two equations obtained when inserting ∆P
4. The pressure ∆P across the lattice for the desired Q is then calculated by using Eq. (5).
5. This ∆P is inserted in Eq. (7) to get the local ﬂow qij. Note that the parameters ˜aij and ˜bij must ﬁrst be found

into Eq. (5).

and Q

, Q

by solving the two equations obtained by insterting q′

′

ij , ∆P

q′′
ij and ∆P

′′

from step 2 into Eq. (7).

′

′

′′

′′

D. Moving the menisci

A time step ∆t is chosen such that every meniscus is allowed to travel at most a maximum step length ∆xmax
during that time step. In each time step we check whether or not a meniscus crosses a node. If this happens, the
time step is redeﬁned such that this meniscus stops at the end of the tube.

A meniscus reaching the end of a tube is moved into the neighbor tubes according to some deﬁned rules. These
rules take care of the diﬀerent ﬂuid arrangements that can appear around the node. Basically, the non-wetting ﬂuid
can either invade into or retreat from the neighbor tubes as shown in Fig. 3 (a) and (b) respectively. In Fig. 3 (a) the
non-wetting ﬂuid approaches the node from below (drainage). When the meniscus has reached the end of the tube
(position 1), it is removed and three new menisci are created at position δ in the neighbor tubes (position 2). The

3

distance δ is about 1–5% of the tube length d. The small distance δ avoids that the created menisci at position 2
immediately disappear and move back to the initial position 1 in tubes where the ﬂow direction is opposite to the
direction of the invading ﬂuid. The total time lapse is adjusted to compensate the instantaneous change in local
volume of the ﬂuids when the menisci move a distance δ. The time lapse is adjusted such that the total volume of
the ﬂuids always is conserved.

Fig. 3 (b) shows the opposite case when the non-wetting ﬂuid retreats into a single tube (imbibition). As Fig. 3 (b)
shows the properties of imbibition should not be neglected as long as the menisci can travel in both directions.
Our approximation in Fig. 3 (b) cannot handle important properties found in imbibition such as ﬁlm ﬂow and snap
oﬀ [5,23]. However, in drainage which is what we are focusing on, arrangement (b) will appear rarely compared to (a).
For that reasion, any futher description of imbibition than the one presented in Fig. 3 (b), does not seem necessary.

Summarized, the procedure for each time step ∆t is:
1. The nodal pressures pj are determined.
2. The pj’s are related to the desired injection rate Q from Eqs. (5) and (7).
3. The local ﬂow rate in each tube is computed by using Eq. (3).
4. The local ﬂow rates are used to calculate the time step ∆t such that only one meniscus reaches the end of a tube

or travel at most the step length ∆xmax during that time step.

5. The menisci are updated according to ∆t. The total time lapse is recorded before the whole procedure is repeated

for the new ﬂuid conﬁguration.

III. SIMULATIONS

In two-phase ﬂuid displacement there are mainly three types of forces: viscous forces in the invading ﬂuid, viscous
forces in the defending ﬂuid and capillary forces due to the interface between them. This leads to two dimensionless
numbers that characterize the ﬂow: the capillary number Ca and the viscosity ratio M .

The capillary number describes the competition between capillary and viscous forces. It is deﬁned as

where Q (cm2/s) denotes the injection rate, µ (Poise) is the maximum viscosity of the two ﬂuids , Σ (cm2) is the
cross section of the inlet and γ (dyn/cm) is the interfacial tension between the two phases. Σ is calculated by taking
the product of the length of the inlet and the mean thickness of the lattice due to the average radius of the tubes.

M deﬁnes the ratio of the viscosities of the two ﬂuids and is given by the invading viscosity µ2 divided with the

defending viscosity µ1:

In the simulations the pressure across the lattice ∆P is given by Eq. (5) as

∆P =

−

=

+ Pcg .

Q
A

B
A

Q
A

Since B is due to the capillary pressure of the menisci, we deﬁne −B/A as the global capillary pressure of the system,
Pcg. Pcg includes the menisci surrounding the trapped cluster of defending ﬂuid (cluster menisci) as well as the menisci
belonging to the front between the invading and defending ﬂuid (front menisci).

In addition to Pcg we calculate Pcf , the capillary pressure averaged along the front. Pcf consists only of the capillary

pressures due to the front menisci and we deﬁne it as

α=1
X
Here the index α addresses the tubes in the lattice and in the summation α runs over all tubes containing a meniscus
that belong to the front. N is the number of such tubes. pα
c is the capillary pressure of the front meniscus in tube α.
See Fig. 4 for an example of a structure obtained after a simulation with low capillary number. The tubes containing
a front meniscus or belonging to the trapped cluster of defending ﬂuid are identiﬁed by running a Hoshen-Kopelman
algorithm [24] on the lattice.

Ca =

Qµ
Σγ

,

M =

µ2
µ1

.

Pcf =

N

1
N

|pα

c | .

4

(8)

(9)

(10)

(11)

The displacement structure in Fig. 4 shows that the front is a complicated path connecting the left and the right
boundaries of the lattice. The width of the front w is found by taking the standard deviation of the distances between
all the front tubes and the average position of the front.

For every simulation we have calculated ∆P and Pcg as functions of time. For some of the simulations we have also
computed the average capillary pressure Pcf along the front and analyzed the behavior of A in Eq. (5). As will be
discussed below, ∆P , Pcg and Pcf are strongly correlated and A seems to obey surprisingly simple relations.

We have performed drainage simulations in each of the regimes of interest: viscous ﬁngering, stable displacement and
capillary ﬁngering with M = 1.0×10−3, 1.0 and 1.0×102 respectively. The injection rate was systematically varied
for each of the viscosity ratios. The simulations were performed with parameters as close as possible to experiments
performed in [25]. The length d of all tubes in the lattices were set equal to 1 mm and the radii r of the tubes were
chosen randomly in the interval 0.05d ≤ r ≤ d. The interfacial tension was set to γ = 30 dyn/cm and the viscosities
of the defending and the invading ﬂuids varied between 0.01 P (≃ water) and 10 P (≃ glycerol).

A. Viscous ﬁngering, M < 1

Our study of this regime consists of a series of simulations with constant viscosity ratio M = 1.0×10−3. The
injection rates and the capillary number used in the diﬀerent simulations are listed in Table I. To save computation
time, most of the simulations were performed on a lattice of 25 × 35 nodes. However, one was performed on a lattice
of 60 × 80 nodes and the resulting structure of this simulation is shown in Fig. 5.

In viscous ﬁngering the principal force is due to the viscous forces in the defending ﬂuid. The pattern formation in
Fig. 5 shows that the invading ﬂuid creates typical ﬁngers into the defending ﬂuid. The pressure across the lattice,
∆P , shown in Fig. 6, decreases as the less viscous ﬂuid invades the system. The slope of the average decreasing
pressure function is non-trivial and results from the fractal development of the ﬁngers.

The global capillary pressure Pcg, also shown in Fig. 6, ﬂuctuates around a mean value of about 1×103 dyn/cm2.
The ﬂuctuation is strongly correlated in both time and amplitude to the noise in ∆P . As will be discussed below, the
variations correspond to the changes in the capillary pressure as a meniscus invades into or retreats from a tube.

We have calculated Pcf for every simulation performed on the lattices of 25 × 35 nodes. The result for four of the
simulations is shown in Fig. 7 together with the global capillary pressure Pcg. The pressures in Fig. 7 are normalized
by dividing them with the average threshold pressure of the tubes. The average threshold pressure is deﬁned as 2γ/hri
where hri is the mean radius of the tubes. The mean threshold pressure is about 1.1×103 dyn/cm2 in all simulations,
since the radii of the tubes always are chosen randomly in the interval [0.05, 1.0] mm. Note that in Fig. 7, Pcg has been
subtracted by 1000 dyn/cm2 before it was normalized. This avoids the pressure functions to overlap at low capillary
numbers when they are plotted in the ﬁgure.

Fig. 7 shows that the ﬂuctuations of Pcf are correlated in time to the ﬂuctuations of Pcg. At lowest Ca = 3.5×10−4,
Pcf and Pcg are even indistinguishable. For all simulations except that at lowest capillary number the amplitude of
the ﬂuctuations in Pcf decreases as time increases. For high injection rates Pcf is found to approach 1, which is the
mean threshold pressure.

In the simulation at Ca = 3.5×10−4 we approach the regime of capillary ﬁngering. In slow capillary ﬁngering the
local capillary pressures of the menisci becomes equal when all the menisci are stable. This is often referred to as
capillary equilibrium leading to Pcg ≃ Pcf . However, in fast displacement the local capillary pressures are generally
diﬀerent. Thus, for a large system with many menisci the average capillary pressure of the front will approach the
average threshold pressure of the tubes.

Due to the less viscous defending ﬂuid the pressure gradient at high injection rate is largest at the ﬁnger tip closest
to the upper boundary of the lattice. The meniscus in the uppermost ﬁnger tip will therefor more likely continue and
invade the next tube compared to the menisci lying behind it. Thus, the menisci lying behind will get stuck and the
ﬂuctuations in the global capillary pressure can only be caused by the moving ﬁnger tip. This is seen in Fig. 8 where
we have plotted Pcg (a) together with the capillary pressure of the meniscus which is located in the tube that always
has the largest ﬂow rate. The data in Fig. 8 are taken from the simulation performed at Ca = 1.1×10−2 given in
Table I.

On basis of Figs. 7 and 8 we conclude that the ﬂuctuations in Pcg correspond to the local capillary pressure of the

menisci invading the tubes. Moreover, the average level of Pcg is almost equal Pcf .

5

B. Stable displacement, M > 1

In the regime of stable displacement we have run seven simulations spread over diﬀerent lattices of size between
25 × 35 and 60 × 60 nodes. See Table II. The simulations were run with the viscosity ratio M = 1.0×102, but at
diﬀerent capillary numbers. The resulting structure of a simulation performed on a lattice with 60 × 60 nodes is
visualized in Fig. 9. The pressure across the lattice ∆P , the global capillary pressure Pcg and 1/A were calculated
for all simulations. The results are plotted in Figs. 10 and 11 .

In stable displacements the ﬂuid movements are dominated by the viscous forces in the invading liquid. The viscous
pressure gradient in the invading phase is found to stabilize the front and a compact pattern with an almost ﬂat front
between the non-wetting and wetting ﬂuid is generated (see Fig. 9). The stabilized front introduces a length scale in
the system for large times. This length scale is identiﬁed as the saturation width ws of the front [25].

To save computation time the simulations performed on the lattices of 40 × 40 and 60 × 60 nodes (Fig. 10) were
stopped after the width of the front had stabilized. The other simulations (Fig. 11), however, were run until the
invading ﬂuid reached the outlet.

The pressures in Figs. 10 and 11 show a quite diﬀerent behavior compared to the pressures in Figs. 6 and 7. The
pressure across the lattice ∆P (a) and the global capillary pressure Pcg (b) are both found to increase as the more
viscous ﬂuid is injected into the system. However, the average slope depend very much on the injection rate. At low
capillary numbers (Ca = 7.5×10−4) we reach the regime of capillary ﬁngering and similar to viscous ﬁngering the
pressures reduce to that describing the capillary ﬂuctuations along the front.

To explain the rather unexpected behavior at high injection rates we have to discuss the eﬀect of the trapped cluster
of the defending ﬂuid left behind the front. In stable displacement the driving pressure gradient lies between the inlet
and the front causing a pressure drop between the top and the bottom of the trapped clusters. At moderate injection
rates where the clusters stay in place and keep their shapes, the forces due to the pressure drop must be canceled by
capillary forces acting on the cluster menisci. The sum of those capillary forces contribute to the observed increase
in Pcg.

The above interpretation of Pcg also applies in the regime of viscous ﬁngering. In viscous ﬁngering at high capillary
numbers there are few clusters. Thus, the extra contribution to Pcg from the cluster menisci becomes negligible. When
the injection rate is reduced clusters develop, but now the pressure gradient across the clusters is small because of the
low injection rate. Therefore, the contribution to Pcg still is negligible. This is in agreement of the observations in the
previous section where Pcg was found to ﬂuctuate around a constant level for both high and low capillary numbers.
All the displacements listed in Table II, except that at Ca = 7.5×10−4, reached the saturation time ts where the
front stabilize. In Figs. 10 and 11 ts is indicated by a vertical dashed line. If we neglect the ﬂuctuations, ∆P and Pcg
are approximately linear functions of time for t > ts.

The linearity in Pcg is explained by looking at the generation of the clusters in the system. We notice that for
large times (t > ts), when the front has saturated with fully developed clusters behind it, the average front position h
can only depend on the injection rate and the viscosity ratio. Both properties are constant through each simulation,
resulting in h being linear in time. A plot showing the average front position as a function of time at Ca = 4.6×10−3
for the lattice with 60 × 60 nodes is shown in Fig. 12.

On average, every cluster contributes to Pcg with a certain amount causing the global capillary pressure to be
proportional to the number of clusters behind the front. For large times, the number of clusters increases linearly
with the average front position causing Pcg to be linear in h. Summarized we obtain

It has to be emphasized that there might be large deviations from the observed linearities when clusters of size
comparable to the system develops. The argument does not apply when t < ts, either. Then the average change in
∆P and Pcg depends on the fractal development of the displacement structure.

The quantity 1/A, deﬁned in Eq. (5), is calculated by using Eq. (10). In Figs. 10 and 11 we have plotted A0/A

expressed as

(12)

(13)

Here A0 is equal to the proportionality factor between Q and ∆P when only the defending ﬂuid ﬂows trough the
lattice, i.e. A0 = ΣK/µ1L. K denotes the absolute permeability of the lattice and L is the length of the system. From
Figs. 10 and 11, we conclude that at high capillary numbers and for t > ts, 1/A is proportional to the injection time.
The linearity in 1/A is related to the displacement structure that develop during injection of non-wetting ﬂuid. Let

us return to equation Eq. (5) which we can rewrite to obtain

Pcg ∝ h ∝ t

,

t > ts .

A0
A

= A0

∆P − Pcg
Q

.

6

Q = ΣG (∆P − Pcg)

1
L

,

G =

K
µef f

.

µef f = (1 − ˆh)µ1 + ˆhµ2

′ .

where G ≡ AL/Σ deﬁnes the simulated mobility of the system. It must be emphasized that this mobility may be
hard to measure experimentally and it should not be confused with the conventional eﬀective mobility of the system,
denoted by Gef f (see below). Eq. (14) looks very similar to Eq. (3) describing the ﬂuid ﬂow through a single tube. If
we now assume that an equation of the form (3) applies on the whole lattice we interpret G as

Here µef f is the eﬀective viscosity of the whole system. µef f is not trivial to calculate because of the fractal structure
of the trapped clusters and front. However, if we denote the normalized average front position as ˆh and assume that
the viscosity of the region behind the front can be expressed by an eﬀective viscosity µ2

′, µef f becomes

Here 0 < ˆh < 1. By combining Eqs. (16) and (15), we ﬁnally obtain after some reorganization

(Me − 1)ˆh + 1
h
′/µ1 deﬁnes the eﬀective viscosity ratio.

=

∝

i

,

1
G

1
A

1
A0

where Me ≡ µ2

To a ﬁrst approximation, we have calculated µ2

′ directly from the displacement structure by taking the sum of the
′
ﬂuid viscosities multiplied by their respective macroscopic saturations behind the front. However, the calculated µ2
was not consistent with (Me − 1) given by the average slope of A0/A plotted in Figs. 10 and 11. This indicates that
′ not only depend on the ﬂuid saturations but also the structure of the liquids behind the front. Thus, microscopic
µ2
properties of the ﬂuid conﬁgurations has to be considered in order to ﬁnd the correct Me.

We are now in a position to derive a more exact formalism describing the pressure evolution and the changes in the
eﬀective mobility Gef f of the system when clusters develop. Gef f corresponds to the ratio of the eﬀective permeability
and the eﬀective viscosity of the system. If we again look at the global capillary pressure Pcg, it can be interpreted
as a sum of the capillary pressure along the front menisci, Pmf and the capillary pressure of the cluster menisci, Pmc.
Furthermore, for large times (t > ts) we can express Pmc = ∆mc h giving

Pcg = ∆mc h + Pmf .

Here ∆mc denotes the proportionality factor between Pcg and h where 0 < h < L is the average front position. In
the limit of very low injection rate the capillary pressure of the front and cluster menisci will approach capillary
equilibrium causing ∆mc → 0 and Pmf ≃ Pcf ≃ Pcg.

We can use the relation for Pcg in Eq. (18) to deduce a formula for Gef f . What we are seeking is an equation for

the ﬂow rate U , on the form of Darcy’s law

The pressure gradient (∆P − Pmf )/L accounts for the capillary pressure due to the front, Pmf .

We start by inserting Eq. (18) into Eq. (14) to get

where the ﬂow velocity U ≡ Q/Σ. Eq. (20) can be written into the from of Darcy’s to obtain

where

U = Gef f (∆P − Pmf )

1
L

.

U =

(∆P − ∆mc h − Pmf )

K
µef f

1
L

,

U =

K
µef f + µmc

(∆P − Pmf )

1
L

,

µmc ≡

∆mc h .

K
U L

7

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

Gef f ≡

K
µef f + µmc

.

Gef f (h = L) =

K
µ2′ + K∆mc

U

.

kri =

Gef f (h = L)µ2
K

′

.

From Eq. (21) we immediately interpret µmc as the increase in viscosity of the invaded region caused by the cluster
formation. However, this may just as well be seen as a decrease in the eﬀective permeability behind the front [25].
Note that the U dependency in Eq. (22) only indicates changes in ∆mc between displacements executed at diﬀerent
injection rates. The behavior when the ﬂow rate changes during one displacement is not discussed here. From Eq.
(21) we ﬁnally deﬁne the eﬀective mobility of the lattice as

There is one important interpretation of Gef f when the average front position has reached the outlet, i.e. h = L.
Then only the invading ﬂuid ﬂows through the system and Gef f becomes equal to the eﬀective mobility of the invading
phase. If we insert Eqs. (16) and (22) into Eq. (23) we obtain when h = L

From this expression follows directly a relation for the relative permeability of the invading phase, kri deﬁned as

Note that µ2

′ = µef f (ˆh = 1) from Eq. (16) and that µ2

′ is given by the slope of 1/A in Eq. (17).

The above formalism resulting in Eq. (23), takes into account the capillary pressure of the cluster menisci as well as
the capillary pressure along the front. However, at moderate injection rates where the clusters stay in place and keep
their shapes, we have found Gef f directly in the simulations by assigning zero permeability to tubes belonging to the
trapped clusters. Thus, the clusters will be frozen to their initial positions and in the calculations they are treated as
additional boundary conditions where ﬂuid cannot ﬂow. Simulations have provided evidence that when the clusters
are frozen the parameter A in Eq. (5) adjusts such that the simulated G in Eq. (14) becomes equal to the calculated
Gef f in Eq. (23). Gef f is calculated by using Pcg and ∆P which are plotted in Figs. 10 and 11. Moreover, with frozen
clusters the global capillary pressure Pcg, reduces to that describing the capillary pressure along the front, Pmf .

C. Capillary ﬁngering, M = 1

In the regime of capillary ﬁngering we have run 17 simulations with viscosity matching ﬂuids (M = 1.0) spread
over six diﬀerent capillary numbers. The diﬀerent capillary numbers and the corresponding injection rates are listed
in Table III. The lattice size was 40 × 60 nodes for all simulations. Due to long computation time we only did two
simulations at the lowest capillary number. For all the other capillary numbers, we ran three simulations.

In capillary ﬁngering the displacement is so slow that the viscous forces are negligible, with the consequence that
the main force is the capillary one between the two ﬂuids. Only the strength of the threshold pressure in a given
tube decides whether the invading ﬂuid invades that tube or not. Since the radii of the tubes (which determine the
threshold pressures) are randomly chosen from a given interval, the non-wetting ﬂuid ﬂows along the path of least
resistance.

The displacement structure of one of the simulations at lowest Ca = 4.6×10−5 is shown in Fig. 4. We observe that
the invading ﬂuid creates a rough front with trapped clusters that appear at all scales between the tube length and
the maximum width of the front.

For all simulations ∆P and Pcg were calculated. The result for six of the simulations each at one of the diﬀerent
capillary numbers are shown in Fig. 13. In the ﬁgure (a) denotes ∆P and (b) denotes Pcg. Note that Pcg has been
subtracted by 1000 dyn/cm2 to avoid overlap of the curves at low capillary numbers.

The front was found to stabilize at high injection rates [25] and the saturation time ts is indicated by the vertical
dashed line in Fig. 13. At the lowest capillary number it might be diﬃcult to estimate the saturation time accurately.
At very low injection rate the width of the front probably approaches an upper cut oﬀ equal to the ﬁnite size of the
lattice.

At high capillary numbers for t > ts, ∆P and Pcg are found to increase linearly as a function of time. This is
consistent with the result from stable displacement. However, the diﬀerence ∆P − Pcg, is constant through each of
the simulation opposed to what we observed when M > 1. Fig. 14 shows the diﬀerence ∆P − Pcg for one of the
simulations at Ca = 2.3×10−4. The plot shows the normalized value of ∆P − Pcg subtracted by 1 such that the
resulting data fall close to zero. The ﬂuctuations appearing in the 9th digit are caused by numerical round oﬀ errors
in the simulations.

8

In the previous section we suggested that the mobility G deﬁned in Eq. (15), was a function of the eﬀective viscosity
µef f . Moreover, we assumed that µef f depends on the saturation of the invading and the defending ﬂuid and the
displacement structure. When µ1 = µ2 none of these assumptions apply. From Eq. (14) the constant pressure
diﬀerence ∆P − Pcg in Fig. 14 implies that the simulated mobility G becomes constant, even with respect to the local
displacement structure. The eﬀective viscosity reduces to the viscosity of the two liquids, µef f = µ1 = µ2 giving
A = A0 = ΣK/µ1L. The diﬀerence ∆P − Pcg, however, depend on the injection rate Q. This is observed in Fig. 13
where ∆P − Pcg increases for increasing capillary number.

When µ1 = µ2 the pressure diﬀerence ∆P − Pcg has a simple interpretation. It corresponds to the viscous pressure
drop arising when viscous ﬂuids are moving. When the injection rate is reduced the viscous pressure drop becomes
negligible and we approach the regime of capillary ﬁngering. At low injection rates the pressure gradient across the
trapped clusters also vanish giving only a small increase in ∆P and Pcg. This is observed in Fig. 13 at Ca = 4.6×10−5
In the same ﬁgure, the sudden jumps in
where the average increase in Pcg becomes quite small and ∆P ≃ Pcg.
the pressure function identify the bursts where the invading ﬂuid proceeds abruptly. This corresponds to Haines
jumps [26,27].

The property that the mobility G is constant when the liquids have equal viscosities simpliﬁes the computation of

the nodal pressures in the lattice. By substituting A with A0 in Eq. (5) we ﬁnd that the injection rate is given by

This equation has only one unknown, the term B, opposed to the original Eq. (5) having two unknowns, both A and
B. To verify the result when A is replaced by A0 we have compared the solution found from Eq. (26), necessitating
one solution of the ﬂow equations, with the one given when Eq. (5) is solved twice. Not surprisingly, there is excellent
agreement between these two results.

The strong evidence that A = A0 is constant in Eq. (26) can be deduced from simple considerations of the energy
dissipation in the system. In analogy with electrical circuits, we deﬁne the total energy dissipation W in the system
as

The total dissipation must equals the sum of the dissipation in every tube α in the lattice. Thus,

Q = A0∆P + B .

W = Q∆P .

Q∆P =

qα∆pα ,

α
X

qα = aα∆pα + bα .

where the summation index α runs over all tubes in the lattice. qα is given by Eq. (3) which we rewrite as (ij → α)

Here we note that aα is proportional to kα/µef f , the mobility of the tube α. By inserting Eq. (5) and (29) into Eq.
(28) we get after some reorganization

By replacing the local pressure ∆pα in Eq. (30) with ∆P , using Eq. (6) we obtain after some algebra

(26)

(27)

(28)

(29)

(30)

(31)

If we compare the above equation with Eq. (5) we recognize the ﬁrst summation as A and the second as B. Thus, A
depends entirely on aα and Γα. As stated earlier, both aα and Γα are proportional to the mobility of the tubes. The
mobility of each tube depends on the local ﬂuid conﬁgurations, through the eﬀective viscosity µef f as deﬁned in Eq.
(16). However, when the ﬂuids have equal viscosities we get µef f = µ1 = µ2. As a consequence aα and Γα becomes
constant, which is consistent with the simulation result.

A∆P + B =

aα∆P

α
X

2

∆pα
∆P

(cid:18)

(cid:19)

+ bα

∆pα
∆P

.

Q =

2

aαΓα

∆P +

Γα(2aαΠα + bα)

#

"

+

α
X
Πα
∆P

(aαΠα + bα)

"

α
X
.

(cid:21)

9

IV. DISCUSSIONS

We have simulated drainage displacements at diﬀerent injection rates for three diﬀerent viscosity ratios M =
1.0×10−3, 1.0 and 1.0×102. The main focus of the work is the study of the temporal evolution of the pressure when
a non-wetting ﬂuid displaces a wetting ﬂuid in porous media. Moreover, the eﬀect of the trapped clusters on the
displacement process has been discussed. From the results we clearly see that the capillary forces play an important
role at both high and low injection rates.

At high injection rates with M ≥ 1.0 the global capillary pressure, Pcg was found to increase as a function of
the number of trapped clusters behind the front. For large times when the front has saturated, Pcg becomes even
proportion to the average front position h. This lead to a formalism describing the evolution of the eﬀective mobility
when the non-wetting ﬂuid was injected into the system. Moreover, we showed that this eﬀective mobility could
be used to estimate the relative permeability of the invading phase when the average front position has reached the
outlet.

At moderate injection rates the eﬀective mobility given by Pcg, were shown to be equivalent to assigning zero
permeability to tubes belonging to the trapped clusters. When M ≪ 1.0 or at low injection rates the eﬀect of the
clusters become negligible reducing Pcg to describe the local capillary ﬂuctuations of the invading menisci along the
front. With displacements performed with equal viscosities, M = 1.0, we found that the diﬀerence ∆P − Pcg was
constant. This was shown to be consistent with the energy dissipation in the system.

It must be emphasized that the properties we report are only valid for drainage. So far the model is not capable to
simulate imbibition. The simulations have also been performed on a two-dimensional porous system where clusters
develop more easily, compared to ﬂuid ﬂow in three-dimensional porous media [28]. Moreover, the lattice sizes are
limited by the computation time and more sophisticated and eﬃcient algorithms have to be developed in order to
increase the system sizes and thereby improve the above results. Another, and not less important exercise is to
compare our simulation results with experimental measurements.

ACKNOWLEDGMENTS

The authors thank S. Basak, G. G. Batrouni, E. G. Flekkøy and J. Schmittbuhl for valuable comments. The work
is supported by NFR, the Norwegian Research Council, through a “SUP” program and a grant of computation time.
The work has also got computer time from the Idris in Paris and from HLRZ, Forschungszentrum J¨ulich GmbH.

[1] K. J. M˚aløy, J. Feder, and T. Jøssang, Phys. Rev. Lett. 55, 26881 (1985).
[2] J.-D. Chen and D. Wilkinson, Phys. Rev. Lett. 55, 1892 (1985).
[3] R. Lenormand, E. Touboul, and C. Zarcone, J. Fluid Mech. 189, 165 (1988).
[4] M. Cieplak and M. O. Robbins, Phys. Rev. Lett. 60, 2042 (1988).
[5] M. Cieplak and M. O. Robbins, Phys. Rev. B. 41, 11508 (1990).
[6] N. Martys, M. Cieplak, and M. O. Robbins, Phys. Rev. Lett. 66, 1058 (1991).
[7] R. Lenormand and C. Zarcone, Phys. Rev. Lett. 54, 2226 (1985).
[8] T. A. Witten and L. M. Sander, Phys. Rev. Lett. 47, 1400 (1981).
[9] L. Paterson, Phys. Rev. Lett. 52, 1621 (1984).
[10] D. Wilkinson and J. F. Willemsen, J. Phys. A 16, 3365 (1983).
[11] J. Koplik and T. J. Lasseter, SPEJ 22, 89 (1985).
[12] M. M. Dias and A. C. Payatakes, J. Fluid Mech. 164, 305 (1986).
[13] P. R. King, J. Phys. A 20, L529 (1987).
[14] M. Blunt and P. King, Phys. Rev. A 42, 4780 (1990).
[15] M. Blunt and P. King, Transp. Porous Media 6, 407 (1991).
[16] P. C. Reeves and M. A. Celia, Water Resour. Res. 32, 2345 (1996).
[17] G. N. Constantinides and A. C. Payatakes, AIChE Journal 42, 369 (1996).
[18] E. W. Pereira, W. V. Pinczewski, D. Y. C. Chan, L. Paterson, and P. E. Øren, Transp. Porous Media 24, 167 (1996).
[19] D. H. Fenwick and M. J. Blunt. SPE 38881, proc. of the SPE Annual Tech. Conf., San Antonio, Texas, U.S.A., Oct. 1997.
[20] E. Aker, K. J. M˚aløy, A. Hansen, and G. G. Batrouni, “A two-dimensional network simulator for two-phase ﬂow in porous

media”. Submitted to Transp. Porous Media, 1997.

10

[21] E. W. Washburn, Phys. Rev. 17, 273 (1921).
[22] G. G. Batrouni and A. Hansen, J. Stat. Phys. 52, 747 (1988).
[23] R. Lenormand, C. Zarcone, and A. Sarr, J. Fluid. Mech. 135, 337 (1983).
[24] D. Stauﬀer and A. Aharony. Introduction to percolation theory. Taylor & Francis, London, Great Britain, 1992.
[25] O. I. Frette, K. J. M˚aløy, J. Schmittbuhl, and A. Hansen, Phys. Rev. E. 55, 2969 (1997).
[26] W. B. Haines, J. Agr. Sci. 20, 97 (1930).
[27] K. J. M˚aløy, L. Furuberg, J. Feder, and T. Jøssang, Phys. Rev. Lett. 68, 2161 (1992).
[28] D. Wilkinson, Phys. Rev. A 34, 1380 (1986).

FIG. 1. Flow in a tube containing a meniscus.

FIG. 2. Four diﬀerent ﬂuid arrangements inside one tube. The shaded and the white regions indicate the non-wetting and

wetting ﬂuid respectively.

FIG. 3. The motion of the menisci at the nodes. (a) The non-wetting ﬂuid (shaded) reaches the end of the tube (position
1) and is moved a distance δ into the neighbor tubes (position 2). (b) The wetting ﬂuid (white) reaches the end of the tubes
(position 1) and the non-wetting ﬂuid (shaded) retreat to position 2. To conserve the volume of the ﬂuids a proper time is
recorded due to the small movement δ in (a) and (b).

FIG. 4. The displacement structure obtained from a simulation at Ca = 4.6×10−5 and M = 1.0. The size of the lattice is
40 × 60 nodes and the invading non-wetting ﬂuid (black) displaces the defending wetting ﬂuid (gray) from below. Notice the
rough front between the ﬂuids and the trapped cluster of defending ﬂuid left behind.

FIG. 5. The displacement structure obtained by a simulation in the regime of viscous ﬁngering on a lattice of 60 × 80 nodes.
Ca = 4.6×10−3 and M = 1.0×10−3. The invading, non-wetting ﬂuid (black) displaces the defending, wetting ﬂuid (gray) from
below.

FIG. 6. ∆P (a) and Pcg (b) plotted as a function of time. Ca = 4.6×10−3 and M = 1.0×10−3.

FIG. 7. Pcf (a), and Pcg (b), at four diﬀerent capillary numbers for the simulations with M = 1.0×10−3 at lattice size 25×35
nodes. The pressures are normalized using the average threshold pressure of the tubes. Note that Pcg has been subtracted by
1000 dyn/cm2 before it was normalized to avoid overlap between the two curves at low capillary numbers.

FIG. 8. Pcg (a) and the capillary pressure of the meniscus traveling with the highest velocity (b) at Ca = 1.1×10−2 and

M = 1.0×10−3 in the time interval between 7.0 and 12.0 s.

FIG. 9. The displacement structure obtained of a simulation in the regime of stable displacement on a lattice of 60 × 60
nodes. Ca = 4.6×10−3 and M = 1.0×102. The invading, non-wetting ﬂuid (black) displaces the defending, wetting ﬂuid (gray)
from below.

FIG. 10. ∆P (a), Pcg (b) and A0/A (c) as functions of time for the simulations with M = 1.0×102 at lattice size 60 × 60
(to the left) and 40 × 40 nodes (to the right). The vertical dashed lines indicate the saturation time where the front stabilize.

FIG. 11. ∆P (a), Pcg (b) and A0/A (c) as functions of time for the ﬁve simulations with M = 1.0×102 at lattice size 25 × 35
nodes. Note that for Ca = 4.2×10−3, 2.2×10−3 and 7.5×10−4 Pcg has been subtracted by 1000 dyn/cm2 to avoid overlap of
the curves. The vertical dashed lines indicate the saturation time where the front stabilize.

11

FIG. 12. The average front position as a function of time at Ca = 4.6×10−3 and M = 1.0×102 for the lattice of 60 × 60

FIG. 13. ∆P (a) and Pcg (b) for six simulations with M = 1.0 each at one of the capillary number listed in Table III.
The dashed line indicates the saturation time ts when the front has reached the saturation width ws. Note that Pcg has been
subtracted by 1000 dyn/cm2 to avoid the curves from overlapping at low capillary numbers.

FIG. 14. The normalized diﬀerence ∆P − Pcg subtracted by 1 at Ca = 2.3×10−3 and M = 1.0.

TABLE I. The lattice size and the values for the injection rate and the capillary number when M = 1.0×10−3.

TABLE II. The lattice size and the values for the injection rate and the capillary number when M = 1.0×102.

TABLE III. The values for the injection rate and the capillary number when M = 1.0. The lattice is 40 × 60 nodes.

nodes.

Size
(nodes)
60 × 80
25 × 35
25 × 35
25 × 35
25 × 35
25 × 35
25 × 35

Size
(nodes)
60 × 60
40 × 40
25 × 35
25 × 35
25 × 35
25 × 35
25 × 35

Runs

3
3
3
3
3
2

Ca

4.6×10−3
1.1×10−2
7.1×10−3
4.7×10−3
3.6×10−3
7.2×10−4
3.5×10−4

Ca

4.6×10−3
4.6×10−3
1.8×10−2
9.5×10−3
4.2×10−3
2.2×10−3
7.5×10−4

Ca

2.3×10−3
9.2×10−4
4.6×10−4
2.3×10−4
9.2×10−5
4.6×10−5

Injection rate
(cm3/min)
1.5
1.4
0.98
0.62
0.50
0.099
0.049

Injection rate
(cm3/min)
1.5
1.0
2.5
1.3
0.57
0.29
0.10

Injection rate
(cm3/min)
10
4.0
2.0
1.0
0.40
0.20

12

2r

p
i

µ

2

2p

p1
θ

µ
1

pj

x

ij

d

(a)

(b)

(c)

(d)

δ

2

2

2

1

(a)

1

1

1

δ

2

(b)

)

2

3

m
c
/
n
y
d
 

0
1
(
 
e
r
u
s
s
e
r
P

(a)

8.0

6.0

4.0

2.0

(b)

 0.0

0.0

20.0

40.0

60.0

Time (s)

)

2

3

m
c
/
n
y
d
 

0
1
(
 
e
r
u
s
s
e
r
P

4.0

2.0

0.0

−2.0

(a)

(b)

7.0

8.0

9.0

10.0

11.0

12.0

Time (s)

0.50

0.40

0.30

0.20

0.10

h
 
,
n
o
i
t
i
s
o
p
 
t
n
o
r
f
 
e
g
a
r
e
v
A

0.00

0

50

100

150

Time (s)

5.00e-09

2.50e-09

0.00e+00

-2.50e-09

-5.00e-09

0

50

150

100
Time (s)

