6
0
0
2
 
v
o
N
 
6
1
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
5
6
1
1
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Statistical mechanics of the shallow-water
system with a prior potential vorticity
distribution

P.H. Chavanis and B. Dubrulle

1 Laboratoire de Physique Th´eorique (UMR 5152), Universit´e Paul Sabatier,
Toulouse, France
2 DRECAM/SPEC/CEA Saclay, and CNRS (URA2464), F-91190 Gif sur Yvette
Cedex, France

Abstract

We adapt the statistical mechanics of the shallow-water equations to the case where
the ﬂow is forced at small scales. We assume that the statistics of forcing is encoded
in a prior potential vorticity distribution which replaces the speciﬁcation of the
Casimir constraints in the case of freely evolving ﬂows. This determines a generalized
entropy functional which is maximized by the coarse-grained PV ﬁeld at statistical
equilibrium. Relaxation equations towards equilibrium are derived which conserve
the robust constraints (energy, mass and circulation) and increase the generalized
entropy.

Key words: 2D turbulence, geophysical ﬂows, statistical mechanics

1 Introduction

Two-dimensional turbulent ﬂows with high Reynolds numbers have the strik-
ing property of organizing spontaneously into large-scale coherent structures
such as jets and vortices. Jovian atmosphere shows a wide diversity of struc-
tures: Jupiter’s great red spot, white ovals, brown barges,... A good hydrody-
namical model to describe jovian atmosphere is provided by the Shallow-Water

Email address: chavanis@irsamc.ups-tlse.fr; Berengere.Dubrulle@cea.fr

(P.H. Chavanis and B. Dubrulle).

Preprint submitted to Elsevier Science

2 February 2008

(SW) equations. A statistical theory of the SW system has been developed re-
cently by Chavanis & Sommeria (2002). This extends the statistical mechan-
ics of the incompressible 2D Euler equation proposed by Miller (1990) and
Robert & Sommeria (1991) to the case of compressible ﬂows. It is however
assumed that the ﬂow is weakly compressible (small Mach number) so that
the eﬀect of waves is not dominant. Therefore, large-scale coherent vortices
can form and persist for a long time. After a phase of chaotic mixing (violent
relaxation), the system is expected to reach an equilibrium state which cor-
responds to the most mixed state consistent with the constraints imposed by
the dynamics. Mathematically, it is obtained by maximizing a mixing entropy
while conserving energy, mass, circulation and all the higher moments of the
PV vorticity (Casimirs). One diﬃculty with this approach is that the moments
of PV depend on the resolution at which the PV ﬁeld is considered so that
the prediction can change accordingly. Furthermore, geophysical ﬂows are usu-
ally forced and dissipated at small-scales so that the conservation of all the
Casimirs is abusive. In an attempt to solve these problems, Ellis et al (2002)
have proposed to ﬁx a prior vorticity distribution instead of the Casimirs. It
is assumed that this global distribution of vorticity is generated by the small-
scale forcing so it must be given as an input in the statistical theory. In this
approach, only the conservation of the robust constraints (E, Γ) is taken into
account and the eﬀect of the small-scale forcing is encapsulated in a prior
vorticity distribution or in a generalized entropy. This approach has been fur-
ther developed in Chavanis
(2005b) in the context
of the quasi-geostrophic (QG) equations. In this paper, we show how it can
be extended to the case of the Shallow-Water (SW) equations. Since this is
only a slight, but interesting, variant with respect to the un-forced case, we
shall mostly refer to the study of Chavanis & Sommeria (2002) for technical
details, without repeating all the steps of the derivation.

(2005a) and Chavanis

2 The shallow-water equations

The dynamical evolution of a thin ﬂuid layer with thickness h(x, y, t) and
velocity ﬁeld u = (u, v)(x, y, t) submitted to a gravity acceleration g on a
rotating planet is governed by the shallow water equations

+ ∇ · (hu) = 0,

∂h
∂t

∂u
∂t

+ (u · ∇)u = −g∇h − 2Ω × u.

(1)

(2)

The ﬁrst equation can be viewed as an equation of continuity and the second
equation as the Euler equation (in a rotating frame Ω) for a barotropic ﬂuid

2

with pressure p = 1

2gh2. The Euler equation can be rewritten

∂u
∂t

+ (ωωω + 2Ω) × u = −∇B,

where ωωω = ωez = ∇ × u is the vorticity and where we have introduced the
Bernouilli function

B =

+ gh.

u2
2

q =

ω + 2Ω
h

,

The potential vorticity (PV)

is conserved for each ﬂuid parcel, i.e.

dq
dt

∂q
∂t

=

+ u · ∇q = 0.

Γn =

qnhdr.

Z

h

u2
2

E =

Z

1
2 Z

dr +

gh2dr,

Each mass element hdr is also conserved in the course of the evolution. This
implies that the shallow-water equations conserve the PV moments

The moments n = 0, 1, 2 are, respectively, the total mass M, the circulation
Γ and the PV enstrophy Γ2. The energy

involving a kinetic and a potential part is also conserved. It is convenient to
use a Helmholtz decomposition of the momentum hu into a purely rotational
and purely divergent part

hu = −ez × ∇ψ + ∇φ.

For any stationary solution, the mass conservation (1) reduces to ∇ · (hu) = 0
so that

hu = −ez × ∇ψ,

(10)

3

(3)

(4)

(5)

(6)

(7)

(8)

(9)

where ψ is the stream-function. Then Eq. (6) reduces to u · ∇q = 0 which
implies that q = f (ψ). Finally, Eq. (3) reduces to

(ωωω + 2Ω) × u = −∇B.

Taking the scalar product with u, we obtain u · ∇B = 0 so that B = B(ψ).
Then, substituting Eq. (10) in Eq. (11) we obtain

q = −

dB
dψ

.

The SW equations admit an inﬁnite class of stationary solutions, speciﬁed by
the relations B = B(ψ) and q = f (ψ) = −B′(ψ). They are determined by the
two coupled partial diﬀerential diﬀerential equations for ψ and h

−

∆ψ
h2 +

2Ω
h

+

1
h3 ∇ψ · ∇h = −

dB
dψ

,

(∇ψ)2
2h2 + gh = B(ψ).

(11)

(12)

(13)

(14)

This formulation of the SW equations in terms of (h, ψ) variables has been
introduced in Chavanis & Sommeria (2002).

3 The equilibrium statistical mechanics

3.1 Freely evolving ﬂows

The SW equations are known to develop a complicated mixing process which
ultimately leads to the emergence of a large-scale coherent structure, typically
a jet or a vortex. One question of fundamental interest is to understand and
predict the structure and the stability of these equilibrium states. This can
be achieved by using statistical mechanics arguments. The idea is to replace
the deterministic description of the ﬂow q(r, t) by a probabilistic description
where ρ(r, σ, t) gives the density probability of ﬁnding the PV level q = σ
ρ(r, σ)dσ = 1).
in r at time t (it satisﬁes the local normalization condition
The observed (coarse-grained) PV ﬁeld is then expressed as q(r, t) =
ρσdσ.
To apply the statistical theory, one must ﬁrst specify the constraints attached
qhdr and
to the SW equations. The mass M =
2 dr + 1
gh2dr will be called robust constraints because they
energy E =
can be expressed in terms of the coarse-grained ﬁeld. These integrals can be

hdr, circulation Γ =

h u2

R

R

R

R

2

R

R

4

calculated at any time from the coarse-grained ﬁeld and they are conserved
by the (macroscopic) dynamics. By contrast, the Casimir invariants If =
f (q)hdr, or equivalently the ﬁne-grained moments of the vorticity Γf.g.
n>1 =
ρσndσhdr, will be called fragile constraints because they must
qnhdr =
R
be expressed in terms of the ﬁne-grained PV. Indeed, the moments of the
R
R
coarse-grained PV Γc.g
qnhdr are not conserved since qn 6= qn (part of
the coarse-grained moments goes into ﬁne-grained ﬂuctuations). Therefore,
the moments Γf.g.
n>1 must be calculated from the ﬁne-grained ﬁeld q(r, t) or
from the initial conditions, i.e. before the PV vorticity has mixed. Since we
often do not know the initial conditions nor the ﬁne-grained ﬁeld, the Casimir
invariants often appear as “hidden constraints” (Chavanis , 2006).

n>1 =

R

The statistical theory of Miller and Robert-Sommeria-Chavanis for the 2D
Euler equations and the SW equations is based on several assumptions: (i)
it is assumed that the ﬂow is freely evolving without small-scale forcing and
dissipation. (ii) it is assumed that we know the initial conditions (or equiva-
lently the value of all the Casimirs) in detail. (iii) it is assumed that mixing is
eﬃcient and that the evolution is ergodic so that the system will reach at equi-
librium the most probable (most mixed) state. Within these assumptions 1 ,
the statistical equilibrium state of the SW system is obtained by maximizing
the mixing entropy

S[ρ] = −

ρ ln ρhdrdσ,

Z

(15)

while conserving the energy, the circulation, the mass and all the Casimirs.
We write the variational principle in the form

δS − βδE − αδΓ − γδM −

αnδΓf.g.

n −

ζ(r)δ

ρdσ

hdr = 0.

(16)

n>1
X

Z

(cid:18)Z

(cid:19)

In the present point of view, all the constraints are treated on the same footing.

1 Some attempts have been proposed to go beyond the assumptions (ii) and (iii) of
the statistical theory. For example, Chavanis & Sommeria (1996) consider a strong
mixing limit in which only the ﬁrst moments of the vorticity are relevant instead
of the whole set of Casimirs. On the other hand, Chavanis & Sommeria (1998)
introduce the concept of maximum entropy bubbles (or restricted equilibrium states)
in order to account for situations where the evolution of the ﬂow is not ergodic
in the whole available domain but only in subdomains. A 2D turbulent ﬂow is
therefore viewed as an ensemble of isolated vortices which can be seen as “maximum
entropy bubbles” separated by un-mixed ﬂow. In 2D decaying turbulence, these
isolated vortices result from previous mergings and they are expected to correspond
to statistical equilibrium states (Laval et al , 2001). In fact, because of incomplete
relaxation, they may just well be particular stable stationary solutions of the 2D
Euler equation that are incompletely mixed.

5

In particular, the moments Γf.g.
ultimately relate the Lagrange multipliers αn to the constraints Γf.g.
n .

are treated microcanonically and we must

n

3.2 Prior distribution and relative mixing entropy

In the approach of Chavanis & Sommeria (2002), it is assumed that the sys-
tem is strictly described by the SW equations so that the conservation of all the
Casimirs has to be taken into account. However, in geophysical situations, the
ﬂows are forced and dissipated at small scales (due to convection in the jovian
atmosphere) so that the conservation of the Casimirs is destroyed. Ellis et al
(2002) have proposed to treat these situations by ﬁxing the conjugate vari-
ables αn>1 instead of the fragile moments Γf.g.
n>1. If we view the PV levels as
species of particles, this is similar to ﬁxing the chemical potentials instead of
the total number of particles in each species. Therefore, the idea is to treat the
fragile constraints canonically, whereas the robust constraints (E, Γ, M) are
still treated microcanonically. This point of view has been further developed in
Chavanis (2005a) and Chavanis (2005b) in the QG model and this approach
is extended here to the SW system. The relevant thermodynamical potential
is obtained from the mixing entropy (15) by using a Legendre transform with
respect to the fragile constraints:

Sχ = S −

αnΓf.g.
n .

n>1
X

Explicating the ﬁne-grained moments, we obtain

Sχ = −

ln ρ +

αnσn

hdrdσ.

ρ
(cid:20)

Z

n>1
X

(cid:21)

Introducing the function

χ(σ) ≡ exp

−

αnσn

.
(cid:27)

(cid:26)

n>1
X

we get

Sχ[ρ] = −

ρ
χ(σ) (cid:21)

ρ ln
(cid:20)

Z

hdrdσ,

(17)

(18)

(19)

(20)

which has the form of a relative entropy. The function χ(σ) is interpreted as a
prior vorticity distribution. It is a global distribution of PV ﬁxed by the small-
scale forcing. We shall assume that this function is imposed by the small-scale
forcing so it must be regarded as given.

6

Assuming ergodicity, the statistical equilibrium state is now obtained by maxi-
mizing the relative entropy Sχ at ﬁxed energy E, circulation Γ and mass M (ro-
bust constraints). The conservation of the Casimirs has been replaced by the
speciﬁcation of the prior χ(σ). From that point, we can repeat the calculations
of Chavanis & Sommeria (2002) with almost no modiﬁcation. The only dif-
ference is that we regard the αn as given. Writing δSχ −βδE −αδΓ−γδM = 0,
ρdσ = 1, we ﬁnd (i) that the
and accounting for the normalization condition
statistical equilibrium state is a stationary solution of the SW equation (ii)
that the detailed distribution of PV levels is given by the Gibbs state

R

ρ(r, σ) =

χ(σ)e−(βψ+α)σ,

1
Z

where the partition function

Z =

χ(σ)e−(βψ+α)σdσ,

Z

(21)

(22)

is determined by the local normalization condition. The distribution of the
ﬂuctuations of PV vorticity is the product of a universal Boltzmann factor by
a non-universal function χ(σ) ﬁxed by the forcing. This is the same formula
as in Chavanis & Sommeria (2002) except that in the present formalism χ(σ)
must be regarded as given a priori while in Chavanis & Sommeria (2002)
it was a function of the Lagrange multipliers αn that had to be related a
posteriori to the ﬁne-grained moments imposed by the initial conditions. The
equilibrium coarse-grained PV is

χ(σ)σe−(βψ+α)σdσ
χ(σ)e−(βψ+α)σdσ

= −

1
β

d ln Z
dψ

q =

R

R

= F (βψ + α) = f (ψ).

(23)

The coarse-grained vorticity (23) can be viewed as a sort of superstatistics
(Chavanis , 2006) as it is expressed as a superposition of Boltzmann factors
(on the ﬁne-grained scale) weighted by a non-universal function χ(σ). We note
that the q − ψ relationship predicted by the statistical theory can take a wide
diversity of forms (usually non-Boltzmannian) depending on the prior χ(σ).
The function F is entirely speciﬁed by the prior PV distribution according to

F (Φ) = −(ln ˆχ)′(Φ),

with

ˆχ(Φ) =

χ(σ)e−σΦdσ.

(24)

Diﬀerentiating Eq. (23) with respect to ψ, we ﬁnd that

q′(ψ) = −βq2,

q2 = q2 − q2 ≥ 0.

(25)

+∞

Z−∞

7

This relation relates the slope of the q = f (ψ) relationship to the local
centered variance q2(ψ) of the PV distribution. This can also be written
F ′(Φ) = −q2(Φ) ≤ 0 so that F is a decreasing function. Therefore, the sta-
tistical theory predicts that the coarse-grained ﬁeld is a stationary solution
of the SW equation and that the q − ψ relationship is a monotonic function
which is increasing at negative temperatures β < 0 and decreasing at posi-
tive temperatures β > 0. We note that, according to Eqs. (12) and (23), the
Bernouilli function is given by

B =

ln Z,

1
β

and it plays the role of a free energy in the statistical theory (if we interpret
Z as a partition function).

We also note that the most probable PV ﬁeld hσi(r) of the Gibbs distribution
(21) is given by (Leprovost et al , 2006):

hσi = [(ln χ)′]−1(βψ + α),

provided that (ln χ)′′(hσi) < 0. This is also a stationary solution of the SW
system which usually diﬀers from the average value q(r) of the Gibbs distri-
bution (21). They coincide only when

− (ln ˆχ)′(Φ) = [(ln χ)′]−1(Φ),

which is the case when χ(σ) is gaussian.

3.3 Generalized entropy

We ﬁrst show that a PV ﬁeld which extremizes a functional of the form

H[q] = −

C(q)hdr,

Z

where C is a convex function, at ﬁxed energy E, mass M and circulation Γ,
is a steady state of the SW equations. We write the variational principle as

δH − βδE − αδΓ − γδM = 0.

Using the results of Chavanis & Sommeria (2002), we have

δE =

Bδhdr +

ψδ(qh)dr −

φδ(∇ · u)dr,

Z

Z

Z

8

(26)

(27)

(28)

(29)

(30)

(31)

δΓ =

δ(qh)dr,

Z

δH = −

C(q)δhdr −

C ′(q)δ(qh)dr +

C ′(q)qδhdr,

Z

Z

Z

where we have taken h, qh and ∇ · u as independent variables. The variations
on ∇ · u yield φ = 0. The variations on qh give

so that B = B(ψ). Taking the derivative of Eq. (35) with respect to ψ, we
ﬁnd that

C ′(q) = −βψ − α,

so that q = f (ψ). The variations on h give

qC ′(q) − C(q) = βB + γ,

qC ′′(q)

dq
dψ

= β

dB
dψ

.

dq
dψ

= −

β
C ′′(q)

,

According to Eq. (34), we also have

(32)

(33)

(34)

(35)

(36)

(37)

so that q(ψ) is a monotonic function increasing at negative temperatures and
decreasing at positive temperatures. Furthermore, we ﬁnd that Eq. (36) is
equivalent to q = −dB/dψ. Therefore, the optimization problem (30) de-
termines stationary solutions of the SW system. Since H, E, Γ and M are
conserved by the SW equations, we can argue, as for the 2D Euler equation
(Ellis et al , 2002), that a maximum of H at ﬁxed E, Γ and M (if it exists)
will be nonlinearly dynamically stable with respect to the SW system. In this
dynamical context, H is referred to as a Casimir functional and E − H as an
energy-Casimir functional.

Note that the optimization problem (30) can also be justiﬁed by a selective
decay principle (for −H) if we interpret the PV vorticity as the coarse-grained
PV. Indeed, −H[q] calculated with the coarse-grained PV decreases (fragile
constraint) while E[q], Γ[q] and M[q] are approximately conserved (robust
constraints). This selective decay principle can explain physically how −H[q]
can possibly reach a minimum value while −H[q] is exactly conserved by
the SW equations. In this coarse-grained context, H[q] is referred to as a
generalized H-function (Tremaine et al , 1986).

9

Finally, we note that the equilibrium state (23) predicted by the statistical
theory extremizes a certain H-function at ﬁxed E, Γ and M. This functional

S[q] = −

C(q)hdr,

Z

corresponding to the statistical equilibrium state, will be called a generalized
entropy in q-space (Chavanis , 2006). It is completely determined by the prior
PV distribution. It should not be confused with the mixing entropy (15) which
is a functional of ρ. Coming back to Eq. (34) and recalling that C is convex (so
that this relation can be inversed), we ﬁnd that Eqs. (34) and (23) coincide
provided that C ′(q) = −F −1(q). Therefore, the prior PV distribution χ(σ)
determines F (x) which itself determines C(q) according to

C(q) = −

F −1(x)dx.

In other words, to obtain C(q), we need to inverse Eq. (23) and integrate
the resulting expression. Some examples are collected in Chavanis
(2003).
Combining the previous relations, we ﬁnd that the generalized entropy is de-
termined by the prior according to (Chavanis , 2006)

q

Z

q

Z

C(q) = −

[(ln ˆχ)′]−1(−x)dx.

Finally, comparing Eqs. (37) and (25) we get the relation

q2 =

1
C ′′(q)

,

which is exact at statistical equilibrium.

4 Relaxation equations

4.1 Maximum Entropy Production Principle

(38)

(39)

(40)

(41)

In the case of freely evolving ﬂows, Chavanis & Sommeria (2002) have pro-
posed a thermodynamical parametrization of the SW equations (on the coarse-
grained scale) in the form of relaxation equations that conserve all the con-
straints of the SW dynamics (including the Casimirs) and increase the mixing

10

∂h
∂t

∂u
∂t

∂
∂t

entropy. In the case of ﬂows that are forced at small-scales, the Casimirs are re-
placed by the speciﬁcation of a prior vorticity distribution or, as we have seen,
by a generalized entropy. In this context, we can propose a thermodynami-
cal parametrization of the SW equations in the form of relaxation equations
that conserve only the robust constraints (mass, energy and circulation) and
increase the generalized entropy S[q] ﬁxed by the prior.

We ﬁrst decompose the vorticity ω and velocity u into a mean and ﬂuctuating
part, namely ω = ω + ˜ω, u = u + ˜u, keeping h smooth. Taking the local
average of the shallow water equations (1)(3), we get

+ ∇ · (hu) = 0,

+ (ωωω + 2Ω) × u = −∇B − ez × Jω,

where the current Jω = ˜ω˜u represents the correlations of the ﬁne-grained
ﬂuctuations. We deduce an equation for the evolution of the potential vorticity
(5), taking the curl of Eq. (43) and using Eq. (42):

(hq) + ∇ · (hq u) = −∇ · Jω.

R

This equation can be viewed as a local conservation law for the circulation
qhdr. It shows also that Jω represents the current of coarse-grained
Γ =
vorticity due to mixing. We shall determine the unknown current Jω by the
thermodynamic principle of Maximum Entropy Production (MEP), using the
generalized entropy (38). The Maximum Entropy Production (MEP) princi-
ple consists in choosing the current Jω which maximizes the rate of entropy
production ˙S respecting the constraints ˙E = 0, and J 2
ω ≤ C(r, t). The last
constraint expresses a bound (unknown) on the value of the diﬀusion current.
Convexity arguments justify that this bound is always reached so that the
inequality can be replaced by an equality. We write the variational problem
as

δ ˙S − β(t)δ ˙E −

D−1δ

dr = 0,

J 2
ω
2 (cid:19)

(cid:18)

Z

where β(t) is a Lagrange multiplier accounting for the conservation of energy
and D−1 is a Lagrange multiplier associated with the constraint J 2
ω = C(r, t).
The conservations of mass and circulation are automatically satisﬁed by the
form of the relaxation equations (42) and (43). Noting that

(42)

(43)

(44)

(45)

(46)

˙E =

Jω · u⊥hdr,

Z

11

(47)

(48)

(49)

(50)

(51)

(52)

(53)

(54)

and performing the variations on Jω in Eq. (45), we obtain an optimal current

˙S = −

C ′′(q)Jω · ∇qdr,

Z

Jω = −D

∇q +

(cid:20)

β(t)
C ′′(q)

hu⊥

.

(cid:21)

Thus, in the presence of a prior PV distribution, we obtain a parametrization
of the SW equations of the form

+ ∇ · (hu) = 0,

∂h
∂t

∂u
∂t

+ qhez × u = −∇

+ gh

+ D

u2
2

(cid:18)

(cid:19)

ez × ∇q −
"

β(t)
C ′′(q)

,

hu
#

q =

(∇ × u) · ez + 2Ω
h

, β(t) = −

Dhu⊥ · ∇qdr
D u2h2
C′′(q)dr

,

R

R

n · ∇q = −

h n · u⊥

(on each boundary),

β(t)
C ′′(q)

n · u = 0

(on each boundary),

where n is a unit vector normal to the boundary and we have omitted the
overbar on u. The relaxation equation for the coarse-grained vorticity is given
by

∂
∂t

(hq) + ∇ · (hqu) = ∇ ·

D

∇q +

β(t)
C ′′(q)

hu⊥

.

(cid:21))

(

(cid:20)

These equations can also be directly obtained from the parametrization of
Chavanis & Sommeria (2002) by replacing q2 in their parametrization by
1/C ′′(q). Therefore, the identity (41) can be viewed as a closure relationship
in the present context. This relation is valid at equilibrium but the present
approach suggests that it is also valid out-of-equilibrium when there is a prior
distribution of PV. In fact, we can obtain this relation by assuming that,
out-of-equilibrium, the PV distribution ρ(r, σ, t) maximizes the relative en-
tropy (20) at ﬁxed PV q(r, t) and normalization (Appendix C of Chavanis
(2005a)).

The entropy production (47) can be written

˙S = −

C ′′(q)Jω ·

∇q +

Z

"

β(t)
C ′′(q)

hu⊥

dr + β(t)

Jω · u⊥hdr.

(55)

#

Z

12

Using the conservation of energy ˙E = 0 with Eq. (46), the second integral is
seen to vanish. Substituting Eq. (48) in the ﬁrst integral, we ﬁnally obtain

which is positive provided that D ≥ 0. A stationary solution of the relaxation
equations (49)-(53) satisﬁes ˙S = 0 yielding Jω = 0, i.e.

˙S =

C ′′(q)

dr ≥ 0,

J2
ω
D

Z

∇q +

∇ψ = 0.

β
C ′′(q)

After integration, we obtain

C ′(q) = −βψ − α.

Therefore, the generalized entropy increases until the statistical equilibrium
state (23)-(34), ﬁxed by the prior χ(σ), is reached with β = limt→+∞ β(t).
Alternatively, these equations can be used as a numerical algorithm to com-
pute arbitrary stationary solutions of the SW system speciﬁed by the convex
function C (see Sec. 3.3).

4.2 The incompressible limit

The case of ordinary 2D incompressible turbulence is recovered in the limit
h → 1, q → ω and u = −ez × ∇ψ. The relaxation equation for the coarse-
grained vorticity is given by

∂ω
∂t

+ u · ∇ω = ∇ ·

D

∇ω +

(

(cid:20)

β(t)
C ′′(ω)

∇ψ

,

(cid:21))

with

β(t) = −

D∇ω · ∇ψdr
D (∇ψ)2
C′′(ω)dr

.

R

R

This returns the equations introduced by Chavanis (2003) in 2D turbulence
in the case where the system is described by a prior vorticity distribution.
They can be viewed as nonlinear mean-ﬁeld Fokker-Planck equations. They
are the forced-case counterpart of the relaxation equations introduced by
Robert & Sommeria (1992) for freely evolving ﬂows that conserve all the
Casimir constraints.

13

(56)

(57)

(58)

(59)

(60)

The relaxation equation (50) for the velocity ﬁeld can be written

∂u
∂t

+ (u · ∇)u = −

∇p + D

∆u −

1
ρ

β(t)
C ′′(ω)

,

u
#

"

where we have used the well-known identity of vector analysis ∆u = ∇(∇ ·
u) − ∇ × (∇ × u) which reduces for a two-dimensional incompressible ﬂow to
∆u = ez × ∇ω. Eq. (61) is valid even if D is space dependant unlike with a
usual viscosity term. In previous publications this equation was given only in
its vorticity form (59) and the equivalence with Eq. (61) is not obvious at ﬁrst
sights when D is space dependent. At equilibrium, we have from Eq. (61) the
identity

∆u =

β
C ′′(ω)

u,

which can be deduced directly from the stationary state (34). Indeed, for a
stationary solution ω = f (ψ), the previous identity ∆u = ez × ∇ω becomes
∆u = −f ′(ψ)u which is equivalent to Eq. (62) for a steady state thanks to Eq.
(37). Finally, the previous equations can be extended to the quasi-geostrophic
(QG) limit if we replace ω by the PV q related to the stream-function by

(61)

(62)

(63)

q = −∆ψ +

ψ
L2
R

,

where LR is the Rossby radius.

4.3 Explicit examples

In the present formalism, one has to specify (i) a prior PV distribution χ(σ)
which encodes small-scale forcing and non-ideal eﬀects (ii) the robust con-
straints E, Γ and M which can be determined at any time from the coarse-
grained ﬂow. From the prior PV distribution, we can determine a generalized
entropy C(q) by using the procedure exposed in Sec. 3.3 (see in particular
Eq. (40)). Then, we can use this entropy in the parametrization (49)-(53) to
obtain the dynamical evolution of the coarse-grained ﬂow towards statistical
equilibrium. The diﬃculty is now to ﬁnd the good prior. This depends from
case to case as it is related to the properties of forcing, but the idea is that
several forms of prior (or corresponding entropies) give similar results so that
they can be regrouped in classes of equivalence (Chavanis , 2003). Thus, for
a given situation, one has to ﬁnd the relevant class of equivalence. In general,
one has to proceed by tryings and errors. We specify a prior, compute the

14

corresponding ﬂow and see whether it agrees with the information that we
have on the system. If we ﬁnd a “good prior” for a system with some given
initial conditions, then we can expect that it will remain valid for this system
when we change the initial conditions (or, equivalently, the value of the robust
constraints E, Γ and M). Note that specifying the prior is not the end of the
story but only the starting point. Indeed, there can be diﬀerent types of solu-
tions for a given prior PV distribution depending on the values of the control
parameters. Thus, we have to study the bifurcation diagram as a function of
these parameters E, Γ and M for a given prior χ(σ) or generalized entropy
C(q). This is a rich and non trivial problem.

Let us give some examples to illustrate our approach. In the case of Jovian
ﬂows, Ellis et al (2002) have proposed to adopt a prior χ(σ) corresponding
to a de-centered Gamma distribution. This leads to a generalized entropy of
the form (Chavanis , 2006)

C(q) =

q −

ln(1 + ǫq)

,

1
ǫ (cid:20)

1
ǫ

(cid:21)

q = −

βψ + α
1 + ǫ(βψ + α)

.

where 2ǫ is the skewness of the PV distribution. We have C ′(q) = q/(1 + ǫq)
and C ′′(q) = 1/(1 + ǫq)2 so that the statistical equilibrium state is speciﬁed
by

(64)

(65)

In the limit ǫ → 0, the generalized entropy (64) becomes minus the enstrophy
S[q] = − 1
q2dr and the q = f (ψ) relationship is linear. The parametrization
2
that we propose in that case for the vorticity equation is

R

∂
∂t

(hq) + ∇ · (hqu) = ∇ ·

D

∇q + β(t)(1 + ǫq)2hu⊥
(cid:20)

(cid:21)(cid:27)

.

(cid:26)

(66)

On the other hand, in order to describe jovian ﬂows, Sommeria et al (1991)
have considered a case of the statistical theory where the PV distribution is
restricted to two-levels. In their approach, the ﬂow is assumed to be freely
evolving and the dynamics corresponds to the inviscid mixing of patches with
PV σ0 and σ1. As discussed in Chavanis (2005a), we can also consider the
case of a ﬂow that is permanently forced at small-scales (due to convection)
so that a prior PV distribution is established with two intense peaks at σ0 and
σ1. In the two-levels case, theses two interpretations lead to the same results
but the second one can probably be extended more easily to the more realistic
situation where the peaks have a ﬁnite width ∆σ. If we adopt a prior of the

15

form χ(σ) = δ(σ − σ1) + χδ(σ − σ0), we ﬁnd that the generalized entropy is

C(q) =

[(q − σ0) ln(q − σ0) + (σ1 − q) ln(σ1 − q)] .

(67)

1
σ1 − σ0

σ1−σ0 ln( q−σ0
We have C ′(q) = 1
statistical equilibrium state is

σ1−q ) and C ′′(q) = 1/[(q − σ0)(σ1 − q)] so that the

q = σ0 +

σ1 − σ0
1 + χe(σ1−σ0)(βψ+α) ,

(68)

similar to the Fermi-Dirac distribution. The parametrization that we propose
in that case for the vorticity equation is

∂
∂t

(hq) + ∇ · (hqu) = ∇ ·

D

∇q + β(t)(q − σ0)(σ1 − q)hu⊥
(cid:20)

(cid:26)

(cid:21)(cid:27)

,

(69)

and it coincides with the parametrization of Chavanis & Sommeria (2002)
in the two-levels case of the statistical theory. Therefore, the approach based
on priors is not in radical opposition with the usual statistical theory but it
allows for convenient extensions in more general cases.

Explicit determinations of the statistical equilibrium state speciﬁed by Eqs.
(65) and (68) have been obtained in the QG limit of the statistical theory.
In the two approaches, a vortex solution has been found at the latitude of
Jupiter’s great red spot where the underlying topography is extremum (or
the shear is equal to zero). In the case of the Fermi-Dirac distribution (68),
Sommeria et al
(1991) consider the limit of small Rossby radius and ﬁnd
that the vortex has an annular jet structure which is consistent with the
morphology of Jupiter’s great red spot. This study has been further developed
in Bouchet & Sommeria (2002) and it has been extended by Bouchet et al
(2006) to the case of the SW system. In these studies, the structure of Jupiter’s
great red spot can be seen as the co-existence of two thermodynamical phases
in contact separated by a sort of “domain wall” (Chavanis , 2005a) in the
langage of phase ordering kinetics (like in the Cahn-Hilliard theory). This
annular jet structure is not obtained in the approach of Ellis et al (2002). This
implies that the prior PV distribution relevant to the case of JGRS is probably
closer to two intense peaks rather than to a decentered Gamma distribution.
These two distributions belong to diﬀerent classes of equivalence since they
lead to structurally diﬀerent solutions. Probably, the prior distribution could
be improved to give a better description of jovian vortices, but a distribution
with two intense peaks already gives a fair description.

16

5 Conclusion

In this paper, we have extended the “ordinary” statistical theory of the SW
system (Chavanis & Sommeria , 2002) to account for the existence of a prior
vorticity distribution. This approach can be justiﬁed when the system is forced
at small-scales so that a permanent PV distribution is imposed canonically.
In that case, the forcing acts like a sort of reservoir. The attractive nature of
this theory is its practical interest: in the standard theory, one works with the
Boltzmann entropy in ρ-space and deals with a very large (possibly inﬁnite)
number of Casimir constraints which are often not known or not rigorously
conserved. In the other approach, one conserves only the robust constraints
(E, Γ, M) and work with a generalized entropic functional in q-space ﬁxed by
the prior (that has to be found by tryings and errors). Therefore, in the ﬁrst
approach, we have to solve N coupled relaxation equations (one for each level)
while in the second approach, we just have to solve one relaxation equation.
Whether this approach is really physically relevant remains to be established.
In any case, the relaxation equations (49)-(53) can be used as numerical algo-
rithms to construct a large class of stationary solutions of the SW equations,
which is certainly an interest of our formalism.

References

Bouchet, F., Sommeria, J.: 2002, JFM 464, 165
Bouchet, F., Chavanis P.H. & Sommeria, J.: 2006, in preparation
Chavanis, P.H.: 2003, PRE 68, 036108
Chavanis, P.H.: 2005a, Physica D 200, 257
Chavanis, P.H.: 2005b, in Proceedings of the Workshop on “Interdisciplinary
Aspects of Turbulence” at Ringberg Castle, Tegernsee, Germany (Max-
Planck Institut f¨ur Astrophysik) [physics/0601087]

Chavanis, P.H.: 2006, Physica A 359, 177
Chavanis, P.H., Sommeria, J.: 1996, JFM 314, 267
Chavanis, P.H., Sommeria, J.: 1998, JFM 356, 259
Chavanis, P.H., Sommeria, J.: 2002, PRE 65, 026302
Ellis, R., Haven, K., Turkington, B.: 2002, Nonlinearity 15, 239
Laval, J.P., Chavanis, P.H., Dubrulle, B., Sire, C.: 2001, PRE 63, 065301(R)
Leprovost, N., Dubrulle, B., Chavanis, P.H.: 2006, PRE 73, 046308
Miller J.: 1990, PRL 65, 2137
Robert, R., Sommeria, J.: 1991, JFM 229, 291
Robert, R., Sommeria, J.: 1992, PRL 69, 2776
Sommeria, J., Nore, C., Dumont, T., Robert, R.: 1991, CRAS Ser. II 312, 999
Tremaine, S., H´enon, M., Lynden-Bell, D.: 1986, MNRAS 219, 285

17

