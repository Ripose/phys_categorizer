1
0
0
2
 
r
a

M
 
6
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
3
8
0
3
0
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Time resolved tracking of a sound scatterer in a complex ﬂow: non-stationary signal
analysis and applications

Nicolas Mordant and Jean-Fran¸cois Pinton∗
´Ecole Normale Sup´erieure de Lyon & CNRS umr 5672,
Laboratoire de Physique
46, all´ee d’Italie, F-69364 Lyon, France

Olivier Michel
Universit´e de Nice
Laboratoire d’astrophysique & CNRS umr 5525,
Parc Valrose, F-06108 Nice, France
(Dated: December 22, 2013)

It is known that ultrasound techniques yield non-intrusive measurements of hydrodynamic ﬂows.
For example, the study of the echoes produced by a large number of particles insoniﬁed by pulsed
wavetrains has led to a now standard velocimetry technique. In this paper, we propose to extend
the method to the continuous tracking of one single particle embedded in a complex ﬂow. This gives
a Lagrangian measurement of the ﬂuid motion, which is of importance in mixing and turbulence
studies. The method relies on the ability to resolve in time the Doppler shift of the sound scattered
by the continuously insoniﬁed particle.
For this signal processing problem two classes of approaches are used: time-frequency analysis and
parametric high resolution methods. In the ﬁrst class we consider the spectrogram and reassigned
spectrogram, and we apply it to detect the motion of a small bead settling in a ﬂuid at rest. In more
non-stationary turbulent ﬂows where methods in the second class are more robust, we have adapted
an Approximated Maximum Likelihood technique coupled with a generalized Kalman ﬁlter.

PACS numbers: 43.30.Es, 43.60.-c, 47.80.+v, 43.60.Qv

I.

INTRODUCTION

In several areas of ﬂuid dynamics research, it is desirable to study the motion individual ﬂuid particles in a ﬂow,
i.e. the Lagrangian dynamics of the ﬂow. The properties of this motion governs the physics of mixing, the behavior of
binary ﬂows and the Eulerian complexity of chaotic and turbulent ﬂows. Lagrangian studies are possible in numerical
experiments where chaotic1 and turbulent2,3,4,5 ﬂows have been studied. For turbulence, the numerical studies are
limited to small Reynolds number ﬂows whose evolution is only followed during a few large-eddy turnover times. In
addition only the small scales properties of homogeneous turbulence are captured; the inﬂuence of inhomogeneities
(such as large scale coherent structures) are not taken into account. It does not seem possible at the moment to extend
high resolution turbulent DNS computations to long periods of time or to high Reynolds number ﬂows. Experimental
studies are thus needed. They diﬀer from the numerical studies because one cannot tag and follow individual ﬂuid
particles; most techniques aim at recording the motion of solid particles carried by the ﬂow motion. The degree
of ﬁdelity with which solid particles can act as Lagrangian tracers is an open problem; it depends on the size and
density of the particle. While the interaction between the particle and its wake can be important for large particles or
particles with a large density diﬀerence with the surrounding ﬂuid6,7,8, it is generally admitted that density matched
particles with a size smaller that the Kolmogorov length follow the ﬂuid. Measurements of small particle motion have
been made, using optical techniques that follow individual particle motion over short times/distances9,10. We propose
here an acoustic technique that can resolve an individual particle motion over long periods of time (compared with
the characteristic time of ﬂow forcing).

The principle of the technique is to monitor the Doppler shift of the sound scattered by a particle which is con-
tinuously insoniﬁed. This is an extension of the pulsed Doppler method that has been developed to measure velocity
proﬁles and that has many applications in ﬂuid mechanics and medicine11. The main advantage of the continuous
insoniﬁcation is to improve the time resolution of the measurement, although it is limited to the tracking of a very
small number of particles (the tests reported here are made with only one particle in the ﬂow). The measurement
relies on the ability to track a Doppler frequency and its variation in time. For this signal processing problem two
classes of approaches have been developed: (i) time-frequency analysis and (ii) high resolution parametric spectral
analysis. Time frequency methods mainly rely upon the quadratic Wigner-Ville transform, or smoothed versions of it.
Numerous studies and papers have recently been published, in which the theoretical issues are presented (see e.g. the
textbooks by Flandrin12 or Cohen13). These non parametric techniques are convenient and well-suited for weakly non-
stationary signals with a good signal-to-noise ratio (SNR). However, time frequency representations present numerous

2

(1)

(2)

FIG. 1: Principle of measurement. A large 3D measurement zone is achieved by using a transducer size of a few wavelengths.

drawbacks when it comes to extract trajectory information. Their quadratic nature give rise to numerous spurious
interference terms that require post processing. For signals with a faster frequency modulation and a low SNR, we
show here that an optimized parametric approach is a better choice. Parametric high resolution spectral analysis
methods take advantage of an a priori knowledge of the spectral content of the recorded signal, namely the emitted
signal frequency plus one or many doppler-shifted echoes. Furthermore, a time-recursive frame for the estimation of
the Doppler shift is proposed here, where the evolution of the frequency is taken into account in the algorithm.

The two methods are tested in two experiments, in which the acoustic signals have diﬀerent time scales and noise
levels. The ﬁrst experiment is a study of the transient acceleration of a heavy sphere settling under gravity in a ﬂuid
50 ms) and the signal to noise ratio
at rest. In this case the characteristic time scale of velocity variations is slow (τ
is fair (about 20 dB); we show that a technique of reassignment of the spectrogram gives good results. The second
experiments deals with the motion of a neutrally buoyant sphere embedded in a turbulent ﬂow. In this case, velocity
variations occur over times of about 1 ms and the signal to noise ratio is low (less than 6 dB). We show that the AML
parametric method yields very good results in that situation.

∼

The paper is organized as follows: in section II we present the acoustic technique and measurement procedure. In
section III we describe the signal processing techniques, with a particular emphasis on the AML method which has
been developed and optimized to this particle tracking problem. Examples of applications to measurements in real
ﬂows are given in section IV.

In the experimental technique proposed here, a particle is continuously insoniﬁed. It scatters a sound wave whose
frequency is shifted from the incoming sound frequency due to the Doppler eﬀect. This Doppler shift is directly
related to the particle velocity vp:

where q is the scattering wavevector (the diﬀerence between the incident and scattered wavevectors q = kscat −
and ω is the wave pulsation.

kinc)

We choose a backscattering geometry (see ﬁgure 1) so that q =

2kinc and the frequency shift becomes

II. ACOUSTICAL SET-UP

A. Principle of the measurement

∆ω = q

vp ,

·

−

∆ω(t) =

v(t)
c

2

−

ω0 ,

where c is the speed of sound, ω0 is the incident pulsation, and v(t) is the component of the velocity on the incident
direction at time t. We continuously insonify the moving particle and record the scattered sound. If need be, the
particle position can be obtained by numerical integration of the velocity signal.

3

20

0

−20

0.1

0.05

0.1

0.15

0.2
time ( s )

0.11

0.12

0.25

0.3

)
 

V
µ
 
(
 
e
d
u
t
i
l

p
m
a

40

20

0

−20

−40

0

)
 

B
d
 
(
 
e
d
u
t
i
l

p
m
a

−110

−130

−150

−170

−2000

−1000

0
frequency ( Hz )

1000

2000

FIG. 2: Data from a steel bead (diameter 1 mm) settling in water at rest. (a) Typical time series; (b)power spectral density of
the inset ﬁgure. On the x-axis, zero corresponds to the emission frequency.

B. Transducers characteristics and acquisition

We use a Vermon array of ultrasonic transducers made of individual elements of size 2

2 mm each, separated by
100 µm. Their resonant frequency is about 3.2 MHz and their bandwidth at -3 dB is 1.5 MHz. Sound emission is
set at 3 MHz or 3.5 MHz; experiments are performed in water so that the wavelength is λ=0.50 mm or 0.43 mm.
The corresponding emission cone for each d = 2 mm square element is 29◦ at 3 MHZ and 24◦ at 3.5 MHz. In our
measurements, the particle to transducer distance lies between 5 cm and 40 cm, so that measurements are made in
the far ﬁeld (d2/λ > 10 mm). Given maximum ﬂow and particle velocities of the order of 1.5 m.s−1, we expect a
maximum sound frequency shift of the order of 5 kHz or 6 kHz, depending on whether the emission is at 3 MHz or
3.5 MHz. This yields a frequency modulation rate of at most 0.25%. One element of the transducer array is used for
continuous sound emission and another for scattered sound detection. As the operation is continuous (as opposed to
pulsed) and the elements are located close to one-another, we observe a coupling between the emitter and the receiver
of the order of 60 dB (this is due both to electromagnetic and acoustic surface waves cross-talk).

×

The sound scattered by the moving particle is detected by a piezoelectric transducer. Upon connection to a 50 Ω
impedance, it yields an electrical signal of about 2 to 30 µV. In comparison, the noise is 1 µV and the electromagnetic
coupling with the emitter is 8 mV. Hence the signal to noise ratio is between 0 dB and 30 dB. The transducer output
is sampled at 10 MHz over a 21 bit dynamical range (input range 31.25 mV) and numerically heterodyned at the
emitting frequency. Then it is decimated at the ﬁnal sampling frequency of 19531 Hz. The acquisition device is a
HP-e1430A VXI digitizer.

C. Scattering by an elastic sphere

The study of sound scattered by a ﬁxed solid sphere is a classic but continuing area of study and diﬃculties
arise in the interpretation of observed phenomena especially when trying to deal with elasticity and absorption14,15,16.

4

(3)

(4)

Complex behaviour is observed linked with resonances of Rayleigh waves at the surface of the sphere. As a consequence
the scattered pressure distribution varies both in directivity and amplitude. A generic expression for the far ﬁeld
pressure is the following :

where r is the distance from the center of the sphere, a its radius, pinc the incident pressure on the sphere, k the
incident wavenumber in the ﬂuid, θ the scattering angle and f is a form function which depends on the physical
properties of the solid medium. Under very general assumptions, f can be developed as a series of partial waves:

pscat(r, θ) = pinc

af (ka, θ)
2r

eikr ,

f (ka, θ) =

(2n + 1)

Pn(cos θ) ,

2
ika

∞

n=0
X

Bn(ka)
Dn(ka)

where Pn is the a Legendre polynomial, Bn and Dn are determinants of matrices composed of spherical Bessel and
Hankel function and their derivatives14. Physically, f represents the sum of the specular echo and of interferences due
to the radiation by Rayleigh waves15,16. As a result, f is a strongly varying function, particularly for high values of
ka. In our experiments we used spheres of diﬀerent material (polypropylene PP, steel, tungsten carbide, glass) with
corresponding ka between 7 and 15. The ﬂow acts on the sphere motion, thus causing its acceleration and, eventually,
its rotation. These eﬀects may change the radiation diagram: ﬁrst there is Doppler shift for the sound received by
the sphere, and, perhaps more importantly, the sphere rotation may change the Rayleigh emission. For these reasons,
the evolution of the amplitude of the scattered sound during the particle motion is quite complex. However, the
observed amplitude modulation (see ﬁgures 2 and 8) varies slowly enough to allow a correct estimate of the frequency
modulation of the scattered sound.

III. SIGNAL PROCESSING

Numerous spectral estimation techniques are based on the ideas behind Fourier analysis of linear time invariant (LTI)
diﬀerential equations. These techniques may be divided into (i) non-parametric techniques where the basis functions
are implicitly the harmonically related complex exponentials of Fourier analysis and (ii) parametric techniques whose
task is the estimation of the parameters of a (sub)set of complex exponentials. The spectrogram and the reassigned
spectrogram belong the former category, whereas the maximum likelihood and its approximate form belong to the
latter.

A. Time-Frequency analysis

The most common time frequency distribution (TFD), the spectrogram, involves a moving time window. This
window attempts to capture a portion of the signal which is suﬃciently restricted in time so that stationarity and
LTI assumptions are approximately met. To overcome the inherently poor localization in the time-frequency plane, a
method has been proposed by Gendrin et al.17, and extended more recently by Auger and Flandrin12,18. The idea is
to locally reassign the energy distribution to the local center of gravity of the Fourier transform. Despite its ability to
exhibit clear and well localized trajectories in the time-frequency plane, this technique requires an additional image
processing step to extract the TF trajectory. For rapidly ﬂuctuating frequency modulations and/or low SNR spurious
clusters appear which makes this extraction diﬃcult. The parametric method presented below is more robust.

B. AML spectral estimation

This approach is largely based upon maximum likelihood spectral estimation (see e.g. Kay19). The fundamentals
are brieﬂy recalled, as they serve as a basis for the approximate likelihood scheme, originally developed by Clergeot
and Tressens20. This work is extended here within a recursive estimation frame, thus allowing to track the variations
of the Doppler frequency shift induced by fast velocity changes of a scattering sphere imbedded in a turbulent ﬂow.
Michel and Clergeot have developed a similar approach for non stationary spectral analysis in an array processing
frame21,22.

In this section, we address the problem of estimating the frequencies f1, . . . , fM of M harmonic signals embedded

in noise, from a small number of samples

1.

Introduction

x(t) =

am(t) exp(j(2πfmt + φm) + n(t) .

M

m=1
X

As the number of sampling points that are supposed to be available is low, classical Fourier based approaches fail
to provide good results. We focus our attention on parametric approach, where an a priori knowledge about the
structure of the signal is taken into account to improve the analysis.

The following assumptions are made:

The time series is regularly sampled with time period Ts, so as to insure 1
2 where fmax stands for the
Ts
bandwidth of the anti-aliasing ﬁlter used in the recording process. For convenience, Ts will be set to Ts = 1 and
the term frequency will refer to normalized frequency (i.e. the actual frequency, divided by Fs = 1
Ts

.

> fmax

The amplitudes ai(t) are deterministic but unknown.

The noise is a complex white gaussian circular and iid (independent increment identically distributed) with
(unknown) variance σ2; the distribution function of a k-dimensional vector ~N deﬁned by

~N (t) = [n(t), n(t + 1), n(t + 2), . . . , n(t + (K

1))]T

−

p( ~N ) =

1
(√2πσ)K

exp

~N
2
|
|
2σ2

 

.

!

Furthermore, the noise and the signal are independent.

The term observation refers to a set of Q K-dimensional vectors constructed from the sampled time series,
according to

•

~X(tj) = [x(tj ), x(tj + 1), x(tj + 2), . . . , x(tj + (K

1))]T

j = 1, . . . , Q

(8)

−

The frequency f is supposed to remain constant during an observation.

Under the assumption that the noise process is iid, and that the observed vectors are corrupted by independent reali-
sations of the noise process, the likelihood of the observation is given by the product of the likelihood of each vector. Let
and the ~A = [a1 exp(jφ1), . . . , aM exp(jφM ]T ),

be the set of searched parameters (

contains σ2, F =

f1, . . . , fM

P
the loglikelihood of an observation is simply given by

P

{

}

) =

(
P
L

−

KQ log(2πσ2)

~X(q)
|

S( ~F ) ~A(q)
2 ,
|

−

1
2σ2

−

Q

q=1
X

S( ~F ) = [~S1, . . . , ~SM ] = 



1 exp(2πf1) . . . exp(2π(K
...
...
1 exp(2πfM . . . exp(2π(K

1)f1

−

1)fM

−

T

.






According to the maximum likelihood principle, the set
expression (9).

P

of parameters must be chosen in order to maximize

reads

•

•

•

•

where

5

(5)

(6)

(7)

(9)

(10)

2. Reduced expression

Minimizing (9) jointly for all the parameters is usually untractable. Most authors propose a separate maximisation
for each of the parameters. For our application, the spectral components (i.e. ~A and ~F ) are the relevant variables.
We ﬁrst maximize with respect to ~A and derive an expression for the optimal ~F ; σ2 is estimated independently.
~X(q)
|

The value of vector ~A which minimizes the norm

S( ~F ) ~A(q)
2 is easily obtained :
|

−
~A(q) = (S+S)−1S+( ~F ) ~X(q) .

Note that the “signal only” vector ~Y = ~X
spanned by the row vectors of S:

−

~N appears to be the orthogonal projection of ~X on the signal subspace

~Y = S( ~F ). ~A(q) = S((S+S)−1S+( ~F ) ~X = Πs( ~F ) ~X ,

Πs( ~F ) be the noise
where Πs( ~F ) stands for the parametric projector on the signal subspace27. Let Πn( ~F ) = I
subspace, I is the identity matrix. By substituting (12) and using the deﬁnition of Πn( ~F ) in the expression of the
log-likelihood (9), one gets the following simpliﬁed expression to minimise

−

L( ~F ) =

Q

1
σ2

Πn( ~F ) ~X
|

2 .
|

q=1
X
Using the properties of the trace operator (hereafter denoted Tr) and those of the projection matrix Πn( ~F ), the
maximum likelihood estimation of ~F takes the common form : minimize

Q
σ2 Tr

,

L( ~F ) =

Πn( ~F ) ˆRx
h
where ˆRx is an estimate of the correlation matrix Rx of the vector process ~X(q). Minimizing L( ~F ) in (14) leads to the
exact value ~FML which has the maximum likelihood. It is important here to emphasize the following : if the vectors
~X are obtained by time-shift over the recorded time series, an observation runs over K + Q
1 samples, i.e. the actual
duration of one observation is Tobs = (Q + K
2)Ts. In this case, the observed vectors may not be considered as being
corrupted by independent realisations of the noise process, as some ’time integration’ is performed in the estimation of
Rx. The consequences and interest of such smoothing have been studied by Clergeot and Tressens20, and Ouamri23,
in the frame of array processing (in this context, ’time integration’ becomes ’spatial smoothing’). In the remainder
of this paper, the development are based on equation (14), no matter how Rx is estimated; see appendix for the
practical implementation.

(14)

−

−

i

Equation (14) is still too complicated to be solved analytically in a simple way. A minimization can be easily
performed if L( ~F ) has a quadratic dependance in S20. Let Ry be the correlation matrix of the signal vectors ~Y (q),
the assumption that signal and noise are independent allow to establish the following equalities

3. Approximate Max-likelihood

ˆRx = Ry + ˆσ2I ,
Ry = SPS+ ,
[ ~A ~A+] ,
P =

E

where

stands for the mathematical expectation. Substituting in equation (14) leads to:

E

i
Clergeot and Tressens20 propose a second order approximation of L( ~F ):

L( ~F ) =

Q
ˆσ2 Tr

Πn( ~F )S ˆPS+
h

.

LAML( ~F ) =

Q
ˆσ2 Tr

ˆΠnS( ~F ) ˆPS+( ~F )
h
i

,

6

(11)

(12)

(13)

(15)

(16)

(17)

(18)

(19)

in which ˆΠn is estimated by computing the projector spanned by the (K
N ) smallest eigenvalues of the estimated
covariance matrix ˆRx. They prove that this approach leads to more reliable estimates of ~F at low signal to noise ratio
(SNR), and that the minimization of LAML is asymptotically eﬃcient. In practice, the following set of equations is
used

−

The approximately quadratic dependence of LAML in S( ~F ), allows a fast convergence of the minimization algorithm

by using a simple Newton-Gauss algorithm:

where k stands for the iteration step in the minimization process, ~grad and H are the gradient and hessian respectively
(see expressions in the appendix).

ˆσ2 =

1

Tr( ˆΠn ˆRx) ,

K
Πs( ~F ) = S( ~F )(S+( ~F ).S( ~F ))−1.S+( ~F ) ,
σ2I).Πs( ~F ) .

S( ~F ). ˆP.S+( ~F ) = Πs( ~F )( ˆRx

M

−

−

~F (k + 1) = ~F (k)

H−1. ~grad(LAML)
~F = ~F (k) ,
|

−

4. Combining new measurements and estimates

In this section, it is assumed that new measurements do not allow by itself the derivation of a good estimate. The
1)−1, whereas integrating new measurements to this estimate

(K + Q

1
variance of such an estimate varies as
Tobs ≃
allow to derive a better estimation.
ˆ~F (t) be an estimate of ~F at time t, and
Let
a linear evolution model is known for ~F (t), one has

N

−

ˆ~F (t), Γ(t)) its density, assumed to be normal with variance Γ(t)28. If
(

~F (t + 1) = M ~F (t) + ε(t) ,
(M ˆ~F (t), MΓ(t)M+ + Rε) ,

pt+1|t( ~F ) =

N

where M is the evolution matrix; ε is a perturbation term, which is statistically independent from ~F , and , Rε is its
covariance matrix. pt+1|t is the probability density function that can be derived for time t + 1, if the observations are
made until time t only. As such an evolution equation is usually unknown, M will be set to the identity matrix in
the rest of the paper (see Michel22) for a detailed discussion). Applying the Bayes rule over conditional probabilities
gives :

Noting that log(pt+1( ~X
previous section, one gets after all reductions and identiﬁcations the simple following expressions

~F )) is the loglikelihood function for which a reduced expression has been derived in the
|

pt+1|t+1( ~F ) =

pt+1|t( ~F ) . pt+1( ~X

~F )
|

.

pt+1( ~X)

Γ(t + 1
Γ(t + 1)−1 = H + Γ(t + 1

ˆ~F (t + 1

ˆ~F (t) ,
t) =
|
t) = Γ(t) + Rε ,
|
t)−1 ,
|
Γ(t + 1)−1. ~grad ,

ˆ~F (t + 1

t + 1) =
|

ˆ~F (t + 1) =

ˆ~F (t + 1

t)
|

−

where it can be shown that the gradient function has the same expression as in the previous section. Rε is an unknown
matrix which will be practically set to v2I, where v2 will be tuned in order to allow the algorithm to take slight changes
in ~F into account. Furthermore, it is interesting that the set of expression above expresses a generalized Kalman
ﬁlter for estimating ~F (in the sense that it relies upon second order expansion of the loglikelihood functions). The
statistical convergence properties and numerical eﬃciency of these approaches are described in the work of Michel &
Clergeot21 and Michel22.

7

(20)

(21)

(22)

(23)

(24)

(25)

(26)

(27)
(28)
(29)

(30)

8

FIG. 3: Experimental setup in the case of the settling sphere.

IV. EXPERIMENTAL RESULTS

We ﬁrst describe the simple case of a particle settling in a ﬂuid at rest.

It is well adapted to the reassigned
spectrogram method because the acoustic signal has a good SNR and a slow frequency modulation. We show that it
allows to extract the subtle interaction between the falling particle and its wake. We then study the more complicated
case of the motion of a particle embedded in a turbulent ﬂow, where the dynamics of motion is much faster and the
SNR is poor. We show that the AML method is well suited.

A. The settling sphere

1. Motivation and experimental setup

When a particle is released in a ﬂuid at rest, its developing motion creates a wake. The particle velocity is then
set by the balance between buoyancy forces and drag, and additional subtle eﬀects: ﬁrst, ‘added mass’ corrections
because the particles ‘pushes’ the ﬂuid, and second, a ‘history’ force because the wake reacts back on the particle.
Formally, one can write the equation of motion as6,8,24:

(mp +

mf )

= (mp

mf )g

πa2ρf

vp

vpcD(Re) + Fhistory

.

−

k

k

1
2

dvp
dt

1
2

−

(31)

where mp is the particle mass, mf is the mass of a ﬂuid particle of the same size, vp is the particle velocity, g is the
acceleration of gravity, a is the sphere radius, ρf is the ﬂuid density, cD is the static empiric drag coeﬃcient, Re is
the Reynolds number Re = 2avp
and Fhistory is the so-called history force. In this expression, the drag coeﬃcient is
ν
usually obtained from measurement of the forces acting on a body at rest in an hydrodynamic tunnel. The history
term, however, is largely unknown. Analytic expression can only be derived in the limit of small Reynolds numbers
(less than 10) and cannot be applied for real ﬂow conﬁgurations (e.g. multiphase ﬂows) where Re

1.

We perform measurements of the motion of a settling sphere, with the aim of evaluating the inﬂuence of the history
forces. We use a water tank of size 1.1 m
0.75 m and depth 0.65 m, ﬁlled with water at rest (ﬁgure 3). The bead is
held by a pair of tweezers, ﬁve centimeters below the transducers. It is released a time t=0 without initial velocity
and its trajectory is about 50 cm long. The data acquisition is started before the bead is released in order to capture
the onset of motion.

×

≫

2. Results

Let us use as a ﬁrst example, the fall of steel bead, 0.8 mm in diameter. The Doppler shift during the bead motion
is detected using the spectrogram representation and a subsequent reassignment scheme. The simple spectrogram
and reassigned version are shown in ﬁgure 4. The reassignment technique drastically improves the localization of the
energy in the time-frequency plane. In this case, the image processing step computes vp(t) as the line of maxima.
The precision of the overall measurement depends on two factors : ﬁrst on the intrinsic precision of the reassignment
method and second on the dispersion of the measurements (the reproducibility of the bead motion over several
experiments). The intrinsic precision of the reassignment method has been empirically studied using synthetic signals
modelling the particle dynamics plus a noise that mimics the experimental data. We observed that for our choice of

9

FIG. 4:
(a) Spectrogram of the backscattered sound, after heterodyne detection. (b) Reassigned spectrogram. In each ﬁgure
the inset shows a normalized cross-section of the spectrogram. The algorithm is that of the tfrrsp function of the MATLAB
time-frequency toolbox25. To get rid of the spectral components at zero frequency due to the coupling between transducers
and at small frequencies around zero due to slow motion of the water surface, we use a high pass ﬁfth order Butterworth ﬁlter
of cut-oﬀ frequency 25 Hz (corresponding to a velocity of 5 mm/s). Data of 0.8 mm steel bead settling in water at rest.

parameters (a time-frequency picture with 256
256 pixels) the rms precision is about one half pixel both in time and
frequency directions. The method thus allows a precise analysis of the dynamics of the fall; we describe below two
sets of experiment that illustrate the potential of the reassignment technique.

×

First, we show in ﬁgure 5 the velocity of a 1 mm steel bead (average over ten falls) together with two numerical
simulations based on equation 31, ﬁrst without the memory force and second with the expression of the memory
force derived at low Reynolds numbers (called the Stokes memory term, as in Maxey & Riley6). The precision of
the detection technique is suﬃcient for the measured proﬁle to be compared to the simulated curves and to draw
physical conclusions about the hydrodynamical forces. At early times, the trajectory is close to the simulation with
memory force. This is due to the diﬀusion away from the bead surface of the vorticity generated at the boundary6,8,24.
However, as the instantaneous Reynolds number increases, the curve deviates from this simple regime: vorticity is
advected into the wake. Memory is progressively lost and the sphere reaches a terminal velocity in a ﬁnite time as
does the simulation without memory.

The measurement and signal processing techniques are then tested on a more non-stationary motion, as in the case
of a bead whose density is close to that of the ﬂuid. In this situation a stronger interaction is expected between the
particle motion and the development of its wake. Formally, this traces back to diﬀerences in the eﬀective inertial mass
and buoyancy mass of the particle – see equation (31). In ﬁgure 6, we show the velocity variation for a light glass
sphere (density 2.48) compared to a tungsten bead (density 14.8). We observe that the velocity of the glass oscillates
before reaching a constant terminal value whereas the other particle has a regular acceleration. In the case of light

10

20

40

60

100

200

300
time ( ms )

400

500

600

FIG. 5: Velocity measurement of a steel bead of diameter 1 mm (solid line), compared to numerical simulations without memory
force (dashed) and with Stokes memory (dash-dotted). The inset shows an enlargement near the onset of motion. The Reynolds
number, based on the limit velocity is 430. The sphere velocity proﬁle results from averaging n = 10 successive experiments.

0.3

0.2

0.1

0

0

0.4

0.3

0.2

0.1

)
 

1
−

s
m

 
(
 

V

p

0

0

1.2

1

0.8

0.6

0.4

0.2

0

0

 V*

100

200

300
time ( ms )

400

500

600

FIG. 6: Fall of a tungsten carbide sphere D=1 mm (dashed) compared to a glass bead D=2 mm (solid), at Re ∼ 400. The
velocity is non-dimensionalized by the limit velocity. Curves are not averaged over several experiments.

beads the hydrodynamic forces may be large enough to overcome the gravity and change the sign of the acceleration
. This is linked with the non-stationarity of the wake, as vortex shedding is known to occur for Reynolds number
above critical (Rec

250).

∼

B. Turbulent ﬂow : Lagrangian velocity measurement

1. Experimental set-up

The turbulent ﬂow is generated in a von K´arm´an geometry : the water is set into motion by two coaxial counter
rotating disk in a cylindrical tank (ﬁgure 7). The Reynolds number Re = 2πR2f
(where ν = 0.8910−6 m2s−1 is the
water kinematic viscosity) is equal to 106. To prevent cavitation in the ﬂow, we boil the water before ﬁlling the tank
by lowering the pressure with a vacuum pump and during the experiment the pressure is increased to two bars. For
the acoustic measurement, we use the same array of transducers as in the previous experiments, at emitting frequency
3 MHz. The cylinder and the surface of the disks are covered by 3 cm of Ciba Ureol 5073A and 6414B. Its density
is 1.1 and the sound velocity is 1460 m.s−1 so that its acoustic impedance is close to that of the water, reducing
drastically the reﬂections at the interface water/ureol compared to water/steel. The attenuation at 2.5 MHz is about
6 dB per cm. With a 3 cm layer and after the reﬂection on steel the total absorption is about 36 dB. The total

ν

11

FIG. 7: Experimental setup. The inner radius of the cylinder is 10 cm (disks radius R=9.5 cm) and the distance between the
disks is 18 cm. The disks are driven by two 1 kW motors at a constant rotation frequency of f =18 Hz. The transducers are
placed 18 cm oﬀ axis, in order to increase the volume of the measurement region.

reﬂection at the interfaces is reduced by a factor 60. The particle is a polypropylene (PP) sphere of radius 1 mm and
density 0.9.

2. Results

We show in ﬁgure 8 the time series when one particle is in the ultrasonic beam and the corresponding spectrogram
and reassigned spectrogram. The signal to noise ratio is very poor, typically less than 6dB (to give an idea, in
ﬁgure 8(a) the bead enters the ultrasonic beam at t
20 ms). One can also see some events localized in the time
frequency plane that may be considered as noise and that may have several origin (noise of the motors, external
electromagnetic noise, cavitation in the ﬂow. . . ). Altogether, the time-frequency pictures show the trajectory of the
particle but the low SNR prevents it from being easily extracted. In particular, the trajectory in the reassigned picture
becomes quite lacunar and extracting it would require sophisticated (and CPU greedy) image processing techniques.
The result of the AML algorithm is plotted in ﬁgure 9. The extracted frequency modulation is of course within the
estimation in the spectrogram as in ﬁgure 8(b), but one observes that ﬁne variations in the velocity of the bead are
now detected. The algorithm provides also an estimate of the amplitude of the source (ﬁgure 9(c)). It can be seen
that there is a strong amplitude modulation and that the SNR is at most 6 dB and may become less than 0 dB.

∼

As the hessian is related to the Fisher information matrix26, its inverse square root is linked with the variance
of the estimation: a large value of the hessian indicates an accurate estimation of the modulation frequency and,
hence, of the bead velocity. The inverse square root of the hessian is plotted in ﬁgure 9(b): very large values are
calculated in the absence of a bead in the measurement volume at the beginning and end of the time series (as a
signature of the mismatch between the model which is composed of one source at least and the reality: no source).
Local lower values (typically less than 0.1) are observed when the variance on the estimation is small. Spurious eﬀects
are generated when the frequency modulation approaches zero as the hessian also becomes very small because of the
ﬁltering operation made in order to get rid of the coupling part of the signal. Finally, one observes that the hessian
decreases as the signal to noise ratio increases (see at time 0.55 s).

V. CONCLUDING REMARKS

As can be seen in the previous section, both methods, time-frequency analysis and parametric spectral analysis are
suited for extracting the time-varying frequency modulation due to a Doppler eﬀect. The domain of application of
each method depends on the degree of non-stationarity and on the SNR.

For high SNR and weakly non-stationary signals, the time-frequency approach yields very good results. One
drawback is the need of a second processing stage to extract the trajectory from the time-frequency picture. This
stage may become increasingly diﬃcult if there is more than one spectral component or if the SNR degrades. In
both cases the quadratic nature of the algorithm produces interference patterns in the image: spurious clusters and

12

0.2

0.4

0.6

0.8

1

time ( s )

0

0.2

0.4

0.6

0.8

1

time ( s )

)
 

V
µ
 
(
 
e
d
u
t
i
l

p
m
a

6

4

2

0

−2

−4

−6

0

)
 
z
H

 
(
 
y
c
n
e
u
q
e
r
f

4000

2000

0

−2000

−4000

)
 
z
H

 
(
 
y
c
n
e
u
q
e
r
f

4000

2000

0

−2000

−4000

0

0.2

0.4

0.6

0.8

1

time ( s )

FIG. 8: Sound scattered by a 2 mm diameter PP bead in a turbulent ﬂow at Re = 106. (a) Typical time series; (b) and (c)
corresponding spectrogram and reassigned spectrogram.

13

0

0.2

0.4

0.6

0.8

1

time ( s )

0.2

0.4

0.6

0.8

1

time ( s )

)
 

1
−

s
.
m

 
(
 
y
t
i
c
o
e
v

l

0.5

1

0

−0.5

2

/

1
−

i

n
e
s
s
e
h

0.5

0.4

0.3

0.2

0.1

0

0

)
 

V
µ
 
(
 

e
d
u

t
i
l

p
m
a

5

4

3

2

1

0

0

0.2

0.4

0.6

0.8

1

time ( s )

FIG. 9: Velocity measurement for the motion of a 2 mm diameter PP bead in a turbulent ﬂow at Re = 106. Output of the
AML algorithm: (a) velocity (b) corresponding inverse square root of the hessian, (c) amplitude of the source (the rms value
of the noise is 0.9µV). AML algorithm parameters: M=1, K=7, Q=13, v2=10

−5.

a lacunar trajectory result. Another, more fundamental, limitation is that the length of the time window must be
long enough to preserve an acceptable frequency resolution, even with the reassigned spectrogram. This limits the
methods to weakly non-stationary signals.

For signals with a rapid frequency modulation, the AML spectral estimation is well suited, as long as the noise is
near iid. The size of the time window can be decreased because of the parametric nature of the method, since a priori
knowledge has been taken into account. The performance is further increased by the use of a Kalman-like ﬁlter. The
drawback is the necessity to ﬁnd a good dynamical model for the evolution of the spectral components. We have
chosen here the simplest model which works well for our experiments but the approach can be reﬁned by increasing
the number of parameters in order to consider more precisely the variation of the frequency. The AML algorithm also
provides a quantitative estimation of the quality of the demodulation and the instantaneous power of the spectral
component. Finally, the AML method has the advantage to provide directly frequency modulation as a function of
time, in one stage.

Acknowledgments

We are indebted to Pascal Metz for the development of the signal conditioning electronics. We thank Marc Moulin
for his help in the design of the von K´arm´an setup, VERMON for continuous assistance in the development of the
transducer array. This work is partially supported by ACI grant No. 2226.

with

•

•

•

•

First step : calculate ˆRx using the following expression22 :

AML ALGORITHM

ˆRx =

1
2Q

t+Q

i=t+1 (cid:16)
X

~X(i) ~X(i)T +

˜~X(i)

˜~X(i)T

,

(cid:17)

˜~X(i) = [x(i + K

1), x(i + K

2), . . . , x(i)]∗T ,

−

−

where ∗ stands for complex conjugate.

˜~X is the complex conjugate of the time reversed version of ~X.

Second step : diagonalize ˆRx; one obtains the eigenvectors (~Vi)i=1..K and eigenvalues (λi)i=1..K sorted in
decreasing order.

Third step : Compute ˆΠn and ˆσ2, using the set of equations

Forth step : choose ~F =

ˆ~F (t) as candidate value. Compute ~grad and H using21

ˆσ2 =

Tr( ˆΠn ˆRx) =

1

−

K

M

K

ˆΠn =

~Vi ~V T
i

,

i=M+1
X

K

1

−

K

M

λi .

i=M+1
X

~grad =

2Q
σ2 Re

n

Diag(S′+( ~F ).Πn( ~F ). ˆΠn.S( ~F ). ˆP)

H =

2Q
σ2 Re

Diag

(S′+( ~F ).Πn( ~F ). ˆΠn.Πn( ~F ).S′)
(cid:17)
(cid:16)

n

,

,

o
∗
⋆ ˆP

o

S′ = [

, . . . ,

d~S1
df1

d~SM
dfM

]T .

where the operator ⋆ stand for the term to term matrix multiplication, and P∗ is the conjugate of P, and

14

(32)

(33)

(34)

(35)

(36)

(37)

(38)

Fifth step : using equations (27) to (30), compute

ˆ~F (t + 1) and Γ(t + 1).

•
The initialization of the algorithm is done by either (i) setting an initial value of ~F (1) or (ii) estimating this value
using the maxima of the amplitude of the FFT of a small window of signal (of length 64 or 128 samples) and using
the iterative algorithm described in section III B 3 to converge towards ~F (1).

For example, the extracted velocity of ﬁgure 9 is obtained by starting at the maximum of energy of the signal and
applying the algorithm forward and backward in time. The algorithm is stopped as the mean of the inverse square
root of the hessian over a window of size 400 samples exceeds 0.5 for more than 400 samples.

15

e-mail : pinton@ens-lyon.fr

∗
1 G. O. Fountain, D. V. Khakhar, I. Mezic, and J. M. Ottino, “Chaotic mixing in a bounded 3D ﬂow”, J. Fluid Mech. 417

2 P. K. Yeung and S. B. Pope, “Lagrangian statistics from direct numerical simulations of isotropic turbulence”, J. Fluid

(2000).

Mech. 207, 531 (1989).

3 K. D. Squires and J. K. Eaton, “Lagrangian and eulerian statistics obtained from direct numerical simulation of homogeneous

turbulence”, Phys. Fluids A3, 130 (1991).

4 P. K. Yeung, “Direct numerical simulation of two-particle relative diﬀusion in isotropic turbulence”, Phys. Fluids 6(10),

5 P. K. Yeung, “One- and two-particle lagrangian acceleration correlations in numerically simulated homogeneous turbulence”,

Phys. Fluids 9(10), 2981 (1997).

6 M. R. Maxey and J. J. Riley, “Equation of motion for a small rigid sphere in a nonuniform ﬂow”, Phys. Fluids 26, 883

3416 (1994).

(1983).

7 G. Sridhar and J. Katz, “Drag and lift forces on microscopic bubbles entrained by a vortex”, Phys. ﬂuids 7, 389 (1995).
8 N. Mordant and J.-F. Pinton, “Velocity measurement of a settling sphere”, Eur. Phys. J. B, in press (2000).
9 M. Virant and T. Dracos, “3D PTV and its application on lagrangian motion”, Meas. Sci. Technol. 8, 1539 (1997).
10 G. A. Voth, K. Satyanarayan, and E. Bodenschatz, “Lagrangian acceleration measurements at large Reynolds numbers”,

Phys. Fluids 10(9), 2268 (1998).

Syst. 23(1), 77 (1999).

11 O. F. Bay and I. G¨uler, “Tissue blood ﬂow assessment of pulsed Doppler ultrasound using autoregressive modeling”, J. Med.

12 P. Flandrin, Time-Frequency / Time Scale analysis, vol. 10 of Wavelet analysis and its application (Academic Press, 1998).
13 L. Cohen, Time-Frequency analysis (A. V. Oppenheim Ed., Prentice Hall, 1995).
14 G. Gaunard and H. Uberall, “RST analysis of monostatic and bistatic acoustic echoes from an elastic sphere”, J. Acous.

Soc. Am. 73(1), 1 (1983).

15 P. D. Thorne, T. J. Brudner, and K. R. Waters, “Time-domain and frequency-domain analysis of acoustic scattering by

spheres”, J. Acoust. Soc. Am. 95(5), 2478 (1994).

16 B. T. Hefner and P. L. Marston, “Backscattering enhancements associated with subsonic Rayleigh waves on polymer spheres

in water : observation and modeling for acrylic spheres”, J. Acoust. Soc. Am. 107(4), 1930 (2000).

17 R. Gendrin and C. de Villedary, “Anambiguous determination of ﬁne structures in multicomponents time-varying signals”,

Ann. Telecom. 35(3–4), 122 (1979).

18 F. Auger and P. Flandrin, “Improving the readability of time-frequency and time-scale representations by the reassignment

method”, IEEE Trans. on Signal Processing 43, 1068 (1995).

19 S. Kay, Modern Spectral Estimation, Theory and Application, Prentice Hall Signal Processing Series (A. V. Oppenheim Ed.,

Prentice Hall, 1988).

20 H. Clergeot and S. Tressens, “Comparison of two eﬃcient algorithms for HR source tracking: time recursive implementation.”,

in ICASSP’90, Albuquerque, USA (1990).

21 O. Michel and H. Clergeot, “Multiple source tracking using a high resolution method”, in ICASSP’91, Toronto, Canada

22 O. Michel, Application des m´ethodes haute r´esolution `a la localisation et la poursuite de sources sonores, Ph.D. thesis,

(1991), pp. 1277–1280.

Universit´e Paris XI, Orsay (1991).

23 A. Ouamri, Etude des performances des m´ethodes d’identiﬁcation `a haute r´esolution et application `a l’identiﬁcation des ´echos

par une antenne lin´eaire multicapteurs, Ph.D. thesis, Universit´e Paris-Sud, Orsay (1986).

24 C. J. Lawrence and R. Mei, “Long-time behaviour of the drag on a body in impulsive motion”, J. Fluid Mech. 283, 307

25 Trademark, The Mathworks Company. The time-frequency toolbox can be downloaded at http://crttsn.univ-

(1995).

nantes.fr/˜auger/tftbftp.html.

26 L. Scharf, Statistical signal processing; detection, estimation and time series analysis (Addison-Wesley, 1991).
27 It is straightforward to establish that Πs ~Y = ~Y for any vector ~Y lying in the signal subspace. Here ‘parametric projector’

must be understood as the projector calculated for the vector of frequencies ~F

28 This is generally not the case, but this assumption remains valid as long as the loglikelihood is well approximated by its

second order expansion around

ˆ~F .

16

