7
9
9
1
 
y
a
M
 
5
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
6
3
0
5
0
7
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

A two-dimensional network simulator for two-phase
ﬂow in porous media

Eyvind Aker∗, Knut Jørgen M˚aløy
Department of Physics
University of Oslo, N-0316 Oslo, Norway

Alex Hansen∗
Department of Physics, Norwegian University of Science
and Technology, N-7034 Trondheim, Norway

G. George Batrouni
Institut Non-Lin´eaire de Nice,
Universit´e de Nice - Sophia Antipolis, 06560 Valbonne, France

February 2, 2008

Abstract

We investigate a two-dimensional network simulator capable of
modeling diﬀerent time dependencies in two-phase drainage displace-
ments. In particular, we focus on the temporal evolution of the pres-
sure due to capillary and viscous forces and the time dependence of
the interface between the two liquids. The dynamics of the capillary
eﬀect are taken into account and we report on high accuracy pressure
measurements. Moreover, the simulator includes important features in
drainage, like burst dynamics of the invading ﬂuid and simultaneous
ﬂow of two liquids in a section of a tube. The validity of the model is
checked by comparing simulation results with well known experimental
properties in drainage displacement.

∗Also at: IKU Petroleum Research, N-7034 Trondheim, Norway

1

1

Introduction

Two-phase displacements in porous media have been much studied over the
last two decades. The main reason for this is the great variety of structures
observed when changing the physical parameters of the ﬂuids like viscos-
ity contrast, wettability, interfacial tension and displacement rate. Besides
being a process of great interest in modern physics, it has a large num-
ber of practical applications in many ﬁelds of science like oil recovery and
hydrology.

The main purpose of this paper is to present a network simulator mod-
eling immiscible two-phase ﬂow on a two-dimensional lattice of cylindrical
tubes. Primarily, the model is developed to measure the time dependence
of diﬀerent physical properties and to study the dynamics of the ﬂuid move-
ments. We focus on drainage displacements, i.e. the process where a non-
wetting ﬂuid displaces a wetting ﬂuid in a porous medium. In particular, we
report on the dynamics of the temporal evolution of the pressure due to cap-
illary and viscous forces and the time dependence of the interface between
the two liquids.

The diﬀerent structures between the invading and the defending ﬂuids
obtained in drainage divide into three major ﬂow regimes: viscous ﬁnger-
ing [4, 16], stable displacement [13] and capillary ﬁngering [15]. There exist
statistical models like DLA [22], anti-DLA [18] and invasion percolation [21]
that reproduce the basic domains in viscous ﬁngering, stable displacement
and capillary ﬁngering respectively. However, these models do not contain
any physical time for the front evolution and the they cannot describe the
crossover between the major ﬂow regimes.

To overcome the limitations of the statistical models several network
simulators similar to the one presented in this paper, have been developed
over the last two decades [2,4–6,11–13]. The diﬀerent models are more or less
simpliﬁed to avoid computational complications, and diﬃculties most often
arise when the capillary eﬀects are taken into account. Lenormand et al.
(1988) assigned each tube a threshold pressure and allowed the injecting non-
wetting ﬂuid to enter the tube only when the pressure exceeded the threshold
value of that tube. Moreover, the non-wetting ﬂuid was restricted to ﬂow in
the positive direction relative to the direction of the displacement. Dias and
Payatakes (1986) suggested a more realistic approximation by introducing
tubes with walls with a sinusoidal proﬁle. They let the capillary pressure of
the meniscus change as the menisci invaded the tubes.

Similar to the idea of Dias and Payatakes (1986) the model reported here

2

takes into account the capillary eﬀects by letting the capillary pressure of
the meniscus depend on its position inside the tube. Moreover, the menisci
can both invade into or retreat from a tube. This is an important property
in slow drainage, where the invading ﬂuid is found to suddenly invade a
larger region causing another part to retire (bursts) [10,14,17]. Experiments
performed by M˚aløy et al. (1992) have also produced evidence that the bursts
are characterized by large pressure ﬂuctuations (Haines jumps). To measure
these pressure ﬂuctuations the ﬂow ﬁeld in our network simulator is solved
for a constant injection rate rather than a constant pressure.

In the present model an approximation is developed to model a mixture
of the wetting and non-wetting ﬂuids when they ﬂow simultaneously in a
cross section of a tube. Such mixing is an important process in both drainage
and imbibition [7, 14] and should not be neglected. The piston-like motion
characterizing slow drainage is well described, but additional mechanisms
observed in imbibition [3, 14] is not taken into account.

The paper is organized as follows. Section 2 describes the porous medium
model used in the network simulator. Section 3 gives the solution of the
ﬂow ﬁeld with the constraint of a constant injection rate, and Section 4
describes the algorithm for updating the menisci. In Section 5 we discuss
how to move the menisci into neighboring tubes and allow mixing of the
two liquids. Finally, in Section 6 we give some simulation result focusing on
calibrations of the model. At the end some conclusions are discussed.

2 The Porous Medium Model

2.1 Geometry of Model Porous Medium

The porous medium is represented by a square lattice of tubes inclined 45
degrees. Thus, if all tubes are equal and a uniform pressure across the
lattice is applied, a liquid ﬂows equally well in tubes inclined to the left
as tubes inclined to the right. The tubes are connected together at nodes,
where four tubes meet. There is no volume assigned to the nodes: the
tubes represent the volume of both pores and throats. The liquids ﬂow
from the bottom to the top of the lattice and periodic boundary conditions
are applied horizontally. The pressure diﬀerence between the ﬁrst (bottom
of system) and the last (top) rows deﬁnes the pressure across the lattice.
Gravity eﬀects are neglected, and as a consequence we consider a horizontal
ﬂow in a two-dimensional network of tubes. See ﬁgure 1 for details.

The tubes are cylindrical with equal length d, and every tube is assigned a

3

radius r which is chosen at random in the interval [λ1, λ2]d. The randomness
of the radii represent the disorder of an ordinary porous medium and λ1 and
λ2 deﬁne the width of the distribution of radii.

Initially, the system is ﬁlled with a defending ﬂuid with viscosity µ1.
The invading ﬂuid with viscosity µ2 is injected from the bottom row with a
constant injection rate. Here we report on the study of drainage displace-
ments, and so let the invading ﬂuid be non-wetting and the defending ﬂuid
be wetting. We assume that the ﬂuids are immiscible and that there is a well
deﬁned interface between the two phases. The curvature of this interface
gives rise to a capillary pressure given by the interfacial tension γ. Moreover,
we will treat the liquids as incompressible, i.e. the volume ﬂux ﬂowing into
the system must equal the volume ﬂux ﬂowing out of the system.

2.2 Capillary Flow in a tube

Consider a tube containing a meniscus between nodes i and j in the network
as shown in ﬁgure 2. The volume ﬂux qij through the tube from the ith to
the jth node is found from the Washburn equation for capillary ﬂow [20]:

qij = −

·

(∆pij − pc) .

(1)

πr2
ijkij
µef f

1
d

Here kij = r2
ij/8 is the permeability, µef f = µ2xij +µ1(1−xij) is the eﬀective
viscosity due to the two ﬂuids, ∆pij = pj − pi is the pressure diﬀerence
between the ith and jth node and pc = p1 −p2 deﬁnes the capillary pressure.
xij is the position of the meniscus in the tube and rij is the radius of the
tube. The position of the meniscus is a continuous function in the range [0, 1]
and the ﬂow direction is given by the sign of qij: When qij > 0 the ﬂuids in
the tube ﬂow to the right, otherwise they ﬂow to the left. As mentioned in
the introduction, it is important to allow ﬂow in both directions in order to
study the dynamics when the menisci invade into or retreat from a tube.

For a tube without a meniscus present pc = 0, and equation (1) reduces

to that describing Hagen-Poiseulle ﬂow.

The capillary pressure pc due to the meniscus is given by the Young-
Laplace law. Let θ refer to the wetting angle between the non-wetting and
wetting phases as shown in ﬁgure 2. Then

pc =

cos θ ,

(2)

2γ
r

4

where r/ cos θ is the principal radius of curvature of the meniscus. γ denotes
the interfacial tension between the two phases.

Equation (2) is derived under the assumption that the ﬂuids are in static
equilibrium, i.e. ∆pij = pc. A more detailed description of the dynamics of
a moving interface is still an open problem [8]. However, at low ﬂow rates
when no mixing or turbulence occur, we consider the above expression as a
reasonable approximation.

A real porous medium consists of a complex network of throats and
pores with a great variety of shapes. The curvature of a meniscus traveling
in this network, becomes a continuous function depending on the meniscus’
position. The variation in curvature results in local changes in the capillary
pressure. Equation (2) does not take this eﬀect into account, since the
capillary pressure is assumed constant for each tube. Instead, we apply a
dependency in pc as a function of the menisci’s position inside each tube.
Thus, we deﬁne the capillary pressure pc as (without index notations):

pc =

[1 − cos(2πx)] ,

(3)

2γ
r

where we have assumed perfect wetting (θ = 0).
In the above formula r
denotes the radius of the actual tube and x is the position of the meniscus
in that tube. The function is plotted in ﬁgure 3. The deﬁnition sets the
capillary pressure equal to zero at the ends of the tube whereas pc becomes
equal to the threshold pressure pt when the meniscus is in the middle of
the tube, i.e. pt = 4γ/r. The threshold pressure is the minimum capillary
pressure required to let the non-wetting ﬂuid invade the tube.

3 Solving the Flow Field

The ﬂuids are assumed incompressible leading to conservation of volume
ﬂux at each node:

qij = 0 .

j
X

(4)

Here qij denotes the ﬂow trough a tube connecting node i and j. Equa-
tion (4) is simply Kirchhoﬀ’s equation and in the summation j runs over
the nearest neighbor nodes to the ith node. The index i runs over all nodes
that do not belong to the top or bottom rows, that is, the internal nodes.
This set of linear equations are to be solved with the constraint that the
pressures at the nodes belonging to the upper and lower rows are kept ﬁxed.

5

By inserting equation (1) in equation (4) we get:

Gij(pj − pi − pc) = 0 ,

(5)

Xj

where Gij deﬁnes the mobility of the tube, i.e. Gij ≡ πr2
In
order to write this set of equations as a matrix equation, we move all the
capillary pressures and the ﬁxed pressure referring to the nodes belonging
to the upper and lower rows to the right-hand side of equation (5). The
ﬁnal matrix equation may then be written as

ijkij/µef f .

Dijpj = Bi ,

j
X

where the indices i and j only run over internal nodes. Dij are elements
a conductance matrix D [1] where the elements depend on the connection
between diﬀerent tubes and their respective mobility. pj are the elements
in the pressure vector, containing the pressure at the internal nodes and
Bi contains the pressure at the boundaries (upper and lower rows) and the
capillary pressure if a meniscus is present in the tube.

We are seeking the solution of the pressure at the internal nodes for a

given conﬁguration of the menisci, i.e

(6)

(7)

pj =

(D

−1)ijBi .

Xi

This equation is solved by using the Conjugate Gradient method
[1].

3.1 Solving for a Constant Injection Rate

The pressures solved by equation (7) correspond to keeping the applied pres-
sure diﬀerence across the network constant. We want to study the dynamics
of the pressure ﬂuctuations at a constant displacement rate. Thus, we need
to ﬁnd the pressures pj under constant injection rate of the invading ﬂuid.
For two-phase displacement in a porous medium the injection rate Q is

given by

Q = A∆P + B .

(8)

Here ∆P is the pressure across the lattice and A and B are parameters
depending on the geometry of the medium and the current conﬁguration of
the liquids. The ﬁrst part of equation (8) is simply Darcy’s law for one phase

6

∆P =

Q − B
A

.

′

Q
′′

Q

′

′′

= A∆P

+ B ,

= A∆P

+ B .

qij = aij∆pij + bij ,

ﬂow through a porous medium. The last part B results from the capillary
pressure between the two phases. As long as the menisci are kept at ﬁxed
positions B becomes a constant.

The pressure across the lattice for a given injection rate is

The parameters A and B are calculated by solving the pressure ﬁeld (7)
applied across the lattice. The
for two diﬀerent pressure ∆P
′′
obtained pressure vectors give the corresponding injection rates, Q
.
We are now in the position to calculate A and B by solving the set

and ∆P

and Q

′′

′

′

The next step is to relate the internal pressures at the nodes to the
constant injection rate. From equation (1) we can write the ﬂow rate qij
from node i to node j like

where aij and bij are parameters depending on the permeability of the tube,
the eﬀective viscosity and the capillary pressure due to a meniscus. From
equation (9) the pressure ∆P for a given Q is found. Thus, we could proceed
by solving Kirchhoﬀ’s equation with the constraint of applying this pressure
at the inlet. That would give the correct ﬂow rates in each tube for the
desired Q. However, the following method will save a third solution of
equation (7).

All the equations involved in the calculations are linear, i.e. they have
the functional form f (x) = ax + b. As a consequence the pressure ∆pij
between node i and j becomes a linear function of the pressure ∆P across
the lattice:

∆pij = Γij∆P + Πij ,

Here are Γij and Πij parameters depending on the conﬁguration of the ﬂuids.
By inserting this into equation (12) and redeﬁne aij’s and bij’s we obtain

The parameters ˜aij and ˜bij are found from the ﬂow rates q′
responding to the two pressures ∆P

ij cor-
respectively. Note that the

ij and q′′

and ∆P

′′

′

qij = ˜aij∆P + ˜bij .

7

(9)

(10)

(11)

(12)

(13)

(14)

parameters A and B in (8) and ˜aij and ˜bij in (14) all depend on the current
position of the menisci and we therefore need to solve them for every new
ﬂuid conﬁguration.

The solution due to a constant injection rate can now be summarized
into two steps: (a) After we have found A and B we use equation (9) to get
∆P for the desired Q. (b) This ∆P is then used in equation (14) to get the
local ﬂow qij.

The validity of equation (13) is easily checked by solving Kirchhoﬀ’s
equation for the calculated pressure ∆P and compare the solution with the
one given from equation (14). Numerical results show excellent agreement
between these two solutions.

4 Updating the Menisci

A time step ∆t is chosen such that every meniscus is allowed to travel at
most a maximum step length ∆xmax during that time step. This leads to
the formula

∆t = min

ij "

∆xmax
vij

#

,

(15)

where vij = qij/πr2
ij denotes the ﬂow velocity in a tube containing a meniscus
between the ith and the jth node. The time step becomes dependent on the
local velocity. This method is sometimes called event driven updating.

During the time step it is checked whether or not a meniscus crosses
the middle or the end of a tube. If this happens, the time step is redeﬁned
such that only one meniscus reaches the end or the middle of the tube. A
meniscus reaching the end of a tube is moved into the neighbor tubes (see
section 5).

In the middle of the tube the capillary pressure becomes equal to the
threshold pressure. At this point, the menisci in slow drainage are found
to become unstable and suddenly invade the tube like a burst [10, 14, 17].
Often a cascade of bursts are released in rapid succession around the original
instability, before a new stable position is reached. Moreover, the bursts are
characterized by large pressure ﬂuctuations [17]. It is important to detect
the order in which the instabilities occur to ensure that the right path of
least resistance is chosen. This is done by adjusting the time step when a
meniscus approaches the middle of a tube such that the exact occurrence of
the burst is detected.

8

The new positions of the menisci are calculated by using a second order
Runge-Kutta scheme [19]. Numerical analysis from the present model shows
that this scheme produces more stable solutions than the less accurate and
more unstable Euler scheme. However, with an event driven time step as
deﬁned in equation (15), the implementation of the second order Runge-
Kutta scheme is not straight forward. Before discussing our modiﬁcations,
we ﬁrst remind the reader of the Runge-Kutta scheme.

Let xn denote the position of a meniscus at time tn and let the next
position at time tn+1 = tn + ∆t be xn+1 where ∆t is the time step found
from (15). The second order Runge-Kutta scheme then becomes [19]

xn+1 = xn + k2 + O(∆t3) ,

k1 = ∆t · v(tn, xn) ,
k2 = ∆t · v(tn + 1

2 ∆t, xn + 1

2 k1) ,

(16)

(17)

(18)

where v(tn, xn) denotes the local ﬂow rate in each tube and v(tn + 1
1
2 k1) ≡ vmid(tn, xn) deﬁnes the midpoint velocity.

2 ∆t, xn +

Note that the velocities deﬁning the time step in equation (15) corre-
spond to the derivative of the curve xn at the starting point of each time
interval. I.e. v(tn, xn) = vij, where the subscript ij is omitted on the left
hand side of the equality. When the menisci are updated by using the ve-
locities v(tn, xn), equation (15) leads to the condition

|xn+1 − xn| ≤ ∆xmax ,

(19)

for all the menisci. In the second order Runge-Kutta scheme the next po-
sition xn+1 is found by using the midpoint velocity vmid(tn, xn), which in
general diﬀers from v(tn, xn). As a consequence, condition (19) may no
longer be valid and the displacement length or the stability of the numerical
solution, are no longer controlled. Assume that the position of the menisci is
a smooth function of time, the eﬀect vanishes since vmid(tn, xn) ≃ v(tn, xn).
Moreover, there is no problem as long as vmid(tn, xn) ≤ v(tn, xn). The prob-
lem arises when vmid(tn, xn) ≫ v(tn, xn) and the ﬁnal displacement becomes
much larger than ∆xmax. To avoid this scenario the time step is redeﬁned
by inserting the midpoint velocities in equation (15). A new midpoint veloc-
ity corresponding to the redeﬁned time step is calculated and the positions
are updated according to this time step by using the new midpoint velocity.
The procedure is repeated until the displacements become close enough to
the maximum step length ∆xmax. Typically, the ﬁnal displacement must

9

not be larger than about 10% increase of ∆xmax. Otherwise, the numerical
solution may diverge.

5 Motion of the Menisci at the Nodes

A tube partially ﬁlled with one of the liquids is allowed to have either one or
two menisci leading to four diﬀerent arrangements as shown in ﬁgure 5. The
menisci can be situated at any position inside the tube and the correspond-
ing eﬀective viscosity and capillary pressure are calculated. The eﬀective
viscosity becomes the sum of the fraction of the wetting and non-wetting
ﬂuid inside the tube multiplied with their respective viscosities. The abso-
lute value of the capillary pressure is given by equation (3), while its sign
depends on whether the meniscus is pointing upwards like in ﬁgure 4 (a) or
downwards like in ﬁgure 4 (b). The menisci are updated according to the
determined time step ∆t from the previous section, and their respective ﬂow
rates vij. The total time lapse is recorded before the ﬂow ﬁeld is solved for
the new ﬂuid conﬁguration. Note that due to the incompressibility of the
liquids the two menisci within the same tube in ﬁgure 4 (c) and (d) always
move with equal velocities. Thus, the volumes of the wetting in (c) or the
non-wetting in (d) are conserved.

When a meniscus reaches the end of a tube it is moved into the neighbor
tubes according to some deﬁned rules. These rules take care of the diﬀerent
ﬂuid arrangements that can appear around the node. Basically, the non-
wetting ﬂuid can either invade into or retreat from the neighbor tubes as
In 5 (a) the non-wetting ﬂuid
shown in ﬁgure 5 (a) and (b) respectively.
approaches the node from below (drainage). When the meniscus has reached
the end of the tube (position 1), it is removed and three new menisci are
created at position δ in the neighbor tubes (position 2). The distance δ is
about 1–5% of the tube length d and it deﬁnes the node region where the
capillary pressure is zero. The node region avoids that the created menisci
at position 2 immediately disappear and move back to the initial position 1
in tubes where the ﬂow direction is opposite to the direction of the invading
ﬂuid. The node region has also an important role that allows mixing of the
liquids (see below).

Figure 5 (b) shows the opposite case when the non-wetting ﬂuid retreats
into a single tube (imbibition). As ﬁgure 5 shows the properties of imbibition
should not be neglected as long as the menisci can travel in both directions.
However, in drainage which is what we are focusing on, arrangement (b) will

10

appear rarely compared to (a).

When the menisci are moved a distance δ into the neighbor tubes the
total time lapse is adjusted due to the injection rate of the invading ﬂuid.
The adjustment is calibrated such that the amount of the invading ﬂuid in
the lattice always equals the injected volume. The injected volume is the
product of the time lapse and the injection rate.

Diﬃculties arise when we want to create a new meniscus in a tube that
already contains two menisci. To allow such movement the two original
menisci and the new meniscus are merged into one by the following method.
Consider a scenario like ﬁgure 5 (a) but assume now that the leftmost tube
already contains a bubble of non-wetting ﬂuid as shown in ﬁgure 6 (a). To
merge the three menisci in the leftmost tube into one, we move the wetting
ﬂuid between position 2 and 3 to the left side of the non-wetting bubble and
remove the menisci at position 2 and 3 before the meniscus at position 4 is
moved to the right a distance equal to the original length between position
2 and 3 (ﬁgure 6 (b)). The same principles apply when the non-wetting ﬂuid
retreat into a tube that already contains a bubble of wetting ﬂuid.

5.1 Mixing of the Fluids

The moving rules described in ﬁgure 5 and 6 solve the problem of modeling
a “mixture” of the two liquids. Consider the situations shown in ﬁgure 7
where both the non-wetting and wetting ﬂuids ﬂow toward the node from the
bottom and right tube respectively. Physically, it is expected that the ﬂuid
ﬂowing out of the node is a mixture of both liquids. It is observed [7, 14]
that such simultaneous ﬂow of both liquids in a tube takes place in so-
called funicular continuous ﬂow or a discontinuous dispersed ﬂow. In the
former case the wetting phase ﬂows along the cylinder wall surrounding
the non-wetting phase, which occupies the central portion of the tube. A
discontinuous ﬂow is characterized by a dispersed non-wetting phase ﬂowing
as isolated droplets in a continuous wetting phase.

A model describing funicular and dispersed ﬂow would be too compli-
cated. Instead, we assume that the simultaneous ﬂow can be represented by
a ﬁnite number of small bubbles of each liquid, placed next to each other
inside the tube. By sorting the bubbles of same type of ﬂuid they can be
replaced by one or two menisci. The procedure is illustrated with an ex-
ample in ﬁgure 7: When the meniscus in the bottom tube reaches the end
of the tube it moves a distance δ into the neighbor tubes (arrangements
a and b). Due to the opposite ﬂow direction in the right tube the created

11

meniscus in this tube ﬂows back to the node (arrangement c) and moves into
the neighbor tubes (arrangement d). Now, the new meniscus in the bottom
tube again approaches the node from below (arrangement e) and creates a
conﬁguration with three menisci in the top and left tubes (arrangement f).
To avoid that the number of menisci inside a single tube increases unchecked
the three menisci at the top and the left tube are reduced to one by placing
the wetting ﬂuid on the top of the non-wetting one (arrangement g).

The reorganization when three menisci are reduced to one (ﬁgure 6 and 7)
results in unphysical jumps in the capillary pressure. Due to the small size of
the bubbles, the jumps usually appear as perturbations in the total pressure.
A small number of such jumps will not aﬀect the numerical solution very
much. But, the moment they become more dominant the numerical solution
may become unstable and diverge. We discuss this below.

6 Calibration of the Network Model

We present three diﬀerent calibration simulations, one in each of the regimes
of interest: viscous ﬁngering, stable displacement and capillary ﬁngering.
The simulations are executed on a Cray T90 vector machine. The Con-
jugate Gradient method solving Kirchhoﬀ’s equations, is easy to vectorize
and achieves high performance eﬃciency on vector machines. However, the
amount of time required increases dramatically with the size of the lattice.
For a lattice consisting of N tubes, the Conjugate Gradient method needs
approximately N 2 iterations each time step to solve Kirchhoﬀ’s equations.
Doubling the size of the lattice quadruples N , hence, the computation time
increases by a factor of 16. In addition the number of the time steps before
the invading ﬂuid reaches the outlet strongly aﬀects the CPU-time.

In two-phase ﬂuid displacement there are mainly three types of forces:
viscous forces in the invading ﬂuid, viscous forces in the defending ﬂuid
and capillary forces due to the interface between them. This leads to two
dimensionless numbers that can characterize the ﬂow in porous media: the
capillary number Ca and the viscosity ratio M .

The capillary number is a quantity describing the competition between

capillary and viscous forces. It is deﬁned as

where Q (cm2/s) denotes the injection rate, µ (Poise) is the maximum vis-
cosity of the two ﬂuids , Σ (cm2) is the cross section of the inlet and γ

(20)

Ca =

Qµ
Σγ

,

12

(dyn/cm) is the interfacial tension between the two phases. Σ is the prod-
uct of the length of the inlet and the mean thickness of the lattice due to
the average radius of the tubes.

M deﬁnes the ratio of the viscosities of the two ﬂuids and is given by

the invading viscosity µ2 divided with the defending viscosity µ1:

M =

µ2
µ1

.

The three simulations are performed with parameters as close as possible
to the corresponding experiments done by M˚aløy et al. (1985) and Frette et
al. (1997). In light of that, the length d of all tubes in the lattices are set
equal to 1 mm. Furthermore, the radii r of the tubes are chosen randomly in
the interval 0.05d ≤ r ≤ d. The interfacial tension is set to γ = 30 dyn/cm
and the viscosities of the defending and the invading ﬂuids varies between
0.01 P (≃ water) and 10 P (≃ glycerol).

6.1 Viscous Fingering

Figure 8 shows the result of a simulation in the regime of viscous ﬁnger-
ing performed on a lattice of 60 × 80 nodes. The corresponding pressure
across the lattice as a function of time is shown in ﬁgure 9. The simu-
lation is stopped at breakthrough of the invading non-wetting ﬂuid. The
displacements are done with a high injection rate, Q = 1.5 ml/min and the
invading ﬂuid is less viscous than the defending wetting ﬂuid, µ2 = 0.010 P
and µ1 = 10 P. The capillary number and the viscosity ratio becomes
Ca = 4.6 · 10−3 and M = 1.0 · 10−3 respectively.

In viscous ﬁngering the principal force is due to the viscous forces in
the defending ﬂuid and the capillary forces at the menisci are less dominant.
The pattern formation (ﬁgure 8) shows that the invading ﬂuid creates typical
ﬁngers into the defending ﬂuid.

The pressure across the lattice (ﬁgure 9) decreases as the less viscous
ﬂuid invades the system. Roughly, the pressure appears to decrease linearly
as a function of time. However, the slope is non-trivial and results from the
fractal development of the ﬁngers. In addition to the fractal growth, the
rate of change in the pressure depends on the viscosity contrast M between
the two phases. The rapid decrease at the end of the pressure function
corresponds to the breakthrough of the invading ﬂuid at the outlet.

Figure 9 shows that there are small ﬂuctuations in the average decreas-
ing pressure function. The ﬂuctuations correspond to the changes in the

13

capillary pressure as a meniscus invades into or retreats from a tube. The
ﬂuctuations are small compared to the total pressure and thus the capillary
pressure cannot aﬀect the result very much.

In addition to containing important physics, the pressure function in
ﬁgure 9 is used to establish the stability and convergence properties of the
numerical solution. For all simulations it is veriﬁed that this function con-
verges towards a unique solution when ∆xmax ≤ 0.1d and the menisci are
updated according to the second order Runge-Kutta method as described in
section 4. That means Kirchhoﬀ’s equation must be solved approximately
10–20 times to let a meniscus pass through a single tube. This is proba-
bly what we can expect when we want to measure the ﬂuctuations in the
pressure due to local capillary changes inside the tubes. With larger step
lengths the variations in the capillary pressure are lost and the solution is
no longer suitable for our measurements.

6.2 Stable Displacement

Figure 10 shows the result of a simulation performed in the regime of stable
displacement on a lattice of 60×60 nodes. Figure 11 shows the corresponding
pressure across the lattice as a function of time. The simulation is stopped
when the invading ﬂuid has about half ﬁlled the system. As in the case
of viscous ﬁngering Q = 1.5 ml/min and Ca = 4.6 · 10−3. The viscosities
are µ1 = 0.10 P and µ2 = 10 P giving M = 1.0 · 102. Thus, the invading
non-wetting ﬂuid is more viscous than the defending wetting ﬂuid.

The ﬂuid movements are dominated by the viscous forces in the invading
liquid and like viscous ﬁngering the capillary eﬀects are negligible. The
invading ﬂuid generates a compact pattern with an almost ﬂat front between
the non-wetting and wetting ﬂuid. The simulation is stopped after the width
of the front has stabilized, that means after the width of the front stops
growing.

The average pressure across the lattice (ﬁgure 11) increases according
to the amount of the high viscosity invading ﬂuid injected into the system.
Due to the low viscosity defending ﬂuid the pressure corresponds to the
pressure across the invading phase and a linear increase in the pressure is
observed after the front has stabilized.
(In ﬁgure 11: t > 50 s). Like in
viscous ﬁngering, the average slope of the pressure function also depends on
the viscosity ratio M and the injection rate.

The viscous forces dominate the pressure evolution, but ﬂuctuations due
to capillary eﬀects are observed. The perturbations have about the same size

14

as for viscous ﬁngering, which is not surprising since the size distribution of
the radii of the tubes is the same for the two cases. The threshold pressures
setting the strength of the capillary ﬂuctuations, is inversely proportional
to the radius of the tubes.

In fast displacement the viscous forces are strong enough to deform and
even move small regions of trapped defending ﬂuid which are left behind
the front. It is also observed that the invading ﬂuid grows along the whole
front, causing the corresponding menisci to reach the end of the tube ap-
proximately at the same time. All together the result is a lot of bubbles of
non-wetting and wetting ﬂuid which travel through the network. Physically,
the bubbles are expected but at the time they become too dominant in the
displacement they cause some computational complication. The bubbles
increase the number of tubes that should contain three menisci. Thus, a
large number of reorganizations inside the tubes are applied to fulﬁll the
constraint of at most two menisci in each tube. Typically, this is observed
in ﬁgure 11 where the ﬂuctuations in last part of the pressure function seem
to increase in amplitude. The increasing amplitude is a result of the un-
physical pressure jumps when three menisci are reorganized into one. For
that reason the simulation is stopped before breakthrough of the invading
ﬂuid.

Another shortcoming in fast displacement is that the eﬀective time step
may approach zero. When the bubbles develop the number of menisci in-
creases causing many of them to arrive at the end of the tubes approximately
at the same time. The result is that the diﬀerence of the arrival times for the
menisci goes to zero and a lot of iterations are required to move the whole
front further on. Numerical experiments have shown that the problem ﬁrst
arises when the displacement is rather fast, that means Ca > 5 · 10−3.

6.3 The Regime of Capillary Fingering

Finally a calibration simulation is run in the regime of capillary ﬁngering.
The resulting pattern is shown in ﬁgure 12, and in ﬁgure 13 the corre-
sponding pressure across the lattice as a function of time is plotted. The
simulation is performed on a lattice of 40 × 60 nodes and the run is stopped
when the invading ﬂuid reaches the outlet. The two ﬂuids have equal viscosi-
ties, µ1 = µ2 = 0.50 P, corresponding to similar experiments performed by
Frette et al. (1997). The invading non-wetting ﬂuid displaces the defending
wetting ﬂuid with a rather low injection rate, Q = 0.20 ml/min. The cap-
illary number and the viscosity ratio become Ca = 4.6 · 10−5 and M = 1.0

15

respectively.

In capillary ﬁngering the displacement is so slow that the viscous forces
are negligible, with the consequence that the main force is the capillary one
between the two ﬂuids. Only the strength of the threshold pressure in the
tubes decides if the invading ﬂuid invades that tube or not. Since the radii
of the tubes (which determine the threshold pressures) are randomly chosen
from a given interval, the non-wetting ﬂuid ﬂows a random path of least
resistance.

Figure 12 shows a typical rough front between the invading and the
defending ﬂuids with trapped clusters of defending ﬂuid left behind the
front. As opposed to stable displacement the clusters appear at all sizes
between the tube length and the maximum width of the front.

The pressure across the lattice (ﬁgure 13) exhibits sudden jumps accord-
ing to the capillary variation when the non-wetting ﬂuid invades (or retreats)
a tube. The ﬂuctuations identify the bursts where the invading ﬂuid pro-
ceeds abruptly. An enlargement of a small part of the pressure function at
at time around 550 s is given in ﬁgure 14. The ﬁgure shows clearly this kind
of dynamics. The pressure across the lattice slowly increases in stable peri-
ods before the threshold pressure in the tube which is going to be invaded
is reached. At the threshold pressure the meniscus becomes unstable and
the invasion of ﬂuid takes place in a burst accompanied by sudden negative
jumps in the pressure. The pressure curve in ﬁgure 14 is in good qualitative
agreement with experimental results [17].

The main problem in capillary ﬁngering is the computation time. The
above simulation used about 36 CPU hours at a Cray T90, on a smaller
lattice than the ones for viscous ﬁngering and stable displacements. The
two latter cases required both about 7 CPU hours. The reason for this dra-
matic increase in computation time is explained by looking at the physical
properties of capillary ﬁngering. The invasion occurs in bursts and each
burst is localized to some very few tubes. That means that even with step
lengths equal to those of stable displacement the amount of invading ﬂuid
injected into the system each time step is much less. Now, compared to
viscous ﬁngering the total saturation of the invading ﬂuid is relatively high
and as a consequence, an enormous number of time steps are required to
reach break through. In the above simulation approximately 300, 000 time
steps are applied, while in the case of viscous ﬁngering only about 2, 500
steps were necessary to reach breakthrough.

16

7 Conclusions

We have presented and discussed a two-dimensional network model simulat-
ing drainage displacement. Moreover, we have performed numerical calibra-
tion simulations whose results are found to be in good qualitative agreement
with the properties observed in the three major ﬂow regimes: viscous ﬁn-
gering, stable displacement and capillary ﬁngering.

An important feature of the model is the capability to study temporal
evolutions of diﬀerent physical properties taking place in the displacement
process. This continues the work of understanding two-phase ﬂow in porous
media. In particular, we have presented calculations of the pressure evolu-
tions where the dynamics of the capillary eﬀects were taken into account.
With the proposed model it is also possible to measure the viscous and
capillary contribution to the total pressure. This is a great advance since
corresponding measurements in experimental setups are too diﬃcult. A
quantiﬁcation of the competition between viscous and capillary forces will
help to characterize the diﬀerent ﬂow regimes observed in drainage displace-
ment.

An approximation has been developed to simulate a simultaneous ﬂow of
the two liquids inside a single tube. The presented moving rules take care of
this kind of mixing and actually, they are essential to make the model work.
So far the moving rules are based on the mechanisms observed in drainage,
but in principle it should be possible by a certain modiﬁcations to model
imbibition as well.

The lattice sizes are limited by the computation time and the model
requires usage of high performance vector machines. To aﬀord simulations
on lattice sizes comparable to those in experimental setups [9, 16], more so-
phisticated and eﬃcient algorithms have to be developed. Especially, vector
machines with parallel capabilities should be considered.

Acknowledgments

We thank S. Basak, I.O. Frette and J. Schmittbuhl for valuable comments.
The computations were done at HLRZ, Forschungszentrum J¨ulich GmbH
and E.A. is grateful for the hospitality shown there. The work has received
support from NFR, The Research Council of Norway.

17

References

[1] Batrouni, G. G. and Hansen, A.: 1988, Fourier Acceleration of Itera-
tive Processes in Disordered Systems, J. Stat. Phys. 52, pp. 747–773.

[2] Blunt, M. and King, P.: 1990, Macroscopic parameters from simula-

tions of pore scale ﬂow, Phys. Rev. A 42, pp. 4780–4787.

[3] Cieplak, M. and Robbins, M. O.: 1988, Dynamical Transition in
Quasi-static Fluid Invasion in Porous Media, Phys. Rev. Lett. 60,
pp. 2042–2045.

[4] Chen, J.-D. and Wilkinson, D.: 1985 Pore-Scale Viscous Fingering in

Porous Media, Phys. Rev. Lett. 55, pp. 1892–1895.

[5] Constantinides, G. N. and Payatakes, A. C.: 1996, Network Simu-
lation of Steady-State Two-Phase Flow in Consolidated Porous Me-
dia,AIChEJ 42, pp. 369–382.

[6] Dias, M. M. and Payatakes, A. C.: 1986, Network models for two-
phase ﬂow in porous media. Part 1. Immiscible micro-displacement of
non-wetting ﬂuids, J. Fluid Mech. 164, pp. 305–336.

[7] Dullien F.A.L.:1992 Porous media: ﬂuid transport and pore structure,

Academic Press, California, USA, pp. 333–336.

[8] Dussen V, E. B.:1979 On the spreading of liquids on solid surfaces:
static and dynamic contact lines, Ann. Rev. Fluid Mech. 11, pp. 371–
400

[9] Frette, O. I., M˚aløy, K. J., Schmittbuhl, J. and Hansen, A.:
1997 Immiscible Displacement of Viscosity Matched Fluids In Two-
Dimensional Porous Media, Phys. Rev. E. 55, pp. 2969–2975.

[10] Haines, W. B.: 1930, Studies in the physical properties of soil, J. Agr.

Sci. 20, pp. 97–116.

[11] King, P. R.: 1987, The fractal nature of viscous ﬁngering in porous

media, J. Phys. A 20, pp. L529–L534.

[12] Koplik, J. and Lasseter, T. J.: February 1985, Two-Phase Flow in
Random Network Models of Porous Media, Soc. Petr. Eng. J.

18

[13] Lenormand, R., Touboul, E. and Zarcone, C.: 1988, Numerical models
and experiments on immiscible displacements in porous media,J. Fluid
Mech. 189, pp. 165–187.

[14] Lenormand, R. and Zarcone, C.: 1983, Mechanism of the displacement
of one ﬂuid by another in a network of capillary ducts,J. Fluid Mech.
135, pp. 337–353.

[15] Lenormand, R. and Zarcone, C.: 1985, Invasion percolation in an
etched network: measurement of a fractal dimension, Phys. Rev. Lett.
54, pp. 2226–2229.

[16] M˚aløy, K. J., Feder, J. and Jøssang, T.: 1985, Viscous ﬁngering frac-

tals in porous media., Phys. Rev. Lett. 55, pp. 2688–2691.

[17] M˚aløy, K. J. and Furuberg, L. and Feder, J. and Jøssang, T.: 1992,
Dynamics of slow drainage in porous media, Phys. Rev. Lett. 68,
pp. 2161–2164.

[18] Paterson, L.: 1984, Diﬀusion-limited aggregation and two-ﬂuid dis-
placements in porous media. Phys. Rev. Lett. 52, pp. 1621–1624.

[19] Press, W. H. and Teukolsky, S. A. and Vetterling, W. T. and Flannery,
B. P.: 1992, Numerical Recipes, Cambridge University Press, New
York, USA, pp 704–708.

[20] Washburn, E. W.: 1921, The Dynamics of Capillary Flow,Phys. Rev.

17, pp. 273–283.

[21] Wilkinson, D. and Willemsen, J. F.: 1983, Invasion percolation: A
new form of percolation theory, J. Phys. A 16, pp. 3365–3376.

[22] Witten, T.A. and Sander, L.M.: 1981, Diﬀusion-limited aggregation,
a kinetic critical phenomenon, Phys. Rev. Lett. 47, pp. 1400–1403.

19

Figure 1: A square lattice of tubes connected together at nodes. The size
of the lattice is 10 × 10 nodes. The black region indicates the invading non-
wetting ﬂuid coming from below and the light gray indicates the defending
wetting ﬂuid ﬂowing out of the top.

Figure 2: Flow in a tube containing a meniscus.

Figure 3: The capillary pressure pc as a function of the meniscus’ position
x in that tube. In the middle of the tube at x = d/2 the capillary pressure
becomes equal to the threshold pressure pt.

Figure 4: Four diﬀerent ﬂuid arrangements inside one tube. The shaded and
the white regions indicate the non-wetting and wetting ﬂuid respectively.

Figure 5: The motion of the menisci at the nodes. (a): The non-wetting ﬂuid
(shaded) reaches the end of the tube (position 1) and is moved a distance δ
into the neighbor tubes (position 2). (b): The wetting ﬂuid (white) reaches
the end of the tubes (position 1) and the non-wetting ﬂuid (shaded) retreat
to position 2. For both (a) and (b) a proper time is recorded due to the
small movement δ.

20

Figure 6: Reduction of three menisci into one. (a): The non-wetting ﬂuid
has reached the end of the tube (position 1) and is going to be moved into
the neighbor tubes (position 2). The three menisci in the left tube are
reorganized causing the situation shown in (b) to appear. In the ﬁgures the
arrows denote the length of the wetting ﬂuid between position 2 and 3 which
is equal to the distance the meniscus at position 4 is moved to the right.

Figure 7: A “mixture” of non-wetting (shaded) and wetting (white) which
ﬂow into the neighbor tubes. The diﬀerent arrangements (a)–(g) are a result
of applying the rules which are described earlier in this section. For all ﬁgures
the ﬂuids ﬂow towards the node from the bottom and right tube while the
ﬂuids in the top and the left tube ﬂow away from it (denoted by the arrows
in (a)).

Figure 8: The pattern obtained of a simulation in the regime of viscous
ﬁngering on a lattice of 60 × 80 nodes. Ca = 4.6 · 10−3 and M = 1.0 · 10−3.
The invading non-wetting ﬂuid (black) displaces the defending wetting ﬂuid
2 hours on a Cray T90
(gray) from below. The simulation took about 7 1
vector machine.

Figure 9: The calculated pressure across the lattice as a function of time for
viscous ﬁngering. The pressure decreases with time due to the viscous forces
in the defending ﬂuid and the ﬂow velocities of the moving ﬁnger tips. The
perturbations correspond to the capillary forces due to the moving menisci.
The time is the total time lapse required to let the invading ﬂuid reach the
outlet.

21

Figure 10: The pattern obtained of a simulation performed on a lattice of
60 × 60 nodes in the regime of stable displacement. Ca = 4.6 · 10−3 and
M = 1.0 · 102. The invading non-wetting ﬂuid (black) displacement the
defending wetting ﬂuid (gray) from below. The simulation took about 7
hours on a Cray T90 vector machine.

Figure 11: The calculated pressure across the lattice as a function of time for
stable displacement. For t > 50 s the pressure increases linearly with time
due to the viscous forces in the invading ﬂuid and the constant injection
rate. The perturbations correspond to the capillary forces along the front.

Figure 12: The pattern obtained of a simulation performed on a lattice
of 40 × 60 nodes in the regime of capillary ﬁngering. Ca = 4.6 · 10−5 and
M = 1.0. The invading non-wetting ﬂuid (black) displacement the defending
wetting ﬂuid (gray) from below. The simulation took about 36 hours on a
Cray T90 vector machine.

Figure 13: The calculated pressure across the lattice as a function of time for
capillary ﬁngering. The ﬂuctuations due to the capillary forces correspond
to the burst dynamics of the invading ﬂuid. See also ﬁgure 14.

Figure 14: A magniﬁcation of the pressure across the lattice as a function
of time in the interval 540–560 s. The ﬂuid invasion takes place in bursts
characterized by the the negative pressure jumps.

22

Figure 1

Aker et al.

Network Simulator for...

2r

p2

p1
θ

µ
1

pj

d

µ

2

x

ij

 pt

c
p
 
,
e
r
u
p
s
i
s
e
r
p
 
y
r
a
l
l
i
p
a
C

0

0

d/2
Position of the meniscus, x

d

Figure 3
Figure 2

Aker et al.
Aker et al.

Network Simulator for...
Network Simulator for...

δ

(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(b)

1

δ

2

(a)

2
δ

2

1

2

2

1

δ

δ

(cid:0)
(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1)

4

2

3

(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1) (cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1)

2

1

4

2

1

1

δ

2

(c)

(a)

(a)

(d)

(e)

(c)

(b)

(b)

(d)

(b)
δ

(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1)

(a)

(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:1)
(cid:0)
(cid:1)
(cid:0)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(f)

(g)

Figure 5
Figure 8
Figure 4
Figure 6
Figure 7

Aker et al.
Aker et al.
Aker et al.
Aker et al.
Aker et al.

Network Simulator for...
Network Simulator for...
Network Simulator for...
Network Simulator for...
Network Simulator for...

8.0

6.0

4.0

2.0

)

2

3

m
c
/
n
y
d
 

0
1
(
 
 
e
r
u
s
s
e
r
P

 0.0

0.0

20.0

40.0

60.0

Time (s)

Figure 9

Aker et al.

Network Simulator for...

Figure 10

Aker et al.

Network Simulator for...

10.0

)

2

8.0

3

m
c
/
n
y
d
 

0
1
(
 
 
e
r
u
s
s
e
r
P

6.0

4.0

2.0

 0.0

0

50

100

150

Time (s)

Figure 11

Aker et al.

Network Simulator for...

Figure 12

Aker et al.

Network Simulator for...

)

2

2.0

2.5

1.5

1.0

0.5

3

m
c
/
n
y
d
 

0
1
(
 
 
e
r
u
s
s
e
r
P

 0.0

0

200

400
Time (s)

600

800

Figure 13

Aker et al.

Network Simulator for...

2.0

1.5

1.0

)

2

3

m
c
/
n
y
d
 

0
1
(
 
e
r
u
s
s
e
r
P

 0.5

540

545

550
Time (s)

555

560

Figure 14

Aker et al.

Network Simulator for...

