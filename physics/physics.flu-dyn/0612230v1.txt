6
0
0
2
 
c
e
D
 
3
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
0
3
2
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Fluctuating hydrodynamic modelling of ﬂuids at the nanoscale

G. De Fabritiis,1, ∗ M. Serrano,2, † R. Delgado-Buscalioni,3, ‡ and P. V. Coveney4, §
1Computational Biochemistry and Biophysics Lab (GRIB/IMIM-UPF),
Barcelona Biomedical Research Park (PRBB), C/ Dr. Aiguader 88, 08003, Barcelona, Spain
2Depto. F´ısica Fundamental, Facultad de Ciencias,
UNED, Paseo Senda del Rey 9, 28040 Madrid, Spain.
3Depto. Ciencias y T´ecnicas Fisicoqu´ımicas, Facultad de Ciencias,
UNED, Paseo Senda del Rey 9, Madrid 28040, Spain.
4Centre for Computational Science, Department of Chemistry,
University College London, 20 Gordon Street, WC1H 0AJ London, U.K.

A good representation of mesoscopic ﬂuids is required to combine with molecular simulations at
larger length and time scales (De Fabritiis et. al, Phys. Rev. Lett. 97, 134501 (2006)). However,
accurate computational models of the hydrodynamics of nanoscale molecular assemblies are lacking,
at least in part because of the stochastic character of the underlying ﬂuctuating hydrodynamic
equations. Here we derive a ﬁnite volume discretization of the compressible isothermal ﬂuctuating
hydrodynamic equations over a regular grid in the Eulerian reference system. We apply it to ﬂuids
such as argon at arbitrary densities and water under ambient conditions. To that end, molecular
dynamics simulations are used to derive the required ﬂuid properties. The equilibrium state of the
model is shown to be thermodynamically consistent and correctly reproduces linear hydrodynamics
including relaxation of sound and shear modes. We also consider non-equilibrium states involving
diﬀusion and convection in cavities with no-slip boundary conditions.

PACS numbers: 47.61.-k,47.11.Mn

I.

INTRODUCTION

¿From a continuum perspective the fundamental equa-
tions underlying hydrodynamics at the mesoscale are the
well known ﬂuctuating hydrodynamics (FH) equations
[1]. The FH equations are stochastic partial diﬀerential
equations that reduce to the Navier-Stokes equations in
the limit of large volumes. In fact, at scales of nano to mi-
cro meters, thermal ﬂuctuations cannot be neglected, but
must be incorporated as random terms in the momentum
and energy equations of hydrodynamics because they are
responsible for the mechanical and thermal energy pro-
cesses underlying Brownian motion. The hydrodynamics
of nanoscopic quantities of liquids, in particular for water
models used in molecular dynamics simulations such as
TIP3P [2], is relevant in many biological and technolog-
ical applications.

Novel multiscale modelling techniques via domain de-
composition (particle-continuum hybrid approach) re-
quire a very accurate description of thermodynamics and
In these
hydrodynamics at the mesoscale level [3, 4].
methods a large part of the system is resolved with a con-
tinuum model (CFD) and a smaller part using full-atom
molecular dynamics (MD). An exact match between the
local thermodynamic and hydrodynamic properties of
the continuum and the molecular system is required for
such a scheme to work properly. This matching enables

∗gdefabritiis@imim.es
†mserrano@ﬁsfun.uned.es
‡rafa@ccia.uned.es
§p.v.coveney@ucl.ac.uk

a seamless coupling such that the behaviour of molecu-
lar and hybrid simulations are indistinguishable [4]. De-
pending on the process or regime being considered ﬂuctu-
ations may play an important rˆole [5]. For these reasons,
the ﬂuctuating hydrodynamics model described here has
been used in the ﬁrst hybrid MD-FH model for water
which includes mass and momentum ﬂuctuations as well
as for propagation of sound waves across an hybrid in-
terface [4, 6] because of the need to have a ﬁne control
over the characteristics of the ﬂuid to much the molec-
ular description (shear and bulk viscosities, equation of
state and thermodynamic ﬂuctuations).

An accurate code for ﬂuctuating hydrodynamics, pos-
sibly interfaced with molecular dynamics, would be a
useful tool for nanoscale computational ﬂuid dynamics
(CFD) simulation, including inter alia microﬂuidic de-
vices [7]. These devices are essentially hydraulic mi-
cro machines which are able to process nano liters of
reagents. These volumes are too large to be simulated
by molecular dynamics, while, on the other hand, a stan-
dard CFD code cannot handle ﬂuctuations at all.

A general purpose FH solver could also be used to
provide an implicit hydrodynamic solvent for solute par-
ticles (polymers, colloids, etc.). Solvent molecules of-
ten comprise the computationally most expensive part of
any molecular or coarse-grained simulation, but in some
instances the solvent could be approximated by an “im-
plicit description”, retaining only the hydrodynamic con-
tribution to the solute dynamics. A possible approach
was ﬁrst illustrated in [8]. A solver of FH for the hydro-
dynamic description of these hybrid models could be em-
ployed to study the eﬀect on polymer collapse of changing
solvent characteristics [9] by tuning the characteristics of

2

the ﬂuids such as their viscosities.

II. A FINITE VOLUME DISCRETIZATION OF
FLUCTUATING HYDRODYNAMICS

In recent years, many computational models have
been devised which provide a discrete representation of
FH [10, 11, 12], e.
g. dissipative particle dynamics
(DPD) [13, 14] and the lattice Boltzmann method (LBM)
[11, 15, 16, 17, 18] later extended to include thermody-
namic ﬂuctuations [19, 20, 21]. Following a continuum
approach, the fundamental equations of ﬂuctuating hy-
drodynamics can also be resolved directly via ﬁnite diﬀer-
ences or ﬁnite volume schemes [22, 23]. Most of the pre-
vious schemes proposed for solving ﬂuctuating hydrody-
namics considered only the gas phase [22, 24] and have fo-
cused on the linear regime where a closed set of equations
for the ﬂuctuating quantities or for their mutual spatial
correlations can be derived [24]. The main diﬃculty in
devising a discretization of the FH equations is that the
precise form of the required ﬂuctuation-dissipation rela-
tions depends on the discretization scheme and, in gen-
eral, it does not coincide with the ﬂuctuation-dissipation
relations of the continuum description. This statement
applies for Lagrangian FH models [23, 25, 26], for ﬂuctu-
ating lattice Boltzmann models [19, 20, 21] and for the
Eulerian FH description. Moreover the resulting equa-
tions are stochastic in nature which adds extra compli-
cations to the integration methods [27, 28, 29].

For these reasons, a simple and easy-to-implement gen-
eral purpose solver of the compressible FH equations al-
lowing ﬂuid speciﬁcity and non-linear hydrodynamic cou-
pling is not readily available. It is the purpose of this
paper to address this lacuna. We present a ﬁnite volume
discretization of the compressible isothermal ﬂuctuating
hydrodynamic equations, based on an Eulerian descrip-
tion on a regular grid. The model provides a thermo-
dynamically consistent coarse-grained representation of
nano liter portions of real ﬂuids ranging from gases (ar-
gon) to liquids (water).

The outline of the paper is the following: The ﬂuctuat-
ing hydrodynamic Eulerian solver is described in section
II. In section III we study the numerical accuracy of the
scheme by comparing the input values of the viscosities
with the eﬀective ones measured from the hydrodynamic
solver based on the relaxation of sound and shear waves.
In section IV we assess the validity of the description
of the equilibrium state, showing that ﬂuctuations are
correctly generated, propagated and dissipated. To that
end we calculate the time correlation functions of the
diﬀerent ﬂuctuating variables of one ﬂuid cell (density
and velocity) and compare them with the corresponding
grand canonical result.
In section V we consider non-
equilibrium states in closed systems with rigid walls, us-
ing the no-slip boundary condition: we test them for Cou-
ette, Poiseuille and cavity ﬂows. Finally, we summarise
our ﬁndings in section VI.

Our proposed mesoscopic model is a ﬁnite volume dis-
cretization of FH [23, 26] over a regular lattice in the
Eulerian frame of reference. In this case, we concentrate
on the description of an isothermal compressible ﬂuid.
This sort of description can be generalized straightfor-
wardly to non-isothermal states for ﬂuids with vanish-
ingly small thermal expansion, for which the energy equa-
tion decouples from the mass and momentum equations
[22]. Extensions to include energy ﬂows will be consid-
ered elsewhere. We thus require the equations of ﬂuctu-
ating hydrodynamics describing the conservation of mass
and momentum,

∂tρ = −∂βgβ,

∂tgα = −∂β

gβvα + Παβ +

Παβ

,

(1)

(cid:16)

(cid:17)

e

where ρ(r, t) is the density ﬁeld of the ﬂuid, vα(r, t)
is the continuous velocity ﬁeld in the component α,
gβ(r, t) = ρ(r, t)vβ(r, t) is the momentum ﬁeld and we
have used the repeated suﬃx convention for summation
Παβ(r, t) are respec-
over repeated indices. Παβ(r, t) and
tively the average (Navier-Stokes) and ﬂuctuating stress
tensor ﬁelds. The average stress tensor is deﬁned as
Π = (p+π)1+Π, where p is the thermodynamic pressure
given by the equation of state for the ﬂuid, π = −ζ∂γvγ
∂αvβ + ∂βvα − 2D−1∂γvγδαβ
and Παβ = −η
where η
and ζ are the shear and bulk viscosity respectively and
(cid:0)
D is the spatial dimensionality.

e

(cid:1)

The equation of state p = p(ρ, T ) for Lennard-Jones
(LJ) ﬂuids (like argon) has been studied by several au-
thors (see e.g., Ref. [30]), as well as the transport coeﬃ-
cients of the LJ ﬂuid [31, 32]. By contrast, the equation
of state of the TIP3P model for water [2] (chosen due
to its importance in biological applications) has received
less attention [33].
In Appendix B we provide a para-
metric study of the equations of state of the ﬂuids consid-
ered here (argon and TIP3P water model), performed via
molecular dynamics (MD) simulations. From this study
we obtain a second order polynomial ﬁt for p = p(ρ, T )
which provides the equation of state of our FH model.
This procedure is required, for instance, to provide the
level of accuracy for the thermodynamic pressure within
hybrid MD simulations [4]. We have also calculated the
transport coeﬃcients of water via non-equilibrium molec-
ular dynamics, which are in agreement with those re-
ported in the literature [34].

The ﬂuctuating stress tensor

Παβ (see Ref.[1]) is a ran-
dom Gaussian matrix with zero mean and correlations
given by

e

Παβ(r1, t1)
h

Πδγ (r2, t2)i =2kBT Cαβγδδ(t1 − t2)δ(r1 − r2),
(2)

e

e
where Cαβγδ =
,
kB is the Boltzmann constant and T is the temperature.
(cid:3)

η(δαδδβγ + δαγδβδ + (ζ − 2
(cid:2)

D η)δαβ δδγ

Note that this spatial delta-correlated quantity, in the
discrete limit of a small volume and small time interval,
can be rewritten as

Παβ (r1, t1)
h

Πδγ (r2, t2)i ≈

Cαβγδ,

(3)

2kBT
∆t∆V

e

e

where ∆V is the small volume element of ﬂuid and ∆t is
the time step.

The ﬂuctuating hydrodynamic equations (1) are bal-
ance equations of the form ∂tφ(r, t) = −∇ · Jφ for mass
and momentum which can be integrated by considering
a ﬁnite volume discretization.
In what follows we will
derive a ﬁnite volume discretization of the equations of
ﬂuctuating hydrodynamics in the Eulerian system of ref-
erence. We ﬁrst partition the space into N space ﬁlling
volumes Vk (in our case a regular Cartesian lattice is
used) with k = 1, ..., N to integrate Eqs. (1) over the
volume Vk and apply Gauss’s theorem

d
dt ZVk

φ(r, t)dr =

Jφ
kl · eklAkl,

(4)

Xl

where ekl is the unit vector perpendicular to the con-
tact surface of area Akl from volume l to volume k. The
summation is over all the l volumes that are in contact
with ﬂuid volume k. By deﬁning M t
Vk ρ(r, t)dr
as the mass inside a generic volume Vk, and Pt
k =
Vk ρ(r, t)v(r, t)dr its momentum, we thus build dynam-
ical equations corresponding to discrete extensive vari-
R
ables which replace Eqs.(1) governing the time evolution
of the intensive continuum ﬁelds. These new equations
are given by

k =

R

dM t

k =

gkl · eklAkldt,

Xl

Xl

dPt

k =

(vkl gkl + Πkl) · eklAkldt + d

(5)

Pt
k,

e

2 (ρk + ρl) 1

where we have approximated the mass ﬂux Jρ
kl with
gkl = 1
2 (vk + vl), the velocity on the surface
kl as vkl = 1
2 (vk + vl), the average stress tensor on the
surface as Πkl = 1
k indicates
the momentum change due to the ﬂuctuating part of the
pressure tensor, all at time t.

2 [(pl + πl)1 + Πl] and d

Pt

e

An essential component for the discretization of a
stochastic mesoscopic model
is the balancing of dis-
sipative and ﬂuctuating components, otherwise the
ﬂuctuation-dissipation theorem would not be satisﬁed.
There are at least two ways to satisfy this condition, ei-
ther by using the Fokker-Planck equations mathemati-
cally equivalent to the stochastic diﬀerential equations
(SDE 5) and equating dissipative and diﬀusive terms
weighted over the Gibbs ensemble distribution [26] or
by using the GENERIC formalism [23, 35]. By choos-
ing the gradient discretization provided in [23] a lot of

3

(6)

long algebra is avoided; we ﬁnd discrete versions for

Akl
2

(cid:20)

(eα

klvβ

l + eβ

klvα

l ) −

δαβ
D

Akleγ

klvγ
l (cid:21)

,

Π

αβ
k =

πk =

ηk
Vk Xl
ζk
Vk Xl

Akl
2

klvβ
eβ
l ,

and the ﬂuctuating component of the momentum equa-
tion given by

Pt
d

k =

e

+

Akl
2 r

Akl
2 r

Xl

Xl

4kBTl

dW

S
l · ekl

ηl
Vl

2DkBTl

ζl
Vl

tr[dWl]
D

ekl,

(7)

where dWl
is a D × D matrix (D = 3 in three di-
mensions) of independent Wiener increments satisfying
hdWαβ
is a traceless
symmetric random matrix deﬁned as

l i = δklδαγδβδdt and dW

k dWγδ

S
l

dW

S
l =

(dWl + dWT
l )
2

−

tr[dWl]
D

1.

(8)

The resulting set of stochastic diﬀerential equations is
integrated using a simple stochastic Euler scheme in the
present work. Note, however, that other more accu-
rate stochastic integration schemes for mesoscopic mod-
els have recently been proposed based on the Trotter ex-
pansion in the stochastic case [28, 29]. Improvements to
the solver for the spatial regular grid and for the time in-
tegration scheme have not been considered for the present
scheme because at these scales the Reynolds number
is usually low and the computational limitation comes
rather from the molecular dynamics component. How-
ever, generalizations to unstructured grids are straight-
forward. In particular, in a hybrid MD-CFD model ﬁner
cells should be located near the MD region and coarser,
bigger cells further away from the MD domain.

III. ACCURACY OF THE SCHEME

To assess the accuracy of the numerical scheme, we
measure the eﬀective viscosities and sound velocity com-
puted from the hydrodynamic solver and compare them
with the input values. The transport coeﬃcients are mea-
sured from the relaxation of transversal and longitudinal
waves in the deterministic limit. We give more details
in Appendix A.
In the following tests we consider ar-
gon at temperature T = 300 K and mass equilibrium
density ρe = 0.6 g/mol/˚A3 and TIP3P water. The corre-
sponding values of the dynamic shear and bulk viscosity
for argon and water are shown in table I, along with the
isothermal sound velocity, c2
T ≡ (∂P/∂ρ)T and sound ab-
sorption coeﬃcient ΓT . We consider a periodic 3D cubic
domain of length L; thus, the permitted wavelengths are
kn = 2πn/L, and we excite the longest wavelength of the
system, of wave-number 2π/L.

TABLE I: Some properties of argon and water at T = 300 K
at the mass densities ρ considered; m is the molecular mass.
Note that length, time and mass units are ˚A, ps and g/mol
respectively. The properties displayed are shear viscosity (η),
bulk viscosity (ζ), isothermal sound speed (cT ) and isothermal
sound absorption (ΓT ) in corresponding units.

ρ

η
liquid m
argon 39.948 0.60 5.474 1.823 5.614 7.612
water 18.015 0.632 53.71 127.05 14.75 157.17

ΓT

cT

ζ

−1

10

x
 
E

−2

10

2.5

1.5

0.5

)
s
p
/
A

(
 

x
V

−0.5

−1.5

−2.5
0

50

150

200

100
z (A)

o

FIG. 1: Velocity ﬁeld vx as a function of z (in ˚A) for
this decaying transversal wave. Diamonds correspond to
simulation results and the continuum lines correspond to
the theoretical proﬁle at snapshots corresponding to times
t = 0, 50, 100, · · · , 750 ps. At time t = 0 ps the amplitude is
maximum while at t = 750 ps the amplitud is mininum.

A. Transversal wave

The wave-vector of a transversal wave is perpendicular
to its velocity, k⊥v. Consider an initial perturbative
velocity v = (v0 sin(kz), 0, 0), with k = (0, 0, k). For
small perturbations around equilibrium, the linearized
solution for the momentum density ﬁeld in Fourier space
given in Eqs.(A9) is

g(k, t) = exp{−νk2t}g(k, 0),

(9)

while in real space, the time dependent velocity ﬁeld
reads

vx(t) = v0 sin(kz) exp{−νk2t};

(10)

in addition vy(t) = vz(t) = 0 and ρ(t) = ρe.

In Fig.1 we plot some snapshots of the velocity ﬁeld for
a deterministic simulation. This case represent a three
dimensional simulation box of 200 × 200 × 200 ˚A3 (10 ×
10×10 cells) which corresponds to a spatial resolution δ =
20 ˚A. The applied initial velocity amplitude is v0 = 2.04
˚A/ps, the argon input viscosity at 300 K is η = 5.4744
and the mean mass density is ρ = 0.6 g/mol/˚A3. The
theoretical agreement with expression (10) is remarkable.

4

δ2

Shear viscosity
Sound velocity
Sound attenuation

5

10

o

δ (A)

20

FIG. 2: Relative error for the shear viscosity, sound absorp-
tion coeﬃcient and sound velocity as a function of the spatial
resolution δ. For any ﬂuid parameter (e.g. ν) the relative
error is deﬁned as Eν ≡ |νnum − ν|/ν, where ν is the in-
put value and νnum that measured from the relaxation of the
corresponding hydrodynamic mode.

For a closer inspection of the numerical accuracy of the
scheme we compared the eﬀective (or numerical) shear
viscosity νnum with the input value ν. The value of
νnum was measured by ﬁtting the decay of the Fourier
component of the transversal momentum to a simple
exponential function. The relative error in viscosity
Eν ≡ |νnum − ν|/ν is shown in Fig.2 against the spatial
resolution δ, given by the distance between contiguous
cells. The trend obtained is Eν ∝ δ1.94, showing that our
spatial discretization method is of second order. As an
example, a continuum cell size of δ = 20 ˚A will give an
error in the viscosity around 12% while δ = 15 ˚A will re-
duce the relative error to 5% for the pertrubation applied
here.

B. Longitudinal wave

If the equilibrium state of the ﬂuid is initially per-
turbed with a momentum ﬁeld g0 = (g0 sin kx, 0, 0), a
longitudinal sound wave is created with a wave-vector
parallel to the momentum perturbation k = (2π/L, 0, 0).
As shown in Appendix A, two travelling sound modes
propagate at the sound velocity cT , creating a standing
wave in the periodic domain. According to Eqs. (A9)
the Fourier components of the deviation from the equi-
librium state for the density and velocity of the sound
modes are given by

δρ(k, t) ∝ −i exp{−ΓT k2t} sin(cT kt)

δg(k, t) ∝ exp{−ΓT k2t} cos(cT kt)k

(11)

,

k · g0
cT
k · g0
cT

,

0.6005

0.5995

0.5985

)

3
A
o

/
l
o
m

/
r
g
(
ρ 

5

theoretical T=300K

)

V
(
P

2

4

3

1

0

0.5975
0

50

150

200

100
x (A)

o

FIG. 3: The mass density ρ as a function of x (in ˚A) for a de-
caying longitudinal wave. Diamonds correspond to simulation
results and the continuum lines correspond to the theoretical
proﬁle given by Eq. (12). The snapshots correspond to the
times t = 0, 25, 50, · · · , 750 ps. The agreement is remarkable.
At time t = 0 ps the amplitude is maximum while at t = 750
ps the amplitud is mininum.

while in real space the density and velocity ﬁelds evolve
like

ρ(t) = ρe +

cos(kx) sin(cT kt) exp{−ΓT k2t},

vx(t) =

sin(kx) cos(cT kt) exp{−ΓT k2t}

(12)

g0
cT

g0
ρe

and the other velocity ﬁeld components remain at rest.
Note that ρe denotes the equilibrium density.

In Fig.3 we plot the density ﬁeld as a function of x
for a deterministic three dimensional simulation of size
200 × 200 × 200 ˚A3 (10 × 10 × 10 cells). In order to keep
the system in the linear regime, the applied initial veloc-
ity amplitude is set to v0 = 0.0204 ˚A/ps and the argon
input mean mass density is ρ = 0.6 g/mol/˚A3. The best
ﬁt to the absorption coeﬃcient and sound velocity are
ΓT = 7.24 and cT = 5.42, providing relative errors of
4.8% and 3.6% respectively. Figure 2 also shows the rel-
ative error in the sound absorption coeﬃcient and sound
velocity versus the spatial resolution. Note that the rel-
ative error in both quantities also decays roughly like δ2
which corroborates the second order spatial resolution of
the scheme again.

IV. THE EQUILIBRIUM STATE

Within a ﬂuid volume, stress ﬂuctuations arise due to
forces involved in the random sequence of molecular col-
lisions. This ﬂuctuating force generates momentum ﬂuc-
tuations. The amplitudes of mass and momentum ﬂuc-
tuations are determined by thermodynamic constraints.
Each ﬂuid cell is an open system with constant volume
and temperature, in other words, belonging to the grand
canonical ensemble. The variance of momentum and

−0.4

−0.2

0.2

0.4

0

o

     V (A/ps)

FIG. 4: The equilibrium distribution of the x component of
the velocity at one ﬂuid cell of volume 37.5 nm3 in a simula-
tion of argon (circles) at T = 300 K and ρ = 0.6 g/mol/˚A3
compared with the theoretical normal distribution (contin-
uum line). In this simulation ∆t = 20 fs and the best normal
ﬁt to the numerical distribution yields Tnum = 296.28 K, that
is a relative error of around 1.2%.

mass of a cell “c” are [1]

Var [Pc · e] = ρVckBT,
ρVckBT
c2
T

Var [Mc] =

,

(13)

where e is a unit surface vector, the mean mass of the cell
is ρVc and cT is the isothermal sound velocity. On the
other hand, these spontaneous mass and momentum ﬂuc-
tuations are transported through the ﬂuid and dissipated
following the same mechanism underlying the hydrody-
namic modes explained in Appendix A, i.e., either via
shear or sound modes.

A. Amplitude of ﬂuctuations

In this section we consider the equilibrium state of ar-
gon at diﬀerent densities (from gas to liquid) and wa-
ter (TIP3P model, see Appendix B) in order to illus-
trate that the ﬂuctuations are generated, transported
and dissipated in a thermodynamically and hydrodynam-
ically consistent way. First, we conﬁrm that the ampli-
tudes of mass and momentum ﬂuctuations are consis-
In the numeri-
tent with thermodynamic relations [1].
cal scheme the amplitude of ﬂuctuations is determined,
by construction, via the ﬂuctuation-dissipation theorem
[36]. Figure 4 presents a typical distribution of one ve-
locity component and compares it with the theoretical
Maxwellian distribution. As usual, a temperature can
be extracted from the variance of the velocity distribu-
tion. This “numerical” temperature will be labelled as
Tnum =

α Var[vα]/(3kB).

P

6

−1

10

−2

10

T
E

−3

10

10−4

100

∆t1

101
∆
 t (fs)

2
10

0.020

0.015

)
ρ
(
S

 
 
 

0.010

0.005

FIG. 5: Relative error in the temperature of the scheme, ET =
|Tnum − T |/T , with Tnum ≡ Pα Var[vα]/(3kB) and T = 300
K the input equilibrium temperature. Results correspond to
three-dimensional simulations of water at ρ = 0.6 g/mol/˚A3
with spatial resolution δ = 20 ˚A in each direction.

The accuracy of the stochastic time integrator for
the Langevin equation aﬀects the value of the numer-
ical temperature. Figure 5 shows the dependence of
the relative error in the mean temperature (deﬁned as
ET = |Tnum − Te|/Te) with the time step ∆t. Good
agreement is found and the relative error remains smaller
than 10% for ∆t ≤ 100 fs.

Figure 6 shows the standard deviation of the cell mass
density Std[ρc] against the mean density ρ = M/V ,
where M and V are the total mass and volume of the
system. The grand canonical prediction for the equi-
librium state is Std[ρ] = [ρkBT /(c2
T Vc)]1/2 and is com-
pared with the numerical simulations. In the ideal gas
limit the sound velocity is just
kBT /m (with m the
molecular mass) and the density ﬂuctuations increase as
Var[ρ(ideal)] = (m/V )ρ. As the ﬂuid becomes denser, it
becomes less compressible (the isothermal sound speed
cT increases) and as a consequence in the liquid phase
the mass ﬂuctuations decrease substantially. Therefore,
the largest mass ﬂuctuations are observed at moderate
densities (e.g. around ρ ≃ 0.3 g/mol/˚A3 for argon

p

see Fig.6). Almost perfect agreement is found between
theoretical and numerical results for both argon and wa-
ter.

B. Correlations at equilibrium

We now show that ﬂuctuations are transported
through the system and dissipated in a hydrodynamically
correct way. This can be shown via the time correlation
of the ﬂuctuating quantities. As shown in Ref. [36], the
time correlation of the Fourier components of mass and

Water (TIP3P)
Argon 
Ideal gas limits

0.000
0

0.2

0.4

0.6
(gr/mol/A3)

O

 ρ

0.8

1

FIG. 6: Standard deviation of the mass density S[ρ] in a ﬂuid
cell with volume 37.5 nm3 of argon and water at T = 300K.
The continuous line corresponds to the grand canonical results
obtained using the equation of state for argon, the dotted lines
T Vc)]1/2, and the dashed
for water (TIP3P model) [ρkBT /(c2
lines show the ideal gas limits [(m/V )ρ]1/2 with mAr = 39.498
g/mol (upper curve) and mH2O = 18.015 g/mol (lower curve).
Circles are results from the ﬂuctuating hydrodynamics solver
(using a water simulation at ρ = 0.632 g/mol/˚A3).

momentum satisfy

hρ(k, t)ρ(k, 0)i
Var[ρ(k, 0)]
hgk(k, t)gk(k, 0)i
Var[gk(k, 0)]
hg⊥(k, t)g⊥(k, 0)i
Var[g⊥(k, 0)]
hρ(k, t)i gk(k, 0)i
hρ(k, 0)i gk(k, 0)i

= exp{−ΓT k2t} cos(cT kt),

= exp{−ΓT k2t} cos(cT kt),

= exp{−νk2t},

= exp{−ΓT k2t} sin(cT kt). (14)

In Eqs.(14) gk indicates the longitudinal momentum, par-
allel to the wave vector k, while g⊥ indicates the transver-
sal components. Sound modes couple longitudinal mo-
mentum and density, as shown in Eqs.(14). According
to the Landau description of ﬂuctuating hydrodynam-
ics [1], at a ﬁxed time the stress ﬂuctuations occurring
within diﬀerent ﬂuid volumes are spatially uncorrelated.
This means that the variance of the Fourier modes of
the hydrodynamic variables (Var[ρ(k, 0)] = hρ(k, 0)2i) is
independent of the wave-number k. Moreover, ﬂuctua-
tions from the equilibrium state are assumed to be small
so that a linear analysis can be applied. This means
that perturbations of diﬀerent wavelengths evolve inde-
pendently as correlations between ﬂuctuations with dif-
ferent wave-vectors are negligible.

We have evaluated the time correlations of the Fourier
components of the hydrodynamic variables in a periodic
domain for the set of wave-numbers kn = 2πn/L. These
correlations were then ﬁtted to the corresponding expo-

]
3

o

0.65

(a)

(b)

V. NON-EQUILIBRIUM STATES

In this section we present standard non equilibrium
ﬂow tests performed with the mesoscopic Eulerian solver
described in previous sections. In order to do so, ﬁrstly
we require the description of the explicit boundary con-
ditions for our ﬂuid system enclosed between walls.

0

200

600

400
o
x (A)

0.62

0

200

400
   t (ps)

600

800

(c)

(d)

A. Boundary conditions

7

A

/
l
o
m

/
r
g
[
 
)
0
t
,
x
(

ρ

0.645

0.64

0.635

0.63

0.625

0.62

0.0010

0.0005

0.0

)
t
,
1

k
(

ρ

−0.0005

−0.0010

0.65

0.64

0.63

)
t
,
0
x
(
ρ

>
2

/

)
0
,
1
 
k
(
ρ
<
>
)
0
,
 
k
(
ρ
)
t
,
 

1
k
(
ρ
<

1

1.0

0.5

0.0

−0.5

−1.0

8000

12000

10000
   t (ps)

14000

0

500 1000 1500 2000

   t (ps)

FIG. 7: Water at ρ = 0.632 g/mol/˚A3 and T = 300 K (am-
bient conditions) within a periodic box of size 50 × 50 × 2250
˚A3 at equilibrium; the FH mesh is comprised of of 1 × 1 × 150
cells.
(b)
(a) The density ﬁeld in the real space, ρ(x, t0).
The time-dependence of the density at one cell ρ(x0, t). (c)
The Fourier mode ρ(k1, t) associated with wavevector k1 =
(0, 0, 2π/Lz). (d) The (normalized) time correlation function
hρ(k1, t)ρ(k1, 0)i. Note the diﬀerent time scales associated
with variations of quantities in (b),(c) and (d). The entire
run is of 40 ns duration.

nentially decaying functions of Eqs.(14) to obtain the ef-
fective sound frequency cT k and the eﬀective decay rates
for each wave-number (i.e. the inverse of ΓT k2 and νk2
for sound and shear, respectively). Calculations were
done in a periodic system of size 50 × 50 × 2250 ˚A3,
with a mesh of 1 × 1 × 150 cells, and we considered per-
turbations with wave-vectors kn = (0, 0, 2πn/Lz). In or-
der to illustrate the mathematical transformations, Fig.7
shows the density ﬁeld in the real space ρ(x, t0) (a), the
time-dependence of the density at one cell ρ(x0, t) (b),
the Fourier mode ρ(k1, t) associated with k1 = 2π/Lz
(c) and, ﬁnally in (d), the time correlation function
hρ(k1, t)ρ(k1, 0)i together with the best ﬁt obtained to
the theoretical exponential decay of the sound mode. The
best ﬁts to the eﬀective decay rates and sound periods
for varying wavelength λn = 2π/kn are compared with
the theoretical relations in Fig.8. Note that the theoreti-
cal trend agrees quite well with the simulation results for
λ > 100 ˚A. Considering that the size of one cell in these
simulations is 15 ˚A, this means that one needs more that
about 7 cells to properly resolve one wave. In fact, for
wavelengths λ < 100 ˚A the viscosity is underestimated
due to the reduction in spatial resolution. The same rea-
soning applies to the sound time.

The imposition of boundary conditions on the velocity
is illustrated in Fig.9. In the ﬁgure the boundary “w”
is placed at the interface between cells 0 and 1. The
ﬂuid region corresponds to cell 0 and continues to the
right, while cells 1 and 2 (in grey) are ghost cells which
are used to impose the desired mechanical behaviour at
the boundary “w”.
In order to close the system, we
need to evaluate the momentum ﬂux across the inter-
face w. As at any other cell interface, we approximate
Πw · ew = [(Π0 + Π1)/2] · ew, where ew is the surface
unit vector (in this case e01). Hence we require knowl-
edge of Π1, the stress tensor in the ﬁrst ghost cell as
can also be inferred from Eq. (6) when evaluated at the
boundary cell “0”. According to the constitutive relation
Π1 ∝ ∇v1. Hence, a secondary ghost cell (#2 in Fig.9)
is required to evaluate the velocity gradient via the cen-
tral diﬀerence scheme: ∇v1 · ew = (2δ)−1(v0 − v2) · ew
(where δ is the spatial resolution). This closes the set of
equations for the velocity at the ghost wall cells. This pro-
cedure enables certain ﬂexibility: one can either impose
the value of the momentum ﬂux Πw · ew (von Neumann
boundary condition), a generalized relation involving the
ﬂuid velocity at the wall Πw · ew ∝ vw (Maxwell relation
for ﬂuid slip [37]) or the more standard no-slip condi-
tion, vw = Uwall (Dirichlet boundary condition). In the
present work we assume no-slip at the wall and set the
velocity of the ghost cells accordingly to a linear interpo-
lation of the velocity; with vw = Uwall we ﬁnd

v1 = 2 Uwall − v0,
v2 = 4 Uwall − 3v0.

(15)

More general slip boundary conditions can be obtained
by choosing a diﬀerent value for vw. As is customary,
the density at the wall is uniquely controlled by the ﬂuid,
meaning that Mw = M0 = M1 = M2 [22].

B. Couette, Poiseuille and cavity ﬂows

Stochastic and deterministic simulations for three dif-
ferent ﬂow situations (Couette, Poiseuille and cavity
ﬂow) have also been performed, displaying good com-
parisons with theoretical predictions. Figures 10 and 11
show stationary ﬂuctuating (and deterministic) ﬂows for
argon at ambient temperature and mass density ρ0 =
0.599 g/mol/˚A3. The simulations are performed using

8

(a)

argon

)
s
p
(
 
e
m

i
t
 
g
n
i
x
a
l
e
r
 
r
a
e
h
s

4
10

102

0

10

102

103

o

λ (A)

(b)

argon

104

102

)
s
p
(
 
e
m

i
t
 
n
o
i
t
a
u
n
e
t
t
a
 
d
n
u
o
s

100

101

water

102

o

λ  (A)

103

(c)

103

102

)
s
p
(
 
d
o
i
r
e
p
 
d
n
u
o
s

101

101

argon

water

102

103

o

 λ (A)

104

FIG. 8: The best ﬁts to the decay times obtained from the time correlations of the Fourier modes of wavelength λ = 2π/k.
Symbols correspond to numerical results and lines to theoretical predictions (see Eqs. (14)). (a) Shear decay times: the lines
are the theoretical results (k2ν)−1, (b) sound attenuation time (k2ΓT )−1 and (c) the sound period λ/cT . Circles are obtained
from the imaginary part of hh(k, τ )h(k, 0)i and squares from the real part, where h = v⊥ (transversal velocity) in (a) while
h = ρ in (b) and (c) (similar results, not shown, were obtained for the longitudinal velocity vk). Results for water (cT = 14.75
˚A/ps, ν = 84.98 ˚A2/ps and ζ/ρ = 201.02 ˚A2/ps) correspond to the simulations illustrated in Fig.7, while argon (cT = 5.61
˚A/ps) corresponds to ρ = 0.6 g/mol/˚A3 and T = 300 K in the same box used in Fig.7.

2

1

0

w

)
s
p
/
A
o

(
 
x

V

4

2

0

−2

−4

0

o

)
s
p
/
A

(
 
x
V

3

2

1

0

−1

FIG. 9: Boundary conditions imposed at the interface “w”.
Cell 0 represents a ﬂuid cell, and cells 1 and 2 are ghost cells.
Arrows indicate the velocity vectors in a case with zero ve-
locity imposed at “w” (no-slip boundary condition and rigid
wall at rest).

10 × 10 × 10 cells representing a periodic box of size
200 × 200 × 200 ˚A3. The ﬂuid is conﬁned in a chan-
nel deﬁned by two inﬁnite parallel planes orthogonal to
the z axis. In this particular geometry the ﬁrst two and
last two layers of particles in the z direction are ghost
particles belonging to the walls; the no-slip condition is
satisﬁed at z1 = 30 ˚A and z2 = 150 ˚A, so the ﬂuid is
conﬁned in a region of width 120 ˚A.

A Couette ﬂow is shown in Fig.10. We plot the x
component of the stationary velocity ﬁeld in the z direc-
tion. The wall amplitude velocity has been set at 2.04
˚A/ps, while the amplitude of ﬂuid velocity ﬂuctuations
is about 0.5 ˚A/ps, for the temperature and cell volume
considered. The inset picture corresponds to an equiva-
lent simulation but with the thermal ﬂuctuations within
the pressure tensor switched oﬀ. In this limit, we recover
standard Navier-Stokes behaviour.

Figure 11 shows the x component of the stationary
velocity ﬁeld in the z direction for a Poiseuille ﬂow. The
applied gravity force in this case is 0.0174 ˚A/ps2. The
same simulation performed without thermal ﬂuctuations

0 20 40 60 80 100120140160180
o
z (A)

20 40 60 80 100 120 140 160 180

o

z (A)

FIG. 10: Stationary Couette proﬁle according to ﬂuctuating
hydrodynamics: The diamonds are simulation results and the
continuous line is the theoretical stationary linear proﬁle. The
wall velocity has been set 2.04 ˚A/ps. The inset ﬁgure shows a
deterministic Navier-Stokes simulation with the same param-
eters. Vertical dashed lines represent the boundary walls.

is displayed in the inset picture and both are compared
with the theoretical solution.

We have also carried out simulations of cavity ﬂow for
(TIP3P) water depicted in Fig.12 within a domain of di-
mensions 1500 × 1500 × 50 ˚A3 and mesh 30 × 30 × 1. The
wall is moving at a constant speed of 1 ˚A/ps in the y di-
rection. The average ﬂow corresponding to averaging the
ﬂuctuating hydrodynamics result (Fig. 12b) corresponds
to the ﬂuctuation-less ﬂow of Fig. 12a. Although this is
quite a large ﬂuid domain, thermodynamic ﬂuctuations
are still very visible and have a major eﬀect on the ﬂow.
For smaller domains the stationary circulatory ﬂow can
be completely nulliﬁed by the ﬂuctuations. This kind
of cavities can be used as mixers in microﬂuidics appli-
cations, but the extent of the mixing is aﬀected by the
magnitude of the ﬂuctuations.

)
s
p
/
A

(
 
x

V

o

2

1

0

−1

−2

−3

o

)
s
p
/
A

(
 

Vx

1.5

1.0

0.5

0.0

−0.5

−1.0

−1.5

0 20 40 60 80100120140160180
z (A)
0 20 40 60 80 100 120 140 160 180
z (A)

o

o

FIG. 11: Stationary Poiseuille proﬁle according to ﬂuctuating
hydrodynamics: Diamonds correspond to simulation results
and the continuous line is the theoretical proﬁle associated
with Navier-Stokes ﬂow. The inset ﬁgure shows the same ﬂow
case for a purely deterministic simulation. In both ﬁgures, the
vertical dashed lines represent the walls.

FIG. 12: Streamline plots of a cavity ﬂow for TIP3P water
model in the stationary regime. The wall velocity along y is
1 ˚A/ps, and the temperature is 300 K. The dimensions of the
cavity are 1500 × 1500 × 50 ˚A3 and the mesh is 30 × 30 × 1.
In (a) thermal ﬂuctuations of the pressure tensors are not
present, and the Navier-Stokes solution recovered. In (b) we
show the ﬂuctuating hydrodynamics solution.

VI. SUMMARY

We have derived a ﬁnite volume discretization of the
equations of ﬂuctuating hydrodynamics. The model pro-
vides a good representation of the thermodynamic ﬂuc-

9

tuations which are important at the mesoscale, typically
in the nanometer range, as well as the hydrodynam-
ics. We have tested the model in equilibrium and non-
equilibrium situations. Simple no-slip boundary condi-
tions have been used and tested in three ﬂow situations
Couette, Poiseuille and cavity ﬂow. From a set of molec-
ular dynamics simulations, we have also derived a simple
approximation to the equations of state for the TIP3P
water model and for argon which permit us to simulate
these compressible ﬂuids at ambient temperatures (ca 300
K) and pressures around 1 atm.

There are some aspects of the model which could be
improved and we reserve for future work. The discretiza-
tion of the second order derivatives is based on a central
diﬀerence method. This approach is known to produce
instabilities which lead to a characteristic and undesir-
able alternating pattern in the velocity and density ﬁelds
[38]. However, we have found that such problems only
arise with very strong perturbations well beyond the typ-
ical ﬂows at these scales. A further important extension
is to incorporate the energy equation so as to be able
to model thermal phenomena. Finally, we have used a
very simple boundary condition appropriate for the cases
studied here: more sophisticated boundary conditions,
which may reproduce diverse molecular boundaries (e.g.
taking into account the hydrophobic hydrophilic nature
of the walls) while also retaining the ﬂuctuations, can be
devised in the framework of the hybrid models [4].

Our mesoscopic ﬂuctuating model serves to support a
wide range of applications. We are currently using it
in hybrid molecular-continuum simulations [4], with im-
plicit solvent models [9], and we plan to use it for the
study of microﬂuidic ﬂows. The use of a regular lattice
and the Eulerian description greatly simplify the imple-
mentation of this model in a serial (as here) or parallel
computing environment. As a result, we believe that it
furnishes a unique tool to explore hydrodynamics at the
nanoscale including the eﬀects of ﬂuctuations, in stand-
alone more or coupled with molecular dynamics.

Acknowledgements

GDF and PVC are grateful to EPSRC (UK) for fund-
ing the Integrative Biology project (GR/S72023). MS
is supported by the Spanish Ministerio de Educaci´on y
Ciencia project FIS2004-01934 and by Programa Pro-
pio de Investigaci´on de la UNED (2006). PVC & MS
thank EPSRC for funding RealityGrid under grant num-
ber GR/R67699, which supported MS’s 6 month visit to
the CCS at UCL during 2005. RDB acknowledges sup-
port from the EU project MERG-CT-2004-006316 and
Spanish project CTQ2004-05706/BQU. We are indebted
to A. Dejoan, P. Espa˜nol, E. Flekkoy and S. Succi for
helpful discussions.

APPENDIX A: HYDRODYNAMIC MODES

In the isothermal situations the equations that describe
the transport of mass and momentum density ﬁelds are

∂tρ = −∇ · g,
∂tg = −∇ · (gv) − ∇p + η∇2v +

+ ζ

∇ (∇ · v) .

η
3

(cid:16)

(cid:17)

(A1)

The equilibrium state is characterized by a constant den-
sity ﬁeld ρe and a zero momentum density ﬁeld ge = 0
because the ﬂuid is at rest. For ﬂuctuations of small
enough amplitude, the relaxation towards equilibrium is
governed by the linearized version of the mass and mo-
mentum Eqs.(A1). By decomposing the hydrodynamic
ﬁelds as ρ(r, t) = ρe + δρ(r, t) and g(r, t) = δg(r, t), the
linearized version of Eqs.(A1) for the perturbations re-
sults

∂tδρ = −∇ · δg,
∂tδg = −∇p + ν∇2δg + νB∇ (∇ · δg) ,

(A2)

with the usual deﬁnitions for the kinematic shear vis-
cosity ν ≡ η/ρe and the eﬀective bulk viscosity νB ≡
(η/3 + ζ)/ρe.

Under isothermal conditions the thermodynamic rela-
tion of pressure perturbation δp with density and tem-
perature becomes simply [39],

δp(ρ, T ) = c2

T (ρ)δρ,

(A3)

T ≡ (∂p/∂ρ)T is the squared isothermal sound

Let us consider a general solution as a series of normal

where c2
velocity.

modes

a(r, t) = a(k, t)eik·r

,

where we have gathered the hydrodynamic variables in
the array a = {δρ, δg}. Taking the Fourier transform in
Eqs. (A2) one gets the equations a(k, t). In the linear
regime there is no coupling between modes and without
loss of generality one can work in the reference system
for which the wave vector is k = (k, 0, 0),

10

(A7)

(A8)

H provide the growth rates of the normal modes of the
system given by Eq. (A4). The eigenvalues are obtained
from the roots of the characteristic equation det[H −
ω1] = 0, which results in

2

ω + νk2
(cid:1)
(cid:0)
The solutions are

ω2 + νLk2ω + c2
(cid:0)

T k2

(cid:1)

= 0.

(A6)

where we have deﬁned ΓT as the isothermal sound ab-
sorption coeﬃcient and sT as the sound speed depending
on the wave vector given by

ω1,2 = −νk2,
ω3,4 = −ΓT k2 ± isT k,

νL
2

,

ΓT =

sT =

4c2

Lk2

T − ν2
2

.

p

The ﬁrst two eigenvalues (ω1,2) correspond to the two
shear modes associated with the exponential decay of the
transversal momentum gy and gz. Sound modes corre-
spond to ω3,4. Indeed, as can be seen from Eqs. (A7)
(A8), sound is underdamped if sT is a real
and Eqs.
number. However, according to Eq. (A8) if k > 2cT /νL,
sound becomes overdamped. Nevertheless for most liq-
uids cT /νL ∼ O(1) so this anomalous solution occurs at
quite small wavelengths for which the present mesoscopic
description does not apply (at molecular lengthscales one
should consider the dependence of the transport coeﬃ-
cients on k within the generalized hydrodynamic formal-
ism [39]). As a matter of fact, the diﬀerence between sT
and cT is negligible for any mesoscopic wavelength, so
throughout the present paper we assume that sT = cT .
With this last approximation, the solution is given by

ρ(k, t) = ρe + ρ(k, 0) exp{−ΓT k2t} cos(cT kt)
exp{−ΓT k2t} sin(cT kt)ˆk · g(k, 0),

−

i
cT

g(k, t) = exp{−ΓT k2t}[cos(cT kt)ˆk · g(k, 0)

− i sin(cT kt) cT ρ(k, 0)]ˆk
1 − ˆkˆk
+ exp{−νk2t}
(cid:16)

(cid:17)

· g(k, 0)

(A9)

da(k, t)
dt

= Ha(k, t)

(A4)

where ˆk = k/|k| is the unit wave vector.

where a(k, t) = (ρ(k, t), gx(k, t), gy(k, t), gz(k, t))T and
the hydrodynamic matrix is

APPENDIX B: EQUATIONS OF STATE FOR
ARGON AND WATER VIA MOLECULAR
DYNAMICS SIMULATION

H ≡ −

0
ik
T k νLk2
ic2
0
0

0
0

0
0
νk2
0

0
0
0
νk2








,








with the kinematic longitudinal viscosity deﬁned as νL =
ν + νB. The eigenvalues of the hydrodynamic matrix

(A5)

In this section we study the equations of state for water
and also argon through molecular dynamic simulations
using the NAMD molecular dynamics code [40]. In par-
ticular, the theoretical Lennard-Jones equation of state
for argon given in Refs.[30, 31, 32] is not necessarily ex-
act because our MD simulations using the CHARMM

2400

2200

2000

1800

1600

1400

1200

1000

800

600

400

)
s
r
a
b
(
 
P

0

−500

−1000

−1500

−2000

−2500

−3000

−3500

)
s
r
a
b
(
 
P

 
 
 
 
 
 

0.45

0.5

0.6

0.65
3))
o
         (gr/(mol A

0.55
ρ

0.7

0.75

FIG. 13: Argon equation of state: Pressure (in bars) versus
mass density at temperature 300K. The simulation results
appear with error bars and the dashed line is the equation
of state for the theoretical Lennard-Jones ﬂuid in Ref.[30, 31,
32]. The continuous line is the ﬁt of the numerical data to
the second order polynomial 3088.21 − 12065.2ρ + 14765.8ρ2.

240

260

320

340

360

280

300
          T (K)

FIG. 14: Water pressure (in bars) versus temperature ob-
tained from MD simulations of the TIP3P water model (using
NAMD) at a ﬁxed density ρ = 0.55066 g/(mol ˚A3). The ∗
symbols correspond to simulations with all bonds rigid while
the (cid:3) symbols are for non rigid bonds.

11

force ﬁeld perturb the Lennard-Jones potential close to
the cutoﬀ radius, smoothing it to zero [40]. Thus we de-
cided to obtain an accurate approximation of the equa-
tion of state by directly ﬁtting the data obtained from
molecular dynamics simulations to a second order poly-
nomial. These considerations also apply for the TIP3P
water model.

We have computed the equation of state for argon in
our molecular model in the NpT ensemble at a ﬁxed tem-
perature 300 ± 4 K with 5000 argon atoms. The simula-
tions are performed with a time step ∆t = 1 fs. We have
made use of a switched Lennard-Jones potential [40] be-
tween 10 and 12 ˚A. The results are displayed in Fig.13
for the mass density. Note that the deviations between
the theoretical model and the simulation results for the
pressure can be as large as 15% in the units presented in
the graph, the simulated argon pressure always being less
than that given by the theoretical Lennard-Jones equa-
tion of state in Ref.[30, 31, 32].

Concerning the water equation of state, we have per-
formed simulations of water molecules using the TIP3P
water model [2]. In Fig.14 we present the simulation re-
sults for a range of temperatures around 300K with a
time step ∆t = 1 fs. We have chosen a ﬁxed density
ρ = 0.55066 g/(mol ˚A3) what gives (in a NVT ensemble
for a cubic periodic box of size 30 ˚A) a total of 826 water
molecules. We have also tested the eﬀect of using rigid
bonds. We see that for harmonic bonds the ﬂuctuations
in pressure are bigger compared to those of the rigid sim-
ulation providing also smaller mean average pressures in
general terms. We have also compared our results with
three analytical models for the water equation of state
presented in Ref. [33]. We observe clear deviations from
the models. Basically, all three theoretical models largely
overestimate the isothermal sound velocity at any value
of the density considered. This reinforces the necessity of
pre-calibrating the equation of state for each particular
ﬂuid considered; for instance via MD simulations as done
here.

In Fig.15 we plot the values of mass densities obtained
from water MD simulations in an NpT ensemble against
pressure (in bars) at a ﬁxed temperature 300 ± 5 K with
non-rigid water molecules and a time step ∆t = 1 fs. The
second order polynomial ﬁt used in the FH equations is
also shown in the continuous line.

[1] L. D. Landau and E. M. Lifshitz, Fluid mechanics (Perg-

67, 046704 (2003).

amon Press, New York, 1959).

[4] G. De Fabritiis, R. Delgado-Buscalioni, and P. V.

[2] W. Jorgensen, J. Chandrasekhar, J. Madura, R. Impey,

Coveney, Phys. Rev. Lett. 97, 134501 (2006).

and M. Klein, J. Chem. Phys. 79, 926 (1983).

[5] R. Delgado-Buscalioni, E. Flekkøy, and P. V. Coveney,

[3] R. Delgado-Buscalioni and P. V. Coveney, Phys. Rev. E

Europhys. Lett. 69, 959 (2005).

0.54 0.56 0.58 0.6 0.62 0.64 0.66 0.68

Phys. Rev. Lett. 58, 874 (1987).

ρ

o
(gr/(mol A

3
))

3000

2000

1000

0

−1000

−2000

−3000

)
s
r
a
b
(
 
P

 
 
 
 
 
 
 

FIG. 15: Water pressure (in bars) versus mass density for a
temperature of 300 K from MD simulations of the non-rigid
TIP3P water model (results obtained with the NAMD code).
The continuous line is the best ﬁt of the numerical data to the
second order polynomial p(ρ) = 38373.6−157398ρ+152881ρ2
bars.

[6] P. V. Coveney, G. De Fabritiis, M. Harvey, S. Pickles,
and A. Porter, Comp. Phys. Comm. 175, 389 (2006).
[7] J. Atencia and D. J. Beebe, Nature 437, 648 (2005).
[8] P. Ahlrichs and B. Dunweg, J. Chem. Phys. 111, 8225

[9] G. De Fabritiis, G. Giupponi, and P. V. Coveney, preprint

(1999).

(2006).

[10] P. Espa˜nol, Trends in Nanoscale Mechanics: Analysis of
Nanostructured Materials and Multi-Scale Modeling (V.
M. Harik and M. D. Salas editors (Kluwer), 2003).
[11] S. Succi, The Lattice Boltzmann Equation for Fluid Dy-
namics and Beyond (Oxford University Press, 2001).
[12] A. Malevanets and R. Kapral, J. Chem. Phys. 110, 8605

[13] P. J. Hoogergrugge and J. M. V. A. Koelman, Europhys.

[14] P. Espa˜nol and P. Warren, Europhys. Lett. 30, 191

[15] R. Benzi, S. Succi, and M. Vergassola, Phys. Rep. 222,

(1999).

Lett. 19, 155 (1992).

(1995).

145 (1992).

12

[16] S. S. Chikatamarla and I. V. karlin, Phys. Rev. Lett. 97,

[17] F. J. Higuera, S. Succi, and R. Benzi, Europhys. Lett. 9,

190601 (2006).

345 (1989).

[18] S. Succi, O. Filippova, G. Smith, and E. Kaxiras, Com-

puting in Science and Engineering 03, 26 (2001).

[19] O. B. Usta, A. J. C. Ladd, and J. E. Butler, J. Chem.

Phys. 122, 094902 (pages 11) (2005).

[20] A. J. C. Ladd, J. Fluid Mech. 271, 331 (1994).
[21] R. Adhikari, K. Stratford, M. E. Cates, and A. J. Wagner,

Europhys. Lett. 71, 473 (2005).

[22] A. L. Garcia, M. M. Mansour, G. C. Lie, and E. Clementi,

J. Stat. Phys. 47, 209 (1987).

[23] M. Serrano and P. Espa˜nol, Phys. Rev. E 64, 046115

(2001).

[24] M. M. Mansour, A. L. Garcia, G. C. Lie, and E. Clementi,

[25] H. C. ¨Ottinger, Phys. Rev. E 57, 1416 (1998).
[26] E. G. Flekkøy, P. V. Coveney, and G. De Fabritiis, Phys.

Rev. E 62, 2140 (2000).

[27] P. E. Kloeden and E. Platen, Numerical solution of
stochastic diﬀerential equations (Springer-Verlag, Berlin,
1992).

[28] G. De Fabritiis, M. Serrano, P. Espa˜nol, and P. V.

Coveney, Physica A 361, 429 (2006).

[29] M. Serrano, G. De Fabritiis, P. Espa˜nol, and P. V.
Coveney, Math. Comput. Simulat. 72, 190 (2006).
[30] K. Johnson, J. A. Zollweg, and K. E. Gubbins, Mol. Phys.

[31] D. M. Heyes, Chem. Phys. Lett. 153, 319 (1988).
[32] P. Borgelt, C. Hoheisel, and G. Stell, Phys. Rev. E 42,

78, 591 (1993).

789 (1990).

[33] C. Jeﬀrey and P. Austin, J. Chem. Phys. 110, 484 (1999).
[34] G. Guo and Y. Zhang, Mol. Phys. 99, 283 (2001).
[35] M. Grmela and H. C. ¨Ottinger, Phys. Rev. E 56, 6620

(1997).

[36] J. Keizer, Statistical thermodynamics of nonequilibrium

processes (Springer-Verlag, New York, 1987).

[37] C. Neto, D. R. Evans, E. Bonaccurso, H.-J. Butt, and
V. S. J. Craig, Reports on Progress in Physics 68, 2859
(2005).

[38] S. V. Patankar, Numerical heat transfer and ﬂuid ﬂow

(Taylor&Francis, 1980).

[39] J. P. Boon and S. Yip, Molecular Hydrodynamics (Mc-

Graw Hill, New York, 1980).

[40] J. C. Phillips, R. Braun, W. Wang, J. Gumbart,
E. Tajkhorshid, E. Villa, C. Chipot, R. D. Skeel, L. Kal´e,
and K. Schulten, J. Comp. Chem. 26, 1781 (2005).

