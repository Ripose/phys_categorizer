5
0
0
2
 
p
e
S
 
1
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
6
0
0
9
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Numerical modeling of quasiplanar giant water waves

Victor P. Ruban1∗ and J¨urgen Dreher2†
1Landau Institute for Theoretical Physics, 2 Kosygin Street, 119334 Moscow, Russia and
2Theoretische Physik I, Ruhr-Universit¨at Bochum, Germany
(Dated: February 2, 2008)

In this work we present a further analytical development and a numerical implementation of
the recently suggested theoretical model for highly nonlinear potential long-crested water waves,
where weak three-dimensional eﬀects are included as small corrections to exact two-dimensional
equations written in the conformal variables [V.P. Ruban, Phys. Rev. E 71, 055303(R) (2005)].
Numerical experiments based on this theory describe the spontaneous formation of a single weakly
three-dimensional large-amplitude wave (alternatively called freak, killer, rogue or giant wave) on
the deep water.

PACS numbers: 47.15.Hg, 02.60.Cb, 92.10.-c

I.

INTRODUCTION

→

Rogue waves are extremely high, steep and dangerous
individual waves which sometimes appear suddenly on a
sea surface among relatively low waves (see, for instance,
the recent works [1, 2, 3], and references therein). The
crest of a rogue wave can be three or even more times
higher than the crests of neighboring waves. Diﬀerent
physical mechanisms contribute to the rogue wave phe-
nomenon: dispersion enhancement, geometrical focusing,
wave-current interaction [1], but the most important at
the ﬁnal stage is the nonlinear self-focusing mechanism
resulting in accumulation of the wave energy and momen-
tum on the scale of a single wavelength [3]. For weakly
modulated periodic planar Stokes waves this mechanism
leads to the well-known Benjamin-Feir instability [4, 5],
generated by four-wave nonlinear resonant interactions
2. This instability is predominantly two-dimensional
2
(2D), and it is dominant for low amplitudes (h/λ
0.09
where h is the peak-to-trough height and λ is the length
of the Stokes wave [6]). For larger steepness parameter
h/λ, another, genuinely three-dimensional (3D), instabil-
ity becomes dominant, which is generated by ﬁve-wave
interactions 3
2, and results in the well-known cres-
cent, or “horse-shoe” wave patterns (see [7, 8, 9], and
references therein). It is important that real ocean giant
waves are observed in situations when this 3D instabil-
ity is not principal, and all the waves are typically long-
crested, corresponding to a narrow-angle Fourier spec-
trum. Thus, many essential features of a rogue wave
formation can be observed already in purely 2D geome-
try, as in the works by Zakharov and co-workers [2, 3].
For instance, in Ref. [3] a numerical giant wave was com-
106
puted with the impressive spatial resolution of up to 2
points. Zakharov and co-workers simulated an exact sys-
tem of dynamic equations for 2D free-surface inviscid po-
tential ﬂows, written in terms of the so called confor-

→

≤

·

∗Electronic address: ruban@itp.ac.ru
†Electronic address: dreher@tp1.rub.de

mal variables, which make the free boundary eﬀectively
ﬂat (the corresponding exact 2D theory is described in
Refs. [10, 11, 12, 13, 14, 15, 16]). With these variables,
highly nonlinear equations of motion for planar water
waves are represented in an exact and compact form con-
taining integral operators diagonal in the Fourier repre-
sentation. Such integro-diﬀerential equations are easy to
treat numerically with modern libraries for the discrete
fast Fourier transform (FFT) as, for example, FFTW
[17]. Recently, by introducing an additional conformal
mapping, the exact 2D conformal description has been
generalized to non-uniform and time-dependent bottom
proﬁles, so that a very accurate 2D modeling of near-
coastal waves and tsunami-like processes has been possi-
ble [18, 19].

However, real sea waves are never ideally planar, and
the second horizontal dimension might play an impor-
tant role in the wave dynamics. Various numerical meth-
ods have been developed for nonlinear 3D surface gravity
waves (see [9, 20, 21] for a review). Some of them are
based on exact formulation of the problem (the bound-
ary integral method and its modiﬁcations; see [22, 23, 24]
and references therein), another approach uses approxi-
mate equations of motion, as the Boussinesq-type mod-
els [25, 26], the equations derived by Matsuno [27],
by Choi [28], the weakly nonlinear Zakharov equations
[29, 30], or the equations for wave packets — the non-
linear Schroedinger equation (NLS) and its extensions
[31, 32, 33, 34]. The numerical methods based on exact
equations are quite “expensive” and thus provide a rela-
tively low spatial resolution (typically 128
64, as in the
recent work [24] for essentially 3D waves). On the other
hand, the applicability of the approximate equations is
limited by the condition that the waves must not be too
steep. To ﬁll this gap, some new approximate, relatively
compact explicit equations of motion for highly nonlinear
3D waves were needed as the basis for a new numerical
method. Recently, as an extension of the exact conformal
2D theory, a weakly 3D conformal theory has been sug-
gested [35], which is valid for steep long-crested waves.
Equations of this theory contain 3D corrections of the or-
der of ǫ = (lx/lq)2, where lx is a typical wave length, and

×

lq is a large transversal scale along the wave crests. In
Ref. [35], the general case was considered, with a static
nonuniform quasi-one-dimensional bottom proﬁle. Since
the corresponding general equations are rather involved,
it is natural to focus on some simple particular cases in
the ﬁrst place, for instance on the deep water limit. The
purpose of the present work is a further development of
the weakly 3D conformal theory and its numerical imple-
mentation for the most simple deep water case. Our main
result here is that we have developed a numerical scheme
based on FFT which is suﬃciently simple, accurate and
fast simultaneously. As an application, we have simu-
lated a freak wave formation with the ﬁnal resolution up
to 16384

256.

This article is organized as follows. In Sec. II we adopt
for the deep water limit the general weaky 3D fully non-
linear theory described in Ref. [35]. We also suggest some
modiﬁcation of the obtained dynamical system which re-
sults in the correct linear dispersion relation not only
within a small region near the k1-axis, but in the whole
Fourier-plane.
In Sec. III we describe our numerical
method and present numerical results for the problem
of a rogue wave formation. Finally, Sec. IV contains our
summary and discussion.

×

II. WEAKLY 3D NONLINEAR THEORY

2

R

˜
dt = 0,
L

in accordance with the variational principle δ
where the Lagrangian is ˜
.
L

ψηt dx dq

− H

=

≤

≈

0.1/π

In the traditional approach, the problem is partly
R
solved by an asymptotic expansion of the kinetic energy
on a small parameter — the steepness of the surface
K
(see Refs.
[30, 36, 38], and references therein). As the
result, a weakly nonlinear theory is generated, which is
not good to describe large-amplitude steep waves [see
Ref. [38] for a discussion about the limits of such theory;
practically, the wave steepness ka (k is a wave number,
a is an amplitude) should be not more than 0.1 (that
is h/λ
0.03)]. Below in this section we con-
sider a diﬀerent, recently developed theory [35] (adopted
here for the case of inﬁnite depth), which is based on an-
other small parameter — the ratio of a typical length
of the waves propagating along the x-axis, to a large
scale along the transversal horizontal direction, denoted
by q [alternatively, it is the ratio of typical wave num-
bers kq/kx in the Fourier plane (kx, kq)]. Thus, we deﬁne
ǫ = (lx/lq)2
1 and note: the less this parameter, the
less our ﬂow diﬀers from a purely 2D ﬂow, and the more
accurate the equations are. A proﬁle y = η(x, q, t) of the
free surface and a boundary value of the velocity poten-
tial ψ(x, q, t)
ϕ(x, η(x, q, t), q, t) are allowed to depend
strongly on the coordinate x, while the derivatives over
the coordinate q will be small:

ǫ1/2,

ǫ1/2.

≪

≡

ηq| ∼
|

ψq| ∼
|

A. General remarks

B. Conformal variables in 3D

It is a well known fact that a principal diﬃculty in
the 3D theory of potential water waves is the general
impossibility to solve exactly the Laplace equation for
the velocity potential ϕ(x, y, q, t),

In the same manner as in the exact 2D theory [10,
13], instead of the Cartesian coordinates x and y, we use
curvilinear conformal coordinates u and v, which make
the free surface eﬀectively ﬂat:

ϕxx + ϕyy + ϕqq = 0,

in the ﬂow region
boundary conditions

−∞ ≤

≤

y

η(x, q, t), with the given

|y=η(x,q,t) = ψ(x, q, t), ϕ
ϕ

|y=−∞ = 0.

(Here x and q are the horizontal Cartesian coordinates,
y is the vertical coordinate, while the symbol z will be
used for the complex combination z = x + iy). There-
fore a compact expression is absent for the Hamiltonian
functional of the system,

η, ψ

=

H{

}

dx dq

(ϕ2

x + ϕ2

y + ϕ2

q)dy

η(x,q,t)

Z−∞

η2dx dq

η, ψ

+

≡ K{

}

η

,

P{

}

(3)

R

(the sum of the kinetic energy of the ﬂuid and the po-
tential energy in the vertical gravitational ﬁeld g). The
Hamiltonian determines canonical equations of motion
(see [30, 36, 37], and references therein)

ηt = (δ

/δψ),

H

ψt = (δ

/δη)

H

−

(4)

1
2

+

Z
g
2

Z

(1)

(2)

x + iy

z = z(u + iv, q, t),

v

0,

(5)

≡

−∞ ≤

≤

where z(w, q, t) is an analytical on the complex variable
u+iv function without any singularities in the lower
w
half-plane
0. The proﬁle of the free surface is
now given in a parametric form by the formula

−∞ ≤

≡

≤

v

X(u, q, t) + iY (u, q, t)

Z(u, q, t) = z(u + 0i, q, t). (6)

≡

Here the real functions X(u, q, t) and Y (u, q, t) are re-
lated to each other by the Hilbert transform ˆH:

X(u, q, t) = u

ˆHY (u, q, t).

−
The Hilbert operator ˆH is diagonal in the Fourier repre-
sentation: it multiplies the Fourier-harmonics Yk(q, t)

Y (u, q, t)e−ikudu by i sign k, so that

(7)

≡

ˆHY (u, q, t) =

[i sign k]Yk(q, t)eiku(dk/2π).

(8)

Z

The boundary value of the velocity potential is ϕ
ψ(u, q, t).

|v=0 ≡
For equations to be shorter, below we do not indicate
the arguments (u, q, t) of the functions ψ, Z and ¯Z (the

overline denotes complex conjugate). The Lagrangian for
3D deep water waves in terms of the variables ψ, Z, and
¯Z can be written as follows (compare with [35]):

=

L

−

+

¯ZtZu

Zt ¯Zu −
2i
¯Z

Z

Z (cid:20)
g
2

Z (cid:20)
Λ

ˆH
(cid:20)

Z

−
2i

(cid:18)

Z

(cid:20)
¯Z

(cid:21)

−
2i

ψ du dq

ψ, Z, ¯Z

}

− K{

2

(cid:21)
Zu + ¯Zu
2

du dq

(cid:21)
Z + ¯Z

+

(cid:19)

(cid:18)

2 −

(cid:19)(cid:21)

u

du dq, (9)

where the indeﬁnite real Lagrangian multiplier Λ(u, q, t)
has been introduced in order to take into account the
relation (7). Equations of motion follow from the varia-
dt. So,
tional principle δ
variation by δψ gives us the ﬁrst equation of motion —
the kinematic condition on the free surface

= 0, with the action

A ≡

A

L

R

Im (Zt ¯Zu) = (δ

/δψ).

(10)

K
2 and use analytical
Let us divide this equation by
Zu|
|
properties of the function Zt/Zu. As a result, we obtain
the time-derivative-resolved equation

(1).

K

Zt = iZu(1 + i ˆH)

(cid:20)
Further, variation of the action
second equation of motion:

A

(δ

.

/δψ)
K
2
Zu|
|
by δZ gives us the

(11)

(cid:21)

ψt ¯Zu

ψu ¯Zt −
2i

(cid:20)

δ
K
δZ

(cid:21)

(cid:18)

(cid:19)

=

+

Im

Z

( ˆH

¯Zu −

i)Λ

.

−
2i

(12)

(cid:16)

(cid:17)
2iZu we have

After multiplying Eq.(12) by

g
2i

−

Zu|
[ψt + g Im Z]
|

−

2

ψu ¯ZtZu = (i

ˆH)˜Λ

−

(13)
where ˜Λ is another real function. Taking the imaginary
part of Eq.(13) and using Eq.(10), we ﬁnd ˜Λ:

2i

−

δ
K
δZ

(cid:18)

(cid:19)

Zu,

˜Λ =

ψu

+ 2 Re

δ
K
δψ

(cid:21)

(cid:20)

δ
K
δZ

(cid:20)(cid:18)

(cid:19)

(cid:21)

Zu

.

(14)

After that, the real part of Eq.(13) gives us the Bernoulli
equation in a general form:

(cid:21)

(cid:16)

+

−

−

(δ

(1

Im

ψt =

ψu ˆH

g Im Z

−
(cid:20)
i ˆH) [2(δ

/δψ)
K
2
Zu|
|
/δZ)Zu + (δ
Zu|
|
Equations (11) and (15) completely determine evolu-
tion of the system, provided the kinetic energy functional
is explicitly given. It should be emphasized
re-
1,

K{
that in our description a general expression for
mains unknown. However, under the conditions

/δψ)ψu]

ψ, Z, ¯Z

.(15)
(cid:17)

K

K

}

2

K
zq| ≪
|

3

1, the potential ϕ(u, v, q, t) is eﬃciently expanded

ϕq| ≪
|
into a series on the powers of the small parameter ǫ:

ϕ = ϕ(0) + ϕ(1) + ϕ(2) + . . . ,

ϕ(n)

ǫn,

∼

(16)

where ϕ(n+1) can be calculated from ϕ(n), and the zeroth-
order term ϕ(0) = Re φ(w, q, t) is the real part of an easily
represented (in integral form) analytical function with
the boundary condition Re φ
|v=0 = ψ(u, q, t). Corre-
spondingly, the kinetic energy functional will be written
in the form

=

(0) +

(1) + . . . ,

K

K

(n)

K

∼

ǫn,

(17)

where

is the kinetic energy of a purely 2D ﬂow,

=

=

1
2

Z
1
2

−

Z

[(ϕ(0)

u )2 + (ϕ(0)

v )2] du dv dq

ψ ˆHψu du dq,

(18)

and the other terms are corrections due to gradients along
q. Now we are going to calculate a ﬁrst-order correction

K
(0)

ψ

{

}

(0)

ψ

{

}

K

K

C. First-order corrections

As a result of the conformal change of two variables,
the kinetic energy functional is determined by the expres-
sion

=

K

1
2

Z

(cid:2)

u + ϕ2
ϕ2

v + J(Q

ϕ)2

du dv dq,

(19)

· ∇

(cid:3)

where the Cauchy-Riemann conditions xu = yv, xv =
yu have been taken into account, and the following no-

−
tations are used:

J

2,
zu|

≡ |

(Q

ϕ)

· ∇

≡

aϕu + bϕv + ϕq,

a =

xqyv

xvyq −
J

∼

ǫ1/2,

b =

yqxu

yuxq −
J

ǫ1/2.

∼

Consequently, the Laplace equation in the new coordi-
nates takes the form

ϕuu + ϕvv +

(QJ(Q

ϕ)) = 0,

(20)

∇ ·

· ∇

with the boundary conditions

|v=0 = ψ(u, q, t), ϕ
ϕ

|v=−∞ = 0.

(21)

≪

In the limit ǫ
1 it is possible to write the solution as
the series (16), with the zeroth-order term satisfying the
2D Laplace equation ϕ(0)
(0)
uu + ϕ(0)
v=0 = ψ(u, q, t).
vv = 0, ϕ
|
Thus, it can be represented as ϕ(0) = Re φ(w, q, t), where

φ(w, q, t) =

+∞

−∞

Z

(1

−

sign k)ψk(q, t)eikw dk
2π

,

(22)

and ψk(q, t)

≡

ψ(u, q, t)e−ikudu. On the free surface

φ(u + i0, q, t)
R

Ψ(u, q, t) = (1 + i ˆH)ψ(u, q, t).

(23)

≡

For all the other terms in Eq.(16) we have the relations

vv

+

∇ ·

(QJ(Q

ϕ(n+1)
uu + ϕ(n+1)

ϕ(n))) = 0
(24)
· ∇
and the boundary conditions ϕ(n+1)
|v=0 = 0. Noting
u + ϕ(0)
that
v ) du dv = 0 (it is easily seen
without explicit calculation of ϕ(1) after integration by
parts), we have in the ﬁrst approximation

u ϕ(1)

v ϕ(1)

(ϕ(0)

R

1
2

1
2

Z

(1) =

K

J(ϕ(0)

q + aϕ(0)

u + bϕ(0)

v )2du dv dq

=

Re

zu ¯zu

φq −
(cid:18)
Since z(w) and φ(w) are represented as z(u + iv) =
e−ˆkvZ(u) and φ(u + iv) = e−ˆkvΨ(u), we can use for v-
integration the following auxiliary formulas:

du dv dq. (25)

Z

(cid:20)

2

φuzq
zu (cid:19)(cid:21)

[e−ˆkvA(u)][e−ˆkvB(u)] dv =

0

AkBk
2k

dk
2π

−

−∞

Z

du

i
2

−

Z
=

0

−∞

Z

Z (cid:16)

B(u) ˆ∂−1

u A(u)

du.

(cid:17)

Now we apply the above formulas to appropriately de-
composed Eq.(25) and, as a result, we obtain an expres-
, where the functional
Ψ, Ψ, Z, Z
sion of a form

(1) =

F {
is deﬁned as follows (compare with [35])

K

}

F

F

=

+

i
8

Z
i
16

(ZuΨq −

ZqΨu) ˆ∂−1

u (ZuΨq −

ZqΨu) du dq

(ZuΨq −
Z (
(cid:2)

ZqΨu)2/Zu

(Z

u)

−

(cid:3)
ZqΨu)2/Zu]

(Z

u) [(ZuΨq −

−

−

Here the combination (Z
u) is written instead of Z
−
just for convenience, as it is ﬁnite at the inﬁnity. Ac-
tually the equations of motion “do not feel” this dif-
ference.
In the derivation we have used the identity
ZqΨu)2/Zu]udu = 0, which holds because the
[(ZuΨq −
integrand is analytical in the lower half-plane. From here
R
(1)/δψ)
one can express the variational derivatives (δ
and (δ

(1)/δZ) by the formulas

K

K
(1)

δ

K
δψ

= 2 Re

(1

(cid:20)
The derivatives (δ
F
a standard manner:

δ
F
δΨ

=

Zq

i
8

i ˆH)

−

δ
F
δΨ

,

(cid:21)

(1)

δ

K
δZ

=

δ
F
δZ

.

(28)

/δΨ) and (δ

/δZ) are calculated in

F

(ZuΨq −
h

ZqΨu)
+ ˆ∂u[(Ψq −
ˆ∂−1
u (ZuΨq −
h
+(Ψq −

i
8

−

Zu ˆ∂q

ZqΨu/Zu)(Z

u)]

−

i

ZqΨu)

ZqΨu/Zu)(Z

u)

,

(29)

−

i

4

δ
F
δZ

=

−

Ψq

i
8

i
8

h

ZqΨu)

(ZuΨq −
+ ˆ∂u[(Ψq −
ˆ∂−1
u (ZuΨq −

+

Ψu ˆ∂q

+

i
16

h
+(Ψq −
ˆ∂u[(Ψq −
(Ψq −

−

h

ZqΨu/Zu)(Z

u)]

−

i

ZqΨu)

ZqΨu/Zu)(Z

u)

ZqΨu/Zu)2(Z

−
ZqΨu/Zu)2Zu

−

i

u)]

.

i

(30)

(1)/δψ)
Now one can substitute (δ
(1)/δZ) into the equations of motion
and (δ
(11) and (15). Thus, the required weakly 3D equations
for deep water waves are completely derived:

ˆHψu + (δ

/δZ)

/δψ)

≈ −

(δ

≈

K

K

K

K

Z = u + (i

ˆH)Y (u, q, t), Zu = 1 + (i

ˆH)Yu. (31)

−

−

(26)

Zt =

iZu(1 + i ˆH)

−

[ ˆHψu −
h

(δ

(1)/δψ)]/

K

2

Zu|
|

i

,

(32)

ψt =

−
+ ˆH

(δ

(1)/δψ)]/

g Y + ψu ˆH
[ ˆHψu −
h
ψu[ ˆHψu −
(δ
h
2 Re

K
( ˆH + i)[Zu(δ
(cid:16)

K

K
(1)/δψ)]

2

/

Zu|
|
(1)/δZ)]
/

i

(cid:17)

2.
Zu|
|

−

2

Zu|
|

i

(33)

D. Modiﬁcation of the Hamiltonian

du dq.(27)

)

It can be easily obtained that the linear dispersion re-

lation for the system (27)-(33) is

ω2(k, m) = g

1 +

k
|

|

(cid:18)

1
2

m2
k2

,

(cid:19)

(34)

where m is the wave-number in the q-direction (the wave-
number k in the u-direction was introduced earlier). Ob-
viously, here we have the ﬁrst two terms from the expan-
sion of the exact 3D linear dispersion relation

ω2(k, m) = g

k2 + m2

(35)

p

≪

on the powers of m2/k2
1. Thus, the system (27)-(33)
has a non-physical singularity in the dispersion relation
near the m-axis in the Fourier plane (k, m), where k/m
→
0. Therefore, for convenience of the numerical modeling,
some regularization could be useful in the approximate
Hamiltonian
is the potential
energy,

, where

(1) +

(0) +

K

K

P

P

=

P

g
2

Z

2

¯Z

−
2i

Zu + ¯Zu
2

Z (cid:20)

(cid:21)

(cid:20)

(cid:21)

du dq.

(36)

Also, the correct linear dispersion relation is strongly de-
sirable, since it determines which waves interact by non-
linear resonances. Of course, a possible regularization is
not unique as we keep only zeroth- and ﬁrst-order terms
on ǫ = (m/k)2 in the Hamiltonian. Below we suggest a
(ǫ2) to the
modiﬁcation which adds terms of the order
(1) (a modiﬁed
approximate Hamiltonian
K
Hamiltonian ˜
will remain valid up to ǫ). First
=
H
(0) we use another
of all, instead of the the functional
ψ ˆG0ψ du dq, where the linear
(0)
functional,
operator ˆG0 is diagonal in the Fourier representation:
R

+ ˜
K

(0) +

(1/2)

→

O

+

K

K

K

P

P

G0(k, m) =

k2 + m2

1
2

m2
k
k2 + m2 .
|
|

−

(37)

p

Besides that, we change the operator i ˆ∂−1
u = 1/k in the
ﬁrst line of Eq. (27) by the operator k/(k2 + m2) =
i ˆ∂u∆−1
2 , which is less singular. As the result, we have
the modiﬁed approximate kinetic-energy functional in
the form

=

˜
K

1
2

Z

ψ ˆG0ψ du dq + ˜
F

,

(38)

˜
F

=

+

i
8

Z

i
16

(ZuΨq −

ZqΨu) ˆ∂u∆−1

2 (ZuΨq −

ZqΨu) du dq

(ZuΨq −

ZqΨu)2/Zu

(Z

u)

−

(cid:3)
ZqΨu)2/Zu]

u) [(ZuΨq −

−

du dq. (39)

)

Z (

(cid:2)
(Z

−

The linear dispersion relation resulting from ˜
is correct
K
in the whole Fourier plane. Besides that, the zeroth-
and the ﬁrst-order terms on ǫ in ˜
are the same as in
K
(1). The system of equations, corresponding to
, consists of Eq. (31) and the

K
the modiﬁed Hamiltonian ˜
H
following equations:

(0) +

K

Zt = iZu(1 + i ˆH)

(δ ˜
K
h

/δψ)/

2

Zu|
|

,

i

ψt = Im

(1

g Y

(cid:16)
−

−

i ˆH)[2(δ ˜
F
/δψ)/

−
ψu ˆH

(δ ˜
K

h

2

Zu|
|

,

i

/δZ)Zu + (δ ˜
K

/δψ)ψu]

/

δ ˜
K
δψ

= ˆG0ψ + 2 Re

i ˆH)

(1

"

−

δ ˜
F
δΨ #

,

(40)

2

Zu|
|
(41)

(cid:17)

(42)

δ ˜
F
δΨ

=

Zq ˆ∂u

i
8

ˆ∂u∆−1
h

2 (ZuΨq −

ZqΨu)

ZqΨu/Zu)(Z

u)

i
8

−

Zu ˆ∂q

2 (ZuΨq −

ZqΨu)

+(Ψq −
ˆ∂u∆−1
h
+(Ψq −

−

−

i

i

ZqΨu/Zu)(Z

u)

, (43)

5

δ ˜
F
δZ

=

−

Ψq ˆ∂u

ˆ∂u∆−1

2 (ZuΨq −

ZqΨu)

i
8

i
8

+

i
16

+

Ψu ˆ∂q

h
+(Ψq −
ˆ∂u∆−1
h
+(Ψq −
ˆ∂u[(Ψq −
h

ZqΨu/Zu)(Z

u)

2 (ZuΨq −

ZqΨu)

ZqΨu/Zu)(Z

u)

−

i

−

−

i

u)]

ZqΨu/Zu)2(Z

(Ψq −

−

ZqΨu/Zu)2Zu

. (44)

i

These equations were integrated numerically as de-
scribed in the following section. It is interesting to note
that we also considered another choice for the regulariza-
tion, with G0 = (k2 + m2/2)(k2 + m2)−1/2 instead of
k
|
|
in
in the ﬁrst
K
(1). The numerical results were found very close
term in
in both cases, since the wave spectra were concentrated
in the region m2/k2

(0), and (k2 + m2)−1/2 instead of 1/

k
|

1.

K

|

≪

III. NUMERICAL METHOD AND RESULTS

×

In our numerical simulations, we used the following
Lq with the peri-
procedure. A rectangular domain Lu ×
odic boundary conditions in the (u, q)-plane was reduced
2π [the aspect
to the standard dimensionless size 2π
ratio ε = (Lu/Lq)2 was taken into account]. This stan-
dard square was discretized by N
L points (un, ql) =
2π(n/N, l/L), with integer n and l. The time variable
was rescaled to give g = 1. As the primary dynami-
cal variables, the (complex) Fourier components Ykm and
Pkm = (k2 + εm2)1/4ψkm were used, where k and m were
integer numbers in the limits 0
M ,
with K
3L/8. For negative k, the prop-
3N/8, M
erties Y−k,−m = Ykm and P−k,−m = Pkm were implied.
It should be noted that after rescaling u, q, and t, the
linear dispersion relation has been ωkm = (k2 + εm2)1/4,
and that the combinations

k < K,

M

m

×

≤

−

≈

≈

≤

≤

akm =

Ykm + iPkm
√2ωkm

in the linear limit coincide with the normal complex vari-
ables [13, 36].

Using the FFTW library [17], the quantities Z(un, ql),
Ψ(un, ql), their corresponding u- and q-derivatives, and
ˆG0ψ(un, ql) are represented by 2-dimensional complex ar-
rays. The variational derivatives (43), (44), (42) and
the right-hand-sides of Eqs. (40)-(41) are then computed
and transformed into Fourier space in order to evalu-
ate the multi-dimensional function which determines the
time derivatives of Ykm and Pkm. This function is used in
the standard fourth-order Runge-Kutta procedure (RK4)
for the time integration of the system. After each RK4
step, a large-wave-number ﬁltering of the arrays Ykm and
Pkm is carried out, so that only the Fourier components

]

m

[
 
 
y

 15

 10

 5

 0

-5

-10

]

m

[
 
 
y

 15

 10

 5

 0

-5

-10

6

 0

 0.5

 1

 1.5

 2.5

 3

 3.5

 4

 2
x  [km]

FIG. 2: [A]. Initial wave proﬁles for eight equidistant values
q = Lq(0, 1/8, . . . , 7/8).

FIG. 3: (Color online) [A]. Map of the free surface at t = 59.2
(the physical time is 7 min 57 sec).

 0

 0.5

 1

 1.5

 2.5

 3

 3.5

 4

 2
x  [km]

FIG. 4: [A]. Wave proﬁles at t = 59.2.

FIG. 1: (Color online) [A]. Map of the free surface at t = 0.

Mef f are kept, where
with 0
k < Kef f ,
≤
L/4. To estimate the accuracy
N/4 and Mef f ≈
Kef f ≈
of the computations, conservation of the total energy ˜
H
and the mean surface elevation are monitored.

Mef f ≤

m

≤

−

Typically, at t = 0 we put N = 212, L = 26, and
the initial time step τ = 0.01. During the computa-
tion, as wave crests become more sharp and the spec-
tra get broadened, we several times adaptively double
N (together with K, Kef f ) and L (together with M ,
Mef f ), with the time step half-decreasing when N is dou-
bled. At the end, when a giant wave is formed, we have
N = 213−14, L = 27−8. As a result of such adaptive
scheme, the conservation of the total energy is kept up
to 5-6 decimal digits during most part of the evolution.
Only at a very late stage, when N and L are not allowed
to double anymore, the conservation is just up to 3-4
digits, and the ﬁltering of the higher harmonics becomes
more inﬂuential.

The eﬃciency of the above described numerical method
crucially depends on the speed of the FFT routine, since
most of the computational time (approximately 80%) is
spent in the Fourier transforms. To compute the evolu-
tion through the unit (dimensionless) time period, on a
modern PC (Intel Pentium IV 3.2 GHz) it takes three-
four minutes with N = 4096, L = 64, τ = 0.01, and
more than one hour with N = 8192, L = 256, τ = 0.005.
The total time needed for a single numerical rogue-wave
experiment is about 3-5 days.

×

×

Two numerical experiments are reported below for hor-
4 km (the ﬁnal resolution
izontal physical box sizes of 4
was 16384
256 in both). In the ﬁrst of them, the main
mechanism for a big wave formation is the linear disper-
sion, when a group of longer waves overtakes a group of
shorter waves, and their amplitudes are added (see [1]
for a discussion). However, due to nonlinear eﬀects, in
maximum the crest is higher than simply the sum of two
amplitudes. In the second experiment, a giant wave is
formed by an essentially nonlinear mechanism (due to
Benjamin-Feir instability) from a slightly modulated pe-
riodic wave, close to a stationary Stokes wave.

]

m

[
 
 
y

 15

 10

 5

 0

-5

-10

 0

 0.5

 1

 1.5

 2.5

 3

 3.5

 4

 0

 0.5

 1

 1.5

 2.5

 3

 3.5

 4

 2
x  [km]

 2
x  [km]

FIG. 5: [B]. Wave proﬁles at t = 150 (20 min 9 sec), and at
t = 170 (22 min 50 sec).

]

m

[
 
 
y

 15

 10

 5

 0

-5

-10

]

m

[
 
 
y

 15

 10

 5

 0

-5

-10

 3.2

 3.3

 3.4

 3.5

 3.7

 3.8

 3.9

 4

 3.6
x  [km]

FIG. 6: [B]. Rogue wave at t = 172.8 (23 min 13 sec).

A. “Linear” big wave

In the ﬁrst numerical experiment (referred to as [A]),
the initial state was a composition of two spatially sepa-
rated wave groups, as shown in Fig.1. Two typical dimen-
sionless wave numbers are present, k1 = 17, correspond-
ing to the wave length λ1 ≈
235 m (at the central part of
Fig. 1) and k2 = 23 (λ2 ≈
174 m). At t = 0 the highest
crests were about 5 m in both groups (see Fig. 2). Due
−1/2), the
k
to diﬀerence in the group velocities (cgr ∼ |
|
longer waves move faster and after some time overtake
the shorter waves. As a result of almost linear superpo-
sition, big waves with high crests and deep troughs are
formed, separated by the spatial period 2π/
, with
the maximum amplitude about 12 m, which is approxi-
mately equal to the sum of the individual amplitudes (the
nonlinearity slightly increases the maximum height). The
corresponding numerical results are presented in Figs.3
and 4.

k2 −
|

k1|

B. Nonlinear big wave

Our second numerical experiment (referred to as [B])
is a weakly 3D analog of the 2D numerical experiments
performed by Zakharov and co-workers [2, 3], when a
slightly modulated periodic Stokes wave evolves to pro-

7

FIG. 7: (Color online) [B]. Map of the free surface at t =
172.8.

·

−

×

×

106

duce a giant wave. However, with two horizontal dimen-
sions we could not achieve the same very high resolution
as Zakharov with co-workers did for the case of a single
horizontal dimension (16384
256 in our experiment [B]
versus 2
1 in Ref. [3]). Our computations were
terminated well before the moment when a giant wave
reached its maximum height and began break, since the
number of the employed Fourier modes became inade-
quate. The accuracy could be better with larger N and L,
and with a smaller τ , but it required much more memory
and computational time. In general, to resolve in confor-
mal variables a sharp wave crest with a minimal radius
of curvature ρ and with the asymptotic angle 2π/3 (as
in the limiting Stokes wave), the required number Kef f
should adaptively vary as ρ−3/2λ1/2. The power
3/2
results in strong diﬃculties when ρ is small. Another im-
portant point is that Zakharov and co-workers were able
to re-formulate the purely 2D equations in terms of the
“optimal” complex variables R = 1/Zu and U = iΨu/Zu,
thus obtaining very elegant and compact cubic evolu-
tion equations (the Dyachenko equations [15]).
In our
3D case, a similar simpliﬁcation seems to be impossible,
and we dealt directly with the original conformal vari-
ables Z and Ψ. Nevertheless, our results are suﬃciently
accurate to reproduce the fact of a giant wave formation.
As the initial state for the experiment [B], we took
a weakly modulated periodic wave with the main wave
number k = 19 (λ
210 m) and with a few ﬁrst har-
monics on 2k, 3k, etc., similar to a Stokes wave (not
shown). After some period of evolution, the Benjamin-
Feir instability developed and resulted in formation of a
big wave, with the amplitude 13 m at t = 172.8 versus
the initial maximum amplitude 5 m (see Figs. 5-7 and
compare with Ref. [3]). The peak-to-trough height h∗
of this computed rogue wave was approximately 20 m
0.1), and
at t = 172.8 (the steepness parameter h∗/λ
it was still growing at that moment (so, at t = 173.0
we observed the amplitude 14 m, but the accuracy was
already not suﬃcient). It is interesting that this numeri-

≈

≈

8

cal solution has a well deﬁned envelope until a very ﬁnal
stage of evolution. Thus, our equations may serve to test
the simpliﬁed wave-packet models like the extended NLS
equations [31, 32, 33].

IV. SUMMARY AND DISCUSSION

We have developed an eﬃcient numerical method for
modeling the rogue wave phenomenon. The underlying
theory for the method is the weakly 3D formulation of
the free surface dynamics reported earlier [35] with slight
modiﬁcations. In particular, the Hamiltonian has been
regularized in a way to give the exact linear 2D disper-
sion relation in the entire Fourier space, and a ﬁlter re-
moving shortest waves has been added in the numerical
implementation. With these techniques, weakly three-

dimensional eﬀects could be included in simulations of
rogue wave formation as illustrated in the two examples
given. In particular, the genuinely non-linear 2D insta-
bility reported by Zakharov et al. [2, 3] could be veriﬁed
in the weakly 3D regime despite the relatively low reso-
256 points used here.
lution (compared to 2D) of 16384

×

The results indicate that the assumption of weak vari-
ation in the third direction holds even in the late stage
of rogue wave formation, which demonstrates the consis-
tency of the expansion in ǫ = (lx/lq)2 and thereby the
applicability of the present theory.

Planned further steps in the continuation of this
work are a more eﬃcient computational implementation
through parallelization of the code and the inclusion of
additional eﬀects like a bottom proﬁle, which is already
covered by the formalism reported earlier [35].

[1] C. Kharif and E. Pelinovsky, Eur. J. Mech. B/Fluids 22,

603 (2003).

of freely propagating time-dependent irrotational water
waves”, to be published.

[2] V. E. Zakharov, A. I. Dyachenko, and O. A. Vasilyev,

[22] M.S. Longuet-Higgins and E.D. Cokelet, Proc. Roy. Soc.

Eur. J. Mech. B/Fluids 21, 283 (2002).

Lon. A 350, 1 (1976).

[3] A. I. Dyachenko and V. E. Zakharov, Pis’ma v ZhETF

81, 318 (2005) [JETP Letters 81, 255 (2005)].

[23] D. Clamond and J. Grue, J. Fluid Mech. 447, 337 (2001).
[24] D. Fructus, D. Clamond, J. Grue, and Ø. Kristiansen, J.

[4] T.B. Benjamin and J.E. Feir, J. Fluid Mech. 27, 417

Comput. Phys. 205, 665 (2005).

(1967).

[5] V.E. Zakharov, Sov. Phys. JETP 24, 455 (1967).
[6] J. W. McLean, Y. C. Ma, D. U. Martin, P. G. Saﬀman,

and H. C. Yuen, Phys. Rev. Lett. 46, 817 (1981).

[7] V.I. Shrira, S.I. Badulin, and C. Kharif, J. Fluid Mech.

[8] F. Collard and G. Caulliez, Phys. Fluids 11, 3195 (1999).
[9] F. Dias and C. Kharif, Annu. Rev. Fluid Mech. 31, 301

318, 375 (1996).

(1999).

[10] A. I. Dyachenko, E. A. Kuznetsov, M. D. Spector, and

V. E. Zakharov, Phys. Lett. A 221, 73 (1996).

[11] A. I. Dyachenko, V. E. Zakharov, and E. A. Kuznetsov,
Fiz. Plazmy 22, 916 (1996) [Plasma Phys. Rep. 22, 829
(1996)].

[12] V. E. Zakharov and A. I. Dyachenko, Physica D 98, 652

[13] A. I. Dyachenko, Y. V. L’vov, and V. E. Zakharov, Phys-

(1996).

ica D 87, 233 (1995).

[14] Y. V. Lvov, Phys. Lett. A 230, 38 (1997).
[15] A. I. Dyachenko, Doklady Akademii Nauk 376, 27 (2001)

[Doklady Mathematics 63, 115 (2001)].

275, 386 (2000).

[16] W. Choi and R. Camassa, J. Engrg. Mech. ASCE 125,

[17] http://www.ﬀtw.org/
[18] V. P. Ruban, Phys. Rev. E 70, 066302 (2004).
[19] V. P. Ruban, Phys. Lett. A 340, 194 (2005).
[20] W.T. Tsai and D.K.P. Yue, Annu. Rev. Fluid Mech. 28,

756 (1999).

249 (1996).

[21] F. Dias and T. J. Bridges, “The numerical computation

[25] J.T. Kirby, in Gravity Waves in Water of Finite Depth,
edited by J. N. Hunt, Advances in Fluid Mechanics,
Vol 10 (Computational Mechanics Publications, The
Netherlands, 1997), pp. 55-125;
J.T. Kirby, in Advances in Coastal Modeling, edited by
V. C. Lakhan (Elsevier, New York, 2003), pp. 1-41;
http://chinacat.coastal.udel.edu/˜kirby/kirby pubs.html
[26] H. B. Bingham and Y. Agnon, Eur. J. Mech. B/Fluids

24, 255 (2005).

[27] Y. Matsuno, Phys. Rev. E 47, 4593 (1993).
[28] W. Choi, J. Fluid Mech. 295, 381 (1995).
[29] M. Onorato, A.R. Osborne, M. Serio, D. Resio, A.
Pushkarev, V.E. Zakharov, and C. Brandini, Phys. Rev.
Lett. 89, 144501 (2002).

[30] A.I. Dyachenko, A.O. Korotkevich, and V.E. Zakharov,

Phys. Rev. Lett. 92, 134501 (2004).

[31] K.B. Dysthe, Proc. Roy. Soc. Lon. A 369, 105 (1979).
[32] K. Trulsen, I. Kliakhadler, K.B. Dysthe, and M.G. Ve-

larde, Phys. Fluids 12, 2432 (2000).

[33] A.R. Osborne, M. Onorato, and M. Serio, Phys. Lett. A

[34] P.A.E.M. Janssen, J. Phys. Oceanogr. 33, 863 (2003).
[35] V. P. Ruban, Phys. Rev. E 71, 055303(R) (2005).
[36] V. E. Zakharov, Eur. J. Mech. B/Fluids 18, 327 (1999).
[37] V. P. Ruban and J. J. Rasmussen, Phys. Rev. E 68,

[38] P. M. Lushnikov and V. E. Zakharov, Physica D 203, 9

056301 (2003).

(2005).

