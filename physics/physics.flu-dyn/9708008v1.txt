7
9
9
1
 
g
u
A
 
7
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 
1
v
8
0
0
8
0
7
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

A Bicharacteristic Scheme for the Numerical Computation of
Two-Dimensional Converging Shock Waves

U. E. Meier and F. Demmig
Institut f¨ur Atom- und Molek¨ulphysik, Abteilung Plasmaphysik
Universit¨at Hannover, Germany
Phone: +49-511-762-3543, Fax: +49-511-762-2784
email: demmig@pmp.uni-hannover.de

ABSTRACT

A 2d unsteady bicharacteristic scheme with
shock ﬁtting is presented and its characteristic
step, shock point step and boundary step are
described. The bicharacteristic scheme is com-
pared with an UNO scheme and the Moretti
scheme. Its capabilities are illustrated by com-
puting a converging, deformed shock wave.

INTRODUCTION

Commonly used diﬀerence schemes are capable
of computing complex ﬂow patterns and shock con-
ﬁgurations, but they smear out shocks and other
discontinuities. To avoid the eﬀects of shock smearing,
shock ﬁtting has to be used. This is most naturally
done by the method of bicharacteristics.

Characteristic Normal Form

the

Introducing

substantial derivate D0 =
Dt = ∂t + (~v∇), a directional derivative operator
DB := ( ~B∇) = ∂t + ((~v − a~g)∇) along a bicharac-
teristic, the abbreviations vg := ~v~g, ∂g := ~g∇ and
the logarithmic pressure P and density ̺, the Euler
equations can be written as

Dt̺ = 1
γ DtP
DtP = −γ∇~v
Dt~v = − a
γ

2

energy equation
continuity equation
∇P momentum equation

or, in characteristic normal form:

characteristic diﬀerential equation

direction

D0̺ =

D0P

1
γ

1
~v (cid:19)

(cid:18)

DBvg − a
γ

DBP = a(∇~v − ∂gvg)

1
~v − a~g (cid:19)

(cid:18)

where the characteristic diﬀerential equations (CDEs)
are valid only on their speciﬁc characteristic surfaces,
i.e. the particle path ~C0 = (1, ~v) and the Monge cone,
generated by the bicharacteristics ~B = (1, ~v − a~g). The
unit vector ~g singles out a speciﬁc bicharacteristic on
the Monge cone (ﬁg. 1).

Characteristic Step

The bicharacteristic scheme was constructed on
a Cartesian grid, in analogy to Hartree’s method [1].
Using an educated guess of ~v and a in a grid point
at the new time level the bicharacteristics are drawn
backwards in the directions of the coordinate lines. At
the intersection points of these bicharacteristics with
the old time level, called ’footpoints’, the quantities
P, ρ, ~v are interpolated in second order from the grid
points with a 2d nine point least-squares method (ﬁg.
1). Using the discretized CDEs, the quantities P, ρ, ~v
then can be determined in ﬁrst order at the new time
level. A corrector step, which uses the ﬁrst order values
of ~v and a to reconstruct the bicharacteristics, yields the
quantities P, ρ, ~v in second order, eliminating the lateral
derivatives on the new time level according to Butler [2].

Bicharacteristic

Particle path

t

y

x

g

Figure 1: Characteristic Step

Treatment Of Shocks

To begin with, a shock point is moved using its
previous velocity. At its new location, the (oblique)
Rankine-Hugoniot conditions are used to determine the
downstream values. With these values, a bicharacteris-
tic is drawn backwards antiparallel to the shock front
normal (ﬁg. 2). The correct position of the new shock
point is found by iteration, such that both the Rankine-
Hugoniot conditions and the diﬀerential equation along
the bicharacteristic are fullﬁlled.

Shock points are moved along their trajectories.
The density of shock points on a shock front can be
kept constant by creating or deleting shock points. Two
pointers are attached to each shock point, pointing to

its predecessor and successor. Though all shock points
are stored in an arbitrary sequence in a single array,
shock contours and their normal vectors can neverthe-
less be reconstructed with the help of the pointers. New
shock points are detected with an algorithm according
to Moretti [3] at each new time level.

Shock Point Step

Shock Point

n

t

y

x

-n

Retrograde
Bicharacteristic

Figure 2: Shock Point Step

Boundary Step

When a new time level is computed, it is ﬁrst done
regardless of all discontinuities. Then, the shock points
are moved. Invalid grid points, which were computed
by drawing bicharacteristics crossing a shock surface,
are updated afterwards with the help of a boundary
step:
When a Monge cone is intersected by a boundary, e.g.
a shock wave, the bicharacteristics are no longer drawn
backwards in coordinate directions but in directions
normal and tangential to the boundary (ﬁg. 3). This
improves the accuracy of the step considerably. The
intersection points of the bicharacteristics with the
boundary are determined, the footpoint values are in-
terpolated at the boundary surface, and the grid point
is updated. The boundary step is only of ﬁrst order
because the lateral derivatives cannot be eliminated
with the Butler procedure in case the bicharacteristics
of a monge cone are cut oﬀ at diﬀerent time levels.

Intersection

Point

n

New Grid Point

t

y

x

-n

Figure 3: Boundary Step

Interpolation

In the vicinity of discontinuity surfaces the in-
terpolation algorithm used for ordinary grid points
becomes ill-conditioned, producing instabilities. The
most preferable way of interpolation in this case proved
to be a two-dimensional, second order least-squares
pattern, sized 7 × 7 grid points, in which all upstream
grid points are ignored, but in which all shock points
of this area are taken into account. According to our
experience an interpolation in smaller regions will
render the scheme unstable.

COMPARISON WITH OTHER NUMERICAL
SCHEMES

The bicharacteristic scheme was tested with an
analytical solution, and computations of converging
shock waves were compared with the corresponding
results of a UNO scheme and the Moretti scheme (a
λ-scheme working with shock ﬁtting). As expected, the
bicharacteristic scheme turned out to be superior to the
UNO scheme regarding the prediction of position and
velocity of the shock front. The shock ﬁtting algorithm
provides exact information on position, direction of
propagation, and local Mach number of the shock wave.

Bichar

 scheme

UNO2

y
t
i
s
n
e
d
 
f
o
 
r
o
r
r
e
 
f
o
 
t
o
o
r
e
r
a
u
q
s

0.03

0.025

0.02

0.015

0.01

0.005

0.0

0.0

0.05

0.15

0.2

0.1
grid width

Figure 4: Comparision of convergence of the UNO-, λ-
and bicharacteristic scheme

The Moretti scheme [4] proved to be comparable
in accuracy to the bicharacteristic scheme (ﬁg. 4). The
aforementioned is faster (by a factor 1.5, assuming
Courant Number 2.0). This is due to the time consuming
interpolations in the bicharacteristic scheme. We found
that the convergence of the shock front position towards
a known solution by reﬁnement of the grid is slightly
faster in the bicharacteristic scheme, due to its bound-
ary step.

Recently, Nasuti and Onofri [5] extended Moretti’s
original shock ﬁtting algorithm to handle triple points.
We implemented their extensions in our version of the
λ-scheme and added some further improvements (to

1.0

0.5

0.0

-0.5

-1.0

1.0

0.5

0.0

-0.5

-1.0

be published soon). We found, that the shock ﬁtting
algorithm proposed by these authors still has some
disadvantages. For example: The fragmentation of the
shock front, described in the next paragraph occurs
too late and is not enough pronounced in case the
shock contour has an unfavourable orientation to the
computational grid; whereas our shock ﬁtting algorithm
is not inﬂuenced by the relative position of shock front
and computational grid.

COMPUTATION OF CONVERGING SHOCK
WAVES

The computation shown here (ﬁg. 5 and 6) started
with a slightly deformed shock wave of Mach No. 2.5, at
radius 1.0. Isopycnics of a time step immediately before
and some time after fragmentation occurs are shown in
Figure 5 and 6, respectively. Presently, the computation
of converging shock waves extends to the instant of
fully developed fragmentation,
just before reﬂection
of the leading shock. The extension of the method of
bicharacteristics to proceed beyond this point is under
work and does not pose any fundamental problems.

Calculating converging shock waves with a bichar-
acteristic scheme, one has to make sure that the Mach
stem will develop correctly. As mentioned above, infor-
mation on the downstream values of the physical quanti-
ties reaches a shock point by transportation along a ret-
rograde bicharacteristic. The footpoint of this bicharac-
teristic generally is located only fractions of a grid width
apart from the shock front. However, the physical mech-
anism which generates the Mach stem is a density hump
which gradually steepens as the shock wave converges.
Finally, this density hump takes the form of a bow shock
[6, 7]. Emerging gradually from a compression wave, its
shock proﬁle is smeared out similar to shocks in common
diﬀerence schemes over a number of grid points. For this
reason the retrograde bicharacteristic sees only a slight
increasing of e.g. density values where a marked den-
sity hump should be located. Therefore, the local shock
velocity could be calculated too small and, hence, the
formation of the Mach stem could be delayed.

To overcome this problem, the developing bow
shock has to be detected with a pattern recognition
algorithm, and consecutively be treated with the shock
ﬁtting algorithm.

As mentioned above, the density hump gives rise
to new developing shocks in the vicinity of the triple
points (ﬁg. 7). These lateral waves are not ﬁtted yet
because of the considerable eﬀort, this might take.
However, the computed solution is acceptable as long as
the lateral waves remain suﬃciently weak. Depending
on our initialisation the Mach Number of the lateral
waves was only slighly above 1.0 and therefore the
results can be considered as valid.

-1.0

-0.5

0.0

0.5

1.0

-1.0

0.0
Figure 5: Isopycnic at t=0.1750 (before fragmentation)
The bold contour represents the leading shock wave.

-0.5

0.5

1.0

-1.0

-0.5

0.0

0.5

1.0

1.0

0.5

0.0

-0.5

-1.0

1.0

0.5

0.0

-0.5

-1.0

-1.0

-0.5

0.0
Figure 6: Isopycnic at t=0.2622 (after fragmentation).
The curvature of the Mach stem is below grid width
and cannot be observed by shock capturing schemes in
this resolution. Compare also ﬁg. 7.

0.5

1.0

OUTLOOK

The following improvements seem feasible:

-The treatment of intersecting shock point trajectories
should be reconsidered.
-Newly developing shock fronts and discontinuity lines
should be detected and ﬁtted as proposed by Moretti.

The bicharacteristic scheme with shock ﬁtting pre-
sented here provides great accuracy and physical insight
and allows a variety of applications: It could be used to
compute, e.g., channel ﬂows, ﬂows around wings, MHD
problems, star pulsation, and non-equilibrium ﬂows.
The scheme can also proﬁtably be used as a standard
to estimate the capabilties of other schemes.

REFERENCES

[1] Hartree, D. R., ”Some practical methods of using
characteristics in the calculation of non-steady compressible
ﬂows”. US Atomic Energy Comm. Report AECU-2713
(1953)

[2] Butler, D. S., The numerical solution of hyperbolic
systems of partial diﬀerential equations in three indepen-
dent variables, Proceedings of the Royal Society Vol. A255,
(1960), p. 232-252

[3] Moretti, G., Detection and ﬁtting of two-dimensional
shocks, Notes Num. Fluid Mech. Vol 20, (1987), p. 239-246

[4] Moretti, G., Eﬃcient Euler Solver with many appli-

cations, AIAA Journal, Vol. 26 No. 6, (1988), p. 655-660

[5] Nasuti, F., Onofri, M., Analysis of Unsteady Super-
sonic Viscous Flows by a Shock-Fitting Technique, AIAA
Journal, Vol. 34, No.7, (1996), p. 1428-1434

[6] Watanabe, M., Takayama, K., Stability of converg-
ing cylindrical shock waves, Shock waves, Springer Verlag,
(1991), p. 149-160

[7] Ben Dor, G. Shock Wave Reﬂection Phenomena,

Springer Verlag, (1992)

density hump

slip line

leading
shock
wave

lateral
shock
wave

triple point

Mach stem

Y

X

Figure 7: Density at t=0.2622
Due to the shock ﬁtting algorithm the leading shock
wave, which is represented here by density values ex-
actly fullﬁlling the Rankine-Hugoniot relations, is not
smeared out. The eminent area between lateral shock
wave and slip line consists of those ﬂuid particles which
passed both the leading shock wave and the lateral wave.

NOMENCLATURE

a
~B
~C0
Dt = ∂t + (~v∇)
D0 = ∂t + (~v∇)
DB = ( ~B∇)
∂g = (~g∇)
∂t = ∂/∂t
~g
P = ln(p/p0)
p, p0
~v
vg = ~v~g
γ
̺ = ln(ρ/ρ0)
ρ, ρ0

sound speed
vector along a bicharacteristic
vector along the particle path
substantial derivative
derivative along ~C0
derivative along ~B
derivative in direction of ~g
time derivative
unit vector (spatial)
logarithmic pressure
pressure, initial upstream press.
velocity ﬁeld
projection of ~v on ~g
speciﬁc heat ratio
logarithmic density
density, initial upstream density

ACKNOWLEDGEMENTS

We like to thank O. Rautenberg and A. v. Endt for
implementation of the Moretti Scheme, and H. Wallus
for maintenance of the UNO2 program.

