7
0
0
2
 
b
e
F
 
5
 
 
]
h
p
-
m
o
t
a
.
s
c
i
s
y
h
p
[
 
 
1
v
2
3
0
2
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Electron-ion-ion coincidence experiments for
photofragmentation of polyatomic molecules
using pulsed electric ﬁelds: treatment of
random coincidences

G. Pr¨umper, K. Ueda

Institute of Multidisciplinary Research for Advanced Materials, Tohoku University,
Sendai 980-8577, Japan

Abstract

In molecular photofragmentation processes by soft X-rays, a number of ionic frag-
ments can be produced, each having a diﬀerent abundance and correlation with the
emitted electron kinetic energy. For investigating these fragmentation processes,
electron-ion and electron-ion-ion coincidence experiments, in which the kinetic en-
ergy of electrons are analyzed using an electrostatic analyzer while the mass of
the ions is analyzed using a pulsed electric ﬁeld, are very powerful. For such mea-
surements, however, the contribution of random coincidences is substantial and
aﬀects the data in a non-trivial way. Simple intuitive subtraction methods cannot
be applied. In the present paper, we describe these electron-ion and electron-ion-ion
coincidence experiments together with a subtraction method for the contribution
from random coincidences. We provide a comprehensive set of equations for the data
treatment, including equations for the calculation of error-bars. We demonstrate the
method by applying it to the fragmentation of free CF3SF5 molecules.

Key words: PEPIPICO, coincidence, random coincidence, algorithm
PACS: 02.70.Rr, 33.60.Fy, 07.05.Kf

1 Introduction

This is probably one of the most boring papers ever published in this journal.
There may be no exciting new science in it. However, it will be one of the most
useful papers for those readers who are doing or planning to do multi-particle
coincidence spectroscopy, because it presents equations in a “ready-to-use”
form for the treatment of random coincidences. This problem needs to be
solved in order to avoid mistakes in the analysis on multi-particle coincidence

Preprint submitted to Elsevier

2 February 2008

data that are recorded in various kinds of fragmentation experiments of poly-
atomic molecules.

Multi-ion coincidence momentum spectroscopy is often used in molecular
photofragmentation studies using synchrotron radiation (SR) [1,2,3]. Electron-
ion(-ion) coincidence momentum spectroscopy is also widely used in molecular
photoionization study [4,5,6,7]. In these measurements, static extraction ﬁelds
are applied and all the electrons and ions emitted in all directions (4π sr) are
collected. In such measurements, the random coincidences are minimized by
using a sophisticated ﬁltering of the recorded events or very low ionization
rates.

For many applications, however, these approaches and tricks can not be used.
Filtering criteria based on momentum conservation cannot be used if there
are some undetected neutral fragments. This often happens in the reaction
pathways for larger molecules. In such cases, the measured data are no longer
kinematically complete. Static extraction ﬁelds used for the above listed ex-
periments spoil the energy resolution for electrons. Also the measurements are
limited to relatively low kinetic energy electrons. If the kinetic energy of the
electron is high (say, more than 50 eV), it becomes practically impossible to
collect the electrons from 4π sr keeping reasonable resolution. If one tries to
improve the electron energy resolution, one needs to restrict the acceptance
angle of the electrons, keeping the source volume ﬁeld-free. The experiments
can be done, for example, in such a way that the photoelectron emission is
observed with limited acceptance angles in certain directions using an electro-
static analyzer or a conventional time-of-ﬂight (TOF) analyzer, whereas the
molecular fragments emitted all directions (4π sr) are collected using pulsed
electric ﬁeld [8,9,10,11]. In such experiments, the problem of random coinci-
dences becomes non-trivial, especially if one tries to detect two or more ions
in coincidence with electrons. K¨ammerling and coworkers [12] discussed the
problem of a high level of electron-random ion coincidences for the case of
multiple photoionization of atoms. They stressed the need for a reference ion
measurement using a “random” trigger instead of the electron detection. In
a way this paper might be considered a generalization of their formalism for
multiple detectors, if the multi-hit capability of the ion detector is formally
treated as multiple “yes-no” ion detectors. Because of the presence of diﬀer-
ent fundamental processes for molecules leading to single ions and multiple
ion pairs in the same experiment, the problem is already rather complicated
and we decided to partially neglect the dead time eﬀects of the ion detector.

In this paper, we describe how to perform these experiments and how to deal
with subtraction of the random coincidences, presenting the method in form of
“ready to use” equations. In the following section, we describe an experimental
apparatus and procedures that were successfully used for SR experiments as an
practical example. All the details of the subtraction of the random coincidences

2

will be given in section 3. In section 4, we present some experimental results
as demonstrations for the necessity of the proper subtraction of the random
coincidences. Section 5 is a summary.

2 Experiment

2.1 Coincidence setup

Photofragmentation of polyatomic molecules following inner-shell excitation
by soft x-rays has been widely studied in the last two decades. Even for small
molecules, many diﬀerent ions and ion pairs can be produced, each stemming
from diﬀerent Auger ﬁnal states. To disentangle the fragmentation pathways
after molecular Auger decay following inner-shell excitation, coincidence mea-
surement between the Auger electron and the fragment ion is indispensable.
In order to investigate molecular fragmentation after inner-shell excitation, we
developed an Auger-electron–multiple-ion coincidence apparatus, described
in detail elsewhere [10,13]. The apparatus was installed at the c-branch of
the high-resolution soft X-ray monochromator [14] in beamline 27SU [15] at
SPring-8, an 8 GeV SR facility in Japan: the radiation source is a ﬁgure-8
undulator [16].

SES2002

ion tof spectrometer

+

ion
delay-line
detector

ion time of flight

ion position

time-to-digital
converter + PC

HV pulse
generator

logic: wait for
bunch marker
signal

or

random pulse
generator

electron
delay-line
detector

electron hit

electron position information

Fig. 1. Schematic of the experimental setup and the data acquisition system for
synchrotron radiation experiment.

A schematic of our apparatus is shown in Fig. 1. To obtain high resolution for
the electron kinetic energy, a dispersive spectrometer with a limited detection
angle (Gammadata-Scienta SES2002) is used. An ion TOF spectrometer is

3

placed on the opposite side of the electron spectrometer. The sample gas is
introduced as an eﬀusive beam between the pusher and extractor electrodes of
the ion spectrometer through a needle. No static extraction ﬁeld is present in
the source region. All voltages of the electron spectrometer are ﬁxed during the
coincidence experiment. Electrons pass the pusher electrode, enter the electron
spectrometer, and are detected by a fast position resolving detector (Roentdek
DLD40). Triggered by the electron detection or a periodic “random” pulse,
rectangular high voltages pulses with opposite signs are generated by a pulse
generator (GPTA HVC-1000) and applied symmetrically to the pusher and
extractor electrodes. The ions are detected by another delay-line detector set
(Roentdek DLD80) at the end of the TOF drift tube. All data are recorded
by multichannel multi-hit time-to-digital converters (Roentdek TDC-8) and
stored in the list mode for oﬀ-line analysis. In the list mode, each event consist
of one electron or a random pulse followed by zero, one, two, three or four ions.

2.2 Optimum conditions for coincidence experiments

To obtain a reasonable count rate of about 1 Hz a relatively high ionization
rate of some KHz is necessary. Under typical experimental conditions, random
coincidences including one or two ionic fragments that do not come from
the same molecule like the detected electron, are a major contribution to
the recorded data. We will only deal with the case were one electron was
detected. Due to the limited acceptance angle and the limited energy window
of the electron spectrometer electron-electron coincidences are a negligible
contribution to the recorded data. The ions that come from the same molecule
like the detected electron will be called “true ions” the others will be called
“random ions”. There is no such distinction for electrons. There is no way to
distinguish between true and random ions for an individual ionization event.
The percentage of the contribution of the random ions must be determined
in an additional measurement. The problem of a huge contribution of random
ions is inherent to the present experiment, as the acceptance angle for the
4π sr and therefore 999 of
high resolution electron spectrometer is
1000 electrons are not detected. The corresponding ions need time to escape
from the region seen by the ion spectrometer. A 30 amu ion with a kinetic
energy of 0.1 eV takes about 12 µs to ﬂy 1 cm. So if the double ionization
rate via core hole decay is about 40 KHz, there is at average 1 old ion present,
producing a huge contribution of random coincidences. On the other hand,
the electron count rate is quite low, because the electron spectrometer sees
only a limited part of the spectrum. So in this example, an Auger electron
count rate of less than 40 Hz would occur. As a rule of thumb, the best
compromise between count rate and true-to-random coincides is obtained for
10-30% random coincidences. In this case, the electron count rate is typically
less than 10 Hz. For ion pairs, the situation can be even worse. Two ion species

0.001

∼

·

4

can occur with high abundance, but the cross section for the corresponding
ion pair production can be low. In such a case, most of the detected ions pairs
belong to random coincidences. This illustrates the need for a fully automatic
reliable subtraction method for the random coincidence contribution without
any adjustable parameters.

2.3 Reference measurement for the random coincidences

A reference measurement for the random coincidences must be performed
under exactly the same experimental conditions as the real coincidence mea-
surement. One very convenient method is to use not only the electron trigger
to extract the ions, but also a “random” trigger that comes from an external
pulse generator. In order to be able to distinguish the two types of triggers, the
information about the trigger type must be recorded as well in the list mode
ﬁle for each event. Under ideal experimental conditions the electron trigger
will always lead to the detection of an ion, while the random trigger should
never lead to the detection of any ion. Under typical experimental conditions,
however, it is already reasonable, if 1000 electron triggers lead to the detection
of 400 ions, while 1000 random triggers lead only to the detection of 150 ions.
In this case we would assume that about 250 of the ions that were detected
after the electron trigger are true, while 150 of these electrons are random. So
the contribution of the true coincidences is 62.5% in this case.

The random trigger rate can be set higher than the electron count rate. So the
statistical uncertainties of the random contribution are much lower than that
of the real signal. Of course the list mode ﬁle should not be overloaded by the
random events. As a rule of thumb, use 10 time as many random triggers, as
real electron triggers.

A synchrotron light source has a repetition rate of several MHz and the time
between the light pulses (time window) is not long enough to detect the elec-
tron and the ions. Therefore, the HV is only triggered when either an electron
is detected or a random pulse is generated by the pulse generator.

Both the true and random ion signals are time-correlated to the synchrotron
light. So is the electron trigger. The random trigger is not. This diﬀerence
may lead to subtle diﬀerences between the random contribution in the electron
triggered events and the random triggered events. To avoid this diﬀerence an
electronic trick is used: There is an electronic signal available, that represents
the (delayed) time structure of the light source. It will be called the bunch
marker. During the measurement the electron and the random trigger signals
do not trigger the extraction ﬁeld immediately, but wait for the bunch marker
signal. The phase of the bunch marker signal should be adjusted in a way

5

to minimize the additional delay time after the electron detection. Using this
trick, the random events behave perfectly like the electron events, and the
contribution of the random ions can be subtracted form the total ion signal
with the method described in this paper.

2.4 Experimental methods to minimize the contribution of random coinci-

dences and their limits

Instead of applying sophisticated statistical methods to subtract the contri-
bution of random coincidences, it would be much more elegant and straight-
forward to eliminate them by a clever experimental design. Two standard
techniques exists to minimize the contribution of the random events. We give
a brief account of the limits of their applicability and show that for the experi-
mental conditions considered here, contribution of random coincidences cannot
be eliminated to a negligible level. The aim of this article is not to replace these
methods, but to properly quantify the contribution of the remaining random
coincidences. Of course a situation where the random contribution can be ne-
glected never occurs in practice. The reason is very simple: if the contribution
of the random coincidences is reduced by a clever design of the experiment
from 10% to, say 1%, for a given count rate, this simply means that the light
intensity or the gas pressure can be increased by a factor of 10 to improve the
count rate and revert to 10% contribution from random coincidences. In other
words, an experiment that takes a week with “negligible” random coincidences
can be performed in a day if the random coincidences are subtracted properly.

As described above, slow ions with kinetic energies below 0.1 eV can be the
main contribution to the random coincidences in some experiments. Even if
they are created at a relatively small rate compared to fast ions, the corre-
sponding sharp peaks are clearly seen in the ion time of ﬂight spectra, because
they pile up in the source region until they are extracted by the high voltage
+ with a kinetic energy of 20 meV needs 27µs to escape
pulse. For example N2
from a region with 1 cm radius. When a static extraction ﬁeld of 2V/cm is
applied, the escape time reduces to about 5 µs. This eﬀect is clearly seen in the
ion time of ﬂight spectra, the sharp lines from the slow ions almost disappear.
1µs) duration HV
A similar eﬀect can be achieved, by applying a short (
sweeping pulse every 5µs. (Of course the electrons detected during the sweep-
ing pulse should be ignored in the data evaluation.) The obvious change in the
ion spectrum creates the illusion that one can easily control the level random
coincidences by static or pulsed extraction ﬁelds. However the contribution of
fast false ions is hardly aﬀected at all. The escape time of F+ with a kinetic
energy of 2 eV is only 2.22 µs. So the contribution of fake fast F+ ions does
not change signiﬁcantly using reasonable static extraction ﬁelds or sweeping
pulses with a repetition rate lower than 1 MHz. Figure 2 shows two peaks from

∼

6

the ion time of ﬂight spectrum of CH3F after F 1s ionization. In this case a
small penetrating ﬁeld extracted the slow ions, unfortunately in the direction
of the ion detector, leading to ﬂat background in the time of ﬂight spectrum.
Nevertheless the sharp peaks of the slow random ions are eﬃciently removed
in this way. Therefore the contribution of the random coincidences to the slow
+ ions is not very large. In this spectrum the dominating contribution of
H2
random ions are fast ions, as can be clearly seen by the double structure of
the peaks belonging to the F+ ions.

Both background suppression methods can only be applied, if the light source
used is either continues or has a very high repetition rate, i.e. discharge lamps
or synchrotron radiation sources, because they are based on the assumption
that most random ions are produced at a diﬀerent time than the true ions. In
experiments with intense pulsed lasers the repetition rate is typically 1 kHz
or less and the experimental conditions are often such that more than 10% of
the light pulses do ionize at least one molecule. In such a situation 1% of the
laser pulses may ionize two or more molecules and the contribution of random
coincidences would be about 10%. In this case the random ions are produced
during the same laser shot in the same small laser focus as the real ions, so
the random ions can not be separated from the real ions using static or pulsed
extraction ﬁelds.

3 Data evaluation method

3.1 Preparation

3.1.1 The list mode data and ﬁltering

The data is recorded in the list mode. This means that the data structure is
a list of events, containing an electron position or a random trigger and 0, 1,
2, 3 or 4 ions. The number 4 is deﬁned by the data acquisition electronics.
All ions arriving after the fourth ion will be ignored. Therefore the formulas
in this paper which refer to 4-ion events, actually mean 4-or-more-ion events.
For electron triggered events any of the ions can come from the same molecule
as the electron (true ion) or from another molecule (false ion). There is no
way of telling which ion is true and which is false from the data. The number
of possible combinations of true and false ions are numerous. We will start
the discussion with this event list. Then various numbers and spectra will be
deﬁned by evaluating this event list.

The ﬁrst step of the data evaluation is ﬁltering. This means that the list mode
data is changed. Filtering can include the selection of the electron energy, the

7

selection of the ion TOF, the ion emission direction etc. Filtering has two
eﬀects. The ﬁrst eﬀect is the rejection of unwanted events, such as the events
for which the electron energy is not in the desired interval. The second eﬀect
is a modiﬁcation of events. For example, if only one ion out of three is in the
desired TOF interval, then the event is modiﬁed from a one-electron-three-ion
event into a one-electron-one-ion event. To avoid confusion, we will only refer
to the modiﬁed event list after this selection process.

3.1.2 Event statistics

For a given event list, i.e., for a given choice of the TOF interval for the
ions and energy interval for the electrons, we can do statistics on the events.
We distinguish events with electron triggers and with random triggers. The
numbers of these events will be called Ne and NRN D in the formulas. If more
than one electron was detected (or one electron and a random trigger were
present), the event is not counted. Since the total number of these events is
very small, we do not discuss the systematic eﬀects of this ﬁltering.

The electron trigger can lead to the detection of 0 to 4 ions. The random trigger
can also lead to to the detection of 0 to 4 ions. The corresponding probabilities
are called etP0,1,2,3,4 and rtP0,1,2,3,4. (et stands for electron triggered, rt stand
for random triggered). These numbers are calculated by counting the number
of the events and dividing the result by Ne or NRN D respectively.

To calculate the random background contribution, we consider the hypotheti-
cal probabilities to detect 0, 1, 2, 3 or 4 ions after one electron detection, when
the background would be absent. These probabilities are called T P0,1,2,3,4 (T
stands for true ions). Neglecting the dead time eﬀects of the ion detector, we
assume that the chance to detect a random ion is not eﬀected by the presence
of the true ion. So the chance to detect 0, 1, 2, 3 or 4 false ions after an electron
trigger is also rtP0,1,2,3,4.

In order to calculate T P0,1,2,3,4 from the known values of etP0,1,2,3,4 and rtP0,1,2,3,4,
we write down a system of linear equations (18), see the appendix. Knowing
rtP0,1,2,3,4 and etP0,1,2,3,4, these equations yield values for T P0,1,2,3,4. The num-
bers T P0,1,2,3,4 deﬁned by these equations should all be non-negative and they
should add up to 1. Because of statistical errors, some of them may be neg-
ative. Therefore the negative values are set to zero and then the numbers
T P0,1,2,3,4 normalized to sum up as 1. T P0 is the probability to ﬁnd no true
ion after the electron detection. There are several possible reasons for this.
Most important one is that the detection eﬃciency of the ion detector is lim-
ited. Second, the choice of the TOF region for the ions may not contain all
ionic fragments. Furthermore, the electron detector has a certain noise level
or dark count rate. So, every ‘electron-trigger’ does not necessarily correspond

8

to the detection of one electron from the source region.

3.1.3 The true number of ionic fragments

To make statements about the real ionization events without the instrumental
inﬂuences, i.e. the detection eﬃciency, we deﬁne ﬁve new values, P0,1,2,3,4 that
represent the probabilities that 0, 1, 2, 3, 4 ions are present for one electron
detected. If the selected TOF region contains all possible ions, P0 is the prob-
ability for an electron to be detector noise, P1 the probability be an electron
leading to one ion, P2 the probability be an electron from an ionization leading
to two ions etc. Please note that the single and double ionization depend on
the charge state of the individual ions. So P1 and P2 do not exactly belong to
single and double ionization processes. To obtain the probabilities for the sin-
gle and double ionization, one needs to assign the charge state to the detected
ions. The value of the ion detection eﬃciency P D is especially important to
compare the yields of doubly charged ions with that of pairs of singly charged
ions, because the latter one suﬀers form the detection eﬃciency two times.
Lets assume that the chosen TOF interval contains all possible ions. Further
we assume that the detection eﬃciency is the same for all ions independent of
mass, momentum and charge state. Its value P D is known (determined form
an independent measurement). Typically P D should be between 0.2 and 0.4
summarizing the transmission of the grids in the ion spectrometer and the
detection eﬃciency of the detector. So for given values of PD and T P0,1,2,3,4
the values of P0,1,2,3,4 can be calculated from the set of linear equations (19),
given in the appendix.

All values of P0,1,2,3,4 must be between 0 and 1. Their sum is 1 by deﬁnition.
The value of P D can be estimated in a reference measurement where one of
the values P1 or P2 is close to 1. E.g. in the ionization of atoms (e.g. rare gas
atoms) , neglecting the detector noise P1 is always 1.

If a molecule contains hydrogen, the protons produced are very likely to dis-
obey the approximation that the detection eﬃciency is the same for all ionic
fragments. Their detection eﬃciency is usually smaller than for the other ions,
because protons are usually much faster than the other ions and escape from
the region between the pusher and extractor electrodes, before the high voltage
pulse is applied.

9

3.2 Electron spectra

3.2.1 All-electron spectrum

One can make a spectrum of all electrons detected, no matter how many ions
where found in coincidence. This is called all-electron-spectrum AES(x). x
stands for the kinetic energy of the electron, so technically speaking for a
detector position. Because of the discrete nature of the electron detector and
the time measurement using a TDC, AES(x) actually means the chance to
detect an electron within an interval around the integer value x. So there is no
need to use the notion of ‘probability density’ for truly continuous spectra. One
can create separate electron spectra ES0,1,2,3,4(x) for the events with 0,1,2,3,4
ions, respectively. AES(x) is the sum of all these spectra:

AES(x) = ES0(x) + ES1(x) + ES2(x) + ES3(x) + ES4(x) .

(1)

Without the contribution of the random ions, there would be the hypothetical
spectra HES0,1,2,3,4(x). The relation between HES0,1,2,3,4(x) and ES0,1,2,3,4(x)
is similar to the set of equations 18. One only needs to replace etP0,1,2,3,4 by
ES0,1,2,3,4(x) and T P0,1,2,3,4 by HES0,1,2,3,4(x). Therefore HES0,1,2,3,4(x) can be
calculated from ES0,1,2,3,4(x). Solving the equations for HES0,1,2,3,4(x) leads
to:

HES0(x) =

HES1(x) =

HES2(x) =

ES0(x)
rtP0
ES1(x)

ES2(x)

HES3(x) =

ES3(x)

rtP3 ·

−

rtP1 ·
rtP0
rtP2 ·

−

−

HES0(x)

HES0(x)
rtP0
HES0(x)

rtP1 ·

−

HES1(x)

−

rtP2 ·
rtP0

HES1(x)

rtP1 ·

−

HES2(x)

(2)

The corresponding formula for HES4(x) is not written down explicitly, so keep
the formulas more readable.

One should remember that HES0,1,2,3,4(x) are deﬁned as what the spectra
would look like without the random contribution. The existence of the random
contribution redistributes the counts, from the spectra with few ions to the
spectra with more ions. Therefore typically the area of HES1(x) contains
more counts than that of ES1(x). In order to have an equation of the form
true spectrum = measured spectrum - random spectrum, we deﬁne the true
HES0(x), ..., T ES3(x) =
electron spectra in the following way: T S0(x) = rtP0·

10

HES3(x). Then the random backgrounds BES1(x), BES2(x), BES3(x)

rtP0 ·
can be calculated from ES0,1,2,3(x) in the following way:

, c2 =

rtP2
rtP0 −

rtP 2
1
rtP 2
0 −

2

·

rtP 2
1
rtP 2
0
rtP1 ·
rtP 2
0

rtP2

ES0(x)
ES0(x) + c1 ·
ES0(x) + c2 ·

ES1(x)
ES1(x) + c1 ·

ES2(x)

+

c1 =

c3 =

rtP1
rtP0
rtP3
rtP0
BES1(x) = c1 ·
BES2(x) = c2 ·
BES3(x) = c3 ·
T ES0(x) = ES0(x)
T ES1(x) = ES1(x)
T ES2(x) = ES2(x)
T ES3(x) = ES3(x)

BES1(x)
BES2(x)
BES3(x)

−
−
−

(3)

The electron spectrum that belongs to the true e-I coincidences is T ES1(x),
the electron spectrum that belongs to the true e-I-I coincidences is T ES2(x).
T ES3(x) belongs to the e-I-I-I coincidences. The diﬀerent terms that con-
tribute to the backgrounds BES2(x) and BES3(x) have a simple interpreta-
ES0(x) is the random background of T ES2(x) that is caused by two
tion: c2 ·
ES1(x) is the background that is caused by one real and one
false ions, c1 ·
false ion. c3 ·
ES0(x) is the background in T ES3(x) that is caused by three
ES2(x) is
ES1(x) is caused by two false and one real ion, c1 ·
false ions c2 ·
caused by one false and two real ions. The formulas for the statistical errors
of the ture electron spectra T ES0,1,2,3(x) are given by the equations 20 in the
appendix.

3.2.2 Ion speciﬁc electron spectra

For every ion mass to charge ratio, there is a certain small TOF interval called
Iregion(i) that contains these ions. One can do the ﬁltering of the event list by
restricting the accepted TOF interval of the ions to Iregion(i). The electron
spectrum T ES1(x) created after this ﬁltering is called the ion speciﬁc electron
spectrum T ES1I(x, i).

11

3.3 Ion spectra

3.3.1 Ion TOF spectrum and Ion-ion coincidence map

Similar considerations like for the electron spectra are valid for the ion spectra.
The simplest quantity to consider is the ion TOF spectrum for all ions detected
after an electron trigger etAI(tof). (We use “tof” instead of “t” for the time
of ﬂight to avoid confusion with “triggered” and “true”).

All ions contribute independent if they are detected alone or as part of a
(multiple) ion pair. tof stands for TOF of ion. We will only discuss TOF
spectra, but analogous equations are valid for the mass spectra, created by
a non-linear transformation of the TOF to the mass/charge ratio. A similar
spectrum can be generated for all random triggered ions rtAI(tof). Please
note that this spectrum does not necessarily represent the true pattern of
fragmentation, because the fast ionic fragments are more likely to escape from
the region between the pusher and extractor electrode than the slow ones.

Neglecting dead time eﬀects, the detection of one ion is completely indepen-
dent of the presence of the other ions. Therefore the background subtrac-
tion for etAI(tof) is very straightforward. The number of electron triggers
and random triggers are diﬀerent. Their ratio will be called scaling factor
SC = Ne/NRN D.

BetAI(tof) = SC
T etAI(tof) = etAI(tof)

·

rtAI(tof)

BetAI(tof)

∆T etAI(tof) = qetAI(tof) + SC 2

rtAI(tof)

−

·

(4)

For the electron-multi ion coincidence technique, the main diﬀerence between
electron and ion spectra is, that for single ion events we have a TOF or mass
spectrum, for double ions events we have a two-dimensional (2D) map, etc.
We will only consider the cases for up to two ions. We deﬁne etI(tof), the
spectrum of the ions from single ion events triggered by electron detection
and etII(tof1, tof2), the 2D ion TOF spectrum containing the events with
two ions triggered by an electron. The ions are sorted by time of ﬂight, there-
fore, by deﬁnition, we always have the condition tof1 < tof2. rtI(tof) and
rtII(tof1, tof2) are the corresponding spectrum and 2D map for the random
triggered events, respectively.

The corresponding spectra of true ions are named T etI(tof) and T etII(tof1, tof2),
they are calculated by subtracting the random coincidences BetI(tof) and
BetII(tof1, tof2).

12

T etI(tof) = etI(tof)
T etII(tof1, tof2) = etII(tof1, tof2)

−

BetI(tof)

BetI(tof) = SC
BetII(tof1, tof2) = SC

BetII(tof1, tof2)

−

T P0 ·
·
T P0 ·
·
SC
·

T P0 ·

rtI(tof)
rtII(tof1, tof2)
rtI(tof1)
NRN D

·

2

·

−

+

etI(tof1)

·

rtP0 ·
rtI(tof2) + rtI(tof1)

rtI(tof2)

rtP0 ·

NRN D

etI(tof2)

·

(5)

The explanation for these formulas is given in in the appendix, see formulas
21 and 22.

3.3.2 Ion pair statistics

For each ion pair IIpair(j) there is a speciﬁc region IIregion(j) in the tof1
−
tof2 plane. Because the possible momentum correlation, e.g., emission into
opposite directions in a two body fragmentation, these regions are not neces-
sarily chosen rectangular, but rather like tilted ellipses. The number of counts
for an ion pair is deﬁned by the ion-ion maps:

tof1,tof2

X
in IIregion(j)
tof1,tof2

X
in IIregion(j)
tof1,tof2

X
in IIregion(j)

T CtsIIpair(j) =

T etII(tof1, tof2)

CtsIIpair(j) =

etII(tof1, tof2)

BCtsIIpair(j) =

BetII(tof1, tof2)

T CtsIIpair(j) = CtsIIpair(j)

BCtsIIpair(j)

−

The last equation is useful to assign error-bars to the number of true ion pairs

∆T CtsIIpair(j) = qCtsIIpair(j) + BCtsIIpair(j)

(6)

(7)

For the sake of simplicity, we did not use a proper error propagation formula
for BCtsIIpair(j). Instead, we simply considered qBCtsIIpair(j) a good
estimate of the statistical uncertainties of BCtsIIpair(j). Strictly speaking,
this is an underestimate of the statistical error, if the random background in
the single ion spectra etI(tof) is large, due to poor experimental conditions.
In that case

∆T CtsIIpair(j) = qCtsIIpair(j) + √2

BCtsIIpair(j)

(8)

·

13

can be used as an upper limit for ∆T CtsIIpair(j).

3.4 e-I coincidence diagrams

From the events containing exactly one electron and one ion, three diagrams
are created. Two of them have been deﬁned before. An electron spectrum
ES1(x) or the true electron spectrum for single ions: T ES1(x). The ion spec-
trum for the single ion events, etI(tof) or the true single ion events T etI(tof).
Now we deﬁne a 2D map etEI(x, tof) from the electron-ion-events. The total
number of the events coincides with the number of counts in ES1(x) and in
etI(tof). One can check the consistence of the deﬁnitions so far, and ﬁnd that
also the number of counts in the true electron spectrum T ES1(x) and the true
ion spectrum T etI(tof) is the same. Now we deﬁne the hypothetical quantity
HetEI(x, tof), the 2D map from the EI events, if there where no random ions.
In our formalism ions can be real or false, depending if they belong to the same
ion as the electron. According to this deﬁnition, the words ‘real’ and ‘false’
cannot be applied to an electron: there are no false electrons. (Detector noise
is considered an electron count without real ions.) So, etEI(x, tof) contains
only two contributions: pairs of electrons and real ions and pairs of electrons
and false ions. HetEI(x, tof) is related to the measured map etEI(x, tof) by:

etEI(x, tof)
Ne

= rtP0 ·

HetEI(x, tof)
Ne

+

HES0(x)
Ne

·

rtI(tof)
NRN D

etEI(x, tof)/Ne is the chance to detect an electron with the energy x and
and ion with the TOF t. HetEI(x, tof)/Ne is the chance to detect a real ion
with the TOF tof and an electron with the energy x. rtP0 is the chance to
detect no further ion. The second term describes the random contribution.
HES0(x)/Ne is the chance to detect an electron with the energy x without
a real ion. rtI(tof)/NRN D is the chance to detect a single false ion with the
TOF tof .

We substitute HES0(x) = T ES0(x)/rtP0 = ES0(x)/rtP0 and deﬁne the true
electron-ion map as T etEI(x, tof) = rtP0 ·

HetEI(x, tof)

(9)

(10)

etEI(x, tof) = T etEI(x, tof) +

ES0(x)
rtP0 ·

rtI(tof)
·
NRN D

and get the random contribution to etEI(x,tof)

14

BetEI(x, tof) =

ES0(x)
rtP0 ·

rtI(tof)
·
NRN D

−

T etEI(x, tof) = etEI(x, tof)

BetEI(x, tof)

(11)

The area of BetEI(x, tof) coincides with the area of BES1(x) and BetI(tof).
It is always the number of false e-I coincidences.

3.4.1 A remark about ion speciﬁc electron spectra

P

T etEI(x, tof) contains all information about the electrons detected in coin-
cidence with speciﬁc ions. So the corresponding ion speciﬁc electron spectra
tof
in Iregion(i) T etEI(x, tof). This method has
T ES1I(x, i) could be deﬁned as
a big disadvantage over the method based on ﬁltering the event list, described
above. Only the events with exactly one ion contribute to etEI(x, tof) – and
therefore to T etEI(x, tof). So, usually the statistics in T ES1I(x, i) get better
when T ES1I(x, i) is deﬁned as T ES1(x) when the time-ﬂight-range of the ions
is restricted to Iregion(i) in the ﬁltering of the event ﬁle. So the multiple ion
events with one ion in the interval Iregion(i) become single ion events and
contribute to T ES1I(x, i).

3.4.2 Ion-pair speciﬁc electron spectra

Now we will discuss how to determine the random background for the spec-
tra of electrons that are coincident with a speciﬁc pair of ions. Therefore we
formally introduce the 3D map etEII(x, tof1, tof2) that describes the distri-
bution of the electron–ion-pair events. It is related to etII(tof1, tof2) and to
ES2(x) by:

etII(tof1, tof2) = X

etEII(x, tof1, tof2)

all x

ES2(x) = X

all tof1,tof2

etEII(x, tof1tof2)

(12)

There will be no need to actually create this 3D array etEII(x, tof1, tof2) in
the computer’s memory. The results we will present, only make use of 2D
arrays.

The electron spectrum that belongs to a speciﬁc ion pair is called ES2IIpair(x, j).
It is the histogram of all electrons coincident with two ions in the region
IIregion(j).

15

ES2IIpair(x, j) =

etEII(x, tof1, tof2)

(13)

tof1,tof2

X
in IIregion(j)

Lets deﬁne the hypothetical 3D spectrum HetEII(x, tof1, tof2) that would
be there without the contribution of the random coincidences. Similar to the
considerations for etII(tof1, tof2) the relations between HetEII(x, tof1, tof2)
and etEII(x, tof1, tof2) these spectra is:

etEII(x, tof1, tof2)
Ne

= rtP0 ·

HetEII(x, tof1, tof2)
Ne

+

+

HetEI(x, tof1)
Ne
rtII(tof1, tof2)
NRN D

·

·

rtI(tof2)
NRN D
HES0(x)
Ne

+

rtI(tof1)

NRN D ·

HetEI(x, tof2)
Ne

(14)

Meaning that the electron that is detected in coincidence with two ions, can be
detected with two true ions, one true and one false ion, one false and one true
ion or a pair of false ions. We deﬁne the corresponding true electron-ion-ion
map T etEII(x, tof1, tof2) = rtP0 ·

HetEII(x, tof1, tof2) and get:

T etEII(x, tof1, tof2) = etEII(x, tof1, tof2)

rtI(tof2)

rtI(tof1)

T etEI(x, tof2)

T etEI(x, tof1)
rtP0 ·

·
NRN D

rtII(tof1, tof2)

−

−

−
ES0(x)
Ne

SC
rtP0 ·

·

·
rtP0 ·

NRN D

(15)

The true electron spectrum coincident with true ions in the region IIregion(j)
is deﬁned by:

T ES2IIpair(x, j) =

T tEII(x, tof1, tof2)

tof1,tof2

X
in IIregion(j)

(16)

So we deﬁne the corresponding random background BS2IIpair(x, j):

BES2IIpair(x, j) =

tof1,tof2

X
in IIregion(j)

T etEI(x, tof1)

rtI(tof2) + rtI(tof1)

T etEI(x, tof2)

·

rtP0 ·

NRN D

·

+

ES0(x)
Ne

tof1,tof2

X
in IIregion(j)

rtII(tof1, tof2)

SC
rtP0

·

16

T ES2IIpair(x, j) = ES2IIpair(x, j)

BES2IIpair(x, j)

−

∆T S2IIpair(x, j) = qES2IIpair(x, j) + BES2IIpair(x, j)

(17)

If the summation region IIregion(j) is extended to all ion-ion pairs (tof1 <
tof2) BES2IIpair(x, j) becomes equal to BES2(x).

There is no way to simplify the equation for BES2IIpair(x, j) any further.
The summation over all combinations of tof1 and tof2 in the II-region must
actually be carried out. This shows that in general the correlation of the true
ion and electron (described by T etEI(x, tof)) and the correlation of two false
ions (described by rtII(tof1, tof2)) must be considered for the background
subtraction. For the sake of simplicity, in the calculation of ∆T S2IIpair(x, j)
we did not use a proper error propagation formula for BES2IIpair(x, j). We
simply considered qBES2IIpair(x, j) a good estimate of the statistical un-
certainties of BES2IIpair(x, j). For reasonable experimental conditions, i.e. if
the area of TetEI(x,tof) is larger than the area of BetEI(x,tof) in the relevant
regions, this is a good estimate.

3.5 Angular distributions, KER spectra

In this paper, we only consider energy spectra of electrons and mass spectra
of ions and their correlations. Exactly the same formalism can be applied to
distributions with respect to any variable, e.g., emission angles or molecular
frame ﬁxed angles, linear momentum, kinetic energy release etc. All of this
quantities have to be calculated event by event from the detection positions
and the detection times of the particles.

4 Experimental results

As a test for the procedures we analyzed the coincidence data of the molecule
SF5CF3 taken at a photon energy of 746.95 eV. The chemically shifted F(1s)
photo lines where recorded in coincidence with ion pairs. This data set is an
ideal test for the methods described here, because F(1s) ionization leads al-
most inevitably to the production of at least two ions. The molecule does not
contain any hydrogen, which usually suﬀers from low detection eﬃciency in
this type of experiment. Most importantly, the molecule contains only one
carbon and one sulfur atom. Therefore a lot of forbidden ion fragment combi-
nations, containing either two carbon or two sulfur atoms appear in the data
before the subtraction of the random ion contributions. We know that the con-
tribution from these combinations must be exactly zero after the subtraction

17

+-CF3

+, CF2

+, CF+-CF3

of the random coincidences. Figure 3 shows the abundance of the most promi-
nent ion pairs. Among the 42 ion pairs, 16 pairs are forbidden, indicated by
the arrows. Without the subtraction of the random contribution (lower panel),
+ have
some of them e.g. CF+-CF2
intensities comparable to the dominating allowed peaks. After the subtraction
10 of the 16 forbidden pairs (62 percent) have zero intensity, within a 1 sigma
+ (2.5 sigma) all of then are zero within a two
error-bar, and except SF2
sigma error-bars. The error-bars were calculated using equation 7. After the
random subtraction no negative intensities occur. So there is also no overesti-
mation of the random background. You can also see, that some of the allowed
+. Without
ions pairs get zero intensity after the subtraction, e.g, SF2
the subtraction of the random background these ion pairs would have been
considered real.

+, and SF+-SF2

2+-CF3

+-SF3

The second test was even more strict. We set the photon energy to 687.9 eV
and recorded the resonant Auger electrons in the kinetic energy window from
644 eV to 657 eV. The contribution from ion pairs was very low. Only two ions
+. Even though the
+ - SF3
pairs were found to contribute CF2
ion pair production amounts in less than 1 percent of the events, the shape of
electron spectrum coincident with these ion pairs, is clearly diﬀerent from the
total electron spectrum. After the subtraction of the random background it
shows zero intensity for kinetic energies above 653 eV, in sharp contrast to the
non-coincident spectrum. These two examples clearly illustrate the non-trivial
eﬀects due to the contribution of the random coincidences that can easily lead
to severe misinterpretation of the data, if not considered correctly.

+ and CF3

+ - SF3

5 Conclusion

A comprehensive method for the treatment of random coincidence events that
appear in electron-ion-ion coincidence experiments is given and tested for the
fragmentation of SF5CF3 following F(1s) core excitation. The method pro-
duces reliable results even for high levels of random coincidences. The method
does not contain any adjustable parameters and removes all forbidden ion
pairs completely. This method is now used as a standard tool in the data eval-
uation of PEPIPI-coincidence data sets taken at the gas phase beamline SU27
at SPring8 in Japan. These data sets include large molecules with hundreds of
possible ion pair combinations. The same method can be used for laser based
multi-photon ionization experiments. For high peak powers > 1014 watt/cm2
multiple ionization becomes the main ionization process for molecules. Under
typical experimental conditions, even for low target density there is more than
one molecule ionized per laser shot, leading to a substantial contribution of
random coincidences.

18

6 Acknowledgements

The measurements were carried out with the approval of the SPring-8 program
review committee and were supported in part by Grants-in-Aid for Scientiﬁc
Research from the Japan Society for the Promotion of Science. The authors
are grateful to the staﬀ of SPring-8 for their help in the course of these studies.

7 Appendix

7.1 How to calculate T P0,1,2,3,4

The chance to ﬁnd no ion after an electron trigger, etP0, is the chance to ﬁnd
no true ion T P0 and no random ion rtP0; the chance to ﬁnd exactly one ion
is the chance to ﬁnd a true ion and no random ion plus the chance to ﬁnd no
true ion and exactly one random ion; and so on.

etP0 = rtP0 ·
etP1 = rtP1 ·
etP2 = rtP2 ·
etP3 = rtP3 ·
etP4 =

T P0
T P0 + rtP0 ·
T P0 + rtP1 ·
T P0 + rtP2 ·
T Pj
rtPi

i,j

X
i+j≥4

·

7.2 How to calculate P0,1,2,3,4

T P1
T P1 + rtP0 ·
T P1 + rtP1 ·

T P2
T P2 + rtP0 ·

T P3

(18)

P D. For example, the
The probability not to detect an ion is P D = 1
chance to detect exactly 3 true ions T P3 is the chance that exactly 3 true ions
are present P3 times the chance to detect all of them P D3 plus the chance
that 4 true ions are present times the chance to detect exactly 3 out of 4 ions
P D3. So for given values of PD and T P0,1,2,3,4 the values of P0,1,2,3,4
4
can be calculated from the following set of linear equations:

P D

−

·

·

T P0 = P0 + P1 ·
T P1 = P1 ·
T P2 = P2 ·
T P3 = P3 ·
T P4 = P4 ·

P D + P2 ·
P D
P D + 2
P2 ·
·
·
P D2 + 3
P D
P3 ·
·
P D3 + 4
P4 ·
P D
·
P D4

·
·

P D2 + P3 ·

P D + 3
·
P D2 + 6
P D3

2

P D3 + P4 ·
P3 ·
·
P D2
P4 ·
·

P D

P D4
P D + 4
P D2

·

P4 ·

·

3

P D

P D

·

(19)

19

7.3 How to calculate the statistical errors of T ES0,1,2,3(x)

rtP0,1,2,3,4 are known with good statistics. Their error and the error of c1,2,3
can be neglected, so the statistical errors of the electron spectra that belong
to the true coincidences can be calculated using the following equations:

∆T ES0(x) = qES0(x)

∆T ES1(x) = qES1(x) + c2
1 ·
∆T ES2(x) = qES2(x) + c2
2 ·
∆T ES3(x) = qES3(x) + c2
3 ·

ES0(x)

ES0(x) + c2
1 ·
ES0(x) + c2
2 ·

ES1(x)

ES1(x) + c2
1 ·

ES2(x)

(20)

7.4 How to calculate T etI(tof) and T etII(tof1, tof2)

Let us deﬁne the hypothetical spectra HetI(tof) and HetII(tof1, tof2) that
would be there without the contribution of the random coincidences. If an ion
is detected after an electron trigger, it can be a real or a false ion, i.e. it can
come from the same molecule like the electron or not. If two ions A and B are
detected, there are four possible cases, 1) A is real and B is real, 2) A is real
and B is false, 3) A is false and B is real, 4) A is false and B is false. So we
have the following relation between the ion spectra.

etI(tof1)
Ne

= rtP0 ·

HetI(tof1)
Ne

+ T P0 ·

rtI(tof1)
NRN D

etII(tof1, tof2)
Ne

= rtP0 ·

HetII(tof1, tof2)
Ne
rtI(tof2)
NRN D
rtII(tof1, tof2)
NRN D

·

+

HetI(tof1)
Ne

+ T P0 ·

+

rtI(tof1)

NRN D ·

HetI(tof2)
Ne

(21)

The ﬁrst equation is easy to understand. etI(tof1)/Ne is the chance to ﬁnd
exactly one ion and this ion has a TOF close to tof1 after an electron trigger.
rtP0 ·
HetI(tof1)/Ne is the chance to ﬁnd no false ion and a true ion with the
rtI(tof1)/NRN D is the chance to ﬁnd no true ion and
TOF close to tof1. T P0 ·
a false single ion with the TOF close to tof1.

Now let us consider the second equation. etII(tof1, tof2)/Ne is the chance to
ﬁnd exactly two ions and the ﬁrst ion has a TOF close to tof1 and the sec-
HetII(tof1, tof2)/Ne is the chance
ond ion has a TOF close to tof2. RP0 ·

20

to detect no false ion and one real ion with time of ﬂight tof1 and a second
real ion with time of ﬂight tof2. HetI(tof1)/Ne is the chance to detect a real
ion with the time of ﬂight tof1 and no further real ion, rtI(tof2)/NRN D is
the chance to detect a random ion with the TOF tof2 and no further ran-
dom ion, the third term is the same, with the two ions exchanged, T P0 ·
rtII(tof1, tof2)/NRN D is the chance detect no true ion and to detect a pair
of random ions with the times, tof1 and tof2 and no further random ion.
Analogue to the case of the true electron spectra T ES0,1,2,3,4(x) we deﬁne
HetII(tof1, tof2). We
HetI(tof), T etII(tof1, tof2) = rtP0 ·
T etI(tof) = rtP0 ·
call T etI(tof) and T etII(tof1, tof2) the true ion intensities. Using these deﬁ-
nitions, the equations 21 can be solved for T etI(tof) and T etII(tof1, tof2):

BetI(tof) = SC
T etI(tof) = etI(tof)

·

BetII(tof1, tof2) = SC

T P0 ·
−
T P0 ·
·
SC
·

rtI(tof)
BetI(tof)
rtII(tof1, tof2)
rtI(tof1)
NRN D

·

T P0 ·

rtP0 ·
rtI(tof2) + rtI(tof1)

rtI(tof2)

2

·

−

+

etI(tof1)

·

etI(tof2)

·

T etII(tof1, tof2) = etII(tof1, tof2)

BetII(tof1, tof2)

(22)

NRN D

rtP0 ·
−

To assign an error for T etI(tof) , we neglect the error in SC and T P0.

∆T etI(tof) = qetI(tof) + SC 2

T P 2
0 ·

·

rtI(tof)

(23)

7.5 Detector eﬃciency correction for the electrons and dead time eﬀects for

the ions

The detection eﬃciency of the electron detector depends on the detector po-
sition, i.e. on the energy of the electron. Therefore a correction is necessary.
We deﬁne a correction function e corr(x) whose values vary around 1. It is
deﬁned as the average detection eﬃciency divided by the position dependent
detection eﬃciency. It can be applied in the very end to all electron spectra
and the electron-ion coincidence map. It does not aﬀect the data treatment
mentioned before. So, for example, T ES2IIpair(x, j) is simply multiplied by
e corr(x) point by point.

The value of the dead time of the ion detector DT and the subsequent elec-
tronics can easily be determined from an analysis of the time diﬀerence of all
recorded ion pairs. In practice, the dead time eﬀects of the ion detector have

21

the strongest eﬀect on the ion spectrum containing all ions, T etAI(tof). They
can lead to an overestimation of BetAI(tof) and thus to negative intensity
behind a very intense peak in T etAI(tof). For a given detection time tdet and
a known dead time DT , the chance for a dead detector P DT (tdet) due to the
true ions is the number of electron triggered true ions inside the detection time
DT, tdet] divided by the number of electron triggers. The prob-
interval [tdet
ability to ﬁnd the detector alive is given by: P alive(tdet) = 1
P DT (tdet).
So the formula for the background subtraction including the dead-time is:

−

−

BetAI(tof) = SC
T etAI(tof) = etAI(tof)

·

rtAI(tof)

P alive(tof)

·

BetAI(tof)

−

(24)

As the calculation of P alive(tof) requires the knowledge of T etAI(tof) and
vise versa, one has to use an iterative method to obtain both. So in the ﬁrst
loop, set P alive(tof) equal to 1. Usually three iteration loops are suﬃcient.

The dead time has not only an eﬀect for the background subtraction of
T etAI(tof) but on most other spectra as well. Normally this eﬀect can be
neglected. For the sake of completeness we give a brief recipe how to treat
the dead time eﬀects in a simple way. We assumed that the chance to detect
a random ion is not eﬀected by the presence of the true ions. For high count
rates, this is not the case and the values of rtP0,1,2,3,4 redistribute because of
dead time eﬀects, so that the lower ion numbers become more dominant.

Now we go back to the approximation made earlier. We assumed that the
detection probability of a random ion after an electron trigger is equal to
the detection probability of a random ion after a random trigger. Knowing
P alive(tof) we can have a better estimate of this: So far we assumed that the

RNDAV 1 = rtP1 + 2

rtP2 + 3

rtP3 + 4

rtAI(tof)/NRN D(25)

·

·

rtP4 = X

t

·

is the average number of random ions detected in the presence of the true
ions. Know we know that

RNDAV 2 = X

t

rtAI(tof)

P alive(tof)/NRN D

·

(26)

is a much better estimate. Because of the dead time eﬀects, RNDAV 2 is
smaller than RNDAV 1. So, it is better to use modiﬁed values of rtP0,1,2,3,4.

Now we use a simple model to calculate the new values of rtP0,1,2,3,4. P DT
is the probability for the detector to be dead, because of the presence of the
true ions. For the sake of simplicity we assume that, P DT does not depend

22

on the number of ions detected or on the TOF of an ion. The probability to
be alive, is called P AT = (1
P DT ). P AT and P DT can be calculated from
RNDAV 1 and RNDAV 2:

−

P AT = RNDAV 2/RNDAV 1
P AT )
P DT = (1

−

(27)

0,1,2,3,4 are the modiﬁed values of rtP0,1,2,3,4. They are related to the mea-

RP ′
sured values by:

rtP ′
rtP ′

rtP ′
rtP ′
rtP ′

0 = rtP0 + rtP1 ·
1 = rtP1 ·
+ rtP4 ·
2 = rtP2 ·
3 = rtP3 ·
4 = rtP4 ·

P AT + rtP2 ·
P DT 3
P AT
·
·
P AT 2 + rtP3 ·
P AT 3 + rtP4 ·
P AT 4

P DT + rtP2 ·
P DT
·
4
P DT
P DT

·
·

P DT 2 + rtP3 ·
2 + rtP3 ·
P AT
·

P DT 3 + rtP4 ·
P DT 2
P AT
·

·

P DT 4
3

P AT 2
P AT 3

3 + rtP4 ·
4

·
·

P DT 2

P AT 2

·

6

·

(28)

The whole data treatment described above stays the same. Only the modiﬁed
values rtP ′
0,1,2,3,4 have to be used instead of rtP0,1,2,3,4. Then also the dead time
eﬀects of the ion detector will be considered.

23

Table 1
The symbols and their meaning

Ne

number of events with proper electron trigger
NRN D number of events with proper random trigger

etP0,1,2,3,4

rtP0,1,2,3,4

TP0,1,2,3,4

probability to detect 0,1,2,3 or 4 ions after an electron trigger

probability to detect 0,1,2,3 or 4 ions after a random trigger

probability to detect 0,1,2,3 or 4 true ions after an electron trigger

P0,1,2,3,4

probability for 0,1,2,3 or 4 true ions to be present after an electron trigger

PD detection eﬃciency of ions

AES(x)

spectrum of all electrons detected, Area(AES(x)) = Ne

ES0,1,2,3,4(x)

spectra of electrons detected in coincidence with 0,1,2,3,4 ions
e.g. Area(ES2(x)) = Ne

etP2

·

BES1,2,3(x)

random contribution to electron spectra ES0,1,2,3,4(x)

TES0,1,2,3(x)

true electron spectra, e.g. TES2(x)=ES2(x)-BES2(x)

Iregion(i) TOF-interval that contains speciﬁc ions

TES1I(x,i)

true electron spectrum, coincident with ions in the interval Iregion(i)

etAI(tof)

spectrum of all ions detected after electron triggers

rtAI(tof)

spectrum of all ions detected after random triggers

BetAI(tof)

random contribution to the ion spectrum etAI(tof)

TetAI(tof)

true ion spectrum TetAI(tof)=etAI(tof)-BetAI(tof)

etI(tof)

tof spectrum of the ions from single ion events triggered by electron detection

etII(tof1,tof2)

corresponding 2D ion TOF spectrum from ion pair events

rtI(tof), RII(tof1,tof2)

corresponding spectra for random triggers

TetI(tof), BetI(tof)

true single ion spectrum and background

TetII(tof1,tof2), BetII(tof1,tof2)

true ion pair 2D-spectrum and background

IIregion(j)

region in the tof1

tof2 plane, that contains a speciﬁc ion pair

−

CtsIIpair(j) number of ion pairs detected inside IIregion(j)

TCtsIIpair(j), BCtsIIpair(j) number of true ion pairs inside IIregion(j) and and background

etEI(x,tof)

2D electron position, ion tof spectrum from electron ion pair events

TetEI(x,tof), BetEI(x,tof)

corresponding true spectrum and background

ES2IIpair(x,j)

electron spectrum, coincident with in ion pairs inside IIregion(j)

TES2IIpair(x,j), BES2IIpair(x,j)

corresponding true electron spectrum and background

24

1200

1000

s
t
n
u
o
c

800

600

400

200

0

+

H2

+
F

4000

3000

s
t
n
u
o
c

2000

1000

0

1.30

1.35

1.40

1.45

1.50

1.55

3.7

3.8

3.9

4.0

4.1

ion time-of-flight in us  

ion time-of-flight in us  

+ and fast F+ ions. Produced
Fig. 2. Ion time of ﬂight spectrum including slow H2
upon F 1s ionization of CH3F. The thick black line is the spectrum produced from
all ions triggered by an electron. The thin line is the contribution of the random
coincidences derived from the spectrum of ions detected after random triggers. The
grey ﬁlled graph is the ions spectrum after background subtraction.

25

2
6

s
u
b
t
r
a
c
t
i
o
n

u
p
p
e
r

p
a
n
e
l
.

T
h
e

a
r
r
o
w
s

i
n
d
i
c
a
t
e

i

m
p
o
s
s
i
b
l
e

i
o
n

c
o
m
b
i
n
a
t
i
o
n
s
.

F
i
g
.

3
.

R
e
s
u
l
t

o
f

t
h
e

s
u
b
t
r
a
c
t
i
o
n

f
o
r

i
o
n

p
a
i
r
s
.

N
o

s
u
b
t
r
a
c
t
i
o
n

l
o
w
e
r

p
a
n
e
l
,

w
i
t
h

+
+
  /  CF

C

C

+
  /  SF2

2+

+
+
  /  SF

C

C

+
  /  SF2

+

+
+
  /  CF
F

+
  /  SF2
F

2+

+
+
  /  SF
F

+
  /  SF2
F

+

+
  /  SF2
CF

2+

+
  /  CF3
CF

+

S

+
  /  SF2

2+

+
+
  /  SF
S

+
  /  SF2
S

+

2+

SF2

  /  CF2

2+

SF2

  /  CF3

2+

SF2

  /  SF3

+

+

+

CF2

+
  /  SF3

+

+
  /  SF3
SF

+

SF2

+
  /  SF3

+

2
0
0

4
0
0

6
0
0

8
0
0

0

1
0
0
0

1
0
00

2
0
0

3
0
0

4
0
0

5
0
0

6
0
0

+
+
  /  S
F

+
+
  /  S
F

counts

+
+
  /  F

C

+
+
  /  S

C

C

+
  /  CF2

+

C

+
  /  CF3

+

C

+
  /  SF3

+

+
  /  CF2
F

+

+
  /  CF3
F

+

+
  /  CF2
CF

+

+
  /  SF3
F

+

+
  /  CF2
S

+

+
  /  CF3
S

+

+
  /  SF3
S

+

2+

+
  /  SF

SF2

2+

SF2

  /  SF2

+

CF2

+
  /  CF3

+

+
  /  SF2
SF

+

CF3

+
  /  SF3

+

+
+
  /  SF
CF

+
  /  SF2
CF

+

+
  /  SF3
CF

+

CF2

+
  /  SF2

+

+
  /  CF3
SF

+

+
+
  /  CF

C

C

+
  /  SF2

2+

+
+
  /  SF

C

C

+
  /  SF2

+

+
+
  /  CF
F

+
  /  SF2
F

2+

+
+
  /  SF
F

+
  /  SF2
F

+

+
  /  SF2
CF

2+

+
  /  CF3
CF

+

+
  /  SF2
S

2+

+
+
  /  SF
S

+
  /  SF2
S

+

2+

SF2

  /  CF2

2+

SF2

  /  CF3

2+

SF2

  /  SF3

+

+

+

CF2

+
  /  SF3

+

+
  /  SF3
SF

+

SF2

+
  /  SF3

+

counts

+
+
  /  F

C

+
+
  /  S

C

C

+
  /  CF2

+

C

+
  /  CF3

+

C

+
  /  SF3

+

+
  /  CF2
F

+

+
  /  CF3
F

+

+
  /  SF3
F

+

+
  /  CF2
CF

+

+
  /  CF2
S

+

+
  /  CF3
S

+

+
  /  SF3
S

+

2+

+
  /  SF

SF2

2+

SF2

  /  SF2

+

CF2

+
  /  CF3

+

+
  /  SF2
SF

+

CF3

+
  /  SF3

+

+
+
  /  SF
CF

+
  /  SF2
CF

+

+
  /  SF3
CF

+

CF2

+
  /  SF2

+

+
  /  CF3
SF

+

3
20x10

s
t
n
u
o
c

15

10

5

0

80

60

40

20

0

s
t
n
u
o
c

644

646

648

650

652

654

656

electron kinetic energy in eV

 coincident counts
 random background
 difference

644

646

648

654
electron kinetic energy in eV

650

652

656

Fig. 4. Result of the subtraction for ion pairs in the resonant Auger spectrum at a
photon energy of 787.9 eV. Here we have a very low level of ion pair production.
Upper panel, total electron spectrum, Lower panel, electrons coincident with ion
pairs.

27

References

[1] M. Lavol’ee, V. Brems, J. Chem. Phys. 110 (1999) 918.

[2] Y. Muramatsu, K. Ueda, N. Saito, H. Chiba, M. Lavoll´ee, A. Czasch, T. Weber,
O. Jagutzki, H. Schmidt-B¨ocking, R. Moshammer, U. Becker, K. Kubozuka, I.
Koyano, Phys. Rev. Lett. 88 (2002) 133002.

[3] K. Ueda and J.H.D. Eland, J. Phys. B: At. Mol. Opt. Phys. 38 (2005) S839;

and references cited therein.

Rev. Lett. 79 (1997) 2435.

[4] F. Heiser, O. Gessner, J. Viefhaus, K. Wieliczek, R. Hentges, U. Becker, Phys.

[5] A. Lafosse, M. Lebech, J. C. Brenot, P. M. Guyon, O. Jagutzki, L. Spielberger,

M. Vervloet, J. C. Houver, D. Dowek, Phys. Rev. Lett. 84 (2000) 5987.

[6] A. Landers, Th. Weber, I. Ali, A. Cassimi, M. Hattaass, O. Jagutzki, A. Nauert,
T. Osipov, A. Staudte, M.H. Prior, H. Schmidt-B¨ocking, R. D¨orner, Phys. Rev.
Lett. 87 (2001) 013002.

[7] A. De Fanis, N. Saito, A.A. Pavlychev, D.Yu. Ladonin, M. Machida, K.
Kubozuka, I. Koyano, K. Okada, K. Ikejiri, A. Cassimi, A. Czasch, R. D¨orner,
H. Chiba, Y. Sato, K. Ueda, Phys. Rev. Lett. 89 (2002) 023006.

[8] C. Miron, M. Simon, N. Leclercq, D.L. Hansen, and P. Morin, Phys. Rev. Lett.

81 (1998) 4104.

[9] O. Kugeler, G. Pr¨umper, R. Hentges, J. Viefhaus, D. Rolles, U. Becker, S.

Marburger, U Hergenhahn, Phys. Rev. Lett. 93 (2004) 033002.

[10] G. Pr¨umper, Y. Tamenori, A. De Fanis, U. Hergenhahn, M. Kitajima, M.
Hoshino, H. Tanaka, K. Ueda, J. Phys. B: At. Mol. Opt. Phys. 38 (2005) 1.

[11] D. Rolles, M. Braune, S. Cvejanovic , O. Geßner, R. Hentges, S. Korica, B.
Langer, T. Lischke, G. Pruemper, A. Reinkoester, J. Viefhaus, B. Zimmermann,
V. McKoy, U. Becker, Nature 437 (2005) 711.

[12] B. K¨ammerling, B Kr¨assigm V. Schmidt, J. Phys. B: At. Mol. Opt. Phys. 25

(2005) 3621.

[13] G. Pr¨umper, K. Ueda, U. Hergenhahn, A. De Fanis, Y. Tamenori, M. Kitajima,
M. Hoshino, H. Tanaka, J. Electron Spectrosc. Relat. Phenom. 144-147 (2005)
227.

[14] H. Ohashi, E. Ishiguro, Y. Tamenori, H. Kishimoto, M. Tanaka, M. Irie, T.
Tanaka, T. Ishikawa, Nucl. Instrum. Methods Phys. Res. A 467-468 (2001) 529.

[15] H. Ohashi, E. Ishiguro, Y. Tamenori, H. Okumura, A. Hiraya, H. Yoshida, Y.
Senda, K. Okada, N. Saito, I.H. Suzuki, K. Ueda, T. Ibuki, S. Nagoka, I. Koyano,
T. Ishikawa, Nucl. Instrum. Methods Phys. Res. A 467-468 (2001) 533.

[16] T. Tanaka, H. Kitamura, J. Synchrotron Radiat. 3 (1996) 47.

28

