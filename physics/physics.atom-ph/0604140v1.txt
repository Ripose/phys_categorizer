Theoretical model for ultracold molecule formation
via adaptive feedback control

Ulrich Poschinger, Wenzel Salzmann, Roland Wester, and
Matthias Weidem¨uller
Physikalisches Institut der Universit¨at Freiburg, Hermann-Herder-Str. 3, 79104
Freiburg, Germany

E-mail: roland.wester@physik.uni-freiburg.de

Christiane P. Koch and Ronnie Kosloﬀ
Department of Physical Chemistry and The Fritz Haber Research Center, The
Hebrew University, Jerusalem 91904, Israel

E-mail: ckoch@fh.huji.ac.il

PACS numbers: 33.80.-b,32.80.Qk,34.50.Rk,33.90.+h

Abstract. We investigate pump-dump photoassociation of ultracold molecules
with amplitude- and phase-modulated femtosecond laser pulses. For this purpose
a perturbative model for the light-matter interaction is developed and combined
with a genetic algorithm for adaptive feedback control of the laser pulse shapes.
The model is applied to the formation of 85Rb2 molecules in a magneto-optical
trap. We ﬁnd for optimized pulse shapes an improvement for the formation of
ground state molecules by more than a factor of 10 compared to unshaped pulses
at the same pump-dump delay time, and by 40% compared to unshaped pulses
at the respective optimal pump-dump delay time. Since our model yields directly
the spectral amplitudes and phases of the optimized pulses, the results are directly
applicable in pulse shaping experiments.

6
0
0
2
 
r
p
A
 
8
1
 
 
]
h
p
-
m
o
t
a
.
s
c
i
s
y
h
p
[
 
 
1
v
0
4
1
4
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Theoretical model for ultracold molecule formation via adaptive feedback control

2

1. Introduction

One of the challenges in contemporary atomic and molecular physics is the making of
ultracold molecular samples [1, 2, 3]. Direct cooling techniques for molecules have not
yet reached the ultracold regime (T < 1 mK). Instead, ultracold atoms are assembled
to molecules using magnetic Feshbach resonances [4] or photoassociation [5, 6].
In
the latter case, typically a continuous-wave (cw) laser excites a pair of colliding atoms
into a long-range molecular state. Subsequent spontaneous emission leads to molecules
in their electronic ground state. In view of prospective applications, stable ultracold
molecules, i. e. molecules in their absolute rotational, vibrational and electronic ground
state are required. However, molecules formed with Feshbach resonances are created
in the highest bound vibrational level [4]. Photoassociation with a cw laser followed
by spontaneous emission forms molecules in a range of vibrational levels [7].
In
this case, the radiative lifetime of the excited electronic state ultimately represents
the rate-determining step in ground state molecule formation. When applied to a
Bose-Einstein condensate (BEC), the incoherent nature of the spontaneous decay
furthermore destroys the coherence of the BEC and hence the condensate itself [8].
This may be avoided by stimulated Raman transitions [9]. Recently, also light-
driven Rabi oscillations between atoms and molecules have been observed [10]. Using
cw photoassociation in combination with nanosecond pulsed Raman transitions, the
formation of RbCs molecules in the v = 0 level of the ground electronic state has been
achieved [11].

An alternative approach to ultracold molecule formation is the photoassociation
with time-dependent laser ﬁelds of femtosecond to picosecond pulse durations. The
conceptually simplest pulsed photoassociation scheme is based on a two-pulse pump-
dump population transfer from the atomic continuum to a bound molecular level [12],
as shown in ﬁgure 1. The pump pulse excites a molecular wavepacket of the vibrational
states within its bandwidth, which then propagates until it is dumped to the ground
state by a second laser pulse. By modifying the delay time between the two pulses,
the transition to one or several desired target vibrational levels in the ground state
can be enhanced by quantum interference. Here, the production rate is not limited
by the radiative lifetime time of the intermediate state, but by the much shorter
vibrational period, by the Franck-Condon factors and ultimately by the unitarity limit
of the scattering rate [8, 13]. The particular advantage of this approach is that the
pump-dump delay time and the pulse shapes yield additional control knobs to prepare
speciﬁc product states, which is extensively explored in the ﬁeld of adaptive feedback
control with shaped femtosecond pulses [14, 15]. A number of theoretical studies have
investigated the use of chirped laser pulses for excitation [16, 17, 18] and stabilization
[19, 20] of ultracold molecules. Even larger control over the molecule formation process
might be obtained by shaped laser pulses. Laser pulses which optimize the formation
of ultracold molecules from an atomic BEC were calculated using optimal control
theory [21]. However, the complexity of the resulting optimal pulse shapes requires a
careful transformation into experimentally achievable pulse shapes [22, 23].

In this paper, adaptive feedback control of photoassociation with femtosecond
laser pulses is investigated theoretically. For this purpose the properties of typical
femtosecond oscillator pulses and a realistic pulse shaping device are combined with
a closed loop genetic algorithm for pulse shape optimization. The resulting pulse
shapes are obtained as amplitudes and phases in the frequency domain, similar to
the case in closed-loop adaptive feedback control experiments. The parameters of

Theoretical model for ultracold molecule formation via adaptive feedback control

3

Figure 1. The pump-dump scheme for the production of ultracold molecules
with short laser pulses. A wavepacket is created in the excited state by a pump
pulse (1) and subsequently propagates (2). A dump pulse transfers population to
the target bound ground state level after a suitable time delay (3).

the calculations are chosen to correspond to a situation, which is typical for state-
of-the-art experiments [24]. A two-channel model is employed, which simpliﬁes the
complex coupled-channel dynamics, but retains the important features of pump-dump
photoassociation. The goal of this study is to qualitatively determine to which extent
the formation process of ground state molecules can be controlled by realistic shaped
laser pulses.

A ﬁrst experiment on photoassociation with femtosecond laser pulses was carried
out on hot mercury atoms [25].
In the ultracold regime, electronically excited
Na2 molecules were formed using picosecond pulses near-resonant to the sodium D1
transition, and probed with a subsequent laser pulse [26]. Chirped nanosecond laser
ﬁelds have been employed to enhance inelastic collision rates in an ultracold gas [27].
Recently, adaptive feedback control with shaped femtosecond pulses has been applied
in our group to optimize the dissociation of ultracold Rb2 molecules from a magneto-
optical trap [24]. Also the eﬀect of the chirp of femtosecond pulses on the dissociation
of ultracold Rb2 molecules has been investigated [28]. We envision that the work
presented in this paper will be helpful for the ﬁrst experimental demonstration of
ultracold ground state molecule formation using pulsed photoassociation, which has
not been achieved to date.

The paper is organized as follows: the model of two colliding atoms interacting
with the laser ﬁelds is described in section 2.1. A perturbative treatment of the
interaction with the ﬁeld is employed in section 2.2 to obtain a model for the
Its optimization with a genetic algorithm is outlined in
pulse shaping device.
section 2.3. The results are presented in section 3: The validity of the perturbative
is tested in section 3.1 by comparison to full, non-perturbative quantum
model
calculations.
In section 3.2 and section 3.3 the results for optimal laser pulses for
pulsed photoassociation, as obtained from adaptive feedback control are presented

Theoretical model for ultracold molecule formation via adaptive feedback control

4

and analyzed.

2. Model for the photoassociation process

2.1. Interaction of two colliding atoms with a laser ﬁeld

A colliding atom pair subject to a laser pulse is considered. Two electronic states
coupled by the radiation ﬁeld are taken into account. The center-of-mass motion
of the two atoms is assumed to be decoupled from the internuclear dynamics. The
time-dependent Schr¨odinger equation then reads

with

i¯h

∂
∂t (cid:18)

ψg(R, t)
ψe(R, t) (cid:19)

= ˆH

ψg(R, t)
ψe(R, t) (cid:19)

(cid:18)

ˆH =

ˆT + Vg(R)
¯hΩ∗(t)

(cid:18)

¯hΩ(t)
ˆT + Ve(R) − ∆ (cid:19)

.

(1)

(2)

The wavefunction consists of one component for the ground state, Ψg(R, t), and one
component for the excited state, Ψe(R, t). The diagonal elements of the Hamiltonian
are given by the kinetic energy operator ˆT and the potential energy curves for the
respective states Vg/e(R) which depend on the internuclear separation R. The zero
of energy is chosen to correspond to the ground state dissociation limit. Within the
rotating wave approximation, Ve is shifted by the detuning ∆ w.r.t.
to Vg where
∆ = ¯h(ωge − ωL). ωge denotes the atomic transition frequency and ωL the carrier
frequency of the laser. The oﬀ-diagonal elements of the Hamiltonian are given by the
complex time-dependent Rabi frequency Ω(t), which is related to the electric ﬁeld ˜E(t)
by Ω(t) = µ ˜E(t)/¯h. Here, µ denotes the dipole matrix element of the two molecular
electronic states under consideration.
In the following, the R-dependence of this
matrix element is neglected and its asymptotic value is employed, µ = 2.537 · 10−9 Cm
for the Rb D1 line. The laser pulse is assumed to be derived from a Gaussian transform-
limited pulse sent through a pulse shaping device as detailed in section 2.3.

The two channels under consideration for the calculations are the singlet ground
state X 1Σg(5s + 5s) and the excited state 0+
u (5s + 5p1/2) of 85Rb2. The wavelength
of the asymptotic (atomic) transition corresponds to 794.9nm. The potential energy
curves are derived from ab initio data [29] at short distances and long-range dispersion
potentials (−C3/R3) − C6/R6 − C8/R8. The coeﬃcients for the 5s + 5s asymptote
are found in [30], while the coeﬃcients for the 5s + 5p asymptote are taken from
[31]. The Hund’s case (c) representation of the potential energy curves is obtained
by diagonalizing the Hund’s case (a) potentials coupled by spin-orbit interaction
[32]. The spin-orbit coupling matrix element is set to the atomic value. The R-
dependence and the resonant character of the spin-orbit coupling are neglected. The
latter leads to strong perturbations in the vibrational spectrum [33] providing an
eﬃcient stabilization mechanism for pump-dump photoassociation [20]. However, its
treatment would require a three-channel model, and the focus of this study is on the
qualitative understanding of possible control over the wavepacket dynamics.

The Hamiltonian (2) is represented on a grid using the mapped Fourier grid
method [34, 35]. A grid of 1024 points extending up to 27000 Bohr radii was chosen.
This size is necessary to obtain a reliable representation of continuum scattering states
[18]. The binding energies Eg/e
(R) of the vibrational levels
were computed by diagonalizing the Hamiltonian (2) with Ω(t) = 0. Franck-Condon

and wavefunctions ϕg/e

v

v

Theoretical model for ultracold molecule formation via adaptive feedback control

5

factors are then obtained as scalar products, |hv|wi|2 =
w(R)|2. To test
ϕg
the validity of the perturbative model which is explained in the next section, the time-
dependent Schr¨odinger equation (1) is solved with the Chebyshev propagator method
[36].

dR|ϕe

R

∗
v(R)

The initial state of the colliding atom pair is chosen such as to describe an
ultracold atomic gas in a magneto-optical trap. Due to the low temperatures of about
100 µK, only a narrow band of continuum states above the ground state potential
asymptote is occupied. The considerations in this study focus on a single initial
continuum state with collisional angular momentum l = 0, i.e. an s-wave scattering
state. This assumption is justiﬁed since the continuum wavefunctions corresponding
to temperatures T ≤ 500 µK possess an identical nodal structure at short and
intermediate internuclear distances. A thermal average over all possible initial states
is only required for absolute molecule formation rates, which is beyond the scope of
the present study.

2.2. Model of the photoassociation process with shaped laser pulses

In the following a perturbative model of pump-dump photoassociation with arbitrarily
phase and amplitude modulated laser pulses is presented. Such shaped laser pulses are
prepared experimentally by passing the spectrally dispersed pulses through a liquid
crystal modulator array.
In each pixel of such a pulse shaper the phase and the
amplitude of the corresponding frequency component of the pulse can be computer
controlled.

The photoassociation pulse creates a time-dependent wavepacket in the excited
state. After the pulse is oﬀ, the excited state wavefunction ψe(R; t) is given by a
superposition of vibrational levels in the excited state.
If the interaction can be
treated perturbatively, i.e. the Rabi angle, θ =
Ω(t) dt, is small compared to π,
the pulse excites the superposition of vibrational levels given by [37]

R

Ψe(R; t) ∝

av E(ωv)hv|Ei ϕv(R) e

−iEe

v t/¯h ,

(3)

Xv

where hv|Ei is the overlap integral of the initial continuum state |Ei and the excited
its square corresponds to the free-bound Franck-Condon
state vibrational level v;
factors. The frequency spectrum of the electric ﬁeld of the laser pulse, E(ω),
is
evaluated at the transition frequency ωv to the vibrational level v. The av coeﬃcients
are introduced to represent the complex modulation coeﬃcients of a pulse shaper.
This description assumes that the frequency components for each contributing v are
individually resolved by the pulse shaper. As one can experimentally only diminish
spectral components, one obtains the constraint 0 ≤ |av| ≤ 1.

Equation (3) is only valid, if the pulse does not contain signiﬁcant amplitude at
frequencies close to resonance with the atomic transition. This is due to the strongly
increasing transition strength close to resonance, which leads to a break-down of the
perturbative treatment for typical laser intensities. We estimate that for laser pulses
with a Gaussian spectral proﬁle, as utilized in the calculations below, the perturbative
model is valid, if the detuning of the center frequency of the laser pulse w.r.t. the
atomic transition is larger than the root-mean-square width of its spectral proﬁle.

After a delay time ∆t, a second or dump pulse E ′(ω) is applied. This pulse
transfers population from the excited state to the ground state; it is assumed to be
not shaped by a pulse shaper. The resulting superposition of bound ground state levels

Theoretical model for ultracold molecule formation via adaptive feedback control

6

reads

Ψbound
g

(R; t) ∝

avE(ωv)E

(ωvw)

′

Xv,w

hE|vihv|wi ϕw(R)e

− i

¯h Eg

w(t−∆t)e

− i

¯h Ee

v∆t .

(4)

Note that this description is only valid for non-overlapping pulses, because transient
dynamics that occur during the excitation process are not included. In (4), w runs
over all bound vibrational levels of the ground state. The hv|wi are overlap integrals
between ground and excited state bound levels. The time delay between the two pulses
enters the expression through the phase factors e−iEe
v∆t/¯h which corresponds to the
propagation of the wavepacket in the excited state. The population of an individual
bound ground state level w is now given by

|bw|2 =

ava

∗
v′ E(ωv)E

′

∗

′∗

(ωvw)E

(ωv′ )E

(ωv′w)

Xv,v′

· hE|vihv|wihw|v

ihv

|Eie

′

′

− i

¯h (Ee

v

−Ee

v′ )∆t .

This expression can be concisely written as a complex quadratic form in terms of the
pulse modulation coeﬃcients av,

|bw|2 =

′

∗
v′ M vv

a

w (∆t) av.

Xv,v′

′

The Franck-Condon matrix M vv
w (∆t) contains the properties of the system (overlap
integrals and binding energies) and of the frequency spectrum of the two laser pulses
and their pulse delay.

It can be inferred from (6) that the choice of modulating the pump pulse and not
the dump pulse is in fact arbitrary, since the same structure of (6) is obtained if the
dump pulse or both pulses are shaped. Equation (6) serves two purposes: First, for
a given target level w, it can be used to obtain the optimal detuning of the pulses by
evaluating |bw|2 for diﬀerent delay times ∆t. Second, it allows for the implementation
of an optimization procedure as explained in the following section.

2.3. Genetic algorithm for the pulse optimization

In the following, the photoassociation pulse shall be optimized while the dump
pulse is assumed to be transform-limited. An optimization algorithm is obtained
by combining the analysis of the target state (6) with a spectral decomposition of the
pulse. The photoassociation pulse which yields the desired excited state wavepacket
can in principle be spectrally composed from a set of weighted delta functions at
the transition frequencies corresponding to the vibrational states v [37]. Since this
spectrum of a few sharp structures leads to very long pulses in time domain, the
photoassociation pulse is instead constructed from a larger set of delta functions,

(5)

(6)

(7)

Ω(t) = µ

cnE(ωn)ei(ωn−ω0)t .

Np

Xn=1

The frequency spectrum of the pump and dump laser pulses before modiﬁcations
by the pulse shaper is assumed to be a Fourier limited Gaussian pulse E(ωn) ∝
exp [−(ωn − ω0)2/2Γ2] with a root-mean-square width Γ. Each ωn corresponds to
a pixel in the pulse shaper mask, ω0 is the center frequency of the laser pulse. The

Theoretical model for ultracold molecule formation via adaptive feedback control

7

pixel number Np is set to 640, which is a number used in commercially available pulse
shaping devices. This implies that the pulse shaper has a ﬁner frequency resolution
than the spacing of the excited vibrational levels. The pulse shaper coeﬃcients cn are
set equal to the desired superposition coeﬃcients av from (6), where v is the excited
state level for which ¯hEv is closest to ωn. The range of vibrational levels which
contribute to the population in the excited state is identiﬁed by the non-vanishing
matrix elements of M vv
w . In the present case, this range consists of 150 levels ranging
from v = 170 (Tvib = 0.77 ps) to v = 320 (Tvib = 80.0 ps). The discreteness of the
spectrum (7) still leads to unwanted replica eﬀects in the time domain. The pulse is
therefore multiplied with a box function of the form exp [−(t − tPeak)2m/(2T 2m)] with
m ≥ 1. This provides a smooth switching on and oﬀ of the pulse.

′

The optimization is carried out with respect to the av in (6). It turned out that
for the amplitude optimization it is suﬃcient to set av to either 0 or 1. 256 possible
values of the phase were considered, leading to an overall 9-bit optimization of the
av. The pump-dump delay time ∆t represents a ﬁxed parameter for the optimization
process. The quality of the pulses is determined by the ﬁtness factor Q which is chosen
as

(8)

(9)

p
Here, ht2i is a measure of the pulse duration,

Q =

|bw|2
ht2i

.

ht2i =

t2 Ω(t) dt
Ω(t) dt

.

R

R

It is included in the deﬁnition of the ﬁtness factor in order to keep the pulses as
short as possible. This is necessary since the duration of the pulses is immensely
increased by the modulation: Already a linear frequency chirp stretches the pulse in
time. Equation (3), however, is valid only after the pump pulse is over since transient
dynamics occurring during the pulse are not taken into account [38]. Therefore only
delay times ∆T that are large compared to the duration of the pump and dump pulses
are chosen.

The optimization of the formation of molecules in a speciﬁc ground state level
w is carried out by means of an evolutionary algorithm. This corresponds directly
to a close-loop experiment. The evolutionary algorithm SimpleGA from the GALib
package is employed ‡. Populations of 20 individuals were used, and the number
of generations was set to 1000. This is suﬃcient to obtain convergent results. The
mutation and crossover probabilities were chosen as 0.005 and 0.8, respectively.

3. Results

3.1. Validity of the pulse shaper model

The pulse shaper model of (6) is derived for the case of a small perturbation of
the atom pair by the laser ﬁeld. Higher order processes, in particular Rabi cycling
during the pump or dump pulses, are neglected. By carrying out calculations for a
single unshaped pump pulse with varying pulse energy, the regime of validity of the
perturbative approximation is analyzed.

‡ http://lancet.mit.edu/ga

Theoretical model for ultracold molecule formation via adaptive feedback control

8

 (cid:13)

 

0,020(cid:13)

0,015(cid:13)

0,010(cid:13)

0,005(cid:13)

 

n
o

i
t

l

a
u
p
o
p

 

t

e
a
t
s
 

d
e

t
i
c
x
e

 
l

a

t

o
T

]
s
t
i

n
u

 
.

b
r
a

l

[
 
s
e
v
e

l
 

d
n
u
o
b

 

n

i

0,000(cid:13)

0(cid:13)

2x10(cid:13) 6(cid:13)

4x10(cid:13) 6(cid:13)
6x10(cid:13) 6(cid:13)
Intensity [W/cm(cid:13) 2(cid:13)](cid:13)

8x10(cid:13) 6(cid:13)

1x10(cid:13) 7(cid:13)

Figure 2. Dependency of the excitation probability on the pump pulse energy
for ﬁxed duration τ = 0.06ps. The linear dependence on pulse energy below 5 nJ
shows the validity of a perturbative treatment.

In ﬁgure 2 the probability to excite an atom pair to the excited state is shown
as a function of the laser pulse energy. These results are obtained by solving the
time-dependent Schr¨odinger equation where the ﬁeld is treated non-perturbatively.
Figure 2 clearly shows a linear dependence of the excitation probability for small
intensities < 4 · 106 W/cm2. For these low intensities the eﬀect of the laser ﬁeld can
be treated in ﬁrst order perturbation theory. For larger pulse energies the excitation
starts to saturate, which indicates the transition to a non-perturbative regime. This
is attributed to Rabi cycling and strong oﬀ-resonant excitations.

In order to check the validity of (6) in the perturbative regime, a model study was
performed. The excitation of a vibrational wavepacket in the excited state, ψe(R; t)
is calculated with (3) for a single Fourier-limited Gaussian pump pulse. The detuning
of the pulse was set to ∆ ≈ 251 cm−1 and the width to 100 fs FWHM. In ﬁgure 3, the
projections of the excited state wavepacket onto the excited vibrational eigenfunctions
v(R) are shown as a function of binding energy, Ee
ϕe
v (solid line). This is compared in
ﬁgure 3 to the non-perturbative calculation for the same pulse parameters (squares).
Good agreement of the projections is observed in the range of resonant levels.

As described above, the perturbative pump-dump model is only valid for non-
overlapping pulses, because transient dynamics occurring during the pulsed excitation
are not included. Therefore, in a second step it is checked if (6) holds for two-pulse
pump-dump processes. Assuming two pulses with width and detuning, as given above,
the pump-dump process was calculated with (5) for varying delay time. This yields
the ground state wavepacket which is then projected onto the target vibrational level
119 =6.86 cm−1. The population in this target level is shown in
w = 119, bound by Eg
ﬁgure 4 (solid line) as a function of the pump-dump delay time. It is compared to
the results obtained by solving the time-dependent Schr¨odinger equation (squares).
The agreement between the perturbative model and the full quantum dynamics with
a non-perturbative treatment of the ﬁeld is convincing.

(cid:13)
(cid:13)
(cid:13)
Theoretical model for ultracold molecule formation via adaptive feedback control

9

0(cid:13)
-500(cid:13)

-400(cid:13)

-200(cid:13)

-300(cid:13)
Detuning [cm(cid:13) -1(cid:13)](cid:13)

-100(cid:13)

0(cid:13)

Figure 3. Comparison between the predicted excited state level populations
after the pump pulse from the model (solid line) and the results of the quantum
dynamical calculation (squares).

 (cid:13)

 (cid:13)

 

 

1x10(cid:13) -8(cid:13)

9x10(cid:13) -9(cid:13)

8x10(cid:13) -9(cid:13)

7x10(cid:13) -9(cid:13)

6x10(cid:13) -9(cid:13)

5x10(cid:13) -9(cid:13)

4x10(cid:13) -9(cid:13)

3x10(cid:13) -9(cid:13)

2x10(cid:13) -9(cid:13)

1x10(cid:13) -9(cid:13)

]
s
t
i

n
u

 
.

b
r
a

[
 

n
o

i
t

l

a
u
p
o
p
e

 

t

a

t
s
 

d
e

t
i
c
x
E

 

]
s
t
i

n
u

 
.

b
r
a

[
 

n
o

i
t

l

a
u
p
o
p

 
t

e
g
r
a
T

1.2(cid:13)

0.9(cid:13)

0.6(cid:13)

0.3(cid:13)

0.0(cid:13)

0(cid:13)

5(cid:13)

10(cid:13)

15(cid:13)

20(cid:13)

pump-dump delay [ps](cid:13)

Figure 4. Target state population |bw|2 for w = 119 from (6) (solid line)
compared to the results of the quantum dynamical calculation (squares). The
peaks are closely connected to the wavepacket dynamics in the excited state
potential well. The temporal smearing out of peak heights is due to anharmonic
dispersion of the wavepacket.

Note that in the present case, the optimal pump-dump delay is given by the full
excited state wavepacket round-trip time Tvib and integer multiples thereof. According
to the Franck-Condon principle, this indicates that the dump transition occurs at the
outer turning point of the excited state wavepacket, as indicated in ﬁgure 1. This is
not necessarily the case, since it depends strongly on the molecular potential curves
and the laser detuning. The dump transition will occur at half-integer multiples of
T , corresponding to the inner turning point if the potential facilitates a deceleration
mechanism at short distances. This is the case for a soft repulsive wall such as in the
outer well of the 0−
g (p3/2) state [19], or for resonant coupling [20].

(cid:13)
(cid:13)
(cid:13)
(cid:13)
Theoretical model for ultracold molecule formation via adaptive feedback control

10

 (cid:13)

]

1
-

i

m
c
[
 
g
n
n
u
t
e
d
 
l
a
m

i
t
p
O

0(cid:13)

-1000(cid:13)

-2000(cid:13)

-3000(cid:13)

-4000(cid:13)

-5000(cid:13)

-6000(cid:13)

-7000(cid:13)

1E-4(cid:13)

1E-5(cid:13)

1E-6(cid:13)

1E-7(cid:13)

1E-8(cid:13)

1E-9(cid:13)

 

1E-10(cid:13)

1E-11(cid:13)

1E-12(cid:13)

1E-13(cid:13)

1E-14(cid:13)

1E-15(cid:13)

l

](cid:13)
s
t
i
n
u
 
.
b
r
a
[
 
n
o
i
t
a
u
p
o
p
 
e
t
a
t
s
 
t
e
g
r
a
T

20(cid:13)

40(cid:13)

60(cid:13)

80(cid:13)

100(cid:13)

120(cid:13)

Target vibrational level (cid:13) w(cid:13)

Figure 5. Optimal detuning (black , left axis) for pump-dump photoassociation
with two identical unshaped femtosecond laser pulses, estimated from (6) for a
range of target vibrational levels w in the ground state. The maximum attainable
population of these levels (red • ) is shown on the right axis.

3.2. Optimal detuning

In order to ﬁnd a window of detunings suitable to populate target levels in the ground
state, (6) is evaluated for unshaped Fourier-limited Gaussian pulses of 100 fs FWHM.
For a range of delay times encompassing several round-trip times, the Franck-Condon
matrix M vv
w (∆t) is calculated for each ground state target level w. The optimal
detuning is inferred from the maximum of the main diagonal of M vv
w (∆t) and the
corresponding maximum target state population is calculated.

′

′

Figure 5 shows the result for both the optimal detuning and corresponding target
state population as a function of the vibrational level w of the ground electronic state.
A strong dependence of the maximum attainable population on the vibrational level is
observed spanning eight orders of magnitude. The largest target populations are found
for small laser detunings and correspond to high target vibrational levels. This reﬂects
the large free-bound Franck-Condon factors for highly excited vibrational levels. It
also shows that the bound-bound Franck-Condon factors for the dump step favor high
target levels for small detunings.

3.3. Adaptive feedback control

With the perturbative model, optimization calculations were carried out for pump-
dump photoassociation. The goal for the optimization was to ﬁnd the pump pulse
that maximizes the population in the w = 119 ground state vibrational level. The
pump and dump pulses were assumed to be Fourier-limited Gaussian pulses with 100 fs
FWHM and ∆ = 251 cm−1 detuning. The spectral components of the pump pulse
are optimized with respect to their phase and amplitude. The pump-dump delay
time, which represents a parameter in these calculations, was set either to 15.75 ps
or to 14.0 ps: As shown in ﬁgure 4, for ∆t = 15.75 ps a maximum is observed in the

(cid:13)
(cid:13)
(cid:13)
(cid:13)
Theoretical model for ultracold molecule formation via adaptive feedback control

11

 (cid:13)

 (cid:13)

 (cid:13)

 

 

l

l

]
e
a
c
s
 
.
b
r
a
[
 
n
o
i
t
a
u
p
o
p
 
e
t
a
t
s
 
t
e
g
r
a
T

l

l

]
e
a
c
s
 
.
b
r
a
[
 
n
o
i
t
a
u
p
o
p
 
e
t
a
t
s
 
t
e
g
r
a
T

1,6(cid:13)

1,4(cid:13)

1,2(cid:13)

1,0(cid:13)

0,8(cid:13)

0,6(cid:13)

0,4(cid:13)

0,2(cid:13)

0,0(cid:13)

1,6(cid:13)

1,4(cid:13)

1,2(cid:13)

1,0(cid:13)

0,8(cid:13)

0,6(cid:13)

0,4(cid:13)

0,2(cid:13)

0,0(cid:13)

0(cid:13)

2(cid:13)

4(cid:13)

6(cid:13)

8(cid:13)

10(cid:13)

12(cid:13)

14(cid:13)

16(cid:13)

18(cid:13)

20(cid:13)

pump-dump delay [ps](cid:13)

Figure 6. Relative target state (w = 119) population versus pump-dump delay
for optimized pump pulses. The optimizations were carried out with a delay
parameter of 14.00 ps (upper trace) and 15.75 ps (lower trace), corresponding to
a minimum and a maximum in the ’natural’ dynamics after an unshaped pump
pulse, cf. ﬁgure 4. The pulse parameters are the same as in ﬁgure 3. The
prediction of the model (6) (solid line) is compared to the solution of the time-
dependent Schr¨odinger equation (squares). Note the deviations occurring at small
delay times which are due to transient excitations.

target level population of the ’natural’ dynamics, i.e. the dynamics obtained with an
unshaped pump pulse. On the other hand, ∆t = 14.0 ps represents a delay for which
the natural dynamics leads to almost no target level population.

The resulting target state population with optimized phases and amplitudes
is shown as a function of the pump-dump delay time in ﬁgure 6 (solid lines).
It
is clearly seen that for both optimization calculations the maximum population is
indeed obtained at the delay time for which the pump pulse was optimized. For
∆t = 14.00 ps, the dynamics is modulated such that an eﬃcient dump transition may
occur at times when almost no target level population is obtained with an unshaped
pump pulse, see ﬁgure 4. Here, the target level population is increased by more
than a factor of 10, compared to unshaped pulses with the same pump-dump delay.
This illustrates that the pulse shaper can be used to a great extent to control the
wavepacket dynamics. The optimal pulse shapes also lead to a higher maximum of
the target level population as compared to the population achieved for the optimal
pump-dump delay time with unshaped pulses: for the optimization at ∆t = 14.0 ps,

(cid:13)
(cid:13)
(cid:13)
(cid:13)
Theoretical model for ultracold molecule formation via adaptive feedback control

12

Figure 7. Upper panels: Amplitude (red ——) and phase (black · · · · · ·) mask
patterns of the pulse shaper to generate the optimized pulses for ∆t = 14.00 ps
(left) and ∆t = 15.75 ps (right). The amplitudes are multiplied by the spectral
envelope of the pulse. Note the chirp-like ordered structures in the phases of the
two pulses. Lower panels: Temporal amplitude of the optimized pulses for the
14.00ps case (left) and the 15.75ps case (right).

the target population is enhanced by about 40%. For 15.75 ps a smaller enhancement
of about 10% is observed, which is easily explained by the smaller total pulse energy
of the obtained optimal pulse, as detailed below.

The results of the optimization are compared with the results of the time-
dependent Schr¨odinger equation using the optimal pulses, obtained above, as pump
pulses. The time delay between the pump and dump pulses was varied to investigate
whether the optimal result is indeed obtained for the intended delay and how in general
the pulse shapes aﬀect the excited state wavepacket dynamics. As shown in ﬁgure 6,
these results agree well with the model, except for very short delay times were the
pulses still overlap.

The mask patterns of the pulse shaper for amplitude (——) and phase (· · · · · ·)
are shown for the two preset delay times in the top panels of ﬁgure 7. The spectrum
contains frequencies for which the excited state levels v = 204 to v = 249 are resonantly
excited from the initial state. For ∆ = 14.0 ps almost the full spectrum is retained,
whereas for ∆ = 15.75 ps, some frequency components are removed from the pulse
spectrum. This leads to a smaller total pulse energy for the ∆ = 15.75 ps optimum
and explains the better performance of the pulse optimized for ∆ = 14.0 ps. Ordered
structures in the spectral phase emerge in both cases. In other runs of the optimization
algorithm, such ordered phase structures were obtained as well.

The temporal proﬁles of the optimized pulses are shown in the bottom panels
of ﬁgure 7. The pulses are stretched in time compared to the time duration of the

Theoretical model for ultracold molecule formation via adaptive feedback control

13

0,7(cid:13)
0,6(cid:13)
0,5(cid:13)
0,4(cid:13)
0,3(cid:13)
0,2(cid:13)
0,1(cid:13)
0,0(cid:13)

0,7(cid:13)
0,6(cid:13)
0,5(cid:13)
0,4(cid:13)
0,3(cid:13)
0,2(cid:13)
0,1(cid:13)
0,0(cid:13)

0,7(cid:13)
0,6(cid:13)
0,5(cid:13)
0,4(cid:13)
0,3(cid:13)
0,2(cid:13)
0,1(cid:13)
0,0(cid:13)

 

](cid:13)
s
t
i
n
u
 
.
b
r
a
[
 
d
e
r
a
u
q
s
 
n
o
i
t
c
n
u
f
e
v
a
W

 

 (cid:13)

 (cid:13)

 (cid:13)

 (cid:13)

 (cid:13)

 

 

 

0(cid:13)

5(cid:13)

10(cid:13)

15(cid:13)

20(cid:13)

25(cid:13)

35(cid:13)

40(cid:13)

Internuclear distance [a(cid:13)

30(cid:13)

](cid:13)

0(cid:13)

Figure 8. Excited state wavepackets in position space at t = 15.75 ps after the
pump pulse maximum. The upper panel (a) shows the wavepacket obtained after
an unshaped pulse, while the lower (c) panel displays the wavepacket resulting
from excitation with a pulse optimized for ∆t = 15.75 ps. To estimate the dump
eﬃciency, these wavepackets have to be compared to the stationary ground state
wavefunction of the target level shown in the middle panel (b). Note the reduced
probability density at small internuclear distances of the wavepacket after the
optimized pulse as compared to the unshaped case.

unshaped pulses of 100 fs FWHM. For ∆t = 14.0 ps, three sub-pulses are observed
which are separated by about 2 ps. This has to be compared to the vibrational times
of the excited state levels which range from 2.7 ps for v = 204 to 10.0 ps for v = 249 and
4 ps for the central level v = 219 resonant with the carrier frequency. In the Wigner
representation of the optimal ﬁeld (data not shown), an interference pattern between
the three sub-pulses is observed indicating the intricate phase relation between the
sub-pulses. The ’holes’ in the spectrum observed for ∆t = 15.75 ps, as shown in the
top, right panel of ﬁgure 7, correspond mostly to transition frequencies to levels with
long vibrational periods (for example, v = 227 to v = 233 with Tvib = 5.1 ps to 6.3 ps).
Certain wavepacket components are ﬁltered out to facilitate a shaping of the
excited state wavepacket which is favorable for the dump step. This is illustrated for
∆t = 15.75 ps in ﬁgure 8. The excited state wavepacket at t = 15.75 ps after the
unshaped (upper panel) and optimized (lower panel) pump pulse is compared to the
vibrational wavefunction of the ground state target level (middle panel). Optimal
dump conditions are obtained when the wavepacket is focused in the region where
the target state wavefunction possesses its outermost maximum. The optimization
leads to a removal of parts of the wavepacket in the inner region which would cause
destructive interference in the dump process.

(cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:13)
Theoretical model for ultracold molecule formation via adaptive feedback control

14

4. Conclusions and outlook

We have investigated to which extent the formation of ultracold molecules by pulsed
photoassociation can be controlled using adaptive feedback control and shaped
femtosecond laser pulses. For this purpose we have set up a perturbative pulse
shaper model and combined it with a genetic algorithm. This concept allows for
a numerically eﬃcient optimization with realistic conditions for the femtosecond
laser pulse and the pulse shaper. Using the model for a pump-dump scheme, the
population in a speciﬁc target level in the ground electronic state is optimized.
A considerable enhancement factor of about 40% is achieved compared to highest
population achieved with unshaped pulses, while keeping the pulse duration as short
as possible. The maximum pump-dump enhancement in the perturbative, low-energy
regime, is determined by the Franck-Condon factors of the two electronic transitions.
Signiﬁcantly larger enhancements may only be expected for high-intensity pulses
beyond the perturbative regime, where Rabi cycling and dynamic Stark shifts occur.
However, in this regime costly non-perturbative calculations are required and the
interpretation of the results is less obvious.

The adaptive feedback optimization showed that for a speciﬁc time delay between
the pump and dump pulses, the ground state molecule formation is increased by more
than a factor of 10 with optimally shaped pulses compared to the result of unshaped
pulses with the same delay time. This implies that the pump-dump delay represents
an uncritical parameter as long as it is shorter than the spontaneous decay time, i.e.
the optimization algorithm may ﬁnd an optimal solution for arbitrary delay times.
The analysis of the excited state wavepacket dynamics revealed that the shaped pulse
induces a spatial focusing of the wavepacket in the Franck-Condon region of the dump
pulse at the speciﬁed pump-dump delay. The pulse shaper can therefore greatly alter
the dynamics of the wavepacket to optimize ground state molecule formation.

The model described in this work is advantageous compared to standard
theoretical approaches such as optimal control theory [39] in that it closely resembles
the situation in experiments. Optimal control calculations generally converge faster
than genetic algorithm optimizations and extremely eﬃcient pulses can be obtained
[40]. However, these pulses are usually too complex to be directly implemented in an
experiment [22, 23]. In this work, the optimized pulses are obtained in the frequency
domain and are given in terms of the transmission coeﬃcients and phase shifts of
a pulse shaper. The optimization results can therefore directly by be employed in
experiments.

Future improvements of the presented calculations may follow several lines. To
obtain absolute rates for molecule formation, a thermal average needs to be performed.
This will be important to ﬁnd pulse shapes for which association dominates over
photodissociation of ultracold molecules [24, 28]. For the collision energies in a
magneto-optical trap, such an average requires inclusion of partial waves with l > 0.
Second, all relevant electronic states need to be incorporated in the model.
In
particular, resonant spin-orbit coupling is known to lead to perturbations in the excited
state vibrational spectrum [33, 41] which might be important for ground state molecule
formation [20]. Furthermore, it will be interesting to investigate the inﬂuence of the
laser ﬁeld polarization on ground state molecule formation, in particular to ﬁnd shaped
pulses which excite speciﬁc molecular symmetries. Finally, higher order terms may
be included in the perturbative derivation of the pulse shaper model to allow for
investigation of the nonlinear excitation regime. Here, higher enhancement factors

Theoretical model for ultracold molecule formation via adaptive feedback control

15

beyond the Franck-Condon regime may be expected.

Based on the ﬁndings

in this work, dedicated experiments on pulsed

photoassociation of ultracold rubidium molecules are in progress.

This work was supported by the Deutsche Forschungsgemeinschaft in the frame
of the Schwerpunktprogramm 1116 and by the European Commission in the frame of
the Cold Molecule Research Training Network under contract HPRN-CT-2002-00290.
U. P. acknowledges support by the ESF network “Collisions in Atom Traps”. C.P.K.
acknowledges ﬁnancial support from the Deutsche Forschungsgemeinschaft.

References

[1] E.A. Hinds. Testing time reversal symmetry using molecules. Phys. Scripta, 34:T70, 1997.
[2] M. Bartenstein, A. Altmeyer, S. Riedl, S. Jochim, C. Chin, J. Hecker Denschlag, and R. Grimm.
Crossover from a molecular bose-einstein condensate to a degenerate fermi gas. Phys. Rev.
Lett., 92:120401, 2004.

[3] D. DeMille. Quantum computation with trapped polar molecules. Phys. Rev. Lett., 88:067901,

[4] J. Herbig, T. Kraemer, M. Mark, T. Weber, C. Chin H.-C. N¨agerl, and R. Grimm. Science,

2002.

301:1510, 2003.

[5] H. R. Thorsheim, J. Weiner, and P.S. Julienne. Laser induced photoassociation by spontaneous

anti-stokes scattering. Phys. Rev. Lett., 58:2420, 1987.

[6] P. D. Lett, K. Helmerson, W. D. Philips, L. P. Ratcliﬀ, S. L. Rolston, and M. E. Wagshul.
Spectroscopy of na2 by photoassociation of laser-cooled na. Phys. Rev. Lett., 71:2200, 1993.
[7] A. Fioretti, D. Comparat, A. Crubellier, O. Dulieu, and F. Masnou. Formation of cold cs2

through photoassociation. Phys. Rev. Lett., 80:4402, 1998.

[8] C. McKenzie, J. Hecker Denschlag, H. Hﬀner, A. Browaeys, L. E. E. deAraujo, F. K. Fatemi,
K. M. Jones, J. E. Simsarian, D. Cho, A. Simoni, E. Tiesinga, P. S. Julienne amd
K. Helmerson, P. D. Lett, R. L. Rolston, and W.D. Phillips. Phys. Rev. Lett., 88:20403,
2002.

[9] N. Vanhaecke, C. Lisdat, B. T’Jampens, D. Comparat, A. Crubellier, and P. Pillet. Accurate
asymptotic ground state potential curves of cs2 from two-colour photoassociation. Eur. Phys.
J. D, 28:351, 2004.

[10] C. Ryu, X. Du, E. Yesilada, A. M. Dudarev, S. Wan, Q. Niu, and D. J. Heinzen.

arXiv:cond-mat/0508201, 2005.

[11] Jeremy M. Sage, Sunil Sainis, Thomas Bergeman, and David DeMille. Optical production of

ultracold polar molecules. Phys. Rev. Lett., 94:203001, 2005.

[12] M. Machholm, A. Giusti-Suzor, and F. Mies. Photoassociation of atoms in ultracold collisions

probed by wave-packet dynamics. Phys. Rev. A, 50:5025, 1994.

[13] S. D. Kraft, M. Mudrich, M. Staudt, J. Lange, O. Dulieu, R. Wester, and M. Weidemller.
Saturation of cs2 photoassociation in an optical dipole trap. Phys. Rev. A, 71:013417, 2005.
[14] R. Judson and H. Rabitz. Teaching lasers to control molecules. Phys. Rev. Lett., 68:1500, 1992.
[15] T. Brixner and G. Gerber. Quantum control of gas-phase and liquid-phase femtochemistry.

ChemPhysChem, 4:418, 2003.

[16] J. Vala, O. Dulieu, F. Masnou, P. Pillet, and R. Kosloﬀ. Coherent control of cold-molecule
formation through photoassociation using a chirped-pulsed-laser ﬁeld. Phys. Rev. A,
63:013412, 2000.

[17] E. Luc-Koenig, R. Kosloﬀ, F. Masnou, and M. Vatasescu. Photoassociation of cold atoms with
chirped laser pulses: Time-dependent calculations and analysis of the adiabatic transfer within
a two-state model. Phys. Rev. A, 70:033414, 2004.

[18] E. Luc-Koenig, M. Vatasescu, and F. Masnou. Optimizing the photoassociation of cold atoms

by use of chirped laser pulses. Eur. Phys. J. D, 31:239, 2004.

[19] C. P. Koch, E. Luc-Koenig, and F. Masnou-Seeuws. Making ultracold molecules in a two colour
pump-dump photoassociation scheme using chirped pulses. Phys. Rev. A, 73:033408, 2006.

[20] C. P. Koch, R. Kosloﬀ, and F. Masnou-Seeuws. physics/0511235, 2006.
[21] T. Hornung, S. Gordienko, R. de Vivie-Riedle, and B. J. Verhaar. Optimal convesion of an

atomic to a molecular bose-einstein condensate. Phys. Rev. A, 66:043607, 2002.

[22] T. Hornung, M. Motzkus, and R. de Vivie-Riedle. Teaching optimal control theory to distill
robust pulses even under experimental constraints. Phys. Rev. A, 65:021403, 2002.

Theoretical model for ultracold molecule formation via adaptive feedback control

16

[23] T. Manˇcal and V. May. Optimal control theory of ultrafast molecular dynamics: are the results

of interest for the experiment? Chemical Physics Letters, 362:407, 2002.

[24] W. Salzmann, U. Poschinger, R. Wester, M. Weidem¨uller, A. Merli, S. M. Weber, F. Sauer,
M. Plewicki, F. Weise, A. Mirabal Esparza, L. Woeste, and A. Lindinger. Coherent control
with shaped femtosecond laser pulses applied to ultracold molecules. Phys. Rev. A, 73:023414,
2006.

[25] U. Marvet and M. Dantos. Femtosecond photoassociation spectroscopy:

coherent bond

formation. Chem. Phys. Lett., 245:393–399, 1995.

[26] F. Fatemi, K. M. Jones, H. Wang, I. Walmsley, and P. D. Lett. Dynamics of photoinduced
collisions of cold atoms probed with picosecond laser pulses. Phys. Rev. A, 64:033421, 2001.
[27] M. J. Wright, S. D. Gensemer, J. Vala, R. Kosloﬀ, and P. L. Gould. Control of ultracold

collisions with frequency-chirped light. Phys. Rev. Lett., 95:063001, 2005.

[28] B. L. Brown, A. J. Dicks, and I. A. Walmsley. Coherent control of ultracold molecule dynamics
in a magneto-optical trap using chirped femtosecond laser pulses. physics/0509109v2, 2005.
[29] S. Park, S. Suh, Y. Lee, and G. Jeung. Theoretical study of the electronic states of the rb2

molecule. Journal of Molecular Spectroscopy, 207:129, 2001.

[30] A. Marte, T. Volz, J. Schuster, S. D¨urr, G. Rempe, E. G. M. van Kempen, and B. J. Verhaar.
Feshbach resonances in rubidium 87: Precision measurement and analysis. Phys. Rev. Lett.,
89:283202, 2002.

[31] R. Gutteres, C. Amiot, A. Fioretti, C. Gabbanini, M. Mazzoni, and O. Dulieu. Determination
of the 87rb 5p state dipole matrix element and radiative lifetime from the photoassociation
spectroscopy of the rb2 0

−
g (p3/2) long-range state. Phys. Rev. A, 66:024502, 2002.

[32] F. Spiegelmann, D. Pavolini, and J. Daudey. Theoretical study of the excited states of the

heavier alkali dimers: Ii. the rb2 molecule. J. Phys. B, 22:2465, 1989.

[33] C. Amiot, O. Dulieu, and J. Verg`es. Resolution of the Apparent Disorder of the Rb2 A1Σ1
u
u ) Spectra: A Case of Fully Coupled Electronic States. Phys. Rev. Lett.,

(0+
u ) and b3Πu (0+
83(12):2316, 1999.

[34] V. Kokoouline, O. Dulieu, R. Kosloﬀ, and F. Masnou. Mapped fourier methods for long-range

[35] K. Willner, O. Dulieu, and F. Masnou. Mapped grid methods for long-range molecules and cold

[36] R. Kosloﬀ. Time-dependent quantum-mechanical methods for molecular dynamics. J. Phys.

molecules. J. Chem. Phys., 110:9865, 1999.

collisions. J. Chem. Phys., 120:548, 2004.

Chem., 92:2087, 1988.

wavepackets. J. Opt. B, 5:R27, 2003.

2003.

[37] L. de Araujo and I. Walmsley. Analytic solution for quantum control of atomic and molecular

[38] M. Shapiro and P. Brumer. Principles of the Quantum Control of Molecular Processes. Wiley,

[39] W. Zhu, J. Botina, and H .Rabitz. Rapidly convergent iteration methos for optimal control of

population. J. Chem. Phys., 108:1953, 1997.

[40] C. P. Koch, J. Palao, R.Kosloﬀ, and F. Masnou. Stabilization of ultracold molecules using

optimal control theory. Phys. Rev. A, 70:013402, 2004.

[41] H. Jelassi, B. Viaris de Lesegno, and L. Pruvost. Phys. Rev. A, 73:032501, 2006.

