4
0
0
2
 
c
e
D
 
1
3
 
 
]
h
p
-
m
o
t
a
.
s
c
i
s
y
h
p
[
 
 
1
v
1
8
1
2
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Multiple Thresholds and Many-Atom Dynamics in

the Cavity QED Microlaser

by

Christopher Minwah Fang-Yen

B.S. Physics and Mathematics
Stanford University, 1995

Submitted to the Department of Physics
in partial fulﬁllment of the requirements for the degree of

MASSACHUSETTS INSTITUTE OF TECHNOLOGY

Doctor of Philosophy

at the

February 2002

Massachusetts Institute of Technology 2002. All rights reserved.

c
(cid:13)

Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Department of Physics
February 6, 2002

Certiﬁed by . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Michael S. Feld
Professor of Physics
Thesis Supervisor

Accepted by . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Thomas J. Greytak
Professor of Physics
Associate Department Head for Education

2

Multiple Thresholds and Many-Atom Dynamics in the

Cavity QED Microlaser

by

Christopher Minwah Fang-Yen

Submitted to the Department of Physics
on February 6, 2002, in partial fulﬁllment of the
requirements for the degree of
Doctor of Philosophy

Abstract

This thesis describes a study of a cavity QED microlaser in which many atoms are
present simultaneously and atom-cavity interaction is well-deﬁned. The microlaser is
found to display multiple thresholds analogous to ﬁrst-order phase transitions of the
cavity ﬁeld. Hysteresis is observed as a function of atom-cavity detuning and number
of atoms. Data is compared with a rate equation model and fully quantized treatment
based on micromaser theory. Good agreement between theory and experiment is
found when the cavity is resonant with atoms of the most probable velocity, but long
lifetimes of metastable states preclude the observation of true steady-state transition
points. For nonzero atom-cavity detuning the microlaser displays broadenings and
shifts which are not yet well-understood.

Quantum trajectory simulations are performed to investigate many-atom and ﬁ-
nite transit time eﬀects in the microlaser. We show that over a wide range of parame-
ters the many-atom microlaser scales with the single-atom theory, with a perturbation
in the photon statistics due to cavity decay during the atom transit time.

Thesis Supervisor: Michael S. Feld
Title: Professor of Physics

3

4

Acknowledgments

It is a pleasure to thank the many people who contributed directly or indirectly to

this work. First I thank Michael Feld for his guidance and support during my time

as a graduate student. His intuitive approach to physics and optimistic attitude will

be an inspiration to me for years to come. I also appreciate the freedom he has given

me as a graduate student to set the direction for my research.

This thesis would not have been possible without Kyungwon An, who initiated

the microlaser experiment as a graduate student. Kyungwon taught me a great deal

about experimental physics during my early years at MIT.

An equally large amount of credit for this thesis should go to Chung-Chieh Yu,

who worked on the project for three years. His expertise in quantum optics and

atomic beams helped move the project along faster than ever before.

Ramachandra Dasari deserves thanks for many useful discussions, and for manag-

ing lab equipment and funding issues. From the beginning Ramachandra expressed

conﬁdence in me and my ability to eventually take on a leading role in the project.

This is something I have appreciated very much.

I enjoyed working with several other students in the laboratory. Abdulaziz Al-

jalal developed the optical velocity selection scheme and second-order correlation ex-

periment. Bryndol Sones performed the absorption-induced bistability experiments.

Alan Heins helped construct the dye laser locking system and the supersonic oven.

Sangkeun Ha designed several of the electronic circuits and assisted with data collec-

tion.

experiments.

Professor John Thomas of Duke University deserves special thanks for helping us

develop the supersonic beam oven that has proved critical to the success of these

Thanks to Steve Smith of Coherent who often went out of his way to keep the

laboratory equipped with working lasers.

I thank the members of my thesis committee, Marlan Scully, Daniel Kleppner,

and Erich Ippen, for their helpful questions and suggestions.

5

This research was funded by a grant from the National Science Foundation. My

research assistantship has been supported by a Lester Wolfe Fellowship.

Thanks to all my previous teachers and mentors who have inspired me to pursue a

career in science, especially David Witt, Michael Russelle, Doug Osheroﬀ, and Mark

Dykman.

I dedicate this thesis to my parents, John and Rosemay.

C. F. Y.

6

Contents

1 Introduction

1.1 Cavity QED and the microlaser/micromaser . . . . . . . . . . . . . .

1.2 Microlaser concept

. . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3 Previous work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3.1 Micromaser

. . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3.2 Microlaser vs. micromaser . . . . . . . . . . . . . . . . . . . .

1.3.3 Optical cavity QED . . . . . . . . . . . . . . . . . . . . . . . .

1.3.4 Lasers and optical bistability . . . . . . . . . . . . . . . . . . .

1.3.5 Phase transition analogies . . . . . . . . . . . . . . . . . . . .

1.3.6 Many-atom dynamics in cavity QED . . . . . . . . . . . . . .

2 Theory of the microlaser

2.1 Atom in a cavity . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2.2 Rate equation for microlaser . . . . . . . . . . . . . . . . . . . . . . .

2.3 Quantum theory of microlaser . . . . . . . . . . . . . . . . . . . . . .

2.3.1 Density matrix equation of motion . . . . . . . . . . . . . . .

2.3.2

Steady-state photon statistics . . . . . . . . . . . . . . . . . .

2.4 Modiﬁcation for realistic parameters

. . . . . . . . . . . . . . . . . .

2.4.1 Averaging of gain function . . . . . . . . . . . . . . . . . . . .

2.4.2

Imperfect inversion . . . . . . . . . . . . . . . . . . . . . . . .

2.5 Fokker-Planck analysis . . . . . . . . . . . . . . . . . . . . . . . . . .

2.5.1 Metastability and hysteresis . . . . . . . . . . . . . . . . . . .

2.5.2 Transition rates . . . . . . . . . . . . . . . . . . . . . . . . . .

7

17

17

18

18

18

19

21

22

22

22

25

25

28

31

31

33

37

38

39

42

44

45

3 Numerical simulations of many-atom microlaser

3.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.2 Previous approaches

. . . . . . . . . . . . . . . . . . . . . . . . . . .

3.3 Quantum trajectory analysis . . . . . . . . . . . . . . . . . . . . . . .

3.4 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.4.1

Single atom limit; Trap states . . . . . . . . . . . . . . . . . .

3.4.2 Broadening of photon number distribution . . . . . . . . . . .

3.4.3 Many-atom vs. ﬁnite transit time eﬀects . . . . . . . . . . . .

3.5 Predictions for experiment . . . . . . . . . . . . . . . . . . . . . . . .

3.6 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Apparatus and methods of microlaser experiment

4.1 Two-level atom . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.1.1 Barium energy levels . . . . . . . . . . . . . . . . . . . . . . .

4.2 Optical resonator . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.2.1 Characteristics

. . . . . . . . . . . . . . . . . . . . . . . . . .

4.2.2 Cavity PZT . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.2.3 Finesse measurement by ringdown technique . . . . . . . . . .

4.2.4 Absorption measurement via thermally-induced optical bistability 67

4.2.5 Uniform coupling by traveling-wave interaction . . . . . . . .

4.3 Atomic beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.3.1 Velocity selection: mechanical, optical, or supersonic

. . . . .

4.3.2 Atomic velocity selection via optical pumping . . . . . . . . .

4.3.3

Supersonic oven . . . . . . . . . . . . . . . . . . . . . . . . . .

4.3.4 Final aperture . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.3.5 Atom density modulator . . . . . . . . . . . . . . . . . . . . .

4.4 Laser systems, locking, and stabilization . . . . . . . . . . . . . . . .

4.4.1 Laser equipment

. . . . . . . . . . . . . . . . . . . . . . . . .

4.4.2 Frequency stabilization of 791 nm beam by Doppler-free FM spectroscopy 83

4.4.3 Locking of 553 nm beam to atomic beam . . . . . . . . . . . .

84

8

47

47

49

49

51

51

52

56

57

58

59

59

59

60

60

65

66

69

70

70

70

71

76

79

81

81

4.4.4

Intensity and position stabilization . . . . . . . . . . . . . . .

4.5 Pump beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.5.1 Optical setup . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.5.2 Pump beam parameters

. . . . . . . . . . . . . . . . . . . . .

4.5.3

Shelving experiment

. . . . . . . . . . . . . . . . . . . . . . .

4.5.4 Pump power dependence of inversion . . . . . . . . . . . . . .

4.5.5 Adiabatic inversion by defocused pump beam . . . . . . . . .

85

89

89

91

93

93

94

4.6

Imaging system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

4.6.1

Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

4.6.2 Uses of imaging system . . . . . . . . . . . . . . . . . . . . . . 102

4.7 Detectors

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

4.7.1 Avalanche photodiodes . . . . . . . . . . . . . . . . . . . . . . 104

4.7.2 Photomultiplier tubes

. . . . . . . . . . . . . . . . . . . . . . 104

4.8 Vacuum system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105

4.9 Density calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

4.10 Photon number calibration . . . . . . . . . . . . . . . . . . . . . . . . 112

4.11 Data acquisition and computer control

. . . . . . . . . . . . . . . . . 113

4.11.1 Experiment automation . . . . . . . . . . . . . . . . . . . . . 113

4.12 Cavity PZT control . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

5 Results and Analysis

117

5.1 Study of microlaser with variable detuning . . . . . . . . . . . . . . . 117

5.2 Cavity scanning data . . . . . . . . . . . . . . . . . . . . . . . . . . . 117

5.2.1 Photon number vs. atom number

. . . . . . . . . . . . . . . . 128

5.2.2 Disagreement with theory . . . . . . . . . . . . . . . . . . . . 136

5.2.3 Peak heights of detuning curves . . . . . . . . . . . . . . . . . 136

5.3 Cavity locking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136

5.3.1 Cavity locking results . . . . . . . . . . . . . . . . . . . . . . . 141

5.4 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

5.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

9

6 Discussion and Conclusions

145

6.1 Multiple thresholds and the phase transition analogy . . . . . . . . . 145

6.2 Many-atom eﬀects

. . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

6.3 Microlasers, lasers, and randomness . . . . . . . . . . . . . . . . . . . 146

6.4 Value of quantum theory . . . . . . . . . . . . . . . . . . . . . . . . . 147

6.5 Detuning curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148

6.5.1

Inﬂuence of nonresonant traveling-wave ﬁeld: atom in a bichromatic ﬁeld149

6.5.2 Dispersive eﬀects . . . . . . . . . . . . . . . . . . . . . . . . . 150

6.6 Future directions

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151

6.6.1 Theory of microlaser . . . . . . . . . . . . . . . . . . . . . . . 151

6.7 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152

A Microlaser theory calculations

A.1 Micromaser theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153

A.2 Calculation of gain function . . . . . . . . . . . . . . . . . . . . . . . 154

B Quantum trajectory program

B.1 Main program: qts.c . . . . . . . . . . . . . . . . . . . . . . . . . . . 159

B.2 newatoms2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198

B.3 exitatom2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202

B.4 decay2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206

B.5 evolve2-2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208

B.6 spont2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215

B.7 pumping-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218

B.8 d state2-d.c . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220

B.9 Sample input ﬁle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223

C VPascal sequencing program

C.1 Cavity scanning experiment

. . . . . . . . . . . . . . . . . . . . . . . 225

C.2 Cavity locking experiment . . . . . . . . . . . . . . . . . . . . . . . . 238

153

159

225

253

D Standing-wave versus traveling-wave coupling

10

List of Figures

1-1 Schematic of cavity QED microlaser. A: atomic beam, M: mirrors, C: cavity mode, P: pump

2-1 Dimensionless gain (solid line) and loss (dashed line) in the semiclassical rate equation analysis

2-2 Multiple solutions of microlaser rate equation. Dotted lines represent photon numbers corresp

2-3 Micromaser theory result for

, Nex = 10 . . . . . . . . . . . . . . .

35

n
i

h

2-4 Micromaser theory result for Q, with Nex = 10. Q < 0 indicates sub-Poisson statistics.

36

2-5 Rate equation solutions (dotted lines) compared with quantum microlaser theory (solid line).

2-6 Q parameter according to microlaser quantum theory. Statistics are strongly sub-Poissonian for

2-7 Dimensionless gain (solid line) and loss (dashed line) in the semiclassical rate equation analysis,

2-8 Photon number vs. atom number, rate equation (dashed line) and microlaser theory (solid line)

2-9 Q parameter according to microlaser quantum theory, including realistic eﬀects as in Fig. 2-8.

2-10 Rate-equation solutions for Neﬀ = 1000. Second and third branches appear as closed curves. Upp

2-11 Solutions to rate equation with realistic parameters, as a function of detuning, Neﬀ = 600. Dotted

2-12 Rate equation solutions (realistic parameters) as a function of detuning, N = 2500. Arrows sho

2-13 Tunneling from local to global minimum in the eﬀective potential V (ν), plotted for realistic microlaser

3-1 Two-atom events destroy the trap state resonances

. . . . . . . . . .

3-2 Quantum trajectory results for average photon number . . . . . . . .

3-3 Quantum trajectory results for Mandel Q parameter . . . . . . . . . .

3-4 Universal curve showing an increase in Q which scales with N/Nex . .

51

52

53

54

3-5 Slope α(θ) of the increase in Q with N/Nex, as a function of pump parameter 55

3-6 Increase of variance with N/Nex for Nex = 1 . . . . . . . . . . . . . .

56

3-7 Dashed line: upper bound of Q parameter, including ﬁnite decay time eﬀect. Solid line: Q parameter

11

4-1 Relevant energy levels for 138Ba. . . . . . . . . . . . . . . . . . . . . .
4-2 Isotope spectrum of the 1S0 ↔
4-3 Brass cavity housing assembly and stainless steel cavity holders, from [9]. 61

1P1 transition at 553 nm.

. . . . . . .

60

61

4-4 Microlaser resonator assembled with PZT . . . . . . . . . . . . . . . .

4-5 Support system for cavity assembly in chamber.

. . . . . . . . . . . .

62

63

4-6 Cavity transmission of an earlier cavity (from [9]) showing TEM00 and higher order transverse

4-7 Schematic of optics for microlaser experiment. To the right of the cavity a mirror on a “ﬂipper”

4-8 Log of ringdown signal (a.u.) vs. time. Line shows least-squares linear ﬁt. Here Tcav = 1.02 µ

4-9 Figure 4. Anomalous cavity transmission. Scan speeds: (i) 0.6, (ii) 4.8 GHz/s, compared with

4-10 Microlaser output as a function of cavity-atom detuning, for varying atomic beam tilt angles

4-11 Left: Twocolor optical pumping scheme. Right: Velocity proﬁle of the selected atoms. In this

4-12 Relevant 138Ba energy levels for optical velocity selection scheme. Dark arrows represent transitions

4-13 Supersonic oven design . . . . . . . . . . . . . . . . . . . . . . . . . .

74

4-14 Fluorescence signal of a counterpropagating 553 nm probe beam as measurement of supersonic

4-15 Atom beam width compared with cavity mode. Atom beam should “sample” only the peak of

4-16 Coupling variation 1

gmin/gmax due to ﬁnite aperture size a . . . . .

78

−

4-17 Top view of aperture assembly including motorized rotary stage, mirror mount for angular adjustmen

4-18 Close-up of tip of aperture assembly and cavity. Atomic beam is collimated by aperture slit and

4-19 Microlaser output for microlaser for constant density in initial threshold region, as a function

4-20 Atomic beam density modulator . . . . . . . . . . . . . . . . . . . . .

82

4-21 Beam density (ﬂuorescence CCD counts per ms) as a function of beam modulator position; 1
4-22 Lamb dip used to lock Ti:Sapphire laser to 791 nm 1S0 ↔
4-23 Dispersion signal used for locking of Ti:Sapphire laser to 1S0 ↔
4-24 Lamb dip signal used for dye laser locking to the 553 nm 1S0 ↔
4-25 553 nm Lamb dip setup for 699 dye laser locking.

3P1 transition at 791 nm. 85

3P1 transition. 84

1P1 transition 86

. . . . . . . . . . .

86

4-26 Laser intensity and position stabilization system for 791 nm and 553 nm beams 87

4-27 Circuit diagram for intensity stabilization system . . . . . . . . . . .

88

4-28 Pump beam optical setup. Optics are ﬁxed on two small rectangular breadboards attached to

4-29 Ground state amplitude of atoms, measured by 553 nm ﬂuorescence: monotonic dependence on

4-30 Atoms displaced from pump beam focus experience frequency chirp and adiabatic inversion.

12

4-31 Results of adiabatic inversion pump simulations: ﬁnal ground state probabilities as functions

4-32 Ground state probability as a function of

p/pπ/2, where p is the pump power and pπ/2 ≈

1.8

q

4-33 Schematic of imaging system . . . . . . . . . . . . . . . . . . . . . . . 100

4-34 Side and top viewing imaging system conﬁgurations. Lab jacks and supporting structures not

4-35 Atom ﬂuorescence imaged by microscope in side imaging conﬁguration. Similar but smaller images

4-36 Microscope image of center of cavity taken from side imaging conﬁguration. Left and right: ca

4-37 Photo of the microlaser experiment. Atom beam oven is attached to top ﬂange of vertical cylinder

4-38 Diagram of major chamber components showing atom beam path. . . 106

4-39 Gaussian mode and equivalent tophat proﬁle . . . . . . . . . . . . . . 107

4-40 density-measurement-setup . . . . . . . . . . . . . . . . . . . . . . . . 108

4-41 Saturation curve of peak of 553 nm ﬂuorescence: ﬂuorescence counts vs. input probe power, µ

4-42 553 nm ﬂuorescence distribution from CCD. Fit includes saturation eﬀects and optical aberration

4-43 CCD counts per millisecond (cpms) for a constant atom density when the exposure time T is

4-44 Probe transmission spectrum for frequency calibration of PZT scans. Sideband frequency shift

4-45 Cavity locking circuit . . . . . . . . . . . . . . . . . . . . . . . . . . . 116

5-1 Bidirectional PZT voltage scan shown with typical PMT data for a high atom density. Horizon

5-2 PMT counts vs. cavity-atom detuning. Fluorescence 48.5 cpms (Neﬀ = 10.7) 119

5-3 Fluorescence 60.9 cpms (Neﬀ = 13.4)

. . . . . . . . . . . . . . . . . . 119

5-4 Fluorescence 80.2 cpms (Neﬀ = 17.6)

. . . . . . . . . . . . . . . . . . 120

5-5 Fluorescence 100 cpms (Neﬀ = 22)

. . . . . . . . . . . . . . . . . . . 120

5-6 Fluorescence 659.1 cpms (Neﬀ = 145) . . . . . . . . . . . . . . . . . . 120

5-7 Fluorescence 950 cpms (Neﬀ = 209) . . . . . . . . . . . . . . . . . . . 121

5-8 Fluorescence 1850 cpms (Neﬀ = 407)

. . . . . . . . . . . . . . . . . . 121

5-9 Fluorescence 2393 cpms (Neﬀ = 526)

. . . . . . . . . . . . . . . . . . 121

5-10 Fluorescence 2748 cpms (Neﬀ = 605)

. . . . . . . . . . . . . . . . . . 122

5-11 Fluorescence 2889 cpms (Neﬀ = 636). Second threshold is observed.

. 122

5-12 Fluorescence 2986 cpms (Neﬀ = 657)

. . . . . . . . . . . . . . . . . . 122

5-13 Fluorescence 3014 cpms (Neﬀ = 663)

. . . . . . . . . . . . . . . . . . 123

5-14 Fluorescence 3075 cpms (Neﬀ = 677)

. . . . . . . . . . . . . . . . . . 123

13

5-15 Fluorescence 3252 cpms (Neﬀ = 715). Spikes are the ﬁrst signs of third threshold.123

5-16 Fluorescence 3432 cpms (Neﬀ = 755)

. . . . . . . . . . . . . . . . . . 124

5-17 Fluorescence 3556 cpms (Neﬀ = 782)

. . . . . . . . . . . . . . . . . . 125

5-18 Fluorescence 3595 cpms (Neﬀ = 791)

. . . . . . . . . . . . . . . . . . 125

5-19 Fluorescence 3628 cpms (Neﬀ = 798)

. . . . . . . . . . . . . . . . . . 125

5-20 Fluorescence 3690 cpms (Neﬀ = 812)

. . . . . . . . . . . . . . . . . . 126

5-21 Fluorescence 3996 cpms (Neﬀ = 879)

. . . . . . . . . . . . . . . . . . 126

5-22 Fluorescence 4008 cpms (Neﬀ = 882)

. . . . . . . . . . . . . . . . . . 126

5-23 Fluorescence 4585 cpms (Neﬀ = 1009)

. . . . . . . . . . . . . . . . . 127

5-24 Fluorescence 5140 cpms (Neﬀ = 1131)

. . . . . . . . . . . . . . . . . 127

5-25 Photon number n vs. eﬀective atom number Neﬀ for center of peak ∆ =

13.5MHz (cavity on

5-26 Photon number n vs. eﬀective atom number Neﬀ for ∆ =

12.0MHz. Circles (

) and crosses

5-27 Photon number n vs. eﬀective atom number Neﬀ for ∆ =

10.0MHz. Circles (

) and crosses

5-28 Photon number n vs. eﬀective atom number Neﬀ for ∆ =

15.0MHz. Circles (

) and crosses

5-29 Photon number n vs. eﬀective atom number Neﬀ for ∆ =

20.0MHz. Circles (

5-30 Photon number n vs. eﬀective atom number Neﬀ for ∆ =

7.5MHz. Circles (

) and crosses

◦
) and crosses (

×

5-31 Peak photon numbers of cavity scanning data vs. eﬀective atom number. Solid line: rate equation

±

◦

◦

◦

◦

±

±

±

±

±

5-32 Photon number n vs. eﬀective atom number Neﬀ for cavity locking experiment. Circles (
◦

): “unseeded”

5-33 Detail of Fig. 5-32 in the initial threshold region . . . . . . . . . . . . 140

5-34 Arrows: transitions due to disappearance of a stable point. Dotted line: spontaneous transition

6-1 Gain-loss graphical solution for conventional laser as modeled in the text. Gain function follo

6-2 Gain-loss graphical solution for microlaser with some broadening. For suﬃciently large n, gain

14

15

16

Chapter 1

Introduction

1.1 Cavity QED and the microlaser/micromaser

One of the simplest models for light-matter interaction consists of a single two-level

atom interacting with a single electromagnetic ﬁeld mode of a cavity. If the atom-

cavity coupling is stronger than the atomic or photon decay rates, the irreversible

decay of an excited atom is replaced by an oscillatory exchange of energy between

the atom and cavity, in a manner characteristic of two coupled oscillators.

In the 1950’s this model was the subject of considerable theoretical study, primar-

ily in connection with the then-recently invented maser [1]. Experimental realization

of such a strongly coupled system would not occur until several decades later, however,

with advances in Rydberg states and superconducting microwave cavities.

In the early 1980’s the micromaser, or single-atom maser, was invented by Walther

and collaborators [2]. In this experiment, individual Rydberg atoms pass through and

emit photons into a superconducting microwave cavity with extremely high quality

factor. The micromaser formed a close approximation to the single-atom, single-

mode ideal. Subsequent experiments showed that the micromaser exhibited a variety

of interesting and unusual phenomena, including trap states, near-number states,

bistability, and nonclassical statistics [3]-[7].

The recent development of multilayer dielectric mirrors with very low loss has

made it possible to conduct similar experiments at optical wavelengths.

In 1994

17

Kyungwon An and Michael Feld developed the microlaser, the optical analogue of

the micromaser [8, 9]. This device is also known as the cavity QED microlaser in

order to distinguish it from other microlasers, for example those using semiconductor

microresonators.

This thesis describes the ﬁrst experiments exploring the microlaser’s truly unusual

properties. In particular, we show that in contrast to conventional lasers which display

a single laser threshold, the microlaser exhibits multiple thresholds.

1.2 Microlaser concept

The basic scheme of the microlaser is illustrated in Fig. 1-1. A beam of two-level

atoms pass through a resonant high-ﬁnesse optical cavity. Before entering the cavity

mode each atom is excited to its upper state via a laser π-pulse. The atom interacts

with the mode for a time tint, during which it may emit a photon into the cavity.

The key characteristic of the microlaser is not only the strong atom-cavity coupling

but that diﬀerent atoms experience almost the same interaction with the cavity: both

the atom-cavity coupling strength g and the atom-cavity interaction time tint are well-

deﬁned. It will be shown in chapter 2 that the resulting emission probability can be

written as

Pemit = sin2(√n + 1 g tint)

(1.1)

where n is the number of photons present in the cavity prior to the entrance of the

atom. The unusual properties of the microlaser are primarily due to this sinusoidal

dependence of the atomic emission probability on the cavity photon number.

1.3 Previous work

1.3.1 Micromaser

Reviews of the micromaser can be found in a number of references in the bibliography.

Most relevant for this experiment is the study by Benson et al [11] of dynamic behavior

18

Figure 1-1: Schematic of cavity QED microlaser. A: atomic beam, M: mirrors, C:
cavity mode, P: pump ﬁeld, θ: cavity tilt angle (cf. [10]).

near the micromaser ﬁeld phase transitions. Spontaneous jumps and slow transitions

between metastable states are observed; hysteresis is seen as interaction times are

varied. The results were explained by quantum Monte Carlo simulations and a Fokker-

Planck description of the micromaser dynamics. The presence of small stray ﬁelds

prevented a full quantitative agreement between theory and experiment from being

reached; the calculated transition rates were generally much slower than what was

observed experimentally.

1.3.2 Microlaser vs. micromaser

We comment here on how the microlaser diﬀers from its microwave counterpart.

Many atoms required

The threshold atom number as derived in Chapter 2 is

For our current microlaser with supersonic beam we have Γc ≈

180 kHz, tint ≈

(1.2)

Nth =

Γc
g2tint

19

0.1µsec, and g

193kHz, giving Nth ≈

≈

10.

This is to be compared with the micromaser for which typical ﬁgures are Γc ≈
40 kHz (values from [11]), so threshold atom number

47µsec, and g

10−4, almost ﬁve orders of magnitude lower.

≈

30 Hz, tint ≈
Nth ≈
3

×

One consequence of the many-atom nature is that the trap state resonances, cor-

responding to situations in which atoms perform an integer number of entire Rabi

oscillations, cannot observed; nor can the associated near-number states of the micro-

maser [7]. However, other interesting eﬀects appear from the many-atom case. The

many atom nature of the current microlaser is treated in detail in Chapter 3.

No thermal photons

At ﬁnite temperature every ﬁeld mode has a nonzero photon occupancy nth given by

the Planck formula. For the micromaser operating at

20GHz, blackbody photons

∼

nth is as high as 0.15 even at 0.5 K and have a signiﬁcant eﬀect on the micromaser, as
discussed in many micromaser articles. In the microlaser at 300K, nth ∼
can be ignored.

10−25 and

Constant transit time

Micromaser experiments are typically performed with a ﬁxed atomic injection rate and

variable interaction times. This roughly corresponds to varying the pump parameter

θ as described in micromaser theory (see Chapter 2).

Use of a supersonic beam of the microlaser prevents any signiﬁcant variation in the

transit times. Instead, the parameter most easily varied is the number of intracavity

atoms N. As N is varied, both the expectation photon number nex and the pump

parameter θ change.

Direct detection of photons

Optical frequency photons can be easily outcoupled out of a cavity, and have suﬃ-

ciently high energy to be directly individually via a photomultiplier tube or avalanche

20

photodiode. This is in contrast to the micromaser experiments, in which maser oscil-

lation must be inferred via observation of the atom states. Direct detection of photons

opens up new possibilities for photon statistics or laser linewidth experiments.

Atom-cavity coupling

The centimeter-scale wavelengths used in the micromaser allow the atomic beam to

largely avoid coupling nonuniformities due to mode structure.

In the micromaser,

standing-wave coupling variation requires us to employ a traveling-wave interaction

scheme (see Chapter 4). In addition, the small dimensions of the cavity mode and re-

quirement of uniform coupling place strict requirements on the position and geometry

of the atomic beam coupled to it.

1.3.3 Optical cavity QED

At optical wavelengths the experiments most similar to this one have been spec-

troscopy and probe transmission experiments of high-ﬁnesse optical cavities contain-

ing a small number of atoms.

Heinzen and Feld [12, 13] performed the ﬁrst observation of enhanced and su-

pressed spontaneous emission and level shifts in an optical cavity.

The vacuum normal-mode splitting of atoms in a cavity was observed in [14].

Oscillatory transmission and nonclassical photon statistics of a probed cavity was

reported by the Kimble group [15]. Optical bistability was also observed.

To our knowledge, all these optical experiments employed atomic excited states

with lifetimes

ns much shorter than atom-cavity transmit times. They were per-

∼

formed in passive (non-laser) cavities in which a probe beam was incident. In addi-

tion, the atom-cavity couplings were not well-determined due to standing-wave mode

proﬁles (cf. chapter 4).

21

1.3.4 Lasers and optical bistability

Bistability in the microlaser bears some similarity to “classical” optical bistability

(see, for example, [16]) in active and passive cavities. Multimode laser bistabilities

due to mode competition in gas lasers have been studied since the earliest days of

the laser [17]. Current-feedback bistability has been observed in some semiconductor

laser systems, e.g. [18].

1.3.5 Phase transition analogies

A detailed description of a laser is necessarily statistical in nature, due to the presence

of randomness in many forms and large numbers of degrees of freedom. It is therefore

natural to draw analogies between laser behavior and other problems in statistical

physics. In particular, for some time physicists have drawn analogies between a laser

near threshold and matter near a second-order phase transition. This comparison was

ﬁrst described in detail by DeGiorgio and Scully in 1970 [19, 20], although mention

of this analogy date back considerably earlier (cf. references in ibid.).

In the present work we investigate jumps in the microlaser ﬁeld which can be

shown to be analogous to ﬁrst-order (discontinuous) phase transitions [21]. To our

knowledge no similar behavior has been observed in any other laser.

1.3.6 Many-atom dynamics in cavity QED

The ﬁeld of collective eﬀects in radiative properties goes back at least to Dicke [22],

who showed that a collection of N two-level radiators, localized within a distance

smaller than their radiative wavelength, may emit photons at a collective rate that

scales with N 2 instead of the usual N.

Many-atom eﬀects in the micromaser have been studied by a number of authors

([23]-[25]). It is well-known that the micromaser’s trap state resonances are easily

destroyed by two-atom events ([26] and [27]).

A study by Kolobov and Haake [23] of two-atom events predicts a change in

average photon number as well as location of the ﬁrst-order thresholds, relative to the

22

single-atom theory. On the other hand, Elk [24], considers a micromaser injected with

multiple atoms, equally spaced in time, and ﬁnds a scaling behavior very similar to

the single-atom theory. D’Ariano [25] considered a micromaser pumped with clusters

of up to several hundred atoms at once, an interesting model but one that cannot be

considered realistic in the present context.

The issue of many-atom eﬀects is central to this thesis and is considered in de-

tail in Chapter 3. We ﬁnd a result similar to that of [24], but we have a diﬀering

interpretation of an observed extra variance.

23

24

Chapter 2

Theory of the microlaser

We begin by considering the ideal model of a single atom in a cavity. The microlaser

is introduced by an semiclassical rate equation model which describes the basic fea-

tures of the microlaser in an intuitive way. We then give a fully quantized treatment

following the density matrix approach [28]. A Fokker-Planck analysis from [21] is re-

viewed which reproduces the rate equation solutions and also describes the transitions

between diﬀerent solutions in terms of an eﬀective potential.

2.1 Atom in a cavity

The Hamiltonian describing the interaction of a radiation ﬁeld with a single-electron

atom is

=

HA +

H

HF −

er

E

·

where

HA and

HF are the atom and radiation ﬁeld energies, r is the position of the

electron, and E is the electric ﬁeld operator:

(2.1)

(2.2)

(2.3)

¯hωka†

kak

HF =

k
X

HA =

¯hωaσz

1
2

25

(2.4)

(2.5)

(2.6)

(2.7)

(2.8)

Here the sum is over all allowed wave vectors k and

E =

ˆǫk

k(ak + a†
k)

E

k
X

k =

E

s

¯hωk
2ǫ0Vk

V =

w2

mL

π
4

is a function of mode volume Vk which for a near-planar cavity is given by

where L is the cavity mirror separation and wm is the Gaussian mode waist at the

center of the cavity.

The atom-ﬁeld interaction is given by

where

¯hgij

k (σ+ak + a†

kσ−)

HAF =

k
X

gij
k =

r

e
h

i
|

|

j
i ·
¯h

ˆǫk

k

E

For a two-level atom, we have in the rotating-wave approximation (i.e. neglecting

non-energy-conserving processes)

¯hωka†

kak +

¯hωaσz +

¯hgk(σ+ak + a†

kσ−)

(2.9)

=

H

k
X

k
X

where a†

k, ak are photon creation and destruction operators, σ+, σ+ are atom

creation and destruction operators, ¯hωa is the atom level spacing.

For a single mode cavity of frequency ωc we have

= ¯hωca†a +

¯hωaσz + ¯hg(σ+a + a†σ−)

(2.10)

H

1
2

1
2

26

To go to the interaction picture we write

H = H0 + H1
H0 = ¯hωca†a + 1
2¯hωaσz
H1 = ¯hg(σ+a + a†σ−)

The Hamiltonian in the interaction picture is

V = eiH0t/¯hH1e−iH0t/¯h = ¯hg(σ+aei∆t + a†σ−e−i∆t)

(2.12)

where ∆ = ωc −

ωa is the atom-cavity detuning.

∂
∂t |

i¯h

ψ

= V

ψ

.

i

|

i

The atom-cavity wavefunction can be written

ψ(t)

=

|

i

[ce,n(t)

e, n
i

|

+ cg,n(t)

]

g, n
i

|

∞

Xn=0

where

e, n
i

|

corresponds to a state with an excited atom with n photons in the cav-

ity, etc. Clearly the Hamiltonian mixes only the states

|
the Schrodinger equation can be written as the coupled equations

e, n
i

and

|

g, n + 1

. Therefore

i

˙ce,n =

ig√n + 1ei∆tcg,n+1,

˙cg,n+1 =

ig√n + 1e−i∆tce,n

−

−

A general solution is given by

ce,n(t) =

ce,n(0)

(cid:26)

2ig√n + 1
Ωn

cos(Ωnt/2)
(cid:20)

−

sin(Ωnt/2)

(cid:21) −

i∆
Ωn

cg,n+1(0) sin(Ωnt/2)

ei∆t/2

)

27

(2.11)

(2.13)

(2.14)

(2.15)

(2.16)

(2.17)

cg,n+1(t) =

cg,n+1(0)

cos(Ωnt/2) +
(cid:20)

sin(Ωnt/2)

(cid:21) −

(2.18)

(cid:26)

2ig√n + 1
Ωn

ce,n(0) sin(Ωnt/2)

e−i∆t/2

i∆
Ωn

)

where

and

Ωn =

∆2 + 4g2(n + 1)

q

If the atom is initially in the excited state, then ce,n(0) = cn(0) and cg,n+1(0) = 0,

ce,n(t) = cn(0)

cos(Ωnt/2)
(cid:20)

−

i∆
Ωn

sin(Ωnt/2)
(cid:21)

ei∆t/2

cg,n+1(t) =

cn(0)

−

2ig√n + 1
Ωn

"

sin(Ωnt/2)
#

e−i∆t/2

Consider the case of perfect resonance ∆ = 0 and initial condition of excited atom

with exactly n0 cavity photons. The solution is then given by

(2.19)

(2.20)

(2.21)

(2.22)

(2.23)

ce,n0(t) = cos(√n0 + 1 gt)

cg,n0+1(t) = sin(√n0 + 1 gt)

with all other ce,n(t), cg,n(t) equal to zero.

2.2 Rate equation for microlaser

Equations 2.22 and 2.23 describe resonant quantized Rabi oscillation. Note that oscil-

lation proceeds even for an initially empty cavity (n0 = 0) (vacuum Rabi oscillation).

In the microlaser, atoms interact with the cavity for an interaction time tint. The

emission probability for an atom is given by the squared ground state amplitude after

its interaction with the cavity:

Pemit =

cg,n0+1(tint)

2 = sin2(√n0 + 1 gt)

(2.24)

|

|

28

where for simplicity we suppose that the cavity initially contained exactly n0 photons.

Let us now write a rate equation for the cavity photon number n: the time rate

of change of n is equal to to the diﬀerence between gain and loss terms:

dn
dt

= G

L =

−

N
tint

sin2(√n + 1 gtint)

Γcn = 0

−

(2.25)

which is set equal to zero at steady-state. Here N is the number of atoms in the

cavity, which can be deﬁned by N/tint = r, the injection rate. Loss is equal to the

photon number multiplied by the cavity loss rate Γc.

The rate equation can be solved graphically as in Fig. 2-1. In general there exists

more than one solution.

A solution n′ is called stable if the system responds to a small perturbation in n

in a manner that tends to restore the original solution.

Stability condition:

∂
∂n

(G

L)

|n′ < 0

−

(2.26)

In terms of Fig. 2-1 a solution is stable if and only if the slope of the loss line

exceeds that of the gain line at their intersection.

The threshold atom number Nth is given by the point at which the gain and loss

terms have equal slope, assuming small argument of the sine function:

Nth =

Γc
g2tint

(2.27)

Solutions to 2.25 as the injection rate r is varied are plotted in Fig.2-2 , with gtint =

0.1. The number of solutions increases indeﬁnitely with increased r. Solutions are

asymptotic to constant-n lines corresponding to integer number of Rabi oscillations

√n + 1 gtint = mπ, m integer.

The rate equation analysis shows how the atoms’ sinusoidal emission probability

leads to bistability and multistability. However, its derivation was less than rigorous

and assumes that the cavity photon number is well-determined. In addition, it gives

no information about the relative stability of diﬀerent solutions, or the cavity photon

29

G, L
1

0.8

0.6

0.4

0.2

n
14000

12000

10000

8000

6000

4000

2000

1000 2000 3000 4000 5000 6000 7000 8000

photon number n

Figure 2-1: Dimensionless gain (solid line) and loss (dashed line) in the semiclassical
rate equation analysis for experimental g, tint, and N = 1000. Closed circles represent
stable solutions, open circles unstable solutions.

1000

2000

3000

4000

5000

Figure 2-2: Multiple solutions of microlaser rate equation. Dotted lines represent
photon numbers corresponding to an integer number of complete Rabi oscillations

Natoms

30

statistics.

For a more complete theory we turn to the quantum theory developed for the

micromaser by Filipowicz, Meystre, Scully and others ([21])

2.3 Quantum theory of microlaser

We follow the density matrix approach [28]. This theory in based on the following

assumptions:

1. Excited atoms are injected at a rate low enough so that at most one atom at a

time is present in the cavity.

2. Excited and “ground” state lifetimes are much longer than tint.

3. Cavity damping during interaction time is small: Γctint ≪

1

2.3.1 Density matrix equation of motion

Gain term

Consider the change in the cavity ﬁeld density matrix due to the injection at time t0

of an excited atom, which then interacts with the cavity for time tint:

δρnn′ = ρnn′(t0 + tint)

ρnn′(t0)

−

(2.28)

The state ρnn′(t0 + tint) may be found by determining the atom-ﬁeld evolution from

time t0 to t0 + tint and then tracing over atomic variables:

ρnn′(t0 + tint) =

ρα,n;α,n′(t0 + tint)

(2.29)

Note that density operators with four indices represent combined atom-cavity sys-

tems; those with two represent the ﬁeld only. A coarse-grained derivative for the gain

α=e,g
X

31

contribution to the ﬁeld density matrix can now be written

dρnn′

 

dt !gain

= r[ρen;en′(t0 + tint) + ρgn;gn′(t0 + tint)

ρen;en′(t0)]

(2.30)

−

We now replace t0 with the arbitrary continuous time t. The time-evolved density

matrices ρen;en′(t + tint) and ρgn;gn′(t + tint) are determined from the solutions for the

excited state amplitudes as in section 1 of this chapter. We have

ce,n(t + tint)

= cen(t) cos(√n + 1 gtint)

cg,n+1(t + tint) = cg,n+1(t) sin(√n + 1 gtint)

which gives for the density matrices

ρen;en′(t + tint) = ce,n(t + tint)c∗

e,n′(t + tint) =
ρnn′(t) cos(√n + 1 gtint) cos(√n′ + 1 gtint)

ρgn;gn′(t + tint) = cg,n(t + tint)c∗

g,n′(t + tint) =

ρn−1,n−1′(t) cos(√n gtint) cos(√n′ gtint)

(2.31)

(2.32)

We then have the reduced ﬁeld density matrix equation of motion:

dρnn′
dt

(cid:16)

gain

(cid:17)

=

r[1

cos(√n + 1 gtint) cos(√n′ + 1gtint)]ρnn′+

−

−
r sin(√ngtint) sin(√n′gtint)ρn−1,n′−1.

(2.33)

Note that we have made no assumptions about the photon number distribution

Loss term

The contribution due to cavity loss is

dρnn′

 

dt !loss

=

Γc
2

−

a†aρ

2aρa† + ρa†a
(cid:17)

−

(cid:16)

(2.34)

for zero thermal photons. This is a standard result from the theory of oscillators

coupled to a reservoir (c.f. [28] chapter 8.)

32

Combining 2.33 and 2.34, the total density matrix equation of motion is

˙ρnn′ = ann′ρnn′ + bn−1,n′−1ρn−1,n′−1 + cn+1,n′+1ρn+1,n′+1

(2.35)

ann′ =

r[1

−

−

cos(√n + 1 gtint) cos(√n′ + 1gtint)]

Γc

2 (n + n′)

−

bnn′ = r sin(√ngtint) sin(√n′gtint)

(2.36)

cnn′ = Γc√nn′

If we restrict ourselves to diagonal matrix elements this master equation reduces to

˙ρnn = annρnn + bn−1,n−1ρn−1,n−1 + cn+1,n+1ρn+1,n+1

(2.37)

where

where

r sin2(√n + 1 gtint)

ann =
bnn = r sin2(√ngtint)

−

Γcn

−

cnn = Γcn

(2.38)

2.3.2 Steady-state photon statistics

Setting ˙pn(t) = ˙ρnn(t) = 0 gives the equation

r sin2(√n + 1 gtint) + Γcn
o
n

p(n) + r sin2(√ngtint)p(n

1)+

−

(2.39)

Γc(n + 1)p(n + 1) = 0

which leads to the following recurrence relations:

r sin2(√n + 1 gtint) + Γcn
}

{

p(n) = Γc(n + 1)p(n + 1)

(2.40)

r sin2(√ngtint)p(n

1) = Γcnp(n)

(2.41)

−

33

(2.42)

(2.43)

(2.44)

(2.45)

We obtain the steady-state photon distribution of the microlaser:

p(n) = p(0)

r sin2(√k gtint)
Γck

n

Yk=1

where p(0) is determined from normalization.

It is convenient to deﬁne two quantities, the expectation photon number

p(n) = 1

n
X

Nex = r/Γc

θ =

Nexgtint

q

equal to the number of atom injections per cavity decay time, and the normalized

interaction time or pump parameter

which is the Rabi phase if Nex photons are present. Linearization of the rate equation

for small n and setting gain equal to loss gives θ = 1 as the laser threshold condition.

Mean photon number

In Fig. 2-3 the photon number has been plotted as function of pump parameter θ for

Nex = 10. Note the dips due to integer number of Rabi oscillations (trap states) and

a “jump” near θ = 2π which becomes sharper as Nex becomes large.

Photon statistics

parameter, deﬁned as

The width of the photon number distribution can be characterized by the Mandel Q

n2

h

Q

≡

2

n
i

1

−

i − h
n
i
h

(2.46)

The Q parameter is equal to zero for Poisson statistics (for which the variance

i −
, greater than zero for super-Poisson statistics (e.g. thermal light) and less

h

n2

2 =

n
i

h

n
i

h

34

microlaser theory

>
n
<

10

9

8

7

6

5

4

3

2

1

0

0

2

4

8

10

12

6

theta

Figure 2-3: Micromaser theory result for

, Nex = 10

n
i

h

than zero for sub-Poisson statistics.

In Fig. 2-4 the Mandel Q parameter is plotted as function of pump parameter θ

for Nex = 10. The cavity photon statistics are sub-Poisson over wide ranges of θ.

To compare with the rate equation result we now calculate the results from

Eq. 2.42 as the number of cavity atoms is varied, with ﬁxed gtint.

Fig. 2-5 shows the average photon number from Eq. 2.42 together with the rate

equation result. We see that the fully quantized theory agrees with one of the rate

equation stable solutions except during “jumps” corresponding to transitions between

the solutions. The quantum theory essentially “chooses” one of the rate equation

solutions.

During the transitions, which become increasingly narrow as Nex is increased, the

photon number distribution has two peaks corresponding to the two stable solutions.

It can be shown that the rate equation solutions correspond to within

1 of a local

±

maxima of the p(n) distributions from the quantum theory. Suppose a local maximum
in p(n) exists at n = n0; this means that p(n0) > p(n0 ±

1) and the quantity inside

35

microlaser theory

2

4

8

10

12

6

theta

Figure 2-4: Micromaser theory result for Q, with Nex = 10. Q < 0 indicates sub-
Poisson statistics.

Q

0.5

1.5

2

1

0

-0.5

-1

0

n
14000

12000

10000

8000

6000

4000

2000

1000

2000

3000

4000

Figure 2-5: Rate equation solutions (dotted lines) compared with quantum microlaser
theory (solid line).

36

Q

1

0.75

0.5

0.25

-0.25

-0.5

-0.75

-1

500 1000 1500 2000 2500 3000 3500 4000

Natoms

Figure 2-6: Q parameter according to microlaser quantum theory. Statistics are
strongly sub-Poissonian for almost every point over threshold. Spikes are due to
bimodal photon distributions during phase transitions.

the product of Eq. 2.42 passes through 1 between k = n0 and k = n0 + 1:

r sin2(√n0 gtint)
Γcn0

> 1 >

r sin2(√n0 + 1 gtint)
Γc(n0 + 1)

Setting

r sin2(√n0 + 1 gtint)
Γc(n0 + 1)

= 1

gives the original rate equation Eq. 2.25.

(2.47)

(2.48)

2.4 Modiﬁcation for realistic parameters

We describe modiﬁcations to the rate equation and quantum theory in order to ac-

comodate the atomic velocity distribution, nonuniform atom-cavity coupling, atom-

cavity detuning, and imperfect pumping.

37

2.4.1 Averaging of gain function

The framework for all these modiﬁcations is the same: we calculate the eﬀect of the

relevant broadening on the “gain function” β(n) which for an ideal (monovelocity

etc.) microlaser is given by

β0(n) = sin2(√n + 1 gtint).

(2.49)

For example, the eﬀect of a velocity distribution fv(v) is the average

¯β(n) =

sin2(√n + 1gtint(v))fv(v)dv

(2.50)

∞

0
Z

The steady-state photon statistics are then given by

p(n) = p(0)

r ¯β(k)
Γck

n

Yk=1

(2.51)

Note that we essentially replace a process in which diﬀerent atoms experience dif-

ferent interactions, with a process in which all atoms experience the same averaged

interaction. This may seem implausible until we realize that the end result 2.51 rep-

resents an average itself. Our averaging procedure follows from the assumption that

the random variables associated with the velocity, etc. are independent (cf. [21]).

The following expression is used to give the average of the gain function over

velocity distribution, coupling variation, and detuning:

¯β(n) =

∞

0
Z

B(n, v, ∆(v)) fv(v) fg(g) dv dg

(2.52)

where ∆(v) = kvθ and B(n, v, ∆) is the gain function including detuning. It might be

expected that B(n, v, ∆) is given by the well-known solution involving the generalized

Rabi frequency

B(n, v, ∆) =

4(n + 1)g2
4(n + 1)g2 + ∆2 sin2

4(n + 1)g2 + ∆2tint
h

i

(wrong)

(2.53)

38

However, this expression is only valid for constant ﬁelds. In general B(n, v, ∆) must

be calculated numerically and its form will depend on the shape of the coupling

proﬁle g(x = vt), not just its area. The function B(n, v, ∆) is found by integrating

the Bloch equations ( Eqns. 2.15 and 2.16) for a initially excited atom in a ﬁeld with

detuning ∆ and Rabi frequency √n + 1g(t) during a simulated transit through the

cavity. Integration of B(n, v, ∆) for every calculation would be very time-consuming;

therefore we tabulate this function on a grid and construct an interpolating function

to be called on by our theory calculations.

2.4.2

Imperfect inversion

The adiabatic pumping process described in Chapter 4 is not perfect: for the data

shown in the Chapter 5, the excited state probability was about 80%, measured by a

ﬂuorescence experiment. This includes a small contribution from atomic decay during

the pump process and the transit time between the pump ﬁeld and cavity mode.

Let ρee and ρgg be the upper and lower state probabilities, respectively. We claim

that for Nex very large the eﬀect of nonzero ρgg is simply to reduce the eﬀective

number of atoms to

Neﬀ ≡

N(ρee −

ρgg).

(2.54)

assuming ρee > ρgg. That is, instead of the number of atoms we may speak of the

inversion. This idea is a familiar one in laser physics.

To support this claim we note that atoms initially in the ground state have a

probability of removing (absorbing) a photon from the ﬁeld of

Pabsorb = sin2(√n gtint)

(2.55)

Intuitively it is clear that the case ρee = ρgg = 1/2 would produce essentially zero

photons, since the initially lower state atoms absorb photons in the same manner as

the upper state atoms emit them.

39

G, L
1

0.8

0.6

0.4

0.2

1000 2000 3000 4000 5000 6000 7000 8000

Figure 2-7: Dimensionless gain (solid line) and loss (dashed line) in the semiclassical
rate equation analysis, including eﬀects of velocity distribution, nonuniform coupling,
and detuning, with N = 1000. Closed circles represent stable solutions, open circles
unstable solutions.

In the rate equation picture, the net emission rate per atom is then modiﬁed to

P ′
emit = ρee sin2(√n + 1 gtint)

ρgg sin2(√n gtint)

ρgg) sin2(√n + 1 gtint)

(ρee −

≈

−

(2.56)

with corrections on the order of 1/2√n. Corrections may aﬀect the initial threshold

region somewhat but for most of the range of interest in our experiments, n is very

large.

Realistic rate equation and quantum theory

Fig. 2-8 gives the equivalent of Fig. 2-5 after realistic eﬀects, appropriate to the data

presented in Chapter 5 have been included.

The average photon number can also be plotted as a function of detuning. (Fig. 2-11).

n

40

n
8000

7000

6000

5000

4000

3000

2000

1000

Q

1

0.75

0.5

0.25

-0.25

-0.5

-0.75

-1

500

1000

1500

2000

2500

Figure 2-8: Photon number vs. atom number, rate equation (dashed line) and micro-
laser theory (solid line) including eﬀects of velocity distribution, nonuniform coupling,
and detuning.

500

1000

1500

2000

2500

Figure 2-9: Q parameter according to microlaser quantum theory, including real-
istic eﬀects as in Fig. 2-8. Spikes are due to bimodal photon distributions during
transitions.

N

N

41

n

6000

5000

4000

3000

2000

1000

-10

-5

0

5

10

15

Detuning, MHz

Figure 2-10: Rate-equation solutions for Neﬀ = 1000. Second and third branches
appear as closed curves. Upper halves of closed curves represent stable solutions.
Small gaps are artifacts from algorithm used to ﬁnd solutions.

2.5 Fokker-Planck analysis

In [21] a Fokker-Planck equation for the cavity photon number distribution p(n, t) is

derived:

∂
∂t

∂
∂n

−

p(n, t) =

Q(n)p(n, t) +

1
2

∂2
∂n2 [G(n)p(n, t)]

where for zero thermal photon number

Q(n) = R sin2(√ngtint)

Γcn

−

G(n) = R sin2(√ngtint) + Γcn

and R is the injection rate. To generalize to our averaged case we replace the
sin2(√ngtint) terms with ¯β(n) from 2.52.

(The replacement of n by n + 1 is in-

signiﬁcant on the photon number scale we will consider.) Equation 2.57 was shown

to reproduce the average photon number and photon statistics of micromaser theory

as long as (i) the pump parameter θ

(nNex)1/2 and (ii) n

1. Both of these

≫

≪

42

(2.57)

(2.58)

(2.59)

n

3000

2000

1000

-15

-10

-5

5

10

MHz

15

Figure 2-11: Solutions to rate equation with realistic parameters, as a function of
detuning, Neﬀ = 600. Dotted line, quantum theory shows jumps in detuning curve.

conditions are easily met in our case.

We now rescale time to the cavity lifetime and photon number to expectation

photon number: τ

tΓc, ν

n/Nex. Then Eq. 2.57 becomes

≡

∂
∂t

≡

∂
∂ν

−

p(ν, t) =

q(ν)p(ν, τ ) +

1
2

∂2
∂ν2 [g(ν)p(ν, τ )]

with

q(ν) = ¯β(νNex)

ν

−

g(ν) = ¯β(νNex) + ν

noting that Nex = R/Γc.

The stationary solution to the Fokker-Planck equation is then

p(ν) =

C
g(ν)

exp

2Nex

 

0
Z

∞

dν

q(ν)
g(ν) !

where C is a normalization constant. For large Nex the photon number distribution

will accumulate in the global maximum of the exponent of Eq. 2.63, or equivalently

43

(2.60)

(2.61)

(2.62)

(2.63)

the global minimum of an eﬀective potential deﬁned by

The local minima of V (ν) are the zeros of q(ν), which are the solutions of

V (ν) =

− Z

dν

q(ν)
g(ν)

¯β(νNex) = ν

(2.64)

(2.65)

which is equivalent to the rate equation derived in 2.25.

We now have an intuitive picture for the transitions between stable points: they

occur as the global minimum of the eﬀective potential V (ν) changes from one point

to another. This is a variation on the Landau theory of phase transitions, with √ν
as the order parameter. Note that as Nex → ∞
sharp in a similar manner to the sharpness of phase transitions for a large number of

the transitions become inﬁnitely

We note that the initial threshold is of second-order: as the injection rate is in-

creased there is a continuous increase of the global minimum in the eﬀective potential

2.5.1 Metastability and hysteresis

In general the microlaser does not automatically ﬁnd the global minimum but must

ﬂuctuate to it from out of a local minimum. Therefore hysteresis is expected if

parameters are varied faster than the transition rate between metastable and stable

To give an example, let us consider the rate equation solutions as detuning is

varied. As shown in Fig. 2-11 the ﬁrst branch appears as an inverted parabola-

type shape centered around zero detuning (relative to resonance of most probable

velocity atoms); higher branches ﬁrst appear as closed curves, and with increased

atom number, join with the ﬁrst branch solution.

(See Fig. 2-12). Suppose that

metastable lifetimes are very long and spontaneous transitions do not occur. Then

44

particles.

from ν = 0.

states.

n
8000

7000

6000

5000

4000

3000

2000

1000

25

50

75

100

125

150

175

Detuning, 106 s−1, for experimental parameters.

Figure 2-12: Rate equation solutions (realistic parameters) as a function of detuning,
N = 2500. Arrows show transitions that could occur due to disappearance of solutions
as detuning is changed.

as detuning is modulated we would expect a consistent hysteresis pattern following

the arrows in Fig. 2-12). These transitions occur when parameters change so that a

local minimum in the potential disappears entirely, and the system is forced to the

next potential minimum it encounters (not necessarily the global minimum).

Similar features would be encountered for photon number as a function of atom

number.

2.5.2 Transition rates

The tunneling rate from a metastable solution to a global minimum is estimated via

the Kramers analysis [21] to be, in units of cavity linewidth,

W =

1
2π "|

q′(νm)

q′(νM )

|

1/2

g(νM )
g(νm) #

exp

2Nex[V (νM )

{−

V (νm)]
}

−

(2.66)

45

1000

2000

3000

4000

5000

v

V (ν)

VHvL

-0.05

v_M

-0.1

v_m

-0.025

-0.075

-0.125

-0.15

global min

Figure 2-13: Tunneling from local to global minimum in the eﬀective potential V (ν),
plotted for realistic microlaser parameters with Neﬀ = 600.

where νm is the metastable local minima point and νM is the local maximum over

which the system must tunnel to reach a global minimum (or possibly another, lower

energy, metastable local minimum). (Fig. 2-13)

46

Chapter 3

Numerical simulations of

many-atom microlaser

We present results from quantum trajectory simulations of a microlaser/micromaser

device in which more than one atom at a time may be present and atom transit times

are not required to be much smaller than the cavity decay time. For parameters

in which the system is well removed from the inﬂuence of trap states the average

photon number is in good agreement with an appropriately scaled single-atom, weak-

decay micromaser theory. The photon number variance, however, shows an increase

proportional to N/Nex = Γcavtint for parameters in which the weak-decay theory

predicts sub-Poisson statistics.. This result is similar to that found by Elk in the

case of regular atomic injection [24]. By considering the case Nex = 1 we show that

this broadening of the photon number distribution is not a many-atom or correlation

eﬀect, but is due to cavity decay during the atom’s transit through the cavity.

3.1 Introduction

The microlaser and micromaser diﬀer from conventional lasers and masers not only

in that they use single atoms as the gain medium, but in the controlled nature of the

atom-cavity interaction. Uniformity of the coupling strength between atom and cavity

[10] and interaction time tint of the atom through the cavity, in addition to the long

47

lifetime of the atom upper level state compared to the transit time, create an unusual

situation in which diﬀerent atoms undergo nearly the same interaction with the cavity.

That is, interaction is almost independent of decay and other random eﬀects. This is

in contrast to descriptions of a conventional laser [20] in which ensemble averages are

performed to account for the lifetimes of the excited atoms, inhomogeneous eﬀects,

etc.

[21]:

It is natural to ask which properties of the microlaser/micromaser persist even

when the restriction of a single atom is lifted. Dynamics based on single-atom quan-

tum Rabi oscillations are not necessarily expected to hold; in addition, correlation

eﬀects may cause unknown diﬀerences from single-atom theory.

A related problem is to determine the eﬀect of abandoning an assumption made

in analytical treatments of the microlaser/micromaser [21] that the cavity decay time

is much longer than the interaction time, i.e. Γcavtint << 1, where Γcav is the cavity

linewidth. In this paper we will call this the condition of weak decay.

The present study was motivated by the realization that with the current ex-

perimental parameters, more than one atom at a time must be present for laser

oscillation to occur.

In going from the standing wave to the tilted atomic beam,

uniform-coupling, traveling-wave interaction [10] the coupling strength g is decreased

by a factor of 2 relative to the peak standing-wave value. (This factor of 2 was incor-

rectly reported as a factor of √2 in [10].) The threshold number of atoms is given by

Nth =

Γcav
g2tint ∼

4,

This is to be compared with Nth ∼
experiment [8] if g is taken at an antinode. Therefore the study of multiple atom

1 for the original (standing wave) microlaser

eﬀects is necessary for understanding the microlaser with traveling-wave interaction.

Eﬀects relating to ﬁnite Γcavtint are also of interest in the microlaser, since with

present parameters [10] we have Γcavtint ∼
48

0.1.

3.2 Previous approaches

The eﬀect of 2-atom events was studied in [73] in the context of micromaser trap

states. It was shown that collective events destroy trap state resonances with great

eﬃciency.

More general treatments of multi-atom behavior have involved strong simpliﬁca-

tions to the atom injection scheme.

D’Ariano studied a micromaser system pumped by clusters of up to N = 100

atoms which all enter and leave the cavity at the same time [25]. It was shown that

for N < Nex the system behaves similarly to the one-atom maser, and for N > Nex

the system exhibits multiple thresholds.

Elk [24] considered an injection scheme in which atom arrivals are equally spaced

in time. Results for small θ and N < Nex showed a nearly constant average photon

number but a linear increase in photon number distribution width σ with N/Nex.

However, it is diﬃcult to determine whether the results are related to regular injection

of atoms, which in general causes a reduction of noise (i.e. smaller σ). We note that

the results in the case N = 1 do not agree with single-atom micromaser theory [21].

In this paper we study the case of realistic, Poisson atomic injection, and interpret

the results based on ﬁnite transit-time rather than many-atom eﬀects.

3.3 Quantum trajectory analysis

To simulate the microlaser with random (Poisson) injection of atoms, we used a

quantum trajectory algorithm [32],[33]. This technique was previously used to analyze

the threshold-like transition, and the possibility of many-atom eﬀects, in the original

standing-wave microlaser in [30]. This paper contains for a detailed description of the

extended quantum trajectory technique also employed in the present study.

Due to limitations of computer memory and processing time, for each simulation

run it was necessary to set a maximum value Nmax for the number of atoms that

could be present in the cavity at a given time. In each case Nmax was adjusted such

49

that the “overﬂow” probability was 1% or less, ensuring that the statistics are very

close to Poissonian.

In single-atom micromaser theory [21], the behavior of the system is determined

by three parameters: (i) the expected photon number Nex = r/Γcav where r is the

atom injection rate; (ii) the pump parameter θ = √Nex gtint where g is the atom-ﬁeld

coupling constant; and (iii) the thermal photon number nb.

It is then shown that, with the assumptions of single-atom events and Γcavtint << 1

(weak decay), [21] the steady-state photon number distribution in the cavity is given

by

pn = p0

n n

nb
1 + nb (cid:21)

(cid:20)

Yk=1 "

1 +

Nex sin2(√k + 1gtint)
nbk

#

(3.1)

where p0 is determined by normalization. In this paper Eq. 3.1 will be referred to as

the result from micromaser theory, although it is also applicable to the microlaser.

In this study we set thermal photon number nb = 0

We performed runs of 10,000 – 100,000 atom injections, for varying values of Nex,

θ and number of intracavity atoms N

rtint. We scaled g and Γc as necessary to

≡

obtain the correct values for Nex and θ as N was varied. At the beginning of each

run, at least 2,000 atom injections were neglected in order to allow the system to

reach steady state before data collection began.

Most simulations were performed with Nex = 10. This value was chosen for several

reasons. First, a relatively low photon number allows larger numbers of atoms to be

considered. Second, eﬀects that scale as N/Nex are more apparent for smaller Nex.

Finally, we observed that simulations reached their steady-state distributions much

more rapidly for lower Nex.

For simplicity, and to allow comparison with analytic theory, we regard g and tint

to be perfectly well-deﬁned (i.e. uniform coupling and monovelocity atoms). Our

QTS program has also allowed us to simulate the eﬀects of various types of variation

and broadening in a realistic system. Results of these investigations will be reported

elsewhere.

50

Microlaser theory
N=0.01
N=0.1
N=1.0

>
n
<

10

9

8

7

6

5

4

3

2

1

0

0

2

4

8

10

12

6
theta

Figure 3-1: Two-atom events destroy the trap state resonances

The simulation was written in C (see Appendix) and all calculations were per-

formed on a 400 MHz Pentium II workstation running Linux. The calculations pre-

sented here required roughly 2000 hours of CPU time in total.

3.4 Results

3.4.1 Single atom limit; Trap states

Fig. 3-1 shows the average photon number as a function of θ, for Nex = 10. Note

the deep depressions due to trap states resonances in which atoms perform integral

numbers of Rabi oscillations.

With N = 0.1 the QTS results for average photon number

show signiﬁcantly

smaller modulation due to trap states than the result of Eq. 3.1 although the proba-

bility of the cavity containing 2 or more atoms at any given time is

2%. It is only

n
i

h

∼

51

microlaser theory
N=0.01
N=1.0
N=2.0
N=3.0
N=5.0

>
n
<

10

9

8

7

6

5

4

3

2

1

0

in [73].

0

2

4

8

10

12

6

theta

Figure 3-2: Quantum trajectory results for average photon number

with N = 0.01 that QTS results give good agreement with micromaser theory. This

illustrates the sensitivity of the trap state resonances to 2-atom events as described

The photon number distributions in the low-N limit were veriﬁed to be in excellent

agreement with Eq. 3.1, further conﬁrming that the simulation was working properly.

3.4.2 Broadening of photon number distribution

Figs. 3-2 and 3-3 show values of average photon number n and Mandel parameter

Q

(

n2

≡

h

i − h

2)/

n

n
i

h

i −

1 as a function of θ for a range of atom numbers N, with

Nex = 10. Note that for larger values of θ, Q is large and may be diﬃcult to interpret

due to the presence of 2 or more peaks in the photon number distribution.

For θ < 5, before the trap state resonances occur, the results for average photon

number remain remarkably close to the prediction of micromaser theory. The values

52

Q

0.5

1.5

2

1

0

-0.5

-1

0

microlaser theory
N=0.01
N=1.0
N=2.0
N=3.0
N=5.0

53

0.5

1

1.5

2

2.5

3

3.5

4

4.5

theta

Figure 3-3: Quantum trajectory results for Mandel Q parameter

Q

0.2

0.1

0

-0.1

-0.2

-0.3

-0.4

-0.5

-0.6

-0.7

Nex=5
Nex=10
Nex=15
Nex=30

0

0.2

0.4

0.6

0.8

1

N/N_ex

Figure 3-4: Universal curve showing an increase in Q which scales with N/Nex

for Q, however, show a signiﬁcant increase with N in the range 2 < θ < 5. This

interval corresponds to the region in which according to micromaser theory the system

displays sub-Poisson statistics (Q < 0).

Similar increases in Q are observed in a small interval near θ = 8, between two

trap states. Simulations with Nex =30 and 50, in which trap state resonances are

more narrow, showed similar behavior over wider intervals between trap states.

The parameter Q was calculated as a function of N/Nex, with θ = 3, for Nex = 5,

10, 15, 30. The increase of Q is seen to be linear with N/Nex; for Nex ≥
(Fig.3-4) that all points may be approximately described by

5 we ﬁnd

Q = Q0(Nex, θ) + α(θ)(N/Nex)

(3.2)

where Q0 is the value of the Mandel parameter from micromaser theory and α(θ =

3)

0.80

.05.

≈

±

54

6

4

2

0

-2

-4

-6

Q, microlaser theory
Q, QTS
alpha

theta

55

0

2

4

6

8

10

Figure 3-5: Slope α(θ) of the increase in Q with N/Nex, as a function of pump
parameter

Q

-0.3

-0.15

-0.2

-0.25

-0.35

-0.4

-0.45

0

0.1

0.2

0.3

0.4

0.5

N

Figure 3-6: Increase of variance with N/Nex for Nex = 1

Fig. 3-5 shows α(θ) calculated via a least-squares ﬁt with Nex = 10 and 0 < N < 2.

Error bars indicate the degree of linearity. It is seen that α exhibits oscillation with

θ and is positive for θ where the single-atom, weak-decay theory predicts sub-Poisson

statistics (Q < 0).

3.4.3 Many-atom vs. ﬁnite transit time eﬀects

An increase of variance proportional to N/Nex was previously found by Elk, who

interpreted it as being due to many-atom interactions [24].

We note, however, that N/Nex is equal to simply tintΓc, a parameter describing

cavity decay during the transit time, and is not directly related to the number of

atoms. The extra variance observed in this study and by Elk can therefore be seen

as a consequence not of multiple atoms, but of cavity decay during an atom’s transit

time. For example, we may have N

1 but virtually no extra variance if Nex ≫

≫

N.

More importantly, there are examples in which N

1 but excess variance still occurs.

≪

Fig. 3-6 shows Q as a function of N for Nex = 1, θ = 2. A linear increase in variance

is seen even for N = 0.1.

56

Q

1

0.75

0.5

0.25

-0.25

-0.5

-0.75

-1

500

1000

1500

2000

2500

Figure 3-7: Dashed line: upper bound of Q parameter, including ﬁnite decay time
eﬀect. Solid line: Q parameter from microlaser theory without without ﬁnite decay
time eﬀects, as in Fig. 2-9.

3.5 Predictions for experiment

To apply our quantum trajectory results to our microlaser system, we make a seem-

ingly precarious assumption that simulations for N

5 atoms represent the behavior

≤

for up to N

1000. If true then the predictions for the experiment are as follows.

∼

No signiﬁcant deviation from the single-atom theory was found for the few-atoms

microlaser; therefore we would expect the cavity photon number to follow the pre-

diction of the microlaser with realistic parameters described in Sec. 2.4, as plotted in

Fig. 2-8.

that given in Fig. 2-9.

For the photon statistics, we have in the microlaser N/Nex ≈

0.1, and therefore

the perturbation to photon statistics is fairly small; it would not diﬀer strongly from

An upper-bound prediction for the Q parameter is given in Fig. 3-7.

N

57

3.6 Discussion

Our calculations have clariﬁed the distinction between many-atom eﬀects and ef-

fects due to cavity decay during transit-time. Many-atom events destroy the trap

state resonances and therefore have strong eﬀects for parameters for which these res-

onances are prominent. Away from these resonances, the system shows remarkable

agreement with single-atom micromaser theory. However, for values of θ for which

micromaser theory predicts sub-Poisson statistics, cavity decay during transit time

cause an increase in variance relative to micromaser theory, by an amount propor-

tional to N/Nex = tintΓc.

Lack of collective eﬀects away from trap states may be a consequence of the

noncorrelated Rabi phases of atoms which have entered the cavity at diﬀerent times.

Increase of variance represents an absolute decrease in the negative diﬀerential gain in

the atom-cavity system. Future work will include development of models to explain

the observed eﬀects quantitatively.

58

Chapter 4

Apparatus and methods of

microlaser experiment

In this chapter we describe the components of the microlaser and techniques used in

its study. In particular we describe how a well-deﬁned interaction between atoms and

cavity can be achieved.

4.1 Two-level atom

4.1.1 Barium energy levels

Figure 4-1 shows the levels of 138Ba relevant to the microlaser experiment. The mi-
crolaser uses the 1S0 ↔
proximately 50 kHz. The excited state decays to the ground state and two metastable

3P1 transition of wavelength λ = 791.1 nm and linewidth ap-

D states with a branching ratio of 0.43:0.41:0.16. We use this intercombination line

due to its relatively long lifetime Γ−1

a = 1.3 µsec .

The most frequently studied transition in 138Bais 1S0 ↔

1P1 at 553 nm. It has

a linewidth of about 19 MHz. The ﬂuorescence spectrum of a naturally occuring

barium sample is shown, with isotope shifts, in Fig. 4-2.

The 553 nm transition was used to measure atomic density in the cavity, determine

pump beam eﬃciency, and measure the atomic velocity distribution.

59

 

l =2.9 m m 
A=50 kHz 

l =2.9 m m 
A=19 kHz 

Aesar.

l =1500 nm 
A=48 kHz 

l =1130 nm 
A=18 kHz 

1P1 

1D2 
3D2 

3P1 

l =791.1 nm 
A=50 kHz 

3D2 
3D1 

l =553.5 nm 
A=18.9 MHz 

1S0 

Figure 4-1: Relevant energy levels for 138Ba.

Natural occuring barium, of which 71.7% is 138Ba, is relatively inexpensive and

readily available. We purchased the metal in rod form, packed in argon, from Alfa

4.2 Optical resonator

The microlaser cavity mirrors consist of superpolished fused silica substrates coated

with a multilayer, ion-sputtered dielectric coating. The substrates and coatings were

purchased from Research Electro-Optics (Boulder, Colorado). The coating consists

of 45 alternating layers of SiO2 and Ta2O5.

4.2.1 Characteristics

The microlaser cavity consists of two mirrors in a symmetrical, near-planar Fabry-

Perot conﬁguration. The mirror separation, measured via transverse mode spacing,

is 1.1 mm. The radius of curvature of the coated surfaces is 10 cm.

The mirrors have an overall diameter of 7?mm and length of ? mm. The actual

reﬂective surfaces are 45-degree beveled to a diameter of 3 mm in order to facilitate

60

Figure 4-2: Isotope spectrum of the 1S0 ↔

1P1 transition at 553 nm.

Figure 4-3: Brass cavity housing assembly and stainless steel cavity holders, from [9].

alignment of the tilted atomic beam and cleaning of the coated surfaces.

The mirrors are glued into stainless steel holders (Fig. 4-3) designed to hold the

mirrors without birefringence-inducing stress. The cavity is aligned outside the cham-

ber, then the holders are glued on the inside of a cylindrical piezo transducer (PZT)

used to modulate the cavity mirror spacing.

61

Figure 4-4: Microlaser resonator assembled with PZT

The microlaser experiment is performed with the fundamental (TEM00) mode of

the cavity (it is also possible to use higher-order transverse modes). The mode waist

w0 =

1/4

r0Lλ2
2π2 !

 

≈

41.1µm

where r0 is the mirror radius of curvature, L is the cavity spacing, and λ is the

is given by

wavelength.

The cavity mode volume is given by

and the peak atom-cavity coupling for the standing-wave case is

The atom-cavity interaction time for a particular atom is deﬁned as

g0 =

µ
¯h s

2π¯hω
V

= 385 kHz

V =

Lw2
0

π
4

tint =

√πw0
v

62

(4.1)

(4.2)

(4.3)

(4.4)

Figure 4-5: Support system for cavity assembly in chamber.

63

Figure 4-6: Cavity transmission of an earlier cavity (from [9]) showing TEM00 and
higher order transverse modes. Transverse mode spacing in the current cavity is 7.11
GHz.

 

where v is the atom’s velocity. The √π factor accounts for the Gaussian shape of the

cavity mode: the integral of g with time for a moving atom is the same as an atom of

the same velocity traversing a “top hat” mode of constant coupling g0 for time tint:

(4.5)

(4.6)

+∞

−∞

Z

g0 exp

−

 

(vt)2
w2

0 !

dt =

√πw0g0
v

= g0tint

The cavity spacing L was determined via measurement of the transverse mode

spacing. In a near-planar cavity,

∆νt =

2π

LR/2

, L

r0

≫

c

q

∼

where higher-order corrections can be shown to be

10−3 for our cavity [82, ch. 19].

We determined ∆νt by measuring the diﬀerence in PZT voltages between the fun-

damental and ﬁrst transverse mode resonances. The scan was calibrated by measuring

the PZT voltage shift between two sidebands of the 24.67 MHz FM modulation used

for laser frequency locking (see Sec. X). We ﬁnd the PZT scan calibration is 171.6

MHz/V and veriﬁed that it does not vary measurably over the PZT voltage range in

64

5
5
3

 

 

n
m
p
r
o
b
e

BS

7
9
1

 

 

n
m
p
r
o
b
e

M

5
5
3

 

n
m

 

c
o
u
n
t
e
r
p
r
o
p
a
g
a
t
i
n
g

 

p
r
o
b
e

M

M

791 nm / 553 nm probe

mirror on flipper

cavity

lens

pump beam is 

553 nm fluor. APD

collection optics

atom beam

M

M

0

+1

AOM after cavity

ND filter

PMT

cavity lock/finesse APD

Figure 4-7: Schematic of optics for microlaser experiment. To the right of the cavity
a mirror on a “ﬂipper” mount is used to switch between cavity ﬂuorescence detection
for velocity distributions and detection of cavity transmission.

question. The transverse mode spacing was measured to be

∆νt = 7.11 GHz

L = 0.90 mm.

(4.7)

(4.8)

giving a cavity length

4.2.2 Cavity PZT

The PZT controlling the cavity separation is a tube (Vernitron PZT-5A) of height

0.75” and inner diameter 0.75”, and wall thickness 0.125”. Four holes are drilled in

65

log signal 
6

5

4

3

2

1

1·10-6 2·10-6 3·10-6 4·10-6 5·10-6

time, s

Figure 4-8: Log of ringdown signal (a.u.) vs. time. Line shows least-squares linear
ﬁt. Here Tcav = 1.02 µsec and ﬁnesse F = 1.0

106.

×

the cylinder wall to allow passage of the atom and pump beams.

Isolation mechanisms are used to isolate the cavity from vibrations. Viton o-rings

hold the PZT inside a heavy brass housing (Fig. 4-3). The housing is placed in

a supporting structure by ﬁttings made of teﬂon (Fig. 4-5); the support in turn is

secured inside the vacuum chamber with teﬂon screws.

4.2.3 Finesse measurement by ringdown technique

The ﬁnesse of a Fabry-Perot cavity is deﬁned as the ratio of free spectral range (FSR)

to the FWHM of a cavity transmission peak, or equivalently.

=

F

√Rπ
1

−

R ≈

1

R

π

−

(4.9)

where R is the geometric average of the intensity reﬂectivity of the two mirrors,

i.e. R = √R1R2 and we assume R very close to unity.

To measure ﬁnesse we scan the cavity PZT through resonance with a probe laser

beam. The cavity decay time is measured by ﬁtting a curve to the exponential

decay of the cavity ﬁeld (Fig. 4-8). The signal shows a sinusoidal modulation due

66

Figure 4-9: Figure 4. Anomalous cavity transmission. Scan speeds: (i) 0.6, (ii) 4.8
GHz/s, compared with theory; (iii) unmodiﬁed cavity lineshape. (b) Frequency shift
vs. inverse cavity scan speed. The best ﬁt is for A = 0.2 ppm.

to interference between the probe beam and the Doppler-shifted cavity ﬁeld. This is

described further in Ref. [36].

4.2.4 Absorption measurement via thermally-induced opti-

cal bistability

The ﬁnesse is given by π/(1

R), with R

1 the mirror reﬂectivity and 1

R the

−

≈

−

total loss, equal to the sum of three loss parameters, the absorption A, scatter S

and transmission T . R, hence the total loss, can be measured by cavity ringdown

[36]. However, determining how the loss is distributed among A, S and T is diﬃcult.

In particular, few techniques exist for measuring very small absorption coeﬃcients.

Methods such as photothermal deﬂection [37] are capable of measuring A down to 1

ppm.

Recently we have developed a new technique to measure A at the sub-ppm level

67

[38, 39]. This technique relies on the intense circulating ﬁeld created when a resonant

probe beam is incident on a high ﬁnesse cavity. Any absorption of the intense internal

ﬁeld causes heating in the coating layers, and the subsequent thermal expansion of

the mirror substrate reduces the mirror separation distance and leads to a thermally-

induced optical bistability of the empty resonator. This optical bistability causes

distortion in the measured cavity lineshape, as observed by slowly scanning the cavity

length. The lineshape exhibits an extended resonance with a slow rise and rapid

drop (Fig. 4), the duration of the resonance being directly related to the absorption

coeﬃcient A [38].

We have characterized all three parameters and established that A

0.2 ppm and

≈

S

2.5 ppm, thus establishing that scattering is the predominant loss mechanism in

≈

our supercavity mirrors [39].

68

Figure 4-10: Microlaser output as a function of cavity-atom detuning, for varying
atomic beam tilt angles θ. From [10]

4.2.5 Uniform coupling by traveling-wave interaction

In the original microlaser experiment, the atom beam is incident normal to the cavity

axis and atoms interact with the standing wave of the Fabry-Perot cavity. Since the

coupling g is proportional to the local ﬁeld amplitude, which varies as sin2(kz), atoms

experience a wide range of coupling strengths.

We eliminated this problem by introducing a small tilt θ

1 between the atom

≪

beam direction and the normal to the cavity axis. Due to the Doppler shift, each

atom then experiences not one standing wave but two traveling waves of frequencies

ω

kvθ. If θ is suﬃciently large, the atom will be resonant with only one traveling

±

wave component at a time. This eliminates the fast spatial variation due to the

standing wave. It should be noted that in the traveling-wave conﬁguration the peak

coupling constant, g0, is reduced by a factor of 2 compared to the peak standing-wave

value (see Appendix D). (This factor of 2 was incorrectly reported as √2 in [10].)

69

4.3 Atomic beam

A typical atom beam apparatus consists of a container in which the sample is heated

in vacuum to form a vapor; a small nozzle allows vapor atoms to escape. Apertures

are placed downstream to collimate the beam.

We have two main requirements for our barium atomic beam: high beam density

and narrow velocity distribution in the ground state.

4.3.1 Velocity selection: mechanical, optical, or supersonic

An atomic beam with narrow velocity spread is needed to provide a well-deﬁned

atom-cavity interaction time (i.e. uniform transit time), and to ensure that all atoms

traversing the pump laser ﬁeld prior to entering the cavity are excited to a state of

complete inversion (π pulse condition).

The “classical” technique of mechanical velocity selection (via e.g. Fizeau wheel)

has several serious drawbacks: the beam created is pulsed, not continuous, and the

overall eﬃciency is low.

Two new methods for creating narrow-velocity ground state atom barium beams

have been developed in our laboratory.

4.3.2 Atomic velocity selection via optical pumping

We have developed a two-color optical pumping method for selectively preparing

atoms in the ground state at a certain velocity, in an eﬀusive beam. The beam is

created in a cylindrical, externally heated oven made of Inconel. Continuous-wave

lasers are used to pump tbe barium atoms, ﬁrst into the metastable 1D2 state via
the 6s2 1S0 ↔
6s6p 1P1 cycling transition (λ=553 nm), and then back to the 6s2 1S0
ground state with velocity selectivity via a tilted laser tuned to the 583 nm 6s5d 1D2 ↔
5d6p 1P1 transition (Fig. 4-11). When the most probable velocity v0 is selected we
obtain ∆vFWMM/v0 ≈

10% with approximately 50% repumping eﬃciency (Fig. 4-11).

70

)
t
i
n
u
 
.
b
r
a
(
 
e
c
n
e
c
s
e
r
o
u
l
f

1.2

1

0.8

0.6

0.4

0.2

0

-0.2

1P1

1P1

repump

pump & probe

1D2

1S0

both pumps blocked

both pumps unblocked

repump 
583 nm

probe 
553 nm

atomic 
beam

pump 
553 nm

-2.5

-2

-1.5

-1

-0.5

0

frequency (GHz)

Figure 4-11: Left: Twocolor optical pumping scheme. Right: Velocity proﬁle of the
selected atoms. In this experiment the pump laser is tuned to resonance, wherease
the repump laser is tuned to resonance with the atoms with most probable velocity
while the probe laser is scanned. In this example δv(FW)/v

13%.

≈

4.3.3 Supersonic oven

Background

Supersonic beam techniques have found many applications in spectroscopy and atom

interferometry since their invention in 1951 [78, 79, 80]. In a supersonic beam, adi-

abatic expansion as the beam exits the oven nozzle causes a dramatic cooling in the

frame of the moving atoms or molecules; random thermal energy is converted into di-

rected kinetic energy. In addition, the net ﬂow rate is generally much higher than for

an eﬀusive beam. This solves the two problems associated with conventional eﬀusive

beams: low intensity and a wide distribution of velocities.

Supersonic barium oven: apparatus

We have developed a supersonic beam oven for barium closely following the design

of Ref. [81], which was based on an eﬀusive beam source developed in our laboratory

and previously used for the microlaser experiment [8].

The atomic beam oven consists of resistively heated, barium-ﬁlled piece of tan-

71

Figure 4-12: Relevant 138Ba energy levels for optical velocity selection scheme. Dark
arrows represent transitions used for pump (553.5 nm) and repump (582.6 nm). A =
Einstein A coeﬃcient; BF = branching fraction.

72

talum tubing, in which a small nozzle hole has been drilled. A diagram in shown in

Fig. 4-13. The tubing is 6.5” long, 0.5” in diameter, with 0.015” wall thickness. The

nozzle diameter varied from 150 µm to 406 µm.

Like the atoms strontium and ytterbium used in Ref. [81], barium has two valence

electrons and negligible dimer formation.

The oven is created by the following procedure. A length of tubing is measured

and cut with a pipe cutter. The bottom 1.125” is pinched ﬂat in a vise between

two aluminum blocks. One quarter of a 2 cm diameter barium rod (cut by bandsaw

lengthwise) is inserted into the tantalum tube. The typical mass of barium in one

oven is 12-16 g. The top 1.5” of the oven is then ﬂattened in a vise, parallel with the

bottom of the oven. The oven is mounted in a specially designed holder to position

it with ﬂat parts horizontal. It is clamped in a milling machine where a 1/8” end

mill removes about 0.007” from the future location of the nozzle. This gives a shorter

“channel” for the atom ﬂow and creates a ﬂat surface for drilling the nozzle, which is

done in a miniature drill press.

In the experiment, the oven is clamped by two screws at each end between copper

electrodes. The upper electrode is connected to a copper tube which extends through

an 8” Conﬂat ﬂange via a 3/4” diameter Ultra-Torr ﬁtting. The bottom electrode

is soldered to a 4” diameter copper cold shield tube which both absorbs the oven’s

large thermal radiation and conducts current back up to the ﬂange coaxially with

the central conductor, to minimize stray magnetic ﬁelds from the oven. The upper

and bottom electrodes and the cold shield are cooled by water ﬂowing through 1/4”

copper tubing which has been soldered to the copper pieces.

A Proteus ﬂowmeter placed on the return path of the oven cooling water is con-

nected to a lamp which provides visual feedback that the water is ﬂowing.

The oven drive current is controlled manually using a variable Variac autotrans-

former with 208 VAC line input and 0-230 VAC output. The Variac output is con-

nected to a step-down transformer with 1:8 turn ratio, and the resulting output is

connected to the center conductor and top oven ﬂange (ground) via 2 pairs of 1” di-

ameter welding cables. The oven voltage and current are monitored by AC voltmeter

73

feedthrough
for central conductor

electrodes

VAC

ground

adjustment screws (x3)

top flange

vacuum bellows

cold shield

tantalum  oven

barium liquid

chamber wall

(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)

to diffusion pump

74

Figure 4-13: Supersonic oven design

clamp/support

center conductor

top electrode

to cavity

atom beam

oven nozzle

bottom electrode

and a clamp-on ammeter. The voltage varies from 0-5VAC and current 0-1000 A

rms?. The resistance of the entire circuit varies from approximately 4 mΩ to 6 mΩ

depending on oven temperature.

Supersonic barium oven: results

As oven power is increased, the beam density increases and the beam undergoes

a transition from Maxwell-Boltzmann (thermal) velocity distribution to supersonic

velocity distribution.

We measured the atomic density and velocity distribution via 553 nm 1S0 ↔
ﬂuorescence. To measure density, the 553 nm beam was aligned to overlap the 791

1P1

nm probe beam along the cavity axis and the ﬂuorescence was detected by CCD

(see section 4.6). Velocity distribution was measured by aligning a focused 553 nm

beam in the cavity in a direction opposite to atom beam direction, and detecting

the Doppler-dependent ﬂuorescence via a photon counting APD (EG&G C30902TE)

previously aligned with the cavity transmission. A 500 µm diameter pinhole located

in front of the APD and mounted on an XY translation stage blocks scattered light

from the ground glass beveled edges of the cavity mirrors.

Figure 4-14 shows the velocity distribution for the supersonic beam used in the

experiments. This oven had a nozzle size of 406 µm and was driven by about an rms

current of about 600 amperes.

The degree of velocity compression can be characterized by the ratio between

FWHM of the measured velocity distribution and most probable velocity ∆v/v0.

The measured velocity distribution fm(v) is equal to the actual velocity distri-

bution f (v) convoluted with a lineshape function accounting for atom linewidth and

isotope shifts. Laser power broadening eﬀects can be minimized by using a probe

laser beam intensity well below saturation.

Although the supersonic expansion results in a higher velocity and thus smaller

interaction time (roughly by a factor of 2), there are several advantages of the su-

personic oven. First, and most importantly, velocity narrowing gives higher densities

than velocity selection because non-selected atoms are lost in the latter.

In addi-

75

fluor

200

400

600

800

1000

1200

v, m(cid:144)s

Figure 4-14: Fluorescence signal of a counterpropagating 553 nm probe beam as mea-
surement of supersonic beam velocity distribution. Zero of distribution determined
by simulataneous measurement of Lamb dip transmission. Curve: Gaussian ﬁt with
peak velocity v0 = 816 m/s, σ = 70.2 m/s. When natural linewidth and isotope shifts
are taken into account, we ﬁnd ∆vFWHM/v0 = 16.5%.

tion, the supersonic beam gives far higher densities than even a non-selected thermal

beam, due to the higher oven temperatures. Experiments with the supersonic beam

are simpler because the additional lasers and locking systems are not needed. Due to

these advantages, all of the microlaser experiments in this thesis were done with the

supersonic beam.

4.3.4 Final aperture

The small dimensions of the microlaser cavity mode place strong constraints on the

size and location of the atomic beam. It must be small and closely centered on the

mode if reasonably uniform coupling is to be obtained.

Variation due to the Gaussian shape of the cavity mode can be made relatively

small by limiting the dimensions of the atomic beam inside the cavity. For an atomic

beam of height h centered in the mode, the ratio of minimum to maximum coupling

is

gmin
gmax

= e−(h/2w0)

2

(4.10)

This value is plotted in Figure 4-16. For a beam size of 25 µm we have gmin/gmax ≈
76

atom beam

cavity mode

-2

-1

1

2

3

0
x(cid:144)w_m

Figure 4-15: Atom beam width compared with cavity mode. Atom beam should
“sample” only the peak of the mode to minimize coupling variation. Here the aperture
width is set equal to one-half the mode waist wm.

0.90

In order to create a small beam in the cavity we collimated the atomic beam

with a 24.5 µm diameter aperture placed approximately 3 mm from the cavity axis.

The distance between aperture and cavity is important because a larger distance

increases the broadening of the atom beam due to the ﬁnite solid angle of the atom

beam source (i.e. oven nozzle). The aperture was mounted onto a thin, hollow,

tapered “pencil” which ﬁt into the hole drilled into the PZT to allow passage of the

atomic beam. The pencil is attached to the center of a 1/2” stainless-steel compact

mirror mount which allows the orientation of the pencil to be modiﬁed precisely.

The mirror mount was mounted on a miniature motorized rotation stage (National

Aperture MM–3M–R). A stepper driver (National Aperture MC-II) located outside

the chamber is connected to the rotation stage by a 10-pin electrical feedthrough. The

mirror mount adjustment screws were tweaked so that center of rotation is located

at the center of the aperture. Finally, the rotation stage and aperture assembly were

connected to an XY miniature translation stage (National Aperture ST1XY) which

could be manipulated from outside the chamber through two 1/8 inch Ultra-Torr

77

coupling var

0.6

0.5

0.4

0.3

0.2

0.1

0.25 0.5 0.75

1

1.25 1.5 1.75

2

a(cid:144)w_m

Figure 4-16: Coupling variation 1

gmin/gmax due to ﬁnite aperture size a

−

feedthroughs. The feedthroughs couple to the stage via ﬂexible couplings.

The pencil has a tapering design in order to be small enough at the tip to approach

the cavity closely, and yet large enough to accomodate a range of atomic beam angles

and avoid clipping the beam. The pencil was made from several pieces of brass

telescoping square tubing, glued together with Varian Torr-Seal vacuum epoxy. The

aperture (12.7 µm thick stainless steel, from National Aperture) was attached to the

pencil tip with Torr-Seal.

To center the atomic beam on the cavity mode axis, we monitored the microlaser

emission power as a function of atom beam vertical position (measured by imaging

the aperture with the imaging system described in Sec. 4.6). By this method we

are able to ﬁnd the center of the mode to a few µm . A typical result is shown in

Fig. 4-19. Repeated measurements are taken as the aperture position is varied; low

points are due to ﬂuctuations in chamber pressure when the feedthrough is manipu-

lated. Aperture position is measured by the CCD pixel number corresponding to the

maximum intensity in an image of the oven blackbody radiation passing through the

aperture.

78

cavity

base plate

mirror mount 

pencil

aperture

atom beam
path

motorized rotary stage

Figure 4-17: Top view of aperture assembly including motorized rotary stage, mirror
mount for angular adjustments, tapering “pencil”, and ﬁnal aperture in relation to
optical cavity. Not shown: X-Y translation stages attached to rotation stage.

4.3.5 Atom density modulator

The density, peak velocity, and velocity compression of a supersonic beam are all

functions of the oven current (i.e. temperature) and the amount of barium remaining

in the oven. During our experiment, we would like to vary the density only. Therefore

the oven current alone cannot be used to modulate density in the cavity, as it was for

the original microlaser experiment [8] or some recent experiments [84]

We have introduced a variable beam density modulator which intercepts the

atomic beam between the oven and cavity and prevents some or all of the atoms from

entering the cavity. The modulator consists of a piece of sheet aluminum attached

to a motorized linear feedthrough (Huntington L-2251-2) mounted at the 6-way cross

between oven and cavity. This is shown in Fig. 4-20. The aluminum piece was ini-

tially cut in a wedge shape in order to give a longer modulation range as it is moved

vertically. This was later found to be unnecessary as suﬃciently high resolution was

obtained with a ﬂat piece of aluminum. The modulator is located 21 cm from the

oven; the cavity is 42 cm from the oven.

The linear feedthrough has a lead of 0.05” per revolution. The stepper motor

79

final aperture

mirror faces

pencil

collimated beam

cavity axis

cavity mode

Figure 4-18: Close-up of tip of aperture assembly and cavity. Atomic beam is colli-
mated by aperture slit and passes through the center of the cavity mode.

80

PMT cts

1750
1500
1250
1000
750
500
250

80

85

90

95

pixel

Figure 4-19: Microlaser output for microlaser for constant density in initial threshold
region, as a function of aperture position in vertical direction. 1 pixel corresponds to
about 4.5 µm.

turns one revolution per 200 steps, giving a linear resolution of 6.35µm per step.

Higher resolution is possible via microstepping. Full linear travel is 2”.

The stepper motor is controlled by an Intelligent Motions Systems Panther LI2

(aka Huntington MLC-11) Driver. This driver was found to create a great deal of

electromagnetic interference in the laboratory, which was reduced using a set of opto-

isolators and line ﬁlters. The driver is controlled by a PC via a standard RS232 serial

connection. The driver is equipped with 3 logic-level auxiliary outputs which were

used to control other experimental parameters (described in section 4.11.1).

The cavity ﬂuorescence signal as a function of modulator position is shown in

Fig. 4-21

4.4 Laser systems, locking, and stabilization

4.4.1 Laser equipment

Two tunable lasers were used in the microlaser experiments. To provide the 791nm mi-

crolaser pump beam and cavity probe, we used a Coherent 899-21 Titanium-Sapphire

ring laser pumped by an Innova 310 argon ion laser operating at 8W in multiline vis-

ible mode.

81

h
g
u
o
r
h
t
d
e
e
f
 
r
a
e
n
i
l
 
d
e
z
i
r
o
t
o
m

 
1
5
2
2
-
L
 
n
o
t
g
n
i
t
n
u
H

atomic beam

Figure 4-20: Atomic beam density modulator

82

fluor, cpms

5000

4000

3000

2000

1000

1400 1450 1500 1550 1600 1650 1700

Blocker

Figure 4-21: Beam density (ﬂuorescence CCD counts per ms) as a function of beam
modulator position; 1 step = 6.35 µm.

A Coherent 699-21 dye laser tuned to the 553 nm 1S0 ↔

1P1 transition was used

to monitor atomic density in the cavity and measure the atomic velocity distribution.

The dye used in this laser was Rhodamine 110. The laser was pumped by an 8W

multiline visible beam from a Coherent Innova 200 Argon ion laser.

4.4.2 Frequency stabilization of 791 nm beam by Doppler-

free FM spectroscopy

Frequency locking of the Ti:Sapphire laser to the 1S0 ↔
a standard FM modulation technique. This locking system is described in detail in

3P1 transition was done by

[83].

An evacuated stainless-steel cylindrical cell containing about 2g barium is heated

to 600◦ C by external heating elements to produce a barium vapor. Pump and probe

laser beams pass through the cell from opposite directions, through two glass win-

dows. The probe beam ﬁrst passes through an electro-optic phase modulator (EOM)

83

 

Figure 4-22: Lamb dip used to lock Ti:Sapphire laser to 791 nm 1S0 ↔

3P1 transition.

driven at 24.6 MHz. After passing through the cell the probe beam is incident on a

photodiode (Thorlabs DET110). The signal is ampliﬁed and demodulated via mixing

with the 24.6 MHz local oscillator signal in a double-balanced mixer (Minicircuits).

The relative phase of the two inputs to the mixer is adjusted by varying the mod-

ulation frequency and the lengths of BNC cables to produce a maximum dispersion

signal, shown in 4-23. The dispersion signal is ampliﬁed and shifted to remove any

DC oﬀset from the mixer. It has a zero crossing at the peak of the Lamb dip (atom

resonance). To lock the laser to the zero crossing, the dispersion signal is fed back to

to Ti:Sapphire laser as an error signal in place of the signal from the reference cavity.

The linewidth of the lock is estimated as approximately 300 kHz [83].

4.4.3 Locking of 553 nm beam to atomic beam

The 699-21 dye laser was locked to the 1S0 ↔
dip technique. After reﬂection through a beamsplitter, a strong 553 nm pump laser

1P1 transition via a diﬀerent Lamb

beam is incident on a barium cell heated to 490 C. The transmission through the cell

is apertured then retroreﬂected back into the cell, overlapped by the original beam.

The reﬂected beam forms the probe, which is detected by a photodiode (Thorlabs

DET110) after the beamsplitter. The resulting absorption signal shows a Lamb dip

84

 

Figure 4-23: Dispersion signal used for locking of Ti:Sapphire laser to 1S0 ↔
transition at 791 nm.

3P1

(Fig. 4-24).

The laser locking system consists of an integrating ampliﬁer and summing ampli-

ﬁer. A local oscillator at about 300 Hz frequency, 100 mV peak to peak amplitude

dithers the frequency of the dye laser through the external horizontal input of the

laser control box. The photodiode signal and local oscillator are connected to a lock-

in ampliﬁer. After adjusting the phase, the output signal is of dispersion type, with

zero crossing at the peak of the Lamb dip. This signal is fed to an integrating ampli-

ﬁer, which controls the DC oﬀset of the laser external input. The resulting lock stays

within approximately 2 MHz of resonance. This is much smaller than the 19 MHz

natural linewidth of the transition and was judged to be adequate.

4.4.4

Intensity and position stabilization

Both the 791nm and 553nm lasers experience some short-term and long-term intensity

ﬂuctuations. The dye laser has considerable (

20%) noise in the kHz range and the

average intensity decreases gradually over hours as the dye decays. The Ti:Sapphire

laser has little short-term noise but does have slow intensity ﬂuctuations, most likely

due to pump beam wander.

∼

85

10

5

e
g
a
t
l
o
v
D
P

- 1.5 - 1 - 0.5 0

0.5

1

1.5

Detuning, GHz

Figure 4-24: Lamb dip signal used for dye laser locking to the 553 nm 1S0 ↔
transition

1P1

v
a
c
u
u
m

 
l
i
n
e

mirror

heater

Ba cell

photodiode

 BS

aperture

Figure 4-25: 553 nm Lamb dip setup for 699 dye laser locking.

5
5
3
 
n
m
 
b
e
a
m

86

+1

-1

M

from laser

lens

AOM 1

AOM 2

fiber coupling

M

to experiment

Figure 4-26: Laser intensity and position stabilization system for 791 nm and 553 nm
beams

Pump beam wander, thermal eﬀects, daily power peaking, and other eﬀects cause

substantial variations in laser beam direction from day to day and within single days.

Often these eﬀects are corrected for by aligning a laser beam through two adjustable

irises. However, since many aspects of the microlaser experiment require very precise

beam positions (micron scale) and angles (milliradian scale), irises do not provide

adequate repeatability.

To reduce laser intensity noise and stabilize long-term power, and to stabilize laser

positions, we have developed a laser stabilization system. Acousto-optic modulators

(AOMs) are used to cancel intensity ﬂuctuations. Coupling through single-mode

optical ﬁbers allows very consistent optical alignment of beams with respect to the

setup.

The intensity stabilization system uses a photodiode and integrating ampliﬁer to

provide feedback through an AOM VIDEO signal. A photodiode connected to a

variable-termination, transconductance ampliﬁer monitors the laser power after the

single mode ﬁber as shown in Fig.4-26. The photodiode signal VP D is compared with

87

Figure 4-27: Circuit diagram for intensity stabilization system

88

a target voltage VT and the diﬀerence is passed to an integrating ampliﬁer, the output

of which is connected to the AOM VIDEO input (amplitude modulation). The output

voltage range is trimmed by potentiometers to correspond to a range from minimum

to maximum AOM transmission.

Polarization maintaining (PM) single-mode ﬁbers are used to stabilize the position

of the 791 pump beam and the 553nm probe laser beams. We use 1m long Newport

SP-V ﬁber for the 791nm beam and a 5m Newport SP-? ﬁber for the 553nm beam.

A schematic is shown in Fig. 4-26.

4.5 Pump beam

The pump beam is supplied by the FM-locked Ti:Sapphire laser. The problem of how

to pump the atoms correctly proved to be more complicated than expected, and led

to the rediscovery of a method for inverting atoms by a defocused laser beam.

The pump beam intersection with the atomic beam must be suﬃciently small

that upper state spontaneous decay does not signiﬁcantly aﬀect the ﬁnal degree of

inversion. For the same reason, the pump beam spot must be placed close to the

cavity mode, but without overlap.

Other critical parameters include the angle between the pump beam and atom

beam direction (ideally exactly 90 degrees), total pump power, location of pump

focus, uniformity of the pump beam intensity over the width of the atomic beam, and

laser frequency jitter about the atom resonance.

4.5.1 Optical setup

As described in Sec.X the pump beam is coupled through a single-mode polarization-

maintaining (PM) ﬁber for intensity and position stabilization. The emerging beam

is collimated by an aspheric lens and passes through a beam steering apparatus to

raise the beam height above the vacuum chamber.

The pump beam steering apparatus is illustrated in Fig. 4-28.

It consists of

mirrors and a lens mounted on translation stages such that one stage controls the

89

dichroic BS

beam reflected down
into cavity

M

cyl. lens
f=450 mm

M

791 nm beam from fiber coupling

M

pump focus translator

pump position translator

Figure 4-28: Pump beam optical setup. Optics are ﬁxed on two small rectangu-
lar breadboards attached to separate translation stages to control pump focus and
translation independently.

pump beam focus and one controls the pump beam position (in the z direction),

nearly independently.

The lens is a single element, BK7 plano-cylindrical lens with focal length 400? mm.

Tests using the CCD camera as a beam analyzer showed that a nearly diﬀraction-

limited spot size of 35 µm could be achieved at the focus.

The pump beam is reﬂected down into the cavity by an 2” diameter, 45-degree-

angled dichroic beamsplitter which has reﬂectivity approximately 90% at 791 nm and

10% at 553 nm. A dichroic beamsplitter is used instead of a mirror in order to allow

imaging of 553 nm ﬂuorescence from above the beam splitter. In addition, the weak

791 nm transmitted beam can be used to analyze the focus and beam quality of the

pump.

The window on the top of the chamber is an anti-reﬂection coated glass disc held

in place by a custom metal ﬂange and Viton O-rings.

A coil-generated magnetic ﬁeld of approximately 50 gauss parallel to the direction

90

of pump polarization (perpendicular to the cavity axis) splits the m-states by about

50 MHz and ensures that only transitions between sublevels m = 0 and m = 0 occur.

4.5.2 Pump beam parameters

Here we describe the optimization of the pump beam parameters in more detail.

Pump beam focus

The pump focusing lens is placed approximately one focal length away from the cavity.

To ﬁnd the focus more precisely, we overlap the 791 nm pump with a resonant 553 nm

probe beam. With the imaging system (Sec. 4.6) in the top viewing conﬁguration, we

take pictures of the ﬂuorescence of atoms in the probe ﬁeld. By measuring the width

of the ﬂuorescence spot as a function of the pump focus translation stage micrometer,

we can ﬁnd the focus of the 553 nm beam. However, this is in general displaced from

the 791 nm focus due to lens dispersion and diﬀerent laser beam divergences of the

beam before entering the pump beam setup. To address this problem we used the

CCD camera, without lenses, as a laser beam analyzer for the 791 nm and 553 nm

beams transmitted by the dichroic beamsplitter. The CCD position was positioned

the same distance from the beamsplitter as the cavity is from the beamsplitter. The

camera was moved by a translation stage to locate the positions of the 553 nm and

791 nm beam foci. This gave the displacements of the two beam waists, typically

about 1 cm apart. The pump focus was then adjusted by this amount to place the

791 nm focus as close as possible to the atoms in the cavity.

This procedure was not perfect: as described in Sec. 4.5.5, signiﬁcant pump defo-

cus was found to occur.

Pump position

Pump position can be monitored by a number of methods involving the 553 nm tran-

sition and the imaging system. However, the most eﬀective methods is to monitor the

microlaser output power as a function of pump position. When the pump is placed

91

downstream of the cavity mode, no emission is seen. For pump beam overlapping the

mode, a signal with unequal traveling-wave peak heights is usually observed. The rea-

son for the unequal traveling-wave peaks is not clear. For pump beam upstream of the

cavity mode, a signal is observed that is nearly ﬂat, with a small slope corresponding

to increasing atomic decay with pump-mode distance.

In our experiments we aim for about 100 µm separation between the pump ﬁeld

and cavity mode. At this distance, which is admittedly somewhat arbitrary, atom

decay between pump and mode is quite small, < 10%.

Pump angle

To minimize Doppler broadening it is important for the pump beam to be as close as

possible to perpendicular to the atomic beam direction. Two methods for ensuring

this condition were explored. First, we overlapped a 553 nm probe beam over the 791

nm pump as closely as possible, and blocked the 791 nm beam. Then we measured

the linewidth of the 791 nm ﬂuorescence as the dye laser was scanned in frequency,

and repeated this process as the angle between laser and atom beam was varied.

The linewidth increased linearly with any angular deviation from a right angle. This

technique was very time-consuming and gave a pump beam perpendicular to the atom

beam only to the accuracy that the 791 nm and 553 nm beams were parallel in the

cavity. The second technique was to monitor the microlaser output for a constant

atom density a few times over threshold, while the frequency of the 791 nm pump laser

was varied over a 50 MHz range via the external input of the Ti:Sapphire laser. In this

manner, it could be determined if the microlaser power was maximized for positive

or negative detunings relative to the atom frequency (i.e. the atoms experienced a

blueshifted or redshifted pump ﬁeld). The pump angle was adjusted until the the

microlaser power was maximum with the laser on exact resonance.

92

4.5.3 Shelving experiment

In order to test the eﬃciency of the pump process, we perform a “shelving” experiment

as follows.

A 553 nm probe beam is aligned with the 791 nm probe which had been matched

with the T EM00 mode of the cavity. Therefore the 553 nm probe ﬁeld is close to

centered on the cavity mode (the beam size may be diﬀerent, but it will be close to

the focus since the 553 nm probe passes through the same achromatic lens). Using

the CCD camera, we measure the ﬂuorescence from the atoms in the cavity with and

without the pump beam. Since the ﬂuorescence is a measure of the ground state

population, the ratio between the ﬂuorescence intensities with and without the pump

beam is equal to the average upper state population. If the pump beam were perfectly

eﬃcient, no ﬂuorescence at 553 nm would be seen, because all atoms are in the upper
state of the 1S0 ↔

3P1 transition.

Shelving ratios as low as 10% (i.e. 90% of atoms in the upper state) have been

measured.

4.5.4 Pump power dependence of inversion

When the ﬁrst shelving data was collected, a puzzle presented itself. Atoms interact

with the pump beam for a certain time dependiing on their velocity v,

where wpump is the waist of the pump beam, assumed to be Gaussian. The excited-

state probability for a given atom after leaving the pump beam is expected to be

tpump =

√π wpump
v

e = sin2
P (1)

ΩRtpump
2

(cid:18)

(cid:19)

Averaging over atom velocity distribution f (v) gives

Pe =

0
Z

∞

sin2

ΩR√πwpump
2v

 

!

f (v) dv

93

(4.11)

(4.12)

(4.13)

fluor ratio

1

0.8

0.6

0.4

0.2

1

2

3

4

5

6

7

8

Pump power, µW

Figure 4-29: Ground state amplitude of atoms, measured by 553 nm ﬂuorescence:
monotonic dependence on pump power. Crosses (
): with-
out B ﬁeld.

): with B ﬁeld. Circles(

×

◦

We expect to observe an oscillatory excited state probability damped by the ve-

locity distributions. In the limit of strong ﬁeld the excited state population should

be 1/2.

Oscillations as a function of pump power were initially not observed. Instead, we

observed the dependence drawn in Fig. 4-29. The excited state population increases

monotonically to approximately 80% and does not approach 1/2.

4.5.5 Adiabatic inversion by defocused pump beam

The unusual behavior was explained by the following eﬀect. Suppose there is some

distance y between the atoms and the focus (minimum waist) of the pump beam –

for example, the beam comes to a focus before reaching the atoms. Then the atoms

pass through a laser beam which is diverging in the direction of their propagation.

As a result, the angle between atom velocity v and the wave vector of the pump ﬁeld

k varies approximately linearly with position, causing a Doppler-induced frequency

chirp through resonance. This leads to an adiabatic inversion process as the atom’s

Bloch vector precesses about a relatively slowly varying “torque” which tends to align

the atomic Bloch vectors with the inversion axis. A quantitative analysis follows.

94

Without loss of generality we restrict our attention to the x

y plane containing

−

both the atomic beam and Gaussian beam axis. The phase function of a Gaussian

beam depicted in Fig. 4-30 is (see e.g. [85])

Φ(x, y) =

ky + tan−1(y/y0)

−

kx2
2R(y)

−

where k is the wave vector, y0 = πw2

p/λ is the Rayleigh range and the wavefront

radius of curvature

R(y) = y

1 +

 

y2
0
y2 !

The angle θ between the Gaussian beam axis and the normal to the phase front

can be found via θ = tan−1(dy/dx) where dy/dx is the slope of the wavefront (i.e.

line of constant Φ):

θ = tan−1






−

y
|
|
k + x2
0) + y0

2

y2−y2
0
y2+y2
0

(y2 + y2

x




The sign of the angle is chosen to be positive when the x component of the vector

normal to the phase front is opposite the direction of the atom velocity. For simplicity,

we consider only the case of atomic velocity perpendicular to Gaussian beam axis.

The equation for θ simpliﬁes assuming k

y0 and x

y, both valid easily in our

≫

≪

case:

The Gaussian waist of the beam as a function of y is given by

An atom traversing the pump beam at vertical position y experiences, as a function

of position, the following Doppler shift:

θ

≈ −

y
|
|
y2 + y2
0

x

w(y) = wp

1 + (y/y0)2

q

∆d(x) = kv sin θ

kv

y
|
|
y2 + y2
0

x

≈

95

(4.14)

(4.15)

(4.16)

(4.17)

(4.18)

(4.19)

 

x 

Atoms sent through pump 

mode waist 

 

Atoms sent away from pump 

mode waist  

phase front 

Figure 4-30: Atoms displaced from pump beam focus experience frequency chirp and
adiabatic inversion.

Gaussian Pump 

beam 

y 

 

96

q
The excited state may decay back to the ground state or to a metastable D state.

The decay rate to the ground state is Γg = 50kHz and to the metastable state is

Γm = 70kHz. The optical Bloch equations describing the pumping process including

˙ρee(t) =

R2(t)

Γg + Γm)ρee(t)

Ω0(t)
2

−

−

˙ρgg(t) = +

R2(t)

Γgρee(t)

Ω0(t)
2

−

˙ρmm(t) = +Γmρee(t)

˙R2(t) = ∆(t)R1(t) + Ω0(t)(ρee(t)

ρgg(t))

˙R1(t) =

∆(t)R2(t)

R1(t)

−

−

Γg
2

−

Γg
2

−

R2(t)

loss are

bilities;

where ρee, ρgg, and ρmm are excited state, ground state, and metastable state proba-

and ∆ is the atom-laser detuning

R1(t)

ρeg + ρge

≡

R2(t)

i(ρge −

≡

ρeg)

∆ = ωl + ∆d −

ωa

(4.20)

(4.21)

(4.22)

(4.23)

(4.24)

(4.25)

(4.26)

(4.27)

where ωl and ωa are laser frequency and atom resonance frequency. The on-resonant

Rabi frequency is given by

Ω0(t) = Ω0 exp[

(vt/w(y))2] =

Γg exp[

(vt/w(y))2]

(4.28)

−

I
2Is

s

−

where Ω0 and I are the Rabi frequency and on-axis laser intensity and Is is the

saturation intensity

Is =

πhc
3λ3 Γg ≈

13µW/cm2

(4.29)

Fig. 4-31 shows the results of numerical integration of the Bloch equations for diﬀerent

displacements y. For y = 3y0 the Rabi oscillations are almost completely absent, and

97

 

1

0.8

0.6

0.4

0.2

g
g

U

y = 0 

y = y0 

y = 3y0 

2

6

8

4

i0

i
s

Figure 4-31: Results of adiabatic inversion pump simulations: ﬁnal ground state
probabilities as functions of pump power.

inversion occurs almost independently of pump intensity for I > 2Is.

98

fluor ratio

1

0.8

0.6

0.4

0.2

1

2

3

4

5

6

p/pπ/2

q

Figure 4-32: Ground state probability as a function of
power and pπ/2 ≈

1.8µW.

q

p/pπ/2, where p is the pump

If adiabatic inversion is responsible for the pump power dependence, we should be

able to observe Rabi oscillations by focusing the pump beam closer to the atoms (i.e.

decrease y). The results are shown in Fig. 4-32. Note that peaks and valleys of the

oscillations occur at integer values of

p/pπ/2. The curve is not asymptotic to 1/2

for large pump ﬁelds; due to uncertainties in the experiment this data may reﬂect a

q

intermediate state between pure Rabi oscillation and adiabatic inversion.

A quantitative comparison between experiment and theory will be performed in a

future study. It has come to our attention that adiabatic following due to a diverging

laser beam was previously observed in [86] and [87]. These experiments involve atoms

with more complex level structures than the present one.

99

lens 2

filter

lens 1

XY translator

objective

CCD

cavity

Z translator

200 mm

100 mm

195mm

Figure 4-33: Schematic of imaging system

A cavity imaging microscope was developed to perform several functions, described

4.6 Imaging system

below and in following sections.

4.6.1 Setup

The optical design of the imaging system is shown in Fig. 4-33. It can be thought of as

a relay lens system combined with a CCD microscope. A 2:1 lens system consisting of

two 1” achromatic doublets creates a real image of the cavity. A microscope objective

relays the image to a CCD camera. The CCD is positioned at the ﬁeld focus plane

of the objective. The use of microscope objectives gives well-corrected imaging and

allows the magniﬁcation of the system to be varied easily without realignment. In

our experiments we use the 5x objective for the side imaging and 10x for the top

imaging (see below for descriptions of the two imaging conﬁgurations); the 10x and

20x objectives can also be used in the side imaging conﬁguration when the position

of the ﬁnal collimation aperture needs to be determined precisely.

100

mirror

pump BS

top viewing

side viewing

Figure 4-34: Side and top viewing imaging system conﬁgurations. Lab jacks and
supporting structures not shown.

The achromatic lenses are translatable in 3 directions by translation stages for

centering and focusing of the image. The optics, translators, and camera are mounted

on an aluminum plate which is ﬁxed to a laboratory jack.

For the side imaging conﬁguration, a 1 inch diameter interference ﬁlter (Oriel

53890, 550

5 nm) is placed between the two achromats to block transmission of the

±

oven’s blackbody radiation. For the top imaging conﬁguration, a color glass ﬁlter is

used to eliminate pump beam reﬂection and scatter into the imaging system. This

ﬁlter has transmission T > 95% at 553 nm and T <0.1% at 791 nm.

Background light is blocked by a plastic C-mount coupled tube connecting the

CCD camera and objective lens, and a sliding cardboard tube covering the optical

path between the objective and relay lens.

The CCD used is a Roper Scientiﬁc / Photometrics Sensys 400. This camera uses

a thermoelectrically cooled, 1/2-inch format, 768

512 pixel Kodak KAF 0400 CCD.

×

101

conﬁguration lens 1 f.l.

side view
top view

20 cm
45 cm

lens 2 f.l.
10 cm
10 cm

objective (typ.) magniﬁcation

5x
10x

2.5
2.2

Table 4.1: Optics for two imaging system conﬁgurations

Readout digitization is 12 bits.

The camera can be used in two conﬁgurations (Fig. 4-34. In the ﬁrst conﬁguration,

the camera views the cavity from the side, antiparallel to the atomic beam direction.

In this view the aperture can be imaged and ﬂuorescence of the atom beam appears as

a small spot. In the second conﬁguration the camera images the cavity from above. A

mirror is mounted at a 45-degree angle above the top window of the vacuum chamber,

bending the optical path so that the optics and CCD can be mounted horizontally,

above the optical path for the side-viewing conﬁguration. The optics used for the two

conﬁgurations is summarized in Table 4.1. The CCD mount is designed so that the

CCD can be swapped between the two conﬁgurations easily.

4.6.2 Uses of imaging system

Atom-cavity alignment

To achieve the most uniform atom-cavity coupling possible, it is essential that the

atomic beam be centered on the cavity mode. This can be done by adjusting the

ﬁnal aperture vertical translation stage to maximize output power. However, the

miniature translation stage is manipulated via a ﬂexible coupling through an Ultra-

torr vacuum ﬁtting and exhibits considerable backlash (hysteresis). In addition, the

microlaser output power is not a highly sensitive measure of the centering of the

aperture on the mode, especially when the photon number stabilization eﬀect is taken

into account. Therefore is it useful to be able to monitor the aperture position

accurately. This can be done by focusing the imaging system on the oven’s blackbody

radiation emitted from the aperture. A computer program monitors the microlaser

output and blackbody peak vertical position as the latter is varied manually.

102

Figure 4-35: Atom ﬂuorescence imaged by microscope in side imaging conﬁguration.
Similar but smaller images were used to measure atomic density during the experi-
ment.

Density calibration

The density of atoms in the atomic beam, and therefore the average number of atoms

in the cavity, can be monitored quantitatively by detecting ﬂuorescence of atoms in

the cavity. Details of this experiment are given in Sec. 4.9.

In addition to density calibration, the imaging system can be used to monitor the

condition of the ﬁnal atom beam aperture. Over time this 25 µm aperture becomes

coated and eventually clogged with barium. By monitoring the ﬂuorescence and

blackbody radiation, we can tell when the aperture needs to be removed and cleaned.

Characterization of laser and atomic beam

In order to calibrate density, focus the pump and probe beams, and position the

pump beam correctly, it is necessary to determine the position and focus properties

of the 791nm and 553nm laser beams. The imaging system can be used to measure

the focus and position of these beams.

Shelving measurement

The imaging system was used to detect 553 nm ﬂuorescence in the cavity while the

791 nm pump beam was present. This allows us to measure the degree of excitation

103

Figure 4-36: Microscope image of center of cavity taken from side imaging conﬁgu-
ration. Left and right: cavity mirrors. Center: ﬁnal collimating aperture. For this
image, cavity was illuminated by ﬂashlight and oven blackbody radiation was used
to image aperture slit.

due to the pump beam.

4.7 Detectors

4.7.1 Avalanche photodiodes

A photon-counting, thermoelectrically-cooled avalanche photodiode (EG&G 10902TC)

is used to detect the 553 nm ﬂuorescence in the cavity when measuring beam velocity

distributions. An uncooled APD (EG&G 10902) detects the cavity transmission for

cavity locking and ﬁnesse measurements.

4.7.2 Photomultiplier tubes

A photomultiplier tube was used to detect microlaser emission. Our PMT is a Hama-

matsu R943-2. It is cooled to less than

20◦ C by a thermoelectric cooler (Paciﬁc

−
Instruments 3470). At this temperature it has a dark count rate of about 20 cps. The

bias voltage used was -1500V. The signal from the PMT is terminated into 50 Ω and

discriminated/counted by a Stanford Research SR400 photon counter.

104

Figure 4-37: Photo of the microlaser experiment. Atom beam oven is attached to top
ﬂange of vertical cylinder portion of chamber at right. Chamber containing cavity is
at center.

The PMT count rate was veriﬁed to be linear for the count rate used in the

experiment. The saturation count rate was not measured and may be signiﬁcantly

higher than the damage threshold of the PMT.

4.8 Vacuum system

A vacuum chamber houses the cavity and atomic beam oven. It consists of two large

cylindrical sections, the ﬁrst containing the oven and the second containing the cavity.

The two chambers are connected by ﬂexible welded bellows couplings. The atomic

beam passes through the ﬂexible segment and into a 6-way cross before entering the

cavity chamber. A diagram is shown in Fig.4-38.

All ports are faced with Conﬂat-type ﬂanges. OFHC copper and Viton gaskets

are used to create seals. The oven chamber is connected to a diﬀusion pump (Varian

105

atom beam modulator

pump beam

cavity

beam oven

vacuum gauges

atom beam path

diffusion
pump

flexible bellows

beam blocker

Figure 4-38: Diagram of major chamber components showing atom beam path.

VHS-4) with pumping speed 1000 l/s. A pneumatically driven 8” gate valve (MDC

GV-50000) separates the oven from the chamber. An interlock circuit ensures that

the diﬀusion pump can only be operated when the chamber and foreline pressures

(measured by two thermocouple gauges) are suﬃciently low, and the diﬀusion pump

cooling water is ﬂowing. The foreline of the diﬀusion pump is connected by hoses to

a roughing pump located in an adjoining room to minimize vibrations and noise. The

foreline pressure was about 5 millitorr, measured by a thermocouple vacuum gauge.

A tubulated ion gauge measures residual pressure in the chamber, which during the

experiment is typically

10−6 Torr.

∼

The vacuum system was fabricated by MDC Vacuum Products, and several mod-

iﬁcations were performed by Sharon Vacuum and the MIT Central Machine Shop.

From time to time it was necessary to bring to chamber to atmospheric pressure,

in order to change the oven, reload the barium cell, etc. In these cases we ﬁlled the

chamber with argon to avoid oxidizing the barium in the chamber. This also avoids

106

Figure 4-39: Gaussian mode and equivalent tophat proﬁle

introducing water vapor into the chamber which is diﬃcult to pump out.

4.9 Density calibration

We now describe the experiments and calculations used to determine the number

of atoms present in the cavity. First, let us clarify the deﬁnition of the intracavity

atom number N. Since the cavity mode is Gaussian, it is not clear where a boundary

between the inside and outside of the mode can be drawn. We deﬁne N to be the

average number of atoms within the boundary of a top-hat distribution (Fig. 4-39)

with height equal to that of the Gaussian and with equal area (i.e. total interaction).

This condition is met for a top hat of width wtophat = √πwm.

Note that we assume that each atom in the atom beam passes through the mode at

some time; this is true because the atomic beam size in the direction perpendicular to

the cavity axis is smaller than the mode waist. By contrast, in the original microlaser

experiment the atomic beam was 300 µm in diameter, much larger than the mode.

To measure the atomic density we overlap a 553 nm probe beam onto a 791 nm

beam which has been focused to match as close as possible only the T EM00 mode

of the cavity. The 553 nm beam then intersects the atomic beam perpendicularly
except for any cavity tilt that is introduced. The resulting 1S0 ↔
collected by the camera in the side viewing conﬁguration.

1P1 ﬂuorescence is

107

To camera

553 nm probe beam 

interaction region

atom beam

Figure 4-40: density-measurement-setup

The total number of ﬂuorescence photons incident on the CCD is given by

np = ηopticsFΩW FδTex

(4.30)

where ηoptics is the transmission of the optical system including chamber window,

FΩ is the fraction of scattered light which travels in the direction of the collection

optics, and W is the total scattering rate. Tex is the exposure time. Fδ < 1 is a

detuning factor reﬂecting the Doppler broadening due to the tilted cavity, and is

approximately equal to the ratio between the homogeneous and inhomogeneous atom

linewidths.

The transmission ηoptics is the product of the transmission of the chamber window,

two lenses, 553 nm interference ﬁlter, and microscope objective. This was measured

by passing a laser beam through these optics:

ηoptics ≈

22%

(4.31)

The parameter FΩ involves the solid angle of collection and the dipole radiation

pattern of the atoms. The polarization of the probe ﬁeld is set to be vertical so that

108

the camera collects light scattered at the optical 90 degrees from the dipole direction.

The fraction of power emitted into the solid angle subtended by the camera optics is

FΩ =

optics sin2(θ)dΩ
all sin2(θ)dΩ ≈
R

Ωoptics
π
0 dθ sin3(θ)

=

3
2

Ωoptics
4π

(4.32)

2π

R

where we have assumed θ does not deviate signiﬁcantly from π/2 over the solid angle

R

of the collection optics. This result simply means that the ﬂuorescence detected at

90 degrees from the dipole direction is 50% than that expected from an isotropic

radiation pattern.

source

The solid angle of the optics is that of a 1” lens located 20 cm from the ﬂuorescence

Ωoptics ≈

π(0.5)(2.54cm)2
(20cm)2

= 0.019sr

The total rate of photon scattering from the source is

W =

drρ(r)R(r)

Z

(4.33)

(4.34)

where ρ(r) is the atom density and R(r) is the scattering rate per atom at point r:

R(r) =

Γa
2

I(x)/Isat
1 + I(x)/Isat

=

Γa
2

(p/ps) exp(
−
1 + (p/ps) exp(

2(x/wp)2)

2(x/wp)2)

(4.35)

−
19MHz is the natural linewidth of the 1S0 ↔

Here Γa ≈
mode waist of the probe beam; Is is the saturation intensity; ps is the power of the

1P1 transition; wp is the

553 nm probe, measured outside the chamber, such that the laser intensity center of

the focused probe beam is Is. We then have

∞

dxλ′ Γa
2

(p/ps) exp(
−
1 + (p/ps) exp(

2(x/wp)2)

2(x/wp)2)

W =

−∞

Z

−

(4.36)

where λ′ =

dy dz ρ is the constant linear density along the atom beam direction.

The parameter ps is measured by using the camera in the top viewing conﬁgu-

R

ration and taking exposures for diﬀerent probe powers. The peak of the measured

ﬂuorescence distribution corresponds to the most intense (axial) part of the probe

109

ﬂuor. cts

20

15

10

5

10

20

30

40

50

60

probe power, µW

Figure 4-41: Saturation curve of peak of 553 nm ﬂuorescence: ﬂuorescence counts vs.
input probe power, µW.

beam; by plotting this against the probe power and ﬁtting a saturation curve we

obtain a saturation power (Fig. 4-41) of

ps = 11.2µW

(4.37)

The probe beam waist is measured with the same camera data by imaging the

ﬂuorescence distribution directly (Fig. 4-42). After accounting for atom saturation

and camera defocus/aberration eﬀects we obtain

wp = 139µm.

(4.38)

The total integrated counts recorded on the CCD is given by

C = np ·

ηCCD/G

0.0625np

≈

(4.39)

where ηCCD ≈
facturer speciﬁcations, and the gain is G

≈
unit) at the camera’s gain index 3 setting.

0.35 is the CCD quantum eﬃciency at 553 nm according to manu-

5.6 electrons per ADU (analog-to-digital

110

ﬂuor. cts

15

12.5

10

7.5

5

2.5

25

50

75

100

125

150

Pixel number

Figure 4-42: 553 nm ﬂuorescence distribution from CCD. Fit includes saturation
eﬀects and optical aberration function.

The CCD exposure time was typically set in software to be 300 msec. However, it

was discovered (Fig. 4-43) that the total ﬂuorescence measured was not proportional

to the exposure time when those exposure times were small; this is probably due to

ﬁnite shutter opening and closing times. An extra factor was used to compensates

for this eﬀect: Tex = 142 ms for a set time of 300 ms.

The lineshape of the 553 nm transition was measured by varying the laser detuning

from the computer and recording the total ﬂuorescence. The resulting curve was ﬁt

accurately by a Lorentzian with FWHM of 34 MHz. The detuning correction factor

is then Fδ = 19MHz/34MHz = 0.559

Finally we calculate the intracavity atom number:

N = √πwmλ′

(4.40)

The ratio between CCD counts and atom number is most conveniently expressed

as the number of counts per millisecond of exposure time, per atom, with probe power

10 µW. We ﬁnd that N = 1 atom corresponds to 1.16 counts per ms on the CCD; 1

cpms corresponds to 0.862 intracavity atoms.

111

cpms
40
35
30
25
20
15
10
5

1000 2000 3000 4000 5000 6000 7000

T, ms

Figure 4-43: CCD counts per millisecond (cpms) for a constant atom density when
the exposure time T is varied. Drop-oﬀ for short exposures is probably due to opening
and closing times of mechanical shutter.

4.10 Photon number calibration

The PMT count rate nd as a function of cavity photon number n is

nd = n(

T
2(T + A + S)

)Γcη′

opticsηAOMηPMT

(4.41)

where T = 0.5

10−6, A = 0.2

10−6, and S = 3.0

10−6 are estimates of the

×

×

×

transmission, absorption, and scattering coeﬃcients of the cavity mirrors; the factor

of 2 accounts for the collection of light from only one side of cavity. Γc is the cavity

loss rate; ηAOM is the fraction of light switched by the AOM after the cavity into

the PMT (i.e. diﬀraction eﬃciency, about 70%); ηoptics is the transmission of optics

including the rear mirror surface, chamber window, several mirrors and lenses guiding

the beam to the PMT, and the PMT window. ηPMT is the quantum eﬃciency of the

PMT at 791 nm, about 12% according to manufacturer speciﬁcations.

Our estimate for the number of photons in the cavity is n = 0.16 per 103 counts

per second on the PMT, with no ﬁlter in front of the PMT.

Both the estimate for atom and photon number are subject to fairly large system-

atic error; each may have errors as large as a factor of 2.

112

4.11 Data acquisition and computer control

The experiment is controlled by a Gateway 200 MHz PC running Windows 95. The

sequencing and data collection routines are written in VPascal, the language used by

the camera control software, Digital Optics V++. The sequencing programs used in

this experiment can be found in Appendix C.

4.11.1 Experiment automation

Table 4.2 summarizes the computer automation of various devices. These are further

described and commented on below.

Device
SR400 photon counter
IMS atom beam mod. driver
Laser intensity mod. (791 nm pump)
Laser intensity mod. (553 nm probe)
Analog multiplexer (MUX)
Cavity lock disable or scan trigger
791nm probe beam AOM VT
AOM after cavity VT

Level
digital data
digital data
0-1 V
0-1 V

TTL

3

×
TTL
10V(on), 4V(oﬀ)
10V(on), 4V(oﬀ)

Control
PC serial port 2
PC serial port 2
SR400 PORT1 output
SR400 PORT2 output
IMS TTL OUT 1-3
MUX output 1
MUX output 2
MUX output 3

Table 4.2: Summary of computer automation setup

Laser intensity modulation

The two analog outputs of the SR400 photon counter are used to control the intensities

of the 553 nm probe and 791 nm pump. During the “oﬀ” states the target voltage is

set to -0.1 volt in order to ensure that the minimum intensity is reached.

Atom density modulation

The stepper motor driving the density modulator is controlled by the computer

through the serial port. The stepper rate was 400 steps per second. No microstepping

was necessary.

113

AOM switching

Two acousto-optic modulators required binary control: the 791 nm probe switching

between cavity locking and data collection, and the AOM deﬂecting the cavity emis-

sion to the g(2) setup during data collection. Both AOMs were controlled by TTL

signals from the stepper driver.

4.12 Cavity PZT control

The cavity frequency may be scanned through the microlaser resonance or locked onto

it. In some sense a scanning experiment is more general since it includes variation in

atom-cavity detuning. Other experiments require the laser to be kept on resonance

while other parameters are varied.

Cavity scanning

For cavity scanning, the PZT is simply driven by a

1 V ramp signal generated

≈

from an oscilloscope, which sweeps in ’AUTO’ mode or is triggered by a pulse from

additional circuit which outputs

the TTL output from the computer. To create bidirectional scans we designed an
V0|
oscilloscope or other ramp source. V0 is equal to half the peak-peak height of the

given an input voltage Vin(t) from the

Vin(t)

−

|

ramp signal. The scan and sample PMT signal is shown in Fig. 5-1.

The experimental sequence for cavity scanning experiments is the following:

1. Move atom density modulator for the desired density

2. Turn oﬀ the 791 nm pump beam,

3. Turn on the 553 nm probe, with power 10 µW

4. Measure atomic density by exposing the CCD in the side viewing conﬁguration

for a set time, usually 300 msec,

5. Turn oﬀ 553 nm probe and turn on 791 nm pump beam

114

cts

1000

800

600

400

200

-40

-20

0

20

40

MHz

Figure 4-44: Probe transmission spectrum for frequency calibration of PZT scans.
Sideband frequency shift from carrier is 24.67 MHz.

6. Trigger oscilloscope to drive cavity PZT with a bidirectional ramp of duration

about 4 seconds

7. Start photon counter to collect data from PMT during cavity scan

8. Download PMT count data to computer via serial connection

It was occasionally necessary to adjust the HV PZT oﬀset voltage manually to

compensate for a slow PZT drift which would otherwise cause the microlaser reso-

nances to drift out of the scan range. These adjustments were made between data

collection intervals so that the linearity of the PZT scans was preserved.

To calibrate the frequency of the scans we measured the cavity transmission of a

very low power probe beam with no atoms present; the result is shown in Fig. 4-44.

The background counts level, due primarily to pump scattering from cavity mirrors

and stray room light, is subtracted by computer.

Cavity locking

To maintain the cavity on resonance, we use the following cavity lock technique.

A probe beam from the Ti:Sapphire laser is upshifted 100 MHz and then down-

shifted about 113 MHz by a pair of AOMs. The frequency of the second AOM

115

Integrator 
 

100k 

1m F 

 

 

1M 

1M 

 

 
CA3140 
+ 
 

HV 

PZT 

 

100k 

Monitor 
DA 

Differential Amplifier 
 

100k 

100k 

Source 

5k 

 

 
CA3140 
+ 
 

100k 

- 15V 

Reference 
 

5k 

100k 

 

- 220V 

 

PD 

 

100k 

100k 

- 15V 

20k 

10k 

100k 

100k 

 

 

1M 

 
CA3140 
+ 
 

Monitor 
 

100 k 

 
CA3140 
+ 
 

650k 

650k 

50k 

Monitor 
Integrator 
 

20 k 

 

 
LF411 
+ 
 

TTL from 
Computer 
 

 

DG401 

20k 

Ram input 
 

Figure 4-45: Cavity locking circuit

adjusted via the input tuning voltage VT to match the peak of one of the microlaser
resonances, in our case the lower frequency resonance at ωa −
also used to switch the probe beam on and oﬀ.

kv0θ. The AOMs are

For cavity locking, a probe beam of about 1 µW is incident on the resonator. The

cavity transmission is focused onto an APD. A circuit compares the APD voltage

with a ﬁxed reference voltage adjusted to a value approximately one-third of the

peak signal height. The voltage diﬀerence is integrated and the result fed back to the

PZT control voltage. If no strong mechanical or acoustical disturbances occur, this

system can remain locked for more than 1 hour.

Experiments which involve cavity locking require us to switch between locking

and data collection. The cavity can be unlocked for a maximum of about 1 second

before the cavity drifts too far from resonance for lock to be regained. During cavity

non-lock, a TTL signal applied to the lock box causes the integrator to hold its value

by grounding its input.

116

-
-
-
-
-
Chapter 5

Results and Analysis

We describe the results of microlaser experiments with a high-density supersonic beam

and nearly uniform atom-cavity coupling.

Experiments were performed with the goal of answering the following questions:

(i) Does the theory of Chapter 2 apply to the microlaser with Neﬀ ∼
multiple thresholds occur, and if so, where? (iii) What are the time scales of the

1000? (ii) Do

transitions, and can hysteresis be observed?

5.1 Study of microlaser with variable detuning

We ﬁrst measured the microlaser output as a function of atom-cavity detuning by

applying a bidirectional ramp signal to the cavity PZT. The experiment sequence is

given in Section 4.12. The atom density modulator position was varied between 1350

and 1730 with a step size of 10, and 1450 to 1500 with a step size of 2 (c.f. Fig 4-20).

5.2 Cavity scanning data

Data for the detuning curves for a range of atom densities are shown in Figs. 5-5 to

5-24. The PMT data is folded back onto itself to show both results from the PZT

scan in both directions. The solid and dashed lines represent scans in the positive and

negative detuning directions, respectively. PMT counts are measured in time bins of

117

PZT ramp

PMT signal

Figure 5-1: Bidirectional PZT voltage scan shown with typical PMT data for a high
atom density. Horizontal range corresponds to 4 seconds.

time

→

0.01 seconds.

Eﬀective atom numbers are following the estimates given later in this chapter.

118

-40

-20

0

20

40

MHz

Figure 5-2: PMT counts vs. cavity-atom detuning. Fluorescence 48.5 cpms (Neﬀ =
10.7)

cts

70

60

50

40

30

20

10

cts

150

125

100

75

50

25

-40

-20

0

20

40

MHz

Figure 5-3: Fluorescence 60.9 cpms (Neﬀ = 13.4)

119

cts

700

600

500

400

300

200

100

cts

1750

1500

1250

1000

750

500

250

cts

6000

5000

4000

3000

2000

1000

-40

-20

0

20

40

MHz

Figure 5-4: Fluorescence 80.2 cpms (Neﬀ = 17.6)

-40

-20

0

20

40

MHz

Figure 5-5: Fluorescence 100 cpms (Neﬀ = 22)

-40

-20

0

20

40

MHz

Figure 5-6: Fluorescence 659.1 cpms (Neﬀ = 145)

120

cts

8000

6000

4000

2000

cts

8000

6000

4000

2000

cts

8000

6000

4000

2000

-40

-20

0

20

40

MHz

Figure 5-7: Fluorescence 950 cpms (Neﬀ = 209)

-40

-20

0

20

40

MHz

Figure 5-8: Fluorescence 1850 cpms (Neﬀ = 407)

-40

-20

0

20

40

MHz

Figure 5-9: Fluorescence 2393 cpms (Neﬀ = 526)

121

cts

8000

6000

4000

2000

cts

35000

30000

25000

20000

15000

10000

5000

cts

35000

30000

25000

20000

15000

10000

5000

-40

-20

0

20

40

MHz

Figure 5-10: Fluorescence 2748 cpms (Neﬀ = 605)

-40

-20

0

20

40

MHz

Figure 5-11: Fluorescence 2889 cpms (Neﬀ = 636). Second threshold is observed.

-40

-20

0

20

40

MHz

Figure 5-12: Fluorescence 2986 cpms (Neﬀ = 657)

122

cts

35000

30000

25000

20000

15000

10000

5000

cts

35000

30000

25000

20000

15000

10000

5000

cts

50000

40000

30000

20000

10000

-40

-20

0

20

40

MHz

Figure 5-13: Fluorescence 3014 cpms (Neﬀ = 663)

-40

-20

0

20

40

MHz

Figure 5-14: Fluorescence 3075 cpms (Neﬀ = 677)

-40

-20

0

20

40

MHz

Figure 5-15: Fluorescence 3252 cpms (Neﬀ = 715). Spikes are the ﬁrst signs of third
threshold.

123

cts

50000

40000

30000

20000

10000

-40

-20

0

20

40

MHz

Figure 5-16: Fluorescence 3432 cpms (Neﬀ = 755)

124

cts

60000

50000

40000

30000

20000

10000

cts

60000

50000

40000

30000

20000

10000

cts

60000

50000

40000

30000

20000

10000

-40

-20

0

20

40

MHz

Figure 5-17: Fluorescence 3556 cpms (Neﬀ = 782)

-40

-20

0

20

40

MHz

Figure 5-18: Fluorescence 3595 cpms (Neﬀ = 791)

-40

-20

0

20

40

MHz

Figure 5-19: Fluorescence 3628 cpms (Neﬀ = 798)

125

cts

60000

50000

40000

30000

20000

10000

cts

60000

50000

40000

30000

20000

10000

cts

60000

50000

40000

30000

20000

10000

-40

-20

0

20

40

MHz

Figure 5-20: Fluorescence 3690 cpms (Neﬀ = 812)

-40

-20

0

20

40

MHz

Figure 5-21: Fluorescence 3996 cpms (Neﬀ = 879)

-40

-20

0

20

40

MHz

Figure 5-22: Fluorescence 4008 cpms (Neﬀ = 882)

126

cts

60000

50000

40000

30000

20000

10000

cts

70000

60000

50000

40000

30000

20000

10000

-40

-20

0

20

40

MHz

Figure 5-23: Fluorescence 4585 cpms (Neﬀ = 1009)

-40

-20

0

20

40

MHz

Figure 5-24: Fluorescence 5140 cpms (Neﬀ = 1131)

127

As density is increased from zero, the two resonances broaden and increase in

amplitude. At about 3000 cpms (Fig. 5-11) a “spike” appears near the peak of each

resonance. We will show below that this is a transition to the second branch. With an

further increase in density to 3250 cpms (Fig. 5-15) a jump to another, third branch

appears.

Above second threshold, the positive and negative direction scans are in general

quite diﬀerent in shape, although they overlap over some intervals. Transitions in the

positive-detuning direction occur at equal or greater (more positive) detunings than

the corresponding transitions in the negative-detuning direction. This is as expected

from hysteresis behavior.

To measure the frequency splitting between the two traveling-wave peaks in the

microlaser, we found the frequency shift between the two maxima for each scan below

the second threshold; the average value was 27.1 MHz. The measured peak of the

velocity distribution was v0 = 815 m/s; therefore we infer the cavity tilt angle is

θ

13 mrad.

≈

5.2.1 Photon number vs. atom number

The detuning curve data was analyzed by computer to give, for a ﬁxed detuning, the

microlaser emission rate as a function of atomic density.

Data for center of the peaks ∆ =

13.5MHz is given in Fig. 5-25 in terms of

±

an estimated cavity photon number n and eﬀective atom number Neﬀ. The curve

is the result of the rate equation model of Chapter 2 with modiﬁcations for velocity

distribution, nonuniform coupling, and detuning eﬀects.

Calibrations for the atom density and photon number were adjusted to give the

best ﬁt between theory and experiment as follows.

The photon number calibration from Chapter 4 was n = 0.16 for every 103 cps

on the PMT, with no ﬁlters. With the OD 1.0 ﬁlter used in this experiment, this

becomes n = 1.6 for every 103 cps on the PMT. The experimental best ﬁt is with

n = 0.25

PMT counts per 0.01 second bin, or n = 2.5 for every 103 cps. The

×

experimentally derived calibration is 56% higher than the original estimate.

128

The estimate of atom number from Chapter 4 was N = 1.16 for every count

per millisecond (cpms) on the CCD. For the 300 msec exposures in this experiment,

the measured ﬂuorescence count rate is underestimated by a factor of 2.11 due to

the nonuniform exposure eﬀect (Fig. 4-43). Therefore the expected value is N = 0.55

atoms per cpms. The eﬀective atom number is Neﬀ = (0.80

0.20)N = 0.33 per cpms.

−

The experimental ﬁt gives Neﬀ = 0.22 per cpms, 33% lower than the estimate. This

ﬁtting procedure is justiﬁed by the large uncertainties in our estimates for absolute

photon and atom numbers.

Note that in the detuning curves, the positive-direction data and negative-direction

data are in most cases nearly mirror images of one another. This is expected from

the symmetry between the two traveling-wave components. We therefore choose to

display the photon number vs. atom number data in following way: Circles (

) rep-

◦

resent data from (i) positive-direction detuning scans with positive detunings and

(ii) negative-direction scans with negative detunings; crosses (

) give data from (iii)

×

positive-direction detuning scans with negative detunings and (iv) negative-direction

scans with positive detunings.

The agreement between theory and experiment is, overall, quite good. A fairly

large number of “outliers” are present. These points represent the system undergoing

transitions between the ﬁrst and second branches and reﬂect the fact that the second

threshold occurs very close in detuning to the central point. To support this point,

Figs. 5-26 and 5-28 show the microlaser output curves for nearby detunings 12 MHz

and 15 MHz. Dramatic changes occur for very small changes in detuning. The line is

the same as in Fig. 5-25. In the next section, a “cleaner” way to do the experiment

via cavity locking ﬁnds no intermediate states exist between the ﬁrst and second

branches.

In these plots, the point of onset of the second branch points reﬂect the atom

numbers at which the second threshold appears for some detuning (not necessarily

the detuning being considered).

129

3500

3000

2500

2000

1500

1000

500

200

400

600

800

1000

±

Figure 5-25: Photon number n vs. eﬀective atom number Neﬀ for center of peak
13.5MHz (cavity on resonant with atoms of most probable velocity). Circles
∆ =
(
): Data from positive-direction detuning scans with positive detunings, negative-
◦
): Data from positive-direction
direction scans with negative detunings. Crosses (
detuning scans with negative detunings, negative-direction scans with positive detun-
ings. Solid line: Rate equation model from Chap. 2. Dashed line: location of second
threshold from corresponding quantum microlaser theory.

×

130

3500

3000

2500

2000

1500

1000

500

200

400

600

800

1000

Figure 5-26: Photon number n vs. eﬀective atom number Neﬀ for ∆ =
Circles (

) are as in Fig. 5-25. Line: rate equation model

) and crosses (

±

12.0MHz.

◦

×

131

6000

5000

4000

3000

2000

1000

200

400

600

800

1000

1200

Figure 5-27: Photon number n vs. eﬀective atom number Neﬀ for ∆ =
) are as in Fig. 5-25.
Circles (

) and crosses (

±

10.0MHz.

◦

×

132

3500

3000

2500

2000

1500

1000

500

200

400

600

800

1000

Figure 5-28: Photon number n vs. eﬀective atom number Neﬀ for ∆ =
) are as in Fig. 5-28.
Circles (

) and crosses (

±

15.0MHz.

◦

×

133

6000

5000

4000

3000

2000

1000

200

400

600

800

1000

1200

Figure 5-29: Photon number n vs. eﬀective atom number Neﬀ for ∆ =
Circles (
threshold is apparent.

20.0MHz.
) are as in Fig. 5-25. Line: rate equation model. Third

) and crosses (

×

±

◦

134

800

700

600

500

400

300

200

100

200

400

600

800

1000

1200

Figure 5-30: Photon number n vs. eﬀective atom number Neﬀ for ∆ =
) are as in Fig. 5-25. Line: rate equation model
Circles (

) and crosses (

±

7.5MHz.

◦

×

135

5.2.2 Disagreement with theory

The data does not agree with theoretical curves in several ways. First, the theory

underestimates the photon number in the case of cavity detuned signiﬁcantly from

resonance with the atoms. For example, see Fig. 5-30, Fig. 5-27, and Fig. 5-29. For a

given density, the theory predicts a narrower ﬁrst-branch resonance than is observed.

Second, the peaks for the second and third branches occur at greater absolute

detunings than for the initial branch. The third branch, in particular, exhibits a

maximum at approximately

28 MHz, more than twice the detuning of the ﬁrst

±

branch peak; the third threshold does not appear at all for absolute detunings less

than about 17.5 MHz. From the model of Chapter 2 we would expect all branches to

be approximately centered on zero detuning relative to atoms of the most probable

In Sec. 6.5 we discuss possible reasons for the disagreement.

5.2.3 Peak heights of detuning curves

Suppose we consider the points of maximum photon number in the detuning curves

as representing the condition of the cavity resonant with atoms of the most probable

In Figure 5-31 we plot the peak in each detuning curve against the eﬀective atom

number. Transitions to the second and third branches occur very close to eachother.

The agreement between theory and experiment is quite good except for the third

branch, for which data points are considerably smaller than the theory values. Note

also that the transitions to the third branch occur at a lower atom number the than

predicted by the fully quantized theory.

velocity.

velocity.

5.3 Cavity locking

In order to study the system at a single detuning corresponding to resonance with the

most probably velocity atoms, and to consider the eﬀect of diﬀerent initial conditions

136

7000

6000

5000

4000

3000

2000

1000

200

400

600

800

1000

1200

Figure 5-31: Peak photon numbers of cavity scanning data vs. eﬀective atom number.
13.5MHz). Dotted
Solid line: rate equation solution for atom-cavity resonance (∆ =
line: location of thresholds by quantum theory.

±

Nex

137

of the cavity ﬁeld more directly, we conducted experiments with the cavity locked on

resonance.

Cavity locking experiments used the following sequence:

1. Lock cavity with a probe beam which has frequency corresponding to most

probable velocity atoms, as described in Chapter 4

2. Unlock cavity (remove probe beam and disengage cavity lock circuit)

3. Move atom density modulator by a certain step size

4. Measure atomic density by 553 nm probe and CCD (no 791 nm pump or probe)

5. Lock cavity

6. Unlock cavity

7. Turn on the 791 nm pump beam,

8. Trigger photon counter to measure microlaser emission for 100 msec (“unseeded”

data); download data to computer

9. With the 791 nm pump remaining on, lock cavity again

11. Trigger photon counter to measure microlaser emission for 100 msec (“seeded”

10. Unlock cavity

data); download data to computer

12. Turn oﬀ 791 nm pump and repeat

The repeated locking and unlocking of the cavity was necessary to refresh the

locking in between other operations. A locking time of 300 msec was used.

The frequency shift of the probe beam relative to the atomic line center was found

to be +12.94 MHz.

Note that for each step in density, two microlaser data samples are collected: (1)

“unseeded”, in which the cavity is empty of photons when the pump beam is turned

on, and (2) “seeded” in which the pump beam enters while the cavity has a very large
(n0 ∼
is turned oﬀ, the microlaser ﬁeld develops from this large-n initial condition.

1012) number of photons due to the cavity locking beam. When the cavity lock

138

3000

2500

2000

1500

1000

500

100

200

300

400

500

Figure 5-32: Photon number n vs. eﬀective atom number Neﬀ for cavity locking
): “seeded” data. Solid line:
experiment. Circles (
Rate equation model from Chap. 2. Dashed line: location of second threshold from
microlaser quantum theory.

): “unseeded” data; Crosses (

×

◦

139

500

400

300

200

100

20

40

60

80

100

Figure 5-33: Detail of Fig. 5-32 in the initial threshold region

140

5.3.1 Cavity locking results

The results of the cavity locking experiment are plotted in Figs. 5-32 and 5-33. The

unseeded results agree with data from the cavity scanning experiment. The seeded

results agree with the ﬁrst branch for densities up to the onset of bistability; above

this point the results agree with the second stable branch.

Several outlying points in which the photon counts recorded were extremely high,

105, were removed. These points were clearly artifacts because they occasionally

n

∼

appeared even when no atoms were present. They were most likely due to a problem

in the sequencing electronics which on occasion allowed some of the locking probe

beam to leak into the cavity during the microlaser experiment.

5.4 Discussion

The interpretation of the cavity locking results seems straightforward. The microlaser

is becoming trapped in metastable states. The transition rate from a metastable to a

stable solution is longer than the time of the experiment, which is about 100 msec and

limited to that order of magnitude or smaller by the cavity re-locking requirement.

Note that 100 msec

105 tcav is very long by the time scale of the cavity decay

≈

time. The estimate of a typical tunneling time between metastable and stable states

is given by the Fokker-Planck analysis is [21]:

tg ∼

tcav exp(αNex)

(5.1)

where α is on the order of unity. In our experiment we have Nex ≈
the region where the transition would be expected to occur spontaneously; this gives

10Neﬀ ∼

5000 in

a transition time scale that is extraordinarily long. A calculation of Eq. 2.66 gives a

transition rate W

10−91 Γc for Neﬀ = 600 and zero detuning. By this calculation,

spontaneous jumps will occur on time scales of 1 second or faster only for points

extremely close (less than

10−3 in relative distance) to points of marginal stability.

∼

∼

Then as far as our experiments are concerned, the system would eﬀectively behave

141

as if no spontaneous transitions at all occur.

Some evidence suggests the situation may not be as simple as this. In the cavity

scanning experiments, transitions from the ﬁrst branch to and from the second often

occurs with a abrupt bend in the curve; this occurs in both scan directions. This

seems to suggest this transition occurs spontaneously rather than as a result of a

branch becoming marginally stable and then disappearing. Note that the curve of

solutions, as a function of detuning, must have a divergent slope at a marginally stable

point. (see Fig. 5-34). It may be that other sources of noise (classical or quantum)

drive ﬂuctuations in the system faster than would be predicted by the Fokker-Planck

analysis. We note that studies of bistability in the micromaser [11] found transition

rates much higher than predicted by a similar Fokker-Planck analysis.

A similar analysis of hysteresis applies to the cavity scanning experiments. When

plotted as photon number versus detuning for a ﬁxed Neﬀ, rate equation solutions

appear as closed loops or curves as discussed in Chapter 2.

Transitions from the ﬁrst branch to and from the second often occurs with a

abrupt bend in the curve; this occurs in both scan directions. This seems to suggest

this transition occurs spontaneously rather than as a result of a branch becoming

marginally stable and then disappearing. Note that the curve of solutions, as a

function of detuning or atom number, has a divergent slope at a marginally stable

point. (Fig. 5-34).

5.5 Summary

We have observed second and third thresholds in the microlaser. Theory and ex-

periment are in remarkably good agreement for the resonant case. Highly history-

dependent behavior is observed which suggests that the system becomes trapped in

long-lived metastable states.

in the next chapter.

Possible reasons for disagreement in the nonresonant case will be discussed further

142

Figure 5-34: Arrows: transitions due to disappearance of a stable point. Dotted line:
spontaneous transition from a metastable to stable state. x-axis may represent atom
number or detuning

143

144

Chapter 6

Discussion and Conclusions

6.1 Multiple thresholds and the phase transition

analogy

The discontinuous nature of the higher thresholds and the existence of hysteresis sup-

port the identiﬁcation of these jumps as ﬁrst-order transitions. Due to long metastable

lifetimes, however, the observed jumps in the ﬁeld do not occur at points predicted

from the quantum microlaser theory.

We may ask just how fruitful the phase transition analogy will be in this context.

What insights from the study of many-particle systems can be applied to the micro-

laser, or vice versa? Ideas from nonequilbrium statistical dynamics might be applied

to the microlaser in describing the approach to steady-state and the transitions be-

tween stable states. One theoretical paper [67] suggests that under some variations a

many-atom “mesolaser” with injected signal will exhibit not only multistability but

temporal instabilities, period doubling, self-pulsing, quasiperiodicity, and chaos.

We note that the microlaser is itself a many-particle system, but the particles are

not strongly interacting; they may interact only through the common cavity ﬁeld.

145

6.2 Many-atom eﬀects

The microlaser output in the resonant case agrees remarkably well with the rate

equation solutions of Chapter 2. Both the quantum microlaser theory and the rate

equation were derived by considering the inﬂuence of a single atoms on the ﬁeld

and assuming all atoms act independently. These experiments conﬁrm the validity

of this independent approximation. At ﬁrst glance this may seem surprising, since

the eigenvalues for the atom-cavity system with even two atoms are diﬀerent from

the single atom case. On the other hand, note that in general the photon number

distribution in the cavity is strongly peaked (in fact, often more strongly peaked than

a classical beam). The eﬀect of the other atoms in the cavity can be neglected so long

as their perturbation δn is small compared to n. Moreover, the eﬀect of the other

atoms will tend to cancel eachother if the phases of their own Rabi oscillations are

randomly or broadly distributed.

6.3 Microlasers, lasers, and randomness

We now comment on the relation between the microlaser and a conventional laser. The

microlaser’s unique properties stem from its fully coherent atom-cavity interaction,

which leads to an emission probability per atom (in the case of no broadening) of

Pe = sin2(√n + 1gtint)

(6.1)

To model a conventional laser we simulate atomic decay by averaging over a transit

time distribution weighted by (1/τ1) exp(

t/τa):

−

Pe =

dtint exp(

t/τa) sin2(√n + 1gtint) =

∞

1
τa Z

0

−

1
2  

(n + 1)g2τ 2
a
1 + (n + 1)g2τ 2

a !

(6.2)

Solving the resulting gain-loss rate equation (Fig. 6-1) gives a single solution for

the photon number which increases linearly over threshold as a function of injection

rate. Substituting this equation into the quantum microlaser theory gives steady-state

146

G,L

n

Figure 6-1: Gain-loss graphical solution for conventional laser as modeled in the text.
Gain function follows saturation curve.

photon statistics which are Poissonian far above threshold.

From this perspective, the microlaser can be seen as a laser with an insuﬃcient

amount of noise or randomness to be a conventional laser. Conversely, a laser must

possess a certain amount of noise to behave in the conventional way with monosta-

bility and a single threshold.

We note that any realistic microlaser will contain some averaging due to velocity

distribution, coupling variation, etc. For a suﬃciently large photon number, roughly

n > (π/δ(gtint))2 where δ(gtint) is uncertainty in gtint the averaging will cause wash

out oscillations in the gain function (Fig.6-2) to a value of one-half. Therefore the

conventional laser is invariably recovered in the limit of large photon number.

6.4 Value of quantum theory

Our quantum theory predicts the steady-state photon number distribution in the mi-

crolaser cavity. However, long metastable lifetimes prevent the true steady-state from

being reached on an experimental time scale. Since the quantum theory otherwise

agrees with the rate equation solutions, we might ask what value the quantum theory

has in our case. One answer is that it is a more rigorous treatment than obtained by

the rate equation, and therefore serves as a validation for it on theoretical grounds.

147

G,L

n

Figure 6-2: Gain-loss graphical solution for microlaser with some broadening. For
suﬃciently large n, gain line is ﬂat and solution is similar to that of conventional
laser.

Another consideration is that the quantum theory also describes the statistics of the

photon ﬁeld. Experiments have been done to investigate the microlaser’s photon

statistics in the threshold region [84] and an eﬀorts to measure nonclassical statistics

in the current microlaser are now under way.

6.5 Detuning curves

How do we explain the discrepancy between theory and experiment for the cavity

nonresonant with the most probable velocity atoms?

If we conﬁne our attention to the resonance with a single traveling-wave compo-

nent, the asymmetry in the detuning curves between positive and negative detunings

(relative to the most probable velocities) is particularly puzzling. For a truly monov-

elocity atom beam one would expect perfect symmetry between positive and negative

detunings, by virtue of the symmetry in the Bloch equations when ﬁnal state proba-
bilities are measured. In our case we have a quite narrow beam: ∆vFWMM/v0 ≈
corresponding to a FWHM Doppler broadening of only 17%

13.5MHz

2.3MHz.

17%,

×

≈

And yet the center of the third branch (on the positive detuning side) is found at

a detuning of about +25MHz relative to atomic line center, or +12MHz relative to

148

the resonance with the peak of the velocity distribution. It seems unlikely that the

velocity distribution would lead to such a large eﬀect.

We now suggest a two ideas which are being explored in connection with the

microlaser’s detuning dependence.

6.5.1

Inﬂuence of nonresonant traveling-wave ﬁeld: atom in

a bichromatic ﬁeld

The microlaser’s traveling-wave (TW) interaction scheme requires a Doppler splitting

larger than the widths of the microlaser resonances (i.e. no signiﬁcant overlap between

the two peaks). It was initially believed that if the two resonances are separated in

this way, the interaction with the nonresonant TW component can be neglected.

This may not be true: the nonresonant ﬁeld may exert a signiﬁcant inﬂuence on the

resonant interaction even it would be directly responsible for an insigniﬁcant number

of photons in the absence of the resonant interaction.

To treat this problem exactly, we note that in the atom frame of reference, the

cavity ﬁeld consists of two components of frequency ωcav ±
motion for an atom in a bichromatic ﬁeld can be derived, analogous to Eqns. 2.15

kvθ. The equations of

and 2.16:

˙ca =

e−iφ1ei(ω0−ω1)t +

e−iφ2ei(ω0−ω2)t

cb

iΩ1
2

(cid:20)

iΩ1
2

(cid:20)

iΩ2
2

iΩ2
2

(cid:21)

(cid:21)

˙cb =

eiφ1e−i(ω0−ω1)t +

eiφ2e−i(ω0−ω2)t

ca

(6.3)

(6.4)

where ω1 = ωcav + kvθ, ω2 = ωcav + kvθ are the ﬁeld frequencies, ω0 is the atom

resonance frequency, and φ1, φ2 are the ﬁeld phases. The solutions strongly depends

on the choice of initial phase diﬀerence between the two ﬁelds. In a simulations, an

averaging over phase diﬀerence must be performed.

149

6.5.2 Dispersive eﬀects

A related question is that of dispersive eﬀects of the resonant and nonresonant atoms

in the cavity. The susceptibility of a collection of N atoms in a light ﬁeld of frequency

ω (see [88] ) is given by χ = χ′ + iχ′′, with

χ′ =

2

N ′

µ
|
|
ǫ0¯h

−

δL
a/4 + Ω2

R/2

δ2
L + Γ2

χ′′ =

2

N ′

µ
|
|
ǫ0¯h

Γa/2
a/4 + Ω2

R/2

δ2
L + Γ2

(6.5)

(6.6)

where N ′ is the atom density, ΩR is the Rabi frequency of atoms in the ﬁeld, δL is

the laser-atom detunig, and Γa is the atom linewidth.

This equation must be modiﬁed for the microlaser system, in which transit time
is much shorter than atom lifetimes. A ﬁrst approximation is to replace Γa with t−1
int .

The refractive index of the atoms is

n =

1 + χ′

1 + χ′/2

q

≈

(6.7)

The shift in cavity frequency due to atom dispersion will be on the order of

χ′/2ωcav which may be as large as

δcav ∼
∼
shift is a function of the Rabi frequency 2√ng and atom-cavity detuning. In general

10 MHz for 1000 atoms in the cavity. The

there will be two such frequency shifts, one for each traveling-wave component, which

add in eﬀect.

Frequency shifts from the dispersive eﬀects may lead to another form of optical

bistability, due to a nonlinear medium. The hysteresis observed in the microlaser

may in fact be a combination of the microlaser’s oscillatory gain function and “clas-

sical” optical bistability eﬀects. Unraveling the two forms of bistabilities will be an

interesting challenge.

150

6.6 Future directions

6.6.1 Theory of microlaser

Clearly, the next step is to develop a more complete description of the microlaser,

particularly for the nonresonant case. Additional data for high densities, and results

from cavity locking experiments as a function of detuning as well as atom number,

should provide important clues to the source of discrepancy between experiments and

current theory. The possibility of many-atom eﬀects playing a signiﬁcant role cannot

be ruled out, despite what the quantum trajectory results of Chapter 3 might suggest.

In parallel, a number of other microlaser experiments are being considered.

Second-order correlation measurements

We have performed several experiments to measure the second-order correlation func-

tion g(2)(t) of the microlaser emission [84]. Experiments have shown an reduction of

amplitude of ﬂuctuations, and a local maximum of the time scale of ﬂuctuations,

during the initial (second-order) threshold region. Our primary goal however has

been to observe antibunching in the output ﬁeld. Although the photon statistics in-

side the cavity are highly squeezed in amplitude (with a Mandel Q parameter as low

as -0.8), the resulting nonclassical eﬀect in the output light is limited by the rela-

tively large number of photons in the cavity. The second-order correlation function

at zero time delay is related to the average cavity photon number and Q parameter

by g(2)(0) = 1 + Q/

; for

n

500 we expect g(2)(0)

1

0.002. Classical

n
i

h

h

i ≈

−

≈ −

ﬂuctuations and other systematic eﬀects may obscure this small eﬀect.

Internal statistics: Cavity dumping experiment

One method of more directly investigating photon statisics of the cavity ﬁeld is via a

“cavity dumping” scheme. The cavity-atom interaction could suddenly be disabled,

by detuning or by optical mean, after which the internal photons are collected as they

exit the cavity. By repeating this process many times, a photon count distribution

P (PCD)
m

is obtained which is related to the cavity photon number distribution P (PND)

n

151

by the partition formula

where η is the overall counting eﬃciency.

Microlaser lineshape measurement

P (PCD)
m

=

ηm(1

η)nP (PND)
n

,

−

(6.8)

∞

n=m
X

n

m











Lineshape measurements in the many atom regime is a potentially rich ﬁeld of study.

Number-phase uncertainty requires sub-Poissonian statistics to be associated with

increased phase diﬀusion, and thus a larger linewidth. For this reason we expect to

observe dramatic changes in microlaser linewidth as the number of atoms and other

parameters are varied. Such behavior has been predicted in [44] in the context of the

micromaser, but has yet to be observed, either directly or indirectly.

6.7 Summary

We have developed a laser system in which atom-ﬁeld interaction is truly coherent.

Rabi oscillations of the atoms lead to multistability in the laser ﬁeld intensity, and

rapid jumps occur between diﬀerent stable points. Theory and experiment are in

good agreement for the case of the cavity resonant with atoms of the most probable

velocity, but long lifetime of metastable states prevent veriﬁcation of true steady-state

transition points. Hysteresis is observed as a function of atom-cavity detuning and

initial cavity photon number. The detuning behavior of the microlaser is not yet

well-understood; interactions with the nonresonant ﬁeld and dispersive eﬀects of the

resonant and nonresonant atoms are being investigated.

Quantum trajectory simulations support the application of single-atom theory to

the many-atom case. In addition, simulations predict an increase in photon number

variance proportional to the product of the interaction time and cavity decay rate,

for parameters such that the single-atom theory predicts sub-Poisson statistics.

152

Appendix A

Microlaser theory calculations

These programs were written and executed using Mathematica 3.0 and 4.0 by Wolfram
Software.

A.1 Micromaser theory

*)
(* All distances in microns
(* All times in microseconds
*)
(* All frequencies in 10^6 /s *)

us = 1;
mhz = 2. Pi;

lambda = 0.7911;
wm = 41.1 ;
v0 = 815; (* most probable velocity, m/s *)
deltapeak = +13.5 mhz;
tiltangle = (deltapeak / (2Pi)) * lambda / v0;

gammacav = 1/0.88;

v = 815.;
tint = Sqrt[Pi] * wm / v;
deltaVOverV = 0.165;

gcoupling0 = 2*Pi*192.9 * 10^-3;
gcoupling = gcoupling0 ;

deltacavlowerlimit = 0;

153

deltacavupperlimit = 50 mhz;

sqnupperlimit = 150;

doMicromaserCalc :=

(pOverC = Table[0, {k, 0, kmax}];

p = Table[0, {k, 0, kmax}];
pOverC[[0 + 1]] = 1;
sumpOverC = 1;
Do[

pOverC[[k + 1]] = pOverC[[k]] * Nex *

betaapprox[Sqrt[k], delta]/k;

sumpOverC = sumpOverC + pOverC[[k + 1]],

{k, 1, kmax}];

Do[p[[k]] = pOverC[[k]] / sumpOverC, {k, 1, kmax + 1}];
nAvg = Sum[k * p[[k + 1]], {k, 0, kmax}];

n2Avg = Sum[k^2 * p[[k + 1]], {k, 0, kmax}];

mandelQ = (n2Avg - nAvg^2 - nAvg)/nAvg;

);

getnQ := (Nex = natoms / (0.10595 * 1);

kmax = Floor[Nex + 2]; doMicromaserCalc; Return[{nAvg, mandelQ}]);

A.2 Calculation of gain function

This code includes bichromatic eﬀects (set Ω2 = 0 for ordinary monochromatic theory)

(* relative to atoms *)

(* relative to atoms *)

Delta1 = 10;
Delta2 = 37 mhz;
tstart = -2* tint;
tstop = +2 * tint;

dosoln := NDSolve[{ca’[

t] == ((I *omegaR1[t]/2) E^(-I *phi1) E^(I* Delta1* t) + (I *
omegaR2[t]/2) E^(-I *phi2) E^(I Delta2 * t))* cb[t],
cb’[t] == ((I *omegaR1[t]/2) E^(I *phi1) E^(- I* Delta1* t) + (I *
omegaR2[t]/2) E^(I *phi2) E^(- I Delta2 * t))*ca[t],
ca[tstart] == 1., cb[tstart] == 0.}, {ca, cb}, {t, tstart, tstop},

MaxSteps -> 10000, StartingStepSize -> Automatic,

154

MaxStepSize -> tint/10, WorkingPrecision -> 10] ;

(* Average over relative phases! *)

numphases = 10.;
phase[i_] := 2. Pi * (i - 1)/numphases;
solarray = Table[i, {i, 1, numphases}];

omega0 = 2* Sqrt[n + 1] * gcoupling;
omegaR1[t_] := omega0 * Exp[-(v t/wm)^2] ;
omegaR2[t_] :=

omega0 * Exp[-(v t/wm)^2] ;

dophaseavg :=

(

Do[
(

phi1 = 0*phase[i];

phi2 = phase[i];
solarray[[i]] = dosoln;), {i, 1, numphases}];

caarray = Table[(ca /. solarray[[i]])[[1]], {i, 1, numphases}];
(* cbarray = Table[(cb /. solarray[[i]])[[1]], {i, 1, numphases}];

*)

ca2avg2[t_] := Sum[(Abs[caarray[[i]][t]]^2)/numphases, {i, 1, numphases}];
(* cb2avg2[t_] :=

Sum[(Abs[cbarray[[i]][t]]^2)/numphases, {i, 1, numphases}]; *)

Sum[(Abs[caarray[[i]][t]]^2)/numphases, {i, 1, numphases}], {t,

(* ca2avg[t] =

FunctionInterpolation[

tstart, tstop}]; *)(*

cb2avg =

FunctionInterpolation[

tstart, tstop}]; *)

Return[1 - ca2avg2[tstop]];
);

Sum[(Abs[cbarray[[i]][t]]^2)/numphases, {i, 1, numphases}], {t,

gaussian[x_, xa_, sigma_] :=

1/(Sqrt[2. Pi]*sigma) E^(-(x - xa)^2/(2.*sigma^2));
veldist[vel_] := gaussian[vel, v0, v0*deltaVOverV / 2.355];

numvels = 11;
vlowerlimit = v0 (1 - 1.2*deltaVOverV);
vupperlimit = v0 (1 + 1.2*deltaVOverV);

(* odd number is better *)

155

vsample[i_] :=

N[vlowerlimit + (i - 1)*(vupperlimit - vlowerlimit)/(numvels - 1)];

deltaofv[vel_] := (vel/v0 - 1.)*deltapeak;
vweight[i_] :=

veldist[vsample[i]] * (vupperlimit - vlowerlimit)/(numvels - 1);

vlist = Table[{vsample[i], vweight[i]}, {i, 1, numvels}];

numgs = 4;
gvariation = 0.09;
gupperlimit = 0.99*gcoupling0;
glowerlimit = 1.01 * gcoupling0* (1 - gvariation);
gdist[g_] :=

UnitStep[1 - g/gcoupling0]*UnitStep[g/gcoupling0 - (1 - gvariation)]*

Sqrt[Log[gcoupling0/g]];

gsample[i_] :=

N[glowerlimit + (i - 1)*(gupperlimit - glowerlimit)/(numgs - 1)];

gweight2[i_] := gdist[gsample[i]] * (gupperlimit - glowerlimit)/(numgs - 1);
gnorm = Sum[gweight2[i], {i, 1, numgs}];
gweight[i_] := gweight2[i]/gnorm;
glist = Table[{gsample[i], gweight[i]}, {i, 1, numgs}];

(* beta1 : averaged over phase, velocity = detuning *)

dobeta1 :=

Sum[ vweight[i]*

( v = vsample[i];

Delta1 = deltacav - (v/v0) * deltapeak;

Delta2 = -(deltacav + (v/v0)*deltapeak );

dophaseavg
), {i, 1, numvels}];

(* beta2 : averaged over phase, velocity = det, gcoupling *)

dobeta2 :=

Sum[gweight[j]*

( gcoupling = gsample[j];

Sum[ vweight[i]*

( v = vsample[i];

Delta1 = deltacav - (v/v0) * deltapeak;

Delta2 = -(deltacav + (v/v0)*deltapeak );

dophaseavg
), {i, 1, numvels}])

156

, {j, 1, numgs}];

157

158

Appendix B

Quantum trajectory program

B.1 Main program: qts.c

#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include <time.h>/* for clock() and time() */

/* for exit(), rand(), and malloc() */

/* Version 9.5 (CFY) : include comments in input files
*/
/* Fixed bugs in counting number of atoms, average number of photons */

/* This is version 9, single precision version. This version

includes atom-cavity detuning effect. For this _C[] becomes
_C[] (real) and _D[] (imaginary). */

/* adaptive step size control: dt is not constant */

/* Unused defs */
/* #define USE_MSDOS_NAMES */
/* #define REUSE_C_ARRAY

/* #define CLICK_INTERRUPT

/* initialize _C[] with the last saved _C[] array */

/* sense mouse click */

/*#define X_GAUSSIAN_BASED_ON_RABI_OSC 1
*/
/* 1 means that <N> calculation is based on Rabi oscillation
/* argument, i.e., averaging of g(x), whereas 0 means that it is */
*/
/* based on averaging of g^2.

*/

159

SUMMARY_FILENAME_DEFAULT "qts.data"

/* Use Runge-Kutta 4th order */

/* reproducible random numbers. */

/* displaying dots */

#define
#define USE_RK4_ALGORITHM
#define DRAND48_EXIST
#define RANDOM_INIT
#define SHOW_PROGRESS

#define LINUX
#define VERSION 9
#define REVISION 1
#define A_INFO_ITEMS
#define MAX_NUM_ATOM
#define MAX_NUM_INPUT_FILES 64
#define MAX_MEMORY two_to(25)

7
20

/* 22-> 4 MB, 23-> 8MB, 24->16MB */

#define D_STATE_DECAY_CORRECTION 1.34

/* D-state decay ratein 1P1-1S0 decay rate ; amj 1.0 -> 1.37 */

#define WAIT_PORTION_BEFORE_AVERAGING 0.0

/* amj changed it to .0 instead of .1:
/* .1 = first 10% not used for averaging

*/
*/

/* same thing as above, but active in this version (CFY) */

#define VERY_SMALL 1.e-30
#define SQRT_CORRECTED

/* Platform specific redefinition */

#ifdef DRAND48_EXIST
#define drand() drand48()
#define srand(x) srand48(x)
#else
#define drand() (rand()/(double)RAND_MAX)

#endif

#ifdef SQRT_CORRECTED
#define sqrt(x) sqrt(fabs(x))
#endif
#define sqr(x) ((x)*(x))

#ifdef LINUX
#define pi PI

160

/* for Mac and PC */

#else
#define PI pi
#endif

#define

PI

3.1415926536

/* output/input file names */

#define QT_LOG "test.log"
#ifdef USE_MSDOS_NAMES
#define INDEX_FILE "test.idx"
#define INPUT_FILE "test.inp"
#define STATUS_FILE "test.sta"
#define OUTPUT_FILE "test_out"
#define PHOTON_FILE "test_pho"

#else
#define INDEX_FILE "test.index"
#define INPUT_FILE "test.input"

#define STATUS_FILE "test.status"

#define OUTPUT_FILE "test_output"
#define PHOTON_FILE "test_photon"
#endif

/* for INPUT_ONLY option */

/* contains _C[] array, etc */

/* global variables accessed from other routines */
double *_C, *_D, *_C_1, *_D_1;

#ifdef USE_RK4_ALGORITHM
double *_C_2, *_C_3, *_D_2, *_D_3;
#endif

/* C=real, D=imaginary part */
double _u_th, _w0, _Gc_over_2pi, _g_over_2pi, _Ga_over_2g;
int _max_atoms, _max_photon_size;
double _A_info[MAX_NUM_ATOM][A_INFO_ITEMS];
int _N_atom; /* current number of atoms in the cavity */
double _t_int, _Delta_t, _beam_radius, _delta_v, _v0, _detuning=0.;

/* amj add; _v0 is peak of selected velocity in most
/* probable velocity unit */

*/

double *SIN, *EXP;
double *_Pn_dist, *_Pn_dist_mean, *_Pn_dist_mean_beginning;

/* Note: Pn_dist_mean is actually P(n) * (averaging time / dt) */
/* until end of sim. */
double _population[MAX_NUM_ATOM];

161

double _mean_shift_over_2g, _CA_detuning;
double **_bits, *_detuning_sum, _omega_Rabi;
double g_multiplier;
long _max_k;

/* #ifdef SPONT_EMISS_IN_PUMP
double _pump_waist=1.0;
#endif */

/* User-specified parameters */
int INCLUDE_ATOM_DECAY; /* atomic spontaneous emission */
int INCLUDE_D_STATE_DECAY; /* D-state decay loss included */
int USE_LAST_C_ARRAY=0;

int STANDING_WAVE;
/* include sin kz dependence in g */

int GAUSSIAN_X=1;

/* amj jul 27, 98 */

/* assume a gaussian exp(-x^2/w0^2) dependence */
/* along x axis. */

double INTERACTION_LENGTH=2.;
/* atom-field interaction length.
*/
/* should be larger than 2 in _w0 unit */

int GAUSSIAN_Y=1;

/* assume a gaussian exp(-y^2/w0^2) dependence
/*

along y axis */

*/

int CIRCULAR_BEAM;
/* assume a circular atomic beam with diameter of D */

double
/*

REC_HALF_HEIGHT;

half height of the beam in _w0, width is equal to D */

int MONO_VELOCITY=0;
/* mono-energetic atomic beam with v=u_th */

int USE_MAXWELL_BOLTZMANN;

int DEBUG_LEVEL=0;

/* 0=only summary
/* 3=extra info */

1=immediate output

2=debug info */

162

int PUMPING_SIMULATED;

/* pump field effect during evolution included */

double

PUMPING_LENGTH;

/* should be large enough to include 2*pump waist */

double

PUMP_WAIST;

/* waist of pump field assuming gaussian */

double

PUMP_POS;

/* pump center to cavity center distance.
/* should be positive. */
/* integration from -PUMPING_LENGHT/2 to
/* PUMP_POS-INTERACTION_LENGTH/2 with the pump */
/* center is located at 0. */

*/

*/

char *inputline, *inputfilename, *indexfilename, *statusfilename,

*outputfilename, *photonfilename, *pnfilename, *summaryfilename;

int PUMPING_EFFECT_ON=0;

int

n_seed=0,
first_atom_flag=0;

double
int
int
double

double
int

N_ex, theta_pump;
VARIABLE_FINESSE = 0;
ADJUST_N_EFF = 0;
new_N_eff;

WAIT_FRACTION = 0.3;
WAIT_FRACTION_TENTHS;

/* Function declarations */

int getline(FILE *ff, char *s, int lim);
void testroutine(void);
double get_arrival_time(void);

/*

double get_velocity(void); */

/*

double get_arrival_time_old(void);

*/

main(int argc, char **argv)
{

double Ga_over_2pi, lambda, r0, finesse, L;
double N_eff[100], u_th[100], z0, fsr, f, t, dt, Ti, Ti2, Ti2new;
double T1, T2, time_elapsed;

163

long ii, C_size, total_array_size, max_k, P_atom[MAX_NUM_ATOM];

int

i, j, num_N_eff, tot_atom_count, m, atom_count,

atom_count_since_Ti2, photon_count, too_many_atom_count,
num_u_th, mm, injected_state, num_excited_exiting;

int

atom_decay_to_d_count=0;

/* amj */

time_t tp;

/* for initializing srand() */

double D, next_entry_time, t_int, delta_t, n_mean, n2_mean,

n_aver, n2_aver, n_sum, n2_sum, X, n_mean1, n_mean2;
/* amj add n2_mean and change dn_sum to n2_sum and
/* dn_aver to n2_aver */

*/

double P_sum, P_N_mean, P_N_mode, emission_prob;

FILE *fp;

int MAKE_INPUT_ONLY=0, file_id;
char output_name[80], output_time[80], photon_file_name[80];
char *inputfile[MAX_NUM_INPUT_FILES];
int NUM_INPUT_FILES=0, K, GENERATE_PHOTON_FILE=0;
double num_excited_injected_atoms, excited_state_prob;

/* expectation value */

int spont_count=0, d_state_decay_count=0, stop_now=0;
double tilt_angle, detuning[100], mean_shift;
int num_detuning, mmm, nonzero_tilt;
double vacuum_time, effective_V_to_apparent_V,

big_dt, dt0, dt0_init, Mandel_Q;

long num_dt_steps;
double

num_dt_aver_steps=0.;

*/
/* during which average of n_aver and n2_aver is taken */

/*amj number of dt steps

double
double n_final[100], Q_final[100], N_final[100], Gc_final[100];

num_dt_aver_steps_last=0.; /* placeholder */

double arrt, p_poisson;

/* function declarations */
void evolve_wave_function(double, double);
long two_to(int);
void define_sin_exp();
void read_status_file();
void write_status_file();

164

double inject_new_atom(double);
int cavity_decay_occurs(double, double*,double*);

/* returns excited state prob. */

/* amj add ,double* */

int how_many_atoms_decay(double);
int how_many_d_state_decay(double);

double final_n_avg;
double final_n2_avg;
double final_normalize;

#ifdef CLICK_INTERRUPT

int key_pressed();

#endif

/* #ifndef LINUX */ /* amj */
float volume_ratio();
/* argc=ccommand(&argv); */ /* amj */
/* #endif */ /* amj */

/* make sine table */
/*define_sin_exp();*/

/* Memory allocation for filename strings */

inputline = malloc(20 * sizeof(char));

inputline = malloc(100 * sizeof(char));
inputfilename = malloc(15 * sizeof(char));
/*
inputfilename = malloc(20 * sizeof(char));
indexfilename = malloc(20 * sizeof(char));
statusfilename = malloc(20 * sizeof(char));
outputfilename = malloc(20 * sizeof(char));
photonfilename = malloc(20 * sizeof(char));
summaryfilename = malloc(20 * sizeof(char));
pnfilename = malloc(20 * sizeof(char));

*/

/*

printf("(0) Top hat or (1) Gaussian in x direction?\n");

scanf("%d", &GAUSSIAN_X);

*/

/* Get an input file list */

for (i=0; i<MAX_NUM_INPUT_FILES; ++i)
inputfile[i]=malloc(80);

165

fprintf(stderr, "Enter input file name(s) \n");
fprintf(stderr, "(max number of names < %d and ’&’ should be the

last item in the list.)\n", MAX_NUM_INPUT_FILES);

fprintf(stderr, "’&’ without the list ");
fprintf(stderr, "will make a new input file.\n");
fprintf(stderr, "Enter $ for test routine.\n");

i=-1;
NUM_INPUT_FILES=0;
do {

i++;

scanf("%s", inputfile[i]);

if(*inputfile[i] == ’$’) testroutine();

}

while ( *inputfile[i] != ’&’);

NUM_INPUT_FILES=i;
if (i==0) MAKE_INPUT_ONLY=1;

if (MAKE_INPUT_ONLY)

printf("input only\n");

else
{

for (i=0; i<NUM_INPUT_FILES; ++i )
{

fprintf(stderr, "batch %d: %s\n", i, inputfile[i]);

fp=fopen(inputfile[i], "r");

if(fp==NULL)

{ printf("file not found, exiting\n");
/*

fclose(fp); */

exit(1);

fclose(fp);

}

}

}

if (MAKE_INPUT_ONLY)
{

scanf("%s", inputfilename);

printf("Enter new input filename (max 15 chars):\n");

fp=fopen(inputfilename, "w");

/* user input */
fprintf(stderr, "Microlaser quantum trajectory simulation");
fprintf(stderr, "version %d\n", VERSION);

166

fprintf(stderr, "Enter Ga/2pi in kHz:\n");

scanf("%lf", &Ga_over_2pi);

fprintf(fp, "%lf # Ga_over_2pi\n", Ga_over_2pi);

fprintf(stderr, "Enter wavelength in nanometer:\n");
scanf("%lf", &lambda);
fprintf(fp, "%lf # lambda\n", lambda);

fprintf(stderr, "Enter radius of curvature in cm:\n");
scanf("%lf", &r0);
fprintf(fp, "%lf # r0\n", r0);

fprintf(stderr,

"Enter finesse in million, negative for variable:\n");

scanf("%lf", &finesse);
fprintf(fp, "%lf # finesse\n", finesse);

fprintf(stderr, "Enter cavity length in cm:\n");
scanf("%lf", &L);
fprintf(fp, "%lf # L\n", L);

fprintf(stderr, "Enter max number of photons +1 and ");
fprintf(stderr, "atoms in the cavity:\n");

scanf("%d %d", &_max_photon_size, &_max_atoms);
fprintf(fp, "%d %d # _max_photon_size _max_atoms\n",
_max_photon_size, _max_atoms);

fprintf(stderr, "Enter (initial) size of integ. step in 1/2g:\n");

scanf("%lf", &dt0);

fprintf(fp, "%lf # dt0\n", dt0);

fprintf(stderr, "Enter total # atoms to inject into cavity:\n");

scanf("%d", &tot_atom_count);

fprintf(fp, "%d # tot_atom_count\n", tot_atom_count);

/* control parameters */
fprintf(stderr, "Enter a value for DEBUG_LEVEL(0..3):\n");
scanf("%d", &DEBUG_LEVEL);
fprintf(fp, "%d # DEBUG_LEVEL\n", DEBUG_LEVEL);

#ifdef REUSE_C_ARRAY /* Reusing _C[] values */

fprintf(stderr,

"Initialize _C[] to those from previous loop/run? \n");

fprintf(stderr, "(yes=1/no=0):\n");
scanf("%d",&USE_LAST_C_ARRAY);

167

fprintf(fp, "%d # USE_LAST_C_ARRAY\n",USE_LAST_C_ARRAY);

#endif

/* damping processes */
fprintf(stderr, "Include atomic spontaneous emission? ");
fprintf(stderr, "(yes=1/no=0):\n");
scanf("%d", &INCLUDE_ATOM_DECAY);
fprintf(fp, "%d # INCLUDE_ATOM_DECAY\n", INCLUDE_ATOM_DECAY);

fprintf(stderr, "Include D-state branching? (yes=1/no=0):\n");
scanf("%d", &INCLUDE_D_STATE_DECAY);
fprintf(fp, "%d # INCLUDE_D_STATE_DECAY\n", INCLUDE_D_STATE_DECAY);

/* cavity mode parameters */
fprintf(stderr,

"Choose (0) traveling wave, (1) standing wave mode:\n");

scanf("%d", &STANDING_WAVE);

fprintf(fp, "%d # STANDING_WAVE\n", STANDING_WAVE);

if (!STANDING_WAVE)
{

fprintf(stderr,

/* traveling-wave must have a nonzero tilt */

"Enter atomic beam tilt angle(theta) in mrad:\n");

scanf("%lf", &tilt_angle);
fprintf(fp, "%lf # tilt_angle\n", tilt_angle);

tilt_angle=0.; /* no tilt for standing-wave mode */

}

else

fprintf(stderr,

nonzero_tilt=1;
fprintf(stderr,

}
else

{

{

"Enter number of atom-cavity detuning values (max of 100):\n");

scanf("%d", &num_detuning);
fprintf(fp, "%d # num_detuning\n", num_detuning);

if ((!STANDING_WAVE)&&(fabs(tilt_angle)>1.e-10))

/* traveling-wave & nonzero tilt angle */

"Enter detuning values in (u/lambda*theta) unit:\n");

fprintf(stderr, "Enter detuning values in MHz:\n");

nonzero_tilt=0;

168

}

}

for (i=0; i<num_detuning; ++i) {

scanf("%lf", &detuning[i]);
fprintf(fp, "%lf # detuning[%d]\n", detuning[i], i);

fprintf(stderr,

"Enter atom-cavity interaction \"full\" length in w0:\n");

scanf("%lf", &INTERACTION_LENGTH);
fprintf(fp, "%lf # INTERACTION_LENGTH\n", INTERACTION_LENGTH);

fprintf(stderr, "Choose (0)rectangular beam, (1) circular beam:\n");
scanf("%d", &CIRCULAR_BEAM);
fprintf(fp, "%d # CIRCULAR_BEAM\n", CIRCULAR_BEAM);
if (CIRCULAR_BEAM)
{

fprintf(stderr,

"Enter diameter of atomic beam D in um:\n");

scanf("%lf", &D);
fprintf(fp, "%lf # D diameter of beam\n", D);

}
else

{

fprintf(stderr,

"Enter half height of atomic beam in w0:\n");

scanf("%lf", &REC_HALF_HEIGHT);
fprintf(fp, "%lf # REC_HALF_HEIGHT\n", REC_HALF_HEIGHT); }

fprintf(stderr, "Ratio of effective volume to apparent volume?\n");
fprintf(stderr, "On Mac it is automatically calculated:\n");
scanf("%lf", &effective_V_to_apparent_V);
fprintf(fp, "%lf # effective_V_to_apparent_V\n",
effective_V_to_apparent_V);

/*

End of cavity input

*/

/* N_eff[] input */
fprintf(stderr, "Enter number of <N> values (max of 100):\n");
scanf("%d", &num_N_eff);
fprintf(fp, "%d # num_N_eff\n", num_N_eff);

fprintf(stderr, "Enter <N> values:\n");
for (i=0; i<num_N_eff; ++i)

169

{ scanf("%lf", &N_eff[i]);

fprintf(fp, "%lf # N_eff[%d]\n", N_eff[i], i);
}

fprintf(stderr,

"Enter number of most probable velocity values (max of 100):\n");

scanf("%d", &num_u_th);
fprintf(fp, "%d # num_u_th\n", num_u_th);

fprintf(stderr, "Enter most probable velocities (u) in m/s:\n");
for (i=0; i<num_u_th; ++i)
{

scanf("%lf", &u_th[i]);
fprintf(fp, "%lf # u_th[%d]\n", u_th[i], i);

}

fprintf(stderr,

"Choose (0) velocity distribution, (1) mono velocity:\n");

scanf("%d", &MONO_VELOCITY);
fprintf(fp, "%d # MONO_VELOCITY\n", MONO_VELOCITY);

/* For non-Maxwell Boltzmann velocity distribution */
if (!(MONO_VELOCITY))

{

fprintf(stderr, "Which distribution\n");
fprintf(stderr, "(0) M-B convoluted with Lorentzian\n");
fprintf(stderr, "(1) Maxwell-Boltzmann?:\n");

scanf("%d", &USE_MAXWELL_BOLTZMANN);
fprintf(fp, "%d # USE_MAXWELL_BOLTZMANN\n",

USE_MAXWELL_BOLTZMANN);

if (!(USE_MAXWELL_BOLTZMANN))

{

fprintf(stderr, "Enter full width of velocity ");
fprintf(stderr, "spread in most probable velocity unit\n");

/* scanf("%lf %lf", &_delta_v, &_v0);
scanf("%lf", &_delta_v);

*/

fprintf(stderr, "Enter peak of the selected velocity");
fprintf(stderr, " in most probable velocity unit:\n");

scanf("%lf", &_v0);
fprintf(fp, "%lf # _delta_v\n", _delta_v);
fprintf(fp, "%lf # _v0\n", _v0);

}

}

170

fprintf(stderr, "Generate a record for photons emitted?
(yes=1, 0=no)\n");
scanf("%d", &GENERATE_PHOTON_FILE);
fprintf(fp, "%d # GENERATE_PHOTON_FILE\n", GENERATE_PHOTON_FILE);
/*
fprintf(stderr, "Enter a & b where <n>a*<N>^b:\n");
scanf("%lf %lf", &a_coeff, &b_coeff);
fprintf(fp, "%lf %lf\n", a_coeff, b_coeff);
*/

/* pumping simulation, if required */
fprintf(stderr, "Include pump field effect on atom-cavity ");
fprintf(stderr, "interaction? (yes=1/no=0):\n");
scanf("%d", &PUMPING_SIMULATED);
fprintf(fp, "%d # PUMPING_SIMULATED\n", PUMPING_SIMULATED);

if (PUMPING_SIMULATED)

fprintf(stderr,

{

fprintf(stderr, "Pump field effect included:\n");

"Enter pumping length, pump waist in w0 unit:\n");

scanf("%lf %lf", &PUMPING_LENGTH, &PUMP_WAIST);
fprintf(stderr,

"Enter position of the pump in w0 unit (+ if prior to the cavity):\n");

/* PUMP_POS is positive if the pump is place before the cavity */

scanf("%lf", &PUMP_POS);
fprintf(fp,

"%lf %lf %lf # PUMPING_LENGTH, PUMP_WAIST, PUMP_POS\n",

PUMPING_LENGTH, PUMP_WAIST, PUMP_POS);
}

fprintf(stderr, "Enter filename for summary data, blank for ’%s’:\n",
SUMMARY_FILENAME_DEFAULT);
scanf("%s", summaryfilename);
fprintf(fp, "%s # summary data filename\n", summaryfilename);

fclose(fp);
fprintf(stderr, "*** End of Input ***\n");
exit(1);

}

/* From now on it is "not" MAKE_INPUT_ONLY */

/* Grand Loop for input files */

171

for (K=0; K<NUM_INPUT_FILES; ++K)
{

/****************** GRAND LOOP *******************/

/* Read from inputfile[K] */

if ((fp=fopen(inputfile[K], "r"))==NULL)
{
exit(1);
}

fprintf(stderr, "*** %s cannot be found.\n", inputfile[K]);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &Ga_over_2pi);
fscanf(fp, "%lf", &Ga_over_2pi);
/*
printf("Ga_over_2pi = %f\n", Ga_over_2pi);
/*

*/

*/

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &lambda);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &r0);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &finesse);

if(finesse<0)

finesse = -finesse;
VARIABLE_FINESSE = 1;

{

}

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &L);

getline(fp, inputline, 100);
sscanf(inputline, "%d %d", &_max_photon_size, &_max_atoms);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &dt0_init);

getline(fp, inputline, 100);
sscanf(inputline, "%d", &tot_atom_count);
/*

printf("tot_atom_count = %d\n", tot_atom_count);

*/

getline(fp, inputline, 100);
sscanf(inputline, "%d", &DEBUG_LEVEL);

172

#ifdef REUSE_C_ARRAY

getline(fp, inputline, 100);
sscanf(inputline, "%d",&USE_LAST_C_ARRAY);

#endif

getline(fp, inputline, 100);
sscanf(inputline, "%d", &INCLUDE_ATOM_DECAY);

getline(fp, inputline, 100);
sscanf(inputline, "%d", &INCLUDE_D_STATE_DECAY);

getline(fp, inputline, 100);
sscanf(inputline, "%d", &STANDING_WAVE);
/*

printf("STANDING_WAVE = %d\n", STANDING_WAVE);

*/

if (!STANDING_WAVE)
{

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &tilt_angle);
printf("tilt_angle = %f\n", tilt_angle);

*/

/*

}

else tilt_angle=0.;

if ((!STANDING_WAVE)&&(fabs(tilt_angle)>1.e-10))

else

nonzero_tilt=1;

nonzero_tilt=0;

getline(fp, inputline, 100);
sscanf(inputline, "%d", &num_detuning);

for (i=0; i<num_detuning; ++i)

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &detuning[i]);

{

}

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &INTERACTION_LENGTH);

getline(fp, inputline, 100);
sscanf(inputline, "%d", &CIRCULAR_BEAM);

if (CIRCULAR_BEAM)

173

if(GAUSSIAN_X==0) INTERACTION_LENGTH = 1.772;

/* Sqrt(pi) */

getline(fp, inputline, 100);

sscanf(inputline, "%lf", &D);

}
else
{

{

}

getline(fp, inputline, 100);

sscanf(inputline, "%lf", &REC_HALF_HEIGHT);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &effective_V_to_apparent_V);

if(GAUSSIAN_X==0) effective_V_to_apparent_V = 1;

/* For top hat, interaction region is equivalent to mode */

getline(fp, inputline, 100);
sscanf(inputline, "%d", &num_N_eff);

for (i=0; i<num_N_eff; ++i)

getline(fp, inputline, 100);

sscanf(inputline, "%lf", &N_eff[i]);

{

}

getline(fp, inputline, 100);
sscanf(inputline, "%d", &num_u_th);

for (i=0; i<num_u_th; ++i)
{

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &u_th[i]);

}
getline(fp, inputline, 100);
sscanf(inputline, "%d", &MONO_VELOCITY);
if (!(MONO_VELOCITY))
{

if (!(USE_MAXWELL_BOLTZMANN))

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &_delta_v);

getline(fp, inputline, 100);
sscanf(inputline, "%lf", &_v0);

{

}

}
getline(fp, inputline, 100);
sscanf(inputline, "%d", &GENERATE_PHOTON_FILE);
/*
getline(fp, inputline, 100);

174

getline(fp, inputline, 100);
sscanf(inputline, "%d", &USE_MAXWELL_BOLTZMANN);

sscanf(inputline, "%lf %lf", &a_coeff, &b_coeff);
*/

getline(fp, inputline, 100);
sscanf(inputline, "%d", &PUMPING_SIMULATED);

if (PUMPING_SIMULATED)
{

getline(fp, inputline, 100);

sscanf(inputline, "%lf %lf %lf", &PUMPING_LENGTH,

&PUMP_WAIST, &PUMP_POS);

}

getline(fp, inputline, 100);
/*
sscanf(inputline, "%s", summaryfilename);
if(!isalpha(summaryfilename[0]))

printf("%s\n",inputline);

*/

summaryfilename = SUMMARY_FILENAME_DEFAULT;

printf("summaryfilename = ’%s’\n", summaryfilename);

getline(fp, inputline, 100);

printf(":%s:\n",inputline);
if(isdigit(inputline[0]))

sscanf(inputline, "%d", &n_seed);

printf("n_seed = %d\n", n_seed);

getline(fp, inputline, 100);

printf(":%s:\n",inputline);
if(isdigit(inputline[0]))

sscanf(inputline, "%d", &WAIT_FRACTION_TENTHS);
printf("WAIT_FRACTION_TENTHS=%d\n", WAIT_FRACTION_TENTHS);
WAIT_FRACTION = (double)(((double) WAIT_FRACTION_TENTHS) / 10.);
/*
printf("WAIT_FRACTION=%g\n", WAIT_FRACTION);

WAIT_FRACTION = 5./10.;

*/

getline(fp, inputline, 100);
if(isdigit(inputline[0]))

sscanf(inputline, "%d", &GAUSSIAN_X);

printf("GAUSSIAN_X=%d\n", GAUSSIAN_X);

if(GAUSSIAN_X==0) INTERACTION_LENGTH = 1.772;
if(GAUSSIAN_X==0) effective_V_to_apparent_V = 1;

/* Sqrt(pi) */

175

{

}

{

}

{

}

{

}

{

}

/*

*/

/*

getline(fp, inputline, 100);
if(isdigit(inputline[0]))

sscanf(inputline, "%d", &VARIABLE_FINESSE);
printf("VARIABLE_FINESSE=%d\n", VARIABLE_FINESSE);

getline(fp, inputline, 100);
if(isdigit(inputline[0]))

sscanf(inputline, "%d", &ADJUST_N_EFF);
printf("ADJUST_N_EFF=%d\n", ADJUST_N_EFF);

/*
/*

getline(fp, inputline, 100); */
printf("This line should be blank: %s\n", inputline); */

fclose(fp);

/* End of input from inputfile[K] */

/* compose output file names */

if ((fp=fopen(INDEX_FILE, "r"))==NULL)

fscanf(fp, "%d", &file_id);

file_id=0;
else
{

fclose(fp);

}

file_id++;
fp=fopen(INDEX_FILE, "w");
fprintf(fp, "%d\n", file_id);
fclose(fp);

sprintf(output_name, "%s.%d", OUTPUT_FILE, file_id);

sprintf(outputfilename, "%s.out", inputfile[K]);
printf("outputfilename = ’%s’\n", outputfilename);

sprintf(pnfilename, "%s.pn", inputfile[K]);
printf("pnfilename = ’%s’\n", pnfilename);

176

if (GENERATE_PHOTON_FILE)

sprintf(photon_file_name, "%s.%d", PHOTON_FILE, file_id);

*/

if (GENERATE_PHOTON_FILE)

sprintf(photonfilename, "%s.pho", inputfile[K]);

sprintf(statusfilename, "%s.stat", inputfile[K]);

time(&tp);
sprintf(output_time, "%s", ctime(&tp));

for(g_multiplier=0.1; g_multiplier <= 4.0; g_multiplier += 0.1)
/*
{

printf("g_multiplier = %g\n", g_multiplier);

for(g_multiplier=2.27; g_multiplier <= 2.3; g_multiplier += 0.1) */

/* calculate real world parameters */
z0=sqrt(r0*L/2.);
fsr=3.e4/2./L;
_w0=sqrt(lambda*10.*z0/PI);
f=3./4.*sqr(lambda/PI/_w0)*1.e-6;
_Gc_over_2pi=fsr/finesse/1.e6;

/* in MHz */

/* in cm */

/* in micron */

/* finesse */

/* in MHz */

_g_over_2pi=sqrt(2./PI*fsr*f*Ga_over_2pi/1000.); /* in MHz */
_beam_radius=D/2./_w0;

/* in _w0 */

if (!(STANDING_WAVE))
{

_g_over_2pi /= 2;

/* traveling wave correction - changed from */

}

/* sqrt(2) to 2 by CFY

*/

_g_over_2pi *= g_multiplier;

/* parameters normalized to "2g" */
_Ga_over_2g=Ga_over_2pi/1000./2./_g_over_2pi;

/* find fastest rate and determine dt0 */
X=(_g_over_2pi > _Ga_over_2g) ? _g_over_2pi : _Ga_over_2g;
X=(X > _Gc_over_2pi) ? X : _Gc_over_2pi;
dt0=_g_over_2pi/X*dt0_init;

printf("**** X=%g, _g_over_2pi=%g, dt0_init=%g\n", X,

_g_over_2pi, dt0_init);

/* #ifndef LINUX */ /* amj */

177

/*

effective_V_to_apparent_V= 1;
/* amj change (double)volume_ratio() to 1 jul 14,98 */
/* CFY comments it out */

*/

/* used in delta_t and <N> calculations */
/* #endif */ /* amj */

/* generate header information */
for (i=0; i<3; ++i)
{

if (i==0)

{ fp=fopen(outputfilename, "w");

fprintf(fp, "# This file was generated by qt%d on %s\n",

VERSION, output_time);

}
else

if (i==1)
{
fprintf(fp,

fp=fopen(QT_LOG, "a");

"#Qt%d-%d generated %s with the following parameters on %s\n#\n",
VERSION, REVISION, outputfilename, output_time);

}

else

if (i==2)

fp=stderr;

fprintf(fp, "###########################################################\n");
fprintf(fp,

"# Ga/2pi=%.1lf kHz lambda=%.1lf nm

r0=%.1lf cm\n",

w0=%.1lf micron f=%.2le\n",

Ga_over_2pi, lambda, r0);
fprintf(fp, "# length=%.3lf cm finesse=%.1lf million\n", L, finesse);
fprintf(fp, "# z0=%.3lf cm
z0, _w0, f);
fprintf(fp, "# Gc/2pi=%.6lf MHz g/2pi=%.3lf MHz\n",
_Gc_over_2pi, _g_over_2pi);
fprintf(fp, "# max_photon_size=%d max_atoms=%d\n",
_max_photon_size, _max_atoms);
fprintf(fp, "# 2g*dt (initial)=%.2le tot_atom_count=%d\n",
dt0, tot_atom_count);
fprintf(fp, "# effective_V_to_apparent_V=%.3le\n", effective_V_to_apparent_V);

fprintf(fp, "# Gaussian along x & y\n");
if (STANDING_WAVE)

fprintf(fp, "# stang-wave mode along z\n");

else

fprintf(fp, "# traveling-wave mode along z with tilt=%.1lf mrad

(nonzero_tilt=%d).\n", tilt_angle, nonzero_tilt);

178

fprintf(fp, "# interaction length along x=%.3lf\n", INTERACTION_LENGTH);

if (CIRCULAR_BEAM)
fprintf(fp, "# Circular atomic beam w/ diameter=%.3lf\n", D);
else
fprintf(fp, "# Rectangular atomic beam w/ beam half height=%.3lf\n",
REC_HALF_HEIGHT);

if (!(MONO_VELOCITY))
{
if (USE_MAXWELL_BOLTZMANN)
fprintf(fp,
"# Maxwell-Boltzmann velocity distr is used.\n");
else
fprintf(fp,
"# Lorentzian
with dv(FW)=%.3lf and velocity peak v0=%.3lf\n", _delta_v, _v0);
}
else fprintf(fp, "# Mono velocity is assumed.\n");

convoluted with Maxwell-Boltzman velocity distr is used

#ifdef REUSE_C_ARRAY
fprintf(fp, "# reuse C[] array=%d\n#\n", USE_LAST_C_ARRAY);
#endif

if (PUMPING_SIMULATED)

{

/* _omega_Rabi=dimensionless, in 2g unit, pi pulse */

_omega_Rabi=PI/_t_int/PUMP_WAIST;

/* CFY un-comments this line */

if ((INTERACTION_LENGTH+PUMPING_LENGTH)/2. > PUMP_POS)
PUMPING_EFFECT_ON=1;
else PUMPING_EFFECT_ON=0;

PUMPING_EFFECT_ON=0;

/*

********

CFY for test ******

*/

fprintf(fp, "# Pumping process is simulated:\n");
fprintf(fp, "#

pumping length=%.3lf pump waist=%.3lf

pump pos=%.3lf\n",

PUMPING_LENGTH, PUMP_WAIST, PUMP_POS);

}

if (INCLUDE_ATOM_DECAY)
fprintf(fp, "# Atom spontaneous emission included.\n");

if (INCLUDE_D_STATE_DECAY)

179

fprintf(fp, "# D-state branching included.\n");

#ifdef USE_RK4_ALGORITHM
fprintf(fp, "# RK4 algorithm used.\n");
#endif

if (i<2) fclose(fp);

}

if (GENERATE_PHOTON_FILE)
{
fp=fopen(photonfilename, "w");
fprintf(fp, "# This file was generated by qt%d on %s\n",

VERSION, output_time);
fclose(fp);
}

/* Check array size */
max_k=two_to(_max_atoms);
C_size=(long)(_max_photon_size)*max_k;
total_array_size=C_size*sizeof(double)*8 /* display purpose */

+(long)( (_max_atoms+1)*A_INFO_ITEMS)*sizeof(double)

+(long)(_max_atoms+1)*max_k*sizeof(double);
if (total_array_size > MAX_MEMORY)
{
Reduce it below %ld kB.\n", total_array_size/1024L, MAX_MEMORY/1024L);

fprintf(stderr, "# Too large array size (%ld kB).

exit(1);
}

/* reserve memory space for _C[] */
_C=(double *)malloc(C_size*sizeof(double)); /* real part only */
_D=(double *)malloc(C_size*sizeof(double));
_C_1=(double *)malloc(C_size*sizeof(double));
_D_1=(double *)malloc(C_size*sizeof(double));
_Pn_dist=(double *)malloc(_max_photon_size*sizeof(double));
_Pn_dist_mean=(double *)malloc(_max_photon_size*sizeof(double));
_Pn_dist_mean_beginning=(double *)malloc(_max_photon_size*sizeof(double));
_detuning_sum=(double *)malloc(max_k*sizeof(double));
_bits=(double **)malloc(max_k*sizeof(double));
for (i=0; i<max_k; ++i)

/* imaginary part only */

_bits[i]=(double *)malloc(_max_atoms*sizeof(double));

#ifdef USE_RK4_ALGORITHM
_C_2=(double *)malloc(C_size*sizeof(double));

180

_C_3=(double *)malloc(C_size*sizeof(double));

_D_2=(double *)malloc(C_size*sizeof(double));
_D_3=(double *)malloc(C_size*sizeof(double));
#endif

for (i=0; i<2; ++i)
{

if (i==0) fp=fopen(outputfilename, "a");

else fp=stderr;
fprintf(fp, "# total array size=%ld kBytes\n",

total_array_size/1024L);

if (i==0) fclose(fp);

}

/* initialize rand() */
#ifdef RANDOM_INIT

srand((int)time(&tp));

#else

srand(1);
#endif

#endif

#ifdef REUSE_C_ARRAY

if (USE_LAST_C_ARRAY) read_status_file()

for (m=0; m<num_N_eff; ++m) {

/********* N_eff[m] loop *********/

for (i=0; i<3; ++i)
{

if (i==0) fp=fopen(QT_LOG, "a");

else if (i==1) fp=fopen(outputfilename, "a");
else if (i==2) fp=stderr;
fprintf(fp,

"#------------------------------------------------\n");

fprintf(fp,

"# %s\n", inputfile[K]);

fprintf(fp, "# <N>=%.3lf \n", N_eff[m]);
if (i<2) fclose(fp);

}

for (mm=0; mm<num_u_th; ++mm)
{

_u_th=u_th[mm];
if (USE_MAXWELL_BOLTZMANN)

/********* u_th[mm] loop *********/

_v0=1;

/* amj june 15, 98 */

181

if (MONO_VELOCITY)

_v0=1;

/* amj jul 14, 98 */

if (GAUSSIAN_X)

t_int=sqrt(PI)*_w0/(_v0*_u_th);

/* Based on Rabi oscillation, not on mode volume(smaller by sqrt(2)).
/* In microsec */

else t_int= sqrt(PI)*_w0/(_v0*_u_th);

/* amj change
/* amj multiply
/* distribution in units of _u_th */

_u_th by

_v0

2.*_w0/(_v0*_u_th); to sqrt(PI)*_w0/(_v0*_u_th); jul 14,98 */

June 15, 98 _v0 is peak of velocity */

/* parameters normalized to "2g" */
_t_int=t_int*2.*_g_over_2pi*2.*PI;

if(VARIABLE_FINESSE)

{

}

_Gc_over_2pi=(_u_th/u_th[0]) * fsr/finesse/1.e6;
printf("**** _Gc_over_2pi=%g\n",_Gc_over_2pi);

/* in MHz */

/* Doppler shift due to tilt for v=u_th in 2g unit, including zero tilt */

mean_shift=(_v0*_u_th)/lambda*sin(tilt_angle/1000.)*1000.;

/* in MHz */

_mean_shift_over_2g=mean_shift/(2.*_g_over_2pi);

/* amj change _u_th to _v0*_u_th

June 15, 98 */

/* _v0 is peak of velocity distribution */

for (i=0; i<3; ++i)
{

if (i==0) fp=fopen(QT_LOG, "a");

else if (i==1) fp=fopen(outputfilename, "a");
else if (i==2) fp=stderr;
fprintf(fp,

fprintf(fp, "# _u_th=%.3lf

"#------------------------------------------------\n");
t_int=%.3lf microsec\n",

fprintf(fp, "# mean transverse Doppler shift=%.3lf\n",

if (nonzero_tilt)

if (i<2) fclose(fp);

}

_u_th, t_int);

mean_shift);

182

/* delta_t is the mean time interval between atoms in microsec */
/* based on weighted volume integral */

delta_t=t_int/N_eff[m];

*/

/* amj change
/* INTERACTION_LENGTH*effective_V_to_apparent_V*_w0/(_v0*_u_th)/N_eff[m]; */
/* to t_int/N_eff[m];
/* amj change _u_th to _v0*_u_th
/* _v0 is peak of velocity distribution in units of _v_th*/

jul 14,98 */

June 15, 98

*/

/* normalized to 2g */
_Delta_t=delta_t*2.*PI*_g_over_2pi*2.;

for (i=0; i<2; ++i)
{

if (i==0) fp=fopen(outputfilename, "a");

else fp=stderr;
fprintf(fp,

if (i==0) fclose(fp);

}

"# 2g*t_int=%.2le

2g*Delta_t=%.2le\n", _t_int, _Delta_t);

/*********************** core loop ******************************/
for (mmm=0; mmm<num_detuning; ++mmm)
{ /** detuning[mmm] loop **/

/* readjust dt considering detuning effect */
if (nonzero_tilt)
{

/* detuning[] measured in _mean_shift_over_2g unit */

_CA_detuning=detuning[mmm]*_mean_shift_over_2g;
dt=dt0/sqrt(sqr(_CA_detuning-_mean_shift_over_2g)+ 1.);

printf("dt=%g\n",dt);

}

}

else
{

/* detuning[] measured in MHz */

_CA_detuning=detuning[mmm]/(2*_g_over_2pi);
dt=dt0/sqrt(sqr(_CA_detuning)+1.);

for (i=0; i<3; ++i)
{

if (i==0) fp=fopen(QT_LOG, "a");

else if (i==1) fp=fopen(outputfilename, "a");
else if (i==2) fp=stderr;
fprintf(fp,

"#------------------------------------------------\n");

if (nonzero_tilt)

183

fprintf(fp,

"# detuning=%g (v/lambda*theta) or %g MHz

dt(initial)=%g\n\n",

detuning[mmm], detuning[mmm]*mean_shift, dt);
else
fprintf(fp, "# detuning=%g MHz
detuning[mmm], dt);
fprintf(fp,
"# t

Mandel_Q

n2_aver

n_aver

dt(initial)=%g\n\n",

/* amj change dn_aver to Mandel_Q and add

n2_aver

*/

P_N_mode

atom_count\n");

if (i<2) fclose(fp);

}

/* start benchmark clock */
T1=clock();

/* initialize */
for (i=0; i<=_max_atoms; ++i) P_atom[i]=0;
for (i=0; i<_max_photon_size; ++i) _Pn_dist_mean[i]=0.;
for (i=0; i<_max_photon_size; ++i) _Pn_dist_mean_beginning[i]=0.;

if (!(USE_LAST_C_ARRAY)) {
/* Initialize _C[] arrays to zero */
for (ii=0; ii<C_size; ++ii) {_C[ii]=0.; _D[ii]=0.;}

/* initially vacuum + no atoms */
/* _C[0]=1.;

*/

_C[n_seed] = 1.;

/* Seed with n_seed photons! */

/* initialize _C[] using one-atom micromaser theory
C_from_micromaser_theory(N_eff[m], a_coeff, b_coeff); */
_N_atom=0;

t=0.; /* simulation starts from t=0 by default. If last C[] used,
t is the last time in the previous simulation. */
}

t=0.; /* initial time of new simulation */
Ti=t;
next_entry_time=t;

/* time averaging begins when t>Ti2 */
Ti2=Ti+_Delta_t*(double)(tot_atom_count)*WAIT_PORTION_BEFORE_AVERAGING;

184

Ti2new = Ti+_Delta_t*(double)(tot_atom_count)* 0.1;

/* initialize count variables */
atom_count=0; /* number of atoms injected */
atom_count_since_Ti2=0; /* number of atoms injected since t=Ti2 */
photon_count=0; /* number of photons emitted */
too_many_atom_count=0; /* number of atoms fail to be injected */
num_excited_injected_atoms=0.; /* sum of excited state probabilities

of injected atoms */

num_excited_exiting=0; /* number of exiting atoms in excited state */

if (INCLUDE_ATOM_DECAY) spont_count=0; /* number of spont emission decays */
if (INCLUDE_D_STATE_DECAY) d_state_decay_count=0;

/* amj This is supposed to

/* initialize averaged variables */
n_mean=0.;
n2_mean=0.;
Mandel_Q=0.;
n_aver=0.; /* time averaged mean photon number */
n2_aver=0.; /* amj change dn_ave to n2_ave */

/* amj add
/* amj add */

*/

initialized */

/* time averaged variance of photon number */

n_sum=0.;
n2_sum=0.;

/* amj change dn_sum to n2_sum */

emission_prob=0.; /* averaged ratio number of emitted photons
to total number of injeced atoms */

vacuum_time=0.;
num_dt_steps=0;

/* simulation starts at t=Ti, averaging begins at t=Ti2 */
do {
if (t>=next_entry_time) {

excited_state_prob=inject_new_atom(t);
if (excited_state_prob<0.)

/* amj */

{

too_many_atom_count++;
printf("** count = %d out of %d (%.2g%%)\n", too_many_atom_count, atom_count,

}
/* inject_new_atom() returns negative value if not successful to inject an atom.

Otherwise, returns excited state probability */

else if(excited_state_prob>99) atom_decay_to_d_count++; /*amj
else { /* successful injection */

atom_count++; /* number of successfully injected atoms */

if decay to d state

185

/* fprintf(stderr, ".");
if (t>=Ti2) {

amj

*/

atom_count_since_Ti2++;
num_excited_injected_atoms+=excited_state_prob;

}
/* user can stop execution */

#ifdef CLICK_INTERRUPT /* Macintosh specific */

if (key_pressed()) {

fprintf(stderr, "Stop now? (stop=1, continue=0)\n");

C

scanf("%d", &stop_now);

if (stop_now) break;

}
#endif
}

_max_k=two_to(_N_atom); /* update _max_k */
next_entry_time = t + get_arrival_time();

if (DEBUG_LEVEL>1)

printf("N=%d created at t=%lf and will exit at t=%lf.

Next new arrival at t=%lf\n\n",

_N_atom, t, _A_info[_N_atom][2], next_entry_time);

} /* end of adding a new atom */

if (_N_atom>0) {
/* coherent evolution of wavefunction */
evolve_wave_function(dt, t);
/* only when there is at least one atom */
t+=dt;

/* take care of atomic spontaneous emission */
if (INCLUDE_ATOM_DECAY) {
if (t<Ti2) how_many_atoms_decay(dt);
else spont_count+=how_many_atoms_decay(dt);
}

/* check for D-state decay */
if (INCLUDE_D_STATE_DECAY) {
if (t<Ti2) how_many_d_state_decay(dt);
else d_state_decay_count+=how_many_d_state_decay(dt);
/* once decayed to D state the
atom is not interacting with field */
}

/* check for exiting atom */

186

for (i=1; i<=_N_atom;) {
if (_A_info[i][2] < t) { /* remove ith atom */
if (DEBUG_LEVEL>1)
printf("Removing %d-th atom at t=%lf out of %d\n", i, t, _N_atom);
if (t<Ti2) remove_atom(i);
else num_excited_exiting+=remove_atom(i);
/* remove_atom() returns 1 if

the atom leaves the cavity in

the excited state */
_max_k=two_to(_N_atom); /* update _max_k */
}
else i++;
}
} /* if _N_atom>0 */
else t+=dt; /* no evolution if no atom there */
num_dt_steps++;

/* check for cavity decay */
if ((_N_atom==0)&&(n_mean<VERY_SMALL)) { /* complete vacuum */
big_dt=next_entry_time-t;
vacuum_time+=big_dt;
P_atom[0]+=(long)(big_dt/(float)dt);

/*amj put float to avoid getting smaller values.

CFY: ??? */

_Pn_dist_mean[0]+=big_dt/dt;
big_dt=big_dt/(float)dt;
t+=(long)big_dt*dt; /* amj */ /* nothing happens until
next atom comes in */
num_dt_steps+=(long)big_dt; /* amj */
}
else { /* not vacuum, equal stepsize dt */

if (cavity_decay_occurs(dt, &n_mean, &n2_mean))

{/* amj add

&n2_mean */

if (t>=Ti2) photon_count++;
if (GENERATE_PHOTON_FILE &&

(atom_count > tot_atom_count * WAIT_FRACTION )) {

fp=fopen(photonfilename, "a");
fprintf(fp, "%d
fclose(fp);

%lf\n", photon_count, t);

}

}

((float)tot_atom_count * WAIT_FRACTION) && t>=next_entry_time)

*/

/* if(atom_count == (floor)

n_sum+=n_mean;

187

}

}

/*

}

}

/* printf("n_mean = %g\n", n_mean);
printf("n_sum = %g\n", n_sum);

*/

n2_sum+=n2_mean;

/* amj using average over "10"

atoms */

/* P_atom is updated from t=Ti, not Ti2 */
P_atom[_N_atom]++;

/* meaningful for equal size steps */

if (t>=Ti2) {

/* cumulative averag */
/* n_aver=n_sum/(t-Ti2); amj */
/*n2_aver=n2_sum/(t-Ti2) ;*/

and d2_sum to n2_sum */

/* amj change dn_aver to n2_aver

emission_prob=(double)photon_count/(double)atom_count_since_Ti2;
/* Mandel_Q=n2_aver/n_aver-n_aver-1.; amj */

/* amj */

if((atom_count%100 == 0 && (atom_count<1000)))

printf("atom count=%d\n", atom_count);

*/

if((atom_count == 100) && (t>=next_entry_time))

{ T2=clock();

time_elapsed = (T2-T1)/CLOCKS_PER_SEC;
printf("100 atoms in %g sec.

Estimated time for %d atoms:

%g sec (%.2g hours)\n", time_elapsed, tot_atom_count,
time_elapsed*(double)tot_atom_count/100,
time_elapsed*(double)tot_atom_count/100/3600);

if(atom_count == (floor) ((float)tot_atom_count * WAIT_FRACTION)
&& t>=next_entry_time)

{

printf("Skipping the first %d atoms for P_n distribution and Q.\n",

(int) (floor) ((float)tot_atom_count * WAIT_FRACTION));

for (i=0; i<_max_photon_size; ++i)

{

_Pn_dist_mean_beginning[i] = _Pn_dist_mean[i];

/*

printf("%d %g\n", i,

_Pn_dist_mean_beginning[i]/((t-Ti)/dt));
/*

printf("%g %g\n", t,Ti); */
}

*/

if(ADJUST_N_EFF && (atom_count == (floor) ((float)tot_atom_count
* WAIT_FRACTION/2.) && t>=next_entry_time))

{ printf("Skipping the first %d atoms for calibrating N_atom.\n",

188

(int) (floor) ((float)tot_atom_count * WAIT_FRACTION/2.));

/* Calculate intracavity atom number distribution */
P_sum=0.; /* sum of P_atom[] */
P_N_mean=0.;
for (i=0; i<=_max_atoms; ++i) {

P_sum+=(double)P_atom[i];

/* P_atom[] updated during above simulation

*/

}
for (i=0; i<=_max_atoms; ++i)

P_N_mean+=(double)i*(double)P_atom[i];

P_N_mean/=P_sum;

printf("P_N_mode=%g\n",P_N_mean * effective_V_to_apparent_V);

if(ADJUST_N_EFF)

{

new_N_eff = N_eff[m] /

(P_N_mean * effective_V_to_apparent_V / N_eff[m]);

delta_t=t_int/new_N_eff;
_Delta_t=delta_t*2.*PI*_g_over_2pi*2.;

printf("new_N_eff=%g, delta_t=%g\n", new_N_eff, delta_t);

if(ADJUST_N_EFF)

}

{

}

}

_Gc_over_2pi=(_u_th/u_th[0]) * (fsr/finesse/1.e6) *

(P_N_mean * effective_V_to_apparent_V / N_eff[m]);

printf("Gc multiplied by %g\n",

P_N_mean * effective_V_to_apparent_V / N_eff[m]);

printf("**** _Gc_over_2pi=%g\n",_Gc_over_2pi);

#ifdef SHOW_PROGRESS
if ((DEBUG_LEVEL>0)|| ((!(atom_count%1000))&&

(t>=next_entry_time)))

{
num_dt_aver_steps=(double)(num_dt_steps-num_dt_aver_steps_last);
/* amj */

/* amj mun_dt_aver_steps # of dt over which n_aver is found */

n_aver=n_sum/num_dt_aver_steps;
n2_aver=n2_sum/num_dt_aver_steps;

/* amj */
/* amj */

189

Mandel_Q=n2_aver/n_aver-n_aver-1.;

/* amj */

/* Calculate intracavity atom number distribution */
P_sum=0.; /* sum of P_atom[] */
P_N_mean=0.;
for (i=0; i<=_max_atoms; ++i)
P_sum+=(double)P_atom[i];

for (i=0; i<=_max_atoms; ++i)

P_N_mean+=(double)i*(double)P_atom[i]/P_sum;

for (i=0; i<2; ++i)

{
if (i==0) fp=fopen(outputfilename, "a");
else fp=stderr;

fprintf(fp, " %.6le %.6le %.6le %+.6le %g %14d\n",

t, n_aver, n2_aver, Mandel_Q,
effective_V_to_apparent_V*P_N_mean, atom_count) ;

/* output */
if (i==0) fclose(fp);

}

/*

printf("num_dt_aver_steps=%g\n", num_dt_aver_steps);

printf("n_sum=%g\n", n_sum);
printf("n_aver=%g\n", n_aver);
num_dt_aver_steps_last=(double)num_dt_steps;

*/

/* amj seting for next time */

n_sum=0;
n2_sum=0;

}
#endif

/* amj */
/* amj */

/*****************************************************************/
/*if (!(num_dt_steps%(long)(0.05/dt)))
printf("%le %le %le\n", t, sqr(_C[1])+sqr(_D[1]), sqr(_C[3])+sqr(_D[3]));*/
/*****************************************************************/

/* amj test starts jul 27, 98 */
/*
for (i=0; i<2; ++i)

{

if (i==0)

fp=fopen(outputfilename, "a");

else fp=stderr;
fprintf(fp, "%lf
for (ii=0; ii<=5; ++ii)

", t) ;

190

fprintf(fp, "%lf

%lf

", _C[ii],

_D[ii]);

printf("\n");
if (i==0) fclose(fp);

}

*/
/* amj test endss jul 27, 98 */

} while (atom_count<=tot_atom_count);

/* ******* END OF SIMULATION RUN ********** */

fprintf(stderr, "\n");
atom_count--; /* simulation stops at last atom entry time */
Ti=0.;

", _A_info[ii][i]);

if (DEBUG_LEVEL>1) {
printf("*** Contents of _A_info[]...\n");
for (ii=1; ii<=_N_atom; ++ii) {
for (i=0; i<6; ++i) printf("%lf
printf("\n");
}
printf("*** Contents of _C[]...\n");
for (i=0; i<=1; ++i) {
for (ii=0; ii<=4; ++ii)
printf("%lf
printf("\n");
}
}

", _C[ii*_max_photon_size+i]);

/* Calculate intracavity atom number distribution */
P_sum=0.; /* sum of P_atom[] */
P_N_mean=0.;
for (i=0; i<=_max_atoms; ++i) {
P_sum+=(double)P_atom[i];
/* P_atom[] updated during above simulation
}

*/

for (i=0; i<=_max_atoms; ++i) P_N_mean+=(double)i*(double)P_atom[i];
P_N_mean/=P_sum;

/* Subtract _Pn_dist_mean_beginning here */

191

for (i=0; i<_max_photon_size; ++i) _Pn_dist_mean[i] -=

_Pn_dist_mean_beginning[i];

/* global variable _Pn_dist_mean[] was updated since t=Ti */
for (i=0; i<_max_photon_size; ++i)
_Pn_dist_mean[i]/=(t-Ti)*(1-WAIT_FRACTION)/dt;

/* stop benchmark clock */
T2=clock();

/* averaging stuff taken from "SHOW_PROGRESS" routine */

num_dt_aver_steps=(double)num_dt_steps-num_dt_aver_steps;

/* amj num_dt_aver_steps # of dt over which n_aver is found */

n_aver=n_sum/num_dt_aver_steps;

n2_aver=n2_sum/num_dt_aver_steps;

Mandel_Q=n2_aver/n_aver-n_aver-1.;

/* Notifying key informations on data */
for (i=0; i<3; ++i) {
if (i==0) fp=fopen(QT_LOG, "a");
else if (i==1) fp=fopen(outputfilename, "a");
else fp=stderr;

fprintf(fp, "# %lf sec taken...\n", (T2-T1)/CLOCKS_PER_SEC);
fprintf(fp, "# %d atoms successfully injected and %d atoms
used for time averaging.\n",
atom_count, atom_count_since_Ti2);
fprintf(fp, "# %d atoms (%g%%) were neglected due to overflow
of atoms during entire simulation\n",
too_many_atom_count,

100*(float)too_many_atom_count/(float)atom_count);

fprintf(fp, "# %d photons decayed during 2gT=%g (averaging time)\n",
photon_count, t-Ti2);
fprintf(fp, "# %d atoms exit the cavity in excited state during
entire simulation.\n",
num_excited_exiting);
fprintf(fp, "# Effective number of excited atoms was %g during

192

entire simulation.\n",
num_excited_injected_atoms);
fprintf(fp, "# Pumping efficiency was %g\n",
num_excited_injected_atoms/
(double)atom_count_since_Ti2);

if (INCLUDE_ATOM_DECAY)

spont_count);

fprintf(fp, "# %d atoms undergone spontaneous emission during averaging\n",

if (INCLUDE_D_STATE_DECAY)
fprintf(fp, "# %d atoms decayed to 1D2 state during averagin\n",
d_state_decay_count);

fprintf(fp, "# <n>=%g
n_aver, Mandel_Q, emission_prob);

Mandel Q=%g

emission_prob=%g\n",

Gc_final[mmm]=(double)photon_count/n_aver/(t-Ti2)*2.*_g_over_2pi;

fprintf(fp,

"# From simulation, 2g*Delta_t(sim)=%lf and Gc/2p(sim)=%lf MHz\n",

(t-Ti)/(double)atom_count, Gc_final[mmm]);

fprintf(fp, "# During simulation, the cavity was completely

empty for %.3lf percent of time.\n", vacuum_time/(t-Ti)*100.);

"# P(N) distribution averaged for entire simulation\n");
"# Compared with Poisson distribution\n");

fprintf(fp,
fprintf(fp,
p_poisson = exp(-1*N_eff[m]/effective_V_to_apparent_V
for (j=0;j<=_max_atoms; ++j)

);

{

if(j!=0)

p_poisson *= (N_eff[m] /effective_V_to_apparent_V)/ (float) j;
fprintf(fp, "%d %lf %lf\n", j, (double)P_atom[j]/P_sum, p_poisson);

}

/* fprintf(fp,"# P_n distribution averaged for simulation\n");
final_n_avg = 0;
final_n2_avg = 0;
final_normalize = 0;

*/

for (j=0;j<_max_photon_size; ++j)

{ /* fprintf(fp, "%d %lf\n", j, (double)_Pn_dist_mean[j]); */

final_n_avg += (double) j * (double)_Pn_dist_mean[j];
final_n2_avg += (double) j * (double) j * (double)_Pn_dist_mean[j];
final_normalize += (double)_Pn_dist_mean[j];

193

}

final_n_avg /= final_normalize;
final_n2_avg /= final_normalize;

fprintf(fp, "\n# <n> = %g, <n^2>=%g, Q=%g\n\n",
final_n_avg, final_n2_avg, (final_n2_avg -
final_n_avg*final_n_avg - final_n_avg)/final_n_avg);

fprintf(fp, "# normalization was Sum(P_n) = %g\n", final_normalize);

fprintf(fp, "# Averaged apparent number of atoms in
BEAM_AREA*INTERACTION_LENGTH=%g\n", P_N_mean);

P_N_mode=effective_V_to_apparent_V*P_N_mean;

fprintf(fp, "# Averaged effective number of atoms in mode
volume=%g\n\n", P_N_mode);

if (i<2) fclose(fp);

n_final[mmm]=n_aver;
Q_final[mmm]=Mandel_Q;
N_final[mmm]=P_N_mode;
}

/*

SAVE SUMMARY INFORMATION

*/

fp = fopen(summaryfilename, "a");
time(&tp);
sprintf(output_time, "%s", ctime(&tp));

fprintf(fp, "# %s %s", inputfile[K], output_time);
fprintf(fp,

"# N_eff, Finesse, N_eff * Finesse, <n>, Q, det, u_th, N_ex,
theta_pump, g_mult\n");

printf("_Gc_over_2pi=%g, t_int=%g \n", _Gc_over_2pi, t_int);
N_ex = P_N_mode / ( _Gc_over_2pi * 2*pi * t_int);
theta_pump = sqrt(N_ex) * _t_int / 2.;

fprintf(fp, "%g %g %g %g %g %g %g %g %g %g\n",
P_N_mode, finesse, P_N_mode * finesse,
final_n_avg, (final_n2_avg - final_n_avg*final_n_avg -

final_n_avg)/final_n_avg, detuning[mmm],

194

_u_th, N_ex, theta_pump, g_multiplier);

fclose(fp);

/* WRITE PN DISTRIBUTION */
fp = fopen(pnfilename, "w");

for (j=0;j<_max_photon_size; ++j)

{ fprintf(fp, "%d %lf\n", j, (double)_Pn_dist_mean[j]);
}

fclose(fp);

printf("P_n distribution written to ’%s’\n", pnfilename);

}
/***************** detuning[mmm] loop ******************/
/* generate summary sheet */
if (num_detuning>1) {
for (i=0; i<3; ++i) {
if (i==0) fp=fopen(QT_LOG, "a");
else if (i==1) fp=fopen(outputfilename, "a");
else fp=stderr;

fprintf(fp, "detuning <n> Q G_c <N>\n");
for (mmm=0; mmm<num_detuning; ++mmm) {
fprintf(fp, "%.3le %.3le %.3le %.3le %.3le\n",
detuning[mmm], n_final[mmm], Q_final[mmm], Gc_final[mmm],
N_final[mmm]);
}

/***************** N_u_th[mm] loop ******************/
/***************** N_eff[m] loop ******************/

}
}
/* write_status_file(); */

if (i<2) fclose(fp);
}
}

/*

free(_C);
free(_D);
free(_Pn_dist);
free(_Pn_dist_mean);
free(_bits);

195

CFY: free() is giving Seg Fault for higher N

free(_detuning_sum);

*/

/*

#ifdef USE_RK4_ALGORITHM
free(_C_1);
free(_C_2);
free(_C_3);
free(_D_1);
free(_D_2);
free(_D_3);
#endif

*/

}

}

/*

**************** GRAND LOOP ******************

*/

fprintf(stderr, "*** End of Run ***\n");
return 1;
}

void testroutine(void)
{

int hist[100];
int i, j, bin, npoints = 10000;
double arrt;

_Delta_t = 1.0;

for(i=0;i<100;i++)
hist[i]=0;

for(j=0;j<npoints;j++)

{

arrt = get_arrival_time();
bin = floor((arrt*20));

hist[bin]++;

/*

printf("hist[%d] =%d\n", bin, hist[bin]); */

196

for(bin=0;bin<100;bin++)

{

arrt = (double) bin /20.;

printf("%g %g %g\n", arrt, ((double)(hist[bin]))/

(npoints*_Delta_t/20.), exp(0 - arrt/_Delta_t)/_Delta_t );

int getline(FILE *ff, char *s, int lim)
{

int c, i;

for(i=0; i<lim-1 && (c=getc(ff))!=EOF && c!=’\n’; ++i)

}

}

exit(0);

s[i] = c;
if (c== ’\n’)
{

s[i] = c;
++i;

}
s[i] = ’\0’;
return i;

}

}

}

double get_arrival_time()
{

double gresult;

gresult= _Delta_t * log(1.0/(1.0 - drand()));
return gresult;

#ifdef REUSE_C_ARRAY
#include "status.c"
#endif

#include "newatom2-d.c"
#include "exitatom2-d.c"
#include "decay2-d.c"
#include "evolve2-2-d.c"
#include "spont2-d.c"
#include "pumping-d.c"
#include "d_state2-d.c"
#ifdef CLICK_INTERRUPT

197

#include "key_pressed.c"
#endif
/* #ifndef LINUX
#include "volume.c"
/* #endif */

/* amj */

*/

/* amj */

B.2 newatoms2-d.c

#define DELTA_T_MAX 10. /* in _Delta_t scale */
#define V_MIN 0.0
#define V_MAX 4.
#define A 2.43952

double get_velocity();

float get_height()
{
double a, b, bb, y;

if (!(CIRCULAR_BEAM)) y=REC_HALF_HEIGHT*drand();
if (CIRCULAR_BEAM) {
do {
a=drand();
b=sqrt(1.-sqr(a));
bb=drand();
} while (bb>b);
y=_beam_radius*a;
}
return y;
}

double inject_new_atom(double t)
{
double v, y, excited_prob;
long m, max_m;

void construct_C();

198

/* inject_new_atom() returns negative value if not successful to inject an atom

Otherwise, returns excited state probability */

/* amj

#ifdef PUMPING_SIMULATED *//* amj move this block to this position */

long two_to(int);
/* amj #ifdef PUMPING_SIMULATED */
void get_state_amplitude(double);
/* amj #endif */

_N_atom++;
/* if(_N_atom == 1) printf("First atom enters at time %g\n", t);

*/

*/

/* printf("%d ", _N_atom);
if (_N_atom > _max_atoms) {
fprintf(stderr, "Too many atoms! ");
fprintf(stderr, "t=%lf
_N_atom--; /* throw away this new atom */
excited_prob = -1.; /* negative means failure */
goto LAST_LINE;
}

", t);

/* get new atomic parameters */
if (MONO_VELOCITY) v=1.;
else v=get_velocity();

if(PUMPING_SIMULATED)

/* amj */

{

}

{

}
else

/* check overlap, include spont. emiss.

PUMP_POS, INTERACTION_LENGTH, PUMPING_LENGTH to be used

*/

/* _omega_Rabi=dimensionless, in 2g unit, pi pulse */
_omega_Rabi=PI*v/_t_int/PUMP_WAIST; /* amj */

if((PUMP_POS+PUMPING_LENGTH/2.) <= INTERACTION_LENGTH/2.)

_A_info[_N_atom][4]=1.;
_A_info[_N_atom][5]=0.;

/* ground state */
/* excited state */

get_state_amplitude(v);

/* amj #else */
else { /* amj */

_A_info[_N_atom][4]=cos(PI/2.*_v0/v);
_A_info[_N_atom][5]=-sin(PI/2.*_v0/v); /* excited state */

/* ground state */

199

/* amj add this block; for d state decayexcited_prob=100 */

} /*amj

*/

if(0)
{

exit(0);

}

printf("_A_info[_N_atom][4]=%g\n", _A_info[_N_atom][4] );
printf("_A_info[_N_atom][5]=%g\n", _A_info[_N_atom][5] );

/* CFY: change sign on sin and cos
/* #endif */

to agree with pumping-d.c */

excited_prob=sqr(_A_info[_N_atom][5]);

if(excited_prob>99) {
_N_atom--; /* throw away this new atom */
goto LAST_LINE;
}

if (GAUSSIAN_Y) y=get_height();
else y=0.;
_A_info[_N_atom][0]=v;
_A_info[_N_atom][1]=t; /* arrival time in 1/2g */

/* in u_th */

_A_info[_N_atom][2]=t+INTERACTION_LENGTH*_w0/(v*_u_th)
*2.*_g_over_2pi*2.*PI;
/* in 1/2g */
_A_info[_N_atom][3]=1.;
if (STANDING_WAVE)
_A_info[_N_atom][3] *=sin((drand()-0.5)*PI);

if (GAUSSIAN_Y) {
if (sqr(y)>10.) _A_info[_N_atom][3]=0.;
else _A_info[_N_atom][3] *=exp(-sqr(y));
}

_A_info[_N_atom][6]=y; /* vertical position */

/* Construct new coefficients _C[] */
max_m=two_to(_N_atom-1)*_max_photon_size;

200

for (m=0; m<max_m; ++m) {
_C[m+max_m]=_C[m]*_A_info[_N_atom][5];
_C[m]*=_A_info[_N_atom][4];
_D[m+max_m]=_D[m]*_A_info[_N_atom][5];
_D[m]*=_A_info[_N_atom][4];
/*
printf("_C[%ld]=%lf
m, _C[m], m+max_m, _C[m+max_m]);
*/
}
LAST_LINE:
return excited_prob;
}

_C[%ld]=%lf\n",

/*
double get_arrival_time_old()
{
double x, y, yy;
do {
x=drand()*DELTA_T_MAX;
y=drand();
if (x<10.) yy=exp(-x);
else yy=0.;
} while (y>yy);
return x*_Delta_t;
}
*/

double get_velocity()
{
double x, x2, y, yy;

if (USE_MAXWELL_BOLTZMANN) do {
x=(V_MAX-V_MIN)*drand()+V_MIN;
y=drand();
x2=sqr(x);
if (x2<10.) yy=exp(-x2);
else yy=0.;
yy*=A*(x*x2);
} while (y>yy);

else do {

201

x=(V_MAX-V_MIN)*drand()+V_MIN;
y=drand();
x2=sqr(x);
yy=A*x*x2*exp(-x2)/(1+sqr(2*(x-_v0)/_delta_v));

} while (y>yy); /* amj changes this block */

return x;
}

long two_to(int n)
{
long x=1L;
int i;

if (n<0) {
fprintf(stderr, "Error in two_to()\n");
exit(1);
}
for (i=0; i<n; ++i) x *=2L;
return x;
#undef V_MIN
#undef V_MAX

B.3 exitatom2-d.c

void exchange_atom_with_last_one(int p)
{
long max_k, mask, k, new_k, new_m0, old_m0;
int j, bits[MAX_NUM_ATOM];
double C_tmp, D_tmp;

/* exchange p-th atom with the last atom */
if (p<_N_atom) {
/*
printf("First exchanging %d-th atom with %d-th one\n",
p, _N_atom);
*/

/* re-ordering of _C[]*/
max_k=two_to(_N_atom-1);

202

for (k=0; k<max_k; ++k) {
/* evaluate bit patter of k */
mask=k;
for (j=1; j<=_N_atom; ++j) {
bits[j]=mask%2;
/* j-th atom state: 0=ground
mask/=2;
}
/*
printf("k=%ld --> ", k);
for (j=1; j<=_N_atom; ++j) {
printf("bits[%d]=%d
}
printf("\n");
*/

", j, bits[j]);

1=excited */

/* exchange bits[p] with bits[_N_atom]=0 */
bits[_N_atom]=bits[p];
bits[p]=0;

/* evaluate new k */
new_k=0;
for (j=1; j<=_N_atom; ++j) new_k+=bits[j]*two_to(j-1);

/*
printf("new_k=%ld --> ", new_k);
for (j=1; j<=_N_atom; ++j) {
printf("bits[%d]=%d
}
printf("\n");
*/

", j, bits[j]);

/* rename indices of _C[] */
if (!(new_k==k)) {
new_m0=new_k*_max_photon_size;
old_m0=k*_max_photon_size;

for (j=0; j<_max_photon_size; ++j) {
C_tmp=_C[new_m0+j];
_C[new_m0+j]=_C[old_m0+j];
_C[old_m0+j]=C_tmp;

D_tmp=_D[new_m0+j];
_D[new_m0+j]=_D[old_m0+j];

203

_D[old_m0+j]=D_tmp;
}

_C[%ld]=%lf\n\n",

/*
printf("_C[%ld]=%lf
new_m0, _C[new_m0], old_m0, _C[old_m0]);
*/
}
else {
/*
printf("Same k and new_k. Not exchanged.\n\n");
*/
}
}
/* re-order _A_info[][]*/
for (j=0; j<A_INFO_ITEMS; ++j)
_A_info[p][j]=_A_info[_N_atom][j];
}
}

int remove_atom(int p)
{
double A0;
long m, max_m;
int exiting_excited=0;

double normalize_C();

exchange_atom_with_last_one(p);

decide whether p-th atom, which is now _N_atom-th atom,

/*
leaves the cavity in excited or ground state */

/* If in ground state, do nothing. If in excited state,
take last half of _C[] */
if (is_excited(&A0)) {
max_m=two_to(_N_atom-1)*_max_photon_size;
for (m=0; m<max_m; ++m) {
_C[m]=_C[m+max_m];
_D[m]=_D[m+max_m];
/* if ((m%(_max_photon_size))==0)
/*
printf("_C[%ld]=%lf
*/

*/

_C[%ld]=%lf\n", m, _C[m], m+max_m, _C[m+max_m]);

204

}

/*printf("exiting in excited state (P_ex=%.3lf) with
resulting _C[] array\n\n",
1.-A0);*/

exiting_excited=1;
}

/* reduce _N_atom by 1 */
_N_atom--;

/* normalize _C[] */
normalize_C();

/*printf("exiting_excited=%d\n", exiting_excited);*/
return exiting_excited;
}

int is_excited(double *A0)
{
long max_m, m;
double X;

max_m=two_to(_N_atom-1)*_max_photon_size;
*A0=0.;
for (m=0; m<max_m; ++m) *A0+=(sqr(_C[m])+sqr(_D[m]));
/* ground state probability */
X=drand();
/*printf("A0=%f, X=%f\n", *A0, X);*/
if (X> *A0) return 1;
else {
/*printf("Exiting in ground state\n");*/
return 0;
}
}

double normalize_C()
{
long m, max_m;
double norm;

205

max_m=two_to(_N_atom)*_max_photon_size;
norm=0.;
for (m=0; m<max_m; ++m) norm+=(sqr(_C[m])+sqr(_D[m]));
for (m=0; m<max_m; ++m) {
_C[m]=_C[m]/sqrt(norm);
_D[m]=_D[m]/sqrt(norm);
}
return norm;
}

B.4 decay2-d.c

int cavity_decay_occurs(double dt, double *n_mean,
{
double mean, sqrt_j;
long k, max_k;
int j;
double mult_factor;

double *n2_mean)

double calculate_n_mean();
double calculate_n2_mean(); /* amj */
int does_cavity_decay(double, double);

/* calculate n_mean */
*n_mean=calculate_n_mean();
*n2_mean=calculate_n2_mean();
max_k=two_to(_N_atom);
if (does_cavity_decay(*n_mean, dt)) {
/* collapse wave function */
for (j=1; j<_max_photon_size; ++j) {
sqrt_j=sqrt((double)j);
for (k=0; k<max_k; ++k) {
_C[k*_max_photon_size+j-1]
=_C[k*_max_photon_size+j]*sqrt_j;
_D[k*_max_photon_size+j-1]
=_D[k*_max_photon_size+j]*sqrt_j;
}
}
for (k=1; k<=max_k; ++k) {
_C[k*_max_photon_size-1]=0.;
_D[k*_max_photon_size-1]=0.;
}

206

/* normalize it */
mean=normalize_C();

/*
printf("Cavity decay occurred from n_mean=%f\n\n",
n_mean);
*/
return 1;
}
else {
/* decrease non-zero photon amplitudes */
for (j=0; j<_max_photon_size; ++j) {
mult_factor=1.-(double)j*_Gc_over_2pi/_g_over_2pi/4.*dt;
for (k=0; k<max_k; ++k) {
_C[k*_max_photon_size+j]*=mult_factor;
_D[k*_max_photon_size+j]*=mult_factor;
}
}
mean=normalize_C();

return 0;

}
}

double calculate_n_mean()
/* calculate <n> mean photon number as well as _Pn_dist[]
photon number distribution */
{
double mean;
long k, max_k;
int j;

mean=0.;
max_k=two_to(_N_atom);
for (j=0; j<_max_photon_size; ++j) {
_Pn_dist[j]=0.;
for (k=0; k<max_k; ++k)
_Pn_dist[j]+=(sqr(_C[k*_max_photon_size+j])
+sqr(_D[k*_max_photon_size+j]));
_Pn_dist_mean[j]+=_Pn_dist[j];
mean+=_Pn_dist[j]*(double)j;
}
return mean;
}

/*

amj add the fununction calculate_n2_mean() */

207

double calculate_n2_mean()
/* calculate <n*n> */
{
double mean2;
int j;

mean2=0.;

return mean2;
}

#define SMALL_PROB 0.3

for (j=0; j<_max_photon_size; ++j)
mean2+=_Pn_dist[j]*((double)j)*((double)j);

int does_cavity_decay(double mean, double dt)
{
double prob;

/* calculate decay rate */
prob=_Gc_over_2pi/_g_over_2pi/2.*dt*mean;
if ((prob > 0.3)&&(prob < 10.)) prob=1.-exp(-prob);
if (prob>10.) prob=1.;
if (drand()<prob) return 1;
else return 0;
}

B.5 evolve2-2-d.c

void evolve_wave_function(double dt, double t)
/* Runge-Kutta 4th order algorithm */
{
double dC, dD, x, y, g[MAX_NUM_ATOM];
long m0, m0j, k_new, k, mask;
int j, i;
double xp, t0, omega[MAX_NUM_ATOM];

for (k=0; k<_max_k; ++k) {
/* evaluate bit pattern of k */
mask=k;

208

1=excited */

_detuning_sum[k]=0.; /* freq/2g unit */
for (j=1; j<=_N_atom; ++j) {
_bits[k][j]=mask%2;
/* j-th atom state: 0=ground
if (_bits[k][j]>0)
_detuning_sum[k]+=(_CA_detuning-
_A_info[j][0]*_mean_shift_over_2g/_v0);
else
_detuning_sum[k]-=(_CA_detuning-
_A_info[j][0]*_mean_shift_over_2g/_v0);
mask/=2;
}
_detuning_sum[k]*=0.5;
}

/* amj add _v0 jun 16,98 */

/* calculate coupling constant of i-th atom */
for (i=1; i<=_N_atom; ++i) {
g[i]=_A_info[i][3]; /* of i-th atom, already including
exp(-sqr(y)) factor */

x=(2.*(t-_A_info[i][1]) /* calculate its x position at t */
/(_A_info[i][2]-_A_info[i][1])-1.)
*INTERACTION_LENGTH/2.;
/* -INTERACTION_LENGTH/2 < x < +INTERACTION_LENGTH/2 */

if (GAUSSIAN_X) {
if (sqr(x)<10.) g[i]*=exp(-sqr(x));
else g[i]=0.;
}
else { /* Top hat in X */
if (fabs(x)>INTERACTION_LENGTH/2.) g[i]=0.;
}
/*
if(i==1 ) printf("t=%g: g[1]=%g\n", t, g[1]);
*/

if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {

/* check if the atom is still in the pump beam */
if (fabs(x+PUMP_POS)<PUMPING_LENGTH/2.) {

xp=(x+PUMP_POS)/PUMP_WAIST;
if (sqr(xp)<10.) omega[i]=_omega_Rabi*exp(-sqr(xp));
else omega[i]=0.;

} /* atom is still in the pump */
else omega[i]=0.;

209

} /* the pump overlaps with the cavity */
}

/************************************************/
/* First, calculate y1=y0+y’(t,y0)*dt/2 for RK4 */
/* or just y=y0+y’(t,y0)*dt for non-RK4
*/
/************************************************/
for (k=0; k<_max_k; ++k) {
m0=k*_max_photon_size;

for (j=0; j<_max_photon_size; ++j) {

/* evaluate two atom-field interaction terms */

/* first, initialize with detuning term */
m0j=m0+j;
dC=-_D[m0j]*_detuning_sum[k]; /* detuning in 2g unit */
dD=_C[m0j]*_detuning_sum[k];

/* a S- term */

if (j > 0) {
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==0) {
/* only when i-th atom in ground state */
k_new=k+two_to(i-1);

/* H=hbar*g*(a+S- + aS+) used here */
dC+=_D[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;

dD-=_C[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C[k_new*_max_photon_size+j]*0.5;
} /* the pump overlaps with the cavity */
} /* if i-th atom in ground state */
} /* for i loop */
} /* if */

if (j<_max_photon_size-1) { /* a S+ term */
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==1) {
/* only when i-th atom in excited state */
k_new=k-two_to(i-1);
dC+=_D[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;
dD-=_C[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;

210

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C[k_new*_max_photon_size+j]*0.5;
} /* the pump overlaps with the cavity */
} /* if i-th atom in excited state */
} /* for i loop */
} /* if */

dC*=dt; /* dt in 1/2g unit */
dD*=dt; /* dt in 1/2g unit */
#ifdef USE_RK4_ALGORITHM
dC/=2.;
dD/=2.;
#endif
_C_1[m0j]=_C[m0j]+dC; /* dt in 1/2g unit */
_D_1[m0j]=_D[m0j]+dD; /* dt in 1/2g unit */
} /* for j loop */
} /* for k loop */

#ifndef USE_RK4_ALGORITHM /* not USE_RK4_ALGORITHM */
for (k=0; k<_max_k; ++k) {
m0=k*_max_photon_size;
for (j=0; j<_max_photon_size; ++j) {
m0j=m0+j;
_C[m0j]=_C_1[m0j];
_D[m0j]=_D_1[m0j];
}
}
#else /* do USE_RK4_ALGORITHM */

**************************************************************/
/* Second, calculate y2=y0+y’(t+dt/2,y1)*dt/2
*/
/**************************************************************/
t+=dt/2;
for (k=0; k<_max_k; ++k) {
m0=k*_max_photon_size;

for (j=0; j<_max_photon_size; ++j) {
m0j=m0+j;
/* evaluate two atom-field interaction terms */
/* first, initialize with detuning term */
dC=-_D_1[m0j]*_detuning_sum[k]; /* detuning in 2g unit */
dD=_C_1[m0j]*_detuning_sum[k];

211

/* a S- term */

if (j > 0) {
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==0) {
/* only when i-th atom in ground state */
k_new=k+two_to(i-1);

dC+=_D_1[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;
dD-=_C_1[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D_1[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_1[k_new*_max_photon_size+j]*0.5;
} /* the pump overlaps with the cavity */
} /* if i-th atom in ground state */
}/* for loop */
}

if (j<_max_photon_size-1) { /* a S+ term */
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==1) {
/* only when i-th atom in excited state */
k_new=k-two_to(i-1);
dC+=_D_1[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;
dD-=_C_1[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D_1[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_1[k_new*_max_photon_size+j]*0.5;
} /* atom is still in the pump */
} /* if i-th atom in excited state */
}
}

_C_2[m0j]=_C[m0j]+dC*dt/2.; /* dt in 1/2g unit */
_D_2[m0j]=_D[m0j]+dD*dt/2.; /* dt in 1/2g unit */
} /* for j loop */
}/* for k loop */

/**************************************************************/
/* Third, calculate y3=y0+y’(t+dt/2,y2)*dt
/**************************************************************/

*/

212

for (k=0; k<_max_k; ++k) {
m0=k*_max_photon_size;

for (j=0; j<_max_photon_size; ++j) {
m0j=m0+j;
/* evaluate two atom-field interaction terms */
/* first, initialize with detuning term */
dC=-_D_2[m0j]*_detuning_sum[k]; /* detuning in 2g unit */
dD=_C_2[m0j]*_detuning_sum[k];

/* a S- term */

if (j > 0) {
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==0) {
/* only when i-th atom in ground state */
k_new=k+two_to(i-1);
dC+=_D_2[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;
dD-=_C_2[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D_2[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_2[k_new*_max_photon_size+j]*0.5;
} /* atom is still in the pump */
} /* if i-th atom in ground state */
} /* for loop */
}

if (j<_max_photon_size-1) { /* a S+ term */
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==1) {
/* only when i-th atom in excited state */
k_new=k-two_to(i-1);
dC+=_D_2[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;
dD-=_C_2[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D_2[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_2[k_new*_max_photon_size+j]*0.5;
} /* atom is still in the pump */
} /* if i-th atom in excited state */
}
}

_C_3[m0j]=_C[m0j]+dC*dt; /* dt in 1/2g unit */

213

_D_3[m0j]=_D[m0j]+dD*dt; /* dt in 1/2g unit */
} /* for j loop */
} /* for k loop */

/**************************************************************/
/* Fourth, calculate yf=(y1+2*y2+y3-y0)/3+y’(t+dt,y3)*dt/6
*/
/**************************************************************/
t+=dt/2;
for (k=0; k<_max_k; ++k) {
m0=k*_max_photon_size;

for (j=0; j<_max_photon_size; ++j) {
m0j=m0+j;
/* evaluate two atom-field interaction terms */
/* first, initialize with detuning term */
dC=-_D_3[m0j]*_detuning_sum[k]; /* detuning in 2g unit */
dD=_C_3[m0j]*_detuning_sum[k];

/* a S- term */

if (j > 0) {
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==0) {
/* only when i-th atom in ground state */
k_new=k+two_to(i-1);
dC+=_D_3[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;
dD-=_C_3[k_new*_max_photon_size+j-1]*g[i]*sqrt((double)j)*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {
dC+=omega[i]*_D_3[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_3[k_new*_max_photon_size+j]*0.5;
} /* atom is still in the pump */
} /* if i-th atom in ground state */
} /* for loop */
}

if (j<_max_photon_size-1) { /* a S+ term */
for (i=1; i<=_N_atom; ++i) {
if (_bits[k][i]==1) {
/* only when i-th atom in excited state */
k_new=k-two_to(i-1);
dC+=_D_3[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;
dD-=_C_3[k_new*_max_photon_size+j+1]*g[i]*sqrt((double)(j+1))*0.5;

/* include pump beam effect on lasing */
if ((PUMPING_SIMULATED)&&(PUMPING_EFFECT_ON)) {

214

dC+=omega[i]*_D_3[k_new*_max_photon_size+j]*0.5;
dD-=omega[i]*_C_3[k_new*_max_photon_size+j]*0.5;
} /* atom is still in the pump */
} /* if i-th atom in excited state */
}
}

_C[m0j]=(_C_1[m0j]+_C_2[m0j]*2.+_C_3[m0j]-_C[m0j])/3.+dC*dt/6.;
/* dt in 1/2g unit */
_D[m0j]=(_D_1[m0j]+_D_2[m0j]*2.+_D_3[m0j]-_D[m0j])/3.+dD*dt/6.;
/* dt in 1/2g unit */
} /* for j loop */
} /* for k loop */

t-=dt; /* unchanged t */

#endif
}

B.6 spont2-d.c

int decide_atom_decay(int *does_it_decay, double dt)
{
int i, n=0;
double prob;

for (i=1; i<=_N_atom; ++i) {
prob=_Ga_over_2g*dt*_population[i];
if ((prob>0.3)&&(prob<10.)) prob=1.-exp(-prob);
if (prob>10.) prob=1.;
if (drand()<prob) {
does_it_decay[i]=1;
n++;
/*
printf("%d-th atom undergoes spontaneous emission.\n", i);
*/
}
else does_it_decay[i]=0;
}
return n;
}

215

int how_many_atoms_decay(double dt)
{
long max_k, k, mask, new_k, m, m2;
int bits[MAX_NUM_ATOM], j, i, does_it_decay[MAX_NUM_ATOM];
double mean;
int num_photons;

/* initialize population array */
for (i=0; i<MAX_NUM_ATOM; ++i) _population[i]=0.;

max_k=two_to(_N_atom);

/* calculate excited state population */
for (k=0; k<max_k; ++k) {
mask=k;
for (i=1; i<=_N_atom; ++i) {
/* evaluate i-th bit pattern */
bits[i]=mask%2;
mask/=2;
if (bits[i]==1) {
for (j=0; j<_max_photon_size; ++j) {
m=k*_max_photon_size+j;
_population[i]+=(sqr(_C[m])+sqr(_D[m]));
}
}
}
}

for (k=0; k<max_k; ++k) {
mask=k;
for (i=1; i<=_N_atom; ++i) {
/* evaluate i-th bit pattern */
bits[i]=mask%2;
mask/=2;

if (does_it_decay[i]==1) {
/* collapse wave function */
if (bits[i]==1) {
new_k=k-two_to(i-1);
for (j=0; j<_max_photon_size; ++j) {
m2=new_k*_max_photon_size+j;
m=k*_max_photon_size+j;

/* exist */

216

num_photons=decide_atom_decay(does_it_decay, dt);

_C[m2]+=_C[m]; /* down shift */
_C[m]=0.;
_D[m2]+=_D[m]; /* down shift */
_D[m]=0.;
} /* otherwise no new term */
}
else
for (j=0; j<_max_photon_size; ++j) {
_C[k*_max_photon_size+j]=0.;
_D[k*_max_photon_size+j]=0.;
}
}

else {/* does not decay */
if (bits[i]==1) {
/* decrease excited state amplitude */
for (j=0; j<_max_photon_size; ++j) {
m=k*_max_photon_size+j;
/*
printf("C[%ld]=%f -->", m, _C[m]);
*/
_C[m]*=(1.-_Ga_over_2g/2.*dt);
_D[m]*=(1.-_Ga_over_2g/2.*dt);
/*
printf("C[%ld]=%f\n", m, _C[m]);
*/
}
}
else {
/* do nothing */
/*
for (j=0; j<_max_photon_size; ++j) {
m=k*_max_photon_size+j;
printf("C[%ld]=%f\n", m, _C[m]);
}
*/
}
}
}
}
mean=normalize_C();
return num_photons;
}

217

B.7 pumping-d.c

/* This part incorporates coherent pumping process */
/* #define SELF_TESTING
/* did not compile correctly - old version still exists in pumping-d.old.c

------ this part removed by CFY because it

*/

int
double

TEST_PUMP=0;
FUDGE_FACTOR=1;

void get_state_amplitude(double v)
{
double dt, Dt, a, b, t, t1, t2, tp, x1, x2,
Ga_over_Omega_R, prob;

int i;
char *output_name = "pump.out";
FILE *fp;

/* integration from -PUMPING_LENGTH/2 to PUMP_POS-INTERACTION_LENGTH/2 */

Ga_over_Omega_R=_Ga_over_2g*_t_int*PUMP_WAIST/PI;

x1=-PUMPING_LENGTH/2.;
x2=PUMP_POS-INTERACTION_LENGTH/2.;
/* x1, x2 in w0 unit */

/* amj /2 */

/* printf("*** v=%g, _v0=%g\n", v, _v0);

*/

FUDGE_FACTOR = 1.187;
tp=sqrt(PI)/(v/_v0) * FUDGE_FACTOR;
t1=x1/PUMP_WAIST*tp;
t2=x2/PUMP_WAIST*tp;
/* tp, t1, t2 in 1/Omega_R unit */

t=t1;
dt=0.01;
a=1.; /* ground state amplitude */
b=0.; /* excited state amplitude */

do {
Dt=dt*exp(-sqr(t/tp));
a+=b/2.*Dt;
b+=-a/2.*Dt;

218

t+=dt;

{

}
}

/* amj test starts jul 27, 98 */

if(TEST_PUMP)
{

for (i=0; i<2; ++i)

if (i==0)

fp=fopen(output_name, "a");

else fp=stderr;
fprintf(fp, "%lf

%lf

%lf \n", t, a,

b);

if(i==0) fclose(fp);

/* amj test ends jul 27, 98 */

/* calculate decay probability */
/* amj #ifdef INCLUDE_ATOM_DECAY */
if(INCLUDE_ATOM_DECAY){

prob=Ga_over_Omega_R*dt*sqr(b);
if ((prob>0.3)&&(prob<10.)) prob=1.-exp(-prob);
if (prob>10.) prob=1.;

/* generate a random number */
if (drand()<prob) {
/* atom decays */
b=0.;
a=1.;
}}

if(INCLUDE_D_STATE_DECAY){

prob=D_STATE_DECAY_CORRECTION*Ga_over_Omega_R*dt*sqr(b);
if ((prob>0.3)&&(prob<10.)) prob=1.-exp(-prob);
if (prob>10.) prob=1.;

/* generate a random number */
if (drand()<prob) b=10; /* amj by definition b=10 for d state decay */
} /* amj adds this block */

219

fprintf(fp, "after this point atom in interaction region\n");

/* amj else {} */ /* if not decaying, do nothing */
/* amj #endif */

} while (t<t2);

/* amj test starts jul 27, 98 */

for (i=0; i<2; ++i)

if (i==0)

fp=fopen("pumping.out", "a");

else fp=stderr;

if (i==0) fclose(fp);

if(TEST_PUMP)
exit(0);

/* amj test ends jul 27, 98 */

_A_info[_N_atom][4]=a;
_A_info[_N_atom][5]=b;

/*

{

}

*/

}

B.8 d state2-d.c

int decide_d_state_decay(int *does_it_decay, double dt)
{
int i, n=0;
double prob;

for (i=1; i<=_N_atom; ++i) {
/* calculate decay probability to D state */
prob=_Ga_over_2g*dt*_population[i]*D_STATE_DECAY_CORRECTION;
if ((prob>0.3)&&(prob<10.)) prob=1.-exp(-prob);
if (prob>10.) prob=1.;
if (drand()<prob) {
does_it_decay[i]=1;

220

n++;
/*
printf("%d-th atom undergoes d-state decay.\n", i);
*/
}
else does_it_decay[i]=0;
}
return n;
}

int how_many_d_state_decay(double dt)
{
long max_k, k, mask,
int bits_i, j, i, does_it_decay[MAX_NUM_ATOM];
double mean;
int num_decays;

m, max_m;

/* initialize population array */
for (i=0; i<MAX_NUM_ATOM; ++i) _population[i]=0.;

max_k=two_to(_N_atom);

/* calculate excited state population */
for (k=0; k<max_k; ++k) {
mask=k;
for (i=1; i<=_N_atom; ++i) {
/* evaluate i-th bit pattern */
bits_i=mask%2;
mask/=2;
if (bits_i==1) {
for (j=0; j<_max_photon_size; ++j) {
m=k*_max_photon_size+j;
_population[i]+=(sqr(_C[m])+sqr(_D[m]));
}
}
}
}

num_decays=decide_d_state_decay(does_it_decay, dt);

for (i=1; i<=_N_atom; ++i) {
/* evaluate i-th bit pattern */
if (does_it_decay[i]==1) {
/* i-th atom decays to d-state --> i-th atom should be in the

221

When D-state decay occurs

excited state just before the decay.
for i-th atom, first we exchange the atom with the last one.
Now the i-th atom is labeled as the last one.
one is in D-state, it is as if it were not in the cavity.
should remove the atom from the wave function.
removal, the atom should be in the excited state.
to the atom exciting cavity in the excited state prematurally.

Just before the

We

Since the new last

*/

This is equivalent

exchange_atom_with_last_one(i);

/* the last atom must be in the excited state */
max_m=two_to(_N_atom-1)*_max_photon_size;
for (m=0; m<max_m; ++m) {
_C[m]=_C[m+max_m];
_D[m]=_D[m+max_m];
}

_N_atom--;
}
else {/* does not decay */
max_k=two_to(_N_atom-1);
for (k=0; k<max_k; ++k) {
mask=k;

/* find the i-th bit pattern of k */
for (j=1; j<=i; ++j) {
bits_i=mask%2;
mask/=2;
}

if (bits_i==1) {
for (j=0; j<_max_photon_size; ++j) {
m=k*_max_photon_size+j;
/* decrease excited state amplitude */
_C[m]*=(1.-_Ga_over_2g/2.*dt*D_STATE_DECAY_CORRECTION);
_D[m]*=(1.-_Ga_over_2g/2.*dt*D_STATE_DECAY_CORRECTION);
} /* for j loop */
} /* if */
} /* for k loop */
} /* if */
} /* for i loop */

mean=normalize_C();
return num_decays;
}

222

B.9 Sample input ﬁle

50.000000 # Ga_over_2pi
791.000000 # lambda
10.000000 # r0
10 # finesse
0.100000 # L
200 3 # _max_photon_size _max_atoms
0.05000 # dt0
10000 # tot_atom_count
0 # DEBUG_LEVEL
0 INCLUDE_ATOM_DECAY
0 # INCLUDE_D_STATE_DECAY
0 # STANDING_WAVE
10.000000 # tilt_angle
1 # num_detuning
1.000000 # detuning[0]
4.000000 # INTERACTION_LENGTH
0 # CIRCULAR_BEAM
0.0001 # REC_HALF_HEIGHT
0.443 # effective_V_to_apparent_V
1 # num_N_eff
.1 # N_eff[0]
1 # num_u_th
400.000000 # u_th[0]
0 # MONO_VELOCITY
0 # USE_MAXWELL_BOLTZMANN
0.100000 # _delta_v
1.000000 # _v0
0 # GENERATE_PHOTON_FILE
0 # PUMPING_SIMULATED
run40.data # summary filename

223

*** Don’t forget summary filename below ***

Note: this program may not treat velocity distributions and detuning correctly;
in this thesis simulation results were only cited for the monovelocity, resonant case.

224

Appendix C

VPascal sequencing program

C.1 Cavity scanning experiment

{ microlaser_experiment.v }
{ C. Fang-Yen }

{ Variables }
var

moy;

mirp;

index;

x_use;

x_increment;

textwinname;

dataplotname;

crop_colplot;

colplotname ;

backgroundname;

x;
x_stop;

Plot1 ; Plot2 ;

Plot3 ; exposure_time;

{ scanned voltage, etc. }

scatteringname; scatteringimage;

mox;
textwin;
total_counts_x;
whereymax;

Z1 ; plotimage ; bgimage ; img;
Plot0 ;
imagename;
rowplotname ;
do_dataplot;
i;
x_start;
micp;
writedata;
do_serial;
wherexmax;
rezero;
ii;
sigma; logmox; logmoxregion;
test;
doing_background_now; signal; previous_signal; ratio; serial_error;
serial_error_msg; dataline; current_position; background_plot;
n_periods; data_array; n_frames; data_max; data_bkgnd; where_max;
data_bkgnd_sample; v_t_553_on; v_t_791_on; v_t_553_off; v_t_791_off;
use_background; plotimage_no553; datafilename; do_blackbody; do_microlaser;
save_images; image_array; image_array_filename; cts_per_ms;

fitmin; fitmax;
line; line100;
data_x_temp ;

ixlimit;
y_third_max_minus;

iylimit;
moymox;

y_third_max_plus;

do_gaussian_fit;

a;
data_y;

total_counts_y;

rezero_sample;

data_y_temp ;

num_pixels;

closest;

data_x;

absmox;

sum0;

sum1;

sum2;

225

procedure take_picture(roi_index; var img);

begin
{ Set Gain Index 3 }
pvcSetGain( 3 );
exposure_time := 300;
pvcSetExpTime( exposure_time);
{ override }
roi_index := 3;

if(roi_index = 0) then

img := pvcSequence( 1,386,228,423,257,1,1 ) ; {small}

if(roi_index = 1) then
img := pvcSequence(
if(roi_index = 2) then
img := pvcSequence(
if(roi_index = 3) then
img := pvcSequence( 1,352,236,454,270,1,1 ); { small for

1,304,169,501,323,1,1 ) ; {medium}

1,0,0,767,511,1,1 ); { full CCD }

slit}

end;

begin

{ *******************

INITIALIZATION

**************** }

{ ’data.tif’ = generic }

datafilename := ’data.tif’;
image_array_filename := ’image.tif’;
do_blackbody := False;
use_background := False;
do_microlaser := True; { else skip cavity scan }
save_images := False; { save fluorescence images }

{ else use scattering subtraction }

{ Record location of blackbody peak in col plot }

imagename := ’image’;
rowplotname := ’rowplot’;
colplotname := ’colplot’;
dataplotname := ’dataplot’;
crop_colplot := 0;
backgroundname := ’background’;
scatteringname := ’scattering’;
index := 0;
x_use := True;
x_start :=1450;
x_stop := 1500;
x_increment := 2;
x := x_start;
writedata := True;

226

textwinname := ’output’;
do_serial := True;
rezero := False;
rezero_sample := 10;
do_gaussian_fit := False;
data_x := MakeLinear(0.0,0.0,1000);
data_y := MakeLinear(0.0,0.0,1000);
do_dataplot := False;
doing_background_now := 0;
v_t_553_on := 0.65;
v_t_791_on := 1.0;
v_t_553_off := -0.1;
v_t_791_off := -0.1;

{ V_t 553nm on voltage }

{ V_t 791nm on voltage }

{ V_t 553nm off voltage }
{ V_t 791nm off voltage }

if(writedata) then
begin

if EditorExists(textwinname) then
GetEditor(textwinname, textwin)

else textwin := CreateEditor( ’output’);

WriteLn(textwin, ’’);
end;

{ ******* INITIALIZE SERIAL PORTS ******

}

OpenSerial( 1,19200,8,NoParity,1 ) ;

{ SR400 photon counter A }

Halt( ’Failed to open serial connection 1: error ’, serial_error)
else WriteLn(’Serial connection 1 ok’);

SetTxEnd( chr(13) ) ;

SetRxEnd( chr(13) ) ;
SetRxTimeout(5000);

WriteLn(’----’);

serial_error := SerialError;

if serial_error <> 0 then

SelectPort(1);
TxFlush ;

Transmit( chr(13));
Transmit( chr(13));

TxFlush ;
RxFlush;

227

Transmit(’pl 1’);

dataline := RxString;
WriteLn(’SR400A: PORT1=’, dataline);

Transmit(’np’);

dataline := RxString;
n_periods := val(dataline);
WriteLn(’SR400A: NPERIODS=’, n_periods);

{
CloseSerial(1);
Halt(’’);
}

if x_increment <> 0 then
n_frames := Floor((x_stop - x_start)/x_increment)+1
else
n_frames := 100;

data_array := CreateArray(single, n_periods+1, n_frames, 1);

OpenSerial( 2,9600,8,NoParity,1 ) ;
serial_error := SerialError;

{ IMS stepper driver }

if serial_error <> 0 then

Halt( ’Failed to open serial connection 2: error ’, serial_error )
else WriteLn(’Serial connection 2 ok’);

{ ****** INITIALIZE BLOCKER ****** }

SelectPort(2);

Transmit(’ ’);
Delay(100);

RxFlush;
WriteLn(’RxWaiting=’,RxWaiting);
Transmit(’Z’);
Delay(100);
dataline := RxString;
WriteLn(’Current position ’, dataline);
dataline := StrParse(dataline, ’Z’);
current_position := Val(StrStrip(dataline));
WriteLn(’Current position Z=’, current_position);
Transmit(’X’);

228

dataline := RxString;
WriteLn(dataline);
dataline := RxString;
WriteLn(dataline);

{
CloseSerial(1); CloseSerial(2);
Halt(’done’);
}

{ ************* TAKE 1 FRAME, SET UP IMAGE AND PLOT WINDOWS ************ }

{ Acquire data }
{ plotimage := pvcSequence( 1,386,228,423,257,1,1 ) ; }
take_picture(0, plotimage);
Show( plotimage) ;

num_pixels := GetXSize(plotimage) * GetYSize(plotimage) ;

if save_images then image_array := CreateArray(GetXSize(plotimage),
GetYSize(plotimage), n_frames);

WriteLn(FileExpand(’background.tif’));
{ Halt; }

if use_background then

if not ImageExists(backgroundname) then
begin

if Query(’No background: use this?’)=id_Yes then

begin

Save(plotimage, ’background.tif’);

Open(’background.tif’, background_plot);
Show(background_plot, ’background’);
Delete(plotimage);

end;

Halt;

end;

}

{
if use_background = False then

{ Get the active frame number }
Z1 := GetActiveFrame( plotimage ) ;

229

if not ImageExists(scatteringname) then Halt(’No scattering file’);

{ Create a plot window }
if PlotExists(rowplotname) then

begin
GetPlot(rowplotname, Plot0);

{

Halt(’ok’); }

end

else

begin

end;

Plot0 := CreatePlot( rowplotname );
SetTitle( Plot0,’Row Plot’ ) ;
SetSubTitle( Plot0,GetName( plotimage ) ) ;
SetXLabel( Plot0,’X Position’ ) ;
SetYLabel( Plot0,’Mean Intensity’ ) ;
SetGrid( Plot0,gs_Both ) ;

{ Row plot }
SetPlotColor( col_Black ) ;
Plot( Plot0,MeanOverY( plotimage[..,..,Z1] ) ) ;

{ Create data plot window }
if PlotExists(dataplotname) then

begin

GetPlot(dataplotname, Plot2);

end
else
Plot2 := CreatePlot(dataplotname);

{ Create a plot window }
if PlotExists(colplotname) then

begin
GetPlot(colplotname, Plot1);

{

Halt(’ok’); }

end
else begin

Plot1 := CreatePlot( colplotname ) ;
SetTitle( Plot1,’Column Plot’ ) ;
SetSubTitle( Plot1,GetName( plotimage ) ) ;
SetXLabel( Plot1,’Y Position’ ) ;
SetYLabel( Plot1,’Mean Intensity’ ) ;
SetGrid( Plot1,gs_Both ) ;

end;

230

{ Col plot }
SetPlotColor( col_Black ) ;
Plot( Plot1,MeanOverX( plotimage[..,..,Z1] ) ) ;

{ *** INITIALIZE SR400 PARAMETERS *** }

{ to be written }

{ ******************* MAIN LOOP BEGINS ************************ }

repeat

SelectPort(2);
Transmit(StrCat(’R ’, Str(x)));
Delay(1000.0*Abs(current_position - x)/400.0);
current_position := x;

{ SET BLOCKER POSITION }

{ Wait for it to move }

{ Turn on 553nm probe, turn off 791nm pump}
SelectPort(1);
Transmit(StrCat(’pl 1, ’, Str(v_t_553_on)));
Transmit(StrCat(’pl 2, ’, Str(v_t_791_off)));

Delay(1000);

{ Acquire data }
take_picture(0, plotimage);
Show( plotimage ) ;

{ Turn off 553nm probe, turn on 791 pump }
SelectPort(1);
Transmit(StrCat(’pl 1, ’, Str(v_t_553_off)));
Transmit(StrCat(’pl 2, ’, Str(v_t_791_on)));

mox := MeanOverX( plotimage[..,..,Z1] );
{ plotimage[..,0..crop_colplot,..] := mox[0,crop_colplot,0]; }

GetImage( backgroundname, bgimage ) ;

GetImage( scatteringname, scatteringimage );

{ Perform an image subtraction }

231

if use_background then plotimage := plotimage - bgimage ;

if not use_background then

begin
take_picture(0, plotimage_no553);
plotimage := plotimage - plotimage_no553 - 0;

end;

{ Rezero: subtract avg of first 10 pixels in col plot }

if rezero then begin
mox := MeanOverX( plotimage[..,..,Z1] );
moymox := MeanOverY(mox[..,0..10,..]);
plotimage := plotimage - moymox[0,0,0];
{ mox[0,crop_colplot,0]; }
end;

if save_images then
begin
image_array[..,..,index] := plotimage;

if Save(image_array, image_array_filename) <> file_Ok

{ store plotimage in array }

then Halt(’Save error’);

end;

{ Row plot }
ClearPlot(Plot0);
SetPlotColor( col_Black ) ;
moy := MeanOverY( plotimage[..,..,Z1] );

Plot( Plot0,moy ) ;
mirp := MaxOf(moy);

wherexmax := 0;
ixlimit := GetXSize(moy)-1;
for i := 0 to ixlimit do
begin
if moy[i,0,0] = mirp

then wherexmax := i;
}

{ WriteLn(str(i));

end;

sum0 := 0; sum1 := 0; sum2 := 0;
for i :=0 to ixlimit do
begin

232

sum0 := sum0 + moy[i,0,0];
sum1 := sum1 + moy[i,0,0] * i;
sum2 := sum2 + moy[i,0,0] * i * i;
end;

WriteLn(’x: avg=’, sum1/sum0, ’ sigma=’,

Sqrt(sum2/sum0 - sum1*sum1/(sum0*sum0)), ’ sum=’, sum0);

WriteLn(x, ’ ’, sum0);

{ WriteLn(textwin, ’max at x=’, wherexmax); }

{ WriteLn(textwin, MaxOf(moy[0..10])); }
total_counts_y := MeanOf(moy) * num_pixels;
SetTitle( Plot0, StrCat(StrCat(’Row Plot, max=’, Str(mirp)),

StrCat(’ at ’, Str(wherexmax))) ) ;

{ Col plot }
ClearPlot(Plot1);
SetPlotColor( col_Black ) ;
mox := MeanOverX( plotimage[..,..,Z1] );
{ WriteLn(textwin, GetYSize(mox)); }
mox[..,0..crop_colplot,..] := mox[..,crop_colplot,..]
{ if crop_colplot>0 then

;

for i := 1 to crop_colplot-1 do

begin

WriteLn(i);

end; }

mox[i] := mox[crop_colplot];

Plot( Plot1,mox ) ;
micp := MaxOf(mox);
total_counts_x := MeanOf(mox) * num_pixels;

whereymax := 0;
iylimit := GetYSize(mox)-1;
for i := 0 to iylimit do
begin
if mox[0,i,0] = micp

then whereymax := i;
}

{ WriteLn(str(i));

end;

{ Find 1/3 max points }

233

closest := 10000;
for ii := whereymax to iylimit do

begin

if Abs(mox[0,ii,0] - micp/3.0) < closest then

begin
closest := Abs(mox[0,ii,0] - micp/3.0);
y_third_max_plus := ii;
end;

end;

closest := 10000;
for ii:=0 to whereymax do

begin

if Abs(mox[0,ii,0] - micp/3.0) < closest then

begin
closest := Abs(mox[0,ii,0] - micp/3.0);
y_third_max_minus := ii;
end;

end;
{
WriteLn(’y_half_max_plus ’, str(y_third_max_plus));
WriteLn(’y_half_max_minus ’, str(y_third_max_minus));
}

{ Gaussian fitting }

sigma:=0;
if do_gaussian_fit then begin

absmox := sqrt(sqr(mox))+0.01;
logmox := Ln(absmox);
fitmin := y_third_max_minus;
fitmax := y_third_max_plus;
line := MakeLinear(fitmin -0.0 , fitmax - 0.0, fitmax - fitmin + 1);
line100 := MakeLinear(0,iylimit+0.0,(iylimit+1.0));
a := PolyFit(line, logmox[0,fitmin..fitmax,0],2);

}

{ WriteLn(a);
{
WriteLn(str(line));
WriteLn(str(logmox[0,fitmin..fitmax,0]));
WriteLn(str(a[0,0,0]));
WriteLn(str(a[1,0,0]));
WriteLn(str(a[2,0,0]));
WriteLn(’ ’); }

234

{ logmoxregion := logmox[0,fitmin..fitmax,0];
WriteLn(logmoxregion);
WriteLn(str(logmoxregion[0,0,0])); }

{

}
{

Plot3 := CreatePlot(’logplot’);
Plot(Plot3, logmoxregion);

Plot(Plot3, line, Polyvalue(a, line)); }

sigma := Sqrt(Abs(-1.0 / (2.0 * a[2,0,0])));
{ SetTitle( Plot1, str(2*sigma)); }

WriteLn(’gaussian_fit 2*sigma= ’, str(2*sigma));

SetPlotStyle( ps_Line ) ;
SetPlotColor( col_Blue ) ;
PlotXY(Plot1, line100, Exp(Polyvalue(a, line100)));
SetPlotColor( col_Red ) ;
PlotXY(Plot1, line, Exp(Polyvalue(a, line)));
{SetPlotColor( col_Blue ) ;
PlotXY(Plot2, line100, Polyvalue(a, line100));}
end;

{ Take moments }

sum0 := 0; sum1 := 0; sum2 := 0;
for i :=0 to iylimit do
begin
sum0 := sum0 + mox[0,i,0];
sum1 := sum1 + mox[0,i,0] * i;
sum2 := sum2 + mox[0,i,0] * i * i;
end;

WriteLn(’y: avg=’, sum1/sum0, ’ sigma=’,

Sqrt(sum2/sum0 - sum1*sum1/(sum0*sum0)), ’ sum=’, sum0);

{ WriteLn(textwin, ’max at y=’, whereymax); }

SetTitle( Plot1, StrCat(StrCat(StrCat(StrCat(’y:Colplot, max=’, Str(micp)),

StrCat(’ at ’, Str(whereymax)) ), ’ sigma*2= ’), Str(2*sigma)) );

signal := micp;

235

cts_per_ms := total_counts_x / exposure_time;

WriteLn(’blocker=’,x,’ micp=’, signal, ’ total_cts_x=’, total_counts_x,
’cts_per_ms = ’, cts_per_ms);

data_x[index+1,0,0] := x;
data_y[index+1,0,0] := signal;
data_x[index,0,0] :=x;
data_y[index,0,0] := signal;

if do_dataplot then
begin
ClearPlot(Plot2);
data_x_temp := data_x[0..(index),0,0];
data_y_temp := data_y[0..(index),0,0];

{ WriteLn(data_x[0..index+1,0,0], data_y[0..index+1,0,0]); }
PlotXY(Plot2, data_x_temp, data_y_temp);
end;

WriteLn(’frame=’, index, ’ x=’,x, ’ micp=’, micp, ’ mirp=’, mirp, ’ tot_x=’, total_counts_x,

’ tot_y’, total_counts_y);

{ ***** END OF FLUORESCENCE

***** }

{ ***** TRIGGER RAMP AND COLLECT DATA ***** }

if do_microlaser then
begin

SelectPort(2);
Transmit(’A 8’);
Transmit(’A 0’);

{ OUTPUT 1 -> HIGH }
}
{ OUTPUT 1 -> LOW

SelectPort(1);
RxFlush;
Transmit(’CR’);
Transmit(’FB’);

{ SR400 Counter Reset }
{ Start with continuous data output }

for i := 1 to n_periods do

begin

236

dataline := RxString;
data_array[i,index,0] := val(dataline);
{ WriteLn(data_array[i,index,0]);
end;

}

data_max := 0; data_bkgnd := 0;
data_bkgnd_sample := 10;

for i :=1 to n_periods do
begin

{ WriteLn(’i, index=’, i, ’ ’, index); }
{ WriteLn(i, ’ ’, data_array); }
if data_array[i,index,0] > data_max then

begin
data_max := data_array[i,index,0];

where_max := i;
end;
end;

data_bkgnd := MeanOf(data_array[1..data_bkgnd_sample,index,0]);

WriteLn(’data_max=’, data_max, ’ at ’, where_max, ’. data_bkgnd=’,

data_bkgnd, ’ signal=’, data_max-data_bkgnd);

if (do_blackbody) then

else

WriteLn(textwin, whereymax, ’ ’, data_max - data_bkgnd)

WriteLn(textwin, index, ’ ’, x, ’ ’, cts_per_ms, ’ ’, data_max - data_bkgnd);
}
{ WriteLn(textwin, index, ’ ’, micp,

Clear(plot2);
Plot(plot2, data_array[1..n_periods,index,0]);

if Save(data_array, datafilename) <> file_Ok

then Halt(’Save error’);

x := x + x_increment;
index := index + 1;

end;

{ end of ’if do_microlaser’ }

until x > x_stop;

{ *************** END OF MAIN LOOP ************** }

237

CloseSerial(1); CloseSerial(2);

end

C.2 Cavity locking experiment

{ microlaser_experiment.v }
{ C. Fang-Yen }

{ Variables }
var

moy;

mirp;

index;

x_use;

textwinname;

x_increment;

dataplotname;

crop_colplot;

colplotname ;

backgroundname;

x;
x_stop;

Plot1 ; Plot2 ;

Plot3 ; exposure_time;

{ scanned voltage, etc. }

scatteringname; scatteringimage;

mox;
textwin;
total_counts_x;
whereymax;

Z1 ; plotimage ; bgimage ; img;
Plot0 ;
imagename;
rowplotname ;
do_dataplot;
i;
x_start;
micp;
writedata;
do_serial;
wherexmax;
rezero;
ii;
sigma; logmox; logmoxregion;
test;
doing_background_now; signal; previous_signal; ratio; serial_error;
serial_error_msg; dataline; current_position; background_plot;
n_periods; data_array; data_array2; n_frames; data_max; data_bkgnd;
where_max;
data_bkgnd_sample; v_t_553_on; v_t_791_on; v_t_553_off; v_t_791_off;
use_background; plotimage_no553; datafilename; do_blackbody; do_microlaser;
save_images; image_array; image_array_filename; log_filename; do_blocker;
lock_time; do_553_ttl; cts_per_ms;

fitmin; fitmax;
line; line100;
data_x_temp ;

ixlimit;
y_third_max_minus;

iylimit;
moymox;

y_third_max_plus;

do_gaussian_fit;

a;
data_y;

total_counts_y;

rezero_sample;

data_y_temp ;

num_pixels;

closest;

data_x;

absmox;

sum0;

sum1;

sum2;

procedure ttl_outputs(out1, out2, out3);
begin
SelectPort(2);
Transmit(’A ’+
end;

Str(8*(1-out1) + 16*(1-out2) + 32*(1-out3)));

238

procedure lock_cavity;
begin
ttl_outputs(0 , 0, 0);
ttl_outputs(1 , 1, 0);
end;

procedure unlock_cavity;
begin
ttl_outputs(0, 0, 0);
ttl_outputs(0, 0, 1);
end;

{ turn off AOM after cavity }
{ turn on 791 probe; no cav lock disable}

{ turn off 791 probe; cav lock disable }
{ turn on AOM after cavity }

procedure take_picture(roi_index; var img);

begin
{ Set Gain Index 3 }
pvcSetGain( 3 );
exposure_time := 300;
pvcSetExpTime( exposure_time);
{ override }
roi_index := 0;

if(roi_index = 0) then

img := pvcSequence( 1,386,228,423,257,1,1 ) ; {small}

if(roi_index = 1) then
img := pvcSequence(
if(roi_index = 2) then
img := pvcSequence(
if(roi_index = 3) then
img := pvcSequence( 1,352,236,454,270,1,1 ); { small for

1,304,169,501,323,1,1 ) ; {medium}

1,0,0,767,511,1,1 ); { full CCD }

slit}

end;

begin

{ *******************

INITIALIZATION

**************** }

{ ’data.tif’ = generic }

datafilename := ’data.tif’;
image_array_filename := ’image.tif’;
log_filename := ’log.txt’;
do_blackbody := False;
use_background := False;
do_microlaser := False; { False = skip cavity scan }
save_images := False; { save fluorescence images }
do_blocker := True;

{ Record location of blackbody peak in col plot }

{ False = use scattering subtraction }

imagename := ’image’;

239

rowplotname := ’rowplot’;
colplotname := ’colplot’;
dataplotname := ’dataplot’;
crop_colplot := 0;
backgroundname := ’background’;
scatteringname := ’scattering’;
index := 0;
x_use := True;
x_start := 20;
x_stop := 60;
x_increment := 1;
x := x_start;
writedata := True;
textwinname := ’output’;
do_serial := True;
rezero := False;
rezero_sample := 10;
do_gaussian_fit := False;
data_x := MakeLinear(0.0,0.0,1000);
data_y := MakeLinear(0.0,0.0,1000);
do_dataplot := False;
doing_background_now := 0;
v_t_553_on := 0.605;
v_t_791_on := 1.0;
v_t_553_off := -0.1;
v_t_791_off := -0.1;

lock_time := 1000;

if(writedata) then
begin

{ V_t 553nm on voltage }

{ V_t 791nm on voltage }

{ V_t 553nm off voltage }
{ V_t 791nm off voltage }

if EditorExists(textwinname) then
GetEditor(textwinname, textwin)

else textwin := CreateEditor( ’output’ );

WriteLn(textwin, ’’);
end;

{ ******* INITIALIZE SERIAL PORTS ******

}

SetTxEnd( chr(13) ) ;

SetRxEnd( chr(13) ) ;
SetRxTimeout(1000);

WriteLn(’----’);

240

OpenSerial( 1,19200,8,NoParity,1 ) ;

{ SR400 photon counter A }

serial_error := SerialError;

if serial_error <> 0 then

Halt( ’Failed to open serial connection 1: error ’, serial_error)
else WriteLn(’Serial connection 1 ok’);

SelectPort(1);
TxFlush ;

Transmit( chr(13));
Transmit( chr(13));

TxFlush ;
RxFlush;

Transmit(’pl 1’);

dataline := RxString;
WriteLn(’SR400A: PORT1=’, dataline);

Transmit(’np’);

dataline := RxString;
n_periods := val(dataline);
WriteLn(’SR400A: NPERIODS=’, n_periods);

{
CloseSerial(1);
Halt(’’);
}

if x_increment <> 0 then
n_frames := Floor((x_stop - x_start)/x_increment)+1
else
n_frames := 100;

data_array := CreateArray(single, n_frames, 1);
data_array2 := CreateArray(single,

n_frames, 1);

OpenSerial( 2,9600,8,NoParity,1 ) ;
serial_error := SerialError;

{ IMS stepper driver }

if serial_error <> 0 then

Halt( ’Failed to open serial connection 2: error ’, serial_error )
else WriteLn(’Serial connection 2 ok’);

241

{ ************* TAKE 1 FRAME, SET UP IMAGE AND PLOT WINDOWS ************ }

{ ****** INITIALIZE BLOCKER ****** }

SelectPort(2);

Transmit(’ ’);
Delay(100);

RxFlush;

{

WriteLn(’RxWaiting=’,RxWaiting); }

Transmit(’Z’);
Delay(100);
dataline := RxString;
WriteLn(’Current position ’, dataline);
dataline := StrParse(dataline, ’Z’);
current_position := Val(StrStrip(dataline));
WriteLn(’Current position Z=’, current_position);
Transmit(’X’);
dataline := RxString;
WriteLn(dataline);
dataline := RxString;
WriteLn(dataline);

unlock_cavity;

{ unlock cavity }

take_picture(0, plotimage);

lock_cavity;

{ re-lock cavity}

Show( plotimage) ;

num_pixels := GetXSize(plotimage) * GetYSize(plotimage) ;

WriteLn(’n_frames=’, n_frames);

if save_images then
image_array := CreateArray(GetXSize(plotimage),
GetYSize(plotimage), n_frames);

WriteLn(FileExpand(’background.tif’));
{ Halt; }

if use_background then

if not ImageExists(backgroundname) then

242

if use_background = False then

if not ImageExists(scatteringname) then Halt(’No scattering file’);

if Query(’No background: use this?’)=id_Yes then

Save(plotimage, ’background.tif’);

Open(’background.tif’, background_plot);
Show(background_plot, ’background’);
Delete(plotimage);

begin

begin

end;

Halt;

end;

{

}

{ Get the active frame number }
Z1 := GetActiveFrame( plotimage ) ;

{ Create a plot window }
if PlotExists(rowplotname) then

begin
GetPlot(rowplotname, Plot0);

{

Halt(’ok’); }

end

else

begin

end;

Plot0 := CreatePlot( rowplotname );
SetTitle( Plot0,’Row Plot’ ) ;
SetSubTitle( Plot0,GetName( plotimage ) ) ;
SetXLabel( Plot0,’X Position’ ) ;
SetYLabel( Plot0,’Mean Intensity’ ) ;
SetGrid( Plot0,gs_Both ) ;

{ Row plot }
SetPlotColor( col_Black ) ;
Plot( Plot0,MeanOverY( plotimage[..,..,Z1] ) ) ;

{ Create data plot window }
if PlotExists(dataplotname) then

begin

GetPlot(dataplotname, Plot2);

243

end
else
Plot2 := CreatePlot(dataplotname);

{ Create a plot window }
if PlotExists(colplotname) then

begin
GetPlot(colplotname, Plot1);

{

Halt(’ok’); }

end
else begin

Plot1 := CreatePlot( colplotname ) ;
SetTitle( Plot1,’Column Plot’ ) ;
SetSubTitle( Plot1,GetName( plotimage ) ) ;
SetXLabel( Plot1,’Y Position’ ) ;
SetYLabel( Plot1,’Mean Intensity’ ) ;
SetGrid( Plot1,gs_Both ) ;

end;

{ Col plot }
SetPlotColor( col_Black ) ;
Plot( Plot1,MeanOverX( plotimage[..,..,Z1] ) ) ;

{ *** INITIALIZE SR400 PARAMETERS *** }
{ to be written }

repeat

if(do_blocker) then
begin
SelectPort(2);
Transmit(StrCat(’R ’, Str(x)));
Delay(1000.0*Abs(current_position - x)/400.0);
current_position := x;
end;

{ Turn on 553nm probe, turn off 791nm pump}
SelectPort(1);

Transmit(StrCat(’pl 1, ’, Str(v_t_553_on)));
Transmit(StrCat(’pl 2, ’, Str(v_t_791_off)));

244

{ ******************* MAIN LOOP BEGINS ************************ }

{ SET BLOCKER POSITION }

{ Wait for it to move }

unlock_cavity; {unlock}

{ Acquire data }
take_picture(0, plotimage);
Show( plotimage ) ;

lock_cavity; {relock + Turn off 553nm probe}

{ Turn off 553nm probe }
SelectPort(1);
Transmit(StrCat(’pl 1, ’, Str(v_t_553_off)));
{ Transmit(StrCat(’pl 2, ’, Str(v_t_791_on))); }

mox := MeanOverX( plotimage[..,..,Z1] );
{ plotimage[..,0..crop_colplot,..] := mox[0,crop_colplot,0]; }

GetImage( backgroundname, bgimage ) ;

{
GetImage( scatteringname, scatteringimage );
}

{ Perform an image subtraction }

if use_background then plotimage := plotimage - bgimage ;

if not use_background then

begin
Delay(lock_time);
unlock_cavity; { unlock }
take_picture(0, plotimage_no553);
lock_cavity; { relock }

{ Halt(’should be locked’);}

Delay(lock_time);

{ plotimage := plotimage - plotimage_no553 - scatteringimage;}

plotimage := plotimage - plotimage_no553;
end;

{ Rezero: subtract avg of first 10 pixels in col plot }

if rezero then begin
mox := MeanOverX( plotimage[..,..,Z1] );
moymox := MeanOverY(mox[..,0..10,..]);

245

if Save(image_array, image_array_filename) <> file_Ok

{ store plotimage in array }

plotimage := plotimage - moymox[0,0,0];
{ mox[0,crop_colplot,0]; }
end;

if(save_images) then
begin
image_array[..,..,index] := plotimage;

then Halt(’Save error’);

end;

{ Row plot }
ClearPlot(Plot0);
SetPlotColor( col_Black ) ;
moy := MeanOverY( plotimage[..,..,Z1] );

Plot( Plot0,moy ) ;
mirp := MaxOf(moy);

wherexmax := 0;
ixlimit := GetXSize(moy)-1;
for i := 0 to ixlimit do
begin
if moy[i,0,0] = mirp

then wherexmax := i;
}

{ WriteLn(str(i));

end;

{
sum0 := 0; sum1 := 0; sum2 := 0;
for i :=0 to ixlimit do
begin
sum0 := sum0 + moy[i,0,0];
sum1 := sum1 + moy[i,0,0] * i;
sum2 := sum2 + moy[i,0,0] * i * i;
end;

WriteLn(’x: avg=’, sum1/sum0, ’ sigma=’,

Sqrt(sum2/sum0 - sum1*sum1/(sum0*sum0)), ’ sum=’, sum0);

WriteLn(x, ’ ’, sum0);
}
{ WriteLn(textwin, ’max at x=’, wherexmax); }

{ WriteLn(textwin, MaxOf(moy[0..10])); }
total_counts_y := MeanOf(moy) * num_pixels;

246

SetTitle( Plot0, StrCat(StrCat(’Row Plot, max=’, Str(mirp)),

StrCat(’ at ’, Str(wherexmax))) ) ;

{ Col plot }
ClearPlot(Plot1);
SetPlotColor( col_Black ) ;
mox := MeanOverX( plotimage[..,..,Z1] );
{ WriteLn(textwin, GetYSize(mox)); }
mox[..,0..crop_colplot,..] := mox[..,crop_colplot,..]
{ if crop_colplot>0 then

;

for i := 1 to crop_colplot-1 do

begin

WriteLn(i);

end; }

mox[i] := mox[crop_colplot];

Plot( Plot1,mox ) ;
micp := MaxOf(mox);
total_counts_x := MeanOf(mox) * num_pixels;

whereymax := 0;
iylimit := GetYSize(mox)-1;
for i := 0 to iylimit do
begin
if mox[0,i,0] = micp

then whereymax := i;
}

{ WriteLn(str(i));

end;

{ Find 1/3 max points }

closest := 10000;
for ii := whereymax to iylimit do

begin

if Abs(mox[0,ii,0] - micp/3.0) < closest then

begin
closest := Abs(mox[0,ii,0] - micp/3.0);
y_third_max_plus := ii;
end;

end;

closest := 10000;
for ii:=0 to whereymax do

begin

if Abs(mox[0,ii,0] - micp/3.0) < closest then

247

begin
closest := Abs(mox[0,ii,0] - micp/3.0);
y_third_max_minus := ii;
end;

end;
{
WriteLn(’y_half_max_plus ’, str(y_third_max_plus));
WriteLn(’y_half_max_minus ’, str(y_third_max_minus));
}

{ Gaussian fitting }

sigma:=0;
if do_gaussian_fit then begin

absmox := sqrt(sqr(mox))+0.01;
logmox := Ln(absmox);
fitmin := y_third_max_minus;
fitmax := y_third_max_plus;
line := MakeLinear(fitmin -0.0 , fitmax - 0.0, fitmax - fitmin + 1);
line100 := MakeLinear(0,iylimit+0.0,(iylimit+1.0));
a := PolyFit(line, logmox[0,fitmin..fitmax,0],2);

}

{ WriteLn(a);
{
WriteLn(str(line));
WriteLn(str(logmox[0,fitmin..fitmax,0]));
WriteLn(str(a[0,0,0]));
WriteLn(str(a[1,0,0]));
WriteLn(str(a[2,0,0]));
WriteLn(’ ’); }

{ logmoxregion := logmox[0,fitmin..fitmax,0];
WriteLn(logmoxregion);
WriteLn(str(logmoxregion[0,0,0])); }

{

}
{

Plot3 := CreatePlot(’logplot’);
Plot(Plot3, logmoxregion);

Plot(Plot3, line, Polyvalue(a, line)); }

sigma := Sqrt(Abs(-1.0 / (2.0 * a[2,0,0])));
{ SetTitle( Plot1, str(2*sigma)); }

248

WriteLn(’gaussian_fit 2*sigma= ’, str(2*sigma));

SetPlotStyle( ps_Line ) ;
SetPlotColor( col_Blue ) ;
PlotXY(Plot1, line100, Exp(Polyvalue(a, line100)));
SetPlotColor( col_Red ) ;
PlotXY(Plot1, line, Exp(Polyvalue(a, line)));
{SetPlotColor( col_Blue ) ;
PlotXY(Plot2, line100, Polyvalue(a, line100));}
end;

{ Take moments }
{
sum0 := 0; sum1 := 0; sum2 := 0;
for i :=0 to iylimit do
begin
sum0 := sum0 + mox[0,i,0];
sum1 := sum1 + mox[0,i,0] * i;
sum2 := sum2 + mox[0,i,0] * i * i;
end;

WriteLn(’y: avg=’, sum1/sum0, ’ sigma=’,

Sqrt(sum2/sum0 - sum1*sum1/(sum0*sum0)), ’ sum=’, sum0);

}
{ WriteLn(textwin, ’max at y=’, whereymax); }

SetTitle( Plot1, StrCat(StrCat(StrCat(StrCat(’y:Colplot, max=’, Str(micp)),

StrCat(’ at ’, Str(whereymax)) ), ’ sigma*2= ’), Str(2*sigma)) );

signal := micp;

cts_per_ms := total_counts_x / exposure_time;

WriteLn(’blocker=’,x,’ micp=’, signal, ’ total_cts_x=’, total_counts_x,
’cts_per_ms = ’, cts_per_ms);

if do_dataplot then
begin
data_x[index+1,0,0] := x;
data_y[index+1,0,0] := signal;
data_x[index,0,0] :=x;
data_y[index,0,0] := signal;

ClearPlot(Plot2);

249

data_x_temp := data_x[0..(index),0,0];
data_y_temp := data_y[0..(index),0,0];

{ WriteLn(data_x[0..index+1,0,0], data_y[0..index+1,0,0]); }
PlotXY(Plot2, data_x_temp, data_y_temp);
end;

WriteLn(’frame=’, index, ’ x=’,x, ’ micp=’, micp, ’ mirp=’, mirp, ’ tot_x=’, total_counts_x,

’ tot_y’, total_counts_y);

{ ***** END OF FLUORESCENCE

***** }

{ ****** MICROLASER I ******* }

unlock_cavity; { unlock }
{ Delay(100); } { Wait a bit }

SelectPort(1);
Transmit(StrCat(’pl 2, ’, Str(v_t_791_on))); { turn on pump AFTER unlock }

SelectPort(1);
RxFlush;

Transmit(’FB’);
Delay(100);
Transmit(’QB’);

Transmit(’CR’);

}{ SR400 Counter Reset }

}{ Start with continuous data output }

{ Read most recent complete data point }

dataline := RxString;
data_array[index,0] := val(dataline);

data_bkgnd := 0;

{ Enter correct value here }

if (do_blackbody) then

else

WriteLn(textwin, whereymax, ’ ’, data_array[index,0] - data_bkgnd)

WriteLn(textwin, index, ’ ’, x, ’ ’, micp, ’ ’,

total_counts_x/exposure_time, ’ ’,
Str(data_array[index,0] - data_bkgnd));

Clear(plot2);

Plot(plot2, data_array[1..index,0]);

}

if Save(data_array, datafilename) <> file_Ok

then Halt(’Save error’);

}

250

{
{

{

{

WriteLn(textwin, whereymax, ’ ’, data_array[index,0] - data_bkgnd)

lock_cavity; { relock }
Delay(lock_time);
unlock_cavity; { unlock, pump still on! }

{ *********** MICROLASER II ******** }

SelectPort(1);
RxFlush;

Transmit(’FB’);
Delay(100);
Transmit(’QB’);

Transmit(’CR’);

}{ SR400 Counter Reset }

}{ Start with continuous data output }

{ Read most recent complete data point }

{
{

{

{

}

dataline := RxString;
data_array2[index,0] := val(dataline);

data_bkgnd := 0;

{ Enter correct value here }

if (do_blackbody) then

else

WriteLn(textwin, index, ’ ’, x, ’ ’, micp, ’ ’,

total_counts_x/exposure_time, ’ ’,
data_array2[index,0] - data_bkgnd);

lock_cavity;
Delay(lock_time);

Clear(plot2);
Plot(plot2, data_array[1..index,0]);

}

if Save(data_array2, datafilename) <> file_Ok

then Halt(’Save error’);

x := x + x_increment;
index := index + 1;

until x > x_stop;

{ *************** END OF MAIN LOOP ************** }

CloseSerial(1); CloseSerial(2);

251

end

252

Appendix D

Standing-wave versus

traveling-wave coupling

We now show that the peak atom-cavity coupling g in the traveling-wave case is equal

to one-half the peak coupling of the standing-wave case.

Consider one atom in a cavity, located along the cavity’s axis at z = z(t) where

z(t) = z0 + vt

We can write the operator for the total electric ﬁeld seen by the atom:

ˆE =

2π¯hω
V

s

1
2 


ˆaei(kz(t)−ωt) + ˆa†e−i(kz(t)−ωt)
h

i


2π¯hω
V

+

s

ˆaei(−kz(t)−ωt) + ˆa†e−i(−kz(t)−ωt)
h



i

Here V = πLw2

0/4 is the mode volume, with L the cavity mirror spacing.



Writing out z(t), we can see the splitting of the two cavity frequencies ω

kv:

ˆE =

1
2 s

2π¯hω
V

ˆaei(kz0−(ω+kv)t) + ˆaei(−kz0−(ω−kv)t) + c. c.
i

h

253

(D.1)

(D.2)

(D.3)

±

(D.4)

Suppose v = 0. Then

ˆE =

1
2 s

2π¯hω
V

ˆaeiωta(eikz0 + e−ikz0) + c. c.
i

h

=

s

2π¯hω
V

ˆaeiωt + ˆa†e−iωt
h

i

cos(kz0)

(D.5)

(D.6)

This is the familiar standing wave ﬁeld operator.

For v

= 0 we can set z0 = 0 by redeﬁning the time origin. (This works as long as

kvtint > 2π)

ˆE =

1
2 s

2π¯hω
V

h

ˆaei(ω+kv)t + ˆa†e−i(ω+kv)t

+

1
2 s

2π¯hω
V

i

ˆaei(ω−kv)t + ˆa†e−i(ω−kv)t
h

i

(D.7)

Suppose that only one these terms is resonant. Since ¯hg = ˆµ

ˆE, we have shown

·

explicitly that the traveling-wave case has a maximum coupling one-half that of the

standing-wave case.

254

6
Bibliography

[1] “Comparison of quantum and semiclassical radiation theories with application

to the beam maser”, E. T. Jaynes and F. W. Cummings, Proc. IEEE 51, 89

(1963).

[2] D. Meschede, H. Walther,

and G. Muller,

“One-atom maser”,

Phys. Rev. Lett. 54, 551 (1985)

[3] P. Filipowicz, J. Javanainen and P. Meystre, J. Opt. Soc. Am. B3, 906 (1986);

“Very-low-temperature behavior of a micromaser”, P. Meystre, G. Rempe and

H. Walther, Opt. Lett. 13, 1078 (1988).

[4] “Sub-Poissonian atomic statistics in a micromaser”, G. Rempe and H. Walther,

Phys. Rev. A 42, 1650 (1990).

[5] H. Walther, Phys. Rev. Lett. (1996).

[6] M. Weidinger, B. T. H. Varcoe, R. Heerlein, and H. Walther, Phys. Rev. Lett.

82, 3795 (1999)

[7] B. T. H. Varcoe, S. Battke, and H. Walther, “Preparing Pure Photon Number

States of the Radiation Field”, Nature (London) 403, 743 (February 2000)

[8] “Microlaser: a laser with one atom in an optical resonator”, K. An, J. J. Childs,

R. R. Dasari, and M. S. Feld, Phys. Rev. Lett. 73, 3375 (1994).

[9] Kyungwon An, “Microlaser: a laser with one atom in an optical resonator”,

Ph. D. Thesis, Massachusetts Institute of Technology (1994).

255

[10] “Traveling-wave atom-cavity interaction in the single-atom microlaser”, K. An,

R. R. Dasari, and M. S. Feld, Opt. Lett. 22, 1500 (1997).

[11] O. Benson, G. Raithel, and H. Walther, “Quantum Jumps of the Micromaser

Field: Dynamic Behavior Close to Phase Transition Points”, Phys. Rev. Lett.

[12] D. J. Heinzen, J. J. Childs, and M. S. Feld, Enhanced and inhibited visible

spontaneous emission by atoms in a confocal resonator, Phys. Rev. Lett. 58,

[13] D. J. Heinzen and M. S. Feld, Vacuum Radiative Level Shift and Spontaneous-

Emission Linewidth of an Atom in an Optical Resonator, Phys. Rev. Lett. 59,

72, 3506 (1994)

1320 (1987)

2623 (1987)

[14] M. G. Raizen, R. J. Thompson, R. J. Brecha, J. J. Kimble, and H. J. Carmichael,

“Normal-Mode Splitting and Linewidth Averaging for Two-State Atoms in an

Optical Cavity”, Phys. Rev. Lett. 63, 240 (1989)

[15] “Optical bistability and photon statistics in cavity quantum electrodynamics”,

G. Rempe et al, Phys. Rev. Lett 67,1727 (1991).

[16] H. M. Gibbs, ”Optical Bistability: Controlling Light with Light”, Academic

Press, New York, (1985)

[17] W. Lamb, “Theory of an optical maser”, Phys. Rev. 134, A1429 (1964)

[18] S. F. Lim, J. A. Hudgings, G. S. Li, W. Yuen, K. Y. Lau, and C. J. Chang-

Hasnain, “Self-Pulsating and Bistable VCSEL with Controllable Intracavity

Quantum-Well Saturable Absorber,” Electronics Lett. (accepted for publication)

[19] V. DeGiorgio and M. O. Scully, Phys. Rev. A 2, 1170 (1970).

[20] Laser Physics, M. Sargent, M. Scully, and W. Lamb, Addison-Wesley Publishing

Company (1974).

256

[21] “Theory of microscopic maser”, P. Filipowicz, J. Javanainen, P. Meystre, Phys.

Rev. A34, 3077 (1986).

99 (1954)

A 55, 3033 (1997).

[22] R. H. Dicke, “Coherence in Spontaneous Radiation Processes”, Phys. Rev. 93,

[23] ”Collective eﬀects in the microlaser”, M. I. Kolobov and F. Haake, Phys. Rev.

[24] “Numerical studies of the mesomaser”, M. Elk, Phys. Rev. A 54, 4351 (1996)

[25] “Fine structure of thresholds in a micromaser pumped with atom clusters”,

G. M. D’Ariano, N. Sterpi, A. Zucchetti, Phys. Rev. Lett. 74, 900 (1995)

[26] L. de Guevara et al, “Cooperative eﬀects in a one-photon micromaser with atomic

polarization Phys. Rev. A 55, 2471 2474 (1997)

[27] M. Orszag, R. Ramirez, J. C. Retamal and C. Saavedra, Phys. Rev. A 49, 2933

[28] M. O. Scully and M. S. Zubairy, Quantum Optics. Cambridge University Press,

(1994). .

1997.

[29] W. E. Lamb, W. P. Schleich, M. O. Scully, and C. H. Townes, “Laser physics:

Quantum controversy in action”, Rev. Mod. Phys. 71, S263 (1999)

[30] “Quantum trajectory analysis of a thresholdlike transition in the microlaser”, C.

Yang and K. An, Phys. Rev. A55, 4492(1997).

[31] “Quantum trajectory simulation for many atom interacting with cavity scenario

and its explanation of mild threshold behavior in few atom operation mode of

the single atom laser”, Changhuei Yang, B. S. Thesis, Massachusetts Institute

of Technology (1996).

[32] “Wave-Function Approach to Dissipative Processes in Quantum Optics”, J. Dal-

ibard, Y. Castin and K. Mølmer, Phys. Rev. Lett. 68(5), 580 (1991).

257

[33] “Quantum trajectory theory for cascaded open systems”, H. J. Carmichael, Phys.

Rev. Lett. 70, 2273 (1993).

[34] “Role of standing-wave mode structure in microlaser emission”, K. An and M.

S. Feld, Phys. Rev. A52, 1691 (1995).

[35] “Measurement of ultralow losses in an optical

interferometer”, G. Rempe,

R. J. Thompson, H. J. Kimble, and R. Lalezari, Opt. Lett. 17, 363 (1992)

[36] “Cavity ring-down technique and its application to measurement of ultra-slow

velocities”, K. An, C. Yang, R. R. Dasari, and M. S. Feld, Opt. Lett. 20, 1068

(1995).

[37] M. Commandr´e and P. Roche, Appl. Opt. 35, 5021 (1996).

[38] ‘Optical bistability induce by mirror absorption: measurement of absorption

coeﬃcients at the sub-ppm level”, K. An, B. A. Sones, C. Fang-Yen, R. R.

Dasari, and M. S. Feld, Opt. Lett. 22, 1433 (1997).

[39] “The optimization and analytical characterization of super cavity mirrors for

use in the single atom laser experiment”, Bryndol Avery Sones, M. S. Thesis,

Massachusetts Institute of Technology (1997).

[40] “Normal mode line shapes for atoms in standing-wave optical resonator”, J. J.

Childs, K. An, M. S. Otteson, R. R. Dasari and M. S. Feld, Phys. Rev. Lett. 77,

2901 (1996).

[41] “Atom-Field Interaction in Optical Resonators”, James Joseph Childs Jr.,

Ph. D. Thesis, Massachusetts Institute of Technology (1996).

[42] “Observation of normal-mode splitting for an atom in an optical cavity”,

R. J. Thompson, G. Rempe, and H. J. Kimble, Phys. Rev. Lett. 68, 1132 (1992).

[43] “The single atom laser”, M. S. Feld and K. An, Scientiﬁc American, 56-63 (July

1998).

258

[44] “Micromaser spectrum”, M. O. Scully and H. Walther, Phys. Rev. A 44, 5992

(1991).

[45] “Exact calculation of the natural linewidth for a one-photon micromaser”, S.

Qamar and M. S. Zubairy, Phys. Rev. A 44, 7804 (1991).

[46] “Subnarrow linewidth, hole, and split in micromaser spectrum”, N. Lu, Phys.

Rev. Lett. 70, 912 (1993).

[47] “Micromaser spectrum: trapped states”, N. Lu, Phys. Rev. A 47, 1347 (1993).

[48] “Calculation of the micromaser spectrum. I. Green-function approach and ap-

proximate analytical techniques”, T. Quang, G. S. Aparwal, J. Bergou, M. O.

Scully, and H. Walther, Phys. Rev. A 48, 803 (1993).

[49] “Calculation of the micromaser spectrum. II. Eigenvalue approach”, K. Vogel,

W. P. Schleich, M. O. Scully, and H. Walther, Phys. Rev. A. 48, 813 (1993).

[50] “Phase distribution and linewidth in the micromaser”, W. C. Schieve and R. R.

McGowan, Phys. Rev. A 48, 2315 (1993).

[51] “Intensity-intensity correlations for the micromaser: Spectral and antibunching

characteristics”, S. Arun Kumar and G. S. Agarwal, Phys. Rev. A 50, 680 (1994).

[52] “Spectral properties of a micromaser: Atomic-beam statistics and the ﬁeld cor-

relation function”, H.-J. Briegel, B.-G. Englert, and M. O. Scully, Phys. Rev. A

54, 3603 (1996).

3813 (1997).

and references therein.

[53] “Micromaser linewidth”, R. R. McGowan and W. C. Schieve, Phys. Rev. A 55,

[54] Quantum Optics, D.F. Walls, G.J. Milburn, Springer-Verlag (1994), chapter 7

[55] P W Milonni, M-L Shih, J R Ackerhalt, “Chaos in Laser-Matter Interactions”,

World Scientiﬁc Lecture Notes in Physics - Vol. 6.

259

[56] “Photon antibunching in the micromaser”, T. Quang, Phys. Rev. A 46, 682

(1992).

[57] “One-atom maser: Statistics of detector clicks”, H.-J. Briegel, B.-G. Englert, N.

Sterpi, and H. Walther, Phys. Rev. A 49, 2962 (1994).

[58] “Statistics of photons and de-excited atoms in a micromaser with Poissonian

pumping”, U. Herzog, Phys. Rev. A 50, 783 (1994).

[59] “Atomic-beam and cavity-ﬁeld correlation functions in the micromaser”, J. D.

Cresser and S. M. Pickles, Phys. Rev. A 50, R925 (1994).

[60] “Macroscopic dynamics of a maser with non-Poissonian injection statistics”, H.-

J. Briegel and B.-G. Englert, Phys. Rev. A 52, 2361 (1995).

[61] “Observation of sub-Poissonian photon statistics in a micromaser”, G. Rempe,

F. Schmidt-Kaler, and H. Walther, Phys. Rev. Lett. 64, 2783 (1990).

[62] E. Wehner, R. Seno, N. Sterpi, B.-G. Englert, and H. Walther, Opt. Comm. 110,

655 (1994).

225 (1999) 133-141

[63] F.Casagrande, A.Lulli, S. Ulzega “Quantum-Trajectory approach to cavity quan-

tum electrodynamics with up to three-atom collective eﬀects” Physics Letters A

[64] F.Casagrande, M. Garavaglia, A.Lulli Trapping states and micromaser dynamics

by a quantum trajectory approach. Optics Communications, 151 (1998) 395-405

[65] F.Casagrande, A.Lulli, S. Ulzega Collective eﬀects and trapping states by quan-

tum trajectory treatment of micromaser dynamics Physical Review A 60 (1999)

[66] M. Benassi, F. Casagrande, W. Lange, “ Atomic Cooperation and Nonlinear

Dynamics in a Mesoscopic Maser”, Quantum and Semiclassical Optics. 9(6):879-

1582-1589

898, (1997)

260

[67] C. Balconi, F. Casagrande, and A. Mondini, “Nonlinear dynamics of a passive,

coherently driven mesoscopic micromaser”, Phys. Rev. A 54, 898 (1996)

[68] H. J. Briegel, B. G. Englert, and M. O. Scully, “Spectral properties of a micro-

maser: Atomic-beam statistics and the ﬁeld correlation function” Phys. Rev. A

[69] E. Wehner, R. Seno, N. Serpi, B. G. Englert and H. Walther, Opt. Commun.

54, 3603 (1996)

110, 655 (1994)

[70] J. Bennett, Thin Solid Films 123, 27 (1985).

[71] Ramin Lalezari, Research Electro-Optics, Inc., private communication.

[72] Ray Weiss, Massachusetts Institute of Technology, private communication.

[73] P. Filipowicz, J. Javanainen and P. Meystre, J. Opt. Soc. Am. B3, 906 (1986);

“Very-low-temperature behavior of a micromaser”, P. Meystre, G. Rempe and

H. Walther, Opt. Lett. 13, 1078 (1988).

[74] “Quantum nondemolition measurements of photon number by atomic-beam de-

ﬂection”, M. J. Holland, D. F. Walls, and P. Zoller, Phys. Rev. Lett. 67, 1716

(1991).

[75] “Quantum nondemolition detection of single photons in an open resonator by

atomic beam deﬂection”, A. B. Matsko, S. P. Vyatchanin, H. Mabuchi, and H.

J. Kimble, Phys. Lett. 192, 175 (1994).

[76] “Using diode lasers for atomic physics”, C. Wieman and L. Hollberg, Rev. Sci.

Instrum. 62, 1 (1991).

[77] “Laser Phase and Frequency Stabilization Using an Optical Resonator”,

R. W. P. Drever, et. al. , App. Phys. B 31, 97 (1993), “Dye-Laser Frequency Sta-

bilization Using Optical Resonators”, J. Hough et. al., App. Phys. B 33 (1984).

[78] “A High Intensity Source for the Molecular Beam. Part I. Theoretical.”,

A. Kantrowitz and J. Grey, Rev. Sci. Instr. 22, 328 (1951).

261

[79] “A High Intensity Source for the Molecular Beam. Part II. Experimental.”,

G. B. Kistiakowsky and W. P. Slichter, Rev. Sci. Instr. 22, 333 (1951).

[80] “Velocity Distributions in Molecular Beams from Nozzle Sources”. J. B. Ander-

son and J. B. Fenn, Phys. Fluids 8, 780 (1965).

[81] “Magnetically compensated supersonic beams for nonlinear optics”, K. D. Stokes,

C. Schnurr, J. Gardner, M. Marable, S. Shaw, M. Goforth, D. E. Holmgren,

J. Thomas, Opt. Lett.

[82] A. Siegman, Lasers, University Science Books, 1986.

[83] K. An, R. R. Dasari, and M. S. Feld, “One-step absolute frequency stabilization

of a Ti:sapphire laser using frequency modulation Lamb-dip spectroscopy”, Appl.

Phys. Lett. 66, 24 (1995).

[84] Abdulaziz Aljalal, “Measurement of Second-Order Coherence in the Microlaser”,

Ph. D. Thesis, Massachusetts Institute of Technology (2001).

[85] A. Yariv, Quantum Electronics, John Wiley and Sons, New York 1975.

[86] A. T. Nguyen, G. D. Chern, D. Budker, M. Zolotorev, Phys. Rev. A 63, 013406

(2000)

[87] J. P. C. Kroon, et al, “Rabi Oscillations in the optical pumping of a metastable

neon beam with a cw dye laser”, Phys. Rev. A 31, 3724 (1985)

[88] C. Cohen-Tannoudji, J. Dupont-Roc, G. Grynberg, Atom-Photon Interactions,

John Wiley and Sons, 1992.

262

