9
9
9
1
 
p
e
S
 
4
 
 
]
h
p
-
m
o
t
a
.
s
c
i
s
y
h
p
[
 
 
1
v
5
0
0
9
0
9
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

February 2, 2008

Comparison of numerical methods for the
calculation of cold atom collisions.

G. H. Rawitschera, B. D. Esryb, E. Tiesingac, J. P. Burke, Jrd, I. Koltrachte.
a Physics Department, Univ. of Connecticut, Storrs, CT, 06268;
bITAMP,Harvard Smithonian Center for Astrophysics, Cambridge, MA 02138;
cAtomic Physics Division, National Institute of Standards and
Technology,Gaithersburg, MD 20899. Permanent Address, Department of
Chemistry and Biochemistry, U. Maryland, College Park, MD 20742;
dDepartment of Physics and JILA, Univ. of Colorado, Boulder, CO
80309-0440;
e Department of Mathematics, Univ. of Connecticut, Storrs, CT 06268

Abstract

Comparison between three diﬀerent numerical techniques for solving a cou-
pled channel Schr¨odinger equation is presented. The benchmark equation, which
describes the collision between two ultracold atoms, consists of two channels,
each containing the same diagonal Lennard-Jones potential, one of positive and
the other of negative energy. The coupling potential is of an exponential form.
The methods are i) a recently developed spectral type integral equation method
based on Chebyshev expansions, ii) a ﬁnite element expansion, and iii) a combi-
nation of an improved Numerov ﬁnite diﬀerence method and a Gordon method.
The computing time and the accuracy of the resulting phase shift is found to be
comparable for methods i) and ii), achieving an accuracy of ten signiﬁcant ﬁg-
ures with a double precision calculation. Method iii) achieves seven signiﬁcant
ﬁgures. The scattering length and eﬀective range are also obtained.

1

I.

Introduction

The collision between two ground state atoms at low (µK) temperature poses
challenging computational problems which can be summarized by the words
”long range” and ”coupled channels”. The former problem arises from the fact
that in the collision process the atomic clouds ”polarize” each other, leading
to long ranged dispersion potentials.1 The latter problem arises from the fact
that the internal hyperﬁne structure of the atoms leads to a set of coupled
Schr¨odinger equations that describe the transitions which an atom in the inci-
dent channel can make to many of these hyperﬁne states. Accurate calculations
of the scattering properties and wave functions of the atom-atom collision are
crucial, since the macroscopic shape of the Bose-Einstein condensate as well
as the lineshapes of the photoassociation spectra2 depend sensitively on these
quantities .

The lower the incident energy of the atoms, the larger are the distances for
which the potentials aﬀect the phase shifts. This can be seen from the WKB
approximation to the phase shift which contains integrals over the local wave
length k(x) = [2µ(E

V (x))]1/2 of the form

−

Z

k(x)dx

k0dx

−

≃

Z

1
2k0 Z

V (x)dx,

since the ﬁrst signiﬁcant term in the expansion above contains the ratio of
the potential to the asymptotic wave number. Further, when negative energy
channels are coupled to the positive energy incident channel, it can become
diﬃcult to enforce the appropriate decaying wave function boundary condition,
with resulting loss of stability, depending on the algorithm used.

There are various calculational methods available for dealing with this scat-
tering problem: modiﬁed Numerov, Gordon’s3,4 a ﬁnite element method (FEM),5
and a recently developed method that consist of replacing the coupled diﬀer-
ential equations by equivalent integral equations (IEM),6.7 In addition, there
are more sophisticated ﬁnite diﬀerence methods8; we, however, will not con-
sider these methods here since they are not as widely in use. Methods in-
volving the representation of a continuous function by a ﬁnite set of sampling
points have been discussed.9 One such method led to the mapped Fourier grid
method,10 which has been employed for the calculation of the collision between
cold atoms.11 The interaction of cold atoms with surfaces has also been dis-
cussed,12 including how to implement boundary conditions..

Depending on the degree of accuracy required and the ease of performing the
calculation, any one of these methods may be the most suitable for a particular
situation. It is nevertheless of interest to compare these methods with each other
as far as accuracy, stability and numerical complexity are concerned. It is the
purpose of this paper to compare the three methods, by numerically evaluating
a benchmark test case described below.

2

”Numerical computational stability” is a many-faceted concept.

It mani-
fests itself through the degree of accuracy obtained. There are at least three
ingredients:

•

•

•

i) How the numerical truncation error of the algorithm is oﬀset by the
presence of the accumulation of round-oﬀ errors. The larger the number
of mesh points the smaller the truncation error, but the larger is the cor-
responding overall round-oﬀ error. Diﬀerent algorithms strike a diﬀerent
balance between these two errors.

ii) The sensitivity of the ﬁnal result to the errors in the input data, such as
the potentials, masses, etc. This sensitivity is expresses by the ”condition”
of the formulation model.

iii) How the asymptotic boundary conditions are achieved, both in the
open and the closed channels. For the latter, the growing solutions that
contaminate the decaying solutions have to be eliminated. Each algorithm
proceeds by a diﬀerent method. For example, in the IEM we introduce
scaling factors in each partition that prevent the unwanted solution. In
the ﬁnite diﬀerence methods, one has to integrate inward and outward and
then match at some intermediary distance. Here the matching matrix can
introduce errors. With the ﬁnite elements, the closed channel solutions are
forced to be zero at the ﬁnal matching point, automatically eliminating
the unwanted growing solutions.

It is not the purpose of this paper to investigate in detail the stability prop-
erties of the three algorithms described in the present study. For that, a detailed
comparison of the numerical solution with an exact solution for an artiﬁcial test
case would have to be performed. Rather, we here attempt to obtain some nu-
merical evidence for the degree of stability of the three methods for a realistic
example.

II. The Test Case

The test case we have chosen consists of a model calculation that captures
the essence of the collision of two ultra-cold 2S alkali atoms. The character-
istic feature of such collisions is that in going from large to small internuclear
separations a change of coupling schemes occurs. Asymptotically, the hyperﬁne
structure of the individual alkali atoms dominates, while at short internuclear
separations the molecular X 1Σg and a3Σu potentials dominate. A basic under-
standing of the properties of these two Born-Oppenheimer potential curves can
be found in any text book on quantum mechanics that discusses the electronic

3

structure of a H2 molecule. Here it is suﬃcient to realize that they have an iden-
tical long-range attractive van der Waals behavior and are split exponentially
via an exchange mechanism at shorter internuclear separations.

The simplest multi-channel potential that captures this physics is thus a two
channel model. Taking into account that for small collision energies the nuclear
rotation can be safely ignored, the Hamiltonian is conveniently parametrized as

¯h2
2µ

Ae−br

d2
dr2 +

1

1

(cid:18)

(cid:26)

−

VLJ(r)
Ae−br VLJ(r) + Ehf (cid:19)
where the reduced mass µ = M/2, Ehf is the asymptotic splitting between the
two channels, and
is the total energy in the system. The r-dependent poten-
tials of our test problem are the Lennard-Jones potential VLJ(r) = C12/r12
−
C6/r6 and an oﬀ-diagonal exchange coupling given by Ae−br. The functions ψP
and ψN describe the wavefunction for the open and closed channel, respectively.
Notice that the zero of energy is located at the lowest of the two asymptotes.

ψP
ψN (cid:19)

(cid:27) (cid:18)

= 0

(1)

−

E

E

Obviously this Hamiltonian is set up in terms of the atomic basis. At large in-
ternuclear separation the Hamiltonian reduces to a diagonal matrix. In fact, the
Hamiltonian would be diagonal for all internuclear separation if the exponential
oﬀ-diagonal potential were absent. It turns out that for internuclear separations
where this term is large compared to Ehf it is informative to calculate the adia-
batic potentials by diagonalizing the potential term of the Hamiltonian at each
internuclear separation. At shorter distances the resulting potentials correspond
to a very deep X1Σg and a shallow aΣu potential, to a good approximation.

For two colliding ultra-cold 2S Na atoms, realistic values of the constants are
106 a.u.(a0)12, A=2.9
M = 22.9897680 amu, C6=1472 a.u.(a0)6,13 C12=38
10−6 a.u. This choice of Ehf is approx-
a.u., b=0.81173 a0, and Ehf = 0.2693
·
imately equal to the atomic hyperﬁne splitting of the 2S Na atom. The total
10−12a.u. corresponds to a temperature of 1 µK. Since
energy E = 3.1668293
E
Ehf , the energy in the second channel is negative, i.e., only one of the two
channels is asymptotically accessible. In the above a.u. stands for atomic units,
and a0 is the Bohr radius.

≪

×

×

The conversion into entirely a0 units is achieved by dividing the above equa-

tion by 2µ/¯h2. One obtains

d2
dr2 +

−

(cid:18)

V − E

(cid:19) (cid:18)

ψP
ψN (cid:19)

= 0,

where r is in units of a0 and the potential and energy matrices,
re-
spectively, are in units of (a0)−2. The conversion of a quantity in a.u. units
to (a0)−2 units is achieved by multiplying the former by µ = 22.989768
1822.888506(a.u.)−1(a0)−2. The potential matrix is

and

×

V

E

(2)

(3)

=

V

(cid:20)

˜V
˜U
˜U ˜V

,

(cid:21)

4

(4)

(5)

where ˜V = V

µ, U = ˜U

×

×

µ, and the energy matrix is

k2

=

E

.

κ2

(cid:20)
Here k and κ, the wave numbers in each channel, are given by k = √E
κ =
Ehf ×
k = 3.643004224146145
wave function is normalized so that asymptotically it becomes

µ and
k2. In our numerical example, the corresponding values are
10−4(a0)−1 and κ = 0.1062338621818394(a0)−1. The

p

×

−

−

×

µ

(cid:21)

ψP
ψN (cid:19)

(cid:18)

≈

(cid:18)

sin(kr) + K1 cos(kr)
κr)
K2 exp(

−

,

(cid:19)

where K1 and K2 are two elements related to the real scattering R matrix, in
terms of which the phase shifts can be obtained.

≃

≃

≃

In this model, the diagonal potential extends to considerably larger distances
than the coupling potential. Further, between 6 and 10 a0 the diagonal potential
is very deep leading to many oscillations in the wave functions. For example,
near 5.5a0 the local wave length λ in both channels is
0.25a0, near 8.5a0
1.2a0, with smaller ripples superimposed, and near 20a0 the local wave
λ
length has increased to
4a0 At distances less than 4a0 the repulsive portion of
the potential becomes very large making the wave function very small. In order
to allow for the singularity of the diagonal potentials near the origin, a parameter
Rcut is deﬁned, and the wave functions are set to zero in the interval [0, Rcut]. A
value of Rcut = 4.0a0 is found to be satisfactory. In addition, the calculation is
carried out to a maximum radius, Rmax, beyond which all potentials are set equal
to zero. In our calculations, Rmax is set equal to 500ao. When Rmax is increased
further, the values of K1 and K2 still change beyond the 6 th. signiﬁcant ﬁgure,
as can be seen from the Table in Appendix, even though the Lennard-Jones
0 . The large eﬀect on the phase-shift
potential is less than
produced by such a small potential is due to the occurrence of the factor 1/k
≃
103 in the integrals involving the potential tail, as was already pointed
2.75
out in the introduction. Rather than numerically calculating such changes, it is
preferable to employ perturbation methods, which are described in Appendix 2.

10−9a−2

3.95

×

×

−

A. The Integral Equation Method.

In this method the diﬀerential equation
into the Lippmann-Schwinger integral equation

(cid:16)

E

(cid:17)

V

2

d
dr2 +

ψ =

ψ is transformed

ψ(r) = F (r) +

Rmax

0
Z

G0(r, r′)
V

(r′)dr′,

G0(r, r′) is the
where F (r) is a undisorted wave function, like (sin(kr), 0) , and
undistorted Green’s function matrix.7 A motivation for such an approach is

5

−

κ2

, and 2π/

˜V (r)
|

that the solutions of integral equations have better numerical stability than the
solutions of diﬀerential equations. One common objection to the use of inte-
gral equations has been that the solution leads to large matrices which are not
sparse and hence require substantially larger amounts of computing time than
the sparse matrices of diﬀerential equations. This objection was overcome in our
integral equation method (IEM) by dividing the whole radial interval into par-
titions. The integral equations in each partition lead to dense matrices of small
dimension, but the matrix that combines the local solutions into the global one,
albeit of large dimension, is sparse. It should be noted that this latter property
is valid only in conﬁguration space, because only in this space do the Green’s
functions have the required semi-separable nature. In the present version of the
IEM method the (variable) size of each of the partitions is determined in terms
of two parameters N L and ǫ as follows. In each radial region a local wave length
˜V (r)
k2
.
in channels 1 and 2 is obtained as 2π/
|
|
The smaller of the two local wavelengths is taken, and the size of the partition
q
in that region is determined such that there are a given total number N L of
Chebyshev points per local wave length. Allowing for the fact that in each
partition there are 16 Chebyshev points, the average length of a partition for
a given local wave length λ is λ
16/N L. The length of each partition is sub-
sequently readjusted using the tolerance parameter ǫ as follows. According to
the IEM method,6 in each partition two sets of ”local” functions are calculated
in terms of which the global function ψ is obtained as a linear combination.
The accuracy of each of the local functions can be determined by the size of the
coeﬃcients of the highest order Chebyshev polynomials. If the relative accuracy
of the local functions in a given partition is larger than ǫ, then that partition is
divided in half, and the testing is continued. If the initially chosen value of N L
is too small, then the initial partitions are too large, and many of the partitions
are subsequently reduced by the ǫ criterion. In this case the ﬁnal number of
partitions M becomes larger than their initial value. If the chosen value of N L
is too large, then most of the partitions are unnecessarily small, and the value of
M is too large, leading to a larger accumulation of roundoﬀ errors for the ﬁnal
elements of the K-matrix. An exception is the interval [0, Rcut]. This interval
is considered as one partition, containing a total of 16 Chebyshev points. This
is suﬃcient since the wave function is very small in this region (less than the
desired accuracy for the values of K ), and the values of K were found to be
stable to 11 signiﬁcant ﬁgures as Rcut was varied below 4.0a0 .

| −

q

−

×

In summary, for a given value of ǫ, the value of N L was varied until the
smallest number of partitions M was obtained. An example is given in the
table below.

Table 1. Values of K1 and number of partitions M as a
function of NL for the tolerance ǫ. = 10−9

6

N L
10
20
30
40
50

M
150
153
144
154
177

K1
-0.31233398338809
-0.31233398339572
-0.31233398339229
-0.31233398339070
-0.31233398338870

K2
6.5761303971514
6.5761303973071
6.5761303972290
6.5761303972039
6.5761303971639

From this table one can ﬁnd a value of K1 =

0.3123339834 and K2 =
6.576130397 which are stable to ten signiﬁcant ﬁgures. For values of the tol-
erance ǫ between 10−13 and 10−3 a good compromise value of 10 for N L was
found. The corresponding values of M and the corresponding accuracy of K1
are listed in Table 2 for several values of ǫ.

−

Table 2. Accuracy for K1 and number of partitions M for a given
value of the Tolerance ǫ, with N L = 10

ǫ
10−2
10−3
10−5
10−7
10−9
10−11
10−13

M
28
30
67
106
158
214
574

K1
-0.31243337402099
-0.31233467247746
-0.31233398457315
-0.31233398370637
-0.31233398338809
-0.31233398338869
-0.31233398338534

# of Sign. Figs.
3
5
8
8
10
10
10

From this table it appears that beyond ǫ = 10−9 the accumulation of roundoﬀ
errors begins to dominate, and -0.31233398339 is the best value of K1. The
distribution of partitions for three tolerance parameters is shown in Fig. 1.The
increasingly large spacing of the partitions at the large distances is clear from
the ﬁgure. In the vicinity of R
50 the density of partitions is high because
the negative energy channel has a turning point there. This shows that the
local wave-length criterion alone would have been insuﬃcient to determine the
partition size.

≃

1. Scattering Length and Eﬀective Range.

As a further test of the stability of the IEM method, the Scattering Length
a and Eﬀective Range re are investigated. They are obtained in the limit of
small wave number k from the expression

k/K1 =

+ rek2 + O(k3).

(6)

1
a

−

7

Figure 1: Various IEM partition distributions, described in Table 2. The y-axis
represents the partition number i, and the x-axis shows the lower boundary
of partition i. The more points in a particular radial interval, the smaller are
the lenghts of the partitions in that interval. All three partition distributions
started with the same number of mesh points per local wavelength (NL = 20),
but were subsequently modiﬁed by the ǫ-accuracy criterion, with ǫ = 10−9, 10−6,
and 10−3, respectively. The numbers above each curve represent the number
of accurate signiﬁcant ﬁgures achieved for the asymptotic constant K1 for each
value of ǫ. The large concentration of partitions in the vicinity of 50a0 reﬂects the
occurrence of a turning point in the negative energy channel near that distance,
where accuracy would have been lost had the initial partition distribution been
used.

8

The left hand side of the above equation is usually written as k cot δ0, which is
equal to k/K1. For a given choice of the truncation radius Rmax the value of K1
is calculated for two diﬀerent and small values of k and the values of a and re
are obtained from the two values of k/K1 in Eq. (6).

However, as mentioned in the introduction, the values of the scattering ma-
trix K depend on the choice of the truncation radius, the more so the smaller
the value of k , because of the increasingly non-negligible contributions of the
potential beyond Rmax. Hence, in order to obtain a reliable value of the scatter-
ing length, it is advantageous to ﬁrst correct K1 for the contributions beyond
Rmax. This can be done quite simply by using ﬁrst order perturbation theory,
as is detailed in Appendix 1, and as will be demonstrated below.

An example of the variation of the K’s with Rmax, obtained by the IEM, is
given in the table below. All results in this section were obtained with NL =
10, and ǫ = 10−9. .

Table 3: Dependence of K1 and K2 on Rmax.

K1(Rmax)
-.313705209
-.312333983
-.312324588
-.312324073
-.312323719

K1(

)
∞

-.312322902025
-.312323344009
-.312323343934
-.312323343936
-.312323343936

K2(Rmax)
6.62005410
6.57613040
6.57555968
6.57558157
6.57558741

Rmax
250
500
1000
1500
2000

One can see from the table that the value of K1(Rmax) becomes mono-
tonically less negative as Rmax increases, while K2 ﬁrst decreases, and then
increases for Rmax > 1000. This behavior can be reproduced numerically by
means of perturbation theory, described in the appendix. The usefulness of the
perturbative correction is also demonstrated by the stability of the column de-
noted as K1(
), which contains the corrected values of K1(Rmax). The table
shows that the perturbative correction increases the stability of K1 from 5 or 6
signiﬁcant ﬁgures to 11, yielding K1(

) =
The stability of the values of a and re will be described next. The two
10−4 and
smallest values of k to be used in Eq. (6) were approximately 0.1152
10−6, for which the third order term is smaller than the accuracy of
0.3643
the present method. Their values with and without the perturbative correction
of K1 are shown in the table below.

.31232334394

∞

∞

−

×

×

.

Table 4: Dependence of a and re on Rmax.

9

a(Rmax)
852.0123407
851.9849554
851.9837969
851.9829235
851.9824507

a(

)
∞
851.9817159134
851.9817157297
851.9817157354
851.9817157362
851.9817157362

re(Rmax)
55.08319944
55.10378197
55.10138602
55.10046968
55.10031183

re(

)
∞
55.1051720100
55.1051694472
55.1051696827
55.1051693964
55.1051691577

Rmax
500
1000
1500
2000
2500

The table shows that the stability of the scattering length is increased from
5 to 11 signiﬁcant ﬁgures by the perturbative correction, yielding a(
) =
851.98171574. Likewise, the stability of the eﬀective range is increased from
5 signiﬁcant ﬁgures to 8, yielding re(

) = 55.105169.

∞

∞

B. The Finite Element method

The second method employs the non-iterative eigenchannel14 variant of the
R-matrix method ﬁrst introduced by Wigner and Eisenbud.15 The eigenchannel
R-matrix method solves the Schr¨odinger equation within a ﬁnite reaction vol-
ume Ω of conﬁguration space, subject to constant normal logarithmic derivative
boundary conditions on the surface Σ of Ω. The collisional properties of the
system, typically represented in terms of an S-matrix, are easily obtained once
the normal logarithmic derivative b = (∂Ψ/vitialn)Ψ−1 is calculated.

One can obtain the following eigenvalue equation for the normal logarithmic

derivative b on the surface Σ14:

Γ~c = bΛ~c

(7)

We solve this equation using the ﬁnite-element method (FEM).5 The FEM di-
vides the radial domain into N sectors (or partitions) and within each sector
deﬁnes a local basis in much the same spirit as the IEM above. The local ba-
sis functions, however, are ﬁfth-order Hermite interpolating polynomials rather
than Chebyshev polynomials. The Hermite interpolating polynomials uk(xn),
k=1–6, are non-zero only in sector n. Here, xn is a rescaled variable deﬁned on
1, 1] that is related to the physical internuclear separation R in
the interval [
sector n through an appropriate linear transformation. The six basis functions
are deﬁned through the following boundary conditions:

−

uk(
u′
k(

−
−

1) = δ1k uk(0) = δ3k uk(1) = δ5k
k(0) = δ4k u′
1) = δ2k u′
k(1) = δ6k

.

A multi-component radial wave function can then be represented by the follow-
ing expansion on the piecewise polynomials ui(x):

(8)

(9)

Ψ(R) =

ciui(xn) .

Xi≡{m,k,n}

10

The set i contains the basis function index k, the channel index m, and the
sector index n. The coeﬃcients ci are to be determined subject to a continu-
ity constraint on each channel component and its ﬁrst derivative across sector
boundaries. The assembly stage of the calculation is thus performed prior to
the main calculation, in contrast to the IEM where it is performed after. In ad-
dition, channel boundary conditions can be imposed quite simply by setting the
value of the appropriate coeﬃcient. For instance, the closed channel function is
forced to be zero on the surface by setting the coeﬃcient of u5 in the last sector
to zero.

In the ﬁnite element representation, the matrix elements of Γ and Λ in Eq.(7)

are given by

and

1

−1

Z

Γij = 2µ

ui(xn)(E

H)uj(xn)andxn −

−

δm,m′δn,N δk,5δk′,6/an

(10)

}

≡ {

≡ {

(11)

and j

m, k, n

m′, k′, n

Λij = δm,m′δn,N δk,5δk′,5 ,
,
Rn)/2. Here i
respectively, where an = (Rn+1 −
}
and H is the Hamiltonian of the system. Because the basis functions are non-
zero only within a given sector, the corresponding matrices have roughly a
block diagonal structure. Each sector has an associated block which is coupled
only to its nearest neighbors through the continuity conditions. Note that the
overlap matrix Λ, whose elements are given by surface integrals over the basis
functions,14 is particularly simple in the FEM representation. It contains only
mo non-zero elements (all equal to one), where mo is simply the number of
channels open (i.e., E > Vm) on the surface Σ. The Γ matrix is symmetric and,
as mentioned, can be constructed in a banded format. The integrals representing
the matrix elements of Γ are also particularly simple in the FEM representation.
In fact, except for the integral over the interaction potential, all integrals can
be evaluated analytically once and for all before hand, signiﬁcantly decreasing
the CPU time necessary to construct the matrix.

At this stage, we are left with a banded generalized eigensystem to solve that
typically has large dimensions but has at most only mo non-zero eigenvalues.
Although there are standard linear algebra packages which could solve these
equations directly, implementing an eﬃcient, general method would be diﬃcult
since the non-zero eigenvalues can range between
and all m0
It has been shown,14 however, that by partitioning the
of them are needed.
o) or
matrices according to whether the basis functions are non-zero (open
zero (closed

c) on Σ, i.e. by writing

and +

−∞

∞

≡

≡

Γcc Γco
Γoc Γoo

cc
co

= b

0
0
0 Λoo

(cid:18)

(cid:19) (cid:18)

(cid:19)

cc
co

,

(cid:19)

(cid:19) (cid:18)
(cid:18)
mo) eigensystem

Eq. (7) can be reduced to a small (mo ×

(12)

(13)

Ωoo ~co = b Λoo ~co

11

where Ωoo = Γoo
Γoc(Γcc)−1Γco. The main computational burden is thus
shifted to constructing Ωoo. Since Γcc is a large banded matrix in the FEM
representation, this is most eﬃciently accomplished by solving the set of linear
equations

−

Γcc ~X = Γco.

(14)

×

The solution ~X = (Γcc)−1Γco thus provides the needed matrix inverse. Γcc
4M N , but with a half-bandwidth (number of non-zero
has dimensions 4M N
1 resulting from the FEM
diagonals above the main diagonal) of only 6M
representation. Γco has dimensions 4M N
mo. We use standard LAPACK16
routines to solve equations 13 and 14. The eigenvalues b and eigenvectors ~co
completely specify the linearly independent solutions of the Schr¨odinger equa-
tion on the surface Σ. This information is generally packaged in terms of a
R-matrix

−

×

Rmm′ =

Zmβb−1

β Z −1
βm′

Xβ

(15)

where the columns of Z are given by the eigenvectors ~co. The S-matrix is then
obtained through simple matrix manipulations involving only the R-matrix and
the two linearly independent solutions of the asymptotic form of the Schr¨odinger
equation.14

8N
For the two-channel test problem described above, Eq. (14) is a 8N
matrix equation with a half-bandwidth of 11, and only one solution is required
since there is only a single open channel, mo=1. The present formulation of the
R-matrix method focuses the computational eﬀort on ﬁnding only the relevant
scattering information. Thus, only the coeﬃcient in the open channel K1 is
obtained. The results are shown in the table below as a function of the number
of sectors N used.

×

Table 5. Results for the Finite Element Method

K1
0.312345739663914
0.312334009008278
0.312334008856244
0.312334008759115
0.312334006921697

−
−
−
−
−

N
400
800
1600
3200
6400

C. The Gordon Algorithm.

The Gordon algorithm,34 is a well-established numerical method to solve
for the scattering solutions of a set of Nc coupled radial Schr¨odinger equations.
Similar to the FEM discussed in the previous section, this algorithm is local in

12

the sense that the wavefunction is propagated from R to R + dR using only the
wavefunction at R. The version of the Gordon method used here is described
in Ref..17 The main diﬀerence from the original Gordon method is in replacing
the Airy functions, which correspond to the reference solutions for linearized
potentials, by sin qr or cos qr in each interval dR. Here the quantities q are the
local wavenumbers of each channel in the interval dR . They are obtained by
replacing the potential matrix in interval dR by an averaged constant potential,
and then diagonalizing this potential. If the local energy is negative then exp(qr)
or exp(
qr) are used instead. The wave function in the diagonalized interval
dR is represented in each channel n by Ψn = An(r) sin qnr + Bn(r) cos qnr,and
the vector of the coeﬃcients A and B are calculated by solving a system of ﬁrst
order coupled diﬀerential equations involving the diﬀerence between the true
and the averaged potential matrix in interval dR. In the intervals where some
of the local energies are negative (i.e., some of the q’s are imaginary), the unde-
sired exponentially increasing functions are minimized by a ”triangularization”
method developed by Gordon. Analytic connection formulas between R and
R + dR determine A and B, and thus the solution is propagated towards the
ﬁnal matching point. Consequently no large linear system needs to be evaluated
in the Gordon algorithm and hence the method is not memory limited.

−

≃

The physical boundary conditions for the solution are obtained by ﬁrst calcu-
lating Nc linear independent solutions from diﬀerent initial conditions near the
origin, and then constructing appropriate linear combination of these ”math-
ematical” solutions. The stepsize dR is calculated on the ﬂy. After a ﬁxed
number of steps (say ten) the percentage change of the A and B coeﬃcients
10, is compared to an accuracy cri-
between intervals n and n + i, where i
terium. If the variation is too large, the step size is repeatedly halved until the
accuracy criterion is met. On the other hand if the coeﬃcients hardly changed
the step size is doubled. Consequently, if the potential is well approximated by a
constant, large steps are taken. Closed channels are removed from the propaga-
tion when the corresponding amplitude of the channel wavefunction has become
smaller than a threshold parameter. The inﬂuence of these components on the
scattering properties of the asymptotically accessible channel is then negligible.
Our results with this algorithm for Rcut=4 a0 and Rmax=500 a0 are sum-
marized in Table 6. The columns describe the fractional change of the A and B
coeﬃcients, the number of steps, and K1, respectively. It is immediately clear
that the Gordon method uses many more steps than the other two numerical
methods. As discussed before this is not crucial as it is not necessary to store
the wavefunction at every step in order to propagate the wavefunction.

Table 6. Results for the Gordon Method

13

Fract’l
Change
0.1000
0.0500
0.0250
0.0100
0.0050
0.0020
0.0010
0.0005

No of
steps
7025
7632
8353
9796
11402
14454
18179
25502

K1
-0.312348088
-0.312340564
-0.312337479
-0.312335340
-0.312334854
-0.312334070
-0.312334067
-0.312334020

III. Discussion

A comparison between the three methods is displayed in Table 7, which lists

the number of mesh points required to achieve a certain accuracy for K1.

Table 7. Comparison between three methods.

IEM
FEM
Gordon

K1
-0.3123339834
-0.312334009
-0.3123340

No of
partit’s
153
800
25,502

No of
Pts/part.
16
4
1

Total No
of Points..
2,448
3,200
25,502

The ﬁnite element (FEM) and the integral equation (IEM) methods are
nearly identical in performance. Both can easily adjust the size of the partitions
to the local conditions of the potentials; both give stability of at least nine
signiﬁcant ﬁgures, and both use approximately the same number of mesh points.
Their numerical complexity is also comparable since a CPU-time test shows that
both use approximately the same computer time for the case tested here. The
10−8) for K1.
IEM and the FEM diﬀer in the 8th signiﬁcant ﬁgure (by 2.6
The reason for this diﬀerence is not known, but could be related to the fact
that both the FEM and the Gordon methods have not yet fully converged as
the number of partitions is increased, as can be seen from Tables 5 and 6, and
in Figs. 2 and 3. These ﬁgures show the value of K1, from the ﬁfth signiﬁcant
ﬁgure onward, as a function of the total number of mesh points for each of the
three methods in progressively larger detail. The somewhat slower convergence
for the FEM may be due to the fact that the algorithm for determining the
partition size, especially in the vicinity of a turning point, is not as reﬁned for
the FEM as for the IEM.

×

14

Figure 2: Comparison of the rate of convergence of the numerical value of K1 as
a function of the total number of mesh-points N. On the vertical axis is plotted
the value of K1 from the ﬁfth signiﬁcant ﬁgure onwards. This is accomplished
by subtracting -0.312300000 from each value of K1 and multiplying the result
by 104. The values of K1 are taken from Tables 2, 5, and 6 for the IEM, FEM
and Gordon methods. They are represented by solid circles, open circles and
squares, respectively

15

Figure 3: Same as Fig. 2 with a larger magniﬁcation.

16

The Gordon method is simpler to implement than the two other ones and
gives a respectable accuracy of seven signiﬁcant ﬁgures, albeit at the expense
of a much larger number of mesh points, which in turn leads to a larger ac-
cumulation of roundoﬀ errors. An improved Numerov method gave only four
signiﬁcant ﬁgures (K1= -0.31233(2)) and is not mentioned further. In the IEM,
the boundary conditions are built in automatically via the Green’s functions,
while in the present form of the FEM the solutions with exponential growth are
eliminated by forcing the closed channel component to be zero on the surface
Σ. In a separate study of two coupled equations,7 it is shown that there are
situations in which the conventional Numerov method has severe diﬃculty in
obtaining the correct asymptotic boundary condition, while both the IEM and
the FEM do not.

It should be clear that the accuracy achieved in this benchmark calculation
is not directly relevant for physical applications, since the potentials are usually
known only to low accuracy. Instead, the accuracy achieved is to be construed
as a measure of the stability of the method, which gives an indication of how
well the method is expected to perform under more complex situations, such
as when many channels are involved, or when the range of the interaction is
excessively large, or at very high energies where many oscillations in the wave
functions are present.

In conclusion, all three methods performed well in providing a numerical
solution to the coupled channel test case examined here. This case could serve
as a benchmark calculation for testing additional methods, since the eﬀective
range and the scattering length are also calculated. Further comparison of
various methods under more complex conditions would be desirable in order to
determine the conditions under which a particular one of the methods would be
preferable.

Acknowledgments: E.T. would like to acknowledge useful discussions with
Dr. Fred Mies, who has implemented the original version of the Gordon method
used by the authors.

IV. Appendix 1. Perturbative treatment of the long-range

corrections.

As the value of Rmax (this is the truncation radius beyond which all poten-
tials are set to zero) is increased, the values of K1 and K2, deﬁned in Eq. (5)
change slightly because of the non-zero value of the potential at large distances.
, it is preferable to include the
In order to extrapolate the K values to Rmax =
long-range tail of the potential perturbatively rather than numerically. Showing

∞

17

how this can be done is the purpose of this appendix. It is of course also possi-
ble to include the long range tails numerically, as has been done in Ref.18 The
variation of the K’s with large distances, as given in Table 3, can be reproduced
numerically by means of perturbation theory, as will now be shown.

For this section we assume that the radial distance is suﬃciently large so that
the coupling potential between the two channels is negligible. Thus, only the
eﬀect of the diagonal potential in each channel i on Ki needs to be considered.
We also continue to assume that the angular momentum number ℓ is zero. Both
assumptions can removed by a generalization of the present discussion.

A. The positive energy channel.

We will denote two consecutive values of Rmax by T1 and T2., respectively,
and assume that the numerical calculation extends out to T1. We denote by
V1(r) the diagonal potential for r
T1 and set V1(r) = 0 for r > T1. The
corresponding wave function is denoted by ψ1 which is equal to the wave function
ψP known numerically. Because V1(r) = 0 for r > T1,

≤

ψ1(r) = sin(kr) + K1(T1) cos(kr).

(16)

T2 and V2(r) = 0 for
Similarly, V2(r) is equal to the diagonal potential for r
r > T2. The corresponding wave function, to be calculated perturbatively, is
denoted by ψ2. It obeys the equation
ψ2 = 0, which can be
written

V2 + k2

d2/dr2

≤

−

d2/dr2 + k2

(cid:0)
ψ2 = V ′ψ2 r

(cid:1)
T1,

≥

where

(cid:0)

(cid:1)

V ′(r) = V2(r) f or r
V ′(r) = 0

T1
f or r < T1.

≥

Thus, V ′ is the perturbative potential which vanishes outside of the interval
[T1, T2]. Using for the inverse of the operator
the Green’s function
cos(kr>), one obtains the most general
integral expression in terms of sin(kr<)
form for ψ2

d2/dr2 + k2

×

(cid:1)

(cid:0)

ψ2(r) = α sin(kr) + β cos(kr) + sin(kr)Σc(r) + cos(kr)Σs(r)

(19)

where

and

Σc(r) =

cos(kr′)V ′(r′)ψ2(r′)dr′

Σs(r) =

sin(kr′)V ′(r′)ψ2(r′)dr′.

1
k

−

1
k

−

T2

r
Z

r

T1

Z

18

(17)

(18)

(20)

(21)

The coeﬃcients α and β are obtained by matching ψ2 to ψ1 at r = T1, i.e., setting
the two functions and their derivatives equal. Remembering that Σs(T1) = 0,
that (1/k) (dψ2/dr)r=T1 = αs1+c1 (
c1 −

−
K1(T1)s1, where s1 = sin(kT1) and c1 = cos(kT1), one obtains

β + Σc(T1)) , and that (1/k) (dψ1/dr)r=T1 =

α = 1

Σa(T1), β = K1(T1).

−

(22)

Inserting the above result into Eq. (19), one obtains for r

T2 the result

≥

ψ2(r) = (1

Σc(T1)) sin(kr) + (K1(T1) + Σs(T2)) cos(kr).

(23)

−

The ﬁrst order perturbation result for the above expressions is obtained by
replacing ψ2 by ψ1 in the integrals for Σc and Σs in Eqs.above. Denoting the
corresponding integrals from T1 to T2 by Ic and Is, respectively

Ic =

−

Is =

−

1
k

1
k

T2

T1

Z

T2

T1

Z

cos(kr′)V ′(r′)ψ1(r′)dr′

sin(kr′)V ′(r′)ψ1(r′)dr′,

(24)

(25)

one ﬁnally obtains the ﬁrst order result for K1(T2)

K (1)

1 (T2) =

K1(T1) + Is

Ic

1

−

≃

K1(T1) + Is + K1(T1)

Ic.

(26)

×

This is our ﬁnal expression. The numerical evaluation was carried out ini-
tially by using MATHEMATICA19to evaluate the integrals involving products
of circular functions and 1/r6. For example, if T1 and T2 are set equal to 500
and 2000a0 respectively, and using for C6 the value stated above, one ﬁnds
10−5. Using for K2(500) the value from
10−5 and Is =
Ic =
Table 3, one obtains from Eq. (26) the result

1.6105

8.443

×

−

−

×

K (1)

2 (2000)

K2(500) = 1.0265

10−5,

−
which compares very well with the numerical result from Table 3

×

K2(2000)

K2(500) = 1.0264

−

10−5.

×

The results for the scattering length and the eﬀective range, described in
the text, were calculated by a FORTRAN code which expresses the integrals
∞
∞
x [cos(t)/t]dt in terms of the functions Ci and Si. The latter
x [sin(t)/t]dt and
were called from the IMSL scientiﬁc library, and generalization to larger powers
R
R
of t in the denominator (like t6 in the present case) were obtained recursively
through integrations by part.

19

B. The negative energy channel.

For the negative energy channel a similar perturbative procedure will now be
described. In what follows ψ1 and ψ2 now refer to the negative energy channel
but otherwise they have the same meaning. The function ψ1 coincides with the
numerical solution ψN for r

r is given by

T1, while ψ2 for T1 ≤

≤

ψ2(r) = γG2(r)

F2(r)

G2V ′ψ2dr′

G2(r)

F2V ′ψ2dr′.

(27)

1
κ

−

T2

r

Z

1
κ

−

r

T1

Z

Here F2(r) and G2(r) are equal, respectively to exp(
setting ψ2 equal to ψ1 at r = T1 one obtains

−

κr) and sinh(κr). By

γ =

1
G2(T1)  

ψ1(T1)

1
κ

−

T2

T1

Z

G2(r′)V ′(r′)ψ2(r′)dr′F2(T1)

,

!

Inserting the above into Eq.(27) evaluated at r = T2, replacing ψ2 in the inte-
grals in the above expressions by

and dividing the result by G2(T2), one obtains a preliminary value for K2(T2)

ψ2(r)

K2(T1)G2(r)

≃

¯K2(T2) = K2(T1)

F2(T1)
G2(T1)

−

Ie + Ihs

where

Ie =

K2(T1)
κ

−

Z
K2(T1)
κ

Ihs =

−

T2

T1

T2

T1

Z

G2(r′)V ′(r′)G2(r′)dr′

F2(r′)V ′(r′)G2(r′)dr′

(28)

The ﬁnal value of K2(T2) is obtained by dividing ¯K2(T2) by the same normaliz-
Ic) which was required to normalize the wave function in channel
ing factor (1
1 so that the coeﬃcient in front of sin(kr) be equal to 1. The ﬁnal expression is

−

K2(T2) =

K2(T1)(1 + Ic)

Ie + Ihs

(29)

¯K2(T2)
(1

Ic) ≃

−

F2(T1)
G2(T1)

−

Using for T1 and T2 the values 500a0 and 2000a0 respectively, numerical eval-
10−4 while the numerical

K2(T1)

uation of Eq. (29) gives K2(T2)
−
value obtained from Table 3 gives

5.430

≃ −
×

≃ −

5.445
10−4

×

20

References

(1999);

1J. Weiner, V. Bagnato, S Zilio and P. S. Julienne, Rev. Mod. Phys. 71, 1

2A. Fioretti, D. Comparat, C. Drag, T. F. Gallagher, and P. Pillet, Phys. Rev.

Lett. 82, 1839 (1999).

3R. G. Gordon, J. Chem. Phys. 51, 14 (1969), R. G. Gordon, in Methods in
Computational Physics ,( B. J. Alder, S. Fernbach and M. Rotenberg, Eds.),
Vol. 10, pp 81-110. Academic Press, New York, 1971);

4Gh. Adam, L. Gr. Ixaru and A. Corciovei, J. Comput. Phys. 22, 1-33 (1976)

and references therein.

5J. P. Burke Jr., C. H. Greene, and B. D. Esry, Phys. Rev. A54, 3225, (1996);
K. J. Bathe, Finite Element Procedures in Engineering Analysis, Prentice
Hall, Englewood Cliﬀs, NJ, 1976; K. J.Bathe and E. Wilson, Numerical
Methods in Finite Element Analysis, Prentice Hall, Englewood Cliﬀs, NJ,
1976; L. R. Ram-Mohan, S. Saigal, D. Dossa, and J. Shertzer, Comput.
Phys. 4, 50 (1990).

6R. A. Gonzales, J. Eisert, I. Koltracht, M. Neumann and G. Rawitscher, J. of

Comput. Phys. 134, 134 (1997);

7R. A. Gonzales, S.-Y. Kang, I. Koltracht, and G. Rawitscher, Integral Equa-
tion Method for Coupled Schr¨odinger Equations, J. of Comput. Phys., J.
Comput. Phys. 153, 160 (1999);

8T. E. Simos and Ch. Tsitouras, J. Comput. Phys. 130, 123 (1997); A.D. Raptis
and J. R. Cash, Comp. Phys. Commun. 44,95 (1987); T. E. Simos, Accu-
rate Computations for the elastic scattering phase-shift problem, Computers
Chem. 21, 125 (1997), and references there in.

9R. Kosloﬀ, J. Phys. Chem. 92, 2087 (1988);

10E. Fattal, R. Baer and R. Kosloﬀ, Phys. Rev. E 53, 1217 (1966);

11V. Kokoouline, O. Dulieu, R. Kosloﬀ and F. Masnou-Seeuws, J. Chem. Phys.,

110, 9865 (1999);

12E. R. Bittner and J. C. Light, J. Chem. Phys. 102, 2614 (1995);

13M. Marinescu, H. R. Sadeghpour and A. Delgarno, Phys. Rev. A 49, 892

(1994).

14Chris H. Greene, Phys. Rev. A 28, 2209 (1983); H. Le Rouzo and G. Raseev,
Phys. Rev. A 29, 1214 (1984); M. Aymar, Chris H. Greene, and E. Luc-
Koenig, Revs. Mod. Phys. 68,1016 (1996).

21

15E. P. Wigner, Phys. Rev. 70, 15 (1946); E. P. Wigner and L. Eisenbud, Phys.
Rev. 72, 29 (1947);T Teichman and E. P. Wigner, Phys. Rev. 87, 123 (1952).

16E. Anderson, Z. Bai, C. Bischof, J. Demmel, J. Dongarra, J. Du Cros, A.
Greenbaum, S. Hammerling, A. Mckenney, S. Ostouchov, and D. Sorensen ,
LAPACK Users Guide, (SIAM, Philadelphia, 1992).

17F. H. Mies, Phys. Rev. A 7, 957 (1973).

18J. P. Burke, Jr., C. H. Greene, and J. L. Bohn, Phys. Rev. Lett. 81, 3355

(1999); Bo Gao, Phys. Rev. A58, 4222 (1998), ibid 58, 1728 (1998)

19S. Wolfram Mathematica: A System for doing Mathematics by Computer,

Second Edition. Addison-Wesley, Redwood City, CA, 1991.

22

0.34030

0.34018

0.34005

0.33992

0.33980

2

10

3

10

4

10

5

10

Number of mesh points

0.49

0.45

0.41

0.37

0.33

2

10

3

10

4

10

5

10

Number of mesh points

Cold collision

Tol=E-3

Tol=E-6

Tol=E-9

10

8

5

.
o
n
 
n
o
i
t
i
t
r
a
P

200

150

100

50

0

0 100 200 300 400 500
radial distance (a0)

