0
0
0
2

 

b
e
F
9
2

 

 
 
]
h
p
-
o
i
b

.
s
c
i
s
y
h
p
[
 
 

1
v
3
5
0
2
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

SAMPLING PROPERTIES OF THE
SPECTRUM AND COHERENCY OF

SEQUENCES OF ACTION POTENTIALS

M. R. Jarvis(1) and P. P. Mitra(2)

February 2, 2008

(1) Division of Biology, California Institute of Technology, Pasadena, 91125 USA
(2) Bell Laboratories, Lucent Technologies, Murray Hill, New Jersey, 07974 USA

Abstract

The spectrum and coherency are useful quantities for characterizing the
temporal correlations and functional relations within and between point
processes. This paper begins with a review of these quantities, their inter-
pretation and how they may be estimated. A discussion of how to assess
the statistical signiﬁcance of features in these measures is included. In ad-
dition, new work is presented which builds on the framework established
in the review section. This work investigates how the estimates and their
error bars are modiﬁed by ﬁnite sample sizes. Finite sample corrections
are derived based on a doubly stochastic inhomogeneous Poisson process
model in which the rate functions are drawn from a low variance Gaussian
process. It is found that, in contrast to continuous processes, the variance
of the estimators cannot be reduced by smoothing beyond a scale which is
set by the number of point events in the interval. Alternatively, the degrees
of freedom of the estimators can be thought of as bounded from above by
the expected number of point events in the interval. Further new work de-
scribing and illustrating a method for detecting the presence of a line in a
point process spectrum is also presented, corresponding to the detection of
a periodic modulation of the underlying rate. This work demonstrates that
a known statistical test, applicable to continuous processes, applies, with
little modiﬁcation, to point process spectra, and is of utility in studying a
point process driven by a continuous stimulus. While the material discussed
is of general applicability to point processes attention will be conﬁned to
sequences of neuronal action potentials (spike trains) which were the moti-
vation for this work.

1

Keywords and phrases: Spectrum, coherency, coherence, multitaper, lag
window, spike train analysis, point processes, ﬁnite size eﬀects in spectra,
doubly stochastic Poisson process

1 Introduction

The study of spike trains is of central importance to electrophysiology. Often
changes in the mean ﬁring rate are studied but there is increasing interest in
characterising the temporal structure of spike trains, and the relationships between
spike trains, more completely (Gray et al., 1989; Gerstein et al., 1985; Abeles
et al., 1983). A natural extension to estimating the rate of neuronal ﬁring is to
estimate the autocorrelation and the cross-correlation functions1. This paper will
discuss the frequency domain counterparts of these quantities. Auto- and cross-
correlations correspond to spectra and cross spectra respectively. The coherency,
which is the normalised cross spectrum, does not in general have a simple time
domain counterpart.

The frequency domain has several advantages over the time domain. Firstly
often subtle structure can be detected with the frequency domain estimators which
is diﬃcult to observe with the time domain estimators. Secondly, the time domain
quantities have problems which are associated with sensitivity of the estimators
to weak non-stationarity and the non-local nature of the error bars (Brody, 1998).
These problems are greatly reduced in the frequency domain. Thirdly, reasonably
accurate conﬁdence intervals may be placed on estimates of the second order
properties in the frequency domain which permits the statistical signiﬁcance of
features to be assessed. Fourthly, the coherency provides a normalised measure of
correlations between time series, in contrast with time domain cross-correlations
which are not normalisable by any simple means.

This paper begins by reviewing the population spectrum and coherency for
point processes and motivating their use by describing some example applications.
Next direct, lag window and multitaper estimators of the spectrum and coherency
are presented. The concept of degrees of freedom is introduced and used to obtain
large sample error bars for the estimators. Many elements of the work discussed
in the review section of this paper can be found in the references (Percival and
Walden, 1993; Cox and Lewis, 1966; Brillinger, 1978; Bartlett, 1966). Most of the
material in these references is targeted at either spectral analysis of continuous
processes or at the analysis of point processes but with less emphasis on spectral
analysis. Building on this framework corrections, based on a speciﬁc model, will
be given for ﬁnite sample sizes. These corrections are cast in terms of a reduction
in the degrees of freedom of the estimators. For a homogeneous Poisson process
the modiﬁed degrees of freedom is the harmonic sum of the the asymptotic de-

1Deﬁnitions of these quantities will be given in section 2.3.

2

grees of freedom and twice the number of spikes used to construct the estimate.
Modiﬁcations to this basic result are given for structured spectra and tapered
data. A section is included on the treatment of point process spectra which con-
tain lines. A statistical test for the presence of a line in a background of coloured
noise is given, and the method for removal of such a line described. An example
application to periodic stimulation is given.

2 Population measures and their interpretation

2.1 Counting representation of a spike train

A spike train may be regarded as a point process. If the spike shapes are neglected,
it is completely speciﬁed by a series of spike times {ti} and the start and end points
of the recording interval [0, T ]. It is convenient to introduce some notation which
enables the subsequent formulae to be written in a compact form (Brillinger,
1978). The counting process N(t) is deﬁned as the number of spikes which occur
between the start of the interval (t = 0) and time t. The counting process has the
property that the area beneath it grows as t becomes larger. This is undesirable
because it leads to an interval dependent peak at low frequencies in the spectrum.
To avoid this a process N (t) = N(t)−λt, where λ is the mean rate, which has zero
mean may be constructed. Note that dN(t) = N (t + dt) − N (t) which is either
1 − λdt
or −λdt depending on whether or not there is a spike in the interval
dt. Thus dN(t)/dt is a series of delta functions2 with the mean rate subtracted.
Figure 1 illustrates the relationship between N(t), N (t), and dN(t)/dt.

N(t)

N(t)

0

time 

T

0

time 

dN(t)
dt

T

0

time 

T

Figure 1: Example illustrating how the processes N, N and dN /dt relate to each
other. The vertical lines in the process dN /dt depict delta functions.

2A delta function is a generalized function. It has an area of one beneath it but has zero

width and therefore inﬁnite height.

3

2.2 Stationarity

In many electrophysiology experiments this is not the case.

It will be assumed in what follows that the spike trains are second order stationary.
This means that their ﬁrst and second moments do not depend on the absolute
time.
In awake
behaving studies the animal is often trained to perform a highly structured task.
Nevertheless it may still be the case that over an appropriately chosen short
time window, the statistical properties are changing slowly enough for reasonable
estimates of the spectrum and coherency to be obtained. As an example, neurons
in primate parietal area PRR exhibit what is known as memory activity during
a delayed reach task (Snyder et al., 1997). The mean ﬁring rate of these neurons
varies considerably during the task but during the memory period is roughly
constant. The assumption of stationarity during the memory period is equivalent
to the intuitive notion that there is nothing special about 0.75s into the memory
period as compared to say 0.5s. Second order stationarity implies that the mean
ﬁring rate (λ) is independent of time and additionally that the autocovariance
depends only on the lag (τ ) and not on the absolute time.

2.3 Deﬁnitions

Equations 1 - 4 give the ﬁrst and second order moments of a single spike train
for a stationary process. The spectrum S(f ) is the Fourier transform of the
autocovariance function (µ(τ ) + λδ(τ )).

E{dN(t)}
E{dN(t)}

dt

dt

= λ

= 0

µ(τ ) + λδ(τ ) =

S(f ) = λ +Z ∞

−∞

E[dN(t)dN (t + τ )]

dtdτ

µ(τ ) exp(−2πif τ )dτ

(1)

(2)

(3)

(4)

Where E denotes the expectation operator.

The autocovariance measures how likely it is that a spike will occur at time t+τ
given that one has occurred at time t. Usually µ(τ ) is estimated rather than the
full autocovariance which includes a delta function at zero lag3. However, in order
to take the Fourier transform the full autocovariance is required. The inclusion
of this delta function leads to a constant oﬀset of the spectrum. This oﬀset is an

3When estimating the autocovariance using a histogram method one generally omits the

spike at the start of the interval which would always fall in the bin nearest zero.

4

important diﬀerence between continuous time processes and point processes. The
population coherency γ(f ) is deﬁned in equations 5 - 7.

E[dN a(t)dN b(t + τ )]

µab(τ ) =

dtdτ

qS11(f )S22(f )

Sab(f ) = Z ∞

−∞

γ(f ) =

µab(τ ) exp(−2πif τ )dτ + λaδab
S12(f )

(5)

(6)

(7)

Where indices 1 and 2 denote simultaneously recorded spike trains from diﬀerent
cells.

Unlike the spectrum, which is strictly real and positive, the coherency is a
complex quantity. The modulus of the coherency, which is known as the coher-
ence4, can only vary between zero and one. This makes coherence particularly
attractive for detecting relationships between spike trains as it is insensitive to
the mean spike rates.

3 Examples and their interpretation

Before discussing the details regarding how to estimate the spectrum and co-
herency it will be helpful to motivate them further by considering some simple
examples.

3.1 Example population spectra

For a homogeneous Poisson process of constant rate λ the autocovariance is simply
λδ(τ ) and hence the spectrum is a constant equal to the rate λ. At the opposite
extreme consider the case where the spikes are spaced by intervals ∆τ . This is not
a stationary process but if a small amount of drift is permitted, so that over an
extended period there is nothing special about a given time, it becomes stationary.
The spectrum of this process contains sharp lines at integer multiples of f = 1
∆τ .
Due to the drift the higher harmonics will become increasingly blurred and in the
high frequency limit the spectrum will tend towards a constant value of the mean
rate λ. As a ﬁnal example consider the case where µ(τ ) is a negative Gaussian
centered on zero τ . This form of µ(τ ) is consistent with the probability of ﬁring
being suppressed after ﬁring5. The spectrum of this process will be below λ at

4Some authors deﬁne coherence as the modulus squared of the coherency.
5This need not necessarily correspond to the biophysical refractive period but, it could arise,

rather from a characteristic integration time.

5

low frequencies and will go to a constant value λ at high frequencies. Figure 2
illustrates these diﬀerent population spectra.

S(f)

λ

S(f)

λ

S(f)

λ

f

(a)

f

(b)

f

(c)

Figure 2: Example population spectra for diﬀerent types of underlying process.
(a) Homogeneous Poisson process with rate λ. (b) Regularly spaced spikes with
jitter. (c) Spike trains in which the probability of ﬁring is suppressed immediately
after ﬁring.

3.2 Example population coherency

The population coherency of two homogeneous Poisson processes is zero. In con-
trast if two spike trains are equal then the coherence is one and the phase of the
coherency is zero at all frequencies. If two spike trains are identical but oﬀset by
a lag ∆τ then the coherence will again be one but the phase of the coherency
will vary linearly with frequency with a slope proportional to ∆τ and given by
φ(f ) = 2πf ∆τ .

4 Estimating the spectrum

Section 3 demonstrated that the population spectrum may provide insights into
the nature of a spike train. In this section the question of how to estimate the
spectrum from a ﬁnite section of data will be introduced.
In what follows the
population quantity λ in the deﬁnition of N(t) is replaced by a sample estimate
N(T )/T .

4.1 Direct Spectral Estimators

4.1.1 Deﬁnition

A popular, though seriously ﬂawed, method for estimating the spectrum is to take
the modulus squared of the Fourier transform of the data dN(t). This estimate
is known as the Periodogram and is the simplest example of a direct spectral
estimator. More generally, a direct spectral estimator is the modulus squared
of the Fourier transform of the data but with the data being multiplied by an
envelope function h(t), known as a taper (Percival and Walden, 1993). Equations

6

8 - 10 deﬁne the direct estimator. On substituting N (t) into equation 9 a form
amenable to implementation on a computer is obtained (equation 11).
In this
form the Fourier transform may be computed rapidly and without the need for
the binning of data. Note that equation 10 results in h(t) scaling as 1/√T as
the sample length is altered. This ensures proper normalization of the Fourier
transformation as sample size varies.

Where,

Z T

0

I D(f ) = |J D(f )|2
J D(f ) = Z T

0

h(t)e−2πif tdN(t)

h(t)2dt = 1

J D(f ) =

N (T )

Xj=1

h(tj)e−2πif tj −

N(T )H(f )

T

(8)

(9)

(10)

(11)

and H(f ) is the Fourier transform of the taper.

The direct estimator suﬀers from bias and variance problems, described below,

and is of no practical relevance for a single spike train sample.

4.1.2 Bias

It may not be immediately apparent why the above procedure is an estimate of the
spectrum, especially when one is permitted to multiply the data by an arbitrary,
albeit normalized, taper. The relation between I D(f ) and the spectrum may be
obtained by taking the expectation of equation 8.

E{I D(f )} = E{Z ∞

−∞Z ∞

−∞

h(t)h(t′)e−2πif (t−t′)dN(t)dN(t′)}

(12)

Assuming that the integration and expectation operations may be interchanged

and substituting equation 3 yields 6,

E{I D(f )} = Z ∞

−∞Z ∞

−∞

h(t)h(t′)e−2πif (t−t′){µ(t − t′) + λδ(t − t′)}dtdt′

(13)

Which may be rewritten in the Fourier domain as,

E{I D(f )} = Z ∞

−∞

S(f ′)|H(f − f ′)|2df ′

(14)

6For the moment, we assume that the population quantity λ is known. This is of course not
the case in practice, and one employs the estimate N (T )/T as stated before. The eﬀect of this
extra uncertainty is given in equation 15.

7

The expected value of the direct estimator is a convolution of the true spectrum
and the modulus squared of the Fourier transform of the taper. The normaliza-
tion condition on the taper (equation 10) is equivalent to the requirement that the
kernel of the convolution has unit area underneath it. Sharp features in the true
spectrum will be thus be smeared by an amount which depends on the width of
the taper in the frequency domain. If the taper is well localized in the frequency
domain the expected value of the direct estimate is close to the true spectrum but
if the taper is poorly localized then the expected value of the direct estimator will
be incorrect i.e. the direct spectral estimator is biased. There is a fundamental
level beyond which the bias cannot be reduced, due to the uncertainty relation for-
bidding simultaneous localization of a function in the time and frequency domains
below a given limit. Since the maximum width of the taper is T the minimum
frequency spread is 1/T which is known as the Raleigh frequency. Figure 3 shows
the smoothing kernel for a rectangular taper and a T of 0.5s. Note that this kernel
has large sidelobes which is the primary motivation for using tapering.

0

−0.5

−1

−1.5

0
1

2

|
)
f
(
h

|

g
o

l

−2

−2.5

−3
−6

−4

0

−2
frequency (Hz)

2

4

6

Figure 3: The smoothing kernel |H(f )|2. This is the expected direct estimate
of the spectrum in the case of a population spectrum which has a delta function
(very sharp feature) at the center frequency. A rectangular taper of length 0.5s
was used. Solid vertical lines are drawn at ± the Raleigh frequency.

In the above argument equation 3 was used in spite of the appearance of the
population quantity λ rather than the sample estimate N(T )/T for which equation
12 was deﬁned. A more careful treatment, which includes this correction, leads to
an additional term at ﬁnite sample sizes in the expectation of the direct spectral
estimator at low frequencies. The full expression is given below,

E{I D(f )} = Z ∞

−∞

(15)
In the case of the periodogram, where h(t) = 1/√T , the eﬀect is clear since in

S(f ′)|H(f − f ′)|2df ′ − |H(f )|2S(0)/T

this case J D(0) = 0 and hence I D(0) = 0 for any set of spike times and any T.

4.1.3 Asymptotic variance

In the previous section it was shown that provided the taper is suﬃciently local in
frequency the expected value of the direct spectral estimator will be close to the

8

true spectrum. However, the fact that the estimate is on average close to the true
spectrum belies a serious problem with direct spectral estimators, namely that the
estimates have very large ﬂuctuations about this mean. The underlying source of
this problem is that one is attempting to estimate the value of a function at an
inﬁnite number of points using a ﬁnite sample of data. The problem manifests
itself in the fact that direct spectral estimators are inconsistent estimators of the
spectrum7. In fact it may be shown that, under fairly general assumptions, the
estimates are distributed exponentially (or equivalently as S(f )χ2
2/2) for asymp-
T → ∞) (Brillinger, 1972). Figure 4 illustrates that
totic sample sizes (i.e.
direct spectral estimators are noisy and untrustworthy, a fact emphasised by the
observation that the χ2
2 distribution has a standard deviation equal to its mean.
In the next three subsections methods for reducing the variance of direct spectral
estimators using diﬀerent forms of averaging will be discussed.

m
u
r
t
c
e
p
s

 1000

  100

   10

    1

  0.1

 0.01

0.001
0

2

4

6

8

10

frequency (Hz)

Figure 4: An example of a direct spectral estimate. A 40% cosine taper was used.
A sample of duration 20s was drawn from a homogeneous Poisson process with
a constant rate of 50 Hz. The population spectrum for this process is ﬂat and is
shown by the solid horizontal line. The direct spectral estimate is clearly noisy
although on average the correct spectrum is obtained.

4.2 Trial averaging

If there are a number of trials (NT ) available then the variance of the direct
estimator may be reduced by trial averaging.

I DT (f ) =

1
NT

NT

Xn=1

I D
n (f )

(16)

Where I D

n (f ) is the direct spectral estimate based on the nth trial.

2 distribution the result of which is distributed as χ2

In the large T limit taking the average entails summing NT independent sam-
ples from a χ2
2NT . The reduc-
tion in variance is inversely proportional to the number of trials corresponding to
a reduction in standard deviation which is the familiar factor of 1/√NT .
7Inconsistent estimators have a ﬁnite variance even for an inﬁnite length sample.

9

At ﬁrst sight it appears one would be getting something for nothing by breaking
a single section of data into NT segments and treating them as separate trials. This
is, of course, not the case. The reason is that if the data is segmented into short
length samples, there is loss of frequency resolution proportional to the inverse of
segment length. Lag window and multitaper estimators use the information from
these independent estimates without artiﬁcially segmenting the data.

4.3 Lag Window Estimates

A powerful property of the frequency domain is that, unless two frequencies are
very close together, direct estimates of the spectrum of a stationary process at
diﬀerent frequencies are nearly uncorrelated. This property arises when the covari-
ance between frequencies falls oﬀ rapidly. If the true spectrum varies slowly over
the width of the covariance then the large sample covariance of a direct spectral
estimator is given by equation 17.

Z ∞
cov{I D(f1), I D(f2)} ≃ E{I D(f )}2(cid:12)(cid:12)(cid:12)(cid:12)

−∞

Where f = (f1 + f2)/2 and ∆f = f1 − f2

2

h(t)2e−2πi∆f tdt(cid:12)(cid:12)(cid:12)(cid:12)

(17)

For ∆f = 0, this expression reduces to the previously mentioned result that
the variance of the estimator is equal to the square of the mean. For ∆f >> 1/T ,
|R ∞
−∞ h(t)2e−2πi∆f tdt|2 → 0, since h(t)2 is a smooth function with extent T . This
implies that cov{I D(f1), I D(f2)} ≈ 0 for |f1 − f2| >> 1/T . The approximate
independence of nearby points means that, if the true spectrum varies slowly
enough, then closely spaced points will provide several independent estimates of
the same underlying spectrum. This is the motivation for the lag window estimator
which is simply a smoothed version of the direct spectral estimator (Percival and
Walden, 1993). The lag window estimator is deﬁned in equations 18 and 19.

Where,

−∞

I LW (f ) = Z ∞
Z ∞

−∞

K(f − f ′)I D(f ′)df ′

K(f )df = 1

(18)

(19)

Averaging over trials may be included by using the trial averaged direct spec-
tral estimate I DT (see equation 16) in place of I D in the above expression. It is
assumed that K(f ) is a smoothing kernel with reasonable properties.

4.3.1 Bias

The additional smoothing of the lag window kernel modiﬁes the bias properties
of the estimator from those expressed in equation 15. The expected value of the

10

lag window estimator is given by,

E{I LW (f )} = Z ∞

−∞

K(f−f ′)|H(f ′−f ′′)|2S(f ′′)df ′df ′′−

S(0)

T Z ∞

−∞

K(f−f ′)|H(f ′)|2df ′

(20)

4.3.2 Asymptotic Variance

The large sample variance of this estimator is readily obtained using equation 17.

Where,

and,

ξ = Z ∞

K(f )K(f ′)|H(f − f ′)|2df df ′

var{I LW (f )} =
−∞Z ∞
H(f ) = Z ∞

−∞

−∞

ξ
NT

E{I LW (f )}2

h(t)2e−2πif tdt

(21)

(22)

(23)

Equation 21 includes the reduction in variance due to trial averaging. 1/ξ
can be interpreted as the eﬀective number of independent estimates beneath
the smoothing kernel, as demonstrated by the following qualitative argument.
If ∆f is the frequency width of the smoothing kernel K(f ) and δf is the fre-
quency width of the taper H(f ) then since K(f ) ∼ 1/∆f it follows that ξ ∼
1/(∆f )2R∆f R∆f |H(f − f ′)|2df df ′ and hence that ξ ∼ δf /∆f.

4.4 Multitaper Estimates

While the lag window estimator is based on the idea that nearby frequencies
provide independent estimates, the estimation is not very systematic, since, one
should be able to explicity decorrelate nearby frequencies from the knowledge of
the correlations introduced by a ﬁnite window size. This is achieved in multitaper
spectral estimation. The basic idea of multitaper spectral estimation is to average
the spectral estimates from several orthogonal tapers. The orthogonality of the
tapers ensures that the estimates are uncorrelated for large samples (consider
substituting h1(t)h2(t) for h(t)2 in equation 17). A critical question is the choice
of a set of orthogonal tapers. A natural choice are the discrete prolate spheroidal
sequences (dpss) or Slepian sequences, which are deﬁned by the property that
they are maximally localised in frequency. The dpss tapers maximize the spectral
concentration deﬁned as;

λ = R W
−W |H(f )|2df
R ∞
−∞ |H(f )|2df

11

(24)

Where in the time domain h(t) is strictly conﬁned to the interval [0,T].

For given values of W and T there are a ﬁnite number of tapers which have
concentrations (λ) close to one, and therefore have well controlled bias. This
number is known as the Shannon number and is 2W T . This sets an upper limit
on the number of independent estimates that can be obtained for a given amount
of spectral smoothing.

A direct multitaper estimate of the spectrum is deﬁned in equation 25.

I M T (f ) =

1
K

K−1

Xk=0

I D
k (f )

(25)

The eigenspectra I D

k are direct spectral estimates based on tapering the data
with the kth dpss function. As previously trial averaging can be included by using
I DT rather than I D. More sophisticated estimates involve adaptive (rather than
constant) weighting of the data tapers (Percival and Walden, 1993). Multitaper
spectral estimation has been recently shown to be useful for analysing neurobio-
logical time series, both continuous processes (Mitra and Pesaran, 1999) and spike
trains (Pesaran et al., 2000).

4.4.1 Bias

The bias for the multitaper estimate is given by equation 15 but with |H(·)|2
replaced by an average over tapers 1

k=0 |Hk(·)|2.

K PK−1

4.4.2 Asymptotic Variance

The asymptotic variance of the multitaper estimator, including trial averaging, is
given by equation 26.

var{I M T (f )} =

1

NT K

E{I M T (f )}2

(26)

4.5 Degrees of freedom

At this point it is useful to introduce the concept of the degrees of freedom (ν0)
of an estimate. The degrees of freedom is twice the number of independent esti-
mates of the spectrum. Degrees of freedom is a useful concept as it permits the
expressions for the variance of the diﬀerent estimators to be written in a common
format.

var{I X(f )} =

2E{I X(f )}2

ν0

(27)

Where,

12

X
ν0

D
2

DT
2NT

LW
2NT /ξ

MT
2NT K

Degrees of freedom is also a useful framework in which to cast both ﬁnite size

corrections and the conﬁdence limits for the spectra and coherence.

The variance of estimators of the spectrum can be estimated using internal
methods such as the bootstrap or jackknife (Efron and Tibshirani, 1993),(Thom-
son and Chave, 1991). Jackknife estimates can be constructed over trials or over
tapers. If ν0 is large (> 20), then the theoretical and Jackknife variance are in
close agreement.
If distributional assumptions can be validly made about the
point process, theoretical error bars have an important advantage over internal
estimates since they enable the understanding of diﬀerent factors which enter into
the variance in order to guide experimental design and data analysis. However
Jackknife estimates are less sensitive to failures in distributional assumptions, and
this provides them with statistical robustness.

It is conventional to display spectra on a log scale. This is because taking
the log of the spectrum stabilizes the variance and leads a distribution which is
approximately Gaussian.

4.6 Conﬁdence intervals

The expected values of the estimators and also their variance have been discussed
for several diﬀerent spectral estimators but it is desirable to put conﬁdence inter-
vals on the spectral estimates rather than standard deviations.

As previously mentioned in section 4.2 the averaging of direct spectral esti-
mates from diﬀerent trials yields, in the large sample limit, estimates which are
distributed as χ2
2NT . In general for the other estimates a well known approxima-
tion (Percival and Walden, 1993) is to assume that the estimate is distributed as
χ2
ν0. Conﬁdence intervals can then by placed on estimates on the basis of this χ2
ν0
distribution. The conﬁdence interval applies for the population spectrum S(f )
and is obtained from the following argument.

P hq1 ≤ χ2

ν0 ≤ q2i = 1 − 2p

Where P indicates probability, q1 is such that P [χ2
P [χ2

ν0 ≥ q2] = p. It follows that,

ν0 ≤ q1] = p and q2 is such that

(28)

(29)

P hq1 ≤ ν0I X(f )/S(f ) ≤ q2i = 1 − 2p

Hence an approximate 100% × (1 − 2p) conﬁdence interval for S(f ) is given by,
(30)

P hν0I X(f )/q2 ≤ S(f ) ≤ ν0I X(f )/q1i

13

For large ν0 (> 20) these conﬁdence intervals do not diﬀer substantially from
those based on a Gaussian (±2 standard deviations) but at small ν0 the diﬀerence
can be substantial as for these values the χ2

ν0 distribution has long tails.

4.7 High Frequency limit

The population spectrum goes to a constant value equal to the rate λ in the high
frequency limit. In practice spectra calculated from a ﬁnite sample will go to a
value close to λ but ﬂuctuations in the number of spikes in the interval will lead
to an error in this estimate. For a given sample the spectrum will go the value
given by equation 31.

I(f → ∞) =

1

NT K

K−1

NT

Nn(T )

Xk=0

Xn=1

Xj=1

hk(tn

j )2

(31)

Where tn
j is the jth spike in the nth trial and Nn(T ) is the total number of spikes
in the nth trial. In the case of direct and lag window estimators the averaging
over tapers need not be performed.

This expression yields a value which is typically very close to the sample esti-
mate of the mean rate8. It is signiﬁcant departures from this high frequency limit
which are of interest when interpreting the spectrum as these indicate enhance-
ment or suppression relative to a homogeneous Poisson process.

4.8 Choice of estimator, taper and lag window

The preceding section discussed the large sample statistical properties of direct, lag
window and multitaper estimates of the spectrum. The choice of which estimator
to use remains a contentious one (Percival and Walden, 1993). The multitaper
method is the most systematic of the estimators but the lag window estimators
should perform almost as well for those spike train spectra which have reasonably
small dynamic ranges9. However, it is possible to construct spike trains with
widely diﬀerent time scales, which can possess a large dynamic range. In addition,
the multitaper technique leads to a simple jackknife procedure by leaving out one
data taper in turn. A further important property of the multitaper estimator is
that it gives more weight to events at the edges of the time interval and thus
ameliorates the arbitrary downweighting of the edges of the data introduced by
single tapers.

8It is exactly the sample estimate of the mean rate for a rectangular taper.
9Dynamic range is a measure of the variation in the spectrum as a function of frequency and

is deﬁned as 10log10( maxf S(f )

minf S(f ) ).

14

If using the lag window estimator there are many choices available for both the
taper and the lag window. The choice of taper is generally not critical provided
that the taper goes smoothly to zero at the start and end of the interval. A
rectangular taper has particularly large sidelobes in the frequency domain which
can lead to signiﬁcant bias. The choice of lag window is also usually not critical
and typically a Gaussian kernel will be satisfactory.

5 Estimating the Coherency

Sample coherency, which may be estimated using equation 32, may be evaluated
using any of the previously mentioned spectral estimators. The principle diﬀerence
is that the direct estimator, in terms of which the other estimators are expressed,
is given by equations 33 and 34 rather than 8 and 9.

C(f ) = I X
12(f ) = J D
I D
J D

a (f ) = Z ∞

−∞

12/qI X
1 (f )J D

11I X
22
2 (f )∗

h(t)e−2πif tdN a(t)

(32)

(33)

(34)

Where the N 1(t) and N 2(t) are simultaneously recorded spike trains from two
diﬀerent cells and X denotes the type of spectral estimator. Possible choices of
estimator X include; D direct, DT trial averaged direct, LW lag window or MT
multitaper.

Lag window and multitaper coherency estimates may be constructed by sub-
stituting I D
12(·) in place of I D(·) in equations 18 and 25. The estimates are biased
over a frequency range equal to the width of the smoothing although the exact
form for the bias is diﬃcult to evaluate.

5.1 Conﬁdence limits for the Coherence

The treatment of error bars is somewhat diﬀerent between the spectrum and the
coherency, since the coherency is a complex quantity. Usually one is interested is
in establishing whether there is signiﬁcant coherence in a given frequency band. In
order to do this the sample coherence should be tested against the null hypothesis
of zero population coherence. The distribution of the sample coherence under this
null hypothesis is given below.

P (|C|) = (ν0 − 2)|C|(1 − |C|2) (ν0/2−2)

0 ≤ |C| ≤ 1

(35)

A derivation of this result is given in (Hannan, 1970). In outline the method is
to rewrite the coherence in such a way that it is equivalent to a multiple correlation

15

coeﬃcient (Anderson, 1984). The distribution of a multiple correlation coeﬃent is
then a known result from multivariate statistics. In the case of coherence estimates
based on lag window estimators the appropriate ν0 may be used although this is
only approximately valid because this method of derivation assumes integer ν0/2.
It is straightforward to calculate a conﬁdence level based on this distribution.

The coherence will only exceed q1 − p1/(ν0/2−1) in p × 100% of experiments. In
addition it is notable that the quantity (ν0/2 − 1)|C|2/(1 − |C|2) is distributed
as F2,ν0−2) under this null hypothesis. It is useful to apply a transformation to
the coherence before plotting it which aids in the assessment of signiﬁcance. The

variable q = q−(ν0 − 2)log(1 − |C|2) has a Raleigh distribution which has density
p(q) = qe−q2/2. This density function does not depend on ν0 and furthermore has a
tail which closely resembles a Gaussian. For certain values of a ﬁtting parameter10
β, a further linear transformation r = β(q−β) leads to a distribution which closely
resembles a standard normal Gaussian for r > 2. This means that for r > 2 one
can interpret r as the number of standard deviations by which the coherence
exceeds that expected under the null hypothesis.

5.2 Conﬁdence Limits for the Phase of the Coherency

If there is no population coherency then the phase of the sample coherency is
distributed uniformly. If, however, there is population coherency then the distri-
bution of the sample phase is approximately Gaussian provided that the tails of
the Gaussian do not extend beyond a width 2π. An approximate 95% conﬁdence
interval for the phase (Rosenberg et al., 1989; Brillinger, 1974) is given below.

ˆφ(f ) ± 2vuut

2

ν0  

1

|C(f )|2 − 1!

Where ˆφ(f ), the sample estimate of the coherency phase,
tan−1{Im(C)/Re(C)}.

(36)

is evaluated using

6 Finite Size Eﬀects

In the preceding sections error bars were given for estimators of the spectrum and
the coherence. However these error bars were based on large sample sizes (they
apply asymptotically as T → ∞). Neurophysiological data are not collected in
this regime and, particularly in awake behaving studies where data is often sparse,
corrections arising at small T are potentially important.
In order to estimate
the size of these corrections a particular model for the point process is required.

10A reasonable choice for β is 23/20.

16

The model studied was chosen primarily for its analytical tractability while still
maintaining a non-trivial spectrum.

The model and the ﬁnal results will be presented here but the details of the
analysis are reserved until appendix A. The model is a doubly stochastic inho-
mogeneous Poisson process with a Gaussian rate function. A speciﬁc realization
of a spike train is generated from the model in the following manner. Firstly a
population spectrum SG(f ) is speciﬁed. From this a realization of a zero mean
Gaussian process λG(f ) is generated. A constant λ, the mean rate, is then added
to this realization. This function is then considered to be the rate function for
an inhomogeneous Poisson process. A realization of this inhomogeneous Poisson
process is then generated. A schematic of the model is shown in ﬁgure 5.

SG

f

(a)

λ
(t) 

G

t

(b)

λ
(t) 

t

(c)

t

(d)

Figure 5: Schematic illustrating the model for which ﬁnite size corrections to the
asymptotic error bars will be evaluated. (a) A spectrum SG(f ) is deﬁned (b) A
realization λG(t) is drawn from a Gaussian process with this spectrum (c) The
mean rate λ is added to λG(t) to obtain λ(t) (d) This rate function is used to
generate a realization of an inhomogeneous Poisson process yielding a set of spike
times.

Technically this is not a valid process because the rate function λ(t) may be
negative. However, if the area underneath the spectrum is small enough then the
ﬂuctuations about the mean rate seldom cross zero and corrections due to this
eﬀect are negligible. In addition large violations of this area constraint have been
tested by Monte Carlo simulation and the results still apply to a good approxi-
mation.

An important feature of this model is that the population spectrum of the spike
trains is simply the spectrum of the inhomogeneous Poisson process rate function
plus an oﬀset equal to the mean rate11. The spectrum of the rate function is a
positive real quantity and therefore within this model the population spectrum
cannot be less than the mean rate at any frequency. Intuitively, the reason for this
is that the process must be more variable than a homogeneous Poisson process at
all frequencies.

To make the nature of the result clear a simpliﬁed version is given in equation

11This result does not depend on the Gaussian assumption.

17

37. This version is for the particular case of a homogeneous Poisson process (which
has a ﬂat population spectrum) and a rectangular taper12.

var{I X(f )} = λ2(cid:20) 2

ν0

+

1

NT T λ(cid:21)

(37)

Where λ is the mean rate.

A sample based estimate of NT T λ is the total number of spikes over all trials.
It is to be noted that ﬁnite size eﬀects reduce the degrees of freedom. This result
implies that there is a point beyond which additional smoothing does not decrease
the variance further and this point is approximately when ν0 is equal to twice the
total number of spikes. The full result is given in equations 38 - 43.

var{I X(f )} =
1

=

+

ν(f )

1
ν0

2E{I X(f )}2

ν(f )
C X
h Φ(f )

2T NT E{I X(f )}2

If X = LW, D or DT
If X = MT

Where,

C X

h = 


and,

0 f (t)4dt
1

R 1
K 2 Pk,k′R 1

0 fk(t)2fk′(t)2dt

f (t/T ) = √T h(t)

(38)

(39)

(40)

(41)

Φ(f ) = λhf + 4[E{I X(f )} − λhf ] + 2[E{I X(0)} − λhf ] + [E{I X(2f )} − λhf ] (42)
(43)

λhf = E{I X(f → ∞)}

C X

h is a constant of order unity which depends on the taper. When a taper is
used to control bias some of the spikes are eﬀectively disregarded and this has an
eﬀect on the size of the correction. The function f (t) has the same form as the
taper h(t) but is deﬁned for the interval [0, 1]. C X
h is the integral of the fourth
power of f and obtains its minimum value of one for a rectangular taper. It is
typically between 1 and 2 for other tapers. In the multitaper case cross terms
between tapers are included.

Equation 42 describes how the ﬁnite size correction depends on the structure
of the spectrum. Φ(f ) is the sum of four terms. The ﬁrst term is the only

12The expression also holds approximately for the multitaper estimate provided all tapers up

to the Shannon limit are used.

18

term which is present for a ﬂat spectrum. The second term is a correction which
depends on the spectrum at the frequency being considered. The next two terms
depend on the spectrum at zero frequency and the spectrum at twice the frequency
being considered. The latter three terms all depend on the diﬀerence between the
spectrum at some frequency and the high frequency limit. Equation 42 applies
provided that the spike train is well described by the model. However, this is not
necessarily the case and a suppression of the spectrum, which cannot be described
by the model, often occurs at low frequencies13.
In the event that there is a
signiﬁcant suppression of the spectrum Φ(f ) may become small or even negative.
To avoid this a modiﬁed form for Φ(f ) may be used which prevents this.

Φ(f ) = λhf + 4max([E{IX(f)} − λhf ], 0) + 2max([E{IX(0)} − λhf], 0)...
+ max([E{IX(2f)} − λhf], 0)

(44)

The above modiﬁcation to the result is somewhat ad hoc so Monte Carlo sim-
ulations of spike trains with enforced refractory periods have been performed to
test its validity. These simulations demonstrated that, although the correction de-
rived using 44 was signiﬁcantly diﬀerent from that obtained from the Monte Carlo
simulations in the region of the suppression, equation 44 provided a pessimistic
estimate in all cases studied. This increases conﬁdence that applying ﬁnite size
corrections using equation 44 will provide reasonable error bars for small samples.
Equation 39 gives the ﬁnite size correction in terms of a reduction in ν0. The
new ν(f ) may be used to put conﬁdence intervals on the results, as described in
section 4.6, although the accuracy of the χ2
ν assumption will be reduced. In the
case of the coherence an indication of the correction to the conﬁdence level can
be obtained by using the smaller of the two ν(f ) from the spike train spectra to
calculate the conﬁdence level using equation 35. In all cases if the eﬀect being
observed only achieves signiﬁcance by an amount which is of the same order as
the ﬁnite size correction then it is recommended that more data be collected.

7 Experimental Design

Often it is useful to know in advance how many trials or how long a time interval
one needs in order to resolve features of a certain size in the spectrum or the
coherence. To do this one needs to estimate the asymptotic degrees of freedom
ν0. This depends on the size of feature to be resolved α, the signiﬁcance level
for which conﬁdence intervals will be calculated p and the fraction of experiments
In addition the reduction in the degrees of
which will achieve signiﬁcance P.
freedom due to ﬁnite size eﬀect depends on the total number of spikes Ns and also
Ch (see section 6).

13Note that any spike train spectra displaying signiﬁcant suppression below the mean ﬁring

rate can immediately rule out the inhomogeneous Poisson process model.

19

An estimate of v0 may be obtained in two stages. Firstly α,p and P are
speciﬁed and used to calculate a degrees of freedom ν. Secondly the asymptotic
degrees of freedom ν0 is estimated using ν, Ns and Ch. The feature size α =
(S − λ)/λ is the minimum size of feature which the experimenter is content to
resolve. For example, a value of 0.5 indicates that where the population spectrum
exceeds 1.5λ the feature will be resolved. The signiﬁcance level should be set to
the same value that will be used for calculating the conﬁdence interval for the
spectrum, typically be 0.05. For a given p there is some probability P that an
experiment will achieve signiﬁcance. To calculate ν one begins with a guess νg.
Then q1 is chosen such that P hχ2
νg ≥ q1i = p/2. On the basis of this one then
evaluates P′ = 1 − Φ [q1/(1 + α)] where Φ is the cumulative χ2
νg distribution14. If
P′ is equal to the speciﬁed fraction P then ν = νg otherwise a diﬀerent νg is chosen.
This procedure is readily implemented as a minimization of (P − P′(νg))2 on a
computer. Having obtained ν one can estimate ν0 using the following expression.

1
ν0

=

1
ν −

Ch [1 + 4α]
2Ns [1 + α]2

(45)

Where the 4α is omitted from the numerator if α < 0.

Figure 6 illustrates example design curves generated using this method. These
curves show the asymptotic degrees of freedom as a function of feature size for
diﬀerent total numbers of spikes.

100

80

60

40

20

0
ν

0
−0.5

0

0.5

1

1.5

2

α

Figure 6: Example design curves for the case when p = 0.05, P = 0.5 and
Ch = 1.5. The three curves correspond to Ns = ∞ (solid), Ns = 100 (dashed),
Ns = 50 (dotted).

The existence of a region bounded by vertical asymptotes implies that as long
as the total number of measured spikes is ﬁnite, modulations in the spectrum

14These formulae apply for α > 0. If α < 0 then P hχ2

should be used.

νg ≤ q1i = p/2 and P′ = Φ [q1/(1 + α)]

20

below a certain level cannot be detected no matter how much the spectrum is
smoothed. These curves may be used to design experiments capable of resolving
spectral features of a certain size.

In the case of the coherence one calculates how many degrees of freedom are
required for the conﬁdence line to lie at a certain level as described in section 5.1.

8 Line Spectra

One of the assumptions underlying the estimation of spectra is that the population
spectrum varies slowly over the smoothing width (W for multitaper estimators).
While this is often the case there are situations in which the spectrum contains
very sharp features which are better approximated by lines than by a continuous
spectrum. This corresponds to periodic modulations of the underlying rate, such
as when a periodic stimulus train is presented. In such situations it is useful to
be able to test for the presence of a line in a background of colored noise (i.e. in
a locally smooth but otherwise arbitrary continuous population spectrum). Such
a test has been previously developed, in the context of multitaper estimation, for
continuous processes (Thomson, 1982) and in the following section the analogous
development for point processes is presented.

8.1 F-test for point processes

A line in the spectrum has an exactly deﬁned frequency and consequently the
process N(t) has a non-zero ﬁrst moment. The natural model in the case of a
single line is given by equation 46.

E{dN(t)}/dt = λ0 + λ1cos(2πf1t + φ)

(46)

A zero mean process (N) may be constructed by subtraction of an estimate
of λ0t. Provided that the product of the line frequency(f1) and the sample dura-
tion(T) is much greater than one the sample quantity N(T )/T is an approximately
unbiased estimate of λ0. The resultant zero mean process N has a Fourier trans-
form which has a non-zero expectation.

Jk(f ) = Z ∞

−∞

hk(t)e−2πif tdN(t)

E{Jk(f )} = c1Hk(f − f1) + c∗

1Hk(f + f1)

Where,

In the case where f > 0 and f1 > W ,

c1 = λ1eiφ/2

E{Jk(f )} ≃ c1Hk(f − f1)

21

(47)

(48)

(49)

(50)

The estimates of Jk(f1) from diﬀerent tapers provide a set of uncorrelated
estimates of c1Hk(0). It is hence possible to estimate the value of c1 by complex
regression.

ˆc1 = Pk Jk(f1)Hk(0)
Pk |Hk(0)|2

(51)

Under the null hypothesis that there is no line in the spectrum (c1 = 0) it may

readily be shown that E{ˆc1} = 0 and var{ˆc1} = S(f1)/Pk |Hk(0)|2. The residual

spectrum15, which has the line removed, may be estimated using equation 52.

ˆS(f ) =

1

K Xk |Jk(f ) − ˆc1Hk(f − f1)|2

(52)

In the large sample limit the distributions of both ˆc1 and ˆS(f1) are known

(Percival and Walden, 1993) and may be used to derive relation 53.

|ˆc1|2Pk |Hk(0)|2(K − 1)
Pk |Jk(f1) − ˆc1Hk(0)|2

.
= denotes ‘is distributed as’.

Where

.
= F2,2(K−1)

(53)

The null hypothesis may be tested using this relation and, if rejected, the
line can be removed using equation 52 to estimate the residual spectrum. It is
worth noting that although relation 53 was derived for large samples the test is
remarkably robust as the sample size is decreased. Numerical tests indicate that
the tail of the F distribution is well reproduced even in situations where there are
as low as 5 spikes in total.

8.2 Periodic Stimulation

A common paradigm in neurobiology where line spectra are particularly important
is that of periodic stimulation. When a neuron is driven by a periodic stimulation
of frequency f1 the spectrum may contain lines at any of the harmonics nf1.
Provided that f1 > 2W the analysis of section 8.1 applies with each harmonic
being separately tested for signiﬁcance.

The ﬁrst moment of the process, which has period 1/f1, is given by equation

54 and may be estimated using ˆcn.

λ(t) = λ0 +Xn

λncos(2πnf1t + φn)

(54)

Where λn = 2|cn|, φn = tan−1{Im(cn)/Re(cn)}, the sum is taken over all the
signiﬁcant coeﬃcients.

15It is also possible to estimate a residual coherency. In order to do this one uses a residual
1Hk(f − f1)), together with

cross-spectrum ˆSxy(f ) = 1
k (f ) − ˆcy
the residual spectra to evaluate the usual expression for coherency.

k (f ) − ˆcx

1 Hk(f − f1))∗(J y

K Pk(J x

22

This rate function λ(t) is the average response to a single stimulus or impulse

response. The coeﬃcients cn are the Fourier series representation of λ(t).

8.3 Error Bars

It is possible to put conﬁdence intervals on both the modulus and the phase
of the coeﬃcients ˆcn. For large samples(> 10 spikes) the real and imaginary
parts of ˆcn are distributed as independent Gaussians each with standard deviation

σn = qS(nf1)/(2Pk |Hk(0)|2). For cn/σn > 3 the distribution of |ˆcn| is well
approximated by a Gaussian centered on |cn| and with standard deviation σn. In
addition the estimated phase angle ( ˆφn) is also almost Gaussian with mean φn and
standard deviation σn/|cn|. Approximate error bars or conﬁdence intervals may
be obtained using a sample based estimate of σn, ˆσn = q ˆS(nf1)/(2Pk |Hk(0)|2).

Estimating error bars for the impulse response function is more involved due
to their non-local nature (if one of the Fourier coeﬃcients is varied the impulse
response function changes everywhere). It is therefore of interest to estimate a
global conﬁdence interval, deﬁned as any interval such that the probability of the
function crossing the interval anywhere is some predeﬁned probability. A method
for estimating a global conﬁdence band is detailed in (Sun and Loader, 1994) and
outlined here. First a basis vector Φ(t) is constructed.





ˆσ1cos(2πf1t)

...

ˆσN cos(2πfN t)
ˆσ1sin(2πf1t)

...

ˆσN sin(2πfN t)





(55)

Φ(t) =

Where N is the total number of harmonics.

The elements of this vector have unit variance and a standard approximation

may be applied.

P (sup|λ(t) − E{λ(t)}| > c||Φ(t)||) ≤ 2(1 − N(c)) + (k/π)e−c2/2

(56)
Where sup is the maximum value of its operand, ||Φ(t)|| denotes the length of vec-
tor Φ(t), N(c) is the cumulative standard normal distribution and k is a constant.
k may be evaluated by constructing the 2 × N matrix X(t) = [Φ(t) dΦ(t)/dt],
forming its QR decomposition (Press et al., 1992) and then evaluating k =
R T
0 |R22(t)/R11(t)|dt.
Conﬁdence intervals for the residual spectrum are calculated in the usual man-
ner (using χ2
ν) although at the line frequencies the interval is slightly broadened
due to the loss of a degree of freedom incurred by estimation of cn. Section 11
contains an example application of the methods described in this section.

23

9 Example Spectra

Figure 7 is a spectrum calculated from data collected from a single cell recorded
from area PRR in the parietal cortex of an awake behaving monkey during a de-
layed memory reach task (Snyder et al., 1997). The spectrum is calculated over
an interval of 0.5s during which the ﬁring rate is reasonably stationary and is av-
eraged over 5 trials. The spectrum shows two features which achieve signiﬁcance.
There is enhancement of the spectrum in the frequency band 20-40 Hz indicating
the presence of an underlying broad band oscillatory mode in the neuronal ﬁring
rate. In addition there is suppression of the spectrum at low frequencies. As dis-
cussed previously a suppression of this sort is consistent with an eﬀective refactory
period during which the neuron is less likely to ﬁre. Care must be taken at low
frequencies since at frequencies comparable to the smoothing width the spectrum
is particularly sensitive to any non-stationarity in the data.

40

20

)
z
H

(
 
e
t
a
r

0
0

150
100

m
u
r
t
c
e
p
s

50
30
20

10
0

2

1
time (s)
(a)

150
100

m
u
r
t
c
e
p
s

50
30
20

10
0

150

50

100

frequency (Hz)

50

100

150

frequency (Hz)

(b)

(c)

Figure 7: (a) Gaussian kernel (100 ms width) smoothed ﬁring rate with 2σ error
bars based on a stationarity assumption. The vertical lines indicate the period
over which the spectrum was calculated. A light is ﬂashed at time zero and the
spectrum is evaluated over the interval when the monkey is required to remember
the target location. (b) The spectrum evaluated over this interval using a lag
window estimator with a 40% cosine taper and a Gaussian lag window of width
3.5 Hz. 95% conﬁdence limits are shown with the ﬁnite size correction included
(this typically resulted in a decrease in ν(f ) from about 50 to 36). The horizontal
line indicates the high frequency limit.(c) The same spectrum evaluated using a
multitaper estimator. A bandwidth (W) of 5 Hz was used allowing 5 tapers. Both
estimators have the same degrees of freedom.

24

10 Example Coherency

To illustrate the estimation of coherency simulated spike trains were generated
from a coupled doubly stochastic Poisson process. For a given trial a pair of rate
functions were drawn from a Gaussian process. The realizations share a coherent
mode which is linearly mixed into the rates of both cells. These coupled rate
functions are then used to independently draw a realization of an inhomogeneous
Poisson process for each cell. Using this method 15 trials of duration 0.5s were
generated. The coherent mode was set such that the population coherence was
a Gaussian of height 0.35 and standard deviation 5 Hz centered on 20 Hz. The
phase of this mode was set to 180o. Figure 8 indicates that this coherent mode is
reasonably estimated.

1

0.8

0.6

0.4

e
c
n
e
r
e
h
o
c

0.2

0
0

20

0

−90

−180

−270

p
h
a
s
e

 
(
d
e
g
r
e
e
s
)

4

3

2

1

0

e
c
n
e
r
e
h
o
c
 

i

d
e
z
d
r
a
d
n
a

t
s

−1

40

60

frequency (Hz)

80

−360

100

−2
0

20

40

frequency (Hz)

60

80

100

(a)

(b)

Figure 8: (a) Coherence (left axis) and the phase of the coherency (right axis).
Fifteen trials of 0.5s duration were simulated using a doubly stochastic Poisson
process as described in the text. A multitaper estimator with a smoothing width of
7 Hz was used. Finite size corrections were used and resulted in 25% reduction in
the degrees of freedom. A horizontal line has been drawn at the 95% conﬁdence
level under the null hypothesis of no coherency. Where the null hypothesis is
rejected the phase of the coherency is estimated and shown with an approximate
95% conﬁdence interval. (b) The standardized coherence is a transformation which
maps the null distribution onto an approximately standard normal variate (as
described in section 5.1). The estimated coherence at 20 Hz would therefore lie
at three standard deviations if there were no population coherence.

11 Example Periodic Stimulation

An example of an analysis of a periodic stimulus paradigm is shown in ﬁgure 9.
The data is a single cell recording collected from the barrel cortex of an awake

25

behaving rat during periodic whisker stimulation at 5.5 Hz (Sachdev et al., 1999).
There is a single trial of duration 50s.

)
z
H

(
 

e

t

a
R

150

100

50

0
0

10

m
u
r
t
c
e
p
s

9

8

7

6

5

4
0

7

6

5

4

3

2

1

0.05

0.1
time (s)

(a)

0.15

0.183

0
1 3

6

9 12 15 18 21 24 27 30 33 36

 

(b)

3π/2

 π/2

 π/4

   0

200

−π/4

1 3

6

9 12 15 18 21 24 27 30 33 36

 
(d)

100

50
frequency (Hz)

150

(c)

Figure 9: Response to a periodic stimulation of frequency 5.5 Hz. (a) Impulse
response function with global 95% conﬁdence interval (b) |ˆcn| versus index n with
95% conﬁdence interval. Dots indicate points which achieved signiﬁcance in the
F-test. (c) Residual spectrum with ﬁnite size corrected conﬁdence interval. A
multitaper spectrum with 100 tapers and a bandwidth of 1.5 Hz was used initially
to avoid overlap of harmonics. This spectrum was then further smoothed using a
Gaussian lag window with standard deviation 9 Hz. (d) The coeﬃcient phases ˆφn
(in radians) versus index n after subtraction of a ﬁtted straight line of gradient
2π/3 ± 0.01. The black dashed lines are a 95% conﬁdence interval about zero.

The estimated impulse response function ˆλ(t) is seen to have two distinct sharp
peaks outside of which the response does not diﬀer signiﬁcantly from zero. The
moduli of the Fourier coeﬃcients are signiﬁcant out to n = 25. This automatically
sets the smoothing of ˆλ(t) as structure on a time scale of less than 1/(25× 5.5) =
7 ms does not achieve signiﬁcance. Note that the coeﬃcients are enhanced at
multiples of 6 (i.e.∼ 33 Hz) which comes from having two peaks in the time

26

J kn

a (f ) = R T

I kn
ab (f ) = J kn

0 hk(t)e−2πif tdN
(f )

a (f )J kn∗

b

n
a(t)

Table 1: The basic direct spectral estimator in terms of which the other estimators
can be written. For clarity the superscript D on the direct spectral estimate has
been omitted. The index n labels trials, index k labels tapers, and indices a and
b label cells.

domain λ(t) which are separated by ∼ 30 ms. The phase of the coeﬃcients closely
follows a straight line but there is a small periodic deviation from this line which is
again at index multiples of 6. The gradient of the straight line depends on the time
delay of the response. The residual spectrum was calculated by ﬁrst evaluating
a multitaper estimate from which the signiﬁcant harmonics were removed. This
spectrum had a bandwidth of 1.5 Hz chosen to avoid overlap of the harmonics
leading to the multitaper estimate being undersmoothed. A further smoothing
was performed using a lag window16 and the resultant spectrum, displays a slight
but signiﬁcant suppression relative to a Poisson process out to almost 200 Hz.
Such a spectrum is characteristic of a short time scale refractive period. The
residual spectrum is particularly useful because rate non-stationarity has been
removed.

12 Summary

It is the belief of the authors that spectral analysis is a fruitful and under exploited
analysis technique for spike trains. In this paper an attempt has been made to
collect the machinery necessary for performing spectral analysis on spike train
data into a single document. Starting from the population deﬁnitions the statis-
tical properties of estimators of the spectrum and coherency have been reviewed.
Estimation methods for both continuous spectra and spectra which contain lines
have been included. In addition new corrections to asymptotic error bars have
been presented which increase conﬁdence in applying spectral techniques in prac-
tical situations where data is often sparse. Tables 1 to 5 summarize the important
formulae. Matlab software implementing the methods discussed in this paper is
available from xxx.lanl.gov/archive/neuro-sys.

16The previous theory developed for lag window estimators applies to this hybrid esti-
k=0 |Hk(·)|2 in equation 20 and |H(·)|2 replaced by

1

mator with |H(·)|2 replaced by 1
K PK−1

k=0 |Hk(·)|2 in equation 22.

K PK−1

27

X
D
DT
LW 1
MT

NT PNT

1

I X
ab(f )
I 01
ab (f )
n=1 I 0n

1

ab (f )

NT PNT
n=1R ∞
−∞ K(f − f ′)I 0n
NT K PNT
n=1PK−1
k=0 I kn
ab (f )

ab (f ′)df ′

Eq.
[8 ]
[16 ]
[18 ]
[25 ]

ν0
2
2NT
2NT /ξ
2NT K

Table 2: The diﬀerent estimators and the large sample degrees of freedom ν0 of
estimates of the spectrum (ab = 11). The indices on the I kn
ab are as follows. ab
label the cells from which the estimates are constructed. The index k labels the
taper and n labels the trial.

Equation

var{I X

aa(f )} = 2E{I X

aa(f )}2
ν(f )

Eq.

[27]

Comment

use ν0 for asymptotic
or ν(f ) if using ﬁnite

size correction

1

ν(f ) = 1

ν0

+

CX

h Φ(f )

2T NT E{I X (f )}2

[39] See text for deﬁnitions

of C X

h and Φ(f )

Variance

Degrees

of freedom

Conﬁdence

(1 − 2p) × 100%

hνI X(f )/q2, νI X(f )/q1i

[30]

q1 s.t P [χ2
q2 s.t P [χ2

ν ≤ q1] = p
ν ≥ q2] = p

Table 3: Main formulae required for estimating spectral error bars. Refer to
section 4 for additional information.

Equation

Eq.

Comment

Coherency

C X(f ) = I X
ab√I X

aaI X
bb

[32]

Distribution P (|C|) = (ν − 2)|C|(1 − |C|2)(ν/2−2)
for coherence

[35]

Under null

hypothesis γ = 0

Conﬁdence

for phase

ˆφ(f ) ± 2r 2
ν (cid:16)

1

|C(f )|2 − 1(cid:17)

[36]

Approx.

95%

Table 4: Main formulae required for coherency estimation. Refer to section 5 for
additional information.

28

Equation

Eq. Comment

Complex amplitude

of line

Jk(f1)Hk(0)

|Hk(0)|2

ˆc1 = Pk
Pk

F-test to access the
signiﬁcance of a line

|ˆc1|2Pk
Pk
Residual spectrum ˆS(f ) = 1

|Hk(0)|2(K−1)
|Jk(f1)−ˆc1Hk(0)|2

.
= F2,2(K−1)

K Pk |Jk(f ) − ˆc1Hk(f − f1)|2

[51]

[53]

[52]

Null
c1 = 0

Table 5: Main formulae required for the detection and removal of a line from the
spectrum. Refer to section 8 for additional information.

A Derivation of Finite Size Correction

The following is an outline derivation of the ﬁnite size corrections described in
section 6. Firstly the characteristic functionals (Bartlett, 1966) for the processes
N and the inhomogeneous Poisson process rate λ(t) are related.

CN (θ(t)) = E{exp(iZ T

0

θ(t)dN )} = Eλ{exp(Z T

0

λ(t)b(θ(t))dt)}

b(θ(t)) = exp[iθ(t) −

i

T Z T

0

θ(t′)dt′]

Under the Gaussian process assumption for λ(t) this integral may be done.

CN = exp[

1

0

b(t)Λ(t, t′)b(t′)dtdt′ + λZ T
0 Z T
2 Z T
Λ(t, t′) = Eλ{(λ(t) − λ)(λ(t′) − λ)}

0

b(t)dt]

(57)

(58)

(59)

(60)

Note that λ denotes the mean rate. Taking the log of the characteristic functionals
now yields the following relation between the resultant cumulant functionals.

KN = lnE{exp(iZ T

0

θ(t)dN)} =

1

0 Z T
2 Z T

0

b(t)Λ(t, t′)b(t′)dtdt′ + λZ T

0

b(t)dt (61)

Next θ(t) is chosen appropriately and substituted into KN . The form for θ(t)
which is required to obtain the covariance of multitaper estimators is;

iθ(t) = θ1hk(t)e−2πif1t + θ2hk(t)e2πif1t + θ3hk′(t)e−2πif2t + θ4hk′(t)e2πif2t

(62)

29

Substituting into the cumulant functional for N yields;

KN = lnE{exp(θ1J D
k is the Fourier transform of the data tapered by a function indexed by

Where J D
k. Application of the cumulant expansion theorem (Ma, 1985) then leads to;

k′ (f2) + θ4J D∗

k (f1) + θ2J D∗

k (f1) + θ3J D

k′ (f2))}

(63)

KN = E{exp(θ1J D

k (f1) + θ2J D∗

k (f1) + θ3J D

k′ (f2) + θ4J D∗

k′ (f2)) − 1}C

(64)

This may then be diﬀerentiated and set to zero.

∂θl

∂KN
2 ∂θn

4(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)θ1=θ2=θ3=θ4=0

k (f1)J Dm∗

= E{J Dl

3 ∂θo

1∂θm

Klmno =

(f2)}C
(65)
Moments of the estimators may be expressed in terms of these cumulant deriva-
tives. The expressions are simpliﬁed by the fact that all cumulant derivatives
which have indices summing to an odd number are zero because N is a zero mean
process.

(f1)J Dn

k′ (f2)J Do∗

k′

k

E{I D

k (f )} = K1100

var{I M T (f )} =

1
K 2

K−1

K−1

Xk=0

Xk′=0

cov{I D

k (f ), I D

k′ (f )}

(66)

(67)

(68)

cov{I D

k (f ), I D

k′ (f )} = K1010K0101 + K1111 + K1001K0110

The problem has now been reduced to that of calculating these derivatives within
the model. This is done by substituting the expression for θ(t) into the RHS of
equation 61. Considerable algebra then leads to the following exact result.

Where,

K A

lmno =

1

2 Xli,mi,ni,oi

Klmno = K A

lmno + K B

lmno

l!m!n!o!

Πli!Πmi!Πni!Πoi! "−H1(f1)

T

#l2+l4"−H1(f1)∗
#o2+o4

#n2+n4"−H1(f2)∗

T

T

"−H1(f2)

T

(69)

#m2+m4

...

I l1,m1,n1,o1
l3,m3,n3,o3

(70)

for n, m, o).

Where Pi li = l and cases where l1 + l2 = l or l3 + l4 = l are excluded (and also
l3,m3,n3,o3 = Z ∞

Sλ(f )Hl1+m1+n1+o1[f1(l1 − m1) + f2(n1 − o1) − f ]

I l1,m1,n1,o1

...

∞

H ∗
l3+m3+n3+o3[f1(l3 − m3) + f2(n3 − o3) − f ]df (71)

30

Where Sλ(f ) is the spectrum of the Gaussian process and Hl is;

Hl(f ) = Z ∞
hl(t)exp(−2πif t)dt
H0(f ) = T exp(−iπf T )sinc(πf T )

−∞

l

m

n

o

K B

lmno = λ

Xq=0

Xp=0
Xr=0
"−H1(f1)

T

[ lp ][ mq ][ nr ][ os ]Hp+q+r+s[f1(p − q) + f2(r − s)] ...
Xs=0
#(o−s)
#(l−p)"−H1(f1)∗

#(n−r)"−H1(f2)∗

#(m−q)"−H1(f2)

T

T

T

(72)

(73)

(74)

The preceding result is somewhat cumbersome but readily evaluated computation-
ally for a given spectrum. The expression simpliﬁes greatly when only frequencies
above the smoothing width are considered and many of the terms may be ne-
glected. Restricting attention to the second order properties there are only a few
remaining dominant terms. Terms from K1001 lead to the previously discussed
asymptotic results but there are corrections which arise from the term K1111. As-
suming that the population spectrum varies slowly over the width of the tapers
leads to the result given by equations 38 - 43. The validity of this assumption has
been tested computationally and was found to be very accurate even for spectra
with sharp peaks.

Acknowledgment

The authors thank C. Buneo, and R. Sachdev for providing example datasets,
Clive Lauder for help with the calculation of global error bars and D. R. Brillinger
and D. J. Thomson for comments which substantially improved the manuscript.
M. Jarvis is grateful to R. A. Andersen both for his continued support of the-
oretical work in his lab and also for his careful reading of the manuscript. M.
Jarvis acknowledges the generous support of the Sloan foundation for theoretical
neuroscience.

References

Abeles, M., Deribaupierre, F., and Deribaupierre, Y. (1983). Detection of single
unit responces which are loosely time-locked to a stimulus. IEEE Transactions
on Systems Man and Cybernetics, 13:683–691.

Anderson, T. W. (1984). An Introduction to Multivariate Statistical Analysis.

Wiley.

31

Bartlett, M. S. (1966). An Introduction to Stochastic Processes. Cambridge Uni-

versity Press.

Brillinger, D. R. (1972). The spectral analysis of stationary interval functions.
Proc. 6th Berkley Symposium on Mathematical Statistics and Probability,
1:483–513.

Brillinger, D. R. (1974). Time Series. Holt, Rinehart and Winston Inc.

Brillinger, D. R. (1978). Develpoments in Statistics vol1, chapter Comparative
Aspects of the Study of Ordinary Time Series and of Point Processes, pages
33–129. Academic Press. Inc.

Brody, C. D. (1998). Slow covariations in neuronal resting potentials can lead to
artefactually fast cross-correlations in their spike trains. Journal of Neuro-
physiology, 80:3345.

Cox, D. R. and Lewis, P. (1966). The Statistical Analysis of Series of Events.

Chapman and Hall.

Efron, B. and Tibshirani, R. J. (1993). An Introduction to the Bootstrap. Chapman

and Hall.

Gerstein, G. L., Perkel, D. H., and Dayhoﬀ, J. E. (1985). Cooperative ﬁring
activity in simultaneously recorded population of neurons - detection. Journal
of Neuroscience, 4:881–889.

Gray, C. M., Konig, P., Engel, A. K., and Singer, W. (1989). Oscillatory re-
sponses in cat visual-cortex exhibit intercolumnar synchronization which re-
ﬂects global stimulus properties. Nature, 338:334–337.

Hannan, E. J. (1970). Multiple Time Series. Wiley.

Ma, S. K. (1985). Statistical Mechanics. River Edge : World Scientiﬁc Publishing

Company.

Mitra, P. P. and Pesaran, B. (1999). Analysis of dynamic brain imaging data.

Biophysical Journal, 76:691–708.

Percival, D. B. and Walden, A. T. (1993). Spectral Analysis for Physical Applica-

tions. Cambridge University Press.

Pesaran, B., Pezaris, J. S., Sahani, M., Mitra, P. P., and Andersen, R. A. (submit-
ted 2000). Temporal structure in neuronal activity during working memory
in macaque parietal cortex. J. Neuroscience.

32

Press, W. H., Teukolsky, S. A., Vetterling, W. T., and Flannery, B. P. (1992).

Numerical Recipes. Cambridge University Press.

Rosenberg, J. R., Amjad, A. M., Breeze, P., Brillinger, D. R., and Halliday,
D. M. (1989). The fourier approach to the identiﬁcation of functional coupling
between neuronal spike trains. Prog. Biophys. Molec. Biol., 53:1–31.

Sachdev, R., Jenkinson, E., Melzer, P., and Ebner, F. F. (1999). Dual electrode
recordings from the awake rat barrel cortex. Somatosensory and Motor Re-
search, 16:163–192.

Snyder, L. H., Batista, A. P., and Andersen, R. A. (1997). Coding of intention in

the posterior parietal cortex. Nature, 386:167–169.

Sun, J. and Loader, C. R. (1994). Simultaneous conﬁdence bands for linear re-

gression and smoothing. The Annals of Statistics, 22:1328–1345.

Thomson, D. J. (1982). Spectrum estimation and harmonic analysis. Proceedings

of IEEE, 70:1055–96.

Thomson, D. J. and Chave, A. D. (1991). Advances in Spectrum Analysis and Ar-
ray Processing, chapter Jackknifed Error Estimates for Spectra, Coherences,
and Transfer Functions, pages 58–113. Prentice Hall.

33

