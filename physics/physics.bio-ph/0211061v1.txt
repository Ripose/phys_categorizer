2
0
0
2
 
v
o
N
 
4
1
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
1
6
0
1
1
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Gauge Poisson representations for birth/death master equations

P. D. Drummond∗
Universität Erlangen-Nürnberg, Lehrstuhl für Optik, Staudstrasse 7/B2 D-91058 Erlangen, Germany.†
(Dated: 20th February 2014)

Poisson representation techniques provide a powerful method for mapping master equations for birth/death
processes - found in many ﬁelds of physics, chemistry and biology - into more tractable stochastic differential
equations. However, the usual expansion is not exact in the presence of boundary terms, which commonly oc-
cur when the differential equations are nonlinear. In this paper, a stochastic gauge technique is introduced that
eliminates boundary terms, to give an exact representation as a weighted rate equation with stochastic terms.
These methods provide novel techniques for calculating and understanding the effects of number correlations
in systems that have a master equation description. As examples, correlations induced by strong mutations in
genetics, and the astrophysical problem of molecule formation on microscopic grain surfaces are analyzed. Ex-
act analytic results are obtained that can be compared with numerical simulations, demonstrating that stochastic
gauge techniques can give exact results where standard Poisson expansions are not able to.

I.

INTRODUCTION

The calculation and prediction of the behavior of com-
plex systems is one of the most pressing issues in theoretical
physics[1]. A common problem when dealing with statisti-
cal problems is that the state-space of possible outcomes is
enormous. This is particularly so for quantum systems - but
very similar issues can arise in many types of master equa-
tion, with applications ranging from kinetic theory to genetics.
One of the earliest approaches to this problem was the method
of Langevin equations in Brownian motion, which led to the
theory of equations with random terms, or stochastic equa-
tions. An important subsequent development in the ﬁeld of
discrete master equations was the van Kampen system-size
expansion[2], which leads to an approximate Fokker-Planck
equation equivalent to a stochastic equation, whose determin-
istic part has the usual rate-equation behavior. Following
this, a more systematic technique was introduced, called the
Poisson[3] expansion, which gives exact results in some cases
with linear rate equations.

The general advantage of Poisson methods is that they em-
ploy a ‘natural’ basis, in which the distribution is expanded
in the most entropically likely distribution for linear cou-
plings. The disadvantage is that one may obtain large er-
rors - both random and systematic - when nonlinear inter-
actions act to generate sub-Poissonian variances. In this pa-
per, a new method called the gauge Poisson representation is
introduced, which allows an exact mapping of many impor-
tant master equations into readily soluble stochastic differen-
tial equations, even when the Poisson expansion can not be
used. It is the stochastic dynamics in these cases, and meth-
ods for treating them, that this paper is directed toward. As
examples, I show how the gauge method can be used to calcu-
late mean values and novel correlation predictions from mas-
ter equations for genetic mutations in a simple model from

∗Electronic address: drummond@physics.uq.edu.au; URL: www.physics.
uq.edu.au/BEC
†Permanent Address: Department of Physics, University of Queensland,
QLD 4072, Brisbane, Australia

evolutionary biology[4], for the astrophysical problem of in-
terstellar molecular hydrogen production on grain surfaces[5].
In master equations, the fundamental object is a probabil-
ity distribution P(N,t) = [P(t)]N for observing probabilities
of discrete outcomes, labeled with integers N = (N1, .., Nd)
. These numbers are typically the number of particles or
atoms (in physics), molecules (in chemistry) or organisms (in
biology)[1]. The numbers may refer to a large, well-mixed
volume, or to cells within a larger volume in the case of spa-
tially extended systems. A common and very signiﬁcant prob-
lem is the Markovian time-evolution of the distribution, de-
ﬁned by an N

N matrix M so that:

×

P(t) = M

P(t) .

·

¶ t

(1.1)

There are severe complexity issues that arise in trying
to solve these equations as the number of dimensions in-
crease. The difﬁculty of solving this equation directly is
that the total number of states involved may grow exponen-
tially large with the dimension or number of distinct modes
d = cells
species. Thus, direct methods are not suitable for
solving many important problems of this type.

×

For large enough numbers N j, one may use rate-equations
or system-size expansions[1]. However, these approximations
are inapplicable to many important problems where the actual
numbers may be small in at least one of the steps. Examples of
this are common in problems involving nano-structures - like
the grains involved in astrophysical molecule production[5],
where it is crucial to have more than one atom present for
molecule formation. Other potential applications include ge-
netic population dynamics[4], where population numbers in
small regions are also critically important to reproduction,
and spatially dependent master equations for diffusion or ki-
netic processes. Direct Monte-Carlo simulations can be used
in these problems[6], but these can be inefﬁcient and time-
consuming for large numbers of modes, since they do not
make any use of the fact that most of the populations involved
may be nearly Poissonian.

A useful alternative is an exact expansion of the distribu-
tion vector P using a continuous basis of ‘prototype’ solutions,
a ) , whose com-
namely the complex Poisson distribution p0(a

¶
a
2

ponents are deﬁned as:

A. Gauge phase-space expansion

[p0(a

a )]N =

d

e−

j=1

j)N j

j (a
N j!

.

(1.2)

The usual Poisson representation[3] expands the distribution
vector P with a positive distribution of Poissonians, f (a
a ), de-
ﬁned over a complex d-dimensional phase-space of variables
. Here the discrete variable N which is a vector of integers
a which is a vec-
is transformed into a continuous variable a
tor of complex numbers. This then can be used to transform
the master equation given above into a stochastic differential
equation, with just linear rather than exponential growth in the
problem size, as the number of modes increases.

This transformation has similar properties to the positive-
P[7] representation in quantum mechanics. It is exact if the
resulting differential equation is linear, but there are subtleties
when there are nonlinear terms in the equations. If unstable
trajectories are generated[8] which cause the distribution to
have power-law tails at large radius, then the resulting trans-
formation develops systematic boundary term errors.

I show that the Poisson method can be modiﬁed using a
stochastic gauge technique that stabilizes all complex trajec-
tories that are already stable in the real phase-space. This ab-
sence of moving singularities is conjectured[9] to be sufﬁcient
to eliminate the boundary term errors, which will be veriﬁed in
a typical example calculation. Thus, correctly chosen stochas-
tic gauges appear to eliminate the boundary term problem, and
simultaneously give rise to greatly reduced sampling errors in
practical numerical solutions.

To illustrate the technique, I will consider examples in
which there is relatively simple behavior that leads to sub-
Poissonian results, in cases where there is an analytic theory
available to compare with numerical simulations. This is used
to demonstrate the accuracy and boundedness in some rela-
tively extreme cases where boundary terms exist. In more typ-
ical applications, the correlations and ﬂuctuations are closer to
Poissonian, and the sampling error therefore would be smaller.

II. GAUGE POISSON REPRESENTATION

The gauge Poisson representation introduced here treats
the problem of boundary terms, by utilizing a gauge tech-
nique similar to that recently proposed for the positive-P
distribution[10, 11]. It adds an extra variable to the distribu-
tion, which eliminates instabilities by modifying the dynam-
ical equations. A type of gauge-invariance allows this to be
carried out exactly. The resulting equations are almost identi-
cal to rate equations, except with stochastic terms. The gauge
equations retain the advantages of the Poisson method, but
have no boundary term errors for correctly chosen gauges.
This is critically important for correct results where there are
small numbers.

I deﬁne an ex-
The technical details are as follows.
a ), and a renor-
tended (gauge) phase-space with −→a = (W
malized Poisson distribution as p(−→a
. Here W
a )W
is
a complex-valued weighting factor which weights (or multi-
plies) the usual normalized Poisson basis vector. The gauge
expansion is deﬁned for a real, positive distribution G(−→a
), as:

, a
) = p0(a

P =

G(−→a

)p(−→a

)d2(d+1)

−→a

.

(2.1)

Z

I will show that this means that a freedom of choice becomes
available in the equivalent stochastic equations. Importantly,
it then is possible to choose an equivalent stochastic equation
of motion without instabilities, which is conjectured to elimi-
nate boundary terms. Hence, there is an exact mapping avail-
able, provided the propagation matrix M can be constructed
from a class of matrix ladder operators which either increase
(L+
j ) the number of particles in a particular mode j, or de-
crease (L−j ) the number of particles and multiply the proba-
bility by a factor of (N j + 1) .
Explicitly, this means that:

P

P

L+
j ·
h
L−j ·
h

N
i

N
i

= P(N1, ..N j

1, ..)

−
= (N j + 1)P(N1, ..N j + 1, ..) .

(2.2)

These ladder operators obey identities as follows, when acting
on a Poisson distribution:

L−j ·
L+
j ·

jp(−→a

p(−→a
p(−→a
p(−→a

) = a
) = (1 + ¶
) = W

)
j) p(−→a
)
) .

W p(−→a

(2.3)

) is analytic in −→a
, I have used −→¶ = (¶
Since p(−→a
¶ x
or
bolize either
j ≡
j = 0, .. d complex variables a
h
this

¶ y
i
j ≡
−
j = x j + iy j .

So far,

¶ /¶ x j

¶ /¶ y j

similar

is

i

i

representation[3] However,
is now given by a weighted average, with W
weighting parameter in the averages:

the m

−

h
to the positive Poisson
th factorial moment
as a complex

, ¶

¶ ) to sym-
for each of the

−

=

−

m)
i

1)..(N j

N j(N j
h

.
Z
(2.4)
From this one obtains the expected result that in a pure Pois-
son distribution, G(−→a
) = d (W
j ), the mean
−
and variance of modes with j > 0 are given by:

d
j=1

1) (cid:213)

d (a

−

¯a

(cid:0)

(cid:1)

j

G(−→a

)d2(d+1)

−→a

m
j

N j
h
¯N j)2

i

i

= ¯a
= ¯a

j

j .

(N j
h

−

(2.5)

a
(cid:213)
a
a
a
a
a
a
a
a
¶
W
¶
´
W
a
B. Poisson Fokker-Planck Equation

equation for the complex Poisson mean variables a
j. On in-
troducing a complex ‘reaction rate’, R = ka 1a 2, the result is:

3

Using the operator identities given above,

the operator
equations can always be transformed to an integro-differential
equation of form:

P(t) =

¶ t

Z

G(−→a
)

LAp(−→a
)

d2(d+1)

−→a

,

(2.6)

(cid:2)
where the notation LA indicates an ordering of all derivative
operators to the right. In order to demonstrate this, consider
a generic binary interaction, in which two species are trans-
formed at a rate k into two new species:

(cid:3)

X1 + X2

k X3 + X4 .

→

Introducing N±j = N j

1 , the master equation is:

±

P(N) = k(N+

2 )P(N+

1 , N+

2 , N−3 , N−4 )

¶ t

1 )(N+
kN1N2P(N) .

−

This can also be represented using matrices as:

P = k

¶ t

3 L+
L+

4 −

1 L+
L+
2

L−1 L−2 P .

Hence, in this case:

(cid:2)

(cid:3)

(2.7)

(2.8)

(2.9)

LA = ka 1a 2 [(1 + ¶ 3) (1 + ¶ 4)

(1 + ¶ 1) (1 + ¶ 2)]

= ka 1a 2 [¶ 3 + ¶ 4

¶ 1

−

¶ 2 + ¶ 3¶ 4

−

−

−

¶ 1¶ 2] . (2.10)

It follows that in cases of interest involving at most binary
kinetics, only ﬁrst and second order derivatives occur, giving
a differential operator in the form:

LA = A+
j

j +

Di j¶

i¶

j .

1
2

(2.11)

Here the repeated Latin indices i, j are summed over i = 1, ..d,
so that A+
is a d-component complex vector identical to the
j
d square
usual Poisson representation drift, while Di j is a d
complex matrix. As a ﬁrst step towards obtaining stochastic
equations, it is useful to take a d
d′ matrix square root B,
where D = BBT . It should be noted that this is a non-unique
choice. The lack of uniqueness of matrix square-roots al-
lows arbitrary functions in phase-space to be introduced at this
stage, which can be thought of as a diffusion gauge. However,
these cannot stabilize trajectories with deterministic moving
singularities.

×

×

The standard procedure of the positive Poisson represen-
tation would then be to use partial integration to obtain a
Fokker-Planck differential operator acting on the distribution
G, which is then transformed into a stochastic differential
equation using the dimension-doubling technique described
in more detail in the next section.
In the present example,
this procedure - which is only valid if boundary terms van-
ish during the partial integration - would result in a stochastic

=

=

−

−

R + i

R/2 (z 1 + iz 2)

p

R + i

R/2 (z 1

iz 2)

−

= R +

p
R/2 (z 3 + iz 4)

da 1
dt
da 2
dt
da 3
dt
da 1
dt

= R +

R/2 (z 3

iz 4) ,

(2.12)

−

p

p

This shows very clearly a useful property of the Poisson
method. The modiﬁed particle statistics caused by nonlin-
ear reactions are immediately apparent from the noise terms,
since any ﬂuctuations represent a departure from Poisson
statistics. The difﬁculty with the standard[3] positive Pois-
son method outlined above is that even normally stable kinetic
equations can become unstable due to moving singularities in
this extended complex phase-space. While the singular trajec-
tories form a set of measure zero, they lead to Fokker-Planck
equations with power-law tails that do not vanish sufﬁciently
quickly at the phase-space boundaries[9].

−

In the present example, the singular trajectories occur at
negative values of a 1,2 , which can be reached via stochastic
motion in the complex plane. The resulting moving singular-
ity in the deterministic equations is of form 1/a 1 = 1/a 2 =
k(t
t0) for t < t0. Moving singularities like this one often ex-
ist in complex nonlinear equations of polynomial form, since
these systems are generically non-integrable or even chaotic -
and the Painleve conjecture[12] states that moving singulari-
ties are to be expected in analytically continued non-integrable
sets of equations. This means that in many cases, the bound-
ary terms do not vanish, leading to systematic errors. Al-
though such errors are known to be exponentially small when
there is large linear damping, they can cause problems when
there is little or no linear damping.

III. GAUGE IDENTITIES

Fortunately, the extra variable W

allows the ¶ 0 differential
identity to be used to introduce a stochastic gauge - an arbi-
trary vector function in the extended phase-space with d + 1
complex dimensions. This can be used to stabilize the drift
equations throughout the extended phase-space, thus allowing
integration by parts. There is no free lunch here, however!
The price that is paid is a new stochastic noise term, leading
to a ﬁnite variance in the gauge amplitude W
. While this can
cause practical problems due to sampling errors - which must
be minimized - it is important to note that these errors can be
estimated and controlled by choice of gauge and by increas-
ing the number of sample trajectories. By contrast, there is
no presently known technique of estimating and controlling
boundary term errors in the standard Poisson expansion.

¶
¶
¶
¶
A. Gauge Fokker-Planck Equation

To demonstrate the stochastic gauge technique, I now in-
troduce d arbitrary complex functions g = ( gi(−→a
,t) ), to give
a new differential operator LG which is equivalent to LA, but
which includes W

derivatives in the extended phase-space:

LG = LA +

1
2

g

g W

·

"

d

W +

gkB jk¶

k, j=1

[W

j

#

1] .

(3.1)

−

This will later be transformed, using the choice of analytic
derivatives, into a positive deﬁnite Fokker-Planck equation.

Summing repeated Ladin indices from now on over i = 0, d,

this becomes:

LG =

Ai¶

j +

Di j¶

i¶

j

.

(cid:20)

(cid:21)

1
2

(3.2)

Here, the total complex drift vector, including gauge correc-
tions, is A = (0, A1, ..Ad), where:

A j = A+

j −

gkB jk [ j, k > 0] .

(3.3)

This remarkable result shows that as long as there is a non-
vanishing noise or B jk term, the drift equation can be modiﬁed
in an arbitrary way by adding the gauge term

gkB jk.

But this is not without a price, since the diffusion matrix
has changed as well. The total diffusion matrix D is a (d +
1)

(d + 1) matrix, with a new (d + 1)

d′ square root B:

−

×

×

D =

(cid:20)

BgT W
W g
B

=

2ggT ,

W gBT
, BBT

(cid:21)
= B BT .

W gT , BT

Thus, the (d + 1)
×
before, except with one added row:

(cid:21)

(cid:20)
d′ complex stochastic noise matrix B is as

(cid:3)

(cid:2)

(3.4)

(3.5)

B =

W g
B

(cid:20)

(cid:21)

.

The additional row means that whenever a gauge term is
added, a corresponding noise term appears in the equation of
motion for the gauge amplitude variable W
. The details of this
are derived next.

B. Stochastic equations

So far, there is no restriction on which of the choices of an-
alytic derivative is utilized to obtain the identities. This means
that it is possible to use the free choice of equivalent identities
to give a differential operator which is entirely real and has a
positive-deﬁnite diffusion. This procedure is also followed in
the positive P[7] and positive Poisson[3] representations. Here
it is extended[11] to include the gauge variable W
as well as
the other variables. This is achieved by introducing a 2(d + 1)

4

dimensional real phase space (x0, ..xd, y0.. , yd), with deriva-
tives ¶ µ. Next, divide B = Bx + iBy into its real and imaginary
parts. A similar procedure is followed for A = Ax + iAy.
The choice for the analytic derivative, where ¶

¶ x
i or
i , can now be made deﬁnite by choosing it so the
resulting drift and diffusion terms are always real. In more
detail, this corresponds to choosing:

→ −

i¶ y

→

j

j

i

j

Di j¶

(3.6)

Ai¶
i¶

→
→

ikBx
jk

¶ y
i + Ay
¶ x
Ax
i ,
i
i
j + By
¶ x
¶ x
ikBx
Bx
i
jk
At this point, it is necessary to introduce a corresponding real
drift vector Aµ and diffusion matrix Dµn which are deﬁned
on the 2(d + 1) dimensional real phase space. Hence, the
gauge differential operator can now be written explicitly in
this equivalent real form, as:

j + (x

¶ y
i

y) .

↔

¶ x

LG =

Aµ¶ µ +

Dµn

¶ µ¶

(3.7)

(cid:20)

,

(cid:21)

where D = BB T is now positive semi-deﬁnite. This can be
seen by writing B as a 2(d + 1)

d′ real matrix:

B =

,

(3.8)

(cid:20)
so that the diffusion matrix is the square of a real matrix, with:

(cid:21)

1
2

×
Bx
By

D =

Bx
By

(cid:20)

×

(cid:21)

Bx

T

,

By

T

.

(3.9)

h(cid:0)
Thus, by choosing the analytic derivatives to give real terms
in LG , with a positive semi-deﬁnite diffusion operator on a
real space of 2(d + 1) dimensions is obtained. The full evolu-
tion equation is then:

i

(cid:1)

(cid:1)

(cid:0)

P(t) =

¶ t

Z

G(−→a
)

LGp(−→a
)

d2(d+1)

−→a

.

(3.10)

(cid:2)
Provided that one can integrate by parts, there is at least one
solution for G which satisﬁes the positive-deﬁnite Fokker-
Planck equation:

(cid:3)

G(−→a

,t) =

¶ t

−

(cid:20)

¶ µAµ +

¶ µ¶

n Dµn

G(−→a

,t) .

(3.11)

1
2

(cid:21)

It is important to note here that the crucial partial integra-
tion step is only permissable if the distribution is strongly
|−→a
enough bounded at inﬁnity (
) so that all boundary
|
terms vanish. Typically this means that the distribution must
be bounded more strongly than all power laws in 1/

The positive-deﬁniteness of the diffusion matrix D then im-
plies that the Fokker-Planck equation is equivalent to a set of
d + 1 Ito stochastic differential equations, with d′ real Gaus-
sian processes z
i(t). This central result can be written com-
pactly using the complex variable form, as:

→

|.

|

= W

gkz k(t) ,

d′

k=1

dW
dt

j

da
dt

= A+

j (−→a

) +

B jk[z k(t)

gk] .

(3.12)

−

d′

k=1

¶
(cid:229)
¶
W
W
¶
n
¶
¶
¥
a
a
a
(cid:229)
(cid:229)
The noises z
i(t)z
and are uncorrelated between time steps.

i have correlations < z

j(t′) >= d

i jd (t

t′),

−

This is transformed into a stochastic gauge equation by ﬁrst

introducing a reaction rate Rr for the r

th reaction:

IV. STABILIZING GAUGES

It is crucial at this stage to choose g so that the resulting
dynamics are not singular. No deterministic trajectory can be
allowed to reach the boundary in a ﬁnite time, even on a set of
initial conditions with measure zero, as this is the signature[9]
for a distribution with a power-law tail - which cannot be in-
tegrated by parts exactly. This is an important question of
principle, as it can lead to systematic errors.

A second criterion of practical signiﬁcance, is to use a
gauge that does not alter trajectories in the most probable
and stable regions. If this is not satisﬁed, then the stochas-
tic noise in the gauge amplitude W
creates a relatively large
and growing sampling error. It should be realized that this is
not an issue of mathematics, but rather one of computational
efﬁciency. In performing a numerical calculation, there are al-
ways some numerical errors. These are due to the ﬁnite nature
of computers (and even human calculators). Thus, one has to
estimate and minimize numerical errors due to round-off er-
ror, ﬁnite step-size in time, and sampling error due to the use
of a ﬁnite sample of trajectories.

In general, there is an optimum gauge which minimizes
sampling errors, but even a non-optimal gauge can be used
simply by increasing the number of sampled trajectories. In
this section, I demonstrate the existence of stabilizing gauges.
In the following sections, the numerical simulation of a realis-
tic nonlinear master equation (which generates boundary term
errors without a stabilizing gauge) is shown to give correct
results within the sampling error. The important issue, as al-
ways, is that the calculated result must agree with the correct
value within a known error-bar.

A. General master equation

The most general case considered here consists of a number
of coupled reactions, labeled with an index r. Each reaction
has the following generic structure:

n r

jX j

j

kr

→

µr

jX j .

j

(4.1)

j = 0, 1, 2, and (cid:229)

Here the reactions are restricted to be at most binary, so that
n r
j, n r
µr
2. Using the identities of Eq
j ≤
(2.3) the following Fokker-Planck equations are found, with a
similar pattern to the previous example, Eq (2.10):

j µr
j, (cid:229)

j

¶ G(n)
¶ t

= (cid:229)

j)µr

j

(1

−

(1

−

−

j

n r
j

j)

#

r "

j

kr (cid:213)

× "

j

n r
j

j

#

G(n) .

(4.2)

5

−

n r
j

j

.

Rr = kr (cid:213)

j

With this deﬁnition, the basic drift and noise matrices of the
gauge stochastic differential equations, Eq (3.12) are given by
a result of Gardiner[3], on considering all possible values and
combinations of µr
j = (cid:229)
A+
Di j = (cid:229)

j, n r
j:

µr
j −
(cid:1)
i (µr
µr
j −

j(n r
n r

j −

(cid:0)
Rr

n r
j

Rr

i j)

i j)

−

r

= (cid:229)

(cid:2)
BikBk j .

r

k

(cid:3)

B. Minimal gauge selection

Just as in the simpler example of Eq (2.10), these equations
only have constant, linear and quadratic terms. Hence, the
unmodiﬁed drift equation for the a-th component can always
be written as:

i

= Ci + (cid:229)

Li ja

j

−

j

j

¶ t

Q−i j

ia

j + (cid:229)

Q+
i jk

ja k ,

(4.3)

jk

where all coefﬁcients are real, and the quadratic terms are
deﬁned as positive: Q+ > 0, Q− > 0. Note that the structure
of the kinetic equations is such that creation terms Q+
i jkmay in-
j, a k; while the annihilation terms
volve any of the numbers a
Q−i j have to involve least one number a
i which has the same
index as on the left hand side.

I now wish to demonstrate that there is a minimal stabilizing

gauge, provided that the following conditions are satisﬁed:

the deterministic rate equations are stable even with lin-
ear terms removed

linear terms introduce no new instabilities to the gauge
equations

•

•

This proof gives only minimal conditions for gauge-
stabilization. Other stable gauges also exist, and may be more
efﬁcient in terms of sampling error in any given case.

Any deterministic instability is generally ruled by various
conservation laws a priori. The present equations are not al-
ways strictly number-conserving however - i.e., reservoirs are
allowed. Nevertheless, I assume them deterministically stable,
in the sense of having no moving singularities for any positive
real values of a
j, even without linear terms. Certainly, if ﬁnite
time singularities occur in a rate equation solution, then the
nonlinear terms in the master equation are necessarily unphys-
ical. Note that moving singularities only occur when there are
nonlinear terms, so the addition or removal of linear terms is
usually not crucial.

A moving singularity can occur in the analytic continuation
of the rate equations, which are the precise equations found in

(cid:229)
(cid:229)
(cid:213)
¶
(cid:213)
¶
a
a
d
d
¶
a
(cid:229)
a
a
the usual positive Poisson equations. It is essential to remove
any singularities if the resulting stochastic equations are to be
accurate and useful - although the equations with singularities
can still be used as approximate equations for large particle
number.

Since the Painleve conjecture[12] states that moving singu-
larities are a generic property of non-integrable sets of equa-
tions, it is to be expected that these will generally occur. Each
singularity has the signature that for at least one component
j, it evolves to
in a ﬁnite time t0, and hence must
typically have a leading term with an inverse power-law time-
dependence with power p j for t < t0:

= ¥

|

|

j

a 0
j
t)p j

.

j =

(t0

(4.4)

−
Several different power laws are possible on a given trajec-
tory, depending on the species j. Suppose there is already a
singularity in the complex nonlinear rate equations with linear
terms set to zero. Since constant terms have a zero power, the
singularity must also exist in a reduced set of equations, with
leading terms at most of form:

i

= (cid:229)

¶ t

j,k

Q+
i jk

ja k

Q−i j

ia

j .

−

j

(4.5)

Therefore, the leading terms in each singular equation have
power laws and amplitudes of form satisfying:

pi + 1 = p j + pk = pi + p j
a 0
pia 0
i

i = Q+
i jk

Q−i j

a 0
j

a 0
k −

a 0

j .

(4.6)

In this equation, only those terms whose powers match the
LHS have to be included.

1. Circular gauge

Next, it is important to choose an appropriate diffusion
gauge - that is, the choice of matrix square root of the dif-
fusion matrix must be speciﬁed. This is most simply done
by choosing to regard each distinct unidirectional reaction as
having a distinct noise term - proportional to the reaction rate
Rr. This choice may not always be optimal for sampling pur-
poses, but it is a possible choice, and there is a resulting drift
gauge which is stable.

This follows, since every nonlinear rate equation of form
da /dt = R (cid:181)
j + f k) has a corresponding
exp(f
noise proportional to √R . Thus, it is always possible to sub-
tract the gauge term

j =

ia

ia

|

|

j

gB = R[1

exp(i(f

−

f k))] ,

−

j

−

(4.7)

which cancels the original rate and replaces it by one rotated
by a phase angle f equal to the phase of a
. The deterministic
part of such an equation can only modify the amplitude of a
,
and so is effectively restricted to a one-dimensional real space,
just as the usual rate equations are.

6

The gauge-modiﬁed equation is non-analytic, and should
have no Painleve type singularities, because all phases match.
This is easily demonstrated from the fact that any singular so-
lution must satisfy Eq (4.6) with all a 0
j real and positive. But
this would give rise to a singularity in the corresponding non-
linear deterministic rate equations, which is ruled out by hy-
pothesis. The process can be iterated until all singularities are
removed.

Hence, the gauge corrected equations with only nonlinear
terms are stable. This implies stability in the complete set -
provided the linear terms can introduce no new instabilities,
as was assumed. When the rate-equations have an attractor,
this gauge tends to produce random circular paths instead of
localized behavior in the complex phase-space. I will there-
fore refer to it as the ‘circular’ gauge.

2. Phase gauge

The circular gauge can be further improved by modifying
the gauge term so that it also stabilises the phase near f = 0.
This reduces the size of the gauge-induced noise, and hence
reduces sampling errors. A suitable choice is:

gB = R[1

f (~f ) exp(i(f

f k))] .

j

−

−
Here the real part of f (~f ) satisﬁes ´

−
f (~f )=1; while the
imaginary part has an attractor at~f = 0, where the gauge cor-
rection is deﬁned to vanish. An example of this, treated in
n2. In this case, one can sim-
more detail later, is when R =
ply choose:

−

(4.8)

gB =

n[x

−

n
− |

] = R[1
|

n
(
|

|

−

+ iy)/n] .

(4.9)

This has no effect on global stability, but increases the likeli-
hood of trajectories near ~f = 0, where the phase gauge above
generates a deterministic equation in the form df /dt (cid:181)

.

Since the most likely trajectory is in-phase and has zero
gauge correction, the corresponding gauge noise and resulting
sampling errors are reduced, as I will show later in the numer-
ical examples. This gauge will be called the ‘phase’ gauge, as
it stabilizes the phase-angle of a as well as the modulus.

−

C. Numerical Simulations

The results of direct numerical simulations can be used
to test the necessity and effectiveness of different stochastic
gauges. The numerical results included in this paper are sim-
ple examples where the detailed results of simulations can be
evaluated in exactly soluble cases. In particular, it is important
to verify (in at least some cases) that gauges with no moving
singularities lead to exact simulations - without the system-
atic boundary term errors of the Poisson method. Although
similar nonlinearities occur in spatially extended systems[13],
more subtle gauge choices may be better in these cases.

a
a
¶
a
a
(cid:229)
a
a
a
f
f
f
1. Stratonovic calculus

and mutation is of the form[4]:

Stochastic calculus is normally carried out in one of two
different forms. The ﬁrst is the Ito calculus, where all terms
that multiply a stochastic noise are evaluated before carrying
out the stochastic step forward in time. This is the simplest
form, and corresponds directly to the coefﬁcients in the type
of Fokker-Planck equation used in the earlier sections of this
paper. The second is the Stratonovic form, where all the mul-
tiplicative terms are evaluated implicitly at the midpoint of a
given step forward in time. This form corresponds to taking
the wide-band limit of a ﬁnite band-width stochastic equation,
and follows more standard calculus rules for variable-changes.
For numerical simulations[14] it is generally more efﬁcient
to use Stratonovich equations[3] - in which the Ito drift term
is modiﬁed in a standard way to allow central difference algo-
rithms to be employed. In a generic Ito equation with coefﬁ-
cients corresponding to those in the real Fokker-Planck equa-
tion of Eq (3.11), the Stratonovic method generates a modiﬁed
drift term A s

µ, where:

µ = Aµ
A s

Br

1
2

−

r Bµn

.

(4.10)

The resulting equations can be used directly in stable implicit
central-difference algorithms, which are robust and well-
suited to the present nonlinear equations.

2. Error estimation

Discretization error can be estimated by comparing sim-
ulations with different step-sizes, but identical underlying
noise sources. The maximum discretization error was typ-
3 in the simulations in this paper. The
ically of order 10−
algorithm used was an iterative implicit central difference
method[14], which directly implements the Stratonovic form
of the stochastic equation. All numerical code was generated
in C++ including estimators of both the sampling error and
discretization error, using an an XML script and an automatic
code generator[15] obtained from the XMDS project website.
As an estimator of sampling error, I use the Gaussian esti-
mator of the standard deviation in the mean, s m = s /√Ns.
However, it should be noted that more sophisticated esti-
mators may be needed when the results are strongly non-
Gaussian, as in some of the Poisson simulations.

To ensure that the results were a strong test of the stochastic
gauge method, a large number of Ns = 106 samples were used,
to give low sampling errors s m.

V. GENETIC MUTATION MASTER EQUATION

As one example, ﬁrst consider the genetic problem of a
stochastic master equation for a ﬁnite population, in which
case the N j are simply the populations of genotype j. A sim-
ple model for linear evolution through asexual reproduction

7

(5.1)

X j
Xi

k j 0
ki j Xi + X j .

→
→

Qi)kb
i

, where kb

Here kii = (1
j ki j is the total birth
−
rate, ki is the death rate, and Qi is the mutation rate. Deﬁning
N±[i] = (N1, Ni
1.., Nd), the corresponding master equation
is:

i = (cid:229)

±

d
dt

P(N) =

ki jNi + (cid:229)

kiNi

P(N)

i

!

−  

i, j

ki(Ni + 1)P(N+[i])

+ (cid:229)

+ (cid:229)

i

i, j

ki j(N j

1)P(N−[ j]) .

(5.2)

−

This has well-known problems:

the state-space may be
very large, preventing a direct matrix solution. On the other
hand, while the corresponding average rate-equations reduce
to the widely-studied Eigen[4] quasi-species model, the rate-
equations are unable to treat population ﬂuctuations in small
samples.

A. Stochastic equations

The equivalent Poissonian stochastic equation is exact for
the problem given here, without requiring a system-size ex-
pansion. It is:

j

da
dt

=

k ja

−

j + (cid:229)

ki ja

i + B jkz k(t)

.

(5.3)

i

(cid:2)

(cid:3)

the noise matrix B jk is determined from the sym-

Here,
metrized diffusion matrix, Di j = [a

jk ji], where:

iki j + a

BikB jk = Di j .

k

(5.4)

This tells us immediately an important result: an initially Pois-
sonian distribution is invariant under pure decay processes,
but can develop increased ﬂuctuations with non-Poissonian
features due to birth and mutation events.
In general, con-
structing the square root of a symmetric real matrix Di j is non-
unique. The most powerful technique requires a matrix diago-
nalization through an orthogonal transformation, and may re-
sult in eigenvalues of either sign. If all the eigenvalues are pos-
itive, the resulting ﬂuctuations are super-Poissonian. If some
are negative, at least one sub-Poissonian feature will occur,
and a complex stochastic process will result.

A simple, even though somewhat extreme, example is ob-
tained by considering a symmetric two-species case with Q j =
1, k = k j, km = k12 - so that mutations always occur. In this
(rather unrealistic) case, the diffusion is entirely off-diagonal,
and the Poisson representation exactly transforms an exponen-
tially complex master equation into a soluble stochastic equa-
tion. This can be simpliﬁed further as follows, on introducing

n
¶
(cid:229)
(cid:229)
= (a 1

a 2) and k± = (k

km) :

n

±

±

±

k−n+ +

2kmn+z 1(t)

dn+
dt
dn
−
dt

=

=

−

−

p

+ i

k+n

−

p

2kmn+z 2(t) .

(5.5)

In this situation, there is an absorber at n+ = 0, since any
stochastic trajectory that reaches this value has a zero deriva-
tive. This is due to the randomness of birth or death events,
which mean that it is always possible for the random walk in
this low-dimensional population space to ﬁnish at extinction.
In addition, any initial differences between the two popula-
tions decays, and is replaced by a strong sub-Poissonian cor-
relation. This is due to the fact that all births must occur in a
way that tends to equalize the two species that are present.

B. Means and correlations

To caculate analytic solutions, standard Ito calculus can be
used to obtain the exact time-evolution of correlations and ex-
pectation values. This is straightforward, since in Ito calcu-
lus the noise terms are not correlated with the other stochas-
= 0. Thus, the
tic variables at the same time, so
means and variances are all soluble from their respective time-
evolution equations - which is also possible using the master-
equation form. Deﬁning the initial means and correlations as:
n2
, n2
, n2
(0)
n
(0)
, n
n+(0)
n+ =
+(0)
=
i
h
i
h
h
i
i
−
−
−
and n+n
, one directly obtains the following
(0)
n+(0)n
=
i
h
−
exact results:

j(t)
i

n2
h
−

+ =

f (a

i)z

=

−

h

n+(t)
i
h
(t)
n
h
i
−
n2
+(t)
i
h

k−t

k+t

= n+e−

= n

e−

−
= n2
+e−

2k−t + 2kme−

3k−t/2n+

n2
h
−
n+(t)n
h

−

(t)
i

(t)
i

= n2
−
= n+n

2k+t +

e−

(cid:18)
2kt .

e−

−

2kmn+
k + 3km (cid:19) (cid:16)

sinh(k−t/2)
k−/2

k−t

e−

2k+t

e−

−

(cid:17)
(5.6)

Suppose that km = k, so the mean population is time-
invariant. Then the asymptotic population differences have
a mean and variance of:

lim
¥ h
t
→
[N
lim
¥ h
t
→

N

(t)
i

−
(t)]2

−

i

= 0

= lim
¥ h
t
→
¯n+
2

=

.

[n

(t)]2 + n+(t)
i

−

(5.7)

This indicates that the population difference has a steady-
state variance of half its usual value, owing to the fact that all
births are correlated between the species, thus causing sub-
Poissonian statistics - while all deaths are uncorrelated, thus
tending to restore the Poissonian distribution. By compari-
son, the variance in the total population shows linear growth

8

<n+>, <n−>
6
6

 

5
5

4
4

3
3

2
2

1
1

0
0

0
0

1
1

2
2

t

3
3

4
4

5
5

Figure 1: Sampled moments of
(lower
n+
n
−i
h
h
curve) for genetic mutation example in the Poisson representation,
parameters as in text. Sampling error (s m) is of order 10−
3or less.

(upper curve) and

i

in this case, as some populations in the total ensemble become
extinct, while others can randomly grow to a large population.
In this case there are no unstable trajectories, and the posi-
tive Poisson method can be used with zero gauge terms. How-
ever, it should be noted that this model is rather simple, ignor-
ing competition between the two species: which could lead to
nonlinear effects requiring gauge corrections.

C. Numerical results

Applying the Stratonovic rules to generate equations for in-

tegration results in:

dn+
dt
dn
−
dt

=

=

−

−

−

k+n

+ i

−

km/2

k−n+ +

2kmn+z 1(t)

p
2kmn+z 2(t) .

(5.8)

p
This illustrates the typical feature of the Stratonovic calcu-
lus, which is the generation of terms in the drift equations due
to the noise. Some care is needed in calculations near the ab-
sorbing boundary at n+ = 0, which is treated by imposing an
appropriate boundary condition at this point.

Fig (1) shows the mean values obtained from numerical
simulation of these equations for an ensemble of 106 trajecto-
ries. The numerical and analytic results are indistinguishable
at this graphic resolution.

The results for population variances and cross-correlations
are shown in Fig (2), also agreeing extremely well with the
analytic predictions.

The integrations were for a total time of t = 5, using values
of k = km = 1. The minimum step-sizes used were D
t = 0.01
and D
= 2,
t = 0.005. Initial values were set to n+ = 5, n
to give results in low population regions with large departures
from Poissonian behavior. All simulation results agree well
within the sampling error, as shown in the Table (1) - ex-
cept for the result for
, where the residual discrepancy
8 is actually caused by a small discretization error of
of 10−
8, since the sampling error is zero in this quantity.
2
10−
In summary, for this example, all the simulation results
are in excellent agreement with analytic predictions for this

n
h

−i

×

≃

−

<n+.n+>/10, <n−.n−>, <n−.n+>
 

11
11
11

9
9
9

7
7
7

5
5
5

3
3
3

1
1
1

−1
−1
−1

−3
−3
−3

0
0
0

1
1
1

2
2
2

t

3
3
3

4
4
4

5
5
5

Figure 2: Sampled moments of
−i
(lowest curve), for genetic mutation exam-
(middle curve) and
ple in the Poisson representation, parameters as in text. Sampling
error is of order 10−

n2
−i
h
3or less.

/10 (straight line),

n+n
h

n2
+i
h

Moment

Analytic

5.0

×
75
2.5

n+
i
h
n
−i
h
n2
+i
h
n2
−i
h
n+n
h

−i

0.9080

10−

4 0.9079(0)

4
10−

−
0.4540

10−

×

−
3 0.4541(6)

3
10−

×

Poisson

5.002(7)

×
75.1(2)
2.502(7)

Table I: Table of observed moments (standard deviations s m in
brackets), comparing analytic and simulated results for the genetic
equations in the Poisson expansion at t = 5.

model.

VI. ASTROPHYSICAL MOLECULAR HYDROGEN
PRODUCTION

The previous results do not yet involve stochastic gauges.
These are only needed when the equations are nonlinear,
which comes about when multi-component competition or
formation processes are present. To give a typical example
of this, consider the astrophysically important problem of hy-
drogen recombination to form molecules on interstellar grain
surfaces[5]. This is thought to be the major source of inter-
stellar H2, and it is known that conventional rate equations are
unable to describe this accurately, due to low occupation num-
bers at the critical step of dimer formation. The main reactions
are:

H(IN)
2H
2H
H
H2

r H
k1 H2
k2 H∗2
a H∗
a 2 H∗2 .

:
→
→
→
→
→

(6.1)

This describes a species H which can grow via a gener-
ation rate (r) from an input ﬂux H(IN) , until it reaches an
equilibrium[1] due to losses from molecule formation (k =
k1 + k2 ), and desorption (a ),which stabilizes the concentra-
tion of H. The concentration of H2 is also stabilized by des-

9

orption (a 2). There are additional effects due to ﬂux-blocking
of r caused by adsorbed molecules and atoms, which are de-
scribed by extra terms k5 and k6 that are negligible at low
ﬂuxes .

A. Analytic solutions

We can introduce Poisson variables a 1, a 2, a 3, a 4 , repre-
senting [H], [H2], [H∗], [H∗2 ] respectively, and deﬁne n = a 1,
which is the hydrogen atom number. From the Poisson expan-
sion viewpoint, the only non-trivial term is the hydrogen equa-
tion, as this introduces noise. The resulting Fokker-Planck
equation is simply:

G(n,t) =

¶ t

r + g n + 2kn2

k

¶ n2 n2

−

G(n,t) .

(6.2)
This has a steady-state which is exactly soluble, though de-
ﬁned on a complex contour starting and ending at the origin:

(cid:1)

¶ n

(cid:20)

−
(cid:0)

G(n, ¥ ) = Cn(g /k

2) exp

−

2n +

(6.3)

(cid:21)

.

r
kn

(cid:17)

(cid:16)

Here I have kept the derivatives in analytic form, to obtain
the simplest potential solution. However, the result is instruc-
tive, since it is clear that this analytic form is inherently com-
plex. This is the essential reason why a gauge variable W
is
needed in order to get simulations that behave like this simple,
compact solution. The gauge variable can attain complex val-
ues during a stochastic calculation, even when the distribution
itself is constrained to have positive values

For simplicity, I introduce relative ﬂux and relaxation pa-
rameters, e = r/(2k) and n = a /2k. Next, using a Sommer-
feld contour-integral identity in the inverse variable µ = 1/n -
one obtains the result that:

nM

= C

µ(2

−

M

−

2n )e2e (µ+1/(e µ))dµ

(0+)

(cid:10)

(cid:11)

Z

−
= e M/2I2n +M

1(4√e )/I2n

1(4√e ) .

(6.4)

−
This exact solution gives the H2 production rate (neglecting
n2
dissociation): RH2 = k
An obvious result, coming from the asymptotic properties

m
h

=

−

i

.

of Bessel functions, is that

(cid:10)

(cid:11)

nM

= e M/2 ,

lim
→

(cid:11)

(cid:10)
nM

rM
1])

(cid:11)

(cid:10)

=

(g + k[M

lim
0
→
−
Thus for large grains with e
the high ﬂux limit is just
→
RH2 = ke , which is also the rate-equation limit. At low ﬂuxes
(i.e., small grains) a dramatic and physically understandable
feature is obtained: the H2 production rate can be suppressed
below the rate equation result. In this limit of e

(6.5)

(a )

0 ,

×

×

..

→

r

n

h

i

n2

=

=

(cid:10)

(cid:11)

r2
g (k + g )

.

(6.6)

¶
¶
¶
¥
e
¥
e
¥
g
<n>, <m>

 

Poisson sampling error

 

10

1.0
1.0
1.0
1.0

0.6
0.6
0.6
0.6

0.2
0.2
0.2
0.2

−0.2
−0.2
−0.2
−0.2

−0.6
−0.6
−0.6
−0.6

−1.0
−1.0
−1.0
−1.0

−1.4
−1.4
−1.4
−1.4

8e−3

7e−3

6e−3

5e−3

4e−3

3e−3

2e−3

1e−3

0

0

0
0
0
0

8
8
8
8

16
16
16
16

24
24
24
24

t

32
32
32
32

40
40
40
40

8

16

24

t

32

40

n2
Figure 3: Sampled moments of
n
i
h
i
h
(lower curve) for astrophysical hydrogen molecule production in the
Poisson representation, parameters as in text. Adjacent lines give
upper and lower (

s m) error bounds caused by sampling error.

(upper curve) and

m
h

=

i

±

g ,

≫

For k

this predicts enormously reduced hydrogen
molecule production rates compared to normal rate equations.
The reason for this is simply that when there is only one atom
at a time on the grain, no molecules are produced. This result
has been found in earlier Monte Carlo calculations as well[5],
so it is a veriﬁcation of the current procedures to reproduce
this known result.

B. Stochastic equations

It is simplest to use a scaled time t = 2kt to calculate the
stochastic equations in n. With this variable the drift and noise
matrices are both scalars. The resulting Ito stochastic equa-
tions, including the gauge terms for astrophysical hydrogen
production, are:

= W gz

dW
dt
dn
dt

=

n n

n2

+ in[z

−

−

g] .

−

(6.7)

(cid:2)

(cid:3)

→ −

These equations are unstable in the absence of gauge terms.
¥ which can be accessed
There is a singular trajectory n
via the complex diffusion of n into the negative half-space
of n < 0 . Previous work on similar equations in quantum
optics[8, 9] has shown that this leads to systematic errors, due
to the resulting power-law tails in the distribution, which can
introduce boundary terms if Eq. (2.6) is integrated by parts
directly.

Results of the numerical simulations in the Poisson rep-
resentation, showing upper and lower one-standard deviation
error-curves, are given in Fig (3). The results clearly show the
problems caused by the dynamical instabilities in these equa-
tions, which cause both a large sampling error, and systematic
errors. These equations are exceptionally difﬁcult to integrate
numerically, owing to the instabilities, and it is essential to
< 1 , and 1/n (for
integrate by alternating between n (for
> 1) in order to obtain stable numerical results.
n
|
|
Numerical results throughout this section were obtained us-
ing parameters of e = 0.1, n = 0.1 for which the analytic re-

n
|

|

Figure 4: Standard deviation s m in the mean
hydrogen in the Poisson representation.

n
i
h

for astrophysical

sults can be easily calculated from the Bessel function repre-
sentation. In this region the rate equations break down, and
occupation numbers are very small, which is a testing region
of parameter space for these expansions - since the ﬂuctua-
tions are far from Poissonian. The integrations were for a
total time of t = t = 40 to allow an approximate numerical
steady-state to be reached from an initial value of n = 0 (for
simplicity, a value of k = 1/2 was taken). The minimum step-
sizes used were D

t = 0.005 and D

t = 0.0025.

While the sampling error in the molecule production rate is
large, the sampling error in the atom number is relatively sta-
ble in time. A graph of this quantity is provided in Fig (4). The
fact that this does not grow in time indicates that the distribu-
tion has equilibrated, although the discrepancy between these
results and the exact ones indicates that the apparent equilib-
rium does not correspond to a solution of the master equation.

C. Stabilizing gauges

Fortunately, it is simple to stabilize these equations by
adding non-analytic corrections to the drift. For example, con-
sider the effects of three different gauges which all stabilize
the equations:

) [circular]
n
gc = i(n
|
− |
n
gp = i(x
) [phase]
− |
|
gs = 2ixq (
x) [step].
−
In the minimal circular gauge, the Stratonovic equations

(6.8)

are:

dW
dt = W
dn
dt = e

gc z + (n

g2
c)/2

−

n [n

(cid:2)
−

−

1/2 +

(cid:3)
]+ inz
|

n
|

.

(6.9)

In the phase gauge, the Stratonovic equations are:

dW
dt = W
dn
dt = e

gp z + (iy

g2
p)/2

−

n [n

(cid:2)
−

1/2 +

n
|

|

−

(cid:3)

+ iy]+ inz

.

(6.10)

e
<n>, <m>

0.5
0.5
0.5
0.5

0.4
0.4
0.4
0.4

0.3
0.3
0.3
0.3

0.2
0.2
0.2
0.2

0.1
0.1
0.1
0.1

0
0
0
0

0
0
0
0

 

t

11

Phase gauge sampling error

 

20e−4
20e−4
18e−4
18e−4
16e−4
16e−4
14e−4
14e−4
12e−4
12e−4
10e−4
10e−4
8e−4
8e−4
6e−4
6e−4
4e−4
4e−4
2e−4
2e−4
0
0

8
8
8
8

16
16
16
16

24
24
24
24

32
32
32
32

40
40
40
40

0
0

8
8

16
16

24
24

32
32

40
40

t

Figure 6: Sampling error standard deviation s m in the mean
per curve) and in
phase gauge.

(up-
(lower curve) for astrophysical hydrogen in the

n
i
h

m
h

i

n2
Figure 5: Sampled moments of
n
i
h
i
h
(lower curve) for astrophysical hydrogen molecule production in the
‘phase’ gauge, parameters as in text. Adjacent lines give upper and
lower (

s m) error bounds caused by sampling error.

(upper curve) and

m
h

=

i

±

In the step gauge, the equations are coordinate dependent:

Moment Analytic Poisson Circular

Phase

Step

1.0

1.0

0.994(10) 0.997(4) 1.005(6)
0.407.. 0.457(4) 0.402(5) 0.403(2) 0.406(4)
0.059.. 0.094(8) 0.061(2) 0.057(1) 0.064(3)

i
h
n
h
i
m
i
h

gs z + iy

g2
s/2

−

(x < 0)

dW
dt = W
dn
dt = e
= e

n [n
n [n

(cid:2)
−

−

−

−

(cid:3)
n∗] + inz
1/2
−
1/2 + n]+ inz

(x < 0).

(x > 0).

(6.11)

Table II: Table of observed moments, comparing analytic and sim-
ulated results for three different stochastic gauges and the Poisson
n2
expansion; the moment
is critical for molecule produc-
h
tion. Sampling error (s m) in brackets.

m
h

=

i

i

n
|

/dt < 0 at large enough
|

Clearly the ﬁrst two equations only have inward drift vec-
tors with d
. The last, the step
|
gauge, is similar, except that it shows linear growth if n < 1/2
and x = 0. At worst this can only lead to a singularity in in-
ﬁnite time, and in any event the y-axis is not an atractor: so
growth along the y axis only leads to a temporary increase in
radius, not a singularity. Hence, all three gauges are com-
pletely stable, with no moving singularities.

n
|

D. Numerical simulations

As results in all three gauges were similar, apart from
changes to the sampling error, I will only show graphs of the
detailed results in the phase-stabilized gauge.

Results of the numerical simulations in the phase-stabilized
gauge, showing upper and lower one-standard deviation error-
curves, are given in Fig (5). It is clearly dramatically improved
compared to the Poisson results.

While the sampling error is growing in time as shown in
Fig (6), it is scarcely visible on the mean value graphs - with
improvements of up to three orders of magnitude in the sam-
pling error of molecule production rates, relative to the Pois-
son method.

E. Comparison of moments and sampling errors

Apart from the unmodiﬁed Poisson or ‘zero gauge’ results,
the gauge simulations are stable. Nevertheless, on closer in-
spection, the stable gauges don’t behave in an identical way
as regards the sampling error with a ﬁnite set of trajectories.

For each gauge and for the Poisson expansion, the observed
moment and its sampling error s m (standard deviation in the
mean) is given in Table 2, which tabulates the ﬁnal near-
equilibrium simulation results at t = 40, and compares them
to the equilibrium analytic result for t = ¥
. For the stable
gauges, the results are within s m of the analytic calculations
in most cases, and are within 2s m in the remaining more ac-
curate cases - where the residual discrepancy was partly due
to the ﬁnite time-step discretization error. This indicates that
all these (stable) gauges converge to the analytically known
correct answer.

n
h

The corresponding (unstable) Poisson method clearly gives
incorrect answers due to systematic boundary term errors,
with up to 12s m discrepancy in the case of the mean number
. The graphical and tabular evidence
of hydrogen atoms,
i
indicates that the mean atom number is incorrect because the
unstable trajectories cause power-law tails in the distribution,
and consequent boundary term errors. In addition, the graph
shows that the Poisson time-history has large ﬂuctuations,
showing no signs of equilibration for the molecule number
. This is further evidence for power-law tails, which are
m
h
i
also found in a similar quantum-optical master equation.

The circular gauge has no systematic errors, but gives the
worst sampling error of the stable gauges, as the n variable
is the least constrained in this gauge, tending to diffuse in a
circle. For these parameters the phase gauge gives the best
results, as it localizes the n variable near a deterministic sta-
ble point. The last gauge is a step gauge - only giving non-
zero corrections when x < 0. This has the feature that the
gauge term W
only changes when the trajectory has the (un-
usual) value of x < 0, and gives sampling errors intermediate

W
between the other two.

h

One might have expected that the step gauge would give
lower gauge noise errors, possibly with a smaller standard de-
viation in
, since this gauge is zero in the right half-plane.
i
Instead, the phase-stabilized gauge gives the lowest overall
sampling errors for all quantities with these parameter values,
. Presumably this result is
even for the gauge amplitude
h
an example of ‘prevention is better than cure’. That is, phase-
stabilization is also able to prevent amplitudes from growing
along the
y axis. The step gauge corrects this growth too late
for optimal results, having to use a numerically bigger gauge
correction with larger sampling errors.

±

i

VII. CONCLUSION

The gauge Poisson method is shown to generate a stochas-
tic differential equation that is exactly equivalent to a master
equation. This provides a complete solution to the problem
of stochastic equivalence of kinetic master equations - which
has not been treated in full previously. By comparison, the
system-size expansion is only approximate, and the positive
Poisson representation is not exact for problems which have
boundary terms due to moving singularities. The gauge tech-
nique provides a way to eliminate any boundary-term errors
due to singular trajectories, although the price paid for this
advantage is an extra stochastic gauge amplitude, which gen-
erates a sampling error that grows in time. The focus of nu-
merical simulations in this paper is on cases where the exis-
tence of exact analytic results allows the issue of random and
systematic errors to be carefully investigated.

It should be remarked that this type of model is very gen-
eral. For example, one can easily include linear diffusion
and extend the theory to treat ﬂuctuations in reaction-diffusion
models or even Boltzmann kinetics[3]. This simply requires
that the populations are deﬁned as occurring in a lattice of

12

−

bounded cells, either in ordinary space or in a classical phase-
space, together with the appropriate hopping rates. This sim-
plicity is a great advantage of Poisson-based expansions, as
compared to direct Monte-Carlo simulations. The relevant lin-
ear deterministic equations are just the same as would occur
in discretized non-stochastic equations. However, one ﬁnds
that it becomes necessary to include cell-volume factors in
the nonlinear rate constants, so that the noise terms vary with
th lattice cell volume Vj- typically resulting in stochas-
the j
tic noise terms proportional to 1/
Vj. Applications to these
problems will be treated elsewhere.
p

The technique can be easily extended to include a large
number of coupled kinetic processes, as occurs both in genet-
ics, and in the generation of chemical species of astrophysical
importance: for example, OH, H2O , CO and so on. By con-
trast, the direct solution of the master equation grows expo-
nentially more complex as the number of interacting species
increases. Similar considerations arise when treating biologi-
cal species with typically very large numbers of genotypes, or
when treating extended spatial (multi-mode) problems. The
method of choosing generically stable gauges developed here
may also be in some degree useful for the corresponding quan-
tum problems.

Acknowledgments

Numerical calculations were carried out using open soft-
ware from the XMDS project[15]. Thanks to the Australian
Research Council and the Alexander von Humboldt-Stiftung
for providing research support. Useful discussions on genetic
models with A. Drummond (Oxford) and on astrophysical
models with O. Biham (Jerusalem) are gratefully acknowl-
edged.

[1] H. Haken, Synergetics: An Introduction (2nd Ed, Springer,

J. Phys. A 13, 2353 (1980).

Berlin, Heidelberg, New York, 1978).

[2] N. G. Van Kampen, Stochastic processes in Physics and Chem-

istry (North-Holland, Amsterdam, 1992).

[3] I. Matheson, D. F. Walls, C. W. Gardiner, J. Stat. Phys 12, 21
(1975); C.W. Gardiner, S. Chaturvedi, J. Stat. Phys. 17, 429
(1977); 18, 501 (1978); C. W. Gardiner, Handbook of Stochas-
tic Methods, (2nd Ed, Springer, Berlin, Heidelberg, New York,
1985).

[4] M. Eigen, Naturwissenschaften 58, 465 (1971); I. Hanski, Na-
ture 396, 41 (1998); D. Alves and J. F. Fontanari, Phys. Rev
E 57, 7008 (1998); B. Drossel, Advances in Physics 50, 209
(2001).

[5] S. B. Charnley, Astrophys J 509, L121 (1998); Astrophys J 562,
L99 (2001);.O. Biham, I. Furman, V. Pirronello and G. Vidali,
Astrophys. J. 553, 595 (2001).

[6] D. T. Gillespie, J. Comput. Phys. 22, 403 (1976); J. Chem. Phys

81, 2340 (1977).

[7] S. Chaturvedi, P. D. Drummond and D. F. Walls, J. Phys. A
10, L187-192 (1977); P. D. Drummond and C. W. Gardiner,

[8] A. M. Smith and C. W. Gardiner, Phys. Rev. A 39, 3511 (1989);
R. Schack and A. Schenzle, Phys. Rev. A 44, 682 (1991).

[9] A. Gilchrist, C. W. Gardiner,
Phys. Rev. A 55, 3014 (1997).

and P. D. Drummond,

[10] P. Deuar and P. D. Drummond, Comp. Phys. Comm. 142, 442
(2001); I. Carusotto, Y. Castin and J. Dalibard, Phys. Rev. A 63,
023606 (2001).

[11] P. Deuar and P. D. Drummond, Phys. Rev. A 66, 033812 (2002).
[12] A. Ramani, B. Grammaticos, and T. Bountis, Physics Reports

180, 159 (1989).

[13] F. Baras and M. Malek Mansour, Phys. Rev. E 54, 6139, (1996);
U. L. Fulco, D. N. Messias, M. L. Lyra, Phys. Rev. E 63, 066118
(2001).

[14] P. D. Drummond and I. K. Mortimer, J. Comp. Phys. 93, 144-

170 (1991).

[15] G. R. Collecutt, P. D. Drummond, Comput. Phys. Com-
mun. 142, 219-223 (2001); http://www.physics.uq.edu.
au/xmds/

W
W
