Analytical study of the eﬀect of recombination on evolution via DNA shuﬄing

∗

Weiqun Peng∗, Herbert Levine∗, Terence Hwa∗, and David A. Kessler†
Center for Theoretical Biological Physics, University of California San Diego,
9500 Gilman Drive, La Jolla CA 92093, USA and
Department of Physics, Bar-Ilan University, Ramat-Gan, Israel
†

We investigate a multi-locus evolutionary model which is based on the DNA shuﬄing protocol
widely applied in in vitro directed evolution. This model incorporates selection, recombination and
point mutations. The simplicity of the model allows us to obtain a full analytical treatment of both
its dynamical and equilibrium properties, for the case of an inﬁnite population. We also brieﬂy
discuss ﬁnite population size corrections.

3
0
0
2
 
r
a

M
 
8
2
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
0
2
1
3
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

2

Recombination of genetic information is a widespread phenomena in both prokaryotes and eukaryotes. In prokary-
otes, recombination occurs in the forms of transformation, virus aided transduction, and conjugation. In eukaryotes,
recombination between homologous sequences is a fundamental component underlying sexual reproduction (e.g.,
LODISH et.al. 1999). An enormous body of research has been devoted to understanding the evolutionary beneﬁt
of recombination in various circumstances. This eﬀort has led to some general understanding of the circumstances
under which recombination helps facilitate evolution, although many important questions still remain open (OTTO
and LENORMAND 2002).

Inspired by recombination in natural evolution, and propelled by advances in biotechnology, recombination has
been employed in in vitro molecular evolution experiments to develop novel proteins and DNA sequences (e.g.,
KURTZMAN et.al. 2001; FARINAS et.al. 2001). This family of evolutionary protocols, called DNA shuﬄing (or
molecular breeding) (STEMMER 1994a; 1994b), has been shown experimentally to produce, in terms of the rate of
evolutionary progression and ﬁnal product quality, far superior results as compared to conventional directed evolution
methods using only mutagenesis (e.g., KURTZMAN et.al. 2001; FARINAS et.al. 2001). In addition to its widespread
practical applications, DNA shuﬄing (as an approach of in vitro evolution) has been used to mimic natural evolutionary
processes and predict possible evolutionary pathways (ORENCIA et.al. 2001; BARLOW and HALL 2002).

In spite of its enormous signiﬁcance, theoretical understanding of DNA shuﬄing has been lacking. In this paper,
we investigate DNA shuﬄing from the perspective of evolutionary modelling. Speciﬁcally, we aim to ﬁnd out, quan-
titatively and analytically, the beneﬁt that the extra step of recombination provides in the evolutionary process, as
well as such aspects as the role of mutation and ﬁnite population eﬀects.

Compared to other evolutionary models, DNA shuﬄing has two unique aspects that render it attractive to study.
First, the methods of biotechnology enable a unique recombination scheme that goes well beyond the classical one, i.e.,
two parents with at most a few crossovers. This multi-parent multi-crossover nature of DNA shuﬄing, as we shall see,
makes it more eﬀective, and also, incidentally, dramatically simpliﬁes the analytical treatment. Second, in the setting
of DNA shuﬄing the relationship between genotype, phenotype and ﬁtness is relatively clear and well-deﬁned. In
addition, such parameters as selection strength, mutation rate and the amount of recombination are all experimentally
controllable. These two characteristics should allow theoretical results to be tested directly against experiments.

Speciﬁcally, we propose a simple model that incorporates three basic ingredients: selection, recombination and
point mutations. In order to facilitate comparison with various existing evolutionary models, we present our ideas
in the language of population genetics. In this language, we study a haploid multi-locus model with multi-parent
free recombination, and subject to dynamical truncation selection, wherein the ﬁtness of a genotype depends on the
population state. We obtain analytical results for both the dynamics and the equilibrium properties, and gain insights
into not only why, but also how exactly recombination works. This is one of the rare cases in population genetics
where exact results can be obtained for a multi-locus model (KESSLER et.al. 1997).

THE MODEL

DNA shuﬄing involves a directed evolution process wherein a library of homologous DNA sequences are subject to
rounds of competitive selection and in vitro recombination with multiple parents and multiple crossovers (STEMMER
1994a; 1994b). DNA shuﬄing is a discrete process with non-overlapping generations, each round of which involves
selection, recombination and point mutation, and is ﬁnished by ampliﬁcation via the polymerase chain reaction
(PCR) of the population back to it original size. The typical selection scheme in DNA shuﬄing experiments is
truncation selection, also known as breeding selection, where only a ﬁxed portion of the population (e.g., the top
ten percent) is chosen to be retained to participate in later rounds. In truncation selection, whether a particular
member of the population is selected or not depends on whether the desired trait exceeds a certain threshold set by
the population as a whole and by the selection strength (i.e, the fraction of selected population). As opposed to other
evolutionary scenarios, there is no advantage to being better than the cutoﬀ threshold – there is no pressure to excel.
Mathematically, this has a dramatic eﬀect on the dynamics, in that the eﬀect of population size is much weaker, as
the rare “superstars” found only in a large population do not skew the results.

The recombination step typically involves random fragmentation of homologous DNA sequences by DNase digestion
and repeated cycles of re-assembly via a self-primed polymerase chain reaction (STEMMER 1994a; 1994b). Recombi-
nation produces chimeras with a controllable average fragment size (of order 10 base pairs or above). Point mutation
is incorporated via the recombination and ampliﬁcation steps where PCR is utilized and is naturally error-prone.
To date, the rate of point mutation has been kept very low and only single nucleotide substitution is assumed to
be involved. Thus, sequence diversity has come mostly from the diversity present in the initial library instead of
being generated by point mutation. This lessens the deleterious eﬀects associated with high rates of mutagenesis. but
ultimately limits the usefulness of the method. A proper balance of recombination and mutation would lead to more
optimal results.

3

 

y
g
r
e
n
E
g
n
i
d
n
i
B

m
0

s
s
e
n
t
i

F

m 
0

m
0

m

Binding Energy

FIG. 1: (a) Phenotypic landscape: Binding energy is exactly the number of favorable active sites (denoted by m). Dash line
indicates the corresponding selection threshold m0 at a particular stage of evolution. (b) The ﬁtness has a dynamic truncation
landscape. Sequences with binding energy below the threshold m0 are discarded, whereas those with binding energy above the
threshold are retained to reproduce with equal rate.

Despite its enormous practical success, theoretical analysis of the evolutionary dynamics of DNA shuﬄing has thus
far been lacking. Sun (1999), Moore and Maranas (2000) proposed predictive models for various experimental steps of
DNA shuﬄing experiments, addressing issues of recombination eﬃciency and distribution of fragment size during the
reassembly involved in a single round of evolution. We concern ourselves instead with the evolutionary consequences
of multiple rounds.

To make our discussion concrete, we envision the competitive evolution of a library of DNA sequences, selected via
binding aﬃnity to certain proteins; an example of such a system is the DNA-histone interaction (THASTROM et.al.
1999). As discussed elsewhere (VON HIPPEL and BERG 1986; PENG et.al. 2003), selection achieved via thermodynamic
binding can be mimicked to a high level of accuracy by the simple truncation selection approach. In order to facilitate
a theoretical treatment, we construct simpliﬁed models of the recombination and selection steps. Let us describe the
selection step ﬁrst. For selection, we need a model that connects genotype and phenotype, which is in this case the
binding energy of the DNA to the protein, as well as a model that speciﬁes selection on the phenotype. We adopt the
simplest relationship between genotype and phenotype. We assume that each nucleotide contributes to the binding
(= 4) nucleotides (representing A, C, G
energy independently and additively. Each nucleotide can be one of the
and T), among which one is favorable and the rest are equally deleterious. For simplicity, we denote the contribution
of a speciﬁc site to the binding energy 1 (0) if therein sits a favorable (deleterious) nucleotide. We will refer to a
favorable (deleterious) nucleotide as a match (mismatch) with respect to the optimal sequence. This formulation can
be derived from a two-state model for protein-DNA binding (VON HIPPEL and BERG 1986; GERLAND and HWA 2002).
The binding energy of the sequence is simply the number of sites with favorable nucleotides.

A

Fig. (1a) shows schematically the shape of our phenotypic landscape. Of course, our model reﬂects just this simplest
possibility. In reality, the phenotypic landscape could be much more complicated and is rarely known; in fact, a signif-
icant advantage of directed evolution over rational design is that this kind of knowledge is not necessary (e.g. ARNOLD
2001). Our strategy here is to study the simplest non-trivial model available, obtain a thorough understanding, with
the hope of proceeding to more complicated situations to see which results obtained in the simple model are general
and which are model speciﬁc. Having speciﬁed the phenotypic landscape, we next describe the selection protocol.
Selection acts on the binding energy of the sequences. As noted above, in (molecular) breeding, truncation selection
is used. We deﬁne the selection strength via the fraction φ of selected members of the total population. Suppose we
have a distribution of population Pm in terms of the binding energy m(m = 0, 1, . . . , L), where L is the total number
of active sites. The threshold m0 is self-consistently determined by

φ = αPm0 +

Pm,

L

m=m0+1
X

(1)

where α in the ﬁrst term takes into account of the partial selection on the threshold state m0. φ varies from φ . 1
(relatively weak selection) to small φ (relatively strong selection). For those sequences whose number of matches are
above (below) m0, their ﬁtness is 1 (0), and they are selected (discarded) [see Fig. (1b)]. In the truncation selection
scheme every member’s ﬁtness is collectively and dynamically determined by both the phenotypic distribution of the
population Pm and selection strength φ. In contrast, most ﬁtness landscapes studied prescribe for each genotype a

4

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)

(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)

Recombination

(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)
(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)(cid:0)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:1)(cid:1)

FIG. 2: Maximal recombination under a general interpretation. Each line represents a DNA sequence. Crosses represents active
sites with variable length ﬁxed regions in between. Crosses with diﬀerent background patterns represent diﬀerent phenotypes
for active sites. In building a new sequence, each active site independently samples the corresponding sites in the entire selected
population.

preset ﬁtness value and its eﬀective ﬁtness value is simply its own ﬁtness over the mean ﬁtness (CROW and KIMURA
1970). Truncation selection generates correlations (i.e., linkage) between loci, hence it is epistatic (OTTO and BARTON
2001; SHNOL and KONDRASHOV 1993).

We note in passing that the term truncation selection has also been used to mean a ﬁxed step-like landscape. In
population genetics literatures, a ﬁxed step-like landscape is also called hard truncation selection, and the selection
scheme we employed is sometimes termed soft truncation selection. Due to the dynamical nature of the selection
scheme, using ﬁtness as a yardstick for the evolution is not very useful; for example, the mean ﬁtness of the population
is always φ by deﬁnition. As a consequence, we will focus on the evolution of the phenotypic distribution, i.e., the
distribution of binding energies, instead of the ﬁtness distribution.

We now turn to the discussion of recombination. Our basic approach here will be to make a substantial simpliﬁcation
of the actual situation and assume perfect recombination between all nucleotides. Namely, in building each new
sequence after selection, each nucleotide independently samples the nucleotides at the corresponding sites in the
entire selected population. Formally, this amounts to assuming that the fragmentation and reassembly process is
repeated often enough such that there is no linkage between any of the nucleotides. This is undoubtedly false in
detail for the experiments done to date, but we shall see that this approximation is quite good for describing the
result of a scenario involving the more feasible case of a ﬁnite number of crossovers. The advantage of this “maximal”
recombination is that it allows for an analytic solution of the model, as will be presented in the remainder of this
paper. Finally, we assume simple point mutation for each site. Namely, each nucleotide is independently subject to
mutation rate µ0 per generation. This process includes both beneﬁcial and deleterious mutations.

It is worth pointing out that our approach to recombination may have more general applicability than merely as an
approximation for the DNA binding problem. In many cases of DNA shuﬄing, the initial library of genes coding for an
interesting protein is chosen from closely related species so as to ensure proven functionality and suﬃcient homology
to allow recombination. Let us imagine that the majority of the nucleotides along those DNA sequences are already
optimal, and (non-synonymous) mutations of these nucleotides are lethal. Hence, we can consider these nucleotides
to be ﬁxed during the entire evolutionary process and ignore them except insofar as they provide enough homology
so that overlapping single-stranded fragments from diﬀerent DNA sequences can anneal with each other (and do not
anneal with other fragments by accident) during the self-primed PCR re-assembly step (STEMMER 1994a; 1994b) . For
the remaining active sites, we assume that they are (a) far enough from each other so that recombination happens
freely between any two; (b) they are subject to point mutations with rate µ0 per nucleotide per generation. Therefore,
each active site, along with its ﬁxed ﬂanking homologous regions (whose size or exact delineation do not matter),
constitutes a segment. To build a new sequence from recombination, a number of overlapping fragments (which when
put together cover the entire sequence) are assembled, with each fragment obtained from randomly sampling the
corresponding fragments (i.e., having the same active site) in the selected population. This idea is depicted in Fig. (2)
and is an exact realization of our maximal recombination model. Of course, one has to be careful to intersperse an
experimental selection step that will eliminate all lethal variants (due to mutation) before proceeding to an actual
selection based on useful variation. To proceed, we would then have to explicitly take into account the transformation

DNA-protein binding

Population Genetics

DNA sequence
nucleotide
binding energy

chromosome
locus
phenotypic value:matches

selection via binding to protein dynamical truncation selection

5

TABLE I: The correspondence between two languages: directed molecular evolution and population genetics.

from gene sequence to amino acid, as the selection would be on the basis of some desired activity of the protein. We
do not pursue this line of investigation any further in this work.

Finally, we can rephrase our model in terms of the standard language of population genetics. Each site can be
referred to as a locus, which can have
alleles, one favorable (match) and the rest (mismatches) equally unfavorable.
The set of all L loci form a chromosome. The recombination scheme is such that the allele of each locus of every new
chromosome is chosen by randomly sampling the alleles at the corresponding locus of all the selected chromosomes.
The ﬁtness value of each chromosome is either 1 (0), when the number of matches it has is above (below) the threshold
m0. For clarity, we list the correspondence in Table I.

A

In genetic algorithms and evolutionary strategies, a research area in computer science where the principles of
evolution are employed to ﬁnd optimal solutions to complex problems (BEYER 2001), a similar setting has been
investigated by M¨uhlenbein and Schlierkamp-Voosen (1993), mostly via computer simulation. Various aspects of
classical breeding have also been studied in population genetics (CROW and KIMURA 1970). Kimura and Crow
investigated the response of individual loci to selection in one round, under linkage-free condition (CROW and KIMURA
1970; KIMURA and CROW 1978). Kondrashov (1995) studied a model with a diﬀerent type of dynamical ﬁtness
landscape, where the ﬁtness value of a genotype depends only on the diﬀerence between its phenotypic value and the
mean of the phenotypic distribution, in units of variance of the phenotypic distribution. Along with the assumption
of deleterious mutations, conventional recombination, and a Gaussian distribution before selection (which, as we shall
see, is in fact equivalent to using maximal recombination), he derived evolutionary recursion relations and obtained
analytical expressions that characterize the equilibrium position. We shall make connections with these works in
appropriate places.

RESULTS

Dynamics of maximal recombination
To summarize the above discussion, in the language of population genetics which we will adopt from here on, we
have a haploid population of N chromosomes each with L loci, and we study the evolution with dynamical truncation
selection, maximal recombination and point mutation as speciﬁed above. We ﬁx the order of operation to be selection,
recombination and mutation. At each step the population size N is kept constant. This model is easily simulated
on a computer. Fig. (3) shows simulation results for evolutionary trajectories of the average and variance of the
match distribution under weak selection. For comparison, we show results from four diﬀerent evolutionary protocols:
no recombination; single random crossover; multiple crossovers and multiple parents (which is the situation closest
to experiments); and maximal recombination.
It is evident that recombination improves both the dynamics and
equilibrium state as compared to the case with no recombination. For our phenotypic landscape and selection scheme,
the more recombination the better. Furthermore, the maximal recombination scheme captures the essential eﬀect of
recombination and provides a reasonable approximation to the more readily achievable case of multiple crossovers
from multiple parents. In the alternative case of strong selection (not shown), all evolutionary protocols propel the
population to an equilibrium state very close to the optimal state; however the population reaches the equilibrium
state much faster when recombination is applied.

In our analytical work we will assume, unless speciﬁcally noted otherwise, the population size N to be very large so
that random genetic drift is negligible; we will brieﬂy discuss ﬁnite size eﬀects at the end. We focus on the evolution of
such macroscopic characteristics of the population as mean and variance, as opposed to “microscopic” properties such
as the fate of individual mutations. As already noted, the ﬁtness distribution itself does not describe the evolution.
We instead study the evolution of the phenotypic (match) distribution, focusing on its ﬁrst and second moments. For
simplicity we assume linkage equilibrium at the beginning of evolution. This is in fact not a stringent assumption,
since linkage equilibrium is achieved anyway right after one round of recombination.

150

100

m

50

0

0

Maximal recomb.
Recomb. w. multi-crossover multi-parents 
Recomb. w. one crossover 
No recomb.

40

e
c
n
a
i
r
a
V

0
250
t

500

FIG. 3: Comparison of evolutionary trajectories for four diﬀerent evolutionary protocols under weak selection. Shown are
simulation results of the evolutionary trajectory of the average number of matches m for the population, with an initial clonal
population with no matches at any chromosomes. x: no recombination; Triangle: recombination with one random crossover;
Square: recombination with multiple crossover and multiple parents, using a per bond crossover probability of 0.025. Circle:
maximal recombination. Shown in the inset are the corresponding variances of the distributions versus time, ordered in the
same way as the matches vs. generations curves. Here sequence length L = 170, selection strength φ = .9, mutation rate
µ0 = .01 and population size N = 104.

Even before going into any details of the analysis, it is not diﬃcult to understand why recombination is highly
beneﬁcial in this model. Selection, as it operates on the phenotype, which in this case is the total number of matches,
introduces linkage. After the selection step, recombination immediately restores total linkage equilibrium. resulting
into a broader distribution [see Fig. (3) inset]. A broader distribution means better response to subsequent selection
and hence faster evolution. The following analysis describes how this works in a fully quantitative way, in the maximal
recombination model.

Dynamics without mutation: We start from the simplest case where the mutation rate µ0 is set to be 0. We
assume that each locus has the same binary distribution characterized by the probability of being favorable (i.e.,
a match) p(0) (
= 0). This is in fact the case most relevant to the DNA shuﬄing experiments to date, where µ0
is kept extremely small and the diversity is almost entirely provided by the diversity which existed in the initial
library (KURTZMAN et.al. 2001). Starting from the homogeneous initial condition, we expect that every locus follows
the same evolution trajectory, as the evolution dynamics preserve permutation symmetry of diﬀerent loci. With this
in mind, we focus on the evolution of the probability p(t) for one locus to be favorable at the end of generation t.
The phenotypic probability distribution for the number of matches of a chromosome at the end of round t is then a
binomial distribution characterized by mean Lp(t). Assuming that L is large (For a more accurate treatment without
the assumption of large L, see Appendix B), the binomial distribution is well approximated by a Gaussian distribution
P (m, t) :

P (m, t) =

1
2πσ2(t)

exp

−

(cid:18)

(m

m(t))2

−
2σ2(t)

(cid:19)

m(t) = Lp(t)
σ2(t) = Lp(t) (1

p

p(t))

−

Given such a distribution at the end of generation t, we now discuss step by step the eﬀects on the distribution
due to various operations in the evolutionary protocol. In generation t + 1, selection cuts out the low m tail of the
Gaussian distribution. It is straightforward to calculate that the mean match number of the selected population ms
is

The new mean can thus be expressed as the old mean plus an improvement due to selection, which is simply the
product of the old standard deviation and a factor G(φ) that solely encodes the strength of selection. Here G(φ) is the
φ fraction
mean for the normalized distribution resulting from a standard Gaussian distribution truncated by a 1

−

m

ms = m + σG(φ).

→

6

(2)

(3)
(4)

(5)

6
X
G(φ) = 1/(φe

2/2
(2π)

1/2

), φ=(1/2)(1-Φ(x2

1/2

))

G(φ) 

3

2

1

0
0

G(φ) =

1
√2πφ

exp

1
2

−

(cid:18)

X(φ)2

,

(cid:19)

φ =

∞

X(φ)

Z

dx
√2π

exp

1
2

x2

.

(cid:19)

−

(cid:18)

mr = ms
σ2
r = mr(1

mr/L)

−

pr = p(t) +

p(t)(1

p(t))

−
√L

p

G(φ),

dp
dt

=

G(φ)
√L

p(1

p).

−

p

p(t) =

1

sin(β

1
2

−

(cid:20)

G(φ)
√L

−

t)

,

(cid:21)

FIG. 4: The selection factor G(φ). G(φ) diverges at strong selection φ

0 and goes to zero at weak selection φ

1.

→

→

0.2

0.4

0.6

0.8

1

φ

taken oﬀ the tail, namely

where X(φ) is the match threshold deﬁned through

Fig. (4) shows the behavior of G(φ). For 0.3 < φ < 1, G(φ) is approximately a linear function of φ (with slope roughly
2 ln φ−1,

1. In the strong selection limit, i.e., φ

1.5), and G(φ)

φ)−1 as φ

0, G(φ)

2 ln (1

φ)

(1

−
which diverges.

→

−

−

→

p

After selection, the recombination step restores the independence of each locus. The population distribution of

matches returns to a binomial (Gaussian) distribution characterized by mean ms.

→

→

p

Because of the independence of each locus, we can reexpress Eq. (8) in terms of individual match probability pr and
p(t):

pr). Eq. (10) has two features: First, the scaled combination of
and the variance of the distribution is simply Lpr(1
G(φ)/√L is the single control parameter. Second, the change of p is proportional to the square root of the variance,
instead of the variance itself as in the case of a ﬁxed landscape (CROW and KIMURA 1970). This results in a slower
evolution for populations that are in the middle of the landscape, but results in a speed-up near the p = 0 and p = 1
absorbing states.

−

In the case of weak selection, Eq. (10) can be approximated by its continuous-time version:

The evolutionary dynamics is governed by two ﬁxed points: p = 0 and p = 1. p = 0 is a trivial unstable ﬁxed point.
When p(0) > 0, the population moves toward p = 1 with following time dependence,

where β = sin−1(1
2p0). Eq. (11) and its solution have also been derived in M¨uhlenbein and Schlierkamp-
Voosen (1993). From this we see that the system actually reaches the optimal state in a ﬁnite time T , rather

−

7

(6)

(7)

(8)
(9)

(10)

(11)

(12)

that approaching exponentially. This is due to the square-root behavior of the velocity near p = 1 noted above. T is
given by

T = (

+ β)

π
2

√L
G(φ)

.

Tmax = π

√L
G(φ)

.

T = L

ln p(0)
ln φ

,

0, i.e., a random initial population
A surprising feature of this result is that T is ﬁnite even in the limit of p(0)
that has an arbitrarily small chance of having matches in its chromosomes. Hence, the maximum amount of time
Tmax the population needs to converge to the optimum is

→

To appreciate this result and the beneﬁt of recombination, it is helpful to compare it with that of pure enrichment
(i.e., selection only), given the same initial condition. Starting from p(0), the population distribution initially is a
binomial distribution. Selection keeps chopping oﬀ the low tail of this distribution round by round, and stops when
the distribution contains only the perfect state with L matches. Note that since here we care about the extreme tail
of the distribution, the Gaussian approximation is no longer adequate. Based on this scenario, the evolution time
T is determined by the overall fraction of the population remaining after T rounds, φT , which must be the fraction
starting out in the perfect state, p(0)L. Therefore,

which diverges when p(0)
0. This divergence can be understood as a result of the initial distribution becoming both
closer to 0 and narrower in width as p(0)
0. This behavior is dramatically diﬀerent from that for the recombination
case shown in Eq. (14). Comparing Eq. (15) with Eq. (13), we see another signiﬁcant diﬀerence. The evolution time
scales diﬀerently with L in the two cases; as √L in the case of recombination and as L in the case of enrichment.
This means that the longer the chromosome, the greater the beneﬁt of recombination.

→

→

We have shown that recombination provides a signiﬁcant improvement when p(0) is very small. In general, it can
be seen by comparing Eq. (15) with Eq. (13) that under the conditions when the evolution takes a longer time [i.e, the
worse the initial condition, the weaker the selection strength (larger φ) or the longer the chromosome], recombination
is highly beneﬁcial. Under the opposite conditions, recombination is usually still not worse. There are cases where
recombination does not confer any beneﬁt, for example if the selection strength is so strong that the selected population
all belongs to the optimal state. However, when p(0) is very close to one, recombination actually takes longer, since
T vanishes linearly in 1
p(0) with. We shall encounter a
similar phenomenon when we discuss the equilibrium state. The reason for this is that recombination repopulates
all the states, whereas pure enrichment does not. Since for p(0) very close to 1, the best state is the most highly
populated, recombination can only hurt. Again we must note in passing that in the case of very strong selection, the
results from our continuum treatment deviate from those of the actual discrete process.

p(0) without recombination, and as a square-root,

p

−

−

1

Dynamics with homogeneous initial condition: So far, we have studied the dynamics of maximal recombi-
nation in the absence of mutation. Now we insert the point mutation process into the evolutionary dynamics. As a
ﬁrst step, we again assume a homogeneous initial condition such that each locus has the same probability of being
favorable (i.e., a match) p(0)(
= 0). Mutation is the ﬁnal step of the round. Since we only consider single base
mutations, linkage is not introduced in the process. The mutation process we consider here includes both forward
and back mutations; by itself, it drives the chromosomes toward the maximum entropy point L/
in terms
of p), which is in general opposite to the direction of selection. A simple calculation yields

(or 1/

A

A

pm = pr +

(1

1

− A

pr)

µ0

A −

Combining this equation with Eq. (10), we obtain a recursion relation for the evolution of p:

p(t + 1) = p(t) +

(1

1

− A

p(t)) +

p(t) (1

p(t)),

−

G(φ)
√L

p

1. It is clear that the
where we have dropped a correction factor (1 + µ0A
A −
second term on the right hand side of the recursion relation is due to mutation, and the third term to selection and
recombination. When the third term dominates the second term, the dynamics is essentially the same as that with
no mutation as discussed above. When p > 1/

, the mutational contribution becomes harmful to the evolution.

1)) in the last term, since µ0 ≪

/(

µ0

A −

A

8

(13)

(14)

(15)

(16)

(17)

6
9

(18)

(19)

1

1

p

0.5

φ=0.1, µ=0.001, L=170
φ=0.9, µ=0.00011, L=170
φ=0.5, µ=0.000375, L=250
Theory

0.5

0
0

50

150

200

0
0

100
t

0.02

0.01
µ
0 t

FIG. 5: Comparison of simulation results and theory. The evolutionary trajectories of three simulations with totally diﬀerent
parameters [but same scaling variable G(φ)/(µ0√L)] collapse into a single curve when time is properly rescaled, and this curve
agrees well with the theoretical result obtained from Eq. (17). Here the three simulations all start from a homogeneous initial
condition of p(0) = 0.1 and population size N = 104.

The recursion relation Eq. (17) has an interesting feature. If we divide Eq. (17) by µ0 on both side, we have

p(t + 1)
µ0

−

p(t)

=

1

A −

(1

1

− A

p(t)) +

p(t) (1

p(t)).

−

G(φ)
µ0√L

p

Eq. (18) says that the scaled combination G(φ)/(µ0√L) is the single control parameter (as opposed to G(φ)/√L in the
case of no mutation). In other words, if diﬀerent choices of parameters result in the same combination G(φ)/(µ0√L),
the corresponding dynamics are exactly the same as long as the time scale in each case is rescaled by its respective
mutation rate µ0. Note that in Eq. (17) or Eq. (18), p(t) can go above 1 when selection is strong; this unrealistic result
comes from the Gaussian approximation to the population distribution that becomes inaccurate when the population
reaches the neighborhood of the optimal state. We will further address the error due to the Gaussian approximation
in our discussion of the equilibrium state.

As a test of our theory, Fig. (5) shows that the theoretical predictions, including the scaling with G(φ)/(µ0√L), agree
extremely well with simulation data. This indicates that the ﬁnite-population eﬀect in this landscape is insigniﬁcant,
and the Gaussian approximation to the binomial distribution is appropriate for sequences of long length L.

When selection is weak so that the change in p in each round is small, the evolution equation (17) can again be

accurately approximated by its continuous time version,

dp
dt′ = (1

− A

p) + C

p(1

p),

−

p

where t′
Appendix A.

≡

(µ0/(

A −

1)) t and C

(
A −

≡

1)G(φ)/(µ0√L). The explicit solution of this equation can be found in

An explicit analytical comparison of the evolutionary performance between the evolutionary protocol with and
without recombination is not available. Both recombination and mutation can serve to generate diversity, but the
greater beneﬁt of recombination is due to that facts that (a) recombination breaks up the linkage introduced by
selection much more eﬀectively than mutation does; breaking of linkage helps broaden the distribution (as selection
narrows the distribution) and in turn facilitates more eﬃcient future selection, hence speeding up the evolution, and
(b) recombination keeps the mean of the population unchanged, whereas mutation goes against selection (once the
population goes beyond the maximum entropy point). Therefore, as has been recognized for a long time, recombination
is able to generate variety without the excessive baggage of deleterious mutations.

Dynamics with inhomogeneous initial condition: In the previous discussion, we assumed a simple homoge-
neous initial condition. An immediate question concerns what happens with a inhomogeneous initial condition, i.e.

10

(20)

(21)

0.8

0.6

p

0.4

0.2

0
0

Mean Evol.:Mixed Initi. in max recomb

A=4, L=170, N=10000, φ=0.9, ν

0=.01, I1=0.1, I2=0.6

Simulation: p1(0)=0.6
Theory: p1(0)=0.6
Simulation: p2(0)=0.1
Theory: p2(0)=0.1

100

200

t

300

FIG. 6: Evolution of individual match probability p with inhomogeneous initial condition. The initial condition is chosen so
that half of the loci have initial match probability of p1(0) = .1, while the remaining half has p2(0) = .6. The two simulation
curves track the two diﬀerent groups of loci. The solid curves are theoretical results from Eq. (20). Simulations use the following
parameters: L = 170, φ = .9, µ0 = .01 and N = 104.

would diﬀerent loci synchronize with each other after a short transient period or would they go their separate ways
and only meet at the end of the process? To answer this question, we choose a linkage-free initial condition where
half of the loci have probability p1(0) of being a match, and the other half have probability p2(0) of being a match.
Assuming again that L

1, a similar derivation to the one presented above produces

≫

p1(t + 1) = p1(t) +

p2(t + 1) = p2(t) +

µ0(1

µ0(1

p1(t))
1

p2(t))
1

+

+

G(φ)

L/2
G(φ)
p

L/2

− A
A −

− A
A −

p1(t)(1

p1(t))

−
p1(t)) + p2(t)(1

−
p2(t)(1

p2(t))

−
p1(t)) + p2(t)(1

p1(t)(1

p

p1(t)(1

−

p2(t))

p2(t))

−

−

p
Fig. (6) compares these results with a evolutionary trajectory with inhomogeneous initial conditions. It is clear
that diﬀerent locus go their own ways. If mutation is ignored, one ﬁnd that the relative changes in the individual
match probabilities are

p

p1(t + 1)
p2(t + 1)

p1(t)
p2(t)

=

p1(t)(1
p2(t)(1

p1(t))
p2(t))

,

−
−

−
−

i.e., proportional to the ratio of the variance on each locus. In other words, the selection works on variance; diﬀerent
locus with diﬀerent p experience diﬀerent selection pressures depending on their contribution to variance. This means
that in the case of inhomogeneous initial conditions, the evolution process will be dominated by whichever loci have
very small initial p(0); see Fig. (7) for an explicit demonstration of this conclusion.

Dynamics with clonal initial condition: In the above theoretical analysis we have assumed an initial condition
which already has all the favorable alleles available in the population, and mutation was relatively unimportant. In
many situations, mutations are absolutely necessary for the system to ﬁnd the optimal state. This scenario could
happen for a system prepared with a clone-like initial condition with some loci lacking the beneﬁcial alleles. In this
section we focus on this case and study the eﬀect of diﬀerent mutation rates on the evolutionary dynamics. We start
from the simplest case which is a clonal initial condition with no beneﬁcial allele at any locus (i.e., p(0) = 0). For this
until the
simple case, the obviously best strategy is to subject the system to maximal mutation rate µ0 = (
system reaches p = 1/
, and then to stop mutation altogether. However, this naive strategy does not apply to other
clonal initial conditions which are inhomogeneous; here it is not a priori clear when one should turn oﬀ mutation,
since we have access only to measurements of the full phenotype.

A −

1)/

A

A

Assuming that mutation rate is ﬁxed, we can gauge the performance of diﬀerent choices of mutation rate by
measuring p after a given number of generations. Fig. (8) shows a comparison of simulations starting at p(0) = 0
with diﬀerent mutation rate using this criterion. It is clear that there is a “optimal” mutation rate. Of course, the
”optimal” mutation rate depends when evolution is terminated. In the more common situation, a majority of the loci
are already occupied by beneﬁcial alleles, and for the rest, mutation is required to create the beneﬁcial allele. In this

11

p1(0)=p2(0)=0.35
p1(0)=0.1, p2(0)=0.6
p1(0)=0.01, p2(0)=0.69

50

100

150

t

0.5

0.4

0.3

p(10)

FIG. 7: Comparison of simulation results for the average individual match probability p for diﬀerent initial conditions, in the
absence of mutation. p is the individual match probability p averaged over loci. Here L = 170, φ = .9 and N = 104.

2

4

6

8

10

t

0.2
0

0.05

0.15

0.2

0.1
µ
0

FIG. 8: Simulation results of diﬀerent mutation rates given a clone initial condition of p(0) = 0. (a) Evolutionary trajectories
for diﬀerent choices of mutation rate µ0. (b) Comparison of individual match probability at the tenth generation p(10) for
diﬀerent mutation rates. The ”optimal” mutation rate is around µ0 = .08 under this condition. Here L = 170, φ = .1 and
N = 104.

µ
µ
µ
µ
µ
µ

0=0.001
0=0.005
0=0.01
0=0.08
0=0.09
0=0.2

p

0.5

0.4

0.3

0.2

0.1

0
0

p

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3
0

0.95

0.9

p(10)

0.85

0.8

0

0.002

0.004

0.006

0.008

0.01

µ
0

FIG. 9: Simulation results for diﬀerent mutation rates given an inhomogeneous clonal initial condition. Initially, all the member
of the population have the same haplotype; 1/5 of the loci are occupied by mismatches and the rest by matches. Here L = 170,
φ = .1 and N = 5

105.

×

0
10

φ=0.6
φ=0.7
Gaussian approx.
2
Asymptotics: y=x

1-p^

-2

10

10

-4
10

-2

-1

10
µ
0L

1/2

/G(φ)

0
10

FIG. 10: Equilibrium value of individual match probability p as function of µ0√L/G(φ). The y = x2 curve denotes the
asymptotic behavior of p in strong selection (low mutation) resulting from the Gaussian approximation, Eq. (24). For simulation
results: L = 170, µ0 = .01, N = 104.

case as well, we can see the existence of an “optimal” mutation rate, as in Fig. (9).

In conclusion, mutation is necessary when there is limited diversity in the initial library. Even in this case, mutation
is only helpful in the short term dynamics, but harmful to the equilibrium state. In a realistic experiment, since
breeding usually proceeds for a only few generations there would exist an “optimal” mutation rate.

Equilibrium state of maximal recombination: Having studied the dynamical behavior of the model in the
previous sections, we now turn to the study of its equilibrium properties, focusing on the mean number of matches in
equilibrium. This quantity plays the role here that genetic load does in normal evolution problems. Strictly speaking,
genetic load is the diﬀerence in ﬁtness between the equilibrium population and the optimal ﬁtness state. In our case,
the optimal state has ﬁtness value 1, and the mean ﬁtness of the population is simply φ, so the diﬀerence is trivially
1
φ. However, since the purpose of the experiments is to maximize the phenotypic value, i.e., the number of matches,
the mean number of matches is a reasonable way to characterize the equilibrium state, and the “cost” of mutations.
Going back to the language of DNA protein binding, what we are using to characterize the equilibrium is the mean
binding aﬃnity of the DNA sequence.

−

Under the Gaussian approximation, the equilibrium value ˆp can be found by setting p(t + 1) = p(t) in Eq.( 17),

yielding

ˆp(1
ˆp
(
A

−
−

ˆp)
1)2 =

1

(
A −

1)2

 

2

µ0√L
G(φ) !

As shown in Fig. (10), for weak and intermediate selection strength this result agrees with the simulation data.
For the parameter regime of strong selection (or very small mutation rate), µ0√L/G(φ) is no longer a good scaling
variable, and the Gaussian approximation begins to deviate from the exact result.

For weak selection (i.e., (µ0√L/G(φ))2

1) the equilibrium probability is near 1/

. We have

≫

A

1)
(
A −
2
A
When selection is relatively strong, i.e., when (µ0√L/G(φ))2

A

−

=

ˆp

1

3
2

G(φ)
µ0√L

1, the equilibrium position is

≪

2

µ0√L
G(φ) !

 

1

ˆp =

−

As shown in Fig. (10), for the parameters employed there, this power law is accurate in the region of 0.1
(µ0√L/G(φ))2
discussion below). This µ0
selection scheme.

≤
1. ( A more precise statement about the lower cutoﬀ for the validity of Eq. (24) is µ0L > ln φ−1; see
2 dependence has also been derived by Kondrashov (1995) for a diﬀerent type of dynamical

≤

12

(22)

(23)

(24)

L(1

It is well know that in a ﬁxed smooth landscape, the mutational load is µ0L in the strong selection limit. We see from
the above that for our breeding problem, strong selection, at least in the Gaussian approximation, produces a load that
2 rather than the usual µ0. The reason for this scaling is easy to understand: With recombination, the
scales with µ0
change due to selection of pL, the number of matches, is proportional to the width of the distribution

p) (which is independent of the Gaussian approximation), and mutation reduces pL by

≈
µ0L. Balancing
2 law is a generic result for the
the two eﬀects we arrive at the µ0
p
genetic load when recombination is at work (which happens whenever the selected population still occupies a number
of diﬀerent states). When selection strength is suﬃciently strong that the selected population lies almost entirely in
the optimal state, recombination becomes ineﬀective as there is no diversity within the selected population. As a
result [as shown in Fig. (10)], the Gaussian result is no longer valid. In fact, as we shall show below, in this case the
usual mutational load of O(µ0) takes over.

2 scaling. This simple argument shows that the µ0

Lp(1

p

p)

−

−

−

For small mutation rates, as we shall see, the mean mismatch number is small at equilibrium, except for very weak
selection. This is in contradistinction to the dynamic case, where we focused on the case where there were a large
number (order L) of initial mismatches. There, for most of the time, the Gaussian approximation is quite adequate.
In equilibrium, however, this is generically not the case, and a more careful treatment is warranted.

To study this issue in more detail, we can make use of a more powerful approximation scheme that accurately covers
L,
0, and, before selection, the population distribution in
Lq. Call Ck0 the cumulative

both the strong selection and extremely strong selection cases so as to ﬁnd the equilibrium position. Since Lp
we shift our focus to the mismatch probability q
terms of mismatch should follow a Poisson distribution Pk =
k0. Selection results in
probability of being in a state with k

ke−Q/k!, where

Q ≡

Q

≡

−

∼

∼

p

1

≤

φ = Ck0−1 + αPk0 ,

where k0 is the threshold, which is determined by the condition that Ck0−1 < φ
selection on the members of population with k0 mismatches.
The result of selection, recombination and mutation are

≤

Ck0 . α

1 counts the partial

≤

qr =

kPk + αk0Pk0

,

!

k0−1

1
Lφ  

Xk=0
qm = qr + µ0 −

µ0qr,

A
A −

1

φ =

e− ˆQ
k0 + U

k0−1

ˆ
Q

−

Xk=0

k

k0 −
k!

k,

ˆ
Q

where qr (qm) is the individual mismatch probability right after recombination (mutation). The last term is negligible
as it arises from extremely rare compensatory beneﬁcial mutations. Combining Eqs. (25, 26, 27), we arrive at the
following equation that determines the equilibrium average mismatch number ˆ
Q

:

≡

µ0L is the genomic mutation rate. The physical ˆ
Q

where U
(φ) curve is given by the envelope of the various ˆq(φ, k0)
for diﬀerent k0’s, and is piecewise analytic. Fig. (11) shows the diﬀerence between this solution and the solution given
by the Gaussian approximation. Even though the Gaussian approximation has generally the right trend, for this
small mutation rate the Gaussian approximation is numerically oﬀ by a large percentage, except for extremely weak
selection. Also, for φ < e−U , selection only preserves the optimal state at equilibrium, recombination stops working,
and Eq. (28) produces ˆ
Lˆp = U , the conventional mutational load, which is the result that is unobtainable
Q
from the Gaussian approximation.

= L

−

Now we come back to the question of how much of an improvement is conferred by recombination. The easiest way
to approach the question is through a graph, Fig. (12), directly comparing the equilibrium state with and without
recombination, for the same value of µ0. To do this, we use the analysis for the no recombination case from Cohen
and Kessler (2003):

ln φ
U

−

=

1

2
1

1

+ A −
A −

ˆpA − r

1

A −

A −

ˆpA(1

ˆpA).

−

4

Here ˆpA denotes the equilibrium value of total number of matches divided by chromosome length L for the no-
recombination case. The ﬁrst thing to notice is that at the two extreme limits of maximal selection and no selection,
the two approaches yield the same result. The curves are nevertheless very diﬀerent. In order to understand this

13

(25)

(26)

(27)

(28)

(29)

14

(30)

(31)

(32)

6

5

4

3

2

1

L
)
p^
-
1
(

k0=0
k0=1
k0=2
k0=3
k0=4
k0=5
k0=6
k0=7
k0=8
Gaussian approx.

0
0.75

0.8

0.85

0.9

0.95

1

φ

FIG. 11: Theoretical evaluation of equilibrium value of mean mismatches: comparison of Gaussian approximation and Poisson
approximation. Curves corresponding to diﬀerent k0 values are trial solutions of Eq. (28) with diﬀerent choices of threshold
k0. The envelop of the trial solutions is the physical solution. For comparison, the solution given by Gaussian approximation
is also plotted. Here L = 170, µ0 = .001.

diﬀerence better, we ﬁrst focus on the case of intermediate selection. We re-express Eq. (24) to simplify the comparison
with Eq. (29). Using the small φ limit of G, we obtain

ln φ
U

−

=

µ0

2(1

ˆp)

−

ln φ/U , whereas with recombination, the relation involves
Without recombination, ˆp is an order 1 function of χ
µ0 as well as χ. Thus, with recombination, the only way χ can be of order 1 is if 1
ˆp is of order µ0, i.e. small.
Thus, the recombination curve remains near ˆp = 1 until φ approaches 1, at which point it takes a sharp dive. Thus,
recombination leaves the equilibrium state much less sensitive to selection, and very close to the optimal state, unless
the selection is very weak.

≡ −

−

It is also interesting to compare the two problems in the weak selection limit. The no-recombination result Eq.

(29) implies that

so that ˆpA has a square root singularity at φ = 1. On the other hand, the recombination result Eq. (23) for φ
reads

1

≈

ˆpA −

1

A

2(

=

1)

(1

φ)

A −
3/2
A

r

−
U

ˆp

−

=

1

A

1)3/2
(
A −
2
A

(1

φ)

−

2 ln(1

φ)

−

−
µ0√L
p

−

∝

so that, modulo the weak logarithmic singularity, ˆp is essentially linear at φ = 1. However, the slope is very large, of or-
der 1/√µ0U , a factor of 1/√µ0 larger than the 1/√U coeﬃcient of the square-root singularity of the no-recombination
result. Thus, we have the anomalous result that for suﬃciently weak selection, recombination actually makes the equi-
librium state worse. We can calculate the cross-over point below which recombination loses its superiority; it is given
by 1

(µ0/ ln µ0)1/2, which is small for small µ0.

φ

Finite population eﬀect: In the previous sections, we have assumed an inﬁnite population, and comparison with
simulations have shown that this approximation is appropriate most of the time. However, under the experimentally
relevant situations, where very strong selection and very low mutation rate are employed, ﬁnite population eﬀects can
show up and be potentially important. As an extreme example, if we choose the best member from the population, i.e,
N φ = 1, then recombination has nothing to work with and oﬀers no beneﬁt. In this section we discuss the population
size above which the evolutionary dynamics and equilibrium can essentially be deemed the same as those of inﬁnite
populations. To rid ourselves of the impact of initial conditions, we assume an initially diversiﬁed population. Two
population sizes are relevant for this problem, the total population size N at the beginning of each generation, and
the selected population size N φ. We will focus on the case most often encountered in in vitro evolution experiments,

15

1

0.8

p^

0.6

0.4

Without recomb.
With recomb.

0.2

0.85

0.9

0.95

1

φ

1

0.8

p

0.6

0.4

0.2

0
0

FIG. 12: Comparison of equilibrium positions for two evolutionary protocols: with recombination [From Eq. (22)] and without
recombination [From Eq. (29)].
It is clear that the beneﬁt of recombination is most signiﬁcant for intermediate selection
strength. Here L = 170 and µ0 = .001.

1

0.8

p

0.6

0.4

0.2

0
0

N=5000
N=10000
N=25000
N=50000
Infinite Population

N=5000
N=10000
N=25000
N=50000
Infinite Population

5

10

15

10

30

40

20

t

t

FIG. 13: Finite Population eﬀect on the dynamics and equilibrium of maximal recombination: Simulation results for the case
of (a)No mutation (µ0 = 0) and (b) Weak mutation (µ0 = 0.001). With mutation, two regimes exist: a) at the beginning
recombination dominates evolution, as in the mutation-free case and (b) at later stages mutations are essential, as they are
needed to ﬁnd lost favorable alleles. Here evolution is constrained by the rate for mutation to ﬁnd beneﬁcial alleles, thus slower.
Here L = 170, φ = .1. Inﬁnite population trajectories are theoretical results taken from Eq. (17).

namely N very large, but N φ is rather small. In the following analysis, we set φ constant, and compare the evolutionary
trajectory for diﬀerent population sizes N . We start again from the simplest case of no point mutation, shown in
Fig. (13a). It can be seen that in general the smaller the population size, the worse the evolutionary eﬃciency and
the equilibrium state. Under these conditions, the ﬁnite population eﬀect comes from the genetic association between
loci that results in the loss of favorable alleles from the entire population when the population is subject to selection.
We can estimate the population size N0 above which the population dynamic approaches inﬁnite-population results
by estimating the average number of lost favorable alleles at all loci in the selected population. As the individual
match probability p is lowest at the beginning of evolution, if there is any loss of favorable allele, it is most likely to
happen at the ﬁrst round of selection, hence we focus on the ﬁrst round of selection and recombination. Right after
p(1))N φ. Therefore
the ﬁrst round of selection, the probability for a speciﬁc locus to lose the favorable allele is (1
p)N φ. The opposite way of saying this is that for the
the average number of loci losing the favorable allele is L(1
p)N0φ < 1. This
population to retain favorable alleles at all loci after the ﬁrst round of selection, we require L(1
gives the following estimate of N0:

−

−

−

where p(1) = p(0) + G(φ)

p(0)(1

p(0))/L. If in the ﬁrst round the above criterion is met, then it is more unlikely

−

p

N0 =

1
φ

ln L

−
ln(1

,

p(1))

−

(33)

16

for the population to lose any favorable alleles any at successive rounds when subject to selection, as p(t) increases
p)N φ becomes increasingly smaller than 1. Comparison with simulation results shows that
in later rounds and L(1
Eq. (33) gives a reasonable estimate (at least correct in order of magnitude).

−

When a (weak) point mutation is involved, the dynamics can be separated into two regimes: (a) recombination
dominated evolution, where for loci that have a favorable allele in them, recombination helps that favorable loci to
spread to the whole population, as in the mutation-free case, and (b) mutation/recombination evolution, where loci
that have lost their favorable alleles due to selection need mutations to ﬁnd them again. The dynamics in this regime
is signiﬁcantly slower, as seen in Fig. (13b). In this case, Eq. (33) still identiﬁes the smallest population size N0 that
behaves more or less like an inﬁnite population. As a side note, the ﬂip side of the ﬁnite population issue is that there
exists an optimal selection pressure for a particular population size; an estimate of this optimal φ can be found from
the condition L(1

p)N φ < 1.

The estimate of N0 given φ (or equivalently the optimal φ0 given N ) has practical implications. It gives a population
size that is just enough for the evolution to proceed in its fastest rate (given a selection strength). Since in real-life
experiments selection routinely involves screening the population, which is costly and time-consuming, a smaller
while still equally eﬀective population size would be helpful. Of course, the above arguments assumed a random
initial library. If one starts from a population of a single clone, then as already explained above, even at the beginning
mutation is absolutely necessary to generate diversity. For this case it is more diﬃcult to directly estimate the ﬁnite
population eﬀects.

−

DISCUSSION

In this work we proposed and studied a simpliﬁed model of DNA shuﬄing, a very important evolutionary protocol for
directed evolution. We investigated this model from a population genetics’ point of view, as a multi-locus evolutionary
model incorporating both recombination and point mutation and subject to dynamical truncation selection. Our
speciﬁc recombination scheme, as an extreme limit of multi-parent multi-crossover genetic mixing employed in DNA
shuﬄing, enables us to pursue analytical results for the dynamical and equilibrium features. To summarize, we derived
the recursion relations that completely characterize the evolutionary process, which shows explicitly how recombination
helps to speed up the evolution. Assuming a large number of loci, we found that selection and mutation aﬀect the
evolutionary process only through a combination of their respective parameters. When the evolution is relatively slow
so that the discrete recursion relation can be approximated by a continuous diﬀerential equation, we could solve for the
evolutionary trajectory, and prove in special cases that it is indeed faster than that for the case of no-recombination.
We also investigated the equilibrium properties of the system, and found that the genetic load when recombination is
in eﬀect has a diﬀerent scaling form than usual, as long as the selection is not super strong. In addition, we discussed
the ﬁnite-size eﬀect under conditions relevant to the shuﬄing experiments, and estimated the minimal population size
above which the population behaves as if an inﬁnite population.

We have been focusing on a model which is directly relevant only under very speciﬁc conditions, but our results are
actually applicable to broader situations. Let us ﬁrst discuss selection:(a) For simplicity, we employed a dynamical
truncation selection. In the case of DNA sequence evolution via binding to protein, selection is “smoother” [roughly
speaking, the step corners are rounded (VON HIPPEL and BERG 1986; GERLAND and HWA 2002)]. This simpliﬁcation
does not cause any substantial diﬀerence in our analytical results as long as the binding aﬃnity is large (i.e, the step
is steep enough). (b) Our approach and results are also applicable to the type of dynamical (soft) selection studied
by Kondrashov (1995). There, the selection is implemented as a function W (X), where X = (m
m)/σ, i.e., the
phenotypic diﬀerence between the phenotype and the mean m, divided by the standard deviation σ of the phenotypic
distribution. The eﬀect of this type of selection on a population with a Gaussian distribution is

−

ms −

m = σδ,

(34)

where δ is a quantity solely characterized by the selection function W (X) and does not depend on the population
It is evident that Eq. (34) is analogous to
phenotypic distribution [See Eqs.(7) and (14) of Kondrashov (1995)].
Eq. (5) except that one needs to replace G(φ) with δ. Therefore, when one exchange G(φ) with δ, all our results
under the Gaussian approximation remain valid, including various scaling arguments and solutions to the continuous
evolutionary equations.

Now we move to recombination. One immediate question is what would change when the recombination scheme
is more realistic. A straightforward generalization of the maximal recombination toward the realistic situation is
that we can cut each DNA sequence into segments of equal length, with the maximum recombination as the extreme
case of length equal to 1. Computer simulation shows that in general the longer the segment length, the worse the
performance. For a general segment length, one can derive a hierarchy of recursion relations that relate the cumulants

17

of the population distribution at the current generation to those of previous generation, an approach that has been
applied to a multi-locus system on a ﬁxed landscapes (BARTON and TURELLI 1991; B ¨UGER 2000). How to close the
chain of recursion relations remain to be studied. The diﬃculty is associated with the remaining linkage within each
segment. In any event, the maximal recombination model can serve as a theoretical upper limit which is qualitatively
correct and even reasonably accurate quantitatively.

Our study has been guided by the in vitro evolution process, where the intensity of recombination and mutation are
both prescribed by the experimenter. This might be not be the case in a more natural setting, where the evolution of
recombination (mutation) itself can be an important aspect of the problem (e.g., FELDMAN et.al. 1996). Therefore our
model does not incorporate a modiﬁer gene that explicitly controls recombination rate. In such a modiﬁer approach,
the recombination rate can itself evolve because the modiﬁer gene is under indirect selection due to its association
with other genes on the same chromosome under direct selection (e.g., FELDMAN et.al. 1996).

Finally, we believe that our model may be relevant to some examples of natural evolution: (a) dynamical truncation
selection can also exist in nature, for example the mutual selection in a host-parasite system and (b) recombination of
multi-parents, multi-crossover type does exist in nature: certain RNA viruses have multiple segments in their genome,
and when multiple viruses infect the same host and new virus particles are made, recombination of the type we study
can happen (CHAO 1988). With the ease of analytical treatment of this model, we hope it can serve as a theoretical
testing ground where general statements about the interplay among various aspects such as recombination, mutation
and selection, can be tried out.

The acknowledgements

We would like to give special thanks to L. Chao for stimulating discussions. We also acknowledge helpful interactions
with S. P. Otto, A. Poon, W. P. C. Stemmer and J. Widom. This work has been partially funded by the NSF
sponsored Center for Theoretical Biological Physics (grants # PHY-0216576 and 0225630).

ARNOLD, F. H., 2001. Combinatorial and computational challenges for biocatalyst design. Nature, 409, 253–257.
BARLOW, M., and B. G. HALL 2002. Predicting evolutionary potential: In vitro evolution accurately reproduces natural
evolution of the TEM betalactamase. Genetics, 160, 823–832.
BARTON, N. H., and M. TURELLI, 1991. Natural and sexual selection on many loci. Genetics, 127, 229–255.
BEYER, HANS-GEORG, 2001. The Theory of Evolution Strategies. Berlin: Springer-Verlag Harper.
B ¨UGER, R., 2000. The Mathematical Theory of Selection, Recombination and Mutation. Chichester: Jon Wiley and Sons LTD.
CHAO, L., 1988. Evolution of Sex in RNA Viruses. J. theor. Biol., 133, 99–112.
COHEN, E., and D. A. KESSLER, 2003. Equilibrium state of molecular breeding. cond-mat/0301503.
CROW, J. F., and M. KIMURA, 1970. An introduction to population genetics theory. New York: Harper and Row Publishers
Inc.
FARINAS, E. T., T. BULTER, and F. H. ARNOLD, 2001. Directed enzyme evolution. Curr. Opin. Biotechnol., 12, 545–551.
FELDMAN, M. W., S. P. OTTO, and F. B. CHRISTIANSEN, 1996. Population genetic perspectives on the evolution of recombi-
nation. Annual Review of Genetics, 30, 261–295.
GERLAND, U., and T. HWA, 2002. On the selection and evolution of regulatory DNA motifs. J. Mol. Evol., 55, 386–400.
KESSLER, D. A., H. LEVINE, D. RIDGWAY, and L. TSIMRING, 1997. Evolution on a smooth landscape. J. Stat. Phys., 87,
519–544.
KIMURA, M., and J. F. CROW, 1978. Eﬀect of overall phenotypic selection on genetic change at individual loci .1. Proc. Natl.
Acad. Sci. U. S. A., 75, 6168–6171.
KONDRASHOV, A. S., 1995. Dynamics of unconditionally deleterious mutations - gaussian approximation and soft selection.
Genet. Res., 65, 113–121.
KURTZMAN, A. L., S. GOVINDARAJAN, K. VAHLE, J. T. JONES, V. HEINRICHS, and P. A. PATTEN, 2001. Advances in
directed protein evolution by recursive genetic recombination: applications to therapeutic proteins. Curr. Opin. Biotechnol.,
12, 361–370.
LODISH, H., A. BERK, S. L. ZIPURSKY, P. MATSUDAIRA, D. BALTIMORE, and J. DARNELL, 1999. Molecular Cell Biology, 4th
Ed. New York: W. H. Freeman and Co.
MOORE, G. L., and C. D. MARANAS, 2000. Modeling DNA Mutation and Recombination for Directed Evolution Experiments.
J. Theor. Biol., 205, 483–503.
M ¨UHLENBEIN, H., and D. SCHLIERKAMP-VOOSEN, 1993. The Science of Breeding and Its Application to the Breeder Genetic
Algorithm (BGA). Evolutionary Computation, 1, 335–360.
ORENCIA, M. C., J. S. YOON, J. E. NESS, W. P. C. STEMMER, and R. C. STEVENS, 2001. Predicting the emergence of
antibiotic resistance by directed evolution and structural analysis. Nat. Struct. Biol., 8, 238–242.
OTTO, S. P., and N. H. BARTON, 2001. Selection for recombination in small populations. Evolution, 55, 1921–1931.
OTTO, S. P., and T. LENORMAND, 2002. Resolving the paradox of sex and recombination. Nat. Rev. Genet., 3, 252–261.
PENG, W., U. GERLAND, T. HWA, and H. LEVINE, 2003. Dynamics of Competitive Evolution on a Smooth Landscape. To
appear in Phys. Rev. Lett.

SHNOL, E. E., and A. S. KONDRASHOV, 1993. The eﬀect of selection on the phenotypic variance. Genetics, 134, 995–996.
STEMMER, W. P. C., 1994a. Dna shuﬄing by random fragmentation and reassembly - in-vitro recombination for molecular
evolution. Proc. Natl. Acad. Sci. U. S. A., 91, 10747–10751.
STEMMER, W. P. C., 1994b. Rapid evolution of a protein in-vitro by DNA shuﬄing. Nature, 370, 389–391.
SUN, F., 1999. Modeling DNA shuﬄing. J. Comp. Biol., 6, 77–90.
THASTROM, A., P. T. LOWARY, H. R. WIDLUND, H. CAO, M. KUBISTA, and J. WIDOM, 1999. Sequence motifs and free
energies of selected natural and nonnatural nucleosome positioning DNA sequences. J. Mol. Biol., 288, 213–229.
VON HIPPEL, P. H., and O. G. BERG, 1986. On the speciﬁcity of DNA-protein interactions. Proc. Natl. Acad. Sci. U. S. A.,
83, 1608–1612.

APPENDIX A: EXPLICIT SOLUTION OF THE EVOLUTION EQUATION

Assuming that at t = 0 the individual match probability is p(0), the explicit solution for the continuous version of
Eq. (18)(which is a good approximation when change of p in between consecutive rounds is small, i.e., when selection
is not very strong) is

dp
dt′ = (1

− A

p) + C

p(1

p),

−

p

1)G(φ)/(µ0√L). For most parameter ranges the righthand side is positive,

where t′
(µ0/(
therefore p keeps increasing.

A −

≡

1))t and C

(
A −

≡

The general solution of Eq. (A1) is:

A

2 + C2
2

t′ =

ln

A
2

−

1

p + C

− A
p(0) + C

p(1

−
p
p(0)(1

p)

(cid:12)
p(0))
(cid:12)
(cid:12)

−

1

(cid:12)
(cid:12)
(cid:12)
− A

+

C(1

/2)

− A
√∆

(cid:12)
(cid:12)
(1
(cid:12)
(1

−

−

2

2

p

(cid:12)
(cid:12)
(cid:12)

p
tan−1

r

ln

× 


C

−

 

p)/p + C

−
p)/p + C + √∆ −

(cid:12)
(cid:12)
(1
(cid:12)
(1

−

−

p
√∆
(cid:12)
(cid:12)
(cid:12)
1

s

ln

2

p

(cid:12)
(cid:12)
(cid:12)
p(0)
−
p(0) !

p

,

1

p
−
p −

tan−1

2

p(0))/p(0) + C

p(0))/p(0) + C + √∆ 

−

√∆
(cid:12)
(cid:12)
(cid:12)



C2

where ∆
). In the absence of mutation the above equation has been solved, the solution a sinusoidal
function (see Eq. (12). The other extreme situation is when selection strength φ is 1, which leads to G(φ) = 0 and
C = 0. In this case p goes to 1/

exponentially with time constant

− A

ln(1

4(1

1))

1).

≡

−

µ0/(

µ0/(

A

−

− A

A −

≈ A

A −

APPENDIX B: ARBITRARY CHROMOSOME LENGTH L

In the discussion of the evolutionary dynamics and equilibrium state, we make use of a Gaussian (and a Poisson
distribution ) to approximate a binomial distribution, which are valid when L
In fact, one can relax this
condition and work directly with binomial distribution, with the help of special function Ix(a, b), the incomplete Beta
function. Ix(a, b) is deﬁned as

≫

1.

where B(a, b) is the complete beta function.

Suppose the probability density for a binomial distribution is

The cumulative probability density is then

Ix(a, b) =

1
B(a, b)

x

0
Z

dtta−1(1

t)b−1,

−

Pp(m, L)

Cm

L pm(1

p)L−m.

≡

−

L

i=m
X

Pp(i, L) = Ip(m, L + 1

m)

−

18

(A1)

(A2)

(B1)

(B2)

(B3)

1

0.8

p

0.6

0.4

0.2

0
0

L=10, A=4, I=.1, mu=.001, S=.9

Infinite pop.: binomial
Infinite pop: Gaussian 
Simulation

10

20

40

50

60

30
t

FIG. 14: Comparison of two theoretical approaches with simulation result. Solid curve is the result of Eq. (B6). Dashed curve
is the result of Eq. (17). Here L = 10, φ = .9 and µ0 = .001. In simulation N = 104.

We have, at the selection,

φ = αPp(m0, L) +

Pp(i, L),

L

i=m0+1
X

where again m0 is the threshold and the state with m0 matches maybe partially selected.

The new individual match probability after selection and recombination is

Lpr =

1
φ  

αm0Pp(m0, L) +

iPm(i, L)

!

L

i=m0+1
X

Incorporating the mutational process and making use of Eq. (B4), we arrive at

pt+1 =

1

−

+

A
A−1 µ0
Lφ

µ0

1

A −

where we made use of the following identity

(m0φ + LptIpt (m0, L

m0)

m0Ipt (km0 + 1, L

m0)) ,

(B6)

−

−

−

L

i=m0+1
X

iPp(i, L) = LpIp(m0, L

m0).

−

The dynamics and equilibrium properties follow from Eq. (B6). Fig. (14) shows that, when chromosome length L

is not long, indeed this approach agrees much better with simulation than Gaussian approximation.

19

(B4)

(B5)

(B7)

