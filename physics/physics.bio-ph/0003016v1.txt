0
0
0
2

 
r
a

M
7

 

 
 
]
h
p
-
o
i
b

.
s
c
i
s
y
h
p
[
 
 

1
v
6
1
0
3
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

On the genealogy of a population of biparental individuals

Bernard Derrida∗, Susanna C. Manrubia†, and Dami´an H. Zanette‡

∗ Laboratoire de Physique Statistique de l’ ´Ecole Normale Sup´erieure

24 rue Lhomond, F-75231 Paris 05 Cedex, France
† Fritz-Haber-Institut der Max-Planck-Gesellschaft

Faradayweg 4-6, 14195 Berlin, Germany

‡ Consejo Nacional de Investigaciones Cient´ıﬁcas y T´ecnicas

Centro At´omico Bariloche e Instituto Balseiro
8400 S.C. de Bariloche, R´ıo Negro, Argentina

(February 2, 2008)

SUMMARY

If one goes backward in time, the number of ancestors of an individual doubles at each generation. This exponential
growth very quickly exceeds the population size, when this size is ﬁnite. As a consequence, the ancestors of a given
individual cannot be all diﬀerent and most remote ancestors are repeated many times in any genealogical tree. The
statistical properties of these repetitions in genealogical trees of individuals for a panmictic closed population of
constant size N can be calculated. We show that the distribution of the repetitions of ancestors reaches a stationary
shape after a small number Gc ∝ log N of generations in the past, that only about 80% of the ancestral population
belongs to the tree (due to coalescence of branches), and that two trees for individuals in the same population become
identical after Gc generations have elapsed. Our analysis is easy to extend to the case of exponentially growing
population.

I. INTRODUCTION

In the case of sexual reproduction, the ancestry of an individual is formed by 2 parents, 4 grandparents two
generations ago, and in general 2G individuals G generations back into the past. The explosive growth of the number
of ancestors belonging to the genealogical tree of, say, a present human should stop at some point due, at least, to
the ﬁnite size of previous populations. For instance, only G ≃ 33 generations ago (spanning a period of less than
thousand years), the number of potential ancestors in the tree of any of us is about 8.5 × 109, more than the present
population of the Earth, and of course much larger than the population living about year 1000. The answer to this
apparent paradox is simple: The branches of a typical genealogical tree often coalesce, indicating that many of the
ancestors were in fact relatives and appear repeatedly in the tree (Ohno, 1996; Derrida et al., 1999; Gouyon, 1999). It
might be diﬃcult to test the statistical properties of such repetitions for an actual large, randomly mating population.
Nevertheless, some exceptions can be found in royal genealogy. Since nobles usually married within their own castes,
the presence of repeated ancestors in royal genealogical trees is far from rare. The example of the English king Edward
III, where some ancestors appear up to six times, has been analysed in our previous work (Derrida et al., 1999).1

Much attention has been paid in the past to a related problem, namely the statistical properties of branching
processes (Harris, 1963) and its applications to the characteristics of the successive descendants of a single ancestor
(Kingman, 1993). Actually, ﬁrst applications of the branchig processes technique go back to the twenties. J.B.S.
Haldane (Haldane, 1927) calculated the probability that a mutant allele be ﬁxed in a population through a method
developed previously by R.A. Fisher (Fisher, 1922). There, the relevant quantity was the survival probability of the
descendants of the ﬁrst individual carrying the mutation. All these studies apply to the vertical transmission of names,
to the inheritance of characters coming only from one of the parents, like mithochondrial DNA or the Y chromosome,
or to the fate of a mutant gene, for example, and correspond to an eﬀective monoparental population. The heart of
our problem is to take into consideration that reproduction is biparental. The distribution of repetitions of ancestors
described below does however satisfy an equation similar to those which appear in branching processes (Harris, 1963).
Our problem of repetitions of ancestors in genealogical trees is much closer to the counting of the descendants
of an individual in a sexual population. For example, in the case of a population of constant size, the average
number of oﬀspring is two per couple. Therefore after G generations each individual has on average 2G descendants.

1We used the tree of Edward III which can be found at http://uts.cc.utexas.edu/∼churchh/edw3chrt.html.

1

What prevents the number of descendants from growing exponentially with G and to exceed the population size is
interbreeding: When 2G becomes comparable to the population size, interbreeding happens between the descendants
and diﬀerent lines of descent coalesce. The problem of the statistical properties of these coalescences is very similar
to our present study of genealogical trees. None of them has –to our knowledge– yet been analysed.

In the present work, we study theoretically the problem of repetitions in the genealogical trees in the case of a closed,
panmictic population. The study of the properties of a single tree with coalescent branches and the comparison of
the genealogical trees of two contemporary individuals allows us to show that

1. There is a ﬁnite fraction (about 20% for a population of constant size N ) of the initial population whose
descendants becomes extinct after a number of generations Gc ∝ log N . All the rest of the initial population
(about 80%) belongs to all genealogical trees,

2. The distribution of the repetitions of ancestors living more than G generations ago reaches a stationary shape

after about Gc generations,

3. The genealogical trees of two individuals in the same population become identical after a small number of

generations Gc back into the past,

4. The similarity between two genealogical trees changes from 1% (almost all ancestors in the two trees are diﬀerent)
to 99% (the repetitions of the ancestors in the two trees are almost identical) within 14 generations around Gc,
independently of the population size N .

Our work can be generalized (see section IV) to describe coalescent processes, understood as the study of the
gene tree originated when looking for the ancestry of a random sample of sequences (Kingman, 1982; Hudson, 1991;
Donnelly & Tavar´e, 1995). In the absence of recombination, each sequence has a single ancestor. The topology of thus
reconstructed trees is equivalent to that generated through branching processes. Next in complexity, one can consider
a two-loci sequence and assume that recombination can occur only between the two loci and with a small probability
(meaning correlated genealogies2 for the two loci). The statistical properties of such process can be estimated until
the most recent common ancestor (MRCA) is reached (Hudson, 1991). Instead, if one faces the study of a chromosome
(Wiuf & Hein, 1997; Derrida & Jung-Muller, 1999) or of the whole genome, the number of ancestors grows as one
proceeds back in time, since each individual has two parents and, apart from coalescence, also recombination (meaning
splitting of the branches in the tree) is frequent.

If one considers a population or a sample of individuals within a population, there are relevant diﬀerences between
the genealogy of a single gene and the genealogy of a chromosome or of the whole genome (which we study here).
While in the ﬁrst case, in fact, there exists a MRCA for the sample (where the gene tree ends), the genealogical
tree of a chromosome or of the genome with two parents proceeds backwards in time and never reduces to a single
ancestor. The genealogical tree representing the pedigree of a diploid organism contains a large fraction of the ancestral
population. In this case, one may then talk about the most recent common set of ancestors, and study the similarities
among diﬀerent individuals now within the same population.

II. STATISTICAL PROPERTIES OF AN INDIVIDUAL TREE

Here we consider a simple neutral model of a closed population evolving under sexual reproduction and with non-
overlapping generations.3 If the population size is N (G) at generation G in the past, we form couples at random
(by randomly choosing N (G)/2 pairs of individuals) and assign each couple a random number k of descendants. The
probability pk of the number k of oﬀspring is given and if the population size is N at present, its size N (G) at
generation G in the past is given by

2In this paper, we use the term genealogy to refer to the ancestry of a single gene or of a whole set of sequences. In all cases,
the genealogy is the complete set of ancestors contributing to the present object, this object being an individual (as in section
II), a group of individuals (as in section III), a sequence (section IV), or a single locus (as quoted here). In this case, correlated
genealogies simply means that the diﬀerent sets of ancestors for the two-loci are not independent.
3The Wright-Fisher model for allele frequencies works in the same set of hypothesis (Wright, 1931; Fisher, 1930). More
recently, Serva and Peliti (Serva & Peliti, 1991) obtained a number of statistical results for the genetic distance between
individuals in a sexual population evolving in the absence of natural selection.

2

where the factor m is obtained from

N (G) =(cid:18) 2

m(cid:19)G

N

k pk .

m =Xk

(1)

(2)

For m = 2, the population size remains constant in time, whereas for m 6= 2 the number of individuals in the next
generation is multiplied by a factor m/2. After a number of generations, the tree of each of the individuals in the
youngest generation is reconstructed. To quantify the contribution of each of the ancestors to the genealogical tree of
an individual, we deﬁne the weight w(α)
γ (G) of an ancestor γ in the tree of individual α at generation G in the past as

w(α)

γ (G + 1) =

1
2

Xγ ′ children of γ

w(α)

γ ′ (G)

(3)

We take w(α)

γ (0) = δα,γ, as this ensures that at generation G = 0 all the weight is carried by the individual α itself. The
γ (G) = 1, for any past generation G. The weight

factor 1/2 in (3) keeps the sum of the weights normalizedPN (G)

w(α)
γ (G) can be thought of as the probability of reaching ancestor γ if one climbs up the reconstructed genealogical
tree of individual α by choosing at each generation one of the two parents at random. The weights essentially measure
the repetitions (see ﬁgure 1) in the genealogical tree. Without repetitions, w(α)
γ (G) would simply be 2−G for each
ancestor γ in the tree.

γ=1 w(α)

As an illustration of the previous quantities, we represent in Fig. 1 the result of random matings inside a small
closed population of constant size N = 14 (thus m = 2) during 7 generations. The lines link progenitors with their
oﬀspring. The grey scale gives the weight wγ(G) of each of the individuals in the tree. The numbers on the left, all
of them of the form r/2G, give the weight of the leftmost individual in each generation. The denominators simply
indicate the potential maximum number of ancestors at each generation. As counted by the numerator, each of them
would appear repeated r times in this tree if all the branches were explicitly shown.

We further assume that the probability pk of having k children per couple follows a Poisson distribution, pk =
mke−m/k! (most of what follows could be easily extended to other choices of pk). We represent in Fig. 2 the
probability for an English couple to have k marrying sons during the period 1350-1986 (Dewdney, 1986). The solid
line corresponds to a Poisson distribution with average 1.15 (i.e., the average number of oﬀspring per individual in
that period, which corresponds to m = 2.3 in our analysis), and implies that the total population is growing. These
data spanning six centuries and taken over an homogeneous population support the hypothesis that the number of
oﬀspring is indeed Poisson distributed.4

If we deﬁne S(α)(G), the fraction of the population (at a generation G in the past) which does not belong to the

genealogical tree of individual α, (i.e. such that w(α)

γ (G) = 0) one can show (see the appendix) that

S(α)(G + 1) = exph−m + m S(α)(G)i .

(4)

This recursion, together with the initial condition S(α)(0) = 1 − 1/N , determines this quantity for any G (Derrida et
al., 1999).

For large G and for any individual α, this fraction S(α)(G) converges to the ﬁxed point S(∞) of (4). This gives
for m = 2 (i.e. for a population of constant size) a fraction S(∞) ≃ 0.2031878.. which becomes extinct, so that the
remaining fraction 1 − S(∞) ≃ 80% of the population belongs to the genealogical tree of any individual α. A similar
calculation shows that this 80% of the population which is not extinct after a large number of generations appears
in the genealogical trees of all individuals: If S(α,β)(G) is the fraction of the population which does not belong to
any of the two trees of two distinct individuals α and β, S(α,β)(G) satisﬁes the same recursion (4) as S(α)(G), and
converges to the same ﬁxed value S(∞). Thus, within this neutral model, an individual either becomes extinct (with
a probability of 20%) or becomes an ancestor of the whole population after a large number of generations (with a
probability of 80%). For an exponentially growing population with m = 2.3 as in ﬁgure 2, the results are the same
except for the precise value of S(∞) (for m = 2.3, one ﬁnds S(∞) ≃ 14%).

4Nonetheless, deviations from this distribution induced by a social transmission of the reproductive behaviour have been
reported (Austerlitz & Heyer, 1998).

3

When G is large enough, as shown in the appendix, the whole distribution P (w) of the weights w(α)

γ (G) reaches a
stationary shape, the properties of which can be calculated (Derrida et al., 1999). We show in Fig. 3 the distribution
P (w/hwi) for diﬀerent values of m. As can be seen, it has a power-law dependence, P (w) ∝ wξ for small values of
the ratio w/hwi, with an exponent given by

ξ = −

log S(∞)

log m

− 2 ,

(5)

and achieves a maximum value for w/hwi ≃ 1.

III. SIMILARITY BETWEEN TWO TREES

We would like to know how similar are the genealogical trees of two contemporary individuals and how they evolve
in time within the same population. We have seen that a large fraction 1 − S(∞) ≃ 80% of the ancestral population
constitutes the pedigree of every present individual. As a next step, one can compare two individuals and compute
the degree of similarity between their trees, that is, the set of ancestors appearing at each generation in both trees
simultaneously. We will see in particular that the two trees become identical after a number Gc of generations.

We start with the deﬁnition of the overlap between the genealogical trees of two diﬀerent individuals, α and β. Let
γ (G) be the weight of the ancestor γ in the tree of α at generation G in the past, and similarly let w(β)
γ (G) be
γ (0) = δγ,α
γ (0) = δγ,β at generation G = 0. In order to quantify the similarity between the two trees, we introduce the

w(α)
the weight of the same ancestor γ at generation G for β. These weights evolve according to (3) with w(α)
and w(β)
quantities

and

X (α)(G) =

N (G)

Xγ=1 hw(α)

γ (G)i2

Y (α,β)(G) =

N (G)

Xγ=1

w(α)

γ (G) w(β)

γ (G) .

Y (α,β)(G) measures the correlation between the two trees at generation G in the past and X (α)(G) acts as a normal-
ization factor. We then deﬁne the overlap q(α,β)(G) between the two trees at that generation by

q(α,β)(G) =

Y (α,β)(G)

(cid:2)X (α)(G) X (β)(G)(cid:3)1/2

This overlap is a measure of the (cosine of the) angle between the two N −dimensional vectors w(α)
γ (G).5
When q(α,β)(G) ≃ 0, the two vectors are essentially orthogonal and the ancestors of α and β are all diﬀerent. On the
other hand, when q(α,β)(G) ≃ 1, the vectors are almost identical (as for brothers).

γ (G) and w(β)

For a large enough population, the ﬂuctuations of X (α)(G) and Y (α,β)(G) are small around the population averaged
values hX(G)i and hY (G)i for almost all choices of α and β. Of course, if α and β are brothers, Y (α,β)(G) = X (α)(G),
a value very diﬀerent from its average hY (G)i; it is however very unlikely to get brothers, sisters or even cousins if
one picks up two individuals at random from a large population.

The averages hX(G)i and hY (G)i can be calculated from the evolution of the weights (3). Initially, X(0) = 1 and
Y (0) = 0 since the individuals α and β in any pair are diﬀerent. Using the fact that for large N the ﬂuctuations of

5Similar quantities have been proposed as an indicator of the amount of evolutionary divergence between populations (Kimura,
1983). The quantity analogous to our weight w(α)
in the population genetics approach is the frequency of the sampled alleles,
the number of ancestors γ corresponds to the number of genes (that is the dimension of the space in which the vector w(α)
is
embedded), and our individuals α and β correspond to the compared populations (Cavalli-Sforza & Conterio, 1960).

γ

γ

4

X (α)(G) and Y (α,β)(G) are small, the expected value of the overlap q(G) between two randomly chosen individuals
is given by

where

q(G) ≃

hY (G)i
hX(G)i

=

1

1 + mGc−G

Gc =

log((m − 1)N )

log m

− 1 .

(6)

(7)

This expression is derived in the appendix. Of course Eq (6) is only valid with probability one with respect to the
random choice of α and β and with respect to the dynamics. We see that for large N , the overlap q(G) is essentially
zero for a number of generations of order Gc ≃ log N/ log m and then within a number of generations ∆G which does
not depend on N , it becomes equal to unity. Fig. 4 displays the averaged overlap q(G) as a function of the number
of generations G for diﬀerent values of N . We have chosen m = 2 so that the population remains constant in size.
We see that changing N does not change the G dependence except for a translation of the curve. In particular the
range ∆G on which the overlap changes from 1% to 99% does not depend on N . It is easy to check from (6) that for
m = 2, the overlap should satisfy

q(G + 1) =

2q(G)

1 + q(G)

(8)

(plain line in the insert). The ﬁxed point q(G) = 0 is unstable for this map. All the trajectories ﬁnally converge to the
stable ﬁxed point q(G) = 1 for large G. Also the quantity ∆G can be estimated by counting how many generations
are required for the overlap to change from 1 % to 99 % and this gives from (6)

∆G ≃ log(104)/ log m,

that is ∆G ≃ 14 for m = 2 and ∆G ≃ 11 for m = 2.3 as in ﬁgure 2. Typical values of Gc are Gc ≃ 20 for a population
of constant size N = 106. For a population increasing with m = 2.3 as in ﬁgure 2, one gets Gc = 21 if the size in the
last generation is N = N (0) = 75 millions.

The previous analysis can be easily extended to the hypothetical case of having an arbitrary number p of parents
instead of 2. As is shown in the appendix, the statistical properties of genealogical trees in a population of constant
size but arbitrary p are the same as for a population with only two parents and an expanding or shrinking size
according to Eq. (1). The described statistical properties are thus equivalent in (i) a system with sexual reproduction
and a growth rate m = p and (ii) a system with constant population size but a number m of genders.

The existence of a generation Gc around which the genealogical similarity among individuals changes from 0 to 1
and which grows logarithmically with the size of the population is one of our main results. This has to be compared
with the number of generations required for the population to become genetically homogeneous (Donnelly & Tavar´e,
1991; Harpending et al., 1998), which grows proportionally to N . The diﬀerence is that when Gc ≪ G ≪ N , all the
overlaps are 1, i.e all the genealogical trees in the population have the same ancestors with the same weights, but
the genomes are still very diﬀerent: This is just an extension of the situation of brothers who have exactly the same
genealogical tree but diﬀerent genomes.

IV. SIMPLE MODEL FOR THE CONTRIBUTION OF THE ANCESTORS TO THE GENOME

The evolution of a set of sequences subject to coalescence and recombination was ﬁrst described by Hudson (1983).
In this case, evolution proceeds until the most recent common ancestor for each set of homologous sites has been
found. The set of MRCA sites does not necessarily belong to the genome of a single ancestor, on the contrary, it is
in general spread on a ﬁnite fraction of the original population (Wiuf & Hein, 1997; 1999). In this section, we focus
our attention on the statistical properties of the ancestry of a single extant genome. In particular, we calculate the
equilibrium distribution for the fraction of material contributed by each ancestor.

Consider the whole set of genes that a present diploid organism has inherited from its parents. Although both parents
contributed 50% each, it is no longer true that grandparents contributed 25% each, since independent assortment
of chromosomes plus crossing over mixed in each of the parental gametes the material inherited from the previous
generation. As a rough approximation to the output of genetic recombination, one might consider that each sequence

5

is obtained as the addition of a fraction f of the genetic material of one parent and a fraction 1 − f of the genetic
material of the other parent with f ∈ (0, 1). This would be true if the length L of the sequence was long enough (or
inﬁnitely long), so that there would be no restriction on the number of times it could be divided, and if one could forget
the linear structure of the sequence. The process of coalescence and recombination (for small N ) is schematically
represented in Fig. 5.

We can now repeat the analysis done previously to the present extension. We will discard the correlations between
the values of f coming from a couple. This is equivalent to our assumption that ﬁxing the pairs for k oﬀspring or
choosing the parents of each individual at random only has eﬀects of order O(N −1) (see the appendix), and we can
therefore work in the simplest realization of the process. Hence, we assume that the fraction f takes independent
values for each parent. The recursive equations (3) for the weights become

w(α)

γ (G + 1) = Xγ ′ children of γ

fγ ′ w(α)

γ ′ (G) ,

(9)

where the weight w(α)
γ (G) means now the fraction of the genetic material of individual α inherited from ancestor γ at
generation G. The random fraction f is chosen anew for each oﬀspring from a distribution ρ(f ) (with average value
hf i = 1/2). This implies that now even brothers would have diﬀerent weights for their ancestors, and hence brings us
slightly closer to the real genetic process.

Following the procedure described in the appendix, one can calculate the fraction S of ancestors without lines of
descent in the present (as we also show in Sec. II) and the exponent ξ for the distribution P (w). In general, given
the distribution ρ(f ) for the contributions of the parents, we get

S(∞) = emS(∞)−m

1 = S(∞) m2+ξ hf i1+ξ Z f −ξ−1ρ(f )df .

(10)

(11)

as one can easily show from (9) that the generating function hG(λ) deﬁned by hG(λ) = hexp[λw(G)/hw(G)i]i has a
limit h∞(λ) for large G which satisﬁes

h∞(λ) = exp(cid:20)−m + mZ ρ(f )df h(cid:18) λf

mhf i(cid:19)(cid:21)

Fig. 6 summarizes the changes in the distribution P (w) for diﬀerent distributions ρ(f ) of the random variable f .
We have considered a simple case of a population of constant size (i.e. m = 2) and with ρ(f ) = 1/(2δ) uniform in the
interval (1/2 − δ, 1/2 + δ). In this particular case, an implicit relation between δ and the exponent ξ can be obtained,

δξ = S"(cid:18) 1

2

− δ(cid:19)−ξ

−(cid:18) 1

2

+ δ(cid:19)−ξ# .

(12)

As δ varies, P (w) remains a power law at small w (i.e. P (w) ∝ wξ), and the exponent ξ monotonously decreases
with δ. In particular, for δ ≃ 0.35, ξ changes sign: The maximum of P (w) moves discontinuously from w/hwi ≃ 1 to
w/hwi ≃ 0. The exponents obtained through simulations of the process are represented in Fig. 7 together with the
numerical solution of Eq. (12), showing a good agreement.

V. DISCUSSION

We have analysed the statistical properties of genealogical trees generated inside a closed sexual population. We
focused our interest on the distribution of the repetitions of ancestors in the trees and on the amount of genetic
material contributing to an extant genome. The precise values of ξ, S(∞), Gc and ∆G depend only weakly on the
details of the model and do not change qualitatively if for instance a non Poissonian distribution of oﬀspring is used.
Moreover, we have shown how our results can be extended to the hypothetical case of having an arbitrary number p
of parents: Indeed, this case proves to be equivalent to a biparental population with a growth rate m/2 = p/2.

The problem analysed here presents a number of connections to other ﬁelds. Equations similar to (3) appear also
in the distribution of constraints in granular media where the variables w represent the force acting on each grain and

6

the recursion (3) expresses the way in which constraints are transmitted from one layer to the next (Coppersmith et
al., 1996). In this case, p 6= 2 and even ﬂuctuating p would be perfectly realistic. The fact that the overlap changes
from 0 to 1 within a small number of generations ∆G independent of the size of the population and after Gc ≃ log N
generations is also very reminiscent of the sharp cutoﬀ phenomenon characteristic of some natural mixing processes
modelled by Markov chains. One example of such systems is the shuﬄing of cards, where the stationary state in
which the system has lost almost all information about the initial ordering of the n cards is reached through a sharp
cutoﬀ after about log n riﬄe shuﬄes (Diaconis, 1996).

It is clear that the study of the interplay between the weights calculated in our generalized model and the structure
of the genome would require more sophisticated approaches (Derrida & Jung-Muller, 1999; Wiuf & Hein, 1997;
1999). We have discarded the correlations between the history of neighboring sites in a sequence and assumed the
independence of the factors f . Actually, the closer in the sequence two positions are, the more correlated are their
genealogical histories (Kaplan & Hudson, 1985). This fact constrains the possible breaking points for our simulated
sequences, implying that the random factors f in (9) are a crude approximation to reality.

Since we have faced the problem from a statistical perspective, our results represent the average, typical behaviour,
and are only valid with probability one when the population size is large. We did not study ﬂuctuations due to the
ﬁnite size of the population. Nonetheless, we hope that our results contribute to a better understanding of the role
of genealogy in the degree of diversity of ﬁnite-size interbreeding populations.

APPENDIX

In this appendix we have regrouped the technical aspects of the derivations of the main equations (4,5,6,10,11)

presented in the body of the paper.

One may consider several variants of the model which all give a Poisson distribution for the number of oﬀspring
when the size of the population is large. For instance, the population size could be strictly multiplied by a factor m/2
at each generation or it could ﬂuctuate (if we take the number of oﬀspring from the Poisson distribution). One might
decide that each individual has two parents chosen at random in the previous generation or form ﬁxed couples and
assign each couple some children. All these variants do not change the results when the population size is large, but
might aﬀect some ﬁnite size corrections that we compute in this appendix.

We will choose the following version of the model, which makes the calculation of the ﬁnite size corrections not too
diﬃcult. Our population has a given size N (G) at each generation G in the past, and we will assume that all the
N (G) are very large, at least in the range of generations G that we will consider. Now, to construct the ancestors of
all the N (G) individuals at generation G in the past, we choose for each of them a pair of parents at random among
the N (G + 1) individuals at the previous generation (to facilitate the calculation, we do not even exclude that the two
parents might be equal). Within this model, the number k of children of an individual at generation G + 1 is random
and can be written as

k =

2N (G)

Xi=1

zi

where zi = 1 with probability 1/N (G + 1) and zi = 0 otherwise. It follows that the whole distribution of k can be
calculated. The probability pk that an individual at generation (G + 1) has exactly k children is given by the binomial
distribution

pk =

(2N (G))!

k! (2N (G) − k)!(cid:18)

1

N (G + 1)(cid:19)k(cid:18)1 −

1

N (G + 1)(cid:19)2N (G)−k

.

(13)

In particular,

hki =

2N (G)

N (G + 1)

hk(k − 1)i =

2N (G)[2N (G) − 1]

N (G + 1)2

hk(k − 1)(k − 2)i =

2N (G)[2N (G) − 1][2N (G) − 2]

N (G + 1)3

.

(14)

If the population size is multiplied by a factor m/2 at each generation, i.e. if N (G) = N (G + 1) m/2 (as G counts
the number of generations in the past), one recovers from (13) the Poisson distribution pk = mke−m/k! for large
N (G).

7

A. Calculation of the density of individuals without long term descendants and derivation of (4)

To establish (4), one simply needs to notice that for an individual to have no descendants after G + 1 generations,
all his children should have no descendants after G generations. Let M (G) be the number of individuals with no
descendants at generation G in the past. Given M (G), one can write M (G + 1) as

M (G + 1) =

N (G+1)

yγ

Xγ=1

where yγ = 1 if all the children of γ are among the M (G) and yγ = 0 otherwise. It can be shown that

and

for γ 6= γ ′. This gives

hyγi =(cid:18)1 −

1

N (G + 1)(cid:19)2N (G)−2M(G)

hyγyγ ′i =(cid:18)1 −

2

N (G + 1)(cid:19)2N (G)−2M(G)

hM (G + 1)i = N (G + 1)(cid:18)1 −

1

N (G + 1)(cid:19)2N (G)−2M(G)

hM 2(G + 1)i = hM (G + 1)i + N (G + 1)[N (G + 1) − 1](cid:18)1 −

2

N (G + 1)(cid:19)2N (G)−2M(G)

(15)

(16)

When all the M ’s and N ’s are large, we see from (15,16) that the ﬂuctuations of M (G + 1) are small (as hM 2(G +
1)i − hM (G + 1)i2 ≪ hM (G + 1)i2), and one ﬁnds from (15) that the ratio M (G)/N (G) ≡ S(α)(G) satisﬁes

which is identical to (4) for N (G) = N (G + 1)m/2.

S(α)(G + 1) = exp(cid:20) 2N (G)

N (G + 1)

(S(α)(G) − 1)(cid:21)

B. Time evolution of the distribution of the weights

From the recursion (3) and from the known distribution (13) of k one can write recursions for the moments of the

weights

hw(α)

γ (G + 1)i =

hki
2
γ (G + 1)]2i =

h[w(α)

hw(α)

γ (G)i

hki
4

h[w(α)

γ (G)]2i +

hk(k − 1)i

4

hw(α)

γ (G)w(α)

γ ′ (G)i ,

(17)

(18)

where γ 6= γ ′. The normalization Pγ w(α)

γ = 1 allows one to rewrite

hw(α)

γ (G)w(α)

γ ′ (G)i =

1

N (G) − 1hhw(α)

γ (G)i − h[w(α)

γ (G)]2ii

and together with the known moments (14) gives that

8

hw(α)

γ (G + 1)i =

N (G)

N (G + 1)

hw(α)

γ (G)i =

1

N (G + 1)

h[w(α)

γ (G + 1)]2i =(cid:20) N (G)

2N (G + 1)
2N (G) − 1

−

N (G) [2N (G) − 1]

2 N (G + 1)2 [N (G) − 1](cid:21) h[w(α)

γ (G)]2i

+

2 N (G + 1)2 [N (G) − 1]

(19)

(20)

where γ 6= γ ′.

For large N (G), if the ratio N (G + 1)/N (G) = 2/m, as in the case of a population increasing by a factor m/2 at

each new generation, expression (20) becomes simpler and one gets

h[w(α)

γ (G + 1)]2i =

m
4

h[w(α)

γ (G)]2i +

m2

4 (cid:18) 1

N (G)(cid:19)2

(21)

In this limit, we have from (14) that hki = m and hk(k − 1)i = m2, and we see that (21) means that in (17) the
weights w(α)
γ ′ are, for large N (G), uncorrelated. The calculation of higher moments of the weights can be
done in the same manner and for large N (G) the weights of diﬀerent ancestors become again uncorrelated.

and w(α)

γ

If the population size changes in time, the distribution of the weights cannot be stationary. This is already visible
in the expression (17) which shows that even the ﬁrst moment of the weights changes with G. One can however check
from (17) and (21) that the ratio h[w(α)

γ (G)i2 which satisﬁes

γ (G)]2i/hw(α)

h[w(α)
hw(α)

γ (G + 1)]2i
γ (G + 1)i2

=

1
m

h[w(α)
hw(α)

γ (G)]2i
γ (G)i2

+ 1

(22)

has a limit m/(m − 1) as G increases. Moreover, as the initial value of this ratio is N (0), the number of generations
Gc to converge to this limit is Gc ∼ log N (0)/ log m. Higher moments of the weights behave in a similar way and one
can write recursions for ratios which generalize (22) and which show that all the ratios have limits.

This indicates that the distribution of the ratio w/hwi becomes stationary. In the limit of large N (G) (considering
that the weights of the diﬀerent children γ ′ in (3) can be taken as independent and that the distribution of k becomes
Poissonian), one ﬁnds that the generating function hG(λ) deﬁned by

hG(λ) =*exp"λ

satisﬁes

w(α)

γ (G)

hw(G)i #+

hG+1(λ) =Xk

pk(cid:20)hG(cid:18) λhw(G)i

2hw(G + 1)i(cid:19)(cid:21)k

= exp [−m + m hG(λ/m)] .

(23)

(24)

Recursion (24) generalizes to the case m 6= 2 (i.e. the case of an exponentially increasing population) the result of our
previous work obtained for a population of constant size (m = 2). Similar recursions have been studied in the theory
of branching processes (Harris, 1963). The use of generating functions in population genetics is well illustrated in the
book by Gale (1990), where this method is for example applied to the calculation of the probability of ﬁxation of a
mutant allele.

It is remarkable, that if one considers an imaginary world where each individual would have p parents (instead of 2),
the generating function (23), in the case of a population of constant size, would satisfy the recursion (24) with m = p.
This means that as long as the distribution of weights is concerned, the problem of a large population of constant
size with m parents per individual is identical to the problem of a population of size increasing at each generation by
a factor m/2 with two parents per individual.

For large G, if we ﬁx the ratio N (G)/N (G + 1) = m/2, the generating function hG(λ) converges to h∞(λ) solution

of

C. Stationary distribution

9

h∞(λ) = exp [−m + m h∞(λ/m)]

(25)

If one expands the solution around λ = 0, one ﬁnds that

h∞(λ) = 1 + λ +

1
2

m

m − 1

λ2 +

1
6

m2(m + 2)

(m2 − 1)(m − 1)

λ3 + . . .

and the comparison with (23) gives for large G

hw2i
hwi2 →

m

m − 1

;

hw3i
hwi3 →

m2(m + 2)

(m2 − 1)(m − 1)

;

which means that in principle the whole shape of P (w) can be extracted from (25). In particular, one can predict the
power law of P (w) at small w. Trying to solve (25) for large negative λ, if one writes

h∞(λ) − S(∞) ≃

1

|λ|ξ+1

(26)

one ﬁnds, as expected, that S(∞) is the ﬁxed point of (4). Eq. (26) is equivalent to the asumption that P (w) ∼ wξ

at small w, where the exponent ξ should satisfy

1 = S(∞)mξ+2 .

This completes the derivation of (5) which was already discussed in our previous work (Derrida et al., 1999).

D. Overlap between two trees

Let us now show how (6) can be derived. Starting from recursion (3), one obtains by averaging over all the links

relating generation G to generation G + 1

hw(α)

γ (G + 1)w(β)

γ (G + 1)i =

hki
4

hw(α)

γ (G)w(β)

γ (G)i +

hk(k − 1)i

4

hw(α)

γ (G)w(β)

γ ′ (G)i ,

where γ 6= γ ′ and the averages over k are carried out with respect to (13). This gives

hw(α)

γ (G + 1)w(β)

γ (G + 1)i =

m
4

hw(α)

γ (G)w(β)

γ (G)i +

1

4(cid:18)m2 −

m

N (G + 1)(cid:19) hw(α)

γ (G)w(β)

γ ′ (G)i .

(27)

(28)

Using the fact that the sum Pγ ′ w(β)

γ ′ (G) = 1, so that hw(α)

γ (G)i = 1/N (G) at all generations, one gets that

hw(α)

γ (G + 1)w(β)

γ (G + 1)i =

hw(α)

m
4

γ (G)w(β)

γ (G)i
N (G) − hw(α)

1

+

1

4(cid:18)m2 −

m

N (G + 1)(cid:19)

γ (G)w(β)

γ (G)i

N (G) − 1

.

(29)

Keeping only the dominant contributions for large N ’s we arrive at

hw(α)

γ (G + 1)w(β)

γ (G + 1)i =

m
4

hw(α)

γ (G)w(β)

γ (G)i +

m2
4

1

N (G)2 .

Comparing this expression with (27), one sees that for large N , one could have simply neglected the correlations
between the weights of diﬀerent individuals, (i.e. directly replaced hw(α)
γ ′ (G)i) and
used the Poisson distribution instead of (13)). The previous recursion can be integrated

γ ′ (G)i by hw(α)

γ (G)i hw(β)

γ (G)w(β)

hw(α)

γ (G)w(β)

γ (G)i =hhw(α)

γ (0)w(β)

γ (0)i +

1
N 2

m

m − 1

4 (cid:17)G
(mG − 1)i(cid:16) m

,

(30)

10

γ (G)w(β)
and using the fact that hw(α)
ﬁnds (with X(0) = 1 and Y (0) = 0)

γ (G)i is equal to Y (G)/N (G) when α 6= β and to X(G)/N (G) when α = β, one

hY (G)i
hX(G)i

=

(mG − 1)m−Gc

1 + (mG − 1)m−Gc

where Gc is given by (7). For large N , that is for large Gc this reduces to (6) in the whole range where the expression
departs from 0 or 1, that is for G of order Gc. Finally, one can check that with the value of Gc given by (7), N (G) is
always large, as long as N is large, so that our assumption that all the N ’s were large was legitimate.

ACKNOWLEDGEMENTS. The authors acknowledge discussions with Jordi Bascompte, Ugo Bastolla and Julio
Rozas. SCM thanks the Alexander von Humboldt Foundation for support.

[1] Austerlitz, F. & Heyer, E. (1998) Social transmission of reproductive behavior increases frequency of inherited disorders

in a young-expanding population. Proc. Natl. Acad. Sci. USA 95, 15140-15144.

[2] Cavalli-Sforza, L.L. & Conterio, F. (1960) Analisi della ﬂutturazione di frequenze geniche nella populazione della

Val Parma. Atti Assoc. Genet. Ital. 5, 333-344.

[3] Coppersmith, S.N., Liu, C.-h., Majumdar, S.N., Narayan, O., & Witten, T.A. (1996) Model for force ﬂuctuations

in bead packs. Phys. Rev. E 53, 4673-4685.

[4] Derrida, B. & Jung-Muller, B. (1999) The genealogical tree of a chromosome. J. Stat. Phys. 94, 277-298.
[5] Derrida, B., Manrubia, S.C. & Zanette, D.H. (1999) Statistical properties of genealogical trees. Phys. Rev. Lett. 82,

1987-1990.

[6] Dewdney, A.K. (1986) Computer recreations: Branching phylogenies of the Paleozoic and the fortunes of English family

names. Scientiﬁc American 254, 12-16.

[7] Diaconis, P. (1996) The cutoﬀ phenomenon in ﬁnite Markov chains. Proc. Natl. Acad. Sci. USA 93, 1659-1664.
[8] Donnelly, P. & Tavar´e, S. (1995) Coalescents and genealogical structure under neutrality. Annu. Rev. Genet. 29,

401-421.

[9] Fisher, R.A. (1922) On the dominance ratio. Proc. Roy. Soc. Edin. 42, 321-341.

[10] Fisher, R.A. (1930) The genetical theory of natural selection. Oxford: Clarendon (1958, 2nd edn. New York: Dover).
[11] Gale, J.S. (1990) Theoretical population genetics. Unwin Hyman Ltd, London.
[12] Gouyon, P.H. (1999) Darwin et Mendel ou du vertige qui saisit l’´evolutionniste qui tente de remonter dans l’arbre. To

appear in the Magazine Litt´eraire.

[13] Haldane, J.B.S. (1927) A mathematical theory of natural and artiﬁcial selection. Part V: Selection and Mutation. Proc.

Camb. Phil. Soc. 26, 838-844.

[14] Harpending H.C., Batzer, M.A., Gurven, M., Jorde, L.B, Rogers, A.R., & Sherry, S.T. (1998) Genetic traces

of ancient demography. Proc. Natl. Acad. Sci. USA 95, 1961-1967.

[15] Harris, T.E. (1963) The theory of branching processes. Springer-Verlag OHG.
[16] Hudson, R.R. (1983) Properties of the neutral allele model with intergenic recombination. Theor. Popul. Biol. 28, 183-201.
[17] Hudson, R.R. (1991) Gene genealogies and the coalescent process. Oxford Surveys in Evolutionary Biology 7, 1-44. D.

Futuyma and J. Antonovics, Oxford University Press.

[18] Kaplan, N. & Hudson, R.R. (1985) Statistical properties of the number of recombination events in the history of a

sample of DNA sequences. Genetics 111, 147-164.

[19] Kimura, M. (1983) The neutral theory of molecular evolution. Cambridge University Press, Cambridge.
[20] Kingman, J.F.C. (1982) The coalescent. Stochast. Proc. Appl. 13, 235-248.
[21] Kingman, J.F.C. (1993) Poisson Processes. Oxford Studies in Probability 3, Oxford University Press.
[22] Ohno, S. (1996) The Malthusian parameter of ascents: What prevents the exponential increase of one’s ancestors? Proc.

Natl. Acad. Sci. USA 93, 15276-15278.

[23] Serva, M. & Peliti, L. (1991) A statistical model of an evolving population with sexual reproduction. J. Phys. A: Math.

Gen 24, L705-L709.

[24] Wiuf, C. & Hein, J. (1997) On the number of ancestors to a DNA sequence. Genetics 147, 1459-1468.
[25] Wiuf, C. & Hein, J. (1999) The ancestry of a sample of sequences subject to recombination. Genetics 151, 1217-1228.
[26] Wright, S. (1931) Evolution in Mendelian populations. Genetics 16, 97-159.

11

w

26/128

11/64

5/32

3/16

1/8

1/4

1/2

1

t

G

7

6

5

4

3

2

1

0

FIG. 1. Coalescence of branches in a genealogical tree. We display the reconstructed ancestry of a present individual in a
small population of constant size N = 14. Numbers on the left side stand for the weight w of the leftmost individual at each
generation. The grey scale changes from light grey (small w) to dark grey (large w) proportionally to the logarithm of the
weight. The exact values are calculated according to Eq. (2). The weight is a measure proportional to the number of times
that an ancestor appears in a tree, or, equivalently, to the number of branches which have coalesced up to that point.

100

y
t
i
l
i
b
a
b
o
r
P

10−1

10−2

10−3

0.0

2.0

4.0

Number of males

6.0

FIG. 2. Probability for an English couple to have k marrying sons during the period 1350-1986 (open circles). The solid line

corresponds to a Poisson distribution of average 1.15. (Data from Dewdney (1986)).

12

100

10−1

10−2

10−3

10−4

)

>
w
<
w
(
P

/

m=1.5
m=2
m=3
m=4

10−5

10−4

10−3

10−2

10−1

100

101

w/<w>

FIG. 3. Stationary shape of the distribution P (w/hwi) for diﬀerent values of m. We compare the constant population case
(m = 2) with shrinking (m = 1.5), and expanding (m = 3, 4) populations. Parameters are N = 4096, G = 20, and averages
over 103 independent realizations have been performed.

)

G
(
q

1

0.8

0.6

0.4

0.2

0

0

1

)
1
+
G
(
q

0.5

0

0

0.5
q(G)

1

10

20

30

40

50

G

FIG. 4. The averaged overlap q(G) as a function of the number of generations G. The results of simulations for diﬀerent
sizes of the population N = 100 (open circles), 1000 (solid squares), 10000 (open diamonds), 100000 (solid triangles) agree with
this prediction, up to small ﬁnite size corrections only visible for N = 100. The insert shows the results of simulations and the
prediction (8).

13

>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>

>>>
>>>
>>>
>>>

AAA
AAA
AAA
AAA
AAA
AAA
AAA
AAA

AAA
AAA
AAA
AAA
AAA
AAA
AAA
AAA

CCC
CCC
CCC
CCC

+++
+++
+++
+++
+++
+++
+++
+++

333
333
333
333

333
333
333
333

(((
(((
(((
(((

(((
(((
(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((
(((
(((

(((
(((
(((
(((

(((
(((
(((
(((
(((
(((
(((
(((

"""
"""
"""
"""

"""
"""
"""
"""
"""
"""
"""
"""

,,,
,,,
,,,
,,,
,,,
,,,
,,,
,,,

"""
"""
"""
"""
"""
"""
"""
"""

AAA
>>>
AAA
>>>
AAA
>>>

+++
+++
+++

+++
+++
+++

CCC
CCC
CCC

(((
(((
(((
(((
(((
(((

333
333
333

>>>
AAA
AAA
>>>
AAA
AAA
>>>
AAA
AAA

,,,
,,,
,,,

"""
,,,
"""
,,,
"""
,,,

"""
"""
"""

(((
333
(((
333
(((
333

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

(((
(((
(((

"""
"""
"""

"""
"""
"""
"""
"""
"""

AAA
>>>
AAA
>>>
AAA
>>>

AAA
>>>
AAA
>>>
AAA
>>>

CCC
+++
CCC
+++
CCC
+++

+++
+++
+++

333
333
333

(((
(((
(((
(((
(((
(((

>>>
AAA
>>>
AAA
>>>
AAA

AAA
AAA
AAA

"""
"""
"""
"""
"""
"""

"""
>>>
"""
>>>
"""
>>>

AAA
AAA
AAA

,,,
,,,
,,,

"""
,,,
"""
,,,
"""
,,,

333
"""
333
"""
333
"""

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

AAA
>>>
AAA
>>>
AAA
>>>

CCC
+++
CCC
+++
CCC
+++

+++
333
+++
333
+++
333

(((
(((
(((
(((
(((
(((

>>>
AAA
>>>
AAA
>>>
AAA

AAA
AAA
AAA

"""
"""
"""

"""
"""
"""

"""
>>>
"""
>>>
"""
>>>

AAA
,,,
AAA
,,,
AAA
,,,

"""
,,,
"""
,,,
"""
,,,

333
"""
333
"""
333
"""

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

1−f

f

>>>
>>>
>>>

AAA
AAA
AAA

CCC
+++
CCC
+++
CCC
+++

+++
333
+++
333
+++
333

(((
(((
(((
(((
(((
(((

>>>
AAA
>>>
AAA
>>>
AAA

AAA
AAA
AAA

"""
"""
"""
"""
"""
"""

"""
"""
"""

AAA
>>>
AAA
>>>
AAA
>>>

,,,
,,,
,,,
,,,
,,,
,,,

"""
"""
"""
"""
"""
"""

(((
333
(((
333
(((
333

(((
(((
(((
(((
(((
(((

(((
(((
(((
(((
(((
(((

(((
(((
(((

G

4

3

2

1

0

FIG. 5. Representation of the ﬁrst 5 generations of the tree in Fig. 1 with a random distribution of the weight of an individual
between its two parents. The fraction f of the weight contributed by each ancestor is randomly chosen from a distribution
with average value hf i = 1/2.

101

100

10−1

10−2

10−3

10−4

)

>
w
<
w
(
P

/

δ=0.5
δ=0.35
δ=0.2
δ=0.05

10−5

10−4

10−3

10−2

10−1
w/<w>

100

101

102

FIG. 6. Stationary distribution of weights P (w/hwi) versus w/hwi for several choices of δ. The ﬁxed population size is

N = 4096, and we have averaged over 103 independent runs. Values of δ are as shown in the legend.

14

0.4

0.2

ξ

0.0

−0.2

−0.4

0.0

0.1

0.2

δ

0.3

0.4

0.5

FIG. 7. Comparison between the predicted values of the exponent ξ (solid line) given by (12) and the results of the simulations
for diﬀerent values of δ (circles). Parameters as in Fig. 6. For a value of δ ≃ 0.35, the exponent ξ changes sign. This point is
important since the typical contribution of a randomly chosen ancestor changes suddenly in a ﬁnite amount.

15

