5
0
0
2
 
r
p
A
 
2
1
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
1
8
0
4
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Quantiﬁcation of the diﬀerences between quenched and annealed averaging for RNA
secondary structures

Tsunglin Liu and Ralf Bundschuh
Department of Physics, Ohio State University, 191 W Woodruﬀ Av., Columbus OH 43210-1117

The analytical study of disordered system is usually diﬃcult due to the necessity to perform a
quenched average over the disorder. Thus, one may resort to the easier annealed ensemble as an
approximation to the quenched system. In the study of RNA secondary structures, we explicitly
quantify the deviation of this approximation from the quenched ensemble by looking at the correla-
tions between neighboring bases. This quantiﬁed deviation then allows us to propose a constrained
annealed ensemble which predicts physical quantities much closer to the results of the quenched
ensemble without becoming technically intractable.

PACS numbers: 87.14.Gg, 87.15.v, 05.70.Fh

I.

INTRODUCTION

Heteropolymer folding is of crucial signiﬁcance in
It is the basis for the mechanism
molecular biology.
with which cells can produce three dimensional build-
ing blocks out of the one-dimensional information stored
in their genome. Cells achieve this by forming (still one-
dimensional) polymers (proteins and RNA) by stringing
together diﬀerent monomers with covalent bonds. All
monomers share a compatible backbone but they have
diﬀerent side chains and occur in a predeﬁned order
along the sequence. Physical interactions between these
monomers force the polymer to stably fold into a three
dimensional structure. This structure is crucial for the
function of the molecule; it is determined by the speciﬁc
sequence of the polymer [1, 2, 3, 4].

In addition to its biological relevance, heteropolymer
folding is also a very interesting problem of statistical
mechanics [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]. The
competition between the conﬁgurational entropy of the
polymer, the overall tendency of the monomers to stick to
each other, the sequence disorder, and the preference of
folding toward a biologically active native state, leads to a
very rich thermodynamic phase diagram. While the same
qualitative behavior is expected for proteins and RNA,
we will here concentrate on RNA since RNA folding is
more amenable to analytical and numerical approaches
than protein folding. The relative simplicity of the RNA
folding problem compared to the protein folding problem
does not stem from the fact that RNA consists of only
four diﬀerent bases versus the twenty amino acids the
proteins are composed of, but it comes from the simpler
interaction rules: The dominant interaction between the
four bases A, U, G, and C of an RNA molecule is Watson-
Crick (G–C and A–U) pair formation, i.e., if two bases
have formed a pair they to ﬁrst order do not take part in
any further interactions. Every amino acid of a protein
on the contrary interacts with all its spatial neighbors,
i.e., with on the order of ten other amino acids at a time.
From a statistical physics point of view, the possibility
of a glass phase at low temperatures driven by sequence
disorder, is of special interest in the heteropolymer fold-

ing problem [6, 7, 8, 9, 10, 11, 12]. Unfortunately, even
for the case of RNA folding an analytic quantitative de-
scription of the glass phase is still outstanding. Thus,
quantitative studies have to either rely on numerics or
they have to use what is known as the annealed average.
In the annealed average, the free energy of the system is
approximated as the logarithm of the ensemble averaged
partition function (instead of taking the ensemble aver-
age over the logarithm of the partition function called
the quenched average). Physically, this approximation
corresponds to treating the sequence degrees of freedom
as dynamical instead of frozen variables. Thus, the an-
nealed system represents a sequence ensemble that is cou-
pled to the structural ensemble by way of the interaction
energies. This sequence ensemble may be diﬀerent from
the original sequence ensemble of uncorrelated random
sequences over which the free energy is supposed to be
averaged. Due to these diﬀerences between the annealed
and the quenched sequence ensemble the annealed free
energy is only an approximation to the true (quenched)
free energy of a disordered system.

The purpose of this manuscript is to ﬁrst quantify the
diﬀerences between the annealed and the quenched se-
quence ensembles. Speciﬁcally, we will look at correlation
between neighboring bases. We show that while this cor-
relation is strictly zero in the correct (quenched) sequence
ensemble, they are non-zero in the annealed sequence en-
semble and increase with decreasing temperature - up to
complete correlation in certain models of RNA folding.
This clearly underlines and quantiﬁes the fundamental
shortcomings of the annealed average in the RNA fold-
ing problem at low temperatures.

Based on the quantiﬁed non-zero nearest neighbor cor-
relations, we then try to diminish the diﬀerences be-
tween the annealed and quenched ensembles by forcing
the annealed ensemble to present zero neighboring cor-
relation. This constrained annealed ensemble behaves
much more similar to the quenched ensemble than the
annealed ensemble. Although the glass phase itself can
not be identiﬁed using the constrained annealed ensem-
ble which only partially corrects the overall non-random
correlations, one can obtain thermodynamic quantities

which are much closer to the quenched results than the
annealed ones using this method.

This paper is organized as follows: In Sec. II, we brieﬂy
review the RNA secondary structure and introduce the
general RNA folding problem with sequence disorder. In
Sec. III, we quantify the deviation of nearest neighbor
correlations of the annealed ensemble. Finally, we im-
prove the pure annealed ensemble by applying a con-
straint of random correlations in Sec. IV.

II. RNA FOLDING PROBLEM WITH
SEQUENCE DISORDER

A. RNA secondary structures

RNA is a single-stranded biopolymer of four diﬀerent
bases A, U, C, and G. The strand can fold back onto itself
and form helices consisting of stacks of stable Watson-
Crick pairs (A with U or G with C). This comparatively
simple interaction scheme makes the RNA folding prob-
lem very amenable to theoretical approaches without los-
ing the overall ﬂavor of the general biopolymer folding
problem [5].

An RNA secondary structure S is characterized by its
set of Watson-Crick base pairs (i, j) where i and j denote
the ith and jth base of the RNA polymer respectively
(conventionally i < j). Here, we follow many previous
studies [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] and
apply the reasonable approximation to exclude so-called
pseudoknots [18], i.e., for two Watson-Crick pairs (i, j)
∈
S and (k, l)
S, conﬁgurations with i < k < j < l
are not allowed. This approximation is justiﬁed, because
short pseudoknots do not contribute much to the overall
energy and long pseudoknots are kinetically diﬃcult to
form.

∈

B. Quenched averaging

The properties of RNA folding, especially the possibil-
ity of a glass phase driven by the sequence disorder, have
been a challenging problem from the statistical physics
points of view. To understand the statistics of this dis-
ordered system, one ﬁrst has to assign an energy E(χ, S)
to every secondary structure S for a given sequence χ.
This could, e.g., simply be the negative of the total num-
ber of Watson-Crick base pairs. This then allows us to
calculate the partition function

Z(χ) =

(χ, S)e

−E(χ,S)/T

(1)

S ∩
X

(χ, S) is one when the
for a given sequence χ where
secondary structure S is compatible with the sequence
χ and zero otherwise. Finally, one has to calculate the
quenched average

∩

Fq =

kBT

−

ln Z(χ)
h

iχ

(2)

over all sequences χ.

2

C. Annealed averaging

Unfortunately, the quenched free energy Fq is very dif-
ﬁcult to calculate. Thus, one can try to approximate the
quenched free energy by the much easier computed an-
nealed free energy, which treats the disordered sequences
as dynamic variables. This annealed free energy is only
a lower bound of the quenched free energy,

Fa =

kBT ln

−

Z(χ)
h

iχ < Fq.

(3)

It can be quite diﬀerent from the quenched free en-
ergy since the annealed ensemble favors those sequences
where more binding pairs are allowed. More importantly,
physical quantities derived from this annealed free energy
can be very diﬀerent from their quenched counterparts as
we will show explicitly in the following sections. To be
speciﬁc, we will measure the correlation between neigh-
boring bases which are known to vanish in the quenched
case.

D. Energy models

In this paper, we study the simplest model of disor-
dered RNA sequences which contain only the two bases A
and U. In assigning free energies to secondary structures,
we neglect any loop entropies and focus on the base pairs
alone. Besides, for most parts of this manuscript, we do
not consider the minimal hairpin length constraint which
requires the two bases of a binding pair to be separated
by at least three bases in a real RNA molecule. Within
these approximations we do consider two diﬀerent energy
models.

In the binding energy model, we simply assign an en-
ergy ǫ =
1 to each AU (or UA) binding pair. We denote
the corresponding Boltzmann factor by q = e1/T . This
model captures the main features of the energetics and
is simple enough for analytical and numerical studies.

−

We also study a somewhat more realistic energy model,
namely the stacking energy model. In this model, we as-
sign energies to the stacking of two base pairs rather than
to individual base pairs. This stacking energy depends
in reality on the identities of all four bases involved. We
implement this eﬀect by associating a Boltzmann factor
s1 with stackings of types AA
AA while associating a
diﬀerent Boltzmann factor s2 with stackings of types AU
UA
and UA
AU . To be speciﬁc, we will choose these Boltzmann
factors as s1 = e2/T and s2 = e1/T for the remainder of
this communication.

UU and UU

The main reason to study the stacking energy model
is that the simple binding energy model is known to be
pathological without a glass phase at low temperature
in the disordered sequence ensemble [7, 8, 9]. A simple

reason is that whatever the sequence, each base A can al-
ways ﬁnd another base U to pair with provided we have
the same amount of bases A and U. Thus, sequences dis-
order does not cause frustration. In contrast, the energy
distribution of the stacking energy model is greatly af-
fected by sequences, and a structure in which all base
pairs are stacked can in general not be found for every
sequence. Thus, sequence disorder is expected to cause
frustration, and a glass phase is expected in this energy
model for low enough temperature.

III. NEAREST NEIGHBOR CORRELATIONS
OF THE ANNEALED ENSEMBLE

In this section, we calculate quantitatively how the
nearest neighbor correlations in the annealed ensemble
deviate from their true values in the random sequence
ensemble. To this end, we have to calculate the annealed
partition function for sequences with length N-1, which
is deﬁned as

Za(N ) =

1
2N −1

(χ, S)e

−E(χ,S)/T

(4)

.

!

S  
X

χ
X

∩

1

N

1

N−1
Σ
k=1

1

k
A
U

N
U
A

NN−1
A
U

FIG. 1: Recursive relation exploring all possible secondary
structures for a homogeneous sequence of length N. The wavy
lines stands for contribution from all possible structures and
sequences. The straight line stands for non-paired bases.

For the binding energy model, this annealed partition
function can be easily obtained via the recursive rela-
tion shown in Fig. 1 along the lines of previous stud-
ies [10, 19, 20, 21, 22] but taking the sequences into ac-
count explicitly. The idea is to separate the two cases
for the last base, which is either unbound or bound to a
certain base k, and then relate the partition function to
the shorter length one as

Za(N + 1; q) = Za(N ; q)

(5)

N −1

+

q
2

Za(k; q)Za(N

k; q).

−

Xk=1
With this relation, one can obtain an analytical formula
for the annealed partition function in the large N limit
by performing the z-transform, which is deﬁned as

Za(z; q) =

Za(N ; q)z

−N ,

(6)

c

on the recursive relation. After solving the resulting
Za(z; q), we can obtain the parti-
quadratic equation for

∞

XN =1

c

3

tion function by doing the inverse z-transform,

1
2πi

Za(N ; q) =

Za(z; q)zN −1dz.

(7)

I
This approach can be easily generalized to the stacking
energy model.

c

In order to keep track of the correlations by the an-
nealed ensemble, we assign an additional Boltzmann fac-
tor L to all AA and UU neighbors within the sequence.
The modiﬁed annealed partition function is then

Za(N ; q, L) =

1
2N −1

(χ, S)qnq (S)LnL(χ)
∩

,

!

S  
X

χ
X

(8)
where nq(S) is the number of binding pairs in a secondary
structure S, and nL(χ) is the number of conjugate neigh-
bors, i.e., AA and UU neighbors in the sequence.

The additional Boltzmann factor complicates the cal-
culation of the partition function since diﬀerent bases A
and U contribute diﬀerently. However, we can still formu-
late recursive relations by noticing that the two end bases
of a sequence piece determine the correlations with other
pieces. Thus, we can separate a sequence into two cases
where the end bases are either of the same type or not,
and formulate the recursive relation for each case inde-
pendently. The annealed partition function Za(N ; q, L)
is then obtained via z-transform as before. Since the for-
mation of the recursive relations is quite technical, we
only address the result here, and defer the details to Ap-
pendix A.

From the partition function we can obtain the near-
est neighbor correlations by looking at the deviation of
the averaged fraction of AU (or UA) neighbors from the
expected value 1/2 in the disordered sequence ensemble.
This deviation δ is obtained by taking the derivative as

δ =

1
2 −

1
N

L∂L ln(Za(N ; q, L))

|L=1.

(9)

A. Binding energy model

Fig. 2 shows the neighbor correlations for the binding
energy model. We ﬁnd that the deviation moves further
away from zero as temperature decreases. This is a di-
rect result from the fact that at low temperature, the
main contributions to the annealed partition function
come from those sequences which allow a lot of bind-
ing pairs, unlike the quenched case where sequences are
equally weighted.

The exact way that the neighbor correlations are bi-
ased can be understood as follows. In this binding energy
model, the only thing that biases the nearest neighbor
correlations is the formation of minimal hairpins since
they enforce the neighboring bases to be diﬀerent, which
are either AU or UA. Thus, the degree of bias is directly
coupled to the fraction of smallest hairpins in a sequence.

4

B. Stacking energy model

Following the same approach, we check the same devi-
ation as a function of temperature in the more realistic
stacking energy model. Again, only the result is quoted
here in Fig. 3 (interested readers can check the detailed
calculations in Appendix C).

 δ

-0.2

0.1

0

-0.1

-0.3

-0.4

-0.5

0.125

0.1

 δ

0.075

0.05

0.025

0
0

0.5

1

2

2.5

3

1.5
T

FIG. 2: Deviation of the fraction of AU (or UA) nearest neigh-
bors. The deviation is plotted as a function of temperature
in units of the binding energy for the binding energy model.
Notice that the deviation moves further away from zero and
stops at a ﬁxed constant as temperature decreases.
It also
approaches a limit larger than zero at high temperature indi-
cated by the dashed line.

This assertion can be veriﬁed by studying the fraction
of minimal hairpins. As an example, we study the zero
temperature case where all the bases are expected to be
paired. Among all possible pairing structures, we explic-
itly calculate the fraction of smallest hairpins (with the
details shown in Appendix B). As a result, every fourth
base is part of a minimal size hairpin. Thus, we have 1/4
AU (or UA) nearest neighbors from these hairpins and
3/4 = 3/8 from the rest of the bases since
another 1/2
they do not show nearest neighbor correlation bias. The
deviation of the fraction of AU (or UA) neighbors is then
1/2 = 1/8, which matches exactly
expected to be 5/8
In this case, the
the zero temperature limit in Fig. 2.
sequence, as a dynamic variable, adjusts itself to all the
binding pairs.

×

−

Even in the high temperature limit, although all al-
lowed sequences are equally weighted, there still exists a
ﬁnite fraction of minimal size hairpins on average. As a
result, the deviation of neighbor correlations approaches
a constant larger than zero.

The assertion that the deviation δ is coupled to the
formation of minimal size hairpins is again veriﬁed as we
additionally require all the hairpins being of length larger
than one. In this case, the correlation between nearest
neighbors becomes random at all temperatures. How-
ever, the second nearest neighbor correlations become
non-trivial.

This simple binding energy model gives us a taste how
the nearest neighbor correlations are coupled with the en-
ergy through the structure, i.e., the formation of minimal
hairpins. This correlation is biased since the annealed en-
semble puts more weight on lower energy sequences.

0.5

1.5

2

1

T

FIG. 3: Deviation of the fraction of AU (or UA) nearest neigh-
bors for the energy model involving stacking energies. Unlike
in the case of the binding energy model, the AU (or UA)
neighbor correlations are completely biased at zero tempera-
ture in the stacking energy model. At high temperature, this
deviation approaches the same limit as the binding energy
model.

Unlike the binding energy model, at zero temperature,
the nearest neighbor correlations of the stacking energy
model are completely biased. Almost no AU (or UA)
neighbors can be found in this annealed system. This
can be understood since at zero temperature, the only
dominating structure is a long stem in which all stack-
ing loops are of type s1. Thus, the only two important
sequences are the ones made of half consecutive A bases
and the other half of U bases.

To verify this structure, we additionally introduce an-
other Boltzmann factor h for each hairpin loop formation.
With this Boltzmann factor we can keep track of the frac-
tion of hairpins fh in the annealed system by calculating

fh =

h∂h ln(Za(N ; s1, s2, h, L = 1))

(10)

|h=1.

1
N

From Fig. 4, we do see that the fraction of hairpins of this
annealed system indeed goes to zero as temperature goes
to zero, which is a feature of the long stem structure.

At high temperature, however, the energy model does
not matter since entropy dominates. Thus, the AU (or
UA) fraction approaches the same limit as in the binding
energy model.

From this stacking energy model, we learn that the
stronger the energy is coupled to the nearest neighbor
correlations, the larger deviation in nearest neighbor cor-

annealed
constrained annealed
quenched

fh

0.1

0.2

0.15

0.05

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

T

FIG. 4: Fraction of hairpins in the stacking energy model for
three diﬀerent ensembles.

relations of the annealed system will be present at low
temperature.

IV. CONSTRAINED ANNEALING

So far we have only observed the sequence correla-
tions artiﬁcially introduced through the annealed ensem-
ble. However, our approach can in fact be used to gener-
ate more realistic ensembles within the annealed frame-
work. The idea is to force the nearest neighbor correla-
tions to be random when performing the annealed aver-
age [23, 24].

We simply enforce this random disorder constraint, i.e.,
the fraction of AU (or UA) neighbors being one half by
setting the Boltzmann factor L, which controls the near-
est neighbor correlations, to whatever value it needs to
have for the correlations of the annealed ensemble to van-
ish.

This constrained annealing turns out to predict ther-
modynamic quantities much closer to the quenched re-
sults. And it can be done immediately following our
quantiﬁed deviations in disorder.

5

One important note is that the resulting free energy
is only deﬁned up to an additive constant, i.e., adding
a constant background potential does not change the re-
sult at all. Thus, the absolute value of this constrained
annealed free energy as well as the Boltzmann factor Lc
has no real meaning. For example, one could assign the
Boltzmann factor L to AU (or UA) neighbors instead of
AA (or UU) neighbors. The resulting chemical potential
would then change a sign and the free energy would dif-
fer by a constant amount. However, the thermodynamic
quantities, which are calculated by taking derivatives of
the constrained free energy, will not see this constant and
are expected to be closer to the quenched result.

To verify this assertion, we are going to compute the
average fraction of binding pairs for the binding energy
model via q/N ∂q ln(Za(N ; q, L)) as a function of tem-
perature. Then, we compare the cases of the annealed
(L = 1), the constrained annealed (L = Lc) and the
quenched ensembles.

As to the quenched result, we numerically calculate the
partition function given random sequences of length 1280
and collect the data from 1000 random sequences. In or-
der to avoid the trivial ﬁnite size eﬀects due to ﬂuctuation
of the fraction of A bases away from its expected value
1/2, we only choose sequences that contain exactly 640
A’s and 640 U’s. The result is shown in Fig. 5. The sta-
tistical errors of the quenched results are always smaller
than the size of the corresponding symbol, such that
within the error bars the quenched results never overlap
other curves. This condition holds for all other quenched
results in this manuscript.

annealed
constrained annealed
quenched

0.48

0.46

0.44

0.42

0.4

0.38

0.36

fq

A. Binding energy model

The constraint for the binding energy model is read as

1
N

L∂L ln(Za(N ; q, L))

(11)

|L=Lc =

1
2

.

In this energy model, we expect the sequences with more
AU (or UA) nearest neighbors to be suppressed since the
annealed system favors those neighbors. As a result, Lc,
which favors AA (or UU) neighbors, is expected to be
larger than one in order to meet the constraint. Further-
more, Lc should be larger at lower temperatures since
the neighbor correlation is more biased at lower temper-
atures.

0.34

0.2

0.3

0.4

0.5

0.7

0.8

0.9

1

0.6
T

FIG. 5: Fraction of binding pairs in the binding energy
model. The constraint of random nearest neighbors brings
the annealed quantity closer to the quenched numerical esti-
mate. The statistical errors of the quenched results are always
smaller than the size of the symbol.

We see that the constrained annealed result is indeed
very close to the quenched numerical estimate. However,
all three results are rather close to each other anyway.
The reason for these three cases being so close to each
other is simply that under this energy model the system
is not glassy, and every base is able to ﬁnd another base

6

annealed
constrained annealed
2 constrained annealed
quenched

fs2

0.15

0.25

0.2

0.1

0.05

for pairing in this binding energy model. Thus, at zero
temperature, all the bases are paired in all three systems.
The fact that the nearest neighbor correlations are not bi-
ased a lot can also be veriﬁed as we ﬁnd that at T=0.1, Lc
to be just 1.59. Thus, the chemical potential introduced
from the constraint is comparatively small and does not
aﬀect the result too much.

B.

stacking energy model

The situation for the stacking energy model is very
diﬀerent from that of the binding energy model. Here,
we follow the same approach and compute the averaged
fraction of stacking loops of type AA
AU (or
UA
UA ) as a function of temperature under the constraint,

AA ) and AU

UU (or UU

1
N

L∂L ln(Za(N ; s1, s2, h = 1, L))

|L=Lc =

1
2

.

(12)

Similarly, in order to avoid the trivial ﬁnite size eﬀects
for the quenched numerical estimate, we ﬁx the number
of AA, AU, UA, UU neighbors in the randomly chosen
sequences to be 320 each [25].

annealed
constrained annealed
2 constrained annealed
quenched

fs1

0.6

0.5

0.4

0.3

0.2

0.1

0
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

T

U U (or U U

FIG. 6: Fraction of stacking loops AA
AA ) in the stack-
ing energy model. The constraint of random nearest neigh-
bors ﬁxes this quantity much better than averaged number
of pairs in the binding energy model. The phenomenolog-
ical constraint, i.e., a ﬁxed fraction of hairpins, brings this
quantity only a bit closer to the quenched result.

From Figs. 6 and 7, we see that the constrained an-
nealed results are greatly improved over the plain an-
nealed results. This veriﬁes the idea that larger devia-
tions from the random disorder result in a better cor-
rection via the constraint of the random disorder. For
this stacking energy model, at T=0.1, Lc=0.0067 is much
more diﬀerent from 1 than in the binding energy model.
From these results, we can see that the constrained
annealed ensemble of the stacking energy model behaves
in the following way. Since the ensemble is forced to
have the same number of AA (or UU) and AU (or UA)
neighbors, at zero temperature, the dominating structure

0
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

T

U A (or U A

FIG. 7: Fraction of stacking loops AU
AU ) in the stack-
ing energy model. Again, the constraint of random nearest
neighbors greatly improves the result. However, unlike the
case in Fig. 6, the constraint of a ﬁxed fraction of hairpins
also contributes in bringing the annealed quantity closer to
the quenched result.

is still a long stem structure, but with half the stacking
loops being of type s1 and the other half being s2. This
is consistent with the fact that fraction of hairpins going
to zero as temperature goes to zero for the constrained
annealed system as shown in Fig. 4 .

One diﬀerence between the quenched ensemble and the
constrained annealed ensemble is that not all the bases
of a random sequence can form stacking loops. Thus, we
have a ﬁnite fraction of hairpins in the quenched ensem-
ble (Fig. 4). This diﬀerence can used as an additional
phenomenological constraint to improve the constrained
annealed system even further.

We apply this additional phenomenological constraint
by requiring the fraction of hairpins fh to ﬁt the quenched
numerical estimates and neighboring bases to be uncor-
related at the same time, i.e., to enforce

∂L ln(Za(N ; s1, s2, h, L))|h=hc,L=Lc =

(13)

1
2

∂h ln(Za(N ; s1, s2, h, L))|h=hc,L=Lc = fh(T ),

(14)

L
N
h
N

where fh(T ) is the quenched numerical estimate in this
equation.

From Figs. 6 and 7, we see that this additional con-
straint slightly improve the fraction of stacking loops s1,
but signiﬁcantly improves the fraction of stacking loops
s2. This can be understood since the existence of hair-
pins introduces AU (or UA) neighbors, if the fraction of
AU (or UA) neighbors is also required to be one half, it
will decrease the fraction of stacking loops s2 among the
stem structures.

V. CONCLUSION

We conclude that the deviation of the annealed en-
semble from the quenched ensemble is strongly related

to the energy model and can be completely biased when
the correlation is strongly coupled to the energy of the
system. Quantifying this deviation allows us to do con-
strained annealing which brings the predictions of ther-
modynamic quantities much closer to the real values in
the quenched ensemble. As the deviation is larger, the
constraint is stronger and thus brings the annealed en-
semble even closer to the quenched results. Unfortu-
nately, the biasing toward the quenched ensemble is not
strong enough to actually drive the system into the glass
transition.

Besides the nearest neighbor correlations, one could
also consider the correlations for next nearest neighbors
or even two bases separated by arbitrary distances. In
principle, all these correlations together would bring us
to the exact quenched results and thus to the glass transi-
tion. However, the calculations become much more cum-
bersome as one increases the distance between the two
bases, and are left for future work.

VI. APPENDIX

A. Annealed partition function for the binding
energy model

The annealed partition function is obtained by ﬁrst
summing over all compatible sequences given a secondary
structure S and then summing over all possible structures
S, which can be done via the recursive relation in Fig. 1.
We deﬁne the annealed partition function for a sequence
of length N as Za(N + 1).
In addition, the annealed
partition function for a sequence of length N with its two
end bases paired is deﬁned as Ae(N
1). The recursive
relation in Fig. 1 is then read as

−

N −1

1 + L
4

1 + L
2

Za(N +1) =

Za(N )+

Za(k

1)Ae(N

k).

−

−
Xk=1
(15)
The factor (1 + L)/2 for the ﬁrst term on the right hand
side comes from the contribution in nearest neighbor cor-
relations between the free base N and base N-1, and the
2 takes care of averaging over the number of sequences.
We have a similar factor in the second term coming from
the correlation between base k of the arch and base k-1.
In the later part we will show that the behavior of the
annealed partition function is mainly determined by the
arch term Ae, so we will only look at this quantity here.
The ﬁrst base of Ae is also speciﬁed to be A and the last
base to be the conjugate base U.

Again, the annealed partition function for the arch can
be obtained through a similar recursive relation (Fig. 8).
The two terms on the right hand side are further decom-
posed in Figs. 9 and 10.

In these relations, we need to keep track of two factors:
the energy contributions and the nearest neighbor corre-
lations. From the energetic point of view, an arch can
be thought of simply contributing a Boltzmann factor q

E

E

7

E

E

N−2
Σ
k=2

1
A

N
U

1
A

NN−1
U

k

1
A

N−1N
U

FIG. 8: Recursive relation for the annealed partition func-
tion over heterogeneous sequences where the ﬁrst and the last
bases form a conjugate pair. A letter ’E’ is used to denote
that the two bases at the ends of the arch are conjugate bases.

E

E

O

1
A

NN−1
U

1
A

N−1N
U
U

1
A

N−1N
UA

FIG. 9: Decomposition of an arch with its last base inside
being a free base, which can be either A or U, into two cases.
The letter ’O’ is used to denote that the two bases at the ends
of the arch are non-conjugate.

and need not stand for a real binding pair, even though
initially it is used to represent a real binding pair. Thus,
in Fig. 9, as we try to relate the annealed partition func-
tion to its shorter length ones, we assume an eﬀective
binding pair between bases 1 and N-1 simply to conserve
the energy contribution. In this case, the two bases are
not really paired.

In order to keep track of the correct nearest neigh-
bor correlations, we use a letter E on an arch to denote
that the two bases at the ends of the arch are conju-
gate bases. Similarly, a letter O is used to represent two
non-conjugate bases at the ends of the arch. Thus, in
Fig. 9, the two cases where base N-1 is either A or U are
separated and are denoted by letter E and O, which is
determined by whether the bases 1 and N-1 are conjugate
or not. These notations enable us to connect the decom-
posed terms recursively back to the relation in Fig. 8.

In Fig. 10, an inner arch can be treated as a free base in
considering the energy and correlations for the rest of the
bases outside the inner arch. However, there is a diﬀer-
ence in counting neighbor correlations for this treatment
because the free base looks as a base A from the right,
but as a base U from the left. The correct correlations
can be obtained if we shift this discrepancy to the last
base and ﬂip it from U to A. Thus, the last term carries
a letter O on the arch instead of E.

These recursive relations are then read as

Ae(N − 1) =

Ae(N − 2) +

Ao(N − 2) +

(16)

Ae(N − k − 1) [LAo(k − 1) + Ae(k − 1)] ,

Ao(N − 1) =

Ae(N − 2) +

(17)

k=2
X
Ao(N − 2) +

1
2

1
2

Ae(N − k − 1) [LAe(k − 1) + Ao(k − 1)] .

L
2

1
4

L
2

1
4

N−2

N−2

k=2
X

E

E

E

O

1

2N

1

2k−1

2N

1

2N−1 2N

1
A

k

NN−1
U

k
A

N−1
U

1
A

k

k+1
A

FIG. 11: Recursive relation for the partition function where
all the bases are paired.

8

FIG. 10: Separation of arches.

Together with the initial conditions, Ae(1) = q,
Ae(2) = qL, Ao(1) = qL, Ao(2) = q(1 + L)/2, one can
solve for Ae(N ) by performing the z-transform

Ae(z) =

Ae(N )z

−N ,

c
Ao(z) =

Ao(N )z

−N ,

∞

XN =1
∞

XN =1

c

on the recursive relations. After solving for
can be obtained through the inverse transform

Ae(z), Ae(N )

Ae(N ) =

1
2πi

c

Ae(z)zN −1dz.

(20)

I
From previous studies [10], we know that in the thermo-
dynamic limit, the partition function has an analytical
N −3/2zc(q, L)N , where zc(q, L) is the
form as Ae(N )
greatest real part among the branch points obtained from
the solution of

Ae(z).

c

∝

c

c

c

Za(z) to that of the arch

Similarly, if we perform z-transform on equation 15,
we can relate the z-transform of the annealed partition
Ae(z). Since these two
function
share the same branch points, the asymptotic behavior
of the annealed partition function is diﬀerent from the
above formula for the arch by just a diﬀerent prefactor,
which does not play a role in the thermodynamic limit.
The fraction of AA (or UU) neighboring bases per
base of the annealed system is then easily calculated as
L∂L ln(zc(q, L))
|L=1. Unfortunately, the analytical solu-
tion of this set of polynomial equations is too cumber-
some to convey any useful information. Thus, we resort
to numerical evaluation of this analytical solution in this
paper.

B. Fraction of minimal hairpins at zero
temperature

As discussed in the main text, the fraction of minimal
size hairpins can be easily obtained once we ﬁgure out the
partition function. At zero temperature, the partition
function is simpler than the ﬁnite temperature one since
we only need to consider the ground states where all bases
are paired. This partition function is obtained through
the recursive relation in a similar way as shown in Fig. 11.
We deﬁne the partition function for a sequence of
length 2(N-1) as Zm(N, h), where h is the Boltzmann

N−1
Σ
k=1

N −1

Xk=1

factor for a minimal size hairpin. The recursive relation
is then read as

Zm(N + 1) =

Zm(k)Zm(N

k + 1) + hZm(N ). (21)

−

(18)

(19)

Together with the initial conditions, Zm(1) = 1 and
Zm(2) = h, one can obtain the asymptotic behavior
through z-transform. After simple algebra, we have the
largest pole zc(h) = h + 2√h + 1 for the z-transform
of partition function
Zm(z, h). The partition function
Zm(N ) is then proportional to zc(h)N .

The fraction of minimal size hairpins per two bases is

c
then easily calculated as

∂h ln zc(h)

|h=1 =

1 + 1/√h
h + 2√h + 1 |h=1 = 1/2.

(22)

Thus, the fraction of minimal size hairpins per base is
1/4.

C. Annealed partition function for the stacking
energy model

The calculation for the stacking energy model follows
the same approache. However, it is a bit more compli-
cated since we need to keep track of stacking loops in-
volving four bases which leads us to the recursive relation
depicted in Fig. 12.

ES

E

SE
E
S

E

SE

N−2
Σ
k=2

1
A

N
U

1
A

NN−1
U

1
A

2
A
U

N−1N
U
U
A

k

1
A

N−1N
U

FIG. 12: Recursive relation for the stacking energy model.

In these recursive relations, we use an additional letter
S on the arch to denote the fact that we consider the
stacking energy of the stacking loop formed partly by
that binding pair. Independent of the type of the arch, all
the stacking energies inside the arches are still considered
in all cases. Thus, the ﬁrst term on the right hand side
in Fig. 12 does not contain an S because its base N-1 is
unbound, and no stacking loop can be formed with the
binding pair of the arch.

Similar to the recursive relation in previous section,
we then discard the last base as a free base as shown
in Fig. 13. Again, the arches on the right hand side
are meant to preserve the energy contributions only. In
the second line of the relation, we further decompose the

E

E

O

1
A

NN−1
U

1
A

L

N−1N
U
U

ES

N−1N
UA

1
A

ES−E
ES

OS

OS−O
ES

1
A

N−1
U

1 2
A A
U

N−2N−1
U

U
A

1
A

N−1
A

1 2
A A
U

N−2N−1
A

U
A

FIG. 13: Decomposition of the annealed partition function
which last base inside the arch is a free base.

terms in order to relate these terms with the ﬁrst recur-
sive relation in Fig. 12.

E

ES

ES

O

O

(1/h−1)

k

1
A

N−1N
U

k
A

N−1
U

1
A

k

k+1
A

1
A

k+1
A

FIG. 14: Separation of arches considering the hairpin contri-
bution.

9

In Fig. 14, we also separate the contributions of the
inner arch from the rest part as in Fig. 10. One diﬀer-
ence is that we consider the contribution from the hairpin
loops in this case. Thus, the hairpin loop contained in
the outer arch term is not a real hairpin loop because
of the existence of the inner arch. The correct result is
obtained by adding the last term in the relation.

In this stacking energy model, we denote the annealed
partition function for an arch of length N-1 as Aes(N ).
The recursive relations are then read as follows

Aes(N −1) =

Aes(N −2)−(s1 −1)

Aes(N −4)

+

Aos(N −2)−(s2 −1)

Aes(N −4)

+

Aes(N −3)

(23)

2L
4

s1L2 + s2
4

+

Aes(N −k−1)

L

Aos(k−1)−(s1 −1)

Aes(k−3)

+

Aes(k−1)−(s2 −1)

Aes(k−3)

+ 2(

(1 + L2)
4

(cid:20)

(cid:18)
2L
4

(cid:20)

(cid:18)

1
2

(cid:18)

(cid:19)
2L
4

(cid:18)
1 + L2
4

1
2

(cid:19)

(cid:19)

(cid:18)

1 + L2
4

(cid:19)

(cid:18)

(cid:19)
1 + L2
4

(cid:19)

2L
4

s1L + s2L
4

1
h

1
h

−1)Ho(k)
(cid:21)

,

−1)He(k)
(cid:21)

,

(cid:19)

(cid:19)

Aos(N −1) =

Aos(N −2)−(s1 −1)

Aes(N −4)

+

Aes(N −2)−(s2 −1)

Aes(N −4)

+

Aes(N −3)

(24)

+

Aes(N −k−1)

L

Aes(k−1)−(s1 −1)

Aes(k−3)

+

Aos(k−1)−(s2 −1)

Aes(k−3)

+ 2(

L

2

1
4

L

2

1
4

(cid:18)
N−2

k=3
X

(cid:18)
N−2

Xk=3

where the terms He and Ho stand for the contribution
from a hairpin. They are obtained separately from a
recursive relation similar to the one in Fig. 9, by just
replacing the wavy line by a straight line, which means
that bases are not bound. One can then easily formulate
the recursive relations for He and Ho.

Together with the initial conditions: Aes(1) = h,
Aes(2) = hL, Aes(3) = h(1 + 3L2 + s2 + s1L2)/4,
Aos(1) = hL, Aos(2) = h(1 + L2)/2, Aos(3) = h(3L +
L3 + s1L + s2L)/4, we can perform z-transform to ob-
tain the asymptotic behavior of the annealed partition
function for the stacking energy model.

[1] K. A. Dill et al., Protein Sci. 4, 561 (1995).
[2] J. N. Onuchic, Z. Luthey-Schulten, and P. G. Wolynes,

Rev. E. 65, 041919 (2002)

[13] M. M¨uller, F. Krzakala and M. M´ezard Euro. Phys. J. E.

Annu. Rev. Phys. Chem. 48, 545 (1997).

9, 67 (2002).

[3] T. Garel, H. Orland and E. Pitard, J. Phys. I (France)

7, 1201 (1997).

[4] E. I. Shakhnovich, Curr. Opin. Struct. Biol. 7, 29 (1997).
[5] P. G. Higgs, Q. Rev. BioPhys. 33, 199 (2000).
[6] P. G. Higgs, Phys. Rev. Lett. 76, 704 (1996).
[7] A. Pagnani, G. Parisi and F. Ricci-Tersenghi, Phys. Rev.

Lett. 84, 2026 (2000).

[8] A. K. Hartmann, Phys. Rev. Lett. 86, 1382 (2001).
[9] A. Pagnani, G. Parisi and F. Ricci-Tersenghi, Phys. Rev.

Lett. 86, 1383 (2001).

[10] R. Bundschuh and T. Hwa, Phys. Rev. E 65, 031903

[11] F. Krzakala, M. M´ezard and M. M¨uller, EuroPhys. Lett.

(2002).

57, 752 (2002)

[12] E. Marinari, A. Pagnani and F. Ricci-Tersenghi, Phys.

[14] H. Orland, and A. Zee, Nucl. Phys. B. 620, 456 (2002)
[15] R. Mukhopadhyay, E. Emberly, C. Tang and N. S.

Wingreen, Phys. Rev. E. 68, 041904 (2003)

[16] M. Baiesi, E. Orlandini and A. L. Stella, Phys. Rev. Lett.

[17] P. Leoni and C. Vanderzande, Phys. Rev. E. 68, 051904

91, 198102 (2003)

(2003)

[18] I. Tinoco Jr. and C. Bustamante, J. Mol. Biol. 293, 271

(1999), and references therein.

[19] P. G. de Gennes, Biopolymers 6, 175 (1968).
[20] M. S. Waterman, Advances in Mathematics, Supplemen-
tary studies, edited by G.-C. Rota (Academic, New York,
1978), pp.167-212.

[21] J. S. McCaskill, Biopolymers 29, 1105 (1990)
[22] M. Zuker and D. Sankoﬀ, Bull. Math. Biol. 46, 591 (1984)

[23] T. Morita, J. Math. Phys. 5, 1401 (1964)
[24] E. Orlandini, A. Rechnitzer and S. G. Whittington, J.

526 (1985)

[25] S. F. Altschul and B. W. Erickson, Mol. Biol. Evol. 2,

Phys. A. 35, 7729 (2002)

10

