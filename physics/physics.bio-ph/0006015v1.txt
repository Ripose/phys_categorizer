The Architecture of Idiotypic Networks: Percolation and Scaling

Behaviour

Institut f¨ur Theoretische Physik, Universit¨at Leipzig, Augustusplatz 10, D-04109 Leipzig,

Markus Brede and Ulrich Behn

Germany

Abstract

We investigate a model where idiotypes (characterizing B-lymphocytes and
antibodies of an immune system) and anti-idiotypes are represented by com-
plementary bitstrings of a given length d allowing for a number of mismatches
(matching rules). In this model, the vertices of the hypercube in dimension d
represent the potential repertoire of idiotypes. A random set of (with proba-
bility p) occupied vertices corresponds to the expressed repertoire of idiotypes
at a given moment. Vertices of this set linked by the above matching rules
build random clusters. We give a structural and statistical characterisation
of these clusters – or in other words – of the architecture of the idiotypic
network. Increasing the probability p one ﬁnds at a critical p a percolation
transition where for the ﬁrst time a large connected graph occures with prob-
ability one. Increasing p further, there is a second transition above which the
repertoire is complete in the sense that any newly introduced idiotype ﬁnds
a complementary anti-idiotype. We introduce structural characteristics such
as the mass distributions and the fragmentation rate for random clusters,
and determine the scaling behaviour of the cluster size distribution near the
percolation transition, including ﬁnite size corrections. We ﬁnd that slightly
above the percolation transition the large connected cluster (the central part
of the idiotypic network) consists typically of one highly connected part and a
number of weakly connected constituents and coexists with a number of small,
isolated clusters. This is in accordance with the picture of a central and a
peripheral part of the idiotypic network and gives some support to idealized
architectures of the central part used in recent dynamical mean ﬁeld models.

PACS numbers: 64.60.Ak, 05.10.Ln, 02.70.Lq, 87.18.-h

0
0
0
2

 

n
u
J
 

7

 
 
]
h
p
-
o
i
b

.
s
c
i
s
y
h
p
[
 
 

1
v
5
1
0
6
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Typeset using REVTEX

1

I. INTRODUCTION

B-lymphocytes carry on their surface highly speciﬁc receptors, so-called antibodies. If
these receptors detect complementary structures, the lymphocyte is stimulated to proliferate
and after several generations and diﬀerentation into plasma cells secrete antibodies of the
same speciﬁcity. B-lymphocytes and antibodies of a given speciﬁcity are said to have a cer-
tain idiotype. Complementary structures to an idiotype are antigen or other, anti-idiotypic
antibodies. Between B-lymphocytes of diﬀerent idiotype thus emerges a functional network
of mutual stimulation and inhibition, the idiotypic network [1]. The idiotypic network is
supposed to at least partially contribute to the functionality of the immune system as, e.g.,
immunological memory or suppression of autoreactive clones. Though quantitative data are
very hard to access by experiment there are some recent observations which underline the
importance of idiotypic interactions [2,3].

New idiotypes are produced in the bone marrow or due to hypermutation during the
proliferation of stimulated lymphocytes which introduces a random metadynamics of the
repertoire. At a given moment the random network has a certain architecture. The aim of
this paper is to give a statistical description of this architecture. Knowledge of the typical
architecture of the idiotypic network is crucial for describing the population dynamics of the
interacting B-lymphocytes and antibodies, cf. [4,5], which is however not the subject of this
paper.

Derived from hypotheses of theoretical immunology (cf. [1,6], for a recent review see [7])
we present a statistical analysis of bit-string based networks, which shows, that this approach
is well suited to reproduce reasonable network structures. Especially, our considerations
show, that realistic network topologies can be conceived as an extension of ﬁrst approaches
to that problem which assumed a Bethe-lattice structure. Suggestions of how loops should
be added to such structures have been made previously [8]. For this, our work provides a
very natural access.

Generally, idiotypic networks are supposed to realize a tradeoﬀ between two basic re-
quirements: they should contain a great number of small isolated components, but on the
other hand still be able to respond to arbitrary antigen, that means being complete. Small
components are thought necessary to store information about previously encountered anti-
gen [7,9,10]. The existence of such components does obviously demand a low connectivity
of the network. With completeness on the other hand it is assumed that of a great number
of antibodies each is able to detect many diﬀerent types of antigen. Hence the network
connectivity should not be too low.

With regard to the underlying biological problem the one great–many small clusters
situation is thus worthwhile to earn special attention. Theoretical immunologists suppose
that the idiotypic network should consist of a large number of small clusters. On the other
hand, as a consequence of relatively high connectivities, also a large component should be
contained within the idiotypic network, which is denoted as its central part. This great
cluster could play an important role in the control of autoreactive clones [6,11–13].

In the following the bit-string model of [14] will be explained brieﬂy. Basically, antibodies
are identiﬁed with bit chains of a given length d. Thus, there are 2d diﬀerent antibody types.

2

The set of all conceivable antibodies, i.e. the potential repertoire, is then represented by
{i = (i1, ..., id), i ∈ {0, 1}}. Estimating the probable size of networks that can be complete
in the above sense shows that d ≈ 32...36 should be a good value for realistic models [15].
Antibodies recognize each other if they have complementary structures, i.e. if they are
represented by perfectly complementary bit strings. If there are small deviations from the
exact structural complementarity a matching is still possible, though with lower aﬃnity.
This is described by so-called matching rules.

For example we imagine that antibodies react if the respective structures are complemen-
tary except one small region. Using the language of our model the corresponding bit-strings
should be inverse except one bit that belongs to the non-complementary region. We call this
kind of rule a one-mismatch rule. Two-mismatch rules, which allow reactions between anti-
bodies that are complementary up to two non-matching regions, are accordingly deﬁned by
connecting bit-strings that are complementary with two exceptions allowed. Naturally, the
multitude of possible rules is not exhausted by mismatch rules. Rules that express matching
of mutually shifted antibody parts could be conceived as well. For the sake of simplicity
this work is conﬁned to those matching rules that are associated with reactions of highest
aﬃnity, i.e. inversion, one- and two-mismatch rules.

Mathematically, the set of all antibody types (represented by bit-strings or vertices of
a hypercube) together with all possible reactions between them deﬁnes a graph. Thus, we
want to call

G1
d =({v = (v1, ..., vd), vj ∈ {0, 1}},{v connected with w
if vi = wj for all i, j = 1, ..., d except one position
at the most})

the one-mismatch base graph and

G2
d =({v = (v1, ..., vd), vj ∈ {0, 1}},{v connected with w
if vi = wj for all i, j = 1, ..., d except two positions
at the most})

(1)

(2)

the two-mismatch base graph, respectively. To obtain a better impression of one-mismatch
graphs they can be compared to hypercubes of the same dimension. Looking, e.g., on
hypercubes of dimension d = 3 edges of one-mismatch graphs are represented by all space
and side diagonals. This, together with a picture of an one-mismatch graph in dimension
ﬁve is shown in Figs. 1 and 2, respectively.

The actual repertoire, i.e. the set of all types of idiotypes that are really existing within
the body at a given time, is a subset of the potential repertoire. There are profound reasons
to believe that the actual repertoire should be distributed randomly within the potential
repertoire [7]. A way of realizing this is to choose antibodies with a certain probability
p. Then the idiotypic network is represented by the random graph that is composed of all
occupied vertices (antibodies) and their connections (possible reactions). Clearly, this is a
percolation problem [16].

Percolation problems on standard lattices are far away from beeing a new ﬁeld of research.
Percolation on one-mismatch graphs, however, bears some major diﬀerence to ordinary
percolation.

3

Percolation is always connected to an abrupt change of some system property (the stan-
dard property is the existence of a connecting path from the upper to the lower boundary on
2-dimensional lattices) if the occupation probability passes a certain value, the percolation
threshold. This transition becomes sharp in the limit of inﬁnite systems.

On lattices there is no question how to increase the system size to inﬁnity. However,
sequences of one-mismatch graphs exhibit relations between small and large systems that
are essentially diﬀerent from similar characteristics of lattices which are created by the
multiplication of a unit cell. Understanding of these distinctions comes from studying the
structure of fully occupied one-mismatch graphs (base graphs) which will be performed in
the ensuing Section.

Generally, the conception of the paper is as follows:

II topological properties
of base-graphs will be studied. Section III gives an analysis of the underlying percolation
problem, which then leads, together with applications of random graph theory from Sec. IV
and a study of intrinsic structures of great clusters in Sec. V, to conclusions about parameter
regimes, in which bit-string model induced random graphs resemble idiotypic networks. In
the appendix another method to calculate thresholds via the renormalization of small cells
will be discussed.

in Sec.

II. STRUCTURE OF THE BASE GRAPH FOR THE ONE-MISMATCH RULE

The above deﬁnition of matching rules allows an easy calculation of distances between
d be vertices, dH their Hamming distance (i.e. the number of

vertices of G1
diﬀerent bits between them) and

d. Let i, j ∈ G1

dG(i, j) =

inf

pathes w in G1
connecting i and j

d

l(w) ,

(3)

where l(w) denotes the length of a path w, a metrics. Then it holds that if

dH < d/2

dH = d/2

dH > d/2

dG =(dH

dH + 1

for dH even
for dH odd

dG = d/2

for d even

(4)

dG =(d − dH + 1 for dH even

for dH odd ,

d − dH

which shows that the maximum distance Dmax(d) between vertices is roughly the half of
that on ordinary hypercubes. This is essentially due to the inversion rule. Furthermore, it
should be noticed that Dmax(d) does not change when increasing the dimension by one from
odd (d = 2n + 1) to even (d = 2n + 2) values.

To obtain additional information about the toplogy we distinguish vertices corresponding
to their distance s to an arbitrarily chosen origin, e.g. v = 0 = (0, ..., 0), whose choice is
arbitrary due to the speciﬁc construction-rule of base graphs. We denote the set of vertices
with distance dG(v, i) from v by

Es = {i ∈ G1

d|dG(v, i) = s}.

(5)

4

Applying (4) it is possible to compute the number of vertices |Es| belonging to Es (mass
distribution) by simple combinatorics to

|Es| =

.

(6)

2

dG − 1! if dG = d+1
  d

dG !
 d + 1


if dG ≤ d

2

A visualization of (6) in Fig. (3) shows a major diﬀerence between odd and even dimen-
sions d. Generally, |Es| grows monotonically with increasing distance. For odd dimensions,
however, the number of vertices with maximal distance Dmax from v is substantially smaller
than that with distance Dmax − 1
Diﬀerences in the overall structure of graphs in odd and even dimensions d become even
more obvious if the number of links connecting vertices of the same set Es is considered.
Using (4), a somewhat lengthy but straightforward calculation shows that connected vertices
in the same distance s from the origin v occur in

d even only for
d odd only for

s = Dmax = d/2
s = Dmax = (d + 1)/2 or
s = Dmax − 1.

(7)

Analogously, the number of links that connect vertices of Es with vertices belonging to Es+1
may be computed to d + 1 − s for s < Dmax − 1.
As a consequence there must exist loops of even as well as of odd length. Moreover, all
short loops with length less than d must be even (since only loops comprising links between
vertices in the same distance from any loop element can be of an odd length).

An important property of standard systems in percolation theory is that the smaller
system is always contained within the larger one. For one-mismatch graphs, however, this is
not possible. Let d1 < d2 be dimensions of G1
d1 were contained
in G1
d2 should have uneven loops with length less then d1.
This gives a contradiction since G1
d2 contains no odd loops smaller than d2, whereas d1 < d2
by assumption.

d2 it would follow directly that G1

d2, respectively. If G1

d1 and G1

Resuming these results we state that percolation on one mismatch graphs diﬀers from
standard percolation. A crucial point for this distinction is the way how global system
properties change if the system size approaches inﬁnity. Therefore it could seem at least
questionable whether standard methods of percolation theory can be applied to this kind
of problem. Though, making use of the fact that ordinary hypercubes are contained in
one-mismatch graphs and applying an appropriately choosen majority rule, renormalization
group procedures can be extended to one-mismatch-graphs (see appendix A).

To the best of our present knowledge percolation problems on graphs with similar prop-
erties have not been dealt with. Even percolation on regular hypercubes has found relatively
little attention in the physical literature [17].

5

III. CLUSTER SIZE DISTRIBUTION

Having collected some simple properties of the underlying base graphs we consider now
vertices of that graphs occupied with a given probability p. The set of all occupied vertices
Γ together with all bonds, which connect two vertices belonging to Γ forms a random graph.
In terms of percolation theory a maximal set of connected vertices is called cluster.

What is the probability that an arbitrarily chosen vertex belongs to a cluster of size |C|?
This question has already been addressed in [9,10] where three major regimes of the system
have been identiﬁed (see also the numerical results in Fig. 4):

(i) The ﬁrst typical situation arises for small values of the occupation probability p.
Then only small clusters (whose individual size doesn’t make up a ﬁnite fraction of the
whole system) are expected to appear.

(ii) Increasing p and approaching inﬁnite dimensions, a sharp transition (in the sequel
denoted as percolation transition) to an one great cluster–many small clusters regime was
found. At the percolation transition some characteristics obey scaling laws. These and an
approximation to compute percolation thresholds will be dealt with in Sec. IV.

The one great–many small clusters situation is worthwhile to earn special attention (cf.
Sec. I). The great cluster could play an important role in the control of autoreactive clones.
To fulﬁll that purpose it is believed to have a certain internal structure (cf. [12,13,18], for
experimental data cf. [19]), which will be discussed in more detail in Sec. VI. Thus, as stated
already in [9,10] the simple one–parametric bit chain model exhibits an interesting similarity
to the idiotypic network.

(iii) Finally, if the occupation probability is further increased, a state where random
graphs consist of one connected component only will be reached. Relying on some general
results of the theory of random graphs it can be shown that this indeed marks a second (in
the limit of inﬁnite systems) sharp transition which we call denseness transition. In Sec. V
these considerations are resumed and discussed with reference to the completeness of the
immune system.

IV. SCALING LAWS AND BETHE APPROXIMATION

A common method to analyze percolation problems is the introduction of perimeter

polynomials D|C|. Using the standard notation we deﬁne

p(|C|) = p|C| XSfree(C)

(1 − p)|Sfree(C)| = p|C|D|C|(1 − p),

(8)

where p(|C|) denotes the probability that a vertex on the base graph belongs to a cluster of
size |C|. Sfree(C) means the free surface, i.e. the set of all unoccupied vertices of the base
graph that are adjacent to vertices of C.
Generally, there are few problems which allow the explicit calculation of D|C| for arbitrary
cluster size |C|. Notwithstanding, it is always possible to compute D|C| for small values of
|C|. This provides a basis for the application of series expansion techniques. Investigating
the structure of small clusters up to size |C| = 5 on one-mismatch-graphs, we obtain the

6

following perimeter polynomials

D1(q) = qd+1 ,
D2(q) = (d + 1)q2d ,

D3(q) =

3
2

(d + 1)dq3d−2 ,

D4(q) = q4d−4(2(d − 1)d(d + 1) +

d(d + 1)

2

+

+

2
3q

D5(q) =

(d − 1)d(d + 1)) ,
5
q5d−6(d − 1)d(d + 1)(d − 2 +
2
1
q3 (d − 2)) ,

1
q2 +

1
q

(d − 1) +

(9)

(10)

(11)

(12)

(13)

where q = 1 − p.
High dimension expansions provide a way to calculate the percolation threshold making
use of the fact that loops in random graphs on sparsely occupied high dimensional lattices are
very improbable. Indeed, the ﬁrst terms in the resulting approximation for the percolation
transition on a hypercubic lattice of dimension d can be shown to equal the exact value for
the percolation transition for Bethe-lattices with coordination number d [20,21]. Further
terms in that series give corrections of order O(d−2) to Bethe-lattices.

A closer look at the perimeter polynomials (9-13) supports the hypothesis that this also
holds for one-mismatch graphs. Considering for instance clusters of size |C| = 4 we perceive
that the fraction of D4 belonging to 4-loops is expressed by (1 − p)4d−4d(d + 1)/2 which
decreases substantially faster than D4, if dimension goes to inﬁnity. The low importance of
loops on one-mismatch-graphs in high dimensions is also supported by the fact, that ordinary
hypercubes up to dimension d−1, for which the assertion of the low importance of loops holds
[22], are contained within G1
d. Thus, for small p random graphs on one-mismatch-graphs
are very similar to random graphs on Bethe-lattices with the same coordination number.
Consequently the percolation threshold for one-mismatch-graphs can be approximated to

whereas for two-mismatch graphs holds

p(1)
c = 1/d,

p(2)
c = 1/(d + d(d + 1)/2).

(14)

(15)

Corrections to (14) and (15) are of order O(d−2) and O(d−3), respectively. From consider-
ations of Sec. I we ﬁnd that the number of links connecting vertices in Es with vertices in
Es+1 decreases with growing distance s. Thus, we conclude that the corrections to p(1)
c must
be positive.

Typically for percolation problems, certain system characteristics obey scaling laws at
the percolation threshold. This kind of laws reﬂects the statistical self similarity of clusters
on diﬀerent length scales in that parameter regime. Fig. VII displays simulation results for
the cluster size distributions obtained for one-mismatch-graphs of dimensions 10 and 14 .
Both data sets can be well described by the ﬁnite size scaling ansatz

p(|C|) = |C|−τ F (|C|/|C|∗) ,

(16)

7

where the function F (x) is nearly a constant for x ≪ 1 and will be more rapidly declining
than any power law for arguments x ≫ 1. Equation (16) should apply for clusters which
are neither too small nor too large. Due to the limited size of the investigated systems,
very large clusters behave in a diﬀerent way than clusters of ‘standard’ size. The transition
between the laws applying to these seperate cases is marked by |C|∗, which in turn depends
on the extent of the system.
Analogous properties can be observed for base graphs deﬁned by other matching rules.
Figure 6 illustrates scaling behaviour for the case of graphs diced on two-mismatch-base
graphs for values of p = p(2)
cf. (15). As a natural consequence of adding supplementary
c
edges distances between vertices will become smaller in comparison to one-mismatch-graphs.
This gives an explanation for the fact, that typical sizes |C|∗ are substantially smaller than
those examined on one-mismatch-graphs with the same choice of d.
Furthermore, it can be seen in Fig. VII that the scaling law (16) even well applies to

very small Clusters. It is useful to deﬁne a cluster size dependent exponent τ|C| by

τ|C| = −

ln p(|C|+1)
p(|C|)
ln |C|+1
|C|

.

(17)

Evaluating the perimeter polynomials (9)-(13), values of τ|C| for small |C| can be derived.
Thus we obtain a sequence {τ|C|} which should approach the true value of τ for large |C|.
As a matter of fact (16) changes to p(|C|) ∼ |C|−τ in the limit of inﬁnite systems.
Performing the limits d → ∞ in Eqs. (9)-(13) and (17), we observe that τ ∞

|C| obeys

τ ∞
|C| =

1

ln(1 + 1

|C| ) − |C| + 1 ,

(18)

which by comparison of (17) with (18) and solving the recursion relation implies the law

p(|C|) =

e−|C||C||C|−2

|C|!

(19)

for the cluster size distribution. Equation (18) leads to τ = 3/2 for large clusters. The thus
computed value τ = 3/2 is in accord with the exact result on the Bethe-lattice.

Since we investigate a model for a biological system our main interest is devoted to
large, yet ﬁnite systems. In the sequence {τ|C|} our best approximation for the real value of
τ is τ4. A comparison between values of τ computed by τ ≈ τ4 and exponents τ obtained
by evaluating numerical data for small systems suggests that the involved approximation
becomes rapidly more accurate if the system size is increased. Hence in d = 32 we rely on
τ4 and ﬁnd τ ≈ 1.5, which gives a result that also supports the previous assumption.
Subsequently it was our aim to ﬁnd a quantity which gives an overall estimation of
deviations between random graphs on one-mismatch-graphs from those on Bethe-lattices
of equal coordination number. For this purpose it appears appropriate to investigate the
results of an edge elimination procedure which computes the number of bonds belonging to
loops. Similar procedures have very recently [23] been applied to lattices.

The above aim is achieved by individually removing every edge of every cluster and
calculating the number of the connected components of the resulting graph. An edge is
called fractioning if two components are obtained cutting this edge. Clearly, only edges that
belong to loops are not fractioning.

8

Then the ratio of fractioning edges in relation f (C) to the overall number of bonds b(C)
of a cluster C, deﬁned by f = f (C)/b(C), is some indication for the importance of loops
for the structure of C. Distinguishing clusters according to their size |C| we computed the
mean fractioning ratio f|C| =< f (C ′)/b(C ′) >|C ′|=|C|. Excluding very small clusters with
trivial structure, Fig. 7 illustrates the validity of a ﬁnite size scaling law

f|C| = |C|−λ ˆF (|C|/|C|′)
for the fragmentation rate f at the percolation threshold.

(20)

Again, a cluster size dependent exponent λ(|C|) may be deﬁned. Employing the perime-
ter polynomials D4 and D5 it is possible to obtain a rough estimation for λ, which is,
analogously to (17), expected to become suﬃciently accurate for large systems. From

λ4(d) ≈

1

ln 5/4(cid:18) 393

2 · 103 d−1 +

4029120

8 · 106 d−2(cid:19)

(21)

we derive λ ≈ 0.03 in 32 dimensions to be compared with λ = 0 which holds for Bethe-
lattices. Thus the value λ > 0 measured on random graphs on one-mismatch-graphs – which
is caused by a small number of loops – should quantify the deviation from random graphs on
Bethe-lattices. Consequently we deduce that the occupation probability at the percolation
threshold is still small enough to apply the Bethe approximation.

Yet, random graphs at pc are not exactly Bethe–like and contain a certain fraction
of loops. Otherwise it would be impossible to distinguish subclusters according to their
connectivity within any considerable connected component. This, however, is likely to be
necessary, to explain the role of the central part of idiotypic networks properly [13].

Further investigations concerning the structure of great clusters will be made in Sec. V.

V. DENSITY THRESHOLD AND THE COMPLETENESS OF THE IDIOTYPIC

NETWORK

Hitherto, our main interest was devoted to the question at which occupation probability
a great cluster starts to exist. If p, however, is further increased it is also imaginable that a
situation occurs, where the whole system consists of one great cluster only. This is referred
to as the question about the connectivity property of random graphs.

In the theory of random graphs some general results that address related problems have
been derived for so called sequences of conﬁguration spaces [24,25]. It can be shown that the
sequence of one-mismatch-base graphs {G1
d} fulﬁlls all requirements of these conﬁgurations
spaces [30], due to its rather technical nature the proof will be omitted here.
General results of [24,25] can be applied here showing that for inﬁnite systems there

exists a threshold

pconn = 1 − lim

d→∞|G1

d|−1/γd

(22)

(γd being the coordination number) with the property that almost all random graphs are
connected for p > pconn while the set of all connected random graphs has measure zero for
p < pconn.

9

Moreover, for sequences of conﬁguration spaces it holds that both the connectivity and
the density treshold, i.e. the threshold for the property that there is no non-occupied site
without occupied neighbours on the base graph, coincide. Using (22) we ﬁnd

in case of one-mismatch-graphs and

conn = p(1)
p(1)

dense = 1/2

conn = p(2)
p(2)

dense = 0

(23)

(24)

for two-mismatch graphs.

Density of random graphs in our model can be directly translated into biological terms.
Since antibodies and antigens are represented by the same sets of bit chains the property
that there is no free site without occupied neighbour means that every antigen is sure to
encounter a complementary antibody. Hence the idiotypic network is able to respond to any
antigen. This is meant by the completeness axiom [7] for the immune system.

Nevertheless it is somewhat diﬃcult to reconcile the demands for denseness of random
graphs and occurance of small clusters at the same time. However, it seems unlikely that
completeness should be understood in this strict way. Rather it appears to be a better
solution to consider the fact, that evolution has most likely driven the idiotypic network
into such a kind of arrangement, that it is able to respond to variations of really existing
antigen only. Thus we argue that completeness of the idiotypic network does not exactly
match density of random graphs, but requires only the probability for the density of the cor-
responding random graph to be somewhat below 1. So, random graphs could still comprise
small clusters and be complete.

Another paradoxon arises if two-mismatch graphs are considered. For those the connec-
tivity and percolation thresholds p(2)
conn fall together. How could then small clusters
and a seperate great component coexist if all random graphs are connected? Yet, for the
case of ﬁnite systems it is clear that p(2)
conn(d), i.e. a great cluster has to be formed
ﬁrst, before it can devour his competing small rivals.

c (d) < p(2)

c and p(2)

Consequently, also for the case of two-mismatch-graphs the biologically interesting regime
is well deﬁned. For ﬁnite systems there is a range of occupation probabilities p(2)
c (d) < p <
conn(d), where all requirements are met. Due to the fact that both probabilities p(2)
p(2)
c (d) and
p(2)
conn(d) are converging to zero in the limit d → ∞ it follows that the extent of this range
|p(2)
c (d) − p(2)
In the next Section our interest will be shifted towards the intrinsic structure of great
clusters. Therefrom further conclusions about biologically relevant parameter regimes can
be drawn.

conn(d)| will also become very small for large systems.

VI. INTRINSIC STRUCTURE OF GREAT CLUSTERS

Resuming results for percolation on mismatch-graphs from Sec. I-IV two phase transi-
tions have been found to occur. The ranges below pc (since there is no great cluster) and
above pconn (since there is only one great cluster) are of no interest concerning the biologi-
cal background of the model. The one great cluster–many small clusters situation between
both, however, is likely to fulﬁll some requirements for idiotypic networks (see Sec. II). In

10

this Section further investigations into the network structure within this parameter regime
will be made.

Insights into the structure of a great cluster can be obtained from the mass distribution
of this cluster Mc(s) = {v ∈ C|d(v, c) = s}, i.e. the information, how many vertices have
a certain distance s from a starting point c. Due to the equality of all starting points c we
deﬁne

M(s) =

1

|C|Xc∈C

Mc(s)

(25)

and consider the mean value of M(s) calculated over all clusters, whose size exceeds a
minimum value 0.5 × p × 2d. For the metrics d(· ,·) there are two distinguished choices, viz.
metrics deﬁned by (3) allowing paths in G = G1
d, i.e. d(· ,·) = dG, and such restricting paths
to C itself, i.e. d(· ,·) = dC. Since dC > dG we conﬁne our investigations to d(· ,·) = dC
which provides a better ‘resolution’. In the following we will discuss some typical cluster
compositions to obtain a survey of possible conclusions from mass distributions to cluster
structures.

Basically, three diﬀerent situations could be imagined (for (i) and (iii) see Fig. 8).
(i) A cluster could consist of some loosely clinged high connectivity regions (heaps), whose
vertices are distinguished by a great number of connections with each other. Other vertices
are bound with relatively few links. Clearly, strong connectivity within heaps means, that
vertices belonging to them have nearly the same distance from all other vertices. Thus, the
presence of many heaps should result in a great number of local extrema, caused by ‘looking
from all heaps’ to each other. On the other hand, loosely bound vertices will smooth the
mass distribution, i.e. reduce the sharpness of extrema.

(ii) A cluster could contain no distinguished parts at all. From (6) we know that till
s = Dmax the number of vertices is increasing with the distance s. For small occupation
probabilities p < pconn (for which not the whole base-graph has been ‘conquered’ yet) we
expect a compromise between with s declining probabilities that a vertex of that cluster has
distance s from an origin v and the increasing number of vertices with s. Consequently, the
mass distribution should exhibit one maximum. For large p > pconn mass distributions can
simply be derived by multiplying (6) with p.

(iii) As a special case of (i) a cluster could be made of one heap and a certain fraction of
loosely bound vertices. Then up to two maxima, caused by the heaped vertex concentration
and the competing tendencies (see (ii)), respectively, are likely to occur. The sharpness of
both maxima will depend on the fraction of the loosely bound vertices. Thus, in case of
a large proportion of those vertices both extrema could be smoothened to just one broad
maximum.

Fig. 9 shows normalized simulation results for the mass distribution for diﬀerent values of
p. Clearly, all distributions are marked by only one maximum, whose sharpness is increasing
with growing values of p. For p = 0.4 slightly below pconn = 0.5 similarities with (6) can be
stated. Hence clusters are then already stretched over the whole extent of the base-graph.
More interestingly, for small p’s in the vicinity of the percolation threshold relatively
broad maxima occur, which could be an indication for cluster structures as described in
(iii).

To prove the validity of this hypothesis we have applied the edge-elimination algorithm
(see Sec. II) to great clusters. As a slight extension of the described procedure all fractioning

11

edges are removed, thus splitting a cluster C into the sequence of its doubly connected
components, or heaps in the above sense, (C1, ..., Ct). Obviously, vertices belonging to
doubly connected components are distinguished by their strong cliquishness in comparison
to other vertices. Thus, the number of such components t should allow to distinguish between
the situations (i)-(iii).

Fig. 10 shows simulation data for the mean value hti of the resulting non-trivial parts
after edge-elimination depending on p. The distribution is marked by one maximum, which
is again a consequence of two competing tendencies. For small values of p clusters are
generally not doubly connected, but increasing p leads to a larger proportion of vertices that
belong to loops. On the other hand, there is a tendency that loops get connected by loops,
i.e., seperate doubly connected cluster components are growing together. Thus, for large p
almost every cluster will consist of one doubly connected component only.

Results of Fig. 10 show also that the maximum is reached slighly above the percolation
threshold pc. Then, the number of doubly connected parts t is rapidly declining till it
asymptotically approaches t = 1 for p → 1. We argue that this behaviour is caused by
one great doubly connected component which occurs ﬁrst for some p>
≈pc and then gradually
incorporates all other doubly connected parts. In principle, these results do also apply to
two-mismatch graphs (see Fig. 11).

Comparing this with the above described scenario of cluster structures, we can thus
state that there is a range of values of p>
≈pc where (iii) applies, i.e. clusters are made of one
great doubly connected component (including several small ones) and a set of other loosley
bound vertices. Accordingly, within this range of p we deﬁne two subsets of great clusters
C, namely the great doubly connected component B = C (2) and the complementary set
P = C − B.
As already discussed in Sec. I, the central part of idiotypic networks (corresponding to
great clusters C) should contain strongly and weakly connected distinguished subsets. From
the previous analysis it becomes clear, that there is a choice of the only parameter p, where
bit-string models can exactly reproduce such a situation.

VII. CONCLUSIONS

We investigated statistical properties of a bit-string based model for idiotypic networks
and compared typical architectures of the thus deﬁned network with axioms and hypotheses
for idiotypic networks from theoretical biology. Before introducing randomness we undertook
an analysis of the underlying base graphs to show a major diﬀerence to standard percolation
problems which bases on the way how the size of the system is increased.

In the following the expressed antibody repertoire was identiﬁed with graphs, created
by randomly occupying a matching rule deﬁned base structure (base graphs). Concepts of
percolation theory have been applied in order to determine the percolation threshold.

The immune system is a very large, yet ﬁnite system. Consequently, ﬁnite size corrections
have to be taken in account. Series expansion techniques allowed the calculation of two
critical exponents (for ﬁnite systems and in the limit d → ∞) that charactarize the scaling
behaviour. A regime of values for the parameter p > pc has been found where random
graphs consist of many small clusters and one great connected component. For choices p>
≈pc
our model reproduces the peripheral/central part conception for idiotypic networks.

12

The translation of the notation of the completeness of idiotypic networks into the lan-
guage of graph theory allowed the determination of an upper threshold pdense for the oc-
curance of the many small clusters–one great cluster situation. Furthermore, relying on
general results of the theory of random graphs (for so-called sequences of conﬁguration
spaces) we calculated the – in this case coinciding – thresholds for the density (pdense) and
the connectivity (pconn) properties.

Furthermore, we developed techniques to obtain additional information about the struc-
ture of great clusters. Analysing random graphs for p>
≈pc great clusters can be decomposed
into two subsets of vertices with diﬀerent binding properties, namely groups of doubly con-
nected vertices (backbone) and loosely linked vertices (peripheral part of the great cluster).
Thus, bit-string models are suited to describe a hierarchy of connectivity levels, that
really existing idiotypic networks are also expected to exhibit. Our results support to some
extent idealized architectures used in a mean ﬁeld type model to describe the dynamics of
the central part of the immune system [13]. Contrary to other model approaches [8,26–29]
for topologies of idiotypic networks our simple few parametric bit-string model produces
a non-trivial seemingly realistic network topology, without assuming a priori distinguished
vertex groups.

APPENDIX A: RENORMALIZATION GROUP APPROACH

In this appendix we want to present an alternative method to calculate the connectivity
threshold for one-mismatch-graphs. Though knowing the exact result from graph theory an
extension of ideas of the renormalization group theory to these special graphs seems to bear
a new feature, which we want to brieﬂy amend here.

Our approach bases on the idea of the renormalization of small cells [31] which employs
the self similarity of the system on diﬀerent length scales at the percolation threshold. A
condition to apply this procedure is that an appropriate grouping of sites on the original
lattice leads to a renormalized lattice with the same symmetry properties as the original
one. Here, treating not a real space lattice but a functional networks, we adapt the idea of
the renormalization group theory in the following way. We ﬁnd a transformation R which,
by grouping of vertices, leads from the one-mismatch base graph G1
d+2 in dimension d + 2 to
d+2) ≃ G1
a graph R(G1
d,
thus allowing a systematic reduction of the degrees of freedom.
If a – for ﬁnite systems appropriately deﬁned – threshold property, namely pconn(d),
converges to a certain value for d → ∞, diﬀerences between pd and pd−2 must be small and
will disappear in the limit of inﬁnite systems. Consequently, if a grouping of vertices to
super vertices on a graph G yields a renormalized graph R(G) of the same type, percolation
thresholds on both graphs will be the same. Thus, we replace the term symmetry (as it is
applied to lattices) by equivalency of graphs.

d+2) which is equivalent to the base graph G1

d in dimension d, R(G1

We encode an arbitrary vertex of the base graph G1

d+2 by (A, b0, b1) where A is a bit
chain of length d and b0, b1 are single bits. Every vertex on G1
d+2 belongs to a unique
4-loop {(A, b0, b1), (A, b0, b1), (A, b0, b1), (A, b0, b1)} connected by one-mismatch links. The
renormalization R replaces this 4-loop by the ‘super’vertex (A) on R(G1
d+2) (of course the
choice of (A) leads to identical results). If two vertices A and B are connected by an inversion
(one-mismatch) link on G1
d the vertices of the corresponding 4-loops on G1
d+2 are connected
by 4 inversion (one-mismatch) links, too, cf. Fig. 12.

13

We thus deﬁne a renormalized graph R(G1
and edges. It follows directly from our construction that R(G1
To describe random graphs we apply the following majority rule: a super vertex on G1
d
is considered as occupied if at least two connected vertices of the corresponding 4-loop on
G1
d+2 are occupied, i.e. this 4-loop is said to percolate. On the basis of this rule we obtain

d+2) composed of the above explained vertices

d+2) is equivalent to G1
d.

p′ = 4p2(1 − p)2 + 4p3(1 − p) + p4 ,

(A1)

where p′ denotes the (renormalized) probability that vertices of (G) are occupied if vertices
on G were diced with probability p.
−√5)/2, and 1. Thus, as the
only unstable solution in [0, 1] we have p∗ = (3 − √5)/2 as a ﬁrst approximation for the

Calculating ﬁxed points of eq. (A1) we obtain p∗ = 0, (3+

connectivity threshold.

At this place one could pose the question whether only 4-loops are suited as a renormal-
ization cell. Indeed, it is also possible to summarize succussive renormalization steps to a
single great one, ordinary hypercubes of even dimension k < d form suitable cells as well.
On the other hand, condensing odd dimensional hypercubes to super vertices does not lead
to renormalized graphs R(G) that are equivalent to other base graphs of the sequence {G1
d}.
Altogether, this seems to be an eﬀect of diﬀerences between even and odd-dimensional base
graphs (see Sec. II).

Of course, renormalizing small cells entails some approximation. Grouping together
vertices and applying a majority rule to occupy the renormalized vertices, situations can
arise where clusters on the original lattice are cut or new clusters are formed [31].

There are diﬀerent approaches to improve the involved approximations. One possibility
suggested in [32] which leads to exact results in the limit of very large cells is to summarize
some elementary cells to one large cell of size z. This large cell will then be occupied if all
elementary cells are occupied and connected, i.e. are said to percolate. Since ’renormaliza-
tion faults’ are essentially due to cell surface eﬀects improvements produced by the above
method emanate from the declining surface-volume ratio of large cells. For one-mismatch
graphs it holds, however, that the surface size of a cell s(z) depends logarithmically on z,
viz. s(z) ≈ d + 1 − log2 z leading to only slight improvements with increasing z.

Using larger elementary cells consisting of two coupled 4-loops we obtain

(p′)2 = p8 + 8p7q + 24p6q2 + 32p5q3 + 12p4q4 ,

(A2)

using four coupled 4-loops yields

(p′)4 = p16 + 16p15q + 112p14q2 + 448p13q3 + 1120p12q4 +

+ 1792p11q5 + 1776p10q6 + 1008p9q7 + 180p8q8

(A3)

where q = 1 − p. As ﬁxed points p′ = p of (A2) and (A3) we determined numerically
p ≈ 0.41 and p ≈ 0.39, respectively. The diﬀerence of both values to pconn = 0.5 may be a
consequence of the above mentioned slow convergence.
More interestingly, our renormalization procedure of replacing hypercubes of dimension
k by super vertices is without modiﬁcations applicable to ordinary hypercubes as well. This
gives an additional argument that the connectivity thresholds of both sequences of graphs
are equal which can also be veriﬁed by evaluating eq. (22).

14

REFERENCES

[1] N.K. Jerne, Ann. Immunol. (Inst. Pasteur) 125 C, 373-389 (1974).
[2] P. J. Ruiz et al., Nature Medicine 6, 710-712 (1998).
[3] C.A. Bona, Proc. Soc. Exp. Biol. Med. 213, 32-42 (1998).
[4] R.J. de Boer, A.U. Neumann, A.S. Perelson, L.A. Segel, and G. Weissbuch, in Mathe-
matics Applied to Biology and Medicine (Wuerz Publishing, Winnipeg, 1993), pp. 243-
258.

[5] A.S. Perelson, in Cell to Cell signalling: From Experiments to Theoretical Models (Aca-

demic Press, 1989), 261-271.

[6] A. Coutinho, Immunol. Rev. 110, 63-81 (1989).
[7] A.S. Perelson and G. Weisbuch, Rev. Mod. Phys. 69, 1219-1267 (1997).
[8] A. Neumann and G. Weisbuch, Bull. Math. Biol. 54, 699-726 (1992).
[9] K. Lippert and U. Behn, in Ann. Rev. Comp. Phys., Vol. V, edited by D. Stauﬀer

(World Scientiﬁc, Singapore, 1997), 287-311.

[10] K. Lippert, Dissertation, Universit¨at Leipzig (1994).
[11] I.R. Cohen, Immunology Today 12, 490-494 (1992).
[12] F.J. Varela and A. Coutinho, Immunology Today 5, 159-165 (1991).
[13] B. Sulzer, J.L. van Hemmen, and U. Behn, Bull. of Math. Biology 56, 1009-1040 (1994).
[14] J.D. Farmer, N.H. Packard, and A.S. Perelson, Physica D 22, 187-204 (1986).
[15] A.S. Perelson and G.F. Oster, J. Theor. Biol. 81, 645-670 (1979).
[16] D. Stauﬀer and A. Aharony, Perkolationstheorie:

eine Einf¨uhrung (VCH, Wein-

heim,1995).

[17] I.A. Campbell, J-M. Flesselles, R. Jullien, and R.Botet Phys. Rev. B 37, 3825-3828

(1988).

[18] J. Stewart and F.J. Varela, Immunol. Rev. 110, 37-61 (1989).
[19] F.J. Kearney and M.Vakil, N. Nicholson, In: Evolution and vertebrate immunity: The
antigen receptor and MHC gene families, edited by G. Kelsoe and D. Schulze, (Austin
Texas, 1987), 175-190.

[20] M.E. Fisher and J.W. Essam, J. Math. Phys. 2, 609-619 (1960).
[21] D.S. Gaunt, M.F. Sykes, and H. Ruskin, J. Phys. A 9, 1899-1911 (1976)
[22] B. Bollob´as, Random Graphs (Academic Press, London, 1985).
[23] M. Cheon, M. Heo, I. Chang, and D. Stauﬀer, Phys. Rev. E 59, 4733-4736 (1999).
[24] C. Reidys, PhD thesis, Friedrich–Schiller–Universit¨at Jena (1995).
[25] C. Reidys, P. F. Stadler, and P. Schuster, Bull. Math. Biol. 59, 339-397 (1997).
[26] G.R. Weisbuch, R. De Boer, and A.S. Perelson, J. Theor. Biol. 146, 483-499 (1990).
[27] A. Neumann and G. Weisbuch, Bull. Math. Biol. 54, 21-44 (1992).
[28] R.W. Anderson, A. Neumann, and S. Perelson, Bull. Math. Biol. 55, 1091-1131 (1993).
[29] P.H. Richter, Eur. J. Immunol. 5, 350-354 (1975).
[30] M. Brede, Master Thesis, Universit¨at Leipzig (1999).
[31] P.J. Reynolds, H.E. Stanley, and W. Klein, Phys. Rev. Lett. 10, L167-L172 (1977).
[32] P.J. Reynolds, H.E. Stanley, and W. Klein, Phys. Rev. B 21, 1223-1245 (1980).

15

FIGURES

FIG. 1. Comparison between a hypercube (left side) and the one-mismatch base graph (right
side) which have the same set of vertices (d = 3). Solid lines connect perfectly complementary
vertices, dashed lines mean one-mismatch links.

FIG. 2. One-mismatch base graph in d = 5. Same notation as in Fig. 1.

1e+10

8e+09

s
s
a
m

6e+09

4e+09

2e+09

0

0

d=34
d=35

5

10

distance s

15

20

FIG. 3. Mass distribution for base graphs of even (d = 34) and odd (d = 35) dimension. Points

have been connected to guide the eyes.

16

)
|

C

|
(
p

0.0003

0.00025

0.0002

0.00015

0.0001

0.00005

0

0

p=0.3
p=0.2
p=0.1

20

40

60

80

100

cluster size |C|

FIG. 4. Cluster size distribution depending on the occupation probability p = 0.1, 0.2, 0.3 for

base graphs in 8 dimensions. The histogram was taken over 105 conﬁgurations.

)
|

C

|
(
p

0.01

0.001

0.0001

1e-05

1e-06

1e-07

1e-08

1

d=10,p=0.112
d=14,p=0.08

10

100

cluster size |C|

FIG. 5. Cluster size distribution on G1

10 and G1

14 at the percolation thresholds. The simulation

data are plotted on doubly logarithmic scales.

)
|

C

|
(
p

0.01

0.001

0.0001

1e-05

1e-06

1e-07

1

d=12, p=0.013
d=10, p=0.017

10

cluster size |C|

100

FIG. 6. Illustration of ﬁnite size scaling laws for the two-mismatch-graphs G2

10 and G2

12. Data

sets are plotted on doubly logarithmic scales.

17

1

f

1

10

cluster size |C|

100

FIG. 7. Simulation results for the fragmentation rate f on G1

10 depending on the cluster size
|C| at pc ≈ 0.112. Data are plotted on doubly logarithmic scales. Fitting a power law (dashed
line) yields λ ≈ 0.12.

FIG. 8. Visualization of diﬀerent cluster structures. The circles symbolize strongly connected
subclusters (heaps). Left hand side: the cluster consists of several weakly connected heaps. Right
hand side: The cluster contains one heap only.

)
d
e
z

i
l

a
m
r
o
n
(
 
s
s
a
m

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

0

p=0.4
p=0.3
p=0.2
p=0.15
p=0.1

5

10

15

20

25

30

distance dG

FIG. 9. Simulation results for the mass distribution on G1
9

p = 0.1, 0.15, 0.2, 0.3, 0.4.
masses have been divided by the cluster size |C|. Points have been connected to guide the eyes.

for varying probabilities
In order to make results for diﬀerent p’s comparable on same scales

18

1.7

1.6

1.5

1.4

1.3

1.2

1.1

>
<

t

1

0

0.05

0.1

0.15

0.25

0.3

0.35

0.4

0.2
p

FIG. 10. Mean value hti of
edge-elimination procedure for G1

the resulting great

fragments after application of

the

9 depending on the occupation probability p.

>
<

t

16

14

12

10

8

6

4

2

0

d=6 
d=8 
d=10

0

0.05

0.1

0.15

0.2

0.25

p

FIG. 11. Mean value hti of the resulting great fragments for the two-mismatch-graphs G2

6, G2
8
10 depending on p. Except a shift towards smaller values of p the results are similar to those

and G2
on one-mismatch-graphs

B ; 1; 0

B ; 0; 0

B ; 1; 1

B ; 0; 1

A; 0; 1

A; 1; 1

R

B

A

A; 0; 0

A; 1; 0

FIG. 12. Illustration of the renormalization procedure applied to a pair of connected 4-loops on
d. If dH (B, A) = 0 the dotted edges correspond

d+2 leading to a pair of linked super vertices on G1

G1
to inversion links, if dH(B, A) = 1 to one-mismatch links.

19

