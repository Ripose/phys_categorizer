7
0
0
2
 
n
a
J
 
3
2
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
1
6
2
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Measuring spike train synchrony

Thomas Kreuz,1, ∗ Julie S. Haas,2 Alice Morelli,3 Henry D. I. Abarbanel,2, 4 and Antonio Politi5
1Istituto dei Sistemi Complessi - CNR, Via Madonna del Piano 10, I-50019 Sesto Fiorentino, Italy
2Institute for Nonlinear Sciences, University of California, San Diego, USA
3Istituto Nazionale di Ottica Applicata, Firenze, Italy
4Department of Physics and Marine Physical Labaratory (Scripps
Institution of Oceanography), University of California, San Diego, USA
5Istituto dei Sistemi Complessi - CNR, Sesto Fiorentino, Italy
(Dated: September 26, 2013)

Estimating the degree of synchrony or reliability between two or more spike trains is a frequent
task in both experimental and computational neuroscience. In recent years, many diﬀerent methods
have been proposed that typically compare the timing of spikes on a certain time scale to be ﬁxed
beforehand. Here, we propose the ISI-distance, a simple complementary approach that extracts
information from the interspike intervals by evaluating the ratio of the instantaneous frequencies.
The method is parameter free, time scale independent and easy to visualize as illustrated by an
application to real neuronal spike trains obtained in vitro from rat slices.
In a comparison with
existing approaches on spike trains extracted from a simulated Hindemarsh-Rose network, the ISI-
distance performs as well as the best time-scale-optimized measure based on spike timing.

Keywords: time series analysis; spike trains; event synchronization; reliability; clustering; neuronal coding

I.

INTRODUCTION

The basic elements of neuronal communication are
pulsed electric signals called action potentials or spikes.
Under the assumption that both the shape of the spike
and the background activity carry minimal information,
neuronal responses are typically reduced to the much sim-
pler form of a spike train, where the only information
maintained is the timing of the single spikes. Measuring
the overall degree of synchrony between diﬀerent spike
trains is an important tool in many diﬀerent contexts.
It can be used to quantify the reliability of responses
upon repeated presentations of the same stimulus [1], to
address questions regarding the limitations of neuronal
coding (rate versus time coding) [2] or to evaluate the
information transfer between synaptically coupled neu-
rons (cf., e.g., Ref. [3]).

A variety of diﬀerent measures have been introduced
to address the synchrony between spike trains. Most of
these measures require considering a large number of tri-
als, not just two. Some of them rely on the construction
of a post-stimulus time histogram (PSTH), constructed
from multiple trials. PSTH measures such as reliabil-
ity, precision and sparseness [1, 4] rely on the analyst
to deﬁne the so-called events, i.e., bursts of high ﬁring
frequency. Other methods (i) quantify the occurrence of
given spike patterns and measure their robustness (“at-
tractor reliability” [5]), (ii) exploit the deviation of the
spike train statistics from a Poissonian distribution [6, 7],
or (iii) measure the normalized variance of pooled expo-
nentially convolved spike trains [8].

The focus of this study lies on a group of measures

∗Electronic address: thomas.kreuz@ﬁ.isc.cnr.it

that aim at a quantiﬁcation of the degree of similarity or
dissimilarity between as few as two spike trains. A very
prominent example of such bivariate approaches are spike
train distances that consider spike trains to be points in
an abstract metric space and assign non-negative val-
ues quantifying the dissimilarity between a given pair
of spike trains. Among these is the distance introduced
by Victor and Purpura [9], which evaluates the “cost”
needed to transform one spike train into the other, using
only certain elementary steps. Another metric proposed
by van Rossum [10] measures the Euclidean distance be-
tween the two spike trains after convolution of the spikes
with an exponential function. Other approaches quantify
the cross correlation of spike trains after exponential or
Gaussian ﬁltering [11, 12], or exploit the exponentially
weighted distance to the nearest neighbor [13]. A com-
mon property of all these measures is the existence of
one parameter that sets the time scale for the analysis.
This parameter does not exist for event synchronization,
a method proposed by Quian Quiroga and colleagues
[14], that quantiﬁes the number of quasi-simultaneous
appearances, using a variable time scale that automati-
cally adapts itself to the local spike rates.

In this study a measure is proposed that, complemen-
tary to the approaches mentioned above, uses the inter-
spike interval (ISI) instead of the spike as the basic ele-
ment of comparison. The ISI-distance quantiﬁes the ratio
of instantaneous frequencies and facilitates visualization
of the relative timing of pairs of spike trains. Since no
binning is used, the measure has the maximum possi-
ble time resolution (i.e., up to a single spike). Similar to
event synchronization, it is both parameter–free and self-
adaptive so that there is no need to ﬁx a time scale be-
forehand. In the ﬁrst part of this study, the ISI-distance
is illustrated using real in vitro data from cortical cells.
Moreover, since a comprehensive comparison of diﬀer-
ent approaches in a controlled setting was still missing,

we tested several bivariate measures of spike train syn-
chrony (including the ISI-distance) on a large number of
spike trains. These were generated from a network of sim-
ulated Hindemarsh-Rose neurons with a pre-determined
degree of coupling between pairs. In this scenario, dif-
ferent spike trains belonged to diﬀerent clusters and the
capability of the measures to detect the original cluster-
ing behavior could be quantiﬁed by two indices, which
evaluate the correctness of the clusters and the separa-
tion between them, respectively. In a ﬁnal step, to assess
the similarity of the diﬀerent approaches to measure spike
train synchrony, we evaluated the degree of redundance
between the diﬀerent measures by means of a correlation
analysis.

The remainder of the paper is organized as follows:
In the methods section, after a short description of the
spike detection algorithm (Section II A), a more detailed
description of the new method based on the ISI-distance
is given (Section II B).
It is illustrated using in vitro
recordings from cortical cells in the entorhinal cortex
of rats. The following section, II C, contains a short
overview over the existing measures against which this
new method is compared. The cluster analysis is de-
scribed in Section II D, while the correlation analysis is
described in section II E. In section III A the actual com-
parison of the diﬀerent methods on simulated time series
taken from a network of Hindemarsh-Rose model-neurons
is carried out. Conclusions are drawn in section IV. Fi-
nally, both data sets (the in vitro recordings and the
simulated Hindemarsh-Rose time series) are described in
the appendix in sections A 1 and A 2, respectively.

II. METHODS

A. Spike detection

A prerequisite to any method is the extraction of the
spike times from the time series by means of a standard
spike detection algorithm. Typically, some sort of thresh-
old criterion is employed, either for the time series itself
or its derivative. Thereby the continuous time series is
transformed into a discrete series of spikes. Each spike
train can then be expressed as a series of δ functions

S(t) =

δ(t − ti)

(1)

M

i=1
X

with t1, ...tM denoting the series of spike times and M
being the number of spikes.

In this study, for all the diﬀerent measures the same
spike detection algorithm is used. The threshold is cho-
sen as the arithmetic average between the minimum and
maximum value of the action potential.

2

(4)

(5)

B. The ISI-distance

To obtain a time-resolved measure of the frequency of
i }, the value of the current interspike

the spike train {tx
interval is assigned to each time instant [29],

i |tx

i |tx

i < t)

xisi(t) = min(tx

i > t) − max(tx

1 < t < tx
tx
M
(2)
Now, given a second spike train {ty
j }, the ratio between
xisi and yisi is taken (eﬀectively, this is done just once
after every new spike in either time series), and the ﬁnal
measure is thereby obtained after introducing a suitable
normalization,

I(t) =

(

xisi(t)/yisi(t) − 1
−(yisi(t)/xisi(t) − 1)

if xisi(t) <= yisi(t)
else

(3)
Accordingly, the measure becomes zero in case of iso-
frequent behavior, and approaches −1 and 1, respec-
tively, if the spiking frequency of the ﬁrst (or second)
train is inﬁnitely high and the other inﬁnitely low.

In order to derive a measure of spike train distance,
there are two possible ways of averaging. In the time-
weighted variant, the absolute ISI-distance is integrated
over time,

DI =

dt|I(t)|,

T

t=0

Z

M

Ds

I =

|I(ti)|.

whereas in the spike-weighted variant, the ISI-distance is
evaluated only after every new spike in either time series,

i=1
X
All of these procedures can also be implemented by us-
ing a moving-window analysis. The advantage of this
method is the self-adaptation to the shortest possible
time-scale and thus can be implemented for rather short
time series. On the other hand, in the case of a strong
sensitivity to short time scales, one can easily obtain a
coarse-grained evolution, by extending the deﬁnition to
neighboring ISIs. An example of a possible application is
the quantiﬁcation of (dis-)similarities between bursts in
time series.

In Fig. 1 the ISI-distance is applied to two exemplary
input-output spike trains of 10 s duration (for a descrip-
tion of the data see Appendix A 1). In the ﬁrst seconds,
the spike trains are 1 : 1 synchronized and this is re-
ﬂected by an ISI-distance I(t) ≈ 0. Nevertheless, small
deviations can be visualized that are hard to catch from
a visual inspection of the spike trains themselves. These
deviations are more pronounced in the second half of the
recording where the output no longer follows the input
but rather slows down (as reﬂected by predominantly
negative values marked in red) and a spike doublet occurs
(as indicated by the short excursion to positive values

1

2

3

4

6

7

8

9

1

2

3

4

6

7

8

9

5
Time [s]

5
Time [s]

FIG. 1: First example of cortical cell recordings. In the middle
traces the two recorded time series are shown. The detected
spikes are marked in blue (input) and red (output), respectively.
On top the ISI-values according to Eq. 2 are depicted, at the
bottom the corresponding renormalized ISI-distance (cf. Eq. 4).
Here colors mark the times where the respective spike train is
slower. For this pair of spike trains an ISI-distance DI = 0.062
is obtained.

0.406

ISIs

Input

Output

Ratio

−1

0

0.64

ISIs

Input

Output

Ratio

−1

0

0

1

0

0

1

0

1

2

3

4

6

7

8

9

5
Time [s]

FIG. 2: Second example of cortical cell recording shown in the
same way as in Fig. 1. In this case the ISI-distance attains the
value DI = 0.15.

marked in blue). The example shown in Fig. 2 reveals
that certain patterns in the ISI-distance appear repeat-
edly. The output exhibits several spike doublets, some of
which are followed by a miss (reﬂected by the negative
values marked in red). Finally, a more irregular behavior
is shown in Fig. 3 where it is again clear that the ISI-
distance allows tracing the relative frequency behavior
in a simple way.

3

0.586

ISIs

Input

Output

0

1

0

Ratio

−1

0

FIG. 3: Third example of cortical cell recording shown in the
same way as in Fig. 1. The ISI-distance for this example is
DI = 0.32.

C. Existing measures of spike train distance

In this study the ISI-distance will be compared against
ﬁve existing measures of spike train (dis-)similarity.
These comprise the spike train metrics introduced by
Victor and Purpura [9] as well as by van Rossum [10], a
correlation measure proposed by Schreiber and colleagues
[12], another distance measure introduced by Hunter and
Milton [13], and, ﬁnally, event synchronization, a method
introduced by Quian Quiroga and colleagues [14].

In order to compare the various measures, we turned
each of them into a suitably-normalized measure of dis-
similarity, as the latter is more akin to the concept of
distance.

1. Victor-Purpura spike train metric

The spike train metric DV introduced in Ref.

[9] de-
ﬁnes the distance between two spike trains in terms of
the minimum cost of transforming one spike train into
the other by using just three basic operations: spike in-
sertion, spike deletion and spike movement. While the
cost of insertion or deletion of a spike is set to one, the
cost cV of moving a spike is the only parameter of the
method setting the time scale of the analysis. For small
cV , the distance basically equals the diﬀerence in spike
number, whereas for high cV , the distance approaches the
number of non-coincident spikes, since instead of shift-
ing spikes it becomes more favorable to delete all non-
coincident spikes of the one time series and to insert all
non-coincident spikes of the other. Thus, by increasing
the cost cV , the distance is transformed from a rate dis-
tance to a timing distance.

4

(11)

(12)

2. Van Rossum spike train metric

5. Event synchronization

A second spike train metric was introduced in Ref. [10].
In this method, each spike is convolved with an exponen-
tial function e−(t−ti)/τR (t > ti), where ti is the spike
time. From the convolved waveforms f (t) and g(t), the
van Rossum distance DR can be calculated as

DR(τR) =

[f (t) − g(t)]2dt

(6)

∞

1
τR Z

0

Since the post-synaptic currents triggered by the single
spikes approximate exponentials, the van Rossum dis-
tance estimates the diﬀerence in the eﬀect of the two
trains on the respective synapses. In this method, the
time constant τR of the exponential is the parameter set-
ting the time scale. It is the inverse of Victor and Pur-
pura’s cost parameter: τR = 1/cV .

The last measure is a variant of the event synchro-
nization proposed in Ref.
[14], and later used in Refs.
[16, 17, 18]. This measure quantiﬁes the overall level
of synchronicity from the number of quasi-simultaneous
appearances of spikes. However, in contrast to the mea-
sures introduced above, this method is scale-free, since
the maximum time lag τij up to which two spikes tx
i and
ty
j are considered to be synchronous is adapted to the
local spike rates according to

τij = min{tx

i+1 − tx

i , tx

i − tx

i−1, ty

j+1 − ty

j , ty

j − ty

j−1}/2. (9)

Then the function c(x|y) is introduced to count the num-
ber of times a spike appears in x shortly after a spike
appears in y,

c(x|y) =

Jij,

(10)

Mx

My

i=1
X

j=1
X

3. Schreiber et al. similarity measure

where

[11], and later detailed in Ref.

The correlation-based approach was ﬁrst described in
Ref.
In this ap-
proach, each spike train is convolved with a ﬁlter of a
certain width (exponential in [11], Gaussian in [12]) to
form si before cross correlation and normalization.

[12].

if 0 < tx
i = ty
tx

j

1
1/2 if
0

else

Jij = 


i − ty

j ≤ τij

SS(σS) =

sisj
|si||sj|

.


With c(y|x) deﬁned accordingly, we can write the event
synchronization as

(7)

Haas and White allowed a minimal phase lag in the cross
correlation (and thus another parameter to adjust), while
Schreiber et al. allowed none. Here, the approach by
Schreiber et al.
is used. The width of the convolving
ﬁlter σS sets the time scale of interaction between the
two spike trains. The inversion DS = 1 − SS yields a
normalized measure of spike train dissimilarity that can
be compared with the other. A clustering analysis based
on this measure was performed in Ref. [15].

4. Hunter-Milton similarity measure

This approach, introduced in Ref. [13], starts by iden-
tifying in the spike train y the nearest spike ty
k(i) to the
spike occurring at time tx
in the spike train x. The de-
i
gree of coincidence between these spikes is quantiﬁed by
and the overall similarity
rxy = exp
measure SH is thereby determined as the symmetrized
(cid:17)
average ofrxy over the entire series,

k(i)|/τH

i − ty

−|tx

(cid:16)

SH =

hrxyi + hryxi
2

.

(8)

Also in this method, there is a free time scale that can be
set by ﬁxing the parameter τH . For two identical spike
trains rxy = ryx = 1. Accordingly, a measure of spike
train dissimilarity can be obtained as DH = 1 − SH

Q =

c(y|x) + c(x|y)
MxMy

.

Again, a measure of spike train distance can be deﬁned as
DQ = Q−1. With the above normalization, 0 ≤ DQ ≤ 1,
with DQ = 0 if and only if all spikes of the signals are
synchronous [30].

p

D. Assessing clustering quality

One important application for measures of spike train
synchrony is the identiﬁcation of interspike correlations
and the reconstruction of clustering patterns. In order to
test the above measures, we generated 29 spike trains by
simulating a network of Hindmarsh-Rose neurons (see ap-
pendixA 2). From the network architecture and the pat-
tern coding, we organized the 29 spike trains into three
principal clusters with 13 members (clusters 1 and 2) and
3 members (cluster S), respectively. We ﬁrst validated
the diﬀerent measures and then quantiﬁed their perfor-
mance in reproducing the cluster structure by means of
two indices. For the four measures DV , DR, DS and DH
that depend on a parameter setting the time scale, we
varied the respective parameter over several logarithmic
decades, with four equidistant values within each decade,
i.e., cV = 10−a+0.25b. In each case, we adapted the pa-
rameter range via a and b to cover the relevant extreme
cases.

L

A

0.2

e
c
n
a
t
s
i
D

0.3

0.25

0.15

0.1

0.05

0

L

M

L

S

L
2

C
2

C
1

L
1

C

S

S
i

S
j

S
k

Neuron

FIG. 4: Example of a hierarchical cluster tree obtained from 29
Hindemarsh-Rose time series employing the event distance DQ.
The three principal clusters C1, C2 and CS are distinguished
by diﬀerent colors. The merging of the ﬁrst two time series Si
and Sj to cluster Cα is highlighted by very thick blue lines, the
consecutive merging of this cluster with Sk by thick blue lines.
Finally, black lines mark the separation of the three principal
clusters used for the deﬁnition of the cluster-separation F . The
clustering performance values for this example are H = 1 and
F = 0.57.

After applying a given similarity measure to all pos-
sible pairs of spike trains, we generated a hierarchical
cluster tree (dendrogram) by applying the single linkage
algorithm provided by Matlab to the resulting pairwise
distance matrices. An exemplary dendrogram obtained
from the 29 Hindemarsh-Rose time series using the event
distance DQ is shown in Fig. 4. Three principal clusters
are clearly distinguished. The dendrogram is constructed
as follows: First, the closest pair Si, Sj of sequences is
identiﬁed and thereby linked by a ⊓-shaped line, where
the height of the connection measures the mutual dis-
tance d(Si, Sj). These two time series are merged into a
single element Cα, and the next closest pair of elements is
then identiﬁed and connected. The procedure is repeated
iteratively until a single cluster remains. The implemen-
tation of the method requires introducing the distance
between a pair of clusters Cα, Cβ. In the single linkage
algorithm, it is deﬁned as the minimum over all the dis-
tances between pairs of sequences in the two clusters, i.e.,
d(Cα, Cβ) = min{d(Sk, Sm)}, Sk ∈ Cα, Sm ∈ Cβ.

In order to quantify the success in reproducing this
clustering, we computed the entropy of the confusion ma-
trix Nαβ) [9, 19]. The entry Nαβ is deﬁned as the number
of times Sβ is the closest cluster to a spike train belonging
to Sα. Following Ref. [9], the distance between the spike
train Si and the cluster Cα is deﬁned as hd(Si, Sj)iα,
where h·ij denotes the average of all spike trains in the
cluster Cα. Note that this distance is diﬀerent from the
one used for the cluster identiﬁcation, however, we veri-
ﬁed that results proved to be robust against variations of
the distance used. For a perfect clustering N is diagonal,
whereas each misclassiﬁcation yields a non-diagonal ele-
ments. The relative amount of misclassiﬁcations is ﬁnally

5

quantiﬁed by the entropy

HC =

pαβ log

(13)

pαβ
PαQβ

Xα,β

b pbβ.
where pαβ = Nαβ/Ntot, Pα =
This entropy value is then normalized to the maximum
entropy obtained for a correct classiﬁcation [31],

b pαb, and Qβ =

P

P

H = HC/Hmax.

(14)

Although the clustering entropy H evaluates the correct-
ness of the hierarchical tree, it does not quantify the sepa-
ration of the three principal clusters in those cases where
the expected clustering is obtained. As can be seen in
Fig. 4, the cluster separation is given by the lengths L1,
L2, LS, and LM of their upper branches. A convenient
way of quantifying the cluster separation with a single
indicator is by introducing the index

F =

L1 + L2 + LS + LM
3LA

,

(15)

where the branch lengths are normalized to the diﬀerence
LA between the overall maximum and the overall mini-
mum distance thus guaranteeing that the F -values range
in the interval [0, 1]. Given a correct clustering with three
principal clusters, all quantities needed for the calcula-
tion of F can be extracted from the output matrix of the
Matlab single linkage algorithm, otherwise the clustering
separation is set to F = 0.

E. Correlations between the diﬀerent measures

In order to investigate to which extent the diﬀerent
measures of spike train distance carry independent and
non-redundant information, we performed a correlation
analysis. First, for each of the four measures DV , DR,
DS, and DH that depend on a parameter setting the
time scale, we identiﬁed the parameter value yielding
the best clustering results. Then, we applied each of
the six measures (DI , DV , DR, DS, DH , and DQ) to
the diﬀerent pairs of sequences, obtaining six sets of
29 × 28/2 = 406 diﬀerent values.
In order to guaran-
tee maximal homogeneity, the various measures were all
scaled to the [0, 1] range (this means that the two un-
normalized measures DV and DR were divided by their
maximal values). Moreover, following a customary ap-
proach, each data set was arcsin-transformed to better
ﬁt a normal distribution [20]. Finally, we determined the
Pearson correlation coeﬃcients [21] and from the pair-
wise distances (1-correlation) among the diﬀerent mea-
sures we obtained a hierarchical cluster tree (using again
the single-linkage algorithm).

6

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

0.5

1

1.5

2

2.5

3

0.5

1

1.5

2

2.5

3

Data points

4
x 10

Data points

4
x 10

FIG. 6: Same as Fig. 5 but this time for two time series from
two neurons coding for diﬀerent patterns.
In this case the ISI-
distance DI = 0.032 is much higher.

1428

ISIs

1a

2a

0

1

0

Ratio

−1

n
o
r
u
e
N

1a
1b
1c
1d
1e
1f
1g
1h
1i
1j
1k
1l
1m
Sa
Sb
Sc
2a
2b
2c
2d
2e
2f
2g
2h
2i
2j
2k
2l
2m

1431

ISIs

1b

1c

0

1

0

Ratio

−1

FIG. 5: Two time series from two neurons coding both for the
same pattern B (middle). The detected spikes are marked in blue
and red, respectively. On top the ISIs, at the bottom the corre-
sponding renormalized ISI-distance. Here colors mark the times
where the respective spike train is slower. For this combination
an ISI-distance DI = 0.019 is obtained.

III. RESULTS

A. Comparison of measures using simulated
Hindemarsh-Rose time series

In order to compare the various dissimilarity mea-
sures, we have analyzed also numerically generated spike
trains, since their properties are much more controllable.
More precisely, we refer to Hindemarsh-Rose time series
whose clustering properties are known beforehand (see
appendixA 2 for a description of the underlying model).
Two instances of the ISI-distance are shown in Figs. 5
and 6 where the signals emitted by two neurons belong-
ing to the same and to diﬀerent clusters, respectively, are
compared. In the ﬁrst example, deviations from zero of
the ISI-distance are conﬁned to short time scales (they
are mostly due to small phase shifts that accompany large
changes of the spiking-frequency). In the second exam-
ple, long-lasting diﬀerences are detected which also ex-
hibit a sort of oscillation.

The distance matrix obtained from the application of
the ISI-distance DI to all 406 combinations of the 29
spike trains is shown in Fig. 7. Patterns can be clearly
recognized, since the neurons have been ordered accord-
ing to to their a priori aﬃliation known from the model
setup. Smallest distances are obtained for pairs of spike
trains belonging to the same cluster starting from those
within S. At the other extreme, the largest distances are
found for spike trains belonging to the clusters 1 and 2.
From this distance matrix, we generated the cluster
dendrogram shown in Fig. 8, where the three principal
clusters are clearly visible. The absence of misclassiﬁca-
tions implies that the clustering entropy (computed ac-
cording to Eqs. (13,14)) is H = 1. On the other hand,

1a 1b 1c 1d 1e 1f 1g 1h 1i 1j 1k 1l 1mSa Sb Sc 2a 2b 2c 2d 2e 2f 2g 2h 2i 2j 2k 2l 2m
Neuron

FIG. 7: Distance matrix for 29 time series from the Hindemarsh-
Rose model. Results are obtained by using the ISI-distance DI .
Neurons are labelled by ’1’, ’2’ and ’S’, respectively, depending
on their aﬃliation to pattern 1, 2 or both (’shared’).

the cluster separation determined from Eq. (15) is for
this case F = 0.66. Similar results have been obtained
for the other parameter-free measure, the event distance
DQ (the corresponding dendrogram being shown in Fig.
4). Also in this case, H = 1, while the smaller value of
F (0.60) suggests a slightly lower clustering quality.

We then investigated the performance of the Victor-
Purpura and van Rossum spike train distances, as well
as of the Schreiber et al. and Hunter-Milton dissimilar-
ities for diﬀerent values of the free parameter in order
to select the proper time scale.
In Fig. 9 the Victor-
Purpura spike train distance DV is plotted against the
cost parameter cV for all pairs of spike trains in a group
containing three members in each of the three principal
clusters. The relative order of the six diﬀerent combina-

Sa Sb Sc 2a 2e 2m 2b 2j 2i 2k 2d 2h 2l 2f 2g 2c 1a 1c 1d 1i 1j 1b 1h 1m 1f 1l 1g 1k 1e
Neuron

−5

10

−4

10

−3

10

−1

10

0
10

−2

10

c
V

FIG. 8: Clustering of 29 time series from the Hindemarsh-Rose
model using the ISI-distance. The existence of three clearly sep-
arated clusters is evident. The cluster performance values are
H = 1 and F = 0.66.

e
c
n
a
t
s
i
D

0.3

0.25

0.2

0.15

0.1

0.05

0

2
10

1
10

V

D

−5

10

−4

10

−3

10

−1

10

0
10

−2

10

c
V

FIG. 9: Dependence of the Victor-Purpura spike train distance
DV on the cost parameter cV . For each combination of cluster
aﬃliations a diﬀerent color is used. The dotted line marks the
cost value for which the best clustering separation is obtained.

tions of cluster aﬃliations (1 − 1, 1 − 2, 1 − S, 2 − 2,
2 − S, S − S) depends on the cost parameter. At small
cV values, the Victor-Purpura distance measures the dif-
ference in spike counts and this number seems not to be
closely related to the type of underlying cluster (see in
particular the spread of the DV -values corresponding to
the 1 − 2 combination). At high cV values, distances are
larger and also very mixed.
It is only at intermediate
values that a clear separation of the six diﬀerent cluster
combinations can be observed. High values are obtained
for all the 1−2 combinations while the intra-cluster S −S
distance is the smallest one.

We ﬁnd similar results for the other parameter–
dependent measures. In all cases, there exists an inter-
mediate parameter range where meaningful results can
be obtained (i.e. the cluster entropy is equal to 1), while
for higher and lower values no clear clustering can be

e
c
n
a
m
r
o
f
r
e
P
g
n
i
r
e
t
s
u
C

l

 

1

0.8

0.6

0.4

0.2

0

1−1
2−2
S−S
1−S
2−S
1−2

7

H
F

FIG. 10: For the Victor-Purpura spike train distance the cluster-
ing entropy H (solid line) and the cluster separation F (dashed
line) in dependence of the parameter cV that sets the time scale.
Remember that F is only calculated for those cases where a cor-
rect clustering (as reﬂected by H = 1) is obtained. The optimum
performance F = 0.68 is marked by a large asterisk at cV = 0.01.

recognized. The role of the free parameter is better seen
by determining the clustering performance for diﬀerent
values of the parameter itself. In Fig. 10, the two indices
H and F are plotted for the Victor-Purpura distance DV
versus the cost parameter cV . We see that a perfect clus-
tering is found only inside an intermediate range, where
H = 1; the smaller H values found outside this interval
reﬂect the presence of misclassiﬁcations in the clustering
tree. Inside the interval where the right classiﬁcation is
obtained, we computed the clustering separation F . This
index attains its peak value F = 0.68 when cV = 0.01,
which we thus identify as the optimal value of the time-
scale for the separation the diﬀerent clusters. This result
is consistent with the visual impression when looking at
Fig. 9 (the vertical line corresponds to the optimal cV
value). A similar scenario is found also for the other
measures that depend on a time scale. In each case there
exists an intermediate range where H = 1. The broad-
est range is found for the Victor-Purpura and the van
Rossum distance.

The performance of the diﬀerent measures are com-
pared in Fig. 11, where the maximum value of the clus-
ter separation is shown for each spike train distance (for
the parameter-free ISI-distance and the event distance no
optimization is required). The best results are found for
the Victor-Purpura distance DV , but the ISI-distance DI
and the van Rossum distance DR perform almost equally
well. At the other extreme, the poorest cluster separation
is obtained for the Hunter-Milton dissimilarity DH.

B. Correlations between the diﬀerent measures

In order to assess the degree of redundancy among the
diﬀerent measures of spike train dissimilarity, a correla-
tion and cluster analysis has been performed on all 406

8

n
o
i
t
a
r
e
p
e
S
 
r
e
t
s
u
C

l

e
r
u
s
a
e
M

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

D
I

D

V

D

R

D

S

D

H

D

Q

e
c
n
a
t
s
i
D

0.04

0.035

0.03

0.025

0.02

0.015

0.01

0.005

0

D
I

D
V

D

R

D
S

Measure

D

H

D

Q

FIG. 11: Comparison of Measures: Separation of clusters.

1

0.99

0.98

0.97

0.96

0.95

0.94

0.93

0.92

0.91

D

V

D

R

D

H

D
I

D

Q

D

S

Measure

FIG. 13: Clustering for the six measures of spike train dissimi-
larity.

IV. DISCUSSION

In this study we propose a simple method for measur-
ing the (dis-)similarity of two spike trains. As an esti-
mator based on the relative sizes of interspike intervals,
the ISI-distance is complementary to all spike-based mea-
sures of synchrony that quantify the simultaneous occur-
rences of spikes via some sort of coincidence detection.
As illustrated by an application to in vitro recordings
of cortical cells, the measure serves also as an excellent
means to visualize the occurrence of spiking pattern in
the respective spike trains.

In order to judge the relative merit of the diﬀerent
methods, we compared the methods by evaluating each
of them on spike trains extracted from a network of sim-
ulated Hindemarsh-Rose neurons. We assessed the abil-
ity of the diﬀerent measures to reproduce the original
clustering (established by a priori adjusting the synap-
tic couplings in the model) by means of two indices. In
this comparison, no measure fails in reproducing the ex-
pected clustering, however, we found subtle diﬀerences in
the degree of separation among the three clusters. The
ISI-distance performed as well as the best spike-based
measure (the Victor-Purpura distance DV ) with the ad-
vantage of not requiring the optimization of any param-
eter.
In fact, the ISI-distance, like event synchroniza-
tion, is self-adaptive in that it automatically identiﬁes
the proper time scale.

Finally, we implemented a correlation analysis in order
to evaluate the degree of independence among the six dif-
ferent measures of spike train similarity. Since the overall
level of correlation is quite high, all measures apparently
access similar information. The subsequent cluster anal-
ysis reveals that the ISI-distance is the most independent
approach. This is not surprising since the ISI-distance is
the only measure that can be regarded as a measure of
rate coding (since it is built on instantaneous frequency

D
I

D

V

D

H

D

Q

D

R

D

S
Measure

FIG. 12: Correlation coeﬃcients between the six measures of
spike train dissimilarity.

bivariate combinations of measure results by following
the approach discussed in the previous section. Since
the number of independent observations can hardly be
estimated, this is only a relative examination. For this
reason no values of signiﬁcance are given.

As we see from the high overall level of correlation
shown in Fig. 12, all measures seem to carry similar in-
formation. The minimum correlation coeﬃcient 0.91 is
obtained between the ISI-distance and the Hunter-Milton
dissimilarity, while the spike train distances by Victor-
Purpura and van Rossum appeared to be the most corre-
lated measures. From the corresponding cluster tree (cf.
Fig. 13), it becomes evident that the ISI-distance is the
most independent measure, whereas the other measures
belong to one big cluster. This reﬂects the fact that the
ISI-distance is derived from interspike intervals, while the
other measures are based on spike times.

estimates) whereas all other measures (that are based
on spike timing) can be interpreted as measures of time
coding.

Some general remarks concerning the application of
measures of spike train (dis-)similarity: First, although
the focus of this study is on the estimation of similar-
ity between just two spike trains, all methods can also
be used within a multivariate context. For example, in
order to assess the reproducibility of neural spike train
responses to an identical stimulus across many diﬀerent
presentations (trials), reliability can be deﬁned as the
average over all pairwise correlation-values (as done in
Refs.
[11, 12, 13]). On the other hand, it should be
noted that the ISI-distance, like all the other measures,
can be fooled by phase lags, no matter whether these are
caused by internal delay loops in one spike train or by a
common driver that forces the two time series with diﬀer-
ent delays. Thus any such phase lags should be removed
by suitably shifting the time series before computing the
measures.

The comparisons carried out in this study constitute an
important step towards the identiﬁcation of the most ap-
propriate spike train (dis-)similarity for an application to
real data. From the observed performance values and the
results of the correlation analysis, we conclude that the
ISI-distance together with either one of the spike based
measures, such as the Victor-Purpura or the van Rossum
spike train distance, or event synchronization is the most
appropriate choice. However, it should also be noted that
other possible criteria for the selection of an appropri-
ate measure, such as computational cost or robustness
against noise, remain to be evaluated in future studies.

APPENDIX A: DATA

1. Application to in vitro recordings of cortical
cells

The ISI-distance is illustrated using in vitro whole-
cell recordings taken from cortical cells from the layer
2 medial entorhinal cortex of young Long-Evans rats. In
these experiments (conducted as approved by the UCSD
IACUC) cortical cells were selected from a slice prepa-
ration (400 micron) by their superﬁcial position, as well
as particular characteristics of their electrophysiological
responses to long current steps (cf. Ref. [11]). Intracel-
lular signals were ampliﬁed, low pass ﬁltered, and dig-
itized at 10 kHz via software created in LabView (Na-
Inputs were delivered as synaptic
tional Instruments).
conductances through a linux-based dynamic clamp [22].
Inputs were comprised of synaptic inputs added to an
underlying DC depolarization. The amplitude of the DC
depolarization was tailored for each cell to elicit a spike
rate of 5 − 10 Hz. Synaptic inputs were of the form
Isyn = GsynS(Vm − Vsyn) where S follows the diﬀeren-
tial expression dS/dt = α(1 − S) = βS; α = 500/ms,
β = 250/ms, Vsyn = 0mV . Gsyn was tailored for each

9

cell to be peri-threshold and elicit a spike with probabil-
ity between 50 and 100%. Synaptic events were delivered
for 10 seconds at either regular intervals or chaotic inter-
vals; the latter intervals were taken from a set of ﬁve 60
second recordings of SC spike times in response to steady
DC depolarization alone.

2. Hindemarsh-Rose simulations

The spike trains have been generated using time se-
ries extracted from a larger network of Hindemarsh-Rose
(HR) model-neurons [23] in the chaotic regime. This net-
work was originally designed to analyze semantic mem-
ory representations using feature-based models; details of
the network architecture and the implementation of the
feature coding can be found in Ref. [24].

In short, the state the neuron i is determined by three
ﬁrst-order diﬀerential equations describing the evolution
of the membrane potential Xi, the recovery variable Yi,
and a slow adaptation current Zi,

˙Xi = Yi − X 3
˙Yi = 1 − 5X 2
˙Zi = 0.006[4(Xi − 1.6) − Zi],

i + 3X 2
i − Yi

i − Zi + Ii + αi(t) − βi(t)(A1)
(A2)

(A3)

where

and

αi(t) =

wij Aj(t)

(A4)

b
F (

c
M −1)

j=1
X

βi(t) =

1

F − 1

b
F −1

A(i)

k (t).

(A5)

b

b

b

c

The network consisted of

Xk=1
N = 128 HR neurons be-
longing to
F = 8 neu-
M = 16 diﬀerent modules with
rons each. In a learning stage, input memory patterns
were stored by updating the synaptic connection weights
wij between diﬀerent neurons using a Hebbian mecha-
nism based on the activity variables Aj. During the re-
trieval stage in which the learned connection weights were
kept constant, the 29 time series to be analyzed were ex-
tracted. According to their coding properties regarding
the retrieval of two distinguished memory patterns, the
29 time series belonged to three principal clusters, 13 of
the corresponding neurons coded for pattern 1 only, 13
coded for pattern 2 only and 3 coded for both patterns
(shared). The respective time series were labelled by ’1’,
’2’ and ’S’ followed by an index letter. The numerical
integration was done by using a ﬁxed-step fourth-order
Runge-Kutta method. The integration step-size was cho-
sen equal to 0.05 ms of real time. The length of the time
series analyzed was 32768 data points.

Acknowledgements We thank S. Luccioli, A. Torcini
and K. Ulbrich for useful discussions and P. Grassberger
for carefully reading this manuscript. TK has been sup-

ported by the Marie Curie Individual Intra-European Fel-
lowship ”DEAN”, project No 011434. JSH acknowledges
ﬁnancial support by the San Diego Foundation.

10

[1] Mainen, Z., Sejnowski, T. J., 1995. Reliability of spike

diﬀerent approaches. Phys D 225, 29.

timing in neocortical neurons. Science 268, 1503.

[19] Abramson, N., 1963. Information theory and coding.

[2] Rieke, F., Warland, D., de Ruyter van Steveninck, R.,
Bialek, W., 1996. Spikes: Exploring the neural code. In-
stitute of Technology, Cambridge, Massachusetts.

[3] Reyes, A. D., 2003. Synchrony-dependent propagation of
ﬁring rate in iteratively constructed networks in vitro.
Nature Neurosci 6, 593.

[4] Berry, M. J., Warland, D. K., Meister, M., 1997. The
structure and precision of retinal spike trains. Proc. Natl.
Acad. Sci. USA 94, 5411.

[5] Tiesinga, P. H. E., Fellous, J. M., Sejnowski, T. J.,
2002. Attractor reliability reveals deterministic structure
in neuronal spike trains. Neural Comput. 14, 1629.
[6] Brenner, N., Strong, S. P., Koberle, R., Bialek, W., de
Ruyter van Steveninck, R. R., 2000. Synergy in a neural
code. Neural Comput 12, 1531.

[7] Tiesinga, P. H. E., 2004. Chaos-induced modulation of
reliability boosts output ﬁring rate in downstream corti-
cal areas. Phys. Rev. E 69, 031912.

[8] Hunter, J. D., Milton, G., Thomas, P. J., Cowan, J. D.,
1998. Resonance eﬀect for neural spike time reliability. J
Neurophysiol 80, 1427.

[9] Victor, J., Purpura, K., 1996. Nature and precision of
temporal coding in visual cortex: A metric-space analy-
sis. J Neurophysiol 76, 1310.

[10] van Rossum, M. C. W., 2001. A novel spike distance.

Neural Computation 13, 751.

[11] Haas, J. S., White, J. A., 2002. Frequency selectivity of
layer II stellate cells in the medial entorhinal cortex. J.
Neurophysiol. 88, 2422.

[12] Schreiber, S., Fellous, J. M., Whitmer, J. H., Tiesinga,
P. H. E., Sejnowski, T. J., 2003. A new correlation-based
measure of spike timing reliability. Neurocomputing 52,
925.

[13] Hunter, J. D., Milton, G., 2003. Amplitude and frequency
implications for dynamic

dependence of spike timing:
regulation. J Neurophysiol 90, 387.

[14] Quian Quiroga, R., Kreuz, T., Grassberger, P., 2002.
Event synchronization: A simple and fast method to
measure synchronicity and time delay patterns. Phys.
Rev. E 66, 041904.

[15] Fellous, J. M., , Tiesinga, P. H. E., Thomas, P. J., Se-
jnowski, T. J., 2004. Discovering spike patterns in neu-
ronal responses. J Neurosci 24, 2989.

[16] Hahnloser, R. H. R., Kozhevnikov, A. A., Fee, M. S.,
2002. An ultra-sparse code underlies the generation of
neural sequences in a songbird. Nature 419, 65.

[17] Kreuz, T., Andrzejak, R. G., Mormann, F., Kraskov, A.,
St¨ogbauer, H., Elger, C. E., Lehnertz, K., Grassberger,
P., 2004. Measure proﬁle surrogates: A method to vali-
date the performance of epileptic seizure prediction algo-
rithms. Phys. Rev. E 69, 061915.

[18] Kreuz, T., Kraskov, A., Andrzejak, R. G., Mormann,
F., Lehnertz, K., Grassberger, P., 2007. Measuring syn-
chronization in coupled model systems: A comparison of

McGraw-Hill, New York.

[20] Daniels, H. E., Kendall, M. G., 1947. The signiﬁcance
of rank correlation where parental correlation exists.
Biometrika 34, 197.

[21] Devore, J., Peck, R., 2005. Statistics: The exploration
and analysis of data. Duxbury Press, Belmont, CA.
[22] Dorval, A. D., Christini, D. J., White, J. A., 2001. Real-
time linux dynamic clamp: A fast and ﬂexible way to
construct virtual ion channels in living cells. Annals of
Biomedical Engineering 29, 897.

[23] Hindmarsh, J. L., Rose, R. M., 1984. A model of neu-
ronal bursting using three coupled ﬁrst order diﬀerential
equations. Proc. R. Soc. London B 221, 87.

[24] Morelli, A., Grotto, R. L., Arecchi, F. T., 2006. Neu-
ral coding for the retrieval of multiple memory patterns.
Biosystems 86, 100.

[25] Callenbach, L., H¨anggi, P., Linz, S. J., Freund, J. A.,
Schimansky-Geier, L., 2002. Oscillatory systems driven
by noise:
frequency and phase synchronization. Phys.
Rev. E 65, 051110.

[26] Freund, J. A., Schimansky-Geier, L., H¨anggi, P., 2003.
Frequency and phase synchronization in stochastic sys-
tems. Chaos 13, 225.

[27] Tiesinga, P. H. E., Sejnowski, T. J., 2004. Rapid tempo-
ral modulation of synchrony by competition in cortical
interneuron networks. Neural Comput. 16, 251.

[28] Aronov, D., Reich, D. S., Mechler, F., Victor, J. D., 2003.
Neural coding of spatial phase in V1 of the macaque mon-
key. J Neurophysiol 89, 3304.

[29] This is closely related to the Rice phase, that is obtained
by linear interpolation between two events (e.g., spikes)
from zero to 2π (cf., e.g., Refs. [25, 26]). In fact, the
measure I is proportional to the ratio of instantaneous
Rice frequencies, however, the normalization used here
allows for a better visualization.

[30] This normalization is superior to the normalization pro-
posed for a similar measure in Ref. [27]. There, the so
called coincidence factor was normalized to the minimum
number of spikes in either spike train. With that normal-
ization it would, in the extreme case, be possible that a
single spike can synchronize perfectly with a very long
spike train just because it coincides (maybe by chance)
with one of the spikes in the other sequence. On the other
hand, with the normalization used here, the maximum
value can only be achieved for truly synchronous spike
trains, whereas a diﬀerence in spike number is already
correctly reﬂected by lower Q values which indeed in-
dicate a deviation from perfect synchrony. As an addi-
tional conﬁrmation, we also ﬁnd that the clustering per-
formance is superior for the normalization proposed here
(results not shown).

[31] The bias correction introduced in Ref. [28] is omitted
since it is not necessary for a relative comparison of mea-
sures.

