Rolf M¨uller

E-mail: rolf.mueller@uni-tuebingen.de

Dept. Animal Physiology, T¨ubingen University, Morgenstelle 28, D-72076 T¨ubingen,
Germany

2 A computational theory for the classiﬁcation of
0
natural biosonar targets based on a spike code
0
2
 
g
u
A
 
2
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
0
1
0
8
0
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Abstract. A computational theory for classiﬁcation of natural biosonar targets is
developed based on the properties of an example stimulus ensemble. An extensive
set of echoes (84 800) from four diﬀerent foliages was transcribed into a spike code
using a parsimonious model (linear ﬁltering, half-wave rectiﬁcation, thresholding).
The spike code is assumed to consist of time diﬀerences (interspike intervals) between
threshold crossings. Among the elementary interspike intervals ﬂanked by exceedances
of adjacent thresholds, a few intervals triggered by disjoint half-cycles of the carrier
oscillation stand out in terms of resolvability, visibility across resolution levels and
a simple stochastic structure (uncorrelatedness). They are therefore argued to be a
stochastic analogue to edges in vision. A three-dimensional feature vector representing
these interspike intervals sustained a reliable target classiﬁcation performance (0.06%
classiﬁcation error) in a sequential probability ratio test, which models sequential
processing of echo trains by biological sonar systems. The dimensions of the
representation are the ﬁrst moments of duration and amplitude location of these
interspike intervals as well as their number. All three quantities are readily reconciled
with known principles of neural signal representation, since they correspond to the
center of gravity of excitation on a neural map and the total amount of excitation.

Submitted to: Network: Comput. Neural Syst.

Biosonar classiﬁcation

1. Problem

2

This work explores a computational theory for a set of biosonar tasks faced by bats.
Based on an extensive set of real world data, it develops and explores a parsimonious
solution for a well-deﬁned, yet widely useful set of sensing problems posed by extended,
multi-faceted sonar targets. In particular, classiﬁcation of foliages from diﬀerent species
of deciduous trees is performed. Such foliages are examples of ubiquitous, natural sonar
targets in the habitats of many bat species. The ability to classify them is immediately
relevant to biological tasks like landmark identiﬁcation or habitat evaluation (e.g., based
on a probability estimate for the presence of a certain prey) in general. Furthermore,
in any other estimation task where the informative signal properties depend on foliage
class, a hypothesis for the latter could be employed to enhance performance. Examples
of other related biological tasks likely to be performed to some extent by bats could be
related to obtaining information about the convex hull of an extended target or ﬁnding
passageways (e.g., in collision avoidance, contour following or path planning).

Multi-faceted targets, which place moderate to large numbers of reﬂectors in the
sonar beam, pose a special challenge for sonar systems limited to sparse spatial sampling
with only two receivers: Echoes received by each ear are superpositions of contributions
from all reﬂectors within the beam (moderate facet numbers would be on the order of 10,
large numbers on the order of 102 to 104). Reconstruction of target geometry/reﬂector
location would require both deconvolution (bats use chirping sonar pulses) as well as
estimating reﬂector placement from a collection of integrals over prolate spheroidal
surfaces. The second step in particular - besides relying on simplifying assumptions [1]
not necessarily met in natural biosonar targets - will remain an ill-posed problem
until a suﬃciently large number of such integrals has been gathered. The behavioral
patterns seen in bats may not leave enough room for this prior to the time when a
class estimate is due. Besides the issue of possible intractability under such constraints,
a parsimony argument stands against reﬂection-tomographic solutions as a model for
biosonar function in these tasks: Position, orientation and shape of individual reﬂectors
in a foliage are not immediately relevant to the behavioral goals of the animal and
therefore reconstruction of these target features would be a detour into yet another
representation from which the relevant variables (identity of a landmark, collision
risk, presence and location of a passageway, etc.) would still have to be estimated.
Parsimonious models for biosonar sensing should neither recover irrelevant detail about
a target explicitly nor should they rely on intermediate representations which contain
an excessive amount of such detail.

If the geometry of a target is not known, it is impossible to predict the waveform
or other individual properties of subsequent echoes received from it at diﬀerent
viewing positions.
In this sense, the echoes from foliages have to be viewed as
realizations of random processes, despite their origin in a deterministic reﬂection process.
Consequently, the particular problem at hand here is to classify natural targets (foliages)
based on random input signals, where the individual waveforms will in general not

Biosonar classiﬁcation

3

contain any deterministic patterns beyond the sonar pulse used to generate them [2].
The computational theory presented here deals with performing this task based on a
simple spike code. In contrast to a previous attempt at solving this problem [3], the
present work is based on a thorough characterization of the stimulus ensemble, explores
the fundamental nature of the employed coding scheme and evaluates the performance
of the proposed estimator quantitatively.

Since bats emit trains of pulses, this evaluation of the proposed estimator will take
the form of an m-ary sequential probability ratio test. In this way, it will be explored
to what extend bats could make use of the sequential information that they receive in
their pulse trains.

2. Approach

The approach taken here is to employ a biomimetic sonar observer which selectively
replicates those fundamental functional properties of its biological paragon that are
relevant to the particular problem at hand. The biomimetic observer is used to collect
large echo data sets from extended, natural targets over a realistic range of viewing
positions.
In this way, the natural variability can be exhausted for these particular
examples and statistical characterizations of the stimulus ensemble can be obtained
with suﬃcient conﬁdence even if they require a large number of data points (e.g., non-
parametric estimates of multivariate probability density functions). In the present work,
the stimulus ensemble is characterized at the level of spike code features. The spike
code features are the result of processing the experimental stimulus ensemble with a
parsimonious spike generation model. Consequently, the identiﬁed features are salient
under a minimum number of assumptions as well.

2.1. Biomimetic sonar system and data

linden (Tilia
Hedges of four deciduous tree species, sycamore (Platanus hybrida),
cordata), ﬁeld maple (Acer campestre), and hornbeam (Carpinus betulus), were
constructed from large individual branches. These targets extended between 2 and
3 m in width, ∼ 2 m in height and between 1.6 and 2 m in depth. Each hedge was
composed of 3 to 8 individual branches, which were arranged to ﬁll the given volume
in a semi-natural fashion. The targets were considerably larger along every dimension
than those employed by [4] in a study on foliage classiﬁcation with CWFM sonar, where
target depth appeared to be less than 45 cm, making individual plant shape a likely
determinant of the observed features. Just like in a natural forest, where individual
trees are almost certain to extend beyond the volume which can be illuminated by an
individual sonar pulse, this was not the case here.

The targets were scanned in three dimensions with a biomimetic sonar head
mounted on a humanoid robot arm. The sonar head consisted of three electrostatic
transducers, one for emission (Polaroid 7000) and two for reception (Polaroid 600). The

Biosonar classiﬁcation

4

receivers were positioned 12.5 cm apart (measured between aperture centers); the emitter
was placed halfway between and 4.5 cm below the two receivers. The head was moved
within a work envelope of 116 cm width, 64 cm height and 96 cm depth (perpendicular
to the hedge). Since the two upper edges of the work envelope perpendicular to the
target were rounded due to lack of reachability, the entire scanned volume was ∼ 0.6 m3
(as opposed to ∼ 0.71 m3 for a cuboid of the given edge lengths). The minimum target
range within this work envelope was ∼ 1 to 1.3 m.

The directivity of the employed electrostatic transducers is modeled well by an
(unbaﬄed) piston [5, 6], which is also in fairly good agreement with data from at least
two bat species [7, 8]. The ﬁrst-null beamwidth is 40 ° for the emitter and 30 ° for
the receivers. These beams correspond to sonar footprint diameters of ∼ 73 cm and
∼ 54 cm in 1 m distance, respectively (assuming normal incidence). While both emitter
and receivers were always oriented towards the hedge, this did not guarantee normal
incidence since the local orientation of the hedge surface varied and the data can be
expected to represent a wider range of grazing angles.

The volume enclosed by the work envelope was sampled every 4 cm along the width,
height and depths dimensions, resulting in 10 600 positions and a total of 21 200 echoes
received at the two “ears” for each target. The total data set size for all four targets is
therefore 84 800. Echo waveforms were digitized with 1 MHz sampling rate and 12 Bit
resolution. Regardless of distance between recording positions, all echoes in the data
set showed very low correlations determined over all possible lags (τ ) as

ˆρ =

max{| ˆCxy(τ )|}
q ˆEx ˆEy

,

(1)

where Cxy is the biased estimate of the cross-covariance between the two echoes [9] and
ˆEx, ˆEy are estimates of their respective energies (Figure 1). A thorough reshuﬄing of
weights for each reﬂector due to the directivities of reﬂectors and transducers is the likely
cause for these small correlation distances, which do not exceed the sampling distance
chosen here for any correlation value of practical relevance.

2.2. Biological signal processing model

The signal processing model used for characterizing the stimulus ensemble at a spike
code level consists of two stages: preprocessing and spike generation. Both stages were
simpliﬁed to reﬂect only essential signal processing steps.

In the preprocessing stage, the reﬂector sequence (impulse response) of the target
was ﬁltered by four bandpass ﬁlters in series: the emitted pulse, the transfer functions
of emitter and receiver, as well as an auditory bandpass ﬁlter model. The emitted pulse
was a linearly frequency modulated chirp sweeping across almost the entire passband
of the transducers (from 120 kHz to 20 kHz) in 3 ms. As the ﬁrst major simpliﬁcation
introduced here, only a single bandpass channel in the auditory representation of this
wideband signal is considered. A 4-th order gammatone ﬁlter with center frequency fc
and -3 dB quality Q was used as an accepted standard [11] for modeling auditory ﬁlters,

Biosonar classiﬁcation

5

Figure 1. Conditional probability density function estimates ˆp(ρ|d) of the maximum
correlation coeﬃcient ρ (over all lags, see (1)) between echoes conditioned upon the
distance d between the recording positions. Density estimates were based on a random
sample of 1,000 echo pairs per distance bin and foliage class and were obtained with
normal kernels (smoothing bandwidths between 0.004 and 0.012), the asymptotic mean
integrated squared error (AMISE, the ﬁrst order term in a series expansion of the mean
integrated square error, [10]) ranges between 0.018 and 0.067.

although the speciﬁc shape of the transfer function is of little relevance to the features
that this work focuses on. The combined eﬀect of all linear signal processing stages can
be described as ﬁltering the reﬂector sequence with a chirplet, which is the result of
convolving all four impulse responses (Figure 2). Since the passbands of the transducer
transfer functions are broad compared to that of the auditory ﬁlter model, their eﬀect
on the combined impulse response is negligible for any particular auditory bandpass
channel observed in isolation. Depending on the width of the channel’s passband, the
frequency sweep of the pulse will also be negligible, resulting in the combined impulse
response being approximately a wavelet of constant carrier frequency. Preprocessing was
completed by an approximate envelope extraction performed as half-wave rectiﬁcation

6

1

Biosonar classiﬁcation

1

0

)
d
e
z
i
l

a
m
r
o
n
(

e
d
u
t
u
p
m
a

l

−1

0

0.5
time [ms]

Figure 2. Measured combined impulse response (chirplet) for sonar pulse, emitter,
receiver, and auditory bandpass ﬁlter model (——). The auditory bandpass model
parameters fc = 50 kHz and Q−3 dB = 10 are used throughout the reported work
and result in a -3 dB impulse response duration of ∼ 260 µs. The actual data of the
combined impulse response was collected by directing the sonar head at a plane in
∼ 1.8 m distance; in the graph, it is compared to a simpliﬁed model which omits the
transducer transfer functions (- - - -).

and subsequent lowpass ﬁltering [12]. To the extend to which this procedure provides
for an undistorted demodulation of the signal [13], the eﬀect of the lowpass ﬁlter is
equivalent to a further increase in the quality of the original bandpass ﬁlter. The
employed lowpass ﬁlter was a 1st order recursive lowpass ﬁlter (“leaky integrator”)
with time constant τ . Altogether, the simpliﬁed preprocessing model is described by
a parameter triplet of fc, Q and τ . Throughout this work, the center frequency of the
auditory model ﬁlter was set to 50 kHz, close to the maximum of the transducer transfer
function. The chosen ﬁlter quality of 10 at -3 dB is approximately commensurate with
ﬁndings from some nuclei in the lower auditory brainstem [14]. Although integration
times in bats have been probed with both psychoacoustic and physiological methods [15],
it is diﬃcult to obtain an estimate for the parameter τ of the present model from
these experimental results. Therefore, the entire range of plausible values was explored
here (from τ = 0 to 10 ms, s. below) and the cases τ = 0 (no integration) and
τ = 3 ms (signiﬁcant smoothing, yet far from perfect integration) are shown throughout
as examples to assess the inﬂuence of further integration/narrowing of the passband
on all reported results. In evaluating model performance for target classiﬁcation (see
section 4), a broader sample of model parameter combinations (fc, Q, τ ) was used
(fc = {40 kHz; 45 kHz; 50 kHz; 55 kHz; 60 kHz; 65 kHz} , Q = {10; 15; 20; 25; 30; 35} , τ =

Biosonar classiﬁcation

7

{0; 1 ms; 3 ms; 5 ms; 7 ms; 10 ms}) to investigate how sensitive performance is to changes
in model parameters.

Spike encoding of the preprocessed signal was modeled as parsimoniously as
preprocessing: The input signal was normalized so that only waveform shape and
not energy was considered. Therefore, no compensation for initial target range and
associated spreading losses was required. Spike times were determined by thresholding
the signal. Together with the speciﬁc lowpass ﬁlter chosen for the envelope extraction
step, this amounts to an “integrate and ﬁre” model, which is a simpliﬁcation of the
Hodgkin-Huxley equations [16]. The suﬃciency of this model for the problem at hand
will be justiﬁed below from the nature of the features (Section 3). As a second major
simpliﬁcation, only spikes triggered by the initial transient, i.e., the “onset response” of
a neuron will be considered. This simpliﬁcation is necessitated by the lack of relevant
data on neural refractoriness in bats.

A single spike time is obviously not suﬃcient for target classiﬁcation, since it would
inevitably confound target range and class. To retain the simpliﬁcations made already
(only one bandpass channel, only one spike triggered by the initial transient in each
neuron), a population of neurons with diﬀerent thresholds was chosen as a way to
diversify the code according to the needs of target classiﬁcation. The adopted model
is therefore an amplitude-discrete sampling of the “inverse function” (considering the
lowest/earliest branches only) of the preprocessed signal up to its maximum; the signal
beyond the maximum is ignored.

Feature extraction from spike times uses only time diﬀerences within the neural
response to an echo; using an external reference can provide a range estimate, but
has no immediate relevance for target classiﬁcation (An indirect inﬂuence is possible,
should classiﬁcation features be range-dependent - this remains to be explored). Neural
circuitry for estimation of monaural time diﬀerences is well established in bats, e.g., in
the context of ranging, where comparatively long time-of-ﬂight values have been found
represented (few milliseconds to more than 10 ms [17, 18]). Mammals with suﬃcient
ear distances can determine direction-of-arrival by binaural time diﬀerences, typically
in the sub-millisecond range (1 ms corresponds to ∼ 34 cm distance already). In bats,
indications have been found that the respective neural structures (MSO) can deal with
time diﬀerences both in the sub-millisecond range and beyond [19]. However, this
was established only for sinusoidal amplitude modulation.
In contrast to this, the
computational work presented here emphasizes the importance of aperiodic, random
time diﬀerences within echoes, which can take values comparable to what is typically
considered in binaural diﬀerence evaluation as well as in ranging.

Speciﬁcally, the model consists of M thresholds am, where an > am for n > m.
These thresholds give rise to M(M −1) possible non-zero interspike intervals ∆ (αm, αn)
between the times of crossing the m-th and the n-th threshold. For speciﬁcation of the
model, two functions must be chosen; one for threshold placement on the amplitude
axis and one for selecting the threshold pairs for which the ∆ (αm, αn) are computed
(i.e., the wiring of the neural delay-lines/coincidence detectors). Unfortunately, no

Biosonar classiﬁcation

8

biological data is available on either of these two functions. As a remedy, thresholds
were placed equidistantly at least one standard deviation of the noise amplitude apart.
Since the signal-to-noise ratio of the experimental setup, which was limited by the sound
channel and not the electronics, was better than 60 dB for the larger echo amplitudes
encountered, M = 1, 024 (chosen as an integer power of 2) thresholds were employed
altogether. Bats were found to have between 700 and 2 160 inner hair cells and between
13 400 and 55 300 spiral ganglion cells for covering the entire hearing range of the
respective species; divergence ratios from inner hair cells to spiral ganglion cells range
from 11 to 79 [20]. Since it is not known how many neighboring channels could be pooled
based on the similarity of their transfer functions, it is likewise hard to estimate how
many neurons would be available for thresholding the output of one bandpass channel.
From the numbers given and the similar constraints on the signal to noise ratio in the
sound channel, it is unlikely though, that this model sacriﬁces any amplitude resolution
that bats may have.

Once thresholds have been placed (a vector of threshold values has been chosen),
the matrix of all possible ∆ (αm, αn) for any echo is completely determined as well.
Since this matrix has odd symmetry, i.e., ∆ (αm, αn) = −∆ (αn, αm), considering e.g.,
the upper triangular part suﬃces. Further more, the entire matrix can be reconstructed
exactly from the elements on the ﬁrst diagonal as

∆ (αm, αn) =

∆ (αk, αk+1) .

n−1

X
k=m

(2)

In this sense interspike intervals ∆ (αm, αm+1) generated by subsequent exceedance of
neighboring thresholds am, am+1 may be regarded as elementary intervals. All other
intervals which may be generated in a bat’s brain are just sums of these variables.
Equation (2) describes a resolution pyramid, in which detail is lost as the diagonal
under consideration is moved away from the main diagonal. While the matrix of all
possible ∆ (αm, αn)-values is completely determined by its ﬁrst diagonal and hence
highly redundant, it may be perceptually relevant, if small ∆ (αm, αm+1) fall below
the resolution limit, but not their sums.

3. Code properties

3.1. Elementary interspike intervals

Filtering the reﬂector sequence with the chirplet representing all linear channel eﬀects
(Figure 2) introduces a prominent periodicity corresponding to the carrier period of
the auditory bandpass model (here T = 20 µs). This periodicity is clearly visible in
the probability density function of the elementary interspike intervals ∆ (αm, αm+1)
(Figure 4). Since the probability density function has two nulls at ∼ 10 µs and ∼ 30 µs
for τ = 0 and its most pronounced notches are in the same places for τ = 3 ms, a clear
distinction can be made between three diﬀerent types of interspike intervals depending

Biosonar classiﬁcation

9

Figure 3. Example for the application of the employed spike generation model.
Left: the normalized waveform is thresholded up the its maximum; center: duration
of interspike intervals ∆ (αm, αm+1) for neighboring thresholds; right: matrix of all
possible interspike intervals for the given set of thresholds.

Figure 4. Probability density function estimates for the elementary interspike
intervals ∆ (αm, αm+1) for the four foliage types sycamore (◦ ), linden (⊓⊔), maple
(▽), hornbeam (∗). Shown are kernel density estimates using a normal kernel with 1 µs
smoothing bandwidth. Dashed line: normalized autocorrelation function Rxx(τ )/σ2
of the chirplet shown in ﬁgure 2.

Biosonar classiﬁcation

10

(3)

on how the two delimiting spike times are arranged with respect to the carrier period
(Figure 4):

• For same slope intervals ﬂanking spikes are triggered by the same rising ﬂank
of a positive half-wave; for the particular channel center frequency chosen here,
∆ (αm, αm+1) ≤ 10 µs in this interval category.

• For next cycle intervals ﬂanking spikes are triggered by subsequent positive half-
waves. For the particular channel center frequency chosen here, next cycle intervals
must have values such that 10 µs ≤ ∆ (αm, αm+1) ≤ 30 µs.

• For distant (> 1) cycle intervals ﬂanking spikes are triggered more than one carrier

cycle apart, hence ∆ (αm, αn) ≥ 30 µs for distant cycle intervals.

For next and distant cycle ∆ (αm, αm+1), the inverse function of the waveform (counting
only lower branches, see section 2.2 and ﬁgure 3) has discontinuities, i.e.,

lim
|αn−αm|→0

∆ (αm, αn) = C

as long as the discontinuity of the inverse function remains bracketed by [αm, αn].
This implies that such discontinuities remain visible in any ∆ (αm, αn) where the
corresponding thresholds αm, αn bracket them. Because they are discontinuity-based,
next and distant cycle ∆ (αm, αm+1) are invariant under any monotonic non-linear
transform of the signal amplitude, an important property as the auditory system is
known to perform non-linear compression [12]. Unlike same slope and next cycle
∆ (αm, αm+1), the durations of distant cycle ∆ (αm, αm+1) are not strictly tied to the
carrier cycle, because the autocorrelation of the chirplet (Rxx(τ ), superposed in ﬁgure 4)
decays and the echo waveform decorrelates.

Despite the comparative rarity of distant cycle ∆ (αm, αm+1) evident from ﬁgure 4,
it is almost certain that at least one distant cycle ∆ (αm, αm+1) is present in the
response to any given echo (Figure 5). For the chosen threshold spacing, this is
true for any smoothing constant and the expected number of distant cycle thresholds
shows a saturating increase with increasing time constant τ (Figure 6).
If instead
the limit of τ → ∞ and |αn − αm| → 0, i.e., perfect, “non-leaky” integration and
inﬁnitely narrow spacing of thresholds, was to be considered, only next cycle elementary
∆ (αm, αm+1) would be retained, because they correspond to the negative half-cycles of
the waveform which were set to zero by the half-wave rectiﬁcation. For ﬁnite threshold
spacing, the situation is quite diﬀerent and distant cycle ∆ (αm, αm+1) do not disappear
as a consequence of smoothing. Both robustness and relative rarity of distant cycle
∆ (αm, αm+1) are due to the fact that these ∆ (αm, αm+1) are indicative of an extended
trough in the echo waveform. For any given echo, there will be but a few of such troughs
(hence the rarity), but since they are low-frequency phenomena, they are robust against
lowpass smoothing.

Biosonar classiﬁcation

11

Figure 5. Probability density function estimates for the number of distant cycle
∆ (αm, αm+1) ≥ 30 µs per echo. The probabilities for at least one distant cycle
is ∼ 0.94 for sycamore and τ = 0, for all others
interspike interval P
P
n∆≥30 µs ≥ 1
≥ 0.99. Estimates used a normal kernel with smoothing bandwidth
0.82 − 0.99, AMISE < 0.0015. See ﬁgure 4 for symbols.

n∆≥30 µs ≥ 1

(cid:8)

(cid:9)

(cid:9)

(cid:8)

3.2. Compound interspike intervals

Usage of distant cycle ∆ (αm, αm+1) does not place demanding constraints on spike
time resolution, whereas access to the shorter individual next cycle intervals and in
particular same slope intervals does. Neurophysiological data on spike timing accuracy
in the auditory nerve of bats appears to be lacking, however. In cats, minimum standard
deviations of onset spike responses were found to be not much lower than ∼ 100 µs [21],
making individual ∆ (αm, αn) from the same slope and next cycle class appear an
unlikely substrate for target class estimation. Such small, elementary ∆ (αm, αm+1)
could achieve guaranteed perceptual saliency, however, if the amplitude range spanned
by a threshold pair was widened. In this case, longer, resolvable compound intervals
(see (2)) could emerge as a sum of elementary ∆ (αm, αm+1) with the value of the sum
being dominated by contributions from same slope and next cycle ∆ (αm, αm+1). To
explore this possibility, compound ∆ (αm, αn) which exceeded some minimum length η

were selected and a ratio r which describes
the contribution of elementary
∆ (αm, αm+1) ≤ ν (i.e., same slope or same slope or next cycle intervals) was computed
as

∆ (αm, αn) =

∆ (αk, αk+1) ≥ η

n−1

X
k=m

r = P

n−1
k=m ∆ (αk, αk+1) I∆(αk,αk+1)≤ν
n−1
k=m ∆ (αk, αk+1)

,

P

(4)

(5)

Biosonar classiﬁcation

12

Figure 6. Eﬀect of lowpass ﬁltering time constant (τ ) on the expected number ¯n∆≥3 µs
of distant cycle ∆ (αm, αm+1). The estimates are based on N = 500 randomly chosen
echoes for each value of τ and each foliage class. See ﬁgure 4 for symbols.

where I is the indicator function. The expected value of this ratio was found to depend
on the choice of m and n > m (see examples in the left subgraphs in ﬁgure 7) and
therefore the expected overall impact of same slope and next cycle interspike intervals
on the interspike intervals actually read out cannot be estimated without knowing the
distribution of readout connections over all possible pairs of incoming neurons. The
maximum ratio is a distribution-free measure, however, and it indicated that same
slope ∆ (αm, αm+1) have little impact on long compound ∆ (αm, αn) regardless of the
smoothing time constants (Figure 7). Next cycle elementary ∆ (αm, αm+1) could be
the dominating component of long compound ∆ (αm, αn), if a long smoothing time
constant was chosen. On the basis of these results, same slope elementary ∆ (αm, αm+1)
are of doubtful perceptual salience, both in isolation and in compound intervals. Next
cycle elementary ∆ (αm, αm+1) are of doubtful perceptual salience in isolation, but may
be a dominating component in longer compound ∆ (αm, αn), if long integration times
are chosen. Therefore, in the next section (Section 3.3), only next and distant cycle
∆ (αm, αm+1) are retained for further consideration.

Biosonar classiﬁcation

13

Figure 7. Ratio r of durations of elementary ∆ (αm, αm+1) ≤ ν in compound
∆ (αm, αn) to the total duration of the compound ∆ (αm, αn) ≥ η (see (5)). Left
graphs: examples of expected values of r as a function of threshold locations α1, α2,
a) ν = 10 µs (same slope intervals) and τ = 3 ms, b) ν = 30 µs (same slope and
next cycle intervals) and τ = 3 ms. Center and right graphs: maximum of r over all
threshold pairs: c) ν = 10 µs, τ = 0, d) ν = 30 µs, τ = 0, e) ν = 10 µs, τ = 3 ms, f)
ν = 30 µs, τ = 3 ms. See ﬁgure 4 for symbols.

3.3. Interspike interval random process

Retaining only next and distant cycle ∆ (αm, αm+1), each echo is represented by a
random sequence of variable length, since for each ∆ (αm, αm+1)-class more than one
∆ (αm, αm+1) per echo is likely (see Figures 5,6 for distant cycle ∆ (αm, αm+1); next
cycle ∆ (αm, αm+1) are more common than distant cycle ∆ (αm, αm+1), see ﬁgure 4).
Associated with each ∆ (αm, αm+1) is a position along the amplitude axis marking the
location of the two neighboring thresholds the ﬂanking spikes were triggered at.

The random sequences formed by next and distant cycle ∆ (αm, αm+1) diﬀer in
their statistical properties: Next cycle ∆ (αm, αm+1) show a strong pairwise dependence
between neighboring values as well as correlations of varying strength over the entire
sequence, whereas distant cycle ∆ (αm, αm+1) random sequences are uncorrelated
and at least pairwise independent (Figures 8,9).
Therefore, the distant cycle
∆ (αm, αm+1) random sequences have a much simpler statistical structure than next
cycle ∆ (αm, αm+1), which facilitates the design of a classiﬁer. For this reason, as well
as because of their low resolution requirements, they will be used in the next section

Biosonar classiﬁcation

14

Figure 8. Estimates of the joint probability density function for neighboring
∆ (αm, αm+1) in the response to echoes from sycamore foliage. The contour levels
are spaced linearly between 10% and 90% of the density functions’ maxima. Estimates
are based on N = 21 200 echoes.

to attempt target classiﬁcation based on output of the spike generation model (see
section 4).

4. Classiﬁcation based on distant-cycle interspike intervals

The results outlined in the previous
sections demonstrate that distant-cycle
∆ (αm, αm+1) oﬀer advantages both for actual use by biological systems (low resolution
requirements, high visibility in compound ∆ (αm, αn)) as well as for further studies
(uncorrelated random sequences). The decisive question is whether the distant-cycle
∆ (αm, αm+1) also contain suﬃcient information on target class. To answer this question,
target classiﬁcation was attempted using an ad-hoc feature selection approach, which
is unlikely to make optimum use of the random sequences, but serves its purpose of
demonstrating feasibility in case of success.

Each spike response to an echo was represented by three features: ﬁrst moment
estimates for distant cycle ∆ (αm, αm+1) interval length ( ¯∆) and amplitude location ( ¯α)
as well as the number (n∆≥30 µs) of distant cycle ∆ (αm, αm+1) in the spike response to

Biosonar classiﬁcation

15

Figure 9. Covariance estimates for the vectors of next cycle and distant cycle
∆ (αm, αm+1). Estimates are based on N = 21 200 echoes for each foliage class; the
number of realizations for sequences of a particular minimum-length varies, however,
and leads to a higher estimator variance on the edges of the covariance matrices for
∆ ≥ 30 µs and τ = 0.

an echo:

I∆(αm,αm+1)≥30 µs

¯α

n∆≥30 µs = X
m
1
2N X
m
1
N X
m

¯∆

=

=

∆ (αm, αm+1) I∆(αm,αm+1)≥30 µs

(αm+1 − αm) I∆(αm,αm+1)≥30 µs

.

(6)

While not providing a suﬃcient statistic, settling for ﬁrst moments is well advised in the
light of the small sample nature of the obtained spike representation (see ﬁgure 5): Since
both, αm+1−αm and ∆ (αm, αm+1) are positive quantities, estimates of ﬁrst moments are
more robust than those for all higher moments (at least if a sample average estimator or
equivalent is used [22]). A biological implementation of this feature space is also readily
envisioned, e.g., the center of gravity of the excitation on neural maps for amplitude
and time delay would represent ¯∆ and ¯α, the total amount of excitation n∆≥30 µs.

The three-dimensional joint probability density functions (Figure 10) of the features

Biosonar classiﬁcation

16

(see (6)) show interesting structure (e.g., multimodality for maple echoes) as well as
dependencies between the features (e.g., for sycamore echoes, there tend to be either few
large or many small distant cycle ∆ (αm, αm+1)). The suitability of the distances between

Figure 10. Estimates of joint probability density functions for the code features
¯∆, ¯α, n∆≥30 µs (see (6)). Top row: τ = 0; bottom row: τ = 3 ms. Estimates are based
on N = 21 200 echoes each.

the probability density functions for target classiﬁcation was assessed by estimating
performance measures of an m-ary sequential probability ratio test [23]. Because bats
use pulse trains with repetition rates that are typically high compared to the time scales
that navigation decisions are made on, this approach provides the necessary model to
explain how bats could make use of the information which accumulates over the incoming
echo trains.

The classiﬁcation trials were conducted based on random draws of echoes from the

Biosonar classiﬁcation

17

stimulus ensemble, this discards any information which may be provided by systematic
changes in echo features over a certain path [3]. Nevertheless, an excellent classiﬁcation
performance was found (Figure 11): Using the joint probability density function of

Figure 11. Classiﬁcation trial results for the four foliage types based on the three
distant cycle ∆ (αm, αm+1) features ( ¯∆, ¯α, n∆≥30 µs, see (6)) and their combinations.
Left: estimated class conditional error probability; center: expected number of samples
(echoes) needed for a decision; right: 90%-percentile of the number of samples. Solid
lines: τ = 0; dashed lines: τ = 3 ms. Responses were drawn randomly from 21 200
examples for each class, N = 105 trials were conducted for each performance estimate.
See ﬁgure 4 for symbols.

all three features and no smoothing (τ = 0), error probabilities of 0.03 to 0.19%
were obtained on an expected number of 3 to 8 echoes (90%-percentiles ranged from
6 to 13). For moderate smoothing (τ = 3 ms), a slight performance decrease was
found (error probabilities: 0.24 to 0.5%, expected number of samples: 5 to 8, 90%-
percentiles: 9 to 13, see ﬁgure 11). Using the joint probability density function of
all three features was found to result in the best overall performance, so both ﬁrst
order properties of the neural response as well as the number of time intervals contain
target class information. Using all three features, the overall dependence of classiﬁcation
performance on preprocessing model parameters (fc, Q, τ ) was found to be weak,

Biosonar classiﬁcation

18

average values (over all four target classes) of error probabilities, sample numbers
and their 90%-percentiles were found to fall in the intervals 0.06-4.5%, 3-15 and 4-
27 respectively. The least favorable values were outliers which were reached for a few,
adverse parameter combinations only (Figure 12). These results demonstrate that the

Figure 12. Dependence of classiﬁcation performance on preprocessing model
parameters. Parameters are: center frequency of the auditory bandpass channel model
fc, its −3 dB ﬁlter quality Q, and smoothing time constant τ . Performance measures
are: a) Estimated classiﬁcation error probability ˆPerror (averaged over target class),
b) 90%-percentile ( ˆN90) and c) expected value ( ¯N ) for the number of samples (echoes)
needed for a decision.

parameters of the preprocessing model are of little relevance within the parameter ranges
(fc = [40 kHz, 65 kHz] , Q = [10, 35] , τ = [0, 10 ms]) studied.

5. Conclusions and directions for future research

The present work addresses the acoustic landmark identiﬁcation as an example problem
of biomimetic random process classiﬁcation. Because the sensory representation of
sound is low-dimensional, most biosonar sensing tasks involving extended, multi-faceted
targets are likely to be posed in the way of random process estimation problems.
In vision, this situation is much less common, because retinal
images leave fewer
alternative interpretations and often additional assumptions are available to decide
between them. This leads to regularization approaches being considered as models
of visual perception [24], which would fail in biosonar perception. The speciﬁc merit of
biosonar as a sensory model system lies therefore in the fact that it matches vision in

Biosonar classiﬁcation

19

sustaining animals with active mobility in three-dimensional space despite this severe
ill-posedness.
For

the studied example problem, possible solutions were explored in a
computational approach on a spike code level. The use of a parsimonious model
for generating this spike code aides the search for basic, robust principles. Highly
informative and accessible code features should be readily visible in the output of
any model which reproduces the relevant principles correctly. The basic assumptions
made here were the well-established view that spike-generation can be approximated as
smoothing followed by thresholding and that time-diﬀerences are the elements of the
code. The latter assumption is particularly appealing in bats, where small, monaural
time diﬀerences are known to be behaviorally relevant as well as neurally extracted. In
principle, however, the discovered features (extended troughs in the waveform) may as
well be accessible in other codes, like e.g., a rate code. In bats, a rate code would have
to be reconciled with the fact that signals of large bandwidth must be coded with a
comparatively small number of auditory nerve ﬁbers, which may result in excessively
large estimator variance [25].

The interval code served as a biomimetic guide for identifying classiﬁcation
features. The central insight gained is that within all possible elementary interspike
intervals (formed between neighboring thresholds) which an echo can generate, a few,
comparatively long distant-cycle intervals stand out: They are readily resolved in
isolation already and furthermore are the dominating component in any compound
interspike interval (formed between distant thresholds) they are part of. Distant-cycle
interspike intervals can be viewed as an acoustic analogue to edges in a visual image:
They are the result of a discontinuity (in the inverse function of the waveform in the
acoustic case) and are readily visible over a range of diﬀerent resolutions (i.e., amplitude
threshold spacings in the acoustic case). However, whereas in visual images edges tend
to delineate the shape of deterministic objects or patterns, for echoes this not the case.
Therefore, the problem of dealing with “echo edges” is not a pattern recognition problem,
but a random process classiﬁcation problem without a deterministic template.

The chosen example problem (classiﬁcation of diﬀerent foliages) holds little promise
the probability density functions of signal
for classic feature selection methods:
amplitude are non-Gaussian [2], and the only non-negligible structure in the auto-
covariance matrix is determined by the sonar pulse. Nevertheless the number, average
duration and average amplitude location of the few distant-cycle interspike intervals
in the spike response to each echo class were shown to provide excellent target class
information. Therefore, the features which were found to be of high visibility in the
spike code derived from a parsimonious model also proved to be highly informative.

Further work is needed to elucidate the structural basis of these features, i.e., what
kind of physical target properties they correspond to. These could be the distributions of
individual reﬂector properties (e.g., size, spatial orientation), properties of their spatial
distribution or, more speciﬁcally, properties of the contours that limit these spatial
distributions. In this way, the ﬁndings for the example stimulus ensemble considered

Biosonar classiﬁcation

20

here could be generalized to a more inclusive theory about the information that is
accessible to biosonar systems in natural environments.

Finally, the coding model investigated has been limited to isolated portions (a
single auditory bandpass channel) of the auditory signal representation and to random
sequences of echoes. Relationships which may exist across the frequency dimension
of the auditory signal representation [26] or across the echo sequence [3] generated
along a particular ﬂight path of a bat have been ignored.
In the view of these
omissions, the achieved classiﬁcation performance is particularly remarkable. Using
the full information available across frequency and scan path, bats may be able to make
even ﬁner discriminations (e.g., identifying diﬀerent trees of the same species, diﬀerent
views or portions of the same tree). Spatial gradients explored along a ﬂight path could
be used for performing estimation tasks other than target classiﬁcation, for instance,
path planning, e.g., in the form of contour following, could be performed by following a
spatial gradient in statistical echo properties. Assuming that the nature of such spatial
gradients would depend on target class, research into the existence and information
contend of spatial in the studied features would link target classiﬁcation to a much
wider set of tasks that animals need to perform in their natural habitats.

Acknowledgments

Supported by DFG (SFB 550, project B6).

References

[1] A. C. Kak and M. Slaney. Principles of Computerized Tomographic Imaging. Society for Industrial

[2] R. M¨uller and R. Kuc. Foliage echoes: a probe into the ecological acoustics of bat echolocation.

& Applied Mathematics, Philadelphia, 2001.

J. Acoust. Soc. Am., 108(2):836–45, 2000.

Am., 110(4):2198–206, Oct. 2001.

[3] Kuc R. Transforming echoes into pseudo-action potentials for classifying plants. J. Acoust. Soc.

[4] P. McKerrow and N. Harper. Plant acoustic density proﬁle model of ctfm ultrasonic sensing.

IEEE Sensors Journal, 1(4):245–55, Dec 2001.

[5] ¨O. Bozma and R. Kuc. Building a sonar map in a specular environment using a single mobile
transducer. IEEE Trans. Pattern Analysis and Machine Intelligence, 13(12):1260–9, Dec 1991.
[6] P. M. Morse and K. U. Ingard. Theoretical Acoustics. Princeton University Press, Princeton, New

Jersey, 1986.

[7] R. A. Suthers D. J. Hartley. The sound emission pattern of the echolocating bat, eptesicus fuscus.

J. Acoust. Soc. Am., 85(3):1348–51, Mar 1989.

[8] R.B. Coles, A. Guppy, M.E. Anderson, and P. Schlegel. Frequency sensitivity and directional
hearing in the gleaning bat, plecotus auritus (Linnaeus 1758). J. Comp. Physiol. A, 165(2):269–
80, 1989.

[9] G. M. Jenkins and D. G. Watts. Spectral analysis and its applications. Holden-Day, Inc., San

Francisco, 1968.

[10] D. W. Scott. Multivariate Density Estimation. John Wiley & Sons, Inc., New York, 1992.
[11] M. Slaney. An eﬃcient implementation of the Patterson-Holdsworth auditory ﬁlter. Technical

Report 35, Apple Computer, 1993.

Biosonar classiﬁcation

21

[12] T. Dau and D. P¨uschel. A quantitative model of the ”eﬀective” signal processing in the auditory

system. I. model structure. J. Acoust. Soc. Am., 99:3615–22, 1996.

[13] R. M¨uller and H.-U. Schnitzler. Acoustic ﬂow perception in cf-bats: extraction of parameters. J.

Acoust. Soc. Am., 108(3):1298–307, 2000.

[14] S. Haplea, E. Covey, and J.H. Casseday. Frequency tuning and response latencies at three levels
in the brainstem of the echolocating bat, Eptesicus fuscus. J. Comp. Physiol. A, 174(6):671–83,
Jun 1994.

[15] P. Weissenbacher, L. Wiegrebe, and M. K¨ossl. The eﬀect of preceding sonar emission on temporal
integration in the bat, megaderma lyra. J. Comp. Physiol. A, 188(2):147–55, Mar 2002.
[16] W. M. Kistler, W. Gerstner, and J. L. van Hemmen. Reduction of the Hodgkin-Huxley equations

to a single-variable threshold model. Neural Computation, 9:1015–1045, 1997.

[17] N. Kuwabara and N. Suga. Delay lines and amplitude selectivity are created in subthalamic
auditory nuclei: the brachium of the inferior colliculus of the mustached bat. J. Neurophysiol.,
69(5):1713–24, May 1993.

[18] I. Saitoh and N. Suga. Long delay lines for ranging are created by inhibition in the inferior

colliculus of the mustached bat. J. Neurophysiol., 74(1):1–11, Jul. 1995.

[19] B. Grothe. The evolution of temporal processing in the medial superior olive, an auditory

brainstem structure. Prog. Neurobiol., 61(6):581–610, Aug 2000.

[20] M. Vater. Cochlear physiology and anatomy in bats. In P.E. Nachtigall and P.W.B. Moore, editors,
Animal Sonar Processes and Performance, pages 225–42, New York, 1988. Plenum Press.
[21] P. Heil and D. R. Irvine. First-spike timing of auditory-nerve ﬁbers and comparison with auditory

[22] C. Bourin and P. Bondon. Eﬃciency of higher order moment estimates. IEEE Transactions on

cortex. J. Neurophysiol., 78(5):2438–54, 1997.

Signal Processing, 46(1):255–8, Jan 1998.

[23] C. W. Baum and V. V. Veeravalli. A sequential procedure for multihypothesis testing.

IEEE

Transactions on Information Theory, 40(6):1994–2007, 1994.

[24] T. Poggio, V. Torre, and C. Koch. Computational vision and regularization theory. Nature,

317:314–9, 1985.

[25] J. Gautrais and S. Thorpe. Rate coding versus temporal order coding: a theoretical approach.

Biosystems, 48(1-3):57–65, Sep-Dec 1998.
[26] L. S. Smith. Onset-based sound segmentation.

In D.S. Touretzky, M.C. Mozer, and M.E.
Hasselmo, editors, Advances in Neural Information Processing Systems 8 (Proceedings of the
1995 Conference), pages 729–35. MIT Press, 1996.

