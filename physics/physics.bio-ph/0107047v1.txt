July 2001

UTAS-PHYS-01-08

Quantum ﬁeld theory and phylogenetic branching

P D Jarvis and J D Bashford,

School of Mathematics and Physics, University of Tasmania
GPO Box 252-21, Hobart Tas 7001, Australia

A calculational framework is proposed for phylogenetics, using nonlocal quantum ﬁeld
theories in hypercubic geometry. Quadratic terms in the Hamiltonian give the underly-
ing Markov dynamics, while higher degree terms represent branching events. The spatial
dimension L is the number of leaves of the evolutionary tree under consideration. Mo-
mentum conservation modulo Z×L
in L ← 1 scattering corresponds to tree edge labelling
using binary L-vectors. The bilocal quadratic term allows for momentum-dependent rate
constants – only the tree or trees compatible with selected nonzero edge rates contribute to
the branching probability distribution. Applications to models of evolutionary branching
processes are discussed.

2

1
0
0
2
 
l
u
J
 
9
1
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
7
4
0
7
0
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Evolutionary processes are frequently represented as discrete or continuous time sta-
tionary Markov dynamics on some relevant set of system characters. Divergence events
correspond to the initiation of two or more sibling processes, which each inherit the char-
acter probability distribution of the progenitor and then continue to evolve. It is the task
of phylogenetic inference to deduce ancestral interrelationships given observed character
probability distributions.

Although the individual ingredients for modelling such branching trees are quite well
understood (see for example [1, 2]), to date there is no overall dynamical picture for phy-
logenetics. In this note we point out that existing tools from physics – namely, quantum
ﬁeld theory and quantum many body theory when suitably interpreted in a stochastic
context[3, 4, 5] – can provide both a theoretical perspective and a calculational frame-
work. Below we sketch a general outline of our proposed model; details will be published
in a separate paper.

Consider a theory with Hamiltonian of the general form H(t) = H0 + H1(t), with

H0 =

Ψα†(x)Mα

β(x−y)Ψβ(y),

x,y
X

α,β
X

H1(t) =

δ(t − tI)

W I

αΨα†(x)Ψα(x)−

V I
αβ

γ

Ψα†(x)Ψβ †

(x)Ψγ(x)

,

(1)

x,I
X

 

α
X

α,β,γ
X

!

2

for quantised ﬁelds Ψα(x) of type α = 1, . . . , K. The sum is taken over vertices of a unit
hypercube x, y ∈ Z×L
, and the theory is manifestly translation invariant under x → x + a,
for a ∈ Z×L
. The interaction times tI are temporally ordered as 0 = t0 < t1 < t2 <
. . . < tM < tM +1 = T where T is the total time for the evolution. As will be seen below,
cubic interaction terms generate branching events, with the additional quadratic terms
necessary to ensure that the theory is overall probability conserving[3].

2

Quantisation is imposed in such a way that the time evolution generated by the
quadratic Hamiltonian H0 reproduces the standard Markov dynamics on each mode of
the ﬁeld. Consider the following expansions in momentum space Z×L

:

2

Mα

β(x − y) = λ(x − y)Mα

β,

λ(z) =

λ(k)eiπk·z,

Ψα(x) =

k
X
eiπk·xcα(k).

k
X
Basis states of the system are Fock states of the form

|α1k1 α2k2 . . . αN kN i = c†

α1(k1)c†

α2(k2) . . . c†

αN (kN )|0i,

where the vacuum is deﬁned as usual by the property of being annihilated by the modes
cα(k). For the evolution of states |P (t)i under the time independent Hamiltonian H0, the
solution of Schr¨odinger’s equation

for evolution after time T , namely

d
dt

|P (t)i = −H0|P (t)i

|P (T )i = e−H0T |P (0)i,

(2)

(3)

(4)

(5)

must be computed with the help of the canonical commutation relations of the ﬁeld. At
this stage it is only necessary to impose the trilinear condition[6]

(6)

(7)

(8)

(9)

[c†

α(k)cβ(k), cγ(ℓ)] = δα

γcβ(ℓ).

k
X

Consider for example separable states such as

|p(k1, t)i ⊗ |p(k2, t)i ⊗ . . . ⊗ |p(kN , t)i

representing a number of processes evolving in parallel, with each |p(k, t)i a single-particle
state corresponding to a probability distribution for characters of an individual process,

|p(k, t)i =

pα(k, t)|αki.

α
X
With (2), (6), either fermionic or bosonic quantisation lead to the time evolution of (7)
such that the probability distribution of each individual mode is given by the solution of
the appropriate classical master equation,

pα(k, T ) = (e−λ(k)T ·M )α

pβ(k, 0) ≡ U(k)α

βpβ(k, 0).

β

Turning to the full, time-dependent Hamiltonian H(t) = H0 + H1(t), (5) must be

replaced by the time ordered exponential

|P (T )i = Te−

0 dtH(t)|P (0)i,

T

(10)

R
which in turn is expressible in the usual way as sums of multiple integrals of time-ordered
products · · · H(t′)H(t′′) · · ·. Consider in particular the L ← 1 process, and its evolution
kernel representing the corresponding probability distribution of characters. Choose the
distinct outgoing momenta in some ordering to be the simple binary vectors (0, 0, . . . , 1),
(0, . . . , 1, 0), . . ., and (1, 0, . . . , 0) respectively. Since momentum conservation modulo Z×L
must hold by translation invariance, this ﬁxes the incoming momentum to be the maximal
value (1, 1, . . . , 1). The probability distribution is then a sum over all terms generated
by the expansion of the time ordered exponential. Contributions from admissible tree
diagrams are enumerated by labelling edges with momenta k, with vertices for interaction
times tI having one incoming and two outgoing momenta k, k′, k′′. Along edges, the
probability distribution pα(k, t) evolves via (9) for the appropriate time intervals ∆JI =
(tJ − tI) for I < J, so that the eﬀective rate constant is κ(k) ≡ λ(k)∆JI. At vertices,
momentum conservation ensures that a particular character type splits with appropriate
sharing of the probability and type between the two subsequent edges (with momenta such
γ, which
that k = k′ + k′′). A plausible description of the divergence event is V I
αβ
means that the two sibling processes commence evolution on their respective edges with
characters distributed identically to that of their progenitor. Clearly, the model admits
further generalisation to nondiagonal or even trilocal or time-smeared interaction terms.
Note that the additional diagonal quadratic terms in H1(t) are necessary to ensure that
the theory is overall probability conserving[3] but do not contribute to the tree diagrams

γ ≡ δα

γδβ

2

under consideration. The question of which tree or trees contribute to L ← 1 scattering
is encoded in the bilocal form of H0 (see (1)). Only momenta k corresponding to nonzero
rate constants λ(k) are allowed. For computation based on a given tree, it is thus possible
to choose nonzero rate constants λ(k) for selected momenta corresponding to the binary
edge labelling unique to that tree’s topology[2].

As an illustration, consider the case L = 3, M = 2. Nonzero rate constants for the
model (1) are chosen for the root and leaf momenta ~7 = (111), ~1 = (001), ~2 = (010) and
~4 = (100) respectively, together with a single additional momentum ~6 = (110) (see ﬁgure
1). Write H1(t) = V 1δ(t−t1) + V 2δ(t−t2). The time ordered exponential in (10) may be
written as a product,

Te−

0 dtH(t) = Te−

2+ dtH(t)V2Te−

1+ dtH(t)V1Te−

dtH(t),

(11)

T

R

T

R

−

2

R

−

1
0

R

where VI are time ordered exponentials for small intervals δI covering tI. These have the
form 1 + H0δI + V I + · · ·, the higher order terms being ordered monomials in H0 and VI
multiplied by nested δ-function integrals. In the limit δI → 0,

0 dtH(t) = e−H0(T−t2)(1 + V 2 + · · ·)e−H0(t2−t1)(1 + V 1 + · · ·)e−H0t1.

(12)

Te−

T

R

~2 α~4
U(κ~2)α~2

X

Clearly the contribution to the 3 ← 1 scattering probability associated with the tree of
ﬁgure 1 is, as required, the unique nonzero term arising from inserting intermediate states
in the above with the correct intermediate edge momenta, giving ﬁnally

hα~1

~1 α~2

~4 |e−H0(T−t2)V 2e−H0(t2−t1)V 1e−H0t1|α~7

~7i =
β~6U(κ~1)α~1

β~2U(κ~4)α~4

β~4V 2

β~2β~4

γ~6 · U(κ~6)γ~6

β~1V 1

β~1β~6

β~7 · U(κ~7)β~7

α~7pα~7(~7, 0).

In phylogenetics, the probability distributions or dispersion tensors of characters of
interest are given directly from observations. Whether these are compatible with calcula-
tions for a speciﬁc tree remains a question of statistics. Our model (1) relates phylogenetic
inference for evolutionary processes to a scattering problem for the associated quantum
ﬁeld theory. Recent work using Fourier-Hadamard inversion techniques for phylogenetic
reconstruction in molecular phylogenetics[7, 8] can be interpreted in our model as working
with position states rather than in the momentum representation.

The overall calculational framework provided by giving a deﬁnite dynamical model
for the branching process has potentially wide applicability. The picture can be extended
in practice by embellishment of various features. As already mentioned, these include
for example vertex decorations. A further possibility is a perturbative expansion of the
quadratic term to compute the modulation of systematic substitution frequency types by
the eﬀects of Poissonian background rates. Details of the model, and prospects for such
extensions, will be published in a separate paper.

Acknowledgements

It is a pleasure to thank the organisers of the Second Winter Workshop on Mathematical
Physics, University of Queensland, July 2001, for providing a stimulating and multidisci-
plinary environment. JDB acknowledges the support of a University of Tasmania Internal

Research Grant. PDJ thanks David Penny and Michael Hendy for hospitality and dis-
cussions on a visit at the Centre for Biomolecular Sciences, Massey University. Finally
we thank Bob Delbourgo and Vladimir Rittenberg for fruitful comments.

References

[1] F Rodriguez, J L Oliver, A Marin, J R Medina, The general stochastic model of

nucleotide substitution, J Theor Biol 142 (1990) 485-501

[2] M Steel, M D Hendy, D Penny, Reconstructing phylogenies from nucleotide pattern
probabilities: a survey and some new results, Discrete Appl Math 88 (1998) 367-96

[3] Masao Doi, Second quantization representation for classical many-particle system, J

Phys A 9 (1976) 1465 - 77

46 (1985) 1469-83

[4] L Peliti, Path integral approach to birth-death processes on a lattice, J de Physique

[5] F C Alcaraz, M Droz, M Henkel, V Rittenberg, Reaction-diﬀusion processes, critical

dynamics, and quantum chains, Ann Phys (NY) 230 (1994) 250-302

[6] H S Green, A generalized method of ﬁeld quantization, Phys Rev 90 (1953) 270

[7] L A Sz´ekely, P L Erd¨os, M A Steel, D Penny, A Fourier inversion formula for

evolutionary trees, Appl Math Lett 6 (1993) 13-16

[8] M D Hendy, D Penny, M A Steel, Discrete Fourier analysis for evolutionary trees,

Proc Nat Acad Sci (USA) 91 (1994) 3339-43

111

001

110

t=0

t1

t2

t=T

001

010

100

Figure 1: Binary labelling scheme for a tree on 3 leaves (L = 3) with branching events at
intermediate times t1, t2. Nonzero rate constants for the model (1) are chosen for the root
and leaf momenta ~7 = (111), ~1 = (001), ~2 = (010) and ~4 = (100) respectively, together
with a single additional momentum ~6 = (110).

