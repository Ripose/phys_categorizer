8
9
9
1
 
b
e
F
 
1
1
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
3
2
0
2
0
8
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Scaling Laws and Similarity Detection

in Sequence Alignment with Gaps

Dirk Drasdo(1), Terence Hwa(2), and Michael L¨assig(1)

†

(1) Max-Planck Institut f¨ur Kolloid- und
Grenzﬂ¨achenforschung,
Kantstr. 55, 14513 Teltow, Germany

(2) Department of Physics
University of California at San Diego
La Jolla, CA 92093-0319

Abstract

We study the problem of similarity detection by sequence alignment with gaps, using
a recently established theoretical framework based on the morphology of alignment
paths. Alignments of sequences without mutual correlations are found to have scale-
invariant statistics. This is the basis for a scaling theory of alignments of correlated
sequences. Using a simple Markov model of evolution, we generate sequences with well-
deﬁned mutual correlations and quantify the ﬁdelity of an alignment in an unambiguous
way. The scaling theory predicts the dependence of the ﬁdelity on the alignment
parameters and on the statistical evolution parameters characterizing the sequence
correlations. Speciﬁc criteria for the optimal choice of alignment parameters emerge
from this theory. The results are veriﬁed by extensive numerical simulations.

Key words: sequence comparison; alignment algorithm; homology; evolution model;
optimization

Related (p)reprints available at http://matisse.ucsd.edu/

hwa/pub.html.

∼

† Corresponding author. Email: lassig@mpikg-teltow.mpg.de. Fax: +49 3328 46215.

1 Introduction

Sequence alignment has been one of the most valuable computational tools in molecular
biology. It has been used extensively in discovering and understanding functional and evo-
lutionary relationships among genes and proteins. There are two basic types of alignment
algorithms: algorithms without gaps such as BLAST and FASTA (Altschul et al., 1990), and
algorithms with gaps, for example, the Smith-Waterman local alignment algorithm (Smith
and Waterman, 1981). Gapless alignment is widely used in database searches because the
algorithms are fast (Altschul et al., 1990) (computational time scales linearly with sequence
length), the results depend only weakly on the choice of scoring systems (Altschul, 1993), and
the statistical signiﬁcance of the results is well-characterized (Arratia, et al., 1988; Karlin
and Altschul, 1990; Karlin and Altschul, 1993). However, gapless alignment is not sensitive
to weak sequence similarities (Pearson, 1991). For a detailed analysis, algorithms with gaps
are therefore needed (Waterman, 1989; 1994).

At present, there are two main obstacles to the wider application of these more pow-
erful tools. They require substantially longer computational time than gapless alignments
(depending quadratically on the sequence length). As computational power continues its
exponential growth at a rate even faster than the growth of genomic information, we expect
this constraint to become less stringent in the near future. More importantly, gapped align-
ments lack a detailed statistical theory assessing the signiﬁcance of the results. It is this
second problem we address in the present paper.

The common algorithms assign a score to each alignment of two or more sequences.
The score is based on the number of matches, mismatches, and gaps. Maximization of
this score is then used to select the optimal alignment, taken as a measure of the mutual
correlations between the sequences. However, it is well known that the optimal alignment
of a given pair of sequences strongly depends on the scoring parameters used. The same is
true for the ﬁdelity of the optimal alignment, that is, the extent to which mutual correlations
are recovered. Hence, the key problem of alignment statistics is to quantify the degree of
sequence similarity based on alignment data and to ﬁnd the scoring parameters producing
alignments of the highest ﬁdelity. This problem has been addressed for gapless alignments
(Altschul, 1993), based on the knowledge of the exact probability distribution function for
the optimal scores in gapless alignments of mutually uncorrelated sequences (Karlin and
Altschul, 1990). For algorithms with gaps, however, not even the leading moments of the
distribution function have been known so far. Scoring parameters have been chosen mostly
by trial and error, although there have been systematic eﬀorts to establish a more solid
empirical footing (Benner, 1993; Vingron and Waterman, 1994; Koretke et al., 1996).

To guide the choice of scoring parameters, a quantitative measure of the ﬁdelity of an
alignment is necessary. Since the algorithm is designed to detect residual similarities between
sequences in a divergent evolution, it is clear that the ﬁdelity measure has to emerge from
the underlying evolution process. We use a simple probabilistic evolution model to generate
daughter sequences from ancestor sequences by local substitutions, insertions, and deletions.
The model is certainly too simple to describe realistic evolution processes, but it allows an

1

unambiguous identiﬁcation of inherited mutual similarities between sequences. The ﬁdelity
of an alignment is then simply the fraction of the inherited similarities recovered by it.
Maximization of the ﬁdelity is used as a criterion to select optimal scoring parameters.

We will not address here algorithmic and computational aspects of alignments. Eﬃcient
algorithms are available for parametric and ensemble alignment (Waterman et al., 1992,
Gusﬁeld et al., 1992, Waterman, 1994). Our goal is to present a statistical theory of gapped
alignments. This theory can then be used to predict optimal scoring parameters appropriate
for diﬀerent classes of inter-sequence correlations.

As is well recognized, the main mathematical diﬃculty preventing a quantitative statis-
tical characterization of gapped local alignment lies within the global alignment regime. In
two recent communications (Hwa and L¨assig, 1998; Drasdo et al. 1998), we have shown that
the statistical properties in the parameter regime close to the log-linear phase transition line
(Waterman et al., 1987; Arratia and Waterman, 1994) of the Smith-Waterman local align-
ment algorithm are in fact dominated by the statistics of global alignment. This regime is
important for biological applications since it has been found empirically to produce “good”
alignments (Vingron and Waterman, 1994). It is thus very important to characterize the
statistics of global alignment, which is the purpose of this paper. We report a detailed study
of the properties of global alignments of mutually uncorrelated as well as correlated sequences
by the Needleman-Wunsch (1970) algorithm. The results are used to select optimal scoring
parameter to detect sequence correlations generated by the toy evolution process. They can
also be incorporated directly into the parameter selection procedure for local alignment (Hwa
and L¨assig (1998); Drasdo et al., 1998).

The statistical theory of gapped alignments presented here is based on a geometrical ap-
proach introduced recently by two of us (Hwa and L¨assig, 1996). This approach focuses on
the morphology of the optimal alignment paths. The notion of an alignment path (recalled
below) provides a very fruitful link to various well-studied problems of statistical mechanics
(Kardar, 1987; Fisher and Huse, 1991; Hwa and Fisher, 1994) as has also been noticed by
Zhang and Marr (1995). The important statistical properties of alignment paths are de-
scribed by a number of scaling laws (Hwa and L¨assig, 1996; Drasdo et al., 1997) explained
in detail below. Their applicability to alignment algorithms is supported by extensive nu-
merical evidence. The resulting scaling theory of alignment has three main virtues:
(i) It distinguishes clearly between universal (parameter-independent) properties of align-
ments and those depending on the scoring parameters (and hence governing their optimal
choice).
(ii) It relates score data of alignments to their ﬁdelity and to the underlying evolutionary
parameters characterizing the similarities of the sequences compared.
(iii) Its key statistical averages turn out to be signiﬁcant for the alignment of single sequence
pairs that are suﬃciently long.
Statistical scaling theories have also been developed for related optimization problems in
structural biology, notably protein folding (Wang et al., 1996; Onuchic et al., 1997).

This paper is organized as follows. In Section 2, we deﬁne the evolution process, recall the
global alignment algorithm used throughout this paper, and discuss the qualitative aspects

2

of the geometrical approach. The quantitative theory of alignment starts in Section 3, where
we give a detailed description of the alignment statistics for uncorrelated random sequences,
and present the power laws governing alignment paths and scores. In Section 4, we turn
to sequences with mutual correlations inherited by a realization of our evolution process.
We establish a scaling theory that explains the parameter dependence of alignments in
a quantitative way. Hence we derive optimal alignment parameters as a function of the
evolution parameters, i.e., the frequency of indels and substitutions1. Furthermore, we show
how the evolutionary parameters and the optimal alignment of a given pair of sequences can
be deduced from its score data.

2 The geometrical approach to sequence alignment

Evolution model

≫

The evolution process used in this paper evolves from an “ancestor” sequence Q of length
N
1 whose elements are labeled by the index i. The element Qi is chosen from a set
of c diﬀerent letters. Each letter occurs with equal probability 1/c, independently of the
elements at other positions. Hence, the ancestor sequence is a Markov random sequence.
The numerical results presented below are for the case c = 4 as appropriate for nucleotide
sequences, but for some derivations, it is useful to consider general c-letter alphabets.

The evolution process generates a daughter sequence Q′ of length N ′ from the ancestor
sequence Q.
It involves local insertions and deletions of random elements with the same
p, and point substitutions by a random element with probability p. Insertion,
probability
deletion, and substitution events at one point of the sequence are independent of the events
at other points. The evolution process can thus be formulated as a Markov process along
the sequence (Bishop and Thompson, 1986, Thorne et al., 1991; Hwa and L¨assig, 1996).
The precise evolution rules used in this paper are given in Appendix A. These rules are such
that the average length of the daughter sequence, N, equals the length N of the ancestor
sequence.

e

A speciﬁc realization of this Markov process deﬁnes a unique evolution path linking the
sequences Q and Q′; see Fig. 1(a). However, the same pair of sequences can be linked by
diﬀerent evolution paths. Any evolution path has a number of conserved elements (i.e.,
elements that are not deleted or substituted at any point of the evolution process). The
average fraction of ancestor elements Qi conserved in the daughter sequence Q′ is

where

U(p, q) = (1

p) (1

q) ,

−

−

(1)

(2)

−
e
1A conceptually similar link between scoring parameters and evolution parameters has been discussed in

the context of maximum-likelihood methods (Bishop and Thompson, 1986; Thorne et al., 1991, 1992).

p

q =

1

p

e

3

Q
C T

G T

A

G A

T

G

i

Q:

Q:

G              T   A   C    T   G   A   T   G        

G   A   G   T   A   T               C   T   G

Q:

G   T   A   C   T   G   A              T   G        

Q: G        A   G   T         A   T   C   T   G

(a)

(b)

Q

G

A

G

T

A

T

C

T

G

j

(c)

and
Fig. 1: (a) A Markov evolution path linking the two sequences Q =
. Native pairs are marked by bonds with full circles, substitutions by
G, A, G, T, A, T, C, T, G
Q′ =
}
{
bonds with empty circles. The unpaired letters Qi are deleted, the unpaired letters Q′j are inserted.
(b) A possible alignment between Q and Q′ with matches (Qi = Q′j) (full lines), mismatches
= Qj) (dashed lines) and gaps (unpaired letters). (c) Lattice representation. The evolution
(Qi 6
path R(t) corresponding to (a) is marked by circles; there are ﬁve native bonds (full circles). The
alignment path corresponding to (b) appears as thick line whose solid (dashed) diagonal bonds are
matches (mismatches) and whose horizontal and vertical bonds are gaps. It covers three of the ﬁve
native bonds, producing the ﬁdelity

G, T, A, C, T, G, A, T, G
}
{

= 3/5.

F

is the eﬀective insertion/deletion rate (see Appendix A). We call these conserved pairs of
elements (Qi = Q′j) native pairs. Their fraction U(p, q) quantiﬁes the mutual similarity
between sequences. In the remainder of this paper, we take U and q as the basic parameters
characterizing the evolution process. The primary goals of sequence alignment are to identify
the native pairs and to estimate the mutual similarity U.

Alignment and Scoring Scheme

{

Q′j}

and Q′ =

We align the sequences Q =
Qi}
using the simplest version of the global
{
alignment algorithm by Needleman and Wunsch (1970). A global alignment of two sequences
is deﬁned as an ordered set of pairings (Qi, Q′j) and of gaps (Qi,
, Q′j), each element
Qi and Q′j belonging to exactly one pairing or gap (see Fig. 1(b)). Any alignment is assigned
a score S, maximization of which deﬁnes the optimal alignment2. We use here the simplest
class of linear scoring functions (Smith and Waterman, 1981), with the score given by the
total number N+ of matches (Qi = Q′j), the total number N
= Q′j), and
−
the total number Ng of gaps. Hence, the most general such function involves three scoring
parameters:

of mismatches (Qi 6

) and (

−

−

−
However, the optimal alignment conﬁguration of a given sequence pair Q and Q′ is left
invariant if the three scoring parameters are all multiplied by the same factor. Along with

−

S = µ+N+ + µ

N

+ µgNg .

(3)

2 In statistical mechanics, one may think of

S as an energy that has to be minimized.

−

4

the property that 2N+ + 2N
+ Ng = N is conserved in global alignment and the invariance
of the alignment conﬁguation to an additive constant to (3), we see that the outcome of
global alignment is controlled eﬀectively by a single parameter.. Without loss of generality3,
we may therefore choose to use the scoring function

−

S = √c

1 N+ −

−

N

1

− −

γNg ,

1
√c

−

(4)

which is normalized in such a way that a pairing of two independent random elements has
the average score 0 and the score variance 1. The scoring function S depends only on the
parameter γ, which describes the eﬀective cost of a gap over pairing. The optimal alignment
depends on γ in the regime γ
) to which we restrict
ourselves in the sequel. For γ < γ0, it is always favorable to replace a mismatch by two gaps
(Waterman et al., 1987), and the alignment is not biological relevant.

1) (i.e., 2µg > µ

γ0 ≡

1/(2√c

≥

−

−

The ﬁdelity of an alignment

and Q′ =

As discussed above, mutual correlations between the sequences Q =
Qj}
Qi}
arise from the set of native pairs (Qi = Q′j). The ﬁdelity
of an alignment can be quantiﬁed
as the fraction of correctly matched native pairs, see Fig. 1(b). This is an unambiguous
measure of the goodness of an alignment, and it will be used below to ﬁnd optimal alignment
parameters. To evaluate
directly, the native pairs have to be distinguished from random
matches (Qi = Q′j) involving mutated elements. Hence, the ﬁdelity deﬁned in this way
depends not only on the sequences Q and Q′ but also on the evolution path linking them.
Of course, the evolution path is not known in most applications of sequence alignment.
However, the scaling theory discussed below relates statistical properties of
to alignment
data, making it a useful and measurable quantity.

F

F

F

{

{

Lattice representation

{

{

×

and

Qi}

Q′j}

Any alignment of two sequences
is conveniently represented on a two-
N ′ grid as in Fig. 1(c) (Needleman and Wunsch, 1970). The cells of
dimensional N
this grid are labeled by the index pair (i, j). The diagonal bond in cell (i, j) represents the
pairing of the elements (Qi, Q′j). The horizontal bond between cells (i, j) and (i, j + 1) repre-
) located on sequence Q′ between the elements Q′j and Q′j+1. The vertical
sents a gap (Qi,
bond between cells (i, j) and (i + 1, j) represents a gap located on sequence Q between the
elements Qi and Qi+1.
In this way, any alignment deﬁnes a unique directed path on the
grid. Using the rotated coordinates r
i + j, this path is described by a
−
single-valued function r(t) measuring the displacement of the path from the diagonal of the

i and t

−

≡

≡

j

3 Indeed, the scoring functions (3) and (4) lead to the same optimal alignment if

γ =

2

c
−
2√c

1

−

+

c
2√c

1

−

µ+ + µ−
µ+

−
µ−

2µg

.

−

5

alignment grid. A path associated with an optimal alignment is denoted by r0(t). For global
alignment of typical sequences, the optimal path extends over the entire grid, i.e., it has a
length of the order N + N ′ = 2N. The Needleman-Wunsch dynamic programming algorithm
obtains optimal alignment paths by computing the “score landscape” S0(r, t) sequentially
for all lattice points, where S0(r, t) denotes the optimal score for the set of all alignment
paths ending at the point (r, t). The version of the algorithm used in this paper is detailed
in Appendix B.

In a similar way, any evolution path linking the sequences Q and Q′ deﬁnes a directed
path R(t) on the alignment grid (called evolution path as well) (Hwa and L¨assig, 1996). On
this path, horizontal and vertical bonds represent deleted and inserted elements, respectively.
A fraction U of the bonds along the evolution path are native bonds representing the native
pairs (Qi = Q′j). The ﬁdelity of an alignment is then simply the fraction of native bonds
that are also part of the corresponding alignment path r(t), see Fig. 1(c).

Alignment morphology

Alignment algorithms are designed to trace the mutual correlations between sequences. As
it becomes clear from Figs. 2, the presence of such correlations aﬀects both the morphology
of the optimal alignment path r0(t) and the associated score statistics. Fig. 2(a) shows the
path r0(t) for a pair of mutually uncorrelated random sequences. This path is seen to be
intrinsically rough; i.e., the displacement has large variations. This “wandering” is caused
by random agglomerations of matches in diﬀerent regions of the alignment grid. Fig. 2(b)
shows the corresponding score landscape S0(r, t) for a given value of t. The maximum score
value occurs at the point r0(t) and is seen to be not very pronounced; near-optimal score
values occur also at distant points such as r1. The statistics of alignment paths and scores
for uncorrelated sequences are discussed in detail in Section 3 below.

The optimal alignment path for a pair of mutually correlated sequences (obtained from
the evolution process described above) behaves quite diﬀerently, as shown in Fig. 2(c). Its
wandering is essentially restricted to a “corridor” of ﬁnite width centered around around
the evolution path R(t). In this way, the path r0(t) covers a ﬁnite fraction
of the native
bonds. The corresponding score landscape is shown in Fig. 2(d). The maximum at r0(t)
is now very pronounced; all paths ending at points distant from r0(t) have a substantially
lower score than the optimal path. The alignment statistics of mutually correlated sequence
pairs is described in Section 4.

F

The morphology of the optimal alignment path depends strongly on the choice of the
scoring parameter γ. As an example, Fig. 3 shows the optimal paths r0(t) (dashed lines)
for the same pair of correlated sequences with the same underlying evolution path R(t) (the
solid line), and for three diﬀerent values of γ: At small γ, the path r0(t) follows the evolution
path only on large scales. On small scales, variations in the displacement r0(t) are seen to
be larger than those of R(t) (Fig. 3(a)). The intrinsic roughness of the optimal alignment
path limits its overlap with the evolution path, hence suppressing the ﬁdelity. The ﬁdelity is
the highest at some intermediate value γ∗, where the alignment path follows the target path

6

4000

(a)

(c)

4000

t

0

−39

1100

1000

900

S0(r)

r
0

r

0

−27

r

0

r

23

(b)

(t=4000)

(d)

(t = 4000)

800

−1000

r

0

r

r

1

−215

285

r
0

r

Fig. 2: (a) The optimal alignment path r0(t) and (b) a slice of the score landscape S(r, t = 4000)
for a pair of mutually uncorrelated random sequences. The score maximum is at r0, which deﬁnes
r0(t = 4000) of the optimal path. Similar score values occur also at distant
the endpoint r0 ≡
points such as r1. (c) The paths r0(t) (dashed line), R(t) (solid line) and (d) the score landscape
S0(r) at t = 4000 for a pair of sequences with mutual correlations. The score maximum at r0 is
now pronounced; all distant points r have a substantially lower score. Hence the ﬂuctuations of
the alignment path r0(t) are conﬁned to a corridor around the evolution path R(t).

7

(a)

R(t)
r0(t), γ=0.3

40

0

2000

4000

6000
R(t)
r0(t),  γ = 2.5

8000

10000

(b)

40

0.0

2000.0

4000.0

8000.0

10000.0

6000.0

R(t)
r0(t), γ = 12.5

(c)

40

20

00
0

20

0000
0

20

0000
0

0

2000

4000

6000

8000

10000

Fig. 3: Optimal alignment paths r0(t) for the same pair of correlated sequences and three diﬀerent
values of γ. The evolution path R(t) (solid lines) is the same in all three cases, while the optimal
alignment paths r0(t) (dashed lines) diﬀer. (a) Random ﬂuctuation regime (γ < γ∗). The path
r0(t) has strong ﬂuctuations since the gap cost is low. (b) Optimal alignment parameter γ = γ∗.
The ﬂuctuations of the paths r0(t) and R(t) are of the same order of magnitude. (c) Shortcut
regime (γ > γ∗). At high gap cost, the ﬂuctuations of R(t) are dominant, while r0(t) contains large
straight segments.

8

most closely (Fig. 2(b)). At large γ, the alignment path contains large straight segments
(Fig. 2(c)), which again reduces the ﬁdelity.

A qualitative understanding of this parameter dependence may be gained from an analogy
to random walks, regarding r0(t) as the trajectory of walker following a curvy path R(t).
The intrinsic properties of the walker are parametrized4 by γ. For small γ, the the walker
is drunk and cannot follow the path R(t) without meandering to its left and right. This is
the regime of Fig. 2(a), which we call the random ﬂuctuation regime. For large values of γ,
on the other hand, the walker is lazy and bypasses the larger turns of the path R(t); this is
the shortcut regime (Fig. 2(c)). From this analogy, it becomes plausible that a walker who
is neither too drunk nor too lazy will follow the path R(t) most closely and thereby achieve
the highest ﬁdelity (Fig. 2(b)). Such a criterion for the optimal parameter γ∗ will indeed
emerge from the quantitative theory described in the remainder of this paper.

3 Alignment of Uncorrelated Sequences

A statistical theory of alignment can hardly predict the optimal alignment for a speciﬁc
pair of sequences. What can be characterized are quantities averaged over realizations of
the evolution process for given parameters U and q. It will be shown, however, that these
ensemble averages are also relevant for the alignment statistics of single pairs of “typical”
sequences provided they are suﬃciently long. The approach is diﬀerent from the extremal
statistics of the score distribution that has been used to assess the signiﬁcance of alignment
results (Karlin and Altschul, 1990, 1993).

In the absence of mutual correlations (i.e., for U = 0), the statistics of alignments is
determined by a balance between the loss in score due to gaps and the gain in score due
to an excess number of random matches. As discussed by Hwa and L¨assig (1996), the
corresponding alignment paths belong to a class of systems known in statistical mechanics
as directed polymers in a random medium 5. The statistical properties of directed polymers
have been characterized in detail (Kardar, 1987; Huse and Fisher, 1991; Hwa and Fisher,
1994). We now recall the main results and give numerical evidence of their applicability to
sequence alignment.

4 In statistical mechanics, γ is the eﬀective line tension of the ﬂuctuating path r0(t).
5This is also known as the problem of ﬁrst passage percolation. A detailed mathematical analysis of
the scaling laws presented below can be found in recent works by Licea et al.
(1994, 1996). The main
N .
diﬀerence to alignment statistics is the number of independent random variables on a grid of size N
For directed polymers and ﬁrst passage percolation, this number is of order N 2; for alignments of random
sequences, it is only of order N (see also Arratia and Waterman, 1994). This diﬀerence is, however, irrelevant
for the asymptotic scaling behavior (Hwa and L¨assig, unpublished). A detailed heuristic discussion of this
equivalence in the context of a number of closely related problems is given by Cule and Hwa (1997).

×

9

Displacement and score statistics

The displacement ∆r0(t2 −
arbitrary points t1 and t2 is found to obey the statistical scaling law

r0(t2)

t1)

≡

−

r0(t1) of the optimal alignment path between two

(∆r0(t))2

A2(γ)

4/3 ,

t
|

|

≃

≫

≫

t0(γ)

1, i.e., for t

the overbar denoting the average over an ensemble of mutually uncorrelated sequence pairs.
Eq. (5) is an asymptotic law valid for (∆r0(t))2
It
says that the exponent 4/3 is a very robust feature of the optimal alignment of uncorrelated
random sequences, independent of the scoring parameter(s) or even scoring schemes used.
A large gap cost eﬃciently suppresses the displacement only for the limited range of scales
t < t0(γ). On larger scales, the cost of gaps is always outweighed by the gain in score
from regions of the alignment grid with an excess number of random matches, leading to
the power law (5) with a “universal” exponent. The dependence of the roughness (∆r0(t))2
on the scoring parameters (γ in this case) is contained entirely in the amplitude A(γ); this
dependence is discussed below. The ensemble average (5) also describes the displacement
auto-correlation function of the optimal path for a single sequence pair, deﬁned as an average
over initial points t1 in an interval T

3/2(γ).

A−

≡

t,

(∆r0(t))2 = T −

1

(r0(t1 + t)

r0(t1))2 .

−

≫

T

Xt1=1

The large displacement ﬂuctuations of the optimal alignment path r0(t) are accompanied
by large variations in its score. For an ensemble of mutually uncorrelated sequences, the
score average is asymptotically linear in the length N,

for N
of optimal score is described by a nontrivial power law

1, with a monotonically decreasing coeﬃcient function E0(γ). However, the variance

≫

S0(N, γ)

E0(γ) N

≃

(∆S0(N, γ))2

B2(γ)N 2/3

≃

which is valid in the asymptotic regime N
t0(γ). The dependence on the alignment
≫
parameters is again only in the amplitude B(γ), while the exponent 2/3 is universal. The
ensemble average can be obtained (up to a γ-independent proportionality factor) from a
single pair of sequences as average in the score landscape S0(r, t) over a suﬃciently long
interval r1 ≤

r1 + R,

≤

r

(∆S0(t, γ))2

S2

0(r, t)

1

R−

S0(r, t)

,

(9)

1

R−

∼

r1+R

1

−

r=r1
X

r1+R

1

−

r=r1
X

− 


2





see Appendix B. We have veriﬁed the scaling laws (5) and (8) numerically for a range of γ
values; see Figs. 4. The asymptotic behavior is found to set in rather quickly for t > t0(γ).
The same scaling has been found for a pair of unrelated cDNA sequences (see also Fig. 4),
which justiﬁes our modeling of individual sequences as Markov chains. A more comprehensive
study of correlated and uncorrelated cDNA sequences will be presented elsewhere.

(5)

(6)

(7)

(8)

10

 γ = 0.5
 γ = 1.67
 γ = 3.3
 γ = 6.25
 γ = 10

(∆r0(t))2

100000

1000

10

0

(∆r0(t))2

1000

100

10

1

(a)

4/3

~ t

t

t

(∆S0(t,γ))2 

1000

(b)

100

10

1

10

100

10

1

(∆S0(t,γ))2

(d)

 γ = 10
 γ = 6.25
 γ = 3.3
 γ = 1.25
 γ = 0.5

2/3

~t

t

2/3

~t

10

100

1000

10000

100

1000

10000

(c)

4/3

~t

γ = 2.5

γ = 2.5

1

10

100

1000

1

10

100

1000

t

Fig. 4: (a) Displacement ﬂuctuations (∆r0(t))2 of the optimal alignment for several values of γ.
Averages over an ensemble of 200 mutually uncorrelated sequence pairs are marked by lines, auto-
correlation functions for a single sequence pair of length N = 105 by squares. (b) Score ﬂuctuations
(∆S0(t))2 obtained from the score landscape (29) by Eq. (9) for several values of γ. (c) Displacement
auto-correlation function and (d) score ﬂuctuations for a pair of unrelated cDNA seqences (P.lividius
cDNA for COLL2alpha gene (Exposito et al., 1995) and Drosophila melanogaster (cDNA1) protein
4.1 homologue (coracle) mRNA, complete cds. (Fehon et al., 1994)). The straight lines indicate
the expected power laws given by Eqs. (5) and (8).

11

Conﬁnement and tilt energies

A related set of power laws govern the change in the average optimal score S0 if the alignment
rc/2 < r0(t) < rc/2 artiﬁcially
paths are subject to constraints. For example, the constraint
conﬁnes the paths to a strip of width rc on the alignment grid. This decreases the optimal
score S0 since the path r0(t) is cut oﬀ from random agglomerations of matches outside the
strip. For long sequences, this conﬁnement cost becomes proportional to N, and the average
conﬁnement cost per unit of t is

−

δEc(rc; γ)

S0(rc; N, γ)
N

−

≡

S0(N, γ)

< 0.

It obeys the scaling law

δEc(rc; γ)

C(γ) r−
c

1

,

≃ −
with all the parameter dependence contained in the prefactor C(γ). This relation is valid
in the asymptotic regime of strong conﬁnement, i.e., for sequences long enough that their
unconstrained mean square ﬂuctuations (∆r0)2(N) exceed the scale r2
c . According to (5),
r3/2
this condition is satisﬁed for N
c

t0(γ).

In a similar way, the alignment may be constrained by restricting both ends of the
alignment path to given values of r, for example, r(0) = 0 and r(N) = r0. This forces an
average tilt θ = r0/N upon the alignment path, thereby increasing its number of gaps and
decreasing its number of matches. The resulting tilt cost is again proportional to N for long
sequences, and the average tilt cost per unit of t,

≫

is given by

δEt(θ; γ)

≡

St(θ; N, γ)

St(0; N, γ)

< 0

−
N

δEt(θ; γ)

D(γ)θ2 .

≃ −

2
This power law is valid for long sequences (N
0 (γ)).
The scaling form of the conﬁnement and tilt energies has been veriﬁed numerically, see Fig. 5.

t0(γ)) and small tilt angles (θ2 < t−

≫

Parameter dependence

The scaling laws (5), (8), (11) and (13) all have the same structure: they are power laws
with universal exponents and parameter-dependent amplitudes. The scaling theory predicts
not only the values of the exponents but also universal relations between the amplitudes.
We have

A3/4(γ)

B−

3(γ)

C(γ)

D−

1/3(γ) ,

∝
the tildes indicating proportionality factors independent of γ and of order 1. The amplitudes
are monotonic functions of γ, which become independent of γ for γ < γ0. Their asymptotic
1.
behavior for large γ can be calculated (Hwa and L¨assig, 1996), resulting in C(γ)
Indeed, we ﬁnd this amplitude to be well approximated by the form

γ−

∝

∝

∼

(10)

(11)

(12)

(13)

(14)

(15)

C(γ)

(γ + const.)−

1

∼

12

0

0

(a)

(b)

δEc

δEt/t0

−0.1

γ=10
γ=5
γ=2.5
γ=1.25
γ=0.5

γ=10
γ=5
γ=3.3
γ=2
γ=0.5
~(θt0)2

−0.5

0

0.5
1/rc

1

−0.2

0

0.5

θt0

1

rc < r0(t) < rc,
Fig. 5: (a) Conﬁnement cost δEc(rc; γ) for optimal alignment paths in a corridor
(b) Scaled tilt cost
taken from an ensemble of 200 mutually uncorrelated random sequences.
δEt(θ; γ)/t0(γ) as a function of the scaled tilt θ t0(γ), for the same ensemble of sequences. The
curves describe asymptotic power laws with universal exponents and and γ-dependent amplitudes,
as given by Eqs. (11) and (13).

−

0.5

0.4

0.3

0.2

0.1

0

 C(γ)
~A(γ)3/4
~D(γ)−1/3
~B(γ)−3
E0(γ)
0.82/(1.446+γ)

1

10

γ

13

Fig. 6: Parameter dependence of the amplitudes A(γ), B(γ), C(γ)m D(γ), and E0(γ), together
with a ﬁt curve of the form (15).

in the entire interval γ > γ0. Our numerical data verifying Eqs. (14) and (15) are shown
in Fig. 6. We also show numerical results for the the average score per unit of t, i.e., the
function E0(γ) in Eq. (7). We ﬁnd E0(γ)

C(γ) approximately.

∼

4 Alignment of Correlated Sequences

Displacement ﬂuctuations of the evolution path

As discussed in Section 2, the mutual correlations between sequences are encoded in their
evolution path, which is represented by the evolution path R(t) on the alignment grid. This
path has displacement ﬂuctuations due to the random distribution of insertions and deletions,
see Figs. 2(c) and 3. However, the statistics of these ﬂuctuations is diﬀerent from that of
the alignment paths discussed in the previous Section. Since the evolution is modeled as a
t2)
Markov process, the displacement ∆R(t1 −

R(t2) has the mean square

R(t1)

≡

−

∆R(t)2 = q

t
|

|

(16)

characteristic of a Markov random walk, with q given by Eq. (2). The overbar denotes an
ensemble average over realizations of the evolution process with given values of U and q.
The ensemble average (16) equals the auto-correlation function of a single suﬃciently long
evolution path R(t) deﬁned in analogy to (6).

We may compare the ﬂuctuations ∆R(t)2 of the evolution path for correlated sequences
with the ﬂuctuations ∆r0(t)2 of the optimal alignment path for uncorrelated sequences
(Drasdo et. al., 1997). This deﬁnes a scale ˜t, where these ﬂuctuations are of the same
order of magnitude: (∆R(˜t))2 = (∆r0(˜t))2

˜r2. From Eqs. (5) and (16), we obtain

≡

˜t(γ, q) = q3/A6(γ) ,

˜r(γ, q) = q2/A3(γ) .

(17)

We call the scales (17) roughness matching scales. For
the evolution path exceeds that of the optimal alignment path, while for
displacement of the alignment path becomes dominant.

< ˜t(γ, q), the displacement of
> ˜t(γ, q), the
t
|

t
|

|

|

Scaling theory for correlated sequences

For sequences with mutual correlations (i.e., U > 0), the morphology of the optimal align-
ment path r0(t) and the score statistics are more complicated than for uncorrelated sequences
since in addition to the random matches, there are now the native matches along the evolu-
tion path R(t). Due to these competing score contributions, the problem seems to be beyond
the means of any rigorous mathematical approach. However, it turns out that the statistics
of weakly correlated sequences is described with remarkable accuracy by the scaling theory
developed in the previous Section.

Consider a pair of weakly correlated sequences of length N

1 with an optimal alignment
> 0 at a given value of γ. Since the optimal alignment path r0(t) and the

of ﬁnite ﬁdelity

≫

F

14

evolution path R(t) have a ﬁnite fraction of common bonds, the displacement ﬂuctuations
of r0(t) remain conﬁned to a “corridor” centered around the path R(t) (see Fig. 2(c)). The
width rc of this corridor can be deﬁned by the mean square relative displacement

r2
c ≡

(r0(t)

R(t))2 ,

−

(18)

which can again be understood as an ensemble average or equivalently as an average over
t for a single pair of long sequences. To see this equivalence, we note that by Eq. (5),
the width rc deﬁnes a corresponding scale in t direction, tc = r3/2
t0(γ). One can show
that tc is a correlation length; i.e., points on the alignment path with
> tc are
t1|
essentially uncorrelated. Averaging over uncorrelated regions of the alignment path generates
the ensemble underlying Eq. (18) even for a single pair of sequences if they are suﬃciently
long, i.e., N, N ′

t2 −

|

c

tc.

By conﬁning the alignment path r0(t) to a corridor, mutual correlations act as a constraint
on its displacement ﬂuctuations. This leads to a score cost as discussed in the Section 3.
However, the constraint cost must be outweighed by the gain in score due to the native
matches, resulting in a net score gain per unit of t,

≫

δE(U, q, γ)

S(N, U, q, γ)
N

−

≡

S0(N, γ)

> 0 ,

(19)

with S0(N, γ) denoting the average score of uncorrelated sequences.

We now calculate the conﬁnement length rc(U, q, γ) and the score gain δE(U, q, γ) in a
variational approach, treating rc as an independent variable to be determined a posteriori
from an extremal condition. We stress that this approach is not exact; the main approxima-
tion consists in treating r and t as continuous variables.

The constraint cost per unit of t imposed by the evolution path R(t) involves terms of
the form discussed in the previous Section: (i) If the path r0(t) is conﬁned to a corridor of
q/rc
width rc around the ﬂuctuating path R(t), the tangent to r0(t) has a typical tilt θ
with respect to the diagonal of the alignment grid, implying a tilt cost

∼

(ii) The conﬁnement cost to an untilted corridor of width rc is δEc = C/rc. The tilt reduces
the eﬀective width of the corridor so that the conﬁnement cost takes the form

δEt(rc; q, γ)

D(γ)

∼ −

2

q
rc (cid:19)

(cid:18)

.

δEc(rc; q, γ)

C(γ)

∼ −

1 + q/[C 2(γ)rc]
rc

.

, as it is clear from the deﬁnition of the ﬁdelity

On the other hand, the gain in score per unit of t due to the native matches is simply
δEn = U
in terms
of rc. Naively one would expect
1/rc. A detailed analysis shows that this is correct up
to a logarithmic correction (Hwa and Nattermann, 1995, Kinzelbach and L¨assig, 1995, Hwa
and L¨assig, 1996) leading to

. We need to express

F ∼

F

F

F

(20)

(21)

(22)

δEn(rc; U)

U

1 + log rc
rc

.

∼

15

The net score gain is the sum of these contributions, δE = δEc + δEt + δEn. The resulting
equation can be simpliﬁed by using the scaled variables x = C/U, y = q/U 2, and δ
= δE/U.
Absorbing all unknown proportionality factors into their deﬁnition, we obtain the scaled
energy gain

E

δ

(rc; x, y) =

E

x
rc −

y
x (cid:18)

−

1 +

y
x2

(cid:19)

1
r2
c

+

1 + log rc
rc

.

Maximizing (23) then determines the actual value of rc(x, y) = rc(U, q, γ):

(23)

(24)

δ

(x, y) = max

δ

(rc; x, y) .

E

rc

E

(rc(x, y); x, y) and score gain
Fig. 7 shows numerical data for the ﬁdelity
δ
(x, y) obtained from single sequence pairs with various values of U, q and γ. As expected
E
from this scaling theory, the data points for diﬀerent parameter sets (U, q, γ) corresponding
to the same (x, y) collapse approximately. This data collapse will be useful for similarity
detection.

(x, y) =

F

F

Alignment parameter optimization

δ

E

E

s(y)

(x∗(y), y)
The numerical ﬁdelity and score patterns of Fig. 7 have clear maxima
(xs(y), y), attained at points x∗(y) and xs(y). Fig. 7 also shows the loci
and δ
≡
∗(x, 0) and
of these maxima, (x∗(y),
s(x, 0) obtained from the scaling theory (i.e., from Eqs. (23) and (24) solved numerically).
δ
E
The theory is seen to predict the functional form of these curves in a reasonable way, except
1) where the continuum approximation valid in the regime of
in the region
weak similarity breaks down. (The unknown γ-independent proportionality factors for the
scaling variables x, y, δ

have been determined by ﬁts to the data.)

s(y)), as well as the limit curves

∗(y)) and (xs(y), δ

1 (i.e., rc ∼

and for

F ∼

≡ F

∗(y)

F

F

F

E

The functions x∗(y), xs(y),

s(y) shown in Figs. 8 (a) and (b) encode in an
eﬃcient way the dependence of the ﬁdelity and score maxima on the alignment parameter
and on the evolution parameters. Furthermore, it follows from the (numerical) solution
of (23) and (24) that the conﬁnement length r∗c (y)
rc(x∗(y), y) at the point of maximal
ﬁdelity satisﬁes the approximate relation

≡

F

E

F
∗(y), and δ

E

r∗c (y)

∼

˜r(x∗(y), y)

(25)

in the biologically interesting regime of small q and moderate U (0 < y < 5). The optimal
conﬁnement length is thus proportional to the roughness matching scale (17) at that point.
Hence, this scaling theory is in accordance with the qualitative picture of Section 2: At
x∗(y), the ﬂuctuations of the optimal alignment path r0(t) just match those of the evolution
path R(t) (see Fig. 2(b)). The shortcut regime (Fig. 2(c)) corresponds to the ascending
branch (x < x∗(y)) of the ﬁdelity curves in Fig. 7(a), while the random ﬂuctuation regime
(Fig. 2(a)) corresponds to the descending branch (x > x∗(y)).

16

y=0
y=0.12, U=0.35
y=0.23, U=0.47
y=0.23, U=0.26
y=0.47, U=0.49
y=0.47, U=0.61
y=1.04, U=0.33
y=1.04, U=0.41
y=2.41, U=0.18
y=2.41, U=0.21
y=3.7, U=0.22

Y=0
y=0.12, U=0.35
y=0.23, U=0.35
y=0.23, U=0.47
y=0.47, U=0.49
y=1.04, U=0.33
y=1.04, U=0.41
y=2.41, U=0.18
y=2.41, U=0.21
y=3.7, U=0.22

0

1

3

2

x

0.6

F

1

0.8

0.4

0.2

0.8

0.6

δε

0.4

0.2

0

0

(x, y) and (b) score gain δ

(x, y) obtained from single sequence pairs with
Fig. 7: (a) Fidelity
E
various evolution parameters U, q and alignment parameters γ. The data for diﬀerent (U, q, γ)
corresponding to the same (x, y) collapse approximately, as predicted by the scaling theory. The
s(y)) (long-
lines are the theoretical loci of the maxima (x∗(y),
dashed) and the theoretical limit curves

F ∗(y)) (short-dashed), (xs(y), δ
(x, 0) (solid).

(x, 0), δ

F

E

1

2

x

3

F

E

17

(a)

1.4

1.2

1

0.8

0.6

0.4

0.2

1

0.8

0.6

0.4

0.2

x*(y), numerical data
x*(y), theory
xs(y), numerical data
xs(y), theory

(b)

F*(y), numerical data
F*(y), theory
δεs(y), numerical data
δεs(y), theory

0

0

1

3

0

0

4

2
y

2
y

4

Fig. 8: Alignments of maximal ﬁdelity and of maximal score gain. Theoretical predictions for the
curves (a) x∗(y), xs(y) and (b)
s(y), compared to numerical data obtained from ﬁts to
the curves of Fig. 7.

F ∗(y), δ

E

Similarity detection

The evolution process used in this paper is closely related to a more realistic process for
the divergent evolution of two daughter sequences Q(1) and Q(2) from a closest common
ancestor sequence Q. Modeling the two evolution paths as independent Markov processes
with respective parameters U1, q1 and U2, q2, one can show that the evolution path linking
Q(1) and Q(2) is again a Markov process with parameters U = U1U2 and q = q1 + q2 + O(q2).
For practical alignments, however, the evolutionary parameters U and q are unknown.
Since they enter the deﬁnition of the basic variables x and y, knowledge of the optimal pa-
rameters x∗(y) and xs(y) seems to be of little use for applications. However, these parameters
can be reconstructed from alignment data, as we will now show for a speciﬁc example.

Consider three sequences Q(1), Q(2) and Q(3) related by the evolution tree of Fig. 9(a).
The evolutionary distances τi are deﬁned in terms of the mutual similarity coeﬃcients Uij
by

log Uij = τi + τj

(i, j = 1, 2, 3) .

(26)

−

We whish to determine τ1, τ2 and τ3 from pairwise alignments of the sequences6. Fig. 9(b)
shows the alignment data δEij as deﬁned in Eq. (19) for each of these pairs, plotted as a
function of C(γ). To ﬁt the data curve δEij(C) to the corresponding scaled score gain curve
δ
Eij(x) of Fig. 7(b), we have to divide both axes of the diagram by Uij. In this way, we
can determine the a priori unknown factors Uij, and hence the evolutionary distances τi, see
Fig. 9(b). For this example, we obtain U12 ≈
0.22,
0.54, U13 ≈
0.55, which is to be compared with the actual values τ1 = 0.27, τ2 = 0.38,
τ2 ≈
and τ3 = 0.61 used to produce the sequences.
6 In this example, we use eﬀective indel rates

qij ) = Γ(τi + τj ) with Γ = 0.2, but this choice is

0.415, and τ1 ≈

0.43, U23 ≈

0.33, τ3 ≈

log(1

not crucial.

−

−

18

(a)

(3)

Q

τ

3

(b)

0.4

0.2

δE12(C)
δE13(C)
δE23(C)
δε
12(x)
δε
13(x)
δε
23(x)

τ
1

Q(1)

τ

2

(2)

Q

0

0

s
C
12

s
x
12

1

N2 ≈

Fig. 9: (a) Evolution tree linking three sequences Q(1), Q(2), and Q(3). The sequences have evolu-
tionary distances τ1, τ2, and τ3 to the branching point of the tree, as deﬁned by Eq. (26), and have
5000. (b) Alignment data δE12, δE13 and δE23 for pairwise alignments of
lengths N1 ≈
the sequences at diﬀerent values of γ, shown as a function of C(γ). δ
E23 obtained
E13, and δ
by rescaling the raw alignment data by respective factors U12, U13, and U23 such that the max-
ima of the rescaled curves fall on the theoretical locus (xs(y), δ
s(y)) (long-dashed curve, cf. Fig.
7(b)). This determines the a priori unknown similarity coeﬃcients Uij, and hence the evolutionary
distances τi.

E12, δ

N3 ≈

E

Finally, we construct the pairwise alignments of highest ﬁdelity. From Fig. 8(a), they
are seen to satisfy the approximate relation C ∗ij/C s
1.2 for 0.1 < y < 4.
0.225, and C s
With the values C s
0.254 read oﬀ from Fig. 9(b) and
using Eq. (15) with the constants of Fig. 6, we obtain the optimal alignment parameters
γ∗12 ≈
0.18,
E
s
0.52 as seen
δ
23 ≈
E
∗13 = 0.65,
from Fig. 8(b). They are in good agreement with the actual maxima

12 ≈
1.59, γ∗23 ≈
1.52, γ∗13 ≈
0.15 determine the expected ﬁdelities

1.25. The scaled score maxima δ
∗13 ≈
∗12 ≈

ij = x∗ij/xs
23 ≈

0.26, δ
∗23 ≈
F
∗12 = 0.8,

s
12 ≈
E
0.58,

0.23, C s

s
13 ≈

13 ≈

ij ≈

F
∗23 = 0.55 computed by comparing directly to the evolutionary paths.

0.75,

F

F

F

F

5 Discussion

We have presented a statistical scaling theory for global gapped alignments. Alignments of
mutually uncorrelated sequences are found to be governed by a number of universal scaling
laws: ensemble averages such as the mean square displacement of the alignment path or
the variance of the optimal score follow power laws whose exponents do not depend on the
scoring parameters. The parameter dependence is contained entirely in the prefactors. This
universality is comparable to the diﬀusion law describing a large variety of random walk
processes on large scales, the only parameter dependence being the value of the diﬀusion
constant. In contrast to diﬀusive random walks, however, we ﬁnd optimal alignment paths
to be strongly non-Markovian on all length scales due to random agglomerations of matches
and mismatches. Hence, the exponents take nontrivial values. The scaling laws also govern
the displacement statistics of a single alignment path r(t) and the associated statistics of
partial scores, which makes these concepts applicable to individual alignment problems.

19

This scaling theory is also relevant for the statistics of mutually correlated sequence pairs.
Two important quantities are the score gain over uncorrelated sequences and the alignment
ﬁdelity. Both quantities strongly depend on the evolutionary parameters linking the two
sequences and on the alignment parameters. For a simple Markovian evolution model and
for linear scoring functions, we have obtained a quantitative description of this parameter
In particular, the alignment parameter of maximal ﬁdelity turns out to be
dependence.
closely related to the parameter of maximal score gain, which makes it possible to construct
the alignment of maximal ﬁdelity from a systematic analysis of score data. Moreover, the
underlying evolutionary parameters (the mutual similarity U and the eﬀective indel rate q)
can also be inferred from this analysis.

It is important to understand inhowfar the results of this paper carry over to more reﬁned
algorithms for the alignment of realistic sequences. The universal scaling laws for uncorre-
lated sequences should prove to be very robust under changes of the scoring function (such
as scoring matrices distinguishing between transitions and transversions) as well as changes
in the sequences (the number of diﬀerent letters and their frequencies). As corroborated by
preliminary numerical results, such changes reduce to a diﬀerent parameter dependence of
the amplitude functions A, B, C, and D. In particular, we ﬁnd the universal scaling laws
to be preserved for the alignment of bona ﬁde uncorrelated cDNA sequences, which also
validates the Markov model for single sequences. While not aﬀecting the asymptotic uni-
versality, some scoring functions (for example, systems with aﬃne gap cost distinguishing
between gap initiation and gap extension) may introduce intermediate regimes where the
score and ﬁdelity curves are modiﬁed. Nevertheless, the ﬁdelity and the score gain remain
key quantities of an alignment, and their optimal values are closely related. This makes it
possible to construct optimal alignments on the basis of a statistical analysis of score data.
This link and the underlying scaling theory are also crucial to the analysis of local alignment
algorithms, as we have shown recently (Hwa and L¨assig, 1998; Drasdo et al., 1998).

Acknowledgments. The authors are grateful to Stephen Altschul, Steven Benner, Richard
Durbin, Charles Elkan, Walter Fitch, Jeﬀ Thorne, Martin Vingron, and Michael Waterman
for conversations and suggestions. TH acknowledges the ﬁnancial support of an A. P. Sloan
Research Fellowship, an Arnold and Mabel Beckman Foundation Young Investigator Award,
and the hospitality of the Max-Planck Institute at Teltow where much of the work was
carried out.

20

Appendix A: Evolution model

The Markov process governing the evolution of a daughter sequence Q′ from an ancestor
sequence Q is speciﬁed by the ﬂux diagram of Fig. 10.

i = N

i < N

i->i+1

delete Q

i

i = 1

p~

p~

1-2
p~

substitute
Q  by X

i

p

1-p

add X
left of Q

i

conserve 
Q

i

Fig. 10: Flux diagram of the Markov evolution process. A realization generates a daughter se-
. The process is characterized by the
Q′j}
quence Q′ =
{
insertion/deletion probability

p and the substitution probability p. X denotes a random letter.

from an ancestor sequence Q =

Qi}
{

The statistical properties of this Markov process are straightforward to compute. Using

j

i, we ﬁnd R(t) to be a Gaussian random variable with

the notation t

≡

e
i + j and R

≡

−

R(t) = 0 ,

R2(t) = qt ,

where q is given by Eq. (2). This implies in particular that the length N ′ of the daughter
sequence is also a Gaussian random variable with

N ′ = N ,

(N ′ −

N)2 = 2qN .

Appendix B: Alignment Algorithm

The dynammic programming algorithm generates the score landscape S(r, t) for all grid
points by the recursion relation

with

S(r, t) = max

S(r
1, t
−
S(r + 1, t
S(r, t

1)
−
1)
2) + s(r, t) 
−


−
−

γ
γ

−








s(r, t) =

√c

1

−
1
√c

1

−

(

−

if Q′(r+t)/2 = Q(r
if Q′(r+t)/2 6
= Q(r

−

−

t)/2

t)/2

.

This recursion relation is evaluated in a restricted alignment grid shown in Fig. 11, which
L. The value of L is chosen according to the
limits the computing time to a value

T

∼

×

21

(27)

(28)

(29)

(30)

i

j

T

L

t

r

Fig. 11: Restricted alignment grid (bounded by thick lines) used for the evaluation of the recursion
relation (29). With initial condition (i), the alignment paths are pinned at their initial point (dot)
deﬁned to be at t = 0. With initial condition (ii), the score is prescribed along the dashed line
deﬁned to be at t = 0, namely S(r, t = 0) = 0.

≡

−

i+j) or (ii) S(t = 0) = 0 (with t

speciﬁc application (see below). Along the strip, we use periodic boundary conditions, i.e.,
S(r
L/2, t) = S(r + L/2, t). (Similar results are obtained for open boundary condition.)
Two types of initial conditions are used depending on the speciﬁc application: (i) r(t = 0) = 0
(with t
L/2). Evaluation of the recursion relation
i+j
r0(T ) given
stops at t = T . Hence, the optimal alignment path r0(t) ends at the point r0 ≡
by S(r0, T ) = minr S0(r, T ). If the score values S0(r, T ) are degenerate for diﬀerent values of
r, one of them is chosen at random. The entire path r0(t) is then found by backtracking it
from its endpoint r0. Degeneracies are again resolved by a random choices. This is justiﬁed
since degenerate optimal paths have a typical distance of order 1 only. For more precise
formulations of this “macroscopic uniqueness”, see Fisher and Huse (1991), Hwa and Fisher
(1994), Kinzelbach and L¨assig (1995).

−

≡

To compute the unconstrained ﬂuctuations of optimal alignments for uncorrelated se-

quences, L has to be suﬃciently large so that the result becomes independent of it: L2
≫
(∆r0(T ))2. The displacement ﬂuctuations (∆r0(t))2 and the tilt cost δEt(θ) are evaluated
with the pinned initial condition (i); in the latter case, also the endpoint r0 = θT is pinned.
The score variance (9) is computed with the initial condition (ii).

On the other hand, the conﬁnement cost δEc(rc) is determined by choosing L

rc and

T

L3/2t0(γ) so that the result becomes independent of T and of the initial condition.
≫
For correlated sequences, we choose L again large enough so that the result becomes
tc, quantities deﬁned per unit of t such as

(∆R(T ))2 + r2

independent of it: L2

c . For T

≡

and δE will also become independent of the initial condition.

≫

≫

F

22

References

Altschul, S.F., Gish, W., Miller, W., Myers, E.W. and Lipman, D.J. 1990. Basic local align-
ment search tool. J. Mol. Biol. 215 (3), 403 – 10.

Altschul, S.F. 1993. A protein alignment scoring system sensitive at all evolutionary dis-
tances. J. Mol. Evol. 36 (3), 290 - 300.

Arratia, R., Morris, P. and Waterman, M.S. 1988. Stochastic scrabbles: a law of large num-
bers for sequence matching with scores. J. Appl. Probab. 25 106 – 19.

Arratia, R. and Waterman, M.S., 1994. A phase transition for the score in matching random
sequences allowing deletions. Ann of Appl. Prob. 4, 200 – 25.

Benner, S.A., Cohen, M.A. and Gonnet, G.H. 1993. Empirical and structural models for in-
sertions and deletions in the divergent evolution of proteins. J. Mol. Biol. 229 (4), 1065 – 82.

Bishop, M.J. and Thompson, E.A. 1986. Maximum likelihood alignment of DNA sequences.
J. Mol. Biol. 190 (2), 159 - 65.

Cule, D. and Hwa, T. 1998. Static and Dynamic Properties of Inhomogeneous Elastic Media
on Disordered Substrate. Phys. Rev. B. in press.

Drasdo, D., Hwa, T. and L¨assig, M. 1997. DNA sequence alignment and critical phenomena.
Mat. Res. Soc. Symp. Proc. 263, 75-80.

Drasdo, D., Hwa, T. and L¨assig, M. 1998. A statistical theory of sequence alignment with
gaps, submitted to The Sixth International Conference on Intelligent Systems for Molecular
Biology.

From MEDLINE; 96096722, cf Exposito J.Y., Boute N., Deleage G., Garrone R.. 1995.
Characterization of two genes coding for a similar four-cysteine motif of the amino-terminal
propeptide of a sea urchin ﬁbrillar collagen. Eur. J. Biochem. 234:59-65.

From MEDLINE; 94215495, cf. Fehon R.G., Dawson I.A., Artavanis-Tsakonas S. 1994. A
Drosophila homologue of membrane-skeleton protein 4.1 is associated with septate junctions
and is encoded by the coracle gene. Development 120:545-557.

Fisher, D.S. and Huse, D.A. 1991. Directed paths in a random potential. Phys. Rev. B 43
(13), 10728 - 10742.

Gusﬁeld, D., Balasubramanian, K., and Naor, D.. 1992. Proceedings of the Third Annual

23

ACM-SIAM Symposium on discrete Algorithms, January 1992, 432.

Hwa, T. and Fisher, D.S. 1994. Anomalous ﬂuctuations of directed polymers in random
media. Phys. Rev. B 49, 3136 – 54.

Hwa, T. and L¨assig, M. 1996. Similarity detection and localization, Phys. Rev. Lett. 76,
2591 - 2595.

Hwa, T. and Nattermann, T. 1995. Disordered induced depinning transition, Phys. Rev. B
51, 455 - 469.

Hwa, T. and L¨assig, M. Optimal detection of sequence similarity by local alignment. Proc.
of the Second Annual Conference on Computational Molecular Biology (RECOMB98), in
press. E-print cond-mat/9712081.

Karlin, S. and Altschul, S.F. 1990. Methods for assessing the statistical signiﬁcance of molec-
ular sequence features by using general scoring schemes. Proc. Natn. Acad. Scie. U.S.A.
87 (6), 2264 - 8.

Karlin, S. and Altschul, S.F. 1993. Applications and statistics for multiple high-scoreing
segments in molecular sequences. Proc. Natn. Acad. Scie. U.S.A. 90 (12), 5873 - 7.

Koretke, K.K., Kutheyschulten, Z., Wolynes, P.G. 1996. Self-consistently optimized statis-
tical mechanical energy functions for sequence structure alignment Prot. Sci. 5, 1043-1059.

Kardar, M. 1987. Replica Bethe ansatz studies of two-dimensional interfaces with quenched
random impurities. Nucl. Phys. B 290, 582 - 602.

Kinzelbach, H. and L¨assig, M. 1995. Depinning in a random medium. J. Phys. A: Math.
Gen. 28, 6535 - 6541.

Licea, C. and Newman, C.M. 1996. Geodesics in two-dimensional ﬁrst-passage percolation.
Ann. Probab. 24, 399 – 410.

Licea, C., Newman, C.M., and Piza, M.S.T. 1996. Superdiﬀusitivity in ﬁrst-passage perco-
lation. Probab. Theory Relat. Fields 106, 559 – 91.

Onuchic, J.N., LutheySchulten, Z., Wolynes, P.G. 1997. Protein folding funnels: the nature
of the transition state ensemble. Ann. Rev. Phys. Chem. 48, 545-600, and references
therein.

Needleman, S.B. and Wunsch, C.D. 1970. A general method applicable to the search for

24

similarities in the amino acid sequence of two proteins. J. Mol. Biol. 48 (3), 443 - 53.

Pearson, W.R. 1991. Searching protein sequence libraries: comparison of the sensitivity and
selectivity of the Smith-Waterman and FASTA algorithms. Genomics 11 (3), 635 - 650.

Smith, T.F. and Waterman, M.S. 1981. Identiﬁcation of common molecular subsequences.
J. MOl. Biol. 147, 195 – 7.

Thorne, J.L., Kishino, H. and Felsenstein, J. 1991. An evolutionary model for maximum
likelihood alignment of DNA sequence J. Mol. Evol. 33 (2), 114 - 24

Thorne, J.L., Kishino, H., and Felsenstein, J. 1992. Inching toward reality: an improved
likelihood model of sequence evolution. J. Mol. Evol. 34 (1), 3 - 16.

Vingron, M. and Waterman, M.S. 1994. Sequence alignment and penalty choice. Review of
concepts, case studies and implications. J. Mol. Biol 235 (1), 1 - 12.

Wang, J., Onuchic, J., Wolynes, P.G. 1996. Statistics of kinetic pathways on biased rough
energy landscapes with application to protein folding.
Phys. Rev. Lett. 76, 4861-4864.
Waterman, M.S., Gordon, L. and Arratia, R. 1987. Phase transitions in sequence matches
and nucleic acid structure. Proc. Natl. Acad. Sci. U.S.A. 84 (5), 1239 - 43.

Waterman, M.S. 1989. In Waterman, M.S, ed., Mathematical Methods for DNA Sequences.
CRC Press.

Waterman, M.S. Eggert, M. and Lander, E. 1992. Parametric sequence comparisons. Proc.
Natn. Acad. Scie. U.S.A. 89 (13), 6090 - 3.

Waterman, M.S. 1994. Introduction to Computational Biology, Chapman & Hall.

Waterman, M.S. 1994. Parametric and ensemble sequence alignment algorithms. Bull.
Math. Biol. 56 (4), 743 - 767.

Zhang, M.Q. and Marr, T.G. 1995. Alignment of molecular sequences seen as random path
analysis. J. Theo. Biol. 174 (2), 119 - 29.

25

