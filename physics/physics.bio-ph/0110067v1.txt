1
0
0
2
 
t
c
O
 
3
2
 
 
]
h
p
-
o
i
b
.
s
c
i
s
y
h
p
[
 
 
1
v
7
6
0
0
1
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Hamming distance geometry of a protein conformational space.
Application to the clustering of a 4 ns molecular dynamics trajectory of the
HIV-1 integrase catalytic core.

Cyril Laboulais2, Mohammed Ouali3, Marc Le Bret2

and Jacques Gabarro-Arpa1 2 ∗

1) Ecole Normale Sup´erieure / C.N.R.S.

Laboratoire Interdisciplinaire de G´eometrie Appliqu´ee
45, rue d’Ulm, 75230 Paris cedex (France)

2) LBPA, C.N.R.S. UMR 8532, Ecole Normale Sup´erieure de Cachan
61, Avenue du Pr´esident Wilson, 94235 Cachan cedex (France)

3) University of Wales, Department of Computer Science

Group of Computational Biology, Penglais, Aberystwyth SY23 3DB (Wales)

Abstract

Protein structures can be encoded into binary sequences1, these are used to deﬁne a Hamming
distance in conformational space: the distance between two diﬀerent molecular conformations is
the number of diﬀerent bits in their sequences.

Each bit in the sequence arises from a partition of conformational space in two halves. Thus,
the information encoded in the binary sequences is also used to characterize the regions of con-
formational space visited by the system.

We apply this distance and their associated geometric structures, to the clustering and analysis
of conformations sampled during a 4 ns molecular dynamics simulation of the HIV-1 integrase
catalytic core.

The cluster analysis of the simulation shows a division of the trajectory into two segments
of 2.6 and 1.4 ns length, which are qualitatively diﬀerent: the data points to the fact that
equilibration is only reached at the end of the ﬁrst segment.

Some length of the paper is devoted to compare the Hamming distance to the r.m.s. deviation
measure. The analysis of the cases studied so far, shows that under the same conditions the two
measures behave quite diﬀerently, and that the Hamming distance appears to be more robust
than the r.m.s. deviation.

∗ Corresponding author. Electronic Address: gabarro@dmi.ens.fr

1

Introduction

Proteins are mesoscopic systems with a complex potential energy surface that can be char-
acterized by its locally stable conformations, which are local potential energy surface minima
(PESM). There is evidence that proteins move between these conformational substates and that
they can exist in many levels2,3. Because of their complexity, methods for analyzing these multiple
minima can be very useful.

Molecular dynamics simulations (MD) is one of the available techniques for simulating the
wandering of such systems across their potential energy surface. To detect the energy substates
visited by the resulting trajectory we make the assumption that the structures found in PESMs
are more related to each other than to conformations in other minima; thus, we follow the
approach that consists in using clustering algorithms to partition the trajectory into groups of
similar conformers, as has been done by a number of authors1,4-7. This allows to extract useful
information and at the same time reducing to tractable dimensions the ever growing number of
data in these computer experiments.

To put related conformations together we need a distance in conformational space. In this

paper we use a Hamming distance between conformations1, which is built as follows:

1) we assume that there is an order relation among the N atoms in the molecule,

2) we form the set of all P =

ordered 4-tuples of atoms,

N
4 (cid:1)

(cid:0)

3) for each ordered 4-tuple of atoms {a, b, c, d}, we calculate the signed volume of the 3-simplex

determined by the position of these four atoms:

V = 1/6

2 xa
2 xb
2 xc
2 xd

3 1
3 1
3 1
3 1

1 xa
xa
(cid:12)
xb
1 xb
(cid:12)
(cid:12)
1 xc
xc
(cid:12)
(cid:12)
xd
1 xd
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

4) from it we deﬁne

χ(a, b, c, d) = 


1
0
−1

V > 0
V = 0
V < 0



(1)

(2)

the set of all χ is called the chirotope, it is a binary sequence (if we discard the 0 value as it
corresponds to a set of null measure). It deﬁnes an equivalence relation among conformations:
two conformations are equivalent if they have the same chirotope. When comparing two confor-
mations, whenever a 4-tuple χ value has diﬀerent signs we call it a mutation: the number of
mutations between two conformations is a Hamming distance.

The Hamming distance and its associated geometrical structures, as a tool for peering at the
energy landscape of a protein, is the subject of this paper. The Hamming distance has a number
of interesting features which can be summarized as follows:

- It is a true distance obeying the triangle inequality.

- It is sensitive to chirality.

- It is computed over a great number of binary topological descriptors.

2

- 4-tuples give meaningful geometric objects in the space of conformations, since each one

determines a partition of this space into positive and negative halves.

The latter can help to put limits on the regions occupied by a particular trajectory segment,

or to determine the crossing frequency for some boundaries, as we shall see below.

In what follows we develop our subject around the study of a 4 ns MD trajectory of the HIV-1

integrase catalytic core.

Molecular dynamics

The simulated molecule is the HIV-1 integrase catalytic core (residues 50-212 of the integrase);
it contains the single mutation F185H and is studied in the presence of its cofactor, an Mg++
ion. It was taken from the molecule C of the 1bl3 PDB ﬁle8 for which the coordinates of all the
residues in the catalytic loop are available. The end residues (50, 211 and 212) were added to
the structure which was then minimized using our quasi-newtonian minimizer9.

As the total charge of the protein with the Mg++ cation is +1, to ensure electric neutrality
an extra Cl− anion was added into the simulation box. The 13 nearest water molecules to the
Mg++ cation were positioned as in the PDB ﬁle. The EDIT module of AMBER10 was modiﬁed
A3 could be ﬁlled with TIP3P water molecules having a
so that a box of given size 50 × 60 × 50
density of 1, which amounted to a total of 3822+13 water molecules for 2517+2 solute atoms.

o

The SANDER module of AMBER was used to simulate the dynamics. The force ﬁeld11 was
complemented with the parameters of Mg++ and Cl− ions12. Long range coulombic interactions
o
were calculated using the particle mesh Ewald method13, with a 10
A cut oﬀ, and grid size
50 × 60 × 50.

Covalent bonds containing a proton were constrained to their equilibrium length using the
SHAKE algorithm14. The simulation was run in 2 fs steps, at 300 K constant temperature and
1 atm constant pressure. No correction was applied for the neglected long-range van der Waals
interactions because they are expected to be small.

The protocol to set the water around the protein and ions, and starting the simulation was

discussed in ref. 15. It consists of the following steps:

• 5 ps of water heating from 0 K to 300 K with the ions and protein constrained to their

initial positions,

• next the system was restarted at 10 K and heated to 300 K, in intervals of 25 K and 1 ps.

As in the previous step only water was allowed to move.

• After 3.6 ps at 300 K, the system was restarted at 10 K and heated again to 300 K in

intervals of 50 K and 3 ps without any constraints.

• Finally, after reseting the velocities, we let the system evolve in an equilibration step lasting

13 ps at 300 K.

Once this protocol was ﬁnished the simulation was started and let run for a total simulated
time of 4 ns, conformations were sampled every 0.1 ps giving a total of 40000 coordinate frames.
The data were visualized and analysed using the program Cadira16.

Analysis of the space of conformations

A lot of information can be encoded in the chirotope. In this paper we will use it to extract
information concerning the trajectory behaviour in the regions of conformational space it crosses.

3

Each 4-tuple has an associated geometric structure, since for a given conformation its χ
value can be either positive or negative, it determines a partition of the space of conformations
into positive and negative halves. We deﬁne an event as the crossing by the trajectory of the
boundary separating a tuple’s positive from negative conformations.

For each tuple we call major halfspace the one in which the trajectory stays the longest and
we call minor halfspace the other one. There is a binary sequence associated with each tuple of
length the number of coordinate frames in the trajectory. For each frame the sequence has a value
0 or 1 depending if its conformation lies in the tuple’s major or minor halfspace, respectively. An
event corresponds to a change of value in the sequence.

We illustrate our point with ﬁg. 1, where conformational space is represented, for purposes
of illustration, as a two dimensional surface crossed by lines representing the separation between
positive and negative halves associated with given tuples. Suppose that the trajectory evolves
between two regions where it can get momentarily trapped, maybe because they correspond to
PESMs, as depicted in ﬁg. 1: the ﬁrst one, R1, large with shallow boundary walls; the second,
R2, somewhat smaller with a steep boundary.

The tuple separation lines within these regions fall into three classes:

- speciﬁc, those that only cross one region, lines beginning by s in ﬁg. 1,

- non-speciﬁc that cross more than one region, ns lines,

- and those that fall in between, lines beginning by b.

See the legend of ﬁg. 1 for typical example sequences associated with these tuples. We say that a
given tuple is speciﬁc (non-speciﬁc) if its associated separation boundary is speciﬁc (non-speciﬁc)
respectively.

Among speciﬁc tuples we can make a distinction between two extreme cases: some that cut
a region across the center and others that only scratch the border, sm and sw lines in ﬁg. 1
respectively.

Concerning the separation lines associated with sw tuples we see that they are only crossed
for a brief lapse of time, the trajectory bouncing on the region’s walls and inmediately coming
back to the interior; the sequence of these tuples will only harbor a few events, with a minimum
of two. A diﬀerence between regions R1 and R2 is that the latter has steeper walls; so, we expect
that for sw tuples in R2 the average number of frames lying in the tuple minor halfspace will be
less than for sw tuples in R1 which is shallower.

On the other hand sm tuples are crossed repeatedly while the trajectory stays within the
region. They give rise to sequences with many mutation events within the corresponding sequence
subset (see legend in ﬁg. 1).

b tuples are crossed when the trajectory goes in between two such regions, and as can be

deduced from ﬁg. 1, they will give sequences with mostly one sign for each region.

The classes of tuples deﬁned above are based on a purely qualitative distintion. Actually,
there is no a sharp separation between them. As can be seen from ﬁg. 3 they form a continuum.
In order to characterize a trajectory interval that stays conﬁned in a region of the space of
conformations, a previous work1 introduced a parameter: the activity coeﬃcient D, which can
be calculated with the following procedure:

- ﬁrst, we calculate the total number of events generated by the speciﬁc tuples in this cluster

Es

- second, we calculate the same quantity on every homologous cluster along the trajectory

and we take the mean value < Es >

4

- the activity coeﬃcient D will be the ratio Es/ < Es >.

The assumption is that D will exhibit a value greater than one for trajectory intervals that remain
conﬁned due to repeated bouncing on domain walls.

Clustering

The basic assumption behind the clustering methodology is that the presence of a potential
well in conformational space can trap the system. So a relatively long trajectory segment can
evolve in a small region of conformational space, giving a set of closely related structures that
are easily detectable with an appropiate clustering algorithm1,4-7.

In this paper we employ hierarchical data clustering, which is a process that transforms a
proximity matrix into a dendogram: a tree representing a hierarchy of categories of clusters.
There are other approaches to data clustering but we employ hierarchichal methods because the
energy landscape of a protein is supposed to consist of an hierarchical embedding of potential
wells17-20.

Again we have two categories of hierarchical algorithms: agglomerative and divisive. Divisive
algorithms were tested before1 and they were not found to perform very well, thus in this paper
we restrict ourselves to agglomerative ones. These work as follows: for a set of n elements we
begin with a structure with n clusters, one per object, and grow a sequence of clusterings until
all n patterns are in a single cluster. At each step two clusters are reunited if they optimize a
given criteria.

We use the complete-linkage, or farthest-neighbour algorithm, in which the distance between
subsets is the maximum distance between a pair of elements one in each subset. The complete-
linkage hierarchy can be computed in O(n log2n) time21. One reason for choosing this particular
algorithm is that it enhances cluster separation and we think it is more adequate for studying
long trajectories.

One problem with clustering algorithms is that clusters will always be found even if the data
are entirely random, so we need procedures that help us to determine which clusters do really
correspond to PESMs. Here we employ two diﬀerent methods: the ﬁrst one, as explained in the
previous section, the likelyhood of PESM activity for each cluster is estimated with the parameter
D. Following our analysis of conformational space, a PESM should display a greater than average
number of speciﬁc events specially in the range of sw tuples, thus a D value high above 1 can be
considered a reliable indicator. In order to validate our conformational space methods, we used
energy minimization as our second test procedure, as it is described in the following section.

Two distance matrices were built from the set of Cα carbons exclusively6,7: one based on the
Hamming distance as described above, and another based on the r.m.s. deviation (RMSD). The
latter is given by22:

N

R

kR.xa

i − xb

RMSD = min

( 1
N
Pi
where N is the total number of atoms, xa
i denote the atomic coordinates of the ith atom
of structures a and b in a common center of mass coordinate system, the distance is the minimum
taken over all 3 × 3 rotation matrices R.

i and xb

i k2)1/2

The reason for choosing the RMSD from the set of available distance measures5, is that,
as for the Hamming distance, it applies to a set of equivalence classes in conformational space:
two conformations a and b are in the same equivalence class if there exists a rotation and a
translation in three-dimensional space that transform b into a .

As deﬁned above the distance between any two such equivalence classes is the minimum r.m.s.

between any two conformations one in each class.

5

Moreover, the classes belonging to this set are obviously embedded in the equivalence classes

deﬁned by the chirotope, as lower dimensional manifolds.

Comparison with other similarity measures, like the r.m.s. diﬀerence between correspond-
ing torsion angles, and the r.m.s. deviation of intramolecular distances5,6, was not considered
meaningful since they do not operate on cartesian conformational space, like the RMSD and the
Hamming distance.

Energy Minimization

A PESM acts as an attractor on the trajectory which can get stuck in it for a while. The
structures sampled along the corresponding segment of the trajectory will form a cluster of
similar conformations. The contrary may not be true: a cluster of similar conformations does
not necessarily indicate the presence of an energy surface minima. We use energy minimization
as an alternative method to see if a cluster represents a feature of the energy lanscape.

In a ﬁrst approximation, a PESM can be thought as a paraboloid shaped structure, that
becomes narrower as we approach towards the minima. Thus, upon moderate minimization the
distance between any two conformations in a cluster will decrease.

We performed energy minimization on structures belonging to clusters of homologous con-
formers using the module SANDER from AMBER10. Minimization was perfomed with the ewald
option, up to a maximum r.m.s. gradient of 0.4, which is somewhat high. However, enhanced
minimization is not of much use in our case since the eﬀective potential surrounding the protein
depends upon the organization of the solvent and ions. Continued minimization will disrupt this
structure by inducing extensive reorganization of the water network.

This precludes the use of energy minimization to estimate the size of features in the energy
lanscape, as well as identifying smaller minima within PESMs. But it is enough to observe a
shrinking of r.m.s. deviations (RMSDS) between elements of the cluster which is an indicator
of the presence of a PESM, otherwise in this paper we did not attempt at resolving the ﬁne
structure.

Results

From the 28342440 4-tuples present in our system 25 percent undergo at least one mutation
during this dynamics run. Between conformations 5 ps away we observe a minimum distance of
525922 and a maximum of 2479784.

The dendogram, ﬁg. 2, clearly separates the frames into two big clusters we call A and B:
cluster A harbors the ﬁrst 2.6 ns, cluster B spans 1.4 ns until the end of the run (see table I for a
description of the main clusters). Cluster A has an activity coeﬃcient of 6.86 and is dominated
by a big subcluster: A0, 1.4 ns in length with a staircase structure. Interestingly A0 contains
the clusters at the deepest level in the hierarchy which are organized around the initial structure:
the cluster A00 spanning the ﬁrst 45 ps has an activity coeﬃcient of 11.07, it is embedded in
cluster A01 which spans the ﬁrst 255 ps with a coeﬃcient 7.76 (see ﬁg. 3a for a plot showing the
spectrum of this cluster). This shows that the region around the initial structure exhibits PESM
activity and is well separated in conformational space from the rest of the trajectory.

As we climb cluster A0 up to the top the activity coeﬃcient gradually disminishes up to
a minimum of 1.94 at the top, where the sw-tuple activity has completely disappeared from
the spectrum, but there still remains a high distribution of sm-tuples (see ﬁg. 3b). This trend
continues past A0 up to A which also displays little sw-tuple activity (see ﬁg. 3c).

It is diﬃcult to discern a prominent feature inside A0; it seems as if the trajectory could not
get away from the artiﬁcially created PESM around the energy minimized initial structure, and
this PESM structure were slowly decaying.

6

Interspersed within the segment of the trajectory spanned by A0 there are clusters A1, A3
and A5 which exhibit genuine PESM activity, since they have a well deﬁned s-tuple activity as
well as RMSDS upon minimization. However, analysis of their tuple spectrum (ﬁg. 3d) shows a
lack of signiﬁcant b-tuple activity for these clusters; this seems to indicate that they could arise
as a bulge from the main cluster: the trajectory gets momentarily out of A0 and then plunges
back.

Consistent with this observation is the fact that A1, A3 and A5 lie higher in the cluster

hierarchy than A0, indicating that they are somewhat distant from it in conformation space.

Clusters which are relatively close to A0, A2 and A4 display RMSDS, but like A0 their sw-
tuple activity is negligible. This trend goes up to the parent cluster A whose spectrum is rich in
sm-tuples and b-tuples, indicating that it is well separated from the rest of the trajectory as well
as some internal structure. However its sw-tuple is no more than average (see ﬁg. 3c). Only the
clusters around the initial energy minimized structure A00 and A01 and the bulge clusters A1,
A3 and A5 display any sw-tuple activity.

This contrasts with the situation in B whose spectrum (depicted in ﬁg. 3e) shows activity
for every class of tuples all along the hierarchy, down to the bottom. Besides all clusters in this
part of the dendogram, from B1 to B5, appear to be well separated. They represent continuous
trajectory segments, and all, except B3, exhibit PESM activity either from the tuple spectrum
or from RMSDS (see table I). B3 is an exception, it spans a continuous strecth of the trajectory
from 2.97 to 3.53 ns. No PESM activity of any kind is detected for this cluster. Activity is only
detected down the hierarchy for small clusters spanning less than 100 ps. These data are not
shown since at this point our dendogram attains its limit resolution.

As before, the end of the trajectory, spanned by cluster B5, (see ﬁg. 2 and ﬁg. 3f) appears

at the deepest level in cluster B.

When we apply tuple spectrum analysis separately for clusters A and B we obtain qualita-
tively the same results on both, except for cluster A5. The activity coeﬃcient of this cluster
increases considerably, but this is not unexpected since it lies at the extremity of the trajectory
segment of cluster A. From this spectrum invariance of tuples encoding the ocupation structure
of conformational space, for A and B, we can conclude that there is little interference between
the two regions and that the two consecutive segments of the trajectory they contain are well
separated in conformational space.

In the upper right part of ﬁg. 4 we have plotted the Hamming distance matrix, clusters A

and B (see table I) are easily identiﬁed by simple visual inspection.

Comparison with r.m.s. clustering

Clustering can be performed using other measures than Hamming distance, as a comparison

we have used the RMSD22, which is a widely used similarity measure.

The dendogram which results from r.m.s. deviation clustering, using the same protocol as
above, can be seen in ﬁg. 5a. It is composed of two big clusters, superﬁcially each one looks like
A0 in ﬁg. 2: they are an aggregation of small clusters of average length 100 ps, no other visual
features can be discerned. A closer look to the data gives the following:

• The two main clusters correspond to discontinuous trajectory segments.

• Clusters A00 and B5 which contain the extremities of the trajectory, appear at branching
levels relatively close to the root of the tree, moreover B5 comes in two separated clusters.
Indeed the three is not well balanced.

• In ﬁg. 5a we have underlined clusters which correspond to fragments of clusters identiﬁed
in the dendogram of ﬁg. 2 (with the exception of A0). Many previously identiﬁed clusters

7

(harboring continuous trajectory segments) appear fragmented, some of them scattered
over many branchs.

Obviously the protocol used for the Hamming distance gives poor results when used with the
RMSD.

From a previous work using the same protocol1, it was reported more meaningful results with
RMSD clustering. However, they were obtained for a 1 ns trajectory, which is four times shorter
than the present one, and the protein studied was the bovine pancreatic trypsin inhibitor23, which
is about three times smaller than the one studied in the present work. Also in that occasion the
authors deemed not necessary to report that the dendogram tree was poorly balanced and that
the main branches harbored some discontinuities, two of the features identiﬁed above. The result
seemed acceptable because the analysis of the low level clusters, using discrete geometry tests,
closely matched the ones that had been previously identiﬁed using Hamming data clustering1.
Seen in the light of the present results it seems that the work with BPTI attained the limit
resolution that can be obtained with the above method, using the RMSD.

For sake of comparison, we have plotted in ﬁg. 4 the Hamming vs the r.m.s. distance matrices.
Although both display the most salient features, the Hamming distance matrix appears to be
much more detailed at the ﬁne grained level. This suggests that better results could be obtained
with RMSD if resolution were improved.

One way of improving resolution is to calculate the distance matrix using more atoms than
the Cα carbons, two possibilities were tested: one with all the backbone heavy atoms (carbonyl
carbon, amide nitrogen and Cα), another with all the protein heavy atoms. Neither works, with
the backbone heavy atoms option the resulting tree had a less monotonous appearence and had
improved balancing, but again it failed to resolve the main clusters, and many smaller clusters
(between 150 and 500 ps in length) corresponded to discontinuous trajectory segments.

The option involving all heavy atoms gave the worst results, the reason is that individual
regions along the protein jump between conformational substates, and the combination of all
these transitions distribute uniformly through conformational space, thus smearing the data6.

It may also happen that the complete-linkage is not the best clustering algorithm available 7,
at least when used together with RMSD. As in ref. 7 we have tried the average distance criterion,
where the distance between two clusters is taken as the average distance between the points in
one cluster and the points in the other.

The resulting dendogram, see ﬁg. 5b, yields better results for the RMSD (with all the back-
bone heavy atoms option): at least the algorithm correctly identiﬁes the main clusters A and
B, so we can compare with the results from previous section. It also identiﬁes the clusters cor-
responding to well deﬁned PESMs: A00, A01, A1, A5, and every cluster on the B side. The B
cluster obtained is quite close to the one in ﬁg. 2.

The same cannot be said of the A subtree: to begin with it is not correctly balanced, A00
and A01 appear close to the root; also, the two halves of A2 and A3 from ﬁg. 2, are in two
separate branches; ﬁnally, A4 is scattered over many branches. We think that this protocol can
be improved to give still better results, but in the scope of the present work, we do not see the
point in getting any further.

On the other hand the average distance cluster algorithm with the Hamming distance gives

a result quite similar to the one discussed in the previous section.

Discussion

After performing conformer structure clustering of an MD trajectory based on a Hamming
distance, the analysis of the dendogram shows a very strong PESM at the begining of the dy-
It surrounds the energy minimized structure created at the start of the run and lies
namics.

8

at the bottom of the hierarchy of a staircase shaped featureless cluster that spans 1.4 ns of the
trajectory.

This PESM dominates the initial part of the simulation, analysis reveals a slow decay: as we
climb the hierarchy of clusters along the stairs the activity disminishes steadily, this is due to a
waning of the sw part of the tuple spectrum, this low sw activity cluster indicates an absence of
sharp boundary walls. The initial PESM has progressively become shallower and structureless.
This process is ponctuated by incursions into smaller PESMs with high sw activity, pointing
to the presence of sharp boundaries, but totally absent b activity (see ﬁg. 3d), indicating that
these PESMs may be a temporary bulge.

This behaviour may be attributed to the eﬀect of the protocol used in preparing the dynamics
run; the whole system is assembled from separate subsystems: the crystallographic structure for
the protein and a cube containing a Monte Carlo generated distribution of water, which are
relaxed separately. The result is that the ﬁnal system is only locally equilibrated. The use
of the Ewald summation method to calculate long range interactions contributes a great deal,
since it enhances the sensitivity of the system to global conditions. The anomalous structure
in the protein dendogram ﬁrst half can be attributed to the fact that the system is only locally
equilibrated, global equilibrium being attained much later in the dynamics run.

This kind of behaviour has already been reported24. There is however a diﬀerence between
their results and ours: in the ﬁrst half of the dynamics, their conformations appear to be much
more uncorrelated than ours (see ﬁg. 3 in ref. 24). We may attribute this diﬀerence to the
fact that, in our case, the Ewald summation method is more constraining for the protein struc-
ture. Thus explaining the attraction exerted by the initial structure during the early part of the
simulation.

Cluster B has a number of well separated subclusters showing clear PESM activity. They
correspond more to the expected behaviour of a protein with the trajectory jumping between
metastable substates17,20. Visual inspection of the distance matrix plot in ﬁg. 4 shows that
there is a clear separation between clusters A and B. The same can be said after analysing their
respective tuple spectrum (ﬁgs. 3c and 3e) showing a great number of speciﬁc b tuples, which
indicates that they lie in well separated regions of conformational space.

The dendograms built using a Hamming distance matrix reﬂect the degree of separation in
conformational space between diﬀerent trajectory segments: they are balanced binary trees over
the trajectory.

One conclusion that can be drawn from the comparison between Hamming and RMSD clus-
tering is that both measures are not equivalent: their behaviour can be radically diﬀerent under
a given clustering algorithm.

Another conclusion is that in the scope of the cases tested to this day, the Hamming distance
measure appears to be more robust than RMSD: it can perform fairly well with smaller data sets,
and gives consistent results at least with the two algorithms employed here. In the present work
the RMSD seems to work well only with averaged distances, something that was also reported
in ref. 7. We see three reasons for that.

First, hierarchical clustering algorithms rely upon iterative procedures, which in many cases
are known to be extremely sensitive to initial conditions 25, thus the observed instability of the
double linkage algorithm with the RMSD is not an uncommon behaviour.

Second, the r.m.s. deviation is built on N terms, while Hamming distance is evaluated over
N
binary descriptors, roughly O(N 4). The fact that increasing the number of atoms improves
4 (cid:1)
(cid:0)
the results of RMSD calculations seems to support this conclusion. Also, the Hamming distance
matrix in ﬁg. 4 appears to be more detailed at the ﬁne grained level than the r.m.s. deviation
matrix.

9

Third, the hierarchical structure of conformational spaces is built-in within the Hamming
distance. This follows from its physical interpretation as the minimum number of topological
transitions (i.e. a point crossing the plane deﬁned by three other), that have to be eﬀected to
transform one conformation into another. This has the eﬀect that no matter how much we change
this discrete distance by adding extra points, it remains that the old structure is always embedded
within the new one. This feature helps to understand the observed good scaling behaviour.

Conclusion

In this paper we aimed at describing a new distance measure for molecular conformational
space, and we used it for clustering the conformations sampled in the MD simulation of the HIV-1
integrase catalytic core.

We have described how molecular conformations can be characterized by a binary sequence:
the chirotope, in which each bit is the value of a binary topological descriptor. The distance be-
tween any two conformations is the number of diﬀerent bits between the corresponding sequences;
this is the deﬁnition of a Hamming distance, which is a discrete one.

We have shown that, in the cases studied so far, this measure works diﬀerently than the r.m.s.
deviation, which is a currently employed similarity measure, and most of the time works better.
We see two reasons for this:

1) the much greater number of descriptors used in computing our distance, thus embodying

far more information,

in conformational space.

2) the fact that our topological descriptors are related to well deﬁned geometrical structures

There lies the strength of the Hamming measure: it is built on meaningful structures in higher
dimensional space. This is useful for analyzing the geometrical features of the clusters obtained:
with the help of simple statistical data we can extract a lot of information from each one.

It appears that there are two qualitatively diﬀerent regions in our trajectory. The ﬁrst one is
dominated by an undiﬀerentiated cluster of conformations evolving from the initial conditions,
ponctuated by incursions into substates that may be transient inclusions or appendages. In the
second region the trajectory visits in succesion a series of well deﬁned conformational substates.
This analysis seems to indicate that the equilibration time of the system may be longer than
usually assumed. This same conclusion was reached in refs. 1 and 25. We suggest that the
information gathered be put to use to design better MD simulation protocols.

10

References

1. Gabarro-Arpa, J., Revilla, R. Clustering of a molecular dynamics trajectory with a Ham-

ming distance. Comput. and Chem. 24:693-698, 2000.

2. Noguti, T. and G¯o, N. Structural basis of hierarchical multiple substates of a protein.

Proteins: Struct. Funct. Genet. 5:97,104,113,125,132, 1989.

3. Frauenfelder, H., Sligar, S.G., Wolynes, P.G. The energy landscapes and motions of proteins.

Science 254:1598-1603, 1991.

4. Karpen, M.E., Tobias, D.J. and Brooks III, C.L. Statistical clustering techniques for the
analysis of long molecular dynamics trajectories: analysis of 2.2-ns trajectories of YPGDV.
Biochemistry 32:412-420, 1993.

5. Shenkin, P.S. and McDonald, Q. Cluster analysis of molecular conformations. J. Comput.

Chem. 15:889-916, 1994.

6. Torda, A.E. and van Gunsteren, W.F. Algorithms for clustering molecular dynamics con-

ﬁgurations. J. of Comput. Chem. 15:1331-1340, 1994.

7. Troyer, J.M. and Cohen, F.E. Protein conformational landscapes: energy minimization
and clustering of a long molecular dynamics trajectory. Proteins: Struct. Funct. Genet.
23:97-110, 1995.

8. Maignan, S., Guilloteau, J. P., Zhou-Liu, Q., Cl´ement-Mella, C., Mikol, V. Crystal struc-
tures of the catalytic domain of HIV-1 integrase free and complexed with its metal cofactor:
high level of similarity of the active site with other viral integrases. J. Mol. Biol. 282:359-
368, 1998.

9. Pothier, J., Gabarro-Arpa, J., Le Bret, M. MORMIN: a quasi-newtonian energy minimizer

ﬁtting the nuclear Overhauser data. J. Comp. Chem. 14:226-236, 1993.

10. Pearlman, D.A., Case, D.A., Caldwell, J.C., Ross, W.S., Cheatham III, T.E., Ferguson,
D.M., Seibel, G.L., Singh, U.C., Weiner, P., Kollman, P.A. AMBER 4.1, University of
California, San Francisco, 1995.

11. Cornell, W. D., Cieplak, P., Bayly, C. I., Goulg, I. R., Merz, K. M., Ferguson, D. M.,
Spellmeyer, D. C., Fox, T., Caldwell, J. W., Kollman, P. A. A second generation force ﬁeld
for the simulation of proteins, nucleic acids, and organic molecules. J. Am. Chem. Soc.
117:5179-5197, 1998.

12. Aqvist, J. Ion-water interaction potentials derived from free energy perturbation simula-

tions. J. Phys. Chem. 94:8021-8024, 1990.

13. Durden, T.A., York, D., Pedersen, L. Particle mesh Ewald: an N log(N ) method for Ewald

sums in large systems. J. Chem. Phys. 98:10089, 1993.

14. Ryckaert, J.P., Cicotti, G., Berendsen, H. Numerical integration of the cartesian equations
of motion of a system with constaints: molecular dynamics of n-alkanes. J. Comput. Phys.
23:327-341, 1977.

11

15. Ouali, M., Gousset, H., Geinguenaud, F., Liquier, J., Gabarro-Arpa, J., Le Bret, M. and
Taillandier, E., Hydration of the dTn.dAn×dTn parallel triple helix: a Fourier transform
infrared and gravimetric study correlated with molecular dynamics simulations. Nucleic
Acids Reseach 25:4816-4824, 1997.

16. Gabarro-Arpa, J., Le Bret, M., Marcouyoux, A. Cadira, an object-oriented platform for
modelling molecules and analyzing simulations. Comput. and Chem. 21:343-345, 1997.

17. Becker, O.M. and Karplus, M. The topology of multidimensional potential energy surfaces:
theory and application to peptide structure and kinetics. J. Chem. Phys. 106:1495-1517,
1997.

18. Nienhaus, G.U., M¨uller, J.D., McMahon, B.H., Frauenfelder, H., Exploring the conforma-

tional energy landscape of proteins. Physica D 107:297-311, 1997.

19. Onuchic, J.N., Luthey-Schulten, Z. and Wolynes, P.G. Theory of protein folding: the energy

landscape perspective. Annual Review of Physical Chemistry 48:545-600, 1997.

20. Kitao, A., Hayward, S., G¯o, N. Energy landscape of a native protein:

jumping-among-

minima model. Proteins: Struct. Funct. Genet. 33:496-517, 1998.

21. Krznaric, D. and Levcopoulos, C. The ﬁrst subquadratic algorithm for complete linkage
clustering. Proc. 6th Annu. Internat. Sympos. Algorithms Comput., Vol. 1004 of Lecture
Notes in Computer Science, New-York: Springer-Verlag. 1995:392-401.

22. Kabsch, W. A discussion of the solution for the best rotation to relate two sets of vectors.

Acta Cryst. A34:827-828, 1978.

23. Wlodawer, A., Deisenhofer, J., Huber, R. Comparison of two highly reﬁned structures of

bovine pancreatic trypsin inhibitor. J. Mol .Biol. 193:145-156, 1987.

24. Eastman, P., Pellegrini, M., Doniach, S. Protein ﬂexibility in solution and in crystals. J.

Chem. Phys. 110:10141-10152, 1999.

25. Ott, E., Chaos in dynamical systems. Cambridge University Press, Cambridge (England).

1993.

12

< ∆rms > RMSDS

Cluster Start Length D
A
A0
A00
A01
A1
A2
A3
A4
A5
B
B1
B2
B3
B4
B5

2.61
0
1.4
0
0.045
0
0.255
0
0.665 0.135
0.79
0.16
0.32
1.49
2.015 0.43
0.165
2.34
1.395
2.61
2.61
0.22
2.745 0.165
0.545
2.97
0.29
3.54
0.175
3.83

6.86
1.94
11.07 0.027 ± 0.010
7.76 0.028 ± 0.012
2.06 0.031 ± 0.010
0.88 0.034 ± 0.007
2.30 0.029 ± 0.011
0.94 0.025 ± 0.011
1.86 0.034 ± 0.009
12.83
1.49 0.027 ± 0.012
2.05 0.030 ± 0.010
0.92 0.026 ± 0.350
5.33 0.020 ± 0.009
11.67 0.028 ± 0.010

-
-
yes
yes
yes
yes
yes
yes
yes
-
yes
yes
no
yes
yes

Table I.

In this table we show some parameters for a group of selected clusters obtained with the

complete-link algoritm and the Hamming distance.

In the ﬁrst column is the name of the cluster. In the present nomenclature subclusters inherit
the name of the parent cluster, suﬃxed with a number corresponding to their chronological
ordering inside the parent cluster.

The second column is the start of the cluster, in ns from the beginning of the simulation.

The third column is the total length (in ns). Followed by the speciﬁc activity coeﬃcient D.

The next two columns refer to the r.m.s. deviation matrix shrinkage test (RMSDS) upon
minimization: we calculate two r.m.s. deviation matrices for the frames belonging to the cluster.
The ﬁrst one, for the original structures, the second one, for the minimized structures; in the
ﬁfth column there is the mean value of the diﬀerence between the elements of the original and
the minimized deviation matrices.

The last column states the result of the RMSDS test.

13

Legends of Figures

Figure 1

Schematic representation of a protein conformational space. The continuous thin lines are
the contour lines of two PESMs: R1 and R2. The straight thick lines represent tuples that cut
conformational space into positive and negative halves. The broken dotted line represents the
protein trajectory, pushing the analogy a little further one can think of one frame per dot. The
tuples label begins with :

b if they fall approximatively in between the two PESM,

ns if they are non speciﬁc,

s if they are speciﬁc,

sw if they scratch the wall.

sm if they cut a PESM approximatively across its center,

The approximate sequences associated with the example tuples of the ﬁgure are

b1 111111111111111111111111111110010000000000000000000000000000

b2 000000000000000000000000000000000000000100111111111111111111

ns 000001101111111110111111101111001001010000000000000001001101

sm1 100111111111110100000000000000000000000000000000000000000000

sm2 000000000000000000000000000000000000000000000000001110110000

sw1 000000010000000000000000000000000000000000000000000000000000

sw2 000000000000110000000000000000000000000000000000000000000000

sw3 000000000000000000000000000000000000000000000000010000000000

The sequences have been scaled so that each bit corresponds approximatively to 17 frames (dots)
of the trajectory. For each tuple, the 1s are arbitrarily assigned to the halfspace where the
trajectory spends the less time.

Figure 2

Dendogram resulting from the complete-link clustering algorithm with the Hamming distance.
It has been drawn so that the ordering of the clusters along the horizontal axis remains close
to the chronological ordering. The clusters found with our analysis protocol are underlined.
The names of subclusters begin with parent cluster’s name followed by a number corresponding
to their time ordering within the cluster. For sake of clarity the diagram has been cut for an
arbitrary distance since the lower branches do not convey important information.

14

Figure 3

Figure 4

Figure 5

tance.

Spectrum of speciﬁc 4-tuple for some selected clusters.
The vertical coordinate, in logarithmic scale, is the total number of tuples. The horizontal

coordinate is the trajectory total number of frames in the tuple minor halfspace.

For each cluster two curves are plotted :

- the full line is the spectrum of the speciﬁc tuples;

- the dotted line is the average number spectrum of speciﬁc tuples on the homologous clusters

along the trajectory.

Matrix density plot.
Lower left half: r.m.s. deviation matrix. Upper right half: Hamming distance matrix.
Axis coordinates are all in ns.

a) Dendogram resulting from the complete-link clustering algorithm with the r.m.s. distance.

b) Dendogram resulting from the average distance clustering algorithm with the r.m.s. dis-

For comparison we have underlined the clusters corresponding to clusters or segments of clusters
identiﬁed from the dendogram obtained with the Hamming distance. The symbols have the same
meaning as in table I and ﬁg. 2.For sake of clarity the diagram has been cut for an arbitrary
distance since the lower branches do not convey important information.

Clusters bearing a ′, have more than 80% homology with their homologous counterparts in

ﬁg. 2.

15

b1

sw3

ns

sm2

sw2

b2

R2

sm2

sm1

sw1

R1

b2

sw3

b1

sw2

sm1

ns

sw1

Figure 1

A

B

A

00

A

01

A

0

A

A

A

A

A

B

B

B

B

B

2

4

3

5

1

3

1

2

4

5

Figure 2

10000

10000

A

A

00

0

100000

1000

1000

100

100

10

10

1

1

0

10

20

30

40

50

0.1

0

20

40

60

80

100

100000

10000

1

A

A

10000

1000

1000

100

10

1

0.1

0

100

200

300

400

0

5

10

15

20

100

10

100000

10000

10000

B

B

5

1000

1000

100

100

10

10

1

1

0.1

0.1

0

50

100

150

200

250

0

5

10 15 20 25 30

Figure 3

A

A

A

A

A

A

A

B

B

B

B

B

B

4

1

1

00

3

2

5

5

4

4

1

2

2

B

5

Figure 5a

A

B

A

A

A

A

A

B

B

B

B

B

3

3

1

2

5

4

5

2

1

3

0

0

0

0

A

A

2

00

A

0 1

Figure 5b

