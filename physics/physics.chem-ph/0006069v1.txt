0
0
0
2

 

n
u
J
 

7
2

 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 

1
v
9
6
0
6
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

On the integration accuracy in molecular density functional

theory calculations using Gaussian basis sets

Jan M.L. Martin*

Department of Organic Chemistry, B Kimmelman Building, Room 262, Weizmann Institute of

Science, IL-76100 Reh. ovot, Israel. E-mail: comartin@wicc.weizmann.ac.il

Space Technology Division, Mail Stop 230-3, NASA Ames Research Center, Moﬀett Field, CA

Charles W. Bauschlicher, Jr.*

94035-1000, USA

Alessandra Ricca

ELORET, Mail Stop 230-3, NASA Ames Research Center, Moﬀett Field, CA 94035-1000, USA

(Comput. Phys. Commun. MS PTA019; Received February 14, 2000; Accepted May 5, 2000)

Abstract

The sensitivity of computed DFT (Density Functional Theory) molecular

properties (including energetics, geometries, vibrational frequencies, and in-

frared intensities) to the radial and angular numerical integration grid meshes,

as well as to the partitioning scheme, is discussed for a number of molecules

using the Gaussian 98 program system. Problems with typical production

grid sizes are particularly acute for third-row transition metal systems, but

may still result in qualitatively incorrect results for a molecule as simple as

CCH. Practical recommendations are made with respect to grid choices for

the energy(+gradient) steps, as well as for the solution of the CPKS (Coupled

Perturbed Kohn-Sham) equations.

PACS: 02.60.Jh, 31.15.Ew, 82.20.Wt

Typeset using REVTEX

1

I. INTRODUCTION AND THEORETICAL BACKGROUND

Density Functional Theory (DFT) [1,2] has in recent years become both a powerful and a

very commonly used tool for studying molecular electronic structure. In addition to usually

reliable energetics, the availability of analytical ﬁrst and second derivatives for the DFT

approaches allows for easy calculation of geometric structure and vibrational frequencies.

The rate-determining step in molecular DFT calculations using Gaussian basis sets is

usually the evaluation of various integrals over the exchange-correlation functional and its

geometric derivatives. In practice the three-dimensional numerical integration is carried out

as a weighted sum of three-dimensional integrations in polar coordinates centered on atoms

A:

Z F (r)dτ =

atoms

XA

grid

Xg

wgApA(rg)F (rgA)

(1)

in which the rg and wg are numerical quadrature abscissae and weights, respectively, and
the partitioning function pA satisﬁes PA pA(r) = 1 for all values of r. In other words, pA
acts as a ‘fader function’ between grids centered on diﬀerent atoms.

Quite separate from issues involving the basis set and mathematical form of the exchange-

correlation functional, which determine the accuracy of the calculation, the choice of atomic

integration grid and partitioning can have a profound impact on its numerical precision

(together with trivial parameters like convergence criteria). Especially since an increasing

proportion of users of quantum chemical software in general — and DFT methods in partic-

ular — are experimental chemists without prior background in electronic structure theory,

the tendency exists to simply rely on the built-in defaults of various codes.

In the present paper, we shall report a number of problems which may arise in this

fashion. Because of its great popularity and widespread use, our discussion will focus on the

Gaussian 98 [3] program system. We wish to emphasize, however, that the issues raised in

the present work could arise with other DFT codes. We note that some codes try to minimize

possible numerical problems by the use of large default integration grids and/or by variation

of the grid mesh with the atom type. While the use of very large grids certainly avoids

2

numerical problems, it can lead to prohibitively expensive calculations for larger systems.

Therefore, it is of interest to ﬁnd the smallest grid that will yield precise results for molecular

properties.

Before proceeding to discuss our results, we shall ﬁrst brieﬂy review some relevant math-

ematical aspects.

II. MATHEMATICAL BACKGROUND

The atomic integration grid is built up naturally as the direct product of radial and

angular grids:

Xg

wgF (rg) = Xa Xb

wawbF (ra, θb, φb)

(2)

The angular grid itself can be either a direct product of appropriate one-dimensional Gauss

quadrature grids (e.g., Gauss-Legendre or Gauss-Chebyshev), or (more eﬃciently) can be

a two-dimensional Lebedev grid [4] which exactly integrates spherical harmonics up to a

certain order. (In order to integrate spherical harmonics up to order L exactly, the direct

product of grids with (L + 1)/2 abscissae in θ and L + 1 abscissae in φ requires (L + 1)2/2

angular quadrature points, compared to approximately (L + 1)2/3 for the corresponding

Lebedev grid [5].)

The radial grids discussed in the present paper are all of the Murray-Handy-Laming

(MHL) variety [6] (following ideas ﬁrst proposed by Boys and Handy [7]), in which the

inﬁnite interval r = [0, ∞] is remapped onto the ﬁnite interval q = [0, 1] by means of the

change of variable r = α(q/(1 − q))m; the integration in q is then approximated by Euler-
Maclaurin summation. (The latter is facilitated by the fact that (cid:16) dnr
dqn(cid:17) vanishes at q = 1 for
all n, and at q = 0 up to n = 3m − 1 inclusive.) Empirically, m =2 is found to yield the best

results [6], and α should be dependent on the atomic radius for best results. The following

working equations arise for abscissae and weights:

ri = R(i/(N + 1 − i))2

wi = 2R3(N + 1)i5/(N + 1 − i)7

3

(3)

(4)

in which N is the number of radial points and R is taken empirically [6] as one-half the

Bragg radius of the atom on which the grid is centered (except for hydrogen, where R is set

equal to the Bohr radius).

For molecular calculations, the partitioning function p(r) introduced in Eq.(1) needs

to be deﬁned. One common choice is due to Becke [8]. Consider the confocal elliptical

coordinate µAB = rA − rB/RAB (in which rA and rB are distances towards nuclei A and B,

and RAB represents the internuclear distance), and deﬁne p(µ) = 1

2[1 − g(µ)], where g(µ)

is the ‘cell function’. The extreme choice g(µAB)=−1 if µAB ≤ 0; =+1 if µAB > 0 (i.e. a

Heaviside-type step function) would actually represent a scheme in which space is simply

partitioned into Voronoi polyhedra: this will obviously be a numerically unstable scheme,

since molecules by deﬁnition have appreciable electron density ρ (of which the integrand

is a functional) near bond midpoints µAB = 0. Becke [8] proposed to use a smoother

approximation g(µ) = f (f (f (µ))), where f (µ) = 3

2µ − 1

2µ3. Stratmann, Scuseria, and Frisch

(SSF) [9] proposed to use a piecewise function instead, namely g(µAB)=−1 if µAB ≤ −a;

=+1 if µAB ≥ a; = 1

16[35(µAB/a) − 35(µAB/a)3 + 21(µAB/a)5 − 5(µAB/a)7] otherwise, where
the scale factor a = 0.64 was determined empirically.1 The SSF partitioning is reported

to be numerically somewhat more stable, and in addition lends itself well to linear-scaling

implementations [9].

III. COMPUTATIONAL METHODS

All calculations were carried out using Gaussian 98 Rev. A7 [3] running on various

workstation computers at NASA Ames Research Center and the Weizmann Institute of

Science.

A variety of Gaussian basis sets was used, including the Pople group 6-31G*, 6-31+G*,

1As pointed out by a referee, this latter expression is equivalent to eq. (24), with m=3, of Ref.

[6], although a piecewise g(µ) was not proposed there.

4

and 6-31++G** basis sets [10], the Dunning cc-pVDZ and cc-pVTZ basis sets (correlation

consistent [11,12] polarized valence double and triple zeta, respectively), and the Hay-Wadt

LANL2DZ (Los Alamos National Laboratory 2 Double-Zeta [13]) basis set-relativistic ECP

combination.

In virtually all cases, the very popular B3LYP (Becke 3-parameter-Lee-Yang-Parr) hy-

brid exchange-correlation functional [14,15] was used, except for some test calculations using

the earlier BLYP (Becke-Lee-Yang-Parr [15,16]) or BP86 (Becke-Perdew 1986 [16,17]) func-

tionals.

We consider three types of grids:

• (nn,mmm), meaning the direct product of an nn-point Euler-Maclaurin radial grid

with a two-dimensional Lebedev grid with mmm angular points;

• (nn,mm,2mm), meaning the direct product of an Euler-Maclaurin grid with nn points

in r and of Gauss-Legendre quadratures with mm and 2mm points in θ and φ, respec-

tively;

• (nn,mmm)p,

i.e. pruned (nn,mmm) grids.

In pruned grids [18], the number of

angular points is varied with the radial coordinate, with the full number of mmm

only being used at r values relevant for conventional chemical bonding.

In Gaus-

sian 98, the following pruned grids are implemented: (35,110)p (invoked with the

keyword “Grid=Coarse”), (50,194)p (the SG-1 grid [18] invoked with the keyword

“Grid=SG1”), (75,302)p (invoked with the keyword “Grid=Fine”), and (99,590)p (in-

voked as “Grid=UltraFine”). Pruned grids are only implemented for elements up to

and including krypton: for heavier elements, the corresponding unpruned grid is sub-

stituted. (We note that in the implementation in Gaussian 98, the cutoﬀ radii between

segments with diﬀerent angular grid meshes are dependent on the row in the Peri-

odic Table: this in eﬀect does result in some grid quality adjustment with the atomic

number.)

In frequency calculations using analytical second derivatives [19], Gaussian 98 permits

5

the use of diﬀerent grids for the evaluation of the energy and gradient on the one hand,

and for the solution of the CPKS (coupled perturbed Kohn-Sham) equations on the other

hand. The defaults of the program correspond to “Int(Grid=Fine) CPHF(Grid=Coarse)”;

specifying “Int(Grid=UltraFine)” implies “CPHF(Grid=SG1)” by default.2

Unless noted otherwise, tightened convergence criteria were used in geometry optimiza-

tions.

IV. RESULTS AND DISCUSSION

A. CCH radical

The acetyl radical is linear with a 2Σ+ ground state. At the B3LYP/cc-pVTZ level with

the default grid combination, however, one surprisingly ﬁnds (Table I) not only an imaginary

bending frequency, but that the two “degenerate” components diﬀer by 64 cm−1. Upon

repeating the calculation with an extremely large (140,48,96) grid, a properly degenerate

bending frequency of 312.5 cm−1 (intensity 3.84 km/mol) was found, irrespective of whether

Becke or SSF partitioning is used. Taking the SSF (140,48,96) result as the reference, we

ﬁnd the default grid to be in error by only 0.3 and 0.1 cm−1 for the CC and CH stretches,

respectively, while the two components of the bending frequency are oﬀ by a whopping −421

and −492 cm−1, respectively. (N.b.: we have treated the imaginary frequencies as negative

numbers when we compute the error.) Likewise, while errors of about 5 and 1 % are seen

for the CC and CH intensities, respectively, the bend intensity is too high by an order of

magnitude. Using Becke instead of SSF weights does not materially aﬀect these observations.

Specifying “Grid=Ultraﬁne” (i.e. (99,590)p for integration, and (50,194)p for CPKS)

leads to a dramatic improvement in the bending frequency, which is now properly degener-

2In Gaussian 98, the keyword CPHF controls options for both the Coupled Perturbed Hartree-

Fock procedure in wavefunction based ab initio calculations and for CPKS in density functional

calculations.

6

ate and only 7 cm−1 too low. (The intensities for the other two modes now agree with the

reference values to two decimal places.) The error in the corresponding infrared intensity

drops by two orders of magnitude. Specifying the (99,590)p grid for both integration and

CPKS does not aﬀect the stretching frequencies, but reduces the error on the bending fre-

quency and intensity to 0.1 cm−1 and 0.01 km/mol, respectively, using either Becke or SSF

partitioning. This clearly suggests that sensitivity is greatest to the CPKS grid.

Using the (75,302)p grid for integration and varying the CPKS grid from the associated

(35,110)p default, we ﬁnd that the spurious imaginary, nondegenerate bending frequencies

disappear upon using either the unpruned (35,110) or the larger pruned (50,194)p grid.

However, errors of about –10 and –7 cm−1 in the bending frequency remain, and are not

reduced to the 1 cm−1 range until a (75,302)p or even (75,302) CPKS grid is substituted.

Upgrading the energy grid to (99,590)p does not aﬀect these conclusions.

Surprisingly, using a (99,974) grid for both integration and CPKS yields slightly diﬀerent

frequencies for the two components of the π bending mode.

Upon ﬁnding an imaginary frequency, one is tempted to displace the molecular geometry

in the direction of that mode and reoptimize the geometry. Following this procedure, using

the Gaussian 98 defaults (an energy grid of (75,302)p, a CPKS grid of (35,110)p, and the SSF

weights), one obtains a HCC angle of 171.1 degrees and three real frequencies. However,

one of the six trivial vibrations (i.e., overall translation and rotation, which should have

exactly vanishing frequencies in an inﬁnitely precise calculation using a rotationally invariant

method) has a frequency of 508i cm−1. Thus lowering symmetry has just made the numerical

problem less obvious.

Unlike the frequencies which show a large sensitivity to the choice of grid, the total energy

of CCH is in error by less than 1 microhartree for all grids studied. Considering the small

eﬀect on the energy, it is not surprising that the CCH results are most sensitive to the CPKS

grid.

7

B. Harmonic frequencies of TaCl2

The ground state for this symmetric linear molecule is X 4Σ−

g . Results at the

B3LYP/LANL2DZ level as a function of the integration and CPKS grids are summarized in

Table II. Our largest grid (140,48,96) SSF results will again be considered as the reference.

None of the grid combinations considered in Table II lead to nonequivalent bending

vibration components, but the default grid combination does produce a spurious imaginary

bending frequency. Unlike CCH, the bending infrared intensities agree well with the largest

grid value, but the symmetric and antisymmetric stretching frequencies are in error by −6

and −7 cm−1, respectively. Use of the Becke partitioning leads not only to increased errors

in the stretching frequencies, but to an error of +0.002 ˚A in the optimum bond distance,

compared to −0.0003 ˚A with the SSF partitioning. Quite diﬀerent from the behavior for

CCH is the fact that the total energy is now in error by 310 microhartree with the SSF

partitioning, and 369 microhartree with the Becke partitioning.

In this particular case, varying the size of the CPKS grid, and particularly of its angular

component, does not appear to remedy the problem at hand. Using an unpruned energy

grid, however3, or using a grid with more radial points, dramatically reduces the error in

the computed total energy, bond distance, and frequencies, particularly using the SSF parti-

tioning. In particular, the (99,590)p/(50,194)p integration/CPKS grid combination invoked

by “Grid=UltraFine” incurs (with SSF partitioning) no error greater than 1 cm−1 on the

frequencies, and reduces the errors in bond distance and total energy to 0.0001 ˚A and 1.5

microhartree, respectively. While it is possible that using the Becke atomic size adjustment

procedure (Appendix of Ref. [8]), in conjuction with the SSF weights, would reduce the sen-

sitivity to the radial grid, we note that using the ‘UltraFine’ grid combination solves both

the CCH angular grid problem and the TaCl2 radial grid problem, and therefore would seem

3 Note that this change will only aﬀect the Cl atomic grid in this case, as grids for elements heavier

than Kr are always unpruned in Gaussian 98.

8

to be a good choice to invesigate possible grid problems.

For TaCl2, performance of the SSF partitioning seems markedly superior to that of the

Becke partitioning. As expected, diﬀerences between the two partitioning schemes are re-

duced as the grid is improved, and they yield essentially identical results for the (140,48,96)

grid.

Lowering the symmetry to C2v and using the Gaussian 98 defaults results in a slightly

bent structure with a ClTaCl angle of 171.1 degrees. As in the case of CCH, the only

indication of the numerical problems is in the deviation from zero of the translational and

rotational frequencies, but for TaCl2 the value is 33i cm−1, making the error for TaCl2 less

obvious than in the case of CCH (see above).

If we now consider relative CPU times (default grids=1.00) as a function of grid size, we

see that the (99,590)p/(50,194)p combination will approximately double CPU time. Using a

(99,590)p grid for both integration and CPKS is found to be a factor of nine more expensive

than the default, a ratio which goes up to a factor of 19 for the unpruned (99,974) grid, of

36 for the (96,32,64) grid often cited in benchmarks, and of 109 for the largest (140,48,96)

grid considered here. The (99,590)p/(75,302)p combination found to be required for 1 cm−1

precision in the bending frequency of CCH would be four times more expensive than the

default — rather more time-consuming than desirable, but still an order of magnitude less

expensive than the (96,32,64) grid.

C. Harmonic frequencies of Ge2H5 and Ge2H6

Ge2H6 has D3d symmetry and a structure analogous to ethane. Ge2H5 is best viewed as

removing one H from Ge2H6, which results in Cs symmetry; there is only a small change in

the structural parameters relative to the parent Ge2H6 molecule.

In Table III we summarize our results for Ge2H5. In addition to the eﬀect of partitioning

and grid size, we also consider the inﬂuence of the basis set and of the exchange-correlation

functional on the three lowest harmonic frequencies of Ge2H5. We ﬁrst consider using the

Becke partitioning. Using the default grid in Gaussian, i.e. a pruned (75,302)p grid for energy

9

and gradients and (35,110)p for CPKS, results in an imaginary frequency. Expanding the

radial grid from 75 to 96 points and depruning the grid, i.e. the (96,302) grid, for the energy,

gradient, and CPKS steps does not remove the imaginary frequency. Expanding the angular

grid removes the numerical problem; with 590 angular points, the lowest harmonic frequency

is essentially converged to a value of about 100 cm−1. Expanding the radial grid further has

only an eﬀect of a few cm−1.

The results using SSF partitioning are very diﬀerent from those obtained using Becke

partitioning; using SSF, even the default “Grid=Fine” is precise to better than 10 cm−1.

Improving the grid makes much smaller changes for SSF and the “UltraFine” grid in Gaus-

sian 98 (i.e., (99,590)p for energy and gradients, (50,194)p for CPKS) appears to be es-

sentially converged. Note that for the Becke partitioning the “UltraFine” grid also yields

essentially converged results.

Adding diﬀuse functions to the Ge atoms or diﬀuse and polarization functions to the

H atoms does not eliminate the imaginary frequency for the default grid and the Becke

partitioning. That is, the problem is not unique to the 6-31G* basis set.

Nor is it unique to the use of a hybrid functional: substituting the BP86 functional for its

B3LYP counterpart does not alter the trends with respect to partitioning and grid, the most

notable point being the imaginary frequency for the default grid with Becke partitioning.

The Ge2H5 calculations are repeated using the LANL2DZ basis set/ECP combination,

and the results are also given in Table III. Unlike the all-electron calculations, there is

essentially no diﬀerence between Becke and SSF partitioning, and improving the grid has

only a very small eﬀect. This is also true for the four- and 14-valence electron Ge ECPs of

Hurley et al. [20]. Thus it appears that the diﬀerence observed in the all-electron calculations

arises from the inner-shell orbitals.

For the default grids and the Becke partitioning, displacing the molecular geometry in the

direction of the imaginary mode results in essentially the same geometry and frequencies as

found in the Cs treatment. That is, lowering the symmetry does not eliminate the imaginary

frequency, so the numerical problems are much more obvious than for CCH and TaCl2.

10

Substituting Si for Ge leads to a similar structure, but as shown in Table IV, neither the

choice of grid points nor the partitioning scheme make much of a diﬀerence for the Si2H5

system. The lack of sensitivity of the results to grid or partitioning is similar to the results

reported [9] by SSF, and is typical of many other tests that we have performed for systems

containing ﬁrst and second row atoms. The problem of the imaginary frequency does not

exist for Ga2Cl5: the Becke and SSF partitioning agree to within 4 cm−1 for the 6-31+G*

basis set and the default grids. Given that Si2H5, Ge2Cl5, and Ge2H5 have similar shapes,

we conclude that the shape of Ge2H5 does not lead to the numerical problems that result in

the imaginary frequency.

In Table V we summarize the results for Ge2H6, which is a closed-shell, stable molecule.

It shows the same variation in the frequencies with choice of partitioning and grid points as

Ge2H5, and we conclude that the diﬀerence between results using Becke and SSF partitioning

is not unique to Ge2H5. It is encouraging that the default SSF partitioning is less sensitive

to the choice of grid, but it is also sobering to realize that it is possible to have an error of

about 70 cm−1 with no obvious indication of an error.

D. Relative energies of cis- and trans-HIr[PR3]4Cl+

The peculiar cis-trans equilibrium of the HIr[PR3]4Cl+ (R=H, CH3) transition metal

complexes was the subject of a very recent joint theoretical-experimental investigation [21].

At the highest level of theory for R=CH3, the complexes are found to be essentially isoen-

ergetic, with the equilibrium between the two being essentially wholly driven by the higher

entropy of the cis form: experimentally [21], a 6:1 cis:trans equilibrium is found at room

temperature.

Given the very small energy diﬀerences being considered here, as well as the rather ﬂat

potential surface of particularly the cis form, grid convergence (not discussed in Ref. [21])

was obviously a cause for concern here. Upon ﬁrst optimizing the cis-R=CH3 case using

the default grids and computing vibrational frequencies, we found what appeared to be a

local minimum. Upon recomputing the harmonic frequencies with the (99,590)p/(50,194)p

11

integral/CPKS grid combination, we found this structure to be a saddle point of order 3,

and only after thirteen geometry optimization cycles using analytical second derivatives (and

two months of CPU time on an SGI Origin 2000) was the true minimum structure found. A

superimposition of the two structures (created using the MOLDEN [22] molecular viewing

program) is displayed in Figure 1.

While the R=CH3 case is simply too large to do an exhaustive grid convergence study, we

have summarized some data for the R=H case in Table VI. In particular, we have considered

the absolute energies for the cis and trans isomers, and their relative energy, as a function

of grid size. In this case, results seems to be quite dependent both on the radial and on

the angular grid mesh. Using the (35,110)p grid employed by default in the CPKS step,

the relative energy gets predicted with the wrong sign, and neither the use of an unpruned

grid nor switching to a product grid of the same order remedy the problem — if anything,

results get worse, suggesting that the (35,110)p results in fact beneﬁt from a fortunate error

compensation. Total energies are oﬀ by as much as 8 millihartree for the trans isomer.

While a scatter in the energies does not necessarily imply a corresponding scatter in the

CPKS solution, it does not seem entiely implausible that a grid that predicts isomer energy

diﬀerences on a surface with the wrong sign might yield a Hessian with incorrect curvature

if used in the CPKS step.

The smallest grid that at least predicts the correct sign for the cis-trans diﬀerence is

(50,194)p (about 25% too high in absolute value): using an unpruned grid instead4 cuts

the error in half, as does using the (75,302)p grid. Total energies are however still in error

by amounts of about 60 microhartree: fortunately the errors largely cancel. The (99,590)p

(“UltraFine”) grid agrees to two decimal places with the (140,48,96) reference results; even

a grid as large as (99,974) cannot yet achieve 1 microhartree precision in the total energies,

which is barely reached for a (99,27,54) grid, and more comfortably for a (99,32,64) grid.

4 Again, since the Ir grid is always unpruned, the improvement in grid quality comes from addi-

tional grid points centered on the other atoms.

12

V. CONCLUSIONS

Computed molecular properties using density functional theory in general, and vibra-

tional frequencies in particular, tend to be quite sensitive to the integration grids and par-

titioning being used in the calculation. Our results corroborate the assertion of SSF that

their proposed partitioning scheme is numerically more stable than the Becke partitioning.

While the use of coarse grids in the solution of the CPKS (coupled perturbed Kohn-Sham)

equations certainly leads to signiﬁcant speedups, it can cause spurious negative eigenvalues

in the Hessian matrix, or even artifactual loss of vibrational mode degeneracy, in systems

as small and uncomplicated as CCH radical. While this problem is alleviated by the use

of unpruned grids, this oﬀers no beneﬁt (in terms of CPU time) over the use of a larger

pruned grid. For systems involving very heavy elements (e.g. third-row transition metals),

grids which are suﬃciently ﬁne-meshed for typical ﬁrst-and second-row systems are no longer

adequate. In situations where small pruned grids are inadequate, the use of the corresponding

unpruned grid appears to be less eﬃcient than the use of a larger pruned grid.

For the cases considered here, the most eﬃcient grid combination that appears to be

‘immune’ to qualitatively incorrect results is (99,590)p for energy and gradients, (50,194)p

for CPKS. (This is equivalent to the “Grid=UltraFine” option in Gaussian 98.) For greater

quantitative precision, the use of a ﬁner-meshed (75,302)p grid for the CPKS is recom-

mended. While a (99,974), (96,32,64) or even ﬁner grid in all steps of the calculation will

certainly avoid this type of problems, this comes at an unacceptably high premium in terms

of CPU time.

As quantum chemical methods mature and quantum chemical software becomes more

user-friendly, an increasing proportion of their users are scientists from other ﬁelds than

quantum chemistry, who are inevitably exposed to the temptation to treat such program

systems as ‘black boxes’. Observations such as those made in the present paper illustrate

that even at the present state of technology, ‘black box’ performance should not be taken

for granted, and that acquiring some insight in both the quantum mechanical and numer-

13

ical methodology is still an essential prerequisite for their eﬀective and reliable scientiﬁc

application.

ACKNOWLEDGMENTS

JM is the incumbent of the Helen and Milton A. Kimmelman Career Development Chair.

Research at the Weizmann Institute was supported by the Minerva Foundation, Munich,

Germany, and by the Tashtiyot program of the Ministry of Science (Israel). JM would like

to thank Dr. S. Parthiban for bringing the problem with CCH to his attention, and Dr.

Andreas Sundermann for critical reading of the draft manuscript. AR was supported by

NASA Contract No. NAS2-14031.

NOTE ADDED

After acceptance of the present manuscript, and in response to a preprint thereof, we

received a personal communication from Gary W. Trucks and Michael J. Frisch of Gaussian,

Inc., informing us of a bug in Gaussian 98 which aﬀects the integral (derivative) accuracy

for the speciﬁc case of the (35,110)p grid. A ﬁx will be incorporated in the next minor

release after Rev.A9. The main eﬀect on the data presented in this paper is that the errors

in the ﬁrst two entries in Table 1 become a good deal less dramatic:

in particular, the

degeneracy of the bend is restored and the errors in ω3 and I3 are reduced to -19 cm−1 and 1.2

km/mol, respectively. In addition, we reoptimized the complex in Figure 1 using a patched

version of the code with the default grid combination (and using analytical second derivatives

as before). The resulting geometry is in much closer agreement with the Grid=UltraFine

structure.

(The cis-trans diﬀerence with the (35,110)p grid in Table VI is not aﬀected

materially.) The authors would like to thank Drs. Trucks and Frisch for helpful discussions.

14

REFERENCES

[1] P. Hohenberg and W. Kohn, Phys. Rev. 136(1964)864; W. Kohn and L. J. Sham, Phys.

Rev. 140(1965)1133.

[2] R. G. Parr and W. Yang, Density functional theory of atoms and molecules (Oxford

University Press, Oxford, 1989).

[3] M. J. Frisch, G. W. Trucks, H. B. Schlegel, G. E. Scuseria, M. A. Robb, J. R.

Cheeseman, V. G. Zakrzewski, J. A. Montgomery, R. E. Stratmann, J. C. Burant,

S. Dapprich, J. M. Millam, A. D. Daniels, K. N. Kudin, M. C. Strain, O. Farkas,

J. Tomasi, V. Barone, M. Cossi, R. Cammi, B. Mennucci, C. Pomelli, C. Adamo,

S. Cliﬀord, J. Ochterski, G. A. Petersson, P. Y. Ayala, Q. Cui, K. Morokuma, D.

K. Malick, A. D. Rabuck, K. Raghavachari, J. B. Foresman, J. Cioslowski, J. V.

Ortiz, B. B. Stefanov, G. Liu, A. Liashenko, P. Piskorz, I. Komaromi, R. Gomperts,

R. L. Martin, D. J. Fox, T. Keith, M. A. Al-Laham, C. Y. Peng, A. Nanayakkara,

C. Gonzalez, M. Challacombe, P. M. W. Gill, B. G. Johnson, W. Chen, M. W.

Wong, J. L. Andres, M. Head-Gordon, E. S. Replogle, and J. A. Pople, Gaussian 98,

Revision A.7 (Gaussian, Inc., Pittsburgh, PA, 1998). http://www.gaussian.com/

[4] V. I. Lebedev, Zh. Vychisl. Mat. Mat. Fiz. 15 (1975) 48; V. I. Lebedev, Zh. Vychisl.

Mat. Mat. Fiz. 16 (1976) 293; V. I. Lebedev, Sibirsk. Mat. Zh. 18 (1977) 132; V. I.

Lebedev, A. L. Skorokhodov, Russian Acad. Sci. Dokl. Math. 45 (1992) 587.

[5] R. D. Adamson, PhD Thesis (Trinity College, Cambridge, UK, 1999); http://ket.ch.

cam.ac.uk/people/ross/thesis/

[6] C. W. Murray, N. C. Handy, and G. J. Laming, Mol. Phys. 78(1993)997

[7] S. F. Boys and N. C. Handy, Proc. Royal Soc. A 311 (1969) 309; N. C. Handy and S.

F. Boys, Theor. Chim. Acta. 31 (1973) 195.

[8] A. D. Becke, J. Chem. Phys. 88(1988)2547

15

[9] R. E. Stratmann, G. E. Scuseria, and M. J. Frisch, Chem. Phys. Lett. 257(1996)213

[10] W. J. Hehre, L. Radom, P. von Ragu´e Schleyer and J. A. Pople, Ab initio molecular

orbital theory (Wiley, New York, 1986)

[11] T. H. Dunning Jr., J. Chem. Phys. 90(1989)1007.

[12] T.H. Dunning Jr., K.A. Peterson, D.E. Woon, “Correlation consistent basis sets for

molecular calculations”, in Encyclopedia of Computational Chemistry, ed. P. von Ragu´e

Schleyer, (Wiley & Sons, Chichester, 1998).

[13] W. R. Wadt, and P. J. Hay, J. Chem. Phys. 82(1985)284.

[14] A. D. Becke, J. Chem. Phys. 98(1993)5648; see also P. J. Stephens, F. J. Devlin, C.

F. Chabalowski, and M. J. Frisch, J. Phys. Chem. 98(1994)11623.

[15] C. Lee, W. Yang, R. G. Parr, Phys. Rev. B 37(1988)785

[16] A. D. Becke, Phys. Rev. A 38(1988)3098

[17] J. P. Perdew, Phys. Rev. B 33(1986)8822; erratum 34 (1986) 7406.

[18] P. M. W. Gill, B. G. Johnson, and J. A. Pople, Chem. Phys. Lett. 209(1993)506

[19] B. G. Johnson, and M. J. Frisch, J. Chem. Phys. 100(1994)7429; J. C. Burant, M. C.

Strain, G. E. Scuseria, and M. J. Frisch, Chem. Phys. Lett. 258(1996)45

[20] M. M. Hurley, L. F. Pacios, P. A. Christiansen, R. B. Ross, and W. C. Ermler, J.

Chem. Phys. 84(1986)6840

[21] O. Blum, R. Carmielli, J. M. L. Martin, and D. Milstein, Organometallics, submitted.

[22] G. Schaftenaar, MOLDEN 3.6 (CMBI, University of Nijmegen, The Netherlands, 1999).

http://www.cmbi.kun.nl/~schaft/molden/molden.html

16

0.61

0.61

0.61

0.61

0.44

0.44

-0.08

-0.08

-0.02

-0.02

0.45

0.45

-0.07

-0.07

-0.01

-0.01

-0.01

-0.01

0.00

0.00

-0.01

-0.01

0.00

-10.07

-9.42

-9.84

-9.25

-7.43

-6.79

0.73

1.34

0.08

0.64

-7.06

-7.06

1.08

1.09

0.11

0.12

0.07

0.07

0.73

0.73

0.14

0.15

0.01

-9.42

-9.84

-9.25

-7.43

-6.79

0.73

1.34

0.08

0.64

-7.06

-7.06

1.08

1.09

0.11

0.12

0.07

0.07

0.01

0.03

0.14

0.15

0.01

30.42

30.92

0.61

0.61

0.61

0.61

0.44

0.44

-0.08

-0.08

-0.02

-0.02

0.45

0.45

-0.07

-0.07

-0.01

-0.01

-0.01

-0.01

0.00

0.00

-0.01

-0.01

0.00

-0.21

0.29

-0.32

0.17

-0.32

0.17

-0.32

0.17

-0.32

0.17

-0.32

0.17

0.06

-0.09

0.06

-0.09

0.06

-0.09

0.06

-0.09

0.06

-0.08

0.06

-0.08

0.02

0.28

0.28

0.00

0.00

-0.01

0.00

-0.01

0.00

-0.01

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.62

0.08

0.44

-0.12

0.45

-0.11

0.44

-0.12

0.44

-0.12

0.45

-0.11

0.10

-0.29

0.10

-0.29

0.10

-0.29

0.10

-0.29

0.08

-0.25

0.08

-0.25

-0.01

-0.53

-0.55

0.00

-0.01

0.00

0.00

0.00

-0.01

0.00

-0.01

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

312.54

3.85

312.54

3.85

2094.63

5.05

3456.85

56.60

TABLES

TABLE I. Numerical errors in computed B3LYP/cc-pVTZ properties for acetyl radical as a

function of grid size. The values are given for the largest grid, which is used as our reference.

Energy

CPKS

Partition ∆E(uEh) ∆ω3x

∆I3x

grid

grid

scheme

µEh

cm−1

km/mol

∆ω3y

cm−1

∆I3y

∆ω2

∆I2

∆ω1

∆I1

km/mol

cm−1

km/mol

cm−1

km/mol

(75,302)p

(35,110)p B

0.65

-481.35

38.53

-417.12

(75,302)p

(35,110)p

SSF

-0.10

-492.09

39.55

-420.61

(75,302)p

(35,110)

B

0.65

-10.07

(75,302)p

(35,110)

SSF

(75,302)

(35,110)

B

(75,302)

(35,110)

SSF

(75,302)p

(50,194)p B

(75,302)p

(50,194)p

SSF

(75,302)p

(75,302)p B

(75,302)p

(75,302)p

SSF

(75,302)

(75,302)

B

(75,302)

(75,302)

SSF

(99,590)p

(50,194)p B

(99,590)p

(50,194)p

SSF

(99,590)p

(75,302)p B

(99,590)p

(75,302)p

SSF

(99,590)p

(99,590)p B

(99,590)p

(99,590)p

SSF

(99,590)

(99,590)

B

(99,590)

(99,590)

SSF

(99,974)

(99,974)

B

(99,974)

(99,974)

SSF

(99,36,72)

(99,36,72) B

(99,36,72)

(99,36,72) SSF

(140,48,96) (140,48,96) B

(140,48,96) (140,48,96) SSF

-0.10

0.59

-0.16

0.65

-0.10

0.65

-0.10

0.59

-0.16

-0.04

0.12

-0.04

0.12

-0.04

0.12

-0.04

0.12

-0.06

0.11

-0.07

0.11

0.00

...a

a The total energy is -76.63761769 Hartrees.

17

TABLE II. Numerical errors in computed B3LYP/LANL2DZ properties of TaCl2 (X 4Σ−
g

state) as a function of grid size. The values are given for the largest grid, which is used as our

reference.

Energy

CPKS

Partition

Grid

Grid

scheme

∆r

m˚A

∆E

µEh

∆ω3

∆I3

∆ω2

cm−1

km/mol

cm−1

∆ω1

cm−1

∆I1

relative

km/mol CPU time

(75,302)p

(35,110)p

B

1.86

368.55

-60.21

(75,302)p

(35,110)p

SSF

-0.26

309.60

-59.90

(75,302)

(35,110)

B

(75,302)

(35,110)

SSF

(75,302)p

(50,194)p

B

(75,302)p

(50,194)p

SSF

(75,302)p

(75,302)p

B

(75,302)p

(75,302)p

SSF

(99,590)p

(35,110)p

B

(99,590)p

(35,110)p

SSF

(99,590)p

(50,194)p

B

(99,590)p

(50,194)p

SSF

(99,590)p

(75,302)p

B

(99,590)p

(75,302)p

SSF

(99,590)p

(99,590)p

B

(99,590)p

(99,590)p

SSF

(99,974)

(99,974)

B

(99,974)

(99,974)

SSF

(96,32,64)

(96,32,64)

B

(96,32,64)

(96,32,64)

SSF

(99,48,96)

(99,48,96)

B

(99,48,96)

(99,48,96)

SSF

(140,48,96)

(140,48,96) B

0.04

0.11

1.86

-0.26

1.86

-0.26

0.09

0.10

0.09

0.10

0.09

0.10

0.09

0.10

0.00

0.00

0.00

0.00

0.00

0.00

0.00

(140,48,96)

(140,48,96) SSF

2335.357

-17.03

-5.48

3.97

1.83

368.55

-60.25

309.60

-59.95

368.55

-60.26

309.60

-59.95

-16.84

-1.54

-16.84

-1.54

-16.84

-1.54

-16.84

-1.54

0.11

0.14

-0.01

0.28

0.08

0.14

0.00

...a

4.52

0.91

4.49

0.88

4.49

0.88

4.49

0.88

-0.02

0.00

0.11

0.00

0.00

0.00

0.01

35.89

a The total energy is –87.74246174 Hartrees.

0.02

-0.01

0.00

0.00

0.02

-0.01

0.02

-0.01

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

0.00

3.96

-7.67

-5.40

0.15

-0.15

-7.67

-5.40

-7.67

-5.41

0.15

-0.06

0.15

-0.06

0.15

-0.06

0.15

-0.06

-0.01

-0.01

-0.02

-0.05

-0.01

-0.01

0.00

-8.86

-6.80

0.20

-0.16

-8.85

-6.80

-8.86

-6.80

0.23

-0.04

0.23

-0.04

0.23

-0.04

0.23

-0.04

-0.01

-0.02

-0.03

-0.06

-0.01

-0.02

0.00

-0.23

-0.01

-0.01

-0.01

-0.22

0.00

-0.22

0.00

-0.02

-0.02

-0.01

-0.01

-0.01

-0.01

-0.01

-0.01

0.00

0.00

0.00

0.00

0.00

0.00

0.00

347.51

375.63

107.73

1.00

1.00

3.05

2.98

2.02

2.01

3.86

3.82

1.16

1.15

2.19

2.17

4.00

3.97

8.96

8.91

19.2

19.1

36.7

36.3

80.1

79.1

110.4

109.4

18

TABLE III. Summary of the three lowest harmonic frequencies of Ge2H5.

Energy

CPKS

Becke partitioning

SSF partitioning

Grid

Grid

(75,302)p

(35,110)p

(75,302)

(75,302)

(96,302)

(96,302)

(75,434)

(75,434)

(75,590)

(75,590)

(99,590)p

(50,194)p

(99,590)

(99,590)

(75,770)

(75,770)

(75,974)

(75,974)

(96,974)

(96,974)

(128,974)

(128,974)

B3LYP/6-31G*

77.9i

77.6i

39.6i

44.6

108.4

106.4

106.5

103.6

107.7

106.2

106.8

250.2

250.2

250.2

250.4

250.3

250.4

250.4

250.3

250.3

250.3

250.4

352.2

352.2

356.0

365.5

360.6

359.9

359.9

360.5

360.2

360.5

360.3

114.2

114.2

101.0

107.4

95.3

103.1

103.1

105.8

103.9

105.0

105.2

250.5

250.5

250.4

250.4

250.4

250.4

250.4

250.4

250.4

250.4

250.4

363.6

363.6

361.5

358.4

360.4

360.0

359.9

361.5

360.5

360.3

360.1

B3LYP/6-31+G*

(75,302)p

(35,110)p

82.7i

250.7

352.8

111.6

250.8

364.1

B3LYP/6-31++G**

(75,302)p

(35,110)p

36.6i

252.8

349.7

110.9

252.8

368.8

BP86/6-31G*

(75,302)p

(35,110)p

109.8i

247.4

(99,590)

(99,590)

108.0

247.9

337.7

347.5

B3LYP/LANL2DZ

(75,302)p

(35,110)p

(99,590)

(99,590)

88.8

88.3

241.5

241.5

373.7

373.8

95.4

96.9

89.1

88.3

247.9

247.9

241.5

241.5

349.1

346.9

373.7

373.8

19

TABLE IV. Summary of the three lowest and the three highest harmonic frequencies of Si2H5

using the 6-31G* basis set and the B3LYP functional.

Energy

CPKS

Partition

Harmonic frequencies

Grid

Grid

Scheme

(75,302)p

(35,110)p

B

123.4

390.4

407.1

2233.2

2244.8

2254.5

(75,302)p

(35,110)p

SSF

124.0

390.2

407.2

2227.9

2241.1

2250.8

(75,302)

(75,302)

B

123.3

390.4

407.0

2233.2

2244.8

2254.5

(75,302)

(75,302)

SSF

123.9

390.3

407.1

2227.9

2241.1

2250.8

(96,974)

(96,974)

B

122.2

390.6

408.6

2231.2

2243.5

2253.2

(96,974)

(96,974)

SSF

122.1

390.6

408.8

2229.9

2242.8

2252.4

(99,590)p

(50,194)p

B

125.4

391.2

409.8

2231.1

2243.3

2253.0

(99,590)p

(50,194)p

SSF

123.1

390.7

409.0

2230.8

2243.2

2252.8

20

TABLE V. Summary of the three lowest harmonic frequencies of Ge2H6 using the 6-31G* basis

set and the B3LYP functional.

Energy

CPKS

Becke partitioning

SSF partitioning

Grid

Grid

(75,302)p

(35,110)p

(75,302)

(75,302)

57.1

54.1

259.7

259.7

347.0

123.9

259.8

360.7

346.8

122.6

259.8

360.5

(75,434)

(75,434)

44.6i

259.7

351.7

116.8

259.8

353.0

(75,590)

(75,590)

(99,590)p

(50,194)p

(99,590)

(99,590)

93.0

94.2

94.5

259.7

259.8

259.8

347.5

111.7

259.8

356.3

347.3

107.7

259.8

353.2

347.3

107.9

259.8

353.2

(75,770)

(75,770)

106.6

259.7

353.9

112.3

259.8

355.1

(75,974)

(75,974)

110.7

259.7

353.6

108.6

259.8

354.1

(96,302)

(96,302)

75.2

259.7

351.9

109.9

259.8

356.3

(96,434)

(96,434)

30.0i

259.8

351.8

102.6

259.8

352.9

(96,974)

(96,974)

110.1

259.7

353.8

109.0

259.8

353.8

(128,974)

(128,974)

110.3

259.8

353.8

109.4

259.8

353.7

21

TABLE VI. Numerical errors in absolute and relative B3LYP/LANL2DZ energies of cis and

trans isomersa of HIr(PH3)4Cl+ as a function of grid size

Grid

(35,110)p

(35,110)

(35,9,18)

(50,194)p

(50,194)

(50,12,24)

(50,302)

(50,15,30)

(75,302)p

(75,302)

(75, 15, 30)

(99,194)

(99,12,24)

(99, 302)

(99, 15, 30)

(99, 590)p

(99, 590)

(99, 21, 42)

(99, 974)

(99, 27, 54)

(99, 32, 64)

(99, 36, 72)

(50, 48, 96)

(75, 48, 96)

(99, 48, 96)

(140, 48, 96)

(50, 590)

(75, 590)

(99, 590)

(120, 590)

∆E

trans(C4v )

µEh

2488.42

5638.22

8400.38

-236.21

-118.27

653.35

-110.06

-118.27

-58.35

-33.64

-23.58

-68.07

708.68

-33.52

-21.44

-15.29

-10.22

0.68

-2.29

0.39

0.64

0.11

-85.20

-2.03

-0.13

0.00b

-92.82

-12.14

-10.22

-10.19

∆E

cis(Cs)

µEh

890.21

1301.61

113.28

112.62

17.55

77.73

17.55

-95.50

63.27

12.74

-44.17

52.53

135.89

10.52

-44.17

-7.81

-5.75

5.52

0.70

-0.97

0.21

0.13

-45.60

2.24

0.14

0.00b

-49.43

-3.19

-5.75

-5.89

Isomerization

energy

kcal/mol

0.409

2.127

4.606

-0.813

-0.679

-0.233

-0.674

-0.608

-0.670

-0.623

-0.581

-0.670

-0.235

-0.622

-0.580

-0.599

-0.597

-0.597

-0.596

-0.593

-0.594

-0.594

-0.619

-0.597

-0.594

-0.594

-0.621

-0.600

-0.597

-0.597

a Reference geometries were obtained at

the B3LYP/LANL2DZ level with the

(99,590)p/(50,194)p grid combination and tightened optimization criteria.

b Total energies: cis −153.25208234, trans −153.25302915 hartree.

22

FIG. 1. Superimposition of B3LYP/LANL2DZ optimized structures for cis-HIr[P(CH3)3]4Cl+

with the (75,302)p/(35,110)p (dark grey) and (99,590)p/(50,194)p (light grey) grid combinations.

FIGURES

23

