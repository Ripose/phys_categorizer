9
9
9
1
 
l
u
J
 
7
2
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
5
4
0
7
0
9
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Approximate Solution of the Representability Problem

A. I. Panin

Chemistry Department, St.-Petersburg State University
University prospect 2, St.-Petersburg 198904, Russia
FAX: (07)-(812)-428-69-39; E-mail: andrej@AP2707.spb.edu

ABSTRACT: Approximate solution of the ensemble representability prob-
lem for density operators of arbitrary order is obtained. This solution is similar
in its simplicity to the Coleman’s solution for 1-density operators. The repre-
sentabilty conditions are formulated in orbital representation and are easy for
computer implementation. They are tested numerically on the base of CI calcula-
tion of simple atomic and molecular systems.

Key words: representability problem, reduced density operators, electron

correlation.

1.Introduction

In the last decade a number of Post HF methods of high precision have
been developed [1]. It is unlikely, however, that in the nearest future these
methods in their present form have any chance to be applied for electronic
structure calculations of extensive molecular and crystalline systems. Instead
much more simple DFT methods [2] based on the work of Kohn [3] are
becoming the main tool for calculations of such systems.

There exists an alternative approach in density functional theory which
progress had been restricted by serious mathematical problems connected
with the so-called representability property of 2-electron density. After the
famous theorem of Coleman [4] who solved the representability problem for
1-density operators, there appeared a number of papers with attempts to
generalize Coleman’s result to treat q-density operators (for q ≥ 2) [5, 6,
7, 8, 9, 10]. These attempts, however, did not end in results of practical
importance. It even became accepted that the problem is far too complicated
to ﬁnd any applications for electronic structure calculations.

In present work it is demonstrated that the general representability prob-
lem being certainly very complicated, for the ﬁnite dimensional case admits
rather simple approximate solution similar in its structure to the solution for

1

the 1-density case. Some relevant calculations of small atomic and molecu-
lar systems testing the quality of the obtained approximate representability
conditions for 2-density operators are discussed.

An alternative approach to approximate treament of the representability

problem is developed in [11] (and references therein).

2.Contraction Operator

Let F1 be one-electron Fock space spanned by an orthonormal set (ψi) of

molecular spin-orbitals. Electronic Fock space is deﬁned as

”Determinant” basis vectors of the Fock space are conveniently labelled by
ﬁnite subsets of N 1 : for any ﬁnite R ⊂ N the corresponding basis determinant
will be denoted by |Ri.

Creation-annihilation operators associated with spin-orbital index i are

deﬁned by the following relations

where

where

and

F =

Fp

p=0
M

p

Fp =

F1

^
F0 = C

a†
i |Ri = (1 − δi,R)(−1)ǫ|R ∪ ii

ai|Ri = δi,R(−1)ǫ|R\ii

δi,R =

1,
0,

(cid:26)

if i ∈ R
if i /∈ R

ǫ = |{1, 2, . . . , i − 1} ∩ R|

(1)

(2)

(3)

(4a)

(4b)

(5)

(6)

is the sign counter.

Creation-annihilation operators obey standard anticommutation relations:

(7a)
j]+ = 0
1Symbols N, R, and C stand for the sets of natural, real, and complex numbers,

[a†

i , a†

respectively

2

(7b)

(7c)

(8a)

(8b)

(9)

(10a)

(10b)

(11a)

(11b)

(11c)

(11d)

[ai, aj]+ = 0
[a†

i , aj]+ = δij

uij : z → a†
i zaj
dij : z → aiza†
j
If z ∈ Fr ⊗ F ∗

Let us introduce step-up and step-down (super)operators acting on the

operator space F ⊗ F ∗:

where z is an arbitrary operator over F .
s+1 and dij(z) ∈ Fr−1 ⊗ F ∗
Fr+1 ⊗ F ∗

s−1.
The operator space F ⊗ F ∗ may be equipped with inner product

s then uij(z) ∈

It is clear that step-up and step-down operators are mutually conjugate

with respect to this inner product.

Now we can deﬁne the contraction and expansion operators as

(z|t) = Sp(z†t)

c =

dii

Xi

e =

uii

i
X
There exist several useful relations involving contraction and creation-

annihilation operators that can be easily veriﬁed by induction:

ck(za†

i ) = (−1)kck(z)a†

i

ck(aiz) = (−1)kaick(z)
ck(zai) = (−1)kck(z)ai + (−1)k−1kaick−1(z)
i ck(z) + (−1)k−1kck−1(z)a†
ck(a†

i z) = (−1)ka†

i

where k = 1, 2, 3, . . .
Let zp ∈ Fp ⊗ F ∗

”determinant generators” as

p be some p-electron operator. It is expanded via basis

zp =

ZRS|RihS|

(12)

(p)

XR,S

3

It can be shown [12] that

ck(zp) = k!

ZRS

(−1)|(R∆S)∩∆K ||R\KihS\K|

(13)

(p)

XR,S

(k)

XK⊂R∩S

The deﬁnition and properties of the set- theoretical operation ∆ are collected
in Appendix A.

Comparing traces of zp and ck(zp), we come to the following relation

In particular,

Sp(zp) =

Sp(ck(zp)), k = 0, 1, 2, . . .

1
p
k

k!
(cid:16)

(cid:17)

(zp|tp) =

h∅|cp(z†

ptp)|∅i

1
p!

(14)

(15)

where |∅i is the vacuum vector. Note that the combinatorial prefactors in
Eqs.(14)-(15) depend on the number of electons the operator under contrac-
tion corresponds to.

Let us consider the electronic Hamiltonian of the form

H =

hi|h|jia†

i aj +

|klia†

i a†

jalak

(16)

i,j
X

1
2

Xi,j,k,l

hij|

1
r12

which is obviously a particle number concerving operator: HFp ⊂ Fp for any
p = 0, 1, 2, . . . The energy functional corresponding to p-electron system is
deﬁned as

E(zp) = (H|zp)

(17)

and is a linear mapping from Fp ⊗ F ∗
p to C. In the particular case of pure
p-electron state zp = |ΨihΨ| Eq.(17) reduces to the standard average en-
ergy expression. Using speciﬁc form of electronic Hamiltonian, it is possible
to contract the energy domain and redeﬁne energy in terms of 2-electron
operators. Indeed, for arbitrary p-electron operator zp

Sp(a†

i ajzp) = Sp (ajzpa†
i )

=

Sp(ajcp−2(zp)a†

i ) =

Sp(a†

i ajcp−2(zp))

1
(p − 1)!

(p−1)−electron
operator
{z

|

}

1
(p − 1)!

4

and

Sp(a†

i a†

jalakzp) = Sp (alakzpa†

i a†
j)

=

Sp(cp−2(alakzpa†

i a†

j)) =

1
(p − 2)!

|

(p−2)−electron
operator
}
{z
i a†
Sp(a†

1
(p − 2)!

jalakcp−2(zp))

Introducing reduced Hamiltonian

Hp =

1
p − 1

i,j
X

1
2

Xi,j,k,l

hij|

1
r12

hi|h|jia†

i aj +

|klia†

i a†

jalak

(18)

we can rewrite the energy expression (17) in the form

E(zp) = Sp

Hp

cp−2(zp)

=

Sp

Hp

cp−2(zp)

(19)

1
(p − 2)!

(cid:18)

p
2!

 

2
p!

(cid:19)

(cid:18)

(cid:19)

The unknown operator on the right-hand side of this equation is 2-electron
one with the unit trace. Therefore, if we were interested in the energy func-
tionals on Fp ⊗ F ∗
p we could easily redeﬁne them on F2 ⊗ F ∗
2 . Unfortunately,
the actual situation is much more complicated. Indeed, physically relevant
are the so-called density operators that are distinguished from general linear
operators by the following three properties:

(i) Positive semideﬁnitness;
(ii) Hermiteancy;
(iii) Unit trace.
The set of all p-electron density operators will be denoted by Ep. The
set Ep may be characterized both analytically and parametrically. Indeed,
axioms (i)-(iii) give us analytic description of Ep in terms of linear equalities
and inequalities. On the other hand, it is not diﬃcult to recognize that Ep is
a convex hull of the so-called pure states:

tp ∈ Ep ↔ tp =

λi|ΨiihΨi|

where

λi ≥ 0

(i = 1, 2, . . . , n)

(21)

(22)

n

Xi=1

5

(23)

(24)

(25)

(26)

λi = 1

n

i=1
X

and Ψi ∈ Fp.

It can be easily veriﬁed also that

The set

(p − k)!
p!

ckEp ⊂ Ep−k

Wp,p−k =

(p − k)!
p!

ck(Ep)

is a proper subset of Ep−k and is called the set of p–representable density op-
erators of order p-k. Unfortunately, in general case the structure of these sete
seems to be so complicated that numerous attempts to ﬁnd their constructive
description have not lead to practically useful results.

Taking some inner point of Wp,k, we can try to construct certain functions
that determine the distance from a ﬁxed inner point of Wp,k to its border
∂Wp,k along some chosen direction. For the case of ﬁnite dimensions there
exists natural central point of convex sets Ek and Wp,k (normalized identity
operator):

wk =

|IihI|

1
n
k

(k)

XI⊂N

(cid:17)
where N is the set of spin-orbital indices, |N| = n, and the energy functional
may be rewritten in terms of 2-electron density operators as

(cid:16)

E(t2, ε(t2)) =

Sp(Hp{w2 + ε(t2)[t2 − w2]})

(27)

p
2!

 

where ε(t2) determines the distance from w2 to ∂Wp,2 along the direction
t2 − w2.

3. Outer and Inner Approximations for the Convex Set
of Representable Density Operators.

First of all let us analyze one of two cases where the ensemble repre-
sentability problem admits constructive solution. To this end it is convenient

6

ckeIJ

L = k!

eIJ
K

(|L|−k)

XK⊂L

I|Ri = |N\Ri

Ip ◦ In−p = idFn−p

In−p ◦ Ip = idFp

hΨ|In−p = hIpΨ|

In−p,p : z → IpzIn−p

to introduce a new basis in the operator space that diﬀers from the basis of
the determinant generators by the phase multipliers [12]:

L = (−1)|(I∪J)∩∆L||I ∪ LihJ ∪ L|
eIJ

where I ∩ J = ∅. From this deﬁnition and Eq.(13) it readily follows that

Over the ﬁnite-dimensional electronic Fock space there exists an involu-

tion deﬁned as

Its restriction to the p-electron section of Fock space is an isomorphic map-
ping from Fp to Fn−p and

With each vector |Ψi ∈ Fp a semilinear functional hΨ| : Fp → C is

associated and

where hΨ|In−p is a composition of mappings Fn−p

In−p−→ Fp

hΨ|
−→ C.

For each pair (n − p, p) let us put

where z is an arbitrary p-electron operator. It is immediately clear that In−p,p
is an isomorphic mapping of Fp⊗F ∗
n−p. Simple manipulations
lead to the conclusion that

p onto Fn−p⊗F ∗

The eﬀect of In−p,p on basis operators (29) is given by

In−p,p(Ep) = En−p

In−p,p(eIJ

L ) = (−1)αIJ eJI
K

7

(28)

(29)

(30)

(31a)

(31b)

(32)

(33)

(34)

(35)

where αIJ = |(I ∪ J) ∩ ∆N \(I∪J)|, and K = N\(I ∪ J ∪ L). Note that the sign
prefactor on the right-hand side of Eq.(35) depends on the index set I ∪ J
but not on its cardinal number.

Let us introduce certain symmetric combinations of q-electron basis op-

erators:

(cid:16)
where I ∩ J = ∅, |I| = |J| = s, L ⊂ N\(I ∪ J), |L| = p − s, and Pq−s(L)
stands for the set of all (q − s)−subsets of (p − s)− set L.

(cid:17)

We can rewrite Eq.(29) in the form

wIJ

Pq−s(L) =

1
p−s
q−s

(q−s)

XK⊂L

eIJ
K

q!
p!

cp−qeIJ

L = (cid:16)

wIJ

Pq−s(L)

(cid:17)

p−s
q−s
p
q

(cid:16)
Let us suppose that p + q = n. In this case the contraction operator is an
isomorphic mapping [12] which means that the set of vectors (36) is a basis
set of the q-electron operator space. We can therefore deﬁne nondegenerate
linear operator in the following manner:

(cid:17)

A(n, p, q)wIJ

Pq−s(L) = (−1)αIJ

eJI
N \(I∪J∪L)

(38)

Comparing Eqs.(35),(37),and(38) immediately leads to the conclusion that
for p + q = n

p
q
(cid:16)
(cid:17)
p−s
q−s

(cid:16)

(cid:17)

q!
p!

A(n, p, q)cp−q = In−p,p

A(n, p, q)Wp,q = Eq
(p + q = n)

and, consequently,

It seems pertinent to note that operator satisfying Eq.(40) is not unique. We
can as well take any composition of A(n, p, q) with operator leaving the set
Eq invariant. For example, the transposition

τ : |RihS| → |SihR|

(41)

(36)

(37)

(39)

(40)

8

possesses this property and we can use τ ◦ A(n, p, q) instead of A(n, p, q). In
contrast to the operator A(n, p, q) the operator τ ◦ A(n, p, q) is conveniently
block-diagonal:

τ ◦ A(n, p, q) =

τ ◦ AIJ (n, p, q)

(42)

MI,J
where AIJ (n, p, q) is the restriction of A(n, p, q) on the subspace of p-electron
operator space spanned by the basis operators (28) with ﬁxed I, J.

After complicated combinatorial manipulations (closely related to the fa-
mous inclusion-exclusion principle) the explicit matrix representation of the
operator τ ◦ A(n, p, q) can be obtained

τ ◦ A(n, p, q)eIJ

K = (−1)αIJ

p
q

(q−s)

(cid:16)
p−s
q−s

(cid:17)
n−p
q

XK ′⊂N \(I∪J)

(−1)|K∩K ′|

p+|K∩K ′|−q−1
|K∩K ′|
q−s
|K∩K ′|

(cid:16)

eIJ
K ′

(cid:17)

(43)
Unless otherwise stated, by an abuse of notation, we will use the symbol
A(n, p, q) for the operator deﬁned by Eq.(43).

(cid:17)(cid:16)

(cid:17)

(cid:17)

(cid:16)

(cid:16)

Thus, in the case p + q = n the convex set Wp,q can be explicitly charac-

terized in several equivalent ways:

as the pre-image of Eq with respect to A(n, p, q)

Wp,q = A−1(n, p, q)Eq;

as the set of solutions of the system

hΦ|A(n, p, q)t|Φi ≥ 0, Φ ∈ Fq
Sp(t) = 1;

(cid:26)

as a convex body with the distance function

1

ε(t) =

1 −

n
q

min
||Φ||=1

(cid:16)

(cid:17)

hΦ|A(n, p, q)t|Φi

(44a)

(44b)

(44c)

where Φ ∈ Fq and Sp(t) = 1.

Let us try to generalize the approach described to handle the case p + q <
n. The ﬁrst idea coming to mind is to use the operator deﬁned by Eq.(43) in
general case. This operator is nondegenerate for n ≥ p ≥ q, p + q ≤ n (see
Appendix B). It can be shown as well that

A(n, p, q)Wp,q ⊂ Eq

(45)

9

(see Appendix C). From this inclusion and positive deﬁniteness of the reduced
density operators it readily follows that the convex set

Vp,q = A−1(n, p, q)Eq ∩ Eq

is an outer approximation for Wp,q. Simple combinatorial manipulations lead
to the conclusion that

A(n, p, q)wq = wq

that is Vp,q, Wp,q, and Eq share the same central point.

Thus, we have constructed the compact convex set that may serve as
a certain outer approximation for the set Wp,q and coincide with Wp.q in
the particular case p + q = n. It is not diﬃcult to demonstrate, however,
that in the case q = 1 this set diﬀers from Wp,1. The reason is the unitary
noninvariance of A(n, p, q).

It is well-known that the contraction operator is invariant with respect

to the induced unitary transformations of the type

ρk(u) = (∧ku) ⊗ (∧ku†), u ∈ Un(F1)

that is

cρk(u)tk = ρk−1(u)ctk

for any tk ∈ Fk ⊗ F ∗
set Ek, we can conclude that

k . Taking into account obvious unitary invariance of the

(46)

(47)

(48)

(49)

(50)

ρq(u)Wp,q = Wp,q

for any u ∈ Un(F1).

Direct calculations show that to restore the desired unitary invariance
of Vp,1 it is suﬃcient to modify the phase prefactors in deﬁnition (43)(see
Appendix D).

Let us introduce the phase transformation

ν : |RihS| → (−1)|R∆S)∩∆N ||RihS|

(51)

It leaves invariant the sets Ek and, consequently, we can replace the oper-
ator A(n, p, q) by ν ◦ A(n, p, q). Matrix representation of the last operator
diﬀers from Eq.(43) only by the sign prefactor that should be taken equal
to (−1)|(I∪J)∩∆(I∪J )|. Hereafter, only the operator ν ◦ A(n, p, q) will be under

10

consideration and, by an abuse of notation, we will use for it the same symbol
A(n, p, q).

In the particular case q = 1 we have

Using the unitary invariance of A(n, p, 1) we can state that t1 ∈ Vp,1 if and
only if u†t1u ∈ Vp,1 where u is the unitary transformation diagonalizing
density operator t1.But for diagonal t1, with the aid if Eq.(52a), we can
obtain the equivalence

A(n, p, 1)e∅∅

k =

1 − pδkl
n − p

e∅∅
l

n

Xl=1

A(n, p, 1)eij

∅ = −

p
n − p

eij
∅

t1 ∈ Vp,1 ⇔

k ≤ 1
0 ≤ t∅∅
p
Sp(t1) = 1

(

that immediately implies Vp,1 = Wp,1(consequence of the famous Coleman’s
theorem [4]).

Direct but somewhat tedious combinatorial calculations lead to the im-
portant commutation relation of the operator A(n, p, q) with the contraction
operator:

A(n, p, q − 1)c = cA(n, p, q)

(54)

Now we can state that the convex sets Vp,q giving an outer approximations
for the sets Wp,q possess the following properties

Vp,q = Wp,q f or q = n − p and q = 1;

1
q

cVp,q ⊂ Vp,q−1 f or any q ≤ p

These sets may be explicitely described in several equivalent ways:

as the intersection of Eq with its pre-image with respect to A(n, p, q)(see

Eq.(46))

as the set of solutions of the system

(52a)

(52b)

(53)

(55a)

(55b)

(56a)

hΦ|tq|Φi ≥ 0,
hΦ|A(n, p, q)tq|Φi ≥ 0
Sp(tq) = 1






11

where Φ ∈ Fq;

as a convex body with the distance function

ε(tq) = min{

1

1 −

n
q

min
||Φ||=1

(cid:16)

(cid:17)

,

1

n
q

min
||Φ||=1

(cid:16)

(cid:17)

hΦ|tq|Φi

1 −

hΦ|A(n, p, q)tq|Φi

} (56b)

It is clear that tq ∈ ∂Vp,q if and only if
where Φ ∈ Fq and Sp(tq) = 1.
ε(tq) = 1. In the particular case of pure p-electron determinant state |RihR|
the spectra of tq (see Eq.(37)) and A(n, p, q)tq (see Eq.(C.3)) are

σ(

cp−q|RihR|) = {0,

}

q!
p!

1
p
q

σ(A(n, p, q)

(cid:17)
cp−q|RihR|) = {0,

(cid:16)

q!
p!

1
n−p
q

}

(cid:16)

(cid:17)

q!
p!

cp−q|RihR| ∈ ∂Vp,q ∩ ∂Wp,q

and, consequently,

There exists much more general form of the last statement. Namely
contraction tq(Ψ) of arbitrary p-electron pure state |ΨihΨ| belongs to ∂Vp,q ∩
∂Wp,q if the minimal eigenvalue of tq(Ψ) is equal to zero.

Eqs.(38)-(40) show also one of possible ways to get some inner approxi-

mation for the set Wp,q. Indeed, let us consider q-electron operators

tq(X) =

tRS|RihS|

(q)

XR,S⊂X

where X ⊂ N, |X| = p + q.For such vectors we have

A−1(p + q, p, q)Eq(X) = Wp,q(X)

Let us consider the convex set

Qp,q = Conv{

Wp,q(X)}

(p+q)

[X⊂N

12

(57a)

(57b)

(58)

(59)

(60)

(61)

It is clear that Qp,q ⊂ Wp,q and that

(p+q)

XX⊂N

(p+q)

XX⊂N

1
n
p+q

(cid:16)

(cid:17)

tq ∈ Qp,q ⇔ tq =

λXA−1(p + q, p, q)tq(X)

(62)

where

λX = 1, λX ≥ 0, and tq(X) ∈ Eq(X). It is easy to show that

(p+q)

X⊂N
P

wq =

wq(X)

(63)

that is the central point wq belongs to Qp,q.
It is clear as well that the
contraction of any pure determinant p-electron generator |RihR| lies in Qp,q.
It is to be noted that the outer approximation obtained is characterized
in terms of q−electron quantities whereas the description of the inner one
requires very large convex combinations with number of terms determined
by the binomials involving the number of electrons in the system. It seems
to be a general rule valid for any approximations.

4. Density Operators in Orbital Representation

Let (ϕi) be an orthonormal set of m orbitals. Following Handy [13] we
identify p-electron determinants generated by these MOs, with pairs of index
sets (strings):

|Rα, Rβi = a†

i1α . . . a†

ipα αa†

j1α . . . a†

jpβ β|∅i

(64)

where Rα = 1 < i1 < . . . < ipα < m, Rβ = 1 < j1 < . . . < jpβ < m, and
pα + pβ = p. The action of the contraction operator on the split determinant
generators may be written as

ck|Rα, RβihSα, Sβ| =

(kα)

(kβ)

kα,kβ
X
(kα+kβ =k)

XKα⊂Rα∩Sα

XKβ⊂Rβ ∩Sβ

= k!

where

(−1)a|Rα\Kα, Rβ\KβihSα\Kα, Sβ\Kβ|

(65)

a = |Rα∆Sα| × |Kβ|2 + |(Rα∆Sα) ∩ ∆Kα| + |(Rβ∆Sβ) ∩ ∆Kβ |

(66)

13

|Kβ|2 =

0,
1,

(

if |Kβ| ≡ 0 (mod 2)
if |Kβ| ≡ 1 (mod 2)

(67)

Split basis operators analogous to ones deﬁned by Eq.(28) are

e(Iα,Jα)(Iβ ,Jβ)
(Lα,Lβ)

= (−1)a|Iα ∪ Lα, Iβ ∪ LβihJα ∪ Lα, Jβ ∪ Lβ|

(68)

where Iα ∩ Jα = ∅, Iβ ∩ Jβ = ∅,

a = |Iα ∪ Jα| × |Lβ|2 + |(Iα ∪ Jα) ∩ ∆Lα| + |(Iβ ∪ Jβ) ∩ ∆Lβ |

(69)

and

and

q!
p!

cp−qe(Iα,Jα)(Iβ ,Jβ)
(Lα,Lβ)

=

(kα)

(kβ)

e(Iα,Jα)(Iβ ,Jβ)
(Kα,Kβ)

=

kα,kβ
X
(kα+kβ =q−s)

XKα⊂Lα

XKβ⊂Lβ

= (cid:16)

w(Iα,Jα)(Iβ ,Jβ)
Pq−s(Lα,Lβ)

(cid:17)

(70)

The operator A(2m, p, q) acts on the basis vectors (68) as

A(2m, p, q)e(Iα,Jα)(Iβ ,Jβ)

(Kα,Kβ)

= (−1)a

(kα)

(kβ )

kα,kβ
X
(kα+kβ =q−s)

α⊂M \(Iα∪Jα)

XK ′

XK ′

β⊂M \(Iβ∪Jβ)

1
p
q

(cid:16)

(cid:17)

p−s
q−s
p
q

(cid:16)

(cid:17)

(−1)|Kα∩K ′

α|+|Kβ∩K ′
β|

(cid:16)

e(Iα,Jα)(Iβ ,Jβ)
α,K ′
(K ′
β)

(cid:17)

(71)

where M is the orbital index set (|M| = m, N = M ⊔ M), s = |Iα| + |Iβ| =
|Jα| + |Jβ|, and

a = |Iα ∪ Jα| × |Iβ ∪ Jβ|2 + |(Iα ∪ Jα) ∩ ∆(Iα∪Jα)| + |(Iβ ∪ Jβ) ∩ ∆(Iβ∪Jβ)| (72)

Note that the ﬁrst terms on the right-hand side of Eqs.(69) and (72) are
determined by the initial spin orbital index set ordering and its current form
corresponds to the split determinant representation (64), where α indices
always go ﬁrst.

14

p
q

(cid:16)

p−s
q−s

(cid:17)
2m−p
q

(cid:16)

(cid:17)(cid:16)

(cid:17)

p+|Kα∩K ′

α|+|Kβ∩K ′

β|−q−1

|Kα∩K ′

|Kα∩K ′

(cid:16)

α|+|Kβ∩K ′
β|
q−s
α|+|Kβ∩K ′
β|

(cid:17)

Let us consider p-electron states with a given value of the total spin
projection MS. The set of all such states is generated by the determinants
(64) with ﬁxed |Rα| = pα, |Rβ| = pβ, since, by assumption, pα + pβ = p, and
pα−pβ = 2MS. Contraction of an arbitrary determinant generator p−2 times
may lead to nonzero result only if |Rα ∩ Rβ| + |Sα ∩ Sβ| ≥ p − 2 which means
that on the 2-electron level there may appear only three types of generators:

As a result, of interest are block-diagonal 2-electron density operators of the
form

|r1r2, ∅ihs1s2, ∅|

|∅, r1r2ih∅, s1s2|

|r1, r2ihs1, s2|

t2 = tα

2 + tβ

2 + tαβ

2

tα
r1r2;s1s2|r1r2, ∅ihs1s2, ∅|

tβ
r1r2;s1s2|∅, r1r2ih∅, s1s2|

tα
2 =

tβ
2 =

r1<r2
X
s1<s2

r1<r2
X
s1<s2

r1,r2
X
s1,s2

tαβ
2 =

tαβ
r1,r2;s1,s2|r1, r2ihs1, s2|

Reduced Hamiltonian in the orbital representation is

Hp =

hijEij +

(ij|kl)[EijEkl − δjkEil]

(76)

1
p − 1

m

i,j=1
X

m

1
2

Xi,j,k,l=1

hij =

ϕ∗

i (r1)hϕj(r1)dr1

ZR3

(ij|kl) =

ϕ∗

i (r1)ϕj(r1)

ϕ∗

k(r2)ϕl(r2)dr1dr2

1
r12

ZR3×R3

Eij = Eα

ij + Eβ

ij = a†

iαajα + a†

iβajβ

15

(73a)

(73b)

(73c)

(74)

(75a)

(75b)

(75c)

(77)

(78)

(79)

where

where

and

Standard but somewhat tedious algebraic manipulations lead to the fol-

are the unitary group generators.

lowing general energy expression

E(t2) =

p
2!(cid:20)
 

1
p − 1

m

m

[
Xi,j=1
Xk=1

(¯tα

ik;jk + ¯tβ

ik;jk + tαβ

i,k;j,k + tαβ

k,i;k,j)]hij+

+

(tα

ij;kl + tβ

ij;kl)[(ki|lj) − (kj|li)] +

tαβ
i,j;k,l(ki|lj)

(80)

m

Xi,j,k,l=1

(cid:21)

i<j
X
k<l

where

¯tσ
ij;kl =

ij,lk

ji,kl

ij;kl

+tσ
−tσ
−tσ
+tσ
ji;lk
0
(σ = α, β)

if i < j and k < l
if i < j and k > l
if i > j and k < l
if i > j and k > l
if i = j or k = l






In particular,

p
2
E(w2) = (cid:16)
(cid:17)
2m
2

2m − 1
p − 1

2
(cid:20)

m

i=1
X

hii +

m

i,j=1
X

(cid:16)

(cid:17)

[2(ii|jj) − (ij|ji)]
(cid:21)

(82)

and

E(w(∅,∅)(∅,∅)

P2(L,L) ) = 2

hii +

[2(ii|jj) − (ij|ji)]

(83)

Xi∈L

Xi,j∈L

With determinant generators (73a)-(73c) ten diﬀerent types of basis op-

erators deﬁned by Eq.(68) are associated:

e(∅,∅)(∅,∅)
(k1k2,∅) = |k1k2, ∅ihk1k2, ∅|
(k1 < k2)

e(i,j)(∅,∅)
(k,∅)

= (−1)|{i,j}∩∆k||{i, k}, ∅ih{j, k}, ∅|

(i 6= j 6= k)

e(i1i2,j1j2)(∅,∅)
= |i1i2, ∅ihj1j2, ∅|
(∅,∅)
(i1 < i2, j1 < j2, i1 6= j1, i2 6= j2)

16

(81)

(84a)

(84b)

(84c)

e(∅,∅)(∅,∅)
(∅,k1k2) = |∅, k1k2ih∅, k1k2|
(k1 < k2)

e(∅,∅)(i,j)
(∅,k)

= (−1)|{i,j}∩∆k||∅, {i, k}ih∅, {j, k}|

(i 6= j 6= k)

e(∅,∅)(i1i2,j1j2)
= |∅, i1i2ih∅, j1j2|
(∅,∅)
(i1 < i2, j1 < j2, i1 6= j1, i2 6= j2)

e(∅,∅)(∅,∅)
(k1,k2) = |k1, k2ihk1, k2|
e(∅,∅)(i,j)
(k,∅)

= |k, iihk, j|

e(i,j)(∅,∅)
(∅,k)

= |i, kihj, k|

(i 6= j)

(i 6= j)

e(i1,j1)(i2,j2)
(∅,∅)

= |i1, i2ihj1, j2|

(i1 6= j1, i2 6= j2)

The operator A(2m, p, 2) acts on these basis vectors in the following man-

ner (see Eq.(71)):

2m − p

 

2 !

A(2m, p, 2)e(∅,∅)(∅,∅)

(k1k2,∅) =

e(∅,∅)(∅,∅)
(k1k2,∅) −

p
2!

 

−

p
2 (cid:20)

k1−1

Xk′
1=1

e(∅,∅)(∅,∅)
1k1,∅) +
(k′

k2−1

e(∅,∅)(∅,∅)
(k1k′

2,∅) +

e(∅,∅)(∅,∅)
1k2,∅) +
(k′

Xk′
2=k1+1

Xk′
1=1
2) + e(∅,∅)(∅,∅)
(k2,k′
2)

e(∅,∅)(∅,∅)
(k1,k′

+

2m
2 !

 

w2

(cid:21)

e(∅,∅)(∅,∅)
(k2k′
2,∅)

−

(cid:21)

Xk′
2=k2+1

−

p
2

2 (cid:20)
Xk′
2m − p

 

2 !
p
2 (cid:20) Xk′

−

(k′6=i6=j)

A(2m, p, 2)e(i,j)(∅,∅)

(k,∅)

=

e(i,j)(∅,∅)
(k,∅) −

p
2!

 

e(i,j)(∅,∅)
(k′,∅) +

e(i,j)(∅,∅)
(∅,k′)

Xk′

(cid:21)

2m − p

 

2 !

A(2m, p, 2)e(i1i2,j1j2)(∅∅)

=

(∅,∅)

e(i1i2,j1j2)(∅∅)
(∅,∅)

(87c)

p
2!

 

17

(85a)

(85b)

(85c)

(86a)

(86b)

(86c)

(86d)

(87a)

(87b)

2m − p

 

2 !

A(2m, p, 2)e(∅,∅)(∅,∅)

(∅,k1k2) =

e(∅,∅)(∅,∅)
(∅,k1k2) −

p
2!

 

−

p
2 (cid:20)

k1−1

Xk′
1=1

e(∅,∅)(∅,∅)
(∅,k′

1k1) +

k2−1

e(∅,∅)(∅,∅)
(∅,k1k′

2) +

e(∅,∅)(∅,∅)
(∅,k′

1k2) +

Xk′
2=k1+1

Xk′
1=1
1,k1) + e(∅,∅)(∅,∅)
1,k2)

e(∅,∅)(∅,∅)
(k′

(k′

+

2m
2 !

 

w2

(cid:21)

e(∅,∅)(∅,∅)
(∅,k2k′
2)

−

(cid:21)

Xk′
2=k2+1

−

p
2

1 (cid:20)
Xk′
2m − p

 

2 !
p
2 (cid:20) Xk′

−

(k′6=i6=j)

A(2m, p, 2)e(∅,∅)(i,j)

(∅,k)

=

e(∅,∅)(i,j)
(∅,k) −

p
2!

 

e(∅,∅)(i,j)
(∅,k′) +

e(∅,∅)(i,j)
(k′,∅)

Xk′

(cid:21)

(88a)

(88b)

A(2m, p, 2)e(∅,∅)(i1i2,j1j2)

=

(∅,∅)

e(∅,∅)(i1i2,j1j2)
(∅,∅)

(88c)

A(2m, p, 2)e(∅,∅)(∅,∅)

(k1,k2) =

e(∅,∅)(∅,∅)
(k1,k2) −

−

p
2 (cid:20)

k1−1

Xk′
1=1

e(∅,∅)(∅,∅)
1k1,∅) +
(k′

e(∅,∅)(∅,∅)
(k1k′
2,∅)

−

(cid:21)

p
2 (cid:20)Xk′

1

e(∅,∅)(∅,∅)
1,k2) +
(k′

e(∅,∅)(∅,∅)
(k1,k′
2)

−

(cid:21)

Xk′

2

Xk′
2=k1+1

2m − p

 

2 !

2m − p

 

2 !

(89a)

(89b)

k2−1

−

p
2 (cid:20)

Xk′
1=1
2m − p

e(∅,∅)(∅,∅)
(∅,k′

1k2) +

Xk′
2=k2+1

e(∅,∅)(∅,∅)
(∅,k2k′
2)

+

2m
2 !

 

w2

(cid:21)

A(2m, p, 2)e(∅,∅)(i,j)

(k,∅)

=

e(∅,∅)(i,j)
(k,∅) −

e(∅,∅)(i,j)
(k′,∅) +

e(∅,∅)(i,j)
(∅,k′)

Xk′
(k′6=i6=j)

2m − p

A(2m, p, 2)e(i,j)(∅,∅)

(∅,k)

=

e(i,j)(∅,∅)
(∅,k) −

 

 

2 !
p
2 (cid:20)Xk′

−

2 !
p
2 (cid:20)Xk′

−

Xk′
(k′6=i6=j)

18

e(i,j)(∅,∅)
(∅,k′) +

e(i,j)(∅,∅)
(k′,∅)

(89c)

p
2!

 

p
2!

 

p
2!

 

p
2!

 

(cid:21)

(cid:21)

2m − p

 

2 !

A(2m, p, 2)e(i1,j1)(i2,j2)

=

(∅,∅)

e(i1,j1)(i2,j2)
(∅,∅)

(89d)

p
2!

 

Using Eqs.(87)-(89), it is not diﬃcult to calculate the result of action of

A(2m, p, 2) on arbitrary second order density operator of the form (74):

where

A(2m, p, 2)t2 = dα

2 + dβ

2 + dαβ

2

2m − p

 

2 !

2m − p

 

2 !

dβ
2 =

p
2!

p
2!

 

 

dα
2 =

tα
2 +

wα

2 −

τ α
2

tβ
2 +

wβ

2 −

τ β
2

p
2

p
2

2m
2 !

 

2m
2 !

 

2m
2 !

 

2m − p

 

2 !

dαβ
2 =

p
2!

 

tαβ
2 +

wαβ

2 −

τ αβ
2

p
2

+

+

i,j
k1
(i6=j) X
X
(k16=i6=j)

i,j
k1
(i6=j) X
X
(k16=i6=j)

Xk1,k2

τ α
2 =

|k1k2, ∅ihk1k2, ∅|

¯tα
kk2;kk2 +

¯tα
k1k;k1k +

k1,k;k1,k +tαβ
(tαβ

k2,k;k2,k)

+

Xk1<k2

(cid:20)Xk=1

Xk=1

(−1)|{i,j}∩∆k1 ||{i, k1}, ∅ih{j, k1}, ∅|

ik;jk + tαβ

i,k;j,k)

(92a)

τ β
2 =

|∅, k1k2ih∅, k1k2|

¯tβ
kk2;kk2 +

¯tβ
k1k;k1k +

(tαβ
k,k1;k,k1 +tαβ

k,k2;k,k2)

+

Xk1<k2

(cid:20)Xk=1

Xk=1

(−1)|{i,j}∩∆k1 ||∅, {i, k1}ih∅, {j, k1}|

ki;kj + tαβ

k,i;k,j)

(92b)

Xk=1
(¯tα

(cid:20)Xk

Xk
(¯tβ

(cid:20)Xk

τ αβ
2 =

|k1, k2ihk1, k2|

k1k;k1k + ¯tβ
(¯tα

kk2;kk2 + tαβ

k1,k;k1,k + tαβ

k,k2;k,k2)

+

+

|i, k1ihj, k1|

i6=j Xk1
i,j
X

(cid:20)Xk

i,k;j,k)

+

|k1, iihk1, j|

(¯tβ

ki;kj+tαβ

k,i;k,j)

(cid:21)

i6=j Xk1
i,j
X

(cid:20)Xk

(cid:20)Xk
ik;jk+tαβ

(¯tα

and wα

2 , wβ

2 , wαβ

2 are the components of the central point

2m
2 !

 

w2 =

|k1k2, ∅ihk1k2, ∅|

+

|∅, k1k2ih∅, k1k2|

+

Xk1<k2

|

α

{z

Xk1<k2

}

|

19

β

{z

}

(90)

(91a)

(91b)

(91c)

(cid:21)

(cid:21)

(cid:21)

(cid:21)
(92c)

(cid:21)

(cid:21)

(93)

(94)

(95a)

(95b)

(96)

(97)

+

|k1, k2ihk1, k2|

Xk1,k2

αβ
The conditions of approximate representability for 2-density operators ob-
{z
tained in this work will probably be more transparent in compare with much
more simple case of 1-density representabilty conditions. For 1-density oper-
ators Eqs.(52) and (71) give

|

}

where

A(2m, p, 1)t1 = dα

1 + dβ

1

2m − p

 

1 !

2m − p

 

1 !

dα
1 = −

tα
1 +

dβ
1 = −

tβ
1 +

p
1!

p
1!

 

 

2m
1 !

 

wα
1

2m
1 !

 

wβ
1

From these equations it readily follows that the minimal eigenvalue µσ
operator dσ

1 is connected with the maximal eigenvalue λσ

1 of
1 by the relation

m of tσ

µσ
1 =

1 − pλσ
m
2m − p

and the distance from the central point of Vp,1 = Wp,1 to its border along the
direction t1 − w1 is

ε(t1) = min

,

1
1 − 2mλα
1

1
1 − 2mλβ
1
5. Numerical Tests

1
1 − 2mµα
1

,

(cid:26)

,

1
1 − 2mµβ

1 (cid:27)

The quality of outer approximation for Wp,2 obtained in Sec.3 may be
tested in the following manner. With the aid of CI or CASSCF method one
can obtained p-electron wavefunction expansion over determinant basis set

Ψ =

CR|Ri

(98)

XR
and then contract the pure p-electron state |ΨihΨ| to get the components of
the 2-density operator

tα
2 (Ψ) =

|k1k2, ∅ihk1k2, ∅|

1
p
2
(cid:17)

(cid:16)

(cid:26) Xk1<k2

(pα)

(pβ )

(cid:20)

Kα⊂M
X
(Kα∋k1,k2)

XKβ⊂M

|CKα,Kβ|2

+

(cid:21)

20

+

|{i, k}, ∅ih{j, k}, ∅|(−1)|{i,j}∩∆k|×

i,j
(i6=j) X
X

k
(k6=i6=j)

(pα−1)

(pβ)

Kα⊂M \{i,j}
X
(Kα∋k)

XKβ⊂M

×
(cid:20)

×
(cid:20)

(pα−2)

(pβ)

XKα⊂M \{i1,i2,j1,j2}

XKβ⊂M

(−1)|{i,j}∩∆Kα |Ci∪Kα,Kβ C ∗

j∪Kα,Kβ

|i1i2, ∅ihj1j2, ∅|×

+

(cid:21)

i1<i2
X
j1<j2
(i1i26=j1j2)

(−1)|{i1,i2,j1,j2}∩∆Kα |Ci1i2∪Kα,Kβ C ∗

j1j2∪Kα,Kβ

(99a)

tβ
2 (Ψ) =

|∅, k1k2ih∅, k1k2|

|CKα,Kβ |2

+

(pα)

(pβ)

(cid:20)

XKα⊂M

Kβ ⊂M
X
(Kβ ∋k1,k2)

|∅, {i, k}ih∅, {j, k}|(−1)|{i,j}∩∆k|×

1
p
2
(cid:17)

(cid:16)
+

(cid:26) Xk1<k2

i,j
(i6=j) X
X

k
(k6=i6=j)

(pα)

(pβ−1)

XKα⊂M

Kβ ⊂M \{i,j}
X
(Kβ ∋k)

(pα)

(pβ −2)

×
(cid:20)

×
(cid:20)

XKα⊂M

XKβ⊂M \{i1,i2,j1,j2}

(−1)|{i,j}∩∆Kβ |CKα,i∪Kβ C ∗

Kα,j∪Kβ

|∅, i1i2ih∅, j1j2|×

+
(cid:21)

i1<i2
X
j1<j2
(i1i26=j1j2)

(−1)|{i1,i2,j1,j2}∩∆Kβ |CKα,i1i2∪Kβ C ∗

Kα,j1j2∪Kβ

(99b)

tαβ
2 (Ψ) =

|k1, k2ihk1, k2|

1
p
2
(cid:17)

(cid:16)

(cid:26) Xk1,k2

(pα)

(pβ )

(cid:20)

Kα⊂M
X
(Kα∋k1)

Kβ ⊂M
X
(Kβ ∋k2)

|CKα,Kβ|2

+
(cid:21)

|i, kihj, k|

(i6=j) Xk
i,j
X

(pα−1)

(pβ )

(cid:20)
XKα⊂M \{i,j}

Kβ ⊂M
X
(Kβ ∋k)

(pα)

(pβ−1)

+

+

|k, iihk, j|

(i6=j) Xk
i,j
X

(cid:20)

Kα⊂M
X
(Kα∋k)

XKβ⊂M \{i,j}

(−1)|{i,j}∩∆Kβ |CKα,i∪Kβ C ∗

Kα,j∪Kβ

(−1)|{i,j}∩∆Kα |Ci∪Kα,Kβ C ∗

j∪Kα,Kβ

+
(cid:21)

+

(cid:21)

(cid:21)(cid:27)

(cid:21)

(cid:21)(cid:27)

+

|i1, i2ihj1, j2|×

i1,i2
X
j1,j2
(i16=i2&j16=j2)

21

(pα−1)

(pβ −1)

×
(cid:20)

XKα⊂M \{i1,j1}

XKβ⊂M \{i2,j2}

(−1)|{i1,j1}∩∆Kα |+|{i2,j2}∩∆Kβ |Ci1∪Kα,i2∪Kβ C ∗

j1∪Kα,j2∪Kβ

(cid:21)(cid:27)

(99c)
Calculation of the lowest eigenvalues of six operators tα
2 , and
dαβ
2 with subsequent employing Eq.(56a) to get ε(t2(Ψ)) makes the prob-
lem of energy E(t2, ε(t2)) evaluation trivial.
It is pertinent to note that
Eqs.(91),(92),and (99) imply that ﬁxing projecton of the total spin of the
initial wavefunction leads to the following restrictions on the traces of com-
ponents of 2-density operators

2 , dα

2 , tαβ

2 , dβ

2 , tβ

Sp(tσ

2 (Ψ)) =

(pσ
2 )
(p
2)

,

Sp(dσ

2 (Ψ)) =

(m−pσ
2 )
(2m−p
2 )

(σ = α, β)

(100)

(101)

and

Sp(tαβ

2 (Ψ)) =

Sp(dαβ

2 (Ψ)) =

,

pαpβ
p
2
(cid:17)

(cid:16)

(m − pα)(m − pβ)
2m−p
2

(cid:16)

(cid:17)

without dependence on the actual representation of the p-electron wavefunc-
tion.

To get some impression about the quality of the obtained outer ap-
proximation for Wp,2 we wrote algorithms for contracting CI expansion of
|ΨihΨ| to get density operators tα, tβ,and tαβ and their images with respect
to A(2m, p, 2). Using these algorithms in parallel with GAMESS program
set [14], we performed calculations of CI wavefunctions for ground and ex-
cited states of small atomic and molecular systems to get for each state the
distance function ε(t2(Ψ)) (see Eqs.(56b)) value to estimate its proximity to
the unit and to compare the energies calculated with Eqs.(27) and (80) with
the CI energies. The results of these calculations are listed in Tables 1 and 2.
In atomic calculations cc pvDZ basis set of Dunning [15] was employed. For
lithium, berrilium, and boron FCI calculations were carried out, whereas for
carbon and nitrogen 1s AO, and for oxygen 1s, 2s AOs were excluded from
the active spaces to keep the sizes of CI expansions reasonable for running
GAMESS on PC. In the case of molecules cc pvDZ basis and FCI were used
for calculation of LiH, and 6-31G Gaussian basis set [16, 17] with frozen 1s
AO for CH2, and 1s, 2s AOs for NH2,H2O, and NH3 was employed. As seen
from Tables 1 and 2, the outer approximation for Wp,2 given by the convex

22

set Vp,2 proved to be surprisingly good and the diﬀerence between CI energies
and energies corresponding to 2-density operator w2 +ε(t2(Ψ))[t2 −w2] ∈ Vp,2
is just negligible. It is to be noted that the contraction procedure based on
Eqs.(99a)-(99c) may lead to serious roundoﬀ errors in matrix elements of
2-density operators, especially when CI expansion is large. As a result, di-
agonalization of 2-density operator may give small negative values for its
lowest eigenvalues in spite of the fact that operator t2(Ψ) for any Ψ is man-
ifestly nonnegative. For this reason in Tables 1 and 2 the absolute values
of ε(t2) deviation from the unit are given. Of interest is also the fact that
for atoms and high symmetry linear molecules the distance from the central
point w2 to the border of Vp,2 is determined by the lowest eigenvalue of the
relevant density operator whereas for low symmetry molecules this distance
is determined by the lowest eigenvalue of the operator A(2m, p, 2)t2.

The energy expression (80) may be essentially simpliﬁed by turning to
a new basis set in the 2-electron section of the Fock space. Indeed, let us
consider basis set of eigenvectors of three matrices (for readers liking rigorous
mathematics it is pertinent to recall that E′(t2) ∈ HomR(F2 ⊗ F ∗
2 , R) ∼
F ∗

2 ⊗ F2 ∼ HomR(F2, F2)):

(102a)

(102b)

(102c)

H α

ij;kl =

H β

ij;kl =

H αβ

i,j;k,l =

∂E(t2)
∂tα

ij;kl

∂E(t2)
∂tβ

ij;kl

∂E(t2)
∂tαβ

i,j;k,l

(m
2 )

r,s=1
X

(m
2 )

r=1
X

(m
2 )

r=1
X

23

m2

r,s=1
X

m2

r=1
X

In this basis arbitrary 2-density operator is of the form

t2 =

rs|Φα
λα

r ihΦα

s | +

rs|Φβ
λβ

r ihΦβ

s | +

rs |Φα
λαβ

r ihΦβ
s |

(103)

(m
2 )

r,s=1
X

and the electronic energy expression may be written

E(t2) =

rrǫα
λα

r +

rrǫβ
λβ

r +

rr ǫαβ
λαβ
r

(104)

Here {ǫα
vectors of the matrices (102a), (102b), and (102c), correspondingly.

r i} are the eigenvalues and eigen-

r i}, and {ǫαβ

r i}, {ǫβ

r , |Φαβ

r , |Φα

r , |Φβ

Replacing t2 by A(2m, 2m−p, 2)d2 leads to new somewhat unusual energy

expression:

E(d2) =

2m − p

2 !(cid:20)

2
p − 1

 

m

+

dαβ
i,j;k,l(ki|lj)

+ 2

2m − 1
p − 1

(cid:21)

i<j
X
k<l

Xi,j,k,l=1

−2

2m − p
p − 1 (cid:20)

Sp(d1h) +

(dα

ij;kl + dβ

ij;kl)[(ki|lj) − (kj|li)]+

Sp(h) +

[2(ii|jj) − (ij|ji)]−

m

i,j=1
X
m

m

(m − 1)Sp(d1h) + Sp(h)

− (2m − p)

dij

[2(ij|kk) − (ik|kj)]

(cid:21)

Xi,j=1

Xk=1

(105)
where d1 = (dij) = 1
2cd2 is 2 → 1 contraction of 2-electron operator d2. Since
A(2m, p, 2) is an isomorphic mapping, this energy expression is equivalent to
Eq.(80) and may be termed as ”energy in d - representation”. By turning
to the basis of the eigenfunctions of the operator E′(d2) we can rewrite the
energy expression (105) in the form analogous to that of Eq.(104).

It very easy to ﬁnd energy minimal points separately on sets E2 and
Indeed, energy as a functional on E2 reaches is minimal

A−1(2m, p, 2)E2.
value at the following ensemble of 2-electron states:

tmin
2 = (cid:16)

|Φα

1 ihΦα

1 | + (cid:16)

|Φβ

1 ihΦβ

1 | +

|Φαβ

1 ihΦαβ
1 |

(106)

pα
2
p
2
(cid:17)

(cid:17)

(cid:16)

pβ
2
p
2
(cid:16)

(cid:17)

(cid:17)

pαpβ
p
2
(cid:17)

(cid:16)

The analogous expression may be obtained for the case of the set A−1(2m, p, 2)E2
as the energy domain. Minimal energy values on sets E2 and A−1(2m, p, 2)E2
are far too low in compare with the CI energies. Nevertheless, such calcula-
tions are useful for qualitative understanding of structure of the set Vp,2 that
is shown schematically on Fig.1.

There exist very simple representable 2-densities that can be considered
belonging to a certain zero point level theory. Indeed, besides HF diagonal
densities
p
2!

|ij; ∅ihij; ∅| +

|∅; ijih∅; ij| +

|i; jihi; j|

tHF
2 =

 

i<j
X
(i,j∈Rβ )

i,j
X
(i∈Rα,j∈Rβ )

i<j
X
(i,j∈Rα)

(107)

24

it is easy to contsruct representable densities in the following manner. Tak-
ing α and β index sets Xα and Xβ containing pα + 1 and pβ + 1 elements,
correspondingly, we can ﬁnd the minimal value of the energy in d - repre-
sentation for the case when the number of spin-orbitals is equal to p+2. As
follows from the results of Sec.3 of this work, Wp,2(Xα, Xβ) = Vp,2(Xα, Xβ)
in this particular case and

tmin
2

(Xα, Xβ) = A−1(p + 2, p, 2)|Ψαβ

1 ihΨαβ
1 |

(108)

where |Ψαβ
1 i is the eigenfunction of the operator obtained by diﬀerentiating
the energy E(d(Xα, Xβ)) in d-representation with respect to the variables
dαβ
i,j;k,l with i, k ∈ Xα and j, l ∈ Xβ (note that in the corresponding energy
expression we should put 2m = p + 2). Density operators of the type of
Eq.(108) are certainly representable and, moreover, belong to the border of
Wp,2 since minimal eigenvalues of both t2(Xα, Xβ) and its image with respect
to A(2m, p, 2) are equal to zero. Of course, such 2-densities correspond to
rather trivial p-electron CI wave functions but of interest is the fact that they
appear on 2-electron level as simplest post HF representable densities . Note
also that in the case under consideration both the CI matrix and the relevant
derivatives matrix are of the same order (pα + 1)(pβ + 1) and, consequently,
CI problem and direct 2-density determination problem are equivalent from
the viewpoint of computational eﬀorts.

6. Conclusion

The outer approximation for the set of all representable density operators
of arbitrary order described in this work seems to be very close to the ex-
act solution of the ensemble representability problem. It can also be a good
starting point for further purely mathematical analysis of the problem to get
ﬁnally its rigorous proof. It may happen that, as in the case of 1-density
operator, modiﬁcation of A(n, p, q) for q > 1 to make it unitary invariant
will lead to the desired result. From practical point of view, however, the
obtained approximate solution may be quite suﬃcient since for pure states
the diﬀerence between the exact energy (corresponding to some many elec-
tron wavefunction) and the energy calculated with approximate 2-density is
expected to be within calculation error.

Algorithms for 2-density direct calculation are still to be developed. In
contrast to the standard approaches where the electronic energy domain turns

25

out to be one of classic analytic manifolds (unit sphere, orthogonal group and
its quotients, etc) that can be easily parametrized by, say, elements of rele-
vant tangent spaces [18] , the convex set Vp,2 is of much more complicated
nature. Energy optimization on Vp,2 reduces to ﬁnding minimal value of very
simple linear function with very severe nonlinear and in general nondiﬀeren-
tiabe restrictions on variables. It may be a very complicated computational
problem but if such optimization scheme is developed, there will be opened
a way to FCI quality calculation of fairly extensive molecular systems.

26

Appendix A.

Let N = {1, 2, . . . , n} be the spin-orbital index set. On the set P(N) of

all subsets of N let us consider the operation

R∆S = (R ∪ S)\(R ∩ S)

(A.1)

where R, S ∈ P(N). This operation endows P(N) with Abelian group struc-
ture with empty set as its unit. Each element of this group is of order 2
(R∆R = ∅). The mapping

where K ⊂ N and

In particular,

is a group homomorphism. Indeed, ∆∅ = ∅ and (∆K)∆(∆L) = ∆K∆L.

ϕ∆ : K → ∆K

∆K = ∆k∈K{1, 2, . . . , k}

∆{k} = {1, 2, . . . , k}

∆{k,l} =

∆N =

(cid:26)

{k + 1, . . . , l} if k<l
{l + 1, . . . , k} if k>l

(cid:26)
{2, 4, . . .} if n is even
{1, 3, . . .} if n is odd

In general case, for K = k1 < k2 < . . . < ks

[ s
2 ]

i=1
[ s
S
2 ]

i=0
S

∆K = 



{k2i−1 + 1, . . . , k2i} if s is even

{k2i + 1, . . . , k2i+1} if s is odd

|K ∩ R| + |K ∩ S| ≡ |K ∩ (R∆S)| (mod 2)

Directly from the deﬁnition of operation ∆ the following relations impor-

tant for phase prefactors evaluation may be obtained

(A.2)

(A.3)

(A.4a)

(A.4b)

(A.4c)

(A.5)

(A.6)

(A.7)

|K ∩ ∆K| = [

|K| + 1
2

]

27

Appendix B.

Let us reduce the problem of operator A(n, p, q) inversion to combinatorial
equations. The matrix elements of the operator A(n, p, q) with respect to the
operator basis (eIJ
K ) are given by Eq.(43). Since this matrix is block-diagonal,
and all its blocks are similar in their structure, we can conﬁne ourselves to
the block with I = J = ∅.

Let us consider the system of linear equations

(q)

XK ′⊂N

A∅∅

KK ′(n, p, q)XK ′K ′′(n, p, q) = δ|K∩K ′′|,q

(B.1)

for determining the inverse matrix (block). Simple combinatorial arguments
together with the additional assumption that XK ′K ′′ = f (n, p, q; |K ′ ∩ K ′′|)
(that is XK ′K ′′ depends not on subsets K ′, K ′′ but only on the number of
elements in their intersection) allow us to rewrite the system (B.1) as the
following system of combinatorial equations

(−1)r1

r1,r2,t
X

p+r1−q−1
r1
q
r1

(cid:16)

(cid:16)

(cid:17)

q − u
r1 − t! 

q − u
r2 − t! 

u
t ! 

n − 2q + u
q − (r1 + r2 − t)!

(cid:17)

 

f (n, p, q; r2) =

n − p

δu,q

q !
where u = |K ∩K ′′| = 0, 1, . . . , q, r1 = |K ∩K ′| = 0, 1, . . . , q, r2 = |K ′∩K ′′| =
0, 1, . . . , q, and t = |K ∩ K ′ ∩ K ′′| = 0, 1, . . . , u. Thorough analysis of this
system leads to the conclusion that

 

f (n, p, q; r2) = (−1)r2

n−p−q+r2−1
r2

(cid:17)

(cid:16)

p
q

q
r2

(cid:16)

(cid:17)(cid:16)

(cid:17)

and, as a result, the operator A(n, p, q) is invertible and the matrix elements
of the inverse matrix are

(A−1)IJ

KK ′(n, p, q) = (−1)αIJ +|K∩K ′|

n−p
q
(cid:16)
n−p−s
q−s

(cid:17)

p
q

n−p−q+|K∩K ′|−1
|K∩K ′|
q−s
|K∩K ′|

(cid:17)

(cid:16)

(B.4)

(cid:16)
where |I| = |J| = s, I ∩ J = ∅, K, K ′ ⊂ N\(I ∪ J), |K| = |K ′| = q − s. The
last equation implies, in particular, that

(cid:17)(cid:16)

(cid:17)

(cid:17)

(cid:16)

A−1(n, p, q) = A(n, n − p, q)

(B.5)

(B.2)

(B.3)

28

Appendix C.

Lemma.

A(n, p, q)Wp,q ⊂ Eq
Proof. It is suﬃcient to show that A(n, p, q) q!
Ψ ∈ Fp. Expanding Ψ over p-electron determinant basis set

(C.1)
p!cp−q|ΨihΨ| ∈ Eq for arbitrary

(p)

Ψ =

CR|Ri

XR⊂N
and turning to the operator basis (eIJ
L ) in Fp ⊗ F ∗

p we obtain

q!
p!

cp−q|ΨihΨ| =

q

(s)

(p−s)

s=0
X

XI,J

XL⊂N \(I∪J)

(−1)|(I∪J)∩∆L|CI∪LC ∗

J∪L (cid:16)

wIJ

Pq−s(L)

(cid:17)

p−s
q−s
p
q

(C.2)
where symmetric combinations wIJ
Pq−s(L) of q-electron basis operators are
given by Eq.(36). Simple set-theoretical and combinatirial manipulations
lead to the equality

(cid:17)

(cid:16)

A(n, p, q)wIJ

Pq−s(L) = (−1)αIJ

eIJ
K

(C.3)

p
q

(cid:16)
p−s
q−s

(cid:17)
n−p
q

(q−s)

XK⊂N \(I∪J∪L)

(cid:16)
Turning back to q-electron determinant generators and carefully handling
the phase prefactors arising, we arrive at

(cid:17)(cid:16)

(cid:17)

A(n, p, q)

cp−q|ΨihΨ| =

(−1)|R∩∆K |CR|N\(R ∪ K)i]×

q!
p!

(p)

[
XS⊂N \K

(p)

(n−p−q)
[
XR⊂N \K

XK⊂N

1
n−p
q

(cid:16)

(cid:17)

(n−p−q)

XK⊂N

1
n−p
q

(cid:16)

(cid:17)

(−1)|S∩∆K |C ∗

ShN\(S ∪ K)|] =

|ΦKihΦK|

(C.4)

The operator on the right-hand side of this equation is obviously positive
deﬁnite. To complete the proof, we should check the normalization property
that can be easily established by direct calculation.

29

Appendix D.

Let us show how by careful choice of the phase prefactors in Eq.(43) it is

possible to ensure the unitary invariance of the convex set Vp,1. We have

A(n, p, 1)e∅∅

k = (−1)α∅∅

1

k′ − pe∅∅
e∅∅
k

(cid:21)

n − p (cid:20)Xk′
p
n − p

eij
∅

A(n, p, 1)eij

∅ = (−1)αij

(D.1)

(D.2)

For arbitrary unitary operator u ∈ Un(F1)

A(n, p, 1)u ⊗ u†e∅∅

k = (−1)α∅∅

k1(1 − puk1ku∗
e∅∅

k1k)+

+

p
n − p

k1,k2
X
(k16=k2)

(−1)αk1k2 ek1k2

∅

uk1ku∗

k2k

(D.3)

u ⊗ u†A(n, p, 1)e∅∅

k = (−1)α∅∅

k1(1 − puk1ku∗
e∅∅

k1k)−

−(−1)α∅∅

p
n − p

uk1ku∗

k2k

(D.4)

1
n − p

Xk1

1
n − p

k1,k2
X
(k16=k2)

Xk1
ek1k2
∅

p
n − p

A(n, p, 1)u ⊗ u†eij

∅ = −(−1)α∅∅

k1uk1iu∗
e∅∅

k1j+

(−1)αk1k2 ek1k2

∅

Xk1
uk1iu∗
k2j

+

p
n − p

k1,k2
X
(k16=k2)

u ⊗ u†A(n, p, 1)eij

∅ = (−1)αij

k1uk1iu∗
e∅∅

k1j+

p
n − p

Xk1
uk1iu∗
k2j

ek1k2
∅

+(−1)αij

p
n − p

k1,k2
X
(k16=k2)

(D.5)

(D.6)

From these equalities it is readily follows that to ensure the unitary invariance
of A(n, p, 1) it is suﬃcient to require that either

α∅∅ ≡ 0(mod 2) ⇒ αij ≡ 1(mod 2)

(D.7a)

30

or

α∅∅ ≡ 1(mod 2) ⇒ αij ≡ 0(mod 2)

(D.7b)

for every i, j = 1, . . . , n (i 6= j). Our choice α∅∅ = 0 and αij = |{i, j} ∩ ∆{i,j}|
for every i 6= j corresponds to the implication (D.7a).

Bibliography

[1] Encyclopedia of Computational Chemistry, Paul v. R. Schleyer, Ed.,

John Wiley & Sons, New York, 1998.

[2] R.G.Parr and W. Yang, Density-Functional Theory of Atoms and

Molecules, Oxford Science, Oxford, 1989.

[3] P. Hohenberg and W.Kohn, Phys. Rev. B 136, 864 (1964).

[4] A. J. Coleman, Rev. Mod. Phys. 35, 668 (1963).

[5] A.J.Coleman,

in Reduced Density Matrices With Applications to
Physical and Chemical Systems, A.J.Coleman and R. M. Erdahl,
Eds.(Queen’s Uinv., Kingston, Ontario, 1968), No 11,p.2.

[6] H. W. Kuhn, Proc. Symp. Appl. Math. 10,141 (1960).

[7] H.W.Kummer, J. Math. Phys. 8, 2063 (1967).

[8] R. M. Erdahl, J. Math. Phys. 13, 1608 (1972).

[9] M.M.Mestechkin, Density Matrix Method in Molecular Theory

(Naukova Dumka, Kiev, 1977).

[10] J. E. Harriman, Phys.Rev. A 17, 1249 (1978); 17, 1257 (1978).

[11] D. A. Mazziotti, Int.J. Quantum Chem. 70, 557 (1998).

[12] A. I. Panin, Int. J. Quantum Chem. XXVIII, 861 (1985).

[13] N. C. Handy, Chem. Phys. Lett. 74, 280 (1980).

31

[14] M.W.Schmidt, K.K.Baldridge, J.A.Boatz, S.T.Elbert, M.S.Gordon,
J.H.Jensen, S.Koseki, N.Matsunaga, K.A.Nguyen, S.J.Su, T.L.Windus,
M.Dupuis, J.A.Montgomery J.Comput.Chem. 14, 1347-1363 (1993).

[15] R. A. Kendal, T. H. Dunning, Jr., and R. J. Harrison, J. Chem. Phys.

[16] R. Ditchﬁeld, W.J. Hehre, and J. A. Pople, J. Chem. Phys. 54, 724

[17] W. J. Hehre, R. Ditchﬁeld, and J. A. Pople, J. chem. Phys.

[18] A. I. Panin, Yu. G. Khait, and N. N. Gorinchoy, Int. J. Quantum Chem.

96, 6796 (1992).

(1971).

56,2657(1972).

XXX, 509 (1986).

32

Table 1: Simple numerical tests for the representability conditions:atoms

Atomic Number Total energy The set E2 : The set A−1(2m, p, 2)E2 : Absolute error
in energy (a.u.)
species
< 10−15
Li(2S)
4 · 10−12
Be(1S)
7 · 10−12
B(2A)
< 10−15
C(3P )
< 10−15
C(1D)
< 10−15
N(4S)
< 10−15
O(3P )
< 10−15
O(1D)

|ε(d2(Ψ)) − 1|
< 2 · 10−8
7 · 10−8
4 · 10−8
< 10−15
6 · 10−15
1 · 10−15
< 10−15
3 · 10−15

|ε(t2(Ψ)) − 1|
< 10−15
4 · 10−13
4 · 10−13
< 10−15
< 10−15
< 10−15
< 10−15
< 10−15

(a.u.)
-7.433465
-14.618569
-24.591900
-37.761693
-37.707142
-54.480030
-74.844711
-74.765527

of dets
1575
11025
47775
5096
8281
14014
3718
6084

33

Table 2: Simple numerical tests for the representability conditions:small
molecules and ions

Molecular
species
LiH(1Σ+)
CH2(3B2)
CH2(1A1)
NH2(2B2)
NH3(1A1)
H2O(1A1)
H2O(3B2)
H2O(1B2)
H2O+(2A1)
H2O+(2B2)

Number Total energy The set E2 : The set A−1(2m, p, 2)E2 : Absolute error
in energy (a.u.)
of dets
4·10−14
36100
6 · 10−14
32670
1 · 10−13
48400
2 · 10−14
9075
3 · 10−13
81796
3 · 10−13
27225
4 · 10−13
18150
4 · 10−13
27225
1 · 10−13
9075
1 · 10−13
9075

|ε(d2(Ψ)) − 1|
7 · 10−6
3 · 10−15
5 · 10−15
< 10−15
1 · 10−14
8 · 10−15
1 · 10−14
1 · 10−14
2 · 10−15
2 · 10−15

|ε(t2(Ψ)) − 1|
6 · 10−15
4 · 10−8
2 · 10−7
6 · 10−9
4 · 10−8
4 · 10−8
1 · 10−8
3 · 10−7
6 · 10−10
5 · 10−11

(a.u.)
-8.016132
-38.979862
-38.922201
-55.478526
-56.250080
-76.077354
-75.796065
-75.765581
-75.634415
-75.560706

34

