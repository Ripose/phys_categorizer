1
0
0
2
 
g
u
A
 
6
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
7
0
0
8
0
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Pure Representability Problem and New Models of
the Electronic Fock Space

A. I. Panin

Chemistry Department, St.-Petersburg State University,
University prospect 2, St.-Petersburg 198504, Russia
e-mail: andrej@AP2707.spb.edu

ABSTRACT: New models of the Fock space sector corresponding to some
ﬁxed number of electrons are introduced. These models originate from the rep-
resentability theory and their practical implementation may lead to essential re-
duction of dimensions of intermediate CI spaces. A certain zero-order theory that
gives wavefunctions approximately equivalent to ones obtained by accounting all
excitations from the Hartree-Fock reference state up to the q-th order is proposed.
Simple numerical examples are given to illustrate our approach.

Key words: representability problem; density operators; CI method;
electron correlation.

1.Introduction

In present work new realizations of p-electron sector of the Fock space
are proposed and their simplest properties are studied. Notations and ter-
minilogy of this article are new for Quantum Chemistry and require therefore
few preliminary comments. The basic idea of our approach is widespread in
modern mathematics: to assemble information about an object as a whole
using available local information. This idea was properly formalized and
systematically used by Jean Leray who introduced his famous sheaves over
topological spaces and employed them in complex analysis (see, e.g., [1]).
Since this branch of mathematics is not used in Quantum Chemistry , at
least at present, we found it possible to borrow existing mathematical terms
“sheaf” and “germ” ﬁlling them with quite diﬀerent meaning. Namely, we in-
troduce a family of q-electron functions (germs) and call such family “sheaf”
if the germs constituting this sheaf are subject to certain “gluing” conditions.
Then it is shown how sheaves thus deﬁned can be used to restore unique p-
electron wavefunction. The whole theory was motivated by the theorem from
the pure representability theory that was proved in [2]. To make presentation
of our approach more transparent and logical, in the second section necessary
basic deﬁnitions and results from the representability theory are formulated.

1

Our approach is essentially ﬁnite-dimensional and set-theoretical manipula-
tions and technique of enumerative combinatorics are extensively used. For
these reasons we found it possible to change notations that seems to be con-
sidered as traditional in literature on the representability problem. Namely,
capital letters are normally used to denote subsets of the spin-orbital index
set N and/or the orbital index set M. Number of elements (indices) in index
|N| = n, |M| = m, etc.
sets is usually denoted by lower case letters, e.g.
With such notations it seems consistent to use lower case letters for the num-
ber of electrons and for the current density matrix order that are just the
numbers of elements in the relevant spin-orbital index sets. Throughout this
article n is the number of molecular spin orbitals (MSO), m is the number of
molecular orbitals (MO), p stands for the number of electrons, and q is the
density matrix order.

In the third section the formal theory of (p, q)-sheaves is presented.
In the fourth section construction of correlated basis functions in conﬁg-

uration interaction (CI) theory is discussed.

In the ﬁfth section it is demonstrated how the abstract mathematical
theory of (p, q)-sheaves may be used for replacing large-scale CI calculations
by series of CI calculations in relatively small dimensions.

2

2.Basic Deﬁnitions.

Let Fn,1 be one-electron Fock space spanned by an orthonormal set of n

molecular spin-orbitals . Electronic Fock space is deﬁned as

Fn =

Fn,p

n

p=0
M

p

Fn,p =

Fn,1

Fn,0 = C

^

where

where

and

will be used.

and C is the ﬁeld of complex numbers.

“Determinant” basis vectors of the Fock space will be labelled by subsets
of the spin-orbital index set N: for any R ⊂ N the corresponding basis de-
terminant will be denoted by |Ri. Note that basis determinants are labelled
by subsets and all sign conventions connected with their actual representa-
tion as the Grassman product of ordered spin-orbitals are included in the
deﬁnition of the creation-annihilation operators:

may be considered as a possible generalization of the Kronecker δ symbol,

ǫ = |{1, 2, . . . , i − 1} ∩ R|

is the sign counter.
Dirac’s ket-bra realization of the operator space over the electronic Fock

space (EndC(Fn, Fn) ∼ Fn ⊗ F ∗

n) equipped with the trace inner product

a†
i |Ri = (1 − δi,R)(−1)ǫ|R ∪ ii
ai|Ri = δi,R(−1)ǫ|R\ii

δi,R =

1,
0,

(cid:26)

if i ∈ R
if i /∈ R

(z|t) = T r(z†t)

3

(1)

(2)

(3)

(4a)

(4b)

(5)

(6)

(7)

The contraction operator over Fn ⊗ F ∗

n is deﬁned as

Its restriction to the p-electron sector of the operator space is identical
(up to the nonessential combinatorial prefactor) to the commonly used con-
traction operator [3, 4, 6, 7].

Let tp ∈ Fn,p ⊗ F ∗

n,p be some p-electron operator. It can be expanded via

basis “determinant generators” as

c =

ai ⊗ a†
i

n

Xi=1

tp =

tRS|RihS|

(p)

XR,S

(8)

(9)

where the upper summation index (p) indicates that the sum is taken
over all p-element subsets of the spin-orbital index set N. It can be shown
[2, 8] that

ck(tp) = k!

tRS

(−1)|(R∆S)∩∆K ||R\KihS\K|

(10)

(p)

(k)

XR,S

XK⊂R∩S

The set-theoretical operation ∆K was introduced in [8] and its main prop-
erties were investigated in [2] but due to its importance for the uniform treat-
ment of the sign prefactors arising in the expressions of the type of Eq.(10)
we repeat here necessary deﬁnitions.

For two arbitrary index sets R and S their symmetric diﬀerence is R∆S =
(R∪S)\(R∩S). This binary operation on the set of all subsets of some given
set is commutative and associative with the empty set as its unit. For any
subset K = {k1, k2, . . . , kl} ⊂ N we put

∆K = {1, 2, . . . , k1}∆{1, 2, . . . , k2}∆ . . . ∆{1, 2, . . . , kl}.

(11)

For example, if K = {2, 4, 5} in N = {1, 2, 3, 4, 5, . . .} then

∆K = {1, 2}∆{1, 2, 3, 4}∆{1, 2, 3, 4, 5} = {3, 4}∆{1, 2, 3, 4, 5} = {1, 2, 5}

The electronic Hamiltonian associated with some chosen spin-orbital basis

set in one-electron Fock space is of the form

H =

hi|h|jia†

i aj +

|klia†

i a†

jalak

(12)

i,j
X

hij|

1
r12

Xi,j,k,l

1
2

4

The energy functional on the Fock space is deﬁned as

E(t) = T r(Ht)

(13)

and is a linear mapping from Fn ⊗ F ∗
n to the ﬁeld of complex numbers.
Using speciﬁc form of the electronic Hamiltonian, it is possible to contract
the energy domain and redeﬁne the energy in terms of q-electron operators
(q ≥ 2). Introducing reduced Hamiltonian that acts on the q-electron sector
of the Fock space

Hp→q =

hi|h|jia†

i aj +

|klia†

i a†

jalak

(14)

q − 1
p − 1

i,j
X

1
2

Xi,j,k,l

hij|

1
r12

we can recast the energy expression (13) in the form

E(tp) = (cid:16)

T r

Hp→q
"

q!
p!

cp−q(tp)

#

p
2
(cid:17)
q
2
(cid:17)

(cid:16)

(15)

where tp is some p-electron operator. On the right hand side of this equation
q-electron image (2 ≤ q ≤ min(p, n−p)) of tp with respect to the contraction
appears.

Of actual interest in Quantum Chemistry are the so-called pure p-electron
states that are associated with p-electron wavefunctions. The corresponding
pure representability problem was formulated in the very ﬁrst articles of
Coleman [3, 4, 6, 7]:

(PR) To ﬁnd the necessary and suﬃcient conditions that should be im-
posed on q-electron operator tq to guarantee that there exists at least one
p-electron wave function Ψ such that q!

p!cp−q|ΨihΨ| = tq.

From the very beginning it was understood that the structure of the set
of all pure representable q-electron operators is very complicated and that
its constructive description that could be of any practical value hardly exists
at all. The well-known theorem of the Convex Sets Theory states that a
real-valued linear function deﬁned on some compact convex set necessarily
reaches its minimal value at one of the extreme points of this function domain.
Therefore, if the set of all pure representable q-electron operators is replaced
by its convex hull, the set of certainly more simple structure will be obtained
and one can guarantee that the direct search of energy minimal value on this
set will lead to the optimal pure state. This was also employed by Coleman
who formulated his famous ensemble representability problem:

5

(ER) To ﬁnd the necessary and suﬃcient conditions that should be im-
posed on q-electron operator tq to guarantee that there exists ensemble of
p-electron states Ψi such that q!

λi|ΨiihΨi| = tq.

p!cp−q

Here

λi = 1 and λi ≥ 0.

i
P

i
P

It is very easy to ﬁnd three very simple conditions that should necessarily

be satisﬁed by any representable q-electron operator:

(i) Nonnegativeness;
(ii) Hermiteancy;
(iii) Fixed trace value (usually T r(tq) = 1).
The set of all q-electron operators satisfying these three conditions will

be denoted by En,q. Operators from En,q are called density operators.

In his pioneer works Coleman [3, 4, 6, 7] found the solution of the ensemble
representability problem for the case q = 1 and formulated two very strong
necessary conditions for the case q = 2.

In our previous work [2] we generalized part of Coleman’s results to treat
the case of density operators of arbitrary order and found the following de-
scription for the set Vn,p,q giving an exterior approximation of the set of all
ensemble representable density operators of order q:

Vn,p,q = A−1(n, p, q)En,q ∩ En,q

(16)

where the automorphism A(n, p, q) is determined by its matrix representation
as

A(n, p, q)eIJ

K = (−1)αIJ

p
q

(q−s)

(cid:16)
p−s
q−s

(cid:17)
n−p
q

(cid:16)

(cid:17)(cid:16)

(cid:17)

XK ′⊂N \(I∪J)

(−1)|K∩K ′|

p+|K∩K ′|−q−1
|K∩K ′|
q−s
|K∩K ′|

(cid:16)

eIJ
K ′

(cid:17)

(cid:16)

(cid:17)

(17)

with respect to specially selected operator basis

L = (−1)|(I∪J)∩∆L||I ∪ LihJ ∪ L|
eIJ

(18)

Here I ∩ J = ∅, s = |I| = |J|, and αIJ = |(I ∪ J) ∩ ∆N \(I∪J)|. In the same
work very simple connection between the operator A(n, p, q) and its inverse
was found:

Let us apply the operator A(n, p, q) q!

A−1(n, p, q) = A(n, n − p, q)

(19)
p!cp−q to some pure state |ΨihΨ| where

Ψ =

CR|Ri

(20)

(p)

XR⊂N

6

Rather complicated manipulations (see Appendix D of [2]) lead to

A(n, p, q)

cp−q|ΨihΨ| =

dq(Z)

(21)

where

and

(p+q)

XZ⊂N

1
n−p
q

(cid:16)

(cid:17)

dq(Z) = |ψZihψZ|

q!
p!

(q)

XS⊂Z

|ψZi =

(−1)|(Z\S)∩∆Z |CZ\S|Si

(22)

(23)

Let us introduce the set

Bn,p,q = {(Z, S) ⊂ N × N : |Z| = p + q&|S| = q&S ⊂ Z}

(24)

and the equivalence relation on this set

(Z, S) ∼ (Z ′, S′) ⇔ Z\S = Z ′\S′

(25)

The set of all equivalence classes Bn,p,q contains exactly

elements and in

each equivalence class (Z, S) there are

elements.

n−p
q

Eqs.(21)-(23) together with the deﬁnition (24) make it possible to formu-
(cid:16)
late the following necessary and suﬃcient conditions of pure representability.
Theorem .
q-electron operator tq is representable by pure p-electron state
if and only if its image dq with respect to A(n, p, q) satisﬁes the following
conditions:

(cid:17)

n
p

(cid:16)

(cid:17)

(i) There exists expansion

dq =

dq(Z)

1
n−p
q

(p+q)

XZ⊂N

(26)

(cid:17)
such that for each Z ⊂ N, dq(Z) is either the null operator or corresponds
to (unnormalized) pure q-electron state |ψZi;

(cid:16)

(ii) The mapping

(Z, S) → (−1)|(Z\S)∩∆Z |hS|ψZi

(27)

is constant on the equivalence classes (Z, S).

7

Unfortunately, condition (i) of the above Theorem is depressingly non-
constructive. Only for the case p + q = n conditions (i) and (ii) are trivial
and the following corollary of the main theorem may be formulated.

Corollary 1. For p + q = n, q-electron operator tq is representable by
pure p-electron state if and only if its image dq with respect to A(n, p, q)
corresponds to pure q-electron state.

The next corollary shows how to construct p-electron wavefunction from

q-electron ones.

Corollary 2 If the conditions of Theorem are fullﬁlled then (up to nor-

malization) the required pure state may be presented as

|Ψi =

(−1)|(Z\S)∩∆Z |hS|ψZi|Z\Si

(28)

X(Z,S)

where the sum runs over equivalence classes of the set Bn,p,q modulo the
equivalence relation (25).

The above Theorem was ﬁrst formulated and proved in our previous arti-
cle [2]. Its Corollary 1 has analogue in the ensemble representability theory
where the constructive description of the set of all representable density op-
erators of order q for the case n = p + q was well-known for years [5].

At ﬁrst glance the above Theorem is hardly of any practical value since
in general case we do not have even the slightest idea how to expand den-
sity operator dq.
In the next section it will be shown that it is a wrong
impression and that this Theorem opens a completely new direction both in
mathematical and computational chemistry.

8

3. Representation of Many Electron Wave Function As a
Sheaf of q-Electron Germs.

For any (p + q)-element subset Z of the spin-orbital index set N we put

Fn,q(Z) =

C|Si

(29)

(q)

MS⊂Z

Deﬁnition. Family {ψZ}Z⊂N of q-electron functions, ψZ ∈ Fn,q(Z), is called
a sheaf of q-electron germs of p-electron wavefunction, or just a (p, q)-sheaf,
if the mapping

(Z, S) → (−1)|(Z\S)∩∆Z |hS|ψZi, |Z| = p + q, |S| = q, S ⊂ Z

(30)

is constant on the equivalence classes of the set Bn,p,q modulo the equivalence
relation (25).

The set of all (p, q)-sheaves will be denoted as Sn,p,q.
The Theorem formulated in the preceding section and its Corollary 2
lead to the conclusion that there exists one-to-one correspondence between
p-electron wavefunctions 1 and (p, q)-sheaves for each ﬁxed q.
Indeed, ar-
bitrary wavefunction Ψ represented by its Full CI (FCI) expansion (20) is
corresponded with (p, q)-sheaf

sn,p,q : Ψ → {ψZ}Z⊂N

(31)

where q-electron wavefunctions ψZ are given by Eq.(23). On the other hand,
due to the conditions of gluing (30) each (p, q)-sheaf uniquely determines p-
electron wavefunction in accordance to Eq.(28). The mapping sn,p,q performs
disassembling of p-electron wavefunction into the family of q-electron ones
whereas its inverse assembles p-electron function from its q-electron germs.
Disassembling mapping (31) may be used to transfer all relevant struc-
tures from the Fock space Fn,p to the set Sn,p,q. The most important linear
structure is transfered as

sn,p,q(

ciΨi) =

ciΨi)Z

=

ci{ψi

Z}Z⊂N

(32)

i
X

(

(

i
X

)Z⊂N

i
X

1By an abuse of terminology arbitrary vector of p-electron sector of the Fock space is

called wave function even if it is not normalized.

9

whereas the inner product (Euclidean structure) is deﬁned as

h{ψZ}Z⊂N |{φZ}Z⊂N i =

hψZ|φZi

(33)

(p+q)

XZ⊂N

1
n−p
q

(cid:16)

(cid:17)

To avoid cumbersome notations, we agree to omit, when possible, subscript
Z ⊂ N in writing elements from Sn,p,q.

With the aid of the disassembling mapping (31) it is possible for each
ﬁxed q to identify the Fock space Fn,p with the space of all (p, q)-sheaves
Sn,p,q considering the later just as an isomorphic model of the FCI space.

The mapping

πn,p,q(Z) : {ψZ ′}Z ′⊂N → ψZ

(34)

is obviously linear and performs a projection of the vector space Sn,p,q on
the vector space Fn,q(Z). Among its sections (right inverses) there exists in
a certain sense canonical one that is deﬁned as follows. To each q-electron
wavefunction

ψZ =

CS|Si =

(−1)|R∩∆Z | ¯CR|Z\Ri

(q)

XS⊂Z

(p)

XR⊂Z

where R = Z\S and

it is possible to put into correspondence the unique p-electron wavefunction

¯CR = (−1)|R∩∆Z |CS

(p)

ΨZ =

¯CR|Ri

XR⊂Z
with its subsequent disassembling. The resulting section of the projection
(34) will be denoted by jn,p,q(Z) and is a linear injective mapping satisfying
the standard relation

πn,p,q(Z) ◦ jn,p,q(Z) = idFn,q(Z)

(38)

where idFn,q(Z) is the identity operator over Fn,q(Z). As follows from this
equation, the image of a certain q-electron wavefunction ψZ with respect to
jn,p,q(Z), that will be denoted as {ψZZ ′}Z ′⊂N , posesses the property :

(35)

(36)

(37)

(39)

ψZ = ψZZ

10

or, in the other words, the initial q-electron wavefunction ψZ is necessarily a
germ of the (p, q)-sheaf {ψZZ ′}Z ′⊂N . This property motivates the following
deﬁnition.

Deﬁnition. (p, q)-sheaf {ψZ}Z⊂N is called simple if it is generated by
one of its germ, that is, if there exists (p + q)- element subset Z ′ ⊂ N such
that

{ψZ}Z⊂N = jn,p,q(Z ′)(ψZ ′)
Proposition 1. (p, q)-sheaf generated by any its nonzero germ corresponds
to single determinant wavefunction.

(40)

Proof. If sheaf {ψZ}Z⊂N is generated by any its germ then the wave-
function (37) does not depend on concrete subset Z. If we suppose that it
involves diﬀerent determinants |Ri and |R′i in its expansion, then it is pos-
sible to ﬁnd (p + q)-element subsets Z, Z ′ ⊂ N that separate R and R′, that
is R ⊂ Z, R′ ⊂ Z ′,but R 6⊂ Z ′ and R′
6⊂ Z. In this case, however, ΨZ can
not be equal to ΨZ ′(cid:4)

Deﬁnition. (p, q)-sheaves generated by any its nonzero germ are called

determinant sheaves.

It is clear that determinant sheaves constitute an orthonormal basis of
the vector space Sn,p,q. Selection of this basis will lead to the approach
completely equivalent to the FCI one in the basis of p-electron determinants.
All possible advantages and disadvantages of our model for FCI space may
appear in this case either on the matrix element evaluation level or on the
level of algorithms for solving partial eigenvalue problem. Concrete formulas
for matrix elements ready for practical implementation of the conventional
CI method are collected in Appendix A. Here more general approach that is
not based on the determinant sheaves is discussed.

q-electron density operator dq of the form of Eq.(26) is associated with
each (p, q)-sheaf {ψZ}Z⊂N . Recalling that dq originates from some q-electron
density operator tq = A−1(n, p, q)dq and that the operator A(n, p, q) is Her-
mitean in trace inner product, we can recast general energy expression (15)
in the form

E({ψZ}) = T r

A−1(n, p, q)Hp→q

dq

=

h(cid:16)

i
hψZ|A−1(n, p, q)Hp→q|ψZi

(cid:17)

(41)

(p+q)

XZ⊂N

1
n−p
q

(cid:16)

(cid:17)

Note that in this formula the initial deﬁnition of the reduced Hamiltonian is
slightly modiﬁed and the current operator Hp→q diﬀers from that in Eq.(14)

11

by the combinatorial prefactor

(p
2)
(q
2)

.

In exactly the same manner general expression for the matrix elements

of the Hamiltonian between two (p, q)-sheaves may be written

(p+q)

1
n−p
q

H({ψZ}, {φZ}) =

hψZ|A−1(n, p, q)Hp→q|φZi

(42)

XZ⊂N
This completely general formula expresses arbitrary matrix element of p-
electron Hamiltonian via matrix elements of the transformed q-electron re-
duced Hamiltonian. It is necessary to emphasize that Eq.(42) does not couple
q-electron spaces Fn,q(Z) with diﬀerent Z.

(cid:16)

(cid:17)

Of course, for their practical use it is necessary to rewrite Eqs.(41)-(42)
in terms of molecular orbitals taking into account simplest spin symmetry
restrictions. Relevant formulas are collected in Appendix A.

Let us consider some arbitrary (p, q)-sheaf {ψZ}Z⊂N . Each its nonzero
germ ψZj generates simple (p, q)-sheaf {ψZj Z}Z⊂N = jn,p,q(Zj)(ψZj ). The set
of all such simple sheaves will be denoted as Jn,p,q({ψZ}Z⊂N ) or Jn,p,q(Ψ)
where Ψ is the wave function corresponding to the initial (p, q)-sheaf. The
subspace of the vector space Sn,p,q generated by the set Jn,p,q(Ψ) will be called
the q-subspace associated with the wave function Ψ (or the corresponding
(p, q)-sheaf) and will be denoted as Wn,p,q(Ψ):

Wn,p,q(Ψ) =

C{ψZj Z}Z⊂N

(43)

j
X
It is pertinent to note that the sum on the right-hand side of Eq.(43) is not
direct.

The importance of the deﬁnition (43) is due to the following fact.
Proposition 2. {ψZ}Z⊂N ∈ Wn,p,q(Ψ) for any (p, q)-sheaf {ψZ}Z⊂N =

sn,p,q(Ψ).

Proof. Eq.(28) may be recast as

|Ψi =

(−1)|R∩∆Z |hZ\R|ψZi|Ri

(p+q)

(p)

XZ⊂N

XR⊂Z

1
n−p
q

(cid:16)

(cid:17)

From Eqs.(35)-(37) it follows that

(p)

XR⊂Z

sn,p,q 


(−1)|R∩∆Z |hZ\R|ψZi|Ri

= jn,p,q(Z)(ψZ)





12

But jn,p,q(Z)(ψZ) is, by deﬁnition, a simple (p, q)-sheaf generated by ψZ. As
a result, sn,p,q(Ψ) is a linear combination of its simple sheaves and, conse-
quently, belongs to Wn,p,q(Ψ) (cid:4)

Thus, to each p-electron wavefunction it is possible to put into correspon-

dence the family of subspaces

Ψ → (Wn,p,1(Ψ), Wn,p,2(Ψ), . . . , Wn,p,qmax(Ψ))

(44)

and the associated integral vector

Ψ → ind(Ψ) = (ind1(Ψ), ind2(Ψ), . . . , indqmax(Ψ))

(45)

where sn,p,q is the disassembling mapping (31), qmax = min(p, n − p), and

indq(Ψ) = dimCWn,p,q(Ψ) = rankCJn,p,q(Ψ)

(46)

Deﬁnition.

indq(Ψ) is called the q-index of the wavefunction Ψ (or the

corresponding (p, q)-sheaf).

At present we do not know if indices (46) can be considered as integral
characteristics of the associated wave function. It is certainly true for the
so-called formal Fock space.

Deﬁnition. Vector space of all formal linear combinations of all subsets

of the index set N with complex coeﬃcients is called formal Fock space.

Formal Fock space is in a certain sense universal model of the electronic
Fock space with orbital speciﬁc erased. In this space vector (45) is the vector
of integral chracteristics of formal p-electron wavefunction Ψ.

On the Fock space additional structure connected with the action of the

p

u induced by one-electron ones appears.
group of unitary transformations
The same wavefunction has, in general, diﬀerent CI coeﬃcients in diﬀerent
MSO bases and, consequently, is corresponded with diﬀerent sheaves. If the
q- subspaces associated with these sheaves can be of diﬀerent dimensions is
the question to be investigated.

V

When q is ﬁxed, then the index (46) may be called just the CI index
of the wave function under consideration. The meaning of this index is the
following: for arbitrary wave function Ψ the length of its expansion in the
subspace Wn,p,q(Ψ) is not greater than indq(Ψ) (for ﬁxed MSO basis set).

Let us consider the group Gn,p,q(Ψ) of automorphisms of the vector space
Wn,p,q(Ψ) leaving invariant the ﬁnite set of simple sheaves Jn,p,q(Ψ). Since
Jn,p,q(Ψ) generates Wn,p,q(Ψ) this group is isomorphic to the subgroup of the

13

symmetric group permuting simple sheaves from Jn,p,q(Ψ), and, consequently,
is ﬁnite. If for a given wave function Ψ there exist non-trivial groups Gn,p,q(Ψ)
is the problem for future study. At present we can state only that for each
q one-dimensional subspace of Wn,p,q(Ψ) spanned by sn,p,q(Ψ) carries trivial
representation of Gn,p,q(Ψ) (see Eq.(28)).

Deﬁnition. (p, q)-sheaf {ψZ} = sn,p,q(Ψ) is called stable if it coincides

with the lowest eigensheaf of the CI matrix in the subspace Wn,p,q(Ψ).

It is easy to see that any sheaf can be transformed to the stable one in

no more than one step.

Deﬁnition. Wavefunction Ψ is called stable if its (p, q)-sheaves sn,p,q(Ψ)

are stable for each 2 ≤ q ≤ min(p, n − p).

All determinant functions and FCI lowest eigenvector are necessarily sta-
In general case with each p-electron wavefunction from Fn,p we can
ble.
associate the unique family of its stable images Ψq from Sn,p,q (q ≥ 2) and
the following inequalities always keep true:hΨ|H|Ψi ≥ hΨq|H|Ψqi.

14

4. Construction of Correlated q-Electron Basis Functions.

It is well-known that the proper selection of many electron basis func-
tions becomes the crucial stage of the CI approach when the FCI limit is
unreachable. The commonly used methods of basis functions construction
employ very robust physical idea of successive generation of k-fold excitations
from some reference state (k = 1, 2, . . .). In the simplest case the Hartree-
Fock (HF) single determinant is used as a reference state. We start our
analysis with the conventional CI approach in the basis of the determinant
(p, q)-sheaves.

Selecting in the subspace Fn,q(Z) the function

ψZ = (−1)|(Z\S)∩∆Z ||Si

and applying the sheaf generation scheme described by Eqs.(35)-(37) lead to
the determinant (p, q)-sheaf

(Z ′, S′) →

(−1)|R∩∆′
n

Z ||Z ′\Ri

Z ′⊃R

o

(47)

where R = Z\S, and it is immediately clear that for any pair (Z ′, S′) ∈ (Z, S)
the same determinant sheaf will be obtained. This result can be reformulated
in the following manner: determinant (p, q)-sheaves are in one-to-one corre-
spondence with the equivalence classes of the set Bn,p,q modulo the equiv-
alence relation (25). Selecting HF determinant as the reference state, it is
easy to construct basis determinant sheaves by applying Eq.(47) succesively
to the“excited pairs” (Z, S) ↔ Z\S = R\I ∪ J. This at ﬁrst glance trivial
scheme can be generalized in a very interesting manner.

Let us try to select q-electron wavefunctions ψZ ∈ Fn,q(Z) with the fol-
lowing property: the corresponding simple sheaf should account as much of
correlation eﬀects as possible. To this end we should turn to Corollary 1 of
our Theorem from the second section. From this corollary it follows that for
ﬁxed Z the electronic energy minimum is reached on the sheaf generated by
the lowest eigenvector of the operator

A−1(p + q, p, q)(PZHp→qPZ)

(48)

where PZ : Fn,q → Fn,q(Z) is the standard projection.

Moving along some equivalence class (Z, S), one can select the lowest
eigenvector ψ(Z,S) of the operator (48) obeying if necessary some additional

15

Z ′⊂N

ψ(Z,S)Z ′

conditions of the type hψ(Z,S)|Si 6= 0. Then all simple (p, q)-sheaves
are to be constructed and the lowest eigenvector of the CI matrix in the vec-
o
tor space generated by these sheaves should be found. The resulting sheaf
should be made stable by applying the routine described in preceding sec-
tion. With such an approach to each equivalence class (Z, S) some vector
accounting part of the correlation eﬀects is put into correspondence. These
(in general, non-orthogonal) vectors are in one-to-one correspondence with
p-electron determinants but the problem of their linear independence is still
to be studied.

n

Applying this scheme to the equivalence class of the HF p-electron de-
terminant leads to a certain zero-order theory corresponding approximately
to the conventional CI method accounting excitations up to the q-th order.
The main diﬀerence between the standard CI approach and our scheme is in
replacing large CI matrix partial diagonalization by a series of partial diago-
nalizations of relatively small orders. Indeed, for class representatives matri-
, where k = 0, 1, . . . , q.
ces of one of the following orders arise:
After ﬁnding optimal vector for each class representative, it is necessary to
(cid:17)
solve partial diagonalization problem of no more that
order to get
equivalence class energy and wavefunction. And the last diagonalization to
stabilize the equivalence class wavefunction is performed in the space of the
minimal possible for a given wavefunction dimension equal to its CI index.
Numerical tests are discussed in detail in the next section. Here simple com-
parison of relevant dimensions is performed. For the ﬁxed value MS of the
total spin projection the number of α electrons pα and β electrons pβ is ﬁxed
and the total number of all excitations up to the q-th order from the HF
reference state in space of m molecular orbitals is equal to

pβ+q−k
q−k

2m−p
q

pα+k
k

(cid:17)(cid:16)

(cid:16)

(cid:16)

(cid:17)

q

l(1,2,...,q) =

Xk=1 Xi=0  

pα
i ! 

m − pα
i

pβ

! 

k − i! 

m − pβ
k − i !

(50)

For the case of 80 electrons correlated in the one-electron space of 200 MOs,
q = 2, and the total spin projection MS = 0 there are l(1,2) = 60816000
excited conﬁgurations. At the same time for each representative of the HF
determinant equivalence class partial eigenvalue problem of order either 1681
or 861 should be handled. To get the wavefunction of the HF equivalence
class it is necessary to ﬁnd the lowest eigenvalue of the matrix of order not
larger than 51040.

To improve the approximation described one can try to account relevant
excitations from the zero-order wavefunction. We believe, however, that it

16

is possible to develop very eﬃcient new algorithms based on our model of
Indeed, for some current (p, q)-sheaf {ψZ}Z⊂N approximate
the CI space.
Newton-Raphson (NR) shift vector can be calculated with its subsequent
disassembling it to give NR sheaf {φZ}Z⊂N . Then in the vector space gener-
ated by simple sheaves {ψZZ ′}Z ′⊂N and {φZZ ′}Z ′⊂N the CI problem should
be solved to to give new stable sheaf, etc. With such an approach both p-
and q-electron functions are actually optimized and it can be expected that
the ﬁnal FCI solution will be obtained by subsequent passing through CI
subspaces of moderate sizes.

17

5. Simple Numerical Examples.

To illustrate our approach, we performed very simple calculations of the
HF equivalence class wavefunctions for two small molecules in STO-6G Gaus-
sian basis set. There are two reasons why such primitive examples were
chosen. Firstly, the whole approach is just at its very beginning and sepa-
rate probably very complicated and time consuming work should be done to
develop eﬃcient computer schemes and create the corresponding computer
code. Secondly, for small molecules it is easy to write down explicitely all
necessary equivalence classes, their energies, etc., to make understanding of
previous sections of this article easier to the reader who has only vague im-
pression about equivalence classes and is not experienced in set-theoretical
manipulations. In all calculations Handy’s split determinant representation
was used [9]. In this representation spin-orbital index set is replaced by a pair
of orbital index sets for α and β spins. Binary codes for index sets identiﬁ-
cation were also employed: e.g., index set {1, 3, 5} as a subset of the orbital
index set M = {1, 2, 3, 4, 5, 6, 7} is represented as a binary code 1010100. All
RHF calculations to generate MO basis set were performed with the aid of
the GAMESS program [10].

From the deﬁnition (24) of the set Bn,p,q and the equivalence relation
(25) it is easy to see that the same (p + q)-element subset Z ⊂ N occurs in
exactly
diﬀerent equivalence classes. At the same time for ﬁxed single
determinant reference state |Ri its equivalence class representatives can be
uniquely labelled by subsets Z ⊃ R, or, in orbital representation, by pairs
(Zα, Zβ) ⊃ (Rα, Rβ) such that |Zα| + |Zβ| = p + q.

p+q
q

(cid:16)

(cid:17)

(cid:17)

(cid:16)

12−4
2

For the LiH ground state (RLiH = 1.595 ˚A) in the basis of 6 MOs the
HF code is |HF i = (110000, 110000) and its equivalence class for q = 2
= 28 elements. These elements (Zα, Zβ) are of three
contains exactly
diﬀerent types: type (1,1) of pairs |Zα| = |Zβ| = 3, type (2,0) of pairs
|Zα| = 4, |Zβ| = 2, and type (0,2) of pairs |Zα| = 2, |Zβ| = 4. For each
representative of the HF equivalence class we selected the lowest eigenstate
of the operator (48) as a germ generating simple (4,2)-sheaf. Of 28 simple
sheaves only 9 proved to be linearly independent (most probably due to high
point symmetry) and the equivalence class energy was calculated to give E =
−7.972047 a.u. The corresponding wavefunction is not stable and after its
disassembling 35 linearly independent simple sheaves were generated to give
ﬁnally stable wavefunction of the CI index 35 with energy E = −7.972323
a.u. Conventional approach leads to CI space of 92 excited determinants and

18

the energy value E = −7.972323 a.u. for the lowest CI vector in this space.
For the water molecule ground state (ROH = 0.957 ˚A, \HOH = 104.3◦)
in the basis of 7 MOs the HF reference code is |HF i = (1111100, 1111100).
Its equivalence class contains
= 6 elements of types (1,1),(2,0),and
(0,2). The corresponding codes and energies are:
Energy
of HF class before
stabilization
(a.u.)

(cid:16)
Energy
of HF class
representative
(a.u.)

Energy
of HF class after
stabilization
(a.u.)

Pair (Zα, Zβ)

14−10
2

(cid:17)

1111110
1111110 )
1111110
1111101 )
1111101
1111110 )

1111101
1111101 )
1111111
1111100 )
1111100
1111111 )

-75.693408

-75.687226

-75.687226

-75.695390

-75.680388

-75.680388

-75.716895

-75.728024

The CI wavefunction involing HF determinant and all single and dou-
ble excitations from this determinant as a reference state (on the whole 141
determinants) corresponds to the energy E = −75.728063 a.u. In our calcu-
lations we selected the lowest 2-electron wavefunctions for each representative
of the HF class by diagonalizing operator (48): for (1,1) type elements the
order of the eigenvalue problem was 36 (four matrices), for (2,0) and (0,2)
type elements we had two matrices of order 21. All six simple (10,2)-sheaves
proved to be linearly independent and after solving 6 × 6 CI problem we
obtained wavefunction (sheaf) of the CI index 45. Final stabilization of this
wavefunction was performed in the CI space of dimension 45.

In Tables 1 - 2 integral characteristics of ground state wave functions of
LiH and H2O molecules obtained by CI method accounting all single and
double excitations from the HF reference state (Ψsd) and by FCI method
are presented. In these tables term ’actual expansion length’ stands for the
numbers of expansion coeﬃcients greater than 10−5 by absolute value.

19

The examples discussed are certainly not very impressing and their only
advantage is in their simplicity. But even on these primitive examples it was
possible to learn what computational diﬃculties may occur in the course of
our approach implementation to treat larger systems. The ﬁrst diﬃculty is
connected with binary codes (index subsets) generation. Standard generation
in the lexical order is known to be slow [11]. Much faster Gray algorithms
[11] should certainly be employed in future implementations. Technique to
determine code number if the binary code is given, and restore code by its
number in the list of codes (without scanning the list) is also required. The
second diﬃculty is the selection of linearly independent simple sheaves and
their orthogonalization. The problem here may be connected with large
amount of required simple sheaves and their numerical orthogonalization.
An attempt should be made to develop some analytic technique for selection
of linearly independent simple sheaves. And at last it is necessary to have
fast routine for the Hamiltonian matrix elements evaluation in the basis of
sheaves obtained by orthogonalization of simple sheaves.

20

6. Conclusion

Our approach to treatment of correlation eﬀects based on new models of
the FCI spaces opens new perspective directions both in mathematical and
computational chemistry. Staying on the zero-level theory (HF equivalence
class) it is possible to improve the quality of the wavefunctions by increasing
the order of density matrices moving from (p, 2)-sheaves to sheaves of higher
order. On the other hand, it is possible to perform calculations in the Fock
space model Sn,p,q with ﬁxed q and try to reach the FCI limit either by turn-
ing to the 1st, 2nd and higher order theories or use from the very beginning
purely algorithmic approach close in its idea to the Davidson diagonaliza-
tion scheme [12]. There are many things to be done in the frameworks of our
approach both in pure theory and in practical implementation of new compu-
tational schemes. Sheaves properties such as their point and spin symmetry,
deﬁnition of excited sheaves, etc., are still to be studied. Of special interest
are (p, 1)-sheaves and their possible connection with the density functional
theory approach. Vector and integral characteristics of formal many electron
wavefunctions obtained in this article are very intriguing as well.

21

Appendix A.

Operator A−1(n, p, q) involved in general expression (42) for the CI ma-
trix elements is deﬁned by its matrix representation with respect to the basis
of q-electron determinant generators (18) and due to the huge dimension of
space where it acts it may be very diﬃcult to perform its direct transforma-
tion to some other, probably more convenient, basis. Therefore, at present
stage of theory, all required matrix elements should ﬁnally be expressed via
matrix elements of Hamiltonian between determinant (p, q)-sheaves. For two
determinant sheaves (45) corresponding to determinant labels R and R′ in
spin-orbital representation we have

1
n−p
q

(p+q)

XZ⊃R∪R′

HRR′ =

(−1)|R∩∆Z |+|R′∩∆Z |hZ\R|A−1(n, p, q)Hp→q|Z\R′i

(cid:17)

(cid:16)

(A.1)
In the majority of cases all molecular calculations are performed in one-
electron bases of molecular orbitals. Turning to MO basis in Eq.(A.1) leads to
more cumbersome expressions but simpliﬁes essentially concrete calculations.
Using Handy’s split representation of spin-orbital index sets [9], it is pos-
sible to replace R by (Rα, Rβ) and Z by (Zα, Zβ) where Rσ and Zσ are taken
from the same orbital index set M, |M| = m for σ = α, β. With ﬁxed projec-
tion MS of the total spin the numbers pα of α and pβ of β electrons are ﬁxed
for each basis determinant and the following simple equalities keep true:

|Zα\Rα| + |Zβ\Rβ| = q

|Zα| + |Zβ| = p + q

Let us start with the analysis of the sign prefactors in Eq.(A.1). To this

end it is convenient to introduce the following notations:

Kσ = R′

σ\(Rσ ∩ R′

σ) = {r1, r2, . . . , rkσ}

K ′

σ = Rσ\(Rσ ∩ R′

σ) = {s1, s2, . . . , skσ}

where |Kσ| = |K ′

σ| = kσ.

Technique for handling sign prefactors developed in our previous article

[2] makes it easy to get the following comparison modulo 2:

(A.2)

(A.3)

(A.4)

(A.5)

|R ∩ ∆Z| + |R′ ∩ ∆Z| ≡

22

≡ |(Rα∆R′

α) ∩ ∆Zα| + |(Rβ∆R′

β) ∩ ∆Zβ | + |(Rα∆R′

α| × mod(|Zβ|, 2) (A.6)

Let us put

Zσ = Rσ ∪ R′

σ ∪ Xσ

where Xσ is a “free” part of the summation index Zσ in Eq.(A.1) and

|Xα| + |Xβ| = q − (kα + kβ)

(A.7)

(A.8)

Now the sign prefactor power can be separated into two parts: Non-active

part that is not involved in summation

ε =

σ "
X

σ| + 1

|Rσ∆R′
2

+

#

σ
X

|(Rσ∆R′

σ |
σ) ∩ ∆Rσ∩R′

(A.9)

and active part

σ
X

a =

|(Rσ∆R′

σ) ∩ ∆Xσ | + |Rα∆R′

α| × mod(|Rβ ∪ R′

β ∪ Xβ|, 2)

(A.10)

Brackets in Eq.(A.9) stand for the entier function extracting integral part of
its argument.

The comparision

|Rσ∆R′

σ| = 2kσ ≡ 0(mod 2)

leads to the following expressions that hardly admit further simpliﬁcation

ε = kα + kβ +

|(Rσ∆R′

σ |
σ) ∩ ∆Rσ∩R′

σ
X
|(Rσ∆R′

σ) ∩ ∆Xσ |

a =

σ
X

(A.11)

(A.12)

Now it is possible to rewrite general expression (A.1) for the CI matrix

elements in terms of orbital index sets:

H(Rα,Rβ),(R′

α,R′

β ) =

(−1)ε
2m−p
q

(cid:16)

(cid:17)

(lα)

lα,lβ
X
(lα+lβ =q−(kα+kβ ))

XXα⊂M \(Rα∪R′
α)

(lβ )

XXβ⊂M \(Rβ ∪R′
β )

(−1)ahKα ∪ Xα, Kβ ∪ Xβ|A−1(2m, p, q)Hp→q|K ′

α ∪ Xα, K ′

β ∪ Xβi

(A.13)

23

Note that for ﬁxed spin projection value both the reduced Hamiltonian Hp→q
and its image A−1(n, p, q)Hp→q are block-diagonal with exactly q + 1 blocks.
Eq.(A.13) can be simpliﬁed for each concrete pair (kα, kβ). In the most
important case q = 2 we have six such pairs:(0,0),(1,0),(0,1), (1,1),(2,0), and
(0,2).

I. (kα, kβ) = (0, 0)
This case corresponds to Rσ = R′

σ and

H(Rα,Rβ),(Rα,Rβ ) =

hij, ∅|A−1(2m, p, 2)Hp→2|ij, ∅i+

1
2m−p
2

(cid:16)

(cid:17)






i<j
X
i,j∈M \Rα

+

h∅, ij|A−1(2m, p, 2)Hp→2|∅, iji+

i<j
X
i,j∈M \Rβ

+

hi, j|A−1(2m, p, 2)Hp→2|i, ji

(A.14)









Xi∈M \Rα Xj∈M \Rβ

II. (kα, kβ) = (1, 0)
In this case Kα = {r1}, K ′

=

(−1)ε
2m−p
2

(cid:16)

(cid:17)


Xi∈M \(Rα∪R′
α)


and

Xi∈M \Rβ

α = {s1}, r1 6= s1, ε = 1 + |{r1, s1} ∩ ∆Rα∩R′

α|,

H(Rα,Rβ),(R′

α,Rβ) =

(−1)ah{r1, i}, ∅|A−1(2m, p, 2)Hp→2|{s1, i}, ∅i+

+

hr1, i|A−1(2m, p, 2)Hp→2|s1, ii

,

(A.15)

a =

0,
1,

(cid:26)

if r1 < i and s1 < i or r1 > i and s1 > i
if r1 < i and s1 > i or r1 > i and s1 < i

(A.16)

III. (kα, kβ) = (0, 1)
In this case Kβ = {r1}, K ′

β = {s1}, r1 6= s1, ε = 1 + |{r1, s1} ∩ ∆Rβ ∩R′

|,

β

H(Rα,Rβ),(Rα,R′

β) =

=

(−1)ε
2m−p
2

(cid:16)

(cid:17)






Xi∈M \(Rβ ∪R′
β )

24

(−1)ah∅, {r1, i}|A−1(2m, p, 2)Hp→2|∅, {s1, i}i+

+

hi, r1|A−1(2m, p, 2)Hp→2|i, s1i

,

(A.17)





Xi∈M \Rα
and a is given by Eq.(A.16)
IV. (kα, kβ) = (1, 1)
We have Kα = {r1}, K ′

(−1)ε
2m−p
2

(−1)ε
2m−p
2

(−1)ε
2m−p
2

(cid:16)

(cid:17)

ε = |{r1, s1} ∩ ∆Rα∩R′

α| + |{r2, s2} ∩ ∆Rβ ∩R′

|, a = 0, and

β

α = {s1}, r1 6= s1, Kβ = {r2}, K ′

β = {s2}, r2 6= s2,

H(Rα,Rβ),(R′

α,R′

β ) =

hr1, r2|A−1(2m, p, 2)Hp→2|s1, s2i

(A.18)

V. (kα, kβ) = (2, 0)
In this case Kα = {r1, r2}, K ′

(cid:16)

(cid:17)

a = 0, and

α = {s1, s2}, ε = |{r1, r2, s1, s2} ∩ ∆Rα∩R′

α|,

H(Rα,Rβ ),(R′

α,Rβ ) =

hr1r2, ∅|A−1(2m, p, 2)Hp→2|s1s2, ∅i

(A.19)

V. (kα, kβ) = (0, 2)
We have Kβ = {r1, r2}, K ′

(cid:16)

(cid:17)

a = 0, and

β = {s1, s2}, ε = |{r1, r2, s1, s2} ∩ ∆Rβ ∩R′

|,

β

H(Rα,Rβ ),(Rα,R′

β ) =

h∅, r1r2|A−1(2m, p, 2)Hp→2|∅, s1s2i

(A.20)

Practicaly all large scale CI calculations are based on the so-called direct
methods [13] and use Davidson-type algorithms for solving partial eigenvalue
In these methods at each Davidson iteration the result of
problem [12].
applying Hamiltonian to the current CI vectors is calculated and explicit
Hamiltonian construction is actually not required. In the frameworks of our
approach it is not diﬃcult to write down general formula for Hamiltonian
(12) action on some trial (p, q)-sheaf {ψZ} (in MSO basis). We have

hR|HΨi =

(−1)|R∩∆Z |hZ\R|A−1(n, p, q)Hp→qψZ

(A.21)

(p+q)

XZ⊃R

1
n−p
q

(cid:16)

(cid:17)

where |Ri is some basis determinant in CI wavefunction expansion and ψZ are
q-germs of Ψ obtained by its disassembling. This formula, after its rewriting
in MO basis set, can certainly be used in existing direct CI algorithms but
we believe that it is possible to develop very eﬃcient new methods based on
our model of the CI space. One of such algorithms is brieﬂy outlined in the
fourth section.

25

Acknowledgment

We gratefully acknowledge the Russian Foundation for Basic Research
(Grant 00-03-32943a) and Ministry of Education of RF (Grant E00-5.0-62)
for ﬁnancial support of the present work. Our special thanks to Dr. V. F.
Bratsev for useful and inspiring discussions.

References

1967).

[1] Bredon G. E., Sheaf Theory (McGraw-Hill Book Company, New York,

[2] Panin A.I., Int. J. Quantum Chem. (accepted for publication); Elec-
tronic version of this article: http://xxx.lanl.gov/physics/9907045.

[3] Coleman A. J., Rev. Mod. Phys. 35, 668 (1963).

[4] Coleman A. J., in Reduced Density Matrices With Applications to
Physical and Chemical Systems, A.J.Coleman and R. M. Erdahl,
Eds.(Queen’s Uinv., Kingston, Ontario, 1968), No 11, p.2.

[5] Erdahl R. M., J. Math. Phys. 13, 1608 (1972).

[6] Coleman A. J., J. Math. Phys. 13, 214 (1972).

[7] Coleman A. J., Reports on Math. Phys. 4, 113 (1973).

[8] Panin A. I., Int. J. Quantum Chem. XXVIII, 861 (1985).

[9] Handy N. C., Chem. Phys. Lett. 74, 280 (1980).

[10] Schmidt M. W., Baldridge K. K., Boatz J. A., Elbert S. T., Gordon
M. S., Jensen J. H., Koseki S., Matsunaga N., Nguyen K. A., Su S.
J., Windus T. L., Dupuis M., Montgomery J. A. J.Comput.Chem. 14,
1347-1363 (1993).

[11] Reingold E. M., Nievergelt J., Deo N., Combinatorial Algorithms
(Prentice-Hall, Inc., Englewood Cliﬀs, New Jersey 07632, 1977).

[12] Davidson E. R., J. Comput. Phys. 17, 87 (1975).

26

[13] Roos B. O. and Siegbahn P.E.M., in Methods of Electronic Structure
Theory, H.F Schaefer III, Ed. (Plenum, New York, 1977), pp.277-318.

27

Table 1: LiH ground state wave functions: Integral characteristics

index expansion

index expansion

q
value

Total
number
of germs
208
482
584
436

Actual

length
25
25
24
10

Total
number
of germs
360
720
752
495

Table 2: H2O ground state wave functions: Integral characteristics

index expansion

index expansion

q
value

Total
number
of germs
128
69
14
1

Actual

length
32
14
7
1

Total
number
of germs
232
91
14
1

ΨF CI
CI

69
69
69
69

ΨF CI
CI

120
61
12
1

Actual

length
57
52
47
15

Actual

length
67
21
7
1

Ψsd
CI

35
35
35
35

Ψsd
CI

49
45
12
1

1
2
3
4

1
2
3
4

28

