Zero-Variance Zero-Bias Principle for Observables in quantum Monte Carlo:

Application to Forces

3
0
0
2
 
t
c
O
 
7
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
5
3
0
0
1
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Roland Assaraf and Michel Caﬀarel

CNRS-Laboratoire de Chimie Th´eorique Tour 22-23, Case 137

Universit´e Pierre et Marie Curie, 4 place Jussieu 75252 Paris Cedex 05 France

e-mail: ra@lct.jussieu.fr,mc@lct.jussieu.fr

Abstract

A simple and stable method for computing accurate expectation values of observable

with Variational Monte Carlo (VMC) or Diﬀusion Monte Carlo (DMC) algorithms is pre-

sented. The basic idea consists in replacing the usual “bare” estimator associated with

the observable by an improved or “renormalized” estimator. Using this estimator more

accurate averages are obtained: Not only the statistical ﬂuctuations are reduced but also

the systematic error (bias) associated with the approximate VMC or (ﬁxed-node) DMC

probability densities. It is shown that improved estimators obey a Zero-Variance Zero-

Bias (ZVZB) property similar to the usual Zero-Variance Zero-Bias property of the energy

with the local energy as improved estimator. Using this property improved estimators can

be optimized and the resulting accuracy on expectation values may reach the remarkable

accuracy obtained for total energies. As an important example, we present the application

of our formalism to the computation of forces in molecular systems. Calculations of the

entire force curve of the H2,LiH, and Li2 molecules are presented. Spectroscopic constants

Re (equilibrium distance) and ωe (harmonic frequency) are also computed. The equilib-

rium distances are obtained with a relative error smaller than 1%, while the harmonic

1

frequencies are computed with an error of about 10%.

PACS numbers: 71.15.-m, 31.10.+z, 31.25.Nj, 02.70.Lq

2

I. INTRODUCTION

Over the recent years quantum Monte Carlo (QMC) methods have become more and

more successful in computing ground-state total energies of molecular systems. For sys-

tems with large number of electrons the accuracy obtained by QMC is very good. As

illustrated by a number of recent calculations, [1–14] the quality of the results is com-

parable and, in most cases, superior to that obtained with more traditional techniques

(DFT, MCSCF or coupled cluster methods). Unfortunately, for properties other than

energy the situation is much less favorable and accurate results are diﬃcult to obtain.

To understand this point let us ﬁrst deﬁne what we mean here by accuracy. In standard

quantum Monte Carlo schemes there exist essentially two types of error:

i) the usual statistical error resulting from the necessarily ﬁnite simulation time. This

error present in any Monte Carlo scheme behaves as

1/√N where N is the number of

∼

Monte Carlo steps.

ii) the systematic error (or “bias”) associated with some particular choice of the trial

wave function. In a Variational Monte Carlo (VMC) scheme it is the systematic error

resulting from the approximate trial probability density. In a ﬁxed-node Diﬀusion Monte

Carlo (DMC) it is either the ﬁxed-node error of energy calculations or the systematic

error associated with the mixed DMC probability density for a more general observable.

Other types of systematic errors may also exist, e.g. the short-time error, [15] however,

such errors can be easily controlled and, therefore, will not be considered here.

Now, to enlighten the major diﬀerences between energy and observable computations

let us compute the expressions of these two errors. We shall do that within the framework

of the Variational Monte Carlo method where, as we shall see later, all the main aspects

of this work are already present.

In a variational Monte Carlo simulation the variational energy

Ev

≡

h

ψT

H

ψT

|
ψT

|
ψT

h

|

i

i

,

3

(1)

where ψT is the approximate trial wave function used, is re-expressed as the statistical

average of the local energy deﬁned as

over the probability density associated with ψ2

T , namely

An accurate calculation of the energy requires the two following conditions.

(i) First, the systematic (or variational) error deﬁned as

EL =

HψT
ψT

Ev =

EL

h

T .
iψ2

∆E

Ev

E0 ≥

−

0,

≡

where E0 is the exact energy, must be as small as possible.

(ii) Second, the variance of the local energy (which is directly related to the magnitude

of the statistical error)

σ2(EL) =

(EL

Ev)2

h

−

T ,
iψ2

must also be as small as possible.

To estimate both quantities we express them in terms of the trial wave function error,

δψ = ψT

ψ0, where ψ0 is the exact wave function. Regarding the systematic error it is

−
easy to check that

ψT

∆E = h

−

H
ψT

ψ0|
h

−
|

E0|
ψT
i

ψT

ψ0i

.

−

In other words, ∆E is of order two in the wave function error

Now, regarding the variance, it is convenient to write the following equality

∆E

∼

O[δψ2].

EL

Ev =

−

(H

−

E0)(ψT
ψT

ψ0)

−

∆E,

−

4

(2)

(3)

(4)

(5)

(6)

(7)

(8)

from which it is directly seen that σ2(EL) is also of order two

σ2(EL)

O[δψ2].

∼

(9)

Equations (7) and (9) are at the origin of the high-quality calculations of the en-

ergy. They show that accurate energy calculations are directly related to good trial wave

functions: The more accurate the trial wave function is, the smaller the statistical and

systematic errors are.

In the limit of an exact trial wave function, both errors vanish

and the energy estimator reduces to the exact energy. This most fundamental property

is referred to in the literature as the “Zero-Variance property”. Note that a much more

preferable and accurate denomination should be “Zero-Variance-Zero-Bias property” to

emphasize on the existence of the two types of error. Of course, in the case of the energy

this distinction is not necessary since, as just seen, the two errors are not independent

and vanish simultaneously with the exact wave function. However, as we shall see below,

this peculiar aspect will be no longer true for other properties.

Let us now turn our attention to the computation of a general observable. Deﬁning

the expectation value of some arbitrary observable O as follows

its Monte Carlo expression is given by

It is easy to verify that the systematic error behaves as

∆O

O

iψ2

T − h

O

iψ2

0 ∼

≡ h

O[δψ],

while the variance is given by

Ov

≡

h

ψT

O

ψT

|
ψT

|
ψT

h

|

i

i

,

Ov =

O

T .
iψ2

h

σ2(O)

O[1].

∼

5

Compared to the energy case we have two striking diﬀerences. First, the systematic error

in the averages is much larger. This is a direct consequence of Eq.(12): the estimator of

(10)

(11)

(12)

(13)

a general observable has only a linear zero-bias property instead of a quadratic one like

in the energy case. Even worse, because trial wave functions are optimized to lower the

systematic error in the energy (and/or its ﬂuctuations) and not the error in the observ-

able, the prefactor associated with the linear error contribution, Eq.(12), is usually much

larger than in the energy case, Eq.(7). In practice, this important systematic error makes

in general the quality of the expectation value, Eq.(11), very poor. The second important

diﬀerence is that there is no zero-variance property at all for observables when Eq.(11) is

used. Indeed, even when the exact wave function is used as trial wave function we are still

left with some ﬁnite (and eventually large) statistical ﬂuctuations, Eq.(13). Thus, statis-

tical ﬂuctuations are in general very large for properties. A simple and popular strategy

to reduce the important systematic error on properties is to mix Variational Monte Carlo

(VMC) and ﬁxed-node Diﬀusion Monte Carlo (DMC) calculations to build up a so-called

“hybrid” or “second-order” estimator,

O

h
duced. [16] An elementary calculation shows that the error is now of order O[(ψT

h

iDM C − h

ihybrid ≡

O

iV M C, whose error is re-
ψ0)2],

2

O

−

plus a linear contribution O(ψF N

ψ0) due to the approximate nodes of the trial wave

0 −

function. However, once again such a solution is not, in practice, as satisfactory as it

appears at ﬁrst glance because of the large prefactor associated with the second-order

contribution and, also, of the non-negligible linear error due to the nodes. A second pos-

sible strategy to cope with the systematic error is to perform an “exact” QMC calculation

based on one of the variants of the so-called “Forward Walking” scheme. [17–19] Unfor-

tunately, such schemes are known to be intrinsically unstable and, therefore, very time

consuming. In practice, the possibility of getting or not a satisfactory answer depends

very much on the accuracy required and on the type of observable considered. Therefore,

Forward Walking is not considered as a general practical solution to the problem.

In this work, we propose to follow a quite diﬀerent route. Our purpose is to show

that it is possible to use much more eﬃcient estimators for properties than the usual bare

expression, Eq.(11). More precisely, it is shown how to construct in a simple and system-

6

atic way new estimators having the same remarkable quadratic zero-variance zero-bias

property as the energy case. Very recently, we have made a ﬁrst step in that direction

by showing how to generalize the zero-variance part of this property. [20,21] In short, the

basic idea consists in constructing a “renormalized” or improved observable having the

same average as the original one but a lower variance. To build the renormalized observ-

able, an auxiliary wave function is introduced. This function plays a role analogous to the

one played by the trial wave function in the case of the energy: The closer the auxiliary

function is of the exact solution of some zero-variance equation (the Schroedinger equa-

tion in the case of the energy), the smaller the statistical ﬂuctuations of the renormalized

observable are. Our approach has been illustrated on some simple academic examples [20]

and also for the much more diﬃcult case of the computation of forces for some diatomic

molecules. [21] Numerical results on these examples are very satisfactory. When suitably

chosen auxiliary functions are used, statistical errors are indeed greatly reduced.

Here, we present the full generalization of the preceding idea:

it is shown how to

construct improved observables minimizing both systematic and statistical errors with

a quadratic behavior similar to that obtained for the energy. As a consequence, any

observable is expected to be calculated, at least in principle, with the remarkable accuracy

achieved by QMC for total energies. The basic idea behind our approach is quite simple:

it consists in making use of the relation between energy and observable calculations as

expressed by the Hellmann-Feynman (HF) theorem. As well-known this theorem expresses

any quantum average as a total energy derivative with respect to the magnitude of the

external potential deﬁned by the observable.

It is shown how the zero-variance zero-

bias principle valid for each value of the energy (as a function of the external potential)

can be extended to the derivative and, therefore, to the observable. Note that in the

context of QMC simulations, the idea of using the HF theorem to compute observables,

using either a ﬁnite diﬀerence scheme or the analytic derivative, is not new and has

been applied by several groups [22–30]. In general, the results are good for very small

7

systems but rapidly disappointing for larger systems. Indeed, only when a clear physical

insight into the origin of the ﬂuctuations of the inﬁnitesimal diﬀerence of energy (the

derivative) is available it is possible to propose an eﬃcient solution to the problem. A

very nice example of such a possibility is presented in the recent work by Filippi and

Umrigar. [31], [29]. By using a ﬁnite representation of the energy derivative and by

introducing a special coordinate transformation allowing the electrons close to a given

nucleus to move almost rigidly with that nucleus, they have shown how to correlate

eﬃciently the calculation of the electronic energies associated with two slighlty diﬀerent

nuclear conﬁgurations of a diatomic molecule. As a result they have been able to get

accurate estimates of the energy derivatives (forces) for some diatomic molecules. Here,

we show how the correlated sampling method of Filippi and Umrigar can be re-expressed

in our framework.

In addition, by generalizing their idea it is shown how coordinate

transformations can be used to deﬁne a new class of improved estimators.

While ﬁnishing this work, we came aware of a paper just published by Casalegno,

Mella and Rappe. [32] The idea underlying their work has some close relations with what

is presented here.

In short, they propose, as we do here, to compute forces using a

Hellmann-Feynman-type formalism. Their expression to calculate forces is obtained by

making the derivative of the VMC (or DMC) energy average with respect to nuclear

positions. To reduce the systematic error these authors propose to employ trial wave

functions which have been very carefully optimized via energy minimization (let us recall

that the HF theorem is valid when fully optimized wave functions are used). To decrease

the very large statistical ﬂuctuations associated with the inﬁnite variance, the improved

estimator introduced in our previous work on forces [21] is used. As we shall see below,

the approach proposed by Casalegno and collaborators can be viewed as a special case

of the general method presented here, except that their estimator does not obey a Zero-

Variance Zero-Bias property. As we shall see below, this latter aspect has some important

practical consequences when a high level of accuracy on forces is needed.

8

The organization of the paper is as follows. In Section II we present the Hellmann-

Feynman theorem and the construction of improved estimators for variational Monte

Carlo calculations.

It is also shown how the idea of Filippi and Umrigar consisting in

introducing a special coordinate transformation can be used to build up some more general

and more eﬃcient improved estimators. In Section III we discuss the generalization of

the formulae to the case of Diﬀusion Monte Carlo calculations. In Section IV we present

the application of the formalism to the computation of the entire force curve for the

H2,LiH, and Li2 molecules. Calculations of the spectroscopic constants, Re and ωe, are

also reported. Finally, in the last section we summarize our results and present some

concluding remarks.

II. IMPROVED ESTIMATORS FOR OBSERVABLES

In order to make the connection between energy and observable computations we shall

make use of the Hellmann-Feynman (HF) theorem which expresses the expectation value

of an observable as an energy derivative

where E0(λ) is the exact ground-state energy of the “perturbed” Hamiltonian deﬁned as

h

O
ψ0|
ψ0i
|
ψ0i
ψ0|
h

=

dE0(λ)

dλ |λ=0,

H(λ)

H + λO.

≡

(14)

(15)

By choosing various approximate expressions for the exact energy in Eq.(14), it is possible

to derive various approximate estimates for the average. In the next sections we present

two choices which turn out to be particularly eﬃcient in practical applications.

A. Improved estimator built from the variational approximation of the energy

A most natural choice consists in replacing the exact energy of the HF theorem by

a high-quality variational approximation. To do that, we introduce some λ-dependent

9

approximate trial wave function, ψT (λ) to describe the ground-state of H(λ) [Note that,

for the sake of clarity and simplicity, we shall denote in what follows ψT (0), H(0), and

E0(0) as ψT , H, and E0, respectively].

The exact average of the observable can be decomposed as

ψ0i
O
ψ0|
|
ψ0i
ψ0|
h
where Ev(λ) is the variational energy associated with ψT (λ)

dEv(λ)
dλ |λ=0 + ǫ(δψ, δψ′)

=

h

Ev(λ)

EL(λ)

≡ h

2(λ) =

iψT

H(λ)ψT (λ)
ψT (λ)

h

2(λ)

iψT

and ǫ some correction depending on δψ = ψ0 −
the exact wave function is used as trial wave function.

ψT and its derivative, and vanishing when

Now, the important point is that the derivative of the variational energy, dEv(λ)

dλ |λ=0,
is expected to be a better estimate of the exact average than the ordinary average of the

bare estimator, Eq.(11), when properly chosen λ-dependent trial wave functions are used.

This is true since the standard estimator, Eq.(11), can be re-expressed as a particular

case of the derivative of the variational energy for a λ-independent trial wave function, a

choice which is clearly not optimal. Before justifying more quantitatively this statement,

let us rewrite the derivative as an ordinary average over the density ψT

2. This can be

easily done, it gives

dEv(λ)

dλ |λ=0 =

h

˜O

2

iψT

where ˜O is a new modiﬁed local operator written as

˜O

≡

O +

(H

′

−

EL)ψT
ψT

+ 2(EL

Ev)

−

′

ψT
ψT

In this latter formula, and in the formulae to follow, we shall use the following simpliﬁed

notation

(16)

(17)

(18)

(19)

(20)

f ′

df (λ)
dλ |λ=0

≡

10

where f (λ) is some arbitrary function of λ.

Now, we have to justify the ﬁrst important result, that the new estimator ˜O is a better

estimator for the exact average than the bare observable O. For that purpose, we compute

the systematic error in the corresponding average and the variance of the new operator.

Regarding the systematic error we can write

∆ ˜O ≡ h

˜O

2

iψT

O

0 =

iψ2

− h

d[Ev(λ)

E0(λ)]

−
dλ

|λ=0.

Let us denote ψ0(λ) the exact groundstate of H(λ) [with ψ0(0) = ψ0]. Using the

equality

Ev(λ)

E0(λ) =

−

ψT (λ)

ψ0(λ)

h

−

H(λ)
−
ψT (λ)
|

|
h

E0(λ)
ψT (λ)

|
i

ψT (λ)

ψ0(λ)

−

i

and choosing the following convention of normalization

ψT (λ)

ψT (λ)

= 1,

h

|

i

the derivative can be easily computed, we get

∆ ˜O =

ψT

h

−

O

ψ0|
ψ0|

−

H

− h

ψT

O

iψ2
0|
ψT
E0|

′

−

ψ0i
ψ0

′

i

−

−

+ 2

ψT

h

As it can be seen, the systematic error is now of order two in the errors ψT

ψ0 and

−

′

ψT

′

ψ0

−

Now, let us compute the variance deﬁned as

∆ ˜O ∼

O[(ψT

−

′

ψ0)(ψT

′

ψ0

)].

−

σ2( ˜O) =

( ˜O

˜O

2)2

2.

iψT

iψT

− h

h

Using Eqs. (18),(19) and the fact that E′

L = O + (H−EL)ψT

ψT

′

we can express the diﬀerence

˜O

˜O

− h

iψT

2 as follows

11

(21)

(22)

(23)

(24)

(25)

(26)

(27)

(28)

(29)

(30)

˜O

˜O

− h

iψT

′

2 = EL

Ev

′ + 2(EL

−

′

.

ψT
ψT

Ev)

−

For the sake of clarity, let us distinguish two diﬀerent contributions in the diﬀerence. The

ﬁrst contribution is given by

Using expression (8) for [EL(λ)

Ev(λ)] and performing the derivative one obtains

′

EL

Ev

′ =

−

d[EL(λ)

Ev(λ)]

−
dλ

λ=0 .

|

−

′

EL

Ev

′ =

−

(O

− h

O

0)(ψT
iψ2
ψT

ψ0)

−

(H

+

−

E0)(ψT
ψT

′

−

ψ′
0)

(H

−

E0)(ψT
ψT

−

ψ0)

−

′

ψT
ψT

+

O

h

iψ2

0 − h

˜O

iψ2

T

This latter expression is clearly of order one in ψT

ψ0 and its derivative,ψT

−

second contribution in the R.H.S. of Eq.(27) is proportional to EL

′

ψ′
0. The

−
Ev. We have already

seen that it is of order one in ψT

ψ0, Eqs.(7), (8). Finally, ˜O

2 is found to be of

order one in ψT

ψ0 and ψT

−

′

−

−
ψ′
0. The variance, Eq.(26), is therefore of order two

− h

−
˜O

iψT

σ2( ˜O)

O[(ψT

′

ψ0)(ψT

′

ψ0

)].

∼

−

−

To summarize, using the HF theorem we are able to construct an improved observable

˜O, Eq.(19), having a quadratic zero-variance-zero-bias property, Eqs.(25,30), similar to

what is known for the energy case, Eqs.(7,9). The improved estimator ˜O depends only

on one single quantity, namely ψT (λ). Accordingly, to get accurate results we need to

choose in the neighborhood of λ = 0 a trial function accurate enough to get not only

a small diﬀerence in wave functions but also in the derivative of the wave functions. In

practice, this latter point is particularly diﬃcult to fulﬁll. Indeed, at ﬁxed values of λ,

it is known that the minimization of the ﬂuctuations of the local energy can allow an

important reduction of the error in the trial wave function. However, there is no reason

12

why it should also lead to a satisfactory representation of the derivative of the trial wave

In order to escape from this diﬃculty we propose here to work directly at λ = 0 and to

optimize independently the trial wave function ψT and its derivative ψT

. Such procedure

′

is justiﬁed since it corresponds to choose as λ-dependent trial wave function the following

function.

expression

ψT (λ) = ψT + λ ˜ψ,

where ˜ψ is some new independent function playing the role of a trial function for the

derivative of the ground-state at λ = 0. In this case, the renormalized observable can be

rewritten under the ﬁnal form

(H

EL) ˜ψ

˜O

≡

O +

−
ψT

+ 2(EL

Ev)

−

˜ψ
ψT

.

where the pair of functions (ψT , ˜ψ) is the current guess for the exact solution (ψ0, ψ0

′

).

Let us now turn our attention on the problem of optimizing the two trial functions

(ψT , ˜ψ). Regarding ψT we know that the standard procedure consists in minimizing the

variance of the local energy with respect to the parameters of the trial function. Quite

remarkably, we have here a similar result for ˜ψ: the best choice is obtained by minimizing

the variance of the renormalized operator ˜O with respect to the parameters of ˜ψ.

To prove this property it is suﬃcient to show that the zero-variance (or zero-

ﬂuctuations) equations for EL and ˜O:

are equivalent to the equations deﬁning ψ0 and ψ′

0, namely

EL =

EL

iψ2

T

2

iψT

h

h

˜O =

˜O

(H

E0)ψ0 = 0

−

−

(H

E0)ψ′

0 + (O

O

iψ2

− h

0)ψ0 = 0

13

(31)

(32)

(33)

(34)

In these formulae, the ﬁrst equation is just the ordinary Schroedinger equation. The

second one is obtained by deriving the Schroedinger equation:

H(λ)ψ(λ) = E0(λ)ψ(λ)

(35)

with respect to λ at λ = 0. Note that equations (34) determine an unique solution,

(ψ0, ψ′

O

0, E0,

0), as soon as H has a non-degenerate ground-state. Now, using Eqs.(19)
and (2) for the deﬁnition of ˜O and EL, respectively, the system of equations (33) can be

iψ2

h

rewritten under the form

(H

Ev)ψT = 0

(H

Ev)ψT

+ (O

′

−

−

O

iψT

− h

2)ψT = 0

(36)

(37)

which are nothing but Eqs.(34) with (ψT , ψT

′

) = (ψ0, ψ′

0). Accordingly, the zero-variance

equations (33) admits this latter pair of functions as unique solution.

In practical calculations, diﬀerent strategies of optimization can be employed. A ﬁrst

approach consists in minimizing separately the variance of the local energy with respect

to the wave function ψT and the variance of ˜O with respect to ˜ψ.

In this way, we

get an optimal trial wave function ψT for the energy and the best derivative at ﬁxed

ψT . However, let us emphasize that this approach is not the most general: we can also

minimize both variances simultaneously with respect to the two independent functions.

Another remark is that the second equation of system (34) can be viewed as an ordinary

ﬁrst-order perturbation equation. This is expected since, when λO is considered as a

perturbation of the Hamiltonian H, ψ′

0 is nothing but the ﬁrst-order correction to the

ground-state and

O

0 the ﬁrst-order correction to the energy.

iψ2

h

Finally, let us end this section by commenting in more detail the various terms en-

tering expression (32) of the improved operator. Three diﬀerent contributions can be

distinguished:

(i) The ordinary bare estimator O corresponding to ˜ψ = 0.

14

(ii) A second contribution given by (H

It is easy to verify that this

contribution has a zero average over the density ψT

EL) ˜ψ/ψT .

−

2

(H

h

−

EL) ˜ψ/ψT

2 = 0.

iψT

(38)

Accordingly, its role is to lower the variance of the improved estimator without changing

the average of the observable (no inﬂuence on the systematic error). Note that for appli-

cations where the stationary density is known and can be exactly sampled (that is, there

is no systematic error in the average) the use of contributions (i) and (ii) is suﬃcient. Im-

portant examples include all “classical” Monte Carlo simulations based on the Metropolis

algorithm or one of its variants. Such a possibility was the subject of a previous work. [20]

(iii) A third term given by 2(EL

Ev)

˜ψT
ψT . This contribution has a very small impact on

−

the statistical ﬂuctuations since the variance of (EL

Ev) is of order two in the trial wave

−

function error for any choice of ˜ψ. Its main eﬀect is to take into account the change of

stationary density under the external perturbation deﬁned by the observable and, there-

fore, to lower the systematic error in the expectation value of the observable. Note that

in the limit ψT = ψ0, this contribution reduces to zero and, therefore, the average of this

term can be understood as a correction to the Hellmann-Feynman formula when ψT is not

the exact ground-state (note that similar corrections to the HF formula exist also in more

traditional ab initio calculations, e.g. the “Pulay force” [33] resulting from approximate

Hartree-Fock (or LDA) orbitals in self-consistent schemes).

B. More improved estimators: use of coordinate transformations

In this section it is shown how to generalize further our renormalized operators. The

basic idea of the generalization is based on an original idea recently proposed by Filippi

and Umrigar in their work on the computation of forces [29]. Working in a ﬁnite diﬀerence

formalism they have proposed to compute the forces as a small but ﬁnite diﬀerence of

energies for two close enough geometries. In order to minimize the ﬂuctuations they have

15

proposed to use a correlated sampling method in which a common Monte Carlo density

(the so-called primary one) is used for the two close geometries. Written within our

notations and taking the limit of the two geometries inﬁnitely close (δR

→
0) it means that the variational energy is written under the form

to λ

0 is equivalent

→

Ev(λ) = h

(λ)

2
EL(λ) ψT
ψ2
T
2(λ)
ψT
ψ2
T

h

iψ2

T

iψ2

T

where ψT (λ) is the trial wave function chosen for a parameter λ and ψT is the reference

(primary) trial wave function.

The price to pay when doing that is the introduction of some additional ﬂuctuations

associated with the weight ψT

(λ)

2
ψ2
T

. The remedy they propose to deal with this problem is

to use a speciﬁc coordinate transformation (space-warp transformation) based on physical

motivations: The transformation is built so that the electrons close to a given nucleus

move almost rigidly with that nucleus when the geometry is changed. Here, we generalize

this idea: coordinate transformation can help to minimize the relative ﬂuctuations when

varying the external parameter λ. As a physical consequence, estimators built from the

derivative are expected to have smaller ﬂuctuations and smaller systematic errors.

Let us write a general coordinate transformation as follows

~y = ~T (λ, ~x)

where the vector ~x (or ~y) denotes the set of the 3nelec electronic coordinates. Using this

transformation the variational energy at a given λ can be written as

Ev(λ) = h

EL[λ, ~T (λ, ~x)]J(λ, ~x) ψT
[λ, ~T (λ,~x)]
J(λ, ~x) ψT
2(~x)
ψT

2

h

2

iψT

2[λ, ~T (λ,~x)]
(~x)
ψT

2

2

iψT

where J(λ, ~x) is the Jacobian of the transformation. Introducing the vector ﬁeld ~v such

that at ﬁrst order in λ we have:

(39)

(40)

(41)

(42)

~T (λ, ~x) = ~x + λ~v(~x) + O(λ2)

16

(43)

(44)

(45)

(46)

(47)

(48)

we can compute the derivative of the variational energy with respect to λ at λ = 0. After

some simple but tedious algebra we get the following equality

dEv(λ)

dλ |λ=0 =

h

˜O

2

iψT

where ˜O is a new renormalized operator given by

˜O

≡

O +

(H

′

−

EL)ψT
ψT

+ 2(EL

Ev)

−

′

ψT
ψT

~
∇

+

[(EL

Ev)ψ2

T~v]

.

−
ψ2
T

To derive this expression we have used the fact that the Jacobian deﬁned as

has the following small-λ expression

J(λ, ~x) = det[

∂Ti(λ, ~x)
∂xj

]

J(λ, ~x) = det[δij + λ

] + O(λ2)

∂vi
∂xj

and, therefore,

J(0, ~x) = 1

∂J
∂λ

(0, ~x) = ~
∇

.~v

This more general operator is identical to the operator derived in the previous section

plus a new contribution resulting from the derivative of the coordinate transformation.

This new term has a zero average over the VMC distribution ψ2

T . Accordingly, its main

role is to reduce further the statistical error. However, it is important to emphasize that,

when the trial function ˜ψ and the vector ﬁeld ~v are optimized simultaneously it has also

an inﬂuence on the magnitude of the systematic error.

III. BEYOND VARIATIONAL MONTE CARLO

In the preceding section we have shown how to construct improved observables, ˜O,

associated with accurate expectation values:

17

ψT

ψT

˜O
|
ψT

|
ψT

h

i

= h

ψ0i
O
ψ0|
|
ψ0i
ψ0|
h

+ O[(ψT

ψ0)( ˜ψ

′

ψ0

)].

−

−

(49)

in the trial function for the derivative is comparable to the

|
When the error δψ′ = ˜ψ

h

i

′

ψ0

−

error in the trial function for the ground-state, δψ = ψT

ψ0, the accuracy reached with

−

the preceding variational estimate, Eq.(49), can be comparable to the very good accuracy

usually obtained for total energies. However, despite this remarkable improvment, we

are still left with some small residual systematic error associated with approximate ψT

and ˜ψ.

In the energy case it is known that this error can be entirely suppressed (at

least for systems with no nodes or known nodes) by averaging the local energy over the

mixed Diﬀusion Monte Carlo (DMC) probability distribution, πDM C

ψT ψ0 instead

∼

of the VMC distribution, πV M C

ψT

2. Unfortunately, we have no such result for the

∼

improved observables deﬁned here. However, as we shall see now, we can still deﬁne some

approximate way for recovering most of the error.

A natural way of deﬁning an exact extimator for the observable is to consider the

derivative of the exact DMC energy estimator instead of the VMC one

E0(λ)

EL(λ)

iψT (λ)ψ0(λ) =

h

≡ h

H(λ)ψT (λ)
ψT (λ)

iψT (λ)ψ0(λ)

Making the derivative and rewritting the result as an ordinary average we get:

dE0(λ)

dλ |λ=0 =

h

˜O

i

ψT ψ0

where ˜O is written as

˜O

≡

O +

(H

′

−

EL)ψT
ψT

+ (EL

E0)(

+

−

′

ψT
ψT

′

ψ0
ψ0

).

Of course, written under the above form, this exact estimator is useless since the exact

wave function is not known. Here, we propose to make the following natural approxima-

tion

(50)

(51)

(52)

(53)

′

ψ0
ψ0

=

′

.

ψT
ψT

18

Therefore, our ﬁnal approximate DMC estimator is written as

(H

EL) ˜ψ

˜ODM C

O +

≡

−
ψT

+ 2(EL

E0)

−

˜ψ
ψT

where ˜ψ is as usual our trial function for the derivative of the exact wave function. Note

that this estimator is very similar to the VMC one, Eq.(32). The only diﬀerence lies in the

value of the average energy, E0 =

EL

, entering the deﬁnition of ˜ODM C. More precisely,

h

i

we have

(54)

(55)

˜ODM C

˜OV M C = 2(Ev

−

˜ψ
ψT

.

E0)

−

Now, in order to reduce further the error let us show that we can generalize the usual

“hybrid formula”

O

h

ihybrid ≡

2

O

h

iDM C − h

of improved observables. To do that, let us develop the quantity

O

iV M C deﬁned for bare observables to the case
where

˜ODM C

δψ

δψ

h

|

|

i

δψ

˜ODM C

h

|

δψ

=

ψT

|

i

h

|

˜ODM C

ψT

2

ψT

˜ODM C

|

i −

h

|

+

ψ0i

|

ψ0|

h

˜ODM C

ψ0i

|

(56)

δψ = ψT

ψ0

−

which leads to

2

ψT

h

|

˜ODM C

ψ0i − h

|

ψT

|

˜ODM C

ψT

=

O

ψ0|

h

ψ0i

|

i

|

+ A + O(δψ2)

where the intermediate quantity A is deﬁned as

(H

EL) ˜ψ

A

ψ0|

≡ h

−
ψT

+ 2(EL

E0)

−

˜ψ
ψT |

ψ0i

Expanding A in terms of δψ = ψT

ψ0 we get

−

A = 2

ψT

EL

h

|

˜ψ

E0|

−

2

δψ

(H

i −

h

|

−

EL)

˜ψ

4

δψ

EL

|

i −

h

|

E0|

˜ψ
i

−

+ O(δψ2)

Using now the equality

we obtain

EL

E0 =

−

(H

E0)δψ
−
ψT

A = O(δψ2)

19

This latter result shows that the error in the hybrid estimator is of order two in δψ

˜ODM C

2

h

ψT ψ0 − h

i

˜ODM C

T =

iψ2

ψ0|

h

O

ψ0i

|

+ O(δψ2),

(57)

thus generalizing the standard result for the bare observable. Note that we can use either

˜ODM C or ˜OV M C [Eq.(32)] in this latter formula since the diﬀerence between the two

renormalized operators is proportional to Ev

E0, Eq.(55), and, therefore, is also of order

−

When using coordinate transformation we have similar results. The exact DMC esti-

two in δψ [Eq.(7)].

mator is found to be

˜O

≡

O +

(H

′

−

EL)ψT
ψT

+ (EL

E0)(

+

) +

′

ψT
ψT

′

ψ0
ψ0

~
∇

−

[(EL

E0)ψT ψ0~v]

−
ψT ψ0

and we propose to use the following approximate form

(H

EL) ˜ψ

˜ODM C

O +

≡

−
ψT

+ 2(EL

EL

)

i

− h

~
∇

+

[(EL

˜ψ
ψT

EL
2

i

− h
ψT

)ψT

2~v]

(58)

(59)

Because the diﬀerence (EL

EL

) is of order δψ it is easy to verify that the error in the

i
hydrid estimator given by Eq.(57) remains here also of order two.

− h

Before ending this section let us emphasize that it is possible to write a closed com-

putable expression for the exact estimator of the observable, Eq.(52), by expressing the

unknown quantity ψ0

′

ψ0 as a computable stochastic average. Choosing a λ-independent trial

wave function ψT we can write [34,35,18]

ψ0(λ, x) = ψT (x) lim

<< e

T →+∞

T

−

0 dsEL[λ,x(s)] >>x(0)=x
R

(60)

where x denotes an arbitrary point in conﬁguration space and << ... >>x(0)=x denotes the

sum over all drifted random walks of length T starting at x as obtained in a Pure Diﬀusion

Monte Carlo (PDMC) scheme (DMC without branching). [18] Of course, a similar formula

can also be obtained in a DMC scheme. [17] Now, using formula (60) we get

′

ψ0
ψ0

= lim

T →+∞ Z

0

dt

T

<< O[x(t)]e

0 dsEL[λ,x(s)] >>x(0)=x

−

<< e

0 dsEL[λ,x(s)] >>x(0)=x

(61)

T

−

R

T

R

20

and, therefore, the exact estimator can be written in terms of a standard part plus a time-

integral of the two-point correlation function between the local energy and the observable

˜O = O +

(H

EL) ˜ψ

−
ψT

+ (EL

EL

)

i

− h

˜ψ
ψT

T

<< (EL

EL

)[x(0)]O[x(t)]e

+ lim

T →+∞ Z
0

dt

− h

i
<< e

−

T

0 dsEL >>x(0)=x
R
It is important to emphasize that this latter estimator is exact: averaged over the mixed

(62)

T

−

0 dsEL >>x(0)=x
R

DMC distribution it leads to an unbiased estimate of the exact average. However, the

correlator can only obtained within a Forward Walking scheme and, therefore, the stability

in time is not guaranteed. In this work, we shall not use this expression, its implementation

will be presented in a forthcoming work.

IV. APPLICATION TO FORCES

The average force between atoms in a molecular system is deﬁned as

¯Fqi ≡ −

∂E0(q)
∂qi

,

where E0(q) is the total electronic ground-state energy for a given nuclear conﬁguration;

q represents the 3Nnucl nuclear coordinates (Nnucl, number of nuclei) and qi the particular

force component in which we are interested.

Deﬁning the local force as follows

Fqi(x, q)

∂V (x, q)
∂qi

.

≡ −

where x represents the 3nelec electronic coordinates (nelec, number of electrons) and V the

total potential energy operator, and making use of the Hellmann-Feynman (HF) theorem

the average force can be rewritten as the statistical average of the local force over the

exact distribution ψ2

0(x):

(63)

(64)

(65)

¯Fqi =

Fqi(x, q)

h

0(x).

iψ2

21

Written under this form the various proposals presented in the preceding sections can

be applied to the calculation of the average force. It is important to emphasize that for

approximate probability densities (VMC or DMC) the HF theorem is no longer valid and

a systematic error in the statistical average

Fqi(x, q)

is introduced. However, it is not a

h
problem here since it is the purpose of this work to show that, by using suitable improved

i

estimators, this error can be reduced and even suppressed in the zero-bias limit.

In order to discuss the various aspects of the method we shall restrict ourselves to the

case of diatomic molecules. Let us consider a diatomic molecule AB with atom A located

at (R, 0, 0) and atom B located at the origin. The only non-zero component of the local

force acting on the nucleus A is the x-component given by

F =

∂V
∂R

−

=

ZAZB

R2 −

ZA

nelec

Xi=1

(xi
ri

R)
3 .
R
|

−
−

|

(66)

In this work we present a number of VMC and ﬁxed-node DMC calculations for

the diatomic molecules H2,LiH, and Li2. Implementation of the quantum Monte Carlo

methods is well-known and will not be discussed here. For the H2 molecule the trial wave

function used has the following simple form

ψT = (1sA1sB + 1sB1sA) + c(1sA1sA + 1sB1sB)

(67)

where 1sM is a 1s-Slater function centered at nucleus M = A, B with exponent µ and c a

parameter describing the amount of ionic contribution into the wave function. Of course,

much more accurate trial wave functions can be constructed for H2. However, our purpose

here is to show that such a simple form for ψT is already suﬃcient to get accurate values

of the force.

For LiH and Li2 we have employed two types of trial wave function. Our main choice is

standard in QMC calculations for molecules. The trial wave function is made of a determi-

nant of single-particle orbitals multiplied by a Jastrow factor. The determinantal part is

obtained from a RHF calculation and only the Jastrow factor is optimized. As we shall see

22

below, we have also used Valence-Bond (VB)-type wave functions consisting of a number of

determinants multiplied by a Jastrow factor. We have used such a multideterminantal de-

scription to reproduce correctly the large interatomic distance regime (dissociation limit).

In the case of LiH the determinantal part consists of three determinants corresponding

to the covalent VB resonating structure: (1sLi)2[2sLi1sH + 1sH2sLi] (

1sLi, 2sLi, 1sH

op-

{

}

timized atomic orbitals for the Li and H atoms, orbitals occupied by electrons α and β

antisymmetrized separately) and one ionic VB structure: (1˜sLi)21˜sH1˜sH (1˜sLi, 1˜sH opti-

mized atomic orbitals for the Li+ and H− ions). In the case of Li2 we have considered a

six-determinant representation consisting of the three covalent VB structures describing

the resonance between atomic orbitals (2sA, 2sB), (2pyA, 2pyB), and (2pzA, 2pzB). This

latter trial wave function reproduces not only the dissociation limit but also a major part

of the 2s-2p near-degeneracy.

In Figures 1,2, and 3 the energy curves obtained for H2,LiH, and Li2 are presented.

Upper curves are the VMC curves (open squares joined by a dotted line). For H2 the

two parameters c and µ have been optimized for each interatomic distance. For LiH and

Li2 the Jastrow-RHF wave function (one determinant) has been used. All the parameters

entering the Jastrow factor have been optimized for all distances. Optimizations have been

performed by minimizing the variance of the local energy using the correlated sampling

method of Umrigar et al. [36]. The ﬁrst important observation is that, except for H2, VMC

curves are not smooth as a function of R. Such a result is not surprising: It is typical of a

situation where an approximate trial wave function is optimized independently for diﬀerent

values of an external parameter (here, R) with respect to a large number of variables (for

LiH and Li2 we have used about 30 independent variational parameters). Depending on

the initial conditions (which are themselves very dependent on R) the algorithm used for

minimizing the variance can be trapped within one of the various local minima. As a

consequence, the actual value obtained for the variance (and the corresponding energy)

can vary abruptly even when the external parameter is changed smoothly. Of course, this

23

problem can be solved in principle by making very careful optimizations on very large

samples.

Indeed, the functional form of the trial wave function being identical at all

distances a smooth curve must be got when the correct lowest minimum of the variance is

obtained at each distance. Here, this is the case for H2 whose trial wave function contains

only two variational parameters. However, for large systems including a much larger

number of variational parameters and nuclear degrees of freedom, the possibility of fully

optimizing the trial wave function is just irrealistic. As an important consequence, let us

emphasize that, in practice, there is no hope of obtaining meaningful forces by making

straight ﬁnite diﬀerences of optimized variational energies without using some sort of

correlated sampling scheme. This is a good illustration of how diﬃcult the calculation of

forces is within a QMC framework.

Intermediate points (ﬁlled squares) are the DMC results obtained from ﬁxed-node

calculations using the optimized VMC trial wave functions. In sharp contrast with VMC,

the DMC curves are now regular. This is so because, unlike VMC, ﬁxed-node DMC

averages do not depend on the particular form of the trial function used, except for

the nodal structure. Here, the nodal hypersurfaces vary smoothly as a function of the

distance and, therefore, the corresponding DMC energy curves are smooth within error

bars. The second important observation is related to the global shape of the curves.

Ideally, we are interested in having energy curves which diﬀer from the exact curve only

by a constant independent on the distance. This is indeed the condition to obtain accurate

derivatives. Here, it is not the case for the VMC curves of LiH and Li2: the diﬀerence

between the VMC and exact energy curves is an increasing function of the distance. It

is not a surprise since in both cases the trial wavefunction is built from a single RHF

determinant based on delocalized molecular orbitals which leads to a wrong description

of the dissociation limit. However and, very interestingly, ﬁxed-node DMC results have a

much better behavior at large distances. As a consequence, one may expect at this stage

to obtain accurate forces from the derivative of the ﬁxed-node energy curve even when

24

relatively crude wave functions are used. Finally, let us note that the quality of the ﬁxed-

node calculations for the molecules considered here is quite good. To give an example, at

the equilibrium distance of the Li2 molecule, the total energy obtained is -14.9901(6) to be

compared with the exact non-relativistic value of E0=-14.9954. The amount of correlation

energy recovered within the ﬁxed-node approximation is about 95.7%. A similar quality

is obtained for other distances and also for the LiH molecule. In the case of the nodeless

H2 molecule (no ﬁxed-node approximation), the DMC energies agree perfectly well with

the exact ones. For the H2 molecule the variance of the local energy varies between 0.3

at R = 0.8 and 0.02 at R = 3.5; for LiH the variance is about 0.07, and for Li2 it varies

between 0.09 and 0.2.

The crucial point when implementing the various formulae presented in the preceding

section is the choice of the trial function ˜ψ for the derivative. In our previous study on

forces [21] where we have focused our attention on the reduction of statistical ﬂuctuations

only, we have proposed to employ the minimal form leading to a ﬁnite variance of the

renormalized local force. As can be viewed from Eq.(66), at short electron-nucleus distance

r the local force behaves as F

1/r2 and, therefore, the variance

F 2

F

2 is inﬁnite.

∼

h

i − h

i

This well-known problem has been discussed in diﬀerent places (See, e.g. [15] Chap. 8.2

or [27]). Here, the “minimal” form removing the singular part responsible for the inﬁnite

variance is written as

where Q is given by

˜ψmin(x) = QψT

Q = ZA

nelec

Xi=1

(xi
ri

|

R)
R

.

|

−
−

25

To see this, we just need to compute the following quantity

(H

−

EL) ˜ψmin
ψT

= ZA

nelec

Xi=1

(xi
ri

R)
R

|

−
−

|

Q

ψT /ψT .

3 − ∇

· ∇

(68)

(69)

(70)

By adding this latter quantity to the bare local force, Eq.(66), the singular part is exactly

removed, the remaining contribution having a ﬁnite variance. In what follows, ˜ψmin will

be referred to as the minimal form for ˜ψ.

In Figure 4 we present various VMC calculations of the average force for the Li2

molecule as a function of the interatomic distance. A ﬁrst set of points (ﬁlled squares

points with very large error bars at R=5.,R=6.5, and R=7.5) are results obtained from

the ordinary bare estimator, Eq.(66). Open squares (with small error bars) joined by

the dashed curve correspond to results obtained by using ˜ψmin as trial function for the

derivative

˜FV M C−ZV [ψT , ˜ψmin] = F +

(H

−

EL) ˜ψmin
ψT

.

(71)

This estimator can be viewed as the simplest improved estimator we can think of having

a ﬁnite variance; it corresponds to the form employed in our previous study. [21] The

subscript ZV (Zero-Variance) is used here to emphasize that the improved estimator is

built to decrease the statistical error only. Circles joined by a dotted line are results

obtained from the ZVZB improved estimator derived in the preceding section, Eq.(32):

˜FV M C−ZV ZB[ψT , ˜ψmin] = F +

(H

−

EL) ˜ψmin
ψT

+ 2(EL

EL

)

i

− h

˜ψmin
ψT

.

(72)

Note the use of the subscript ZV ZB to emphasize on the two aspects: reduction of statis-

tical and systematic errors. Finally, the solid line represents the “exact” non-relativistic

force curve for Li2.

A ﬁrst important observation is that using improved estimators is extremely eﬃcient

in reducing the statistical error. This can be seen by comparing the magnitude of the

error bars on data obtained from the ordinary bare estimator (ﬁlled squares at R = 5., 6.5,

and 7.5) with those corresponding to other calculations based on improved estimators.

A reduction of at least two orders of magnitude is observed. As already discussed this

remarkable result is a direct consequence of the fact that the inﬁnite variance of the

26

bare estimator has been reduced to a ﬁnite value. At the scale of the ﬁgure error bars

associated with improved estimators are almost not visible. A more quantitative analysis

will be given later (see, Table II).

Now, regarding systematic errors, results are much more disappointing. Using the

pure Zero-Variance (ZV) renormalized estimator, Eq.(71), the behavior of the average

force (open squares joined by the dashed line in Fig.4) as a function of R appears erratic.

This can be easily understood since the term added to the bare force in Eq.(71) has a

zero-average and, therefore, the erratic behavior is a direct consequence of the irregular

VMC energy curve presented in Figure 3. When adding the term correcting the average,

the results are improved. As seen on the ﬁgure the behavior of

˜FV M C−ZV ZB[ψT , ˜ψmin]
i
Eq.(72), as a function of R, is much less irregular, thus illustrating the important role

h

,

played by the zero-bias additional contribution [third term of the R.H.S. of Eq.(72)] to

correct the error due to the approximate trial wave function. Despite of that, the resulting

curve is far from being satisfactory. To weaken the role played by ψT we can think of

going beyond VMC calculations. In Figure 5 we present such calculations for Li2 using

the DMC-ZVZB improved estimator ˜FDM C−ZV ZB[ψT , ˜ψmin] written as

˜FDM C−ZV ZB[ψT , ˜ψmin] = F +

(H

−

EL) ˜ψmin
ψT

+ 2(EL

EL

)

i

− h

˜ψmin
ψT

where the energy average is a ﬁxed-node DMC average, and, also, results obtained by

using the generalized hybrid formula, Eq.(57)

¯F

2

h

≃

˜FDM C−ZV ZB

ψT ψ0 − h

i

˜FV M C−ZV ZB

iψ2

T

A clear improvment is observed when going from VMC (open circles) to DMC (ﬁlled

squares) and, then, to hybrid calculations (open squares): The systematic error present

in VMC calculations is reduced. However, the resulting curves are still not satisfactory.

Extracting from them a meaningful equilibrium distance or ﬁrst derivative of the force

curve (calculation of ωe) is impossible. Very similar behaviors have been obtained for H2

(73)

(74)

and LiH. They do not need to be reproduced here.

27

The main reason for the poor results just presented is the low quality of the trial

function ˜ψmin used. According to our general presentation of Sec. II we know that a good

trial function ˜ψ must be close to the derivative of the exact ground-state wave function

with respect to R. Here, this is only true when an electron approaches the nucleus A (note

that nucleus B has been ﬁxed at the origin and, thus, has no pathological contribution).

In that case the non-vanishing part of the exact wave function is expected to behave as

ψ0 ∼

ri→R exp (

ZA

ri

−

|

−

R

)

|

∂ψ0
∂R ∼

ri→R

ZA

−

(xi
ri

|

R)
R

|

−
−

ψ0

(75)

(76)

which is nothing but (up to a minus sign) the minimal form for ˜ψ given above, Eqs.(68,69).

In order to improve our trial wave function ˜ψ we propose to use the following ﬁnite-

which leads to

diﬀerence form

˜ψDeriv =

ψT [R + ∆R, p(R + ∆R)]

ψT [R, p(R)]

−

∆R

.

(77)

In this expression p(R) denotes the complete set of variational parameters entering the

trial wave function (coeﬃcients of molecular orbitals, basis set exponents, Jastrow param-

eters, etc...). The main advantage of using a ﬁnite-diﬀerence form instead of the exact

derivative is practical: To estimate the derivative we only need to compute two additional

local energies and, thus, we avoid deriving and programming the lengthy expressions re-

sulting from the explicit derivative. Note also that using an approximate ﬁnite-diﬀerence

representation is not a problem here: In any case ˜ψDeriv must be considered as an ap-

proximate trial function for the exact derivative and ∆R can always be interpreted as a

new additional variational parameter for ˜ψ. In practical calculations, the complete set

of parameters we use for minimizing the ﬂuctuations of the various improved estimators

consists of

p(R), p(R + ∆R), and ∆R

.

{

}

28

At the VMC level we consider the following form for the improved estimator

˜FV M C−ZV ZB[ψT , ˜ψDeriv, ~v] =

(H

F +

−

EL) ˜ψDeriv
ψT

+ 2(EL

EL

)

i

− h

˜ψDeriv
ψT

~
∇

+

[(EL

− h
ψ2
T

EL

)ψ2

T ~v]

i

.

At the DMC level the expression used is very similar, see Eq.(59). In this expression the

vector ﬁeld ~v associated with the coordinate transformation is chosen as follows

(78)

(79)

~v =

e−αriA−βr2

iA ~ux

nelec

Xi=1

where ~ux is the unit vector along the x-axis. The vector ﬁeld depends on two parameters

α and β, which are optimized to lower the variance of ˜FV M C−ZV ZB. The vector ﬁeld is

built so that electrons close to the nucleus A translate with the nucleus, while electrons

far away do not move. In practice, we compute the additional term associated with the

coordinate transformation using a ﬁnite-diﬀerence scheme along the direction deﬁned by

the vector ~v

[(EL

~
∇

EL

)ψ2

T~v]

i

=

− h
ψ2
T

(EL

EL

)

.~v + [(EL

EL

)(~x + ǫ~v)

− h

i

∇

− h

i

(EL

EL

)(~x)]/ǫ

− h

i

(80)

ψ2

T (~x + ǫ~v)
ψ2

T (~x) −

where ~x represents the electronic coordinates and ǫ a small positive quantity whose mag-

nitude can also be optimized.

In Figure 6 we present VMC calculations for Li2 using ˜FV M C−ZV ZB[ψT , ˜ψmin] and

˜FV M C−ZV ZB[ψT , ˜ψDeriv, ~v] as improved estimators. The two estimators have been evalu-

ated on the same Monte Carlo samples. There are two striking diﬀerences when using the

second estimator ˜FV M C−ZV ZB[ψT , ˜ψDeriv, ~v]. First, the gain in statistical error is spectac-

ular (about one order of magnitude, for a quantitative analysis see discussion below, Table

II). Second, the curve is much more regular and closer to the exact result (solid line).

The VMC results are very satisfactory at small distances (between R=3. and R=4.).

However, at larger interatomic distances, the VMC curve begins to separate from the

29

exact one. This is due to the fact that the wave function is built from a RHF calculation

and, therefore, the dissociation limit is not correctly described. To address this problem

we have considered a more sophisticated trial wave function consisting of a product of a

Jastrow factor and a six-determinant one-particle part (for a more detailed description,

see above). This VB-type trial wave function has been used only for the largest distances:

R=7.,R=7.5,R=8, and R=8.5 In ﬁgures 7 and 8 the comparison between results obtained

with the Jastrow-RHF (one determinant) and the Jastrow-VB (six determinants) wave

functions is presented. At the VMC level (Fig.7), the improvment resulting from the mul-

tideterminant wave function is clearly seen, the forces computed are much closer to the

exact curve than in the one-determinant case. At the DMC level (Fig.8) we could expect

that this error disappears even with the Jastrow-RHF (one determinant) wave function

since the DMC results depend only on the nodal structure of the wave function. However,

it is not true. The diﬀerence between the DMC curve and the exact one is still important

at large distances like in the VMC case. This result takes its origin in the approximation

made for the exact derivative of the wave function in the DMC estimator, Eq.(53) ( ψ0

′

ψ0 is

ψT ). When using the Jastrow-VB wave function the DMC results obtained

replaced by ψT

′

are much better.

We are now in a position to present our ﬁnal curves for the three molecules ob-

tained with our best fully-optimized estimator ˜FZV ZB[ψT , ˜ψDeriv, ~v] and the hybrid for-

mula. Results for the molecules H2,LiH, and Li2 are presented in Figures 9,10,11, re-

spectively. As seen from these ﬁgures the overall agreement between the exact curves

(solid lines) and QMC results (open squares) is very good. To be more quantita-

tive we have extracted from these curves an estimate of the spectroscopic constants

Re (equilibrium distance) and ωe (harmonic frequency). To do that, the data have

been ﬁtted with a functional form given by the derivative of a Morse potential curve

E(R) = D[exp

2β(R

−
the equilibrium geometry (R between 1.1 and 2. for H2, between 2.6 and 4. for LiH, and

−

−

−

−

Re)

2 exp

2β(R

Re)] over some interval of distances around

30

between 4. and 6. for Li2). Parameters D, β, and Re have been determined via a gener-

alized least-squares ﬁt. Our results at the VMC, DMC, and Hybrid levels are presented

in Table I and compared to experimental values. [37] As seen from the Table results for

the equilibrium distances are excellent. The largest systematic errors are obtained at the

VMC level (relative errors of 4.3%,3.3%, and 5.7% for H2,LiH, and Li2, respectively).

A reduction of a factor of about two is gained when DMC calculatons are performed.

Finally, using the hybrid formula, the exact equilibrium distances are recovered within

statistical errors (the relative statistical errors being 1.1%,0.3%, and 0.5% for H2,LiH, and

Li2, respectively). In contrast, results for the harmonic frequencies are less accurate but

still satisfactory. For the H2 molecule, the exact experimental result is almost recovered

within statistical error at the VMC, DMC, and Hybrid levels, the relative statistical error

being between 3 and 4%. For LiH and Li2 the relative statistical errors are of the same

order of magnitude. However, a non-negligible systematic error of about 10% is found for

these molecules. This result illustrates that obtaining accurate harmonic frequencies is

more diﬃcult than obtaining accurate equilibrium geometries.

Now, we would like to present a more quantitative discussion of the performance of

the various force estimators introduced in this work. This will allow us to summarize

the various aspects of the method, to present some comparisons with the recent results

obtained from the improved estimator implicitly used by Casalegno and collaborators [32],

and, also, to emphasize on some important quantitative issues. In Table II the systematic

and statistical errors associated with the various force estimators at the VMC, DMC and

Hybrid levels of calculation are presented. The results shown are for the Li2 molecule

at the equilibrium geometry (R=5.051 a.u.) where the exact force average, denoted as

i

F

ex, is equal to zero. To allow direct comparisons between force estimators all averages

h
have been computed in a common Monte Carlo calculation (identical MC samples). To

compare with, we also give the systematic and statistical errors on the total energy. To

give a measure of the ﬂuctuations of each estimator the corresponding variances at the

31

VMC level, σ2(VMC), are reported. To facilitate comparisons between data all averages

(except for the VMC variances) are given with ﬁve signiﬁcant ﬁgures after the decimal

point and all statistical errors are given on the ﬁfth decimal place (magnitude 10−5).

The ﬁrst estimator presented is the bare estimator, F [Eq.(66)]. As already pointed out,

this estimator, which has an inﬁnite variance, displays very large statistical ﬂuctuations

(between two and three orders of magnitude with respect to the improved estimators

to follow) and is, therefore, not at all suitable for practical calculations. The second

estimator, ˜FZV [ψT , ˜ψmin] [Eq.(71)], introduced in our previous work on forces [21] is the

simplest estimator having a ﬁnite variance. However, as explained above, when using such

an estimator no control on the systematic error exists. The third estimator presented,

˜FZV ZB[ψT , ˜ψmin], is the simplest estimator having the ZVZB property. We can see that

the introduction of the contribution associated with the ZB property, 2(EL

EL

i

− h

)

˜ψmin
ψT

is eﬃcient in reducing the bias (the DMC and hybrid errors are roughly divided by a

factor two). However, as already discussed, the derivative of the trial wave function is not

correctly reproduced as a function of the interatomic distance and the corresponding force

curve is not smooth (see, Figures 4,5). To get accurate and well-behaved (as a function of

R) values of the force it is important to introduce an auxiliary function close to the exact

derivative of the wave function. The most simple estimator based on this idea and having

a ﬁnite variance can be constructed by using the minimal form ˜ψmin [Eqs.(68),(69)] for

the Zero-Variance part and ˜ψDeriv,[Eq.(77)], for the Zero-Bias part. Such an estimator is

written as

˜F [ψT , ˜ψmin

˜ψDeriv]

F +

|

≡

(H

−

EL) ˜ψmin
ψT

+ 2(EL

EL

)

i

− h

˜ψDeriv
ψT

(81)

Written with our notations this is in fact the estimator implicitly used by Casalegno

and collaborators in their very recent work [32]. In contrast with the other estimators

presented here this “mixed” estimator (diﬀerent trial functions ˜ψ are used for the ZV

and ZB parts) has no ZVZB property. Accordingly, our general optimization procedure

32

based on the minimization of the improved-estimator variance is no longer meaningful

here. Nevertheless, as pointed out by Casalegno et al., to optimize estimator (81) we still

have the possibility of optimizing the parameters of the trial wave function ψT via energy

minimization. Such a procedure is justiﬁed because fully-optimized trial wave functions

are known to verify the Hellmann-Feynman theorem. Statistical errors associated with

this estimator are reasonable and roughly similar to those obtained with the two previous

estimators. Systematic errors are also comparable. However, in sharp contrast with all

ZVZB-improved-estimators introduced in this work, the DMC (and hybrid) calculations

do not improve the results and, as seen in the Table the hybrid results can be even

bad, despite the fact that VMC results are reasonable. Regarding the dependence of the

results on the interatomic distance we have been able to recover a relatively smooth force

curve for the smallest molecules H2 and LiH but not for Li2.

In this latter case, the

systematic error is found to be too much sensitive on the quality of the optimization of

the trial wave function to lead to reliable results. The last improved estimator presented

in Table II is our best proposal for the force estimator, Eq.(78). We report results with

(~v

= 0) and without (~v = 0) to enlighten the role of the coordinate-transformation term.

As seen, the introduction of the ~v-term is extremely eﬃcient in reducing the statistical

error. For example, at the VMC level the statistical error without this term is 218.10−5,

while the optimized improved estimator using the ~v-term is decreased down to 9.10−5. The

reduction gained in statistical error is more than one order of magnitude. This remarkable

result is general : It is valid for all molecules and all distances treated here. Another most

important point is that our best improved estimator (78) is the only estimator presented

in this work whose statistical error (here, 9.10−5) is (much) smaller than the energy one

(here, 32.10−5). Note that it is also true for the systematic error (whatever the level

of calculation). Such a result is particularly important since it has been found that a

precise control of the magnitude of the systematic error through variance minimization

of the improved force estimators is possible only when such a condition is veriﬁed.

In

33

6
contrast, when the statistical error on the force is larger than the energy error, the variance

minimization can lead to various results and to get a smooth force curve is very diﬃcult.

Actually, we would like to emphasize that obtaining results of the quality presented in

Figure (11) for the Li2 molecule has only been possible with the improved estimator (78).

Using other estimators we have not been capable of constructing a reasonable force curve

(smooth and accurate) for this molecule.

Finally, let us say a word about the dependence of our results on the optimization

process (determination of the optimal parameters entering ˜ψ, ψT , and ~v by minimization

of the variance of the improved estimator). Clearly, the method presented in this work is

useful only if the results obtained do not depend too much on the way the optimization is

performed and on which particular minimum has been found for the variance (as already

emphasized, when a large number of parameters are considered the location of such a

minimum can depend very crucially on the initial conditions and/or on the random num-

bers series used). To quantify this aspect we have made 9 independent optimizations over

9 independent sets of 2000 walkers for the Li2 molecule at the equilibrium geometry with

our best estimator. Results show that the VMC average force results may vary in a sig-

niﬁcant way for the diﬀerent sets of optimized parameters found. In this case, the domain

of variation is about twenty times the magnitude of the statistical error and about 30%

of the average itself. However, it has been observed that the DMC and Hybrid averages

are much less sensitive on the optimized parameters. The error on the DMC and hybrid

average forces due to an incomplete optimization has been found to be of the order of

magnitude of the statistical error which is rather small.

V. SUMMARY AND CONCLUSIONS

In this work we have shown how to construct improved VMC or DMC estimators for

observables. By improved it is meant that, compared to the standard bare estimator O,

34

the new estimators ˜O have a lower variance and a reduced systematic error when averaged

over the approximate VMC or (ﬁxed-node) DMC probability densities.

At the Variational Monte Carlo level the most general form we propose for ˜O is given

by

˜OV M C[ψT , ˜ψ, ~v]

(H

EL) ˜ψ

O +

≡

−
ψT

+ 2(EL

EL

)

i

− h

~
∇

+

[(EL

˜ψ
ψT

EL

)ψ2

T~v]

i

− h
ψ2
T

(82)

where averages are deﬁned over the VMC distribution. At the Diﬀusion Monte Carlo level

the expression proposed is essentially similar, except that the average of the local energy

entering the deﬁnition of ˜ODM C is deﬁned over the DMC distribution, Eq.(59). The

various terms deﬁning the improved observables have a well-deﬁned physical origin: The

three ﬁrst contributions result from the change of the energy average when the magnitude

of the observable considered as an external ﬁeld is varied, while the last contribution comes

from the use of a coordinate transformation correlating electron displacements and change

of the external ﬁeld. The functions ψT and ˜ψ appearing in the improved observables play

the role of trial functions: ψT is the ordinary trial wave function for the ground-state of

H and ˜ψ is a guess for the derivative of the exact ground-state wave function, ψ0(λ), of

the perturbed Hamiltonian

H(λ)

H + λO

≡
with respect to λ at λ = 0. When the trial functions are exact, (ψT , ˜ψ) = (ψ0, dψ0(λ)

dλ |λ=0),
the improved estimator reduces to a constant, namely the exact average for the observable.

In that case both statistical and systematic errors vanish. We have called this remarkable

property “Zero-Variance Zero-Bias property”(ZVZB). In the neighborhood of the exact

solution, a local expansion of the various quantities obtained from the approximate guess

(ψT , ˜ψ) can be done. It is found that there is a quadratic behavior in the errors δψ =

ψT

−

ψ0 and δψ′ = ˜ψ

ψ′
0. At the VMC level it reads

−

σ2( ˜O)

( ˜O

˜O

− h

iψT

2)2

≡ h

2

iψT

∼

O[δψδψ′]

(83)

35

and

and

(84)

(85)

(86)

(87)

(88)

∆ ˜O ≡ h

˜O

2

iψT

− h

O

iψ2

0 ∼

O[δψδψ′],

with a similar result in the DMC case. This important result generalizes the well-known

quadratic Zero-Variance Zero-Bias property of the energy where the local energy, EL =

HψT /ψT plays the role of the improved estimator:

σ2(EL)

O[δψ2]

∼

∆EL ∼

O[δψ2].

HψT
ψT

= E0.

˜O =

O

0.
iψ2

h

36

In the case of the energy we can write a Zero-Variance Zero-Bias equation deﬁning the

optimal trial wave function by imposing that the local energy reduces to a constant,

namely the exact energy

Of course, this equation is nothing but the Schroedinger equation. Here, the Zero-Variance

Zero-Bias equation for the observable is obtained by imposing that the improved observ-

able ˜O reduces to the exact average

By optimizing the three quantities (ψT , ˜ψ, ~v) so that ﬂuctuations of ˜O are minimal we can

obtain the optimal improved estimator for the observable. In practice, it is done in two

steps. First, functional forms for the trial functions ψT and ˜ψ are chosen in order to re-

produce the best as possible the exact solution of the zero-variance equations. The choice

of the vector ﬁeld ~v is done on physical grounds: It corresponds to the electron-coordinate

transformation, ~y = ~x + λ~v(~x) + O(λ2), correlating as much as possible the electron dis-

placements and the change of density associated with the external ﬁeld deﬁned by the

bare observable. Second, the various parameters entering the three quantities are opti-

mized by minimizing the ﬂuctuations of ˜O over a large but ﬁnite number of conﬁgurations

(typically, several thousands) drawn according to the VMC or DMC distributions.

It is important to emphasize that by using the improved estimators presented here it

is possible to get an accuracy on expectation values of observables which is comparable

to the very good one obtained for total energies. As it can be seen from Eqs.(83,84,85,86)

this is true when we are able to reduce the error on the derivative of the wave function

at the level of the error on the wave function itself, that is δψ

′

δψ

.

∼

Another fact worth pointing out is that there is not an unique way of constructing

improved estimators. Here, we have built our estimators by considering the derivative of

the variational, Eq.(18), or the exact DMC energy average, Eq.(51), We have also consid-

ered the possibility of making a coordinate transformation before making the derivative,

Eqs.(41,43). Of course, we can think of many other choices and/or transformations. Ul-

timately, the better strategy will depend very much on the speciﬁc problem considered.

Finally, in order to go beyond VMC or DMC calculations, we have shown that the

reduction of error of one order in δψ associated with the popular “hybrid”(or “second-

order”) formula mixing DMC and VMC averages can be generalized to the case of our

improved estimators:

˜ODM C

2

h

ψT ψ0 − h

i

˜OV M C

iψ2

T ∼ h

O

ψ0|

.

ψ0i

|

(89)

As an important application we have applied our formalism to the case of the com-

putation of forces for some simple diatomic molecules. In our preceding work on forces

[21] we have focused our attention only on the zero-variance part of the problem. More

precisely, we have employed i) a simpliﬁed version of the renormalized force, Eq.(71) ii.)

the minimal expression for ˜ψ leading to a ﬁnite variance, Eqs.(68,69), and iii.) the hybrid

formula mixing VMC and DMC calculations, Eq.(89). Results obtained for the vanishing

force at the equilibrium distance for a number of small diatomic molecules were reasonably

37

good. Here, we have illustrated that such a strategy is in fact not valid for describing the

global shape of the force curve. It has been shown that results depend very much on the

trial wave function used and, particularly, on the quality of the optimization process of the

numerous parameters of the trial wave function. As a result, the force curves obtained

are not regular as a function of the interatomic distance and important spectroscopic

quantities such as the equilibrium distance Re and the harmonic frequency ωe cannot

be obtained reliably. To get accurate curves we need not only to have a small amount

of statistical ﬂuctuations but also a control of the systematic error. By exploiting the

general ZVZB principle presented in this work it has been shown that obtaining accurate

curves is now possible. The basic ingredients are: i.) the use of a trial wave function for

the derivative, ˜ψ, built as a ﬁnite-diﬀerence of the trial wave function with respect to the

nuclear coordinate ii.) the use of a coordinate transformation in the spirit of the work of

Filippi and Umrigar [29] and, ﬁnally, iii.) the systematic minimization of the variance of

the improved estimator with respect to all the parameters entering the two trial functions

(ψT , ˜ψ), and the vector ﬁeld, ~v, associated with the coordinate transformation. Let us

emphasize that to get a well-balanced optimization of the two trial functions (leading to

smooth curves for the forces) , it is essential to reduce the variance of the improved estima-

tor for the force at the level of the variance of the local energy. Although such a condition

may appear as very diﬃcult to fulﬁll (local energies have usually very small variances),

we have shown that it is in fact possible thanks to the coordinate-transformation term.

Such a result is remarkable and is certainly one of most important practical aspect of the

approach proposed in this work.

Finally, let us remark that the price to pay with respect to the minimal scheme pre-

sented in our previous work [21] lies on the need of computing about 3Nnucl local energies

to calculate the various components of the force. However, we do not think it repre-

sents a major diﬃculty for the realistic applications to come.

Indeed, the few-percent

accuracy needed on average forces will be obtained with relatively small statistics and,

38

therefore, it will not be necessary to compute the force vector at each Monte Carlo step

(the expensive 3Nnucl-local energy-calculation step will be done rarely). In addition to

this, in applications where the nuclear geometry is varied during the simulation (Molecu-

lar Dynamics-type applications) it should also be possible to use suitable re-actualization

schemes to avoid re-computing entirely the 3Nnucl local energies for close nuclear conﬁg-

urations. Of course, the validity of these various strategies as well as the quality of the

improved estimators presented in this work need now to be checked for realistic applica-

tions involving many nuclear degrees of freedom.

Acknowledgments This work was supported by the “Centre National de la

Recherche Scientiﬁque” (CNRS).

39

REFERENCES

[1] A.J. Williamson, J.C. Grossman, R.Q. Hood, A. Puzder, and G. Galli, Phys. Rev.

[2] A. Puzder, A.J. Williamson, J.C. Grossman, and G. Galli, J. Chem. Phys. 117, 6721

[3] A. Puzder, A.J. Williamson, J.C. Grossman, and G. Galli, Phys. Rev. Lett. 88,

Lett. 89, 196803 (2002).

(2002).

097401 (2002).

[4] G. Belomoin, E. Rogozhina, J. Therrien, P.V. Braun, L. Abuhassan, M.H. Nayfeh,

L. Wagner, and L. Mitas, Phys. Rev. B 65, 193406 (2002).

[5] C. Filippi, S.B. Healy, P. Kratzer, E. Pehlke, and M. Scheﬄer 89, 166102 (2002).

[6] A.R. Porter, M.D. Towler, and R.J. Needs, Phys. Rev. B 64, 035320 (2001).

[7] L. Mitas, J. Therrien, R. Twesten, G. Belomoin, and M.H. Nayfeh, Appl. Phys. Lett.

[8] I.V. Ovcharenko, W.A. Lester,Jr.,C. Xiao, and F. Hagelberg, J. Chem. Phys. 114,

78, 1918 (2001).

9028 (2001).

016105 (2001).

(2000).

[9] A.J. Williamson, R.Q. Hood, and J.C. Grossman, Phys. Rev. Lett. 87, 246406 (2001)

[10] S.B. Healy, C. Filippi, P. Kratzer, E. Penev, and M. Scheﬄer, Phys. Rev. Lett. 87,

[11] P.R.C. Kent, M.D. Towler, R.J. Needs, and G. Rajagopal, Phys. Rev. B 62, 15394

[12] T. Torelli and L. Mitas, Phys. Rev. Lett. 85, 1702 (2000).

[13] L. Mitas, J.C. Grossman, I. Stich, and J. Tobik, Phys. Rev. Lett. 84, 1479 (2000).

40

[14] Y. Shlyakhter, S. Sokolova, A. L¨uchow, and J.B. Anderson, J. Chem. Phys. 110,

[15] See e.g. B.L. Hammond, W.A. Lester,Jr., and P.J. Reynolds in Monte Carlo Meth-

ods in Ab Initio Quantum Chemistry, World Scientiﬁc Lecture and course notes in

10725 (1999).

chemistry Vol.1 (1994).

[16] D.M. Ceperley and M.H. Kalos, in Monte Carlo Methods in Statistical Physics, edited

by K. Binder (Springer, Berlin, 1979), pp.145-194.

[17] K.S. Liu, M.H. Kalos, and G.V. Chester, Phys. Rev. A 10, 303 (1974).

[18] M. Caﬀarel and P. Claverie, J. Chem. Phys. 88, 1088 (1988).

[19] J. Casulleras and J. Boronat, Phys. Rev. B 52, 3654 (1995).

[20] R. Assaraf and M. Caﬀarel, Phys. Rev. Lett. 83 , 4682 (1999).

[21] R. Assaraf and M. Caﬀarel, J. Chem. Phys. 113,4028 (2000).

[22] B.H. Wells, Chem. Phys. Lett. 115, 89 (1985).

[23] C.A. Traynor and J.B. Anderson, Chem. Phys. Lett. 147, 389 (1988).

[24] C.J. Umrigar, Int. J. Quantum Chem. 23, 217 (1989).

[25] Z. Sun, W.A. Lester,Jr.,and B.L. Hammond, J. Chem. Phys. 97, 7585 (1992).

[26] J. Vrbik, D.A. Lagare and S.M. Rothstein, J. Chem. Phys. 92, 1221 (1990).

[27] J. Vrbik and S.M. Rothstein, J. Chem. Phys. 96, 2071 (1991).

[28] P. Belohorec, S.M. Rothstein, and J. Vrbik, J. Chem. Phys. 98, 6401 (1993)

[29] C. Filippi and C.J. Umrigar, Phys. Rev. B 61, R16291 (2000).

[30] R. Baer, J. Chem. Phys. 113, 473 (2000).

41

[31] C. J. Umrigar, Int J. Quantum Chem., Symp. 23, 217 (1989).

[32] M. Casalegno, M. Mella, and A.M. Rappe, J. Chem. Phys. 118, 7193 (2003).

[33] P. Pulay, Mol. Phys. 17 197 (1969).

[34] E.L. Pollock and D.M. Ceperley, Phys.Rev. B 30, 2555 (1984).

[35] M. Caﬀarel and P. Claverie, J. Stat. Phys. 43, 797 (1986).

[36] C. J. Umrigar, K. G. Wilson, and J. W. Wilkins, Phys. Rev. Lett. 60, 1719 (1988).

[37] K. P. Huber and G. Herzberg, Molecular Spectra and Molecular Structure IV, Con-

stants of Diatomic Molecules (van Nostrand Reinhold, New York, 1979).

[38] A. H. Wapstra and G. Audi, Nucl. Phys. A 432, 1 (1985).

42

TABLE I. VMC, DMC, and Hybrid estimates of the equilibrium geometry Re (a.u.) and

harmonic frequency ωe (cm−1). The atomic isotopic masses takena are 1.007825035 amu for 1H

TABLES

and 7.0160030 amu for 7Li.

H2

1.463(12)

1.426(13)

1.395(15)

1.401

4194(130)

4432(165)

4662(205)

4395.2

LiH

3.111(17)

3.056(6)

3.001(15)

3.015

1559(40)

1549(22)

1519(31)

1405.65

Li2

5.346(27)

5.200(16)

5.068(27)

5.051

366(9)

373(5)

387(8)

351.4

Re (VMC)

Re (DMC)

Re (Hybrid)

Re (Exp.)b

ωe (VMC)

ωe (DMC)

ωe (Hybrid)

ωe (Exp.)b

a Ref. [38]

b Ref. [37]

43

TABLE II. VMC, DMC, and Hybrid systematic (bias) and statistical errors for the total

energy and various force estimators for Li2 at R=5.051 a.u. The VMC variances, σ2 (VMC),

are also given.

EL
h

ex and
i

F
h

ex denote the exact total energy,
i

EL
h

ex=-14.9954 a.u. and exact
i

force

F
h

ex = 0. (equilibrium geometry), respectively. To facilitate comparisons between energy
i

and force results all averages are given with ﬁve signiﬁcant ﬁgures after the decimal point and

statistical errors are given on the ﬁfth decimal place (magnitude 10−5). Statistical errors on

VMC variances are on the last digit.

Estimator

VMC Average DMC Average

Hybrid

σ2(VMC)

EL

EL

ex
i

− h

aF

F

ex
i
b ˜FZV [ψT , ˜ψmin]

− h

c ˜FZV ZB[ψT , ˜ψmin]

F

− h

− h

ex
i
F

ex
i
F

ex
i

d ˜F [ψT , ˜ψmin

˜ψDeriv]
|

− h
e ˜FZV ZB[ψT , ˜ψDeriv, ~v = 0]

e ˜FZV ZB[ψT , ˜ψDeriv, ~v]

F

ex
i

− h
F

− h

ex
i

0.03871(32)

0.00531(50)

-

0.113(5)

0.18217(23216) 0.15462(12293) 0.12707(33185)

+

∞

-0.06352(84)

-0.04003(151)

-0.01654(313)

1.27(5)

-0.05802(104)

-0.02484(184)

0.00834(382)

1.3(2)

0.00619(109)

0.02993(187)

0.05367(390)

2.8(1)

0.00871(218)

0.00474(147)

0.00077(366)

14(3)

0.00692(9)

0.00358(19)

0.00024(39)

0.016(1)

a. Eq.(66)

b. Eq.(71)

c. Eq.(72)

d. Eq.(81)

e. Eq.(78)

44

FIGURE CAPTIONS

•

•

•

•

•

•

Fig.1 H2 molecule. Variational Monte Carlo (VMC) energies (open squares), Diﬀu-

sion Monte Carlo (DMC) energies (ﬁlled squares) and exact non-relativistic curve

(solid line). The dotted line between VMC results is a simple linear interpolation

to guide the eye.

Fig.2 LiH molecule. Variational Monte Carlo (VMC) energies (open squares),

ﬁxed-node Diﬀusion Monte Carlo (DMC) energies (ﬁlled squares), and exact non-

relativistic curve (solid line). The dotted line between VMC results is a simple linear

interpolation to guide the eye.

Fig.3 Li2 molecule. Variational Monte Carlo (VMC) energies (open squares),

ﬁxed-Node Diﬀusion Monte Carlo (DMC) energies (ﬁlled squares), and exact non-

relativistic curve (solid line). The dotted line between VMC results is a simple linear

interpolation to guide the eye.

Fig.4 Various VMC average forces for Li2. Filled squares with large error bars:

F

,

Eq.(66). Open squares joined by the dashed line:

Circles joined with the dotted line:

˜FV M C−ZV ZB[ψT , ˜ψmin]
i

h

exact non-relativistic force curve.

i
h
, Eq.(71);

h

˜FV M C−ZV [ψT , ˜ψmin]
i
, Eq.(72). Solid line:

Fig.5 Li2 molecule. Average forces using ˜FZV ZB( ˜ψT , ˜ψmin),Eq.(72,73,74). VMC

average:

lowest curve with open circles. DMC average:

intermediate curve with

ﬁlled squares. Hybrid average: highest curve with open squares. Solid line: exact

non-relativistic force curve. Dashed lines between QMC results are a simple linear

interpolation to guide the eye.

Fig.6

VMC

force

for

Li2.

Lowest

irreg-

ular curve with ﬁlled squares:

, Eq.(71). Upper curve with

˜FV M C−ZV [ψT , ˜ψmin]
i

h

45

open squares:

˜FV M C−ZV [ψT , ˜ψDeriv, ~v]
i

h

, Eq.(78). Solid line: exact non-relativistic

force curve.

Fig.7 VMC force for Li2. Open squares: Average VMC forces from estimator (78)

using the Jastrow-RHF one-determinant wave function. Open circles: Average VMC

forces from estimator (78) using the Jastrow-VB six-determinant wave function.

Solid line: exact non-relativistic force curve.

Fig.8 DMC force for Li2. Open squares: Average ﬁxed-node DMC forces using

the Jastrow-RHF one-determinant wave function. Open circles: Average ﬁxed-node

DMC forces using the Jastrow-VB six-determinant wave function. Solid line: exact

non-relativistic force curve.

Fig.9 Hybrid force for H2. Solid line: exact non-relativistic force curve.

Fig.10 Hybrid force for LiH. Solid line: exact non-relativistic force curve.

Fig.11 Hybrid force for Li2. Solid line: exact non-relativistic force curve.

•

•

•

•

•

46

-1

)
.
u
.
a
(
 
y
g
r
e
n
E

-1.05

-1.1

-1.15

FIGURES

H2

Exact  
VMC
DMC

1

FIG. 1.

2

3

R (a.u.)

47

-7.98

-8

-8.02

-8.04

-8.06

)
.
u
.
a
(
 
y
g
r
e
n
E

LiH

Exact  
VMC
DMC

48

2

3

FIG. 2.

4

R (a.u.)

5

6

Li2

Exact  
VMC
FN-DMC

-14.88

-14.92

-14.96

)
.
u
.
a
(
 
y
g
r
e
n
E

-15

3

4

FIG. 3.

5

6
R (a.u.)

7

8

49

Li2

)
.
u
.
a
(
 
e
c
r
o
f
 
e
g
a
r
e
v
a
 
C
M
V

0.2

0

-0.2

-0.4

Exact

<F>
]>
]>

min

min

 ~
 FVMC-ZV [ ψ
<
 ~
 FVMC-ZVZB [ ψ
<

, ~ψ
T
, ~ψ

T

3

4

6
5
R (a.u.)

7

8

FIG. 4.

50

0.1

0.05

0.

-0.05

-0.1

)
.
u
.

a
(
 
e
c
r
o
f
 
e
g
a
r
e
v
A

Exact
VMC
DMC
Hybrid

51

-0.15

3

4

FIG. 5.

5

6

R (a.u.)

7

8

Exact

<

 ~
 FVMC-ZVZB [ ψ
T,   ~ ψ

 ~
FVMC-ZVZB  [ ψ

  ~
 ψ
T,
Deriv,   →

min] >
v ] >

<

Li2

)
.
u
.
a
(
 
e
c
r
o
f
 

e
g
a
r
e
v
a
C
M
V

 

0.08

0.04

0

-0.04

3

4

5

6

R (a.u.)

FIG. 6.

7

8

52

0.1

0.08

0.06

0.04

0.02

0.

-0.02

)
.
u
.

a
(
 
e
c
r
o
F

Exact
Jastrow-RHF VMC
Jastrow-VB VMC

Li2

4

5

FIG. 7.

6
R (a.u.)

7

8

53

0.1

0.08

0.06

0.04

0.02

0.

-0.02

)
.
u
.

a
(
 
e
c
r
o
F

Exact
Jastrow-RHF DMC
Jastrow-VB DMC

Li2

4

5

FIG. 8.

6
R (a.u.)

7

8

54

Exact
Hybrid

H2

1.

)
.
u
.

a
(
 
e
c
r
o
F

0.5

0.

1

FIG. 9.

2
R (a.u.)

3

55

0.2

Exact
Hybrid

LiH

)
.
u
.

a
(
 
e
c
r
o
F

0

2

3

FIG. 10.

4
5
R (a.u.)

6

56

Exact
Hybrid 

Li2

0.1

0.08

0.06

0.06

0.02

0.

-0.02

)
.
u
.

a
(
 
e
c
r
o
F

4

5

6

R (a.u.)

FIG. 11.

7

8

57

