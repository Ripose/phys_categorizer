2
0
0
2
 
t
c
O
 
8
1
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
0
0
1
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

(p,q)-Sheaves and the Representability Problem
A. I. Panin
Chemistry Department, St.-Petersburg State University,
University prospect 26, St.-Petersburg 198504, Russia
e-mail: andrej@AP2707.spb.edu

ABSTRACT: General properties of new models of the electronic Fock spaces
based on the notion of (p, q)-sheaves are studied.
Interrelation between simple
sheaves and density operators is established. Explicit expressions for the trans-
formed reduced Hamiltonians in terms of the standard creation-annihilation op-
erators are presented. General scheme of parametrization of p-electron states by
κ-electron means (κ = 2, 3, . . .) is described and studied in detail for the case
of sheaves induced by κ-electron wavefunctions.
It is demonstrated that under
certain conditions p-electron problem may be reformulated as the eigenvalue prob-
lem in κ-electron space equipped with certain p-electron metric. Simple numerical
examples are given to illustrate our approach.

Key words: representability problem; density operators; CI method;
electron correlation.

Introduction

In present work we continue study of properties of new models of p-
electron sections of the Fock spaces introduced in our previous work [1].
These models are based on the notion of (p, q)-sheaves that can be considered
as q-electron representation of p-electron states (q ≤ p). Figuratively speak-
ing, the space of all (p, q)-sheaves is a model of p-electron space ‘ready for
q-electron interactions’. This means that no contraction is required for calcu-
lation of matrix elements of arbitrary q-electron operators. The contraction
is replaced by the summation over q-electron functions (germs) constituting
the sheaf.

In the second section necessary basic deﬁnitions are given.
In the third section general properties of simple (p, q)-sheaves are studied.
Important notion of vector Z-cell is introduced. Explicit characterization
of imagies of simple sheaves with respect to diﬀerent compositions of the
assembling-disassembling mappings is given.

In the fourth section it is shown that there exists a one-to-one correspon-
dence (up to arbitrary overall phase prefactor) between simple sheaves and
a certain class of density operators.

1

In the ﬁfth section the explicit expression for the transformed reduced

Hamiltonian in terms of the creation-annihilation operators is obtained.

In the sixth section the notion of p-electron metric in κ-electron space
(κ = 1, 2, 3, . . .) is introduced and it is demonstrated that under certain
conditions p-electron problem reduces to the eigenvalue problem in κ-electron
space equipped with p-electron metric.

In the seventh section orbital representation of (p, q)-sheaves is discussed
and relevant formulas for metrics and Hamiltonians are derived in terms of
molecular orbitals.

The eighth section is dedicated to numerical testings.

Basic Deﬁnitions.

For ﬁxed basis set of n orthonormal spin orbitals the corresponding ﬁnite-
dimensional Fock space Fn is spanned by determinants |Ri where R runs over
all subsets of the spin-orbital index set. Basis determinants will be labelled
by subsets and all sign conventions connected with their representation as the
Grassman product of ordered spin-orbitals will be included in the deﬁnition
of the creation-annihilation operators and in the deﬁniton of speciﬁc set-
theoretical operation ∆K, K ⊂ N that was introduced in [2] and studied in
detail in [3].Here N is the spin-orbital index set.

For any (p + q)-element subset Z of the index set N let us denote by the
symbol Fn,q(Z) the following subspace of the q-electron sector of the Fock
space:

Fn,q(Z) =

C|Si

(1)

where C is the ﬁeld of complex numbers. Let us deﬁne the set

Bn,p,q = {(Z, S) ⊂ N × N : |Z| = p + q&|S| = q&S ⊂ Z},

(2)

and the equivalence relation on this set

(Z, S) ∼ (Z ′, S′) ⇔ Z\S = Z ′\S′.

(3)

The set of the corresponding equivalence classes contains
in each equivalence class there are

elements.

elements and

n
p

(cid:0)

(cid:1)

(q)

S⊂Z
M

n−p
q

(cid:0)

(cid:1)

2

Deﬁnition. Family {ψZ}Z⊂N of q-electron functions, ψZ ∈ Fn,q(Z), is
called a sheaf of q-electron germs of p-electron wavefunction, or just a (p, q)-
sheaf, if the mapping

(Z, S) → (−1)|(Z\S)∩∆Z |hS|ψZi, |Z| = p + q, |S| = q, S ⊂ Z

(4)

is constant on the equivalence classes of the set Bn,p,q modulo the equivalence
relation (3). Here ∆Z is the mentioned above set-theoretical operation that
is used to reduce manipulations with sign prefactors in Grassman algebra to
pure set-theoretical ones.

The set of all (p, q)-sheaves is denoted as Sn,p,q.
In paper [1] it was demonstrated that there exists a one-to-one correspon-
dence between the set of all (p, q)-sheaves and vectors of the p-electron sector
of the Fock space. The mapping

(p)

R⊂N
X

(q)

S⊂Z
X

sn,p,q :

CR|Ri → {ψZ}Z⊂N

where

|ψZi =

(−1)|(Z\S)∩∆Z |CZ\S|Si.

(5)

(6)

is called the disassembling mapping and is used to transfer all relevant struc-
tures from the p-electron sector of the Fock space on the set of all (p, q)-
sheaves. The linear structure is transfered as

sn,p,q(

λiΨ(i)) =

λiΨ(i))Z

=

λi{ψ(i)

Z }Z⊂N .

(7)

i
X

(
(

i
X

)Z⊂N

i
X

This equality just expresses the fact the due to the linear character of the
gluing conditions (4) arbitrary linear combination of (p, q)-sheaves is a (p, q)-
sheaf.

The inner product (Euclidean structure) is deﬁned as

h{ψZ}Z⊂N |{φZ}Z⊂N i =

hψZ|φZi

(8)

and it is consistent with the inner product of the corresponding p-electron
wavefunctions.

(p+q)

Z⊂N
X

1
n−p
q

(cid:0)

(cid:1)

3

The inverse to sn,p,q is called the assembling mapping and is used to restore
p-electron vectors from (p, q)-sheafs with the aid of the gluing conditions (4).
In paper [1] it was mentioned that from the very beginning it seems rea-
sonable to associate with each p-electron wavefunction Ψ its sheaf sn,p,q(Ψ)
and co-sheaf sn,n−p,q(IΨ) where I : |Ri → |N\Ri is the particle-hole in-
volution. However, since general properties of sheaves and co-sheaves are
identical, and actual diﬀerence appears only on the level of evaluation of re-
duced Hamiltonian matrix elements, we study properties of sheaves, keeping
in mind that the analogous properties are valid also for co-sheaves.

The family

{πn,p,q(Z) : {ψZ ′}Z ′⊂N → ψZ}Z⊂N

(9)

involves linear mappings that perform projections of the vector space Sn,p,q
on the vector spaces Fn,q(Z).

Let us suppose that some q-electron wavefunction ψZ ∈ Fn,q(Z) is chosen:

(q)

(p)

ψZ =

cS|Si =

(−1)|R∩∆Z | ¯CR|Z\Ri

S⊂Z
X

R⊂Z
X

where R = Z\S and

¯CR = (−1)|R∩∆Z |cS

(10)

(11)

Since Fn,q(Z) is isomorphic to Fn,p(Z), we can easily lift q-electron wave-
function to the level p using, for example, the linear mapping:

up
q(Z) :

(−1)|R∩∆Z | ¯CR|Z\Ri →

¯CR|Ri

(12)

(p)

R⊂Z
X

(p)

R⊂Z
X

Subsequent disassembling of p-electron wavefunction up

q(Z)ψZ gives us
(p, q)-sheaf that may be considered as generated by q-electron wavefunction
ψZ. Compositions sn,p,q ◦ up
q(Z) = jn,p,q(Z) constitute the family of linear
injective mappings

jn,p,q(Z) : Fn,q(Z) → Sn,p,q

(13)

that are right inverses (sections) of the projections (9).

Deﬁnition.(p, q)-sheaf generated by q-electron wavefunction ψZ is called

simple and is denoted as {ψZZ ′}Z ′⊂N .

diﬀerent q-electron wavefunctions.

It is to be noted that the same simple (p, q)-sheaf may be generated by

4

(p, q)-sheaves corresponding to single determinant p-electron wavefunc-
tions are called determinant sheaves. The characteristic property of deter-
minant sheaves is: simple (p, q)-sheaf is the determinant one if and only if it
is generated by any of its nonzero germ (see[1]).

It is clear that the assembling and disassembling mappings may be used
to establish isomorphism between operator spaces over Fn,p and over Sn,p,q.
Indeed, if h ∈ EndC(Fn,p) then the mapping

h → sn,p,q ◦ h ◦ s−1

n,p,q

(14)

is the required isomorphism. For physically relevant operators it is usually
possible to express their matrix elements between two (p, q)-sheaves as a sum
of matrix elements of certain q-electron operators between germs of these
sheaves. In our previous paper [1] the electronic Hamiltonian H was handled
in such a way. Namely, due to the speciﬁc form of H, its matrix element
between two (p, q)-sheaves may be written as

(p+q)

Z⊂N
X

1
n−p
q

(cid:0)

(cid:1)

h{φZ}Z⊂N |H|{ψZ}Z⊂N i =

hφZ|A−1(n, p, q)Hp→q|ψZi,

(15)

where

Hp→q =

hi|h|jia†

i aj +

q − 1
p − 1

"

i,j
X

p
2
q
(cid:0)
2
(cid:0)

(cid:1)
(cid:1)

1
2

hij|

1
r12

i,j,k,l
X

|klia†

i a†

jalak

(16)

#

is the so-called reduced Hamiltonian and A(n, p, q) is introduced in [3] oper-
ator acting on the operator space Fn,q ⊗ F ∗

n,q.

Properties of Simple Sheaves.

With each function ψZ ∈ Fn,q(Z) written in the form of Eq.(10) let us

associate two sets:

Ip(ψZ) = {R ⊂ Z : |R| = p & ¯CR 6= 0}

(17)

(18)

Let {ψZZ ′}Z ′⊂N be some simple (p, q)-sheaf generated by q-electron wave-

function ψZ . Then any germ of this sheaf may be written as

L(ψZ ) =

R

[R∈Ip(ψZ )

5

ψZZ ′ =

(−1)|R′∩∆Z′ | ¯CR′|Z ′\R′i,

(19)

(p)

R′⊂Z ′∩Z
X

where the coeﬃcients ¯CR′ are given by Eq.(11).

Proposition 1. q-electron wavefunction generating simple (p, q)-sheaf is

necessarily a germ of this sheaf.

Proof. Follows directly from the relation

πn,p,q(Z) ◦ jn,p,q(Z) = idFn,q(Z)

where idFn,q(Z) is the identity operator over Fn,q(Z)(cid:4)

Proposition 2.

q-electron functions ψZ1 and ψZ2 generate the same

simple (p, q)-sheaf if and only if

(i) Ip(ψZ1) = Ip(ψZ2);
(ii) For any R ∈ Ip(ψZ1) functions ψZ1 and ψZ2 are subject to the following

”gluing” conditions

(−1)|R∩∆Z1 |hZ1\R|ψZ1i = (−1)|R∩∆Z2 |hZ2\R|ψZ2i.

Proof. Let us write down q-electron functions ψZ1 and ψZ2 in the form

of Eq.(10)

ψZi =

(−1)|R∩∆Zi | ¯C (i)

R |Zi\Ri (i = 1, 2)

(p)

R⊂Zi
X

From the equality {ψZ1Z ′}Z ′⊂N = {ψZ2Z ′}Z ′⊂N it follows that ψZ1 = ψZ2Z1
and ψZ2 = ψZ1Z2. These equalities together with Eq.(19) imply that ¯C (1)
R =
¯C (2)

R , and, consequently, condition (i) and (ii) are fulﬁlled.

Now let us suppose that for given functions ψZ1 and ψZ2 the conditions

(i) and (ii) hold true. Then from (i) it follows that for arbitrary Z ′ ⊂ N

ψZiZ ′ =

(−1)|R∩∆Z′ | ¯C (i)

R |Z ′\Ri,

(p)

R⊂Z ′∩Z1∩Z2
X

where i=1,2. Use of conditions (ii) immediately leads to the equality

{ψZ1Z ′}Z ′⊂N = {ψZ2Z ′}Z ′⊂N (cid:4)
Proposition 3. The number of q-germs generating simple (p, q)- sheaf

{ψZZ ′}Z ′⊂N is equal to

n − |L(ψZ)|
p + q − |L(ψZ)|

(cid:19)

(cid:18)

6

Proof. By deﬁnition, L(ψZ) ⊂ Z. For any Z1 ⊃ L(ψZ ) the germs ψZ

and ψZZ1 obviously satisfy the conditions of proposition 2 (cid:4)

Corollary 1. For any determinant sheaf |L(ψZ)| = p and it is generated

by any of its

n−p
q

germs.

Corollary 2. Non-determinant (p, 1)-sheaf has only one generator.
Proof. For non-determinant sheaves |L(ψZ)| should necessarily be equal

(cid:1)

(cid:0)

to p + 1 (cid:4)

Deﬁnition.

q-electron functions ψZ1 and ψZ2 are called p-equivalent

(ψZ1

p
∼ ψZ2) if they generate the same simple (p, q)-sheaf.

Proposition 4. Let {ψZZ ′}Z ′⊂N be simple (p, q)-sheaf generated by q-
electron wavefunction ψZ. Then any q-electron function from Fn,q(Z) is
orthogonal to all ψZZ ′ with Z ′ 6= Z.

Proof. Expansion of arbitrary q-electron function from Fn,q(Z) (see
Eq.(10)) involves q-electron determinants |Z\Ri where R ⊂ Z. From Eq.(19)
it follows that each q-germ ψZZ ′ of the sheaf under consideration is expanded
via q-electron determinants |Z ′\R′i.
6= Z and
R′ ⊂ Z ′ ∩ Z implies Z ′\R′ 6⊂ Z (cid:4)

It is easy to see that Z ′

Corollary. q-germs generating simple (p, q)-sheaf are mutually orthogo-

.

nal.

Let us consider a family of k simple (p, q)-sheaves {ψZ ′

iZ ′}Z ′⊂N , i =

1, 2, . . . , k and sort out this family in the following manner:

iZ1

iZ2

1, Z ′

2, . . . , Z ′

Select some subset Z1 from the family Z ′

k and collect all (p, q)-
i. The resulting subfamily will be denoted as

sheaves such that ψZ ′
{ψ(i1)

sheaves such that ψZ ′
{ψ(i2)

p
∼ ψZ ′
Z1Z ′}Z ′⊂N , i1 = 1, 2, . . . , k1;
From the rest of the initial family select subset Z2 and collect all (p, q)-
i. The resulting subfamily will be denoted as

p
∼ ψZ ′
Z2Z ′}Z ′⊂N , i2 = 1, 2, . . . , k2.
Repeating the last step till the initial family is exausted, we arrive ﬁnally
at the family {ψ(il)
ZlZ ′}Z ′⊂N , il = 1, 2, . . . , kl, l = 1, 2, . . . ,. By construction,
each subfamily of this family corresponding to some ﬁxed index l involves
simple (p, q)-sheaves generated by q-germs from the vector space Fn,q(Zl).
As a result, the problem of orthogonalization of simple sheaves within this
subfamily seems to be not very complicated, especially if one takes into ac-
count the following assertion.
Proposition 5. Let {ψ(1)

ZZ ′}Z ′⊂N be simple (p, q)-sheaves

ZZ ′}Z ′⊂N and {ψ(2)

7

generated by q-electron functions ψ(1)

Z , ψ(2)

Z ∈ Fn,q(Z). Then

h{ψ(1)

ZZ ′}Z ′⊂N |{ψ(2)

ZZ ′}Z ′⊂N i = hψ(1)

Z |ψ(2)

Z i.

(20)

Proof. Direct calculation based on the deﬁnition (8) of the inner product

leads readily to the equality required (cid:4)

The question when linear combination of simple sheaves is simple is of
a certain interest in connection with the problem of selection of linearly
independent simple sheaves. The answer to this question is given by the
following assertion.

Proposition 6. Linear combination

λi{ψZiZ ′}Z ′⊂N

k

i=1
X

R 6⊂ Z ⇒

λi ¯C (i)

R = 0,

Z1...Zk
R

Xi∈I

I Z1...Zk
R

= {1 ≤ i ≤ k : Zi ⊃ R}.

of simple (p, q)-sheaves is simple if and only if there exists (p + q)-element
subset Z ⊂ N such that

where

in the form

Proof. Arbitrary linear combination of simple sheaves may be written

k

i=1
X

λi{ψZiZ ′}Z ′⊂N = 


(p)

R′⊂Z ′
X

|Z ′\R′i(−1)|R′∩∆Z′ |






Z1...Zk
Xi∈I
R′

λi ¯C (i)

R′ 

.

Z ′⊂N









If we suppose that this sheaf is simple then there should exist index set
Z ⊂ N such that the q-germ



|Z\Ri(−1)|R∩∆Z |

(p)

R⊂Z
X






Z1...Zk
R

Xi∈I

λi ¯C (i)

R 




generates this sheaf. It can, however, be true if and only if the coeﬃcients
by the basis determinants |Z ′\R′i in expansion of q-germs are equal to zero
for all R′ 6⊂ Z (cid:4)

8

Corollary. Arbitrary linear combination of determinant (p, q)-sheaves

generated by q-germs

ψZi = (−1)|Ri∩∆Zi | ¯C (i)

Ri |Zi\Rii

is simple if and only if there exists index set Z ⊂ N such that Z ⊃

Ri,

or, in other words, |

Ri| ≤ p + q.

k

i=1
S

Proof. Without loss of generality we may assume that the coeﬃcients λi
of linear combination of determinant sheaves are non-zero. Let us suppose
that for any subset Z ⊂ N there exists Rj 6⊂ Z. In this case

k

i=1
S

λi ¯C (i)

Rj = λj ¯C (j)

Rj 6= 0

Z1...Zk
Xi∈I
Rj

and, consequently, the linear combination under consideration can not be
simple (cid:4)

Deﬁnition. The image of Fn,q(Z) with respect to the monomorphism
jn,p,q(Z) is called the vector Z-cell of the vector space of all (p, q)-sheaves
and is denoted as Jn,p,q(Z).

It is pertinent to note that Z-cells depend on the MSO basis chosen.
Each vector Z-cell is a

-dimensional subspace of Sn,p,q. The set of

p+q
p

all simple (p, q)-sheaves in Sn,p,q is a union of its vector Z-cells:
(cid:1)

(cid:0)

(p+q)

Jn,p,q =

Jn,p,q(Z).

(21)

Z⊂N
[
It is easy to show that the set Jn,p,q generates the vector space of all (p, q)-
sheaves (see [1]).

The set of simple (p, q)-sheaves {ψZZ ′}Z ′⊂N ∈ Jn,p,q(Z) such that

where k = p + q, p + q − 1, . . . , p, will be denoted as J (k)
each Z-cell admits the following ﬁltration

n,p,q(Z). It is clear that

Jn,p,q(Z) = J (p+q)

n,p,q (Z) ⊃ J (p+q−1)

n,p,q

(Z) ⊃ . . . ⊃ J (p)

n,p,q(Z)

(22)

|L(ψZ)| ≤ k

9

Topological dimension of J (k)
. Thus, each Z-cell possesses
k-faces (borders) where simple (p, q)-sheaves from diﬀerent cells are situated.
It is likely that ﬁltration (21) may serve as a starting point for further more
advanced analysis of geometry of the set Jn,p,q.

n,p,q(Z) is equal to

k
p

(cid:1)

(cid:0)

Now let us consider the connection between spaces Sn,p,q with diﬀerent q.

There exist obvious isomorphisms

Sn,p,q

s−1
n,p,q−→ Fn,p

sn,p,q±1−→ Sn,p,q±1.

(23)

(24)

Proposition 7. The image of any simple (p, q)-sheaf from Jn,p,q with
n,p,q is simple (p, q + 1)-sheaf, and for

respect to the isomorphism sn,p,q+1 ◦ s−1
k = p + q, p + q − 1, . . . , p

sn,p,q+1 ◦ s−1
n,p,q

J (k)
n,p,q

⊂ J (k)

n,p,q+1,

that is the image of Jn,p,q belongs to the border of Jn,p,q+1.

(cid:0)

(cid:1)

Proof. Let ψZ ∈ Fn,q(Z) generate simple (p, q)- sheaf {ψZZ ′}Z ′⊂N and

¯CR|Ri = ΨZ. For any index i ∈ N\Z the p-electron wave-

up
q(Z)ψZ =

function

(p)

R⊂Z
P

ΨZ∪{i} =

¯CR|Ri = ΨZ

can be disassembled to give simple (p, q + 1)-sheaf with germs

ψZ∪{i}Z ′ =

(−1)|R∩∆Z′ | ¯CR|Z ′\Ri

where |Z ′| = p + q + 1. It is clear as well that the choice of concrete index
i is irrelevant. Indeed, for any index j ∈ N\Z, (q + 1)-germ ψZ∪{i}Z∪{j} is
p-equivalent to ψZ∪{i} (cid:4)

Lowering of simple (p, q)-sheaf to the level q −1 leads, in general, to linear

combinations of simple (p, q − 1)-sheaves.

Proposition 8. Let {ψZZ ′}Z ′⊂N be simple (p, q)-sheaf generated by q-

germ ψZ. Then

sn,p,q−1 ◦ s−1

n,p,q ({ψZZ ′}Z ′⊂N ) =

{ψZ\{k}Z ′′}Z ′′⊂N .

(25)

1
q

k∈Z
X

10

(p)

R⊂Z∪i
X
(R∋i)

(p)

R⊂Z ′∩Z
X

Proof. Disassembling of p-electron function ΨZ = up

q(Z)ψZ, |Z| = p + q,

gives (p, q − 1)-sheaf with germs (see Eq.(6))

ψZ ′′ =

(−1)|R∩∆Z′′ | ¯CR|Z ′′\Ri,

(26)

(p)

R⊂Z ′′∩Z
X

where |Z ′′| = p + q − 1.

On the other hand, let us consider the sum

{ψZ\{k}Z ′′}Z ′′⊂N =

ψZ\{k}Z ′′

,

(27)

k∈Z
X

(

k∈Z
X

)Z ′′⊂N

where simple (p, q − 1)-sheaf {ψZ\{k}Z ′′}Z ′′⊂N involves (q − 1)-germs

ψZ\{k}Z ′′ =

(−1)|R∩∆Z′′ | ¯CR|Z ′′\Ri.

(p)

XR⊂[Z ′′∩(Z\{k})]

Thus, (p, q − 1)-sheaf on the right-hand side of Eq.(27) involves (q − 1)-

germs

(p)

(−1)|R∩∆Z′′ | ¯CR|Z ′′\Ri.

k∈Z
X

XR⊂[Z ′′∩(Z\{k})]

The contribution to this sum from k 6∈ Z ′′ ∩Z is equal to (p+q −|Z ′′ ∩Z|)ψZ ′′
is given by Eq.(26). On the other hand, for each ﬁxed R ⊂
where ψZ ′′
Z ′′ ∩ (Z\{k}) there exist |Z ′′ ∩ Z| − p diﬀerent k ∈ Z ′′ ∩ Z. As a result,

{ψZ\{k}Z ′′}Z ′′⊂N = q {ψZ ′′}Z ′′⊂N

(cid:4)

k∈Z
X

It is to be noted that if L(ψZ ) is a proper subset of Z then for any
ΨZ\{k}

k ∈ Z\L(ψZ) (the choice of k is irrelevant), sn,p,q−1 (ΨZ) = sn,p,q−1
is simple (p, q − 1)-sheaf.

Corollary. For any admissible q and any κ < q

(cid:0)

(cid:1)

sn,p,κ ◦ s−1

n,p,q ({ψZZ ′}Z ′⊂N ) =

{ψZ\KZ ′′}Z ′′⊂N .

(28)

Very important is the following statement that is contrary in a certain sense
to the Proposition 8.

κ!
q!

(q−κ)

K⊂Z
X

11

Proposition 9. If Z ⊂ N, |Z| = p + q, and for each (q − κ)- element

subset K ⊂ Z

(p)

XR⊂Z\K

then the image of the sum

ψZ\K =

(−1)|R∩∆Z\K | ¯C (K)

R |Z\K\Ri,

(29)

(q−κ)

K⊂Z
X

{ψZ\KZ ′}Z ′⊂N

with respect to the assembling mapping s−1

n,p,κ is p-electron wavefunction

(p)

(q−κ)

ΨZ =



¯C (K)

R 

|Ri,

XK⊂Z\R
and its disassembling with the aid of sn,p,q gives simple (p, q)-sheaf generated
by the q-germ





R⊂Z
X

(−1)|R∩∆Z |

(p)

R⊂Z
X

(q−κ)





XK⊂Z\R

¯C (K)

R 

|Z\Ri.



Proof. By direct calculation.

using κ-electron means (κ < q).

This Proposition can be used to parametrize subsets of the sets Jn,p,q(Z)

(30)

(31)

Simple Sheaves and Density Operators

Deﬁnition. The quadratic mapping dq : Sn,p,q → Fn,q ⊗ F ∗

n,q deﬁned by

dq ({ψZ}Z⊂N ) =

|ψZihψZ|

(32)

(cid:0)
is called the density mapping of order q. The value of this mapping at some
(p, q)-sheaf is called the q-density operator associated with this sheaf.

(cid:1)

The problem of description of the set dq (Sn,p,q) is called the pure repre-
sentability problem and in slightly diﬀerent form was formulated in the very

1
n−p
q

(p+q)

Z⊂N
X

12

ﬁrst papers by Coleman [4, 5, 6, 7]. By an abuse of notation the same symbol
dq will be used for the density mapping deﬁned by Eq.(32) and for elements
of the set dq (Sn,p,q)

Let us consider density operators corresponding to simple sheaves. From

Eq.(19) it follows that

|ψZihψZ| +

|ψZZ ′ihψZZ ′| + ||ψZ||2P (q)

,

N \Z

(33)

=

1
n−p
q






(cid:0)

(cid:1)

where

dq ({ψZZ ′}Z ′⊂N )

(p+q)

Z′⊂N
X
(p<|Z′∩Z|<p+q)

(q)

P (q)
X =

|SihS|




(34)

S⊂X
X
is the projector associated with the index set X ⊂ N. Note that the rep-
resentation (33) of the density operator associated with some given simple
sheaf is not unique (see Proposition 3).

Complete characterization of q-density operators corresponding to simple
(p, q)-sheaves is given by the assertion that readily follows from Eq.(33) and
Proposition 4.

Proposition 10. q-electron operator dq is associated with simple (p, q)-

sheaf if and only if there exists (p + q)-element subset Z ⊂ N such that

(i) the operator P (q)

Z dqP (q)

Z corresponds to some (not necessarily normal-

ized) pure q-electron state, that is P (q)

Z dqP (q)

Z = |ψZihψZ|;

(p+q)

|ψZZ ′ihψZZ ′|,

(ii)

I − P (q)
Z
(cid:16)

dq

I − P (q)
Z
(cid:16)

=

Z′⊂N
(p≤|Z′∩Z|<p+q)
P
where wavefunctions ψZZ ′ are uniquely determined by the eigenfunction

(cid:17)

(cid:17)

ψZ of the operator P (q)

Z dqP (q)

Z corresponding to its non-zero eigenvalue.

Thus, for any ﬁxed (p + q)-element subset Z ⊂ N there exists one-to-one
correspondence (up to arbitrary overall phase prefactor) between elements
from the vector Z-cell Jn,p,q(Z) and representable density operators of the
form of Eq.(33). Reservation ‘up to arbitrary overall phase prefactor’ may
be removed by turning to the quotient of Jn,p,q(Z) obtained by identiﬁcation
of sheaves that diﬀer by overall phase prefactor, or to the projective Z-cells
if only normalized sheaves are of interest. We, however, prefer to use vector
Z-cells saying that simple sheaves parametrize density operators of the form
of Eq.(33) even if this statement is not quite correct.

13

The simplest density mapping corresponds to the case q = 1 and its value

at some simple (p, 1)-sheaf is equal to

d1({ψZZ ′}Z ′⊂N ) =

(35)

1
n − p

|ψZihψZ| + P (1)
N \Z
h

i

,

where |Z| = p + 1. The kernal of the operator on the right-hand side of this
equation is p-dimensional subspace of occupied one-electron particle states
(occupied molecular spin orbitals).

Using proposition 7 and Eq.(33), it is possible to lift one-density operators

from d1(Jn,p,1) to the level q = 2:

d2({ψZ∪{i}Z ′}Z ′⊂N ) =

|ψZ∪{i}ihψZ∪{i}|

1
n−p
2

(cid:0)

(cid:1)






(p+2)

+

Z′⊂N
X
(|Z′∩Z|=p+1)

|ψZ∪{i}Z ′ihψZ∪{i}Z ′| + P (2)

N \(Z∪{i})

.

(36)

Non-zero contributions to the sum on the right-hand side of Eq.(36) may
appear in two cases: Z ′ = Z ∪ {j}, j ∈ N\Z, j 6= i and Z ′ = Z\k ∪ {i, j}, k ∈
Z, i, j ∈ N\Z. Analysis of these cases leads to the following ﬁnal expression:




d2({ψZ∪{i}Z ′}Z ′⊂N ) =

ckc∗
k′

(−1)ǫ|{j, k}ih{j, k′}| + P (2)

1
n−p
2



k,k′∈Z
X

(cid:0)



(cid:1)

Xj∈N \Z

N \Z

(37)

where

ǫ = | [(Z\{k})∆(Z\{k′})]∩∆{j}| =

0,
1,
2,




if k = k′ or k, k′ > j;
if k ≤ j & k′ > j or k′ ≤ j & k > j;
if k, k′ ≤ j.

By the symbol {j, k} on the right-hand side of Eq.(37) non-ordered pairs
of spin-orbital indices (two-element subsets) are denoted. It is pertinent to
emphasize once again that the right-hand side of Eq.(37) does not depend
on the choice of index i ∈ N\Z that appears explicitely on the left-hand side
of this equality (see Proposition 7).



14

It is possible, following Coleman, to replace the requirement of pure repre-
sentability by more simple requirement of representability by an ensemble of
pure states. Instead of the quadratic q-density mapping (32) let us introduce
the mapping

n,p,q → Fn,q ⊗ F ∗
n,q
that is deﬁned on generators |{ψZ}Z⊂N ih{φZ}Z⊂N | as

dq : Sn,p,q ⊗ S∗

(p+q)

Z⊂N
X

1
n−p
q

(cid:0)

(cid:1)

dq (|{ψZ}Z⊂N ih{φZ}Z⊂N |) =

|ψZihφZ|

(38)

and is continued to Sn,p,q ⊗ S∗

n,p,q by linearity.

The set of all ﬁnite convex combinations of the type

λi|{ψ(i)

Z }Z⊂N ih{ψ(i)

Z }Z⊂N |

i
X
λi = 1, and ||{ψ(i)

i
P

where λi ≥ 0,

Z }Z⊂N || = 1 will be denoted as Ens(Sn,p,q).

Its image with respect to dq is the set of all ensemble representable q-density
operators and the problem of its analytic description is known as the ensemble
representability problem. For q = 1 its constructive solution was found by
Coleman [4].

Explicit Expressions for the Transformed Reduced Hamiltonians

From Eq.(15) it follows that in the vector space of all (p, q)-sheaves the
usual p-electron Hamiltonian should be replaced by the reduced Hamiltonian
transformed with the aid of the automorphism A−1(n, p, q) introduced in [3].
For q = 2 it is not diﬃcult to perform direct numerical transformation to
construct the required operator. For q > 2, however, such an approach
may appear to be complicated because the transforming operator is of huge
dimension. Fortunately, it is possible to obtain simple explicit expression for
A−1(n, p, q)Hp→q. We start with more general task of calculation of A(n, p, q)
action on products of the creation-annihilation operators.

15

Operator A(n, p, q) was deﬁned in [3] via its matrix representation with
respect to specially selected basis closely related to the basis of determinant
generators:

A(n, p, q)eIJ

K = (−1)s

p
q

p−s
(cid:0)
q−s

n−p
(cid:1)
q

(q−s)

(−1)|K∩K ′|

p+|K∩K ′|−q−1
|K∩K ′|
q−s
|K∩K ′|

(cid:0)

(cid:1)

eIJ
K ′

(cid:0)

(cid:1)

(cid:1)(cid:0)

where eIJ

XK ′⊂N \(I∪J)
K = (−1)|(I∪J)∩∆K ||I ∪ KihJ ∪ K| and I ∩ J = ∅, s = |I| = |J|.
Therefore, as the ﬁrst step, it is necessary to expand the restrictions of
products of the creation-annihilation operators on q-electron sector of the
Fock space via the basis operators eIJ
K . Using technique of manipulations
with phase prefactors developed in [3], it is easy to derive the following
formulas:

(39)

(cid:1)

(cid:0)

(q−1)

a†
i ai =

e∅∅
K∪{i},

XK⊂N \{i}

(q−1)

a†
i aj =

e{i}{j}
K

,

i 6= j,

a†
i a†

jajai =

e∅∅
K∪{i,j},

i 6= j,

XK⊂N \{i,j}
(q−2)

XK⊂N \{i,j}
(q−2)

XK⊂N \{i,j,l}

(40a)

(40b)

(40c)

i a†
a†

jalai =

e{j}{l}
K∪{i},

i 6= j 6= l,

(40d)

i a†
a†

jalak =

(−1)|{j}∩∆{i}|+|{l}∩∆{k}|e{i,j}{k,l}

K

, i 6= j 6= k 6= l. (40e)

(q−2)

XK⊂N \{i,j,k,l}

The second step is straightforward. One should apply the operator A(n, p, q)

to the right-hand sides of Eqs.(40a)-(40e). Simple but somewhat tiresome
set-theoretical and combinatorial manipulations with extensive use of two
classic relations (see, e.g.,[8])

(−1)k

r − k
m

s
k

=

r − s
r − m

(cid:18)

(cid:19)(cid:18)

(cid:19)

(cid:18)

(cid:19)

k
X

16

and

(cid:19)
lead to the following equalities:

(cid:18)

−r
k

= (−1)k

r + k − 1
k

(cid:18)

(cid:19)

A(n, p, q)a†

i aj = −

a†
i aj + δij

p
n − p

q
n − p

Iq,

(41a)

A(n, p, q)a†

i a†

jalak =

a†
i a†

jalak −

jal + δjla†

i ak

p
q

δika†
(cid:16)

(cid:17)

q
2
n−p
(cid:0)
(cid:1)
2

p
2
q
"(cid:0)
(cid:1)
2
(cid:0)
(cid:1)
(cid:1)
jak + δjka†
i al

(cid:0)

+

p
q

δila†
(cid:16)

+ (δikδjl − δilδjk) Iq

(41b)

(cid:17)
where Iq is the q-electron identity operator. Now, taking into account the
equality A−1(n, p, q) = A(n, n − p, q) (see [3]), we can write down the explicit
expression for the transformed reduced Hamiltonian:

(cid:21)

(42)

(43)

A−1(n, p, q)Hp→q =

[T r(h + FN )] Iq −

hi|FN |jia†

i aj

1
2

n−p
1
q
1

(cid:0)

(cid:0)
(cid:1)
jalak,

(cid:1)

i,j
X

+

n−p
2
q
2

1
2 (cid:0)

(cid:1)

i,j,k,l
X

hij|klia†

i a†

where the Fock operator associated with some MSO index set X ⊂ N is
deﬁned as

(cid:0)

(cid:1)

FX = h +

(Jk − Kk).

k∈X
X
The ﬁrst term on the right-hand side of Eq.(42) is the Hartre-Fock (HF)
energy of the n-electron state |Ni.
It is pertinent to emphasize that the
operator (42) should be applied to wavefunctions from the q-electron sector
of the Fock space. Note also that with the aid of Eqs.(41a-41e) it is possible to
expand any physically relevant operator via orthonormal basis of generators
eIJ
K thus reducing the matrix element evaluation problem to the calculation
of standard scalar products.

The energy of the vector Z-cell in ﬁxed MSO basis for q > 1 is obviously

deﬁned as

E(Jn,p,q(Z)) = min

T r

A−1(n, p, q)Hp→qdq({ψZZ ′}Z ′⊂N )

.

(44)

||ψZ||=1

(cid:2)

17

(cid:3)

For q = 1 it is necessary to lift one-density operator to the level q = 2 and
then deﬁne the energy of Z-cell Jn,p,1(Z) as

E(Jn,p,1(Z)) = min
||ψZ ||=1

T r

A−1(n, p, 2)Hp→2d2({ψZ∪{i}Z ′}Z ′⊂N )

,

(45)

where i is an arbitrary index from N\Z.

(cid:2)

(cid:3)

Parametrizations and Induced Sheaves

Arbitrary vector Z-cell Jn,p,q(Z) is a subspace of the vector space Sn,p,q of

. Its image with respect to the isomorphism sn,p,κ ◦ s−1

n,p,q

the dimension
is a sum of vector Z\K-cells
(cid:0)

(cid:1)

p+q
p

sn,p,κ ◦ s−1

n,p,q (Jn,p,q(Z)) =

Jn,p,κ(Z\K).

(46)

(q−κ)

K⊂Z
X

p+q
p

(see Proposition 8) being a subspace of the vector space Sn,p,κ of the same
. From Proposition 9 it follows that diﬀerent choice of κ-
dimension
electron functions of the type of Eq.(29) can be used to parametrize diﬀerent
subsets of the vector Z-cell Jn,p,q(Z). General scheme of such parametriza-
tions may be described as follows:

(cid:1)

(cid:0)

1. Select a certain family of κ-electron functions

ψZ\K =

c(K)
S |Si

(κ)

XS⊂Z\K

(47)

with a reasonable number of free parameters;

2. To each selected nonzero κ-electron function put into correspondence

simple (p, κ)-sheaf generated by this function;

3. Construct (p, κ)-sheaf

{ψ′

Z}Z ′⊂N =

{ψZ\KZ ′}Z ′⊂N ,

(48)

K⊂Z
X
that, due to Proposition 9, corresponds to a certain simple (p, q)-sheaf from
Z-cell Jn,p,q(Z).

(q−κ)

18

For example, functions

ψZ\K =

(cid:26)

(−1)|R∩∆Z\K | ¯CR|Z\R\Ki, K ⊂ Z\R
K 6⊂ Z\R
0,

correspond to HF determinant |Ri and single parameter ¯CR is used to ensure
its proper normalization.

It is pertinent to note that in the frameworks of this scheme families of
κ-electrons functions are used to perform local parametrization of subsets
from Jn,p,q(Z). Of course, the cases of small κ and q = n − p are of pri-
mary interest. The equality q = n − p means that Z = N on the level q,
Sn,p,q ∼ Fn,p and, consequently, the above scheme is applied, in fact, for
parametrization of p-electron states. If n − p > p then it is necessary to turn
to the hole representation of wavefunctions and operators and work with co-
sheaves ((¯p, q)-sheaves with ¯p = n − p). Since n − p > p implies ¯p > n − ¯p,
for co-sheaves the equality q = n − ¯p can certainly be reached.

We illustrate our approach with one relatively simple but somewhat for-

mal example. Let

ψZ =

p + q − κ
p

(cid:18)

(κ)

cS|Si

(cid:19)

S⊂Z
X

(49)

be some trial κ-electron function expanded over κ-electron determinants with
indices from the index set Z, |Z| = p + q. Rewriting it in the form

ψZ =

cS|Si =

(q−κ)

(κ)

K⊂Z
X

XS⊂Z\K

(q−κ)

(p)

=

K⊂Z
X

XR⊂Z\K

(−1)|R∩∆Z\K | ¯C (K)

R |Z\K\Ri,

(50)

where ¯C (K)
R = (−1)|R∩∆Z\K |cZ\K\R, and replacing each K-component in ex-
pansion (50) by the corresponding simple sheaf, we arrive at the (p, κ)-sheaf
free κ-electron parameters. Sheaf
of the form of Eq.(48) depending on
thus constructed will be called (p, κ)-sheaf induced by κ-electron wavefunc-
(cid:0)
tion (49) and will be denoted as [ψZ]p,κ. It is easy to see that arbitrary linear
combination of induced sheaves is induced sheaf.

p+q
κ

(cid:1)

19

The next step is to derive the explicit formulas for the matrix elements of
the κ-electron Hamiltonian Hp,q,κ(Z) corresponding to the energy expression

EZ =

hψZ\KZ ′|A−1(n, p, κ)Hp→κ|ψZ\K ′Z ′i.

(51)

(q−κ)

(κ)

K,K ′⊂Z
X

Z ′⊂N
X

1
n−p
κ

(cid:0)

(cid:1)

This complicated and somewhat tiresome procedure is described in Appendix
A.

Since the inner product of (p, κ)-sheaves (see Eq.(8)) is consistent with
the inner product of the corresponding p-electron wavefunctons, it comes
as no surprise that the eigenvalue problem for the κ-electron Hamiltonian
obtained from Eq.(51) should be solved in a certain p-electron metric.

With our choice of κ-electron functions ψZ\K (see Eq.(50)) the coeﬃcients

in expansion of the corresponding p-electron wavefunction (30) are

and the normalization condition for κ-electron coeﬃcients cS takes the form

(q−κ)

XK⊂Z\R

¯C (K)

R = (−1)|R∩∆R|

(−1)|R∩∆S|cS,

(κ)

XS⊂Z\R

(κ)

(p)

S,S′⊂Z
X

XR⊂Z\(S∪S′)





(−1)|R∩∆S∆S′ |

c∗
ScS′ = 1,





where the comparision |R ∩ ∆S| + |R ∩ ∆S′| ≡ |R ∩ ∆S∆S′|(mod 2) was taken
into account (see Appendix A of [3]).

Let us introduce the metric matrix

[Gp,q,κ(Z)]SS′ =

(−1)|R∩∆S∆S′ |.

(52)

XR⊂Z\(S∪S′)
It is easy to show that the matrix (52) is nonnegative. However, it is not
necessarily strictly positive. In Appendix B it is demonstrated how to derive
the expression for the matrix elements of Gp,q,κ(Z) as a sum of binomials.

Matrices Gp,q,κ(Z) are of purely combinatorial nature (see Appendix B)
and to study their properties methods of modern enumerative combinatorics
should most likely be used. The explicit description of kernals of these ma-
It seems to be an interesting combinatorial
trices is of primary interest.

(p)

20

problem with unexpectedly simple and elegant solution. Indeed, numerical
experiments led us to the following two hypothesis concerning the properties
of these matrices.

Hypothesis 1.

dimC ker [Gp,q,κ(Z)] =

p+q−1
κ−1
0

(cid:26) (cid:0)

(cid:1)

if q − κ ≡ 1(mod 2),
if q − κ ≡ 0(mod 2).

Hypothesis 2. If q ≡ 0(mod 2) then

ker [Gp,q,1(Z)] = C

(−1)s|{s}i.

s∈Z
X

If the Hypothesis 1 is true, then for q − κ ≡ 0(mod 2) matrices Gp,q,κ(Z)
are strictly positive and, consequently, in this case the minimization of energy
(51) reduces to the solution of the standard generalized eigenvalue problem
in the κ-electron space equipped with p-electron metric:

Hp,q,κ(Z)ψZ = EZGp,q,κ(Z)ψZ,

(53)

Explicit expressions for κ-electron Hamiltonian Hp,q,κ(Z) both in the particle
and hole representations are given in Appendix A.

When trial function (49) is chosen to be one-electron one (just a molecular
spin orbital) then it is necessary at ﬁrst to lift its K-components to a higher
level κ. In contrast to the situation described in Proposition 7, in the case
under discussion the index set Z should stay unchanged. One of the ways to
do it consists in construction of the functions

ψZ\K ′ =

(p)

(q−1)

XR⊂Z\K ′

K
X
(K′⊂K⊂Z)






(−1)|R∩∆Z\K | ¯C (K)

|Z\K ′\Ri,

R 




where |K ′| = q − κ. With such choice of K ′-components at the level κ the
normalization condition for one-electron coeﬃcients takes the form

(κ−1)

c∗
i cj

i,j∈Z
X

S⊂Z\{i}
X
S′⊂Z\{j}

[Gp,q−2,κ−1(Z\{i, j})]SS′ = 1,

and, consequently, at the one-electron level we are faced with the generalized
eigenvalue problem with respect to some contracted metric. We leave this
aspect of theory to future study.

21

p+q
κ

It is clear that for ﬁxed Z the number of linearly independent induced
(p, κ)-sheaves is equal to
− dimCker[Gp,q,κ(Z)]. One can hardly hope
that linear combinations of induced (p, κ)-sheaves may be used directly in
molecular calculations. First, the total number of free parameters is too
small. Second, the scheme of construction of induced sheaves does not have
any robust physical idea behind it. The situation may be partially improved
by turning to (p, κ)-sheaf

(cid:1)

(cid:0)

λsn,p,κ(R) + [ψZ]p,κ,

(54)

(55)

(57)

(58)

where

sn,p,κ(R) =

(−1)|R∩∆Z′ ||Z ′\Ri

R⊂Z ′⊂N

(cid:8)

is the determinant sheaf corresponding to HF p-electron wavefunction |Ri,
and λ is the additional parameter to be optimized. It is easy to demonstrate
that the problem of determination of optimal parameters λ and cS, S ⊂
Z in expression (54) may be reduced to the eigenvalue problem involving
augmented Hamiltonian and augmented metric:

(cid:9)

ER

b†
p,q,κ(Z)
bp,q,κ(Z) Hp,q,κ(Z)

λ
c

= EZ

1

a†
p,q,κ(Z)
ap,q,κ(Z) Gp,q,κ(Z)

λ
c

,

(56)

(cid:19) (cid:18)

(cid:19)

(cid:18)

(cid:19) (cid:18)

(cid:19)

(cid:18)

where

ap,q,κ(Z) =

hsn,p,κ(R)|[ψZ]p,κi,

bp,q,κ(Z) =

hsn,p,κ(R)|A−1(n, p, κ)|[ψZ]p,κi,

∂
∂c

∂
∂c

and ER is the HF energy of the determinant state |Ri. HF sheaf in expres-
sion (54) may be replaced by any available sheaf with subsequent obvious
modiﬁcations of Eqs.(56)-(58).

Use of more general parametrizations in accordance to the scheme de-
scribed at the beginning of this section is more complicated because it re-
quires development of a certain strategy for systematic selection of reasonable
number of free parameters c(K)
S . Dependence of coeﬃcients in expansion (47)
on K results in appearance of normalization conditions of the following gen-
eral type

(κ)

(p)

S,S′⊂Z
X

XR⊂Z\(S∪S′)





(−1)|R∩∆S∆S′ |

c(Z\R\S)
S
(cid:16)

(cid:17)

∗

c(Z\R\S′)
S′

= 1.





22

If no additional restrictions on coeﬃcients c(K)
sponding metric matrix is of the form

S

are imposed then the corre-

(p)

p,q,κ (Z)

G(KK ′)
h

SS′
i

=

XR⊂Z\(S∪S′)

(−1)|R∩∆S∆S′ |ζZ\R\S,KζZ\R\S′,K ′,

(59)

where ζ is combinatorial zeta-function (see Appendix A). In fact, the sum
on the right-hand side of Eq.(59) may be equal either to 0, or to ±1.

As an example one can consider parametrization that is a direct general-

ization of the HF case:

ψZ\K =

(κ)




S⊂Z\K
P
0,

c(K)
S |Si K ⊂ Z\R,

K 6⊂ Z\R

The number of free parameters here is



p+κ
κ

q
κ

.

Parametrizations with the total number of free parameters equal to the
(cid:0)
dimension of the set Ens(Sn,p,2(Z)) are of primary interest. On this route we
may hope to approach the exact solution of p-electron problem by κ-electron
means that is the primary goal of the representability theory.

(cid:1)(cid:0)

(cid:1)

It seems pertinent to emphasize once again that equations of the type of
Eq.(53) and Eq.(56) are κ-electron equations and in contrast to the standard
conﬁguration interaction method no expansions over p-electron determinants
(states) appear in the frameworks of such an approach.

Orbital Representation

Molecular calculations are normally performed in orthonormal one-electron
bases of molecular orbitals (MO). Turning from MSO to MO basis leads to
somewhat cumbersome formulas but simpliﬁes concrete calculations. Follow-
ing Handy [9] , we replace spin-orbital index set N by a pair of orbital index
sets (M, M) of α and β spins assuming that the spatial parts of molecular
spin-orbitals with the same orbital index are identical. This corresponds to
the so-called ’restricted’ theories whereas general MSO basis embraces in ad-
dition ’unrestricted’ theories. With such an approach each (p + q)-element
subset Z ⊂ N should be replaced by the pair (Zα, Zβ) ⊂ M × M with
|Zα| + |Zβ| = p + q.

23

If the total number p of electrons is ﬁxed and no other restrictions are
imposed, then there is no essential diﬀerence between MSO and MO repre-
sentations. For example, the expression for the metric matrix in terms of
molecular orbitals may be easily derived from Eq.(52) and Eq.(C.1):

[Gp,q,κ(Zα, Zβ)](Sα,Sβ)(S′

α,S′

β)

=

(−1)pα(κβ+κ′

β)[Gpα,qα,κα,κ′

α(Zα)]SαS′

α

[Gpβ,qβ,κβ,κ′

(Zβ)]Sβ S′

,

β

β

(60)

pα,pβ
X
(pα+pβ =p)

where

κα = |Sα|, κβ = |Sβ|, κα + κβ = κ,
α = |S′
κ′
qα = |Zα| − pα, qβ = |Zβ| − pβ,

β = |S′

α + κ′

β = κ,

α|, κ′

β|, κ′

|Zα| + |Zβ| = p + q.

If, in addition, the projection MS of the total spin is ﬁxed, then the
numbers pα of α and pβ of β electrons are also ﬁxed for each split basis
determinant |Rα, Rβi. Moreover, the q value for a given pair (Zα, Zβ) ⊂
M × M can be uniquely presented as a sum of its α and β components:

q = |Zα\Rα| + |Zβ\Rβ| = qα + qβ.

Deﬁnition. Pair (Zα, Zβ) is called a pair of index (qα, qβ) if |Zα| = pα+qα

and |Zβ| = pβ + qβ.

ψ(Zα,Zβ)

Thus, in the orbital representation for the ﬁxed value of the total spin
projection there are q + 1 diﬀerent types of pairs (Zα, Zβ) and arbitrary
(Zα,Zβ)⊂M ×M involves, in general, q-germs with labels
(p, q)-sheaf
(Zα, Zβ) of diﬀerent index.
(cid:8)
(cid:9)

In MO basis the expressions for (p, q)-sheaves become rather complicated
(see Appendix C). Here we discuss only MO representation of the metric
matrix and the Hamiltonian involved in Eqs.(53) and (56).

Simple combinatorial arguments lead to the conclusion that (Kα, Kβ)
component of arbitrary κ-electron wavefunction ψ(Zα,Zβ) corresponding to
some given MS value is expanded over determinants |Sα, Sβi with ﬁxed |Sα| =

24

κα = qα − |Kα| and |Sβ| = κβ = qβ − |Kβ|. As a result, trial κ-electron
wavefunction (see Eq.(49)) should be taken in the form

ψMS
(Zα,Zβ) =

min(κ,qα)

κα=max(0,κ−qβ)
X

pα + qα − κα
pα

pβ + qβ − κ
pβ

β

(cid:19)(cid:18)

(cid:19)

c(Sα,Sβ)|Sα, Sβi,

(61)

(κα)

(κβ)

×

Sα⊂Zα
X
where κβ = κ − κα.

Sβ⊂Zβ (cid:18)
X

function is

The metric matrix corresponding to such choice of trial κ-electron wave-

[GMS

p,q,κ(Zα, Zβ)](Sα,Sβ)(S′

α,S′

β)

= (−1)pα(κβ +κ′

β)[Gpα,qα,κα,κ′

α(Zα)]SαS′

α

[Gpβ,qβ,κβ,κ′

(Zβ)]SβS′

,

β

β

(62)

where pα = 1
In contrast to general metric matrix (60) its MS components (62) turn

2(p + 2MS) and pβ = 1

2(p − 2MS).

out to be always degenerate.

MS component of κ-electron Hamiltonian Hp,q,κ(Z) in the orbital rep-
resentation is easily obtained from Eq.(A.12) with the aid of the relation
(C.1):

(−1)pα(κβ +κ′

β)[H MS

p,q,κ](Sα,Sβ)(S′

β) =

α,S′

(−1)|{j}∩∆Sα |+|{i}∩∆S′

α

|(i|h|j)[Gpα−1,qα+1,κα+1,κ′

α+1(Zα)]Sα∪{j}S′

j∈Zα\Sα
X
i∈Zα\S′
α

j∈Zβ \Sβ
X
i∈Zβ \S′
β

= 




+ 



×[Gpβ,qβ,κβ,κ′

(Zβ)]Sβ S′

β

β

×[Gpα,qα,κα,κ′

α(Zα)]SαS′

α

25

|{j}∩∆Sβ |+|{i}∩∆S′
β

|

(−1)

(i|h|j)[Gpβ−1,qβ+1,κβ+1,κ′

β+1(Zβ)]Sβ∪{j}S′

β ∪{i}

α∪{i}








(−1)|{j}∩∆{i}|+|{l}∩∆{k}|+|{k,l}∩∆Sα |+|{i,j}∩∆S′

α

|(ik|jl)

×[Gpα−2,qα+2,κα+2,κ′

α+2(Zα)]Sα∪{k,l}S′

α∪{i,j}

[Gpβ,qβ,κβ,κ′

(Zβ)]SβS′

β

β





|{k}∩∆Sα |+|{l}∩∆Sβ |+|{i}∩∆S′
α

|+|{j}∩∆S′
β

|

(−1)

(ik|jl)

×[Gpα−1,qα+1,κα+1,κ′

α+1(Zα)]Sα∪{k}S′

α∪{i}[Gpβ−1,qβ+1,κβ+1,κ′

β+1(Zβ)]Sβ∪{l}S′

β ∪{j}

|{k}∩∆Sβ |+|{l}∩∆Sα |+|{i}∩∆S′
β

|+|{j}∩∆S′
α

|

(−1)

(ik|jl)

×[Gpα−1,qα+1,κα+1,κ′

α+1(Zα)]Sα∪{l}S′

α∪{j}[Gpβ−1,qβ+1,κβ+1,κ′

β+1(Zβ)]Sβ∪{k}S′

β ∪{i}

|{j}∩∆{i}|+|{l}∩∆{k}|+|{k,l}∩∆Sβ |+|{i,j}∩∆S′
β

|

(ik|jl)

+

1
2





k,l∈Zα\Sα
X
i,j∈Zα\S′
α
(k6=l,i6=j)

+

1
2

+

1
2

k∈Zα\Sα
X
l∈Zβ \Sβ
i∈Zα\S′
α
j∈Zβ \S′
β

k∈Zβ \Sβ
X
l∈Zα\Sα
i∈Zβ \S′
β
j∈Zα\S′
α

(−1)



+

1
2

k,l∈Zβ \Sβ
X
i,j∈Zβ \S′
β
(k6=l,i6=j)



×[Gpβ−2,qβ+2,κβ+2,κ′

β+2(Zβ)]Sβ∪{k,l}S′

β∪{i,j}

[Gpα,qα,κα,κ′

α(Zα)]SαS′

α

.

(63)

The analogous expression for this Hamiltonian in the hole representation

may easily be obtained from Eq.(A.16).





26

Numerical Examples

To test numerous complicated formulas obtained in the preceding sections
and to illustrate our approach, we performed several ground state calcula-
tions for small atomic and molecular systems using Eqs.(56)-(58). All HF
calculations to generate MO basis and list of transformed molecular integrals
were carried out with the aid of the GAMESS program [10].

Modiﬁcation of the Davidson diagonalization routine [11] to handle eigen-
value problem in arbitrary non-degenerate metric (generalized eigenvalue
problem) is not complicated and straightforward. We had certain doubts
about possibility to use this routine for the case of degenerate metrics. To
our surprise, after incorporation in Gram-Schmidt orthogonalization routine
outﬂow for kernal vectors of the current metric we obtained stable work-
ing diagonalization procedure. It comes as no surprise that its convergence
properties are worse than that of the original Davidson method for the stan-
dard Euclidean metric but it normally manifests itself only in the number of
iterations that are necessary to reach the solution.

In Table I the results of calculations of few simple systems in STO-3G
basis are presented. For B, H2O, NH2, and NH3 the particle representation
was used (p ≥ 2m − p) whereas for Be, and LiH transformation to the hole
representation was required (p < 2m − p). In all calculations q value was
taken equal to 2m − p and, consequently, only the case (Zα, Zβ) = (M, M)
was under consideration.

In the basis of two-electron induced sheaves (κ = 2) only small percent
of correlation energy is accounted (see Table II). This percent normally rises
when κ increases, and FCI limit corresponds to κ = q in full accordance
with general theory. It is interesing to note that for boron atom the energy
corresponding to κ = 4 is greater than that for κ = 3. It is most probably
connected with high degeneracy of the metric matrix for κ = 4 (its kernal
dimension is equal to 35 for κ = 3 and 75 for κ = 4). As a result, in small
basis used, the actual number of free parameters in energy turns out to be
essentially less for κ = 4 in compare with the case κ = 3.

We did not try to calculate more extensive systems or use better bases
because the parametric induced sheaves even if they are centered at the HF
origin (see Eq.(54)) will hardly become a working tool of the computational
quantum chemistry.
In spite of mathematical beauty of metric matrices
given by Eq.(B.6) and (B.7) the induced sheaves have no reasonable physical
interpretation and for small κ include too small number of parameters to be

27

adjusted. We used them just to illustrate the principal possibility to solve p-
electron problems by diagonalization of κ-electron Hamiltonians in specially
selected p-electron metrics.

Conclusion

We have presented a new way to approach many electron problems us-
ing κ-electron means (κ = 2, 3, . . .). With the aid of special parametriza-
tions it is possible to reduce p-electron optimization problem to generalized
eigenvalue problem for Hamiltonians in spaces corresponding to numbers of
electrons less than p. These Hamiltonians and related metric matrices are
uniquely determined by the parametrization selected. Systematic study of
diﬀerent parametrizations and their usefullness for concrete calculations is
still an opened ﬁeld for investigation. We have suggested two relatively sim-
ple parametrization schemes and studied in detail one of these schemes based
on the notion of the induced sheaves. In spite of the fact that the induced
sheaves are introduced is a very formal way and do not have any physical idea
behind their deﬁnition, they may be used to analyze κ-electron contributions
(κ = 2, 3, . . . , q) to correlation energy.

There exists an opinion shared by a number of notable scientists that the
romantic period of quantum chemistry came to its end with the appearance
of universal computer programs such as GAUSSIAN, MOLCAS, GAMESS,
etc. As we hope, the present paper demonstrates that it is fortunately not
yet true.

Appendix A

Here we describe a general scheme of evaluation of matrix elements of
products of the creation-annihilation operators involved in the energy ex-
pressions of the type of Eq.(51).

Let ψZ be κ-electron trial wave function expanded over determinants with
indices from MSO index set Z, |Z| = p + q. Rewriting this function as a sum
of its K-components (see Eq.(50))

ψZ =

ψZ\K

(q−κ)

K⊂Z
X

28

and replacing each component in this sum by the corresponding simple (p, κ)-
sheaf {ψZ\KZ ′}Z⊂N with germs

ψZ\KZ ′ =

(−1)|R∩∆Z′ | ¯C (K)

R |Z ′\Ri,

(p)

XR⊂Z ′∩(Z\K)

where ¯C (K)
matrix elements

R = (−1)|R∩∆Z\K |cZ\K\R, we come to the problem of evaluation of

hψZ|a|ψZiG =

1
n−p
κ

(q−κ)

(p+κ)

(p)

×

K,K ′⊂Z
X

Z ′⊂N
X

R⊂Z′∩(Z\K)
X
R′⊂Z′∩(Z\K′)

(cid:0)
(−1)|R∩∆Z′ |+|R′∩∆Z′ |

(cid:1)
¯C (K)
R

∗

¯C (K ′)
R′

hZ ′\R|a|Z ′\R′i,

(cid:16)

(cid:17)

(A.1)
where a stands for some relevant product of the creation-annihilation oper-
ators and subscript G means that the inner product is taken in the metric
determined by the matrix Gp,q,κ(Z) (see Eq.(52)).

Changing the order of summations on the right-hand side of Eq.(A.1) and
using technque of manipulations with phase prefactors developed in [3], we
can recast Eq.(A.1) as

hψZ|a|ψZiG =

(−1)|R∩∆S |+|R′∩∆S′ |

(κ)

(p)

c∗
ScS′ 


S,S′⊂Z
X

R⊂Z\S
X
R′⊂Z\S′

1
n−p
κ

(cid:0)

(cid:1)

(p+κ)


(−1)|R∩∆Z′\R|+|R′∩∆Z′\R′ |hZ ′\R|a|Z ′\R′i

×

Z ′⊃R∪R′
X

(A.2)

.




There are ﬁve cases to be analyzed (see Eqs.(40a)-(40e)).
Case 1: a = a†
In this case the inner sum on the right-hand size of Eq.(A.2) is equal to

i ai.



(1 − ζ{i},R)

ζ{i},Z ′ = (1 − ζ{i},R)

n − p − 1
κ − 1

,

(cid:19)

(cid:18)

(p+κ)

Z ′⊃R
X

where

ζI,R =

1
0

if I ⊂ R,
if I 6⊂ R

(cid:26)

29

is the well-known in combinatorics zeta-function of partially ordered by in-
clusion set of all subsets of N [12]. By an abuse of notation, we agree to use
ζi,R instead of ζ{i},R for one-element subsets of N. In this case this function
is identical to the characteristic function of subset R accepting the value 1 if
i ∈ R and 0 if i /∈ R.

If i ∈ S ∪ S′ or i ∈ N\Z then the sum over R ⊂ Z\(S ∪ S′) is just
proportional to the matrix element [Gp,q,κ]SS′. If i ∈ Z\(S ∪ S′) then this
sum is proportional to the matrix element [Gp,q−1,κ(Z\{i}]SS′. The ﬁnal
expression for the desired matrix element is obtained with the aid of the
recurrence relation (B.9):

hψZ|a†

i ai|ψZiG =

hψZ|Gp,q,κ(Z)|ψZi

κ
1
n−p
(cid:0)
(cid:1)
1
(cid:0)
(cid:1)

ScS′(−1)|{i}∩∆S∆S′ |ζi,Z\(S∪S′)[Gp−1,q+1,κ+1(Z)]S∪{i}S′∪{i}
c∗





(κ)

−

S,S′∈Z
X

(A.3)

i aj, i 6= j.

Case 2: a = a†
The sum over Z ′ on the right-hand side of Eq.(A.2) is non-zero only for
R = R1 ∪ {j} and R′ = R1 ∪ {i}. Substitution of expansion (40b) for the
operator a†
i aj in matrix elements hZ ′\R|a†
i aj|Z ′\R′i makes it easy to get the
following expression for the sum under consideration:



(−1)|R1∩∆{i,j}|+|{i}∩∆{j}|+|{j}∩∆{i}|

n − p − 1
κ − 1

.
(cid:19)

(cid:18)

Since |{i} ∩ ∆{j}| + |{j} ∩ ∆{i}| ≡ 1(mod 2) for i 6= j, the required matrix
element takes the form

hψZ|a†

(κ)

i aj|ψZiG = −

κ
1
n−p
(cid:1)
(cid:0)
1
(cid:1)
(cid:0)
(−1)|(R1∪{j})∩∆S |+|R1∪{i}∩∆S′ |+|R1∩∆{i,j}|.

S,S′∈Z
X

c∗
ScS′

(p)

×

R1∪{j}⊂Z\S
X
R1∪{i}⊂Z\S′

30

Taking into account that R1 ∪{j} ⊂ Z\S implies j /∈ S, and R1 ∪{i} ⊂ Z\S′
implies i /∈ S′, we can write down the ﬁnal expression:

hψZ|a†

i aj|ψZiG = −

ScS′(−1)|{j}∩∆S|+|{i}∩∆S′ |
c∗

(κ)

κ
1
n−p
(cid:0)
(cid:1)
1
(cid:1)
(cid:0)

S,S′∈Z
X
×ζj,Z\Sζi,Z\S′ [Gp−1,q+1,κ+1(Z)]S∪{j}S′∪{i} .
i a†

jajai, i 6= j.

Case 3: a = a†
Substitution of expansion (40c) in matrix element hZ ′\R|a†

jajai|Z ′\R′i
immediately shows that non-zero contributions correspond to the case R = R′
and R 6∋ i, j:

i a†

(A.4)

hψZ|a†

i a†

jajai|ψZiG =

(−1)|R∩∆S∆S′ |

.

(κ)

c∗
ScS′ 


S,S′∈Z
X

κ
2
n−p
(cid:1)
(cid:0)
2
(cid:0)
(cid:1)

R⊂Z\(S∪S′)
X
(R6∋i,j)

Thorough analysis of mutual layout of indices i, j and relevant subsets
of the MSO index set with subsequent use of the recurrence relations (B.9)-
(B.10) leads to the following somewhat cumbersome expression:








hψZ|a†

i a†

jajai|ψZiG =

hψZ|Gp,q,κ(Z)|ψZi

κ
2
n−p
(cid:1)
(cid:0)
2
(cid:1)
(cid:0)

"

(κ)

S,S′∈Z
X

(

−

c∗
ScS′

(−1)|{i}∩∆S∆S′ |ζi,Z\(S∪S′)[Gp−1,q+1,κ+1(Z)]S∪{i}S′∪{i}

+(−1)|{j}∩∆S∆S′ |ζj,Z\(S∪S′)[Gp−1,q+1,κ+1(Z)]S∪{j}S′∪{j}

−(−1)|{i,j}∩∆S∆S′ |ζ{i,j},Z\(S∪S′)[Gp−2,q+2,κ+2(Z)]S∪{i,j}S′∪{i,j}

.

(A.5)

) #

i a†

jalai, i 6= j 6= l.

Case 4: a = a†
Substitution of expansion (40d) in matrix element hZ ′\R|a†

jalai|Z ′\R′i
readily leads to the conclusion that this matrix element is non-zero if R =
R1 ∪ {l}, R′ = R1 ∪ {j}, and R1 6∋ i. The ﬁnal expression is

i a†

hψZ|a†

i a†

jalai|ψZiG = −

c∗
ScS′ζl,Z\Sζj,Z\S′

(κ)

S,S′∈Z
X

κ
2
n−p
(cid:1)
(cid:0)
2
(cid:1)
(cid:0)

31

)
(A.6)

(A.8)

(A.9)

×

(−1)|{l}∩∆S |+|{j}∩∆S′ |[Gp−1,q+1,κ+1(Z)]S∪{l}S′∪{j}

(

−(−1)|{i,l}∩∆S |+|{i,j}∩∆S′|+|{i}∩∆{j,l}|ζi,Z\(S∪S′)[Gp−2,q+2,κ+2(Z)]S∪{i,l}S′∪{i,j}

Case 5: a = a†
Matrix element hZ ′\R|a†

jalak, i 6= j 6= k 6= l.
i a†

i a†

R′ = R1 ∪ {i, j}.We have

jalak|Z ′\R′i is nonzero only if R = R1 ∪ {k, l},

hψZ|a†

i a†

jalak|ψZiG

(κ)

= (−1)|{j}∩∆{i}|+|{l}∩∆{k}|

κ
2
n−p
(cid:1)
(cid:0)
2
(cid:1)
(cid:0)
×ζk,Z\Sζl,Z\Sζi,Z\S′ζj,Z\S′[Gp−2,q+2,κ+2(Z)]S∪{k,l}S′∪{i,j}

S,S′∈Z
X

c∗
ScS′

(

(−1)|{k,l}∩∆S|+|{i,j}∩∆S′|

(A.7)

)

Now it is easy to derive the expression for the matrix elements of general
one- and two-electron operators:

h =

hi|h|jia†

iaj,

g =

hij|klia†

i a†

jalak.

n

i,j=1
X
n

i,j,k,l=1
X

κ
1
n−p
(cid:1)
(cid:0)
1
(cid:1)
(cid:0)






We have

hψZ|h|ψZiG =

T r(h)hψZ|Gp,q,κ(Z)|ψZi

(κ)

−

c∗
ScS′

S,S′∈Z
X

j∈Z\S
X
i∈Z\S′

(−1)|{j}∩∆S|+|{i}∩∆S′ |hi|h|ji[Gp−1,q+1,κ+1(Z)]S∪{j}S′∪{i}

(A.10)


,

32

and

hψZ|g|ψZiG =

(hij|iji − hij|jii)

hψZ|Gp,q,κ(Z)|ψZi

n

(

i,j=1
h
X

κ
2
n−p
(cid:0)
(cid:1)
2
(cid:1)
(cid:0)
(κ)

i

−2

c∗
ScS′

(−1)|{k}∩∆S|+|{j}∩∆S′|

S,S′∈Z
X

k∈Z\S
X
j∈Z\S′

n

×

(hij|iki − hij|kii)

i=1
h
X

(κ)

+

c∗
ScS′

S,S′∈Z
X

k,l∈Z\S
X
i,j∈Z\S′
(k6=l,i6=j)

[Gp−1,q+1,κ+1(Z)]S∪{k}S′∪{j}
i

(−1)|{j}∩∆{i}|+|{l}∩∆{k}|+|{k,l}∩∆S|+|{i,j}∩∆S′ |

×hij|kli[Gp−2,q+2,κ+2(Z)]S∪{k,l}S′∪{i,j}

(A.11)

)

The Hamiltonian associated with the energy expression (51) is

[Hp,q,κ(Z)]SS′ =

(−1)|{j}∩∆S|+|{i}∩∆S′ |

j∈Z\S
X
i∈Z\S′

×hi|h|ji[Gp−1,q+1,κ+1(Z)]S∪{j}S′∪{i}

(−1)|{j}∩∆{i}|+|{l}∩∆{k}|+|{k,l}∩∆S|+|{i,j}∩∆S′|

+

1
2

k,l∈Z\S
X
i,j∈Z\S′
(k6=l,i6=j)

×hij|kli[Gp−2,q+2,κ+2(Z)]S∪{k,l}S′∪{i,j}

(A.12)

As has already been mentioned, for p < n − p it is reasonable to turn to
sheaves in hole representation (co-sheaves). Reduced hole Hamiltonian (see
Appendix B of [1]) after its transformation with the aid of A−1(n, ¯p, κ) =
A(n, p, κ) may be written as

A−1(n, ¯p, κ)H ◦

¯p→κ =

hi|h|jia†

i aj

n

i,j=1
X

p
1
κ
(cid:1)
(cid:0)
1
(cid:1)
(cid:0)
33

where

+

n

jalak,

p
2
κ
(cid:1)
2
(cid:1)

i a†

i,j,k,l=1
X

hij|klia†

1
2 (cid:0)
(cid:0)
hi|h|ji = (−1)i+jhj|h|ii,
hij|kli = (−1)i+j+k+lhkl|iji,

(A.13)

(A.14)

(A.15)

and ¯p = n − p. Using Eqs.(A.10)-(A.11) it is easy to derive the expression for
the Hamiltonian corresponding to the energy (51) in the hole representation:

[H ◦

p,q,κ(Z)]SS′ =

[T r(h + FN )][G¯p,q,κ(Z)]SS′

1
2

−

(−1)|{j}∩∆S|+|{i}∩∆S′ |hi|FN |ji[G¯p−1,q+1,κ+1(Z)]S∪{j}S′∪{i}

(−1)|{j}∩∆{i}|+|{l}∩∆{k}|+|{k,l}∩∆S|+|{i,j}∩∆S′|

×hij|kli[G¯p−2,q+2,κ+2(Z)]S∪{k,l}S′∪{i,j},

(A.16)

where |Z| = ¯p + q and FN is the Fock operator deﬁned by Eq.(43).

j∈Z\S
X
i∈Z\S′

+

1
2

k,l∈Z\S
X
i,j∈Z\S′
(k6=l,i6=j)

Appendix B

With each subset Z ⊂ N, |Z| = p + q let us associate the linear mapping

gp,q(Z) :

Fn,κ(Z) →

Fn,κ(Z),

(B.1)

q

κ=1
M

q

κ=1
M

deﬁned by its matrix representation

[Gp,q,κ,κ′(Z)]SS′ =

(−1)|R∩∆S∆S′ |.

(B.2)

with respect to the determinant basis set. Here |S| = κ, and |S′| = κ′.
Diagonal (with respect to κ) blocks of this matrix are identical to the p-
electron metric matrices given by Eq.(52). We agree to omit repeating index

(p)

XR⊂Z\(S∪S′)

34

κ in writing diagonal (with respect to κ) matrix elements. Oﬀ-diagonal
(κ 6= κ′) blocks appear in going from molecular spin-orbitals to molecular
orbitals.

Let S, and S′ be κ- and κ′-element subsets of the index set Z ⊂ N, |Z| =

p + q, respectively. Let us suppose that

S∆S′ = s1 < s2 < . . . sl,

Z\(S ∩ S′) = z1 < z2 < . . . < zk,

where l = |S∆S′|, and k = |Z\(S ∩ S′)| = p + q − |S ∩ S′|.
The index set Z ′ = Z\(S ∩ S′) may be presented as

Z ′ =

{si} ∪ ([si + 1, si+1 − 1] ∩ Z ′) ,

(B.3)

l

i=0
[

where s0 = z1 − 1, sl+1 = zk + 1, and the symbol [s, s′] stands for the interval
in the set N = {1, 2, . . . , n}. It is easy to show that l ≡ κ − κ′(mod 2). Cases
of even and odd l require separate analysis, since the representation of the
set ∆S∆S′ as a union of intervals depends on the parity of l (see Eq.(A.5)
from [3]):

l
2

∆S∆S′ = 



i=1
[ l
S
2 ]

i=0
S

[s2i−1 + 1, s2i],

if l is even,

[s2i + 1, s2i+1],

if l is odd.

(B.4)

Using decompositions (B.3)-(B.4), it is possible to express the sum on the

right-hand side of Eq.(B.2) as a sum of binomials. We have

[Gp,q,κ,κ′(Z)]SS′ =

r1,r2,...,rl+1≥0
P
ri=p)

l+1

(

i=1
P

r1,r2,...,rl+1≥0
P
ri=p)

l+1

(

i=1
P






l
2

r2i l+1

(−1)

i=1
P

wi
ri

,

i=1
Q

(cid:0)

(cid:1)

[ l
2 ]

i=0
P

(−1)

r2i+1 l+1

wi
ri

,

i=1
Q

(cid:0)

(cid:1)

35

if l is even,

(B.5)

if l is odd,

where

wi = |[si−1 + 1, si − 1] ∩ (Z\(S ∩ S′))|.

By deﬁnition, wi ≥ 0 and

wi = |Z\(S ∪ S′)|.

l+1

i=1
P

Performing summations on the right-hand side of Eq.(A.5) ﬁrst over in-
dices ri with odd i and then over indices ri with even i for the case of even l,
and in the backward succession for odd l, we arrive to the following not very
complicated expression

[Gp,q,κ,κ′(Z)]SS′ = (−1)pl

(−1)r

(B.6)

[ l
2 ]

w2i+1

[ l+1
2 ]

i=0
p − r (cid:19)(cid:18)
P

i=1
P

(cid:18)

w2i
.
r (cid:19)

r≥0
X

In Eqs.(B.5)-(B.6) the symbol [x] stands for the function extracting integral
part of x.

If κ = κ′ and S = S′ then l = 0 and only w1 = |[s0 + 1, s1 − 1] ∩ (Z\S)| =
p + q − κ diﬀers from zero which means that [Gp,q,κ(Z)]SS =
in full
accordance with Eq.(B.2). If κ = q then for S 6= S′ there is no room for
p-electron subsets in the set Z\(S ∪ S′) and in this case the only non-zero
block is the diagonal one (κ′ = q) coinciding with the q-electron identity
matrix.

p+q−κ
p

(cid:1)

(cid:0)

If Z = {1, 2, . . . , p + q} then the sums of interval lengths involved in the
right-hand side of Eq.(A.6) may be presented in a more transparent form.
Indeed, in this case s0 = 0, sl+1 = p + q + 1, and for even l

l
2

i=1
X

w2i =

(−1)isi −

− l0,

l
2

l

i=1
X

w2i+1 = p + q +

(−1)i+1si −

− l1,

l
2

i=0
X

i=1
X
where l0 and l1 are the numbers of elements from S ∩ S′ belonging to ’even’
intervals [s2i−1 + 1, s2i − 1] and ’odd’ intervals [s2i + 1, s2i+1 − 1], respectively.
For odd l we have

w2i = p + q + 1 +

(−1)isi −

l + 1
2

− l0,

l
2

l+1
2

i=1
X

l

l

i=1
X
36

l
2

i=0
X

w2i+1 =

(−1)i+1si −

l + 1
2

− l1.

l

i=1
X

The ﬁnal expression for the matrix elements under consideration may be
written as

r≥0
P

r≥0
P

= 



[Gp,q,κ,κ′(Z)]SS′

(−1)r

(−1)r

p+q+

(−1)i+1si− l

2 −l1

l

i=1
P

p−r

l

i=1
P

(−1)isi− l
r

2 −l0

,

(cid:0)

p+q+1+

l

(−1)isi− l+1

(cid:1)(cid:0)
2 −l0

i=1
P

p−r

l

i=1
P

(cid:1)
2 −l1

(−1)i+1si− l+1
r

if l is even,

,

if l is odd.

(cid:0)

(cid:1)(cid:0)
(B.7)
Directly from the deﬁnition (B.2) various recurrence relations involving
matrix elements of metric matrices may be derived. Here we conﬁne ourselves
to the relations that are necessary for evaluation of relevant matrix elements.
Let us suppose that subsets S, S′ ⊂ Z are ﬁxed and K(|K| = k) is some
subset of the set Z\(S ∪ S′). Then

(cid:1)

[Gp,q,κ(Z)]SS′

k

(k1)

k1=0
X

K1⊂K
X

=

(−1)|K1∩∆S∆S′ | [Gp−k1,q−k+2k1,κ+k1((Z\K) ∪ K1)]S∪K1S′∪K1

.

(B.8)
In two most important particular cases K = {i} and K = {i, j} general
relation (B.8) reduces to

[Gp,q,κ(Z)]SS′ = [Gp,q−1,κ(Z\{i})]SS′

+(−1)|{i}∩∆S∆S′| [Gp−1,q+1,κ+1(Z)]S∪{i}S′∪{i} ,
[Gp,q,κ(Z)]SS′ = [Gp,q−2,κ(Z\{i, j})]SS′
+(−1)|{i}∩∆S∆S′| [Gp−1,q,κ+1(Z\{j})]S∪{i}S′∪{i}
+(−1)|{j}∩∆S∆S′| [Gp−1,q,κ+1(Z\{i})]S∪{j}S′∪{j}
+(−1)|{i,j}∩∆S∆S′| [Gp−2,q+2,κ+2(Z)]S∪{i,j}S′∪{i,j} .

(B.9)

(B.10)

37

Appendix C

From Eq.(6) it follows that in expansion of q-germs phase prefactors of
the type (−1)|R∩∆Z | are involved. In Handy orbital representation R goes to
(Rα, Rβ) and Z goes to (Zα, Zβ). Let us introduce the sets ¯Rβ = m + Rβ and
¯Zβ = m + Zβ with shifted by m = |M| elements. We have R = Rα∆ ¯Rβ and
Z = Zα∆ ¯Zβ. Using technique of manipulation with sign prefactors developed
in [3], we obtain

|R ∩ ∆Z| ≡ |Rα ∩ ∆Zα| + |Rα ∩ ∆ ¯Zβ | + | ¯Rβ ∩ ∆Zα| + | ¯Rβ ∩ ∆ ¯Zβ | (mod 2).

From Eq.(A.5) of [3] it follows that | ¯Rβ ∩ ∆Zα| = 0 and |Rα ∩ ∆ ¯Zβ | ≡
|Rα||Zβ|(mod 2). As a result,

|R ∩ ∆Z| ≡ |Rα ∩ ∆Zα| + |Rβ ∩ ∆Zβ | + |Rα||Zβ|(mod 2).

(C.1)

Certain assymetry of this relation is connected with the use of Handy split
determinant representation with α indices always going ﬁrst.

q-electron function

ψ(Zα,Zβ) =

(−1)pα|Zβ|

(−1)|Rα∩∆Zα |+|Rβ∩∆Zβ | ¯CRα,Rβ |Zα\Rα, Zβ\Rβi

(C.2)

(pα)

(pβ )

Rα⊂Zα
X

Rβ ⊂Zβ
X

generates simple (p, q)-sheaf with germs

ψ(Zα,Zβ)(Z ′

α,Z ′

β) =

(pα)

(pβ )

(−1)pα|Z ′
β|

R′

α∩Zα

α⊂Z ′
X

β⊂Z ′
XR′

β∩Zβ

|R′

α∩∆Z′
α

|+|R′

β∩∆Z′
β

(−1)

| ¯C(R′

β)|Z ′

α\R′

α, Z ′

β\R′

βi

α,R′

(C.3)
From Eq.(C.2) it follows that in the orbital representation with ﬁxed MS
value only q-electron functions ψ(Zα,Zβ) from the vector space Fn,q(Zα, Zβ)
that are linear combinations of determinants |Sα, Sβi with |Sα| = qα and
|Sβ| = qβ (qα = |Zα| − pα, qβ = |Zβ| − pβ) are of actual interest.

In the orbital representation deﬁnitions (17) and (18) should be replaced

by

Ip(ψ(Zα,Zβ)) =

(Rα, Rβ) ⊂ (Zα, Zβ) : ¯C(Rα,Rβ) 6= 0

;

(C.4)

(cid:8)

38

(cid:9)

I α
p (ψ(Zα,Zβ)) =
I β
p (ψ(Zα,Zβ)) =

Rα ⊂ Zα : ¯C(Rα,Rβ) 6= 0 for some Rβ ⊂ Zβ
Rβ ⊂ Zβ : ¯C(Rα,Rβ) 6= 0 for some Rα ⊂ Zα
(cid:8)

Lσ(ψ(Zα,Zβ)) =

(cid:8)

Rσ

(σ = α, β).

;

;

(cid:9)

(cid:9)

(C.5)

(C.6)

(C.7)

and each simple (p, q)-sheaf

is generated by any

p (ψ(Zα,Zβ ))

[Rσ∈I σ
ψ(Zα,Zβ)(Z ′

α,Z ′

β)

n

(Z ′

α,Z ′

β)⊂M ×M

o

2m − |Lα(ψ(Zα,Zβ))| − |Lβ(ψ(Zα,Zβ))|
p + q − |Lα(ψ(Zα,Zβ))| − |Lβ(ψ(Zα,Zβ))|

(cid:19)

of its

(cid:18)
q-electron germs (see proposition 3).

ACKNOWLEDGMENTS

(C.8)

We gratefully acknowledge the Russian Foundation for Basic Research
(Grant 00-03-32943a) and Ministry of Education of RF (Grant E00-5.0-62)
for ﬁnancial support of the present work.

References

[1] Panin, A.I. Int J Quantum Chem 2002,87,23.

[2] Panin, A. I. Int J Quantum Chem 1985,28,861.

[3] Panin, A.I. Int J Quantum Chem 2001,85,1.

[4] Coleman, A. J. Rev Mod Phys 1963, 35,668.

[5] Coleman, A. J.

In Reduced Density Matrices With Applica-
tions to Physical and Chemical Systems; Coleman, A.J. and Er-
dahl,R.M.,Eds.;Queen’s Uinv.: Kingston, Ontario, 1968;No 11,p.2.

[6] Coleman, A.J. J Math Phys 1972,13,214.

[7] Coleman, A. J. Reports on Math Phys 1973,4, 113.

[8] Knuth, D.E. The art of computer programming; Addison-Wesley Pub-
lishing Company: Reading, Massachusetts, Menlo Park, California,
Don Mills, Ontario, 1968, Vol.1.

39

[9] Handy, N. C. Chem Phys Lett 1980,74,280.

[10] Schmidt, M. W.; Baldridge, K. K.; Boatz, J. A.; Elbert, S. T.; Gordon,
M. S.; Jensen, J. H.; Koseki, S.; Matsunaga, N.; Nguyen, K. A.; Su, S.
J.; Windus, T. L.; Dupuis, M.; Montgomery, J. A. J Comput Chem.
1993,14,1347.

[11] Davidson E. R., J. Comput. Phys. 17, 87 (1975).

[12] Stanley, P.S. Enumerative combinatorics; Wadsworth&Brooks/Cole,

Advanced Books&Software:Monterey,California, 1986.

40

TABLE I
Results of ground state test calculations: Total energies.

Energy, a.u.

Species
Be(1S)
B(2P )
LiH(1Σ+)
NH2(2B2)
NH3(1A1)
H2O(1A1)

HF

κ = 2

κ = 3

κ = 4

-14.351880 -14.366729
-24.148989 -24.152540
-7.862024
-7.864463
-54.834567 -54.835048
-55.447595 -55.447969
-74.962992 -74.965180

-14.373701 -14.403655
-24.169145 -24.161980
-7.868083
-7.882402
-54.839962 -54.850959
-55.449684 -55.457770
-74.976319 -75.012500

κ = 5
-
-24.189265
-
-54.882707
-55.468587 -55.509590

κ = 6
-
-
-
-

-

-

TABLE II
Results of ground state test calculations: Percent of the correlation
energy accounted.

Species
Be(1S)
B(2P )
LiH(1Σ+)
NH2(2B2)
NH3(1A1)
H2O(1A1)

[EHF − Eκ]/[EHF − EF CI] × 100%
κ = 2 κ = 3 κ = 4 κ = 5 κ = 6
100.0
28.7
32.2
8.8
100.0
11.9
34.0
1.0
16.4
0.6
100
4.4

-
100.0
-
100.0
33.9
-

42.1
50.0
29.7
11.2
3.4
26.9

-
-
-
-
100
-

41

