4
0
0
2
 
v
o
N
 
9
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
4
0
1
1
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Importance of electronic self-consistency in the TDDFT based treatment of
nonadiabatic molecular dynamics

T.A. Niehaus,1 D. Heringer,1 B. Torralva,2 and Th. Frauenheim1
1 Dept. of Theoretical Physics, University of Paderborn,D - 33098 Paderborn, Germany
2Chemistry and Materials Science, Lawrence Livermore NationalLaboratory, Livermore, CA 94550, USA
(Dated: February 21, 2014)

A mixed quantum-classical approach to simulate the coupled dynamics of electrons and nuclei
in nanoscale molecular systems is presented. The method relies on a second order expansion of
the Lagrangian in time-dependent density functional theory (TDDFT) around a suitable reference
density. We show that the inclusion of the second order term renders the method a self-consistent
scheme and improves the calculated optical spectra of molecules by a proper treatment of the coupled
response. In the application to ion-fullerene collisions, the inclusion of self-consistency is found to be
crucial for a correct description of the charge transfer between projectile and target. For a model of
the photoreceptor in retinal proteins, nonadiabatic molecular dynamics simulations are performed
and reveal problems of TDDFT in the prediction of intra-molecular charge transfer excitations.

I.

INTRODUCTION

Beginning with the work of Zangwill and Soven [1],
the generalization of density functional theory to time
dependent phenomena (TDDFT) has become an impor-
tant tool in the description of laser-matter interaction.
The possible applications are diverse and range from the
calculation of spectra (linear optical [2, 3, 4], circular
dichroism [5, 6], resonant Raman [7]) to the evaluation
of properties (polarization [8, 9], hyperpolarization [10])
up to studies of high harmonic generation [11, 12, 13]
and photochemical reactions [14]. The formal justiﬁca-
tion of TDDFT was laid by Runge and Gross [15], who
showed that the exact many body electron density can be
obtained from single-particle mean ﬁeld equations. The
solution of these time dependent Kohn-Sham (TDKS)
equations can be obtained either perturbatively in the
small amplitude limit [16] or by direct numerical integra-
tion in the time domain [17]. Both approaches have their
inherent merits and disadvantages.

In the linear response regime, for example, the problem
can be recast in an eigenvalue equation in the particle-
hole representation. This allows for an interpretation of
optical spectra in terms of contributing single-particle
transitions and also for a symmetry assignment of the
states. Moreover, transitions with vanishing oscillator
strength can be located, like dark singlet or generally
triplet states [61]. One of the drawbacks of this approach
is the rather poor numerical performance with a scaling
of N 6 , where N is the number of electrons. It should be
noted, however, that the CPU time as well as the mem-
ory demand can be signiﬁcantly reduced when iterative
procedures like the Davidson algorithm are employed.

In terms of scaling behavior, the numerical integration
of the TDKS equations is much more favorable. Here,
only the set of occupied orbitals needs to be treated. Be-
cause the propagation involves only matrix-vector prod-
ucts, linear scaling can be achieved for large systems [19].
Moreover, since this approach is not restricted to small
intensities, non-linear eﬀects like harmonic generation or

multiphoton processes can be addressed. Another advan-
tage of working in the real time domain is the possibility
to study systematically the eﬀect of diﬀerent pulse shapes
of the laser ﬁeld on observables such as ionization [20].
With todays femtosecond laser sources, this is currently
an active ﬁeld of experimental research [21].

Nearly all ﬁrst principles applications of the real time
approach have been limited to systems with ﬁxed nu-
clei. Clearly, it would be highly desirable to study the
motion of the coupled system of electrons and nuclei,
which would allow one to address problems like laser in-
duced vibrational excitation or photochemical reactions.
Since the time step of such molecular dynamics simu-
lations is set to attoseconds by the ultrafast electronic
motion, only small systems with a few degrees of free-
dom can be treated in an ab initio frame work [13, 20].
Consequently, approximate TDDFT methods are quite
successful in this domain of application.

Diﬀerent groups contributed to this ﬁeld and used their
developments in a variety of diﬀerent studies [14, 22, 23,
24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39].
In all these approximate schemes only the valence elec-
trons are treated explicitely and the TDKS orbitals are
expanded in a limited (usually minimal) basis of atomic
orbitals. The Lagrangian, which is a functional of the
time dependent density, is then expanded around a static
reference density up to a certain order. In zeroth order
the Hamiltonian depends only on the reference density,
which permits the calculation of the necessary matrix el-
ements once and for all. In this respect, the methods are
similar to tight-binding approaches, although no ﬁtting
to experimental data is performed.

The purpose of this work is to analyze the implica-
tions of extending the mentioned expansion, since all
studies so far were restricted to zeroth order. After a
more detailed description of the problem in Sec. II, we
test the extension in the determination of optical spec-
tra in Sec. III A as well as for nonadiabatic molecular
dynamics in Sec. III B. Finally, we perform an investiga-
tion of the photochemical reaction of a retinal analogue,

=

L

1
2

MA ˙R2
A

A
X

occ

−

i
X

Ψi(t)
|

h

H[ρ](r t)

i

∂
∂t |

−

Ψi(t)

EDC

Eii.

i −

−

≈

AB
X

a chromophore which exhibits an ultrafast radiationless
deactivation in nature.

II. METHOD

In order to study the dynamics of a coupled system
of electrons and nuclei, the equations of motion (EOM)
need to be determined. While the electronic EOM in
the framework of DFT is given by the well known time
dependent Kohn-Sham equations, the nuclear EOM or
force equation is not a priori evident. It can be derived
either by exploiting the fact that the total energy is a
conserved quantity, or by applying the Lagrange formal-
ism. We follow the latter approach here and deﬁne the
following Lagrangian, which depends on the TDKS states
Ψi(t) and the nuclear positions RA:

Here the ﬁrst term is the classical kinetic energy of the
ions, while the remaining terms in Eq. (1) can be ob-
tained from the TDDFT action functional under the as-
sumption that the exchange-correlation (xc) contribu-
tions are local in time [44].
In this widely used adia-
batic local density approximation, standard ground state
functionals can also be used in the time dependent con-
text simply by evaluation at the time dependent density.
Thus, the Hamiltonian H[ρ](r t) in Eq. (1) takes the com-
mon DFT form. Furthermore, EDC represents the double
counting terms

EDC =

1
2

−

Z Z

′ ρ(r t)ρ(r′t)

r
|

−

r′

|

+ Exc[ρ]

vxc[ρ]ρ(r t),

−

Z

′

R

R

R

).

dr as

(2)
and Eii the ion-ion repulsion (Here and in the following
, and

dr′ is abbreviated as
We now proceed by applying the same kind of approx-
R
imations as were used in the derivation of the density
functional theory based tight-binding (DFTB) method
[40, 41] from static DFT. To keep the presentation con-
cise we refer to some reviews [38, 39], which provide a
more detailed description of the basic concepts, practical
realization and accuracy of the ground state DFTB ap-
proach. Here, we only report aspects, which are speciﬁc
for the generalization to the time-dependent case. In a
ﬁrst step, the Lagrangian is expanded around a reference
density ρ0(r), ρ(r t) = ρ0(r) + δρ(r t), which is given as a
superposition of atomic (ground state) densities. In con-
trast to our earlier work [39], we now include terms up

2

i
(3a)

−

(3b)

to second order in the density ﬂuctuations δρ(r t):

1
2

MA ˙R2

A −

Ψi(t)

H[ρ0](r)

|

i

∂
∂t |

−

Ψi(t)

occ

h

i
X

L ≈

A
X

1
2

1
2

Z

(cid:19)

+

′ ρ0(r)ρ0(r′)

Z Z

r
|

−

r′

|

−

Exc[ρ0] +

vxc[ρ0]ρ0(r)

Eii

′

1

−

r
|

(cid:18)

−

r′

|

Z Z

+

δvxc[ρ](r t)
δρ(r′t)

δρ(r t)δρ(r′t). (3c)

The terms in Eq. (3b) can now be subsumed as Erep, a
sum of short ranged pair potentials, which depend only
on the atomic species and the interatomic distance. Since
Erep is a functional of the time independent reference
density ρ0 only, it is exactly the same as used in the
ground state DFTB scheme. The second order term of
Eq. (3c), which is the focus of this work, is approximated
as follows:

E2nd =

(1)

′

1

r′

+

δvxc[ρ](r t)
δρ(r′t)

r
|

Z Z

(cid:18)

−

|
∆qA(t)γAB∆qB(t).

(cid:19)

1
2
1
2

δρ(r t)δρ(r′t)

(4)

(5)

Here the ∆qA(t) denote atomic net Mulliken charges

∆qA(t) = qA(t)
occ

−

qfree atom
A

qA(t) =

1
2

b∗
µi(t)bνi(t)Sµν + b∗

νi(t)bµi(t)Sνµ

,

i
X

µ∈A,ν
X

(cid:1)
where the coeﬃcients bµi(t) are deﬁned by the expansion
of the TDKS states in a basis of non-orthogonal atomic
orbitals φµ(r

RA)

(cid:0)

−
Ψi(r t) =

µ
X

bµi(t)φµ(r

RA),

−

(6)

φν
|

φµ
h

. Further,
which build the overlap matrix Sµν =
i
the function γAB in Eq. 4 interpolates between a pure
Coulomb interaction for large interatomic distances and
an element-speciﬁc constant in the atomic limit. This
numerically evaluated parameter includes the eﬀects of
exchange and correlation and is directly related to the
chemical hardness of the atomic species [41]. Taking
the coeﬃcients and nuclear positions as generalized coor-
dinates, the evaluation of the Euler-Lagrange equations
leads to the desired equations of motion. The electronic
motion obeys:

˙bνi =

−

δµ

X

S−1
νδ

"

iHδµ +

˙RA

∂
∂RA

φδ
h

|

φµ

bµi

i#

A
X

with

Hµν =

φµ
h

φν
H[ρ0]
|
|
µν + H 1

µν ;

= H 0

i

1
2

C
X
A; ν

B.

∈

µ

∀

∈

+

Sµν

(γAC + γBC )∆qC .

(7a)

(7b)

In zeroth order the Hamiltonian reduces to the ﬁrst term
in Eq. (7b) and depends solely on the reference density
ρo. For systems in the excited state or in charged or het-
eronuclear structures, the electronic density diﬀers sig-
niﬁcantly from a simple superposition of atomic ground
state densities. To a certain extent this diﬀerence is al-
ready captured at the zeroth order level due to the time-
dependent orbital coeﬃcients. This is similar to the sit-
uation in empirical tight-binding schemes, where even
certain ionic crystals are suﬀciently well described [42].
But obviously, a consideration of the full Hamiltonian
in Eq. (7b) leads to a more balanced treatment, since
dynamical changes in the electron density are explicitly
included in a selfconsistent fashion.

Solution of Eq. (7a) requires an iterative procedure
with timesteps in the attosecond regime. We use a sym-
plectic algorithm for this task [37].
It is based on the
Cayley representation of the time evolution operator and
conserves the norm of the wavefunction exactly. Besides
the Hamiltonian and overlap matrices (see Ref. [39] for
details of the construction) , Eq. (7a) contains also the
, in which all
nonadiabatic coupling matrix
i
on-site elements (φµ, φν on the same atom) are set to zero
[43]. This allows one to relate the remaining elements to
a simple derivative of the overlap matrix.

∂
∂RA φν

φµ
h

|

Variation of the Lagrangian with respect to the nu-
clear coordinates leads to the following expression for the
forces:

MA ¨RA =

occ

−

+

−

µν
X

occ

i
X
1
2

i
X
∆qA

B
X

b∗
µibνi

dH 0
µν
dRA

+

dSµν
dRA

 

γAB∆qB

!

B
X

b∗
µi

dSµν
dRA

S−1
νδ Hδγbγi + c.c.

(cid:19)

µνδγ (cid:18)
X

dγAB
dRA

∆qB

dErep
dRA

.

−

(8)

Since the Hamiltonian is time dependent due to an ex-
ternal ﬁeld or nuclear motion, the molecular orbital coef-
ﬁcients will in general represent a coherent superposition
of diﬀerent eigenstates of the system. In this case, the nu-
clei move in a mean potential according to Eq. 8, rather
than being restricted to a particular Born-Oppenheimer
surface as in conventional adiabatic MD approaches. In
fact, due to the coupling of the EOM, energy can be freely
exchanged between the electronic and ionic subsystems
as long as the total energy of the system is conserved.
Equations of motion that are equivalent to the ones re-
ported here, have been derived earlier by Saalmann and
Schmidt [29] as well as Todorov [36]. Including the sec-
ond order correction, they are solved here for the ﬁrst
time in an actual calculation.

Todorov pointed out, that for an incomplete basis the
force equation has to be augmented by additional velocity
dependent terms, which should become important in high
energy collisions. Interestingly, omission of these terms

3

FIG. 1: Schematic illustration of trans-butadiene (C4H6).

does not violate energy but only momentum conserva-
tion. Hence, it is useful to monitor the total momentum
(electronic + ionic) of the system if Eq. (8) is used, as in
every practical calculation the basis set is incomplete.

Finally, in order to simulate the interaction with elec-
tromagnetic ﬁelds, the vector potential A(r t) needs to
be incorporated, which is done via minimal coupling,
e
p
c A. A numerically eﬃcient approximation was pro-
posed by Graf and Vogl [45] and later by Allen [22] and
is given by:

−

Hµν [r, p, A(t)] = exp

(RA

ie
~c

(cid:20)

×

−

RB)A(t)
(cid:21)

∈

∈

Hµν[r, p]; µ

A, ν

B, (9)

which relates the desired ﬁeld dependent Hamiltonian to
the already known matrix elements of the unperturbed
one. Expression (9) was derived under the assumption
that the radiation wavelength is much larger than the
molecular system under study, which is usually well ful-
ﬁlled for frequencies in the optical range. It should be
mentioned, that Eq. (9) in principle holds for arbitrarily
strong ﬁelds in contrast to the electric dipole approxima-
tion.

If the interest is just on calculating optical spectra,
rather than the molecular motion initiated by a laser
pulse, only Eq. (7a) needs to be solved for a ﬁxed ge-
ometry. Following the approach of Yabana and Bertsch
[17, 46] the ﬁeld in Eq. (9) is turned on only at a certain
instant of time, which populates the complete manifold of
excited states. The time dependent dipole moment d(t)
can then be used to calculate the dynamic polarizability:

~c
eA

α(ω) =

eiωt (d(t)

d(0)) dt,

(10)

−

Z
and the dipole strength function S(ω) = 2ω/π
α(ω) of
the system; a quantity which can be directly compared
to experimental spectra.

ℑ

III. APPLICATIONS

A. Optical spectrum of trans-butadiene

As a ﬁrst application of our method, we examine a pro-
totypical π-system, trans-butadiene (Fig. 1). The optical
spectrum of this molecule has been the subject of numer-
ous quantum chemical studies (see e.g. Ref. 48 and ref-
erences therein). Recently, also a detailed investigation
of the molecular dynamics in the excited state appeared
[14]. Dou et al. employed the DFTB method described

Zeroth order
Second order

]
s
t
i
n
u
 
.
b
r
a
[
 
h
t
g
n
e
r
t
s
 
e
o
p
D

i

l

 90

 80

 70

 60

 50

 40

 30

 20

 10

 0

 0

 2

 4

 6

 8

 10

Energy [eV]

FIG. 2: Dipole strength of trans-butadiene as given by the
time-dependent DFTB method in zeroth and second order
[47]. Shown is an average over diﬀerent molecular orienta-
tions with respect to the polarization of the vector potential.
Results obtained in the DFTB linear-response implementa-
tion of TDDFT are shown as stick spectrum. The associated
oscillator strengths have been normalized to the maximum of
the highest energy peak.

in this work without the second order correction. Our
interest here is to analyze the implications of including
this term. To this end, we ﬁrst relaxed the molecule with
the ground state DFTB method and recorded the optical
spectrum according to the prescription given in Sec. II.
After applying a vector potential of A = 0.0125 gauss cm,
the Kohn-Sham orbitals were propagated for 38.7 fs with
a time step of 12 as. Since the ﬁnite sampling introduces
spurious negative parts in the imaginary part of the po-
larizability, the dipole moment was damped with a factor
of e−kt (k = 0.3 eV/~), like in Ref. 17. This also sim-
ulates dephasing or other line broadening eﬀects which
would appear more naturally in a more complete theory.
The resulting spectrum with and without second order
correction is shown in Fig. 2. As can be seen, the max-
imum absorption in the latter method is located at 4.21
eV. This is exactly the diﬀerence of the LUMO (lowest
unoccupied molecular orbital) and the HOMO (highest
occupied molecular orbital) energies of the ground state
DFTB method. If the second order term is included in
the calculation, the absorption is strongly blue shifted to
5.56 eV, which is in good agreement with the experimen-
tal value of 5.8 eV [49]. Along with the energy shift, a
reduction of absorption strength is also observed.

To better understand the origin of these changes, we
also performed calculations with our implementation of
the TDDFT linear response formalism [50]. In this ap-
proach, excited state singlet energies ωI are given by the
solution of the following eigenvalue problem:

ω2

ijδikδjl + 2√ωijKij,kl√ωkl

kl = ω2
F I

I F I
ij .

(11)

kl
X

(cid:2)

(cid:3)

Here the ωij are energy diﬀerences between unoccupied

4

(12)

orbitals j and occupied orbitals i, while the so called cou-
pling matrix K describes the change of the SCF potential
due to the induced density. As Eq. (11) shows, the eﬀect
of the coupling matrix is not only to shift the true excited
state away from simple orbital energy diﬀerences, but
also to couple diﬀerent single-particle transitions. The
explicit form of K is given by:

′

Kij,kl =

ψi(r)ψj (r)

Z Z

1

×

r
|

(cid:18)

−

r′

|

+

δvxc[ρ](r)
δρ(r′)

(cid:19)

ψk(r′)ψl(r′),

which is nothing else than the second order term of
Eq. (3c), when the induced density is expanded in
particle-hole states. The results of the linear response
calculations with and without the coupling matrix con-
tribution are given as stick spectrum in Fig. 1. Obvi-
ously, there is a perfect match beween the real time and
linear response approaches to TDDFT both in the ener-
getical position of the states and the oscillator strength.
This equivalence had to be expected, since the linear
response approach amounts to a perturbative solution
of the TDDFT equations in the small amplitude limit.
However, to our knowledge this has so far never been
shown in practical calculations.

B. C+ − C60 collisions

Ion-cluster collisions provide an ideal application ﬁeld
for approximate TDDFT molecular dynamics simula-
tions. This is because the number of degrees of free-
dom is usually too large to be treated with ﬁrst princi-
ples calculations and also nonadiabatic eﬀects are strong
and important. Depending on the velocity of the pro-
jectile, collisions can induce vibrational or a combina-
tion of electronic and vibrational excitations of the clus-
ter, where the latter type cannot be described in con-
ventional Born-Oppenheimer dynamics. In this context,
Kunert and Schmidt undertook a systematic investiga-
tion of ion-fullerene collisions and provided an explana-
tion for seemingly conﬂicting experimental observations
[34]. Their nonadiabatic quantum molecular dynamics
(NA-QMD) method is essentially equivalent to the DFTB
scheme described here in the zeroth order approximation.
Accordingly, it is interesting to see whether the second
order correction is of any beneﬁt in these kind of simula-
tions.

For the special case of C+

C60 collisions we performed
−
calculations for diﬀerent values of the impact velocity (v
= 0.01 . . . 0.45 a.u.) and impact parameter (b =2.0,7.5
a.u.) for randomly oriented fullerene cages. Special care
had to be taken in the deﬁnition of the initial conditions
of the EOM, since the C+
C60 conﬁguration does not
−
correspond to the ground state of the system. For that
reason, we performed separate ground state calculations
for the two subsystems and combined the resulting KS

5

]

V
e
[
 

E
∆

 300

 250

 200

 150

 100

 50

 0

]
e
[
 
e
g
r
a
h
c
 
e

l
i
t
c
e
o
r
P

j

 0.8

 0.6

 0.4

 0.2

 0

-0.2

-0.4

-0.6

-0.8

-1

 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

 0.35

 0.4

 0.45

 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

 0.35

 0.4

 0.45

Impact velocity [a.u.]

Impact velocity [a.u.]

FIG. 3: Total kinetic energy loss ∆E of the projectile in the
center of mass system for an impact parameter of b = 2.0 a.u.
For each velocity three trajectories with random cage orien-
tation were calculated; error bars correspond to the standard
deviation. Dark squares: second order, open circles: zeroth
order DFTB results, open triangles: loss due to electronic ex-
citation, obtained from the diﬀerence of time-dependent and
ground state energy in the zeroth order DFTB scheme.

orbitals to obtain the desired charge state. The initial
ion-cluster distance was chosen large enough to prevent
any interaction and the system was then left to evolve
freely according to the EOM [Eq. (7a) and (8)].

Fig. 3 depicts the total kinetic energy loss ∆E in the
center of mass system that the projectile experiences due
to the collision. It can be directly compared to the re-
sults in Fig. 3 of Ref. 34, which were obtained for a
single ﬁxed collision geometry. As already shown there,
the vibrational excitation of the fullerene dominates for
smaller velocities (v < 0.1 a.u.), while mostly electronic
excitation is responsible for the energy loss at larger im-
pact energies. As the impact velocity increases, ∆E ﬁrst
rises, peaks around 0.05 a.u and shows a weak increase
beyond 0.1 a.u. in our calculations. This is in variance
with the results of Kunert and Schmidt [34], which claim
velocity-independent excitation energies in the high ve-
locity range. Taking the strong dependence on the col-
lision geometry into account, an extensive phase space
sampling would be necessary to resolve this issue, which
is outside the scope of this work.

Turning now to a comparison of the predictions of
DFTB with and without second order correction, we ﬁnd
only marginal diﬀerences in the results of both methods.
Such a diﬀerence could have been expected for high im-
pact velocities, but with such a large amount of energy
deposited in the cluster, ﬁner details of the electronic
structure seem to have negligible inﬂuence.

The second order correction has however implications
for other observables. Fig. 4 shows the charge of the pro-
jectile after the collision. Here fractional charges need
to be understood in the probabilistic interpretation of

FIG. 4: Charge of the carbon atom after the collision with
C60 for diﬀerent values of the impact velocity and an impact
parameter of b = 7.5 a.u. . For each velocity three trajecto-
ries with random cage orientation were calculated; error bars
correspond to the standard deviation. Dark squares: second
order, open circles: zeroth order DFTB results.

TABLE I: Energy ordering of diﬀerent asymptotic states of
the singly positively charged C−C60 system in eV. The DFTB
energies with and without second order correction were ob-
tained by separate calculations of the two subsystems and ad-
dition of the results. For C60, all calculations were performed
at the DFTB optimized geometry of the neutral species. The
experimental results were obtained from measured ionization
potentials and electron aﬃnities [51, 52, 53]. The most stable
state of each method was set to zero energy.

C
+
0
–

C60
0
+
2+

zeroth order
0.0
0.58
1.16

second order
2.68
0.0
10.80

exp.
3.66
0.0
7.14. . .9.14

quantum mechanics, since in the simulations the sys-
tem remains in a superposition of eigenstates with in-
teger charges also asymptotically. For higher velocities,
which correspond to higher electronic excitation as men-
tioned above, the charge given by the zeroth order DFTB
method is signiﬁcantly more negative than the second or-
der one. This can be explained by a larger contribution
of the asymptotic C−
C2+
60 state, which in the zeroth
order approximation is located only slightly higher in en-
ergy as the initial C+
60 state. As the results in Tab. I
show, this energy ordering is in striking contrast with the
one given by the second order DFTB method and ex-
periment. Although calculations of charge transfer cross
sections have been performed in a zeroth order scheme
[32, 33], the results of this section suggest, that in general
a more advanced treatment is absolutely necessary.

−
C0

−

+

H

N

H

H

N+
H

FIG. 5: Top: Structure of 11-cis retinal, which is found in
dark adapted rhodopsin and transforms to the all-trans form
upon absorption of light. Bottom: Protonated Schiﬀ base
model used in this study.

C. Protonated Schiﬀ base photodynamics

≈

As a last application we study the photodynamics of
the retinal molecule, which is of special importance in the
ﬁeld of biology. This chromophore is found in a variety
of proteins, where it initiates quite diﬀerent reactions in
the cell. In bacteriorhodopsin and halorhodopsin for ex-
ample, light absorption of retinal triggers the membrane
transport of protons and chloride ions, respectively. In
contrast, it starts a cascade of reactions that initiate the
In all these systems, the
vision process in rhodopsin.
retinal is known to isomerize around a speciﬁc double
bond. The quantum yield of the photoreaction is partic-
ularly high (Φ
0.7) and the deexcitation to the ground
state occurs in no more than 200-500 fs [54, 55]. Be-
cause of these unusual features, this system provides an
interesting subject for a theoretical investigation. For
a complete understanding of the retinal photodynamics
it would certainly be necessary to include the full pro-
tein environment in such an investigation. However, im-
portant information can already be drawn from the ex-
amination of small retinal analogues like the protonated
Schiﬀ bases (Fig. 5). These models share a polyene chain
of alternating single and double bonds with retinal, as
well as the positively charged NH+
2 Schiﬀ base group,
which is crucial for the function of the chromophore in
the protein. High level quantum chemical CASPT2 cal-
culations on these analogues revealed, that after absorp-
tion the system moves out of the Franck-Condon region
along the C=C stretch normal coordinate (see Ref. 56
and references therein). After inversion of single and dou-
ble bonds, torsion around the central C=C bond sets in.
A barrierless path then leads to a conical intersection of
ground and excited state, where eﬃcient deactivation to
the photoproduct occurs. In line with Stark spectroscopy
[57, 58], CASPT2 theory predicts a large charge transfer
from the Schiﬀ base group to the other terminus upon
excitation, that increases along the excited state path-
way.

Recently, we investigated the excited state potential

6

energy surface (PES) obtained from static DFTB calcu-
lations in the linear response formalism and found se-
vere deviations from the CASPT2 results [59]. In fact,
the only barrierless paths found to conical intersections
with the ground state involved single rather than double
bond isomerization (in accordance with ab initio TDDFT
calculations). An intrinsic reaction coordinate connect-
ing Franck-Condon point and correct conical intersection
(as described in the CASSCF model) includes a signif-
icant barrier. Thus an eﬃcient and ultrafast reaction
seems to be unlikely at the DFT level of theory. How-
ever, one should keep in mind, that at ﬁnite temperature
molecules posses a signiﬁcant amount of kinetic energy
already at the Franck-Condon point, which allows the
system to sample a large fraction of the excited state
PES. Hence, the minimum energy path might not neces-
sarily provide a representative description of the photo-
dynamical pathway. Moreover, nonadiabatic transitions
are not restricted to conical intersections. They can also
occur in regions where there is a ﬁnite gap between the
ground and excited state surfaces, especially when the
atomic velocity is high. Our interest is therefore to per-
form nonadiabatic molecular dynamics simulations of the
PSB model system to see whether the discrepancies be-
tween DFT predictions and experiment remain at a full
dynamical level.

A complete description of the photochemical process
would in principle require a full phase space sampling
prior to excitation. Since the maximum absorption is
strongly geometry dependent, we nevertheless take only
the relaxed geometry of the ground state minimum into
account. At the Franck-Condon point random velocities
corresponding to a temperature of 300 K are assigned to
the atoms and the system is left to evolve freely without
further constraints. The excitation itself is induced by
a Gaussian shaped laser pulse with a central frequency
of 3.45 eV, that is slightly detuned with respect to the
maximum absorption to avoid population of higher ex-
cited states close in energy. The maximum absorption
itself is located at 3.88 eV in the second order DFTB
method and agrees well with ﬁrst principles TDDFT cal-
culations [59] (4.03 eV) as well as CASPT2 [60] (4.02 eV)
and experiment (3.85 - 4.25 eV [61]). Similar to the case
of trans-butadiene, the excitation energy is strongly un-
derestimated at 2.66 eV, if the second order correction
is not taken into account. Since the nonadiabatic excita-
tion process depends strongly on the gap between ground
and excited state PES, the DFTB method without elec-
tronic selfconsistency will therefore provide an unrealistic
description of the photodynamics and will not be used
here. The duration and ﬂuence of the laser pulse were
chosen to be 5.9 fs and 5.4 mJ/cm2 (A = 0.7 gauss cm).
For these parameters, the total energy of the system rises
by 3.88 eV, i.e. a one-photon transition to the ﬁrst ex-
cited state is simulated. For a total simulation time of
1.1 ps, 100 trajectories were propagated with a timestep
of 12.1 as. This guaranteed an energy conservation of
10−8. With these parameters, one trajectory
∆E/E

≈

 10

 20

 30

 40

 50

 60

 200

 400

 600

 800

 1000

Time [fs]

Time [fs]

FIG. 6: Bond alternation in the PSB model system for all
calculated trajectories, estimated as the mean bond length
diﬀerence between neighboring C-C single and double bonds.

FIG. 8: Excitation energy of the PSB model versus time in
eV. The inset shows the transition to the excited state due to
the applied laser pulse.

]
.
g
n
A

[
 
n
o
i
t
a
n
r
e
t
l
a
 
d
n
o
B

l

e
g
n
a
 
l
a
r
d
e
h
D

i

 0.2

 0.15

 0.1

 0.05

 0

-0.05

-0.1

 50

 40

 30

 20

 10

 0

-10

-20

-30

-40

 0

 200

 400

 600

 800

 1000

Time [fs]

FIG. 7: Torsion angle around the central double bond of the
PSB model for all calculated trajectories.

took about 22 minutes CPU time on an Intel Xeon 3.06
GHz processor.

The results of the simulations show that the initial dy-
namics on the excited PES are dominated by C-C stretch
motions with large amplitudes up to 0.15 ˚A. This is in
agreement with resonant Raman studies on the PSB in
solution and in the rhodopsin protein [63, 64, 65].
In
contrast to the mentioned CASPT2 calculations however,
the bond alternation is only inverted for roughly half of
the trajectories as shown in Fig. 6. Moreover, the time-
averaged bond alternation of 0.060 ˚Ais only slightly re-
duced with respect to the ground state minimum (0.063
˚A). Considering now the dihedral angle which represents
the torsion around the central double bond, Fig. 7 shows
that none of the 100 trajectories resulted in a success-
ful isomerization within 1 ps. We ﬁnd much larger am-
plitudes for the rotation around single bonds, with tor-
sion angles up to 80◦ for certain trajectories, although
also here no isomerization is completed in the simulation
time. This preference of single over double bond iso-
merization in DFT based methods was already found in
the static investigation of Ref. 59. Another prediction of

7

]

V
e
[
 
y
g
r
e
n
e
 
n
o
i
t
a
t
i
c
x
E

 4.5

 4

 3.5

 3

 2.5

 2

 1.5

 1

 0.5

 0

 0

 4.5

 4

 3.5

 3

 2.5

 2

 1.5

 1

 0.5

 0

 0

 1

 2

 3

 4

 5

CASPT2 theory, which is in nice agreement with Stark
spectroscopy has already been mentioned. The S0
S1
excitation and the subsequent motion on the S1 PES is
known to involve a large charge transfer away from the
Schiﬀ base group. We however, do not observe any sig-
niﬁcant charge transfer in our simulations.

−

≈

Finally, it is interesting to analyze whether deexcita-
tion to the ground state occurred. In Fig. 8 the excitation
energy of the system is shown, which is given by the dif-
ference of the time-dependent and ground state energy
at the same geometry. Directly after the end of the laser
pulse, a small reduction of the excitation energy is ob-
served (
0.3 eV), which is related to an elongation of all
bonds in the PSB model. There is little change from this
point on and nonadiabatic transitions, which would man-
ifest in a sharp drop of the excitation energy, do not oc-
cur. In our DFT based treatment, deactivation is there-
fore predicted to happen on longer timescales, presum-
ably involving the slower processes of internal conversion
and ﬂuorescence. At any rate, ultrafast isomerization
with a concomitant intersection of ground and excited
state is not found to be the dominant process. This is
in stark contrast to the results of Vreven et al. [66], who
showed that double bond isomerization can occur in less
than 100 fs for the model at hand.

The simulations of this section could be extended by
computing a larger number of trajectories or a longer
propagation time. Considering the narrow distribution
of the results presented in Fig. 6 to 8, it is not very
likely that an improved sampling would reveal new in-
formation. Extension of the simulation time might seem
advantageous in light of the experiments by Logunov et
al. [67], who measured an excited state life time of 2-3
ps for the full retinal chromophore [Fig. 5 (top)] in solu-
tion. However, for the shorter PSB model used in this
study, the excited state PES has been found to be much
steeper [56] in line with the mentioned study of Vreven
et al. [66]. Hence, the photochemical process should be
completed in the chosen simulation time of 1 ps.

To summarize, we ﬁnd that our simulations disagree
in most aspects with CASPT2 results and experiment.
At the same time we conﬁrmed the static investiga-
tions of the DFT based potential energy surfaces from
Ref. 59 by dynamical calculations. Given that, (i) time-
dependent DFTB and ﬁrst principles TDDFT, as well
as, (ii) TDDFT with diﬀerent exchange-correlation func-
tionals (local, gradient corrected or hybrid) yield qualita-
tively the same picture [59], a correct DFT based descrip-
tion of the retinal photodynamics is highly unlikely. Only
very recently, failures of TDDFT in the description of
inter-molecular charge transfer states were reported [68].
Exchange-correlation functionals that address this short-
coming have also been recently proposed [69, 70, 71]. It
will be interesting to see whether these developments can
also remedy the problems with intra-molecular charge
transfer found here.

IV. SUMMARY

In this work, we presented a mixed quantum-classical
approach to simulate the coupled dynamics of electrons
and nuclei. The method is based on a second order ex-
pansion of the TDDFT Lagrangian around a suitable
reference density. We showed that the inclusion of the
second order term improves both qualitatively and quan-
titatively the optical spectrum of molecules. For trans-
butadiene a strong blueshift of the absorption was ob-
served together with a signiﬁcant reduction of oscillator
strength.
In this context, the analogy with the linear
response approach to TDDFT revealed that the zeroth
order treatment of the Lagrangian corresponds to an un-
coupled response that neglects collective eﬀects. More-
over, experience with the linear response implementation

8

−

−

π∗ transitions. For n

suggests that this absorption shift is quite general and
π∗ excita-
especially large for π
tions however, the coupling is usually weak and realistic
results might already be achieved in the zeroth order ap-
proximation. In the simulations of high energy collision
of Sec. III B, there is little diﬀerence in the predictions
of both schemes when the interest is in energy transfer
only. This is because the process is dominated by vibra-
tional rather than electronic excitation in the regime of
low energy transfer, where the diﬀerent level structure
could be resolved. Considering now the charge transfer,
we found important diﬀerences for the C+
C60 system,
which were attributed to the problematic description of
the asymptotic states in the zeroth order scheme. Charge
transfer played also an important role in the nonadiabatic
molecular dynamics simulations of the protonated Schiﬀ
base. In contrast to experiment we found no isomeriza-
tion. This result is a negative, but we think important
one.
It should be stressed, that this failure is not in-
troduced by our approximations but already inherent in
TDDFT itself.

−

Acknowledgements

The authors thank G. Seifert and M. Wanko for fruitful
discussion and careful reading of the manuscript. This
work is supported by the DFG within the Interdisci-
pliniary Research Group Molecular Mechanisms of Reti-
nal Protein Action and by the Research Training Group
GK-693 of the Paderborn Institute for Scientiﬁc Compu-
tation (PaSCo). The work of B. Torralva was performed
under the auspices of the U. S. Department of Energy
by the University of California, Lawrence Livermore Na-
tional Laboratory under Contract No. W-7405-Eng-48.

[1] A. Zangwill and P. Soven, Phys. Rev. A 21, 1561 (1980).
[2] R. Bauernschmitt and R. Ahlrichs, Chem. Phys. Lett.

[3] I. Vasiliev, S. ¨O˘g¨ut, and J. R. Chelikowsky, Phys. Rev.

256, 454 (1996).

Lett. 82, 1919 (1999).

[4] P. L. de Boeij, F. Koostra, J. A. Berger, R. van Leeuwen,
and J. G. Sniders, J. Chem. Phys. 115 1995 (2001).
[5] F. Furche, R. Ahlrichs, C. Wachsmann, E. Weber, A.
Sobanski, F. Vogtle, and S. Grimme, J. Am. Chem. Soc.
122 1717 (2000).

[6] K. Yabana, and G. F. Bertsch, Phys. Rev. A 60, 1271

[7] D. Heringer, T. A. Niehaus, M. Wanko, and Th. Frauen-

(1999).

heim, to be published.

[8] S. J. A. van Gisbergen, J. G. Snijders, and E. J. Baerends,

Chem. Phys. Lett. 259, 599 (1996).

[9] S. J. A. van Gisbergen, V. P. Osinga, O. V. Gritsenko,
R. van Leeuwen, J. G. Snijders, and E. J. Baerends, J.
Chem. Phys. 105, 3142 (1996).

[10] S. J. A. van Gisbergen, J. G. Snijders, and E. J. Baerends,

Phys. Rev. Lett. 78, 3097 (1997).

[11] C. A. Ullrich, S. Erhard, and E. K. U. Gross, in Sper
Intense Laser Atom Physics IV, edited by H. G. Muller
and M. V. Fedorov, (Kluwer,1996), p. 267-284.

[12] X. Chu and S. I. Chu, Phys. Rev. A 6302, art. no. 023411

[13] A. Castro, M. A. L. Marques, J. A. Alonso, G. F. Bertsch,

and A. Rubio, Eur. Phys. J. D 28, 211 (2004).

[14] Y. S. Dou, B. R. Torralva, and R. E. Allen, Chem. Phys.

Lett. 392, 352 (2004).

[15] E. Runge and E. K. U. Gross, Phys. Rev. Lett. 52, 997

[16] M. E. Casida, in Recent Advances in Density Functional
Methods, Part I, edited by D. P. Chong (Singapore, World
Scientiﬁc, 1995) p. 155.

[17] K. Yabana and G. F. Bertsch, Phys. Rev. B 54, 4484

(2001).

(1984).

(1996).

[18] Here it is assumed, that spin-orbit coupling is neglected.
[19] C. Y. Yam, S. Yokojima, and G. H. Chen, Phys. Rev. B

68, 10658 153105 (2003).

[20] F. Calvayrac, P. G. Reinhard, and E. Suraud, Eur. Phys.
J. D 9, 389 (1999); P. G. Reinhard, and E. Suraud, J.

9

(2002).

(2003).

(2003).

(1998).

(2001).

Clust. Sci. 10, 239 (1999); E. Suraud, and P. G. Rein-
hard, Phys. Rev. Lett. 85, 2296 (2000).

[21] T. Brixner, N. H. Damrauer, and G. Gerber, in Adv. in
At., Mol. and Opt. Phys. (Academic Press, 2001) Vol. 46,
p. 1-54.

[22] R. E. Allen, Phys. Rev. B 50, 18629 (1994).
[23] B. Torralva, T. A. Niehaus, M. Elstner, S. Suhai, T.
Frauenheim, and R. E. Allen, Phys. Rev. B 64, art. no.
153105 (2001).

[24] B. R. Torralva and R. E. Allen, J. Mod. Opt. 49, 593

[25] Y. S. Dou and R. E. Allen, J. Chem. Phys. 119, 10658

[26] Y. S. Dou, B. R. Torralva, and R. E. Allen, J. Mod. Opt.

50, 2615 (2003).

[27] Y. S. Dou, B. R. Torralva, and R. E. Allen, J. Phys.

Chem. A 107, 8817 (2003).

[28] Y. S. Dou and R. E. Allen, Chem. Phys. Lett. 378, 323

[29] U. Saalmann and R. Schmidt, Z. Phys. D 38, 153 (1996).
[30] U. Saalmann and R. Schmidt, Phys. Rev. Lett. 80, 3213

[31] R. Schmidt, O. Knospe, and U. Saalmann, Nuovo Ci-

mento Soc. Ital. Fis. A 110, 1201 (1997).

of these problems, the full spectrum is shown in order to
demonstrate the general principle.

[48] C.-P. Hsu, S. Hirata, and M. Head-Gordon, J. Phys.

Chem. A 105, 451 (2001).

[49] J. P. Doering, J. Chem. Phys. 70, 3902 (1979).
[50] T. A. Niehaus, S. Suhai, F. dela Salla, P. Lugli, M. El-
stner, G. Seifert und Th. Frauenheim, Phys. Rev. B 63,
085108 (2001).

[51] Ion Energetics Data in NIST Chemistry Webbook,
NIST Standard Reference Database Number 69, ed.
P.J. Linstrom and W.G. Mallard (National Institute of
Standards and Technology, Gaithersburg, MD, 2001)
(http://webbook.nist.gov).

[52] D. M. Cox, S. Behal, M. Disko, S. M. Gorun, M. Gre-
aney, C. S. Hsu, E. B. Kollin, J. Millar, J. Robbins, W.
Robbins, R. D. Sherwood, and P. Tindall, J. Am. Chem.
Soc. 113, 2940 (1991).

[53] H. Ajie, M. M. Alvarez, S. J. Anz, R. D. Beck,
F. Dieterich, K. Fostiropoulos, D. R. Huﬀman, W.
Kr¨atschmer, Y. Rubin, K. E. Schriver, D. Sensharma,
and R. L. Whetten, J. Phys. Chem. 94, 8630 (1990).
[54] A. Aharoni, B. Hou, N. Friedman, M. Ottolenghi, I.
Rousso, S. Ruhman, M. Sheves, T. Ye, and Q. Zhong,
Biochemistry (Moscow) 66, 1210 (2001).

[32] O. Knospe, J. Jellinek, U. Saalmann, and R. Schmidt,

[55] H. Kandori, Y. Shichida, and T. Yoshizawa, Biochem-

Eur. Phys. J. D 5, 1 (1999).

istry (Moscow) 66, 1210 (2001).

[33] O. Knospe, J. Jellinek, U. Saalmann, and R. Schmidt,

Phys. Rev. A 6102, art. no. 022715 (2000).

[34] T. Kunert and R. Schmidt, Phys. Rev. Lett. 86, 5258

[35] T. Kunert and R. Schmidt, Eur. Phys. J. D 25, 15 (2003).
[36] T. N. Todorov, J.Phys.: Cond. Matt. 13 10125 (2001).
[37] T. A. Niehaus, dissertation at the University of Pader-

born, http://www.ub.uni-paderborn.de (2001).

[38] T. Frauenheim, G. Seifert, M. Elstner, Z. Hajnal, G.
Jungnickel, D. Porezag, S. Suhai, and R. Scholz, phys.
stat. sol.(b) 217, 41 (2000).

[39] T. Frauenheim, G. Seifert, M. Elstner, T. Niehaus, C.
K¨ohler, M. Amkreutz, M. Sternberg, Z. Hajnal, A. Di
Carlo and S. Suhai, J. Phys.: Cond. Matt. 14 3015
(2002).

[40] D. Porezag, Th. Frauenheim, Th. K¨ohler, G. Seifert, R.

Kaschner, Phys. Rev. B 51, 12947 (1995).

[41] M. Elstner, D. Porezag, G. Jungnickel, J. Elsner, M.
Haugk, Th. Frauenheim, S. Suhai und G. Seifert, Phys.
Rev. B 58, 7260 (1998).

[42] H. M. Polatoglou and M. Methfessel, Phys Rev. B 37,

10403 (1988).

3693 (1995).

255 (1990).

[44] E. K. U. Gross and W. Kohn, Adv. Quantum Chem. 21,

[45] M. Graf and P. Vogl, Phys. Rev. B 51, 4940 (1995).
[46] M. A. L. Marques, A. Castro, G. F. Bertsch, and A.

Rubio, Comp. Phys. Comm. 151, 60 (2003).

[47] Please note that ionization, which sets in beyond 9.07
eV experimentally [51], can not be correctly described in
a localized basis. In this context, a grid representation
of the wavefunction together with an implementation of
absorbing boundary conditions like in Ref. 17 is more
appropriate. We would also like to mention, that the en-
ergetical position of the second state around 9 eV is likely
to be in error, since this excitation involves a transition
to an unbound orbital at the minimal basis level. In spite

[56] M. Garavelli, F. Bernardi, M. Olivucci, T. Vreven, S.
Klein, P. Celani, and M. A. Robb, Faraday Discuss. 110,
51 (1998).

[57] R. Mathies, and L. Stryer, Proc. Natl. Acad. Sci. USA

[58] M. Ponder and R. Mathies, J. Phys. Chem. 87, 5090

73, 2169 (1976).

(1983).

[59] M. Wanko, M. Garavelli, F. Bernardi, T. A. Niehaus, T.
Frauenheim, and M. Elstner, J. Chem. Phys. 120, 1674
(2004).

[60] M. Garavelli, F. Bernardi, M. Robb, and M. Olivucci,

Int. J. Photoenergy 4, 57 (2002).

[61] The experimental values from Ref. 62 correspond to simi-
lar but not completely equivalent structures. See also the
discussion of this point in Ref. 59.

[62] M. Arnaboldi, M. G. Motto, K. Tsujimoto, V. Balogh-
Nair, and K. Nakanishi, J. Am. Chem. Soc. 101, 7082
(1997); V. Balogh-Nair, J. D. Carriker, B. Honig, V. Ka-
mat, M. G. Motto, K. Nakanishi, R. Sen, M. Sheves,
M. Arnaboldi, and K. Tsujimoto, Photochem. Photobiol.
33, 483 (1981); R. F. Chields, G. S. Shaw, and R. E. Wa-
sylishen, J. Am. Chem. Soc. 109, 5362 (1987).

109 367 (1977).

[64] S. W. Lin, M. Groesbeek, I. van der Hoef, P. Verdegem,
J. Lugtenburg, and R. A. Mathies, J. Phys. Chem. 102
2787-2806 (1998).

[65] R. A. Mathies, J. Lugtenburg, in The Primary Photore-
action of Rhodopsin, Handbook of Biological Physics,
edited by D. G. Stavenga, W. J. de Grip, and E. N. Pugh
Jr., (Elsevier Science B.V., 2000) Vol. 3, Chap. 2.
[66] T. Vreven, F. Bernardi, M. Garavelli, M. Olivucci, M. A.
Robb, and H. B. Schlegel, J. Am. Chem. Soc. 119, 12687
(1997).

[67] S. L. Logunov, L. Song, and M. A. El-Sayed, J. Phys.

Chem. 100, 18586 (1996).

[68] A. Dreuw, J. L. Weisman, and M. Head-Gordon, J.

Chem. Phys. 119, 2943 (2003).

[43] P. K¨urpick, W.-D. Sepp, and B. Fricke, Phys. Rev. A 51

[63] R. Mathies, T. B. Freedman, and L. Stryer, J. Mol. Biol.

[69] Y. Tawada, T. Tsuneda, and S. Yanagisawa, J. Chem.

[71] T. Yanai, D. P. Tew, and N. C. Handy, Chem. Phys. Lett.

Phys. 120, 8425 (2004).

393, 51 (2004).

[70] O. Gritsenko and E.J. Baerends, J. Chem. Phys. 121,

656 (2004).

10

