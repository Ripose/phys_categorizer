3
0
0
2
 
t
c
O
 
1
2
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
1
0
1
0
1
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The incomplete beta function law for parallel tempering sampling of classical
canonical systems

Cristian Predescu
Department of Chemistry, Brown University, Providence, Rhode Island 02912

Mihaela Predescu
Department of Mathematics, Bentley College, Waltham, Massachusetts 02452

Cristian V. Ciobanu
Division of Engineering, Brown University, Providence, Rhode Island 02912
(Dated: February 15, 2014)

We show that the acceptance probability for swaps in the parallel tempering Monte Carlo method
for classical canonical systems is given by a universal function depending on the average statistical
ﬂuctuations of the potential and on the ratio of the temperatures. The law, called the incomplete
beta function law, is valid in the limit that the two temperatures involved in swaps are close one
to each other. An empirical version of the law, which involves the heat capacity of the system,
is developed and tested on a Lennard-Jones cluster. We argue that the best initial guess for the
distribution of intermediate temperatures for parallel tempering is a geometric progression and
we also propose a technique for the computation of optimal temperature schedules. Finally, we
demonstrate that the swap eﬃciency of the parallel tempering method for condensed-phase systems
decreases naturally to zero at least as fast as the inverse square root of the dimensionality of the
physical system.

PACS numbers: 05.10.Ln, 02.70.Tt
Keywords: Monte Carlo, parallel tempering, replica exchange, acceptance probability

I.

INTRODUCTION

tasks,

though indispensable

Ergodic Monte Carlo simulations of

large dimen-
sional
systems having complicated topologies with
many disconnected local minima are diﬃcult com-
for many
putational
physical applications.1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18
Among the various methods dealing with such problems,
the parallel tempering method19,20 is one of the most
successful, especially given the simplicity of the idea and
the ease of implementation. For sure, the idea of coupling
two Markov chains characterized by diﬀerent parameters
in order to ensure transfer of information from one to
the other is as old as the theory of probability itself. In
physical sciences, mixing strategies have been employed
for the development of specialized sampling techniques
such as replica Monte Carlo sampling of spin glasses,1
jump-walking,21,22 and simulated tempering,23,24 to give
a few examples. How this mixing must be performed
in the simplest, most general, and most eﬃcient way is,
however, a quite diﬃcult problem.

The parallel tempering method, as we utilize it in this
article, addresses the question of coupling Monte Carlo
chains that sample classical Boltzmann distributions for
diﬀerent temperatures and which are usually generated
by the Metropolis et al algorithm.25,26 The method has
been formalized seemingly independently by Geyer and
Thompson19 as well as by Hukushima and Nemoto.20 Of
course, it is not necessary that the distributions involved
in swaps diﬀer through their temperature. For instance,
the controlling parameter may be the chemical poten-

tial, as in the hyperparallel tempering method,6 or suit-
able modiﬁcations of the potential, as in the Hamiltonian
replica exchange method.10,18

In parallel tempering, swaps involving two tempera-
tures β and β′ are attempted from time to time in a
cyclic or random fashion and accepted with the condi-
tional probability

,

o

min

1, e(β

′

−β)[V (x′

)−V (x)]

(1)

n

where V (x) is the potential of the physical system un-
der consideration. This acceptance rule ensures that the
detailed balance condition26 is satisﬁed and that the equi-
librium distributions are the Boltzmann distributions.
As Eq. (1) suggests, the eﬃciency of the temperature
swaps depends on the diﬀerence between the inverse tem-
peratures β and β′. In order to maintain high acceptance
ratios, only swaps between neighboring temperatures in
a given schedule βmin = β1 < β2 <
< βN = βmax are
attempted. An optimal schedule of temperatures has the
property that the acceptance ratios between neighboring
temperatures are equal to some predetermined value p,
value that is usually greater or equal to 0.5. The deter-
mination of the optimal schedule is complicated by the
fact that the distributions of the coordinates x and x′
are also temperature dependent (they are, of course, the
Boltzmann distributions at the temperatures β and β′,
respectively).

· · ·

In this article, we attempt to answer the following im-
portant question: What are the main properties of the
physical system that control the acceptance ratio in the
limit that the diﬀerence β′
β is small? The answer

−

to this question allows for a better understanding of the
applicability as well as the limitations of the parallel tem-
pering method. In addition, it allows for the development
of optimal temperature schedules in a way that seems
more direct and easier to implement than other adaptive
strategies.20

β

−

In Section II, we demonstrate in a rigorous mathemat-
ical fashion that the acceptance probabilities for parallel
3)
β′
tempering swaps are controlled, within an O(
|
|
error, by the ratio of the two temperatures involved in
swaps and by the average potential ﬂuctuations of the
system, at the inverse temperature ¯β = (β + β′)/2. The
acceptance probabilities are well approximated by the so-
called incomplete beta function law, which has the addi-
tional property that it is exact for harmonic oscillators.
Under the assumption that the relation between the av-
erage ﬂuctuations and the average square ﬂuctuations of
the potential is roughly the one for harmonic oscillators,
we develop an empirical version of the incomplete beta
function law, version that connects the acceptance proba-
bilities for parallel tempering swaps with the temperature
ratios and the heat capacity of the system.

In Section III.B, we show how the incomplete beta
function laws can be employed for the determination of
optimal temperature schedules. We also explain the em-
pirical observation that a geometric progression is the
best schedule for systems and ranges of temperatures
for which the heat capacity is almost constant.10 In Sec-
tion III.C, we demonstrate rigorously that the eﬃciency
of the parallel tempering method for harmonic oscilla-
tors decreases naturally to zero at least as fast as the
inverse square root of the dimensionality of the physical
system. We then argue that the loss in eﬃciency is even
greater for condensed-phase systems (both solids and liq-
uids). This result seems to be in contradiction with the
ﬁndings of Kofke,27 who suggested that such a curse of
dimension does not appear for parallel tempering. How-
ever, the result is in agreement with the explanation of
Fukunishi, Watanabe, and Takada.18 It is for this reason
that we insist that our ﬁndings be proven in a mathe-
matically rigorous way.

The rigorous form of the incomplete beta function law
involves the average potential ﬂuctuations at certain tem-
peratures. An evaluation of this property by Monte Carlo
simulations would require the computation of a double
integral over the conﬁguration space. For this reason,
current Monte Carlo codes would have to be modiﬁed
extensively in order to take advantage of the incomplete
beta function law for the design of optimal temperature
schedules. To circumvent this undesirable situation, we
propose an empirical version of the incomplete beta func-
tion law, version that is derived under the assumption
that the relation between the average ﬂuctuations and
the average square ﬂuctuations of the potential is roughly
the one for harmonic oscillators. In Section IV, we illus-
trate the good applicability of the empirical law by per-
forming a Monte Carlo simulation for a cluster made up
of 13 atoms of neon that interact through Lennard-Jones

2

potentials.

II. THE INCOMPLETE BETA FUNCTION LAW

Consider a d-dimensional physical system described by
the potential V (x), which is assumed to be bounded from
below. By adding or subtracting a constant, we may
also assume that the global minimum of the potential is
0. In the parallel tempering algorithm, swaps involving
two temperatures β and β′ occur with the conditional
probability

min

1, e(β

′

−β)[V (x′

)−V (x)]

n

.

o

The joint probability distribution density of the points x
and x′ in an equilibrated system is given by the formula

where

1
Q(β)Q(β′)

e−βV (x)e−β

′

V (x′

),

Q(β) =

e−βV (x)dx

Rd

Z

is the conﬁguration integral. It follows that the accep-
tance probability Ac(β, β′) for swaps between neighbor-
ing temperatures is given by the average

Ac(β, β′) =

1
Q(β)Q(β′)

dx

dx′e−βV (x)e−β

′

V (x′

)

Rd

Z
min

Rd

Z
1, e(β

×

′

−β)[V (x′

)−V (x)]

.

(2)

n
By construction, Ac(β, β′) is symmetrical under ex-
change of variables. Without loss of generality, we may
assume β′

β. Then,

o

≥
1, e(β

′

min

n

−β)[V (x′

)−V (x)]

′

−β) min{0,V (x′

)−V (x)}

= e(β

(β

′−β)
2

[V (x′

o
)−V (x)]e− (β

′−β)
2

= e

|V (x′

)−V (x)|.

(3)

Replacing Eq. (3) in Eq. (2), we obtain

Ac(β, β′) =

1
Q(β)Q(β′)

dx

Rd
Z
1
R
−
R + 1

¯β

Rd

Z

−

(cid:20)

exp

×

dx′e− ¯βV (x)e− ¯βV (x′

)

V (x′)
|

V (x)
|

−

.

(4)

(cid:21)

In Eq. (4), the variables R and ¯β are deﬁned by the equa-
tions

R =

and

¯β =

β′
β

β + β′
2

,

(5)

respectively. Due to the nature of the results we prove,
it is more convenient to express the various formulas in
terms of the new variables R and ¯β. Because β′
β, we
need only consider the case R

1.

≥

≥

3

As announced in the introduction, we are interested in
1 for
establishing asymptotic laws in the limit that R
β′
or, alternatively,
which the error is of order O
−
|
O
. At this point, let us see that the acceptance
(cid:0)
probability given by Eq. (4) is alternatively given by the
(cid:0)
formula

R
|

3
|

3
|

→

−

β

1

(cid:1)

(cid:1)

Ac(β, β′) =

Q( ¯β)2
Q(β)Q(β′)

where, in general,
erage

h

f (U, U ′)

exp

(cid:28)

−

(cid:20)

R
1
−
R + 1

¯β

U ′
|

U

−

,

|
(cid:21)(cid:29) ¯β

(6)
iβ denotes the statistical av-

Proposition 1, while a powerful asymptotic result, has
the disadvantage that it may produce negative num-
bers for the acceptance probability in actual simulations.
However, we can repair this in very straightforward fash-
ion. Notice that the fact that Ω(U ) does not depend upon
the temperature is not crucial for the proof of Proposi-
tion 1. Thus, given any other well-behaved density of
states Ω′[U, d(β)] depending perhaps on the inverse tem-
perature through an adjustable parameter d(β) and such
that

¯β

U

h|

U ′

′
¯β = M ¯β,
|i

−

(12)

1
Q(β)2

∞

∞

0 Z
0
Z

e−βU e−βU

Ω(U )Ω(U ′)f (U, U ′)dU dU ′.

′

we still have

In Eq. (7), Ω(U ) denotes the density of states.

In these conditions, the following proposition holds

(7)

Ac′(β, β′) = 1

1
R
−
R + 1

−

M

¯β

+ O

(cid:0)

(cid:1)

.

(13)

1

3
|

−

R
|
(cid:0)

(cid:1)

In Eqs. (12) and (13), the prime sign denotes the respec-
tive averages or quantities obtained from their deﬁnition
if Ω(U ) is replaced by Ω′[U, d(β)]. From Eqs. (8) and
(13), we deduce

true.

where

Proposition 1 We have

Ac(β, β′) = 1

R
1
−
R + 1

−

M

¯β

+ O

R
|

−

1

3
|

,

(cid:0)

(cid:1)

(cid:0)

(cid:1)

M ( ¯β) = ¯β

U ′

U

¯β .

|i

−

h|

Proof. A Taylor expansion of the exponential function
¯β = 0 imply
i

to the third order and the identity

U ′
h

−

U

Q(β)Q(β′)
Q( ¯β)2

= 1 +

=

exp

(cid:28)
R
1
−
R + 1

1
2

(cid:18)

2

(cid:20)
¯β2

Therefore,

R
1
−
R + 1

−

¯β(U ′

U )

−

(cid:21)(cid:29) ¯β

U ′
|

U

2
|

−

R
¯β + O(
|
(cid:11)

1

3).
|

−

(cid:19)

(cid:10)

(8)

(9)

Q( ¯β)2
Q(β)Q(β′)

= 1

1
2

−

2

¯β2

R
1
−
R + 1

(cid:18)

(cid:19)

−

U ′
|
(cid:10)
R
+O(
|

U

−

2
|

1

¯β

(cid:11)
3).
|

(10)

and

On the other hand,

R
1
−
R + 1

¯β

U ′
|

−

U

−

= 1

R
1
−
R + 1

−

M ( ¯β)

exp

(cid:28)

(cid:20)
1
2

2

R
1
−
R + 1

+

U ′
|
(cid:10)
Eq. (10) and (11) imply

(cid:18)

(cid:19)

¯β2

|
(cid:21)(cid:29) ¯β

U

2
|

−

R
¯β + O(
|
(cid:11)

1

3). (11)
|

−

Q( ¯β)2
Q(β)Q(β′)

exp

(cid:28)

−

(cid:20)

R
1
−
R + 1

= 1

−

R
1
−
R + 1

¯β

U ′

|

U

−

M ( ¯β) + O(
R
|

|
(cid:21)(cid:29) ¯β
3)
1
|

−

Ac′(β, β′) = Ac(β, β′) + O

(14)

1

3
|

−

R
|
(cid:0)

(cid:1)

for all Ω′[U, d(β)] that satisfy Eq. (12). This sim-
ple observation allows us to construct approximations
Ac′(β, β′) of order O
3
for the acceptance prob-
1
|
ability Ac(β, β′) by considering a special functional de-
pendence for the density of states Ω′[U, d(β)], such that
the resulting approximation is exact for a certain class of
physical systems.

R
|
(cid:0)

−

(cid:1)

We take this class to be the harmonic oscillators, for
which Ω′(U, d) = (2π)d/2Γ(d/2)−1U d/2−1. We prove in
Appendix I that for any d-dimensional harmonic oscilla-
tor,

AcH (β, β′) =

2
B(d/2, d/2)

1
1+R

0
Z

θd/2−1(1

θ)d/2−1dθ

−

MH( ¯β) = 22−dB(d/2, d/2)−1.

Here, B(d/2, d/2) denotes the respective Euler’s beta
function.

For an harmonic oscillator, d is the dimension. For
general systems, d = d(β) is just a ﬁtting parameter cho-
sen such that Eq. (12) is satisﬁed. In fact, Eq. (12), which
in our case reads

22−dB(d/2, d/2)−1 = M ( ¯β),

has always a unique solution because 22−dB(d/2, d/2)−1
increases strictly from 0 to +
, as d also increases from
. The following theorem is an immediate conse-
0 to +
quence of Eq. (14) and of the discussion above.

∞

∞

(15)

(16)

and the proof is concluded.

(cid:3)

Theorem 1 (Incomplete beta function law)
Consider an arbitrary thermodynamic system for which

M (β) is given as a function of temperature. Let d( ¯β) be
the unique solution of the equation

22−dB(d/2, d/2)−1 = M ( ¯β).

(17)

Then,

Ac(β, β′) =

2
d( ¯β)/2, d( ¯β)/2

B

1/(1+R)

θd( ¯β)/2−1

0
Z

(1
(cid:2)
×

−

θ)d( ¯β)/2−1dθ + O

(cid:3)

,

(18)

1

3
|

−

R
|
(cid:0)

with the error term canceling for harmonic oscillators.

(cid:1)

Then, the identity

4

The last term in the equation above is twice the poten-
tial contribution CV ( ¯β) to the total heat capacity of the
system. (In this article, the heat capacity is always ex-
pressed in units of the Boltzmann constant kB.) The
total heat capacity sums both the potential and the ki-
netic average square ﬂuctuations and is given by the well-
known formula

C( ¯β) = CV ( ¯β) + d/2.

(19)

¯β2

U ′
|
D

U

2
|

−

¯β

E

= 2CV ( ¯β)

implies the inequality

M ( ¯β)2

2CV ( ¯β).

≤

(20)

Eq. (20) suggests that M ( ¯β)2 is an extensive property
of the physical system, property that may be very large
for systems for which the heat capacity is also large. In
fact, Sterling’s formula shows that

MH( ¯β)2 =

22−dB(d/2, d/2)−1

2d
π

≈

2

(cid:3)

(cid:2)

for large dimensional harmonic oscillators. The relation
has a linear scaling with the dimensionality of the sys-
tem (that is, with the number of particles). This scaling
appears also for the heat capacity of harmonic oscillators

CH,V ( ¯β) = d/2.

For systems in condensed phase, for which an har-
monic superposition is roughly a good approximation of
the Boltzmann distribution, one may safely assume that
the functional relationship between M ( ¯β)2 and CV ( ¯β) is
not very far from the one for the harmonic oscillator. Of
course, this is always true in the low temperature limit.
In this conditions, the solution d( ¯β) of the equation

22−dB(d/2, d/2)−1 = M ( ¯β).

is approximately d( ¯β) = 2CV ( ¯β). Replacing the last re-
sult in Eq. (18), we obtain the following empirical incom-
plete beta function law :

Ac(β, β′)

2
CV ( ¯β), CV ( ¯β)

≈

B

1/(1+R)

θCV ( ¯β)−1

(cid:0)

θ)CV ( ¯β)−1dθ.

(21)

0
Z
(1
(cid:1)
×

−

The good applicability of Eq. (21) for realistic physical
systems will be illustrated in Section IV for the case of
a Lennard-Jones cluster. Eq. (21) can be expressed in
terms of the full heat capacity of the system with the
help of Eq. (19). The empirical incomplete beta function
law is still exact for harmonic oscillators.

III. CONSEQUENCES OF THE INCOMPLETE
BETA FUNCTION LAW

There are several important consequences of Theo-
rem 1. The ﬁrst one concerns the development of an em-
pirical law connecting the acceptance probabilities with
the heat capacity and the ratio of the temperatures in-
volved in the parallel tempering swap. The second one
regards the optimal distribution of temperatures in par-
allel tempering Monte Carlo simulations. Yet a third one
is the statement that the eﬃciency of the swaps between
neighboring temperatures decreases naturally as the in-
verse square root of the dimensionality of the system. We
analyze these consequences in some detail in the remain-
der of the section.

A. The empirical incomplete beta function law

The property M ( ¯β) is not usually determined in simu-
lations, nor is it measured in experiments. It is therefore
necessary to relate it to other thermodynamic properties,
more precisely to the heat capacity. In addition, it is de-
sirable to develop a version of the incomplete beta func-
tion law involving the heat capacity rather then M ( ¯β),
even if the law has an empirical validity only.

The quantity

M ( ¯β) = ¯β

U ′

U

¯β

h|
measures the statistical ﬂuctuations of the potential V (x)
and is connected to the heat capacity of the system. More
precisely, the Cauchy-Schwartz inequality says that

−

|i

¯β2

U ′

h|

U

2
¯β ≤

|i

−

¯β2

U ′
|

−

U

2
|

.

¯β

D

E

However,

¯β2

U ′
|

−

U

2
|

¯β

= ¯β2

1
Q(β)2

D

E
Ω(U )Ω(U ′)(U ′

0 Z
0
Z
U )2dU dU ′ = 2 ¯β2

−

∞

∞

e−βU e−βU

′

Ω(U )U 2dU

×

1
Q(β)2

−

∞

0
(cid:20)Z

e−βU Ω(U )U dU

1
Q(β)

(

∞

e−βU

0
Z

2

.

)

(cid:21)

B. On the optimal schedule of temperatures for
the parallel tempering simulation

It is an empirical observation10 that if for a range of
temperatures [βmin, βmax] the heat capacity is roughly
constant, then the optimal temperature schedule (the
schedule for which all acceptance probabilities for swaps
between neighboring temperatures are equal) is a geo-
metric progression. The incomplete beta function law
gives a direct explanation of this phenomenon. As dis-
cussed in the previous section, the quantities M ( ¯β) and
CV ( ¯β) measure essentially the same information: aver-
age potential ﬂuctuations and average potential square
ﬂuctuations, respectively. Thus, we expect that M ( ¯β)
is also constant in regions where CV ( ¯β) is. As shown by
Eq. (18), in these conditions, the acceptance probabilities
are a function of the ratio of the temperatures involved
in swaps only. Therefore, if the predetermined number
of replicas is N (with N large enough so that Theorem 1
applies), then the optimal schedule is

where

βi = Ri−1βmin,

1

i

N,

≤

≤

R = (βmax/βmin)1/(N −1).

(22)

(23)

If one trusts it, the empirical incomplete beta func-
tion law can be used to evaluate the optimal schedule
for arbitrary systems in the following way. First, one
computes a set of values for the potential part CV (β) of
the heat capacity over the interval [βmin, βmax] using a
geometric progression law. The results are then interpo-
lated by cubic spline, for example. Only a rough estimate
is necessary. Given a prescribed value p for the accep-
tance probability and given the inverse temperature βi,
one computes βi+1 by solving the equation

2
CV ( ¯β), CV ( ¯β)

B

(1+βi+1/βi)

θCV ( ¯β)−1

0
Z
(1

(cid:1)
×

(cid:0)

θ)CV ( ¯β)−1dθ = p,

(24)

−
where ¯β = (βi + βi+1)/2. One starts with β1 = βmin and
continues the procedure until the current inverse tem-
perature becomes greater or equal to βmax. This way,
one determines both the optimal distribution of temper-
atures and the minimal number of temperatures com-
patible with the prescribed acceptance probability p. To
ensure the validity of the approximation furnished by
Theorem 1, the value of p should be large enough.
In
fact, values larger or equal to 0.5 are necessary anyway
in order to have good mixing between the Monte Carlo
walkers running at neighboring temperatures.

Sure enough, one may use the full incomplete beta
function law to ﬁnd the optimal schedule. However, the
computation of M ( ¯β) requires extensive changes to the
existing codes. In addition, as illustrated by the example
described in Section IV, the empirical version of the in-
complete beta function law may be suﬃciently accurate

5

for most systems of practical interest. The applicabil-
ity of the law can also be tested during the computation
of the heat capacity CV (β), by comparing the observed
values for the acceptance probabilities with the ones pre-
dicted by the empirical incomplete beta function law.

C. Loss of eﬃciency with increasing dimension for
the parallel tempering method

In this subsection, we show that the minimum num-
ber of intermediate temperatures N (d, p) that ensures
an acceptance probability greater or equal to some pre-
set value p
(0, 1) for a d-dimensional system increases
naturally at least as the square root of the dimensionality
for condensed-phase systems (both solids and liquids).

∈

We begin with a rigorous mathematical analysis for
harmonic oscillators. For them, the optimal schedule is
a geometric progression [because M ( ¯β) is independent of
temperature] and the minimum value of N (d, p) is given
by

NH (d, p) =

+ 2,

(25)

ln(βmax/βmin)
ln[R(d, p)]

(cid:21)

(cid:20)

where [x] is the integer part of x and R(d, p) is the solu-
tion of the equation

2
B(d/2, d/2)

1
1+R

0
Z

θd/2−1(1

θ)d/2−1dθ = p.

−

As shown by Th. 2 of Appendix 2,

1
1+R(d,p)

lim
d→∞

2
B(d/2, d/2)

0
Z

if and only if

θd/2−1(1

θ)d/2−1dθ = p

−

√d

lim
d→∞

(cid:20)

1
2 −

1
1 + R(d, p)

=

1
√2

erf−1(1

p),

−

(cid:21)

where erf−1 is the inverse of the error function. Straight-
forward manipulations show that the last relation is
equivalent to

R(d, p) = 1 +

erf−1(1

p) + o

d−1/2

,

(cid:16)

(cid:17)

or to

2√2
√d

2√2
√d

−

−

ln[R(d, p)] =

erf−1(1

p) + o

d−1/2

.

(26)

We remind the reader that, in general, the notation xd =
x + o(dα) means

(cid:16)

(cid:17)

lim
d→∞

(xd −

x)/dα = 0.

From Eqs. (25) and (26), we learn that
NH (d, p) = d1/2 √2 ln(βmax/βmin)

4erf−1(1

p)

−

+ o

d1/2

,

(27)

(cid:16)

(cid:17)

relation that is similar to Eq. (9) of Ref. 18.

For condensed-phase systems, the heat capacity is usu-
ally larger than what an harmonic approximation pre-
dicts and, therefore, so is M ( ¯β). Consequently, for such
systems, the acceptance ratio for harmonic oscillators
AcH (β, β′) is usually not attained.
In this conditions,
all we can say is that N (d, p) must satisfy the relation

N (d, p)

d1/2 √2 ln(βmax/βmin)
4erf−1(1

p)

,

≥

−

(28)

inequality which demonstrates our claim that there is a
curse of dimension for the parallel tempering method.
In this respect, notice that running N (d, p) independent
replica requires N (d, p) times more computational power.
However, given the improvement in the quality of the
sampling brought in by parallel tempering, this loss of
eﬃciency is an acceptable price to pay.

IV. A NUMERICAL EXAMPLE

In this section, we verify the validity of the empiri-
cal incomplete beta function law for the neon realiza-
tion of the LJ13 cluster. This example is representative
of the type of applications one is likely to encounter in
practice. We shall also illustrate the use of the incom-
plete beta function law for the design of optimal sched-
ules for parallel tempering. With the help of the iden-
tity C(β) = CV (β) + d/2, the empirical incomplete beta
function law is expressed as a functional of the full heat
capacity as

Ac(β, β′)

2 B

C( ¯β)

d/2, C( ¯β)

≈
1/(1+R)

−

−1

d/2

−
θ)C( ¯β)−d/2−1dθ,

(cid:1)

(cid:0)

θC( ¯β)−d/2−1(1

−

×

0
Z

(29)

where d = 3

13 = 39 is the dimensionality of the cluster.
The total potential energy of the Ne13 cluster is given

·

by

Vtot =

VLJ (rij ) +

Vc(ri),

(30)

Np

i<j
X

Np

i=1
X

where VLJ (rij ) is the pair interaction of Lennard-Jones
potential

VLJ (rij ) = 4ǫLJ

12

σLJ
rij (cid:19)

"(cid:18)

6

σLJ
rij (cid:19)

#

−

(cid:18)

and Vc(ri) is the conﬁning potential

Vc(ri) = ǫLJ

Rcm

ri
|

−
Rc

20

.

|

(cid:19)

(cid:18)

(31)

(32)

Np = 13 is, of course, the number of particles in the
system. The values of the Lennard-Jones parameters σLJ

6

Liquid

Gas

150

Solid

200

y
t
i
c
a
p
a
c
 
t
a
e
H

100

50

0

0

10

20

(

)

30

FIG. 1: Heat capacities (in units of kB) as a function of the
temperature T (in Kelvin). The data for the plot have been
computed with the help of the optimal schedule determined
in Section IV. The error bars (twice the standard deviation)
are smaller than the plotting symbols.

and ǫLJ used are 2.749 ˚A and 35.6 K, respectively. The
mass of the Ne atom was set to m0 = 20, the rounded
atomic mass of the most abundant isotope. Rcm is the
coordinate of the center of mass of the cluster and is given
by

Rcm =

ri.

(33)

1
Np

Np

i=1
X

Finally, Rc = 4σLJ is the conﬁning radius. The role of
the conﬁning potential Vc(ri) is to prevent atoms from
permanently leaving the cluster since the cluster in vac-
uum at any ﬁnite temperature is metastable with respect
to evaporation.

The range of temperatures employed was 3 K to 30 K.
In this range of temperatures, the system undergoes two
phase transitions: a solid-liquid transition at about 10 K
and a liquid-gas transition at about 18 K, respectively.
Surely, the terminology we employ is more or less abuse of
language, because true ﬁrst-order phase transitions hap-
pen only in the limit of an inﬁnite number of particles.
However, Fig. 1 clearly shows two pronounced maxima
in the heat capacity of the system, maxima that separate
the three phases. In the limit of inﬁnite number of parti-
cles, these maxima sharpen to a delta function and their
temperature value is usually lowered to the correspond-
ing bulk values.

The parallel tempering Monte Carlo simulations are
carried out using a total of 32 parallel streams, each

running a replica of the system at a diﬀerent temper-
ature. The temperatures range from 3 K to 30 K and are
distributed in geometric progression. For each stream,
the coordinate sampling is performed with the help of
the Metropolis algorithm.26 The basic Monte Carlo steps
consist in attempted moves of the physical coordinates
associated with a given particle. Each attempted move
is then accepted or rejected according to the Metropolis
logic. By attempting to move the particles one at a time,
we can increase the maximum displacements and ensure
better quality of sampling. The maximum displacements
are adjusted in the equilibration phase of the computa-
tion, so that each of the acceptance ratios eventually lies
between 40% and 60%. The 32 (statistically) indepen-
dent streams of random numbers necessary for the simu-
lation are obtained with the help of the Dynamic Creator
package.28,29

As a counting device, we deﬁne a pass as the mini-
mal set of Monte Carlo attempts over all particles in the
system. Because we update the neon atoms in successive
fashion, a pass consists of 13 basic steps. One also deﬁnes
a block as a computational unit made up of 100 thousand
passes. The size of the block is suﬃciently large that the
block averages of the various quantities computed are in-
dependent for all practical purposes. The accumulation
phase of the simulation has consisted of 100 blocks for a
total of 10 million passes per temperature. The accumu-
lation phase has been preceded by an equilibration phase
of 20 blocks.

Parallel tempering swaps between neighboring temper-
atures are attempted every 100 passes in an alternat-
ing fashion (ﬁrst, with the closest lower temperature and
then, with the closest higher temperature). The only
exceptions are the two end temperatures, which are in-
volved in swaps every 200 passes, only. The acceptance
probability of swaps aci at a given temperature βi is com-
puted as the fraction of accepted swaps involving that
temperature. Thus, except for the end temperatures, the
computed values are equal to

aci =

[Ac(βi−1, βi) + Ac(βi, βi+1)] .

1
2

Because the intermediate temperatures are distributed
in geometric progression, R = (30/3)1/31 is a constant.
In this case, the empirical incomplete beta function law
given by Eq. (29) says that the dependence of the accep-
tance probabilities with the temperature is a functional
of the heat capacity only. This observation is well sup-
ported by the observed acceptance probabilities, which
are plotted in Fig. 2.

During the Monte Carlo simulation, besides acceptance
ratios, we have also evaluated the heat capacities at dif-
ferent temperatures. Then, the heat capacities have been
interpolated using a cubic spline and acceptance ratios
ac′
i have been computed with the help of the empirical
incomplete beta function law. More precisely, we have

7

1.00

0.90

0.80

0.70

0.60

o
i
t
a
r
 
e
c
n
a
t
p
e
c
c
A

0.50

0

10

20

(

)

30

FIG. 2: Observed acceptance ratios as a function of the tem-
perature T (in Kelvin). A geometric progression schedule has
been utilized. The plot is in direct relationship with the heat
capacity curve (see Fig. 1), as predicted by the incomplete
beta function law. The error bars are about the size of the
plotting symbols.

computed

ac′

i =

[Ac′(βi−1, βi) + Ac′(βi, βi+1)] ,

1
2

where Ac′(β, β′) is given by the right-hand side of
Eq. (29). In Fig. 3, we plot the absolute values of the
diﬀerences between the observed and computed accep-
tance probabilities. These values are smaller than the
estimated error bars for the same diﬀerences.
In fact,
the maximum diﬀerence between the two curves is less
than 0.008 and therefore, for all practical purposes, the
empirical version of the incomplete beta function law is
correct.

As discussed in Section III.C, the heat capacity for
solids is usually larger than what the harmonic ap-
proximation predicts, except for the low temperature
limit. The liquid phase has an even larger heat capacity,
whereas the gas phase has a smaller one. In the high-
temperature limit, the CV (β) component of the heat ca-
pacity decreases to zero. As a consequence, the accep-
tance probabilities increase to 1. At the critical points,
the acceptance probabilities for parallel tempering swaps
decrease very much, as the heat capacities increase sud-
denly. This analysis is consistent with the results shown
in Fig. 2. Therefore, the loss of eﬃciency for solids and
liquids is even more pronounced than the d−1/2 decay
computed for d-dimensional harmonic oscillators.

Using the strategy described in Section III.B, we have
determined the optimal schedule of temperatures nec-

0.01

-

/|
|
error bars

8

0.77

0.76

0.75

0.74

o
i
t
a
r
 
e
c
n
a
t
p
e
c
c
A

0.00

0

10

20

(

)

30

FIG. 3: The dot line shows the absolute value of the diﬀer-
ences between the observed values for the acceptance prob-
ability of swaps and the ones predicted by the empirical in-
complete beta function law. Also plotted (dash line) are the
estimated error bars for the diﬀerences |aci − ac′
i|.

essary to achieve a constant acceptance probability of
p = 0.75 for all swaps between neighboring temperatures.
The minimal number of temperatures needed has been
found to be 34 (only the temperatures located in the in-
terval [3 K, 30 K] are counted). Then, we have performed
a second Monte Carlo simulation to verify the validity of
the schedule. The plot in Fig. 4 demonstrates that the
computed schedule works very well. This explicit appli-
cation illustrates the utility of the empirical incomplete
beta function law for the determination of optimal tem-
perature schedules in parallel tempering simulations.

V. SUMMARY AND CONCLUSIONS

We have successfully and rigorously related the ac-
ceptance probabilities for parallel tempering swaps to
the ratio between the temperatures involved in the swap
and the average statistical ﬂuctuations of the potential
at some intermediate temperature. The respective law,
is exact for
called the incomplete beta function law,
3) for arbi-
β′
harmonic oscillators and of order O(
β
|
|
trary systems. We have also demonstrated that there is
a loss of eﬃciency in parallel tempering simulations of
condensed-phase systems with the increase of dimension-
ality. The loss of eﬃciency is at least d−1/2, the value
computed for harmonic oscillators.

−

Motivated by the fact that the existent Monte Carlo

0.73

0

10

20

(

)

30

FIG. 4: Observed acceptance ratios for the optimal schedule
of temperatures determined with the help of the empirical
incomplete beta function law. The deviations from the ideal
result of p = 0.75 are comparable to the statistical noise.

codes do not allow for the computation of the average
potential ﬂuctuations without extensive reprogramming,
we have developed and tested the empirical incomplete
beta function law. This empirical law connects the accep-
tance probabilities of the parallel tempering swaps with
the heat capacity of the system. The law has been exten-
sively veriﬁed for the LJ13 cluster, on a range of temper-
atures that spanned three thermodynamic phases. The
empirical incomplete beta function law provides a direct
justiﬁcation of the observation that a geometric progres-
sion is the optimal schedule for systems and regions of
temperatures where the heat capacity is almost constant.
Finally, the use of the empirical incomplete beta function
law for the construction of optimal temperature schedules
has been demonstrated.

On a more general level, we hope that a better under-
standing of the laws governing the acceptance probabili-
ties for swaps in parallel tempering methods may lead to
useful research in improving the eﬃciency of the meth-
ods. In the meantime, we recommend that the dimen-
sionality of the systems be maintained as low as possible,
for instance, by adiabatically reducing those degrees of
freedom that do not lead to signiﬁcant degradation of the
quality of the ﬁnal results.

Acknowledgments

The ﬁrst author acknowledges support from the Na-
tional Science Foundation through awards No. CHE-

9

0095053 and CHE-0131114. CVC is supported by the
MRSEC program at Brown University. The authors also
wish to thank Professors J. D. Doll and D. L. Freeman
for useful suggestions and interesting discussions on the
subject.

where

APPENDIX A: EVALUATION OF INTEGRALS

For an arbitrary d-dimensional harmonic oscillator
whose global minimum is zero, the density of states is
given by the formula Ω(U ) = (2π)d/2U d/2−1/Γ(d/2).
In these conditions, it is but a simple exercise to show
that the acceptance probability for the parallel temper-
ing swaps is given by the equation

AcH (β, β′) =

(ββ′)d/2
Γ(d/2)2

∞

∞

e−βU e−β

U d/2−1

′

′

U

U ′d/2−1 min

×

0
0 Z
Z
′
1, e(β

n

−β)(U

−U)

′

dU dU ′.

(A1)

o

We also want to evaluate the quantity MH (β) [see
Eq. (16)], which is given by the formula

where

I(β, β′) =

(ββ′)d/2
Γ(d/2)2

∞

U

dU

dU ′e−βU

0
Z
e−β

′

′

U

0
Z

U d/2−1U ′d/2−1.

(A6)

×
Performing the substitution U ′ = U θ, we obtain

∞

1

dU

dθe−β(1+Rθ)U

I(β, β′) =

βdRd/2
Γ(d/2)2

U d−1θd/2−1 =

×

0
Z

Γ(d)Rd/2
Γ(d/2)2

0
Z

1

0
Z

dθ

θd/2−1
(1 + Rθ)d .

(A7)

Performing the change of variables θ = R−1(t−1
conclude

−

1), we

I(β, β′) =

1
B(d/2, d/2)

1

td/2−1(1

t)d/2−1dt

−

1/(R+1)

Z

1/(R+1)

= 1

1
B(d/2, d/2)

−

0
Z

td/2−1(1

t)d/2−1dt, (A8)

−

MH(β) =

βd+1
Γ(d/2)2

∞

∞

0 Z
0
Z
U ′d/2−1

×

U ′
|

U

dU dU ′.
|

−

(A2)

e−βU e−βU

U d/2−1

′

B(d/2, d/2) =

Γ(d/2)2
Γ(d)

=

1

0
Z

td/2−1(1

t)d/2−1dt

−

While for an harmonic oscillator the parameter d is an
integer, we compute the two integrals above under the
assumption that d is a strictly positive real number. We
prove that the value of AcH (β, β′) is given by the incom-
plete beta function

AcH (β, β′) =

1/(1+R)

2
B(d/2, d/2)

0
Z

θd/2−1(1

θ)d/2−1dθ,

−

(A3)

where B(a, b) is Euler’s beta function

B(a, b) =

θa−1(1

θ)b−1dθ

−

1

0

Z

and

R = max

β′
β

,

β
β′

.

(cid:27)

(cid:26)

In addition, we prove that

is Euler’s beta function. The value of I(β′, β) is ob-
tained by replacing R with 1/R in the ﬁrst expression
of Eq. (A8). We compute

I(β′, β) =

1
B(d/2, d/2)

0
Z

1/(1+R)

td/2−1(1

t)d/2−1dt.

−

Eq. (A3) follows easily from Eqs. (A5), (A8), and (A9),
after easy simpliﬁcations.

If applied to Eq. (A2), the same decomposition and
coordinate transformations used in the proof of Eq. (A3)
lead to the equation

MH(β) = 2

Γ(d + 1)
Γ(d/2)2

1

1/2

Z

(2θ

1)θd/2−1(1

θ)d/2−1dθ

−

−

= 2dB(d/2, d/2)−1

B(d/2, d/2)

,

(A9)

1
2

2I1 −

(cid:20)

(cid:21)

where

I1 =

θd/2(1

θ)d/2−1dθ.

−

1

1/2

Z

Integrating by parts the last integral, we obtain

θd/2−1(1

θ)d/2dθ =

−

2
d2d + I2, (A10)

MH(β) = 22−dB(d/2, d/2)−1.

(A4)

β, so that R = β′/β

Because the function AcH (β, β′) is symmetrical in its
arguments, we may assume without loss of generality that
β′
1. By decomposing the do-
≥
main of the integral against U ′ in Eq. (A1) in two regions
with U ′ < U and U ′
U respectively, it is straightfor-
ward to see that

≥

≥

2
d2d +

1

1/2

Z

I1 =

where

AcH (β, β′) = 1

I(β, β′) + I(β′, β),

(A5)

−

I2 =

1/2

(1

−

0
Z

θ)d/2−1θd/2dθ.

Combining Eq. (A10) with the identity

substitution t = θαd/d1/2 and obtain

I1 + I2 = B(d/2, d/2 + 1) =

B(d/2, d/2),

1
2

we obtain

2I1 =

2
d2d +

1
2

B(d/2, d/2),

which, after replacement in Eq. (A9), produces Eq. (A4).

APPENDIX B: A LIMITING THEOREM

Theorem 2 Let
bers convergent to α > 0. Then,

αd}d≥1 be a sequence of positive num-

{

lim
d→∞

2
B(d/2, d/2)

0
Z

1

2 − αd
d1/2

θd/2−1(1

θ)d/2−1dθ

−

= 1

erf (21/2α),

(B1)

−

The equality

where

is the error function.

Proof. We compute

erf (x) =

x

e−t2

dt

2
√π

0

Z

Id =

2
B(d/2, d/2)

2
B(d/2, d/2)

1

2 − αd
d1/2

0
Z

1/2

1

2 − αd
d1/2

Z

θd/2−1(1

θ)d/2−1dθ

θd/2−1(1

θ)d/2−1dθ

−

−

2
2d−2B(d/2, d/2)

αd
d1/2

0
Z

4t2)d/2−1dt,

(1

−

= 1

= 1

−

−

−

10

Id = 1

4αd
d1/22d−1B(d/2, d/2)

−

1

1
0 (cid:18)
Z

−

4θ2α2
d
d

(cid:19)

d/2−1

dθ

Sterling’s formula implies

lim
d→∞

1
B(d/2, d/2)2d−1d1/2

= lim
d→∞

Γ(d)
Γ(d/2)2

1
2d−1d1/2 =

1
√2π

.

Therefore, remembering that αn →

α, we obtain

lim
d→∞

Id = 1

−

4α
√2π

1

lim
d→∞

1
0 (cid:18)
Z

−

2θ2α2
d
d/2

(cid:19)

d/2−1

dθ

lim
d→∞

1
(cid:18)

−

2θ2α2
d
d/2

d/2−1

= e−2θ2α2

,

(cid:19)
the fact that the above sequences are bounded by 1 for
all θ
[0, 1], and the dominated convergence theorem
imply

∈

1

lim
d→∞

1
0 (cid:18)

Z

−

2θ2α2
d
d/2

(cid:19)

d/2−1

1

0

Z

dθ =

e−2θ2α2

dθ.

Thus,

1

e−2α2θ2

dθ

4α
√2π
−
21/2α

0
Z
e−t2

lim
d→∞

Id = 1

= 1

2
√π

−

0
Z

dt = 1

erf (21/2α)

−

where we have used the transformation of coordinates
t for the last expression. Next, we perform the
θ = 1/2

and the theorem is proven.

(cid:3)

1 R. H. Swendsen and J.-S. Wang, Phys. Rev. Lett. 57, 2607

(2000).

2 M. C. Tesi, E. J. Janse van Rensburg, E. Orlandini, and

S. G. Whittington, J. Stat. Phys. 82, 155 (1996).

3 U. H. E. Hansmann, Chem. Phys. Lett. 281, 140 (1997).
4 M. G. Wu and M. W. Deem, Mol. Phys. 97, 559 (1999).
5 M. Falcioni and M. W. Deem, J. Chem. Phys. 110, 1754

6 Q. Yan and J. J. de Pablo, J. Chem. Phys. 111, 9509

(1986).

(1999).

(1999).

10 Y. Sugita, A. Kitao, and Y. Okamoto, J. Chem. Phys. 113,

6042 (2000).

11 Q. Yan and J. J. de Pablo, J. Chem. Phys. 114, 1727

12 F. Calvo and J. P. K. Doye, Phys. Rev. E 63, 010902

13 D. Bedrov and G. D. Smith, J. Chem. Phys. 115, 1121

14 D. Gront, A. Kolinski, and J. Skolnick, J. Chem. Phys.

(2001).

(2001).

(2001).

7 J. P. Neirotti, F. Calvo, D. L. Freeman, and J. D. Doll, J.

115, 1569 (2001).

Chem. Phys. 112, 10340 (2000).

8 F. Calvo, J. P. Neirotti, D. L. Freeman, and J. D. Doll, J.

Chem. Phys. 112, 10350 (2000).

9 Q. Yan and J. J. de Pablo, J. Chem. Phys. 113, 1276

(2001).

15 Y. Ishikawa, Y. Sugita, T. Nishikawa, and Y. Okamoto,

Chem. Phys. Lett. 333, 199 (2001).

16 A. Bunker and B. Dunweg, Phys. Rev. E 63, 016701

11

17 R. Faller, Q. Yan, and J. J. de Pablo, J. Chem. Phys. 116,

(1992).

18 H. Fukunishi, O. Watanabe, and S. Takada, J. Chem. Phys.

19 C. J. Geyer and E. A. Thompson, J. Am. Stat. Assoc. 90,

20 K. Hukushima and K. Nemoto, J. Phys. Soc. Jpn. 65, 1604

5419 (2002).

116, 9058 (2002).

909 (1995).

(1996).

21 D. D. Frantz, D. L. Freeman, and J. D. Doll, J. Chem.

Phys. 93, 2769 (1990).

22 T. W. Whitﬁeld and J. E. Straub, Phys. Rev. E 64, 066115

(2001).

23 A. P. Lyubartsev, A. A. Martsinovski, S. V. Shevkunov,
and P. N. Voronstsov-Velyaminov, J. Chem. Phys. 96, 1776

24 E. Marinari and G. Parisi, Europhys. Lett. 19, 451 (1992).
25 N. Metropolis, A. W. Rosenbluth, M. N. Rosenbluth, A.
M. Teller, and E. Teller, J. Chem. Phys. 21, 1087 (1953).
26 M. Kalos and P. Whitlock, Monte Carlo Methods (Wiley-

Interscience, New York, 1986).

27 D. A. Kofke, J. Chem. Phys. 117, 6911 (2002).
28 M. Matsumoto and T. Nishimura, Dynamic Creation of
Pseudorandom Number Generators, in Monte Carlo and
Quasi-Monte Carlo Methods 1998, (Springer-Verlag, New
York, 2000), pp 56–69.

29 http://www.math.keio.ac.jp/~matumoto/emt.html.

