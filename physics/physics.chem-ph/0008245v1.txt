0
0
0
2

 

g
u
A
1
3

 

 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 

1
v
5
4
2
8
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Approach to Ergodicity in Monte Carlo Simulations

J. P. Neirotti

and

David L. Freeman

Department of Chemistry, University of Rhode Island

51 Lower College Road, Kingston, RI 02881-0809

and

J. D. Doll

Department of Chemistry, Brown University

Providence, RI 02912
(November 24, 2013)

Abstract

The approach to the ergodic limit in Monte Carlo simulations is studied using both analytic
and numerical methods. With the help of a stochastic model, a metric is deﬁned that enables the
examination of a simulation in both the ergodic and non-ergodic regimes. In the non-ergodic regime,
the model implies how the simulation is expected to approach ergodic behavior analytically, and the
analytically inferred decay law of the metric allows the monitoring of the onset of ergodic behavior.
The metric is related to previously deﬁned measures developed for molecular dynamics simulations,
and the metric enables the comparison of the relative eﬃciencies of diﬀerent Monte Carlo schemes.
Applications to Lennard-Jones 13-particle clusters are shown to match the model for Metropolis,
J-walking and parallel tempering based approaches. The relative eﬃciencies of these three Monte
Carlo approaches are compared, and the decay law is shown to be useful in determining needed high
temperature parameters in parallel tempering and J-walking studies of atomic clusters.
PACS numbers: 05.10.Ln, 02.70.Lq

I. INTRODUCTION

A goal of Monte Carlo (MC) simulations in statistical
mechanics [1] is the calculation of ensemble mean values
of thermodynamic quantities. Ensemble mean values are
multidimensional integrals over conﬁguration space

hUi =Z dx P (x) U (x) ,

(1)

where P (x) is the probability of ﬁnding a system in the
state deﬁned by x, and the functional form of P (x) de-
pends on the ensemble investigated. MC simulations usu-
ally generate a sampling of conﬁguration space {xk}K
k=1 by
the use of a stochastic process with stationary probability
P (xk). The quantity U evaluated at xk is the output of
the simulation U (xk) = Uk, and its arithmetic mean value
U , in principle, must approach the ensemble mean value.
[1] In this paper we refer to the set of conﬁgurations gener-
ated in a Monte Carlo simulation as a time sequence, and
we study the behavior of these temporal sequences {Uk}
and their arithmetic mean, to understand better how MC
simulations approach ergodic behavior. It is important to
emphasize that there are two time variables to consider.
The time variable k labels the separate conﬁgurations gen-
erated in a Monte Carlo walk. Variations of properties
with k provide information about the short-time behavior
of a MC simulation. The time variable K labels the total

length of the MC walk, and variations of computed prop-
erties with K provide information about the convergence
of the simulation on a long time scale.

Given an inﬁnite time, the stochastic walker in a MC
simulation visits every allowed point in conﬁguration
space. [2] Ergodic behavior is reached when the length
of the walk is suﬃciently long to sample conﬁguration
space appropriately. [3] In practice, this does not mean
that the space has been densely covered but that every
region with non-negligible probability has been reached.
In such a case we can say that the simulation is eﬀectively
ergodic or that it has reached the ergodic limit.

For a ﬁnite walk, in the event of broken ergodicity [4],
phase space is eﬀectively disconnected. The diﬀerent dis-
connected regions (called components) are separated by
barriers of zero eﬀective probability. If a stochastic walker
starts its walk in one of these regions, it may not cross the
barriers within the time of the simulation. If the simula-
tion length is increased, some barriers may become acces-
sible for the walker and phase space is better sampled. We
can conclude that a time τ exists such that, for simulation
lengths shorter than τ , the walker becomes trapped in one
of the phase space components. For simulation lengths
much larger than τ , phase space is eﬀectively covered by
the walker.

In this study we imagine a system having more than one
time scale τ1 ≪ τ2 ≪ . . . ≪ τΛ. In a Monte Carlo sim-
ulation each scale comes from stochastic processes with

1

PREPRINT

diﬀerent correlation times. [5] A precise deﬁnition of the
correlation times for Monte Carlo processes is given in
Section III, but for the moment we can think of these cor-
relation times as identical to physical time scales of the
system under study. To understand these time scales more
fully, it is useful to focus on an example. Prototypical of
systems having such disparate time scales are atomic and
molecular clusters. Typical cluster potential surfaces have
many local minima separated by signiﬁcant energy barri-
ers. [6–8] The local minima can be grouped into basins
of similar energies, with each basin separated from other
basins again by energy barriers. At short Monte Carlo
times a cluster system executes small amplitude oscilla-
tions about one of its potential minima. We can think of
these vibrational time scales as the shortest time scales
that deﬁne a cluster system. As the simulation time is
extended the system eventually hops between diﬀerent lo-
cal minima within the same basin. The time scale for
the ﬁrst hops between local minima can be considered
the next shortest time scale for the simulation. At still
longer Monte Carlo times, the system hops between dif-
ferent energy basins deﬁning yet another time scale for the
simulation. This grouping of time scales continues until
the longest time scale for a given system is reached. At
Monte Carlo times that are long compared to this longest
time scale, the simulation is ergodic.

Consider a system with several time scales as mentioned
above. If the length of the simulation is smaller than the
smallest correlation time, the walker may become trapped
in an eﬀectively disconnected region and the sampling of
phase space is incomplete. By increasing the time, the
memory of the initial condition in the sampling decreases
as the walker crosses to other previously unreachable re-
gions. These oscillations and hoppings can be modeled by
a superposition of stochastic processes with diﬀerent cor-
relation times. These processes with non-zero correlation
times are known as colored noise processes (as opposed
to zero correlation time white noise processes). [5] From
the study of the autocorrelation functions of a stochas-
tic model deﬁned using these colored noise processes, we
can verify that, at a ﬁxed run length K, there exist two
diﬀerent groups of processes; those that contribute to the
autocorrelation function with terms that decay like 1/k
(called diﬀusive processes), and those that contribute to
the autocorrelation function with terms that decay slower
than 1/k (called non-diﬀusive processes). When the time
of the simulation is increased, some non-diﬀusive processes
at shorter run lengths, start to contribute to the autocor-
relation function like diﬀusive processes. After the walk
length reaches the largest correlation time τΛ, all processes
contribute to the autocorrelation function with terms that
decay like 1/k. At this point, the simulation is at the dif-
fusive regime and eﬀective ergodicity has been reached.
A principal goal of this work is to investigate the way in
which the MC output {Uk} reaches the diﬀusive limit (i.e.
the ergodic limit) by studying the properties of autocorre-
lation functions under changes of scale in time, K → bK
with b > 1. By time scaling it is possible to infer the decay

law of the non-diﬀusive contributions with respect to the
total simulation time K. The functional dependence of
the non-diﬀusive contributions on the parameter b that is
used to scale K is determined empirically. We have found
the decay law so determined to be a particularly valuable
method of concluding when a simulation can be considered
ergodic. Unlike previous studies [3,9–11] that only have
investigated the behavior of certain autocorrelation func-
tions in the ergodic regime, by focusing on the approach
to ergodic behavior we have a more careful monitor of the
onset of ergodicity. Once the non-diﬀusive contributions
have decayed to a point where they are too small to be
distinguished from zero to within the ﬂuctuations of the
calculation, we can say that the ergodic limit has been
reached.

The autocorrelation functions we use to measure the
approach to the ergodic limit are based on one of the
probes of ergodicity developed by Thirumalai and co-
workers [3,9–11], and is often called the energy metric.
The energy metric has been proposed as an alternative to
other techniques [3] (like the study of the Lyapunov expo-
nents [12]) for the study of ergodic properties in molecular
dynamics (MD) simulations. The metric has been used to
study the relative eﬃciency of MC simulation methods
as well. [13] The MC metric as used in the current work
can easily be extended from the energy to other scalar
observables of the system.

We present two key issues in this paper. First, from the
knowledge of the decay law of the non-diﬀusive contribu-
tions to the MC metric, we infer how long a simulation
must be to be considered eﬀectively ergodic. Second, once
the ergodic limit is reached, we can compare the results
from diﬀerent numerical algorithms to measure relative
eﬃciencies. Because the outcomes of MC simulations are
noisy, we have found it useful to separate diﬀusive and
non-diﬀusive terms in the MC metric with a Fourier anal-
ysis so that we can neglect the high frequency compo-
nents of the noise. This technique has given reproducible
results.

To test the match between the stochastic model and ac-
tual Monte Carlo simulations, we examine the approach
to ergodic behavior in simulations of Lennard-Jones clus-
ters. Recently [14,15] we have studied the thermodynamic
properties of Lennard-Jones clusters as a function of tem-
perature using both J-walking [16] and parallel temper-
ing methods. [17–19] Both simulation techniques require
an initial high temperature that must be ergodic when
Metropolis Monte Carlo methods [20] are used.
If the
Metropolis method does not give ergodic results at the
initial high temperature, systematic errors propagate to
the lower temperatures in J-walking and parallel temper-
ing simulations, and the results can be ﬂawed or mean-
ingless.
In most Monte Carlo simulations of clusters at
ﬁnite temperatures, [21,22] the clusters are deﬁned by en-
closing the atoms within a constraining potential about
the center of mass of the system. The constraining po-
tential is necessary because clusters at ﬁnite temperatures
have ﬁnite vapor pressures, and the association of any one

2

The Approach to Ergodicity in Monte Carlo Simulations

atom with the cluster can be ill-deﬁned. From experience
[14,15,23] we have found that if the radius of the con-
straining potential and the initial high temperature are
not both carefully chosen, it can be diﬃcult to attain er-
godicity with Metropolis methods. A key concern then is
the choice of constraining radius and the choice of initial
temperature. We verify the stochastic model by investi-
gating Monte Carlo simulation results as a function of the
temperature and the size of the constraining potential.

The contents of the remainder of this paper are as fol-
lows. In Section II we motivate the studies that follow by
examining numerally the behavior of a set of Monte Carlo
simulations of a 13-particle Lennard-Jones cluster. This
cluster system is used to illustrate the results through-
out this paper. In Section III we introduce the stochastic
model based on a continuous time sequence. In Section
IV we extend the model to discrete time sequences char-
acteristic of actual Monte Carlo simulations. In Section V
we test the discrete stochastic model with applications to
Lennard-Jones clusters and in Section VI we summarize
our conclusions. Many of the key derivations needed for
the developments are found in two appendices.

canonical ensemble at temperature kBT /ε = 0.393(kB is
the Boltzmann constant). This average potential energy
V k is deﬁned by

V k =

1
k

kXk′=1

Vk′

(5)

and is displayed in the upper panel of Fig. 1 as a func-
tion of the walk length k for 20 independent simulations
each initialized from a random conﬁguration. Over the
maximum time scale K of the walks, it apparent that the
potential energy averaged over each independent walk has
not converged to the same result. Such unreproducible
behavior is symptomatic of a simulation not yet at the
ergodic limit.

−18

−20

−22

II. AN EXAMPLE CALCULATION

k|
V

−24

Before discussing the major developments of this work,
it is useful to understand the nature of the problem we
are attempting to solve by examining some numerical re-
sults on a prototypical system. We take the 13-particle
Lennard-Jones cluster deﬁned by the potential function

V (x) = 4ε

i−1Xj=1"(cid:18) σ
rij(cid:19)12

NXi=2

rij(cid:19)6# +
−(cid:18) σ

NXi=1

VC (~xi, Rc)

(2)

where ε and σ are the standard Lennard-Jones energy
and length parameters, N is the number of particles in
the cluster (13 in the present case), rij is the distance
between particles i and j

rij = |~xi − ~xj|,

(3)

and VC is the constraining potential discussed in Sec. I

,

(4)

where ~Xc is the coordinate of the center of mass of the
cluster and Rc is the radius of the constraining sphere.
The 13-particle Lennard-Jones cluster has a complex po-
tential surface with many minima separated by signiﬁcant
energy barriers, [6–8] and ergodicity problems associated
with the simulation of properties of this system are well-
known. [16] We now consider a Metropolis MC simula-
tion of the average potential energy of the system in the

VC (~xi, Rc) =

0

(cid:12)(cid:12)(cid:12)~xi − ~Xc(cid:12)(cid:12)(cid:12) < Rc
∞ Rc <(cid:12)(cid:12)(cid:12)~xi − ~Xc(cid:12)(cid:12)(cid:12)

−26

−28

−30
80

60

k
d

40

20

0

0

1000

2000

k

3000

4000

5000

Fig. 1: The upper panel shows the “time evolution” of V k (in
units of ε) for M = 20 independent experiments. The lower panel
shows dk (in units of ε2) vs. k for the experiments of the upper panel.
Rc has been set to 4σ and kB T /ε = 0.393. At least two basins with
diﬀerent energies are present. Clearly, dk goes to a constant when
k is increased within the total time scale of the simulation.

At the ergodic limit (i.e. for the maximum walk length
K greater than that included in Fig. 1) the averages dis-

J. P. Neirotti, D. L. Freeman. and J. D. Doll

3

played in the upper panel of Fig. 1 must approach the
same value for each walker. Using related ideas developed
elsewhere, [3,9,10] the extent to which the walks approach
the same limit can be measured in terms of a metric dk
deﬁned by

dk =

2

M (M − 1)

MXi=2

i−1Xj=1h V

(i)

k − V

(j)

k i2

,

(6)

In Eq. (6) M represents the number of independent walks,
(i)
and V
k is the average potential energy computed in walk
i at MC time k. The metric measures the energy ﬂuctu-
ations in the walk as a function of the walk length. For
an ergodic simulation, the metric must decay to zero. For
the 20 simulations of the 13-particle Lennard-Jones clus-
ter, the metric as a function of k is plotted in the lower
panel of Fig. 1. Rather than asymptotically approaching
zero, over the short length of the walk displayed here, dk
has decayed to a constant, and as discussed later in this
paper, over the time scale of this simulation, dk can be
qualitatively represented by the function

dk =

AK
k

+ BK

(7)

where AK and BK are coeﬃcients that are dependent on
the total walk length K. As K is increased to a time
where the walk is ergodic, BK must decay to zero. Major
goals of this work are to understand how BK decays and
to use the discovered decay law to determine the onset
of ergodic behavior. Our approach is to introduce ﬁrst a
continuous stochastic model of a simulation followed by a
discrete model more clearly linked to actual MC studies.

III. STOCHASTIC MODEL

We have discussed in the introduction how the output
of MC simulations can be considered to be a combination
of stochastic processes with diﬀerent time scales, and how
the contributions to autocorrelation function from these
processes can vary when the length of the simulation is
enlarged. Here we present a continuous time model for
the stochastic processes that occur in a simulation. Even
though a MC simulation occurs in a discrete time (each
MC point represents a time unit), we ﬁnd that the con-
tinuous model helps to understand better the ideas used
in the modeling of the MC output.

In this section the ensemble mean value is used to ﬁnd
the expression for the autocorrelation functions of the
model. Although in actual numerical calculations the en-
semble mean is replaced by a mean over a ﬁnite number
of independent experiments, the results obtained here give
information about the limit of an inﬁnite sample.

The stationary process used to sample space is a
stochastic process. We assume the output of the MC simu-
lation can be modeled by a linear superposition of stochas-
tic processes with diﬀerent correlation times τℓ ≥ 0,

U (t) = Uc +pΓ0 ξ(t) +

ΛXℓ=1pΓℓ gℓ(t/τℓ) ,

(8)

where Uc is a constant, the random variable ξ(t) represents
white noise processes with zero correlation time (τ0 = 0),
and the {gℓ(t/τℓ)} are stochastic processes with correla-
tion times τℓ > 0. ξ(t) and gℓ(t/τℓ) have units of the
square root of time, and Γ0 and Γℓ are constants with
units of U 2/t. If U is chosen to be the the x-coordinate
of a particle, Γ0 and Γℓ have units of a diﬀusion constant.
Consequently we refer to these constants as generalized
diﬀusion coeﬃcients. The white noise process has the fol-
lowing properties [5]

hξ(t)i = 0

hξ(t) ξ(t′)i = δ(t − t′) ,

(9)
(10)

and the remaining colored noise processes are assumed to
satisfy

hgℓ(t/τℓ)i = 0
1
hgℓ(t/τℓ) gℓ(t′/τℓ)i =
τℓ

fℓ(cid:18)|t − t′|
τℓ (cid:19)

(11)

(12)

so that they represent processes with a memory fℓ. Even
though correlations between processes with diﬀerent cor-
relation times may be non-zero, we assume the processes
to be independent, i.e.

hgℓ(t/τℓ) gℓ′(t′/τℓ′)i = hgℓ(t/τℓ)ihgℓ′(t′/τℓ′)i

= 0 ∀ ℓ 6= ℓ′

hξ(t) gℓ(t′/τℓ)i = hξ(t)ihgℓ(t′/τℓ)i

= 0 ∀ t and t′ .

(13)

(14)

The memory function is assumed to be a continuous func-
tion that depends only on the distance between t and t′
disregarding the time origin (stationary condition). The
memory function represents the correlation between two
times of the process gℓ. In our model we impose the con-
dition

t
τℓ

fℓ(cid:18) t

τℓ(cid:19) <Z t

0

dt′ 1
τℓ

fℓ(cid:18) t′

τℓ(cid:19) < ∞ .

(15)

The scope and implications of the leftmost inequality are
explored in Appendix A. In Appendix A we also examine
the conditions fℓ must satisfy in order to yield contribu-
tions to autocorrelation function that decay more weakly
than 1/t. We now assume that this inequality can be
taken as a bound to possible maxima of fℓ appearing at
t > 0. The rightmost inequality enables us to assume fℓ
is normalized

Z ∞

−∞

dt

1
τℓ

fℓ(cid:18)|t|

τℓ(cid:19) = 1 .

(16)

4

The Approach to Ergodicity in Monte Carlo Simulations

−∞

(17)

We have identiﬁed here the time scale τℓ with the correla-
tion time of the stochastic process gℓ. This identiﬁcation
is valid if

dt |t|
τℓ

fℓ(cid:18)|t|

value, we have that for all real λ

τℓ(cid:19) = τℓ,

In addition, by the properties of the ensemble mean

which implies that the behavior of fℓ at large t must be

Z ∞
O(cid:0)t−(2+ǫ)(cid:1), or smaller.
0 ≤D[gℓ(t/τℓ) + λ gℓ(t′/τℓ)]2E
≤(cid:10)gℓ(t/τℓ)2(cid:11) + 2λ hgℓ(t/τℓ) gℓ(t′/τℓ)i + λ2(cid:10)gℓ(t′/τℓ)2(cid:11)
τℓ(cid:26)fℓ(0) + 2λ fℓ(cid:18)|t − t′|

τℓ (cid:19) + λ2 fℓ(0)(cid:27) .

(18)

≤

1

Equation (18) must be true for all λ. Therefore, the dis-
criminant of the polynomial in λ must be non-positive

4(cid:20)fℓ(cid:18)|t − t′|

τℓ (cid:19) − fℓ(0)(cid:21)(cid:20)fℓ(cid:18)|t − t′|

τℓ (cid:19) + fℓ(0)(cid:21) ≤ 0 .

(19)
Consequently, fℓ(0) = max{fℓ(x)∀ x ≥ 0}. Other proper-
ties of fℓ are studied in Appendix A.
The ensemble mean value hUi is time independent. The
ensemble mean value of the noise processes is zero. There-
fore, Uc must be equal to hUi. Processes deﬁned by Eq.

(8) have two diﬀerent components, uncorrelated white
noise and correlated processes with correlation time τℓ.
Because the goal of the simulation is the calculation of
the ensemble mean hUi by the analysis of the time series,
we study the behavior of the temporal mean U(t)

U (t) =

dt′ U (t′)

1

tZ t

0

= hUi +

1

tpΓ0 W (t) +

1
t

ΛXℓ=1pΓℓ Gℓ(t/τℓ) ,

(20)

where W (t) is a Wiener process, [5]

dt′ ξ(t′)

W (t) =Z t
hW (t) W (t′)i = t< ,

hW (t)i = 0

0

(21)

(22)
(23)

with t< = min(t, t′), and Gℓ(t/τℓ) =R t

Equation (20) implies that the evolution of the tem-
poral mean U (t) has the same structure as U , with an
uncorrelated term and terms with tailed correlation func-
tions.

0 dt′ gℓ(t′/τℓ).

The autocorrelation function of the process U at times

t and t′ is deﬁned by

κ(t, t′) =(cid:10)(cid:0)U(t) − hUi(cid:1)(cid:0)U(t′) − hUi(cid:1)(cid:11)
ΛXℓ=1

Γ0
tt′ hW (t) W (t′)i +

1
tt′

=

Γℓ hGℓ(t/τℓ) Gℓ(t′/τℓ)i ,

(24)

(25)

(26)

(28)

where we have used Eqs. (13) and (14) to neglect terms involving processes with diﬀerent correlation times.

Because we have assumed fℓ is a continuous function, fℓ reaches its maximum and minimum value within any closed

interval considered. The ℓth non-diﬀusive contribution to κ(t, t′)

1
tt′ hGℓ(t/τℓ) Gℓ(t′/τℓ)i =

is bounded

1

tt′Z t

dt1Z t′

0

0

dt2

1
τℓ

1

t<t>Z t<

0

dt1 Z t>

0

dt2

1
τℓ
1
τℓ

fℓ(cid:18) tmin
fℓ(cid:18) tmin

τℓ (cid:19) ≤
τℓ (cid:19) ≤

1
tt′ hGℓ(t/τℓ) Gℓ(t′/τℓ)i ≤
1
tt′ hGℓ(t/τℓ) Gℓ(t′/τℓ)i ≤

dt1 Z t>

0

dt2

1
τℓ

fℓ(0)

fℓ(cid:18)|t1 − t2|
τℓ (cid:19) ,
t<t>Z t<

1

0

1
τℓ

fℓ(0) ,

where t> = max(t, t′), and tmin is the time at which fℓ
reaches its minimum value in the closed interval [0, t>].
There exists a t∗

ℓ (t>) ∈ [0, tmin] [24] such that,

1
tt′ hGℓ(t/τℓ) Gℓ(t′/τℓ)i =

1
τℓ

fℓ(cid:18) t∗

ℓ (t>)

τℓ (cid:19) .

Using Eqs. (23) and (27) in (24), we ﬁnd that

κ(t, t′) =

Γ0
t>

+

Γℓ
τℓ

ΛXℓ=1

fℓ(cid:18) t∗

ℓ (t>)

τℓ (cid:19) .

(27)

For all times shorter than τ1 the autocorrelation function
is the sum of diﬀusive contributions (proportional to 1/t)
plus non-diﬀusive contributions. These contributions im-
plicitly depend on t> through t∗
ℓ (t>). We assume that fℓ
satisﬁes the conditions stated in Appendix A, so that the

J. P. Neirotti, D. L. Freeman. and J. D. Doll

5

dependence of fℓ on t is weaker than 1/t (for total time
scales shorter than τℓ; see Appendix A).

We next consider the behavior of Eq.

(28) for time
scales greater than τ1. Under the scale change t → bt
such that τ1 ≪ bt> ≪ τ2, the contributions to the cor-
relation function from the process with correlation time
τ1 can be considered diﬀusive [in other words, by virtue
of Eqs.
(10) and (12), f1/τ1 has become a delta func-
tion]. With bt> ≪ τ2, the other processes preserve their
old properties. Then, the autocorrelation function can be
expressed

hg(m)
ℓ; k/τℓi = 0
τℓ (cid:19) .
ℓ′; k′/τℓ′i = δm,n δℓ,ℓ′ fℓ(cid:18)|k − k′|
g(n)

hg(m)

ℓ; k/τℓ

(33)

(34)

The true ensemble average hUi does not depend on the
index m.

In the discrete case we deﬁne a metric

dk =

2

M (M − 1)

MXi=2

i−1Xj=1h U

(i)

k − U

(j)

k i2

,

(35)

(29)

where the bars represent the temporal mean value

κ(bt, bt′) =

Γ0 + Γ1

bt>

+

Γℓ
τℓ

ΛXℓ=2

fℓ(cid:18) t∗

bℓ(t>)

τbℓ (cid:19) .

The complete derivation of Eq. (29) can be found in Ap-
pendix B. For a times larger than the correlation time τΛ,
all contributions to the autocorrelation function are diﬀu-
sive, the simulation can be considered ergodic, the sam-
pling complete, and the temporal mean is equal to the
ensemble mean within O(1/t) mean square ﬂuctuations.

IV. DISCRETE TIME SEQUENCES AND THE MC

METRIC

Monte Carlo simulations generate discrete sequences Uk
of values of the quantity under study. Additionally, in ac-
tual calculations the ensemble of sequences is represented
by a ﬁnite rather than an inﬁnite set. In this section, the
model developed in the previous section is extended to
ﬁnite sets of discrete sequences. We express the M se-

quences nU (m)
k oK

, where the label (m) ranges from 1
to M . The exact ensemble mean value hUi can be ob-
tained in the limit that M becomes inﬁnite. In analogy
with the model developed in Section III, each output is
assumed to have the form

k=1

U (m)

k = hUi +pΓ0 ξ(m)

k +

ΛXℓ=1pΓℓ g(m)

ℓ; k/τℓ

,

(30)

where

i = 0

hξ(m)
k
ξ(n)
k′ i = δm,n δk,k′

hξ(m)

k

(31)

(32)

U

(m)
k =

1
k

kXk′=1

= hUi +

U (m)

k′

√Γ0
k

with

W (m)

k +

√Γℓ
k

ΛXℓ=1

G(m)

ℓ; k/τℓ

,

(36)

W (m)

k =

G(m)

ℓ; k/τℓ

=

ξ(m)
k′

g(m)
ℓ; k′/τℓ

.

kXk′=1
kXk′=1

(37)

(38)

Observe that in the present case, our ﬁnite sample of the
inﬁnite ensemble is the set of outcomes from M indepen-
dent numerical experiments. The metric we have deﬁned
in Eq.
(35) can be contrasted with alternative metrics
[3,9,10] previously deﬁned for molecular dynamics simula-
tions. These alternative metrics examine the ﬂuctuations
of two simulations initialized from diﬀerent components of
conﬁguration space averaged with respect to all the par-
ticles in the system. The metric we use in this work is de-
termined using an average with respect to M independent
simulations that represent a subset of the full ensemble.

Using the model presented in Eq. (30), we now develop
a way to predict the behavior of the MC simulation in
the non-ergodic and the ergodic regimes. We ﬁrst con-
sider the case that the total simulation time K is larger
than the ﬁrst correlation time τ1 but shorter than τ2, i.e.
τ1 ≪ K ≪ τ2. The expression for dk is given by

dk =

=

= 2 Γ0

2

(i)

M (M − 1)
2
M

i−1Xj=1h(cid:16)U
MXi=2
k − hUi(cid:17)2
MXi=1(cid:16)U
MXi=1  W (i)
k !2

1
M

k

−

4

(i)

k − hUi(cid:17) −(cid:16)U
MXi=2


M (M − 1)

MXi=1

1
M

(i)

(j)

k − hUi(cid:17)i2
k − hUi(cid:17)(cid:16)U
i−1Xj=1(cid:16)U
k 
ΛXℓ=2

1; k/τ1

+ 2

Γℓ

2

G(i)

+ 2 Γ1

(j)

k − hUi(cid:17)

MXi=1

1
M

G(i)

ℓ; k/τℓ

2

k 

6

The Approach to Ergodicity in Monte Carlo Simulations

+ 4

−

1
M

ΛXℓ=1pΓ0Γℓ
MXi=2

M (M − 1)

4

MXi=1
i−1Xj=1(cid:16)U

W (i)

k G(i)

ℓ; k/τℓ

k2

(i)

k − hUi(cid:17)(cid:16)U

+ 4

ℓ−1Xℓ′=1pΓℓΓℓ′

ΛXℓ=2
k − hUi(cid:17) .

(j)

G(i)

ℓ; k/τℓ

ℓ′; k/τℓ′

G(i)
k2

1
M

MXi=1

(39)

If the number of experiments M is suﬃciently large, we can neglect terms involving processes with diﬀerent correlation
times, and products of sequences belonging to diﬀerent experiments. Under these assumptions we obtain

dk = 2

Γ0
k

1
M

2

W (i)
k
k

+ 2

Γ1
k

1
M

MXi=1

2

1; k/τ1

G(i)
k

+ 2

MXi=1

Γℓ

1
M

ΛXℓ=2

MXi=1



G(i)

ℓ; k/τℓ

2

k 

.

(40)

Equation (40) preserves the form of Eq. (28). To make
this statement explicit, let us rewrite Eq. (40) as

dk = 2

Γk
k

+ 2 Υk ,

where

Γk = Γ0

1
M

Υk =

Γℓ

ΛXℓ=2

MXi=1

1
M

MXi=1

2

.

2

W (i)
k
k

+ Γ1

1
M

MXi=1



G(i)

ℓ; k/τℓ

k 

2

1; k/τ1

G(i)
k

(41)

(42)

(43)

In Appendix B we present a study of the way non-diﬀusive
contribution become diﬀusive under time scale changes. If
M is suﬃciently large and τ1 ≪ K ≪ τ2, by virtue of Ap-
pendix B, Γk must roughly be a constant. By roughly a
constant we mean a constant C plus some rapidly ﬂuctuat-
ing function ζk, with the following properties: a) hζki = 0
and b) |C| ≫ maxk=1,2,...,K(|ζk|). Then

Γk ≃ ΓK + ζk

(44)

If K is enlarged, we expect to have a larger value of ΓK.
Υk is a quantity related to the memory functions fℓ with
correlation times τℓ ≫ K. In the continuous time model,
the colored noise processes contribute to the autocorre-
lation function with terms proportional to fℓ(t∗
ℓ (t>)/τℓ),
which are weakly dependent on t (see Appendix A). We
can expect Υk to be weakly dependent on k, and for se-
quences of length K and for M suﬃciently large, we con-
sider this quantity roughly to be a constant

ΓK and ΥK are the quantities that carry the long time
dependence. Short time features appear in the 1/k de-
pendence and in the remaining noise γk. If the sequences
considered are increased in size by a factor of b, such that
τλ−1 ≪ K ≪ τλ ≪ bK for a given 1 ≤ λ ≤ Λ, ΓK (ΥK)
is increased (decreased) (see Appendix B). Then,

dbk = 2

ΓbK
bk

+ 2 ΥbK + γbk ,

(47)

where ΥbK must go to zero and ΓbK must approach a
constant when b is increased. By virtue of the expected
behavior of the non-diﬀusive contributions (see Appendix
A), we propose the following expression for ΥbK

ΥbK = ΥK φ(b) ,

(48)

where φ(b) is a decreasing function of b. Moreover, ΥbK
is a sum of non-diﬀusive contributions. As presented in
Appendix A, each non-diﬀusive contribution to the auto-
correlation function has a relative variation smaller than
the relative variation of the diﬀusive contribution, namely
1 − 1/b. If this inequality is applicable to the sum of non-
diﬀusive contributions, we have that

1 −

1 −

> 1 −

1
ΥbK
ΥK
b
1
> 1 − φ(b)
b
1 < b φ(b) ,

for all b > 1. Then, φ must be either

(49)

(50)

(51)

(52)

(53)

Υk ≃ ΥK + βk .

(45)

where βk represents additional random noise. Then, for
a given length k ≤ K, the MC metric dk can be approxi-
mated by

or

φ(b) = b−υ

φ(b) =

1

η ln(b) + 1

,

dk = 2

ΓK
k

+ 2 ΥK + γk ,

(46)

where γk = 2(ζk/k + βk) represents remaining stochas-
tic noise from both contributions. In this approximation,

with 0 < υ < 1 and 0 < η ≤ 1. Equation (53) can be
thought as the limit of Eq. (52) when the exponent goes
to zero. We know of no a priori argument to justify Eq.
(48). However, as is discussed in Section V, our numerical

J. P. Neirotti, D. L. Freeman. and J. D. Doll

7

experience has shown Eq. (48) to be obeyed in all cases
we have examined.

Our goal is to develop a criterion to decide when the
simulation can be considered ergodic. From the previ-
ous considerations it is clear that the ergodic limit is
reached when ΥK is indistinguishable from zero. The
output from a MC simulation is usually noisy. There-

fore, γk can not be neglected. A useful way to separate
diﬀusive and non-diﬀusive contributions and to eliminate
the stochastic noise from Eq. (46), is to perform a Fourier
analysis of the function kdk. Let us deﬁne the frequencies
ωn = (2π/K) n, with n = 0, 1, . . . , K − 1. The discrete
Fourier transform of the function kdk is the signal YK(ωn)

YK (ωn) =dkdk(ωn) =
KXk=1

2
K

=

1
K

KXk=1

exp(−iωnk) kdk

exp(−iωnk) ΓK +

2
K

KXk=1

k exp(−iωnk) ΥK +dkγk(ωn)

= 2 δn,0 ΓK + {δn,0(K + 1) + (1 − δn,0) (1 + i cot(ωn/2))} ΥK +dkγk(ωn)
= 2 δn,0 ΓK + (K δn,0 + 1) ΥK + i (1 − δn,0) cot(ωn/2) ΥK +dkγk(ωn)

(54)

(55)

In general, dkγk(ωn) is negligible except at high frequen-

cies. For small positive values of the frequency we can
make the approximation cot(ωn/2) ≃ 2/ωn. From this
approximation we have

Im (YK(ωn)) ≃

2
ωn

ΥK .

The real part of Eq. (55) for positive frequencies is

Re (YK(ωn)) = ΥK .

(56)

(57)

Even though simpler than Eq. (56), we have found Eq.
(57) is more sensitive to the deviations of dk from the ap-
proximation Eq. (46). Therefore, the data obtained from
the real part is of poorer quality than the data obtained
from the imaginary part.

Equation (56) implies that for a given simulation length
K, the contributions to the MC metric from the non-
diﬀusive process can be determined from a simple rela-
tionship involving the Fourier transform of the function
kdk at low frequencies. By increasing the length of the
run K by a factor of b, it is possible to observe the depen-
dence of ΥbK on bK.

V. APPLICATIONS

The concepts developed in the previous sections are suf-
ﬁciently general to be applied to any kind of MC sim-
ulation. We devote the present section to the applica-
tion of the developments of this paper to the study of the
Lennard-Jones 13-particle cluster in the canonical ensem-
ble. This system has been introduced previously in Sec.
II.

Some thermodynamic properties of clusters as a func-
tion of temperature exhibit rapid changes that are remi-
niscent of similar changes that occur for the same proper-
ties in bulk systems at phase transitions. In a bulk system
a phase transition occurs at a single temperature. For

clusters the rapid changes in thermodynamic properties
occur over a ﬁnite temperature interval. To distinguish
the temperature range where thermodynamic properties
change rapidly in clusters from a true phase transition,
we follow Berry et al. [25] and refer to such changes in
physical properties as associated with a phase change. A
common property that has been found to be useful in mon-
itoring these phase change intervals of temperature is the
heat capacity at constant volume [26]

CV (T ) =

1

kBT 2 (cid:10)(V − hV iT )2(cid:11)T +

3
2

N kB ,

(58)

where h·iT represents the classical canonical mean value.
In this work we consider the bare Metropolis (Met), [20]
J-walking (Jw), [16] and parallel tempering (PT) [17–19]
approaches to Monte Carlo simulations. The free variable
of all these methods is the reduced temperature kBT /ε.
In PT and Jw simulations, the highest temperature used
(Th) must be suﬃciently large to ensure that Met is er-
godic. [16] From experience simulating a variety of sys-
tems, we have found that Th must also be lower than a
temperature Tb where cluster evaporation events become
frequent.
It is useful to think of Tb as the cluster ana-
logue of a boiling temperature. We have found that Met
is unable to sample the boiling phase change region for
clusters ergodically, using total time scales accessible to
current simulations.

For the results that follow, U (m)

is chosen to be repre-
sented by the potential energy of the system. In general
U (m)
can be any scalar property of the system. We deﬁne
a pass to represent a set of single particle MC moves taken
sequentially over the 13 particles in the cluster. We take
U (m)
to be the potential energy at the k′th pass, in the
m′th experiment. Using Eq. (55) we can write

k

k

k

YK(0) = 2 ΓK + (K + 1) ΥK .

(59)

In the non-ergodic regime, YK (0) grows with K, while in
the ergodic regime, the signal YK(0) approaches a con-
stant.

8

The Approach to Ergodicity in Monte Carlo Simulations

We begin by displaying results obtained for a calcula-
tion that has not attained ergodicity over the time scale
of the simulation. We examine the 13-particle Lennard-
Jones cluster with the Met algorithm setting Rc = 4σ at
a temperature of kBTh/ε = 0.393. The temperature is
chosen to be that typically used as the initial high tem-
perature in Jw and PT studies of LJ13. By choosing a
large constraining radius, the evaporation events are so
frequent at the chosen temperature that attaining ergodic-
ity proves to be quite diﬃcult. We demonstrate the eﬀect
of reducing the constraining radius shortly.

200000

150000

)
0
(

 

K
Y

100000

50000

0
−10

−15

−20

−25

−30

K
|
U

0

2000

4000

6000

8000

10000

K

Fig. 2: The upper panel is the signal YK (0) (in units of ε2) vs.
K for Rc = 4σ at kB Th/ε = 0.393. from M = 40 independent ex-
periments, of LJ13. The length of the simulation is 104 MC passes.
The lower panel shows the “time evolution” of U K (in units of ε)
for 15 independent experiments. At least three basins with diﬀerent
energies are present. Clearly, the simulation at this scale of time, is
not ergodic.

The number of replicas used in the calculation is M = 40,
and K = 104. The upper panel of Fig. 2 shows the sig-
nal YK(0) [evaluated using Eq. (54)], which grows along
the entire simulation. This is the behavior expected in
the non-ergodic regime.
In the lower panel we can see

the “time evolution” of the temporal mean values of 15
experiments.

12.0

10.0

8.0

K
b

ϒ

6.0

4.0

2.0

0.0
8.0

6.0

K
b

ϒ

 
/

 
 

K

ϒ

4.0

2.0

0.0

0

Rc = 4.0σ
Rc = 3.0σ
Rc = 2.5σ
Rc = 2.0σ

Rc = 4.0σ
Rc = 3.0σ

1

2

3

log2 (b)

4

5

6

Fig. 3: Upper panel: ΥbK (in units of ε2) as a function of log2(b)
for Rc = 4σ, 3σ, 2.5σ, and 2σ. For the two larger radii the full line is
the best ﬁt to the data points, according to Eq. (48) with φ deﬁned
in Eq. (53). The lower panel shows the linear behavior of ΥK /ΥbK
vs. log2(b), for Rc = 4σ and 3σ. K has been set to 104.

There are three sets of curves, each of which is indicative
of sampling of at least three diﬀerent energy basins. At
low values of K the curves in the lower panel diﬀer signif-
icantly. At K ≃ 4 000 the high energy basin curves begin
to decrease in energy. For a value of K larger than the
data displayed in Fig. 2, the curves can be expected to
coalesce with the low energy basin curves. It is clear that
for K ≤ 10 000, the simulation is not ergodic.
In PT and Jw studies it is essential that the initial high
temperature walk be ergodic. Ergodicity can be attained
for LJ13 by reducing the radius of the constraining poten-
tial so that evaporation events are rare. We now present
a study of ΥK as a function of K for several values of
Rc. To determine ΥK, we have calculated the Fourier
transform function YK(ωn) using Eq. (54) at a series of
frequencies ωn = 2πn/K where n has ranged from 1 to

J. P. Neirotti, D. L. Freeman. and J. D. Doll

9

min(√12bK/20π, 100). This range of frequencies ensures
the linear approximation used in Eq. (55) is valid while
including suﬃcient numbers of points for accuracy. [27]
Using Eq. (56), we have calculated the slope of the imag-
inary part of 1/YK(ωn) as a function of ωn, for these fre-
quencies. The data points appearing in Fig. 3 are the
mean value over twenty independent calculations of the
slope of 1/YK(ωn).

Rc = 2.5σ
error in ϒ(Rc = 2.5σ)
Rc = 2.0σ
error in ϒ(Rc = 2.0σ)

1.50

1.25

1.00

K
b

ϒ

0.75

0.50

0.25

0.00

0

1

2

3

log2 (b)

4

5

6

Fig. 4: ΥbK (in units of ε2) and its error vs.

log2(b) for
Rc = 2.5σ and 2σ, with K = 104. When ΥbK is on the order of its
own error, the simulation can be considered ergodic. For Rc = 2σ
the simulation becomes ergodic at log2(b) ≃ 4 (bK ≃ 16 × 104). For
Rc = 2.5σ a longer simulation is needed to reach ergodicity.

Starting from random conﬁgurations, we have per-
formed 5 × 104 Met passes at kBTh/ε = 0.393. After
this warmup process, we have created sequences of sizes
bK = 104, 2 × 104, 4 × 104, . . ., 64 × 104. The results are
presented in Fig. 3 for Rc = 4σ, 3σ, 2.5σ, and 2σ. The
upper panel shows ΥbK as a function of log2(b), for ﬁxed
K = 104. We have chosen to present the data using base
2 logarithms for clarity (each increase by 1 unit of log2(b)
represents a factor of 2 scale increase). All the data de-
crease with increasing b, but only Rc = 2σ and Rc = 2.5σ
appear to vanish to within the error bars over the time
scale of the current simulation.
In the lower panel we
present ΥK/ΥbK as a function of log2(b) for Rc = 4 and

3σ. The decay law suggested in Eq. (48) with φ given by
Eq. (53) is satisﬁed for both radii.

2.0

1.5

K
b

ϒ

1.0

0.5

0.0
6.0

5.0

4.0

3.0

2.0

1.0

0.0

0

)

 

K
b

ϒ

 
/

 

K

ϒ
(
 

2
g
o
l

PT
Met

PT, υ = 0.93(3)
Met, υ = 0.94(2)

1

2

3

4

5

log2 (b)

Fig. 5: The upper panel shows the decay behavior of ΥbK (in
units of ε2) as a function of log2(b) for PT and Met, at the tem-
perature of the melting peak of the heat capacity, kBTm/ε = 0.282.
From Eq. (52), we plot log2 (ΥK /ΥbK ) vs. log2 (b), to extract the
value of the exponent υ (the slope of the linear ﬁt). We have found
υ = 0.93 ± 0.03 for PT, and υ = 0.94 ± 0.02 for Met. The straight
lines are the best linear ﬁts of the data points.

We have stated that the simulation can be considered
eﬀectively ergodic when ΥK is indistinguishable from zero.
In Fig. 4 we have plotted ΥbK and its statistical error as a
function of log2(b) for Rc = 2.5 and 2σ. For Rc = 2σ the
crossing point of ΥbK and its error is at bK ≃ 16 × 104.
For Rc = 2.5σ the crossing point is at a bK > 64 × 104.
We can conclude that for kBTh/ε = 0.393 and Rc = 2σ
the simulation can be considered eﬀectively ergodic after
16 × 104 Met passes.
Once a constraining radius is chosen, PT and Jw sim-
ulations require the highest temperature Th be chosen so
that Met is ergodic. For a given Rc, the extent of ergodic-
ity can be tested using the same metric that has been used
for determining the optimum value of Rc, but by varying

10

The Approach to Ergodicity in Monte Carlo Simulations

the temperature. For the parameters kBTh/ε = 0.393 and
Rc = 2σ the simulation is ergodic even at very short se-
quence lengths. We have found that for kBTh/ε < 0.393
the simulations are not ergodic. To be sure that the pa-
rameters are appropriate, we have performed a short PT
simulation (104 passes, ten PT passes consists of nine Met
passes plus an exchange attempt) with 40 equally spaced
temperatures in the range kBT /ε =[0.028,0.393] in order
to obtain a ﬁrst estimate of the position of the melting
and boiling temperature regions. The boiling peak in the
speciﬁc heat appears to be located at a higher tempera-
ture than kBT /ε = 0.393. Moreover, the value of CV at
kBT /ε = 0.393 is about one-half the value of CV at the
temperature of the melting peak kBTm/ε = 0.282. From
these results we feel it is safe to choose Rc = 2σ and
kBTh/ε = 0.393 for the calculations that follow.

We now illustrate the convergence characteristics of ΥK
when we increase the total time scale of the calculation by
a factor b. We illustrate this behavior using a PT simula-
tion of LJ13, and we focus on results at the temperature of
the melting peak in the heat capacity (kBTm/ε = 0.282).
We choose this temperature, because from experience
[14,15,23] we know the statistical ﬂuctuations are large at
the melting heat capacity maximum. The large statistical
ﬂuctuations make it possible to emphasize the behavior
of ΥK. We have run the PT simulation at 40 equally
spaced temperatures in the range kBT /ε = [0.028,0.393].
The initial warmup time has been set to 104 Met passes,
followed by 2 × 104 PT passes. Following the warm-up
period, we perform simulations of 105, 2 × 105, 4 × 105,
8× 105, 16× 105, and 32× 105 PT passes. In each case the
initial conﬁguration has been taken to be the last conﬁg-
uration of the previous run. The output of the simulation
are sequences of the potential energy. ΥK has been deter-
mined in the same way as in the calculation of the high
temperature parameters (presented in Fig. 3 and Fig. 4).
The data points appearing in the upper panel of Fig. 5
are the mean value over twenty independent calculations
of the slope of 1/YK(ωn). In the lower panel of Fig. 5
we have plotted log2 (ΥK/ΥbK) as a function of log2 (b),
where K = 104 and b = 1, 2, 4, . . . , 32. The slope of the
linear ﬁt is the exponent υ, according to Eq. (52). At the
temperature of the melting peak, υ = 0.93 ± 0.03.
It is of interest to perform a similar study of the behav-
ior of ΥK as a function of the time scaling for an Met cal-
culation. We have taken the ﬁnal conﬁguration of the PT
simulation at kBTm/ε = 0.282 as an initial conﬁguration,
and we have performed a simple Met simulation at that
melting temperature. A graph of ΥbK and log2 (ΥK/ΥbK)
as a function of log2 (b) for Met is also presented in Fig.
5. From the upper panel of Fig. 5, it is evident that Met
results are not ergodic within the same scaled time as the
PT results. It is also evident that the power law exponent
for both Met and PT are not distinguishable. Similar
studies of the power law using the Jw method also give
the same exponent. Neither an increase in the number
of temperatures nor changing the distribution of temper-
atures in both Jw and PT simulations has any eﬀect on

the calculated exponent.

Jw
Met

40

30

T
P

Γ

20

 
/
 

Γ

10

0
0.0

0.1

0.2

kB T / ε

0.3

0.4

Fig. 6: Comparison of the Met and Jw diﬀusion coeﬃcients
with the PT diﬀusion coeﬃcient as a function of the reduced tem-
perature. The dashed line represents equivalence between methods.

By using the results to compare the relative eﬃciencies
of Met, Jw and PT simulations for the LJ13 system. We
have found that PT and Jw simulations can be considered
ergodic if the run length is on the order of 2× 105 passes,
while Met simulations that are initialized from conﬁgu-
rations generated from an ergodic PT study are ergodic
when the total run length consists of 2 × 106 passes or
more.

In order to compare approaches, we have calculated Γ
as a function of the reduced temperature, for the three
methods. The comparison of diﬀusion coeﬃcients from
diﬀerent algorithms has also been used by Andricioaei and
Straub [13]. The comparison of Jw and Met with PT is
presented in Fig. 6. The Jw and PT simulations are found
to have comparable eﬃciencies using Γ as a measure for all
calculated temperatures. At intermediate temperatures,
Met is signiﬁcantly less eﬃcient. We have chosen to trun-
cate the Jw study at kBT /ε = 0.12. For temperatures
below kBT /ε = 0.12, Jw simulations require signiﬁcant ef-
fort, because a large set of external distributions must be
generated. Because at temperatures below kBT /ε = 0.12

J. P. Neirotti, D. L. Freeman. and J. D. Doll

11

LJ13 is dominated by structures close to the lowest energy
icosahedral isomer, we expect the Jw and PT methods to
have similar eﬃciencies (as measured by Γ) for all tem-
peratures.

VI. CONCLUSIONS

In this paper we have presented a study of the approach
to the ergodic limit in MC simulations. In all the cases
examined, the behavior of the MC metric dk can be ap-
proximated by Eq. (46), and the behavior of ΥbK satisﬁes
Eq. (48). Because the exponent υ is smaller than one for
all the cases studied, the dependence of the non-diﬀusive
contributions on dk is weaker (in the sense of Appendix
A) than the diﬀusive contributions. The assumption on
which we have built the stochastic model have been veri-
ﬁed numerically for a system having a suﬃciently complex
potential surface to be viewed as prototypical of a large
set of many-particle systems.

The MC metric used in this work appears to be a valu-
able tool to study the ergodicity properties of MC simu-
lations. The non-ergodic components of the MC metric
enable the prediction of the minimum length a MC simu-
lation must have in order to be considered ergodic. The
comparison of Γ from diﬀerent algorithms gives a reason-
able estimate of their relative eﬃciencies.

From the study of the melting region of 13 particle clus-
ters, we have found that the exponent υ depends both on
the method used and the nature of the potential energy
function. We have performed calculations, not discussed
in this work, where the functional form of the potential
energy is modiﬁed. These studies have shown υ to be
dependent on the details of the potential. We have not
found the exponent υ to be a strong function of method.
Although PT and Met have signiﬁcantly diﬀerent eﬃcien-
cies as measured by their relative diﬀusion coeﬃcients, υ is
nearly the same in the two methods. The diﬀerence in the
decay of ΥK appears to be dominated by the coeﬃcient
in Eqs.(48) and (52) rather than the exponent.

As discussed in the text, parallel tempering and J-
walking studies of many-particle systems must have an
initial high temperature component that is chosen so that
a Met simulation is known to be ergodic. For cluster sim-
ulations that require an external constraining potential to
deﬁne the cluster, the radius of the constraining poten-
tial must be carefully chosen in order to achieve ergodic
results. We have found the metric and associated decay
laws developed in this work to be a particularly valuable
method of choosing these initial parameters in both par-
allel tempering and J-walking simulations.

We also remark that the metric introduced here may be
a more sensitive probe of ergodicity than may be required
in some applications. For example in previous J-walking
studies [26] of the 13-particle Lennard-Jones cluster, the
heat capacity curve determined with a constraining radius
of 4σ is nearly indistinguishable from the curve obtained
with a constraining radius of 2σ. From the results of this

work, we know the initial high temperature walk is not
ergodic when a constraining radius of 4σ is used.
It is
striking that the non-ergodicity as measured by the en-
ergy metric is not apparent in the heat capacity curve.

We have constructed a metric based on an ensemble of
MC trajectories. By using an ensemble we attempt to
cover suﬃcient portions of space so that all components
are accessible.
In practice only a ﬁnite subset of a full
ensemble can be included, and it is always possible that
components of space are missed. In such a case ΥK may
decay to zero numerically within the subspace, and the be-
havior may give misleading evidence that the simulation
is ergodic. Because components of space may be missed in
any ﬁnite simulation, it is impossible to guarantee ergod-
icity. It is hoped by using a suﬃciently large ensemble of
trajectories to deﬁne the metric, the possibility of missing
components is minimized.

ACKNOWLEDGMENTS

We would like to thank Dr. O. Osenda for helpful com-
ments. This work has been supported in part by the
National Science Foundation under grant numbers CHE-
9714970 and CDA-9724347. This research has been sup-
ported in part by the Phillips Laboratory, Air Force Mate-
rial Command, USAF, through the use of the MHPCC un-
der cooperative agreement number F29601-93-0001. The
views and conclusions contained in this document are
those of the authors and should not be interpreted as nec-
essarily representing the oﬃcial policies or endorsements,
either expressed or implied, of Phillips Laboratory or the
U.S. Government.

APPENDIX A: WEAK DEPENDENCE OF THE

NON-DIFFUSIVE CONTRIBUTIONS

We have considered two overall time scales for a MC
simulation. Properties calculated at short times (labeled
k in the discrete case) provide information about each step
of the MC process, and properties averaged over the total
simulation time (labeled K in the discrete case) give in-
formation about the approach to ergodic behavior. When
K is suﬃciently short we have both diﬀusive and non-
diﬀusive contributions as a function of k.
In this Ap-
pendix we explain the relative time dependence of the
diﬀusive and non-diﬀusive contributions to the autocorre-
lation function.

It has been assumed that the autocorrelation function
Eq. (28) can be expressed as the sum of diﬀusive terms
plus non-diﬀusive terms, i.e.

κ(t, t′) = κd(t, t′) +

ΛXℓ=λ+1

κnd , ℓ(t, t′) ,

(A1)

where

12

The Approach to Ergodicity in Monte Carlo Simulations

κd(t, t′) =

Γ0 + Γ1 + Γ2 + . . . + Γλ

κnd , ℓ(t, t′) =

Γℓ
τℓ

t>

fℓ(cid:18) t∗
τℓ(cid:19) .

ℓ

(A2)

(A3)

Increasing the time variables by a factor b > 1, such
that τλ ≪ bt> ≪ τλ+1, with λ ≥ 1, we can study the
relative variations of each contribution to the correlation
function, diﬀusive and non-diﬀusive (labeled by ℓ > λ).
In this Appendix we only consider values of b such that
the transformation t → bt does not increase the time scale
beyond the local correlation time. In Appendix B values
of b are considered that do cross such time scales.

By relative variations we mean

The relative variation of each non-diﬀusive contribution is

∆d(t, t′; b) =(cid:12)(cid:12)(cid:12)(cid:12)
∆nd , ℓ(t, t′; b) =(cid:12)(cid:12)(cid:12)(cid:12)
∆nd , ℓ(t, t′; b) =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

κd(bt, bt′) − κd(t, t′)

κd(t, t′)

κnd , ℓ(bt, bt′) − κnd , ℓ(t, t′)

κnd , ℓ(t, t′)

(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12) .
0 dt2 fℓ(cid:16) |t1−t2|
τℓ (cid:17)
τℓ (cid:17)
0 dt2 fℓ(cid:16) |t1−t2|

(A4)

(A5)

.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(A6)

1 −

1

0 dt1R bt′
b2R bt
0 dt1R t′
R t

whereas the relative variation of the diﬀusive contribution
is

∆d(t, t′; b) = 1 −

1
b

,

(A7)

If ∆d(t, t′; b) > ∆nd , ℓ(t, t′; b) for all pair of times t and
t′ and for all b > 1 such that bt> ≪ τℓ, we say that the

non-diﬀusive contributions are weaker than the diﬀusive
contribution in their dependence on t. We explore, in the
remainder of this appendix, the properties fℓ must have
in order that the inequality ∆d(t, t′; b) > ∆nd , ℓ(t, t′; b) is
satisﬁed.

Lemma: If the function Hℓ(t; τ )

Hℓ(t; τ ) =Z t

0

dt′ fℓ(cid:18) t′

τ(cid:19) > 0

satisﬁes the inequality

Hℓ(t; τ ) > t fℓ(cid:18) t

τ(cid:19) ∀ t and τ ,

then, Hℓ(t; τ ) is an increasing function of τ .

(A8)

(A9)

Demonstration: For ℓ and t ﬁxed, the function

Hℓ(t, τ ) evaluated in τ ′ is

0

τ ′(cid:19)
dt′ fℓ(cid:18) t′
Hℓ(t; τ ′) =Z t
dt′ fℓ(cid:18) τ t′
τ ′τ(cid:19)
=Z t
τ Z τ t/τ ′
τ(cid:17)
du fℓ(cid:16) u

0
τ ′

=

0

τ ′
τ

Hℓ(τ t/τ ′; τ ) ,

=

then, for ∆τ > 0

(A10)

(A11)

(A12)

(A13)

(A14)

(A15)

(A16)

Hℓ(t; τ + ∆τ ) − Hℓ(t; τ )

∆τ

=

=

=

0

τ

1

1

∆τ ( τ + ∆τ
∆τ ( ∆τ
∆τ ( ∆τ

Z τ t/(τ +∆τ )
τ Z τ t/(τ +∆τ )
τ Z τ t/(τ +∆τ )

τ(cid:19) −Z t
dt′ fℓ(cid:18) t′
τ(cid:19) −Z t
dt′ fℓ(cid:18) t′
τ(cid:19) −
dt′ fℓ(cid:18) t′

t∆τ

τ(cid:19))
dt′ fℓ(cid:18) t′
τ(cid:19))
dt′ fℓ(cid:18) t′
τ(cid:19)) ,
fℓ(cid:18) t∗

τ + ∆τ

τ t/(τ +∆τ )

1

0

0

0

where t∗ ∈ [tτ /(τ + ∆τ ), t].
In the limit ∆τ → 0, and
by virtue of the continuity of fℓ, the derivative takes the
form

∂Hℓ(t; τ )

∂τ

=

1

τ (cid:26)Hℓ(t; τ ) − tfℓ(cid:18) t

τ(cid:19)(cid:27) .

(A17)

must be suﬃciently large to satisfy Eq. (A8). Moreover,
fℓ(0) must be suﬃciently large to satisfy Eq. (A9), even
at points where fℓ(t/τ ) is a local maximum. Then, to
satisfy this Lemma, we need a memory function with a
suﬃciently large global maximum at t = 0.

Then, ∂Hℓ(t; τ )/∂τ > 0, and Hℓ(t; τ ) is an increasing
function of τ. ✷

Here we have presented the two ﬁrst conditions fℓ must
have, namely Eqs. (A8) and (A9). From Eq. (19) fℓ(0)
is a global maximum, and the memory functions must
have a positive peak at zero. The area below that peak

Corollary: Suppose Hℓ(t; τℓ) > tfℓ(t/τℓ).

If b > 1,

then 0 < ∆nd , ℓ(t, t′; b) < 1 for all pair of times t and t′.

Demonstration: Under the change of scale in time

t → bt, κnd , ℓ(t, t′) can be written

J. P. Neirotti, D. L. Freeman. and J. D. Doll

13

then, the quotient κnd , ℓ(bt, bt′)/κnd , ℓ(t, t′) is

κnd , ℓ(bt, bt′)
κnd , ℓ(t, t′)

κnd , ℓ(bt, bt′) =

0

τℓ

dt2

1
τℓ

1
τℓ

fℓ(cid:18)|t1 − t2|
τℓ (cid:19)
fℓ(cid:18) b|t1 − t2|
(cid:19) ,
τℓ/b(cid:17) +R t>−t1
τℓ(cid:17) +R t>−t1

dt fℓ(cid:16) t
τℓ/b(cid:17)o
τℓ(cid:17)o
dt fℓ(cid:16) t

0

0

0

0

0

1

1

=

dt2

b2tt′Z bt
dt1Z bt′
tt′Z t
dt1Z t′
0 dt fℓ(cid:16) t
0dt1nR t1
= R t
0 dt fℓ(cid:16) t
0dt1nR t1
R t
= R t
R t

0dt1 {Hℓ(t1; τℓ/b) + Hℓ(t> − t1; τℓ/b)}

.

0dt1 {Hℓ(t1; τℓ) + Hℓ(t> − t1; τℓ)}

(A8), Hℓ(t; τ ) > 0 ∀ t and τ .

By Eq.
By the
Lemma the numerator is smaller than the denomina-
tor. Then 0 < κnd , ℓ(bt, bt′)/κnd , ℓ(t, t′) < 1 and then,
0 < ∆nd , ℓ(t, t′; b) < 1. ✷

Theorem: Suppose that b > 1 is such that τℓ−1 ≪
bt> ≪ τℓ, Hℓ(t; τℓ) > tfℓ(t/τℓ), and all fℓ satisfy the Lip-
schitz condition [28] (for all closed interval A exists a real
positive number Cℓ such that

1 <

|fℓ(x) − fℓ(y)| ≤ Cℓ |x − y|

(A22)
for all x and y in A). Then ∆nd , ℓ(t, t′; b) < ∆d(t, t′; b)

if and only if fℓ is non-negative in the interval [0, t>).

Demonstration: If ∆nd , ℓ(t, t′; b) < ∆d(t, t′; b), then

1
b

1 −

> 1 −

1

0 dt2 fℓ(cid:16) |t1−t2|
τℓ (cid:17)
0 dt1R bt′
b2R bt
τℓ (cid:17)
0 dt2 fℓ(cid:16) |t1−t2|
0 dt1R t′
R t
0 dt2 fℓ(cid:16) |t1−t2|
τℓ (cid:17)
0 dt1R bt′
bR bt
τℓ (cid:17)
0 dt2 fℓ(cid:16) |t1−t2|
0 dt1R t′
R t

1

where the operations to reach Eq. (A24) are valid by using
Corollary. Then

(A18)

(A19)

(A20)

(A21)

(A23)

(A24)

(A25)

(A26)

(A27)

(A28)

(A29)

(A30)

(A31)

(A32)

0

0

0

0

0

0

0

τℓ

1
b

dt2

0 <Z bt
0 <Z t
0 <Z t<
0 <Z t<
0 <Z t<
0 <Z t<

τℓ (cid:19) −Z t

dt1Z bt′
dt1Z t′
dt1(cid:26)Z t1
dt1(cid:26)Z t1
dt1(Z bt1
dt1(Z bt1

dt2 fℓ(cid:18)|t1 − t2|
fℓ(cid:18)|t1 − t2|
τℓ (cid:19)
dt1Z t′
(cid:19) − fℓ(cid:18)|t1 − t2|
τℓ (cid:19)(cid:27)
dt2(cid:26)b fℓ(cid:18) b |t1 − t2|
dt2(cid:20)b fℓ(cid:18) b (t1 − t2)
dt2(cid:20)b fℓ(cid:18) b (t2 − t1)
(cid:19) − fℓ(cid:18) t1 − t2
τℓ (cid:19)(cid:21) +Z t>
dt(cid:20)b fℓ(cid:18) bt
dt(cid:20)b fℓ(cid:18) bt
τℓ(cid:19) − fℓ(cid:18) t
τℓ(cid:19) − fℓ(cid:18) t
τℓ(cid:19)(cid:21) +Z t>−t1
τℓ(cid:19)(cid:21)(cid:27)
dt fℓ(cid:18) t
dt fℓ(cid:18) t
dt fℓ(cid:18) t
τℓ(cid:19) −Z t>−t1
τℓ(cid:19) −Z t1
τℓ(cid:19) +Z b(t>−t1)
dt fℓ(cid:18) t

τℓ(cid:19) +Z b(t>−t1)
τℓ(cid:19)) .
dt fℓ(cid:18) t

t>−t1

τℓ

τℓ

t1

t1

0

0

0

0

0

0

0

0

0

0

(cid:19) − fℓ(cid:18) t2 − t1

τℓ (cid:19)(cid:21)(cid:27)

τℓ(cid:19))
dt fℓ(cid:18) t

Using the intermediate value theorem, [24] we have

dt′ fℓ(cid:18) t′
Z bt

t

τℓ(cid:19) = (b − 1) t fℓ(cid:18) t∗(t)
τℓ (cid:19)
τℓ(cid:19) + (b − 1) t(cid:20)fℓ(cid:18) t∗(t)
= (b − 1) t fℓ(cid:18) t

τℓ (cid:19) − fℓ(cid:18) t

τℓ(cid:19)(cid:21) ,

where t∗(t) ∈ [t, bt]. Let be t∗
intervals [t, bt] and [t> − t, b(t> − t)] respectively

α(t) and t∗

β(t) the values at which the intermediate value theorem is satisﬁed, in the

14

The Approach to Ergodicity in Monte Carlo Simulations

α(t)

(b − 1) t fℓ(cid:18) t∗
(b − 1) (t> − t) fℓ(cid:18) t∗

dt′ fℓ(cid:18) t′
τℓ (cid:19) =Z bt
τℓ(cid:19)
dt′ fℓ(cid:18) t′
τℓ (cid:19) =Z b(t>−t)
τℓ(cid:19) ,

t>−t

β(t)

t

then, the remainder can be written as

τℓ(cid:19)(cid:21) + (t> − t)(cid:20)fℓ(cid:18) t∗
τℓ(cid:19)(cid:12)(cid:12)(cid:12)(cid:12) + (t> − t)(cid:12)(cid:12)(cid:12)(cid:12)fℓ(cid:18) t∗

t∗
β(t) − (t> − t)

τℓ

β(t)

β(t)

τℓ (cid:19) − fℓ(cid:18) t> − t
τℓ (cid:19)(cid:21)(cid:27) .
τℓ (cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:27)
τℓ (cid:19) − fℓ(cid:18) t> − t
(cid:12)(cid:12)(cid:12)(cid:12)(cid:27)

dt {t |bt − t| + (t> − t) |b(t> − t) − (t> − t)|}

By the Lipschitz condition, we have that

0

0

dt (cid:26)t(cid:20)fℓ(cid:18) t∗
Rℓ(t<, t>; b) =Z t<
dt (cid:26)t(cid:12)(cid:12)(cid:12)(cid:12)fℓ(cid:18) t∗
Rℓ(t<, t>; b) ≤Z t<
dt (cid:26)t Cℓ (cid:12)(cid:12)(cid:12)(cid:12)
<Z t<
τℓ Z t<
(b − 1)Z t<
(b − 1)(cid:18) 2

0
Cℓ

t3

<

<

<

3

0

0

<

t3
>

Cℓ
τℓ

(b − 1) ,

Cℓ
τℓ
Cℓ
τℓ
2
3

α(t)

τℓ (cid:19) − fℓ(cid:18) t

τℓ

α(t)

t∗
α(t) − t

τℓ (cid:19) − fℓ(cid:18) t
(cid:12)(cid:12)(cid:12)(cid:12) + (t> − t) Cℓ (cid:12)(cid:12)(cid:12)(cid:12)
dt (cid:2)t2 + (t> − t)2(cid:3)
< + t<t> (t> − t<)(cid:19)

where Cℓ is a suitable positive real constant. Using Eqs. (A32) and (A35) in Eq. (A30) we have

0

0 <Z t<
0 <Z t<
0 <Z t<

dt (b − 1)(cid:26)t fℓ(cid:18) t
dt t fℓ(cid:18) t
τℓ(cid:19) +Z t>
dt t fℓ(cid:18) t
τℓ(cid:19) +Z t>

τℓ(cid:19) + (t> − t) fℓ(cid:18) t> − t
dt t fℓ(cid:18) t
dt t fℓ(cid:18) t

τℓ(cid:19) + Rℓ(t<, t>; b)
dt t fℓ(cid:18) t
τℓ(cid:19) −Z t>−t<

t>−t<

0

0

0

τℓ (cid:19)(cid:27) + (b − 1) Rℓ(t<, t>; b)

τℓ(cid:19) + Rℓ(t<, t>; b)

0 < Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<) +

where

0
Cℓ
τℓ

2
3

t3
>

(b − 1) ,

Fℓ(t) =Z t

0

τℓ(cid:19) ,
dt′ t′ fℓ(cid:18) t′

(A33)

(A34)

(A35)

(A36)

(A37)

(A38)

(A39)

(A40)

(A41)

(A42)

(A43)

(A44)

(A45)

(A46)

is a continuous and diﬀerentiable function of t. The inequality (A45) holds for any b > 1. Suppose that Fℓ(t<) +
Fℓ(t>) − Fℓ(t> − t<) < 0. Then, if b is such that

b = 1 +

3
2L

τℓ
> Cℓ |Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<)| ,
t3

where L > 2, we have that

0 < Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<) +
0 <

L − 1

[Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<)]

L

1
L |Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<)|

in contradiction with the hypothesis that Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<) is negative. Then

J. P. Neirotti, D. L. Freeman. and J. D. Doll

(A47)

(A48)

(A49)

15

Let us deﬁne the function

0 ≤ Fℓ(t<) + Fℓ(t>) − Fℓ(t> − t<) .

∆Fℓ(t) = Fℓ(t) − Fℓ(t> − t) ,

where t ∈ (0, t>). The right derivative at t = 0 of ∆Fℓ(t) is

lim

∆t→0+

∆Fℓ(∆t) − ∆Fℓ(0)

∆t

= lim

∆t→0+

= lim

∆t→0+

= lim

∆t→0+

∆t

Fℓ(∆t) − Fℓ(0) + Fℓ(t>) − Fℓ(t> − ∆t)

1

∆t(Z ∆t
∆t(cid:26)∆t t∗

dt t fℓ(cid:18) t
1fℓ(cid:18) t∗

τℓ(cid:19) +Z t>
τℓ(cid:19) + ∆t t∗

τℓ(cid:19))
dt t fℓ(cid:18) t
2fℓ(cid:18) t∗
τℓ(cid:19)(cid:27)

t>−∆t

1

0

1

2

(A50)

(A51)

(A52)

(A53)

(A54)

where t∗

1 ∈ [0, ∆t] and t∗

2 ∈ [t> − ∆t, t>]. Thus

∂∆Fℓ(t)

∂t

(cid:12)(cid:12)(cid:12)(cid:12)t→0+

τℓ(cid:19) .
= t> fℓ(cid:18) t>

(A55)

If the right derivative at 0 of ∆Fℓ(t) is negative, ∆Fℓ(t)
approaches −Fℓ(t>) from below, when t → 0. There exists
a time 0 < ˜t < t>, such that 0 > Fℓ(t>) + ∆Fℓ(˜t), in con-
tradiction with Eq. (A50). Then, fℓ must be non-negative
for t ∈ (0, t>). By the property Eq. (19) fℓ(0) must be
positive. This proves that ∆nd , 1(t, t′; b) < ∆d(t, t′; b) ⇒
fℓ(t) ≥ 0 for 0 ≤ t < t>. To demonstrate that if fℓ is pos-
itive yields ∆nd , 1(t, t′; b) < ∆d(t, t′; b) (i.e. the converse),
follow the argument backwards, from Eq. (A30). ✷

In conclusion, if the memory functions are positive, sat-
isfy the Lipschitz condition, and satisfy the condition Eqs.
(A8) and (A9), the non-diﬀusive contributions are more
weakly dependent on time than 1/t.

The results of the present appendix are valid in the limit
of a complete ensemble.
In our numerical experiments
only partial samples of the ensemble can be considered.
The memory functions that appear in our numerical cal-
culations come from partial mean values of the product of

discontinuous functions (every noise process is a discon-
tinuous function). These memory functions are discon-
tinuous. The behavior of the non-diﬀusive contributions
observed in our numerical experiments is in agreement
with these analytic (inﬁnite ensemble limit) results. We
can infer that there might be a version of the theorem
applied to discontinuous memory functions, but we have
been unable to develop such a theorem.

APPENDIX B: CONSEQUENCES OF THE TIME

SCALE CHANGE IN THE NON-DIFFUSIVE

CONTRIBUTIONS

In this appendix we show the behavior of the func-
tion f1 when its correlation time is changed according to
τ1 → τb1 = τ1/b, with b ≫ 1; i.e. when the total simu-
lation time is scaled to exceed the correlation time of the
ﬁrst colored noise process.

We multiply the time variables by a number b, such that
τ1 ≪ bt> ≪ τ2. We have that the g1 process contributes
to the autocorrelation function with

1
b2tt′hG1(bt/τℓ) G1(bt′/τℓ)i =

=

1

b2tt′ Z bt<
btt′ Z t<

1

dt1Z bt>
1Z t>

dt′
2

dt′

0

0

0

0

dt2

1
τb1

1
τ1

f1(cid:18)|t1 − t2|
τ1 (cid:19)
f1(cid:18)|t′
τb1 (cid:19)

1 − t′
2|

(B1)

(B2)

where t′ = t/b and τb1 = τ1/b. We want to compute this contribution both within the neighborhood t1 = t2 as well as
outside such a region. To do so, we can split the integral in Eq. (B2) in three parts

where

16

I1 =

I2 =

I3 =

1

1
b2tt′hG1(bt/τℓ) G1(bt′/τℓ)i = I1 + I2 + I3
f1(cid:18) t1 − t2
τb1 (cid:19)
btt′ Z t<
f1(cid:18)|t1 − t2|
τb1 (cid:19)
btt′ Z t<
f1(cid:18) t2 − t1
τb1 (cid:19)
btt′ Z t<

dt1Z max(0,t1−ǫ/2)
dt1Z min(t>,t1+ǫ/2)
dt1Z t>

min(t>,t1+ǫ/2)

max(0,t1−ǫ/2)

1
τb1

1
τb1

1
τb1

dt2

dt2

dt2

1

1

0

0

0

0

(B3)

(B4)

(B5)

(B6)

The Approach to Ergodicity in Monte Carlo Simulations

with t< > ǫ > 0 (observe that the only integral involving t1 = t2 is I2). Consider I1. If t1 < ǫ/2 the inner integral is
zero. Therefore, t1 must be bigger than ǫ/2 and

I1 =

dt1Z t1−ǫ/2

0

dt2

1
τb1

f1(cid:18) t1 − t2
τb1 (cid:19) ,

1

ǫ/2

bt<t> Z t<
2(cid:17) f1(cid:18) btmin
f1(cid:18) btmin

1
τ1

ǫ

(B7)

(B8)

(B9)

(B10)

which, by virtue of the continuity of f1, can be bounded as follows

1

bt<t> Z t<

dt1

b

τ1 (cid:16)t1 −

(t< − ǫ/2)2

t<t>

ǫ/2
1
2

τ1 (cid:19) ≤ I1≤
τ1 (cid:19) ≤ I1≤

dt1

1

bt<t> Z t<

ǫ/2

1
2

(t< − ǫ/2)2

t<t>

ǫ

b

2(cid:17) f1(cid:18) btmax
τ1 (cid:19)
τ1 (cid:16)t1 −
f1(cid:18) btmax
τ1 (cid:19)

1
τ1

where tmax (tmin) is the time in the interval [ǫ/2, t<] at which the function f1 reaches its maximum (minimum) value.
Because f1 is continuous, there exists t∗

1 ∈ [tmin, tmax] at which

I1 =

1
2

(t< − ǫ/2)2

t<t>

1
τ1

f1(cid:18) bt∗
τ1(cid:19) .

1

Consider now I3. If t1 + ǫ/2 > t>, the inner integral is zero. Therefore, 0 < t1 < min(t<, t> − ǫ/2) and

I3 =

=

0

1

btt′ Z min(t<,t>−ǫ/2)
dt1Z t>
(cid:20)t> −

min(t<, t> − ǫ/2)

t<t>

t1+ǫ/2
ǫ
1
2 −
2

1
τb1

f1(cid:18) t2 − t1
τb1 (cid:19)
min(t<, t> − ǫ/2)(cid:21) 1

τ1

dt2

f1(cid:18) bt∗
τ1(cid:19) ,

3

where t∗
(minimum) value.

3 ∈ [tmin, tmax], and now tmax (tmin) is the time in [ǫ/2, t>] at which the function f1 reaches its maximum

f1 (|t1 − t2 | / τ

b1 ) / τ

b1 

  − ( ∋ 

/ 2 − t1)       0                         t1                      2t1         ∋ 

/ 2 + t1

Fig. 7: The area under the curve represents the ﬁrst integral in Eq. (B11). The darker piece is half of the integral in the interval

[−t1, t1], the lighter is half of the integral in [−ǫ/2, ǫ/2].

Let us consider now I2. First observe that for the integral in t1, if 0 ≤ t1 ≤ ǫ/2, max(0, t1 − ǫ/2) = 0 and

min(t>, t1 + ǫ/2) = t1 + ǫ/2. If ǫ/2 ≤ t1 ≤ t< then max(0, t1 − ǫ/2) = t1 − ǫ/2. Then

I2 =

1

bt<t> (Z ǫ/2

0

dt1Z t1+ǫ/2

0

dt2

1
τb1

f1(cid:18)|t1 − t2|

τb1 (cid:19) +Z t<

ǫ/2

dt1Z min(t>,t1+ǫ/2)

t1−ǫ/2

dt2

f1(cid:18)|t1 − t2|

τb1 (cid:19)) .

1
τb1

(B11)

17

J. P. Neirotti, D. L. Freeman. and J. D. Doll

The integral in t2 between 0 and t1 + ǫ/2 can be evaluated with the help of Fig. 7

Z t1+ǫ/2

0

dt2

1
τb1

f1(cid:18)|t1 − t2|

τb1 (cid:19) =

1

2 Z ǫ/2

−ǫ/2

dt

1
τb1

f1(cid:18) |t|

τb1(cid:19) +

1

2 Z t1

−t1

dt

1
τb1

f1(cid:18) |t|
τb1(cid:19) .

(B12)

The second integral in t1 can be separated in two parts; the ﬁrst for ǫ/2 ≤ t1 ≤ min(t<, t> − ǫ/2) and the second for

min(t<, t> − ǫ/2) ≤ t1 ≤ t<. If t> − t< < ǫ/2 the second term is zero. Then

dt1Z min(t>,t1+ǫ/2)
Z t<

t1−ǫ/2

ǫ/2

dt2

1
τb1

f1(cid:18)|t1 − t2|
Θ(cid:16) ǫ

τb1 (cid:19) =Z min(t<,t>−ǫ/2)
+ t< − t>(cid:17) Z t<

t>−ǫ/2

ǫ/2

2

dt1Z min(t>,t1+ǫ/2)

t1−ǫ/2

dt2

dt1Z min(t>,t1+ǫ/2)

t1−ǫ/2

dt2

1
τb1

1
τb1

f1(cid:18)|t1 − t2|
τb1 (cid:19) +
f1(cid:18)|t1 − t2|
τb1 (cid:19) ,

(B13)

where Θ is the step function. If t1 ≤ min(t<, t> − ǫ/2) then min(t>, t1 + ǫ/2) = t1 + ǫ/2. The last integral in t2 can be
rearranged in the same way as Eq. (B12). Then

dt2

ǫ/2

t1−ǫ/2

dt1Z min(t>,t1+ǫ/2)
Z t<
Θ(cid:16) ǫ

1
2

2

1
τb1

f1(cid:18)|t1 − t2|
+ t< − t>(cid:17) Z t<

t>−ǫ/2

τb1 (cid:19) =Z min(t<,t>−ǫ/2)

ǫ/2

dt1"Z ǫ/2

−ǫ/2

dt

1
τb1

dt

−ǫ/2

1
τb1

dt1Z ǫ/2
f1(cid:18) |t|
τb1(cid:19) +Z t>−t1

t1−t>

f1(cid:18) |t|

τb1(cid:19) +
τb1(cid:19)# ,
f1(cid:18) |t|

1
τb1

dt

(B14)

We can observe that the correlation time τb1 goes to zero when b is increased. The function (1/τ1) f1(bt/τ1) becomes
negligible outside a neighborhood of t = 0 [observe Eqs. (B9) and (B10)]. Equation (16) holds, then, if b is suﬃciently
large, (1/τb1) f1(t/τb1) can be considered a delta function. The integrals I1 and I3 become zero, and the integrals
involving t = 0 in the expression of I2 converge to one. I2 becomes

I2 =

1

bt<t> nmin(cid:16)t<, t> −

ǫ

2(cid:17) + Θ(cid:16) ǫ

2

which is a diﬀusive contribution to the autocorrelation
function. The autocorrelation function becomes then

κ(bt, bt′) =

Γ0 + Γ1

bt>

+

Γℓ
τℓ

ΛXℓ=2

fℓ(cid:18) t∗

bℓ(t>)

τbℓ (cid:19) .

(B16)

The same argument can be used when b is such that
τ2 ≪ bt> ≪ τ3. After such changes in the time scale, the
diﬀusion coeﬃcient Γ = Γ0 + Γ1 is enlarged, and the non-
diﬀusive contributions are reduced. There is an ultimate
scale change, such that τΛ ≪ bt>. Beyond this maximum
time scale the process can be considered diﬀusive.

[1] J. P. Valleau and S. G. Whittington, A guide to Monte
Carlo for Statistical Mechanics: 1 Highways, in Statisti-
cal Mechanics, Part A: Equilibrium Techniques, Modern
Theoretical Chemistry Series, Vol. 5, Chap. 4, B. Berne
Ed. (Plenum, New York, 1976).

[2] W. W. Wood and F. R. Parker, J. Chem. Phys. 27, 720

(1957).

[3] D. Thirumalai, R. D. Mountain, and T. R. Kirpatrick,

Phys. Rev. A 39, 3563 (1989).

+ t< − t>(cid:17)(cid:16) ǫ

2

+ t< − t>(cid:17)o =

1
bt>

,

(B15)

[4] R. G. Palmer, Adv. Phys. 31, 669 (1982).
[5] C. W. Gardiner, Handbook of Stochastic Methods for
Physics, Chemistry and the Natural Sciences (Springer-
Verlag. Berlin, Heidelberg, New York, Tokyo, 1983).

[6] D. L. Freeman and J. D. Doll, Annu. Rev. Phys. Chem.

47, 43 (1996).

[7] R. M. Lynden-Bell and D. J. Wales, J. Chem. Phys. 101,

1460 (1994).

[8] J. P. K. Doye, D. J. Wales, and M. A. Miller, J. Chem.

Phys. 109, 8143 (1998).

[9] R. D. Mountain and D. Thirumalai, J. Chem. Phys. 93,

6975 (1989).

[10] D. Thirumalai and R. D. Mountain, Phys. Rev. A 42,

4574 (1990).

[11] J. E. Straub and D. Thirumalai, Proc. Nat. Acad. Sci.

USA 90, 809 (1993).

[12] A. J. Lichtenberg and M. A. Lieberman, Regular and

Stochastic Motion (Springer-Verlag, New York, 1983).

[13] I. Andricioaei and J. E. Straub, J. Chem. Phys. 107, 9117

(1997).

[14] J. P. Neirotti, F. Calvo, D. L. Freeman and J. D. Doll, J.

Chem. Phys. 112, 10340 (2000).

[15] F. Calvo, J. P. Neirotti, D. L. Freeman and J. D. Doll, J.

Chem. Phys. 112, 10350 (2000).

[16] D. D. Frantz, D. L. Freeman, and J. D. Doll, J. Chem.

Phys. 93, 2769 (1990).

18

The Approach to Ergodicity in Monte Carlo Simulations

[17] E. Marinari and G. Parissi, Europhys. Lett. 19, 451

[23] J. P. Neirotti, D. L. Freeman, and J. D. Doll, J. Chem.

(1992).

[18] C. J. Geyer and E. A. Thompson, J. Am. Stat. Assoc. 90,

909 (1995).

Phys. 112, 3990 (2000).

[24] M. Spivak, Calculus (Publish or Perish, 3ed., 1994).
[25] R. S. Berry, T. L. Beck, H. L. Davis, and J. Jellinek, Adv.

[19] M. Falcioni and M. W. Deem, J. Chem. Phys. 110, 1754

Chem. Phys. 70B, 75 (1988).

(1999).

[20] N. Metropolis, A. W. Rosenbluth, M. N. Rosenbluth, A.
H. Teller, and E. Teller, J. Chem. Phys. 21, 1087 (1953).
[21] J. K. Lee, J. A. Barker, and F. F. Abraham, J. Chem.

Phys. 58, 3166 (1973).

[26] D. D. Frantz, J. Chem. Phys. 102, 3747 (1995).
[27] Assuming the tolerable error to be on the order of 1%, we
n/12 + O(ω4
n).
[28] A. N. Kolmogorov and S. V. Fomin, Introductory Real

set 0.01 ≃ |[cot(ωn/2) − 2/ωn]/(2/ωn)| = ω2
Then nmax = bK√12/20π.

[22] P. Labastie and R. L. Whetten, Phys. Rev. Lett. 65, 1567

Analysis (Dover, New York, 1970).

(1990).

J. P. Neirotti, D. L. Freeman. and J. D. Doll

19

