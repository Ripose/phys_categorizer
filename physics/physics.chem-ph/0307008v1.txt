3
0
0
2
 
l
u
J
 
2
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
8
0
0
7
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

Thermodynamics in Density-Functional Theory
and Force Theorems

Junzo Chihara1,∗) and Mitsuru Yamagiwa2

1Research Organization for Information Science and Technology,
Tokai, Ibaraki 319-1106, Japan
2Advanced Photon Research Center, JAERI, Kizu, Kyoto 619-0215, Japan

The density-functional (DF) theory provides a simple method for calculating the proper-
ties of an interacting system under an external potential by associating it with a correspond-
ing non-interacting system. Here, we ﬁnd some relations in this non-interacting system,
which can enable us to set up the thermodynamical relations for a neutral electron-nucleus
mixture in terms of quantities of the non-interacting system and the exchange-correlation
eﬀect. In this way, Andersen’s force theorems are clearly described and easily proved in con-
junction with other types of force theorems, Janak’s theorem extended to a ﬁnite-temperature
system, pressure formulas and some thermodynamical relations. For this purpose, the ther-
modynamics in the DF theory is presented in a systematic and explicit way.

§1.

Introduction

The density-functional (DF) theory has been used with success to investigate
the equilibrium properties of solids and liquid metals in the almost cases when the
electrons can be treated as being in a perfectly degenerate state. Therefore, not
so much attention is paid to the thermodynamics in the DF theory, although the
DF theory is extended to be applicable to ﬁnite-temperature systems.1), 2) As a
consequence, we found some confusions in applications of the DF theory to condensed
matter, as shown by some examples below. Frequently,4), 5), 3) the pressure of a solid is
determined by the derivative of total electronic energy E0 with respect to the atomic
volume Ω (a uniform compression of the lattice): P = −dE0/dΩ. To be correct,
the volume derivative of electronic energy should be done under the ﬁxed nuclear
positions (ﬁxed lattice) for obtaining the ‘electron’ pressure, as shown in the present
work. For a next example, the proofs of a generalized Janak’s theorem to a ﬁnite-
temperature and the familiar Fermi distribution law are inappropriately proceeded,6)
since the thermodynamic relations in the DF theory are not recognized clearly. The
last example is the entropy expression1), 7) in the DF theory, the derivation of which
is not transparent. In this situation, it is useful to write up the thermodynamics
in the DF theory applied to a neutral electron-nucleus mixture in the explicit and
systematic form.

Andersen8) has derived force theorems8), 9), 10), 3) associating a certain change in
the sum of eigenvalues determined by the DF theory due to the volume change
or atomic displacements with the pressure or the forces, respectively. However, the
expression of force theorems is ambiguous and not deﬁnite to be used for calculations
of the pressure and the forces. In addition, their proofs8), 9), 10) are only given on the

∗) E-mail: chihara@ndc.tokai.jaeri.go.jp

2

J. Chihara and M. Yamagiwa

basis of the physical picture such as Heine10) has done even though in long four pages.
Furthermore, the force theorems are proved only at zero temperature and in the
local-density approximation (LDA). Contrary to this situation, the thermodynamics
in the DF theory is shown to provide clear representations of the force theorems
extended for a ﬁnite-temperature system without use of the LDA, in conjunction
with their simple proofs in the present work.

§2. Thermodynamics of inhomogeneous system
under the external potential U (r)

In this section, we sketch a brief outline of the thermodynamics of the inhomoge-
neous system for the purpose to set up the thermodynamics in the DF theory. When
the thermodynamic potential Ω of an inhomogeneous system under the external po-
tential U (r) is given, the density distribution n(r) is determined by the functional
derivative of Ω with respect to γ(r) ≡ µ − U (r):11)

δΩ
δγ(r)

= −

δΩ
δU (r)

T V

(cid:12)
(cid:12)
(cid:12)
(cid:12)

T V µ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= −n(r) ,

(2.1)

at temperature T of the system with a volume V and chemical potential µ. Therefore,
the natural variables of the thermodynamic potential Ω for this inhomogeneous
system are T , V , γ(r) or T , V , µ and U (r), and the change in Ω associated with
any inﬁnitesimal variation in these natural variables is expressed by

dΩ = −SdT − P dV −

n(r)δγ(r)dr

= −SdT − P dV − N dµ +

n(r)δU (r)dr .

Z

Z

The relation (2.1) enables us to replace an independent variable γ(r) by n(r) with
use of the Legendre transformation of Ω, which introduces the intrinsic free energy
˜F :

˜F ≡ Ω −

δΩ
δγ(r)

Z

T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

γ(r)dr = Ω +

n(r)γ(r)dr .

(2.4)

Z

Now, the natural variables of ˜F become T , V , n(r), or T , V , N , σ(r), and the
variation is given by

d ˜F = −SdT − P dV +

γ(r)δn(r)dr

= −SdT − P dV +

µ −

U (r)σ(r)dr

dN − N

U (r)δσ(r)dr .

Z

(cid:21)

Z

Z

(cid:20)

Here, σ(r) is the shape factor deﬁned by the relation n(r) ≡ N σ(r).12)

In a similar manner, the free energy F , the internal energy E, the intrinsic in-
ternal energy ˜E and the intrinsic thermodynamic potential ˜Ω for the inhomogeneous

(2.2)

(2.3)

(2.5)

(2.6)

Thermodynamics in Density-Functional Theory

3

Table I. State functions and their changes with respect to inﬁnitesimal variations in the natural

variables.

state function

natural variables

thermodynamic potential Ω

T, V, γ(r) or T, V, µ, U (r)

dΩ = −SdT − P dV −

n(r)δγ(r)dr

= −SdT − P dV − N dµ +

n(r)δU (r)dr

R

intrinsic thermodynamic potential ˜Ω T, V, µ, n(r)
R
d ˜Ω = −SdT − P dV − N dµ −

U (r)δn(r)dr

R

T, V, N, U (r)

n(r)δU (r)dr

free energy F

dF = −SdT − P dV + µdN +
intrinsic free energy ˜F
d ˜F = −SdT − P dV +
= −SdT −P dV + [ µ−

R
γ(r)δn(r)dr

U (r)σ(r)dr ]dN −N
R

U (r)δσ(r)dr

internal energy E

R

S, V, N, U (r)

R

T, V, n(r) or T, V, N, σ(r)

n(r)δU (r)dr

dE = T dS − P dV + µdN +
intrinsic internal energy ˜E
d ˜E = T dS − P dV +
= T dS −P dV + [ µ−
R

R
γ(r)δn(r)dr

R

R

U (r)σ(r)dr ]dN −N

U (r)δσ(r)dr

S, V, n(r) or S, V, N, σ(r)

(A1)

(A2)

(B)

(C)

(D1)

(D2)

(E)

(F1)

(F2)

system are introduced by means of the following Legendre transforms:

(2.7)

(2.8)

(2.9)

F ≡ Ω − µ

= Ω + µN ,

E = F − T

= F + T S ,

˜E = ˜F − T

= ˜F + T S ,

∂Ω
∂µ

V N U (r)

∂F
∂T

T V U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
∂ ˜F
(cid:12)
(cid:12)
∂T (cid:12)
(cid:12)
(cid:12)
δΩ
(cid:12)
(cid:12)
δU (r)

V n(r)

T V µ

(cid:12)
(cid:12)
(cid:12)
(cid:12)

˜Ω = Ω −

Z

U (r)dr = Ω −

n(r)U (r)dr ,

(2.10)

Z

of Ω, F , ˜F and Ω, respectively. Note that ‘intrinsic’ thermodynamical quantities ˜Q
(such as ˜E, ˜F and ˜Ω) are related to the usual quantities Q by the relation:

Q = ˜Q +

U (r)n(r)dr .

(2.11)

Z

Changes of these thermodynamic quantities associated with inﬁnitesimal variations
in the natural variables are summarized in Table. I with additional new relations.

4

J. Chihara and M. Yamagiwa

Equations (2.2), (2.3), (C) and (E) of Table. I lead to formulas to determine the

density distribution n(r) in several ways as

n(r) = −

δΩ
δγ(r)

=

δΩ
δU (r)

=

δF
δU (r)

T V µ

=

δE
δU (r)

(2.12)

Inversely, the external potential U (r) is determined as

T V N
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV N
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= µ − U (r) ,

(2.13)

by using the relations, (D1) and (F1) of Table I. Similarly, the chemical potential µ
and the pressure P of the inhomogeneous system are calculated by the formulas

µ =

∂F
∂N

=

∂E
∂N

T V U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

and

=

δE
δn(r)

T V U (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

δ ˜F
δn(r) (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T V

δ ˜E
δn(r) (cid:12)
SV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

δF
δn(r)

.

,

P = −

∂F
∂V

= −

∂E
∂V

= −

= −

= −

T N U (r)
(cid:12)
(cid:12)
∂ ˜F
(cid:12)
(cid:12)
∂V (cid:12)
T n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SN U (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Sn(r)

∂ ˜E
∂V (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= −

∂Ω
∂V

T γ(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

∂ ˜Ω
∂V (cid:12)
Sµn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Also, the equilibrium density distribution n(r) satisﬁes the following condition:

δΩ
δn(r)

=

δF
δn(r)

=

δE
δn(r)

T V µU (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
§3. DF theory of electrons under the external potential
caused by the ﬁxed nuclei

T V N U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV N U (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

= 0 .

(2.17)

Let us consider an electron-nucleus mixture consisting of Nn nuclei and N = ZNn
electrons with an atomic number Z. When the nuclei behave as classical particles,
the nuclei are considered as generating the external potential U (r) for the electrons to
form an inhomogeneous electron system:13) this external potential for the electrons
is the Coulomb potential produced by the nuclei ﬁxed at the coordinates Rα:

U (r) = −

Ze2
|r − Rα|

.

α
X
In treating this inhomogeneous system, an eﬀective external potential Ueﬀ (r) can be
deﬁned so as to satisfy the condition that the true electron density n(r|U ) under the
external potential U (r) should be identical with the non-interacting electron density
distribution n0(r|Ueﬀ ) under the external potential Ueﬀ (r):

n0(r|Ueﬀ ) ≡ n(r|U ) .

(2.14)

(2.15)

(2.16)

(3.1)

(3.2)

5

(3.3)

Thermodynamics in Density-Functional Theory

Here, the non-interacting electron density distribution n0(r|Ueﬀ ) is determined as

n0(r|Ueﬀ ) ≡

fi|φi(r)|2 ,

Xi
in terms of the wave function φi(r) and eigenvalues ǫi, which obey the wave equation
for a single electron:

−~2
2m

∇2 + Ueﬀ (r)
(cid:21)
and the Fermi distribution fi = 1/{exp[β(ǫi−µ0)+1} with the chemical potential µ0
of a non-interacting electron gas.

φi(r) = ǫiφi(r) ,

(3.4)

(cid:20)

For the purpose to obtain an explicit expression for the external potential Ueﬀ (r),
let us note the relation for intrinsic free energy of non-interacting electrons Fs(≡ ˜Fs):

δFs
δn0(r)

=

δFs
δn(r)

= µ0 − Ueﬀ (r) ≡ γeﬀ (r) ,

(3.5)

T V
(cid:12)
(cid:12)
which is (2.13) rewritten for the non-interacting system. Here, the intrinsic free
(cid:12)
(cid:12)
energy Fs[n0] of the non-interacting system is written in an explicit form:

T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
β

∞

Xi=1

Fs[n0] = −

ln{1 + exp[β(µ0 − ǫi)]} −

n0(r)Ueﬀ (r)dr + µ0N

(3.6)

= Ts[n0] − T Ss[n0] ,

(3.7)
where Ts and Ss are the intrinsic internal energy ˜Es and the entropy of the non-
interacting system, respectively, deﬁned by

Z

Ts[n0] ≡ ˜Es = Es −

n0(r)Ueﬀ (r)dr

=

fi

Xi
Ss[n0] ≡ −kB

Z

Z
φ∗
i (r)

−~2
2m

∇2φi(r)dr ,

[fi ln fi + (1 − fi) ln(1 − fi)]

Xi
i fiǫi. On use of the relation:

with the internal energy Es =

δ ˜F
P
δn(r) (cid:12)
(cid:12)
(cid:12)
the eﬀective external potential Ueﬀ (r) is represented explicitly as
(cid:12)
(cid:12)

= µ − U (r) ≡ γ(r) ,

T V

with FI ≡ ˜F − ˜Fs and µI ≡ µ − µ0, which is derived by subtracting (3.5) from (3.11).
Equation (3.12) is the eﬀective external potential in the framework of the DF theory.
At this point, we introduce the exchange-correlation free energy by

Ueﬀ (r) = U (r) +

− µI

δFI
δn(r)

T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Fxc ≡ FI − ˜Ees ,

(3.8)

(3.9)

(3.10)

(3.11)

(3.12)

(3.13)

6

J. Chihara and M. Yamagiwa

in terms of the intrinsic electrostatic energy ˜Ees, a part of the electrostatic energy
Ees[n] described as

Ees[n] ≡

e2
2

Z

n(r)n(r′)
|r − r′|

drdr′ +

1
2

N

Z 2e2
|Rα − Rβ|

−

Ze2n(r)
|r − Rℓ|

dr

Xℓ=1Z

≡ Eee + Enn + Een ≡ ˜Ees +

n(r)U (r)dr .

Xα6=β

Z

Then, we can write the intrinsic free energy ˜F in the form:

˜F = Fs + FI = Fs + Fxc + ˜Ees ,

within the framework of the DF theory.

With use of the Legendre transformations of ˜F , we obtain the thermodynamic

potential in the form:

Ω = ˜F −

δ ˜F
δn(r) (cid:12)
T V
(cid:12)
(cid:12)
= Ωs + Ωxc + Ωes ,
(cid:12)
(cid:12)

Z

n(r)dr = F − µN

where

Ωs =

ln(1 − fi) = −

ln{1 + exp[β(µ0 − ǫi)]} ,

1
β

Xi
Ωxc = Fxc −

Ωes = ˜Ees −

∞

1
β

Xi=1
n(r)dr ,

n(r)dr = Enn − Eee ,

(3.14)

(3.15)

(3.16)

(3.17)

(3.18)

(3.19)

(3.20)

(3.21)

and the intrinsic internal energy ˜E in the form:

˜E = ˜F − T

= Ts[n] + Exc[n] + ˜Ees

(3.22)

with the exchange-correlation part of the internal energy deﬁned by

Exc[n] ≡ Fxc − T

(3.23)

∂Fxc
∂T

.

V n(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

From the above expressions for the intrinsic quantities, ˜E and ˜F , the relation (2.11)
provides the internal energy E:

E = ˜E +

n(r)U (r)dr = Ts + Exc + Ees ,

(3.24)

Z

Z

Z

δFxc
δn(r)
T V
(cid:12)
(cid:12)
δ ˜Ees
(cid:12)
(cid:12)
δn(r) (cid:12)
T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂ ˜F
∂T (cid:12)
V n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Thermodynamics in Density-Functional Theory

7

and the free energy F :

F = ˜F +

n(r)U (r)dr = E − T S

Z

= Fs + Fxc + Ees = Ts − T Ss + Fxc + Ees

(3.25)

(3.26)

with the deﬁnition of the entropy1), 7)

S ≡ −

∂F
∂T

∂ ˜F
∂T (cid:12)
V n(r)
(cid:12)
(cid:12)
(cid:12)
Equation (3.27) is obtained from Eq. (3.16) and the relation: ∂ ˜Ees/∂T |V n(r) = 0; this
(cid:12)
derivation is diﬀerent from those of the references,1), 7) which are in a roundabout
way.

V N U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂Fxc
∂T

= Ss −

(3.27)

V n(r)

= −

(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

(3.28)

(3.29)

By use of the relation

δExc[n]
δn(r)
we can express the eﬀective external potential (3.12) as

δFxc[n]
δn(r)

µxc(r|n) ≡

=

T V

,

SV

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Ueﬀ (r) =

+ µxc(r|n) − µI .

δEes
δn(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Thus, the eﬀective external potential is rewritten in simple forms:

Ueﬀ (r) =

δ[Ees + Fxc]
δn(r)

− µI =

δ[Ees + Exc]
δn(r)

− µI ,

(3.30)

where we make a convention that the derivative δEes/δn(r) is performed with the
external potential U (r) (that is, the nuclear coordinates {Rα}) being ﬁxed.

T V U (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

§4. Thermodynamics of an ideal gas under the external potential Ueﬀ (r)

As shown in the previous section, the DF theory reduces the many-electron
problem under the external potential to the one-electron problem by associating an
interacting system to a non-interacting system (an ideal gas under the eﬀective exter-
nal potential). As a consequence of this association, the thermodynamical properties
of an interacting system are described in terms of those of the ideal gas under the
eﬀective external potential. For this purpose, we enumerate here some important
properties of an ideal Fermi gas.

The change of the intrinsic internal energy ˜Es = Ts[n] of the non-interacting

system is given by

d ˜Es = T dSs − P0dV +

γeﬀ (r)δn(r)dr = dTs[n] ,

(4.1)

while the change of the intrinsic free energy ˜Fs ≡ Fs is

d ˜Fs = −SsdT − P0dV +

γeﬀ (r)δn(r)dr = dFs[n] .

(4.2)

Z

Z

8

J. Chihara and M. Yamagiwa

Therefore, from the above equations, the external potential γeﬀ (r) = µ0 − Ueﬀ (r) is
obtained by the functional derivatives in the two ways:

δFs[n]
δn(r)

=

δTs[n]
δn(r)

T V
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SsV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= µ0 − Ueﬀ (r) ≡ γeﬀ (r) ,

(4.3)

which leads to (3.28) with aids of (2.13). Also, the pressure P0 is derived from (4.1)
and (4.2) as

(4.4)

(4.5)

(4.6)

(4.7)

3P0V = −3V

∂Ts[n]
∂V

∂Fs[n]
∂V

= −3V

Ssn(r)
(cid:12)
(cid:12)
(cid:12)
n(r)r · ∇Ueﬀ(r)dr
(cid:12)

T n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= 2Ts[n] −

Z
r · P0
K · dS ,

=

I∂V

where the kinetic pressure tensor P0

K is deﬁned by14)

∇ · P0

K = −n(r)∇Ueﬀ (r) .

The above result is derived as follows. First, with use of the scaled density nλ(r) ≡
λ3n(λr),15) the kinetic energy functional is shown to satisfy the relation: Ts[nλ] =
λ2Ts[n], which yields

−3V

∂Ts[n]
∂V

= λ

dTs[nλ]
dλ

= 2Ts[n] .

(4.8)

Next, we note that the volume derivative of Ts at the ﬁxed Ss, N, Ueﬀ is expressed
by a sum of the volume derivatives of Ts at the ﬁx n(r) and via the change in n(r):

=

∂Ts[n]
∂V

SsN Ueﬀ (r)

δTs[n]
δn(r)

+

Z

dn(r)
dV

dr ,

(4.9)

(see Appendix). Here, the ﬁrst term in the right side of (4.9) is expressed as

∂Ts[n]
∂V

(cid:12)
(cid:12)
(cid:12)
(cid:12)

SsN Ueﬀ (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Ssn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

λ=1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SsV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

−3V

∂Ts[n]
∂V

= 2Ts[n] +

n(r)r · ∇

dr ,

(4.10)

SsN Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

δTs[n]
δn(r)

SsV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

f (r)nλ(r)dr
(cid:12)
(cid:12)
(cid:12)
(cid:12)
n(r)r · ∇f (r)dr ,
(cid:12)

λ=1

ZV

Z

d
dλ

ZV /λ3

− 3V

f (r)

dr = λ

Ssn(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

dn(r)
dV

Z

= λ

d
dλ

ZV

f (r/λ)n(r)dr = −

(4.11)

with help of (4.8) and the following equation:16)

which is applied to the second term in the right side of (4.9). Finally, as a consequence
of (4.10) and (4.3), we obtain (4.5), which may be written in the surface integral

Thermodynamics in Density-Functional Theory

9

(4.6) over the surface ∂V of the system.14)
kinetic energy of a non-interacting electron gas is written as

It is important to recognize that the

2Ts[n] =

n(r)r · ∇Ueﬀ (r)dr +

r · P0

K · dS =

trP0

Kdr ,

(4.12)

ZV

I∂V

ZV

which yields the surface-integral expression (4.6). The surface integral term is omit-
ted in the standard treatment,17), 18), 7) which yields erroneous results if we treat a sys-
tem with the non-zero electron pressure by using (4.12) without the surface integral
term. For example, Slater17) derived the virial theorem, 2(kinetic energy)+(potential
α Rα∇αE, which is valid only for a solid with the zero electron-
energy)= −
pressure, as will be shown afterward by (6.8) and (6.10).
When we diﬀerentiate the internal energy Es =

i fiǫi in a simple manner, we

P

ﬁnd

fiǫi = ǫi + fi

P
.

dǫi
dfi

d
dfi

Xi

(4.13)

(4.14)

(4.15)

(4.16)

(4.17)

It is important to see the reason why the second term is discarded to yield ǫi in the
circumstance that fi is a function of ǫi. As is seen later, this reasoning provides a
clue to relating the thermodynamics in the DF theory to the usual thermodynamics.
First, we consider the derivative of Es with respect to an arbitrary parameter λ by
noting the relation, Es =
i fiǫi = Ωs + T Ss + µ0N . Because of ∂Ωs/∂T |V µ0Ueﬀ =
−Ss, we get the following relation:

d
dλ

[Ωs + T Ss] =

P

=

dΩs
dλ

dΩs
dλ

T
(cid:12)
(cid:12)
(cid:12)
(cid:12)
T
(cid:12)
(cid:12)
(cid:12)
(cid:12)

+ Ss

dT
dλ

#

+ T

dSs
dλ

+

"

+ T

∂Ωs
∂T

dSs
dλ

V µ0Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)
,

where the ﬁrst term of (4.15) is put in the form

dΩs
dλ

∂Ωs
∂µ0 (cid:12)
(cid:12)
(cid:12)
Thus, from (4.15) and (4.16) we obtain a simple expression (see Appendix)
(cid:12)

T µ0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T µ0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dΩs
dλ

dΩs
dλ

dµ0
dλ

dµ0
dλ

T
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T V Ueﬀ

− N

=

=

+

.

If we take as λ = fi, the above equation takes the form

dEs
dλ

=

dΩs
dλ

+ T

+ µ0

dSs
dλ

dN
dλ

.

T µ0

(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

∂Ωs
∂fi (cid:12)
(cid:12)
(cid:12)
which is consistent only with the following three equations:
(cid:12)

∂Ωs
∂fi (cid:12)
(cid:12)
(cid:12)
(cid:12)

dEs
dfi (cid:12)
(cid:12)
(cid:12)
(cid:12)

fi
1 − fi

+ µ0 =

T V µ0Ueﬀ

V Ueﬀ

1
β

ln

−

T V µ0Ueﬀ

+ ǫi ,

(4.18)

fi = f (ǫi − µ0) ≡

1
exp[β(ǫi − µ0)] + 1

,

(4.19)

10

J. Chihara and M. Yamagiwa

(4.20)

(4.21)

(4.22)

= ǫi ,

fiǫi

Xi

d
dfi "
∂Ωs
∂fi (cid:12)
T V µ0Ueﬀ
(cid:12)
(cid:12)
(cid:12)

#(cid:12)
V Ueﬀ
(cid:12)
(cid:12)
(cid:12)
= 0 .
(cid:12)

By taking account of this situation (4.17), we set up a formula to perform a
derivative of intrinsic free energy ˜Es = Ts[n] by λ, which is not contained in Ueﬀ , in
the form:

dTs
dλ

=

dΩs
dλ

+ T

+

[µ0 − Ueﬀ (r)]

dSs
dλ

Z

dn(r)
dλ

dr .

T µ0Ueﬀ

(cid:12)
(cid:12)
(cid:12)
(cid:12)

This equation plays an important role to associate the DF theory with the thermo-
dynamics of an inhomogeneous electron system caused by the external potential of
the ﬁxed nuclei. The proof of this equation is shown as follows. The kinetic energy
functional Ts is written in the form

Ts = Es −

n(r)Ueﬀ (r)dr = Ωs + T Ss +

n(r)γeﬀ (r)dr ,

(4.23)

and Eq. (4.15) is written as

Z

Z

d
dλ

[Ωs + T Ss] =

dΩs
dλ

+ T

dSs
dλ

=

fi

d[ǫi −µ0]
dλ

+

dfi
dλ

[ǫi−µ0] .

(4.24)

Xi

Xi

Here, the second term of (4.24) is written as

dΩs
dλ

=

=

T
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dΩs
dλ

dΩs
dλ

δΩs
δγeﬀ (r)

δγeﬀ (r)
δn(r′)

dn(r′)
dλ

drdr′

T V
(cid:12)
(cid:12)
δγeﬀ (r)
(cid:12)
(cid:12)
δn(r′)

dn(r′)
dλ

drdr′ .

n(r)

Z

(4.25)

(4.26)

Also, the third term of the right side of (4.23) generates

d
dλ

Z

n(r)γeﬀ (r)dr =

γeﬀ (r)

dr +

n(r)

dn(r)
dλ

Z

Z

δγeﬀ (r)
δn(r′)

dn(r′)
dλ

drdr′ .

(4.27)

In ﬁnal, a cancellation between the second terms in the right side of (4.26) and (4.27)
results in (4.22).

T
(cid:12)
(cid:12)
(cid:12)
(cid:12)

+

Z

−

T γeﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)
T µ0Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

§5. Force theorems

In this section, we derive three types of Andersen’s force theorems on the basis
of (4.22) and (5.16). The ﬁrst type is a force theorem concerning the pressure. The
pressure of a inhomogeneous electron system under the external potential caused by
the ﬁxed nuclei at {Rα} is deﬁned by (2.15), and can be calculated by introducing
the scaled electron density distribution nλ(r) ≡ λ3n(λr) in the following form:

3PeV = −3V

∂EV [n; {Rα}]
∂V

= λ

dEλ
dλ

SN {Rα}

(cid:12)
(cid:12)
(cid:12)
(cid:12)

,

λ=1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(5.1)

Thermodynamics in Density-Functional Theory

11

with

With aids of (4.22), we get 16)

Eλ ≡ EV /λ3

[nλ; {Rα}] = T V /λ3

s

[nλ] + EV /λ3

es

[nλ; {Rα}] + EV /λ3

xc

[nλ] .

(5.2)

dTs
dλ

=

=

SsN Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dΩs
dλ

Xi

T µ0Ueﬀ
(cid:12)
(cid:12)
dǫi
(cid:12)
fi
(cid:12)
dλ

Ueﬀ

(cid:12)
(cid:12)
(cid:12)
(cid:12)

+

d
dλ

+

ZV

nλ(r)[µ0 − Ueﬀ (r)]dr

ZV /λ3
n(r)r · ∇Ueﬀ (r)dr .

Since the electrostatic energy (3.15) satisﬁes the following relation

EV /λ3
es

[nλ; {Rα}] = λEV

es[n; {λRα}] ,

the λ-derivative of the electrostatic energy14) becomes

dEV /λ3
es
dλ

λ

[nλ]

(cid:12)
λ=1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= Ees −

Rα ·Fα = −

n(r)r · ∇

X

ZV

δEes
δn(r)

dr ,

where the force on α-nucleus is given by Fα ≡ −∇αEes . Also, the exchange-
correlation energy part14) of (5.2) yields

dEV /λ3
xc
dλ

λ

[nλ]

=

trPxcdr = −

n(r)r · ∇

dr +

r · Pxc · dS ,

(5.7)

δExc
δn(r)

I∂V
where the exchange-correlation pressure tensor Pxc is deﬁned by

ZV

ZV

(cid:12)
λ=1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∇ · Pxc ≡ n(r)∇

δFxc
δn(r)

= n(r)∇

.

δExc
δn(r)

(5.8)

T V
(cid:12)
(cid:12)
Because of (3.30), the sum of the second term in (5.4), the last term of (5.6) and
(cid:12)
(cid:12)
the ﬁrst term in the right side of (5.7) becomes zero owing to (3.30); as a result, a
pressure formula (the force theorem concerning the electron pressure3)) is written as

(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV

3PeV = −3V

+

r · Pxc · dS ,

(5.9)

in terms of eigenvalues ǫi of the Kohn-Sham equation (3.4).

Another important relation is derived by noting the relation15)

fi

dǫi
dV

Xi

I∂V

Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T V /λ3
s

[nλ] = λ2T V

s [n] ,

which leads to

dTs
dλ

= 2Ts[n] =

SsN Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

Xi
Kdr =

trP0

ZV

fi

dǫi
dλ

I∂V

ZV

Ueﬀ
(cid:12)
(cid:12)
(cid:12)
r · P0
(cid:12)

ZV

+

n(r)r · ∇Ueﬀ (r)dr

K · dS +

n(r)r · ∇Ueﬀ (r)dr ,

(5.3)

(5.4)

(5.5)

(5.6)

(5.10)

(5.11)

(5.12)

12

J. Chihara and M. Yamagiwa

(5.14)

(5.15)

with combined use of (5.4). From the above equation, we relate the volume derivative
of eigenvalues ǫi to the surface integral of the pressure tensor P0 for a non-interacting
electron gas:

−3V

fi

dǫi
dV

Xi

=

I∂V

which alters a pressure formula (5.9) in the form

r · P0

K · dS = 3P0V ,

(5.13)

Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

I∂V

3PeV =

r · (P0

K + Pxc) · dS .

At this point, we remark that Eq. (5.13) is directly derived as the pressure of the
ideal gas from (4.6) and the thermodynamic relation:

3P0V = −3V

= −3V

∂Ωs
∂V

T µ0Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

fi

dǫi
dV

Xi

.

Ueﬀ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

The formula (4.22) to calculate the λ-derivative of Ts is valid only when the
parameter λ is not contained in the external potential Ueﬀ . When the parameter λ
is involved in the external potential Ueﬀ (for example, λ = Rα), the formula (4.22)
is changed in the form:

T µ0n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dTs
dλ

=

dΩs
dλ

+ T

+

γeﬀ (r)

dr −

n(r)

dSs
dλ

Z

dn(r)
dλ

Z

dUeﬀ (r)
dλ

dr ,

(5.16)

where the derivative of Ωs is performed under the ﬁxed density distribution n(r),
instead of the external potential Ueﬀ being ﬁxed as (4.22), and the last term of (5.16)
contains the direct variation of Ueﬀ . Actually, Eq. (5.16) is derived in a similar way
to get Eq. (4.22) with use of the fact that Ts = ˜Ωs + T Ss + µ0N and that the natural
variables of the intrinsic thermodynamic potential ˜Ωs are T, V, µ0 and n(r). When
the λ-derivative is performed under the ﬁxed Ss and V , Eq. (5.16) becomes

dTs
dλ

=

fi

dǫi
dλ

+

γeﬀ (r)

dr −

n(r)

dn(r)
dλ

dUeﬀ (r)
dλ

dr .

(5.17)

On the other hand, this derivative can be represented in another form:

n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

n(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Z

n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SsV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Xi

dTs
dλ

=

Z

SsV
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SsV

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Z

Z

owing to (4.3). By comparing (5.18) with (5.17), we obtain a formula to calculate
the force on the atoms in the form:

δTs[n]
δn(r)

dn(r)
dλ

dr =

γeﬀ (r)

dn(r)
dλ

dr ,

(5.18)

fi

dǫi
dλ

=

n(r)

dr .

dUeﬀ (r)
dλ

(5.19)

Xi
When λ = Rα, this equation assumes the form:

Z

n(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

fi

dǫi
dRα (cid:12)
(cid:12)
(cid:12)
(cid:12)

Xi

=

n(r)

n(r)

Z

∂
∂Rα

γ
X

−Ze2
|r − Rγ|

n(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Z

dr = −Ze2

n(r)

r − Rα
|r − Rα|3 dr .

(5.20)

Thermodynamics in Density-Functional Theory

13

Therefore, the force on α-atom is represented as

Fα = − ∇αEes|n(r)

(5.21)

(5.22)

(5.23)

j uj(r)cj
i ,

P

(5.24)

= Ze2

n(r)

r − Rα
|r − Rα|3 dr + (Ze)2

Rα − Rγ
|Rα − Rγ|3

= −

fi

Z

Xi

dǫi
dRα (cid:12)
(cid:12)
(cid:12)
(cid:12)

Xα6=γ
Rα − Rγ
|Rα − Rγ|3 .

+ (Ze)2

n(r)

Xα6=γ

If we expand the eigenfunction φi by using a local base set ui(r) as φi(r) =
the force is described by the matrix form as is given by

Xi
Xi
with Hij ≡ (ui| ˆH|uj) and Sij ≡ (ui|uj).19)

fi

dǫi
dRα (cid:12)
n(r)
(cid:12)
(cid:12)
(cid:12)

=

(Ci|

∂(H − ǫiS)
∂Rα

|Ci) ,

Next, we consider another type of force theorem,9), 10) when not only the nucleus
at Rα, but also the electronic charge within an arbitrary volume Ωα enclosing the
α-nucleus is displaced rigidly. Instead of displacing the volume Ωα, it is more conve-
nient to think in terms of the displacement of the rest system by −δRα. Therefore,
Eq. (5.19) assumes the form

fi

δǫi
δRα (cid:12)
n(r)
(cid:12)
(cid:12)
(cid:12)

Xi

=

n(r)

ZΩα

δ[Ueﬀ (r − δRα) − Ueﬀ (r)]
δRα

dr

= −

n(r)∇Ueﬀ (r)dr .

ZΩα
On the other hand, the Maxwell tensor TM obeys the following equation14)

−∇ · (P0

K + Pxc − TM) =

Fαδ(r − Rα) .

α
X

Thus, integral of (5.27) over the volume Ωα yields the force on α-nucleus in the form:

Fα = −

(P0

K + Pxc − TM) · dS

I∂Ωα

ZΩα

ZΩα

Xi

= −

∇ · (P0

K + Pxc)dr +

TM · dS

=

n(r)∇Ueﬀ (r)dr −

I∂Ωα
n(r)∇µxc(r)dr +

TM · dS

(5.30)

= −

fi

−

n(r)∇µxc(r)dr +

TM · dS ,

(5.31)

I∂Ωα

I∂Ωα

ZΩα

ZΩα

δǫi
δRα (cid:12)
n(r)
(cid:12)
(cid:12)
(cid:12)

where the force is described in terms of eigenvalues ǫi due to (5.26). Equation (5.31)
should be compared with (193) of the reference,8) where no exchange-correlation
contribution is contained and the electrostatic force is diﬀerently deﬁned.

(5.25)

(5.26)

(5.27)

(5.28)

(5.29)

14

J. Chihara and M. Yamagiwa

§6. Thermodynamical relations in DF theory

In previous section, we have proved Andersen’s force theorems on the basis of
(4.22) and (5.16). In this section, we show that these equations, (4.22) and (5.16),
provide several thermodynamical relations in the DF theory. First, we show that the
force Fα on α-nucleus in the system is described by the thermodynamic functions

Fα = −∇α E|SV N = −∇α F |T V N = −∇α Ω|T V µ .

(6.1)

For example, the relation, Fα = −∇α[Ts + Ees + Exc]|SV N , is proved by use of the
following equations:

∇α [Ees + Exc]|SV N = ∇α Ees|n(r) +

∇αn(r)dr ,

(6.2)

δ[Ees + Exc]
δn(r)

Z

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∇α Ts|SV N =

δTs
δn(r)

∇αn(r)dr = −

[Ueﬀ (r) + µI]∇αn(r)dr ,

(6.3)

SsV
(cid:12)
(cid:12)
which lead to Fα = −∇αEes|n(r) with help of (3.30).
(cid:12)
(cid:12)
important relation to cancel the term involving Ueﬀ in (4.22) and (5.16)

Z

Z

In the above, we used an

d[Ees + Exc]
dλ

=

d[Ees + Exc]
dλ

δ[Ees + Exc]
δn(r)

dn(r)
dλ

dr ,

(6.4)

+

Z

n(r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

which is derived by applying (A.2) to the internal energy ˜E = E−
U (r)n(r)dr with
the natural variables, S, V and n(r). At this point, it should be noticed that the
relation (6.3) is equivalent to the following equation

R

∇αΩs|T V µ0n(r) −

n(r) ∇αUeﬀ (r)|n(r)dr = ∇α ˜Ωs

T V µ0n(r)

Z
+ Ze2

n(r)

Z

n(r)

r − Rα
|r − Rα|3 dr = 0 ,

(cid:12)
(cid:12)
(cid:12)

=

fi

Xi

dǫi
dRα (cid:12)
(cid:12)
(cid:12)
(cid:12)

which results from (5.16). Therefore, the force expressions (6.1) are equivalent to
(6.6), that is, the force theorem (5.23). Similarly, other relations in (6.1) can be
proved with use of (5.16).

Equations (2.15) and (2.16) provide two diﬀerent but equivalent expressions for
the pressure as shown below. First equation (2.15) generates a pressure formula in
the form:

3PeV = −3V

= −3V

∂F
∂V

T N {Rα}
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= 2Ts[n] + Ees +

trPxcdr −

Rα ·Fα .

SN {Rα}

∂E
∂V

(cid:12)
(cid:12)
(cid:12)
(cid:12)
α
X

Z
Equation (6.8) is proved from (5.6) and (5.7) with additional use of (5.11). Here, it
should be kept in mind that the electron pressure is determined by the derivative

(6.5)

(6.6)

(6.7)

(6.8)

Thermodynamics in Density-Functional Theory

15

with the nuclear positions (that is, the external potential U (r)) being ﬁxed .
In
some pressure calculations,4), 5), 3) this ﬁxed-nuclei condition is neglected; as a result,
the nuclear virial term in (6.8) disappears in the pressure. On the other hand, the
second equation (2.16) leads to a pressure formula in the form:

= −3V

∂ ˜F
∂V (cid:12)
(cid:12)
(cid:12)
(cid:12)
K + Pxc) · dS .
r · (P0
(cid:12)

T n(r)

∂ ˜E
∂V (cid:12)
Sn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

3PeV = −3V

=

I∂V

(6.9)

(6.10)

This relation is derived below by noting that the intrinsic internal energy is written
as ˜E = Ts + ˜Ees + Exc. At a ﬁrst step, we get the exchange-correlation pressure in
the following way (see Appendix):

3V

∂Exc
∂V

SN {Rα}

(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

trPxcdr

Z

= 3V

= 3V

∂Exc
∂V

∂Exc
∂V

+ 3V

+

ZV

Sn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
Sn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

δExc
δn(r)

Z

(cid:12)
(cid:12)
(cid:12)
n(r)r · ∇
(cid:12)

dn(r)
dV

SV
δExc
δn(r)

SN {Rα}
(cid:12)
(cid:12)
(cid:12)
(cid:12)
SV

dr ,

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(6.11)

dr (6.12)

(6.13)

with aids of (4.11) and (5.7). Hence, on use of (6.13) and (5.8), the exchange-
correlation pressure is derived as

− 3V

∂Exc
∂V

=

trPxcdr +

r · ∇ · Pxcdr =

r · Pxc · dS .

(6.14)

ZV
Since d ˜Ees/dV |Sn(r) = 0 and the kinetic pressure due to Ts is given by (4.6), the
electron pressure is expressed ﬁnally as (6.10) with combined use of (6.14).

Sn(r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

I∂V

ZV

In the equilibrium, the occupation probability fi fulﬁlls the following conditions

=

∂F
∂fi (cid:12)
T V N U (r)
(cid:12)
(cid:12)
(cid:12)

∂Ωs
∂fi (cid:12)
T V µ0Ueﬀ (r)
(cid:12)
(cid:12)
In the expression of thermodynamic potential, Ω =
(cid:12)

∂E
∂fi (cid:12)
SV N U (r)
(cid:12)
(cid:12)
(cid:12)

This can be veriﬁed below.
Ts − T Ss + (Ees + Fxc) − µN , the derivative of the ﬁrst term is written as

∂Ω
∂fi (cid:12)
T V µU (r)
(cid:12)
(cid:12)
(cid:12)

(6.15)

= 0 .

=

=

dTs
dfi

=

∂Ωs
∂fi (cid:12)
(cid:12)
(cid:12)
(cid:12)

+ T

+

γeﬀ (r)

dSs
dfi

Z

dn(r)
dfi

dr ,

T µ0Ueﬀ

with use of (4.22), and the third term yields

d
dfi

[Ees + Fxc]|T V =

δ[Ees + Fxc]
δn(r)

dn(r)
dfi

dr

Z

Z

=

[Ueﬀ (r) + µI]

T V U (r)
(cid:12)
(cid:12)
dn(r)
(cid:12)
(cid:12)
dfi

dr ,

(6.16)

(6.17)

(6.18)

16

J. Chihara and M. Yamagiwa

because of d[Ees +Fxc]/dfi|T V n(r) = 0. Therefore, the derivative of Ω with respect to
fi becomes

∂Ω
∂fi (cid:12)
T V µU (r)
(cid:12)
(cid:12)
(cid:12)

=

+

∂Ωs
∂fi (cid:12)
(cid:12)
(cid:12)
[Ueﬀ (r) + µI]
(cid:12)

T V µ0Ueﬀ (r)

dn(r)
dfi

dr

+

γeﬀ (r)

Z
dn(r)
dfi

dr − µ

=

dN
dfi

Z

(6.19)

,

(6.20)

∂Ωs
∂fi (cid:12)
T V µ0Ueﬀ (r)
(cid:12)
(cid:12)
(cid:12)

which is equal to zero owing to (4.21). Here, it is important to notice in this proof
that the constant term in the eﬀective potential Ueﬀ (r) should be −µI to fulﬁll (6.15).
Similarly, other relations in (6.15) can be proved with help of (4.22). In this way, we
can prove that the equilibrium conditions for the density distribution function n(r)
and the Kohn-Sham eigenvalues ǫi to fulﬁll are given, respectively, by

δΩ
δn(r)

=

δF
δn(r)

=

δE
δn(r)

=

δΩs
δn(r)

T V µU (r)
(cid:12)
(cid:12)
(cid:12)
and
(cid:12)

T V N U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

SV N U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T V µ0Ueﬀ (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
=

∂E
∂ǫi (cid:12)
SN U (r)
(cid:12)
(cid:12)
Finally, we derive a ﬁnite-temperature generalization of the Janak theorem21) in
(cid:12)

∂Ω
∂ǫi (cid:12)
T µU (r)
(cid:12)
(cid:12)
(cid:12)

∂Ωs
∂ǫi (cid:12)
(cid:12)
(cid:12)
(cid:12)

∂F
∂ǫi (cid:12)
(cid:12)
(cid:12)
(cid:12)

T µ0Ueﬀ (r)

(6.22)

T N U (r)

= fi.

=

=

the form:

= 0 ,

(6.21)

= ǫi + µI .

dE
dfi (cid:12)
V
(cid:12)
(cid:12)
(cid:12)

(6.23)

(6.24)

which is diﬀerent from original Janak’s theorem in that the ground-state energy is
replaced by the internal energy E in Eq. (6.23). This can be easily proved with help
of Eq. (4.22), which is reduced to

because of ∂Ωs/∂fi|T V µ0Ueﬀ = 0. Since E = Ts +Ees +Exc, there results

= T

+

γeﬀ (r)

dSs
dfi

Z

dn(r)
dfi

dr ,

dTs
dfi (cid:12)
V
(cid:12)
(cid:12)
(cid:12)

= T

+

γeﬀ (r)

dr +

dn(r)
dfi

δ[Ees + Exc]
δn(r)

Z

dE
dfi (cid:12)
(cid:12)
(cid:12)
(cid:12)

V

dSs
dfi
1
β

ln

Z
fi
1 − fi

= −

+ µ = ǫi + µI .

dn(r)
dfi

dr (6.25)

(6.26)

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

§7. Summary and discussion

In the ﬁrst place, we described the thermodynamics in the DF theory for a neu-
tral electron-nucleus mixture in § 3 in a systematic manner. Next, we derived two
fundamental relations, (4.22) and (5.16), in the non-interacting system, which lead to
the thermodynamical relations in the interacting system described in terms of quan-
tities of the non-interacting system and the exchange-correlation eﬀect. Thus, with

Thermodynamics in Density-Functional Theory

17

combined of use (6.4), the relation (4.22) generates the pressure formula (5.9) as a
force theorem, the familiar Fermi distribution law6) (6.15), a ﬁnite-temperature gen-
eralization of Janak’s theorem (6.23) and some other equilibrium conditions, (6.21)
and (6.22), which are translated into those of the non-interacting system, respec-
tively. On the other hand, the relation (5.16) provides two types of force expres-
sions, (5.23) and (5.31) (Andersen’s force theorems,8), 9), 10), 3)), in conjunction with
another type of force theorem (6.1), which is equivalent to (5.23). It is interesting
to note that thermodynamic relations, (2.15) and (2.16), provide two diﬀerent but
equivalent expressions for the pressure: the one, (6.8) in the volume-integral form
and the other, (6.10) in the surface-integral form, respectively.

In the standard DF theory,1), 7), 20), 6) the eﬀective external potential is deﬁned

as

¯Ueﬀ (r) =

δ[Ees + Fxc]
δn(r)

=

δ[Ees + Exc]
δn(r)

(7.1)

T V U (r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

,

SV U (r)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

instead of the deﬁnition (3.30), where the interaction part of the chemical potential
µI is subtracted to give the eﬀective external potential. Since the eigenvalues ¯ǫi for
¯Ueﬀ (r) are related with those of Ueﬀ (r) as ¯ǫi = ǫi + µI, the formulas for ¯Ueﬀ (r) are
obtained by replacing as ǫi−µ0 = ¯ǫi−µ, and µ0−Ueﬀ(r) = µ− ¯Ueﬀ (r) from our results.
For example, the occupation probability for a state ¯ǫi is given by fi = f (¯ǫi −µ) =
f (ǫi−µ0) with use of the chemical potential µ of the real system instead of µ0. Also,
the Janak theorem is written in the usual form: dE/dfi|V = ¯ǫi. On the other hand,
the relation,20) ¯ǫmax = µ, for the occupied maximum level ¯ǫmax at T = 0 is expressed
as ǫmax = µ0 for Ueﬀ (r).

When we obtain the free-energy F of the electrons of a neutral electron-nucleus
mixture on the basis of the DF theory with aids of the adiabatic approximation, the
total pressure of this system is written as14)

3P V = 3(Pe + Pn)V

=

−3V

∂F
∂V

+ 2h ˆTnin +

hRα · Fαin

*

T N {Rα}+n
(cid:12)
(cid:12)
(cid:12)
= 2h ˆTnin + 2hTsin + hEesin +
(cid:12)

α
X
htrPxcindr

ZV

with the force on α-nucleus: Fα = −∇αF |T V N = −∇αEes. Here, the bracket with a
suﬃx n denotes the average concerning the nuclear variables deﬁned as

hAin ≡

Trn{exp[−β( ˆTn + F )]A}
Trn{exp[−β( ˆTn + F )]}

,

where Trn means a trace using a complete set of eigenfunctions for the nuclear
Hamiltonian, ˆTn + F { ˆRα}, with the nuclear kinetic operator ˆTn. In calculating the
pressure for a solid, the nuclear pressure Pn is usually neglected.

(7.2)

(7.3)

(7.4)

18

J. Chihara and M. Yamagiwa

Appendix

When F is a function of the independent variables {x1, x2, . . . , xn}, the derivative

of F with respect to some parameter λ is expressed as

Xi=1,n
with ¯xi denoting a set of variables {x1, . . . , xn} except xi. Thus, there results

dF
dλ

=

dxi
dλ

¯xi

∂F
∂xi (cid:12)
(cid:12)
(cid:12)
(cid:12)

(A.1)

dF
dλ

∂F
∂xm (cid:12)
(cid:12)
(cid:12)
i=m+1,n ∂F /∂xi|¯xi · dxi/dλ.
(cid:12)
On the other hand, when we transform the independent variables {x1, x2, . . . , xn}

x1...xm−1
(cid:12)
(cid:12)
(cid:12)
(cid:12)

x1...xm
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dxm
dλ

dF
dλ

(A.2)

because of dF /dλ|x1...xm =

+

=

¯x2

,

to {x1, x2, . . . , y}, we get a formula akin to but diﬀerent from (A.2):

P

=

¯x1

∂F
∂x1 (cid:12)
(cid:12)
(cid:12)
(cid:12)

∂(F, x2, . . . , xn)
∂(x1, x2, . . . , y)

∂(x1, x2, . . . , y)
∂(x1, x2, . . . , xn)

=

(cid:30)

∂F
+
∂x1 (cid:12)
x2...y
(cid:12)
(cid:12)
(cid:12)

∂F
∂y

(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂y
∂x1 (cid:12)
(cid:12)
(cid:12)
(cid:12)

¯xn

¯x1

.

(A.3)

References

1) W. Kohn and L. J. Sham, Phys. Rev. 140 (1965), A1133-A1138.
2) N. D. Mermin, Phys. Rev. 137 (1965), A1441-A1443.
3) H. L. Skriver, The LMTO method (Springer-Verlag, Berlin, 1984).
4) W. E. Rudge, Phys. Rev. 181 (1969), 1033-1035.
5) A. R. Williams, J. Kuebler, and C. D. Gelatt, Phys. Rev. B 19 (1979), 6094-6118.
6) J. Callaway and N. H. March, in Solid State Physics Vol. 38, edited by H. Ehrenreich,

F. Seitz and D. Turnbull (Academic Press, New York, 1984), 135-221.

7) A. K. Rajagopal, in Advances in Chemical Physics, Vol. 41, edited by I. Prigogine and

S. A. Rice, (Wiley, New York, 1980), 59-193.

8) O. K. Andersen, O. Jepsen and D. Gl¨otzel, in Highlights of condensed-matter theory, edited

by F. Bassani, F. Fumi and M. P. Tosi, (Noth-holland,Amsterdam,1985), 56-149.

9) A. R. Mackintosh and O. K. Andersen, in Electrons at the Fermi surfaces, edited by

M. Springford (Cambridge University Press, Cambridge, 1985), 148-224.

10) V. Heine, in Solid State Physics Vol. 35, edited by H. Ehrenreich, F. Seitz and D. Turnbull

(Academic Press, New York, 1980), 1-127.
11) J. Chihara, Prog. Theor. Phys. 59 (1978), 76-86.
12) F. De Proft, S. Liu and P. G. Parr, J. Chem. Phys. 107 (1997), 3000-3006.
13) J. Chihara, J. of Phys. Cond. Mat. 3 (1991), 8715-8744.
14) J. Chihara, I. Fukumoto, M. Yamagiwa and H. Totsuji, J. of Phys. Cond. Mat. 13 (2001),

7183-7198.

f (r)dn(r)/dV dr should be taken as an abbreviated expression of d {

15) M. Levy and J. P. Perdew, Phys. Rev. A 32 (1985), 2010-2021.
16)
17) J. C. Slater J. Chem. Phys. 57 (1972), 2389-2396.
18) J. F. Janak, Phys. Rev. B 9 (1974), 3985-3988.
19) K. Goedecker and K. Maschke, Phys. Rev. B 45 (1992), 1597-1604; G. Kresse and D. Jou-

V f (r)n(r)dr }/dV |f (r) .

R

R

bert, Phys. Rev. B 59 (1999), 1758-1775.

20) W. Kohn and P. Vashishta,

in Theory of the inhomogeneous electron gas, edited by

S. Lundqvist and N. H. March, (Plenum, New York, 1983), 79-147.

21) J. F. Janak, Phys. Rev. B 18 (1978), 7165-7168.

