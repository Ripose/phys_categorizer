APS/123-QED

Reference–State One–Particle Density–Matrix Theory

James P. Finley

Department of Physical Sciences, Eastern New Mexico University,

Station #33, Portales, NM 88130∗

Department of Chemistry, University of Arkansas, Fayetteville, Arkansas 72701 and

Department of Applied Chemistry, Graduate School of Engineering,

The University of Tokyo, Tokyo, Japan 113-8656

(Dated: February 2, 2008)

3
0
0
2
 
g
u
A
 
4
1
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
6
5
0
8
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

Abstract

A density-matrix formalism is developed based on the one-particle density-matrix of a single-

determinantal reference-state. Unlike traditional density-functional-theory approaches, the v-

representable problem does not appear in the proposed method, nor the need to introduce function-

als deﬁned by a constrained search; furthermore, the necessary conditions for a one-particle density

matrix to come from a single determinant are known, so they can be expressed as constraints when

minimizing variational-energy functionals. The correlation-energy functionals are not universal, in

the sense that they depend on the external potential. Nevertheless, model systems can still be

used to derive universal energy-functionals. For example, the Colle–Salvetti functional is shown

to be compatible with the proposed method. In addition, the correlation-energy functionals can

be partitioned into individual terms that are – to a varying degree – universal; yielding, for exam-

ple, an electron gas approximation, where the gas in not assumed to be uniform. Variational and

non-variational energy functionals are introduced that yield the target state when the reference

state – or its corresponding one-particle density matrix – is constructed from Brueckner orbitals.

Using many-body perturbation theory, diagrammatic expansions are given for the non-variational

energy-functionals, where the individual diagrams explicitly depend on the one-particle density-

matrix. Non-variational energy-functionals yield generalized Hartree–Fock equations involving a

non-local correlation-potential and the Hartree–Fock exchange; these equations are obtained by

imposing the Brillouin–Brueckner condition. The same equations – for the most part – are ob-

tained from variational energy-functionals using functional minimizations, yielding the (kernel of)

correlation potential as the functional derivative of correlation-energy functionals. Approximations

for the correlation-energy functions are introduced, including a one-particle-density-matrix vari-

ant of the local-density approximation (LDA), a variant of the Lee–Yang–Parr (LYP) functional,

and a variant of the correlation-energy functional used in the so-called B3LYP approach. A brief

comparison with the exact SCF theory by L¨owdin is presented.

PACS numbers:

∗Electronic address: james.ﬁnley@enmu.edu

2

I.

INTRODUCTION

Many variants of density functional theory (DFT) [1, 2, 3, 4, 5, 6] share common features

with the Hartree–Fock approach.

In particular, the Kohn–Sham method [7] uses orbital

equations that appear similar, in certain respects, with the ones from Hartree–Fock theory.

On the other hand, unlike the Hartree–Fock wavefunction, the Kohn-Sham determinantal

state shares only a common density with the exact wavefunction, and is not considered an

approximation of the ground-state. Furthermore, in contrast to the exchange potential from

Hartree–Fock theory, the Kohn–Sham exchange-correlation potential is local.

DFT approaches that use hybrid functionals [8, 9, 10, 11] introduce a component of exact

exchange-energy, where justiﬁcation, in part, for this modiﬁcation comes from the adiabatic

connection [12, 13, 14, 15, 16], yielding an approach that, again, has more similarities

with Hartree–Fock, especially since its energy functional yields a non-local potential – the

Hartree-Fock exchange – that depends on the one-particle density matrix of the Kohn-Sham

determinantal- state. The most celebrated hybrid functional, B3LYP [8, 17], contains three

parameters, two correlation-energy functionals, the Dirac-exchange functional (with a cor-

rection), and, of course, exact exchange. The LYP density functional [18] – a key component

of B3LYP – is derived from the Colle–Salvetti correlation-energy functional [19], where this

functionals depends on a one-particle density-matrix, say ˜γ, where ˜γ is from the Hartree-

Fock reference state, and not an exact eigenstate, indicating a further evolutionary step of

DFT methods towards a Hartree-Fock generalization with inclusion of electron correlation.

In the Hartree–Fock Kohn–Sham approach [20], the exchange energy is treated in an

exact manner and the non-local, Hartree–Fock exchange-potential appear in the orbital

equations. A generalization of this approach by Lindgren and Salomonson [21] yields, in

addition, a nonlocal correlation potential and orbitals that, they believe, are very similar to

Brueckner orbitals. Other workers also suggest that Brueckner and Kohn-Sham orbitals are

very similar [22].

Brueckner orbital theory [21, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37] is

a generalization of Hartree–Fock theory that utilizes a single-determinantal state that has

the maximum overlap with an exact eigenfunction [38, 39]. Below we use this formalism

to develop a density-matrix theory, in which a variety of variational and non-variational

energy-functionals are introduced that depend on the one-particle density-matrix, say γ.

3

Unlike other approaches, where γ is the one-particle density-matrix of an exact eigenfunction

[40, 41, 42, 43, 44, 45], the introduced method – called reference-state one-particle density-

matrix theory – has γ arising from a single-determinantal reference state, where the energy-

functionals yield the exact energy when γ is the one from the Brueckner reference-state.

One advantage that this one-particle, density-matrix approach has over traditional

density-functional formalisms – or one-particle density-matrix formalisms – is that there

is no v-representable problem [1, 2, 46] nor the need to introduce functionals deﬁned by

a constrained search [43, 47, 48]. Furthermore, the necessary conditions for a one-particle

density matrix γ to come from a single determinant are known, and they can be expressed

as constraints when minimizing energy functionals that depend on γ [49, 50].

Below, generalized Hartree–Fock equations are obtained containing the exact exchange-

potential and a nonlocal correlation-potential, where these equations are obtained using

the Brillouin-Brueckner condition – using non-variational energy functionals – and func-

tional minimization – using variational functionals. Both variational and non-variational

approached lead to the same correlation potential and generalized Fock-operator.

(Cor-

relation potentials from either approach are the same, in the sense that the (occupied)

Brueckner-orbitals obtained from the variational correlation-potential diﬀers only from the

orbitals obtained from the non-variational one by unitary transformation.)

Using time-independent many-body perturbation theory [51, 52, 53, 54, 55, 56], diagram-

matic expansions are given for the non-variational energy-functionals that are expressed in

terms of orbitals and orbital energies. When restrictions are placed on the orbital energies,

the individual diagrams are shown to explicitly depend on the one-particle density-matrix

of the reference state. The diagrammatic expansions for the variational-energy functionals

are presented elsewhere [57].

Kohn–Sham variants of DFT employ a universal exchange-correlation functional, inde-

pendent of the external potential; approximations can be derived from model systems, where,

in the vicinity of the model systems, the general form of the exchange-correlation functional

is known. In contrasts, the correlation-energy functionals introduced below depend on the

external potential, and are, therefore, in this sense, not universal. Nevertheless, as shown

below, the correlation-energy functionals can be partitioned into individual terms that are

– to a varying degree – universal; approximations can be derived from model systems. For

example, the electron-gas correlation-energy can be used in an electron gas approximation,

4

where, unlike the local density approximation (LDA) [7], the gas in not assumed to be

uniform.

In addition, even without partitioning of the correlation-energy functionals – with the

external-potential dependence intact – approximate functionals can still be derived from

model systems. For example, as discussed below, the Colle–Salvetti functional [19] – derived

from the helium atom – is a valid approximation within the proposed method.

II. OVERVIEW

Sec. V introduces four trial wavefunctions – say |Ψ(η)

Φ i, where η = I, II, III, and IV – that
are deﬁned with respect to a single-determinantal reference-state, say |Φi. The ﬁrst trial-

wavefunction |Ψ(I)

removed. The second trial-wavefunction |Ψ(II)

expressed by an exponential ansatz: (|Ψi = eS|Φi), where |Ψ(II)

Φ i is simply the target state of interest, say |Ψi, with the single excitations
Φ i is deﬁned with respect to the target state
Φ i is generated by removing
the single-excitation amplitudes S1 from the cluster-operator S. All of the trial states |Ψ(η)
Φ i
– including the third and fourth ones deﬁned below – share the property that they contain

no single excitations; furthermore, they generate the target state of interest |Ψi when their

reference states satisﬁes (|Φi = |Θi), where |Θi is the determinantal state constructed from

occupied Bruckner orbitals. In other words, we have (|Ψ(η)

Θ i = |Ψi).

Using intermediate normalization, the exact energy of interest, say E, is just hΦ|H|Ψi,

and it can be partitioned into two terms: the ﬁrst-order energy, say E1[Φ] – given by hΦ|H|Φi

– and the correlation energy, say Eco[Φ] – which, unlike E, is a functional of the reference

state |Φi; these concepts are brieﬂy review in Sec. III A.

Four non-variational energy-functionals, say Eη[Φ], are deﬁned in an analogous way as E:

(Eη[Φ] = hΦ|H|Ψ(η)

Φ i), where they yield the exact energy for the Brueckner reference-state:
(E = Eη[Θ]), and these functionals can also be partitioned into two terms: (Eη[Φ] = E1[Φ] +

E (η)

co [Φ]), where E (η)

co [Φ] is the correlation-energy functional, and we have (Eco[Θ] = E (η)

co [Θ]);

the details are presented in Sec. V.

Because of the one-to-one correspondence between the set of determinant states, say

{|Φi}, and the one-particle density-matrices [2, 50], say {γ}, the correlation energy, say

Eco[γ], and the correlation-energy functionals, say E (η)

co [γ] – or any other functions and func-
tionals of γ – can be transfered into ones that depend on the one-particle density-matrix γ,

5

as discussed in Sec. VIII A; the correlation-energy and exact energy satisfy: (Eco[τ ] = E (η)

co [τ ])
and (E = Eη[τ ]), where τ is the one-particle density matrix of the Brueckner reference-state

|Θi.

Unlike the ﬁrst-two trial wavefunctions,

|Ψ(I)

γ i and |Ψ(II)

γ i, that are generated by re-

moving single-excitation amplitudes from the target state |Ψi, the third and fourth trial

wavefunctions,

|Ψ(III)
γ

i and |Ψ(IV)

i, are obtained by solving the coupled-cluster theory

γ

[56, 58, 59, 60, 61, 62, 63, 64, 65] and conﬁguration interaction [66, 67, 68, 69, 70, 71, 72]

equations, respectively, in an approximate way – by neglecting the single-excitation portions.

The coupled cluster formalism is brieﬂy reviewed in Sec. III B. A transparent perturbative

treatment of the coupled cluster theory is presented in Sec. III C that is useful to obtain

a perturbative expansion for the third correlation-energy functional E (III)

co . (This approach

is compared to Lindgren’s variant of the link diagram theorem in Sec. III E.) Sec. III D

reviews Rayleigh-Schr¨odinger perturbation theory that can be used to generate the fourth

correlation-energy functional E (IV)

co when the linked diagram theorem is not invoked and the

single-excitation subspace is neglected.

In Secs. VIII B and VIII C, diagrammatic expansions using many-body perturbation the-

ory are presented for the correlation energy Eco[γ] and the correlation-energy functionals

E (η)

co [γ]. The individual diagrams depend on the orbitals – both occupied and unoccupied
– and the orbital energies – deﬁned by the zeroth-order Hamiltonian. By using degenerate

sets of occupied and unoccupied orbitals, and additional methods, it is demonstrated that

diagrams can be deﬁned that explicitly depend γ.

In Sec. IX an approach based on many-body perturbation theory is introduced, where the

perturbation is partitioned into terms that depend on the external potential, say v, and the

remaining portion that is v independent; the perturbation expansions for the correlation en-

ergy Eco and the correlation-energy functionals E (η)

co mirrors this partitioning, yielding terms
that depend on v and, the remainder, called the electron gas terms, that are v independent.

The electron gas terms are the only terms that contribute to Eco and E (η)

co for an electron gas
co ; they are also universal
functions – independent of the external potential. Atomic, diatomic and molecular terms

and, in most other cases, are the dominant portions of Eco and E (η)

are deﬁned in an analogous way are are obtained by further partitioning the perturbation

into potential terms from the individual nuclei and selectively partitioning the perturbation

expansions for Eco and E (η)
co .

6

Using the electron gas terms, an electron gas approximation is proposed in Sec X that

is an alternative to the LDA. Additional approximations are also considered in this Sec.

including one that leads to the Colle–Salvetti functional [19].

Generalized Hartree–Fock equations are deﬁned in Sec. VII, where the exact Fock-

operators, say ˆF (η)

the trial wavefunctions |Ψ(η)

Θ , generate the Brueckner orbitals, and these operators are deﬁned by
Θ i and the Brillouin-Brueckner condition, which is reviewed in
Sec. IV. In addition – from the one-to-one correspondence mentioned above – we can also
write ˆF (η)
; where, it is demonstrated that these operators are independent of η; so, in ad-
τ
dition, we can omit the η subscript and write ˆFτ . Solving the generalized Hartree–Fock

equations permit the determination of the Brueckner orbitals, and the one-particle density-

matrix, τ , that is deﬁned by these orbitals, permitting the determination of E and Eco[τ ],

since, as mentioned above, they are given by Eη[τ ] and E (η)

co [τ ], respectively; A correlation
co), where

potential, say vτ
ˆFτ is the Fock operator, determined by τ ; it is constructed from the Brueckner orbitals.

co, is also deﬁned, and satisﬁes the following identity: ( ˆFτ = ˆFτ + vτ

A variational formalism is presented in Sec. XI, where energy functionals, say ¯Eη[γ],
are deﬁned using the same trial wavefunctions as in the non-variational case: ( ¯Eη[γ] =

γ |H|Ψ(η)
γ i

hΨ(η)
), where the exact energy is generated for the Brueckner-state
one-particle density-matrix: (E = ¯Eη[τ ]). These functionals are minimized subject to the

γ |Ψ(η)
γ i

hΨ(η)

(cid:2)

−1

(cid:3)

constraint that the one-particle density-matrix comes from a single-determinantal state
γ(|Φi). The functional derivative of ¯Eη[γ] – with respect to the one-particle density-matrix

– generates ζ (η)
operators, say ˆζ (η)

τ (x1, x2), where these two-body functions are the kernels of generalized Fock
τ , and it is demonstrated that these operators are independent of η; in ad-

dition, these operators are – in a the sense mentioned in the introduction, Sec. I – equivalent
to the non-variational operators, ˆFτ . A correlation potential, say ˆν τ

co, is also obtained that
is deﬁned by its kernels which is given by the functional derivative of variational correlation-
energy functionals, say ¯E (η)

co [γ]. The electron-gas and Colle–Salvetti functionals, mentioned
above, are valid within the variational approach, permitting the determination of approxi-

mate correlation potentials ˆν τ

co by functional diﬀerentiation.

A brief comparison with the Brueckner-orbital, exact SCF theory by L¨owdin [26] and

Kobe [38] is presented in Appendix A.

7

III. PERTURBATION AND COUPLED CLUSTER THEORY

A. The exact and correlation energies

We seek solutions of the time-independent Schr¨odinger equation,

H|Ψi = E|Ψi,

where |Ψi is an eigenstate of the Hamiltonian operator,

H =

[i|ˆh|j]a†

i aj +

[ij|kl]a†

i a†

kalaj,

1
2

ijkl
X

and the integrals are written using chemist’s notation [70]:

[i|ˆh|j] = [i|(− 1

2 ∇2)|j] + [i|v|j],

[ij|kl] =

i (x1)ψj(x1)r−1
ψ∗

12 ψ∗

k(x2)ψl(x2) dr1dr2,

ij
X

ω2ω2 Z
X

where the spatial and spin coordinates, r and ω, are denoted collectively by x.

The wavefunction of interest |Ψi can be generated by a wave operator ΩΦ:

ΩΦ|Φi = |Ψi,

where |Φi is a determinantal reference-state.

The reference state |Φi is completely deﬁned by its occupied orbitals; we denote these

orbitals by {ψo→ Φ}; the set of unoccupied orbitals – the virtual orbital set – is denoted by

{ψu→ Φ}. The virtual set {ψu→ Φ} also determines the occupied set, since the two sets are

orthogonal, and the union of the two sets is a complete set. Hence, {ψu→ Φ} also determines

|Φi. Unless stated otherwise, two sets of either occupied or unoccupied orbitals that diﬀer

by a unitary transformation are considered equivalent.

We use the following orbital convention: Arbitrary orbitals are denoted by i and j;

occupied orbitals are denoted by w, x, and y; virtual orbitals are denoted by r, s, and t:

(1)

(2)

(3)

(4)

(5)

(6a)

(6b)

(6c)

ψw, ψx, ψy ∈ {ψo → Φ},

ψr, ψs, ψt ∈ {ψu → Φ},

ψi, ψj, ψk ∈ {ψo → Φ} ∪ {ψu → Φ}.

8

Explicitly, our spin-orbitals ψi(x) have the following form:

ψi(x) = χiσ(r)σ(ω), σ = α or β,

(7)

where the spin and spatial portions are given by χiσ(r) and σ(ω), respectively, and the spatial

functions χiσ(r) are permitted to be unrestricted – two spin orbitals do not, in general, share

the same spatial function.

In principle, |Φi can be any determinantal state that overlaps with the reference state:

(hΦ|Ψi 6= 0). However, our interest is often in cases where the target state |Ψi is a ground

state that is well described by a closed-shell reference-state |Φi, and the Hamiltonian is

spin-free – it contains no spin coordinates. In these cases, instead of Eq. (7), we often use a

spatially restricted set of orbitals, given by

ψiσ(x) = χi(r)σ(ω), σ = α, β,

(8)

so that |Φi is determined by a set of doubly-occupied spatial orbitals, denoted by {χo→ Φ},

where this set also determines the virtual set {χu→ Φ}. Two sets of orbitals that diﬀer by a

unitary transformation are considered, again, as equivalent.

By multiplying the Schr¨odinger Eq. (1) from the left by hΦ|, and requiring intermediate

normalization to be satisﬁed,

we get

where the ﬁrst-order energy is

hΦ|Ψi = hΦ|ΩΦ|Φi = 1,

E = hΦ|H|Ψi = E1[Φ] + Eco[Φ],

E1[Φ] = hΦ|H|Φi =

[w|(− 1

2∇2) + v + 1

2(JΦ − KΦ)|w],

Xw∈{ψo→Φ}
and the Coulomb JΦ(r) and exchange KΦ(x) operators have their usual forms:

Xx∈{ψo→Φ}
furthermore, the correlation energy Eco[Φ], given by

[i|JΦ|j] =

[xx|ij],

Xx∈{ψo→Φ}

[i|KΦ|j] =

[xi|jx];

Eco[Φ] = hΦ|H|ΨQΦi,

9

(9)

(10)

(11)

(12)

(13)

(14)

is obtained from the correlation function:

where the orthogonal-space projector is

|ΨQΦi = QΦ|Ψi,

QΦ = 1 − |ΦihΦ|.

The ﬁrst-order energy can also be written as

E1[Φ] = hΦ|H|Φi = (H)cl ,

where the cl subscript indicates the closed portion – the fully contracted terms that, dia-

grammatically speaking, have no external free-lines [55, 56, 60, 61]. Appendix B presents

partitioning or second-quantized operators into closed and open portions in a slightly diﬀer-

ent manner than is done by other authors.

Similar to the ﬁrst-order energy, for the correlation energy we have

where the correlation operator χΦ, deﬁned by

generates the correlation function |ΨQΦi when operating on the reference state:

The sum of Eqs. (17) and (18) gives the exact energy:

We also write down the expression for the exchange-correlation energy:

where the exchange energy Ex[Φ] is the last term on the right side of Eq. (11):

Eco[Φ] = (HχΦ)cl ,

χΦ = ΩΦ − 1,

χΦ|Φi = |ΨQΦi.

E = (HΩΦ)cl .

Exc[Φ] = Eco[Φ] − Ex[Φ],

Ex[Φ] = 1
2
Xw∈{ψo→Φ}

[w|KΦ|w].

10

(15)

(16)

(17)

(18)

(19)

(20)

(21)

(22)

(23)

B. The linked cluster theorem

The wave operator ΩΦ can be expressed in an exponential form [56, 58, 59, 60, 61, 62,

63, 64, 65],

ΩΦ = eSΦ = 1 + SΦ +

S2

Φ +

S3

Φ + · · · ,

1
2!

1
3!

where the cluster operator SΦ can be written as a sum of one-, two-, and higher-body terms,

and these amplitudes are deﬁned by the following relations:

SΦ = SΦ

1 + SΦ

2 + SΦ

3 + · · · ,

SΦ

1 =

rwa†
sΦ

raw,

rw
X
1
2!

1
3!

rwsx
X

rwsxty
X

SΦ

2 =

SΦ

3 =

...

sΦ
rwsxa†

ra†

saxaw,

rwsxtya†
sΦ

ra†

sa†

t ayaxaw,

rwsx = sΦ
sΦ

sxrw,

rwsxty = sΦ
sΦ

sxrwty = sΦ

rwtysx, . . . .

which use the orbital convention given by Eqs. (6); furthermore, the coeﬃcients are required

to satisfy exchange symmetry:

The cluster operator SΦ and its amplitudes SΦ

n are invariant to unitary transformations of

the occupied or virtual orbitals [30].

Since SΦ – given by Eqs. (24b) and (25) – is open, only connected (cn) portions contribute

to the correlation- and exact-energies, Eco[Φ] and E, given by Eqs. (18) and (21). Therefore,

we can write

where the additional cn subscripts indicate that only the connected portions contribute –

contractions in which all SΦ amplitudes are connected together by H.

Eco[Φ] = (HχΦ)cl,cn ,

E = (HΩΦ)cl,cn ,

11

(24a)

(24b)

(25a)

(25b)

(25c)

(26a)

(26b)

(27)

(28)

Eq. (28) indicates that the closed part of (HΩΦ)cn gives the energy of interest, E; the open

part is the mathematical statement of the linked-cluster theorem [56, 60, 61, 62, 63, 64, 65]:

(HΩΦ)op,cn = 0.

(29)

Using the time-independent form of Wick’s theorem [55, 56, 61, 73], the operator product

HΩΦ can be written as a sum of zero-, one-, two- and higher-body excitations:

HΩΦ = E + (HΩΦ)1 + (HΩΦ)2 + (HΩΦ)3 + · · · ,

(30)

where the notation (. . .)n indicates that the n-body term within the brackets (. . .) is normal-

ordered with respect to the |Φi vacuum state. Substituting this expression into Eq. (29),

we get

Since each term is linearly independent, the solution is

[(HΩΦ)n]op,cn = 0.

∞

n=1
X

[(HΩΦ)n]op,cn = 0, n 6= 0.

This relation can be used to obtain the coupled-cluster equations, satisﬁed by the SΦ am-

plitudes, SΦ

n [56, 58, 59, 60, 61, 62, 63, 64, 65].

C. Perturbation treatment of the linked cluster theorem

For Rayleigh-Schr¨odinger perturbation theory [51, 52, 53, 54, 55, 56, 71, 74, 75], the

wave- and cluster-operators are given by order-by-order expansions:

SΦ = S(1)

ΩΦ = Ω(0)

Φ + S(2)
Φ + Ω(1)

Φ + S(3)
Φ + Ω(2)

Φ + . . . ,

Φ + . . . ,

where

(31)

(32)

(33a)

(33b)

(33c)

Ω(0)

Φ = 1.

12

Substituting these relations into Eq. (24a) and equating each order, we get the following

identities [56, 63]:

Ω(1)
Φ = S(1)
Φ ,
Ω(2)
Φ = S(2)

Ω(3)
Φ = S(3)
...

2

S(1)
Φ

Φ +

1
2!
(cid:16)
Φ + S(1)
Φ S(2)

(cid:17)
Φ +

,

1
3!

S(1)
Φ

3

,

(cid:16)

(cid:17)

where the order from each term is deﬁned as a sum of the superscripts, e.g., S (1)

Φ S (2)

Φ is a

third order term.

nian H0 and a perturbation V :

For a perturbative treatment, we partition the Hamiltonian into a zeroth-order Hamilto-

where we require the reference state |Φi to be an eigenfunction of H0, and a one-body

ij
X
The above zeroth-order Hamiltonian is deﬁed by its matrix elements. We choose them

by requiring the following relation to be satisﬁed:

operator:

where

(34a)

(34b)

(34c)

(35)

(36)

(37)

(38a)

(38b)

(38c)

(38d)

and the one-body operators, ˆf Φ
the dependence of ˆf Φ

o and ˆf Φ

deﬁned by Eqs. (6).

o and ˆf Φ

u , are determined by the reference state |Φi, but

u upon |Φi is at our disposal; the orbital subspaces are, again,

H = H0 + V,

H0|Φi = E0|Φi,

H0 =

ǫija†

i aj.

ǫij = ǫji = ǫΦ
ij,

ǫΦ
wr = 0,
wx = hψw| ˆf Φ
ǫΦ
rs = hψr| ˆf Φ
ǫΦ

o |ψxi,

u |ψsi,

13

Using the above choice, our zeroth-order Hamiltonian becomes

H Φ

0 =

wxa†
ǫΦ

wax +

rsa†
ǫΦ

ras,

(39)

where the appended Φ superscript indicates that H Φ

Xw,x∈{ψo→Φ}

Xr,s∈{ψu→Φ}
0 now depends on the reference state |Φi.

A linked diagram expansion for ΩΦ and Eco[Φ] is known to exist for a zeroth-order Hamil-

tonian that is a diagonal, one-body, operator [51, 52, 53, 54, 55, 56, 71, 74, 75]. A diagonal

form for our one-body operator, H Φ

0 , is obtained when we choose its orbital sets – {ψo→ Φ}

and {ψu→ Φ} – to satisfy the following conditions:

hψw| ˆf Φ

o |ψxi = δwxǫΦ
w,

hψr| ˆf Φ

u |ψsi = δrsǫΦ
r ,

(40a)

(40b)

(41)

(42)

(43)

(44)

where we denote these particular sets of orbitals by {ψo← Φ, ˆf Φ
that they are uniquely determined by |Φi and their one-particle operator, ˆf Φ

o } and {ψu← Φ, ˆf Φ

o or ˆf Φ
u .

u }, indicating

Using these orbitals, H Φ

0 can be written as

H Φ

0 =

wa†
ǫΦ

waw +

r a†
ǫΦ

rar,

Xw∈{ψo←Φ, ˆf Φ
o }

Xr∈{ψu←Φ, ˆf Φ
u }

where our partitioning is

H = H Φ

0 + VΦ.

Since H Φ

0 is a second-quantized operator with no projection operators, it is appropriate

to substitute the above partitioning into Eq. (29), yielding

−

H Φ

0 SΦ

op,cn = (VΦΩΦ)op,cn ,

(cid:0)
Substituting Eqs. (33) into (43), and equating each order, we have

(cid:1)

−

H Φ

0 S(n)

Φ

(cid:16)

=

VΦΩ(n−1)
(cid:16)

Φ

(cid:17)

,

op,cn

op,cn

(cid:17)

where VΦ contributes unity to the overall order of the rhs. (In a sense, we have: VΦ = V (1)

Φ .)
Solving Eqs. (44) and (34) in an iterative and sequential manner generates a linked

diagram expansion for ΩΦ and a connected expansion for SΦ, which is identical to the

expansions obtained by Lindgen [56, 63, 74]. The procedure begins by using Eq. (33c),
which gives S(1)
gives S(2)

Φ back into Eq. (44)
Φ from (34b), and so on. However, in order to

Φ from Eqs. (44) and (34a). Substituting Ω(1)

Φ , permitting the calculation of Ω(2)

Φ and Ω(1)

14

get the same diagrams as Lindgren, the factorization theorem [52, 53, 56, 74, 76, 77, 78, 79]

must by exploited to unfactorize the disconnected products that appear on the right side on

Eq. (34). The diagrammatic expansions for the correlations and exact energies, Eco[Φ] and

E, are obtained from Eqs. (27) and (28). It is worth mentioning that these diagrammatic

expansions are only obtained when the one-body, zeroth-order Hamiltonian H Φ

0 is a diagonal

operator, permitting the left side of Eq. (44) to be evaluated to give terms containing factors

of orbital-energy diﬀerences, e.g., (ǫΦ

w + ǫΦ

x − ǫΦ

r − ǫΦ

s ).

Note that Eq. (44) can also be expressed by

i
where the reference state projector is

h

S(n)
Φ , H Φ

0

PΦ = QΦ

VΦΩ(n−1)
(cid:16)

Φ

cn

(cid:17)

PΦ,

PΦ = |ΦihΦ|.

Expression (45) is easily obtained from Eq. (44) by using the deﬁnition of an open operator,

adding (PΦ

S(n)
Φ , H Φ
0

PΦ = 0), and using the following identity:

h

i

QΦ

S(n)
Φ , H Φ

0

PΦ = −QΦ

H Φ

0 S(n)

Φ

PΦ.

h

i

(cid:16)

cn

(cid:17)

D. Rayleigh-Schr¨odinger perturbation theory and the Bloch Equations

Using Eqs. (5), (10), and (46), the Schr¨odinger Eq. (1) can be written

The operator form of this Eq. is the Bloch Eq. [63, 74, 80, 81]:

HΩΦ|Φi = ΩΦPΦHΩΦ|Φi.

HΩΦPΦ = ΩΦPΦHΩΦPΦ,

which yields Eq. (48) when multiplied by |Φi from the right side. Substituting Eq. (35) into

(49), and using (9) and (36), where H0 is Hermitian, gives a variant of the Bloch equation

[63, 74, 80, 81]:

(E0 − H0) ΩΦPΦ = QΦ (V ΩΦ − ΩΦPΦV ΩΦ) PΦ,

where we have used the following identity:

(45)

(46)

(47)

(48)

(49)

(50)

(51)

PΦ (V ΩΦ − ΩΦPΦV ΩΦ) = 0,

15

and this identity follows from intermediate normalization, given by Eq. (9), i.e., (PΦΩΦPΦ =

PΦ).

For Rayleigh-Schr¨odinger perturbation theory, the wave-operator ΩΦ is given by the

order-by-order expansion (33b). Substituting this expression into Eq. (50) and equating

the individual orders, gives [56, 74]

(E0 − H0) Ω(n)

Φ PΦ = QΦ

V Ω(n−1)
Φ
"

−

Ω(n−m)
Φ

PΦV Ω(m−1)

Φ

PΦ,

#

(52)

n−1

m=1
X

where the second term on the right side does not appear for (n = 1).

E. The Linked diagram theorem

When the zeroth-order Hamiltonian is in the diagonal, one-body form, given by Eq. (41),

it can be shown that the wave-operator ΩΦ satisﬁes a linked diagram theorem [56, 63]:

E0 − H Φ
0

ΩΦPΦ = QΦ (VΦΩΦ)l PΦ,

(cid:0)
where the individual orders, deﬁned by Eq. (33b), satisfy

(cid:1)

E0 − H Φ
0

Ω(n)

Φ PΦ = QΦ

(cid:0)

(cid:1)

VΦΩ(n−1)
(cid:16)

Φ

l
(cid:17)

PΦ,

and the additional l subscripts indicate that only the linked portions contribute – all dis-

connected terms are open.

In order to solve either of the above two Eqs, the wave operator ΩΦ is written as a sum

of one-, two-, and higher-body excitations,

where

ΩΦ = 1 + ΩΦ

1 + ΩΦ

2 + ΩΦ

3 + · · · ,

rwsxa†
xΦ

ra†

saxaw,

rwsxtya†
xΦ

ra†

sa†

tayaxaw,

ΩΦ

1 =

rwa†
xΦ

raw,

rw
X
1
2!

1
3!

rwsx
X

rwsxty
X

ΩΦ

2 =

ΩΦ

3 =

...

16

(53a)

(53b)

(54)

(55a)

(55b)

(55c)

and Eqs. (6) remain valid. In addition, we require our coeﬃcients to have exchange symme-

try:

rwsx = xΦ
xΦ

sxrw,

rwsxty = xΦ
xΦ

sxrwty = xΦ

rwtysx, . . . .

The wave operator ΩΦ and its n-body operators ΩΦ

n are also invariant to a unitary transfor-

mation of either its occupied orbitals {ψo→ Φ} or its virtual orbitals {ψu→ Φ}.

The linked diagram theorem provides an exponential form for the wave operator ΩΦ;

comparing the two forms of the wave operator, Eqs. (24) and (54), the following identities

are easily proven:

ΩΦ

1 = SΦ
1 ,

ΩΦ

2 = SΦ

3 = SΦ

ΩΦ
...

2 ,

SΦ
1

2 +

1
2
(cid:0)
1 SΦ
3 + SΦ

(cid:1)
2 +

1
3!

SΦ
1

3 ,

(cid:0)

(cid:1)

hΘr

w|H|Ψi = 0,

|Θr

wi = a†

raw|Θi,

ψw ∈ {ψo → Θ},

ψr ∈ {ψu → Θ}.

1
E

hΘr

w|H|Ψi = hΘr

w|Ψi = 0.

17

IV. BRILLOUIN-BRUECKNER CONDITION

Consider the Slater determinantal state, say |Θi, that satisﬁes the Brillouin-Brueckner

condition [24, 26, 26, 38, 82, 83],

for any single excitation from |Θi:

where both the occupied and virtual orbitals determine the Brueckner determinantal-

state |Θi:

Using Eqs. (1) and (58), it is easily demonstrated that the wavefunction |Ψi contains no

single excitations from |Θi:

(56a)

(56b)

(57a)

(57b)

(57c)

(58)

(59)

(60a)

(60b)

(61)

Since the states |Θr

wi are linearly independent, the wavefunction satisﬁes the following con-

dition:

where the projector for the singly-excited states is

P Θ

11|Ψi = 0.

P Θ

11 =

|Θr

wihΘr

w|,

Xw∈{ψo→Θ} Xr∈{ψu→Θ}

and this subspace is completely determined by |Θi; P Θ

11 is also invariant to a unitary trans-

formation of occupied, or virtual, orbitals [30].

Using Eqs. (61), (62) and (63), Eq. (58) can be generalized:

P Θ

11H

1 − P Θ
11

|Ψi = 0.

(cid:0)

(cid:1)

The occupied set of orbitals {ψo→ Θ} that satisfy Eq. (64) are called Brueckner orbitals.

However, since these orbitals are invariant to a unitary transformation, Eq. (64) actually

deﬁnes the Brueckner-determinantal state |Θi, since |Θi determines P Θ
11.

Note also the following identities:

The ﬁrst identity is obtained by substituting Eq. (5) into (62) and using (54) and (55) for

(Φ = Θ). The second identity uses either Eq. (57a) or Eqs. (24) and (25).

Since SΘ

1 is zero, we have

Multiplying this equation from the right by |Θi and using Eq. (5) gives

Substituting this equation into Eq. (58), and using Eq. (63), gives

ΩΘ

1 = 0,

SΘ

1 = 0.

ΩΘ = e−SΘ

1 ΩΘ.

|Ψi = e−SΘ

1 |Ψi.

11He−SΘ
P Θ

1 |Ψi = 0.

This equation is the Brillouin-Brueckner condition for coupled cluster theory [30, 84]. As

in Eq. (64), the Brueckner orbitals that satisfy Eq. (68) are invariant to a unitary trans-

formation, so Eq. (68) deﬁnes the determinantal state |Θi, since |Θi determines P Θ

11 and

S Θ
1 .

18

(62)

(63)

(64)

(65a)

(65b)

(66)

(67)

(68)

V. TRIAL WAVEFUNCTIONS AND ENERGY FUNCTIONALS

A. General Requirements

Consider four trial wavefunctions, denoted by |Ψ(η)

Φ i, where η = I, II, III, and IV. Each of

these four states depends on the reference state |Φi, satisﬁes intermediate normalization,

has no components within the singly-excited subspace,

(cid:0)
and yields the exact state of interest when |Φi is the Brueckner determinantal-state:

(cid:1)

From these trial wavefunctions |Ψ(η)

Φ i, we can construct energy functionals:

Eη[Φ] = hΦ|H|Ψ(η)

Φ i = E1[Φ] + E (η)

co [Φ],

where the correlation (co) energy-functionals are given by

the trial correlation-functions are

and E1[Φ] is given by Eq. (11). Operating on Eq. (71) by QΘ and using Eqs. (15) and (74)

we have

Let us also deﬁne exchange-correlation (xc) energy-functionals:

where the exchange energy Ex[Φ] is given by Eq. (23).

Eqs. (10), (71), and (72) indicate that the energy functionals Eη[Φ] yield the exact energy

E when the reference state |Φi is the Brueckner determinantal state |Θi:

hΦ|Ψ(η)

Φ i = 1,

|Ψ(η)

Φ i =

1 − P Φ
11

|Ψ(η)

Φ i,

|Ψ(η)

Θ i = |Ψi.

E (η)

co [Φ] = hΦ|H|Ψ(η)
QΦ

i,

QΦ|Ψ(η)

Φ i = |Ψ(η)
QΦ

i,

|Ψ(η)
QΘ

i = |ΨQΘi.

E (η)

xc [Φ] = E (η)

co [Φ] − Ex[Φ],

E = Eη[Θ],

19

(69)

(70)

(71)

(72)

(73)

(74)

(75)

(76)

(77)

and from Eqs. (14), (22), (71), (73), and (76), the following identities are obtained for the

correlation and exchange-correlation energies, Eco[Θ] and Exc[Θ]:

Eco[Θ] = E (η)

co [Θ],

Exc[Θ] = E (η)

xc [Θ].

P Θ
11H|Ψ(η)

Θ i = 0.

Substituting Eq. (71) into Eq. (64), and using Eq. (70) for (|Φi = |Θi), gives the Brillouin-

Brueckner condition for our trial wavefunctions:

We now deﬁne the explicit forms of these trial wavefunctions and give expressions for

their correlation-energy functionals. Additional expressions for the correlation-functionals

in terms of their wave-operator, or cluster-operator, amplitudes, e.g., tΦ

rwsx, are given in

Sec. VI; diagrammatic expressions are presented in Sec. VIII C.

B. The ﬁrst trial wavefunction

The ﬁrst trial-wavefunction is given by

(cid:0)
It follows from Eqs. (54) and (55) that ΩΦ
1 exclusively generates the singly-excited portion

(cid:1)

of the orthogonal space:

Therefore, this trial wavefunction can be written

Using this expression and Eq. (19), after substituting Eq. (74) into (73), yields the ﬁrst

correlation-energy functional:

where we also used (PΦ(χΦ − ΩΦ

E (I)

co [Φ] =

H

χΦ − ΩΦ
1

,

cl

(cid:2)
1 )|Φi = 0).

(cid:0)

(cid:1)(cid:3)

20

|Ψ(I)

Φ i =

1 − P Φ
11

|Ψi.

11ΩΦ
P Θ

1 |Φi = ΩΦ

1 |Φi,

11ΩΦ
P Θ

n |Φi = 0, n 6= 1.

|Ψ(I)

Φ i =

ΩΦ − ΩΦ
1

|Φi.

(cid:0)

(cid:1)

(78)

(79)

(80)

(81)

(82a)

(82b)

(83)

(84)

C. The second trial wavefunction

The second trial-wavefunction is given by

Using Eqs. (5) and (24a), this Eq. becomes

where we used the identity, given by

|Ψ(II)

Φ i = e−SΦ

1 |Ψi.

|Ψ(II)

Φ i = e(SΦ−SΦ

1 )|Φi,

e−SΦ

1 ΩΦ = e(SΦ−SΦ
1 ),

and this relation follows from Eqs. (24), since SΦ and SΦ

1 commute [85].

Using Eq. (86) after substituting Eq. (74) into (73), gives the second correlation-energy

functional:

where we also used the following:

E (II)

co [Φ] =

H

e(SΦ−SΦ

1 ) − 1

h

(cid:16)

,

cl

(cid:17)i

hΦ|HPΦe(SΦ−SΦ

1 )|Φi − hΦ|H|Φi = 0.

D. The third trial wavefunction

The third trial-wavefunction |Ψ(III)

Φ i can be generated by its wave-operator:

ˆΩΦ|Φi = |Ψ(III)

Φ i,

that can be expressed in an exponential form,

ˆΩΦ = e ˆSΦ = 1 + ˆSΦ +

ˆS2
Φ +

ˆS3
Φ + · · · ,

1
2!

1
3!

where ˆSΦ can be written as of sum n-body excitations, with the exclusion of a one-body

operator:

ˆSΦ = ˆSΦ

2 + ˆSΦ

3 + · · · .

21

(85)

(86)

(87)

(88)

(89)

(90)

(91a)

(91b)

The individual amplitudes are deﬁned by the following equations:

rwsxa†
ˆsΦ

ra†

saxaw,

rwsxtya†
ˆsΦ

ra†

sa†

t ayaxaw,

ˆSΦ
2 =

ˆSΦ
3 =

1
2!

1
3!

...

rwsx
X

rwsxty
X

Let us also mention that the orbital convention, Eqs. (6), remains valid; we also require the

coeﬃcients to possess exchange symmetry, as in Eqs. (26).

Using Eqs. (90) and (91a), after substituting Eq. (74) into (73), gives the third correlation-

energy functional:

where we used the following:

E (III)

co [Φ] =

H

e ˆSΦ − 1
(cid:16)

(cid:17)i

,

cl

h

hΦ|HPΦe ˆSΦ|Φi − hΦ|H|Φi = 0.

1 − P Φ
11

H ˆΩΦ

= 0,

(cid:0)

(cid:1) (cid:16)

op,cn

(cid:17)

We deﬁne ˆΩΦ as a solution to the following variant of Eq. (29):

which deﬁnes the trial functional |Ψ(III)

Φ i using Eq. (90).
As in Eq. (30), the operator H ˆΩΦ can also be written as a sum of zero-, one-, two- and

higher-body excitations:

H ˆΩΦ = EIII[Φ] +

H ˆΩΦ

+

H ˆΩΦ

+

1
(cid:17)

(cid:16)

2
(cid:17)

+ · · · ,

H ˆΩΦ
(cid:16)

3

(cid:17)

(cid:16)
where we use the identity, given by

EIII[Φ] =

H ˆΩΦ
(cid:16)

cl

(cid:17)

=

H ˆΩΦ

,

(cid:16)

0
(cid:17)

and this relation follow from Eqs. (72) and (90). (See also Appendix B.)

Substituting Eq. (96) into Eq. (95) yields

Substituting expansion (96) into Eq. (98) and noting that each term is linearly independent,

we have

H ˆΩΦ
(cid:16)

(cid:17)

op,cn

−

H ˆΩΦ

h(cid:16)

1
(cid:17)

op,cn
i

= 0.

= 0, n ≥ 2,

H ˆΩΦ

h(cid:16)

n
(cid:17)

op,cn
i

22

(92a)

(92b)

(93)

(94)

(95)

(96)

(97)

(98)

(99)

and this relation can be used to obtain the coupled cluster equations for the ˆSΦ

n amplitudes.

We now demonstrate that |Ψ(III)

Φ i is a valid trial wavefunction: Eq. (71) and the other

relations for Sec. (V A) are satisﬁed.

Consider a determinantal state, say |Θ′i, that we require to satisfy the following condition:

(cid:17)
Using Eq. (96), we can easily verify that the following conditions causes Eq. (100a) to be

(cid:16)

P Θ′
11

H ˆΩΘ′

= 0.

op,cn

op,cn
i
Adding Eqs. (95) and (100a), for (|Φi = |Θ′i), and comparing the result with Eq. (29),

h(cid:16)

(cid:17)

1

H ˆΩΘ′

= 0.

satisﬁed:

indicates that

and therefore we have

(Combining Eqs. (99) and (100b), and comparing the result with Eq. (32), also yields the

above two Eqs.)

Multiplying Eq. (102) by P Θ′

11 and using Eqs. (90) and (91) gives

Comparing this Eq. with Eq. (62) indicate that |Θ′i is the Brueckner state:

Substituting this result into Eq. (102) indicates that Eq. (71) is satisﬁes. All other relations

from Sec. (V A) are easily veriﬁed. For example, Eqs. (77), (78), and (79) follow from

Eqs. (72) through (76).

Substituting Eq. (104) into Eqs. (100) yields the following identities:

ˆΩΘ′ = ΩΘ′,

|Ψ(III)

Θ′ i = |Ψi.

P Θ′

11 |Ψi = 0.

|Θ′i = |Θi.

P Θ
11

H ˆΩΘ
(cid:16)
H ˆΩΘ

(cid:17)

op,cn

h(cid:16)

1
(cid:17)

op,cn
i

= 0,

= 0.

23

(100a)

(100b)

(101)

(102)

(103)

(104)

(105a)

(105b)

These equivalent relations are alternative representations of the Brillouin-Brueckner condi-
tion, since if they satisﬁed, then Eq. (80) is also satisﬁed. Note that ˆΩΦ does not possess a
single-excitation operator. i.e., ˆSΦ

1 is absent in Eq. (91b).

Using the deﬁnition of an open operator, Eqs. (95) and (105a) can be represented by the

following:

where

expansions:

(106)

(107)

(108)

(109a)

(109b)

(110a)

(110b)

(111)

˜QΦ

P Θ
11

H ˆΩΦ
(cid:16)
H ˆΩΘ
(cid:16)

cn

cn

(cid:17)

(cid:17)

PΦ = 0,

PΘ = 0,

˜QΦ = QΦ − P Φ
11.

ˆSΦ = ˆS(1)

ˆΩΦ = ˆΩ(0)

Φ + ˆS(2)
Φ + ˆΩ(1)

Φ + ˆS(3)
Φ + ˆΩ(2)

Φ + . . . ,

Φ + . . . ,

Φ = ˆS(1)
ˆΩ(1)
Φ ,
Φ = ˆS(2)
ˆΩ(2)

Φ +

1
2

ˆS(1)
Φ

2

,

(cid:16)

(cid:17)

As in Eqs. (33), the wave- and cluster-operators of interest are given by order-by-order

where ( ˆΩ(0)

Φ = 1.) Substituting these relations into Eq. (91a) and equating each order, we

get similar identities as in Eqs. (34):

and so so.

From Eq. (95), and using Eqs. (42) and (109) – as in the derivation of Eq. (44) – we have

−

1 − P Φ
11

H Φ
0

ˆS(n)
Φ

=

1 − P Φ
11

VΦ ˆΩ(n−1)

Φ

(cid:0)

(cid:1) (cid:16)

op,cn

(cid:17)

(cid:0)

(cid:1) (cid:16)

.

op,cn

(cid:17)

Solving Eqs. (111) and (110) in an iterative and sequential manner generates a linked diagram
expansion for ˆΩΦ and a connected expansion for ˆSΦ. The diagrams representing E (III)
ˆS(n)
Φ are discussed in Sec. VIII B and elsewhere [57], respectively.

co [Φ] and

Of the four trial wavefunctions |Ψ(η)

Φ i, the third one |Ψ(III)

Φ i, we believe, is the most appli-

cable; the fourth one is presented below for completeness.

24

E. The fourth trial wavefunction

The fourth trial wavefunction is a solution of the Sch¨odinger Eq. within the subspace

that neglects the single-excited states:

From the variational theorem, it follows that the above energy functional provides an upper

1 − P Φ
11

H|Ψ(IV)

Φ i = EIV[Φ]|Ψ(IV)

Φ i.

(cid:0)

(cid:1)

bound to the exact energy:

EIV[Φ] ≥ E.

We now prove that the exact wavefunction and energy satisfy Eqs. (71) and (77), where

(η = IV).

The proof uses the Schr¨odinger Eq. (1), which can be written

P Θ

11H|Ψi +

1 − P Θ
11

H|Ψi = EP Θ

11|Ψi + E

1 − P Θ
11

|Ψi,

(114)

where he have added and subtracted P Θ

11 terms. Eqs. (58), (62), and (63) indicate that the

(cid:0)

(cid:1)

(cid:0)

(cid:1)

ﬁrst terms on the right and left sides vanish, so we have

1 − P Θ
11

H|Ψi = E

1 − P Θ
11

|Ψi.

(115)

Eqs. (71) and (77), for (η = IV), are obtained by comparing Eqs. (112) and (115), and using

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(70). All other relations from Sec. (V A) are easily veriﬁed.

As in the exact wavefunction of interest |Ψi, the trial wavefunction |Ψ(IV)

Φ i can be gener-

ated by a wave operator ˜ΩΦ:

˜ΩΦ|Φi = |Ψ(IV)

Φ i,

where ˜ΩΦ is similar to ΩΦ – deﬁned by Eqs. (54) and (55) – except that there is no excitation
operator into P Φ
11:

where

(112)

(113)

(116)

(117)

(118a)

(118b)

˜ΩΦ = 1 + ˜ΩΦ

2 + ˜ΩΦ

3 + · · · ,

rwsxa†
˜xΦ

ra†

saxaw,

rwsxtya†
˜xΦ

ra†

sa†

tayaxaw,

˜ΩΦ

2 =

˜ΩΦ

3 =

1
2!

1
3!

...

rwsx
X

rwsxty
X

25

Using Eq. (116), after substituting Eq. (74) into (73) gives the fourth correlation-energy

functional:

h
where we added (hΦ|HPΦ( ˜ΩΦ − 1)|Φi = 0).

(cid:16)

E (IV)

co [Φ] =

H

˜ΩΦ − 1

,

cl

(cid:17)i

It is easily proven that ˜ΩΦ is a solution to the following variants of Eqs. (33b) and (52):

˜ΩΦ = 1 + ˜Ω(1)

Φ + ˜Ω(2)

Φ + . . . ,
n−1

(E0 − H0) ˜Ω(n)

Φ PΦ = ˜QΦ

V ˜Ω(n)
"

Φ −

m=1
X

˜Ω(n−m)
Φ

PΦV ˜Ω(m−1)

Φ

PΦ,

#

where ˜QΦ is deﬁned by Eq. (108), and we require H0 to satisfy

VI. EXPRESSIONS FOR THE CORRELATION-ENERGY FUNCTIONALS:

Using Wick’s theorem [55, 56, 61, 73], the Hamiltonian can be separated in to zero-, one-,

and two-body parts:

where

P Φ

11H0

1 − P Φ
11

= 0.

(cid:0)

(cid:1)

H = H Φ

c + H Φ

1 + H Φ
2 ,

H Φ

c = hΦ|H|Φi = E1[Φ] = (H)cl,

H Φ

1 =

[i| ˆFΦ|j]{a†

i aj},

H Φ

2 =

[ij|kl]{a†

i a†

kalaj},

ij
X
1
2

ijkl
X

ˆFΦ = − 1

2 ∇2 + v + JΦ − KΦ,

where the Fock operator is given by

and the identities within Eqs. (124a) follow from Eqs. (11) and (17).

Substituting Eqs. (19) and (123) into (18), and using (54), yield an expression for the

correlation energy:

Eco[Φ] =

H Φ

1 ΩΦ

1 + H Φ

2 ΩΦ
2

,

cl

(126)

(cid:1)

(cid:0)

26

(119)

(120)

(121)

(122)

(123)

(124a)

(124b)

(124c)

(125)

and from Eqs. (124) and (55) we have

Eco[Φ] =

rw[w| ˆFΦ|r] +
xΦ

xΦ
rwsx ([wr|xs] − [ws|xr]) ,

(127)

rw
X

1
2

rwsx
X

where the coeﬃcients are are assumed to have exchange symmetry, deﬁned by Eq. (56).

As is the correlation-energy expression (18), the correlation-energy functionals, given by

Eq. (73), can be written

where the trial correlation-operators χη

Φ generate the trial correlation-functions:

and |Ψ(η)
QΦ

i is given by Eq. (74). Comparing this deﬁnition with Eqs. (72) and (73), and

using Eq. (124a), we have

Eη[Φ] = hΦ|H (1 + χη

Φ) |Φi = [H (1 + χη

Φ)]cl .

(130)

Comparing Eqs. (84), (88), (93), and (119) with (128), yields the following relations:

Substituting Eqs. (18) and (128) into (78) for (|Φi = |Θi), we get

and this expression indicates that any of the trial correlation-functions – χI

Θ, χI

Θ, χIII

Θ , and

χIV

Θ – can be used to obtain the Brueckner one, χΘ.

Substituting Eqs. (131) into Eq. (128), and using Eqs. (19), (54), (24), (91), (117), and

(123), give expressions for the correlation energy functionals:

E (η)

co [Φ] = (Hχη

Φ)cl ,

Φ|Φi = |Ψ(η)
χη
QΦ

i,

1 ) − 1,

Φ = χΦ − ΩΦ
χI
1 ,
Φ = e(SΦ−SΦ
χII
Φ = e ˆSΦ − 1,
χIII
Φ = ˜ΩΦ − 1.
χIV

χη

Θ = χΘ,

E (I)

co [Φ] =

H Φ

2 ΩΦ
2

cl

E (II)

co [Φ] =

(cid:0)

H Φ

E (III)

co [Φ] =

(cid:0)

H Φ
2

(cid:1)
cl

2 SΦ
2
ˆSΦ
(cid:1)
2

E (IV)

co [Φ] =

H Φ
2

˜ΩΦ
2

,

,

,

.

cl

cl

(cid:17)

(cid:17)

(cid:16)

(cid:16)

27

(128)

(129)

(131a)

(131b)

(131c)

(131d)

(132)

(133a)

(133b)

(133c)

(133d)

Using Eqs. (55b), (25b), (92a), (118a), and (124c), the above energy functionals above can

be evaluated, giving the following relations:

E (I)

co [Φ] =

xΦ
rwsx ([wr|xs] − [ws|xr]) ,

E (II)

co [Φ] =

sΦ
rwsx ([wr|xs] − [ws|xr]) ,

E (III)

co [Φ] =

ˆsΦ
rwsx ([wr|xs] − [ws|xr]) ,

E (IV)

co [Φ] =

˜xΦ
rwsx ([wr|xs] − [ws|xr]) ,

1
2

1
2

1
2

1
2

rwsx
X

rwsx
X

rwsx
X

rwsx
X

Eco[Φ] =

H Φ

1 SΦ

1 +

H Φ

2 SΦ

1 SΦ

1 + H Φ

2 SΦ
2

,

1
2

(cid:19)cl

(cid:18)

1
2

(cid:18)

E (I)

co [Φ] =

H Φ

2 SΦ

1 SΦ

1 + H Φ

2 SΦ
2

,

(cid:19)cl

where the coeﬃcients are assumed to satisfy exchange symmetry, e.g., Eqs. (26) and (56).

For later use, we also mention that the correlation energy and the ﬁrst correlation-energy

functional, given by Eqs. (126) and (133a), can be written using the SΦ amplitudes:

where we have used Eqs. (57a) and (57b).

VII. EXACT FOCK OPERATORS

Consider generalized, or exact, Fock operators ˆF (η)

Φ , that are deﬁned, in part, by the

following matrix elements:

hψr| ˆF (η)

Φ |ψwi = hΦr

w|H|Ψ(η)

Φ i;

η = I, II, III, IV,

(137)

where the w and r orbitals are occupied and unoccupied within |Φi, respectively, as noted

by Eqs. (6). By multiplying Eq. (80) from the left by hΘr

w|, using Eq. (63), and comparing

the resulting relation to the above Eq., we have

where the orbitals are deﬁned by Eq. (60). When satisﬁed by all orbitals, this expression

is equivalent to the Brillouin-Brueckner condition, given by Eq. (80). The operator form of

Eq. (138) is

hψr| ˆF (η)

Θ |ψwi = 0,

ˆκΘ ˆF (η)

Θ ˆγΘ = 0,

28

(134a)

(134b)

(134c)

(134d)

(135)

(136)

(138)

(139)

where ˆγΦ is the one-particle, density-matrix operator for the determinantal-state |Φi [86,

87, 88, 89]:

ˆκΦ is the projector into the virtual-orbital subspace:

Xr∈{ψu→Φ}
and the identity operator ˆI can be expressed by

ˆγΦ =

|ψxihψx|;

Xx∈{ψo→Φ}

ˆκΦ =

|ψrihψr|,

ˆI = ˆγΦ + ˆκΦ.

Multiplying Eq. (139) from the left and right by hψr| and |ψwi gives Eq. (138).

Since all of our generalized Fock operators – ˆF (I)

Θ , ˆF (II)

Θ , ˆF (III)

Θ , and ˆF (IV)

Θ

– satisfy Eq. (139),

any one can be used to deﬁne an exact Fock operator ˆFΘ:

ˆκΘ ˆFΘˆγΘ = ˆκΘ ˆF (η)

Θ ˆγΘ = ˆκΘ ˆF (η′)

Θ ˆγΘ,

and the Brillouin-Brueckner condition, Eq. (139), becomes

Using Eq. (142), this Eq. can be written as

Since ˆγΘ is idempotent,

Eq. (145) can be written as

(cid:17)
By requiring ˆFΘ to be, at least in part, Hermitian:

(cid:16)

ˆκΘ ˆFΘˆγΘ = 0.

ˆI − ˆγΘ

ˆFΘˆγΘ = 0.

(cid:0)

(cid:1)

ˆγΘˆγΘ = ˆγΘ,

ˆFΘˆγΘ − ˆγΘ ˆFΘ

ˆγΘ = 0.

ˆγΘ

ˆFΘˆκΘ = 0,

ˆFΘˆγΘ − ˆγΘ ˆFΘ

ˆκΘ = 0.

(cid:16)

(cid:17)

29

yields the following identity:

(140)

(141)

(142)

(143)

(144)

(145)

(146)

(147)

(148)

(149)

Adding together Eqs. (147) and (149), and using Eq. (142), indicates that ˆγΘ and ˆFΘ com-

mute:

where

Eq. (150) is a generalization of the one obtained for Hartree-Fock theory [2, 49, 50].

Note that for any reference state, say |Φ′i, we can ﬁnd a corresponding state, |Φi, in

which the following relation is satisﬁed:

= 0.

ˆFΘ, ˆγΘ
h

i

ˆκΦ ˆF (η)

Φ′ ˆγΦ = 0.

Solving this expression in an iterative and self-consistent-ﬁeld manner leads to the Brillouin-

Brueckner condition, Eq. (144), being satisﬁed, since when (|Φi = |Φ′i), we have (|Φi = |Θi).

Consider now the following application of the identity operator:

ˆI ˆFΦ|ψwi = ˆFΦ|ψwi =

εΦ
xw|ψxi +

εΦ
rw|ψri,

(152)

Setting (Φ = Θ), and using Eq. (138), gives exact Hartree–Fock Eqs:

Xx∈{ψo→Φ}

Xr∈{ψu→Φ}

ij = hψi| ˆFΦ|ψji.
εΦ

ˆFΘ|ψwi =

εΘ
xw|ψxi,

Xx∈{ψo→Θ}

where the orbital |ψwi is from the set {ψo → Θ}.

Returning to Eq. (137), inserting the identity operator – deﬁned by Eq. (16) – we have

hψr| ˆF (η)

Φ |ψwi = hΦr

w|H|Φi + hΦr

w|H|Ψ(η)
QΦ

i,

where the trial-correlation functions |Ψ(η)
QΦ
side of Eq. (155) is the oﬀ-diagonal block of the Fock-operator ˆFΦ:

i are given by Eq. (74); the ﬁrst term on the right

hψr| ˆFΦ|ψwi = hΦr

w|H|Φi,

where is ˆFΦ deﬁned by Eq. (125). Substituting Eqs. (156) and (129) into (155), we have

(150)

(151)

(153)

(154)

(155)

(156)

(157)

hψr| ˆF (η)

Φ |ψwi = hψr| ˆFΦ|ψwi + hΦr

w|Hχη
= hψr|( ˆFΦ)op|ψwi + hψr|

Φ|Φi

(Hχη

Φ)1

op |ψwi,
(cid:3)

(cid:2)

30

where we use the more restrictive deﬁnition of an open (op) operator, presented in Ap-

pendix B.

Brueckner condition:

Setting (Φ = Θ), and using Eqs. (132) and (138), gives another variant of the Brillouin-

ˆFΘ + (HχΘ)1

= 0,

(cid:16)

op
(cid:17)

where this expression acts within the one-body sector of the Hilbert space, even though the

subscript op indicates the open portion – deﬁned by the n-body sector.

Now let the second term on the right side of Eq. (155) deﬁne the oﬀ-diagonal block of

correlation potentials vΦη

co (x), given by

hψr|vΦη

co |ψwi = hΦr

w|H|Ψ(η)
QΦ

i.

Similarly, exchange-correlation potentials vΦη

xc (x) are deﬁned, in part, by

hψr|vΦη

xc |ψwi = hψr|vΦη

co |ψwi − hψr|KΦ|ψwi.

Using Eqs. (155), (156), and (159), and with no loss of generality, our exact Fock operators
ˆF (η)
Φ can be written

ˆF (η)
Φ = ˆFΦ + vΦη
co .

Multiplying Eq. (161) from the left and right by hψr| and |ψwi, and using the one-body

partitioning method of Eqs. (B8), gives

hψr| ˆF (η)

Φ |ψwi = hψr|( ˆFΦ)ex|ψwi + hψr| (vΦη

co )ex |ψwi.

Comparing Eq. (157) with (162), and using (B9), we have

(cid:3)
and the Brillouin-Brueckner condition (158) becomes

(cid:2)

(vΦη

co )ex =

(Hχη

Φ)1

,

op

where

and the η superscript is suppressed, since, in general we have

= 0,

ˆFΘ
(cid:16)

ex

(cid:17)

ˆFΘ = ˆFΘ + vΘ
co,

(vΘ

co)ex = (vΘη

co )ex =

vΘη′
co

.

ex

(cid:0)

(cid:1)

31

(158)

(159)

(160)

(161)

(162)

(163)

(164)

(165)

(166)

The remaining matrix elements of vΦη

co |ψs] – are at our disposal.
co – [ψw|vΦη
By deﬁning these matrix elements in a manner that is independent of η, but dependent on
co(x) and ˆFΘ are completely, and unambiguously determined; our exact Fock operator

co |ψx] and hψr|vΦη

|Φi, vΘ

can be diagonalized:

ˆFΘψΘ

i (x) = εΘ

i ψΘ

i (x),

(167)

where orbital energies εΘ

i can be deﬁned to give exact ionization potentials and electron

aﬃnities – exact Koopman’s theorems [21, 57].
ˆf Φ
u , that give the zeroth-order Hamiltonian H Φ
mutually exclusive, one tempting choice is

In addition, since the operators, ˆf Φ

0 , and the exact Fock operators, ˆF (η)

o and
Φ , are not

o = ˆf Φ
ˆf Φ

u = ˆF (η)
Φ .

(168)

By using the diagrammatic expansion for χη

Φ, and Eq. (163), a diagrammatic expansion

for (vΦη

co )ex can be obtained that is a subset of the open one-body diagrams of HχΦ [57].

VIII. REFERENCE–STATE ONE–PARTICLE DENSITY–MATRIX THEORY

A. Functionals of the one-particle density-matrix γ

There is a one-to-one correspondence between the set of determinant states, {|Φi}, and

their one-particle density-matrices [2, 50], {γ}, where these density-matrices are given by

[49, 86, 87, 88, 89]

γ(x, x′) =

ψw(x)ψ∗

w(x′).

(169)

Xw∈{ψo→Φ}
Because of this correspondence, determinantal states are uniquely determined by their one-

particle density-matrix: |Φ(γ)i; functionals, or functions, that depend on |Φi, can be written

as ones depending on γ. For example, the total energy E, Eq. (10), and our energy functionals

Eη[Φ], Eq (72), can be written

E = E1[γ] + Eco[γ],

Eη[γ] = E1[γ] + E (η)

co [γ],

(170)

(171)

where, in addition, our trial wavefunctions |Ψ(η)

Φ(γ)i can be denoted by |Ψ(η)

γ i.

32

For simplicity, we require the external potential v(r) to be a spin-free operator, so the

ﬁrst-order energy can be written as

E1[γ] =

− 1

2∇2

r γ(x, x′)

=xdx +

x′

v(r)γ(x, x) dx + EJ[γ] − Ex[γ],

(172)

Z
where the Coulomb and exchange energies are

Z

(cid:3)

(cid:2)

EJ[γ] =

Ex[γ] =

1
2
1
2

Z Z

Z Z

r−1
12 γ(x1, x1)γ(x2, x2) dx1 dx2,

r−1
12 γ(x1, x2)γ(x2, x1) dx1 dx2.

(As in Eq. (4), an integration over xi actually implies a summation over the spin variable

ωi and an integration over the spatial portion ri.)

Similarly, the one-body operators ˆF (η)

Φ , Eq. (161), can be written

where, instead of Eq. (125), the Fock operator is given by

ˆF (η)

γ = ˆFγ + vγη
co ,

ˆFγ = − 1

2∇2 + v + Jγ − Kγ,

and the Coulomb Jγ and exchange Kγ operators satisfy:

In addition, the identity operator, given by Eq. (142), can be written

where the density-matrix operator ˆγ is deﬁned by its kernel, γ(x, x′) [89]:

and κγ(x, x′) is the kernel of the virtual-space projector:

Jγφ(x1) =

r−1
12 γ(x2, x2) φ(x1) dx2,

Kγφ(x1) =

r−1
12 γ(x1, x2)φ(x2) dx2.

Z

Z

ˆI = ˆγ + ˆκγ,

ˆγφ(x) =

γ(x, x′)φ(x′) dx′,

ˆκγφ(x) =

κγ(x, x′)φ(x′) dx′,

Z

Z

33

(173)

(174)

(175)

(176)

(177)

(178)

(179)

(180)

(181)

κγ(x, x′) =

ψr(x)ψ∗

r (x′),

(182)

Xr∈{ψu→γ}
and ˆκΦ is given by Eq. (141). Similarly, the one-particle density-matrix for the Brueck-
ner state, say τ (x, x′), and its density-matrix operator, say ˆτ , are given by the following

τ (x, x′) =

ψw(x)ψ†

w(x′),

ˆτ φ(x) =

τ (x, x′)φ(x′) dx′,

where

expressions:

where we have

Since the one-particle density-matrix, ˆτ , also satisﬁes

where ˆγΘ is given by Eq. (140), the Brillouin-Brueckner condition, given by Eq. (144), and

its complex conjugate, given by Eq. (148), become

the commutation condition, given by Eq. (150), can be written

the exact Hartree–Fock Eq. (154) is

ˆFτ |ψwi =

ετ
xw|ψxi,

Xx∈{ψo→τ }
where the occupied orbital, |ψwi, is from {ψo → τ }; furthermore, the other Brillouin-

Brueckner condition, Eq. (164), can be written as

where Eq. (165) becomes

Xw∈{ψo→Θ}

Z

|Θi = |Φ(τ )i.

ˆτ = ˆγΘ,

ˆκτ ˆFτ ˆτ = 0,
ˆτ ˆFτ ˆκτ = 0;

= 0;

ˆFτ , ˆτ
h

i

= 0,

ˆFτ
(cid:16)

ex

(cid:17)

ˆFτ = ˆFτ + vτ

co.

34

(183)

(184)

(185)

(186)

(187a)

(187b)

(188)

(189)

(190)

(191)

In the following subsections, we illustrate how the correlation energy and correlation-

energy functionals, Eco[γ] and E (η)

co [γ], can be obtained from perturbation theory, in which
all terms (or diagrams) explicitly depend on γ. (An explicit expression for the ﬁrst-order

energy, E1[γ], is given by Eq. (172).)

B. The correlation energy as a functional of the one-particle density matrix: Eco[γ]

Consider the normal-ordered form of the Hamiltonian H, given by Eqs. (123) and (124),

where we choose to represent this operator using the following orbital sets: {ψo← γ, ˆf γ

o } and

{ψu← γ, ˆf γ
Hamiltonian H γ

u }, and both sets are introduced in Sec. III C. Since the one-body portion of the
1 is determined by the Fock operator ˆFγ, it seems appropriate to use the

following notation:

H γ

1 = { ˆFγ},

(192a)

or, equivalently, the expression { ˆFγ} is deﬁned by the following procedure: Obtain the Fock
operator ˆFγ for the one-particle Hilbert space, given by Eq. (176); write this operator in its
second quantized form using the true vacuum state | i; re-write ˆFγ using normal ordering
with respect to the new vacuum state, |Φ(γ)i: ( ˆFγ = ( ˆFγ)cl + { ˆFγ}); the uncontracted term
is { ˆFγ}. In other words, { ˆFγ} is the uncontracted term when the operator ˆFγ is written in

normal ordered form using Wick’s theorem [55, 56, 61, 73].

Using this notation, we also write

H γ

2 = {r−1

12 }γ,

(192b)

where, again, r−1

12 is written in second quantization using the true vacuum state | i – given
by the second term on the right side of Eq. (2) – and then it is re-written using normal-

ordering with respect to the new vacuum state; the uncontracted term is {r−1

12 }γ, where the
additional γ-subscript from {. . .}γ, serves to remind us that the vacuum state is |Φ(γ)i.

(This γ subscript is suppressed in Eq. (192a): The vacuum state is understood, since γ
determines ˆFγ.)

The correlation energy Eco is determined by the one- and two-body parts of the Hamilto-

nian, { ˆFγ} and {r−1

12 }γ. However, the individual orders of the perturbation expansion for Eco,

also depends, in addition, on the zeroth-order Hamiltonian, given by Eq. (41); this operator

35

can be written as

H γ

0 = ˆoγ + ˆuγ,

where these terms – ˆoγ and ˆuγ – are the occupied and unoccupied portions of H γ
and (H γ

0 )un – and are given by the following:

0 – (H γ

0 )oc

Xr∈{ψu←γ, ˆf γ
u }
Using this notation, our zeroth-order Hamiltonian in normal-ordered form can be written

where ˆuγ is already normal-ordered; the constant term E0[γ] is the zeroth-order energy of

as

|Φ(γ)i:

and is given by

Note that the ﬁrst-order and the correlation energies, E1[γ] and Eco, do not depend the

zeroth-order energy E0[γ].

The perturbation Vγ, deﬁned by Eqs. (42), can also be written in normal-ordered form:

where, from Eqs. (123), (124a), (192), and (195), the individual terms are given by the

following expressions:

ˆoγ =

ˆuγ =

Xw∈{ψo←γ, ˆf γ
o }

w a†
ǫγ

waw,

r a†
ǫγ

rar.

H γ

0 = E0[γ] + {ˆoγ} + ˆuγ,

H γ

0 |Φ(γ)i = E0[γ] |Φ(γ)i,

E0[γ] =

ǫγ
w.

Xw∈{ψo←γ, ˆf γ
o }

Vγ = V γ

c + V γ

1 + V γ
2 ,

V γ
c = E1[γ] − E0[γ],
1 = { ˆFγ} − {ˆoγ} − ˆuγ,
V γ
V γ
2 = {r−1

12 }γ.

36

The one- and two-body parts of H are given by Eqs. (124b) and (124c), and are equal to

{ ˆFγ} and {r−1

12 }γ, as indicated by Eqs. (192). The Goldstone diagrammatic representation

(193)

(194a)

(194b)

(195)

(196)

(197)

(198)

(199a)

(199b)

(199c)

of these operators can be written in the following manner [51, 52, 53, 54, 55, 56, 74, 75]:

The one-body part of the perturbation V γ

1 is usually represented by a single diagrammatic
operator. However, for our purposes, it is convenient to use separate diagrammatic operators
for the three terms on the right side of Eq. (199b), where { ˆFγ} is presented by Eq. (200a).

Since the other two terms are diagonal, it is appropriate is simply represent them as (unﬁlled)

arrows:

{ ˆFγ} = H γ

1 =

{r−1

12 }γ = H γ

2 =

,

.

−{ˆoγ} =

−ˆuγ =

,

.

(200a)

(200b)

(201a)

(201b)

In contrast, hole- and particle-lines, by themselves, are represented by ﬁlled arrows: and .

As a slight alternative to the usual approach to evaluate the diagrams of the correlation

energy Eco [51, 52, 53, 54, 55, 56, 70, 74, 75], we associate a hole line corresponding to a
w-occupied orbital with a ψw(x1)ψ∗
to an r-unoccupied orbital with a ψr(x2)ψ∗

w(x2) factor; we associate a particle line corresponding
r (x1) factor, where x1 and x2 denote the dummy

integration variables that arise from the vertices. Using this convention, the sole diagram
involving the Fock operator ˆFγ from second-order perturbation theory can be evaluated in

the following manner:

= (εγ

rw)−1

d x1 d x2

Z

ˆFγ1γw(x1, x2)
(cid:16)

(cid:17)

· ˆFγ2γr(x2, x1),

(202)

where

rw = ǫγ
εγ

w − ǫγ
r,

(203)

and the repeated indices – r and w – are summed over; ˆFγi denotes the Fock operator ˆFγ –
given by Eq. (176) – acting upon (xi); the term ( ˆFγi · · · )· indicates that ˆFγi exclusively acts

37

within the brackets; furthermore, the wth component of the (one-particle) density-matrix γ

is denoted by

the rth orthogonal-component of γ is denoted by

γw(x1, x2) = ψw(x1)ψ∗

w(x2);

γr(x1, x2) = ψr(x1)ψ∗

r (x2),

where, for a complete set of orbital states, we have [54]

(204a)

(204b)

δ(x1 − x2) =

γw(x1, x2) +

γr(x1, x2),

(205)

w
X

r
X

which is a shorthand notations for

δ(x1 − x2) = δ(r1 − r2)δω1ω2.

(206)

In order to further compress our notation, we use the convention that all repeated dummy
indices are integrated over and restrict the Fock operator ˆFγi to exclusively act upon the
ﬁrst index of any two-body function, i.e., ( ˆFγiα′(xj, xi)α(xi, xj) = α′(xj, xi) ˆFγiα(xi, xj));

Eq. (202) can then be written as

= (εγ

rw)−1 ˆFγ1γw(x1, x2) ˆFγ2γr(x2, x1),

(207a)

and the other two diagrams from second-order perturbation theory have the following forms:

=

(εγ

rwsx)−1r−1

12 r−1

34 γw(x1, x3)γr(x3, x1)γx(x2, x4)γs(x4, x2),

(207b)

= −

(εγ

rwsx)−1r−1

12 r−1

34 γw(x1, x3)γr(x3, x2)γx(x2, x4)γs(x4, x1),

(207c)

where

rwsx = εγ
εγ

rw + εγ

sx.

(208)

The diagonal terms arising from the zeroth-order Hamiltonian, given by −{ˆoγ} and −ˆuγ,
and represented by Eqs. (201), ﬁrst appear in third order. For example, the following two

38

1
2

1
2

diagrams can be obtained by inserting −{ˆoγ} and −ˆuγ into the diagram on the left side of
Eq. (207a):

= −

(−ǫw)
(εγ
rw)2

ˆFγ1γw(x1, x2) ˆFγ2γr(x2, x1),

=

(−ǫr)
(εγ
rw)2

ˆFγ1γw(x1, x2) ˆFγ2γr(x2, x1).

(209a)

(209b)

(210)

(211)

(212)

The hole-line operator {ˆoγ} generates an additional hole line when inserted into a diagram
and, therefore, a factor of −1 is included when diagram (209a) is evaluated, where this

factor cancels the −1 factor from −ǫw. Since this type of cancellation always occurs, as an
alternative, we associate a factor of ǫw for {ˆoγ} insertions, and treat {ˆoγ} vertices as ones
that do not generate additional hole lines; ˆuγ is associated with a −ǫr factor. Keep in mind,

also, that these operators generate an additional energy-denominator factor, e.g., εγ

rw, when

inserted into a diagram.

One advantage of partitioning the one-body part of the perturbation V γ

1 into individual

components, as indicated by Eq. (199b), is that it yields correlation-energy diagrams that
explicitly depend on the Fock operator ˆFγ. Furthermore, an overall dependence of the

correlation energy Eco on the one-particle density matrix γ becomes, to a certain extent,

transparent, by using Eqs. (204), (169), and (182), yielding the following identities:

and note that κγ depends, explicitly, on γ:

γ(x1, x2) =

γw(x1, x2),

κγ(x1, x2) =

γr(x1, x2),

w
X

r
X

δ(x1 − x2) = γ(x1, x2) + κγ(x1, x2),

where the operator form of this relation is Eq. (179).

The individual diagrams depend,

in part, on each of the γw components, given by

Eq. (204a), and the orthogonal components γr, given by Eq. (204b).

In addition, each

diagram depends on the set of orbital energies {ǫγ}, which are at our disposal. In order to

39

make each diagram an explicit functional of the one-particle density matrix γ, we choose all

occupied orbitals to be degenerate, with energy ǫγ

o ; also, we choose all unoccupied orbitals

to be degenerate, with energy ǫγ

u. With these choices, the zeroth-order Hamiltonian, given

by Eq. (41), becomes

H γ

0 = ǫγ

o

waw + ǫγ
a†
u

a†
rar,

Xw∈{ψo←γ, ˆf γ
o }

Xr∈{ψu←γ, ˆf γ
u }

and since this operator is invariant to a unitary transformation of occupied or unoccupied
orbitals, it no longer depends on ˆf γ

u – any set of orbitals deﬁning γ is appropriate –

o and ˆf γ

so we can write

H γ

0 = ǫγ

o
Xw∈{ψo→γ}

waw + ǫγ
a†
u
Xr∈{ψu→γ}

a†
rar.

It is easily proven that all perturbative orders, except for the zeroth-order, depend on the

orbital-energy diﬀerence εγ, given by

εγ = ǫγ

o − ǫγ
u,

H γ

0 = εγ ˆNγ,

and not on the individual orbital-energies, ǫγ

o and ǫγ

u. Therefore, we can choose (ǫγ

u = 0),

and so our only parameter is εγ. With this choice we have

where ˆNγ is the number operator for the occupied orbitals,

ˆNγ =

a†
waw,

Xw∈{ψo→γ}
and it gives the total number of occupied orbitals when acting on a single determinant. In

the one-particle Hilbert space, this operator is the projector for the occupied subspace –

spanned by {ψo→ γ} – or, the one-particle density-matrix operator:

Using the above two expressions, let us generalize the deﬁnition of ˆγ:

ˆNγ =

|ψwihψw| = ˆγ.

Xw∈{ψo→γ}

ˆγ =

a†
waw,

Xw∈{ψo→γ}

40

(213)

(214)

(215)

(216)

(217)

(218)

(219)

H γ

0 = εγ ˆγ.

H γ

0 = εγNγ + εγ{ˆγ},

E0[γ] = εγNγ,
{ˆoγ} = εγ{ˆγ},

ˆuγ = 0;

V γ
c = E1[γ] − εγNγ,
1 = { ˆFγ} − εγ{ˆγ}.
V γ

and write the zeroth-order Hamiltonian in a simpliﬁed form, given by

By normal-ordering this expression, we have

where Nγ is the number of particles within |Φ(γ)i, and from Eq. (195), we get the following

identities:

furthermore, our zero- and one-body portion of the perturbation, Eqs. (199a) and (199b),

have the following modiﬁed forms:

Eq. (224) indicates that the unoccupied operator, ˆuγ, represented by Eq. (201b), does
not appear in the expansion of the correlation-energy Eco; {ˆoγ}, represented by Eq. (201a)
and given by εγ{ˆγ}, is associated with a factor of εγ. Each diagram now becomes an explicit

functional of γ and κγ. For example, the second-order diagrams can be written in the

following manner:

= ε−1
γ

ˆFγ1γ(x1, x2) ˆFγ2κγ(x2, x1),

=

γ r−1
ε−1

12 r−1

34 γ(x1, x3)κγ(x3, x1)γ(x2, x4)κγ(x4, x2),

= −

γ r−1
ε−1

12 r−1

34 γ(x1, x3)κγ(x3, x2)γ(x2, x4)κγ(x4, x1),

1
4

1
4

41

(220)

(221)

(222)

(223)

(224)

(225a)

(225b)

(226)

(227)

(228)

(230)

(231)

(232)

(233)

where κγ is given by Eq. (212).

Fock operator is given by [2]:

In order to remove the explicit dependence on κγ, we ﬁrst note that the kernel of the

Fγ(x1, x2) = δ(x2−x1)

− 1

2 ∇2

2 + v(r2)

+δ(x2−x1)

23 γ(x3, x3) dx3−r−1
r−1

12 γ(x1, x2), (229)

or we can use its matrix representation from a complete basis set:

(cid:2)

(cid:3)

Z

Fγ(x1, x2) =

ψi(x1)hψi| ˆFγ|ψjiψ∗

j (x2).

ij
X
In any case, we use the following identity:

ˆFγ1α(x1, x2) =

d x3 Fγ(x1, x3)α(x3, x2),

Z

to modify Eq. (226), yielding

= ε−1

γ Fγ(x1, x3)γ(x3, x2)Fγ(x2, x4)κγ(x4, x1).

Using Eq. (212), this term becomes

ε−1
γ Fγ(x1, x3)γ(x3, x2)Fγ(x2, x4)κγ(x4, x1) =

The ﬁrst term on the right side reduces to

ε−1
γ

[Fγ(x1, x3)γ(x3, x2)Fγ(x2, x4)δ(x4 − x1) − Fγ(x1, x3)γ(x3, x2)Fγ(x2, x4)γ(x4, x1)] .

γ Fγ(x1, x3)γ(x3, x2)Fγ(x2, x4)δ(x4 − x1) = ε−1
ε−1

γ Fγ(x1, x3)γ(x3, x2)Fγ(x2, x1),

(234)

where Fγ(x2, x1) is given by Eq. (230), and not by Eq. (229), since this form of the Fock

kernel contains the laplacian ∇2, which is only deﬁned when acting upon a function. As

a possible alternative, the term on the left side of Eq (234) can be treated using the Fock

kernel, given by Eq. (229), and a representation of delta function that is convenient to

diﬀerentiate. This approach is probably more eﬃcient, since it avoids the sums over the

one-particle basis that appears in the matrix representation of the Fock kernel, Eq. (230).

The substitution for κγ(x4, x1) in Eq. (233) is applicable for any diagram. For example,

consider the second order (correction to the) energy, denoted by E2[γ], that is given by a

sum of the right sides of Eqs. (232), (227), and (228); where, using Eq. (212), it can be

written as a explicit functional of γ:

42

E2[γ] = ε−1
γ

Fγ(x1, x2)γ(x2, x3)Fγ(x3, x1) − Fγ(x1, x2)γ(x2, x3)Fγ(x3, x4)γ(x4, x1)

(235)

+ 1

4 ε−1

γ

h
r−2
12 γ(x1, x1)γ(x2, x2) − 2r−1
h

12 r−1

2
13 γ(x1, x1)|γ(x2, x3)|

+ r−1

12 r−1

i
2
2
|γ(x2, x4)|
34 |γ(x1, x3)|

− r−2

12 |γ(x1, x2)|2 + 2r−1

31 r−1

12 γ(x1, x2)γ(x2, x3)γ(x3, x1) − r−1

13 r−1

24 γ(x1, x2)γ(x2, x3)γ(x3, x4)γ(x4, x1)

.

i
The individual terms from Eq. (235), as well as higher-order terms, can be represented

by diagrams, where we write the Fock kernel in the following manner:

Fγ(x1, x2) = 1

2 ,

and the two terms from Eq. (233) are given by

= −ε−1

γ Fγ(x1, x2)γ(x2, x3)Fγ(x3, x4)γ(x4, x1),

δ

= ε−1

γ Fγ(x1, x2)γ(x2, x3)Fγ(x3, x4)δ(x4, x1).

(236)

(237a)

(237b)

These diagrams are evaluated by following the arrows in a backwards direction, where the

circled arrow in Eq. (237a) indicates that this line is not a particle line, but a hole one with

an additional factor of −1. This convention conforms to the one used for folded diagrams

in valence-universal multireference perturbation theory [53, 56, 74, 78, 79]. The δ–line in

Eq. (237b) yields a δ(x4, x1) factor; the integration over the x4 can be performed, as in

Eq. (234), and the resulting diagram can be represented by

= ε−1

γ Fγ(x1, x2)γ(x2, x3)Fγ(x3, x1),

(238)

where the sole purpose of the above internal line without an arrow is to preserve the dummy

index – in this case x1 – for the two vertices it connects.

The diagrams from Eqs. (238) and (237a) correspond to the ﬁrst two terms on the right

side of Eq. (235); the other terms are given by the diagrams from Fig. 1. The mirror-image

43

4

3

1

2

4

3

1

2

1

3

1

2

1

1

2

1

3

3

1

3

4

2

1

1

2

2

1

2

2

1

2

2

1

1

2

1

2

3

1

1

3

1

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

4

3

FIG. 1: Second-order correlation-energy Eco diagrams.

diagrams (b) and (c) are equivalent, or non-distinct. Therefore, one of them can be omitted

if a factor of 2 is included when evaluating the other one. Similarly, diagrams (f) and (g)

are also non-distinct, so one can be omitted. Higher-order, correlation-energy Eco diagrams

are obtained in a similar way.

It is well known that Eco is given by the set of connected diagrams, when (at least some

of) the exclusion principle violating (EPV) diagrams are included [51, 52, 53, 54, 55, 56, 71,

74, 75]. Diagrams (a) through (f) in Fig. 2 present examples of diagrams that contribute to

Eco. (Diagram (g) is disconnected and does not contribute.) When orbital degeneracy is not

imposed, the hole and particle lines in these diagrams correspond to γw and γr, respectively.

However, by imposing orbital degeneracy, as indicated by Eq. (220), and using Eq. (212),

these diagrams can be converted into ones that explicitly depend on γ, where the arrows

representing the particle lines are either deleted or circled, in all unique ways. Additional
diagrams containing the −εγ{ˆγ} (or −{ˆoγ}) interactions are generated by adding unﬁlled
arrows, as represented by Eqs. (201a) and (223), and including a factor of εγ for each one

appearing in a diagram, as well as the appropriate energy-denominators. For example, the

following sixth-order diagram is generated from diagram (a) from Fig. 2:

=

ε−3
γ γ(x1, x2)γ(x2, x3)γ(x3, x4)γ(x4, x5)Fγ(x5, x6)γ(x6, x1),

(239)

1
16

where the dummy index from the left-bottom vertex is x1. The above diagram contains

four hole-lines, one loop, and a circled particle-line, yielding, overall, a factor of +1.

In

addition, each one of the two unﬁlled-arrow interactions give a factor of εγ, and an energy-

denominator factor of 2εγ – since both interactions appears within a double excitation –
so overall a factor of (2εγ)−1εγ, or 1

2, is obtained for each of these interactions; in general,

44

(a)

(b)

(c)

(d)

(e)

(f)

(g)

FIG. 2: Examples of Eco and E(η)

co diagrams.

an unﬁlled-arrow interaction gives a factor of 1

In the above diagram, an additional factor of 1

n when appearing on a n–body excitation.
4ε−3
γ also appears from the remaining three

A discussion of perturbative convergence when imposing orbital degeneracies is presented

energy-denominators.

in Appendix C.

C. The correlation-energy functionals E(η)

co [γ]

We now brieﬂy discuss the diagrammatic representation of the correlation-energy func-

tionals E (η)

co ; the details are given elsewhere [57]. The diagrams for E (η)

co are a subset of the
correlation-energy Eco diagrams. Therefore, we continue to use the diagrams from Fig. 2

as examples, where, as mentioned previously, these diagrams can be converted into ones

that explicitly depend on γ; additional diagrams containing −εγ{ˆγ} interactions are easily

generated from the ones in the ﬁgure.

Comparing Eqs. (135) and (136), we see that the Eco diagrams that contribute to (H γ

1 Sγ

1 )cl,

1 )cl, do not contribute to E (I)

or ({ ˆFγ}Sγ
associated with H γ
Diagram (a) from Fig. 2 is an example of a (H γ

co , where these diagrams have a ﬁnal interaction,
1 , and a single-excitation below this last interaction, associated with Sγ
1 .

1 )cl diagram.

1 Sγ

Eqs. (136) and (133b) indicate that the E (II)

co diagrams are a subset of the E (I)

where diagrams contributing to ( 1
2 Sγ

Fig. 2 is an example of a ( 1

2H γ

1 Sγ

2H γ
1 Sγ

2 Sγ
1 )cl do not contribute to E (II)
1 )cl diagram [56, 74]; when the top H γ

2 interaction is
removed, the resultant diagram is disconnected – it possessing two pieces, where, using

co diagrams,
co . Diagram (b) in

the factorization theorem, it is easily demonstrated that each of these fragments contribute
to Sγ

co diagrams diagram that generates a disconnected diagram by

1 . In general, any E (II)

removing its top interaction is not a E (II)
1 Sγ
1 .

contributes to 1

2 Sγ

co diagram, and the resulting disconnected diagram

45

any E (II)

It is easily shown that the E (III)

co diagrams are a subset of the E (II)
co diagrams [57]. In general,
co diagram that has an intermediate single-excitation does not contribute to E (III)
co .
An example is given by diagram (c) in the ﬁgure. This diagram possesses a single-excitation

that appears in the second order. In other words, if we remove the top-two interactions, a

second-order, single-excitation diagram is produced.

Another type of E (II)

co diagram that does not contribute to E (III)
co
remove the top two interactions from this diagram we obtain a disconnected diagram com-

is diagram (d). If we

prised of two fragments – one fragment being a third-order single-excitation diagram and the

other one being a ﬁrst-order double-excitation diagram. In general, if we remove any of the

top interaction of a E (II)

fragments are single-excitation diagrams, the (parent) E (II)

co diagram and obtain a disconnected diagram, in which one or more
co diagram does not contribute to

E (III)
co .
Diagrams (e) and (f) contribute to E (II)

co . Diagram (e) is connected in each order; diagram

(f) is disconnected in the second order, but both fragments are double-excitation diagrams.

By including certain EPV diagrams, disconnected diagram can be excluded from the set

of diagrams that contribute to the ﬁrst three correlation-energy functionals: E (I)

co , E (II)

co , and

E (III)

co . However, disconnected diagrams, like diagram (g), do contribute to E (IV)

co ; the set of

diagrams representing E (IV)

excludes diagrams with intermediate single-excitations, and this

co

omission removes certain disconnected diagrams that are needed to invoke the factorization

theorem and obtain a linked diagram expansion.

IX. TREATMENT OF THE EXTERNAL POTENTIAL

A.

External potential dependence on Eco and E(η)
co

Density functional theory employs a universal exchange-correlation functional, indepen-

dent of the external potential, permitting approximations to be derived from model systems,

where, in the vicinity of the model systems, the general form of the exchange-correlation

functional is known. In contrasts, our correlation-energy functionals depend on the external

potential v(r): E (η)

partitioning E (η)

co [γ, v], and are, therefore, in this sense, not universal. Nevertheless, by
co [γ, v] into individual terms that are – to a varying degree – universal, we

can also obtain approximations from model systems.

46

In order to pursue this approach, and partition E (η)

co [γ, v], we ﬁrst partition the Fock-

operator, given by Eq. (176), into two terms:

where ˆF g

γ is the Fock operator for an electron gas:

ˆFγ = ˆF g

γ + v,

ˆF g

γ = − 1

2∇2 + Jγ − Kγ,

and this operator is independent of the external potential v. Using this partitioning, the
one-body part of the perturbation V γ

1 , given by Eq. (199b), can be written as

where the normal-ordered, uncontracted portions of ˆF g

γ and v have the following forms:

1 = { ˆF g
V γ

γ } + {v} − {ˆoγ} − ˆuγ,

{ ˆF g

γ } =

[i| ˆF g

γ |j]{a†

i aj},

ij
X

{v} =

[i|v|j]{a†

i aj}.

ij
X
The correlation energy and our correlation-energy functionals, Eco[γ, v] and E (η)

co [γ, v], have
a dependence on the external potential v that arises, exclusively, from the {v} contribution
to V γ
V γ
1 is partitioned into three terms, given by Eq. (199b). We now consider an approach where

1 , as indicated in Eq. (242). In the diagrammatic treatment presented in Sec. VIII B,

we partitioned it into the four terms, given by Eq. (242).

The diagrammatic representations of −{ˆoγ} and −{ˆuγ} are given by Eqs. (201); the

other two terms from Eq. (242) use the following:

(240)

(241)

(242)

(243)

(244)

(245a)

(245b)

For simplicity, in this section, we consider diagrammatic examples that do not distinguish
between the various functionals, do not contain −{ˆoγ} and −{ˆuγ} insert, and do not explic-
itly depend on γ. For example, diagrams (a) through (d) in Fig. 3 are simple examples of

{ ˆF g

γ } =

{v} =

,

.

47

(a)

(b)

(c)

(d)

(e)

FIG. 3: Fourth-order Eco and E(η)

co diagrams.

fourth-order diagrams that contain the { ˆF g

γ } and {v} operators. These diagrams contribute
to the correlation energy Eco[γ, v], and any of the correlation-energy functionals E (η)
co [γ, v].
Diagram (e) is the corresponding diagram that uses the { ˆFγ} operator, given by Eq. (200a).
All four diagram, (a) through (d), can be obtained from diagram (e) by replacing the { ˆFγ}
operators with the { ˆF g
γ } and {v} operators in all unique ways; the sum of diagrams (a)
through (d) is equal to diagram (e). In general, all diagrams containing { ˆF g
γ } and {v} can
be obtained from the { ˆFγ} diagrams by using this approach. A similar procedure can be

used when adding an additional perturbation [56].

B. Electron gas terms

Note that the diagrams from Fig. 3 can be partitioned into one that does not depend on

the external potential v, diagram (a) in the ﬁgure, and the remaining ones that do depend on
v. This is a general result when using the partitioned Fock operator ˆFγ, given by Eq. (240);

therefore, the correlation energy Eco[γ, v], and the correlation-energy functionals E (η)

co [γ, v],

can be divided in the following manner:

Eco[γ, v] = E (0)

co [γ] + E (1+)

co

[γ, v],

E (η)

co [γ, v] = E (η,0)

co

[γ] + E (η,1+)

[γ, v],

co

(246a)

(246b)

where E (0)

co [γ] and E (η,0)

co

[γ] are universal functionals of γ, independent of the external po-

tential; they are given by the sum of diagrams that do not contain {v} inserts; including

diagram (a) in the ﬁgure, and the second-order Coulomb and exchange diagrams, given by

Eqs. (207b) and (207c). The remaining diagrams of Eco[γ, v] and E (η)

co [γ, v] contribute to

E (1+)
co

[γ, v] and E (η,1+)

[γ, v], respectively, including diagrams (b) through (d) in the ﬁgure.

We refer to E (0)

[γ] as electron-gas terms, since, for an electron gas, v is

co
co [γ] and E (η,0)

co

48

constant, so {v} is zero, and we have the following:

Eco[γ] = E (0)

co [γ],

E (η)

co [γ] = E (η,0)

co

[γ].




(electron gas)

(247a)

(247b)


From Eq. (78), the terms on the left sides of Eqs. (247) are equal when γ is the one-particle

density-matrix for the Brueckner state; hence, we have

E (η,0)
co

[τg] = E (0)

co [τg],

where τg is the Brueckner-state one-particle density-matrix for an electron gas. For future

use, we denote the correlation energy of an electron gas by E (gas)

[γ]; explicitly, we have

co

E (gas)
co

[γ] = Eco[γ, v],

for v = constant,

so, using Eq. (247a), Eq. (248) can be written as

E (η,0)
co

[τg] = E (gas)

[τg].

co

C. Atomic and molecular terms

In order to further generalize Eqs. (246), we partition the external potential into its

individual components:

where vm(r) is the external potential from the mth nuclear point-charge at Rm:

and we choose the following diagrammatic representation for this operator:

v =

vm,

m
X

vm(r) = −

Zm
|Rm − r|

,

{vm} = m

.

Using the decomposition of v, given by Eq. (251), the one-body part of the perturbation

V γ
1 , Eq. (242), becomes

1 = { ˆF g
V γ

γ } +

{vm} − {ˆoγ} − {ˆuγ},

m
X

49

(248)

(249)

(250)

(251)

(252)

(253)

(254)

(m 6= n)

m

n

m

m

m

m

(a)

(b)

(c)

(d)

m

n

p

(e)

FIG. 4: Eco and E(η)

co diagrams with v components.

permitting us to generalize Eqs. (246) in the following manner:

Eco[γ, v] = E (0)

co [γ] +

co [γ, vm] + E (2+)
E (1)

co

[γ, v],

E (η)

co [γ, v] = E (η,0)

co

[γ] +

E (η,1)
co

[γ, vm] + E (η,2+)

[γ, v],

co

(255a)

(255b)

m
X

m
X
co [γ, vm] and E (η,1)

co

where the atomic terms, E (1)

[γ, vm], depend on vm; they are the sum of all

diagrams that contain one or more {vm} inserts, but have no inserts from other external-

potential components, say {vn}, where (n 6= m). For example, diagrams (b), (c), and (d)

from Fig. 4 contribute to E (1)

co [γ, vm] and E (η,1)

co

[γ, vm]. These diagrams are generated from the

corresponding diagrams in Fig. 3 by replacing all the external-potential inserts, {v}, given

by Eq. (245b), with the individual components, {vm}, given by Eq. (253).

The remaining diagrams contribute to E (2+)

[γ, v] and E (η,2+)

[γ, v]. These diagrams have

co

co

two or more inserts from diﬀerent external-potential components, e.g., diagrams with both

{vm} and {vn} inserts, where (m 6= n). Diagram (a) in the ﬁgure is an example of a E (2+)

[γ, v]

co

or E (η,2+)
co

[γ, v] diagram. Diagram (e) is also a E (η,2+)

[γ, v] diagram, unless (m = n = p), where

co

it then contributes to E (1)

co [γ, vm] and E (η,1)

co

[γ, vm].

For an atomic system we only have a single nucleus, and we get

Eco[γ, v] = E (0)

co [γ] + E (1)

co [γ, vm],

E (η)

co [γ, v] = E (η,0)

co

[γ] + E (η,1)

co

[γ, vm].

(atomic systems)

(256a)

(256b)






The atomic terms, E (1)

co [γ, vm] and E (η,1)

co

[γ, vm], are – for a range of systems – universal

functionals: They contribute to Eco[γ, v] and E (η)

a charge of Zm. Note that two atomic tems, say E (1)

co [γ, v] for any system with a nuclei with
co [γ, vm′], are the same
functionals when they are from the same nuclei (Zm = Zm′), but they are expressed from

co [γ, vm] and E (1)

diﬀerent nuclear locations, since we have (Rm 6= Rm′).

50

Factoring Zm from the diagrams, we get the following expansions:

co [γ, vm] = ZmE (1)
E (1)

co(1)[γ] + Z 2

mE (1)

co(2)[γ] + Z 3

mE (1)

co(3)[γ] + . . . ,

E (η,1)
co

[γ, vm] = ZmE (η,1)

co(1)[γ] + Z 2

mE (η,1)

co(2)[γ] + Z 3

mE (η,1)

co(3)[γ] + . . . ,

(257a)

(257b)

where E (1)

co(i)[γ] and E (η,1)

co(i)[γ] are universal functionals, independent of Zm; they are given

by the sum of all diagrams with i inserts of {vm}, with (Zm = 1). For example, diagrams

diagrams (b) and (c) from Fig. 4 contribute to E (1)

have a single insert; diagram (d) contributes to E (1)

co(1)[γ] and E (η,1)
co(2)[γ] and E (η,1)

co(1)[γ], for (Zm = 1), since they

co(2)[γ]; diagram (e) contributes

to E (1)

co(3)[γ] and E (η,1)
Further generalizing Eqs. (255), we have the following external-potential expansions:

co(3)[γ], if (n = p = m).

Eco[γ, v] = E (0)

co [γ] +

E (1)
co [γ, vm] +

E (2)
co [γ, vm, vn] + . . . ,

(258a)

E (η)

co [γ, v] = E (η,0)

co

[γ] +

E (η,1)
co

E (η,2)
co

[γ, vm, vn] + . . . ,

(258b)

m
X

m
X

m>n
X
[γ, vm] +

m>n
X

where the diatomic terms, E (2)

co [γ, vm, vn] and E (η,2)

co

[γ, vm, vn], depend on vm and vn; they are

the sum of all diagrams that contain one or more {vm} and {vn} inserts, but have no inserts

from other external-potential components, say {vp}, where (p 6= m) and (p 6= n). They are

universal functionals for any system with one or more nuclei with charges of Zm and Zn,

but, in addition, they also depend on the molecular geometry – the distance between the

charges. Diagrams (a) from Fig. 4 is one example. By factoring the Zm and Zn terms from

the diagrams, analogous expansions, as in Eqs. (257), can also be obtained. Triatomic and

molecular terms are deﬁned in a similar manner.

X. APPROXIMATIONS

The diagrammatic methods presented in Sec. VIII, and in the previous section, gives

explicit expansions for the functionals Eco[γ, v] and E (η)

co [γ, v], and for the terms on the right
side of Eq. (258). However, in the approximations we consider below, we often assume

that these functionals can be expressed in a more simpliﬁed form, for example, as integrals

involving the coordinates of only two electrons:

Eco[γ, v] =

Gco(x1, x2) dx1 dx2,

E (η)

co [γ, v] =

G(η)

co (x1, x2) dx1 dx2,

(259a)

(259b)

1
2
1
2

Z Z

Z Z

51

where the integrands, Gco(x1, x2) and G(η)

co (x1, x2), explicitly depends upon γ(x1, x2),
γ(x2, x1), v(r1), and v(r2), and can include gradients or higher-order derivatives, e.g.,

∇2

1γ(x1, x2).
If E (0)

co and E (η,0)

co

approximations are the following:

are known for a model, one-particle, density-matrix, say γm, then possible

If γm is equal to, or similar to, the Brueckner-state one-particle density-matrix for an electron

gas τg, then, from Eqs. (250) and (261), we get the following approximation:

co [γ] = E (0)
E (0)

co [γm](γm=γ),

E (η,0)
co

[γ] = E (η,0)

co

[γm](γm=γ).

E (η,0)
co

[γ] ≈ E (gas)

co

[τg](τg =γ).

(260)

(261)

(262)

If periodic boundary conditions are used, the Brueckner orbitals are known to be plane

waves [2, 54, 85, 90, 91], so τg is known. Because of conservation of momentum, there are

many diagrams that are absent in the E (gas)

[τg] expansion [54, 85, 90, 91], but, in general,

these diagrams appear in the expansion of E (gas)

[γ]. Since, apparently, all of these excluded-

co

co

diagrams are also excluded in the E (III,0)

[γ] expansion, the above approximation, Eq. (262),

co

is probably most appropriate for (η = III):

E (III,0)
co

[γ] ≈ E (gas)

co

[τg](τg =γ).

(263)

For systems with a non-constant external potential, E (η,0)

[γ] is, in many instances, the

co

dominant portion of E (η)

co [γ, v]. In that case, we can neglect all terms except the electron gas
one from Eq. (258b), and using Eq (263), we get the following electron-gas approximation:

E (III)

co [γ] ≈ E (gas)

co

[τg](τg =γ),

(264)

where, in this approximation, the dependence on v is neglected.

Eq. (264) shares many similarities with the LDA of density-functional theory [1, 2, 7],

where this approach constructs approximate energy-functionals from expressions derived

from a uniform electron gas. If periodic boundary conditions are used, the Brueckner orbitals

(and the Hartree–Fock ones) are known to be plane waves [54, 91], so τg is known. If, in

addition to requiring the volume to be inﬁnitely large, the number of particles becomes

inﬁnite, a uniform electron gas is obtained. In this limiting case, the density of the Brueckner

52

reference-state |Θi, say ρug, is identical to the density of the target state |Ψi, both being

a constant; the correlation energy of a uniform electron gas, say E (gas)

(ρug), is a function

co

of this density, not a functional [54, 85, 90, 91]. In the LDA a functional is constructed

using the function E (gas)

(ρug) divided by the number of electrons – the correlation energy

co

per particle. An analogous approach may be necessary when constructing the functional

E (gas)
co

[τg](τg =γ), although the one-particle density matrix for an electron gas is not a constant

[2, 54, 91]. Furthermore, when evaluating the diagrams for E (gas)

(ρug), as in the random

co

phase approximation (RPA) [54, 85, 90, 91], the summations over the occupied, plane-wave

states are replaced by integrals. For an exact treatment of E (gas)

[τg], this approach cannot be

co

used, and, mathematically speaking, this is the diﬀerence between E (gas)

[τg] and E (gas)

(ρug).

co

co

In using the above electron gas approximation, Eq. (264), or other similar approximations,

especially for atoms or molecules, one must take into consideration the boundary conditions

imposed on the wavefunction. For example, if the wavefunction for an electron gas is required

to vanish at the end points of a cube – and the cube has a ﬁnite size – this may lead to

an electron gas functional E (gas)

co

[τg](τg =γ) that explicitly depends on the boundary conditions.

However, probably in many cases, this explicit dependents can be transformed, or contained

within τg, since τg also depends on the boundary conditions.

We have, so far, used the external-potential expansions, Eqs. (258), to obtain approximate

functionals. An alternative approach is obtained, if E (η)

co [γ, v] is known for some system, say
the helium atom, in the vicinity of some one-particle density-matrix, say the Brueckner one.

In that case, the following prescription yields an approximate correlation-energy functional:

E (η)

co [γ, v] ≈ E (η)

co [τhe, vhe](τhe=γ, vhe=v),

(265)

where τhe is the Brueckner, one-particle, density-matrix for the helium atom, and vhe is the

external potential for this system, where using Eq. (78), we have

E (η)

co [γ, v] ≈ Eco[τhe, vhe](τhe=γ, vhe=v).

(266)

In the limit of ρ −→ τx, necessarily, many terms from Eco[τx, vx] must vanish, where vx is

the external potential associated with the Brueckner one-particle density matrix, τx. Since,

apparently, all of these vanishing-diagrams are also excluded in the E (III,0)

[γ, vx] expansion,

co

most probably, the above approximation, Eq. (266), is most appropriate for (η = III).

53

(267)

(268)

(269)

(270)

Furthermore, since the Brueckner density matrix τhe is approximately equal to the Hartree–

Fock one, say ˜τhe, we can write

E (III)

co [γ, v] ≈ Eco[˜τhe, vhe](˜τhe=γ, vhe=v).

Using the expansion for Eco, given by Eq. (258a), and neglecting all terms except the electron

gas one, we get

E (III)

co [γ, v] ≈ E (0)

co [˜τhe](˜τhe=γ).

The above approximation assumes that the terms arising from the helium potential vhe are

small; therefore, including them in the following way should yield only a small error:

A well known approximation for Eco[˜τhe, vhe] is given by Colle and Salvetti functional

[18, 19], say E cs

co[˜τhe]; so we have

E (III)

co [γ] ≈ Eco[˜τhe, vhe](˜τhe=γ).

E (III)

co [γ] ≈ E cs

co[˜τhe](˜τhe=γ),

where we have suppressed any mention of vhe, since this functional has no explicit dependence

on the external potential. However, this functional can still possess an implicit dependence

on vhe, since, for example, its four empirical parameters are determined by using data from

the helium atom. An improved functional, perhaps, can be obtained by appending a poten-

tial dependence on these parameters and using the approximation given by Eq. (267).

the correlation-energy functionals E (η)

We also mention that the correlation potentials vτ

co can be treated in a similar manner as
co [γ, v], since they also depend on the external potential:
co[v]; Equations, or approximations, analogous to Eqs. (258b), (257b), (264), and (265),
vτ
are easily deﬁned. However, we now pursue a diﬀerent approach, permitting correlation

potentials to be obtained as functional derivatives of variation correlation-energy functionals.

XI. VARIATIONAL FORMALISM

We now introduce variational energy-functionals ¯Eη[γ]. By functional diﬀerentiating these

functionals with respect to the one-particle density-matrix γ, generalized Fock operators are
obtained. These operators – denoted by ˆζ (η)
τ

– satisfy the same Brillouin-Brueckner and

54

commutation relations, Eqs. (187a) and (188), as the corresponding non-variational ones,
ˆF (η)
τ

.

Using our trial wavefunctions from Sec. (V), we can construct variational energy-

where the ﬁrst-order energy E1[γ] is given by Eq. (172), our variational correlation-energy

functionals:

functionals are

¯Eη[γ] =

hΨ(η)

γ |H|Ψ(η)
γ i
γ |Ψ(η)
hΨ(η)
γ i

= E1[γ] + ¯E (η)

co [γ],

¯E (η)

co [γ] =

hΨ(η)

γ |({ ˆFγ} + {r−1
12 }γ)|Ψ(η)
γ i
γ |Ψ(η)
hΨ(η)
γ i

,

and we have used Eqs. (123), (124a) and (192). We also deﬁne exchange-correlation (xc)

energy-functionals:

¯E (η)

xc [γ] = ¯E (η)

co [γ] − Ex[γ],

where the exchange energy Ex[γ] is given by Eq. (174).

The exact energy is also given by

E =

hΨ|H|Ψi
hΨ|Ψi

= E1[γ] +

hΨ|({ ˆFγ} + {r−1

12 }γ)|Ψi

.

hΨ|Ψi

Comparing this Eq. to Eq. (10) gives

Eco[γ] =

hΨ|({ ˆFγ} + {r−1

12 }γ)|Ψi

,

hΨ|Ψi

From the variational theorem, the fourth-trial wavefunctions are equal:

and we have

From the variational theorem, we also have

¯EIV[γ] = EIV[γ],

¯E (IV)

co [γ] = E (IV)

co [γ].

¯Eη[γ] ≥ E,

where Eqs. (71), (274), (275), (271), (273), and (22) give the following equalities that appear

for the Brueckner one-particle density-matrix τ :

(271)

(272)

(273)

(274)

(275)

(276)

(277)

(278)

(279)

(280)

(281)

E = ¯Eη[τ ] = Eη[τ ],

Eco[τ ] = ¯E (η)

co [τ ] = E (η)

co [τ ],

Exc[τ ] = ¯E (η)

xc [τ ] = E (η)

xc [τ ],

55

where the latter relations use Eqs. (77), (78), and (79); Eqs. (278) and (279) indicate that
the minimization of ¯Eη[γ] occurs at τ .

We now pursue, in a formal way, the minimization of ¯Eη[γ], using an approach that is

similar to the procedure used by Parr and Yang [2] in their treatment of Hartree–Fock theory,
where ¯Eη[γ] is subject to the constraint that the one-particle density-matrix comes from a
single-determinantal state γ(|Φi). This condition is imposed by requiring the one-particle

density-matrix γ to have a trace equal to the number of electrons Nγ, and that it is also

idempotent [49, 50]:

γ(x3, x4)δ(x4 − x3) dx3 dx4 = Nγ,

γ(x3, x5)γ(x5, x4) dx5 = γ(x3, x4).

Z Z

Z

The normalization constraint, Eq. (282), insures that γ can be constructed from Nγ orbitals;

Eq. (283) insures that the density-matrix operator ˆγ – when acting within the one-particle

Hilbert space – is a projector into the occupied subspace, as indicated by Eq. (169), where

γ serves as the kernel of the one-particle density-matrix operator ˆγ, Eq. (180).

Using the above constraints, the variational problem is expressed by

where

δL(γ)|τ = 0,

L(γ) = ¯Eη[γ] − β

γ(x3, x4)δ(x4 − x3) dx3 dx4 − Nγ

(cid:20)Z Z

(cid:21)

−

dx3 dx4 α(x4, x3)

γ(x3, x5)γ(x5, x4) dx5 − γ(x3, x4)

,

Z Z

(cid:20)Z

and where α and β are the Lagrangian multipliers. Eq. (284) is satisﬁed when the functional

derivative of L vanishes:

τ
(cid:12)
(cid:12)
where the deﬁnition of the functional derivative is
(cid:12)
(cid:12)

δL(γ)
δγ(x2, x1)

= 0,

δL(γ) =

Z Z

δL(γ)
δγ(x2, x1)

δγ(x2, x1)dx1 dx2.

56

(282)

(283)

(284)

(285)

(cid:21)

(286)

(287)

Substituting Eq. (285) into (286), yields

ζ (η)
τ (x1, x2) −

dx3 [τ (x1, x3)α(x3, x2) + α(x1, x3)τ (x3, x2)] + α(x1, x2) − βδ(x1 − x2) = 0,

Let the two-body functions, α(x1, x2) and ζ (η)

τ (x1, x2), serve as kernels of operators, ˆα

and ˆζ (η)

τ ; explicitly, we have

Z

where

ζ (η)
τ (x1, x2) =

δ ¯Eη[γ]
δγ(x2, x1)

.

τ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ˆαφ(x1) =

α(x1, x2)φ(x2) dx2,

ˆζ (η)
τ φ(x1) =

ζ (η)
τ (x1, x2)φ(x2) dx2.

Z

Z

ˆζ (η)
τ − ˆτ ˆα − ˆαˆτ + ˆα − β = 0,

Using this notation, the operator form of Eq. (288) is given by

where ˆτ is deﬁned by Eq. (184).

The identity operator ˆI, deﬁned by Eq. (179), or expressed by

can be used to obtain the following relation:

ˆI = ˆτ + ˆκτ ,

ˆα − ˆτ ˆα − ˆαˆτ = ˆI (ˆα − ˆτ ˆα − ˆαˆτ ) ˆI = ˆκτ ˆαˆκτ − ˆτ ˆαˆτ ,

which we substitute into Eq. (292); this procedure gives

ˆζ (η)
τ − ˆτ ˆαˆτ + ˆκτ ˆαˆκτ − β = 0,

and yields the following requirements:

where we have dropped the η superscript since, for (γ = τ ), all operators are equal within

these blocks:

(288)

(289)

(290)

(291)

(292)

(293)

(294)

(295)

(296a)

(296b)

(297a)

(297b)

ˆκτ ˆζτ ˆτ = 0,

ˆτ ˆζτ ˆκτ = 0,

ˆκτ ˆζ (η)

τ ˆτ = ˆκτ ˆζ (η′)
τ ˆκτ = ˆτ ˆζ (η′)

τ ˆτ = ˆκτ ˆζτ ˆτ ,
τ ˆκτ = ˆτ ˆζτ ˆκτ .

ˆτ ˆζ (η)

57

Eq. (296a) is yet another representation of the Brillouin–Brueckner condition; comparing

Eqs. (187) and (296) give

and it is easily veriﬁed that the commutation relation, Eq. (188), also holds for the variational
one-body operators ˆζτ :

An alternative to the exact Hartree–Fock Eq. (189) is

ˆκτ ˆζτ ˆτ = ˆκτ ˆFτ ˆτ ,

ˆτ ˆζτ ˆκτ . = ˆτ ˆFτ ˆκτ ,

= 0.

ˆζτ , ˆτ
h

i

ˆζ (η)
τ |ψwi =

ξ τ η
xw|ψxi,

Xx∈{ψo→τ }

where the appended η superscripts appear since the occupied-block matrix-elements ξ τ η
xw,
perhaps, depend on η. However, we can redeﬁne the variational operators ˆζ (η)
τ
this dependence, since Eqs. (296) still holds. In any event, we assume that ˆζ (η)
τ

is independent

to remove

of η and choose orbitals that diagonalize ξ τ

xw, giving a generalized Hartree-Fock Eq. that is

an alternative to Eq. (167):

Substituting Eq. (271) into (289) for (τ = γ) gives

ˆζτ ¯ψτ

i (x) = ξ τ
i

¯ψτ

i (x).

γ (x1, x2) = Fγ(x1, x2) + ν γη
ζ (η)

co (x1, x2),

where Fγ(x1, x2) and ν γη

co (x1, x2) are the kernel of the Fock operator ˆFγ – deﬁned by Eq. (229)

– and variational correlation-potentials ˆν γη
co :

The operator form of Eq. (302) is

Substituting this Eq. into Eq. (297) indicates that we have

Fγ(x1, x2) =

ν γη
co (x1, x2) =

δE1[γ]
δγ(x2, x1)
δ ¯E (η)
co [γ]
δγ(x2, x1)

,

.

ˆζ (η)
γ = ˆFγ + ˆν γη
co .

ˆκτ ˆν τ η

co ˆτ = ˆκτ ˆν τ η′
co ˆκτ = ˆτ ˆν τ η′

co ˆτ = ˆκτ ˆν τ
co ˆκτ = ˆτ ˆν τ

coˆτ ,
coˆκτ .

ˆτ ˆν τ η

58

(298a)

(298b)

(299)

(300)

(301)

(302)

(303)

(304)

(305)

(306a)

(306b)

Substituting Eqs. (305) and (191) into (298) and using the two above deﬁnitions, yields

ˆκτ ˆν τ

coˆτ = ˆκτ vτ
coˆκτ . = ˆτ vτ

coˆτ ,
coˆκτ .

ˆτ ˆν τ

(307a)

(307b)

τ (x1, x2), given by
In order acquire to the kernels of the generalized Fock operators ζ (η)
Eq. (302), it is necessary obtain the functional derivatives of E1[γ] and ¯E (η)
co [γ], as indicated
by Eq. (303) and (304). The functional derivative for E1[γ] can be evaluated using Eqs. (172),

(173), and (174), yielding Eq. (229). The functional derivative of the diagrammatic terms of
¯E (η)

co [γ] can also be obtained; the details are presented elsewhere [57]. Here we only mention
that by imposing the same occupied and virtual orbital degeneracies as in Sec. VIII B, each

diagram in the expansion is given by a product of one-particle density-matrices, and can,

therefore, be diﬀerentiated in the same manner as in the treatment of E1[γ]. After the

functional derivative is taken, the nondegeneracy of the orbitals can be restored, since the

entire expansion is invariant to the choice of orbital energies, but this removes the explicit

dependence on γ for each term.

Eq. (258b), also holds:

It is easily demonstrated that an analogous external-potential expansion, as given in

¯E (η)

co [γ, v] = ¯E (η,0)

co

[γ] +

¯E (η,1)
co

[γ, vm] +

¯E (η,2)
co

[γ, vm, vn] + . . . .

(308)

m
X

m>n
X

Furthermore – by using, Eqs. (279), (280) and (281) – all approximations presented in Sec. X

are valid when E (η)

co is replaced by ¯E (η)
Eq. (264), and the Colle–Salvetti functional, Eq (270):

co . For example, consider the electron-gas approximation,

¯E (III)

co [γ] ≈ E (gas)

co

[τg](τg =γ),

¯E (III)

co [γ] ≈ E cs

co[˜τhe](˜τhe=γ).

(309)

(310)

Assuming both approximations are reasonable ones, we can use a linear combination of the

two:

¯E (III)

co [γ] ≈ acE cs

co[˜τhe](˜τhe=γ) + (1 − ac)E (gas)

co

[τg](τg =γ),

(311)

where ac is an empirical parameter. This Eq. is an alternative to the B3LYP functional [8, 17]

which uses analogous correlation-energy functionals: They use the LYP correlation-energy

functional [18], derived from Colle–Salvetti one E cs

co, and a uniform-electron-gas functional,

derived from the RPA [92]; they set (ac = 8.1).

59

XII. ACKNOWLEDGMENTS

The author thanks Peter Pulay, Kimihiko Hirao, and Karl Freed for useful discussions.

This work was initiated while at the University of Lund, Department of Theoretical Chem-

sitry, Sweden; the author thanks Bj¨orn Roos for useful discussions and suggesting this area of

research. This work was supported by the Air Force Oﬃce of Scientiﬁc Research under grant

No. F49620-00-1-0281, the National Science Foundation under grant No. CHE0111101, the

Japanese Society for the Promotion of Science (JSPS), Swedish Natural Science Research

Council (NFR), and an Internal Research Grant at Eastern New Mexico University.

APPENDIX A: VARIATIONAL BRUECKNER-ORBITAL FORMALISMS

In the exact SCF theory by L¨owdin [26], an orbital variation of an energy functional is

used to derive the Brillouin–Brueckner condition. By using a slight modiﬁcation of Kobe’s

formulation [38], L¨owdin’s energy-functional can be written in the following manner:

Eη[Θ, Φ] = hΦ| ˆH Θ

eﬀ|Φi = hΦ|(H Θ

0 + tΘ)|Φi,

(A1)

where tΘ, or VΘΩΘ, is the reaction operator, which we also deﬁne above by the eﬀective
Hamiltonian ˆH Φ

eﬀ; by deﬁnition, this operator satisﬁes the following relation:

E = hΦ| ˆH Φ

eﬀ|Φi = hΦ|HΩΦ|Φi, = hΦ|H (1 + χΦ) |Φi,

(A2)

and it acts only within the one-dimensional reference-space, with projector PΦ: ( ˆH Φ
PΦ ˆH Φ

eﬀ =
eﬀPΦ); the wave operator ΩΦ and correlation operator χΦ are given by Eqs. (5) and
(19). As in valence-universal multireference perturbation theory [56, 74, 75, 78, 79, 93, 94],
ˆH Φ

eﬀ can be written as a sum of constant, one-, two- and higher-body excitations, where the

vacuum state is at our disposal.

By varying the occupied orbitals from the reference state |Φi, i.e., {ψo→ Φ}, L¨owdin

and Kobe derived a form of the Brillouin–Brueckner condition, indicating that the above
functional Eη[Θ, Φ] – when ˆH Θ

eﬀ is held constant – satisﬁes a variational condition that
yields the exact energy at the extremum: (E = Eη[Θ, Θ]), where the reference state is

the Brueckner one, |Θi. A modiﬁed version of L¨owdin and Kobe’s formulation involving a

one-particle density matrix approach, instead of an orbital one, is easily derived [57].

60

A generalization of L¨owdin and Kobe’s theory, by Brueckner and Goldman [95], minimizes

the following functional: Eη[Φ, Φ], given by the right side of Eq. (A2). Such an approach

has been criticized, since this functional is invariant to the reference state |Φi, and its a
constant – the exact energy E; also, if an approximate ˆH Φ

eﬀ is used, the energy functional
does not satisfy the Rayleigh-Ritz principle, as pointed out by Brandow [78]. This method

leads to the so-called rearrangement potential [95, 96] that arises from the variation of the

term involving the reaction operator tΦ. (For further references regarding the rearrangement

potential and an historical account of Brueckner orbital theory, see the bibliography notes

within Kobe’s article [38].)

Another variant of the energy functional Eη[Φ, Φ], replaces the correlation operator χΦ

with χη

Φ in the right side of Eq. (A2); this energy functional is simply the non-variational
one Eη[Φ], as indicated by Eq. (130). L¨owdin and Kobe’s exact SCF theory is obtained by

using χη

Θ and not permitting it to vary, where from Eq. (132) we have (χη

Θ = χΘ).

APPENDIX B: PARTITIONING OF SECOND QUANTIZED OPERATORS

Any second quantized operator, say ˆO, can be partitioned into open (op) and closed (cl)

portions with respect to a single- or multi-reference space [56, 97, 98]. In our case, where
the reference space is only spanned by a single-determinantal state, the closed portion of ˆO,
say ˆOcl, is simply a constant – as in Eqs. (17) and (18) – and is given by the fully contracted
part of ˆO, where the operator is written in normal-ordered form with respect to the reference

state |Φi [55, 56, 60, 61]. Explicitly, we have

ˆOcl = ˆO0 = hΦ| ˆO|Φi,

(B1)

where the 0 subscript indicates the zero-body term.

The open portion of ˆO, say ˆOop, is usually deﬁned as the remaining portion; it is given

by the one-, two- and higher-body terms, where, again, the operator is written in normal-
ordered form. However, for our purposes, we use a more restrictive deﬁnition for ˆOop, and

deﬁne it by the following conditions:

ˆOop|Φi = QΦ ˆO|Φi,

ˆOopQΦ = 0.

61

(B2)

(B3)

We deﬁne the remaining portion, ˆOre, by the following:

so the following identities are satisﬁed:

ˆO = ˆOcl + ˆOop + ˆOre,

( ˆOcl + ˆOop)|Φi = ˆO|Φi,

ˆOre|Φi = 0.

The remaining portion ˆOre has at least one hole or particle annihilation-operator. ˆOop has

at least one pair of hole-particle creation-operators and no hole or particle annihilation-
operators. In terms of diagrams, ˆOre has at least one external line below the vertex; ˆOop
has no lines below the vertex and at least one pair of externals lines above it; ˆOcl has no

external free-lines.

partition one-body operators, say ˆh,

As an alternative to the above normal-ordered partitioning, we ﬁnd it convenient to

into the following four components:

ˆh =

ˆhij,

ij
X

ˆh = ˆhex + ˆhde + ˆhoc + ˆhun,

where the excitation (ex), de-excitation (de), occupied (oc), and unoccupied (un) parts are

given by the following expressions:

ˆhex =

ˆhde =

ˆhoc =

hrwa†

raw,

hwra†

war,

hwxa†

wax,

ˆhun =

hrsa†

ras.

wr
X

wr
X

wx
X

rs
X

ˆhex = ˆhop.

62

and the orbitals are deﬁned with respect to a reference state |Φi, as indicated by Eqs. (6).

Note that the open and excited portions are identical:

(B4)

(B5)

(B6)

(B7)

(B8a)

(B8b)

(B8c)

(B8d)

(B8e)

(B9)

APPENDIX C: DISCUSSION OF PERTURBATIVE CONVERGENCE WHEN

USING ORBITAL DEGENERACIES

Our primary reason for choosing orbital degeneracies within the occupied and virtual

subspaces is that it provides a means of obtaining an explicit dependence on the one-particle

density-matrix γ for the individual perturbative terms (the diagrams) that represent the

correlation energy Ec[γ] and correlation-energy functionals E (η)

co [γ]. While this choice greatly
restricts the zeroth-order Hamiltonian, it can still yield convergent series for ground states,

as long as the parameter εγ is chosen to be suﬃciently large, and negative, so that the

dominant conﬁgurations do not become intruder-states from the presence of small-energy

denominators or incorrect energy ordering, as in the case for multireference perturbation

theory [93, 99, 100, 101, 102, 103]. However, because of incorrect energy-ordering [101]

it is probably not possible to generate convergent expansions for excited states. However,

inﬁnite-order summation methods [71, 93, 104, 105, 106] can be attempted, or the series can

be asymptotically convergent.

Consider a suitable partitioning method, like, for example, Møller–Plesset [70, 107, 108,

109], Epstein-Nesbet [110, 111, 112], or maximum radius of convergence (Rc) perturbation

theory [113, 114]. Any of these approaches generate a separate energy-denominator for each
0 − Eq
orthogonal-space state |qi, say (∆q = EΦ
zeroth-order energies. Since small energy-denominators can yield convergence problems, a

0 are the, respective,

0 ), where EΦ

0 and Eq

reasonable choice for 2εγ is given by the maximum ∆q within the doubly-excited subspace:

εγ =

1
2

Max
|qi ∈ {|Φrs

wxi}

∆q,

(C1)

where the search is over all orthogonal-space states {|qi} from within the set of double

excited-states {|Φrs

wxi} that arise from a reasonable set of orbitals, e.g., from the {ϕo← Φ, ˆfo}
and {ϕu← Φ, ˆfu} sets. (Some modiﬁcation is necessary for Møller–Plesset, since this method

is restricted to Hartree–Fock orbitals, e.g., choose H0 to be given by Eqs. (39), (38c) and
(38d), where ( ˆf Φ

o = ˆf Φ

u = ˆFΦ).)

At least for ground states, we anticipate that perturbative expansions using orbital degen-

eracies can often converge, but, perhaps, at a slow rate. On the other hand, this deﬁciency is

partially compensated by a greater computational eﬃciency, since, for example, costly two-

electron integral-transformations can be avoided. Furthermore, approximations that involve

63

inﬁnite-order summations are often invariant to the choice of H0 – and hence εγ – includ-

ing the coupled cluster method that can be viewed as an inﬁnite-order partial-summation

method [56, 63].

[1] R. M. Dreizler and E. K. U. Gross, Density Functional Theory: An Approach to the Quantum

Many-Body Problem (Springer-Verlag, Berlin, Heidelberg, New York, London, Paris, Tokyo,

[2] R. G. Parr and W. Yang, Density-Functional Theory of Atoms and Molecules (Oxford Uni-

Hong Kong, Barcelona, 1990).

versity Press, New York, 1989).

Chichester, 1997).

Dordrecht, 1995).

1994).

[3] M. Springborg, ed., Density Functional Methods in Chemistry and Material Science (Wiley,

[4] D. E. Ellis, ed., Density Functional Methods of Molecules, Clusters, and Solids (Kluwer,

[5] E. K. U. Gross and R. M. Dreizler, eds., Density Functional Theory (Plenum, New York,

[6] J. Seminario and P. Politzer, eds., Modern Density Functional Theory. A Tool for Chemsitry

(Elsevier, Amsterdam, 1995).

[7] W. Kohn and L. J. Sham, Phys. Rev. 140, A1133 (1965).

[8] A. D. Becke, J. Chem. Phys. 98, 5648 (1993).

[9] K. Burke, M. Ernzerhof, and J. P. Perdew, Chem. Phys. Lett. 265, 115 (1997).

[10] J. P. Perdew, M. Ernzerhof, and K. Burke, J. Chem. Phys. 105, 9982 (1996).

[11] M. Ernzerhof, Chem. Phys. Lett. 263, 499 (1996).

[12] A. D. Becke, J. Chem. Phys. 98, 1372 (1993).

[13] J. Harris and R. O. Jones, J. Phys. F 4, 1170 (1974).

[14] O. Gunnarsson and B. I. Lundqvist, Phys. Rev. B 13, 4274 (1976).

[15] D. C. Langreth and J. P. Perdew, Phys. Rev. B 15, 2884 (1977).

[16] J. Harris, Phys. Rev. A 29, 1648 (1984).

[17] P. J. Stephens, J. F. Devlin, and C. F. Chabalowski, J. Phys. Chem. 98, 11623 (1994), (see

also internet address http://www.gaussian.com/q3.htm).

[18] C. Lee, W. Yang, and R. G. Parr, Phys. Rev. B 37, 785 (1988).

64

[19] R. Colle and O. Salvetti, Theor. Chim. Acta 37, 329 (1975).

[20] A. Seidl, A. G¨orling, P. Vogl, J. A. Majewski, and M. Levy, Phys. Rev. B 53, 3764 (1996).

[21] I. Lindgren and S. Solomonson, Int. J. Quantum Chem. 90, 294 (2002).

[22] A. Heβelmann and G. Jansen, J. Chem. Phys. 112, 6964 (2000).

[23] K. A. Brueckner, Phys. Rev. 96, 508 (96), (See Ref. 4 for more citations from Brueckner and

coworkers.).

[24] R. K. Nesbet, Phys. Rev. 109, 1632 (1958).

[25] W. Brenig, Nucl. Phys. 22, 177 (1961).

[26] P. O. L¨owdin, J. Math. Phys. 3, 1171 (1962).

[27] W. Kutzelnigg and V. H. Smith, J. Chem. Phys. 41, 896 (1964).

[28] J. Paldus and J. ˇC´iˇzek, Phys. Scripta 21, 251 (1980).

[29] R. A. Chiles and C. E. Dykstra, J. Chem. Phys. 74, 4544 (1981).

[30] L. Z. Stolarczyk and H. J. Monkhorst, Int. J. Quantum Chem. 18, 267 (1984).

[31] N. C. Handy, J. A. Pople, M. Head-Gordon, K. Raghavachari, and G. W. Trucks, Chem.

[32] N. C. Handy, J. A. Pople, M. Head-Gordon, K. Raghavachari, and G. W. Trucks, Chem.

[33] K. K. Raghavachari, J. A. Pople, E. S. Replogle, M. Head-Gordon, and N. C. Handy, Chem.

Phys. Lett. 164, 185 (1985).

Phys. Lett. 164, 185 (1989).

Phys. Lett. 167, 115 (1990).

[34] K. Hirao, in Self Consistent Field Theory, Studies in Physical and Theoretical Chemistry

(Elsevier, Amsterdam, 1990), vol. 90.

[35] J. F. Stanton, J. Gauss, and R. J. Bartlett, J. Chem. Phys. 97, 5554 (1992).

[36] C. Hampel, K. A. Peterson, and H. -J. Werner, Chem. Phys. Lett. 190, 1 (1992).

[37] G. E. Scuseria, Chem. Phys. Lett. 226, 251 (1994).

[38] D. H. Kobe, Nucl. Phys. 3, 417 (1971).

[39] L. Sh¨afer and H. A. Weidenm¨uller, Nucl. Phys. A174, 1 (1971).

[40] T. L. Gilbert, Phys. Rev. B 12, 2111 (1975).

[41] M. Berrondo and O. Goscinski, Int. J. Quantum Chem. symp. 9, 67 (1975).

[42] R. A. Donnelly and R. G. Parr, J. Chem. Phys. 69, 4431 (1978).

[43] M. Levy, Proc. Natl. Acad. Sci. USA 76, 6062 (1979).

[44] S. M. Valone, J. Chem. Phys. 73, 1344 (1980).

65

[45] E. V. Lude˜na, Density Matrices and Density Functionals (Reidel, Dordrecht, 1987).

[46] R. E. H. Englisch, Physica 121A, 253 (1984).

[47] M. Levy, Phys A 26, 1200 (1982).

[48] M. Levy and J. P. Perdew, in Density Functional Methods Physics, Dreizler, R. M. and

Providencia, J. da, eds., (Plenum, New York, 1985), pp. 11–30.

[49] P. -O. L¨owdin, Phys. 97, 1490 (1955).

[50] J.-P. Blaizot and G. Ripka, Quantum Theory of Finite Systems (MIT Press, Cambridge,

Mass., 1986).

[51] J. Goldstone, Proc. R. Soc. London A 239, 267 (1957).

[52] N. M. Hugenholtz, Physica 27, 281 (1957).

[53] P. G. H. Sanders, Adv. Chem. Phys. 14, 365 (1969).

[54] S. Raimes, Many-Electron Theory (North-Holland, Amsterdam, 1972).

[55] J. Paldus and J. ˇC´iˇzek, Adv. Quantum Chem. 9, 105 (1975).

[56] I. Lindgren and J. Morrison, Atomic Many-Body Theory, Springer Series on Atoms and

Plasmas (Springer-Verlag, New York, Berlin, Heidelberg, 1986), 2nd ed.

[57] J. P. Finley (2002), (to be published).

[58] J. Hubard, Proc. Roy. Soc. London A 240, 539 (1957).

[59] F. Coester, Nucl. Phys. 7, 421 (1958).

[60] J. ˇC´iˇzek, J. Chem. Phys. 45, 4256 (1966).

[61] J. ˇC´iˇzek, Adv. Chem. Phys. 14, 35 (1969).

[62] J. ˇC´iˇzek and J. Paldus, Int. J. Quantum Chem. 5, 359 (1971).

[63] I. Lindgren, Int. J. Quantum Chem. S12, 33 (1978).

[64] R. J. Bartlett and G. D. Purvis, Int. J. Quantum Chem. 14, 561 (1978).

[65] J. A. Pople, R. Krishnan, H. B. Schlegel, and J. S. Binkley, Int. J. Quantum Chem. S14,

545 (1978).

[66] S. F. Boys, Proc. Roy. Soc. London A 200, 542 (1950).

[67] H.f Schaefer III, Electronic Structures of Atoms and Molecules–A Survey of Rigorous Quan-

tum Mechanical Methods (Addison-Wesley, Reading, 1972).

[68] B. O. Roos and P. E. M. Siegbahn, in Methods of Electronic Structure Theory, H. F. Schaefer

III, ed., (Plenum, New York, 1977), p. 277.

[69] I. Shavitt, in Methods of Electronic Structure Theory, H. F. Schaefer III, ed., (Plenum, New

66

York, 1977), p. 189.

[70] A. Szabo and N. S. Ostlund, Modern Quantum Chemistry: Introduction to Advanced Elec-

tronic Structure Theory (Macmillian, New York, 1982).

[71] F. E. Harris, H. J. Monkhorst, and D. L. Freeman, Algebraic and Diagrammatic Methods in

Many-Fermion Theory (Oxford University Press, New York, 1992).

[72] C. E. Dykstra, Ab Initio Calculations of the Structure and Properties of Molecules (Elsevier,

Amsterdam, 1988).

[73] N. N. Bogoliubov and D. V. Shirkov, Introduction to the Field of Quantized Fields (Wiley,

New York, 1959), (English translation).

[74] I. Lindgren, J. Phys. B 7, 2441 (1974).

[75] S. Wilson, Comp. Phys. Rep. 2, 389 (1985).

[76] L. M. Frantz and R. L. Mills, Nucl. Phys. 15, 16 (1960).

[77] G. A. Baker, Rev. Mod. Phys. 43, 479 (1971).

[78] B. H. Brandow, Rev. Mod. Phys. 39, 771 (1967).

[79] B. H. Brandow, Adv. Quantum Chem. 10, 187 (1977).

[80] C. Bloch, Nucl. Phys. 6, 329 (1958).

[81] V. Kvasni˘cka, Czech J. Phys. B 24, 605 (1974).

[82] W. Brenig, Nucl. Phys. 4, 363 (1957).

[83] L. Sch¨afer and H. A. Weidenm¨uller, Nucl. Phys. A 174, 1 (1971).

[84] J. P. Finley, J. Chem. Phys (2001), (submitted).

[85] R. M. Mattuck, A Guide to Feynman Diagrams in the Many-Body Problem (McGraw–Hill,

New York, 1976), 2nd ed.

[86] P. A. M. Dirac, Proc. Cambridge Phil. Soc. 26, 376 (1930).

[87] P. A. M. Dirac, Proc. Cambridge Phil. Soc. 27, 240 (1931).

[88] P. -O. L¨owdin, Phys. 97, 1474 (1955).

[89] R. McWeeny, Rev. Mod. Phys. 32, 335 (1960).

[90] M. Gell-Mann and K. A. Brueckner, Phys. Rev. 106, 364 (1957).

[91] N. H. March, The Many-Body Problem in Quantum Mechanics, Cambridge monographs on

physics (Cambridge University Press, London, 1967).

[92] S. H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys. 58, 1200 (1980).

[93] P. J. Ellis and E. Osnes, Rev. Mod. Phys. 49, 777 (1977), (and referenences therein).

67

[94] K. F. Freed, Lecture Notes in Chemistry, Vol. 52 (Springer, Berlin, 1989), p. 1.

[95] A. Brueckner and D. T. Goldman, Phys. Rev. 116, 424 (1959).

[96] K. Kumar, Perturbation Theory and the Nuclear Many Body Problem (North-Holland,

Netherlands, 1962), p. 171.

[97] I. Lindgren, Phys. Scripta 32, 291 (1985), (See also ibid. 32, 611 (1985).

[98] I. Lindgren and D. Mukherjee, Phys. Rep. 151, 93 (1987).

[99] J. P. Finley and K. F. Freed, J. Chem. Phys 102, 1306 (1995).

[100] J. P. Finley, R. K. Chaudhuri, and K. F. Freed, J. Chem. Phys. 103, 4990 (1995).

[101] J. P. Finley, R. K. Chaudhuri, and K. F. Freed, Phys. Rev. A 54, 343 (1996).

[102] T. H. Schucan and H. A. Weidenm¨uller, Ann. Phys. N.Y. 73, 108 (1972).

[103] T. H. Schucan and H. A. Weidenm¨uller, Ann. Phys. N.Y. 76, 483 (1973).

[104] R. Bartlett and D. Silver, in Quantum Science, J. L Calais, O. Goscinski, J. Linderberg, and

Y. ¨Ohrn eds. (Plenum, New York, 1977), p. 393.

[105] M. Gell-Mann and K. A. Brueckner, Phys. Rev. 106, 364 (1957).

[106] M. Gell-Mann, Phys. Rev. 106, 369 (1957).

[107] C. Møller and M. Plesset, Phys. Rev. 46, 618 (1934).

[108] R. J. Bartlett and D. M. Silver, J. Chem. Phys. 62, 325 (1975).

[109] J. A. Pople, J. S. Binkley, and R. Seeger, Int. J. Quantum Chem. 10S, 1 (1976).

[110] P. Claverie, S. Diner, and J. P. Malrieu, Int. J. Quantum Chem. 1, 751 (1967), and references

therein.

[111] P. S. Epstein, Phys. Rev. 28, 695 (1926).

[112] R. D. Nesbet, Proc. Roy. Soc. London. Ser. A 230, 312 (1955).

[113] J. P. Finley, J. Chem. Phys. 112, 6997 (2000).

[114] J. P. Finley, Theor. Chem. Acct. (2002), (in press).

68

