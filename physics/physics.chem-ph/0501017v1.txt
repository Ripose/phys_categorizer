5
0
0
2
 
n
a
J
 
5
 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 
1
v
7
1
0
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Discreteness-Induced Transitions in Autocatalytic Systems

Yuichi Togashi∗ and Kunihiko Kaneko
Department of Basic Science, School of Arts and Sciences,
The University of Tokyo, Komaba, Meguro, Tokyo 153-8902, Japan
(Dated: July 29, 2004)

Abstract

To study the dynamics of chemical processes, we often adopt rate equations to observe
the change in chemical concentrations. However, when the number of the molecules is small,
the ﬂuctuations cannot be neglected. We often study the eﬀects of ﬂuctuations with the
help of stochastic diﬀerential equations.

Chemicals are composed of molecules on a microscopic level. In principle, the number of
molecules must be an integer, which must only change discretely. However, in analysis using
stochastic diﬀerential equations, the ﬂuctuations are regarded as continuous changes. This
approximation can only be valid if applied to ﬂuctuations that involve a suﬃciently large
number of molecules. In the case of extremely rare chemical species, the actual discreteness
of the molecules may critically aﬀect the dynamics of the system.

To elucidate the eﬀects of the discreteness, we study an autocatalytic system consisting
of several interacting chemical species with a small number of molecules through stochastic
particle simulations. We found novel states, which were characterized as an extinction of
molecule species, due to the discrete nature of the molecules. We also observed a strong
dependence of the chemical concentrations on the size of the system, which was caused by
transitions to the novel states.

I.

INTRODUCTION: DISCRETE REACTION SYSTEMS

In nature, there exists a variety of systems that involve chemical reactions. Some are on
a geographical-scale, while others on a nano-scale. Chemical reactions are an integral part
of life, including all living forms of life.

To study the dynamics of reaction systems, we often adopt rate equations in order to
observe the change in chemical concentrations. In rate equations, we regard the concentra-
tions as continuous variables; the rate of the reaction as a function of the concentrations. In
macroscopic systems, there are a vast number of molecules; thus, continuous representations
are usually applicable.

When the concentration of a certain chemical is small, ﬂuctuations in the reactions or
ﬂow can be signiﬁcant. We often handle such systems with the help of stochastic diﬀerential
equations, in which we regard noise as a continuum description of the ﬂuctuations [1, 2]. Such

∗Electronic address: togashi@complex.c.u-tokyo.ac.jp

2

an approximation is useful when the number of molecules is intermediate. The employment
of stochastic diﬀerential equations led to some important discoveries such as noise-induced
order [3], noise-induced phase transitions [4], and stochastic resonance [5].

In stochastic diﬀerential equations, still quantities of chemicals are regarded as contin-
uous variables. Essentially, on a microscopic level, chemicals are composed of molecules.
The number of molecules should be an integer (0, 1, 2, · · ·), which changes discretely.
Fluctuations are derivatives of discrete stochastic changes; thus, continuum descriptions of
ﬂuctuations are not always appropriate and can be doubted. For chemicals with a small
number of molecules of the order of 1, a single molecule is extremely signiﬁcant; therefore,
the discreteness in the number is signiﬁcant.

Biological cells appear to be a good example. The size of the cells is of the order of
microns, in which nano-scale “quantum” eﬀects can be ignored. However, in cells, some
chemicals act at extremely low concentrations of the order of pM or nM. Assuming that the
typical volume of a cell ranges from 1 to 103 µm3, the concentration of one molecule in the
cell volume corresponds to 1.7 pM–1.7 nM. It is probable that the molecular numbers of
some chemicals in a cell are of the order of 1, or sometimes reach 0.

If such chemicals play only a minor role, we can safely ignore these chemicals. However,
this is not always the case. In biological systems, chemical species with a small number
of molecules may critically aﬀect the behavior of the entire system. For example, there
exist only one or a few copies of genetic molecules such as DNA, which are important
to characterize the behavior, in each cell. Further, some experiments show that doses of
particular chemicals at concentrations of the order of pM or fM may alter the behavior of
the cells (e.g., [6, 7]). Biological systems also include positive-feedback mechanisms such as
autocatalytic reactions, which may amplify single molecular changes to a macroscopic level.
The eﬀects due to small molecular numbers in cells have been noticed only recently, both
theoretically [8, 9] and experimentally [10].

At present, we focus on the possible eﬀects of molecular discreteness. To study such
eﬀects, we should adopt an appropriate method to handle molecular discreteness. Some
numerical methods to investigate reaction systems that take into account discreteness and
stochasticity already exist (we brieﬂy review these methods; see Appendix). Among the
methods, we adopted Gillespie’s direct method, which is popular and frequently used.

Furthermore, some works related to molecular discreteness also exist. For example, Blu-
menfeld et al. showed that the mass action law may breakdown in a small system [11, 12].
Stange et al. studied the synchronization of the turnover cycle of enzymes [13, 14].

We regard it important to identify the phenomena for which molecular discreteness is

essential.

Through stochastic simulations, we show that discreteness can induce transitions to novel
states in autocatalytic systems [15], which may aﬀect macroscopic chemical concentrations
[16].

II. DISCRETENESS-INDUCED TRANSITIONS

3

A. Model

Xi + Xi+1 → 2Xi+1

We consider a simple autocatalytic network (loop) with k chemicals. We consider Xi

chemicals and assume

reactions between these chemicals (i = 1, 2, · · · , k; Xk+1 ≡ X1). All the reactions are
irreversible.

For the reactor, we assume a well-stirred container with volume V . The set of Ni, the
number of Xi molecules, determines the state of the system. The container is in contact
with a chemical reservoir, in which the concentration of Xi is ﬁxed at si. The ﬂow rate of
Xi between the container and the reservoir is Di, which corresponds to the probability of
the ﬂowing out of a molecule per time unit1.

We can consider the continuum limit as V → ∞. In the continuum limit, the change of

xi, the chemical concentration Xi in the container, follows the rate equation

dxi
dt

= ri−1xi−1xi − rixixi+1 + Di(si − xi),

(1)

where ri is the rate constant of the reaction Xi + Xi+1 → 2Xi+1, and X0 ≡ Xk.

For simplicity, we consider the case with equivalent chemical species, given as ri = r,
Di = D, and si = s for all i (r, D, s > 0). By this assumption, the rate equation has
only one attractor: a stable ﬁxed point xi = s for all i. For any initial condition, each xi
converges to s, the ﬁxed point value. Around the ﬁxed point, xi vibrates with the frequency
ωp ≡ rs/π.

If the number of molecules is ﬁnite but fairly large, we can estimate the dynamical behavior
of the system using a Langevin equation, obtained by adding a noise term to the rate
equation. Each concentration xi ﬂuctuates and vibrates around the ﬁxed point. An increase
in the noise (corresponding to a decrease in the number of molecules) merely boosts the
ﬂuctuation.

However, when the number of molecules is small, the behavior of the system is completely
diﬀerent. First, we investigate the case when k = 4, which is the smallest number of species
to show the novel states described below.

B. Novel States Induced by the Discreteness

Subsequently, we investigate the dynamical behavior of the system with a small number
of molecules. In order to detect the phenomena for which the discreteness of the number of
molecules is crucial, we employ stochastic simulations.

1 Di is the diﬀusion rate across the surface of the container. Here, we choose the ﬂow proportional to V ,
to have a well-deﬁned continuum limit. One might assume the ﬂow proportional to V 2/3, considering the
area of the surface. By rescaling D, the model can be rewritten into the case with V 2/3 for ﬁnite V .

Here, we adopt Gillespie’s direct method2. The frequency (expected number per unit

time)

• of the reaction Xi + Xi+1 → 2Xi+1 is PRi ≡ rxixi+1V = rNiNi+1/V ;

4

• of the outﬂow of Xi is POi ≡ DxiV = DNi;

• of the inﬂow of Xi is PIi ≡ DsV .

In the continuum limit (V → ∞), these frequencies agree with the rate equation. We
calculate these frequencies with the current Ni, and stochastically decide when and which
event will occur next.

In this case, by an appropriate conversion of D, V , and t, we can set r and s to be 1
without loss of the generality (rs/D and sV are the only independent parameters). We
assume that r = 1 and s = 1 for the purpose of further discussion. The total number of
Ni, is approximately 4sV on an average. By varying
molecules in the container, Ntot =
V , we can control the average number of molecules without changing the continuum limit.
First, we consider the case of a large V , i.e., both the number of molecules in the container
and ﬂow of molecules between the container and the reservoir are large. As expected, the
behavior of the system is similar to that of the rate equation with noise. As shown in Fig.
2, each Ni ﬂuctuates and vibrates around the ﬁxed point value Ni = V (i.e. xi = 1). This
is still in the realm of stochastic diﬀerential equations.

P

However, when V is small, we observe novel states that do not exist in the continuum
limit. As shown in Fig. 3, continuous vibrations disappear. Furthermore, two chemicals are
dominant and the other two are mostly extinct (Ni = 0). In Fig. 3, at t < 520, N1 and N3
dominate the system and N2 = N4 = 0 for the most part. We call such a state the 1-3 rich
state. Reversely, at t > 520, N2 and N4 are large and usually N1 = N3 = 0. We call this
state the 2-4 rich state.

These states appear because of the following reason. In this system, the production of
Xi molecules requires at least one Xi molecule as a catalyst. If Xi becomes extinct, the
production of Xi halts. Ni never regains before an Xi molecule ﬂows in.

In the rate equation (eq. (1)), the concentration xi is a continuous variable, which can be
an inﬁnitesimal but positive value. The consumption rate of xi is proportional to xi itself;
thus, xi cannot reach 0 exactly within ﬁnite time, even if it can go to 0 asymptotically as
t → ∞.

In fact, the number of molecules must be an integer. Transitions from Ni = 1 to Ni = 0
are probabilistic and may happen in ﬁnite time. For transitions to occur, it is important
that the consumption rate of xi does not converge to 0 at Ni = 1. The average interval of a
molecule ﬂowing in is 1/DV for each chemical. If D and V are small enough to ensure that
the inﬂow interval is longer than the time scale of the reactions, it is likely that the state of
the system Ni = 1 drops to Ni = 0 before an Xi molecule enters.

When Ni reaches 0, Ni+2 is also likely to become 0. For example, if we assume that
N2 = 0, then N1 is likely to increase because the consumption of X1 halts; N3 is likely
to decrease because the production of X3 halts. Thus, this results in N1 > N3. When

2 For systems with a large number of chemical species, the next reaction method would be more suitable.

5

N1 > N3, the consumption rate of X4 is larger than the production rate of X4; therefore,
N4 starts to decrease and often reaches 0. When N2 = N4 = 0, all the reactions stop. The
system stays at N2 = N4 = 0 for a long time as compared with the ordinary time scale of
the reactions (∼ 1/r). This is the 1-3 rich state.

In the 1-3 rich state, the system alternately switches between N1 > N3 and N1 < N3. We
consider that the system is in the 1-3 rich state with N1 > N3. One X2 molecule ﬂowing
in may resume the reactions X1 + X2 → 2X2 and X2 + X3 → 2X3. Generally, the former
is faster because N1 > N3; hence, N2 is likely to increase. Since N4 = 0, the reactions are
one-way; N1 decreases and N3 increases. When N1 < N3, N2 starts to decrease. Finally,
when N2 returns to 0, the reactions halt again. The system stays in the 1-3 rich state, until
N1 reaches 0. In the same manner, the inﬂow of X4 can switch the system from N1 < N3
to N1 > N3 in the 1-3 rich state. Consequently, we observe successive switching between
N1 > N3 and N1 < N3. In the 2-4 rich state, the system switches between N2 > N4 and
N2 < N4.

In this manner, even one molecule can switch the system within the 1-3 or 2-4 rich states.

We name these states “switching states”.

Now, we investigate some properties of the switching states. We introduce an index
z ≡ (x1 + x3) − (x2 + x4) as a characteristic of the switching states. Around the ﬁxed point
of the rate equation, z ≈ 0; in the 1-3 rich state, z ≈ 4; in the 2-4 rich state, z ≈ −4.

The distribution of z is shown in Fig. 4. When V ≥ 128, a single peak appears around
z = 0, which corresponds to the ﬁxed point. By decreasing V , the peak broadens with
ﬂuctuations. When V ≤ 32, double peaks appear at z ≈ ±4, which correspond to the
switching states. We clearly observe a symmetry-breaking transition between a continuous
vibration around the ﬁxed point with large V and the switching states with small V . This
is a discreteness-induced transition (DIT) that occurs with decrease of V , which is not seen
in continuum descriptions.

We introduce another index y ≡ (x1 + x2) − (x3 + x4), which represents the diﬀerence
in concentrations: x1 − x3 in the 1-3 rich state and x2 − x4 in the 2-4 rich state. The
distribution of y is shown in Fig. 5. There are double peaks around y = ±3, which imply
large imbalances, such as (N1, N3) = (3.5V, 0.5V ) and (0.5V, 3.5V ), between N1 and N3 in
the 1-3 rich state (as well as the 2-4 rich state).

C. Single Molecular Switch

We investigate some properties of the switching states.
First, we examine how each Ni changes in a switching event. We assume the 1-3 rich
state with N1 = N1ini, N3 = N3ini, and N2 = N4 = 0. Here, one X2 molecule ﬂows in
(N2 = 1) at t = 0, which starts up the reactions. Assuming that DV is so small that no
more molecules ﬂow in or out throughout the switching, the total number of molecules N
is conserved at N = N1ini + N3ini + 1, and N4 is always 0. We can represent the state with
two variables, N1 and N2.

In this system, only the following types of reactions

• X1 + X2 → 2X2 and

• X2 + X3 → 2X3

may change Ni; the others never take place. N1 monotonously decreases. When N2 reaches
0, these reactions halt completely, and the switching is completed. Evidently, N1f in +
N3f in = N1ini + N3ini + 1, where N1f in and N3f in are the ﬁnal values of N1 and N3,
respectively.

The frequency of the reaction X1 + X2 → 2X2 is

f1(N1, N2) = N1N2/V,

6

f2(N1, N2) = N2N3/V = N2(N − N1 − N2)/V.

and that of X2 + X3 → 2X3 is

We obtain the Master equation

dP (N1, N2, t)
dt

= f1(N1 + 1, N2 − 1)P (N1 + 1, N2 − 1, t) + f2(N1, N2 + 1)P (N1, N2 + 1, t)

− {f1(N1, N2) + f2(N1, N2)} P (N1, N2, t)
1
V n(N1 + 1)(N2 − 1)P (N1 + 1, N2 − 1, t)

=

+ (N2 + 1)(N − N1 − N2 − 1)P (N1, N2 + 1, t)

− N2(N − N2)P (N1, N2, t)o

(2)

for P (N1, N2, t), the probability of residence in the state (N1, N2) at time t. The initial
condition is P (N1ini, 1, 0) = 1; otherwise P (N1, N2, 0) = 0.

We can easily follow the Master equation numerically. We investigate the relationship

between the initial state (N1ini, N3ini) and the ﬁnal state (N1f in, N3f in).

If the ﬁrst reaction is X2 + X3 → 2X3, N2 instantaneously reaches 0, and as a result

N3f in = N3ini + 1. The system fails to switch.

If N1ini > N3ini,

it is more probable that the ﬁrst reaction is X1 + X2 → 2X2.
Subsequently, the system carries out further reactions.
In this case, it is probable that
N1ini ≈ N3f in, i.e., the system swaps N1 and N3, as shown in Fig. 6. Consequently, we
observe successive switching (as seen in Fig. 3).

When N1ini ≫ N3ini, the system is likely to reach N1f in = 0 and break the 1-3 rich state.

A large imbalance between N1 and N3 results in an unstable 1-3 rich state.

D. Conditions for Switching States

Now, we investigate the requirements for the transitions to the switching states. The
rate of residence of the switching states for several D and V is shown in Fig. 8. For
approximately DV < 1, we observe the switching states. If DV < 0.1, the system mostly
stays in the switching states.

Subsequently, we expect that switching states appear even for large V if D is very small.
In fact, we observe switching states for V = 104 as shown in Fig. 9. Furthermore, in this
case also, a single molecule can induce switching.

Strictly speaking, if DV is the same, the rate of residence is a little smaller for larger V .
If V is large, the system takes longer to reach Ni = 0 even if the rate of reaction and the

7

initial concentrations are the same. Thus, it is less likely to exhibit switching states for the
same interval of the inﬂow, 1/DV .

In general, some reactions are much faster than the inﬂow. If the number of molecules
which enter within the time scale of the reactions is of the order of 1 for a certain chemical,
the reactions may consume all the molecules of the chemical, and the molecular discreteness
of the chemical becomes signiﬁcant. In other words, for the eﬀect of the discreteness to
appear in a system with several processes, it is important that the number of events of a
process within the time scale of another process is of the order of 1.

Once the system is in the switching state, it is fairly stable and diﬃcult to escape, espe-
cially if DV is small. To escape the 1-3 rich state and regain continuous vibration, at least
one X2 molecule and one X4 molecule should ﬂow in and coexist. It is required that after
an X2 molecule ﬂows in, an X4 molecule should ﬂow in before N2 returns to 0, or vice versa.
We put one X2 molecule into the system in the 1-3 rich state at t = 0, and one X4
molecule in at t = τ . We assume that DV is so small that no more molecules ﬂow in or
out. Then, we judge whether the system escapes from the 1-3 rich state. In due course,
the system returns to the 1-3 rich (or sometimes 2-4 rich) state because there is no further
ﬂow; thus, we should judge at the right moment. Here, if Ni > 0 for all i at t = 8 (i.e.,
waiting about 2.5 times longer than the period of the oscillation around the ﬁxed point),
we consider that the 1-3 rich state has been interrupted. We measure the probability of
interruption for various initial conditions and the delay τ as shown in Fig. 10.

The system requires adequate timing of inﬂow to escape the switching states, which may
amplify the imbalance between the stability of each state. For example, to escape the 1-3
rich, N1 > N3 state, it is required that an X2 molecule ﬂows in, and then an X4 molecule
ﬂows in with a certain delay τ , as shown in Fig. 10. Thus, the frequency of escape from the
1-3 rich state is approximately proportional to the product of the inﬂow frequencies of X2
and X4. If each Di or si is species-dependent, the stability of the 1-3 and 2-4 rich states
may strongly depend on DisiV , the inﬂow frequency of Xi.

Furthermore, if at the outset N1 ≈ N3, it is diﬃcult for the system to escape from the
1-3 rich state. In some cases where the parameters are species-dependent, the ﬂows or the
switching may lead to N1 ≈ N3, which stabilizes the 1-3 rich state.

These conditions are important to stabilize particular states and aﬀect the macroscopic

behavior of the system (see Section III).

E. Stability and Shape of the Network: k 6= 4 case

To close the section II, we brieﬂy discuss the cases where k 6= 4. Figure 11 shows the time
series of each Ni for k = 3, 5, and 6. When k = 6, 1-3-5 rich and 2-4-6 rich states appear.
However, these states are less stable than the 1-3 and 2-4 rich states for k = 4. These states
collapse when any of the rich chemicals vanish; thus, they are unstable for large k. When k
is odd (3, 5, · · ·), there are no stable states where particular chemicals are extinct. However,
additional reactions, or a variety of ri or si, may stabilize or destabilize the states such that
it is not always true that loops with odd-k are unstable.

The discreteness-induced transitions are not limited in the autocatalytic loop. We apply
the abovementioned discussions to certain segments of a complicated reaction network with
a slight modiﬁcation.

8

III. ALTERATION OF CONCENTRATIONS BY THE DIT

In the preceding section, we show that the discreteness of the molecules can induce tran-

sitions to novel “switching” states in autocatalytic systems.

For the case where k = 4 with uniform parameters, the 1-3 rich state and the 2-4 rich
state are equivalent. In due course, the system alternates between the 1-3 rich and 2-4 rich
states. The long-term averaged concentrations are still the same as the continuum limit
value, ¯xi = 1.

It will be important if macroscopic properties, such as the average concentrations, can be
altered. We show that the discreteness-induced transitions may alter the long-term averaged
concentrations.

Once again, here, we adopt the autocatalytic reaction loop

A. Model

Xi + Xi+1 → 2Xi+1

for the k = 4 species. Now we consider the case where the parameters Di, si, or ri are
species-dependent.
In the continuum limit, the concentration xi is governed by the rate
equation

dxi
dt

= ri−1xi−1xi − rixixi+1 + Di(si − xi).

(3)

The rate equation does not contain the volume V ; hence, the average concentrations should
be independent of V .

As discussed in the preceding section, for the transitions to the switching states to occur,
it is necessary that the interval of the inﬂow is longer than the time scale of the reactions.
In this model, the inﬂow interval of Xi is ∼ 1/DisiV , and the time scale of the reaction
Xi + Xi+1 → 2Xi+1 in order to use Xi up is ∼ 1/rixi+1. If all the chemicals are equivalent,
the discreteness of all the chemicals equally take eﬀect, and the 1-3 and 2-4 rich states
coordinately appear at DV ≈ r.

Now, since the parameters are species-dependent, the eﬀect of discreteness may be dif-
ferent for each species. For example, assuming that D1s1 < D2s2, the inﬂow interval of X1
is longer than that of X2. Thus, the discreteness of the inﬂow of X1 may be signiﬁcant for
larger V .

To demonstrate a possible eﬀect of the discreteness on the macroscopic properties of the
system, we measure each average concentration ¯xi, sampled over a long enough time to allow
transitions between the 1-3 and 2-4 rich states, by Gillespie’s direct method. Note that every
¯xi does not depend on V in the continuum limit. Generally, in discrete simulations, the eﬀect
of the discreteness varies with V and alters every ¯xi. When V is very large, the discreteness
does not matter and ¯xi is almost equal to the continuum limit value. In contrast, when V
is small, the discreteness causes ¯xi to be very diﬀerent from the continuum limit.

We ﬁrst investigate the case where each si is species-dependent (i.e., each inﬂow rate is
species-dependent), and each Di and ri are uniform (Di = D, ri = 1). Later, we brieﬂy
discuss the case where ri is inhomogeneous.

9

As mentioned in Section II D, for the eﬀect of the discreteness to appear, it is important
that the interval of events of a process is of the order of or longer than the time scale
of another process. As regards the inﬂow, there are two indices to determine how the
discreteness appears:

• The inﬂow interval,

1
DsiV ,

• The number of molecules at equilibrium, siV .

1

If the inﬂow interval,

DsiV , is longer than the time scale of the reactions, the reactions
may exhaust the chemical before the chemical enters, and the inﬂow discreteness becomes
signiﬁcant.

Furthermore, if siV is smaller than 1, Ni can reach 0 because of the outﬂow. In such
cases, the relation between the inﬂow interval and the outﬂow time scale is also important.
The approach time from Ni = n ≫ 1 to Ni = 0 is of the order of 1
D log n. If the inﬂow
interval of the chemical that causes the switching to raise Ni is long enough to allow all Xi
molecules to ﬂow out, the inﬂow discreteness may alter the stability of the states drastically.

From this point of view, we classify the mechanism in cases I, I′, and II as follows.

B. Case I: inﬂow discreteness and reaction rate

We start with the simplest case, s1 = s3 > s2 = s4. In this case, the rate equation has
a stable ﬁxed point with ∀i : xi = si. When V is large, each xi ﬂuctuates around the ﬁxed
point, and each average concentration ¯xi is in accordance with the ﬁxed point value. When
V is small, ¯xi depends on V . Fig. 12 shows each ¯xi as a function of V . The diﬀerence
between ¯x1 and ¯x2 increases for small V .

By decreasing V , ﬁrst N2 and N4 reach 0 and the 1-3 rich state appears. To reach
N2 = 0 or N4 = 0, the inﬂow interval of X2 or X4 should be longer than the time scale
of the reactions. We set xi = O(1); thus, the condition to achieve the 1-3 rich state is
r ; that for the 2-4 rich state is
approximately
1
r < 1
If V satisﬁes

Ds2V ,
state does not. Thus, ¯x1 and ¯x3 increase. We actually observed this at V ≈ r
in Fig. 12.

Ds4V , the 1-3 rich state appears but the 2-4 rich
Ds2 , as shown

Ds4V > 1
Ds3V < 1

1
Ds2V ,
1
Ds1V ,

Ds3V > 1
r .

1
Ds1V ,

1

1

1

For smaller V that fulﬁlls both the 1-3 and 2-4 rich states, the imbalance between the 1-3
and 2-4 rich states does not disappear. Once the system is in the 1-3 rich state, adequate
timing for the X2 and X4 inﬂow is required to escape the state. Thus, the frequency of
escape from the 1-3 rich state is approximately proportional to D2s2s4V 2, the product of
the inﬂow frequencies of X2 and X4. The average residence time in the 1-3 rich state as
well as the 2-4 rich state is the reciprocal of the escape frequency. The ratio of the average
residence time in the 1-3 rich state to that in the 2-4 rich state is ≈ s1s3
s2s4 . In addition, after
escaping the switching states, the system tends to reach the 1-3 rich state rather than the
2-4 rich state because of the biased inﬂow. Thus, the ratio of the total residence time in the
1-3 rich state to that of the 2-4 rich state is larger than s1s3
s2s4 ; hence, ¯x1, ¯x3 ≫ ¯x2, ¯x4, even
for a small diﬀerence in si.

C. Case I′: imbalance of inﬂow discreteness

10

In Case I, we consider the imbalance between the X1, X3 pair and the X2, X4 pair. If
another imbalance exists between the X2 and X4 inﬂows, the switching induced by these
chemicals in the 1-3 rich state may be unbalanced. We consider the case where s1 = s3 >
s2 > s4.

In this case, the 1-3 rich state is more stable than the 2-4 rich state, which is identical to
Case I. In the 1-3 rich state, the system can be switched from N1 > N3 to N1 < N3 by an
X2 molecule; and from N1 < N3 to N1 > N3 by an X4 molecule. Now, the inﬂow rate of
X2 is larger than X4; thus, switching from N1 > N3 to N1 < N3 is more probable than vice
versa, and the system tends to stay in the N1 < N3 state. Consequently, ¯x1 < ¯x3, as shown
in Fig. 12. This eﬀect requires switching states. When V is large, ¯x1 and ¯x3 are almost the
same.

D. Case II: inﬂow and outﬂow

Here, we consider the case where s1 = s2 > s3 = s4. In this case also, the rate equation

has a stable ﬁxed point3.

When V is small, both the 1-3 and the 2-4 rich states appear. Here, we consider s4V ,
the number of X4 molecules when the concentration of X4 in the container and in the
reservoir are at equilibrium. If s4V < 1, N4 reaches 0 without undergoing any reaction.
The system takes ∼ 1
D log n time units to reach from N4 = n ≫ 1 to N4 = 0. The reaction
X4 + X1 → 2X1 also uses X4 such that N4 decreases faster if s1 is large.

If N4 > 0, the inﬂow of X3 may switch from N2 > N4 to N2 < N4 and raise N4 again.
The inﬂow interval of X3 is ∼ 1
Ds3V . If the interval is much shorter than the approach time
to N4 = 0, the switching maintains N4 > 0. If the interval is longer, N4 reaches 0 before
switching, and the 2-4 rich state is easily destroyed.

In the 1-3 rich state, the system tends to maintain N1 < N3 because the X2 inﬂow is
frequent. However, the X1 inﬂow is also large enough to maintain N1 > 0. The 1-3 rich
state retains its stability.

In conclusion, the 1-3 rich state is more stable than the 2-4 rich state. In the 1-3 rich
state, N1 < N3 is preferred, and ¯x3 increases. At this stage, it is possible that ¯x2 ≪ ¯x3
despite the fact that s2 ≫ s3, as shown in Fig. 14.

E. Ampliﬁcation by Discreteness

In summary, the diﬀerence in the “extent of discreteness” between chemical species induces
novel transitions. The “extent of discreteness” depends on V ; thus, we observe transitions
by changing V . The transition reported in Section II is regarded as a second order transi-
tion involving symmetry breaking (see Figs. 4 and 5), while the transition in this section

3 Generally, if D ≪ rsi, x1, x3 ≈ (s1 + s3)/2 and x2, x4 ≈ (s2 + s4)/2.

11

corresponds to the ﬁrst order transition without symmetry breaking (see Fig. 13) in terms
of thermodynamics.

We classiﬁed the mechanism in cases I, I′, and II. These mechanisms can be combined.
For example, we demonstrate the case where s1 = 0.09, s2 = 3.89, and s3 = s4 = 0.01. In
this case, each ¯xi shows a three-step change with V , as shown in Fig. 15.

When V is large, ¯x1, ¯x3 ≪ ¯x2, ¯x4, since s1 + s3 ≪ s2 + s4. At V ≈ 103, the discreteness of
the X3 inﬂow becomes signiﬁcant, and the 2-4 rich state appears. In the 2-4 rich state, the
system tends to remain at N2 > N4 because of the inﬂow imbalance between X1 and X3,
as observed in Case I′. Figure 17 shows the distribution of x2. The major peak corresponds
to the 2-4 rich, x2 > x4 state for the cases when 128 ≤ V ≤ 512.

On the other hand, in the 2-4 rich state, the outﬂow of X4 depresses N4 toward s4V ,
as observed in Fig. 16. By decreasing V , the imbalance between N2 and N4 increases
because the rate of switching, which again raises N4, decreases in proportion to V . Finally,
at V ≈ 102, the 2-4 rich state loses stability, as seen in Case II. Now, the 1-3 rich state is
preferred despite the fact that s1 + s3 ≪ s2 + s4. ¯x3 increases to ≈ 2, which is more than
30 times as large as that in the continuum limit.

For extremely small V , the 1-3 rich state is also unstable because N1 and N3 easily reach
0. In such a situation, typically only one chemical species is in the container. The system
is dominated by diﬀusion, and ¯x2 increases again due to the large s2.

Note that the chemical that becomes extinct depends not only on the ﬂows but also on

the reactions. In some cases, we observe smaller ¯x3 for larger s3.

F. Asymmetric Reaction Case

It is possible that each ri varies with the species. In such cases, we can discuss the eﬀect
of discreteness in a similar way. However, the change of ¯xi with V is diﬀerent from the case
with asymmetric ﬂows.

For example, we assume that r1 = r3 > r2 = r4 and ∀i : si = 1. In the continuum limit
or in the case of large V , ¯x2 = ¯x4 > ¯x1 = ¯x3, as shown in Fig. 18. In contrast, when V is
small, ¯xi ≈ 1. If V is very small, such that the total number of molecules is mostly 0 or 1,
reactions rarely take place. The ﬂow of chemicals dominate the system; thus, ¯xi ≈ si.

If both the reactions and the ﬂows are species-dependent, we simply expect the behavior
to be a combination of the abovementioned cases. Even this simple system can exhibit a
multi-step change in concentrations along with a change in V . It is not limited to the simple
reaction loop. In fact, we observe this kind of change in concentrations with a change in
the system size in randomly connected reaction networks. For a large reaction network with
multiple time scales of reactions and ﬂows, the discreteness eﬀect may exhibit behavior that
is more complicated. Our discussion is largely applicable to such cases if we can deﬁne the
time scales appropriately.

As seen in this paper, the discreteness of molecules can alter the average concentrations.
When the rates of inﬂow and/or the reaction are species-dependent, transitions between
the discreteness-induced states are imbalanced. This may alter the average concentrations
drastically from those of the continuum limit case.

IV. DISCUSSION

12

We demonstrated that molecular discreteness may induce transitions to novel states in
autocatalytic systems, and that may result in an alteration of the macroscopic properties
such as the average chemical concentrations.

In biochemical pathways, it is not anomalous that the number of molecules of a chemical
is of the order of 102 or less in a cell. There are thousands of protein species, and the total
number of protein molecules in a cell is not very large. For example, in signal transduction
pathways, some chemicals work at less than 100 molecules per cell. There exist only one or
a few copies of genetic molecules such as DNA; furthermore, mRNAs and tRNAs are not
present in large numbers. Thus, regulation mechanisms involving genes are quite stochastic.
Molecular discreteness naturally concerns such rare chemicals.

One of the authors, Kaneko, and Yomo recently provided the “Minority Control conjec-
ture,” which propounds that chemical species with a small number of molecules governs
the behavior of a replicating system, which is related to the origin of heredity [17, 18, 19].
Matsuura et al. experimentally demonstrated that a small number of genetic molecules is
essential for evolution [20]. Molecular discreteness should be signiﬁcant for such chemicals,
and may be relevant to characters of genetic molecules.

Until now, we have modeled reactions in a well-stirred medium, where only the number
of molecules is taken into account while determining the behavior. However, if the system is
not mixed well, we should take into account the diﬀusion in space. Both the total number of
molecules and the spatial distributions of the molecules may be signiﬁcant. From a biological
point of view, the diﬀusion in space is also important because the diﬀusion in cells is not
always fast as compared with the time scales of the reactions. If the reactions are faster
than the mixing, we should consider the system as a reaction-diﬀusion one, with discrete
molecules diﬀusing in space. The relation between these time scales will be important, as
indicated by Mikhailov and Hess [14, 21, 22]. As regards these time scales, we recently found
that the spatial discreteness of molecules within the so-called Kuramoto length [2, 23, 24],
over which a molecule diﬀuses in its lifetime (lapses before it undergoes reaction), may yield
novel steady states that are not observed in the reaction-diﬀusion equations [25]. There is
still room for exploration in this ﬁeld, e.g., pattern formation.

Our result does not depend on the details of the reaction and may be applicable to systems
beyond reactions, such as ecosystems or economic systems. The inﬂow of chemicals in a
reaction system can be seen as a model of intrusion or evolution in an ecosystem; both
systems with discrete agents (molecules or individuals), which may become extinct.
In
this regard, our result is relevant to studies of ecosystems, e.g., extinction dynamics with a
replicator model by Tokita and Yasutomi [26, 27]. The discreteness of agents or operations
might also be relevant to some economic models, e.g., artiﬁcial markets.

Most mathematical methods that are applied to reaction systems cannot account for the
discreteness. Although the utility of simulations have become convenient with the progress
of computer technology, it might be useful if we could construct a theoretical formulation
applicable to discrete reaction systems. On the other hand, in recent years, major advances
have been made in the detection of a small number of molecules and fabrication of small
reactors, which raises our hopes to demonstrate the eﬀect of discreteness experimentally.

We believe that molecular discreteness is of hidden but real importance with respect to
biological mechanisms, such as pattern formation, regulation of biochemical pathways, or
evolution, to be pursued in the future.

Acknowledgments

13

This research is supported by grant-in-aid for scientiﬁc research from the Ministry of
Education, Culture, Sports, Science and Technology of Japan (11CE2006, 15-11161). Y.T.
is supported by a research fellowship from the Japan Society for the Promotion of Science.

Appendix: Methods for Simulating Discrete Reaction Systems

Since the 1970s, several methods have been suggested for simulating discrete reaction
systems. We brieﬂy review some of these methods: StochSim method, Gillespie’s methods,
and their improved versions.

These methods are based on chemical master equations. In chemical master equations,
we deﬁne the state of the system as the number of molecules in each chemical; the reaction
process as a series of transitions between the states4. We consider each event, i.e., a reaction
event between molecules, inﬂow or outﬂow of a molecule, as a transition. They take place
stochastically with a certain frequency (probability per time unit) determined by the current
state.

For the simulations used in this study, we adopted Gillespie’s direct method for simplicity5.
We also attempted a direct simulation and the next reaction method, and conﬁrmed that
our result does not depend on the simulation method.

A. Direct Simulation with Fixed Time Step

First, let us consider a very simple approximation, which looks similar to the Euler method

for diﬀerential equations.

In this method, we ﬁx the time step as ∆t. Assuming that the frequency of the event-i is
ai, the average number of the event-i for each step is ai∆t. If
ai∆t ≪ 1, we approximately
assume that at most one event occurs at each step, and the probability of the event-i is ai∆t
(it is possible that no event occurs in the step). We select an event with a random number,
change the state according to the event, and recalculate each ai.

P

B. StochSim Method

From this simple concept, we can derive some variations. The so-called StochSim method

[29] is one such variation.

The StochSim method adopts random sampling of molecules. For bimolecular reactions,
we randomly choose two molecules from the system, and decide whether they react or not

4 Gillespie demonstrated that the chemical master equations are exact for gas-phase, well-stirred systems

5 The next reaction method would be more suitable if the system contains more chemical species and

in thermal-equilibrium [28].

reactions.

14

with certain probability. The method requires three random numbers in total for each
step. In case there are some single molecular (ﬁrst-order) reactions, we choose the second
molecule from the molecules in the system and some pseudo-molecules (dummies). If the
second molecule is a pseudo-molecule, then we select the single molecular reaction of the
ﬁrst molecule, and determine whether it occurs.

In the StochSim method, ∆t is restricted by the fastest reaction (with the largest reaction
rate per pair of molecules). If most of the bimolecular pairs do not react with each other,
or the reaction probability varies with the species, this method may be impractical because
no reaction occurs in most steps.

C. Gillespie’s Direct Method

Incidentally, if the system consists of discrete molecules, it is typical that each frequency
ai changes only when an event actually occurs. Taking this into account, Gillespie suggested
two exact simulation methods: the Direct Method [30] and the First Reaction Method [31].
In these methods, we do not ﬁx the time step. Instead, we calculate the time lapse until
the next event.

In the direct method, ﬁrst, we consider the total frequency of the events, a =

ai. If ai
does not change until the next event, the time lapse until the next event, τ , is exponentially
distributed as P (τ ) = ae−aτ (0 < τ ). We determine the time lapse τ with an exponentially
distributed random number.

P

Subsequently, the probability that the next event is i is ai/a. We determine which event
occurs with a random number. We then set the time t forward by τ , update the state
according to the event, and recalculate each frequency ai. Iterate the above steps until the
designated time elapses.

D. Gillespie’s First Reaction Method

The ﬁrst reaction method is similar to the direct method. It is based on the fact that
τi, the time lapse until the next event-i, is exponentially distributed as P (τi) = aie−aiτi
(0 < τi). Only the event with minimum τi actually occurs. We update the state, recalculate
each ai, and generate all τi again with the new corresponding ai.

In the ﬁrst reaction method, we need as many random numbers each step as the types
of events. We calculate all τi, choose the earliest, and discard the others. Generally, the
processor time to generate random numbers is very large; hence, a large amount of time is
wasted for several types of events.

E. Next Reaction Method

To solve this performance problem, Gibson and Bruck proposed a reﬁnement of the ﬁrst
reaction method: Next Reaction Method [32]. Although, in general, Monte Carlo simula-
tions require independency of random numbers, they proved a safe way of recycling random
numbers, which drastically promotes eﬃciency.

15

In the next reaction method, we store ti, the absolute time when the next event-i occurs,
instead of τi. In the ﬁrst step, we have to calculate ti = τi for every i, according to the
exponential distribution P (τi) = aie−aiτi (0 < τi). We choose the event with the smallest
ti. According to the event, we set the time t forward to ti, change the state, and recalculate
each ai.

In steps that follow, we recalculate each ti as follows.

1. As regards the event just executed, we should recalculate ti = t + τi with the expo-

nential distribution of τi, identical to the ﬁrst step.

2. As regards other events whose frequency ai has changed, we should recalculate the

corresponding ti. For such events, we convert ti as

tnew = told +

(told − t).

aold
anew

told is the ti before the event and tnew is that after the event.
With this conversion, the actual frequency is adjusted from aold to anew, without using
random numbers6.

3. As for other events whose frequency ai has not changed, we do not need to recalculate

the corresponding ti.

Subsequently, we choose the smallest ti, and proceed further.

If the event executed does not inﬂuence ai, we do not need to recalculate the concerned
ai and ti (except for those of the event just executed). Thus, it is useful to manage the
dependency of ai on each event. With this intention, we prepare a dependency graph
that shows which ai should be updated after event-j (event-i depends on event-j). In a
large reaction network, such as biochemical pathways, one chemical species can react with
only a small part of the chemicals in the entire system. In such cases, recalculation is not
required for irrelevant chemical species; hence, we can accelerate simulations with help of a
dependency check.

It is also important to ﬁnd the smallest ti quickly. For this purpose, we use a heap, a
binary tree in which each node is larger than or equal to its parent. The root is the smallest
at any instance7.

The next reaction method requires only one random number per event, and executes much

6 Note that Gibson and Bruck mathematically proved the validity of the method and did not mention
numerical errors in their paper. In some cases, repetition of the conversion might be numerically dangerous.
In case there are various time scales of reactions, incautious coding may result in numerical errors (e.g.,
rare events would not occur forever).

7 The heap sort is an O(N log N ) sorting algorithm. If only one ti has changed in the step, the cost of

resorting is O(log N ).

faster than ﬁrst reaction method, especially in case of many chemicals and reactions8.

16

[1] G. Nicolis and I. Prigogine, Self-Organization in Nonequilibrium Systems (John Wiley, 1977).
[2] N. G. van Kampen, Stochastic processes in physics and chemistry (North-Holland, rev. ed.,

[3] K. Matsumoto and I. Tsuda, “Noise-Induced Order”, Jour. Stat. Phys. 31, 87 (1983).
[4] W. Horsthemke and R. Lefever, Noise-Induced Transitions, edited by H. Haken (Springer,

1992).

1984).

[5] K. Wiesenfeld and F. Moss, “Stochastic resonance and the beneﬁts of noise: from ice ages to

crayﬁsh and SQUIDs”, Nature 373, 33 (1995).

[6] N. Olsson, E. Piek, P. ten Dijke, and G. Nilsson, “Human mast cell migration in response to
members of the transforming growth factor-β family”, Jour. Leukocyte Biol. 67, 350 (2000).
[7] X. Wang, G. Z. Feuerstein, J. Gu, P. G. Lysko, and T. Yue, “Interleukin-1β induces expres-
sion of adhesion molecules in human vascular smooth muscle cells and enhances adhesion of
leukocytes to smooth muscle cells”, Atherosclerosis 115, 89 (1995).

[8] H. H. McAdams and A. Arkin, “It’s a noisy business! Genetic regulation at the nanomolar

[9] C. V. Rao, D. M. Wolf, and A. P. Arkin, “Control, exploitation and tolerance of intracellular

scale”, Trends Genet. 15, 65 (1999).

noise”, Nature 420, 231 (2002).

Single Cell”, Science 297, 1183 (2002).

[10] M. B. Elowitz, A. J. Levine, E. D. Siggia, and P. S. Swain, “Stochastic Gene Expression in a

[11] L. A. Blumenfeld, A. Y. Grosberg, and A. N. Tikhonov, “Fluctuations and mass action law
breakdown in statistical thermodynamics of small systems”, Jour. Chem. Phys. 95, 7541 (1991).
[12] L. A. Blumenfeld and A. N. Tikhonov, Biophysical Thermodynamics of Intracellular Processes

— Molecular Machines of the Living Cell (Springer-Verlag, New York, 1994).

[13] P. Stange, A. S. Mikhailov, and B. Hess, “Coherent Intramolecular Dynamics of Enzymic

Reaction Loops in Small Volumes”, Jour. Phys. Chem. B 104, 1844 (2000).

[14] A. S. Mikhailov and B. Hess, “Self-Organization in Living Cells: Networks of Protein Machines

and Nonequilibrium Soft Matter”, Jour. Biol. Phys. 28, 655 (2002).

[15] Y. Togashi and K. Kaneko, “Transitions induced by the discreteness of molecules in a small

autocatalytic system”, Phys. Rev. Lett. 86, 2459 (2001).

[16] Y. Togashi and K. Kaneko, “Alteration of Chemical Concentrations through Discreteness-
Induced Transitions in Small Autocatalytic Systems”, Jour. Phys. Soc. Jpn. 72, 62 (2003).
[17] K. Kaneko and T. Yomo, “On a Kinetic Origin of Heredity: Minority Control in a Replicating

System with Mutually Catalytic Molecules”, Jour. Theor. Biol. 214, 563 (2002).

[18] K. Kaneko, “Kinetic Origin of Heredity in a Replicating System with a Catalytic Network”,

[19] K. Kaneko, “Recursiveness, switching, and ﬂuctuations in a replicating catalytic network”,

Jour. Biol. Phys. 28, 781 (2002).

Phys. Rev. E 68, 031909 (2003).

[20] T. Matsuura, M. Yamaguchi, E. P. Ko-Mitamura, Y. Shima, I. Urabe, and T. Yomo, “Impor-
tance of compartment formation for a self-encoding system”, Proc. Nat. Acad. Sci. 99, 7514
(2002).

[21] B. Hess and A. Mikhailov, “Self-Organization in Living Cells”, Science 264, 223 (1994).

8 While the next reaction method is an exact algorithm, there are also some approximate methods derived

from Gillespie’s algorithms, e.g., refs. [33, 34].

17

[22] B. Hess and A. Mikhailov, “Microscopic Self-organization in Living Cells: A Study of Time

Matching”, Jour. Theor. Biol. 176, 181 (1995).

[23] Y. Kuramoto, “Fluctuations around Steady States in Chemical Kinetics”, Prog. Theor. Phys.

[24] Y. Kuramoto, “Eﬀects of Diﬀusion on the Fluctuations in Open Chemical Systems”, Prog.

49, 1782 (1973).

Theor. Phys. 52, 711 (1974).

[25] Y. Togashi and K. Kaneko, “Molecular discreteness in reaction-diﬀusion systems yields steady

states not seen in the continuum limit”, to appear in Phys. Rev. E (2004).

[26] K. Tokita and A. Yasutomi, “Mass extinction in a dynamical system of evolution with variable

dimension”, Phys. Rev. E 60, 842 (1999).

[27] K. Tokita and A. Yasutomi, “Emergence of a complex and stable network in a model ecosystem

with extinction and mutation”, Theor. Popul. Biol. 63, 131 (2003).

[28] D. T. Gillespie, “A rigorous derivation of the chemical master equation”, Physica A 188, 404

(1992).

[29] C. J. Morton-Firth and D. Bray, “Predicting Temporal Fluctuations in an Intracellular Sig-

nalling Pathway”, Jour. Theor. Biol., 192, 117 (1998).

[30] D. T. Gillespie, “Exact Stochastic Simulation of Coupled Chemical Reactions”, Jour. Phys.

Chem. 81, 2340 (1977).

[31] D. T. Gillespie, “General method for numerically simulating stochastic time evolution of cou-

pled chemical-reactions”, Jour. Comput. Phys. 22, 403 (1976).

[32] M. A. Gibson and J. Bruck, “Eﬃcient Exact Stochastic Simulation of Chemical Systems with

Many Species and Many Channels”, Jour. Phys. Chem. A 104, 1876 (2000).

[33] D. T. Gillespie, “Approximate accelerated stochastic simulation of chemically reacting sys-

tems”, Jour. Chem. Phys. 115, 1716 (2001).

[34] C. V. Rao and A. P. Arkin, “Stochastic chemical kinetics and the quasi-steady-state assump-

tion: Application to the Gillespie algorithm”, Jour. Chem. Phys. 118, 4999 (2003).

18

x1x2x3x4

N1
N2
N3
N4

20

40

60

80

100

Time

FIG. 1: Time series of the concentration xi at the continuum limit for r = 1, s = 1, and D = 1/32.
With D > 0, the rate equation has a stable ﬁxed point ∀i : xi = 1. Each xi converges to the ﬁxed
point.

2.5

1.5

3

2

1

n
o
i
t
a
r
t
n
e
c
n
o
C

0.5

0

0

1400

1200

1000

800

600

400

200

0
5140

5160

5180

5200

5220

5240

Time

FIG. 2: Time series of the number of molecules Ni for V = 512 and D = 1/256. Each Ni ﬂuctuates
around the ﬁxed point (as seen in Fig. 1) but does not reach 0.

19

0
300

350

400

450

550

600

650

700

500
Time

FIG. 3: Time series of Ni for V = 32 and D = 1/256. In this stage, Ni can reach 0, and the switching
states appear. In the 1-3 rich state, the system successively switches between the N1 > N3 and
N1 < N3 states. The interval of switching is much longer than the period of continuous vibration
(≈ π) observed in Figs. 1 and 2. Around t = 520, a transition occurs from the 1-3 rich to the 2-4
rich state.

160

140

120

100

80

60

40

20

0.6

0.5

0.4

0.3

0.2

0.1

N1
N2
N3
N4

V=2048
512
256
128
64
32
8
2

0

-8

-6

-4

-2
2
0
(x1+x3) - (x2+x4)

4

6

8

FIG. 4: The probability distribution of the index z = (x1 +x3)−(x2 +x4), sampled over 5×106 time
units. (z is actually a discrete value. Here, we show the distribution as a line graph for visibility.)
D = 1/128. When V is large (V ≥ 256), there appears a single peak around z = 0, corresponding
to the ﬁxed point state ∀i : xi = 1. For V ≤ 64, the distribution has double peaks around z = ±4.
The peak z ≈ 4 corresponds to the 1-3 rich state, with N1 + N3 ≈ 4V , N2 = N4 = 0. z ≈ −4
corresponds to the 2-4 rich state as well.

20

V=512
256
128
64
32
16
8
2

0

-8

-6

-4

2
0
-2
(x1+x2) - (x3+x4)

4

6

8

FIG. 5: The probability distribution of the index y = (x1 + x2) − (x3 + x4), sampled over 5 × 106
time units. D = 1/128. When V is large, there appears a single peak around y = 0, corresponding
to the ﬁxed point. When V is small and the system is in the switching states, the index y shows an
imbalance between the rich (non-zero) chemicals. For example, in the 1-3 rich state, y corresponds
to x1 − x3 since N2 = N4 = 0 for the most part. The distribution shows double peaks around
y = ±3. Assuming that x1 + x3 = 4 and x2 = x4 = 0 in the 1-3 rich state, y = ±3 correspond to
(x1, x3) = (3.5, 0.5), (0.5, 3.5). Both the chemicals are likely to have a large imbalance.

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

1

129

3
N

 
l

a
n
F

i

65

2

64

Initial N3

127

y
t
i
l
i

b
a
b
o
r
P

1

10-1

10-2

10-3

10-4

FIG. 6: Probability density for the switch from (N1, N3) = (N1ini, N3ini) to (N1f in, N3f in). We
assume a switching event triggered by a single X2 molecule in the 1-3 rich state, and we set the initial
conditions as N2 = 1 and N4 = 0. Assuming that there is no further ﬂow (D = 0), we numerically
follow the master equation (eq. (2)) until t = 50 (suﬃciently large to ensure N2 = 0 for most cases).
For each initial condition, we show the transition probabilities of the ﬁnal states (N1f in, N3f in).
V = 32, N1ini + N3ini = 128. The system shows high probabilities around N3f in = N3ini + 1
(immediately terminated) and N3f in = N1ini (switching; N1ini > N3ini).

FIG. 7: Probability for N2 = 0, i.e., reactions have already stalled, as a function of t (in other
words, the cumulative distribution of the time when N2 reaches 0). V = 32, N1ini + N3ini = 128.
In the case where N1ini < N3ini or N1ini ≈ N3ini, the probability increases just after the reactions
start. For such initial conditions, the reactions terminate near the initial state, as shown in Fig. 6.
If N1ini ≫ N3ini, the probability steeply increases at t ≈ 4, which corresponds to the switching.
The system takes ≈ 4 time units to complete the switching.

21

1

0.8

y
t
i
l
i

b
a
b
o
r
P

0.6

0.4

0.2

0

0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

i

e
c
n
e
d
s
e
r
 
f
o
 
e
t
a
R

(N1ini, N3ini)
(1, 127)
(64, 64)
(80, 48)
(96, 32)
(112, 16)
(120, 8)
(124, 4)
(126, 2)
(127, 1)

2

Time

4

6

D=1/2048
1/1024
1/512
1/256
1/128
1/64
1/32
1/16

0
0.02

0.05

0.1

0.2

0.5

1

2

5

DV

FIG. 8: The rate of residence of the switching states plotted against DV , the inﬂow frequency,
sampled over 106 (V > 1024), 107 (32 < V ≤ 1024), and 108 (V ≤ 32) time units. Here, we deﬁne
the 1-3 rich state as continuation of the state in which at least one of N2 or N4 is 0 for 8 time units
or longer. Thus, the system may contain states with only one or no chemical, especially for small
V . We observe the switching states for DV < 1.

22

N1
N2
N3
N4

50000

45000

40000

35000

30000

25000

20000

15000

10000

5000

0.14

0.12

0.1

0.08

0.06

0.04

0.02

n
o

i
t

p
u
r
r
e

t

n

i
 
f

o

 
y
t
i
l
i

b
a
b
o
r
P

0
51000

51200

51400

51600

51800

52000

Time

−6. For such a small D, we observe the switching
FIG. 9: Time series of Ni for V = 104 and D = 10
states for relatively large V . In this case also, a single molecule can induce switching. One X1
molecule ﬂows in (N1 = 1), propagates to more than 104, and then returns to 0.

(N1 ini, N3 ini) = (127, 1)
(126, 2)
(124, 4)
(120, 8)
(112,16)
(104,24)
(96,32)
(80,48)
(64,64)
(32,96)

0

0

1

2
3
Delay (X2, X4)

4

5

FIG. 10: Probability for interruption of the 1-3 rich state as a function of the delay τ , sampled
over 105 times for each condition. We assume the system where N2 = N4 = 0. We inject an X2
molecule at t = 0, then an X4 molecule at t = τ (no further ﬂow). If ∀i : Ni > 0 at t = 8, we
ascertain that the system has escaped from the 1-3 rich state. V = 32, N1ini + N3ini = 4V (= 128).
An initial large imbalance, such as N1ini : N3ini = 120 : 8 (15 : 1), makes it easier to escape the 1-3
rich state. The system is unlikely to escape from the state when N1ini ≈ N3ini or N1ini < N3ini.
The probability is maximum at τ ≈ 2, which approximately corresponds to a half of the period of
the vibration around the ﬁxed point.

k = 3

k = 5

N1
N2
N3

23

N1
N2
N3
N4
N5

250

200

150

100

50

10200
Time

250

200

150

100

50

250

200

150

100

50

0
10300

k = 6

N1
N2
N3
N4
N5
N6

0
10100

10150

10250

10300

10350

10450

10500

10400
Time

0
10000

10050

10100
Time

10150

10200

FIG. 11: Time series of Ni for k = 3, 5, 6, with V = 64 and D = 1/256. For the case where k = 6,
the transition occurs from the 1-3-5 rich state to the 2-4-6 rich state at t ≈ 10080. For the cases
where k = 3 and k = 5, there are no stable states such as the 1-3 rich state when k = 4 or 1-3-5
rich state when k = 6.

24

x1
x2
x3
x4

2

1.9

1.8

1.7
0.3

0.2

0.1

0

x1
x2
x3
x4

2.4

2.2

2

1.8

1.6
0.2

0

1

10

1000 10000

1

10

1000 10000

100
V

(a)

100
V

(b)

FIG. 12: The average concentration ¯xi as a function of V , sampled over 106 (V > 1024), 107
(32 < V ≤ 1024), and 108 (V ≤ 32) time units (same for Fig. 14). r = 1 and D = 1/128. (a) Case
I: s1 = s3 = 1.7, s2 = s4 = 0.3. When V is small, the 1-3 rich state appears, and the diﬀerence
between ¯x1 and ¯x2 increases. (b) Case I
: s1 = s3 = 1.9, s2 = 0.19, s4 = 0.01. When V is small,
¯x2 and ¯x4 decrease, identical to Case I. In this case, the imbalance between ¯x1 and ¯x3 appears
[16] by permission of the
at the same time. (Figures 12, 14, 15, and 17 are reproduced from ref.
publisher.)

′

V=4096
2048
1024
512
256
64
16
4

1.8

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

0

-3

-2

-1

0
(x1+x2) - (x3+x4)

1

2

3

FIG. 13: Probability distribution of y ≡ (x1 + x2) − (x3 + x4), for Case I
: s1 = s3 = 1.9, s2 = 0.19,
s4 = 0.01, r = 1, and D = 1/128. There is a peak around y = 0 for large V . The diﬀerence in si
has a slight eﬀect on ¯xi. For the case where V ≤ 1024, there appears another peak at y ≈ −0.8,
which corresponds to the 1-3 rich, N1 < N3 state.

′

1

10

100

1000

V

FIG. 14: The average concentration ¯xi, for Case II: s1 = s2 = 1.99, s3 = s4 = 0.01, r = 1, and
D = 1/128. For small V , the 1-3 rich state is preferred, and ¯x3 increases.

25

x1
x2
x3
x4

x1x2x3x4

4

3

2

1

0

4

3

2

1

0

1

10

100

1000

V

FIG. 15: The average concentration ¯xi for s1 = 0.09, s2 = 3.89, s3 = s4 = 0.01, r = 1, and
D = 1/64, sampled over 5 × 106 (V > 32) or 5 × 108 (V ≤ 32) time units. By decreasing V , ﬁrst,
the 2-4 rich state appears, as seen in Case I. Then, the 2-4 rich state becomes unstable and gives
way to the 1-3 rich state, as seen in Case II. When V is extremely small (V < 0.5), the ﬂow of
molecules governs the system, and ¯x2 increases again.

26

N1
N2
N3
N4

1200

1000

800

600

400

200

0
1200

N1
N2
N3
N4

180

160

140

120

100

80

60

40

20

1400

1800

37800

38200

1600
Time

0
37600

2000
(a)

38000
Time

38400
(b)

FIG. 16: Time series of Ni for s1 = 0.09, s2 = 3.89, s3 = s4 = 0.01, r = 1, and D = 1/64. (a)
′
V = 256. The 2-4 rich state is dominant (Case I
). Inﬂow of X3 molecules induces switching from
N2 > N4 to N2 < N4, which prevents N4 from decreasing to 0. (b) V = 32. Now, the X3 inﬂow
is rare, which allows N4 to reach 0 before the switching. Thus, the 2-4 rich state is unstable (Case
II).

V=2048
1024
512
256
128
64

1.8

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

1

2

x2

3

4

5

FIG. 17: Distribution of x2 for s1 = 0.09, s2 = 3.89, s3 = s4 = 0.01, r = 1, and D = 1/64, sampled
over 5 × 106. For large V , a single peak around x2 = 2 appears, which corresponds to the ﬁxed
point in the continuum limit. At V ≈ 103, double peaks appear around x2 = 1 and x2 = 3, which
correspond to the 2-4 rich state. By decreasing V , the two peaks spread apart. At V ≈ 102, the
skirt of the low-density (left) peak touches x2 = 0, implying that N2 (and N4) is likely to reach 0,
and thus, the 2-4 rich state loses stability. A peak at x2 = 0 steeply grows by decreasing V further.

27

x1x2x3x4

1.5

0.5

2

1

0

x1x2x3x4

1.6

1.4

1.2

1

0.8

0.6

1

10

1000

10000

1

10

1000

10000

100
V

(a)

100
V

(b)

FIG. 18: The average concentration ¯xi for ∀i : si = 1 and D = 1/128 with inequivalent reaction
constants. For small V , the ﬂows of molecules dominate the system. Thus, ¯xi ≈ 1, which simply
reﬂects si = 1; this does not depend on how the continuum limit is imbalanced by the reactions.
(a) r1 = r3 = 1 and r2 = r4 = 0.9. (b) r1 = r2 = 2 and r3 = r4 = 1.

