Understanding the temperature and the chemical potential using

computer simulations

Department of Physics, Kalamazoo College, Kalamazoo, Michigan 49006

Department of Physics, Clark University, Worcester, Massachusetts 01610

Department of Physics, University of Massachusetts, Amherst, Massachusetts 01003

Received Date: 10/13/04 Accepted Date: 10/26/04 Index Code: 2.70, 5.20, 5.70

Several Monte Carlo algorithms and applications that are useful for understanding the concepts

of temperature and chemical potential are discussed. We then introduce a generalization of the

demon algorithm that measures the chemical potential and is suitable for simulating systems with

variable particle number.

Jan Tobochnik∗

Harvey Gould†

Jonathan Machta‡

Abstract

4
0
0
2
 
v
o
N
 
7
1
 
 
]
h
p
-
d
e
.
s
c
i
s
y
h
p
[
 
 
1
v
1
6
1
1
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

I.

INTRODUCTION

There are several physical quantities in thermal physics that are diﬃcult to understand

because their operational deﬁnitions involve sophisticated reasoning. For example, what is

temperature and what is the best way to introduce it? One way to introduce the temperature

is to invoke kinetic theory or the equipartition theorem and take the temperature to be

proportional to the mean kinetic energy per particle of a system. However, the use of simple

kinetic theory involves many approximations, which can lead to doubt and confusion in

the minds of many students as to the generality of the relation between the temperature

and kinetic energy. Others will say that temperature is a measure of internal energy, and

some will deﬁne the temperature as what a thermometer measures. However, the latter

deﬁnition requires a long and subtle argument about how the change in some property of a

thermometer (such as the volume of a column of mercury) can be calibrated.

To understand the role of temperature, it is necessary to realize that when two objects

at diﬀerent temperatures are brought into thermal contact, energy is transferred from the

hotter object to the colder object until the temperature of the two objects becomes the same.

Temperature is a measure of how easy it is for an object to give up its energy. The higher

the temperature, the easier it is. It is a fact of nature that this single quantity determines

the direction of energy transfer in systems near equilibrium.

The nature of the chemical potential is even more obscure for beginning students of

statistical physics.1 Unlike temperature, the chemical potential is not familiar from everyday

life. The chemical potential determines the direction of transfer of particles between systems

that can exchange particles. The higher the chemical potential, the easier it for an object

to give up particles.

When discussing abstract concepts, it is useful to think in terms of a simple model in order

to strip away complicating factors that accompany actual measurements but are tangential

to conceptual understanding. For example, we use ideal clocks and meter sticks when

discussing time and space. For this reason, it would be useful to have an ideal thermometer.

In this paper we will introduce an ideal thermometer in the context of computer simula-

tions of thermal systems. We also will discuss a new simulation algorithm that can be used

to measure the chemical potential. The latter is based on a generalization of the demon

algorithm introduced by Cruetz.2

2

II. THE DEMON ALGORITHM

Computer simulations provide a vehicle for understanding many of the key concepts in

statistical mechanics. Most simulations are based on either Monte Carlo or molecular dy-

namics algorithms.3 In Monte Carlo simulations the conﬁgurations are sampled according

to the appropriate probability distribution, and averages are computed from these conﬁg-

urations. One of the most inﬂuential Monte Carlo algorithms is the Metropolis algorithm

whose 50th anniversary was celebrated in 2003.4 This algorithm simulates a system at con-

stant temperature T , volume V , and number of particles N, that is, it samples conﬁgurations

in the canonical ensemble. We summarize it here so that the reader can see how it relates

to the demon algorithm which we will describe next.

1. Begin with an arbitrary initial conﬁguration with the desired values of V and N. If

the system consists of particles, the conﬁguration would specify the positions of the

particles. If the system were a lattice of spins, the conﬁguration would consist of the

orientation of each spin.

the change in energy, ∆E.

2. Make a trial change such as moving a particle at random or ﬂipping a spin and compute

3. If ∆E

0 or if r

e−β∆E, where r is a random number uniformly distributed in the

≤

≤

unit interval, then accept the change. Otherwise, reject the change, but include the

unchanged conﬁguration in the system averages. Here β = 1/kT and k is Boltzmann’s

constant.

4. Repeat steps 2 and 3 and compute various averages and their statistical uncertainties

periodically. Allow the system to equilibrate before computing averages.

Once the system has reached equilibrium, the Metropolis algorithm produces conﬁgurations

that occur with a probability proportional to the Boltzmann distribution.

In the Metropolis algorithm the temperature is an input parameter, and we cannot obtain

much insight into its nature by using this algorithm. We now describe the demon algorithm

for which the energy is an input parameter and temperature is measured, thus providing

a way of thinking about the temperature. In this algorithm one extra degree of freedom,

called the demon, can exchange energy with the system of interest, and the energy of the

3

system plus the demon is kept constant. The demon satisﬁes only one constraint, namely,
its energy, Ed, satisﬁes Ed ≥
microcanonical or constant energy ensemble.

0. Thus, the demon algorithm samples conﬁgurations in the

The steps of the demon algorithm can be summarized as follows:

1. Begin with an arbitrary initial conﬁguration with the speciﬁed parameters, E, V , and

N. Obtaining such a conﬁguration is usually more diﬃcult than determining an initial

conﬁguration for the Metropolis algorithm. For simplicity, we usually set Ed = 0, but

we may give it any (positive) value such that the total energy E has the desired value.5

2. Make a trial change in the system and compute the change in energy, ∆E.

3. If ∆E < Ed, accept the change, and subtract ∆E from Ed. Otherwise, reject the

change, but include the unchanged conﬁguration as the new conﬁguration.

4. Repeat steps 2 and 3 as in the Metropolis algorithm. In addition, accumulate data for

the histogram of demon energies, H(Ed), after each Monte Carlo step per particle or

lattice site.

algorithm.2

Note that an immediate advantage of the demon algorithm is that fewer random num-

bers and no computationally expensive calculations of the exponential function are needed.

Thus, for some calculations the demon algorithm can be much faster than the Metropolis

We now discuss why the demon acts as an ideal thermometer. The latter should be

as small as possible so that it does not aﬀect the system of interest, and should have a

convenient macroscopic property that changes in a well deﬁned way with the temperature.

The demon satisﬁes both conditions. If the system of interest has many degrees of freedom,

the demon is a small perturbation of order 1/N on the system. As N increases, the demon

becomes less signiﬁcant, and thus the demon becomes an ideal measuring device. The demon

exchanges energy with the system, but does not change its energy very much.

To relate the properties of the demon to the temperature, we can go back to the funda-

mental deﬁnition of temperature,

(1)

1
T

=

∂S
∂E

,

4

(2)

(3)

(4)

(5)

where S(E) is the entropy and E is the energy of the system. The entropy in the micro-

canonical ensemble is deﬁned in terms of the number of states of the system with energy E,

Ω(E):

S(E) = k ln Ω(E).

The basic principle of statistical mechanics is that all states with the same energy are equally

likely, and because the demon can have only one state for each of its possible energy values,

it follows that the probability of ﬁnding the demon with energy Ed is proportional to the

number of states of the system at energy E,

P (Ed)

Ω(E).

∝

Note that Ed and E are linearly related because E + Ed is held ﬁxed during the simulation.

We can now determine the number of accessible states in terms of the entropy and its

derivative:

we ﬁnd,

Ω(E) = exp[S(E)/k] = exp hS(E + Ed)/k

Ed

−

∂S(E)
∂E

+

· · · i.

In the limit Ed ≪
From the deﬁnition of the temperature, Eq. (1), and the fact that S(E + Ed) is a constant,

E we can ignore higher terms in the Taylor expansion of the entropy.

P (Ed)

e−βEd.

∝

Thus a plot of ln P (Ed) versus Ed will be a straight line with a slope of

β. Hence, the

−

demon measures the temperature without disturbing the system of interest. Moreover, the

mean value

= kT for any dimension if the demon energy distribution is continuous.6

Edi

h

Note that Eq. (5) is simply the Boltzmann probability for a system at temperature T to be

in a microstate with energy Ed.

By thinking about how the demon works, we can develop an intuition about temperature.

For example, high temperatures or small β implies that it is easy for the demon to obtain

energy from the system, and hence a plot of ln P (Ed) versus Ed would have a shallow slope.

At low temperatures the system has diﬃculty giving up energy and thus the slope of ln P (Ed)

would be steep. We also can see that the temperature is an intensive quantity. If we increase

the size of the system (doubling the volume and number of particles for example), the internal

energy would double, but the temperature would be unchanged. From the perspective of

5

the demon, the changes in the energy during trial moves do not depend on the size of the

system, and thus there is no reason why the energy distribution of the demon should change,

and hence the temperature measured by the demon is independent of the size of the system.

For many purposes the equipartition theorem provides a way of deﬁning or determining

the temperature. The theorem states that for a classical system in equilibrium with a heat

bath at temperature T , the mean value of each contribution to the total energy that is

quadratic in a coordinate in phase space is 1

2kT . Thus, for an ideal monatomic gas of
N particles in three dimensions, the total internal energy is given by 3NkT /2. However,

students frequently do not appreciate that this relation holds only for quadratic degrees of

freedom and only for classical systems. The equipartition theorem also is independent of the

interactions, if any, between the particles, a fact that is obscured by the usual derivations

of the theorem for an ideal gas.

We can easily demonstrate the nature of the equipartition theorem by applying the demon

algorithm to the ideal gas for which the kinetic energy of a particle is given by ǫ(p) = p2/2m.

In this case the trial moves are changes in the momentum p of a particle. Figure 1 shows

the demon probability distribution for an ideal gas of N = 100 particles in one and two

dimensions. We ﬁnd

E/N

= (1/2)kT for d = 1 and

E/N

= kT for d = 2, consistent

h

i

h

i

with the predictions of the equipartition theorem to within a few percent. The agreement

could be improved by running for more than only 3000 Monte Carlo steps per particle and

by eliminating some of the higher energy results which have more scatter. Also for these

higher energies the demon energy has become a signiﬁcant fraction of the total energy, and

hence the Boltzmann distribution becomes less applicable because of ﬁnite size eﬀects.

We can easily modify the simulation by assuming relativistic particles so that the kinetic

energy of a particle is proportional to its momentum, that is, ǫ

p. In this case the demon

∝

algorithm still produces a linear plot for ln P (Ed) versus Ed, but the temperature derived

from this plot is not the same as that given by the kinetic energy per particle of the system.

Instead if ǫ

p, each momentum degree of freedom contributes kT to the mean energy. For

a two-dimensional relativistic gas we ﬁnd that T = 0.503 from the demon energy distribution

(see Fig. 1), but

E

/N = 0.995, which is consistent with our expectation, but not with the

∝

h

i

usual statement of the equipartition theorem.

Even though the internal energy is a function of temperature, these two concepts play

diﬀerent roles in thermodynamics. Often students say that the temperature is a measure of

6

the internal energy. Some textbooks use the term thermal energy to refer to kT . However, it

is less confusing to students if the diﬀerence between the concepts of energy and temperature

is emphasized. Temperature is a measure of the ability of a system to take on energy by

heating or cooling. Clearly, it has a conceptual role that is distinct from any form of energy.

There are many systems that have no kinetic energy at all and yet these systems have

a well deﬁned temperature. For example, the Ising model of magnetism assumes that the

internal energy of a conﬁguration of spins in the absence of an external magnetic ﬁeld is

E =

J

−

X
<ij>

sisj,

(6)

where J is the coupling constant, which is usually set equal to unity in a simulation, and

si =

±

1; the index i denotes the lattice site. The notation <ij> indicates that the sum is

over nearest neighbor pairs of spins. The demon algorithm can be applied to the Ising model,

and indeed that was its ﬁrst use.2 Trial changes are made by choosing a spin at random and

attempting to ﬂip it. In Fig. 2 we show a plot of ln P (Ed) versus Ed for the one-dimensional

Ising model. Note that the possible values of the demon energy are multiples of 2, because

ﬂipping a spin can only change the energy by 0, 2, or 4.7 The value of the slope of the ﬁtted

line in Fig. 2 implies that the temperature is approximately 0.625. The mean system energy

per spin is found to be

0.801 (in units for which J = 1). As is well known the energy

increases with temperature, but the dependence is not linear.

−

As we have mentioned, the probability distribution of the demon is not a perfect expo-

nential for larger values of Ed because of ﬁnite size eﬀects that exist in any simulation. The

reason goes back to the derivation of the Boltzmann distribution. In such a derivation the

system of interest is assumed to be small so that its energy ﬂuctuations are much smaller

than the ﬂuctuations of the energy of the heat bath with which it is in thermal contact. In

our simulations the demon plays the role of the system of interest, and the simulated system

plays the role of the heat bath. As we have seen it is possible for the demon to obtain a

signiﬁcant fraction of the energy of the system. An example of this curvature can be seen in

the plot in Fig. 3 of ln P (Ed) for larger Ed; in this simulation N = 10 and the mean energy

of the demon is 1.68, which is 16.8% of the total energy of the system.

Another desirable feature of the demon algorithm is that it can be used in conjunction

with other simulations. We could add the demon algorithm to a Metropolis or MD simulation

and measure the temperature with the demon and compare it to other measures of the

7

temperature.

III. THE CHEMICAL POTENTIAL DEMON

Just as temperature measures the ability of a system to transfer energy to another system

and pressure is a measure of the ability of a system to transfer volume, the chemical potential

is a measure of the ability of a system to transfer particles. Two systems in thermal and

particle equilibrium will come to the same temperature and the same chemical potential.

The chemical potential can be measured using the Metropolis algorithm and the Widom

insertion method.8 From thermodynamics we know that

µ = (cid:16)

∂F
∂N (cid:17)V,T

=

kT ln

−

ZN +1
ZN

(7)

(8)

in the limit N

, where F is the Helmholtz free energy and ZN is the N-particle partition
function. The ratio ZN +1/ZN is the average of e−β∆E over all possible states of the added

→ ∞

particle with added energy ∆E.

In a Monte Carlo simulation with Widom insertion we

would compute the change in the energy ∆E that would occur if an imaginary particle

were added to the N particle system at random for many conﬁgurations generated by the

Metropolis algorithm. The chemical potential is then given by

µ =

kT ln
h

−

e−β∆E

,

i

where the average

is over many conﬁgurations distributed according to the Boltzmann

. . .
i

h

distribution. Note that in the Widom insertion method, no particle is actually added to the

system during the simulation.

If we consider an ideal classical gas and consider only the momentum degrees of freedom,

then Eq. (8) would lead to the usual analytical result for µ (see Eq. (12)) if we include a

factor of 1/N in the argument of the logarithm to account for the indistinguishability factor

1/N! in ZN . Because the contribution to the chemical potential due to the momentum

degrees of freedom is known exactly, only the position degrees of freedom are retained in

typical Monte Carlo simulations of interacting systems, and the chemical potential in Eq. (8)

is interpreted as the excess chemical potential beyond the ideal gas contribution.9

Although the Widom insertion method gives some insight into the nature of the chemical

potential, it is not easy to obtain an intuitive understanding of the chemical potential.1

8

For example, why is the chemical potential negative for a classical ideal gas? A theoretical

argument for the sign of the chemical potential is the following.11 If we add a particle to a

closed system at constant volume and energy, we have from the fundamental thermodynamic

relation

∆E = T ∆S + µ∆N = 0.

(9)

From Eq. (9) we see that adding a particle with no change in energy, ∆E = 0 and ∆N = 1,

can be done only if µ =

T ∆S. Because adding a particle at constant energy and volume

−

can only increase the entropy, we must have µ < 0. This argument breaks down for fermions

at low temperatures because the low energy states are already ﬁlled and thus ∆E

= 0.

To understand the role of the chemical potential, we have extended the demon algorithm

so that the demon also can hold particles. If we use the thermodynamic deﬁnition of µ,

and follow the derivation of Eq. (5), we can show that the probability that the demon has

energy Ed and Nd particles is given by:

µ
T

=

∂S(E, N)
∂N

,

−

P (Ed, Nd)

e−β(Ed−µNd).

∝

(10)

(11)

Thus, the slope of ln P (Ed, Nd) versus Nd for ﬁxed Ed yields βµ and the demon serves as

an ideal measuring device for the chemical potential. Note that Eq. (11) more generally is

the probability of a system at temperature T and chemical potential µ to be in a microstate

with Nd particles and energy Ed.

For simplicity, we introduce a lattice in phase space, including the momentum degrees

of freedom, to do our simulations. The generalized demon algorithm for such a lattice is as

follows:

1. Begin with an arbitrary initial conﬁguration with the desired energy E and number of

particles N. One way to do so is to add one particle at a time to random lattice sites,

computing the total energy at each step until we have added N particles and reached

the desired energy. In the simple systems we will consider here, there are many zero

energy states so that we can simultaneously obtain the desired E and N. Set Ed = 0

and Nd = 0.

2. Choose a lattice site in the system at random.

9

6
3. If there is a particle present at this site, compute the change in energy ∆E that would

result if the particle were removed. If the demon has suﬃcient energy, then accept the

change, subtract ∆E from the demon, and increase Nd by 1, where Nd is the number

of particles held by the demon. Otherwise, reject the move, but include the unchanged

conﬁguration as the new conﬁguration. Go to step 5.

4. If there is no particle present and the demon contains at least one particle, attempt

to place a particle at the chosen site by computing the change in energy, ∆E, needed

to add a particle. If ∆E < Ed, then accept the move, subtract ∆E from Ed, and let
Nd →
the new conﬁguration.

1. Otherwise reject the move, but include the unchanged conﬁguration as

Nd −

5. Repeat steps 2–4 and compute various averages and their statistical uncertainties as

before. Accumulate data for P (Ed, Nd) after each Monte Carlo step per lattice site.

As can be seem, these modiﬁcations of the usual demon algorithm are straightforward.

For dilute systems there is no need to include particle moves as in the original demon

algorithm. These moves are not necessary because every such move is equivalent to a

particle removal at one site and insertion at another. Thus, all possible conﬁgurations can

be reached by only using particle insertions and removals. However, for dense systems the

probability of adding a particle is so low that particle moves would become necessary to

obtain a reasonable exploration of phase space.

We can plot ln P (Ed, Nd) versus Ed for a particular value of Nd or versus Nd for a given

value of Ed. The slope of the ﬁrst plot is

β and the slope of the second is βµ. Sometimes,

−

there is some curvature in the plot of ln P (Ed, Nd) versus Nd, which makes it diﬃcult to

extract the chemical potential. This curvature occurs when the number of particles in the

demon becomes a signiﬁcant fraction of N.

IV. SIMULATION RESULTS

A.

Ideal Gas on a Phase Space Lattice

We ﬁrst consider an ideal classical gas for which the positions and momenta of the particles

take on discrete values. For simplicity, we consider one spatial dimension so that we can

10

visualize the phase space of the system as a two-dimensional lattice. The length of the

lattice along the position axis in phase space is the size of the system, L, but the length in

the momentum direction could be inﬁnite. However, we need only to make it large enough

so that the probability of a particle having a momentum larger than the extent of our

momentum axis is negligible. For our simulations we chose L = 1000 and the momentum

axis to extend from

10 to 10. Visual inspection of the particles in phase space showed that

−

the particles were never near the ends of the momentum axis, and thus the extent of the

momentum axis was suﬃciently large. In order that all energies (= p2/2m) be integers, we

set the mass m = 1/2. In this way each energy index of the array for P (Ed, Nd) equals an

unique value of the energy.

For simplicity, we impose the restriction that no two particles can occupy the same lattice

site in phase space. In the dilute limit, this restriction will have a negligible eﬀect on the

results, but we will show how the restriction changes our results for high density, low energy

systems. In analytical calculations phase space is divided into cells, which is necessary to

allow for the counting of states. This imposition is further justiﬁed using arguments about

the uncertainty principle. A trial move consists of choosing a phase space cell or site at

random and either attempting to add a particle if it is empty or attempting to give the

particle to the demon if the site is occupied. Because we choose a state not a particle, our

algorithm automatically implies the indistinguishability of the particles.

Our lattice model corresponds to a semi-classical model of a ideal gas for which a factor

of 1/N! has been included to account for particle indistinguishability.10 This factor is only

accurate in the dilute limit because it allows more than one particle per state.

As far as we know, this lattice model of an ideal gas has not been simulated in an

educational context, probably because most calculations can be done analytically. However,

by thinking about how the simulations work, we believe that students can obtain a more

concrete understanding. For example, setting up phase space as a two-dimensional lattice

and showing the conﬁgurations can provide an animated visual representation which can

help students better understand the meaning of the analytical calculations.

The results for ln P (Ed, Nd) versus Ed and Nd are shown in Fig. 4 for E = 400, N = 200,

and 10000 mcs. We include all the data so the reader will know what to expect. The results

for large values of Ed or Nd are not accurate because they correspond to probabilities that

are too small for the simulation to determine accurately.

If we were to run signiﬁcantly

11

longer, we would obtain more accurate values. A linear ﬁt to those parts of the data that

fall on a straight line leads to β

0.26 and βµ

2.8.

≈

≈ −

We can compare these simulation results with the analytic result for a one-dimensional

ideal gas in the semiclassical limit:

where h is Planck’s constant. Because the position and momentum values are integers in

our simulation and the analytical result is derived assuming ∆x∆p = h, we have h = 1 in

our units. Also, we have m = 1/2 and k = 1. Thus, in our units Eq. (12) reduces to

µ =

kT ln h

−

L
N (cid:16)

2πmkT
h2

(cid:17)

1/2

i,

µ =

T ln [

(πT )1/2].

−

L
N

(12)

(13)

Figure 5 shows the chemical potential extracted from the slopes of ln P (Ed, Nd) as a function

of the density ρ = L/N for E/N = 2. All data were generated with at least 1000 mcs, which

is suﬃcient to yield µ to within a few percent. As can be seen in Fig. 5, the numerical

data is indistinguishable from the analytical results for small ρ, but deviations occur for

larger ρ, where the analytical value for the chemical potential in Eq. (13) is less than the

value from the simulations. The reason is that although the analytical calculation includes

the same states as the lattice model, the analytical result also includes states with multiple

occupancy, which become important as the density increases. Because the lattice model

has fewer states than is included in the analytical calculation, it is more diﬃcult to add a

particle to the system, and we should obtain a larger chemical potential (less negative). The

increased diﬃculty in adding particles to the system leads to a higher probability that the

demon will have more particles and thus a shallower slope for ln P (Ed, Nd) versus Nd.

We can test this explanation further by changing our simulation so that more than one

particle is allowed at any site in phase space. Because the analytical calculation undercounts

such states, we expect our simulation to lead to a lower value for the chemical potential than

the analytical value. For a dense system with L = 1000, N = 1000, and E = 2000, we ﬁnd

T = 4.1 and µ =

6.2, which is lower than the analytical value of

5.2. However, for the

−

−

same conditions with only single particle occupancy allowed, we ﬁnd T = 3.7 and µ =

3.5,

−

which is larger than the analytical value of µ =

4.5 for this value of T .

A negative chemical potential means a negative slope for ln P (Ed, Nd) versus Nd. Again

we can understand why the chemical potential must be negative. If it were not, then the

−

12

probability that the demon has Nd particles would increase with increasing Nd instead of

decreasing. Although particles can easily move into the demon because it lowers the system’s

energy to do so, there are many places in phase space for the demon to return particles to

the system if the density is small. Any energy the demon receives from taking in a particle

can be used to return the particle to the system. Thus, the demon and the system will

quickly come to equilibrium such that the mean number of demon particles is much less

than the mean number of particles in the system. However, if the system is very dense, then

the system acts as a dense Fermi gas at low temperatures for which the chemical potential

should be positive.

At high densities and low energies, it becomes very diﬃcult to ﬁnd a place in phase space

to return a particle to the system, and hence the mean number of particles in the demon

is a signiﬁcant fraction of all the particles, and is no longer a small perturbation on the

system. Thus we would not expect to ﬁnd an exponential distribution, and we instead ﬁnd

a Gaussian distribution as shown in Fig. 6. (A parabolic plot for ln P indicates a Gaussian

distribution for P .) However, even though the demon takes on many particles, most of them

have zero energy, and the plot of ln P versus Ed is still linear. For this particular simulation

the temperature was T = 0.49. If the chemical potential were negative, then near Nd = 0

the slope of ln P (Nd) would be negative. In our simulation it is positive which indicates a

positive chemical potential.

Our simple ideal gas lattice model also provides another example of how the equipartition

theorem is not always applicable. For a relatively long run of 32,000 mcs with E = 200 and

N = 100, the average energy per particle in the system was found to be 1.965 and the

temperature measured by the demon was 3.76. (The demon holds part of the total energy,

so the average energy per particle in the system must be less than 200/100 = 2.) By

the equipartition function, each degree of freedom provides (1/2)T in energy, and thus the

temperature is given by 1

2T = 1.965 or T = 3.93. The diﬀerence between this predicted
value and the simulation value is statistically signiﬁcant and is due to the discrete nature of

the possible energy values in the simulation.

13

B. Eﬀects of interactions

We next discuss the eﬀects of including interactions between the particles in the system

and consider a lattice-based model with a hard core repulsion so that no two particles can

be at the same position even if they have diﬀerent momenta. We also consider a model with

a hard core and an attractive square well interaction between nearest neighbor particles

with an energy depth equal to

1. We will call these models the hard core and square well

−

models, respectively. Our results are shown in Table I. For all these runs at least 1000 mcs

were done.

≈

For dilute systems, N = 100 or ρ = N/L = 0.1, we see that the temperature is the

same, T

3.8, for all three systems with the same initial energy per particle, E/N = 2.

For the denser system with ρ = 0.6, the three models have diﬀerent temperatures because

the interactions are now important. The diﬀerence between the ideal and hard core gas

is small. However, the temperature is signiﬁcantly higher for the square well model. The

reason is that if there is an attractive square well, some of the total energy is (negative)

potential energy, and thus the total kinetic energy must be greater to maintain the same

sum of kinetic and potential energies as for the other two systems.

The chemical potentials shown in Table I are approximately the same for the dilute low

temperature ideal gas and hard core systems, but the existence of the attractive well lowers

the chemical potential slightly. The reason is that adding a particle can lower the energy

if there is an attractive square well. As the temperature increases, this eﬀect becomes less

important because the kinetic energy dominates the potential energy.

In the dense system, ρ = 0.6, the diﬀerences between the three models become more

pronounced. Adding a hard core repulsion increases the chemical potential, because the

hard core makes it more diﬃcult for the system to accept particles compared to the ideal

gas. When we add the attractive square well, the energy for particles to be added next

to existing particles is lowered, thus making it easier for the system to gain particles. The

result is a lowering of the chemical potential compared to the hard core model, which is what

we ﬁnd in our simulations. Thus, our results conﬁrm the idea that the chemical potential

measures how easy it is for a system to accept particles.

14

C. Oﬀ-lattice simulations

We can do analogous simulations without a lattice using a similar procedure. Instead

of visiting a lattice site and determining if there is a particle present, we introduce a small

volume in phase space, Vp, choose a location in phase space at random, and determine if

there is a particle in this volume centered at the chosen location. The results for the chemical

potential will depend on the value of Vp, in analogy to choosing a value for the cell size in the

analytical calculations. However, this dependence is not important because only diﬀerences

in the chemical potential are physically meaningful.

To compare with our previous results, we simulated a one-dimensional hard core gas

including the momentum degrees of freedom. We set Vp = 1 to be consistent with the

value used in our lattice simulations. Because we used a spherical volume (a disk in two-

dimensional phase space), the radius of the disk was chosen to be 1/√π, so that its area

equals unity. For N = 100 and E = 200 we obtained the same results as with a lattice

system within statistical errors.

Lennard-Jones potential deﬁned by

A common inter-particle potential used to model the interaction of simple atoms is the

V (r) =

4ǫ[(

−

σ
r

)12

(

σ
r

−

)6],

(14)

where σ (equal to 3.4

10−10 m for argon) is the diameter of the repulsive part of the potential

and ǫ (equal to 1.65

10−21 J for argon) is the depth of the attractive part. The potential

×

×

is cutoﬀ at 3σ to reduce the number of interactions. We choose units such that σ = 1 and

ǫ = 1. We did a simulation at low temperature with parameters N = 200, L = 1000, and a

momentum axis ranging from

1 to +1. This range for the momentum axis is suﬃciently

−

large because we initialized the system by randomly placing particles in phase space so that

the total energy did not exceed E = 1. After about 2000 mcs we found the system energy

−

to be

0.39, corresponding to a temperature of 0.60 (corresponding to 72 K for argon) from

the mean demon energy and a chemical potential of

0.29 (corresponding to

4.8

−

10−22 J

−

×

or about 0.003 eV) from the demon particle distribution. The chemical potential is close to

zero because the total system energy is so low that the amount of phase space available for

adding a particle is small. This explanation for the value of the chemical potential reminds

us that the chemical potential is not just a measure of the energy needed to add a particle,

but also is a measure of the number of available states for adding a particle.

15

V. CONCLUSION

The usual demon algorithm and its generalization can be used to help students understand

the concepts of temperature and chemical potential. We believe that discussions of these

algorithms in a thermal and statistical physics class can give students a more concrete model

of thermal and diﬀusive interactions than is possible by formal mathematical derivations.

Although students will gain even more understanding by writing and running their own

programs, much of the beneﬁt can be obtained by discussing the algorithms and how they

lead to a measure of the temperature and chemical potential. It also is important to ask

students to describe how the demon’s energy and particle number distributions will change

under diﬀerent circumstances.

Acknowledgments

Gould and Tobochhnik acknowledge support from the National Science Foundation under

award PHY-98-01878, and Machta acknowledges support from DMR-0242402. Tobochnik

also acknowledges useful discussions with Michael Creutz.

VI. APPENDIX: SUGGESTIONS FOR FURTHER STUDY

In the following we suggest a few problems for students. Example programs and their

source code (in Java) can be downloaded from <stp.clarku.edu/simulations>.

Problem 1. Write a program to estimate the chemical potential of an ideal classical gas in

one dimension by using the Widom insertion method, Eq. (8), and a two-dimensional phase

space lattice. Use the parameters L = 1000, and pmax = 10, and explore the dependence of

the chemical potential on the temperature for a ﬁxed density. Try ρ = 0.2 (N = 200) and

ρ = 0.8 (N = 800).

Problem 2. Write a program to simulate the one-dimensional

ideal gas using a two-

dimensional phase space lattice. Explore the dependence of the chemical potential on the

temperature for a ﬁxed density. Try ρ = 0.1 and ρ = 0.8. Compare your results with

the analytical predictions and discuss the behavior of the chemical potential behaves as a

function of temperature and density.

16

Problem 3. Write a program to simulate the one-dimensional Lennard-Jones ﬂuid using a

two-dimensional phase space. Compute the chemical potential as a function of temperature

and density and compare your results with the corresponding results for the ideal gas.

Problem 4. Write a program to simulate the two-dimensional ideal gas using a four-

dimensional phase space lattice. Choose L = 20, but otherwise use similar parameters

as those for the previous problems. Compare your results with the analytical ones. How

does Eq. (13) change for two dimensions? Are there any qualitative diﬀerences between

one and two dimensions? What happens if interactions are added? Add a hard core and

attractive well. To speed up the simulation and keep the temperature low, you can reduce

the size of the momentum axes.

∗ Electronic address: jant@kzoo.edu

† Electronic address: hgould@clarku.edu

‡ Electronic address: machta@physics.umass.edu

1 Ralph Baierlein, “The elusive chemical potential,” Am. J. Phys. 69, 423–434 (2001). See also

Ralph Baierlein, Thermal Physics (Cambridge University Press, Cambridge, UK, 1999).

2 Michael Creutz, “Microcanonical Monte Carlo simulation,” Phys. Rev. Lett. 50, 1411–1414

(1983).

3 Harvey Gould and Jan Tobochnik, An Introduction to Computer Simulation Methods (Addison-

Wesley, Reading, MA, 1996), 2nd ed. This text discusses various Monte Carlo algorithms in-

cluding the demon and Metropolis algorithms.

4 The Monte Carlo Method in the Physical Sciences: Celebrating the 50th Anniversary of the

Metropolis Algorithm, edited by James E. Gubernatis (AIP Conference Proceedings, Melville,

5 If the demon energy is not continuous, then the initial demon energy should be consistent with

NY, 2003), Vol. 690.

the possible energies of the demon.

6 The mean demon energy is given by

0 e−βEd = kT if the possible demon
energies are continuous. The upper bound can be taken to be inﬁnite even though the total

0 Ed e−βEd/
R

Edi
h

=

R

∞

∞

energy in our simulations is ﬁnite because the high energy states contribute a negligible amount

to the integral.

17

7 In this case the possible demon energies are not continuous and

= kT except in the limit

Edi 6
h

of high temperature.

8 See, for example, Daan Frenkel and Berend Smit, Understanding Molecular Simulation (Aca-

demic Press, San Diego, 1996). The original paper is B. Widon, “Some topics in the theory of

ﬂuids,” J. Chem. Phys. 39, 2802–2812 (1963).

9 For

a

simulation

of

the Widom insertion method

for

hard

disks,

see

<http://www.cheme.buffalo.edu/kofke/applets/Widom.html>. The applet demonstrates

the Widom insertion method for the estimation of the excess chemical potential, µe. For this

model, the fraction of the attempts that ﬁnd no overlap when another disk is added to the

10 See for example, Dan Schroeder, An Introduction to Thermal Physics (Addison-Wesley, Read-

11 See for example, David L. Goodstein, States of Matter (Dover Publications, Mineola, NY, 1985),

system gives exp(

µe/kT ).

−

ing, MA, 2000).

p. 18.

18

TABLE I: Comparison of diﬀerent one-dimensional systems simulated on a phase space lattice.

The system types are an ideal gas with no interparticle interactions; a hard core interaction such

that no two particles can be in the same spatial position; and a hard core plus a nearest neighbor

attractive square well with unit energy depth. N and E are the initial total number of particles and

energy, respectively; T and µ are computed from the slopes of ln P (Ed, Nd). In all the simulations

L = 1000.

N

E T

µ model

100 200 3.81

13.4 hard core

100 200 3.83

13.4 ideal gas

100 200 3.91

14.9 square well

100 800 15.5

66.3 ideal gas

100 800 16.0

66.9 hard core

100 800 15.9

69.7 square well

600 1200 4.03

3.45 hard core

600 1200 3.74

5.90 ideal gas

600 1200 5.26

6.41 square well

600 1000 4.65

5.52 square well

600 800 4.01

4.75 square well

−

−

−

−

−

−

−

−

−

−

−

19

Figure Captions

FIG. 1: Plot of the demon energy distribution, P (Ed), for a demon in equilibrium with a classical

ideal gas of N = 100 particles in d spatial dimensions. The trial moves are momentum changes.

Only 3000 Monte Carlo steps per particle were used. For d = 1 and the usual quadratic rela-

tion between particle energy and momentum, we ﬁnd T = 1.93 from the inverse slope of P (Ed)

and

E
h

/N = 0.980, approximately a factor of two diﬀerence as would be expected from the
i

equipartition theorem. Similarly, for d = 2, we ﬁnd T = 0.948 and

E
h

/N = 0.990, which also is
i

consistent with the equipartition theorem. However, for d = 2 and a linear dispersion relation, we

ﬁnd T = 0.503 and

E
h

/N = 0.995, which, as expected, is not consistent with the equipartition
i

theorem.

20

FIG. 2: The demon energy distribution, P (Ed), for a one-dimensional Ising model with N = 100

and 3000 mcs. The slope is

1.60 which implies that T = 0.625. The energy per particle of the

Ising model is found to be

−
E
h

/N =
i

−

0.801.

FIG. 3: Results for the demon energy distribution for an one-dimensional ideal gas with N = 10

particles showing the strong curvature due to the demon having a signiﬁcant fraction of the total

energy. Over 20,000 mcs were used.

21

FIG. 4: Results for a one-dimensional ideal classical gas on a two-dimensional phase space lattice

with N = 200 and total energy E = 400. The system was equilibrated for 500 mcs and averages were

taken over 10,000 mcs. (a) The demon energy distribution, P (Ed, Nd), for Nd = 0, 2, and 4 with

slopes of

0.26,

0.25, and

0.25 respectively. (b) The demon particle distribution, P (Ed, Nd),

−
−
), 3 ((cid:3)), and 6 (
) with corresponding slopes
for Ed = 0 (
⋄
◦

−

2.85,

2.83, and

2.76, respectively.

−

−

−

The diﬀerences in the various slopes is a measure of the error due to the limited duration of the

simulations and ﬁnite size eﬀects.

FIG. 5: Computed chemical potential µ of the one-dimensional ideal gas versus density using the

generalized demon algorithm. The curve is the analytical result, Eq. (13), for µ assuming an ideal

semiclassical gas with ~ = 1.

22

FIG. 6: The demon particle distribution, P (Ed = 0, Nd), for a dense one-dimensional ideal gas

system with N = 200, E = 50, and L = 200. Because the chemical potential is positive in this

case, the demon takes on a signiﬁcant fraction of the particles.

23

