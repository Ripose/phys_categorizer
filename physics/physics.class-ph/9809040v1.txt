MODAL EXPANSIONS AND ORTHOGONAL COMPLEMENTS

IN THE THEORY OF COMPLEX MEDIA WAVEGUIDE EXCITATION

BY EXTERNAL SOURCES FOR ISOTROPIC, ANISOTROPIC,

AND BIANISOTROPIC MEDIA

A. A. Barybin

Electronics Department, Electrotechnical University,

St. Petersburg, 197376, Russia

Abstract – A uniﬁed electrodynamic approach to the guided wave excitation by external

sources in the waveguiding structures with bianisotropic media is developed. Eﬀect of electric,

magnetic, and magneto-electric losses in such media manifests itself in the special form of
eigenmode orthogonality referred to as the quasi-orthogonality relation. It reﬂects the existence
of the cross-power ﬂow Pkl and loss Qkl for any pair (k, l) of modes which are rigidly linked to
each other by this relation. The quasi-orthogonality relation remains true in the limiting case

of lossless waveguides yielding the customary relations of orthogonality and normalization for

propagating (active) modes and also their generalization for nonpropagating (reactive) modes.

It is shown that the eigenmode set for a waveguiding structure is complete only outside

the region of exciting sources. Inside this region the modal expansions of ﬁelds are incomplete
and must be supplemented with the orthogonal complementary ﬁelds which extend the proper

Hilbert space spanned by waveguide eigenfunctions. Among exciting sources there are the

external bulk sources (currents, ﬁelds, and medium perturbations) and the external surface
currents. Besides, the orthogonal complementary ﬁelds generate the eﬀective surface currents

on boundaries of the bulk exciting sources.

The problem of waveguide excitation by external sources is solved by means of determining

both the mode amplitudes for the modal ﬁeld expansions and the orthogonal complementary

ﬁelds inside the source region. The equations of mode excitation are derived on the basis of

three approaches applying the direct use of Maxwell’s equations, the electrodynamic analogy

with the mathematical method of variation of constants, and the conjugate reciprocity theorem.

8
9
9
1
 
p
e
S
 
8
2
 
 
]
h
p
-
s
s
a
l
c
.
s
c
i
s
y
h
p
[
 
 
1
v
0
4
0
9
0
8
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

CONTENTS

1. INTRODUCTION

BIANISOTROPIC MEDIA

2.1 Poynting’s Theorem

2. GENERAL POWER-ENERGY RELATIONS OF ELECTRODYNAMICS FOR

2.2 Mode Power Transmission and Dissipation

3. ORTHOGONALITY AND QUASI-ORTHOGONALITY OF MODES IN LOSS-

LESS AND LOSSY WAVEGUIDES

3.1 Quasi-orthogonality Relation for Lossy Waveguides

3.2 Mode Orthogonality in Lossless Waveguides

3.2.1 Orthogonality and Normalization Relations for Active Modes

3.2.2 Orthogonality and Normalization Relations for Reactive Modes

3.3 Time-average Stored Energy for Active Modes in Lossless Waveguides

4. ORTHOGONAL COMPLEMENTS AND EFFECTIVE SURFACE CURRENTS

INSIDE SOURCE REGION

4.1 Bulk and Surface Exciting Sources

4.2 Orthogonal Complementary Fields and Eﬀective Surface Currents

5. EQUATIONS OF MODE EXCITATION

5.1 Approach based on the Electrodynamic Method of Variation of Constants

5.2 Approach Based on the Reciprocity Theorem

5.2.1 Derivation of the Conjugate Reciprocity Theorem

5.2.2 Derivation of the Equations of Mode Excitation

6. CONCLUSION

APPENDIX

REFERENCES

1

1.

INTRODUCTION

Guided-wave electrodynamics in the modern understanding deals with the study of propaga-

tion, radiation, excitation, and interaction of waves in a variety of waveguiding structures. The

term ”complex media waveguide” applied in the title of the paper implies the medium com-

plexity of two types:
(i) the physical complexity associated with medium properties diversiﬁed by the very nature

(gas and solid state plasmas with drifting carriers; polarized and magnetized solids with diﬀer-

ent properties: piezoelectric, electrooptic, acoustooptic, magnetooptic, magnetoelastic; chiral,

biisotropic, and bianisotropic media);
(ii) the geometrical complexity due to using composite and multilayered structures.

Electromagnetic theory has been developed up to its present state by extensive works and

eﬀorts of a great number of researchers and scientists. Besides pure scientiﬁc purposes, progress

in classical electrodynamics at all stages of its advancement was encouraged by certain demands

of technology.

At the ﬁrst stage such a stimulating factor was related to practical needs of then incipient

radar and antenna engineering. The consequent experience on electrodynamic properties of

mostly passive nondispersive media speciﬁed by phenomenological constants, which had been

gathered over a number of years, was accumulated in many scientiﬁc publications. Among

them we should refer, for instance, to such famous and popular books as [1 – 5] which now

constitute the theoretical foundation of classical electrodynamics. Much attention was given

to the study of electromagnetic properties of gas plasma as a medium for wave propagation.

Later on the plasma wave aspects were extended to the behavior of charge carriers in solids

considered as a solid-state plasma. At present the literature devoted to the electromagnetic

properties of plasmas is immense and the following books [6 – 11] with their bibliographies can

give a good indication of the scope of plasma electrodynamics.

Another direction of electrodynamic aspects was inspired by developing the technology of

microwave devices operating on wave principle. The ﬁrst to be developed were vacuum devices

using the space charge, cyclotron, and synchronous waves on an electron beam such as the

traveling-wave tube, backward-wave tube, and others [12 – 14]. Later the similar idea to apply

waves in solids for signal processing gave rise to new lines of solid-state electronics. They

are due to applying the surface acoustic waves (SAW) in elastic piezo-dielectrics [15 – 17], the

magnetostatic spin waves (MSW) in magnetized ferrites [18 – 23], and the space charge waves

(SCW) in semiconductors with negative diﬀerential mobility of electrons [10, 24, 25]. These

waves refer to the quasistatic part of the electromagnetic spectrum of waveguiding structures for

which a relevant potential ﬁeld (electric for SAW and SCW or magnetic for MSW) dominates

over its curl counterpart. This fact caused some electrodynamic formulations to be revised in

order to separate such potential ﬁelds and take into account the space-dispersive properties of

these media described by the proper equations of medium motion [15, 22, 24, 25].

2

For the last decades the macroscopic electrodynamics of waveguiding structures has ex-

perienced two powerful stimulating actions. The ﬁrst is associated with needs of ﬁber and

integrated optics and began about twenty ﬁve years ago. A number of theoretical propositions

in electrodynamics were reformulated, as applied to optical waveguides, and have been em-

bodied in devices. The literature devoted to this topic is enormous including the well-known

books [26 – 32].

Nowadays we observe the renewed interest in electrodynamic problems caused by eﬀorts to

apply chiral, biisotropic, and bianisotropic media for the control of electromagnetic radiation in

waveguiding structures. Phenomenon of optical activity in certain natural substances generated

by their handedness property (chirality) was already known last century. The present revival

of scientiﬁc and technological attention to this problem is inspired by the modern progress of

material science and technology in synthesizing artiﬁcial composite media. Such media pos-

sess unique properties to open new potential possibilities in their utilizing in optics and at

microwaves. This has aroused a great wave of research followed by numerous publications,

among them there are the general books [33 – 35] comprising bianisotropic issues and the spe-

cial books [36 – 40] devoted entirely to this subject.

Theoretical ground for many wave electrodynamics applications is the modal expansion

method.

In the case of the eigenmode excitation by external sources the question of com-

pleteness of the eigenfunction basis chosen inside the source region is of crucial importance

in practice. Unfortunately, most authors solve this question rather superﬁcially assuming in-

tuitively that the set of eigenfunctions found as the general solution to the boundary-value

problem without sources is complete also inside the source region. However, this is not the case

in general.

From mathematical considerations given in Appendix A.1 it follows that the above state-

ment is valid only for the desired functions ψ(x) tangential to the Hilbert space spanned by

the eigenfunction basis
. Generally, for most functions f (x) their series expansion in
ψk(x)
}
{
terms of the base functions (convergent in mean) is only a projection ψ(x) of the function f (x)

on the Hilbert space. In addition, there may exist a nonzero function c(x) orthogonal to this
space, the so-called orthogonal complement, which in general must be added to the projection

ψ(x) in order for f (x) to be considered as the complete required function (see Eq. (A.18) and

relevant relations in Appendix A.2). The above statement is fairly obvious for mathematicians

but unfortunately was fully ignored in developing the modern topics of guided-wave electro-

dynamics by most authors, not counting Vainshtein [2] and Felsen and Marcuvitz [8]. Strange

as it may seem, when developing the excitation theory of optical waveguides, many authors

[26, 27, 29, 31, 32] have correctly applied the modal expansions to the transverse components of

electromagnetic ﬁelds but entirely dropped the orthogonal complements due to the longitudinal

exciting bulk currents. As will be shown, this causes the so-called eﬀective surface currents

to be lost. Similar situation also holds for electrodynamics of the waveguiding structures with

chiral and bianisotropic media [34, 38 – 40] where the modal expansion method is practically

3

undeveloped and the problem of the orthogonal complements and eﬀective surface sources,

worked out below, is more complicated.

The objective in writing this paper is to develop a uniﬁed electrodynamic theory of wave-

guide excitation by external sources (bulk and surface) applicable equally for any media and

waveguiding structures. Particular attention will be given to the study of the unexpandable

orthogonal complements to the eigenmode expansions which should be expressed in terms of

the given exciting currents as well as the desired mode amplitudes of the modal expansions.

To this end, we begin with Sec. 2 devoted to deriving the basic energy-power relations of

electrodynamics applied to the lossy bianisotropic media including Poynting’s theorem in the
diﬀerential and integral forms involving the self-power and cross-power quantities (ﬂows and

losses) transmitted and dissipated by the eigenmodes of a waveguiding structure. Sec. 3 deals

with a generalization of the known orthogonality relation for the waveguides without losses to
the so-called quasi-orthogonality relation for lossy waveguides which describes, as a special case,

the orthogonality of the reactive (nonpropagating) modes in lossless waveguides. In addition,

an expression for the time-average energy stored by the active (propagating) modes is proved.

Sec. 4 is concerned with the consideration of external sources (currents, ﬁelds, and medium per-

turbations) and electromagnetic ﬁelds inside the source region. The complete representation of
the ﬁelds, besides their modal expansions, involves also the so-called orthogonal complementary
ﬁelds which necessarily generate the eﬀective surface currents. Sec. 5 contains two diﬀerent ap-

proaches to the derivation of the equations of mode excitation by external sources. The ﬁrst

approach applied only to the lossless waveguides is based on an electrodynamic analogy with

the known mathematical statements such as the method of variation of constants and the rela-

tions of functional analysis (see Appendix A). The second approach makes use of the reciprocity

theorem in the complex-conjugate form to obtain the equations of mode excitation in the ge-

neral form valid for both lossy and lossless waveguiding structures. Another alternative proof

of the excitation equations for lossless waveguides starting directly from Maxwell’s equations

is adduced in Appendix B.

In this paper we restrict our consideration to the case of time-dispersive media whose elec-

trodynamic properties (isotropic, anisotropic, bianisotropic) are characterized by the frequency-

dependent constitutive parameters considered as phenomenologically given. More complicated

case of space-dispersive media such as elastic piezo-dielectrics, magnetized ferrites, nondege-

nerate plasmas with drifting charge carriers whose electrodynamic description requires, besides

Maxwell’s equations, employing the proper equation of medium motion will be the subject of

matter of the second part of the paper.

In conclusion there are a few words concerning the notation applied:

(i) tensors of rank 0 (scalars), 1 (vectors), 2 (dyadics), and more than 2 (tensors) are de-
noted as: A, A, ¯A, and ¯¯A, respectively;
(ii) their products are denoted as: AB (for two scalars); A

B, and AB (for scalar,

B, A

·

×

4

vector, and dyad products of two vectors); AB
¯¯A
·
(A

¯B = AijBjk, and
¯¯B = AijkBklm (for scalar product of two vector dyads, dyadics, and tensors); AB : CD =
C), ¯A : ¯B = AijBji, and ¯¯A : ¯¯B = AijkBkjl (for double scalar product of two
D)(B

CD = AD(B

C), ¯A

·

·

·

·

·

vector dyads, dyadics, and tensors).

2. GENERAL POWER-ENERGY RELATIONS OF ELEC-

TRODYNAMICS FOR BIANISOTROPIC MEDIA

2.1 Poynting’s Theorem

In macroscopic electrodynamics, the electromagnetic properties of a medium are described
by two ﬁeld-intensity vectors, E (the electric ﬁeld) and H (the magnetic ﬁeld), and two ﬂux-
density vectors, D (the electric induction) and B (the magnetic induction), which are related

by means of Maxwell’s equations (written in the rationalized mks system):

∇

×

E =

∂B
∂t

−

∂D
∂t

×

, ∇

H =

+ J , ∇

D = ρ , ∇

B = 0 .

(2.1)

·

·

Mobile charge eﬀects in the medium are speciﬁed by the charge and current densities ρ
and J, whereas the bound charges arise as a result of polarization responses of the medium to
electromagnetic actions characterized by the electric and magnetic polarization vectors P (the
polarization vector) and M (the magnetization vector). These vectors yield the corresponding

conrtibutions to the electric and magnetic inductions:

D = ǫ0E + P

and

B = µ0(H + M) .

(2.2)

The conventional procedure applied to Eqs. (2.1) reduces to Poynting’s theorem in the form

involving the instantaneous values of power-energy quantities:

where w = (E

D + H

B)/2 is the electromagnetic energy density and S = E

H is the

electromagnetic energy ﬂux density (Poynting’s vector). The terms on the right of Eq. (2.3)

·

·

×

∂w
∂t

+ ∇

S =

·

IJ

−

−

IP

−

IM

IJ = J

E ,

·

E

∂P
∂t −

·
∂µ0M

1
2

(cid:18)

H

·

∂t −

∂E
∂t

P

·

µ0M

,

(cid:19)
∂H
∂t

·

(cid:19)

IP =

IM =

1
2

(cid:18)

(2.3)

(2.4)

(2.5)

(2.6)

reﬂect speciﬁc properties of the medium under study and take into account the instantaneous
power of interaction between the electromagnetic ﬁelds (E, H) and the charges – both mobile
ones carrying the current J and bound ones generating the polarization P and magnetization M.
∂D/∂t+
H where the tensors ¯ǫ and ¯µ are symmetric

In the literature the energy term ∂w/∂t is conventionally identiﬁed with the sum E
E and B = ¯µ
∂B/∂t, which is true only if D = ¯ǫ
·

H

·

·

·

5

and time-independent. In this case only the ﬁrst interaction term (2.4) is taken into account,

whereas two others (2.5) and (2.6) are dropped without any justiﬁcation. As will be evident

from our subsequent examination including the second part of the paper, these terms play an

important role in the power-energy theorem.

For time-harmonic ﬁelds (with time dependence in the form of exp(iωt) ) one is usually

interested in time-average values of the power-energy quantities denoted as

. . .
h

. In this case
i

= 0 so that Eq. (2.3) takes the following form involving the time-average values of

∂w/∂t
h
quantities:

i

i − h
Below we concentrate on bianisotropic media for which there is no equation of motion.

i − h

− h

· h

i

i

∇

S

=

IJ

IP

IM

.

(2.7)

Their properties are usually described by the constitutive equations establishing macroscopic

local relations among ﬁeld vectors.

It should be emphasized that magneto-electric eﬀects

(for instance, optical activity), by their microscopic nature, are brought about by nonlocality

of polarization response on electromagnetic actions [33, 35, 36, 41]. But their macroscopic

manifestations are usually similar to those of actual time-dispersive media because for plane
waves with the wave vector k = (ω/c)n all the constitutive tensor parameters of such media

become solely frequency-dependent (see Ref. [41]).

There are a few forms of the constitutive relations for bianisotropic media [33 – 38]. Among

them we choose the following form

D = ¯ǫ
B = ¯ζ

E + ¯ξ

·
E + ¯µ

·

·

H ,

H ,

·

as more convenient for our subsequent examination.

Four constitutive medium parameters ¯ǫ, ¯µ, ¯ξ and ¯ζ are considered as dyadic functions
of frequency given phenomenologically. They comprise all special cases of the physical media

without space dispersion:

(i) for the isotropic medium

(ii) for the double anisotropic medium

¯ǫ = ǫ ¯I ,

¯µ = µ ¯I ,

¯ξ = ¯ζ = 0 ;

¯ǫ

= ǫ ¯I ,

¯µ

= µ ¯I ,

¯ξ = ¯ζ = 0 ;

(iii) for the chiral (biisotropic) medium

(2.8)

(2.9)

(2.10)

(2.11)

¯ǫ = ǫ ¯I,

¯µ = µ ¯I,

¯ξ = (χ

iκ)√ǫ0 µ0 ¯I,

¯ζ = (χ + iκ)√ǫ0 µ0 ¯I,

(2.12)

where χ and κ are Tellegen’s parameter of nonreciprocity and Pasteur’s parameter of chirality,

respectively [35, 38]. It is known [33 – 35] that for a bianisotropic medium without losses the

−

6

6
6
dyadics ¯ǫ and ¯µ are hermitian (self-adjoint) while the dyadics ¯ξ and ¯ζ are hermitian conjugate
(mutually adjoint), that is

¯ǫ = ¯ǫ † ,

¯µ = ¯µ † ,

¯ξ = ¯ζ † ,

(2.13)

¯µ †)/2 and the diﬀerence (¯ξ

where superscript † denotes transpose and complex conjugate (hermitian conjugate). Rela-
¯ǫ †)/2,
tions (2.13) imply that in the general case of lossy media the antihermitian parts ¯ǫ a = (¯ǫ
¯ζ †) are responsible for losses (dielectric, magnetic, and
¯µ a = ( ¯µ
magneto-electric, respectively). If the medium has also the electric losses related to its con-
ductive properties and speciﬁed by the conductivity dyadic ¯σc, then in addition to Eqs. (2.8)
and (2.9) there is another constitutive relation

−

−

−

J = ¯σc

E .

·

Let us calculate the terms in the right-hand side of Eq. (2.7) by using their deﬁnitions (2.4)

through (2.6) and the constitutive relations (2.8), (2.9), and (2.14):

IJ

J

E

=

h

i ≡ h

·

i

1
2

Re

J
{

·

E∗

}

=

1
2

Re

E∗

¯σc

E

=

·

·

o

1
2

¯σc : EE∗,

(2.15)

IP

h

i ≡

E

1
2 (cid:28)

∂P
∂t −

n

P

=

∂E
∂t (cid:29)
(iωD)

=

Re

E∗

D∗

·

−

(iωE)

=

¯ξ

H

E

¯ǫ ∗

E∗

E

¯ξ ∗

H∗

−

·

·

·

o

(cid:17)o

=

·

∂E
∂t (cid:29)
E + E∗

=

=

1
2 (cid:28)
1
Re
4

∂D
∂t −

E

·

D

iω

E∗

¯ǫ

·

·

n
E∗

(cid:16)
(¯ǫ

·

−

·

=

Re

iω

1
4

n

h

IM

h
∂B
∂t −

i ≡

B

·

1
2 (cid:28)
∂H
∂t

(cid:29)
H + H∗

·

H∗

¯µ

·

·

=

1
2

H

·

(cid:28)

=

Re

iω

1
4

·

1
4

·

·

·

·

1
4

·

·

n

−

io

n

−

·

·

·
1
2

·

·
1
2

¯ǫ †)

E + 2E∗

¯ξ

H

=

Re

H

∂µ0M

·

∂t −

µ0M

iω

¯ǫ a : EE∗+ ¯ξ : HE∗
n
(cid:16)
∂H
∂t (cid:29)

=

·

,

(cid:17)o

(2.17)

=

Re

H∗

(iωB)

B∗

(iωH)

=

¯ζ

E

H

¯µ ∗

H∗

H

¯ζ ∗

=

−

·

−

·

·

o
E∗

·

=

Re

iω

H∗

1
4

(cid:16)

n
( ¯µ

·

−

io
Substitution of Eqs. (2.15) – (2.17) into Eq. (2.7) gives the time-average Poynting theorem

(cid:17)o

n

n

h

¯µ †)

H

2E∗

¯ζ †

H

·

−

·

=

Re

iω

¯µ a : HH∗
(cid:16)

−

(cid:17)o
¯ζ † : HE∗

.

in the following form

involving the average Poynting vector

∇

S

· h

i

+

q

h

i

= 0

S

h

i

=

Re

E
{

×

H∗

}

1
2

7

(2.14)

(2.16)

(2.18)

(2.19)

and the average power loss density

q

h

i

=

IJ

+

IP

+

IM

=

i

h

i

i

1
2

=

¯σe : EE∗ +

¯σm : HH∗ +

Re

¯σme : HE∗
{

}

h
1
2

h
1
2

(2.20)

(2.21)

(2.22)

(2.23)

where we have introduced the total tensor of electric conductivity

¯σe = ¯σc + ¯σd = ¯σc + iω ¯ǫ a

¯σc + iω

≡

¯ǫ

¯ǫ †

−
2

associated with conductor ( ¯σc) and dielectric ( ¯σd = iω ¯ǫ a) losses of a medium, the tensor of
magnetic conductivity

≡
associated with magnetic losses of a medium, and the tensor of magneto-electric conductivity

¯σm = iω ¯µ a

iω

¯µ

¯µ †

−
2

¯σme = iω(¯ξ

¯ζ †)

iω

(¯ξ a + ¯ζ a) + (¯ξ h

−

≡

h

−

¯ζ h)
i

consisting of both antihermitian (with superscript a) and hermitian (with superscript h) parts
of the cross susceptibilities ¯ξ and ¯ζ. Unlike ¯σme, the dyadics ¯σe = ¯σc + iω ¯ǫ a and ¯σm = iω ¯µ a
are hermitian so that they produce the real (positive) deﬁnite quadratic forms in Eq. (2.20).

2.2 Mode Power Transmission and Dissipation

In order to obtain expressions for the power carried by modes along a waveguiding structure

involving complex (anisotropic and bianisotropic) media and to ﬁnd the dissipation of mode

power it is necessary to go from the time-average Poynting theorem in diﬀerential form (2.18) to

its integral form. For this purpose let us integrate Eq. (2.18) over the composite (multilayered)

cross section S =

Si formed from a few medium parts Si with interface contours Li by using

the two-dimensional divergence theorem (e. g., see Ref. [5], p. 150)

P

A dS =

∇

·

ZSi

∂
∂z

z0 ·

ZSi

A dS +

A dl

n0 ·

ILi

(2.24)

where A is the arbitrary ﬁeld vector and n0 is the outward unit vector normal to the contour
Li and perpendicular to the longitudinal unit vector z0.
Application of the integral relation (2.24) to ∇
S

gives

· h

i

∇

S

dS =

· h

i

∂
∂z

S

z0 · h

i

dS

−

h

ZS

ZS

S±

Xi ILi
means values of the time-average Poynting vector taken at points of contour Li
where
lying on its diﬀerent sides marked by the inward (for either adjacent medium) unit vectors
n±
i . The parts of interfaces between two adjacent nonconducting media do not contribute to
the line integrals in Eq. (2.25) owing to continuity in tangential components of the electric and

i

n+
h

i · h

S+

+ n−

S−

dl

i

i · h

i
i

(2.25)

8

magnetic ﬁelds. The only contribution may appear from the parts of Li due to conducting
surfaces on which there is the known boundary condition [2, 5, 35]

·
where Eτ and Hτ are the electric and magnetic ﬁelds tangential to the surface and ¯Zs is
the surface impedance tensor. For the special case of the isotropic metallic surface with the

×

Eτ = ¯Zs

(Hτ

ni)

(2.26)

conductivity σ and the skin depth δ =

2/ωµ0σ we have [2, 5]

¯Zs = (1 + i)

s ¯I

R

p
where

R

s = 1/σδ =

ωµ0/2σ .

(2.27)

q

In this case the integrand of the line integral in Eq. (2.25) yields the surface loss power den-

sity

q′

in addition to the bulk loss power density

q

entering into Poynting’s theorem (2.18).

i

h
The result of integrating Eq. (2.18) over the cross section S of a waveguide and applying

i

h

Eqs. (2.19), (2.20), and (2.25) – (2.27) gives Poynting’s theorem in the integral form

dP
dz

+ Q = 0

(2.28)

where the total real power carried by electromagnetic ﬁelds in the direction of increasing coor-

dinate z is equal to

1
2
and the total power loss per unit length caused by the bulk losses Q(b) (obtained by integrating
along
q

Si) and the surface (skin) losses Q(s) (obtained by integrating

over S =

z0 dS =

z0 dS

(2.29)

ZSh

H∗)

P =

(E

ZS

Re

i ·

q′

×

S

·

h

i

i
h
L =

P

Li) is equal to

P

Power relation (2.28) is valid only for the source-free region of a waveguiding structure

whose electromagnetic ﬁelds can be expanded in terms of its eigenmodes (cf. Eqs. (A.29))

Q = Q(b) + Q(s) =

q

dS +

i

ZLh

q′

i

dl =

( ¯σe : EE∗) dS +

( ¯σm : HH∗) dS +

ZSh
1
2

ZS
1
2

+

Re

( ¯σme : HE∗) dS +

s (Hτ

H∗

τ ) dl .

·

ZL R

=

1
2

ZS

1
2

ZS

E(rt, z) =

Ak ˆEk(rt) e− γkz =

ak(z) ˆEk(rt) ,

H(rt, z) =

Ak ˆHk(rt) e− γkz =

ak(z) ˆHk(rt) .

Xk

Xk

Xk

Xk

(2.30)

(2.31)

(2.32)

Every kth mode is speciﬁed by the propagation constant γk = αk + iβk and the eigen-
functions
(where the hat sign over ﬁeld vectors implies their dependence only on
transverse coordinates rt, see Appendix A. 2), which are regarded as known quantities found
from solving the appropriate boundary-value problem. The amplitudes Ak are determined by

ˆEk, ˆHk
{

}

9

(2.33)

γkz))

−

(2.34)

(2.35)

(2.36)

the exciting sources and called the excitation amplitudes. Inside the source region they depend

on z as a result of source actions but for the source-free region Ak(z) = const., as in the case of
Eqs. (2.31) and (2.32). It is often convenient instead of Ak(z) to introduce the mode amplitudes

ak(z) = Ak(z) e− γkz

which take into account the total z-dependence related both to the mode propagation (exp(

and to the exciting sources (Ak(z)), if any.

Let us employ the modal expansions (2.31) and (2.32) to calculate the power ﬂow P (z) and

the power loss Q(z) given by Eqs. (2.29) and (2.30) for the source-free region. The ﬁnal result

of calculations is the following:

(E∗

H + E

H∗)

z0 dS =

×

×

·

Nkl a∗

k(z)al(z)

Pkl(z) ,

≡

Xk Xl

+

1
4

ZS

(E∗

¯σme

H + H∗

¯σ †

me ·

Q(z) =

¯σe

E) dS +

(H∗

¯σm

H) dS +

·

·

1
2

ZS
E) dS +

·

·

Mkl a∗

k(z)al(z)

Hτ ) dl =

1
2

s (H∗
τ ·

ZL R

Qkl(z)

≡

Xk Xl

P (z) =

1
4

ZS

=

1
4

Xk Xl

(E∗

·

1
2

ZS

·

·

=

1
4

Xk Xl

where we have introduced the normalizing coeﬃcients

and the dissipative coeﬃcients

Nkl =

ZS

( ˆE∗

k ×

ˆHl + ˆEl

ˆH∗
k)

z0 dS

×

·

Mkl = 2

( ˆE∗
k ·

ZS

¯σe

ˆEl) dS + 2

·

¯σm

ˆHl) dS +

·

( ˆH∗
k ·

ZS
ˆEl) dS + 2

( ˆE∗
k ·

¯σme

ˆHl + ˆH∗
k ·

·

¯σ †

me ·

+

ZS

s ( ˆH∗

τ,k ·

ˆHτ,l) dl

ZL R

(2.37)

constructed of the cross-section eigenﬁeld vectors (marked with the hat sign above them, see

Eq. (3.5)).

that is

form

From Eqs. (2.36) and (2.37) it follows that the matrices

Nkl
{

}

and

Mkl
{

}

are hermitian,

Nkl = N ∗
lk

and

Mkl = M ∗
lk ,

(2.38)

and have dimensions of watts and watts per meter, respectively, because the amplitudes Ak
and ak are dimensionless.

The quantities Pk(z) and Qk(z) appearing in Eqs. (2.34) and (2.35) for l = k in the following

Pk(z)

Pkk(z) =

Nkk a∗

k(z)ak(z) =

≡

1
4

1
4

Nk

Ak
|

2 e−2αkz
|

(2.39)

10

Qk(z)

Qkk(z) =

Mkk a∗

k(z)ak(z) =

≡

1
4

1
4

Mk

Ak
|

2 e−2αkz
|

(2.40)

are the real self powers transmitted and dissipated at point z by the kth mode which was

excited at point z = 0 with amplitude Ak.

Similarly, the quantities Pkl(z) and Qkl(z) for l

= k equal to

Pkl(z) =

Nkl a∗

k(z)al(z) =

Nkl A∗

kAl e− (γ∗

k + γl)z

Qkl(z) =

Mkl a∗

k(z)al(z) =

Mkl A∗

kAl e− (γ∗

k + γl)z

1
4

1
4

1
4

1
4

(2.41)

(2.42)

can be interpreted as the complex cross powers transmitted and dissipated at point z jointly by

the kth and lth modes which were excited at point z = 0 with amplitudes Ak and Al. Owing
to (2.38), the quantities deﬁned by Eqs. (2.41) and (2.42) are also hermitian:

Pkl(z) = P ∗

lk(z)

and

Qkl(z) = Q∗

lk(z) .

(2.43)

From Eqs. (2.41) through (2.43) it follows that in a lossy waveguiding structure every pair

of modes always transmits and dissipates the real combined cross powers

P c

kl(z)

Qc

kl(z)

≡

≡

Pkl(z) + Plk(z) = 2 Re Pkl(z) =

Re

Qkl(z) + Qlk(z) = 2 Re Qkl(z) =

Re

1
2

1
2

Nkl a∗
{

k(z)al(z)
}

,

Mkl a∗
{

.
k(z)al(z)
}

(2.44)

(2.45)

Therefore, the double sums in Eqs. (2.34) and (2.35) yield the real (time-average) total

powers transmitted and dissipated by all modes in a lossy waveguide:

P (z) =

Pkl(z) =

Pk(z) +

P c

kl(z) =

Xk Xl

=

1
4

Xk

Nk

2 +
ak(z)
|
|

Xk Xl

=

1
4

Mk

2 +
ak(z)
|
|

Xk
1
2

Re

Xk
1
2

Re

Xk Xl>k

Xk Xl>k

Xk Xl6=k

Nkl a∗

k(z)al(z) ,

Qc

kl(z) =

Xk Xl6=k
Mkl a∗

k(z)al(z) ,

Q(z) =

Qkl(z) =

Qk(z) +

(2.46)

(2.47)

where Nk

Nkk and Mk

Mkk.

≡

Xk

≡

In the next section we shall derive a relation named the quasi-orthogonality relation to link

the cross powers Pkl and Qkl for every pair of modes in a lossy waveguide or for every pair of
the so-called twin-conjugate modes in a lossless waveguide.

11

6
3. ORTHOGONALITY AND QUASI-ORTHOGONALITY
OF MODES IN LOSSLESS AND LOSSY WAVEGUIDES

3.1 Quasi-orthogonality Relation for Lossy Waveguides

Let us begin our examination with the general case of the composite (multilayered) wave-

guiding structure containing bianisotropic media with bulk (electric, magnetic, magneto-electric)

losses and surface (skin) losses. Consider the kth and lth modes propagating in the source-free

region of the waveguide which obey the curl Maxwell equations (2.1) rewritten by using the

constitutive relations (2.8), (2.9), and (2.14) in the following form

∇

∇

×

×

Ek(l) =

iω ¯µ

Hk(l) −

·

−

iω ¯ζ

Ek(l) ,

·

Hk(l) = ( ¯σc + iω ¯ǫ )

Ek(l) + iω ¯ξ

Hk(l) .

·

·

(3.1)

(3.2)

A conventional procedure applied to Eqs. (3.1) and (3.2) gives

=

2 E∗
k ·

−

¯σe

El

·

−

¯σme

Hl + H∗
k ·

·

¯σ †

me ·

El)

(3.3)

Hl + El

H∗

k) =

k ×

∇

(E∗

·
2 H∗
k ·

¯σm

Hl

·

−

×
( E∗
k ·

where we have used formulas (2.21) – (2.23).

Application of the two-dimensional divergence theorem (2.24) to the left-hand side of

Eq. (3.3), by analogy with formula (2.25) and by using the boundary condition (2.26), results

in the following expression

∂
∂z

ZS
(E∗
k ·

(E∗

k ×

Hl + El

H∗
k)

·

z0 dS =

¯σe

El) dS

·

(H∗
k ·

¯σm

Hl) dS

·

−

×

2

−

ZS
El) dS

Hl + H∗
k ·

·

¯σ †

me ·

2

−

ZL R

s (H∗

τ,k ·

Hτ,l) dl .

(3.4)

=

2

−

ZS
¯σme

(E∗
k ·

−

ZS

Representation of the ﬁelds for the kth and lth modes in the form

Ek(l)(rt, z) = ˆEk(l)(rt) e− γk(l)z, Hk(l)(rt, z) = ˆHk(l)(rt) e− γk(l)z

(3.5)

and their substitution into Eq. (3.4) give, by comparing with formulas (2.36) and (2.37) for

Nkl and Mkl, the desired relation

(γ∗

k + γl) Nkl = Mkl

(3.6)

referred to as the quasi-orthogonality relation. It will play the same role in deriving the exci-

tation equations (see Eq. (5.46)) as the ordinary orthogonality relation.

Expressions (2.41) and (2.42) relate the normalizing and dissipative coeﬃcients Nkl and
Mkl to the cross-power ﬂow Pkl and the cross-power loss Qkl, respectively, transmitted and

12

dissipated jointly by the kth and lth modes. The use of these expressions allows us to rewrite

the quasi-orthogonality relation (3.6) in the power form

(γ∗

k + γl) Pkl = Qkl .

(3.7)

This formulation provides the following power interpretation of the mode quasi-ortho-

gonality: outside the source region every pair of modes, independently of other modes, trans-

mits the complex cross-power ﬂow Pkl rigidly coupled to the complex cross-power loss Qkl by
the factor (γ∗
k + γl) consisting of the mode propagation constants γk(l) = αk(l) + iβk(l) , and
kl = Pkl + Plk and Qc
in doing so the combined cross powers P c
kl = Qkl + Qlk always remain
real. The quasi-orthogonality relation (3.7) means that outside the source region Poynting’s

theorem (2.28) takes place for any one of mode pairs (k, l):

dPkl
dz

+ Qkl = 0 .

(3.8)

(3.9)

Besides, every single mode has the real self-power ﬂow Pk

Pkk and self-power loss Qk

≡
Qkk in the form of Eqs. (2.39) and Eq. (2.40). These self powers are coupled to each other
by the same relations (3.7) and (3.8) which for l = k yield the following expression for the

≡

attenuation constant:

αk =

Qk
2 Pk

=

Mk
2 Nk

.

Hence, there occurs the following pattern of mode power transfer in the lossy waveguiding

structures. Every kth mode propagates from the source region with the ﬁxed value of amplitude

Ak (the loss attenuation is taken into account by the amplitude constant αk appearing in γk)
which was excited by the sources. Outside them the mode, being a linearly independent

solution to the boundary-value problem, does not interact with other modes owing to their

linear independence. The kth mode transfers the self power Pk on its own and the cross powers
Pkl in conjunction with the other lth modes which were also excited inside the source region
and outside retain constant their excitation amplitudes Al as well as the kth mode.

3.2 Mode Orthogonality in Lossless Waveguides

The orthogonality relation for a lossless waveguiding structure is obtained from the general

relation (3.6) as the special case of Mkl = 0 and has the following form

(γ∗

k + γl) Nkl = 0 .

(3.10)

In spite of the absence of dissipation, in the eigenmode spectrum of the lossless waveguide,

besides propagating modes with αk
values of the propagation constant γk = αk + iβk with αk
regime of propagation and their attenuation is of reactive (nondissipative) character associated

0 and γk = iβk, there are also modes having complex
= 0. These modes exist in the cutoﬀ

≡

with the storage of reactive power. As a token of this, it seems reasonable to refer to such

13

6
modes as the reactive modes to distinguish between them and the active (propagating) modes

carrying an active (real) power.

In the literature the reactive (in our terminology) modes are variously termed the complex,

cutoﬀ, nonpropagating, and evanescent modes. The last term is usually assigned only to cutoﬀ

modes with pure decay (αk
= 0) and without phase delay (βk = 0). The latter feature of
evanescent modes makes appropriate for them also the term ”nonpropagating” because there

is no phase propagation. But for the complex modes with αk
decay as exp(

αkz) is accompanied by the phase variation in accordance with the wave factor
exp[i(ωt
βkz)]. For this reason it is more preferable to refer to the complex modes as reactive
modes rather than nonpropagating ones. However, we shall apply both terms, the reactive and
nonpropagating modes, as well as their antitheses, the active and propagating modes, to reﬂect

= 0 their reactive

= 0 and βk

−

−

the fact that the former do not transfer any self power, whereas the latter carry it.

Let us show that in any lossless waveguide, independently of its structure and media used,
every reactive mode with number k has its own twin mode with number ˜k (marked by tilde)
so that their propagation constants are related by the equality

γ˜k =

γ∗
k

−

or

α˜k =

αk ,

β˜k = βk .

−

(3.11)

Such mode twins with pair of numbers (k, ˜k) that satisfy the relation (3.11) will be referred
to as the twin-conjugate modes. As is seen from Eq. (3.11), these modes have the same phase
velocity (βk = β˜k) but decay in opposite directions (αk =

α˜k).

The existence of twin-conjugate modes possessing the property expressed by Eq. (3.11)

−

can be justiﬁed by means of the following reasoning. In our treatment of complex amplitude

technique, we have chosen the wave factor in the form exp[i(ωt

However, there is another alternative form exp[

i(ωt

−
the ﬁrst form in opposite sign of imaginary unity and having tilde above the wave vector. It is

≡ −

−

·

−
r)] with ˜kz

˜k

k

·

r)] where kz
i ˜γ which diﬀers from

≡ −

i γ.

clearly evident that the alternative case can be obtained from our solution by applying complex

conjugation, then

˜kz

i˜γ = k∗

iγ∗

z ≡

≡ −

whence

˜γ =

γ∗.

−

(3.12)

Equalities for gammas in Eqs. (3.11) and (3.12) are fully coincident not counting diﬀerent
positions of tilde (the former marking the mode number ˜k in subscripts will be used later
γ∗
on). This result substantiates the existence of twin-conjugate modes for which γk =
˜k
or kz,k = k∗
In other words, any dispersion equation obtained as a result of solving the
z,˜k
boundary-value problem for lossless systems has the complex roots with complex-conjugate

−

.

values of the longitudinal wavenumber kz which appear in pairs. Such a pair of complex roots
corresponds to the twin-conjugate modes.

Sign of the amplitude constant αk can be used as the basis for classiﬁcation of the reactive
(nonpropagating) modes under two types, forward and backward, as is usually done for the ac-
tive (propagating) modes but on the basis of a sign of the group velocity vgr,k = [dβk(ω)/dω]−1.

14

6
6
6
In reference to the source region location between z = 0 and z = L, all the modes (active and

reactive) can be classiﬁed into two categories:
(i) the forward modes marked by subscript k = + n > 0 (active with vgr,+n > 0 or reactive
with α+n > 0) which, being excited inside the source region, leave it (without or with reactive
damping) across the right boundary and exist outside at z > L;
(ii) the backward modes marked by subscript k =

n < 0 (active with vgr,−n < 0 or reactive
with α−n < 0) which, being excited inside the source region, leave it (without or with reactive
damping) across the left boundary and exist outside at z < 0.

−

3.2.1 Orthogonality and Normalization Relations for Active Modes

The active (propagating) modes exist in the pass band of lossless waveguides where they
have zero amplitude attenuation (αk(l) = 0), so that their propagation constants γk(l) = iβk(l)
are pure imaginary. In this case the orthogonality relation (3.10) rewritten in the form

(βk

βl) Nkl = 0

−

(3.13)

along with expression (2.36) for Nkl furnishes two alternatives:

Nkl

≡

ZS

( ˆE∗

k ×

ˆHl + ˆEl

ˆH∗
k)

·

×

z0 dS = 0

for

l

= k

(3.14)

or

Nk

Nkk = 2 Re

·
Expression (3.14) is the orthogonality relation between the diﬀerent propagating modes for

ZS

≡

z0 dS

= 0

for

l = k .

(3.15)

( ˆE∗

k ×

ˆHk)

which βk
Nkk of the kth mode. It
should be noted that Eq. (3.14) does not necessarily hold for diﬀerent but degenerate modes

= 0, whereas formula (3.15) deﬁnes the norm Nk

βl

−

≡

with βk = βl. In this case one can employ the conventional technique commonly used for usual
waveguides [2, 3] to ensure the orthogonality among degenerate modes by constructing from

them such linear combinations that constitute a new orthogonal subset for which relation (3.14)

is applicable. For this reason we shall no longer turn special attention to degenerate modes.

From Eqs. (2.41) and (3.14) it follows that two diﬀerent propagating modes (with numbers

k

= l) have zero cross-power ﬂow (Pkl = 0), i. e., they are orthogonal in power sense. Any
mode carries along a waveguide only the self power Pk deﬁned by formula (2.39), which gives
the following power interpretation for the norm of active modes: Nk is equal to 4P o
k where P o
k
means the time-average power carried in the positive z-direction by the kth mode with unit

Ak
amplitude (
|
P o
amplitude to unit power (
k |
|

|

= 1). In some instances it may be more convenient to normalize the mode

= 1 watt). Then

= 4 watts and according to Eq. (2.39)

where subscripts should be read as k =

n, with upper and lower signs corresponding to

±
the forward and backward modes for which, respectively, N+n = 4 watts and N−n =

4 watts.

(3.16)

−

|

Nk
|
2 =
|

Ak

2
|

± |

Pk =

ak

± |

15

6
6
6
6
In the special case of a reciprocal waveguide wherein for every forward mode there is a backward

one with the same law of dispersion, their norms are related to each other by the equality

N+n =

N−n .

−

(3.17)

(3.18)

In conclusion, let us write the relation of orthonormalization for the active (propagating)

modes in the following form

Nkl = Nkk δkl

≡ (

Nkk

Nk

0

≡

for
for

l
= k ,
l = k ,

where the normalizing coeﬃcient Nkl and the norm Nk are given by Eqs. (3.14) and (3.15),
respectively.

3.2.2 Orthogonality and Normalization Relations for Reactive Modes

The reactive modes of a lossless waveguide are cutoﬀ modes whose propagation constants
γk(l) = αk(l) + iβk(l) are generally complex-valued or particularly real-valued for the evanescent
modes with βk(l) = 0. So the general relation of orthogonality (3.10) holds for them and by
using Eq. (3.11) for the twin-conjugate modes gives two alternatives:

Nkl

≡

ZS

( ˆE∗

k ×

ˆHl + ˆEl

ˆH∗
k)

·

×

z0 dS = 0

for

= ˜k

l

(3.19)

or

Nk

≡

Nk˜k =

( ˆE∗

k ×

ˆH˜k + ˆE˜k ×

ˆH∗
k)

·

ZS

z0 dS

= 0

for

l = ˜k .

(3.20)

Expression (3.19) fulﬁls a role of the orthogonality relation for the reactive modes. As is

seen from here, every reactive kth mode is orthogonal to all the lth modes (reactive with αl
and active with αl = 0) for which γl + γ∗
k = γl
γk + γ∗
own twin with number ˜k for which γ˜k + γ∗
for the reactive kth mode which is constructed of the ﬁelds of twin-conjudate modes (k, ˜k).

γ˜k 6
= 0 and Nkl = 0, including itself since
= 0 and Nkk = 0. The only mode nonorthogonal to the given kth mode is its
Nk˜k

k = 0. Formula (3.20) deﬁnes the norm Nk

k = 2αk

= 0

≡

−

From Eqs. (2.39), (2.41), and (3.19) it follows that every reactive mode has no both the self
γ∗
k, i. e.,

power (Pkk = 0) and the cross powers with the other modes (Pkl = 0) for which γl
these modes are orthogonal in power sense.

=

−

Each mode forming a twin-conjugate pair, being nonorthogonal to its twin, has its own

norm deﬁned by Eq. (3.20) as

Nk

Nk˜k

≡

or

N˜k ≡

N˜kk ,

whence, according to the general property of hermitian symmetry for the normalizing coeﬃ-

cients expressed by equality (2.38), it follows that

(3.21)

(3.22)

Nk = N ∗
˜k ,

16

6
6
6
6
6
6
i. e., the reactive twin-conjugate modes have the complex-conjugate norms.

Although the reactive mode has no self power (Pkk

0), the twin-conjugate modes in pair

carry the real combined cross power (cf. Eq. (2.44))

≡

P c
k˜k ≡

Pk˜k + P˜kk = 2 Re Pk˜k =

1
2

Re

Nk A∗
{

kA˜k} ≡

Re

N˜k A∗
{

˜kAk

}

1
2

(3.23)

where subscripts should be read as k = + n and ˜k =
for the twin-conjugate modes and the deﬁnition of forward and backward reactive modes:

n. This is a consequence of relations (3.11)

−

if
N+n,−n, then the ˜kth mode is a backward

the kth mode is a forward one with Nk = N+n
one with N˜k = N−n

N−n,+n = N ∗

+n.

≡

≡

As evident from Eq. (3.23), to transfer the real power by reactive modes it is necessary that
both constituents of a twin-conjugate pair should have nonzero amplitudes (Ak and A˜k) and to
be in such a phase relationship that their combined cross power P c
would be other than zero.
k˜k
Similar situation usually takes place in the regular waveguide of ﬁnite length bounded by two

irregularities and excited at frequences below its cutoﬀ frequency [1–3]. Reﬂections from these

irregularities can form inside this length two evanescent (cutoﬀ) modes with numbers k = + n
(forward mode) and ˜k =
n (backward mode) constituting the twin-conjugate pair for which
γ∗
−n. It is easy to see that the norms for the forward and
β±n = 0 and γ+n
α+n =
backward evanescent modes are pure imaginary-valued and related to each other by the general

≡ −

α−n

≡

−

−

relation (3.22). Superposition of ﬁelds for the two evanescent modes with opposite decay sense

furnishes nonzero real cross-power ﬂow along a short length of the cutoﬀ waveguide.

In conclusion, let us write the relation of orthonormalization for the reactive (nonpropagat-

ing) modes in the following form

Nkl = Nk˜k δ˜kl ≡ (

0
Nk˜k ≡

Nk

for
for

= ˜k ,
l
l = ˜k ,

(3.24)

where the normalizing coeﬃcient Nkl and the norm Nk are given by Eqs. (3.19) and (3.20),
respectively. From comparison of Eqs. (3.18) and (3.24) it is seen that the latter relation is of

general form because it comprises the former one for the active modes as a special case obtained
by replacing subscript ˜k with k so that, in particular, the norm Nk
by Eq. (3.15).

Nkk takes the form given

≡

It is pertinent to note that all the above expressions for the norms and the relations of

orthogonality and orthonormalization can contain the total ﬁeld vectors in place of their cross

section parts related to each other by Eqs. (3.5), i. e., the hat sign over the ﬁeld vectors can
be dropped. This is obvious for the active modes and follows from the equality γk + γ∗
˜k
the reactive twin-conjugate modes.

= 0 for

If in a waveguiding structure there are both the active (propagating) and reactive (nonprop-

agating) modes, the total power ﬂow (2.46) carried by them, in accordance with the aforesaid,

17

6
is given by the following expression

P = Pact + Preact =

Pk +

′

P c
k˜k =

Xk
(active)

k
X
(reactive)

=

1
4
Xk
(active)

Nk

2 +
ak(z)
|
|

1
2

Re

′

Nk a∗

k(z)a˜k(z)

k
X
(reactive)

(3.25)

where prime on the sum sign means summation of the twin-conjugate modes in pairs rather

than that of the single reactive modes.

3.3 Time-average Stored Energy for Active Modes in Lossless Waveguides

The time-average Poynting theorem written in the form of Eq. (2.18) for time-harmonic

ﬁelds does not contain a stored energy density. In order to ﬁnd it one usually applies variational

technique (e. g., see Ref. [29]). To this end, it is necessary to obtain a relation between variations
of the electromagnetic ﬁelds (δEk, δHk) for the kth mode and perturbations of the frequency
and medium parameters ( δ(ω ¯ǫ ), δ(ω ¯µ), δ(ω ¯ξ), δ(ω ¯ζ)) which bring about these variations.

The kth mode is governed by Maxwell’s equations (3.1) and (3.2) with ¯σc = 0 for a lossless
medium whose other parameters satisfy the requirements (2.13). By taking variations in these

equations we obtain

δEk =

iω ¯µ

δHk

iω ¯ζ

δEk

iδ(ω ¯µ)

Hk

iδ(ω ¯ζ)

Ek ,

−

−

∇

∇

×

×

δHk = iω ¯ǫ

−

·
−
δEk + iω ¯ξ

·

·

·

δHk + iδ(ω ¯ǫ )

Ek + iδ(ω ¯ξ)

Hk .

·

·

·

·

(3.26)

(3.27)

A conventional procedure applied to Eqs. (3.26) and (3.27) reduces to the following relation

∇

(E∗

·

k ×

δHk + δEk

H∗

k) =

iω

−

E∗
k ·

(¯ǫ

−

¯ǫ †)

·

×

δEk +

h

+ H∗
k ·

( ¯µ

−

¯µ †)

δHk + E∗
k ·

·

(¯ξ

−

¯ζ †)

δHk + H∗
k ·

·

( ¯ζ

−

¯ξ †)

·

δEk

E∗
k ·

−

i

h

δ(ω ¯ǫ )

Ek + H∗
k ·

·

δ(ω ¯µ)

Hk + E∗
k ·

·

δ(ω ¯ξ)

Hk + H∗
k ·

·

i
δ(ω ¯ζ)

−

Ek

·

i

where the terms inside the ﬁrst square brackets vanish because of relations (2.13) for lossless

media so that

∇

(E∗

·

k ×

δHk + δEk

i

δ(ω ¯ǫ ) : EkE∗

k + δ(ω ¯µ) : HkH∗

H∗

k) =

×
k + 2 Re

=

−

h

δ(ω ¯ξ) : HkE∗
k
{

.

i

Electromagnetic ﬁelds of a propagating mode and their variations can be written on the

basis of Eq. (3.5) as

Ek = ˆEk e−i βkz ,

δEk = (δ ˆEk

iδβkz ˆEk) e−i βkz ,

Hk = ˆHk e−i βkz ,

δHk = (δ ˆHk

iδβkz ˆHk) e−i βkz.

−

−

18

(3.28)

(3.29)

(3.30)

When substituting Eqs. (3.29) and (3.30) into Eq. (3.28) and applying the integral rela-

tion (2.25) where the line integral vanishes owing to continuity in tangential components of the

ﬁelds, the integration over the cross section S yields

δβk

Re

(Ek

1
2

ZS

H∗
k)

·

×

z0 dS =

=

1
4

ZS

h

δ(ω ¯ǫ ) : ˆEk ˆE∗

k + δ(ω ¯µ) : ˆHk ˆH∗

k + 2 Re

δ(ω ¯ξ) : ˆHk ˆE∗
k}
{

dS.

i

(3.31)

The left-hand side of Eq. (3.31) involves the time-average power ﬂow Pk as a multiplier of

δβk. By using the known relation

Pk = vgr,k Wk

where

vgr,k =

(3.32)

−1

∂βk(ω)
∂ω

(cid:19)

(cid:18)

is the group velocity, we obtain from Eq. (3.31) the desired expression for the time-average

energy stored per unit length of a waveguide (dropping the mode index k):

W =

1
4

+

ZS(cid:18)
1
2

Re

E∗

∂(ω ¯ǫ )

·

∂ ω ·

E + H∗

∂(ω ¯µ )

·

∂ ω ·

H

dS +

(cid:19)

E∗

∂(ω ¯ξ )
∂ ω ·

·

ZS(cid:18)

H

dS

(cid:19)

≡

ZS

w dS .

(3.33)

(3.34)

In accordance with expression (3.33), the time-average stored energy density for a lossless

bianisotropic medium is given by the following formula

w =

E∗ H∗

1
4

(cid:16)

(cid:17)

· 



∂(ω ¯ǫ )/∂ ω

∂(ω ¯ζ )/∂ ω

∂(ω ¯ξ )/∂ ω

∂(ω ¯µ )/∂ ω 


·  

E
H !

which is a generalization of the usual expression for lossless anisotropic media [7, 10, 22].

4. ORTHOGONAL COMPLEMENTS AND EFFECTIVE
SURFACE CURRENTS INSIDE SOURCE REGION

4.1 Bulk and Surface Exciting Sources

Up to the present, the external sources exciting the composite (multilayered) waveguiding

structures involving isotropic, anisotropic, and bianisotropic media have been dropped. From

this point onward, the special attention will be given to investigating the behavior of modes

inside the source region. In doing so, we assume that all the eigenﬁelds

of Eq. (3.5), including their eigenfunctions of cross-section coordinates

Ek, Hk
{
ˆEk, ˆHk
{

}

}

in the form

(marked by

hat over them) and their eigenvalues of propagation constants γk = αk + iβk, are known from
solving the corresponding boundary-value problem. As shown in Appendix A, these eigenﬁelds

constitute an inﬁnite countable set of the vector functions quadratically integrable on the cross

section S of a waveguiding structure. This set can be taken as a basis of the proper Hilbert

19

space to expand the required ﬁelds E and H not only outside sources, as was done by Eqs. (2.31)

and (2.32), but also inside the region of external sources. In general, this eigenvector basis is

not complete inside the source region since it cannot take into account entirely the potential
ﬁelds of the sources. This requires to supplement the modal expansions Ea and Ha with un-
known modal amplitudes Ak(z) by the orthogonal complements Eb and Hb (see Eqs. (A.27)
and (A.28)). Hence, the desired issues to be obtained inside the source region are both the

longitudinal dependence of modal amplitudes and the orthogonal complements to the modal

expansions.

In the most general case there exist three physical reasons to excite the waveguiding struc-

ture under examination:
ext and magnetic Jm
(a) the external currents – electric Je
(b) the external ﬁelds – electric Eext and magnetic Hext ,
(c) the external perturbations of bianisotropic medium parameters ∆¯ǫ, ∆ ¯µ, ∆ ¯ξ, and ∆ ¯ζ.

ext ,

Owing to these medium perturbations, the total electric (E+Eext) and magnetic (H+Hext)
ﬁelds create the excess electric ∆D and magnetic ∆B inductions linked by the constitutive

relations (2.8) and (2.9), that is

∆D = ∆¯ǫ

(E + Eext) + ∆ ¯ξ

(H + Hext) ,

∆B = ∆ ¯ζ

(E + Eext) + ∆ ¯µ

(H + Hext) .

·

·

·

·

These excess inductions bring about the induced displacement currents – electric Je

ind = iω∆B which, being added to the external currents Je

ext and Jm

iω∆D and magnetic Jm
yield the bulk exciting currents

b = Je
Je

ext + Je

ind = Je

ext + iω∆D , Jm

b = Jm

ext + Jm

ind = Jm

ext + iω∆B

(4.3)

entering into the curl Maxwell equations (2.1) in the following form

(4.1)

(4.2)

ind =
ext,

(4.4)

(4.5)

∇

∇

×

×

E =

iωB

−

−

Jm
b ,

H = iωD + Je

b .

The conduction current J of a conductive medium deﬁned by Eq. (2.14) is now assumed to
be incorporated with the electric displacement current iωD, whereas the induction vectors D
and B are taken, as before, to be related to the intrinsic electromagnetic ﬁelds E and H inside

the medium in question by the same constitutive relations (2.8) and (2.9). So the permittivity
tensor ¯ǫ is now regarded as a sum (¯ǫ + ¯σc/iω) whose antihermitian part deﬁnes the total tensor
of electric conducttivity ¯σe = ¯σc + ¯σd given by Eq. (2.21).

Besides the bulk exciting currents Je

b , there may exist the surface exciting currents
s and Jm
Je
s which give discontinuities of the appropriate tangential components of ﬁelds at
points of the surface whereon these sources are located, written in the form of the following

b and Jm

20

boundary conditions:

n+
s ×

n+
s ×

E+ + n−

E− =

s ×

Jm
s ,

−

H+ + n−

H− = Je
s .

(4.6)

(4.7)

s ×
Here the ﬁeld vectors with superscripts ± mean their values taken at points of the source
location contour Ls lying on its diﬀerent sides marked by the inward (for either adjacent
medium) unit vectors n±
s .

4.2 Orthogonal Complementary Fields and Eﬀective Surface Currents

The general electrodynamic eigenmode treatment (see Appendix A.2) based on the well-

known mathematical formulations (see Appendix A.1) yields the complete representation of
the desired ﬁeld vector F inside sources as a sum of the the modal expansion Ψ giving a
projection of F onto the Hilbert space and the complement C orthogonal to the Hilbert space

(see Eq. (A.25)). Thus, the electromagnetic ﬁelds inside the source region have the complete

representation given by Eqs. (A.27) and (A.28), namely (cf. Eqs. (2.31) and (2.32)):

E(rt, z) = Ea(rt, z) + Eb(rt, z) =

ak(z) ˆEk(rt) + Eb(rt, z) ,

H(rt, z) = Ha(rt, z) + Hb(rt, z) =

ak(z) ˆHk(rt) + Hb(rt, z) ,

where Eb(rt, z) and Hb(rt, z) are the required orthogonal complements. The mode amplitude
γkz) allows for the total dependence on z due to both the unperturbed
ak(z) = Ak(z) exp(
propagation of the kth mode with a constant γk and the perturbed amplitude Ak(z) as a result
of source actions. Using Eqs. (2.8) and (2.9) gives the similar expressions for the induction

−

vectors

D(rt, z) = Da(rt, z) + Db(rt, z) =

ak(z) ˆDk(rt) + Db(rt, z),

B(rt, z) = Ba(rt, z) + Bb(rt, z) =

ak(z) ˆBk(rt) + Bb(rt, z).

In order to ﬁnd the orthogonal complements let us substitute Eqs. (4.8) through (4.11) into

Maxwell’s equations (4.4) and (4.5) with taking into account the fact that the eigenﬁelds (3.5)

satisfy the homogeneous (with no sources) Maxwell equations (3.1) and (3.2). Some transfor-

mations yield

(4.8)

(4.9)

(4.10)

(4.11)

(4.12)

(4.13)

dAk
dz
dAk
dz

Xk

Xk

(z0 ×

Ek) =

∇

Eb

iωBb

−

×

−

Jm
b

,

−

(z0 ×

Hk) =

∇

−

×

Hb + iωDb + Je
b .

The left-hand side of Eqs. (4.12) and (4.13) has only transverse components. From here it

necessarily follows that there must exist nonzero orthogonal complementary ﬁelds. Otherwise
(when Eb = Hb = Db = Bb = 0) these equations become physically contradictory because

Xk

Xk

Xk

Xk

21

then they require the longitudinal components of the arbitrary bulk currents Je
always equal to zero, which is of course not the case.

b and Jm

b to be

Hence, the required orthogonal complementary ﬁelds should be chosen so as to make the

longitudinal component of the right-hand part of Eqs. (4.12) and (4.13) vanish, that is

∇

∇

·

·

Eb)

z0 ·
(z0 ×
−
Hb) + z0 ·
(z0 ×
∇
(z0 ×

−

·

(iωBb + Jm

b ) = 0 ,

(iωDb + Je

b ) = 0 ,

a) has been used.

where the identity z0 ·

(∇

a) =

×

Since the ﬁeld parts Eb and Hb form the orthogonal complement to the Hilbert space
, they must be orthogonal to the ﬁelds of any
}

spanned by the base eigenvectors

eigenmode in power sense given by the relation similar to Eqs. (3.14) and (3.19) (cf. Eq. (A.26)):

Ek, Hk
{

(E∗

k ×

ZS

Hb + Eb

H∗
k)

z0 dS

×

·

≡

(z0 ×

Eb)

H∗

k −

·

(z0 ×

Hb)

E∗
k

·

dS = 0 .
i

≡

ZS

h

In virtue of arbitrary choice of the kth eigenmode taken from the base set, zero equality in

Eq. (4.16) can occur if and only if

i. e., both complementary ﬁelds are longitudinal. In order for their magnitude to be found, it

is necessary to insert Eqs. (2.8), (2.9), (4.17), and (4.18) into Eqs. (4.14) and (4.15), then

z0 ×
z0 ×

Eb = 0

Hb = 0

or

or

Eb = z0 Eb ,

Hb = z0 Hb ,

Db

z0 ·

≡

Bb

z0 ·

≡

ǫzz Eb + ξzz Hb =

ζzz Eb + µzz Hb =

1
iω

1
iω

−

−

J e
bz ,

J m
bz .

Eb =

Hb =

J e
bz −
iωǫzz (1

−

J m
bz −
iωµzz (1

−

νmJ m
bz
νeνm)

−
νeJ e
bz
νeνm)

−

,

,

From here it ﬁnally follows that

where we have denoted

νe =

ζzz
ǫzz

=

¯ζ : z0z0
¯ǫ : z0z0

,

νm =

ξzz
µzz

=

¯ξ : z0z0
¯µ : z0z0

.

Hence, both the orthogonal complementary ﬁelds are longitudinal and produced by the

longitudinal components of the bulk exciting currents.

22

(4.14)

(4.15)

(4.16)

(4.17)

(4.18)

(4.19)

(4.20)

(4.21)

(4.22)

(4.23)

Existence of the complementary ﬁelds Eb and Hb immediately reduces to appearance of the
so-called eﬀective surface currents Je
s,ef . Consider the bulk source region having the
cross section Sb with a boundary contour Lb and write the complete electric ﬁeld inside and
outside this area:

s,ef and Jm

k Ak(z) Ek(rt, z) + Eb(rt, z)

E− – inside Sb ,

k Ak(z) Ek(rt, z)

E+ – outside Sb .

≡

≡

(4.24)

E(rt, z) =






P

P

Analogous expressions can be written for the magnetic ﬁeld H(rt, z).

The eigenﬁelds Ek and Hk, being obtained for the situation without sources, are generally
continuous at points of the line Lb. Then the tangential components of the complete ﬁelds E
and H prove discontinuous:

n+

b ×

n+

b ×

E+ + n−

E− =

H+ + n−

H− =

b ×

b ×

nb

nb

−

−

×

×

Eb ,

Hb ,

b =

where nb = n+
is the outward unit vector normal to both the line Lb and the longi-
tudinal unit vector z0. The comparison of these relations with the boundary conditions (4.6)
and (4.7) yields the desired eﬀective surface currents

−

n−
b

Je

s,ef =

nb

−

×

Hb

=

τ

−

Lb

J m
bz (Lb)
−
iωµzz (1

νeJ e

bz(Lb)

νeνm)

Jm
s,ef = nb

Eb

×

Lb

= τ

J e
bz(Lb)
−
iωǫzz (1

νmJ m

bz (Lb)

νeνm)

,

,

−

−

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

bz(Lb) and J m

where J e
points lying on the boundary Lb of their existence area Sb and τ = z0 ×
tangential to the contour Lb.

bz (Lb) mean the longitudinal components of the bulk currents taken at
nb is the unit vector

The general expressions (4.21) and (4.22) for the complementary ﬁelds Eb and Hb and the
s,ef take the

general expressions (4.27) and (4.28) for the eﬀective surface currents Je
following simpliﬁed form in special cases of:

s,ef and Jm

(i) the isotropic medium with parameters (2.10) (νe = νm = 0)

(ii) the anisotropic medium with parameters (2.11) (νe = νm = 0)

Eb =

z0
iωǫ

J e
bz

−
τ
iωǫ

Jm

s,ef =

J e
bz(Lb)

Eb =

z0
iωǫzz

J e
bz

−
τ
iωǫzz

Jm

s,ef =

J e
bz(Lb)

J m
bz ,

Hb =

−

Je

s,ef =

z0
iωµ
τ
iωµ

−

J m
bz (Lb) ;

J m
bz ,

Hb =

−

Je

s,ef =

z0
iωµzz
τ
iωµzz

−

J m
bz (Lb) .

and

and

and

and

23

(4.25)

(4.26)

(4.27)

(4.28)

(4.29)

(4.30)

(4.31)

(4.32)

Formulas (4.29) and (4.31) are in agreement with those obtained ﬁrst by Vainshtein [2] and

Felsen and Marcuvitz [8], respectively. As for the eﬀective surface currents (4.30) and (4.32),

Vainshtein did not consider them at all but the excitation integrals in the theory of Felsen and

Marcuvitz allow for them implicitly, which will be shown later (see Sec. 5.1).

Therefore, in the absence of medium bianisotropy the bulk currents, electric Je

b and magnetic
b , generate the eﬀective surface currents, respectively, magnetic Jm
Jm
s,ef . As
is seen from Eqs. (4.27) and (4.28), the bianisotropic properties of a medium intermix the

s,ef and electric Je

contributions from the bulk currents into the eﬀective surface currents owing to the longitudinal

components ξzz and ζzz.

The newly obtained eﬀective surface currents Je

s,ef and Jm
s,ef , as well as the actual surface
s entering into the boundary conditions (4.6) and (4.7), make contributions

currents Je
to the excitation amplitudes Ak along with the bulk currents Je

s and Jm

b and Jm
b .

The next step should be done toward deriving the diﬀerential equations to ﬁnd the functions

Ak(z) inside the region of bulk and surface sources. For this purpose we shall apply three
independent approaches set forth in the next section and Appendix B.

5. EQUATIONS OF MODE EXCITATION

5.1 Approach based on the Electrodynamic Method of Variation of Con-

stants

Mathematical method of variation of constants is applied to solve an inhomogeneous dif-

ferential equation (with driving terms) by representing its general solution in the form of a

superposition of the known linearly independent solutions of the proper homogeneous equation

with coeﬃcients which are no longer considered constant and assumed to be the desired func-

tions of an independent variable [42]. Electrodynamic analog of the mathematical method of
variation of constants is built by representing the ﬁelds E(rt, z) and H(rt, z) inside the source
region in the form of the expansions (4.8) and (4.9) in terms of eigenfunctions of the proper

homogeneous boundary-value problem (without sources) whose amplitude coeﬃcients Ak(z)
are the desired functions of z rather than constants, as they are outside sources.

According to the conventional mathematical technique, the method of variation of constants

is to give diﬀerential equations for the mode amplitudes in the following form

dAk(z)
dz

= fk(z) ,

k = 1, 2, . . .

where the functions fk(z) take into account the longitudinal distribution of exciting sources
(bulk and surface). Integration of Eq. (5.1) yields the required dependence

Ak(z) = Ao

k +

fk(z) dz

Ao

k + ∆Ak(z) .

Z

≡

The integration constant Ao

k should be determined from a boundary condition given at one
of two boundaries (z = 0 or z = L) of the source region depending on the type of modes for a

(5.1)

(5.2)

24

lossless waveguiding structure:
(i) for the forward modes (active and reactive, k = + n) supplied at the left input

A+n(0)

= 0

or

A+n(0) = 0 ,

(ii) for the backward modes (active and reactive, k =

n) supplied at the right input

−

A−n(L)

= 0

or

A−n(L) = 0 .

Substitution of Eq. (5.2) into Eqs. (4.8) and (4.9) allows us to represent the complete

solution for the electromagnetic ﬁelds inside the source region as the sum of the general solution
(Egen, Hgen) to the homogeneous boundary-value problem (without exciting sources) involving
the constant amplitude coeﬃcients Ao
k and the particular solution (Epar, Hpar) to the proper
inhomogeneous problem (with exciting sources), namely:

(5.3)

(5.4)

E(rt, z) = Egen + Epar

≡

Ao

k Ek(rt, z) +

∆Ak(z) Ek(rt, z) + Eb(rt, z)

,

H(rt, z) = Hgen + Hpar

≡
∆Ak(z) Hk(rt, z) + Hb(rt, z)

Ao

k Hk(rt, z) +

(cid:21)

.

(cid:21)

(cid:20) Xk

(cid:20) Xk

≡

Xk

≡

Xk

Thus, the general technique of solving the electrodynamic problem of waveguide excitation

by external sources based on the method of variation of constants gives rise to the representation

of the desired electromagnetic ﬁelds as the sum of the general and particular solutions adopted

in the theory of linear diﬀerential equations. The next task is to obtain a speciﬁc form for the

excitation equation like Eq. (5.1).

To derive the equation of mode excitation let us vector-multiply both sides of Eqs. (4.8) and
l , respectively, and add them. Then after scalar-multiplying the result

(4.9) by ˆH∗
of summation by z0 and integrating over the cross section S of a waveguide we obtain

l and

ˆE∗

−

( ˆE∗

l ×

ZS

H + E

ˆH∗
l )

·

×

z0 dS =

ak

Xk

( ˆE∗

l ×

ZS

ˆHk + ˆEk

ˆH∗
l )

·

×

z0 dS +

+

( ˆE∗

l ×

ZS

Hb + Eb

ˆH∗
l )

·

×

z0 dS .

(5.5)

The last integral in the right-hand side of Eq. (5.5) vanishes because of the orthogonality

relation (4.16) or (A.26). According to the orthonormalization relations (3.18) and (3.24), the

integral under the sign of summation is equal to Nlδlk for the active (propagating) modes and to
Nlδ˜lk for the reactive (nonpropagating) modes. Hence, from Eq. (5.5) we obtain (cf. Eq. (A.31)):

(i) for the active modes (with replacing subscripts l

k)

→

ak =

1
Nk ZS

( ˆE∗

k ×

H + E

ˆH∗
k)

z0 dS

·

≡

Ak e−i βkz

×

25

6
6
or

Ak =

1
Nk ZS

(E∗

k ×

H + E

H∗
k)

z0 dS

×

·

where the norm Nk is deﬁned by formula (3.15) ,

(ii) for the reactive modes (with replacing subscripts l

˜k and ˜l

k)

→

→

ak =

1
N˜k ZS

( ˆE∗

˜k ×

H + E

ˆH∗
˜k)

·

×

z0 dS

≡

Ak e− γkz

or

Ak =

1
N˜k ZS

(E∗

˜k ×

H + E

H∗
˜k)

·

×

z0 dS

(5.6)

(5.7)

where subscript ˜k corresponds to the mode which together with the kth mode constitute the
γ∗
k and the norm N˜k = N ∗
twin-conjugate pair and have the propagation constant γ˜k =
k
deﬁned by formula (3.20). From comparison of Eqs. (5.6) and (5.7) it is seen that the latter

−

expression can be considered as the general form valid not only for the reactive modes but also
for the active modes with replacing ˜k by k.

It is pertinent to note that expression (5.6) for ak is in agreement with Eq. (A.31) obtained
by minimizing the mean-square diﬀerence Dn (deﬁned by Eq. (A.33)) between the mode se-
ries expansion Ψ and the partial sum Sn of the nth order (given by Eq. (A.32)) to provide
convergence in mean for the modal expansion.

Formulas (5.6) and (5.7) give a rule to ﬁnd the mode excitation amplitude if the electro-

magnetic ﬁelds are known. However, this is usually not the case because the exciting currents

(bulk and surface) are assumed to be given rather than the ﬁelds. In order to go from the ﬁelds

to the currents, let us diﬀerentiate the general relation (5.7) with respect to z:

N˜k

dAk
dz

=

∂
∂z

(E∗

˜k ×

H + E

H∗
˜k)

·

×

z0 dS =

ZS
(E∗

=

ZS

∇

·

H + E

H∗

˜k) dS +

×

˜k ×

+

Xi ILi

h

n+
i

(E∗

˜k ×

·

H + E

H∗

˜k)+ + n−

i

(E∗

˜k ×

·

×

H + E

H∗

˜k)−

dl

×

i

(5.8)

where the last equality is written by using the relation similar to Eq. (2.25).

The complete ﬁelds E and H inside the source region satisfy the inhomogeneous Maxwell
of the ˜kth mode obey the following

equations (4.4) and (4.5), whereas the ﬁelds E∗
˜k
homogeneous equations

and H∗
˜k

∇

∇

E∗
˜k = iωB∗
˜k ,
iωD∗
˜k .

˜k =

H∗

−

×

×

By using the constitutive relations (2.8), (2.9) and Eqs. (4.4), (4.5), (5.9), and (5.10) it is

easy to prove that

∇

(E∗

·

˜k ×

H + E

H∗

˜k) =

(Je
b ·

˜k + Jm
E∗
b ·

−

H∗
˜k)

−

×

26

(5.9)

(5.10)

(5.11)

iω

(¯ǫ

−

−

h

¯ǫ †) : EE∗

˜k + ( ¯µ

¯µ †) : HH∗

˜k + (¯ξ

¯ζ †) : HE∗

˜k + ( ¯ζ

¯ξ †) : EH∗
˜k

−

−

−

i

where the square bracket equals zero for a lossless medium owing to Eq. (2.13).

The contour integrals in the right-hand side of Eq. (5.8) include two contributions:

s and Jm

(i) from the actual surface currents Je
the boundary conditions (4.6) and (4.7),
s,ef and Jm
(ii) from the eﬀective surface currents Je
s,ef given by Eqs. (4.27) and (4.28) which
are located on a contour Lb bounding the bulk current area Sb and meet the boundary condi-
tions (4.25) and (4.26).

s which are located on a contour Ls and meet

On the strength of the aforesaid we can write

Xi ILi
=

h

ZLs

h

+

ZLb

h

=

n+
i

(E∗

˜k ×

·

H + E

H∗

˜k)+ + n−

i

(E∗

˜k ×

·

×

H + E

H∗

˜k)−

dl =

n+
s ·

(E∗

˜k ×

H + E

H∗

˜k)+ + n−
s ·

×

(E∗

˜k ×

H + E

H∗

˜k)−

n+
b ·

(E∗

˜k ×

H + E

H∗

˜k)+ + n−
b ·

×

(E∗

˜k ×

H + E

H∗

˜k)−

×

×

×

i
dl +

i
dl =

i
˜k) dl .

H∗

(Je
s ·

˜k + Jm
E∗
s ·

H∗

˜k) dl

(Je

s,ef ·

˜k + Jm
E∗

s,ef ·

−

ZLb

−

ZLs

(5.12)

Eqs. (5.8), (5.11), and (5.12) ﬁnally give the desired equations written as

(i) for the excitation amplitudes Ak(z), k =

n:

±

dAk
dz

=

−

1
N˜k ZSb

(Je
b ·

˜k + Jm
E∗
b ·

H∗

˜k) dS

−

1
N˜k ZLs

−

1
N˜k ZLs

−

(Je
s ·

˜k + Jm
E∗
s ·

H∗

˜k) dl

−

(Je

s,ef ·

˜k + Jm
E∗

s,ef ·

H∗

˜k) dl ;

(5.13)

(ii) for the mode amplitudes ak(z) = Ak(z) exp(

γkz), k =

n:

dak
dz

+ γk ak =

1
N˜k ZSb

(Je
b ·

−

−

±
ˆE∗
˜k + Jm
b ·

ˆH∗

˜k) dS

−

(Je
s ·

ˆE∗
˜k + Jm
s ·

ˆH∗

˜k) dl

−

(Je

s,ef ·

ˆE∗
˜k + Jm

s,ef ·

ˆH∗

˜k) dl .

(5.14)

The excitation equations (5.13) and (5.14) written for the amplitudes of reactive modes
hold true also for an active mode if one assumes ˜k = k and γk = iβk. The excitation integrals
in the right-hand side of these equations represent the complex power of interaction between

the external currents (bulk and surface) and the eigenﬁelds of the kth mode (for active ones)
or those of its twin-conjugate ˜kth mode (for reactive ones).

As distinct from the theory developed, Vainshtein [2] fully excluded from consideration the

reactive (nonpropagating) modes and the eﬀective surface currents and restricted his analysis

only to the reciprocal waveguides with isotropic media. In this case every forward-propagating

1
N˜k ZLb

1
N˜k ZLb

27

mode (k = + n) has a backward counterpart (k =

n) of the same type so that their common

norm is deﬁned by Vainshtein as

−

Nn =

( ˆE+n

ˆH−n

ˆE−n

ˆH+n)

z0 dS .

×

−

×

·

ZS

Unlike the deﬁnition (3.15), Vainshtein’s norm has no power sense and does not allow a

generalization to nonreciprocal waveguides to be made.

Theory of Felsen and Marcuvitz [8], unlike Vainshtein’s theory, takes into consideration

anisotropic (not bianisotropic) media but also does not allow for the reactive modes. The

excitation integral in their equation similar to our Eq. (5.14) has a visually diﬀerent form which

does not involve the eﬀective surface currents explicitly. In order for their implicit existence to

be displayed, let us convert our excitation integral containing the bulk currents.

To this end, it is necessary to transform the products of longitudinal components such as
kz (where k = ˜k for reactives modes). The use of the constitutive relations
kz and J m
H for a double-anisotropic medium in Eqs. (5.9) and (5.10) written for

E and B = ¯µ

bz H ∗

J e
bz E∗
D = ¯ǫ

·

·

the kth mode gives the longitudinal projections of these equations:

(∇

(∇

×

×

E∗

k)z

(∇t

E∗

kt)

z0 = iω (µ∗

zxH ∗

kx+ µ∗

zyH ∗

ky + µ∗

zzH ∗

kz) ,

≡

≡

×

×

·

·

−

H∗

k)z

(∇t

H∗

kt)

z0 =

iω (ǫ∗

zxE∗

kx+ ǫ∗

zyE∗

ky + ǫ∗

zzE∗

kz) .

Taking into account that for a lossless medium ǫ∗

ij = ǫji and µ∗

ij = µji, on the basis of

Eqs. (5.15) and (5.16) we can obtain the following expressions

and

bz E∗
J e

kz =

1
iωǫzz

−

(∇t

H∗

kt)

Je
bz −

·

×

ǫxzE∗

kx + ǫyzE∗
ky

J e
bz =

ǫzz

=

−

1
iω

∇t

H∗

kt ×

· (cid:18)

Je
bz
ǫzz (cid:19) −

1
iω

∇t

×

(cid:18)

Je
bz
ǫzz (cid:19) ·

H∗

kt −

ǫtz
ǫzz

J e
bz ,

bz H ∗
J m

kz =

1
iωµzz

(∇t

E∗

kt)

×

Jm
bz −

µxzH ∗

kx + µyzH ∗
ky

J m
bz =

µzz

=

1
iω

∇t

E∗

kt ×

· (cid:18)

Jm
bz
µzz (cid:19)

+

∇t

×

(cid:18)

Jm
bz
µzz (cid:19) ·

E∗

kt −

µtz
µzz

J m
bz ,

·
1
iω

where following [8] we have introduced the auxiliary vectors

ǫtz = x0 ǫxz + y0 ǫyz

and

µtz = x0 µxz + y0 µyz .

(5.19)

It is easy to see that the terms in Eqs. (5.17) and (5.18) containing the transverse divergence

operator ∇t

·

, after integrating over the bulk current area Sb, yield the following results

1
iω

∇t

E∗

kt ×

· (cid:18)

ZSb

Jm
bz
µzz (cid:19)

dS =

1
iω

nb

E∗

kt ×

· (cid:18)

ILb

Jm
bz
µzz (cid:19)

dl

≡

(5.15)

(5.16)

(5.17)

(5.18)

(5.20)

Je
s,ef ·

E∗

k dl ,

≡ −

ZLb

28

1
iω

−

∇t

H∗

kt ×

· (cid:18)

ZSb

Je
bz
ǫzz (cid:19)

dS =

1
iω

−

nb

H∗

kt ×

· (cid:18)

ILb

Je
bz
ǫzz (cid:19)

dl

≡

Jm
s,ef ·

H∗

k dl ,

≡ −

ZLb

(5.21)

where expressions (4.32) for the eﬀective surface currents have been used.

As is quite evident, the terms (5.20) and (5.21), being inserted in the excitation integral with

the bulk currents by means of equalities (5.17) and (5.18), fully compensate for the contribution

from the excitation integral with the eﬀective surface currents entering into Eq. (5.13) and

(5.14). Then the excitation equation (5.14) written for propagating modes takes the form

entirely coincident with that of Felsen and Marcuvitz [8] (in diﬀerent notation):

dak
dz

+ γk ak =

1
Nk ZSb

−

(Je

b,ef ·

ˆE∗

kt + Jm

ˆH∗

kt) dS

b,ef ·

−

1
Nk ZLs

−

(Je
s ·

ˆE∗

k + Jm
s ·

ˆH∗

k) dl

where following [8] we have introduced the eﬀective bulk currents

b,ef = Je
Je

bt +

∇t

1
iω (cid:18)

×

Jm
bz
µzz (cid:19) −

ǫtz
ǫzz

J e
bz ,

b,ef = Jm
Jm

bt −

∇t

1
iω (cid:18)

×

Je
bz
ǫzz (cid:19) −

µtz
µzz

J m
bz ,

with the transverse vectors ǫtz and µtz being deﬁned by formulas (5.19). The currents (5.23)
and (5.24) were introduced by Felsen and Marcuvitz in diﬀerent designations but of the same

structure.

From Eq. (5.22) it follows that the eﬀective bulk currents Je

b,ef , being formed
as mixtures of the longitudinal and transverse components of the actual electric and magnetic
currents, interact only with the transverse eigenﬁeld components ˆEkt and ˆHkt of the kth mode,
but in doing so take into account the contribution from the eﬀective surface currents Je
s,ef and
Jm
s,ef deﬁned by Eqs. (4.32). It should be mentioned that the contour integral in Eq. (5.22)
allowing for the contribution from the actual surface currents Je
is absent in the
appropriate equation of Felsen and Marcuvitz [8].

b,ef and Jm

s and Jm
s

In view of fundamental importance of the mode excitation equations, Appendix B displays

another derivation for the lossless waveguding structures based on the direct use of Eqs. (4.12)

and (4.13) which are an exact consequence of Maxwell’s equations (4.4) and (4.5). The general

case of lossy waveguides is studied below on the basis of the reciprocity theorem in complex-

conjugate form.

(5.22)

(5.23)

(5.24)

29

5.2 Approach Based on the Reciprocity Theorem

5.2.1 Derivation of the Conjugate Reciprocity Theorem

The basis of deriving the reciprocity theorem in complex-conjugate form is constituted by

two systems of Maxwell’s equations like Eqs. (4.4) and (4.5):

∇

∇

×

×

E1 =

iωB1 −

−

Jm
b1 ,

H1 = iωD1 + Je

b1 ,

∇

∇

×

×

E∗

2 = iωB∗

H∗

2 =

iωD∗

−

Jm∗
b2 ,

2 −
2 + Je∗
b2,

(5.25)

(5.26)

written for two diﬀerent electromagnetic processes (marked with subscripts 1 and 2) excited

by diﬀerent external currents (bulk and surface), with the frequency and the constitutive pa-

rameters of a waveguiding medium entering into relations (2.8) and (2.9) assumed to be the

same.

Application of the conventional technique to Eqs. (5.25) and (5.26) yields

∇

(E1 ×

·

H∗

2 + E∗

H1) =

(Je

b1 ·

−

E1)

(Jm
b1 ·

H∗

2 + Jm∗
b2 ·

−

H1)

−

2 ×
(D1 ·

h

iω

−

E∗

2 + Je∗
b2 ·
E1) + (B1 ·

E∗

2 −

D∗
2 ·

H∗

2 −

B∗
2 ·

H1)

.

i

(5.27)

After transformation with using the constitutive relations (2.8) and (2.9) the last term in

the right-hand side of Eq. (5.27) accepts the following form

(D1 ·

E∗

2 −

D∗
2 ·

iω

h

E1) + (B1 ·
2 + (¯ξ

H∗

2 −

B∗
2 ·

H1)

=

¯ζ †) : H1E∗

−

i
2 + ( ¯ζ

= iω

(¯ǫ

¯ǫ †) : E1E∗

2 + ( ¯µ

¯µ †) : H1H∗

−

−

h

¯ξ †) : E1H∗
2

−

.

i

In accordance with the aforesaid in Sec. 4.1, the permittivity tensor ¯ǫ is regarded here
as a sum (¯ǫ + ¯σc/iω) so that its antihermitian part determines the total tensor of electric
conductivity ¯σe = ¯σc + ¯σd taking into account both dielectric ( ¯σd) and conductor ( ¯σc) losses
of a medium. Magnetic losses ( ¯σm) are taken into account by the antihermitian part of the
permeability tensor ¯µ, whereas the tensor ¯σme = iω(¯ξ
¯ζ †) reﬂects the magneto-electric
losses due to bianisotropic properties of a medium. The use of Eqs. (2.21) – (2.23) converts

−

relation (5.27) into the diﬀerential form of the conjugate reciprocity theorem

where we have denoted

S12 + q12 = r(b)
12

∇

·

q12 = 2 ( ¯σe : E1E∗

S12 = E1 ×
2 + ¯σm : H1H∗

H1 ,

H∗

2 + E∗

2 ×
2) + ( ¯σme : H1E∗

2 + ¯σ †

me : E1H∗

2) ,

r(b)
12 =

(Je

b1 ·

E∗

2 + Je∗
b2 ·

−

E1)

(Jm
b1 ·

H∗

2 + Jm∗
b2 ·

−

H1) .

30

(5.28)

(5.29)

(5.30)

(5.31)

Superscript (b) reﬂects belonging an appropriate quantity to bulk properties of a system, while

the surface properties will be marked by superscript (s).

To obtain the integral form of the reciprocity theorem it is necessary to integrate Eq. (5.28)

over the cross section S of a waveguiding structure with using the integral relation similar to

Eq. (2.25) which involves the contour integrals taking into account two physical phenomena:

(i) the skin losses expressed by the boundary condition (2.26) with the surface impedance

tensor (2.27) given along a contour L ,
(ii) the discontinuity in tangential components of the ﬁelds caused both by the actual surface
currents Je
s located on a contour Ls with the boundary conditions (4.6) and (4.7) and
by the eﬀective surface currents Je
s,ef located on a contour Lb with the boundary
conditions (4.25) and (4.26).

s,ef and Jm

s and Jm

For the sake of brevity it is convenient to write both surface currents as the overall surface

sources

Σ = Je
Je

s + Je

s,ef

and

Σ = Jm
Jm

s + Jm
s,ef

(5.32)

located along the combined contour LΣ = Ls + Lb.

Substitution of Eq. (5.29) into the integral relation (2.25) yields

ZS
n+
s ·

·

h

−

ZL+Ls
h
nb

+

ZLb

=

∂
∂z

+

ZS

(cid:16)

E1 ×
(Je

h

ZLs
(Je

+

ZLb

h

∇

·

S12 dS =

∂
∂z

(E1 ×

H∗

2 + E∗

2 ×

2 + E∗

2 ×

ZS

H∗

E1 ×
(cid:16)
H1)+ + n−
s ·

(E1 ×

−

H1

z0 dS

·

(cid:17)
2 + E∗
H∗

2 ×

(Ea1 ×

H∗

b2 + E∗

b2 ×

Ha1) + (Eb1 ×

H∗

a2 + E∗

a2 ×

H∗

2 + E∗

2 ×

H1

z0 dS + 2

·

s (Hτ 1 ·

(cid:17)
2) + (Je∗
H∗
s2 ·

ZL R
E1 + Jm∗
s2 ·

E∗

2 + Jm
s1 ·

s1 ·

H1)

dl +

i

s,ef 1 ·

E∗

a2 + Jm

s,ef 1 ·

H∗

a2) + (Je∗

s,ef 2 ·

Ea1 + Jm∗

s,ef 2 ·

Ha1)

dl .

i

H1)−

dl +

i
dl =

Hb1)
i
τ 2) dl +

H∗

Here we have used:

(a) the boundary condition (2.26) on the contour L with surface

impedance (2.27), (b) the boundary conditions (4.6) and (4.7) with the actual surface currents
Je
s1(2) and Jm
Hb1(2) and Jm
×
the previous formula yield two resulting contributions:

s1(2) given on the contour Ls, (c) the eﬀective surface currents Je
s,ef 1(2) = nb

×
Eb1(2) deﬁned on the contour Lb. Therefore, the line integrals in

s,ef 1(2) =

nb

−

(i) from the skin losses on the contour L of a conducting surface

(ii) from the overall surface currents on the contour LΣ = Ls + Lb

q′
12 = 2

s (Hτ 1 ·
R

H∗

τ 2) ,

r(s)
12 =

(Je

Σ1 ·

E∗

2 + Je∗
Σ2 ·

−

E1)

(Jm

Σ1 ·

H∗

2 + Jm∗
Σ2 ·

−

H1) .

31

(5.33)

(5.34)

Therefore, the reciprocity theorem in the integral form is given by the relation

dP12(z)
dz

+ Q12(z) = R12(z)

(5.35)

where we have introduced the following integral quantities (complex-valued) (cf. Eqs. (2.29)

and (2.30))

P12(z)

S12(rt, z)

z0 dS =

≡

ZS

·

ZS

(E1 ×

H∗

2 + E∗

2 ×

H1)

z0 dS ,

·

(5.36)

Q12(z) = Q(b)

12 (z) + Q(s)

12 (z)

q12(rt, z) dS +

q′
12(rt, z) dl =

≡

ZS

ZL
( ¯σm : H1H∗

2) dS +

= 2

( ¯σe : E1E∗

2) dS + 2

ZS

ZS

+

( ¯σme : H1E∗

2 + ¯σ †

me : E1H∗

2) dS + 2

ZS

s (Hτ 1 ·

H∗

τ 2) dl ,

ZL R

(5.37)

R12(z) = R(b)

12 (z) + R(s)

12 (z)

r(b)
12 (rt, z) dS +

r(s)
12 (rt, z) dl =

≡

ZSb

ZLΣ

(Je

b1 ·

E∗

2 + Jm
b1 ·

H∗

2) + (Je∗
b2 ·

E1 + Jm∗
b2 ·

H1)

dS

−

=

−

ZSb

h

−

ZLΣh

(Je

Σ1 ·

E∗

2 + Jm

H∗

2) + (Je∗
Σ2 ·

E1 + Jm∗
Σ2 ·

Σ1 ·

H1)

dl .

(5.38)

i

i

It is easy to see that with no sources (when R12 = 0) the second system (with subscript 2)
of Maxwell’s equations (5.25) and (5.26) describes the same ﬁelds as the ﬁrst (marked by

subscript 1) only with taking complex conjugation. This makes it possible to replace subscript 2

with 1 and what is more to drop them. In this case the integral reciprocity theorem (5.35)

turns into the integral Poynting theorem (2.28) in which the real power ﬂow P and the real

power loss (bulk and surface) Q per unit length of a waveguide are equal to

P =

1
4

ZS

S11 ·

z0 dS

S

i ·

z0 dS ,

≡

ZSh

Q =

q11 dS +

1
4

ZS

1
4

ZL

q′
11 dl

q

dS +

≡

ZSh

i

q′

dl ,

i

ZLh

(5.39)

(5.40)

where their expressions in terms of ﬁelds are given by Eq. (2.29) and (2.30).

5.2.2 Derivation of the Equations of Mode Excitation

Inside the source region the reciprocity theorem in the integral form (5.35) is the basis for

obtaining the excitation equations. To this end, the ﬁelds marked by subscript 1 (which will

be dropped for the exciting currents) are assumed to be the desired ﬁelds excited by the bulk
and surface sources (Je,m

= 0) and represented in the form of

= 0 and Je,m

Je,m

Je,m
b

b1 ≡

Σ1 ≡

Σ

32

6
6
expressions (4.8) and (4.9) (with replacing summation index k by l), whereas those marked by
subscript 2 are the known ﬁelds of the kth mode outside the source region (Je,m
Σ2 = 0)
given in the form of Eq. (3.5).

b2 = Je,m

Substitution of Eqs. (4.8) and (4.9) into Eqs. (5.36), (5.37), and (5.38) yields the following

expressions:

(5.41)

(5.42)

(5.43)

(5.44)

(5.45)

P1k(z)

S1k(rt, z)

≡

ZS

·

z0 dS =

(E1 ×
ZS
Nkl Al(z) e− (γ∗

=

k +γl)z,

H∗

k + E∗

k ×

H1)

z0 dS =

·

Q1k(z)

q1k(rt, z) dS +

q′
1k(rt, z) dl =

≡

ZS
=

ZL
Mkl Al(z) e− (γ∗
k +γl)z,

Xl

Xl

R1k(z) = R(b)

1k (z) + R(s)

1k (z)

r(b)
1k (rt, z) dS +

r(s)
1k (rt, z) dl =

= R(b)

k (z) e− γ∗

≡

ZSb
k (z) e− γ∗
k z + R(s)
k z

ZLΣ
Rk(z) e− γ∗
k z,

≡

where the normalizing and dissipative coeﬃcients Nkl and Mkl have the form of Eqs. (2.36) and
(2.37) and the quantity Rk(z) = R(b)
k (z) consists of two exciting integrals (bulk and sur-
face):

k (z)+R(s)

R(b)

k (z) =

R(s)

k (z) =

−

ZSb

Je
b ·

ˆE∗

k + Jm
b ·

ˆH∗
k

dS ,

(cid:17)

(cid:16)
Je
Σ ·

−

ZLΣ (cid:16)
ˆH∗
dl
k

ˆE∗

k + Jm
Σ ·

ˆH∗
k

dl =

(cid:17)
ˆE∗
k + Jm

s,ef ·

Je
s,ef ·

=

−

ZLs

(cid:16)

Je
s ·

ˆE∗

k + Jm
s ·

−

ZLb

(cid:16)

(cid:17)

ˆH∗
k

dS .

(cid:17)

These integrals involve the cross-section eigenﬁeld vectors (marked with hat) and their

dependence on z is due to that of the external currents Je,m

(z) and Je,m

Σ (z).

b

It should be pointed out that Eqs. (5.41) and (5.42) come only from the ﬁeld contributions
of the mode expansions Ea and Ha since the orthogonal complementary ﬁelds Eb and Hb,
being proportional to the longitudinal component of external currents, do not contribute into

P1k and cannot inﬂuence the intrinsic losses in a medium related to Q1k.

Substitution of Eqs. (5.41), (5.42), and (5.43) into the integral reciprocity theorem (5.35)

(with replacing 2 by k) gives a relation

Nkl

dAl
dz −

(γ∗
h

Xl (cid:26)

k + γl)Nkl

Mkl

−

Al
i

(cid:27)

e− γlz = Rk

k + R(s)
R(b)
k .

≡

(5.46)

The quasi-orthogonality relation of the general form (3.6) make the square bracket in

Eq. (5.46) vanish so that it reduces to the desired set of the excitation equations written

33

in the following form:

(i) for the excitation amplitudes Al(z)

Nkl

dAl(z)
dz

Xl

e− γlz = R(b)

k (z) + R(s)

k (z) ,

k = 1, 2, . . .

(5.47)

(ii) for the mode amplitudes al(z) = Al(z) e− γlz

dal(z)
dz

Nkl

(cid:20)

Xl

(cid:21)

+ γlal(z)

= R(b)

k (z) + R(s)

k (z) ,

k = 1, 2, . . .

(5.48)

Discussion of the excitation equations obtained will be put oﬀ until the similar equations

for the waveguiding structures with space-dispersive media are developed in the second part of

the paper.

Up to this point the waveguiding structures under study are assumed to be closed with a

screening metallic boundary, whose spectrum of eigenmodes is always discrete.

In conclusion, it is pertinent to show features of the excitation theory peculiar to open

waveguiding structures (without losses) in which an outside homogeneous medium extends to

inﬁnity in one or both transverse directions. As is known [27, 29, 31], for the open waveguides

in addition to the discrete part of the spectrum of bound modes (with the outside medium

ﬁelds localized near outer boundaries of the waveguiding layer), there is a continuous part of

the spectrum related to radiation modes (with the ﬁelds extending to inﬁnity in the outside
medium). Unlike the eigenﬁelds Ek(rt, z) and Hk(rt, z) of discrete modes marked by the integer-
valued subscript k = 1, 2, . . . and expressed by Eqs. (3.5), the ﬁelds of a radiation mode

E(rt, z; ko

t ) = ˆE(rt; ko

t ) e− iβ(ko

t )z, H(rt, z; ko

t ) = ˆH(rt; ko

t ) e− iβ(ko

t )z

(5.49)

are speciﬁed by the transverse wave vector ko

t = x0 ko
y of the outside passive medium.
In this case the modal expansions of the ﬁelds Ea(rt, z) and Ha(rt, z) inside the source re-
gion, besides the series expansion in terms of discrete modes, involve also the integral expansion

x + y0 ko

in terms of radiation modes (cf. Eqs. (4.8) and (4.9)):

Ea(rt, z) =

Ak(z) ˆEk(rt) e− iβkz +

A(z; ko

t ) ˆE(rt; ko

t ) e− iβ(ko

t )z dko
t ,

Xk

Xk

Ha(rt, z) =

Ak(z) ˆHk(rt) e− iβkz +

A(z; ko

t ) ˆH(rt; ko

t ) e− iβ(ko

t )z dko
t ,

where integrating over ko

y is taken along the real axes from
The orthonormalization relation for radiation modes can be written by analogy with rela-

x and ko

−∞

∞

to

.

tion (3.18) for discrete modes in the following form

N (ko

t , ko′
t )

( ˆE∗(rt; ko
t )

ˆH(rt; ko′

t ) + ˆE(rt; ko′
t )

ˆH∗(rt; ko
t )

z0 dS =

≡

ZS

h

×

×

·

i

= δ(ko

ko′
t ) N (ko
t )

t −

(5.50)

(5.51)

(5.52)

Z

Z

34

ko′
t ) = δ(ko

ko′
ko′
x ) δ(ko
where the Dirac delta function δ(ko
y ) replaces the Kronecker
y −
ko′
t ) has dimensions of (length)2,
delta function δkl. It should be mentioned that since δ(ko
the dimensionality of the norm N (ko
t ) for the radiation
modes is equal to watts/m2 and m2, respectively, as distinct from the bounded modes for
which the similar quantities are taken in watts and as dimensionless.

t ) and the excitation amplitude A(z; ko

x −

t −

t −

The equation for the excitation amplitude A(z; ko

t ) of the radiation mode has the form

similar to Eq. (5.13):

dA(ko
t )
dz

=

−

1
N (ko
t )

Je
b ·

E∗(ko

t ) + Jm
b ·

H∗(ko
t )
(cid:17)

dS

−

ZSb

(cid:16)

1
N (ko
t )

−

Je

Σ ·

E∗(ko

t ) + Jm
Σ ·

H∗(ko
t )
(cid:17)

dl

ZLΣ(cid:16)

(5.53)

where the coordinate variables are dropped for simplicity.

The orthogonal complementary ﬁelds Eb = z0Eb and Hb = z0Hb obtained in the form of

Eqs. (4.21) and (4.22) remain valid for open waveguides.

6. CONCLUSION

We have shown a uniﬁed treatment of the electrodynamic theory of the guided wave excitation

by external sources applied to any waveguiding structure involving the complex media with

bianisotropic properties. Allowing for losses in such media has reduced to the power loss density
in Poynting’s theorem due to the magneto-electric conductivity ¯σme deﬁned by Eq. (2.23), in
addition to the usual electric and magnetic conductivities.

Application of the desired ﬁeld expansions in terms of eigenmode ﬁelds gives the self-power
and cross-power quantities (ﬂows and losses) transmitted and dissipated by the eigenmodes

of a lossy waveguide, as well as the time-average energy density stored by the propagating

modes in a lossless waveguide which involves the additional contributions from bianisotropic

properties of a medium.

The basis of developing the excitation theory for lossy waveguides is the novel relation (3.6)
called the quasi-orthogonality relation whose general form is always true including the propa-

gating (active) and nonpropagating (reactive) modes in lossless waveguides considered as a

special case. Among the external sources exciting the waveguiding structure we have included

the bulk sources (currents, ﬁelds, and medium perturbations) and the actual surface currents.

Inside the source region the modal expansions (2.31) and (2.32) have proved to be incomplete
and must be supplemented with the orthogonal complementary ﬁelds (4.21) and (4.22), as it
is done by Eqs. (4.8) and (4.9). Generally these complementary ﬁelds generate the eﬀective
surface currents (4.27) and (4.28). So in the most general case the external source region
contains the bulk currents Je,m
currents Je,m

s,ef brought about by the longitudinal components of the bulk currents.

, the actual surface currents Je,m

, and the eﬀective surface

s

b

35

The equations of mode excitation in the form of (5.47) or (5.48) have been derived by using

three approaches based on: (i) the direct derivation from Maxwell’s equations (see Appendix B),

(ii) the electrodynamic analogy with the mathematical method of variation of constants (see

Sec. 5.1), (iii) the reciprocity theorem in the complex-conjugate form (see Sec. 5.2).

All the results obtained are valid for the time-dispersive media speciﬁed by macroscopically-

local and frequency-dependent parameters. An extension of the theory to space-dispersive me-

dia which require for their description the special equations of motion with regard for nonlocal

eﬀects will be examined in the second part of the paper where the orthogonal complementary

ﬁelds are explained as a part of the contribution from the potential ﬁelds of external sources.

APPENDIX

A. BASIC RELATIONS OF FUNCTIONAL ANALYSIS AND

THEIR ELECTRODYNAMIC ANALOGS

A.1 Mathematical formulation (in notation of [42])

Unlike [42], we shall examine the general case of nonorthogonal base functions which gives

the orthogonal basis as a special case.

Consider a countable set of complex functions ψ1(x), ψ2(x), . . . quadratically integrable in
the sense of Lebesgue on a given set S of points (x). The class L2(S) of such functions (regarded
as vectors) constitutes an inﬁnite-dimensional unitary functional (vector) space if, in addition

to two binary operations of the vector sum ψk(x)+ψl(x) and the product akψk(x) by a complex
scalar ak, one deﬁnes the inner product of ψk(x) and ψl(x) as

(ψk, ψl) =

ψ∗

k(x)γ(x)ψl(x) dx

ZS

(A.1)

where the weighting function γ(x) is a given real nonnegative function quadratically integrable

on S, in particular, may be γ(x)

1.

≡

If Gram’s determinant det[(ψk, ψl)] built up on the inner products of the form (A.1) diﬀers
from zero, the functions ψk(x), k = 1, 2, . . . are linearly independent in L2 and can be chosen as
a basis of the unitary functional space, with their mutual orthogonality not being necessarily

required in general. The given set of functions ψk(x) spans a linear manifold comprising all
linear combinations of ψ1(x), ψ2(x), . . . .

Let us compose a partial sum of the nth order

sn(x) =

a(n)
k ψk(x)

(A.2)

with scalar coeﬃcients a(n)
k not yet deﬁned. Given a function ψ(x) fully belonging to the linear
manifold spanned by ψ1(x), ψ2(x), . . . , these coeﬃcients can be found from the requirement

n

Xk=1

36

(A.3)

(A.4)

(A.5)

(A.6)

(A.7)

(A.8)

(A.9)

that the weighted mean-square diﬀerence

Dn =

ZS

sn(x)
γ(x)
|

−

2 dx
ψ(x)
|

between sn(x) and ψ(x) would be minimum. With the help of Eq. (A.2) the quantity Dn can
be rewritten in the following form

n

a(n)∗
k ψ∗

k(x)

Dn =

ZS(cid:20)

Xk=1

ψ∗(x)
(cid:21)

γ(x)
(cid:20)

−

a(n)
l ψl(x)

−

ψ(x)
(cid:21)

dx .

n

Xl=1

Then the conditions of its minimality with respect to the set of coeﬃcients a(n)
k

are written as

∂Dn
∂a(n)∗
k

=

ψ∗

k(x)γ(x)
(cid:20)

ZS

n

Xl=1

a(n)
l ψl(x)

−

ψ(x)
(cid:21)

dx = 0 ,

∂2Dn

∂a(n)∗
k

∂a(n)
k

ZS

=

ψ∗

k(x)γ(x)ψk(x) dx > 0 .

Eq. (A.6) complies with the requirement of quadratic integrability initially imposed on the

base functions ψk(x), while the condition (A.5) yields the following system of equations to
ﬁnd a(n)
k :

Nkla(n)

l = Rk ,

k = 1, 2, . . .

where we have denoted

n

Xl=1

ZS

ZS

Nkl =

ψ∗

k(x)γ(x)ψl(x) dx

(ψk, ψl) ,

Rk =

ψ∗

k(x)γ(x)ψ(x) dx

(ψk, ψ) .

≡

≡

Metric convergence in L2 is deﬁned as convergence in mean (with index 2) of the sequence of
from Eqs. (A.7)) to the function ψ(x), i. e., sn(x) mean
−→

partial sums sn(x) (with coeﬃcients a(n)
k
ψ(x) as n

, which occurs if and only if

→ ∞

Dn

≡

ZS

sn(x)
γ(x)
|

−

2 dx
ψ(x)
|

→

0 as n

.

→ ∞

(A.10)

Using Eqs. (A.7) through (A.9) and the equality Nkl = N ∗

lk allows Eq. (A.4) to take the

following form

Dn =

n

n

Xk=1

Xl=1

Nkla(n)∗
k

a(n)
l −

Rka(n)∗

k −

R∗

l a(n)

l +

2 dx =
ψ(x)
γ(x)
|
|

ZS

n

Xk=1
Nkla(n)∗
k

n

Xl=1

a(n)
l +

ZS

2 dx .
ψ(x)
γ(x)
|
|

=

−

n

n

Xk=1

Xl=1

From here for limiting case (A.10), when a(n)

k (z)

→

ak(z) as n

, it follows that

(ψ, ψ)

ψ∗(x)γ(x)ψ(x) dx =

≡

ZS

→ ∞

Nkla∗

kal .

∞

∞

Xk=1

Xl=1

(A.11)

37

Relation (A.11) is realizable only for functions ψ(x) quadratically integrable on S (with

the weighting function γ(x)), i. e., for which there exists an integral on the left. This relation

expresses completeness of the set of the base functions ψk(x) (also quadratically integrable
on S) inside the class of functions ψ(x). The completeness property establishes the space L2
as the Hilbert space for which the series expansion

∞

ψ(x) mean=

akψk(x)

(A.12)

Xk=1
interpreted in the sense of convergence in mean given by formula (A.10) is valid. Uniqueness

of this expansion arises from the following reasoning.

k a′

k a′′

P

k and a′′

kψk(x) and

By conradiction,

let two diﬀerent series expansions

kψk(x) corre-
spond to the same function ψ(x) in the sense of convergence in mean. To determine the
expansion coeﬃcients a′
k there are two systems of form (A.7) with the same right-hand
a′′
sides Rk. When resulted from them, the diﬀerence system of equations
l ) =
a′′
0, k = 1, 2, . . . gives a′
= 0, i. e., the initial series expansions coincide.
l by virtue of Nkl
k akψk(x) corresponds to two
If on the contrary one assumes that the same series expansion
ψ′′(x) has
diﬀerent functions ψ′(x) and ψ′′(x), then the diﬀerence function ψ−(x) = ψ′(x)
the expansion coeﬃcients identically equal to zero. So the right-hand side of the complete-
ness relation (A.11) vanishes, which necessarily provides ψ−(x)
coincide.

0, i. e., the initial functions

l Nkl(a′

l −

l ≡

P

P

P

−

≡

The completeness relation (A.11) is a generalization of the conventional Parseval identity

(see Eq. (A.16)) to the case of nonorthogonal bases. All the aforestated convince us that linear

independence and completeness of the set of base functions ψk(x) are fundamental properties
of the basis, whereas their mutual orthogonality is not obligatory requirement and merely

facilitates the problem of ﬁnding the expansion coeﬃcients ak. Indeed, for the orthogonal basis

(ψk, ψl)

ψ∗

k(x)γ(x)ψl(x) dx = 0

for k

= l

≡

ZS

so that

Nkl = Nkδkl with Nk =

ψ∗

k(x)γ(x)ψk(x) dx

ψk

2
k

≡ k

ZS

k

=

ψk
k

(ψk, ψk)

where
addition, we extend this term to quantities Nkl recognizing the self norm Nk
p
and the cross norm Nkl for l

√Nk is conventionally called the norm of a function ψk(x) [42]. In
Nkk for l = k

= k.

≡

≡

Hence, in the special case of the orthogonal basis satisfying Eq. (A.14):

(i) the system of coupled equations (A.7) falls apart into separate equations yielding

(A.13)

(A.14)

ak =

Rk
Nk ≡

(ψk, ψ)
(ψk, ψk)

=

1
Nk ZS

ψ∗

k(x)γ(x)ψ(x) dx ,

(A.15)

(ii) the general completeness relation (A.11) gives the conventional Parseval identity

(ψ, ψ)

ψ∗(x)γ(x)ψ(x) dx =

≡

ZS

∞

Xk=1

Nk

ak
|

2 .
|

(A.16)

38

6
6
6
It should be remembered that the use of the known Gram-Schmidt orthogonalization pro-

cess [42], in principle, allows one to construct the orthonormal basis.

The above completeness property of a basis expressed by relation (A.11) or (A.16) concerns

only such functions ψ(x) that fully belong to the linear manifold spanned by the functions

ψ1(x), ψ2(x), . . . . However, for the most general functions f (x) this is not the case.

Any given function f (x) quadratically integrable on S (with the weighting function γ(x),

in general) can formally be associated with the function ψ(x) represented by series (A.12) if

one assumes that its coeﬃcients ak satisfying Eqs. (A.7) through (A.9) are due to f (x) and
i. e., the quantities Rk(x) contain f (x) in place of ψ(x) under the integral sign
not to ψ(x),
ψ(x) is orthogonal to every base

of Eq. (A.9). Let us prove that the diﬀerence c (x) = f (x)

function ψk(x) in the sense of relation (A.13):

(ψk, c)

(ψk, f

ψ) = (ψk, f )

(ψk, ψ) =

≡

−

= (ψk, f )

(ψk, ψl)al = Rk

Nklal = 0

(A.17)

−

Xl

where the relations Nkl = (ψk, ψl) and Rk = (ψk, f ) have been used.

Thus, any arbitrary function f (x) not belonging fully to the Hilbert space (spanned, for

instance, by eighenfunctions of a boundary-value problem) can be represented in the following

−

−

−

Xl

form

f (x) = ψ(x) + c (x) =

akψk(x) + c (x) .

(A.18)

Xk
Here the function ψ(x) written as a series expansion in terms of base functions (convergent
in mean) and considered as tangential to the given Hilbert space is called the projection of f (x)

on this space, while c (x) is a function orthogonal to the Hilbert space and reﬀered to as the
orthogonal complement because (ψk, c) = 0. For such a function f (x) instead of the generalized
Parseval identity (A.11) there exists the generalized Bessel inequality

(f, f )

2
ψ + c
k

≡ k

≡

ZS

f ∗(x)γ(x)f (x) dx

Nkla∗

kal or

(A.19)

∞

∞

≥

Xk=1

Xl=1

∞

≥

Xk=1

Nk

ak
|

2
|

where the last single sum corresponds to the orthogonal basis.

A.2 Electrodynamic treatment (in notation of [8])

Let us consider a relevant aspect of the electrodynamic modal theory on the basis of analogy

with the foregoing mathematical relations.

Given an inﬁnite set of eigenfunctions of a boundary-value problem deﬁned on the cross
section S of a waveguiding structure with the transverse radius vector rt and the longitudinal
axis z, any eigenfunction Ψk(rt) and its adjoint (hermitian conjugate) Ψ†
k(rt) are denoted in
the two-vector notation as

Ψk(rt) =

ˆEk(rt)
ˆHk(rt)!

 

and Ψ†

k(rt) =

k(rt) ˆH∗

ˆE∗
(cid:16)

k(rt)
(cid:17)

(A.20)

39

where the hat over ﬁeld vectors means the absence of their dependence on z.

By analogy with Eq. (A.1), the inner product of two eigenfunctions Ψk(rt) and Ψl(rt) can

be deﬁned in the following form

(Ψk, Ψl) =

Ψ†

k(rt)

¯Γ

·

·

Ψl(rt) dS

ZS

(A.21)

with the weighting function given in the form of a special dyadic

¯I

¯Γ =

0
z0 ×
where z0 is the unit vector of the axis z and ¯I is the unit dyadic such that (z0 ×
z0) = z0 ×
a
−
Ψl = Ψ†
the double scalar product Ψ†
k ·
k ·
integral sign of Eq. (A.21) be equal to ( ˆE∗
k ×

a =
a for any vector a. The weighting dyadic ¯Γ is constructed so as to make
k under the

¯Γ
Ψl
·
ˆHl + ˆEl
(cid:17)
(cid:16)

Ψ†
k ·
ˆH∗
(cid:16)
k)
·

¯Γ : ΨlΨ†

¯Γ
z0.
(cid:17)

(A.22)

z0 ×
0

Ψl

(¯I

¯I)

¯Γ

×

−

≡

=

×

(cid:18)

(cid:19)

¯I

·

·

·

·

Thus, the cross norm Nkl for the kth and lth modes and the self norm Nk

Nkk for the

≡

kth mode, according to Eqs. (A.8) and (A.21), can be represented as

Nkl

(Ψk, Ψl) =

≡

¯Γ

Ψ†
k ·

·

Ψl dS =

ZS
ˆHl + ˆEl

( ˆE∗

k ×

=

ZS

ˆH∗
k)

z0 dS

×

·

Nk

(Ψk, Ψk) =

≡

¯Γ

Ψ†

k ·

·

ZS

Ψk dS =

= 2 Re

ZS

( ˆE∗

k ×

ˆHk)

·

z0 dS .

(A.23)

(A.24)

By analogy with the series expansion (A.18), an arbitrary function F(rt, z) quadratically
integrable on S can be represented as a sum of the modal expansion Ψ(rt, z) in terms of
eigenfunctions Ψk(rt) (the projection of F(rt, z) tangent to Hilbert space and convergent in
mean) and the orthogonal complement C(rt, z):

F(rt, z) = Ψ(rt, z) + C(rt, z) =

ak(z) Ψk(rt) + C(rt, z)

(A.25)

where we have denoted

F(rt, z) =

, Ψ(rt, z) =

, C(rt, z) =

E(rt, z)
H(rt, z)!

 

Eb(rt, z)
Hb(rt, z)!

 

and by analogy with Eq. (A.17) the orthogonal complement C satisfy the relation

Xk

Ea(rt, z)
Ha(rt, z)!

 

(Ψk, C)

¯Γ

Ψ†
k ·

·

C dS =

( ˆE∗

k ×

ZS

Hb + Eb

ˆH∗
k)

·

×

≡

ZS

z0 dS = 0 .

(A.26)

Eqs. (A.25) and (A.26) allow the electromagnetic ﬁelds to be represented in the following

E(rt, z) = Ea(rt, z) + Eb(rt, z) =

ak(z) ˆEk(rt) + Eb(rt, z) ,

(A.27)

Xk

40

and

form

H(rt, z) = Ha(rt, z) + Hb(rt, z) =

ak(z) ˆHk(rt) + Hb(rt, z) ,

(A.28)

Xk

where the orthogonal complementary ﬁelds Eb(rt, z) and Hb(rt, z) as well as the mode ampli-
tudes ak(z) of the modal expansions

Ea(rt, z) =

ak(z) ˆEk(rt)

and

Ha(rt, z) =

ak(z) ˆHk(rt)

(A.29)

Xk

Xk

should be determined. The amplitudes ak(z), in principle, can be found from the equations
similar to Eqs. (A.7) for the nonorthogonal basis or to Eq. (A.15) for the orthogonal basis, with

Rk being given as follows

Rk

(Ψk, Ψ) = (Ψk, F) =

≡

¯Γ

Ψ†
k ·

·

ZS

F dS =

( ˆE∗

k ×

=

ZS

H + E

ˆH∗
k)

·

×

z0 dS ,

(A.30)

(A.31)

(A.32)

(A.33)

in particular, by analogy with Eq. (A.15)

ak =

Rk
Nk ≡

(Ψk, F)
(Ψk, Ψk)

=

1
Nk ZS

( ˆE∗

k ×

H + E

ˆH∗
k)

·

×

z0 dS .

It is of great importance in electrodynamic applications that such a procedure of determining

the mode amplitude ak(z) based on Eqs. (A.7) or (A.15) allows us instead of the series expansion
Ψ(rt, z) in terms of eigenmodes to apply its ﬁnite sum of the nth order

Sn(rt, z) =

a(n)
k (z)Ψk(rt)

n

Xk=1

like Eq. (A.2), which yields the least mean-square error

S†
ZS
h
analogously to Eq. (A.4).

Dn =

n(rt, z)

−

Ψ†(rt, z)

¯Γ

Sn(rt, z)

(cid:21) ·

· (cid:20)

−

Ψ(rt, z)
i

dS ,

The above general reasoning concerning the convergence in mean, completeness, and orthog-

onality properties of base functions can be extended to the electrodynamic basis of eigenfunc-

tions so that, in particular, the generalized Parseval identity (A.11) and Bessel inequality (A.19)

take the following form

and

(Ψ, Ψ)

2 =
Ψ
k

≡ k

Ψ†

¯Γ

·

·

Ψ dS =

(E∗

a ×

=

ZS

Ha + Ea

H∗
a)

·

×

z0 dS =

ZS
∞

∞

Xk=1

Xl=1

Nkla∗

kal or =

(A.34)

∞

Xk=1

Nk

ak
|

2
|

(F, F)

Ψ + C

≡ k

2 =
k
∞

F†

¯Γ

F dS =

·

·

ZS
∞
Nkla∗

kal

or

=

(E∗

H + E

ZS

×

H∗)

z0 dS

×

·

≥

∞

≥

Xk=1

Nk

ak
|

2
|

(A.35)

Xk=1

Xl=1

41

where the last single sums correspond to the orthogonal basis.

As noted above, the orthogonality property of a basis is not mandatory but its existence

facilitates the determination of the expansion coeﬃcients ak(z). Such a property is inherent in
lossless physical systems, whereas losses destroy the ”pure” orthogonality and convert it into
the so-called quasi-orthogonality (see Sec. 3.1).

B. DIRECT DERIVATION OF THE EQUATIONS OF MODE

EXCITATION FROM MAXWELL’S EQUATIONS

Starting point to derive the equation of mode excitation is formulas (4.12) and (4.13) which

are a result of transforming Maxwell’s equations (4.4) and (4.5) inside the source region. Let

us rewrite Eqs. (4.12) and (4.13) for transverse components:

(B.1)

(B.2)

(B.4)

(B.5)

dAl
dz

dAl
dz

Xl

Xl

(z0 ×

El) =

∇

Eb

iωµ0Mbt

−

×

−

Jm

bt ,

−

(z0 ×

Hl) =

∇

−

×

Hb + iωPbt + Je

bt .

Here, in accordance with Eq. (2.2), the orthogonal complements for the polarization Pb and

magnetization Mb are deﬁned as

Pb = Db

ǫ0Eb

and

µ0Mb = Bb

µ0Hb

(B.3)

−

so that, as follows from Eqs. (4.14), (4.15), (4.17), and (4.18), their longitudinal components

contribute to the complementary ﬁelds:

−

≡

≡

Eb

z0 Eb =

( Je

bz + iωPbz) ,

Hb

z0 Hb =

(Jm

bz + iωµ0Mbz) .

1
iωǫ0
1
iωµ0

−

−

If we scalar-multiply Eqs. (B.1) and (B.2) by H∗

k and

E∗

−

k, respectively, and add the results,

then after integrating over S we obtain

dAl
dz

(E∗

k ×

ZS

Xl

Hl + El

H∗
k)

·

×

z0 dS =

∇

(E∗
k ·

×

Hb

H∗
k ·

−

∇

×

Eb) dS

−

ZS

(Je

bt ·

E∗

kt + Jm
bt ·

−

H∗

kt) dS

iω

(Pbt

E∗

kt + µ0Mbt

H∗

kt) dS .

−

·

·

ZS
Now it is necessary to transform the ﬁrst integral in the right-hand side of Eq. (B.6). The

ZS

(B.6)

terms of its integrand can be rearranged as follows

∇

E∗
k ·

Hb = z0 ·

×

(E∗

k ×
k + M∗
= iωµ0 (H∗
k)

∇Hb) = Hb

∇

E∗

k −

∇

z0 ·
k Hb) ,

(E∗

×

·

×
∇
z0 ·

×

(E∗

k Hb) =

Hb

·

−

42

∇

H∗
k ·

×

(H∗

Eb = z0 ·
=

k ×
iω (ǫ0E∗

−

∇Eb) = Eb

·

∇

×
z0 ·

H∗

k −

∇

z0 ·
k Eb) ,

×

k + P∗
k)

Eb

·

−

∇

(H∗

×

(H∗

k Eb) =

where in the last equalities for the kth mode we have used Eqs. (5.9) and (5.10). Then the ﬁrst

integral in Eq. (B.6) turns into the sum of three integrals:

∇

(E∗
k ·

×

Hb

H∗
k ·

−

∇

×

Eb) dS =

∇

×

ZSb

(H∗

k Eb

E∗

k Hb)

z0 dS +

−

·

ZSb

+ iω

ZSb

(E∗
k ·

ǫ0Eb + H∗
k ·

µ0Hb) dS + iω

(P∗
k ·

Eb + µ0M∗
k ·

ZSb

Hb) dS .

(B.7)

The ﬁrst integral in the right-hand side of Eq. (B.7) is transformed by using the Stokes

theorem [42] into the following form

∇

×

ZSb

(H∗

k Eb

E∗

k Hb)

z0 dS =

(H∗

k Eb

E∗

k Hb)

τ dl =

−

·

ILb

−

·

=

ILb

h

(nb

Hb)

×

E∗

k −

·

(nb

×

Eb)

H∗
k

dl

·

i

(B.8)

where nb and τ = z0 ×
to the contour Lb bounding the bulk current area Sb.

nb are the unit vectors, respectively, normal (outward) and tangential

The second integral in the right-hand side of Eq. (B.7) is rearranged by using Eqs. (B.4)

and (B.5) to the following form

iω

ZSb

(E∗
k ·

ǫ0Eb + H∗
k ·

µ0Hb) dS =

(J e

bz E∗

kz + J m

bz H ∗

kz) dS

(Pbz E∗

kz + µ0Mbz H ∗

kz) dS .

(B.9)

=

−

ZSb

iω

−

ZSb

After inserting Eqs. (B.8) and (B.9) into Eq. (B.7) we obtain

∇

E∗
k ·

×

Hb

H∗
k ·

−

∇

×

Eb

dS =

(nb

Hb)

×

E∗

k −

·

(nb

×

Eb)

H∗
k

·

dl

−

i

(J e

bz E∗

kz + J m

bz H ∗

kz) dS

(Pbz E∗

kz + µ0Mbz H ∗

kz) dS +

(cid:17)

ILb

h

iω

−

ZSb

ZSb

(cid:16)

−

ZSb

+ iω

ZSb

(P∗
k ·

Eb + µ0M∗
k ·

Hb) dS .

(B.10)

The ﬁrst integral in the right-hand side of Eq. (B.10) involves the eﬀective surface currents
Eb deﬁned by Eqs. (4.27) and (4.28). With allowing for this

Je
s,ef =
and employing the expression for the normalizing coeﬃcient

Hb and Jm

s,ef = nb

nb

×

−

×

Nkl =

(E∗

k ×

ZS

Hl + El

H∗
k)

·

×

z0 dS ,

43

the substitution of Eq. (B.10) into Eq. (B.6) yields

Nkl

dAl
dz

=

−

ZSb

Xl

iω

−

ZSb

h

(Je
b ·

E∗

k + Jm
b ·

H∗

k) dS

(Je

s,ef ·

E∗

k + Jm

s,ef ·

H∗

k) dl

−

−

ZLb

(Pb

E∗

k −

P∗
k ·

·

Eb) + (µ0Mb

H∗

k −

µ0M∗
k ·

·

Hb)

dS .

(B.11)

i

The last integral in the right-hand side of Eq. (B.11) vanishes because of

(Pb

E∗

k −

P∗
k ·

·

Eb) + (µ0Mb

µ0M∗
k ·

Hb)

=

h

=

(Db

h

·

E∗

D∗
k ·

k −
¯µ †) : HbH∗

−

Eb) + (Bb

k + (¯ξ

−

Hb)

B∗
k −
k ·
·
i
k + ( ¯ζ
¯ζ †) : HbE∗

i
=

−

H∗

·

k −
H∗

¯ǫ †) : EbE∗

k + ( ¯µ

=

(¯ǫ
h

−

¯ξ †) : EbH∗
k

= 0

i

where the constitutive relations (2.8), (2.9), and (2.13) have been used for lossless bianisotropic

media.

For the most general case of the reactive kth mode from the orthonormalization rela-
tion (3.24) we have Nkl = Nkδ˜kl. Then formula (B.11) ﬁnally gives the excitation equation for
the ˜kth mode:

dA˜k
dz

=

−

1
Nk ZSb

(Je
b ·

E∗

k + Jm
b ·

H∗

k) dS

−

1
Nk ZLb

−

(Je

s,ef ·

E∗

k + Jm

H∗

k) dl .

s,ef ·

(B.12)

This formula is in agreement with the similar equation (5.13) obtained by another method,

not counting the absence of the actual surface currents which can be considered as enclosed

implicitly into the bulk currents.

References

[1] Ramo, S., and J. R. Whinnery, Fields and Waves in Modern Radio, Wiley, New York,

1953, see also the revised edition, Wiley, New York, 1970.

[2] Vainshtein, L. A., Electromagnetic Waves, Soviet Radio, Moscow, 1957 (in Russian).

[3] Collin, R. E., Field Theory of Guided Waves, McGraw-Hill, New York, 1960, see also the

second edition, IEEE Press, New York, 1991.

[4] Jackson, J. D., Classical Electrodynamics, Wiley, New York, 1962.

[5] Johnson, C. C., Field and Wave Electrodynamics, McGraw-Hill, New York, 1965.

44

[6] Stix, T. H., The Theory of Plasma Waves, McGraw-Hill, New York, 1962.

[7] Ginzburg, V. L., Propagation of Electromagnetic Waves in Plasmas, Nauka, Moscow, 1967

(in Russian).

[8] Felsen, L. B., and N. Marcuvitz, Radiation and Scattering of Electromagnetic Waves,

Prentice-Hall, Englewood Cliﬀs, NJ, 1973.

[9] Akhiezer, A. I., et. al., Plasma Electrodynamics, Pergamon Press, Oxford, 1975.

[10] Steele, M. C., and B. Vural, Wave Interactions in Solid State Plasmas, McGraw-Hill, New

York, 1969.

demic Press, New York, 1973.

[11] Platzman, P. M., and P. A. Wolﬀ, Waves and Interactions in Solid State Plasmas, Aca-

[12] Pierce, J. R., Traveling Wave Tubes, Van Nostrand, New York, 1950.

[13] Louisell, W. H., Coupled Mode and Parametric Electronics, Wiley, New York, 1960.

[14] Chodorow, M., and C. Susskind, Fundamentals of Microwave Electronics, McGraw-Hill,

New York, 1964.

[15] Auld, B. A., Acoustic Fields and Waves in Solids, Wiley, New York, Vol. 1 and 2, 1973.

[16] Dieulesaint, E., and D. Royer, Elastic Waves in Solids, Wiley, New York, 1980.

[17] Kino, G. S., Acoustic Waves, Prentice-Hall, Englewood Cliﬀs, NJ, 1987.

[18] Lax, B., and K. J. Button, Microwave Ferrites and Ferrimagnetics, McGraw-Hill, New

York, 1962.

Amsterdam, 1968.

Press, New York, 1981.

[19] Akhiezer, A. I., V. G. Bar’yakhtar, and S. V. Peletminskii, Spin Waves, North-Holland,

[20] Sodha, M. S., and N. C. Srivastava, Microwave Propagation in Ferrimagnetics, Plenum

[21] Soohoo, R. F., Microwave Magnetics, Harper & Row, New York, 1985.

[22] Stancil, D. D., Theory of Magnetostatic Waves, Springer-Verlag, New York, 1993.

[23] Gurevich, A. G., and G. A. Melkov, Magnetic Oscillations and Waves, Nauka, Moscow,

1994 (in Russian).

[24] Barybin, A. A., ”Electrodynamic Concepts of Wave Interactions in Thin-Film Semicon-
ductor Structures,” Pt. I and II in Advances in Electronics and Electron Physics, edited

by L. Marton, Academic Press, New York, Vol. 44, 99-139, 1977 and Vol. 45, 1-38, 1978.

45

[25] Barybin, A. A., Waves in Thin-Film Semiconductor Structures with Hot Electrons, Nauka,

Moscow, 1986 (in Russian).

[26] Marcuse, D., Light Transmission Optics, Van Nostrand, New York, 1972.

[27] Marcuse, D., Theory of Dielectric Optical Waveguides, Academic Press, New York, 1974.

[28] See Introduction to Integrated Optics, edited by M. K. Barnoski, Plenum Press, New York,

[29] Kogelnik, H., in Integrated Optics, edited by T. Tamir, Springer-Verlag, Berlin, 1975, and
in Guided-Wave Optoelectronics, edited by T. Tamir, Springer-Verlag, Berlin, 1988.

[30] Unger, H.-G., Planar Optical Waveguides and Fibers, Clarendon Press, Oxford, 1977.

[31] Snyder, A. W., and J. D. Love, Optical Waveguide Theory, Chapman & Hall, London,

1974.

1983.

[32] Yariv, A., and P. Yeh, Optical Waves in Crystals, Wiley, New York, 1984.

[33] Post E. J., Formal Structure of Electromagnetics, North-Holland, Amsterdam, 1962.

[34] Kong J. A., Electromagnetic Wave Theory, Wiley, New York, 1986.

[35] Lindell I. V., Methods for Electromagnetic Field Analysis, Clarendon Press, Oxford, 1992.

[36] O’Dell T. H., The Electrodynamics of Magneto-Electric Media, North-Holland, Amster-

dam, 1970.

[37] Lakhtakia, A., V. K. Varadan, and V. V. Varadan, Time-Harmonic Electromagnetic Fields

in Chiral Media, Springer-Verlag, Berlin, 1989.

[38] Lindell, I. V., A. H. Sihvola, S. A. Tretyakov, and A. J. Viitanen, Electromagnetic Waves

in Chiral and Bi-Isotropic Media, Artech House, Boston and London, 1994.

[39] See Electromagnetic Waves, edited by J. A. Kong, PIER 9, Bianisotropic and Bi-isotropic
Media and Applications, edited by A. Priou, EMW Publishing, Cambridge, MA, 1994.

[40] See Electromagnetic Waves, edited by J. A. Kong, PIER 12, EMW Publishing, Cambridge,

MA, 1996, ch. 12, 13, and 14.

Reading, Mass., 1960.

McGraw-Hill, New York, 1961.

[41] Landau, L. D., and E. M. Lifshitz, Electrodynamics of Continuous Media, Addison-Wesley,

[42] Korn, G. A., and T. M. Korn, Mathematical Handbook for Scientists and Engineers,

46

