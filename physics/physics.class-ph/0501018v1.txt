5
0
0
2
 
n
a
J
 
6
 
 
]
h
p
-
s
s
a
l
c
.
s
c
i
s
y
h
p
[
 
 
1
v
8
1
0
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

UCB/LBNL-CBP preprint

A Hilbert-space formulation of and variational principle for
spontaneous wiggler radiation

A.E. Charman∗ and J.S. Wurtele
Department of Physics, University of California, Berkeley, Berkeley, CA 94720, USA
Center for Beam Physics, Lawrence Berkeley National Laboratory, USA
(Dated: 22 December 2004)

Within the framework of Hilbert space theory, we derive a maximum-power variational principle
applicable to classical spontaneous radiation from prescribed harmonic current sources. Results
are ﬁrst derived in the paraxial limit, then appropriately generalized to non-paraxial situations.
The techniques were developed within the context of undulator radiation from relativistic electron
beams, but are more broadly applicable.

PACS numbers: 02.70.Dh, 41.20.Jb, 41.60.Ap, 41.60.Cr, 42.25.Bs, 45.10.Db, 52.38.Ph, 52.40.Db,

52.59.Rz, 52.59.Ye

I.

INTRODUCTION

Variational principles are ubiquitous in electromagnetism [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]. Thomson’s and
Dirichlet’s Principles allow the determination of potentials or capacitances in electrostatics, or the deter-
mination of steady-state currents and voltages in electrical networks. General reciprocity relations lead to
variational estimates for eigenmodes of cavities or waveguides, impedances of cavities, apertures, or other
structures, and even certain scattering coeﬃcients. In magnetohydrodynamics, plasma kinetic theory,
and certain equilibrium or non-equilibrium thermodynamic situations, stability or dynamics accessibility
of charged particle distributions has been derived from minimum energy/free energy, maximum entropy,
or minimum entropy production or minimum heat production principles [12, 13, 14, 15, 16, 17, 18, 19, 20].
Density functional theory, an elaboration of the famous Thomas-Fermi and Hartree-Fock methods in
quantum mechanics, has also been applied to classical and quantum Coulomb gases [21, 22]. Many
numerical methods and approximation techniques [8, 23, 24, 25, 26, 27, 28] for mechanical or manual
computation, associated with the names Raleigh, Ritz, Galerkin, Finite Elements, Minimum Residuals,
Method of Moments, etc., may all be derived from or interpreted as variational principles. As is well
known, all of ray optics may be derived from Fermat’s Principle of Least Time, and ultimately, all of
classical electrodynamics may be derived via Hamilton’s Principle, a variational formulation demanding
stationarity of the action functional.

Variational techniques or approaches enjoy many advantages. They provide uniﬁed theoretical treat-
ments and compact mathematical descriptions of many physical phenomena, which allow for straight-
forward change of coordinates and incorporation of additional constraints. Conventional equations of
motion and conservation laws may be derived in an concise manner. Connections between classical and
quantum limits are often more readily apparent. Variational principles often suggest appealing physical
interpretations of the behaviors governed by them. They provide a uniﬁed, compact framework for
performing eikonal, ponderomotive, or other averaging techniques. Perhaps most importantly from a
practical standpoint, they oﬀer starting points for eﬃcient approximation or numerical computation,
whereby complicated partial diﬀerential equations or integro-diﬀerential equations may be replaced with
more tractable mathematical beasts, namely quadratures, ordinary diﬀerential equations, systems of
algebraic or even linear equations, or ordinary function minimization. Although approximate, these sim-
pliﬁed, projected, or parameterized variational solutions may be more easily interpreted or more easily
computed or oﬀer more insight than the exact forms.

Here, we derive another principle, which we will call the Maximum-Power Variational Principle (MPVP),
together with some surrounding mathematical formalism. Although relatively simple in its statement

∗Electronic address: acharman@physics.berkeley.edu

2

and scope, somewhere between intuitively plausible and obvious, depending upon one’s point of view,
the MPVP may be of some use in the classical theory of radiation, in particular in the analysis of light
sources relying on spontaneous radiation from relativistic electron beams in undulators or other magnetic
insertion devices, or more generally, for the approximation of features of other forms of synchrotron
or “magnetic Bremsstrahlung” radiation. After some suitable generalization, these ideas may also be
applicable to the cases of ˇCerenkov, transition, wave-guide/cavity, Smith-Purcell, or other types of
radiation emitted by classical particle beams traveling through certain media or structures.

This work arose out of a recent treatment of coherent X-ray generation via a harmonic cascade in an
electron beam which radiates in the low-gain regime while traveling through a series of undulators. Penn,
et al. [29, 30, 31] approximate the modal structure of the radiation in terms of a paraxial mode described
by certain adjustable parameters. Some of these parameters are subsequently determined directly by
dynamical considerations, but some remain free, and are determined at the end of the calculation under
the assumption that the “proper” or “natural” criterion is to choose the values of these parameters which
maximize the resulting radiated power assuming that mode shape. This procedure seems so physically
reasonable, appealing, and plausible that intuition suggests that, in some sense, it must be the correct
approach under the circumstances. However, at least the present authors’ intuitions fail to immediately
suggest a precise derivation or rigorous justiﬁcation of this power-maximization idea. Then again, it does
lead us to expect that the governing principles or concepts should be quite fundamental, and applicable
to more general radiation problems.

In this paper we pursue these ideas, developing various Hilbert-space approaches to the spontaneous
radiation from prescribed current sources, culminating in the Maximum-power variational principle
(MPVP) applicable to such problems under very general assumptions. Although the ﬁnal results are
quite simple and intuitive, the mathematics are developed in some detail in a deliberate and pedagogical
fashion; much can probably be skipped with impunity by all but the most interested readers.

We ﬁrst consider the approximate but commonly-encountered case of paraxial ﬁelds, where the structure
and dynamics of the ﬁelds and the development of the mathematical results are greatly simpliﬁed.
Motivated by the parallels between the Schrodinger equation in non-relativistic quantum mechanics
and the paraxial wave equation of classical physical optics, we present an elementary derivation of
a convenient Hilbert-space formalism for the spontaneous radiation produced by prescribed classical
sources in the paraxial limit, including a derivation of the MPVP. Guided by these results, we then
employ Green function and spherical wave treatments of the general three-dimensional radiation ﬁelds
to generalize these results to the case of non-paraxial ﬁelds propagating in free space. Speciﬁcally, we
have in mind applications to the spontaneous synchrotron emission from a reasonably well-collimated
relativistic electron bunch in a wiggler or similar insertion device, although the results remain valid more
generally.

By spontaneous emission, we mean that the trajectories of the charged particles constituting the source
for the radiation are considered prescribed functions of time, independent of the actual radiation ﬁelds
generated. That is, the particle trajectories are assumed to be determined by initial conditions, externally
applied wiggler or other guiding ﬁelds, and possibly even space-charge eﬀects (quasi-static self-ﬁelds,
either exact including collisions, or in a mean-ﬁeld/Vlasov approximation), while any back-action of the
radiation itself on the particles – either recoil, absorption, or multiple scattering eﬀects – is neglected.
Thus the MPVP provides an approximate alternative to calculation of the ﬁelds via the usual Li´enard-
Weichart potentials or related expressions [5].

For the case of a wiggler or undulator, this implies that any gain due to ponderomotive feedback and
dynamic bunching remains small, so the resulting self-consistent stimulated emission component of the
radiation can be neglected compared to the spontaneous component. The spontaneously-emitted radi-
ation and its measurable properties (power, angular distribution, coherence, etc.) can then in principle
be expressed as deterministic functions of the incoming beam phase space proﬁle (including emittance
eﬀects and any pre-bunching) and the prescribed external ﬁelds, without having to solve the equations
of motion including radiation to obtain completely self-consistent trajectories for the particles.

Although the radiation is treated classically, this terminology involving spontaneous/stimulated emission
is standard in the Free Electron Laser (FEL) literature, which, of course, intentionally borrowed it
from the quantum theory of lasers. The stimulated emission is that which requires (for ponderomotive
bunching) the presence of both the static wiggler ﬁeld and additional radiation, either from an external

seed (FEL ampliﬁer), from emission earlier in the same wiggler (SASE), or from a previous pass through
the wiggler in the presence of a resonant cavity or mirror system (conventional FEL oscillator). The
spontaneous emission is, by deﬁnition, that which occurs in the absence of additional (applied) radiation
ﬁelds, but of course it still requires the static wiggler ﬁeld. Truly “free” electrons do not radiate because
they are not accelerated, and in fact energy-momentum considerations would forbid even a solitary
accelerated electron from radiating if the interaction providing the acceleration did not also allow for a
momentum exchange with some external matter (ultimately the wiggler magnets or other electrons, in
the present case).

Therefore, the description of the wiggler radiation as spontaneous is similar to the atomic case in that
it occurs in the absence of applied radiation (i.e., real photons), but it diﬀers in that electrons bound
in atoms, if somehow excited, can then radiate in the absence of any external ﬁelds. The static (i.e.,
virtual photon) wiggler ﬁeld is therefore playing a role analogous to the nuclear Coulomb ﬁeld. In the
average rest frame of a suﬃciently relativistic beam, the Weizsacker-Williams method of virtual quanta
may be used, since the Lorentz-transformed static wiggler ﬁeld begins to resemble an oncoming beam
of actual photons. Spontaneous radiation occurs when a backwardly-moving, virtual, wiggler photon is
scattered by an electron into a forward-moving, real photon. Stimulated emission occurs in a “three-
body collision” where an electron simultaneously scatters a virtual wiggler photon and real radiation
photon into two real photons, both in the same mode as the incident photon.

Throughout this analysis, we also assume that the charge and current densities are not only prescribed,
but remain localized in space (so that the far-ﬁeld, or wave zone, is deﬁned) and time (so that certain
Fourier transforms exist), in a manner more precisely speciﬁed in the course of our derivations. We
could generalize our treatment to additionally include the eﬀects of uniform background conductive or
dielectric media, but for simplicity we here assume that, apart from its generation by the prescribed mi-
croscopic sources in a bounded spacetime region, the emitted radiation otherwise propagates in vacuum.
Generalizations to allow for non-uniform dielectric tensors, representing wave-guides, lenses, windows,
or other optical devices, might also be possible, but is not pursued here. As we are interested in the
causal (outgoing) radiation produced by the given sources, we neglect any incident source-free ﬁelds or
ﬁelds from other, remote sources. Because we are working in the fully linear spontaneous limit, any such
ﬁelds may be added in superposition at the very end of the calculation.

II. FUNDAMENTAL EQUATIONS

Throughout this paper, we denote in boldface type any real or complex vectors, e.g., a or b, and denote
with carets any real or complex unit vectors such as ˆa which satisfy

where for any N -dimensional complex-valued vectors a, b

ˆa

k

k ≡

(ˆa∗

ˆa)1/2 = 1,

·

N

CN ,

∈

a

b =

·

anbn

n=1
X
is the usual Euclidean dot product (without any implicit complex conjugation) of the components of a
and b in some orthogonal basis. Additional notation will be introduced as needed.

Conforming to widespread, if not universal, convention in beam physics, we work in the (non-covariant)
Coulomb, transverse, or radiation gauge, where the vector potential A = A
= A(x, t) is chosen to be
purely solenoidal (i.e., divergenceless), or everywhere transverse in the sense of Helmholtz’s Theorem:

⊥

∈

R3 denotes the three-dimensional position and t

Here, x
R the time, in any one convenient Lorentz
frame (typically the lab frame, or possibly the average electron beam frame, for wiggler radiation prob-
lems). In Gaussian units, the scalar potential Φ = Φ(x, t) then satisﬁes the instantaneous (i.e., unre-
tarded) Poisson’s equation

∈

∇

·

A(x, t) = 0.

2Φ(x, t) =

4πρ(x, t),

∇

−

3

(1)

(2)

(3)

(4)

given the charge density ρ, while the vector potential the vector potential A satisﬁes the inhomogeneous
wave equation

−
where c is the speed of light in vacuo, and J
density J, and which, using (4) and local charge conservation, can be shown to be given by

is the transverse (solenoidal) component of the full current

∇

−

⊥

2A(x, t)

1
c2

∂2
∂t2 A(x, t) =

4π
c J
⊥

(x, t),

J

(x, t) = J(x, t)

(x, t) = J(x, t)

J
k

−

⊥

1
4π

∇ ∂

∂t Φ(x, t).

−

The physical ﬁelds are, as usual, related to the potentials by

and

E = E

+ E
k

=

⊥

−

1
c

∂
∂t A

−

∇Φ,

B = B

= ∇

A.

⊥

×

Note again that we are describing only the ﬁelds generated by the prescribed sources ρ and J. By
assumption, any externally applied ﬁelds (due ultimately to some additional, remote sources) such as
undulator or bend magnets are not included in the potentials A or φ, but their eﬀects on the trajectories
of the charge particles constituting the actual radiation sources are assumed to be either already included
in J(x, t) and ρ(x, t), or else are neglected.

Without some prior expectation for the typical magnitudes of the dominant radiation frequency ωrad
or characteristic transverse spot size w0 of a radiation beam, it is convenient to re-scale the space-time
coordinates using the remaining spatio-temporal scales, namely those determined by the speed of light c
and the plasma frequency ωp associated with the charge density of the known source. That is, choosing
some reference number density ¯n, ideally characteristic of that of the actual particle bunch, and deﬁning
the corresponding linear plasma frequency

ωp =

1/2

,

4π¯ne2
me (cid:19)

(cid:18)

were me is the electron mass and e the magnitude of the electron charge, we deﬁne normalized (di-
mensionless) variables: a normalized time τ = ωpt, normalized longitudinal position ξ = ωp
c z, normal-
ized transverse coordinates r = rx ˆx + ry ˆy = ωp
c (x ˆx + y ˆy) , normalized three-dimensional coordinates
ζ = ξ ˆz + r, the normalized vector potential a(ζ; τ ) = a(r, ξ; τ ) = e
mc2 A(x, t), normalized scalar po-
tential φ(ζ; τ ) = φ(r, ξ; τ ) = e
e¯n ρ(x, t),
and a normalized current density j(ζ; τ ) = j(r, ξ, τ ) = 1
e¯nc J(x, t), with transverse (solenoidal) part
∂ξ + ∇
ˆz ∂
j
is the scaled, (geometrically)
⊥
transverse gradient operator, and we also deﬁne ∂ = ∂
the full three-dimensional space.

+ ˆy ∂
∂ry
as the scaled gradient operator in

mc2 Φ(x, t), normalized charge density µ(ζ; τ ) = µ(r, ξ; τ ) = 1

∂r = ˆx ∂
∂rx
∂ξ + ∇
∂ζ = ˆz ∂

∂τ φ, where ∇

e¯nc J
⊥

= 1

⊥ ≡

= j

−

(cid:16)

(cid:17)

⊥

⊥

∂

∂

In these variables, Poisson’s equation becomes

∂2φ(ζ; τ ) =

φ(r, ξ; τ ) = µ(r, ξ; τ ),

∂2
∂ξ2 +

2
∇

⊥

(cid:16)

(cid:17)

= ∇

2
∇

∂ is the scaled
where
three-dimensional Laplacian. The solutions to this equation just consist of the well-known unretarded
(i.e., instantaneous) Coulomb ﬁelds,

is the scaled (geometrically) transverse Laplacian, and ∂2 = ∂

⊥ ·

⊥

⊥

·

∇

φ(ζ; τ ) =

1
4π

−

d3ζ′

µ(ζ′, τ )
ζ′k
ζ

Z
which fall oﬀ like the inverse-square distance from the instantaneous positions of the charges, so they
do not contribute to the radiation ﬁelds, and can be neglected for our purposes. (These unretarded
Coulomb ﬁelds are “attached” to the charges and move with them even under acceleration, so do not

−

k

4

(5)

(6)

(7)

(8)

(9)

(10)

(11)

include or in any way constitute radiation.) The scaled wave equation for the vector potential may be
written as

∂2

−

∂2
∂τ 2

a(ζ; τ ) =

∂2
∂ξ2 +

2
⊥ −
∇

∂2
∂τ 2

(cid:19)

a(r, ξ; τ ) =

(r, ξ; τ ),

j
⊥

−

(cid:18)
where a also satisﬁes the gauge condition

(cid:18)

(cid:19)

∂

a(ζ; τ ) =

·

∂ξ + ∇
ˆz ∂

(cid:16)

⊥

·

(cid:17)

a(r, ξ; τ ) = 0.

All of what we conventionally consider radiation is associated with the ﬁelds derived from this vector
potential, although these ﬁelds also include (in the near-ﬁeld region) non-radiative components needed
to cancel the non-retarded features of the Coulomb ﬁelds.

To separately analyze each spectral component of the radiation, we perform Fourier transforms in (scaled)
time, obtaining, for each (scaled) frequency ω, the frequency-domain wave equation

∂2 + ω2

a(r, ξ; ω) =

+ ω2

a(r, ξ; ω) =

∂2
∂ξ2 +

2
∇

⊥

(cid:16)

(cid:17)

(r, ξ; ω),

j
⊥

−

(cid:0)
and frequency-domain gauge condition

(cid:1)

where

and

∂

a(ζ; ω) =

·

∂ξ + ∇
ˆz ∂

(cid:16)

⊥

·

(cid:17)

a(r, ξ; ω) = 0,

a(ζ; ω) = 1
√2π

dτ eiωτ a((ζ; τ )

Z

j
⊥

(ζ; ω) = 1
√2π

dτ eiωτ j

(ζ; τ )

⊥

Z
denote the usual Fourier transforms in scaled time, and are in general complex-valued. Because the
physical, time-domain ﬁelds are real-valued, we necessarily have a(ζ;
ω) = a(ζ; ω)∗, so we can restrict
attention to the analytic signal, or positive frequency (ω > 0), components of the radiation ﬁelds. We
assume that the source charge density ρ and current density j are at least weakly localized in time, to
the extent that all needed Fourier transforms of the sources and the resulting ﬁelds actually exist (at
least as generalized functions).

−

Corresponding to the scaled, frequency-domain vector potential a(ζ; ω), we deﬁne the scaled solenoidal
electric ﬁeld:

and the scaled frequency-domain magnetic ﬁeld

εa = εa(ζ; ω) = iω a(ζ; ω);

ba = ba(ζ; ω) = ∂

a(ζ; ω).

The subscript may be dropped when it is clear from which vector potential these ﬁelds are derived. For
later convenience, we also deﬁne the scaled, frequency-domain Poynting vector

For any orientable surface Σ with unit outward normal ˆn, and positive frequency interval 0 < ω0 ≤
ω1, the quantity

ω

≤

×

×

sa(ζ; ω) = εa(ζ; ω)

ba(ζ; ω)∗.

[a](Σ; ω0, ω1)

dω Re

d2σ ˆn

sa

P

(cid:20)ZΣ

·

(cid:21)

ω1

≡

Zω0

may be taken as the scaled, time-averaged (over an optical period) net electromagnetic power, in the
bandwidth [ω0, ω1], which passes through the surface Σ.

5

(12)

(13)

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

In order that the far-ﬁeld, or radiation zone, even be well-deﬁned, we assume that the physical source
j(ζ; τ ) remains localized in space throughout the relevant emission process, at least in the direction(s)
of observed radiation propagation. In the general, three-dimensional case, this means that j(ζ; ω) is
non-negligible only in some neighborhood of some ﬁxed point ζ0. However, from (6) and (11), it then
(ζ; τ ) will not be strictly localized, but must possess decaying
follows that the solenoidal component j
will not
tails which fall oﬀ like O(1/
⊥
(ζ′; τ )
both be of compact support simultaneously. But the ﬁelds arising from any particular part of j
⊥
2) or
ζ′
will consist of the near-zone and intermediate zone ﬁelds which will fall oﬀ like like O(1/
k
faster, as well as the true radiation ﬁelds which fall oﬀ more slowly, i.e. as O(1/
). Because our
interest resides in the latter, it follows that as long as j(ζ; τ ) is appropriately localized, we can always
choose some suitably large but ﬁnite region beyond which the contributions of the decaying tails of j
⊥
to the radiation ﬁelds may be neglected to any desired level of accuracy, and we can then act as if both
j(ζ; τ ) and j

2) at suﬃciently large distances from ζ0. That is, j and j

(ζ; τ ) have compact support.

ζsk

ζ′

−

−

−

ζ

ζ

ζ

k

k

k

k

⊥

⊥

III. PARAXIAL CASE

By paraxial, we mean that the radiation from the electron bunch in the insertion device can be assumed
to be highly mono-directional, in the sense that the relevant angular scales – namely any possible overall
angular oﬀset between the electron beam and optical axis of the insertion device, the angular spread of
the particle beam, and the characteristic angle of diﬀraction – are assumed to be small, in a sense made
precise below. If we restrict attention to radiation observed within a suﬃciently small detection solid-
angle, then radiation from relativistic particles in certain non-straight devices, i.e., synchrotron radiation
in circular rings, may also be treated within the paraxial approximation. The needed local directionality
is provided by the assumed ﬁnite acceptance entendue of the detector and the characteristic O(1/γ)
angular spread in the radiation resulting from relativistic O(1/γ2) compression eﬀects between emitter
and observer times, where γ is the usual relativistic kinematic factor associated with the mean velocity
of the source charges, which together limit the contributing portion of the electron trajectory to some
small arc.

A. Paraxial Approximation to the Wave Equation

We have already seen how, in the Coulomb gauge, the scalar potential φ does not contribute to the
radiation ﬁelds. The vector potential a contributes to near-ﬁeld (quasi-static), intermediate (induction-
zone), and far-ﬁeld (radiation-zone) eﬀects (and in fact part of it must cancel, in the resulting ﬁelds, the
non-retarded eﬀects of the scalar potential), but considerable simpliﬁcation is possible if we eﬀectively
restrict our attention to those portions of the ﬁelds which, if allowed to evolve freely after propagating
beyond the ﬁnite support of the sources, actually constitute radiation, and further assume that the
radiation of interest propagates nearly along the + ˆz axis, with a small characteristic angle of diﬀraction
1 and any overall angular oﬀset δθ0 . O(θd). Then we can make the so-called paraxial approxima-
θD ≪
tion to the wave-equation for the vector potential a, which in eﬀect consists of an asymptotic expansion
in δθ0.

First, for any ω > 0 of interest, we express the vector potential in enveloped form:

a(r, ξ; ω) = ψ(r, ξ; ω)eikξ,

where the (scaled), axial carrier wavenumber k = k(ω) = +ω satisﬁes the vacuum dispersion relation for
a local plane wave traveling along + ˆz. Similarly, we deﬁne an enveloped source term such that:

Using the chain rule, the wave equation then becomes

(r, ξ; ω) = 2k f (r, ξ; ω)eikξ.

j
⊥

∂2
∂ξ2 + 2ik

(cid:18)

∂
∂ξ

+

2
∇
⊥(cid:19)

ψ(r, ξ; ω) + 2kf (r, ξ; ω) = 0,

6

(22)

(23)

(24)

7

(25a)

(25b)

(26)

(27)

(28)

while the radiation envelope ψ and source envelope f both satisfy envelope-transversality conditions:

∂ξ + ik ˆz + ∇
ˆz ∂
∂ξ + ik ˆz + ∇
ˆz ∂

(cid:16)

(cid:16)

·

·

⊥

⊥

(cid:17)

(cid:17)

ψ(r, ξ; ω) = 0,

f (r, ξ; ω) = 0.

|

⊥

−

r
|

r
|

, as

| →

≤
⊥

| → ∞

We assume that the charge density ρ and full current density j remain weakly localized transversely, in
the sense that they are square-integrable in any transverse plane. Actually we will impose the slightly
f (r; ξ; ω)
stronger constraint that
. We also assume that
0 more rapidly than 1/
|
the physical currents are strongly localized longitudinally, in the sense that they are negligible outside
ξ′1 along the propagation axis, implying in general that the solenoidal
ξ
some ﬁnite interval ξ′0 ≤
part of the current density j
will actually have a component with non-compact support, corresponding
∂ξ + ∇
ˆz ∂
∂
to the
∂τ φ term. However, this contribution to the sources falls oﬀ no slower than
the inverse-square of the distance from the source charges, so with arbitrarily small relative error in
the radiation ﬁelds, which are linear in the sources and fall oﬀ with the inverse distance from them,
we can safely truncate the source envelope f (r; ξ; ω) outside of some suﬃciently large but ﬁnite range
ξ′1 < ξ1. (Again, the neglected contributions are strictly necessary to cancel the unretarded
ξ0 < ξ′0 ≤
part of the Coulomb ﬁelds to ensure that the full ﬁelds remain compatible with relativistic causality, but
we are conﬁning attention only to actual radiation.) Most of the ﬁnal results will not actually depend on
the size of this interval, so if necessary we may safely take
at the end of the calculation,
provided the charge and current densities continue to fall oﬀ suﬃciently rapidly to ensure convergence
of the relevant integrals, and we can somehow distinguish the far-ﬁelds from the local quasi-static ﬁelds
when the latter may then extend to inﬁnity.

ξ0| → ∞

ξ1 −
|

≤

(cid:16)

(cid:17)

ξ

The (scaled) waist of the radiation beam, or characteristic transverse spot size w0, may be deﬁned in
terms of the minimal, power-weighted, root mean-square radius:

The corresponding characteristic diﬀraction angle θD may then be taken as

R

1

2 w2

0 = inf

ξ R

d2r

r
|
d2r

|

2
|

2
ψ(r, ξ; ω)
|
2
ψ(r, ξ; ω)
|
|

.

θD =

1
2π

λ
w0

=

1
kw0

,

ξR = 1

2 kw2
0.

and ﬁnally the (scaled) Rayleigh range ξR, or longitudinal length-scale for appreciable change in the
transverse spot size due to diﬀraction, becomes:

We now treat θD as a small parameter. Speciﬁcally, if ψj is any (non-zero) component of the radiation
envelope ψ, then we may consistently assume that:
ψj | ∼
|
0 ). If the spot size is suﬃciently large compared to the carrier wavelength λ = 2π/k, such that
D), we may drop the higher-order longitudinal derivative in

1
1, then with a relative error of O(θ2

O(w−
θD ≪
equation (24), obtaining the forced paraxial wave equation

R ), while

ψj| ∼
|

∂
∂ξ ψj

ψj k

O(ξ−

∇

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

k

/

/

⊥

1

i ∂
∂ξ + 1

2
2k ∇

⊥

(cid:16)

(cid:17)

ψ(r, ξ; ω) + f (r, ξ; ω) = 0.

(29)

Note that we have not yet directly imposed the same ordering assumptions on the spatial variations in the
envelope f (r; ξ; ω), but as the latter is the actual source for the radiation, it is clear that the transverse
scale-lengths of ψ must be consistent with those of f (r; ξ; ω) under diﬀractive propagation (and therefore
typically comparable in the vicinity of the sources.) However, as long as we consider suﬃciently small
wavelengths, the scale-length for longitudinal variations in f (r; ξ; ω) need not be comparable to ξR
in order for the paraxial approximation to remain accurate for the ﬁelds of interest, i.e., for radiation
observed in the far-ﬁeld region beyond the sources. Speciﬁcally, we may imagine the paraxial ﬁelds as the
superposition of those ﬁelds from each inﬁnitesimal transverse slice of current, evolved forward according

to the free-space paraxial propagation, so that each component will satisfy the paraxial conditions
everywhere except for a discontinuous jump at its source slice, which can be replaced with an equivalent
boundary condition applied to the homogeneous (source-free) equation. The paraxial solution is expected
to remain accurate for any ξ > ξ1 if the paraxial conditions both hold for the calculated ﬁelds in the
region ξ > ξ1 and also hold for ξ < ξ1, when the ﬁelds are extrapolated backwards via the free-space
(homogeneous) paraxial propagation.

This paraxial wave equation is valid when the propagation direction is suﬃciently close to the ﬁducial
(+ ˆz) axis, and the scale-length for transverse variations in the radiation beam are large compared to
the carrier wavelength and small compared to the length-scale for longitudinal envelope variation (i.e.,
residual variation after the faster carrier oscillations have been removed.) Actually, although we have
1, numerical solutions to the full wave equation typically reveal that the
formally assumed that θD ≪
paraxial approximation actually remains surprisingly accurate for focused radiation beams provided only
θD . O(1). For still smaller spot sizes (tighter focus), the paraxial equation predicts a coherence volume
Vcoh < O(λ3) for a single oscillatory mode, which would be in conﬂict with the diﬀraction limit dictated
by the “Heisenberg” inequality constraining conjugate Fourier transform pairs.

2)1/2

2+
From our above ordering assumptions, and the transversality condition (25a), it follows that
O(θD), so the axial component ψz can in certain circumstances be neglected outright, but
ψy|
|
we will retain it here in order to explicitly satisfy the gauge condition. However, whenever convenient,
the gauge constraint for fully paraxial ﬁelds may be simpliﬁed, within the same O(θ2
D) relative accuracy
as the paraxial wave equation itself, by dropping the longitudinal derivative:

ψx|
/(
|

ψz|
|

∼

⊥
So if the (geometrically) transverse components ψ
ψz(r, ξ; ω) may be taken as

·

= ψ

ˆz ˆz

−

·

⊥

(ik ˆz + ∇

)

ψ(r, ξ; ω)

0.

≈
ψ are speciﬁed, then in this approximation

ψ(r, ξ; ω) = i
k

∇

ˆz

·

ψ

(r, ξ; ω),

⊥ ·

⊥

or conversely, if ψz(r, ξ; ω) is given, then a ψ
can always be chosen to satisfy (31) and ensure paraxial
Helmholtz-transversality. The solenoidal source envelope f must in general satisfy the complete envelope
constraint (25b) including the longitudinal derivative, because its ξ-dependence may be arbitrary.

⊥

8

(30)

(31)

B. Hilbert Space Formalism

Mathematically, the homogeneous (i.e., free-space, or source-free) part of (29) is exactly analogous to
the Schrodinger equation, in the position representation, for a quantum mechanical, spin-one particle
of mass M, moving non-relativistically in a potential-free, two-dimensional, Euclidean space, where
the longitudinal position ξ plays the role of the “temporal” evolution variable, r serves as the spatial
coordinates, and polarization is analogous to spin angular momentum, all in units where ~ = 1 and
M = k = ω.

In order to leverage the analogies to ordinary quantum mechanics, we introduce a Hilbert space, inner
product, state vectors, operators, etc., using a Dirac-like notation. The full Hilbert space may be
considered a tensor product of the Hilbert spaces for the (geometrically) transverse-spatial and the spin
(polarization) degrees of freedom. (Our notation is similar, but not identical, to that in [32, 33]). We
with the complex vector ﬁeld ψ(r) deﬁned on the (geometrically)
associate the ket (really a spinor)
transverse spatial plane, i.e., as a mapping ψ : R2
C3 (possibly also parameterized by additional
continuous variables such as ξ and ω and by discrete mode indices, all suppressed for the moment). The
is associated with the dual, or conjugate transpose, vector ﬁeld, ψ(r)†, and a
corresponding bra
combined L2/Euclidean inner product is deﬁned by

ψ
|

→

ψ

h

i

|

ψ1|
h

ψ2i

=

Z

d2r ψ1(r)∗

ψ2(r).

·

(32)

We deﬁne a number of Hermitian operators acting on the spatial degrees of freedom by their action on
C2 in the complex
these position-representation wave vector ﬁelds ψ. Given any ﬁxed unit vectors ˆe, ˆe′

∈

linear span of ˆx and ˆy, the transverse position operators just act via multiplication by the corresponding
transverse spatial coordinates

while the conjugate “momentum” operators act by diﬀerentiation:

so these operators then satisfy the usual canonical commutation relations

ˆe

Qψ(r)

(ˆe

r)ψ(r),

·

≡

ˆe′

P ψ(r)

·

1
i (ˆe′

∇

⊥

≡

) ψ(r),

·

·

[ˆe

Q , ˆe′

P ] = i (ˆe

ˆe′) Ir,

·

·

·

H

≡

1
2M P

·

P =

2
1
2k ∇

⊥

,

−

where Ir is the identity operator on transverse position-state space. We stress that these operators act
P = 0. The “kinetic energy” or “free-particle
only on the transverse spatial coordinates, so that ˆz
Hamiltonian” operator is then deﬁned as:

Q = ˆz

·

·

which is just the inﬁnitesimal generator of free-space, diﬀractive propagation along ξ. With somewhat
more mathematical care about operator domains than is justiﬁed for this presentation, these Hermitian
operators may be extended to fully self-adjoint operators without diﬃculty.

In order to include the polarization, we also deﬁne the complex helicity basis in C3 :

ˆǫs =

s 1
√2

( ˆx

−

−

is ˆy) + (1

s2) ˆz =

−

1

2 s2(1 + s)ˆe

+ 1

2 s2(1

−

−

−

s)ˆe+ + (1

s2) ˆz,

−

for s =

1, 0, +1, satisfying

−

where δs s′ is the usual Kronecker delta symbol and ˆe
, and then can deﬁne various
Hermitian “spin” operators by their action on the polarization components of the ﬁelds ψ. In particular,
we deﬁne a vector of mutually orthogonal polarization projection operators

i ˆy) = ˆe∗
∓

± ≡

( ˆx

±

1
√2

ˆǫs′ = δs s′ ,

ˆǫ∗s ·

Π =

ˆǫsΠs,

s=

1,0,+1
X
−

ΠsΨ = ˆǫs (ˆǫ∗s ·

Ψ) ,

ΠsΠs′ = Πs′ Πs = δs s′ Πs,

Πs = I3,

s=

1,0,+1
X
−

I3 =

ˆǫs ˆǫ†s

Sz = Π1 −

Π

1,

−

Szψ = ˆe

ˆe∗

−

− ·

ψ

ˆe+ ˆe∗+ ·

−

ψ.

where

such that

and

where

so that

1,0,+1
X
−
is the identity operator on the spin degrees of freedom. We also deﬁne the helicity, or circular polarization
operator by

s=

9

(33)

(34)

(35)

(36)

(37)

(38)

(39)

(40)

(41)

(42)

(43)

(44)

(45)

and

and

and

and

which satisfy

S2
z = I3 −
For an enlightening discussion of the orbital and spin components of angular momentum in electromag-
netic ﬁelds, see [34].

(46)

Π0.

Clearly, all of these polarization operators commute with the spatial operators, so we may deﬁne gen-
R2 and
eralized (i.e., non-normalizable) simultaneous eigenkets of position and spin
s

for any r

r; s
|

1, 0, 1

∈

i

:

∈ {−

}

We similarly deﬁne generalized simultaneous eigenkets of spin and “momentum” (transverse wavevector)
by taking the Fourier transforms of these position kets:

Q

r; s
|

i

= r

r; s
|

i

,

eir′

·

P

r; s
|

i

=

r
|

−

r′; s

,

i

Sz |

r; s

= s

i

r; s
|

i

.

p; s
|

i

= 1
2π

d2r eip

·

r

r; s
|

i

,

Z

P

p; s
|

i

= p

p; s
|

i

,

Sz |

p; s

= s

i

p; s
|

i

.

r; s
h

r′; s′
|

i

= δs s′ δ(2)(r

r′),

p; s

p′; s′
|

i

h

= δs s′ δ(2)(p

p′),

−

−

These generalized eigenkets satisfy the orthogonality relations

and the completeness relation

d2r

r; s
|

ih

r; s

=

|

d2p

p; s
|

ih

p; s

= I,

|

s Z

X

s Z

X

consisting of all

where δ(2)(r) is the two-dimensional Dirac delta function, and I = I3 ⊗
Ir is the identity operator on the
, implying
full Hilbert space
that the corresponding paraxial radiation ﬁelds ψ(r) are of ﬁnite power (but not of ﬁnite energy). The
allowed radiation envelopes actually reside in the Hilbert sub-space
consisting of vector ﬁelds
which also satisfy the transverse envelope gauge constraint when evolved in ξ according to free-space
paraxial evolution.

which are normalizable, i.e., for which

H⊥ ⊂ H

ψ
h

ψ
|

ψ
|

∞

H

<

i

i

Deﬁning the coupled spin-momentum operator

for a real parameter δ, and the constant reference ket

such that

T (δ) =

k

iδ

Π0 + P

∂
∂ξ

−

(cid:18)

Π

·

(cid:19)
ψ0i ∈ H
|
1 + ˆǫ0 + ˆǫ+1) ,

ψ0(r) = 1
√3

(ˆǫ

−

10

(47)

(48)

(49)

(50)

(51)

(52)

(53)

(54)

(55)

(56)

(57)

11

(58a)
(58b)

(60)

(61)

(62)

(63)

(64)

(65)

the full envelope-transversality constraints (25) on the radiation and source may be written in our
quantum notation as:

while the approximate paraxial gauge constraint (30) becomes:

ψ0 |
h
ψ0 |
h

T (δ = 1)
|
T (δ = 1)
|

ψ(ξ; ω)
i
f (ξ; ω)
i

= 0,
= 0,

T (δ = 0)
|
Again, within the paraxial approximation, either of these constraints may be used interchangeably for
the radiation, but the source must satisfy the full transversality constraint because its ξ dependence is
arbitrary.

ψ(ξ; ω)
i

ψ0 |

= 0,

(59)

h

It is straightforward to see how the full envelope gauge constraint (58a) (including the longitudinal
derivative) will be automatically maintained by the evolution, and how the approximate paraxial con-
straint (59) (neglecting the longitudinal derivative) will be preserved by free-space propagation or by
propagation in the region of a fully paraxial source. Assuming that
satisﬁes the paraxial wave
equation, with an initial condition satisfying

ψ(ξ; ω)
i
|

(our speciﬁc choice of

= 0 for all ξ < ξ0 clearly works), and that the source

ψ(ξ; ω)
i
|

f (ξ; ω)
i
|

satisﬁes

lim
→−∞

ξ

ψ0 |
h

T (δ)
|

ψ(ξ; ω)
i

= 0,

ψ0 |
h

T (δ)
|

f (ξ; ω)
i

= 0

[T (δ), H(ω)] =

T (δ), ∂
∂ξ

= 0,

h

i

∂
∂ξ H(ω) = 0,

H(ω)

ψ0i
|

= 0,

for all ξ, and noting that

and

then:

∂
∂ξ h

ψ0 |

T (δ)
|

ψ(ξ; ω)
i

=

=
=

D
−
−

ψ(ξ; ω)

ψ0

i
i

T (δ) ∂
∂ξ
(cid:12)
ψ0 |
(cid:12)
h
(cid:12)
ψ0 |
h
ψ0 |
T (δ)
|

(cid:12)
T (δ)H(ω)
(cid:12)
|
(cid:12)
H(ω)T (δ)
|
ψ(ξ; ω)
i

E
ψ(ξ; ω)
i
ψ(ξ; ω)
i

ψ0 |
+ i
h
+ 0 = 0.

T (δ)
|

f (ξ; ω)
i

Using the initial condition, we then have
= 0 for all ξ. This shows that the full (δ = 1)
envelope transversality constraint (58a (including the longitudinal derivative) on the ﬁelds is preserved
everywhere, if it holds initially for the ﬁelds and holds everywhere for the sources. The approximate
(i.e., δ = 0) paraxial gauge constraint (59) is preserved by the evolution in regions free of sources and
wherever the solenoidal source also satisﬁes this same, stronger condition.

h

C. Green Function Solution

In this quantum-like notation, the paraxial wave equation may be written as

i ∂
∂ξ |

ψ(ξ; ω)
i

= H

ψ(ξ; ω)
|

i − |

f (ξ; ω)
i

(66)

Given some “initial” state
f (ξ; ω)
|
i
unitary evolution operator as

, the solution to the homogeneous part of the equation (i.e., for
= 0) representing free space propagation of the radiation ﬁelds, may be written in terms of the

ψ(ξ′; ω)
i
|

ψ(ξ′; ω)
i
|
where U (ξ, ξ′; k) satisﬁes the operator-valued Schrodinger equation

ψ(ξ; ω)
i
|

= U (ξ, ξ′; ω)

,

with initial condition

i ∂
∂ξ U (ξ, ξ′; ω) = HU (ξ, ξ′; ω)

U (ξ′, ξ′; ω) = I,

and possesses the group composition properties

U (ξ, ξ′; ω)−

1 = U (ξ, ξ′; ω)† = U (ξ′, ξ; ω),

Here H = H(ω) (with ω = k) is the Hamiltonian, or diﬀraction operator, deﬁned above. Because H is
ξ-independent, we can immediately integrate (68) to ﬁnd

The solution to the full inhomogeneous wave equation (66) may be written in terms of the propagator,
or causal Green function operator G(ξ, ξ′; ω) satisfying

and

and

It can easily be veriﬁed that this operator is given by

Here Θ(ξ) is the usual Heaviside step function, and δ(ξ) = d
dξ Θ(ξ) is the one-dimensional Dirac delta
function. Assuming no initial (incoming or outgoing) radiation, the formal solution to the inhomogeneous
equation (66) (i.e., with the source term) is then

U (ξ, ξ′′; ω)U (ξ′′, ξ′; ω) = U (ξ, ξ′; ω).

U (ξ, ξ′; ω) = e−

i(ξ

ξ′)H(ω).

−

i ∂
∂ξ −

(cid:16)

(cid:17)

H

G(ξ, ξ′; ω) = δ(ξ

ξ′)

−

G(ξ, ξ′; ω) = 0 for ξ < ξ′.

G(ξ, ξ′; ω) =

iΘ(ξ

ξ′)U (ξ, ξ′; ω).

−

−

ψ(ξ; ω)
i
|

=

dξ′ G(ξ, ξ′; ω)

f (ξ′; ω)
i
|

= i

dξ′ U (ξ, ξ′; ω)

f (ξ′; ω)
i
|

,

∞

−
Z
−∞
min(ξ,ξ1)

Zξ0

12

(67)

(68)

(69)

(70)

(71)

(72)

(73)

(74)

(75)

(76)

where we have used the assumption that the support of f (ξ; r; ω) is conﬁned to ξ0 < ξ < ξ1. For any
ξ < ξ0, we then have
ξ1, this
just reduces to free-space propagation:
. In between we must actually
solve the full expression (76).

= 0 consistent with our assumed initial condition, while for all ξ

ψ(ξ1; ω)
i
|

ψ(ξ; ω)
i
|

ψ(ξ; ω)
i
|

= U (ξ, ξ1; ω)

≥

D. Energetics

In our dimensionless variables, recall that the normalized, solenoidal electric ﬁeld is given by

−
in the (scaled) time domain, or equivalently

⊥

εa

(r; ξ; τ ) =

∂
∂τ a(r; ξ; τ ) =

∂

∂τ ψ(r; ξ; τ )eikξ

−

(r; ξ; ω) = iω a(r; ξ; ω) = iω ψ(r; ξ; ω)eikξ

εa

⊥

the inner product
frequency domain. Within the paraxial approximation,
in the (scaled)
ψ(ξ; ω)
ψ(ξ; ω)
is then proportional to the (time-averaged) power spectral density for radiation of
h
i
|
frequency ω passing through the transverse plane at the longitudinal position ξ. In fact, in scaled units
we may deﬁne the (normalized) power spectral density as

∂
∂ω

P

EM[a](ξ; ω) = ω2

ψ(ξ; ω)
ψ(ξ; ω)
i
|

h

= ω2

d2r

2
ψ(r; ξ; ω)
|
|

= ω2

d2r

2 =
a(r; ξ; ω)
|
|

d2r

ε
|

⊥

2 .
(r; ξ; ω)
|

Z

Z

Z

Strictly speaking, this yields the time-averaged Poynting ﬂux only to O(θD) at any ﬁnite distance from
the sources, but it is exact as ξ
and we consider only the truly radiative transport of energy to
spatial inﬁnity. The unitary (inner-product preserving) nature of the paraxial evolution in vacuum then
corresponds to energy conservation for paraxial ﬁelds, where the (time-averaged) power crossing any
transverse plane in any frequency bandwidth, remains constant (with respect to propagation distance
ξ) during free-space evolution. Note, however, that while it is particularly convenient to formulate
paraxial propagation in terms of the transformation of the ﬁelds in successive transverse planes, the
actual wavefronts (level surfaces of phase) of a general paraxial beam are not planar except at the focus.

→ ∞

From the actual solution
the right of) the sources, we can construct the extrapolated free-space ﬁeld

in any conveniently-chosen transverse plane ξ2 ≥

ψ(ξ2; ω)
i
|

ξ1 beyond (i.e., to

χ(ξ; ω)
i
|

= U (ξ, ξ2; ω)

ψ(ξ2; ω)
i
|

= i

dξ′ U (ξ, ξ′; ω)

f (ξ′; ω)
i
|

,

(80)

ξ1

Zξ0

and

χ(ξ; ω)
i
|

satisﬁes the homogeneous (source-free) Schrodinger equation with no incoming radiation as ξ

which represents the post-source paraxial radiation envelope extrapolated throughout all space via free-
space propagation, including in the backward or “upwind” direction into the region where sources are
actually present. Thus
coincide for all ξ > ξ1, but not in general for ξ < ξ1, where
χ(ξ; ω)
→
|
i
satisﬁes the inhomogeneous equation everywhere, so that all outgoing radiation
, whereas
−∞
. For any particular ξ, these extrapolated ﬁelds
at ξ
→ −∞
are those ﬁelds which would have been present if the ﬁelds actually observed beyond the sources at some
ξ2 > ξ1 were instead produced by some eﬀective source g(r; ξ; ¯ξ; ω) located in some suﬃciently remote
¯ξ, instead of by the actual sources within ξ0 < ξ < ξ1 :
region ξ0 −

is matched by incoming radiation at ξ

¯ξ < ξ < ξ1 −

ψ(ξ; ω)
i
|

ψ(ξ; ω)
i
|

→ ∞

χ(ξ; ω)
i
|

= i

dξ′ U (ξ, ξ′; ω)

g(ξ′; ¯ξ; ω)

,

(cid:12)
(cid:12)

(cid:11)

¯ξ

ξ1−

Zξ0−

¯ξ

where the eﬀective source is determined from the actual source simply by longitudinal translation and
compensation for diﬀraction:

g(ξ′; ¯ξ; ω)

= U (ξ′, ξ + ¯ξ)

f (ξ′ + ¯ξ; ω)

,

and ¯ξ = ¯ξ(ξ; ξ1)

(cid:12)
(cid:12)

≥

0 may any positive constant satisfying
¯ξ > ξ1 −

ξ.

(cid:11)

(cid:12)
(cid:12)

(cid:11)

13

(77)

(78)

(79)

(81)

(82)

(83)

Choosing any ¯ξ > ξ1 −
¯ξ
→

∞

+

ξ0, the expression (81) is then valid for any ξ

ξ0, or we may actually take

if convenient, moving the eﬀective sources to an abitrarily remote “upwind” location.

≥

Using the Green function solution (76), and taking advantage of the assumed ﬁnite support of f , we
ﬁnd that for any ξ > ξ1,

ψ(ξ; ω)
ψ(ξ; ω)
i
|
h

= i

dξ′

ψ(ξ; ω)

h

U (ξ, ξ′; ω)
|
|

f (ξ′; ω)
i

min(ξ,ξ1)

Zξ0

∞

Z
−∞

= i

dξ′

f (ξ′; ω)
χ(ξ′; ω)
i
|
h

= i

dξ′
Z

Z

d2r χ(r; ξ′; ω)∗

f (r; ξ′; ω),

·

which is just a three-dimensional inner product, or overlap integral, between the source envelope
f (r; ξ′; ω) and the free-space radiation envelope χ(r; ξ′; ω) which has been extrapolated via free-space
propagation backwards into the region where sources are present.

While solenoidal and irrotational vector ﬁelds are not in general locally orthogonal in the geometric
sense, they are Hilbert-space orthogonal when their Euclidean inner product is integrated over all space.
ψ(ξ; ω)
Because
satisfy the transverse gauge constraint, this overlap integral may
i
|
be simpliﬁed to

χ(ξ; ω)
i
|

and hence

ψ(ξ; ω)
ψ(ξ; ω)
i
|

h

= i

dξ′
Z

Z

d2r χ(r; ξ′; ω)∗

f (r; ξ′; ω)

·

=

=

=

=

1
2ω2

1
2ω2

1
2ω2

1
2ω2

−

−

−

−

Z

Z

Z

Z

dξ′
Z
dξ′
Z
dξ′
Z
dξ′

d2r

iω χeikξ

∗

2k f eikξ

(cid:2)
d2r εχ

(cid:3)
(cid:2)
(r; ξ′; ω)∗

(cid:3)
(r; ξ′; ω)

j
⊥

d2r εχ

(r; ξ′; ω)∗

j(r; ξ′; ω)

⊥

⊥

·

·

·

εχ
h

j(ξ′; ω)
(ξ′; ω)
i
|

,

⊥

⊥

where εχ
(r; ξ′; ω) is the scaled, solenoidal electric ﬁeld associated with the extrapolated radiation
envelope χ. In order to evaluate the power, we therefore need never explicitly decompose the current
density into its solenoidal and irrotational components, nor worry about the precise cutoﬀ beyond which
the solenoidal component may be neglected.

As one would expect from energy conservation considerations, this overlap integral may be interpreted
in terms of the rate of energy transfer between the charges constituting the sources and the ﬁelds. We
may deﬁne the scaled power spectral density associated with the rate of (time-averaged) mechanical
work done by scaled electric ﬁelds ε(r; ξ; ω) on the charges associated with the scaled current density
j(r; ξ′; ω) as

P

∂
∂ω

mech[ε; j](ω) = Re

dξ′

j(ξ′; ω)
ε(ξ′; ω)
i
|

h

Z

= Re

dξ′
Z

Z
j(ξ′; ω)
(ξ′; ω)
i
|

d2r ε(r; ξ′; ω)∗

j(r; ξ′; ω).

·

k

ψ

dξ′

From (85), we see that

=
2 is necessarily real and non-negative. Physically, this reﬂects the fact that the back-extrapolated
k
ﬁelds, if actually present, would lead to no reactive energy transfer to local ﬁelds associated with re-
arrangement of the source charges, and mechanical energy would be transferred monodirectionally from
the charges to the radiation ﬁelds. Therefore (85) is equivalent to:

must be purely real and non-positive, because

εχ
h

ψ
h

ψ
|

R

⊥

i

P

∂
∂ω

EM[a](ξ; ω) =

1
2

∂
∂ω

P

−

mech[εχ

; j](ω)

⊥

14

(84)

(85)

(86)

(87)

That is, the average power seen in the far ﬁeld is exactly one-half of that which would be delivered by the
sources to the extrapolated homogeneous ﬁelds if these ﬁelds were those actually present in the region
of the sources.

The presence of the extra factor of 1
2 is intuitively plausible. The actual paraxial ﬁelds from each
transverse current slice consist only of the forward half of the corresponding extrapolated ﬁelds from this
slice, and hence the former ﬁelds could interact only with “downstream” current slices while propagating
in the forward (+ ˆz) direction, while the extrapolated ﬁelds from any current slice impinge on all other
current slices, both upstream and downstream. If we adopt the symmetric convention Θ(0) = 1
2 for
the Heaviside step function (which is anyway the natural choice when Fourier transforms are involved),
each current slice also appears to interact only with one-half of its own ﬁeld. Assuming a reciprocity
arising from Newton’s Third Law (magnetic forces can violate this law, but do no mechanical work, and
radiation reaction forces can violate the third law as well, but are ignored here), we then anticipate an
over-counting of the work by exactly a factor of 2 when we use the extrapolated ﬁelds and integrate over
all current slices. This is a dynamical, electromagnetic analog of the well known electrostatic result that
the potential energy associated with a given charge distribution ρ in a given external potential Φext is
d3x ρΦext, while the self-energy (potential energy of formation) of a charge distribution
given by U =
resulting in a potential Φ is U = 1
2

d3x ρΦ.

R

Below, we will provide an elementary proof of this result in the general case, but it is informative to verify
it with an explicit calculation for paraxial ﬁelds. By using the Green function solution and inserting a
resolution of the identity, we have, for any ξ > ξ1,

R

∂
∂ω

P

EM[a](ξ; ω) = ω2

ψ(ξ; ω)
ψ(ξ; ω)
i
|

h

= iω2

dξ′

f (ξ′; ω)
χ(ξ′; ω)
i
|
h

ξ1

Zξ0

which explicitly demonstrates its reality and non-negativity. Using the same sort of manipulations, we
then have

= ω2

ξ1

ξ1

dξ′
Zξ0

Zξ0

dξ′′

f (ξ′′; ω)

U (ξ′′, ξ′; ω)
|
|

f (ξ′; ω)
i

= ω2

d2r

dξ′

r; s
h

U (ξ0, ξ′; ω)
|
|

f (ξ′; ω)

= ω2

d2r

dξ′ g(r; ξ0; ξ′

2

i (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

−

ξ0; ω)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

h

ξ1

Zξ0
ξ1

Zξ0

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

s Z

X

s Z

X

ξ1

"
Zξ0

P

∂
∂ω

mech[εψ

; j](ω) = Re

⊥

dξ′

εψ
h

j(ξ′; ω)
(ξ′; ω)
|

⊥

i#

= Re

2iωk

dξ′

"−

f (ξ′; ω)
ψ(ξ′; ω)
|
h

i#

ξ1

Zξ0
ξ1

ξ′

=

2ω2 Re

−

dξ′
Zξ0

"
Zξ0

dξ′′

f (ξ′′; ω)
h

U (ξ′′, ξ′; ω)
|
|

f (ξ′; ω)

i#

=

2ω2

−

s Z
X

d2r Re

dξ′ g(r; ξ0; ξ′

ξ0; ω)

dξ′′ g(r; ξ0; ξ′′

ξ0; ω)∗

−

#

ξ1

"
Zξ0

ξ′

Zξ0

−

15

(88)

(89)

16

(90)

But using integration by parts, this simpliﬁes to

P

∂
∂ω

mech[εψ

; j](ω)

⊥

ξ1

d2r

dξ′ g(r; ξ0; ξ′

= (

2ω2)
"

1
2

−

(cid:12)
s Z
Zξ0
(cid:12)
X
(cid:12)
(cid:12)
ψ(ξ; ω)
ψ(ξ; ω)
(cid:12)
i
|
h

=

ω2

−

∂
∂ω

Pa(ξ; ω)

=

−

2

.

#

−

ξ0; ω)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

So, indeed it is the case that:

P

∂
∂ω

EM[a](ξ; ω) =

P

1
2

∂
∂ω

−

mech[εχ

; j](ω) =

mech[εa

; j](ω),

(91)

⊥
consistent with expectations of energy conservation. Note that while the extrapolated source-free solution
χ coincides ,by construction, with a in the downstream region ξ > ξ1, and so exhibits identical out-
ﬂowing power, in order to actually satisfy the source-free equation, it must have an equal magnitude of
power ﬂowing into the interaction region through any upstream plane at ξ < ξ0, which accounts for the
extra factor of two.

⊥

P

∂
∂ω

−

E. Basis-Set Approximation

As we have seen, equation (76) in principle gives the exact solution to the paraxial wave equation with
prescribed sources, without any further approximations, and is compatible with energy conservation for
paraxial electromagnetic ﬁelds. For given sources, the ﬁeld at an arbitrary longitudinal plane ξ can
be determined via a convolution integral over the longitudinal source position ξ′ and a two-dimensional
integral over either the transverse position-dependence (real space) or transverse wavevector-dependence
(reciprocal space) of the solenoidal component of the current. In position space, we have

ψ(ξ; ω)
i
|

=

d2r

d2r′

s Z

X

Z

Zξ0

min(ξ,ξ1)

2

r−r′
k
|
|
2(ξ−ξ′)

dξ′

k ei
2πi(ξ

ξ′) h

−

r′; s

f (ξ′; ω)
|

i |

r; s

,

i

(92)

where we have used the well-known result for the two-dimensional, position-space, free-particle propa-
gator in quantum mechanics. In momentum space representation, the propagator is diagonal, and we
have

min(ξ,ξ1)

d2p

dξ′ e−

i(ξ

−

ξ′) |p|2

2k

ψ(ξ; ω)
i
|

= i

s Z

X

Zξ0

p; s
h

f (ξ′; ω)
|

i |

p; s

,

i

(93)

p; s
h

f (ξ′; ω)
i
|

is just the Fourier transform (with respect to the scaled transverse wavevector) of the
where
solenoidal current density slice at longitudinal position ξ′. Now, using either either of these approaches,
we require something like 10 integrations to determine a given frequency component of the ﬁeld at a given
spatial location, starting from the full current density as a function of space and time coordinates. In
practice, we often only know the source probabilistically, so we will typically have to perform additional
averages over the particle distribution function, involving up to 6 more integrations over the full particle
phase space.

A complementary approach is to decompose the paraxial radiation ﬁelds into a complete, orthogonal
set of modes. Because we are actually only interested in the radiation observed beyond the region of
interaction with the localized sources, these modes are naturally chosen to satisfy the homogeneous
(source-free) paraxial wave equation for all longitudinal positions ξ > ξ1, but we may then also choose
these modes to be extrapolated free-space solutions everywhere, including within the support of the
sources. That is, we consider a countable set of explicitly ξ-dependent, solenoidal, envelope modes
un(ξ; ω)
, where n denotes some set of integral transverse-spatial and polarization modal indices,
|
such that each mode envelope satisﬁes

i ∈ H⊥

i ∂
∂ξ |

un(ξ; ω)
i

= H(ω)

un(ξ; ω)
i
|

,

(94)

un(ξ′; ω)
un(ξ; ω)
i
|
i
|
together with the gauge constraint (58a), for all longitudinal positions
propagation is unitary, these modes may be chosen to be orthonormal in each transverse plane, i.e.,

= U (ξ, ξ′; ω)

< ξ <

. Because free-space

(95)

−∞

∞

or equivalently

or equivalently

and complete in each transverse plane, in the sense that

un′ (ξ; ω)
un(ξ; ω)
i
|
h

= δn n′

span

un(ξ; ω)
i
|

∼=

.

H⊥

(cid:2)

(cid:3)

un(ξ; ω)
|

un(ξ; ω)
|

ih

= I

,

⊥

n
X

⊥

H

H⊥

into

is the identity operator restricted to the solenoidal sub-space

, or equivalently the Hermi-
where I
tian projection from
. Familiar and convenient choices are the usual free-space Gauss-Hermite
modes or Gauss-Laguerre modes in paraxial optics. The spatial proﬁles of these modes may be charac-
terized by specifying the longitudinal location of the focal plane and the eigenvalues of certain Hermitian
operators of which they are eigenfunctions in that plane. For example, in the focal plane, the components
of the Gauss-Hermite modes are simultaneous number states of two harmonic oscillator Hamiltonians
(one for each transverse Cartesian coordinate), while the Gauss-Laguerre modes are simultaneous eigen-
states of a radial harmonic oscillator Hamiltonian and the longitudinal component of orbital angular
momentum [32, 33]. Modes with slightly oﬀ-axis propagation directions can be deﬁned in terms of
the coherent states associated with these quadratic Hamiltonians, and many other generalizations are
possible to suit particular problems.

H⊥

Any linear combinations of the un modes satisfy the homogeneous paraxial wave equation, so cannot
possibly represent the ﬁelds in the region actually containing the sources, but they can exactly reproduce
any ﬁelds in the “downstream” vacuum region beyond the sources, and then be extrapolated upstream.
That is, for all ξ > ξ1, the actual radiation envelope
satisﬁes the homogeneous wave equation,
lies entirely in the solenoidal sub-space

ψ(ξ; ω)
i
|
, and may be decomposed as

ψ(ξ; ω)
i
|

=

un(ξ; ω)
|

ih

ψ(ξ; ω)
i
|

un(ξ; ω)
|
(cid:21)
un(ξ; ω)
i

i |

,

ψ(ξ; ω)
un(ξ; ω)
|
h

H⊥

=

n

(cid:20)X

n
X

and both the modulus and argument of the complex expansion coeﬃcients appearing in the sum have a
simple interpretation. Using the orthonormality of the modes, the normalized power spectral density at
a given transverse plane ξ > ξ1 is given by

∂
∂ω

P

EM[a](ξ; ω) = ω2

ψ(ξ; ω)
ψ(ξ; ω)
|
h

i

= ω2

ψ(ξ; ω)
un(ξ; ω)
|

|h

i|

2 ;

n
X

and, individually, each

provides the normalized power-spectral-density contribution from the nth mode, while

˜P

∂
∂ω

EM[un](ξ; ω)

ω2

ψ(ξ; ω)
un(ξ; ω)
|

|h

2
i|

0

≥

≡

θn(ξ; ω) = arg

ψ(ξ; ω)
un(ξ; ω)
i
|
h

ωτ dependence) of
determines the slowly-varying envelope phase (i.e., phase apart from the fast kξ
the the nth mode. From unitarity, it follows that ∂
EM[a](ξ; ω) =
∂ω
EM[un](ξ; ω) are all independent of ξ for any ξ > ξ1. With perhaps a slight abuse of notation,

EM[un](ξ; ω), θn(ξ; ω) and ∂
∂ω

−

˜P

P

P

∂
∂ω

(cid:2)

(cid:3)

EM[un] with a tilde to denote the scaled power (spectral density) contribution from

n
we have used ∂
P
∂ω

˜P

17

(96)

(97)

(98)

(99)

(100)

(101)

(102)

18

(103)

(104)

the nth normalized mode i.e., the power spectral density associated through Poynting’s theorem with
EM[un] literally associated
the ket
with the ket

, and not the power spectral density ∂
∂ω
, which is ﬁxed at the value ω2 by our normalization conventions.

un(ξ; ω)
i

i |

P

h

ψ(ξ; ω)
un(ξ; ω)
|
un(ξ; ω)
i

|

In general, a countably inﬁnite number of orthogonal modes are required to exactly describe the radiation
ﬁelds, but if the modes are chosen appropriately, a ﬁnite basis set
, such that
∈ BN , may provide a suﬃciently accurate representation. For example, if the
attention is conﬁned to n
mode shape is approximately Gaussian in cross section, then it should be accurately represented by the
fundamental and perhaps a few higher-order Gauss-Hermite modes, with proper choice of the waist size
and location. Formally, the expansion coeﬃcients may be determined by again using the Green function
solution (76), taking advantage of the ﬁnite support of
. In a derivation exactly analogous to that
in the previous section, we ﬁnd that for any ξ > ξ1,

BN of size N, 1

f (ω)
i
|

N <

∞

≤

ψ(ξ; ω)
un(ξ; ω)
i
|
h

= i

dξ′

un(ξ; ω)

h

U (ξ, ξ′; ω)
|

|

f (ξ′; ω)
i

min(ξ,ξ1)

Zξ0

∞

Z
−∞

= i

dξ′

f (ξ′; ω)
un(ξ′; ω)
i
|

h

= i

dξ′
Z

Z

d2r un(r; ξ′; ω)∗

f (r; ξ′; ω),

·

which apart from an overall constant is just a three-dimensional inner product, or overlap integral,
between the solenoidal source envelope f (r; ξ′; ω) and the free-space mode envelope un(r; ξ′; ω). Equiv-
alently, we can write this as the overlap integral between the full current density j(r; ξ′; ω), and the
normalized electric ﬁeld εn

(ξ′; ω) = iω un(r; ξ′; ω) associated with the nth mode:

⊥

ψ(ξ; ω)
un(ξ; ω)
i
|
h

=

−

1
2ω2

d2r εn

⊥

(r; ξ; ω)∗

j(r; ξ; ω)

·

dξ′
Z
dξ′

Z

Z

=

1
2ω2

−

εn
h

j(ξ′; ω)
(ξ′; ω)
i
|

.

⊥

So, again, we do not need to explicitly decompose the current density into its solenoidal and irrotational
components in order to calculate these expansion coeﬃcents. The factor of 1
2 is analogous to that
appearing in (87), and in fact (104) reduces to the full energy conservation result if we are lucky enough
to choose a basis which contains the extrapolated solution χ(r; ξ; ω) in its span. More generally, it is
clear that the ﬁnite-basis set approximation is just the orthogonal projection of the actual extrapolated
free-space solution into the subspace span
∈BN

spanned by the modes in

un(ξ; ω)
i
|

BN :

n

ν(ξ; ω;
|

BN )
i

=

un(ξ; ω)

χ(ξ; ω)
i

.

| |

(105)

(cid:3)
un(ξ; ω)
|

ih

(cid:2)

Xn
∈BN

From linearity, it immediately follows that if
resulting form a source

fm(ξ; ω)
i
resulting from the source envelope

then

m
cm(ω)
P

|

νm(ξ; ω)
|
i
νm(ξ; ω)
cm(ω)
i
|
fm(ξ; ω)
i
|

is the basis-set approximation to
cm(ω)

is the approximation to

χm(ξ; ω)
i
|
χm(ξ; ω)
i
|
C are arbitrary coeﬃcients.

, where the cm(ω)

m
P

∈

m
So we may also determine the basis set approximation for any source by ﬁrst ﬁnding the basis set
P
approximation for the impulse source
and then performing a convolution over the actual source.
That is, we can use as an approximate propagator, the restriction of the full Green operator to the
subspace span
∈BN

un(ξ; ω)
i
|

r; s
|

i

n

:

(cid:2)

(cid:3)

ν(ξ; ω;
|

BN )
i

= i

dξ′

un(ξ; ω)
|

ih

un(ξ′; ω)

f (ξ′; ω)
i

,

| |

(106)

ξ1

Zξ0

Xn
∈BN

which clearly agrees with previous results after exchanging the order of the integral and sum.

It follows from the properties of orthogonal projections in Hilbert space that the projected basis-set
approximation is also uniquely determined by the following constrained minimum-distance criteria:

ν(ξ; ω;
|

BN )
i
ν(ξ; ω)
|

s.t.

= arg min

ν

i ∈

span
n
∈BN

ν(ξ; ω)

k |
h
un(ξ; ω)
i
|
i
h

.

χ(ξ; ω)

i − |

i k

i

The estimated radiated power (spectral density) is then always a lower bound on the actual power
(spectral density) in any plane ξ > ξ1 :

P

∂
∂ω

EM[ν](ξ; ω;

BN ) =

˜P

∂
∂ω

EM[un](ξ; ω)

P

∂
∂ω

EM[χ](ξ; ω) = ∂
∂ω

P

EM[a](ξ; ω),

(108)

≤

Xn
∈BN
with equality if and only if ν(r; ξ; ω;
BN ) = χ(r; ξ; ω). In fact, it is straightforward to establish that,
at the constrained optimum (107), the squared-distance between the basis-set approximation and the
actual extrapolated ﬁelds is just proportional to their diﬀerence in power spectral density:

ω2

ν(ξ; ω;

k |

BN )

i − |

χ(ξ; ω)

ik

2 = ∂
∂ω

P

EM[χ](ξ; ω)

P

∂
∂ω

EM[ν](ξ; ω;

−

BN )

≥

0.

(109)

F. Variational Approximation

Such connections revealed in the basis-set approach between the orthogonal projection, minimum dis-
tance, maximum radiated power, minimal negative mechanical work, and maximal source/ﬁeld overlap
suggest that an approximate ﬁeld proﬁle for the radiation and a lower bound on the radiated power
may be obtained directly through a general variational principle. Consider a parameterized family of
trial envelope modes v(r; ξ; ω; α) depending on some set of adjustable parameters denoted by the vector
α, where, for any ﬁxed choice of allowed parameter values, we assume the the trial mode satisﬁes the
free-space wave equation, is solenoidal, and is normalized in any transverse plane. In principle, the trail
mode can be written formally as a linear combination of the above basis modes:

for some complex expansion coeﬃcients cn = cn(ω; α)

C which satisfy the constraint

v(ξ; ω; α)
i
|

=

cn(ω; α)

un(ξ; ω)
i

|

n
X

∈
2 = 1,
cn(ω; α)
|
|

n
X

v(ξ; ω; α)
v(ξ; ω; α)
i
|
h

= 1,

so that

but are otherwise arbitrary. Note that the expansion coeﬃcients are here assumed independent of ξ, but
may in general depend on the adjustable parameters in some complicated, and perhaps nonlinear fashion.
(More generally, we could allow dependence on ξ in the cn, leading to a variational problem involving
the solution of a set of coupled ODEs rather than miniization of a function. This extra generalization is
not really needed for the case of spontaneous radiation.) Using the Cauchy-Schwarz inequality, we have,
for any ξ,

ψ(ξ; ω)
v(ξ; ω; α)
|

|h

i|

v(ξ; ω; α)
v(ξ; ω; α)
|

ψ(ξ; ω)
ψ(ξ; ω)
i
|

,

i h

≤ h

2

which using (112) simpliﬁes to

or equivalently

ω2

ψ(ξ; ω)
v(ξ; ω; α)
|

|h

2
i|

≤

ω2

ψ(ξ; ω)
ψ(ξ; ω)
i
|

h

,

(cid:0)

(cid:1)

˜P

∂
∂ω

EM[v](ξ; ω; α)

P

∂
∂ω

EM[a](ξ; ω),

≤

19

(107a)

(107b)

(110)

(111)

(112)

(113)

(114)

(115)

with strict equality if and only if v(r; ξ; ω; α) exactly mirrors the shape and polarization of the actual
paraxial solution ψ(r; ξ; ω) in the plane ξ, up to some overall phase; i.e.,

for some real angle θv(ω; α).

v(ξ; ω; α)
i
|

= eiθv (ω;α)

ψ(ξ; ω)
v(ξ; ω)
i
|
h
(cid:0)

(cid:1)

1/2

−

ψ(ξ; ω)
i
|

We have indeed arrived at a variational principle for the paraxial radiation, where we may approximate
both the relative spatial/polarization proﬁle and overall amplitude of the radiation ﬁelds by maximizing
the power-spectral density in a normalized trial mode v(ξ; ω; α) measured in some post-source plane
ξ > ξ1, as a function of the variational parameters α determining the trial mode’s shape and polarization.
That is, we take as the approximate radiation envelope

ν(ξ; ω; ˜α)
i
|
where the optimal parameter vector ˜α = ˜α[j](ω) is chosen so as to maximize

ψ(ξ; ω)
v(ξ; ω; ˜α)
i
|
h

v(ξ; ω; ˜α)
i
|

=

(cid:1)

(cid:0)

,

P

∂
∂ω

EM[ν](ξ; ω; α) = ∂
∂ω

˜P

EM[v](ξ; ω; α) = ω2

ψ(ξ; ω)
v(ξ; ω; α)
|

|h

i|

2 .

The optimized mode shape is then the best guess, within the manifold of possibilities allowed by the
shapes parameterized by α, of the actual paraxial ﬁeld proﬁle beyond the sources, and the squared-norm
yields a lower bound on the actual paraxial power spectral density of the radiation at the frequency under
consideration.

However, as written, this variational principle appears vacuous at best, since if we knew the actual
ψ(r; ξ; ω) so as to be able to calculate its overlap with the trial ﬁeld v(r; ξ; ω; α), there would of course
be no need for a variational approximation in the ﬁrst place. But from (104), we may also write

ψ(ξ; ω)
v(ξ; ω; α)
i
|

h

=

−

1
2ω2

d2r εv

⊥

(r; ξ; ω; α)∗

j(r; ξ; ω)

·

dξ′
Z

Z
ξ1

=

1
2ω2

−

Zξ0

dξ′

εv

h

j(ξ′; ω)
(ξ′; ω; α)
i
|

⊥

(r; ξ; ω; α) = iω v(r; ξ; ω; α)eikξ is the normalized solenoidal frequency-domain electric ﬁeld
where εv
associated with the unit-norm trial vector potential envelope v(r; ξ; ω; α). In terms of the trial envelope
ν(r; ξ; ω; ˜α), we see that

⊥

∂
∂ω

Pν(ξ; ω; α) = ω2

ψ(ξ; ω; α)
v(ξ; ω; α)
|

2 = ω2

i|
j(ξ′; ω)
(ξ′; ω; α)
i
|

=

−

dξ′

εν

h

⊥

|h
1
2

Z

ν(ξ; ω; α)
ν(ξ; ω; α)
i
|
h
,

where εν
(r; ω; α) = iω ν(ξ; ω; α) is the solenoidal electric ﬁeld associated with the unnormalized trial
envelope . Because the left-hand side is purely real and non-negative, the right hand side must already
be so as well, so in fact:

⊥

From the inequality (115) and the energy-conservation result (87) we arrive at an alternative formulation
of the variational principle:

∂
∂ω

Pν(ξ; ω; α) =

1
2 Re

1
2

∂
∂ω

−

−

=

dξ′

εν

(cid:20)Z
P
mech[εν

h

⊥

⊥

j(ξ′; ω)
(ξ′; ω; α)
i
|
(cid:21)

; j](ω; α).

∂
∂ω

Pν(ξ; ω; α)

Pν(ξ; ω; ˜α) =
∂
∂ω
Pa(ξ; ω) =
∂
∂ω
P
1
∂
mech[εχ
∂ω
2

−

1
2
P

P

∂
∂ω
mech[εa

−
∂
∂ω
; j](ω).

≤

≤
=

⊥

−

mech[εν

; j](ω; α)

⊥
; j](ω)

⊥

In addition, since

ν(ξ; ω; α)
ν(ξ; ω; α)
i
|
h

=

χ(ξ; ω)
v(ξ; ω; α)
|

|h

i|

χ(ξ; ω)
ν(ξ; ω; α)
i
|
h

,

2 =

20

(116)

(117)

(118)

(119)

(120)

(121)

(122)

(123)

21

(124)

(125a)

(125b)

for all ξ, it follows that the unnormalized trial envelope ν(r; ξ; ω; ˜α) (i.e., with the absolute amplitude
included as an adjustable parameter) also minimizes the Hilbert-space distance between the trial solution
and the actual extrapolated paraxial solution in any transverse plane ξ :

ν(ξ; ω; α)

χ(ξ; ω)

k |

i − |

ik ≥ k |
= ω−

ν(ξ; ω; ˜α)
2
∂
∂ω

i − |
Pχ(ξ; ω)

χ(ξ; ω)
∂
∂ω

i k
Pν(ξ; ω; ˜α)

−

0.

≥

The results (122) and (124) are obviously closely related to the results (108) and (107) derived in the
(cid:2)
basis-set expansion, which ﬁrst led us to the variational formulation. Equivalently, we can express our
variational principle most succinctly in terms of the unnormalized (amplitude-included) trial waveﬁeld
which solves a constrained power-maximization problem for all parameters α deﬁning the trial-solution
ν(r; ξ; ω; ˜α):

(cid:3)

˜α = arg max

∂
∂ω

Pν(ξ; ω; α)

s.t. ∂
∂ω

Pν(ξ; ω; α) =

P

(cid:2)
mech[εν

; j](ω; α).

(cid:3)

⊥

α
∂
∂ω

1
2

−

These several equivalent formulations of the maximum-power variational principle (MPVP) are intu-
itively appealing, perhaps so much so that they might be guessed immediately, without the entire
build-up of mathematical machinery. The variational approximation, which maximizes the resemblance
(in the Hilbert-space metric), within the considered family of possibilities, to the actual paraxial ﬁeld
in the post-source region, or equivalently, to the extrapolated source-free paraxial ﬁeld everywhere in
j(ξ′; ω)
(ξ′; ω; α)
space, can be obtained by maximizing the source/ﬁeld spatial overlap
,
i
|
i.e., the magnitude of the three-dimensional inner product between the normalized source-free trial ﬁeld
(cid:12)
and the actual current density. That is to say, our best approximation to the free-space radiation ﬁelds
(cid:12)
beyond the sources is found by maximizing the physical resemblance of these ﬁelds, when extrapolated
backward into the region of the sources assuming free-space propagation, to the proﬁle of the sources.

εv
h

dξ′

(cid:12)
(cid:12)

R

⊥

Equivalently, we can say the optimal proﬁle is that which, if it actually were to be incident on the sources,
would experience the maximal small-signal gain (i.e., neglecting saturation eﬀects or indeed any back-
action on the sources), due to energy absorbed from those sources, and in this case the virtual “gross”
power gain (i.e., due to stimulated emission, but neglecting the stimulated absorption) is numerically
proportional to the estimated spectral density of spontaneously-radiated power. This approximation also
optimizes the total radiated power spectral density in the full variational radiation envelope ν(r; ξ; ω; α),
consistent with the constraint, arising from energy-conservation, that this power could have arisen from
work done by the sources, with appropriate compensation (i.e., scaling by 1
2 ) for the fact that we have
replaced the inhomogeneous ﬁelds with their homogeneous extrapolation in the region of these sources.

Note that this variational principle is reminiscent of the Rayleigh-Ritz variational principle familiar from
ordinary quantum mechanics, but despite the analogies between paraxial radiation propagation and non-
relativistic quantum mechanics, these variational principles are actually distinct. In quantum mechan-
ics, “the” Rayleigh-Ritz method is applicable to approximating the low-lying energy eigenvalues and
corresponding stationary states of the homogeneous, time-independent Schrodinger equation, whereas
the present variational principle is associated with solutions to the inhomogeneous, time-dependent
Schrodinger equation.

However, the MPVP does share with the quantum-mechanical Raleigh-Ritz technique many of the same
features and limitations common to variational approximations and optimization problems. Because we
are determining a stationary point (in fact, a maximum) of a power (spectral density) functional, the
actual value obtained for the power spectrum at the extremum is relatively insensitive to the precise
shape of the trial ﬁeld – generally, if the characteristic relative error in the latter is O(ǫ) in some sense,
then the relative error in the former is O(ǫ2), because the ﬁrst-order variations vanish.
In order to
estimate the power to say 1%, we need only match the variational parameters describing the ﬁeld shape
to about 10%. This is, of course, great news if we are actually most interested in estimating the power,
but, conversely, much less satisfying if we are interested in determining, say, the spot size w0, or some
characterization of the the angular spectrum. This is analogous to the situation in quantum mechanics,
where it is well known that the Raleigh-Ritz approximation estimates the ground-state energy eigenvalue
more accurately than its corresponding wavefunction.

The variational approximation for the ﬁeld proﬁle is expected to be accurate to the extent that the
trial mode can overlap, or mimic, the actual mode in any transverse plane ξ > ξ1 in the free-space

22

region beyond the sources, and obviously the approximation is expected to improve as the number of
functionally-independent shape parameters is increased. Since ν(ξ; ω; ˜α) satisﬁes the free-space equation,
it is actually an approximation throughout all ξ to the extrapolated envelope χ(r; ξ; ω). The correspond-
ing power yields a lower bound for the actual power radiated, but in the absence of an upper bound, one
does not have any foolproof means to estimate the closeness of this approximated to actual power. We
can consider a so-called “minimizing” sequence of variational problems where at each stage we expand
the parametric family of trial envelopes to include additional possible details of the ﬁeld proﬁles which
we anticipate might be present in the actual radiation but which could not be captured in the previous
trial ﬁelds. If the extended family continues to include as a possibility the previous variational solution,
then the estimated power monotonically approaches the actual (unknown) power from below, and the
Hilbert-space distance between the trial envelope and the actual (unknown) envelope in any post-source
plane monotonically approaches zero from above. In practice, we can stop when the diﬀerence (in power
or Hilbert-space distance) upon adding ﬁner details to the trial envelope becomes suﬃciently small, or
else when we have expended as much computational eﬀort as we can spare. From above, we know that
an additional parameter leading to an O(ǫ) relative increase in the power is expected to produce only
an O(√ǫ) relative improvement in the local ﬁeld proﬁle.

v(ξ; ω; α)
as a sum over the orthonormal modes
Although we formally expressed the normalized ket
i
|
un(ξ; ω; α)
, we stress that the variational envelope can be explicitly written in any arbitrary form, with
|
i
adjustable parameters which appear linearly or non-linearly, as long as it satisﬁes the homogeneous wave
equation, gauge constraint, and normalization constraint. If the parameters α represent the expansion
coeﬃcients in some ﬁnite linear sum of orthonormal modes, which is the assumption of the classic
Raleigh-Ritz and Ritz-Galerkin techniques in the calculus of variations, then the variational approach
formally reduces to the basis-set approach, but it is often more convenient or eﬃcient in practice to use
an explicitly nonlinear family of trial solutions where the variational parameters do not appear linearly.
For example, one might use a Gaussian beam with indeterminate waist size and location, as discussed in
the introduction, or perhaps even additional parameters to include skew or eccentricity or higher-order
structure in the spot proﬁle.

IV. NON-PARAXIAL GENERALIZATION

When translated from the quantum mechanical into conventional notation, none of the energy-balance
and variational results derived above in the paraxial limit depend in any essential way on the assumed
paraxial nature of the ﬁelds. This suggests that analogous results should hold more generally, beyond
the paraxial approximation, for any radiation emitted spontaneously by charges moving along prescribed
trajectories. The essential features which emerged in the paraxial case, which we now abstract to more
general problems, are: approximation of the actual radiation ﬁelds arising from the sources by homo-
geneous (i.e., free-space, or source-free) ﬁelds; a variational principle, derived from the Cauchy-Schwarz
inequality in a Hilbert space picture, mandating the maximization of (only) outgoing power spectral den-
sity; energy exchange between ﬁelds and charges which can be characterized as the three-dimensional
inner product, or overlap integral, between the extrapolated, solenoidal electric ﬁeld and either the full or
solenoidal current density, as convenient; and, ﬁnally, a functional relationship between the mechanical
work performed on/by the charges by/on the extrapolated ﬁelds within a region and the radiation ﬂux
through a boundary surface, arising, physically, from energy conservation, and, mathematically, either
explicitly from the formal solution or else from some form of the the Fundamental Theorem of Calculus
(e.g., Gauss’s theorem or Green’s Identities in multiple dimensions.)

A. Vector Spherical Harmonics and the Spherical Wave Basis

In order to generalize our results to the non-paraxial case, we ﬁrst introduce a bit more mathematical
notation and machinery. We use the scaled spatial position ζ, and introduce spherical coordinates: the
0, the polar angle θ, and the azimuthal angle ϕ, so that ζ = ζ ˆζ = ζ ˆx. We let R
scaled radius ζ =
denote any (closed) spatial region in R3, and ∂R will denote its boundary. For any position ζ0 and any
,
nonnegative ζ′

0, we deﬁne the closed ball of radius ζ′ centered at ζ0 as B(ζ′; ζ0)

k ≥

ζ′

ζ

ζ

ζ

k

≡ {

| k

−

ζ0k ≤

}

≥

23

and we will take V (ζ′; ζ0)
⊆
V (ζ′; ζ0). For simplicity, whenever the central position coincides with the origin (ζ0 = 0), the dependence
will be suppressed in the notation; i.e., B(ζ′)

R3 to denote a closed, simply-connected region satisfying B(ζ′; ζ0)

B(ζ′; 0) and V (ζ′) = V (ζ′; 0).

⊂

≡

As in the paraxial case, we take the (scaled, frequency-domain) current density j(ζ; ω), assumed known, is
to be localized in space, vanishing identically outside some ﬁnite-radius ball B(ζ′1), for some 0 < ζ′1 <
.
∞
(ζ; ω) will therefore not have have compact support in general, but
Again, the solenoidal component j
because of the rapid falloﬀ of its spatial dependence (O(ζ−
), we may, with arbitrary small
ζ′1.
error in the calculated radiation ﬁelds, neglect it beyond some suﬃciently large but ﬁnite radius ζ1 ≥
(Again, at the end of the calculation, we could attempt to take this support to be inﬁnite, provided that
the full current density continues to fall oﬀ suﬃciently rapidly to ensure convergence of the integrals,
and to enable somehow the unambiguous characterization of the “far-zone” versus non-radiative ﬁelds,
when the latter extend to inﬁnity.)

2) as ζ

→ ∞

⊥

It will prove very convenient to have some explicit basis in which to decompose the vector potential.
The plane-wave (spatial-Fourier) basis immediately comes to mind, but certain cumbersome singularities
inevitably arise in this representation. Namely, whenever the vacuum dispersion relation is satisﬁed, i.e.,
= ω, solutions to the homogeneous Helmholtz equation possess delta-function singularities, while
k
solutions to the inhomogeneous solution exhibit second-order divergences whenever the corresponding
= 0. In order to avoid such diﬃculties, we will instead use the spherical
Fourier components j
wave basis [5, 35, 36]. The conventional vector spherical harmonics are deﬁned as

(k, ω)

k

k

⊥

Xℓ m = Xℓ m( ˆζ) = Xℓ m(θ, ϕ) =

1
√ℓ(ℓ+1)

LYℓ m(θ, ϕ),

(126)

where, in analogy to quantum mechanics, we have deﬁned the Hermitian (scaled) orbital angular mo-
mentum operator as

×
which acts only on the angular degrees of freedom (i.e., not on the radial or the polarization degrees-of-
freedom),

≡

×

−

(cid:0)

(cid:1)

L

Q3D ×

P3D ≡

ζ

1
i ∂

=

i (ζ

∂) ,

(127)

L = 1
√2

ˆe+e−

iϕ

∂

∂θ + i cot(θ) ∂

∂ϕ

+ 1
√2

ˆe

−

e+iϕ

+ ∂

∂θ + i cot(θ) ∂

∂ϕ

i ˆz ∂

∂ϕ ;

(128)

−

(cid:16)

(cid:17)

(cid:16)

−

(cid:17)

and the functions Yℓ m(θ, ϕ) denote the usual scalar spherical harmonics for nonnegative integers ℓ =
0, 1, 2, . . . , and integer m =
1, ℓ. In addition, we deﬁne two other related sets
of basis vector ﬁelds:

ℓ + 1, . . . , 0, . . . , ℓ

−

−

−

ℓ,

and

Zℓ m = Zℓ m( ˆζ) = Zℓ m(θ, ϕ) = ˆζ

Xℓ m,

×

Nℓ m = Nℓ m( ˆζ) = Nℓ m(θ, ϕ) = ˆζ Yℓ m.

(By deﬁnition, we take X0 0 = Z0 0 ≡
symmetric solutions to the free-space Maxwell equations can exist only in the non-radiative ω
limit.)

0 identically, ultimately reﬂecting the fact that spherically-
0

→

The orbital angular momentum operator L eﬀects inﬁnitesimal (inverse) rotations of the spatial degrees
of freedom, i.e., observation position or ﬁeld point, and satisﬁes the useful identities:

ˆζ
·
L
×
L2, L
P 2
3D, L
(cid:2)

L = 0,
L = iL,
= 0,
= 0,
L2 = r ∂2

(cid:3)

(cid:3)

(cid:2)

∂r2 (r ) + r2P 2
3D.

The scalar spherical harmonics themselves may be interpreted as simultaneous eigenstates of L2 and Lz.
Each of the basis vector ﬁelds may then be interpreted as a simultaneous eigenstate of J 2 = J 2
y + J 2
z

x + J 2

(129)

(130)

(131a)
(131b)

(131c)

(131d)

(131e)

6
and Jz for some spin-one object, where J = L + S is the total (spatial plus spin/polarization) angular
momentum operator. For ﬁxed ℓ and ﬁxed W = X, Z, or N , the members Wℓ m(θ, ϕ) of each of these
three families therefore transform amongst themselves under total spatial rotations (of both spatial and
polarization degrees of freedom). The spin angular momentum operator S generates rotations of the
polarization vector, and in the Cartesian basis, S = ˆxS1 + ˆyS2 + ˆzS3 may be deﬁned as a vector of 3
3
Hermitian matrices Sj for j = 1, 2, 3, whose components are given by

×

where ǫjkn is the completely antisymmetric Levi-Civita tensor in three dimensions. From this deﬁnition
one can prove the useful operator identity

Using various vector identities, these spherical vector harmonic basis ﬁelds also can be shown to satisfy:

(Sj)kn =

iǫjkn,

−

∂

× ≡

P3D ·

S.

ℓ(ℓ + 1)Yℓ m,

Xℓ m =
Zℓ m = 0,
p
Nℓ m = 0;

L
L
L

·
·
·

L

L
L

×

×
×

Xℓ m = iXℓ m,

Zℓ m =
Nℓ m = 0;
p

ℓ(ℓ + 1)Nℓ m,

ˆζ
ˆζ
ˆζ

·

·

·

Xℓ m = 0,

Zℓ m = 0,

Nℓ m = Yℓ m;

ˆζ
ˆζ
ˆζ

×

×

×

Xℓ m = Zℓ m,

Xℓ m,

Zℓ m =
Nℓ m = 0;

−

·

·

Xℓ m = 0,
i
Zℓ m =
ζ
−
Nℓ m = 2
ζ Yℓ m;
p

∂

∂

∂

·

ℓ(ℓ + 1)Yℓ m,

as well as

and

and

and also

together with

ℓ(ℓ + 1)Nℓ m + Zℓ m

,

∂

∂

∂

×

×

×

i

Xℓ m = 1
ζ
(cid:16)
1
p
ζ Xℓ m,
i
ζ

Nℓ m =

Zℓ m =

−

−

ℓ(ℓ + 1)Xℓ m.

(cid:17)

·

For any allowed ℓ and m, the vector spherical harmonics are geometrically orthogonal as vectors at every
point ˆζ on the unit sphere:

Xℓ m( ˆζ)∗

Zℓ m( ˆζ) = Xℓ m( ˆζ)∗

Nℓ m( ˆζ) = Zℓ m( ˆζ)∗

Nℓ m( ˆζ) = 0;

(140)

·

p

·

24

(132)

(133)

(134a)
(134b)
(134c)

(135a)

(135b)
(135c)

(136a)

(136b)

(136c)

(137a)

(137b)

(137c)

(138a)

(138b)

(138c)

(139a)

(139b)

(139c)

25

(144a)

(144b)

(145)

(146)

are (Hilbert-space) orthonormal when integrated over solid angle (except in the trivial case where both
vector ﬁelds identically vanish for ℓ = 0):

dθ sin θ

dϕ Wℓ m(θ, ϕ)∗

W ′ℓ′ m′ (θ, ϕ) = δW W ′δℓ ℓ′ δm m′ (1

δW X δℓ 0) (1

δW Zδℓ 0) ;

(141)

Z

Z

and also collectively constitute a complete set for vector ﬁelds deﬁned on the unit sphere:

·

ℓ

∞

W =X,Z,N
X

Xℓ=0

Xm=
−

ℓ

·

where I3 is the identity matrix on the polarization degrees of freedom.

Wℓ m(θ, ϕ)

Wℓ m(θ′, ϕ′)† = δ(cos θ

cos θ′)δ(ϕ

ϕ′)I3,

(142)

Now, outside the (eﬀective) support of the solenoidal sources, i.e., for any ζ
ζ2 > ζ1, the actual
Coulomb-gauge vector potential a(ζ; ω) is assumed to satisfy the homogeneous Helmholtz equation,
and the method of separation-of-variables may be used in spherical coordinates to show that there the
solution may always be written in the form:

≥

a(ζ; ω) =

1
ω2 aE

ℓ m(ω)∂

h(1)
ℓ (kζ)Xℓ m(θ, ϕ)

i
ω aM

ℓ m(ω)h(1)

ℓ (kζ)Xℓ m(θ, ϕ),

(143)

Xℓ, m

×

(cid:2)

−

(cid:3)

where the spherical Hankel functions of the ﬁrst and second kind,

−

−

−

−

are deﬁned in terms of the usual spherical Bessel functions,

h(1)
ℓ (x) = jℓ(x) + i nℓ(x),
h(2)
i nℓ(x).
ℓ (x) = jℓ(x)

−

jℓ(x) = (

x)ℓ

−

ℓ

1
x

d
dx

(cid:18)

(cid:19)

(cid:18)

sin x
x

,

(cid:19)

nℓ(x) =

x)ℓ

(
−

−

ℓ

1
x

d
dx

cos x
x

.

(which should not be confused with any current density), and the spherical Neumann functions,

(cid:18)
Any two of these four families of special functions may be taken as the linearly-independent solutions
to the radial diﬀerential equation obtained through separation of variables. The appearance of only the
h(1)
ℓ (kr)
in the radial part of our formal solution reﬂects the facts that the solution holds in the
extra-source region ζ > ζ1 which excludes the origin, and that we have imposed the so-called Sommerfeld
boundary conditions, requiring only outgoing radiation at spatial inﬁnity.

eikζ
kζ

∝

(cid:19)

(cid:17)

(cid:16)

Each term in the superposition (143) is everywhere divergenceless, so the total vector ﬁeld is solenoidal,
C are, respectively, the (scaled)
as required. The expansion coeﬃcients aE
(ζ; ω), and are uniquely
electric and magnetic multipole moments of the transverse current density j
determined by quadratures over j, or equivalently by ﬁeld values in the far-ﬁeld (or, in fact, by just the
radial components of the ﬁelds on any two spherical shells outside the sources.) For example, using the
far-ﬁeld asymptotic behavior, one can, with a bit of algebra, show that

C and aM

ℓ m(ω)

ℓ m(ω)

∈

∈

⊥

aM
ℓ m(ω) =

−

aE
ℓ m(ω) = i

ω2
ℓ(ℓ + 1)

p

ω

ℓ(ℓ + 1)

max[m+1,ℓ]

Xm′=min[0,m
−
max[m+1,ℓ]

1]

Xm′=min[0,m

−

1]

Mℓ m′(ω)

dθ sin θ
Z

·

Z

Rℓ m′ (ω)

dθ sin θ
Z

·

Z

where we have deﬁned

p

dϕ Yℓ m(θ, ϕ)∗LYℓ m′ (θ, ϕ),

(147a)

dϕ Yℓ m(θ, ϕ)∗LYℓ m′(θ, ϕ);

(147b)

Mℓ m(ω) =

d3ζ [jℓ(kr)Yℓ m(ˆr)∗] j
⊥

(ζ; ω),

Rℓ m(ω) =

d3ζ [jℓ(kr)Yℓ m(ˆr)∗] ∂

(ζ; ω).

j
⊥

×

Z

Z

(148a)

(148b)

26

Many other equivalent forms are possible, depending on precisely what data are used and where, but
explicit forms for the multipole expansion coeﬃcients will not actually be needed here. (After all, if
they were known or easily calculable, we would not need to resort to any sort of approximation.) Note
that time-reversed, or equivalently conjugate, or incoming-wave, solutions can obviously be written in
an analogous manner, with the h(1)

ℓ (kζ) replaced with h(2)

ℓ (kζ)

e−ikζ
kζ

.

∝

By assumption, any solenoidal, source-free “trial” vector potential χ(ζ; ω; α) satisﬁes the homogeneous
equation everywhere in space, and may be expressed, for any ζ, in a similar form:

χ(ζ; ω; α) =

1
ω2 χE

ℓ m(ω; α)∂

jℓ(kζ)Xℓ m(θ, ϕ)

+

i
ω χM

ℓ m(ω; α)jℓ(kζ)Xℓ m(θ, ϕ).

(149)

Xℓ, m

×

(cid:2)

−

(cid:3)

The use of jℓ(kζ) is the only choice for the radial dependence which solves the Helmholtz equation but
is regular everywhere in space, including the origin. Each term in (149) is also automatically diver-
ℓ m(ω; α)
genceless everywhere, so their sum (when convergent) is solenoidal. The complex coeﬃcients χE
ℓ m(ω; α) for this source-free solution may nevertheless be interpreted as some eﬀective (scaled)
and χM
multipole moments which would describe what we might term an “eﬀective source” g(ζ; ω; α), or may
just be regarded as free expansion coeﬃcients determined by (or even taken to be equal to) the actual
variational parameters α appearing in χ(ζ; ω; α). The familiar expansions

eik

·

ζ = 4π

∞

iℓjℓ(kζ)

ℓ

Yℓ m( ˆζ)∗Yℓ m(ˆk) =

iℓ

4π(2ℓ + 1)jℓ(kζ)Y1 0(arccos( ˆζ

ˆk), 0),

(150)

∞

ℓ

Xℓ=0

Xm=
−

Xℓ=0
for any ﬁxed (scaled) wavevector k = kˆk, may be used to establish the connection between the plane wave
and spherical wave representations, and to conﬁrm that they both span the same space of source-free
solutions.

p

·

B. Green Functions

Gret(ζ; ζ′; ω) =

e+ik
k
ζ
4π

ζ

ζ′

−

k

,

ζ′k

k

−

Alternatively, the exact solution to the inhomogeneous problem at any position ζ may be expressed in
terms of a convolution over the retarded Green function:

(151)

(152)

(153a)

(153b)

which is invariant under simultaneous translations, rotations, or reﬂections of both spatial arguments,
and satisﬁes the scalar Helmholtz equation with impulsive source (and with negative unit charge, con-
forming to convention for electromagnetic problems),

together with the Sommerfeld asymptotic radiation conditions for outgoing waves:

(cid:0)

(cid:1)

∂2 + ω2

Gret(ζ; ζ′; ω) =

δ(ζ

ζ′),

−

−

Gret(ζ; ζ′; ω) = O(1/ζ) as ζ

ik

Gret(ζ; ζ′; ω) = o(1/ζ) as ζ

→ ∞
,
→ ∞

∂
∂ζ −

(cid:0)

(cid:1)

for any ﬁxed emitter position ζ′. (Because we are working with solenoidal sources in otherwise free space,
we can use a scalar rather than dyadic Green function [37].) The retarded Green function Gret(ζ; ζ′; ω),
then represents an outgoing (scalar) spherical wave at the observation position ζ emanating from a
harmonic point source at ζ′. (By symmetry, analogous conditions and interpretations obviously hold
true under permutation of the two spatial positions ζ and ζ′, from which follow various well-known
electromagnetic reciprocity results such as the Raleigh-Carson and Lorentz theorems.) The advanced
Green function

Gadv(ζ; ζ′; ω) =

Gret(ζ; ζ′; ω)

∗ =

(154)

ik

ζ

ζ′

−

k

e−
4π

k
ζ

,

ζ′k

k

−

(cid:2)

(cid:3)

27

(156)

(157)

(158)

satisﬁes the same impulsive Helmholtz equation, and in fact may be interpreted as the time-reversal of
the retarded impulse response, representing an incoming spherical wave, observed at ζ, and ultimately
converging to a point absorber at ζ′. Given any current density j(ζ′; ω) with compact support in the
neighborhood V (ζ1) of the origin, and supposing no incoming radiation from distant sources by assump-
tion, the solenoidal component j
,
→ ∞
⊥
so the Coulomb-gauge vector potential can always be expressed as:

(ζ′; ω) can result only in outgoing radiation asymptotically as ζ

a(ζ; ω) =

d3ζ′ Gret(ζ; ζ′; ω)j

(ζ′; ω) =

d3ζ′ Gret(ζ; ζ′; ω)j

(ζ′; ω).

(155)

Z

⊥

ZV (ζ1)

⊥

Clearly, this satisﬁes the appropriate inhomogeneous Helmholtz equation:

(∂2 + ω2)a(ζ; ω) =

d3ζ′ (∂2 + ω2)Gret(ζ; ζ′; ω)j

(ζ′; ω)

⊥

Z

−

=

Z

d3ζ′ δ(ζ

ζ′) j

(ζ′; ω), =

−

⊥

(ζ; ω)

j
⊥

−

and also shares with Gret(ζ; ζ′; ω) the appropriate outgoing-wave Sommerfeld boundary conditions. Be-
cause Gret(ζ; ζ′; ω) is radially symmetric, depending on the spatial coordinates only through
,
and because ∂

(ζ; ω) = 0 by construction, we have

ζ′

−

ζ

k

k

·

j
⊥
Gret(ζ; ζ′; ω)j

⊥

∂

·

(cid:2)

Since Gret(ζ; ζ′; ω) = O(1/

(ζ; ω) . O(1/ζ2) as ζ

, Gauss’s law then implies

→ ∞

(ζ′; ω)

= ∂Gret(ζ; ζ′; ω)

(ζ′; ω) =

∂′Gret(ζ; ζ′; ω)

(ζ′; ω)

∂′

[Gret(ζ; ζ′; ω)j

j
⊥

·

−
(ζ′; ω)] .

⊥

=

(cid:3)

·
−
) and j
|

⊥

ζ
|

−

ζ′

∂

a(ζ; ω) =

d3ζ′ ∂

[Gret(ζ; ζ′; ω)j

(ζ′; ω)] =

d3ζ′ ∂′

[Gret(ζ; ζ′; ω)j

(ζ′; ω)]

·

·

⊥

Z

−

=

dσ′ ˆn

[Gret(ζ; ζ′; ω)j

lim
ζ2→∞ ZV (ζ2)

·

−

Z
(ζ′; ω)] = 0

·

⊥

j
⊥

·

⊥

so indeed a(ζ; ω) is solenoidal, as required. (Subsequently, we will make use of a number of similar
multidimensional “integrations by parts,” relying on the the suﬃciently rapid fall-oﬀ of j
and radiative
fall-oﬀ of Gret, but for brevity we will not always provide the explicit demonstrations.)

⊥

Outside the support of sources, say for ζ
ζ2 > ζ1, the solution to the inhomogeneous Helmholtz
equation may also be written in terms of a surface integral involving the Green function and boundary
V (ζ2), using the
data. Speciﬁcally, by applying Green’s second identity to the region lim
ζ3→∞

Helmholtz equations satisﬁed by the vector potential and the retarded Green function, and making use
of the assumed Sommerfeld radiation conditions, we ﬁnd:

V (ζ3)

≥

−

a(ζ; ω) =

dσ′

a(ζ′; ω)( ˆn′

∂′)Gret(ζ; ζ′; ω)

Gret(ζ; ζ′; ω)( ˆn′

∂′)a(ζ′; ω)

,

(159)

·

−

·

Z∂V (ζ2)

(cid:2)

(cid:3)

which is the vector form of the well-known Kirchoﬀ diﬀraction integral. Here the unit vector ˆn′ = ˆn(ζ′)
denotes an outward normal to the boundary surface at any point ζ′

∂V (ζ2).

By piecing together diﬀerent spherical wave solutions to produce just the right discontinuity at ζ = ζ′,
it is straightforward to establish the well-known Bessel decomposition of the retarded Green function:

Gret(ζ; ζ′; ω) = iω

jℓ(kζ<)h(1)

ℓ (kζ>)

Yℓ m( ˆζ)Yℓ m( ˆζ′)∗

(160)

∞

Xℓ=0

where

∈

ℓ

Xm=
−

ℓ

ζ< = min[ζ, ζ′],
ζ> = max[ζ, ζ′].

(161a)
(161b)

28

(162)

From linearity, we can see that the diﬀerence between the retarded and advanced Green functions,

D(ζ; ζ′; ω)

Gret(ζ; ζ′; ω)

Gadv(ζ; ζ′; ω) =

≡

−

sin (k
2πi

)

ζ
k
ζ
k

ζ′
−
k
ζ′k
−

−

i
2π

=

sinc (k

ζ

k

−

ζ′

) ,

k

must be a solution (with respect to either spatial coordinate) to the source-free scalar Helmholtz equation
everywhere in space. Substituting in the decomposition (160) for the Green function, this homogeneous
solution D(ζ; ζ′; ω) may be written as:

D(ζ; ζ′; ω) = 2iω

jℓ(kζ)jℓ(kζ′)∗Yℓ m( ˆζ)Yℓ m( ˆζ′)∗,

(163)

Xℓ ,m

ℓ

m=
−
P

where we have used the facts that

Yℓ m( ˆζ)Yℓ m( ˆζ′)∗ and jℓ(kζ) are both real.
ℓ

Now, it turns out that, just as a general solution to the inhomogeneous equation with outgoing Som-
merfeld radiation boundary conditions may be written as a convolution between the retarded Green
function and the solenoidal portion of the current density, any arbitrary solenoidal solution to the homo-
geneous problem may be written as a convolution between what we may term the fundamental solution
D(ζ; ζ′; ω) and the solenoidal component g
(ζ′; ω), of some eﬀective source term g(ζ′; ω) whose support
can be conﬁned to any ﬁnite-radius ball B(ζ0) where ζ0 > 0 :

⊥

χ(ζ; ω) =

d3ζ′ D(ζ; ζ′; ω)g

(ζ′; ω) =

d3ζ′ D(ζ; ζ′; ω)g

(ζ′; ω)

(164)

Z

⊥

ZV (ζ0)

⊥

To see this, ﬁrst note that if we choose

g(ζ; ω) = g

Θ(ζ0 −
(which is clearly divergenceless by the chain rule and the transverse nature of Xℓ m( ˆζ)), then, by using the
explicit decomposition (163) for D(ζ; ζ′; ω) and the orthogonality properties of the spherical harmonics
as well as their behavior under the action of the orbital angular momentum operator L, we ﬁnd

ζ)jℓ(kζ)Xℓ m(θ, ϕ),

(ζ; ω)

(165)

∝

⊥

ζ0

χ(ζ; ω)

dζ′

2
ζ′jℓ(kζ′)
|
|

(cid:21)

∝

(cid:20)
Z0

jℓ(kζ)Xℓ m(θ, ϕ),

(166)

and thus any term of the magnetic multipole form in (149) can be generated in this manner. Using
standard vector identities, the symmetry of D(ζ; ζ′; ω) in its spatial arguments, and integration by parts
relying on the rapid fall-oﬀ of g

, we also have

⊥

∂

×

Z

d3ζ′ D(ζ; ζ′; ω) g(ζ′; ω) =

d3ζ′ ∂

D(ζ; ζ′; ω) g

(ζ′; ω)

×

Z

=

(cid:2)
d3ζ′ D(ζ; ζ′; ω) ∂′

(cid:3)
(ζ′; ω),

⊥

g

×

⊥

(167)

Z
So any required term of the electric multipole form can also be so generated. By linearity, an arbitrary
homogeneous solution may then be constructed as a convolution over the fundamental homogeneous
solution. We will see below that the eﬀective source g(ζ; ω) appearing in the convolutional representa-
tion may be taken to be identical to that determining the multipole coeﬃcients in the spherical wave
expansion.

C. Hilbert Space Results

In the non-paraxial case, the wave-equation is no longer equivalent to a time-dependent Schrodinger
equation, although the source-free Helmholtz equation is analogous to a time-independent, free-particle
Schrodinger equation, albeit typically with non-normalizable, scattering-state boundary conditions.

29

(168)

(170)

(171)

However, when convenient, we can still recast our non-paraxial mathematical results into a Hilbert-
space-like formalism. Without a distinguished optic axis, we extend the spatial dependence of spinors
and observables from two dimensions to three dimensions, each coordinate now treated on an equal
footing, and we allow for more general polarization bases, using some given family (labeled here by n,
standing for some set of integer indices or “quantum numbers”) of smooth, possibly complex-valued
vector ﬁelds ˆǫn
1, 0, +1) which constitute a local orthonormal triad at
every spatial position ζ :

s (ζ; ω) (still indexed, say by s =

−

ǫn
s (ζ; ω)∗

ǫn
s′ (ζ; ω) = δs s′ .

·

For example, we could use, as convenient, a ﬁxed Cartesian basis ˆx, ˆy, ˆz; the spherical-coordinate basis
ˆζ, ˆθ, ˆϕ; the helicity basis ˆe+, ˆe
, ˆz (also known as the spherical basis because of its role in deﬁning
−
spherical tensors, not to be confused with the above basis vectors for spherical coordinates); normalized
1 and m, i.e., ˆXℓ m( ˆζ), ˆNℓ m( ˆζ), ˆZℓ m( ˆζ); or a
vector spherical harmonic basis vector ﬁeld for some ℓ
, ˆsa, ˆba.
natural radiation basis ﬁeld derived from some reference vector potential a(ζ; ω), namely ˆεa

≥

⊥

Much of the “quantum”-like formalism developed in the paraxial case can be generalized in the obvious
C3,
way to a three-dimensional Hilbert space
and will not be reproduced here, except to note that we will now denote the (possibly generalized, i.e.,
non-normalizable) eigenket corresponding to the vector ﬁeld g(ζ; ω) by
, and the generalized 3D
position/polarization eigenkets by

H3D consisting of square-integrable functions g : R3

s (ζ; ω)
i
g(ω)
s (ζ; ω)
i
|
where the Hilbert-space inner product now involves integration over all spatial variables:

ζ; ˆǫn
|
ζ; ˆǫn
h

, such that

g(ω)
i
|

s (ζ; ω)∗

g(ζ; ω),

= ˆǫn

(169)

→

·

g
h

g′
|

i

=

Z

d3ζ g(ζ)∗

g′(ζ).

·

Now, consider the Hilbert-space operator K = K(ω) deﬁned via its spatial/polarization kernel:

K(ζ, s; ζ′, s′; ω)

ζ; ˆǫn

s (ζ; ω)

K(ω)
|

|

≡ h

ζ′; ˆǫn

s′ (ζ; ω)

i ≡ −

1
2 iω δs s′ D(ζ; ζ′; ω),

which is given explicitly by

K(ζ, 0; ζ′, 0; ω) =

sinc (k

ζ

ζ′

) = ω2

jℓ(kζ)jℓ(kζ′)∗Yℓ m( ˆζ)Yℓ m( ˆζ′)∗.

(172)

ω
4π

k

−

k

Xℓ ,m

The kernel is seen to be real-valued and symmetric in all spin/spatial arguments, so the corresponding
operator K = K † is Hermitian. Because the kernel acts as the identity on polarization degrees of freedom,
the operator is independent of spin observables, and may be formally written as a function only of spatial
observables. In fact, because the kernel is translationally and rotationally invariant, depending on the
spatial coordinates only through
, K must be a function solely of the momentum magnitude
P3Dk

∂2. Crucially, K is also positive semideﬁnite, in the sense that

= √

ζ′

−

−

ζ

k

k

k

g(ω)
h

K(ω)
|
|

g′(ω)
i

=

d3ζ

d3ζ′ K(ζ, 0; ζ′, 0; ω) g(ζ; ω)∗

g(ζ′; ω)

·

0,

≥

(173)

Z

Z

for any complex vector ﬁeld g(ζ; ω) which is suﬃciently well-behaved for the integral to exist. This can
be seen most easily from the diagonal expansion in spherical waves:

g(ω)
h

K(ω)
|

|

g′(ω)
i

= ω2

d3ζ ˆǫn

s (ζ)∗

g(ζ; ω)jℓ(kζ)∗Yℓ m( ˆζ)∗

·

0.

≥

(174)

s (cid:12)
Z
Xℓ ,m X
(cid:12)
(cid:12)
(cid:12)

It is also a direct consequence of the well-known Bochner theorem, which says that a continuous function
in real-space is nonnegative deﬁnite as a spatial kernel if and only if its Fourier transform is proportional
to a positive measure over reciprocal space (and positive deﬁnite if this measure is everywhere non-zero).
Transforming to the scaled momentum (i.e., wavevector, or reciprocal-space) representation where the
operator K is diagonal, we ﬁnd:

K(ω) = πδ(P3D ·

P3D −

ω2),

(175)

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)

30

(176)

(178a)

(178b)

(179)

(180a)

(180b)

so that

g(ω)
h

K(ω)
|

|

g′(ω)
i

= π

d3k

2 δ(
g(k; ω)
k
|
|

k

k

2

−

ω2)

0,

≥

Z

where k is the scaled wavevector conjugate to ξ, and g(k; ω) is the (scaled) spatial Fourier transform
of g(ζ; ω). Note that K(ω) acts to restrict the spectral content of any vector ﬁeld g(ζ; ω) in its domain
2. However, K is not
to the manifold of wavevectors satisfying the vacuum dispersion relation ω2 =
idempotent, so cannot be considered a true projection.

k

k

k

That K(ζ; ζ′; ω) is only positive semideﬁnite and not strictly positive deﬁnite is a consequence of the
well-known existence of non-radiating sources for the Helmholtz problem, which invariably complicate
uniqueness results and inverse-scattering calculations. Speciﬁcally, suppose we take

Θ(ζ0 −
for any allowed ℓ and m, some ζ0 > 0, and any well-behaved, non-trivial scalar function gℓ(kζ) which is
chosen to satisfy

ζ)gℓ(kζ)Xℓ m(θ, ϕ),

g0(ζ; ω) = g0

(ζ; ω)

(177)

∝

⊥

dζ ζ2gℓ(kζ)jℓ(kζ) = 0,

dζ ζ2gℓ(kζ)gℓ(kζ) > 0,

ζ0

Z0
ζ0

Z0

Z

Z

Z

Then using the spherical wave expansions, it immediately follows for this source that, for all ζ,

χ0(ζ; ω) =

d3ζ′ D(ζ; ζ′; ω)g0(ζ′; ω) = 0;

and also, anywhere in the extra-source region, i.e., for ζ > ζ0,

aout

0 (ζ; ω) =

d3ζ′ Gret(ζ; ζ′; ω)g0(ζ′; ω) = 0,

ain

0 (ζ; ω) =

d3ζ′ Gadv(ζ; ζ′; ω)g0(ζ′; ω) = 0,

and indeed no radiation is produced by g0 acting either as a real, time-reversed, or eﬀective (homoge-
neous) source. Any such vector ﬁeld g0(ζ; ω) corresponds to a ket
in the nullspace of the operator
K; i.e., K(ω)

g0(ω)
i
|

= 0.

g0(ω)
i
|

The nullspace of the Hermitian operator K is therefore inﬁnite-dimensional (and in fact non-
denumerable). Modulo some (admittedly thorny) normalization issues due to the unbounded nature
of K, the basis of homogeneous spherical waves solutions (149) are the orthogonal eigenfunctions of K in
the position basis corresponding to non-zero eigenvalue. Although it would involve more mathematical
detail than justiﬁed in this presentation, the properties and behavior of K can be analyzed rigorously
within the theory of Reproducing Kernel Hilbert Spaces (RKHS), where the spherical wave expansion of
the kernel emerges as a consequence of Mercer’s theorem [38]. In a similar manner, we may deﬁne Green
operators Gret(ω) and Gadv(ω) from their spatial representations; these operators are complex-symmetric,
but neither Hermitian nor positive semideﬁnite.

⊥

(ζ; ω), g(ζ; ω), and g

However, the problems encountered with normalization cannot be completely ignored. While this Hilbert
space
H3D, equipped with the Euclidean/L2 inner product, is the natural setting for the source-terms such
as j(ζ; ω), j
(ζ; ω), it is not always a comfortable home for the vector potentials
a(ζ; ω) or χ(ζ; ω) or the corresponding ﬁelds, since the presence of far-zone radiation ﬁelds, falling
oﬀ like O(1/ζ), implies that the vector potentials and ﬁelds are not normalizable with respect to this
inner product, so do not strictly belong to the Hilbert space
H3D. However, they may be approximated
arbitrarily closely (point-wise) by vector ﬁelds in the Hilbert-space, and inner products between radiation
and sources, e.g.,

will exist for allowed current densities, which must be localized.

⊥

a(ω)
j(ω)
i
|
h

31

The lack of nomalizability may be traced to the fact that radiation ﬁelds can contain, in principle, an
inﬁnite amount of energy when integrated over all space, while transmitting only a ﬁnite amount of
power. If necessary, we could use the familiar regularizing device of introducing a ﬁnite “quantization”
volume V (ζQ) together with periodic or conducting-wall boundary conditions, and then take the limit
at the very end of the calculation. For the currently envisioned application, this is not terribly
ζQ → ∞
convenient, as we are interested primarily in the far-ﬁeld from the start. Alternatively, we can choose
a diﬀerent inner product, which eﬀectively normalizes the radiation ﬁelds based on power (or power
spectral density) rather than energy. We can deﬁne a Hilbert space
Hout spanned by the basis consisting
of outgoing solenoidal vector spherical waves, with an inner product deﬁned as a Euclidian dot product
on the multipole expansion coeﬃcients:

(a(ω) , a′(ω))out =

aE
∗ℓ m(ω)a′

ℓ m(ω) + aM

∗ℓ m(ω)a′

E

M

ℓ m(ω)

.

(181)

Xℓ m

(cid:2)

(cid:3)

The exact relationship between this inner product and the scaled power spectral density will be seen
shortly, but it should be apparent that this quantity may be expressed soley in in terms of far-ﬁeld
data, rather than on the ﬁeld throughout all space, and physical radiation ﬁelds, with ﬁnite power,
will be normalizable in the sense (a(ω) , a(ω)) <
Hout
∞
may be deﬁned in an exactly analogous manner for incoming-wave solutions, such as a(ζ; ω)∗. Complex
conjugation provides a natural isometry between them, or instead one may use the mapping which simply
swaps the spherical Hankel functions h(1)(kr) and h(2)(kr) in the spherical wave expansions without
changing the multipole expansion coeﬃcients or the vector spherical harmonics. Strictly outside the
support of the sources (if any), any solenoidal solution ψ to the vector Helmholtz equation (homogeneous
or inhomogeneous), of ﬁnite power but with otherwise arbitrary boundary conditions, may be expressed
as the superposition of incoming and outgoing spherical waves, so it necessarily lies in the Hilbert space
Hout ⊕ Hin. Thus, we can in this case uniquely decompose (for ζ > ζ2) any such solution ψ(ζ; ω) as

. An isomorphic Hilbert space

Hin ≡ H

∗out ∼=

ψ(ζ; ω) = ψout(ζ; ω) + ψin(ζ; ω),

(182)

where ψout and ψin are, respectively, the outgoing and incoming components of the vector ﬁeld, in the
sense that they satisfy the appropriate Sommerfeld boundary conditions as ζ
. The inherited inner
product is given by

→ ∞

(ψ(ω) , ψ′(ω)) = (ψout(ω) , ψ′

out(ω))out + (ψin(ω) , ψ′

in(ω))in .

(183)

Our approximating “trial” vector potentials χ will lie in the proper Hilbert subspace
Hhom (
Hout ⊕ Hin,
consisting of source-free solutions which are regular everywhere in space. This space of homogeneous
Hin, as can be seen
solutions is also isomorphic to the outgoing or incoming wave spaces:
by imagining the mapping that replaces, in the spherical wave expansions, each real-valued spherical
Bessel function jℓ(kr) with the corresponding complex spherical Hankel function h(1)(kr) or h(2)(kr),
respectively, without altering the angular dependence or the expansion coeﬃcients.

Hhom ∼=

Hout ∼=

D. Energy Balance and Poynting Flux

Using the Helmholtz equation, gauge constraint, and various vector identities, one can derive a general-
ized impedance relation, or complexiﬁed power-balance equation, for the ﬁelds in the frequency domain
over any arbitrary spatial region R, and valid for any consistent boundary conditions imposed on the
radiation at spatial inﬁnity:

d3ζ [j

⊥

(ζ; ω)∗

εa

(ζ; ω)] + iω

·

⊥

d3ζ

εa

(ζ; ω)
k

⊥

k

2

2

ba(ζ; ω)
k

− k

+

d2σ [ ˆn

sa(ζ; ω)] = 0, (184)

ZR

ZR

(cid:2)

Z∂R

(cid:3)

·

where ˆn = ˆn(ζ) is a outward normal unit vector on the boundary surface at ζ
∂R. This relation is
quite similar to the usual conservation law derived in textbooks from the time-harmonic formulation of
Maxwell’s equations [2, 5], except that it involves only the solenoidal components of the sources and the
ﬁelds – the longitudinal component j
of the current density and the scalar potential φ and its derivatives
k
do not appear.

∈

32

(185)

In the most general, inhomogeneous case, this relation implies:

Re

−

ZR

d3ζ [j∗
⊥·

εa

⊥

] = Re

d2σ [ ˆn

sa] ,

·

Z∂R

which is an expression of time-averaged energy conservation, relating the (negative) rate of mechanical
work done on the solenoidal sources within R to the rate of energy escape in the form of radiation
through the boundary ∂R. If we let R = V (ζ2) for any ζ2 > ζ1, we can replace j
with the the full
current density j on the right-hand-side, and this becomes

⊥

P

∂
∂ω

−

mech[εa

; j](ω)

⊥

≡ −

Re

d3ζ [j∗

εa

] = Re

·

⊥

d2σ [ ˆn

sa]

·

≡

P

∂
∂ω

EM[a](ζ2; ω)

(186)

Z

Z∂V (ζ2)

The radiated power spectral density is independent of radius ζ2 as long as ζ2 > ζ1, as assumed, so we
on the left-hand-side whenever convenient. Using Green’s Second Identity and other
may take ζ2 → ∞
vector identities, the spectral density of the radiative ﬂux can also be written in the following useful
forms within the Coulomb gauge:

P

∂
∂ω

EM[a](ζ2; ω) =

d3ζ

a

2a∗

·∇

a∗

−

·∇

2a

=

d2σ [a

( ˆn

∂)a∗

a∗

( ˆn

∂)a] .

(187)

·

·

−

·

·

iω
2
ZV (ζ2)

(cid:2)

iω
2
Z∂V (ζ2)

(cid:3)

Similarly, if a(ζ; ω) is the exact solenoidal radiation corresponding to j
arbitrary solenoidal solution to the source-free Helmholtz equation, then for ζ2 > ζ1,

⊥

(ζ; ω), and χ(ζ; ω) is any

P

∂
∂ω

−

mech[εχ

; j](ω) =

⊥

d3ζ

χ

∂2a∗

a∗

∂2χ + a

∂2χ∗

χ∗

∂2a

−

·

·

−

·

( ˆn

∂)a∗

a∗

( ˆn

∂)χ + a

( ˆn

∂)χ∗

χ∗

( ˆn

∂)a] .

·

−

·

·

·

·

−

·

·

(cid:3)

(188)

iω
2

ZV (ζ2)

iω
2
Z∂V (ζ2)

=

(cid:2)
d2σ [χ

·

·

ω2χ), the
For any such solution χ(ζ; ω) to the homogeneous Helmholtz equation (i.e., where ∂2χ =
Lorentz invariant
vanishes everywhere (as can be seen easily, for example, from an
expansion in transverse plane waves, or from the spherical wave basis), and from (184) or (188) we have:

− k

⊥k

εχ

bχ

−

k

2

2

d2σ [ ˆn

sχ] =

d3ζ [∂

sχ] =

d3ζ

χ

∂2χ∗

χ∗

∂2χ

= 0.

(189)

·

·

iω
2

ZR

·

−

·

(cid:2)

(cid:3)

That is, both real and imaginary parts of the Poynting ﬂux vanish when integrated over any closed
surface, reﬂecting the fact that, as is intuitively evident from the convolution representation (164) or
from a plane-wave decomposition, any vector potential which satisﬁes the homogeneous wave equation
everywhere must, in fact, result in an equal amount of averaged radiative ﬂux passing into and out from
any closed surface, without any dissipation of ﬁeld energy or reactive storage of energy in localized,
quasi-static ﬁelds.

As we saw above, however, we can locally decompose the homogeneous ﬁelds into what represent, or at
least eventually (as ζ

) become, separately outwardly-radiating and inwardly-radiating waves:

→ ∞

χ(ζ; ω) = χout(ζ; ω) + χin(ζ; ω),

(190)

where for all ζ
. This is most easily ac-
complished simply by separating the fundamental representation into retarded (outgoing) and advanced
(incoming) parts:

0 as ζ2 → ∞

∂V (ζ2), Re

0 and Re

ˆn(ζ)

ˆn(ζ)

sout
χ

sin
χ

≥

≤

∈

(cid:2)

(cid:3)

(cid:3)

(cid:2)

·

·

k
(cid:2)

Z∂R

(cid:3)

ZR

χout(ζ; ω) =

d3ζ′ Gret(ζ; ζ′; ω)g

(ζ′; ω);

⊥

Z

(191)

33

(192)

and

χin(ζ; ω) =

d3ζ′ Gadv(ζ; ζ′; ω)g

(ζ′; ω).

⊥

−

Z

Note that these vector potentials separately satisfy the homogeneous equation only for ζ > ζ0, but
satisfy the inhomogeneous equation everywhere for the appropriate eﬀective source terms and speciﬁed
boundary conditions. Although χin(ζ; ω) involves the time-reversed (advanced) Green function, it is not
the time-reversal of χout(ζ; ω), because it involves the negation, not complex conjugation, of the eﬀective
(ζ; ω). Indeed, the conjugate wave χin(ζ; ω)∗ may be interpreted as the usual outgoing radiation
source g
from the eﬀective source

(ζ′; ω)∗.

g

⊥

−

⊥

Using the symmetry of the Green functions and a simple change of variables, it is easily shown that for
any ζ2 > ζ0,

P

∂
∂ω

EM[χout](ζ2; ω) =

P

∂
∂ω

; g](ω) =

d3ζ

d3ζ′ K(ζ; ζ′; ω) g

(ζ; ω)∗

g

(ζ′; ω)

⊥

·

⊥

(193)

−
g
h

=

(ω)

⊥

mech[εout
χ
⊥
g

K(ω)
|
|

Z
0,

Z

(ω)

⊥

i ≥

(ζ; ω) is a non-radiating source at frequency ω. In the same manner, we

which vanishes if and only if g
also ﬁnd

⊥

P

∂
∂ω

EM[χin](ζ2; ω) =

P

∂
∂ω

mech[εin
χ

−

;

g](ω) =

d3ζ

d3ζ′ K(ζ; ζ′; ω) g

(ζ; ω)∗

g

(ζ′; ω)

⊥

·

⊥

(194)

=

g

(ω)

− h

⊥

−
g

⊥
K(ω)
|
|

(ω)

⊥

i ≤

−
Z
0,

Z

also vanishing if and only if g

(ζ; ω) is a non-radiating source. Thus, we see that, as anticipated,

⊥

P

∂
∂ω

EM[χout](ζ2; ω) =

P

∂
∂ω

EM[χin](ζ2; ω) = ∂
∂ω

P

EM[χin

∗](ζ2; ω)

0.

(195)

≥

It then follows that

1
2

∂
∂ω

P

−

mech[εχ

; g](ω) =

⊥

1
2 Re

−

d3ζ [g∗

εχ

] = 1
2

⊥

·

d3ζ [g∗

εχ

]

⊥

·

Z
d3ζ

Z
d3ζ′ iωD(ζ; ζ′; ω) g

(ζ; ω)∗

g

(ζ′; ω)

⊥

·

⊥

(196)

Z
d3ζ

Z
d3ζ′ K(ζ; ζ′; ω) g

Z
(ω

Z
g

h

⊥

K(ω)
|
|

g

(ω)
i

⊥

=

−

(ζ; ω)∗

g

(ζ′; ω)

⊥

P

∂
∂ω

⊥

·
mech[εout
χ
⊥

; g](ω)

0,

≥

−

= 1
2

=

=

which is the generalization of the paraxial result (91).

If we take g(ζ; ω) = j(ζ; ω) to be the physical current density of interest, then the homogeneous approx-
imation

agrees exactly in its outgoing components with the actual radiation:

χj(ζ; ω) =

d3ζ′ D(ζ; ζ′; ω)j

(ζ′; ω)

⊥

Z

χout

j (ζ; ω) = a(ζ; ω),

(197)

(198)

but in order to actually satisfy the homogeneous Helmholtz equation everywhere, it must possess an equal
magnitude of net power in the corresponding (i.e., conjugate) incoming modes making up χin(ζ; ω), power
which will ﬂow in the opposite direction through any surface enclosing the sources. This extra power
appears as extra work which would be done by the actual source charges on these incoming ﬁelds, if they
were present. (These advanced ﬁelds do not lead to absorption by the sources making up j because,
j∗, not j itself.)
again, they are the time-reversal of the retarded ﬁelds which would be produced by
Using Green’s identities and the governing Helmholtz equations, one can show that this homogeneous

−

34

(200a)
(200b)

(200c)

(200d)
(200e)
(200f)

(201a)

(201b)

(201c)

(201d)

(202a)

(202b)

solution may also be formally expressed in the Kirchoﬀ-integral form, only with the Green function
Gret(ζ; ζ′; ω) replaced with the fundamental homogeneous solution D(ζ; ζ′; ω) :

χj(ζ; ω) =

dσ′

a(ζ′; ω)( ˆn′

∂′)D(ζ; ζ′; ω)

D(ζ; ζ′; ω)( ˆn′

∂′)a(ζ′; ω)

.

(199)

·

−

·

Z∂V (ζ3)

(cid:2)

(cid:3)

Unlike the inhomogeneous case, this remains valid for any boundary radius ζ3 > 0 and any observation
position ζ.

Not surprisingly, the homogeneous approximation χj(ζ; ω) to a(ζ; ω) is just the result of the above-
Hhom, involving the replacement
mentioned one-to-one mapping between the isomorphic spaces
of each “outgoing” spherical Hankel function h(1)
ℓ (kζ) with the corresponding “standing-wave” spherical
Bessel function jℓ(kζ) in the spherical wave expansion for a(ζ; ω), without altering any of the multipole
expansion coeﬃcients or basis vector ﬁelds for the angular dependence. Schematically, we have:

Hout and

We expect that this χj(ζ; ω) is in some sense the closest possible homogeneous approximation to a(ζ; ω),
which will be conﬁrmed below by the non-paraxial form of the Maximum-Power Variational Principle.

We can also express the various radiated power spectral densitities directly in terms of the multipole
. Asymptotically,
expansion coeﬃcients or associated inner product, by using (187) in the limit ζ2 → ∞
i.e., for kr

ℓ, the limiting forms of the spherical Bessel, Neumann, and Hankel functions are:

≫

Hout → Hhom
→

χj(ζ; ω)

a(ζ; ω)
h(1)
ℓ (kζ)
Wℓ m( ˆζ)
aE
ℓ m(ω)
aM
ℓ m(ω)

jℓ(kζ)
Wℓ m( ˆζ)
ℓ m(ω) = aE
χE
ℓ m(ω) = aM
χM

→

→
→
→

ℓ m(ω)
ℓ m(ω).

jℓ(kr)

→

nℓ(kr)

→ −

h(1)
ℓ (kr)

h(2)
ℓ (kr)

→

→

,

,

ℓπ
2 )

ℓπ
2 )

sin(kr

−
kr
cos(kr
−
kr
i)ℓ+1 e+ikr
(
kr
−
ikr
(+i)ℓ+1 e−
kr

,

.

ψout(ζ; ω)

ψin(ζ; ω)

1
2

1
2

→

→

i
k

∂
∂ζ

1

−
1 + i
k

∂
∂ζ

(cid:17)

(cid:17)

(cid:16)

(cid:16)

ψ(ζ; ω),

ψ(ζ; ω).

Examining the form of the Sommerfeld radiation conditions, we see that, asymptotically as kζ
,
→ ∞
any vector potential ψ(ζ; ω) (not necessarily a source-free solution) may be locally decomposed into its
incoming and outgoing components on the spherical surface ∂B(ζ) by the projections:

Equipped with these results, it is straightforward to show that for any solution ψ
outgoing power spectral density is given by

∈ Hout ⊕ Hin, the

P

∂
∂ω

EM[ψout](

; ω) = lim
ζ2→∞

∞

d2σ

ψout

( ˆn

∂)ψout

∗

ψout

∗

( ˆn

∂)ψout

·

·

−

·

·

iω
2
Z∂B(ζ2)
iω
8
Z∂B(ζ2)
iω
8

ζ2
2

= lim

ζ2→∞(cid:20)

= lim

ζ2→∞ (cid:20)

(cid:2)

(cid:2)

d2σ

(1

i
k

∂
∂ζ )ψ

( ∂
∂ζ −

·

−

i
k

∂2
∂ζ2 )ψ∗

+ c.c

(203)

(cid:3)

(cid:21)
(cid:3)

dϕ

dθ sin θ

(1

i
k

∂
∂ζ )ψ

( ∂
∂ζ −

·

−

i
k

∂2
∂ζ2 )ψ∗

+ c.c,

Z

Z

(cid:2)

(cid:21)

(cid:3)

35

(205)

(206)

which, after a little algebra, reduces to the inner product over the outgoing multipole coeﬃcients:

P

∂
∂ω

EM[ψout](

; ω) =

∞

ψE (out)

ℓ m (ω)

2

+

ψM (out)

ℓ m (ω)

2

Xℓ m h(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

i

(cid:12)
(cid:12)

= (ψout(ω) , ψout(ω))out ≥

0,

(204)

with equality (vanishing outgoing power) in the last step if and only if ψout(ζ; ω) vanishes identically.
Similarly, we ﬁnd

so we may write

P

∂
∂ω

EM[ψin](

−

; ω) = (ψin(ω) , ψin(ω))in ≥

∞

0,

(ψ(ω) , ψ(ω))

(ψout(ω) , ψout(ω))out + (ψin(ω) , ψin(ω))in

EM[ψout](
P

EM[ψout](

∞

; ω)

; ω)

∞

−

∂
∂ω
+

P

∂
∂ω

EM[ψin](
P

∞
EM[ψin](

; ω)

; ω)

.

∞

P

≡
= ∂
∂ω
∂
∂ω

=

(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
Hin, and

(cid:12)
(cid:12)

The inner products previously introduced for
Hout ⊕ Hin are just equal, respectively,
Hout and
to the (scaled) outgoing power spectral density, the absolute value of the incoming spectral density, and
the magnitude of total (not net) in-ﬂowing and out-ﬂowing power spectral density, passing through an
arbitrarily remote boundary somewhere outside the support of the (real or eﬀective) sources. Choosing
ψ = χj, the relations (204) and (205) provide an explicit verﬁcation of (195). As an aside, we note that
these separate incoming and outgoing power spectral densities and their (incoherent) sum, are often of
more physical interest than the net power ∂
EM[ψ](
; ω). For UV and lower frequencies, detectors
∂ω
(such as photomultipliers or solid state photoelectric devices) are typically directionally sensitive, in
2π, so measurements of the power in the radiation ψ will
the sense of an acceptance solid angle Ω
≤
∂
, depending on
typically reveal something closer to either
∂ω
the orientation, (or some fraction thereof, with less than full 4π solid-angular coverage of the localized
(cid:12)
source), rather than ∂
; ω). In the X-ray regime, shielding is diﬃcult and detectors are often
(cid:12)
∂ω
not directionally sensitive, and the response will likely depend on the total ﬂuence into the detector
volume, i.e., on

EM[ψout](

EM[ψin](

EM[ψout](

EM[ψin](

EM[ψ](

EM[ψ](

; ω).

; ω)

; ω)

; ω)

; ω)

∂
∂ω

∞

∞

∞

∞

or

+

P

P

P

P

P

P

P

(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

rather than ∂
∂ω

∂
∂ω

∂
∂ω

∞

∞

∞

(cid:12)
(cid:12)

(cid:12)
In a similar fashion, we may formally express the spectral density of mechanical work in terms of the
(cid:12)
multipole coeﬃcients for the exact radiation a and the homogeneous approximant χ, by using (188),
choosing a spherical boundary ∂B(ζ2) and letting ζ2 → ∞
mech[εχ

. After the algebraic dust settles, we ﬁnd

; j](ω) = Re

[χE

ℓ m(ω) + χM

ℓ m(ω)∗aM

ℓ m(ω)∗aE

ℓ m(ω)]

P

(cid:12)
(cid:12)

(cid:12)
(cid:12)

1
2

∂
∂ω

−

⊥

(207)

Xℓ m

= Re (χout(ω) , a(ω))out

In eﬀect, we have managed to re-express the three-dimensional, “volume” inner product
in
terms of the two-dimensional, “boundary” inner product (χout(ω) , a(ω))out . If we choose χ = χj, then
by applying (204), the power spectrial density in the form (207) is seen to satisfy (196) explicitly.

a(ω)
j(ω)
i
|
h

E. Variational Principle

Our general variational principle follows directly from the nonnegative-deﬁniteness of the operator K(ω),
i.e., equation (173), and the above energy conservation considerations. Re-tracing the standard proof of
the Cauchy-Schwarz inequality, we ﬁnd that, with a little extra care, it goes through almost unchanged if
we replace the positive deﬁnite inner product with a positive-semideﬁnite pseudo-product. In particular,
with the bilinear form associated with K(ω), one can show

g(ω)

K(ω)
|
with strict equality if and only if there exist constants δ, δ′, δ0 ∈
source g0(ζ; ω) which is not identically zero but is otherwise arbitrary, such that

K(ω)
|
|

K(ω)
|
|

≤ h

g′(ω)

g′(ω)

g(ω)

g(ω)

g′(ω)
i

i h

|h

i|

|

,

2

C, not all zero, and a non-radiating

δ g(ζ; ω) + δ′ g′(ζ; ω) + δ0 g0(ζ; ω) = 0.

(208)

(209)

We also have, for any complex number c

C, the inequalities

∈
Re[c]

Re[c]

c
| ≤ |

|

,

≤ |

(ζ; ω) to be the solenoidal
with overall equality if and only if c is real and nonnegative. Choosing g′ = j
source responsible for the actual radiation a(ζ; ω) and g = g
(ζ; ω; α) to be an eﬀective source cor-
responding to a solenoidal, source-free trial vector ﬁeld χ(ζ; ω; α) depending on certain variational
parameters collected in the vector α, these inequalities yield:

⊥

⊥

1
2

∂
∂ω

P

−

mech[εχ

; j](ω; α)

⊥

1
2

∂
∂ω
P

∂
(cid:12)
∂ω
(cid:12)

≤

≤

P

mech[εχ

; j](ω; α)

⊥
EM[χout](ζ2; ω; α)

1/2
(cid:12)
(cid:12)

P

∂
∂ω

EM[a](ζ2; ω)

1/2

,

with overall equality assuming ∂
∂ω

P

(cid:2)
EM[a](ζ2; ω)

(cid:3)
= 0, if and only if

(cid:2)

(cid:3)

χout(ζ; ω; α)

a(ζ; ω).

∝

(In the trivial case where ∂
∂ω
for any χ(ζ; ω) which is Hilbert space orthogonal to j

P

EM[a](ζ2; ω) = 0, equality is achieved trivially for χ(ζ; ω) = 0 or indeed

(ζ; ω).)

⊥

In practice, we can obtain an actual variational approximation with one of two diﬀerent but ultimately
equivalent procedures, each arriving at the same ﬁnal result when optimizing over equivalent families of
trial solutions. In the ﬁrst approach, we may partition the variational parameters as α = (η0, θ0, α′)T ,
where α′ = (α′1, α′2, . . . , )T , and consider a restricted family of solenoidal, homogeneous trial solutions
v(ζ; ω; α′) normalized to unit power:

P

∂
∂ω

EM[vout](ζ2; ω; α′) = 1,

(213)

or really to any conveniently-chosen but constant value. (Recall that this power is independent of the
for ﬁxed
precise choice of surface V (ζ2) as long as ζ2 > ζ1.) We then maximize
output power, in order to determine the optimal parameter values ˜α′ = ˜α′[j](ω) and therefore the
relative shape (spatial proﬁle and polarization) of the radiation. Once the relative proﬁle is determined,
we then renormalize this trial solution, taking

; j](ω; α′)

mech[εv

∂
∂ω

P

(cid:12)
(cid:12)

(cid:12)
(cid:12)

⊥

χ(ζ; ω; ˜α) = ˜η0ei˜θ0 v(ζ; ω; ˜α′),

for some real phase ˜θ0, 0
0. To maximize the mechanical
θ0 < 2π, and nonnegative amplitude ˜η0 ≥
work term, the overlap integral (3D inner product) between (scaled) solenoidal electric ﬁeld and current
density must necessarily be real and negative, so ˜θ0 is chosen so as to ensure

≤

−

1
2 Re

i˜θ0

e−

h
e−

i˜θ0

Im

h

εχ
h
εχ
h

j(ω)
(ω; ˜α′)
i
|
j(ω)
i
|

(ω); ˜α′

⊥

⊥

0

≥
= 0.

i

i

Finally , the positive amplitude ˜η0 > 0 is chosen to ensure energy balance between the power (spectral
density) in the approximate outgoing ﬁelds and the work which would be done on these ﬁelds, if present
in the region of the sources, by those actual sources:

i˜θ0

1
2 η0e−

−

εχ
h

j(ω)
(ω)
i
|

⊥

= η2
0

∂
∂ω

P

EM[vout](ζ2; ω; ˜α),

or

˜η0 = −

P

1
2

∂
∂ω
P
∂
∂ω

; j](ω; ˜α′)

mech[εχ
⊥
EM[χout](ζ2; ω; ˜α)

.

Note that under the assumptions of energy conservation given the sources, the overall amplitude, set by
˜η0, is uniquely determined, and the overall phase ˜θ0 is determined modulo 2π, because the mechanical
work done on/by the sources is linear in the ﬁelds, but the radiated power is quadratic in the ﬁelds.
As in the paraxial case, we can also interpret this as a maximization of the small-signal, no-recoil gain

36

(210)

(211)

(212)

(214)

(215a)

(215b)

(216)

(217)

6
which would be experienced by the trial ﬁeld if it were to be incident on the sources. Upon substituting
back into the Cauchy-Schwarz inequality, canceling common terms, and squaring, we deduce

1
2

∂
∂ω

P

−

mech[εχ

; j](ω; ˜α)

⊥

P

∂
∂ω

≤

EM[χout](ζ2; ω; ˜α),

χout(ζ; ω; ˜α) = a(ζ; ω),

with equality if and only if

or equivalently,

χ(ζ; ω; ˜α) = χj(ζ; ω) =

d3ζ′ D(ζ; ζ′; ω) j

(ζ; ω).

⊥

Z
Thus, we see that the variational approximation χout(ζ2; ω; ˜α) may also be obtained more directly from
a simultaneous optimization, with respect to all parameters in α, of the outgoing power, subject to the
constraint of energy conservation:

˜α = arg max

P

∂
∂ω

EM[χout](ζ2; ω; α)
i
; j](ω; α) = ∂
∂ω

mech[εχ

h
P
∂
∂ω

1
2

⊥

α

−

s.t.

P

EM[χout](ζ2; ω; α).

This is our desired result. As anticipated, we have arrived at a variational principle which holds in the
general, non-paraxial case, which is exactly analogous to that found previously in the paraxial limit.
Unfortunately, there seems to be no simple way to express the constrained optimization problem (221)
as an unconstrained maximization of a ratio between the mechanical work and radiated power (or some
functions thereof).

It is also instructive to also see how this all works out explicitly in the spherical wave basis. Applying
the usual Cauchy-Schwarz inequality directly in

Hout, and using equations (204) and (207), we have

P

1
2

∂
∂ω

mech[εχ

⊥

−

; j](ω; α) = Re (χout(ω; α) , a(ω))out ≤ |
(χout(ω; α) , χout(ω; α))1/2
out (a(ω) , a(ω))1/2
P
; ω)1/2,

(χout(ω; α) , a(ω))out|

EM[χout](

EM[a](

P

out

; ω)1/2 ∂
∂ω

≤
= ∂
∂ω

∞

∞

with overall equality if and only if χout(ω; α) = κ(ω) a(ω) for some positive real scalar κ(ω) > 0, or
equivalently when

aE
ℓ m(ω)
ℓ m(ω; α)
χE

=

aM
ℓ m(ω)
ℓ m(ω; α)
χM

=

1
κ(ω)

> 0.

for all mutlipole coeﬃcients of a(ζ; ω). Imposing the additional energy conservation relation on
χ(ζ; ω; α), this becomes

P

1
2

∂
∂ω

−

mech[εχ

; j](ω; α)

⊥

P

EM[a](

; ω)

∞

≤

with equality if and only if χout(ζ; ω; α) = a(ζ; ω). Because in practice we will not have knowledge of
the actual multipole expansion coeﬃcients for a in situations where we are resorting to a variational
approximation, this “angular-representation” or “boundary-value” formulation is not directly applicable
for calculation, but it does lead directly to the relevant power inequality without any worries about a
semideﬁnite or “pseudo” inner product. We also see that the MPVP follows immediately as a consequence
of the minimum distance property of orthogonal projectors in these multipolar Hilbert spaces: the
variational approximation χ(ζ; ω; ˜α) is simply that which minimizes the distance to the actual solution:

37

(218)

(219)

(220)

(221a)

(221b)

(222)

(223)

(224)

(225)

˜α = arg min

(a(ω)

χ(ω; α) , a(ω)

α

h

−

χ(ω; α))1/2

−

i

within the considered family of solenoidal, source-free, trial waveﬁelds.

V. DISCUSSION

38

Here we assess advantages and limitations of the MPVP, brieﬂy consider possible variations and exten-
sions, and compare the method to other variational techniques commonly encountered in electromagnetic
theory, in particular those which have been used for paraxial radiation problems, laser-plasma interac-
tions, and FEL-type devices.

A. Summary

The derived MPVP (221), valid in the paraxial or non-paraxial regimes, says, in eﬀect, that classical
(accelerating) charges spontaneously radiate “as much as possible,” consistent with energy conserva-
tion. By spontaneous we mean that charges are assumed to follow prescribed classical trajectories
determined by the external ﬁelds and possibly (averaged) quasi-static self-ﬁelds, but are not aﬀected by
recoil/radiation-reaction, multiple scattering, absorption, or other feedback from the emitted radiation
(although arbitrary pre-bunching due to previously-imposed or radiated ﬁelds may be included, if it can
be characterized). The sources are assumed to be localized in space, so that the far-ﬁeld (i.e., radiation
zone , or wave zone) is deﬁned, and at least weakly localized in time, so that Fourier transforms (i.e.,
frequency-domain representations) of the current density exist.
In turn, the radiation, once emitted
by any part of the source, propagates as in free space, without further scattering or absorption. The
optimized trial mode-shape (or more accurately, the outgoing component thereof) is then the best guess,
within the manifold of possibilities allowed by the adjustable parameters (α), of the exact radiation ﬁeld
proﬁle radiated by those prescribed sources, and the optimized outgoing Poynting ﬂux yields a lower
bound on the actual spontaneously-radiated power spectral density at the frequency under consideration
(apart from any numerical/roundoﬀ errors in the computation). The approximation will improve mono-
tonically as additional independent parameters are included to allow for more general envelope shapes.
As with other variational principles, the relative error in the value of the variational functional (here,
the power) at the stationary point is generally smaller than the error in the parameterized trial function
(here, the radiation proﬁle). The adjustable parameters may appear linearly or non-linearly in the trial-
functions; if they are taken to be the linear expansion coeﬃcients in a sum over orthogonal modes, then
the MPVP is equivalent to a truncated basis-set approach. (In the paraxial case, “outgoing” implies
propagation nearly along the optic axis away from the localized sources, deﬁning the “downstream” or
“post-source” direction, while “incoming” means propagating towards the sources from the upstream
direction. In this case, say, a right-going pulse has both ingoing and outgoing components. In the gen-
eral non-paraxial case, “outgoing” implies wavefronts which, at least asymptotically, diverge in time and
propagate away from the localized sources, while “incoming” denotes the reverse, i.e., asymptotically
converging wavefronts propagating towards the sources.)

This variational principle can be variously interpreted according to one’s tastes or application. As
we have seen, the best variational approximation maximizes the radiated power consistent with the
constraint that this energy could have arisen from work extracted from the actual sources.
It also
minimizes a Hilbert-space distance between the actual ﬁelds and the parameterized family of solenoidal,
free-space radiation ﬁelds, and in many cases may actually be regarded as an orthogonal projection into
this manifold of trial solutions. It also maximizes, for each frequency component, the spatial overlap,
or physical resemblance, between the actual current density and the trial ﬁelds, when the latter are
extrapolated back into the region of the sources assuming source-free propagation. Equivalently, one can
say the optimal free-space ﬁeld proﬁle is that which, if it actually were to be incident on the sources,
would maximally couple to the given sources and would experience maximal small-signal gain, and
furthermore the virtual gain delivered would be equal to the estimated power spontaneously radiated.

Whatever the shape of the trial function, and whether the variational parameters appear linearly or
non-linearly, after optimization this proﬁle may be regarded as one of a complete set of solenoidal basis
functions solving the source-free wave equation. After introducing an inner product associated with
the radiated power (not energy), these basis functions can be orthonormalized via a Gram-Schmidt
procedure, leaving the original trial function unchanged. Bessel’s inequality then conﬁrms that the
outgoing power radiated in (the outgoing component of) this one mode can be no greater than the total
outgoing power radiated in all the modes. All this is obvious. What is perhaps more surprising (if we do

39

not think too hard about the Fundamental Theorem of Calculus or its multidimensional generalizations)
is that we can exactly relate the outgoing power radiated in the far-ﬁeld to the “virtual” work which
would be performed by the localized sources on the “source-free extrapolant” of this radiation ﬁeld, as
if it and it alone were present in the region of the source, i.e., to the overlap integral between source
and extrapolated electric ﬁeld, even though the extrapolated ﬁeld may not closely resemble the actual
emitted ﬁeld there, as it must necessarily solve the inhomogeneous wave equation. The factor of 1
2
in the resulting conservation constraint emerges in order to avoid double-counting in the energetics.
The radiated power in the outgoing component of the variational approximation is being related to the
mechanical power which would be delivered by the sources to the full source-free ﬁelds, if they were
actually present in the region of the sources, rather than the actual, inhomogeneous ﬁelds; and, any
wave-ﬁeld satisfying the source-free wave equation everywhere in space must have the power in each
outgoing mode exactly balanced by that in a corresponding incoming mode, or else singularities would
arise somewhere in space. (Without any sources, in the paraxial case, radiation observed to emerge
from, say, the right side of any longitudinal interval must have previously traveled into that interval
from the left. In the free-space non-paraxial case, analogous conclusions can be drawn for plane waves
traveling along any chosen direction, or, thinking in terms of multipole radiation, it is necessary that
any diverging spherical wave must be matched to a converging spherical wave to avoid a singularity at
their common center of wavefront curvature.)

B. Assessment

Again, the present approach involves approximation of the actual radiation ﬁelds by trial modes which
are solenoidal and satisfy the homogeneous (source-free) wave equation. As we are primarily interested
in the net radiation from the given sources observed in the free-space region beyond the sources, it is
appropriate to use solutions of the source-free equation there, but then it is natural, eﬃcient, and even
almost inevitable, in the context of an approximation scheme, to eﬀectively extrapolate the ﬁelds back
into the support of the sources by free-space propagation. (Otherwise, if we could somehow propagate
according to the actual dynamics, we would not need to resort to any approximation – but we would also
be carrying around unneeded information about the near-ﬁelds.) In the paraxial limit, these free-space
solutions are uniquely speciﬁed by the carrier frequency and the (complex) proﬁle in any transverse
plane, which can be decomposed into a convenient, countable set of modes consisting of the eigenmodes
of some quantum-like operator(s). In the general case the solutions are more complicated, but from the
spherical wave expansion, we know at least that they also form a separable Hilbert space, parameterized
by the multipole expansion coeﬃcients. Because there is no known closed-form, analytic solution for
a general focused radiation beam outside the paraxial approximation, the formalism and variational
principle are probably of most use in the paraxial case, although may also be applied, with little added
complication, to cases where the radiation consists of a superposition of multiple beams, each paraxial
individually, but with suﬃciently divergent directions to violate overall paraxiality, or to cases where
higher-order terms in the generalized paraxial (i.e., diﬀraction-angle) expansion are included to describe
a moderately-collimated beam.

The output χ(ζ; ω; ˜α) of the MPVP is therefore actually better considered a variational approximation
to the source-free “embedding” or “extrapolation” χj(ζ; ω) rather than to the actual outgoing vector
potential a(ζ; ω). If the radiation is suﬃciently directional, then the outgoing component χout(ζ; ω; ˜α)
may be determined simply by restricting attention to some ﬁnite solid angle.
In the most general
case, where the “spurious” incoming radiation may overlap with the “physical” outgoing radiation, it is
more diﬃcult to disentangle χout and χin at an arbitrary position. If the spherical wave expansion is
known, then the outgoing projection may be easily determined everywhere in space, but direct use of
the the spherical-waves as the variational basis is not generically expected to prove convenient. (This
would correspond to just using a truncated multipole expansion for the radiation.)
In the far-ﬁeld
limit kζ
, at least, the outgoing component may be determined easily by using the Sommerfeld
projections (202).

→ ∞

Because of these diﬃculties, and remaining mindful of the proportionality between the calculated power
delivered from the source j
(ζ; ω) to the radiation ﬁelds corresponding to the vector potential a(ζ; ω)
or to the ﬁelds of its source-free approximant χ(ζ, ω), one might be tempted to apply the variational

⊥

40

method directly (just without the extra factor of 1
2 ) to outgoing, solenoidal solutions of some conve-
nient inhomogeneous or homogeneous Helmholtz equation. However, purely outgoing-wave, free-space
solutions cannot exist everywhere in space, and will inevitably possess one or more singularities in the
vicinity of the sources, preventing calculation of the required mechanical work integrals. Furthermore,
any solenoidal vector ﬁeld whatsoever, say ψ(ζ; ω), is trivially the solution to some inhomogeneous
Helmholtz equation for some boundary conditions and some solenoidal source, namely, for those bound-
(∂2 + ω2)ψ. Without further
ary conditions satisﬁed by ψ itself, and for a solenoidal source given by
constraints, this class of trial solutions is simply too general to be useful. If we naively apply the MPVP
using homogeneous trial functions, the method will converge not to a but to something proportional
to j, since, for given norm, no other vector ﬁeld can have greater overlap with j than a multiple of j
itself. By using the source-free solutions, we eﬀectively regularize the problem, so that we can converge
to something which maximizes the overlap with the source under the assumption that the trial look like
a radiation ﬁeld, and not a current density.

−

In any case, the method requires not only the parameterization of trial modes but the calculation of
inner products between these trial modes and the current density, or else some other, problem-speciﬁc,
means to determine the absolute level of the power, either analytically, in terms of the free parameters,
or numerically and indeed repeatedly, as the parameters are varied in search of the maximum. One
can easily imagine counter-examples where it is simply easier to work directly with the Li´enard-Wichart
potentials or corresponding expressions for the ﬁelds, than use the variational principle.

We also have some options (or rather, trade-oﬀs) in handling stochastic sources. So far, we have assumed
a speciﬁc, prescribed, deterministic current density j(ζ; τ ), but in practice we must contend with statis-
tical uncertainty in the exact electron trajectories in any one realization, meaning j(ζ; ω) is in principle
stochastic, with statistical properties determined by the phase space distribution of the particle beam (in
the reduced six-dimensional phase space, if we may neglecting direct two-body or higher-order interac-
tions, but in an even higher-dimensional phase space if particle-particle correlations are to be included).
In certain cases, we can get by with using an averaged or course-grained current directly as the source,
without need for further probabilistic considerations. In the Vlasov equation, for example, the ﬁelds that
appear are self-consistent mean ﬁelds, i.e., solutions to Maxwell’s equations for the averaged sources.
The exact ﬁelds are linear in the sources, so it makes no diﬀerence in the end result whether we average
the currents ﬁrst and then calculate the resulting ﬁelds, or calculate the ﬁelds for a general instance of
the currents and then average the result – the averaging procedure will commute with the convolution
over the Green function. (Pragmatically, the former approach will almost always be more eﬃcient if the
average is all we need, since the random variables determining the stochastic shape of the current need
not carried through the convolution, but the latter approach allows calculation of higher-order correla-
tions or moments.) When using the MPVP to approximate the radiation, the averaged trial ﬁelds will
equal the trial ﬁelds from the averaged sources if the variational parameters appear as linear expansion
coeﬃcients in a basis-set expansion, but not, in general, if they occur non-linearly in the trial waveﬁelds.
Convolution is a linear process, but optimization is in general a nonlinear one.

Unfortunately, it is often the case that we desire to estimate the ﬁelds from given sources, then calculate
moments, rather than to determine the ﬁelds from averaged sources. This is particularly true of spon-
taneous wiggler radiation, where the radiation is almost entirely “ﬂuctuational,” both in the sense that
the squared-magnitude of the average ﬁeld is small compared to the average of the squared-magnitude,
and in that the relative variance in the spectral intensity approaches 100% in each suﬃciently narrow
frequency-band for radiation from suﬃciently long, unbunched electron beams. At least second-order
moments are needed to estimate the power spectrum and transverse coherence properties, and fourth-
order moments are necessary if we wish to to estimate the uncertainty in the estimates for these spectra
or coherence functions. Statistical estimates for the power spectral density, based on the moments of
the MPVP trial ﬁelds, cannot in general be guaranteed to be lower bounds, as in the deterministic case.

Before even calculating moments, we may either approximate the radiation ﬁelds from the total current
density using the MPVP, or else apply the MPVP separately to each particle trajectory or family of
trajectories, then superimpose the resulting variational ﬁelds.
If identical, linear basis-sets are used
in the expansions for each particle’s radiation, identical results will be achieved (although the amount
of calculation or computational eﬀort may diﬀer), but if nonlinear variational parameters are used or
even if diﬀerent truncated linear basis sets are used for diﬀerent particles, the two approaches will be
inequivalent.

41

1

A simple example should clarify the issues. Suppose we seek to approximate the wiggler radiation
from some electron beam with negligible normalized energy spread δ
1 but some non-zero transverse
2γ2 λu(1+ 1
u) is the central wavelength of the wiggler radiation in the lab
emittance ǫ > λ0, where λ0 ∼
frame, λu is the wiggler wavelength, and au is the normalized wiggler strength parameter. For radiation
from a single on-axis electron, conﬁned within the relative bandwidth δλ
, where Nu is the number
of wiggler periods, we know the radiation is approximately diﬀraction-limited, with characteristic angle
√Nuγ and a waist located at the midpoint of the wiggler. However, the radiation for the beam as
δθD ∼
λ0
a whole will not be diﬀraction-limited, but will have a transverse degree of coherence Γcoh
4πǫ < 1,
due to averaging, or convolution, over the transverse particle distribution.

λ0 ∼

γ ≪

2 a2

⊥ ∼

1
Nu

1

≈

Suppose ﬁrst we use the total current density as source, and use paraxial Gauss-Hermite or Gauss-
Laguerre modes as trial solutions, with optic axis coinciding with the wiggler axis.
If we attempt
to include, for λ
λ0, only the fundamental Gaussian mode with undetermined waist size w0 and
location ξw, then, regardless of the exact values of the optimized parameters, the approximation cannot
simultaneously predict both the transverse size and angular divergence with accuracy, or equivalently,
the partial transverse incoherence cannot be adequately captured, since we are putting all the power in
4πǫ
a single, diﬀraction-limited transverse mode. In fact, we expect that we must include at least n
λ0
diﬀraction-limited modes to resolve the transverse coherence, even if the average transverse intensity
proﬁle continues to look Gaussian. If the particle phase space distribution function is also taken to be
Gaussian, then the needed overlap integrals in the MPVP may be calculated analytically.

⊥ ∼

Alternatively, we could decompose the current density into contributions from each electron, and employ
a single Gaussian mode for each, only with the optic axis aligned along the average single-particle
trajectory determined by its spatial and angular displacement from the reference orbit. The needed
overlap integrals in this case are easily perfomed, at least for typical values of λ0, γ, and au, where
the transverse spatial extent of an electron orbit is small compared to w0, but after determining the
single-particle MPVP ﬁelds, each with a diﬀerent propagation axis, they all must be superimposed to
determine the full ﬁeld. This can be done easily in the far-ﬁeld so as to determine the angular spectrum,
or at arbitrary positions, to a good approximation, provided the angular deviations for the electrons
remain moderately small, i.e., ∆θ . 1
γ . The result will agree approximately, but not exactly, with the
previous approach. The details of a simpliﬁed version of this calculation will be presented in elsewhere.

C. Extensions

The results derived here are restricted to radiation from localized sources otherwise propagating in
vacuum, which includes the cases of charged particle beams in bending magnets or undulators, but it
would be desirable to extend applicability to more general radiation problems. Using the macroscopic
Maxwell’s equations, it should be straightforward to include a linear, dielectric background ǫ0(ω)
0
which is spatially homogeneous, but possibly frequency-dependent. This would be suﬃcient to handle
many ˇCerenkov radiation problems. To treat some forms of transition radiation and waveguide prob-
lems, piecewise-slowly-varying spatial variations in the dielectric tensor and the possibility of (perfectly)
conducting boundaries should both be included, but in general the “source-free” solutions become dif-
ﬁcult to calculate and parameterize – a single planar jump, or other simple geometries, might still be
tractable.

≥

One important class of geometries for which this formalism should be almost immediately applicable is
that of conducting-wall and/or dielectric waveguides with translational symmetry along the optic axis.
In such circumstances, it is well known [1, 5, 39, 40] that such systems share much of the mathematical
Hilbert-space structure as that elaborated above for paraxial radiation – in particular, solenoidal modes
which are uniquely speciﬁed by their cross-section in any transverse plane, and which are orthonormal-
izable with respect to the natural L2/Euclidean inner product in that plane. (However, these modes
are not complete for the near-ﬁelds, as discussed, for example, in [41].) In addition, it is easily shown
that, in any such waveguides, the power in any source-free, propagating mode, measured suﬃciently far
downstream from a localized source inserted inside the waveguide, can be related to the overlap integral
between the actual current density of the source and the electric ﬁeld proﬁle of this free-space mode
extrapolated back into the support region of the sources as if no sources were present. Modiﬁcations

42

due to ﬁnite conductivity eﬀects might be then treated perturbatively. Again, this is all familiar, and is
exactly analogous to our basis-set expansion technique. What is perhaps not widely appreciated is that
the Cauchy-Schwarz inequality then allows one to transform this basis-set approach into a maximum
principle, where the exact form of the normal modes are not needed.

Attempts to use a more general complex-valued dielectric tensor or index of refraction in order to incor-
porate linear loss or gain will encounter fundamental diﬃculties. Our derivations have exploited the fact
that the free-space retarded and advanced Green functions are just related by complex conjugation in the
frequency domain, but with any dissipation or gain, this time-reversal symmetry will be lost. Ideally, one
would like to fully generalize the treatment to allow for dielectric tensors ǫµν (x, t; ω) with any frequency
dispersion consistent with the Kramers-Kroning relations and/or piecewise-slowly-varying spacetime de-
pendence (inhomogeneity), and possibly anisotropy, in order to model the eﬀects of essentially arbitrary
conducting or dielectric boundaries, obstacles, or passive optical elements, such as lenses, prisms, polar-
izers, waveplates, apertures, waveguides, cavities, transmission lines, ﬁbers, gratings, etc., either ideal or
lossy, but it not even clear whether this is possible, or if so, practical. Many variational techniques have
been used for waveguides, cavities, and other structures, but these are usually of a stationary, rather
than extremal, character, an important distinction which is examined below in Section V E. All of these
directions are left as open problems.

D. Connections to Stimulated Emission

One is also naturally led to speculations as to whether similar ideas may be applied to stimulated
emission. Naively, one might imagine some iterative procedure, where the approximated radiation,
assuming given sources, is somehow used to deduce corresponding energy changes that must have taken
place in those sources, which leads to revised estimates for the radiation, and so on.
It is not clear
whether this is applicable to any real problems, or even if it can converge to a self-consistent solution
describing an active medium.

However, results for the case of spontaneous emission from a classical particle beam may be of direct
relevance to the problem of stimulated emission, namely in the so-called small-signal regime where
saturation and depletion eﬀects are ignored. In his celebrated 1917 quantum analysis of radiation [42],
Einstein ﬁrst classiﬁed the radiative processes involving photons (or really any bosons) into spontaneous
emission of, stimulated emission by, and stimulated absorption of the photons by atoms or other material
sources. By exploiting the fact that the matter and radiation can be in thermodynamic equilibrium,
Einstein used the properties of blackbody radiation and the principle of detailed balance to establish the
proportionalities between the intrinsic rates, within each mode, for each of these processes, as summarized
in the famous A and B coeﬃcients, results which must hold for arbitrary initial conditions, not just those
consistent with thermal equilibrium. Less widely appreciated is that these relations persist in a purely
classical limit of the matter and ﬁelds where Planck’s constant h never appears, clearly discussed, for
example, by Beckeﬁ in Chapter 2 of [43], and derived using somewhat diﬀerent arguments in [44].

p

As a simple example, consider the case of radiation transport in an electron plasma, where direct many-
body eﬀects are neglected, and with an isotropic, single-particle momentum distribution function f (p),
where p =
is the magnitude of kinetic momentum, and uniform density n0 over some region. (This
might also describe a long electron beam in its average rest frame.) Then, for each type of radiative
process (or the aggregate of all processes), the spontaneous emission rate ℓω deﬁned as the power emitted
in polarization ˆe per unit volume of medium per unit bandwidth per solid angle in the direction of ˆs,
may be written as

k

k

ℓω[ˆe; ˆs] = n0

d3p ηω(p; ˆe; ˆs)f (p),

(226)

Z

where ηω(p; ˆe; ˆs) is the single-particle, intrinsic emission coeﬃcient, which is determined by the details of
the microscopic physics, but is independent of the particle distribution function or the incident radiation
state. The net absorption rate, i.e., bare stimulated absorption less stimulated emission, is given by
αωIω, where the radiant brightness Iω is the incident power per unit area per unit solid angle per unit

43

(227)

bandwidth, and the absorption coeﬃcient is given by

αω[ˆe; ˆs] =

8πc2
irω2 n0
n2

−

Z

d3p ηω(p; ˆe; ˆs) ∂

∂ε f (p),

p

c2p2 + m2c4 is the particle energy, n

ir is the background index of refraction, and
where ε = ε(p) =
ηω(p; ˆe; ˆs) is the same quantity that appears in the spontaneous emission. These results are completely
classical, as no factors of ~ anywhere appear. The dependence on the derivative of the distribution
function is the only reminder that this expression represents the net diﬀerence between stimulated
absorption and emission. These connections between spontaneous and stimulated emission/absorption
are essentially a generalized manifestation of the well-known ﬂuctuation-dissipation theorem, which
relates the response of a system when perturbed to the spontaneous ﬂuctuations which occur in the
absence of external perturbation [43, 44, 45].

In FEL physics, ﬁrst described quantum-mechanically but now understood classically, such generaliza-
tions of Einstein’s arguments are the basis for Madey’s theorem in one-dimensional theory [46] and its
generalizations to higher dimensions (see, for example, [44, 45, 47], or else [48] and references therein),
where the gain curve (speciﬁcally, the relative change in intensity versus de-tuning) in the small-signal
regime is proportional to the derivative of the spontaneous emission spectrum.

Given these connections, certain properties of the spontaneous wiggler radiation, or approximations
thereof, can yield information about the stimulated emission, or gain, in the small-signal regime. Perhaps
more satisfying is the obverse relation, whereby our intuitions about stimulated emission provide the
clearest justiﬁcation and interpretation for the appearance of a maximum-power variational principle for
classical spontaneous emission. In situations with gain, we might naturally approximate the radiation
proﬁle by that which maximizes the extraction of energy from the electrons to the laser. For example,
this is precisely the heuristic justiﬁcation for the variational principle suggested in [49] for optically-
guided modes in FELs, where the fundamental mode is estimated by maximizing the imaginary part of
the eﬀective wavenumber. If the radiation is to be estimated by one mode, the mode should be chosen
to be whatever shape is expected to have the fastest growth (or slowest loss).

In fact, we saw above that the MPVP can be interpreted precisely in this manner – as ﬁnding the
mode shape which, if actually incident, would maximally couple to the given sources, and furthermore
the “virtual” gain delivered would be equal to the estimated power spontaneously radiated. The only
essential diﬀerence between our case, and say, Madey’s theorem is that by taking completely prescribed
sources, we implicitly assume that any radiation, once emitted by some part of the source, can then
propagate to the far-ﬁeld where it may interfere constructively or destructively with other radiation, but
cannot cause any recoil in that source nor subsequently be re-scattered or absorbed by any other part
of the source. So in fact we ﬁnd a relationship between the spontaneous emission spectrum and that of
the bare stimulated emission, not the net response given by the diﬀerence between stimulated emission
and absorption as in Madey’s theorem.

E. Relation to Lagrangian Formulation and Other Variational Approaches

A survey of variational techniques in electrostatics, electrodynamics, and optics reveals that, at some
fundamental level, they seem to derive from only a very few general concepts: Hamilton’s principle for
systems derivable from a Lagrangian/action, energy conservation/optimization, electromagnetic reci-
procity, and entropy maximization (for problems of a thermodynamic nature.) Of course these principles
are interrelated – both energy conservation and reciprocity follow from the structure of the governing
Lagrangian, while entropy maximization usually relies on energy conservation or other dynamical in-
variants as constraints and automatically satisﬁes certain reciprocity relations – but nevertheless they
remain useful and conceptually distinct organizational categories. Each variational principle may be
further classiﬁed by whether it demands (generally constrained) optimality, or mere stationarity, of the
relevant function or functional.

We examine in turn the relevance or relation of each of these principles to the MPVP. Obviously the
MPVP is most closely related to energy principles, although in the case of classical spontaneous radiation,

44

we maximize the rate of energy transfer (power) in each spectral band, rather than, say, minimize
potential energy as in electrostatics, or free energy in thermodynamics.

Entropy maximization might be a useful technique to determine or approximate certain source distri-
butions given only macroscopic thermodynamic constraints or other incomplete information, but is not
directly relevant for the problem of ﬁnding the radiation from given deterministic sources, which is more
a problem of dynamics than thermodynamics. However, as we saw above, new connections and rationales
are revealed by generalization of the arguments leading to Einstein’s A and B coeﬃcients to classical
beams or plasmas, and these arguments rely on the equilibrium properties of black-body radiation, even
when the actual system of interest may be far from thermodynamic equillibrium.

Reciprocity-based variational principles are commonly used to approximate resonant frequencies in cav-
ities or waveguides, impedances of cavities, transmission lines, apertures, or other structures, and scat-
tering cross sections by conductors or dielectrics [2, 6, 50]. They can be suitably generalized to many
situations where the background medium is not necessarily homogeneous or isotropic. Despite superiﬁ-
cial similarities between the MPVP and reciprocity-based techniques, a closer look reveals them to be
(ζ; ω) derived from some Coulomb-gauge vector
quite distinct. Consider the solenoidal electric ﬁeld εψ
potential ψ(ζ; ω), and any source j′(ζ; ω), not necessarily that associated with ψ. For our purposes, we
may deﬁne the complex reaction of the ﬁeld εa

on the source j′ as

⊥

⊥

[εψ

, j′]

⊥

R

≡

Z

d3ζ εψ

⊥

(ζ; ω)

j′(ζ; ω) =

εψ

(ω)∗

·

h

⊥

j′(ω)
i
|

,

(228)

Which is similar to the original deﬁnition in [50], but involves only the solenoidal electric ﬁelds, and drops
the analogous terms involving the magnetic ﬁeld and magnetization density, because we are working
with the microscopic ﬁelds from classical sources. Given any source j(ζ; ω), let a(ζ; ω) denote the
corresponding Coulomb-gauge, retarded vector potential, and let χ(ζ; ω) = χj(ζ; ω) denote the closest
homogeneous approximant (i.e., that vector potential obtained by using j
as an eﬀective source in
convolution with the fundamental solution, rather than an actual source in convolution with the retarded
Green function); and deﬁne a′ and χ′ in an analogous fashion for the source j′.

⊥

By using the symmetry properties of the Green functions, it is then straightforward to establish the
Raleigh-Carson reciprocity relation for the inhomogeneous case:

[εa

, j′](ω) =

R

⊥

εa
h

⊥

(ω)∗

j′(ω)
i
|

=

εa′
h

⊥

(ω)∗

j(ω)
i
|

=

R

[εa′

, j](ω),

⊥

and similarly for the homogeneous case:

[εχ

, j′](ω) =

R

⊥

εχ
h

⊥

(ω)∗

j′(ω)
i
|

=

εχ′
h

⊥

(ω)∗

j(ω)
i
|

=

R

[εχ′

, j](ω).

⊥

(229)

(230)

⊥

(ω)∗

j(ω)
i
|

is distinct from the complex power

Such a quantity was introduced in [50] as a measure of “reaction,” or coupling, between the sources j and
j′, and in many contexts a variety of physical observables such as ﬁelds or forces, impedances, etc., may
be proportional to or otherwise related to reactions. Despite resemblances, the complex self-reaction
εψ
, because no complex conjugates
h
appear in the overlap integral in the former case. (Adding to the potential for confusion, the imaginary
part of the complex power is referred to as the “reactive power,” following the conventions of circuit
theory.) Said another way, the complex power is associated with a standard complex inner product,
which is conjugate-symmetric and positive-deﬁnite, while the reaction is associated with a symmetric,
bilinear form which is not a true inner product. Physically, the concepts are also distinct: energy
conservation arises from the invariance properties of the full electromagnetic Lagrangian (including self-
consistent particle dynamics) under time-translations, while reciprocity arises from invariance under
time reversals. The real part of the complex power is of course proportional to the time-average (over
an optical period) of the power exchanged between source and ﬁeld. The real part of the reaction is
actually proportional to the ﬂuctuation about this average.

j(ω)
(ω)
i
|

εψ
h

⊥

The concept of reaction is of interest precisely because of reciprocity properties like (229) or (230),
and the possibilities for variational approximation that emerge, by demanding that all trial sources
“look” the same to themselves as to the correct sources. For example, suppose we seek a trial-function
approximation ˜ψ to the unknown vector potential ψ, given the actual source j. Let ˜j correspond to a

source associated with ˜a (the existence of non-radiating sources implies non-uniqueness, which is of no
consequence here.) From a reaction point-of-view, we would like an approximation such that

≈ R
but by assumption we have no tractable way of calculating the right-hand side, so instead that approx-
imation is then “best” if we can impose the constraint

R

⊥

⊥

[ε ˜ψ

, ˜j](ω)

[εψ

, j](ω),

[ε ˜ψ

R

⊥

, ˜j](ω)

[ε ˜ψ

, j](ω).

≈ R

⊥

In fact, one can show that under this constraint, the reaction
order variations of ˜ψ about the actual solution ψ.

[ε ˜ψ

R

⊥

, j](ω) is then stationary for ﬁrst-

Note that this leads to a stationarity condition, not an optimization condition. Because reaction and
power are not equivalent, in general they lead to diﬀerent variational principles.
In the Method of
Moments, which encompasses both the Finite-Element and the Ritz-Galerkin basis-expansion techniques,
one can obtain algebraic (typically linear) stationarity conditions using either a symmetric form between
trial functions and weight functions, and thus automatically satisfy reciprocity relations, or using a
conjugate-symmetric inner product, and satisfy energy constraints, but typically not both simultaneously.
Perhaps the reaction approach may also lead to some useful variational principle for our problem, but
we do not pursue this question further here. One immediate diﬃculty is that, if we use inhomogeneous
solutions ˜ψ as trial vector ﬁelds, the corresponding sources are easily determined by substitution into the
Helmholtz equation, but the ﬁelds themselves are diﬃcult to parameterize in any economical manner,
while if we use source-free solutions for ˜ψ, variational families may be more easily characterized, but the
eﬀective sources appearing in the reactions are then diﬃcult to determine.

Now we turn to action principles. Because the fundamental dynamics of charge-carrying matter and
electromagnetic ﬁelds are ultimately derivable from a Lagrangian, we had anticipated that our maximum-
power variational principle would be traced back to Hamilton’s Principle, but this appears not to be
the case. (Perhaps this should not have been so surprising; after all, the Lagrangian involves diﬀerences
between kinetic and potential energies, while an an energy-based principle should involve the sum.) To
understand the issues encountered, let us proceed by re-framing the governing dynamical equations in
terms of a standard Lagrangian formulation. For prescribed current and charge densities, the dynamics
of the ﬁelds are derivable from the action functional, which in terms of the Coulomb-gauge potentials
and scaled coordinates may be written as a space-time integral over the Lagrangian densities for the free
electromagnetic ﬁelds and the source-ﬁeld interaction:

=

dτ

d3ζ [

S

Z

Z

L0 +

Lint] ,

L0 =

ε(ζ; τ )
k

k

b(ζ; τ )
k

− k

2

2 =

k−

∂
∂τ a(ζ; τ )

∂φ(ζ; τ )
k

−

2

∂

− k

×

a(ζ; τ )
k

2,

where

and

subject as always to the solenoidal gauge constraint

Lint = j(ζ; τ )

·

−

a(ζ; τ )

µ(ζ; τ )φ(ζ; τ ),

∂

a(ζ; τ ) = 0.

·

Using the reality of the physical potentials and sources and the (Hilbert-space) orthogonality between
∂φ(ζ; τ ) when integrated over all space,
the transverse vector ﬁeld a(ζ; τ ) and longitudinal electric ﬁeld
we can re-write this as

−

=

dτ

d3ζ

( ∂
∂τ a∗

∂
∂τ a) + (∂φ∗

·

∂φ)

(∂

a∗)

(∂

a) + (a∗

j)

(φ∗µ)

,

(237)

·

−

×

·

×

·

−

S

Z

Z

(cid:2)
where we may use j or j
interchangeably within the action functional because the current density only
appears in an inner product with the solenoidal vector potential a. The equations of motion (Euler-
Lagrange equations) for the vector and scalar potentials (and their complex conjugates) are obtained as

⊥

(cid:3)

45

(231)

(232)

(233)

(234)

(235)

(236)

46

the conditions for this action remaining stationary under independent, inﬁnitesimal variations δa(ζ; τ ),
δa(ζ; τ )∗, δφ(ζ; τ ), and δφ(ζ; τ )∗, which are ﬁxed at the space-time boundaries (here taken to be at inﬁn-
ity), are consistent with the gauge constraint, and which do not destroy integrability of the Lagrangian
density, but are otherwise arbitrary.

By interchanging the order of temporal and spatial integrations and using the Parseval-Plancherel Iden-
tity, we may express this action in the (scaled) frequency domain:

=

S

dω
Z

Z

d3ζ [(iωa)∗

·

with additional gauge constraint

(iωa) + (∂φ∗

∂φ)

(∂

a∗)

(∂

a) + (a∗

j)

(φ∗µ)] ,

(238)

·

−

×

·

×

·

−

∂

a(ζ; ω) = 0,

·

(239)

where we have used integration by parts on the time-derivatives, and where each potential and source
term appearing in the action integral is now interpreted as the Fourier transform in scaled time (assumed
to exist) of the function of the same name appearing in the time-domain version above, and where
coordinate dependence has been suppressed for the sake of brevity and readability in the equations.
Using standard vector identities, this may be written in the more transparent form:

=

S

dω
Z

Z

·

(cid:2)

d3ζ

a∗

(∂2 + ω2)a + a∗

j

φ∗(∂2φ)

φ∗µ + ∂

(φ∗∂φ

·

−

−

·

a∗

∂

a)

×

×

−

(240)

(cid:3)

k

ζ

and

k → ∞

Demanding stationarity under independent, inﬁnitesimal variations δa(ζ; ω), δa(ζ; ω)∗, δφ(ζ; ω), and
δφ(ζ′ω) satisfying the gauge constraint and ﬁxed boundary conditions (as
) leads
to the frequency-domain version of Poisson’s equation and the wave equation in the Coulomb gauge. Now,
by Gauss’s theorem, the ﬁnal term involving the pure divergence can be expressed as a surface integral
over the spatial boundary (at inﬁnity), which will not aﬀect the stationarity conditions (Euler-Lagrange
equations) under the assumption of inﬁnitesimal variations with ﬁxed boundary conditions as dictated
by Hamilton’s principle, so it may be dropped without any change in the resulting dynamical equations.
Likewise, we may then introduce the divergence ∂
q of some other, arbitrary diﬀerentiable vector ﬁeld
·
q which may be a function of ζ and ω and a functional of a and a∗ and their spatial derivatives. The
signiﬁcance of this auxiliary ﬁeld will emerge shortly. Since we are ultimately only interested in the
radiative component of the ﬁelds, the terms in the action involving the scalar potential φ may also be
suppressed, as they are constant with respect to variations in the vector potential. Recalling that the
time-domain potentials and sources are all real, we can then use as the relevant action the modiﬁed
functional

| → ∞

ω
|

dω

d3ζ

a∗

(∂2 + ω2)a + a∗

j + ∂

q

+ c.c.,

(241)

∞

=

˜
S

Z0

Z

·

(cid:2)

·

·

(cid:3)

and, noting the additivity with respect to contributions from the various frequencies ω, we may use as
the variational, or “objective” or “cost” function, for each distinct (positive) frequency component the
spectral density associated with this expression:

∂
∂ω

˜
[a, a∗, j, j∗](ω)
S

d3ζ

a∗

(∂2 + ω2)a + a∗

j + ∂

q

+ c.c.,

(242)

≡

Z

·

(cid:2)

·

·

(cid:3)

whose variations, subject to the solenoidal gauge constraint and given spatial boundary conditions, lead
to Euler-Lagrange equations consisting of the inhomogeneous Helmholtz equation for the vector potential
and its complex conjugate at the frequency ω > 0. Choosing

q = 1

2 λ

1
4

1

−

i
k

∂
∂ζ

a

×

h

(cid:16)

1 + i
k

∂
∂ζ

a∗ + P

4π ∂ ζ−

1

,

′
0

(cid:17)

i

or equivalently (at least asymptotically, as ζ

(cid:17)

→ ∞

(cid:16)
),

q = 1

2 λ

sout
a −

h

′
0
P
4π

ζ
ζ3

,

i

(243)

(244)

47

for some undetermined real parameters λ = λ(ω) and

′0 =

′0(ω), equation (242) becomes:

P

P

·

(cid:3)

(cid:2)

∂
∂ω

˜
[a, a∗, j, j∗](ω)
S

≡

2

Z

·

(cid:2)

d3ζ Re

a∗

(∂2 + ω2)a + a∗

j

+ λ(ω)

P

∂
∂ω

EM[aout](

; ω)

∞

− P

′0(ω)

.

(245)

The chosen boundary term amounts to the addition of a Lagrange multiplier enforcing a speciﬁed out-
going power spectral density in the radiation ﬁelds at the stationary points of ∂
∂ω

˜
.
S

Now, a natural approach to approximation, associated variously with the names of Raleigh, Ritz, and
Galerkin in slightly diﬀerent contexts, consists in simply replacing this inﬁnite-dimensional variational
problem with a ﬁnite-dimensional restriction or projection of it onto some more easily characterized
space of possibilities.

(cid:3)

That is, we restrict the space of possible vector potentials to some parameterized family a(ζ; ω; α) for
some ﬁnite-dimensional vector α of continuous parameters (over some speciﬁed domain), and thereby
replace a variational problem involving functional derivatives of the action functional with respect to
the vector potential with one involving ordinary derivatives of an action function with respect to the
variational shape parameters determining the form of the radiation and the Lagrange multiplier enforcing
a power normalization. That is, assuming the family of variational trial functions is implicitly constrained
to satisfy the gauge constraint, the inhomogeneous Helmholtz PDE is replaced for each ω > 0 with a
system of algebraic equations,

∂
∂α
∂
∂λ

∂
∂ω
∂
∂ω

˜
(α) = 0,
S
˜
(α) = 0,
S

(246a)

(246b)

whose solution ˜α = ˜α[j](ω;
a(ζ; ω).

P

′0), ˜λ = ˜λ[j](ω;

P

′0) determines the variational approximation ˜a(ζ; ω; ˜α) to

Now, following our earlier development, suppose we consider a family χ(ζ; ω; α) of trial vector ﬁelds for
the general inhomogeneous problem which are explicitly constrained to be solenoidal and to satisfy the
source-free Helmholtz equation, so the ﬁrst term in the action density vanishes identically. Then the
variational action spectral density becomes

∂
∂ω

˜
(ω; α; λ) = 2
S

ω Im

j(ω)
(ω; α)
i
|
Despite certain similarities, the Ritz-Galerkin-type variational principle associated with this action
is distinct form the MPVP. The action principle involves ﬁnding constrained stationary points of
, while the MPVP involves ﬁnding the constrained maxima of P
, j](ω; α) =
Im
Re

EM[χout](

mech[εχ

+ λ(ω)

εχ
h

(247)

′0(ω)

− P

; ω)

∂
∂ω

∞

P

⊥

⊥

⊥

(cid:3)

(cid:2)

.

.

εχ
h
εχ
h

j(ω)
(ω)
i
|
j(ω)
(ω; α)
i
|

⊥

Although generically the “true” Euler-Lagrange solutions correspond to saddle-points, when the trial
functions are restricted to a parameterized source-free family and when the power-normalization
constraint is imposed via a Lagrange multiplier, the overall problem inherits convexity from the
constraint alone, and the critical points turn out to be power-constrained local maxima or min-
ima of Im
, which implies that the overall phase should be chosen such that
εχ
= 0. In the MPVP case, the variational solution corresponds to constrained local
Re
h
j(ω)
(ω; α)
j(ω)
(ω; α)
maxima of
= 0. Any attempt to employ directly
i
|
i
|
⊥
the action-based variational principle with the source-free trial solutions thus encounters two related
problems: the ostensible method converges to a solution with a global phase error of π/2; and as an
immediate result, the calculated work performed on/by the sources vanishes, so the problem becomes
degenerate, and we are left with no means to consistently choose the absolute power level.

εχ
h
⊥
j(ω)
(ω; α)
|
i
εχ
Re
h

j(ω)
(ω; α)
i
|

, so that Im

εχ
h

−

⊥

⊥

It is not diﬃcult to trace the origin of this phase error. Naive application of Fourier transforms to the
Green function yields the reciprocal-space, frequency-domain kernel

Gout(k, k; ω) = δ(k

k′)

−

1

2 ,

ω2

k

− k

k

(248)

but this neglects the requirement of causality demanded of the retarded Green function, wherein the
response can appear only after the source is applied, implying that the Green function must be analytic
0. We must be slightly more careful, and here treat the (temporal) Fourier transform as the
for Im ω

≥

48

(249)

(250)

(251)

(252a)

(252b)

(252c)

(253)

(254)

(255)

limiting case of a Laplace transform, where the initial conditions are pushed back into the arbitrarily
remote past rather than future, before being forgotten altogether. The Green function (248) must be
understood in the sense

Gout(k, k; ω) = lim
0+

ǫ

δ(k

k′)

−

→

2

k

k

k

−

1
(ω + iǫ)2

where the limit is taken only after Gout is convolved with the Fourier transform of the source. In the
full Fourier representation, the vector potential and transverse source are then related by

are the (scaled) Fourier transforms. For real ω and

k

>

, we see that

where

and

while for

k

k

k

<

,

ω
|

|

a(k; ω) = lim
0+

ǫ

→

j
⊥
2

(k; ω)
(ω + iǫ)2 ,

k

k

k

−

(k; ω) = (1

ˆkˆkT)j(k; ω),

j
⊥

−

a(k; ω) = 1

(2π)3/2

d3ζ a(ζ; ω)e−

ik

ζ,

·

j(k; ω) = 1

(2π)3/2

d3ζ j(ζ; ω)e−

ik

ζ

·

Z

Z

k
k
a(k; ω)
·
(k; ω)
j
·
⊥

ˆe
ˆe

(cid:21)

(cid:20)

arg

ω
|

|

= 0,

arg

ˆe
ˆe

a(k; ω)
·
(k; ω)
j
·
⊥

(cid:21)

(cid:20)

= π.

arg

ˆe
ˆe

a(k; ω =
·
(k; ω =
j
·
⊥

)
)

k
k
k
k

k
k

(cid:21)

(cid:20)

=

π
2

.

In either case, the associated electric ﬁeld for these spectral components is then in quadrature with
the current, and no time-averaged work is performed or energy exchanged. However, on the singular
resonant manifold where
exactly, the magnitude of the Green function diverges in the limit as
ǫ

ω
|
|
0+, but the phase is such that

=

k

k

k

→

The relative phase between ﬁeld and source then jumps discontinuously, to where the currents deliver
time-averaged energy to the ﬁelds. Our purported action principle fails to capture this, while the
MPVP, although operating entirely within this singular manifold of source-free solutions, relies on energy
conservation, which then enforces the correct phase relation. This is not to imply that action-based
variational principles are not also useful for radiation problems, only that they will not naturally work
with source-free solutions, and generically will involve ﬁnding saddle-points, not extrema.

In fact, most of the variational principles previously employed for FEL analysis, paraxial wave propaga-
tion, or laser-plasma problems are based on precisely this type of generalized Ritz-Galerkin approxima-
tions to the underlying Lagrangian dynamics, although some of the authors have erroneously claimed
extremal instead of mere stationary character for their techniques. A Lagrangian-based variational prin-
ciple is developed in [51] for paraxial optical propagation in an inhomogeneous gain medium, which
is generalized in [52] to include nonlinear self-focusing eﬀects, but the authors erroneously claim ex-
tremal, not just stationary, properties. This approach was further extended to include more general
laser-plasma interaction terms in [53], where the authors correctly state that their trial solutions de-
rive from a stationary principle. In [49] the authors state without proof an extremal principle for the
fundamental FEL mode in the small-signal regime, which in fact appears to be perfectly correct, but
higher modes will merely be stationary. These ideas are further generalized in [54, 55, 55, 56], where

49

the variational techniques are erroneously described as extremal principles. Similar trial-function-based
variational principles are also used in [57, 58, 59] for which, correctly, only stationarity is claimed.

A number of other authors have made extensive use of (correctly-stated) stationary action principles
both for general wave-wave and wave-particle interactions in kinetic and ﬂuid treatments of plasmas and
particle beams [60, 61, 62, 63, 64] and more speciﬁcally for analysis of FELs [65]. However, rather than
involving parameter-laden trial functions, these approaches employ the variational principles in order
to provide economical descriptions and derivations of dynamical equations and conservation laws in the
form of conventional ODEs or PDEs, and to eﬀect in an eﬃcient and transparent manner certain eikonal
expansions or approximations, or oscillation-center/ponderomotive or other averaging procedures [66, 67]
while preserving the Hamiltonian nature of the dynamics.

Such confusion between stationary and extremal principles seems deeply embedded in physics literature
and folklore. Linguistically, “optimizing,” “maximizing,” or “minimizing” simply sound better than
“criticalizing” or “making stationary.” Philosophically, optimality enjoys a certain teleological appeal
which mere stationarity lacks. Historically, the buzzwords “least action” have been invoked so often
in the discussion of dynamics that Hamilton’s Principle and the Principle of Least Action have been
mistakenly conﬂated, despite being quite distinct concepts. The Principle of Least Action was ﬁrst
articulated by Maupertuis and formalized by Euler, not Hamilton; is restricted to a smaller class of
Lagrangians (no explicit time dependence); uses a diﬀerent action (the abbreviated action integral) and
a diﬀerent set of constrained variations (the energy is ﬁxed but temporal endpoints are not); and in fact
it is itself misnamed, requiring only that the abbreviated action be stationary, not necessarily minimal,
for the physical trajectory. Practically, both optimization principles and stationary principles share an
insensitivity of the variational quantity to the trial functions, but the extremal case additionally provides
an upper or lower bound.

Numerically, more eﬃcient and/or reliable computational techniques may be employed for optimization
problems. Finding (local) maxima or minima of functions is much easier than ﬁnding roots of systems of
equations. The “Alpine” analogy is often made: lost in a foggy terrain, the mountain-climber can reliably
ﬁnd a nearby peak (local maximum) by moving uphill, a nearby valley (local minimum) by wandering
downhill, but has no guaranteed strategy for ﬁnding a mountain pass (saddle-point.) If the original
action density is convex (at least in some suﬃciently large region of function space), so that the true
solution corresponds to an extremum of the action, then in the Raleigh-Ritz approximation we have a
natural metric to measure both “closeness” to the true solution and “progress” in iteratively determining
the approximate one – namely, a metric induced by the action itself. Without convexity, the true and
approximate solutions may correspond to saddle-points, and we must introduce some arbitrary external
metric to measure similarity or improvement. Even in the classic formulations which employ only linear
expansions in basis functions, the extremal case leads to the solution of equations corresponding to a
symmetric (or Hermitian), positive deﬁnite matrix, while in the merely stationary problem the matrix
is in general Hermitian but not positive deﬁnite.

In the case of electromagnetic radiation, the stationary points are generically saddles, because of the
hyperbolic nature of the wave equation. Alternatively, one can see this by the well-known equivalence of
electromagnetic mode dynamics to a collection of harmonic oscillators, for which the action functional is
known to be minimal only for suﬃciently short times intervals away from turning points along an orbit.

Similar subtleties occur in the usual Raleigh-Ritz approximation for the stationary states in quantum
mechanics. The energy-expectation value is always a local minimum for the ground state, and is always
stationary for any excited state, but is only minimal for excited states if the variations are constrained
to be orthogonal to all lower states.

To summarize, the MPVP involves ﬁnding constrained extrema of quantities of the form:

while Rumsey reaction-based variational principles would involve ﬁnding constrained stationary points
of quantities of the form:

P′[ω; α]

d3x ε(x; ω; α)∗

j(x; ω)

;

Im

∼

(cid:20)Z

·

·

(cid:21)

(cid:21)

R[ω; α]

Im

∼

(cid:20)Z

d3x ε(x; ω; α)

j(x; ω)

;

(256)

(257)

and Lagrangian action-based principles would involve ﬁnding constrained stationary points of quantities
of the form:

so indeed they all appear to be distinct variational principles.

[ω; α]

Re

∼

S

(cid:20)Z

d3x ε(x; ω; α)∗

j(x; ω)

;

·

(cid:21)

50

(258)

VI. CONCLUSIONS

We have reviewed in some detail a Hilbert-space and operator-based approach to electromagnetic ra-
diation, and have used this formalism to derive in some detail a maximum-power variational principle
(MPVP) for spontaneous radiation from prescribed classical sources, ﬁrst in the paraxial limit and then
in a more general setting, adding to the large family of variational techniques for electromagnetic prob-
lems in general, and undulator/wiggler radiation in particular. Mathematical details aside, at its most
essential, the MPVP is really just a straightforward and rather obvious consequence of two simple and
rather obvious constraints, together with another fundamental mathematical fact: the power in any one
source-free mode of the electromagnetic ﬁeld may not exceed the total power in all the modes (i.e., Bessel
inequality); and the power radiated must be attributable to power delivered by the sources, even in the
regime where we ignore back-action on the sources (i.e., conservation of energy); while information about
the ﬁelds on some boundary surface, needed to determine this radiated power, can be converted into in-
formation about the derivatives of the ﬁelds in the interior (i.e., Gauss’s law, one of the multidimensional
generalizations of the Fundamental Theorem of Calculus).

This approximation, or ones similar to it, has been frequently used, almost without comment or per-
ceived need for further justiﬁcation, in classical or quantum stimulated emission situations, where in the
presence of gain we naturally expect to observe that mode which grows the fastest, but it is equally
applicable in the spontaneous regime, because arguments along the lines of Einstein’s derivation of the
A and B coeﬃcients lead to deﬁnite connections between spontaneous emission, stimulated emission,
and stimulated absorption, even when the radiation is completely classical. However simple, even triv-
ial, these observations are not without practical content or application to undulator and possibly other
radiation problems.

Acknowledgements

We acknowledge useful discussions with W. Fawley, G. Penn, R. Lindberg, J. Morehead, A. Zholents,
and J. Zimba. This research was supported by the Division of High Energy Physics, U.S. Department
of Energy, and by DARPA, U.S. Department of Defense.

[1] R.F. Collin. Field theory of guided waves. International series in pure and applied physics. McGraw-Hill

Book Company, New York, 1960.

[2] R.F. Harrington. Time-harmonic electromagnetic ﬁelds. Mcgraw-hill electrical and electronic enginering

series. McGraw-Hill Book Company, New York, 1961.

[3] S.G. Mikhlin. Variational methods in mathematical physics. Maxmillan Company, New York, 1964.
[4] L. Cairo and T. Kahan. Variational techniques in electromagnetism. Blackie, London, 1965.
[5] J.D. Jackson. Classical electrodynamics. John Wiley and Sons, New York, second edition, 1975.
[6] J.A. Kong. Electromagnetic wave theory. John Wiley and Sons, New York, 1986.
[7] J.L. Davis. Wave propgation in electromagnetic media. Springer-Verlag, New York, 1990.
[8] J.J.H. Wang. Generalized moment methods in electromagnetics: Formulation and computer solution of

integral equations. John Wiley and Sons, New York, 1991.

[9] W.Z. Zhang. Engineering electromagnetism: Functional methods. Ellis Horwood, New York, 1991. Chang,

Wen-Hsun.

51

[10] I. Vago and M. Gyimesi. Electromagnetic ﬁelds. Akademiai Kiado, Budapest, 1998.
[11] G.W. Hanson and A.B. Yakovlev. Operator theory for electromagnetics: An introduction. Springer, New

[12] I.B. Bernstein, E.A. Frieman, M.D. Kruskal, and K. R.M. An energy principle for hydromagnetic stability

problems. Proceedings of the Royal Society of London A, 244:17, 1958.

[13] M.D. Kruskal and C.R. Oberman. On the stability of a plasma in static equilibrium. Physics of Fluids,

[14] E.A. Frieman and M. Rotenberg. On hydrodynamic stability of stationary equilibria. Reviews of Modern

York, 2002.

1:275, 1958.

Physics, 32:898, 1960.

ment(part 2):451, 1962.

[15] W.A. Newcomb. lagrangian and hamiltonian methods in magnetohydrodynamics. Nuclear Fusion:, Suple-

[16] C.S. Gardner. Bound on the energy available from a plasma. Physics of Fluids, 6:839, 1963.
[17] V.I. Arnold. Variational principle for three dimensional steady-state ﬂows of an ideal ﬂuid. Journal of

Applied Mathematical Mechanics, 29:1002, 1965.

[18] D.D. Holm, J.E. Marsden, T. Ratiu, and A. Weinstein. Nonlinear stability of ﬂuid and plasma equilibria.

Physics Reports, 123:1, 1985.

Controlled Fusion, 11:7, 1987.

3910, 1 October 1989.

[19] J.M. Finn and G.-Z. Sun. Nonlinear stability nad the energy-Casimir method. Comments Plasma Phys.

[20] P.J. Morrison and D. Pﬁrsch. Free-energy expressions for Vlasov equilibria. Physical Review A, 40(7):3898–

[21] R. Evans. Density functionals in the theory of nonuniform ﬂuids. In D. Henderson, editor, Fundamentals of

inhomogeneous ﬂuids. Marcel Dekker, New York, 1992.

[22] S. Ichimaru. Statistical plasma physics. Westview Press, Bolder, Colorado, revised edition, 2004.
[23] R.F. Harrington. Field computation by moment methods. MacMIllan, New York, 1968.
[24] R. Glowinski. Numerical methods for nonlinear variational problems. Springer-Verlag, New York, 1983.
[25] A.R. Mitchell and R. Wait. The ﬁnite element method in partial diﬀerential equations. Wiley, Chichester,

[26] P. Blanchard and E. Bruning. Variational methods in mathematical physics: A uniﬁed approach. Texts and

[27] S.C. Brenner and L.R. Scott. The mathematical theory of ﬁnite element methods, volume 15 of Texts in

monographs in physics. Springer-Verlag, Berlin, 1992.

applied mathematics. Springer-Verlag, Berlin, 1994.

[28] C.W. Steele. Numerical computation of elecric and magnetic ﬁelds. Chapman and Hall, New York, second

1984.

edition, 1997.

[29] G. Penn, M. Reinsch, and J.S. Wurtele. Analytic model of harmonic generation in the low-gain FEL regime.

Technical Report LBNL-56177, LBNL, August 2004.

[30] G. Penn, M. Reinsch, and J.S. Wurtele. Analytic model of harmonic generation in the low-gain FEL regime.

In 26th International Free Electron Laser Conference, 2004.

[31] G. Penn, J.N. Coreltt, W. Fawley, M. Reinsch, W. Wan, J.S. Wurtele, and A. Zholents. Harmonic cascade

FEL designs for LUX. In European Paticle Accelerator Conference (EPAC), 2004.

[32] S.J. van Enk and G. Nienhuis. Eigenfunction description of laser beams and orbital angular momentum
of light. In L. Allen, S.M. Barnett, and M.J. Padgett, editors, Optical angular momentum, pages 36–47.
Institute of Physics Publishing, Bristol, 2003.

[33] G. Nienhuis and L. Allen. Paraxial wave optics and harmonic oscillators. In L. Allen, S.M. Barnett, and
M.J. Padgett, editors, Optical angular momentum, pages 48–57. Institute of Physics Publishing, Bristol,
2003.

[34] L. Allen, S.M. Barnett, and M.J. Padgett, editors. Optical angular momentum. Institute of Physics Pub-

lishing, Bristol, 2003.

[35] N. George and A. Gamliel. Correlation theory of electromagnetic radiation using multipole expansions.
In H.N. Kritikos and D.L. Jaggard, editors, Recent advances in electromagnetic theory, pages 144–182.
Springer-Verlag, New York, 1990.

[36] J. Morehead. Vector spherical harmonics., 2001.
[37] C.T. Tai. Dyadic Green functions in electromagnetic theory. IEEE Press, New York, second edition, 1993.
[38] H.L. Weinart, editor. Reproducing kernel Hilbert spaces: Applications in statistical signal processing, vol-
ume 25 of Benchmark papers in electrical engineering and computer science. Hutchinson Ross Publishing
Company, Stroudburg, Pennsylvania, 1982.

[39] R.A. Waldron. Theory of guided electromagnetic waves. van Nostrand-Reinhold, London, 1970.
[40] J. van Bladel. Singular electromagentic ﬁelds and sources. Oxford engineering science series. Oxford Uni-

versity Press, Oxford, 1991.

[41] Rahmat-Samii. On the question of computation of the dyadic Green function at the source region in waveg-
uides and cavities. IEEE Transactions on Microwave Theory and Techniques, 23(9):762–765, September
1975.

[42] A. Einstein. Zur quantentheorie der strahlung. Phys. Zeit., 18:121, 1917.
[43] G. Bekeﬁ. Radiation processes in plasmas. Wiley series in plasma physics. John Wiley and Sons, New York,

1966.

52

[44] V.N. Litvinenko and N.A. Vinokurov. On the classical analog of the Einstein relations between spontaneous
emission, induced emission, and absorption. Nuclear Instruments and Methods in Physics Research A,
331:440–449, 1993.

[45] S. Krinsky, J.M. Wang, and P. Luchini. Madey’s gain-spread theorem for the free electron laser and the

theory of stochatic processes. Journal of Applied Physics, 53(8):5453–5458, August 1982.

[46] J.M.J. Madey. Relationship between mean radiated energy, mean squared radiated energy, and spontaneous
power spectrum in a power series expansion of the equations of motion in a free electron laser. Nuovo
Cimento della Societa Italiana di Fisica B, 50(ser. 2, no. 1):64–88, 11 March 1979.

[47] K.w.-J.e. Kim. FEL gain taking into account diﬀraction and beam emittance; generalized Madey’s theorem.

Nuclear Instruments and Methods in Physics Research A, 318:489–494, 1992.

[48] D.E. Nikonov, Y.V. Rostovtsev, and G. Sussman. Madey’s and Liouville’s theorems relating to free-electron

lasers without inversion. Physical Review E, 57(3):3444–3454, March 1998.

[49] M. Xie and D.A.G. Deacon. Theoretical study of FEL active guiding in the small signal regime. Nuclear

Instruments and Methods in Physics Research A, 250(1-2):426–431, 1 September 1986.

[50] V.H. Rumsey. Reaction concept in electromagnetic theory. Physical Review, 94(6):1483–1491, 15 June 1954.
[51] A.J. Firth. Propagation of LASER beams through inhomogenous media. Optics Commuications, 22(2):226–

[52] A. Anderson and M. Bonnedal. Variational apporach to nonlinear focusing of Gaussian laser beams. Physics

230, August 1977.

of Fluids, 22(1):105–109, January 1979.

[53] B.J. Duda and W.B. Mori. Variational principle approach to short-pulse laser-plasma interactions in three

dimensions. Physical Review E, 61(2):1925–1939, February 2000.

[54] A. Amir and Y. Greenzweig. Three-dimensional theory of the free-electron laser. i. Gain and evolution of

optical modes. Physical Review A, 34(6):4809–4819, December 1986.

[55] P. Luchini and S. Solimeno. Variational solution of the wave equation for a high gain FEL and a ﬁnite
wiggling radius. Nuclear Instruments and Methods in Physics Research A, 272(1-2):311–317, October 1988.
[56] A. Amir. Optical-mode trapping in the free-electron laser. Physical Review A, 37(3):780–786, 1 February

1988.

[57] L.H. Yu, S. Krinsky, and R.L. Gluckstern. Calculation of universal scaling function for free-electron laser

gain. Physical Review Letters, 64(25):3011–3013, 18 June 1990.

[58] B. Haﬁzi and C.W. Roberson. Eﬀect of emittance and energy spread on a free-electron laser in the gain-

focusing regime. Physical Review Letters, 68(24):3539–3542, 15 June 1992.

[59] M. Xie. Exact and variational solutions of 3d eigenmodes in high gain FELs. Nuclear Instruments and

Methods in Physics Research A, 445(1-3):59–66, 1 May 2000.

[60] A.N. Kaufman and D.D. Holm. The Lie-transformed Vlasov action principle: Relativistically covariant wave

propagation and self-consistent pondermotive eﬀects. Physics Letters, 105A(6):277–279, 22 October 1984.

[61] D. Pﬁrsch and P.J. Morrison. Local conservation laws for the Maxwell-Vlasov and collisionless kinetic guiding

center theories. Physical Review A, 32(3):1714–1721, September 1985.

[62] L.A. Turski and A.N. Kaufman. Canonical-dissipative formulation of relativistic plasma kinetic theory with

self-consistent Maxwell ﬁeld. Physics Letters A, 120(7):331–333, 9 March 1987.

[63] A.N. Kaufman, H. Ye, and Y. Hui. Variational formulation of covariant eikonal theory for vector waves.

Physics Lettera A, 120(7):327–330, 9 March 1987.

[64] A.J. Brizard. A new Lagrangian formulation for laser-plasma interactions. Physics of Plasmas, 5(4):1110–

1117, April 1998.

[65] P. Similon and J.S. Wurtele. Nonlinear interaction of a relativisitc electron beam with electromagentic

waves. Physics Letters A, 154(4,5):224–232, 4 March 1991.

[66] M.E. Delanay. On the averaged Lagrangian technique for nonlinear dispersive waves. Ph.d., California

[67] G.B. Whitham. Linear and nonlinear waves. Pure and applied mathematics. John Wiley and Sons, Inc.,

Institute of Technology, 1971.

New York, 1974.

