3
0
0
2
 
n
a
J
 
0
1
 
 
]
h
p
-
s
s
a
l
c
.
s
c
i
s
y
h
p
[
 
 
1
v
7
1
0
1
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Kustaanheimo-Stiefel transformation in
geometric algebra

T Bartsch
Institut f¨ur Theoretische Physik 1, Universit¨at Stuttgart, 70550 Stuttgart,
Germany

E-mail: bartsch@theo1.physik.uni-stuttgart.de

Abstract. The Kustaanheimo-Stiefel (KS) transformation maps the non-linear
and singular equations of motion of the three-dimensional Kepler problem to the
linear and regular equations of a four-dimensional harmonic oscillator. It is used
extensively in studies of the perturbed Kepler problem in celestial mechanics
and atomic physics.
In contrast to the conventional matrix-based approach,
the formulation of the KS transformation in the language of geometric Cliﬀord
algebra oﬀers the advantages of a clearer geometrical interpretation and greater
computational simplicity. It is demonstrated that the geometric algebra formalism
can readily be used to derive a Lagrangian and Hamiltonian description of the
KS dynamics in arbitrary static electromagnetic ﬁelds. For orbits starting at the
Coulomb centre, initial conditions are derived and a framework is set up that
allows a discussion of the stability of these orbits.

PACS numbers: 45.20.Jj,31.25.Gy,45.50.Pk

1. Introduction

The Kepler problem belongs to the simplest systems of classical mechanics. A detailed
understanding of its properties is of equally fundamental importance to celestial
mechanics and to atomic physics. In both areas it is of interest to describe, either by
means of analytic approximations or numerical computation, the impact of additional
non-Coulombic forces on the dynamics. In its original form, the equation of motion

d2x
dt2 =

x
x
|

3
|

−

(1)

is not well suited to this purpose because it is highly non-linear and exhibits a
singularity at the Coulomb centre where the force diverges. For numerical studies
of the dynamics it is mandatory to ﬁnd a representation of the equations of motion
which avoids this singularity.

For the one-dimensional Kepler motion, it was already found by Euler [1] that
the introduction of a square-root coordinate u = √x and a ﬁctitious time τ deﬁned
by dt = x dτ reduces the Kepler equation of motion (1) to the equation of motion of
a one-dimensional harmonic oscillator
d2u
ds2 + 2Eu = 0 ,

(2)

The Kustaanheimo-Stiefel transformation in geometric algebra

2

where E is the energy of the Kepler motion. Equation (2) is not only void of
singularities, it is also linear and thus forms a much more convenient basis for analytic
calculations.

Generalizing this approach, Levi-Civit`a [2] regularized the two-dimensional
Kepler problem by combining the two spatial coordinates into a complex number
x = x1+ix2 and introducing a complex square-root coordinate u = √x, which together
dτ reduces the Kepler problem to a
with the ﬁctitious-time transformation dt =
two-dimensional harmonic oscillator.

x
|
|

Attempts to extend this regularization scheme to the three-dimensional Kepler
problem failed, until in 1964 Kustaanheimo and Stiefel [3,4] proposed the introduction
of four regularizing coordinates instead of three and thereby achieved the reduction of
the three-dimensional Kepler problem to a four-dimensional harmonic oscillator. This
transformation, which is known as the Kustaanheimo-Stiefel (KS) transformation, is
discussed in detail in the monograph by Stiefel and Scheifele [5]. Beyond its importance
to celectial mechanics, it has proven to be an essential tool for investigating the
complicated classical dynamics of the hydrogen atom in crossed electric and magnetic
ﬁelds [6, 7, 8].

Customarily, the KS transformation is expressed in the language of matrix
algebra, which not only necessitates awkward computations of vector and matrix
components, but also lacks a transparent geometric interpretation. An alternative
formulation in terms of the geometric algebra of Euclidean three-space was introduced
by Hestenes [9].
In this formalism, the four KS coordinates are interpreted as the
components of a position spinor and are thus given a clear geometric meaning. In
addition, the formalism oﬀers computational advantages over the conventional matrix-
based approach because it unites the four coordinates into a single spinor.

In this paper I elaborate on the geometric algebra formulation of the KS
transformation and work out the details necessary for applications to atomic physics,
in particular semiclassical closed-orbit theory [10, 11, 12, 13, 14, 15]. The calculations
will amply demonstrate the advantages of the geometric algebra over the matrix-
based formalism. The terminology used is adapted to applications in atomic physics.
In particular, I refer to the attractive centre as the nucleus and discuss the motion of
an electron of unit mass and negative unit charge under the inﬂuence of the nucleus
and arbitrary static external electromagnetic ﬁelds. Nevertheless, the results are of
much broader range. They apply equally to celestial mechanics or any other ﬁeld of
physics governed by the equations of motion of a perturbed Kepler problem.

In section 2, the geometric algebra formulation of the KS transformation is
introduced and its relation to the matrix-based approch is established. The spinor
In section 3, a Lagrangian
equation of motion given by Hestenes [9] is derived.
and Hamiltonian formulation of the KS spinor dynamics is derived.
It cannot be
obtained by a simple change of variables because the KS transformation introduces
a non-physical fourth degree of freedom and a pseudotime parameter. Nevertheless,
it is demonstrated that the geometric algebra formulation readily lends itself to an
incorporation into the Lagrangian and Hamiltonian formulations of dynamics. At
the same time, the well-known KS Hamiltonian [12, 13, 6], which is restricted to
homogeneous external electromagnetic ﬁelds, is generalized to arbitrary static ﬁelds.
Section 4 presents the explicit solution of the spinor equation of motion in a pure
Coulomb ﬁeld and gives the constants of motion in terms of the KS spinor. Section 5
discusses the KS description of orbits starting at the Coulomb centre and returning to
it. These orbits, referred to as “closed orbits”, are of particular importance because

The Kustaanheimo-Stiefel transformation in geometric algebra

3

they play a central role in the semiclassical interpretation of atomic photo-absorption
spectra [10, 11, 12, 13]. They require a special treatment because, although the spinor
equation of motion is regular at the nucleus, the KS transform is singular there. I
will derive initial conditions for orbits starting at the nucleus and present a basis of
the spinor space that is suitable for the investigation of the stability of closed orbits.
A brief introduction into the properties of geometric algebra needed here is given
in Appendix A, where the notation used in what follows is also explained. A more
detailed exposition of the formalism can be found in [9, 16, 17, 18].

2. The spinor equation of motion

The KS-transformation in three dimensions can be found by representing an arbitrary
position in space not by its position vector x, but by a position spinor, i.e.
the
rotation-dilatation operator transforming a ﬁxed reference vector into the position
vector x. As explained in Appendix A, a rotation-dilatation of the reference vector
σ3 is represented in the geometric algebra by an even multivector U according to

x =

U σ3U † .

1
2

The factor 1/2 was introduced here to stay in touch with earlier applications of the
KS-transformation to atomic dynamics [12, 13], although the present formulation of
the theory would suggest dropping it. It implies the normalization

U †U = U U † = 2 r = 2

.

x
|

|

Up to normalization, the ansatz (3) reproduces the square-root coordinates introduced
by Euler and Levi-Civit`a, respectively,
if it is applied to spaces of one or two
dimensions.

Given a position vector x, the choice of the spinor U is not unique. More precisely,

the gauge transformation

U e−I3α/2

U

7→

(5)
with arbitrary real α does not alter x, because the additional exponential factor
describes a rotation of the reference vector σ3 around itself. This consideration
immediately clariﬁes why a position spinor representation in three dimensions must
introduce a fourth degree of freedom. In lower dimensions, a rotation does not leave
any vector invariant, so that the spinor transformation does not possess a gauge degree
of freedom. It is also clear from (5) that all ﬁbres of the KS transformation except
U = 0 are circles in spinor space.

The inverse KS transformation can be found from equation (A.13) by adapting
the normalization to (4). The position spinors corresponding to a vector x are given
by

U =

r + xσ3
√r + z

e−I3α/2

with arbitrary real α.

In components, the spinor U can be represented as U = u0 + Iu with u =

3
k=1 ukσk. The transformation (3) then decomposes into
u0u2 ,

x = u1u3

P

(3)

(4)

(6)

(7)

−

y = u1u0 + u2u3 ,

z =

1
2

(u2

0 −

u2
1 −

2 + u2
u2

3) .

The Kustaanheimo-Stiefel transformation in geometric algebra

Up to renumbering the components, this agrees with the conventions of [12, 13].

To obtain an equation of motion for U , time derivatives of U must be calculated.

Diﬀerentiating (3) leads to

˙x =

˙U σ3U † +

U σ3 ˙U † =

˙U σ3U †
h

1 .
i

1
2

1
2

Equation (8) obviously cannot be solved for ˙U because the time derivative of the gauge
parameter α in (5) cannot be determined from the dynamics of the position vector.
To arrive at an equation of motion for U , I must therefore impose a constraint on α.
This can be done in a convenient and geometrically appealing fashion by requiring

(9)
which means that ˙U is chosen such as not to contain a component of rotation around
the instantaneous position vector x. Under this constraint, (8) yields

3 = 0 ,
i

˙U σ3U †
h

As in the one- and two-dimensional cases, the regularization of the three-
dimensional Kepler motion requires the introduction of a ﬁctitious-time parameter
τ . It is deﬁned by

Derivatives with respect to τ will be denoted with a prime. Equation (11) then yields

˙x = ˙U σ3U †

and

˙U = ˙x U †−1

σ3 = ˙x

σ3 .

U
2r

dt = 2r dτ

U ′ = 2r ˙U = ˙x U σ3 .

For the second derivative of U , I obtain

U ′′ =

d
dτ

(cid:18)

˙x

(cid:19)

U σ3 + ˙x U ′ σ3

= 2r ¨x U σ3

U + ˙x2 U

U †
2r
1
˙x2
2

= 2

¨xx +

(cid:18)

U .

(cid:19)

Together with Newton’s equation of motion

¨x =

x
r3 + f

−

U ′′ = 2 (EK + f x) U ,

where the Kepler energy
1
2

EK =

˙x2

1
r

−

with an arbitrary non-Coulombic force f , equation (14) yields the spinor equation of
motion in the form ﬁrst given by Hestenes [9]:

denotes the sum of the kinetic and Coulombic potential energies.

In the special case of pure Kepler motion, i.e. f = 0, the Kepler energy EK is
equal to the total energy E and is conserved. In this case, (16) reduces to the linear
equation of motion

U ′′ = 2E U .

4

(8)

(10)

(11)

(12)

(13)

(14)

(15)

(16)

(17)

(18)

The Kustaanheimo-Stiefel transformation in geometric algebra

5

If E < 0, this is the equation of motion of a four-dimensional isotropic harmonic
oscillator with frequency ω = √

2E with respect to τ .
If additional forces f are present, the Kepler energy is not conserved in general,
so that the work done by the external forces must be taken into account [4]. This
can easily be achieved if the external forces are generated by static electromagnetic
ﬁelds, because the work done by a magnetic ﬁeld B is zero, whereas an electric ﬁeld
F =
In this case, the total energy
E = EK

V can be derived from a potential V (x).
V is conserved, so that the equation of motion reads

−

−∇
−

U ′′ = 2 (E + V (x) + f x) U

with f =

F

˙x

B.

−

−

×

It ﬁnally remains to verify that the equation of motion (16) is consistent with the

constraint (9). To prove this, ﬁrst note that

is a constant of motion for any external forces f [4], because by (16)

ξ =

U ′σ3U †
h

3
i

dξ
dτ

=

U ′′ σ3 U †
h

3 +
i

=

(EK + f x) x
h
EKx + r2f
=
h
= 0 .

3
i

3
i

U ′ σ3 U ′†
h
=0 by (A.12)
}
{z
|
3
i

(19)

(20)

(21)

Therefore, if the initial conditions are chosen so that ξ = 0 at τ = 0, equation (21)
guarantees

˙U σ3 U †
h

3 = 2r ξ = 0 at all times.
i

3. Canonical formalism

In classical investigations of atoms in external ﬁelds, the Hamiltonian nature of the
dynamics plays a central role. It is therefore essential to show how the spinor equation
of motion found in the previous section can be derived in the context of a Lagrangian or
Hamiltonian formalism. In the matrix theory of the KS transformation, a Hamiltonian
formulation is well known and widely applied in the literature [12, 13]. Due to the
introduction of an additional degree of freedom and a ﬁctitious-time parameter, it
cannot be found by a straightforward change of variables. In this section it will be
shown that the application of geometric algebra allows an easy and general derivation
of the Hamiltonian. At the same time, the Hamiltonian formalism will be generalized
to arbitrary inhomogeneous static external ﬁelds.

3.1. Fictitious-time transformations

Elementary expositions of Lagrangian and Hamiltonian dynamics usually treat the
time t as the externally prescribed independent variable fundamentally diﬀerent from
the spatial coordinates, velocities, and momenta. The formalisms are then shown to
be invariant under point transformations or canonical transformations, respectively,
which may be time-dependent, but may not transform the time variable. However,
both the Lagrangian and the Hamiltonian formalisms can be reformulated in such
a way that it is possible to introduce an arbitrary orbital parameter τ and to treat
the physical time t as an additional coordinate on the same footing as the spatial

The Kustaanheimo-Stiefel transformation in geometric algebra

6

coordinates. This formalism is discussed in its full generality by Dirac [19, 20]. For
the special case of autonomous Lagrangian dynamics and the simple form of the
ﬁctitious-time transformation used above, the full ﬂexibility of Dirac’s homogeneous
formalism is not needed. Instead, the modiﬁcations needed to achieve the ﬁctitious-
time transformation can be derived in a straightforward manner from Hamilton’s
variational principle.

The Lagrangian equations of motion can be derived from the action functional

S =

dt L(q(t), ˙q(t))

t2

Z

t1

by requiring that for the classical paths the variation of S with respect to the path q(t)
vanishes if the variation is performed with the initial and ﬁnal times t1 and t2 and the
coordinates q(t1) and q(t2) kept ﬁxed. If a ﬁctitious-time parameter τ is introduced
by the prescription

with an arbitrary function f , it is tempting to rewrite the action functional as

dt = f (q, ˙q) dτ

S =

dτ f (q, ˙q)L(q, ˙q)

τ2

Z

τ1

˜L = f (q, ˙q) L(q, ˙q) =

dt
dτ

L

and regard

as the Lagrangian describing the dynamics with respect to τ . However, this simple
procedure is incorrect in general, because to derive the Lagrangian equations with
respect to ˜L from (24), the variation of S has to be performed with the initial and
ﬁnal ﬁctitious times τ1 and τ2 kept ﬁxed, and due to (23) a variation of the path will
alter the relation between t and τ , so that the initial and ﬁnal physical times t1 and
t2 will vary.

To establish the true relation between (22) and (24), I calculate the variation of

(24) taking the variation of t into account, i.e. q and t are varied according to

subject to the boundary conditions

q(τ )

t(τ )

7→

7→

q(τ ) + δq(τ ) ,

t(τ ) + δt(τ ) ,

δq(τ1) = δq(τ2) = 0

and with τ1 and τ2 kept ﬁxed. Under this variation,

dτ
dt 7→

dτ
d(t + δt)

=

=

1
dτ + d δt
dt
dτ
dτ
1
dt (cid:18)

−

dτ
dt

d δt
dτ (cid:19)

,

so that

δ

dτ
dt

=

− (cid:18)

2

dτ
dt (cid:19)

d δt
dτ

(22)

(23)

(24)

(25)

(26)

(27)

(28)

(29)

The Kustaanheimo-Stiefel transformation in geometric algebra

7

and hence

(cid:18)

δ ˙q = δ

dq
dτ
dq
dτ (cid:19) ·

dτ
dt (cid:19)
dτ
dt
dτ
dt
The variation of (24) then reads

(cid:18)
d δq
dt −

= δ

=

˙q

+

dq
dτ ·

dτ
dt (cid:19)

δ

(cid:18)

d δt
dτ

.

(30)

(32)

(33)

(34)

(35)

dt
dτ (cid:19)

L +

dt
dτ (cid:18)

∂L
∂q

δq +

δ ˙q

(cid:19)(cid:21)

δS =

dτ

δ

Z

Z

=

=

dτ

(cid:18)
(cid:20)
d δt
dτ (cid:18)
d δt
dτ

dτ

− Z

L

˙q

−

∂L
∂ ˙q (cid:19)

+

H +

dt

Z

(cid:18)

dt

Z
∂L
∂q −

(cid:18)
d
dt

∂L
∂ ˙q
∂L
∂q
∂L
∂ ˙q (cid:19)

δq ,

δq +

∂L
∂ ˙q

d δq
dt (cid:19)

(31)

where the customary partial integration was performed, the boundary conditions (27)
were used and the Hamiltonian

H = ˙q

∂L
∂ ˙q −

L

was introduced.

If only the second integral in the last line of (31) were present, it would yield the
correct equations of motion. Thus, the action functionals (22) and (24) are equivalent
if the Hamiltonian H vanishes. For autonomous systems, H is a constant of motion
equal to the energy E. If the Lagrangian L is replaced with L+E, with E regarded as a
constant, the equations of motion derived from L are unchanged, but the Hamiltonian
E = 0. Thus, the dynamics of trajectories with energy E with
(32) changes to H
respect to the ﬁctitious-time parameter τ is described by the Lagrangian

−

=

L

dt
dτ

(L + E) = f (q, ˙q) (L + E) .

This Lagrangian has to be written as a function of the coordinates q and the ﬁctitious-
time velocities q′.
If the function f is independent of the velocities, the canonical
momenta are invariant under the ﬁctitious-time transformation, because q′ = f (q) ˙q
and

From the time-transformed Lagrangian (33), the transformed Hamiltonian

∂
∂q′ = f (q)
L

d ˙q
dq′

∂L
∂ ˙q

=

∂L
∂ ˙q

.

= q′ ∂

L

H

∂q′ − L

= f (q, ˙q) (H

E)

−

is obtained by the usual Legendre transformation. It must be written as a function
of the coordinates and momenta.
In some cases the passage from the Lagrangian
to the Hamiltonian description of the dynamics is impossible because the relation
(q, q′)/∂q′ cannot be solved for q′. In these cases, the Hamiltonian (35) can
p = ∂
be shown to describe the ﬁctitious-time dynamics by a discussion of the modiﬁed
Hamilton’s principle analogous to the derivation of the Lagrangian

above.

L

L

The Kustaanheimo-Stiefel transformation in geometric algebra

8

3.2. Lagrangian description

The dynamics of an atomic electron under the combined inﬂuences of the nuclear
Coulomb potential, an additional scalar potential V (x) and a magnetic ﬁeld
represented by a vector potential A(x) is described by the Lagrangian

˙x2
2

+

L =

1
r
This Lagrangian must be transformed to a Lagrangian
describing the ﬁctitious-time
dynamics of the position spinor U . With f (q) = 2r = U †U by (12), the ﬁctitious-time
Lagrangian (33) reads

+ V (x)

(36)

˙x .

A

−

L

·

=

U ′†

1
4
L
with x = 1
1
2

U ′†

=

U ′ +

U ′σ3U †

+ E U †U + U †U V (x)

A(x) U ′σ3U †

+ 2

(37)

1
8r D(cid:0)

2

E

(cid:1)
2 U σ3U †. If the constraint (9) is used,

− h
simpliﬁes to

L

i

U ′ + E U †U + U †U V (x)

A(x) U ′σ3U †

+ 2

L
Both forms of the Lagrangian yield the same “on-shell” dynamics for trajectories
satisfying (9). Note that only the kinetic term is inﬂuenced by the constraint, whereas
potential and vector potential terms are not.

− h

i

(38)

The momentum conjugate to U is given by

P = ∂U ′

=

L

σ3U †

U ′σ3U †
h

1
i

−

σ3U †A ,

1
2r

which simpliﬁes to

if (9) is applied.

P = U ′†

σ3U †A

−

L

As the spinor equation of motion (16) is valid under the constraint (9) only, the
provides a suitable description of the dynamics if it reproduces (16)
Lagrangian
for trajectories satisfying (9). The simpliﬁed Lagrangian (38) can therefore be used.
When equations of motion are derived from (38), the constraint (9) must be taken into
account by a Lagrangian multiplier. I will now show, however, that the unconstrained
equation of motion [17]

d
dτ

∂U ′

∂U L

L −

= 0

U ′′†

2EU † = 0 ,

−

derived from (38) reproduces (16) without the constraint being explicitly dealt with,
I
i.e. the Lagrangian multiplier to be introduced turns out to vanish identically.
therefore ignore it from the outset.

For the case of vanishing external potentials, (41) can easily be seen to yield

which is the reversion of (18). For the terms containing the potentials, the calculation
of (41) is still straightforward, but requires a more intimate familiarity with the
properties of the multivector derivative.
I will therefore present the calculation in
detail.

The contribution of the scalar potential term
= U †U V (x(U ))

V

(39)

(40)

(41)

(42)

(43)

The Kustaanheimo-Stiefel transformation in geometric algebra

with x(U ) = 1

2 U σ3U † reads, by (A.22),

= 2U †V (x) + U †U ∂U V (x(U )) .

∂U V

The chain rule (A.24) then yields for any even multivector M

M

∂U V (x(U )) = (M

∂U x(U ))

∂xV

∗

∗

with

M

∂U x(U ) = (M

U σ3U †

∂U )

1
2
M σ3U † +

∗

1
2
M σ3U †
h
In the absence of a magnetic ﬁeld the external force is f = ∂xV , so that

U σ3M †

1 .
i

1
2

=

=

M

∂U V (x(U )) =

M σ3U †

1f
i

i

=

M σ3U †f
h

i

.

hh

∗

∗

∗

Thus,

and ﬁnally

∂U V = ∂M (M

∂U V ) = σ3U †f ,

∗

= 2U †V (x) + 2U †xf .

∂U V

This is the reversion of the scalar-potential terms in (16). Therefore, (49) together
with (42) indeed yields the correct equation of motion.

To evaluate the contribution of the vector potential term

A(x)U ′σ3U †
h
to (41), ﬁrst note that

A

=

i

The second term on the right-hand side can be evaluated by ﬁrst calculating directional
derivatives. For an arbitrary even M , (46) and the chain rule (A.24) yield

By Leibniz’ rule and (8),

d
dτ

∂U ′

=

A

d
dτ

σ3U †A(x)
(cid:1)
(cid:0)

= σ3U ′†A(x) + σ3U †(x′

∂x)A(x) .

·

∂U A

∗

=

∗
U †
A U ′σ3
∂U h
= σ3U ′†A + ∂U h

∗
A U ′σ3U †

∗

+
∂U h
i
A(x(U )) x′

i

.

i

(M

A(x(U )) x′
∂U )
h

i

∗

= (M

∗

∗
(M
h
(M
h

Ax′
∂U A)
∂A
i
h
∂U A(x(U ))) x′
∗
∂x Ax′
∂U x)
∗
∗
Ax′
M σ3U †
1∂x
i
hhh
i
Ax′
M σ3U † ∂x
h

i
i

ih

i

i

,

=
=

=

=

so that

A(x(U )) x′

∂U h

i

A(x(U )) x′
= ∂M (M
∂U )
h
x′) .
= σ3U † ∂x(A

∗

i

·

9

(44)

(45)

(46)

(47)

(48)

(49)

(50)

(51)

(52)

(53)

(54)

The Kustaanheimo-Stiefel transformation in geometric algebra

Equations (51), (52) and (54) combine to

d
dτ

∂U ′

∂U A

A −

= σ3U † ((x′

∂x)A

∂x(A

·
σ3U † (x′
2 U †x( ˙x

=

=

−

−

×

×

B) ,

−

×

(∂x

A))

x′))

·

10

(55)

which is the reversion of the magnetic-ﬁeld contribution to (16).

Note that the derivation given here is valid for arbitrary external potentials
V and A, whereas conventional treatments restrict themselves to the special case
of homogeneous external ﬁelds.
It can obviously be further generalized to include
conservative forces of non-electromagnetic origin. Also note that the geometric algebra
formalism allows one to do the calculations in a straightforward manner without having
to resort to component decompositions of any of the vectorial or spinorial quantities
involved.

3.3. Hamiltonian description

The transition from a Lagrangian to a Hamiltonian description of the dynamics leads
from the Lagrangian (37) or (38), depending on whether or not the constraint (9) is
applied, to the Hamiltonian

= (U ′

,

∗

H

∂U ′ )

L − L

(56)
in which the velocity U ′ has to be expressed in terms of the momentum P . The
transformation requires that the relation (39) or (40) between velocity and momentum
can be solved for the velocity, which is impossible in the case of (39). Thus, the
constraint (9) is not only needed to obtain an unambiguous equation of motion for U ,
but also serves as a condition for a Hamiltonian description of the spinor dynamics to
exist. If it is imposed and an inessential constant of 2 is added, the Hamiltonian reads

=

H

1
2

P † + A U σ3
(cid:0)

P + σ3U †A
(cid:1)

(cid:1) (cid:0)

−

EU †U

U †U V (x) = 2 . (57)

−

Because it is time-independent, the Hamiltonian (57) is a constant of motion. To
describe the physical dynamics, its value must be chosen to be 2, whereas the physical
energy E appears as a parameter in

.

The equations of motion derived from (57) read

H

= P † + A U σ3 ,

U ′ = ∂P H
P ′ =
∂U H
−
2E U †

=

−

−

2U †V (x)

−

σ3

P + σ3U †A
(cid:1)
(cid:0)

2U †x ∂xV
∗
∂x

σ3U †

−
A

−

∗
A x′
h

i

,

x′ = U σ3U ′† = U σ3P + U †U A

where

was used. In terms of coordinates and momenta, the constraint (9) reads

U σ3P
h

3 = 0 .
i

Equation (60) is equivalent to (9) both in the presence and in the absence of a magnetic
ﬁeld. Taken together, (58) and (59) lead back to the equation of motion (16).

(58)

(59)

(60)

The Kustaanheimo-Stiefel transformation in geometric algebra

11

Finally,

let me mention an important subtlety regarding the component
If, according to (7), U is represented as
decomposition of the spinor equation.
3
k=1 ukσk and pk denotes the momentum component
U = u0 + Iu with u =
3
k=1 pkσk.
conjugate to uk, the spinor momentum is P = p0
The negative sign is necessary because in the spinor formulation the bivector Ikpk
is conjugate to Ikuk. Dropping the bivector factors Ik leads to the stated result.

Ip with p =

P

P

−

4. The Kepler problem

The unperturbed Kepler motion is described by the Hamiltonian

1
2
The equations of motion derived from (61) are

E U †U = 2 .

P †P

H

−

=

U ′ = P † ,

P ′ = 2EU †

or, as in (18),

U ′′ = 2EU .

If E < 0, this is the equation of motion of an isotropic four-dimensional harmonic
oscillator, whose general solution reads

U = A cos(√

2E τ ) + B sin(√

2E τ )

−

−

with two constant even multivectors A and B bound, by (9) and (61), to satisfy

and

Aσ3B†
h

3 = 0
i

A†A + B†B =

2
E

−

.

In the case of the pure Kepler motion, the angular momentum vector L and the
Lenz vector ǫ are conserved. Together, they uniquely specify an orbit [9]. I will now
derive the KS-transformed expressions for these constants of motion. Throughout, the
validity of the constraint (9) will be assumed.

The angular momentum vector is given by

I

x ˙x
2 .
h
i
it is more convenient to introduce the angular

(66)

L = x

˙x =

−
Within the geometric algebra,
momentum bivector

×

l = IL =

x ˙x
2 ,
i
h

which speciﬁes the orbital plane instead of the direction perpendicular to it. By (3),
(8) and (9),

(61)

(62)

(63)

(64)

(65)

(67)

(68)

l =

U σ3U † U σ3 ˙U †

2
i

1
2
h
1
2 h
1
2 h

=

=

U U ′†

2
i

U P

2 .
i

The Kustaanheimo-Stiefel transformation in geometric algebra

12

That l

is conserved can be veriﬁed by a straightforward diﬀerentiation.

Alternatively, it can be checked that the Poisson bracket vanishes,

l,

{

H}

∂P l

∂U l
)
∂U l + 2E U †

−

∗

)

∗
∂P l

(∂U H
∗
U †U
h

2
i

2 + E
i

= (∂P H
= P †
∗
1
P †P
2 h
= 0 .

=

(69)

(70)

(71)

(72)

(73)

(74)

Note how the Poisson bracket formalism extends not only to multivector coordinates
U and P , but also to non-scalar arguments.

The Lenz vector is given by

x
r

ǫ = l ˙x

−
= l P †σ3U −1

P †

∂U U −1 =

∗

U σ3U −1 .

ǫ,
, use
{
H}
U −1P †U −1

−

−

To calculate the Poisson bracket

l,

{

H}

= 0 and

to ﬁnd

ǫ,

{

H}

−

H

= l

= l

P †σ3U −1,
(cid:8)
P †
(cid:0)
P †
−
= l

U σ3U −1,
(cid:9)
(cid:8)
P †σ3U −1
+ 2E U †
(cid:0)
U σ3U −1
(cid:0)

∗
(cid:1)
P †σ3U −1P †U −1 + 2EU σ3U −1

(cid:9)
∂P
∗

∂U

∂U

H

∗

(cid:1)

=

−
(cid:0)
P †σ3U −1 + U σ3U −1P †U −1
−
l(
(cid:2)
−

P †σ3U −1P †σ3U † + 2EU U †)
−
P †U † + U σ3U −1P †σ3U †

(cid:1)

P †σ3U −1
(cid:0)

(cid:1)(cid:1)

σ3U −1

U †−1
(cid:3)

Due to the constraint (60),

P †σ3U † = U σ3P ,

so that equation (72) simpliﬁes to

ǫ,

{

H}

l(
(cid:2)

−

=

=

−
(cid:2)
= 0 .

P †P + 2EU †U )

2l

+ 2

U P
h

2
i

H

(cid:3)

P †U † + U P
σ3U −1

−
U †−1

U †−1
(cid:3)

σ3U −1

Thus, the Lenz vector ǫ is actually conserved.

5. The Kustaanheimo-Stiefel description of closed orbits

If the initial conditions x(0) and ˙x(0) for a trajectory are given, the pertinent initial
conditions for the spinors U and U ′ can usually be obtained, up to a choice of gauge,
from (6) and (13). This prescription fails for trajectories starting at the origin, where
the KS transformation is singular. Although at ﬁrst sight these trajectories appear
rather exceptional, they bear a particular signiﬁcance to atomic physics: Semiclassical
closed-orbit theory [10, 11, 15] respresents an atomic photo-absorption spectrum as a
sum over closed classical orbits, i.e. orbits that start at the nucleus and return to it.

The Kustaanheimo-Stiefel transformation in geometric algebra

13

Due to that particular importance, closed orbits deserve a detailed discussion. In this
section, I will derive initial conditions for a trajectory starting at the Coulomb centre.
I will then construct an orthonormal basis of the KS spinor space that is suitable
for an investigation of the stability of orbits closed at the centre because it allows to
separate the physically distinct directions along and transverse to the orbit from the
gauge degree of freedom.

To ﬁnd initial conditions for orbits starting at the nucleus note that in the
vicinity of the nucleus the Coulomb interaction is so strong that it dominates all
external forces. The dynamics close to the nucleus is therefore described by the Kepler
equation of motion (18) and its solution (63). With the initial condition U (τ = 0) = 0
implemented, (63) reads

U ′

0 is the initial velocity in KS-coordinates. It must be normalized to

sin(√

2E τ ) .

−

U (τ ) =

U ′
0
2E

−

√

U ′†

0 U ′

0 = 4 .

The choice of gauge for U ′

0 is arbitrary.

The position vector corresponding to (75) is

x(τ ) =

−
2E
Thus, (75) describes an electron moving out from the nucleus in the direction of the
unit vector

−

(77)

.

U ′

0σ3U ′†
0

1
2

sin2(√

2E τ )

s =

U ′

0σ3U ′†
0 .

1
4

0 is therefore a spinor rotating the vector σ3 to the starting direction s and
In terms of the starting angles ϑ and ϕ it is given

U ′
normalized according to (76).
by

U ′

0 = 2 e−I3ϕ/2e−I2ϑ/2e−I3α/2

with an arbitrary gauge parameter α. The exponentials in (79) describe a sequence of
three rotations taking the reference vector σ3 to the starting direction s. The initial
momentum reads

P0 = U ′†

0 = 2 eI3α/2eI2ϑ/2eI3ϕ/2 .

Its component decomposition is

(75)

(76)

(78)

(79)

(80)

(81)

p0 = 2 cos

cos

p1 = 2 sin

sin

p2 =

2 sin

cos

p3 =

2 cos

sin

−

−

ϑ
2
ϑ
2
ϑ
2
ϑ
2

ϕ + α
2

ϕ

α

−
2

α

ϕ

−
2
ϕ + α
2

,

,

,

.

To describe the stability of a classical trajectory, a coordinate system with one
coordinate along the trajectory and two coordinates perpendicular to it is customarily
introduced in the neighbourhood of the trajectory. A linear stability analysis then
requires calculating the derivatives of positions and momenta with respect to the

The Kustaanheimo-Stiefel transformation in geometric algebra

14

transverse initial conditions. Most conveniently, derivatives with respect to two
orthonormal directions can be used. If these derivatives are to be calculated within
s,
the framework of the KS theory, for a given starting direction s and a direction sω⊥
a KS spinor Pω must be found such that a variation of the initial KS momentum P0
in the direction of Pω corresponds to a variation of s in the direction of sω.

As the initial momentum is given in terms of the starting angles in (80), the
derivatives ∂P0/∂ϑ and ∂P0/∂ϕ can be expected to describe variations of the starting
direction in the directions of increasing ϑ and ϕ, respectively. To check this and to
ﬁnd the correct normalization of the spinors, I will now construct, for a ﬁxed direction
s, a basis of the spinor space such that one of the basis spinors describes a variation
of initial momentum along the orbit, i.e. in the direction of s, two give variations in
the directions of two perpendicular unit vectors, and the fourth basis spinor describes
the gauge degree of freedom introduced by the KS regularization.

To this end, I consider a family of trajectories parameterized by an arbitrary
parameter ω. All trajectories start at the nucleus, the starting direction is given by a
family of vectors s(ω). By (78), the initial KS momenta P0(ω) then satisfy

s(ω) =

P †
0 (ω)σ3P0(ω) ,

so that in complete analogy with (8) and (11)
1
2 (cid:28)

∂P0
∂ω (cid:29)1

∂s
∂ω

0 σ3

P †

=

and

∂P0
∂ω

=

σ3P0

=

P0s

∂s
∂ω

1
2

∂s
∂ω

if the gauge condition

1
4

1
2

P †
0 σ3

(cid:28)

∂P0
∂ω (cid:29)3

= 0

is imposed. Equation (84) gives the variation in the initial KS momentum pertinent
to a given variation in the starting direction. If two diﬀerent variations are given, the
scalar product of the momentum variations is

so that the variations of KS momentum calculated from (84) are orthonormal if the
prescribed variations of the starting direction are.

given by the starting angles ϑ and ϕ, I now introduce the orthogonal vectors

†

∂P0
∂ω1 (cid:19)

(cid:18)

∂P0
∂ω2

∗

=

∂s
∂ω1 ∗

∂s
∂ω2

,

For a ﬁxed starting direction

s = e−I3ϕ/2e−I2ϑσ3eI3ϕ/2

sϑ = e−I3ϕ/2e−I2ϑσ1eI3ϕ/2 ,
sϕ = e−I3ϕ/2σ2eI3ϕ/2 .

Ps = 1
Pϑ = 1
Pϕ = 1

2 σ3P0s = 1
2 σ3P0sϑ= I2
2 σ3P0sϕ=

2 P0 ,
2 e−I3αP0 ,
I1
2 e−I3αP0 .

−

These are the unit vectors in the directions of ∂s/∂ϑ and ∂s/∂ϕ, respectively. The
orthonormal basis s, sϑ and sϕ of the position space gives rise to the three orthonormal
KS spinors

(82)

(83)

(84)

(85)

(86)

(87)

(88)

(89)

The Kustaanheimo-Stiefel transformation in geometric algebra

This set is complemented by a fourth orthonormal spinor

Pα =

=

σ3P0I .

∂P0
∂α

1
2

P †
0 σ3Pα =

P †
0 σ3Pαi
h

3 .

(Note the analogy with (84).) The spinor Pα maximally violates the gauge condition
(85) in the sense that

It therefore gives the direction in spinor space that corresponds to a gauge
transformation, whereas Ps describes a change of momentum along the orbit (i.e.
a change of the energy) and Pϑ and Pϕ give directions perpendicular to the trajectory.
The desired separation of the physically distinct degrees of freedom has thus been
achieved. Note that Pϑ = ∂P0/∂ϑ as anticipated, whereas ∂P0/∂ϕ = P0I3/2 does not
satisfy (85). Instead,
∂P0
∂ϕ

= Pα cos ϑ + Pϕ sin ϑ .

(92)

In components, the four basis spinors read

,

2

−

−

−

Pϕ =

2 cos ϕ+α
2 cos ϕ+α
2 sin ϕ+α
2 sin ϕ+α

2 sin ϕ−α
2 sin ϕ−α
2 cos ϕ−α
2 cos ϕ−α

2 cos ϕ−α
2 cos ϕ−α
2 sin ϕ−α
2 sin ϕ−α

Ps = cos ϑ
sin ϑ
Pϑ =
sin ϑ
cos ϑ

I1 sin ϑ
2 −
I1 cos ϑ
2 −
I1 cos ϑ
2 −
2 + I1 sin ϑ

2 + I2 sin ϑ
2 + I2 cos ϑ
I2 cos ϑ
2 −
2 + I2 sin ϑ
Pα =
These formulae prescribe a basis of the spinor space uniquely up to the choice of α if
= 0, π. At the poles, the angle ϕ is undeﬁned. Because in this case (88) gives a pair
ϑ
of orthonormal tangent vectors for any choice of ϕ, (93) can be used with arbitrary ϕ.
The basis Ps, Pϑ, Pϕ, Pα of the KS momentum space can be supplemented by position
spinors Uj = P †
j to obtain the basis of a canonical coordinate system in spinor space.
This basis set can then be used to investigate the stability properties of closed orbits.

2 + I3 cos ϑ
I3 sin ϑ
2 −
2 + I3 sin ϑ
2 + I3 cos ϑ

2 sin ϕ+α
2 sin ϕ+α
2 cos ϕ+α
2 cos ϕ+α

(93)

2

2

2

,

.

,

As a particular application, consider the stability determinant

M ′ = det

∂(pϑf , pϕf )
∂(ϑi, ϕi)

occurring in the closed-orbit theory description of atoms in crossed-ﬁelds [12,13,14,15].
It encodes the stability of a closed orbit starting from the nucleus in the direction
characterized by the angles ϑi, ϕi and returning from the direction ϑf , ϕf . As it stands,
(94) is not well suited to practical computations because it suﬀers from the singularities
of the spherical coordinate chart: At the poles, neither the angle ϕ nor the angular
momenta pϑ and pϕ are well deﬁned, so that close to the poles, the calculation of the
determinant becomes numerically unstable. With the help of the spinor basis (93),
(94) can be rewritten in a form that is not plagued by any singularities.

For a trajectory returning to the nucleus at time τ = 0 with a ﬁnal KS momentum

Pf , the solution (75) of the Kepler equation of motion takes the form

15

(90)

(91)

(94)

(95)

P †
f
2E

U (τ ) =

√
P (τ ) = Pf cos(√

−

sin(√

2E τ ) =

−

r
2

P †
f ,

−r

2E τ ) = √1 + ErPf ,

−

which is valid as soon as the electron is suﬃciently close to the nucleus so that the
external ﬁelds can be neglected. In (95), the normalization condition U †U = 2r and
the pseudo-energy conservation (61) were used.

6
The Kustaanheimo-Stiefel transformation in geometric algebra

16

To discuss the stability properties of an orbit, consider a family of orbits
parameterized by an arbitrary parameter ω1. Equations of motion for the derivatives
∂U/∂ω1 and ∂P/∂ω1 are then obtained by linearizing the equations of motion for
U and P around the unperturbed trajectory. Close to the nucleus the dynamics in
governed by the linear equations (62), so that the perturbations satisfy the same
equations of motion as the coordinates and momenta. In analogy with (63), they read

=

M †
1
2E

√

−
= M1 cos(√

sin(√

2E τ ) + M2 cos(√

2E τ ) ,

−

−

2E τ )

√

2E M †

2 sin(√

2E)

−
with constant even multivectors M1 and M2. With the help of the normalizations
inferred from (95), equation (96) simpliﬁes to

−

−

−

∂U
∂ω1
∂P
∂ω1

∂U
∂ω1
∂P
∂ω1

=

−r

r
2

M †

1 + √1 + Er M2 ,

= √1 + Er M1

√2rE M †
2

−

so that the constants M1 = ∂Pf /∂ω1 and M1 = ∂Uf /∂ω1 can ﬁnally be identiﬁed
with the values of the derivatives obtained at r = 0.

According to (68), the angular momentum component in a plane speciﬁed by a

bivector B is

LB = L

B =

BU P

.

∗

i

1
2 h

∂LB
∂ω1

=

1
2 (cid:28)

Pf B

∂Uf
∂ω1 (cid:29)

.

The derivative of LB with respect to a parameter ω1 can then be calculated with the
help of (97). It is given by

It does not depend on r because all components of the angular momentum bivector
are conserved in the Coulomb region.

For the angular momentum component pω2 conjugate to an angular coordinate

ω2, the relevant bivector is
∂s
∂ω2

B = s

,

so that

(96)

(97)

(98)

(99)

(100)

(101)

∂pω2
∂ω1

=

1
2 (cid:28)

Pf s

∂s
∂ω2

∂Uf
∂ω1 (cid:29)

=

Pω2

(cid:28)

∂Uf
∂ω1 (cid:29)

,

where Pω2 denotes the basis spinor corresponding to ω2 by (84) with the ﬁnal
momentum Pf used in place of P0.

Consider coordinates ¯ϑ and ¯ϕ, such that ∂s/∂ ¯ϑ = sϑ and ∂s/∂ ¯ϕ = sϕ are unit

vectors given by (88). The stability determinant M ′ can then be rewritten as

det

∂(pϑf , pϕf )
∂(ϑi, ϕi)

= det 

∂p ¯ϑf
∂ ¯ϑi

sin ϑf

∂p ¯ϕf
∂ ¯ϑi



sin ϑi

∂p ¯ϑf
∂ ¯ϕi

sin ϑi sin ϑf

∂p ¯ϕf
∂ ¯ϕi





= sin ϑi sin ϑf M

(102)

The Kustaanheimo-Stiefel transformation in geometric algebra

with a 2

2-determinant

×

M = det 

Pϑ

Pϕ

D

D

∂Uf

∂Uf

∂ ¯ϑi E D
∂ ¯ϑi E D

Pϑ

Pϕ

∂Uf
∂ ¯ϕi E
∂Uf
∂ ¯ϕi E







free of any coordinate-induced singularities. It is this form of the stability determinant
that was used in [15].

The derivatives ∂Uf /∂ω needed in (103) can be calculated numerically by

integrating the linearized equations of motion

d
dτ
d
dτ

∂U
∂ω
∂P
∂ω

=

=

(cid:18)

∂U
∂ω ∗
∂U
∂ω ∗

− (cid:18)

∂U (cid:19)

∂P H

+

(cid:18)

∂P (cid:19)

∂P H

,

∂U (cid:19)

∂U H − (cid:18)

∂P (cid:19)

∂U H

∂P
∂ω ∗
∂P
∂ω ∗

17

(103)

(104)

(105)

along the closed orbit with initial conditions

∂U
∂ω

(0) = 0 ,

(0) = Pω .

∂P
∂ω

6. Conclusion

The geometric-algebra formulation of the KS transformation endows the four KS
coordinates with a clear geometric interpretation. It was shown in this paper that it
also allows for an easy incorporation into a Lagrangian and Hamiltonian formulation
of the KS theory. At the same time, the known KS Hamiltonian, that was restricted to
homogeneous external ﬁelds, was generalized to describe the KS motion in arbitrary
static external electromagnetic ﬁelds. This result is of interest beyond the realm
of atomic physics because it is equally applicable to an arbitrary conservative non-
electromagnetic force.

Closed orbits starting at and returning to the Coulomb centre require a special
treatment that takes the singularity of the KS coordinate frame into account. The
geometric algebra oﬀers a convenient way to derive closed orbit initial conditions and
a basis of the spinor space that separates physically distinct degrees of freedom.

The calculations carried out here amply illustrate the power of the geometric
algebra formulation of the KS theory. It can thus be expected to form a convenient
starting point for analytic calculations in classical perturbation theory.

Appendix A. Introduction to geometric algebra

Geometric algebra is an algebraic system designed to represent the geometric
properties of Euclidean space in the most comprehensive and systematic way possible.
It was pioneered by Hermann Grassmann and William Kingdon Cliﬀord during the
nineteenth century. From the 1960’s on, David Hestenes, with the aim of providing
a universal mathematical framework for theoretical physics, extended the algebraic
techniques of Grassmann and Cliﬀord by a diﬀerential and integral calculus within
the geometric algebra, which he called geometric calculus [16].

This appendix gives only a sketch of geometric algebra as far as it is needed in
the present work. A more extensive introduction, with an extension to Minkowski
spacetime, is contained in [18, 17]. A thorough introduction to the geometric algebra
of Euclidean 3-space, with a detailed discussion of applications to classical mechanics,

The Kustaanheimo-Stiefel transformation in geometric algebra

18

can be found in [9]. A detailed presentation of the mathematical properties of the
geometric algebra is given in [16].

Appendix A.1. The geometric algebra of Euclidean 3-space

The orientation of two vectors a and b in space can be characterized by the projection
b, and the
of one vector onto the other, which is described by the scalar product a
b. In
plane spanned by a and b, which is characterized by the vector product a
the geometric algebra these complementary products a
b are uniﬁed into a
single “geometric” product ab. The construction of the geometric product starts by
picking a right-handed frame of orthonormal unit vectors σ1, σ2 and σ3. For them,
the existence of an associative, but non-commutative geometric product satisfying

b and a

×

×

·

·

σiσj + σjσi = 2δij

(A.1)

is assumed. In addition, the geometric product is required to obey the distributive
law with respect to the usual addition of vectors. It follows from (A.1) that σ2
i = 1 is
a scalar. The reader may notice that the deﬁning relation (A.1) is the same as obeyed
by the Pauli spin matrices. Indeed, these matrices generate a matrix representation
of the Cliﬀord algebra of Euclidean 3-space.
In the present context, however, it
is important to retain the interpretation of the σi as ordinary vectors instead of
regarding them as matrices. The elements of the Cliﬀord algebra are thus given a
geometric interpretation, as is indicated by the name “geometric algebra” introduced
by Cliﬀord himself. It turns out that all calculations within geometric algebra can be
done without recourse to a matrix representation.

By virtue of the deﬁning relation (A.1), the geometric product of two arbitrary

vectors a =

3
i=1 aiσi and b =

3
i=1 biσi is

P

ab = a1b1 + a2b2 + a3b3

P

(a2b3

a3b2)σ2σ3 + (a3b1

a1b3)σ3σ1 + (a1b2

−

−

The scalar terms of this equation comprise the scalar product a
In addition,
there are terms containing the product of two orthogonal vectors. These terms are
neither scalars nor vectors. They are referred to as bivectors. As their coeﬃcients
b, bivectors should be interpreted
are the components of the vector cross product a
as describing an oriented area in the same way as a vector describes an oriented line
segment. Accordingly, a product of three orthonormal vectors is called a trivector and
interpreted as representing an oriented volume element. With the help of the unit
trivector

×

·

(A.2)
a2b1)σ1σ2 .

−
b.

I = σ1σ2σ3 ,

equation (A.2) can be rewritten as

ab = a

b + Ia

b ,

·

×

(A.3)

(A.4)

which achieves the desired uniﬁcation of the scalar and vector products. Notice
that (A.4) contains a sum of quantities of diﬀerent types, a scalar and a bivector.
This should be regarded as a formal sum combining quantities of diﬀerent types into
a single object with a scalar and a bivector part, in analogy to how a real and an
imaginary number are added to yield a complex number.

The Kustaanheimo-Stiefel transformation in geometric algebra

19

As the scalar product is symmetric in its factors whereas the vector product is

anti-symmetric, these products can be recovered from the geometric product via

a

b =

(ab + ba) ,

a

b =

(ab

ba) .

−

1
2
1
2I

·

×

∗

∗

A

B =

AB
h

i

.

A

B = B

A .

∗

In particular, parallel vectors commute under the geometric product whereas
perpendicular vectors anti-commute, and any vector a satisﬁes aa = a

a.

It is a crucial feature of the geometric algebra that it contains elements of diﬀerent
grades, viz.
scalars, vectors, bivectors, and trivectors. A general element can be
written as a sum of these pure-grade components and is called a multivector. The
pure-grade parts of any multivector can be extracted by means of a grade projector.
Let
ik be the grade-k part of the multivector A. Due to its particular importance,
A
h
the scalar projector can be abbreviated as
0, and the scalar product of two
A
A
i
h
i
h
multivectors A and B is deﬁned by

=

·

For vectors, this agrees with the scalar dot product. Any two multivectors commute
under the scalar product:

In a term containing diﬀerent kinds of products, the scalar product as well as the
vector cross product are understood to take precedence over the geometric product.
This convention has already been used in (A.4).

A multivector which contains only parts of even grades, i.e., scalars and bivectors,
is referred to as an even multivector. The even multivectors form a subalgebra of the
full geometric algebra.

Finally, the reversion A† of a multivector A is obtained by interchanging the order
of vectors in any geometric product. Thus, bivectors and trivectors change sign under
reversion, whereas scalars and vectors remain unchanged. Formally, the reversion can
be deﬁned by the properties a† = a for any vector a and

(AB)† = B†A† ,

(A + B)† = A† + B†

(A.8)

for multivectors A and B.

Appendix A.2. Rotations in the geometric algebra

Within the geometric algebra rotations are conveniently represented in the form

with an even multivector R satisfying the normalization condition

Conversely, any normalized even multivector describes a rotation. An arbitrary even
multivector satisﬁes α = U U †
0, so that U = √αR is a multiple of a rotor R.
Therefore,

≥

(A.5)

(A.6)

(A.7)

(A.9)

(A.10)

(A.11)

(A.12)

R(a) = RaR†

a

7→

RR† = 1 .

U aU † = αRaR† ,

U aU † =

U aU †
h

1
i

and U describes a rotation-dilatation of 3-space. In particular,

The Kustaanheimo-Stiefel transformation in geometric algebra

20

is a vector for any even multivector U and any vector a.

A rotation can be characterized by specifying two vectors a and b so that a is
2 spanned by a and b. The rotor R
ab
i
h

mapped to b by a rotation in the plane
describing this rotation is

R =

1 + ba
a + b
|
|

=

1 + ba
2(1 + a

.

b)

·
If, alternatively, a rotation is characterized by its rotation axis, given by a unit vector
n, and a rotation angle ϕ, the pertinent rotor reads

p

where the exponential function of an arbitrary multivector is deﬁned by the familiar
power series

R = e−Inϕ/2 ,

eA =

∞

Xn=0

An
n!

.

eA+B = eAeB

It satisﬁes the “power law” relation

if AB = BA and

eAB = BeA
eAB = Be−A

if AB = BA ,
if AB =

BA .

−

Appendix A.3. The multivector derivative

The formalism of the multivector derivative provides a diﬀerential calculus for
arbitrary multivector functions. Let F (X) be a smooth multivector-valued function of
the multivector argument X. Neither the grades contained in X nor in F are speciﬁed.
The directional derivative in the direction of a ﬁxed multivector A by

A

∂X F (X) =

∗

dF (X + τ PX (A))
dτ

,

(cid:12)
τ =0
(cid:12)
(cid:12)
(cid:12)

where PX (A) projects A onto the grades contained in X.
familiar deﬁnition of the directional derivative.

(A.19) agrees with the

Let eJ , J = 1, . . . , 8 be a basis of the geometric algebra and eJ its dual basis, i.e.,
eK = δK

J . The multivector derivative is then deﬁned to be

eJ ∗

∂X =

eJ eJ ∗

∂X .

XJ

It inherits the algebraic properties of its argument X. In particular, ∂X contains the
∂X is indeed the directional
same grades as X. Notice that the scalar product A
derivative in the direction A, justifying the notation introduced in (A.19). For a vector
argument x, the multivector derivative ∂x reduces to the vector derivative, which is
analogous to the familiar nabla operator.

∗

Both the directional derivative and the multivector derivative are linear operators

and satisfy Leibniz’ rule

∗

A

∂X

F (X)G(X)
(cid:1)
(cid:0)
∗
∂X

A
(cid:0)

=
∗
∗
F (X)G(X)+

A
G(X) + F (X)
∂X F (X)
(cid:1)
(cid:0)
∗
∗
∂X F (X)
G (X) .

∂X (F (X)G(X)) =

∗

∂X G(X)
(cid:1)

,

(A.21)

(A.22)

(A.13)

(A.14)

(A.15)

(A.16)

(A.17)
(A.18)

(A.19)

(A.20)

The Kustaanheimo-Stiefel transformation in geometric algebra

21

In (A.22), the overstars indicate the functions to be diﬀerentiated. Notice that the
second term in (A.22) is in general diﬀerent from F (X)
, because due
∂X G(X)
to its multivector properties the multivector derivative does not commute with F
(cid:1)
(cid:0)
even if F (X) is not diﬀerentiated. The directional derivative, on the contrary, is
a scalar diﬀerential operator that commutes with any multivector that is not to be
diﬀerentiated. For this reason it is often convenient to write the multivector derivative
as

∂X = ∂A A

∂X .

∗

This form decomposes ∂X into a multivector ∂A and a scalar diﬀerential operator
A

∂X , which can be moved freely among multivectors.
In addition, the directional derivative satisﬁes the chain rule

∗

A
∗
(cid:0)
which is useful in many calculations.

∂X F (G(X)) =

A

∗

∂X G(X)
(cid:1)

∗

∂GF (G) ,

A fundamental result concerning the multivector derivative is

∂X h

XA
i

= ∂X h

i

AX

= PX (A)

for any multivector A. As a consequence,

∂X h

X †A
i

= ∂X h

i

AX †

= PX (A†) .

References

(A.23)

(A.24)

(A.25)

(A.26)

[1] Euler L 1765 Novi Comm. Acad. Sci. Petrop. 11 144
[2] Levi-Civit`a T 1956 Opere mathematiche 2
[3] Kustaanheimo P 1964 Annales Universitatis Turkuensis. Ser. AI. 73
[4] Kustaanheimo P and Stiefel E 1965 J. Reine Angew. Mathematik 218 204
[5] Stiefel E and Scheifele G 1971 Linear and Regular Celestial Mechanics (Springer)
[6] Gourlay M J, Uzer T and Farrelly D 1993 Phys. Rev. A 47 3113, erratum 48 2508
[7] von Milczewski J and Uzer T 1997 Phys. Rev. E 55 6540
[8] Sadovski´ı D A and Zhilinski´ı B I 1998 Phys. Rev. A 57 2867
[9] Hestenes D 1990 New Foundations for Classical Mechanics (Kluwer Academic Publishers)
[10] Du M L and Delos J B 1988 Phys. Rev. A 38 1896 and 1913
[11] Bogomolny E B 1989 Sov. Phys. JETP 69 275
[12] Ellerbrock T 1991 Der Zusammenhang zwischen den klassischen Trajektorien und dem
Photoabsorptionsspektrum des hochangeregten Wasserstoﬀatoms in gekreuzten elektrischen
und magnetischen Feldern Master’s thesis Universit¨at Bielefeld, Germany

[13] Main J 1991 Das hochangeregte Wasserstoﬀatom im Magnetfeld und in gekreuzten magnetischen

und elektrischen Feldern Ph.D. thesis Universit¨at Bielefeld, Germany

[14] Bartsch T 2002 The hydrogen atom in an electric ﬁeld and in crossed electric and magnetic

ﬁelds: Closed-orbit theory and semiclassical quantization. (G¨ottingen, Germany: Cuvillier)

[15] Bartsch T, Main J and Wunner G Semiclassical quantization of the hydrogen atom in crossed
electric and magnetic ﬁelds phys. Rev. A, submitted. LANL preprint nlin.CD/0212017
[16] Hestenes D and Sobczyk G 1984 Cliﬀord Algebra to Geometric Calculus (D. Reidel Publishing

Company)

[17] Lasenby A N, Doran C J L and Gull S F 1993 Found. Phys. 23 1295
[18] Gull S F, Lasenby A N and Doran C J L 1993 Found. Phys. 23 1175
[19] Dirac P A M 1933 Proc. Camb. Phil. Soc. 29 389
[20] Dirac P A M 1950 Canad. J. Math. 2 129

