0
0
0
2
 
n
a
J
 
3
 
 
]
h
p
-
s
s
a
l
c
.
s
c
i
s
y
h
p
[
 
 
1
v
5
0
0
1
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

An asymptotic form of the reciprocity theorem
with applications in x-ray scattering

Ariel Caticha
Department of Physics, University at Albany-SUNY,
Albany, NY 12222, USA.
ariel@cnsvax.albany.edu

Abstract

The emission of electromagnetic waves from a source within or near
a non-trivial medium (with or without boundaries, crystalline or amor-
phous, with inhomogeneities, absorption and so on) is sometimes studied
using the reciprocity principle. This is a variation of the method of Green’s
functions. If one is only interested in the asymptotic radiation ﬁelds the
generality of these methods may actually be a shortcoming: obtaining
expressions valid for the uninteresting near ﬁelds is not just a wasted ef-
fort but may be prohibitively diﬃcult. In this work we obtain a modiﬁed
form the reciprocity principle which gives the asymptotic radiation ﬁeld
directly. The method may be used to obtain the radiation from a pre-
scribed source, and also to study scattering problems. To illustrate the
power of the method we study a few pedagogical examples and then, as a
more challenging application we tackle two related problems. We calcu-
late the specular reﬂection of x rays by a rough surface and by a smoothly
graded surface taking polarization eﬀects into account. In conventional
treatments of reﬂection x rays are treated as scalar waves, polarization
eﬀects are neglected. This is a good approximation at grazing incidence
but becomes increasingly questionable for soft x rays and UV at higher
incidence angles.

PACs: 61.10.Dp, 61.10.Kw, 03.50.De

1 Introduction

The principle of reciprocity can be traced to Helmholtz in the ﬁeld of acoustics.
It states that everything else being equal the amplitude of a wave at a point
A due to a source at point B is equal to the amplitude at B due to a source
at A. With its extension to electromagnetic waves by Lorentz [1] and later to
quantum mechanical amplitudes [2], the applicability to all sorts of ﬁelds was
made manifest. Nowadays the principle is regarded as a symmetry of Green’s
functions when the source point and the ﬁeld point are reversed. This symmetry
is actually quite general. As shown in [3] the conditions of time-reversal invari-

1

ance and hermiticity of the Hamiltonian are suﬃcient to guarantee reciprocity,
but they are not necessary; in fact, reciprocity holds even in the presence of
complex absorbing potentials.
In the case of electromagnetic waves the only
requirement is that the material medium be linear and described by symmetric
permittivity and permeability tensors [4][5]. This excludes plasmas and ferrite
media in the presence of magnetic ﬁelds.

In the ﬁeld of x-ray optics the principle was used by von Laue [6] to explain
the diﬀraction patterns generated by sources within the crystal, the so-called
Kossel lines [7]. More recently there has been a widespread recognition that
these interference patterns contain information not just about intensities but
also about phases and can be thought of as holographic records from which real
space images of the location of the internal sources can be reconstructed. Thus,
under the modern name of ‘x-ray holography’ there has been a considerable
revival of interest in this subject [8].

However, powerful as it is, the usual formulation of the reciprocity principle
suﬀers from a rather serious drawback: it refers to the exchange of source and
ﬁeld points. As a consequence, a careful application of the principle requires one
to consider the emission of spherical waves which in crystalline media or even
in the mere presence of plane boundaries, can be surprisingly diﬃcult (recall
e.g.
studying the radiation by an antenna in the vicinity of the conducting
surface of the Earth [9] or of layered media [10]). Furthermore, one is typically
interested in the asymptotic radiation ﬁelds so the relevant exchange should
involve a source point here with a ﬁeld point at inﬁnity.

These technical diﬃculties have not deterred the users of reciprocity from
using the principle to make valuable predictions, but a high price has been paid.
The required asymptotic limits are usually taken verbally and no accounts are
given of where and how spherical waves are replaced by plane waves. Such
sleights of hand, because skillfully performed, have not lead to wrong results,
but intensities are predicted only up to undetermined proportionality factors
and this excludes applications to classes of problems where absolute intensities
are needed. Moreover one is left with the uneasy feeling that the validity of
the predictions is justiﬁed mostly on the purely pragmatic grounds that for the
problem at hand they seem to work which, again, limits applications to problems
that are already familiar.

The main goal of this paper (section 2) is to obtain a modiﬁed form of the
reciprocity theorem that gives the asymptotic radiation ﬁelds directly and that
accommodates plane waves and both point and extended sources in a natu-
ral way. Remarkably the resulting expressions, which include all the relevant
proportionality factors and yield absolute, not just relative intensities, are very
simple.

For many problems the Asymptotic Reciprocity Theorem (ART) obtained
here represents an improvement not only over the usual form of the reciprocity
theorem but also over the method of Green’s functions. Computing the Green’s
function requires solving a boundary value problems for spherical waves in the
presence of plane boundaries and/or periodic media; this may well be an in-
tractably diﬃcult problem. Furthermore, a considerable eﬀort is wasted by ﬁrst

2

obtaining both near ﬁelds and far ﬁelds and then discarding the uninteresting
near ﬁelds. The ART is a shortcut that discards the near ﬁelds before, rather
than after they are computed.

To illustrate the power of the method we consider several applications. The
ﬁrst three (section 3) are brief pedagogical examples of increasing complexity.
First the ART is used to calculate the ﬁelds radiated by an arbitrary prescribed
source in vacuum; next as an application to scattering problems we reproduce
the kinematical theory of diﬀraction by crystals. The third example, the radi-
ation by a current located near a plane dielectric boundary, is straightforward
when the ART is used but not if other methods are used. One must emphasize
that what is new in these examples are not the results, but the method; the ﬁrst
two are standard textbook material, a special case of the third is treated in [9].
As a more involved application of the ART, in section 4 we combine ideas from
the three previous examples to study two other related scattering problems, the
specular reﬂection of polarized x rays by a rough surface and by a continuously
graded surface.

The technique of the grazing-incidence reﬂection of x-rays has received con-
siderable attention [11]-[17] from both the theoretical and the experimental sides
as a means to obtain structural information about surfaces. The eﬀect of sur-
face roughness on the reﬂection is taken into account by multiplying the Fresnel
reﬂectivity of an ideal sharp and planar surface by a “static Debye-Waller” fac-
tor. The problem is to calculate this corrective factor. The calculation has
been carried out in several diﬀerent approximations. The Rayleigh or Born ap-
proximation [11] is satisfactory for rough surfaces with long lateral correlation
lengths but for x-rays the situations of interest generally involve short lateral
correlation lengths. Here other approximations such as the distorted-wave Born
approximation [13][14] and the Nevot-Croce approximation [15] are used. For
variations and interpolations between these two methods see [16], and for a gen-
eralization to surfaces with non-Gaussian roughness and to graded interfaces of
arbitrary proﬁle see [17]. In these treatments ([14] is an exception) the x rays
are treated as scalar waves. One expects this approximation to hold at graz-
ing incidence but at higher incidence angles (e.g., for soft x rays) its validity
becomes increasingly questionable. Using a modiﬁed ﬁrst Born approximation
Dietrich and Haase [14] took the vector character of the x rays into account but
they point out that the validity of their approximation is not in general easy to
assess and they restrict themselves to studying special interface proﬁles.

In section 4 we study this problem using a diﬀerent approximation; we use
the ART to develop approximations of the Nevot-Croce type [17]. There is, of
course, a trivial polarization dependence that is already described by Fresnel
formulas for the reﬂectivity of the ideal ﬂat step surface. The question we
address here is whether the “static Debye-Waller” factor shows any additional
dependence on polarization. The ﬁnal result is remarkably simple: the “static
Debye-Waller” factor for the specularly reﬂected vector waves is the same for
both polarizations and coincides with that for scalar waves. Finally, some brief
concluding remarks are collected in section 5.

3

Figure 1: (a) In the usual form of the reciprocity theorem the surface S encloses
the medium, and all sources. (b) For the asymptotic form of the reciprocity
theorem the connecting ﬁeld ~Ec is a radiation ﬁeld, its source lies outside the
surface S = S+ + S

.

′

2 The reciprocity theorem and its asymptotic

form

We wish to calculate the asymptotic radiation ﬁelds ~E and ~H generated by a
prescribed current ~J (t, ~r) located near or within a linear medium,

Di = εij Ej

and Bi = µijHj .

We will assume that the tensors εij (~r) and µij (~r) are symmetric, but otherwise
the situation remains quite general, the medium may have an irregular shape,
or be inhomogeneous, crystalline or amorphous, absorbing, dispersive, etc.

As in the usual deduction of the reciprocity theorem (see e.g., [4]), we con-
sider a second set of ﬁelds ~Ec and ~Hc, which we will call the “connecting ﬁelds”,
generated by a source ~Jc (see ﬁg.1a). For simplicity we will also assume that all
ﬁelds and sources are monochromatic ~E = ~E(~r)e−iωt, ~J = ~J(~r)e−iωt, etc. For
linear media this is not a restriction.

From Maxwell’s equations

~E = iK ~B

and

∇ ×

~H =

iK ~D +

∇ ×

−

4π
c

~J,

(1)

where K

ω/c, one easily obtains the following identity

≡

~E

~Hc −

~Ec ×

~H

×

∇ ·

(cid:16)

=

4π
c

(cid:16)

~J

~Ec ·

−

~E

~Jc

,

·

(cid:17)

(cid:17)

4

(2)

(3)

which, on integrating over a large volume V bounded by the surface S, can be
rewritten as

~E
(cid:16)

ZS

~Hc −

~Ec ×

~H

×

d~s =

4π
c

·

(cid:17)

ZV

(cid:16)

~J

~Ec ·

−

~E

~Jc

·

dv.

(cid:17)

This expression simpliﬁes if one deals with point sources. For example, consider
oscillating point dipoles ~poe−iωt and ~pce−iωt, located at ~ro and ~rc respectively.
~ro) e−iωt and ~Jc is given by
The current density ~J is given by ~J =
−
an analogous expression. Further simpliﬁcation is achieved if one assumes that
the surface S is so remote that the surface integral is negligibly small [18], then

iω~poδ (~r

−

~Ec (~ro)

~po = ~E (~rc)

~pc .

·

·

This is the usual form of the reciprocity theorem; it says that if we know ~Ec at
the location of ~po we can calculate ~E at the location of ~pc. This elegant result
takes us a long way toward a ﬁnal answer for ~E, but the remaining problem of
calculating ~Ec, that is, the calculation of how the spherical wave generated by
~pc is scattered by the medium, can still be too diﬃcult.

A more useful version of the theorem can be obtained once one realizes
that the connecting ﬁeld is merely a tool that codiﬁes information about the
inﬂuence of the non-trivial medium. Above, the ﬁeld ~Ec has been introduced
by ﬁrst specifying a source ~Jc, but clearly this is an unnecessary additional
In fact, since the most convenient ~Jc is that which results in
complication.
the simplest ~Ec it is best to focus attention directly on the ﬁeld rather than
its source. Thus we move ~Jc outside the surface S, to inﬁnity (see ﬁg.1b) so
that throughout the volume V the connecting ﬁeld ~Ec is a pure radiation ﬁeld.
Furthermore, let the surface S itself be so distant that on S itself both ~E and
~Ec are vacuum radiation ﬁelds. Then

~E
(cid:16)

ZS

(
∇ ×

×

~Ec)

~Ec ×

(
∇ ×

−

d~s =

4πiK
c

~E)
(cid:17)

·

~J dv.

~Ec ·

ZV

(4)

At this point it is not yet clear that this form of the reciprocity theorem is
simpler than eq. (3) but one remarkable feature can already be seen: eq. (4)
relates the ﬁeld ~E at a distant surface S to its source ~J within a nontrivial
medium without having to calculate ~E in the vicinity of ~J. The “connection”
between the distant radiation ﬁeld ~E and its source ~J is achieved through the
much simpler (i.e., hopefully calculable) “connecting” ﬁeld ~Ec.

To bring eq. (4) into a form that is manifestly simpler than (3) the surface
. In ﬁg.1b the upper face,
S is chosen as a cube with edges of length L
deﬁned by a constant z coordinate, z = z+, has been singled out as S+, the
remaining seven faces are denoted S

→ ∞

.

′

On the upper face S+ we write the ﬁeld ~E as a superposition of outgoing

plane waves of wave vector ~k satisfying ~k

~k = ω2/c2 = K 2 and kz > 0,

K) ~E(~k) ei~k·~r ,

(5)

·

d3k
(2π)3 2πδ (k

−

~E (~r) =

Zkz>0

5

where, in a self-explanatory notation, ~k
~r⊥ + kzz+. It is here, by the
·
very act of writing ~E in this form, that the asymptotic limit of discarding near
ﬁelds is being taken. For z << z+ additional terms describing the near ﬁelds
should be included.

~r = ~k⊥

·

The integral over dkz is most easily done using

δ (k

K) =

−

δ

K
kz (cid:20)

kz −
(cid:18)

K 2

k2
⊥

−

δ

kz +

−

(cid:19)

(cid:18)

q

q

K 2

k2
⊥

−

(cid:19)(cid:21)

.

(6)

The result is

~E (~r) =

d2k⊥
(2π)2

K
kz

Z

~E(~k) ei~k·~r,

where kz = +

K 2

k2
⊥.

−

p

The choice of the connecting ﬁeld ~Ec is dictated purely by convenience. A
particularly good choice for ~Ec is the superposition of an incoming plane wave
of unit amplitude (we use ˆ to denote vectors of unit length) and wave vector
~kc = K 2 and kcz < 0, plus all the waves scattered by the medium,
~kc, with ~kc ·

~Ec (~r) = ˆec ei~kc·~r + ~E

′

c (~r) .

On S+, the scattered ﬁeld ~E
given also in a form analogous to eq. (7),

′

c is a superposition of outgoing plane waves and is

′

~E

c (~r) =

′
d2k
⊥
(2π)2

K
k′
z

Z

′

′

~E

c(~k

′

) ei~k

·~r,

′

with ~k

′
~r = ~k
⊥

′

′

~r⊥ + k

zz+ and k

z = +

·

·

′2
⊥ .
k

K 2

−

Now we are ready to calculate the surface integral on the left hand side of
q
eq. (4). Substituting (8) into (4) the integral over S+ separates into two terms,
one due to the incoming plane wave ˆec ei~kc·~r, and the other due to the scattered
waves ~E

c (~r). The ﬁrst term is

′

I1 =

ZS+

(cid:16)

dx dy ˆez ·

~E

(i~kc ×

×

ˆec)

ˆec ×

(
∇ ×

−

ei~kc·~r,

(10)

~E)
(cid:17)

and substituting (7) its evaluation is straightforward. The integral over dx dy
yields (2π)2δ(~k⊥ + ~kc⊥). Since k2 = k2
c = K 2, kcz < 0 and kz > 0 this implies
that the plane waves superposed in (7) yield a vanishing contribution except
when ~k =

~kc. Thus,

−

The contribution of the scattered waves ~E

I1 =

2iK ˆec ·

−

~E(

~kc)

−
′
c (~r),

(7)

(8)

(9)

(11)

(12)

I2 =

ZS+

dx dy ˆez ·

~E

(
∇ ×

×

~E

′

c)

′

~E

c ×

(
∇ ×

−

,

~E)
(cid:17)

(cid:16)

6

′

′

′

2 = K 2, and both kz, k

is calculated in a similar way. Substitute (7) and (9) and integrate over dx dy
to obtain a delta function. This eliminates all Fourier components except those
with ~k⊥ =
~k
⊥. Since k2 = k
z > 0 this implies kz =
−
z > 0. Thus,
k
′
d2k
⊥
(2π)2
~k
where ~k =
−
] = 0, so that
[
gives ˆez ·
· · ·

ˆez ·
z ˆez. Further manipulation using ~k

i~k
(cid:16)
′
c(~k
~E

(cid:17)i
~E(~k) = 0

~E(~k)
h

i~k
(cid:16)

K 2
k′2
z

) = ~k

~E(~k)

, (13)

I2 =

+ 2k

c(~k

c(~k

~E

~E

×

×

−

×

×

(cid:17)

Z

)

)

·

·

′

′

′

′

′

′

′

′

′

′

I2 = 0.

(14)

According to eq. (11) and (14) the only contributions to the surface integral
over the distant plane S+ come from products of outgoing with incoming waves.
Products of two outgoing waves yield vanishing contributions. This result ap-
plies also to the remaining seven faces of the cube S. Since on each of these
faces there are only outgoing waves we ﬁnd that the integral over S
makes no
contribution to the left hand side of (4). Incidentally, this argument completes
our previously unﬁnished deduction of the usual form of the reciprocity theo-
rem, eq. (3): if both sources ~J and ~Jc are internal to the surface S the surface
integral in eq. (2) vanishes because it only involves products of outgoing waves.
Substituting (11) into (4) leads us to the main result of this paper, the

′

asymptotic reciprocity theorem,

~E(~k) =

2π
c

−

ZV

~J dv.

~Ec ·

e

·

b

In words:

The ﬁeld ~E(~k) radiated in a direction ~k with a certain polarization

e is
2π/c times the “component” of the source ~J(~r) “along” a connecting ﬁeld

−
~Ec(~r) with incoming wave vector ~kc =

~k and polarization

ec =

e.

b

−
Typically one is interested in the intensity radiated into a solid angle dΩ;
since the amplitude ~E(~k) that appears in (7) and (15) is not quite the Fourier
transform of ~E(~r) it may be useful to derive an explicit expression for dW/dΩ.
The total power radiated through the plane S+ is given by the ﬂux of the time-
~B∗],
averaged Poynting vector, c

b

b

8π Re [ ~E
c
8π

×
Re [ ~E

d2x⊥

W =

∗

~B

]

ˆez =

dΩ

dW
dΩ

×
Using (7) and d2k⊥ = k⊥dk⊥dφ = KkzdΩ (where φ is the usual azimuthal angle
about the z axis) we get

Z

Z

·

so that

(cid:19)
In the next section we oﬀer a few illustrative examples of the ART in action.

(cid:18)

W =

c
8π

d2k⊥
(2π)2

K
kz

~E(~k)

∗

~E

(~k),

Z

c
8π

dW
dΩ

=

·

·

2

K
2π

~E(~k)

∗

~E

(~k).

7

(15)

(16)

(17)

(18)

3 Some simple examples

The ART, eq. (15), holds for an arbitrary linear medium. In particular it holds if
the medium is vacuum. Our ﬁrst trivial example is the radiation by a prescribed
current in vacuum. Next, to show that the ART can be used to study scattering
problems we deal with another equally trivial example, the kinematical theory
of diﬀraction by crystals. The third example, the radiation by currents located
near a dielectric boundary, is also straightforward. What is remarkable here is
the ease with which the results are obtained compared to conventional methods
[9][10].

3.1 Radiation in vacuum
In this case the connecting ﬁeld is just an incoming plane wave, ~Ec (~r) = ˆec ei~kc·~r.
The ART, eq. (15), gives the radiated ﬁeld with polarization ˆe = ˆec as

e

·

b

so that

~E(~k) =

2π
c

−

ZV

~J(~r)

−i~k·~r dv =

ˆe e

·

2π
c

−

ˆe

·

~J(~k),

~E(~k) =

2π
c

ˆk

(ˆk

~J(~k)).

×

×

The radiated power, eq. (18), is

dW
dΩ

=

K 2
8πc

ˆk

(ˆk

×

×

(cid:12)
(cid:12)
(cid:12)

2

,

~J(~k))
(cid:12)
(cid:12)
(cid:12)

as expected. (For radiation by a point dipole just substitute ~J(~k) =

icK~p.)

−

3.2 Bragg diﬀraction

Consider a crystal described by its dielectric susceptibility χ(~r) [19] which for
x rays is quite small (typically about 10−5 or less). An incident plane wave
~Eoei~ko·~r induces a current

~J(~r) =

iω
iω ~P (~r) = −
4π

−

χ(~r) ~Eoei~ko·~r,

which radiates. The connecting ﬁeld needed to calculate this radiation is a
simple incoming plane wave, ~Ec (~r) = ˆec ei~kc·~r, and the ART, eq. (15), gives the
radiated ﬁeld as

~E(~k) =

iω
2c

ˆk

−

(ˆk

×

×

~Eo) χ(~k

~ko).

−

The scattered ﬁeld is proportional to the Fourier transform of the susceptibility
of the medium; for a periodic medium this is Bragg diﬀraction.

(19)

(20)

(21)

(22)

(23)

8

3.3 Radiation in the vicinity of a reﬂecting surface

Consider a current ~Jin(~r) located within a uniform medium with dielectric sus-
ceptibility χ0 occupying the region z < 0 (see ﬁg. 2). To calculate the radiation
in the direction ~k with polarization ˆe we choose as connecting ﬁeld an incom-
ing plane wave with wave vector ~kc =
~k and unit amplitude ˆec = ˆe plus the
corresponding reﬂected and transmitted waves,

−

~Ec (~r) =

ˆec ei~kc·~r + ~εcr ei~kcr·~r,
~εct ei~kct·~r,

(

for
for

z > 0
z < 0

The various wave vectors are given by

~k ,

~kc =

−
~kcr =
~kct =

qˆez =

K cos θ ˆex −

−
K cos θ ˆex + qˆez ,
−
K cos θ ˆex −

¯qˆez ,

−
where K = ω/c, and the normal components q and ¯q are given by

q = K sin θ

and ¯q = K

sin2 θ + χ0

1/2

.

The amplitudes ~εcr and ~εct of the reﬂected and transmitted waves are given by
the Fresnel expressions

(cid:1)

(cid:0)

and

~εcr = rsˆecr where

rs =

~εct = tsˆect where

ts =

q
¯q
−
q + ¯q

2q
q + ¯q

,

ˆect
ˆect

ˆecr ·
ˆec ·
1
ˆect
ˆec ·

.

(ˆecr and ˆect are unit vectors describing the polarization of the specular reﬂected
and transmitted waves.)

Then for a source ~Jin(~r) located within the medium, the ART, eq.(15), gives

the radiated ﬁeld as

~E(~k) =

e

·

2π
c

−

~Jin(~r)

~εct ei~kct·~r dv .

·

Zz<0

On the other hand, had the source ~Jout(~r) been located outside the dielectric
medium (z > 0) the corresponding radiated ﬁeld would be

b

~E(~k) =

e

·

2π
c

−

Zz>0

·

(cid:16)

~Jout(~r)

ˆec ei~kc·~r + ~εcr ei~kcr ·~r

dv .

(32)

For an oscillating dipole on the z axis, ~J(~r) =
(32) give

b

−

iω~pδ (~r

zpˆez), eq.(31) and

~E(~k) =

2πiK
~p
2πiK ~p
(cid:0)

·

(cid:26)

ˆe e−iqzp + ~p
·
ˆectts e−i¯qzp

·

ˆecrrs eiqzp

zp > 0
zp < 0.

(33)

(cid:17)

−

if
if

(cid:1)

e

·

b

9

(24)

(25)

(26)

(27)

(28)

(29)

(30)

(31)

Figure 2: The connecting ﬁeld for radiation in the presence of a reﬂecting
medium includes reﬂected and transmitted waves. Here the source ~Jin is shown
within the medium (z < 0).

The power radiated with polarization ˆe, eq.(18), is

dW
dΩ

=

c
8π

h

K 4 (ˆe

~p)2

1 +

·

~p
ˆecr ·
~p
ˆe
·

rs e2iqzp

for

zp > 0 ,

(34)

and

=

c
8π

K 4 (ˆe

dW
dΩ

~p
ˆect ·
~p
ˆe
·
In these two expressions we can recognize the ﬁrst factor (in square brackets)
as the power radiated by a dipole in vacuum. The second factor accounts for
the presence of the dielectric medium.

zp < 0 .

i (cid:12)
(cid:12)
(cid:12)
(cid:12)

−i¯qzp

(35)

ts e

for

(cid:12)
(cid:12)
(cid:12)
(cid:12)

h

·

i (cid:12)
(cid:12)
(cid:12)
(cid:12)
~p)2

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

4 Specular reﬂection of polarized x rays

In this section ideas from the three previous examples are combined to study
two similar and considerably more involved scattering problems, the specular
reﬂection of polarized x rays by a rough surface and by graded interfaces. We
show that within approximations of the Nevot-Croce type grading and roughness
aﬀect the specular reﬂectivity in a manner that is independent of the polarization
of the incident radiation.

10

4.1 Reﬂection by rough surfaces

The dielectric susceptibility χ(~r) that describes the rough surface from which
we wish to scatter x rays is given by

χ (x, y, z) =

0
χ0

for
for

z > ζ(x, y)
z < ζ(x, y)

(cid:26)
where the height ζ(x, y), is a Gaussian random variable with zero mean,
and variance

= σ2 (see ﬁg. 3).

ζ2

= 0,

ζ
h

i

To apply the ART it is convenient to rewrite χ (~r) as

(cid:10)

(cid:11)

χ (~r) = χs (~r) + δχ (~r) ,

where χs (~r) represents a medium with an ideally ﬂat surface at z0,

χs (~r) =

0
χ0

for
for

z > z0
z < z0

(cid:26)
and δχ (~r) represents the roughness.

Let ˆe0 ei~k0·~r be the incident ﬁeld. The total scattered ﬁeld ~ε(~r) includes the
wave ~εs(~r) specularly reﬂected by the step χs (~r) plus waves δ~ε (~r) scattered by
δχ (~r)

The ﬁrst term on the right is

~ε(~r) = ~εs(~r) + δ~ε (~r) .

~εs(~r) = ˆer rse

−2iqz0 ei~kr ·~r,

where

q
¯q
−
q + ¯q
(ˆer and ˆet are unit vectors describing the polarization of the specular reﬂected
and transmitted waves). The second contribution in eq.(39), the ﬁeld δ~ε (~r)
includes a specular component plus diﬀusely scattered and evanescent waves,

ˆer ·
ˆe0 ·

rs =

ˆet
ˆet

(41)

Using eq.(7) this may be written as

δ~ε (~r) = δεr ˆerei~kr ·~r + δ~εd(~r).

δ~ε (~r) =

′
d2k
⊥
(2π)2

K
k′
z

Z

′

δ~ε(~k

′

) ei~k

·~r,

where

′

δ~ε(~k

) =

′
δεr ˆer (2π)2 δ(~k
⊥

~k0⊥) + δ~εd(~k

′

).

−

′

k
z
K

To calculate δ~ε (~r) we can proceed exactly as in the previous section (3.3): δ~ε (~r)
is the ﬁeld radiated by a current δ ~J(~r) in the presence of the medium χs (~r).
The current

(36)

(37)

(38)

(39)

(40)

(42)

(43)

(44)

(45)

iω
δ ~J(~r) = −
4π

δχ(~r) ~E (~r) ,

11

Figure 3: The problem of scattering by a rough surface can be tackled using the
ART by adding a ﬁctitious overlayer δχ.

originates in the polarization of the roughness δχ(~r) by the total electric ﬁeld
~E(~r) due to the incident and all scattered waves, including those generated by
the roughness itself. Thus, the challenge here is that the ﬁeld ~E (~r) is itself
unknown; an approximation for it must be obtained as part of our solution.

We can exploit the arbitrariness in the separation of χ (~r) into χs (~r) plus
δχ (~r) to suggest a self-consistent approximation for ~E. Suppose we choose z0
positive and considerably larger than the roughness σ (see ﬁg. 3). Then δχ (~r)
represents a ﬁctitious overlayer that extends well into the vacuum; the sign of
δχ (~r) is opposite to that of χs (~r) and in the vicinity of z0 they completely cancel
out. The ﬁeld δ~ε(~k) in a direction ~k with polarization ˆe is given by eq.(31)

δ~ε(~k) =

e

·

iK
2

Z

dv δχ(~r) ~E (~r)

~εct ei~kct·~r ,

·

(46)

where the connecting ﬁeld is precisely as in eqs.(24)-(30) except for phase shifts
due to the reﬂecting surface being at z0,

b

~εcr = e

−2iqz0 rsˆecr

and ~εct = ei(¯q−q)z0 tsˆect.

(47)

The reason behind the somewhat surprising choice for z0 will now become

clear: slightly above z0, in vacuum, the exact ﬁeld is

~E (~r) = ˆe0ei~k0·~r + ~ε(~r) = ˆe0ei~k0·~r + ~εs(~r) + δ~ε (~r) ,

(48)

but slightly below z0 and, in fact, over all of the extension occupied by δχ (~r),
we are also in vacuum (δχ (~r) and χs (~r) cancel each other) and therefore ~E (~r) is

12

given by the same expression (48). The last term δ~ε (~r), given by (42), includes
some weak diﬀusely scattered and evanescent waves δ~εd(~r). Our approximation
consists of neglecting them. Therefore,

where the specular reﬂections by χs (~r) and δχ (~r) have been combined into the
single, and still unknown, reﬂection coeﬃcient r,

~E (~r)

ˆe0 ei~k0·~r + rˆerei~kr ·~r,

≈

r = rse

−2iqz0 + δεr.

(49)

(50)

Substituting into eq.(46) yields

z0

iKχ0
2

·

e

−

dx dy

δ~ε(~k) =

ˆe0 ei~k0·~r + rˆerei~kr ·~r
h
From now on we focus our attention on the specularly reﬂected component; let
~kc. Substituting eq.(44) into the left hand
ˆe = ˆec = ˆer, ˆecr = ˆe0, ~k = ~kr =
side (l.h.s.), using (2π)2 δ(k⊥

k0⊥) = (2π)2 δ(0) =

~εct ei~kct·~r .

dx dy we get

(51)

ζ(x,y)

dz

−

Z

b

Z

i

·

−

l.h.s. =

δεr (2π)2 δ(0) =

q
K

R
−2iqz0

rse

r

−

q
K

(cid:0)

Z

(cid:1)

dx dy.

(52)

This shows that the unknown reﬂection coeﬃcient r we want to calculate appears
in both the left and the right hand sides of (51), as part of the radiated ﬁeld and
also as part of the ﬁeld that induces the source; eq.(51) permits a self-consistent
calculation of r.

The integral over dz in the right hand side of eq.(51) is elementary and the

remaining integral over dx dy is performed using the identity

dx dy e−iQζ(x,y)
dx dy

=

e
h

−iQζ

= e

−Q2σ2/2,

i

(53)

R

R

where ζ is a Gaussian random variable with zero mean,
ζ2

ζ
h
= σ2. The right hand side (r.h.s.) of eq.(51) becomes

i

= 0, and variance

(cid:10)

(cid:11)

r.h.s. =

dx dy

Kχ0
2

~εct
ˆe0 ·
q + ¯q

−i(q+¯q)z0

−(q+¯q)2σ2/2

(cid:19) (cid:26)

(cid:18)Z
ˆer ·
q
−

r

~εct
¯q

h

−

e

h

e

−

e

−

,

i(cid:27)

ei(q−¯q)z0

−(q−¯q)2σ2/2

i

(54)

which can be further rewritten by substituting ~εct as given by eq.(47), and using
¯q2

q2 = K 2χ0, and

−

ˆect
ˆect

ˆe0 ·
ˆe
·

=

ˆect
ˆect

ˆecr ·
ˆe
·

=

ˆet
ˆet

ˆer ·
ˆe0 ·

ˆect
ˆect

ˆer ·
ˆe
·

and

= 1.

(55)

13

Finally, equating eq.(52) to (54) yields a self-consistent approximation to r,

r =

q
¯q
−
q + ¯q

ˆet
ˆet

ˆer ·
ˆe0 ·

−2q ¯qσ2

e

= rs e

−2q ¯qσ2

.

(56)

This coincides exactly with the Nevot-Croce result for the polarization ˆe0 = ˆet =
ˆet is unity, and provides the correct generalization
ˆer for which the ratio ˆe0·
to all polarizations. According to this approximation the specular reﬂection
coeﬃcient r has no polarization dependence beyond that already implicit in the
reﬂection coeﬃcient rs for the ideal ﬂat step surface; the “static Debye-Waller”
factor exp(

2q ¯qσ2) is polarization independent.

ˆet/ ˆer·

Notice that any possible dependence on the arbitrary choice of z0 has can-

−

celled out.

4.2 Reﬂection by smoothly graded surfaces

The problem of scattering by a smoothly graded interface is similar and some-
what simpler. Here the susceptibility χ(z) depends only on the normal coor-
dinate z and not on the transverse coordinates x and y. This implies that the
tangential component of momentum is conserved in the scattering; there are no
diﬀuse waves, there is only specular scattering.

As before, it is convenient to separate χ (z) into

where χs (z) represents an ideally ﬂat surface at z0,

χ (z) = χs (z) + δχ (z) ,

χs (z) =

(cid:26)

0
χ0

for
for

z > z0
z < z0

and δχ (z) is an overlayer (see ﬁg.4) describing the smooth transition from bulk
to vacuum.

Let ˆe0 ei~k0·~r be the incident ﬁeld. The total scattered ﬁeld ~ε(~r), eq.(39),

~ε(~r) = ~εs(~r) + δ~ε (~r) .

includes the wave ~εs(~r) reﬂected by the step χs (z), eq.(40), plus waves δ~ε (~r)
scattered by the overlayer δχ (z). While diﬀusely scattered waves are not present
in δ~ε (~r), faint evanescent waves could be; these are weak near ﬁeld eﬀects and
we neglect them. Thus

δ~ε (~r) = δεr ˆerei~kr ·~r,
(60)
and the Fourier expansion, eq.(43), and transform δ~ε(~k), eq.(44), remain other-
wise unchanged. Once again, δ~ε (~r) is radiated by a current

(57)

(58)

(59)

(61)

where the ﬁeld ~E(~r) includes the incident and the unknown reﬂected waves;
~E (~r) must be self-consistently obtained as part of the solution. Then the ART,

iω
δ ~J(~r) = −
4π

δχ(z) ~E (~r) ,

14

Figure 4: The problem of reﬂection by a graded surface can be tackled using
the ART by adding a ﬁctitious overlayer δχ. The hatched region shows the
transition region from δχ = 0 to δχ =

χ0.

−

in the form of eq.(31), gives the ﬁeld δ~ε(~k) in a direction ~k with polarization ˆe
as

δ~ε(~k) =

dv δχ(z) ~E (~r)

~εct ei~kct·~r ,

(62)

·

iK
2

Z

with the same connecting ﬁeld given back in eq.(47).

The approximation we use for ~E (~r) is the same as in last section. The
arbitrariness of z0 can be exploited by choosing it large enough that the overlayer
extends well into the vacuum. Near z0 the overlayer and the sharp step χs (~r)
cancel each other out; slightly above z0, in vacuum, the ﬁeld is

e

·

b

where r is the unknown reﬂection coeﬃcient we want to calculate,

~E (~r) = ˆe0 ei~k0·~r + rˆerei~kr·~r,

r = rse

−2iqz0 + δεr.

(63)

(64)

Slightly below z0 and over most of the extension occupied by δχ (z) we are also
in vacuum (provided the bulk to vacuum transition is not too gradual) and we
approximate ~E (~r) by the same expression, eq.(63). Substituting into eq.(62)
yields an equation for r,

q
K

(cid:0)

rse

r

−

−2iqz0

(2π)2 δ(k⊥

k0⊥) =

−

(cid:1)

15

=

iK
2

z0

−∞

dz δχ(z)

dx dy

Z

Z
i
The integral over dx dy yields a delta function, (2π)2 δ(k⊥
substitute ˆe = ˆec = ˆer, ˆecr = ˆe0, ~k = ~kr =
conveniently expressed as

−

k0⊥), and we can
~kc. The integral over z is

−

ˆe0 ei~k0·~r + rˆerei~kr ·~r
h

·

~εct ei~kct·~r .

(65)

z0

−∞

Z

dz δχ(z) e

−iQz =

−iQz0 +

[ e

χ0
iQ

χ′(Q)
χ0

],

where χ′(Q) is the Fourier transform of dχ(z)/dz,

′

χ

(Q) =

+∞

−∞

Z

dz

dχ(z)
dz

−iQz

e

r = rs

−
χ′(¯q + q)
χ′(¯q
q)

.

−

Eq.(66) is proved by integrating the left hand side by parts, using δχ(z0)
and dδχ(z)/dz = dχ(z)/dz. Using ¯q2
the ﬁnal result is

χ0,
q2 = K 2χ0 and the identities in eq.(55)

≈ −

Notice that any possible dependence on the arbitrary choice of z0 has cancelled
out.

This coincides exactly with the scalar wave result [17] and provides the
correct generalization to all polarizations. Within these approximations the
specular reﬂection coeﬃcient r has no polarization dependence beyond that
already implicit in the reﬂection coeﬃcient rs for the ideal ﬂat step surface; the
“static Debye-Waller” factor is polarization independent.
To conclude we mention some illustrative examples:

(a) The error-function proﬁle

the same factor obtained in the previous section for a Gaussian rough surface.
This is as expected, the error function is the averaged proﬁle for the Gaussian
rough surface.
(b) The Epstein (or Fermi distribution) proﬁle [17]

gives

gives

χ(z) =

dx exp

χ0
√2πσ2

z

−∞

Z

x2
2σ2

,

(cid:19)

−

(cid:18)

χ′(¯q + q)
χ′(¯q
q)

−

= e

−2q ¯qσ2

,

χ(z) =

χ0
1 + e−z/σ ,

χ′(¯q + q)
χ′(¯q
q)

−

=

¯q + q
q
¯q

−

sinh[πσ(q
¯q)]
sinh[πσ(q + ¯q)]

−

.

16

(66)

(67)

(68)

(69)

(70)

(71)

(72)

(c) The triangular proﬁle

gives

χ(z) =

2z/σ)

χ0
χ0 (1
0

−




for
for
for

σ/2
−
< σ/2

z <
z
|
z > σ/2

|

,


χ′(¯q + q)
χ′(¯q
q)

−

=

q
¯q
−
q + ¯q

sin[(q + ¯q)σ/2]
¯q)σ/2]
sin[(q

.

−

(73)

(74)

The reliability of these approximations was studied in [17] in the case of
scalar waves. There is no reason to expect any diﬀerence from the conclusions
reached there: the “static Debye-Waller” in eq.(68) provides a remarkably good
approximation for the intensities reﬂected by interfaces of arbitrary grading
proﬁle even for transition regions that are quite wide (σ as large as several
nanometers). The phase of the reﬂected waves is however more sensitive; eq.(68)
provides a good approximation for more abrupt transitions (σ of the order of 1
nm or less).

5 Conclusion

The main result of this work, eq.(15), is an asymptotic form of the reciprocity
theorem which can be used as the basis for a practical method for calcula-
tions. The theorem states that the ﬁeld radiated in the presence of a nontriv-
ial medium, in a certain direction and with a given polarization, is a suitable
‘component’ of the radiating source. This ‘component’ is to be extracted by
introducing an auxiliary ‘connecting’ ﬁeld which contains the necessary infor-
mation about the medium. The practical advantage of the method lies in the
simpliﬁcations achieved by systematically avoiding unnecessary calculations; it
thereby allows one to tackle problems of increasing complexity.

In forthcoming papers we will further explore the application of the ART to
the study of the dynamical diﬀraction of radiation generated by sources within
a crystal, the so-called Kossel lines. Even this well explored topic has not been
exhausted. Of particular interest are situations where the Bragg angle lies close
to π/2 and the Kossel cones degenerate into single beams [20], and situations
where the source location is revealed by the oscillatory ‘Pendell¨osung’ structure
of the diﬀraction pattern [21]. Other applications will include a new approach
to thermal diﬀuse scattering under conditions of dynamical diﬀraction [22].

Acknowledgments.

I am indebted to P. Zambianchi and E. Sutter for

valuable discussions.

References

[1] H. A. Lorentz, Proc. Amsterdam Acad., 8, 401 (1905).

[2] See e.g., J. M. Blatt and V. F. Weisskopf, Theoretical Nuclear Physics

(Dover, 1979); E. Merzbacher, Quantum Mechanics (Wiley, 1998).

17

[3] D. E. Bilhorn, L. L. Foldy, R. M. Thaler and W. Tobocman, J. Math. Phys.

5, 435 (1964).

[4] L. Landau, E. M. Lifshitz and L. P. Pitaevskii, Electrodynamics of Contin-

uous Media (Butterworth-Heinemann, 1984).

[5] J. A. Kong, Electromagnetic Wave Theory (Wiley, New York 1990).

[6] M. v. Laue, Ann. Physik 23, 705 (1935).

[7] W. Kossel, V. Loeck and H. Voges, Zeit. f. Physik, 94, 139 (1935).

[8] M.Tegze and G. Feigel, Europhys. Lett. 16, 41 (1991), Nature (London)
380, 49 (1996); T. Gog et al., Phys. Rev. B 51, 6761 (1995), Phys. Rev.
Lett. 76, 3132 (1996); P. M. Len et al., Phys. Rev. B 55, R3323 (1997).

[9] J. A. Stratton, Electromagnetic Theory (McGraw-Hill, New York 1941).

[10] W. C. Chew, Waves and Fields in Inhomogeneous Media (Van Nostrand
Reinhold, New York 1990); J. R. Wait, Electromagnetic Waves in Stratiﬁed
Media (IEEE-Oxford, New York 1996).

[11] P. Beckmann and A. Spizzichino, The Scattering of Electromagnetic Waves
from Rough Surfaces (Artech House, Norwood, MA 1987); J. Lekner, The-
ory of Reﬂection of Electromagnetic and Particle Waves (Martinez Nijof,
Dordrecht, Holland).

[12] D. G. Stearns, J. Appl. Phys. 65, 491 (1989) and 71, 4286 (1992); A. V.
Vinogradov et al., Sov. Phys. JETP 62, 1225 (1985) and 67, 1631 (1988);
W. Weber and B. Lengeler, Phys. Rev. B 46, 7953 (1992); J. C. Kimball
and D. Bittel, J. Appl. Phys. 74, 887 (1993).

[13] S. K. Sinha, et al., Phys. Rev. B 38, 2297 (1988); V. Holy et al., Phys.

Rev. B 47, 15896 (1993).

[14] S. Dietrich and A. Haase, Phys. Rep. 260, 1-138 (1995).

[15] L. Nevot and P. Croce, Revue Phys. Appl. 15, 761 (1980).

[16] R. Pynn, Phys. Rev. B 45, 602 (1992); D. K. G. de Boer, Phys. Rev. B

49, 5817 (1994).

following eq. 14.

[17] A. Caticha, Phys. Rev. B 52, 9214 (1995).

[18] This is a nontrivial statement; its justiﬁcation is given in the paragraph

[19] To avoid factors of 4π elsewhere it is usual in x-ray optics to deﬁne the

susceptibility by 4πP = χE.

[20] P. Zambianchi and A. Caticha, “Dynamical diﬀraction of x rays generated

within the crystal: the case of θB ≈

π/2.”

18

[21] E. Sutter and A. Caticha, “Dynamical diﬀraction of x rays generated within

the crystal: the Laue case.”

[22] P. Zambianchi and A. Caticha, “Thermal diﬀuse dynamical diﬀraction of

x rays.”

19

Ec

Jc

S+

Ec

S

E

S’

E

ε(r)

ε(r)

J

(a)

J

(b)

kc

θ

 x

 z

 Jin

 S+

kcr

 
kct

