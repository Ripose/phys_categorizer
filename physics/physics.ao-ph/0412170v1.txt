4
0
0
2
 
c
e
D
 
8
2
 
 
]
h
p
-
o
a
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
1
2
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Ray-based description of normal mode amplitudes in a range-dependent waveguide

A.L. Virovlyansky, A.Yu. Kazarova, L.Ya. Lyubavin
Institute of Applied Physics, 46 Ulyanova St., Nizhny Novgorod, 603950 Russia

An analogue of the geometrical optics for description of the modal structure of a wave ﬁeld in
a range-dependent waveguide is considered. In the scope of this approach the mode amplitude is
expressed through solutions of the ray equations. This analytical description accounts for mode
coupling and remains valid in a nonadiabatic environment.
It has been used to investigate the
applicability condition of the adiabatic approximation. An applicability criterion is formulated as a
restriction on variations of the action variable of the ray.

Key words: waveguide, ray, mode, coupling, adiabatic approximation, action-angle variables

I.

INTRODUCTION

time-dependent parameters.

We consider a method for analysis of the modal struc-
ture of a scalar wave ﬁeld in a two dimensional range-
dependent waveguide. This method derived in Refs. [1–
3] (see also [4]) is based on projecting the ray representa-
tion of the wave ﬁeld onto normal modes and evaluating
the corresponding integrals using the stationary phase
technique. As a result the mode amplitude is expressed
through parameters of ray trajectories. This approach es-
tablishes a relationship between the ray and mode repre-
sentations of the wave ﬁeld in a range-dependent waveg-
uide and provides an approximate solution to the mode
coupling equation.

In describing ray trajectories we apply the Hamilto-
nian formalism taken in terms of the action-angle vari-
ables [5, 6].
It is shown that each mode is formed by
contributions from rays whose action variables up to a
multiplicative constant are equal to the mode number.
In the nonadiabatic environment the action varies along
the ray path. Our objective in this work is to ﬁnd out
how the nonadiabaticity of rays manifests itself in varia-
tions of mode amplitudes. In the nonadiabatic waveguide
an initially excited single mode breaks up into a group of
modes. We argue that the width of the group is propor-
tional to the spread of ray actions at the given range.

The formula for the mode amplitude, valid in the nona-
diabatic waveguide, has been used to formulate an appli-
cability condition of the adiabatic approximation. In con-
trast to traditional approaches for solving this problem
[7, 8] we proceed not from the mode coupling equation
but from its solution (albeit approximate). An applica-
bility criterion discussed in the present paper takes into
account accumulation of errors with range.

All results are obtained for the wave ﬁeld that obeys
the parabolic equation. This assumption is not necessary:
the results are readily generalized to the ﬁeld governed
by the Helmholtz equation. We use the parabolic equa-
tion approximation for two reasons. First, unlike the
Helmholtz equation it can be easily solved numerically
which is very important for testing our approximate for-
mulas. Besides, the parabolic equation formally coincides
with the Schr¨odinger equation and therefore formulas de-
rived in this work may be applied in quantum mechanics
to study the motion of a particle in a potential well with

In the present paper we investigate general proper-
ties of wave propagation in a range-dependent waveguide
by the example of the underwater sound channel. This
choice is caused by interests of the authors and by the
fact that the topics addressed here are of importance in
underwater acoustics [7–10].

The paper is organized as follows. Section II provides
a brief description of the ray representation of the wave
ﬁeld. Main relations of the Hamiltonian formalism ex-
pressed in terms of both position-momentum and action-
angles variables are presented. In Sec. III we consider
the mode representation (in the WKB approximation) of
the wave ﬁeld and the mode coupling equation. We also
outline a traditional method for estimating the validity
region of the adiabatic approximation by using the per-
turbation theory for the mode coupling equation. In Sec.
IV formulas expressing mode amplitudes through param-
eters of ray trajectories are derived. Section V focuses on
connection between variations of the action variable and
It is shown how a standard ray trac-
mode coupling.
ing can be used to estimate the number of interacting
modes. An applicability criterion for the adiabatic ap-
proximation is formulated as restriction on the spread of
ray actions. These results are veriﬁed and illustrated us-
ing numerical examples. The conclusions are summarized
in the ﬁnal section.

II. RAY REPRESENTATION OF THE WAVE
FIELD

A. Parabolic equation approximation

Consider a monochromatic wave ﬁeld at a carrier fre-
quency f in a two-dimensional acoustic waveguide with
the sound speed c being a function of depth, z, and range,
r. We shall assume that at each range point the sound
speed proﬁle has a single minimum. The wave ﬁeld u(r, z)
is governed by the Helmholtz equation [7, 8, 11]

1
r

∂
∂r

r

∂u
∂r

+

∂2u
∂z2 +

Ω2
c2(r, z)

u = 0,

(1)

where Ω = 2πf . Select a reference sound speed c0 such
<< c0 (in underwater acoustics such
that

c(r, z)
|

−

c0|

choice of c0 is always possible) and assume that graz-
ing angles of the propagating waves are small. Then it
is convenient to introduce an envelope function v(r, z)
connected to u(r, z) by an expression

u =

eikr,

v
√r

with k = Ω/c0. This function is approximately described
by the standard parabolic equation [7, 11, 12]

where

2ik

+

∂v
∂r

∂2v
∂z2 −

2k2U v = 0,

U (r, z) =

1
2

1

−

(cid:18)

c2
0
c2(r, z)

.

(cid:19)

2

(10)

the wave ﬁeld. In the case of a point source the wave ﬁeld
is determined by Eq. (3) with an initial condition

v(0, z) = δ(z

z0).

−

Then all rays escape the same point (0, z0) and each tra-
jectory can be labelled by the ray starting momentum p0.
The amplitude

A =

k
∂z/∂p0|
|
where µ is the Maslov index or integral number of times
that the ray passes through caustics [14].

e−iµπ/2,

(11)

2πi

s

C. Action-angle variables

Notice that Eq.
(3) formally coincides with the time-
dependent Schr¨odinger equation. In this analogy r, k−1,
and U (r, z) play roles of time, Planck’s constant, and
potential, respectively.

Since ray trajectories in the waveguide are oscillating
curves, their analysis may be simpliﬁed by using the so-
called action-angle variables [5, 6]. In mechanics the lat-
ter are often applied to study oscillations of particles in
potential wells.

B. Hamiltonian formalism in terms of
momentum-position variables

1. Range-independent waveguide

In the geometrical optics approximation the wave ﬁeld
is formed by contribution from all rays (eigenrays) ar-
riving at the observation point. The ray trajectory is
deﬁned by the Hamilton equations [6, 12]

dz
dr

=

∂H
∂p

,

dp
dr

=

∂H
∂z

−

with the Hamiltonian

H = p2/2 + U.

The momentum p is connected to the ray grazing angle
χ through the relation

A contribution to the wave ﬁeld from an eigenray is

presented in the form

p = dz/dr = tan χ.

v = AeikS,

where S and A are the ray eikonal and amplitude, respec-
tively. The eikonal S is an analog to Hamilton’s principal
function in classical mechanics and it is given by an in-
tegral

S =

(pdz

Hdr)

−

Z

(9)

with

running over the ray path [5, 12, 13]. An explicit expres-
sion for the ray amplitude depends on the source exciting

First, consider a range-independent waveguide where
the Hamiltonian H remains constant along the ray path
(analog to the energy conservation law in mechanics).
The action variable I is deﬁned by the integral [5, 6]

I =

p dz =

dz

2 [H

U (z)],

(12)

1
2π

I

zmax

1
π

zmin

Z

p

−

where zmin and zmax are the lower and upper ray turning
depths, respectively, satisfying the condition U (z) = H.
Equation (12) deﬁnes the “energy” H as a function of
the action I. The ray trajectory is a periodic curve whose
period along the r-axis (the cycle length), D, and the an-
gular frequency of spatial oscillations, ω, are determined
by the relation

dH
dI

= ω =

2π
D

.

(13)

Take one cycle of the unperturbed ray path that begins
at the minimum of the trajectory. At the ﬁrst half-cycle
the canonical transformation,

p = p(I, θ),

z = z(I, θ),

(14)

from the position-momentum, (p, z), to the action-angle,
(I, θ), variables is determined by the equations [5, 6, 15]

p =

∂G
∂z

,

θ =

∂G
∂I

,

(15)

G(I, z) =

dz

2 [H(I)

U (z)]

(16)

−

z

zmin

Z

p

(2)

(3)

(4)

(5)

(6)

(7)

(8)

being a generating function of the canonical transforma-
tion. At this half-cycle the angle variable θ varies from 0
to π. The transformation is continued to the next half-
cycle (π < θ < 2π) using relations p(I, θ) =
θ),
and z(I, θ) = z(I, 2π
θ). The ray equations in the new
variables take the trivial form

p(I, 2π

−

−

−

with

dI
dr

=

∂H
∂θ

−

= 0,

dθ
dr

=

∂H
∂I

= ω(I).

(17)

Note, that the so deﬁned angle variable θ varies from 0
to 2π at a part of the trajectory beginning at one min-
imum and ending at the next one. To make the angle
variable continuous, its value should be increased by 2π
at the beginning of each new cycle. Both functions in Eq.
(14) are periodic in θ with period 2π. Correspondingly,
an arbitrary function F (z) expressed through the action-
angle variables becomes a periodic function of θ and can
be expanded in a Fourier series

F (z) =

Fν (I) cos νθ.

(18)

∞

ν=0
X

The coeﬃcients Fν(I) are expressed analytically only for
a few special examples of U (z) and F (z). But numerical
evaluation of these coeﬃcients can be easily performed
using a standard ray code. If we denote the ray trajectory
with the action variable I by z(r), then

Fν (I) =

qν
D(I)

D(I)

×

0
Z

dr F (z(rmin + r)) cos (νω(I)(rmin + r)) , (19)

where q0 = 1, qν = 2 for ν > 0, and rmin is a range
corresponding to a minimum of the ray path.

2. Range-dependent waveguide

In a range-dependent waveguide canonical transfor-
mations from (p, z) to (I, θ) variables are diﬀerent at
diﬀerent range points. At each particular range r the
transformation is deﬁned using the so-called reference
waveguide: an imaginary range-independent waveg-
uide whose cross-section coincides with that of a real one
at the given range. The connection between pairs (p, z)
and (I, θ) at range r is determined by formulas present
in Sec. II C 2 that should be applied in a corresponding
reference waveguide. Since the functions p(I, θ), z(I, θ),
G(I, z), H(I), ω(I), and Fν(I) become diﬀerent at dif-
ferent ranges they acquire an additional argument r that
labels the reference waveguide.

The canonical transformation is determined by the

equation [5]

dS = pdz

Hdr = dG

θdI

¯Hdr,

(20)

−

−

−

where ¯H is a new Hamiltonian. According to this relation

¯H(I, θ, r) = H(I, r) + Λ(I, θ, r),

(21)

3

Λ(I, θ, r) =

∂G(I, z, r)
∂r

.

(22)

z=z(I,θ,r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

The Hamilton equations retains their canonical form

dI
dr

∂ ¯H
∂θ

=

−

=

∂Λ
∂θ

,

dθ
dr

−

=

∂ ¯H
∂I

= ω +

(23)

∂Λ
∂I

,

where

ω(I, r) =

∂H(I, r)
∂I

.

(24)

The ray eikonal in the new variables can be found by
integrating Eq. (20). After some algebra we get

S =

(Idθ

(H + Λ) dr)

r

0

Z

G(z(0), I(0), 0) + G(z(r), I(r), r)

−

−

−

+θ(0)I(0)

θ(r)I(r).

(25)

Initial and ﬁnal values of the angle variable, θ(0) and
θ(r), present in the right hand side should be taken mod-
ulo 2π.

The term Λ can be expressed through coeﬃcients of an

expansion

∂U (r, z)
∂r

z=z(I,θ,r)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

∞

ν=0
X

analogous to Eq. (18). First, notice that

=

Vν(I, r) cos θ

(26)

∂
∂r

G(I, z, r) =

z

±

zmin (cid:18)
Z

∂H(I, r)
∂r

∂U (r, z)
∂r

−

(cid:19)

×

2 [H(I, r)

U (r, z)]

,

(27)

dz

−

where
From Eq. (12) it follows that

±

p

denotes the sign of p at a current half-cycle.

∂H(I, r)
∂r

=

ω(I, r)
π

zmax

∂U (r, z)
∂r

×

zmin

Z

2 [H(I, r)

U (r, z)]

.

(28)

dz

−

p

4

(34)

(35)

The right hand side, formally, can be considered as an
integral over a half-cycle of the ray path in the reference
waveguide. Then

φs = π and φb = 0. In case when the upper (lower) mode
turning points lie within a water bulk we have φs =
π/2
π/2). The eigenfunctions are orthogonal and
(φb =
normalized in such a way that

−

−

and

p

ω(I, r)dz

2 [H(I, r)

U (r, z)]

−

= dθ

∂H(I, r)
∂r

= V0(I, r).

Similarly it can be shown that

z

zmin

Z

∂U (r, z)
∂r

2 [H(I, r)

U (r, z)]

dz

−

=

θV0(I, r) +

Vν(I, r)

.

(30)

sin(νθ)

ν !

1
ω  

Combining Eqs. (27), (29), and (30) we arrive at

p

∞

ν=1
X

Λ =

1
ω

−

Vν (I, r)

sin (νθ)
ν

.

∞

ν=1
X

Note that the coeﬃcients Vν (I, r) can be calculated using
Eq. (19) in a reference waveguide corresponding to range
r with F replaced by V (r, z) = ∂U (r, z)/∂r. When evalu-
ating the right hand side of Eq. (19) one should integrate
over the ray path computed in the reference waveguide
but not in the real one. In this calculation the argument
r of function V (r, z) must be considered as a constant
labelling the reference waveguide.

The adiabatic approximation for rays is valid if the
sound speed c is a so slow function of range that Λ be-
comes negligible. Then the action variable I remains
constant along the ray path [5, 7].

III. MODE REPRESENTATION IN THE WKB
APPROXIMATION

and

A. Eigenfunctions and eigenvalues

The normal mode representation of the wave ﬁeld in
a range-independent waveguide is given by an expansion
into a sum of eigenfunctions of the Sturm-Liouville eigen-
value problem [8, 16]

1
2

d2ϕm
dz2 + k2(Hm −

U )ϕm = 0

(32)

with appropriate boundary conditions. The latter can
be determined by reﬂection coeﬃcients at the surface,
Vs = eiφs, and at the bottom, Vb = eiφb . We assume
that reﬂections at boundaries occur without energy loss
and therefore φs and φb are real constants. In particular,
for a pressure release surface and rigid bottom we have

dz ϕmϕn = δmn.

(33)

Z

(29)

In the WKB approximation the eigenvalue of the m-th
mode is

where Im satisﬁes the quantization rule [7, 16]

Hm = H(Im),

kIm = m

φs + φb
2π

.

−

The quantity Im can be treated as an action variable
associated with the m-th mode: if only this mode is ex-
cited then all rays have the same action I = Im. Using
Eq. (13) we get a simple approximate relation for the
diﬀerence between eigenvalues of neighboring modes [7]

(31)

dHm
dm

= Hm+1 −

Hm = ωm/k,

(36)

ω(Im).

where ωm ≡
points can be represented as [16]

The m-th eigenfunction ϕm(z) between its turning

ϕm(z) = ϕ+

m(z) + ϕ−

m(z),

(37)

where

m(z) = Qme±i(kSm(z)+φb/2)),
ϕ±

(38)

Sm(z) =

dz pm(z), pm(z) =

z

zmin

Z

2 [Hm −

U (z)],

p

(39)

(40)

Qm =

ωm
2πpm(z)

.

r

B. Mode coupling equation

In each cross-section of a waveguide the ﬁeld can be
decomposed into a sum of the local modes, that is the
modes of the reference waveguide (see Sec. II C 2) cor-
responding to this particular range. Since at diﬀerent
range points we deal with, generally, diﬀerent reference
waveguides, the eigenfunctions and eigenvalues become
functions of range. The mode representation of the wave
ﬁeld in a range-dependent waveguide has the form

u(r, z) =

am(r)ϕm(r, z),

(41)

m
X

where we have emphasized the r dependence of the eigen-
function. By substituting this expression in Eq. (3) and
using the orthogonality condition (33) we get the mode
coupling equation

dam
dr

+ ikHmam =

am1

dz

ϕm.

(42)

∂ϕm1
∂r

−

m1
X

Z

For a point source deﬁned by Eq. (10) it should be solved
with an initial condition

am(0) = ϕm(0, z0).

(43)

For later convenience we present the derivative ∂ϕm/∂r
as an expansion

=

Bmνϕm+ν.

(44)

∂ϕm
∂r

Xν6=0

Substituting this in Eq. (42) yields

dam
dr

+ ikHmam =

Bmνam+ν.

(45)

Xν6=0

It can be shown that

dz ϕm

ϕm+ν .

∂U
∂r

Bmν =

1
Hm+ν Z
Hm −
This formula is derived by diﬀerentiating Eq. (32) for
the reference waveguide with respect to r and exploiting
the normalization condition (33). A detailed derivation
of a more general result for the wave ﬁeld governed by
the Helmholtz equation see in Ref. [8].

(46)

1. Matrix elements

In the WKB approximation the matrix element of a

smooth function F (z) [16]

Fmν =

dz ϕm(z)F (z)ϕν (z)

(47)

Z

with m, n >> 1 can be expressed through coeﬃcients of
expansion (18). Indeed, take F (z) whose characteristic
scale is much greater than the wavelength 2π/k. Then
<< m.
the matrix elements are very small unless
−
Making use of Eqs.
(47) in the
form

m
|
(37)-(39) rewrite Eq.

ν

|

Fm,m+∆m = 2

dz F (z)Q2

m(z)

zmax

zmin

Z

cos [k (Sm+∆m(z)

Sm(z))] .

(48)

×

−

From Eqs. (36) and (39) it follows that

k (Sm+∆m(z)

Sm(z)) = ωm∆m

(49)

−

z

zmin

Z

dz
pm(z)

.

5

According to Eq. (7) dz/pm = dr and the integral on the
right can be considered as a shift along the r-axis between
a minimum and a current point of a ray trajectory with
action Im. In the range-independent waveguide ωmr =
θ and we get a desired connection between the matrix
elements and the coeﬃcients of Eq. (18)

Fm,m+∆m =

dθ F (z(Im, θ)) cos (∆m θ)

2π

1
2π

0
Z

=

F|∆m|(Im).

1
2

(50)

According to this result Eq. (46) in the high frequency
approximation reduces to

Bmν =

V|ν|(Im, r).

(51)

k
2νωm

−

C. Adiabatic approximation for mode amplitudes

In the adiabatic approximation the right hand side of
the mode coupling equation (45) is assumed to be negli-
gible [7, 8] and we get

am(r) = am(0)e−ik

r
0 Hm(r

′

′

)dr

.

(52)

R

The ﬁrst order correction can be obtained using a simple
perturbation theory. Consider the case when only one
mode with number m0 is excited at r = 0, that is

am(0) = δmm0.

(53)

Substituting Eq. (52) with am(0) deﬁned by Eq. (53)
(45) we ﬁnd that for
into the right hand side of Eq.
m

= m0

am(r) = e−ik

r
0 Hm0 (r

′

′

)dr

qm,

(54)

R

where

r

0
Z

qm =

dr′Bm,m0−m(r′)ei(m−m0)

r′
0 ωm0 (r

′′

′′

)dr

.

(55)

R

At high frequencies, when Eq. ( 51) is valid, qm can be
presented in the form

qm =

−

2(m

m0)

k

−

r

dr′
ωm(r′)

×

0
Z

The condition

V|m−m0|(r′, Im)ei(m−m0)

r′
0 ωm0 (r

′′

′′

)dr

.

R

(56)

(57)

<< 1

qm|
|

6
6

(65)

(66)

(67)

(68)

(or its analog for the Helmholtz equation) is traditionally
considered as a starting point for studying the applica-
bility of adiabatic approximation [7, 8]. In particular it
turns out that the inequality (57) requires that

of its argument. In classical mechanics it is well-known
that the eikonal S considered as a function of range r,
starting coordinate z0 , and a ﬁnal coordinate z obeys the
relation [5]

D/L << 1,

(58)

where L is the characteristic scale of the horizontal range
dependence. Another criterion involving the dependence
on a frequency of the propagating wave has the form
[8, 17]

kD2/L << 1.

(59)

There are less general (but less restrictive and therefore
more useful) criteria that can be obtained for waveguides
with some special properties [8].

IV. PROJECTION OF THE RAY
REPRESENTATION ONTO NORMAL MODES

and

where p is a momentum at range r. Combining this with
Eq. (39) we get

This derivative vanishes at a point z such that a ray
arriving at this point has an action

∂S
∂z

= p,

∂Φ
∂z

= p + σpm.

I = Im

σ =

sgn(p).

−

A. Mode amplitude as a function of ray
parameters

In this section we show that the mode amplitude in
a range-dependent waveguide can be approximately ex-
pressed through parameters of ray trajectories. In more
details this issue has been considered in Refs. [1, 2]. Our
starting point is an equation

am(r) =

dz v(r, z)ϕm(r, z)

(60)

Z

that follows from the mode orthogonality condition (33).
Substituting v(r, z) from Eq.
(8) and using the WKB
approximation for ϕm(r, z) we get am = a+

m + a−

m with

aσ
m =

dz B(r, z, σ)eikΦ(r,z,σ),

(61)

where σ denotes plus or minus,

Z

B = e−iµπ/2+iσφb/2 AQm,

and

Φ = S + σSm.

In the high frequency approximation (large k) integral
(61) can be evaluated using a standard stationary phase
technique [13]. This yields

aσ
m =

2π
∂2Φ/∂z2

k

s

|

π
4

h

(cid:0)

z=zst

| (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

z=zst

(cid:1)i(cid:12)
(cid:12)
(cid:12)

B exp

ikΦ + i

sgn

∂2Φ/∂z2

,

(64)

with zst being a stationary phase point where the deriva-
tive ∂Φ/∂z vanishes. The function sgn(x) gives the sign

The condition (67) singles out rays whose actions at the
given range r are equal to the action of the m-th mode.
In quantum theory a similar result was obtained in Ref.
[4].

For the second derivative of Φ we have an expression

∂2Φ
∂z2 =

∂p
∂z −

σ

∂U/∂z
pm

=

1
p

∂H
∂z

=

ω
p

∂I
∂z

,

(69)

where H and I are considered as functions of
arrival depth at the given range r. From Eq.
follows that

the ray
(64) it

aσ
m = A

k∂I/∂z
|

−1/2
|

z=zst

(cid:12)
(cid:12)
(cid:12)

(62)

(63)

exp (ikΦ

iπ/4σsgn(∂I/∂z))

(70)

|z=zst .

−

To complete the calculation of the mode amplitude we
should express the derivative ∂I/∂z through parameters
of rays. In the next subsection this is done for two im-
portant examples of the starting ﬁeld.

B. Point source and source exciting a single mode

In the case of a point source forming the starting ﬁeld
(10) we deal with a congruence of rays leaving point
(0, z0). Labelling each ray by its starting momentum p0
we present the derivative ∂I/∂z as (∂I/∂p0)/(∂z/∂p0).
Then insertion of Eq. (11) into Eq. (70) yields

aσ
m =

1
∂I/∂p0|
|

2π

p

exp (k (S + σSm)

iµπ/2 + iσφb/2 + i(β

1)π/4) ,

Therefore our approach requires that

−

−

(71)

δz << ∆z,

×

with

7

(78)

β

≡ −

σsgn(∂I/∂p0)sgn(∂z/∂p0).

(72)

Formula (71) accounts for a contribution from a ray sat-
isfying the condition (67) to the m-th mode. The mode
amplitude is evaluated by summing up contributions
from all such rays. Note that in the range-independent
waveguide at any range point and for any mode there are
exactly two rays satisfying Eq. (67) [1–3, 18]. They es-
cape the source at grazing angles (equal in absolute value
and opposite in sign) that coincides with grazing angles
of the quasi-plane waves ϕ+
me−ikHmr at
depth z0. This statement remains valid in an adiabatic
waveguide as well. Notice that if rays are adiabatic, i.e.
the term Λ in the Hamiltonian (21) is negligible, then
Eq. (71) reduces to Eq. (52) with am(0) deﬁned by Eq.
(43). A corresponding transformation is rather simple
but somewhat lengthy and therefore we do not present it
here.

me−ikHmr and ϕ−

A similar result can be derived for a source exciting a
single mode with m = m0 [1]. In this case we have two
congruences of rays associated with functions ϕ±
m0 . Ini-
tial actions of all rays are equal to Im0 and their starting
depths are located between turning points of the mode.
There are two rays escaping each point z0 within this
interval of depths. These rays have starting momenta

p0 =

2(Hm0(0)

U (z0))

(73)

and complex amplitudes [1, 19]

±

p

−

A =

e±i(Sm0 (z)+φb/2).

(74)

Qm0(z0)
∂z/∂z0|
|
p

Here we label rays by their starting depths. Substitut-
ing Eq. (74) into Eq. (70) and representing ∂I/∂z as
(∂I/∂z0)/(∂z/∂z0) yields

aσ
m =

Qm0(z0)
k

∂I/∂z0|
|

p

exp (ik (S + σSm + β0Sm0(z0)))

×

×

−

exp (

iµπ/2 + iσφb/2 + iβπ/4) ,

(75)

with

β

≡ −

σsgn(∂I/∂z0)sgn(∂z/∂z0), β0 = sgn(p0).

(76)

An important cautionary remark should be made.
When using the stationary phase technique we assume
that the integration in Eq.
(61) goes over an interval
exceeding

where ∆z is a diﬀerence between mode turning points.
Denote by ∆I a spread of the ray action at the range of
observation. A corresponding spread of the “energy” H
in accord with Eqs. (13) and (24) is ∆H = 2π∆I/D.
Assuming that the spread of ray depths at the range of
observation has the same order of magnitude as ∆z and
using Eq. (69) we obtain an order-of-magnitude estimate

∂2Φ
∂z2 ≈

1
p

∆H
∆z

=

1
p

2π
D

∆I
∆z

,

(79)

where p is an rms value of momentum at range r. As it
follows from Eq. (67) an initially excited mode breaks
up into a group of approximately

∆m = k∆I

(80)

modes. Using a rough estimate pD/2
ing Eqs. (77), (79), and (80) we get

≈

∆z and combin-

δz

≈

∆z
∆m/2

.

(81)

p
The condition (78) is met only if ∆m >> 1, that is if
many modes are excited. Thus, Eq. (75) is valid only in
a strongly nonadiabatic environment and at long enough
ranges where an initially excited mode breaks up into
many modes. In contrast, a point source usually excites
a large number of modes and therefore the condition (78)
practically does not restrict applicability of Eq. (71).

V. VARIATIONS OF ACTION VARIABLE AND
MODE COUPLING

A. Number of interacting modes and applicability
of adiabatic approximation

First, consider the case when only one mode is excited
at r = 0. In spite of the remark made at the end of Sec.
IV B the condition (67) even at short ranges properly in-
dicates rays contributing to the given mode. Therefore
Eq. (80) provides an estimate for the number of inter-
acting modes valid at any range. Correspondingly, the
applicability condition of adiabatic approximation can be
formulated in the form

∆I << 1/k.

(82)

The quantity ∆I on the left represents a diﬀerence be-
tween initial and ﬁnal actions along a typical ray. Sub-
(31) into the ﬁrst of ray equations (23)
stituting Eq.
yields

δz =

k

s

2π
∂2Φ
∂z2

.

(cid:12)
(cid:12)

(cid:12)
(cid:12)

(77)

∆I = I(r)

Im0

−

=

1
ω

−

∞

r

0

ν=1 Z
X

dr Vν(Im0 , r) cos (νθ) .

(83)

In the integrands on the right we neglect the deviation of
action from its starting value. In the same approximation
the second of ray equations (23) gives

r

θ = θ0 +

ω(Im0 , r)dr.

(84)

0
Z
Substituting this into Eq.
agrees with the condition (57).

(83) we see that Eq.

(82)

Since we consider a linear problem and the wave ﬁeld
can be always represented as a superposition of normal
modes the criterion (82) remains valid for an arbitrary
source. But in the case of a point source we have an ex-
plicit expression for the mode amplitude (Eq. (71)) which
can be used at both short ranges where the adiabatic ap-
proximation is still valid and at long ranges where this
approximation fails. Proceeding from this result we shall
derive a more accurate criterion. It is natural to expect
that the deviation from the adiabaticity ﬁrst reveals it-
self in a deviation of the phase kΦ deﬁned by Eqs. (63),
(67), and (68) from its value obtained under assumption
that Λ can be dropped.

In order to estimate this phase deviation take a ray (we
shall call it nonadiabatic) contributing to the m-th mode
and compare its phase with that of a similar ray (adia-
batic) whose trajectory satisﬁes Eqs. (23) with Λ = 0.
Both rays escape the same point source and at range r
have the same value of action I = Im. Formally, we shall
assume that Λ is proportional to some small parameter ε.
Our purpose is to evaluate the diﬀerence between phases
of the rays up to terms of order O(ε). We shall use the
symbols δS, δI, δθ, and δz to denote the diﬀerence in
eikonals, action variables, angle variables, and vertical
coordinates of the nonadiabatic and adiabatic rays, re-
spectively.

Compare eikonals (see Eq. (25)) of our rays. From

Eqs. (15) it follows that

G(z0, Im + δI0, 0)

G(z0, Im, 0) = θ(0)δI(0),

(85)

and

G(z + δz(r), Im, r)

G(z, Im, r) = pmδz(r).

(86)

Making use of ray equations (23) yields

−

−

r1

δ

(Idθ

Hdr)

−

r0

Z

=

Imdδθ + δIdθ

r1

r0 (cid:18)
Z

∂H
∂I

−

δIdr

(cid:19)

8

(89)

(90)

The integration goes along the adiabatic ray. We assume
that the nonadiabaticity is so week that the constants
µ, β, and σ for both rays are the same. According to
Eq. (39) the diﬀerence between Sm corresponding to our
rays can be estimated as δSm = pmδz(r). Taking into
account Eq. (68) we ﬁnally arrive at

δΦ =

Λdr.

k

−

Z

A slightly diﬀerent derivation of Eq.
(89) is given in
Ref. [3]. Thus, applicability of adiabatic approximation
requires that

k

Λdr

π.

≪

Z

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

Using an explicit expression for Λ given by Eq. (31) and
approximating θ by expression presented in Eq. (84) it is
not diﬃcult to show that the condition (90) agrees with
Eqs. (56) and (57).

The criterion (82) is much more convenient for practi-
cal applications than (57) and (90). Indeed, evaluation
of ∆I can be performed using a standard ray code with-
out exploiting formula (83). To ﬁnd action I at the given
range r one should (i) compute the ray parameters p and
z at this range and (ii) using them as initial conditions
evaluate (with the same ray code) integral (12) over the
ray cycle in a corresponding reference waveguide.

B. Examples

To verify and illustrate the above results we have com-
puted wave ﬁelds in two range-dependent hydroacoustic
waveguides. This is done using the code MMPE [20]
originally created for solving the wide angle parabolic
equation. It has been slightly modiﬁed to use the stan-
dard parabolic equation approximation. All numerical
results presented in this section have been obtained for
monochromatic wave ﬁelds at a carrier frequency of 200
Hz.

In our ﬁrst example the sound speed ﬁeld is taken in
the form c(r, z) = ¯c(z) + δc(r, z). A range independent
constituent

¯c(z) = c0

1 + ε

e2(z−za)/B

2(z

za)/B

−

−

1

−

,

(cid:16)

(91)
(cid:17)(cid:17)
(cid:16)
with c0 = 1.5 km/s, B = 1 km, za =
1 km, and
ε = 0.0057 represents the so-called Munk proﬁle widely
used to study sound propagation in deep sea [7, 11].
We consider a strong range-dependent perturbation mod-
elling a synoptic eddy

−

= Im (δθ(r)

δθ(0)) .

−

Combining Eqs. (86) and (87) we ﬁnd

(87)

δc(r, z) = c2 exp

where

(r

r2)2
−
∆r2 −

z2)2
(z
−
∆z(r)2

−

(cid:18)

(92)

,

(cid:19)

δS = pmδz(r)

(88)

r1

Λdr.

−

r0

Z

∆z(r) = ∆zc −

∆zv exp

(r

rv)2
−
∆rv (cid:19)

.

−

(cid:18)

(93)

−

0.01 km/s, r2 = 300 km, z2 =

The following values of parameters have been selected:
c2 =
1 km, ∆r = 80
km, ∆zc = 0.5 km, ∆zv = 0.25 km, rv = 320 km, ∆rv =
20 km. The isolines of the total sound ﬁeld are shown in
Fig. 1.

−

1.5078

1.5042

1.5007

1.5007

1.5042

−0.6

−1

m
k
 
,
z

−1.4

−1.8

0

9
8
9
1.4

3
5
9
1.4

1

.

4

9

7

1

1

.

4

9

3

6

1.506

1.5025

1.5025

1.506

200

400

600

r, km

FIG. 1: Sound speed ﬁeld modelling a synoptic eddy in a deep
sea. Contour labels are of sound speed in km/s.

The upper panel in Fig.

2 shows the deviation of
mode amplitude at range r = 600 km from its start-
ing value at r = 0. The deviation is taken relative to
the rms mode amplitude at r = 0. It is seen that only
modes with m < 15, whose amplitudes remain practi-
cally unchanged, are adiabatic. This fact agrees with
predictions following from Eqs. (82) and (90).The mid-
dle and lower panels in Fig. 2 present values of δΦ and
k∆I = k(I(r)
Im) computed along ray paths escap-
ing the point source with starting values of action vari-
ables equal to Im (m = 0, . . . , 100). For each mode there
are two such rays with launch angles equal in absolute
value and opposite in sign (see comment after Eq. (68)).
Solid (dashed) curves in both panels correspond to rays
starting upward (downward). Consistent with our ex-
pectation, although δΦ/(2π) and k(I
Im) are not close
they have the same order of magnitude and both are very
small for adiabatic modes.

−

−

The upper panel in Fig. 3 shows the range depen-
dences of mode amplitudes in a situation when a single
mode with m = 60 is excited at r = 0. Due to scatter-
ing at the eddy the 60-th mode breaks up into a group
In order to predict the width of this group
of modes.
using Eq. (80) we have traced a fan of 40 rays with ini-
tial actions equal to I60. The rays start from 20 points
uniformly sampling the depth interval between the turn-
ing points of mode 60. There are two rays with start-
ing momenta deﬁned by Eq. (73) escaping each point.
The lower panel of Fig. 3 presents the deviation of ac-
tion from its starting value as a function of range. It is
clearly seen that in agreement with Eq. (80) k∆I with
representing the spread of actions
∆I = max
at the given range, properly predicts the width of the
group of excited modes.

I(r)
|

I60|

−

In another example of the range-dependent waveguide

9

10

20

30

40

50

60

70

80

90

100

10

20

30

40

50

60

70

80

90

100

10

20

30

70

80

90

100

40
50
60
mode number, m

FIG. 2: Modes excited by a point source at a carrier frequency
200 Hz. The source is set at z = −1 km. Upper panel: Nor-
malized diﬀerences between mode amplitudes at ranges r = 0
and r = 600 km; ∆am = am(600 km) − am(0), arms is a rms
mode amplitude at r = 0. Middle panel: phase variations δΦ
due to nonadiabaticity predicted by Eq. (89) at r = 600 km
for rays starting upward (solid line) and downward (dashed
line). Lower panel: deviations of ray actions from their start-
ing values Im at r = 600 km computed for rays starting up-
ward (solid line) and downward (dashed line).

1

0.8

0.6

0.4

0.2

0

100

200

300

400

500

600

1

s
m

r

m

a
/
|

a
 
∆

|

0

0

1

)
π
2
(
/

Φ
δ

0.5

0

−0.5

−1

0

0.5

1

0

−0.5

−1

0

)

m

I

−
I
(
k

m

60

65

55

)

0
6

I

−
I
(
k

5

0

−5

0

100

200

400

500

600

300
r (km)

FIG. 3: Upper panel: range dependences of mode amplitudes
(shown by gradations of gray) for the case when only one
mode with m = 60 is excited at r = 0. Lower panel: deviation
of the action variable from its starting value computed for a
fan of 40 rays starting from diﬀerent depth points with actions
I(0) = I60.

the sound speed ﬁeld

c(r, z) =

c1(z) +

c2(z),

(94)

R

r

−
R

r
R

with R = 200 km being the waveguide length, represents
a linear superposition of two proﬁles c1(z) and c2(z). An
evolution of the sound speed proﬁle with range is shown
in Fig. 4. In this waveguide the mode coupling is rather

strong and values of δΦ and k∆I (not shown) at range
200 km are on the order of unity for all modes. To check
the applicability of estimate (80) we, once again, have
considered the case when only the 60-th mode is excited
at r = 0. Figure 5 again demonstrates that k∆I provides
a good estimate for the width of a group of normal modes
into which the original mode breaks up. A new feature
of function ∆I(r) = max
absent in Fig. 3 is
I(r)
|
an appearance of narrow spots in both panels at ranges
of about 47, 94, 141, and 188 km. From the viewpoint of
the ray-based approach this phenomenon is related to the
fact that the sound speed ﬁeld (94) is a linear function
of range. Since U (r, z)
c0)/c0 is an almost
linear function of r, the derivative ∂U/∂r is practically
range-independent and the same is true of the coeﬃcients
θ0 +
Vν present in Eq. (83). At not very long ranges θ
ω(I60, 0)r and
in this approximation vanishes at
I60|
ranges equal to integer multiples of the cycle length of
the 60-th mode. The latter is about 47 km.

(c(r, z)

I60|

I
|

≈

−

−

≃

−

)

m
k
(
 
z

−2

0

−1

−3

−4

m

60

65

55

5

0

−5

0

)

0
6

I

−
I
(
k

1.48

1.52

sound speed (km/s)

FIG. 4: Sound speed proﬁles at range points equally spaced
within an interval from r = 0 to r = 200 km are plotted
(from left to right) with a sound speed oﬀset of 0.4 km/s.
The leftmost and rightmost curves represent functions c1(z)
and c2(z) in Eq. (94), respectively.

1

0.8

0.6

0.4

0.2

0

20

40

60

80

100

120

140

160

180

200

20

40

60

80

120

140

160

180

200

100
r (km)

FIG. 5: The same as in Fig. 3 but constructed for a waveguide
with the sound speed ﬁeld deﬁned by Eq. (94) and shown in
Fig. 4.

VI. CONCLUSION

10

In this paper we have considered a ray-based method
representing an analog of the geometrical optics for
modes. In the scope of this approach the mode ampli-
tude is expressed through solutions of the ray equations.
It turns out that the m-th mode is formed by contribu-
tions from rays whose action variables at the range of
observation, up to a multiplicative constant, are equal to
m. Since the ray method remains valid in the nonadia-
batic waveguide, the relatively simple formulas connect-
ing rays and modes provide a convenient tool for study-
ing the applicability of adiabatic approximation. In the
present paper we have used this option.

Our simplest criterion is given by Eq. (82) that im-
poses limitations on the range variation of the action vari-
able. This equation establishes connection between the
validity of adiabatic approximations for rays and modes.
It is interesting that when the condition (82) fails, the
quantity k∆I estimates a number of interacting modes.
For the case of a point source we have derived a more ac-
curate criterion (90) whose implementation, however, re-
quires more detailed calculations. Nevertheless, it should
be emphasized that (i) the left hand sides of both Eqs.
(82) and (90) can be evaluated using a standard ray trac-
ing and (ii) both criteria agree with the condition (57)
derived from the mode coupling equation. Note also that
unlike conditions (58) and (59), our criteria account for
accumulation of errors with range.

Since the left hand sides of Eqs. (82) and (90) are pro-
portional to the carrier frequency it is clear that the lower
the frequency, the better these inequalities are satisﬁed
and, hence, the wider the validity region of the adiabatic
approximation. The same conclusion follows from Eq.
(59).

Finally, notice that all our results have been obtained
in the high frequency approximation which, naturally,
restricts their generality.
In contrast, the use of the
parabolic equation approximation is not principal. The
results can be easily generalized to the case when the
wave ﬁeld is governed by the Helmholtz equation. Al-
though we have considered sound waves propagating
in underwater acoustic waveguides the formulas derived
here can be applied for description of wave propagation
in diﬀerent waveguide media and for analysis of a quan-
tum particle oscillating in a potential well with time-
dependent parameters.

This work was supported by the Russian Foundation

for Basic Research under Grant No. 03-02-17246.

11

[1] A.L. Virovlyansky and G.M. Zaslavsky, “Wave chaos in
terms of normal modes” Phys. Rev. E 59, 1656–1668
(1999).

[2] A.L. Virovlyanskii, L.Ya. Lyubavin, and S.A. Stromkov,
“The ray approach for analyzing the modal structure of
the sound ﬁeld in a range-dependent waveguide” Acous-
tical Physics 47, 517–523 (2001).

[3] A.L. Virovlyansky, A.Yu. Kazarova, and L.Ya. Lyubavin,
“Variations of mode amplitudes in a range-dependent
waveguide” Acoustical Physics 50, 20–29 (2004).

[4] G.P. Berman and G.M. Zaslavsky, “Condition of stocha-
sicity in quantum nonlinear systems” Physica A 97, 367–
382 (1979).

[5] L.D. Landau and E.M. Lifshitz, Mechanics, Pergamon

Press, Oxford, 1976.

[6] S.S. Abdullaev and G.M. Zaslavsky, “Classical nonlinear
dynamics and chaos of rays in wave propagation problems
in inhomogeneous media” Sov. Phys. Usp. 38, 645-687
(1991).

[7] L.M. Brekhovskikh and Yu.P. Lysanov, Fundamentals of

Ocean Acoustics, Springer-Verlag, Berlin, 1991.

[8] L.M. Brekhovskikh and O.A. Godin, Acoustics of Lay-
ered Media. II: Point Sources and Bounded Beams,
Springer-Verlag, Berlin, 1999.

[9] E.C. Shang, “Ocean acoustic tomography based on adi-
abatic mode theory” J. Acoust. Soc. Am. 85, 1531–1537
(1989).

[10] O.A. Godin, “Coupled-mode sound propagation in a
range-dependent moving ﬂuid” J. Acoust. Soc. Am. 111,
1984–1995 (2002).

[11] F.B. Jensen, W.A. Kuperman, M.B. Porter, and
H. Schmidt, Computational Ocean Acoustics, AIP,
Woodbury, New York, 1994.

[12] J. Simmen, S.M. Flatte, and G.-Y. Wan, “Wavefront
folding, chaos, and diﬀraction for sound propagation
through ocean internal waves” J. Acoust. Soc. Am. 102,
239–255 (1997).

[13] M. Born and E. Wolf, Principles of optics, Pergamon

Press, Oxford, 1968.

[14] M.C. Gutzwiller, “Phase-integral approximation in mo-
mentum space and the bound states of an atom” J. Math.
Phys. 8, 1979–2000 (1967).

[15] S.S. Abdullaev, Chaos and dynamics of rays in waveg-
uide media, Edited by G. Zaslavsky, Gordon and Breach
science publishers, New York, 1993.

[16] L.D. Landau and E.M. Lifshitz, Quantum mechanics,

Pergamon Press, Oxford, 1977.

[17] D.M. Milder, “Ray and wave invariants for sofar channel
propagation” J. Acoust. Soc. Am. 46, 1259–1263 (1969).
[18] A.L. Virovlyansky, V.V. Kurin, N.V. Pronchatov-
Rubtsov, and S.I. Simdyankin, “Fresnel zones for modes”
J. Acoust. Soc. Am. 101, 163–173 (1995).

[19] V.P. Maslov and M.V. Fedoriuk, Semi-classical approxi-
mation in quantum mechanics, Reidel, Boston, 1981.
[20] K.B. Smith, “Convergence, stability, and sariability of
shallow water acoustic predictions using the split-step
fourier parabolic equation model” J. Comp. Acoust. 9,
243–285 (2001).

