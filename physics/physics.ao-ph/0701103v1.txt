7
0
0
2
 
n
a
J
 
9
 
 
]
h
p
-
o
a
.
s
c
i
s
y
h
p
[
 
 
1
v
3
0
1
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Super-Droplet Method for the Numerical Simulation of Clouds and Precipitation: a
Particle-Based Microphysics Model Coupled with Non-hydrostatic Model

Shin-ichiro Shima,∗ Kanya Kusano, Akio Kawano, Tooru Sugiyama, and Shintaro Kawahara
The Earth Simulator Center, Japan Agency for Marine-Earth Science and Technology, Yokohama, Japan

A novel simulation model of cloud microphysics is developed, which is named Super-Droplet
Method (SDM). SDM enables accurate calculation of cloud microphysics with reasonable cost
in computation. A simple SDM for warm rain, which incorporates sedimentation, condensa-
tion/evaporation, stochastic coalescence, is developed. The methodology to couple SDM and a
non-hydrostatic model is also developed. It is conﬁrmed that the result of our Monte Carlo scheme
for the coalescence of super-droplets agrees fairly well with the solution of stochastic coalescence
equation. A preliminary simulation of a shallow maritime cumulus formation initiated by a warm
bubble is presented to demonstrate the practicality of SDM. Further discussions are devoted for the
extension and the computational eﬃciency of SDM to incorporate various properties of clouds, such
as, several types of ice crystals, several sorts of soluble/insoluble CCNs, their chemical reactions,
electriﬁcation, and the breakup of droplets. It is suggested that the computational cost of SDM
becomes lower than spectral (bin) method when the number of attributes d becomes larger than
some critical value, which may be 2 ∼ 4.

I.

INTRODUCTION

lightning.

Although clouds play a crucial role in atmospheric phe-
nomena, the numerical modeling of cloud is not well es-
tablished up to the present. The macro-scale processes
such as the ﬂuid motion of moist air associated with
clouds is called ”cloud dynamics” and the micro-scale
processes such as condensation/evaporation, stochastic
coalescence, and sedimentation of water droplets, are
called ”cloud microphysics”. These two processes mu-
tually aﬀect each other, and thus we can say that
cloud formation and precipitation development are typi-
cal multiscale-multiphysics phenomena. Cloud dynamics
model to describe the ﬂuid motion in the atmosphere
has been well developed (Jacobson 2005). However, it is
still diﬃcult to perform an accurate simulation of cloud
microphysics though several simulation methods, such
as bulk parameterization method (Kessler 1969; Ziegler
1985; Murakami 1990; Ferrier 1994; Meyers et al. 1997),
spectral (bin) method (Berry 1967; Soong 1974; Bott
1998, 2000), and the exact Monte Carlo method (Gille-
spie 1975; Seeßelberg et al. 1996), have been proposed.
Numerical methods to accurately simulate both processes
and their interactions are required to understand and pre-
dict cloud-related phenomena.

We have developed a novel, particle-based simula-
tion model of cloud microphysics, named Super-Droplet
Method (SDM), which enables accurate numerical simu-
lation of cloud microphysics with reasonable cost in com-
putation. Though several extensions and validations are
still necessary, we expect that SDM provides us a new ap-
proach to the cloud-related open problems, such as the
cloud and aerosol interactions, the cloud-related radia-
tive processes, and the mechanism of thunderstorms and

∗Electronic address: s shima@jamstec.go.jp

SDM can be regarded as a sort of Direct Simula-
tion Monte Carlo (DSMC) method, which was initially
proposed to simulate the Boltzmann equation for pre-
dicting rareﬁed gas ﬂows (Bird 1994). Particularly,
SDM has similarity to the Extended version of the No-
Time-Counter (ENTC) method, which was developed
by Schmidt and Rutland (2000) for the simulation of
spray ﬂows. Though the basic idea of using a compu-
tational particle with varying multiplicity is common in
both SDM and ENTC, there is a diﬀerence in the proce-
dure of the Monte Carlo scheme.

The main purpose of the present paper is to de-
velop a simple SDM for warm rain, which incorporates
sedimentation, condensation/evaporation, and stochas-
tic coalescence, and discuss the theoretical foundations
of SDM. The methodology to couple SDM and the non-
hydrostatic model is also developed. Further discussions
on the extensions and the computational eﬃciency of
SDM are also carried out, even though brieﬂy.

The organization of the present paper is as the follow-
ing. In Sec. II we introduce the principle model, which is a
very primitive microphysics-macrodynmics coupled cloud
model and a good starting point for our discussions. In
Sec. III we review the traditional methods, i.e., the ex-
act Monte Carlo method, bulk parameterization method,
and spectral (bin) method and see how they are derived
from the principle model and what are the problems they
involve. In Sec. IV, we develop a simple SDM for warm
rain, which can be regarded as a coarse-grained model
of the principle model, and discuss the theoretical foun-
dation and characteristics of SDM. Numerical simulation
scheme is also proposed for each process. Especially, a
novel Monte Carlo scheme for the stochastic coalescence
process is developed and validated. In Sec. V a very pre-
liminary result of a shallow maritime cumulus formation
initiated by a warm bubble is presented to demonstrate
the practicality of SDM. In Sec. VI we brieﬂy discuss the
possibility to extend SDM to incorporate various proper-

ties of clouds, such as, several types of ice crystals, several
sorts of soluble/insoluble CCNs, their chemical reactions,
electriﬁcation, and the breakup of droplets. The esti-
mation of the computational cost of SDM suggests that
SDM will be computationally more eﬃcient compared to
spectral (bin) method when the number of attributes d
becomes larger than some critical value, which may be
2
4. Finally, a summary and concluding remarks are
presented in Sec. VII.

∼

II. THE PRINCIPLE MODEL

This section is devoted for the introduction of the prin-
ciple model. The principle model is a very primitive
microphysics-macrodynmics coupled cloud model. The
characteristic point of this model is the very precise de-
scriptions of cloud microphyscs processes, which is re-
alized by following all the water droplets in the atmo-
sphere. Though being not so useful because of the high
cost in computation, this model gives us a clear overview
of the relationship between each methods to be intro-
duced later, i.e., the exact Monte Carlo method, bulk
parameterization method, spectral (bin) method, and
super-droplet method.

A.

cloud microphysics for the principle model

1.

deﬁnition of real-droplets

Warm clouds and rain consist of large number of water
droplets with broad range of radius from micrometers to
several millimeters. Several sorts of aerosol particles are
also ﬂoating in the atmosphere, which can be a seed of a
cloud droplet. These particles are called Cloud Conden-
sation Nuclei (CCN). We regard each of these particles in-
cluding both water droplets and CCNs as a real-droplet.
Let Nr(t) be the number of real-droplets ﬂoating in
the atmosphere at time t. Each real-droplet is located
at position xi(t), i = 1, 2, . . . , Nr(t), with velocity vi(t)
and radius Ri(t). Soluble CCN is dissolved in each real-
droplets. Here, we consider only one soluble substance
as the CCN and Mi denotes the mass of solute dissolved
in the real-droplet i. We refer to these state variables,
the velocity vi(t), the radius Ri(t), and the mass of so-
lute Mi(t), as the attributes of real-droplets denoted by
ai(t). Note that we do not regard the position xi(t) as an
attribute for convenience. Assuming that the droplet ve-
locity immediately reaches their terminal velocity, vi(t)
is determined by their radius Ri(t). As a result, the num-
ber of independent attributes of our real-droplet is two,
the radius Ri(t) and the mass of solute Mi(t). In the fol-
lowing, we give the time evolution law of real-droplets.

2

2. motion of real-droplets

In general, the motion equation of a real-droplet is de-
termined by the drag force from the ambient air and the
gravitational force:

mi

dvi
dt

= mig + FD(vi, U (xi), Ri),

= vi,

(1)

dxi
dt

where mi := (4π/3)R3
i ρliq is the mass of the droplet i
with ρliq = 1.0 g cm−3, g is the gravitational constant,
FD is the atmospheric drag, and U (xi) is the wind ve-
locity at the droplet position xi(t). Assuming that all
the droplets reach their terminal velocity immediately
enough, vi(t) is evaluated as vi(t) = U (xi)
ˆzv∞(Ri),
which is the steady solution of (1). We give v∞(Ri)
according to the semi-empirical formulas developed by
Beard (1976). Consequently, vi(t) is no longer an inde-
pendent attribute of real-droplet in our model.

−

3.

condensation/evaporation of real-droplets

We consider the mass change of real-droplets through
condensation/evaporation process according to
the
K¨oheler’s theory, which takes into account the solution
and curvature eﬀects on the droplet’s equilibrium vapor
pressure (K¨oheler 1936; Rogers and Yau 1989). The
growth equation of the radius Ri is derived as the fol-
lowing.

(S

−

=

1)

a
Ri
−
Fk + Fd

+ b
R3
i

,

Ri

dRi
dt
L

Fk = (

RvT −

1)

Lρliq
KT

, Fd =

ρliqRvT
Des(T )

.

(2)

Here, S is the ambient saturation ratio; Fk represents the
thermodynamic term associated with heat conduction;
Fd is the term associated with vapor diﬀusion; the term
a/Ri represents the curvature eﬀect which expresses the
increase in saturation ratio over a droplet as compared
to a plane surface; the term b/R3
i shows the reduction
in vapor pressure due to the presence of a dissolved sub-
stance and b depends on the mass of solute Mi dissolved
10−5/T (cm) and
in the droplet. Numerically, a
≃
4.3iMi/ms (cm3), where T (K) is the temperature,
b
2 is the degree of ionic dissociation, ms is the molecu-
i
lar weight of the solute. Rv is the individual gas constant
for water vapor, K is the coeﬃcient of thermal conductiv-
ity of air, D is the molecular diﬀusion coeﬃcient, L is the
latent heat of vaporization, and es(T ) is the saturation
vapor pressure.

≃
≃

3.3

×

4.

stochastic coalescence of real-droplets

Two real-droplets may collide and coalesce into one
big real-droplet and this process is responsible for pre-
cipitation development. It is worth noting here that the

3

Here, D/Dt := ∂/∂t + U
is the material derivative;
· ∇
ρ = ρd + ρv is the density of moist air, which is repre-
sented by the sum of dry air density ρd and vapor den-
sity ρv; qv = ρv/ρ is the mixing ratio of vapor; U is the
wind velocity; T is the temperature; θ is the potential
temperature; Π = (P/P0)(Rd/cp) is the Exner function
with reference pressure P0; ρw is the density of liquid
water; Sv is the source term of water vapor associated
with condensation/evaporation process; g is the gravita-
tional constant; λ and κ are the transport coeﬃcient; Rd
is the gas constant for dry air; cp is the speciﬁc heat of
dry air at constant pressure; L is the latent heat of vapor-
ization. Equations (5)-(9) represent equation of motion,
equation of state, thermodynamic equation, mass conti-
nuity, and water continuity, respectively. Note here that
it is assumed that qv ≪
There are three coupling terms from the microphysics:
ρw represents the momentum coupling; LSv/cpΠ is
the release of
through the condensa-
tion/evaporation process; Sv is the source term of vapor
through the condensation/evaporation process. These
source terms are evaluated by the microphysics variables,

1 to derive these equations.

latent heat

Nr

i=1
X

ρw(x, t) :=

mi(t)δ3(x

xi(t)),

−

Sv(x, t) := −

1
ρ(x, t)

∂ρw
∂t

(x, t),

(10)

(11)

where mi is the mass of real-droplet i.

The principle model has deﬁned completely now and
we can see that the description of the cloud microphysics
is very precise. In the next section, we review the tra-
ditional methods from the point of view how they are
related to the principle model.

III. TRADITIONAL METHODS

In this section, we review the traditional methods and
see how they are derived from the principle model and
what are the problems involved.

coalescence process is of our particular concern in this pa-
per because SDM is expected to overcome the diﬃculty
in the numerical simulation of coalescence process.

Our primary postulate, which is commonly used in
many previous studies, is that the coalescence process
can be described in a probabilistic way. Consider a re-
gion with volume ∆V which is small enough compared
to the space-scale of the atmospheric ﬂuid. Then, we
assume that the real-droplets inside this region are well-
mixed and coalesce with each other with some probability
during a suﬃciently short time interval (t, t + ∆t), i.e.,
there exists such C(Rj, Rk) that satisﬁes

vj −
Pjk =C(Rj, Rk)
|
∆t
∆V

=K(Rj, Rk)

∆t
∆V

vk|

=probability that real-droplet j and k

inside the small region ∆V will coalesce
in the short time interval (t, t + ∆t).

(3)

Here, C(Rj, Rk) can be regarded as the eﬀective collision
cross-section of the real-droplets j and k and may be
evaluated as

C(Rj , Rk) = E(Rj, Rk)π(Rj + Rk)2,

(4)

where E(Rj, Rk) is the collection eﬃciency, which takes
into account the eﬀect that a smaller droplet would be
swept aside by the stream ﬂow around the larger droplet
or bounce on the surface (Davis 1972; Hall 1980; Jonas
1972; Rogers and Yau 1989) . K(Rj, Rk) is deﬁned by
vj −
K(Rj, Rk) := C(Rj, Rk)
and it is called the coa-
|
lescence kernel, which will later appear in the stochastic
coalescence equation.

vk|

The cloud microphysical process of the principle model
has been deﬁned. We will turn to determine the cloud
dynamics process of the principle model.

B.

cloud dynamics of the principle model

We may apply non-hydrostatic model to describe the
cloud dynamics process of the principle model. There are
several versions of non-hydrostatic model, but the basic
equations used in this paper is as the following.

ρ

DU
Dt

=

P

(ρ + ρw)g + λ

−∇

−

2U ,

∇

P = ρRdT,

L
cpΠ

Sv + κ

2θ,

∇

=

ρ

−

∇ ·

U ,

= Sv + κ

2qv.

∇

Dθ
Dt

=

−
Dρ
Dt
Dqv
Dt

A. The exact Monte Carlo method

(5)

(6)

(7)

(8)

(9)

The exact Monte Carlo method was developed by
Gillespie (1975) and improved by Seeßelberg et al.
(1996) . This method simulates the principle model very
directly. Their procedure repeatedly draws a random
waiting time for which the next one pair of real-droplets
will coalesce. Consequently, it is very rigorous, but not
so useful to simulate a cloud formation process in a suf-
ﬁciently large region because of the very high cost in
computation.

B. bulk parameterization method

(12) reduces to

Bulk parameterization method is most commonly used
to deal with cloud microphysics. This method empirically
evaluates the source terms from microphysics, such as ρw
and Sv, as a function of the ﬁeld variables in the cloud
dynamics model (Kessler 1969; Ziegler 1985; Murakami
1990; Ferrier 1994; Meyers et al. 1997). Then, the gov-
erning equations become a closed form in cloud dynamics
variables and we need not cope directly with cloud micro-
physics. Consequently, the number of degrees of freedom
is reduced so much that the computational demand is ex-
tremely relaxed. However, the accuracy seems to be not
always enough. This is very likely because bulk param-
eterization is justiﬁed under the assumption that there
exists a closed-form equation in cloud dynamics, though
this is not guaranteed.

C.

spectral (bin) method

Another approach to cloud microphysics is spectral
(bin) method (Berry 1967; Soong 1974; Bott 1998, 2000).
Spectral (bin) method is characterized by solving the
time evolution equation of the number density distribu-
tion of real-droplets.
Let Xi = (4π/3)R3

i be the volume of the real-droplet i,
and n(X, M, x, t) be the number density distribution of
real-droplets, i.e., n(X, M, x, t)∆X∆M ∆V denotes the
number of real-droplets with their volume in the range
of (X, X + ∆X), mass of solute in the range of (M, M +
∆M ), inside the space region ∆V around x, at time t.
Then, the time evolution equation for n(X, M, x, t) which
corresponds to the principle model can be derived as the
following.

vt(X, x)n

+

fg(X, M, x)n

∂
∂X {

}

}

∇x · {

+

M

X

=

dM ′

dX ′n(X ′, M ′)n(X ′′, M ′′)K(X ′, X ′′)

0

Z
n(X, M )

0
Z

∞

∞

dM ′

dX ′n(X ′, M ′)K(X, X ′),

∂n
∂t
1
4

−

0
Z

0
Z

(12)

−

ˆzv∞(R) is the terminal ve-
where vt(X, x) := U (x)
locity of a droplet, fg(X, M, x) := 4πR
(r.h.s of (2))
×
satisﬁes dX/dt = fg, K is the coalescence kernel deﬁned
M ′. The l.h.s
X ′, and M ′′ := M
in (3), X ′′ := X
of (12) corresponds to the advection of real-droplets in
real-space and attribute-space, and the r.h.s corresponds
to the expected dynamics of the stochastic coalescence
process.

−

−

On the ideal case when there is only the stochastic
coalescence process and neither sedimentation nor con-
densation/evaporation process exists, and further, only
the droplet volume X is regarded as the attribute, then

4

(13)

∂n(X, t)
∂t

=

1
2

X

dX ′n(X ′)n(X ′′)K(X ′, X ′′)

0
Z
n(X)

−

∞

0
Z

dX ′n(X ′)K(X, X ′).

This is the simplest case of spectral (bin) method and
(13) is the equation which is sometimes called the
stochastic coalescence equation (SCE), but in this paper,
SCE is used as a general term refers to the governing
equation of spectral (bin) method.

These equations are derived from the probability
law (3) under the assumption that the number density
has no correlation (Gillespie 1972). This assumption
seems to be correct (Seeßelberg et al. 1996), thus the
solution of SCE can be very accurate. However, the com-
putational cost to solve SCE is very expensive, especially
if we consider many types of microphysics processes and
the number of attributes d becomes large. We will come
back to this remark in Sec. VI, but in a word, this is
owing to the fact that the governing equation contains a
d-multiple integral.

IV. SUPER-DROPLET METHOD

In this section, we develop a simple SDM for warm
rain, which can be regarded as a coarse-grained model
of the principle model, and discuss the theoretical foun-
dation and characteristics of SDM. Numerical simulation
scheme is also proposed for each process. Especially, a
novel Monte Carlo scheme for the stochastic coalescence
process is developed and validated.

A.

cloud microphysics for Super-Droplet Method

1.

deﬁnition of super-droplets

}

First of all,

let us deﬁne what a super-droplet is.
Each super-droplet represents a multiple number of real-
droplets with the same attributes and position, and the
multiplicity is denoted by the positive integer ξi(t)
1, 2, . . .

∈
, which value can be diﬀerent in each super-
{
droplet and time-dependent due to the deﬁnition of co-
alescence introduced later. That is to say, each super-
droplet has their own position xi(t) and own attributes
ai(t), which characterize the ξi(t) number of same real-
droplets represented by the super-droplet i. Here, the
attribute ai(t) consists of the radius Ri(t) and the so-
lute mass Mi(t) for this simplest case. Note here that
no two real-droplets have exactly the same position and
attributes.
In this sense, super-droplet is a kind of
coarse-grained view of real-droplets both in real-space
and attribute-space. Let Ns(t) be the number of super-
droplets ﬂoating in the atmosphere at time t. Then, these
Ns(t)
i=1 ξi(t) number of
super-droplets represent Nr(t) =

P

3.

condensation/evaporation of super-droplets

Condensation/evaporation process of super-droplets is

also governed by the growth equation (2).

We may adopt implicit Euler discretization scheme for

generality, and

the numerical simulation of (2), yielding

real-droplets in total. In the following, we give the time
evolution law of the super-droplets.

2. motions of super-droplets

Except the coalescence process, each super-droplet be-
haves just like a real-droplet. Thus, a super-droplet
moves according to the motion equation (5) and vi(t)
is evaluated by the terminal velocity.

It is easy to simulate this process numerically. Deﬁne
the time step ∆tm and evaluate the terminal velocity
vi(t) and the position xi(t + ∆tm) = xi(t) + ∆tmvi(t) at
each time step.

R2

i,n+1 −
2∆tg

R2

i,n

=

(S

1)

−

a
Ri,n+1
−
Fk + Fd

+ b
R3

i,n+1

,

Ri(t = n∆tg). It may be not possible to de-
where Ri,n ≃
termine analytically the next step value Ri,n+1 from the
previous value Ri,n. However, using Newton-Raphson
scheme, Ri,n+1 can be evaluated numerically.

4.

stochastic coalescence of super-droplets

Stochastic coalescence process for the super-droplets
must be formulated carefully so that the super-droplets
well-approximate the behavior of real-droplets. The for-
mulation procedure is in two steps: 1) deﬁne how a pair
of super-droplets coalesce; 2) determine the probability
that the super-droplet coalescence occurs.

Consider the case when a pair of super-droplets (j, k)
will coalesce. These super-droplets represent ξj number
of real-droplets (aj, xj) and ξk number of real-droplets
(ak, xk). Let us deﬁne that exactly min (ξj, ξk) pairs
of real-droplets will contribute to the coalescence of the
super-droplet pair (j, k). Figure. 1 is a schematic view
In this example,
of the coalescence of super-droplets.
ξj = 3 and ξk = 2. We can see that min (ξj , ξk) = 2 pairs
of real-droplets undergo coalescence, which results in the
decrease of multiplicity ξj : 3
1 and the increase of the
size of the super-droplet k.

→

Below is the complete deﬁnition of how a pair of super-

droplets (j, k) change their state after the coalesce:

1. if ξj 6

= ξk, we can choose ξj > ξk without losing

5

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

FIG. 1: Schematic view of the coalescence of super-droplets.
Two super-droplets with multiplicity 2 and 3 undergo coa-
lescence (upper left). This represents the coalescence of 2
real-droplet pairs (lower left and right). As a result the super-
droplet with multiplicity 2 becomes larger and the multiplicity
of the other super-droplet decreases 3 → 1 (upper right).

ξ′
j = ξj −
j = Rj, R′
R′
j = Mj, M ′
M ′

ξ′
k = ξk,
ξk,
k)1/3,
j + R3
k = (R3
j = (Mj + Mk),
k = xk,

x′
j = xj, x′

where the dashed valuables represent the updated
value after the coalesce.

2. if ξj = ξk,

[ξj/2],
1/3

ξ′
j = [ξj/2],
R′
j = R′
k =
j = M ′
M ′
j = xj, x′
x′

ξ′
k = ξj −
j + R3
R3
k
k = (Mj + Mk) ,

(cid:1)
k = xk,

(cid:0)

,

where Gauss’ symbol [x] is the greatest integer that
is less than or equal to x.

Note here that in the case ξj = ξk, no real-droplets will
be left after the coalescence because all ξj number of real-
droplets contribute to the coalescence. Thus, we divide
the resulting ξj number of real-droplets into two super-
droplets.

This deﬁnition of super-droplet coalescence possess has
a favorable property that the number of super-droplets
is unchanged in most cases though the number of real-
droplets always decreases. The number of super-droplets
is decreased through the coalescence only when ξj = ξk =
1, i.e., both super-droplets are real-droplets. This results
in ξ′
k = 1, and we remove the super-droplet j
out of the system. Because the number of super-droplets
corresponds to the accuracy of SDM, the number conser-
vation of super-droplets suggests the ﬂexible response of
SDM to the drastic change of the number of real-droplets.

j = 0 and ξ′

Having deﬁned how a pair of super-droplets coalesces,
we turn to determine the probability that the coalescence
occurs. If we require the consistency of the expectation
value, the probability is determined as the following.

P (s)
jk = max(ξj, ξk)Pjk

=probability that super-droplet j and k

inside the small region ∆V will coalesce
in the short time interval (t, t + ∆tc).

(22)

Indeed, we can conﬁrm that the expectation value is
exactly the same to that of the principle model (real-
droplet view). The super-droplet j represents ξj num-
ber of real-droplets with attribute aj and super-droplet
k represents ξk number of real-droplets with attribute
ak. From the real-droplet view, there are ξj ξk number
of real-droplet pairs which have the possibility to coa-
lesce with the probability Pjk, i.e., the number of real-
droplet pairs which will coalescence follows the binomial
distribution with ξj ξk trials and success probability Pjk.
Thus, from the real-droplet view, the expectation value
of the number of coalesced pairs is ξj ξkPjk. From the
super-droplet view, a coalescence of super-droplets j and
k represents the coalescence of min(ξj, ξk) pairs of real-
droplets with attribute aj and ak. Thus, the coales-
cence of super-droplets j and k is expected to represent
min(ξj , ξk)P (s)
jk = min(ξj , ξk) max(ξj, ξk)Pjk = ξjξkPjk
number of coalescence of real-droplet pairs, which is equal
to the value of the real-droplet view. It is worth notic-
ing here that the variance of super-droplet view becomes
larger than that of real-droplet view. From real-droplet
view, the variance of the number of coalesced pairs is
ξj ξkPjk =: Vr (Poisson distribu-
ξjξkPjk(1
tion limit). From super-droplet view, the variance is
min(ξj, ξk)Vr, which
ξjξkPjk}
min(ξj, ξk)
{
}
is min(ξj, ξk) times larger than that of the real-droplet
view.

jk − {

2P (s)

Pjk)

≃

−

≃

2

We have deﬁned the cloud microphysics of super-
droplets. If all the multiplicity ξi = 1 then our model is
equivalent to the principle model. Thus, we can change
the accuracy of our model by changing the initial dis-
, or equivalently, the
tribution of multiplicity
initial number of super-droplets Ns(t = 0). If the con-
vergence to the principle model is rapid, we can say that
the use of SDM is beneﬁcial.

ξi(t = 0)
}

{

The deﬁnition of the coalescence process of super-
droplets is rather theoretical and we have to do numerical
simulation on this model somehow. In the next section,
we develop a Monte Carlo scheme for the stochastic co-
alescence, which can simulate the coalescence process of
super-droplets eﬃciently.

5. Monte Carlo Scheme for super-droplet coalescence

6

{

∈

∈

I 2, j

jk ≪

i1, i2, . . . ins}

compared to the space-scale of the atmospheric ﬂuid so
that the coalescence occurs according to the probability
(22) in each cell. Let us make a list of super-droplets in
, where ns is
a certain cell at time t: I :=
the total number of super-droplets in the cell. Then,
I 2,
by deﬁnition, each pair of super-droplets (j, k)
= k, coalesces with the probability P (s)
jk within the
j
short time interval (t, t + ∆tc). Note that P (s)
1 be-
cause ∆tc is small. We have to examine all the possible
pairs (j, k)
= k, to know the random realization
at the time t + ∆tc. However, this yields computational
cost O(n2
s) and this is not eﬃcient. Instead, we propose
a novel Monte Carlo scheme which leads us to O(ns) cost
in computation.
Let L :=

(j1, k1), (j2, k2), . . . , (j[ns/2], k[ns/2])
}

be a
list of randomly generated, non-overlapping, [ns/2] num-
ber of pairs. Non-overlapping means that no super-
droplet belongs to more than one pair. This list can
be made by generating a random permutation of I and
make pairs from the front, which cost O(ns) in computa-
tion (see the appendix). By examining only these [ns/2]
1)/2 pairs,
pairs instead of the whole possible ns(ns −
the cost will be O(ns). In compensation for this simpli-
ﬁcation, all the coalescence probability is divided by the
decreasing ratio of pair number, and the corrected, scaled
up probability for the αth pair is obtained as

{

pα := P (s)
jαkα

1)

ns(ns −
2

ns
2

.

i

(cid:30) h

(23)

This may be justiﬁed if the following relation holds good,

[ns/2]

α=1
X

min(ξjα , ξkα )pα ≃

min(ξj , ξk)P (s)
jk

1
2

1
2

X Xj,k,j6=k

X Xj,k,j6=k

=

ξjξkPjk,

which represent the consistency of the expectation num-
ber of coalesced real-droplet pairs in this cell.

Based on the above idea, below is the complete pro-
cedure of our Monte Carlo scheme to obtain one of the
stochastic realizations in a certain cell at time t + ∆tc
from the sate of super-droplets at time t.

i1, i2, . . . ins}

1. Make the super-droplet list at time t in this certain
.

cell: I =

{
the
(j1, k1), (j2, k2), . . . , (j[ns/2], k[ns/2])
}

2. Make
L =
the random permutation of I.

[ns/2] number of

candidate-pairs
from

{

3. For each pair of super-droplets (jα, kα)
ate a uniform random number φα ∈
evaluate

L, gener-
(0, 1). Then,

∈

Let us introduce a grid which covers the real-space.
We can choose any kind of grids, which may be not uni-
form, but the volume of each cell must be small enough

γα :=

[pα] + 1 if φα < pα −
pα −
[pα]

if φα ≥

(

[pα]
[pα]

6
6
4. If γα = 0, the αth pair (jα, kα) is updated to t+∆tc

6.

validation of our Monte Carlo scheme

without changing their state.
= 0, choose ξjα ≥

5. If γα 6

ξkα without losing general-

˜γαξkα > 0,

ity and evaluate ˜γα := min(γα, [ξjα /ξkα]).
(a) if ξjα −
ξ′
jα = ξjα −
jα = Rjα , R′
R′
jα = Mjα, M ′
M ′

ξ′
kα = ξkα ,
˜γαξkα ,
jα + R3
kα = (˜γαR3

kα )1/3,
jα = (˜γαMjα + Mkα),
kα = xkα,

jα = xjα , x′
x′

≤

γα,

˜γαξkα = 0,

(b) If ξjα −
[ξjα /ξkα ]
ξ′
jα = [ξkα /2],
jα = R′
R′
jα = M ′
M ′
jα = xjα , x′
x′

kα =

(cid:0)

ξ′
kα = ξkα −
jα + R3
˜γαR3
kα

,
kα = (˜γαMjα + Mkα) ,

[ξkα /2],
1/3

(cid:1)
kα = xkα.

i.e., ˜γα = ξjα /ξkα =

jα = 0, the super-droplet jα is removed out

If ξ′
of the system.

Our Monte Carlo scheme numerically solves the
stochastic coalescence process of super-droplets deﬁned
in Sec. IV A 4. We used a sort of random sampling of
candidate-pairs to achieve the computational cost O(ns).
Further extension are implemented in our Monte Carlo
scheme to deal with multiple coalescence. The integer γα
represents how many times the pair (jα, kα) will coalesce,
and ˜γα is the restricted value of γα by its maximum value
[ξjα /ξkα]. Primarily, pα must be smaller than 1 because
pα represents a probability, thus γα should be either 0
or 1. However, if we take ∆tc too much larger, pα may
become larger than 1. Though the situation γα > 1 is
not consistent with the fundamental premise of our the-
ory, we formulate our Monte Carlo scheme to cope with
this situation so that SDM robustly well-approximate the
principle model irrespective of the choice of ∆tc.

Alternatively be said that the most rigorous selection
criteria of the simulation time step for coalescence process
∆tc is that pα ≪
1 holds good for all α. Let us estimate
∆tc very roughly. The typical number density and radius
of small cloud droplets may be 109 m−3 and R = 10 µm.
The typical terminal velocity of a rain droplet may be
1 m s−1. Then, we may roughly evaluate pα as follows.

pα ≃
=

nsP (s)
jαkα
ns max (ξjα , ξkα )
∆V
1

109m−3

π(2

≃
·
= 0.4π∆tc < 1.

·

×

Eπ(Rjα + Rkα)2
10−5m)2

1 m s−1

vjα −
|
∆tc

vkα |

∆tc

·

·

0.8 s. It is
Thus, it is estimated that ∆tc < 1/0.4π s
worth noticing here, that our estimation is independent
of the number of super-droplets ns and the volume of the
coalescence cell ∆V .

≃

7

In this section, we validate our Monte Carlo scheme
for the stochastic coalescence process by conﬁrming that
the numerical results agree well with the solution of the
SCE (13).

The SCE (13) is the time evolution equation of n(X, t)
in the ideal system in which only the stochastic coales-
cence process exists. Correspondingly, the super-droplets
in this section undergo only the coalescence process ac-
cording to our Monte Carlo scheme. The super-droplets
have velocities, but do not move out of the coalescence
cell, nor do they undergo condensation/evaporation. The
radius Ri is the only attribute.

{

To compare the simulation result, we have to recon-
struct the number density distribution n(X, t) from the
data of super-droplets
. There are several ways
(ξi, Ri)
}
to do this, but we adopt kernel density estimate method
with Gaussian kernel (Terrell and Scott 1992). Some
brief discussions on the application of kernel density es-
timate method to SDM is also developed in Sec. IV B.
It is convenient to plot the results by the mass density
function over ln R, which is deﬁned by g(ln R)d ln R :=
ρliqXn(X)dX. The corresponding estimator function
˜g(ln R) becomes,

˜g(ln R) :=

ξimiWσ(ln R

ln Ri),

1
∆V

Ns

i=1
X

1
√2πσ

−
(cid:0)

−

(cid:1)

Wσ(Y ) :=

exp

Y 2/2σ2

.

s

Here, ∆V is the volume of the coalescence cell and
σ = σ0N −1/5
with some constant σ0. Theoretically,
the most eﬃcient choice of σ0 is estimated as σ0 =
g′′2d ln R/MtotNr)−1/5, where Mtot is the to-
(2√π∆V 2
tal mass of liquid water. Because g is the estimated func-
tion itself, we have to estimate also σ0 from the data of
super-droplets to ﬁnd the maximum likelihood estimator
function ˜g, but in this paper we just choose σ0 empiri-
cally.

R

We have to give an explicit form of the coalescence
kernel K(Rj, Rk) in (3) to determine the dynamics. For
Golovin’s kernel K(Rj, Rk) = b(Xj + Xk), we have the
analytic solution of SCE (13) (Golovin 1963) though this
choice of coalescence kernel is not realistic. The result of
our comparison simulation for Golovin’s kernel is shown
103 s−1. We need only
in Fig. 2a. We set b = 1.5
one big coalescence cell, the volume of which is chosen
to be ∆V = 106 m3. The time step is ﬁxed as ∆tc =
1.0 s. The initial number density of real-droplets is set
to be n0 = 223 m−3. The initial size distribution of the
real-droplets follows an exponential distribution of the
droplet volume Xi which is determined by the probability
Xi/X0), X0 = (4π/3)R3
0,
density p(Xi) = (1/X0) exp (
10−6 m. This setting results in the total
R0 = 30.531
amount of liquid water 1.0 g m−3. The initial number of
super-droplet Ns is changed as the simulation parameter.

×

−

×

The initial multiplicity ξi is determined by the equality
ξi = n0∆V /Ns. σ0 is ﬁxed as σ0 = 0.62.

Figures 2b and 2c show the results of the case of so-
called hydrodynamic kernel, which is a much realistic co-
alescence kernel. Hydrodynamic kernel is deﬁned by (3)
and (4). The same coalescence eﬃciency E(Rj , Rk) is
(1996) and
adopted as described in Seeßelberg et al.
Bott (1998). For small droplets the dataset of Davis
(1972) and Jonas (1972) is used, and for large droplets
the dataset of Hall (1980) is used. Because the analytic
solution is not available for hydrodynamic kernel, we gen-
erated the reference solution numerically using Exponen-
tial Flux Method (EFM) developed by Bott (1998, 2000).
A logarithmically equidistant radius grid is used in EFM.
We adopted 1000 bins ranging from 0.62 µm to 6.34 cm.
The time step was set to 0.1 s. These parameter settings
provide a suﬃciently accurate numerical solution of the
SCE (13). In Fig. 2b, simulation settings are same as case
(a) except the coalescence kernel. In Fig. 2c we changed
the initial size distribution by reducing R0 to one-third,
10−6 m, and increased the initial num-
i.e., R0 = 10.177
223 m−3. Con-
ber density of real-droplets as n0 = 33
sequently, the total amount of liquid water 1.0 g m−3 is
unchanged from case (b). ∆tc = 0.1 s and σ0 = 1.5 for
case (c).

×

·

In case (a) and (b), we can see that the result of SDM
with Ns = 213 agrees fairly well with the solution of
SCE (13), and much improved when Ns = 217. How-
ever, case (c) is not so good as the previous two cases.
Even Ns = 217 is not good and we need Ns = 221
for good agreement. This situation typically reveals the
weak point of SDM. The initial size of the droplets are
comparatively small and the coalescence hardly occurs.
We can see that the thick solid line at t = 1200 s is not
so changed from the initial distribution. However, once
a few big droplets are created, then the coalescence pro-
cess is abruptly accelerated. Accordingly, for an accurate
prediction, we have to resolve the right tail of the distri-
bution at the time t = 1200 s. However, existence prob-
ability of super-droplets is very low for such region and
sampling error occurs if the number of super-droplets Ns
is not suﬃcient. As a result, we need much more super-
droplets for case (c) compared to that of (a) and (b). For
the practical applications to cloud formation, this fact
would not impose severe restrictions on SDM because the
condensation/evaporation process dominates the growth
of small droplets in such cases like (c).

Anyway, we have conﬁrmed that SDM reproduces the
solution of the SCE (13) if the number of super-droplets
Ns is suﬃciently large. These results support the validity
of our Monte Carlo scheme for the stochastic coalescence.

B.

cloud dynamics for Super-Droplet Method

For the cloud dynamics of SDM, we can also apply the
non-hydrostatic model (5)-(9). Note here that we have
to evaluate the source terms from microphysics (10)-(11)

8

FIG. 2: Time evolution of the mass density distribution
g(ln R, t), which is numerically obtained by the Monte Carlo
scheme of SDM. (a): The case of Golovin’s kernel. The solid
line represents the analytic solution of SCE (13). (b) and (c):
The case of hydrodynamic kernel. The solid line represents
the approximate solution of SCE (13), which is numerically
obtained by EFM. In each case, we can see that the result of
SDM agrees fairly well with solution of SCE (13) when the
number of super-droplets Ns is suﬃciently large. ∆tc = 1.0 s
for (a) and (b), and ∆tc = 0.1 s for (c).

not by real-droplets but by super-droplets:

bubble is inserted at the center of the horizontal axis
according to the equation below.

9

Ns

i=1
X

ρw(x, t) =

ξimi(t)δ3(x

xi(t)),

−

Sv(x, t) = −

1
ρ(x, t)

∂ρw
∂t

(x, t).

(24)

(25)

For the numerical simulation of (5)-(9), we may adapt
4th-order Runge-Kutta scheme for the time derivative,
second-order central diﬀerence scheme for the spatial
derivatives, with artiﬁcial viscosity to stabilize the nu-
merical instability. The source terms (24) and (25) must
be evaluated on the numerical grid point of ﬂuid simula-
tion x∗
j . Generally, introducing an appropriately chosen
coarsening function w(x), it can be evaluated as

ρw(x∗

j , t) =

w(x∗

j −

x)ρw(x, t)d3x

Z
Ns

i=1
X

=

ξimi(t)w(x∗

xi(t)).

j −

w(x)d3x = 1, and would be a piecewise
Here w satisﬁes
linear, localized function with length-scale comparable to
If a super-droplet is simply shared by
the grid width.
the 8 adjacent grid points at the corner of the cell, then
w(x) = 1/8∆V inside the cube with volume 8∆V , and
w(x) = 0 outside the cube.

R

SDM has been deﬁned completely and the numerical
simulation schemes have been also proposed. This is the
main result of the present paper. In the next section, we
show a preliminary result of SDM.

V. DEMONSTRATION

A very preliminary result of a shallow maritime cumu-
lus formation initiated by a warm bubble is presented in
this section to demonstrate the practicality of SDM.

The simulation domain is 2-dimensional (x-z), 12.8 km
in horizontal direction and 5.12 km in vertical direction.
Initially, a humid but not saturated atmosphere is strat-
iﬁed, which is almost absolutely unstable under 2 km in
altitude. There is a temperature inversion layer above
2 km. The equations below determines the initial base
sounding of the atmosphere.

U (x, t = 0) = 0,
T (x, z = 0, t = 0) = 305.0 K,
P (x, z = 0, t = 0) = 101325 Pa,

∂T
∂z

=

(

9.5 K km−1
−
+3.0 K km−1

qv(x, t = 0) = 0.022 exp

if z < 2.0 km,
2.0 km,
if z

≥

(z + 200.0 m)
2000.0 m

2

.

#

(cid:27)

"−

(cid:26)

The upper and lower boundary is ﬁxed to their initial
value and the horizontal boundary is periodic. A warm

θ(x, t = 0) = θb(x, t = 0) + 1.0 K

exp

×

"−

(cid:26)

(z

500.0 m)

−
400.0 m

2

(x

6.4 km)

−
1200.0 m

2

,
#

(cid:27)

−

(cid:26)

(cid:27)

where θb(x, t = 0) is the base state of potential temper-
ature.

We simulate the cloud dynamics according to the non-
hydrostatic model introduced in Sec. II B with the nu-
merical schemes proposed in Sec. IV B. The grid width
is ∆x = 3.125 m and ∆z = 4.0 m with time step
∆t = 0.0125 s. We set the artiﬁcial viscosity ν = κ =
1.56 m2 s−1.

Initially, NaCl CCNs are uniformly distributed in space
107 m−3. The solute mass
with number density 1.0
Mi(t = 0) has an exponential distribution given by the
probability density

×

(cid:18)

−

exp

1
M0

p(Mi) =

10−16 g.

, M0 = 1.0

Mi
M0 (cid:19)
Because it is unsaturated at the beginning, the growth
equation (2) has a stable and steady solution, which is
adopted as the initial value of the radius Ri(t = 0). The
coalescence eﬃciency used in Sec. IV A 6 is also adopted
to this simulation.

×

For the numerical simulation of the microphysics pro-
cesses, we also use the numerical scheme proposed in
Sec. IV. Initially, the super-droplets are uniformly dis-
tributed in space with number density 1.92 m−3 with
common multiplicity,
×
107/1.92) = 5208333. The grid for our Monte Carlo
scheme of stochastic coalescence is same to that of non-
hydrostatic model. The time steps are ∆tm = ∆tg =
1.0 s and ∆tc = 10.0 s.

i.e., ξi(t = 0) = INT(1.0

Cloud started to form at about 8 min and began to
rain at about 20 min. After raining for half an hour,
the cloud remained for a while but ﬁnally disappeared
at about 90 min. The amount of precipitation is about
1 mm in total. Figure 3 is a snapshot at the time 1608 s.
We plot all the super-droplets with the color and the
alpha transparency which are determined by their radius
Ri and multiplicity ξi. The color map is indicated in
the ﬁgure and the alpha value is determined by αi =
i ξi
7.8
We can see that there is a turbulent like structures inside
the cloud. Note that there are super-droplets also in the
black region, but it is not depicted in this ﬁgure because
the radius is very small, which represent CCNs.

10−5(Ri/10−3 m)2 ξi, which is proportional to R2

×

In this section, we showed a very preliminary result of a
shallow maritime cumulus formation initiated by a warm
bubble, and demonstrated that SDM actually works as
a cloud resolving model. Application to more realistic
situations are our future works.

VI. DISCUSSIONS

A.

extension of Super-Droplet Method

In Sec. IV, SDM was developed only for warm rain
with only one soluble substance as the CCN. However, it
is very conceivable that we can extend SDM to incorpo-
rate various properties of clouds, such as, several types
of ice crystals, several sorts of soluble/insoluble CCNs,
their chemical reactions, electriﬁcation, and the breakup
of droplets. Here, we give a rough overview of how to
achieve these extensions.

For this purpose, let us extend the type of attributes
a. To treat several kinds of soluble/insoluble chemicals
for the CCNs, new attributes are necessary to represent
the mass of each chemicals. To treat several types of
ice crystals, one attribute may represent the state of the
super-droplets. Additional attributes may represent the
electric charge and the temperature of the droplet.
If
we do not give a terminal velocity, then the velocity of a
droplet is also an independent attribute.

Let us denote the attributes of our new super-droplet
as a(t) = (a(1), a(2), . . . , a(d)), where d is the number of
independent attributes. Then, we have to give a time
evolution law for each attributes, which determines the
individual dynamics of super-droplets:

dai
dt

= f (ai, A(xi)),

i = 1, 2, . . . , Ns(t),

(26)

where A(xi) represents the ﬁeld variable which charac-
terize the state of ambient atmosphere. Equation (26)
may include the growth equation (2) and the time evo-
lution of solute mass dMi/dt = 0. For example, the
chemical reactions and the electriﬁcation process may be
also incorporated in (26).

The coalescence process must be speciﬁed for our new
super-droplets. At ﬁrst, we have to determine what kind
of real-droplet a′ will be created after the coalescence of
real-droplets aj and ak. This can be either determinis-
tic or stochastic. Then, the coalescence of super-droplets
will be determined similarly to (14)-(21). It is not the
case in (17) and (21), but we may also change the position
of super-droplets after the coalescence if necessary. Sim-
ilar to (3), the coalescence probability for real-droplets
must be given in the form

Pjk =C(aj, ak)

vj −
=probability that real-droplet j and k

vk|

∆tc
∆V |

inside the small region ∆V will coalesce
in the short time interval (t, t + ∆tc),

which in general is a function of the attributes aj and
ak. Then the coalescence probability for super-droplets
will be determined by (22).

The coalescence process is a short time and short range
interaction between the droplets, but we may also con-
sider other types of interactions if any.

10

Breakup of droplets can be also taken into account.
This can be done if a governing law is given for the
breakup process. However, note here that breakup re-
sults in the increase of super-droplets, and this is not
preferable because the more the super-droplet is the more
the computational cost will be. Breakup process may
result in the explosion of the number of super-droplets
Ns(t)
. In other words, SDM is formulated suitable
for the simulation of such phenomena in which the coa-
lescence process is predominant and the breakup process
has a secondary importance. This is exactly the case for
cloud formation process.

→ ∞

SDM can be regarded as a sort of Direct Simula-
tion Monte Carlo (DSMC) method, which was initially
proposed to simulate the Boltzmann equation for pre-
dicting rareﬁed gas ﬂows (Bird 1994). Particularly,
SDM has similarity to the Extended version of the No-
Time-Counter (ENTC) method, which was developed
by Schmidt and Rutland (2000) for the simulation of
spray ﬂows. Though the basic idea of using a compu-
tational particle with varying multiplicity is common in
both SDM and ENTC, there is a diﬀerence in the proce-
dure of the Monte Carlo scheme. SDM is using randomly
generated, non-overlapping, [ns/2] number of candidate
pairs, and allows multiple coalescence for each pair. On
the other hand, ENTC method chooses the candidate
pairs randomly from the set of all the possible pairs. The
number of candidate-pairs to be sampled varies propor-
tionally to the maximum coalescence probability in the
cell. Both SDM and ENTC method result in the com-
putational cost O(Ns). Probably, ENTC method is also
applicable to cloud simulations and SDM is applicable to
spray simulations, but further veriﬁcations are still nec-
essary to compare their capability.

B.

computational cost and accuracy

Our estimation suggest that the computational cost of
SDM becomes much lower than spectral (bin) method
when the number of attributes d becomes large. We
would like to show the basis of this assertion very brieﬂy.
Let us estimate the computational cost and accuracy
of spectral (bin) method. We have extended SDM in the
previous section, and the corresponding, general form of
SCE can be derived as follows.

∂n(a, x, t)
∂t

+

∇x · {

vn

+

}

∇a · {

f n

=

}

∂n
∂t

(cid:18)

(cid:19)c

,

(27)

where n(a, x, t) is the number density distribution and f
is deﬁned in (26). The term (∂n/∂t)c corresponds to the
stochastic coalescence process and this will be d-multiple
integral in general because we have to survey all over the
d-dimensional attribute-space to evaluate the variation
of droplet number density at a. Obviously, this term is
the most expensive for computation, so we neglect the
advection terms in the l.h.s of (27) and focus our atten-
tion on the simpliﬁed equation ∂n/∂t = (∂n/∂t)c, which

11

corresponds to the ideal case that only the stochastic co-
alescence exists as the microphysics process.

We choose Integrated Squared Error (ISE),

After some calculation, this result in

−1
(d+4)
s

N

, C(σ)

−4
(d+4)
s

.

N

∼

σ

∼

C =

dda

n(a)

{

Z

nb(a)
}

−

2 ,

(28)

Thus, the operation count and memory needed for SDM
scales like

to evaluate the accuracy of spectral (bin) method. Here,
nb(a) is the approximate solution generated by spectral
(bin) method, and C evaluate the diﬀerence of nb(a) from
the exact solution n(a). Let Nb be the number of bins
for each attribute, i.e., the number of grid points for the
discretization of n(a) per attribute. Then, if the accuracy
of spectral bin method is kth order in attribute-space,
C scales like C
. Thus, we can estimate the
amount of operation count and memory needed for the
computation of spectral (bin) method as the following,

N −2k
b

∼

operation

Ns ∼  

∼

memory

Ns ∼  

∼

(d+4)/2

,

.

1
C(σ) !

1
C(σ) !

p

p

(d+4)/2

(32)

We can compare the computational eﬃciency of SDM
and spectral (bin) method by comparing the exponents
in (29) and (32). The result suggest that the operation
count of SDM becomes lower than spectral (bin) method
when the condition

operation

N 2d

b ∼

∼

memory

N d

b ∼

∼

2d/k

,

(cid:18)

1
√C (cid:19)
1
√C (cid:19)

(cid:18)

d/k

.

(29)

d >

and k < 4,

is satisﬁed, and the memory of SDM becomes lower than
spectral (bin) method when

Let us estimate the computational cost and accuracy of
SDM. To compare the result with spectral (bin) method,
we only consider the stochastic coalescence process, and
let us estimate the number density distribution n(a) from
using the
the super-droplets
kernel density estimation method, which was originally
developed to estimate the generating probability distri-
bution from its random sample (Terrell and Scott 1992).
The density estimator function ˜n(a) with Gaussian ker-
nel W (d)

(ξi, ai); i = 1, 2, . . . , Ns}

σ (a) is deﬁned by

{

4k

4

k

−

4k

2

k

−

d >

and k < 2.

Thus, if we assume that the attribute-spatial accuracy
2, SDM becomes more
of spectral (bin) method k = 1
4, and becomes
eﬃcient in operation count when d > 2
eﬃcient in memory when d > 4
. This result may be
improved if we choose a diﬀerent kernel function W (a)
for the density estimator ˜n(a).

∼ ∞

∼

∼

Though our discussions in this section are very brief
and the assertions must be still veriﬁed, our estimation
suggests that the computational cost of SDM becomes
lower than spectral (bin) method when the number of at-
tributes d becomes larger than some critical value, which
may be 2

4.

Ns

˜n(a) :=

ξiW (d)

σ (a

ai),

−

i=1
X

1
(√2πσ)d

−

(cid:8)

(cid:9)

(30)

W (d)

σ (a) :=

exp

a2/2σ2

.

∼

The error function corresponding to ISE (28) is the Mean
Integrated Squared Error (MISE) deﬁned by

VII. SUMMARY AND CONCLUDING
REMARKS

C(σ) = E

dda

n(a)

{

˜n(a)
}

−

2

.

(cid:21)

(cid:20)Z

(31)

(ξi, ai)
Remember that each
is a random realization
}
and C(σ) is deﬁned as an ensemble averaged value. Sev-
eral calculations and assumptions are necessary to derive
the results, but we can estimate the expectation value
and variance of ˜n(a) as

{

E[˜n(a)]

n(a)

−

V [˜n(a)]

∂2n(a)
∂a2

j 


,

σ2
2 
j

X
Nrn(a)

Ns(2√πσ)d .

≃

≃



In this paper, we introduced a simple SDM for warm
rain and discussed the theoretical foundations and char-
acteristics of SDM.

The principle model was introduced at the beginning,
which is a very primitive microphysics-macrodynmics
coupled cloud model. We saw how the traditional meth-
ods can be derived from the principle model and what
are the problems involved in these methods. Then, we
developed a simple SDM for warm rain, which can be re-
garded as a coarse-grained model of the principle model.
Several numerical simulation schemes for SDM were also
proposed. Especially, a novel Monte Carlo scheme for
the stochastic coalescence process was developed and val-
idated by comparing the numerical results with the solu-
tions of SCE. We demonstrated the practicality of SDM

by presenting a very preliminary result of a shallow mar-
itime cumulus formation initiated by a warm bubble.
Brief discussions were carried out on the possibility to
extend SDM to incorporate various properties of clouds,
such as, several types of ice crystals, several sorts of sol-
uble/insoluble CCNs, their chemical reactions, electriﬁ-
cation, and the breakup of droplets. The assertions must
be still veriﬁed, but our theoretical estimation suggested
that SDM becomes computationally more eﬃcient than
spectral (bin) method when the number of attributes d
becomes larger than some critical value, which may be
2

∼
Though several extensions and validations are still nec-
essary, we expect that SDM would be more feasible for
the modeling of complicated cloud microphysics, and pro-
vide us a new approach to the cloud-related open prob-
lems, such as the cloud and aerosol interactions, the
cloud-related radiative processes, and the mechanism of
thunderstorms and lightning.

4.

Acknowledgments

The authors are grateful to A. Bott for oﬀering his For-
tran program, F. Araki for fruitful discussions, and T.
Sato for his continued support. S.S. would like to thank
T. Miyoshi, S. Hirose, H. Nakao, and R. Onishi for valu-
able comments and encouragement. This work is one of
the results of the Earth Simulator project “Development
of Multi-scale Coupled Simulation Algorithm.”

12

APPENDIX: HOW TO MAKE A RANDOM
PERMUTATION

1 , a(n)

Let a(n) = (a(n)

2 , . . . , a(n)
n ) be a permutation of
a(n)
In := (1, 2, . . . , n). Let Sn :=
be the set of all the
permutation of In. Thus, Sn has n! number of elements.
Let us deﬁne the random permutation of In by such a
permutation a(n) that all the a(n)
Sn occurs with the
∈
same probability, i.e., P (a(n)) = 1/n!,

}

{

Sn.

We have two propositions. 1) a(1) = (1) is a ran-
dom permutation of I1. 2) We can make a random per-
mutation of In+1 from a random permutation of In by
the following procedure: Let a(n) be a random permuta-
tion of In and choose m from 1, 2, . . . , n + 1 randomly.
Let a(n+1) = (a(n), n + 1) = (a(n)
If
= n + 1, exchange the value at m and n + 1, i.e.,
m
m , a(n+1)
n+1 = a(n)
a(n+1)
= n + 1. Then, a(n+1) is a random
m
permutation of In+1.

1 , . . . , a(n)

n , n + 1).

a(n)
∀

∈

Proposition 1) is obvious and 2) is also easy to
Sn+1, we can uniquely de-
Sn which have the possibility to
Indeed, such a(n) is given by a(n) =

∈

prove. For all a(n+1)
termine a(n)
∈
become a(n+1).
(a(n+1)
, . . . , a(n+1)
, a(n+1)
2
1
here m satisﬁes a(n+1)
= a(n+1)
a(n)
i
i
probability
that
P (a(n+1)) = P (a(n))

m

,

×

In with O(n) operations.

m−1 , a(n+1)

n+1 , a(n+1)

m+1 , . . . , a(n+1)

),

= n + 1.
i = 1, . . . , n.
is

occurs

a(n+1)

n
If m = n + 1,
the
Then,
evaluated by

1/(n + 1) = 1/(n + 1)!.

Consequently, we can make a random permutation of

[1] Beard, K. V., 1976: Terminal velocity and shape of cloud
and precipitation drops aloft. J. Atoms. Sci., 33, 851–
864.

[2] Berry, E. X., 1967: Cloud droplet growth by collection.

J. Atmos. Sci., 24, 688–701.

[3] Bird, G. A., 1994: Molecular gas dynamics and the direct
simulation of gas ﬂows. Clarendon Press, Oxford, 458 pp.
[4] Bott, A., 1998: A ﬂux method for the numerical solution
of the stochastic collection equation. J. Atmos. Sci., 55,
2284–2293.

[5] — 2000: A ﬂux method for the numerical solution of
the stochastic collection equation: Extension to two-
dimensional particle distributions. J. Atmos. Sci., 57,
284–294.

[6] Davis, M. H., 1972: J. Atoms. Sci., 29, 911–915.
[7] Ferrier, B. S., 1994: A double-moment multiple-phase
four-class. bulk ice scheme. part I: Description. J. Atmos.
Sci., 51, 249–280.

[8] Gillespie, D. T., 1972: The stochastic coalescence model
for cloud droplet growth. J. Atmos. Sci., 29, 1496–1510.
[9] — 1975: An exact method for numerically simulating the
stochastic coalescence proces in a cloud. J. Atoms. Sci.,
32, 1977–1989.

[10] Golovin, A. M., 1963: The solution of the coagulation
equation for cloud droplets in a rising air current. Bull.
Acad. Sci., USSR, Geophys. Ser.X , 5, 783–791.

[11] Hall, W. D., 1980: A detailed microphysical model within
a two-dimensional dynamic framework - model descrip-
tion and preliminary-results. J. Atoms. Sci., 37, 2486–
2507.

[12] Jacobson, M. Z., 2005: Fundamentals of Atmospheric
Modeling. Cambridge Univ Press, New York, 2nd edi-
tion, 813 pp.

[13] Jonas, P. R., 1972: Collision eﬃciency of small drops.

Quart. J. Roy. Meteor. Soc., 98, 681–683.

[14] Kessler, E., 1969: On the distribution and continuity
of water substance in atmospheric circulations. Meteor.
Monogr , 10, 1–84.

[15] K¨ohler, H., 1936: The nucleus in and the growth of hy-
groscopic droplets. Trans. Faraday Soc., 32, 1152–1161.
[16] Meyers, M. P., R. L. Walko, J. Y. Harrington, and W. R.
Cotton, 1997: New RAMS cloud microphysics param-
eterization. part II: The two-moment scheme. Atmos.
Res., 45, 3–39.

[17] Murakami, M., 1990: Numerical modeling of dynami-
cal and microphysical evolution of an isolated convective
cloud. J. Meteor. Soc. Japan, 68, 107–128.

[18] Rogers, R. R. and M. K. Yan, 1989: A Short Course in
Cloud Physics. Pergamon Press, Oxford, third edition,
293 pp.

[19] Schmidt, D. P. and C. J. Rutland, 2000: A new droplet
collision algorithm. J. Comput. Phys., 164, 62–80.

6
[20] Seeßelberg, M., T. Trautmann, and M. Thorn, 1996:
Stochastic simulations as a benchmark for mathematical
methods solving the coalescence equation. Atmos. Res.,
40, 33–48.

[21] Soong, S.-T., 1974: Numerical simulation of warm rain
development in an axisymmetric cloud model. J. Atmos.
Sci., 31, 1262–1285.

[22] Terrell, G. R. and D. W. Scott, 1992: Variable kernel

density estimation. Ann. Statist., 20, 1236–1265.

[23] Ziegler, C. L., 1985: Retrieval of thermal and microphysi-
cal variables in observed convective storms. part i: Model
development and preliminary testing. J. Atmos. Sci., 42,
1487–1509.

13

FIG. 3: Shallow maritime cumulus formation initiated by a warm bubble simulated by SDM. This is a snapshot at the time
1608 s. All the super-droplets are plotted with the color and the alpha transparency which are determined by their radius Ri and
−3 m)2 ξi,
multiplicity ξi. The color map is indicated in the ﬁgure and the alpha value is determined by αi = 7.8 × 10
which is proportional to R2

i ξi. We can see that there is a turbulent like structures inside the cloud.

−5(Ri/10

