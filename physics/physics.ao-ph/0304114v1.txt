Stability of Semi-Impliit and Iterative Centred-Impliit Time Disretisations

for Various Equation Systems Used in NWP

(Aepted in Monthly Weather Review)

P. Bénard

∗

∗

Centre National de Reherhes Météorologiques, Météo-Frane, Toulouse, Frane

3
0
0
2
 
r
p
A
 
0
3
 
 
]
h
p
-
o
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
1
1
4
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

27 Marh 2003

Corresponding address:

Pierre Bénard

CNRM/GMAP

42, Avenue G. Coriolis

F-31057 TOULOUSE CEDEX

FRANCE

Telephone: +33 (0)5 61 07 84 63

Fax: +33 (0)5 61 07 84 53

e-mail: pierre.benardmeteo.fr

1

ABSTRACT

The stability of lassial semi-impliit sheme, and some more advaned iterative

shemes reently proposed for NWP purpose is examined.

In all these shemes, the

solution of the entred-impliit non-linear equation is approahed by an iterative (cid:28)xed-

point algorithm, preonditioned by a simple, onstant in time, linear operator. A general

methodology for assessing analytially the stability of these shemes on anonial prob-

lems for a vertially unbounded atmosphere is presented. The proposed method is valid

for all the equation systems usually employed in NWP. However, as in earlier studies, the

method an be applied only in simpli(cid:28)ed meteorologial ontexts, thus overestimating the

atual stability that would our in more realisti meteorologial ontexts. The analy-

sis is performed in the spatially-ontinuous framework, hene allowing to eliminate the

spatial-disretisation or the boundary onditions as possible auses of the fundamental in-

stabilities linked to the time-sheme itself. The general method is then shown onretely

to apply to various time-disretisation shemes and equation-systems (namely shallow-

water, and fully ompressible Euler equations). Analytial results found in the literature

are reovered from the proposed method, and some original results are presented.

2

1

Introdution

The lassial semi-impliit (SI) tehnique (Robert et al., 1972) has been widely used

in NWP sine it provides e(cid:30)ient and simple algorithms, at least for spetral models.

This lassial SI method requires the de(cid:28)nition of a onstant in time linear "referene"

operator L∗

, whih usually onsists in the linearisation of the original system M, around a

stationary referene-state, noted X ∗

. For a given state X of the atmosphere, the evolution

of the system, (∂X /∂t) = M.X , is then time-disretised through:

δX
δt

t
= (M − L∗).X + L∗.[X ]

(1)

t
where (δ/δt) is the disretised time-derivative operator, and [ ]

is the impliit-entred

temporal average operator. The terms linked to the referene operator L∗

are thus treated

in a entred-impliit way, whilst the residual non-linear terms are treated expliitly. For

this sheme, there is no formal proof of the stability in real atmospheri onditions, due

to the expliit treatment of non-linear residuals. This prompted the authors of pioneering

NWP appliations of the SI sheme to examine theoretially its stability in idealised

ontexts.

In a seminal study following this approah, Simmons et al., 1978 (SHB78 hereafter)

analysed the stability of the SI sheme for the hydrostati primitive equations (HPE)

system with a Leap-Frog (3-TL hereafter) time-disretisation by onsidering the linearised

equations around a stationary state X (referred to as "atmospheri state" hereafter) when

the resulting linear "atmospheri" operator L deviates from the linear "referene" operator

L∗

of the SI sheme, thus generating potentially unstable expliitly-treated residuals.

In the vertially-ontinuous ontext they performed a stability analysis valid when the

eigenfuntions of L and L∗

are idential. They showed that when the atmospheri and

referene temperature pro(cid:28)les (respetively T and T ∗

) are isothermal, the stability of the

SI sheme requires:

3

0 ≤ T ≤ 2T ∗,

(2)

hene T ∗

annot be hosen arbitrarily for applying the 3-TL SI sheme to the HPE system.

In the (cid:28)nite-di(cid:27)erene vertially-disretised ontext, thew showed that a "vertially-

disretised analysis" of stability following the same priniple simply resulted in the solution

of a standard eigenvalue problem. They found empirially that a large stati-stability for

the referene-state is neessary to maintain the stability of the sheme for realisti thermal

atmospheri pro(cid:28)les. As a onsequene, they reommended to use a warm isothermal state

as referene-state, a rule whih was then widely adopted for NWP appliations using SI

shemes.

Finally, they examined the e(cid:27)et of applying a seond-order time-(cid:28)lter in the temporal

average of linear terms, and found that an improved stability is obtained, but at the

expense of an inreased misrepresentation of the wave propagation.

Cté et al., 1983 (CBS83 hereafter), still in the HPE ontext, examined the stability of

the 3-TL SI sheme for a (cid:28)nite-element vertial disretisation using the above vertially-

disretised analysis method. They established a stability riterion for the 3-TL SI sheme

in terms of the atmospheri and referene stati stabilities (γ and γ∗

respetively):

therefore generalizing (2) to not neessarily isothermal thermal pro(cid:28)les.

Still in the HPE ontext, Simmons and Temperton, 1997 showed with the same method

that extrapolating two-time level (2-TL) shemes have more stringent stability onstraints

than their 3-TL ounterpart. For instane, in the isothermal framework of the SHB78

analysis, the stability of the 2-TL SI sheme requires:

(3)

(4)

0 ≤ γ ≤ 2γ∗,

0 ≤ T ≤ T ∗.

4

As a onsequene, they reommended to use a warmer referene temperature than in

the 3-TL ase. ST97 also showed that the 2-TL SI sheme was intrinsially damping

when stable, a harateristi whih was not present in the 3-TL SI sheme. However,

3-TL shemes require a time-(cid:28)lter to damp the unstable omputational modes, and this

time-(cid:28)lter also damps the transient physial modes. They argue that all these aspets

being onsidered, the e(cid:27)etive damping of 2-TL and 3-TL shemes is of omparable overall

intensity. This partiular debate will be ignored in this paper, in order to fous on stability

aspets only.

The relevane of the SI method for solving numerially the fully ompressible Euler

Equations (EE) was then advoated (Tanguay et al., 1990), and some numerial models in

EE using this tehnique were e(cid:27)etively developed: Caya and Laprise (1999), presented a

model in EE with a 3-TL SI sheme (with a moderate time-deentering (cid:28)rst-order aurate

in time). Semazzi et al. (1995) and Qian et al. (1998) also showed a model in EE but

with a 2-TL SI sheme (with a strong time-(cid:28)lter however). Besides, the need of more

robust shemes than the lassial SI one for solving the EE system beame reognized

(e.g. Cté et al. 1998, BHBG95), probably motivated by some pathologial behaviours

with the lassial SI sheme under some irumstanes.

Shemes with evolution terms treated in a more entred-impliit way are usually be-

lieved to have an inreased robustness, hene ful(cid:28)lling the latter emerging need, and some

of them were developed for (cid:28)ne-sale models in the EE system. Bubnová et al., 1995

used a 3-TL sheme in whih the leading non-linear terms of the EE system are treated

in a entred-impliit way, through a partially iterative method. For a 2-TL sheme, Cté

et al, 1998, used a fully iterative method, aiming to treat all the evolution terms of the

EE system in a entred-impliit way. Cullen (2000) examined the bene(cid:28)t of using suh

a fully iterative sheme for the HPE system, arguing that an improved auray ould

5

be obtained beside the improved stability (this latter being not stritly required however

for urrent HPE appliations). As a formal justi(cid:28)ation, he examined the stability of

this iterative sheme for the 2-TL shallow-water (SW) system. The analysis was limited

to a sheme alled "preditor/orretor", whih onsists in a single additional iteration

after the SI sheme. The salient result was that the additional iteration in the "predi-

tor/orretor" sheme allows to reover a extended range of stability as in (2) instead of

(4). In the following, these fully iterative shemes with a more entred-impliit treatment

of the evolution terms will be referred to as "iterative entred-impliit" (ICI) shemes.

From the theoretial point of view, the urrent situation is that no stability analysis

has been provided for the EE system with SI sheme, and for ICI shemes with more

iterations, stability analyses are available only for the SW system.

Here we present a general method to arry out spae-ontinuous stability analyses

of the various time-disretisation shemes mentioned above, for any usual meteorologial

system of NWP interest (SW, HPE, EE), on anonial problems similar to those examined

in SHB78. Some original results onerning the EE system and iterative shemes are

presented.

This work may also be viewed as a (cid:28)rst theoretial investigation about the suitability

of various time-disretisation shemes for solving numerially the EE system.

2 General framework for analyses

The general framework for the stability analyses presented here is basially the same as

in most earlier studies: The (cid:29)ow is assumed adiabati invisid and fritionless in a non-

rotating dry perfet-gas atmosphere with a Cartesian oordinate system. Moreover, the

(cid:29)ow is assumed linear around an "atmospheri" basi-state X . The atual evolution of

the atmospheri (cid:29)ow is thus desribed by L, the linear-tangent operator to M around X .

6

The atmospheri basi-state X is hosen stationary, resting, horizontally homogeneous,

and hydrostatially balaned. The governing equation for the (cid:29)ow is then:

∂X ′
∂t

= L.X ′

(5)

where X ′ = X − X , and the primes are dropped heneforth for larity.

Following the usual pratie in NWP, the linear operator L∗

in (1) is taken as the

tangent-linear operator to M around a referene-state X ∗

whih is also hosen stationary,

resting, horizontally homogeneous, and hydrostatially balaned. Sine X is a resting

state, the linear Lagrangian time-derivative oinides with the Eulerian time-derivative,

and the LHS operator of (5) hene holds for Eulerian models as well as for semi-Lagrangian

models .

3 The lass of ICI shemes in the linear framework

In the restrited resting and linear framework of setion 2, lassial SI shemes as well

as the iterative shemes mentioned in the introdution an be gathered in a single lass

of ICI shemes, di(cid:27)ering only by their number of iterations. These ICI sheme are (cid:28)rst

presented for a 2-TL disretisation. In this ase, the fully impliit-entred (FIC) sheme

writes:

X + − X 0
∆t

=

L.X + + L.X 0
2

where, aording to a standard pratie for time-disretised equations, the supersripts

"+" and "0" stand for time levels (t + ∆t) and t respetively. The priniple of ICI

shemes is to approah the FIC solution by starting from an initial "guess" noted X +(0)

,

then iterating the following algorithm:

X +(n) − X 0
∆t

=

≡

L.X +(n−1) + L.X 0
+
2
.X +(n−1) +

L − L∗

L∗.X +(n) − L∗.X +(n−1)
2
.X 0

L − L∗
(cid:0)

(cid:1)

+

L∗.X +(n) + L∗.X 0
2

(cid:0)

(cid:1)

2

7

(6)

(7)

(8)

for n = 1, 2, ..., Niter . The X +

state, valid a (t + ∆t) is then taken as the last iterated state

X +(Niter)

. An examination of this sheme for a model with a single prognosti variable

without spatial dependeny shows that it ats as a (cid:28)xed-point algorithm for solving the

impliit non-linear salar equation f (x) = x, by using an estimate f ′∗

of the derivative f ′

as a preonditioner for onvergene. The method onverges if |(f ′ − f ′∗

)/f ′∗

| < 1. This

is a weaker ondition than the one for the lassial (i.e. not preonditioned) (cid:28)xed-point

method: |f ′| < 1. The initial guess X +(0)

is arbitrary in ICI shemes, but hoosing an

appropriate initial guess may help dereasing the magnitude of the disrepany between

FIC and ICI shemes after a (cid:28)xed number of iterations.

For 3-TL shemes, the ICI sheme an be de(cid:28)ned by:

X +(n) − X −
2∆t

L.X +(n−1) + L.X −
+
2
.X +(n−1) +

L∗.X +(n) − L∗.X +(n−1)
2
.X −

L − L∗

=

≡

L − L∗
(cid:0)

(cid:1)

2

(cid:0)

(cid:1)

+

L∗.X +(n) + L∗.X −
2

(9)

(10)

where the supersript "-" denotes a variable taken at the time-level (t − ∆t).

Here follows a list of some shemes proposed in the literature, with the orresponding

harateristis (X +(0)

,Niter ), in the restrited framework of setion 2:

- Classial 2-TL SI extrapolating sheme: Niter = 1 and X +(0) = (2X 0 − X −).

- 2-TL non-extrapolating SI sheme: Niter = 1 and X +(0) = X 0

. However, this sheme

is not used in pratie sine it is only (cid:28)rst-order aurate in time, as mentioned in

Cullen (2000).

- "Preditor/orretor" sheme of Cullen (2000): Niter = 2 and X +(0) = X 0

.

- Iterative sheme of Cté et al., 1998: general iterative ICI sheme, but used with

Niter = 2 in pratie. The hoie of X +(0)

is not expliitly indiated.

8

- FIC sheme: Niter = ∞ (does not depend on the hoie of X +(0)

). This sheme an

not be ahieved in pratie for numerial models, but it may be useful for theoretial

examination of the asymptoti behaviour of the ICI shemes.

For 3-TL disretisations, the SI sheme, whih orresponds to an ICI sheme with Niter = 1

and X +(0) = (2X 0 − X −) is the only one to be used in pratie. However, iterated 3-TL

ICI shemes ould be used as well, and the 3-TL FIC sheme is equivalent to a 2-TL FIC

sheme with a time-step twie as long.

In the general framework, when M is not linear, these various shemes annot be

gathered in the unique formalism (7) or (9).

Addition of a seond-order time-(cid:28)lter in the above de(cid:28)nitions for 2-TL shemes is

straightforward. Two main variants are usually onsidered, depending on whether the

(cid:28)ltering is applied only to the time-averages of linear terms (as in SHB78), or also to

the time-averages of non-linear terms, in (8). For instane, in a 2-TL SI sheme, the (cid:28)rst

variant of the (cid:28)lter onsists in replaing L∗(X +(n) + X 0) by L∗[(1 + κ)X +(n) + (1 −2κ)X 0 +

κX −] in (8), where κ is a (small) positive parameter, and for the seond variant, the same

modi(cid:28)ation is also applied to the (cid:28)rst RHS term of (8). The sheme then beomes

essentially a 3-TL sheme sine information at level X −

is always used. However, the

use of large values of κ (e.g. κ = 0.5, whih eliminates the X 0

ontribution) is known

to deteriorate the solution through a spurious damping of transient perturbations (e.g.

Hereil and Laprise, 1996).

For 3-TL shemes, seond-order time-(cid:28)lters are une(cid:27)etive, and a (cid:28)rst-order aurate

time-deentering must be used. This onsists in replaing L∗(X +(n) + X −) by L∗[(1 +

ǫ)X +(n) + (1 − ǫ)X −] in (10), where ǫ is a (small) positive parameter. The sheme then

eases to be seond-order aurate in time sine the time-average is no longer entred in

time. This results in a spurious damping of transient perturbations even for moderate

9

values of ǫ (due to the weaker time-seletivity of the (cid:28)lter ǫ ompared to κ).

4 Conditions for spae-ontinuous analyses

4.1 Conditions on the upper and lower boundaries

Spae-ontinuous analyses are muh easier to arry out when the equation system is

de(cid:28)ned in the whole unbounded atmosphere, beause the expression of the normal modes

of the system is more general. The following spae-ontinuous analyses will restrit to this

ase (although this is not stritly required). For systems in whih the vertial diretion is

represented (e.g. HPE and EE systems), this means that the upper and lower boundary

onditions must not appear expliitly in the set of governing equations. However for

systems ast in mass-based oordinates [suh as HPE system in pressure-based oordinate

(e.g. SHB78), and EE system in hydrostati pressure-based oordinate (Laprise, 1992,

L92 hereafter)℄, the upper and lower boundary onditions atually appear inside the set

of equations through vertial integral operators with de(cid:28)nite bounds at the boundaries of

the vertial domain. When they are present, it is assumed that these integral operators

an be eliminated, i.e.

an be transformed to "unbounded" operators by

that L, L∗

appliation of appropriate vertial linear di(cid:27)erential operators to the prognosti equations

whih originally involve integral operators, in order that e.g. (5) rewrites as:

l1X1

l1L11

· · ·

lP L1P

X1

.

.

.

.

.

.

.

.

.

(11)

.

.

.

.

.

.

∂
∂t










=























.
























lP XP

l1LP 1

· · ·

lP LP P

XP

where P is the number of prognosti variables of the unbounded system, (l1, . . . , lP ) are

linear vertial operators, and (l1L11, . . . , lP LP P ) are linear spatial operators whih no

longer ontain any referene to the upper and lower boundaries. The transformed system

10

obtained for L an then be written as:

∂l.X
∂t

= l.L.X

(12)

where l is the diagonal matrix (l1, . . . , lP ). A similar ondition must be true for L∗

as

well:

it is assumed that applying the same operator l to L∗

leads to an operator lL∗

for whih liL∗

ij does not ontain any referene to the upper and lower boundaries for

(i, j) ∈ (1, . . . , P ). The (cid:28)rst ondition for the following analyses is:

[C1℄: There exists a linear operator l suh as lL and lL∗

have no referene to the

upper and lower boundaries.

The system (12) is heneforth referred to as the "unbounded" system.

4.2 Conditions on the stability of the X state

The aim of these analyses is to determine in whih onditions a stationary state X for

lL will remain a stable equilibrium-state in the time-disretised ontext, provided it is

a stable equilibrium-state in the time-ontinuous ontext. Hene the analyses will be

restrited to stationary states X whih are in stable equilibrium. Given the linear ontext

used here, a physial transposition of this ondition is:

[C2℄: For any perturbation X (t = 0) around X with a bounded energy-density, the

time-evolution X (t) resulting from (12) must have a bounded energy-density.

The ondition is formulated with energy-density instead of total energy beause the do-

main is unbounded in spae. The omplex eigenmodes of the unbounded system (12) are

the omplex funtions of spae X (r) whih satisfy:

lLX (r) = λlX (r)

(13)

11

where λ ∈ C and r denotes the spatial dependeny. The time-evolution of the mode is

bounded in time if λ is a pure imaginary number, and X (r) is then a "normal mode" in

the usual terminology. Theoretial arguments out of the sope of this paper show that a

mathematial transposition of [C2℄ writes:

[C2'℄: For any omplex eigenmode of lL,

λ ∈ iIR ⇐⇒ X (r) has a bounded

energy-density.

system

4.3 Conditions on the normal modes of the linear unbounded

The time-ontinuous normal modes of the original system (5) are the omplex funtions

of spae X (r) whih have an osillatory temporal evolution. Hene they satisfy LX (r) =

i ωX (r). Similarly, the time-ontinuous normal modes of the linear unbounded system

(12) are the omplex funtions of spae X (r) for whih lX (r) has an osillatory temporal

evolution. Hene they satisfy l.LX (r) = i ωl.X (r).

Any normal mode of the original system is also neessarily a normal mode of the un-

bounded system, with the same frequeny ω . For any normal mode of the unbounded

system , we an hoose the origin of spae o in suh a way that this mode writes:

X (r) = X (o)f (r) =

X f (r)

(14)

with

X = (

X1, . . . ,

XP ) ∈ CP

, and f = (f1, . . . , fP ) is a vetor of spae-dependent fun-

b

b

b

tions (the produt

X f is understood "omponent by omponent"). For the indies i suh

as Xi uniformly vanishes,

Xi = 0 and fi(r) = 1 are assumed by onvention. The funtion

f and the vetor

X are respetively termed the "struture" and the "polarisation vetor"

b

b

b

b

of the mode. The two following onditions are required for the proposed analyses:

[C3℄: For any normal mode X of the unbounded linear atmospheri system with a

struture f (r),

li.fi(r) must be proportional to fi(r):

12

∀i ∈ (1, . . . , P ) , lifi(r) = ξifi(r) with ξi ∈ C∗.

(15)

and:

[C4℄: For any normal mode X of the unbounded linear atmospheri system with a

struture f (r), Lij.fj(r) [resp. L∗
∀(i, j), liLij.fj(r) = µijfi(r) and liL∗

ij.fj(r)℄ must be proportional to fi(r):

ij.fj(r) = µ∗

ijfi(r), with (µij, µ∗

ij) ∈ C.

(16)

As will be seen below, these latter two onditions have the important onsequene that for

any normal mode of the unbounded system, eah individual time-disretised prognosti

equation for Xi(r) beomes a salar equation. This key ingredient makes the analysis

straightforward for every member of the ICI lass.

4.4 Comments

Sine the set of normal modes for the unbounded system enompasses the set of normal

mode of the bounded system, the transformation from the bounded system to the un-

bounded system is not likely to "mask" some instabilities of the original system, unless the

auses of the instability lie in the boundary onditions themselves. However, disretised-

analyses allow to larify this point by showing that the stability of the bounded and un-

bounded systems are atually found to be similar in pratie. Besides, disretised-analyses

of the unbounded system are by nature impossible to perform, hene the ontinuous anal-

ysis is the only way to estimate the intrinsi stability of the unbounded system and to

demonstrate that instabilities, when they our in a pratial appliation, are not due to

a weakness in the spatial disretisation or even to the boundary onditions, but atually

to the time-disretised propagation of free modes inside the atmosphere.

In spite of their apparently abstrat and onstraining form, onditions [C1℄(cid:21)[C4℄ are

easy to verify with routine normal mode analysis tehniques when examining a partiular

13

onrete meteorologial system. The ondition [C2'℄ restrits the set of stationary states

X around whih the analysis is meaningful, and onditions [C1℄, [C3℄, [C4℄ restrit the

spetrum of meteorologial ontexts aessible to the analysis, sine they require a quali-

tative similarity between l, L and L∗

operators. As stated in SHB78, analyses performed

under this type of onditions "...grossly exaggerate the stability of the sheme..." sine

in more realisti meteorologial ontexts, the atmospheri and referene operators an be

qualitatively muh more di(cid:27)erent than imposed by this ondition.

5 Time-Disretised Spae-Continuous Analysis

The analysis examine the stability of the time-disretised system for perturbations whih

have a time-ontinuous normal mode struture. Hene we onsider a given funtion f =

(f1, . . . , fP ) whih is a normal mode struture for the time-ontinuous system, and we

determine the normal modes of the time-disretised system whih have the same struture

f , by solving the equation:

X(t=∆t)f (r) = λ

X(t=0)f (r)

b

b

(17)

where

X(t=0) and λ are the unknowns, and

X(t=∆t) is determined using the time-disretisation

b

b

sheme (7) or (9). For shemes using three time levels (as Leap-Frog or extrapolating 2-

TL) a similar relationship

If for some

X(t=−∆t)f (r) = λ−1

X(t=0)f (r) must be added.

solution, |λ| > 1 (resp. < 1) the sheme is unstable (resp. damping) for this partiular

b

b

mode. The ratio Arg(λ)/(iω∆t) gives the relative phase-speed error of the sheme for

this mode.

The analysis is desribed here for a 2-TL disretisation (7), but the transformation to

a 3-TL sheme as well as the addition of time-(cid:28)lters suh as κ or ǫ are straightforward.

In the following of this setion, the notation X (r, t) is replaed by the usual supersript

notation for time-disretised variables X t(r) as in setion 3.

14

As a onsequene of the disussion in setion 3 and applying (17) , X +(0)

an be written

as X +(0)(r) = µ(λ)X 0(r), where µ(λ) depends on the hoie of the initial guess X +(0)

(e.g.

µ = 1 for a 2-TL non-extrapolating sheme, µ = 2 − 1/λ for a 2-TL extrapolating sheme,

et...). The original unbounded system (12) is thus time-disretised following (7):

lX +(0)(r) = µ(λ) lX 0(r)

lX +(n)(r) − lX 0(r)
∆t

=

lL.X +(n−1)(r) + lL.X 0(r)
2

+

lL∗.X +(n)(r) − lL∗.X +(n−1)(r)
2

, n ∈ (1, . . . , Niter)

lX +(r) ≡ lλX 0 = lX +(Niter)(r)

For shemes with Niter ≥ 2, it is assumed that the intermediate states lX +(n)(r) for

i ∈ (1, . . . , Niter − 1) have the same struture f as the one urrently examined, whih

allows to de(cid:28)ne the polarisation vetor

by:

b
(r) =

liX +(n)
i

X +(n)
i

lifi(r).

X +(n)
i

b

(18)

Hene, using (15) and (16), the spae dependeny fi(r) eliminates. For the generalized

state-vetor Z = (

X 0,

X +(0),

X +(1), . . . ,

X +(Niter)) of length (Niter + 2) × P , the above

system writes:

b

b

b

b

µ(λ)IP −IP

0P

· · ·

· · ·

0P

M1

M2 M3

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

0P

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

0P

M1

.

.

.

. M2 M3

.

.

−λIP

0P

· · ·

· · ·

0P

IP











































.Z = M.Z = 0.

(19)

where IP (resp. 0P ) is the unit (resp. null) P -order matrix, and:

15

(20)

(21)

(22)

(23)

(M1)ij = −δij −

(M2)ij = −

∆t
2

(M3)ij = +δij −

µij
∆t
ξi
2
µij − µ∗
µ∗
ij
ξi

1
ξi (cid:0)
∆t
2

ij

(cid:1)

where δij is the (i, j) Kroneker symbol. The possible values of λ for the normal mode

struture f (r) that we examine, are thus given by the roots of the following polynomial

equation in λ:

Det(M) = 0

The dependenies to λ are limited to the top- and bottom-left bloks. For a non-

extrapolating 2-TL sheme the degree of the polynomial is P , and there are P phys-

ial modes assoiated with this struture f (r). For time-shemes making use of three

time-levels (i.e. 3-TL shemes, or extrapolating 2-TL shemes, or 2-TL shemes with a

time-(cid:28)lter), the degree beomes 2P , and there are P additional omputational modes.

The growth-rate for any of these modes is given by the modulus of the orresponding

omplex root of (23). The growth rate of the time sheme for the onsidered struture f

is then de(cid:28)ned by the maximum value of the modulus of these P or 2P roots:

Γ(f ) = Max (|λi(f )|) ,

i ∈ (1, . . . , P ) [ or (1, . . . , 2P ) ]

(24)

Analytial solution of (23) is not possible for large values of P , and a numerial solution

is often needed.

In this paper we will all "asymptoti growth-rate" the growth-rate for the matrix

M in the limit of large time-steps ∆t → ∞. The analysis of the asymptoti growth-

rate is easier than for (cid:28)nite time-steps, sine the matrix M of (23) degenerates to a

matrix M′

in whih δij vanishes and ∆t/2 eliminates. Another advantage of asymptoti

16

growth-rates is that they appear to be independent of the struture f in most of the ases

examined below, thus simplifying onsiderably the interpretation of the results. When the

asymptoti growth-rate is independent of the struture f the growth-rate of the sheme

an be de(cid:28)ned by the growth-rate obtained for this sheme with any struture f .

When the growth rate for a given sheme is one (or less) for any mode of any normal

mode struture f , the sheme is then said to be "unonditionally stable" (being under-

stood "in ∆t"). The riterion for unonditional stability obtained through Det(M′) = 0

is not only of aademi interest sine the onsidered time-shemes are atually used with

large time-steps in NWP: the pratie shows that a sheme whih is not unonditionally

stable in the simpli(cid:28)ed ontext of these analyses has few hane to be robust enough for

use in real onditions.

6 Simple examples: 1D systems

6.1 1D Shallow-water system

The linearised 1D shallow water system in an horizontal diretion x an be lassially

written in terms of the wind u along x, and the geopotential φ:

∂u
∂t
∂φ
∂t

= −

= −φ

∂φ
∂x

∂u
∂x

(25)

(26)

This system is also valid for the external mode of an isothermal atmosphere in HPE and EE

system, replaing φ by 4(R2/Cp)T (whih is done in the following). The referene system

is obtained by replaement of T by T ∗

, and a "non-linearity" fator is de(cid:28)ned through:

α = (T − T ∗)/T ∗

. Solution of (13) implies that if T < 0, λ ∈ iIR =⇒ u =

u exp(rx),

whih has not a bounded energy-density for rx −→ +∞. Hene [C2'℄ requires T ≥ 0 (i.e.

b

α ≥ −1). The boundary onditions do not appear expliitly in the system, hene l an

17

be taken as the identity operator to satisfy [C1℄, and [C3℄. In the notations of setion

4 and 5 we have P = 2 , X1 = u and X2 = φ. The normal modes of the system write

ψ(x) =

ψ exp(ikx) with k ∈ IR and ψ = (u, φ). Conditions [C1℄ (cid:21) [C4℄ are easily heked

b

to be satis(cid:28)ed.

For a 3-TL SI sheme, (23) writes:

2

λ2 − 1
2∆t (cid:19)

(cid:18)

= −

k2c∗2
4

λ2 + 1

λ2 + 1 + 2αλ

,

(cid:0)

(cid:1) (cid:0)

(cid:1)

(27)

. In the limit of long time-steps, the LHS term disappears,

where c∗ = 2

(R/Cp)RT ∗

p

and the four roots of the RHS give the "asymptoti" numerial growth-rate for the two

physial and two omputational modes of the system. The two roots of the (cid:28)rst fator

have a neutral stability, while those of the seond fator have a modulus equal to 1 if

−1 ≤ α ≤ 1. The riterion (on X , X ∗

) for unonditional stability (in ∆t) of the 3-TL

SI sheme is thus : 0 ≤ T ≤ 2T ∗

. Some further algebrai manipulations from (23) with

∆t = ∞ show that this riterion remains unhanged when inreasing Niter .

For a 2-TL SI non-extrapolating (µ = 1) sheme, (23) beomes:

λ − 1

2

(cid:18)

∆t (cid:19)

k2c∗2
4

= −

(λ + 1) (λ + 1 + 2α) ,

(28)

and the riterion for unonditional stability beomes more onstraining than for the 3-

TL sheme: −1 ≤ α ≤ 0 (i.e. 0 ≤ T ≤ T ∗

). The asymptoti growth-rate of a 2-TL

non-extrapolating ICI sheme with Niter iterations is given by:

The domain for unonditional stability is thus −1 ≤ α ≤ 0 for odd values of Niter , and

Γ = Max

1,
(cid:0)

2(−α)Niter − 1
(cid:12)
(cid:12)

(cid:12)
(cid:1)
(cid:12)

(29)

−1 ≤ α ≤ 1 for even values of Niter .

6.2 1D vertial aousti system in mass-based oordinate

We onsider a vertial 1D ompressible atmospheri olumn satisfying the onditions

listed in setion 2. A regular mass-based oordinate σ = (π/πs) is hosen following L92,

18

by making η = σ , A(σ) = 0 and B(σ) = σ in equation (31) of L92. The variable π denotes

the hydrostati pressure, and πs , the surfae hydrostati pressure. The system is readily

obtained from equations (36) (cid:21) (45) of L92 by removing all horizontal dependenies. The

surfae hydrostati-pressure does not evolve in time (see equation (45) in L92).

The equations are linearised around a resting atmospheri-state X and a resting

referene-state X ∗

, both satisfying the onditions of setion 2. The temperatures T and

T ∗

are taken uniform, and we still de(cid:28)ne the "non-linearity" fator by: α = (T − T ∗)/T ∗

.

The pressure values p and p∗

are assumed to be equal to a ommon value π0 at the origin

(σ = 1). Sine X and X ∗

are hydrostatially balaned, p = π = σπ0 and p∗ = π∗ = σπ0 at

any level. The thermodynamis equation deouples and the linear system around X for

the vertial veloity w , and the pressure deviation p′ = p−p writes in standard notations:

∂w
∂t
∂p′
∂t

=

=

g
π0
Cp
Cv

∂p′
∂σ
gπ0
RT

σ2 ∂w
∂σ

The same derivation holds for L∗

and leads to an operator formally idential to the RHS

of (30)-(31), still ating on (w, p′), but with T replaed by T ∗

. The solution of (13),

implies that if T < 0, λ ∈ iIR =⇒ w =

w σr

with r < −1 or r > 0. For the mode with

r < −1, the energy-density is not bounded when σ → 0. If T ≥ 0, the struture of the

b

normal modes of (30)-(31) is given by:

w(σ) =

w σ(iν−1/2) =

w f1(σ)

p′(σ) =

b
p′ σ(iν+1/2) =

b
p′ f2(σ)

b

b

where ν is a real number, and they have a bounded energy-density. The ondition [C2'℄

therefore requires T ≥ 0 (i.e. α ≥ −1). Finally, [C4℄ is trivially heked to be satis(cid:28)ed.

For a 3-TL SI sheme, (23) writes:

2

λ2 − 1
2∆t (cid:19)

(cid:18)

= −

(ν2 + 1/4)c∗2
4H ∗2

λ2 + 1

λ2 + 1 −

(cid:0)

19

(cid:18)

(cid:1)

2αλ
1 + α(cid:19)

,

(30)

(31)

(32)

(33)

(34)

where c∗ =

(Cp/Cv)RT ∗

and H ∗ = RT ∗/g . Comparison of (34) and (27) shows that

p

the stability of the 1D vertial system for α is the same as the one of the previous

shallow-water system for α′ = −α/(1 + α). Hene the riteria for unonditional stability

diretly follows from those of the previous ase, by similarity arguments. The riterion

for unonditional stability of the 3-TL SI sheme is α ≥ (−1/2), i.e. T ≥ (1/2)T ∗

, and

this riterion remains unhanged when inreasing Niter .

For a 2-TL SI non-extrapolating (µ = 1) sheme, (23) beomes:

λ − 1

2

(cid:18)

∆t (cid:19)

= −

(ν2 + 1/4)c∗2
4H ∗2

(λ + 1)

λ + 1 −

(cid:18)

2α
1 + α(cid:19)

,

(35)

and the riterion for unonditional stability (α ≥ 0, i.e. T ≥ T ∗

), whih is more on-

straining than for the 3-TL SI sheme. For iterated 2-TL shemes, the riterion for

unonditional stability is α ≥ (−1/2) for even values of Niter , and α ≥ 0 for odd values.

6.3 1D vertial aousti system in height-based oordinate

In this example we show that the stability properties of the 1D vertial system may depend

on the oordinate. The framework is taken as in the previous example exept that the

vertial oordinate is the height z . The linearised system L (f. e.g. Caya and laprise,

1999) writes:

where q′ = q − q , q = ln(p/p0), q = −gz/RT , p0 is a referene pressure, and p is the true

pressure. The normal modes of L have the following form, for ψ = (w, T ′, q′):

∂w
∂t
∂T ′
∂t
∂q′
∂t

= −RT

+ g

T ′
T

= −

w

=

(cid:18)

Cp
Cv

∂
∂z (cid:19)

w,

∂q′
∂z
∂
∂z

−

RT
Cv
g
RT

ψ =

ψ exp

iν +

(cid:20)(cid:18)

1
2H (cid:19)

z

(cid:21)

b

20

(36)

(37)

(38)

(39)

(40)

(41)

where H = (RT /g). The referene system L∗

is de(cid:28)ned in a similar way replaing T by

T ∗

and q by q∗ = −gz/RT ∗

. It should be noted that the struture of the normal modes

of L∗

is not the same as for L sine the harateristi height for L∗

is H ∗ = (RT ∗/g)

For a 2-TL SI non-extrapolating (µ = 1) sheme, (23) beomes:

λ − 1

(cid:18)

∆t (cid:19)

2

=

c∗2
4 (cid:18)

1
2H (cid:19)

iν +

(λ + 1 + 2α)

iν (λ + 1) −

(cid:20)

1
H ∗ (cid:18)

1 + 2α
1 + α (cid:19) (cid:18)

λ + 1 −

4α

1 + 2α(cid:19)(cid:21)

where c∗ =

(Cp/Cv)RT ∗

p

. In the height-oordinate framework, the asymptoti growth-

rate depends on the struture sine ν appears in one of the fators whih beome dominant

at large time-steps. The interpretation of the results is thus slightly ompliated in om-

parison to the ase of a mass-based oordinate. For the most external struture (ν = 0),

the asymptoti growth-rate is given by the roots of:

(λ + 1 + 2α)

λ + 1 −

(cid:18)

4α
1 + 2α(cid:19)

= 0.

This polynomial onsists in a ombination of two fators similar to those obtained in

the two previous examples (through a formal replaement of 2α by α for the seond

fator). As a onsequene, the unonditional stability domains an be readily dedued

from these previous examples: the external struture ν = 0 is unstable for any value

α 6= 0 when ∆t −→ ∞. The instability is thus muh more severe than in the ase of a

mass-based vertial oordinate, for whih α ≥ 0 was su(cid:30)ient to ensure unonditional

stability. Moreover, slightly shorter strutures with vertial wavelengths of the order of

(1/H) are found to be more unstable than the external one, and for these strutures, the

unonditional stability riterion (α = 0) remains unhanged when Niter is inreased. Fig.

1 shows the asymptoti growth-rates for the 2-TL SI (Niter = 1) sheme and the the 2-TL

ICI sheme with Niter = 2 for ν = 0.0001 m−1

, a struture for whih the instability is

lose to its maximum. The severe instability of the 2-TL SI sheme is only alleviated but

not suppressed by hoosing Niter = 2.

21

For the 3-TL SI sheme, the external struture ν = 0 is unonditionally stable for

−0.25 ≤ α ≤ 1, but slightly shorter strutures as above are found unstable at large

time-steps as soon as α 6= 0 (very short modes are stable however). Fig. 1 depits

the asymptoti growth-rates for two strutures: the external struture ν = 0, and a long

struture ν = 0.0001 m−1

. The growth-rate of the long struture for a moderate time-step

∆t = 30 s with a time-deentering ǫ = 0.1 (as in Caya and Laprise, 1999) is also depited:

the pratial instability beomes small in these onditions, and the 3-TL sheme annot

be positively rejeted, espeially onsidering the fat that dissipative proesses ould at

in a way to stabilize the sheme. The pratial impat of this predited weak instability

for NWP appliations ould be easily evaluated with a z -oordinate model, using an

experimental set-up similar to the one used here, and then progressively extending the

set-up to approah real-ase experimental onditions.

6.4 Comments

In the three simple examples examined above, the riterion for unonditional stability

is seen to be more onstraining in the 2-TL non-extrapolating SI sheme than in the

3-TL SI sheme. The 2-TL extrapolating SI sheme is found to have similar domains

of unonditional stability than its non-extrapolating ounterpart (not shown). For mass-

based oordinates, if both vertially propagating aousti waves and external gravity waves

are simultaneously allowed by a given equation system, the above analyses suggest that

2-TL SI shemes are so onstraining that there is no domain for unonditional stability.

For height-based oordinates, the long vertially propagating aousti waves are always

unstable in the 2-TL SI sheme.

This leads to suspet that, in opposition to 3-TL SI shemes, lassial 2-TL SI shemes

are not suitable for the EE system with any vertial oordinate. The HPE system with

22

2-TL SI sheme did not su(cid:27)er from this problem sine vertially propagating waves are not

allowed in HPE (i.e. the 1D olumn atmosphere is stationary). The intrinsi instability

of the 2-TL SI sheme for EE system is on(cid:28)rmed in setion 7 for mass-based oordinates.

When a seond-order time-(cid:28)lter with parameter κ is applied to the system examined

in the (cid:28)rst example for a 2-TL SI non-extrapolating sheme, (28) beomes:

λ − 1

2

(cid:18)

∆t (cid:19)

k2c∗2
4

(cid:20)

(cid:18)

1
λ (cid:19)(cid:21) (cid:20)

= −

(λ + 1) + κ

λ − 2 +

(λ + 1 + 2α) + κ

λ − 2 +

(cid:18)

1
λ(cid:19)(cid:21)

,

(42)

and the riterion for unonditional stability beomes −1 ≤ α ≤ 2κ. For the seond exam-

ple, the similarity argument shows that the riterion for unonditional stability beomes:

α ≥ −2κ/(1 + 2κ). The domains of stability of 3-TL and 2-TL time-(cid:28)ltered ICI shemes

for the two (cid:28)rst examples are summarized in Table 1.

The appliation of a time-(cid:28)lter thus allows to alleviate the stability onstraints for

2-TL SI shemes, and a non-vanishing domain for unonditional stability is reovered.

The width of the unonditional stability domain inreases with κ. This is found to hold

for the 1D vertial system in height-based oordinates as well, whih is onsistent with

the results of Semazzi et al.

(1995) and Qian et al (1998): they sueeded to solve

numerially the EE system at low-resolution with a 2-TL SI sheme, however, the use of

a large value κ = 0.5 was required to stabilize the model. As a onsequene the foreasts

su(cid:27)ered from a dramati loss of energy with inreasing foreast-range, and eased to be

of meteorologial interest after 2-3 days. Moreover, at high resolutions (and onsequently

steep orography) the use of a time-(cid:28)lter κ is found experimentally to be an insu(cid:30)ient

solution for eliminating the intrinsi instability of the sheme (not shown).

If a high level of auray is desired for the EE system with a 2-TL lassial SI time-

disretization and high resolution, a more robust sheme (e.g. with a larger value of

Niter ) must be used. The above analyses show that the unonditional stability domain is

23

dramatially redued for odd values of Niter , hene ICI shemes with even values of Niter

are preferable for solving the EE system with a 2-TL sheme.

The 1D vertial system in mass-based oordinates has been found to be more stable

than its ounterpart in height-based oordinates in a general way. For mass-oordinates,

the 3-TL SI and the 2-TL ICI shemes with even values of Niter have an extended domain

of unonditional stability, whilst for height-based oordinates, they are unstable as soon

as α 6= 0. For 3-TL SI shemes, the neessity to have reourse to a (cid:28)rst-order time-

deentering ǫ > 0 to overome this instability is a signi(cid:28)ant drawbak sine it results in a

spurious damping of transient phenomena, similarly to κ but in an even less seletive way,

as mentioned above. We think these di(cid:27)erenes give a substantial theoretial advantage

to mass-based oordinates for solving the EE system with lassial SI or ICI shemes.

7 Analysis of the EE system for isothermal atmospheres

in mass-oordinate

The analysis of the isothermal HPE system for ICI shemes does not substantially modify

the general onlusions drawn for the shallow-water ase (not shown), hene the ase of

the EE system is diretly examined.

In this setion, the EE system is ast in the pure unstrethed terrain-following o-

ordinate σ whih an be lassially derived from the hydrostati-pressure oordinate π

of L92, through σ = (π/πs) ∈ [0, 1], where πs is the hydrostati surfae-pressure. The

nonhydrostati prognosti variables are the non-dimensionalised nonhydrostati pressure

departure P = (p − π)/π (where p is the true pressure), and the vertial divergene d

whih writes in σ oordinate:

d = −

(1 + P)σ

g
RT

24

∂w
∂η

(43)

The adiabati system writes:

dV
dt
dd
dt

dT
dt
dP
dt
∂q
∂t

RT
(1 + P)

= −RT ∇q −

∇P −

1 + P + σ

= −

g2(1 + P)
RT

σ

(cid:18)

+ d(∇V − D3) +

∂
∂σ (cid:19) (cid:18)
g(1 + P)
RT

(cid:18)

1 + σ

∂
∂σ (cid:19)

P

∇w

σ

(cid:18)

(cid:20)

∂V
∂σ (cid:19)(cid:21)

∂P
∂σ (cid:19)

∇φ

= −

D3

RT
Cv

= − (1 + P)

D3 +

Cp
Cv

(cid:18)

˙π
π (cid:19)

= −

(∇V + V∇q)dσ′

1

Z

0

where:

D3 = ∇V + d +

(1 + P)
RT

∇φ.

σ

(cid:18)

∂V
∂σ (cid:19)

1

φ = R

σ (cid:18)
Z
= V∇q −

˙π
π

dσ′
σ′

T
1 + P (cid:19)
1
σ Z
0

σ

(∇V + V∇q)dσ′,

V is the horizontal wind, and ∇ is the horizontal derivative operator. The domain is

restrited to a vertial plane along (x, σ) diretions for larity. The system is linearized

around a resting isothermal and hydrostatially-balaned state X :

∂D
∂t
∂d
∂t
∂T
∂t
∂P
∂t
∂q
∂t

= −RG∇2T + RT (G − I)∇2P − RT ∇2q

= −

1 + σ

∂
∂σ (cid:19) (cid:18)

σ

∂
∂σ (cid:19)

P

g2
RT (cid:18)
RT
Cv

= −

(D + d)

= SD −

(D + d)

Cp
Cv

= −N D,

25

(44)

(45)

(46)

(47)

(48)

(49)

(50)

(51)

(52)

(53)

(54)

(55)

(56)

(57)

(58)

(59)

(60)

(61)

where the vertial integral operators G , S and N are de(cid:28)ned by:

1

Z

σ

GX =

(X/σ′)dσ′

SX = (1/σ)

σ

Xdσ′

1

Z
0
Xdσ′

N X =

Z

0

The L∗

operator is similar to the RHS of this system, simply replaing T by T ∗

.

7.1 Veri(cid:28)ation of onditions [C1℄ (cid:21) [C4℄

The linear operator l1 = σ(∂/∂σ) is applied to (52), and l4 = [I + σ(∂/∂σ)] to (55). The

q equation (56) deouples and we obtain a linear unbounded system, in whih (52) and

(55) are replaed by:

σ

∂
∂σ (cid:19)

(cid:18)
∂
∂σ

σ

(cid:18)

+ I

(cid:19)

∂D
∂t
∂P
∂t

= R∇2T − RT

σ

∂
∂σ

+ I

∇2P

(cid:19)

+ I

(D + d)

(cid:19)

(cid:18)
∂
∂σ

Cp
Cv (cid:18)

σ

= D −

Hene we have P = 4, X = (D, d, T, P). Using of the same operators (l1 , l4), the referene

operator is also made free of any referene to the upper and lower boundary onditions,

whih shows that the ondition [C1℄ is satis(cid:28)ed. Solution of (13) shows that [C2℄ requires

T ≥ 0 (i.e. α ≥ −1). The normal modes of the system are then:

ψ(x, σ) =

ψ exp(ikx) σ(iν−1/2)

(62)

where (k, ν) ∈ IR and ψ represents D , d, T or P . In this partiular ase, the f1, . . . , f4

b

funtions are all idential. The veri(cid:28)ation of [C3℄, [C4℄ proeeds easily, as in previous

setions.

7.2 Results

As a (cid:28)rst illustration of the results, the growth-rates of 2-TL non-extrapolating ICI

shemes are shown in Fig. 2 as funtion of α = (T − T ∗)/T ∗

with a moderate time-

26

step ∆t = 20 s, for three partiular mode strutures:

(i) an external mode (k = 0.0005 m−1

, ν = 0)

(ii) a vertial very internal mode (k = 0, ν = 100)

(ii) an intermediate slantwise mode (k = 0.0005 m−1

, ν = 3)

The suspiions raised in the simple 1D examples are on(cid:28)rmed: the internal vertially-

propagating mode is unstable for α < 0 while the external gravity mode is unstable for

α > 0. Moreover, intermediate, slantwise-propagating modes are unstable in the whole

domain, and the aousti external mode (Lamb-wave) appears to be unstable for α < 0

as well. The domain of stability vanishes, whih on(cid:28)rms that 2-TL SI sheme is not

relevant for solving the EE system. The e(cid:27)et of introduing a time-(cid:28)lter to save the

situation is disussed below.

The asymptoti growth-rates resulting from the EE system for ∆t = ∞ are now

examined. Similarly to most previous ases, they are independent of the geometry (k ,

ν ) of the mode. Fig. 3 shows the asymptoti growth-rates as a funtion of α for 2-TL

non-extrapolating ICI shemes with Niter = (1, 2, 3, 4). As stated above, the SI sheme

(Niter = 1) is unstable for any value of α. For even values of Niter , the sheme has an

"optimal" domain of unonditional stability −1/2 ≤ α ≤ 1, while for odd values, the

sheme is unstable for all values of α.

For 3-TL ICI shemes the domain of unonditional stability is −1/2 ≤ α ≤ 1 indepen-

dently of the values of Niter and κ. The urves (not shown) are similar to those obtained

for even values of Niter for 2-TL ICI shemes.

The impat of applying a time-(cid:28)lter κ = 0.1 to 2-TL ICI shemes is depited on Fig

4 for the seond variant (the (cid:28)rst variant behave qualitatively in the same way). The

global impat is to "lower" the urves of the asymptoti growth-rates, and onsequently,

to inrease the width of the unonditional-stability domain. However, large values of κ

27

(e.g. κ ≈ 0.5) are required in order to obtain a wide stability domain, espeially for the

2-TL SI sheme, and this strategy is known to be irrelevant for NWP purpose.

Finally, it is worth noting that the results obtained for the EE system are fully om-

patible with the onlusions that an be drawn from the intersetion of the domains of

unonditional stability in Table 1 for the two simple frameworks examined above in mass-

oordinate. The ability of these very re(cid:28)ned frameworks to apture the essene of the

behaviour of the time-disretised EE system in the limit of long time-steps makes them

very useful tools to fully understand the underlying auses of its stability or instability.

8 Conlusion

A general method for investigating the stability of the ICI lass of time-disretisations on

anonial problems with various spae-ontinuous equation systems has been presented.

These ICI shemes are based on a separation of evolution terms between a simple linear

operator and "non-linear" residuals. The method has been validated by on(cid:28)rming earlier

results, then the appliation to new frameworks (equation systems or time-disretisation

shemes) allowed to extend these results. The main onlusions drawn from this study

are:

(i) Even on very simple (1D) examples, the stability properties of time-disretisations

for a given equation system are very dependent on fundamental hoies (as e.g. the

hoie of the vertial oordinate). Hene, the import of onlusions drawn from a

given analysis must be arefully limited to the examined framework.

(ii) For the EE system, height-based oordinates have a theoretial disavantage om-

pared to mass-based oordinates sine they exhibit an intrinsi instability for (long)

vertially propagating waves.

28

(iii) The 2-TL SI sheme is found not to be appropriate for the EE set of equations, what-

ever oordinate is employed (using a time-(cid:28)lter results in an unaeptable degrada-

tion of the solution).

(iv) For the EE system, the 2-TL sheme with Niter = 2 brings a dramati inrease of

the stability ompared to the 2-TL SI sheme (Niter = 1). This statement holds for

even values of Niter , while odd values leads to a signi(cid:28)antly weaker stability.

(v) As a onsequene of the latter point, the 2-TL ICI sheme with Niter = 2 seems

worth to be onsidered for the EE system.

However, as mentioned in SHB78, the stability inferred from this type of analyses is

overestimated, and (cid:29)ows in whih the non-linearity omes from other soures than the

disrepany between the atmospheri and referene temperature pro(cid:28)les ould reveal new

instabilities in pratie. For instane, in spite of its apparent "optimal" stability in the

simpli(cid:28)ed ontext of this paper, the 3-TL SI sheme has proved to be not stable enough

for solving numerially the EE system in realisti highly non-linear onditions at high

resolutions, due to other terms treated expliitly. This point learly demonstrates the

limitations of this type of aademi exerise.

Nevertheless, in spite of its neessary limitations, this study an serve to distinguish

shemes whih are de(cid:28)nitely not relevant for pratial use from the others, and give a (cid:28)rst

theoretial justi(cid:28)ation for those whih are worth onsidering. In agreement with Cote et

al (1998) and Cullen (2000) we think that ICI shemes with Niter ≥ 2 are among the most

approriate alternatives for integrating the EE system in highly non-linear onditions at

(cid:28)ne-sale, inluding from the point of view of e(cid:30)ieny.

29

Referenes

Bubnová, R., G. Hello, P. Bénard, and J.F. Geleyn, 1995: Integration of the fully elas-

ti equations ast in the hydrostati pressure terrain-following oordinate in the

framework of the ARPEGE/Aladin NWP system. Mon. Wea. Rev., 123, 515-535.

Caya, D., and R. Laprise, 1999: A semi-impliit semi-Lagrangian regional limate model:

the Canadian RCM. Mon. Wea. Rev., 127, 341-362.

Cté, J., M. Béland, and A. Staniforth, 1983: Stability of vertial disretization shemes

for semi-impliit primitive equation models: theory and appliation. Mon. Wea.

Rev., 111, 1189-1207.

Cté, J., S. Gravel, A. Méthot, A. Patoine, M. Roh, and A. Staniforth, 1998: The

Operational CMC-MRB Global Environmental Multisale (GEM) Model. Part I:

Design Considerations and Formulation. Mon. Wea. Rev., 126, 1373-1395.

Cullen, M. J. P., 2000: Alternative implementations of the semi-Lagrangian semi-impliit

shemes in the ECMWF model. Q. J. R. Meteorol. So., 127, 2787-2802.

Hereil, P., and R. Laprise, 1996: Sensitivity of Internal Gravity Waves Solutions to the

Time Step of a Semi-Impliit Semi-Lagrangian Nonhydrostati Model. Mon. Wea.

Rev., 124, 972-999.

Laprise, R., 1992: The Euler equations of motion with hydrostati pressure as an inde-

pendent variable. Mon. Wea. Rev., 120, 197-207.

Qian, J.-H., F. H. M. Semazzi, and J. S. Sroggs, 1998: A global nonhydrostati semi-

Lagrangian atmospheri model with orography. Mon. Wea. Rev., 126, 747-771.

Robert, A. J., J. Henderson, and C. Turnbull, 1972: An impliit time integration sheme

for barolini models of the atmosphere . Mon. Wea. Rev., 100, 329-335.

30

Semazzi, F. H. M., J. H. Qian, and J. S. Sroggs, 1995: A global nonhydrostati semi-

Lagrangian atmospheri model without orography. Mon. Wea. Rev., 123, 2534-

2550.

Simmons, A. J., B. Hoskins, and D. Burridge, 1978: Stability of the semi-impliit method

of time integration. Mon. Wea. Rev., 106, 405-412.

Simmons, A. J., C. Temperton, 1997: Stability of a two-time-level semi-impliit integra-

tion sheme for gravity wave motion. Mon. Wea. Rev., 125, 600-615.

Tanguay, M., A. Robert, and R. Laprise, 1990: A Semi-Impliit Semi-Larangian Fully

Compressible Regional Foreast Model. Mon. Wea. Rev., 118, 1970-1980.

31

List of Tables

examples.

Table 1: Domains of unonditional stability for time-(cid:28)ltered shemes for the two (cid:28)rst 1D

32

Shallow-water

1D vertial (mass)

3-TL ICI

−1 ≤ α ≤ 1

−1/2 ≤ α

2-TL ICI (Niter even)

−1 ≤ α ≤ 1

−1/2 ≤ α

2-TL ICI (Niter odd) −1 ≤ α ≤ (2κ)1/Niter

−2κ(1/Niter)
1 + 2κ(1/Niter) ≤ α

Table 1: Domains of unonditional stability for time-(cid:28)ltered shemes for the two (cid:28)rst

1D examples.

33

List of Figures

Fig. 1: Asymptoti growth-rates Γ for 1D vertial system in z oordinate as a funtion

of the nonlinearity parameter α. thin line: long mode (ν = 0.0001 m−1

) with 2-TL SI

sheme; thik line:

long mode with 2-TL ICI sheme Niter = 2; dotted line: external

mode (ν = 0)with 3-TL SI sheme; dashed line: long mode with 3-TL SI sheme. Cirles:

pratial growth-rate of 3-TL SI sheme for the long mode with ∆t = 30 s and ǫ = 0.1.

Fig. 2: Growth-rate Γ with ∆t = 20 s for the EE system with a 2-TL SI sheme as

a funtion of the nonlinearity parameter α. solid line: external mode (i); dashed line:

slantwise mode (ii); dot-dashed line: internal mode (iii). The left-part of the solid line

represents an aousti external mode.

Fig. 3: Asymptoti growth-rates Γ for EE system with 2-TL ICI sheme as a funtion

of the nonlinearity parameter α. solid line: Niter = 1; dashed line: Niter = 2; dot-dashed

line: Niter = 3; dotted line: Niter = 4.

Fig. 4: Same as Fig 3, but with a time-(cid:28)lter κ = 0.1. solid line: Niter = 1; dashed

line: Niter = 2; dot-dashed line: Niter = 3; dotted line: Niter = 4.

34

1

. thin line: long mode (

) with 2-TL SI sheme; thik line: long mode with 2-TL ICI sheme

; dotted line: external mode (

)with 3-TL SI sheme; dashed line: long mode with 3-TL SI sheme. Cirles: pratial growth-rate of the 3-TL SI sheme for the long mode with

s and

. 36

2

. solid line: external mode (i); dashed line: slantwise mode (ii); dot-dashed line: internal mode (iii). The left-part of the solid line represents an aousti external mode. 37

Asymptoti growth-rates Γ for 1D vertial system in z oordinate as a funtion of the nonlinearity parameter
Growth-rate Γ with ∆t = 20 s for the EE system with a 2-TL SI sheme as a funtion of the nonlinearity parameter
Asymptoti growth-rates Γ for EE system with 2-TL ICI sheme as a funtion of the nonlinearity parameter
Same as Fig 3, but with a time-(cid:28)lter κ = 0.1. solid line: Niter = 1; dashed line: Niter = 2; dot-dashed line:

4

; dotted line:

. 39

3

. solid line:

; dashed line:

; dot-dashed line:

; dotted line:

. 38

List of Figures

35

Γ

2

1.75

1.5

1.25

1

- 1.25 - 1

- 0.5

0

0.5

1

1.25

α

Figure 1: Asymptoti growth-rates Γ for 1D vertial system in z oordinate as a funtion
of the nonlinearity parameter α. thin line: long mode (ν = 0.0001 m−1

) with 2-TL SI

sheme; thik line:

long mode with 2-TL ICI sheme Niter = 2; dotted line: external
mode (ν = 0)with 3-TL SI sheme; dashed line: long mode with 3-TL SI sheme. Cirles:
pratial growth-rate of the 3-TL SI sheme for the long mode with ∆t = 30 s and ǫ = 0.1.

36

Γ

2

1.75

1.5

1.25

1

- 1.25 - 1

- 0.5

0

0.5

1

1.25

α

Figure 2: Growth-rate Γ with ∆t = 20 s for the EE system with a 2-TL SI sheme as
a funtion of the nonlinearity parameter α. solid line: external mode (i); dashed line:

slantwise mode (ii); dot-dashed line: internal mode (iii). The left-part of the solid line

represents an aousti external mode.

37

Γ

2

1.75

1.5

1.25

1

- 1.25 - 1

- 0.5

0

0.5

1

1.25

α

Figure 3: Asymptoti growth-rates Γ for EE system with 2-TL ICI sheme as a funtion
of the nonlinearity parameter α. solid line: Niter = 1; dashed line: Niter = 2; dot-dashed
line: Niter = 3; dotted line: Niter = 4.

38

Γ

2

1.75

1.5

1.25

1

- 1.25 - 1

- 0.5

0

0.5

1

1.25

α

Figure 4: Same as Fig 3, but with a time-(cid:28)lter κ = 0.1. solid line: Niter = 1; dashed line:
Niter = 2; dot-dashed line: Niter = 3; dotted line: Niter = 4.

39

