Single-Scattering Optical Tomography

Vadim A. Markel and John C. Schotland
Departments of Radiology and Bioengineering, University of Pennsylvania,
Philadelphia, PA 19104

Abstract. We describe a novel tomographic imaging modality. The proposed
technique utilizes visible or near-infrared light as a tissue probe in the “mesoscopic”
scattering regime when the tissue layer exhibits suﬃciently strong scattering so that
its direct visual inspection is not possible, yet transmitted and reﬂected light are not
diﬀuse. The forward model for light propagation in tissues is based on the scattering-
order expansion of the radiative transport equation Green’s function. The associated
inverse problem is similar to the problem of inverting the Radon transform of x-ray
tomography, except that the ray integrals are evaluated not along straight lines but
along broken rays. As a result, the method does not require rotating the imaging
device around the sample and taking multiple projections and, therefore, can be
used in backscattering. An algebraic image reconstruction algorithm is numerically
implemented using computer-generated data. An analytic image reconstruction
formula analogous to the ﬁltered backprojection formula of x-ray tomography is
derived.

7
0
0
2
 
r
a

M
 
2
1
 
 
]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[
 
 
1
v
8
1
1
3
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Single-Scattering Optical Tomography

2

1. Introduction

We describe here a novel optical imaging modality which utilizes near-infrared or
visible light to probe the structure of tissue. The proposed technique will work in the
“intermediate” scattering regime. Namely, we are interested in the physical situation
when tissue exhibits suﬃcient scattering that the image reconstruction methods of
computed tomography (based on inverting the Radon transform) are not applicable,
yet the detected light is not diﬀuse and can be described by a low order scattering
approximation to the radiative transport equation (RTE). The principle idea is to
measure single-scattered light by means of angularly-selective detectors and to use these
measurements to reconstruct the tissue optical properties by solving an appropriate
inverse scattering problem. We will refer to this technique as the single scattering
optical tomography (SSOT).

2. The Principle of SSOT

The physical principle of SSOT is quite simple and is illustrated in Fig. 1. Here
the sample has the shape of a slab and, for the sake of simplicity, incident beams
enter through one of its surfaces normally. However, more general incidence angles are
considered below in section 3.

In the absence of scattering, the incident beam would propagate straight through
the slab, as shown by the green ray. Detection of such straight (unscattered) rays is the
basis of computerized x-ray tomography. If there is ﬁnite scattering in the medium, the
ray can “change direction” as shown in Fig. 1(a). Of course, scattering does not result in
elimination of the ballistic ray. However, it is possible to employ angle-selective detectors
that do not register the ballistic component of transmitted light. In the example shown
in Fig. 1(a), only the intensity of the broken ray shown by the red line is detected. We
will refer to the latter as the single-scattered ray (SSR). Further, it is not diﬃcult to see
that the two points on the slab surface (the point where the incident beam enters the
medium and the point at which the detected ray exists the medium) and the incidence
and detection angles uniquely deﬁne a ray trajectory, assuming that only one scattering
event has occurred (the ray in question has only one node). It will be shown below that
the intensity measured by the detector is mathematically related to the integral of the
attenuation coeﬃcient for the probing light taken along the SSR. In this respect, the
mathematical structure of SSOT is similar to that of Radon transform, except that the
integrals are evaluated along broken rays.

By utilizing multiple incident beams and detecting light exiting the medium at
diﬀerent points, as shown in Fig. 1(b), it is possible to collect enough data to reconstruct
the spatial distribution of the attenuation coeﬃcient in the selected slice of the slab.
Three-dimensional reconstruction can then be performed slice-by-slice. In addition to
varying the incident and exit points, one can also vary the incident and exit angles.
This can provide additional information for simultaneous reconstruction of absorption

Single-Scattering Optical Tomography

3

(a)

(b)

(a) Schematic illustration of the SSR trajectory.

Figure 1.
(b) Source-detector
arrangement for SSOT. Reconstruction is performed independently slice-by slice. The
blue rectangle represents the area in which reconstruction can be performed.

and scattering coeﬃcients of the sample.

As can be seen, the single-scattered component is selected by making the source
and detector both angularly-selective but not aligned with each other. The fact that
the source and detector are not on axis allows one to neglect the ballistic component
of transmitted light. The data can be collected either on opposite sides of the slab
(transmission measurements), or in the backscattering geometry. In both cases, rotation
of the device around the sample is not required.

3. Mathematical Formulation of SSOT

In radiative transport theory, light propagating through the medium is described by
speciﬁc intensity I(r, ˆs) at the point r ﬂowing in the direction ˆs. The speciﬁc intensity
. The time-independent RTE reads
is directly measurable with appropriate detectors
‡

[ˆs

· ∇

+ µa(r) + µs(r)] I(r, ˆs) = µs(r)

A(ˆs, ˆs′)I(r, ˆs′)d2ˆs′ , r

V ,

(1)

Z

∈

where V is a spatial region, µa(r) and µs(r) are the absorption and scattering coeﬃcients
(generally, position-dependent) and A(ˆs, ˆs′) is the scattering kernel normalized according
A(ˆs, ˆs′)d2ˆs′ = 1. Eq. (1) is supplemented by inhomogeneous boundary
to the condition

More precisely, the detectors usually measure an integral of the speciﬁc intensity over some small

R

‡
solid angle and a ﬁnite aperture.

Single-Scattering Optical Tomography

condition of the form

4

(2)

(4)

(5)

(6)

(7)

(8)

I(r, ˆs)

|r∈Ω = Iinc(r, ˆs)

|r∈Ω ,

if ˆs

ˆn(r) < 0 ,

·

where Ω = ∂V is the boundary of V , ˆn(r) is the outward unit normal to this surface at
the point r
|r∈Ω is the incident speciﬁc intensity at the boundary. The
integro-diﬀerential equation (1) with the boundary conditions (2) can be equivalently
re-written as an integral equation:

Ω and Iinc(r, ˆs)

∈

I(r, ˆs) = Ib(r, ˆs) +

Gb(r, ˆs; r′, ˆs′)µs(r′)A(ˆs′, ˆs′′)I(r′, ˆs′′)d3r′d2ˆs′d2ˆs′′ . (3)

Here Ib(r, ˆs) is the ballistic component of speciﬁc intensity and Gb(r, ˆs; r′, ˆs′) is the
ballistic Green’s function of the RTE. The ballistic intensity satisﬁes

Z

[ˆs

· ∇

+ µa(r) + µs(r)] Ib(r, ˆs) = 0

with the inhomogeneous boundary condition (2). If an incident narrow collimated beam
of total power I0 enters the medium at the point r1 in the direction ˆs1, then Ib(r, ˆs) is
given by the following formula:

Ib(r, ˆs) = I0Gb(r, ˆs; r1, ˆs1) ,

where the ballistic Green’s function Gb(r, ˆs; r′, ˆs′) is given by

Gb(r, ˆs; r′, ˆs′) = gb(r, r′)δ2 [ˆu(r
1

−
|r−r′|

gb(r, r′) =

ˆs′) ,

r′)

ˆs′] δ2(ˆs

−

−
µt(r′ + ℓˆu(r

2 exp

r

|

−

r′

|

"−

0

Z

r′))dℓ

.

#

−

−

ˆs′) is the two-dimensional delta-function of direction which is zero unless ˆs
Here δ2(ˆs
coincides with ˆs′, ˆu(r) = r/r is a unit vector in the direction of an arbitrary vector r, and
we have introduced the total extinction (attenuation) coeﬃcient µt(r) = µa(r) + µs(r).
Note that gb is the angularly-averaged ballistic Green’s function:

gb(r, r′) =

d2ˆsd2ˆs′Gb(r, ˆs; r′, ˆs′) .

Z

Z

The scattering-order expansion is obtained by iterating Eq. (3) starting from I = Ib.
Generally, this results in I = Ib + Is, where the scattered component Is is expressible
as a series. If the expansion is terminated at the ﬁrst order, we obtain the following
expression for Is:

Is(r, ˆs) =

Gb(r, ˆs; r′, ˆs′)µs(r′)A(ˆs′, ˆs′′)Ib(r′, ˆs′′)d3r′d2ˆs′d2ˆs′′ .

(9)

Let the incident beam of intensity I0 enter the slab of width L at the point r1 and in
the direction ˆs1 while the detector registers the ray exiting the slab through the opposite
surface at the point r2 and in the direction ˆs2. We denote the intensity measured in

Single-Scattering Optical Tomography

5

such experiment by Is(r2, ˆs2; r1, ˆs1). Then integration according to (9) with Ib(r′, ˆs′′)
given by (5) yields

Is(r2, ˆs2; r1, ˆs1) = I0Θ(π

θ1 −

−

θ2)δ (

ϕˆs1 −

|

ϕˆs2| −

π)

µs(R21)A(ˆs2, ˆs1)
r21 sin θ1 sin θ2

µt(r1 + ℓˆs1)dℓ

µt(R21 + ℓˆs2)dℓ

,

(10)

L2

−

0
Z

(cid:21)

L1

exp

×

0

−
(cid:20)
Z
ϕˆs1 −

where the term δ (
ϕˆs2| −
the position of the node (the ray turning point), r21 = r2−
L2 =
for an illustration). We note the following relations:

r21|
, and the angles θ1 and θ2 are deﬁned by cos θ1,2 = ˆr21 ·

π) is explained below, Θ(x) is the step function, R21 is
,
r1|
R21−
ˆs1,2 (see Fig. 2

r1, r21 =

r2 −

R21|

, L1 =

|

|

|

|

R21 = r1 + L1ˆs1 = r2 −
L1 = r21

sin θ2
sin(θ1 + θ2)

L2ˆs2

, L2 = r21

sin θ1
sin(θ1 + θ2)

,

(11)

(12)

|

−

ϕˆs1 −

ϕˆs2 = 0,

ϕˆs2| −

We now discuss the physical meaning of various terms in (10). First, the angles
π) are the azimuthal angles of unit vectors ˆs1,2 in
ϕˆs1,2 in the expression δ (
a reference frame whose z-axis intersects both the position of the source and the detector
(this axis is shown by a dashed line in Fig. 2 and should not be confused with the z-axis
of the laboratory frame shown by a solid line in the same ﬁgure). The presence of the
above one-dimensional delta function in Eq. (10) is the mathematical manifestation of
the fact that two straight rays exiting from the points r1 and r2 in the directions ˆs1
ˆs2, respectively, can intersect only if ˆs1 and ˆs2 and r21 are in the same plane
and
(equivalently, if ϕˆs1 −
π) and point into diﬀerent half-planes (this requires
that ϕˆs1 −
π). Second, the point of intersection exists only if θ1 + θ2 < π, which
θ2). We note that if, additionally, ˆs1 and
is expressed by the theta-function Θ(π
θ1 −
ˆs2 < 0 (ˆs1 points into the slab and ˆs2 points
ˆs2 are restricted such that ˆz
·
out of the slab), then R21 is within the slab. Third, the factor µs(R21)A(ˆs2, ˆs1) is the
“probability” that the ray is scattered at the point r = R21 and changes direction from
ˆs1 to ˆs2. This factor is, in general, position-dependent. Fourth, 1/r21 sin θ1 sin θ2 is a
geometrical factor. We note that it can be equivalently rewritten as r21/H21H12, where
H21 and H12 are the two heights of the triangle (r1, R21, r2) drawn from the vertices
r1 and r2, respectively, as shown in Fig. 2. Derivation of this geometrical factor is
somewhat involved; more detail is given in Appendix A. Finally, the integral of the
attenuation function in the argument of the exponent is evaluated along the SSR.

−
ˆs1 > 0 and ˆz

ϕˆs2 =

±

±

·

Eq. (10) is the mathematical departure point for image reconstruction. In general,
both the scattering and absorption coeﬃcient can be reconstructed independently. We,
however, consider ﬁrst the more simple case when µs and the phase function A(ˆs, ˆs′) are
constant and known. We then deﬁne the data function as

φ(r2, ˆs2; r1, ˆs1) =

ln

r21 sin θ1 sin θ2

Is(r2, ˆs2; r1, ˆs1)dϕˆs2

−

(cid:20)

I0µsA(ˆs2, ˆs1)

R

.

(cid:21)

(13)

Single-Scattering Optical Tomography

6

y

0

R21

H12

L2

L1

H21

ˆs1

r21

r1

θ1

BR

L

z

r2

θ2

ˆs2

SSR

Figure 2. Geometrical illustration of the quantities used in Eq. (10) and elsewhere.
“BR” denotes ballistic ray and “SSR” denotes single-scattered ray.

Note that if Is is experimentally measured, the angular integration in the right-hand
side of (13) does not need to be performed numerically. The measured data is already
integrated in a narrow interval of ϕˆs2 due to the ﬁnite aperture and acceptance angle of
the detector. Note also that the above deﬁnition is only applicable for such conﬁguration
of sources and detectors that θ1 + θ2 < π. Otherwise, any measured intensity is due to
higher-order terms in the scattering-order expansion which are not properly described
by formula (10).

By combining deﬁnition (13) and Eq. (10), we ﬁnd that the attenuation function

satisﬁes the following linear equation:

µt[r(ℓ)]dℓ = φ(r2, ˆs2; r1, ˆs1) .

(14)

ZSSR(r2,ˆs2;r1,ˆs1)

SSR dℓ is evaluated along the SSR which is uniquely deﬁned by the
Here the integral
source and detector positions and orientations and ℓ is the linear coordinate on this
ray. Thus, the inverse problem of SSOT is, essentially, linear, even though we did not

R

Single-Scattering Optical Tomography

7

make any assumptions about the function µt(r). In this respect, SSOT is similar to the
problem of inverting the Radon transform in x-ray tomography.

We next notice that the inverse problem of ﬁnding µt(r) in a selected slice given the
complete set of measurements φ(r1, ˆs1; r2, ˆs2) is overdetermined. That is, the unknown
function is two-dimensional while the data are four-dimensional since it depends, in
general, on two spatial and two angular variables. This creates an opportunity for
simultaneous reconstruction of scattering and absorption coeﬃcients. Indeed, let µs(r)
be variable and let the background (or average) value of the scattering coeﬃcient be
µsi

. Then Eq. (14) is generalized to

h

µt[r(ℓ)]dℓ

ln

−

µs(R21)
µsi (cid:21)

h

ZSSR(r2,ˆs2;r1,ˆs1)
where the background value
be solved with respect to the two sets of unknowns, µt(r) and ln[µs(r)/
two solutions, µa(r) and µs(r) can be separately deﬁned.

must be used in the deﬁnition (13) of φ. Eq. (15) can
]. From these

µsi

µsi

(cid:20)

h

h

= φ(r2, ˆs2; r1, ˆs1) ,

(15)

4. Image Reconstruction Formula

Eq. (14) can be discretized and solved by standard methods of linear algebra. This
approach is taken in the numerical part of this paper (section 5 below). However, more
sophisticated image reconstruction methods which utilize the translational invariance
of rays are also possible. These methods are conceptually similar to those we have
previously developed for optical diﬀuse optical tomography [1–5].
In particular, we
describe here how an explicit image reconstruction formula can be obtained for ﬁxed
incidence and detection angles, e.g., in the situation schematically shown in Fig. 1(b).
As was explained above, selection of the point of incidence r1, point of detection r2
and the direction of incidence ˆs1 deﬁnes a slice in which image reconstruction of SSOT
is performed. In Fig. 2, this slice coincides with the Y Z-plane of the laboratory frame.
Assuming that the x-coordinate is ﬁxed, we view the attenuation coeﬃcient as a two-
dimensional function µt = µt(y, z) and focus on two-dimensional image reconstruction
in the selected slice.

Since the unknown function is two-dimensional, it is suﬃcient to consider only two-
dimensional measurements. One possible choice is to scan the incidence and detection
points y1 and y2 while keeping the incidence and detection angles β1 and β2 ﬁxed.
By incidence and detection angles we mean here the angles between the z-axis of the
laboratory frame and the unit vectors ˆs1 and ˆs2, respectively, as shown in Fig. 3. These
angles are not equal to θ1 and θ2 shown in Fig. 2. The latter can vary in the measurement
scheme described in this section, while β1 and β2 are ﬁxed. Below, we omit β1 and β2
from the list of formal arguments of the data function and consider the following equation

µt[y(ℓ), z(ℓ)]dℓ = φ(y2, y1) ,

(16)

ZSSR(y2,y1)

where φ(y2, y1) is the two-dimensional data function.

Single-Scattering Optical Tomography

8

y

0

R21

L2

L1

ˆs1

y1

β1

r21

BR

L

z

y2

β2

ˆs2

SSR

Figure 3. Deﬁnition of incidence and detection angles β1 and β2 for the measurement
scheme described in section 4.

Next, we introduce a change of variables. Let ψ(y1, ∆y) = φ(y1 + ∆y, y1). We thus
view the data as a function of the source position y1 and the source-detector transverse
separation ∆y. The important point is that the shape of the SSR depends only on ∆y
but not on y1. We, therefore, can write in the integrand of Eq. (16)

y(ℓ) = y1 + η(∆y, ℓ) ,
z(ℓ) = ζ(∆y, ℓ) .

(17)

(18)

Here the functions η and ζ depend on ∆y and ℓ (and, implicitly, on β1 and β2), but not
on y1. This prompts that Eq. (16) can be simpliﬁed by Fourier transforming it with
respect to y1. Indeed, this results in the following one-dimensional equation:

L1+L2

0

Z

−

exp [

ikη(∆y, ℓ)] ˜µt[k, ζ(∆y, ℓ)]dℓ = ˜ψ(k, ∆y) ,

(19)

where we have deﬁned Fourier transforms of ψ(y1, ∆y) and µt(y, z) according to

Single-Scattering Optical Tomography

˜ψ(k, ∆y) =

Z
ψ(y1, ∆y) =

∞

−∞
∞

−∞

Z
∞

ψ(y1, ∆y) exp(iky1)dy1 ,

˜ψ(k, ∆y) exp(

iky1)

−

dk
2π

,

˜µt(k, z) =

µt(y, z) exp(iky)dy ,

µ(y, z) =

˜µt(k, z) exp(

iky)

dk
2π

.

−

Z

−∞
∞

−∞

Z

9

(20)

(21)

(22)

(23)

Thus, the two-dimensional
dimensional integral equation (19) which is parameterized by the Fourier variable k.

integral equation (16) has been reduced to the one-

Integral equation (19) can be inverted analytically. For simplicity, we have derived
an analytical solution in the special case of normal incidence, β1 = 0, while the detection
angle β2 is arbitrary. We then have

0 ,
[ℓ

−

(

(

η(∆y, ℓ) =

L1(∆y)] sin β2 , L1(∆y) < ℓ < L1(∆y) + L2(∆y)

,

(24)

ℓ < L1(∆y)

ζ(∆y, ℓ) =

ℓ ,
L1(∆y) + [ℓ

ℓ < L1(∆y)
L1(∆y)] cos β2 , L1(∆y) < ℓ < L1(∆y) + L2(∆y)

. (25)

−

∆yctgβ2, L2(∆y) = ∆y/ sin β2 and the allowable values of ∆y are
Here L1(∆y) = L
in the range [0, Ltgβ2]; the total length of the ray is L1 + L2 = L + ∆ytg(β2/2). In
L, where L is the total slab thickness. We now substitute
particular, note that L1 ≤
expressions (24),(25) into (19) and, after some algebraic manipulation, arrive at

−

˜ψ(k, ∆y) =

˜µt(k, ℓ)dℓ

L1(∆y)

0
Z

+

exp [ikL1(∆y)tgβ2]
cos β2

L

L1(∆y)

˜µt(k, ℓ) exp(

ikℓtgβ2)dℓ .

(26)

−

Z
To simplify notations, we introduce new variables, q = ktgβ2, c = cos β2 and
deﬁne two new functions: f (z) = ˜µ(qctgβ2, z) and F (z) = ˜ψ(qctgβ2, ∆y(z)), where
z)tgβ2 and the dependence of the functions f (z) and F (z) on q is implied.
∆y(z) = (L
−
Then (26) takes the form

z

0

Z

1
c

L

z

Z

−

f (ℓ)dℓ +

exp(iqz)

exp(

iqℓ)f (ℓ)dℓ = F (z) , 0

z

L .

(27)

≤

≤

Solution to the above integral equation with arbitrary q and 0 < c < 1 is obtained
in Appendix B. Here we adduce the ﬁnal result, which is

fi(z) =

κ

G(z)

iκq exp(

iκqz)

exp(iκqℓ)G(ℓ)dℓ

,

(28)

−

(cid:20)

−

−

(cid:21)

z

0

Z

Single-Scattering Optical Tomography

where

c

κ =

cos β2

,

=

1

1

c

−
G(z) = F ′(z)

cos β2

−
iqF (z) ,

−

10

(29)

(30)

prime denotes diﬀerentiation and the lower index “i” in fi(ℓ) is used to emphasize that
this is an inverse solution to Eq. (27).

One important comment on the obtained solution is necessary. The function F (z)

in (27) is not arbitrary but such that

L

0

Z

F (L) = exp(

iκqL)

cF (0) + iκq

exp(iκqℓ)F (ℓ)dℓ

.

(31)

−

(cid:20)

(cid:21)

This can be veriﬁed directly. However, experimental measurements may result in a
function F (z) that does not satisfy this condition. On the other hand, the inverse
solution (28) is invariant if we add to F (z) a function a exp(iqz) with an arbitrary
It can be shown that any experimental function F (z) can be uniquely
constant a.
written in the form F (z) = Freg(z) + a exp(iqz), where Freg(z) satisﬁes condition (31).
Thus, inverse formula (28) involves regularization, or ﬁltering of input data. Full singular
value analysis of the integral operators of Eqs. (27) and (28) is outside of the scope of
this paper. We however, note the following. Substitution of any “probe” function fp(z)
into (27), obtaining corresponding function F (z), substitution of the latter into (28) will
necessarily result in fi(z) = fp(z). However, if we choose an arbitrary function Fp(z),
substitute it into (28) and then substitute the obtained fi(z) into (27), the resultant
F (z) will be, generally, not equal to Fp(z).

Restoring original notations, we ﬁnd the inverse solution to (26) to be

˜µt(k, z) = ctg

H(k, z)

ikctg

exp

ikctg

z

β2
2

z

(cid:18)
exp

(cid:19) (cid:26)

ictg

β2
2

(cid:20)

(cid:18)

(cid:19)

(cid:21)

×

0
Z

−

(cid:18)
H(k, ℓ)dℓ

(cid:19)
,

kℓ

−

(cid:20)

β2
2

(cid:27)

β2
2

(cid:18)

(cid:19)

(cid:21)

where

H(k, z) =

+ ik

˜ψ(k, ∆y)

.

∂
∂∆y

(cid:21)
The real space solution is then obtained by substitution of (32) into (23).

∆y=(L−z)tgβ2
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:20)

(32)

(33)

5. Numerical Simulations

Application of the analytical image reconstruction formula (32) is expected to result
in faster and more accurate image reconstruction, especially when large data sets are
used. However, numerical implementation of this formula is not straightforward and, in
particular, requires numerical evaluation of derivative in (33). Here we illustrate image

Single-Scattering Optical Tomography

11

reconstruction in SSOT using a simple numerical technique based on discretization and
algebraic inversion of the two-dimensional integral equation (16).

Ly ×

Simulations were performed in a rectangular isotropically scattering sample with
Lz. The discretization step was h and the dimensions of the
dimensions Lx ×
sample were Lx = 11h, Ly = 122h and Lz = 40h. For the case of isotropic scattering,
the integral kernel in the right-hand side of Eq. (1) (known as the phase function
in the transport theory) is constant: A(ˆs, ˆs) = 1/4π. The background absorption
coeﬃcient of the sample was equal to 0.01h−1 which was spatially modulated by
absorbing inhomogeneities (the target) as is explained below. The scattering coeﬃcient
was constant throughout the sample, with three diﬀerent values used: µs = 0.04h−1,
µs = 0.08h−1 and µs = 0.16h−1. The sources were normally incident on the surface
z = 0. The detectors were placed on the other side of the sample and measured the
speciﬁc intensity exiting the surface z = Lz at the angle of π/4 with respect to the
z-axis. This included two possibilities: the exiting rays making the angle of π/4 or 3π/4
with the y-axis. In some cases, data from both exit directions were used. Note that the
distance Lz corresponds to the slab thickness L used in sections 3 and 4. The optical
depth of the sample, µsLz varied from 1.6 to 6.4. This corresponds to the mesoscopic
scattering regime in which the image reconstruction method of SSOT is applicable.

5.1. Forward Problem

The forward data were obtained by solving the RTE numerically. For this purpose, we
have utilized the following technique which is applicable to isotropic scattering and based
on equations of Refs. [6, 7]. If A(ˆs, ˆs) = 1/4π, it can be shown from (3) that the speciﬁc
intensity everywhere inside the sample is related to the density of electromagnetic energy
u(r)

I(r, ˆs)d2ˆs by the following formula:

≡

R

I(r, ˆs) = Ib(r, ˆs) +

Gb(r, ˆs; r′, ˆs′)

u(r′)d3r′d2ˆs′

µs(r′)
4π

and that u(r) satisﬁes the following integral equation

u(r) = ub(r) +

gb(r, r′)

u(r′)d3r′ ,

Z

Z

µs(r′)
4π

≡

where gb(r, r′) is given by (7) and ub(r)

Ib(r, ˆs)d2s is the “ballistic density”.

Eq. (35) is discretized on a rectangular grid and solved by methods of linear algebra.
R
In our simulations, the sample was discretized with the step h and it was assumed that
u(r) is constant within each cubic cell. Corresponding values of un = u(rn), where rn is
the center of the n-th cubic cell, obey the algebraic system of equations with the square
matrix of the size N = LxLyLz/h3, in our case, N = 53, 680. The oﬀ-diagonal elements
of the matrix corresponding to the integral in the right-hand side of (35) are given by
(µsh3/4π)gb(rm, rn). Here we took advantage of the fact that µs was set to be constant
throughout the sample while the inhomogeneities were purely absorbing. Computation

(34)

(35)

12

(36)

(37)

(39)

(40)

(41)

Single-Scattering Optical Tomography

of the diagonal elements is slightly more involved because gb(r, r′) diverges when r
→
To evaluate the diagonal elements, we need to ﬁnd an approximation for the integral

r′.

where integration is carried out over the n-th cell. While integration over a cubic volume
is diﬃcult, the important point is that the singularity in gb(r, r′) is integrable. We then
write, approximately,

S =

µs
4π

ZVn

gb(rn, r)d3r ,

Req

gb(0, r)r2dr ,

S

µs

≈

0

Z

where Req is the radius of a sphere of equivalent volume, i.e., Req = (3/4π)1/3h. We
1/r2. This leads to S = µsReq,
than use µtReq ≪
and the discretized version of Eq. (35) becomes

1 which allows us to write gb(0, r)

≈

(1

µsReq)un −

−

µsh3
4π

Xm6=n

gb(rn, rm)um = ub(rn) .

(38)

This set of equations is an accurate approximation to the integral equation (35) if
1. In our simulations, µsh was no more than 0.16. We, however, did
µsReq ∼
not neglect the term µsReq in the left-hand side of (38).
Eq. (38) can be written in the matrix notations as

µsh

≪

u

=

W|

i

b
i

|

where

1
α

h

n

=

|W|

m
i
h2
rm|
rn −
α is a dimensionless coupling constant deﬁned by

2 exp

|rn−rm|

"−

0
Z

−

|

µt (rm + ˆu(rn −

rm)ℓ) dℓ

,

#

α =

4π(1

µsReq)

,

µsh

−

u

and
average over the n-th cell, namely, ub(rn) = h−3

= un,

n
|

n
|

b
i

i

h

h

= 4πub(rn)/µsh. Note that the quantity ub(rn) is deﬁned as an

ub(r)d3r.

Vn

R

W

The most time-consuming part of the forward simulation was computing the
. The complexity arises due to the presence of inhomogeneities
elements of matrix
in the sample. Obviously, if the sample is homogeneous, integration in (40) can be
performed analytically. We, however, have solved the forward problem with absorptive
inclusions placed inside the sample as described in section 5.2. This required numerical
computation of integrals in the right-hand side of (40). We have discretized each ray
connecting the points rn and rm with the linear step ∆ℓ = 0.1h and computed the

Single-Scattering Optical Tomography

13

wn

150

100

50

0

0

10000

20000

30000

40000

50000

60000

n

Figure 4. All 53, 680 eigenvalues wn of the matrix
µs = 0.08h−1 and the set of absorptive inhomogeneities described in section 5.2.

of Eq. 39 computed for

W

≈

×

1.4

−
W

required

109 such integrals.

respective integrals by the trapezoidal rule. Finding all matrix elements of
computation of N(N
After the matrix

1)/2
was computed, Eq. (39) was solved by direct matrix inversion.
is well-posed. This is illustrated in Fig. 4
We note that the square symmetric matrix
W
for µs = 0.08h−1 and the set of absorptive
where we plot all the eigenvalues of
inhomogeneities described in section 5.2. It can be seen that the condition number of
is positive-deﬁnite which is
W
the reﬂection of the fact that both u and ub are positive. We have also veriﬁed that, in
all simulations, the “diﬀuse” component of the density ud deﬁned by ud = u
ub was
positive everywhere inside the sample.

does not exceed, approximately, 2. We also note that

W

W

W

−

The data function of SSOT requires the knowledge of the speciﬁc intensity I(r, ˆs)
rather than the density u(r). We have computed the speciﬁc intensity by substituting
the numerical solution u(rn) into (34) (where the ballistic part Ib may be ignored). The
corresponding integration was performed numerically. Note that I(r, ˆs) obtained from
(34) satisﬁes the boundary conditions at all surfaces. We also stress that the numerical
approach described in this section is non-perturbative and includes all orders of the
scattering-order expansion.

An important consideration is the eﬀects of discretization on the expression
for single-scattering intensity (10) that is used in the deﬁnition of data function
according to (13), and on the expression for the forward data according (34). Since
discretized computations involve discrete rays, the delta-function δ (
π) and
the geometrical factor 1/r21 sin θ2 sin θ1 must be modiﬁed. In particular, the expression
for the single-scattered intensity (the discrete analog of (10)) is

ϕˆs2| −

ϕˆs1 −

|

Is(r2, ˆs2; r1, ˆs1) =

gb(r2, R21)ub(R21) .

(42)

µsh3
4π

14

(43)

Single-Scattering Optical Tomography

where ub(R21) is the average of ub(r) over the volume of the cell that contains R21. The
deﬁnition of the data function must be modiﬁed accordingly. The discretized version of
(34) is

I(r2, ˆs2) =

µsh3
4π

gb(r2, rn)un ,

Xˆu(r2−rn)=−ˆs2

−

rn) =

where un must be computed numerically for the selected source. The condition
ˆs2 means that summation is performed only over such cells that are
ˆu(r2 −
ˆs2. The
intersected by the ray exiting from the detection point r2 in the direction
above formula is valid for the speciﬁc measurement scheme we have used in numerical
simulations when the intersection length of all such rays with any cubic cell is constant.
If this is not so, a more complicated numerical integration must be employed. Finally,
we emphasize that the account of geometrical factors in (10) is important if experimental
data are used. At the same time, the use of experimental data avoids many mathematical
complications that arise due to discretization of rays.

−

To model noise in the measured data, we ﬁrst scaled and rounded oﬀ the speciﬁc
intensity obtained from the forward solver so that it was represented by 16-bit integers,
similar to measurement by digital ccd cameras. Then a statistically-independent
positively-deﬁned random variable was added to each measurement. The random
variables were evenly distributed in the interval [0, nIav], where n is the noise level
indicated in the ﬁgure legends below and Iav is the average measured intensity (a 16-bit
integer). We did not subtract the “dc part” (the positive background) of the intensity.
Then the simulated intensity measurements, together with the appropriately scaled
incident intensity I0 were substituted into (13) to obtain the data function φ.

5.2. Inverse Problem

The target was a set of absorbing inclusions formed in the shape of letters, with
absorption varying from 0.06h−1 to 0.2h−1. The inclusions were concentrated only in
three layers: x = 3h, x = 6h and x = 9h, as shown in the columns marked “model” of
Figs. 6-8. Thus, for example, in the case µs = 0.04h−1 the contrast of µt (the ratio of µt
in the target to the background value) varied from 2.0 in the letters “RADIOL” to 4.8
in the letters “DEPT”. In the case µs = 0.16h−1, the contrast was smaller and varied
from 1.18 to 2.12.

Eq. (16) was discretized on the same grid as was used for obtaining the forward
solution in section 5.1, except that planar slices with ﬁxed x-coordinates were used in
the image reconstruction. The discrete version of (16) has the form

Lνnµtn = φν ,

n
X

(44)

Lνn is the length of the intersection of the SSR indexed by ν = (y1, y2) (y1 and y2
where
are the discrete y-coordinates of the source and detector) with the n-th cubic cell (located
within the selected x-slice of the sample). In our simulations, only three possibilities

Single-Scattering Optical Tomography

15

100

σn/h

10

1

0.1

0.01

0

200

400

600

800

1000

1200

n

Figure 5. All 1, 156 non-zero singular values σn of the matrix
example is 1, 600

1, 156).

L

(the size of

in this

L

×

Lνn = h,

Lνn = √2h, or

existed:
were
zero (for such combination of the indices ν and n that the corresponding ray did not
intersect the n-th cell). The actual values of elements of
were determined from trivial
geometric considerations which are not repeated here. The matrix form of (44) is

Lνn = 0. The vast majority of the elements of

L

L

and

φ

. The equation (45) was solved by

|

i

φ

=

µti
µti
with the obvious meaning of notations
regularized SVD pseudoinverse [8], namely,

L|

i

|

|

= (

∗

)−1

∗

φ

.

µ+
t i

|

L
)−1 is understood in the following sense:

L

L

i

|

Here (

∗

L

L

(

∗

)−1 =

L

L

Θ(σ2

n −

ǫ) |

gn|

gnih
σ2
n

,

n
X

(45)

(46)

(47)

, σn are
where Θ(x) is the step function, ǫ is a small regularization parameter and
. Numerically,
the singular functions and singular values, respectively, of the matrix
L
= σ2
gni
. A typical
these are found by solving the symmetric eigenproblem
n|
L
for µs = 0.08h−1, 1, 600 measurements and 342 = 1, 156
spectrum of singular values of
L
unknown values of µt (the size of
1, 156, so that the problem
is slightly overdetermined) is shown in Fig. 5. It can be seen that the condition number
for the inverse problem is much larger than for the forward problem. In the example
103. Thus, the inverse problem is very mildly
shown in Fig. 5, the condition number is
ill-posed.

in this example is 1, 600

gni

gni

L|

≈

×

L

|

∗

Reconstruction of the total attenuation coeﬃcient µt was performed in slices
x = xslice = const separated by the distance ∆x = h. For each slice, the source

Single-Scattering Optical Tomography

16

positions were x = xslice, y = nh, z = 0, with n being integers. Seven consecutive slices
were obtained, starting from the slice xslice = 3h. The reconstruction area inside each
slice was 44h

37h, with the ﬁeld of view 34h

77h, 4h

34h.

y

z

The results of image reconstruction are shown in Figs. 6-8 where we show all seven
slices separated by ∆x = h. At the noise levels n = 0 and n = 1%, only the rays making
the angle π/4 with the y-axis were used; for the noise level n = 3%, the exiting rays
which make the angle 3π/4 with the y-axis were also used to improve image stability.

≤

≤

≤

≤

×

It can be seen that the spatial resolution of images depends on the noise level and
contrast and can be as good as one discretization step, h. reconstruction is stable in
the presence of noise and quantitative (note that all panels in each ﬁgure are plotted
using the same color scale). When µs = 0.16h−1 (Fig. ) the optical depth of the sample
is µsLz = 6.4. This is a borderline case when scattering is suﬃciently strong so that
the single-scattering approximation of SSOT may be expected to be inaccurate. Indeed,
the image quality in Fig. 8 is markedly worse than in Figs. 6,7, yet, the letters in the
image remain legible. Overall, reconstructions demonstrate the image quality and level
of detail which is customary in x-ray tomography but can be hardly expected in optical
tomography with multiply scattered light.

It should be also noted that the absolute values of the reconstructed regularization
coeﬃcients are not sensitive to the value of regularization’s parameter ǫ in the regularized
pseudoinverse solution (formula (47)). Qualitatively same results are obtained by setting
ǫ = 0, although we found that selecting a small but nonzero value of ǫ tends to slightly
improve the visual appearance of images.
[1] J. C. Schotland and V. A. Markel, “Inverse scattering with diﬀusing waves,” J. Opt. Soc. Am. A,

vol. 18, no. 11, pp. 2767–2777, 2001.

[2] V. A. Markel and J. C. Schotland, “Inverse scattering for the diﬀusion equation with general

boundary conditions,” Phys. Rev. E, vol. 64, no. 3, p. R035601, 2001.

[3] V. A. Markel and J. C. Schotland, “Eﬀects of sampling and limited data in optical tomography,”

Appl. Phys. Lett., vol. 81, no. 7, pp. 1180–1182, 2002.

[4] V. A. Markel, V. Mital, and J. C. Schotland, “The inverse problem in optical diﬀusion tomography.
iii. inversion formulas and singular value decomposition,” J. Opt. Soc. Am. A, vol. 20, no. 5,
pp. 890–902, 2003.

[5] V. A. Markel and J. C. Schotland, “Symmetries, inversion formulas and image reconstruction for

optical tomography,” Phys. Rev. E, vol. 70, no. 5, p. 056616(19), 2004.

[6] R. C. Erdmann and C. E. Siewert, “Green’s function for the one-speed transport equation in

spherical geometry,” J. Math. Phys., vol. 9, no. 1, pp. 81–89, 1968.

[7] E. W. Larsen, “Solutions of the steady, one-speed neutron transport equation for small mean free

paths,” J. Math. Phys., vol. 15, no. 3, pp. 299–305, 1974.

[8] F. Natterer and F. Wubbeling, Mathematical methods in image reconstruction. Philadelphia: SIAM,

2001.

Appendix A. Derivation of Formula (10)

Substitution of (5) into (9) with r = r2 and ˆs = ˆs2 results in the following expression
for the single-scattered intensity:

Single-Scattering Optical Tomography

17

Model

x=3h

n=0

x=3h

n=1%

x=3h

n=3%

x=3h

x=4h

x=4h

x=4h

x=4h

x=5h

x=5h

x=5h

x=5h

x=6h

x=6h

x=6h

x=6h

x=7h

x=7h

x=7h

x=7h

x=8h

x=8h

x=8h

x=8h

x=9h

x=9h

x=9h

x=9h

Figure 6. Image reconstruction for µs = 0.04h−1. The same color scale is used for all
panels with the maximum (white) corresponding to µt = 0.24h−1 and the minimum
(black) to µt = 0.

Single-Scattering Optical Tomography

18

Model

x=3h

n=0

x=3h

n=1%

x=3h

n=3%

x=3h

x=4h

x=4h

x=4h

x=4h

x=5h

x=5h

x=5h

x=5h

x=6h

x=6h

x=6h

x=6h

x=7h

x=7h

x=7h

x=7h

x=8h

x=8h

x=8h

x=8h

x=9h

x=9h

x=9h

x=9h

Figure 7. Image reconstruction for µs = 0.08h−1. The same color scale is used for all
panels with the maximum (white) corresponding to µt = 0.28h−1 and the minimum
(black) to µt = 0.

Single-Scattering Optical Tomography

19

Model

x=3h

n=0

x=3h

n=1%

x=3h

n=3%

x=3h

x=4h

x=4h

x=4h

x=4h

x=5h

x=5h

x=5h

x=5h

x=6h

x=6h

x=6h

x=6h

x=7h

x=7h

x=7h

x=7h

x=8h

x=8h

x=8h

x=8h

x=9h

x=9h

x=9h

x=9h

Figure 8. Image reconstruction for µs = 0.16h−1. The same color scale is used for all
panels with the maximum (white) corresponding to µt = 0.36h−1 and the minimum
(black) to µt = 0.

Single-Scattering Optical Tomography

20

(A.1)

(A.2)

(A.3)

(A.4)

(A.5)

(A.6)

(A.7)

(A.8)

Is(r2, ˆs2; r1, ˆs1) = I0A(ˆs2, ˆs1)

µs(r)gb(r2, r)gb(r, r1)

δ2[ˆu(r2 −
×

r)

−

Z
ˆs2]δ2[ˆu(r

r1)

−

−

ˆs1]d3r .

With the change of variables r = r1 + R, R = R ˆR and d3r = d3R = R2dRd2 ˆR, the
integral over d2 ˆR is immediately evaluated and we transform (A.1) into the following
one-dimensional integral

Is(r2, ˆs2; r1, ˆs1) = I0A(ˆs2, ˆs1)

gb(r2, r1 + Rˆs1)gb(r1 + Rˆs1, r1)

Z
µs(r1 + Rˆs1)δ2[ˆu(r21 −
×

Rˆs1)

ˆs2]R2dR .

−

We then write the remaining delta-function as

δ2(ˆu

ˆs2) = δ(ϕˆu

ϕˆs2)δ (cos θˆu

cos θˆs2) .

−

−

−

Rˆs1 and θ and ϕ are polar angles of the respective unit vectors. We
Here u = r21 −
choose a reference frame so that its z-axis coincides with the source-detector line. We
the ﬁnd that ϕˆu = ϕˆs1 ±

π. Consequently,

δ(ϕˆu

ϕˆs2) = δ (

−

ϕˆs1 −

|

ϕˆs2| −

π) .

δ (cos θˆu

cos θˆs2) = δ[f (R)] ,

−

We next write

where

f (R) =

r21 −

R cos θ1

2r21R cos θ1 + R2 −

cos θ2 .

r2
21 −

π, equation f (R) = 0 has no positive roots. In
It is not diﬃcult to see that if θ1 + θ2 ≥
the opposite case, however, there is one positive root R = L1. Lengths L1 and L2 are
given by formula (12) and illustrated in Fig. 2. We thus have

p

R2δ[f (R)] = Θ(π

θ1 −

−

θ2)L2
1

δ(R

L1)

−
f ′(L1)

,

|

|

where prime denotes derivative. Computation of the derivative is straightforward and
yields

f ′(L1)

=

|

|

L1
r21L2 sin2(θ1 + θ2)

.

Collecting all the expressions, we arrive at

Rˆs1)

ˆs2] =

R2δ2[ˆu(r21 −
ϕˆs1 −
δ (
|

−
ϕˆs2| −

π) Θ(π

θ1 −

−

θ2)

r21L1L2δ(R

L1)

−
sin2(θ1 + θ2)

.

(A.9)

Single-Scattering Optical Tomography

We then recall that r1 + L1ˆs = R21, L1 =

R21 −

|

r1|

, L2 =

r2 −

|

R21|

and obtain

gb(r2, r1 + L1ˆs1) =

exp

µt(R21 + ˆs2ℓ)dℓ

,

1
L2
2
1
L2
1

L2

L1

−

(cid:20)

0

Z

−

(cid:20)

0

(cid:21)

.

gb(r1 + L1ˆs1, r1) =

exp

µt(r1 + ˆs1ℓ)dℓ

Z
Finally, using expressions (12) for L1 and L2 and substituting everything back into
(A.2), we arrive at the result (10).

(cid:21)

21

(A.10)

(A.11)

Appendix B. Solution of the Integral Equation (27).

To solve

z

0

Z

1
c

L

z

Z

f (ℓ)dℓ +

exp(iqz)

exp(

iqℓ)f (ℓ)dℓ = F (z)

(B.1)

for f (z), we diﬀerentiate (B.1) once with respect to z to obtain

F ′(z) =

1
κ

−

iq
c

z

Z

−

f (z) +

exp(iqz)

exp(

iqℓ)f (ℓ)dℓ ,

(B.2)

c). Now we use (B.1) and (B.2) to ﬁnd the linear combination

where κ = c/(1
G(z) = F ′(z)

−

−

iqF (z). The result is

G(z) =

f (z)

iq

f (ℓ)dℓ .

1
κ

−

z

−

0
Z

f ′(z) + iκqf (z) =

κG′(z) ,

−

which has the obvious solution

−

L

z

Diﬀerentiating once more with respect to z, we obtain the following diﬀerential equation

yi(z) = exp(

iκqz)

f (0)

κ

exp(iκqℓ)G′(ℓ)dℓ

.

−

(cid:20)

−

0
Z

(cid:21)

We then set z = 0 in (B.3) and ﬁnd that f (0) =
and integrating once by parts, we arrive at the inverse solution (28).

−

κG(0). Substituting this into (B.5)

(B.3)

(B.4)

(B.5)

