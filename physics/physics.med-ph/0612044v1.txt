6
0
0
2
 
c
e
D
 
5
 
 
]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[
 
 
1
v
4
4
0
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Monte Carlo simulation of the electron transport through thin slabs:
A comparative study of penelope, geant3, geant4, egsnrc and mcnpx

M. Vilches 1, S. Garc´ıa-Pareja 2, R. Guerrero 3, M. Anguiano 4 and A.M. Lallena 4
1Servicio de F´ısica y Protecci´on Radiol´ogica, Hospital Regional Universitario “Virgen de las Nieves”,
Avda. de las Fuerzas Armadas, 2, E-18014 Granada, Spain.
2Servicio de Radiof´ısica Hospitalaria, Hospital Regional Universitario “Carlos Haya”,
Avda. Carlos Haya, s/n, E-29010 M´alaga, Spain.
3Servicio de Radiof´ısica, Hospital Universitario “San Cecilio”,
Avda. Dr. Ol´oriz, 16, E-18012 Granada, Spain.
4Departamento de F´ısica At´omica, Molecular y Nuclear,
Universidad de Granada, E-18071 Granada, Spain.

The Monte Carlo simulation of the electron transport through thin slabs is studied with ﬁve
general purpose codes: penelope, geant3, geant4, egsnrc and mcnpx. The diﬀerent material
foils analyzed in the old experiments of Kulchitsky and Latyshev [Phys. Rev. 61 (1942) 254-266]
[Phys. Rev. 84 (1951) 634-637] are used to perform the comparison between
and Hanson et al.
the Monte Carlo codes. Non-negligible diﬀerences are observed in the angular distributions of the
transmitted electrons obtained with the some of the codes. The experimental data are reasonably
well described by egsnrc, penelope (v.2005) and geant4. A general good agreement is found for
egsnrc and geant4 in all the cases analyzed.

I.

INTRODUCTION

In Monte Carlo (MC) simulation of electron transport, the simulation of all the interactions suﬀered by the electrons
when they go through a material, the so-called detailed simulation (DS), is, in general, unpractical because of the
long computing times required to reduce the electron energies below the absorption threshold. Therefore, DS is done
in practice only if the energy of the electrons is low and/or the targets are thin.

To solve the situation, “condensed history” schemes are employed in much of the usual MC radiation transport
codes of general purpose. In this approach, a certain number of interactions are grouped and described by means of a
multiple scattering theory [1]. In condensed simulation (CS), electrons move in ﬁnite steps whose length is calculated
at the beginning of each step, using, for example, the continuum slowing down approximation and a ﬁxed average
fractional energy loss in the step.

An alternative approach is provided by the so-called mixed simulation schemes, in which DS is used to simulate the
“hard” interactions in which the angular deﬂections and/or the energy losses are larger than certain cut-oﬀ values,
while the interactions which do not fulﬁll these conditions, named “soft”, are described within CS approach.

The statistical models used to determine the energy loss in CS provide good enough results if the tracking steps are
not too big. On the contrary, the statistical treatment of the angular distribution linked to the multiple scattering
is a much more involved task. Since the 40’s a considerable eﬀort has been done to solve the problem and various
models (e.g. Goudsmit and Saunderson, Moli`ere, Lewis) have been developed [2].

Though multiple scattering theories can describe the angular deﬂections produced by both elastic and inelastic
collisions, it has been a common practice to take care of the eﬀects due to inelastic collisions by correcting the
distributions calculated considering only elastic collisions [3]. Only recently, Negreanu et al.
[4] have treated both
elastic and inelastic collisions on the same footing, using accurate partial-wave diﬀerential cross sections.

The importance of the elastic scattering in the interaction of the electrons with the materials and, in particular,
in the dosimetry of these particles, has been pointed out by diﬀerent authors. Andreo et al. [5] studied in detail the
limitations of the implementations of the Moli`ere theory to be used in CS. Li and Rogers [6] compared the egs4 results
with those obtained by integrating analytically the Moli`ere distribution, with those quoted in ICRU Report 35 [7]
and with the experimental data of Hanson et al. [8]. Urb´an [9] carried out a comparison of the angular distributions
obtained with geant4 with the same data.

In the experimental side, the data available are very scarce. To the best of our information, only Kulchitsky and
Latyshev [10] and Hanson et al. [8] have performed measurements of the multiple scattering of electrons in materials.
Kulchitsky and Latyshev [10] studied the scattering of 2.25 MeV electrons by foils of diﬀerent materials from aluminum
to lead. Their data were in good agreement with the Goudsmit and Saunderson theory for the elements Al, Fe, Cu,
Mo, Ag and Sn, while for Ta, Au and Pb they found non-negligible diﬀerences between theory and experiment. On
the other hand, Hanson et al. [8] measured the angular distributions of 15.7 MeV incident electrons scattered by thin
Be and Au foils. For Au they found discrepancies with the predictions of the Goudsmit and Saunderson theory and
agreement with the calculations done according to Moli`ere theory. For Be the experimental data disagreed with the

2

results obtained within the Moli`ere approach.

In this work we analyze how diﬀerent codes describe the scattering of electrons by thin foils of diﬀerent elements.
Results for geant3, geant4, penelope, egsnrc and mcnpx are compared between them and with the few experi-
mental data available. In section 2 we give details concerning the simulations we have performed and the MC codes
which we have used and which are relevant for the calculations performed. Also the way how the data have been
analyzed is discussed. In section 3 we describe brieﬂy the experiments of Kulchitsky and Latyshev [10] and Hanson
et al.
[8]. Section 4 is devoted to discuss the results we have obtained: the calculations with diﬀerent versions of
some of the codes are discussed and the MC results are compared with the experimental data of Hanson et al. [8]
and Kulchitsky and Latyshev [10] and between themselves. In the last section we draw our conclusions.

II. MONTE CARLO SIMULATIONS

The simulations have been carried out using an elementary geometry with a monoenergetic pencil beam impinging
normally on a foil made of a given material and with a given thickness. Both source and foil are in vacuum. The
incident beam deﬁnes the z direction. The directions of the (primary or secondary) electrons emerging from the foils
deﬁne the scattering angles which have been scored in a histogram for angles between 0 and 45 degrees with 180 bins
of 0.25 degrees. The values are normalized to the solid angle unit given in stereoradian.

The statistical uncertainty in each bin is calculated as σ =

Q(1 − Q)/N with Q the value per history in the
bin and N the number of histories followed. Through the paper, these uncertainties are given as a number between
parentheses; e.g., 9.34(1) means 9.34±0.01.

q

A. Monte Carlo codes

As said before, we have performed calculations with various MC codes. All these codes do DS for photons.
Apart from the possible diﬀerences in the photon cross sections, the main diﬀerences between the codes are in the
In what follows we quote some details of the codes which are relevant for the MC
electron/positron transport.
simulations done here.

1. geant3
geant3 [11] is a system of detector description and simulation tools designed for high-energy physics at CERN.
It permits the MC simulation of the transport of elementary particles and diﬀerent ions in elemental or compound
materials for energies ranging between 10 keV and 10 TeV.

The default model for the multiple scattering is based on the Moli`ere theory, but it is possible to select also the
pure Gaussian scattering according to the Rossi formulation [12]. If the number of Coulomb scatters is below 20, the
Moli`ere theory cannot be applied and the simulation is performed within the plural scattering regime in which the
number of scatters is distributed according to a Poisson distribution.

The tracking is controlled by means of a series of parameters. DEEMAX is the maximum fraction of kinetic energy
which a particle can lose in a step. This parameter as well as the multiple scattering introduce upper limits to the
step length. STEMAX provides an absolute upper limit to the step length, in cm, for each tracking medium. STMIN
imposes a lower limit to this step length, also in cm, which permits to accelerate the stopping of those particles with
very small energies. EPSIL determines the boundary crossing precision in cm. In geant3 one can use an automatic
mode for the calculation of these parameter. This is done by selecting AUTO=1. Also, it is possible to ﬁx energy cuts
for the diﬀerent particles. In the calculations we have done, these cuts have been ﬁxed to 10 keV for both photons
and electrons.

In this work we have used the version 3.2114 of geant3. The simulations have been done using the automatic
mode. To check the feasibility of the corresponding results, we have performed simulations for the Au foil of 18.66
mg cm−2 with eight diﬀerent sets of the parameters STEMAX, DEEMAX and STMIN, varying from 0.001 to 0.1, the ﬁrst
two, and from 0.0001 to 0.01, the last one. Despite the fact that this is the most exigent case, because correspond to
the smaller number of interactions, the results obtained are compatible (within the statistical uncertainty) with those
provide by the AUTO=1 option.

2. geant4
geant4 code [13] is an object-oriented C++ toolkit which permits the MC simulation of the radiation transport in
material media for a great variety of particles, materials and energies. For the electromagnetic interactions of photons
and electrons, geant4 permits to use three diﬀerent physics models: Standard, Low-energy and Penelope. In this
work the package Low-energy has been used.

3

The multiple scattering approach used in geant4 has been developed by Urb´an [9] based on the Lewis theory [2].
The energy loss is calculated from the actual path length which is computed in every step after performing a path
length correction. In addition, a lateral displacement and a scattering angle are sampled from given distributions.

In geant4, particles are produced if their energies are above given thresholds which are speciﬁed in terms of
distances, for each volume in the geometry, and internally converted to energy. For the Low-energy model, the
minimum value for these thresholds is 250 eV. In our calculations we have ﬁxed 10 keV for electrons and 1 keV for
photons.

Particles are followed until their kinetic energy is zero, but tracking cuts can be ﬁxed. Other parameters (some
of them not described in the geant4 manuals [14, 15]) provide additional control of electron step. By means of the
G4UserLimits class it is possible to ﬁx a maximum step size and a maximum track length, as well as the tracking cuts
above mentioned. The variable dRoverRange determines the maximum fraction of the stopping range that can be
travelled by an electron in a step. The parameter finalRange ﬁx the minimum step size below which the electron is
absorbed locally. Finally, the fr variable permits to control the step size when the electron is transported away from
a boundary into a new volume. Defaults are dRoverRange=0.2, finalRange=0.2 mm, fr=0.02 and no maximum
step size. These are the values we have used in our simulations.

We have performed test simulations using dRoverRange=0.05, finalRange=1 nm, fr=0.02 and no maximum step
size. No signiﬁcant diﬀerences have been found with respect to the simulations corresponding to the default values.
We have used the versions 8.0 (patch01) of geant4 and g4emlow3.0 of the Low-energy package. Some additional

simulations with the versions 4.1 and 6.0 have also been performed for comparison.

2. penelope
penelope [16] is a general purpose MC code which performs simulations of coupled electron-photon transport. It
can be applied for energies ranging from a few hundred eV up to 1 GeV and for arbitrary materials. Besides, penelope
permits a good description of the particle transport at the interfaces and presents a more accurate description of the
electron transport at low energies in comparison to other general purpose MC codes. Details about the physical
processes considered can be found in [16].

In penelope electrons and positrons are simulated by means of a mixed scheme where, as said above, collisions
are classiﬁed as “hard” and “soft”. The electron tracking is controlled by means of four parameters. C1 and C2 refer
to elastic collisions. C1 gives the average angular deﬂection due to a elastic hard collision and to the soft collisions
previous to it. C2 represents the maximum value permitted for the average fractional energy loss in a step. On the
other hand, Wcc and Wcr are energy cutoﬀs to distinguish hard and soft events. Thus, the inelastic electron collisions
with energy loss W < Wcc and the emission of bremsstrahlung photons with energy W < Wcr are considered in the
simulation as soft interactions. The maximum step size can be controlled using the parameter smax.

We have used two version of this code: 2003 and 2005. In what refers to the multiple scattering the main diﬀerence
between both versions is that elastic electron collisions are simulated by means of a model based on the Wentzel
angular distribution [16] in the version 2003, while in the 2005 these collisions are simulated by using relativistic
(Dirac) partial-wave diﬀerential cross sections generated by using the computer code elsepa [17].

Some of the simulations performed with penelope have been done with a set of parameters which have been used
in diﬀerent simulations in which thin slabs are present (see e.g. [18]). We label these simulations as “safe” and the
values of the parameters used are: Wcc = 5 keV, Wcr = 1 keV, C1 = C2 = 0.05. Photons were simulated down
to 10 keV. Electrons and positrons were absorbed when they slow down to kinetic energies of 100 keV. The mixed
scheme of the simulation in penelope permits to perform fully “detailed” simulations. We have done calculations
also in this approach by selecting Wcc = 0, Wcr = −1000 keV, C1 = C2 = 0. In this case the absorption energies were
ﬁxed to 100 eV for all particles. In all the simulations done with penelope smax was taken to be 1/20 of the width
of the foil, as it is recommended in [16].

2. egsnrc
egsnrc [19] is a general purpose package designed for the Monte Carlo simulation of the coupled transport of
electrons and photons in arbitrary geometries. Particle energies above a few keV up to several hundreds of GeV can
be considered.

Multiple scattering of charged particles is described by means of an approach developed by Kawrakow and Bielajew
[20] in which most of the shortcomings of the Moli`ere multiple scattering theory were ﬁxed. Within this approach,
track steps are simulated using a single scattering model for short steps and a multiple scattering model for large
steps.
In addition one can select between Rutherford scattering or scattering including both relativistic and spin
eﬀects. The electron transport algorithm is due to Kawrakow and Bielajew [21] and it is usually known as presta-ii.
In egsnrc the simulation is controlled by the following parameters: SMAXIR, which deﬁnes upper limits on the step
size in each region in the geometry; ESTEPR, which ﬁxes the maximum fractional energy loss per electron step in each
region; ESTEPE, which is a global energy loss constraint, and XIMAX, which gives the maximum ﬁrst Goudsmit and
Saunderson moment per step. In our simulations, we have used presta-ii (which is the default transport algorithm)

4

and, as indicated in the manual [20], the default values SMAXIR=1010 cm, ESTEPR=1, ESTEPE=0.25 and XIMAX=0.5
must not be changed. The version V4-r2-2-3 has been used for calculations. Photons and electrons were followed
down to 10 keV.

2. mcnpx
mcnpx [22] is a general purpose MC code which permits the description of the transport of diﬀerent particles in
arbitrary materials. Photons, electrons and neutrons, as well as other 29 particles between leptons, baryons, mesons
and even light ions can be considered. The upper energy limits for electrons and photons are 1 and 100 GeV,
respectively. A lower limit of 1 keV is ﬁxed for these particles.

The angular deﬂections in the multiple scattering of electrons are calculated according to the Goudsmit and Saun-
derson theory. When electron energies are below 0.256 MeV, the corresponding cross sections are obtained from
numerical tabulations developed by Riley et al. [23]. For higher energy electrons, the cross sections are approximated
as a combination of the Mott and Rutherford cross sections, including a correction factor which takes care of the
screening.

The particle tracking is governed by EMCPF, which is the upper energy limit for detailed photon physics treatment,
EMAX, which ﬁxes the upper limit for electron energy, and the low energy cutoﬀs. We have used the default value (100
MeV) for EMCPF and EMAX=20 MeV, while the low energy cutoﬀs were ﬁxed to 1 keV. In our simulations we have used
the version 2.4.0.

In the calculations done with mcnpx, the angular distributions obtained by using the binning indicated in Sect. II
showed a stepwise shape in which various neighbour bins had the same value. This is due to the fact that the Goudsmit
and Saunderson angular distribution is sampled by using the inverse transform method applied to a histogram of 34
bins with widths equal or larger than 1 degree. In the cases analyzed here, where few interactions occur, this lack of
precision in the sampling produces wrong results. To solve this problem, the bins in the simulations performed with
mcnpx have been enlarged to 1 degree.

III. DESCRIPTION OF THE EXPERIMENTS

In the two experiments mentioned above, the angular distribution of electrons scattered by foils of diﬀerent materials

and widths were measured.

Kulchitsky and Latyshev [10] studied the scattering of 2.25 MeV electrons by foils of Al, Fe, Cu, Mo, Ag, Sn, Ta, Au
and Pb. The thicknesses (see ﬁrst row in Table I) were chosen in order to maintain the half-width of the distribution
∼10 degrees in all cases, thus ensuring the validity of the multiple scattering theory. Measurements for angles between
0 and 35-40 degrees were done. Electrons with energies in the range 2250±23 keV formed their beam.

The data obtained were compared to the Goudsmit and Saunderson multiple scattering theory predictions. Speciﬁ-
cally, the comparison was done for the angle θ1/e at which the angular distribution reduces by a factor 1/e. Kulchitsky
and Latyshev estimated the uncertainty in θ1/e as 3-4% at most, but they provided only relative values of the distri-
butions measured, what impedes absolute comparisons with our calculations.

Hanson et al. [8] measured the angular distributions of electrons scattered by thin Be (257 and 495 mg cm−2) and
Au (18.66 and 37.28 mg cm−2) foils for 15.7 MeV incident electrons. In the case of Be foils, the measurements were
done up to 6 degrees. For Au foils the angular range was extended up to 30 degrees. The beams included electrons
with energies within 6 percent of the maximum energy.

Hanson et al. compared their experimental data to the predictions of the Goudsmit and Saunderson and the Moli`ere
theories for the angle θ1/e. They do not quote the uncertainties of their measurements but provide absolute values of
the distributions, what allows a more complete comparison.

The results obtained with the diﬀerent MC codes have been compared to the experimental data by means of the
quantities θ1/e and, when possible, F (0). This last corresponds to the maximum of the angular distribution, at θ = 0.

thickness [mg cm
θKul
1/e [deg]
θexp
1/e [deg]

Al Fe Cu Mo Ag Ta Au Pb
7.9

−2] 26.6 15.4 17.15 12.4 11.55 8.9

8.9

9.50 9.60 10.40 10.25 10.20 9.85 9.20 9.70
9.49 9.33 10.61 9.97 10.21 9.91 10.07 9.36

TABLE I: Comparison of the values of the parameter θexp
Latyshev [10] with those quoted by these authors. The thicknesses of the diﬀerent foils are also given.

1/e obtained after reanalyzing the experimental data of Kulchitsky and

5

(1)

1/e [deg] θexp
θHan

1/e [deg] F Han(0) [sr−1] F exp(0) [sr−1]

−2)
Be (257 mg cm
Be (495 mg cm−2)
−2)
Au (18.66 mg cm
−2)
Au (37.28 mg cm

3.06
4.25
2.58
3.76

2.50
3.71

104.06
50.23
144.77
65.66

143.29
64.68

TABLE II: Comparison of the values of the parameters θexp
1/e and F exp(0) obtained after reanalyzing the experimental data of
Hanson et al. [8] with those quoted by these authors. We have not calculated the values for the Be foils because the angular
distributions are not available in Ref. [8].

4.1

6.0

8.0

Al

Be

F (0) [sr

−1] 66.13(8) 40.63(4) 41.84(5)
(495 mg cm−2) θ1/e [deg] 3.762(4) 4.778(5) 4.735(5)
−1] 16.23(2) 11.44(1) 10.83(1)
−2) θ1/e [deg] 7.473(9) 9.17(1) 9.33(1)
−1] 10.13(1) 9.72(1) 9.34(1)
9.51(1) 10.03(1) 10.04(1)

Ta
(8.9 mg cm−2)

F (0) [sr
θ1/e [deg]

(26.6 mg cm

F (0) [sr

TABLE III: Values of the parameters F (0) and θ1/e obtained for the calculations shown in Fig. 1 and performed with the three
versions of geant4 considered in this work. The uncertainties are given at 1σ level.

To do that we have ﬁtted a Gaussian function

F (θ) = F (0) exp

−

θ2
(θ1/e)2 (cid:21)

(cid:20)

to the simulated angular distributions, in the angular range between 0 and the ﬁrst angle larger than θ1/e. The
Levenberg-Marquadt method [24] has been used.

The experimental data of Kulchitsky and Latyshev [10] and Hanson et al. [8] have been reanalyzed following the
same criteria used for the simulated distributions. In this way we have recalculated the “experimental” θ1/e and F (0).
We call the values obtained in this way θexp
1/e and F exp(0), respectively. We give them in Tables I and II where they
1/e and F Han(0). The values F exp(0) have not been
1/e , and [8], θHan
are compared to the values quoted in Refs. [10], θKul
calculated for the experiment of Kulchitsky and Latyshev because the absolute distributions are not available in [10].
On the other hand, the values θexp
1/e and F exp(0) have not been calculated for the Be foils in the experiment of Hanson
et al. because they do not provide the corresponding angular distributions.

In the case of the experiment of Kulchitsky and Latyshev (see Table I), the maximum diﬀerence between our results
and those quoted in Ref. [10] is for Au foil (8.6%). In the case of the Au foils in the experiment of Hanson et al., the
maximum diﬀerence is smaller than 3.5% (see Table II).

To ﬁnish we mention here the fact that there is a mistake concerning the Sn data in the experiment of Kulchitsky
and Latyshev. The thickness quoted in Table 1 of Ref.
[10] is incompatible with the value θ1/e =10.9 degrees they
obtained. All the simulations we have performed disagree by more than 20% with this value. This disagreement can
be seen also in Fig. 5 of Ref. [4] where the data were compared to calculations using the Lewis multiple scattering
theory. We have not considered this foil in our discussion.

IV. RESULTS

A. Comparison of diﬀerent code versions

In the case of geant4 and penelope, diﬀerent versions have been considered in the calculations. Here we compare

the results obtained between them.

In Fig. 1 we show the angular distributions obtained with the versions 4.1, 6.0 and 8.0 of geant4 for three diﬀerent
cases: 15.7 MeV electrons impinging on a Be foil with 257 mg cm−2(upper panel) and 2.25 MeV electrons incident on
Al (medium panel) and Ta (lower panel) foils with 26.6 and 8.9 mg cm−2, respectively. As we can see, the calculations

6

geant4

Be (495 mg cm−2)
Ee =15.7 MeV

v. 8.1

v. 6.0

v. 4.1

Al (26.6 mg cm−2)
Ee =2.25 MeV

Ta (8.9 mg cm−2)
Ee =2.25 MeV

]
1
−
r
s
[

)

θ

(
F

75

50

25

0
20

15

10

5

0
12

9

6

3

0

0

5

20

25

10
15
θ [deg]

FIG. 1: Angular distributions obtained with the versions 8.0 (solid curves), 6.0 (dashed curves) and 4.1 (dotted curves) of the
geant4 code. We show the results for 15.7 MeV electrons impinging in a Be foil with 495 mg cm−2 (upper panel) and for
−2, respectively.
2.25 MeV electrons incident on an Al (medium panel) and Ta (lower panel) foils with 26.6 and with 8.9 mg cm
Statistical uncertainties (1σ) are smaller than 2.5% and have not been plotted.

performed with the versions 6.0 and 8.0 provide rather similar results, while those found for the 4.1 version disagree
with them. The diﬀerences are larger the smaller the atomic number of the foil material is. In order to quantify
these diﬀerences we show, in Table III the values of the parameters F (0) and θ1/e corresponding to these angular
distributions. For Be and Al, θ1/e is 25% larger for the version 8.0 than for the 4.1 one, while for Ta is less than 6%.
On the other hand, for Be and Al, the F (0) value obtained with the version 4.1 is more than 50% larger than for the
version 8.0, while is only 8% larger for Ta. From these results it is evident that the various changes in the details
concerning the multiple scattering theory carried out from version 4.1 till version 8.0 (see [9]) are not at all negligible.
For penelope, the versions 2003 and 2005 have been considered and for each one, both “detailed” and “safe”
simulations have been performed. In Fig. 2 we show the corresponding angular distributions. Full and dotted lines
represent the results of detailed calculations with versions 2005 and 2003 respectively. Dashed and dashed-dotted
curves correspond to the “safe” simulations. The values of the characteristic parameters are given in Table IV. Two
ﬁndings deserve a comment. First, the results obtained with the “safe” simulations are very similar to those obtained
with the “detailed” simulation for the two Be foils (left panels).
In these cases the diﬀerences are 2% at most.
However, for the Au slabs, the diﬀerences between the results obtained in both simulations are larger. For F (0),
these diﬀerences are above 20% for the version 2003 and around 15% for the 2005. The diﬀerences between the values
obtained for θ1/e within “safe” and detailed simulations are around 5% for the version 2003 and slightly larger for
the version 2005. The discrepancies observed between “safe” and “detailed” simulations are linked to the number of
interactions suﬀered by the electrons in the foils. In case of Be, electrons suﬀer ∼ 10 hard interactions in average; for
Au foils, the average number of hard interactions is smaller than 1. As indicated in [16], this makes “safe” simulations
to be into agreement with the “detailed” ones for Be foils and to show the diﬀerences discussed in the case of the Au
foils. By ﬁxing adequately the tracking parameters these diﬀerences can be strongly reduced. For example, in the
case of the thin Au foil, a reduction of the parameter C1 to 0.01 makes the diﬀerence at θ = 0 degrees to diminish

7

penelope
160

Ee =15.7 MeV

120

Be (257 mg cm−2)

Be (495 mg cm−2)

80

40

0
75

50

25

v. 2005

detailed

safe
Hanson et al.

Au (18.66 mg cm−2)

v. 2003

detailed

safe

Au (37.28 mg cm−2)

120

100

80

60

40

20

0
50

40

30

20

10

]
1
−
r
s
[

)

θ

(
F

]
1
−
r
s
[

)

θ

(
F

0

0

2

8

10

0

0

2

4
6
θ [deg]

4
6
θ [deg]

8

10

FIG. 2: Angular distributions obtained with penelope for the four foils of the experiment of Hanson et al.
[8]. Detailed
simulations with the versions 2003 (dotted curves) and 2005 (solid curves) and simulations performed with the “safe” parameter
indicated in the text also with versions 2003 (dashed-dotted curves) and 2005 (dashed curves) are shown. For the two Au foils,
the open circles represent the experimental data. Statistical uncertainties (1σ) are smaller than 2% and have not been plotted.

2003

2005

Be
(257 mg cm−2)
Be

“safe” detailed “safe” detailed
−1] 75.9(1) 76.5(1) 95.8(2) 97.0(2)
F (0) [sr
θ1/e [deg] 3.640(6) 3.620(6) 3.173(5) 3.141(5)
−1] 37.51(8) 37.73(8) 45.7(1) 46.1(1)
F (0) [sr
5.18(1) 5.15(1) 4.595(9) 4.563(9)
θ1/e [deg]
−1] 107.8(2) 119.3(3) 126.6(3) 146.9(3)
F (0) [sr
(18.66 mg cm−2) θ1/e [deg] 3.033(5) 2.796(5) 2.791(5) 2.480(4)
−1] 51.0(1) 53.9(1) 59.4(1) 64.4(1)
−2) θ1/e [deg] 4.376(8) 4.181(8) 4.032(8) 3.763(7)

(37.28 mg cm

(495 mg cm

F (0) [sr

−2)

Au

Au

TABLE IV: Values of the parameters F (0) and θ1/e obtained for the calculations shown in Fig. 2 and performed with the two
versions of penelope considered in this work. The uncertainties are given at 1σ level.

from 14.7 to 6.7%.

The second point to be noted concerns the diﬀerences observed between the two versions of penelope. By com-
paring the results corresponding to the detailed simulations, diﬀerences between 19 and 27% (for F (0)) and 11 and
15% (for θ1/e) are found, the larger diﬀerences occurring for the thin Be slab and the smaller for the thick Au foil.

In addition, the substitution of the modiﬁed Wentzel angular distribution (used in the version 2003) by the relativis-
tic partial-wave diﬀerential cross sections (which incorporates the version 2005) permits, in the case of the detailed
simulations, a very good description of the experimental data for the Au foils (which are plotted in Fig. 2 with open
circles).

In order to go deeper into the diﬀerences observed between the two versions of penelope, we have calculated
the mean values hµi and hµ2i of the quantity µ = (1 − cos θ)/2 which is commonly used to measure polar angular
deﬂections produced by single scattering events, instead of the scattering angle θ. The results of the calculations
for the material foils considered in the experiment of Kulchitsky and Latyshev [10] are shown in Fig. 3. In these
calculations both the forward (0 ≤ θ ≤ 90 deg) and the backward (90 deg ≤ θ ≤ 180 deg) distributions have been
considered to perform the corresponding integrals. It should be pointed out the almost perfect agreement between

the results obtained with the two versions of the code. This was expected according to the fact that, as indicated in
the penelope (v.2003) manual [16], the multiple scattering theory used in this version (the modiﬁed Wentzel model)
was ﬁxed to reproduce the values of hµi and hµ2i obtained for the actual partial-wave diﬀerential cross section which
are used, instead, in penelope (v.2005). In principle, this equality ensures a reasonable description of the multiple
scattering in “normal” simulation conditions with enough interactions. It is clear that in the cases analyzed here
(where electrons go through rather thin foils) the diﬀerences between the models used show up.

In what follows we have considered only the version 8.0 of geant4 and the detailed simulations of the versions

2003 and 2005 of penelope.

B. Comparison with experiment

1/e /θexp

First we have compared the results of the simulations to the experimental data of Kulchitsky and Latyshev [10].
In Fig. 4 we show the ratio of the values θ1/e, obtained with the various MC codes, to the values θexp
1/e , obtained in
our reanalysis of the corresponding experimental data, as a function of the atomic number Z of the foil materials. In
addition, the ratio θKul

1/e is plotted as reference (see circled plus symbols.)

While egsnrc, geant3 and penelope (v.2005) underestimate in all cases the values of θexp

1/e , penelope (v.2003)
overestimates it for all foils and mcnpx and geant4 show, in this respect, a Z dependent behaviour. The diﬀerences
between the values θ1/e obtained for the diﬀerent codes and those we have found in our reanalysis of the experimental
data, which show the maximum and minimum absolute values, are shown in Table V. As we can see, egsnrc and
penelope (v.2005) maintain these diﬀerences within a range of 3%, geant3, geant4 and penelope (v.2003), within
8%, while mcnpx shows a range bigger than 14%.

In order to quantify globally these diﬀerences we have calculated, for each MC code, the sum

S =

1/e − θexp
θi

1/e

Xi (cid:16)

2

,

(cid:17)

8

(2)

pen 2003

1.9

pen 2005

Ee =2.25 MeV

2.1

1.7

1.5

 

 

 

 
5

4

3

]
2
−
0
1
·
[

i
µ
h

]
3
−
0
1
·
[

i
2
µ
h

2

0

20

40

60

80

100

Z

FIG. 3: Values of hµi (upper panel) and hµ2i (lower panel) as a function of the atomic number Z of the foil materials in the
experiment of Kulchitsky and Latyshev [10]. Detailed simulations with the versions 2003 (open circles) and 2005 (black points)
of penelope are shown. Statistical uncertainties (1σ) are smaller than the symbols used to plot the results.

9

Kulchitsky & Latyshev

egsnrc
mcnpx
geant3
geant4
pen 2003
pen 2005

p
x
e

e
/
1

θ
/
e
/
1
θ

1.0

1.1

 

 

 

0.9

 

0

Ee =2.25 MeV

20

40

60

80

100

Z

FIG. 4: Ratio of the values θ1/e obtained with the various MC codes to the values θexp
1/e obtained in our reanalysis of the
corresponding experimental data as a function of the atomic number Z of the foil materials in the experiment of Kulchitsky
and Latyshev [10]. Circled plus symbols correspond to the ratio between the values θKul
1/e quoted by Kulchitsky and Latyshev
(see Table I) and θexp
1/e . The lines between symbols are only to guide eyes. Uncertainties are considered at the 1σ level and in
most cases are smaller than the symbols used to represent the data.

egsnrc

mcnpx

geant3

geant4

pen 2003

pen 2005

-8.7% (Ag) 10.9% (Mo) -11.2% (Ta) 4.4% (Pb) 11.6% (Pb) -7.8% (Cu)
-5.1% (Pb)
-3.5% (Al) -3.5% (Cu)
-6.5% (Fe) -3.7% (Cu)
3.1

4% (Ag)
4.3

5.2

4.9

0.5

1.9

S [deg2]

TABLE V: Relative diﬀerences (θ1/e−θexp
1/e with maximum (ﬁrst row) and minimum (second row) absolute values, obtained
for each MC code for the foils in the experiment of Kulchitsky and Latyshev [10]. The corresponding foil materials are given.
Last row shows the values of S as deﬁned by Eq. (2).

1/e )/θexp

where i runs over the eight diﬀerent foils considered. The better codes correspond to those with the smaller values of
S. The results obtained are shown in the last row of Table V. On the base of this index, the “best” results are those
obtained with geant4 while the large discrepancies are obtained with geant3, egsnrc and penelope (v.2003).

A slightly diﬀerent situation is found when we compare the results of our simulations to the experimental data of
Hanson et al. [8]. In Fig. 5 we show the ratio of the values θ1/e (upper panels) and F (0) (lower panels) obtained with
the various MC codes to the values θexp
1/e and F exp(0), respectively, for the two Au foils in the experiment of Hanson
1/e and F Han(0) quoted by Hanson et al. (see
et al. [8]. The dashed lines represent the ratios between the values θHan
Table II) and θexp
1/e or F exp. As we can see, egsnrc, geant3, geant4 and penelope (v.2005) provide a very good
description of the experiment, mcnpx slightly overestimates (underestimates) θexp
1/e (F exp(0)) and penelope (v.2003)

Au (18.66 mg cm−2)

Au (37.28 mg cm−2)

10

e gs nrc

m c n p x

g e a n t3

g e a n t4
pe n 2003

pe n 2005

e gs nrc

m c n p x

g e a n t3

g e a n t4
pe n 2003

pe n 2005

FIG. 5: Ratio of the values θ1/e (upper panels) and F (0) (lower panels) obtained with the various MC codes to the values θexp
1/e
and F exp(0), respectively, obtained in our reanalysis of the data for the two Au foils in the experiment of Hanson et al. [8].
The dashed lines represent the ratios between the values θHan
1/e or
F exp. Uncertainties are considered at the 1σ level and are smaller than the symbols used to represent the data.

1/e and F Han(0) quoted by Hanson et al. (see Table II) and θexp

Be (257 mg cm−2)

Be (495 mg cm−2)

Ee =15.7 MeV

Ee =15.7 MeV

1.2

1.1

1.0

0.9

0.8
1.2

1.1

1.0

0.9

0.8

1.3

1.2

1.1

1.0

0.9
1.1

1.0

0.9

0.8

0.7

p
x
e

e
/
1
θ
/
e
/
1
θ

)
0
(
p
x
e

F
/
)
0
(
F

n
a
H

e
/
1
θ
/
e
/
1
θ

)
0
(

n
a
H
F
/
)
0
(
F

e gs nrc

m c n p x

g e a n t3

g e a n t4
pe n 2003

pe n 2005

e gs nrc

m c n p x

g e a n t3

g e a n t4
pe n 2003

pe n 2005

FIG. 6: Ratio of the values θ1/e (upper panels) and F (0) (lower panels) obtained with the various MC codes to the values
θHan
1/e and F Han(0), respectively, quoted for the Be foils in the experiment of Hanson et al. [8] (see Table II). Uncertainties are
considered at the 1σ level and are smaller than the symbols used to represent the data.

gives the “worst” results. The excellent agreement found for geant4 is not surprising because the multiple scattering
theory developed by Urb´an and which is used in this code has been tuned to reproduce these Au experimental data
[9].

Fig. 6 shows the comparison with the experimental results of Hanson et al. [8] for the two Be foils. As said before,
data are not available for these foils and we could not perform the corresponding reanalysis. In this case we have
used directly the values θHan
1/e and F Han(0) quoted by Hanson et al. (see Table II) as reference values. Here the “best”
description of the experiment is provided by egsnrc, mcnpx and penelope (v.2005). geant3 and geant4 show very
similar results and the major diﬀerences occur for penelope (v.2003), reaching values around 20% or even larger,

both for θ1/e and F (0). On the other hand, and as in the case of the Au slabs, relative results are rather similar for
both foils.

11

120

100

80

60

40

20

0
50

40

30

20

10

]
1
−
r
s
[

)
θ
(
F

]
1
−
r
s
[

)
θ
(
F

Ee =15.7 MeV
160

pen 2005

geant3

geant4

pen 2003

egsnrc

mcnpx

Be (257 mg cm−2)

Au (18.66 mg cm−2)

Be (495 mg cm−2)

Au (37.28 mg cm−2)

120

80

40

0
75

50

25

0

0

2

8

10

0

0

2

4
6
θ [deg]

4
6
θ [deg]

8

10

FIG. 7: Angular distributions obtained with the various MC codes for the four foils of the experiment of Hanson et al.
Statistical uncertainties (1σ) are smaller than 2% and have not been plotted.

[8].

C. Comparison of the simulations

To ﬁnish the discussion we compare now the angular distributions obtained with the diﬀerent simulation codes.
In Fig. 7 we show these distributions for the four foils of the experiment of Hanson et al. [8]. As we can see, the
behaviour observed is diﬀerent in the case of the Be foils (left panels) than in the Au ones (right panels). For Be,
the calculations performed with egsnrc (dashed-dotted curves) show the maximum values F (0), and are in rather
good agreement with the results obtained with penelope (v.2005) (solid curves) and mcnpx (solid triangles). The
geant3(dashed curves) and geant4 (open squares) results overlap for all values of θ and, ﬁnally, the penelope
(v.2003) (dotted curves) are clearly below the other calculations at small angles. The relative diﬀerences between the
maximum and minimum values of F (0) are 33% and 26.3% for the thin and the ticker foils, respectively.

In the case of the Au foils (see right panels), the situation of the penelope (v.2003) results is the same, but the
other calculations are all of them grouped. This is particularly clear in the case of the thicker foil (lower right panel).
The results obtained for the diﬀerent foils considered by Kulchitsky and Latyshev [10] show up a diﬀerent behaviour.
In Fig. 8 we have plotted the angular distributions corresponding to the Al, Fe, Ag and Au foils. Similar results
are found for the other four foils studied in this experiment. penelope (v.2003) provides the smaller F (0) values in
all cases except for Mo, in which mcnpx is the code showing the minimum. egsnrc shows the larger values for Al,
Fe and Cu and geant3 for the remaining foils. As we can see, the results appear to be spread for forward angles
and the spreading increases with the atomic number of the material. The relative diﬀerences between the maximum
and minimum values of F (0) range between 17.3% for Cu to 45.9% for Pb, being ∼ 20% for Al and Fe. In all cases
analyzed, penelope (v.2005) and egsnrc are in good agreement.

To ﬁnish, it is worth to point out the situation observed for the Au foils. As we can see (lower right panel in Fig. 8)
the various codes produce rather diﬀerent angular distributions for θ < 8 degrees. This contrasts with the overlapping
shown by the results corresponding to the Au foils in Fig. 7 (see right panels.)

12

Ee =2.25 MeV

pen 2005

geant3

geant4

pen 2003

egsnrc

mcnpx

Al
(26.6 mg cm−2)

Ag
(11.55 mg cm−2)

Fe (15.4 mg cm−2)

Au (8.9 mg cm−2)

]
1
−
r
s
[

)
θ
(
F

]
1
−
r
s
[

)
θ
(
F

 
12
 
 
9
 
 
6
 
 
3
 
 
0
 
12
 
 
9
 
 
6
 
 
3
 
 
0

0

4

8

12

16

20

0

4

8

12

16

20

θ [deg]

θ [deg]

FIG. 8: Same as in Fig. 7 but for the Al, Fe, Ag and Au foils in the experiment of Kulchitsky and Latyshev [10].

V. CONCLUSIONS

In this work the experimental data available for multiple scattering by thin material foils have compared to the
simulation results obtained with the MC codes egsnrc, mcnpx, geant3, geant4, penelope (v.2003) and penelope
(v.2005).

Simulations performed with various older versions of geant4 show up non-negligible diﬀerences in the angular

distributions with respect to the version 8.0, diﬀerences which are bigger the lower the Z of the material is.

Diﬀerent simulations done with penelope have indicated large diﬀerences in the angular distributions between
the versions 2003 and 2005, though the mean values hµi and hµ2i obtained with both versions are very similar, as
expected. In addition, we have found discrepancies between the “safe” and “detailed” simulations which are related
to the number of interactions suﬀered by the electrons in the foil and which can be largely reduced by an adequate
selection of the tracking parameters.

We have compared the results of our simulations with the experimental data of Kulchitsky and Latyshev [10] by
means of the characteristic angle θ1/e. We have found that both egsnrc and penelope (v.2005) show diﬀerences
with respect to θexp
1/e which are within a range of 3% for all foils. However, the better description of the experimental
data is provided, globally, by geant4.

The comparison with the results of Hanson et al. [8] shows that egsnrc, geant3, geant4 and penelope (v.2005)
give a good description of the data in the case of the Au foils. For the Be foils, the better agreement with the
experiment occurs for egsnrc, mcnpx and penelope (v.2005).

All codes (except penelope (v.2003)) show a good agreement for the two Au foils in the experiment of Hanson et
al. For the Be foils, the maximum relative diﬀerences between the codes at θ = 0 are larger than 25%. In the case
of the foils in the experiment of Kulchitsky and Latyshev, these maximum relative diﬀerences grow with Z, reaching
∼ 50% in the case of the Pb foil. In general, egsnrc and penelope (v.2005) are in rather good agreement for all
cases studied.

The eﬀects observed in these thin material foils appear to be non-negligible. Diﬀerences between the various
MC codes are relevant and the propagation of them to other situations should be investigated in detail. One of
these situations concerns the simulation of electron linear accelerators, where diﬀerent thin foils are present. The
combined eﬀect of all of them could modify the conclusions found in previous works in which various codes have been
intercompared (e.g. in Ref. [18].)

On the other hand it should be interesting to perform new experiments with diﬀerent materials in order to permit

a complete test of the multiple scattering theories used in the MC simulation codes of the radiation transport.

VI. ACKNOWLEDGMENTS

13

We want to acknowledge useful discussions with F. Salvat, J.M. Fern´andez-Varea, M.A. Coca and D. Guirado. This
work has been supported in part by the Junta de Andaluc´ıa (FQM0220) and by the Ministerio de Educaci´on y Ciencia
of Spain (FIS2005-03577).

[1] M.J. Berger, in: Methods in Computational Physics, vol. 1, Academic Press, New York, 1963.
[2] W.T. Scott, Rev. Mod. Phys. 35 (1963) 231-313.
[3] M.J. Berger, R. Wang, in: Monte Carlo Transport of Electrons and Photons, T.M. Jenkins, W.R. Nelson, A. Rindi (Eds.),

Plenum Press, New York, 1988.

[4] C. Negreanu, X. Llovet, R. Chawla, F. Salvat, Rad. Phys. Chem. 74 (2005) 264281.
[5] P. Andreo, J. Medin, A.F. Bielajew, Med. Phys. 20 (1993) 1315-1325.
[6] X.A. Li, D.W.O. Rogers, Med. Phys. 22 (1995) 531-541.
[7] Radiation dosimetry: electron beams with energies between 1 and 50 MeV, ICRU Report 35, ICRU, Bethesda, 1984.
[8] A.O. Hanson, L.H. Lanzl, E.M. Lyman, M.B. Scott, Phys. Rev. 84 (1951) 634-637.
[9] L. Urb´an, Multiple scattering model in GEANT4, available at

http://doc.cern.ch/archive/electronic/cern/preprints/open/open-2002-070.pdf

[10] L.A. Kulchitsky, G.D. Latyshev, Phys. Rev. 61 (1942) 254-266.
[11] GEANT - Detector description and simulation tool, CERN Program Library Long Write-up W5013, CERN, Geneva, 1993.
[12] B. Rossi, K. Greisen, Rev. Mod. Phys. 13 (1941) 240-309.
[13] S. Agostinelli et al., Nucl. Instrum. Methods Phys. Res. A 506 (2003) 250-303.
[14] http://geant4.web.cern.ch/geant4/G4UsersDocuments/UsersGuides/

PhysicsReferenceManual/html/PhysicsReferenceManual.html

[15] http://geant4.web.cern.ch/geant4/G4UsersDocuments/UsersGuides/

ForApplicationDeveloper/html/index.html

[16] F. Salvat, J.M. Fern´andez-Varea, J. Sempau, PENELOPE - A code system for Monte Carlo simulation of electron and

photon transport, NEA-OECD, Paris, 2003.

[17] F. Salvat, A. Jablonski, C.J. Powell, Comput. Phys. Commun. 165 (2005) 157-190.
[18] J. Sempau, A. S´anchez-Reyes, F. Salvat, H. Oulad ben Tahar, S.B. Jiang, J.M. Fern´andez-Varea, Phys. Med. Biol. 46

[19] I. Kawrakow, D.W.O. Rogers, The EGSnrc code system: Monte Carlo simulation of electron and photon transport, NRCC

(2001) 1163-1186.

Report PIRS-701, NRC, Otawa, 2003, available at
http://www.irs.inms.nrc.ca/inms/irs/EGSnrc/EGSnrc.html

[20] I. Kawrakow, A.F. Bielajew, Nucl. Instrum. Methods Phys. Res. B 134 (1998) 325-336.
[21] I. Kawrakow, A.F. Bielajew, Nucl. Instrum. Methods Phys. Res. B 142 (1998) 253-280.
[22] Monte Carlo N-Particle Transport Code System for Multiparticle and High Energy Applications, RSICC Computer Code

Collection Report CCC-715, LANL, Los Alamos, 2002.

[23] M.E. Riley, C.J. MacCallum, F. Biggs, Theoretical electron-atom elastic scattering cross sections, selected elements, 1 keV

to 256 KeV, Atom. Data and Nucl. Data Tables 15 (1975) 443-

[24] W.H. Press, S.A. Teukolsky, W.T. Vetterling, B.P. Flannery, B.P., Numerical recipes in Fortran77: The art of scientiﬁc

computing, Cambridge University Press, Cambridge, 1992.

