6
0
0
2
 
c
e
D
 
5
 
 
]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[
 
 
1
v
5
4
0
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Dose distribution in water for monoenergetic photon point sources in the energy
range of interest in brachytherapy: Monte Carlo simulations with PENELOPE and
GEANT4

Julio F. Almansa 1, Rafael Guerrero 2, Feras M.O. Al-Dweri 3, M. Anguiano 3 and A.M. Lallena 3
1) Servicio de Radiof´ısica y Protecci´on Radiol´ogica,
Hospital Universitario “Puerta del Mar”, E-11009 C´adiz, Spain.
2) Servicio de Radiof´ısica, Hospital Universitario “San Cecilio”,
Avda. Dr. Ol´oriz, 16, E-18012 Granada, Spain.
3) Departamento de F´ısica At´omica, Molecular y Nuclear,
Universidad de Granada, E-18071 Granada, Spain.

Monte Carlo calculations using the codes PENELOPE and GEANT4 have been performed to
characterize the dosimetric properties of monoenergetic photon point sources in water. The dose
rate in water has been calculated for energies of interest in brachytherapy, ranging between 10 keV
and 2 MeV. A comparison of the results obtained using the two codes with the available data
calculated with other Monte Carlo codes is carried out. A χ2-like statistical test is proposed for these
comparisons. PENELOPE and GEANT4 show a reasonable agreement for all energies analyzed and
distances to the source larger than 1 cm. Signiﬁcant diﬀerences are found at distances from the
source up to 1 cm. A similar situation occurs between PENELOPE and EGS4.

PACS numbers: 87.53.wZ, 87.53.Vb, 87.53.Jw, 87.53.Bn

I.

INTRODUCTION

Dosimetry of monoenergetic point sources is interesting from diﬀerent points of view. Dose distributions around
more complex sources (e.g. polyenergetic sources or sources with ﬁnite dimensions) can be calculated using the
monochromatic source data, providing the corresponding modiﬁcations to account for the source geometry and the
capsule materials are made.

Dose distributions generated by monoenergetic point sources constitute a crucial test to compare Monte Carlo (MC)
radiation transport codes, because the diﬀerences observed in the simulation results can be linked to the basic physics
taken into account by these codes.

In case of photons, the most complete available databases of dose distributions in water for monoenergetic point
sources are those of Berger [5] and Luxton and Jozsef [12]. Berger solved the one-dimensional Boltzmann transport
equation and showed results for energies ranging between 15 keV and 3 MeV. He provided polynomial expansions of
the energy-absorption buildup factors needed to calculate the corresponding dose rates.

More recently, Luxton and Jozsef [12] have used the EGS4 MC code to determine these dose distributions for
10 keV to 2 MeV photons. These authors have found a good agreement with Berger’s results (within 1%) between 40
and 400 keV. Some discrepancies have been quoted for energies below 40 keV, where diﬀerences reach 4-5%. Above
500 keV, Luxton and Jozsef have found a buildup in the radial dose distribution not shown in the results of Berger.
Between 1 and 2 MeV, discrepancies are ∼4%. Finally, EGS4 results suggest an additional structure at ∼3 cm from
the 2 MeV source, which the authors have guessed to be an artifact of the MC simulation.

The MC code PENELOPE (v. 2001) [17] has been benchmarked for low-energy photons (10-150 keV) by Ye et al.
[20]. These authors have compared the doses calculated with PENELOPE and MCNP4C to the results of Luxton
and Jozsef [12] obtained with EGS4. They paid special attention to the diﬀerences due to the various libraries used:
EPDL97 [6] for PENELOPE, DLC-200 [7] and the updated DLC-146 for MCNP4C and PHOTX [16] for EGS4. Ye et
al. found that all the results agreed rather well except those obtained with MCNP4C and the DLC200 library below
100 keV for which the dose rates are up to 9% lower than for the other cases.

In their MC simulations, Ye et al. [20] used a cylindrical liquid water phantom with 30 cm diameter. For energies
above 100 keV, Ye et al. observed discrepancies between their calculations and those of Luxton and Jozsef [12] which
they ascribed to the fact that these authors used an inﬁnite water phantom.

In this work, new simulations of monoenergetic photon point sources in the range 10 keV to 2 MeV embedded in
water are performed using the MC codes PENELOPE [17, 18] and GEANT4 [1, 9]. Our purpose is to benchmark the
PENELOPE and GEANT4 codes for this energy range by intercomparing our results with those found by Luxton
and Jozsef [12], with EGS4, and by Ye et al. [20], also with PENELOPE but with a diﬀerent scoring geometry.

2

(1)

(2)

(3)

II. MATERIAL AND METHODS

A. Monte Carlo codes

In this work PENELOPE (v. 2001) [17] and (v. 2003) [18] and GEANT4 [1, 9] (v. 4.5.2) MC codes have been used

to perform the simulations.

PENELOPE is a general purpose MC code which performs simulations of coupled electron-photon transport. It can
be applied for energies ranging from a few hundred eV up to 1 GeV and for arbitrary materials. Besides, PENELOPE
permits a good description of the particle transport at the interfaces and presents a more accurate description of
the electron transport at low energies in comparison to other general purpose MC codes. These characteristics make
PENELOPE to be an useful tool for medical physics applications as previous works have pointed out [see e.g. 2, 3, 19].
Details about the physical processes considered can be found in Salvat et al. [17, 18].

GEANT4 is a toolkit for simulating the passage of particles through matter for applications in high energy physics,
nuclear experiments, medical physics studies, etc. Due to its purpose, the available energy range and the possible
particles to be simulated are much larger than in PENELOPE. GEANT4 includes low energy packages which permit
to extend the validity range of particle interactions for electrons, positrons and photons down to 250 eV, and can be
used up to approximately 100 GeV. A general description of the GEANT4 toolkit can be found in Agostinelli et al.
[1]. A detailed documentation concerning the physics involved can be found in GEANT4 [9]. In our calculations the
low-energy package G4EMLOW.2.3 has been used.

B. Simulations

In the simulations performed we have used an inﬁnite water phantom which we have labeled Pinf . In this case the
scoring voxels have been chosen to be concentric spherical shells with thickness 0.5 mm and centered in the point
source. The size of these scoring voxels avoids the possible volume averaging artifacts that could appear using larger
voxels.

Besides, we have performed additional simulations with a spherical ﬁnite phantom with a radius of 15 cm, ﬁlled
with water and with the point source situated at its center. We have labeled Pﬁn this phantom and we have used the
same scoring voxels as in Pinf.

As the sources studied are point sources, the diﬀerent quantities simulated (e.g., the dose rate,

˙D(r)), depend on

the distance between the target point and the source, r.

In our simulations, the energy deposited in each voxel j, Ej, was scored to obtain the histograms corresponding to
˙D(r). We labeled ˙Dj the value corresponding to the j-th voxel. In order to avoid the eﬀect of the geometric factor
(r−2 in this case) which dominates ˙D(r), we have calculated also the quantity

We have simulated this quantity by scoring directly (r2E), thus obtaining Rj for each scoring shell j. However, in
common practice (see e.g. Luxton and Jozsef 1999), this quantity is calculated as

for each bin j of the histogram corresponding to ˙D(r). In this equation

R(r) = r2 ˙D(r) .

Rj

M = (rj

M)2 ˙Dj ,

rj
M =

> + rj
rj
<
2

,

with rj
The

< and rj
results

> the minimum and maximum r values corresponding to the j-th “detector” voxel.
can

in
Pinf
http://fm137.ugr.es/PhotonPointSources/ for both PENELOPE (v.
2003) and GEANT4. A total of 40
energies in the range between 10 keV and 2 MeV have been considered. In these tables, also the air kerma strengths
and the dose rate constants calculated with PENELOPE and GEANT4 are given.

obtained with

for R(r)

phantoms

found

and

Pﬁn

the

be

PENELOPE considers analog simulation for photons. Electrons and positrons are simulated by means of a mixed
scheme in which collisions are classiﬁed as “hard” and “soft”. Hard collisions are characterized by a scattering angle

C. Simulation parameters

or an energy loss larger than certain cutoﬀ values and are individually simulated. A multiple scattering theory is used
to describe the soft collisions, in which the polar angular deﬂection and the energy loss are below the threshold values.
The electron tracking is controlled by means of four parameters. C1 and C2 refer to elastic collisions. C1 gives the
average angular deﬂection due to a elastic hard collision and to the soft collisions previous to it. C2 represents the
maximum value permitted for the average fractional energy loss in a step. On the other hand, Wcc and Wcr are energy
cutoﬀs to distinguish hard and soft events. Thus, the inelastic electron collisions with energy loss W < Wcc and the
emission of bremsstrahlung photons with energy W < Wcr are considered in the simulation as soft interactions. In
addition the maximum step size can be controlled using the parameter smax.

In our simulations with PENELOPE, the parameters were ﬁxed to the following values: Wcc = 10 keV, Wcr = 1 keV,
C1 = C2 = 0.05. Photons were simulated down to 1 keV. Electrons and positrons were absorbed when they slow
down to kinetic energies of 10 keV. We have checked that the use of lower values for these parameters does not cause
changes in the results. Finally, smax was taken to be 1035 cm.

In case of GEANT4 simulations, it is necessary to choose a range threshold for each particle type. This threshold is
converted, internally, to an energy threshold below which secondary particles are not emitted. In our calculations the
range thresholds have been ﬁxed to values providing energy thresholds of 1 keV and 10 keV for photons and electrons,
respectively. Besides, one can select for electrons the values of the maximum step size, the variable dRoverRange,
which is the maximum fraction of the stopping range that an electron can travel in a step, the variable f inalRange,
which establishes the limit for the gradual reduction of the step size, and, ﬁnally, the variable fr, which controls the
step size when the electron is transported away from a boundary into a new volume. In our simulations we have
used the default values for these parameters (no maximum step size, dRoverRange = 1, f inalRange = 1 mm, and
fr=0.2). We have performed a series of calculations using dRoverRange = 0.01 and f inalRange = 100 nm. These
values were used by Poon et al. [13] to investigate the consistency of GEANT4 in geometries including ionization
chambers, which is a more exigent situation than ours concerning the electron transport. However, we have not found
any diﬀerence between the results obtained with this new set of parameters and the previous one, in the energy range
we have considered.

D. Statistics

j

E

=

1
N

N

Ej
i .

In the simulations we scored the energy deposited by all the particles of the i-th history (that is, including the
i . This permits

primary particle and all the secondaries it generates) in the j-th voxel. We label the value obtained Ej
to obtain the MC estimate of the average value of Ej (per initial particle), which is given by

i=1
X
Here N is the number of simulated histories. In addition, (Ej
uncertainties which are given by

i )2 was also scored in order to calculate the statistical

i=1
X
We have proceed in a similar way with (r2E)j. The uncertainties given below correspond to 1σ. Except when
explicitly mentioned, all simulations have been performed following 3 · 107 histories. This permitted us to maintain
these statistical uncertainties under reasonable levels.

N

1
N "

1
N

(Ej

i )2 − (E

j

)2

.

#

σEj =

v
u
u
t

E. Comparison of histograms

The usual outputs of the MC simulations of radioactive sources include histograms corresponding to the magnitudes
of interest. Then, the benchmark of the codes used is done by comparing either the histograms by-eye in a ﬁgure or
a restricted set of values corresponding to diﬀerent bins in a table.

To gain more insight, it is useful to plot the relative diﬀerence between the two histograms H1 and H2, which is

given by

∆j

H1,H2 =

H j

1 − H j
2
H j
1

,

3

(4)

(5)

(6)

4

℄

%

[

(cid:1)

2

1

R

;

R

1.0

0.0

-1.0

 
0.5

0.0

-0.5
 

1.0

0.0

-1.0

 

 

 

 

 

 

 

 

R

(cid:17) [R(r)℄

R

(cid:17) [R(r)℄

(a)

1

PENELOPE#1

2

PENELOPE#2

R

(cid:17) [R(r)℄

R

(cid:17) [R(r)℄

(b)

1

PENELOPE#1

2

PENELOPE#2

3 (cid:1) 10

histories

7

3 (cid:1) 10

histories

8

R

(cid:17) [R(r)℄

R

(cid:17) [R(r)℄

()

1

PENELOPE#1

2

GEANT4

3

4

5

7

8

9

10

11

3 (cid:1) 10

histories

7

6

r [m℄

FIG. 1: Relative diﬀerences in percentage, as given by Eq. (6), between the values of the quantity R(r) obtained in diﬀerent
calculations, as a function of the distance to the source r and for 80 keV photons. Panels (a) and (b) correspond to the two
calculations performed with PENELOPE for 3 · 107 and 3 · 108 histories, respectively. Panel (c) corresponds to the diﬀerence
between the ﬁrst calculation with PENELOPE and the GEANT4 one for 3 · 107 histories. Open circles (black squares) represent
the results for which the value zero is (not) statistically compatible at the 1σ level.

for the diﬀerent bins j.

To illustrate a typical situation, we show in Fig. 1, the relative diﬀerences, ∆j

R1,R2, in percentage, between the
quantities R(r) obtained in various calculations, as a function of r and for 80 keV photons. Open circles (black
squares) correspond to the bins for which the zero diﬀerence is (not) reached at the 1σ level.

In panel (a) the two simulations compared have been performed with PENELOPE (v. 2003), but using two diﬀerent
seeds for the random number generator. A total of 3 · 107 histories have been followed in this case. It is obvious that
these two simulations must be identical. However, as we can see, there are some bins for which both calculations are
compatible, but some of them are statistically diﬀerent, even if the diﬀerences are really small (below ∼1%). Then, it
is evident that, depending on the particular subset of bins selected, one could conclude that the agreement between
the two calculations is almost perfect or exactly the opposite.

Increasing the number of histories does not solve the problem. In panel (b) we show the relative diﬀerences obtained
in a similar situation to that plotted in panel (a), but following 3 · 108 histories. We observe that the general trend
is the same in both panels, the only diﬀerence being that now the values of ∆j
R1,R2 are smaller when the number of
histories increases. But, again, it is still possible to select a subset of individual bins for which the two simulations
appear to be statistically diﬀerent or very similar. Same situation is found if, instead of increasing the number of
histories, the voxel volume is enhanced.

Finally, in panel (c) we compare two simulations done with PENELOPE (v. 2003) and GEANT4 for 3·107 histories.
Despite the fact that, now, two really diﬀerent simulations are compared, the values obtained for ∆j
R1,R2 are similar
to those plotted in panel (a) and, as in the previous cases, one should conclude that both calculations are identical
or completely diﬀerent by adequately choosing particular bins for the comparison. However, in this particular case
there is an additional fact to be taken into account: we observe a certain bias pointed out by the presence of a larger
number of black squares with a negative value of the relative diﬀerence.

In order to avoid the possible errors linked to a restricted comparison between histograms, we propose to use a

χ2-type statistic deﬁned as

2
H1,H2 =

χ

2)2
(H j
1 − H j
2)2 ,
1)2 + (σj
(σj

M

j=1
X

(7)

5

1 and H j

2 label the value in the j-th bin of the ﬁrst and second histograms, respectively, and σj

where H j
corresponding uncertainties. One can state that two histograms are similar if χ2
degrees-of freedom (the number of histogram bins in our case). A value of χ2
of correlations between the quantities scored in the histograms. On the other hand, a value of χ2
indicate a discrepancy between the histograms [8, 15]. The uncertainty of the quantity χ2 is given by
the three cases considered in Fig. 1, the values of χ2/M are 0.96±0.04, 0.97±0.04 and 1.39±0.05, respectively.

2 are the
H1,H2 /M ∼ 1, M being the number of
H1,H2 /M below 1 points out the presence
H1,H2 /M > 1 would
2χ2 [8]. In

Besides, to estimate the signiﬁcance of this χ2 test, we have used the standard chi-square probability function
Q(χ2|M ) [15]. The smaller this probability is, the bigger the diﬀerences between the two histograms are. Following
Press et al. [15] we can state that if Q ≥ 0.1 the agreement between both histograms is believable. If 0.001 ≤ Q < 0.1
the agreement is acceptable. Finally, if Q < 0.001 both histograms have signiﬁcant diﬀerences. In the two ﬁrst cases
shown in Fig. 1, the values of Q(χ2|M ) are 0.807 and 0.755, respectively. In the case of the comparison between
PENELOPE and GEANT4 (panel (c)) this probability is 2.88·10−15, much smaller than 0.001.

1 and σj

p

III. RESULTS

A. Comparison between PENELOPE (v. 2001) and (v. 2003).

Before analyzing the obtained results, it is worth to point out that we have found small diﬀerences between the
calculations performed with the two versions of PENELOPE. These diﬀerences appear mainly for the larger energies
considered. This can be seen in panel (a) of Fig. 2 where the values of the χ2
R1,R2 /M , obtained for calculations
done with PENELOPE versions 2003 (R1) and 2001 (R2) and with the phantom Pinf , are shown as a function of the
initial photon energy. As we can see, the values of the quantity χ2
R1,R2 /M obtained are close to 1, thus indicating the
statistical consistency between the calculations performed with both versions of the code. The probabilities Q(χ2|M )
obtained are above 0.1 for all energies between 10 keV and 1 MeV, except for 60 and 250 keV where this probability
is 0.06 in both cases. Above 1 MeV the two histograms show signiﬁcant diﬀerences, the probabilities found being
smaller than 0.001. In panel (b) of Fig. 2 we have plotted the relative diﬀerences, as given by Eq. (6), between the
values of the quantity R(r) obtained with the two versions of PENELOPE for an initial energy of 1.5 MeV. Therein
the meaning of black squares and open circles is the same as in Fig. 1. As can be seen the discrepancy is mainly due

2

1

R

;

R

2

M
=

(cid:31)

℄

%

[

(cid:1)

2

1

R

;

R

2.0

1.5

1.0

0.5

 

3

2

1

0

-1

0

R

(cid:17) [R(r)℄

1

PENELOPE (v: 2003)

R

(cid:17) [R(r)℄

2

PENELOPE (v: 2001)

10

102

103

E

[keV℄

initial

(a)

 

E

= 1500 keV

initial

(b)

1

2

3

r [m℄

FIG. 2: Panel (a): Values of χ2
R1,R2 /M , as given by Eq. (7), calculated for the quantity R(r), as a function of the energy of
the initial photons. Panel (b): Relative diﬀerences in percentage, as given by Eq. (6), calculated for the same quantity, as a
function of the distance to the source r and for photons with initial energy of 1500 keV. The calculations compared have been
done with the two versions of PENELOPE. The meaning of the open circles and the black squares in panel (b) is the same as
in Fig. 1.

6

to the ﬁrst few bins of the corresponding histograms. In fact, if one does not consider the ﬁrst bins for which the
relative diﬀerences are larger than 1.5%, a probability Q(χ2|M ) > 0.001 is obtained.

The reason for these diﬀerences between both versions of the MC code PENELOPE can be ascribed to the modiﬁ-
cations introduced in the version 2003 with respect to the 2001 one [17, 18]: the X-ray energies are the experimental
ones taken from Bearden [4] (instead of being calculated as ionization energy diﬀerences as in the version 2001), the
generalized oscillator strength model is ﬁxed in order to reproduce the stopping powers quoted in ICRU [10] and
the inner-shell ionization by electron and positron impact is an independent process (which was not included in the
version 2001). In what follows we use the version 2003 of PENELOPE only.

A few simulations performed, for some of the cases considered here, with the new versions 2005 and 2006 of the

code have produced the same results as the version 2003.

B. Radial dose rate distributions

In this section we compare the results of our simulations with those obtained by Luxton and Jozsef [12] and Ye et
al. [20]. Fig. 3 shows the values of R(r), as given by Eq. (2) for energies ranging between 15 keV and 2 MeV, as a
function of the distance to the source, r, in the Pinf phantom. In all panels, solid curves correspond to the simulations
we have performed with PENELOPE. These are compared with the results obtained for GEANT4 (open squares) in
left panels and with the results of the EGS4 simulation performed by Luxton and Jozsef [12] (open circles) in right
panels. An uncertainty of 1% was assumed for the data of these authors.

The results of PENELOPE and GEANT4 calculations agree rather well except at distances to the source smaller
than 1 cm. Above 1 cm and for all energies, the diﬀerences between both calculations are below 1% of the maximum
value of the corresponding R(r).

At distances to the source smaller than 1 cm, the diﬀerences are, in general, larger. Below 0.5 cm and for energies
smaller than 80 keV, the diﬀerences are bigger than 1% of the maximum of R(r), reaching values around 3% of this
maximum for the ﬁrst bin (from 0 to 0.25 mm). In the energy range between 80 and 300 keV, only the ﬁrst bin

1.0

0.8

0.6

0.4

0.2

0.0
0.6

0.4

0.2

0.0
3.0

2.0

1.0

1
(cid:0)

1
(cid:0)

2

℄

h

q
B

m


y
G
n
[

)
r
(
R

PENELOPE

PENELOPE

15 keV

15 keV

(this work)

(this work)

GEANT4

EGS4

20 keV

(this work)

20 keV

30 keV

30 keV

50 keV

50 keV

300 keV

300 keV

200 keV

200 keV

150 keV

150 keV

80 keV

80 keV

2 MeV

2 MeV

1.5 MeV

1.5 MeV

1 MeV

1 MeV

0.5 MeV

0.5 MeV

0.0

10-2

10-1

1

10

102

10-2

10-1

1

10

102

r [m℄

r [m℄

FIG. 3: Comparison of the values of R(r), as given by Eq. (2), obtained with PENELOPE (solid curves) with those calculated
with GEANT4 (left panels) and with the results reported by Luxton and Jozsef [12] with EGS4 (right panels). Various
initial photon energies ranging from 15 keV to 2 MeV are plotted. Our calculations have been done with the Pinf phantom.
The uncertainties for the GEANT4 calculations are smaller than the size of the symbols used and those of the PENELOPE
calculations are of the same order.

7

gives diﬀerences larger than 1% of the maximum value of R(r). Above 300 keV, the diﬀerences are bigger than 2%
of the maximum of R(r) for distances to the source smaller than 0.5 cm. For the ﬁrst bins, values around 8% of the
maximum of R(r) are found.

The diﬀerences between PENELOPE and EGS4 (Luxton and Jozsef 1999) follow the same trends for all the energies
analyzed. At distances to the source above 1 cm, these diﬀerences are below 2% of the maximum of the corresponding
R(r). For distances smaller than 1 cm, the diﬀerences are at most 6% of the maximum of R(r). Nevertheless, the
ﬁrst point available in the work of Luxton and Jozsef [12] is r = 0.05 cm and nothing can be said about distances
closer to the source.

The degree of agreement between the diﬀerent calculations can be evaluated by using the χ2 statistic deﬁned in
Eq. (7). In panel (a) of Fig. 4 we show with black squares the results obtained for the statistic when comparing the
PENELOPE and GEANT4 results for the Pinf phantom (plotted in left panels of Fig. 3). The χ2/M appears to be
rather large at low energies, close to 1 at medium energies and grows with energy above 200 keV. In these calculations
of the χ2 statistic, the full histograms have been considered. In all cases the probability Q(χ2|M ) is smaller than
0.001.

In the same panel we have plotted the χ2/M values obtained for the same comparison but using the Pﬁn phantom.
These values are practically the same as those previously discussed for energies below 50 keV. The reason for this
behavior is that the ﬁnite phantom used is, in practice, inﬁnite for these low energies. At higher energies, the χ2/M
values are larger for this ﬁnite phantom than for the inﬁnite one. This is mainly due to the fact that the number of
bins included in the calculations is smaller (roughly a factor 10) for Pﬁn: though the diﬀerences between PENELOPE
and GEANT4 are similar for both phantoms, their relative importance is rather larger in the Pﬁn case.

In panel (b) of Fig. 4, the results of the comparison between our PENELOPE simulations for the Pinf phantom and
the EGS4 calculations of Luxton and Jozsef [12] are plotted. At low energy, the trend is similar to the one observed
in the previous panel. In this case, values near χ2/M ∼ 1 are not obtained. However, above 40 keV, the χ2/M does
not show the quick growth with energy found in the comparison between PENELOPE and GEANT4.

We have performed a comparison of our results with those of Ye et al. [20] obtaining, as expected, a good agreement
above 10 keV for the phantom Pﬁn). For 10 keV a certain discrepancy is observed which can be ascribed to the fact
that these authors gave results for ﬁve bins only.

Apart from the random variability, we have not found any particular structure at 3 cm from the 2 MeV source,
neither with PENELOPE nor with GEANT4 using both the Pﬁn and the Pinf phantoms. This supports the guess of
Luxton and Jozsef [12] and their observation was, probably, a simulation artifact.

The diﬀerences observed between the diﬀerent calculations can be due to a variety of factors. For energies above a
few hundred of keV, the disagreement found close to the source between PENELOPE and GEANT4 can be ascribed
to the known problems of this last code with the multiple scattering implementation [14], which aﬀects the electron
transport and is crucial in the absence of charged particle equilibrium, as it occurs precisely nearby the source. This
is an important point because, as mentioned above, we have done calculations with GEANT4 using electron tracking
parameters more exigent and we have found the same results.

For low energies, below 80 keV, electron transport is negligible and, at least in principle, the diﬀerences can be
due only to the fact that the photoelectric and Compton cross sections used by the low-energy package of GEANT4
and PENELOPE are diﬀerent. This discrepancy should be reduced by using the package PENELOPE of GEANT4,
in which the same cross sections as in the PENELOPE code are used. As shown by Poon and Verhaegen [14], the

M
=

(cid:31)

2

1

R

;

R

2

103

102

10

1

10-1

1

(a)

(b)

P

(cid:12)n

P

inf

P

inf

R

(cid:17) [R(r)℄

(this work)

R

(cid:17) [R(r)℄

(this work)

1

PENELOPE

1

PENELOPE

R

(cid:17) [R(r)℄

(this work)

R

(cid:17) [R(r)℄

2

GEANT4

2

EGS4

10

102

103

104

1

10

102

103

104

E

[keV℄

E

[keV℄

initial

initial

FIG. 4: Values of χ2
R1,R2 /M , as given by Eq. (7), calculated for the quantity R(r), as a function of the energy of the initial
photons. The comparison between the results of our simulations with PENELOPE and GEANT4 are shown for the Pinf (black
squares) and Pﬁn (open circles) phantoms in panel (a). In panel (b), we show the results for the comparison of our PENELOPE
results with those of Luxton and Jozsef [12] obtained with EGS4.

8

diﬀerences obtained for the photoelectric mass attenuation coeﬃcient using the PENELOPE package and the low-
energy package of GEANT4 are negligible. On the other hand, the diﬀerences for the Compton mass attenuation
coeﬃcient are smaller than 1.5% for energies below 200 keV. Above this energy, no diﬀerences are found. In order
to see if these diﬀerences solve the discrepancies shown by our calculations, we have performed simulations using the
PENELOPE package of GEANT4 for energies below 80 keV. First, we have found that these new results diﬀer from
those corresponding to the low-energy package by less than 1% of the maximum of R(r) and, second, the modiﬁcation
does not improve the agreement with the results obtained with the PENELOPE code.

The diﬀerences observed between PENELOPE and EGS4 at low energies, where electron transport is not relevant,
can be ascribed to the diﬀerent cross sections used for photoelectric and Compton processes in both codes. Above
80 keV, also the diﬀerences in the electron tracking procedures used in these two codes aﬀect. One can expect that
EGSnrc [11], a newer version of EGS, with new implementations of the photoelectric and Compton process physics
would reduce these diﬀerences to a large extent.

IV. CONCLUSIONS

In this work, Monte Carlo codes PENELOPE and GEANT4 have been used to calculate the dose rate in water for
monoenergetic photon point sources with energies of interest in brachytherapy, ranging between 10 keV and 2 MeV.
To compare the results obtained with these two codes between them and with those calculated by other authors,

we have proposed a statistical test based on the evaluation of the χ2 between two histograms.

We have found some small discrepancies between the versions 2001 and 2003 of PENELOPE for source energies
larger than 1 MeV, while the versions 2005 and 2006 provide results in perfect agreement with version 2003 in the
cases here analyzed.

The comparison between PENELOPE and GEANT4 results shows a reasonable agreement for all energies analyzed

except in the neighbor of the source, up to a few millimeters.

In the case of the inﬁnite phantom, the PENELOPE results are also in reasonable agreement with previous EGS4

calculations of Luxton and Jozsef [12] for distances larger than 1 cm.

The comparison of our results with the results of Ye et al. [20] shows a good agreement above 10 keV for the ﬁnite

phantom.

We have shown that the comparison between the histograms obtained as output of this kind of simulations can
produce contradictory results if it is done on the basis of a restricted set of bins. To avoid this problem, at least
in part, we have proposed a χ2 test which gives a quantitative estimate of the agreement or disagreement between
histograms. However, due to its integral character, other relevant information can be lost (e.g., the possible bias, the
bins which are actually diﬀerent, etc.) Thus, further investigation to ﬁnd additional statistics should be of interest in
order to complete the analysis.

V. ACKNOWLEDGMENTS

This work has been supported in part by the Junta de Andaluc´ıa (FQM0220) and by the Ministerio de Educaci´on
y Ciencia (FIS2005-03577). F.M.O. A.-D. acknowledges the University of Granada and the Departamento de F´ısica
Moderna for partially funding his stay in Granada (Spain).

[1] Agostinelli, S., Allison, J., Amako., K., Apostolakis, J., et al., 2003. GEANT4 - A simulation toolkit Nucl. Instr. Meth.

Phys. Res. A 506, 250-303

[2] Al-Dweri, F.M.O., Lallena, A.M., Vilches M., 2004. A simpliﬁed model of the source channel of the Leksell GammaKnife

tested with PENELOPE. Phys. Med. Biol. 49, 2687-2703.

[3] Asenjo, J., Fern´andez-Varea, J.M., S´anchez-Reyes, A., 2002. Characterization of a high-dose rate 90Sr-90Y source for

intravascular brachytherapy by using the Monte Carlo code PENELOPE. Phys. Med. Biol. 47, 697-711.

[4] Bearden, J.A., 1967. X-ray wavelengths. Rev. Mod. Phys. 39, 78-124.
[5] Berger, M.J., 1968. Energy deposition in water by photons from point isotropic sources. J. Nucl. Med. Suppl. 1, 17-25.
[6] Cullen, D.E., Hubbell, J.H., Kissel, L., 1997. EPDL97: The evaluated photon data library, ’97 version (LLNL Report

UCRL-50400). (LLNL, Livermore)

[7] Frankle, S.C., Little, R.C., 2000. Informal overview of the DLC-200/MCNPDATA package. (LANL, Los Alamos)
[8] Frodesen, A.G., Skjeggestad, O., Tofte, H., 1979. Probability and statistics in particle physics. (Universitetsforlaget, Bergen)

9

[9] GEANT4 Collaboration, 2006. Physics Reference Manual.

http://wwwasd.web.cern.ch/wwwasd/geant4/G4UsersDocuments/UsersGuides/
[10] ICRU 37, 1984. Stopping powers for electrons and positrons. (ICRU, Bethesda)
[11] Kawrakow, I., Rogers, D.W.O., 2003. The EGSnrc code system: Monte Carlo simulation of electron and photon transport,

NRCC Report PIRS-701 (NRC, Otawa), available at http://www.irs.inms.nrc.ca/inms/irs/EGSnrc/EGSnrc.html

[12] Luxton, G., Jozsef, G., 1999. Radial dose distribution, dose to water and dose rate constant for monoenergetic photon

point sources from 10 keV to 2 MeV: EGS4 Monte Carlo model calculation. Med. Phys. 26, 2531-2538.

[13] Poon, E., Seuntjens, J., Verhaegen, F., 2005. Consistency test of the electron transport algorithm in the GEANT4 Monte

[14] Poon, E., Verhaegen, F., 2005. Accuracy of the photon and electron physics in GEANT4 for radiotherapy applications.

Carlo code. Phys. Med. Biol. 50, 681-694.

Med.Phys. 32, 1696-1711.

[15] Press, W.H., Teukolsky, S.A., Vetterling, W.T., Flannery, B.P., 1992. Numerical recipes in Fortran77: The art of scientiﬁc

computing. (Cambridge University Press, Cambridge)

[16] Sakamoto, Y., 1993. Photon cross section data PHOTX for PEGS4 code. Proc. Third EGS4 User’ Meeting in Japan. (KEK,

Tsukuba)

[17] Salvat, F., Fern´andez-Varea, J.M., Acosta, E., Sempau, J., 2001. PENELOPE - A code system for Monte Carlo simulation

of electron and photon transport. (NEA-OECD, Paris)

[18] Salvat, F., Fern´andez-Varea, J.M., Sempau, J., 2003. PENELOPE - A code system for Monte Carlo simulation of electron

[19] S´anchez-Reyes, A., Tello, J.J., Guix, B., Salvat, F., 1998. Monte Carlo calculation of the dose distributions of two 106Ru

and photon transport (NEA-OECD, Paris)

eye applicators. Radiother. Oncol. 49, 191-196.

[20] Ye, S.-J., Brezzovich, I.A., Pareck, P., Naqvi, S.A., 2004. Benchmark of PENELOPE code for low-energy photon transport:

dose comparisons with MCNP4 and EGS4. Phys. Med. Biol. 49, 387-397.

