DESY 04-126
July 2004

A simple method for the determination of the
structure of ultrashort relativistic electron bunches

E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov

Deutsches Elektronen-Synchrotron (DESY), Hamburg, Germany

Abstract

In this paper we propose a new method for measurements of the longitudinal proﬁle of
100 femtosecond electron bunches for X-ray Free Electron Lasers (XFELs). The method is
simply the combination of two well-known techniques, which where not previously com-
bined to our knowledge. We use seed 10-ps 1047 nm quantum laser to produce exact optical
replica of ultrafast electron bunches. The replica is generated in apparatus which consists
of an input undulator (energy modulator), and the short output undulator (radiator) sepa-
rated by a dispersion section. The radiation in the output undulator is excited by the elec-
tron bunch modulated at the optical wavelength and rapidly reaches 100 MW-level peak
power. We then use the now-standard method of ultrashort laser pulse-shape measurement,
a tandem combination of autocorrelator and spectrum (FROG – frequency resolved opti-
cal gating). The FROG trace of the optical replica of electron bunch gives accurate and
rapid electron bunch shape measurements in a way similar to a femtosecond oscilloscope.
Real-time single-shot measurements of the electron bunch structure could provide signiﬁ-
cant information about physical mechanisms responsible for generation ultrashort electron
bunches in bunch compressors. The big advantage of proposed technique is that it can be
used to determine the slice energy spread and emittance in multishot measurements. It is
possible to measure bunch structure completely, that is to measure peak current, energy
spread and transverse emittance as a function of time. We illustrate with numerical exam-
ples the potential of the proposed method for electron beam diagnostics at the European
X-ray FEL.

4
0
0
2
 
l
u
J
 
5
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
7
8
0
7
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Preprintsubmitted toNuclear Instruments andMethods A

July13,2004

1 Introduction

The past decade has been tremendous progress in the development of electron accelerators
that produce ultrashort bunches approaching sub-100 femtosecond durations [1,2]. The use of

ultrashort electron bunches for both fundamental studies and applications is increasing rapidly,
too [3–5]. As electron bunches shrink in length and grow in utility, the ability to measure them
becomes increasingly important. There are several reasons for this. First, precise knowledge

of the bunch properties is necessary for verifying theoretical models of bunch creation [6,7].
Second, in order to make even shorter bunches, it is necessary to understand the distortions that

limit the length of currently available pulses. Third, in experiments using these bunches, it is
always important to know at least the pulse length in order to determine the temporal resolution

of a given experiment. Moreover, in many experiments – studies of X-ray SASE FELs, for
example - additional details of the bunch structure play an important role in determination
of the outcome of the experiment. Of particular importance is the variation of peak current,

emittance and energy spread along the bunch. Finally, numerous applications have emerged
for emittance-shaped ultrashort electron bunches and, of course, it is necessary to be able to

measure the emittance, or energy spread shape of the electron bunch used in these experiments
[8].

Measuring ultrashort electron bunches has always been a challenge. For ﬁve years, it was
possible to create 100-fs electron bunches, but not to measure them [1,2]. Standard electron
beam diagnostic tools are capable to measure bunch charge, projected emittance, and energy

spread of the full electron bunch only. Unfortunately, they fail to measure the temporal depen-
dence of the charge distribution within the bunch. It is not possible to measure slice emittance

because electron bunches are so much shorter than the temporal resolution of measurement de-
vices. Also, even when projected energy spread of the full electron bunch is measured, there

is no sufﬁcient information to determine slice energy spread and energy chirp separately. On
the other hand, it is primarily the slice emittance and slice energy spread of electrons in axial
slices (that are only a small fraction of the full bunch length) that determine the performance of

a X-ray FEL. Thus, there is an urgent need for development of electron beam instrumentation
allowing to measure bunch structure completely, that is, to measure the temporal dependence of

the charge, emittance and energy spread distributions within the bunch.

The new principle of diagnostic techniques described bellow offers a way for full character-
ization of ultrashort electron bunches. It is based on a construction of an exact optical replica

of an electron bunch. The replica synthesizer consists of four elements: the seed quantum laser,
the modulator undulator, dispersion section, and radiator undulator. The seed laser pulse inter-

acts with electron beam in the modulator undulator and produces the energy modulation in the

1

electron bunch. The electron beam then passes through the dispersion section where the en-
ergy modulation is converted to a density modulation at the optical wavelength. Particles in a

modulated bunch following a second undulator radiate coherently at a wavelength of the beam
density modulation. The bandwidth-limited radiation pulse has 10 µJ-level pulse energy. Longi-
tudinal dynamics, in the undulators and dispersion section is governed by purely single-particle
effects where the results do not depend on the presence of other particles. In general the ra-

diation ﬁeld depends on the peak current, local energy spread and emittance. All steps of the
replica synthesis are controlled by means of the choice of the undulator parameters, dispersion

section strength and value of beta function. The electric ﬁeld of the wave radiated in the replica
synthesizer with optimized undulator length, strength of dispersion section and focusing beta
function is directly proportional to the peak current of the electron beam, E(t)
I(t),
and does not depend on the local energy spread and emittance. So, measuring electron current
proﬁle, I(t), for a single ultrashort electron pulse is reduced to the problem of a single-shot,
ultrafast laser pulse-shape measurement.

const.

≃

×

To characterize such short optical pulses, conventional photodetectors and streak camera
detectors do not have fast enough response times. Special measurement techniques are needed.

Early on, it was realized that the only event fast enough to measure an ultrashort pulse is the
optical pulse itself. A large number of clever schemes have been developed over the past twenty

years to better measure ultrashort laser pulses. Most of them have been novel experimental im-
plementations and variations of autocorrelators, but many have also offered additional informa-

tion about the pulse, although never full characterization. Recently there has been a renaissance
in this ﬁeld and several new techniques have emerged that do achieve full characterization.

They operate, not in the time or frequency domains, but in the ”time-frequency domain.” With
the most commonly used new pulse-measurement method, frequency resolved optical gating
(FROG), it is now possible to measure pulses in the visible or IR wavelength range, pulse

lengths and complexities and to do so in manner that is general, robust, accurate and rigorous
[9]. FROG simply involves spectrally resolving the signal beam of an intensity autocorrelator

measurement. FROG is a technique to measure ultrashort laser pulses that optically constructs
a spectrogram of a laser pulse. A two-dimensional (2-D) phase retrieval algorithm is used to

extract the intensity and phase of a pulse from its spectrogram. The algorithm is fast enough
to allow real-time inversion of the FROG spectrograms. It is also possible to measure the in-
tensity distribution of a single ultrashort laser pulse. The entire trace can then be obtained on

a single CCD camera image. Recent improvements of the FROG technique have lead to very
sophisticated retrieval procedures, which can rapidly retrieve the pulse from the FROG trace.

Acquisition and reconstruction rates of up to 10 Hz have been demonstrated, which makes
FROG to be an ideal online tool for aligning complex femtosecond laser systems.

2

It is clear that the revolution that has taken place only recently in ultrashort optical pulse
measurement has not only yielded powerful new laser diagnostics, but also has opened up

tremendous new possibilities for ultrafast accelerator technology. With this new-found capa-
bility, a number of otherwise impossible experiments are now possible. We illustrate with nu-

merical examples the potential of the proposed method for electron beam diagnostics at the
European X-ray FEL. We demonstrate that the tandem combination of replica synthesizer and

new FROG based femtosecond oscilloscope can be used to determine the temporal dependence
of the charge distribution within the bunch for single ultrashort electron bunch. Proposed tech-

niques have emerged that do achieve full characterization of the ultrashort electron bunches.
The big advantage of the proposed diagnostic technique is that it can be used to determine the
slice emittance and energy spread for a multishot measurements. We show that proposed tech-

nique can directly obtain the electron bunch slice energy spread and emittance from data sets of
beta function and dispersion section strength scans.

2 Full characterization of femtosecond electron bunches by optical replica measure-

ments

2.1 Optical replica synthesis

A basic scheme of the optical replica synthesizer and optical replica of a complex test elec-
tron bunch are shown in Figs. 1–3. A relatively long laser pulse is used to modulate the energy

of electrons within the electron pulse at the seed laser frequency. The electron pulse will be
timed to overlap with the central area of the laser pulse. The duration of the laser pulse is much
larger than the electron pulse time jitter of a fraction of ps, so it can be easily synchronized with

the electron pulse. The laser pulse serves as a seed for modulator which consists of a short un-
dulator and dispersion section. Parameters of the seed laser are: wavelength 1047 nm, energy in

the laser pulse 1 mJ, and FWHW pulse duration 10 ps. The laser beam is focused onto electron
beam in a short (number of periods is equal to Nw = 5) modulator undulator resonant at the
optical wavelength of 1047 nm. Optimal conditions of focusing correspond to the positioning of
the laser beam waist in the center of the modulator undulator. The size of the laser beam waist

is 10 times larger than the electron beam size. The seed laser pulse interacts with the electron
beam in the modulator undulator and produces an amplitude of the energy modulation in the
electron bunch of about 250 keV. Then the electron bunch passes through the dispersion sec-
50µm) where the energy modulation is
tion (momentum compaction factor is about of R56
converted to the density modulation at the laser wavelength. The density modulation reaches an

≃

amplitude of about 10%. Following the modulator the beam enters the short (number of periods
is equal to Nw = 5) radiator undulator which is resonant at laser (or double) frequency. Because

3

Fig. 1. Schematic diagram of the optical replica synthesis through optical modulation of electron bunch
and coherent radiation in the output undulator. Signal beam ﬁlter based on polarizer: y-polarized light is
transmitted, while x-polarized light is reﬂected

Fig. 2. Second possible schematic of replica synthesis: signal beam ﬁlter based on the 2nd harmonic gen-
eration. The bunched beam has not only a seed radiation frequency component, but also a considerable
intensity in its harmonics. It is then possible to have an input undulator operating at one frequency, and
an output undulator operating at double of this frequency

the beam has a large component of bunching, coherent emission is copiously produces by the
electron bunch. The bandwidth-limited output radiation pulse (see Fig. 3) has 10 µJ-level pulse
energy and is delivered in a diffraction-limited beam.

The optical replica synthesizer is expected to satisfy certain requirements which can be

achieved by suitable design and choice of the components. A complete optimization of the
proposed diagnostic device can be performed only with three-dimensional time-dependent nu-

4

]
.

u

.

a
[
 
 

d

l

e

i
f
 

c

i
r
t
c
e

l

E

 

0

5 0

1 0 0

1 5 0

t   [fs]

Fig. 3. Optical replica (rapidly oscillating curve) of a test electron bunch. Radiator operates at the wave-
length of 1047 nm

merical simulation code. Numerical results presented in this paper are obtained with version
of code FAST [10] modiﬁed for simulation of optical replica synthesis. This code allows one

to perform simulations of coherent undulator radiation taking into account all physical effects
inﬂuencing the synthesizer operation.

2.1.1 Low background

One important point in the construction of replica synthesizer is separation of the optical
replica from the seed laser pulse. Numerous designs are possible – for example, the combination

of two planar undulators placed in crossed positions, as it is illustrated schematically in Fig. 1.
Both undulators have the same period and ﬁeld strength. The 1047 nm x-polarized seed radiation

with 100 MW peak power and electron beam enter the ﬁrst undulator, which is used to modulate
the energy of electron beam. Passing the ﬁrst undulator the beam and seed radiation enter the
second undulator which is rotated by 90◦ relatively to the ﬁrst undulator section. The x-polarized
seed radiation does not interact with the electron beam and thus propagates freely. However, a
new y-polarized radiation component is generated by the density-modulated electron beam and

rapidly reaches 100 MW-level peak power. Then the electron and the light beam are separated.
The electron beam is guided through a bypass and the radiation enters the polarizer which

selects y-polarization. The radiation pulse after polarizer has ultrashort duration and is exact
replica of the electron bunch. Finally, the radiation pulse is directed to the ultrashort-pulse-

 

5

measurement device.

In another scheme a frequency doubler is used to distinguish the optical replica from the

intense seed laser pulse. The bunched beam at large values of the bunching parameter has not
only a fundamental radiation frequency component, but also a considerable intensity in its har-

monics. It is then possible to have an input undulator operating at one frequency, and an output
undulator operating at a multiple of this frequency. The radiation in the output undulator will
then be excited by the harmonic component in the electron beam, and the diagnostic instru-

ment will operate as a frequency multiplier. A schematic diagram of the 2nd harmonic replica
synthesis is shown in Fig. 2. Following the modulator the beam and seed radiation enter short

undulator (radiator) which is resonant with the second harmonic of the seed radiation. In the
radiator the seed radiation plays no role and is diffracted out of the electron beam, while a new

2nd harmonic radiation is generated by the density-modulated electron beam.

2.1.2 High resolution

When propagating in vacuum, the radiation ﬁeld is faster than the electron beam, and it
moves forward (slips) by one wavelength, λ, per one undulator period, λw. It is clear that the
resolution of the electron pulse shape is determined by the slippage of the radiation with respect

to electrons in the output undulator. If the slippage time is much less than the electron pulse
duration,

Nwλ/c

τe ,

≪

then one can neglect the slippage effect. Calculation of the slippage effect shows (see Figs. 4

and 5) that this should not be a serious limitation in our case.

6

0

5 0

1 0 0

1 5 0

t   [fs]

Fig. 4. Target electron beam current (solid curve) and retrieved electron pulse shape (circles) from the
optical replica in Fig. 3. Number of radiator undulator periods is equal to Nw = 5. The optical replica
is generated at the radiation wavelength 1047 nm. Discrepancies between the target and retrieved shapes
are due to the slippage effect

]
.

u

.
a
[
 
 
t
n
e
r
r
u
c
 
m
a
e
B

]
.

u

.
a
[
 
 
t
n
e
r
r
u
c
 
m
a
e
B

 

 

 

 

7

0

5 0

1 0 0

1 5 0

t   [fs]

Fig. 5. Target electron beam current (solid curve) and retrieved electron pulse shape (circles) from the
optical replica. Number of radiator undulator periods is equal to Nw = 5. The optical replica is generated
at the radiation wavelength 523 nm. Note that the actual and retrieved electron bunch shapes are visually
identical

2.1.3 Discussion of complicating self-interaction effects

In most applications high electron beam intensities are desired and it is therefore prudent in

particular cases to test for the appearance of self-interaction effects. Proposed method for the
electron pulse-shape measurement is based on the assumption that beam density modulation

does not appreciably change as the beam propagates through the radiator undulator. As any os-
cillating charge radiates energy, so must a modulated electron beam moving along an undulator
radiate energy. If the system radiates energy, then in order to preserve conservation of energy

we must ﬁnd that the electron beam energy is being lost. The electrons with different arrival
phases acquire different values of the energy increments (positive or negative), which results in

the modulation of the longitudinal velocity of the electrons with radiation frequency. Since this
velocity modulation is transformed into the density modulation of the electron beam during the

undulator pass, an additional radiation ﬁeld exists because of variation in amplitude of density
modulation. Instead, we assume that the amplitude of electron beam density modulation has the

same value at all points in the undulator. This approximation means that only the contributions
to the radiation ﬁeld arising from the initial density modulation are taken into account, and not
those arising from the induced bunching.

The problem of induced beam density modulation in the radiator undulator refers to the
class of self-interaction problems. Optimization of the radiator undulator length has been per-

formed with code FAST which takes into account collective ﬁelds (radiation and space charge
ﬁelds). Typical temporal structure of electron bunches (mean energy, current, emittance and en-
ergy spread along the bunch) at the exit of the bunch compression system is presented in Fig.

6. These data sets are used as input parameters for code FAST. The smaller the number of out-
put undulator periods, the smaller the induced density modulation and additionally smaller the

slippage effect. The optimum output undulator length, keeping the resonance approximation,
results in the number of periods of Nw = 5. Calculation shows that in this case the ratio of
the induced density modulation amplitude and the initial amplitude at the output undulator exit
reaches value of about a few per cent only. Thus we ﬁnd that collective effects in the output

undulator are not important in our case.

Longitudinal beam dynamics in the modulator undulator as assumed in this paper is gov-
erned by purely single-particle effects where the results do not depend on the presence of other

particles. During the passage through a modulator the electron density modulation at the optical
wavelength can be perturbed by the collective ﬁelds. As a result, the small induced bunching

requirement dictates the use of modulator undulator length to be of a few periods only. In the
case under study, the optimum number of the modulator undulator periods is equal to Nw = 5.

The next problem to be studied is that of estimating the collective effects inﬂuencing the

operation of dispersion section. Particles in a modulated bunch following a curved path may

8

radiate coherently at a wavelength of the beam density modulation. When an electron bunch
passes the dispersion section, radiative interaction induces an additional density modulation.

The design of modulator chicane is based on the need to minimize coherent synchrotron radi-
ation (CSR) induced microbunching. The problem connected with radiative interaction of the

particles in the bunch with sinusoidal density excitation moving in a magnetic chicane has been
investigated analytically and numerically [11–13]. Calculation of the CSR effects shows that

this should not be a serious limitation in our case.

2.1.4 The method of obtaining information about electron current proﬁle

The study and detailed understanding of the cause and nature of collective effects is im-

portant for successful design of replica synthesizer. Proposed design is conducted to eliminate
collective effects as much as possible through installation of short input and output undulators.

The signal produced by replica synthesizer is thus a pulse of electric ﬁeld amplitude:

E(t) = F (I(t), ǫn(t), ∆

(t)) = I(t)f (ǫn(t), ∆

(t)) ,

E

E

where ǫn(t) is the normalized slice emittance and ∆
(t) is the slice energy spread in the electron
bunch. If longitudinal beam dynamics in the synthesizer is governed by purely single-particle
effects then this ﬁeld directly proportional to the peak current I(t).

E

Within the scope of the electrodynamic theory the output characteristics of the replica syn-
thesizer are controlled by three dimensional parameters: λ, Lw,
σ, where λ is the radiation
wavelength, Lw = Nwλw is the radiator undulator length, and σ is the electron beam transverse
size. At an appropriate normalization of electrodynamic equations, the coherent undulator radi-
ation is described by only one dimensionless parameter:

N = 2πσ2/(λLw) .

The parameter N can be referred to as the electron beam Fresnel number, or as diffraction
parameter. In general case the electric ﬁeld of the wave radiated in the undulator depends on the

transverse size of the electron beam. For a proposed diagnostic technique it is of great interest
to minimize the inﬂuence of the transverse emittance on the radiation ﬁeld amplitude. In the

the most of the radiation overlaps with electron beam and ﬁeld of the wave is inversely propor-

(1)

case of a wide electron beam

λLw

≪

2πσ2 ,

or N

1 ,

≫

tional to the square of electron beam

E(t)

I(t)/σ2(t) .

∝

9

Reducing the particle beam cross-section by diminishing the betatron function reduces also
the size of the radiation beam and increases the total power of output radiation. This process of

reducing the beam cross-section is, however, effective only up to some point. Further reduction
of the particle beam size would practically no effect on the radiation beam size and total radia-

tion power because of diffraction effects (see Section 4). In the limit of a thin electron beam the
transverse radiation beam size tends to the constant value and the dependence of the output ra-

diation on the transverse size of the electron beam is rather weak. The boundary between these
two asymptotes is about σ2

λLw.

≃

From the preceding discussion we may want to optimize the beam geometry as follows. The

transverse size of the electron beam has to be much smaller then the diffraction limited radiation
beam size

σ2

≪

λLw/(2π) ,

or N

1 ,

≪

(2)

The radiation wavelength and the undulator length dictate the choice of the optimum transverse
size of the electron beam. Let us present a speciﬁc numerical example. Suppose γ = 103,
ǫn = 2πµm, λw = 6.5 cm, Nw = 5, λ = 1µm. If the focusing beta function is equal to 1 m
the diffraction parameter is N = 2πσ2/(λLw)
0.04. We come to the conclusion that we can
≃
treat this situation as a coherent undulator radiation generated by a thin electron beam. This

condition may be easily satisﬁed in practice.

Proposed design is conducted to eliminate emittance effects as much as possible through

installation of a special electron beam focusing system. In the radiator undulator the betatron
function should reach small values (of about 1 m) forming a narrow beam waist. The signal
generated by a replics synthesizer is thus a pulse of electric ﬁeld with amplitude:

E(t) = F (I(t), ǫn(t), ∆

(t)) = I(t)f (∆

(t)) .

E

E

E

E

/(λ

0) is dimensionless quantity known as the bunching parameter, δ

Optimum parameters of the dispersion section can be estimated in the following way. The
expression for the fundamental component of the bunched beam current is i1(t) = 2I(t)J1(X),
where X = 2πR56δ
is
the amplitude of energy modulation induced in the modulator undulator. The function J1(X)
XI(t). We see that
approaches X/2 for small X; thus the microbunching approaches i1(t)
microbunching depends on the choice of the dispersion section strength. One might think that
all we have to do is to get microbunching amplitude to maximum – we can always increase
R56 of the dispersion section and we can always increase output power. It is not impossible to
build dispersion section that has large R56 function. In fact, one of the main problems in the
modulator operation is preventing the spread of microbunching due to local energy spread in
the electron beam. For effective operation of replica synthesizer the value of suppression factor

≃

E

10

should be close to unity. To get a rough idea of the spread of electron density modulation, the
position of the particles within the electron beam at the dispersion section exit has a spread
which is equal to ∆z′
E
We know that uncertainty in the phase of the particles is about ∆ψ
rough estimate for the microbunching spread to be small is

is the local energy spread in the electron bunch.
2π∆z′/λ. Therefore, a

0, where ∆

R56∆

≃

≃

E

E

/

2πR56∆

/

0

E

E

≪

1 .

(3)

The result of more careful analysis (see Section 3) shows that in our case the optimal condition
can be written as X
250 keV. The amplitude of energy modulation
≃
dictates the choice of the seed laser parameters. In our case the optimal peak power of the seed
laser is about of 100 MW.

max(∆

0.1, δ

E ≃

)/3

≃

E

In general, radiation ﬁeld depends on the peak current, I(t), local energy spread, ∆
(t),
and local emittance, ǫn(t). However, under conditions of a thin electron beam (2) and of a
microbunching spread to be small (3), the electric ﬁeld of the wave radiated in the replica

E

synthesizer is directly proportional to the peak current of the electron beam:

E(t) = F (I(t), ǫn(t), ∆

(t)) = const.

I(t) .

E

×

Thus, conditions (2) and (3) should be treated as optimal tuning of undulator length, strength of
the dispersion section and focusing beta function for measurement of the electron bunch proﬁle.

2.1.5 The method of obtaining information about slice emittance and energy spread

E

We found that longitudinal proﬁle of the electron bunch I(t) can be reconstructed on the
basis of a single-shot measurements. The next problem is determination of slice energy spread
(t)) and slice emittance (ǫn(t)). This can be done on the basis of multishot measurements.
(∆
If the electron pulse shape, I(t), is known, the local energy spread ∆
(t) can be determined
from the dispersion section strength scan. In this way, the problem of slice energy spread mea-
surement is transformed into a relatively simple task of measuring the radiation ﬁeld amplitude
maximum (max E(t)
max i1(t)). An attempt to increase of the amplitude of the fundamental
harmonic, by increasing the strength of dispersion section, is countered by decrease the energy
spread suppression factor. In Section 3 we demonstrate that the microbunching i1(t) has clearly
a maximum

∝

E

max i1(t) = const.

δ

[I(t)/∆

(t)] ,

×

E

E

11

and the optimum strength of the dispersion section is

R56 =

λ
E
2π∆
E

0
(t)

.

Thus, measuring the max E(t) is strictly equivalent to measuring the local energy spread varia-
tions along the electron bunch:

I(t)/[max E(t)] = const.

∆

(t) .

×

E

Since the optimal strength of the dispersion section is known, that of the unknown absolute
value of slice energy spread, ∆

(t), is easily found too.

E

Slice emittance can be measured in the following way. Let us consider for illustration of

the method a simple model of the electron bunch, assuming that slice emittances are different,
but Twiss parameters are the same in all slices (more general model is discussed in section 5).
The solution in our case is to realize that in a wide electron beam asymptote (1) the most of the

radiation overlaps with the electron beam and the ﬁeld of the wave is inversely proportional to
I(t)/σ2(t). If the electron pulse shape, I(t), is known,
the square of the electron bunch, E(t)
the problem of the slice emittance measurement is transformed into a simple task of measuring
the radiation ﬁeld amplitude in the case of a wide electron beam

∝

I(t)/E(t) = const.

σ2(t)

as min(σ2)

λLw/(2π) .

×

≫

Since the value of beta function and projected emittance are known (from a standard method
using a screen and quadrupole scan), then the unknown absolute value of slice emittance ǫn(t)
is easily determined, too.

We illustrate retrieval of the slice bunch properties from the optical replica of the electron
bunch. We take two different electron bunches (right and left columns in Fig. 6), and perform

numerical calculations using code FAST. The nominal energy of electrons is equal to
0 = 500
MeV. Number of undulator periods in the modulator and radiator undulator is equal to Nw = 5.
Period length is 6.5 cm. The optical replica is generated at the radiation wavelength 1047 nm.
The seed laser power is 100 MW, FWHM pulse duration is 10 ps. Upper plots in Fig. 6 show

E

comparison of target and reconstructed values for the beam current. When taking these data,
parameters for the numerical experiment were set according to conditions (2) and (3): focusing
beta function in the radiator is 1 meter, and net compaction factor of the dispersion section is
50 µm. Calculations show that pulse energy in the optical replica exceeds 30 µJ. Slice energy
spread was determined by means of the scan of dispersion section strength at the value of beta-

function of 1 meter (lower plots in Fig. 6). The values of slice emittance were extracted with the
help of additional set of calculations with large value of beat function of 50 m which corresponds

12

5 0

1 0 0

1 5 0

t   [fs]

0

1 0 0

2 0 0

3 0 0

4 0 0

t   [fs]

 

 

5 0

1 0 0

1 5 0

1 0 0

2 0 0

3 0 0

4 0 0

t   [fs]

t   [fs]

 

 

 

 

 

 

 

 

]

A
k
[
 
 
I

]
d
a
r

-

m
m
m

[
 
 

n

ε

]

V
e
M

[
 
 

E

σ

6

4

2

0

0

2 .5

2 .0

1 .5

1 .0

0 .5

0 .0

0

1 .0

0 .8

0 .6

0 .4

0 .2

0 .0

0

5 0

1 0 0

1 5 0

1 0 0

2 0 0

3 0 0

4 0 0

t   [fs]

t   [fs]

Fig. 6. Target (solid curve) and retrieved (circles) electron beam peak current, slice emittance and slice
energy spread. Two different test electron pulses are used in the optical replica calculations (right and
0 = 500 MeV. Number of undulator periods
left columns). The nominal energy of electrons is equal to
is equal to Nw = 5. The optical replica is generated at the radiation wavelength 1047 nm

E

to the limit of a wide electron beam. We see that slice bunch properties can be retrieved with

high accuracy if optical replica can be characterized with high accuracy. The latter problem is
the subject of the next section.

]

A
k
[
 
 
I

 

]
d
a
r

-

m
m
m

[
 
 

n

ε

5

4

3

2

1

0

2 .5

2 .0

1 .5

1 .0

0 .5

1 .0

0 .8

0 .6

0 .0

0

0 .2

0 .0

0

]

V
e
M

[
 
 

 

E

σ

0 .4

13

There is no doubt that numerical simulation code gives a correct prediction for a given set
of parameters. However, in many cases a more transparent physical analysis would be more

preferable. The calculation scheme of the replica characteristics which is suitable for engineer-
ing practice is presented in Sections 3 and 4. This scheme stems from similarity techniques and

numerical calculation results given as universal plots. It may be especially useful at the design
stage of an experiment. To concentrate on the diffraction effects, in Section 4 we have restricted

our attention to the steady-state theory of the coherent undulator radiation. We assumed that a
continuous electron beam with current density constant in time is fed to the undulator entrance.

In practical situations the electron beam has a ﬁnite pulse duration (about 100 fs), and the ques-
tion arises of when one can use the results of Section 4. If the slippage time of the radiation
with respect to electrons per undulator length is much less than the electron pulse duration, then

one can neglect the slippage effects and use the steady-state approach. Now let us consider the
electron pulse with the gradient axial proﬁle of current I(t). As an approximation, the smooth
proﬁle I(t) may be replaced by a ”boxcar” function. The pulse duration interval is divided into
Ns subintervals of equal length. Within each subinterval, the approximation to I(t) is constant.
At the end of the each subinterval, the approximate proﬁle jumps to a new constant value. When
Nwλ/c < τe/Ns we can calculate the coherent undulator radiation separately within each subin-
terval. Using the plots presented in Fig. 4 and Fig. 5, one can give a quantitative answer to the

question about the region of applicability of the steady-state model.

2.2 Ultrashort optical pulse-shape measurements using frequency-resolved optical gating

The shape of the electron bunch replica cannot be measured using even the fastest photo-
diodes or streak camera detectors. The rise time of the best streak-cameras approaches 0.1 pi-

cosecond, far too slow to resolve the femtosecond structure of ultrafast optical pulses. Early on,
it was realized that the only event fast enough to measure an ultrashort pulse is the pulse itself.

This gave birth to the now-standard method of measurement: the intensity autocorrelation (AC).
Speciﬁcally, it involves splitting the pulse into two, variably delaying one with respect to the

other, and spatially overlapping the two pulses in some instantaneously responding nonlinear-
optical medium, such as second-harmonic-generation (SHG) crystal. A SHG crystal produces
light at a twice the frequency of input light with an intensity that is proportional to the product

of the intensities of the two input pulses. It is clear that this yields some measure of the pulse
length because no second harmonic intensity will result if the pulses do not overlap in time.

Thus, a relative delay of one pulse length will typically reduce the SHG intensity by about a
factor of two.

14

Fig. 7. A schematic of ultrashort-pulse-measurement device – SHG FROG, the most common and most
sensitive version of FROG. Like in the autocorrelation device the two beams are combined in the SHG
crystal and a frequency doubled signal beam is created. This signal beam is then sent through an imaging
spectrometer which outputs the beam frequency as a function of a distance. The output of the spectrom-
eter (the FROG trace, or spectrogram) is captured by a CCD camera. The pulse shape is then determined
using an algorithm in a computer connected to the camera

Mathematically, the autocorrelation A(τ ) is given by:

A(τ ) =

I(t)I(t + τ ) d t .

∞

Z−∞

|

¯I(ω)

One immediately recognizes the physical meaning of the autocorrelation function. The Fourier
transform of the autocorrelation is ¯A(ω), related to the Fourier transform of the signal by:
2. An autocorrelation is always a symmetric function. The Fourier transform
¯A(ω) =
of the autocorrelation is a real function, consistent with a symmetric function in the time do-
main. The question then naturally arises as to exactly what information about I(t) can be derived
from the measurement of cross-correlation. One can see that the correlation technique provides
the possibility to measure the modulus of the Fourier transform of the signal function, while

|

information about its phase is missing. Also, even when the spectrum is also measured there
is not sufﬁcient information to determine the pulse. Despite these serious drawbacks, the auto-

correlation and spectrum have remained the standard measures of ultrashort pulses for over 20
years, largely for lack of better methods [14].

The problem of ultrafast-pulse measurements have recently been solved. The autocorrelator

and spectrum are the building blocks for a new pulse-shape measurement technique, frequency
resolved optical gating (FROG), which is simply the spectrum of autocorrelation [9]. A tandem

15

Fig. 8. A schematic of a single-shot FROG trace measurement device. FROG trace can be produced by a
device composed of a few as ﬁve simple optical elements. GRENOUILLE is the simplest ultrashort-pulse
measurement device in the history. This trivial device uses a Fresnel biprism to replace the beam split-
ter, delay line, and beam-recombining optics. It maps delay to position at the crystal. GRENOUILLE
also utilizes a thick SHG crystal acting as both the non-linear-optical time-gating element and the spec-
trometer. A complete single-shot SHG FROG trace results. Whereas an autocorrelator (see top) has four
sensitive alignment parameters, GRENOUILLE has no sensitive alignment parameters at all

combination of autocorrelator and spectrum can be used to extract shape information from

ultrashort pulses. The technique is applicable to single-shot measurements. Although there are
many different types of FROG’s the type of geometry we will focus on what is known as the

Second Harmonic Generation (SHG) FROG (see Fig. 7). Under this FROG geometry, a SHG
crystal is used just like in the autocorrelation device to resolve the time axis, but additionally the
signal beam is sent through an imaging spectrometer, which uses diffraction gratings to separate

the light of the signal beam, in effect spatially representing the frequency of the signal beam.
The spectrometer outputs to camera the images of the signal beam after they have been separated

into its component wavelengths, known as FROG traces. To retrieve pulse-shape information
the trace is sent through FROG algorithm, which uses constraints to iterate to a unique solution

for both the phase and intensity of the pulse as a function of time. The intensity as a function of
time will give us the structure of the electron bunch.

Measurement of a spectrogram, that is, the Fourier transform of a function of two variables,

thus frames the ultrashort-pulse measurement problem in a form that allows a rigorous and
general solution. This realization lead to the introduction of iterative inversion algorithms. The

16

Fig. 9. Front panel display of the femtosecond oscilloscope. The device can display the pulses inverted
by an iterative algorithm at a rate of 10 Hz

N data points of the
important point is that any algorithm that takes into account all the N
spectrogram, rather than N data points in the time domain and N data points in the frequency
domain, produces a better estimate of the pulse, since it has much more materials with which to

×

work. The problem of determining the pulse intensity and phase from spectrogram is essentially
equivalent to the two-dimensional ”phase retrieval” problem in image science. Phase retrieval

is the problem of ﬁnding a function knowing only the magnitude (but not the phase) of its
Fourier transform. Phase retrieval for a function of one variable is impossible. For example,

knowledge of a pulse spectrum does not fully determine the pulse – many different pulses
have the same spectrum. But image scientists found that phase retrieval for a function of two

variables is possible. Knowledge of only the magnitude of a two-dimensional Fourier transform
of a function of two variables essentially uniquely determines the function provided that the
function is of ﬁnite extent.

Quite surprisingly, a FROG trace of a pulse can be produced by an almost trivial device
composed of as few as ﬁve simple optical elements. This extremely simple device is called

GRENOUILLE [15]. It involves replacing the beam splitter, delay line, and beam combining
optics with a simple element, a Fresnel biprism (a prism with an apex angle close to 180◦).
When a Fresnel biprism is illuminated with a wide beam, it splits the beam into two beamlets

and crossed them at an angle yielding interference fringes. While fringes aren’t relevant to pulse
measurement, crossing beams at an angle is exactly what is required in conventional single-shot

autocorrelator and FROG beam geometries, in which the relative beam delay is mapped onto
horizontal position at the crystal (see Fig. 8). Beams that are split and crossed by a Fresnel

17

biprism are automatically aligned in space and in time, which is a signiﬁcant simpliﬁcation
with respect to conventional geometries. GRENOUILLE uses a thick SHG crystal, which not

only gives considerably more signal (signal strength scales as the approximate square of the
thickness), but also simultaneously replaces the spectrometer. It operates as a single-shot de-

vice. GRENOUILLE involves no beam-splitting, no beam-recombining, and no scanning of the
delay, and so has zero sensitive alignment degrees of freedom. Two additional cylindrical lenses

complete the device. The ﬁrst cylindrical lens must focus the beam into the thick crystal tightly
enough to yield a range of crystal incidence (and hence exit) angles large enough to include the

entire spectrum of the pulse. After the crystal, a cylindrical lens then maps the crystal exit angle
onto position at the camera, with the wavelength as a near-linear function of (vertical) position.

This device is capable of measuring complex pulses. This is because a FROG traces large

100 trace) giving sufﬁcient information ca-
number of points (about 10 thousands in a 100
pacity to measure a pulse with a large amount of structure. It is also possible to measure the

×

intensity distribution of a single ultrashort laser pulse. The entire trace can then be obtained on
a single camera image. An iterative phase-retrieval algorithm is used to ﬁnd the pulse ﬁeld for a
given trace. This algorithm works well and generally converges in a 0.1 second or so at modern

CPUs. The front panel of such femtosecond oscilloscope is shown in Fig. 9.

3 Operation of the optical modulator

The optical modulator consists of three elements: the optical seed laser, the modulator un-

dulator, and the dispersion section. The seed laser pulse interacts with the electron beam in
the modulator undulator which is resonant with the laser frequency ω, and produces the en-
ergy modulation in the electron bunch (see Fig. 10). The electron beam then passes through

/

the dispersion section where the energy modulation is converted to a density modulation at the
optical wavelength. The dispersion section is designed to introduce the energy dependence of
the particle’s path length, ∆z = R56δ
0. Several designs are possible, but the simplicity of
a four-dipole magnet chicane is attractive because it adds no net beamline bend angle or offset
and allows simple tuning of the momentum compaction factor, R56, with a single power supply
(see Fig. 11). The trajectory of the electron beam in the chicane has the shape of an isosceles
triangle with base length L. The angle adjacent to the base, θB, is considered to be small. For
ultra-relativistic electrons and small bend angles, the net compaction factor R56 of the chicane
is given by

E

E

R56 = Lθ2

B .

18

Let us consider operation of the dispersion section. The phase space distribution of the particles
in the ﬁrst undulator is described in the terms of distribution function f (P, ψ) written in ”energy-
phase” variables P =
0 is the nominal energy
of the particle and ω is the angular frequency. Before entering the ﬁrst undulator, the electron
energy distribution is assumed to be Gaussian:

0 and ψ = 2πz′/λ′ = ω(z/vz −

t), where

E − E

E

f0(P ) =

1

2π

(∆

h

)2

E

i

q

exp

 −

2

P 2
(∆

E

h

.

)2

!

i

]

V
e
M

[
 
 

E

1 .5

1 .0

0 .5

0 .0

-0 .5

-1 .0

-1 .5

 

0 .0

0 .5

1 .5

2 .0

 

1 .0
z/λ

Fig. 10. Phase space distribution of electrons at the exit of the modulator undulator. Solid line shows
laser induced energy modulation

Fig. 11. Schematic of dispersion section

19

The present study assumes the density modulation at the end of the modulator undulator to be
very small, and there is an energy modulation P0 sin ψ only. Then the distribution function at
the entrance to the dispersion section is

f0(P

P0 sin ψ) .

−

After passing through the dispersion section with dispersion strength d ψ/ d P , the electrons
of phase ψ and energy deviation P will come to the new phase ψ + P d ψ/ d P . Hence the
distribution function becomes

The dispersion strength parameter and compaction factor are connected by the relation

f (P, ψ) = f0

P

P0 sin

ψ

P

 

−

 

−

d ψ
d P !!

.

d ψ
d P

=

2π
λ′

d z′
d

0

E

=

2π
λ′

R56

0

E

.

The integration of the phase space distribution over energy provides the beam density distribu-
tion, and the Fourier expansion of this function gives the harmonic components of the density

modulation converted from the energy modulation [16]. At the dispersion section exit, we may
express current I in the form

I = I0

f (P, ψ) d P = I0 + 2I0

exp

∞

Z−∞

∞

Xn=1



−



1
2

n2

(∆

)2

h

E

i  

2

d ψ
d P !





Jn

nP0

×

 

d ψ
d P !

cos(nψ) .

We ﬁnd a set of harmonic waves, of which the fundamental term, with angular frequency ω, is
the one of importance in a radiator. This fundamental term involves the phase variation cos ψ,
and an amplitude term

a1 = 2J1

P0

exp

d ψ
d P !

 

1
2 h

(∆

)2

E

i  

d ψ
d P !



−



2

.





For small input signal we may assume that the argument of the Bessel function is small. The
function J1(X) approaches X/2 for small X, thus the microbunching approaches

(4)

(5)

a1 = P0

exp

d ψ
d P

1
2 h

(∆

)2

E

i  

d ψ
d P !



−



2

.





20

1

a

0 .6

0 .4

0 .2

0 .0

0

1

2

3

1

2
(dψ/dP)

P

0

 

3

p

(∆
h
p

E

i

Fig. 12. Dependence of a1, fundamental component of bunched beam current, on bunching param-
giving the relative amplitude of beam
eter X = P0 d ψ/ d P and on the parameter P0/
energy modulation. Curve 1: P0/
= 0.5. Curve 3:
= 1
P0/

)2
= 0.25. Curve 2: P0/

(∆
h

(∆
h

(∆
h

)2

)2

)2

p

E

E

E

i

i

i

p

The relation between a1 and bunching parameter for different values of energy spread is shown
in Fig. 12. We see that microbunching depends greatly on the choice of the dispersion sec-

tion strength. An attempt to increase the amplitude of the fundamental harmonic by increasing
the strength of dispersion section, is countered by a decrease of the exponential factor. The
microbunching a1 has clearly a maximum

and the optimum strength of the dispersion section is

(a1)max =

P0

h

,

)2

E

i

2.72

(∆

q

d ψ
d P !max

 

=

1

.

(∆

)2

E

i

h
q

0 = 500 MeV,
Let us consider numerical example for P0 = 250 keV,
and λ = 1047 nm. The calculation gives a1 = 0.1 at R56 = 30µm. The suppression factor in (5)
0.98. We come to the conclusion that we can treat
is equal to exp[
this situation as an optimum modulator design. The optimum condition for the replica synthesis

= 500 keV,

56/(2c2

h
q

2
0 )]

R2

ω2

(∆

(∆

)2

−

≃

E

E

E

E

i

h

i

)2

is that the modulator should present a rather weak dependence of the output modulation on the
local energy spread in the electron beam.

 

21

4 Operation of the optical radiator

Proposed technique of electron bunch diagnostics essentially exploits the properties of the
radiation generated by modulated electron beam in the undulator. To simplify consideration we

start with the case of a helical undulator. Later on all the results will be generalized for the case
of a planar undulator. The magnetic ﬁeld on the axis of the helical undulator is given by

~Hw = ~exHw cos(kwz)

~eyHw sin(kwz) ,

−

where kw = 2π/λw is the undulator wavenumber and ~ex,y are unit vectors directed along the x
and y axes of the Cartesian coordinate system (x, y, z). The Lorentz force ~F =
~Hw)/c
e(~v
e) and mass me in the
is used to derive the equations of motion of electrons with charge (
presence of the magnetic ﬁeld. The explicit expression for the electron velocity in the ﬁeld of
the helical undulator has the form:

×

−

−

~v⊥(z) = cθw[~ex cos(kwz)

~ey sin(kwz)] ,

−

which means that the electron in the undulator moves along a constrained helical trajectory par-
allel to the z axis. The angle of rotation is given by the relation θw = K/γ = λweHw/(2πmec2γ),
z . As a rule, the electron
where γ = (1
rotation angle θw is small and the longitudinal electron velocity vz is close to the velocity of
light, vz ≃

v2/c2)−1/2 is the relativistic factor and v2 = v2

x + v2

y + v2

−

c.

Let us consider periodically modulated relativistic electron beam moving along the z axis
in the ﬁeld of a helical undulator. In what follows we use the following assumptions: i) elec-
trons move along constrained helical trajectories in parallel with the z axis; ii) the radius of
the electron rotation in the undulator, rw = θw/kw, is much less than the transverse size of the
electron beam; iii) electron beam density at the undulator entrance is simply n = n0(~r⊥)[1 +
t)], where ain = const. In other words we consider the case in which there are
ain cos ω(z/vz −
no variations in amplitude and phase of the density modulation in the transverse plane. Under

this assumptions the transverse current density may be written in the form

~j⊥ =

e~v⊥n(~r⊥, z/vz −
−

t) =

e~v⊥n0(~r⊥)[1 + ain cos ω(z/vz −
−

t)] ,

where we calibrated the time in such a way that current density has its maximum at time t = 0, at
point z = 0. Even though the measured quantities are real, it is more convenient to use complex
representation. For this reason, starting with real ~j⊥, one deﬁnes the complex transverse current
density:

jx + i jy =

ecθwn0(~r⊥) exp(

−

i kwz)[1 + ain cos ω(z/vz −

−

t)] .

(6)

22

kwz

Transverse current have the angular frequency ω and two waves travelling in the same direction
ωt) will add to give a
with variations exp i(ωz/vz −
ωt) and exp
−
−
total current proportional to exp(
ωt)
i kwz) cos ω(z/vz −
ωt) indicates a slow wave. The use
indicates a fast wave, while the factor exp i(ωz/vz + kwz
of the word ”fast” (”slow”) here implies a wave with phase velocity faster (slower) than the
beam velocity.

i(ωz/vz + kwz
−
t). The factor exp i(ωz/vz −
−

kwz

−

−

Now we should consider the electrodynamic problem. Using Maxwell’s equations, we can

write the equation for the electric ﬁeld

c2 ~

∇ ×

(~
∇ ×

~E) =

∂2 ~E/∂t2

4π∂~j/∂t .

−

−

Then we make use of the identity

~
∇ ×

(~
∇ ×

~E) = ~
∇

(~
∇ ·

~E)

~
∇

−

2 ~E ,

~E can be found from the Poisson equation. Finally, we come to the inhomogeneous

where ~
wave equation for ~E:

∇ ·

2 ~E

c2 ~
∇

∂2 ~E/∂t2 = 4πc2 ~
∇

−

ρ + 4π∂~j/∂t .

This equation allows one to calculate the electric ﬁeld ~E(~r, t) for given charge and current
sources, ρ(~r, t) and ~j(~r, t). Thus, equation (7) is the complete and correct formula for radiation.
However, we want to apply it to a still simpler circumstance in which the second term (or,

the current term) in the right-hand side of (7) provides the main contribution to the value of
the radiation ﬁeld. Since in the paraxial approximation the radiation ﬁeld has only transverse

components, we are interested in the transverse component of (7). Thus we consider the wave
equation

2 ~E⊥

c2 ~
∇

−

∂2 ~E⊥/∂t2 = 4π∂~j⊥/∂t ,

which relates the transverse component of the electric ﬁeld to the transverse component of
current density.

We wish to examine the case when the phase velocity of the current wave is close to the

velocity of light. This requirement may be met under resonance condition

(7)

(8)

(9)

ω/c = ω/vz −

kw .

First we may point out that the statement of (9), the condition for the relation between ω, kw
and vz, is the condition for synchronism between the transverse electromagnetic wave and the

23

kw. With a current wave trav-
fast transverse current wave with the propagating constant ω/vz −
elling with the same phase speed as the electromagnetic wave, we have a possibility of (space)

resonance between electromagnetic wave and electrons. If this is the case, cumulative interac-
tion between bunched electron beam and transverse electromagnetic wave takes place. We are

therefore justiﬁed in considering the contributions of all the waves except the synchronous one
to be negligible.

Any state of transverse electromagnetic wave can always be written as a linear combination

of the two base states (polarizations). By given the amplitudes and phases of these base states
we completely describe the electromagnetic wave state. It is usually best to start with the form
which is physically clearest. We choose the Cartesian base states and seek the solution for ~E⊥
in the form

Ex,y = ˜Ex,y(z, ~r⊥) exp[i ω(z/c

t)] + C.C.

−

Here and in what follows, complex amplitudes related to the ﬁeld are written with a tilde. The
description of the ﬁeld given by (10) is quite general. However, the usefulness of the concept of
carrier wave number is limited to the case where the amplitude is slowly varying function of z.

To determine the form of ˜Ex,y(z, ~r⊥) we substitute (6) and (10) into (8), and have inside the

undulator

exp[i ω(z/c

t)]

−

(
cos(kwz)

= 4π

ω
c  

−

Here ~
∇
(11) is equal to zero.

2
⊥ +

~
∇

2 i ω
c

∂
∂z

+

∂2
∂z2

˜Ex
˜Ey!

)  

+ C.C.

sin(kzz)!

eθwainn0(~r⊥) sin ω(z/vz −

t) .

2
⊥ is the Laplace operator in transverse coordinates. At z > Lw the right-hand side of

Now we have apparently simple pair of equations – and they are still exact. We simplify
the equations by noting that for a radiation ﬁeld it is reasonable to assume that ˜Ex,y are slowly
varying function of z so that ∂2 ˜Ex,y/∂z2 may be neglected. The corresponding requirement for
˜Ex,y |
. In other words, the radiation pulse must
the complex amplitude is
not change signiﬁcantly while travelling through a distance comparable with the wavelength
λ = 2π/k. This assumption is not a restriction. Such is the case in all practical cases of interest.
Differential equations becomes

∂ ˜Ex,y/∂z

|≪

k

|

|

(10)

(11)

exp[i ω(z/c

t)]

−

2
⊥ +

~
∇

(

2 i ω
c

∂
∂z )  

˜Ex
˜Ey!

+ C.C.

24

cos(kwz)

= 4π

ω
c  

−

sin(kzz)!

eθwainn0(~r⊥) sin ω(z/vz −

t) .

(12)

Although equations (12) cannot be solved in general, we will solve them for some special cases.
These equations can be simpliﬁed further by noting that the complex amplitudes ˜Ex,y will not
vary much with z, especially in comparison with the oscillating terms exp(
i kwz). The slow
wave of transverse current oscillates very rapidly about an average value of zero and, therefore,
does not contribute very much to the rate of change of ˜Ex,y. So we can make a reasonably good
approximation by replacing these terms by their average value, namely zero. We will leave them

−

out, and take as our approximation:

2
⊥

~
∇

 

˜Ex
˜Ey!

+

2 i ω
c

∂
∂z  

˜Ex
˜Ey!

=

i
1!

− 

ω
c

2π

eθwainn0(~r⊥) exp(

i Cz) .

−

(13)

ω/c

kw will also
Even the remaining terms, with exponents proportional to C = ω/vz −
vary rapidly unless C is near zero. Only then will the right-hand side vary slowly enough that
any appreciable amount will accumulate when we integrate the equations with respect to z.
The required conditions will be met if C
kwz. In other words, we use the
resonance approximation here and assume that complex amplitudes ˜Ex,y are slowly varying in
the longitudinal coordinate. By ”slowly varying” we mean that
. For
this inequality to be satisﬁed, the spatial variation of ˜Ex,y within the undulator period λw =
2π/kw has to be small.

∂ ˜Ex,y/∂z

˜Ex,y |

kw ,

|≪

kw

≪

≪

−

1

|

|

Equations (13) are simple enough and can be solved in any number of ways. One convenient

way is the following. Taking the sum and the difference of the two we get

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

( ˜Ex + i ˜Ey) = 2π i

eθwainn0(~r⊥) exp(

i Cz) ,

−

ω
c

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

( ˜Ex −

i ˜Ey) = 0 .

(14)

(15)

These equations describe the general case of electromagnetic wave radiation by the modulated
electron beam in the helical undulator. Equations (14) and (15) refer to the right- and left-helicity
components of the wave, respectively. The solutions for the right- and left-helicity waves are

linearly independent. It follows from (14) and (15) that only those waves are radiated that have
the same helicity as undulator ﬁeld itself.

The electric ﬁeld, ~E⊥, of the wave radiated in the helical undulator in resonance approxi-

mation is circularly polarized and may be represent in the complex form:

Ex + i Ey = ˜E(z, ~r⊥) exp[i ω(z/c

t)] .

−

25

Finally, the equation for ˜E can be written in the form

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

˜E = 2π i

eθwainn0(~r⊥) exp(

i Cz) .

−

ω
c

(16)

Equation (16) is an inhomogeneous parabolic equation. Its solution can be expressed in terms
of a convolution of the free-space Green’s function (impulse response)

G(z

−

z′, ~r⊥

~r′
⊥) =

−

1
4π(z

z′)

−

exp

i ω

~r⊥
|
2c(z

"

2

|

~r′
⊥
z′)

#

−
−

with the source term. When the right-hand side of (16) is equal to zero, it transforms to the

well-known paraxial wave equation in optics.

The radiation process displays resonance behavior, and the amplitude of electric ﬁeld de-
pends strongly on the value of the detuning parameter C. With the approximation made in
getting (16) the equation can be solved exactly. Now we will ﬁnd an exact solution for the case
of perfect resonance. When the parameters are tuned to perfect resonance, such that C = 0, the
solution of the equation (16) has the form

˜E(z, ~r⊥) =

i eθwωain
2c

z

Z0

d z′
z′

−

z

Z

d ~r⊥n0(~r′

⊥) exp

i ω

~r⊥
|
2c(z

"

−
−

2

|

~r′
⊥
z′)

,

#

(17)

where (z, ~r⊥) and (z′, ~r′
tively.

⊥) are the coordinates of the observation and the source point, respec-

Let us consider an axisymmetric electron beam with gradient proﬁle of the current density.
In this case we have
j0S(r), where r is the radial coordinate of the cylindrical
system (r, φ, z) and S(r) describes the transverse proﬁle of the electron beam. To be speciﬁc,
we write down all the expressions for the case of a Gaussian transverse distribution:

evzn0(~r⊥) =

−

−

evzn0(~r⊥) =

−

I0
2πσ2 exp

−

 −

r2
2σ2

,

!

where I0 is the total beam current. Then we can write (17) in the form

˜E(z, r) =

i eθwωainI0
2c

∞

z

d z′
z′

z

Z0

−
i ω(r′)2 + i ωr2

Z0

d r′r′ exp

(r′)2
2σ2

#

"−

J0

×

 

ωr′r
z′
z

−

exp

!

"

2c(z

.

#

z′)

−

It is convenient to rewrite this expression in a dimensionless form. After an appropriate normal-
ization it is a function of one dimensionless parameter only:

(18)

26

(19)

(20)

ˆE = f (ˆz, ˆr, N) =

J0

×

ˆz

 

exp

!

ˆr′ˆr
ˆz′

−

∞

ˆz

d ˆz′
i
ˆz′
N
ˆz
Z0
Z0
−
i(ˆr′)2 + i ˆr2
ˆz′) #
2(ˆz

"

−

.

d ˆr′ˆr′ exp

(ˆr′)2
2N #

"−

kr2/Lw, k = ω/c, Lw is the total undulator length, N = kσ2/Lw is the
where ˆz = z/Lw, ˆr =
diffraction parameter (or, Fresnel number of the electron beam), ˆE = ˜E/E0 is the normalized
ﬁeld amplitude, and

q

E0 =

θwωainI0
2c2

.

Integrating ﬁrst with respect to ˆr′, we have

ˆz

ˆE = i

Z0

ˆz

−

d ˆz′
ˆz′ + i N

exp

"−

2(ˆz

−

i ˆr2
ˆz′ + i N) #

.

The integration over source coordinate ˆz′ can be performed without great difﬁculty in limiting
case, namely, the case of diffraction parameter very large compared with unity. In this case the
integral in (20) is calculated analytically

ˆE =

exp

ˆz
N

ˆr2
2N !

 −

as N

1 .

≫

It is convenient to express electric ﬁeld inside the wide electron beam in dimension form

˜E(z, ~r⊥) = πeθwzainn0(~r⊥) =

θwzainI0
2cσ2

exp

 −

r2
2σ2

!

as N

1 .

≫

(21)

Note that this result is completely general: that is, it applies for any electron beam proﬁle. To
calculate equation (17) we note that the behavior of Green’s function for kσ2
Lw approaches
≫
the behavior of the delta function. The source function n0(~r′
⊥) does not vary very much across
Lw/k in the case of wide electron beam: therefore we can replace it by
the region
≃
a constant. In other words, we simply take n0(~r′

⊥) outside the integral sign and call it n0(~r⊥).

~r′
⊥

~r⊥

−

|

|

2

The radiation ﬁeld distribution at the exit of undulator is one of the important characteristics
of the radiator. For the case of Gaussian electron beam proﬁle transverse proﬁle of the radiation
ﬁeld is presented in Fig. 13. Since the slow varying ﬁeld amplitude ˆE(ˆz, ˆr) is given by complex
function of the transverse coordinate, the wavefront of output radiation is not plane. It is inter-
esting to trace the variation of the ﬁeld phase across the radiation beam. Bottom plot in Fig. 13

shows the distribution of the phase of the radiation beam for several values of the diffraction
parameter N.

27

 N  = 0 .0 1

 N  = 0 .1

 N  = 1

 N  = 1 0

 

 

1

2

3

4

5

 N  = 0 .0 1

 N  = 0 .1

 N  = 1

 N  = 1 0

1 .0

0 .8

0 .6

0 .4

0 .2

|
)
0
(

E

 
/
 
)
r
(

E

|

0 .0

0

)
0
(

ϕ

 
-
 
)
r
(

ϕ

6

5

4

3

2

1

0

0

1

2

3

4

5

Fig. 13. Electron beam with Gaussian proﬁle: transverse distribution of the ﬁeld amplitude (top) and
phase (bottom) at the radiator undulator exit for several values of the diffraction parameter N from 0.01
to 10. Here detuning parameter C = 0

It is interesting to plot the normalized amplitude of electric ﬁeld as a function of diffraction
parameter in order to see how sensitive it is to electron beam size. At this point we ﬁnd it

convenient to impose the following restriction: we focus only on the radiation seen by observer
lying on the electron beam axis. We show such a plot in Fig. 14. When ˆr = 0 we can write (20)

 

^
r

 

^
r

28

0

E

 
/
 
|

~

E

|

5

4

3

2

1

0
0 .0 1

 

0 .1

1

1 0

Fig. 14. Electron beam with Gaussian proﬁle. The reduced radiation ﬁeld amplitude versus the diffraction
parameter at ˆz = 1, ˆr = 0. Here detuning parameter C = 0. Dashed line shows asymptote of thin electron
beam. Dotted line shows asymptote of wide electron beam

in the form

ˆE = f (ˆz, 0, N) = i

ˆz

Z0

ˆz

−

d ˆz′
ˆz′ + i N

= arctan

+

ln

1 +

ˆz
N !

 

i
2

 

ˆz2
N 2

.

!

Let us study the asymptotic behavior of the ﬁeld amplitude at the large values of the diffraction
parameter N. In this case ˆz/N

1 and we have asymptotically:

≪

ˆE = f (ˆz, 0, N)

ˆz/N

as N

→

.

→ ∞

Now let us study the asymptote of a thin electron beam. In this case N
f (ˆz, 0, N) can be estimated simply as:

→

0 and the function

ˆE = f (ˆz, 0, N)

→

π/2 + i ln(ˆz/N)

as N

0 .

→

(22)

0, amplitude ˜E is a
Special attention is called to the fact that in the thin beam case, at N
complex function. One immediately recognizes the physical meaning of the complex ˜E. Note
that electric ﬁeld (response) is given by the fast wave of transverse current (”force”) times
a certain factor. This factor can either be written as p + i q, or as certain magnitude ρ times
exp(i δ). If it is written as a certain amplitude ρ times exp(i δ), let us see what it means. This
tells us that electric ﬁeld is not oscillating in phase with the fast wave of transverse current,

→

 

N

29

ωt, but is shifted by an extra amount δ. Therefore
which has (at C = 0) the phase ψ = ωz/c
δ(z) represent the phase shift of the response. For the experts in FEL physics we should add that
logarithmic terms in (22) and logarithmic growth rate asymptote for conventional FEL ampliﬁer
at small diffraction parameter (see [17]) are ultimately connected.

−

From practical point of view it is necessary to know the ﬁeld distribution in the space after
the undulator, at z > Lw. When the radiation ﬁeld leaves the undulator, it is subjected to the
parabolic equation

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

˜E = 0 .

It follows from the latter equation that the ﬁeld amplitude in the space after the undulator and
the ﬁeld amplitude at the undulator exit are connected by

˜E(z, ~r⊥) =

1

−

4π(z

Lw) Z

d ~r′

⊥ ˜E(Lw, ~r′

⊥) exp

i ω

~r⊥
|
2c(z

"

−
−

2

~r′
⊥
|
Lw) #

.

The subject of particular interest is the angular distribution of the radiation intensity. The
radiation ﬁeld at the undulator exit may be presented as a superposition of plane waves, all with
the same wave number k = ω/c. The value of k⊥/k gives the sine of the angle between the z
axis and the direction of propagation of the plane wave (we consider the axisymmetric case).
θ. The angular distribution of the radiation
In the paraxial approximation k⊥/k = sin θ
intensity, I(θ), can be expressed as follows:

≃

I(θ)
I(0)

Ξ(θ)
Ξ(0)

2
2 ,

|
|

= |
|

where Ξ(θ) is the spatial Fourier transform of the complex amplitude of the radiation ﬁeld,
˜E(z, r) at the exit of the undulator. In the axisymmetric case the spatial Fourier transform of
the radiation ﬁeld is given by

Ξ(ˆθ, N) =

ˆE(1, ˆr, N)J0(ˆθˆr)ˆr d ˆr ,

∞

Z0

where ˆθ = √kLwθ and J0 is the Bessel function of the ﬁrst kind. Using (20), we ﬁnd the
expression for the angular distribution of the radiation intensity,

I(θ)
I(0)

= |
|

Ξ(θ)
Ξ(0)

2
2 =

sin ˆθ2/4
ˆθ2/4 #

"

2

|
|

exp

N ˆθ2

.

−
(cid:16)

(cid:17)

At large value of diffraction parameter N the far zone approximation may be used when z0/(kσ2)
1, where z0 is the distance between the observation point and the undulator exit. When N < 1

≫

30

 

 N  = 0 .0 0 1

 N  = 0 .0 1

 N  = 0 .1

 N  = 1

 N  = 1 0

 

)
0
(
I
 
/
 
)
θ
(
I

1 .0

0 .8

0 .6

0 .4

0 .2

0 .0

0

2

4

θ^

6

Fig. 15. Electron beam with Gaussian proﬁle. Angular distribution of the radiation intensity for several
values of the diffraction parameter N from 0.001 to 10. Here detuning parameter C = 0

Lw. Figure 15 presents the angular distribution of the ra-
the above condition changes to z0
diation intensity for the coherent undulator radiation in the case of Gaussian proﬁle of electron
beam. One can see that the radiation power is mainly concentrated in the small angle near the z
axis. At large value of the diffraction parameter the distribution is approximately equal to

≫

Ξ(ˆθ)
Ξ(0)

exp(

N ˆθ2)

−

2 →

as N

.

→ ∞

In the case of a thin electron beam we have asymptotically:

Ξ(ˆθ)
Ξ(0)

2

sin ˆθ2/4
ˆθ2/4 #

2 → "

as N

0 .

→

2

2

|
|

|
|

|
|

|
|

Let us investigate qualitatively the process of coherent undulator radiation. To get an intu-
itive picture on what happens with the radiation beam let us ﬁrst choose a thin beam asymptotic.

This is an example in which diffraction effects play an important role. Simple physical consid-
eration can lead directly to a crude approximation for the radiation beam cross-section. There is
a complete analogy between the radiation effects of the bunched electron beam in the undulator

and the radiation effects of a sequence of periodically spaced oscillators. The radiation of these
oscillators always interferes coherently at zero angle with respect to the undulator axis. When all
the oscillators are in phase there is a strong intensity in the direction θ = 0. An interesting ques-
zθ and a long base
tion is, where is the minimum? If we have a triangle with a small altitude r

≃

31

z

zθ2/2.
z, then the diagonal s is longer than the base. The difference is ∆ = s
When ∆ is equal to one wavelength, we get a minimum because the contributions of various
oscillators are then uniformly distributed in phase from 0 to 2π. In the limit of small size of the
(√kz)−1. In the
electron beam interference will be constructive within an angle of about θc
limit of large electron beam size, the ﬁeld is concentrated mainly inside the electron beam. The
radiation ﬁeld across the electron beam may be present as a superposition of plane waves. We
(kσ)−1,
can expect that the typical width of the angular spectrum should be of the order θc
1.
simply a consequence of the reciprocal width relations of the Fourier transform pair ∆k⊥σ

r2/2z

≃

≃

≃

≃

−

≃

≃

The boundary between these two asymptotes is about kσ

σ2
dif = Lw/k. A rough estimate for the diffraction effects to be small is σ

√kLw or (another way to write
it) σ2
Lw/(kσ),
which simply means that the diffraction expansion of the radiation at undulator length must be
much less than the size of the beam. Another way to write this condition is kσ2/Lw = N
1.
As we mentioned above, the diffraction parameter N can be referred to as the electron beam
Fresnel number.

≫

≫

≃

Let us consider the electromagnetic power. The well-known Poynting vector represents the
electromagnetic power ﬂow. In the paraxial approximation the diffraction angles are small, the

vectors of electric and magnetic ﬁeld are equal in absolute value and are perpendicular to each
other. Thus, the expression for the radiation power, W , can be written in the form:

W =

c
4π Z |

~E⊥

2 d ~r⊥ =

|

c
4π Z |

˜E(z, ~r⊥)

d ~r⊥ ,

2

|

where (
) denotes averaging over a cycle of oscillation of the carrier wave. If we consider a
system with ﬁelds and bunched electron beam in an undulator, the energy stored in any volume

· · ·

ﬂuctuates sinusoidally with time. But on the average there is no increase or decrease in the
energy stored in any portion of the volume.

Now we shall calculate the output power. To determine the W we substitute (18) into (23).
It is convenient to write the expression for W in a dimensionless form. After an appropriate
normalization it is a function of one dimensionless parameter only:

(23)

(24)

where N = kσ2/Lw is the diffraction parameter, ˆW = W/W0 is the normalized power, and W0
is

ˆW = F (N) ,

W0 =

πθ2

0 a2
wωI 2
8c2

inLw

.

32

(25)

(26)

Substituting the expression for ˜E from (20) into (23), we obtain:

F (N) =

arctan

+ N ln

2
π "

1
2N (cid:19)

(cid:18)

4N 2

4N 2 + 1 !#

 

.

In Fig. 16 we present a plot of this universal function. The physical implication of this result are
best understood by considering some limiting cases. We have asymptotically:

F (N)

1/(2πN)

as

N

,

→ ∞

→

→

F (N)

1

as

N

0 ,

→

Let us notice a remarkable feature of that plot. In the limit of a thin electron beam, N
radiation power tends to a constant value W
the transverse size of the electron beam is rather weak.

0, the
W0 and the dependence of output radiation on

→

→

For practical purposes it is convenient to express W0 in an explicit form:

W0 = Wb

π2a2
in
2 # "

I
γIA # "

K 2
1 + K 2

"

#

Nw ,

where Wb = mec2γI0/e is the total power of electron beam, IA = mec3/e
17 kA is the
Alfven current. Let us make a calculation of W for some cases. Suppose ain = 0.3, I0 = 3 kA,
γ = 103, K = 5.4, Nw = 5; then by equation (26) it follows that W0
500 MW. If the laser
wavelength λ = 1µm, the normalized transverse emittance ǫn = 2πµm, focusing beta function
is equal to 1 m, the diffraction parameter is about 0.04. Remembering the previous result (see

≃

≃

Fig. 16) we come to the conclusion that we can treat this situation as a coherent undulator
radiation with thin electron beam.

It is relevant to make some remarks on the region of applicability of the results of this

section. One of the basic assumptions of the theory is that the radius of the electron rotation in
the undulator, rw = θw/kw, is much less than the transverse size of the electron beam. Taking
into account that θw = K/γ, we can write

σ2
r2
w

=

1 + K 2
K 2

z σ2k2
γ2

w

=

(cid:16)

(cid:17)

1 + K 2
K 2

(πNwN)

1 .

≫

Thus, the requirement for the parameter σ2/r2
1. When
the diffraction parameter N is much larger than (πNw)−1, the radius of the electron rotation in
the undulator is always much less than the transverse size of the electron beam. In our example
(πNw)−1. We should say that this particular case is at the boundary of the region
we have N
of the applicability of our theory.

w to be large can be written as πNwN

≫

≃

33

1 .0

0 .8

0 .6

0 .4

0 .2

0

W

 
/
 

W

 

0 .0

-3

1 0

-2

1 0

-1

1 0

N

0

1 0

1

1 0

Fig. 16. Electron beam with Gaussian proﬁle. The reduced output power versus the diffraction parameter.
Solid curve is calculated with analytical formula (25). Dashed curve shows an asymptote for a wide
electron beam. Here the detuning parameter is C = 0

The formula for the output power which we derived (24) refer to the case of the helical
undulator. It can be simply generalized for the case of a planar undulator. The magnetic ﬁeld on
the axis of the planar undulator is given by

~H = ~exHw cos(kwz) .

~v⊥ =

~eycθw sin(kwz) ,

−

The explicit expression for the electron velocity in the ﬁeld of the planar undulator has the form:

where θw = K/γ = λweHw/(2πmec2γ). The constrained motion of the electron in the planar
undulator differs from that in the helical one. An important feature of this motion is that lon-
gitudinal velocity vz of the electron oscillates along the undulator axis which creates deﬁnite
problems for the description of the radiation process. It is not hard to go through the derivation
of radiation power again. If we do that, and calculate the power in the same way, we get that
all the expressions for the planar undulator are identical to those for the helical undulator. The

only difference is the appearance of different numerical factors taking their origin from the av-
eraging procedure. One can obtain that expression for power written down in the reduced form
is identical for both undulator conﬁgurations. As a result, the universal plot ˆW = F (N) in Fig.
16 is applicable to the case of planar undulator, too. The only difference is that the following

 

34

deﬁnition of normalization factor for the radiator with planar undulator should be used:

πθ2

wA2

JJω0I 2

0 a2

inLw

, 16c2

W0 =

where

AJJ = [J0(Q)

J1(Q)] ,

−

Jn(Q) is a Bessel function of nth order, and

Q = θ2

wω0/(8kwγ2) = K 2/(4 + 2K 2) .

When we simpliﬁed the expression for Q, we used the resonance condition for the planar undu-
lator ω0 = 2γ2kw/[c(1+K 2/2)]. For practical purposes it is convenient to rewrite the expression
for W0 in the form

W0 = Wb

π2a2
in
2 # "

"

I

γIA # "

K 2
2 + K 2

#

A2

JJNw .

Let us present a speciﬁc numerical example for the case of a radiator with a planar undu-
lator. With the numerical values λw = 6.5 cm, K = 7.6, γ = 103, the resonance value of
wavelength is λ = 1µm. If the number of the undulator periods Nw = 5, the amplitude of
density modulation ain = 0.3, the beam peak current I0 = 3 kA, the radiation power is about
W = W0F (N)

250F (N) MW.

≃

All of the foregoing discussion of coherent undulator radiation has been concerned solely
for the radiation at resonance – that is ω = ω0 = 4πγ2
z c/λw. Now, we would like to ﬁnd
out how the output radiation varies in the circumstance that seed signal frequency ω is nearly,
but not exactly, equal to ω0. According to the radiation equation (16), the radiation process is
determined by the detuning C = kw + ω/c
ω/vz which is the function of the seed laser
−
frequency, energy of the electron beam and the undulator parameter. It is not hard to go through
the derivation of output radiation power again. If we take C
= 0, the solution of the wave
equation (16) has the form

˜E(z, ~r⊥) =

i eθwωain
2c

d ~r⊥n0(~r′

⊥) exp

× Z

i Cz′)

z

d z′

Z0
i ω

z

−
~r⊥
|
2c(z

"

−

2

z′ exp(
~r′
⊥
z′)

−
−

|

.

#

35

When the electron beam proﬁle is Gaussian, we can write (27) in a dimensionless form:

(27)

6
-4

-3

-2

-1

 N  = 1 0

 N  = 1 0

 N  = 1 0

 N  = 1 0

 N  = 1

 N  = 1 0

 N  = 1 0

 N  = 1 0

 N  = 1 0

2

3

4

)
0
(
W

 
/
 
)

(

C
W

<

1 .0

2 .0

1 .5

0 .5

0 .0

 

0
^
C

-2 0

-1 0

1 0

2 0

 

Fig. 17. Electron beam with Gaussian proﬁle. The reduced output power versus the reduced detuning ˆC
for various values of Fresnel number
ˆz

∞

d ˆr′ˆr′ exp

(ˆr′)2
2N #

"−

i ˆC ˆz′)

exp(

−

i
N

d ˆz′
ˆz′
ˆz

Z0

Z0
−
i(ˆr′)2 + i ˆr2
ˆz′) #
2(ˆz

= i

ˆz

d ˆz′
ˆz′ + i N

Z0

ˆz

−

ˆE = f (ˆz, ˆr, N, ˆC) =

J0

×

ˆz

 

exp

!

ˆr′ˆr
ˆz′

−

exp

×

"−

2(ˆz

−

−

"
i ˆr2
ˆz′ + i N) #

exp

i ˆC ˆz′

.

−

(cid:16)

(cid:17)

(28)

We use the notations similar to those introduced above. Also, an additional parameter of the
problem, the dimensionless detuning parameter ˆC = CLw, appears in the theory, since we take
into account resonance behavior. Let us express ˆC in terms of physical parameters. The detuning
parameter ˆC is connected by the simple relation with the frequency deviation: ω
ω0 = ∆ω =
2πNw∆ω/ω0, where Nw is the number of radiator undulator

z C. Thus, we obtain ˆC =

−

−

2γ2
−
periods.

Let us now study the inﬂuence of the detuning on the radiation process. In Fig. 17 the

output power is shown as a function of reduced detuning for different values of diffraction
parameter. One can see that the radiation process displays resonance behavior and the output
power depends strongly on the value of the detuning parameter ˆC. It is seen from the plot that
at large value of Fresnel number the resonance curve is simply that of the interference factor,

f ( ˆC) =

sin2( ˆC/2)
( ˆC/2)2

.

36

x
a
m

0 .6

I
 
/
 
)
θ
(
I

1 .0

0 .8

0 .4

0 .2

0 .0

1 .0

0 .8

x
a
m

0 .6

I
 
/
 
)
θ
(
I

0 .4

0 .2

0 .0

0

 

 

θ^

0 .4
θ^

N  = 1

N  = 1 0

 C = -1 0

 C = 0

 C = 1 0

N  = 1 0

-1

 C = -1 0

 C = 0

 C = 1 0

 

 

0 .0

0 .1

0 .2

0 .3

0 .5

0 .6

0 .7

0 .8

2

6

8

 C = -1 0

 C = 0

 C = 1 0

N  = 1 0

-2

 C = -1 0

 C = 0

 C = 1 0

 

 

1 .0

0 .8

x
a
m

0 .6

I
 
/
 
)
θ
(
I

0 .4

0 .2

0 .0

0

1 .0

0 .8

x
a
m

0 .6

I
 
/
 
)
θ
(
I

0 .4

0 .2

0 .0

0

 

4
θ^

 

4
θ^

1

2

3

2

6

8

Fig. 18. Electron beam with Gaussian proﬁle. Angular distribution of the radiation intensity for several
values of the diffraction parameter. Curves correspond to the detuning parameter ˆC =

10, 0, and 10

−

1, the resonance curve is
One can see that this formula works well at N
visibly modiﬁed due to diffraction effects. One can see from this plot that the resonance curve is
not completely symmetrical function of the detuning parameter ˆC, the asymmetry being greater
for smaller Fresnel number. The reason for this is that at small values of diffraction parameter
the angular distribution of the radiation corresponds to that emitted by a simple one electron. To

10. Then, at N

≃

≃

explain this phenomena, we should analyze the angular distribution of the radiation intensity.
Even without performing calculations, we can expect angular-frequency dependence for the
output radiation in the case of a thin electron beam asymptote. As we can see from Fig. 18,

numerical calculations in the far zone conﬁrm this simple physical consideration.

5 Discussion

Successful operation of the ultrashort-pulse-measurement device (FROG) requires the ful-

ﬁllment of several requirements. The requirement for the spatio-temporal pulse distortions to
be small is of importance for the performance of the FROG measurement apparatus. One of

37

the problems is the measurement of the pulses that have signiﬁcant spatial structure, for ex-
ample, a pulse whose transverse size varies along the pulse. For the FROG is of great interest

to minimize ultrafast variation of the optical replica transverse size which is due to emittance
variation along the electron bunch. Obviously, this requirement is easier to achieve for a thin

electron beam asymptote. On the other hand, such ultrafast variation of the pulse transverse size
is an essential characteristic of the optical replica in a wide electron beam case, since it reﬂects

behavior of a slice emittance. The obvious solution of this problem is as follows. A technique
best suited for the pulses with spatial structure consists of expanding the radiation beam and

ﬁltering out the central part to almost constant transverse size. A spatial ﬁlter can be realized
by using optical arrangement where a telescope is placed between replica synthesizer exit and
FROG device. The pulse to be measured is propagated through the hole which spatially ﬁlters

the pulse. The important point is that electric ﬁeld of such ﬁltered pulse contains completely
the same information about transverse size of the electron bunch as initial pulse. If the electron
beam is wide, N
1, then electric ﬁeld of the ﬁltered replica is inversely proportional to the
square of electron beam E(t)

I(t)/σ2(t).

const.

≫

≃

×

One of the big unsolved problems of the electron bunch diagnostics is measurement of

bunches that have signiﬁcant distortions in transverse phase space, for example, a bunch whose
transverse phase space ellipse varies from point to point in the beam. We have considered in

section 2 a simpliﬁed model of the electron beam and used the following assumptions: i) the
electron beam transverse proﬁle is assumed to be axisymmetric; ii) Twiss parameters are equal

in all slices (although emittances are different). Such a beam can, in principle, be realized in an
”idealized” RF photoinjector with a perfectly working emittance compensation technique [18]

that allows one to align slices in transverse phase space. For real beam, the variation in the space
charge forces can be signiﬁcant and cannot be properly compensated with solenoidal emittance
compensation that was observed in different measurements [19–21]. In addition, CSR-related

effects in bunch compressors can lead to further deviations from the simple model. It is clear
that a knowledge of the variation of phase space ellipse along the bunches at the output of the

bunch formation system could provide signiﬁcant information about the physical mechanisms
responsible for generation of ultrashort bunches. Here we would like to discuss a further ex-

tension of the proposed diagnostic method that can allow one to determine Twiss parameters in
axial slices that are only a µm-long fraction of the full bunch length.

A very simple approach, involving simultaneous ”quadrupole-scan” and ”hole-scan” tech-

niques, yields the solution. The main idea can easily be understood taking into account the fact
that in the limit of a wide electron beam we measure the beam size, and therefore, we can,

in principle, use a standard ”quadrupole-scan” technique. Moreover, the method of spatial ﬁl-
tering described above allows one to determine a transverse distribution of the beam density

38

in each slice. Indeed, in the limit of a wide beam the electric ﬁeld at the undulator exit (21)
is directly proportional to the beam density distribution (this holds also for non-axisymmetric
beam when both sizes, in x
directions, are much larger then a diffraction size). FROG
technique and spatial ﬁlter allow the two-dimensional slice density distribution measurements

and y

−

−

to be made using a ”hole-scan” technique. Therefore, one can do a quadrupole scan (using a
system of quadrupoles) by changing phase advance but keeping all slices in a wide beam limit.

For each settings of the quadrupoles one does two-dimensional scan with a ﬁlter, checking that
slice sizes are in the limit of wide beam. Then emittances and Twiss parameters in each slice

are reconstructed by the standard method. If there are offsets and angles of slice centroids (due
to CSR effects, for example), they can also be reconstructed from this measurement. Note also
that after two-dimensional scan of the hole one gets three-dimensional map of the electric ﬁeld

amplitude that is a copy of three-dimensional density distribution in the electron bunch. Since
total charge is known, the unknown absolute value of the current density can be determined,

too. This approach appropriately can be referred to as bunch phase space tomography.

The main emphasis of previous considerations was concentrated on the measurements of
ultrashort (sub-100 fs long) electron bunches. The method proposed can be also applied for

measurements of long (a few ps) bunches, too. Measurements of such bunches is practically
important problem. The X-ray FEL bunch compressors consist of a series of magnetic chicanes.

To setup the compression, the bunch structure needs to be measured before and after each com-
pression stage. In addition, once the bunch compressors are set up, a bunch length feedback

system will be required for stabilization of the compression. The electron pulse durations of
interest are approximately 10, 2 and 0.2 ps, respectively. The big advantage of the proposed

diagnostic technique is the absence of apparent limitations which would prevent determination
of the structure of electron bunches even without bunch compression in the injector linac. Ac-
cording to our discussion above, the pulse energy of optical replica is proportional to the value

of the peak current which is relatively weak dependence. The energy of radiated pulse is about
10µJ for the case when I = 3 kA. The energy per pulse is decreased by only a factor 30, down
to sub-µJ level for I = 100 A. FROG technique still works well for such parameters of optical
pulse. It has been used to measure pulses from a few fs to many ps in length. It has measured

pulses from pJ to mJ in energy. FROG has proven to be a general technique that works [9].

Operation of the proposed scheme was illustrated for the parameters of the European XFEL.
Although the present work is illustrated for the electron beam energy of 0.5 GeV, its applicabil-

ity is not restricted to this range. For example, LCLS bunch compressor system [5] is a suitable
candidate for application of diagnostic techniques described here.

39

6 Conclusion

Sub-100 fs ultrarelativistic electron bunches, which only a few years ago seemed like wish-
ful thinking, are now effectively generated in the accelerator test facilities and have given a rise

to ultrafast X-ray applications. The femtosecond time scale is beyond the range of standard elec-
tronic display instrumentation, and the development of the methods for the measurement of the
longitudinal beam current distribution in such short bunches is undoubtedly a challenging prob-

lem. In this paper we proposed a new method for ultrashort electron pulse-shape measurements.
Making the use of the ultrashort laser pulse-shape measurement device (FROG) together with

carefully designed undulator-based optical replica synthesizer allow the electron bunch length
measurement with resolution of about a few femtosecond. We demonstrate that proposed mea-

suring device can be used to determine the electron current proﬁle for a single ultrashort electron
bunch, which makes it an ideal online tool for optimization of complex bunch compression sys-
tems. In general case the electron bunches may have signiﬁcant emittance and energy spread

variation along the bunch. Proposed device is capable to measure both of these electron bunch
distortions quantitatively, too. An important feature of the method is that all steps of the optical

replica synthesis are controlled by means of the choice of the undulator parameters, dispersion
section strength and value of beta function. Data sets of beta function and dispersion section

strength scans actually contain all the required information for retrieval of the slice properties
of the bunch. Thus, proposed technique combines full-information electron bunch measurement

with much-needed experimental simplicity. The only requirement for the proposed technique is
the capability of the electron bunch to generate 1µm radiation, which implies a minimum on
the electron energy of about one hundred MeV. However, this limit nicely ﬁts in the design

parameters of bunch compression systems for XFELs. Another key element – laser pulse-shape
measurement device (FROG) – is now a standard and well-developed tool. All key elements of

measuring device have already been established. Operating range of proposed diagnostic tech-
nique nicely includes that of most ultrashort X-ray FEL injector linacs, so it should be ideal for

most everyday diagnostics as well as many more exotic ones.

Acknowledgments

We thank G. Geloni for many useful discussions. We thank R. Brinkmann, J.R. Schneider,

A. Schwarz, and D. Trines for interest in this work.

40

References

[1] V. Ayvazyan et al., Phys. Rev. Lett. 88(2002)104802.

[2] V. Ayvazyan et al., Eur. Phys. J. D20(2002)149.

[3] TESLA Technical Design Report, DESY2001-011, edited by Richard et al., and http://tesla.desy.de.

[4] P. Audebert et al., “TESLA XFEL: First stage of the X-ray laser laboratory – Technical design report

(R. Brinkmann et al., Eds.)”, Preprint DESY 2002-167.

[5] The LCLS Design Study Group, LCLS Design Study Report, SLAC reports SLAC-R-593 (2002)

and http://www-ssrl.slac.stanford.edu/lcls/CDR.

[6] M. Borland et al., Nucl. Instrum. and Methods A483(202)268.

[7] M. Dohlus et al., ”Start-to-End Simulations of SASE FEL at the TESLA Test Facility, Phase 1”

Preprint DESY 03-197, DESY, Humburg, 2003; Nucl. Instrum. and Methods (in press).

[8] P. Emma et al., Phys. Rev. Lett. 92(2004)074801.

[9] R. Trebino, Frequency-Resolved Optical Gating: Measurement of Ultrashort Laser Pulses, Kluwer

Academic Publishers, Boston, 2002.

[10] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Nucl. Instrum. and Methods A429(1999)233.

[11] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Nucl. Instrum. and Methods A490(2002)1.

[12] Heifets, G. Stupakov and S. Krinsky, Phys. Rev. ST Accel.Beams 5(2002)064401.

[13] Z. Huang and K.-J. Kim, Phys. Rev. ST Accel.Beams 5(2002)074401.

[14] Jean-Claude Diels and W. Rudolph, Ultrafast Laser Phenomena, Academic Press, San Diego, 1996.

[15] P. O’Shea et al., Opt. Lett., vol 26, p. 932(2001).

[16] P.L. Czonka, Part. Accel.8,225(1978).

[17] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, The physics of Free Electron Lasers, Springer,

Berlin-Heidelberg-New-York, 1999.

[18] B. E. Carlsten, Nucl. Instrum. and Methods A285(1989)313.

[19] W. S. Graves et al., SLAC-PUB-9440 August 2002.

[20] D. H. Dowell et al., Nucl. Instrum. and Methods A507(2003)327.

[21] M. Krasilnikov et al., ”Optimizing the PITZ Electron Source for VUV FEL”, presented at EPAC

2004, Lucerne, Switzerland, July 2004.

41

