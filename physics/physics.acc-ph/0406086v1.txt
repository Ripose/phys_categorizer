4
0
0
2
 
n
u
J
 
8
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
6
8
0
6
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Production of Enhanced Beam Halos via Collective Modes and Colored Noise

Ioannis V. Sideris1 and Courtlandt L. Bohn2
1,2Department of Physics, Northern Illinois University, DeKalb, IL 60115
2Fermi National Accelerator Laboratory, Batavia, IL 60510

We investigate how collective modes and colored noise conspire to produce a beam halo with much
larger amplitude than could be generated by either phenomenon separately. The collective modes
are lowest-order radial eigenmodes calculated self-consistently for a conﬁguration corresponding to
a direct-current, cylindrically symmetric, warm-ﬂuid Kapchinskij-Vladimirskij equilibrium. The
colored noise arises from unavoidable machine errors and inﬂuences the internal space-charge force.
Its presence quickly launches statistically rare particles to ever-growing amplitudes by continually
kicking them back into phase with the collective-mode oscillations. The halo amplitude is essentially
the same for purely radial orbits as for orbits that are initially purely azimuthal; orbital angular
momentum has no statistically signiﬁcant impact. Factors that do have an impact include the
amplitudes of the collective modes and the strength and autocorrelation time of the colored noise.
The underlying dynamics ensues because the noise breaks the Kolmogorov-Arnol’d-Moser tori that
otherwise would conﬁne the beam. These tori are fragile; even very weak noise will eventually break
them, though the time scale for their disintegration depends on the noise strength. By contrast,
tori associated with a root-mean-square mismatched beam are very robust, breaking down only in
the presence of strong noise. Collective modes are therefore centrally important to the dynamics of
halo formation in real beams.

PACS numbers: 45.10.-b, 52.25.Fi, 29.27.-a

I.

INTRODUCTION

We recently demonstrated [1] that the combination of
colored noise and global oscillations in intense charged-
particle beams can create much larger halo amplitudes
than would arise in the absence of noise. This was done
using generic ‘particle-core’ models as representations
of time-dependent potentials associated with nonequilib-
rium beams [2, 3]; the ‘core’ established a time depen-
dence in the form of a harmonic oscillation reminiscent of
the presence of a global collective mode, and test particles
orbited in response to that potential. Ever-growing halos
were found to form despite the fact that large-amplitude
orbits spend considerable time under the inﬂuence of the
external focusing forces, and the frequencies associated
with these forces diﬀer from those associated with the
core oscillation, a circumstance that impedes resonance.
Thus, the noise has a key inﬂuence, boosting statistically
rare particles to ever-growing amplitudes by continually
kicking them back into phase with the core oscillation.
The importance of this ﬁnding lies in the accelerator’s
extreme sensitivity to beam loss. For example, in a light-
ion accelerator, beam impingement of just
1 W/m at
energies exceeding
20 MeV will cause enough radioac-
tivation to preclude hands-on machine maintenance. In
high-average-current machines, this amounts to just a
few particles lost per meter, and large halos are thereby
of practical concern, even if their outermost fringe is ex-
tremely tenuous.

∼

∼

Our previous analysis was restricted to radial orbits
and centered on choosing the same initial conditions for
all of the orbits. Speciﬁcally, each orbit was assigned
zero initial velocity and the same initial radius. Because
in a real beam each individual particle has its own dis-

tinct initial conditions (for example, the particles would
start at diﬀerent angular coordinates), each experiences
its own manifestation of colored noise. Thus, we sequen-
tially computed 10,000 orbits while assigning to each
orbit its own unique, random manifestation of the col-
ored noise, and we cataloged the maximum amplitudes
of these orbits. Though this approach proved suﬃcient
to demonstrate the noise-enhanced production of beam
halo, it suﬀers a number of shortcomings. First, it lacks
self-consistency; with one exception, the oscillation fre-
quencies of the core were chosen ad hoc, the exception
relating to a space-charge-limited core, which is of course
an unphysical model. Second, because only a single start-
ing radius is sampled, it lacks the statistics of a full treat-
ment; halo particles originating from, e.g., diﬀerent radii
are excluded. Third, the contribution of nonradial orbits
is likewise ignored.

The present paper oﬀers a study that, by largely cir-
cumventing these shortcomings, is more thorough and
systematic. Herein we consider self-consistent collective
oscillations in the context of a general framework. Specif-
ically, we consider a direct-current, cylindrically sym-
metric beam and model it as a warm-ﬂuid Kapchinskij-
Vladimirskij (KV) equilibrium conﬁguration [4]. We then
imagine the beam to be excited such that it possesses
a self-consistent spectrum of collective radial modes of
oscillation as previously calculated by Strasburg and
Davidson [5]. The associated time-dependent space-
charge force combines with the external focusing force
to determine the equation of motion of test particles. By
populating the full conﬁguration space with very many
(typically 106) test particles, quasi-self-consistently as-
signing each test particle its own random manifestation
of colored noise, and then tracking their orbits, we com-
pute the evolution of the halo. We do this for two ex-

tremes of initial particle velocities, the ﬁrst corresponding
once again to purely radial orbits, and the second corre-
sponding to purely circular orbits. The halo structure
depends, of course, on (a) the beam parameters, which
we combine into a single quantity, the space-charge tune
depression, (b) the collective-mode parameters, speciﬁ-
cally their amplitudes in that their frequencies are de-
termined self-consistently, and (c) the noise parameters,
speciﬁcally the noise strength and autocorrelation time.
In the investigation to follow, we quantify the vari-
ous parametric dependencies. Section II explains our
methodology in detail. Section III presents an extensive
array of results that together quantify how the beam and
noise parameters conspire to produce large halos.
In-
cluded is an interpretation of the underlying dynamics
in terms of the breaking of Kolmogorov-Arnol’d-Moser
(KAM) tori [6] due to the presence of noise. Section IV
concludes by brieﬂy summarizing the ﬁndings and, in
view of them,
identifying related phenomenology that
will be inherent to fully self-consistent large N -body sim-
ulations of real beams.

II. METHODOLOGY

As our foundation, we adopt directly the formalism
of Strasburg and Davidson [5], hereafter called SD. We
consider an intense, direct-current charged-particle beam
propagating in the z direction at constant speed through
a transport channel that imposes a constant, cylindrically
symmetric, linear transverse focusing force. The equi-
librium beam is a warm-ﬂuid Kapchinskij-Vladimirskij
equilibrium, and collective modes are superimposed upon
this equilibrium. These modes correspond to stable, ax-
isymmetric ﬂute perturbations and derive from lineariz-
ing the respective Vlasov-Maxwell-Poisson equations [4].
The inﬂuence of the beam’s self-ﬁelds on particle trajec-
tories is properly included within the framework of the
paraxial approximation.

We incorporate the beam parameters by way of the di-
mensionless self-ﬁeld perveance K given per the gaussian
system of units as

K =

2ρq2
β2γ3mc2 ,

2

1, the lower bound corresponding to the space-charge-
limited beam, and the upper bound corresponding to zero
space charge.

SD tabulate the potentials and frequencies correspond-
ing to all of the axisymmetric-ﬂute normal modes. The
frequency of the nth such mode is given by

ωn(η2) = ωf

2[1 + η2(2n2

1)] .

(3)

−

p

For their studies of particle dynamics, SD concentrate on
the two lowest-order radial modes, n = 1, 2, and we shall
do likewise. We normalize the radial coordinate in terms
of the radius Ro; however, unlike SD, we normalize time
t in terms of the angular frequency ωf , i.e., t
ωf t. In
eﬀect we are setting Ro = 1 and ωf = 1.

→

A. Equation of Test-Particle Motion

To explore the dynamics of halo formation, we com-
pute orbits of test particles that move in the total poten-
tial formed by the superposition of the external focusing
potential and the space-charge potential. The test par-
ticles contribute nothing to the total potential, i.e., they
do not interact with each other. This means we treat
the coarse-grained form of the beam’s distribution func-
tion, thereby ignoring, e.g., discreteness eﬀects from the
individual point charges that comprise the beam. Using
the formalism herein, it may be possible to mimic dis-
creteness eﬀects by modeling them as appropriately weak
gaussian white noise [7], i.e., noise that has zero autocor-
relation time, but we refrain from doing so in favor of
concentrating on the inﬂuence of colored noise.

The equation of test-particle motion decomposes into
two regimes, one for which the normalized radial coor-
dinate r < 1, and the other for which r
1. If only the
n = 1, 2 normal modes are excited, then the SD equation
with our normalization is

≥

¨r + η2r

−

(1

−

η2)r

Γ1 cos[ω1(η2)t]

+

Γ2(1

r2) cos[ω2(η2)t]
}

= 0 for r < 1;

{

p

L2
r3 −
3
2
1

−

(1)

¨r + r

p
−

L2
r3 −

η2

−
r

= 0

for r

1;

(4)

≥

wherein ρ is the line density (number of particles per
unit length), q and m are the particle charge and mass,
respectively, β and γ are the usual relativistic factors,
and c is the speed of light. The perveance then folds into
the space-charge tune depression η as

η

1
≡ "

−

2

1/2

βc
ωf Ro (cid:19)

(cid:18)

K

#

,

(2)

in which Ro is the radius of the equilibrium beam and ωf
is the angular frequency associated with the bare external
focusing force. This parameter lies in the range 0

η

≤

≤

in which L is the dimensionless angular momentum, Γn
is the ratio of the root-mean-square (rms) electrostatic
energy contained in collective mode n to that contained
in the equilibrium beam, and ωn is given by Eq. (3) af-
ter setting ωf = 1. The constants L, Γ1, and Γ2 may
be regarded as free parameters, the former in regard to
the ‘geometry’ of the test-particle orbit, and the latter
in regard to the ‘amplitudes’ of the respective collective
modes. However, because it derives from linear perturba-
tion theory, for Eq. (4) to be valid, both Γ1 and Γ2 must
be small compared to unity. Note that the tune depres-
sion η manifests itself not only in the mode frequency,

but also in the frequency characterizing the eﬀective fo-
cusing force acting on the test particle. Hence, any noise
that shows up in the tune depression inﬂuences both of
these frequencies.

B. Colored Noise

It is at this point that we depart in an important way
from the SD treatment, for we wish to assess the extent to
which noise, in combination with the collective mode(s),
inﬂuences the particle dynamics. This is a problem of
practical importance; noise is unavoidable in real accel-
erators because they are imperfect. Machine imperfec-
tions in the form of, e.g., misalignment of components
combined with external ﬁeld ﬂuctuations and errors, will
generate noise in the space-charge potential as the beam
responds self-consistently to the machine imperfections.
Concerning our upcoming analysis, for zero noise we of
course reproduce the dynamics that SD describe. Thus,
any diﬀerences that show up with nonzero noise are at-
tributable solely to the presence of the noise itself. Our
main interest is to quantify how this noise inﬂuences the
process of halo formation, and do so to an extent well
beyond what we did previously.

Following the philosophy and procedure of our ear-
lier investigation [1], we add gaussian colored noise that
samples an Ornstein-Uhlenbeck process [8]. We do so
in terms of a frequency ﬂuctuation δω(t). Because the
tune depression η incorporates the space charge, we de-
ﬁne this frequency ﬂuctuation in terms of a ﬂuctuating
tune depression in the manner

η2 + δη2(t) ;

η2
δη2(t)

→

≡

ω1δω(t) =

2(1 + η2)δω(t) .

(5)

p

The frequency ﬂuctuation δω(t) henceforth represents
the noise. Thus, everywhere it occurs in the equation of
motion, Eq. (4), the quantity η2 is replaced by η2+δη2(t),
with δη2(t) given by the last expression in Eq. (5) above.
Note, for example, that the noise will still manifest itself
in Eq. (4) even if no collective mode is excited.

The ﬁrst two moments of δω(t) fully determine the

statistical properties of the noise:

δω(t)
i
h
δω(t)δω(t1)
i
h

= 0 ;
= A2 exp(

t
−|

−

t1|

/tc) ;

(6)

in which tc denotes the autocorrelation time, i.e., the
time scale over which the signal changes appreciably. The
0.
special case of white noise corresponds to the limit tc →
After generating a colored-noise signal using an algorithm
ﬁrst presented in Ref. [9], we compute
which
then constitutes the measure of noise strength. Example
manifestations of colored noise for various noise strengths
and autocorrelation times appear in Fig. 1 of Ref. [1].

| ↔ h|

A
|

δω

|i

In a real beam each individual particle will have its own
distinct initial conditions and thus experience a manifes-
tation of the noise diﬀering from that seen by each of the

3

other particles. Accordingly, at every time step during
the integration of the equation of motion, a randomly
generated increment is added to the tune depression in
keeping with the speciﬁed statistical properties of the
colored noise. How the noise quantitatively aﬀects halo
formation depends on its strength and its autocorrelation
time, dependencies that we quantify herein.

C.

Initial Distribution of Test-Particle Orbits

In keeping with the objective of retaining as much real-
ism as possible, we choose a beam intermediate between
the space-charge-limited beam (η = 0) and the zero-space-
charge beam (η = 1). Speciﬁcally, we keep η ﬁxed at the
value η = 0.3 for our entire investigation.

We choose an initial distribution of test particles that
spans all of the dynamically interesting regions of con-
ﬁguration space and falls gradually to a low-density tail.
Of course there are numerous ways to do this; one is
to choose a distribution corresponding to a conﬁguration
of thermal equilibrium (TE) [10, 11]. We construct a
cylindrically symmetric TE conﬁguration of test charges
following a procedure recently used to devise spherically
symmetric TE conﬁgurations [12]. The associated dimen-
sionless Poisson equation is

1
R

d
dR

R

dΦ
dR

(cid:18)

(cid:19)

=

e

−

− 1

2
2 Ω

R

2−Φ(R) =

n(R) ,

(7)

−

≃

wherein R is a dimensionless radial coordinate, n(R)
denotes the number density normalized to the central
density, Ω is a dimensionless quantity governing the
strength of the external focusing force vis-`a-vis the col-
lective space-charge force, and Φ(R) is the dimensionless
space-charge potential. For the value of Ω we choose
Ω = (1 + 10−3.5
10−9)/√2. Integrating Eq. (7) numer-
ically using this speciﬁc value of Ω yields a TE density
proﬁle corresponding to a tune depression η

0.3 [11].

−

Length and time are normalized diﬀerently in Eq. (7)
than in Eq. (4). In keeping with the desire to span all
of the dynamically interesting regions of conﬁguration
space, we simply rescale the density distribution n(R)
calculated from Eq. (7) so that its rms radius ˜R corre-
sponds to the full radius Ro of the warm-ﬂuid KV dis-
tribution: ˜R = Ro = 1. This clearly places a sizeable
population of test particles, that corresponding to much
of the density tail, outside the KV ‘core’. It also mim-
ics, e.g., an inference from the recent beam-halo exper-
iment at the Low-Energy Demonstration Accelerator at
Los Alamos National Laboratory that the input beam
for this experiment carried a sizeable tail in its distribu-
tion [13]. For all of our investigations the initial radii
of the test particles follows this distribution. Most of
our simulations involve N = 106 test particles, a num-
ber suﬃcient to constitute a good statistical sample. In
principle, the tenuous tail of the density proﬁle extends
to inﬁnity, but in practice there is a ﬁnite radius to the
N -body representation of the density because N is ﬁnite.

For most of our investigations the initial test-particle
velocities are all set to zero, corresponding to purely ra-
dial orbits, in which case we then replace r(t) by x(t),
and r(t) < 1 or
1, respectively, in
x(t)
|
|
Eq. (4). We also, however, consider another ‘limiting’
case, that for which all the orbits are initially circular.
Given a radius rc of the initially circular orbit, the re-
spective dimensionless angular momentum L, a quantity
taken to be conserved, follows from Eq. (4):

< 1 or

1 by

≥

≥

L2 =

η2r4
c
r4
c −

(1

η2)r2
c

for rc < 1,
1.
for rc ≥

(cid:26)

−
As is shown and discussed in Sec. III C 3 below, the in-
ﬂuence of noise on circular orbits that start with rc < 1 is
essentially the same as for the purely radial orbits. Con-
sequently, the halo population is similar for both cases.

(8)

D. Orbit Integrations

We integrate the equation of motion using a ﬁfth-order
Runge-Kutta algorithm with variable time step [14] tak-
ing the initial time step to be 0.01 ‘diﬀerential-equation’
(DE) units. We evolve each orbit for a total time 512
DE units, which corresponds to 40-60 orbital periods de-
pending on the initial conditions for the respective orbit.
Thus, for example, the total integration time is compara-
ble to the transit time of the beam through a large pro-
ton linear accelerator such as that associated with the
Spallation Neutron Source [15]. In the absence of time-
dependence and noise, i.e., with Γ1 = Γ2 =
= 0,
the algorithm conserves energy within a fractional error
10−9 at each time step and within 10−7 over the whole
integration.

δω

|i

h|

h|

|i

δω

Our investigation spans a broad sector of the param-
eter space in that the space-charge tune depression, set
at η = 0.3, is the only parameter that is never varied. We
treat all combinations of the following parametric val-
ues: mode amplitudes Γ1,2 = 0.05, 0.10, and 0.20; noise
strengths
=0.0, 0.001, 0.01, and 0.1; autocorrela-
tion times tc = 0.5, 1, 2, 10, 80, and 160; and test-particle
sample sizes N = 102, 103, 104, 105, and 106. Most of the
plots shown herein pertain to the speciﬁc choice tc = 80;
however, excursions to lower and higher values are in-
cluded to provide a check on the sensitivity of halo for-
mation to the autocorrelation time of the noise. In a real
machine, of course, the noise will incorporate a range, or
‘superposition’, of autocorrelation times and strengths.
In addition, with one exception (Fig. 8), all of the plots
we show pertain to radial orbits, i.e., cases for which all
of the test particles have L = 0 in Eq. (4).

III.

INFLUENCE OF COLORED NOISE ON

HALO FORMATION

SD explored the dynamics of test-particle motion in the
absence of noise. The form of their equation of motion

4

diﬀered slightly from our Eq. (4) in that they normalized
the time in terms of the space-charge-depressed focusing
frequency rather than the external focusing frequency.
Notwithstanding the diﬀerent normalization, the physi-
cal content remains unchanged. SD discovered that the
time-dependent potential associated with the presence of
a collective axisymmetric ﬂute mode, even if only weakly
excited, establishes a chaotic region of phase space in
the outer regions of the beam. They also found that
this feature is not present in the phase space of a beam
having a similar level of rms mismatch but no collective
mode (cf. Fig. 9 of Ref. [5]). An important consequence
of the chaotic sea is that orbits entering it can stochas-
tically explore a larger region of phase space, thereby
gaining more energy and correspondingly larger orbital
amplitude. SD consequently demonstrated that the ex-
citation of collective modes leads to a halo signiﬁcantly
larger than that generated by rms mismatch, and that
the diﬀerence is due to destabilization of KAM surfaces
by the collective mode. As we will now see, the presence
of colored noise substantially enhances the inﬂuence of
the collective modes.

A. Orbital Dynamics

−

Halo formation is inextricably linked to the dynam-
ics of individual orbits. Consequently, a close inspection
of what happens to an individual orbit because of the
noise will be instructive. We arbitrarily select an orbit
that originates deep in the interior of the beam; the ini-
tial conditions are x =
0.733407 and ˙x = 0. We then
integrate the orbit for 2048 DE units to obtain good fre-
quency resolution in its power (Fourier) spectrum. The
trajectory and power spectrum of this orbit are plotted
in Fig. 1 with Γ1 = 0.1, Γ2 = 0, and tc = 80, and for a
sequence of successively increasing noise strengths. With
zero noise the power spectrum is sharply peaked at a sin-
gle frequency indicating that the orbit is periodic, hence
regular, and the trajectory x(t) clearly reﬂects this pe-
riodicity. However, in the presence of even weak noise
the orbit clearly becomes chaotic, having a power spec-
trum that features continua. A useful measure of chaos
is the number of frequencies Kf that together contain a
given fraction f of the spectral power. This measure is
called the ‘complexity’ of the orbit; a common choice is
f = 0.9 [12]. Accordingly, a broader spectrum indicates
a higher degree of chaos. Concerning the orbit in Fig. 1,
the noise has obviously placed it in a chaotic region of
the phase space established as a consequence of the time-
dependent potential associated with the collective mode.
How this happens is clariﬁed in Sec. III E below.

As is also apparent from Fig. 1, the degree of orbital
chaoticity as quantiﬁed via the complexity K0.9 is not
necessarily a simple, i.e., monotonic, function of the noise
strength. To reiterate, the power spectrum, hence the
complexity, derives from the history of the orbit and
thereby reﬂects a superposition of successive short-time

behaviors. An orbit that spends a relatively large fraction
of time at large amplitudes, over which the net force is
predominantly that of the harmonic external potential,
will tend to be ‘more regular’ and have smaller K0.9.
As concerns a single, speciﬁc orbit (so no phase-space
statistics are involved), what matters is not so much the
amplitude of the noise, but rather whether a sequence
of noise-induced kicks happens to make the orbit more
chaotic, and these kicks are, of course, unpredictable a
priori. Our experiments indicate that a sequence of kicks
leading to increased orbital chaoticity and/or increased
orbital amplitude will occur sooner for some orbits and
later for others. In simulations involving many test parti-
cles distributed over a range of initial conditions, features
of the evolving test-particle distribution are thus mani-
festly statistical.

B. Evolution of the Halo Amplitude

We now evolve initial distributions of N = 106 test
particles constructed per the prescription of Sec. II C. As
the orbit integrations progress, we record a ‘snapshot’ of
the test-particle positions once every eight DE time units.
This interval approximately corresponds to the period of
a typical orbit in the unperturbed SD potential, which we
call the ‘dynamical time’ tD: 8 DE units
1 tD. For every
snapshot we record the largest radius reached by any of
the N particles; the collection of these radii represents
the evolving halo amplitude RH (t).

≃

h|

|i

δω

Example results are plotted versus time in Fig. 2, for
which the mode amplitudes and autocorrelation time are
ﬁxed at Γ1 = 0.05 or 0.1, Γ2 = 0, and tc = 80, and the
noise strength
is varied from zero upward. As the
ﬁgure indicates, in the absence of noise the halo ampli-
tude is quasiperiodic, and its time-averaged value stays
the same, i.e., it does not grow. This is as expected [3, 5].
A particle ‘resonantly’ coupled to the collective mode is
kicked to larger amplitudes. However, because its or-
bital frequency changes as its amplitude changes, at suf-
ﬁciently large amplitude the particle decouples from the
mode and its amplitude ceases to grow. Diﬀerences be-
tween the external focusing force and the collective space-
charge force thus impose a hard upper bound on the halo
amplitude. The presence of noise, however, drastically
changes this scenario. Occasionally successive kicks from
the noise will happen to be ‘just right’ to keep a particle
in phase with the mode for an eﬀectively longer time and
thereby push it beyond the upper bound (i.e., outer KAM
torus) characterizing the noise-free case. The halo am-
plitude RH (t) continues to grow, and the growth appears
to be almost linear with time (at least after the ﬁrst few
oscillations). Over the range of noise strengths
we
explore, both stronger noise and larger mode amplitudes
enhance halo growth. Moreover, when the noise is strong
(e.g.,
= 0.1, i.e., roughly 10% of the collective-mode
frequency), pronounced halo growth occurs in just a few
(
∼

5) dynamical times.

δω

δω

|i

|i

h|

h|

5

N

Consider the largest orbital amplitude reached by any
particle over the course of a simulation, i.e., the largest
halo amplitude, and denote this amplitude as max(RH ).
This quantity will of course vary with the number of test
particles N in the simulation. Because the number of
particles that can be incorporated into N -body simu-
lations is inherently limited by available computational
power, it is of interest to know how sensitive the halo
amplitude can be to the choice of N . To quantify this
sensitivity we adjust the test-particle population between
102
106 particles. Then we perform a number of
experiments with diﬀerent noise strengths and diﬀerent
values of Γ1 (with Γ2 = 0 and tc = 80). Results pertaining
to Γ1 = 0.05 and 0.1 appear in Fig. 3. Because there is a
hard upper bound to the halo amplitude in the absence
of noise, max(RH ) is essentially independent of N for the
case
= 0 provided N is sensibly large. This is not
true when noise is present; the noise establishes a quasi-
logarithmic dependence of max(RH ) on N , a ﬁnding that
is in keeping with our earlier results [1]. Larger values
of Γ1 yield larger values of max(RH ), but the scaling of
max(RH ) with N remains roughly the same.

δω

≤

≤

|i

h|

h|

|i

|i

δω

δω

Results presented thus far correspond to a single au-
tocorrelation time tc = 80
10 tD. What happens if tc
≃
is much shorter or much longer? Plots of maximum halo
amplitude max(RH ) versus tc for a sequence of increasing
noise strengths
, and with only the n = 1 collective
mode active, appear in Fig. 4. Data points in these plots
each correspond to a sample of N = 104 test particles;
simulations with N = 106 are found to give similar re-
sults but, of course, they involve much longer run times.
In most cases the halo extent is seen to be only weakly
dependent on autocorrelation time. The exception per-
tains to large noise strength; the curve corresponding to
= 0.1, i.e., a 10% ﬂuctuation in the collective-mode
h|
frequency, generates substantially larger halo for tc < 100.
The presence of such large noise would seem to be anoma-
lous in a real accelerator, and one might thus presume the
halo amplitude will normally be independent of hard-
ware details associated with the establishment of noise
correlations. However, under circumstances that lead to
a turbulent beam as might reside, for example, at and
just downstream of the beam source and at large hard-
ware transitions, one might indeed expect the particle
orbits to experience large noise from space charge locked
in the turbulent eddies. Such circumstances would seem
normally to be transient, with the large-scale turbulence
mixing away in a few dynamical times. Nevertheless, be-
cause it would form rapidly, a sizeable halo would likely
= 0.1 curves in Fig. 2.
arise as evidenced from the

δω

h|

|i

C. Evolution of the Test-Particle Distribution

1. Halo Density

Not just the halo amplitude is of interest, but so is
the halo density. A convenient and meaningful rep-

→

100% in the limit R

resentation of the test-particle distribution is obtained
by calculating the percentage of particles lying outside
let us call this P (r > R) while noting
a radius R;
that P (r > R)
0. Plots of
log10[P (r > R)] versus R computed at t = 512 appear in
Fig. 5. Here again, the mode amplitudes and autocor-
relation time are ﬁxed at Γ1 = 0.05 or 0.1, Γ2 = 0, and
tc = 80, and the noise strength
is varied over a
considerable range. As a general trend the distribution
spreads to larger radii, i.e., the halo amplitude grows, as
the noise strength increases.

δω

→

|i

h|

One might anticipate that the n = 2 mode would cou-
ple to a statistically small set of particles in a manner
that measurably increases the halo extent beyond that
corresponding to the n = 1 mode acting alone. As seen
from Fig. 6, adding the n = 2 mode does modify the dis-
tribution, though its eﬀect appears to be modest.

2. Mixing and Halo Formation

To visualize how orbits mix, we integrate collections of
1600 test-particle initial conditions clumped into tightly
localized regions of phase space. The integrations are
done both without and with noise; the evolution of these
collections is depicted in Fig. 7. Rows (a)-(c) pertain
to the absence of any collective mode, i.e., Γ1 = Γ2 = 0.
In the absence of noise [row (a)] all mixing is due to a
frequency spread across the initial clumps arising from
the nonlinear net force. Separation of the initially local-
ized particle trajectories then proceeds as a power law
in time; this is regular phase mixing, i.e., linear Landau
damping. Noise [rows (b) and (c)] inﬂuences the eﬀec-
tive focusing force acting on the test particles, but this
inﬂuence generates no signiﬁcant spreading to large or-
bital amplitudes. Turning on the n = 1 collective mode
changes the situation completely. With Γ1 = 0.05, but
in the absence of noise [row (d)], the clumps still spread
only to a restricted region of phase space; however, the
same is clearly not true when noise is included [rows (e)
and (f)]. Noise causes a far more eﬃcient mixing. Even
= 0.01, thoroughly and
moderately weak noise, e.g.,
h|
exponentially mixes particles, regardless of their starting
points, into all regions of the phase space accessed by the
beam. Their exponential separation into global regions
of phase space is the principal signature of chaotic mix-
ing [12]. Increasing Γ1 further accentuates this chaotic
mixing and causes the orbits to ﬁll an even larger phase-
space area.

δω

|i

3. Circular vs. Radial Orbits

6

ries at t = 0; the corresponding values of angular momen-
tum L are assigned according to Eq. (8). We then solve
Eq. (4) without and with noise in the space-charge tune
depression. This, however, means that we refrain from
adding noise to the azimuthal motion. To do otherwise
would vitiate using angular momentum as an integral of
the motion and thereby lengthen the computations, all
for the ‘beneﬁt’ of incorporating no fundamentally new
or important additional phenomenology.

In Fig. 8 results for the halo amplitude RH (t) [panel
(a)] and halo distribution P (r > R) [panel (b)] are jux-
taposed against those pertaining to purely radial orbits.
Although the curves are not identical, neither are they
systematically diﬀerent. We attribute the diﬀerences to
statistical ﬂuctuations caused by the random noise in-
cluded in the simulations. This ﬁnding is interesting in
that particles on circular orbits with rc(0)
1 essentially
lie outside the inﬂuence of the time-dependent poten-
tial arising from the collective modes, whereas particles
on radial orbits do not. That halo proﬁles correspond-
ing to radial versus azimuthal orbits are similar therefore
suggests that particles initially in the ‘core’, for which
r(0) < 1, are the ones that dominate the process of halo
formation independent of their initial conditions in ve-
locity space. By reproducing RH (t) with the initial radii
truncated at r(0) = rc(0) = 1, we veriﬁed that this sug-
gestion is indeed true.

≥

D. Collective Modes vs. RMS Mismatch

The preceding results have illustrated how collective
modes, orbital chaoticity, and noise collaborate to drive
an ever-growing halo. It turns out that the presence of
collective modes underlies the whole dynamical picture.
To see this, consider, by contrast, a beam that is rms-
mismatched [16, 17]. The corresponding equation of test-
particle motion is similar to that governing a beam with
a single excited collective mode, except now the ‘core ra-
dius’ R = R(t), i.e., the radius deﬁning the ‘inside’ of the
beam, is a function of time. Speciﬁcally, the dimension-
less equation governing the core radius is

¨R + R

η2
R3 −

1

η2

−
R

−

= 0 ,

(9)

which then folds into the dimensionless single-particle
equation of motion

¨r + r

−

¨r + r

−

1

η2

−
R2
1

−
r

η2

r = 0

for r < R ,

= 0

for r

R .

(10)

≥

Thus far all simulations have pertained to radial test-
particle orbits. Might the results be substantially diﬀer-
ent for orbits with nonzero angular momentum? To an-
swer this question, we now consider the other extreme,
that for which all test particles are on circular trajecto-

We deﬁne the mismatch parameter M
R(0)/Ro, with
Ro = 1 denoting the radius of the matched beam, and
1) cos[ω1(η2)t]. For small mismatch
then set R
1) cos[ω1(η2)t]
(M
2(M
1
in Eq. (10). By comparing with Eq. (4) and otherwise

→
−
1) we put R−2(t)

1+(M

≪

→

≡

−

−

−

1

−

1)2.

4(M

neglecting the diﬀerent deﬁnitions of core radii, we then
infer a loose correspondence between the mismatch M
and its collective-mode counterpart: Γ1 ↔
Now, taking the core radius to be r = R(t) as per-
tains to rms mismatch rather than r = 1 as pertains
to collective modes has a profound eﬀect on the mix-
ing, hence the halo dynamics. Figure 7 [row (g)] il-
lustrates the mixing in a rms-mismatched beam. Here
the mismatch is M = 1.1118, for which the counter-
part collective-mode amplitude Γ1 = 0.05. Accordingly,
the parameters of Fig. 7(g) are analogous to those of
Fig. 7(f). What is striking is how comparatively con-
strained the phase mixing and halo growth turn out to
be in the rms-mismatched beam. The underlying dynam-
ics are clearly and radically diﬀerent. How so?

The answer lies in the Poincar´e surfaces of section
(PSS); as SD point out [5], these are distinctly diﬀer-
ent for the two cases. The PSS for the rms-mismatched
beam exhibits robust, densely packed KAM tori in the
region of phase space exterior to the beam. This is true
even if the mismatch is large. These tori inhibit the par-
ticles from gaining signiﬁcant energy and reaching large
amplitudes. The collective mode, by contrast, breaks
the tori in the vicinity of the beam edge r = 1. As a
consequence, particles are then much more free to move;
they can stochastically and rapidly explore a large region
of phase space. SD point out that consequently orbital
amplitudes of test particles can rapidly increase as the
amplitude of the collective mode is raised, whereas test
particles gain negligible energy as the amplitude of the
rms mismatch is raised. SD’s ﬁndings pertain to zero
noise; we ﬁnd nonzero noise substantially magniﬁes them.
In the absence of KAM tori, a series of small, successive
kicks can much more easily push a particle to ever larger
radii if a collective mode, rather than a rms mismatch, is
active. Moreover, the associated time scale is short; sig-
niﬁcant extended halo can form in just a few dynamical
times, i.e., orbital periods.

E. Noise-Induced Breakdown of Tori

To visualize noise-induced disintegration of tori with
consequent halo formation, we plot the Poincar´e sections
of 18 test-particle orbits having initial conditions that
collectively represent the whole of conﬁguration space.
We take only the n = 1 mode to be excited, with am-
plitude Γ1 = 0.05, and integrate the 18 trajectories for a
total time t = 2048 (about 250 tD). We do a series of these
= 10−6
δω
experiments, starting with a noise strength
|i
and successively increasing it to 10−5, 10−4, 5
10−4,
×
and 10−3; for every experiment we set tc = 80. We record
the positions and velocities of the particles at every pe-
riod T = 2π/ω1. For each experiment the respective PSS
is shown in Fig. 9; diﬀerent colors denote diﬀerent orbits.
The Poincar´e sections clarify the underlying micro-
scopic dynamics. As the noise strength is raised, ‘inter-
nal’ (lower-energy) tori are clearly the ﬁrst, and thus the

h|

7

easiest, to break. With stronger noise the outermost tori
break as well. Note that the strongest noise considered
is only a 1% ﬂuctuation of the mode frequency, and yet
this noise breaks all of the tori [panel (f)]. It is important
to remember that these plots lack statistical signiﬁcance
since only 18 orbits are represented. In a statistically im-
portant, i.e., much larger, sample some number of parti-
cles may conceivably break through the outer tori even
with very small noise. What the plots suggest is that this
number should increase as the noise strength increases,
in keeping with what one would expect intuitively. The
‘disintegration time scale’ (delineating the onset of halo
formation) is as indicated in the plots of RH discussed
earlier, and these plots were developed with meaningful
statistics, i.e., with 106 test particles.

δω

We now repeat the same investigation for the corre-
sponding rms-mismatched beam, i.e., M = 1.1118. Here,
we record the positions and velocities of the particles at
every period at which the core has its minimum radius;
the results appear in Fig. 10. Panel (a) depicts the PSS
with zero noise, whereas panel (b) depicts the PSS with
= 10−3 and
noise having the same parameters (
tc = 80) as in Fig. 9(f). Although with this noise the
KAM tori become slightly fuzzier, they do not yet break,
and this stands in stark contrast to the situation wherein
a collective mode is active. Even when the noise has very
= 10−1 in Fig. 10(c)], the beam
large amplitude [
boundary in phase space appears still to be sharply de-
ﬁned, although the tori have now obviously broken to a
certain degree, particularly in the beam’s interior. Hence,
although the tori of the rms-mismatched beam are seen to
be robust, they are not indestructible; suﬃciently strong
noise will eventually break them.

δω

|i

|i

h|

h|

IV. DISCUSSION AND CONCLUSIONS

The foregoing results point to the critical impact col-
lective modes can have on charged-particle beam dynam-
ics and halo formation. Because a collective mode can
destabilize the phase space near the beam boundary, par-
ticles become free to roam, interact with the collective
mode, extract energy from it, and thereby populate a
halo. By keeping a statistically small number of parti-
cles in phase with the collective mode(s), colored noise
contributes toward not only populating the halo, but also
expanding its extent, and it does so rapidly. As we have
shown, this picture diﬀers radically from what one would
infer by modeling the beam in terms of a rms mismatch.
Moreover, the results developed here are consistent with
those of our earlier work concerning noise-enhanced halo
formation [1], wherein we treated time-dependent poten-
tials that implicitly reﬂect the presence of one or more
collective modes.

These matters are of practical importance to the evolu-
tion of real beams. Transitions in an accelerator will give
rise to various mismatches that move the beam away from
equilibrium. Subsequent charge redistribution will form a

hierarchy of collective modes. Unavoidable irregularities
in the beamline will impose a spectrum of colored noise
that adds self-consistently to the time-dependent poten-
tial associated with the collective modes. Consequently,
the phenomenology that we uncovered will arise, as will
the consequential growth of the beam’s phase space in
general, and beam halo in particular. Accounting for
these details therefore becomes imperative, particularly
in regard to designing accelerators for the production of
high-average-current beams.

Although by working with the warm-ﬂuid model of
a beam we have endeavored toward a treatment that
is realistic, yet still generic, our treatment neverthe-
less retains some shortcomings that need to be recti-
ﬁed in future work. These include the following: (1)
The distribution of collective modes will evolve in a real
beam [18]; modes will tend to dissipate in conjunction
with the redistribution of the free energy they contain,
a dynamic that we have neglected. However, the time
scales over which large-scale collective modes dissipate
are not yet well quantiﬁed, and evidence from numer-
ical simulations suggest they may persist for hundreds
of dynamical times [19]. To the extent this proves true,
our analysis reveals the associated impact on halo for-
mation. (2) A real beam contains no test particles; all
of the particles interact with one another. (3) A real ac-
celerator will present a spectrum of colored noise, i.e., a
distribution of noise parameters, in keeping with the ac-
tual hardware and ﬁeld irregularities. The totality of this

8

phenomenology can be incorporated only by way of care-
ful self-consistent N -body simulations that reﬂect both
accurate boundary conditions and statistically accurate
initial conditions.

We have endeavored to show clearly and convinc-
ingly that details can be important to the evolution of
a charged-particle beam under the inﬂuence of space
charge, in that they can make a substantial impact on
the macroscopic evolution of its phase-space distribution.
Accordingly, these details merit careful study. A seem-
ingly probable outcome would be that the proper way
to picture generically a nonequilibrium beam subject to
self-forces is in terms of an increasingly well-mixed and
continually growing phase space as opposed to a phase
space in which tori largely partition, and hence constrain,
the motion of the constituent particles. This is espe-
cially true considering that the results herein pertain to
1.5-dimensional beams (the half dimension correspond-
ing to time), whereas real beams are higher-dimensional
systems, and thus their phase spaces are less hospitable
to barriers in the form of tori and cantori.

Acknowledgments

The Department of Education supported this work un-

der Grant No. G1A62056.

[1] C. L. Bohn and I. V. Sideris, Phys. Rev. Lett. 91, 264801

[15] Spallation Neutron Source Report No. 100000000-

PL0001-R10 (unpublished).

[16] J. S. O’Connell, T. P. Wangler, R. S. Mills, and K. R.
Crandell, in Proceedings of the 1993 Particle Accelerator
Conference, edited by S.T. Corneliussen (IEEE, Piscat-
away, NJ, 1993), p. 3657.

[17] T. P. Wangler, K. R. Crandall, R. Ryne, and T. S. Wang,

Phys. Rev. ST Accel. Beams 1, 084201 (1998).

[18] C. L. Bohn, Phys. Rev. Lett. 70, 932 (1993).
[19] I. Haber, et al., Nucl. Instrum. Methods A519, 396

[6] A. J. Lichtenberg and M. A. Lieberman, Regular and

(2004).

(2003).

(1998).

(2000).

(1999).

[2] Y.-J. Chen et al., in Proceedings of the 1991 Particle Ac-
celerator Conference, edited by L. Lazema and J. Chew
(IEEE, Piscataway, NJ, 1991), p. 3100.

[3] R. L. Gluckstern, Phys. Rev. Lett. 73, 1247 (1994).
[4] S. Lund and R. C. Davidson, Phys. Plasmas 5, 3028

[5] S. Strasburg and R. C. Davidson, Phys. Rev. E 61, 5753

Stochastic Motion (Springer-Verlag, Berlin, 1983).

[7] H. E. Kandrup, I. V. Sideris, and C. L. Bohn, Phys. Rev.

ST Accel. Beams 7, 014202 (2003).

[8] N. G. van Kampen, Stochastic Processes in Physics and

Chemistry (North Holland, Amsterdam, 1981).

[9] I.V. Pogorelov and H.E. Kandrup, Phys. Rev. E 60, 1567

[10] M. Reiser, Theory and Design of Charged Particle Beams

(Wiley, NY, 1994), cf. Section 5.4.

[11] N. Brown and M. Reiser, Phys. Plasmas 2, 965 (1995).
[12] C. L. Bohn and I. V. Sideris, Phys. Rev. ST Accel. Beams

[13] J. Qiang, et al., Phys. Rev. ST Accel. Beams 5, 124201

6, 034203 (2003).

(2002).

[14] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P.
Flannery, Numerical Recipes in C (Cambridge University
Press, Cambridge, 1995).

9

FIG. 1: Plots of an example orbit having initial conditions
x(0) = −0.733407,
˙x = 0, in the presence of various noise
strengths with Γ1 = 0.1, Γ2 = 0, tc = 80. The orbit is plotted
in conﬁguration space x vs. t (left panel) and in phase space ˙x
vs. x (center panel), along with its corresponding power spec-
trum (right panel) wherein the complexity K0.9 is provided
as a measure of orbital chaoticity (see Sec. III A). The four
rows correspond to diﬀerent noise strengths: (a) h|δω|i = 0,
(b) h|δω|i = 0.001, (c) h|δω|i = 0.01, and (d) h|δω|i = 0.1.

10

FIG. 2: Halo amplitude RH vs. t with Γ2 = 0, tc = 80, and
(a) Γ1 = 0.05, (b) Γ1 = 0.1. The number of test particles is
N = 106. The four curves correspond to four diﬀerent noise
amplitudes. Blue curve with crosses: h|δω|i = 0. Red curve
with asterisks: h|δω|i = 0.001. Black curve with diamonds:
h|δω|i = 0.01. Green curve with triangles: h|δω|i = 0.1.

11

FIG. 3: Maximum halo amplitude max(RH) reached over
a duration t = 512 DE units vs. the logarithm of the test-
particle population N with Γ2 = 0 and tc = 80, and with (a)
Γ1 = 0.05, and (b) Γ1 = 0.1. The four curves correspond to four
diﬀerent noise amplitudes. Blue curve with crosses: h|δω|i =
h|δω|i = 0.001. Black curve
0. Red curve with asterisks:
with diamonds: h|δω|i = 0.01. Green curve with triangles:
h|δω|i = 0.1.

12

FIG. 4: Maximum halo amplitude max(RH) vs. the loga-
rithm of the autocorrelation time tc computed for N = 104 test
particles with Γ1 = 0.05 and Γ2 = 0. Blue curve with crosses:
h|δω|i = 0.002. Red curve with asterisks: h|δω|i = 0.01. Black
curve with diamonds: h|δω|i = 0.03. Green curve with trian-
gles: h|δω|i = 0.1.

13

FIG. 5: Percentage P (r > R) vs. R of test particles (N = 106)
lying outside radius R at the end of the simulation (t = 512) for
various noise strengths with (a) Γ1 = 0.05, and (b) Γ1 = 0.1.
Fixed parameters are tc = 80 and Γ2 = 0. Blue curve with
crosses: h|δω|i = 0. Red curve with asterisks: h|δω|i = 0.001.
Black curve with diamonds: h|δω|i = 0.01. Green curve with
triangles: h|δω|i = 0.1.

14

FIG. 6: Plots of P (r > R) vs. R in the presence of both
the n = 1 and n = 2 modes (N = 106) at the end of the
simulation (t = 512) for ﬁxed tc = 80, various values of mode
amplitudes Γ1,2, with noise strength (a) h|δω|i = 0.001, and
(b) h|δω|i = 0.01. Blue curve with crosses: Γ1 = 0.05, Γ2 = 0.1.
Red curve with asterisks: Γ1 = 0.1, Γ2 = 0.05. Black curve
with diamonds: Γ1 = 0.05, Γ2 = 0. Green curve with triangles:
Γ1 = 0.1, Γ2 = 0.

15

FIG. 7: Evolution of four collections of 1600 test-particle
orbits integrated over t = 512 DE units (∼60 tD). The collec-
tions start (with zero initial particle velocity) at x = 0.31 ±
0.002, x = 0.70 ± 0.002, x = 1.1 ± 0.002, and x = 1.41 ± 0.002
with tc = 80, Γ2 = 0, and: (a) Γ1 = 0, h|δω|i = 0, (b) Γ1 = 0,
h|
h|

|i

|i

16

FIG. 8: Halo distributions (N = 106) for radial orbits (dotted
curves) and initially circular orbits (solid curves). (a) Halo
amplitude RH (t) vs. t with Γ1 = 0.05, Γ2 = 0, and tc = 80. (b)
Percentage P (r > R) of test particles lying outside radius R
at the end of the simulation (t = 512). Blue curves: h|δω|i = 0.
Red curves: h|δω|i = 0.001. Black curves: h|δω|i = 0.01. Green
curves: h|δω|i = 0.1.

17

FIG. 9: Poincar´e sections for a set of 18 representative initial
conditions integrated over t = 2048 DE units (∼250 tD) with
various noise strengths, and with tc = 80, Γ1 = 0.05, and
Γ2 = 0: (a) h|δω|i = 0, (b) h|δω|i = 10−6, (c) h|δω|i = 10−5, (d)
h|δω|i = 10

−4, and (f) h|δω|i = 10

−4, (e) h|δω|i = 5 × 10

−3.

18

FIG. 10: Poincar´e sections for a set of 18 representative
initial conditions in a rms-mismatched beam integrated over
t = 2048 DE units (∼250 tD) with various noise strengths,
and with M = 1.1118: (a) h|δω|i = 0, (b) h|δω|i = 10−3, and
(c) h|δω|i = 10

−1.

