DEUTSCHES ELEKTRONEN-SYNCHROTRON
in der HELMHOLTZ-GEMEINSCHAFT

DESY 05-032
February 2005

Paraxial Green’s functions in Synchrotron Radiation theory

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and Mikhail Yurkov
Deutsches Elektronen-Synchrotron DESY, Hamburg

5
0
0
2
 
b
e
F
 
2
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
0
2
1
2
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

2

Paraxial Green’s functions in Synchrotron Radiation theory

Gianluca Geloni,∗ Evgeni Saldin, Evgeni Schneidmiller, and Mikhail Yurkov
Deutsches Elektronen-Synchrotron, DESY
Notkestrasse 85, 22607 Hamburg,
Germany
(Dated: February 2, 2008)

This work contains a systematic treatment of single particle Synchrotron Radiation and some ap-
plication to realistic beams with given cross section area, divergence and energy spread. Standard
theory relies on several approximations whose applicability limits and accuracy are often forgotten.
We begin remarking that on the one hand, a paraxial approximation can always be applied without
loss of generality and with ultra relativistic accuracy. On the other hand, dominance of the accel-
eration ﬁeld over the velocity part in the Lienard-Wiechert expressions is not always granted and
constitutes a separate assumption, whose applicability is discussed. Treating Synchrotron Radia-
tion in paraxial approximation we derive the equation for the slow varying envelope function of the
Fourier components of the electric ﬁeld vector. Calculations of Synchrotron Radiation properties
performed by others showed that the phase of the Fourier components of the electric ﬁeld vector
diﬀers from the phase of a virtual point source. In this paper we present a systematic, analytical de-
scription of this phase shift, calculating amplitude and phase of electric ﬁeld from bending magnets,
short magnets, two bending magnet system separated by a straight section (edge radiation) and
undulator devices. We pay particular attention to region of applicability and accuracy of approx-
imations used. Finally, taking advantage of results of analytical calculation presented in reduced
form we analyze various features of radiation from a complex insertion device (set of two undulators
with a focusing triplet in between) accounting for the inﬂuence of energy spread and electron beam
emittance.

PACS numbers: 41.60.Ap, 41.60.-m, 41.20.-q

I.

INTRODUCTION

About sixty years have passed since the ﬁrst, pioneer-
ing works on Synchrotron Radiation have been published
(see [1] and references therein). The way scientists con-
sider this phenomenon has drastically changed during
this period. At ﬁrst, Synchrotron Radiation was regarded
only as a detrimental factor, a limitation on the maximal
particle energy attainable with accelerators (see, for in-
stance, [2]). Nowadays it is an outstanding research tool
allowing continuous advancement of both fundamental
and applied sciences and it is used worldwide by tens
of thousands of scientists from many diﬀerent disciplines
like physics, chemistry, material sciences and structural
biology.

The properties of Synchrotron Radiation can be de-
rived by applying the methods of classical electrodynam-
ics to the motion of relativistic electrons (or positrons) in
magnetic structures like bending magnets or undulators.
The theory of Synchrotron Radiation based on the works
by Iwanenko, Pomeranchuk and Schwinger has been de-
scribed in detail both in convenient summaries [3] as well
as in textbooks [4, 5, 6, 7, 8, 9, 10].

On the one hand, these texts contain derivation of fun-
damental equations describing spectral-angular proper-
ties of Synchrotron Radiation in the far-zone for single
electrons. A usual starting point for quantitative descrip-

∗Electronic address: gianluca.aldo.geloni@desy.de

tions of these properties is provided by the formulas for
the Lienard-Wiechert ﬁelds [4].

On the other hand, in relation with the construction
of beam lines at Synchrotron Radiation facilities it is im-
portant to understand the modiﬁcations to single particle
treatment which is due to realistic beams with given cross
section area, divergence and energy spread.

This raises several questions. First, discussing ﬁnite
electron beam emittance eﬀects, an obvious remark is
that, in the case of second generation light sources, the
emittance of the electron beam was much larger than the
radiation wavelength of interest. As a result, both pho-
tons and electrons phase space had the same hamiltonian
structure, and properties of radiation could be treated on
the basis of geometrical optics. In recent years though,
more and more specialized and optimized Synchrotron
Radiation sources have started operation. During de-
sign and optimization of these sources much emphasis
has been directed at reducing the transverse phase space
area of the electrons. Among the most exciting proper-
ties of today’s third generation sources is the tiny vertical
emittance which is an order of magnitude smaller than
1 ˚A (for design parameters of an up-to-date source see,
for instance, [11]). In this case geometrical optics cannot
be applied any more and even basic properties like angu-
lar distribution of intensity at ﬁxed frequency, or spectral
intensity distribution at ﬁxed observation angle should be
calculated applying full electromagnetic equations.

A second question arises considering the features of un-
dulator insertion devices. In older sources, typical length
2 m, while the dis-
of insertion devices was about 1

÷

÷

tance to the user station was of order 20
30 m. In this
situation the asymptotic formulas for the far zone could
be applied and the question of their applicability region
was of theoretical interest only. Nowadays installation of
20 meter-long undulators has been planned at PETRA
III (see [11]) and distances between source and observer
of several tens of meters have been proposed. A similar
device (a 25 m long segmented undulator with no focus-
ing elements between the segments) has been installed
and operates at SPring-8 (see [12]). In this situation ap-
plicability region of far-ﬁeld formulas and correction for
near ﬁeld eﬀects are of actual practical importance, not
to mention the interest for far infrared edge radiation.

Another problem is related with the increasing com-
plexity of insertion devices. For instance at PETRA III
(see again [11]), installation of two undulators segments
separated by a focusing triplet in between has been pro-
posed to obtain small vertical betatron functions. Com-
putation of radiation characteristics from these novel de-
vices constitute a rather challenging problem.

Furthermore, a question which is somewhat related to
all the previous ones is linked with the dramatic increase
of brilliance achieved in third generation light sources
with respect to older designs, which has triggered a
number of new techniques and experiments unthinkable
before. Among the most exciting properties of today
third generation facilities is the high ﬂux of coherent x-
rays provided. The availability of intense coherent x-ray
beams has fostered the development of new coherence
based techniques like ﬂuctuation correlation dynamics
[13, 14, 15, 16, 17, 18], phase imaging [19, 20, 21, 22],
and coherent x-ray diﬀraction (CXD) [23, 24, 25, 26].
In all these ﬁelds, the understanding of the evolution of
transverse coherence properties along the beam line is
of uttermost importance:
in particular, both the beam
size and divergence should be taken into account in the
evolution model.

As one can see these questions address quite diﬀerent
physical phenomena; yet they all belong to the ﬁeld of
Synchrotron Radiation. This number of diﬀerent issues
stems from the fact that practical applications make use
of a very wide range of radiation wavelengths, from 0.1 ˚A
to 100 µm, which span over seven orders of magnitude. It
is no surprise that very diﬀerent problems arise when the
wavelength of interest is tuned to such diﬀerent regions of
the electromagnetic spectrum. Considering, for instance,
bending magnet radiation, it is clear that near ﬁeld eﬀects
will be of practical importance for FIR (Far Infra-Red)
applications but hardly for X-ray radiation, because of its
much shorter radiation formation length. On the other
hand, the inﬂuence of the emittance on X-ray radiation
will be important because the magnitude of the emittance
is comparable with the radiation wavelength, but it will
be negligible when it comes to the characterization of FIR
radiation properties, since in this case the wavelength of
interest is way larger than the emittance.

As a result, all the matters mentioned above are of
great practical importance in some particular region of

3

the spectrum, although they are systematically neglected
in Synchrotron Radiation textbooks and reviews. Reac-
tion of synchrotron-radiation-users communities to this
set of problems was the development of computer codes
capable to calculate radiation properties from realistic se-
tups starting from ﬁrst principles [27, 28]. At ﬁrst glance
this settles all issues since, at least from a practical view-
point, users have the possibility to calculate all the prop-
erties they need.

Yet, computer codes can calculate properties for a
given set of parameters, but can hardly improve physi-
cal understanding, which is particularly important in the
stage of planning experiments. Understanding of correct
approximations and their region of applicability can sim-
plify many tasks a lot, including practical and non-trivial
ones. The use of dimensional analysis in an analytical
framework is of uttermost importance to this goal. By
that, dimensionless quantities of physical interest can be
easily identiﬁed. In particular, dimensionless parameters
much smaller (or much larger) than unity always corre-
spond to simpliﬁcations of fundamental equations: most
physical theories originate from recognizing and taking
advantage of such small (or large) quantities.

In contrast, relying only on computational power to
solve physical problems, besides being inelegant, would
automatically neglect the presence of small (or large) pa-
rameters and simpliﬁcations related to them. The lack,
or poor understanding of approximations involved in a
certain theory will result, in its turn, in poor understand-
ing of the mechanisms involved in physical phenomena
which would undoubtedly result in gross mistakes. More-
over, just a few codes are available, which can be mod-
iﬁed to account for particular situations (like coherence
properties or radiation characteristics from a complex in-
sertion device for instance) by a few experts only, while
there are about twenty facilities each with its own set of
particular setups and situation to be accounted for.

We propose to overcome all these diﬃculties by devel-
oping a theory of Synchrotron Radiation which accounts
for all complexities analytically. Analytical approach will
help to understand physics of real Synchrotron Radiation
sources, thus ﬁlling the gap between idealized textbook
analysis and actual situations. We will make explicit use
of small (or large) parameters involved in the description
of cases of practical interest. In this way we will reduce
problems as much as possible, to a level where physical
insight is easy, so that simple computer codes, capable to
describe the situation under study, can be developed also
by non-expert programmers. In this process we will put
particular care in the speciﬁcation of the region of appli-
cability and of the accuracy of the approximations made,
which is usually neglected in analytical calculations.

In the next Section we discuss methods for computa-
tion of Synchrotron Radiation from a single particle on
a generic trajectory. We start reviewing the two algo-
rithms used today, the ﬁrst based on Lienard-Wiechert
ﬁelds, the second on Lienard-Wiechert potentials. We
propose to start calculations from the very beginning

≫

by solving paraxial Maxwell equations for a given har-
monic of the ﬁeld. This is, from a logical and educational
viewpoint, the most natural way to perform calculations;
from a computational viewpoint it is also the simplest
way. The use of a paraxial approximation is justiﬁed
by the features of an ultra relativistic system character-
ized by a Lorentz factor γ2
1: radiation formation
length is, then, much longer than the wavelength, and
the radiation is distributed within a cone with opening
angle much smaller than unity. Maxwell equation for a
given harmonic of the ﬁeld ¯E(r, ω), which has elliptic
characteristic, can be then transformed into a parabolic
equation. We solve this equation with the help of an ap-
propriate Green’s function thus coming, in Section II, to
a very generic expression for ¯E. We end the Section by
addressing the obvious question of the relation between
our method, and the two algorithm introduced at the
beginning.

Subsequently we apply our expression to recover
some well-known and less well-known properties of Syn-
chrotron Radiation from bending magnets and undula-
tors, in Section III and Section IV respectively. This is
far from being a mere repetition of already known results.
In fact our method will prove superior when it comes to
physical understanding and determination of applicabil-
ity region and accuracy of approximations: this has, of
course, important application in estimation of practical
quantities, like ﬁeld intensities, with their accuracy. We
will also discuss in detail the methodological issues about
deﬁnition of ﬁelds and intensities from single devices. As
an example of application of our new understanding we
will show, in Section V, how radiation characteristics
from a complex setup can be discussed in very simple
terms. Finally, in Section VI we come to conclusions.

II. METHOD

A. Review of known methods

There are two basic methods which are used to calcu-

late Synchrotron Radiation characteristics.

The ﬁrst [4, 5, 6, 7, 8, 9, 10] is based on Lienard-
Wiechert ﬁelds. It is the better known of the two and it
is used in a very widespread way in textbooks. Lienard-
Wiechert ﬁelds can be customary separated in a velocity
and an acceleration term. Usually, the acceleration part
alone is analyzed in Fourier components of the electric
ﬁeld vector:

¯E(ro, ω) =

∞

′

dt

e
c

−

−∞

Z
exp

′

ro
|

t
(cid:18)

iω

(cid:26)

×

n

−

(n
×
r′(t′)
h
|
ro
−

−
+ |

β)

×
n
(1
−
r′(t′)
|
c

˙β

·

(cid:19)(cid:27)

β)2
i

, (1)

e) is the electron charge, n(t′) is the unit vec-
where (
tor from the particle to the observer position, r′(t′) is

−

4

the particle position, ro is the observer position β(t′)
and ˙β(t′) are, respectively, the particle velocity, v(t′),
normalized to the speed of light c and its derivative, all
calculated at time t′. It is clear that use of Eq. (1) implies
that the so-called velocity part of the ﬁeld is neglected in
the computation.

The second method [27, 28, 29, 30] is based on Lienard-
Wiechert potentials. As an alternative to the use of
Lienard-Wiechert ﬁelds as a starting point for computa-
tions based on ﬁrst principles, a few authors of scientiﬁc
research papers start with the Lienard-Wiechert poten-
tials (A(ro, t), φ(ro, t)). These can be decomposed in
their harmonics ( ¯A(ro, ω), ¯φ(ro, ω)) which can be subse-
quently used to calculate ¯E(ro, ω) according to

¯E(ro, ω) =

iωe
c

−

∞

′

dt

−∞

Z
n
r′(t′)
2
|

(cid:19)(cid:27)

ro
|
−

−
r′(t′)
|
c

(cid:21)
. (2)

ro
|
exp

×

(cid:20)

×

β

n
−
r′(t′)
|
′

iω

t
(cid:18)

−

(cid:26)

ic
ω
ro

−

+ |

We failed to ﬁnd textbooks using this second method for
educational purposes: although some authors (see [10]
for instance) start their derivation with harmonic analy-
sis of potentials, when it comes to actual calculation of
Synchrotron Radiation they go back to the ﬁrst method
based on Lienard-Wiechert ﬁelds.

(1) and Eq.

Questions arise about the relation between Eq.
(1), Eq.
(2). First, in contrast to Eq.

(1)
and Eq.
(2)
is exact, in the sense that the velocity ﬁeld term is not
neglected. It is then natural to ask what are the condi-
tions for which the velocity ﬁeld term in Eq. (1) can be
dropped, and with what accuracy this can be done. In
fact, when approximated expressions like Eq. (1) and its
specialization to particular magnetic systems (like un-
dulators and bending magnets) are found, special care
should be taken in specifying their region of applicability
and accuracy; yet we failed to ﬁnd, through references
[4, 5, 6, 7, 8, 9, 10] quantitative speciﬁcation of accuracy
of results obtained under given approximations. Second,
Eq.
(2) are used both in the far and in
the near ﬁeld region and simpliﬁed under the paraxial
approximation:
it is important to understand relations
between the paraxial approximation and the far or near
ﬁeld assumptions as well as region of applicability and
accuracy of results. Third, Eq.
(1) is often used to-
gether with integration by parts and neglecting the edge
in this case it is interesting to
terms after integration:
ask what are the conditions which allow the edge terms
to be dropped. Moreover, as a remark to both methods,
we should note that, in general, one needs to know the
entire history of the electron from t′ =
∞
since integration in Eq. (1) and Eq. (2) is performed be-
tween these limits. This statement should be interpreted,
physically, depending on the situation under study: inte-
gration should in fact be performed from and up to times

to t′ =

−∞

(1) or Eq.

when the electron does not contribute to the ﬁeld any-
more. This does not present any problem in the case, for
instance, of a circular motion because the particle tra-
jectory is limited in space. In practical situation though,
one deals with radiation from a beamline which is a com-
position of insertion devices, like undulators and bending
magnets, and straight sections. The requirement of in-
tegration over the entire history of the electron poses,
then, the following methodological problem: one has to
give a meaning to the concept of radiation from a given
insertion device, independently of the trajectory followed
by the particle before and after the device. This problem
will be discussed in more detail as we go through our pa-
per. In general one can break up the electron trajectory
in several parts, corresponding to physical devices like
undulators, drifts and bending magnets, thus calculating
the integral in Eq.
(2) along a ﬁnite time
interval which corresponds to a particular device. In do-
ing this, it is assumed that the observer is located far
away enough from the device, so that the velocity part
of the ﬁeld is negligible with respect to the acceleration
part. In this way, again, dropping velocity ﬁeld part in
Eq. (1) is justiﬁed and the results from Eq. (1) and Eq.
(2) coincide. It is understood that diﬀerent contributions
from diﬀerent devices must be accounted for with the cor-
rect relative phase relation to get the total ¯E(r, ω) as a
sum of the separate contributions from single devices. In
this way concepts like radiation ﬁeld from a undulator
or radiation ﬁeld from a bending magnet have a well de-
ﬁned, practically useful meaning as partial contribution
to the total ﬁeld at the observation point. The concept
of intensity is, instead, subtler, since it involves calcula-
2. In this case then, also interference
tion of
|
terms between diﬀerent devices should be accounted for,
in the most generic case. Only when these are not im-
portant the total spectral intensity from a given beamline
can be broken up in the sum of separate terms from the
single devices, and radiation intensity from a undulator
or radiation intensity from a bending magnet are, then,
well-deﬁned.

¯E(r, ω)

|

Finally, Eq. (1) is based on the integration of Maxwell
equation in time and in the subsequent harmonic anal-
ysis. This is quite involved from a logical viewpoint: it
is much simpler to start with the equations for a given
harmonic ω so to obtain directly ¯E after integration of
Maxwell equations. A similar comment can be made re-
garding the way Eq. (2) was obtained: ﬁrst the potentials
were found, then their Fourier transform was taken. In
both cases one is bound to solve the full Maxwell equation
even though the ultra relativistic nature of the systems
considered in practice allows systematic application of
a much more convenient paraxial approximation. Note
that, usually, paraxial approximation is applied, but only
at a later stage, which often makes analytical derivations
more involved, and region of applicability and accuracy
of results diﬃcult to specify.

B. Derivation using paraxial Green’s function

A system of electromagnetic sources can be conve-
niently described by its charge density ρ(r, t) and current
density j(r, t). In this paper we will be concerned about
a single electron so that, using the Dirac delta distribu-
tion, we can write

ρ(r, t) =

eδ(r

−

−

r′

(t))

and

j(r, t) =

ev(t)δ(r

−

r′

(t)) ,

−

where r′(t) and v(t) are, respectively, the position and
the velocity of the particle at a given time t in a ﬁxed ref-
erence frame. We will assume that the particle trajectory
is given a priori, and that Maxwell equations in vacuum
allow a good description of the source ﬁeld. In this case
the magnetic ﬁeld B can be easily recovered when the
electric ﬁeld E is known simply remembering

B(r0, t) =

n

E

1
c

×

where n is the unit vector pointing from the retarded
position of the particle, r′(t′) to the position r0 at time
t = t′ + r′(t′)/c. Therefore in this paper we will concen-
trate on the electric ﬁeld E(r0, t).

Trivial manipulations of Maxwell equations in cgs sys-

tem:

and

∇

E =

×

1
c

∂B
∂t

−

∇

×

B =

j +

4π
c

1
c

∂E
∂t

give the well-known equation for the electric ﬁeld:

c2∇

(∇

×

×

E) =

∂2E
∂t2 −

−

4π

∂j
∂t

.

With the help of the identity

∇

(∇

E) = ∇(∇

E)

2E

(9)

·

− ∇

×
and Poisson equation

×

·
we obtain the inhomogeneous wave equation for E

∇

E = 4πρ

c2

2E

∇

−

∂2E
∂t2 = 4πc2∇ρ + 4π

∂j
∂t

.

5

(3)

(4)

(5)

(6)

(7)

(8)

(10)

(11)

6

Eq. (11) is a partial diﬀerential equation of hyperbolic
type. We introduce the Fourier transform ¯f (ω) of a quan-
tity f (t) as follows:

and

¯f (ω) =

dtf (t)eiωt ,

(12)

j(r⊥, z, t) =

v(z)δ

r⊥

r′
⊥(z)

δ

e
vz(z)

−

−

(cid:0)

s(z)

v −

t

(cid:19)
(20)

(cid:18)

(cid:1)

so that

f (t) =

1
2π

dω ¯f (ω)e

−iωt .

(13)

¯ρ(r⊥, z, ω) =

δ

r⊥

r′
⊥(z)

eiωs(z)/v

(21)

e
vz(z)

−

−

(cid:0)

(cid:1)

−∞

Z

∞

∞

−∞

Z

so that

and

Using the representation in Eq (13) for the quantities in
Eq. (11) we get

c2

2 ¯E + ω2 ¯E = 4πc2∇¯ρ

4πiω¯j .

(14)

∇

−

Eq.
(14) is the well-known Helmholtz equation which
has elliptic characteristic. Upon introduction of a ﬁxed
cartesian reference system (x, y, z), it is always possible
to deﬁne a quantity

E such that

e
¯E =

Eeiωz/c .

(15)

However this deﬁnition is useful only in the case when
e
E varies slowly along z with respect to the length λ =
2πc/ω: only in that case, in fact, Eq. (15) is a useful
factorization of ¯E as the product of a fast and a slowly
e
varying function of z. With the help of Eq. (15) one can
write Eq. (14) as

c2eiωz/c

2 +

E = 4πc2∇ ¯ρ

4πiω¯j .

(16)

−

2iω
c

∂
∂z

(cid:19)

∇

(cid:18)

e
Let us now write the equation for the sources with the
help of the curvilinear abscissa s, simply deﬁned as s =
is a constant. We
vt. Here we assume that v =
will use the general property

v(t)

|

|

δ[f (x)] =

δ(x

xi)

−
f ′(xi)

,

(17)

|

|

i
X
where xi are the zeros of f (x). Then, we will regard
z′(t)) as δ[f (t)], for any ﬁxed value of z. The only
δ(z
zero of f (t) will be readily indicated with t(z), which is
the value of t for which z
=
|
vz(z(t)). Therefore, with the help of Eq. (17) we can
write

z′(t) = 0, while

f ′(t(z))

−

−

|

′

z

(t)) =

δ(z

−

1
vz(z)

δ(t

t(z)) .

−

(18)

Then, using s(z) = vt(z), Eq. (3) and Eq. (4) give

ρ(r⊥, z, t) =

e
vz(z)

−

δ

r⊥

r′
⊥(z)

δ

−

(cid:0)

(cid:18)

(cid:1)

s(z)

v −

t

(cid:19)

(19)

¯j(r⊥, z, ω) =

e
vz(z)

−

v(z)δ

r⊥

r′
⊥(z)

eiωs(z)/v .

−

(cid:0)

(cid:1)

(22)

By substitution in Eq. (16) we obtain

E =

exp

iω

2iω
c

∂
∂z

v(z)δ

2 +

iω
c2

∇

(cid:18)

×

(cid:20)

(cid:19)
r⊥

e
−

(cid:0)

4πe
vz(z)

r′
⊥(z)

(cid:26)
∇δ

(cid:18)
r⊥

−

(cid:1)

(cid:0)

z
c

s(z)

v −
r′
⊥(z)

−

(cid:19)(cid:27)

(cid:21)
(cid:1)

. (23)

{

e

∼

−

−

−

z′/c)

iω (s/v

z/c)
}

In general,

Eq. (23) is still fully general and may be solved in any
ﬁxed reference system (x, y, z) of choice with the help
E will
of an appropriate Green’s function.
vary, in z′, on a characteristic length which is related
, which enters in the Green’s
with exp
function solution of Eq. (23) as a factor in the integrand.
As it will be clearer after Paragraph II C, as we integrate
along z′, the factor ω(s(z′)/v
z′/c) grows larger and
larger leading, eventually, to a highly oscillatory behavior
of the integrand which does not contribute anymore to
the ﬁnal integration result. The value of z′ for which
ω(s(z′)/v
1 can be considered as a measure of
the value of z′ for which the integrand starts to display
such oscillatory behavior and it is naturally deﬁned as the
radiation formation length Lf of the system at frequency
ω.
It is easy to see by inspection that if v is sensibly
smaller than c (but still of order c), i.e. v
∼
λ. On the contrary, when v is very close
1, then Lf ∼
ωz′/c tend
to c, i.e. 1/γ2
≪
to compensate so that Lf ≫
λ. The exact expression for
Lf depends on the particular magnetic system, i.e. on
s(z′), and on the frequency of interest ω.
Let us consider the assumption 1/γ2

∼
1, the terms ωs(z′)/v and

1. We will hold
this assumption fulﬁlled throughout our paper. In gen-
eral, introduction of a small (or large) parameter in any
theory brings simpliﬁcations. In particular the ultra rela-
tivistic approximation has two consequences: ﬁrst, as just
remarked, the radiation formation length is much larger
than λ and, second, as it will be discussed in Paragraph
II C, radiation is emitted in a narrow cone of opening
angle much smaller than unity. Accounting for these fea-
tures of the radiation, and considering an electron mov-
ing on a given trajectory, there will always be, in prac-
tical cases of interest, some privileged reference system

c but 1/γ2

≪

−

7

y

x

FIG. 1: Geometry and reference system for Synchrotron Ra-
diation problems in paraxial approximation.

FIG. 2: Standard reference frame for Synchrotron Radiation
computations.

(x, y, z) in which Eq. (23) is simpliﬁed in a paraxial form,
due to the ultra relativistic assumption, for some set of
observer points.

z ≫

To apply such paraxial approximation we should ﬁrst
assume ultra relativistic motion and identify a main ob-
server P . Then we can deﬁne a frame with the z axis
oriented as the tangent from some trajectory point T , to
P . As it will be discussed in Paragraph II C, using this
frame we can describe radiation at P from all points of
the trajectory with velocity vector forming with the z
axis an angle much smaller than unity. In other words,
for all these points γ2
1: this condition is necessary
and suﬃcient for the applicability of the paraxial approx-
imation. This is not a restriction, in practice, because it
still keeps open the possibility of angles much larger or
much smaller than 1/γ (bending magnet or undulator
case). The situation is described with a particular exam-
ple for the case of a circular motion, in Fig. 1. Note that
the reference frame used to describe radiation at P can
be also used for observers in the neighborhood of P , pro-
vided that these form an angle much smaller than unity
with respect to the velocity at T . Since we presented,
as particular example, the case of a circular motion, it
is worth to underline the diﬀerence between the frame
depicted in Fig. 1 and the standard frame used for Syn-
chrotron Radiation computations in Fig. 2: using the
frame in Fig. 2 we will never be able to describe the ﬁeld
at to observer locations displaced along the x axis. This
is required, for instance, if one needs to calculate the au-
tocorrelation function of the ﬁeld at those two points.
On the contrary, such a description is allowed with the
choice of a frame like in Fig. 1.

Since the radiation formation length is much longer
E does not vary much along z on
than the wavelength,
. Therefore,
Ex,y |≪
the scale of λ, that is
∂z
2
the second order derivative with respect to z in the
e
∇
operator on the left hand side of Eq. (23) is negligible
e
with respect to the ﬁrst order derivative. This means
that we can apply a paraxial approximation which con-

Ex,y |
e

ω/c

|

|

siderably simpliﬁes Eq. (23) as

2 +

⊥

2iω
c

∂
∂z

v⊥(z)δ

∇

(cid:18)

×

(cid:20)

iω
c2

(cid:0)

E⊥ =

exp

iω

4πe
c

−

(cid:1)

(cid:26)
∇⊥δ

(cid:18)
r⊥

(cid:0)

z
c

s(z)

v −
r′
⊥(z)

−

, (24)

(cid:19)(cid:27)

(cid:21)
(cid:1)

(cid:19)
r⊥

r′
⊥(z)

e
−

E only and
where we consider transverse components of
we substituted vz(z) with c, having used the fact that
1/γ2
1. Eq. (24) is Maxwell’s equation in paraxial ap-
proximation. Note that this approximation transformed
Eq. (23) which is an elliptic partial diﬀerential equation,
into Eq. (24), which is of parabolic type.

z ≪

e

The Green’s function for Eq. (24), namely the solu-
tion corresponding to the unit point source, satisﬁes the
equation:

2iω
c

∂
∂z
(cid:19)
= δ(r⊥o

2 +

⊥

(cid:18)

∇

G(zo −
−
and, in an unbounded region, can be written explicitly
as

z; r⊥o
−
r⊥)δ(zo −

z) , (25)

r⊥)

G(zo −

′

z

; r⊥o

r′
⊥) =

−

z′)

1
4π(zo −
−
r′
2
r⊥o
⊥ |
−
z′)
2c(zo −

(cid:27)

. (26)

exp

iω |

×

(cid:26)

As usual we will denote source coordinates with primes
and observer coordinates with the index o. With the aid
of the Green’s function G, the solution of Eq. (24) can
be represented as

E⊥(zo, r⊥o, ω) =

iω
c2

×

(cid:20)

′

e
v⊥(z

)δ

r′
⊥ −

r′
⊥(z

(cid:0)

e
c

−
′

)

∞

′

dz

Z

−∞
∇′

⊥δ

1
zo −
r′
⊥ −

dr′
⊥

z′
Z
r′
⊥(z

′

)

−

(cid:1)

(cid:0)

(cid:21)
(cid:1)

q
q
q
q
q
q
q
q
×

exp

iω

|

(cid:26)

(cid:20)

r′
2
r⊥o
⊥
|
−
z′)
2c(zo −

+

(cid:18)

s(z′)

v −

z′
c

,

(cid:19)(cid:21)(cid:27)

(27)

where ∇′
⊥ represents the gradient operator with respect
to the source point. The integration over transverse co-
ordinates can be carried out leading to the ﬁnal result:

∞

dz

iωe
c2

E⊥(zo, r⊥o, ω) =

′ eiΦT
zo −
yo −
zo −
where the total phase ΦT is given by

xo −
zo −

x′(z′)
z′

−∞
Z
vy(z′)

−
ˆx +

c −

−

(cid:19)

(cid:18)

e

z′
(cid:20)(cid:18)
y′(z′)
z′

vx(z′)
c

ˆy
(cid:21)

(cid:19)

, (28)

ΦT = ω

s(z′)

v −

z′
c

+ω

(xo −

x′(z′))2 + (yo −
z′)
2c(zo −

y′(z′))2

(cid:21)

(cid:20)

"

#
(29)
Eq. (28) can be used in all generality to characterize radi-
ation from an electron moving on any trajectory as long
as the ultra relativistic approximation is satisﬁed, and
a reference system suitable for paraxial approximation
exists, which is always the case in situation of practical
interest. Note that both ˆx and ˆy polarizations terms in
(28) are a sum of two parts which can be traced
Eq.
back to current and charge densities:
in fact, the ﬁrst
part, proportional to the particle velocity in the x or
y direction, follows from the transverse current density
j⊥. The second instead, follows from the gradient of the
charge density ∇ρ. Our result makes a consistent use of
paraxial approximation and of harmonic analysis which
brings simplicity and power to the method. In the fol-
lowing Sections we will show how Eq. (28) can be used
to characterize bending magnet radiation and undulator
radiation.

C. Discussion

Following the previous derivation very natural ques-
tions arise which regard the relation between our expres-
sion, Eq. (28), with Eq. (1) and Eq. (2) as well as the
applicability region and the accuracy of our Eq. (28).

In order to investigate these subjects we go back to
the most general Eq. (14) and we note that it can be
solved by direct application of the Green’s function for
the Helmholtz equation:

r′

) =

G(ro

1
ro
|
Integrating by parts the term in ∇¯ρ we have

ω
c |

exp

4π

r′

ro

−

−

−

−

n

i

|

r′

|
o

. (30)

¯E =

dr′

−

Z

iω

c

"

ro
|

−

r′

| (cid:18)

¯ρn

−

¯j
c

+

(cid:19)

¯ρn

ro

|

−

r′

2
|

#

8

. (31)
¯j, Eq.

|
o
Use of explicit expressions for ¯ρ, Eq. (21), and
(22), leads straightforwardly to

−

×

n

exp

i

ω
c |

ro

r′

¯E(ro, ω) =

iωe
c

−

∞

′

dz

−∞

Z
n
r′(z′)
2
|

1
vz(z′)

×

ro
(cid:20)
|
exp

−
iω

β

n
−
r′(z′)
|
s(z′)
v

ic
ω
ro

−

+ |

(cid:26)

(cid:18)

×

ro
|
−

−
r′(z′)
|
c

(cid:19)(cid:27)

(cid:21)
. (32)

Finally, remembering z′ = vzt′ we obtain Eq. (2). This
result simply conﬁrms that Eq. (2) is derived under most
general conditions; the derivation that we proposed from
direct use of ﬁelds is much less involved, from a logical
viewpoint, with respect to the original, which makes use
of potentials (see [29, 30]) and it may be interesting for
educational purposes.

It is interesting to note that the only approximation
applied to Eq. (14) in order to obtain, ﬁnally, Eq. (28)
was simply the paraxial approximation. We can easily
see that if we apply paraxial approximation to Eq. (2)
we get back Eq. (28). Let us show how this is possible.
The choice of ω depends on our interest. Then, our ul-
tra relativistic approximation implies a formation length
r′
will always
Lf ≫
be at least of order Lf , so that
c/ω and, with
an accuracy λ/(2πLf ), Eq. (2) can be simpliﬁed as

λ. Moreover in practical cases,

−
| ≫

ro
|
r′

ro
|

−

|

¯E(ro, ω) =

iωe
c

−

exp

iω

×

(cid:26)

t
(cid:18)

∞

dt

−∞

Z
′
+ |

ro

′

β

n
−
r′(t′)
ro
|
−
|
r′(t′)
|
−
c

(33)

(cid:19)(cid:27)
c and also s = vt′

or, using again z′ = vzt′, vz ≃

¯E(ro, ω) =

exp

iω

×

∞

iωe
c2
−
s(z′)
v

dz

′

β

n
−
r′(z′)
ro
|
|
−
r′(z′)
. (34)
|
−
c

−∞

Z
+ |

ro

(cid:18)

(cid:26)
Remembering that ¯E⊥ =
transverse ﬁeld components as

E⊥ exp
{

(cid:19)(cid:27)
iωzo/c

}

e
∞

E⊥(ro, ω) =

e

iωe
c2

−

−∞

Z
iω
(cid:26)
(cid:20)(cid:18)
r′(z′)
|
c

−

exp

×
ro
|

−

′ β⊥
dz
ro
|
s(z′)

−

v −
z′
zo −
c

n⊥
−
r′(z′)
|
z′
+
c

(cid:19)

(cid:19)(cid:21)(cid:27)

(cid:18)

. (35)

we write the

In any situation, it is mathematically correct to expand
ro
|

as an inﬁnite sum of terms

r′

−

|

r′

ro
|

−

(zo −

| ≃

′

z

) + |

r′
2
r⊥o
⊥|
−
z′)
2(zo −

+ ...

(36)

Truncation of the series in Eq. (36) and subsequent sim-
pliﬁcation of the phase in the integrand of Eq. (35) is a
delicate business.

−

−

iω(zo −

The ﬁrst term of the expansion Eq.

(36) naturally
z′)/c in the phase of Eq.
cancels the term
(35) so that one is left with phase contributions due to
higher order terms from the expansion Eq. (36) and with
iω(s(z′)/v
z′/c). This last contribution depends on
s(z′) and can be speciﬁed only when the magnetic sys-
tem is speciﬁed. As has already been said in Paragraph
II B, as we integrate along z′, ω(s(z′)/v
z′/c) grows
larger and larger leading, eventually, to a highly oscilla-
tory behavior of the integrand which does not contribute
anymore to the ﬁnal integration result. The value of z′
for which ω(s(z′)/v
1 can be considered as a
∼
measure of the value of z′ for which the integrand starts
to display such oscillatory behavior and it is naturally de-
ﬁned as the radiation formation length Lf of the system
at frequency ω.

z′/c)

−

−

Another length dictated by the physics of the problem
is the natural size of the system. We will refer to it as the
characteristic length of the system and we will indicate
it with Lch; for instance, in the case of a circular motion,
Lch is simply the circle radius.

λ, and therefore also Lch ≫

Relation between Lch and Lf depends on the system.
In the ultra relativistic approximation we can say that
Lch can be either much larger or comparable to Lf , but
in any case never smaller, since integration of the Green’s
function is performed along a path length comparable
with Lch. Moreover, in the ultra relativistic approxima-
tion the two terms ωs(z′)/v and - ωz′/c nearly compen-
sate leading to a formation length much longer than λ so
λ. It should be
that Lf ≫
stressed that, although the previous properties are very
general, the relation between Lf , Lch and λ depends on
the particular physical situation under study and can be
better speciﬁed only in relation with that situation: for
instance, in the case of ultra relativistic motion on a cir-
cular trajectory Lf = [λR2/(2π)]1/3. Also, note that
if the ultra relativistic approximation cannot be applied
anymore, then even the general scaling laws between Lch,
Lf and λ change. For instance, when if v
1,
∼
one has Lch ∼
λ.
The expansion Eq. (36) makes sense only if ω(s(z′)/v
−
z′/c) is smaller or comparable to unity since the two
terms ωs(z′)/v and
ωz′/c can be grouped together in
a useful way. Once a certain wavelength of interest is
ﬁxed, the condition ω(s(z′)/v
1 determines the
formation length Lf , which can be used in the second
term of Eq.
(36). By imposing that also this second
term is not larger than unity one obtains a condition on
the observation points of interest:

Lf ∼

c but γ

z′/c)

∼

−

∼

−

r′
2
⊥|
z′)2

r⊥o
|
−
2(zo −
Lf . The third term in the ex-
where we assumed zo−
pansion can be then neglected, together with second and

z′ >
∼

2πLf ≪

(37)

<
∼

1 ,

λ

9

next terms in the expansion of the denominator of the
integrand in Eq. (35), with an accuracy λ/(2πLf ). Note
that, whatever the magnitude of r′
⊥ across the beamline,
it follows from Eq. (37) that the square of the opening
angle of radiation r2
o, is much smaller than unity.
This justify our attention to the transverse components
of

E only.
If we substitute the ﬁrst two terms of Eq. (36) in the
phase of the integrand of Eq. (35), and the ﬁrst term in
e
its denominator we ﬁnd

⊥o/z2

E⊥(ro, ω) =

e
exp

iω

×

(cid:26)

(cid:18)

s
v −

that is just Eq. (28).

n⊥
z′

∞

′ β⊥

iωe
c2
−
z′
c

dz

−
zo −
−∞
Z
r′
2
r⊥o
⊥|
+ |
−
z′)
2c(zo −

(cid:19)(cid:27)

. (38)

We demonstrated that application of paraxial approx-
imation to Eq. (2) gives us back Eq. (28). This fact
is, however, quite obvious. In our derivation of Eq. (28)
we applied paraxial approximation to Maxwell equations
from the very beginning, while here we simply apply the
same approximation after solving Maxwell equations in
their more generic form. For consistency reasons we had
to obtain the same result.

The previous discussion tells that our approach is a
specialization of the more general approach described by
Eq. (2). The novelty in this, stems from the fact that
Synchrotron Radiation, by deﬁnition, applies to radia-
tion by ultrarelativistic particles in magnetic structures;
in Paragraph II B we demonstrated that paraxial approx-
imation can always be applied to Maxwell equations in
the case of ultrarelativistic particles. Eq. (2) can always
be reduced to Eq. (28) in the treatment of Synchrotron
Radiation. In other words, there is no point in starting
from Eq. (2) when treating Synchrotron Radiation prob-
lems: one may start, directly, with the simpler Eq. (28)
without loss of generality.

Compared to Eq. (2), Eq. (28) is easier to apply for
analytical investigations, whose importance we already
stressed in the introduction, because the paraxial ap-
proximation has been applied from the very beginning, so
that the approximations made, their region of applicabil-
ity and their accuracy could be discussed independently
of the magnetic system selected.

The relation between our approach and the method
in Eq. (1) simpliﬁes then, to the relation between Eq.
(2) and Eq. (1). It is not straightforward to show this
relation because Eq. (2) does not coincide with Eq. (1)
−2 is dropped. However, it
ro
once the term in
|
|
(2) is completely
is straightforward to show that Eq.
equivalent to the expression for the Fourier transform of
the Lienard-Wiechert ﬁelds including the velocity ﬁeld
part. This can be shown in full generality, regardless of
the paraxial approximation. Eq. (2) can be written as

r′

−

¯E(ro, ω) =

∞

′

dt

e

−

−∞

Z

n
r′(t′)
2
|

ro
|

−

exp
∞

iω

+ |

′

t
(cid:18)

(cid:26)
dt

′

×
e
c

−∞

−
Z
d
dt′ exp

×

iω

t
(cid:18)

(cid:26)

(1

n

·
ro

′

−
+ |

ro

−

r′(t′)
|
c
β
n
−
ro
β)
|
−
r′(t′)
|
−
c

(cid:19)(cid:27)
r′(t′)
|
, (39)

(cid:19)(cid:27)

where we have used relation

1
c

d
dt′ |

ro

−

′

r′

(t

=

)
|

n

β .

−

·

(40)

Eq.
(39) can be integrated by parts. When the edge
terms can be dropped (we will discuss this assumption
below) one obtains

¯E(ro, ω) =

∞

−∞

′

dt

e

−

exp

iω

+ |

n
r′(t′)
2
|

ro
|
ro

−

−
r′(t′)
|
c
β
n
−
β)
ro
|
ro

−
r′(t′)
|
c

−

(cid:19)(cid:27)

r′(t′)

| (cid:21)

(cid:19)(cid:27)

′

Z
t
(cid:18)

′

−
t
(cid:18)

n

·
+ |

(41)

+

e
c

×

∞

(cid:26)

dt

′ d
dt′

−∞

Z

(1

(cid:20)
iω

(cid:26)

exp

×

With the help of Eq. (40) and

dn
dt′ =

c
r′(t′)
|
one obtains, from Eq. (41) the Fourier transform of the
Lienard-Wiechert ﬁelds:

β + n (n

ro
|

[
−

(42)

β)]

−

·

¯E(ro, ω) =

e

−

e
c

−

∞

′

dt

−∞

Z

−
′
t
(cid:18)

n

∞

′

dt

γ2(1

(cid:20)

exp

iω

−∞

Z

×

(cid:26)
1
n

·
iω

(1

−
exp

"

×

(cid:26)

β)2

′

t
(cid:18)

β
−
β)2
ro

n

n

·
+ |

×

[(n
ro
|
ro

−

+ |

(cid:21)

2
|

r′
ro
−
|
r′(t′)
|
−
c
(cid:19)(cid:27)
˙β]
β)
−
r′
|
−
r′(t′)
|
c

×

#

(cid:19)(cid:27)

. (43)

The only assumption made going from Eq. (39) to Eq.
(43) is that the edge term in the integration by parts is
simply zero. This assumption can be justiﬁed by means
of physical arguments in the most general situation ac-
counting for the fact that the integral in dt′ has to be
performed over the entire history of the particle and that
at t′ =
the electron does not con-
tribute to the ﬁeld anymore. It is obvious that the same
line of reasoning can be followed starting from Eq. (43)
and going back to Eq. (39): in general, edge terms can
be dropped.

and t′ = +

−∞

∞

The previous statement is very general and per se triv-
ial but it should be interpreted from a physical viewpoint
depending on the situation.

10

Screen

A

B

x

L

z

zo

FIG. 3: A system constituted by two bending magnets con-
nected by a straight section of length L. Radiation is collected
at a distance zo from the downstream magnet.

For instance, consider the case of a system like the
one sketched in Fig. 3 (which will be treated extensively
in Paragraph III C). Fig. 3 shows two bending magnets
separated by a straight line. Before and after the straight
lines are two semi-inﬁnite straight sections. A question
arises about what we may take as t′ =
∞
in this particular situation. Intuitively the magnets act
like switches: the ﬁrst magnet switches radiation on, the
second switches it oﬀ. The statement that edge terms can
be dropped, combined with the paraxial approximation
tell that we can take t′ =
as the particle
is well inside the ﬁrst and the second bend, respectively,
and neglect other parts of the trajectory.

and t′ = +

and t′ = +

−∞

−∞

∞

Note that an expression alternative to Eq. (2) for the
Fourier transform of the electric ﬁelds can be found in
[31]. After starting with Eq. (43), the authors of [31]
organized integration by part in a diﬀerent way compared
with what has been done in Eq. (41). First they found
that

n
ro
|

×
−

[(n
−
r′
(1
|
˙n(n

−

(cid:20)

˙β]
β)2 =

β)
n

×
·
−
β) + n( ˙n
ro
|

·
−

·

1

ro
|
β)
r′

−
(1
|

r′
−
|
˙n(n
n

−

·
·

n
(n
×
n
(1
−
β( ˙n

β)
×
β)
·
β)

−

·

d
dt′
(cid:20)
β)2
β)2

(cid:21)

(cid:21)
. (44)

Note that Eq. (44) accounts for the fact that n = (ro
r′(t′))/
using Eq. (44) in the integration by parts they got:

−
is not a constant in time. Second,

r′(t′)
|

ro
|

−

¯E(ro, ω) =

−

ic
ω

β

n
−
ro
|
ro
+ |

′

−
−
−

∞

′

dt

−∞

β)

iωe
c
Z
2n(n
·
r′(t′)
2
|
r′(t′)
|
c

(cid:19)(cid:27)

(cid:21)

(45)

n
×
ro
|

(n

β)
×
r′(t′)
|

−

+

×

−

(cid:20)

exp

iω

×

(cid:26)

t
(cid:18)

where, similarly as before, the edge terms have been
dropped. Eq. (45) includes an integrand which is com-

ro
|

pletely diﬀerent with respect to Eq. (2). This is no mis-
take. Both Eq. (2) and (45) are correct: using integra-
tion by parts in diﬀerent ways simply gives diﬀerent in-
tegrands which anyway, after integration, yield the same
value for ¯E(ro, ω). It is interesting to note that, both in
Eq. (2) and Eq. (45), terms in the ﬁrst and second pow-
r′(t′)
−1 cannot be interpreted as is usually
ers of
|
done in time domain, as acceleration and velocity terms
respectively nor they constitute, mathematically, Fourier
pairs with ¯E(ro, ω). In fact, a diﬀerent organization of
the integration by parts leads to diﬀerent results: such
terms have, here, no separate physical meaning. We have
just shown that this situation is obtained starting from
the Lienard-Wiechert ﬁeld, applying integration by parts
in two diﬀerent ways and dropping the edge terms.

−

to t′ = +

Going back to the fact that edge terms can be dropped,
we can make now some remark which is particularly in-
teresting from a methodological viewpoint. Edge terms
are important only when calculation of radiation proper-
ties from a given system is performed over a part of it,
that is integration is not taken from t′ =
∞
but only on a part of the trajectory arbitrarily chosen.
However, summing up all non-negligible contributions
is equivalent to integrate the system from t′ =
to
t′ = +
. From this viewpoint edge radiation can be
calculated without accounting for edge terms, which are
artiﬁcial. As we will show in Paragraph III C, the low-
frequency component of the ﬁeld generated by a particle
moving as in Fig. 3, usually referred to as edge radiation,
actually arises from the straight line between the bends
when one integrates the system over all the particle tra-
jectory.

−∞

−∞

∞

As said before, on the one hand the term in

in Eq. (2) can be dropped in paraxial approximation but,
on the other hand, Eq. (2) does not coincide with Eq.
(1) once the velocity term is dropped. In other words,
r′(t′)
−1 of Eq. (43) is not the term in
ro
the term in
|
|
r′(t′)
−1 of Eq. (2). Even in paraxial approxima-
ro
|
|
tion, the velocity term in Eq. (43), in general, cannot be
dropped. In fact, in order to do so, it is required that the
ratio between the modulus of the velocity ﬁeld and the
modulus of the acceleration ﬁeld is much smaller than
unity:

−

−

ro
|

−

r′

−2
|

˙β]
|
| |
Then, in paraxial approximation we have

ro
|

β)

r′

γ2

−

×

−

×

c

n

|
n

−

β
[(n

|

1

≪

(46)

n

[(n

β)

×

−

×

˙β] =

n

˙β
[

−

×

×

−

˙β
[

·

≃

−

(n

β)]

(n

β)]n (47)

Substitution in condition (46) gives

γ2

ro
−
|
c

r′

|

n
n

β
β

−
−

(cid:18)

|

˙β

·

|

≫

(cid:19)

1 .

(48)

Condition (48) depends on the system under investiga-
tion, but in general is not automatically satisﬁed. For

instance, in the case of circular motion
being the circle radius. Then we have

11

˙β/c

∼

1/R, R

γ2

ro
−
|
c

r′

|

n
n

β
β

−
−

(cid:18)

|

˙β

·

|

≤

(cid:19)

γ2roθo
R

.

(49)

˙β. For instance, it
where θo is the angle between n and
is well known that the radiation formation length at the
R/γ and
critical wavelength λc ∼
that θo ∼

1/γ; then, in the case ro ∼

R/γ3 is simply Lf ∼

Lf , we have

γ2roθo

1 .

R ∼

(50)

Lf and λ

λc condition (48)
As a result, when ro ∼
is not satisﬁed, although the paraxial approximation is
enforced. This counterexample shows that paraxial ap-
proximation, alone, is not suﬃcient to guarantee that the
velocity ﬁeld in Eq. (43) can be dropped.

∼

The region of parameter space for which the velocity
ﬁeld can be neglected is usually referred to as the far ﬁeld
zone.
In order to be in the far ﬁeld zone the paraxial
approximation is necessarily enforced.

We take the condition that n is constant as a deﬁnition
of the far ﬁeld zone. When this is the case, the classical
result (see for instance [4])

n
(1

[(n
n

·

β)
−
ro
β)
|

×
−

×
−

˙β]
r′

|

=

1
ro

d
dt′

n

(n
n

×
1

−

×
·

β)
β

(cid:21)

(cid:20)

(51)

can be used to perform integration by parts. Starting
from Eq. (43) and assuming, as explained before, that
the edge terms can be dropped, we arrive at the widely
used result presented in textbooks (see again [4])

¯E(ro, ω) =

′

dt

[n

∞

−

iωe
cro Z
iω
exp

−∞

×

(cid:26)

′

t
(cid:18)

−

×

n

1
c

r′

·

(n

β)]

×

. (52)

(cid:19)(cid:27)

·

β

n

−

≃

×

×

−

β)

(n

β one has
Now, with ultra relativistic accuracy 1
n
n: using this relation we see straightfor-
wardly that, in the far ﬁeld zone, Eq. (52) is equivalent
to Eq. (33). To conclude, in this discussion we have seen
that paraxial approximation can be applied in the cal-
culation of Synchrotron Radiation properties for any set
of parameters. Moreover, in general, we should account
for both velocity and acceleration term in the Lienard-
Wiechert expression: however, in the case n can be taken
as a constant (far zone approximation), the velocity term
can always be dropped.

III. BENDING MAGNET RADIATION

A. Circular motion

Consider a particle moving along a circular trajectory
and an observer as sketched in Fig. 1. The radiation from
a particle moving with velocity v along a circle of radius R
is observed from a point P . R is the only characteristic
length of the system so that we can impose naturally
that Lch is R. When θy and θx, deﬁned in Fig. 1, are
much smaller than unity the reference system (x, y, z)
indicated in Fig. 1 is a consistent with the conditions
for paraxial treatment explained in the previous Section
and Eq. (28) can be used to characterize the radiation
at P . The motion along the curvilinear abscissa s can be
described as

r′
⊥(s) =

R (1

−

−

cos(s/R)) ˆx

and

′

z

(s) = R sin(s/r)

where s = vt′ and the expansion in Eq. (53) is justiﬁed,
once again, in the framework of the paraxial approxima-
tion.

Since the integral in Eq. (28) is performed along z′
we should invert z(s) in Eq. (54) and ﬁnd the explicit
dependence s(z′):

′

s(z

) = R arcsin(z

/r)

′

′

z

+

≃

z′3
6R2

so that

r′
⊥(z

′

) =

z′2
2R

ˆx

−

(56)

Substituting Eq. (55), Eq.(54) and Eq. (53) in Eq.

(28) we can write

E⊥(zo, r⊥o, ω) =
xo + z′2/(2R)
zo −

z′

(cid:19)

e
+

vz′
Rc

×

(cid:20)(cid:18)

iωe
c

ˆx +

∞

dz

−∞

Z

yo
zo −

(cid:18)

′ eiΦT
zo −
ˆy
z′
(cid:21)

(cid:19)

z′

,

(57)

where ΦT is given by

ΦT = ω

z′
2γ2c

+

z′3
6R2v

+

 

2

xo + z′2/(2R)
z′)
2c(zo −
(cid:3)

(cid:2)

+ y2
o

.

!

(58)
At this stage our expression is still very general and valid
for any observation distance zo. We keep up to the third

12

∼

∞

order in z′ in the expression for s(z′) in the phase, since
the term z′/(2γ2c) includes the small parameter 1/γ2.
Note that, although integration is performed from

−∞
to
, the only part of the trajectory contributing to
the integral is of order of the radiation formation length
Lf = [λR2/(2π)]1/3. At the critical wavelength R/γ3
R/γ. Physically, this is included in our
that is simply
paraxial approximation. Mathematically, it is reﬂected
in the fact that ΦT in Eq. (58) exhibits more and more
rapid oscillations as z′ becomes larger and larger due to
non linear terms: in particular note that, as z′
Lf , the
∼
term in z′3 in Eq. (58) is of order unity. If zo ≥
Lf we
z′)−1 around zo. We
can expand all expressions in (zo −
will be considering the so-called f ar f ield radiation limit
z′)−1 we will retain up to the
so that, expanding (zo −
third order in z′ in the expression for the phase and up to
the ﬁrst order in z′ in the rest of the integrand. We intro-
duce angles θx = xo/zo and θy = yo/zo as in Fig. 1 (with
1). Then, accounting
1 and θy ≪
the restriction θx ≪
c, Eq. (57) and Eq. (58) read respectively
for v

∞

−∞

iωe
c2zo Z

′

eiΦT

dz

z′ + Rθx
R

(cid:18)

ˆx + θy ˆy

(59)

(cid:19)

(53)

(54)

≃

E =

and

e

ΦT = ω

x + θ2
θ2
y
2c

" 

zo

+

!
θx
2Rc

+

1
2γ2c

+

 

′2 +

z

′

z

x + θ2
θ2
y
2c !
′3

z

1
6R2c

(cid:19)

(cid:21)

(cid:18)

(cid:19)

(cid:18)

. (60)

(55)

One can easily reorganize the terms in Eq. (60) to obtain

ΦT = ω

x + θ2
θ2
y
2c

" 
1
γ2 + θ2

y

(cid:19)

+

(cid:18)

zo

Rθx
2c
! −
(z′ + Rθx)
2c

+ θ2
y

θ2
1
x
γ2 +
3
(z′ + Rθx)3
6R2c

#

(cid:19)

(cid:18)

+

. (61)

Finally, redeﬁnition of z′ as z′ + Rθx gives the ﬁnal result

E =

iωe
c2zo

exp

iω

e
×

(cid:26)

(cid:20)

eiΦs eiΦo
z′
2γ2c

∞

′

dz

z′
R

−∞

Z
1 + γ2θ2
y

(cid:18)

+

(cid:0)

(cid:1)

ˆx + θy ˆy
z′3
6R2c

(cid:21)(cid:27)

(cid:19)
, (62)

where

and

Φs =

ωzo
2c

x + θ2
θ2
y

(cid:0)

(cid:1)

Φo =

ωRθx
2c

−

1
γ2 +

θ2
x
3

(cid:18)

+ θ2
y

.

(cid:19)

(63)

(64)

∼

x + θ2

Lf , this term is of order unity if θ2
f to L2

y)z′ in the phase of
Note that the linear term in (θ2
Eq. (59) deﬁnes the maximal angle of interest. In fact,
when z′
x + θ2
y ∼
[λ/(2πR)]2/3; this is simply the ratio of L2
ch. As the
observation angle grows more the linear term becomes
larger and larger resulting in an oscillatory behavior of
the entire integral in Eq. (59) and thus giving no net
contribution to the ﬁeld. A similar mechanism has been
discussed in relation with the radiation formation length.
Now that we have found an upper limit to the observation
angle, Lf /Lch, it is interesting to discuss the accuracy of
our expression. We have

r⊥o
|
−
2(zo −

⊥

r′
2
|
z′)2 ∼

x + θ2
θ2

θx

y −

L2
f
Rz0

+

L4
f
4R2z2

o ∼

L2
f
R2 ≪

1 .

(65)
In other words, the accuracy of our calculations is given
by the square of the maximal observation angle.

To compare Eq.

(62) with results in literature (for
instance [5, 7]) we should remember that the latter are
obtained using a reference system like the one in Fig. 2.
Therefore, in order to perform a comparison, we should
let θx = 0, so that Φo = 0. Then, since results are often
obtained in terms of integration along the retarded time
t′ we should use z′

vt′. Finally we obtain

≃

eiΦs
t′
2γ2

E =

iωe
czo

e
exp

iω

×

(cid:26)

(cid:20)

∞

′

dt

−∞

(cid:18)
Z
1 + γ2θ2
y

ct′
R

+

(cid:0)

(cid:1)

ˆx + θy ˆy
t′3c2
6R2

(cid:21)(cid:27)

(cid:19)
. (66)

Every Synchrotron Radiation textbook (see, for instance
[6]) shows that Eq. (66) can be written as

E =

√3e
czo

2Rω
3γ3c

−

eiΦs γ(1 + γ2θ2
y)

K2/3(ξ)ˆx

e
× "

i

γθyK1/3(ξ)
y)1/2
(1 + γ2θ2

−

#

. (67)

Here K2/3 and K1/3 are the modiﬁed Bessel functions of
second kind of fractional order 2/3 and 1/3 respectively,
while

ξ =

Rω
3γ3c

(1 + γ2θ2

y)3/2 .

(68)

(12), textbook versions of Eq.

Note that, depending on the deﬁnition of Fourier trans-
form Eq.
(66) or Eq.
(67) may diﬀer by a factor 1/√2π and (or) by the oper-
ation of complex conjugation; moreover textbooks often
neglect the exact phase factor for the ﬁeld, since they are
usually more interested in the calculation of the intensity,
which involves the square modulus of Eq. (66).

The result in Eq. (67) is far from being trivial. Bessel
functions are real, therefore the ˆx component in Eq. (67)

13

10
5
0
-5
-10

o(rad) – x polarization component

0.01

0.005

0

-0.005

yo(m)

0.01
0.01

0
0

-0.01
-0.01

xo(m)

-0.01

FIG. 4: Phase correction for the horizontal polarization com-
ponent of the ﬁeld; case discussed in [27].

is real, while the ˆy component is purely imaginary. In
other words, the ˆx component of the integral in Eq. (66)
is purely imaginary, while the ˆy component is real. This
is not immediately obvious, but it can be easily seen by
inspection, accounting for the fact that the exponential
function in the integrand can be written as exp(i
) =
); then, for parity reasons, the term in ˆx,
cos(
) + i sin(
·
·
being odd, couples with the sine function, thus giving an
imaginary result while the term in ˆy, being even, couples
with the cosine function, giving a real result.

·

From the previous remarks it follows that the only
non-trivial phase factor is speciﬁed by the surviving ex-
ponential argument Φs = ωzoθ2
y/(2c), which is usually
neglected in literature. This simply represents, in our
paraxial approximation, the phase diﬀerence between the
point (0, yo, zo) and the point (0, 0, zo). Physically, in the
particular reference frame of Fig. 2, which we have cho-
sen by setting θx = 0, the electric ﬁeld is represented by
a spherical wave propagating outwards from the origin of
the coordinate system.

It is interesting now to investigate the meaning of
the phase Φo, which is nonzero for nonzero values of
θx. This term has no equivalent in the usual treatment
of Synchrotron Radiation, because displacement along
the x axis cannot be considered in the reference system
sketched in Fig. 2. In the usual treatment, an xo dis-
placement is treated redeﬁning the reference frame so
that xo = 0. This redeﬁnition has simply the eﬀect of
shifting the phase of the ﬁeld expressed in the old refer-
ence frame of a quantity iΦo.

There is a considerable amount of literature dealing
with the phase of the Fourier components of the elec-
tric ﬁeld vector in Synchrotron Radiation (see, for in-
stance [27]). In particular, [27] reports the results of a
thorough simulation of single particle eﬀects. It is obvi-
ously found that the wavefront of a single particle is not
spherical; a correspondent phase shift (with respect to

w
f
w
f
w
f
w
f
o+p

c (q

q )(rad) – y polarization component

0.01

0.005

0

yo(m)

-0.005

0.01
0.01

0
0
xo(m)

-0.01
-0.01

-0.01

FIG. 5: Phase correction for the vertical polarization com-
ponent of the ﬁeld; case discussed in [27].

the spherical wave) for the ﬁeld of a single particle was
computed and analytical estimations within 1% of the
numerical result were presented which are in complete
agreement with Eq. (64). For the sake of completeness
and comparison we present, in Fig. 4 and Fig. 5 the
phase shifts calculated for the horizontal and vertical po-
larization components, respectively by means of our Eq.
(64) for the same example considered in [27]: bending
magnet emission from a 2.5 GeV particle, constant mag-
netic ﬁeld in bending magnet 1.56 T, photon energy 40
eV and distance from tangential source point to optical
component 5 m. Note that these parameters correspond
R/γ. The phase for the
to the far zone case where zo ≫
y-polarization component, in Fig. 5, is simply the phase
for the x-polarization component (that is Fig. 4) added
0 and H(θy) = 0
to πH(θy), where H(θy) = 1 for θy ≥
for θy < 0: this last terms simply accounts for the fact
that the y component of Eq. (66) is odd.

B. Circular motion with oﬀset and deﬂection

Electrons following a circular motion are, of course, an
approximation. Electron beams have always some small
angular spread and oﬀset with respect to the nominal tra-
jectory. Any beam with a small geometrical emittance
can be thought, in agreement with paraxial treatment,
as a composition of perfectly collimated beams with dif-
ferent deﬂection angles with respect to the orbital plane
of the nominal trajectory. This representation is use-
ful when one is interested in calculating, for instance,
the inﬂuence of angular spread and oﬀset on the electric
ﬁeld intensity: one can simply compute the contribution
for each collimated beam and sum up the results. This
method allows to simplify calculations of more compli-
cated quantities like the ﬁeld autocorrelation function,
which is of uttermost importance in the characterization

14

of the statistical properties of a light source. We have al-
ready discussed the advantage of our method regarding
calculations of the ﬁeld autocorrelation function in con-
nection with the choice of a ﬁxed reference frame as in
Fig. 1. Let us now discuss how it can be used to calculate
E from a single particle with a given angular deﬂection
with respect to the orbital plane of a nominal electron.
Such an expression was ﬁrst calculated, starting from the
e
Lienard-Wiechert ﬁelds, in [32].

The meaning of horizontal and vertical deﬂection an-
gles ηx and ηy is clear once we specify the particle velocity

10

0

-10

v(s) = v

sin

s
R

+ ηx

(cid:17)
+ cos

h

(cid:16)

cos(ηy)ˆx + sin(ηy)ˆy
cos(ηy)ˆz
i

+ ηx

s
R

(cid:17)

(69)

(cid:16)
so that the trajectory can be expressed as a function of
the curvilinear abscissa s as

s
R

r′

=

+ ηx

cos(ηy)
R cos(ηx) cos(ηy)] ˆx + [ly + s sin(ηy)] ˆy
s
ˆz
R

lx + R cos
h
cos(ηy)

(cid:16)
R sin(ηx) sin(ηy)
i

+ ηx

−

(cid:17)

(cid:17)

−

(cid:16)

(70)

+

+R sin

h

Here we have introduced, also, an arbitrary oﬀset
(lx, ly, 0) in the trajectory. Using Eq. (70) an approx-
imated expression for s(z′) can be found:

′

′

s(z

) = z

+

z′3
6R2 +

z′2ηx
2R

+

z′η2
x
2

z′η2
y
2

+

(71)

so that

and

′

v⊥(z

) =

+ vηx

ˆx + (vηy) ˆy

(72)

vz′
R

−

(cid:18)

(cid:19)

z′2
2R

−

r′
⊥(z

′

) =

′

+ ηxz

+ lx

ˆx + (ηyz

′

+ ly) ˆy .

(73)

(cid:19)
(cid:18)
1 in agreement with
1 and ηy ≪
We will consider ηx ≪
the fact that we deal with electron beams with small an-
gular deﬂection and not with more general kind of plas-
mas.

Substituting, as in the previous Paragraph, Eq. (71),

Eq. (73) and Eq. (72) in Eq. (28) we can write

E⊥(zo, r⊥o, ω) =
lx −
xo −

ηx +

z′
e
R −

×

(cid:20)(cid:18)

+

ηy +

−

(cid:18)

∞

Z

dz

′ eiΦT
iωe
c
zo −
−∞
ηxz′ + z′2/(2R)
zo −
yo −

z′
ηyz′
ly −
z′
zo −

(cid:19)
ˆy
(cid:21)

(cid:19)

z′

ˆx

,

w
f
w
f
w
f
w
f
p
p
p
c
c
c
q
q
(74)

ηx) gives the result

Redeﬁnition of z′ as z′ + R(¯θx −
z′
R

iωe
c2zo

E =

−∞

dz

∞

′

eiΦs eiΦo
z′
2γ2c

(cid:18)
Z
1 + γ2(¯θy −
(cid:0)

ηy)ˆy

ˆx + (¯θy −
z′3
ηy)2
+
6R2c

(cid:21)(cid:27)

(cid:1)

(cid:19)
, (79)

e
exp

iω

×

(cid:26)

(cid:20)

. (75)

where

and

Φs =

ωzo
2c

¯θ2
x + ¯θ2

y

(cid:0)

(cid:1)

15

(80)

where ΦT is given by

ΦT = ω

lx −

+

xo −
(cid:2)

+

z′
2γ2c

z′3
6R2v
 
ηxz′ + z′2/(2R)
2c(zo −

z′)
(cid:3)

+

z′2ηx
2Rv
+ [yo −

+

z′η2
x
2v
ly −

2

z′η2
y
2v

+

ηyz′]2

!

At this stage, as in the previous Paragraph, our expres-
sion is still very general and valid for any observation
distance zo, and again as we did before, we have retained
up to the third order in z′ in the expression for s(z′) in
the phase, since the term z′/(2γ2c) includes the small
parameter 1/γ2 and up to the ﬁrst order in z′ in the
rest of the integrand. We will now consider the far ﬁeld
radiation limit which, as the reader remembers, allows
z′)−1 around zo: as
expansion of all expressions in (zo −
before we will retain up to the third order in z′ in the
expression for the phase and up to the ﬁrst order in z′
in the rest of the integrand. From Eq. (74), Eq. (75)
and Eq. (73) it is evident that the oﬀsets lx and ly are
always subtracted from xo and yo respectively: shifting
the particle trajectory on the vertical plane is equivalent
to a shift of the observer in the opposite direction. With
this in mind, in analogy with Fig. 1, we introduce angles
¯θx = θx −
ly/zo (with the restriction
¯θx ≪
1 and ¯θy ≪
1 and
(75) can be written down
1, Eq.
ηy ≪
respectively, as follows:

lx/zo and ¯θy = θy −
(74) and Eq.

1). Then, accounting for ηx ≪

E =

′

eiΦT

dz

∞

−∞

iωe
c2zo Z
ˆx + (¯θy −

ηy)ˆy

(76)

(cid:19)

z′ + R(¯θx −

ηx)
e

R

×

(cid:18)

and

ΦT =

+

¯θy −
(cid:0)

x + ¯θ2
¯θ2
2c

y

2

′

z

+

 

ηy

zo

+

!
¯θx
2Rc

1
2c

1
γ2 +
(cid:18)
′2 +

z

¯θx −
(cid:0)
1
6R2c

2

ηx

(cid:1)
′3 . (77)

z

(cid:19)
One can easily reorganize the terms in Eq. (77) to obtain

(cid:19)

(cid:18)

(cid:18)

(cid:17)

(cid:1)

and

ΦT =

y

x + ¯θ2
¯θ2
2c
 
1
γ2 + (¯θy −
ηy)2

zo

ηx)

! −

R(¯θx −
2c
(¯θx −
ηx)2
3
z′ + R(¯θx −

ηx)

(cid:19)

ηy)2 +

×
(cid:18)
1
γ2 + (¯θy −

+

(cid:18)

2c

(cid:19) (cid:0)
z′ + R(¯θx −
6R2c

+

(cid:0)

(cid:1)

3

ηx)

(cid:1)

. (78)

.

Φo =

ωR(¯θx −
2c

−

ηx)

1
γ2 + (¯θy −

ηy)2 +

ηx)2

(¯θx −
3

(cid:18)

(cid:19)
(81)
Except for the phase term Φs, Eq. (79) can be obtained
from Eq. (62) simply by substituting θx with ¯θx −
ηx
and θy with ¯θy −
ηy: besides a common phase factor
then, we can say that including a deﬂection angle has the
same eﬀect of shifting the observer position of the same
angle. Still, we should remember that ¯θx = θx −
lx/zo
and ¯θy = θy −
θF , with θF = [λ/(2πR)]1/3,
one can simplify further Eq. (79). Note how introduction
of small parameters allows increasing specialization and
simpliﬁcation of the theory:
for instance, in this Para-
graph we started with an expressions for the ﬁelds ob-
tained in the limit for 1/γ2
1, that could be cast into
z ≫
simpler form in the limit Lf /zo ≪
1 and now further
specialized assuming lx,y/zo ≪

In the limit for lx,y/zo ≪

θF leading to:

ly/zo.

E =

eiΦseiΦo

iωe
c2zo

∞

′

dz

z′
2γ2c

−∞

(cid:18)
Z
1 + γ2 (θy −

(cid:16)

e
exp

iω

×

(cid:26)

(cid:20)

where

ηy) ˆy

z′
ˆx + (θy −
R
z′3
ηy)2
+
6R2c

(cid:21)(cid:27)

(cid:17)

(cid:19)
, (82)

Φs =

ωzo
2c

x + θ2
θ2
y

(cid:0)

(cid:1)

(83)

Φo ≃ −
+

ηx)

ωR(θx −
2c
ηx)2
(θx −
3

(cid:18)

ηy)2

1
γ2 + (θy −
ω
(lxθx + lyθy) . (84)
c

−

(cid:19)

Eq. (79) is an extremely useful tool, because it describes
the radiation from an electron with oﬀset and deﬂection
as in an electron beam with ﬁnite emittance, including
the correct phase factor for the ﬁeld. Starting from Eq.
(79) then, it is possible to calculate the ﬁeld correlation
function, and to provide a study of transverse coherence
properties of the radiation from a given electron beam by
means of analytical techniques.

As has already been remarked, coherence is a spe-
cial and important property of Synchrotron Radiation
sources. In the far zone, the spatial coherence at diﬀer-
x,y and θ(2)
ent observer angles θ(1)
x,y is characterized by the
autocorrelation function (see [36, 37] and [38] for appli-
cations to Synchrotron Radiation science):

=

∗
E
i

θ(1)
x,y, ηx,y, lx,y

Ej

Γij

x,y, ω

x,y, θ(2)
θ(1)
(cid:16)
θ(2)
x,y, ηx,y, lx,y

(cid:17)

(85)

e

e

(cid:16)

(cid:17)

(cid:16)

(cid:17)E

...
i
h

D
e
Ei is the i-th Fourier component of the electric ﬁeld
where
given in Eq. (79), and brackets
denote an ensemble
average with respect to electron parameters. Note that
a given electron is correlated just with itself, that is why
Eq. (85) only includes the electric ﬁeld from a single elec-
tron and not from two diﬀerent particles. The ensemble
average can be replaced by integration over the electron
phase-space density. The intensity distribution can be
obtained directly from Eq. (85) by letting θ(1)

x,y = θ(2)
x,y.

Of course a numerical code can always be developed,
either starting from Eq. (28) or just from the Lienard-
Wiechert ﬁelds, which calculates the ﬁeld correlation
function in a generic case, but such a code would not
help in physical understanding of the situation. On the
contrary, Eq. (79) includes all relevant information about
an electron in a realistic beam (i.e. with oﬀset and deﬂec-
tion) and, being an analytically manageable expression,
constitutes the ﬁrst step towards the characterization of
transverse coherence properties from bending magnet ra-
diation.

C. Edge radiation

In this Paragraph we will stress the importance of the
knowledge of the entire trajectory followed by the elec-
tron as we study the eﬀect of a change in longitudinal
velocity due to the passage of an electron in a magnetic
system. This results in collimated emission of radiation
in the low photon energy range, a mechanism analogous
to transition radiation, which is well-known in literature
under the name of edge radiation [27, 39, 40].

We restrict ourselves to the system depicted in Fig.
3, which shows two bending magnets separated by a
straight line of length L. Radiation is detected at a
screen positioned at distance zo from the downstream
magnet. We will require that the bending magnets de-
ﬂect the electron trajectory of an angle much larger than
[λ/(2πR)]1/3, λ being the wavelength of interest: in this
way the straight lines before the upstream bend and after
the downstream bend do not contribute to the ﬁeld de-
tected at the screen position. Intuitively, the magnets act
like switches: the ﬁrst magnet switches the radiation on,
the second switches it oﬀ. The trajectory can be there-
fore split in three parts: the two bends and the straight

16

section of length L between them. With the help of Eq.
(28) we write the contribution from the straight line as

B

′

A

dz

EAB =

eiΦT (θx ˆx + θy ˆy)

iωe
c2zo Z
e
L. The previous assumption is
where we assumed zo ≫
not always veriﬁed in cases of practical interest. Here,
however, we are only concerned with an example of ap-
plication of our method. ΦT in Eq. (86) is given by

(86)

ΦT = ω

x + θ2
θ2
y
2c

"

zo +

z′
2c

(cid:18)

1
γ2 + θ2

x + θ2
y

(cid:19)#

.

(87)

The characteristic length related to the straight section
is obviously Lch = L. In general, the formation length of
radiation at wavelength λ is given imposing ωz′/(2cγ2)
1, which gives Lf ∼
low frequencies such that ωL/(2γ2c)
consider Lf ∼
(87). Trivial calculations show that

∼
γ2λ. However, if we are interested in
1, we can simply
L and neglect the term in 1/γ2 in Eq.

≪

EAB =

iωeL
c2zo

−

eiΦs (θx ˆx + θy ˆy)

sin

ωL(θ2

x + θ2

[ωL(θ2

x + θ2

y)/(4c)
y)/(4c)]

,

(cid:2)

(cid:3)
(88)
e
where Φs has the usual meaning (compare, for instance,
with Eq. (63)). The magnitude of the contribution from
the straight section AB can be estimated noting that the
sinc function in Eq. (88) drops rapidly as θ2
y reach the
value 4c/(ωL) = 2λ/(πL). This means that a maximal
observation angle of interest related to the straight line
can be found in the transverse direction:

x+θ2

θ2
x,y ∼

λ
2πL

.

(89)

At this angle, the formation length for the straight line
radiation at wavelength λ is simply equal to the straight
section length, L, as it can be seen from Eq. (87). Then,
the magnitude of

EAB is of order

e
EAB

1/2

2e
czo (cid:18)
e
On the other hand, the magnitude of the contributions
from the bends can be estimated as

ωL
c

(90)

|∼

(cid:19)

|

.

Eb

∞

′

dz

z′
R

1 + γ2θ2
y

+

ωe
c2zo Z
∼ −
z′
2γ2c

0

(cid:20)

(cid:0)

(cid:18)

(cid:1)

ˆx + θy ˆy
z′3
6R2c

(cid:21)(cid:27)

×

exp

iω

e
(cid:26)

(cid:19)
. (91)

In Eq. (91) we have redeﬁned the origin of our reference
system, as it is clear from the integration limits; however,

here we are interested in the magnitude and not in the
phase of the ﬁeld, so that we can use Eq. (91) without
further discussion on the correct phase. The linear term
in z′ in the exponential function in Eq. (91) is of order
unity for angles θy such that

ωLf
2c

1 .

θ2
y ∼
Substituting the formation length for the bends Lf B ∼
[λR2/(2π)]1/3 we obtain a condition for the maximal ob-
servation angle of interest related to the bending magnets

(92)

θ2
y ∼

λ
2πR

(cid:18)

(cid:19)

2/3

.

(93)

y ∼

The previous condition on θ2
y found for the bends has to
be compared with the condition on θ2
y previously found
for the straight line, θ2
λ/(2πL). The ratio between
the latter and the former is equal to the ratio of the
formation length for the straight line to the formation
length for the bends respectively, that is L/Lf B. As-
1, that is always veriﬁed in practice,
suming L/Lf B ≫
we obtain that the maximal observation angle of interest
related the straight line is much smaller than the maxi-
mal observation angle of interest related to the bend. As
a result the entire linear term in the phase of Eq. (91)
can be neglected thus leading to the following simpliﬁed
expression for

Eb:

Eb

∼ −

ωe
c2zo Z

0

e
∞

′

dz

z′
R

(cid:18)

e
An estimate of Eq. (94) is

ˆx + θy ˆy

exp

iωz′3
6R2c

.

(cid:19)

(cid:26)

(cid:27)

(94)

Eb

1/3
e

∼ −

ˆx +

2e
czo

L2
f
2R

ω
2c  
2/3

ωR
c

(cid:18)

(cid:19)

ˆx + θyLf ˆy

!

1/2

c
ωL

(cid:16)

(cid:17)

ˆy
#

. (95)

2e
czo "

1
2

ωR
c

(cid:18)

(cid:19)

∼ −

The ratio between the magnitude of the bend and the
straight section contribution is then

Eb

|
ωR
c

e
(cid:19)

−

(cid:18)

∼ −

EAB
e
2/3

|

c
ωL

(cid:16)

(cid:17)

1
2

(cid:18)
ˆy =

1/3

ωR
c

(cid:19)

1/2

ˆx

c
ωL

1
2 r

Lf
L

−

(cid:16)
ˆx

(cid:17)
Lf
L

−

ˆy . (96)

Therefore, under the already accepted condition L
≫
Lf one can neglect the contribution from the bending
magnet. The only remaining contribution is given by Eq.
(88), which represents an expression for the ﬁeld at the
detector position. We plot the intensity corresponding to

17

FIG. 6:
Intensity distribution of radiation from the setup in
Fig. 3 at λ = 10µm and for L = 1 m. Radiation is collected
at zo = 10 m from the downstream magnet. A contour plot
(upper ﬁgure) and a horizontal cut by the median plane (lower
ﬁgure) are presented.

the ﬁeld in Eq. (88) in Fig. 6 for the case λ = 10 µm,
L = 4 m and zo = 20 m.

Eq.

(88) is the same reported in [40, 41].

It is in-
teresting to remark that in conventional treatments of
Synchrotron Radiation, edge radiation has its origin in
the edge term arising in the integration by parts of Eq.
(1); in other words it is found from the acceleration part
of the Lienard-Wiechert ﬁeld, which is present only in
the magnets. On the other hand, from our method, edge
radiation arises as the contribution from the straight sec-
tion between the magnets. This seems paradoxical, but
one has to remember that there is no physical meaning in
the calculation of the ﬁeld harmonic content over a part
of the trajectory alone. It does not make any sense, for
instance, to calculate the ﬁeld intensity from the edge of
a single bend, because there will be either a second bend,
as in Fig. 3, other structures downstream of the second

18

FIG. 7: Radiation ﬁeld from an electron moving along a circle
in the time and in the frequency domain

FIG. 8: Radiation ﬁeld from an electron moving along an arc
of a circle in the time and in the frequency domain

bend which must be taken into account in the calculation
of the total ﬁeld: the sum of all these contributions will
give interference terms when the intensity is calculated.
Then, accepting the viewpoint that only the knowledge of
the entire trajectory of the particle brings physical sense
to ﬁeld calculations, there is no real contradiction: in our
method edge radiation appears from the straight section.
In the usual approach, instead, it appears from the edge
terms in the integration by part of the acceleration ﬁeld.
Yet these terms, alone, have no physical meaning. This
solves our paradox.

D. Short magnet radiation

FIG. 9: Radiation ﬁeld from an electron moving along a short
bending magnet in the time and in the frequency domain

≪

Our method can be used to compute radiation charac-
teristics from a short magnet, characterized by a bending
angle 2ψ
1/γ. This device has the quite interesting
characteristic that the Fourier transform of the electric
0
ﬁeld in the far ﬁeld limit has non-zero value for ω
and that the critical frequency does not depend on the
magnet radius but only on the magnet length. These
features can be explained in a simple way. For circular
motion the far ﬁeld from a single particle has the prop-
erty:

→

∞

−∞

Z

Edt = 0 .

(97)

When the electron moves in arc of circles with diﬀerent
angular extensions 2ψ though, the time-average of the
electric ﬁeld is nonzero; then, its Fourier transform has a
nonzero component for ω

0.
The ﬁrst studies on long wavelength asymptotic can be
found in [33]. For a review on the subject it may be in-
teresting to consult [7]; for a discussion dealing also with
properties of CSR (Coherent Synchrotron Radiation) see
[34]. In Fig. 7, Fig. 8 and Fig. 9 we plot the energy
spectrum of the radiation in the case of an electron mov-
ing on circular motion, dipole magnet and short bend,

→

→

2cγ2/Lm.

respectively. All ﬁgures refer to the ˆx polarization com-
ponent. As Eq. (97) does not hold we ﬁnd a nonzero
0. As the
component of the energy spectrum at ω
magnet extension becomes smaller than 1/γ the critical
frequency depends only on the magnet length Lm = 2Rψ
according to ωc ≃
The short magnet is a device of particular interest also
because its radiation characteristics are related to the
methodological issue introduced in Section I. From the
very beginning, our method relies on harmonic analysis
of the electric ﬁeld, so that the entire trajectory of an
electron is considered known. This gives no particular
problem in the case of a closed trajectory, as discussed
in the previous Subsections, but a question arises, now
that a short magnet is considered, about the trajectory
of our particle outside the short magnet. In general, the
ﬁeld at the observation position depends strongly on the
trajectory followed by the electron before and after the
magnet. So one should clarify what is the meaning of
the term short magnet radiation by itself, when it is
not speciﬁed what follows and what precedes the bend.
Computing the ﬁeld from the magnet alone as it is usu-
ally done has a meaning, but only in a particular sense:
one can always break up the beamline in several parts,

calculate contributions separately and ﬁnally add them
up, accounting for the proper relative phase, to get the
total ﬁeld at the observer position. Then the short mag-
net radiation is simply a part of the total ﬁeld, a contri-
bution to be added up to something else, which depends,
case by case, on what precedes and follows the magnet.
In conclusion, when we talk about radiation from a
short magnet, we mean the contribution to the total ﬁeld
at the observer position P due to the short magnet alone:
this makes sense as long as we consider it only a part of
the total ﬁeld, calculated separately just for computa-
tional convenience.

With this in mind we calculate the short magnet ﬁeld
(59) limiting the integration to the magnet
from Eq.
extent and using 2ψ
1/γ. This introduces a further
small parameter in our system which leads to extra sim-
pliﬁcation of already known formulas derived for the case
of a bending magnet with arbitrary extension. From Eq.
(59) we obtain

≪

E =

iωe
c2zo

eiΦs

e

Rψ

Z
exp

−Rψ

iω

×

×

(cid:26)

(cid:26)

(cid:18)

′

dz
z′
2γ2c
θxz′2
2Rc

(cid:2)

(cid:27)

z′ + Rθx
R

1 + γ2(θ2

(cid:19)

ˆx + θy ˆy

x + θ2
y)
z′3
6R2c

(cid:27)

(cid:26)

exp

iω

exp

iω

(cid:27)
(cid:3)
, (98)

(63).

In Eq.

iωz′3/(6R2c)
}

(98) we
where Φs is deﬁned as in Eq.
iωθxz′2/2Rc
intentionally separated phase factors exp
}
{
and exp
because we intend to neglect the
{
second and expand the ﬁrst around unity. For our sys-
tem the characteristic length is obviously Lch = Rψ. In
general, the formation length of the radiation is ﬁxed
γ2λ, but we will be
by the ﬁrst phase factor, Lf ∼
interested in studying the long wavelength region such
Rψ, that is the maximum attainable value,
that Lf ∼
since it is always Lf <
Lch. Then, the ﬁrst phase
factor imposes, simultaneously, ωRψ/(2γ2c) <
∼
1 and
xRψ/c <
ωθ2
∼
If on the one hand, from the ﬁrst of
1.
∼
2γ2c/(Rψ), from the second
these conditions ωmax ≃
<
1/(2γ2) and from the second
condition follows that θ2
x
∼
phase factor one has ωθx(Rψ)2/(2Rc)
1. On
the other hand if,
from the ﬁrst of these conditions,
2γ2c/(Rψ), then from the second condition follows
ω
≪
1/(2γ2) and from the second phase
that θ2
factor one has ωθx(Rψ)2/(2Rc)
1.
It follows from these considerations that we can per-
form the expansion of exp
up to the sec-
{
ond term with an accuracy (γψ)2 or better and neglect
iωz′3/(6R2c)
with the same accuracy for any choice
exp
}
{
of ω. Then we can write

iωθxz′2/2Rc
}

(γψ)/(γθx)

c/(ωRψ)

x ≃

γψ

≪

≪

≫

≃

∼

E =

iωe
c2zo

eiΦs

e
1 + iω

θxz′2
2Rc

×

(cid:18)

exp

iω

(cid:19)

(cid:26)

Rψ

′

dz

−Rψ

Z

z′
2γ2c

z′ + Rθx
R

(cid:18)
1 + γ2(θ2

ˆx + θy ˆy

x + θ2
y)

(cid:27)

(cid:3)

(cid:2)

(cid:19)
, (99)

and

19

Performing calculations and dropping negligible terms we
ﬁnd

E =

e
zoRc

−

eiΦs

2γ2
[1 + γ2(θ2
ˆx

−

(cid:17)

x + θ2
y)]2
2γ2θxθy
(cid:16)

(cid:17)

h(cid:16)
ˆy

2γ2θ2
x

−

e

where

1 + γ2(θ2

x + θ2
y)

¯χ[−Rψ,Rψ](α) , (100)
i

(cid:2)

Rψ

−Rψ

Z

α =

ω
2cγ2

1 + γ2(θ2

x + θ2
y)

(101)

(cid:3)

and

¯χ[−Rψ,Rψ](α) =

′

dz

exp

′

iαz
{

}

.

(102)

If we deﬁne a function χ[−Rψ,Rψ] which assumes uni-
tary value on the interval [
Rψ, Rψ] and zero value else-
−
where, then χ[−Rψ,Rψ] simply represents the magnetic
ﬁeld shape at the magnet position, and ¯χ[−Rψ,Rψ] is its
Fourier transform with respect to α.

Suppose now the magnetic ﬁeld has a generic shape
B(z′). Keeping the same accuracy as before, we can gen-
eralize Eq. (100) substituting relations

′
x

′

(z

) =

e
γme Z

0

−

and

′

z

′′

dz

′′

z

′′′

B(z

′′′

)

dz

(103)

′

vx(z

) =

e
γme Z

−

′′

′′

dz

B(z

) ,

(104)

z′2/(2R) and vx/c =

0
where me is the electron rest mass, in place of x′ =
(98).
−
−
Performing approximations as before and integrating by
parts two time the term in x′ and one time the term in
vx we ﬁnd that Eq. (100) can be easily generalized.

z′/R directly in Eq.

Results in literature are often given in cylindrical co-
o and θ =
y. The same choice can be found, for instance, [7].

ordinates (φ, θ, z) where sin φ = yo/
θ2
x + θ2
Making use of this system we obtain:

o + y2
x2

p

E =

2reγ
zo

eiΦs

1
(1 + γ2θ2)2

1

γ2θ2 cos(2φ)

ˆx

e

γ2θ2 sin(2φ)

(cid:2)(cid:0)
ˆy

−

1 + γ2θ2
(cid:1)
2cγ2 ω

(105)

(cid:19)
where re is the classical radius of the electron

(cid:18)

(cid:1)

(cid:0)

(cid:3)

−
¯B

0
Z

′

z

re =

e2
mec2

(106)

¯B(α) =

′

′

dz

B(z

) exp

iαz

′

}

.

{

(107)

∞

−∞

Z

(2).

As has been said, the ﬁeld from a short magnet makes
sense only as a part of the total ﬁeld from a given beam-
line. In this Paragraph we have calculated, for such con-
tribution, the expression in Eq. (105) which can also be
found in [7]. Our aim, here, is not to review a well-known
result, but to cast new light in its physical interpretation.
In order to do so we need ﬁrst a digression. Our Eq.
(28) is based on the more general Eq.
In Para-
graph II C we have shown that Eq. (2) is equivalent to
the Fourier transform of the Lienard-Wiechert ﬁelds Eq.
(43) provided that the edge term in the integration by
parts going from Eq. (43) to Eq. (2) (or viceversa) can
be dropped. On the one hand we showed that this can
always be done since the integral in Eq. (43) and Eq.
(2) should be performed over the entire electron history,
and only a ﬁnite part of the trajectory contributes, prac-
tically, to the electric ﬁeld at the observer position. On
the other hand, one is free to break up the beamline in
parts and sum up partial contributions to the total ﬁeld
using Eq. (43) followed by integration by parts for each
segment. In this case one must retain edge terms to ob-
tain the same result: as an example of this fact, using
our method, we have shown in Paragraph III C that the
edge radiation from the system depicted in Fig. 3 arises
as the contribution from the straight section between the
magnets, while conventional calculations indicate its ori-
gins in the edge term from the integration by parts of Eq.
(43) in the far ﬁeld limit.

Now coming back to the subject of this Paragraph, typ-
ical derivations of Eq. (105) (see [7, 33, 35]) start from
Eq. (1) and include the complete expression for the accel-
eration ﬁeld. Then, following conventional derivations, it
is not clear wether edge terms play an important role in
Eq. (105) or not. Yet, we were able to obtain Eq. (105)
without starting with Eq. (1): in fact we began with Eq.
(98) which is Eq. (59) with diﬀerent integration limits
which is, in its turn, a reduction of Eq. (28) that, ﬁnally,
is a simpliﬁcation of Eq. (2). Since our result coincide
with the one in literature it follows that edge radiation
from the presence of the short magnet is completely ig-
norable.

Of course, one should still account for contributions
from the other parts of the beamline: for instance, if the
short magnet were installed in the middle of the straight
section in Fig. 3 one should consider the edge radiation
contribution as in Paragraph III C.

However, according to our reasoning we can conclude
that one can safely drop the contribution of edge terms
due to the presence of the short magnet. On the contrary,
beginning with Eq. (1) as is done in usual treatments,
one is not able to separate the two physical phenomena
and, indeed, may be easily misunderstand and misinter-
pret results concluding, erroneously, that short magnet
radiation cannot be derived without edge contributions.

20

Screen

-N l

w/2

N l

w/2

zo

z

x

y

FIG. 10: Geometry for undulator radiation.

Here we have seen that a critical study of the theoret-
ical status of well-known formulas, can sometimes yield
surprises.

IV. RADIATION FROM INSERTION DEVICES

A. Standard undulator

For a review of up to date knowledge on undulator
radiation one may be interested in consulting references
[5] to [10]. An experimental characterization of radiation
from insertion devices at third generation light sources
can be found in [42]. Eq. (28) can be used to derive the
expression for ¯E(r, ω) in the case of an undulator as well.
Again, as before, we remark that, with the term undu-
lator ﬁeld we actually mean a part of the total ﬁeld seen
by an observer and that one should account, in general,
for the entire motion of the particle. The situation is
sketched in Fig. 10, where a planar undulator consisting
of Nw periods is sketched. We will follow [5] in deriving
well-known relations. For the electron transverse velocity
we assume

′

v⊥(z

) =

sin (kwz

)x .

′

cK
γ

−

(108)

Here K is the deﬂection parameter, kw = 2π/λw, where
λw is the undulator period, so that the undulator length
is Lw = Nwλw. The undulator length Lw is also, nat-
urally, the characteristic length of the system, so that
Lch = Lw. The transverse position of the electron is
therefore

r′
⊥(z

′

) =

cos (kwz

)x .

′

(109)

K
γkw

An expression for the curvilinear abscissa s as a function
of z is given by

′

s(z

) =

β
βav

′

z

−

K 2
8γ2kw

sin (2kwz

) .

′

(110)

where βav is the time-averaged velocity along the z di-

21

Screen

A

B

C

D

z

zo

FIG. 11: Radiation geometry for the undulator ﬁeld.

rection, that can be expressed as:

K 2
4γ2

(cid:19)

−

(111)

βav = β

1
(cid:18)
We can now substitute Eq. (109) and Eq. (108) in our
Eq. (28). Such a substitution leads to a general expres-
sion, valid for any observer distance zo. It is possible to
obtain, similarly to many Synchrotron Radiation text-
books, a simpliﬁed expression valid in the limit for large
values of zo. Since we are interested in the contribution
of the undulator device to the total ﬁeld at the observer
position, we will integrate Eq. (28) only along the undu-
z′)−1 in the phase factor
lator. Then all terms in (zo −
In the limit
of Eq.
Nwλw, we can usually retain ﬁrst order terms in z′:
zo ≫
later on, in Paragraph IV C, we will discuss the applica-
bility region of this approximation and we will see that
there are particular regions of parameters which do not
allow retention of ﬁrst order terms alone. Dropping negli-
gible terms and deﬁning φ and θ according to Fig. 11 (or
remembering the analogous deﬁnition given in Paragraph
III D) we obtain

(28) can be expanded around zo.

E⊥(zo, r⊥o, ω) =

e
sin (kwz

′

) + θ cos (φ)

iωe
c2zo Z

Nwλw /2

′

eiΦT

dz

−Nwλw /2
ˆx + θ sin (φ) ˆy
(cid:21)

.

(cid:19)

(112)

K
γ

×

(cid:20)(cid:18)

Here

ΦT =

′

kwz

ω
ω1 (cid:20)

Kθ cos(φ)
γ
ω1
kwc

−
K 2
8γ2

−

ω1
kwc

cos(kwz

′

)

sin(2kwz

+ Φs , (113)

′

)
(cid:21)

where Φs = ωθ2zo/(2c), as usual, and ω1 is deﬁned as

ω

−1
1 =

1
2kwcγ2

(cid:18)

K 2
2

(cid:19)

1 +

+ γ2θ2

.

(114)

FIG. 12: Undulator followed and preceded by bending mag-
nets and straight sections.
Information about the particle
trajectory before and after the undulator is necessary to cal-
culate the radiation spectrum.

Note that as ω = ω1, the formation length of our system
is simply given by Lf = 1/kw as it is seen immediately
from Eq. (113) imposing the ﬁrst term in phase to be
of order unity. Yet it should be stressed here that the
formation length Lf = 1/kw is obtained in the most gen-
eral case, without accounting for special conditions which
are very often chosen for undulator operation. In fact,
when a large number of undulator periods is selected an
extra large-parameter is introduced in the system yield-
ing simpliﬁcations within the theory; then, as it will be
clear after reading Paragraph IV B, if the so called res-
onance condition is met, the actual formation length of
Lw.
the system becomes Lf ∼
The choice of the integration limits in Eq. (112) ex-
press explicitly the fact that the reference system has its
origin in the center of the undulator as in Fig. 10. As said
before, Eq. (112) gives only a partial contribution to the
total ﬁeld, which must be summed up with terms arising
from structures preceding and following the undulator.
In [5], for instance, no particular attention is given to
this problem: the calculation of undulator radiation dis-
tribution is performed considering the acceleration term
of the Lienard-Wiechert ﬁelds alone, integrating by parts,
and dropping the edge term.

It is indeed very useful, at this point, to comment some
passage of [5]. At page 412 one can read: ”No assump-
tions on the magnetic ﬁeld parameters have been made
to derive the radiation spectrum in the form of equation
(7.87) which we use to calculate the radiation spectrum
from a wiggler magnet”. Eq. (7.87) in [5] is the radiation
spectrum from a particle moving on a generic trajectory
calculated, indeed, starting from the Lienard-Wiechert
ﬁeld expression for the acceleration ﬁeld, integrating by
parts and neglecting the edge terms; it obviously appears
in the form of an integration with limits from
:
∞
this is just our Eq. (52) that was derived exactly as Eq.
(7.87) in [5]. Dropping the velocity ﬁeld in the Lienard-
Wiechert expression is done under the suﬃcient (but not
necessary, in general!) condition that n can be considered

−∞

to

∞

−∞

and t′ = +

constant. This is regarded as the far ﬁeld approximation.
Then, neglecting of edge terms can be done under physi-
cal assumptions discussed much earlier in Paragraph II C.
Again, the integral in dt′ has to be performed over the
entire history of the particle; the physical meaning of
t′ =
is that at these times, the elec-
tron does not contribute to the ﬁeld anymore. From this
viewpoint, the geometry speciﬁed in Fig. 10 is no more
suﬃcient. One has to provide information about what
precedes and what follows the undulator; an example is
depicted in Fig. 12. In the case of the scheme in Fig.
12 for instance, t′ =
refer to moments
when the particle is well inside the ﬁrst and the second
bend, respectively, and do not contribute anymore to the
resulting radiation spectrum. In order to drop edge terms
in the particular case of the trajectory in Fig. 12, one has
to consider contributions from the ﬁrst bend, then from
A to B along the straight line, from B to C inside the
undulator, from C to D along the second straight line
and, ﬁnally, from the second bending magnet.

and t′ = +

−∞

∞

Instead of following this prescription, the author of [5]
substitutes characteristic quantities for a trajectory on
an inﬁnitely long undulator in Eq. (7.87), and then he
simply sets the undulator strength parameter K to zero
outside of a given temporal interval, which is simply the
physical time that an electron takes to pass through the
undulator. This is equivalent to consider two inﬁnite
straight lines before and after the end of the undulator.
Then, although results are correct in some particular case
(namely under resonant approximation, which we discuss
in Paragraph IV B) the reader is left with the unsolvable
task of understanding what is the physical meaning of
two inﬁnite straight lines and, especially, what is the con-
tribution of these inﬁnite parts of the trajectory to the
total electric ﬁeld at the observer position. Again, if one
wishes to drop the edge terms, one should start consid-
ering the entire trajectory of the electron, not a part of
it alone.

In the case depicted in Fig. 12 for instance, we will
have diﬀerent interfering contributions from the straight
lines before and after the undulator and we would end up
with both edge radiation and transition undulator radi-
ation. Again, in the most general case, Eq. (112) refers
to a part of the electric ﬁeld seen by the observer and it
should be added to other contributions corresponding to
the entire history of the particle. Only in particular sit-
uations like the one discussed in the following Paragraph
IV B calculation of radiation properties from Eq. (112)
alone makes sense: in Paragraph IV B we will discuss the
resonant approximation which can be used in the case of
1. Again, the
a large number of undulator periods, Nw ≫
presence of an extra large (or small) parameter yields to
further simpliﬁcations of the theory. However it should
be noted that, in practice, Nw ranges from a few units,
in the case of Far Infrared insertion devices to about one
thousand, for X-ray FELs, so that the applicability of
the resonant approximation strongly depends on the sit-
uation under study.

22

B. Resonant approximation

In general, it does not make sense to calculate the in-
tensity distribution from Eq. (112) alone, without extra
interfering terms. Yet, we can ﬁnd particular situations
for which the contribution from Eq. (112) is dominant
with respect to others. In this case, and only in this case,
Eq. (112), alone, is endowed with physical meaning.

The method proposed in [43] to calculate the integral in
Eq. (112) is very well-known and used by every textbook
treating the details of undulator radiation. Again, we will
follow notation in [5] during our derivation. The method
consists in using the identity

∞

eia sin(ψ) =

Jp(a)eipψ ,

(115)

p=−∞
X
where Jp indicates the Bessel function of the ﬁrst kind of
order p.

After introduction of

and

Q =

2Kβavγθ cos(φ)
1 + K 2/2 + γ2θ2

S =

K 2βav
4(1 + K 2/2 + γ2θ2)

(116)

(117)

one can express the exponential function in Eq. (112) as:

∞

∞

m=−∞
X

n=−∞
X

eiΦT =

where

Jm(u)Jn(v)eiπn/2e

−iRω kwz

′

(118)

u =

S , v =

Q , and Rω =

n

2m . (119)

ω
ω1

ω
ω1

ω
ω1 −

−

Then, Eq. (112) can be re-written in the more suggestive
form:

E⊥(zo, r⊥o, ω) =

Jm(u)Jn(v)

∞

iωe
c2zo

eiΦs

m,n=−∞
X
Nwλw/2

−Nwλw/2

Z

eiπn/2

×

′

′

dz

e

−iRω kwz

′

sin (kwz

) + θ cos (φ)

ˆx + θ sin (φ) ˆy
(cid:21)

(cid:19)

.

(120)

e

K
γ

×

(cid:20)(cid:18)

Performing the integral in Eq. (120) one gets:

E⊥ =

iωeλwNweiΦs
c2zo

∞

m,n=−∞
X

e

Jm(u)Jn(v)eiπn/2

sin(πNw(Rω −
1)
πNw(Rω −

−

(cid:19)

K
2γ

i

(cid:18)

×
1))

(cid:26)(cid:20)

+ θ cos (φ)

+θ sin (φ)

sin(πNw(Rω + 1))
πNw(Rω + 1)
sin(πNwRω)
πNwRω
sin(πNwRω)
πNwRω

(cid:21)
ˆy

ˆx

.

(cid:27)

(121)

As is well known, and can be seen by inspection, terms in
Eq. (121) exhibit resonant character. Maxima of diﬀer-
1 = 0.
ent terms are found as Rω = 0, Rω+1 = 0 and Rω−
These correspond to particular frequencies multiples of
the fundamental ω1. Always following [5] we introduce
the harmonic number k and we set ωk = kω1. Then,
after setting ∆ωk = ω
ωk, the following expression can
−
be obtained for the ﬁeld around frequency ωk:

∞

×

e
m=−∞ (cid:26)(cid:20)

X

E⊥,k =

iωeλwNweiΦs
c2zo

sin(πNw∆ωk/ω1)
πNw∆ωk/ω1

K
2γ

i

−

Jm(u)Jk−2m−1(v)eiπ(k−2m−1)/2
(cid:16)
Jm(u)Jk−2m+1(v)eiπ(k−2m+1)/2
+θ cos (φ) Jm(u)Jk−2m(v)eiπ(k−2m)/2
+θ sin (φ) Jm(u)Jk−2m(v)eiπ(k−2m)/2 ˆy
i
o

(cid:17)
ˆx

.

(122)

) represents the well-known resonant
The factor sin(
)/(
·
·
character of the device:
our electron produces ﬁeld
peaked at frequencies ωk only. ωk is a function of the
angle θ. Once an observation angle θ is ﬁxed, a resonant
frequency ωk(θ) is also deﬁned and the bandwidth of the
radiation is determined by ∆ωk(θ) through the resonant
factor sin(
). If we are interested in the angular width
)/(
·
·
of the peak around the observation angle θ, we can intro-
duce an angular displacement ∆θ with respect to θ. The
resonant frequency at angle θ + ∆θ, that is ωk(θ + ∆θ),
has a diﬀerent value with respect to ωk(θ). When ∆θ
becomes large enough, ωk(θ + ∆θ) gets outside the band-
width ∆ωk(θ). This happens for an angular displacement
∆θ such that

Nw(ωk(θ + ∆θ)

ωk(θ))/ω1(θ)

(123)

1

∼

−

which is the ﬁrst zero of the sin(
) function in Eq.
)/(
·
·
(122). If we are interested in the angular width of the
peak around θ = 0 in the case k = 1, that is for the
fundamental harmonic, we should solve the equation

Nw(ω1(∆θ)

ω1(0))/ω1(0) = 1

(124)

−

with respect to ∆θ. Eq. (124) should be taken only as
a rough indication of the angular width of the radiation
peak. In fact, taking the ﬁrst zero of the sin(
) func-
)/(
·
·
tion in Eq. (122) is just a convention: as we will see,

23

only through similarity techniques we will be able to de-
termine the natural angle which ﬁts with the physical
situation under study: θ can be compared in a natural
way only with that angle, and not with the solution of
Eq. (124). Yet, following textbooks and tradition we will
call with θc the solution in ∆θ of Eq. (124), and we will
refer to it as a rough indication of the angular width of
the radiation for the 1st harmonic. The cone with aper-
ture θc is usually called central cone.
It can be found
that (see [5])

θc =

1
√2Nwγz

(125)

1 + K 2/2. From the previous discussion
where γz = γ/
follows that Eq. (122) can be drastically simpliﬁed un-
p
der the approximation Nw ≫
1 and within the central
cone θ <
θc. In particular when k = 1, that is for the
∼
fundamental harmonic, we have

E⊥ =

KωeλwNweiΦs
c2zoγ

−

e

sin(πNw∆ω1/ω1)
πNw∆ω1/ω1
ωK 2
8kwcγ2

AJJ

×

(cid:18)

(cid:19)

ˆx . (126)

≪

Here we neglected all terms but the one proportional to
J1(u), and we have used the
Nw. Also, AJJ (u)
γ.
fact that K

J0(u)

≡

−

∼

∼

Note that at this point we are not able to specify the
accuracy of this approximation precisely: we can only say
that, when θ
θc, our accuracy scales as 1/Nw. This can
be seen showing that the third term in ˆx and the term
in ˆy in the series of Eq. (122) can be neglected with an
error
1/Nw. First we ﬁx k = 1, that is the fundamental
harmonic. Second we note, from Eq. (119), that for any
value of K and θ much smaller than 1/γz we have u of
order unity while v is much smaller than unity, so that
we can take it as a small parameter: then, the largest
contributions from the sum in Eq. (122) will be for the
smallest indexes of the Bessel functions J(v) because of
vq. It follows that
the asymptotic behavior of Jq(v)
the third term in ˆx and the term in ˆy in the series of
Eq. (122) are of magnitude θJ0(u)J1(v) or θJ1(u)J−1(v)
to be compared with the ﬁrst two terms in ˆx scaling as
K/(2γ)J0(u)J0(v) and K/(2γ)J1(u)J0(v).

∼

This situation refers to the case when trigonometric
functions in φ are of order unity, otherwise extra fac-
tors cos2(φ) or sin(φ) cos(φ) should be included as well.
Taking the trigonometric factors of order unity gives an
upper limit to the accuracy of our calculation and we will
always do this. Whatever the value of u, neglecting the
third term in ˆx and the term in ˆy in Eq. (122) can be
done with an accuracy given by the ratio

R =

θQ/2
K/(2γ)

= γ2

z θ2 .

(127)

∼

θc we obtain R

Then, when θ
1/Nw. Yet, as has
already been remarked, θc is not the natural angle to
which θ should be compared and as a result we cannot
specify numerical factors in front of the 1/Nw. Later we
will comment further on this point.

∼

Eq.

(126) is indeed well-known, but usually no at-
tention is paid to its deeper meaning. As we have said
before, it does not make sense to calculate the inten-
sity distribution from Eq.
(112) alone, without extra
interfering terms. Yet, we have told that, in particular
situations, the contribution from Eq. (112) is dominant
with respect to others and that in this case Eq. (112),
alone, is endowed with physical meaning. On the other
hand, we have seen that Eq. (112) simplify to Eq. (126)
1 and within the central cone θ <
θc.
if k = 1, Nw ≫
∼
θc such simpliﬁcation is valid within an
Again, when θ
∼
accuracy scaling with 1/Nw. By inspection of Eq. (126)
we see that, due to resonance, the only surviving term
scales with Nw. Any extra term added to Eq. (126) due
to non resonant devices like bending magnets or straight
lines will be simply negligible with respect the ﬁeld in Eq.
(126) with an accuracy scaling with 1/Nw. Note that Eq.
(126) is valid regardless the value of K (in particular, in
the limit for K
1 we have an extra small parameter,
≪
1 and Eq. (126) can be further simpli-
then AJJ (u)
ﬁed). This is the power of the resonant approximation.
We can show that the same result is achievable start-
ing with Eq. (28) and neglecting the gradient terms in
Eq. (28) (including, therefore, the entire ˆy-polarization
contribution) and also the constrained particle motion in
that part of the phase ΦT which follows from the Green’s
function, that can be found in the second term in Eq.
(29). In fact, with these prescriptions, Eq. (112) and Eq.
(113) reduce to

≃

ωeK
2γc2zo Z

Nwλw/2

−Nwλw/2

′

eiΦT

dz

′

eikw z

−ikw z

′

ˆx

e

−

(cid:16)

(cid:17)

(128)

E⊥ =

e

and

z′
2γ2
z c

+

θ2z′
2c −

1
βc

K 2
8γ2kw

ΦT = ω

(cid:20)

sin(2kwz

+ Φs .

′

)
(cid:21)

Eq. (128) can be rewritten as

E⊥ =

e

ωeK
2γc2zo Z
i
exp
(cid:20)

(cid:18)

−

Nwλw/2

−Nwλw/2

ω
2γ2
z c −

kw

′

dz

exp

i

ω
2γ2
z c

(cid:26)
′
z

(cid:20)
(cid:18)
exp

iω

(cid:19)

(cid:21)(cid:27)

K 2
8γ2kw

×

(cid:18)
(cid:20)
′
)
sin(2kwz
(cid:19)

(cid:19)

+ kw
θ2z′
2c −

′

z

(cid:21)
1
βc

+ Φs

ˆx

24

(131)

Introducing the detuning parameter C

C =

ω
2γ2
z c −

kw ,

Eq. (130) can be written as

E⊥ =

−

exp(2ikwz

e

′

)] exp

[1

×

−

exp

iω

×

1
βc

K 2
8γ2kw

−

Nwλw/2

′

dz

−Nwλw/2
ωθ2
2c

C +

′

z

ωeK
2γc2zo Z
i
(cid:20)
sin(2kwz

(cid:18)

(cid:19)
+ Φs

(cid:21)
ˆx (132)

′

)
(cid:21)

(cid:26)

(cid:20)
E⊥ has maximal magnitude when C +
Note that
ωθ2/2c = 0 because otherwise the integrand in Eq. (132)
starts displaying oscillatory behavior. For θ = 0 this
simply means C = 0. Condition

(cid:27)

e

C +

= 0

ωθ2
2c

(133)

is called the resonant condition.

With the help of Eq. (115), Eq. (132) can be trans-

formed to

E⊥ =

ωeK
2γc2zo

−

eiΦs

e

m=−∞
X
Nwλw /2

∞

ω
βc

Jm

−

(cid:18)

K 2
8γ2kw (cid:19)
)]

′

exp(2ikwz

′

dz

[1

−

×

Z
C +

−Nwλw /2
ωθ2
2c

exp

i

×

(cid:20)

(cid:18)

(cid:19)

(cid:21)

′

z

exp [2imkwz

′

] ˆx (134)

The only non-zero terms are for m = 0 and m =
that

−

1 so

E⊥ =

−

eiΦs AJJ

ωeK
2γc2zo
ωθ2
2c

Lw/2

×

Z

−Lw/2

′

dz

e
exp

i

C +

′

z

ˆx , (135)

(cid:20)

(cid:18)

(cid:19)

(cid:21)

where the argument of AJJ is implied. Eq. (135) can be
integrated leading to

(129)

E⊥ =

KωeLweiΦs
c2zoγ

sin[CLw/2 + ωLwθ2/(4c)]
CLw/2 + ωLwθ2/(4c)

−

AJJ ˆx .

e
Eq. (136) is equivalent to Eq. (126). This can be seen
noting that the argument in the resonant term can be
written as

(136)

(cid:21)

. (130)

πNw

∆ω1(θ)
ω1(θ)

= πNw

(cid:20)

ω

ω1(0)

−
ω1(0)

+

ωθ2
2kwc

(cid:21)

LwC
2

+

ωLwθ2
4c

=

(cid:20)

(cid:21)

, (137)

as it can be readily shown. The previous result can be
cast in a more compact way, suitable for further manip-
ulations, using the following normalized quantities

them, which are completely neglected in textbooks. Our
method helped to clarify these assumptions. Now, after
this step, Eq. (140) and Eq. (141) constitute the starting
point for further manipulations: the investigation of the
near-ﬁeld eﬀects treated in the next Paragraph, and the
derivation of the ﬁeld in case of an electron with oﬀset
and deﬂection, treated in Paragraph IV D.

25

ˆE⊥ =

c2zoγ ˜E⊥
KωeLwAJJ

,
−
ˆC = LwC = 2πNw∆ω1/ω1 ,

ˆθ = θ

,

ωLw
c
z
Lw

r
ˆz =

. (138)

As remarked before, introduction of similarity techniques
involves recognition of natural quantities which enter in
the normalization of equations in one possible way only
and ﬁt with the physical nature of the problem. For
instance, after the introduction of the normalized an-
gle ˆθ we can say that θ is to be compared, naturally,
with the angle [c/(ωLw)]1/2 and not with θc. When
θ
(127) gives, naturally, the nu-
merical factor in front of 1/Nw that we were not able to
specify before. In particular, substitution in Eq. (127)
gives the following accuracy for our calculations:

[c/(ωLw)]1/2, Eq.

∼

R =

1
4πNw

.

(139)

Using Eq. (138), Eq. (135) and Eq. (136) can be written
respectively as

ˆE⊥ = eiΦs

′
dˆz

exp

1/2

−1/2

Z

ˆC +

i
"

 

ˆθ2
2 !

′

z

#

(140)

and

ˆE⊥ = eiΦs sin[ ˆC/2 + ˆθ2/4]
ˆC/2 + ˆθ2/4

,

(141)

≪

1, 4πNw ≫

4πNw. Note that for ˆC + ˆθ2/2 <
∼

1, and
which are valid in the limit for ˆz
≫
ˆC + ˆθ2/2
4πNw. The last relation comes from the
fact that we are interested in the fundamental harmonic
1; use of Eq. (137) gives
of our device; then ∆ω1/ω1 ≪
then ˆC + ˆθ2/2
1,
≪
that is near resonance, the formation length of the system
Lw, as one can readily see imposing that
becomes Lf ∼
the phase of the integrand in Eq. (141) be of order unity.
(140) and Eq.
(141) are well known in literature (at least in their di-
mensional form), our discussion is far from being a mere
repetition of textbook material. In fact we put particu-
lar attention to the assumptions used in order to obtain

As already remarked, although Eq.

C. Near-ﬁeld eﬀects

As it has just been said, Eq. (141) is derived under

1, and ˆC + ˆθ2/2

several assumptions: ˆzo ≫
≪
1 and we
4πNw. Here we will relax the condition ˆzo ≫
will treat near ﬁeld eﬀects, showing how we can control
the accuracy of calculations using our method.

1, 4πNw ≫

We start considering the near ﬁeld region, where ˆzo >
∼
1/2. In practice, the ﬁeld at the very end of the undulator
is not interesting because detectors are, in practice, never
put at ˆzo = 1/2. Therefore in practical situation we will
be always interested in situation where ˆzo >
2.
∼
In this region, suitable for our investigations, the assump-
1, and the resonant approximation are still
tion 4πNw ≫
retained valid, and allow substantial simpliﬁcation of the
equation for the ﬁeld at the fundamental harmonic, much
like Eq. (141) is a simpliﬁcation of Eq. (122). Using the
same line of reasoning in the last Paragraph, but without
ˆz′)−1 around ˆzo, we obtain
expanding expressions (ˆzo −
the following simpliﬁed expression for the ﬁeld, that is

1 or ˆzo >
∼

ˆE⊥ = ˆzo

Z
+

′

ˆCz

(cid:20)

(cid:18)
introduced

ˆz′

1/2

′
dˆz

1
ˆzo −
−1/2
o + ˆy2
ˆx2
o
ˆz′)
2(ˆzo −
(cid:19)(cid:21)
normalized

exp

i

×

. (142)

ˆxo

=
units
Here we
xo[ω/(Lwc)]1/2 and ˆyo = yo[ω/(Lwc)]1/2.
These
deﬁnitions for normalized units, together with the ones
given in (138), are naturally dictated by the system itself,
through the non-normalized equations which describe
In particular, ˆxo and ˆyo can be derived from the
it.
deﬁnitions of ˆθ and ˆz in (138). Using normalized units
allows one to compare each physical quantity with its
natural measure and has the advantage of reducing the
number of parameters that the system depends on to the
few ﬁtting the physical characteristics of the problem.
Note that because of the resonant approximation, the
phase factor in Eq. (142) is much smaller than 4πNw.

Eq. (142) is valid for any value of ˆzo with an accuracy
1/(4πNw). We may wish to push analytical investiga-
in fact we have now full control over the
tions further:
ˆz′)−1, meaning that we can decide
expansion of (ˆzo −
when to truncate the series

′
ˆz

−1 =
)

(ˆzo −

1
ˆzo

∞

n=0 (cid:18)
X

n

ˆz′
ˆzo (cid:19)

(143)

26

(149)

both in the ﬁrst factor and in the exponential factor of
Eq. (142).

Neglecting terms of order higher than n = m in the
expansion of the ﬁrst factor in Eq. (142) can be done
with an accuracy better than (ˆz′/ˆzo)m+1
1/(ˆzo)m+1 so
that, with this accuracy, we have

∼

and

¯W =

ˆθ2
2ˆzo

m

1/2

ˆz

′n

′
dˆz

ˆE⊥ =

1
ˆzn
−1/2
o Z
ˆx2
o + ˆy2
o
ˆz′)
2(ˆzo −
Now we should study the exponential factor. Let us keep
orders up to l = j:

n=0
X
′
ˆCz

(144)

exp

(cid:19)(cid:21)

+

×

(cid:18)

(cid:20)

i

j

l

=

ˆθ2 ˆzo
2

ˆz′
ˆzo (cid:19)

(145)

o/ˆz2

+ O(ˆz

′j+1) ,

o + ˆy2

Xl=0 (cid:18)
o/ˆz2

o + ˆy2
ˆx2
o
ˆz′)
2(ˆzo −
where ˆθ2 = ˆx2
o. The ﬁrst term to be ne-
glect will give a contribution to the integrand equal to
exp[iˆθ2 ˆz′j+1/(2ˆzj
ˆθ2/2 < 1, this expo-
nential contribution can be expanded too, and the domi-
nant term in the expansion, after unity, will be just of or-
der ˆθ2/(2ˆzj
o). Neglecting this term can therefore be done
with an accuracy (ˆzo)−j
ˆθ2/2. If we impose that this
accuracy be of order 1/(ˆzo)m+1, we have automatically
that (ˆzo)−j

ˆθ2/2 < 1 and we ﬁnd the useful condition

o)]. Now, if (ˆzo)−j

·

·

·

ˆθ2
2 ∼

(zo)j−m−1 .

(146)

·

This can be used to retain important terms: for instance,
given a maximal observation angle of interest and an ac-
curacy to be reached, for a certain setup, we ﬁnd j such
that (ˆzo)−j
ˆθ2/2 is the desired accuracy; then we ﬁnd
m such that Eq. (146) is satisﬁed. To give a numeri-
1 and we
cal example, if we choose ˆzo ≃
want to get our result with an accuracy of about 4% we
can put j = 2; of course we should compare this 4% ac-
curacy with the accuracy of the resonant approximation
1/(4πNw), which is usually about 1% or smaller. Then,
solving Eq. (146) for m we ﬁnd m = 1. Note that expan-
sions up to m = 1 and j = 2 are easy to solve analytically.
One obtains the following result:

5 and ˆθ2/2

≃

ˆE⊥ = eiΦs

1/2

′
dˆz

exp

i

′

¯U z

′2
+ ¯W ˆz

−1/2

× (Z

1/2

+

1
ˆzo Z

−1/2

′
dˆz

′
ˆz

exp

(cid:2)
i

(cid:0)
¯U z

′

′2
+ ¯W ˆz

(147)

(cid:1)(cid:3)

)

(cid:1)(cid:3)

where

(cid:2)

(cid:0)

¯U = ˆC +

ˆθ2
2

.

(148)

where

and

×

−
(cid:2)

The parameter ¯W is closely related to the near ﬁeld pa-
rameter W = L2
wθ2/(2λzo) introduced in [44]. In fact,
once translated in dimensional units, ¯W = 2πW . We are
therefore able to reproduce the results in [44], but this
time accounting, thanks to our approach, for accuracy
and applicability region of the approximations.

The integrals in Eq. (147) can be calculated analyti-

cally leading to

ˆE⊥ = eiΦs

B1 +

(cid:20)

B2
ˆzo (cid:21)

(150)

B1 =

√π(1 + i)
2√2 ¯W (cid:20)

erf

(cid:18)

e3iπ/4( ¯U + ¯W )
2√ ¯W

erf

−

(cid:18)

e3iπ/4( ¯U

¯W )

−
2√ ¯W

exp

i

(151)

(cid:19)(cid:21)

(cid:20)

(cid:19)

¯U 2
4 ¯W

(cid:21)

B2 =

1
8 ¯W 3/2

4i exp

i

−
(cid:20)
+ (1 + i) ¯U exp

(cid:26)

1 + exp(i ¯U )

(cid:3)

×
(cid:20)
e3iπ/4( ¯U + ¯W )
2√ ¯W

erf

−

(cid:19)(cid:21)(cid:27)

+erf

(cid:18)

2 ¯U 2 + ¯W 2
4 ¯W
¯U + 2 ¯W
4 ¯W
e3iπ/4( ¯U

i ¯U
(cid:20)

¯W

(cid:21) p

√2π

(cid:21)
¯W )

(cid:18)

exp

−
2√ ¯W
¯U

¯U + ¯W
2 ¯W

(cid:0)

(cid:19)

#

(cid:1)

i
"

(152)

It might be remarked that the erf function can be rep-
resented in terms of Fresnel functions which were used
in presentation of results in [44]. For the sake of com-
2 as
parison with [44] it may be interesting to plot
a function of ˆθ. When terms in B2 are negligible this
represents, in normalized units, the intensity in the near
5,
ﬁeld. This is the case, for instance, if we choose ˆzo ≃
ˆθ2/2
1 and we want to get our result with an accuracy
of about 20%: then we may set j = 2 and m = 0. Results
are plotted in Fig. (13) and in Fig. (14) as intensity as
a function of ¯U for diﬀerent values of ¯W .

B1 |

≃

|

The understanding of the region of applicability in-
volved in the derivation of Eq. (150) allows us to make
interesting remarks. For instance, note that for any given
negative value of the detuning parameter ˆC there is a
value of ˆθ such that ¯U = 0. This means that even when
40, for example, the value ˆθ2/2 = 40 is such that
ˆC =
¯U = 0 and the contribution of the near ﬁeld ¯W is dom-
inant. In this case, even choosing ˆzo = 40, ¯W = 1 and

−

27

-
U

-
U

0.4

0.3

0.2

0.1

1

0.8

0.6

0.4

0.2

0.08

0.06

0.04

0.02

0.175

0.15

0.125

0.1

0.075

0.05

0.025

|B1 |2  (A.U.)

|B1 |2  (A.U.)

-
W/(2 p

p )=8

-
W/(2 p

p )=2 

-60

-40

-20

20

40

60

-60

-40

-20

20

40

60

|B1 |2 (A.U.)

|B1 |2 (A.U.)

-
W/(2 p

p )=4 

-
W/(2 p

p )=0 

-
U

-
U

-60

-40

-20

20

40

60

-60

-40

-20

20

40

60

FIG. 13:
Intensity, in arbitrary units, from the term B1, as a
function of ¯U for ¯W /(2π) = 8 (upper plot) and for ¯W /(2π) =
4 (lower plot).

FIG. 14: Intensity, in arbitrary units, from the term B1, as a
function of ¯U for ¯W /(2π) = 2 (upper plot) and for ¯W /(2π) =
0 (lower plot).

letting m = 0 and j = 2, the term in ¯W is the only
contribution up to an accuracy of 5% (note that this is
consistent with Eq. (146), which gives a maximal angle
ˆθ2/2
40. This is a very particular region of parameters,
where the electric ﬁeld depends on the near ﬁeld param-
eter ¯W even though ˆzo ≫
1. In this particular situation
we can write

∼

ˆE⊥ =

eiΦs √π(1 + i)

erf

−

√2 ¯W

e3iπ/4√ ¯W
2

"

#

.

(153)

D. Electron motion with oﬀset and deﬂection

The same remark given in Paragraph III B for electrons
on a circular trajectory is valid here for particles in an
undulator: the nominal trajectory is just an approxima-
tion. Electron beams have always some ﬁnite geomet-
rical emittance and they can be thought, in agreement
with paraxial treatment, as a composition of perfectly

collimated beams with diﬀerent deﬂection angles with
respect to the orbital plane of the nominal trajectory.
As remarked in Paragraph III B, this representation will
be of great importance in the calculation of complicated
quantities like the ﬁeld autocorrelation function, which
is of uttermost importance in the characterization of the
statistical properties of a light source. Let us now dis-
E from a single particle moving
cuss how to calculate
in an undulator with a given angular deﬂection and oﬀ-
set with respect to the orbital plane of a nominal elec-
tron. Once we answer this question for a single particle,
we can add up contributions from diﬀerent electrons the
way we want, in perfect symmetry with Paragraph III B.
Let us introduce electron deﬂection angles ηx and ηy and
displacements lx and ly. The particle velocity will be
characterized, as a function of z′, as

e

′

v⊥(z

) =

sin (kwz

) + ηxvz

x + [ηyvz] y , (154)

′

(cid:21)

cK
γ

−

(cid:20)

so that

p
p
p
p
p
p
p
p
28

(162)

(163)

(164)

(165)

In the limit when ˆlx,y/ˆzo ≪
Eq. (160) thus getting:

1, one can simplify further

r′
⊥(z

′

) =

(cos (kwz

′

)

K
γkw

(cid:20)

−

1) + ηxz
′

+ [ηyz

′

+ lx

x

(cid:21)

+ ly] y . (155)

Using

one has

where

′

s(z

) =

z

′

dz

1/2

2

1 +

"

(cid:18)
1
2

1 +

"

dx′
dz′

2

+

dy′
dz′

(cid:19)
dx′
dz′

(cid:18)
2

+

(cid:18)

(cid:19)

#
dy′
dz′

(cid:19)

(cid:18)

1
2

≃
2

#

(cid:19)

0
Z

0
Z

z

′

dz

(156)

and

ˆE⊥ = eiΦs eiΦo sin ζ
ζ

,

Φs =

x + ˆθ2
ˆθ2
(cid:16)

y

(cid:17)

ˆzo ,

Φo =

ˆθxˆlx −

−

ˆθyˆly ,

′

s(z

) =

β
βav

 

K 2
8γ2kw

−

+

′

x + η2
η2
y
2 !
Kηx
γkw

′

z

−

Kηx
kwγ

sin (2kwz

) +

cos (kwz

) . (157)

′

1,
We will now work under the approximations: ˆzo ≫
1 and we are interested in the fundamental
4πNw ≫
harmonic of our device. We can use a procedure analo-
gous to the one used in Paragraph IV B (and Paragraph
IV C) to get the following simpliﬁed expression for the
ﬁeld in normalized units in resonant approximation:

ˆE⊥ = eiΦU

′
dˆz

exp

′
iˆz

ˆC

1/2

+

1
2  

ˆθx −

ˆlx
ˆzo −

ˆηx

+

!

1
2  

2

−1/2
ˆly
ˆzo −

Z
ˆθy −

ˆηy

 

"
2

!

!#

,

(158)

where

ΦU =



 



ˆθx −

2

ˆlx
ˆzo !

+

ˆθy −

 

2

ˆly
ˆzo !

ˆzo
2





(159)

The same normalization for θ holds also for ηx,y.
(158) is given by the ratio of
The accuracy of Eq.
ˆθy −
ˆlx/ˆzo −
ˆθx −
ˆC + 1/2
ˆηx
+ 1/2
ˆlx,y/ˆzo −
1 and (ˆθx,y −
4πNw. When ˆC <
(cid:17)
(cid:16)
(cid:17)
(cid:16)
1 the
∼
accuracy is just
1/(4πNw). Finally, Eq. (158) can be
∼
integrated giving

ˆly/ˆzo −
ˆηy
ˆηx,y)2 <
∼

to

2

2

ζ =

+

ˆC
2

1
4

ˆηx

ˆθx −
(cid:16)

(cid:17)

2

+

1
4

ˆθy −

ˆηy

(cid:16)

(cid:17)

2

.

The same remarks given for Eq. (79) hold for Eq. (160),
and we will repeat them here, since we consider them
of great importance. Eq. (160) is an extremely useful
tool, because it describes the radiation from an electron
with oﬀset and deﬂection as in an electron beam with
ﬁnite emittance, including the correct phase factor for
the ﬁeld. Eq. (79) was derived here from ﬁrst principles.
An alternative derivation based on the intuitive picture
that the undulator radiation can be approximated as a
sum of spherical waves emitted at the entrance of each
pole is given in [47]. Accounting for correct phase means
that contributions from diﬀerent electrons can be sim-
ply added up to give the ﬁeld from a beam with given
emittance at any observer position. Starting from Eq.
(160) then, it is possible to calculate the ﬁeld correlation
function, and to provide a study of transverse coherence
properties of the radiation from a given electron beam by
means of analytical techniques. Again, in perfect anal-
ogy with what has been remarked in Paragraph III B, a
numerical code can always be developed, either starting
from Eq. (28) or just from the Lienard-Wiechert ﬁelds,
which calculates the ﬁeld correlation function in a generic
case, but such a code would not help in physical under-
standing of the situation. On the contrary, Eq. (160)
includes all relevant information about an electron in a
realistic beam (i.e. with oﬀset and deﬂection) and, be-
ing an analytically manageable expression, constitutes a
ﬁrst step towards the more ambitious goal of characteri-
zation of transverse coherence properties from undulator
radiation, which we leave for future work.

ˆE⊥ = eiΦU sin ζ
ζ

,

(160)

E. The eﬀects of electron beam emittance on the
basic characteristics of undulator radiation

where ΦU is given in Eq. (159), while

ζ =

+

ˆC
2

1
4  

ˆθx −

ˆlx
ˆzo −

ˆηx

+

!

1
4  

ˆθy −

ˆly
ˆzo −

2

2

.

ˆηy

!

(161)

In the next Section V, we will make use of Eq. (160)
to calculate radiation from a complex system: we will
demonstrate in this way the power and the practical con-
venience of our computational method.
In this Para-
graph instead, we will study in detail how to apply Eq.

29

(160) to calculate angular distribution and frequency
spectrum of radiation produced by an electron beam in
a standard undulator when electron beam emittance is
present. We restrict our attention to the asymptotic case
of a large horizontal and a small vertical emittance. This
limiting situation is, in fact, of great practical interest
for today’s third generation light sources and it will be
discussed here in order to illustrate the eﬀectiveness of
similarity techniques.

First we assume that we can use Eq. (162) in place
of Eq. (160). Indicating with βox,y the minimal values
of the betatron function in the x and y directions and
with hx,y(ηx,y) the angular distributions of the particles,
again with respect to horizontal and vertical directions
we have

Intensity

1,0

0,8

0,6

0,4

0,2

0,0

-30

-25

-20

-15

-10

-5

0

5

10

15

^
^C+q 2

y/2

hx,y(ηx,y) =

Np
√2πσx′,y′

exp

η2
x,y
2σ2

 −

x′,y′ !

,

(166)

where σ2

x′,y′ = εx,y/βox,y. Upon introduction of

FIG. 15: Solid line : relative intensity ˆ¯I from a beam in the
limit ˆεx → ∞, ˆεy → 0. The intensity is plotted as a function
of ˆC + ˆθ2
y/2. Dashed line : single particle intensity ˆI as a
function of ˆC + ˆθ2

y/2 for θx = 0

−1
ˆβo = L
w βo ,
ˆε = (ω/c)ε ,

(167)

where we neglected all indexes in x, y, x′ and y′ for nota-
tional simplicity, Eq. (166) can be rewritten as a function
of normalized quantities as

h(ˆη) =

1
2πˆε/ ˆβo

exp

ˆη2 ˆβo
2ˆε !

,

 −

(168)

q
1. When ˆβoy ∼
We will treat the limiting case ˆεy/ ˆβoy ≪
1 as it usually is the case, this is simply a condition on
the normalized emittance ˆεy ≪
In this particular case, the particle density distribution
in the vertical phase space behaves like a δ-distribution.
Then, the beam intensity is simply given by

1.

Eq. (170) simpliﬁes further in the limit ˆεx/ ˆβox ≫
1.
Also in this case, when ˆβox ∼
1 as it is usually veriﬁed,
this is a condition on the normalized emittance ˆεx ≫
1.
In this limiting situation, the function sin2 ζ/ζ2 in Eq.
(170) behaves as the δ-distribution δ(ˆθx −
ˆηx) when com-
pared with the exponential function, so that Eq. (170)
can be simpliﬁed as

exp

ˆIb =

ˆθ2
x

ˆβox/(2ˆεx)
i

−
h
2πˆεx/ ˆβox

∞

−∞

Z

dˆηx

sin2 ζ
ζ2

(172)

q

Now we can introduce the relative intensity

3√2ˆεx

ˆ¯I =

exp

8

ˆβox "

q

ˆβox
ˆθ2
x
2ˆεx !#

 −

−1

ˆIb

(173)

Ib =

Npc
4π√2πσx′

∞

−∞

Z

dηx|

˜E⊥

2 exp
|

η2
x
2σ2
x′

(cid:19)

−

(cid:18)

.

(169)

so that

or, in normalized units

ˆIb =

1

2πˆεx/ ˆβox Z

−∞

∞

dˆηx

sin2 ζ
ζ2

exp

ˆβox
ˆη2
x
2ˆεx !

,

 −

q

where

ˆIb =

4π
Npc

c2zoγ
KωeLwAJJ (cid:19)

(cid:18)

2

Ib

ˆ¯I =

3
8√π

∞

−∞

Z

dˆηx

sin2 ζ
ζ2

,

(174)

and according to our approximations

ζ =

+

ˆC
2

1
4

ˆθx −

ˆηx

2

+

ˆθ2
y
4

.

(175)

(cid:16)
With an obvious change of integration variable ˆηx →

(cid:17)

ˆθx −

(170)

(171)

-30

-25

-20

-15

-10

-5

0

5

10

15

^
^C+q 2

y/2

-10

-8

-6

-4

-2

0

2

4

6

8

10

^
q y

FIG. 16: Solid line : approximation of ˆ¯I using Eq. (178).
Dashed line : relative intensity ˆ¯I from a beam in the limit
ˆεx → ∞, ˆεy → 0. The intensity is plotted as a function of
ˆC + ˆθ2

y/2, as the solid line in Fig. 15.

FIG. 18: Relative intensity ˆ¯I from a beam in the limit ˆεx →
∞, ˆεy → 0. The intensity is plotted as a function of ˆθy for
diﬀerent values of ˆC. The symbol C in the ﬁgure legend
should be read as ˆC ≥ 0.

30

 C = 0
 C = 1
 C = 2
 C = 3
 C = 4
 C = 5

 C =  0
 C = -1
 C = -2
 C = -3
 C = -4
 C = -5

-^
 I

 

1,0

0,9

0,8

0,7

0,6

0,5

0,4

0,3

0,2

0,1

0,0

-^
 I

 

1,2

1,1

1,0

0,9

0,8

0,7

0,6

0,5

0,4

0,3

0,2

0,1

0,0

Intensity

1,0

0,8

0,6

0,4

0,2

0,0

Intensity
1,0

0,8

0,6

0,4

0,2

0,0

-10

-8

-6

-4

-2

0

2

4

6

8

10

^q y

-10

-8

-6

-4

-2

0

2

4

6

8

10

^
q y

FIG. 17: Solid line : relative intensity ˆ¯I from a beam in the
limit ˆεx → ∞, ˆεy → 0. The intensity is plotted as a function
of ˆθy for ˆC = 0. Dashed line : single particle intensity ˆI as a
function of ˆθ2

y for θx = 0 and ˆC = 0

FIG. 19: Relative intensity ˆ¯I from a beam in the limit ˆεx →
∞, ˆεy → 0. The intensity is plotted as a function of ˆθy for
diﬀerent values of ˆC ≤ 0. The symbol C in the ﬁgure legend
should be read as ˆC.

ˆηx we ﬁnally obtain

ˆ¯I =

3
8√π

∞

−∞

Z

dˆηx

sin2

ˆC/2 + ˆθ2

y/4

+ ˆη2

h(cid:16)
ˆC/2 + ˆθ2

y/4

(cid:17)
+ ˆη2

h(cid:16)

(cid:17)

x/4
i
2

x/4
i

, (176)

It is now evident that similarity techniques we used are
not only a theoretical tool: in fact ˆ¯I is a universal func-
tion of ˆC + ˆθ2
y/2 and Eq. (176) can be integrated with the

help of simple numerical techniques to get the universal
plot in Fig. 15 (solid line). This universal plot is com-
pared, always in Fig. 15 (dashed line), with the relative
intensity in the case when also ˆεx/ ˆβox ≪
1. In this case
we simply have the single particle intensity

ˆI =

y/4 + ˆθ2

sin2

ˆC/2 + ˆθ2
h

ˆC/2 + ˆθ2
h

y/4 + ˆθ2

x/4
i

x/4
i
2

.

(177)

The dashed line in Fig. 15 refers to the case ˆθx = 0;

note the diﬀerent normalization factor between ˆ¯I and ˆI.
It may be useful to provide a ﬁt of the universal plot in
Fig. 15 using the following function:

Intensity

31

 1
 2
 3
 4
 5

^
C

 1
 2
 3
 4
 5

1,0

0,8

0,6

0,4

0,2

0,0

1,0

0,8

0,6

0,4

0,2

0,0

Intensity

1

4,5

^
=0
y
^
=0
x

2,3

-20

-16

-12

-8

-4

0

4

8

12

16

20

FIG. 20: Plots of relative intensities ˆ¯I as a function of ˆC for
ˆθx = 0 and ˆθy = 0. Here ˆβox = ˆβoy = 1.0. Curve 1 : relative
intensity ˆ¯I from a beam in the limit ˆεx → ∞, ˆεy → 0, as
in Fig. 15. Curve 2 : relative intensity from a beam with
ˆεx = 40, ˆεy = 1. Curve 3 : relative intensity from a beam
with ˆεx = 40, ˆεy → 0. Curve 4 : relative intensity from a
beam with ˆεx = 80, ˆεy → 0. Curve 5 : relative intensity from
a beam with ˆεx = 80, ˆεy = 1.

2,5

^
C=0
^
=0
x

1,3,4

-10

-8

-6

-4

-2

0

2

4

6

8

10

^
y

FIG. 21: Plots of relative intensities ˆ¯I as a function of ˆθy for
ˆθx = 0 and ˆC = 0. Here ˆβox = ˆβoy = 1.0. Curve 1 : relative
intensity ˆ¯I from a beam in the limit ˆεx → ∞, ˆεy → 0, as
in Fig. 17. Curve 2 : relative intensity from a beam with
ˆεx = 40, ˆεy = 1. Curve 3 : relative intensity from a beam
with ˆεx = 40, ˆεy → 0. Curve 4 : relative intensity from a
beam with ˆεx = 80, ˆεy → 0. Curve 5 : relative intensity from
a beam with ˆεx = 80, ˆεy = 1.

H(ξ) = 



A exp

2

(ξ−ξ1)
2ξ2
2

i

−
h
B exp[ξ/ξ3]
√−ξ/ξ3

ξ > ξ0 , ξ0 < 0

.

ξ < ξ0 < 0

≃

1.7, ξ2 ≃

0.24, ξ1 ≃

(178)
Fitting for A, B, ξ1, ξ2 and ξ3 and using, for instance,
a reasonable value for ξ0 =
5.7,
≃
103 which re-
B
sult in the solid curve in Fig. 16, the dashed curve being
a comparison with the real universal function plotted in
Fig. 15. It should be noted that H(ξ) has no particu-
lar physical sense: it simply gives an analytical approx-
imation for the universal plot in Fig. 15 with graphical
accuracy shown in Fig. 16.

3.00 we ﬁnd A
1.4

−
2.8 and ξ3 ≃

·

−

After Fig. 15 is tabulated, one can plot the intensity
as a function of ˆθy for given values of ˆC simply solving
y/2 = X for ˆθy, X being any of the tabulated
ˆC + ˆθ2
ˆC > 0. By ﬁxing ˆC = 0
abscissas with constraint X
we obtain the universal plot in Fig. 17 (solid line). This
universal plot is compared, always in Fig. 17 (dashed
line), with the normalized intensity as a function of ˆθy
in the case when also ˆεx/ ˆβox ≪
1. The dashed line in
Fig. 17 refers to the case ˆθx = 0; again, note the diﬀerent
normalization factor between ˆ¯I and ˆI. Note that, for this
case, Eq. (177) calculated for ˆC = 0 already constitutes
a relatively good approximation for the plot in Fig. 17.
Letting ˆC vary we obtain universal plots of the inten-
sity parameterized with respect to ˆC; we show some of
them in Fig. 18 and Fig. 19 with respect to ˆC
0 and
ˆC

≤
Finally, with the help of a Monte Carlo simulation de-
scribed in more detail in the following Section V, we com-
pared our results with the case of a beam with diﬀerent
values of ˆεx and ˆεy, always assuming ˆβox = ˆβoy = 1.0
and no energy spread is present. Note that in general,
the spectrum (at ˆθx,y = 0) or the angular intensity (at
ˆC = 0, θx = 0) is a function of two parameters: ˆǫx/ ˆβox
and ˆǫy/ ˆβoy. Results are shown in Fig. 20 and Fig. 21,
where relative intensities are plotted as a function of ˆC
for ˆθx = 0 and ˆθy = 0 and as a function of ˆθy for ˆC = 0
and ˆθx = 0, respectively. Fig. 20 and Fig. 21 illustrate
the accuracy of the asymptotic limit Eq. (176).

0.

≥

V.

SET OF TWO UNDULATORS WITH A

FOCUSING TRIPLET IN BETWEEN

In this Section we use our understanding of approxima-
tions and region of applicability discussed before to deal
with a diﬃcult setup constituted by two or more undula-
tor segments separated by strong focusing quadrupoles.

q
q
q
q
Focusing elements

Screen

x

zo

Undulator I

Undulator II

Lw/2

y

Ls

Lw/2

z

FIG. 22: Undulator system geometry: two undulator seg-
ments are separated by strong focusing quadrupoles.

In this Section, and in Fig. 22, we consider the particular
case of two undulator segments separated by a focusing
triplet.

This scheme is known as segmented undulator scheme.
Insertion devices at PETRA III are due to work ac-
cording to an on top injection scheme and must therefore
be compatible with injection of new particles during op-
eration. In general, injection operations require a larger
beam acceptance with respect to an already circulating
beam and this poses a strict limit to a safe choice of the
length of the insertion devices.

Since no focusing element is present inside the undu-
lator the βT function increases quadratically with the
distance from the minimal value in the middle of the un-
dulator. In practice, then, the maximal length of the in-
sertion device is also ﬁxed and one has the rule of thumb
βT . Here we can safely talk about the vertical di-
Lw ∼
rection only, because the vertical βT function is also the
shortest.

In principle, given a certain acceptance εacc, it is pos-
sible to increase the βT -function by increasing the un-
σ2
gapεacc. However, the
dulator gap according to βT ∼
particle energy and the radiation wavelength are nearly
ﬁxed at PETRA III. Moreover restrictions related with
the number of photons required and with operation of
third harmonic scheme apply, which allow only values of
K around unity. Then, λw is ﬁxed as well as the mag-
netic ﬁeld on axis and, as a result, the undulator gap too.
This means that an upper limit on the βT function and
therefore to the insertion device length Lw is also ﬁxed.
In practical situation, when enough experience with
the machine, safety margins might be bent. For in-
stance a single 25 m-long in vacuum undulator oper-
ates at SPring-8 in on top injection mode with a vertical
10 m. However, safety limits indicate, for a ﬁrst
βT ≃
design, much more stringent constraints.

For a ﬁrst conservative design, the segmented undu-
lator scheme constitutes a reliable alternative for ﬁlling
the ﬁrst straight section at the new arc of PETRA III,
which can accommodate a 20 m long insertion device.
Breaking a long insertion device in several parts allows
one to ”keep the average vertical βT -function rather small
which in turn is essential to allow for a small geometri-
cal vertical aperture and magnetic gap” (cited from [11],

32

Section 4.1.8). ”The maximal vertical β-function along
this undulator will be about 10 m. Therefore a vertical
inner size of 9.5 mm is necessary for the corresponding
chambers” (cited from [11], Section 3.2.1).

With this motivation in mind we start our investiga-
tion. We are interested in computing the radiation in-
tensity seen by an observer at angles ˆθx and ˆθy. We will
be interested in both angular and spectral intensity dis-
tribution. Although it is possible to take advantage of
the analysis performed in Paragraph IV C and treat near
ﬁeld eﬀect, in this paper we will restrict our attention to
the far ﬁeld limit. Then we will compare our results with
the case of an uniform undulator.

Of course radiation intensity can be obtained, numeri-
cally, from the Lienard-Wiechert expressions for the elec-
tromagnetic ﬁeld without approximations of any kind.
The previous statement though, sounds like declaring
that solution to all electromagnetic problems can be
found solving Maxwell’s equation: it is undoubtedly true,
but quite generic. The most general expressions for the
Lienard-Wiechert ﬁeld can be used, and have been used
(again, see [27] and [28] for instance) as a basis for numer-
ical codes, but understanding of correct approximations
and their region of applicability can simplify many tasks
a lot, including practical and non-trivial ones like the one
we are going to study here. Instead of relying on compu-
tational power we propose a simple technique for dealing
with the segmented undulator scheme which minimizes
numerical diﬃculties and computation time and can be
implemented straightforwardly also by non-expert pro-
grammers. In order to reach this result we will use our
understanding of approximations in undulator radiation
theory, thus simplifying equations as much as possible
before using, in the ﬁnal step, some numerical integra-
tion technique. It is worthwhile to stress the fact that
we will have full control of our approximations at every
step, meaning that we will be able to get the radiation
intensity and the accuracy with which this is computed
as well.

We will consider the undulators tuned at the funda-
mental frequency. Therefore we start reminding the res-
onant approximation seen in Section IV. In particular,
using our method we were able to demonstrate that under
the resonant approximation the ﬁeld contribution from
non-resonant structures can be neglected with respect to
the undulator ﬁeld with an accuracy of 1/(4πNw). Here
we will restrict our attention to a region of parameters
where such an approximation is valid. Having indicated,
as in Fig. 22, with Ls the straight section length, we
will therefore be interested in the fundamental harmonic
of the system within the assumptions: ˆzo ≫
1 + Ls/Lw,
4πNw ≫
Also, for the same reason and with the same accuracy
we can neglect the constrained motion in the Green’s
function phase and consider the particle moving on a
straight line when calculating this phase term.

1, and ˆC + ˆθ2/2

4πNw.

≪

In Paragraph IV D we treated the case of a single elec-
If one is interested in

tron with oﬀset and deﬂection.

the far ﬁeld limit case, one can use Eq. (162) to obtain
the contributions from each segment but special atten-
tion must be taken in summing up the ﬁelds with the
correct relative phase factor.

With the help of Eq. (162) and the coordinate sys-
tem depicted in Fig. 22 we start accounting for the ﬁeld
contributions from the ﬁrst and the second undulator in
the case there is no straight section between the two seg-
ments that is ˆLs, deﬁned as Ls/Lw, is zero. In this case
we have:

33

technology (see [45]); in the case of PETRA III, they
will be usually designed and tuned in order to provide
matching condition for particles at nominal energy mov-
ing at zero angle with respect to the undulator axis, and
with zero detuning. This means that the phase shifter
will contribute for a relative phase φsh such that

φsh +

ω1Ls
2cγ2 = 2πn

(186)

ˆE1 =

ei(Φs+Φo)e

1
2

−iζ1/2 sin ζ1/2

ζ1/2

,

(179)

where n is an integer number. Taking out the unessential
2πn contribution (or setting n = 0) and accounting for
φsh one gets

ˆE2 =

1
2

ei(Φs+Φo)eiζ2/2 sin ζ2/2
ζ2/2

∆Φ1 =

ω1Ls
2

−

ω1
ω
−
2cγ2ω1

+

1
2

(θx −

ηx1)2 +

1
2

(θy −

(cid:20)

(180)

ηy1)2

(cid:21)
(187)

while

where

Φo =

ˆθxˆlcx −

−

ˆθyˆlcy ,

(181)

∆Φ2 =

and

ζ1 =

+

ˆC
2

ˆC
2

1
4

1
4

ˆθx −

ˆηx1

2

+

1
4

ˆθy −

ˆηy1

(cid:16)

(cid:17)

(cid:16)

(182)

2

(cid:17)

2

ζ2 =

+

ˆθx −

ˆηx2

2

+

1
4

ˆθy −

ˆηy2

.

(183)

∆Φ1 =

ω1Ls
2

ω
ω1
−
2cγ2ω1

+

1
2

(θx −

ηx2)2 +

1
2

(θy −

ηy2)2

.

(cid:20)

(cid:21)
(188)
Finally, we make use of the relation C = ∆ω/(2γ2
z c) and
we express ∆Φ1 and ∆Φ2 in normalized units thus writ-
ing

ˆC
2

−

ˆL

′
s −

1
4

(cid:20)

ˆθx −
(cid:16)

ˆηx1

2

+

1
4

(cid:17)

(cid:16)

ˆθy −

ˆηy1

2

ˆLs

(cid:17)

(cid:21)
(189)

(cid:16)

(cid:17)

(cid:16)

(cid:17)
Here Φs is deﬁned as usual by Eq. (159); oﬀsets ˆlc(x,y)
refer to the middle point of the system (i.e. the point
with zero value of z in Fig. 22) and deﬂections ˆη(x,y)1
and ˆη(x,y)2 refer to the ﬁrst and the second undulator
respectively, and the relation between the two is deter-
mined by the focusing elements only: therefore it makes
sense to talk about deﬂections for the ﬁrst and the second
undulator without specifying the point.

The next step is to account for the phase shift in the
= 0. On the one hand, shifting the ﬁrst segment
Ls/2 gives a phase contribution:

case ˆLs 6
of a quantity

−

∆Φ1 =

ωLs
2

−

1
2cγ2 +

1
2

(θx −

ηx1)2 +

1
2

(θy −

ηy1)2

.

(cid:20)

(cid:21)
(184)
On the other hand, shifting the second segment of a quan-
tity Ls/2 leads to an extra phase term:

∆Φ2 =

ωLs
2

1
2cγ2 +

1
2

(θx −

ηx2)2 +

1
2

(θy −

ηy2)2

.

(cid:20)

(cid:21)
(185)
To complicate the situation further, we should account
for the fact that, in order to practically control the rel-
ative phase between the two contributions phase shifters
will be installed. These devices are also useful in FEL

∆Φ2 =

ˆC
2

ˆL

′
s +

1
4

(cid:20)

(cid:16)

ˆθx −

ˆηx2

2

+

1
4

ˆθy −

ˆηy2

2

ˆLs

(cid:17)

(cid:16)

(cid:21)

(cid:17)

(190)

ˆL

′
s =

ˆLs
1 + K 2/2

.

(191)

We can account for a given energy deviation ∆γ/γ ex-
panding ˆC around the nominal energy. Trivial calcula-
tions show that, for ω = ω1, ω1 being now calculated at
θ = 0 and at nominal energy we obtain a shift ˆ∆E in the
detuning parameter given by

ˆ∆E = 4πNw

∆γ
γ

.

(192)

Including ˆ∆E in our equations we obtain the ﬁnal results:

ˆE1 =

ei(Φs+Φo)e

1
2

−iζ1/2ei∆Φ1 sin ζ1/2
ζ1/2

(193)

and

and

where

and

with

ˆE2 =

1
2

ei(Φs+Φo)eiζ2/2ei∆Φ2 sin ζ2/2
ζ2/2

(194)

TABLE I: Set of parameters for the segmented undulator
scheme

Quantity

Unit

Value

34

20.0
690
6.5
11742.0

−10

2.5 · 10
0.218
24.005
0.044
1.0 · 10−9
5.0
1.291
10.272
0.260
1.0 · 10−11
5.8
1.1 · 10
1.66

−3

(200)

m
-
m
-
m
-
m
m
m
m
-
m
m
m
m
-
-

−1

−1

Here Np is the number of particles in the beam and again,
for notational simplicity, we are taking indexes x and y
as implicit. Upon introduction of

ˆαT = αT ,
−1
ˆβT = L
w βT ,
ˆγT = LwγT ,
ˆε = (ω/c)ε

(201)

we can write Eq. (200) as a function of dimensionless
quantities as

g(ˆl1, ˆη1) =

1
2πˆε

exp

"−

ˆγT ˆl2

1 + 2 ˆαT ˆl1 ˆη1 + ˆβT ˆη2
2ˆε

1

.

#

(202)

The local energy spread of the beam will be assumed to
be a gaussian function with standard deviation ˆσE:

F ( ˆ∆E) =

− ˆ∆

2
E/(2ˆσ

2

E ) ,

(203)

1
2πˆσ2
E

e

p

Lw
Nw
Ls
γ
λ
αT x
βT x
γT x
εx
fx
αT y
βT y
γT y
εy
fy
σE
K

ζ1 =

ˆC + ˆ∆E
2

ζ2 =

ˆC + ˆ∆E
2

+

+

1
4

1
4

(cid:16)

(cid:16)

ˆθx −

ˆηx1

+

ˆθx −

ˆηx2

+

2

2

(cid:17)

(cid:17)

1
4

1
4

ˆθy −
(cid:16)

ˆθy −
(cid:16)

2

2

(cid:17)

(cid:17)

ˆηy1

,(195)

ˆηy2

,(196)

∆Φ1 =

ˆC + ˆ∆E
2

−

ˆL

′
s−

1
4

ˆθx −

ˆηx1

2

+

1
4

(cid:20)

(cid:16)

(cid:17)

ˆθy −
(cid:16)

2

ˆLs ,

ˆηy1

(cid:21)
(cid:17)
(197)

ˆηx2

2

+

1
4

ˆθy −

ˆηy2

2

ˆLs ,

∆Φ2 =

ˆC + ˆ∆E
2

ˆL

′
s+

1
4

ˆθx −
(cid:16)

(cid:20)

(cid:21)
(cid:17)
(198)
where ˆC is now the detuning parameter for a particle
with nominal energy and other quantities are as deﬁned
before.

(cid:17)

(cid:16)

As we have said, focusing elements simply change the
electron trajectory, but they do not contribute directly
to the total ﬁeld at the observer position. We will treat
them like a thin lens with focal length fx and fy in
the horizontal and vertical planes respectively. We can,
therefore, introduce normalized focal lengths ˆfx = fx/Lw
and ˆfy = fy/Lw.

From now on, when possible, we will neglect indexes
x or y for notational simplicity.
If we have oﬀset and
deﬂection ˆl1 and ˆη1 at the entrance of the system (where
ˆz =

1/2, see Fig. 22), we can easily calculate

ˆL2/2

−

−

ˆη2 =

ˆl1
ˆf

−

+

1
 

−

1 + ˆLs

2 ˆf !

ˆη1 .

(199)

It is worth to note here that if we take the limit for
ˆf
0, the sum ˆE1 + ˆE2 gives back Eq.
and ˆLs →
(160), as it must.

→ ∞

Since we have many particles here we can consider a
collective description of the beam, for instance in terms
of the Twiss parameters αT , βT and γT for the horizontal
and vertical planes at the entrance of the system, where
γT = (1 + α2
T )/βT . Knowing the Twiss parameters and
the emittance ε at the entrance of the ﬁrst undulator it
is easy to write down the number of particles with oﬀset
between l1 and l1+δl1 and with deﬂection angles between
η1 and η1 + δη1, always at the entrance of the system; in
fact, one can simply write it as g(l1, η1)δl1δη1, where g
is the following density distribution [46]:

g(l1, η1) =

exp

Np
2πε

−

(cid:20)

γT l2

1 + 2αT l1η1 + βT η2
1

2ε

.

(cid:21)

TABLE II: Set of normalized parameters for the segmented
undulator scheme

ˆαT x
ˆβT x
ˆγT x
ˆεx
ˆfx
ˆαT y
ˆβT y
ˆγT y
ˆεy
ˆfy
ˆLs
ˆσE
′
ˆL
s

where ˆσE = 4πNwσE and

σ2
E =

2

,

∆γ
γ

*(cid:18)

+

(cid:19)

brackets indicating the ensamble average over the particle
distribution.

A set of realistic normalized parameters for the seg-
mented undulator is given in Table I and Table II for
dimensional and dimensionless quantities, respectively.
From these tables we can already foresee a large eﬀect
of the normalized energy spread parameter ˆσE which is,
in our case, comparable with the normalized horizontal
emittance.

We can now average the normalized intensity over the
particle distribution function and the energy spread of
the beam at the entrance of the system thus ﬁnding the
ﬁnal expression for the total intensity ˆIb

∞

dˆηx1

ˆIb =

ˆE1 + ˆE2|
|
dˆly1

∞

2 =
∞

−∞

Z

−∞

Z

×

Z

−∞

∞

−∞

d ˆ∆EF ( ˆ∆E)

∞

−∞

dˆlx1

Z
dˆηy1 gx(ˆlx1, ˆηx1)gy(ˆly1, ˆηy1)

Z

−iζ1/2ei∆Φ1 sin ζ1/2
ζ1/2

+ eiζ2/2ei∆Φ2 sin ζ2/2
ζ2/2

. (205)

As in Eq. (171), the normalized intensity ˆIb is related to
the non-normalized intensity Ib by

×

e
(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)

ˆIb =

4π
Npc

c2zoγ
KωeLwAJJ (cid:19)

(cid:18)

2

Ib .

(206)

Moreover ˆη2 is expressed in terms of ˆl1 and ˆη1 in Eq.
(199).

0.218
1.20
0.873
25.1
0.250
1.29
0.514
5.19
0.251
0.290
0.325
9.54
0.137

(204)

35

We now reached an expression, Eq. (205), which can be
integrated with the help of numerical techniques. Results
of numerical integration are the intensity as a function of
the detuning parameter ˆC for ﬁxed observation angles or
the intensity as a function of angles for a ﬁxed detuning
parameter.

We developed a short code which uses a Monte Carlo
method to compute Eq. (205). A quasi-random gener-
ator is used to ﬁll the horizontal and vertical transverse
phase space with a given number of particles. The ac-
tual simulation makes use of Sobol sequences to reduce
the formation of cluster of particles, a well known phe-
nomenon described, for instance, in [48] and references
therein. Then, the intensity for each particle is calcu-
lated and all contributions are summed up to give an
estimation of Eq. (205). The critical parameter in this
kind of codes is the number of particles used. In general
the higher the number of particles is, the smaller the ﬂuc-
tuation of the results from run to run and the higher the
accuracy of the integration. On the other hand numerical
algorithm designers warn that quasi-random sequences
start to display unwanted correlations after several tens
of millions calls to the generating routine. We observed
that a choice of several million particles is more than suf-
ﬁcient to ensure that results converge fast enough so that
no relevant ﬂuctuation is present in the outcome (with
graphical accuracy of the results which will be described
in the next few ﬁgures).

0 and ˆσE →

First, we compared results from the Monte Carlo ap-
0, ˆfx,y → ∞
proach in the limiting case ˆLs →
,
, ˆεx → ∞
0. Results were in perfect agreement
ˆεy →
with the ones shown in Fig. 15, Fig. 17, Fig. 18 and
Fig. 19 as it should be. Then, as has already been said
in Paragraph IV D we compared this asymptotic situa-
tion with a more practical case of a uniform undulator
1. Results have been already
with ˆεx ≃
described, and shown in Fig. 20 and Fig. 21.

40 and ˆεy ≃

Finally we used all the features of our program in or-
der to deal with the segmented undulator case. We set
up parameters as in Table I, which correspond to a de-
sign set for the PETRA III case. The solid line in Fig.
23 represents the intensity as a function of the detuning
parameter ˆC at ˆθx = 0 and ˆθy = 0. The dashed line in
Fig. 23 is the intensity for the uniform undulator case,
corresponding to the limit ˆLs →
, while
Lw = 20 m. In this case we set the minimal betatron
function values to βox = 20 m in the horizontal direction
and βoy = 10 m in the vertical one. Beam energy, wave-
length, undulator deﬂection parameter, relative energy
spread and electron beam emittances are left unvaried
as in Table I. Assuming the minimal βT function in the
center of the undulator we can calculate the Twiss pa-
rameters at the system entrance using for both horizontal
and vertical plane (see, for instance, [46]) :

0 m and ˆf

→ ∞

βT (z) = βo

1 +

"

2

z

zw
−
βo (cid:19)

(cid:18)

,

#

(207)

-20

-16

-12

-8

-4

0

4

8

12

16

20

^
C

FIG. 23: Solid line : relative intensity from a beam with
parameters listed in Table II. The intensity is plotted as a
function of ˆC for ˆθx = 0 and ˆθy = 0.
It is normalized to
the maximal intensity from a beam in a uniform undulator.
Dashed line : relative intensity from a beam in a uniform
undulator ( ˆLs → 0 m and ˆf → ∞). We set the minimal
betatron function values ˆβox = 1 in the horizontal direction
and ˆβoy = 0.5 m in the vertical one. ˆεx,y and ˆσE are left
unvaried as in Table II.

^
=0
y
^
=0
x

^
C=0
^
=0
x

Intensity

Intensity

1,0

0,8

0,6

0,4

0,2

0,0

1,0

0,8

0,6

0,4

0,2

0,0

-10

-8

-6

-4

-2

0

2

4

6

8

10

^
y

FIG. 24: Solid line : relative intensity from a beam with
parameters listed in Table II. The intensity is plotted as a
function of ˆθy for ˆθx = 0 and ˆC = 0.
It is normalized to
the maximal intensity from a beam in a uniform undulator.
Dashed line : comparison with the relative intensity from
a beam in a uniform undulator ( ˆLs → 0 m and ˆf → ∞).
We set the minimal betatron function values ˆβox = 1 in the
horizontal direction and ˆβoy = 0.5 m in the vertical one. ˆεx,y
and ˆσE are left unvaried as in Table II.

γT (z) = γo =

1
βo

,

αT (z) =

γo(z

zw) ,

−

−

36

(208)

(209)

where zw indicates the z-position at the beam waist,
while subscripts ”o”, as usual, denote minimal values of
the Twiss parameters. Taking zw = 0 m at the center of
10 m we obtain the initial Twiss pa-
the system and z =
rameters to enter in our program: αT x = 0.5, βT x = 25.0
m and γT x = 0.05 m−1, αT y = 1.0, βT y = 20.0 m and
γT y = 0.1 m−1.

−

It is important to remark that we normalized the solid
line in Fig. 23, that is the result for the segmented un-
dulator, to the maximal intensity found for the uniform
undulator while the dashed line represents the relative
intensity for the uniform undulator. This allows direct
comparison between uniform undulator and segmented
undulator schemes.

To conclude, in Fig. 24 (solid line) we plot again the
intensity as a function of ˆθy at ˆC = 0 and ˆθx = 0. Simi-
larly as for Fig. 23, the dashed line in Fig 23 represents
a comparison with the uniform undulator case ˆLs = 0 m
and ˆf
, where the other parameters are left unvaried
as in Table I. Normalization of the curves are as in Fig.
23. The ﬁnal results for the two schemes do not appear
to be dramatically diﬀerent.

→ ∞

As a comment for both Fig. 23 and Fig. 24 it is
interesting to note the smoothing action of ﬁnite beam
emittance combined with ﬁnite energy spread.

VI. CONCLUSIONS

In this paper we have shown that even well-known
and long studied subjects, like Synchrotron Radiation,
continue to retain interest from a theoretical viewpoint.
In particular we have proposed a technique to compute
harmonic contributions of the electric ﬁeld from a mov-
ing charge particularly suitable for analytical investi-
gations. We showed that our general expression, Eq.
(28), can be obtained from already known expression
Eq. (2) with the use of a paraxial approximation, but
also much more straightforwardly from Maxwell’s equa-
tion in paraxial form, with the help of a parabolic Green’s
function method. The main advantage of our approach
with respect to standard techniques is that we separated
from very beginning approximations independent from
the system under study (paraxial approximation) and as-
sumptions that, from time to time, arise in the study of
a particular magnetic system. This gave us the possibil-
ity to specify region of applicability and accuracy of well
known results, which we were, of course, able to recover
using our method, like the ﬁeld from a charge moving
on a circle, in a short bending magnet or in an undu-
lator and also edge radiation eﬀects from a particular

q
q
q
q
setup. Again, our particular approach is logically much
less involved with respect to the others, since it relies
on direct integration of the paraxial Maxwell’s equations
for a given harmonic. As a result, our expression gives
a clearer and completely fresh insight in old results. Be-
sides being able to discuss their region of applicability
and their accuracy, we pointed out that phase corrections
with respect to the spherical wavefront for an electron
on a circle arise naturally from analytical treatment. We
have seen that short magnet radiation is a complete sep-
arate phenomenon with respect to edge radiation. We
stressed the importance of the knowledge of the entire
electron trajectory in order to obtain a correct calcula-
tion of the ﬁeld: from this viewpoint we have seen how
edge radiation from two dipoles separated by a straight
section arises, in our method, from the contribution due
to the straight section alone, and that the ﬁeld term from
the magnets is completely negligible. We discussed, un-
der resonance approximation, accuracy and applicability
region of the far ﬁeld undulator radiation and we dealt
with near ﬁeld eﬀects as well: in particular we were able
to reproduce already known results studying their region
of applicability in detail, and we found also other regions
of interest, where the near ﬁeld parameter ¯W is of fun-
damental importance.

Besides this, our method proved to be a reliable basis
for calculation of more complicated quantities like ﬁeld
autocorrelation functions, either from bending magnets
or undulators, which are of fundamental importance in
the understanding of spatial coherence properties of Syn-
chrotron Radiation. In fact, by direct application of our
general formula Eq. (28) we were able to provide ana-
lytically manageable expressions for bending magnet or
undulator radiation in the case of an electron with a
transverse oﬀset and deﬂection. These expressions can
be integrated over realistic beam particle distributions
and can be used in very practical calculations. Their
strength stems from the fact that they correctly account
for the ﬁeld phase and that they can be simply summed
up to give results for apparently complicated situations.

37

Complete treatment of spatial coherence would proba-
bly double the size of this paper. For this reason, this
ﬁrst work focuses on the basis of Synchrotron Radiation
theory only.

A few applications which exploit the power of our ap-
proach have been selected for the ﬁnal part of the paper.
At the end of Section IV we addressed basic character-
istics of undulator radiation in the presence of electron
beam emittance. We discussed the asymptotic situation
for a large horizontal and a small vertical emittance.

Finally, in Section V, we considered a novel undulator
conﬁguration (setup of two undulators separated by a fo-
cusing element) which is planned for installation at PE-
TRA III. Computation of radiation characteristics from
new setups by means of numerical techniques alone re-
quires, almost always, modiﬁcations of existing simula-
tion codes which can be better done by the code authors
themselves. Up to date, the particular case we chose to
study has not been included in existing simulation codes.
For this reason we selected this particular example: our
goal was to demonstrate that, in general, the application
of our method allows solution of apparently diﬃcult prob-
lems relying on simple computer algorithm which can be
developed by non-expert programmers, with obvious ad-
vantages in saving time and better physical understand-
ing.

We expect that our technique will be used in the future
as a basis for developments of simulation codes and for
physical understanding of complex situation as well.

VII. ACKNOWLEDGEMENTS

The authors are grateful to Klaus Balewski, Werner
Brefeld, Winfried Decking, Martin Dohlus, Hermann
Franz, Petr Ilinski and Edgar Weckert for many useful
discussions and to Oliver Grimm, Jochen Schneider and
Ivan Vartanyants for their interest in this work.

[1] J. Schwinger, Phys. Rev. 75, 1912 (1949)
[2] D. Iwanenko and I. Pomeranchuk, Phys. Rev. 65, 343

(1944)

[3] A. Sokolov and I. Ternov, Synchrotron radiation,

Akademie Verlag, Berlin (1968)

[4] J. Jackson, Classical Electrodynamics, John Wiley and

chrotron Radiation and Free Electron Laser, World Sci-
entiﬁc Publishing Co. Pte. Ltd., Singapore (2000)
[10] P. Duke, Synchrotron Radiation - Production and prop-
erties, Oxford University Press Inc., New York (2000)
[11] PETRA III Technical Design Report, ISSN 0418-9833,
edited by K. Balewski, W. Brefeld et al., DESY, Ham-
burg (2004)

[5] H. Wiedemann, Particle accelerator physics, Springer-

[12] H. Kitamura, T. Bizen et al., Nucl. Instr. Meth. Phys.

[6] H. Wiedemann, Synchrotron Radiation, Springer-Verlag,

[13] T. Thurn-Albrecht, G. Meier et al., Phys. Rev. E 59, 642

[7] A. Hofmann, CAS - CERN Accelerator School 1998,

[14] S. Mochrie, A. Mayers et al., Phys. Rev. Lett. 78, 1275

Res. A, 467-468, 110 (2001)

(1999)

(1997)

Sons Inc. (1998)

Verlag (1993)

Germany (2003)

CERN 98-04 (1998)

[8] A. Hofmann, The physics of Synchrotron Radiation,

Cambridge Univ. press, Cambridge (2003)

[9] F. Ciocci, G. Dattoli et al., Insertion Devices for Syn-

[15] O. Tsui and S. Mochrie, Phys. Rev. E 57, 2030 (1998)
[16] D. Riese, W. Vos et al., Phys. Rev. E 61, 1676 (2000)
[17] T. Seydel, A. Madsen et al., Phys. Rev. B, 63 0734099(4)

38

[18] I. Sikharulidze, I. Dolbnya et al., Phys. Rev. Lett. 88,

115503(4) (2002)

[35] V. A. Bordovitsyn (Editor), Synchrotron Radiation The-
ory and Its Development, World Scientiﬁc, Singapure-
London, (1999)

[19] A. Snigirev, I. Snigireva et al., Rev. Sci. Instrum. 66, 5486

[36] J. W. Goodman, Statistical Optics, John Wiley & Sons,

[20] S. Wilkins, T. Gureyev et al., Nature 384, 335 (1996)
[21] T. Gureyev, C. Raven et al., J. Phys. D 32, 563 (1999)
[22] P. Cloetens, W. Ludwig et al., Appl. Phys. Lett. 75, 2912

[37] L. Mandel and E. Wolf, Optical Coherence and Quantum

Optics, Cambridge University Press, 1995

[38] D. Attwood, Soft X-rays and extreme ultraviolet radia-

[23] J. Miao, P. Charalambous et al. Nature 400, 342 (1999)
[24] I. Robinson, J. Libbert et al., Phys. Rev. B 60, 9965

[25] J. Pitney, I. Robinson et al., Phys. Rev. B 62, 13084

A, 426 (2001)

[26] A. Letoublon, F. Yakhou et al. Europhyis. Lett. 54, 753

[27] O. Chubar, P.Elleaume et al., Nucl. Instr. Meth. Phys.

tion, Cambridge University Press, 1999

[39] R.A. Bosch, Nucl. Instr. Meth. Phys. Res. A, 386, 525

[40] P. Roy, J-B. Brubach et al., Nucl. Instr. Meth. Phys. Res.

[41] R.A. Bosch, Nucl. Instr. Meth. Phys. Res. A, 482, 789

[42] P. Ilinski, Ph.D. Thesis, Illinois Institute of Technology

Res. A, 435, 495 (1999)

[43] D. Alferov, Y.A. Bashmakov et al. Sov. phys. - Tech.

[28] T. Tanaka and H. Kitamura, J. Synch. Rad. 8, 1221

Phys. 18, 1336 (1974)

(2001)

(1995)

(1999)

(1999)

(2000)

(2001)

(2001)

Inc., 1985

(1997)

(2002)

(1998)

(1988)

[29] O. Chubar, Rev. Sci. Instrum. 66, 1872 (1995)
[30] O. Chubar and N. Smolyakov, Proceedings of the 1993
Particle Accelerator Conference, Washington DC, USA,
1626 (1993)

[31] Y. Hirai, A. Luccio et al., J. Appl. Phys. 55(1), 25 (1984)
[32] Y. Takayama and S. Kamada, Phys. Rev. E 59, 6 (1999)
[33] V.G. Bagrov, N.I. Fedsov and I.M. Ternov, Phys. Rev. D

28, 2464 (1982)

[34] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov,
DESY 03-031, ISSN 0418-9833, DESY, Hamburg (2003)

[44] R. Walker, Nucl. Instr. Meth. Phys. Res. A, 267, 537

[45] J. Pﬂ¨uger and M. Tischer, TESLA-FEL 2000-08 (2000)
[46] J. Rosenzweig, Fundamentals of beam physics, Oxford

University Press Inc., New York (2003)

[47] Y. Takayama, N. Takaya et al., Nucl. Instr. Meth. Phys.

[48] S. Reiche, Ph.D. Thesis, DESY-THESIS-2000-012,

Res. A, 441, 565 (2000)

DESY, Hamburg (2000)

