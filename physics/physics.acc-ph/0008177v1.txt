2D SIMULATION OF HIGH-EFFICIENCY CROSS-FIELD RF POWER

SOURCES∗

Valery A. Dolgashev, Sami G. Tantawi†, SLAC, Stanford, CA 94309, USA
1

INTRODUCTION

also use cavity modes with eigen-frequencies close to the
working frequency.

0
0
0
2

 

g
u
A
0
2

 

 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 

1
v
7
7
1
8
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

In a cross ﬁeld device[1] such as magnetron or cross ﬁeld
ampliﬁer electrons move in crossed magnetic and electric
ﬁelds. Due to synchronism between electron drift velocity
and phase velocity of RF wave, the wave bunches the beam,
electron spokes are formed and the bunched electrons are
decelerated by the RF ﬁeld. Such devices have high efﬁ-
ciency (up to 90%), high output power and relatively low
cost. Electrical design of the cross-ﬁeld devices is difﬁ-
cult. The problem is 2D (or 3D) and highly nonlinear. It
has complex geometry and strong space charge effects. Re-
cently, increased performance of computers and availabil-
ity of Particle-In-Cell (PIC) codes[2, 3], have made possi-
ble the design of relatively low efﬁciency devices such as
relativistic magnetrons or cross ﬁeld ampliﬁers [4]. Sim-
ulation of high efﬁciency (∼ 90%) devices is difﬁcult due
to the long transient process of starting oscillations. Use
of PIC codes for design of such devices is not practical. In
this report we describe a frequency domain method that de-
veloped for simulating high efﬁciency cross-ﬁeld devices.
In the method, we consider steady-state interaction of par-
ticles with the modes of RF cavity at dominant frequency.
Self-consistency of the solution is reached by iterations un-
til power balance is achieved.

2 PHYSICAL MODEL

Cross-ﬁeld devices consist of a cathode and a surround-
ing anode. The structure is a cavity with a set of resonant
eigenmodes. Macroparticles are emitted from the cathode
and moved by forces of electromagnetic ﬁelds. The elec-
tromagnetic ﬁelds are determined by applied external elec-
tric potential between anode and cathode, oscillating ﬁeld
of cavity modes, and space charge ﬁelds. We use geom-
etry with arbitrary piece-wise planar boundaries. In order
to solve the electrostatic and electrodynamic problems, we
apply methods that do not require mesh generation. Inter-
action with magnetic ﬁeld is determined by uniform mag-
netic ﬁeld Hz which is parallel to z-axis and orthogonal
to the plane of simulation. There are several assumptions
that we use to simplify the problem. These assumptions are
based on the working regime of the devices that we want to
simulate. Devices will have low current density, are non-
relativistic, and have resonant systems with a relatively low
density of the cavity modes. Hence, we can neglect mag-
netic ﬁelds due to space charge and cavity modes. We can

∗ This work was supported by the U.S. Department of Energy contract

DE-AC03-76SF00515.

† Also with the Communications and Electronics Department, Cairo

University, Giza, Egypt.

2.1 Basic equations
We are solving a steady state problem of electron beam
ﬂow in self-consistent electromagnetic ﬁelds. Total ﬁelds
are superposition of static electric ~E ′ and magnetic ~H ′
ﬁelds, and “oscillating” electric ~E(ω) and magnetic ~H(ω)
ﬁelds as

~E(t) = ~E ′+ℜe{ ~E(ω)ejωt}, ~H(t) = ~H ′+ℜe{ ~H(ω)ejωt}.

Here ω is angular frequency, t is time. We separate the elec-
trodynamic problem into two parts. The ﬁrst part – electro-
static potential Φ is generated by “external” anode-cathode
potential and by the static component of the space-charge
electric ﬁelds. The second part – the dynamic electromag-
netic ﬁelds have a harmonic ejωt time (t) dependence.

Static ﬁelds

2.2
We ﬁnd the static electric ﬁeld from ~E ′ = −∇Φ, using the
Poisson equation:

∇2Φ = −

,

(1)

ρ
ǫ0

where ∇ is the gradient operator, ρ is volume charge den-
sity averaged over oscillation period T = 2π/ω. ǫ0 is the
electric permittivity of the vacuum.

2.3 Oscillating ﬁelds
To solve the second part of the problem, we write the time
harmonic Maxwell equations as

∇ × ~E = −jωµ0 ~H, ∇ × ~H = jωǫ0 ~E + ~Jω.

(2)

Here ~Jω is electric current density, µ0 is the magnetic per-
meability of vacuum. Oscillating ﬁelds inside a cavity are
expanded in terms of the cavity eigenmodes ( ~Es, ~Hs) and
the fast oscillating electric potential ϕω as

~E =Xs

As ~Es − ∇ϕω, ~H =Xs

Bs ~Hs.

(3)

Here s is mode index, As and Bs are the eigenmode am-
plitudes. Using the expansion (3) we get the Poisson equa-
tion for the potential:

∇2ϕ =

∇ · ~Jω
jωǫ0

= −

ρω
ǫ0

,

(4)

where ρω is the oscillating space-charge density. Ampli-
tudes of the electric ﬁeld expansion are given by

ω

As =

j(ω2 − ω2

s ) RV
ǫ0RV

~Jω ~E ∗
s dV
~Es ~E ∗
s dV

.

(5)

Here ωs is the mode eigen-frequency of the mode , V is the
cavity volume.

2.4 Equation of motion
Equation of motion for an electron in crossed-ﬁelds is

d~p
dt

= qe ~E(t) + µ0~v × Hz,

(6)

where ~p is the relativistic momentum, qe is the charge, and
~v is the velocity of the electron. Current density induced by
the electron motion is ~J = qe~vδ(~r), where ~r is the position
vector of the electron, and δ is the Kronecker delta function.

3 NUMERICAL METHODS

We created several separate program modules to simulate a
cross-ﬁeld device. First is an RF ﬁeld solver that calculates
eigenmodes and eigen-frequencies in the cavity; second is
the Poisson solver that ﬁnds electric ﬁelds due to external
potential, static space charge, and oscillating space charge;
and third, the tracking module that performs tracking of
electrons through electromagnetic ﬁelds. For simulation,
we consider an arbitrary, piecewise bounded 2D geometry.

3.1 Planar geometry

#

"

$

%







&

'

!

 



2HJ

;

'

&

%



O

Γ

$

N

 

!

"
 

#

2HJ 

; 

Figure 1: Planar geometry.

The geometry is cylindrical (uniform in the z-direction)
as illustrated on Fig. 1. It consists of planar sidewalls and
apertures. The geometry in the x, y plane can be described
by a set of points zs = (xs, ys), where s = 1, 2..., N ′; here
N ′ is the total number of sidewalls and apertures. Periodic
boundary conditions are applied to the apertures. The pe-
riodic boundary allows us to use only part of the structure
and signiﬁcantly reduce simulation time. In the particular
case shown in Fig. 1 the geometry has N ′ = 19 sidewalls,
two apertures (ports) with starting points p = 1, 15, and
the cathode and anode determined by s = 16, 17, 18, 19, 1
and s = 2, 3, ..., 15 respectively.

3.2 RF ﬁeld solver
The description of the RF solver that is used in this method
is published in [5]. Here we brieﬂy outline its properties.
We use the scattering matrix approach [6] to calculate the
dispersion parameters of the periodic 2D structure, it’s res-
onant frequencies, and the corresponding ﬁelds. The ﬁelds
are described by functional expansion. Boundary contour
mode-matching is applied in a piecewise bounded 2D re-
gion is applied to obtain the scattering matrix and ﬁeld am-
plitudes [7]. The Galerkin method is used for the mode-
matching procedure. The geometry is divided into regions,
and electromagnetic ﬁelds in each region are expanded in

series of plane waves or (for low frequencies) Bessel func-
tions. Scattering matrices from the regions are combined
using the generalized scattering matrix technique. Reso-
nant and periodic boundary conditions [6] are used to ob-
tain resonant frequencies, dispersion parameters, and cor-
responding ﬁelds. We calculate the electric ﬁelds on a polar
grid (only in the region of ﬁeld-particle interaction), in or-
der to speed up calculation of ﬁelds for the macroparticle
tracking. To obtain ﬁeld at the macroparticle position we
use 2D spline interpolation.

3.3 Poisson solver
We use an efﬁcient method for solving the Poisson equa-
tion for electric ﬁelds in a 2-D, arbitrarily shaped geometry.
The solution is based on the method of moments. Point-
matching in a piecewise bounded 2D region is applied to
obtain the charge density on the boundary. The boundary’s
charge density determines the ﬁelds and potentials through-
out the interior region. We use a complex representation
of the ﬁelds and potentials in the solution [8]. We apply
periodic boundary conditions to simulate the ﬁelds in the
periodic structure.

Formulation We solve equation (1) in 2D. In the 2D
case it is advantageous to represent the position and ﬁeld
vector’s (x, y) components by a single complex represen-
tation. We will work with functions of a complex variable

z = x + jy. The ﬁeld strength eE can be written in terms of

the scalar potential Φ = Φ(z) as

dΦ∗
dz

.

(7)

eE(z) = −

Here ∗ represents the complex conjugate. An effective line
charge q (point charge in 2D geometry) has the complex
potential Φ = (q/ǫ0) log z. We approximate the charge dis-
tribution on the boundary of the region as a sum of “step”
functions. We divide each element(sidewall and aperture)
of the boundary into Nb straight pieces or “charged lines”
with uniform charge density σ along the piece. A uniformly
charged straight wall with beginning and end coordinates
z1 and z2, respectively, will produce a complex potential at
the point zw

Φ(zw) =ZL

σ
ǫ0

log(z − zw)dz,

(8)

where L is the contour along the line. Equation (8) is inte-
grated analytically.

Field strength of the charged wall We obtain the
electric ﬁeld of the charged line by substituting (8) into (7):

eE(zw)ǫ0

σ

=(cid:20) |z1 − z2|

z1 − z2

log(cid:18) zw − z1

zw − z2(cid:19)(cid:21)∗

.

(9)

The value of the function is undeﬁned on the line’s contour.
However, for us, the ﬁelds inside the region are of interest.
Therefore, the direction of the ﬁeld (for positive charge)

on the line’s contour is chosen to be directed inward. Also
singularities at points z1 and z2 can affect the ﬁeld’s cal-
culation. Macroparticles with ﬁnite dimensions are used to
avoid this singularity.

deﬁned and there is no difﬁculty in solving the system di-
rectly. For macroparticle tracking, the electric ﬁeld calcu-
lated on polar grid and then interpolated at the macroparti-
cle position (same as for RF ﬁelds).

Periodic boundary condition We assume that the po-
tential and ﬁeld strength are repeated on the period’s aper-
tures (Fig. 1). Let z ′
2. If we shift the
region to the right so it coincides with the next period, the
coordinate z ′
2. The
periodic boundary condition becomes

1 will be transformed into coordinate z ′

1 and z ′

1 ∈ Y ′

2 ∈ Y ′

Φ(z ′

1) = Φ(z ′

2),

∂Φ(z ′
1)
∂n

= −

∂Φ(z ′
2)
∂n

.

(10)

We assume the Dirichlet condition on the sidewalls (except
for the apertures) as

Φ(Γ′) = ζ(Γ′), Γ = Γ′ + Y ′

1 + Y ′
2 .

(11)

Integral equations For periodic boundary conditions
(10) and (11) surface charge density σ must satisfy the cou-
pled integral equations




RΓ log(zw − z)σ(z)dz = ǫ0ζ(zw), zw ∈ Γ′,
1 − z)σ(z)dz =RΓ log(z ′
RΓ log(z ′
RΓn ∂ log(z′
= −RΓn ∂ log(z′

o∗
dzo∗

σ(z)dz − πσ(z2),
2 ∈ Y ′
2 ,

σ(z)dz + πσ(z ′

z ∈ Γ, z ′

1 ∈ Y ′

1 , z ′

1) =

−z)

−z)

2 − z)σ(z)dz,

∂np

2

1

∂np

−z)

(12)
in which ∂ log(zw
denotes the normal derivative of
∂np
log(zw − z) at the point zw assuming z is ﬁxed; Γ =
2; coordinates z1 and z2 are the same as in
Γ′ + Y ′
(10); and ζ(zw) is the external potential.

1 + Y ′

,




Numerical approximation We solve the integral
equation numerically, by approximating the source densi-
ties by step-functions [9]. Thus we divide the given bound-
ary Γ into NΓ intervals and assume that the simple source
density σ has a constant value within each interval. Then
denoting these constant values by σi, i = 1, 2, ..., NΓ, we
approximate Φ and E by

σiǫ0Zi
NΓXi=1
bΦ(zw) =
ǫ0 Zi(cid:18) d log(zw − z)
NΓXi=1
bE(zw) =

dzw

σi

log(zw − z)dz, and

(13)

(cid:19)∗

dz,

(14)

whereRi denotes integration over the i-th interval of Γ. We

substitute (13) and (14) into (12) to obtain numerical ap-
proximation for periodic solution. The unknowns (in the
system obtained) are the charge density on the intervals σi,
the potential and the electric ﬁeld on the periodic aperture.
All coefﬁcients in the system are calculated analytically.
For practical geometries, the matrix of coefﬁcients is well

3.4 Tracking
We ﬁnd a macroparticle trajectory by using the 4th order
Runge-Kutta method for integrating the equation of mo-
tion (6) in polar coordinates. Then, we integrate the com-
plex electric ﬁeld of the cavity modes along the trajectory to
ﬁnd coefﬁcients for the cavity’s eigenmodes (5). We mon-
itor energy conservation in order to verify accuracy of cal-
culation. For that purpose we use total energy that consists
of kinetic energy of the macroparticle and integral of static
(due to external potential and static space charge) and os-
cillating (due to cavity modes and oscillating space charge)
electric ﬁelds along the trajectory. Initial charge and ve-
locity ~v are determined by a space-charge-limited-emission
model and a relaxation scheme.

3.5 Algorithm
We start simulation by calculating dispersion the curve for
the spatial period of the device (using the RF ﬁeld solver).
Then, we calculate electric ﬁelds for the eigenmodes. Next,
(using the Poisson solver) we calculate electric ﬁeld due to
external potential. Next, we start iterations using Track-
ing module to ﬁnd the macroparticle trajectories, ﬁeld inte-
grals along the trajectories, and electric ﬁelds due to space
charge. Next, we update the static and oscillating ﬁelds and
start new iteration.

4 SUMMARY

We have written a C++ computer code that uses meth-
ods, described above. Accuracy of resonant frequency
calculation by RF ﬁeld solver for typical geometries is
∼ 0.1%. We tested performance of Poisson solver and
Tracking module on diode geometries (without magnetic
ﬁeld). We calculated diode current with typical accuracy
2-3% in comparison with analytical solution. Testing of
the code on cross- ﬁeld devices is under way.

5 REFERENCES

[1] G. B. Collins, “Microwave Magnetrons,” Boston tech. pub., Inc.,

1964.

[2] B.Goplen at al, “User-conﬁgurable MAGIC Code for Electromag-
netic PIC Calculations,” Comp. Phys. Comm., vol.87, pp. 54-86,
1995.

[3] K. R. Eppley,

“Numerical

Simulation Of Cross

Field

Ampliﬁers,”SLAC-PUB-5183, 1990.

[4] X. Chen, at al, “2D/3D magnetron modeling,”2nd Int. Conf. On Cross

Field Devices and Appl., Boston, MA, USA, 17-19 June, 1998.

[5] V.A. Dolgashev, S.G. Tantawi, “Method for Efﬁcient Analysis of
Waveguide Components and Cavities for RF Sources,” EPAC’2000,
26-30 June 2000, Austria Center, Vienna.

[6] V. A. Dolgashev, “Calculation of Impedance for Multiple Waveg-
uide Junction Using Scattering Matrix Formulation,” presented at
ICAP’98, Monterrey, CA, USA, 14-18 Sept., 1998.

[7] J. M. Reiter and F. Arndt,

IEEE Trans. Microwave Theory Tech.,

vol. 43, pp. 796-801, Apr. 1995.

[8] R. B. Beth, “Complex Representation and Computation of Two-
Dimensional Magnetic Fields”, Journal of Applied Physics, Vol. 37,
Number 7, June, 1966.

[9] L. M. Delves and J. Walsh, “Numerical Solution of Integral Equa-

tions,” Clarendon Press, Oxford, 1974.

