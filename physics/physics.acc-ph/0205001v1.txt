DEUTSCHES ELEKTRONEN-SYNCHROTRON

DESY 02-048
May 2002

Transverse self-ﬁelds within an electron bunch moving
in an arc of a circle

Gianluca Geloni, Jan Botman, Jom Luiten and Marnix van der Wiel

Department of Applied Physics, Technische Universiteit Eindhoven,
P.O. Box 513, 5600MB Eindhoven, The Netherlands

Martin Dohlus, Evgeni Saldin and Evgeni Schneidmiller

Deutsches Elektronen-Synchrotron DESY,
Notkestrasse 85, 22607 Hamburg, Germany

Mikhail Yurkov

Particle Physics Laboratory (LSVE), Joint Institute for Nuclear Research,
141980 Dubna, Moscow Region, Russia

2
0
0
2
 
y
a
M
 
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
1
0
0
5
0
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Transverse self-ﬁelds within an electron bunch moving in an arc of a circle

Gianluca Geloni,∗ Jan Botman, Jom Luiten, and Marnix van der Wiel
Department of Applied Physics, Technische Universiteit Eindhoven,
P.O. Box 513, 5600MB Eindhoven, The Netherlands

Martin Dohlus, Evgeni Saldin, and Evgeni Schneidmiller
Deutsches Elektronen-Synchrotron DESY,
Notkestrasse 85, 22607 Hamburg, Germany

Mikhail Yurkov
Particle Physics Laboratory (LSVE),
Joint Institute for Nuclear Research,
141980 Dubna, Moscow Region, Russia

As a consequence of motions driven by external forces, self-ﬁelds (which are diﬀerent from the
In the case of magnetic external forces acting
static case) originate within an electron bunch.
on an ultrarelativistic beam, the longitudinal self-interactions are responsible for CSR (Coherent
Synchrotron Radiation)-related phenomena, which have been studied extensively. On the other
hand, transverse self-interactions are present too. At the time being, existing theoretical analysis
of transverse self-forces deal with the case of a bunch moving along a circular orbit only, without
considering the situation of a bending magnet with a ﬁnite length. In this paper we propose an
electrodynamical analysis of transverse self-ﬁelds which originate, at the position of a test particle,
from an ultrarelativistic electron bunch moving in an arc of a circle. The problem will be ﬁrst
addressed within a two-particle system. We then extend our consideration to a line bunch with a
stepped density distribution, a situation which can be easily generalized to the case of an arbitrary
density distribution. Our approach turns out to be also useful in order to get a better insight in the
physics involved in the case of simple circular motion and in order to address the well known issue
of the partial compensation of transverse self-force.

PACS numbers:

I.

INTRODUCTION

When an electron bunch undergoes a motion under the
inﬂuence of external forces, the particles within the bunch
become sources of self-ﬁelds which are diﬀerent from the
static case and which obey the usual Lienard-Wiechert
expressions.

These self-ﬁelds feed back on the particle dynamics,
which often makes the description of the evolution of the
system a problem without easy solution.

Many electrodynamical systems ﬁt in the latter de-
scription.
In all these systems one can recognize two
separate aspects in the evolution issue: a dynamical one,
which is governed by the equation of motion, and an
electrodynamical one, which is taken care of by Maxwell
equations. The solution to the evolution problem is ob-
tained when one is able to solve simultaneously both
equations: this is, for example, what self-consistent com-
puter codes strive for. An example of such self-consistent,
numerical solutions is given (see [1]) by the program
TRAFIC4 (which will be employed in this paper to
provide cross-checks with analytical results). Although
TRAFIC4 and other codes are able to provide quite re-

∗Electronic address: g.a.geloni@tue.nl

liable results for a number of evolution problems, a sep-
arate study of their dynamical and electrodynamical as-
pects, which can be achieved by means of theoretical
analysis, is necessary in order to get a good understand-
ing of the physics involved, and to provide benchmark
and cross-checks for simulations (and, at an earlier stage,
to build correct simulations too).

Moreover, it often happens that this kind of theoreti-
cal analysis can be directly applied in order to get good
practical solutions for the problem at least in a narrow
region of the parameters which specify the system setup.
The results can, then, be used for quick estimations of
the magnitude of the eﬀects under investigation.

Let us restrict our attention to the case of self-ﬁelds
within an ultrarelativistic electron bunch driven by ex-
ternal forces of magnetic nature.

The self-interaction in the longitudinal direction (par-
allel, at any time, to the velocity vector by deﬁnition)
is responsible for the energy exchange between the sys-
tem and the acceleration ﬁeld and for all CSR (Coherent
Synchrotron Radiation)-related phenomena, which have
been studied extensively elsewhere (see, among the oth-
ers, [1]... [8]).

These investigations are important in view of the need
for very high-peak current, low emittance beams for self-
ampliﬁed spontaneous emission (SASE)-free-electron-
lasers operating in the x-ray region (see, among the oth-
ers, [9]). Similar beams are also being considered for

production of femtosecond radiation pulses by simpler
schemes based on Cherenkov and Transition Radiation
[10]: production and utilization of such kind of beams
may prove diﬃcult due to self-ﬁeld collective eﬀects. In-
deed, these eﬀects may spoil the required high brightness
of the electron beam, which is a matter of major concern
among people involved this kind of physics research.

The study of self-forces in the transverse direction is
important for the same reasons. They were ﬁrst ad-
dressed, in the case of a circular motion, and from an
electrodynamical viewpoint, in [11]. Further analysis ([6],
[14]) consider, again, the case of circular motion
[12]...
both from an electrodynamical and a dynamical view-
point and in the approximation of a rigid bunch: at the
time being, existing theoretical analysis of transverse self-
forces deal with the case of circular orbit only, without
considering transient collective phenomena.

In this paper we propose a fully electrodynamical anal-
ysis of transverse self-ﬁelds originating, at the position of
a test particle, from an ultrarelativistic electron bunch
moving in an arc of a circle, thus treating for the ﬁrst
time, besides the basic situation of circular motion, also
the case of transient between a straight line and a hard-
edge magnet (and, vice versa, from a bend to a straight
line).

Consistently with the choice to analyze the electrody-
namical aspect of the problem only, a zero energy-spread
will be understood when considering the evolution of an
electron bunch. As underlined before, although the re-
sults obtained can be directly applied, from a practical
viewpoint, only in the case in which the zero energy-
spread hypothesis is veriﬁed a posteriori, the outcomes
of this paper are important to get a good insight if the
physics of the problem, and to provide benchmark and
cross-checks for simulations.

Firstly, a two-particle model is adopted in order to
study the transverse force produced by a single parti-
cle, and then, by summing up all the contributions from
diﬀerent electrons, the case of a line-bunch model charac-
terized by a rectangular density distribution is analyzed:
this can, in fact, be easily generalized to the case of an
arbitrary density distribution.

Besides providing results in the case of a ﬁnite hard-
edge bending magnet, our approach turns also useful in
order to get a better insight of the physics involved in
the case of simple circular motion.

Moreover, our results give us a better understanding
(although one has to take into account, here, dynamical
aspects as well as electrodynamical ones) of the partial
compensation between transverse self-force and gradient
of the potential energy deviation from the nominal value.
We will discuss the limits of applicability of our model,
with respect to the transverse beam size, h, in Section
III). Within such applicability limits, we ﬁnd results
which are independent of the bunch transverse dimen-
sion.

The paper is organized as follows. The transverse in-
teraction between two electrons moving on a circle, to-

3

gether with a simple dynamical interpretation is treated
in Section II.
In Section III, we deal with a stepped-
proﬁle electron bunch interacting with a test particle
again on a circle, and discuss also the applicability re-
gion of the line model. Transient behavior (from straight
to circular path and vice versa) for the transverse self-
forces between two particles are then studied in Section
IV. Results for the transient of a stepped-proﬁle bunch
are given in Section V, where a treatment for the case of
a more generic bunch density is also proposed. A regu-
larization technique for cancelling the singularity in the
expression for the transverse force (which always arises
in the limit of a near-zero distance between test particle
and sources) is then applied. In Section VI we will deal
with the well-known issue of the partial compensation of
transverse self-force. Finally, in Section VII, we come to
a summary of the obtained results and to conclusions.

II. TRANSVERSE INTERACTION BETWEEN
TWO ELECTRONS MOVING IN A CIRCLE

Let us begin our study considering the steady case of
two electrons moving on a circle of radius R. The electro-
magnetic force which one of the two particles (designated
with ”T”, i.e. the test particle) feels, due to the inter-
action with the other one (designated with ”S”, i.e. the
source particle), is given by

F (rT, t) = eE(rT, t) + ecβT × B(rT, t),

(1)

where rT is the position of the test particle, e is the
electron charge with its own (negative) sign, βT is the
velocity of the test particle normalized to the speed of
light, c, while E(rT, t) and B(rT, t) are, respectively,
the electric and the magnetic ﬁeld generated at a given
time t by the source particle S, at the position of the test
particle T, namely

E(rT, t) =

1
γ2
S

e
4πε0 (
ˆn ×

+

1
c

ˆn − βS
ST (1 − ˆn · βS)3

R2

(ˆn − βS) × ˙βS
RST (1 − ˆn · βS)3
h

i

)

(2)

and

B(rT, t) =

ˆn × E(rT, t) .

(3)

1
c

Here βS and ˙βS are, respectively, the dimensionless ve-
locity and its time derivative at the retarded time t′,
RST is the distance between the retarded position of the
source particle and the present position of the test elec-
tron, ˆn is a unit vector along the line connecting those

two points and γS is the usual Lorentz factor referred to
the source particle at the retarded time t′.

The transverse direction (on the orbital plane) is, by
deﬁnition, orthogonal to βT. The transverse component
of Eq. (1) can be written as the sum of contributions
from the velocity (”C”, Coulomb) and the acceleration
(”R”, Radiation) ﬁelds, namely

where

F⊥(rT, t) = F⊥C(rT, t) + F⊥R(rT, t),

(4)

and

F⊥C(rT, t) =

e2
4πε0

n⊥ (1 − βS · βT) − β⊥S (1 − ˆn · βT)

SR2
γ2

ST (1 − ˆn · βS)3

F⊥R(rT, t) =

n⊥

ˆn · ˙βS

e2
4πε0 "

(cid:16)

(1 − βS · βT) − β⊥S

ˆn · ˙βS
RST (1 − ˆn · βS)3
(cid:16)

(cid:17)

(cid:17)

(1 − ˆn · βT)

˙β⊥T (1 − ˆn · βT) + ˆn⊥

βT · ˙βS

−

RST (1 − ˆn · βS)2
(cid:16)

567QA

6

D V
7

b 7

6¶

b 6¶

5

2

F⊥C =

e2
4πε0

1 + β2 − 2β cos(φ/2)
4R2γ2 sin(φ/2)(1 − β cos(φ/2))3 ,

(7)

F⊥R =

e2
4πε0

β2
2R2

"

1
sin(φ/2) (1 − β cos(φ/2))

−

(1 − β2) sin φ/2
(1 − β cos(φ/2))3

.

#

(8)

If we now assume a small retarded angle (φ ≪ 1), which
is justiﬁed in the ultrarelativistic case, we can expand
Eq. (7) and Eq. (8) to the second non-vanishing order
in φ thus obtaining

FIG. 1: Geometry for the two-particle system in the steady
state situation, with the test particle ahead of the source.
Here T is the present position of the test particle, S is the
present position of the source, while S’ indicates the retarded
position of the source.

and

F⊥C ≃

e2γ3
4πε0R2 ΦC( ˆφ)

Let us ﬁrst consider the case in which the test particle is
in front of the source. In this case, referring to Fig. 1, we
can deﬁne with ∆s the curvilinear distance between the
present position of the test and of the source particle; φ
will indicate, instead, the angular distance between the
retarded position of the source and the present position of
the test electron, and it will be designated as the retarded
angle.

In the following we will assume βS = βT = β. This hy-
pothesis will naturally lead, further on, to the assumption
of a zero energy-spread when one considers the evolution
of an electron bunch, and, as already discussed in Sec. I,
it is consistent with our choice to analyze only the elec-
trodynamical aspect of the problem. Upon this we can
write Eq. (5) and Eq. (6) in the following way:

and

F⊥R ≃

e2γ3
4πε0R2 ΦR( ˆφ) ,

where we deﬁne ΦC and ΦR as

ΦC( ˆφ) =

ˆφ2
ˆφ(1 + ˆφ2/4)3

ΦR( ˆφ) =

2 − ˆφ2 + ˆφ4/8
ˆφ(1 + ˆφ2/4)3

.

Here and above ˆφ = γφ. This normalization choice, al-
ready treated in [3], is quite natural, 1/γ being the syn-
chrotron radiation formation-angle at the critical wave-
length. In the derivation of Eq. (9) and Eq. (10) (and

4

(5)

(cid:17)

.

#
(6)

(9)

(10)

(11)

(12)

f
5

in the following, too) we understood ˆφ ≫ 1/γ, which
is again justiﬁed by the ultrarelativistic approximation.
Moreover, it is important to realize that the assumption
φ ≪ 1 is by no means a restrictive one, since it keeps
open the possibility of comparing φ with the formation
angle 1/γ (note that a deﬂection angle smaller or bigger
than 1/γ is characteristic of the cases, respectively, of
undulator or synchrotron radiation).

The following expression can be then trivially derived,
which is valid for the total transverse force felt by the
test particle

D VA A
D V))D
((D

(cid:20)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

where Φ is deﬁned by

F⊥ ≃

e2γ3
4πε0R2 Φ( ˆφ) ,

Φ( ˆφ) =

2 + ˆφ4/8
ˆφ(1 + ˆφ2/4)3

,

φ
2

Rφ3
24

.

(14) is completely independent of the
Note that Eq.
parameters of the system:
it is then straightforward to
study the asymptotic behaviors of Φ. In order to do so,
just remember that the retardation condition linking ∆s
and φ is given by (see [3])

∆s = Rφ − 2βR sin

,

(15)

or its approximated form

∆s = (1 − β)Rφ +

(16)

It is now evident that Φ(∆ˆs) → 1/(3∆ˆs) when ˆφ ≫ 1
and Φ(∆ˆs) → 1/(∆ˆs) when ˆφ ≪ 1, having introduced
the normalized quantity ∆ˆs = (γ3/R)∆s. This normal-
ization choice is linked to the fact that the critical syn-
chrotron radiation wavelength, R/γ3, is also the minimal
characteristic distance of our system: two particles nearer
than such a distance can be considered as a single one ra-
diating, up to the critical frequency, with charge 2e (see
[3]).

The asymptotic behavior above suggests to study the
function Φ(∆ˆs)∆ˆs. We plotted such a function in Fig. 2
(together with the radiative contribution alone) for val-
ues of ∆ˆs running from 0 to 5.

It is interesting to underline the fact that, as one can
see from Fig. 2, the transverse force is always centrifugal,
for any distance between the two particles. This fact can
be explained by means of a simple relativistic argument
which holds, qualitatively, for all particle distances:
in
order to build the two-particle system, i.e. to bring them
together, one needs to work against the electromagnetic
ﬁeld. Then, the total mass of the system accounts for
this interaction energy too, and is therefore bigger than
the simple sum of the particles masses. Hence, also the

(13)

(cid:20)

(cid:21)

(cid:22)

(cid:23)

(cid:24)

D VA

FIG. 2: Plot of Φ(∆ˆs)∆ˆs (solid line) and comparison with
the asymptotic values, 1 and 1/3. The dashed line shows the
radiative contribution ΦR(∆ˆs)∆ˆs alone.

(14)

equilibrium orbit radius must be bigger than R, and a
centrifugal self-force is to be expected.

It is also worthwhile to note that ΦR has the same
asymptotic behavior as Φ, and that ΦC gives impor-
tant contributions to Φ only for values between the two
asymptotes (see Fig. 2). This may ﬁnd intuitive expla-
nation in the following reasoning. As is well known (see,
for example, [15]), the velocity ﬁeld of an ultrarelativistic
electron is radial, with respect to the ”virtual” position
which the particle would assume if it moved with con-
stant velocity starting from the retarded point, but the
line forces are not isotropically distributed, and resemble
more and more the plane wave conﬁguration as β → c.
Therefore, the test particle is inﬂuenced by the velocity
ﬁeld of the source particle only when such a ﬁeld ”shines
right on the test electron” (quoted from [4]), which does
not happen for asymptotic values of ˆφ.

Let us now analyze, in the framework of our line model,
the case in which the source particle is in front of the test
particle. The geometry is qualitatively sketched in Fig.
3.

The diﬀerence with respect to the situation in which
the test electron is in front of the source is that the test
electron ”runs against” the electromagnetic signal emit-
ted by the source, while in the other case it just ”runs
away” from it. Therefore the relative velocity between
the signal and the test electron is equal to (1 + β)c, in-
stead of (1 − β)c in the other situation. Hence the retar-
dation condition reads

∆s = Rφ + 2βR sin

(17)

φ
2

or, solved for φ in its approximated form,

φ ≃

∆s
R(1 + β)

.

(18)

F
F
D
7

567Q
A

6¶

b 6¶

6

b 7

5

D V

2

6

and y, individuated by the tensor indexes 1 and 2), thus
giving a vanishing integral contribution. All the quanti-
ties between round brackets are calculated in the system
rest frame.

On the other hand, the total energy of the system turns

out to be (see, again, [15]):

Usyst = γ

2mc2 + U − β2

T33 dV

,

(21)

(cid:18)

Z

(cid:19)

where, again, the quantities between round brackets are
calculated in the system rest frame.

It is now easy to calculate U and T33 in the rest frame.
The electromagnetic interaction energy is given by the
work done against the ﬁeld to bring the two particles
together from a situation in which they are separated by
an inﬁnite distance:

U ≃

e2
4πε0γ∆s

.

(22)

FIG. 3: Geometry for the two-particle system in the steady
state situation, with the source particle ahead of the test one.
Here T is the present position of the test particle, S is the
present position of the source, while S’ indicates the retarded
position of the source.

In this situation, βS is almost parallel to (and equal to)
βT and antiparallel to ˆn: it turns out that the only im-
portant contribution to the transverse force is given by
the second term on the right side of Eq. (6), and it is
easy to check that

In order to calculate T33, we can consider the electrostatic
stress tensor alone because in the rest frame, at short
distance γ∆s ≪ R/γ2, the radiative ﬁeld contributions
are unimportant and, on the other hand, the external
magnetic ﬁeld has zero component along the direction of
motion. Now, the electrostatic stress tensor is given by

F⊥ ≃

e2
4πε0R∆s

.

It may be worthwhile to underline that the force in Eq.
(19) is, evidently, of the same magnitude as the force in
Eq. (13).

As a note to the entire steady-state case discussion,
let us provide an interpretation for the electromagnetic
transverse forces from the viewpoint of relativistic dy-
namics in the limit ∆s ≪ R/γ3. In such a situation the
two electrons are near enough to consider them travelling
with the same velocity vector. One can, then, analyze the
situation in the rest frame of the two-particle system. By
means of a Lorentz transformation, one can ﬁnd that the
total momentum of the system in the laboratory frame
and in the direction of motion (let us call it z -direction),
is given by (see [15]):

1
c2

Z

(cid:18)

(cid:19)

where the integration (in Eq.
(20) and below) is per-
formed over all space. Here m is the electron rest mass,
U is the electromagnetic interaction energy of the system
and T33 is the component of the electromagnetic stress
tensor corresponding to the ﬂux of the z -component of
the total momentum along the z direction. It is worth-
while to remark that we do not have to include T13 and
T23 (corresponding anyway to momentum ﬂux in the z-
direction) in the calculation of Pz because they are anti-
symmetric in z (as well as in the other two directions, x

(19)

Tij = ε0(EiEj − δijE2/2) ,

(23)

where i, j = 1... 3. For us, the only interesting compo-
nent is

T33 = +E2

z − E2/2 .

(24)

It can be proven that

T33 dV = −U .

(25)

Z

Now, the equations for the momentum and the energy

of the system in the laboratory frame read:

Pz = γ

2m + 2U/c2

βc ,

(26)

Usyst = γ

2mc2 + U (1 + β2)

.

(27)

(cid:2)
From the transverse component of the equation of motion
for the system one gets

(cid:3)

F⊥syst ≃ 2eBβc − 2

(28)

e2
4πε0R∆s

which justiﬁes Eq. (19) and the asymptotic behavior for
short distance between the particles of Eq. (13).

Pz = γ

2m + U/c2 −

T33 dV

βc ,

(20)

and

(cid:0)

(cid:1)

f
The discussion above underlines the fact that, in or-
der to get a correct dynamical interpretation of the elec-
trodynamical transverse forces on the two particles, one
needs to account for the self-interaction energy and mo-
mentum ﬂux of the system. Nevertheless, by doing this,
one can easily ﬁnd that the energy of our system (divided
by c) and its momentum do not constitute a four-vector
anymore, as it is seen directly from Eq.
(20) and Eq.
(21). At the beginning of the 20th century a similar prob-
lem was encountered by people trying to build a classical
model of the electron: in that case, the solution was the
introduction of the Poincar´e stress tensor (see, among
others, [15] or [16]) , which granted stability to the sys-
tem and recovered covariance for the energy-momentum
pair. As said in [15]: ”It is not unreasonable then to in-
clude Poincar´e stresses in our classical models of charged
particles, or at least to remember that care must be taken
in discussion of purely electromagnetic aspects of such
models”.
In our case we deal with a completely elec-
trodynamical system, so that there is no straightforward
way to introduce the analogue of Poincar´e stresses: nev-
ertheless one must take care and remember that, within
our accuracy, energy and momentum are no longer form-
ing a four-vector. It might be worthwhile to underline
the fact that, in modern physics of particle acceleration,
problems which have been of pure academic importance
for about one hundred years are now becoming of prac-
tical importance.

III. TRANSVERSE INTERACTION BETWEEN
AN ELECTRON AND A BUNCH MOVING IN A
CIRCLE

In this Section we discuss the transverse force felt by
an electron due to the interaction with a line bunch (with
rectangular density distribution) moving in a circle. The
geometry is described in Fig. 4, and will be considered
rigid, i.e. ﬁxed during the entire evolution of the system.
This fact means that we will have zero energy-spread in-
side our bunch and this is in agreement with our model
choice in Section II and our program of a pure electrody-
namical analysis, without dynamical aspects.

Before beginning actual calculations, we provide here
a discussion about the applicability region of our line
In the case of contributions from particles be-
model.
hind the test particle, the region of applicability of the
line model follows straightforwardly from the retarda-
tion condition: one can easily check that the inclusion
of a transverse dimension of the bunch, already desig-
nated with h in Section I, adds to Eq.
(16) the term
of magnitude h2/(Rφ). Such a term is negligible with
respect to the others in the retardation condition, when-
ever h ≪ R/γ2, which speciﬁes the region of applicability
of our model as regards the transverse bunch size.

The situation becomes more complicated when one
considers contributions from electrons in front of the test
particle. In fact, in the case ∆s < 0 (source particle in

7

front) and |∆s| < h, we have a situation in which the
test electron overtakes the source before it is reached by
the electromagnetic signal: this means that, even if the
test particle is behind the source, the present position of
the test particle is, anyway, in front of the retarded posi-
tion of the source. Then, it is possible to show that the
line model constitutes a valid description of the situation
only when |∆s| ≫ h. The cases that do not verify such
a condition are left for future study.

D VPD[

l 00

7

V

D VPLQ

FIG. 4:
Schematic of the test electron T and the stepped-
proﬁle bunch; ∆smin indicates the distance between the elec-
tron and the head of the bunch; ∆smax is the sum of the
bunch length and ∆smin

Now, in order to actually evaluate the transverse elec-
tromagnetic force which the bunch exercises on the test
particle one has to sum up the contributions from all the
retarded sources. Since the two-particle interaction has
been calculated in Section II as a function of the retarded
angle φ, it is convenient to switch the integration variable
from ∆s to φ,

d∆s
dφ

(cid:18)

φ
2

(cid:19)

= R

1 − β cos

(29)

being the Jacobian of the transformation. Therefore,
from Eq. (7), Eq. (8) and Eq. (29) one has

F B

⊥C =

φmax

φmin

Z

F⊥C(φ) R (1 − β cos(φ/2)) dφ =

=

e2λ0
4πε0R

1
2γ2

−

β
1 − β cos(φ/2)

− ln(tan(φ/4))

(30)

φmax

φmin

(cid:21)

(cid:20)

φmax

and

F B

⊥R =

φmin

Z

=

e2λ0
4πε0R

(cid:20)

F⊥R(φ) R (1 − β cos(φ/2)) dφ =

β2 ln(tan(φ/2)) +

β(1 − β2)
1 − β cos(φ/2)

φmax

φmin

(cid:21)

,(31)

l
l
l
where the superscript ”B” stands for ”bunch”, and λ0
is the constant linear density of the bunch.
If we now
expand in φmin ≪ 1 and φmax ≪ 1 the trigonometric
functions in Eq. (30) and Eq. (31) we have

F B

⊥C ≃

e2λ0
4πε0R "

−

1
γ2 ln

φmax
φmin (cid:19)

(cid:18)

−

1
2γ2

(cid:18)

1

−

1

1 − β + βφ2

max/8

1 − β + βφ2

min/8

(32)

(cid:19) #

and

and

F B

⊥R ≃

e2λ0
4πε0R "

ln

φmax
φmin (cid:19)

(cid:18)

+

1
γ2

(cid:18)

1

−

1

1 − β + βφ2

max/8

1 − β + βφ2

min/8

.(33)

(cid:19) #

The second term on the right side of Eq. (32) is centrifu-
gal, as well as the ﬁrst one on the right side of Eq. (33).
The other ones are centripetal. Note that the logarith-
mic term in Eq. (32) is unimportant (in the limit of large
values for γ) with respect to the one in Eq. (33), while
the second term in Eq. (32) modiﬁes for a factor 1/2 the
analogous centripetal term in Eq. (33). Therefore, the
total transverse force on the test electron is given by:

F B

⊥ ≃

e2λ0
4πε0R "

ln

ˆφmax
ˆφmin !

 

4
4 + ˆφ2

+

 

max

−

4
4 + ˆφ2

,

min !#

(34)
which is the sum of a logarithmic centrifugal term and a
centripetal term. It is easy to check that Eq. (34) can
be also obtained by direct integration of Eq.(13).

A natural assumption is to consider our bunch density
such that there are many particles within a distance R/γ3
which, as it has already been underlined, is the minimal
characteristic distance of the system: if the test particle
is to be considered at the head of our bunch, then it
is straightforward to assume ∆smin ≪ R/γ3 which, by
(16), gives us
means of the retardation condition Eq.
back the condition: φmin ≪ 1/γ, the non-linear term in
φmin of Eq. (16) being, in this case, negligible.

Under the latter assumption we can easily investigate
the two cases of a short bunch, that is φmax ≪ 1/γ (in
which the linear term in φmax of Eq. (16) dominates),
and of a long bunch, that is φmax ≫ 1/γ (in which the
linear term in φmax of Eq. (16) is negligible). These two
cases correspond, of course, to the asymptotic situations
for the two-particle interaction discussed in Section II.

Let us consider ﬁrst the case φmax ≪ 1/γ. Eq. (32),

Eq. (33) and Eq. (34), then, read

F B

⊥C ≃

e2λ0
4πε0R "

−

1
γ2 ln

ˆφmax
ˆφmin !

 

+

ˆφ2
max

1
4

#

8

≃

e2λ0
4πε0R

−

1
γ2 ln

∆ˆsmax
∆ˆsmin (cid:19)

(cid:18)

(cid:20)

+ ∆ˆs2

max

,

(35)

ln

ˆφmax
ˆφmin !

 

−

ˆφ2
max

1
2

∆ˆsmax
∆ˆsmin (cid:19)

(cid:20)

(cid:18)

− 2∆ˆs2

max

(36)

(cid:21)

#

(cid:21)

F B

⊥R ≃

e2λ0
4πε0R "
e2λ0
4πε0R

ln

≃

F B

⊥ ≃

e2λ0
4πε0R "
e2λ0
4πε0R

ln

ln

ˆφmax
ˆφmin !

 

−

ˆφ2
max

1
4

#

≃

∆ˆsmax
∆ˆsmin (cid:19)
From Eq. (37) we see that the centripetal term tends,
asymptotically, to zero as (γφmax)2.

− ∆ˆs2

(37)

max

(cid:18)

(cid:21)

(cid:20)

.

In the case φmax ≫ 1/γ, instead, we have

F B

⊥C ≃

≃

e2λ0
4πε0R

e2λ0
4πε0R "
1
γ2 ln

−

−

ˆφmax
1
γ2 ln
ˆφmin !
 
(24∆ˆsmax)1/3
∆ˆsmin

(cid:20)

(cid:18)

+ 1

#

+ 1

,

(38)

(cid:19)

(cid:21)

F B

⊥R ≃

≃

e2λ0
4πε0R

e2λ0
4πε0R "

ln

ˆφmax
ˆφmin !
 
(24∆ˆsmax)1/3
∆ˆsmin

ln

(cid:20)

(cid:18)

− 2

#

− 2

(cid:19)

(cid:21)

(39)

and

F B

⊥ ≃

e2λ0
4πε0R "

ln

ˆφmax
ˆφmin !

 

− 1

#

≃

e2λ0
4πε0R

ln

(cid:20)

(cid:18)

(24∆ˆsmax)1/3
∆ˆsmin

− 1

,

(cid:19)

(cid:21)

(40)

which means that the centripetal term saturates to a con-
stant value in the limit of a long bunch. The case of a
coasting beam (which ﬁts our particular case ˆφmax ≫ 1)
with transverse extent h ≫ R/γ2 has been discussed
in literature (see [6], [13], [14]). As already mentioned
above, the presence, in the choice of the model made in
the latter works, of a non-negligible transverse dimension
alters the structure of the retardation condition (with re-
spect to the one given in Eq. (16)), which explains why
the centrifugal part of the transverse force scales, in liter-
ature, as ln(R/h). Moreover, again because of the pres-
ence of a transverse dimension, the velocity contribution
to the transverse force can be discarded giving the same
centripetal term which we found from the radiative term
only in Eq. (39), that is −2e2λ0/(4πε0R).

Note that, in order to obtain Eq. (39), we had to inte-
grate contributions from ˆφ ≪ 1 to ˆφ ≫ 1: we can give a
simple explanation for the centripetal constant force term
just analyzing Eq. (13) and its asymptotic behaviours.
The product of Eq. (13) with the Jacobian (Eq. (29))
of the transformation between ∆ˆs and ˆφ (this product is
just the integrand in Eq. (31)) is equal, in the limits for
ˆφ ≫ 1 and ˆφ ≪ 1, to 1/ ˆφ: then we can conclude that the
logarithmic centrifugal term in Eq. (39) (as well as in Eq.
(38 and Eq. (40)) takes into account the 1/ ˆφ-behaviour
of the transverse force for the two-particle system, while
the constant centripetal term brings information about
the way in which the transverse force for a two-particle
system changes in the intermediate region between the
limits ˆφ ≪ 1 and ˆφ ≫ 1. Note, however, that there is
no physical ground to distinguish between the ﬁrst (cen-
trifugal) and the second (centripetal) term in Eq. (40):
the total force is always centrifugal, and both terms are
consequences of the integration of a unique expression
for the force between a two-particle system (which, of
course, is always centrifugal too).

IV. TRANSVERSE INTERACTION BETWEEN
TWO ELECTRONS MOVING IN AN ARC OF A
CIRCLE

We will now discuss the case of a two-particle system
during the passage from a straight path to a circular one
and from a circular path to a straight one. The four
possible cases are sketched in Fig. 5 for the case in which
the test particle is in front of the source.

The case in which both particles are in the bend, de-
picted in Fig. 5b, has already been discussed in Section
II. Moreover, note that the situation in which the source
particle is ahead of the test electron can be treated im-
mediately for all three (a, c and d) transient cases in
Fig. 5 (of course, with respect to the ﬁgure, test and
source particle exchange roles) on the basis of Eq. (19).
In fact in such a case, we can assume the retarded an-
gle φ small enough (the test particle ”runs against” the
electromagnetic signal) so that the actual trajectory fol-
lowed by the particles is not essential and one can use Eq.
(19) to describe also the transient cases. Now, the impor-
tant contribution from the source particle comes from the
acceleration part of the Lienard-Wiechert ﬁelds. Then,
within our approximations, the only non-negligible con-
tribution is constant and identical to the one in Eq. (19),
and it is present in the situation (again, with the roles
of test and source particle inverted) depicted in Fig. 5a
only (Fig. 5b is just the steady-state case).

We will discuss more extensively the consequences of

this fact in Section V.

Let us now focus on the cases in which the source par-
ticle is behind the test particle and, in particular, let us
ﬁrst deal with the case in Fig. 5a; such a situation occurs
when the following condition is met (see [3]):

∆ˆs >

+

ˆφ
2

ˆφ3
24

.

(41)

Let us designate with y the distance, along the straight

9

E6¶

\

6¶

'V

E7

E6¶

6

567Q

'V
7

567Q
5

I

2

6¶

5

I

2

E6¶

6¶

567Q
I
\\

5

E6¶

\
6¶

5

2
IP

567Q
I

2

(cid:11)D(cid:12)

E7

(cid:11)E(cid:12)

6

[
'V
7

(cid:11)F(cid:12)

6

[
'V

7

(cid:11)G(cid:12)

E7

E7

FIG. 5: Relative conﬁguration of the retarded source point
S’and the test point T for a system of two electron passing a
bending magnet.

line before the bend, between the retarded source par-
ticle and the beginning of the magnet. The retardation
condition, in its approximated form, reads (see [3])

∆ˆs ≃

ˆφ + ˆy
2

+

ˆφ3
24

ˆφ + 4ˆy
ˆφ + ˆy

,

(42)

where we introduced the normalized quantity ˆy = yγ/R,
which is just y/R normalized to the synchrotron radiation
formation angle, 1/γ.

In the situation considered, the source particle is only
responsible for a velocity contribution, therefore F⊥ =
F⊥C. By direct use of Eq. (5), one can ﬁnd the exact
expression for F⊥

10

(43)

F⊥ =

e2
4πε0γ2

β2R(1 − cos φ) − β sin φ[(y + R sin φ)2 + R2(1 − cos φ)]1/2 + R − R cos φ + y sin φ
[(y + R sin φ)2 + R2(1 − cos φ)]1/2 − βy − Rβ sin φ)3

(cid:8)

(cid:9)

Expanding the trigonometric functions in Eq. (43) and

using normalized quantities one ﬁnds:

Let us now consider the case depicted in Fig. 5c, in
which the source particle has its retarded position inside
the bend and the test particle has its present position
in the straight line following the magnet. We will de-
ﬁne with x the distance, along the straight line after the
magnet, between the end of the bend and the present po-
sition of the test particle. In this situation the following
condition is veriﬁed (see [3]):

(44)

F⊥ ≃

e2
4πε0

4γ3
R2

ˆφ(ˆy + ˆφ)2

ˆy2 + ˆy

ˆφ + ˆφ3/2

×

+ ˆφ4/4
3

(cid:16)

(cid:17)

(ˆy + ˆφ)2 + ˆφ4/4
i
h

It can be easily veriﬁed that, as it must be, Eq.
reduces to Eq. (9) in the limit y → 0.

(44)

It is now possible, by means of Eq. (44), to plot the
normalized transverse force ˆF = F⊥/[e2/(4πε0∆s)] as a
function of the position after the injection (deﬁned by the
entrance of the test particle in the hard-edge magnet) for
diﬀerent values of ∆ˆs = ∆sγ3/R.
In Fig. 6 we com-
pared such a plot with numerical results from the code
TRAFIC4 (see [1]).

Note that, at the position which corresponds to the
entrance of the retarded source in the magnet there is a
discontinuity in the plots. This is linked to our model
choice, and it is due to the abrupt (hard edge magnet)
switching on of the acceleration ﬁelds.

As general remark to Fig. 6 (and to the following ones)
it might be worthwhile to stress that the perfect agree-
ment (with graphical accuracy) between our calculations
and numerical results by TRAFIC4 provides, per se, an
excellent cross-check between analysis and simulations,
which enhance one’s level of conﬁdence on both these
approaches.

∆ˆs <

ˆφm + ˆx
2

+

ˆφ3
m
24

ˆφm + 4ˆx
ˆφm + ˆx

,

(45)

where ˆφm = γφm, φm being the angular extension of
magnet, and ˆx = γx/R (the reason for this normalization
choice for x is identical to that for y) .
The retardation condition reads

∆ˆs ≃

ˆψ + ˆx
2

+

ˆψ3
24

ˆψ + 4ˆx
ˆψ + ˆx

.

(46)

In contrast with the case of Fig. 5a, here we have contri-
butions from both velocity and acceleration ﬁeld. Again,
by direct use of Eq. (5) and Eq. (6) one can ﬁnd the
exact expression for the transverse electromagnetic force
performed by the source particle on the test particle

F⊥ = F⊥C + F⊥R ,

(47)

where

F⊥C =

e2
4πε0γ2

and

h

F⊥R =

e2
4πε0

β2
R (

h(cid:0)

R(1 − cos ψ)(1 − β2 cos ψ) − β sin ψ

(x + R sin ψ)2 + R2(1 − cos ψ)2

− βx − βR sin ψ

1/2

((x + R sin ψ)2 + R2(1 − cos ψ)2)1/2 − βx cos ψ − βR sin ψ

(cid:1)

h(cid:0)

(48)

i

3

i

−ψ

(x + R sin ψ)2 + R2(1 − cos ψ)2

+ βx + βR sin ψ

− βR(1 − cos ψ) sin ψ

1/2

((x + R sin ψ)2 + R2(1 − cos ψ)2)1/2 − βx cos ψ − βR sin ψ
h

i

(cid:1)

i

2

+

(R + x sin ψ − R cos ψ)
((x + R sin ψ)2 + R2(1 − cos ψ)2)1/2 − βx cos ψ − βR sin ψ
h

(x + R sin ψ)2 + R2(1 − cos ψ)2

1/2

i
− βx − βR sin ψ

+

3 ×

×

R(1 − cos ψ)(1 − β2 cos ψ) − β sin ψ
"

h(cid:0)

(cid:1)

.

(49)

#)

i

(cid:20)(cid:19)(cid:17)(cid:19)

(cid:24)(cid:17)(cid:19)

3DUDPHWHU(cid:29)(cid:3)D V(cid:3)g (cid:22)(cid:18)5

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:24)

(cid:20)(cid:17)(cid:19)

(cid:21)(cid:17)(cid:19)

A

)

(cid:20)(cid:17)(cid:23)

(cid:20)(cid:17)(cid:21)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:27)

(cid:19)(cid:17)(cid:20)(cid:19)

3RVLWLRQ(cid:3)DIWHU(cid:3)LQMHFWLRQ(cid:3)(cid:11)P(cid:12)

FIG. 6: Normalized transverse force ( ˆF = F⊥/[e2/(4πε0∆s)]) for a two-particle system entering a hard-edge bending magnet
as a function of the position after injection. The solid lines show analytical results; the circles describe the outcome from
TRAFIC4. We plotted several outcomes from diﬀerent values of the normalized distance between the two particles.

Expanding the trigonometric functions in Eq. (48) and

Eq. (49), and using normalized quantities one ﬁnds:

F⊥C =

2e2γ3
4πε0R2

ˆψ(ˆx + ˆψ)2

−2ˆx2 + ˆx

ˆψ3 − 2 ˆψ
(cid:16)
(cid:17)

+ ˆψ4/2

3 ,

(ˆx + ˆψ)2 + ( ˆψ2/4)(2ˆx + ˆψ)2
h

i

and

F⊥R =

2e2γ3
4πε0R2 (ˆx + ˆψ) 


ˆx2 + ˆx ˆψ(2 − ˆψ2) + ˆψ2 − 3/4 ˆψ4

(ˆx + ˆψ)2 + ( ˆψ2/4)(2ˆx + ˆψ)2

(ˆx + ˆψ)(ˆx + ˆψ/2) ˆψ2

−2ˆx2 + ˆx ˆψ(−2 + ˆψ2) + ˆψ4/2
i
h

3

(ˆx + ˆψ)2 + ( ˆψ2/4)(2ˆx + ˆψ)2
h

i

2 +

i

h



Similarly to the latter case, it can be easily veriﬁed that
Eq. (50) and Eq. (51) reduce to Eq. (9) and Eq. (10),

respectively, in the limit x → 0. Again, it is possible to
plot the normalized transverse force ˆF (deﬁned above) as

11

(50)

.



(51)


12

(cid:20)(cid:17)(cid:19)

(cid:21)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:21)

3DUDPHWHU(cid:29)(cid:3)D V(cid:3)g (cid:22)(cid:18)5

(cid:24)(cid:17)(cid:19)

A

)

(cid:19)(cid:17)(cid:23)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

(cid:16)(cid:19)(cid:17)(cid:21)

(cid:20)(cid:19)(cid:17)(cid:19)

(cid:20)(cid:17)(cid:19)(cid:19)

(cid:20)(cid:17)(cid:19)(cid:21)

(cid:20)(cid:17)(cid:19)(cid:23)

(cid:20)(cid:17)(cid:19)(cid:25)

(cid:20)(cid:17)(cid:19)(cid:27)

(cid:20)(cid:17)(cid:20)(cid:19)

3RVLWLRQ(cid:3)DIWHU(cid:3)HMHFWLRQ(cid:3)(cid:11)P(cid:12)
(cid:11)HMHFWLRQ(cid:3)DW(cid:3)V(cid:3) (cid:3)(cid:20)(cid:17)(cid:19)(cid:3)P(cid:3)(cid:12)

FIG. 7: Normalized transverse force ( ˆF = F⊥/[e2/(4πε0∆s)]) for a two-particle system leaving a hard-edge bending magnet
as a function of the position after the ejection. The solid lines show analytical results; the circles describe the outcome from
TRAFIC4. We plotted several outcomes from diﬀerent values of the normalized distance between the two particles.

a function of the position after the ejection (deﬁned by
the exit of the test particle from the hard-edge magnet)
for diﬀerent values of ∆ˆs = ∆sγ3/R. In Fig. 7 we com-
pared such a plot with numerical results from TRAFIC4.
Again, at the position which corresponds to the exit of
the retarded source from the magnet there is a discon-
tinuity in the plots. This, again, is linked to our model
choice, and it is due to the fact that, for particles on axis,
when the retarded source leaves the magnet there is only
Coulomb repulsion along the longitudinal direction.

The last case left to discuss is depicted in Fig. 5d; the
source particle has its retarded position in the straight
line before the bend, and the test particle has its present
position in the straight line following the magnet. This
case occurs when

∆ˆs >

ˆφm + ˆx
2

+

ˆφ3
m
24

ˆφm + 4ˆx
ˆφm + ˆx

.

(52)

The retardation condition reads

∆ˆs ≃

ˆφm + ˆx + ˆy
2

+

ˆφ3
m
24

ˆφm + 4 ˆφm(ˆx + ˆy)
ˆφm + ˆx + ˆy

.

(53)

In this case we have only velocity contributions. The
exact expression for the electromagnetic transverse force
on the test particle is

e2
4πε0γ2

n

F⊥ =

(R + y sin φm − R cos φm)(1 − β2 cos φm) − β sin φm

2R2 + x2 + y2 + cos φm(2xy − 2R2)

h(cid:0)

+2R(x + y) sin φm

− β(x + y cos φm + R sin φm)

2R2 + x2 + y2 + 2 cos φm(xy − R2) + 2R(x + y) sin φm

ion (cid:2)

−β cos φm(x + y cos φm + R sin φm) − β sin φm(R + y sin φm − R cos φm)

.(54)

1/2

(cid:1)

13

1/2

(cid:3)
−3

o

Expanding the trigonometric functions in Eq. (54) and
using normalized quantities one ﬁnds the following ap-

proximated expression for F⊥:

e2

F⊥ ≃

4πε0R2 8γ3(ˆx + ˆy + ˆφm)2φm

−ˆx2/2 + ˆy2/2 + ( ˆφ2

m/2)ˆxˆy + ˆx( ˆφ3

m/4 − ˆφm/2) + ˆy( ˆφ3

m/4 + ˆφm/2) + ˆφ4

m/8

×

(ˆx + ˆy + ˆφm)

m) + ˆy + ˆφm + ˆφ3

m/3

− ( ˆφ2

m/12)[12ˆxˆy + 4(ˆx + ˆy) ˆφm + ˆφ2
m]

. (55)

n

ˆx(1 + ˆφ2
h

n

i

o
−3

o

It is easy to verify that Eq. (55) reduces, respectively,
to the steady state (Eq. (32)) when x = 0 and y = 0,
to the transient case in Fig. 5a when x = 0 (Eq. (44))
and to the transient case in Fig. 5d when y = 0 (Eq.
(48)). Following the treatment of the transient situations
in Fig. 5a and in Fig. 5c it is possible to plot, for this
case too, a normalized expression for the transient force,
i.e. the usual ˆF , as a function of the curvilinear position
of the test particle (s=0 indicates the entrance of the
magnet) for diﬀerent values of ∆ˆs = ∆sγ3/R and for
diﬀerent magnet lengths. In Fig. 8, Fig. 9 and Fig. 10
we compared our analytical results with numerical results
from TRAFIC4, for the cases ∆ˆs = 0.2, ∆ˆs = 1.0 and
∆ˆs = 5.0 respectively.

V. TRANSVERSE INTERACTION BETWEEN
AN ELECTRON AND A BUNCH ENTERING A
BEND FROM A STRAIGHT PATH

In the previous Section we dealt with all the possible
conﬁgurations for a two-particle system moving in an arc
of a circle. Now, one can consider a bunch moving on
the same trajectory and calculate the transverse force on
a test particle as the sum of contributions from all the
source particles within the bunch.

As an example, we will study here the case of a bunch
entering a long bending magnet. Such a case is impor-
tant, as mentioned before, for code benchmark purposes
and for direct application in restricted regions of param-
eters (negligible transverse bunch size and bunch energy
spread).

First we will analyze the case of a bunch with rect-

angular density function, and we will assume the test
particle to be behind the bunch. Such an analysis will be
performed using our line model and it is therefore valid
only for transverse dimension of the bunch much smaller
than the distance between the test particle and the bunch
∆smin. After the discussion, in Section IV, about a two-
particle system with the test particle behind the source
electron, one is led to conclude that, within an electron
bunch, interactions between sources in front of the test
particle and the test particle itself are important and, in
general, they must be responsible, at the entrance and at
the exit of the bending magnet, for sharp changes in the
transverse forces acting on the test electron. The quan-
titative change depends, of course, on the position of the
test particle inside the bunch: the extreme cases are for
the test particle at the head of the bunch, where there
are just interactions with electrons behind the test par-
ticle (no head-tail interactions), and for the test particle
at the tail of the bunch, where all the sources are in front
of it (only head-tail interactions). It may be worthwhile
to underline that the sharp jumps in the transverse force
are expected to take place in a space interval compara-
ble, at most, with half of the bunch length, in the case
of the test electron at the tail of the bunch. In order to
show this, one can easily calculate the transverse force
acting on a test particle behind a bunch with rectangu-
lar density distribution entering a hard-edge magnet. If,
as usual, we indicate with ∆smax the distance from the
test particle to the head of the bunch and with ∆smin the
distance from the test particle to the tail of the bunch,
then one can easily derive such an expression from Eq.
(18) and Eq. (19):

F B

⊥ HT(φ) ≃

e2λ0/(4πε0R) ln [∆smax/(∆smax − Rφ(1 + β))]
e2λ0/(4πε0R) ln[∆smax/∆smin]

(

0 < φ < (∆smax − ∆smin)/[R(1 + β)]
φ > (∆smax − ∆smin)/[R(1 + β)]

,

(56)

0

φ < 0

14

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:24)

(cid:20)(cid:17)(cid:19)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

(cid:16)(cid:19)(cid:17)(cid:21)

(cid:16)(cid:19)(cid:17)(cid:23)

A

)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

3DUDPHWHU(cid:29)(cid:3)PDJQHW(cid:3)OHQJWK(cid:3)(cid:11)FP(cid:12)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:21)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:24)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:26)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:20)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:20)(cid:21)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:20)(cid:24)(cid:19)

3RVLWLRQ(cid:3)DIWHU(cid:3)HMHFWLRQ(cid:3)(cid:11)P(cid:12)
(cid:11)HMHFWLRQ(cid:3)DW(cid:3)V(cid:3) (cid:3)(cid:19)(cid:17)(cid:19)(cid:3)P(cid:12)

FIG. 8: Normalized transverse force ( ˆF = F⊥/[e2/(4πε0∆s)]) for a two-particle system crossing a hard-edge bending magnet
as a function of the position of the test particle inside the magnet in the case of a short magnet ˆφm ≪ 1. The solid lines show
analytical results; the circles describe the outcome from TRAFIC4. Here the normalized distance between the two particles is
∆ˆs = 0.2. We plotted several outcomes from diﬀerent values of the magnet length R ˆφm = 0.1, 0.2, 0.3, 0.4, 0.5, 1.0.

where ”HT” stands for ”head-tail”.

(56).

The following step is to actually plot the transverse
It is convenient to choose, as nor-
force in Eq.
malization factor for the transverse force, the value f1 =
e2λ0/(4πε0R) ln[∆smax/∆smin]. Our results, compared,
once again, with simulations by TRAFIC4, are shown in
Fig. 11 for a bunch length ∆smax − ∆smin = 100 µm,
γ = 100, R = 1 m and for ∆smin = 1 µm. This means
that, according to the validity limits of our model, this
result can be applied only when h ≪ 1 µm. Nevertheless,
this simple example shows that the code TRAFIC4 is ac-
tually able to account for head-tail interactions. Note
that, as expected, the transient has a spatial extent of
about one half of the bunch length (∆smax/(1 + β)).

We will now analyze the case of a bunch with rectan-
gular density function with the test particle in front of
the bunch, as depicted in Fig. 4. In the injection case
we have contributions from retarded sources both in the
bend and in the straight line before the bend. The contri-

bution from the retarded sources in the magnet is given,
basically, by Eq. (34), and reads

F B

⊥m ≃

e2λ0
4πε0R "

ln

ˆφmax
ˆφmin !

 

+

4
4 + ˆφ2

max

−

4
4 + ˆφ2

,

min #

(57)
where ”m” reminds that the contributions treated by Eq.
(57) are all from the ”magnet”. All that is left to do
now, is the investigation of the values which ˆφmin and
ˆφmax assume. Let us ﬁrst deﬁne with ˆφ∗ the solution
of the retardation equation ∆ˆsmin = ˆφ∗/2 + ˆφ∗3/24. If
ˆφ∗ < ˆφ, the retarded position of the ﬁrst source particle
is in the bending magnet, and ˆφmin = ˆφ∗. On the other
hand, when ˆφ∗ > ˆφ there are no contributions to the
transverse force from the bend. Next, we deﬁne with
ˆφ∗∗ the solution of ∆ˆsmax = ˆφ∗∗/2 + ˆφ∗∗3/24. Supposing
ˆφ∗ < ˆφ, if ˆφ∗∗ < ˆφ too, then all the particles contribute
from the bend, and ˆφmax = ˆφ∗∗. On the other hand, when

15

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

(cid:16)(cid:19)(cid:17)(cid:21)

A

)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:21)(cid:17)(cid:19)

(cid:20)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

3DUDPHWHU(cid:29)(cid:3)PDJQHW(cid:3)OHQJWK(cid:3)(cid:11)FP(cid:12)

(cid:19)(cid:17)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:22)

(cid:19)(cid:17)(cid:19)(cid:23)

3RVLWLRQ(cid:3)DIWHU(cid:3)HMHFWLRQ(cid:3)(cid:11)P(cid:12)
(cid:11)HMHFWLRQ(cid:3)DW(cid:3)V (cid:19)(cid:17)(cid:19)(cid:3)P(cid:12)

FIG. 9: Normalized transverse force ( ˆF = F⊥/[e2/(4πε0∆s)]) for a two-particle system crossing a hard-edge bending magnet
as a function of the position of the test particle inside the magnet in the case of a short magnet ˆφm ≪ 1. The solid lines show
analytical results; the circles describe the outcome from TRAFIC4. Here the normalized distance between the two particles is
∆ˆs = 1.0. We plotted several outcomes from diﬀerent values of the magnet length R ˆφm = 0.1, 0.2, 0.5, 1.0, 1.5, 2.0.

ˆφ∗∗ > ˆφ, we have a mixed situation, in which part of the
particles contribute from the bend and others from the
straight line before the magnet. In this case ˆφmax = ˆφ.

The contribution from the retarded sources in the

straight path before the bend is given by

F B

⊥s =

∆ˆsmax

∆ˆsmin

Z

R
γ3 F⊥(ˆy(∆ˆs), ˆφ)d∆ˆs ,

(58)

where ”s” stands for ”straight path”, and where the ex-
pression for F⊥ in the integrand is given by Eq. (44). It
is convenient, as done before, to switch the integration
variable from ∆ˆs to ˆy. The Jacobian of the transforma-
tion is given by (see [3])

d∆ˆs
dˆy

≃

( ˆφ + ˆy)2 + ˆφ4/4
2( ˆφ + ˆy)2

(59)

After substitution of Eq. (59) and Eq. (44) in Eq. (58),
one can easily carry out the integration, thus getting

F B

⊥s ≃

2e2λ0
4πε0R "

(cid:16)

4ˆy2

ˆφ
4ˆymin + 2 ˆφ + ˆφ3
min + 8ˆymin ˆφ + 4 ˆφ2 + ˆφ4
ˆφ
4ˆymax + 2 ˆφ + ˆφ3
max + 8ˆymax ˆφ + 4 ˆφ2 + ˆφ4 #

(cid:17)

(cid:17)

(cid:16)

−

4ˆy2

. (60)

As done before for ˆφmin and ˆφmax, we can now investigate
the values of ˆymin and ˆymax. Let us start with ˆymin. First,
we deﬁne with ˆy∗ the solution of the retardation condi-
tion ∆ˆsmin = ( ˆφ + ˆy∗)/2 + ( ˆφ∗3/24)(4ˆy∗ + ˆφ)/(ˆy∗ + ˆφ).
If ˆy∗ > 0, the retarded position of the ﬁrst source par-
ticle is in the straight line before bending magnet, and
ˆymin = ˆy∗. On the other hand, when ˆy∗ < 0, the re-
tarded position of the ﬁrst source particle is in the bend,
and ˆymin = 0.

Next, we deﬁne with ˆy∗∗ the solution of ∆ˆsmax =
( ˆφ + ˆy∗)/2 + ( ˆφ∗3/24)(4ˆy∗ + ˆφ)/(ˆy∗ + ˆφ). Consider the
case ˆy∗∗ < 0: all the particles contribute from the bend,

16

3DUDPHWHU(cid:29)(cid:3)PDJQHW(cid:3)OHQJWK(cid:3)(cid:11)FP(cid:12)

(cid:20)(cid:17)(cid:21)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

A

)

(cid:22)(cid:17)(cid:19)

(cid:21)(cid:17)(cid:19)

(cid:20)(cid:17)(cid:19)

(cid:24)(cid:17)(cid:19)

(cid:23)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:27)

(cid:19)(cid:17)(cid:20)(cid:19)

(cid:19)(cid:17)(cid:20)(cid:21)

(cid:19)(cid:17)(cid:20)(cid:23)

(cid:19)(cid:17)(cid:20)(cid:25)

3RVLWLRQ(cid:3)DIWHU(cid:3)HMHFWLRQ(cid:3)(cid:11)P(cid:12)
(cid:11)HMHFWLRQ(cid:3)DW(cid:3)V(cid:3) (cid:3)(cid:19)(cid:17)(cid:19)(cid:3)P(cid:12)

FIG. 10: Normalized transverse force ( ˆF = F⊥/[e2/(4πε0∆s)]) for a two-particle system crossing a hard-edge bending magnet
as a function of the position of the test particle inside the magnet in the case of a short magnet ˆφm ≪ 1.The solid lines show
analytical results; the circles describe the outcome from TRAFIC4. Here the normalized distance between the two particles is
∆ˆs = 5.0. We plotted several outcomes from diﬀerent values of the magnet length R ˆφm = 0.5, 1.0, 2.0, 3.0, 4.0, 5.0.

that is we entered the steady-state situation. In this case
ˆymax = ˆymin = 0. On the other hand, when ˆy∗∗ > 0,
we have again a mixed situation, in which part of the
particles contribute from the bend and others from the
straight line before the magnet. In this case ˆymax = ˆy∗∗.
The following step is to actually plot the transverse
force on an electron from a bunch with rectangular dis-
tribution entering a long bend. It is convenient to choose,
as normalization factor for the transverse force, the value
f = e2λ0/(4πε0R) ln(∆ˆsmax). Our results, compared,
once again, with simulations by TRAFIC4, are shown in
Fig. 12 for a bunch length of 100 µm, γ = 100, R = 1 m
and for diﬀerent values of ∆ˆs.

It is interesting to calculate the asymptotic expression
for F B
⊥s in the limit for a long bunch (∆ˆsmax ≫ 1) and for
a short distance between the test particle and the head of
the bunch (∆ˆsmin ≪ 1). First let us indicate with ˆφb the
normalized angular extension of the bunch ( ˆφb = γφb,
where φb is just the ratio between the bunch length and
the radius of the circle R). By means Eq. (42) it is easy

to prove that, when ˆφ/ ˆφb < 2−2/3, ˆymax takes bigger and
bigger values, with an upper limit ˆymax = 2∆ˆsmax. On
the other hand, when ˆφ/ ˆφb > 2−2/3, ˆymax takes always
decreasing values, with a lower limit ˆymax = 0. Assuming
ˆymin ≪ 1, one may check that, in the long bunch limit,
Eq. (60) reads

F B

⊥s ≃

(

e2λ0/(2πε0R)
0

ˆφ/ ˆφb < 2−2/3
ˆφ/ ˆφb > 2−2/3 ,

(61)

which is a boxcar function. Note that in the passage from
Eq. (60) to Eq. (61) we used the fact that ˆφ ≫ 1. In
order to visualize the limiting process we plotted, in Fig.
13, F B
⊥s, as it is given in Eq. (60) and normalized to f =
e2λ0/(4πε0R) ln(∆ˆsmax) (i.e. v = F B
⊥s/f , in the plot), as
a function of the position after injection, normalized to ˆφb
(i.e. u = R ˆφ/(γ ˆφb), in the plot). The plots in Fig. 13a,
b, c and d refer to diﬀerent bunch lengths (respectively
102µm, 103µm, 104µm and 105µm). For every choice of

17

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:19)

(cid:20)

I
(cid:18)
"
)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:20)(cid:19)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:19)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:19)(cid:20)(cid:19)

3RVLWLRQ(cid:3)DIWHU(cid:3)LQMHFWLRQ(cid:3)(cid:11)P(cid:12)
(cid:11)LQMHFWLRQ(cid:3)FRPSOHWH(cid:3)DW(cid:3)V(cid:3) (cid:3)(cid:19)(cid:17)(cid:19)(cid:3)P(cid:12)

FIG. 11: Normalized transverse force F⊥/f1 acting on a test particle behind a bunch with rectangular density distribution. As
the bunch enters a hard-edge bending magnet we plot the normalized force as a function of the position of the test particle inside
the magnet (solid line) and we compare with results by TRAFIC4 (circles). Parameters choice are: bunch length = 100µm,
γ = 100, R = 1m; the value of ∆smin is 1µm.

the bunch length we show diﬀerent outcomes for several
choices of ∆ˆsmin. As one can see from Fig. 13, in the
limit for ∆ˆsmin ≪ 1 and ∆ˆsmax ≫ 1, one approaches
the boxcar function described by Eq. (61). Note that,
here, the radius of the bend is R = 1m and γ = 100,
therefore we have 2−2/3R/γ ≃ 6.3 · 10−3m, while the
maximum value for v, due to the normalization choice,
is given, from Eq. (61), by 2/ ln( ˆ∆smin). In the case of
Fig. 13d, for example, we have 2/ ln(∆ˆsmin) ≃ 0.174 (in
agreement, of course, with the maximum value found in
the plot).

On the other hand, again in the same limits, one can
ﬁnd the asymptotic expression for the contribution from
particles with retarded position in the bend: this is given,
indeed, by Eq. (57), with the limit expressions for ˆφmin
in the case of a small distance ∆ˆsmin, and ˆφmax in the
long bunch limit. For ˆφmin we have, from the retardation
condition in Eq. (42) ˆφmin = 2ˆsmin.

For ˆφmax, if ∆ˆsmax < ˆφ3/24 we have, again from Eq.
(42), ˆφmax = ˆφb = (24∆ˆsmax)1/3. Otherwise, when

∆ˆsmax > ˆφ3/24 then ˆφmax = ˆφ, and we have the steady
state situation.

By means of these results one can build an expression
for the transverse force in the case of a bunch with general
density distribution λ, by considering it as a composition
of rectangular bunches with length (s − s′) and linear
density ds′dλ(s′)/ds′, under the constraint that the im-
portant bunches for such a composition are long enough
to neglect all linear terms in the expression for the retar-
dation condition (i.e. λ(s)γ3/R ≫ dλ(s′)/ds′, see [3]). In
this case, the contribution from particles in the straight
line reads

s−Rφ

3

/6

F B

⊥s(φ, s − s

′

)

dλ(s′)
ds′ ds

′

F tot

⊥s ≃

−∞

Z

=

e2
2πε0R

λ(s − Rφ3/6)

(62)

Note that the latter expression does not depend on

18

3DUDPHWHU(cid:29)(cid:3)D V(cid:3)g (cid:22)(cid:18)5

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:24)

(cid:20)(cid:17)(cid:19)
(cid:21)(cid:17)(cid:19)

(cid:24)(cid:17)(cid:19)

(cid:20)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

I
(cid:18)
"
)

(cid:19)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:19)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:24)

3RVLWLRQ(cid:3)DIWHU(cid:3)LQMHFWLRQ(cid:3)(cid:11)P(cid:12)

FIG. 12: Normalized transverse force (F⊥/f ) acting on a test particle from a bunch with rectangular density distribution
entering a hard-edge bending magnet as a function of the position of the test particle inside the magnet. The solid lines show
analytical results; the circles describe the outcome from TRAFIC4. We chose ∆smax = 100µm, γ = 100, R = 1 m; graphs are
plotted for several values of the parameter ∆ˆsmin.

∆smin. On the other hand the contribution from par-
ticles in the bend is

F tot

⊥m ≃

−∞

Z
s−smin

=

e2
2πε0R

−∞

Z

1
2 "

s−smin

F B

⊥m(φ, s − s

′

)

dλ(s′)
ds′ ds

′

− 1 +

ln

∆smax

1
3

24γ3
R

(cid:18)

(cid:19)

− ln

∆smin

2γ3
R

(cid:18)

(cid:19) #

dλ(s′)
ds′ ds

′

, (63)

which, instead, depends on ∆smin. It is very interesting
to show that this dependence on ∆smin cancels with the
in fact
dependence on ∆smin of the steady-state force:
this constitutes a general result independent from the
choice of the position of the test particle.
In order to
show this, let us ﬁrst note that Eq. (63) can be written

as

×

F tot

⊥m ≃

e2
4πε0R

×

+

(64)
,

)

s−smin

s−φ3R/24

( Z

′

−1 + ln( ˆφb(s
h
3
s−φ
R/24

)) − ln( ˆφmin)
i
−1 + ln( ˆφ) − ln( ˆφmin)
i
h

+

−∞

Z

′

dλ(s′)
ds′ ds
dλ(s′)
ds′ ds

′

while the steady state contribution is given by
e2
4πε0R
dλ(s′)
ds′ ds

⊥steady ≃

F tot

s−smin

−∞

×

′

−1 + ln( ˆφb(s
h

)) − ln( ˆφmin)
i

Z

×

Subtracting side by side Eq. (65) from Eq. (64), and
adding the contribution from the straight path, one ﬁ-
nally gets the following ”regularized” expression for the
transient transverse force:

′

.(65)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:27)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:27)

(cid:11)D(cid:12)

(cid:11)E(cid:12)

Y

\

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

Y

\

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)(cid:24)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:24)

’V J(cid:22)s5   (cid:19)(cid:17)(cid:20)

PLQ

’V J(cid:22)s5   (cid:20)(cid:17)(cid:19)

PLQ

(cid:22)
s5   (cid:20)(cid:19)(cid:17)(cid:19)
’V J
PLQ

’V J(cid:22)s5   (cid:19)(cid:17)(cid:20)

PLQ

’V J(cid:22)s5   (cid:20)(cid:17)(cid:19)

PLQ

’V J(cid:22)s5   (cid:20)(cid:19)(cid:17)(cid:19)

PLQ

Y

\

(cid:19)(cid:17)(cid:21)(cid:24)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)(cid:24)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:24)

Y

\

(cid:19)(cid:17)(cid:20)(cid:26)(cid:24)

(cid:19)(cid:17)(cid:20)(cid:24)

(cid:19)(cid:17)(cid:20)(cid:21)(cid:24)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:26)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:24)

(cid:19)(cid:17)(cid:19)(cid:21)(cid:24)

[

X

[

X

19

’V J(cid:22)s5   (cid:19)(cid:17)(cid:20)

PLQ

’V J(cid:22)s5   (cid:20)(cid:17)(cid:19)

PLQ

’V J(cid:22)s5   (cid:20)(cid:19)(cid:17)(cid:19)

PLQ

X

[

X

[

’V J(cid:22)s5   (cid:19)(cid:17)(cid:20)

PLQ

’V J(cid:22)s5   (cid:20)(cid:17)(cid:19)

PLQ

’V J(cid:22)s5   (cid:20)(cid:19)(cid:17)(cid:19)

PLQ

(cid:19)(cid:17)(cid:19)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:27)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:21)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:23)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:27)

(cid:11)F(cid:12)

(cid:11)G(cid:12)

FIG. 13: Plot of v = F B
⊥s/f as a function of u = R ˆφ/(γ ˆφb); here R = 1m and γ = 100. Case (a) the bunch length is 102µm,
(b) 103µm, (c) 104µm and (d) 105µm. Each case is parameterized with respect to diﬀerent values of ∆ˆsmin = γ3∆smin/R (see
the legends in the plots).

F tot

⊥ ≃

λ(s − Rφ3/6) −

e2
2πε0R "
24(s − s′)
Rφ3

s−Rφ

3

e
/24

−

1
6

−∞

Z

ln

(cid:18)

dλ(s′)
ds′ ds

′

,

#

(cid:19)

(66)

which is completely independent from ∆smin and, there-
fore, free from singularity in the limit ∆smin → 0.
It
might be worthwhile to remark that usual regularization
techniques take place, in the study of longitudinal (CSR)
self-interactions (see [3]) at the stage of the two-particle
system and before integration of the contributions from
all the retarded sources within the bunch. The situation
is reversed here, where regularization takes place after
integration.

VI. TRANSVERSE DYNAMICS AND
CANCELLATION OF CENTRIFUGAL FORCES

We will discuss here, from a qualitative viewpoint, the
eﬀect of perpendicular forces on the transverse beam dy-
namics (although, as we stated in Section I, this article is
mainly devoted to the study of electrodynamical eﬀects).
In particular we will concentrate on the controversial is-
sue of the cancellation of the centrifugal force, in the
transverse equation of motion of a particle, by the ratio
between the electron energy deviation of from its nom-
inal value and the design radius R (see [6], [12]...
[14],
[18]).

To illustrate this cancellation as it is explained in liter-
ature, let us consider a bunch moving in a circular orbit
with design radius R, and let us indicate with X the
transverse displacement of a test electron from the equi-
librium orbit. Then (see, for example, [6]), up to the
ﬁrst order in X, one can easily write the equation for the
transverse motion of the test electron as:

d2X
c2dt2 +

X
R2 =

∆E0
RE0

+

Fr
E0

,

(67)

where E0 = γ0mc2 is the design energy (which is linked
to the equilibrium radius by the relation βγ0mc = eBR),
∆E0 = (γ − γ0)mc2 is the kinetic energy deviation, from
E0 and, ﬁnally, Fr is the self-interaction force in the
transverse direction.

We already discussed (see Section III) the fact that the
transverse force on a test electron, both on-orbit (X = 0)
and oﬀ-orbit (X 6= 0) can be written, in the long bunch
limit, as the sum of two terms: a logarithmic, centrifugal
term, and a constant, centripetal one.

(67).

In [18], the case of bunch compression by means of a
magnetic chicane (at LCLS) is analyzed, and the cen-
trifugal term is told to be essentially (aside for a neg-
ligible residual) canceled by part of the ∆E0-term in
Eq.
In fact all contributions to the transverse
emittance growth are attributed to the centripetal force
”which originates from radiation of trailing particles and
depends on the local charge density along the bunch. The
maximum force takes place at the center of the bunch and
its eﬀect on the transverse emittance is estimated in the
reference. This estimate predicts an emittance growth of
≪ 1% for the worst case (last dipole of chicane-2 where
the bunch is shortest)” (quoted from [18]).

Here we will discuss this eﬀect, well known to the CSR
community as ”the cancellation eﬀect”, within the limits
of our line model, and show that, in contrast to what has
been implicitly assumed in [18], it has no general validity.
As a general remark to all the previous analysis of the
problem, we must say that, up to now, only the situation
of sources behind the test particle has been discussed,
while we know, from Section IV, that head-tail interac-
tions are present too: they are characterized, at least
within the limits of our model, by a magnitude of the
same order of the tail-head interactions and the spatial
extension of their transient is negligible (comparable, at
most, with half of the bunch length). Since this centrifu-
gal force depends on the position of the test particle along
the bunch, it will be responsible for normalized emittance
growth.

Anyway, let us consider, in particular, the tail-head
interaction problem. As underlined in Section I, the full
solution to the evolution problem is met when one is able
to solve simultaneously the equation of motion and the
equation for the electromagnetic ﬁeld. Then, in princi-
ple, we may adopt, in our discussion, two separate view-
points: in the ﬁrst one we imagine to solve, in some way,
the full evolution problem, while in the second we treat
the same situation by means of a perturbation theory
approach, assuming that, in ﬁrst approximation, the mo-
tion of a rigid bunch is driven by the external magnetic
ﬁeld alone and then calculating the perturbation to the
particle motion due to transverse self-ﬁelds: we will show
that, in both cases, the cancellation eﬀect has no general
validity.

20

Let us begin with the ﬁrst viewpoint. Generally speak-
ing, if there was complete compensation between the to-
tal transverse force and the ∆E0-term, then the particles
with the same total energy (assumed equal to the sum of
kinetic energy and potential self-energy from the bunch)
would have followed the same trajectory. Such a com-
plete cancellation would be based upon two assumptions.
Firstly, ∆E0 = −e∆Φ and, secondly, F⊥ = eΦ/R. Note
that, in this case, ∆E0 + RF⊥ = eΦ(0). This, of course,
is not the case, since the cancellation has always been
understood for the centrifugal term alone (and, anyway,
it is not complete). Moreover let us remind that, as ex-
plained in Section III, there is no physical ground to dis-
tinguish between the centripetal term and the centrifugal
one:
from a physical viewpoint there is just an overall
centrifugal force. A further subdivision is just of math-
ematical nature, and explains how the transverse force
plotted in Fig. 2 behaves from one asymptotic (short
distance between test and source particle) to the other
(large distance between test and source particle). This
fact, alone, suggests that the cancellation issue has no
general validity and that, indeed, it is artiﬁcial (as the
subdivision between centripetal and centrifugal term is)
even when it works, like in the case of a coasting beam
in a simple, circular steady-state motion.

Nevertheless, let us retain, in our terminology, the dis-
tinction between centripetal and centrifugal term. Then,
a complete cancellation between centrifugal force and po-
tential term would be based, similarly as before, upon two
facts. Firstly, ∆E0 = −e∆Φ and, secondly, F centrifugal
=
eΦ/R, at any time. Whenever one of these assumptions
is no more veriﬁed, the cancellation fails to happen.

⊥

Of course, in order to show that the cancellation ef-
fect is not valid in general, it is suﬃcient to provide a
counter-example. Let us consider, therefore, the case of
a bunch with zero initial energy spread or, more simply, a
two-particle system with the test electron in front of the
source, such that ∆γ = γ − γ0 = 0. Let us restrict to a
case in which only space charge eﬀects are important, as
concerns the longitudinal motion: therefore we consider,
in this sense, two electrons running on a straight path.

The Coulomb (space-charge) interaction changes both
the kinetic energy of the particles and their relative dis-
tance, which we will assume, initially, equal to ∆s in
the laboratory frame. Let us deal with the problem in
the (instantaneous) rest frame of the center of mass of
the system (simply designated as the rest frame, in the
following) and assume that the particles do not move
relativistically in such a frame. After a long time one
will be left, asymptotically, with two particles far away
from each other, each one with a kinetic energy equal to
e2/(8πǫ0∆
s = γ∆s. Therefore, the change
in kinetic energy of the test particle in the laboratory
frame, can be found by means of a Lorentz transforma-
tion (performed on the momentum in the longitudinal
direction):

s), where ∆

e

e

∆E0 = γ

1/2

2me2
8πǫ0γ∆s

c
β

(cid:18)

(cid:19)

=

c
β

γme2
4πǫ0∆s

(cid:18)

(cid:19)

1/2

.

(68)

On the other hand, again in the asymptotic limit, the
potential energy of the test electron (as well as the one
of the source) will approach zero. Then, at least after a
long time from the beginning of the evolution, one has

∆E0(t → ∞) 6= −e∆Φ(t → ∞) = eΦ(0) .

(69)

This means that the ﬁrst assumption for the cancellation
(∆E0 = −e∆Φ at every time) is violated, due to the in-
clusion of space charge forces in the longitudinal motion;
as a result we can say that there is no cancellation eﬀect.
Of course, one could also treat the situation of a circu-
lar motion, which is more complicated, but the example
we gave is suﬃcient to show that the eﬀect is not valid
in general.

We are now left to deal with the second viewpoint.
As it has already been said above, by following this ap-
proach, we assume that, in zero approximation, the par-
ticles move under the action of the external ﬁeld alone
and then, once the particles motion is ﬁxed (in the ze-
roth order), one can calculate the perturbation to such a
motion due to self-ﬁelds. Note that, if one treats in this
framework the example of a coasting beam or of a rigid
line bunch with ﬁnite longitudinal dimension, then Φ is
constant, which suggest there are no more contradictions
with the cancellation assumptions. Nevertheless we will
now show that cancellation is far from being a general
eﬀect. Let us study, ﬁrst, the case of a rigid bunch. Con-
sider, for example, the two cases of a rigid line bunch
oriented either along the velocity or perpendicular to it
(see Fig. 14).

For simplicity we can study the non-relativistic case:
in the relativistic one we have an analogous situation.
The kinetic energy of the line bunch and the scalar po-
tential acting on each particle do not depend on the ori-
entation of the bunch with respect to the velocity vector.
If the cancellation eﬀect had general validity, also the
transverse self-force should not depend on the orienta-
tion but, indeed, one can easily verify that, for the case
of the line bunch oriented along the perpendicular direc-
tion (see Fig. 14b), the self-interaction force is two times
smaller than in the case of orientation along the longitu-
dinal direction. In fact, in the case of the bunch oriented
in the longitudinal direction we have repelling forces par-
allel to the velocity vector while, in the other case, they
are perpendicular: according to Eq. (23), the momen-
tum ﬂux along the parallel direction (that is T33) is then
equal to the potential energy but having opposite sign in
the ﬁrst case, and equal to zero in the second. This fact
shows that the cancellation eﬀect has no general validity.
This can be discussed in a somewhat deeper way too.
As we showed in Section II, in order to get a correct dy-
namical interpretation of the electrodynamical transverse

21

O

O

R

R

(a)

(b)

FIG. 14: Schematic of a line bunch in a circular trajectory;
(a) the line bunch is oriented along the velocity; (b) the line
bunch is oriented perpendicularly with respect to the velocity.

forces for a two-particle system, one needs to account for
the self-interaction energy and momentum ﬂux and, by
doing so, the energy and momentum of the system do
not form a four-vector anymore (as, instead, people al-
ways assume in considering the cancellation issue). They
are, indeed, components of a second rank tensor (the
energy-momentum tensor) and, therefore, transform in a
diﬀerent way with respect to a four-vector: this is the
conceptual reason which explains why the cancellation is
not a fundamental eﬀect; as soon as one cannot consider
energy and momentum as a four-vector anymore the can-
cellation is spoiled, in general, by the T33 component of
the stress tensor in the rest frame.

Also the analysis of the transient behavior leads to the
conclusion that the compensation is not of general im-
portance. Let us consider the case of a bunch entering
a bend (which we discussed in Section V, in the labo-
ratory frame. The formation length for both the scalar
potential and the transverse force (after which the bunch
reaches the steady state situation) is simply the over-

b
b
b
b
taking length 2(3sR2)1/3. Now, on the one hand the
transverse force is zero at the beginning of the bend, and
relaxes to a γ-independent value in the steady-state situa-
tion while, on the other hand, the scalar potential starts
from a γ-dependent value before the bend and relaxes
to a γ-independent value in the steady state regime too.
Comparing the two transients for the scalar potential and
for the transverse force, we can therefore conclude that
the ﬁrst one is characterized by an additional free param-
eter (the initial value of the beam energy) with respect
to the second, and this means that the two transients are
completely independent. As a result, again, the compen-
sation proves to fail in this case (since it should follow
from the subtraction of the centrifugal force with the
term, in ∆E0/(RE0), proportional to eΦ/R). Of course,
again, from a more general viewpoint, the failure of the
cancellation can be just seen as a consequence of the fact
that energy and momentum are components of a tensor,
and not of a vector, that is as a consequence of the dif-
ferent geometrical nature of a vector with respect to a
tensor.

As a last example, one can study, again in the per-
turbative framework, the case of a beam with an initial
kinetic energy chirp (which encompasses the bunch com-
pression case) or, equivalently, the case of two electrons
moving on rectilinear trajectory in such a way that that,
for the test particle,

∆Tchirp ≡ ∆γ(0)mc2 ≫

,

(70)

1/2

γme2
4πǫ0∆s

c
β

(cid:18)

(cid:19)

which justiﬁes the perturbative approach.

It is possible to demonstrate that, in ﬁrst order in the
self-ﬁelds, space charge induces a change in kinetic en-
ergy, in the laboratory frame, given by

∆E0 =

γme2
4πǫ0∆s

c
β

(cid:18)

1/2

1/2

∆Tchirpe2
8πǫ0∆s

/∆Tchirp ,

(cid:19)

(cid:18)

(cid:19)

(71)
where we started from the rest frame, we used a ﬁrst or-
der expansion in the kinetic energy diﬀerence, ∆Tchirp,
and, ﬁnally, a Lorentz transformation to the laboratory
frame. Eq. (71) shows that ∆E0 includes a free parame-
/∆Tchirp) which de-
ter (equal to
pends on the energy chirp. This makes the assumption
∆E0 = −e∆Φ incorrect and demonstrates that the can-
cellation issue does not exist at all during the bunching
process.

∆Tchirpe2/8πǫ0∆s

1/2

(cid:0)

(cid:1)

To sum up, the ﬁnal result of this investigation is that
the cancellation eﬀect has by no means general validity
and that one must exercise extreme care when dealing
with transverse dynamics issues. For example, the qual-
itative discussion in this Section shows that, in contrast
with [18], when one considers the problem of calculating
the emittance dilution in a bunch compressor, not only
centripetal force but also centrifugal contributions must

22

be taken into account. We can conclude that, in prac-
tice, the total force one has to account for is, at least, one
order of magnitude larger than the so called centripetal
force.

VII. SUMMARY AND CONCLUSIONS

In this paper we presented a fully electrodynamical
study of transverse self-forces within an electron bunch
moving in an arc of a circle. Our analysis is based on a
line-bunch model. In the case of test particles in front of
the source, our model is valid whenever h ≪ R/γ2. On
the other hand, when the source electron is in front of the
test electron, then the situation is more complicated and
the model can be applied for |∆|s ≫ h The cases that do
not fulﬁll these conditions are left for future study.

In Section II we studied, ﬁrst, the situation of a two-
particle system moving on a circular path, ﬁnding an ap-
proximated expression for the transverse self-forces which
is the product of a factor dependent on the parameters
that specify the system setup and a universal function
(i.e. a function independent of such parameters):
for
every distance between the particles we found a centrifu-
gal force, which has a qualitative and quantitative ex-
planation by means of simple arguments from relativistic
dynamics. We concluded that both the tail-head and
head-tail interactions are important: in the ﬁrst case the
Coulomb interaction plays a role besides the Radiative
one, while in the second only Radiative contributions are
present.

Further on, in Section III, after discussing the applica-
bility region of our model, we integrated the results for
a two-particle system, thus ﬁnding an expression for the
transverse interaction between a line bunch and a parti-
cle in front of it. Such an expression is structured as the
sum of a centrifugal logarithmic part and a centripetal
term, of which we studied the asymptotic behaviors in
the limit of short and long bunch, both with a small dis-
tance between the test particle and the bunch head.

In particular we found that, in the limit of a short
bunch, the centripetal force tends to zero as (γφmax)2,
while in the limit of a long bunch we found results already
well known in literature. We were able to explain the
constant centripetal term in the latter case as an overall
eﬀect of the transient between the asymptotic behavior
(identical in φ, diﬀerent in ∆s) of the transverse force
in the two-particle system, respectively for small or long
distance between the two electrons. We concluded that
the centripetal term is therefore only of mathematical
nature, and there is no physical ground to distinguish
it from the centrifugal term: from a physical viewpoint
there is, in fact, just an overall centrifugal force.

In Section IV, again within the region of applicability
of our model, we extended our considerations to a two-
particle system moving in an arc of a circle, thus ﬁnding,
for the ﬁrst time, exact and approximated analytical ex-
pressions for the transverse force in all the possible tran-

23

sient conﬁgurations (see Fig. 5), including the case in
which the source particle is in front of the test particle.
Furthermore we plotted the expression for the transverse
force in several practical cases, which are important for
a quick evaluation of the magnitude of the eﬀect and
for cross-checks between computer codes. In particular
we report a very good agreement with TRAFIC4, which
demonstrates that such a code can easily deal, from a nu-
merical viewpoint with the transverse transient problem.
In Section V, we analyzed the situation of the trans-
verse interaction between a line bunch and a test particle
moving in an arc of a circle. We treated, in particular
the case of the injection from a straight section into a
hard-edge bending magnet. Firstly we calculated exact
and approximated expressions for the transverse force;
secondly, following what we did in Section IV, we pro-
vided a few graphical examples; thirdly we analyzed our
expressions in the limit for a long bunch and a short min-
imal distance between the test particle and the head of
the bunch.

We showed that the contribution from the particles
whose retarded positions are in the straight line before
the bend is well described, as a function of the normal-
ized angular position of the test particle inside the bend,
by a boxcar function with length equal to the normal-
ized bunch angular length multiplied by a characteristic
constant which depends on the structure of the retar-
dation condition. By simple composition of rectangular
bunches we provided an expression for the calculation
of the transverse interaction in the case of a long bunch
with an arbitrary density distribution. We showed that,

in the chosen limits, the contribution from the particles
in the bend is independent from ∆smin and that, in con-
trast to this, the contribution from the particles in the
straight line is dependent on ∆smin. Finally we proved
that such a dependence can be removed by subtraction
of the steady-state transverse self-interaction, thus pro-
viding a ”regularized” expression for F⊥.

The case of injection provides a useful example for a
quick evaluation of the transverse self-ﬁelds magnitude as
well as for computer codes benchmark. By means of the
same approach one can analyze also the case of ejection,
which is left to future work.

Finally, in Section VI we proved that the partial com-
pensation of transverse self-force has by no means gen-
eral validity, and one must exercise extreme care when
dealing with transverse dynamic issues. In fact, in con-
trast with [18], we concluded that, when one considers the
problem of calculating the emittance dilution in a bunch
compressor, not only centripetal force but also centrifu-
gal contributions must be taken into account. Therefore,
in practice, the total force one has to account for is, at
least, one order of magnitude larger than the so called
centripetal force.

VIII. ACKNOWLEDGEMENTS

The authors wish to thank Reinhard Brinkmann,
Yaroslav Derbenev, Klaus Floettmann, Vladimir
Goloviznin, Georg Hoﬀstaetter, Rui Li, Torsten Lim-
berg, Helmut Mais, Philippe Piot, Joerg Rossbach, Theo
Schep and Frank Stulle for their interest in this work.

[1] K. Rothemund, M. Dohlus and U. van Rienen, in Pro-
ceedings of the 21st International Free Electron Laser
Conference and 6th FEL Applications Workshop, Ham-
burg, 1999, edited by J. Feldhaus and H. Weise

[2] Ya. S. Derbenev, J. Rossbach, E. L. Saldin and V. D.
Shiltsev, TESLA-FEL Report No. 95-05, DESY, Ham-
burg, 1995

[9] TESLA Technical Design Report, DESY 2001-011,
edited by F. Richard et al. and http://tesla.desy.de/
[10] W. Knulst, J. Luiten, M. van der Wiel and J. Verhoeven,

Applied Physics Letters 79, 2999 (2001)

[11] R. Talman, Phys. Rev. Letters, (1986)
[12] E. P. Lee, Partcle Accelerators , (1990)
[13] Y. Derbenev and V. Shiltsev,

in Fermilab-TM-1974

[3] E. L. Saldin, E. A. Schneidmiller and M. V. Yurkov, Nucl.

(1996)

Instr. Methods A 398, 373 (1997)

[14] G. Stupakov, in Proceedings of the ICFA conferfence Ar-

[4] R. Li, C. L. Bohn and J. J. Bisognano, in Proceedings of
the SPIE Conference, San Diego, 1997, vol. 3154, p. 223
[5] E. L. Saldin, E. A. Schneidmiller and M. V. Yurkov, Nucl.

Instr. Methods A 417, 158 (1998)

[6] R. Li, in Proceedings of the 2nd ICFA Advanced Accelera-
tor Workshop on The Physics of High Brightness Beams,
Los Angeles, 1999.

[7] G. Geloni, V. Goloviznin, J. Botman and M. van der

Wiel, Phys. Rev. E 64, 046504

[8] M. Borland, Phys. Rev. Special Topics 4, 070701 (2001)

cidosso, 1998

[15] John David Jackson, Classical electrodynamics, third
edition, Chapter 16, John Wiley & Sons Inc. (1998)
[16] C. M¨oller, The theory of relativity, second edition, Chap-

ter 7, Clarendon press, Oxford (1972)

[17] V. Ayvazyan et al., Phys. Rev. Lett. 88, 104802 (2002)
[18] The LCLS Design Study Group, LCLS Design Study Re-
port, SLAC reports SLAC -R521, Stanford (1998)
and http://www-ssrl.slac.stanford.edu/lcls/CDR

