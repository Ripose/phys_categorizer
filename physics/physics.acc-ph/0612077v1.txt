6
0
0
2
 
c
e
D
 
8
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
7
7
0
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

DEUTSCHES ELEKTRONEN-SYNCHROTRON

in der HELMHOLTZ-GEMEINSCHAFT

DESY 06-222

December 2006

Longitudinal Wake Field for an Electron Beam
Accelerated through a Ultra-High Field Gradient

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and
Mikhail Yurkov
DeutschesElektronen-Synchrotron DESY,Hamburg

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

Longitudinal Wake Field for an Electron Beam
Accelerated through a Ultra-High Field Gradient

Gianluca Geloni a Evgeni Saldin a Evgeni Schneidmiller a
Mikhail Yurkov a

aDeutsches Elektronen-Synchrotron (DESY), Hamburg, Germany

Abstract

Electron accelerators with higher and higher longitudinal ﬁeld gradients are desir-
able, as they allow for the production of high energy beams by means of compact
and cheap setups. The new laser-plasma acceleration technique appears to con-
stitute the more promising breakthrough in this direction, delivering unprecedent
ﬁeld gradients up to TV/m. In this article we give a quantitative description of the
impact of longitudinal wake ﬁelds on the electron beam. Our paper is based on
the solution of Maxwell’s equations for the longitudinal ﬁeld. Our conclusions are
valid when the acceleration distance is much smaller than the the overtaking length,
that is the length that electrons travel as a light signal from the tail of the bunch
overtakes the head of the bunch. This condition is well veriﬁed for laser-plasma
devices. We calculate a closed expression for the impedance and the wake function
that may be evaluated numerically. It is shown that the rate of energy loss in the
bunch due to radiative interaction is equal to the energy emitted through coherent
radiation in the far-zone. Furthermore, an expression is found for the asymptotic
limit of a large distance of the electron beam from the accelerator compared with the
overtaking length. Such expression allows us to calculate analytical solutions for a
Gaussian transverse and longitudinal bunch shape. Finally, we study the feasibility
of Table-Top Free-Electron Lasers in the Vacuum Ultra-Violet (TT-VUV FEL) and
X-ray range (TT-XFEL), respectively based on 100 MeV and 1 GeV laser-plasma
accelerator drivers. Numerical estimations presented in this paper indicate that
the eﬀects of the time-dependent energy change induced by the longitudinal wake
pose a serious threat to the operation of these devices.

Key words:
Laser-plasma acceleration, longitudinal impedance, longitudinal wake-function,
Table-Top X-Ray Free-Electron Laser (TT-XFEL)
PACS: 41.60.Ap, 41.60.-m, 41.20.-q

PreprintsubmittedtoElsevierScience

29July2013

1

Introduction

The quest for the ultimate electron accelerator will never end. A better beam
quality, a higher energy, a smaller size and lower costs will always be goals
to be pursued. In particular, size and costs are strictly related. This justiﬁes
research activities towards higher and higher longitudinal ﬁeld gradients.
The availability of higher longitudinal ﬁeld gradients is obviously related,
in its turn, to the possibility of production of beams with higher energies.

At the present day, particle accelerator technology is mainly based on Radio-
Frequency (RF) devices. However, in the past few years a novel laser-plasma
acceleration method has been developed and experimentally demonstrated
[1, 2, 3], that promises to outclass all existing accelerator technologies. The
laser-plasma acceleration technique requires an ultrashort (a few femtosec-
onds long) high intensity (Tera to Peta-Watt) laser pulse focused into a
supersonic Helium gas jet (or ﬁlled capillary) with density around 1019/cm3.
This produces a region free of electrons propagating behind the laser pulse.
Many electrons (up to 1010) are captured in this electron-free zone after about
one plasma oscillation, and eventually accelerated by the huge electric ﬁeld
produced by the positive ion background with gradients up to TV/m. Up-
to-date experimental veriﬁcations demonstrated gradients of the order of
100 GeV/m, that can potentially accelerate electrons up to energies in the
GeV-range within a few millimeters.

In this paper we study the important issue of longitudinal wake ﬁelds
produced within electron beams accelerated with high-gradient ﬁelds. We
assume that the acceleration distance da is much smaller than the the over-
taking length. This is the distance travelled by the electrons as a light signal
from the tail of the bunch overtakes the head of the bunch. Given a bunch
of rms length σz, the overtaking length can thus be written as 2γ2σz, and
corresponds to the radiation formation length 2γ2Ż calculated at Ż = σz,
Ż = λ/(2π) being the reduced radiation wavelength. When da ≪
2γ2σz, the
electrons can be assumed to be accelerated at a single position zA down
the beamline. This is the case for laser-plasma devices, since acceleration
in the GeV range takes place within a few millimeters only. However, it
is not the case for conventional accelerators, that feature typical gradients
up to a few tens of MeV/m, and thus need several tens of meters to reach
2γ2σz greatly simpliﬁes wake calcu-
the GeV range. The assumption da ≪
lations. In particular, when this condition is veriﬁed, the wake generated
along the part of the trajectory following the acceleration point zA is inde-
pendent of any detail of the particular realization of the accelerator. In this
sense, our study is fundamental, because it remains valid independently of
2γ2σz. One
the particle accelerator technology chosen, provided that da ≪
may also have contributions to the wake generated along the part of the

3

trajectory following the acceleration point zA. These contributions depend
on the physical nature of the accelerator, can be separately calculated, and
will be neglected in this paper because they do not aﬀect the bunch in the
case of a laser-plasma accelerator.

We base our study on the solution of Maxwell’s equations for the longitudi-
nal ﬁeld. With the help of the fundamental example of an electron travelling
in uniform motion we show that the paraxial approximation can be ap-
plied to describe electromagnetic sources up to the observation point, while
sources after the observation point in the beam propagation direction can be
neglected. Then we make use of the paraxial approximation to calculate the
Fourier transform of the longitudinal ﬁeld produced by ﬁxed electromag-
netic sources (current and charge densities) at a certain observation plane
down the beamline. This expression is at the basis of our treatment, because
it allows to calculate a closed expression for the longitudinal impedance and
for the wake function to be evaluated numerically. The knowledge of the real
part of the impedance further allows veriﬁcation of the energy conservation
principle. Impedance and wake function yield an analytical expression in
the asymptotic limit of a large distance of the electron beam from the accel-
erator compared with the overtaking length, i.e. in the far-ﬁeld zone for all
wavelengths of interest (up to Ż
σz). This asymptotic limit is of practical
relevance, as it allows simple estimations of the impact of the longitudinal
wake on the electron beam energy change.

∼

We give an application of our theoretical work by studying the feasibility
of Free-electron Lasers (FELs) drivers, proposed as a possible use of laser-
plasma accelerators.

Coherent sources of electromagnetic radiation have become very important
research tools in science and industry. Recent advance in conventional (RF)
particle accelerator techniques allow to construct and operate Free-Electron
Lasers in the VUV as well as in the X-ray range. Lasing at wavelengths
shorter than the ultra-violet can be achieved with a single-pass, high-gain
FEL ampliﬁer. Because of the lack of powerful, coherent seeding sources,
short-wavelength FELs work in the so-called Self-Ampliﬁed Spontaneous
Emission (SASE) mode, where the ampliﬁcation process starts from shot
noise in the electron beam [4, 5, 6]. Experimental realization of SASE FELs
developed very rapidly during the last decade. The shortest wavelength
ever generated by an FEL, λ = 13 nm, has been achieved in 2006 at FLASH
(Free-electron LAser in Hamburg). Regular user operation of FLASH started
in 2005 [7]. Currently, this facility produces GW-level laser-like radiation
pulses with 10 to 50 fs duration in the wavelength range from 13 to 45 nm.
Recently, the German government, encouraged by these results, approved
funding a hard X-ray SASE FEL (XFEL) user facility, the European XFEL [8].
The US department of Energy (DOE) has approved the start of construction

4

of the Linac Coherent Light Source (LCLS) at the Stanford Linear Accelerator
Center (SLAC) [9]. The LCLS and the European XFEL project are scheduled
to start operation in 2009 and 2013 respectively.

With the recent progress in the development of laser-plasma accelerators
[1, 2, 3] a discussion started about wether and how this technology can be
used to provide a cost-eﬀective driver for SASE FELs. The very short length
scale of plasma acceleration may eventually allow for the development of
very compact laser-like sources both in the VUV and in the X-ray range. In
this paper we will not address the delicate issue of technical realization of
such table-top FEL drivers. These should ﬁnally provide short bunches up
to about 10 fs duration in the 100 kA current class (i.e. with a charge of about
1 nC), featuring a relative energy spread of 0.1% for beam energies in the
GeV range and a normalized emittance in the order of 1 mm
mrad. Instead,
we will restrict our discussion to fundamental electrodynamical questions,
supposing that laser-plasma drivers already exist. Once this assumption is
made, there are two ways of taking advantage of such device.

·

The ﬁrst way is conservative. Up-to-date laser-plasma technology can pro-
duce beam energies up to about 1 GeV. With this energy, one may use
parameters for the system electron beam-undulator in the same range of
those at FLASH. In this fashion one may eventually achieve wavelengths
up to 5
10 nm. This application amounts to substitution of the conven-
tional accelerator system at FLASH with the table-top laser-plasma driver.
This would not lead to a table-top VUV-FEL, but it would certainly reduce
its size. The only condition for this scheme to work is that a laser-plasma
driver capable of providing the same beam parameters as the accelerator
system at FLASH must ﬁrst be built in reality.

÷

The second way is more ambitious, and consists in using laser-plasma accel-
erators in the GeV range to build Table-Top X-ray FELs by using a completely
diﬀerent set of parameters for the system electron beam-undulator. Namely,
an order of magnitude smaller electron energy, an order of magnitude larger
peak current, an order of magnitude smaller undulator parameter and an
order of magnitude shorter undulator period. The present study allows to
estimate the inﬂuence of longitudinal wake ﬁelds on the relative energy
change of the electron beam. In particular, we estimate the magnitude of
the induced correlated energy-change as a function of the position within
the bunch, as electrons travel through the undulator. This is a fundamental
eﬀect that cannot be avoided by ﬁne tuning of the parameters of the setup.
Moreover, the energy change grows during the passage of the beam through
the undulator, so that one cannot assume a ﬁxed correlated energy change
through the undulator. Our conclusion is that the magnitude of this eﬀect
poses a serious threat to the feasibility of a table-top FEL in the x-ray range
(TT-XFEL), as well as in the VUV range (TT-VUV FEL).

5

Plasma 
accelerator 

z=0

r
v

da<<2 g 2 s

z

Electron
beam

z=zo

z

Fig. 1. Geometry.

Our work is organized as follows. First, in Section 2 we calculate the lon-
gitudinal ﬁeld in the space-frequency domain. In the following Section 3
we introduce the basic quantities impedance and wake function, and we
review their relation with the Poynting theorem. In Section 4 we present an
analytical expression for the asymptotes of the longitudinal impedance in
the limit for a large longitudinal distance of the beam with respect to the
overtaking length. We further verify the energy conservation principle in
Section 5. Section 6 is dedicated to the calculation of an analytical expression
for the asymptotes of the longitudinal wake, always in the limit for a large
longitudinal distance of the beam with respect to the overtaking length.
Finally, our study about the feasibility of the TT-VUV FEL and the TT-XFEL
is given in Section 7. Section 8 concludes our work with a few ﬁnal remarks.

2 Calculation of the longitudinal ﬁeld in the space-frequency domain

Consider the scheme in Fig. 1, representing the object of our study. Consider
position zA, representing the exit of the plasma accelerator. At this position,
the nominal Lorentz factor of electrons is γ. The accelerator switches on
both harmonics of the sources and of the ﬁeld. Since we consider the wake
generated along the part of the trajectory following the acceleration point
zA, the nature of the switcher is not important. It is important, though, that
2γ2Ż, repre-
the switching process happens on a longitudinal scale da ≪
senting the distance that a light signal has to travel before it overtakes an
electron of a distance Ż = c/ω, c being the speed of light in vacuum and ω
the angular frequency of the radiation in the space-frequency domain. Sig-
niﬁcant emission of radiation in vacuum is present for wavelengths longer
. γσz
than the longitudinal bunch length σz, up to transverse beam sizes σ
⊥
as we will see. As a result, for typical ultra-relativistic beams the condition

6

2γ2Ż can be read da ≪

2γ2σz, 2γ2σz being the overtaking length.

da ≪
We begin our investigation with the help of general knowledge of electro-
magnetic theory [10], by calculating the longitudinal electric ﬁeld in the
space-frequency domain 1
o, ω) produced at frequency ω by given
electromagnetic sources in vacuum and detected at longitudinal position
zo > zA and transverse position ~ro (see Fig. 1).

¯Ez(zo, ~r
⊥

The ﬁeld in the space-frequency domain ~¯E(zo, ~r
o, ω) is the Fourier transform
⊥
of the ﬁeld in the space-time domain, ~E(zo, ~r
o, t). As is well-known, for a
⊥
ﬁxed frequency ω = ωo the ﬁeld in the space-frequency domain is strictly
related to the amplitude ~¯Eωo(zo, ~r
o) of a monochromatic ﬁeld oscillating in
time with angular frequency ω. In fact

⊥

(1)

(2)

~E(zo, ~r
⊥

o, t) = ~¯Eωo(zo, ~r

⊥

o) exp [

iωot] + C.C. ,

−

where ”C.C.” indicates the complex conjugate of the preceding term. It
follows that

~¯E(zo, ~r

o, ωo) = 2π~¯Eω(zo, ~r

o)δ(ω

ωo) .

⊥

−

⊥

Therefore, one may use the ﬁeld in the space-frequency domain for a given
frequency and yet think of the amplitude of a monochromatic ﬁeld or vicev-

1 In this paper we deﬁne Fourier transform and inverse transform pair of a function
f (t) as

¯f (ω) =

Z

dt f (t) exp [iωt] ;

f (t) =

1
2π Z

dω ¯f (ω) exp [

iωt] .

−

For future use, we also write, explicitly, the deﬁnitions of the two-dimensional
Fourier transform and inverse transform of a function g(~r) in agreement with the
one-dimensional notation:

˜g(~k) =

Z

d~r g(~r) exp

i~r

; g(~r) =

~k
i

·

h

1
4π2 Z

d~k ˜g(~k) exp

i~r

,

~k
i

·

−

h

the integration being understood over the entire plane. If g is circular symmetric
we can introduce the Fourier-Bessel transform and inverse transform pair:

˜g(k) = 2π

dr rg(r)Jo(kr) ; g(r) =

dk k ˜g(k)Jo(kr) ,

∞

Z
0

r and k indicating the modulus of the vectors ~r and ~k respectively, and Jo being the
zero-th order Bessel function of the ﬁrst kind.

1
2π

∞

Z
0

7

ersa. In fact, although they have diﬀerent dimensions, the knowledge of one
quantity fully identiﬁes the other through Eq. (2). As an example, ~¯E satisﬁes
the Helmholtz equation

c2

2~¯E + ω2~¯E = 4πc2~
∇

¯ρ

∇

−

4πiω~¯j ,

where ¯ρ(~r, ω) and~¯j(~r, ω) are the Fourier transforms of the space-time domain
charge density ρ(~r, t) and current density ~j(~r, t). In the same way, an equation
for ~¯Eω is found substituting~¯j and ρ with ~¯jω and ρω, related to~¯j and ¯ρ through
an analogous of Eq. (2).

Eq. (3) can be solved with the help of an appropriate Green’s function
G(zo −

) yielding

z′, ~r
⊥

o −

~r′

⊥

¯Ez(zo, ~r
⊥

o, ω) =

4π

−

dz′

Z

d~r′

⊥  

iω
c2

¯jz −

∂ ¯ρ
∂z′ !

G(zo −

z′, ~r
⊥

o −

~r′

⊥

) ,

(4)

∞

Z
−∞

the integration in d~r′
being performed over the entire transverse plane. An
explicit expression for the Green’s function to be used in Eq. (4) is given by

⊥

G(zo −

z′, ~r
⊥

o −

) =

~r′

⊥

−

exp

i(ω/c)

(

~r
⊥

o −

~r′

(cid:20)(cid:12)(cid:12)(cid:12)
o −

2

~r′

⊥

(cid:12)(cid:12)(cid:12)

4π

~r
⊥

(cid:20)(cid:12)(cid:12)(cid:12)

1/2

2

+ (zo −

z′)2

(cid:21)

⊥

(cid:12)(cid:12)(cid:12)
+ (zo −

1/2

z′)2

(cid:21)

)

,

that automatically includes the proper boundary conditions at inﬁnity.

Since electrons are moving along the z-axis, we write the harmonic compo-
nents of the charge and current density, ¯ρ and ¯jz as

(3)

(5)

(6)

¯ρ

z′, ~r′

(cid:16)

⊥

, ω
(cid:17)

= ρo

~r′
(cid:16)

⊥

(cid:17)

¯f (ω) exp

ωz′
v (cid:21)

i
(cid:20)

u(z′

zA)

−

and

¯jz

⊥

= βc ¯ρ .

z′, ~r′
, ω
(cid:17)
(cid:16)
Notation u(z′
zA) in Eq. (6) indicates a Heaviside step function centered
at position zA, whose presence signiﬁes that there are no sources before the
plasma accelerator, i.e. before the point z′ = zA. This describes a switch-on

(7)

−

8

≪

2γ2σz, the nature of the switcher
process. When the switching distance d
is not important for the description of the wake associated with Eq. (6) and
Eq. (7), i.e. the wake generated along the part of the trajectory following
the acceleration point zA. However, Eq. (6) and Eq. (7) alone violate the
continuity equation, and should be completed by extra-contributions that
depend on the nature of the switcher. For example, if one thinks of an
acceleration process where a low energy bunch with Lorentz factor γo is
accelerated on a distance d up to a Lorentz factor γ, one should add to Eq.
(6) and Eq. (7) the contribution of the harmonic at frequency ω associated
with the beam with Lorentz factor γo. Such harmonic is characterized by
a diﬀerent longitudinal velocity βoc with respect to βc, and by a diﬀerent
wave number ko = ω/vo. However, its amplitude is the same of that after the
acceleration process:

¯ρo

z′, ~r′
(cid:16)

⊥

, ω
(cid:17)

= ρo

~r′

¯f (ω) exp

⊥

(cid:17)

(cid:16)

ωz′
vo (cid:21)

i
(cid:20)

[1

u(z′

zA)]

−

−

and

¯joz

z′, ~r′
(cid:16)

⊥

, ω
(cid:17)

= βoc ¯ρ .

(8)

(9)

As a result, the continuity equation is satisﬁed. However, Eq. (8) and Eq. (9)
depend on the particular process described (acceleration from vo to v), so
that their contribution depends on the particular switching process selected.
In this paper we will not consider this contribution. We will focus, instead,
on the switch-independent part of the problem. Note that for the case of a
plasma accelerator, Eq. (8) and Eq. (9) should be replaced by contributions
due to a positive ion current propagating in the opposite direction with
respect to the electrons. As a result we can neglect such source, that has no
eﬀect on the longitudinal wake ﬁeld acting on the electron beam.

⊥

The assumption of separability of variables z′ and ~r′
, in Eq. (6), together
with the fact that the function ¯f is independent of z′ may be satisﬁed as
long as the transverse electron beam size σ
remains unvaried along a
⊥
formation length. This happens for an angular divergence σθ such that
σθγ2σz. Moreover, the assumption of separability also requires that
σ
⊥ ≫
we can neglect dynamical eﬀects of self-interactions, because there is no
external force acting on the bunch. In this sense, we are developing the zero-
th order treatment of a perturbation theory, where the perturbation to the
particles dynamics is given by the self-interaction within the electron bunch.
The quantity ρo has the meaning of transverse electron beam distribution;
in principle, it may depend on the harmonic ω, but in the following we will
assume it does not. Thus, all information about the longitudinal electron
density distribution f (t) is included in the function ¯f (ω), that is its Fourier

9

transform. A typical Gaussian beam model, that will be useful later on, is
deﬁned by

ρo

=

~r′
(cid:16)

⊥

(cid:17)

1
2πσ2
⊥

c

exp

"−

r′2
⊥
2σ2
⊥

,

#

being the rms beam transverse dimension and by

σ
⊥

f (t) =

e)N
(
−
√2πσt

exp

t2
2σ2

"−

t # ←→

¯f (ω) = (

e)N exp

−

ω2σ2
t
2 #

,

"−

where N is the number of electrons in the beam and (
e) the electron beam
charge. Moreover, σt is the rms bunch duration, connected with the rms
bunch length by σz = βcσt, so that in terms of lengths

−

f (s) =

e)N
(
−
√2πσz

exp

s2
2σ2
z #

.

"−

We now account for Eq. (6) and Eq. (7) and calculate the derivative of ¯ρ with
respect to z′ in Eq. (4), but keep the implicit form for G. We obtain

¯Ez =

4πiω ¯f (ω)
γ2c

Z

+4π ¯f (ω) exp

d~r′

ρo

⊥

~r′
(cid:16)

⊥

Z
zA

(cid:17)

ωzA
v (cid:21) Z

i
(cid:20)

∞

dz′ exp

ωz′
v (cid:21)

i
(cid:20)

G(zo −

z′, ~r
⊥

o −

~r′

)

⊥

d~r′

ρo

⊥

~r′

⊥

(cid:17)

(cid:16)

G(zo −

zA, ~r
⊥

o −

~r′

⊥

) .

(13)

∪

∞

[zo,

The integration domain in dz′ in Eq. (13), that is [zA,
), can be represented as
). The integral in dz′ can be written as the sum of two integrals
[zA, zo]
in dz′ performed over the separate domains [zA, zo] and [zo,
). At this point
we perform the following operations. First, we neglect the integral over the
), i.e. we neglect the eﬀects of electromagnetic sources located
interval [zo,
in [zo,
). Second, we apply the paraxial approximation. This means that we
solve, for sources located in [zA, zo], the paraxial equation

∞

∞

∞

∞

c2 exp

ω
c

i
(cid:20)

+

z
(cid:21)  ∇

2

⊥

2iω
c

∂
∂z !

~
E = 4πc2~
∇

¯ρ

−

4πiω~¯j ,

e

where we introduced the envelope of the ﬁeld components

(10)

(11)

(12)

(14)

(15)

~
E = ~¯E exp [
−

iωz/c] ,

e

10

because paraxial approximation implies a slowly varying envelope of the
ﬁeld with respect to the wavelength λ = 2πc/ω. Note that the source term of
iωz/c] with respect to that
Eq. (14) is now multiplied by a phase factor exp[
of Helmholtz equation, Eq. (3). As a result, we can obtain an expression for
Ez by formally operating in Eq. (13) in the following way. First, we restrict
the integration limits in dz′ to [zA, zo]. Second, we substitute the Green’s
e
function G with exp[
Gp, where Gp is the Green’s function for the
paraxial equation:

iωz/c]

−

−

·

Gp(zo −

z′, ~r
⊥

o −

) =

~r′

⊥

−

1
4π(zo −

exp

iω|
"

z′)

~r′
~r
o −
⊥
2c(zo −

2
⊥ |
z′) #

.

We then obtain the following expression for

Ez:

e

o, ω) =

Ez(zo, ~r
⊥
iω ¯f (ω)

e
−

−

γ2c Z

¯f (ω)
(zo −

zA)

zo

d~r′

ρo

⊥

~r′

(cid:16)

⊥

Z
zA

(cid:17)

dz′
(zo −

z′)

exp

iωz′
2γ2c

"

exp

iωzA
2γ2c # Z

"

d~r′

ρo

⊥

~r′
(cid:16)

⊥

(cid:17)

exp

iω|
"

2
⊥ |
z′) #

+ iω|

~r′
~r
o −
⊥
2c(zo −
~r′
2
~r
o −
⊥ |
⊥
zA) #
2c(zo −

,

We do not present here a general proof of the validity of Eq. (17). We rather
verify its correctness in the particular case zA −→ −∞
and ¯f (ω) = (
particle in uniform motion, calculated at position (0, ~r
⊥
limit, Eq. (17) becomes

⊥
(cid:17)
(cid:17)
e). This corresponds to Fourier transform of the ﬁeld of a
o). In the chosen

, zo = 0, ρo

~r′
(cid:16)

~r′
(cid:16)

= δ

−

⊥

Ez(0, r

o, ω) =

⊥

iω(

e)

−
γ2c

dz′

exp

1
z′

iωz′
2γ2c −

"

iω

r2
o
⊥
2cz′ #

,

e

0

Z
−∞

depending on the modulus of ~r
o only. The integral in Eq. (18) can be per-
⊥
ωz′/(2γ2c) as integration variable in place of z′
formed analytically using
and taking advantage of the following relation, that is valid for values α > 0:

−

∞

dx
x

Z
0

exp

i

x +

= 2

dξ

α
x (cid:19)(cid:21)

(cid:20)

(cid:18)−

∞

Z
0

cos

2 √αξ
(cid:16)

√1 + ξ2

(cid:17)

= 2Ko

,

2 √α
(cid:16)

(cid:17)

where Kn indicates the n-th order modiﬁed Bessel function of the second
kind. We thus obtain the following expression:

(16)

(17)

(18)

(19)

11

Ez(0, r

o, ω) =

⊥

e)

2iω(
−
γ2c

−

Ko

ωr
o
⊥
cγ !

 

,

e

in perfect agreement (aside for notational diﬀerences) with Eq. (13.80) of [10],
following directly from the Fourier transform of the time-domain electric
ﬁeld.

To conclude this Section, we give an explicit presentation of Eq. (17) in the
case zA −→ −∞
, that corresponds to the steady state solution for the electric
ﬁeld, and for zA = 0, that represents the switch-on case without loss of
generality.

In the case zA −→ −∞
the steady state limit, Eq. (17) becomes

we can make still take advantage of Eq. (19). Then, in

Ez (zo, ~r
⊥

o, ω) =

2iω
γ2c

−

exp

iωzo
2γ2c #

"

¯f (ω)

Z

d~r′

ρo(~r′

)Ko

⊥

⊥

ω

|

~r
o −
⊥
γc

 

~r′

⊥ |

e

Ez on zo is restricted
It should be noted that in this case, the dependence of
to a phase factor only (steady state solution). In the case zA = 0, direct
substitution in Eq. (17) yields

e

(20)

.

!
(21)

Ez(zo, ~r
⊥

o, ω) =

e

zo

dz′
(zo −

ω ¯f (ω)

−

γ2c Z

d~r′

ρo

⊥

~r′
(cid:16)

⊥

(cid:17)
~r′
~r
o −
⊥
2c(zo −

iωz′
2γ2c

2
⊥ |
z′) #

γ2c
ωzo

~r
⊥

~r′
o −
2czo

2
⊥ |

+

+ iω|

exp

i




exp

iω|
"

"

×

Z
0

z′)


#


(22)
2γ2Ż, Eq. (22)
It can be veriﬁed by inspection that, in the limit for zo ≫
gives back the steady state solution, Eq. (21). Eq. (21) and Eq. (22) or, more
in general, Eq. (17) can now be used to estimate the impact of the ﬁeld
generated by the electron beam on any particle in the beam. We do so with
the help of the concepts of wake ﬁelds and impedances, that are related to
the Poynting theorem as reviewed in the following Section.

,

3

Poynting theorem in the frequency domain, longitudinal wake ﬁelds
and impedances

In the time domain, the Poynting theorem [10] reads, at any time t:

12

~j

~E dV +

·

Z
V

ˆn dA +

~S

·

Z
A

d
dt Z
V

(we −

wm) dV = 0 .

(23)

Notations V and A in Eq. (23) respectively indicate any ﬁnite volume and
its surrounding surface, while ˆn denotes the ﬁeld of unit vectors normal to
A, directed outwards. In this way, the second integral in Eq. (23) represents
the ﬂux of the Poynting vector, while the ﬁrst and the second integrals are
volume integrals calculated within V. In Eq. (23) we introduced the Poynting
vector ~S and the energy densities we and wm, understanding that they all are
functions of time, in the following way:

~S =

c
4π

~E
(cid:16)

×

~B

(cid:17)

, we =

and wm =

(24)

1

2

~E

8π (cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

1

2

~B

.

8π (cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

Eq. (23) is an exact identity following from Maxwell’s equations in the time
domain. Quantities in Eq. (23) have the dimension of [energy]/[time].

As is well-known [10], a version of the Poynting theorem in the space-
frequency domain can be derived starting with the Poynting theorem in the
space-time domain formulated for a monochromatic ﬁeld like in Eq. (1) and
averaging over a cycle of oscillation in time. Then, use of Eq. (2) yields the
following complex relation for space-frequency domain quantities:

2

Z
V

~¯j ∗

~¯E dV +

·

~¯S

·

Z
A

( ¯we −

Z
V

ˆn dA + iω

¯wm) dV = 0 .

(25)

Here we deﬁne the complex, space-frequency domain version of the Poynt-
ing vector ~¯S and of the electric ¯we and magnetic ¯wm energy densities in
vacuum as

~¯S =

c
~¯E
2π (cid:18)

×

~¯B ∗

(cid:19)

,

¯we =

and ¯wm =

(26)

2

1

~¯E
4π (cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

.

2

1

~¯B
4π (cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

Eq. (25) is an exact identity following from Maxwell’s equations in the
frequency domain. Note that now quantities in Eq. (25) have the dimension
of [energy]/[frequency], i.e. of a spectral energy density integrated through
a given surface. In our case, we can separately write real and imaginary
parts of Eq. (25) as

2

Re

Z
V

~¯j ∗
(cid:20)

·

~¯E

(cid:21)

dV +

Re

dA = 0 .

~¯S
(cid:20)

·

ˆn

(cid:21)

Z
A

(27)

13

Cylindrical surface A (section)

- Accelerator -

r
v

da

z

Electron
beam

Volume V

Ao

Fig. 2. Geometry for application of Poynting theorem.

and

2

Im

Z
V

~¯j ∗
(cid:20)

·

~¯E

(cid:21)

( ¯we −

Z
V

~¯S
(cid:20)

ˆn
(cid:21)

·

Z
A

dV + ω

¯wm) dV +

Im

dA = 0 .

(28)

Eq. (27) expresses energy conservation of time-averaged quantities, while
Eq. (28) ”relates to the reactive or stored energy and its alternating ﬂow”
(cited from [10]). In our case we consider the volume V and the surface A
of cylindrical shape as depicted in Fig. 2. From Eq. (27) follows the equality
between the total energy losses of the whole bunch and the energy of co-
herent radiation in the far zone, a fact that we will verify later on. Since ~¯j is
directed longitudinally we can write such equality (always with reference
to Fig. 2) as

2

Z
V

Re

¯j ∗z

¯Ez

dV =

(cid:2)

(cid:3)

c
2π Z
Ao

−

dA ,

2

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

where
2 ¯j ∗z

~
E

⊥
e

indicates the radiation ﬁeld. The volume integral of the quantity

¯Ez can be explicitly written with the help of Eq. (22) and Eq. (7) as

(29)

(30)

2

Z
V

¯j ∗z

¯Ez dV =

X(ω)

2

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

14

where

X(ω) =

2ω
γ2 Z

−

d~r′

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

⊥

⊥

)

⊥

dz′

z

Z
0

z′

dz′′
(z′ −

iω(z′′

z′)

exp

"

z′′)

−
2γ2c

+ iω|

~r′
2
~r
o −
⊥ |
⊥
z′′) #
2c(z′ −

exp

iω|
"

~r
⊥

~r′
o −
2cz′

2
⊥ |

#

exp

iωz′
2γ2c# )

.

"−

×(

+

i

Z
0
γ2c
ωz′

Note that that ρo is a real quantity. The quantity X(ω) has the property
X(ω) = X ∗(
ω), as it can be directly veriﬁed. This means that Re[X](ω) is an
even function of ω, while Im[X](ω) is odd. X(ω) is strictly related to ∆Etot,
the total energy lost by the bunch as it travels within the volume V. In fact,
∆Etot is given by

−

∆

Etot =

c
4π Z
Ao

dA

dt

∞

Z
−∞

2

=

c
8π2 Z
Ao

~E(t)
(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)

dA

dω

∞

Z
−∞

2

.

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Comparison with Eq. (29) yields

∆

Etot =

1
2π

∞

dω

Z
−∞

Z
V

Re

¯j ∗z

¯Ez

dV =

(cid:2)

(cid:3)

∞

dω

1
4π

Z
−∞

2

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

X(ω) .

(33)

|

¯f
2 is even, Re[X](ω) is even, and Im[X](ω) is odd, we conclude that
|

Since
∆
Etot is a positive real quantity, as it must be.
As we will brieﬂy review here, X(ω) is also strictly related to the impedance
of the system. When the bunch is ultra relativistic, the longitudinal impedance
of the system, Zo(ω) is typically given as the Fourier transform of the wake
function Go(∆s), that is

(31)

(32)

(34)

Zo(ω) =

Go(∆s) exp

∆s
βc #

iω
"

,

∞

d(∆s)
βc

Z
−∞

where the wake function is deﬁned as

15

(35)

(36)

Go(∆s) =

dz′ Ez(∆s, t)

|t=z′/(βc) .

1
e)

(
−

∞

Z
−∞

Here Ez(∆s, t) indicates the longitudinal component of the time-domain elec-
tric ﬁeld generated by a source particle acting on a test particle at longitudi-
nal distance ∆s from the source. This ﬁeld is integrated along the test particle
e), so that e2Go(∆s) is the
trajectory, and divided by the electron charge (
energy (gained, or lost) by the test particle due to the action of the source. In
agreement with [11] we take the test particle behind the source for positive
values of ∆s. According to the given deﬁnition of wake function, one should
integrate the longitudinal ﬁeld over the entire trajectory. However, there is
no principle diﬃculty in considering only part of the trajectory, let us say,
up to position z. Mathematically, this means that the upper integration limit
, should be substituted with z. In this way, G = G(∆s, z).
in Eq. (35), i.e.
Moreover, our trajectory is supposed to start at zA = 0, that allows one to
substitute the lower integration limit in Eq. (35), i.e.
, with 0. We thus
obtain

−∞

∞

−

Go(∆s, z) =

dz′ Ez(∆s, t)

|t=z′/(βc) .

z

1
e)

(
−

Z
0

In both Eq. (34) and Eq. (36) we considered a case when test and source
particles move along the longitudinal z axis. More in general, we should
include given transverse oﬀsets of test and source with respect to the z axis.
Therefore we have to modify Eq. (34) and Eq. (36) to include a dependence
on such oﬀset, i.e. on the test and source transverse coordinates ~r
S:
⊥
in this way Go = Go(∆s, z, ~r
T). In order to make our deﬁnitions indepen-
⊥
dent of ~r
T and ~r
S, we integrate over the transverse particle distribution in
⊥
⊥
d~r
S. This can be interpreted as a substitution of test and source
⊥
particles with disks of charge longitudinally separated by a distance ∆s. We
thus obtain

T and d~r
⊥

T and ~r
⊥

S, ~r
⊥

G(∆s, z) =

1
e2 Z

d~r′

⊥ Z

d ~r′′

ρo(~r′

)ρo( ~r′′

)Go(∆s, z, ~r′

, ~r′′

) .

⊥

⊥

⊥

⊥

⊥

(37)

In Eq. (37) we used the fact that ρo is independent of the longitudinal posi-
tion. With the redeﬁnition in Eq. (37) we can further consider the impedance
Z(ω, z):

Z(ω, z) =

G(∆s, z) exp

(38)

∞

d(∆s)
βc

Z
−∞

∆s
βc #

iω
"

.

16

As is well-known, since G(∆s, z) is a real function one has Z(ω, z) = Z ∗(
ω, z),
i.e. the impedance has even real part and odd imaginary part. Thus, if
we split the wake function in the sum G = GS + GA of a symmetric and
antisymmetric part, the Fourier transform of GS gives back Re[Z], while the
Fourier Transform of GA yields Im[Z]. The symmetric part of the wake, GS,
is also called the active part and is related with the energy lost by the bunch
through radiation. The antisymmetric part GA instead, is called the reactive
part and is related with energy redistribution within the bunch, but not with
the energy radiated. This can be seen by writing the total energy lost by the
bunch in terms of G(τ), where τ = s/(βc):

−

∆

Etot(z) =

dt

dτ G(τ, z) f (t) f (t

τ) =

dτ G(τ, z)

[ f ](τ) ,

(39)

−

A

∞

∞

Z
−∞

Z
−∞

∞

Z
−∞

A

[ f ](τ) is
[ f ](τ) indicates the autocorrelation function of f . Since
where
even in τ, only the symmetric part GS enters eﬀectively in the expression for
∆
Etot. Finally, using the relation

A

where we used the autocorrelation theorem to ﬁnd
and Eq. (38). In the case
impedance, Eq. (34), we have

[ f ] ) ∗
A
2 = e2 (single electron), by deﬁnition of
f (ω)
|

A

|

|

[ f ] =

¯f
2 = (
|

dtg1(t)g ∗2 (t) =

dω ¯g1(ω) ¯g ∗2 (ω)

∞

Z
−∞

1
2π

∞

Z
−∞

to simplify Eq. (39) we can write

∆

Etot(z) =

dω Z(ω, z)

1
2π

∞

Z
−∞

2

,

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

Z(ω, z) =

¯j ∗z

¯Ez dV

1
e2 Z
V

and from Eq. (30) we have

Z(ω, z) =

X(ω, z) ,

1
2

17

(40)

(41)

(42)

(43)

that yields a practical algorithm to compute both real and imaginary parts
of the impedance (and, subsequently, of the wake), through the evaluation
of Eq. (31).

Finally, a word of caution. The impedance formalism is often used in order to
describe coupling impedances. A typical situation is the following. A given
electron in a bunch induces charge and current densities in the vacuum
chamber walls. In turn, these charge and current densities are responsible
for spurious electromagnetic ﬁelds acting back on electrons following the
exciting one, thus generating a coupling wake function (and thus its re-
lated coupling impedance). This coupling wake function Gc must vanish
in front of an exciting particle in the limit for γ
, i.e. for electron ve-
c. As a result one can take Gc(∆s) = 0 for ∆s < 0 (see [11]).
locities v
This property is necessary (although not suﬃcient) to demonstrate that the
coupling impedance Zc (i.e. the Fourier transform of Gc), obeys the well-
known Kramers-Kronig relation [12, 13], thus providing a link between real
and imaginary parts of the impedance. However, our impedance does not
obey Kramers-Kronig relations. In fact, we are dealing with a mechanism
of generation of the wake function that is fundamentally diﬀerent from that
of coupling wakes. In particular G(∆s) can be diﬀerent from zero both for
∆s < 0 and ∆s > 0, a result of the fact that we are dealing both with tail-head
as well as with head-tail interactions in the time domain 2 .

−→ ∞

−→

4 Analytical asymptotes of the longitudinal impedance

Let us write an explicit expression for the impedance with the help of Eq.
(31):

Z(ω, z) = Z1(ω, z) + Z2(ω, z) .

(44)

Here we have deﬁned, for computational convenience, the quantities

Z1(ω, z) =

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

⊥

⊥

)

⊥

iω
γ2 Z
−
z

d~r′

z′

dz′

Z
0

×

Z
0

⊥ Z

dz′′
(z′ −

iω(z′′

z′)

exp

"

z′′)

−
2γ2c

+ iω|

~r′′
~r′
⊥ −
2c(z′ −

2
⊥ |
z′′) #

,

(45)

2 Note that causality with respect to time remains obviously valid but it cannot
be exploited, as in the case of coupling wakes, giving a relation between real and
imaginary part of the impedance.

18

and

Z2(ω, z) =

d~r′

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

⊥

⊥

)

⊥

− Z
z

×

Z
0

dz′

exp

c
z′

~r′

⊥ −

~r′′
2cz′

2
⊥ |

#

iω|
"

exp

iωz′
2γ2c#

,

"−

(46)

Aside for particular cases, the task of calculating real and imaginary part
of the impedance must be performed numerically. It is possible, however,
to obtain important analytical information about the impedance and wake
function in the asymptotic case z

2γ2Ż from Eq. (44).

≫

4.1 Real part

Let us consider Re[Z] for z
Eq. (19), it can be shown that in the limit for z
quantity independent of z:

≫

2γ2Ż. We ﬁrst deal with Z2. With the help of
2γ2Ż, Z2 tends to a real

≫

Z2(ω) =

2c

−

Z

d~r′

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

)Ko

⊥

⊥

⊥

ω

~r′

|

 

~r′′

⊥ −
γc

⊥ |

.

!

(47)

The integral in d ~r′′
can be interpreted as a convolution product between
⊥
two functions of ~r
, i.e. ρo and Ko. This is equal to the anti-Fourier transform
⊥
in two dimensions of the product of the spatial Fourier transforms of ρo
and Ko, that we will call respectively ˜ρo(~k) and ˜Ko(~k), ~k being the conjugate
variable to ~r
one
⊥
obtains the following alternative representation of Z2:

. By exchanging the integration in d~k and that in d~r′

⊥

Z2(ω) =

c
2π2 Z

−

d~k

2

˜Ko

.

~k
(cid:16)

(cid:17)

˜ρo(~k)
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

As concerns Z1 we make use of the two identities

2πic
ω

z′′

z′z′′
z′ −
d~r
exp
⊥

Z

exp

=

~r′
iω
|
⊥ −
2c(z′ −
"−
~r′
2
~r
iω
+
⊥|
⊥ −
|
2cz′

~r′′
2
⊥|
z′′) #
~r′′
~r
iω
⊥ −
|
2cz′′

"−

2
⊥|

#

and

19

(48)

(49)

z

Z
0

g(z′) dz′

z′

Z
0

z

2

,

g∗(z′′) dz′′ + C.C. = (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Z
0

g(z) dz (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

and of Eq. (19). With the help of these relations we rewrite the real part of
Z1 in the limit for z

2γ2Ż as an expression independent of z:

≫

Re[Z1](ω) =

ω2
πγ2c Z

d~r

d~r′

ρo(~r′

)Ko

⊥

⊥

ω

|

~r
⊥ −
γc

 

Z

⊥ (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

~r′

⊥ |

2

.

!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Applying Eq. (40) with g1 = g2 to Eq. (51) and remembering that the spatial
Fourier transform of the convolution product of two function is equal to
the product of the spatial Fourier transform of the same function, we can
rewrite Eq. (51) as

Re[Z1](ω) =

ω2
4π3γ2 Z

2

.

d~k

˜ρo(~k) ˜Ko
(cid:12)(cid:12)(cid:12)(cid:12)

~k
(cid:16)

(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)

Thus, putting together Eq. (48) and Eq. (52) we obtain

Re[Z](ω) =

d~k

˜ρo(~k) ˜Ko

ω2
4π3γ2 Z

2

c
2π2 Z

−

d~k

~k
(cid:16)

(cid:12)(cid:12)(cid:12)(cid:12)
Substitution in Eq. (53) of the explicit expression for ˜Ko(~k)

(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

2

˜Ko

.

~k
(cid:16)

(cid:17)

˜ρo(~k)
(cid:12)(cid:12)(cid:12)(cid:12)

˜Ko

=

~k
(cid:16)

(cid:17)

exp

i~k

d~r
⊥

h

Z

=

2πc2γ2
ω2

~r
⊥

·

Ko 


i
1

ω

~r
⊥
(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)
γc 


,

= 2π

∞

Z
0

1 +

h

cγk/ω
(cid:1)

(cid:0)

2

i

dr

r

Ko

⊥

⊥

ωr
⊥
γc !

 

Jo(kr

)

⊥

together with the new notation ~θ = c~k/ω yields for the sum of two integrals
in Eq. (53):

Re[Z](ω) =

c
π Z

−

d~θ

2

γ4θ2
1 + γ2θ2

2 .

˜ρo(~θ, ω)
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

(cid:0)

(cid:1)

Up to now we did not make use of any particular model for the electron
beam. Choosing Eq. (10) as a model for ρo we can substitute into Eq. (55) the
following expression for ˜ρo:

20

(50)

(51)

(52)

(53)

(54)

(55)

(

Re

0,00

-0,25

-0,50

-0,75

-1,00

0,0

0,5

1,0

1,5

2,0

2,5

3,0

Fig. 3. Plot of the universal function ζRe, as a function of α.

˜ρo

~θ, ω
(cid:17)
(cid:16)

=

exp

1
c

θ2ω2σ2
⊥
2c2

#

.

"−

This gives

Re[Z] = ZoζRe(α) ,

where

α =

ωσ
⊥
γc

,

and

1
4π

ζRe(α) =

(1 + α2) exp[α2]Γ(0, α2)
o
the dimensionless parameter α is deﬁned as

1
n

−

,

21

(56)

(57)

(58)

(59)

Γ(0, x) =

∞

dt
t

Z
x

exp[

t]

−

(60)

and Zo = 4π/c indicates the free-space impedance. A plot of the universal
function ζRe(α), that is the real part of the impedance in units of Zo, is given
in Fig. 3. Note that Re[Z] exhibits a singular behavior for σ
0 (i.e. for
0 in Fig. 3). This is linked with our particular model, where we chose
α
−→
da −→
0.

⊥ −→

4.2

Imaginary part

Since, in the limit for z
that the imaginary part of Z is

≫

γ2Ż, Z2 is a real quantity, from Eq. (45) follows

Im[Z](ω, z) =

ω
2γ2 Im

d~r′

( Z

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

⊥

⊥

)

⊥

−
z

×

Z
0

dz′

dz′′

z′

Z
0

2i
(z′ −

iω(z′′

z′)

exp

"

z′′)

−
2γ2c

+ iω|

~r′′
~r′
⊥ −
2c(z′ −

2
.
⊥ |
z′′) # )

(61)

2γ2Ż one ﬁnds the same result that one would
In the asymptotic limit for z
have found calculating the impedance with the steady state expression for
the ﬁeld, Eq. (21), and substituting zo with zero that is

≫

Im[Z](ω, z) =

ω
2γ2 Im

d~r′

( Z

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

⊥

⊥

)

⊥

−
z

×

Z
0

dz′

dz′′

∞

Z
0

2i
(z′ −

iω(z′′

z′)

exp

"

z′′)

−
2γ2c

+ iω|

~r′
~r′′
⊥ −
2c(z′ −

2
.
⊥ |
z′′) # )

(62)

With the help of Eq. (19) we ﬁnd the analogous of Eq. (51) for the imaginary
part of the impedance in the asymptotic limit for z

2γ2Ż:

≫

Im[Z](ω, z) =

2ωz
γ2 Z

−

d~r′

⊥ Z

d ~r′′

ρ ∗o (~r′

)ρo( ~r′′

)Ko

⊥

⊥

⊥

~r′

ω

|

~r
⊥ −
γc

 

⊥ |

.(63)

!

Similarly as for Eq. (47), we observe that the integral in ~r′′
as a convolution. In analogy with Eq. (48) we obtain

⊥

can be interpreted

22

(

Im

0,0

-0,5

-1,0

-1,5

-2,0

0,0

0,5

1,0

1,5

2,0

2,5

3,0

Fig. 4. Plot of the universal function ζIm, as a function of α.

Im[Z](ω, z) =

ωz
2π2γ2 Z

−

d~k

2

˜Ko

.

~k
(cid:16)

(cid:17)

˜ρo(~k)
(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)

Finally, Eq. (54) together with the notation ~θ = c~k/ω yields

Im[Z](ω) =

1
π

−

ωz

Z

d~θ

2

1
1 + γ2θ2

.

˜ρo(~θ, ω)
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

(cid:0)

(cid:1)

Similarly as for the real part, use of Eq. (56) allows to give an explicit
expression for Im[Z]:

Im[Z] = (Zo ˆz) ζIm(α) ,

where

ζIm(α) =

exp[α2] Γ(0, α2) ,

1
2π

−

the dimensionless parameter α is deﬁned as in Eq. (59), Γ was given in
Eq. (60), Zo = 4π/c indicates, as before, the free-space impedance, and ˆz =

23

(64)

(65)

(66)

(67)

z/(2γ2Ż). A plot of the universal function ζIm(α), that is the imaginary part
of the impedance in units of Zo ˆz is given in Fig. 4.

Note that one may use diﬀerent models for the electron beam transverse
proﬁle to be substituted in Eq. (65). For example, one may consider a stepped
proﬁle deﬁned by

(68)

(69)

(70)

1
πr2

) =

) ,

ρo(~r
⊥

bc Crb(~r
where rb is now the beam radius and
unity for

⊥

~r
⊥|
|

˜ρo(~θ, ω) =

2
ωrbθ

J1

ωrbθ
c

(cid:18)

.

(cid:19)

< rb and zero otherwise. The analogous of Eq. (56) is

Crb(~r

⊥

) is a circle function, equal to

By substituting Eq. (69) in Eq. (65) and performing integration we recover
the already known expression for the longitudinal space-charge impedance
in case of a stepped proﬁle bunch

ZLSC(ω) =

4icz
1
ωr2
b "

−

ωrb
cγ

K1

ωrb
γc !#

,

 

−

in agreement with [14] where an expression per unit length is given, and
the overall diﬀerence of a minus sign ﬁxes the sign of the energy loss (using
the convention in Eq. (70) it is negative).

5

Energy conservation

It is interesting to verify the energy conservation law for the active part of
the ﬁeld, that is Eq. (29).

With the help of Eq. (30), Eq. (43) and Eq. (55) we can immediately write the
left hand side of Eq. (29) in its ﬁnal form as

2

Z
V

Re

¯j ∗z

¯Ez

dV =

(cid:2)

(cid:3)

2c
π

−

2

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

Z

d~θ

˜ρo(~θ, ω)
(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:0)

2

γ4θ2
1 + γ2θ2

2 .

(cid:1)

(71)

We now need to calculate the right hand side of Eq. (29). This is the spec-
tral energy density of radiation integrated over a transverse plane in the

24

≫

far zone, i.e. at a large longitudinal distance z with respect to the radiation
formation length 2γ2Ż at all wavelengths of interest, i.e. for Ż & σz. This
2γ2σz, 2γ2σz being the already-deﬁned overtaking length. Radi-
gives z
ation is generated because of the acceleration process, and is linked with
the longitudinal wakes through Eq. (29). Radiation and longitudinal wakes
should actually be seen as two faces of the same coin. We have already seen
that major simpliﬁcations arise in the calculation of the impedance (and,
therefore, of the wake) as one assumes a very short acceleration distance da
2γ2σz. In particular, in this case,
compared with the overtaking length, da ≪
the impedance does not depend on the details of the acceleration process,
that can be considered as taking place at a single point. This fact has its
reﬂection on the characteristics of radiation, that are also bound to be inde-
2γ2Ż at
pendent of how acceleration took place, always provided that da ≪
all wavelengths of interest. The acceleration process works as a switch in
the space-frequency domain, in the sense that it switches on the harmonic
contents of the electromagnetic sources at a given wavelength of interest.
As long as it takes place within a distance much smaller than 2γ2Ż, such
switching process may have very diﬀerent physical realizations. It may be
due to an ultra-high ﬁeld gradient, but also to a bending magnet deﬂect-
ing an electron beam from an oﬀ-axis trajectory to a trajectory along the z
axis, or to the crossing of an interface between two media with diﬀerent
dielectric properties. All these examples produce well-documented types
of collimated radiation in the long wavelength range (Ż & σz). Radiation
due to longitudinal acceleration is studied in [10], while if the switcher
is a bend one obtains edge radiation (see [15] among many others, and
references therein). Finally, passage through an interface between diﬀerent
media produces transition radiation. In particular, coherent transition radi-
ation in the far zone generated at the interface between plasma and vacuum
2γ2Ż) has ﬁrst been studied in [16].
in a laser-plasma accelerator (with da ≪
Characteristics of these kinds of radiation coincide as long as the switching
process obeys da ≪
In reference [17] we showed how radiation produced by a single ultrarela-
tivistic electron can be suggestively described in terms of a laser-like beam.
Once the waist of this laser beam is speciﬁed, the ﬁeld distribution at any
position down the z-axis can be found applying Fourier Optics techniques
(in free-space this amounts to the application of Fourier propagation equa-
tion). In particular, a single electron created at zA = 0 by the system depicted

2γ2Ż 3 .

3 From this viewpoint, we do not agree with [16] about the presence of diﬀraction
radiation when the electron beam is created inside the plasma. There is a principle
diﬀerence between a case when an electron travels through a foil with ﬁnite trans-
verse size and another when an electron is created at the interface between plasma
2γ2Ż radiation characteristics should not depend on the
and vacuum. When da
transverse characteristics of the plasma.

≪

25

in Fig. 2 produces a laser-like beam is with a waist located at zA = 0. As we
2γ2Ż, the ﬁeld distribution at the waist does
have just discussed, since da ≪
not depend on the realization of the accelerator setup, and coincides with
that produced by a magnet edge, or by transition radiation. It is given by
the ﬁeld distribution associated with a single electron created at zA = 0 and
travelling along the z axis [17]:

) =

s(~r
⊥

2i(

e)ω

−
c2γ

~r
⊥
r

⊥

K1

ωr
⊥
cγ !

 

.

~
E

⊥
e

(72)

In our case though, we are considering an electron beam and not a single
electron. This means that we are not dealing with a single laser-like beam
but, rather, with a coherent collection of laser-like beams. At the initial point
zA = 0 each electron is completely characterized by an oﬀset ~r′
and a
deﬂection angle ~φ′
with respect to the z axis. These two vectors identify a
point in the transverse electron phase space. Each electron, characterized by
, ~φ′
the pair (~r′
), corresponds to a diﬀerent laser-like beam, whose waist
is simply tilted of an angle ~φ′
and shifted of an oﬀset ~r′
. Accounting for
oﬀsets and deﬂections, Eq. (72) can be written as

⊥

⊥

⊥

⊥

⊥

⊥

) =

s(~r
⊥

2i(

e)ω

−
c2γ

ω
c

~φ′ ·

exp

i

(cid:20)

~r′

~r
⊥ −
(cid:16)

⊥

(cid:17)(cid:21)

~
E

⊥
e

~r′
~r′

⊥

⊥

~r
⊥ −
~r
⊥ −
(cid:12)(cid:12)(cid:12)

K1 


(cid:12)(cid:12)(cid:12)

~r′

⊥

ω

~r
⊥ −
(cid:12)(cid:12)(cid:12)
cγ

(cid:12)(cid:12)(cid:12)





. (73)

We now have to average Eq. (73) over the harmonic component of the
charge density at frequency ω, i.e. ¯ρ in Eq. (6) calculated at z′ = 0, at the
waist position. In principle, ¯ρ should depend on both ~φ′
. However,
in our model, it only depends on ~r′
). In our
⊥
situation of interest we can set ~φ′
= 0 in Eq. (73) and obtain the following
average over ¯ρ:

⊥
, since we posed ρo = ρo(~r′

and ~r′

⊥

⊥

⊥

~r′

ω

~r′
~r′

~r
⊥ −
(cid:12)(cid:12)(cid:12)
cγ

⊥

⊥

⊥

⊥

)

−

Z

~
E

d~r′

) =

(~r
⊥

¯f (ω)

⊥
e

ρo(~r′

2iω
c2γ

~r
⊥ −
~r
⊥ −
(cid:12)(cid:12)(cid:12)
The right hand side of Eq. (29) in the space-frequency domain, is given
by calculating the ﬂux of the complex Poynting vector through the surface
Ao (shown in Fig. 2). Such ﬂux is equal to the ﬂux of the complex Poynting
vector associated with the virtual source through the virtual source, because
the Fresnel propagator conserves the ﬂux of the Poynting vector. Therefore
the right hand side of Eq. (29) amounts to

K1 


(74)



(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)



⊥

.

26

c
2π Z
Ao

−

dA =

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2

⊥(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
⊥ (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2

~r′

ω

~r′
~r′

⊥

⊥

⊥

)

−

Z

d~r

d~r′

¯f (ω)

ρo(~r′

2ω
c2γ

c
2π Z

~r
⊥ −
~r
⊥ −
(cid:12)(cid:12)(cid:12)
Note that the integral in d~r′
is a convolution product. As before, applying
Eq. (40) with g1 = g2 to Eq. (75) and remembering that the spatial Fourier
transform of the convolution product of two function is equal to the product
of the spatial Fourier transform of the same functions, we can rewrite Eq.
(75) as

K1 


(75)



(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)



⊥

⊥

⊥

.

~r
⊥ −
(cid:12)(cid:12)(cid:12)
cγ

c
2π Z
Ao

−

2

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dA =

2ω2
πcγ2

1
4π2

−

2

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

d~k

˜ρo(~k) ˜
F

Z

(cid:12)(cid:12)(cid:12)(cid:12)

2

,

~k
(cid:16)

(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)

where

=

˜
F

~k
(cid:16)

(cid:17)

Z

exp

i~k

d~r′

⊥

h

~r
⊥
r

⊥

~r
⊥

·

i

K1

ωr
⊥
cγ !

 

=

2πγ2c2
ω2

γθ
1 + γ2θ2 ,

having used the notation θ = c/ω~k. Substituting Eq. (77) into Eq. (76) we
obtain the ﬁnal result

c
2π Z
Ao

−

2

~
E

e

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

⊥(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dA =

2c
π

−

2

¯f (ω)
(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

Z

d~θ

˜ρo(~θ, ω)
(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:0)

2

γ4θ2
1 + γ2θ2

2 ,

(cid:1)

that coincides with the left hand side in Eq. (71) thus verifying Eq. (29) as it
must be.

(76)

(77)

(78)

6 Analytical asymptote of the wake function

The anti-Fourier transform of the impedance gives back the wake func-
tion, that in its turn allows one to calculate the energy change per particle
averaged over the transverse beam coordinates.

Analytical results can be found starting with the asymptotic limit of the
impedance for z

γ2Ż.

≫

27

6.1

Symmetric part of the wake

The symmetric part of the wake function GS can be found calculating

GS(∆s) =

dω Re[Z](ω) exp

iω

∆s
βc !#

 

.

"−

1
2π

∞

Z
−∞

With the help of Eq. (55) and Eq. (56) one can rewrite Eq. (79) as

GS(∆s) =

∞

dθ

1
πc

−

Z
0

γ4θ3
1 + γ2θ2

(cid:0)

∞

2

Z
−∞

(cid:1)

dω exp

θ2ω2σ2
⊥
c2

#

"−

exp

iω

(cid:20)−

∆s
c (cid:19)(cid:21)

(cid:18)

.

We ﬁrst calculate the integral in dω, thus obtaining

GS(∆s) =

∞

1
√πσ
⊥

Z
0

−

dθ

γ4θ2
1 + γ2θ2

2 exp

"−

(∆s)2
4θ2σ2
⊥

.

#

(cid:0)

(cid:1)

Performing the integral in dθ and using the notation ∆ξ = γ(∆s)/σ
⊥
obtains

one

HS(∆ξ) =

1
4 √π (

−

√π

∆ξ
|

|

+ π

1
"

−

(∆ξ)2
2 #

exp

(∆ξ)2
4 #

"

erfc

∆ξ
|
|
2 (cid:21))

(cid:20)

,(83)

GS(∆ξ) =

HS(∆ξ)

γ
σ
⊥

where

and

erfc(x) = 1

2
√π

−

x

Z
0

exp[

t2]dt .

−

A plot of the universal function HS, that is the symmetric part of the wake
in units of γ/σ
⊥

, as a function of ∆ξ is given in Fig. 5.

Note that Eq. (82) can be veriﬁed in the asymptotic limit for (γ∆s)2
i.e. (∆ξ)2

σ2
,
⊥
σ2
z we obtain the asymptote

1. If we further assume (∆s)2

≫

≫

≫

28

(79)

(80)

(81)

(82)

(84)

for two particles separated by a distance ∆s. It may be useful to remind
that in agreement with [11], the case of a test particle in front of the source
corresponds to negative values of ∆s. In this case, the longitudinal electron
density distribution and its Fourier transform may be written respectively
as

f (t) = (

e)

δ
"

t
 

−

−

∆s
2βc!

+ δ

t +
 

∆s
2βc !#

and

f (ω) = (

e)

exp

−

(

∆s
2βc#

iω
"

+ exp

∆s
2βc#)

.

iω

"−

Substitution of Eq. (86) and Eq. (56) into Eq. (78) and use of Eq. (32) yields

∆

Etot =

2e2
πc

∞

Z
−∞

dω

1 + cos

(

ω(∆s)
c

"

∞

dθ exp

θ2ω2σ2
⊥
c2

#

γ4θ3
(1 + γ2θ2)2 .

"−

#)

Z
0

...
{

is related to single-particle radiation in
The ﬁrst term in parenthesis
) may be interpreted as the
the far zone, while the second term in cos(
·
interference term between the ﬁeld radiated by the two particles in the far
zone. Let us consider the interference term alone, that will be indicated with
∆
Eint. Performing ﬁrst the integral in dω we obtain

}

∆

Eint =

2e2
√πσ
⊥

∞

Z
0

dθ exp

(∆s)2
4θ2σ2
⊥

#

"−

γ4θ2
(1 + γ2θ2)2 .

In the limit for (γ∆s)2

, Eq. (88) can be written as

σ2
⊥

≫

∆

Eint =

2e2
√πσ
⊥

∞

Z
0

dx exp

x2(∆s)2
4σ2
⊥

#

"−

=

2e2
∆s

,

where we have performed a change of integration variable to x = 1/θ. The
energy term ∆
Eint is due to the interaction between the two particles, and
corresponds to the energy dissipated by the system through the active part
of the wake.

29

(85)

(86)

(87)

(88)

(89)

-15

-10

-5

0

5

10

15

0,0

 

-0,1

-0,2

 

-0,3

-0,4

H

(

) 

 

S

Fig. 5. Plot of the universal function HS as a function of ∆ξ.

Now, from Eq. (81) we have that the energy lost by one particle is e2GS(∆s)

e2/(∆s) when (γ∆s)2

−→
. Since the system is composed by two electrons
−
and the wake Gs is symmetric, the total energy lost by the system is given
by twice this value. Thus, in the limit (γ∆s)2
, the energy dissipated by
≫
the system due to the active part of the wake is

σ2
⊥

σ2
⊥

≫

2e2GS(∆s) =

2e2
∆s

,

−

in agreement with Eq. (89), as it must be.

The energy gained or lost by a single particle at position s within the bunch
due to the active (symmetric) part of the wake, averaged over transverse
coordinates is given by

∆

ES(s) = (
−

e)

GS(∆s) f (s

∆s)d(∆s) .

−

∞

Z
−∞

Note that this expression can also be presented in terms of impedances as

30

(90)

(91)

(92)

(93)

∆

ES(s) =

1
2π

∞

Z
−∞

dω Re[Z](ω) ¯f (ω) exp

∆s
βc !#

 

,

iω

"−

which however appears not to yield any computational advantage over Eq.
(91). Analogous remark holds for the antisymmetric part of the wake.

With the help of Eq. (12) and Eq. (82), we can explicitly write ∆
Eo,
Eo = γmec2 being the nominal energy of an electron (with rest mass me) as a
function of ξ = γs/σ
⊥

ES/

:

∆

ES
Eo

Imax
γIA

∞

Z
−∞

(ξ) =

d(∆ξ)HS(ξ

∆ξ) exp

−

(∆ξ)2
2η2 #

,

"−

where we introduced the new parameter η = γσz/σ
⊥
17 kA and the beam current Imax = eNc/( √ 2π σz).
Alfven current IA = e/(mc3)

, and we called the

≃

From a methodological point of view it is interesting to conclude our treat-
ment of the symmetric part of the wake with an additional remark. On the
one hand we have found that electrons in the bunch lose energy under the
2γ2σz
action of radiative interaction forces within an overtaking length
after the accelerator. On the other hand, an observer in the far zone de-
tecting the radiation pulse may calculate the retarded position of radiators,
concluding that electrons radiated inside the accelerator. Methodological
questions of this kind (electrons radiating when the radiative force does not
work on them and vice versa) are related with other well-known situations
of interest. For example, they also arise in Coherent Synchrotron Radiation
(CSR) from bending magnets and were discussed in [18].

∼

6.2 Antisymmetric part of the wake

The antisymmetric part of the wake function GS can be found calculating

GA(∆s) =

dω Im[Z](ω) exp

iω

(94)

∆s
βc !#

 

.

"−

i
2π

∞

Z
−∞

With the help of Eq. (65) and Eq. (56) one can rewrite Eq. (94) as

31

GA(∆s) =

iz
πc2

−

∞

Z
0

dθ θ
1 + γ2θ2

∞

Z
−∞

dω ω exp

θ2ω2σ2
⊥
c2

#

"−

exp

iω

(cid:20)−

∆s
c (cid:19)(cid:21)

(cid:18)

.(95)

Using the fact that

∞

Z
−∞

ic

d
d(∆s)

∞

Z
−∞

one obtains

dω ω exp

θ2ω2σ2
⊥
c2

#

"−

exp

iω

(cid:20)−

∆s
c (cid:19)(cid:21)

(cid:18)

=

dω exp

θ2ω2σ2
⊥
c2

"−

iω

−

∆s
c (cid:19)#

(cid:18)

=

−

i √π c2∆s
2θ3σ3
⊥

exp

"−

(∆s)2
4θ2σ2
⊥

,

#

GA(∆s) =

∞

z ∆s
2 √πσ3
⊥

−

Z
0

dθ

(1 + γ2θ2)θ2 exp

"−

(∆s)2
4θ2σ2
⊥

.

#

Performing the integral in dθ and using, as before, the notation ∆ξ =
γ(∆s)/σ
⊥

one has

GA(∆ξ) =

HA(∆ξ)

γηˆz
σ
⊥

where

HA(∆ξ) =

1
2 √π

−

(∆ξ)

2

(

√π
∆ξ
|

|

−

π exp

(∆ξ)2
4 #

"

erfc

∆ξ
|
|
2 (cid:21))

(cid:20)

,

and we redeﬁned ˆz = z/(2γ2σz). A plot of the universal function HA, that
, as a function of ∆ξ is
is the symmetric part of the wake in units of γˆz/σ
⊥
given in Fig. 6.

≫

1. If we further assume (∆s)2

Note that Eq. (98) can be veriﬁed in the asymptotic limit (γ∆s)2
, i.e.
(∆ξ)2
σ2
z we obtain the asymptote for two
≫
particles separated by a distance ∆s as before for the symmetric part of the
wake. ∆s < 0 indicates again the case when the test particle is in front of
the source. From the Lienard-Wiechert expression for the electric ﬁeld of a
single particle moving on a straight line we can calculate the rate of energy

σ2
⊥

≫

32

(96)

(97)

(98)

(99)

H

(

)

A

0,8

0,4

0,0

-0,4

-0,8

-15

-10

-5

0

5

10

15

Fig. 6. Plot of the universal function HA as a function of ∆ξ.

change of the front electron

d
E
dz

=

e2
γ2(∆s)2 .

(100)

(101)

Independently, from Eq. (98) we have that HA(∆ξ)
when (∆ξ)2
energy

2 sign(∆ξ)/(∆ξ)2
1. As a result, at position z the front particle has gained the

−→ −

≫

∆

EA = e2GA(∆s) =

e2z
γ2(∆s)2

that corresponds to the rate of energy change in Eq. (100) as it must be.

The energy gained or lost by a single particle at position s within the bunch
due to the reactive part of the wake, averaged over transverse coordinates
is given by

33

 

 

 

 

 

F

15

10

5

0

-10

-15

 

-5

 

-2,0

-1,5

-1,0

-0,5

0,0

0,5

1,0

1,5

2,0

s/

z

Fig. 7. Plot of F in Eq. (105) as a function of s/σz for diﬀerent values of η.

∆

EA(s) = (
−

e)

GA(∆s) f (s

∆s)d(∆s) .

−

∞

Z
−∞

With the help of Eq. (12) and Eq. (98), we can explicitly write ∆
Eo,
Eo = γmec2 being the nominal energy of an electron (with rest mass me) as a
function of ξ = γs/σ
⊥

EA/

:

∆

EA
Eo

Imax
γIA

∞

Z
−∞

(ξ) =

ηˆz

d(∆ξ)HA(ξ

∆ξ) exp

−

(∆ξ)2
2η2 #

.

"−

Note that Eq. (103) is a function of ξ but also depends parametrically on η,
and may be presented as

(102)

(103)

(104)

where we indicated the parametric dependence of η after the semicolon and

∆

s
σz

EA
Eo (cid:18)

=

; η
(cid:19)

Imax ˆz
γIA

F

s
σz

(cid:18)

.

; η
(cid:19)

34

F

s
σz

(cid:18)

=

; η
(cid:19)

d(∆ξ) η HA

η

∆ξ

exp

s
σz −

(cid:18)

(cid:19)

(∆ξ)2
2η2 #

.

"−

∞

Z
−∞

(105)

A plot of Eq. (105) is given as a function of s/σz in Fig. 7 for diﬀerent values
of η.

We failed to integrate Eq. (93) and Eq. (103) (or Eq. (104)) analytically. How-
ever, plots for ∆
Eo and ∆
Eo as a function of ξ can be computed with
the help of numerical techniques. In the following Section we will give a
practical example of application of our work.

EA/

ES/

7

Impact on the design of a table-top FEL in the VUV and X-ray range

The foreseen speciﬁcations of the next generation laser-plasma accelerators
are stunning. The high acceleration gradient will be up to TV/m, producing
very short bunches about 10 fs long in the 100 kA current class (i.e. with a
charge of about 1 nC). The beam quality is also expected to rival state-of-the
art conventional acceleration techniques, featuring a relative energy spread
of 0.1% for beam energies in the GeV range and a normalized emittance in
the order of 1 mm

mrad.

·

One of the obvious and perhaps most exciting applications envisaged for
these machines is as drivers for table-top FELs, both in the VUV (TT-VUV
FEL) and in the X-ray range (TT-XFEL) [19]. Estimation of basic scaling pa-
rameters for Self-Ampliﬁed Spontaneous Emission (SASE) FEL applications
within the one-dimensional ideal case indicate that a system composed by
a laser-plasma accelerator and a meter-long undulator may undergo SASE
process in the sub-nanometer range, thus outclassing all existing and fore-
seen XFEL projects, both in dimensions and costs.

Unfortunately, the road map towards the practical realization of this ambi-
tious goal is not problem-free. Let aside other possible problems we focus
our attention on a fundamental issue that, in our understanding, consti-
tutes a serious diﬃculty. Namely, we want to estimate the impact of the
longitudinal wake on the electron beam quality using the theory developed
in the previous Sections. This is possible, because the plasma acceleration
gradient is such that the electron beam to be injected in the undulator can
2γ2σz, i.e. well within the applicability
be produced within distances da ≪
region of our theory. Note that our estimation is completely independent
of the physical realization of the accelerator (a laser-plasma device, or any
other physical principle). Within our model, the accelerator is just located
at a single point at position zA down the beamline.

35

Plasma 
accelerator 

r
v

Mini-undulator
3 mm-period

da<<2 g 2 s

z

Electron
Beam
I~100 kA

z

(106)

(107)

Fig. 8. Geometry of the TT-VUV FEL and of the TT-XFEL setups.

In the following we will consider two sets of parameters informally under
discussion within the scientiﬁc community. The ﬁrst refers to a test case
designed to radiate in the VUV range (λ = 25 nm) while the second deals
with the true table-top SASE XFEL, designed to radiate in the hard X-ray
range (λ = 0.25 nm). Both parameter sets rely on the use of a mini-undulator
with a 3 mm-period, that would allow low electron beam energy (in the order
100 MeV and 1 GeV for the VUV and the X-ray case). Very high currents, in
the order of 100 kA, are supposed to be used . The geometry of the system
is described in Fig. 8. It is important to note that in both study-cases the
undulator parameter K
0.5. This means that the longitudinal velocity of
particles in the undulator is not signiﬁcatively altered (γ2
≃
1.125γ2). As a result, wake ﬁeld calculations in vacuum, performed in the
preceding Sections, can still be used inside the undulator.

γ2/(1 + K2/2)

z ≡

≃

Description of the FEL setups will be limited to the one-dimensional model.
In this case, the basic scaling parameter is the one-dimensional ρ1D param-
eter deﬁned as [20]

ρ1D =

λw
4π 


2π2 joK2A2
JJ
IAλwγ3

1/3





where jo is the beam current density, λw is the undulator period, K is the
undulator parameter deﬁned as K = eλwHw/(2πmec2), where Hw is the max-
imum magnetic ﬁeld produced by the undulator on the z axis. Finally, the
coupling factor AJJ, for a planar undulator, is given by AJJ = J0(Q)
J1(Q),
where Q = K2/(2 + K2). The main quantities of interest characterizing the
FEL process can be written in terms of ρ1D. In fact, the one-dimensional
power gain length of a mono-energetic beam is

−

LG =

λw
4π √3ρ1D

,

36

-4

-2

0

2

4

s/

z

0,00

 

-0,02

 

-0,04

-0,06

/E

 

S

o

Fig. 9. Relative energy change ∆
s/σs in the case of the VUV table top FEL setup.

s/

E

E

o as a function of the position inside the bunch

while the relative FEL bandwidth at saturation is close to ρ1D and the power
at saturation is about ρ1D times the electron beam power.

⊥ ∼

Let us ﬁrst deal with the VUV test case, that aims at producing radiation at a
wavelength λ = 25 nm using an electron energy
Eo = 130 MeV and a 0.7 m-
long undulator with period λw = 3 mm. The electron beam current is about
1 µm. The transverse
60 kA. The longitudinal beam size is taken to be σz ∼
= 1 µm to a ﬁnal
beam dimension is changed, instead, from an initial size σ
⊥
size σ
30 µm within a few centimeters. In our estimation we will neglect
the impact of this change of dimension on the longitudinal wake, and take
σ

30 µm from the very beginning.

⊥ ∼
The radiation formation length at wavelength λ is estimated to be 2γ2Ż, and
2γ2Ż. An
our asymptotic calculations for the impedance are valid for z
estimation of the wavelengths of interest is given considering the typical
length scale that enters in the expressions for the impedance. In our case we
take Ż
10 cm, a few times smaller than
the size of the TT-VUV FEL, because the planned length of the undulator is
about 0.7 m. This allows us to use asymptotic expressions Eq. (93) and Eq.
(103). The only parameters needed to be plugged into these equations are

σz = 1 µm, which yields 2γ2Ż

≫

≃

≃

37

/E

A

o

0,4

0,2

0,0

 

 

-0,2

-0,4

-4

-2

0

2

4

s/

z

Fig. 10. Relative energy change ∆
o as a function of the position inside the
bunch s/σs in the case of the VUV table top FEL setup. This plot refers to the
position z = 0.7 m.

EA/
E

thus γ = 260 and η = 8.7 and I = 60 kA. Moreover, since the asymmetric
part of the wake is proportional to ˆz = z/(2γ2σz), we need to ﬁx a position
along the longitudinal axis to calculate Eq. (103). Here we set z
0.7 m,
corresponding to the foreseen undulator length. The relative energy change
∆
Eo calculated with the help of Eq. (93) and Eq. (103) is plot respectively
ES,A/
in Fig. 9 and Fig. 10 as a function of the longitudinal coordinate inside the
bunch. While travelling down the undulator, a correlated energy change
develops along the electron beam. In our case the chirp is non-linear, but in
order to estimate the magnitude of the eﬀect we can use the linear energy
chirp parameter [21, 22]:

≃

ˆα =

dγ
dt

1
γωρ2
1D

−

.

(108)

The eﬀect of linear energy chirp starts to play a signiﬁcant role on the FEL
gain when ˆα & 1. Intuitively, this means that the relative energy change
becomes comparable with the FEL parameter on the scale of the coherence
length. Using an estimation of the slope around s = 0 in Fig. 10 and the

38

≃

12, that indicates a very large
other problem parameters one ﬁnds ˆα
eﬀect. It is important to note that in our case the energy chirp in Fig. 10
depends on the electron beam proﬁle but also on time, because it develops
along the undulator. This eﬀect is fundamental, it cannot be avoided, and
is directly linked with the feasibility of the proposed FEL scheme. In other
words, radiation generated in one part of the undulator cannot interact in
resonance in another part of the undulator, and the ampliﬁcation process is
destroyed.

In these conditions, our conclusion is that the proposed TT-VUV FEL setup
will not work.

≃

≃

σz. This yields 2γ2Ż

Let us now turn to consider a table-top SASE XFEL scenario aimed at pro-
ducing radiation at a wavelength λ = 0.25 nm using an electron energy
Eo = 1.2 GeV and a 3m-long undulator with period λw = 3 mm. The elec-
tron beam current is taken in the 100 kA range. We take again σz = 1 µm,
= 30 µm. Similarly as before we estimate the radiation formation
and σ
⊥
length taking Ż
10 m, longer than the TT-XFEL
undulator length, that is about 3 m. This makes it impossible to use our
asymptotic expressions, Eq. (93) and Eq. (103), because the entire setup is
well within the formation length. This situation needs further study, based
on detailed numerical simulations, that goes beyond the scope of this work.
However, as before, we can say that longitudinal wake ﬁelds will be respon-
sible for an energy chirp that is both proﬁle dependent and time dependent.
Moreover, even though the electron beam energy has increased of an order
of magnitude (thus leading to a decrease of the energy change level), the
ρ1D parameter is decreased of an order of magnitude. Since the undulator
length is only a factor three shorter than the formation length, we conclude
that wake ﬁelds constitute a major eﬀect in this case too. Such eﬀect poses a
serious threat to the operation of the TT-XFEL setup.

8 Conclusions

This work constitutes the ﬁrst study of the impact of longitudinal wake
ﬁelds on the quality of electron beams produced with high ﬁeld-gradient
accelerators. We restricted our attention to the analysis of the wake gen-
erated along the trajectory following the acceleration, and assuming that
the acceleration happens on a short longitudinal scale compared with the
2γ2σz. Thus, our consideration does not depend
overtaking length, i.e. da ≪
on the particular realization of the accelerator. However, given present tech-
nological developments, one of the most relevant applications of our study
should come from the realm of laser-plasma accelerators.

39

We calculated longitudinal symmetric and anti-symmetric parts of the wake
function as well as real and imaginary part of the impedance with the
help of paraxial approximation within a space-frequency domain formula-
tion of Maxwell’s equation. While the general expressions for wakes and
impedances need numerical techniques to be evaluated, it is possible to
present analytical expressions for the asymptotic limit when the electron
bunch has reached a position, down the beamline, that is far from the ac-
celeration point, with respect to the overtaking distance. It should be noted
that in these cases the wake and the impedance are proportional to universal
functions, valid for any set of parameters.

Our results can be used as analytical benchmarks for computer codes. More-
over, the the asymptotic result for the antisymmetric part of the wake is of
fundamental importance, in the sense that its validity is not restricted to the
particular model studied in this paper (fast acceleration). To the best of our
knowledge, Eq. (98) constitutes the ﬁrst analytical solution to the problem of
space-charge wakes (calculated per unit length). Taking advantage of simi-
larity techniques we presented such result in terms of a dimensionless object
dependent on the problem parameters (γηˆz/σ
) multiplied by a universal
⊥
function HA (see Eq. (99)). Eq. (98) can further be used to calculate the rela-
tive energy change of a particle within a given bunch. In case of a Gaussian
longitudinal proﬁle the relative energy spread reduces to Eq. (104). Plots
presented in Fig. 7 will help the reader to perform a fast estimation of the
inﬂuence of the space-charge wake at the stage of planning of experiments.

As a particular example, we used our results to estimate the impact of the
longitudinal wake ﬁelds on the energy change of the electron beam in a
table top FEL setup, both in the VUV range (λ = 25 nm) and in the x-ray
range (λ = 0.25 nm). In both situations, such energy variation is time and
shape dependent. This eﬀect is fundamental, in the sense that it cannot be
avoided. The total energy deviation is found to be an important eﬀect, and
constitute a major problem for the exploitation of the SASE ampliﬁcation
process.

9 Acknowledgements

We thank Massimo Altarelli and Martin Dohlus (DESY) for many useful
discussions, Reinhard Brinkmann and Jochen Schneider (DESY) for their
interest in this work.

40

References

[1] S.P.D. Mangles et al., Nature 431, 535 (2004)
[2] C.G.R. Geddes et al., Nature 431, 538 (2004)
[3]
J. Faure et al., Nature 431, 538 (2004)
[4] A.M. Kondratenko and E.L. Saldin, Part. Accelerators 10, 207 (1980)
[5] Ya. S. Derbenev, A.M. Kondratenko and E.L. Saldin, Nucl. Instrum. and

[6]

Meth. in Phys. Res. 193, 415 (1982)
J.B. Murphy and C. Pellegrini, Nucl. Instrum. and Meth. in Phys. Res.
A 237, 159 (1985)

[7] V. Ayvazyan et al., Eur. Phys. J. D 37, 297 (2006)
[8] M. Altarelli et al. (Eds.), XFEL: The European X-Ray Free-Electron
Laser. Technical Design Report, DESY 2006-097, DESY, Hamburg (2006)
(See also http://xfel.desy.de)
J. Arthur et al. Linac Coherent Light Source (LCLS). COnceptual
Design Report, SLAC-R593, Stanford (2002) (See also http://www-
ssrl.slac.stanford.edu/lcls/cdr)

[9]

[10] J. Jackson, ”Classical Electrodynamics”, 3rd ed., Wiley, New York (1999)
[11] B. Zotter and S. Kheifets, ”Impedances and Wakes in High-Energy

Particle Accelerators”, World Scientiﬁc, Singapore, 1997
[12] H. Kramers, Atti Congr. Internaz. Fisici, Com, 2, pp. 545 (1927)
[13] R. Kronig and H. Kramers, Z. Phys., 52, 174 (1928)
[14] Z. Huang and T. Shaftan, Instrum. and Meth. in Phys. Res. A 528, 345

[15] R.A. Bosch, Il Nuovo Cimento, 20, 4 p. 483 (1998)
[16] C.B. Schroeder, E. Esarey, J. van Tilburg and W. P. Leemans, Phys. Rev.

(2004)

E 69, 016501 (2004)

[17] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, ”Fourier Op-
tics Treatment of Classical Relativistic Electrodynamics”, DESY 06-127
(2006)

[18] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Nucl. Instrum. and

Meth. in Phys. Res. A 398, 373 (1997)

[19] F. Gruener et al. ”Design Considerations of

in Proceedings of
Future Light Sources DESY, Hamburg, Germany (2006),
http://adweb.desy.de/mpy/FLS2006/proceedings/TALKS/PLT04 TALK.PDF

table-top FELs”,
the 37th ICFA Beam Dynamics Workshop,
see

[20] R. Bonifacio, C. Pellegrini and L. Narducci, Opt. Commun. 50, 373

(1984)

[21] S. Krinsky and Z. Huang, Phys. Rev. ST Accel. Beams 6, 050702 (2006)
[22] E. L. Saldin, E. A. Schneidmiller, and M. V. Yurkov Phys. Rev. ST Accel.

Beams 9, 050702 (2006)

41

