4
0
0
2
 
y
a
M
 
0
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
9
0
1
5
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Optimal Axes of Siberian Snakes for Polarized Proton Acceleration

Georg H. Hoﬀstaetter
Department of Physics, Cornell University, Ithaca/NY

Accelerating polarized proton beams and storing them for many turns can lead to a loss of
polarization when accelerating through energies where a spin rotation frequency is in resonance
with orbit oscillation frequencies. First-order resonance eﬀects can be avoided by installing Siberian
◦
Snakes in the ring, devices which rotate the spin by 180
around the snake axis while not changing
the beam’s orbit signiﬁcantly. For large rings, several Siberian Snakes are required.

Here a criterion will be derived that allows to ﬁnd an optimal choice of the snake axes. Rings
with super-period four are analyzed in detail, and the HERA proton ring is used as an example
for approximate four-fold symmetry. The proposed arrangement of Siberian Snakes matches their
eﬀects so that all spin-orbit coupling integrals vanish at all energies and therefore there is no ﬁrst-
order spin-orbit coupling at all for this choice, which I call snakes matching. It will be shown that
in general at least eight Siberian Snakes are needed and that there are exactly four possibilities
to arrange their axes. When the betatron phase advance between snakes is chosen suitably, four
Siberian Snakes can be suﬃcient.

Since the spin motion depends on a particle’s trajectory, protons at diﬀerent phase space positions
generally have diﬀerent spin directions. The time averaged polarization at each phase space point is
parallel to the invariant spin ﬁeld, and the spread of this spin ﬁeld limits the polarization that can
be stored. By the here presented choice of Siberian Snakes this limit is completely eliminated up
to ﬁrst order in the transverse phase space coordinates. The invariant spin ﬁeld and the amplitude
dependent spin tune are also computed without linearization to show the advantages of this choice
of snakes. Ultimately, the goal of snake matching is to reduce the loss of polarization during the
acceleration of the beam. To show that favorable choice of snakes have been found, polarized protons
are tracked for part of HERA-p’s acceleration cycle which shows that polarization is preserved best
for the here proposed arrangement of Siberian Snakes.

I.

INTRODUCTION

The design orbit spin direction ~n0 at some azimuth
θ = 2πl/L along a storage ring of length L describes the
spin direction for the design orbit which is periodic from
turn to turn, where l is the pathlength along the design
orbit. The design orbit spin tune ν0 describes the number
of times a spin has rotated around ~n0(θ) during one turn
around the ring.

Spin-orbit resonances in high energy accelerators arise
when the electro-magnetic ﬁelds on synchro-betatron tra-
jectories cause disturbances of the spin’s motion which
build up coherently from turn to turn.

In a ﬂat ring, for instance, an initially vertical spin of
a particle traveling on the design orbit remains vertical
during particle motion. On a vertical betatron trajectory
the particle traverses horizontal ﬁelds in quadrupoles and
the spin no longer remains vertical. This disturbance of
spin motion due to the betatron motion is described by
the spin-orbit coupling integrals [1]

I ± =

kyei(−Ψ±Φy)dθ ,

(1)

2π

Z

0

p

where ky = k
βy with the quadrupole strength k and
the vertical beta function βy, and Ψ is the phase advance
of the spin rotation around the vertical and Φy is the
vertical betatron phase. For ease of notation a constant
factor which is sometimes multiplied to this integral is
not indicated here.

The I ± tend to be especially big when the spin distur-
bance in every FODO cell of a ring adds up coherently [2].
In an approximation that is of ﬁrst order in transverse
phase space coordinates, these integrals yield the follow-
ing important information: If all spin-orbit coupling inte-
grals vanish, all initially vertical spins are again vertical
after one turn, although they have traveled along diﬀer-
ent betatron trajectories. The ring is then called spin
matched or spin transparent.

In this paper it will be analyzed how Siberian Snakes
can be used to make a storage ring spin transparent at
all energies.

When a beam is polarized, it has a polarization di-
rection ~f (~z, j) at each phase space position ~z at some
azimuth θ of the ring, where j indicates how often the
bunch has traveled around the ring. Since each initial
phase space position leads to a diﬀerent particle trajec-
tory with diﬀerent spin motion, spin ﬁelds in general
change from turn to turn. A special spin ﬁeld that does
not change from turn to turn is called the invariant spin
ﬁeld ~n(~z) [3].

When a beam is polarized according to this spin ﬁeld,
~f (~z, j) = ~n(~z), then the beam polarization is given by
the phase space average Plim =< ~n(~z) >~z. In any case,
even when a particle at ~z(j) after its jth turns has a clas-
sical spin vector ~S with a direction which is not parallel
to ~n(~z(j)), its projection onto the invariant spin ﬁeld is
constant, i.e. ~f (~z(j), j) · ~n(~z(j)) does not change with j.
This is possible since its spin ~S appears to rotate around
~n(~z(j)). The time averaged polarization at the phase

space point ~z is therefore parallel to ~n(~z) for any spin
ﬁeld. The maximum time averaged polarization at that
point is thus given when the beam is initially polarized
parallel to ~n(~z). The average Plim is therefore called the
limiting polarization [4, 5, 6].

To illustrate one of the beneﬁts of the proposed choice
of Siberian Snakes it will be shown that they increase
Plim.

When an invariant spin ﬁeld is found, the rotation of
~S around it can be described by an amplitude dependent
spin tune ν( ~J ) that depends on the orbital amplitudes ~J
but not on the orbital phase variables. This is important
since ν( ~J) does not change from turn to turn and can
therefore be used to describe long term coherence with
the frequencies of orbital motion. When this amplitude
dependent spin tune is in resonance with the orbital tunes
Qj,i.e. ν( ~J) = k0 +
j kj Qj for integers kj , the spin
motion can be strongly disturbed.

P

As another illustration of the beneﬁts of the proposed
choice of Siberian Snakes it will be shown that they in-
crease the orbital amplitudes for which low order reso-
nance conditions occur.

It can be shown that the projection of the polarization
onto the invariant spin ﬁeld JS = ~S · ~n(~z) is not only
invariant in a storage ring, but that it is an adiabatic
invariant [7] when parameters of the accelerator, like the
beam’s energy, change. This means that a beam that
is initially polarized parallel to the invariant spin ﬁeld
~n(~z, Ei) and thus has the average polarization Plim(Ei)
at its initial energy Ei will still be polarized parallel to
the invariant spin ﬁeld ~n(~z, Ef ) after the beam has been
accelerated to a ﬁnal energy Ef , and its average polar-
ization is Plim(Ef ). This ﬁnal polarization can be very
large, even though it may have been very small at some
intermediate energies. All this is only true if the change
of energy is performed adiabatically slowly. Usually, the
acceleration cannot be performed adiabatically slowly at
all energies and polarization is lost, i.e. the ﬁnal polar-
ization is smaller than Plim(Ef ).

The most convincing illustration of the beneﬁts of the
proposed choice of Siberian Snakes is ﬁnally that they
increase the polarization that is retained after accelera-
tion.

Although it has been straightforward to deﬁne ~n(~z),
it is not easy to calculate this spin ﬁeld in general and
much eﬀort has been spent on this topic, mostly for
electrons at energies up to 46 GeV. All algorithms de-
veloped before the polarized proton project at HERA-p
rely on perturbation methods at some stage, and either
do not go to high enough order [8, 9] or have problems
with convergence at high order and high proton energies
[10, 11, 12]. The algorithms developed for the HERA-p
project [4, 5, 13, 14, 15] made the here presented analysis
possible.

2

II. OPTIMAL CHOICES OF SIBERIAN SNAKES

Siberian Snakes are indispensable if polarized proton
beams are to be accelerated in a high-energy synchrotron
such as HERA-p. This has the following reasons:

1. Siberian Snakes ﬁx the design-orbit spin tune ν0 to
1
2 during the acceleration cycle so that no ﬁrst-order
resonances have to be crossed. Crossing ﬁrst-order
resonances can lead to a severe reduction of polar-
ization by an amount described by the Froissart-
Stora formula [16].

2. Siberian Snakes strongly reduce the inﬂuence of en-
ergy variations on spin motion within a synchrotron
period [17].

3. Siberian Snakes reduce the variation of ~n(~z) for par-
ticles which oscillate vertically and therefore pass
through horizontal ﬁelds which perturb the spin
motion.

4. When ~n changes rapidly during acceleration, the
adiabatic invariance of JS = ~n(~z) · ~S might be vi-
It is
olated and polarization would be reduced.
therefore important that Siberian Snakes smoothen
the changes of ~n during the acceleration cycle.

5. Siberian Snakes can also compensate perturbing ef-
fects of misaligned optical elements [17, 18, 19] but
the eﬀect of misalignments will not be covered here.

There is so far no reliable formula for determining the
number of Siberian Snakes required for an accelerator
[21, 22]. To make things worse, for any given number
of Siberian Snakes there are very many diﬀerent possible
combinations of the snake angles which lead to an energy
independent closed-orbit spin tune of 1
2 and to a vertical
design orbit spin direction ~n0 in the accelerator’s arcs.
But so far there has been no reliable formula for deter-
mining which of these snake schemes leads to the highest
polarization.

There used to be a popular opinion that, owing to their
symmetry, 5 standard choices of the snake angles for 4
Siberian Snakes are advantageous for HERA-p. These
choices are not optimal, as will be shown. For reasons
why these standard schemes were considered useful see
for example [23]. RHIC with its two snakes, is operated
with a similar standard scheme [24].

The energy dependence of Plim in HERA-p produced
by these 5 snake schemes is shown in Fig. 1. They seem
to produce rather similar but very low maximum time av-
erage polarization Plim in a critical energy regions where
very strong resonances are excited. The observation of
such rather small diﬀerences in the ~n-axis for such dif-
ferent schemes suggests the following detailed investiga-
tion of the inﬂuence of snake schemes. Figure 2 (left)
shows Plim as computed for linearized spin-orbit motion
[4] for 4 other schemes with 4 Siberian Snakes which were

P

lim

1

0.8

0.6

0.4

0.2

0

lim

1P
0.8
0.6
0.4
0.2
0

800

810

820

830

p (GeV =)

FIG. 1: Plim of linearized spin-orbit motion for a 2.5σ verti-
cal amplitude for 4 Siberian Snakes in HERA-p. Each curve
corresponds to one of the 5 standard choices of snake schemes
in the following table. The right column shows an obvious
notation to describe the snake angles in a snake scheme:

Scheme
(0 π
2 00)
( π
4 0 π
4 0)
4 0 3π
( 3π
4 0)
( 5π
5π
π
8
8
( π
π
8
8

South
0◦
◦
45
◦
−45
◦
8 ) −22.5
5π
22.5
8 )

π
8
5π
8

East North West
0◦
0◦
90◦
◦
◦
◦
0
0
45
◦
◦
◦ −45
0
0
◦ −22.5
◦
22.5
22.5
◦
◦ −22.5
◦
◦ −22.5
22.5

◦

found by the so called ﬁltering method [4, 25], a numer-
ical search for suitable snake axes. It is apparent that
large increases in Plim can result from the choice of a
suitable snake scheme.

lim

1P
0.8
0.6
0.4
0.2
0

800

810

820

830

800

810

820

830

p (GeV =)

p (GeV =)

FIG. 2: Plim for 4 diﬀerent snake schemes which lead to very
diﬀerent maximum time average polarization for the standard
HERA-p lattice. Right: One of these snake schemes which
were found by numerical optimization of the snake angles.

HERA-p is the proton ring of an electron-proton col-
lider and is located above the electron ring. It therefore
has non-ﬂat sections in which the protons are bend down
to collide with the electrons. These sections bend spins
out of the vertical so that ~n0 would be non-vertical in
the arcs. To avoid this, it has been proposed to insert a
Siberian Snake in each of the 6 vertically bending regions.
These so called ﬂattening snakes have been assumed in
all presented computations in addition to the Siberian
Snakes for which an optimal axis is sought. As a 1σ
emittance a realistic value of 4πmm mrad was assumed
throughout this paper.

3

III. SPIN-ORBIT-COUPLING INTEGRALS

For the spin-orbit-coupling integrals in ﬂat rings of
Eq. (1), ~n0 was assumed to point vertically upward. Now
Siberian Snakes will be included, which rotate all spins
and also ~n0 by π around some axis in the horizontal
plane, so that ~n0 points downward in some sections. This
changes the sign of Ψ Eq. (1).

It is assumed that there are n Siberian Snakes in the
ring and that n is even, to make ~n0 vertical in the arcs
of the ring. The azimuth at the position of a snake is
denoted by θj and the spin phase advance around the
vertically upward direction between snake j and j + 1 is
denoted by Ψj. The spin phase advance after the jth
Siberian Snake is Ψj(θ) with Ψj(θj) = 0.

For simplicity θ0 = 0 and θn+1 = 2π is used and the
spin phase advance from azimuth θ0 to the ﬁrst Siberian
Snake is Ψ0.

In the following a Siberian Snake with a snake axis
which is in the horizontal plane will be referred to as
a horizontal Siberian Snake and for historical reasons a
snake which rotates spins around the vertical by some
rotation angle will be referred to as type III snake. A
horizontal Siberian Snake with a snake angle ϕ is equiv-
alent to a radial Siberian Snake followed by a type III
snake that introduces an extra spin phase advance of
α = 2ϕ [26].

With these notations the spin-orbit-coupling integrals

for a ring with horizontal Siberian Snakes are

I ±
y = −

n

j−1

Pk=0

−i

e

(−)k(αk+Ψk)

Xj=0

θj+1

×

Z
θj

kyei[−(−)j(Ψj (θ)+αj )±Φ]dθ .

(2)

In terms of the orbital phase advance Φj between snake
j and j + 1, one obtains

[−(−)k(αk+Ψk)±Φk]

I ±
y = −

n

j−1

Pk=0

i
e

Xj=0
θj+1

×

Z
θj

kyei[−(−)j(Ψj (θ)+αj )±Φj (θ)]dθ .

(3)

A corresponding formula has been used in [1] to in-
troduce so-called strong spin matching, where Siberian
Snakes are used to produce a cancelation of spin pertur-
bations in diﬀerent FODO cells.

The spin phase advances between snakes must satisfy
n
k=0(−)kΨk = 0 to make the closed-orbit
the condition
spin tune independent of energy and the snake angles
n
k=1(−)kϕk = π
must satisfy the condition
2 to make
the closed-orbit spin tune ν0 equal to 1
2 .

P

P

IV. SNAKE MATCHING IN RINGS WITH
SUPER-PERIODICITY

The spin perturbations in diﬀerent parts of the ring
can compensate each other when these parts have similar
spin-orbit-coupling integrals. This is achieved by using
the Siberian Snakes to adjust the spin phase advances
in such a way that spin-orbit-coupling integrals of sim-
ilar parts of a ring cancel each other. In the following,
the process of ﬁnding a snake scheme for which such a
compensation occurs will be referred to as snake match-
ing [27, 28]. After demonstrating the idea for type III
snakes, which simply rotate spins around the vertical by
some ﬁxed angle with little inﬂuence on the orbit motion,
two quite general results will be demonstrated:

1. A ring with super-periodicity 4 can be completely
snake matched using 8 Siberian Snakes,
a
snake scheme can be found for which the spin-orbit-
coupling integrals are zero due to a complete can-
celation of spin perturbations in diﬀerent parts of
the ring. There are exactly two such possibilities
which lead to energy independent snake angles.

i.e.

2. Such a ring can also be snake matched using 4
Siberian Snakes. Then, however, the snake axes
depend on energy and have to be changed during
the acceleration process.

3. Energy independent

snake matching with 4
Siberian Snakes can be found when the betatron
phase advance is appropriately chosen for each of
the 4 quadrants.

A. Snake Matching with Type III Snakes for
Super-Periodicity 4:

The index y on the spin-orbit-coupling integral and
on the vertical phase advance and tune will not be in-
dicated.
In any case, the methods for canceling spin-
orbit-coupling integrals by a special choice of snake angles
which will now be derived can also be used for transverse
and longitudinal motion. In this section the notation will
be further simpliﬁed by using the symbols ν0 and Q to
denote 2π times the spin tune and 2π times the orbital
tune. Then for a ring with super-periodicity 4, I ± can
be computed from

π/2

kyei(−Ψ±Φ)dθ ,

I ±

1
4

=

Z
0
I ± = I ±

1
4

[1 + ei(−ν0±Q)/4 + ei2(−ν0±Q)/4 + ei3(−ν0±Q)/4] .

(4)

Spin transparency requires that I + as well as I − vanish.
Thus the bracket in (4) must vanish. This is only possible
when ei(−ν0±Q)/4 is either −1 or i. Choosing the ﬁrst
possibility to eliminate I + and the second to eliminate
I −, one obtains

ei(−ν0+Q)/4 = −1 , ei(−ν0−Q)/4 = i .

(5)

4

This leads to the requirement eiQ/2 = i which cannot be
satisﬁed in a realistic ring. Therefore, a four-fold repet-
itive symmetry cannot lead to spin transparency at any
energy. While the spin disturbance of two quadrants can
therefore not cancel in I + as well as in I −, one of these
integrals can cancel whenever the spin phase advance be-
tween the quadrants is appropriate.

The situation changes if type III snakes are installed.
As ﬁrst found in [25], type III snakes can improve the spin
dynamics in HERA-p by increasing Plim =|h~ni|. They
can be used to manipulate the spin phase advance to
make the spin-orbit-coupling integrals of diﬀerent parts
of the ring cancel. To demonstrate this, 4 type III snakes
are installed regularly spaced around the ring.

There are three possibilities for canceling the spin dis-
turbances between quadrants of the ring. The quadrants
whose destructive eﬀects cancel are connected by arrows
in Fig. 3.

l = 0

l = 0

l = 0

FIG. 3: The three possibilities for canceling the depolarizing
eﬀects of quadrants of a ring with super-periodicity 4. The
arrows indicate which quadrants cancel

The spin-orbit-coupling integrals are

I ± = I ±

[1 + ei(−ν0±Q)/4−ψ1

1
4

(6)

+ei2(−ν0±Q)/4−ψ1−ψ2 + ei3(−ν0±Q)/4−ψ1−ψ2−ψ3] ,

where ψj is the spin rotation angle of the type III snake at
θ = j π
2 . To snake match the ring, I + as well as I − must
vanish. Therefore the bracket on the right hand side has
to vanish in both cases. A sum of 4 complex numbers
with unit modulus can only vanish when it consist of two
pairs of numbers which cancel each other. This is shown
in Fig. 4.

The three possibilities of cancelation demonstrated in
Fig. 3 are given by the following three sets of equations:

1.
and
2.
and
3.
and

(−ν0 ± Q)/4 − ψ1
(−ν0 ± Q)/4 − ψ3
2(−ν0 ± Q)/4 − ψ1 − ψ2
ψ3
3(−ν0 ± Q)/4 − ψ1 − ψ2 − ψ3
(−ν0 ± Q)/4 − ψ2

◦
= π
◦
= π
◦
= π
◦
= ψ1
◦
= π
◦
= π

(7)

◦
The symbol
= indicates equivalence modulo 2π. To
snake match, one of these three conditions has to hold
for (−ν0 + Q), which lets I + vanish and another of the
conditions has to hold for (−ν0 − Q), which lets I − van-
ish. I + and I − cannot vanish due to the same condition

i

i#

1

e

i#

2

e

1

5

Obviously a change in sign of Q leads to I + = 0 due
to condition 2 and to I − = 0 due to condition 1. There
are therefore exactly two possibilities for making a ring
with super-periodicity 4 spin transparent by means of 4
type III snakes. These possibilities are shown in Fig. 5.
However, the scheme of 4 type III snakes presented here

i#

3

e

Q(cid:0)(cid:23)

(cid:23)+Q

[(cid:25) +

℄

[(cid:25) (cid:0)

℄

4

4

FIG. 4: Four complex numbers with modulus one can only
add up to zero when they consist of two pairs which individ-
ually add up to zero

if restrictions on the allowed orbital phase advance Q are
to be avoided. There are therefore three possibilities:

1. I + = 0 due to condition 2 and I − = 0 due to

condition 3 requires
◦
= π + 2(−ν0 + Q)/4 − ψ1 , ψ3
◦
= π + (−ν0 − Q)/4 , ψ3

ψ2

ψ2

◦
= ψ1 ,

(8)

◦
= 2(−ν0 − Q)/4 − ψ1 .

The ﬁrst and the third of these equations require
◦
= (−ν0+3Q)/4 whereas the second and the
that ψ1
◦
fourth equations require that ψ1
= (−ν0 − Q)/4.
These two requirements are in general not compat-
ible and the ring cannot be made spin transparent
in this way.

2. I + = 0 due to condition 1 and I − = 0 due to

condition 3 requires
◦
= π + (−ν0 + Q)/4 , ψ3
◦
= π + (−ν0 − Q)/4 , ψ3

ψ1

ψ2

◦
= ψ1 ,
◦
= 2(−ν0 − Q)/4 − ψ1 .

(9)

The ﬁrst and the last of these equations together
◦
= π−(3Q−ν0)/4. This is in conﬂict with
require ψ3
the second equation. Thus this way also cannot
lead to a spin transparent ring.

3. I + = 0 due to condition 1 and I − = 0 due to

condition 2 requires

ψ1

ψ2

◦
= π + (−ν0 + Q)/4 , ψ3
◦
= π + 2(−ν0 − Q)/4 − ψ1 , ψ3

◦
= ψ1 ,

◦
= ψ1 .

These 4 equations are compatible and lead to ψ1
◦
= (−ν0 − 3Q)/4.
ψ3

◦
= π + (−ν0 + Q)/4 and ψ2

The type III snake at l = 0 has the rotation angle
ψ4 which is chosen in such a way that the closed-orbit
spin tune of the ring does not change due to the snakes,
◦
= 0. The required rotation angles
i.e. ψ1 + ψ2 + ψ3 + ψ4
are then

(10)

◦
=

l = 0

l = 0

(cid:23)+3Q

Q+3(cid:23)

3Q(cid:0)(cid:23)

3(cid:23)(cid:0)Q

[(cid:25) (cid:0)

℄

[

℄

[

℄

[

℄

4

4

4

4

Q(cid:0)(cid:23)

(cid:23)+Q

[(cid:25) +

℄

[(cid:25) (cid:0)

℄

4

4

FIG. 5: The only two ways to snake match a ring with super-
periodicity 4 by 4 type III snakes. The number [x] denotes
x mod 2π and lies in [0, 2π). The vertical tune times 2π is
denoted by Q and ν0 = Gγ2π

cannot be a practical snake scheme, since it does not
make the closed-orbit spin tune independent of energy.
But it illustrates how type III snakes can be used at ﬁxed
energy to make spin perturbations from diﬀerent parts
of the ring cancel each other. This feature can then be
used in combination with the Siberian Snakes which are
installed to make the closed-orbit spin tune independent
of energy.

B. Snake Matching with Type III Snakes for
Super-Periodicity 4 and Mirror Symmetry:

In particle optical systems, mirror symmetries are of-
ten used to cancel perturbative eﬀects [29, 30, 31, 32].
Therefore it is interesting to see whether mirror symme-
try can lead to vanishing of spin-orbit-coupling integrals
when 4 Siberian Snakes are installed at the symmetry
points of the ring. If one super-period is mirror symmet-
ric, then

I ±

1
8

I ±

1
4

=

Z
0
= I ±

1
8

π/4

kyei(−Ψ±Φ)dθ ,

+ (I ±

)∗ei(−ν0±Q)/4 .

1
8

(12)

(13)

With Σ± = (−ν0 ± Q)/4 one obtains for the complete
ring

I ± = (I ±

+ (I ±

)∗eiΣ±

) · (1 + eiΣ±

+ ei2Σ±

+ ei3Σ±

).(14)

1
8

1
8

ψ1

◦
= ψ3

◦
= π +

ψ2

◦
= −

ν0 + 3Q
4

−ν0 + Q
4

,

, ψ4

◦
=

Q − 3 − ν0
4

.

(11)

Type III snakes will not be considered further, since
a horizontal Siberian Snake with snake angle ϕ can be
decomposed into a radial Siberian Snake and a type III
snake with rotation angle 2ϕ.

C. Snake Matching of Siberian Snakes with Fixed
Axes at All Energies for Super-Periodicity 4:

Thus snake matching the ring with super-periodicity 4
is not inﬂuenced by the fact that the ring might have a
mirror symmetry since the bracket in (14) is equivalent to
the corresponding bracket in (4) for rings without mirror
symmetry.

a. Schemes with 4 Snakes: For 4 horizontal Siberian

Snakes the spin-orbit-coupling integral in (3) is

I ± =

kyei(−Ψ0±Φ0)dθ

(15)

θ1

Z

θ0

θ3

2π

θ2

+ei(−Ψ0±Φ0)

Z
+ei(−Ψ0+α1+Ψ1±(Φ0+Φ1))

θ1

kyei(Ψ1+α1±Φ1)dθ

×

kyei(−Ψ2−α2±Φ2)dθ

Z
θ2
+ei(−Ψ0+α1+Ψ1−α2−Ψ2±(Φ0+Φ1+Φ2))

×

Z

θ3

kyei(Ψ3+α3±Φ3)dθ .

For a ring with super-periodicity 4 and with 4 equally
spaced horizontal Siberian Snakes one obtains with ν0 =
Ψ(2π), Ψj = Ψ(2π)/4, and Φj = Q/4 the relation

π
2

=

I ±

1
4

Z
0
I ± = I ±

kyei(−Ψ±Φ)dθ ,

(1 + ei(−Ψ0+α1+Ψ1−α2±(Φ0+Φ1)))

(16)

(17)

+(I ∓

)∗ei(−Ψ0+α1±Φ0)

× (1 + ei(Ψ1−α2−Ψ2+α3±(Φ1+Φ2)))
= I ±
(1 + ei(α1−α2±2Q/4))

1
4

1
4

1
4

1
4

+(I ∓

)∗ei((−ν0±Q)/4+α1)(1 + ei(−α2+α3±2Q/4)) .

Spin transparency of the ring is therefore obtained when

α1 − α2 ± 2Q/4

◦
= π and − α2 + α3 ± 2Q/4

◦
= π . (18)

This cannot be achieved in general since the conditions
◦
◦
= π have to be
α1 − α2 + 2Q/4
= π and α1 − α2 − 2Q/4
◦
= 0.
satisﬁed simultaneously, which implies Q

In the case of mirror symmetry in the ring I +

and I −

1
4

1
4

are related by (13),

= I ±

+ (I ±

)∗ei(−ν0±Q)/4 ,

(19)

(I ∓

)∗ = (I ∓

)∗ + I ∓

e−i(−ν0∓Q)/4

= I ∓

e−i(−ν0∓Q)/4 .

(20)

1
8

1
8

1
8

1
4

1
8

With mirror
coupling integral then simpliﬁes to

symmetric quadrants

the

spin-orbit-

I ± = I ±

(1 + ei(α1−α2±2Q/4))

I ±

1
4

1
4

1
4

1
4

6

(22)

(23)

and again this additional symmetry does not simplify the
compensation of the spin-orbit integrals.

b. Schemes with 8 Snakes: The same procedure can
now be repeated with 8 snakes. For that purpose 4 more
horizontal Siberian Snakes are placed at the locations
jπ/2 + ∆θ, j ∈ {0, 1, 2, 3}. In terms of the integrals

I ±
0 =

I ±
1 =

∆θ

Z
0

π
2

Z

∆θ

kyei(−Ψ±Φ)dθ ,

kyei(Ψ±Φ)dθ ,

the spin orbit coupling integrals of (3) are

I ± = I ±

0 (1 + ei(−Ψ0+α1+Ψ1−α2±(Φ0+Φ1)) + . . .
+ ei(−Ψ0+α1+Ψ1−α2∓...−αn−2±(Φ0+...+Φn−3)))
+ I ±
+ . . .
+ ei(Ψ1−α2−Ψ2+α3±...+αn−1±(Φ1+...+Φn−2))) .

1 ei(−Ψ0+α1±Φ0)(1 + ei(Ψ1−α2−Ψ2+α3±(Φ1+Φ2))

(24)

If there is an additional mirror symmetry and the snakes
are all placed in the symmetry points, (13) implies I ±
1 =
(I ±
0 )∗ei(−ν0±Q)/4, which again does not lead to simpli-
ﬁcations. The complete spin phase advance of the ring
n
j=0(−)j(Ψj + αj ) = π. Since this phase advance
is
n
j=0(−)j Ψj
is required to be independent of energy,
has to vanish. Because of the super-periodicity this re-
quires Ψ0 = Ψ1, and all the spin phases Ψj in the equa-
tions (25) cancel. Then in terms of the diﬀerence angles
∆jk = αj − αk, spin matching the ring requires

P

P

1 + ei(±Q/4+∆12) + ei(±2Q/4+∆12+∆34)
+ ei(±3Q/4+∆12+∆34+∆56) = 0 ,
1 + ei(±Q/4−∆23) + ei(±2Q/4−∆23−∆45)
+ ei(±3Q/4−∆23−∆45−∆67) = 0 .

(25)

(26)

Sets of 4 complex numbers with modulus 1 can only add
up to zero by the three schemes shown in Fig. 3. The
equations (25) and (26) have the same structure as the
matching conditions of equations (6) and the relations
(12) can therefore be used to obtain the following two
ways to satisfy (25):

∆12

∆12

◦
= ∆56
◦
= ∆56

◦
= π − Q/4 , ∆34
◦
= π + Q/4 , ∆34

◦
= 3Q/4 ,
◦
= −3Q/4 .

(27)

(28)

Equation (28) resulted from reversing the sign of Q in
(27). There are also exactly two possibilities for solving
(26),

∆23

∆23

◦
= ∆67
◦
= ∆67

◦
= π + Q/4 , ∆45
◦
= π − Q/4 , ∆45

◦
= −3Q/4 ,
◦
= 3Q/4 .

(29)

(30)

+ I ∓

(1 + ei(−α2+α3±2Q/4))ei(α1±2Q/4)

(21)

There are now 4 possibilities to snake match the ring;
these are obtained by combining the equations (27)&(29),

(27)&(30), (28)&(29), or (28)&(30), where the last two
possibilities also result from the ﬁrst two by reversing the
sign of Q. Figure 6 shows how parts of the ring cancel the
depolarizing eﬀects of other parts in these snake matching
schemes.

3q

(cid:0)

(cid:0)

(cid:0)

+

I

0

I

I

1

0

I

1

+

+

I

0

I

0

l = 0

l = 0

+

(cid:0)

I

1

I

1

(cid:0)

(cid:0)

+

(cid:0)

I

1

I

I

0

1

I

0

FIG. 6: The two possibilities by which the individual parts
of the ring cancel the spin-orbit-coupling integrals. Changing
the sign of Q leads to two corresponding snake schemes. The
−
symbols I +
0 , I +
1 indicate which part of the spin-
orbit-coupling integrals are canceled

1 , and I

0 , I

−

Since only diﬀerences in the snake angles appear, one
of the angles can be chosen arbitrarily. This then ﬁxes all
other snake angles. Here α1 = 0 is chosen for simplicity.
This leads to the following possibilities:

Combination of the equations (27) and (29):

α1

α4

α7

◦
= 0 , α2
◦
= −3Q/4 , α5
◦
= 0 , α8

◦
= π + Q/4 .

◦
◦
= 0 ,
= π + Q/4 , α3
◦
= π + Q/4 ,

◦
= 0 , α6

(31)

(32)

(33)

Combination of the equations (27) and (30):

α1

α4

α7

◦
= 0 , α2
◦
= −Q/4 , α5
◦
= −2Q/4 , α8

◦
= π + Q/4 , α3

◦
= −4Q/4 , α6

◦
= π − Q/4 .

◦
= 2Q/4 ,
◦
= π − 3Q/4 , (35)

(34)

(36)

The values for α8 were obtained from the requirement
◦
= π. The last snake
α8 − α7 + α6 − α5 + α4 − α3 + α2 − α1
scheme can be simpliﬁed by decreasing all snake angles
by 2Q/4, leading to

α1

α4

α7

◦
= π + 2Q/4 , α3

◦
= Q/4 , α2
◦
◦
= −3Q/4 , α6
= 0 , α5
◦
= −Q/4 , α8

◦
= π .

◦
= 3Q/4 ,

◦
= π − 2Q/4 ,

(37)

(38)

(39)

These snake schemes are shown in Fig. 7 where account
has been taken of the fact that the actual angle between
the snake’s rotation axis and the radial direction is α/2.
Furthermore advantage has been taken of the fact that
the angle α/2 only needs to be known modulo π.

Here it is very important to note that the snake angles
are independent of ν = Gγ and therefore that a snake

7

q

q

3q

2q

l = 0

l = 0

q

q

3q

2q

q

FIG. 7: Two of the 4 ways to snake match a ring with super-
periodicity 4 using 8 horizontal Siberian Snakes. The number
q denotes Q/8 mod π and lies in [0, π). The vertical tune
times 2π is denoted by Q and ν = Gγ2π. The other two
possible snake schemes are obtained by reversing the sign of
Q. When all snake angles are increased by the same amount,
then the ring remains spin transparent. Note that the snake
angle is independent of ν and thus of energy

match has been achieved for all energies. With 4 Siberian
Snakes such an energy independent snake match is not
possible in a four-fold symmetric ring.

One could repeat the same procedure for a layout with
6 horizontal Siberian Snakes or with combinations of, for
example, 6 horizontal Siberian Snakes and two type III
snakes. Due to their three-fold symmetry, this could be
of special interest for the RHIC rings.

V. SNAKE MATCHING HERA-P

A. Schemes with 4 snakes:

When the spin-orbit-coupling integrals starting at an
azimuth θ0 are minimized, the opening angle of the in-
variant spin ﬁeld at θ0 for the approximation of linear
spin-orbit motion is also minimized. In fact, Plim = 1
in linear approximation if I ± = 0 since then the spin
motion is decoupled from the orbit to ﬁrst order.

It has been seen from the example of a ring with super-
periodicity 4 that 8 Siberian Snakes can be used to snake
match the spin-orbit-coupling integrals to zero at one az-
imuth of the ring for all energies. This could be achieved
since the snake angles were used to adjust the spin phase
advances in such a way that perturbations in one part of
the ring were compensated by identical perturbations in
one of the identical super-periods of the ring.

HERA-p has 4 identical arcs separated by 4 not identi-
cal straight sections. Due to the lack of four-fold symme-
try it is in general not possible to ﬁnd snake angles which
completely compensate all spin-orbit-coupling integrals.
However, the 4 identical arc sections of HERA domi-
nate the spin-orbit resonance strength of vertical motion.
Thus it would make sense to arrange that the perturbing
eﬀect of these arcs cancel each other. A ﬁrst step in this

direction is a symmetrization of the quadrants by mak-
ing the spin phase advance in all of the straight sections
identical. This can be done by the insertion of two more
ﬂattening snakes.

y and ˆI −

The spin-orbit-coupling integrals from the ﬁrst regular
FODO cell to the last FODO cell of a regular arc in
HERA-p will be denoted by ˆI +
y and the azimuths
of the beginnings of the 4 regular arcs as θ1, θ2, θ3, and θ4.
The central points of the South, West, North, and East
straight sections are denoted by S, W , N , and E. The
spin phase advances between the arcs are compensated
using, the snake angles ϕE, ϕN , and ϕW . The spin phase
advance between θi and θj is denoted by Ψij. These
notations are indicated in Fig. 8.

(cid:9)

= 2('

(cid:0) '

)

24

W

N

(cid:18)

3

N

(cid:18)

2

W

E

(cid:18)

4

S

(cid:18)

1

(cid:9)

= 2('

(cid:0) '

)

13

N

E

FIG. 8: The spin phase advance from the beginning of one
regular arc to the beginning of the regular arc on the opposite
side of the ring. Large arrows indicate Siberian Snakes, mall
arrows indicate ﬂattening snakes.

8

This shows that it is always possible to cancel one of
the spin-orbit coupling integrals by choosing the snake
angles so that the spin perturbation produced in one of
the arcs is canceled by the arc on the opposite side of
the ring. Since | ˆI +| and | ˆI −| are diﬀerent, neighboring
arcs can in general not compensate each other when 4
Siberian Snakes are used.

It is however possible to use the eight-snake scheme
found for symmetric lattices. The two special 8 Siberian
Snake schemes which lead to an energy independent
snake match in a ring with super-periodicity 4 will not
spin-match HERA-p completely, but the spin perturba-
tion from the arcs, which are the dominant perturbation,
will be compensated exactly. This possibility of having
a set of Siberian Snake angles which do not have to be
changed with energy and which lead to a tightly bundled
invariant spin ﬁeld is on the one hand very attractive; on
the other hand it requires 8 Siberian Snakes of which 4
would have to be installed at the centers of the HERA-p
arcs, where technical requirements of moving cryogenic
feed-throughs and super-conducting magnets would be
very costly. If possible, a four-snake scheme should there-
fore be found.

Whereas it was shown below (18) that a four-snake
scheme cannot cancel both spin-orbit-coupling integrals
in a ring with super-periodicity, a corresponding cancela-
tion of the spin perturbation due to the arcs in HERA-p
can nevertheless be achieved since the orbital phase ad-
vances between the arcs can be manipulated individually,
while these four phase advances are equal for a lattice
with super-periodicity 4.

To cancel both spin-orbit integrals in (42), 4 phase

factors have to be −1. This requires

2(ϕE − ϕN ) + Φ13

2(ϕE − ϕN ) − Φ13

2(ϕW − ϕN ) + Φ24

2(ϕW − ϕN ) − Φ24

◦
= π ,
◦
= π ,
◦
= π ,
◦
= π .

(42)

(43)

(44)

(45)

With Siberian Snakes in each of the straight sections,
the spin phase advance from θ1 to θ3 is given by Ψ13 =
Ψ1E − 2ϕE − ΨEN + 2ϕN + ΨN 3. The spin phase advance
is identical in all quadrants of the ring. The total spin
phase advance is then solely determined by the snake
angles and is therefore independent of energy: Ψ13 =
2(ϕN − ϕE) and Ψ24 = 2(ϕW − ϕN ). The orbital phase
advance Φ(θ3) − Φ(θ1) also does not depend on energy.
For simplicity, Φ(θj) − Φ(θi) will now be denoted by Φij.
The spin-orbit-coupling integrals at the South interac-
tion point then contain the following contributions from
the 4 regular arcs:

arcs = ˆI +ei(−ΨS1+ΦS1)(1 + ei[2(ϕE−ϕN )+Φ13])
I +
(40)
+( ˆI −)∗ei(2ϕE −ΨSE +ΨE2+ΦS2)(1 + ei[2(ϕW −ϕN )+Φ24])
arcs = ˆI −ei(−ΨS1−ΦS1)(1 + ei[2(ϕE−ϕN )−Φ13])
I −
(41)
+( ˆI +)∗ei(2ϕE−ΨSE +ΨE2−ΦS2)(1 + ei[2(ϕW −ϕN )−Φ24])

Subtraction of the ﬁrst two equations leads to the re-
quirement that the betatron phase advance from θ1 half
way around the ring to θ3 is an odd or even multiple of
π. The same is true for the phase advance from θ2 to
θ4. Correspondingly, the spin phase advance over these
regions has to be an odd multiple of π when the orbit
phase advance is an even multiple and vice versa. With
a rather benign change of the vertical optics in HERA-p
which does not change the vertical tune, the contribution
of the regular arcs to both spin-orbit-coupling integrals
can be canceled, even in a four-snake scheme.

π
2

The snake scheme (0 π
2

π
2 )o has Ψ13 = 0 and Ψ24 = 0.
For this snake scheme, the betatron phase advances from
θ1 to θ3 and from θ2 to θ4 were adjusted to be odd mul-
tiples of π. This change of the optics is indicated by the
index o in the notation of the snake scheme. The maxi-
mum time average polarization Plim is plotted (blue) in
Fig. 9 for the complete range of HERA-p momenta (top)

and for the critical momentum regions above 800 GeV/c
(bottom). As a comparison, Plim for a standard snake
scheme ( π

4 0) (red) is also shown.

4 0 π

The complete snake match of the arcs in HERA-p in
deed eliminates all strong reductions of Plim over the
complete momentum range. Nonlinear eﬀects will be an-
alyzed later, but as far as the linear eﬀects are concerned,
this snake matched lattice of HERA-p would be a rather
promising choice for the acceleration of polarized proton
beams.

P

lim

1

0.8

0.6

0.4

0.2

0

0.8

0.6

0.4

0.2

0

P

lim

1

100

300

500

700

900

p (GeV =)

800

810

820

830

p (GeV =)

FIG. 9: Improvement of Plim by matching 4 snake angles and
the orbital phases. The snake arrangement is (0 π
π
2 )o (blue).
2
As a comparison Plim from linearized spin-orbit motion is
shown for the same HERA-p optics with a ( π
4 0)o snake
scheme (red )

4 0 π

π
2

B. Schemes with 8 snakes:

Although, for the reasons explained, eight snakes are
not very practical for HERA-p, signiﬁcant improvements
would be possible if 8 snakes were used, as will now be
shown. The snake matching schemes of Fig. 7 are suit-
able for rings with super-periodicity 4. They are there-
fore not directly applicable to HERA-p. However, the
cancelation schemes of Fig. 6 can still provide a guide to
snake matching HERA-p with 8 snakes.

The 8 Siberian Snakes are placed in the straight sec-
tions and into the centers of the arcs, so that the hori-
zontal angle between adjacent Siberian Snakes is 45◦ and
therefore Ψj = Gγπ/4 for all j ∈ {0 . . . 7}. This ensures

9

that the snake match is independent of energy since then
the nth octant’s contribution I ±
n−1 to the spin-orbit cou-
pling integral I ± can be compensated by the 2nd neigh-
bor’s contributions I ±
n+1. In particular the Ψj cancel in
the phase factor in

(46)

I ±
n−1
n+1ei[(−1)n(Ψn−1−αn−Ψn+αn+1)±(Φn−1+Φn)] .
+ I ±
Now a snake scheme for HERA-p is sought that is
guided by the cancelation scheme of Fig. 6 (left). When
the ﬁrst octant’s contribution I ±
0 to a spin-orbit coupling
integral I ± is to be compensated by that of its 2nd neigh-
bor I ±

2 , the phase factor in

I ±
0 + ei[−Ψ0+α1+Ψ1−α2±(Φ0+Φ1)]I ±
should be −1. The same should be true for the phase
factor in

(47)

2

(48)

I ±
4 + ei[−Ψ4+α5+Ψ5−α6±(Φ4+Φ5)]I ±
6 .
These conditions are satisﬁed for the superscript + as
well as − when all the snake angles αj are zero for
j ∈ {1, 2, 5, 6} and the betatron phase advances are cho-
sen appropriately. Similar conditions arise for the phase
factors involved in matching I1 against I3 and in match-
ing I5 against I7. They are also −1 when the betatron
phases are chosen appropriately and when α3 and α7 are
zero. Since α0 and α4 do not appear in these matching
conditions, they can be chosen freely. But for a design
orbit spin tune of 0.5, one has to choose α0 + α4 = π.
Here α4 = 0 has been chosen and this snake scheme is
then characterized as ( π
2 0000000)o.
In the case of HERA-p spin-orbit integrals of complete
octants cannot cancel, but the contribution of the regu-
lar arc sections can cancel. Therefore the betatron phase
◦
= π between Siberian
advance is not chosen to be Φ0+Φ1
Snakes, but rather the betatron phase advances between
the beginning of the regular arcs of the ﬁrst and the sec-
◦
= π with
ond quadrant are chosen in that way, i.e. Φ12
the notation of Fig. 8. In this conﬁguration the regular
arc of the ﬁrst octant cancels that of the third, i.e. the
regular arc’s contribution to I2 cancels that to I0. But
also the regular arc of the second octant cancels that of
the fourth since the betatron phase advance between the
centers of the ﬁrst and the second arc is then also π mod
2π, i.e. the regular arc part of I3 cancels that of I1. Simi-
larly the octants of the third quadrant cancel those of the
fourth quadrant. In the snake scheme ( π
2 0000000)o the
phase advance over the East straight section was changed
by 2π × 0.1028 to have Φ12 = 2π × 8.5. The phase ad-
vance over the West was changed by 2π × 0.0208 to have
Φ34 = 2π ×7.5. In order to have the same betatron phase
advance in the North and the South straight sections and
to keep the total tune constant, the linear optics of the
North and of the South straight sections were modiﬁed.
This cancelation scheme does not agree completely
with that of Fig. 6 (left) since in ( π
2 0000000)o the super-
scripts + and − have been dealt with simultaneously so

4 . Since Φ12

0 no longer has to compensate I ∓

◦
that I ∓
= π
◦
= π, it is appropriate to take q = π/2 for the
and Φ34
phase advance of one octant of the scheme in Fig. 7 (left),
for which one then ﬁnds a close similarity to the snake
scheme ( π
2 0000000)o. The resemblance would be even
closer if the phase advance over the North straight sec-
◦
= 0 and if α4 = π,
tion had been changed so that Φ23
α0 = 0 had been chosen. This would require an addi-
tional change of Φ41 to adjust the orbital tune.

A snake

for HERA-p which resembles
scheme
In this cancelation
Fig. 6 (right) can also be found.
scheme the phase factors in the following sums have to
be −1:

0 + ei[−Ψ0+α1+Ψ1−α2+(Φ0+Φ1)]I ±
I +
4 + ei[−Ψ4+α5+Ψ5−α6+(Φ4+Φ5)]I ±
I +
I −
0 + ei(−Ψ0+α1+Ψ1−α2−Ψ2+α3+Ψ3−α4)

6

2

× e−i(Φ0+Φ1+Φ2+Φ3)I ±
4

I −
2 + ei(−Ψ2+α3+Ψ3−α4−Ψ4+α5+Ψ5−α6)

× e−i(Φ2+Φ3+Φ4+Φ5)I ±
6

I −
1 + ei[Ψ1−α2−Ψ2+α3−(Φ1+Φ2)]I ±
5 + ei[Ψ5−α6−Ψ6+α7−(Φ5+Φ6)]I ±
I −
1 + ei(Ψ1−α2−Ψ2+α3+Ψ3−α4−Ψ4+α5)
I +

3

7

× ei(Φ1+Φ2+Φ3+Φ4)I ±
5

3 + ei(Ψ3−α4−Ψ4+α5+Ψ5−α6−Ψ6+α7)
I +

× ei(Φ3+Φ4+Φ5+Φ6)I ±
7

(49)

(50)

(51)

(52)

(53)

(54)

(55)

(56)

Plim
1

0.8

0.6

0.4

0.2

0

100

300

700

900

500

p (GeV /c)

FIG. 10: Improvement of Plim by matching 8 snake angles and
the orbital phases. The snake arrangement is ( π
2 0000000)o
(blue) and ( π
2 abc0-c-b-a)o (green). As a comparison Plim from
linearized spin-orbit motion is shown for the snake and phase
advance matched four-snake scheme (0 π
2

π
2 )o (red )

π
2

Again complete octants cannot cancel, but to cancel
the contributions of regular arc sections, the beginning
of a regular arc is chosen as the starting point for the
compensation. Now the Φn for all even n describe the
betatron phase advance from the beginning to the center
of the regular arc, and they are therefore equal. For the

10

choice α4 = 0 all phase factors are −1 if and only if
Φ5 = Φ1 and

◦
= Φ23 , α2

α1
α5 = −α3 , α6 = −α2 , α7 = −α1 .

◦
= Φ13 , α3

◦
= Φ14 ,

(57)
(58)

This snake scheme is referred to as ( π
2 abc0-c-b-a)o. The
condition Φ5 = Φ1 was satisﬁed by changing the betatron
phase advance over the East and West straight section
without changing the vertical tune.

Linearized spin orbit motion leads to a very favorable
Plim for both eight-snake schemes as shown in Fig. 10,
where it is compared to the Plim of the snake and phase
advance matched four-snake scheme (0 π
2

π
2 )o.

π
2

VI. HIGHER-ORDER RESONANCES AND
SNAKE SCHEMES

At the critical energies, where the maximum time av-
erage polarization is low during the acceleration process,
linearized spin-orbit motion does not describe spin dy-
namics well. The spin motion is inﬂuenced by several
overlapping resonances in these regions and the single res-
onance approximations [16, 33] can also not be applied.
Thus the simulation results obtained with these computa-
tionally quick techniques should always be checked with
more time consuming non-perturbative methods if pos-
sible. This is also true for the snake-matched lattices of
HERA-p with large Plim, even though they avoids large
variations of the invariant spin ﬁeld ~n(~z) over the phase
space of the beam in linearized spin-orbit motion. When
ﬁrst-order eﬀects are canceled, the higher-order eﬀects
become dominant and the quality of the snake-matched
lattice of HERA-p can only be evaluated with higher-
order theories.

Until 1996, when stroboscopic averaging [13] was in-
troduced, there was no non-perturbative method of com-
puting the ~n-axis at high energy in proton storage rings,
where perturbative methods are usually not suﬃcient
[14]. In addition, the method of anti-damping was de-
rived [34], which also computes ~n(~z) non-perturbatively
and which can be faster when the ~n-axis is required for a
range of phase space amplitudes. Both methods of com-
puting the invariant spin ﬁeld are implemented in the
spin-orbit dynamics code SPRINT, by which also the
amplitude-dependent spin tune ν( ~J) can be computed
once ~n(~z) is known. Since stroboscopic averaging and
anti-damping are based on multi-turn tracking data, they
are applicable to all kinds of circular accelerators and
they are especially eﬃcient for small rings and for simple
model accelerators. Nonlinear motion for orbit and spin
coordinates can esily be included [35, 36].

Subsequently another non-perturbative algorithm for
computing ~n(~z) and ν( ~J) has been derived [37].
It is
called SODOM-2 since it was inspired by the earlier al-
gorithm SODOM [11] which for convergence required the
angle between ~n and ~n0 to be small. With some routines

provided by K. Yokoya, SODOM-2 was incorporated into
the program SPRINT [13, 38, 39] and leads to results
which agree very well with those of stroboscopic aver-
aging. For motion in one degree of freedom, SODOM-2
is often faster than stroboscopic averaging, especially for
large rings like HERA-p where particle tracking is rela-
tively time consuming. But for orbit motion in more than
one degree of freedom or in the vicinity of spin-orbit res-
onances, SODOM-2 becomes exceedingly slow and then
stroboscopic averaging and anti-damping are needed.

4 0 π

To check whether the improvements of spin motion ob-
tained in the framework of linearized spin-orbit motion
survive when higher-order eﬀects are considered, Plim
and ν has been calculated. The result for one of the
standard Siberian Snake schemes which used to be con-
sidered advantageous by popular opinion is shown for
the South interaction point of HERA-p in Fig. 11.
It
has four Siberian Snakes in the ( π
4 0) scheme. Some
of the features of Plim were already revealed by lin-
earized spin-orbit motion in Fig. 1. Now many higher-
order resonances are revealed, causing strong reduction of
Plim and there are corresponding strong variations of the
amplitude-dependent spin tune ν [40, 41]. Strong reso-
nances occur especially in the critical energy region where
linearized spin orbit motion in Sect. II already indicated a
very small Plim due to a coherent spin perturbation in all
regular FODO cells. Many higher-order resonances over-
lap in these critical energy regions of Fig. 11 (top) where
large spin tune jumps can be observed in Fig. 11 (bot-
tom). The strongest spin tune jumps occur in the criti-
cal energy regions, mostly at the second order resonance
ν = 2Qy which is indicated by the top line [42].

lim

1P
0.8
0.6
0.4
0.2
0

(cid:23)

0.6

0.5

0.4

800

810

820

830

p (GeV =)

4 0 π

FIG. 11: Plim and ν for particles with a vertical amplitude
corresponding to the 2.5σ emittance in the HERA-p lattice of
the year 2002 with the ( π
4 0) scheme. Top: The maximum
time average polarization Plim for the complete acceleration
range (left) and for the critical energy range above 800 GeV/c
which has to be crossed when accelerating to the proposed
storage energy of 870 GeV/c. Bottom: the corresponding
amplitude dependent spin tune ν(Jy). The second-order res-
onances ν = 2Qy and ν = 1 − 2Qy are indicated (red )

Figure 12 also shows Plim and ν for higher-order
spin dynamics in the snake-matched and phase-advance-
matched HERA-p ring with 4 Siberian Snakes. While

11

the overall behavior of Plim over the complete accelera-
tion range of HERA-p looks similar to the result obtained
with linearized spin-orbit motion, which was displayed in
Fig. 9, higher-order eﬀects become very strong at high
energies, especially in the vicinity of the critical ener-
gies where perturbations of spin motion in each FODO
cell accumulate. The spin tune spread at momenta be-
low 400 GeV/c is small and higher-order eﬀects seem to
be benign even at these critical energies. A comparison
of Figs. 11 and 12 hello shows that the special scheme
obtained by matching orbital phases and snake angles
would be a very good choice for HERA-p up to 300 or
400 GeV/c. For linearized spin-orbit motion, this snake-
matched scheme does not produce a strong reduction of
Plim at any critical energy, but the higher-order eﬀects
become very pronounced at some top energies of HERA-
p. Nevertheless, the advantage over other snake schemes
becomes clear in ﬁgure Fig. 12 (bottom) where the am-
plitude dependent spin tune ν is shown. It comes close
to a second order resonance at fewer places and does not
exhibit spin tune jumps which are as strong as those in
previous ﬁgures of ν.

In this snake-matched scheme, the inﬂuence of higher-
order eﬀects can be seen very clearly, because the ﬁrst-
order eﬀects have been matched to be very small. The
analysis of ν shows that completely snake matching the
spin perturbations in the arcs of HERA-p with 4 Siberian
Snakes is advantageous, even though dips of Plim due to
higher-order resonances can be observed at high energies.
Even around 300 GeV/c there are resonant dips of Plim
in Fig. 12 (middle) but they are less pronounced than
those in Fig. 11 so that the snake matched scheme should
be very advantageous in the complete energy range of
HERA-p.

It should be noted that the destructive spin tune jumps
at second order resonances disappear completely when
HERA-p is simulated without its non-ﬂat regions. This
is due to the fact that a large class of resonances are not
excited at all in mid-plane symmetric rings [5, 43]. To
reduce these perturbations, the East region of HERA-p
will now be simulated as ﬂat since the HERMES exper-
iment located in this region does not require that the
proton beam is on the level of the electron beam.

When a particle is accelerated across the critical mo-
mentum region from 800 to 806 GeV/c with a typical
acceleration rate of 50 keV per turn, the adiabatic in-
variance of JS = ~n · ~S can be violated and the level of
violation will depend on the orbital amplitude and the
snake scheme. This violation is illustrated in the graphs
in Fig. 13 which, for three diﬀerent snake schemes, show
the average spin action ¯JS at 806 GeV/c which had ini-
tially JS = 1 at 800 GeV/c before acceleration.

The change of JS in the critical energy region depends

800

810

820

830

p (GeV =)

VII. POLARIZATION REDUCTION DURING
ACCELERATION

lim

1P
0.8
0.6
0.4
0.2
0

(cid:23)

0.6

0.5

0.4

800

810

820

830

800

810

820

830

p (GeV =)

p (GeV =)

FIG. 12: Plim and ν for a 2.5σ vertical amplitude after the
betatron phase advance between opposite regular arc struc-
tures was adjusted to be an odd multiple of π in the (0 π
π
2 )o
2
scheme. The resonances ν = 2Qy and ν = 1 − 2Qy are indi-
cated (red )

π
2

on the initial phase space angle so that if JS had been
computed only for one particle, it could by chance have
had an angle variable for which JS does not change al-
though it would have changed for other points with the
same vertical phase space amplitude. To avoid such a
chance eﬀect which gives the impression that JS is in-
variant, three particles were accelerated and the average
¯JS is displayed in Fig. 13.

At small phase space amplitudes, JS is nearly invari-
ant and therefore ¯JS = 1. For each of the three snake
schemes, there is a phase space amplitude Jymax above
which ¯JS < 1 and the regions of the beam with an am-
plitude above Jymax lead to a reduction of the beam’s
polarization during the acceleration process.

4 0 π

For the standard snake scheme ( π

4 0), only the part
of the beam with less than 1π mm mrad vertical am-
plitude can remain polarized. For the ﬁltered scheme
( 3π
π
4 )o, phase space amplitudes up to 4π mm mrad
4
are allowed. Finally the snake matched scheme ( π
π
4 )o
gives the most stable spin motion and Fig. 13 shows that

4 0 π

3π
8

3π
8

4

12

vertical amplitudes of up to 8π mm mrad are allowed.
This shows that the snake matched scheme is superior

1(cid:22)

S

J

0.8

0.6

0.4

0.2

1(cid:22)

S

J

0.8

0.6

0.4

0.2

1(cid:22)

S

J

0.8

0.6

0.4

0.2

0

4

8

12

16

0

4

8

12

16

0

4

8

12

16

Amplitude ((cid:25)mm mrad)

Amplitude ((cid:25)mm mrad)

Amplitude ((cid:25)mm mrad)

FIG. 13: Average spin action ¯JS at 806 GeV for particles
starting with JS = 1 at 800 GeV/c for three diﬀerent snake
π
schemes. Left:
4 )o, Right:
4 0), Middle:
(0 π
π
2 )o scheme. Particles with an amplitude above 1 (left),
2
4 (middle), and 8 (right) lead to a reduction of polarization
when the beam is accelerated through this critical energy re-
gion

( π
4 0 π

( 3π
4

3π
8

3π
8

π
2

to the other four-snake schemes studied here. It stabi-
lizes spin motion for 10 times larger phase space am-
plitudes than some other snake schemes. Nevertheless,
8π mm mrad is not enough to allow high polarization at
top energies for today’s emittances in HERA-p.

Matching 8 Siberian Snakes in HERA-p lead to two
snake schemes with very high Plim and very small spin
tune spread. But to demonstrate that it is possible to
further stabilize spin motion in HERA-p by such schemes,
Fig. 14 shows the vertical phase space amplitudes for
which JS remains invariant. The more eﬀective of the
two snake scheme stabilizes spin motion up to a vertical
amplitude of 14π mm mrad.

J

J

S

1(cid:22)
0.8
0.6
0.4
0.2

S

1(cid:22)
0.8
0.6
0.4
0.2

0

4

8

12

16

0

4

8

12

16

Amplitude ((cid:25)mm mrad)

Amplitude ((cid:25)mm mrad)

FIG. 14: The average spin action ¯JS at 806 GeV for particles
which started with JS = 1 at 800 GeV/c for the 2 diﬀerent
snake matched eight-snake schemes ( π
2 0000000)o (left) and
( π
2 abc1-c-b-a)o (right). Particles with an amplitude above 13
(left) and 15 (right) lead to a reduction of polarization when
the beam is accelerated through this critical energy region

These results for the various snake schemes are col-
lected in Fig. 15, where it becomes clear that snake
matching with 4 and especially with 8 snakes leads to
a signiﬁcant improvement. In HERA-p it does not suf-
ﬁce to avoid a reduction of JS for particles with less than
14π mm mrad amplitude.
It would therefore be very
helpful to use electron cooling in PETRA [45, 46? ] so
as to reduce the emittance in HERA-p and to allow for
an acceleration without loss of polarization for most par-
ticles in the beam.

(cid:22)

J

S

1

0.9

0.8

0.7

0

2

4

6

8

10

12

14

16

Vertial amplitude ((cid:25)mm mrad)

FIG. 15: The average spin action ¯JS at 806 GeV for par-
ticles which started initially with JS = 1 at 800 GeV/c.
Violet: The standard scheme which stabilizes spin motion
for particles within 1π mm mrad, Cyan: the ﬁltered four-
snake scheme stabilizes within 4π mm mrad, Red: the snake-
matched four-snake scheme stabilizes within 8π mm mrad,
Green: the snake-matched eight-snake scheme which stabi-
lizes within 13π mm mrad, Blue: and the snake-matched
eight-snake scheme which stabilizes within 14π mm mrad of
vertical phase space amplitude

13

The excellent performance of the two schemes with 8
Siberian Snakes is due to much smaller oscillation of the
amplitude dependent spin tune during the acceleration
process, and the destructive second order spin-orbit res-
onances indicated in Fig. 16 (bottom and top-right) are
hardly encountered when these snake schemes are cho-
sen. Correspondingly Plim only drops to small values at
very few energies in Figs. 16 (center and top-left).

Contemplating all these results, it can be concluded
that it is not possible to give a simple formula for the
number of snakes which are required for a given acceler-
ator since diﬀerent snake schemes with the same number
of snakes lead to very diﬀerent stability of spin motion.
It has even been shown that 8 snakes are not necessarily
better than 4 snakes for the non-ﬂat HERA-p ring [47].
In the end detailed evaluation is needed.

Acknowledgments

Desmond Barber’s careful reading and improving of the manuscript

[1] K. Steﬀen:

Strong spin matching with and without
snakes, a scheme for preserving polarization in large ring
accelerators. DESY-88-068 (1988)

[2] E. D. Courant, S. Y. Lee, and S. Tepikin. AIP Conference
Proceedings 145, page 174, New York, 1985. American
Institute of Physics.

[3] D. P. Barber, K. Heinemann, G.H. Hoﬀstaetter, and
M. Vogt: The permissible equilibrium polarization dis-
tribution in a stored proton beam.
In ICFA Proceed-
ings Quantum Aspects of Beam Physics, World Scientiﬁc
(1998)

[4] G.H. Hoﬀstaetter: Aspects of the Invariant Spin Field
for High Energy Polarized Proton Beams. Habilitation,
Darmstadt University of Technology, (January 2000)
[5] M. Vogt: Bounds on the maximum attainable equilib-
rium spin polarization of protons in HERA. Dissertation,
Universit¨at Hamburg, DESY-THESIS-2000-054 (Decem-
ber 2000)

[6] M. Vogt, D.P. Barber, and G.H. Hoﬀstaetter: Introduc-
tion to the invariant spin ﬁeld and update on simulations
with polarized protons at HERA-p. In DESY-HERA-98-
04 (1998)

[7] G.H. Hoﬀstaetter, H.S. Dumas, and J.A. Ellison: Adia-
batic invariants for spin-orbit motion. In Proceedings to
EPAC02, Paris and DESY-M-02-01 (2002)

[8] A.W. Chao: Evaluation of radiative spin polarization in
an electron storage ring. Nucl. Instr. Meth. 180:29 (1981)
[9] Yu. Eidelman and V. Yakimenko: The application of Lie
methods to the spin motion in nonlinear collider ﬁelds.
Particle Accelerators, 45:17-35 (1994)

[10] S.R. Mane: Electron-spin polarization in high-energy
storage rings. II. Evaluation of the equilibrium polariza-
tion. Phys. Rev. A(36):120-130 (1987)

rium polarization of stored electron beams. KEK-92-6,
Tsukuba (1992)

[12] V. Balandin and N. Golubeva: Nonlinear spin dynam-
ics. Proceedings of the XV International Conference on
High-energy Particle Accelerators, Hamburg, p. 998-1000
(1992)

[13] K. Heinemann and G.H. Hoﬀstaetter: A tracking algo-
rithm for the stable spin polarization ﬁeld in storage rings
using stroboscopic averaging. Phys. Rev. E 54:4240-4255
(1996)

[14] G.H. Hoﬀstaetter, M. Vogt,

Higher-order eﬀects
Phys. Rev. ST-AB, 2(11):1-15 (1999)

and D.P. Barber:
in polarized proton dynamics.

[15] D.P. Barber, G.H. Hoﬀstaetter, and M. Vogt: Polarized
protons in HERA. In Proceedings to EPAC02, Paris and
DESY-M-02-01 (2002)

[16] M. Froissart and R. Stora: Depolarisation d’un fais-
ceau de protons polarises dans un synchrotron. Nucl. In-
str. Meth. 7:297-305 (1960)

[17] V. Balandin, N. Golubeva, and D.P. Barber: Studies of
the behavior of proton spin motion in HERA-p at high
energies. DESY-M-96-04 (1996)

[18] Ya.S. Derbenev and A.M. Kondratenko: Acceleration
of polarized particles. Sov. Phys. Doklady, 20:562, 1976.
also in russ.: Dokl.Akad.Nauk Ser.Fiz.223:830-833 (1975)
[19] S.Y. Lee: Spin dynamics and Snakes in synchrotrons.

World Scientiﬁc (1997)

[20] D.P. Barber and A. De Roeck, editors: Proceedings of
Polarized Protons at High Energies, DESY-Proceedings-
1999-03 (1999)

[21] V. Anferov:

820 GeV/c polarized protons in HERA,

SPIN@HERA report update. In [20].

[22] A.W. Chao: Workshop summary - accelerator issues. In

[11] K. Yokoya: Non-perturbative calculation of equilib-

[20].

1Plim
0.8
0.6
0.4
0.2
0

ν
0.6

0.5

0.4

800

810
820
p (GeV /c)

830

800

810
p (GeV /c)

820

830

2 0000000)o (blue) and ( π

FIG. 16: Improvement of the higher-order Plim and ν(Jy) by
matching 8 snake angles and the orbital phases. The snake ar-
rangement is ( π
2 abc0-c-b-a)o (green).
As a comparison Plim from SODOM II is shown for the snake
and phase advance matched four-snake scheme 0 π
π
2 )o (red
2
background curve). The resonances ν = 2Qy and ν = 1−2Qy
are indicated (also red )

π
2

[23] V. Ptitsin and Yu.M. Shatunov: The investigation of
spin resonances in an accelerator with Siberian Snakes. In
C.W. de Jager, T.J. Ketel, P.J. Mulders, J.E. J. Oberski,
and M. Oskam-Tamoezer, editors, Proceedings SPIN96,
p. 516-518. World Scientiﬁc (1996)

[24] E.D. Courant: Hybrid helical snakes and rotators for

RHIC. BNL-61920, Brookhaven (1995)

Polarized protons in HERA.

In

[25] G.H. Hoﬀstaetter:
DESY-96-05 (1996)

[26] B.W. Montague: Polarized beams in high-energy storage

rings. Physics Reports, 113(1):1-96 (1984)

[27] G.H. Hoﬀstaetter: Matching of Siberian Snakes. AIP

Conf.Proc.667:93-102 (2003)

14

[28] G.H. Hoﬀstaetter: Snake matching. In UM-HE 99-05,

University of Michigan (1999)

[29] H. Rose:

Hamiltonian magnetic optics. Nucl. In-

str. Meth. A258:374-401 (1987)

[30] R. Degenhardt:

Korrektur von Aberrationen in der
Teilchenoptik mit Hilfe von Symmetrien. Doctoral thesis,
Darmstadt University of Technology (1992)

[31] W. Wan: A Theory of Arbitrary Order Achromats. PhD

thesis, Michigan State University (1995)

[32] G.H. Hoﬀstaetter:

Comments on aberration correc-
tion in symmetric imaging energy ﬁlters. Nucl. In-
str. Meth. A(427):275-281 (1998)

[33] G.H. Hoﬀstaetter: Polarized protons in HERA. In Pro-

ceedings of NUCLEON99, Nucl. Phys. A (1999)
[34] D.P. Barber, M. Vogt, and G.H. Hoﬀstaetter:

The
amplitude-dependent spin tune and the invariant spin
ﬁeld in high-energy proton accelerators. In Proceedings
EPAC98, Stockholm (1998)

[35] G.H. Hoﬀstaetter:

for
charged particle motion. Ultramicroscopy 81 p. 111-121
(2000)

Successive approximations

[36] Ch. Weißb¨acker and G. H. Hoﬀstaetter: Nonlinear spin

transfer maps. In [20].

[37] K. Yokoya: An algorithm for calculating the spin tune

in circular accelerators. DESY-99-006 (1999)

[38] G.H. Hoﬀstaetter and M. Vogt: Sprint users guide and

reference manual. DESY (2002)

[39] D.P. Barber, K. Heinemann, G.H. Hoﬀstaetter, and
M. Vogt: Calculations of the equilibrium spin distribu-
tion for protons at high energy in HERA. In Proceedings
of SPIN96, Amsterdam (1996)

[40] D.P. Barber, G.H. Hoﬀstaetter, and M. Vogt: Using the
amplitude dependent spin tune to study high order spin-
orbit resonances in storage rings. In Proceedings SPIN00,
Osaka (2000)

[41] D.P. Barber, G.H. Hoﬀstaetter, and M. Vogt: Proton
and electron polarsation in storage rings: some basic con-
cepts. In Proceedings SPIN00, Osaka (2000)

[42] D.P. Barber, G.H. Hoﬀstaetter, and M. Vogt: Numerical
and theoretical spin stability studies for HERA-p. In [20].
[43] G.H. Hoﬀstaetter and M. Vogt: Odd and even order spin-
orbit resonances with Siberian Snakes. In preparation for
Phys. Rev. ST-AB (2004)

[44] P. Wesolowski, K. Balewski, R. Brinkmann, Ya. Der-
benev, and K. Fl¨ottmann: An injector study for electron
cooling at PETRA using a bunched beam. In Proceedings
of ECOOL99, Uppsala (1999)

[45] M. Gentner, D. Husmann, C. Steier, R. Brinkmann, and
Ya Derbenev: On the possibilities of electron cooling for
HERA. Nucl. Instr. Meth. A424:277-295 (1999)

[46] R. Brinkmann for the DESY electron cooling study
group: Electron cooling studies for PETRA and HERA.
In [20].

[47] D.P. Barber, G.H. Hoﬀstaetter, and M. Vogt: Spin mo-
tion at high energy in HERA-p. In UM-HE 99-05, Uni-
versity of Michigan (1999)

