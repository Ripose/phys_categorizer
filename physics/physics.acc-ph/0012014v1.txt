0
0
0
2
 
c
e
D
 
7
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
1
0
2
1
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

SLAC-AP-129
LCC-0043
December 2000

Dipole Mode Detuning in the
Injector Linacs of the NLC ∗

Karl L.F. Bane and Zenghai Li
Stanford Linear Accelerator Center, Stanford University, Stanford,
CA 94309

Abstract

The injector linacs of the JLC/NLC project include the pre-
linac, the e+ drive linac, the e− booster, and the e+ booster.
The ﬁrst three will be S-band machines, the last one, an L-band
machine. We have demonstrated that by using detuning alone
in the accelerator structure design of these linacs we will have
acceptable tolerances for emittance growth due to both injection
jitter and structure misalignments, for both the nominal (2.8 ns)
and alternate (1.4 ns) bunch spacings. For the L-band struc-
ture (a structure with 2π/3 phase advance) we take a uniform
distribution in synchronous dipole mode frequencies, with cen-
tral frequency ¯f = 2.05 GHz and width ∆δf = 3%. For the
S-band case our optimized structure ( a 3π/4 structure) has a
trapezoidal dipole frequency distribution with ¯f = 3.92 GHz,
∆δf = 5.8%, and tilt parameter α =
.2. The central frequency
and phase advance were chosen to put bunches early in the train
on the zero crossing of the wake and, at the same time, keep
the gradient optimized. We have shown that for random man-
ufacturing errors with rms 5 µm, (equivalent to 10−4 error in
synchronous frequency), the injection jitter tolerances are still
acceptable. We have also shown that the structure alignment
tolerances are loose, and that the cell-to-cell misalignment tol-
erance is & 40 µm. Note that in this report we have considered
only the eﬀects of modes in the ﬁrst dipole passband.

−

∗Work supported by Department of Energy contract DE–AC03–76SF00515.

Dipole Mode Detuning in the
Injector Linacs of the NLC

Karl L.F. Bane and Zenghai Li

September 23, 2012

1

Introduction

A major consideration in the design of the accelerator structures in the
injector linacs of the JLC/NLC[1][2] is to keep the wakeﬁeld eﬀects within
tolerances for both the nominal (2.8 ns) and the alternate (1.4 ns) bunch
spacings. One important wakeﬁeld eﬀect in the injector linacs is likely to be
multi-bunch beam break-up (BBU). With this eﬀect a jitter in the injection
conditions of a bunch train, due to the dipole modes of the accelerator
structures, is ampliﬁed in the linac. By the end of the linac bunches in
the train are driven to large amplitudes and/or the projected emittance of
the train becomes large, both eﬀects which can hurt machine performance.
Another important multi-bunch wakeﬁeld eﬀect that needs to be considered
is static emittance growth caused by structure misalignments.

To minimize the multi-bunch wakeﬁeld eﬀects in the injector linacs we
need to minimize the sum wake in the accelerator structures. The dipole
wake amplitude of the structures—and therefore also the sum wake amplitude—
scales as frequency to the -3 power. Therefore, compared to the main (X–
band) linac, the injector linac wakes tend to be smaller by a factor 1/64 and
1/512, respectively, for the S– and L–band linacs. We shall see, however,
that—in the S-band case—this reduction, by itself, is not suﬃcient. Two
ways of reducing the sum wake further are to detune the ﬁrst pass-band
dipole modes and to damp them. Detuning can be achieved by gradually
varying the dimensions of the cells in a structure. Weak damping can be
achieved by letting the ﬁelds couple to manifolds running parallel to the
structure (as is done in the main JLC/NLC linac[3]); stronger damping by,
for example, introducing lossy material in the cells of the structure.

In the injector linacs the dipole mode frequencies are much lower than in
the main linac, and the number of dipole mode oscillations between bunches

2

nd is much smaller (see Table 1). Therefore, signiﬁcantly reducing the wake
envelope at one bunch spacing behind the driving bunch by detuning alone
becomes more diﬃcult. In addition, for a given Q, the eﬀective damping is
4 (or 8) times less eﬀective than for X-band.

Table 1: Scaling of the frequency and the wake amplitude for C, S, and L
bands as compared to X band. Also given are the number of dipole mode
oscillations between bunches nd, and the damping needed to reduce the wake
amplitude by 1/e at the position of the second bunch, Qd, for the nominal
(2.8 ns) and the alternate (1.4 ns) bunch spacings.

Scaling
Band Freq. Wake
1
1/2
1/4
1/8

1
1/8
1/64
1/512

X
C
S
L

∆t = 2.8 ns ∆t = 1.4 ns
Qd
66
33
16
8

nd
21.0
10.5
5.3
2.6

nd
42.0
21.0
10.5
5.3

Qd
132
66
33
16

In this report our goal is to design the accelerator structures for the
injector linacs using simple detuning alone, i.e.
including no damping, to
take care of the long-range wakeﬁelds. We focus mostly on the S-band in-
jector linacs. We begin by discussing analytical approaches to estimating
the eﬀects of BBU and structure misalignments. We then discuss wakeﬁeld
compensation using detuning. We optimize structure dimensions for struc-
tures with 2π/3 and 3π/4 per cell phase advance, and show that the latter
is preferable. And ﬁnally we obtain tolerances to wakeﬁeld eﬀects for all the
injector linacs using both analytical formulas and numerical tracking. Note
that in this report we are only concerned with the eﬀects of modes in the
ﬁrst dipole passband, which have kick factors much larger than those in the
higher passbands. The eﬀects of the higher passband modes, however, will
need to be addressed in the future.

2 Emittance Growth

2.1 Beam Break-up (BBU)

In the case of single-bunch beam break-up in a linac the ampliﬁcation of
injection jitter can be characterized by a strength parameter dependent on

3

the longitudinal position within the bunch. When the strength parameter
is suﬃciently small the growth in amplitude at the end of the linac is given
by the ﬁrst power of this parameter[4]. For the multi-bunch case we can
derive an analogous strength parameter, one dependent on bunch number
m. When this strength parameter is suﬃciently small we expect that again
the growth in amplitude at the end of the linac is given by the ﬁrst power
of the parameter. (But even when the strength parameter is not suﬃciently
small it can be a useful parameter for characterizing the strength of BBU.)
For the multi-bunch case the strength parameter becomes (see Appendix A)

Υm =

e2N LSm ¯β0
2E0

g(Ef /E0, ζ)

[m = 1, . . . , M ] ,

(1)

with N the single bunch population, L the machine length, ¯β0 the initial
value of the beta function averaged over a lattice cell, E0 the initial energy,
Ef the ﬁnal energy, and M the number of bunches in a train. The sum wake
Sm is given by

m−1

Xi=1

Nm

n
X

Sm =

W [(m

i)∆t]

[m = 1, . . . , M ] ,

(2)

−

with W the transverse wakeﬁeld and ∆t the time interval between bunches
in a train. The wakeﬁeld, in turn, is given by a sum over the dipole modes
in the accelerator structures:

W (t) =

2kn sin(2πfnt/c) exp(

πfnt/Qn)

,

(3)

−

with Nm the number of modes, fn, kn, and Qn are, respectively, the fre-
quency, the kick factor, and the quality factor of the nth mode. The function
g(x) in Eq. 1 is one depending on the energy gradient and focusing proﬁle
in the linac. For acceleration assuming the beta function varies as ¯β
Eζ,
xζ
x

(cid:19)
If Υm, for all m, is not large, the linear approximation applies, and this
parameter directly gives the (normalized) growth in amplitude of bunch m.
If Υm is not large the projected normalized emittance growth of the bunch
train becomes (assuming, for simplicity, that, in phase space, the beam
ellipse is initially upright):

g(x, ζ) =

−
−

Eζ].

1
1

(4)

1
ζ

[ ¯β

∼

∼

(cid:18)

δǫ

1 +

≈ "

y0Υrms0

(cid:18)

σy0 (cid:19)

#

1

−

1/2

2

4

[Υm small],

(5)

with y0 the initial bunch oﬀset, Υrms0 the rms of the strength parameter
(the square root of the second moment: the average is not subtracted),
and σy0 the initial beam size. Note that the quantity Sm/M in the multi-
bunch case takes the place of the bunch wake (the convolution of the wake
with the bunch distribution) in the single bunch instability problem. As
jitter tolerance parameter, rt, we can take that ratio y0/σy0 that yields a
tolerable emittance growth, δǫt.

2.2 Misalignments

If the structures in the linac are (statically) misaligned with respect to a
straight line, the beam at the end of the linac will have an increased projected
emittance. If we have an ensemble of misaligned linacs then, to ﬁrst order,
the distribution in emittance growth at the end of these linacs is given by
an exponential distribution exp[

δǫ
δǫ/
h

δǫ
]/
h
i

−

, with[5] 1
i

=

δǫ
h

i

e2N La(xa)rmsSrms
E0

Naβ0
2

r

p

h(Ef /E0, ζ)

,

(6)

with La the structure length, (xa)rms the rms of the structure misalignments,
Srms is the rms of the sum wake with respect to the average, Na the number
of structures; the function h is given by (again assuming ¯β

Eζ):

∼

h(x, ζ) =

−
−
Eq. 6 is valid assuming the so-called betratron term in the equation of motion
is small compared to the misalignment term.

(7)

s

∼

(cid:19)

(cid:18)

[ ¯β

Eζ].

1
ζx

xζ
x

1
1

We can deﬁne a misalignment tolerance by

xat = (xa)rms

δǫt
δǫ
h

i

s

,

(8)

with δǫt the tolerance in emittance growth. What is the meaning of xat?
For an ensemble of machines, each with a diﬀerent collection of random
misalignment errors but with the same rms xat, then the distribution of
ﬁnal emittances will be given by the exponential function with expectation
value δǫt. Note that if we, for example, want to have 95% conﬁdence to
achieve this emittance growth, we need to align the machine to a tolerance
level of xat/√

.58xat.

ln .05

−

≈

1This equation is a slightly generalized form of an equation given in Ref. [5].

5

Besides the tolerance to structure misalignments, we are also interested
in the tolerance to cell-to-cell misalignments due to fabrication errors. A
structure is built as a collection of cups, one for each cell, that are brazed
together, and there will be some error, small compared to the cell dimen-
sions, in the straightness of each structure. To generate a wake (for a beam
on-axis) in a structure with cell-to-cell misalignments we use a perturbation
approach that assumes that, to ﬁrst order, the mode frequencies remain
unchanged (from those in the straight structure), and only new kick fac-
tors are needed[6] (The method is described in more detail in Appendix B).
Note that for particle tracking through structures with internal misalign-
ments, contributions from both this (orbit independent) wake force and the
normal (orbit dependent) wake force need to be included.

Machine properties for the injector linacs used in this report are given
in Table 2[2]. The rf frequencies of all linacs are sub–harmonics of the
main linac frequency, 11.424 GHz. The prelinac, e+ drive linac, e− booster
linac all operate at S–band (2.856 GHz), and the e+ booster linac at L–band
(1.428 GHz). Note that ¯βy0 and ζ are only a rough ﬁtting of the real machine
β–function to the dependence ¯β
Eζ. In Table 3 beam properties for the
injector linacs, for the nominal bunch train conﬁguration (95 bunches spaced
at ∆t = 2.8 ns), are given. For the alternate conﬁguration (190 bunches
spaced at ∆t = 1.4 ns) N is reduced by 1/√2.

∼

Table 2: Machine properties of the injector linacs. Given are the initial
energy E0, the ﬁnal energy Ef , the length L, the initial average beta function
Eζ).
in y, and the approximate scaling parameter ζ, of β with energy (β

Name
Prelinac
e+ Drive
e− Booster
e+ Booster

Band E0[GeV] Ef [GeV] L[m]
558
508
163
184

1.98
.08
.08
.25

10.0
6.00
2.00
2.00

S
S
S
L

¯βy0[m]
8.6
2.4
3.4
1.5

∼

ζ
1/2
1/2
1/4
1

3 Wakeﬁeld Compensation

For eﬀective detuning, one generally requires that the wake amplitude drop
quickly, in the time interval between the ﬁrst two bunches, and then remain

6

Table 3: Beam properties in the injector linacs under the nominal bunch
train conﬁguration (95 bunches spaced at ∆t = 2.8 ns). Given are the
bunch population N , the rms bunch length σz, the initial energy spread
σδ0, and the nominal normalized emittance in y, ǫyn. Note that under the
alternate bunch train conﬁguration (190 bunches spaced at ∆t = 1.4 ns) N
is reduced by 1/√2.

Name
Prelinac
e+ Drive
e− Booster
e+ Booster

N [1010] σz[mm] σδ0[%]
0.5
2.5
2.5
9.0

1.20
1.45
1.45
1.60

1.
1.
1.
3.5

ǫyn[m]
10−8
10−4
10−4
10−2

×
×
×
×

3
1
1
6

low until the tail of the bunch train has passed. In the main (X-band) linac
of the NLC, Gaussian detuning is used to generate a fast Gaussian fall-oﬀ in
the wakeﬁeld; in particular, at the position of the second bunch the wake is
reduced by roughly 2 orders of magnitude from its initial value. The short
time behavior of the wake can be analyzed by the so-called “uncoupled”
model. According to this model (see, for example, Ref. [8])

W (t)

2ksn sin(2πfsnt/c)

[t small],

(9)

Nc

≈

n
X

where Nc is the number of cells in the structure, and fsn and ksn are, re-
spectively, the frequency and kick factor at the synchronous point, for a
periodic structure with dimensions of cell n. Therefore, one can predict the
short time behavior of the wake without solving for the modes of the sys-
tem. (In the following we will omit the unwieldly subscript s; whether the
synchronous or mode parameters are meant will be evident from context.)

For Gaussian detuning the initial fall-oﬀ of the wake is given by

W (t)

2¯k sin(2π ¯f t) exp

2

π ¯f tσδf

2

[t small],

(10)

(cid:16)

≈

−
with ¯k the average kick factor, ¯f the average (ﬁrst band) synchronous, dipole
mode frequency, and σδf the sigma parameter in the Gaussian distribution.
Suppose we want a relative amplitude reduction to 0.05 at the position of
the second bunch. Considering the alternate (1.4 ns) bunch spacing, and
taking ¯f = 4.012 GHz (S-band), we ﬁnd that the required σδf = 6.5%.

(cid:17)

(cid:2)

(cid:3)

7

To achieve a smooth Gaussian drop–oﬀ of the wake requires that we take
at least
3σδf = 20% as the full–width of our frequency distribution, a
number which is clearly too large.

∼

If we limit the total frequency spread to an acceptable ∆δf = 10% and
keep the parameter σδf ﬁxed, our Gaussian distribution becomes similar to
a uniform distribution. For the case of a uniform distribution with full width
∆δf the wake becomes

2¯k
Nc

W

≈

sin(2π ¯f t)

sin(π ¯f t∆δf )
sin(π ¯f t∆δf /Nc)

[(π ¯f t/Q) small].

(11)

Again considering S-band with the alternate (1.4 ns) bunch spacing,
and taking ¯f = 4.012 GHz, we obtain an amplitude reduction to 0.37 at
the position of the second bunch, which is still too large.
If we want to
substantially reduce the wake further we need to shift the average dipole
frequency ¯f , so that the term sin(2π ¯f t) in Eq. 11 becomes small, and the
wake at the second bunch is near a zero crossing. That is,

¯f ∆t =

n
2

[n an integer],

(12)

−

−

with ∆t the bunch spacing. With n an even integer the bunch train will
be near the integer resonance, otherwise it will be near the half-integer res-
onance. With our parameters ¯f ∆t = 5.62, and Condition 12 is achieved
by changing ¯f by
2% (or by a much larger amount in the positive direc-
tion). However, ¯f = 4.012 GHz is the average dipole mode frequency for the
somewhat optimized structure, and a change of
2% results in a net loss of
7% in accelerating gradient, and, presumably, a 7% increase in the required
lengths of the S–band injector linacs. One ﬁnal possibility for reducing the
wake at one bunch spacing is to introduce heavy damping. But for this
case, just to reduce the wake at one bunch spacing by 1/e, a quality factor
of 16 would be needed (see Table 1), and such a quality factor is not easy
to achieve without a signiﬁcant loss in fundamental mode shunt impedance.
The wakeﬁeld for a uniform distribution, as given by Eq. 11, not only
gives the initial drop-oﬀ of the wake, but also the longer term behavior.
(However, here the mode parameters, not the synchronous parameters, are
needed. Therefore, to see whether such a mode distribution can actually be
achieved the circuit equations need to be solved.) We see that for a uniform
distribution the wakeﬁeld resurges to a maximum again, at t = Nc/( ¯f ∆δf ).
Therefore, ∆δf must be suﬃciently small to avoid this resurgence occurring
before the end of the bunch train; i.e.
it must be signiﬁcantly less than

8

Nc/(M ¯f ∆t) (which is about 10% in our case). The envelope of Eq. 11 for
∆δf = 8%, ¯f = 4.012 GHz, and Nc = 114 is shown in Fig. 1.

Another possibility for pushing the resurgence in the wake to larger t is
to use two structure types, which can eﬀectively double the number of modes
available for detuning. This idea has been studied; it has been rejected in
that it requires extremely tight alignment tolerances between pairs of such
structures.

Figure 1: The wake envelope (normalized to a maximum of 1) for a uniform
frequency distribution. Shown is Eq. 11 with all oscillations removed. The
average frequency ¯f = 4.012 GHz, the bandwidth ∆δf = 8%, and the num-
ber of modes Nc = 114. Note that in the injector linacs the bunch train
extends to ct = 80 m.

3.1

2π/3 Phase Advance Per Cell

Except for the region of the initial drop-oﬀ, we need to solve for the eigen-
modes of the system to know the behavior of the wake or the sum wake for
a detuned structure. To numerically obtain these modes we use a computer
program that solves the double-band circuit model described in Ref. [8]. We
consider structures of the disk–loaded type, with constant period and with
rounded irises of ﬁxed thickness. The iris radii and cavity radii are adjusted
to give the correct fundamental mode frequency and the desired dipole mode
spectrum. Therefore, the dimensions of a particular cell m can be speciﬁed

9

by one free parameter, which we take to be the synchronous frequency of the
ﬁrst dipole mode pass band, fsm (more precisely, the synchronous frequency
of the periodic structure with cell dimensions of cell m). The computer pro-
gram generates 2Nc coupled mode frequencies fn and kick factors kn, with
Nc the number of cells in a structure. It assumes the modes are trapped at
the ends of the structure. Only the modes of the ﬁrst band (approximately
the ﬁrst Nc modes) are found accurately by the two-band model. And since,
in addition, the strengths of the ﬁrst band modes are much larger than those
of the second band (in the S-band case the synchronous mode kick factors
are larger by a factor
35), we will use only the ﬁrst band modes to obtain
the wake, and then the sum wake.

∼

For our S-band structures, we will consider a uniform frequency distri-
bution, with a central frequency ¯f chosen so that at one bunch spacing, for
the alternate conﬁguration (∆t = 1.4 ns), the wake is very close to a zero
crossing. The strength of interaction with the modes, given by the kick fac-
tors k, will be stronger near the downstream end of the structure, where the
iris radii become smaller. To counteract this asymmetry we will allow the
top of the frequency distribution to be slanted at an angle, and therefore,
our distribution becomes trapezoidal in shape. We parameterize this slant
by

α =

λf (fhi)
λf (flo)
−
λf (fhi) + λf (flo)

,

(13)

where λf is the synchronous frequency distribution, and flo and fhi rep-
resent, respectively, the lowest and highest frequencies in the distribution.
1. With ¯f , α, and the relative width of the distribu-
Note that
tion ∆δf , we have 3 parameters that we will vary to reduce the wakeﬁeld
eﬀects—speciﬁcally by minimizing on the sum wake—for both bunch train
conﬁgurations.

≤

≤

−

α

1

∼

Each S-band structure operates at a fundamental mode frequency of
2.856 GHz, and consists of 114 cells with a cell period of 3.5 cm (where the
phase advance per cell φ = 2π/3), an iris thickness of 0.584 cm, and cavity
radius
14, 500.
4.2 cm. The Q of the modes due to wall losses (copper)
Given our implementation of the SLED-I pulse compression system[9], to
optimize the rf eﬃciency the average (synchronous) dipole mode frequency
needs to be 4.012 GHz. Fig. 2 shows the dispersion curves of the ﬁrst
two dipole bands for representative constant impedance, S-band structures,
with a varying from 1.30 cm to 2.00 cm. The results of a ﬁnite element,
Maxwell Equations solving program, OMEGA2[10], are given by the plotting
symbols. The end points of the curves are used to ﬁx the parameters in the

∼

10

circuit program. The two-band circuit results for these constant impedance
structures are indicated by the curves in the ﬁgure. We note good agreement
in the ﬁrst band results and not so good agreement in those of the second
band. For a detuned structure, to obtain the local circuit parameters, we
interpolate from these representative dispersion curves.

Figure 2: The dispersion curves of the ﬁrst two dipole bands of represen-
tative constant impedance S-band structures. The phase advance per cell is
2π/3. Results are given for iris radii of a = 1.30, 1.51, 1.63, 1.80, 1.92, and
2.00 cm. The plotting symbols give OMEGA2 results, the curves those of
the circuit model. The dashed line is the speed of light curve.

We have 3 parameters to vary in our input (uncoupled) frequency distri-
bution: the (relative) shift in average frequency from the nominal 4.012 GHz,
δ ¯f , the (relative) width of the distribution ∆δf , and the ﬂat-top tilt param-
eter α. Varying these parameters we calculate Srms0, Srms, and the peak
ˆS
value of
, for the coupled results, for both bunch train conﬁgurations.
|
|
These parameters serve as indicators, respectively, of emittance growth due
to BBU (injection jitter), emittance growth due to misalignments, and the
maximum beam excursion due to BBU. From our numerical simulations we
ﬁnd that a fairly optimized case consists of δ ¯f =
2.4%, ∆δf = 7.5%, and

S
|

,
|

−

11

α =

0.20.

|

W
|

−
In Fig. 3 we display, for the optimized case, the frequency distribu-
tion (a), the kick factors (b), and the envelope of the wake (c). The dashed
curves in (a) and (b) give the uncoupled (input) values. The plotting sym-
bols in (c) give
at the bunch positions for the alternate (1.4 ns) bunch
train conﬁguration. From (b) we note that there are a few modes, trapped
near the beginning of the structure, which have kick factors signiﬁcantly
larger than the rest. This is a consequence of the fact that, for all cells
of this structure, the dispersion curves are backward waves. From (c) we
see that, due to these few strong modes, the wake envelope does not nearly
reach the low, ﬂat bottom that it does for the idealized, uniform frequency
distribution (see Fig. 1). We note, however, that the short-range drop-oﬀ
is similar to the idealized form (see Fig. 1), for about 20 m. In addition
we note that, by setting the second bunch near the zero crossing, many
following bunches also have wakes with amplitudes signiﬁcantly below the
wake envelope. Finally, in Fig. 4 we present the sum wake for both bunch
train conﬁgurations. For this case, for both bunch train conﬁgurations,
Srms0 = Srms = .02 MV/nC/m2. Note that if we set δ ¯f back to 0, then, for
the 1.4 ns bunch spacing option, Srms0 becomes a factor of 20 larger.

3.2

3π/4 Phase Advance Per Cell

If we would like to regain some of the 7% in accelerating gradient that we
lost by shifting ¯f , we can move to a structure where the group velocity at the
synchronous point is less than for the 2π/3 structure (for the same ¯f ). One
solution is to go to a structure with a 3π/4 synchronous point. Note that in
such a structure the cell length is 3.94 cm and that there are 102 cells per
structure. Note also that for the same group velocity for the fundamental
mode a higher phase advance implies larger values of iris radius a, which will
also improve the short-range wakeﬁeld tolerances. The dispersion curves are
shown in Fig. 5. Note that, in this case, our distribution will have f0 < fπ for
the cell geometries near the beginning of the structure, f0 > fπ for the cell
geometries near the end of the structure, while the synchronous phase is near
pi phase advance. Consequently modes touching either end of the structure
will only weakly interact with the beam (see, eg Ref. [8]), allowing us to have
a smoother impedance function, and therefore a more uniformly suppressed
wakeﬁeld envelope. This was not the case for 2π/3 structure, where the
dispersion curves for all cells have a negative slope (between 0 and π phase
advance) (see Fig. 2); it is also not the case for a 5π/6 structure, where the
slopes would all be positive.

12

−

Figure 3: The optimized 2π/3 structure: δ ¯f =
2.4%, ∆δf = 7.5%, and
0.20. Given are the frequency distribution λf (a), the mode kick
α =
factors k (b), and the envelope of the wake ˆW (c). The dashes in (a) and
(b) give the uncoupled results; the plotting symbols in (c) give
at the
bunch positions for the alternate (1.4 ns) bunch train conﬁguration. Note
that we display only the modes of the ﬁrst dipole band, and the wake due
to these modes.

W
|

−

|

13

Figure 4: The sum wake for the optimized 2π/3 structure, for both the
nominal and alternate bunch train conﬁgurations. In both cases Srms0 =
Srms = .02 MV/nC/m2.

Figure 5: The dispersion curves of the ﬁrst two dipole bands of represen-
tative cells in a 3π/4 structure. Results are given for iris radii of a = 1.33,
1.48, 1.63, 1.80, and 1.98 cm. The plotting symbols give OMEGA2 results,
the curves those of the circuit model. The dashed line is the speed of light
line.

14

Figure 6: For the 3π/4 structure: dependence of 3 sum wake parameters
on δ ¯f for the nominal (left frames) and alternate (right frames) bunch train
conﬁgurations. The ordinate units are MV/nC/m2. The optimum, δ ¯f =

2.3%, ∆δf = 5.8%, and α =

0.20, is indicated by the plotting symbol.

−

−

15

Figure 7: For the 3π/4 structure: dependence of 3 sum wake parameters
on ∆δf , for the nominal (left frames) and alternate (right frames) bunch
train conﬁgurations. The ordinate units are MV/nC/m2. The optimum,
δ ¯f =
0.20, is indicated by the plotting
−
symbol.

2.3%, ∆δf = 5.8%, and α =

−

16

Figure 8: For the 3π/4 structure: dependence of 3 sum wake parameters
on α, for the nominal (left frames) and alternate (right frames) bunch train
conﬁgurations. The ordinate units are MV/nC/m2. The optimum, δ ¯f =

2.3%, ∆δf = 5.8%, and α =

0.20, is indicated by the plotting symbol.

−

−

17

−

−

2.3%, ∆δf = 5.8%, and α =

Again optimizing on the sum wake, we ﬁnd that for a fairly optimized
case δ ¯f =
0.20. The change of the indicators
ˆS
, Srms and Srms0 as we deviate from this point, for both bunch train
|
|
conﬁgurations, is shown in Figs. 6-8. In Fig. 6 we show the ¯f dependence.
We see that, for both bunch train conﬁgurations the results are very sensitive
to ¯f . In Fig. 7 we give the ∆δf dependence. We can clearly see the eﬀect of
the resurgence in the wake when ∆δf & 7%. And ﬁnally, in Fig. 10 we give
the α dependence. We note that the tilt in the distribution helps primarily
in reducing the sensitivity to BBU for the nominal (2.8 ns) bunch train
conﬁguration.

In Fig. 9 we display, for the optimized 3π/4 case, the frequency distribu-
tion (a), the kick factors (b), and the envelope of the wake (c). From (b) we
note that in this case k(f ) is a relatively smooth function, as was expected
from our earlier discussion. From (c) we see that the wake envelope reaches
a broader, ﬂatter bottom than for the 2π/3 structure, again as we expected.
Again we note that many of the earlier bunches have wakes with amplitudes
signiﬁcantly below the wake envelope. Finally, in Fig. 9 we show the sum
wake for both bunch train conﬁgurations. The rms of these sum wakes are
much smaller than for the 2π/3 structure: Srms0 = Srms = .004 MV/nC/m2.

3.3 Frequency Errors

How sensitive are our results to manufacturing errors? We will begin to
explore this question by looking at the dependence of the sum wake on
errors in the synchronous frequencies of the cells of the structure. Note that
the synchronous frequency of a cell is not equally sensitive to each of the cell
dimensions. Basically there are 4 dimensions: the iris radius a, the cavity
radius b, the iris thickness d, and the period length p. The synchronous
frequency fs is insensitive to d and p, and for the average S-band cell we
1 micron change in b
ﬁnd that δfs =
10−5.
results in δfs = 2
As for attainable accuracy, let us assume that each synchronous frequency
can be obtained to a relative accuracy of 10−4, or to about .5 MHz.

1 micron change in a results in δfs = 1

.85δb and δfs =
10−5; a

.15δa. Or, a

−
×

−

−

×

−

As for systematic frequency errors we note from Fig. 6 that we are es-
pecially sensitive to changes in average frequency. For example, to dou-
ble Srms0 from its minimum, requires a relative frequency change of only
If each cell frequency has an accuracy of 10−4, and there are
4
10−5.
about 100 cells, the accuracy in the centroid frequency should be
Therefore, the eﬀect of this type of systematic error should be negligible.

10−4.

×

∼

As for random manufacturing errors, let us distinguish two types: “sys-

18

−

Figure 9: For the optimized 3π/4 structure, δ ¯f =
2.3%, ∆δf = 5.8%,
0.20: the frequency distribution λf (a), the mode kick factors
and α =
k (b), and the envelope of the wake ˆW (c). The dashes in (a) and (b) give
the uncoupled results; the plotting symbols in (c) give
at the bunch
positions for the alternate (1.4 ns) bunch train conﬁguration. Note that we
display only the modes of the ﬁrst dipole band, and the wake due to these
modes.

W
|

−

|

19

Figure 10:
The sum wake for the optimized 3π/4 structure, given for
both the nominal and alternate bunch train conﬁgurations. For both cases
Srms0 = Srms = .004 MV/nC/m2.

8

∼

×

tematic random” and “purely random” errors. By “systematic random” we
mean errors, random in one structure, that are repeated in all structures
of the prelinac subsystem. “Purely random” errors are, in addition, ran-
dom from structure to structure. In Fig. 11 we give the resulting Srms0 and
Srms, for both bunch train conﬁgurations, when a random error component
is added to the (input) synchronous frequencies of the optimal distribution.
10−4, an rms frequency error of 10−4 is a
With a frequency spacing of
relatively small perturbation. We see that for the alternate (1.4 ns) bunch
spacing the eﬀect of such a perturbation is indeed very small, whereas for
the nominal (2.8 ns) bunch spacing the eﬀect is large. The reason is that
with the 1.4 ns bunch spacing the beam sits near a half-integer resonance,
whereas for the 2.8 ns spacing it sits near the integer resonance. (Resonant
multi-bunch wakeﬁeld eﬀects are discussed in Appendix C.) Note, however,
that if we consider the case of “purely random” machining errors, with a
relative accuracy in synchronous frequencies of 10−4, and considering we
have Nstruc = 140, 127, 41 structures in, respectively, the prelinac, the e+
drive linac, and the e− booster, then, with a 1/√Nstruc reduction in sensi-
10−5.
tivity, the appropriate abscissas in the ﬁgure become .8, .9, and 1.6
At these points, for the 2.8 ns spacing, we see that Srms0 is only a factor
2
2 times larger than the zero error result. Finally, as for
the “systematic random” errors, it is diﬃcult to judge how large they might
be in the real structure; however, they are likely an order of magnitude less
than the purely random errors, and should therefore not yield a sum wake
much larger than that due to the purely random manufacturing errors.

1, 2

1, 3

±

±

×

±

20

If we make a weak damping, approximate calculation, by redoing the
calculation but now with Q = 1000, we ﬁnd no appreciable eﬀect on the
resonance behavior for the ∆t = 2.8 ns case with frequency errors. For
strong damping, taking Q = 100, however, we do ﬁnd a suppression of the
resonance eﬀect.

Figure 11: The optimal 3π/4 structure: the eﬀect of random frequency
errors. Shown are the relative (synchronous) frequency error, σf,err vs Srms0.
The dashed curves give Srms. Each plotting symbol, with its error bars,
represents 400 diﬀerent seeds.

3.4

e+ Booster

For the e+ booster (the L–band machine) each accelerator structure consists
of 72 cells and the synchronous phase advance is taken to be 2π/3. The
synchronous dipole mode distribution is taken to be uniform, with ¯f =
2.05 GHz and ∆δf = 3%. We take Q = 20, 000. Note that in this case
¯f ∆t = 2.87; for the second bunch to sit on the zero crossing of the wakeﬁeld
would require a shift in frequency of +4.5% or
13%. For the L-band
structure not much can be gained by changing the frequency spectrum. We
do gain, however, a factor of 8 reduction in wake in going from S- to L-band,
which, as we shall see, suﬃces.

−

21

4 Tolerances

For our designed structures we perform the tolerance calculations presented
in Section 2. To check the analytical estimates, tracking, using the computer
program LIAR[11], was also performed. The numerical simulations were
simpliﬁed in that one macro-particle was used to represent each bunch, and
the bunch train was taken to be mono–energetic. The analytical BBU results
and those of LIAR, at the end of the four injector linacs, are compared in
Table 4. Results are given for bunch spacings of 1.4 and 2.8 ns. Under
the heading “Analytical” are given the rms of the sum wake Srms, the rms
of the growth factor Υrms, the maximum (within the bunch train) of the
growth factor ˆΥ, and the tolerance rt for δǫt = 10%, i.e. that ratio y0/σy0
that results in 10% emittance growth. Under the heading “Numerical” we
give the LIAR results: the maximum (within the bunch train) growth in
normalized phase space ˆξ and the tolerance rt for 10% emittance growth,
both referenced to the centroid of the ﬁrst bunch in the train.

Table 4: Beam break-up calculations for the two bunch spacings. Given
are the rms of the sum wake Srms0 (in units of MV/nC/m2), the rms and
the peak of the strength parameter, Υrms0 and ˆΥ, respectively, and the
analytically obtained tolerance rt for δǫt = 10%, i.e. that ratio y0/σy0 that
results in 10% emittance growth. Also shown are LIAR results: the peak
blow-up in normalized phase space, ˆξ, and the tolerance rt.

∆t

Name

2.8ns

1.4ns

Prelinac
e+ Drive
e− Booster
e+ Booster
Prelinac
e+ Drive
e− Booster
e+ Booster

Analytical
ˆΥ
.025
.066
.036
.227
.019
.049
.027
.379

Srms0 Υrms0
.007
.004
.017
.004
.009
.004
.119
.12
.004
.004
.011
.004
.006
.004
.205
.30

rt
70
25
50
3.8
115
45
80
2.2

Numerical
ˆξ
rt
85
.020
35
.047
65
.026
5.5
.153
140
.015
60
.035
105
.019
3.0
.257

We note from Table 4 that for the S-band machines, Υrms0 and ˆΥ are
both small compared to 1, and that the injection jitter tolerance for 10%
emittance growth is very large. For the L-band machine, the e+ booster, the
tolerances are tighter but still acceptable. We note also that the analytical

22

Table 5: Eﬀect of structure misalignments for the two bunch spacings. Given
are the rms of the sum wake Srms (in units of MV/nC/m2) and the tolerance
for structure misalignments for a 10% emittance growth, xat, both obtained
analytically (Eqs. 6,8) and by LIAR.

∆t

Name

2.8ns

1.4ns

Prelinac
e+ Drive
e− Booster
e+ Booster
Prelinac
e+ Drive
e− Booster
e+ Booster

Analytical
Srms xat[mm]
.004
.004
.004
.022
.004
.004
.004
.040

2.9
100.
140.
590.
4.6
150.
210.
450.

Numerical
xat[mm]
3.2
120.
170.

4.8
180.
260.

ˆΥ agrees well with the numerical ˆξ, as do the two versions of rt.

In Table 5 we present misalignment results. Given are Srms and the
tolerance for structure misalignments, xat, both as given analytically and
by LIAR. As discussed before, the meaning of xat is the rms misalignment
that (for an ensemble of machines) results, on average, in a ﬁnal emittance
growth equal to a tolerance δǫt, which in this case we set to 10%. From
Table 5 we see that the analytical and numerical results agree well, and that
the misalignment tolerances are all very loose. The tightest tolerance is for
the prelinac with nominal (2.8 ns) bunch spacing, where the tolerance is still
an acceptable 3 mm.

The eﬀect of machining errors will tighten these tolerances for the S-
band machines with the nominal (2.8 ns) bunch spacing, due to the beam
being near the integer resonance. If machining adds a purely random error
component that is equivalent to 10−4 frequency error, we saw earlier that
(for the 2.8 ns bunch spacing case only) this will tighten the injection jitter
1 for the prelinac and e+ drive linac, and
tolerances by about a factor 2
2 for the e− booster. But even with this, the toler-
about a factor of 3
ances are still very loose. The misalignment tolerances are aﬀected less by
machining errors. The prelinac tolerance, with 2.8 ns bunch spacing, will
become
1 mm; for 95% conﬁdence in achieving δǫ = 10%, the tolerance
becomes

.5 mm.

2
±
1

±

±

∼
∼

±

23

Finally, what is the random, cell-to-cell misalignment tolerance? Per-
forming the perturbation calculation described in Appendix B, and cal-
culating for 1000 diﬀerent random structures, we ﬁnd that Srms = .27
±
.003 MV/nC/m2 for
.12 MV/nC/m2 for ∆t = 2.8 ns, and Srms = .032
∆t = 1.4 ns. We again see the eﬀect of the integer resonance on the 2.8 ns
option result. (To verify that this is the case, we performed one run but with
the bunch spacing changed so that the beam sits near the next half-integer
resonance (11.5); the result was that Srms dropped by a factor of 6.) For
the prelinac the cell-to-cell misalignment tolerance becomes 40 µm for the
nominal (2.8 ns) bunch conﬁguration and 600 µm for the alternate (1.4 ns)
conﬁguration.

±

5 Conclusion

We have demonstrated that by using detuning alone, the four injector linacs
can be built to suﬃciently suppress the multi-bunch wakeﬁeld eﬀects, for
both the nominal (2.8 ns) and alternate (1.4 ns) bunch spacings. We have
studied the sensitivity to multi-bunch beam break-up (BBU) and to struc-
ture misalignments through analytical estimates and numerical tracking,
and shown that the tolerances to injection jitter, in the former case, and to
structure misalignments, in the latter case, are not diﬃcult to achieve. We
have also studied the eﬀect of manufacturing errors on these tolerances, and
have shown that if the errors are purely random, with an equivalent rms fre-
quency error of 10−4, then the other tolerances are still acceptable. Finally,
we have shown that the cell-to-cell misalignment tolerance is & 40 µm.

For the L–band machine—the e+ Booster—we have shown that a uni-
form detuning of the dipole modes, with central frequency ¯f = 2.05 GHz
and a total frequency spread ∆δf = 3%, suﬃces. For the S–band linacs—
the Prelinac, the e+ Drive Linac, and the e− Booster—we have shown that
the 1.4 ns bunch spacing option forces us to reduce the central frequency
by 2.3% from the nominal 4.012 GHz. Doing this we lose 7% in eﬀective
gradient, which, however, can be regained by increasing the phase advance
per cell from 2π/3 to 3π/4. Our ﬁnal, optimized distribution is trapezoidal
in shape with ¯f = 3.920 GHz, ∆δf = 5.8%, and tilt parameter α =

0.2.

We have demonstrated in this report that the integer resonance, which
we cannot avoid given the two bunch train alternatives, can make us more
sensitive to manufacturing errors. Also, we have shown that the analytical,
single-bunch beam break-up theory, when slightly modiﬁed, can be useful in
predicting the behavior of multi-bunch beam break-up also. Given the rather

−

24

loose tolerances demonstrated here makes us think that the S-band machines
can be replaced with C-band ones that still have reasonable tolerances, an
option which may result in savings in cost, though this needs further study.
Finally, we should reiterate that in this report we were concerned with the
eﬀects of the modes in the ﬁrst dipole passband only. With the wakeﬁeld
of the ﬁrst band modes greatly suppressed by detuning, the eﬀects of the
higher bands may no longer be insigniﬁcant. This problem will need to be
addressed in the future.

Acknowledgments

The author thanks the regular attendees of the Tuesday JLC/NLC linac
meetings at SLAC for helpful comments and discussions on this topic, and
in particular T. Raubenheimer, our leader, and V. Dolgashev for carefully
reading parts of this manuscript.

References

[1] NLC ZDR Design Report, SLAC Report 474, 589 (1996).

[2] See the JLC/NLC Accelerator Physics at SLAC web site at: www-

project.slac.stanford.edu/lc/local/AccelPhysics/Accel Physics index.htm.

[3] R. M. Jones, et al, “Equivalent Circuit Analysis of the SLAC Damped
Detuned Structures,” Proc. of EPAC96, Sitges, Spain, 1996, p. 1292.

[4] A. Chao, “Physics of Collective Instabilities in High-Energy Accelera-

tors”, John Wiley & Sons, New York (1993).

[5] K. Bane, et al, “Issues in Multi-Bunch Emittance Preservation in the

NLC,” Proc. of EPAC94, London, England, 1994, p. 1114.

[6] R. M. Jones, et al, “Emittance Dilution and Beam Breakup in the

JLC/NLC,” Proc. of PAC99, New York, NY, 1999, p. 3474.

[7] V. Dolgashev, et al, “Scattering Analysis of the NLC Accelerating Struc-

ture,” Proc. of PAC99, New York, NY., 1999, p. 2822.

[8] K. Bane and R. Gluckstern, Part. Accel., 42, 123 (1994).

[9] Z. Li, et al, “Parameter Optimization for the Low Frequency Linacs in

the NLC,” Proc. of PAC99, New York, NY, 1999, p. 3486.

25

[10] X. Zhan, “Parallel Electromagnetic Field Solvers . . .,” PhD Thesis,

Stanford University, 1997.

[11] R. Assmann, et al, LIAR Reference Manual, SLAC/AP-103, April 1997.

[12] R. Helm and G. Loew, Linear Accelerators, North Holland, Amsterdam,

1970, Chapter B.1.4.

[13] E. U. Condon, J. Appl. Phys. 12, 129 (1941).

[14] P. Morton and K. Neil, UCRL-18103, LBL, 1968, p. 365.

[15] K.L.F. Bane, et al, in “Physics of High Energy Accelerators,” AIP Conf.

Proc. 127, 876 (1985).

[16] K. Bane and B. Zotter, Proc. of the 11th Int. Conf. on High Energy

Acellerators, CERN (Birkh¨auser Verlag, Basel, 1980), p. 581.

[17] D. Schulte, presentation given in an NLC Linac meeting, summer 1999.

Appendix A:
Analytical Formula for Weak Multi-Bunch BBU

In Ref. [4] an analytical formula for single-bunch beam break-up in a smooth
focusing linac, for the case without energy spread in the beam, is derived,
the so-called Chao-Richter-Yao (CRY) model for beam break-up. Suppose
the beam is initially oﬀset from the accelerator axis. The beam break-
up downstream is characterized by a strength parameter Υ(t, s), where t
represents position within the bunch, and s position along the linac. When
Υ(t, s) is small compared to 1, the growth in betatron amplitude in the linac
is proportional to this parameter. When applied to the special case of a
uniform longitudinal charge distribution, and a linearly growing wakeﬁeld,
the result of the calculation becomes especially simple.
In this case the
growth in orbit amplitude is given as an asymptotic power series in Υ(t, s),
and the series can be summed to give a closed form, asymptotic solution for
single-bunch BBU. The derivation of an analytic formula for multi-bunch
BBU is almost a trivial modiﬁcation of the CRY formalism. We will here
reproduce the important features of the single-bunch derivation of Ref. [4]
(with slightly modiﬁed notation), and then show how it can be modiﬁed to
obtain a result applicable to multi-bunch BBU. Note that we are interested
in estimating the eﬀect of relatively weak multi-bunch BBU, caused by the
somewhat complicated wakeﬁelds of detuned structures. The more studied

26

multi-bunch BBU problem, i.e.
the eﬀect on a bunch train of a single
strong mode, the so-called “cumulative beam break-up instability” (see, e.g.
Ref. [12]), is a somewhat diﬀerent problem to which our results are not
meant to apply.

Let us consider the case of single-bunch beam break-up, where a beam
is initially oﬀset by distance y0 in a linac with acceleration and smooth
focusing. We assume that there is no energy spread within the beam. The
equation of motion is

1
E(s)

d
ds

E(s)

(cid:20)

dy(t, s)
ds

+

y(t, s)
β2(s)

=

e2Nt
E(s)

(cid:21)

t

−∞

Z

dt′ y(t′, s)λt(t′)W (t

t′) ,

−

(A1)
with y(t, s) the bunch oﬀset, a function of position within the bunch t, and
position along the linac s; with E the beam energy, [1/β(s)] the betatron
wave number, eNt the total bunch charge, λt(t) the longitudinal charge
distribution, and W (t) the short-range dipole wakeﬁeld. Our convention is
that negative values of t are toward the front of the bunch. Let us, for the
moment, limit ourselves to the problem of no acceleration and β a constant.
A. Chao in Ref. [4] expands the solution to the equation of motion for this
problem in a perturbation series

y(t, s) =

y(n)(t, s)

,

(A2)

with the ﬁrst term given by free betatron oscillation [y(0) = y0 cos(s/β)]. He
then shows that the solution for the higher terms at position s = L, after
many betatron oscillations, is given by

y(n)(t, L)

y0
n!

≈

ie2NtLβ
2E

(cid:18)

n

(cid:19)

Rn(t)eiL/β

,

(A3)

with

Rn(t) =

dt1 λ(t1)W (t

t1)

t1

−∞

Z

−

dt2 λ(t2)W (t1 −

t2)

dtn λ(tn)W (tn−1 −

tn) ,

(A4)

t

−∞

Z

tn−1

· · ·

−∞

Z

and R0(z) = 1. An observable y is meant to be the real part of Eq. A2.
The eﬀects of adiabatic acceleration, i.e. suﬃciently slow acceleration so
that the energy doubling distance is large compared to the betatron wave

∞

Xn=0

27

β/E
h

length, and β not constant, can be added by simply replacing (β/E) in
, where angle brackets indicate averaging along the linac
Eq. A3 by
i
from s = 0 to s = L.2 For example, if the lattice is such that β
Eζ
= (β0/E0)g(Ef /E0, ζ), where subscripts “0” and “f ” signify,
then
respectively, initial and ﬁnal parameters, and

β/E
h

∼

i

g(x, ζ) =

1
ζ

xζ
x

1
1

−
−

Eζ].

[β

∼

(A5)

(cid:18)

(cid:19)
Chao then shows that for certain simple combinations of bunch shape
and wake function shape the integrals in Eq. A4 can be performed analyt-
ically, and the result becomes an asymptotic series in powers of a strength
parameter. For example, for the case of a uniform charge distribution of
length ℓ (with the front of the bunch at t = 0), and a wake that varies as
W = W ′t, the strength parameter is

Υ(t, L) =

g(Ef /E0, ζ)

.

(A6)

e2NtLW ′t2β0
2E0ℓ

If Υ is small compared to 1, the growth is well approximated by Υ. If Υ
is large, the sum over all terms can be performed to give a closed form,
asymptotic expression.

For multi-bunch BBU we are mainly concerned with the interaction of
the diﬀerent bunches in the train, and will ignore wakeﬁeld forces within
bunches. The derivation is nearly identical to that for the single-bunch
BBU. However, in the equation of motion, Eq. A1, the independent variable
t is no longer a continuous variable, but rather t takes on discrete values
tm = m∆t, where m is a bunch index and ∆t is the bunch spacing. Also, W
now represents the long-range wakeﬁeld. Let us assume that there are M ,
equally populated bunches in a train; i.e. Nt = M N , with N the particles
per bunch. The solution is again expanded in a perturbation series. In the
solution, Eq. A3, the Rn(t), which are smooth functions of t, are replaced
by

(n)
m =

R

1
M

W [(m

j)∆t]

−

(n−1)
j
R

,

(A7)

m−1

Xj=1

(with

0
j = 1), which is a function of a discrete parameter, the bunch index
R
m. Note that

(1)
m = Sm/M , with Sm the sum wake.

2Note that the terms y0eiL/β in Eq. A3, related to free betatron oscillation, also need
to be modiﬁed in well-known ways to reﬂect the dependence of β on E. It is the other
terms, however, which characterize BBU, in which we are interested.

R

28

Generally the sums in Eq. A7 cannot be given in closed form, and there-
fore a closed, asymptotic expression for multi-bunch BBU cannot be given.
We can still, however, numerically compute the individual terms equivalent
to Eq. A3 for the single bunch case. For example, the ﬁrst order term in
amplitude growth is given by

Υm =

e2N LSmβ0
2E0

g(Ef /E0, ζ)

[m = 1, . . . , M ] .

(A8)

If this term is small compared to 1 for all m, then BBU is well characterized
by Υ. If it is not small, though not extremely large, the next higher terms can
be computed and their contribution added. For Υ very large, this approach
may not be very useful.

From our derivation we see that there is nothing that fundamentally
distinguishes our BBU solution from a single-bunch BBU solution.
If we
consider again the single-bunch calculation, for the case of a uniform charge
distribution of length ℓ, we see that we need to perform the integrations
If we do the integrations numerically, by dividing the
for Rn in Eq. A4.
1)∆t and then performing quadrature
integrals into discrete steps tn = (n
by rectangular rule, we end up with Eq. A7 with M = ℓ/∆t. The solution is
the same as our multi-bunch solution. What distinguishes the multi-bunch
from the single-bunch problem is that the wakeﬁeld for the multi-bunch case
is not normally monotonic and does not vary smoothly with longitudinal
position. For such a case it may be more diﬃcult to decide how many terms
are needed for the sum to converge.

−

In Fig. 12 we give a numerical example: the NLC prelinac with the op-
timized 3π/4 S-band structure, but with 10−5 systematic frequency errors,
with the nominal (2.8 ns) bunch spacing (see the main text). The diamonds
give the ﬁrst order (a) and the second order (b) perturbation terms. The
crosses in (a) give the results of a smooth focusing simulation program (tak-
E1/2), where the free betatron term has been removed. We see that
ing β
the agreement is very good; i.e. the ﬁrst order term is a good approximation
to the simulation results. In (b) we note that the next order term is much
smaller. For this example we ﬁnd that even if we increase the current by an
order of magnitude the 1st order term alone remains a good approximation.

∼

29

Figure 12: A numerical example: the NLC prelinac with the optimized 3π/4
S-band structure, but with 10−5 systematic frequency errors, with the nom-
inal (2.8 ns) bunch spacing (see the main text). Srms = .005 MV/nC/m2.
The diamonds give the ﬁrst order (a) and the second order (b) perturbation
terms. The crosses in (a) give smooth focusing simulation results with the
free betatron term removed.

Appendix B:
The Wakeﬁeld Due to Cell-to-Cell Misalignments

We assume a structure is composed of many cells that are misaligned trans-
versely by amounts that are very small compared to the cell dimensions.
For such a case we assume that the mode frequencies are the same as in the
ideal structure, and only the mode kick factors are aﬀected. To ﬁrst order
we assume that for each mode, the kick factor for the beam on-axis in the
imperfect structure is the same as for the case with the beam following the
negative of the misalignment path in the error-free structure. In Fig. 13 we
sketch a portion of such a misaligned structure (top) and the model used
for the kick factor calculation (bottom). The sketch is meant to represent a

30

disk-loaded structure that has been built up from a collection of cups. Note
that the relative size of the misalignements is exaggerated from what is ex-
pected, in order to more clearly show the principle. Given this model, the
method of calculation of the kick factors can be derived using the so-called
“Condon Method”[13],[14] (see also [15]). Note that this application to cell-
to-cell misalignments in an accelerator structure is presented in Ref. [6].
The results of this perturbation method have been shown to be consistent
with those using a 3-dimensional scattering matrix analysis[7]. We will only
sketch the derivation below.

bunch

bunch

Figure 13: Sketches of part of a misaligned structure (top) and the model
used for the kick factor calculation (bottom). Note that the relative size of
the misalignments here is much exaggerated.

Consider a closed cavity with perfectly conducting walls. For such a
cavity the Condon method expands the vector and scalar potentials, in the

31

Coulomb gauge, as a sum over the empty cavity modes. As function of
position x (x, y, z) and time t the vector potential in the cavity is given as

where

where

(B1)

(B2)

(B3)

(B4)

(B5)

(B6)

(B7)

ˆn = 0 on the metallic surface (ˆn
with ωλ the frequency of mode λ, and aλ ×
is a unit vector normal to the surface). Using the Coulomb gauge implies
aλ = 0. The qλ are given by
that

∇ ·

with the normalization

with j the current density. Note that the integrations are performed over
the volume of the cavity

.

The scalar potential is given as

A(x, t) =

qλ(t)aλ(x)

,

Xλ

2aλ +

∇

ω2
λ
c2

aλ = 0 ,

¨qλ + ω2

λqλ =

1
2Uλ Z

j

d

V

·

V

aλ

,

d

V

aλ′

aλ =

·

Uλδλλ′

,

ǫ0
2

V
Z

V

Φ(x, t) =

rλ(t)φλ(x)

,

Xλ

2φλ +

∇

Ω2
λ
c2 φλ = 0 ,

rλ =

1
2Tλ Z

d

V

V

ρφλ

,

with Ωλ the frequencies associated with φλ, and with φλ = 0 on the metallic
surface. The rλ are given by

with ρ the charge distribution in the cavity. Note that one fundamental
diﬀerence between the behavior of A(x, t) and Φ(x, t) is that when there are
no charges in the cavity the vector potential can still oscillate whereas the
scalar potential must be identically equal to 0.

Let us consider an ultra-relativistic driving charge Q that passes through
the cavity parallel to the z axis, and (for simplicity) a test charge following
at a distance s behind on the same path. Both enter the cavity at position

32

z = 0 and leave at position z = L. The transverse wakeﬁeld at the test
charge is then

W(s) =

L

1
QLx0 Z
1
QLx0

0

0
Xλ Z

=

dz [c

⊥Az − ∇

∇

⊥Φ]t=(z+s)/c

L

dz

cqλ

(cid:20)

(cid:18)

z + s
c

⊥aλz(z)

∇

(cid:19)
z + s
c

rλ

−

(cid:18)

∇

⊥φλ(z)
(cid:21)

,

(cid:19)

(B8)

where the integrals are along the path of the particle trajectory. The param-
eter x0 is a parameter for transverse oﬀset (the transverse wake is usually
given in units of V/C per longitudinal meter per transverse meter); for a
cylindrically-symmetric structure it is usually taken to be the oﬀset, from
the axis, of the driving bunch trajectory. For s > L we can drop the scalar
potential term (it must be zero when there is no charge in the cavity), and
the result can be written in the form[15]

W(s) =

Xλ

c
2UλωλLx0 ℑ

m

V ∗
λ ∇

⊥Vλ eiωλs/c

i

with

[s > L] ,

(B9)

Vλ =

dz aλz(z)eiωλz/c

.

(B10)

h

L

0
Z

Note that the arbitrary constants associated with the parameter aλ in the
numerator and the denominator of Eq. B9 cancel. Note also that—to the
2 is the square of the voltage lost by the driving
same arbitrary constant—
Vλ|
|
particle to mode λ and Uλ is the energy stored in mode λ.

−

Consider now the case of a cylindrically-symmetric, multi-cell acceler-
ating cavity, and let us limit our concern to the eﬀect of the dipole modes
of such a structure. We will allow the charges to move on an arbitrary,
z plane that is close to the axis, and for which the
zig-zag path in the x
slope is everywhere small (so that
∂/∂x). For dipole modes in a
∇
cylindrically-symmetric, multi-cell accelerator structure, it can shown that
the synchronous component of aλz (the only component that, on average,
is important) can be written in the form aλz = xfλ(z) (see e.g. Ref. [16]).
Then Eq. B9 becomes
c
2UλωλLx0 ×

Wx(s) =

(B11)

∼

⊥

Xλ
eiωλs/c
(cid:20)

L

0

Z

m

×ℑ

dz′ x(z′)fλ(z′)e−iωλz′/c

dz fλ(z)eiωλz/c

[s > L] .

L

0
Z

(cid:21)

33

Note that this equation can be written in the form:

Wx(s) =

2k′

λ sin

+ θλ

[s > L] ,

(B12)

ωλs
c

(cid:16)

(cid:17)

Xλ

Vλ|
λ = kλ = c
|

with k′
λ a kind of kick factor and θλ the phase of excitation of mode λ.
Note that in the special case where the particles move parallel to the axis,
at oﬀset a, k′
2/(4Uλωλa2L), the normal kick factors for the
structure, and θλ = 0. For this case it can be shown that Eq. B12 is valid for
all s > 0[15]. Finally, note that, for the general case, Eq. B12 can obviously
not be extrapolated down to s = 0, since it implies that Wx(0)
= 0, which we
believe is nonphysical, implying that a particle can kick itself transversely.
To obtain the proper equation valid down to s = 0 we would need to include
the scalar potential term that was dropped in going from Eq. B8 to Eq. B9.
Our derivation, presented here, is technically applicable only to struc-
tures for which all modes are trapped. The modes will be trapped at least
at the ends of the structure, if the connecting beam tubes have suﬃciently
small radii and the dipole modes do not couple to the fundamental mode
couplers in the end cells. For detuned structures, like those in the injector
linacs discussed in this report, most modes are trapped internally within a
structure, and those that do extend to the ends couple only weakly to the
beam; for such structures the results here can also be applied, even if the
conditions on the beam tube radii and the fundamental mode coupler do not
hold. We believe that even for the damped, detuned structures of the main
linac of the JLC/NLC, which are similar, though they have manifolds to
add weak damping to the wakeﬁeld, a result very similar to that presented
here applies.

To estimate the wakeﬁeld associated with very small, random cell-to-
cell misalignments in accelerator structures we assume that we can use the
mode eigenfrequencies and eigenvectors of the error-free structure. We ob-
tain these from the circuit program. Then to ﬁnd the kick factors we replace
x(z) in the ﬁrst integral in Eq. B11 by the zig-zag path representing the neg-
ative of the cell misalignments, a path we generate using a random number
generator. The normalization factor x0 is set to the rms of the misalign-
ments. How can we justify using this method for ﬁnding the wake at the
spacing of the bunch positions? For example, for the 3π/4 S-band struc-
ture, the alternate bunch spacing is only 42 cm whereas the whole structure
length L = 4.46 m. Therefore, in principle, Eq. B11 is not valid until the
11th bunch spacing. We believe, however, that the scalar potential ﬁelds
will not extend more than one or two cells behind the driving charge (the

34

6
cell length is 4.375 cm), and therefore this method will be a good approxi-
mation at all bunch positions behind the driving charge. This belief should
be tested in the future by repeating the calculation, but now also including
the contribution from scalar potential terms.

In Fig. 14 we give a numerical example. Shown, for the optimized 3π/4
S-band structure (see the main text), are the kick factors and the phases of
the modes as calculated by the method described in this section. Note that
θλ is not necessarily small.

Figure 14:
The kick factors and phases of the modes for a cell-to-cell
misalignment example. The structure is the optimized 3π/4 S-band struc-
ture (see the main text). For this example, for the nominal (2.8 ns) bunch
spacing, Srms = .32 MV/nC/m2.

Appendix C:
Resonant Multi-Bunch Wakeﬁeld Eﬀects

It is easy to understand how resonances can arise in a linac with bunch
trains. Consider the case of the interaction of the beam with one single
structure mode. The leading bunch enters the structure oﬀset from the axis
and excites the mode. If the bunch train is sitting on an integer resonance,
i.e. if f ∆t = n, with f the mode frequency, ∆t the bunch spacing, and n an
integer, then when the 2nd bunch arrives it will excite the mode at the same
phase and also obtain a kick due to the wakeﬁeld of the ﬁrst bunch. The
mth bunch will also excite the mode in the same phase and obtain (m
1)
times the kick from the wakeﬁeld that the second bunch experienced (for

−

35

simplicity we assume the mode Q is inﬁnity). On the half-integer resonance,
i.e. when f ∆t = n + .5, the mth bunch will also receive kicks from the
wakeﬁeld left by the earlier bunches, but in this case the kicks will alternate
in direction, and no resonance builds up. For a transverse wakeﬁeld eﬀect,
such as we are interested in, however, this simple description of the resonant
interaction needs to be modiﬁed slightly. For this case the wake varies as
sin(2πf t), and neither the integer nor the half-integer resonance condition
In this case resonant
will excite any wakeﬁeld for the following bunches.
growth is achieved at a slight deviation from the condition f ∆t = n, as is
shown below.

In the following, for simplicity, we will use the “uncoupled” model (which
is described in Chapter 3 of the main text) to investigate resonant eﬀects in
the sum wake for a structure with modes with a uniform frequency distribu-
tion. The point of using the uncoupled model is that it allows us to study
the eﬀect of an idealized, uniform frequency distribution. As we have seen in
the main text, an ideal (input) frequency distribution becomes distorted by
the cell-to-cell coupling of an accelerator structure. As example we will use
the parameters of a simpliﬁed version (all kick factors are equal) of the opti-
mized 3π/4 S-band structure described in the main text; for bunch structure
we consider the nominal bunch spacing (∆t = 2.4 ns). The results for the
real structure, with coupled modes, will be slightly diﬀerent yet qualitatively
the same. Note that we are also aware of a diﬀerent analysis of resonant
multi-bunch wakeﬁeld eﬀect[17].

Consider ﬁrst the case of a structure with only one dipole mode, with
frequency f , and a kick factor that we will normalize (for simplicity) to 1/2.
Suppose there are M bunches in the bunch train. The sum wake at the mth
bunch is given by

S(1)

m (f ∆t) =

m

sin (2π[i

1]f ∆t)

−

Xi=1
sin (π[m

=

−

1]f ∆t) sin (πmf ∆t)
sin (πf ∆t)

.

(C1)

As with the nominal (2.8 ns) bunch spacing in the S-band prelinacs, let us,
for an example, consider M = 95 bunches and the region near the 11th
harmonic. In Fig. 15 we plot f ∆t vs the sum wake for the M th (the last)
bunch, S(1)
M , near the 11th integer resonance. It can be shown that, if M is
not small, the largest resonance peaks (the extrema of the curve) are at

f ∆t

n

≈

±

3
8M

36

[M not small]

,

(C2)

with values
spacings the sum wake is zero.

±

.72M . Note that at the exact integer and half-integer resonant

Figure 15: The sum wake at the last bunch in a train vs bunch spacing,
due to a single mode (Eq. C1); M = 95 bunches.

Now let us consider a uniform distribution of mode frequencies. For
simplicity we will let all the kick factors be equal, and be normalized to 1/2.
The sum wake, according to the uncoupled model, becomes

Sm( ¯f ∆t) =

1
Nc

Nc

n=1
X

S(1)
m

¯f ∆t

1 +

(cid:20)

(cid:18)

(n

−

Nc/2)
Nc

∆δf

(cid:19)(cid:21)

,

(C3)

with Nc the number of cells (also the number of modes), ¯f the central fre-
quency, and ∆δf the total (relative) width of the frequency distribution.
As an example, let us consider the optimized 3π/4 S-band structure, with
Nc = 102 and ∆δf = 5.8%. The sum wake at the last (the M th) bunch
position, SM , is plotted as function of ¯f ∆t in Fig. 16. Note that the uni-
form frequency distribution appears to suppress the integer resonance. The
extrema of the curve (the “horns”) that are seen at ¯f ∆t = 11
.32 are res-
onances due to the edges of the frequency distribution, with the condition
¯f ∆t
∆δf /2). Note, however, that the sizes of even these spikes
are small compared to those of the single mode case.

11/(1

±

±

≈

37

Figure 16: The sum wake at the last bunch in a train vs bunch spacing, due
to a uniform distribution of mode frequencies (Eq. C3). The total frequency
spread ∆δf = 5.8%, and Nc = 102.

Suppose we add frequency errors to our model. We can do this by, in
each term in the sum of Eq. C3, multiplying the frequency by the factor
(1 + δferrrn), with δferr the rms (relative) frequency error and rn a random
number with rms 1. Doing this, considering a uniform distribution in fre-
quency errors with rms δferr = 10−4, Fig. 16 becomes Fig. 17. Note that
10−4,
this perturbation is small compared to the frequency spacing 5.7
so it does not really change the frequency distribution signiﬁcantly. Never-
theless, because of resonance-like behavior we can see a large eﬀect on SM
11.32).
throughout the range between the horns of Fig. 16 (10.68
To model cell-to-cell misalignments, we multiply each term in the sum of
Eq. C3 by the random factor rn. The results, for a uniform distribution of
errors with rms 1, are shown in Fig. 18. Again resonance-like behavior is
seen throughout the range between the horns of Fig. 16.

¯f ∆t

≤

≤

×

We can understand these results in the following manner: Only when
there are no errors does using a uniform frequency distribution suppress the
resonance in the region near the integer resonance. But otherwise, using a
uniform frequency distribution basically only reduces the size of the reso-
nances, at the expense of extending the range in bunch spacings where they
Instead of being localized in the region near the integer
can be excited.

38

Figure 17: The sum wake at the last bunch in a train vs bunch spacing,
due to a uniform distribution of frequencies, including frequency errors. The
total frequency spread ∆δf = 5.8%, the number of modes Nc = 102, and
rms relative frequency error is 10−4.

resonance ( ¯f ∆t
≈
between the limits

n), resonance-like behavior can now be excited anywhere

( ¯f ∆t)± =

n
∆δf /2

.

1
∓
Note that this implies that if ∆δf > 1/( ¯f ∆t), then the resonance-like be-
havior cannot be avoided no matter what bunch spacing (fractional part) is
chosen. For example, for the X-band linac in the NLC, where the total width
of the dipole frequency distribution (of the dominant ﬁrst band modes) is
10%, even for the alternate (1.4 ns) bunch spacing, where the integer part
of ¯f ∆t is 21, the resonance region cannot be avoided.

(C4)

39

Figure 18: The sum wake at the last bunch in a train vs bunch spacing,
due to a uniform distribution of frequencies, including random misalignment
errors with rms 1. The total frequency spread ∆δf = 5.8% and then number
of modes Nc = 102.

40

