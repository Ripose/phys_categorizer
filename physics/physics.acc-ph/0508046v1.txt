5
0
0
2
 
g
u
A
 
8
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
6
4
0
8
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

DEUTSCHES ELEKTRONEN-SYNCHROTRON

in der HELMHOLTZ-GEMEINSCHAFT

DESY 05-137

August 2005

Exact Solution for the Second Harmonic
Generation in XFELs

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and
Mikhail Yurkov
Deutsches Elektronen-Synchrotron DESY, Hamburg

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

Exact Solution for the Second Harmonic
Generation in XFELs

Gianluca Geloni a Evgeni Saldin a Evgeni Schneidmiller a
Mikhail Yurkov a

aDeutsches Elektronen-Synchrotron (DESY), Hamburg, Germany

Abstract

The generation of harmonic radiation through a non-linear mechanism driven by
bunching at fundamental frequency is an important option in the operation of high
gain Free-Electron Lasers (FELs). The use of harmonic generation at a large scale
facility may result in achieving shorter radiation wavelengths for the same electron
beam energy. This paper describes a theory of second harmonic generation in planar
undulators with particular attention to X-Ray FELs (XFELs). Our study is based
on an exact analytical solution of Maxwell equations, derived with the help of the
Green’s function method. On the contrary, up-to-date theoretical understanding
of the second harmonic generation is only limited to some estimation of the total
radiation power based on the source part of the wave equation. Moreover, we ﬁnd
that such part of the wave equation is presented with several incorrect manipulations
among which is the omission of an important contribution. Our work yields correct
parametric dependencies and speciﬁc predictions of additional properties such as
polarization, angular distribution of the radiation intensity and total power. The
most surprising prediction is the presence of a vertically polarized part of the second
harmonic radiation, whereas up-to-date understanding assumes that the ﬁeld is
horizontally polarized. Altogether, this paper presents the ﬁrst correct theory of
second harmonic generation for high gain FELs.

Key words: Free-electron Laser (FEL), X-rays, even harmonic generation
PACS: 52.35.-g, 41.75.-i

Preprint submitted to Elsevier Science

2 January 2014

1

Introduction

In a Free-Electron Laser the electromagnetic ﬁeld at the fundamental har-
monic interacts with the electron beam. As a result, the beam is bunched in
non-linear (sinusoidal) ponderomotive potential. When the bunching is strong
enough, the beam current exhibits non-negligible Fourier components at har-
monics of the fundamental as well. In the SASE case only the transverse
ground mode of the fundamental harmonic survives, due to the transverse
mode selection mechanism [1] in the high gain regime, and is responsible for
the bunching mechanism. As a result, the nonlinear Fourier components ra-
diate coherently and the phenomenon is referred to as (nonlinear) harmonic
generation of coherent radiation.

The process of harmonic generation of coherent radiation can be considered
as a purely electrodynamical one. In fact, the harmonics of the electron beam
density are driven by the electromagnetic ﬁeld at the fundamental frequency,
but the bunching contribution due to the interaction of the electron beam with
the radiation at higher harmonics can be neglected. This leads to important
simpliﬁcations. In fact, in order to perform numerical analysis of the char-
acteristics of higher harmonics radiation, one has to solve the self-consistent
problem for the fundamental harmonic only. Subsequently, the solution to this
problem, that must be obtained with the help of a self-consistent code, can be
used to calculate the harmonic contents of the beam current. These contents
enter as known sources in our electrodynamical process: solving Maxwell equa-
tions accounting for these sources gives the desired characteristics of higher
harmonics radiation. As a result, simulation codes dealing with harmonic gen-
eration are not ﬁrst principle codes: in fact, they simply compute the solution
of Maxwell equations obtaining the proper sources by means of ﬁrst-principle
codes.

Non-linear generation of the second harmonic radiation, in particular, is im-
portant for extending the attainable frequency range of an XFEL facility: in
fact, the high peak-brilliance increase of XFELs with respect to third gen-
eration light sources (up to eight orders of magnitude) makes the second
harmonic contents of the XFEL radiation very attractive from a practical
viewpoint. Moreover, it is also important in connection with experiments that
make use of the fundamental harmonic only. In fact one must be able to esti-
mate correctly the higher harmonics eﬀects to distinguish between nonlinear
phenomena induced by the fundamental and linear phenomena due to the
second harmonic.

The subject has been a matter of theoretical studies in a high-gain SASE FEL
both for odd [2] and even harmonics [3, 4, 8], where the electrodynamical prob-
lem is dealt with. The practical interest of these studies is well underlined by

3

the fact that they were followed by both numerical analysis [5] and experi-
ments, that have been carried out in the infra-red and in the visible range of
the electromagnetic spectrum [6, 7].

Experimental results are compared with numerical analysis and numerical
analysis rely on analytical studies: this fact stresses the importance of a cor-
rect theoretical understanding of the subject. Remarkably, such understanding
does not require the introduction of radically new physical mechanisms. The
key ideas involved are not much diﬀerent from those regarding the second har-
monic generation from a single particle, treated a long time ago and presented
in Synchrotron Radiation textbooks (e.g. [9, 10]). A complexity though, is
constituted by the presence of many electrons involved in the radiative pro-
cess, each with a given oﬀset and phase, radiating coherently, as a whole or
in part, due to the longitudinal modulation of the beam current at the second
harmonic.

For a given frequency component the electromagnetic wave equation dic-
tates both a characteristic longitudinal length (that is the radiation formation
length) and a characteristic transverse length. As we will see, when the beam
transverse size is smaller than the characteristic transverse length the entire
electron beam behaves like a single electron and the harmonics of the beam
current are simply interpretable in terms of the harmonic contents of a single
particle current: in this case, all the particles act coherently and the radiated
intensity scales with the square number of the electrons in the beam. When
the transverse size of the beam increases and becomes much larger than the
characteristic transverse length less electrons contribute collectively to the
ﬁeld and if the beam current remains constant the total radiated power is
decreased.

The characteristic transverse length is speciﬁed in a natural way after a di-
mensional analysis of the problem. The ﬁrst treatment [3] of non-linear gener-
ation of even harmonics does not account for the presence of such parameter,
followed in this by others [4, 8]. We ﬁnd that these works include arbitrary ma-
nipulations of the source terms in the paraxial wave equation. Among these,
an important part of the source terms is systematically dropped. Moreover,
estimations of the second harmonic power are based on the electromagnetic
sources (after manipulation) while exact calculations should be based on a
solution of Maxwell equations. Altogether, we ﬁnd that these works predict
an incorrect dependence of the second harmonic ﬁeld on the problem parame-
ters. Results of [4] are extended in [8] to the case of an electron beam moving
oﬀ-axis through the undulator. One of the conclusions in [8] is that the second
harmonic power increases when an angle between the beam and the undula-
tor axis is present. We ﬁnd that the power of the second harmonic radiation
should never increase when such angle is present: in particular, as we will see,
it is independent of it in optimal situations when the microbunching wavefront

4

is matched with the beam propagation.

In this paper, that was inspired by a method [11] developed to deal with
Synchrotron Radiation from complex setups, we present a theory of second
harmonic generation in high-gain FELs. First we give, in Section 2, an exact
analytical solution of the wave equation for the second harmonic generation
problem. The procedure employed to derive such a solution shows the advan-
tages of a Green’s function method. In Section 3, our result is used to calculate,
in a particular case, speciﬁc properties of the second harmonic radiation such
as polarization, directivity diagram and total power including proper para-
metric dependencies. The most surprising prediction of our theory is that the
electric ﬁeld is not only horizontally polarized, as it is usually assumed, but
exhibits, though remaining linearly polarized, a vertically polarized compo-
nent too. Following the presentation of our theory, in Section 4 we comment
on the diﬀerences between our approach and the present understanding of
the second harmonic generation mechanism. Finally, in Section 5, we come to
conclusions.

2 Complete analysis of Second Harmonic Generation mechanism

As has been said in the Introduction, the process of (second) harmonic gen-
eration of coherent radiation is a purely electrodynamical one. First, proper
initial conditions are given as input to an FEL self-consistent code, which
calculates the electron beam bunching from the interaction of the beam with
the ﬁrst harmonic radiation. Then, the results from the self-consistent code
are used as electromagnetic sources to solve the problem of second harmonic
generation. For simplicity, in the following we will consider a beam modulated
at a single frequency ω as the source. One may always write the longitudinal
current density jz along the undulator as a sum of an unperturbed part inde-
pendent of the modulation and of the time, jo, and a term responsible for the
beam modulation, ˜jz, at frequency ω (perturbation):

jz(z, ~r⊥, t) = jo(z, ~r⊥) + ˜jz(z, ~r⊥, t) .

We assume that we can write the unperturbed part jo as if all the particles
where moving coherently, that is

jo(z, ~r⊥) = jo(~r⊥ − ~r(c)

⊥ (z)) ,

where ~r(c)
⊥ (z) describes the coherent motion. This assumption is always veri-
ﬁed, for instance, in the case of a single particle, when jo is simply a δ-Dirac
function, or in the case of a monochromatic beam. If some energy spread is

(1)

(2)

5

present, in order for Eq. (2) to be valid we should assume that the transverse
size of the electron beam is not smaller than the typical wiggling motion of
the electrons. In this case, the validity of Eq. (2) has an accuracy given by the
relative deviation of the particles energy form the average value, δγ/γ. Since
for the FEL process δγ/γ is, at most, of the order of the eﬃciency parameter,
we have δγ/γ ≪ 1 and Eq. (2) is valid with the same accuracy of FEL theory.
However it should be noted here that the average energy of the beam is to
be considered, in general, a function of the coordinate z, γ = γ(z): it has to
be given as a result of start-to-end simulations and considered as an input for
our electromagnetic problem.

The perturbation ˜jz can then be written as

˜jz(z, t) = jo

~r⊥ − ~r(c)
(cid:16)

⊥ (z)

(cid:17)

×

˜a2

z, ~r⊥ − ~r(c)

⊥ (z)

exp

iω

− iωt

+ C.C.

.

(3)

z

Z0

dz′
vz(z′)

(cid:17)














(cid:16)






The function ˜a2 is to be considered a result from the FEL self-consistent code,
and its dependence on z describes the evolution of the modulation through
the beamline and accounts for emittance and energy spread eﬀects. It should
be noted that the values of ˜a2 are not necessarily real: in fact there can be a
z-dependent phase shift with respect to the phase ω

z

0 dz′/vz(z′) − ωt.
R

0 dz′/vz(z′) − ωt in Eq. (3) one has
In order to correctly calculate the phase ω
to account for the dependence of the longitudinal velocity associated with the
R
coherent motion, vz on the position z. The function vz(z) can be recovered
from the knowledge of ~r(c)
⊥ (z) and of the average energy of the beam γ = γ(z).

z

If the beam is deﬂected of angles ηx and ηy in the horizontal and vertical di-
rection with respect to the z axis, the velocity of the coherent motion depends
also on the deﬂection angles. Renaming position and velocity of the coherent
motion with no deﬂection with the subscript ”(nd)” one obtains:

vz(z, η) = vz(nd)(z)

1 −

!
~v⊥(z, η) = ~v⊥(nd)(z) + vz(nd)(z)~η ,

 

x + η2
η2
y
2

and

~r(c)
⊥ (z, ~η) = ~r(c)

⊥(nd)(z) + ~ηz .

(4)

(5)

Also ˜a2 will depend on ~η. The exact dependence is ﬁxed by the way the beam
is prepared and should be regarded as a condition for the orientation of the

6

microbunching wavefront. In all generality we can write:

˜a2 = ˜a2

z, ~r⊥ − ~r(c)

⊥ (z, ~η)

.

(cid:16)

(cid:17)

In the limit for γ2 ≫ 1, the total current density can be written as

~j(z, t, ~η) =

~v(z, ~η)
c

jo

exp

iω
"

Z0

~r⊥ − ~r(c)
(cid:16)
z

dz′
vz(z′, ~η)

⊥ (z, ~η)

×

1 +

(

(cid:17)

˜a2
"

z, ~r⊥ − ~r(c)
(cid:16)

⊥ (z, ~η)

(cid:17)

− iωt
#

+ C.C.

.

#)

One can express the charge density as

ρ =

≃

jz
vz

jz
c

,

as we will be working in the paraxial approximation.

Eq. (7) and Eq. (8) give us the expressions to be used as sources for Maxwell
equation. Looking for solutions for ~E⊥ in the form

~E⊥ = ~

E⊥ exp [iω(z/c − t)] + C.C.

and applying the paraxial approximation, one may write the Maxwell equation
describing ~

E⊥ as [11]:

e

e

∇⊥

2 +

 

2iω
c

∂
∂z !

~
E⊥ =

4π
c

exp

i
(cid:20)

(cid:18)

Φs − ω

z
c (cid:19)(cid:21) (cid:20)

iω
c2 ~v⊥ − ~∇⊥

(cid:21)

jo˜a2 ,

(10)

(6)

(7)

(8)

(9)

(11)

were we have put

e

Φs(z, ~η) = ω

z

Z0

dz′
vz(z′, ~η)

.

With the aid of the appropriate Green’s function an exact solution of Eq.
(10) can be found without any extra assumption about the parameters of the
problem.

~E⊥(zo, ~r⊥o) = −

e

∞

1
c

Z−∞

dz′

1
zo − z′

d~r′

⊥

Z

(cid:20)

iω

c2 ~v⊥(z′, ~η) − ~∇′

⊥

(cid:21)

7

×jo

~r′

⊥ − ~r(c)

⊥ (z′, ~η)

˜a2

exp

iω

(cid:16)

(

| ~r⊥o − ~r′
(cid:17)
⊥ |2
2c(zo − z′) #

"

z′, ~r′
(cid:16)
+ i

"

⊥ − ~r(c)

⊥ (z′, ~η)
z′
(cid:17)
c #)

Φs(z′, ~η) − ω

,

(12)

where ~∇′
⊥ represents the gradient operator with respect to the source point,
while (zo, ~r⊥o) indicates the observation point. Integration by parts of the
gradient terms leads to

~E⊥ = −

iω
c2

e

∞

dz′

Z−∞
~r′

(cid:16)

1
zo − z′
Z
⊥ (z′, ~η)

d~r′

⊥

˜a2

(cid:17)

(cid:16)

−

~v⊥(z′, ~η)
c
⊥ − ~r(c)

 
z′, ~r′

~r⊥o − ~r′
⊥
zo − z′

⊥ (z′, ~η)

exp

(cid:17)

×jo

⊥ − ~r(c)

!
iΦT (z′, ~r′
h

⊥, ~η)

,
i
(13)

where the total phase ΦT is given by

ΦT =

Φs − ω
"

z′
c #

+ ω

|~r⊥o − ~r′
⊥|2
2c(zo − z′) #

"

.

(14)

(15)

(16)

We will now make use of a new integration variable ~l = ~r′

⊥ −~r(c)

⊥ (z′, ~η) so that

~E⊥ = −

e

iω
c2

∞

Z−∞
~l
(cid:16)
(cid:17)

dz′

1
zo − z′
z′,~l
(cid:17)

Z
exp

(cid:16)

d~l



~v⊥(z′, ~η)
c



iΦT (z′,~l, ~η)
h

i

−

,

×jo

˜a2

~r⊥o − ~r(c)

⊥ (z′, ~η) − ~l
zo − z′





ΦT =

Φs − ω
"

z′
c #

+ ω





|~r⊥o − ~r(c)

⊥ (z′, ~η) − ~l|2

2c(zo − z′)

.





We will consider the case of a planar undulator and we will be interested in the
total power of the second harmonic emission and in the directivity diagram
of the radiation in the far zone. Accounting for the beam deﬂection angles ηx
and ηy we model the electron transverse motion as:

~v⊥(z′, ~η) =

sin (kwz′) + ηxvz

~x + [ηyvz] ~y ,

(17)

cK
γ

−
"

and

and

#

8

⊥ (z′, ~η) + ~l =
~r(c)

(cos (kwz′) − 1) + ηxz′ + lx

~x + [ηyz′ + ly] ~y .

(18)

#

K
γkw

"

Here K is the deﬂection parameter and kw = 2π/λw, λw being the undulator
period. Moreover, one has

cΦs
ω

≃

4γ2
4γ2 − K 2 +
K 2
8γ2kw

 

−

x + η2
η2
y
2

z′ −

Kηx
kwγ

!
Kηx
γkw

sin (2kwz′) +

cos (kwz′) ,

(19)

We will now introduce the far zone approximation. Substitution of Eq. (19),
Eq. (18) and Eq. (17) in Eq. (13) yields the ﬁeld contribution calculated along
the undulator:

~E⊥ =

e

iω
c2zo Z
K
γ

" 

×

Lw/2

d~l

dz′jo

˜a2

~l
(cid:16)
(cid:17)

z′,~l
(cid:17)

Z−Lw/2
(cid:16)
sin (kwz′) + (θx − ηx)

exp [iΦT ]

~x + (θy − ηy) ~y

,

#

!

(20)

where

ΦT = ω

(

z′
2γ2c "
K 2
8γ2kwc
K
kwγc

(

−

+ω

1 +

+ γ2

K 2
2
sin (2kwz′) −

(θx − ηx)2 + (θy − ηy)2

(cid:16)
K(θx − ηx)
γkwc

cos (kwz′)
)

#

(cid:17)

(θx − ηx) −

(θxlx + θyly) + (θ2

x + θ2
y)

(21)

zo
2c )

.

1
c

Here θx and θy indicate the observation angles xo/zo and yo/zo. Moreover, the
integration is performed in from −Lw/2 to Lw/2 in dz′, Lw = Nwλw being the
undulator length. In fact, working under the resonance approximation in the
limit for Nw ≫ 1 allows us to neglect contributions outside the undulator [11].

We will make use of the well-known expansion (see [12])

exp [ia sin (ψ)] =

Jp(a) exp [ipψ] ,

(22)

where Jp indicates the Bessel function of the ﬁrst kind of order n.

∞

p=−∞
X

9

We will be interested in frequencies around the second harmonic:

ω2o = 4kwcγ2

z ,

where

γ2
z =

γ2
1 + K 2/2

.

Indicating with
cies around ω2o one obtains

e

~E ⊥2 the second harmonic contribution calculated at frequen-

∞

∞

Lw/2

~E⊥2 =

iω2o
c2zo

e

dlx

Z−∞
∞

Z−∞
∞

˜a2

dly

Z−Lw/2

dz′jo

exp[iΦo]

z′,~l
(cid:17)

~l
(cid:16)
(cid:17)
inπ
2 (cid:21)
exp {i[Rω + 1]kwz′} − exp {i[Rω − 1]kwz′}

Jm(u)Jn(v) exp

(cid:16)

(cid:20)

×

m=−∞
X

×

− i

("

n=−∞
X
K
2γ  

+(θx − ηx) exp {iRωkwz′}

~x +
#

"

!
(θy − ηy) exp {iRωkwz′}

, (25)

~y
#

)

where

with

Moreover

and

Rω =

− n − 2m ,

ω
ω1

ω−1
1 =

1
2kwcγ2 (

1 +

K 2
2

+ γ2

(θx − ηx)2 + (θy − ηy)2
h

)
i

.

u =

v =

ω2o
ω1

ω2o
ω1

K 2 [1 − K 2/(4γ2)]

,

4

1 + K 2
n

2 + γ2

(θx − ηx)2 + (θy − ηy)2
h

io

1 + K 2

2Kγ [1 − K 2/(4γ2)] (θx − ηx)
2 + γ2

(θx − ηx)2 + (θy − ηy)2
h

i

Φo = ω2o

(θx − ηx) −

(θxlx + θyly) +

K
kwγc

"

1
c

zo
2c

(θ2

x + θ2
y)

.

#

10

(23)

(24)

(26)

(27)

(28)

(29)

(30)

In the limit for Nw ≫ 1 and if ˜a2 does not vary much in z′ over a period of the
undulator λw the fast oscillations in the exponential function in the integrand
of Eq. (25) tend to suppress the integral unless Rω = 0, Rω = −1 or Rω = 1,
that is when at least one of the exponential function is simply unity. If ω = ω2
this corresponds to n = 2 − 2m, n = 3 − 2m and n = 1 − 2m respectively.
Neglecting all other terms and imposing ω = ω2 + ∆ω2 we obtain

i

∆ω2
ω1

(cid:26)

kwz′

(cid:27)

~E⊥2 =

iω2o
c2zo

e

Z−∞
∞

∞

∞

Lw/2

dlx

dly

Z−∞

Z−Lw/2

dz′jo

˜a2

~l
(cid:16)
(cid:17)

(cid:16)

×

m=−∞ ("

X

− i

K
2γ  

−Jm(u)J1−2m(v) exp

Jm(u)J3−2m(v) exp

i[1 − 2m]π
2

(

)!

exp[iΦo] exp

z′,~l
(cid:17)
i[3 − 2m]π
2

(

)

+(θx − ηx)Jm(u)J2−2m(v) exp

+

(θy − ηy)Jm(u)J2−2m(v) exp
"

(

~x

) #

(

i[2 − 2m]π
2
i[2 − 2m]π
2

~y
) #

)

.

For any value of K and θx − ηx much smaller than 1/γz, v is a small parameter
and only the smallest indexes in the Bessel functions Jq(v) ∼ vq in Eq. (25) give
non negligible contribution. As a result, Eq. (25) can be drastically simpliﬁed.
One can write (compare, for instance, with [11]):

∞

∞

Lw/2

~E⊥2 =

e

iω2o
c2zo

×jo

[A(θx − ηx)~x + B(θy − ηy)~y]

dlx

dly

dz′ exp [iΦo]

˜a2

~l
(cid:16)
(cid:17)

z′,~l
(cid:17)
(cid:16)

exp[iCz′] exp

Z−∞
i2γ2
z
n

Z−∞

Z−Lw/2
(θx − ηx)2 + (θy − ηy)2
h

kwz′

i

o(32)

where we have deﬁned

A =

2K 2
2 + K 2 "

J0

K 2
2 + K 2 !

 

− J2

K 2

2 + K 2 !#

 

+ J1

K 2
2 + K 2 !

 

,

B = J1

K 2
2 + K 2 !

 

,

we have used the fact that

∆ω2
ω1

= 2γ2
z

(θx − ηx)2 + (θy − ηy)2
h

i

+ C ,

11

(31)

(33)

(34)

(35)

Q

0,4

0,3

0,2

0,1

0,0

0

2

4

6

8

10

Fig. 1. Illustration of the behavior of the ratio Q(K) between the second harmonic
ﬁeld contribution due to the gradient of the density part of the source and the
contribution due to the current part of the source.

with

C =

ω − ω2o
ω1o

and, under the resonant approximation, we have

Φo =

−(θxlx + θyly) +

ω2o
c (cid:20)

zo
2

(θ2

x + θ2
y)

.

(cid:21)

K

(36)

(37)

The detuning parameter C should indeed be considered as a function of z,
C = C(z) which can be retrieved from the knowledge of γ = γ(z).

It is important to see that the terms in J1 in Eq. (33) and Eq. (34) are due
to the presence of the gradient term in ~∇⊥(jo˜a2) in Eq. (10), which has been
omitted in [3] and later on in [4, 8]. We ﬁnd that, without the gradient, term
one would recover results quantitatively incorrect for the x-polarization com-
ponent. In Fig. 1 we plotted the ratio between the contribution of the radiation

12

ﬁeld due to the gradient of the density part of the source and the contribution
due to the current part of the source for the x-polarization component. This
is a function Q(K) of the K parameter only and it can be written as

Q =

˜E⊥2g
˜E⊥2c

=

2 + K 2
2K 2 J1

K 2

2 + K 2 ! , "

 

J0

K 2
2 + K 2 !

 

− J2

K 2

2 + K 2 !#

 

,

(38)

where the subscript ”g” stands for ”gradient and ”c” stands for ”current”.
As it can be seen from Fig. 1, the gradient term always contributes for more
than one fourth of the total ﬁeld, independently of the values of K. Also, if
the gradient term is omitted, the entire contribution to the ﬁeld polarized in
the y direction would go overlooked. The inclusion of the gradient term in the
source part of the wave equation should not be considered as a peculiarity of
the second harmonic generation mechanism. In Synchrotron Radiation theory
from bending magnets, for instance, the presence of such a source term is
customary and it is responsible, as here, for part of the horizontally polarized
ﬁeld and for the entire vertically polarized ﬁeld. Moreover, the gradient term
is always associated with an integration by part, and therefore is always ac-
companied with the gradient of the Green’s function, which is responsible for
a term proportional to the observation angle θx,y.

Eq. (32) can be also written as:

˜~E⊥2 =

iω2o
c2zo
∞

exp

ω2o
2c

i
∞

(cid:20)

x + θ2
zo(θ2
y)
∞

(cid:21)
dz′ exp

[A(θx − ηx)~x + B(θy − ηy)~y]

ω2o
c

−i

(cid:20)

(θxlx + θyly)

(cid:21)
˜ρ(2)(z′,~l, C) ,

(θx − ηx)2 + (θy − ηy)2
h

i

z′

(cid:27)

×

dlx

dly

Z−∞

Z−∞

Z−∞
ω2o
2c

× exp

i

(cid:26)

where we have deﬁned ˜ρ as

˜ρ(2)(z′,~l, C) = jo

exp [iCz′] HLw(z′) ,

˜a2

~l
(cid:16)
(cid:17)

z′,~l
(cid:17)

(cid:16)

(39)

(40)

HLw(z′) being a function equal to unity over the interval [−Lw/2, Lw/2] and
zero everywhere else. Its introduction simply amounts to a notational change.
Namely it accounts for the fact that the integral in dz′ is performed over the
undulator length in Eq. (32), while it is performed from −∞ to ∞ in Eq. (39).
It should be noted that, usually, computer codes do not present the functions
˜a2 and exp[iCz′] separately as we did, but rather they combine them in a
single product, usually known as the complex amplitude of the electron beam
modulation with respect to the phase ψ = 2kwz′ + (ω/c)z′ − ωt. Regarding ˜ρ(2)

13

as a given function allows one not to bother about a particular presentation
of the beam modulation.

Eq. (32) or, equivalently, Eq. (39) are our most general result, and are valid
independently on the model chosen for the current density and the modulation.
It is interesting to note here that, when one writes Eq. (32) in the form of Eq.
(39), one obtains an expression which is formally similar to the spatial Fourier
transform of ˜ρ(2)(z′,~l, C) with respect to z′ and ~l. There are two problems
though: ﬁrst, ˜ρ(2) is a function of ~η, which appears in the conjugate variable
to z′ and, second, if γ = γ(z) one has ω2o = ω2o(z).

3 Analysis of a simple model

Let us treat a particular case. Namely, let us consider the case when we can
consider γ(z) = ¯γ = const, when C(z) = 0 and

˜ρ(2)(z,~l) = jo

a2o exp

i

(ηxlx + ηyly)

HLw(z) ,

~l
(cid:16)
(cid:17)

ω2o
c

(cid:20)

(cid:21)

with a2o = const and

=

jo

~l
(cid:16)
(cid:17)

Io
2πσ2 exp

x + l2
l2
y
2σ2 !

,

−

 

(41)

(42)

Io and σ being the bunch current and transverse size respectively.

This particular case corresponds to a modulation wavefront perpendicular to
the beam direction of motion. In this case Eq. (39) can be written as

˜~E⊥2 =

ia2oω2o
c2zo
∞

i

exp
∞

(cid:20)

ω2o
2c

zo(θ2
∞

x + θ2
y)

[A(θx − ηx)~x + B(θy − ηy)~y]

dz′ exp

(cid:21)

−i

ω2o
c

(cid:26)

[(θx − ηx) lx + (θy − ηy) ly]

×

dlx

dly

Z−∞

Z−∞

Z−∞
ω2o
2c

× exp

i

(cid:26)

(θx − ηx)2 + (θy − ηy)2
h

i

z′

jo

(cid:27)

~l
(cid:16)
(cid:17)

HLw(z′)

(cid:27)

(43)

and amounts, indeed to the spatial Fourier transform of jo
obtain straightforwardly:

HLw(z′). We

~l
(cid:16)
(cid:17)

˜~E⊥2 =

iIoa2oω2oLw
c2zo

ω2o
2c

exp

i

(cid:20)

zo(θ2

x + θ2
y)

[A(θx − ηx)~x + B(θy − ηy)~y]

(cid:21)

14

(44)

(45)

(46)

×sinc

× exp

Lwω2o
(θx − ηx)2 + (θy − ηy)2
4c
h
σ2ω2
2o
2c2

i(cid:27)
(θx − ηx)2 + (θy − ηy)2
h

−

(cid:26)

(

)
i

.

If the beam is prepared in a diﬀerent way so that, for instance, the modulation
wavefront is not orthogonal to the direction of propagation of the beam, Eq.
(39) retains its validity. However it should be noted that, in this case, Eq.
(39) is not, in general, a Fourier transform. It is if γ(z) = ¯γ = const and
iα~η · ~l
˜ρ(2) includes a phase factor of the form exp
. The case α = 1 has just
been treated. The case α = 0 corresponds, instead, to a modulation wavefront
i
h
orthogonal to the z axis and not to the direction of propagation.

Going back to our particular case in Eq. (44), a subject of particular interest
is the angular distribution of the radiation intensity along the ~x and ~y po-
larization directions which will be denoted with I2(x,y). Upon introduction of
normalized quantities:

ˆθ =

ˆη =

ˆlx,y =

ω2oLw
c
ω2oLw
c
ω2o
cLw

s

s

s

θ =

8πNwγzθ

q

q

q

η =

8πNwγzη

lx,y =

8πNw

lx,y

γz
Lw

and of the Fresnel number:

N =

ω2oσ2
cLw

,

one obtains

I2(x,y)

ˆθx − ˆηx, ˆθy − ˆηy
(cid:16)

(cid:17)

= const ×

2

ˆηx,y − ˆθx,y
1
(cid:16)
(cid:17)
ˆθx − ˆηx
4 (cid:20)(cid:16)
(cid:26)
−N

(cid:17)
ˆθx − ˆηx

2

×sinc2

× exp

+

2

ˆθy − ˆηy

2

(cid:16)
+

(cid:17)
ˆθy − ˆηy

(cid:21)(cid:27)
2

.

(47)

(cid:26)

(cid:20)(cid:16)

(cid:17)

(cid:16)

(cid:21)(cid:27)

(cid:17)

Note that in the limit for N ≪ 1, Eq. (47) restitutes the directivity diagram
for the second harmonic radiation from a single particle. In agreement with
Synchrotron Radiation textbooks [9, 10] none of the polarization components
of I2(x,y) has azimuthal symmetry, contrarily with what happens for the ﬁrst
harmonic, where only the x polarization is present and is endowed with az-
imuthal symmetry.

15

  N = 0.001

  N = 0.01

  N = 0.1

  N = 1

  N = 10

max

I

/ I

2x

2x

1,0

0,8

0,6

0,4

0,2

0,0

0

1

2

3

4

5

6

7

^

^

-

x

x

Fig. 2. Plot of the directivity diagram for the radiation intensity as a function of
ˆθx − ˆηx at ˆθy − ˆηy = 0 for the horizontal polarization component, for diﬀerent values
of N .
As an example, the directivity diagram in Eq. (47) is plotted in Fig. 2 for
diﬀerent values of N as a function of ˆθx − ˆηx at ˆθy − ˆηy = 0 for the horizontal
polarization component.

The next step is the calculation of the second harmonic power. The power for
the x- and y-polarization components of the second harmonic radiation are
given by

W2(x,y) =

dxo

dyo|E⊥x,y(zo, xo, yo, t)|2

dxo

dyo| ˜E⊥x,y(zo, xo, yo)|2 , (48)

c
4π

=

c
2π

∞

∞

Z−∞
∞

Z−∞
∞

Z−∞

Z−∞

where (...) denotes averaging over a cycle of oscillation of the carrier wave.

We will still consider the model speciﬁed by Eq. (41) and Eq. (42) with C = 0.
It is convenient to present the expressions for W2x and W2y in a dimension-

16

F

2

5

4

3

2

1

0

0,0

0,5

1,0

1,5

2,0

N

Fig. 3. Illustration of the behavior of F2(N ).

less form. After appropriate normalization they both are a function of one
dimensionless parameter only:

ˆW2x = ˆW2y = F2(N) = ln

1 +

1
4N 2

.

(cid:19)

(cid:18)

Here ˆW2x = W2x/W (2)
the normalization constants W (2)

ox and ˆW2y = W2y/W (2)
ox and W (2)

oy are the normalized powers, while
oy are given by

For practical purposes it is convenient to express Eq. (50) in the form:

W (2)
ox
W (2)
oy

= 









A2
B2 








a2
2oI 2
o
2πc

.

W (2)
ox
W (2)
oy

= 









A2
B2 








Wb

a2
2o
2π # "

Io
γIA #

"

,

17

(49)

(50)

(51)

where Wb = mec2γIo/e is the total power of the electron beam and IA =
mec3/e ≃ 17 kA is the Alfven current.

The function F2(N) is plotted in Fig. 3. The logarithmic divergence in F2(N) in
the limit for N ≪ 1 imposes a limit on the meaningful values of N. On the one
hand, the characteristic angle ˆθmax associated with the intensity distribution is
given by ˆθ2
max ∼ 1/N. On the other hand, the expansion of the Bessel function
in Eq. (32) is valid only as ˆθ2 . Nw. As a result we ﬁnd that Eq. (49) is valid
only up to values of N such that N & N −1
w we
deal with a situation when the dimensionless problem parameter N is smaller
than the accuracy of the resonance approximation ∼ N −1
w . In this situation
our electrodynamic description does not distinguish anymore between a beam
with ﬁnite transverse size and a point-like particle and, for estimations, we
should make the substitution ln (N) −→ ln (N −1

w . However, in the case N < N −1

w ).

We will now compare our results for the second harmonic with already known
results for the ﬁrst. The case treated in [13] corresponds to a modulation
wavefront orthogonal to the direction of propagation, exactly as speciﬁed here
for the second harmonic (i.e. perfect resonance with Eq. (41) and Eq. (42)
valid) and allows direct comparison of results. The outcomes of [13] have been
presented, similarly to what has been done here for the second harmonic, in
dimensionless form. After appropriate normalization, one ﬁnds:

ˆW1(N) =

W1
W (1)
o

= F1(N) =

arctan

2
π "

1
N (cid:19)

(cid:18)

+

ln

N
2

N 2

N 2 + 1 !#

 

,

(52)

where the normalization factor W (1)

is given by

o

W (1)

o = Wb

2π2a2
1o

h

"

i

Io
γIA # "

K 2
2 + K 2 #

NwA2

JJ ,

AJJ being given by

AJJ = J0

K 2
4 + 2K 2 !

 

− J1

K 2
4 + 2K 2 !

 

.

(53)

(54)

Here a1o is the analogous of a2o for the ﬁrst harmonic. For notational reasons,
a1o is one half of the original modulation level ain in Eq. (27) of [13]. It should
also be noted that all N in Eq. (52) are multiplied by a factor 1/2 with respect
to what is reported in [13]. This is because we are referring all results to the
Fresnel number for the second harmonic.

The function F1(N) is plotted in Fig. 4. We can compare more quantitatively
the normalized power for the second and for the ﬁrst harmonic:

18

F

1

1,5

1,0

0,5

0,0

0,0

0,5

1,0

1,5

2,0

N

(55)

(57)

Fig. 4. Illustration of the behavior of F1(N ).

F2(N)
F1(N)

=

π
2 


arctan

ln

1 + 1
4N 2
(cid:17)
(cid:16)
1
2 ln
N

+ N

(cid:16)

(cid:17)

,



N 2
N 2+1

(cid:16)



(cid:17)

while, from a practical viewpoint, the comparison between the real powers is
equal to

W2
W1

=

W (2)

ox + W (2)
oy
W (1)
o

F2(N)
F1(N)

=

1
(2π)3Nw

2 + K 2
K 2

a2
2o
a2
1o

A2 + B2
A2
JJ

F2(N)
F1(N)

.

(56)

It is interesting to calculate Eq. (55) in the limit N ≫ 1. We have

F2(N)
F1(N)

π
4N

−→

at N ≫ 1 .

In Fig. 5 we plot the behavior of F2/F1 as a function of N and its asymptotic,
π/(4N), for N ≫ 1.

Finally, it is possible to study the ratio between the second harmonic power
due to the y vertical and the x horizontal polarization components, that is only

19

F /

F

2

1

14

12

10

8

6

4

2

0

1E-3

0,01

0,1

1

10

N

(58)

Fig. 5. Solid line: illustration of the behavior of F2/F1 as a function of N . Dashed
line: its asymptotic, π/(4N ), for N ≫ 1.

a function of the K parameter and is simply given by the ratio R = W2y/W2x:

R(K) =

W2y
W2x

=

A2(K)
B2(K)

.

A plot of R(K) is given in Fig. 6. As it is seen the relative magnitude scales
from 4% in the case K ≪ 1 till about 6% in the limit K ≫ 1: as one can see,
the vertical polarization component of the radiation depends quite weakly on
the K parameter. The knowledge of the polarization contents of the radiation,
even if relatively small as in this case, can be important from an experimental
viewpoint. For example, in the VUV wavelength range, the reﬂection coeﬃ-
cients of many materials (e.g. SiC, that is widely used for mirrors) exhibit a
complicated behavior, and there may be even an order of magnitude diﬀerence
depending on the polarization of the radiation. It should be noted that R(K)
is independent of the particular model chosen for the beam modulation as it is
easy to understand inspecting Eq. (32). It is also important to remark the fact
that the second harmonic radiation from a planar undulator is linearly polar-
ized, since vertical and horizontal polarization components are characterized

20

R   [%]

4

 

6

2

0

0

2

4

6

8

10

K

Fig. 6. Illustration of the behavior of the ratio between the second harmonic power
due to the y vertical and the x horizontal polarization components, R(K).

by the same phase factor. This fact is well-known in Synchrotron Radiation
theory for a single particle and it is true for any observation angle and any
harmonic of the radiation from a planar undulator [10] in contrast, for in-
stance, to the case of bending magnet radiation, when vertical and horizontal
polarization components exhibit a relative π/2 phase shift, indicating circular
polarization.

An important comment to what has been done before is needed. We calculated
the electric ﬁeld, the angular intensity distribution and the power for the
second harmonic making a particular assumption about the electron beam
modulation in Eq. (41). This amounts to consider the modulation wavefront
orthogonal to the direction of propagation of the beam. The same assumption
has been implicitly done calculating the ﬁrst harmonic power (the expression
in [13] has been used, which does not account for deﬂection angles). In this
particular case we have seen that the total power of the second harmonic
radiation does not depend on the deﬂection angles ηx and ηy. In the more
general situation we ﬁnd that the second harmonic power can be independent
of the beam deﬂection angle (like in the situation treated by us) or can decrease
due to the presence of extra oscillating factors in ~l in Eq. (39). On the contrary,
in [8], an increase of the total power is reported due to the presence of deﬂection

21

angles.

4 Discussion

After the presentation of our theory has been given, in this Section we want to
discuss in a more detailed way the diﬀerences between our approach and the
currently accepted treatment of the problem of second harmonic generation.

It is worth to begin summarizing the steps which led us to our main re-
sults. First, we started from the wave equation assuming that the electromag-
netic sources are given externally by some code calculating the electron beam
bunching at the second harmonic. Second, after applying the ultrarelativistic
approximation (γ2 ≫ 1) and the resonance approximation (Nw ≫ 1), both
non-restrictive ones, we solved exactly the wave equation using the Green’s
function method. Third, we calculated the angular distribution of intensity
assuming a given beam modulation and we derived an expression for the total
power radiated at the second harmonic by integrating the expression for the
angular distribution of intensity. Finally we compared the expression for the
second harmonic power with the analogous expression for the ﬁrst harmonic.

In [3] and later on in [4, 8] the ultrarelativistic and the resonance approxima-
tion were used too, but several steps were performed on the wave equation
which we ﬁnd incorrect. First, the gradient term in the source part of the
wave equation is overlooked. Second, the particles trajectory in the transverse
x direction is expanded (we will comment on this later on), and because of
that the Fresnel number N is not identiﬁed as the main physical parameter of
the problem. Third, after these manipulations, the wave equation is not solved
but, rather, the second harmonic power is estimated in the following way: (a)
the squared of the (manipulated) source parts of the wave equation for the
second harmonic is calculated; (b) the squared of the source parts for the ﬁrst
[8] or the third [3, 4] harmonic is calculated; (c) the ratio between the square
of the source parts for the second and either the ﬁrst [8] or the third [3, 4]
is taken. As a result, magnitude of the second harmonic power and polariza-
tion characteristics are predicted that are in disagreement with what we have
found. In [8], further notions regarding the case of deﬂection angle between
the beam and the undulator axis are introduced. We already expressed our
critical view on this last conclusion at the end of the previous Section. Let us
brieﬂy comment on the other points mentioned above by analyzing more in
detail the approach followed in [3, 4, 8].

As has been already said, we ﬁnd that neglecting the gradient term in the wave
equation is not correct. As we have seen in Section 2 such term is responsible
for a contribution to the total intensity for the second harmonic both for the

22

horizontal and for the vertical polarization components and, indeed, it cannot
be neglected. Doing so would result in any case in an overall incomplete result:
namely one would obtain only part of the horizontally polarized component
of the ﬁeld.

Going further with the derivation in [3, 4, 8], the motion of the electrons in
the x-direction is written as a sum of a fast oscillation due to the undulating
motion and a slow motion due to the betatron functions. On the y-direction
instead, only the slow motion due to betatron functions is present. The beam
distribution is then considered as a collection of individual point-particles, i.e.
a sum of δ-Dirac functions. For the i-th electron one may write

x′
i(z) = ¯xi(z) + ∆xi(z)

and

y′
i(z) = ¯yi(z) ,

(59)

(60)

where ∆xi(z) describes the fast oscillation, while ¯xi(z) and ¯yi(z) describe the
slow motion.

All the δ-Dirac in the x coordinate on the right hand side of Maxwell equation
are subsequently expanded as

δ(xi − ¯xi(z) − ∆xi(z)) ≃ δ(xi − ¯xi(z)) − ∆xi(z)δ′(xi − ¯xi(z)) ,

(61)

based on the only assumption that the transverse beam dimension is much
larger than the wiggling amplitude of the electron motion. It should be noted
that, based on this assumption, the ratio between the wiggling amplitude
and the transverse beam dimensions, K/(γkwσ) ≪ 1, is identiﬁed as the main
physical parameter of the theory and is denoted as the coupling strength of the
second harmonic emission. In contrast with this we have found that the exact
solution of the wave equation depends on the Fresnel number, but not on the
coupling strength (see, for instance, Eq. (47)). In this regard it is suggestive
to write 1/N = Lwc/(σ2ω) as 1/N = [K/(γkwσ)]2 × πNw(2 + K 2)/(4K 2).
As K/(γkwσ) assumes a ﬁxed value (for instance, much smaller than unity
according to the assumption above), our Fresnel number can assume any value,
depending on the number of undulator periods Nw. If, on the one hand, N ≫ 1
we have a behavior F2(N) ∼ 1/(4N 2) ∝ N 2
w so that F2(N)/F1(N) ∝ Nw as
has been seen in Eq. (57) and therefore the ratio W2/W1 is independent on
Nw as one can see from Eq. (56). On the other hand, if N ≪ 1 we obtain
F2(N) ∼ ln[1/(4N 2)] ∼ const so that F2(N)/F1(N) is independent on Nw
while W2/W1 ∝ N −1
w . On the contrary, being based on the coupling strength

23

parameter only, current understandings of the second harmonic mechanism
predict that W2/W1 is always independent on Nw.

Finally we ﬁnd that, from a mathematical viewpoint, the expansion in Eq.
(61) constitutes an incorrect manipulation of the right hand side of Maxwell
equation and. To show this, we simply need to consider the mathematical
structure of the wave equation. For any polarization component we are dealing
with a diﬀerential equation:

L

Ex,y(x, y, z) = fx,y(z)

δ(xi − ¯xi(z) − ∆xi(z))δ(yi − ¯yi(z)) ,

(62)

e

with

Xi

L =

∇⊥

2 +

 

2iω
c

∂
∂z !

,

where fx,y(z) is a function containing the appropriate phase factor. This is
essentially equivalent to our starting equation, Eq. (10), the only diﬀerences
being that the sources are presented in a diﬀerent way and that, at that stage,
we had already assumed that the transverse beam dimensions are not smaller
than the wiggling amplitude of the electron motion.

The problem with the expansion in Eq. (61) is that ∆xi = ∆xi(z) is a function
of the longitudinal coordinate and that the Green’s function for the wave
equation depends on both longitudinal and transverse coordinates. Let us see
this point in more detail. If we call with G(zo − z′, xo − x′, yo − y′) the Green’s
function of the operator L we have

∞

∞

∞

˜Ex,y(zo, xo, yo) =

dx′

dy′

dz′ G(zo − z′, xo − x′, yo − y′)

Z−∞

Z−∞
×fx,y(z′)δ(x′ − ¯x(z′) − ∆x(z′))δ(y′ − ¯y(z)) ,

Z−∞

(64)

that is

˜Ex,y(zo, xo, yo) =

dz′G(zo − z′, xo − ¯x(z′) − ∆x(z′), yo − ¯y(z′))

∞

Z−∞
×fx,y(z′) .

It follows that the expansion of the δ-Dirac in Eq. (61) is mathematically
equivalent to the expansion of the Green’s function G in ∆xi(z′) around xo −
¯xi(z′); however under the only assumptions ¯xi(z′) ≫| ∆xi(z′) | and ¯yi(z′) ≫|

(63)

(65)

24

∆xi(z′) | we cannot expand the Green’s function in ∆xi(z′) around xo − ¯xi(z′).
In fact we have that

G(zo − z′, xo − ¯xi(z′) − ∆xi(z′), yo − ¯y(z′))
6= G(zo − z, xo − ¯xi(z′), yo − ¯yi(z′))
dG(zo − z′, ξ, yo − ¯yi(z′))
−∆xi(z′)
dξ

|ξ=xo−¯xi(z′)

,

(66)

because G is simultaneously a function of z not only through ∆xi(z′), ¯xi(z′)
and ¯yi(z′) but also through zo − z′.

5 Conclusions

In this paper we addressed the mechanism of second harmonic generation in
Free-Electron Lasers.

We found that an early treatment of this phenomenon [3] is based on arbitrary
manipulations of the source term of the wave equation, which describes the
electrodynamical part of the problem. First, an important part of the source
term is neglected and, second, an expansion of the particles trajectory in the
transverse horizontal direction is performed, while we ﬁnd that there is no
ground for such a step. Moreover, this leads to the identiﬁcation of the ratio
between the amplitude of the electron wiggling motion in the (planar) undu-
lator and the electron beam transverse size as the main physical parameter,
while such parameter does not play any role in our theory. The same steps
were also followed in [4, 8]. After these manipulations, the wave equation is
not solved but, rather, an estimation of the second harmonic power is given by
calculating the squared of the manipulated source parts in the wave equation
for the second and either for the ﬁrst [8] or the third [3, 4] harmonic and,
subsequently, taking the ratio between the squared of the second harmonic
source part and either the squared of the ﬁrst or the third. Finally in [8] it is
introduced the notion of a second harmonic power increasing when a deﬂection
angle between the beam trajectory and the undulator z direction is present.
On the contrary, we ﬁnd that such power can only decrease or, at most, be
independent of the deﬂection angle, depending on how the beam modulation
is prepared.

By solving analytically the wave equation with the help of the Green’s func-
tion technique we derived an exact expression for the ﬁeld of the second har-
monic emission. We limited ourselves to the steady-state case which is close
to practice in High-Gain Harmonic Generation (HGHG) schemes but, for the
rest, we did not make restrictive approximations. This solution of the wave
equation may therefore be used as a basis for the development of numerical

25

codes dealing with second harmonic emission, which should be using as input
data the electron beam bunching for the second harmonic as calculated by
self-consistent FEL codes.

We found that, in general, the second harmonic ﬁeld presents both horizon-
tal and vertical polarization components and that the electric ﬁeld is linearly
polarized, while the relative magnitude of the power associated to the verti-
cal polarization component to that associated to the horizontal polarization
component is a function of the undulator deﬂection parameter only. Using
our result we calculated analytically the directivity diagram and the power
associated with the second harmonic radiation assuming a particular beam
modulation case. We expect that these expressions may be useful for cross-
checking of numerical results.

In this paper, we presented a theory of the second harmonic generation mech-
anism in XFELs and pointed out several notions on such mechanism which
we consider incorrect. In this regard, it should be noted that some of them
appear to go beyond the subject of harmonic generation itself. In fact we
have seen that these notions imply an increase of the second harmonic power
when an angle between the beam direction and the undulator axis is present,
as if this was a general property depending on Maxwell equations. In other
words, it looks like the solution of Maxwell equations for any electron beam
in an undulator would yield a non-trivial dependence on the angle between
the trajectory and the undulator axis. If so, this conclusion should be valid,
in particular, for a single particle as well. We ﬁnd that this is not correct: in
fact, for a single particle in a undulator the dependence of the electric ﬁeld on
the angle between the average direction of the particle and the undulator axis,
ηx,y, is simply related to the chosen reference system, i.e., usually, one with the
z axis aligned with the undulator axis. A simple rotation of an angle ηx,y to a
system with the z axis aligned with the electron average velocity would give a
result independent on such angle. This means that the basic characteristics of
undulator radiation, in particular the intensity distribution at ﬁxed frequency
and the spectrum at ﬁxed observation angle θx,y, depend on the combination
(θx,y − ηx,y) only. In other words the presence of an angle ηx,y between the
electron direction and the undulator axis has the only eﬀect of introducing a
rotation in the expression of the electric ﬁeld otherwise leaving unvaried all
its characteristics, including its resonance frequency.

6 Acknowledgements

The authors wish to thank Martin Dohlus (DESY) for useful discussions and
Josef Feldhaus (DESY) for his interest in this work.

26

References

[1] E. Saldin, E. Schneidmiller and M. Yurkov, The Physics of Free Eelectron

Lasers, Springer, 2000

[2] Z. Huang and K. Kim, Phys. Rev. E, 62, 5 (2000)
[3] M. Schmitt and C. Elliot, Phys. Rev. A, 34, 6 (1986)
[4] Z. Huang and K. Kim, Nucl. Instr. and Meth. in Phys. Res. A 475, 112

[5] H. Freund, S. Biedron and S. Milton., Nucl. Instr. and Meth. in Phys.

Res. A 445, 53 (2000)

[6] A. Tremaine et al., Phy. Rev. Lett. 88, 204801 (2002)
[7] S. Biedron et al. Nucl. Instr. Meth. A 483, 94 (2002)
[8] Z. Huang and S. Reiche, Proceedings of the FEL 2004 Conference, Trieste,

[9] H. Wiedemann, Synchrotron Radiation, Springer-Verlag, Germany (2003)
[10] Undulators, Wigglers and their applications, Edited by H. Onuki and P.

Ellaume, Taylor & Francis (2003)

[11] G. Geloni, E. Saldin, E. Schneidmiller and M. Yurkov, Paraxial Green’s
functions in Synchrotron Radiation theory, DESY 05-032, ISSN 0418-9833
(2005)

[12] D. Alferov, Y.A. Bashmakov et al. Sov. phys. - Tech. Phys. 18, 1336

(2001)

Italy

(1974)

[13] E. Saldin et al. Nucl. Instr. Meth. A 539, 499 (2005)

27

