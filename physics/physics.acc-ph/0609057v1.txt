DEUTSCHES ELEKTRONEN-SYNCHROTRON

in der HELMHOLTZ-GEMEINSCHAFT

DESY 06-137

August 2006

Coherence properties of the radiation from X-ray
free electron laser

E.L. Saldin, E.A. Schneidmiller, M.V. Yurkov

Deutsches Elektronen-Synchrotron (DESY), Notkestrasse 85, D-22607 Hamburg,
Germany

Abstract

We present a comprehensive analysis of coherence properties of the radiation from X-
ray free electron laser (XFEL). We consider practically important case when XFEL is op-
timized for maximum gain. Such an optimization allows to reduce signiﬁcantly parameter
space. Application of similarity techniques to the results of numerical simulations allows to
present all output characteristics of the optimized XFEL as functions of the only parameter,
ratio of the emittance to the radiation wavelength, ˆǫ = 2πǫ/λ. Our studies show that op-
timum performance of the XFEL in terms of transverse coherence is achieved at the value
of the parameter ˆǫ of about unity. At smaller values of ˆǫ the degree of transverse coherence
is reduced due to strong inﬂuence of poor longitudinal coherence on a transverse one. At
large values of the emittance the degree of transverse coherence degrades due to poor mode
selection. Comparative analysis of existing XFEL projects, European XFEL, LCLS, and
SCSS is presented as well.

6
0
0
2
 
p
e
S
 
7
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
7
5
0
9
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Preprintsubmitted toOpticsCommunications

1 Introduction

Free electron lasing at wavelengths shorter than ultraviolet can be achieved with a single-

pass, high-gain FEL ampliﬁer. Because a lack of powerful, coherent seeding sources short-
wavelength FEL ampliﬁers work in so called Self-Ampliﬁed Spontaneous Emission (SASE)

mode when ampliﬁcation process starts from shot noise in the electron beam [1,2,3]. Present
level of accelerator and FEL techniques holds potential for SASE FELs to generate wavelengths

as short as 0.1 nm [4,5,6].

Experimental realization of X-ray FELs (XFELs) developed very rapidly during last decade.
The ﬁrst demonstration of the SASE FEL mechanism took place in 1997 in the infrared wave-
length range [7]. In September of 2000, a group at Argonne National Laboratory (ANL) became

the ﬁrst to demonstrate saturation in a visible (390 nm) SASE FEL [8]. In September 2001, a
group at DESY (Hamburg, Germany) has demonstrated lasing to saturation at 98 nm [9,10].

In June 2006 saturation has been achieved at 13 nm, the shortest wavelength ever generated
by FELs. The experimental results have been achieved at FLASH (”F”ree-Electron-”LAS”er

in ”H”amburg). Regular user operation of FLASH started in 2005 [11]. Currently FLASH pro-
duces GW-level, laser-like VUV radiation pulses with 10 to 50 fs duration in the wavelength

range 13-45 nm. After the energy upgrade of the FLASH linac to 1 GeV planned in 2007, it will
be possible to generate wavelengths down to 6 nm.

Recently the German government, encouraged by these results, approved funding a hard X-ray
SASE FEL user facility – the European X-Ray Free Electron Laser [4]. The US Department of

Energy (DOE) has given SLAC the goahead for the engineering design of the Linac Coherent
Light Source (LCLS) to be constructed at SLAC [5]. These devices should produce 100 fs X-ray

pulses with over 10 to 100 GW of peak power. The main difference between projects is the linear
accelerator, an existing room temperature linac for LCLS at SLAC, and future superconducting

linac for the European XFEL. The XFEL based on superconducting accelerator technology will
make possible not only a jump in a peak brilliance by ten orders of magnitude, but also increase

by ﬁve orders of magnitude in average brilliance. The LCLS and European XFEL projects are
scheduled to start operation in 2009 and 2013, respectively.

In the X-ray FEL the radiation is produced by the electron beam during single-pass of the un-
dulator [1,2,3]. The ampliﬁcation process starts from the shot noise in the electron beam. Any

random ﬂuctuations in the beam current correspond to a modulation of the beam current at all
frequencies simultaneously. When the electron beam enters the undulator, the presence of the

beam modulation at frequencies close to the resonance frequency initiates the process of radia-
tion. The FEL collective instability in the electron beam produces an exponential growth (along

1

the undulator) of the modulation of the electron density on the scale of undulator radiation
wavelength. The ﬂuctuations of current density in the electron beam are uncorrelated not only

in time but in space, too. Thus, a large number of transverse radiation modes are excited when
the electron beam enters the undulator. These radiation modes have different gain. As undulator

length progresses, the high gain modes start to predominate more and more. For enough long
undulator, the emission will emerge in a high degree of transverse coherence. An intensity gain
107 is obtained in the saturation regime. At this level, the shot noise of the
in excess of 106
electron beam is ampliﬁed up to complete micro-bunching, and all electrons radiate almost in
phase producing powerful, coherent radiation.

−

Understanding of coherence properties of the radiation from SASE FEL is of great practical im-
portance. Properties of the longitudinal coherence have been studied in [12,13,14,15,16,17,18].

It has been found that the coherence time increases ﬁrst, reaches maximum value in the end of
the linear high gain regime and then drops when ampliﬁcation process enters nonlinear stage

[18]. The ﬁrst analysis of the problem of transverse coherence has been performed in [19]. The
problem of start-up from the shot noise has been studied analytically and numerically for the
linear stage of ampliﬁcation. It has been found that the process of formation of transverse coher-

ence is more complicated than that given by naive physical picture of transverse mode selection.
Namely, even after ﬁnishing the transverse mode selection process the degree of transverse co-

herence of the radiation from SASE FEL visibly differs from the unity. This is consequence
of the interdependence of the longitudinal and transverse coherence. The SASE FEL has poor

longitudinal coherence which develops slowly with the undulator length thus preventing a full
transverse coherence. First studies of the evolution of transverse coherence in the nonlinear

regime of SASE FEL operation have been performed in [20]. It has been found that similarly
to the coherence time, the degree of transverse coherence reaches maximum value in the end of
the linear regime. Further increase of the undulator length leads to its decrease. Despite output

power of the SASE FEL grows continuously in the nonlinear regime, maximum brilliance of
the radiation is achieved in the very beginning of the nonlinear regime. Due to a lack of com-

puting power available at that time we limited our study with a speciﬁc numerical example just
illustrating the general features of coherence properties of the radiation produced by the SASE

FEL operating in the nonlinear regime.

In this paper we present general analysis of the coherence properties (longitudinal and trans-
verse) of the radiation from SASE FEL. The results have been obtained with time-dependent,

three-dimensional FEL simulation code FAST [21] performing simulation of the FEL process
with actual number of electrons in the beam. Using similarity techniques we present universal

dependencies for the main characteristics of the SASE FEL covering all practical range of X-ray
FELs.

2

2 Basic relations

Design of the focusing system of XFEL assumes nearly uniform focusing of the electron beam
in the undulator, so we consider axisymmetric model of the electron beam. It is assumed that

transverse distribution function of the electron beam is Gaussian, so rms transverse size of
matched beam is σ = √ǫβ ,where ǫ = ǫn/γ is rms beam emittance and β is focusing beta-
function. An important feature of the parameter space of XFEL is that the space charge ﬁeld
does not inﬂuence signiﬁcantly on the FEL process and calculation of the FEL process can be
performed by taking into account diffraction effects, the energy spread in the electron beam,

and effects of betatron motion only. In the framework of the three-dimensional theory operation
of the FEL ampliﬁer is described by the following parameters: the diffraction parameter B, the
energy spread parameter ˆΛ2

T, and the betatron motion parameter ˆkβ [22,23]:

B = 2Γσ2ω/c ,
ˆkβ = 1/(βΓ) ,
ˆΛ2
T = (σE/

)2/ρ2 ,

E

(1)

s A2

JJ/(IAc2γ2

z γ)]1/2 is the gain parameter and ρ = cγ2

where Γ = [Iω2θ2
z Γ/ω is the efﬁciency
parameter 1 . When describing shot noise in the electron beam, one more parameter appears,
the number of electrons on the coherence length, Nc = I/(eωρ). The following notations are
used here: I is the beam current, ω = 2πc/λ is the frequency of the electromagnetic wave,
θs = Krms/γ, Krms is the rms undulator parameter, γ is relativistic factor, γ−2
z = γ−2 + θ2
s ,
kw = 2π/λw is the undulator wavenumber, IA = 17 kA is the Alfven current, AJJ = 1 for
helical undulator and AJJ = J0(K 2
rms)) for planar undulator.
rms))
Here J0 and J1 are the Bessel functions of the ﬁrst kind. The energy spread is assumed to be
Gaussian with rms deviation σE.

rms/2(1+K 2

rms/2(1+K 2

J1(K 2

−

The ampliﬁcation process in the FEL ampliﬁer passes two stages, linear and nonlinear. The
linear stage lasts over signiﬁcant fraction of the undulator length (about 80%), and the main

target for XFEL optimization is the ﬁeld gain length. In the linear high-gain limit the radiation
emitted by the electron beam in the undulator can be represented as a set of modes:

Ex + iEy =

dω exp[iω(z/c

t)]

Anm(ω, z)Φnm(r, ω) exp[Λnm(ω)z + inφ] .

(2)

Z

−

×

n,m
X

1 Note that it differs from 1-D deﬁnition by the factor B1/3 [22].

3

When ampliﬁcation takes place, the mode conﬁguration in the transverse plane remains un-
changed while the amplitude grows exponentially with the undulator length. Each mode is char-
acterized by the eigenvalue Λnm(ω) and the ﬁeld distribution eigenfunction Φnm(r, ω) in terms
of transverse coordinates. At sufﬁcient undulator length fundamental TEM00 mode begins to
give main contribution to the total radiation power. Thus, relevant value of interest for XFEL
optimization is the ﬁeld gain length of the fundamental mode, Lg = 1/ Re(Λ00), which gives
Lg.
good estimate for expected length of the undulator needed to reach saturation, Lsat ≃
Optimization of the ﬁeld gain length is performed by means of numerical solution of the corre-
sponding eigenvalue equations taking into account all the effects (diffraction, energy spread and

10

×

emittance) [23,24]. Computational possibilities of modern computers allows to trace complete
parameter space of XFEL (which in fact is 11-dimensional). From practical point of view it is

important to ﬁnd an absolute minimum of the gain length corresponding to optimum focusing
beta function. For this practically important case the solution of the eigenvalue equation for

the ﬁeld gain length of the fundamental mode and optimum beta function are rather accurately
approximated by [25]:

Lg = 1.67

βopt ≃

11.2

δ = 131

(cid:18)

(cid:18)
IA
I

IA
I (cid:19)
IA
I (cid:19)

1/2 (ǫnλw)5/6

1/2 ǫ3/2

λ2/3
n λ1/2
w
λKAJJ

(1 + K 2)1/3
KAJJ

(1 + δ) ,

(1 + 8δ)−1/3 ,

ǫ5/4
n
λ1/8λ9/8
w

σ2
γ
(KAJJ )2(1 + K 2)1/8 ,

(3)

(4)

where σγ = σE/mec2. Accuracy of this ﬁt is better than 5% in the range of parameter ˆǫ = 2πǫ/λ
from 1 to 5.

Equation (3) demonstrates clear interdependence of physical parameters deﬁning operation of

the XFEL. Let us consider the case of negligibly small energy spread. Under this condition
diffraction parameter B and parameter of betatron oscillations, ˆkβ are functions of the only
parameter ˆǫ:

B

12.5

≃

×

ˆǫ5/2 ,

ˆkβ = 1/(βΓ)

0.158

ˆǫ3/2 .

≃

×

FEL equations written down in the dimensionless form involve an additional parameter Nc
deﬁning the initial conditions for the start-up from the shot noise. Note that the dependence of

output characteristics of the SASE FEL operating in saturation is slow, in fact logarithmic in
terms of Nc. Thus, we can conclude that with logarithmic accuracy in terms of Nc, character-
istics of the SASE FEL written down in a normalized form are functions of the only parameter
ˆǫ.

4

3 An approach for numerical simulations

Rigorous studies of the nonlinear stage of ampliﬁcation is possible only with numerical simula-

tion code. Typically FEL codes use an artiﬁcial ensemble of macroparticles for simulating the
FEL process when one macroparticle represents large number of real electrons. Thus, a natural

question arises if macroparticle phase space distributions are identical to those of actual electron
beam at all stages of ampliﬁcation. Let us trace typical procedure for preparation of an artiﬁ-
cial ensemble [26,27]. The ﬁrst step of particle loading consists in a quasi-uniform distribution

of the macroparticles in the phase space. At this stage an ensemble of particles with random
distribution is generated which occupies a fraction of the phase space. Then this ensemble is

copied on the other parts of the phase space to provide pseudo-uniform loading of the phase
space. Pseudo-uniformity means that initial microbunching at the fundamental harmonic (or for

several harmonics) is equal to zero. Also, phase positions of the mirrored particles are corre-
lated such that microbunching does not appear due to betatron oscillations, or due to the energy
spread. Finally, artiﬁcial displacements of the macroparticles are applied to provide desired (in

our case gaussian) statistics of microbunching at the undulator entrance. We note that it is not
evident that such an artiﬁcial ensemble reﬂects actual physical situation for a short wavelength

SASE FEL. Let us consider an example of the SASE FEL operating at the radiation wavelength
of 0.1 nm. With the peak current of 5 kA we ﬁnd that the number of electrons per wavelength
is about 104. On the other hand, it is well known that properties of an artiﬁcial ensemble (even
at the ﬁrst step of pseudo-uniform loading) converge very slowly to the model of continuous
104 the
media. In fact, even with the number of macroparticles per radiation wavelength 6.4
FEL gain still visibly deviates from the target value. Introducing of an artiﬁcial noise makes sit-
uation with the quality of an ensemble preparation even more problematic. The only way to test

×

the quality of an artiﬁcial ensemble is to perform numerical simulations with actual number of
electrons in the beam. We constructed such a version of three-dimensional, time-dependent FEL

simulation code FAST [21]. Comparison of the results with direct simulations of the electron
beam and with an artiﬁcial distributions has shown that artiﬁcial ensembles are not adequate to

the problem. Artiﬁcial effects are pronouncing especially when calculating such ﬁne features
as transverse correlation functions. Thus, all the simulations presented in this paper have been

performed with code FAST using actual number of electrons in the beam.

4 General overview of the properties of the radiation form SASE FEL

The result of each simulation run contains an array of complex amplitudes ˜E for electromag-
netic ﬁelds on a three-dimensional mesh. At the next stage of the numerical experiment the data

5

arrays are handled with postprocessor codes to calculate different characteristics of the radia-
tion. However, as the ﬁrst step it is worthwhile to obtain qualitative analysis of the object under

˜E

study. The plots in an upper row of Fig. 1 show evolution of the power density distribution,
2, in a slice of the radiation pulse along the undulator. We see that due to the start-up
I =
of ampliﬁcation process from the shot noise many transverse radiation modes are excited when
electron beam enters the undulator. Mode selection process (2) serves as a ﬁlter for selection of

|

|

the fundamental radiation mode having maximum gain.

Integration of the power density over transverse cross section of the photon beam gives us
I d ~r⊥. Evolution of temporal structure of the radia-
instantaneous radiation power, P
tion power along the undulator is traced in Fig. 1 in terms of normalized radiation power
ˆη = P/(ρPb) where Pb = γmc2I/e is the electron beam power. Averaging of the radiation
power along the pulse gives us averaged radiation power. Evolution of normalized averaged
power
along normalized undulator length ˆz = Γz is shown in Fig. 2. Note that the radiation
produced by SASE FEL operating in the linear regime holds properties of completely chaotic

ˆη
i

∝

h

R

polarized light [18] – a statistical object well described in the framework of statistical optics
[28]. This is simple consequence of the fact that the shot noise in the electron beam is a Gaus-

sian random process. The FEL ampliﬁer, operating in the linear regime, can be considered as a
linear ﬁlter which does not change the statistics of the signal. As a result, we can deﬁne general

statistical properties of the output radiation without any calculations. For instance, in the case
of the SASE FEL the real and imaginary parts of the slowly varying complex amplitudes of the
electric ﬁeld of the electromagnetic wave, ˜E , have a Gaussian distribution, the instantaneous

6x10-5

<
η

 

 

 

2πε/λ = 2

6x10-4

2πε/λ = 2

2x10-2

2πε/λ = 2

 

η
<

 

η
<

 

0
100

300
^
s

0
100

300
^
s

0
100

300
^
s

200

400

500

200

400

500

200

400

500

Fig. 1. Evolution of the power density distribution in a slice (top) and normalized power in a radiation
t) for the reduced lengths ˆz = 18.4, 31.6, and 44.8 (left, middle,
pulse (bottom) versus ˆs = ρω0(z/¯vz −
and right plots, respectively). Here ˆǫ = 2. Crosses show geometrical center of the radiation beam.

6

 

 

0.8

0.6

0.2

0.0

20

8

6

4

2

2πε/λ = 2

 

2πε/λ = 2

 

P

σ

0.4

0.15

0.10

η

^

0.05

1.0

0.8

0.4

0.2

2

P

0.6

^

σ
 
,
 
δ
 
,
 
ζ

0.00

20

40

80

100

60
Γz

40

80

100

Fig. 2. Averaged normalized efﬁciency, ˆη, and normalized rms deviation of instantaneous radiation
power, σP along the normalized undulator length, ˆz = Γz. Here ˆǫ = 2.

60
Γz

 

2πε/λ = 2

2πε/λ = 2

c

τ
^

 

0.0

20

40

80

100

60
Γz

0
20

40

80

100

60
Γz

Fig. 3. Right plot: normalized coherence time ˆτc, along the normalized undulator length, ˆz = Γz.
Left plot: degree of transverse coherence, ζ (solid line), and normalized degeneracy parameter of the
radiation, ˆδ (dashed line), along the normalized undulator length, Γz. Dotted line shows σ2
P (see Fig. 2).
Here ˆǫ = 2.

2, ﬂuctuates in accordance with the negative exponential distribution

power density, I =
(see Fig. 4):

˜E

|

|

p(I) =

exp

1
I

h

i

I
I

.

 −

!

h

i

Due to the start-up of ampliﬁcation process from the shot noise many transverse radiation modes
are excited when electron beam enters the undulator. For gaussian random process any integral
of the power density, for example, radiation power P , ﬂuctuates in accordance with the gamma
distribution:

p(P ) =

M M
Γ(M)  

P
P

h

!

i

M −1 1
P

h

i

exp

M

 −

P
P

h

!

i

,

7

 

 

(5)

(6)

 

 

 

 

 

1.2

1.0

0.8

0.6

0.4

0.2

0.0

)
I
(
p

1.0

)

P

(
p

0.5

1.2

1.0

0.8

0.6

0.4

0.2

0.0

)
I
(
p

1.0

)

P

(
p

0.5

0

1

2

3

4

5

0

1

2

3

4

5

0

1

2

3

4

5

I/<I>

I/<I>

I/<I>

2πε/λ = 2
Γz = 32
M = 3.7

2πε/λ = 2
Γz = 63

2πε/λ = 2
Γz = 105
M = 1.8

 

 

 

 

 

1.2

1.0

0.8

0.6

0.4

0.2

0.0

)
I
(
p

1.0

)

P

(
p

0.5

0.0

0

1

2
P/<P>

3

4

0.0

0

1

2
P/<P>

3

4

0.0

0

1

2
P/<P>

3

4

2 (top), and of the
Fig. 4. Probability density distributions of the instantaneous power density I =
|
instantaneous radiation power P (bottom) from SASE FEL for different stages of ampliﬁcation: linear
regime (ˆz = 32), saturation regime (ˆz = 63), and deep nonlinear regime (ˆz = 105). Solid lines on
the power density histograms (top) represent negative exponential distribution (5). Solid lines on power
histograms (bottom) represent gamma distribution (6) with M = 1/σ2

P (see Fig. 2). Here ˆǫ = 2.

˜E
|

where Γ(M) is the gamma function with argument M, and

(7)

(8)

M =

1
σ2
P

,

ζ =

= σ2

P .

1
M

P

)2

(P

P =

and σ2
2 is the relative dispersion of the radiation power. Note that for
completely chaotic polarized light parameter M has clear physical interpretation, it is the num-
ber of modes [22]. Thus, it becomes clear that the relative dispersion of the radiation power

− h

P

/

i

i

h

i

h

directly relates to the coherence properties of the SASE FEL operating in the linear regime. The
degree of transverse coherence in this case can be naturally deﬁned as:

Indeed, in the linear regime we deal with a Gaussian random process, and the power density
ﬂuctuates in accordance with the negative exponential distribution and its relative width is equal

to 1. If there is full transverse coherence then the same refers to the power. If the radiation is
partially coherent, then we have a more general law for power ﬂuctuations, namely the gamma
distribution (6). In the linear regime ﬂuctuations of the radiation power, σP, grow steadily with
the undulator length (see Fig. 2) because of mode selection process (2).

Another physical parameter of the problem relating to the transverse coherence is diffraction pa-
rameter B. Mechanism of formation of transverse coherence is rather transparent. If diffraction

 

 

8

expansion of the radiation on a scale of the ﬁeld gain length is comparable with the transverse
size of the electron beam, we can expect a high degree of transverse coherence. For this range

of parameters the value of the diffraction parameter is small. If diffraction expansion of the
radiation is small (which happens at large values of the diffraction parameter) then we can ex-

pect signiﬁcant degradation of the degree of transverse coherence. This happens simply because
different parts of the beam produce radiation nearly independently. In terms of the radiation ex-

pansion in the eigenmodes (2) this range of parameters corresponds to degeneration of modes
(see Appendix A). Diffraction parameter for optimized XFEL exhibits strong dependence on the
parameter ˆǫ (see eq. (4) and Fig. 5), and we can expect that the degree of transverse coherence
should drop rapidly with the increase of the parameter ˆǫ.

An important physical quantity describing random ﬁelds is the coherence time. Figure 1 gives
qualitative picture of formation of longitudinal coherence in SASE FEL. At the beginning of

the undulator the radiation is simply incoherent undulator radiation. When ampliﬁcation process
starts to dominate over spontaneous emission, we obtain formation of spikes (wavepackets). The

width of the spikes deﬁnes the coherence time. In the high gain linear regime the width of spikes
grows with the undulator length, and the coherence time also grows proportionally to the square
root of the undulator length. It achieves maximum value in the end of linear regime and then

decreases rapidly in the nonlinear regime (see Fig. 3). The maximum value of the coherence
time depends on the saturation length and, therefore, on the value of the parameter Nc [18].

We see that physical background deﬁning general features of the radiation from SASE FEL

operating in the linear regime is rather transparent. Despite the behavior of the SASE FEL in
the nonlinear regime is rather complicated (see Figs. 2 and 3), we will show below that the main

characteristics of the SASE FEL operating at the saturation point have rather simple physical
scaling.

 

600

400

200

B

 
,
r
e
t
e
m
a
r
a
p
 
n
o
i
t
c
a
r
f
f
i

D

0

0

1

3

2
2πε/λ

4

5

 

9

Fig. 5. Diffraction parameter B versus parameter ˆǫ for optimized XFEL.

5 General deﬁnitions

5.1 Degree of transverse coherence

The transverse coherence properties of the radiation are described in terms of the transverse

correlation functions. The ﬁrst-order transverse correlation function is deﬁned as

γ1(~r⊥, ~r

⊥, z, t) =
′

˜E(~r⊥, z, t) ˜E∗(~r
˜E(~r

˜E(~r⊥, z, t)

h

2

|

ih|

⊥, z, t)
′
⊥, z, t)
′

i
2

|

i

i

1/2 ,

h|

h

where ˜E is the slowly varying amplitude of the ampliﬁed wave:

E = ˜E(~r⊥, z, t)ei ω0(z/c−t) + C.C. .

(9)

(10)

In the following we consider the model of a stationary random process, thus assuming that γ1
does not depend on time. We deﬁne the degree of transverse coherence as:

ζ =

|

R

γ1(~r⊥, ~r

⊥)
′
[

2I(~r⊥)I(~r
⊥) d ~r⊥ d ~r
|
′
I(~r⊥) d ~r⊥]2

⊥
′

.

R

When SASE FEL operates in the linear regime such a deﬁnition for the degree of transverse

coherence is mathematically equivalent to (8) expressed in terms of the relative dispersion of the
instantaneous radiation power, σ2
P. Analysis of the asymptotic of the deep nonlinear regime (see
Fig. 3) shows that surprisingly the degree of transverse coherence deﬁned by (10) again tends
to be an agreement with (8). This feature has deep physical background. When ampliﬁcation

process just enters nonlinear stage, the statistics of the radiation is not Gaussian anymore. In
particular, the probability distribution function of the radiation power density, is not negative

exponential distribution (see Fig. 4). Thus, deﬁnition of the degree of transverse coherence (8)
has no physical sense near the saturation point. However, simulations show that in the deep
nonlinear regime the probability distribution of the radiation power density again tends to the

negative exponential distribution. This gives us a hint that the properties of the radiation from
SASE FEL operating in the deep nonlinear regime tend again to be the properties of completely

chaotic polarized light. Similar asymptotical behavior has been observed in the framework of
the one-dimensional model as well [18].

10

5.2 Coherence time

Longitudinal coherence is described in terms of time correlation functions. The ﬁrst order time
correlation function, g1(t, t′), is calculated in accordance with the deﬁnition:

For a stationary random process time correlation functions are functions of the only argument,

τ = t

t′. The coherence time is deﬁned as [22]:

g1(~r, t

−

t′) =

˜E(~r, t) ˜E∗(~r, t′)
i
˜E(~r, t′)

h
˜E(~r, t)

2

|

ih|

1/2 ,

2

|

i

i

h|
h

−

∞

τc =

g1(τ )

2 d τ .

|

Z−∞ |

5.3 Brilliance and degeneracy parameter

Main ﬁgure of merit of the SASE FEL performance is brilliance, i.e. density of photons in the
phase space. In fact, the brilliance is proportional to the degeneracy parameter δ, i.e. the number
of photons per mode (coherent state). Note that when δ
1, the classical statistics is applicable,
while quantum description of the ﬁeld is necessary as soon as δ is comparable to (or less than)
one. Using the deﬁnitions of the degree of transverse coherence (10) and coherence time (12),

≫

one can deﬁne degeneracy parameter:

δ = ˙Nphτcζ ,

ph /T is the photon ﬂux, N tot

where ˙Nph = N tot
ph is the total number of photons in a long ﬂat-
top pulse of duration T (as everywhere in this paper we consider ensemble average values).
The deﬁnition (13) is perfect for a Gaussian random process (that we have in linear regime).
Indeed, degree of transverse coherence is an inverse number of transverse modes (8), while
τc/T is an inverse number of longitudinal modes within the pulse [22,28]. Thus, degeneracy
parameter is equal to the number of photons per pulse divided by total number of modes per

pulse (that is equal to the squared inverse rms ﬂuctuations of pulse energy [22]). It can be
directly measured in an experiment for SASE FEL operating in the linear regime. We use (13)

as a natural generalization to characterize SASE FEL properties at saturation.

Let us introduce a notion of normalized degeneracy parameter

ˆδ = ˆηˆτcζ .

11

(11)

(12)

(13)

(14)

Here normalized FEL efﬁciency is deﬁned as ˆη = P/(ρPb) where P is radiation power, and
Pb = γmc2I/e is electron beam power. Normalized coherence time is deﬁned as ˆτc = ρωτc.
Parameter ˆδ and the degeneracy parameter δ are simply related as:

δ =

Pb
¯hω2

ˆδ ,

or, in practical units

δ

2.7

≃

×

107

λ2[ ˚A ]

I[kA]

E[GeV]

×

×

×

ˆδ ,

×

where E = γmc2 is the electron energy. Note that the degeneracy parameter is very large even
for a SASE FEL operating at the wavelength of 0.1 nm. With multi-kA electron beams and other
relevant parameters, mentioned in Table 1, degeneracy parameter would be of the order of 108
- 109. Thus, a classical treatment of SASE FEL is justiﬁed.

Let us now turn to the calculation of peak brilliance. It is deﬁned as a transversely coherent
spectral ﬂux:

The spectrum of SASE FEL radiation in a high-gain linear regime has a Gaussian shape, it is
also close to the Gaussian at saturation point [22]. In this case

where σω is the rms bandwidth. For a Gaussian line, with the deﬁnition of coherence time (12),
one gets [22]:

Br =

ω d ˙Nph
d ω

2 .

ζ

λ
2

(cid:16)

(cid:17)

ω d ˙Nph
d ω

=

ω ˙Nph
√2πσω

,

τc =

√π
σω

.

Br =

4√2c
λ3

δ .

Thus, it follows from (14) and (17) that

(15)

(16)

(17)

(18)

The peak brilliance can then be calculated as follows

Br[phot./(sec. mrad2 mm2 0.1% bandw.)]

4.5

1031

≃

×

×

×
λ[ ˚A ]

I[kA]

E[GeV]

ˆδ .

(19)

×

12

For future SASE FELs, operating at 1 ˚A , an expected value of the peak brilliance is 1032-1033.

An important feature of our analysis is application of similarity techniques to the analysis of

simulation results which allows to derive universal parametric dependencies of the output char-
acteristics of the radiation. As we mentioned above, within accepted approximations (optimized

SASE FEL and negligibly small energy spread in the electron beam), output characteristics of
SASE FEL are universal functions of two parameters, normalized undulator length ˆz = Γz and
parameter ˆǫ. If one traces evolution of the brilliance (or, degeneracy parameter) of the radiation
along the undulator length there is always the point, which we deﬁne as the saturation point,
where the brilliance reaches maximum value (see Fig. 3). In the following we present character-

istics of the radiation at the saturation point which are universal functions of the only parameter
ˆǫ.

6 Properties of the radiation from optimized XFEL operating in the saturation regime

Simulations of the FEL process have been performed for the case of a long bunch with uniform
axial proﬁle of the beam current. Such a model provides rather accurate predictions for the

coherence properties of the XFEL, since typical radiation pulse from the XFEL is much longer
than the coherence time. Calculations has been performed with FEL simulation code FAST
105 corresponds
using actual number of electrons in the beam. The value of parameter Nc = 8
to the parameter range of XFEL operating at the radiation wavelength about 0.1 nm.

×

0.8

0.6

η

<

0.4

0.2

0.0

100

 

 

 

2πε/λ = 1

2πε/λ = 2

2πε/λ = 4.5

0.3

0.2

0.1

0.08

0.06

0.02

 

η

<

 

<
η

0.04

 

200

400

500

300
^
s

300
^
s

0.0

100

200

400

500

0.00

100

200

300
^
s

400

500

t). Bottom: typical power
Fig. 6. Top: normalized power in a radiation pulse, ˆη versus ˆs = ρω(z/¯vz −
density distribution in a slice of the radiation. SASE FEL operates in the saturation. Values of ˆǫ = 1, 2
and 4.5 correspond to the left, middle, and right plot, respectively. Crosses show geometrical center of
the beam.

13

 

 

 

150

100

50

t
a
s

z
Γ
 
 
,
h
t
g
n
e
l
 
n
o
i
t
a
r
u
t
a
S

15

10

5

t
a
s

c

^

τ
 
 
,
e
m

i
t
 
e
c
n
e
r
e
h
o
C

0.6

0.4

0.2

t
a
s

η
^
 
 
,
y
c
n
e
c
i
f
f

i

e

 

n
o

i
t

a
r
u

t

a
S

 

0

0

1

3

2
2πε/λ

4

5

Fig. 7. Saturation length ˆzsat = Γzsat versus parameter ˆǫ.

 

 

 

 

0

0

1

3

2
2πε/λ

4

5

0.0

0

1

3

2
2πε/λ

4

5

Fig. 8. Degree of transverse coherence, ζsat, and normalized coherence time, ˆτ sat
parameter ˆǫ.

c

in the saturation versus

 

 

0.0

0

1

3

2
2πε/λ

4

5

0.0

0

1

3

2
2πε/λ

4

5

Fig. 9. Averaged efﬁciency,
parameter ˆǫ.

ˆηsati
h

, and normalized degeneracy parameter, ˆδsat, in the saturation versus

Figure 6 gives visual picture of the slice properties of the radiation at the saturation for different
values of the parameter ˆǫ. Saturation point is deﬁned as the point where the radiation achieves
maximum brilliance (or, maximum degeneracy parameter (14)). A series of simulation runs

t

a
s

1.0

0.8

0.6

0.4

0.2

ζ
 
 
,
e
c
n
e
r
e
h
o
c
 
.
s
n
a
r
t
 
f
o
 
e
e
r
g
e
D

1.0

0.8

0.6

0.4

0.2

t

a
s

^

δ
 
 
,
r
e

t
e
m
a
r
a
p

 
y
c
a
r
e
n
e
g
e
D

14

 

 

1.0

0.8

0.6

0.4

0.2

t
o
t
P

 
/
 

m
n
P
m

Σ

0.0

0

1

3

2
2πε/λ

4

5

Fig. 10. Partial contributions of the modes with azimuthal index m = 0 . . . 4 into the total power versus
parameter ˆǫ. SASE FEL operates in the saturation.

has been performed in the range of the parameter ˆǫ = 0.25 . . . 4.5. Application of similarity
techniques described above allowed us to extract universal parametric dependencies of the main
characteristics of the optimized XFEL operating in the saturation regime (see Figs. 7-9).

Figure 7 shows the dependence of the saturation length ˆzsat = Γzsat on parameter ˆǫ. Analysis of
ˆǫ5/6. Such dependence directly fol-
the curve shows that the saturation length scales as ˆzsat ∝
lows from the optimization procedure of the gain length given by (3). The normalized coherence
time in the saturation regime, ˆτ sat

is also proportional to ˆǫ5/6 (see Fig. 8).

c

The dependence of the degree of transverse coherence in the saturation regime on the parameter
ˆǫ exhibits rather complicated behavior (see Fig. 8). It reaches maximum value in the range of ˆǫ
values about of unity, and drops at small and large values of ˆǫ. Actually, the degree of transverse
coherence is formed due to two effects. The ﬁrst effect takes place due to interdependence of the

poor longitudinal coherence and transverse coherence [19]. Due to the start-up from shot noise
every radiation mode entering (2) is excited within ﬁnite spectral bandwidth. This means that

in the high gain linear regime the radiation of the SASE FEL is formed by many fundamental
TEM00 modes with different frequencies. The transverse distribution of the radiation ﬁeld of the
mode is also different for different frequencies. Smaller value of the diffraction parameter (i.e.
smaller value of ˆǫ) corresponds to larger deviation of the radiation mode from the plane wave.
This explains a decrease of the transverse coherence at small values of ˆǫ. When the parameter
ˆǫ increases, the diffraction parameter increases as well thus leading to the degeneration of the
radiation modes. Ampliﬁcation process in the SASE FEL passes limited number of the ﬁeld
gain lengths, and starting from some value of ˆǫ the linear stage of ampliﬁcation becomes too
short to provide mode selection process (2). When ampliﬁcation process enters nonlinear stage,

the mode content of the radiation becomes even more rich due to independent growth of the
radiation modes in the nonlinear medium (see Fig. 10). Thus, at large values of ˆǫ the degree

15

Table 1
Parameter space of XFEL projects

Radiation wavelength, nm

Beam energy, GeV

rms normalized emittance ǫn, mm-mrad

Parameter ˆǫ

European XFEL

LCLS SCSS

SASE1 SASE2

0.1

17.5

1.4

2.6

0.15

17.5

1.4

1.7

0.15

0.1

14.35

6.135

1.2

1.8

0.85

4.5

Degree of transverse coherence ζ

0.65

0.85

0.83

0.24

of transverse coherence is limited by poor mode selection. Analytical estimations, presented in
Appendix A, show that in the limit of large emittance, ˆǫ
1, the degree of transverse coherence
scales as 1/ˆǫ2.

≫

We present in Fig. 9 the plots for normalized efﬁciency and degeneracy parameter for optimized
XFEL. Normalized efﬁciency in saturation has simple scaling, it falls inversely proportional to
the parameter ˆǫ. Taking into account that the value of the coherence time ˆτ sat
scales proportional
to ˆǫ5/6, we ﬁnd that the normalized degeneracy parameter of the radiation is nearly proportional
to the degree of transverse coherence, ˆδsat ∝
ζ/ˆǫ1/6.
Finally, in Table 1 we present comparison of existing XFEL projects, the European XFEL,
LCLS and SCSS in terms of degree of transverse coherence [4,5,6]. We see that the European
XFEL and LCLS are in the same range of parameter space. These projects assume conserva-

c

tive value of the emittance, and relatively high degree of transverse coherence is achieved by
increasing the energy of the driving accelerator. Project SCSS assumes much smaller energy of

the driving accelerator. Thus, despite much smaller value of the normalized emittance it falls in
the range of parameters for the output radiation with poor transverse coherence.

16

A Solution of the eigenvalue equation and estimates of transverse coherence in the limit

of wide electron beam

A.1 Basic equation

Let us have at the undulator entrance a continuous electron beam with the current I0, with the
Gaussian distribution in energy

F (

E − E0) =

2π

(∆

)2

h

E

(cid:16)

−1/2

i

(cid:17)

exp

 −

E − E0)2
(
)2
(∆
2
i
E
h

,

!

and in a transverse phase plane

f (x, x′) = (2πσ2kβ)−1 exp

x2 + (x′)2/k2
β
2σ2

,

#

"−

the same in y phase plane. Here kβ = 1/β is the wavenumber of betatron oscillations and
σ = √ǫβ.

The results of this paper can be used in the case of superposition of the natural undulator focus-

ing and an alternating-gradient external focusing if the following condition is satisﬁed [23]:

Lf
2πβ ≪

min

1,

 

λ
2πǫ !

,

where Lf is a period of the external focusing structure, β is an average beta-function, ǫ is rms
emittance of an electron beam, and λ is a radiation wavelength. This condition is met in many
practical situations.

Using cylindrical coordinates, in the high-gain limit we seek the solution for a slowly varying

complex amplitude of the electric ﬁeld of the electromagnetic wave in the form [22]:

˜E(z, r, ϕ) = Φnm(r) exp(Λz) 



sin(nϕ)

cos(nϕ)

,






0. For each n there are many radial eigenmodes that differ by
where n is an integer, n
eigenvalue Λ and eigenfunction Φnm(r). The integro-differential equation for radiation ﬁeld
eigenmodes [24,31,32] taking into account the space charge effect [23] can be written in the
following normalized form:

≥

17

(A.1)

(A.2)

(A.3)

Φnm(ˆr) =

∞

4
−

Z0

d ˆr′ˆr′

Φnm(ˆr′)

{

"

+

d2
d ˆr2 +
ˆΛ2
p
2 "
∞

d ζ

×

Z0

1
ˆr

d
d ˆr −

1
ˆr′

d2
d ˆr′2 +
ζ
sin2(ˆkβζ)

#

d
d ˆr′ −

n2
ˆr2 + 2 i B ˆΛ
n2
ˆr′2 + 2 i B ˆΛ
ˆΛ2
Tζ 2
2 −
βζ/2)(ˆr2 + ˆr′2)

exp

"−

i Bˆk2

(1

−



−


2(1

sin2(ˆkβζ)
βζ/2)ˆrˆr′ cos(ˆkβζ)
sin2(ˆkβζ)

i Bˆk2

−

exp

×

×

In 










,

Φn(ˆr′)

#


(ˆΛ + i ˆC)ζ




#

(A.4)

JJI0ω2θ2

s (IAc2γ2

where In is the modiﬁed Bessel function of the ﬁrst kind. The following notations are used
here: ˆr = r/(σ√2), B = 2σ2Γω/c is the diffraction parameter, ˆkβ = kβ/Γ is the betatron
p = 2c2(AJJθsσω)−2 is the space charge parameter, ˆΛ2
motion parameter, ˆΛ2
2)
T =
is the energy spread parameter, ˆC = [kw −
z )] /Γ is the detuning parameter, Γ =
A2
z Γ/ω is the efﬁciency parameter, ω is
h
the frequency of the electromagnetic wave, θs = Krms/γ, Krms is the rms undulator parameter, γ
z = γ−2 + θ2
is relativistic factor, γ−2
s , kw is the undulator wavenumber, IA = 17 kA is the Alfven
current, AJJ = 1 for helical undulator and AJJ = J0(K 2
rms))
for planar undulator. Here J0 and J1 are the Bessel functions of the ﬁrst kind. The space charge
effect is included into (A.4) under the condition σ2

is the gain parameter, ρ = cγ2

rms/2(1+K 2

rms/2(1+K 2

ω/(2cγ2

J1(K 2

rms))

c2γ2

/(ρ2

z γ)

(∆

)2

−

−1

1/2

E

E

h

i

i

z /ω2.

≫

As suggested in [24] we apply to (A.4) the Hankel transformation deﬁned by the following

A.2 Exact solution

transform pair:

∞

Z0

¯Φnm(p) =

d ˆrˆrJn(pˆr)Φnm(ˆr) ,

Φnm(ˆr) =

d ppJn(pˆr) ¯Φnm(p) .

∞

Z0

Then we obtain the integral equation for the Hankel transform ¯Φnm(p) [23]:

¯Φnm(p) =

1
2 i B ˆΛ
−
∞

∞

p2

Z0

−

ζ
i Bˆk2

d p′p′ ¯Φnm(p′)

1 +



p(2 i B ˆΛ
ˆΛ2
2

−

p′2)






ˆΛ2
Tζ 2
2 −

(ˆΛ + i ˆC)ζ

#

d ζ

×

Z0

(1

−

exp

"−

βζ/2)2

18

exp

×



−

4(1



p2 + p′2
i Bˆk2

−

βζ/2)


In 


pp′ cos(ˆkβζ)
i Bˆk2

2(1

−

βζ/2) 


.

(A.5)

When the space charge ﬁeld is negligible, ˆΛ2
[24].

p →

0, this equation is reduced to that derived in

To solve (A.5) we discretize it:

pi = ∆(i

) ,

i = 1, 2, ..., K ,

p′
j = ∆(j

) ,

j = 1, 2, ..., K ,

1
2

1
2

−

−

where ∆ and K should be chosen such that the required accuracy is provided. Then we obtain
a matrix equation

¯Φnm(i) = Mn(i, j) ¯Φnm(j) ,

or, [Mn −
well as on the problem parameters: B, ˆkβ, ˆΛ2
for a given azimuthal index n can be found by solving the equation
calculation of the eigenmodes is straightforward.

I] ¯Φnm = 0, where I is a unit matrix. Matrix Mn depends on an eigenvalue ˆΛ as
p, and ˆC. The eigenvalues of all radial modes
= 0. Then the
Mn −

T, ˆΛ2

I

|

|

This algorithm allows one to ﬁnd with any desirable accuracy the eigenvalues and eigenfunc-
tions of a high-gain FEL including all the important effects: diffraction, betatron motion, energy

spread, space charge, and frequency detuning. Therefore, it can be considered as a universal tool
for calculation and optimization of high-gain FELs of wavelength range from infrared to X-ray.

A.3 Parallel cold beam, large diffraction parameter

A parallel beam limit is the case when there is no betatron motion, i.e. ˆkβ →
0. Let us also
assume here for the sake of compactness that the effects of energy spread and space charge can
be neglected (ˆΛ2

0). Equation (A.4) can then be reduced to

0, ˆΛ2

T →
d
d ˆr −

p →
n2
ˆr2 + 2 i B ˆΛ

#

d2
d ˆr2 +

1
ˆr

"

Φnm(ˆr) =

ˆr2)
2 exp(
(ˆΛ + i ˆC)2

−

−

Φnm(ˆr) .

(A.6)

To ﬁnd explicit solutions of the eigenvalue equation in the limit of large diffraction parameter
(more speciﬁcally, we require B1/3
1), we use the variational method [24,29]. We construct
a variational functional from (A.6):

≫

19

∞

Z0

d ˆrˆrΦnm(ˆr)

d2
d ˆr2 +

1
ˆr

"

d
d ˆr −
∞

#

n2
ˆr2 + 2 i B ˆΛ
ˆr2)
2 exp(
−
(ˆΛ + i ˆC)2

Φnm(ˆr)

Φ2

nm(ˆr) ,

d ˆrˆr

=

−

Z0

and seek for a solution in the form

Φnm(ˆr) = ˆrn exp(

aˆr2)Ln

m(2aˆr2) ,

−

where Ln

m are associated Laguerre polynomials

Ln

m(x) =

1
m!

m

Xk=0

m!
k! (cid:18)

n + m
m

k (cid:19)

−

x)k ,

(

−

and

n
k (cid:19)

(cid:18)

=

n!

−

k!(n

k)!

is a binomial coefﬁcient.

Equation (A.7) and the variational condition, δ ˆΛ/δa = 0, lead to the following two equations
for two unknown quantities, ˆΛ and a:

1 + n + 2m

i B ˆΛ

−

a −

1
a(ˆΛ + i ˆC)2

1
(cid:18)

−

1 + n + 2m
2a

(cid:19)

= 0 ,

i B ˆΛ +

1
(ˆΛ + i ˆC)2

1
(cid:18)

−

1 + n + 2m
a

(cid:19)

= 0 .

Solving Eqs. (A.10), (A.11) in zero order, we get 1-D asymptote for the eigenvalue equation
[22]. The eigenvalue for a growing solution reaches maximum at ˆC = 0:

ˆΛ0 ≃

√3 + i
2B1/3

Then we can ﬁnd ﬁrst order correction (in B−1/3) to the growth rate Re ˆΛ, and a mode parameter
a:

Re ˆΛnm ≃

√3
2B1/3  

1

−

√2(1 + n + 2m)
3√3B1/3

!

,

20

(A.7)

(A.8)

(A.9)

(A.10)

(A.11)

(A.12)

(√3

i)B1/3

a

≃

−
2√2

.

(A.13)

Equations (A.8), (A.12), and (A.13) are the solutions for ﬁeld distributions and growth rates of
eigenmodes of a high-gain FEL with a cold parallel beam in the limit B1/3
1. Note that in
[22,30] the exact solution of the eigenvalue problem for a parabolic beam density distribution
was obtained. The eigenfunctions were expressed in terms of the conﬂuent hypergeometric

≫

function. In this case, in the limit of a large diffraction parameter the growth rates of eigenmodes
are reduced to (A.12). The conﬂuent hypergeometric function takes the form of the associated
Laguerre polynomials, so that ﬁeld distribution is reduced to (A.8) with the parameter a given
in (A.13). This is not a surprise because in this limit the width of the ﬁeld distribution is much
smaller than the width of the electron beam (Re a
1), and the electron density
function behavior is important only near the axis. This behavior is the same (quadratic) for
parabolic and Gaussian distributions. We can also conclude that this asymptotical solution is

B1/3

≫

≃

valid for any axisymmetric density distribution with the maximum density on axis. We also
see that the variational solution is a good asymptotical method. The attempts to generalize it to
the entire (or, at least wider) parameter range [24,29,33] lead to the loss of accuracy control,

although can give a practically useful ﬁt of the exact solution within some range.

A.4 Large emittance

Let us still assume that the space charge effect can be neglected (ˆΛ2
0). Applying now the
variational method to the Eq. (A.4) with the trial functions (A.8), we obtain for large diffraction

p →

parameter:

1 + n + 2m

i B ˆΛ

−

a −

∞

1
a

Z0

d ζ

1

(1 + n + 2m)
2

−



1



−

ˆΛ2

Tζ 2
2 −

(ˆΛ + i ˆC)ζ

#

ζ
i Bˆk2
−
aˆk2
βζ 2
i Bˆk2

βζ/2

exp

βζ/2

"−
i Bˆk2
a

−

βζ/2

1

+









= 0 ,

(A.14)

1
× 


∞

Z0

× 


i B ˆΛ +

d ζ

ζ
i Bˆk2

βζ/2

exp

1

−

(1 + n + 2m)(1
a

−

1

−

ˆΛ2

Tζ 2
2 −

"−
i Bˆk2

βζ/2)

(ˆΛ + i ˆC)ζ

#

= 0 .





(A.15)

The system of equations (A.14) and (A.15) can be solved numerically. In the following we ne-

21

T →

glect the effect of the energy spread, ˆΛ2
0. We also assume that beta-function is optimized
for the highest FEL gain as it happens in practice. Since diffraction parameter depends on beta-
function, it is more convenient go over to other normalized parameters. Indeed, diffraction pa-
rameter can be rewritten as B = 2ˆǫ/ˆkβ, where ˆǫ = 2πǫ/λ. Then we can go from parameters
(B, ˆkβ) to (ˆǫ, ˆkβ). After optimizing parameters ˆkβ and ˆC, we will ﬁnd growth rates and eigen-
functions of all eigenmodes depending on the only parameter, ˆǫ. Equations (A.14) and (A.15)
can now be written as (ˆǫ

1):

≫

1 + n + 2m

2 i ˆǫˆΛ
aˆkβ −

1
a

−

∞

Z0

d ζ

(1 + n + 2m)
2

−

1
× 


exp

(ˆΛ + i ˆC)ζ)

i

ζ
i ˆǫˆkβζ

−
h
i ˆǫˆkβζ
a

1

+

−

= 0 ,









1
aˆk2

−
βζ 2
i ˆǫˆkβζ



1



−

2 i ˆǫˆΛ
ˆkβ

+

d ζ

∞

Z0

ζ
i ˆǫˆkβζ

1

−

exp

(ˆΛ + i ˆC)ζ

−
h

1
 

−

i

(1 + n + 2m)(1

i ˆǫˆkβζ)

−

a

!

= 0 .

(A.17)

In zero order we ﬁnd [24]:

ˆΛ0 =

i ˆkβ
2ˆǫ

∞

Z0

d ζ

ζ
i ˆǫˆkβζ

1

−

exp

(ˆΛ0 + i ˆC)ζ

.

−
h

i

Solving this equation numerically, we ﬁnd that maximal growth rate

Re ˆΛ0 ≃

0.37
ˆǫ

is achieved at the optimal values of ˆkβ ≃
0.5/ˆǫ2 and ˆC
function the diffraction parameter can be expressed as B

0.4/ˆǫ. Note that for optimal beta-
4ˆǫ3.

≃

≃

Solving Eqs. (A.16) and (A.17) in the ﬁrst order in ˆǫ−1, we obtain:

Re ˆΛnm ≃

0.37

1

ˆǫ  

−

0.83(1 + n + 2m)
ˆǫ

,

!

a

(0.44

0.51 i)ˆǫ .

≃

−

Equations (A.8), (A.19), and (A.20) are the solutions for the ﬁeld distributions and growth rates
of eigenmodes of a high-gain FEL with optimized beta-function in the limit of ˆǫ

1.

≫

22

(A.16)

(A.18)

(A.19)

(A.20)

A.5 Estimates of transverse coherence

We can now make a simple estimate of the number of transverse modes, M, in the high-gain
linear regime of a SASE FEL operation. The degree of transverse coherence would then be the
inverse number of modes (see (8)):

ζ =

= σ2

P ,

1
M

P

(P

P =

where σ2
2 is the relative dispersion of the radiation power. The ﬁeld of
the electromagnetic wave can be represented as a set of modes, see (2). In the limit, considered
here (B1/3

1), the modes are orthogonal, and the total power can be written as 2

1 or ˆǫ

− h

)2

P

/

i

h

i

i

h

≫

≫

≃

n,m
X

∞

∞

Xn=0

Xm=0

Ptot(ˆz)

Pnm(ˆz) = 2

Anm exp(2 Re ˆΛnmˆz)

A00 exp(2 Re ˆΛ00ˆz) .

(A.22)

−

= 0 there are two orthogonal
Summation over azimuthal index n is done twice here since for n
modes that degenerate [22]. One can also show that (here we assume it without a proof) the
factors Anm are the same for all modes in the considered asymptote 3 . Since the power of each
mode ﬂuctuates in accordance with the negative exponential distribution (5), the dispersion is
equal to the squared average power for each mode. The total dispersion is simply the sum of
dispersions because the modes are independently excited. Thus, the inverse relative dispersion
(or, number of modes) can be calculated as (

nm, or explicitly:

Pnm)2/

P 2

M

≃

2
(cid:18)

2

∞

∞

n=0
∞
P

m=0
∞
P

n=0
P

m=0
P

exp[

2Ngb(n + 2m)]

exp[

4Ngb(n + 2m)]

−

−

2

P

P

−

−

1

(cid:19)
1

,

where Ng = Re ˆΛ0ˆz is a number of ﬁeld gain lengths along the undulator, b = √2/(3√3B1/3)
for a cold parallel beam, and b = 0.83/ˆǫ for a beam with large emittance and optimized beta-
function. Equation (A.23) is valid when b

1.

1 and Ng ≫

≪

b−1 the summation in (A.23) can be substituted by the

In a particular case when 1
integration. Then for a cold parallel beam we get:

Ng ≪

≪

2

27
2  

B1/3
Ng !

M

≃

for 1

Ng ≪

≪

B1/3 .

2 Ensemble average is meant here.
3 More strictly, orthogonality of the radial modes with the same azimuthal index, as well as equality of
the factors Anm, hold with an accuracy ˆǫ−1
1. Taking these corrections into account would result in
the correction of the order of (Re ˆΛ0 ˆz)−1 to the number of modes.

≪

(A.21)

(A.23)

(A.24)

23

6
For a beam with a large emittance and optimized beta-function the number of modes is

M

1.45

≃

2

ˆǫ
Ng !

 

for 1

Ng ≪

ˆǫ .

≪

(A.25)

We note that applicability region of these estimations is the high-gain linear regime. Numerical

simulations presented in this paper show that the maximum degree of transverse coherence is
achieved already in the nonlinear mode of operation. Linear analysis, presented here, does not

allow to describe this maximum degree of transverse coherence. However, it can be roughly
estimated if one substitutes Ng by the number of ﬁeld gain lengths at the end of the linear
regime. As an estimate, one can take about 70% of the number of ﬁeld gain lengths required to
reach saturation 4 . In any case the asymptotical behavior of the degree of transverse coherence
is

1
ˆǫ2

ζ

∝

in the case of a beam with large emittance and optimized beta-function.

4 Note that saturation occurs earlier for a larger number of modes. This would give a weak (logarithmic)
correction to the value of the transverse coherence.

24

References

[1] A.M. Kondratenko and E.L. Saldin, Part. Accelerators 10(1980)207.

[2] Ya.S. Derbenev, A.M. Kondratenko and E.L. Saldin, Nucl. Instrum. and Methods 193(1982)415.

[3] J.B. Murphy and C. Pellegrini, Nucl. Instrum. and Methods A 237(1985)159.

[4] M. Altarelli et al. (Eds.), XFEL: The European X-Ray Free-Electron Laser. Technical Design

Report, Preprint DESY 2006-097, DESY, Hamburg, 2006 (see also http://xfel.desy.de).

[5] J. Arthur et al., Linac Coherent Light Source (LCLS). Conceptual Design Report, SLAC- R593,

Stanford, 2002 (see also http://www-ssrl.slac.stanford.edu/lcls/cdr.

[6] SCSS X-FEL: Conceptual
http://www-xfel.spring8.or.jp).

design

report, RIKEN,

Japan, May

2005.

(see

also

[7] M. Hogan et al., Phys. Rev. Lett. 81(1998)4867.

[8] S.V. Milton et al., Science 292(2000)2037.

[9] V. Ayvazyan et al., Phys. Rev. Lett. 88(2002)104802.

[10] V. Ayvazyan et al., Eur. Phys. J. D 20(2002)149.

[11] V. Ayvazyan et al., Eur. Phys. J. D 37(2006)297.

[12] K.J. Kim, Nucl. Instrum. and Methods A 250(1986)396.

[13] J.M. Wang and L.H. Yu, Nucl. Instrum. and Methods A 250(1986)484.

[14] W.B. Colson, Review in: W.B. Colson et al. (Eds), ”Laser Handbook, Vol.6: Free Electron Laser”

(North-Holland, Amsterdam, 1990), p. 115.

[15] R. Bonifacio et al., Phys. Rev. Lett. 73(1994)70.

[16] P. Pierini and W. Fawley, Nucl. Instrum. and Methods A 375(1996)332.

[17] E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov, Nucl. Instrum. and Methods A 393(1997)157.

[18] E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov, Opt. Commun. 148(1998)383.

[19] E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov, Opt. Commun. 186(2000)185.

[20] E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov, Nucl. Instrum. and Methods A 507(2003)106.

[21] E.L. Saldin, E.A. Schneidmiller, and M.V. Yurkov, Nucl. Instrum. and Methods A 429(1999)233.

[22] E.L. Saldin, E.A. Schneidmiller, M.V. Yurkov, “The Physics of Free Electron Lasers” (Springer-

Verlag, Berlin, 1999).

[23] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Nucl. Instrum. and Methods A475(2001)86.

[24] M. Xie, Nucl. Instrum. and Methods A445(2000)59.

[25] E.L. Saldin, E. A. Schneidmiller, and M.V. Yurkov, Opt. Commun. 235(2004)415.

[26] W.M. Fawley, Phys. Rev. STAB 5(2002)070701.

25

[27] S. Reiche, Nucl. Instrum. and Methods A429(1999)243.

[28] J. Goodman, Statistical Optics, (John Wiley and Sons, New York, 1985).

[29] M. Xie and D. Deacon, Nucl. Instrum. and Methods A250(1986)426.

[30] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Opt. Commun. 97(1993)272.

[31] K.J. Kim, Phys. Rev. Lett. 57(1986)1871.

[32] L.H. Yu and S. Krinsky, Physics Lett. A129(1988)463.

[33] M. Xie, Nucl. Instrum. and Methods A445(2000)67.

26

