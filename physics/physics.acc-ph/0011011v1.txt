0
0
0
2

 

v
o
N
4

 

 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 

1
v
1
1
0
1
1
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Wake and Impedance

G. V. Stupakov

Stanford Linear Accelerator Center Stanford University, Stanford, CA 94309

I

INTRODUCTION

In this lecture we will develop a concept of wakes and impedances for relativistic
beams interacting with the surrounding environment. Among the numerous publi-
cations and reviews on this subject, we refer here to recent books [1–3], where the
reader can ﬁnd a more detailed treatment and further references.

We will use the CGS system of units throughout this paper.

II

INTERACTION OF MOVING CHARGES IN FREE

SPACE

We begin with interactions of particles that moving with constant velocity in
free space. If the material walls are far from the particles, their eﬀect in the ﬁrst
approximation can be neglected.

Let us consider a leading particle of charge q moving with velocity v, and a
trailing particle of unit charge moving behind the leading one on a parallel path at
a distance s with an oﬀset x, as shown in Fig. 1. We want to ﬁnd the force which
the leading particle exerts on the trailing one.

We will use the following expressions for the electric and magnetic ﬁelds of a

particle moving with a constant velocity (see, e.g., [4]):

E =

qR
γ2R∗3 ,

H =

1
c

v × E ,

(1)

where R is the vector drawn from point 1 to point 2, R∗2 = s2 + x2/γ2, and
γ = (1 − v2/c2)

From Eq. (1) we ﬁnd that the longitudinal force acting on the trailing charge is

−1/2.

Fl = Ez = −

qs

γ2(s2 + x2/γ2)3/2 ,

and the transverse force is

Ft = Ex −

v
c

By =

qx

γ4(s2 + x2/γ2)3/2 .

(2)

(3)

2

v

E

z

x

x

s

1

v

FIGURE 1. A leading particle 1 and a trailing particle 2 traveling in free space with parallel
velocities v. Shown also is the coordinate system x, z.

In accelerator physics, the force F is often called the space-charge force.

It is easy to see that for any position given by s and x, the longitudinal force
decreases with the growth of γ as γ−2. For the transverse force, if s ≫ x/γ,
Ft ∼ γ−4, but for s = 0, Ft ∼ γ−1. Hence, in the limit of ultrarelativistic particles
moving parallel to each other, γ → ∞, the electromagnetic interaction in free space
vanishes.
In this lecture, we will focus on the case of ultrarelativistic charges, where v → c.
The space-charge eﬀects discussed above disappear in this limit, and the interaction
between the particles is due only to the presence of material walls.

Note that, taking the limit v → c in Eq. (1) and recalling that s = vt − z, we

can write the electromagnetic ﬁeld of an ultrarelitivistic charge in free space as

E =

2qr
r2 δ(z − ct) ,

H = ˆz × E ,

(4)

where r = ˆxx + ˆyy is a two-dimensional radius vector in a cylindrical coordinate
system (ˆx and ˆy are the unit vectors in the directions of x and y, respectively).

III PARTICLES MOVING IN A PERFECTLY

CONDUCTING PIPE

If particles from the above example move parallel to the axis in a perfectly
conducting cylindrical pipe of arbitrary cross section, they induce image charges,
on the surface of the wall, that screen the metal from the electromagnetic ﬁeld
of the particles. The image charges travel with the same velocity v (see Fig. 2).
Since both the particles and the image charges move on parallel paths, in the limit
v = c, according to the results in Section II, they do not interact with each other,
no matter how close to the wall the particles are.

Interaction between the particles in the ultrarelativistic limit can occur if 1) the
wall is not perfectly conducting, or 2) the pipe is not cylindrical (which is usually
due to the presence of RF cavities, ﬂanges, bellows, beam position monitors, slots,
etc., in the vacuum chamber).

(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)

image charges

1

z-s

z

2

b

0

FIGURE 2. Particles traveling inside a perfectly conducting pipe of arbitrary cross section.
Shown are the image charges on the wall generated by the leading charge.

IV CAUSALITY AND THE “CATCH-UP” DISTANCE

If a beam particle moves along a straight line with the speed of light, the elec-
tromagnetic ﬁeld of this particle scattered oﬀ the boundary discontinuities will not
overtake it and, furthermore, will not aﬀect the charges that travel ahead of it. The
ﬁeld can interact only with the trailing charges in the beam that move behind it.
This constitutes the principle of causality in the theory of wakeﬁelds, according to
which the interaction of a point charge moving with the speed of light propagates
only downstream and never reaches the upstream part of the beam.

FIGURE 3. A wall discontinuity located at z = 0 scatters the electromagnetic ﬁeld of an
ultrarelativistic particle. When the particle moves to location z, the scattered ﬁeld arrives to
point z − s .

We can estimate the distance at which the electromagnetic ﬁeld produced by a
leading charge reaches a trailing particles traveling at a distance s behind. Let us
assume that a discontinuity located at the surface of a pipe of radius b at coordinate
z = 0 is passed by the leading particle at time t = 0, see Fig. 3. If the scattered

ﬁeld reaches point s at time t, then ct = p(z − s)2 + b2, where z is a coordinate
of the leading particle at time t, z = ct. Assuming that s ≪ b, from these two

equations we ﬁnd

b2
2s

.

z ≈

(5)

The distance z given by this equation is often called the catch-up distance. Only
after the leading charge has traveled this distance away from the discontinuity, can
a particle at point s behind it feel the wakeﬁeld generated by the discontinuity.

V ROUND PIPE WITH RESISTIVE WALLS

Consider a round pipe of radius b, with ﬁnite wall conductivity σ. A point charge
moves along the z axis of the pipe with the speed of light, and a trailing particle
follows the leading one at a distance s. Both particles are assumed to be on the axis
of the pipe. Because of the symmetry of the problem, the only non-zero component
of the electromagnetic ﬁeld on the axis is Ez, which, depending on the sign, either
accelerates or decelerates the trailing charge. Our goal now is to ﬁnd the ﬁeld Ez
as a function of s.

If the conductivity of the pipe is large enough, we can use perturbation theory
to ﬁnd the eﬀect of the wall resistivity. In the ﬁrst approximation, we consider the
pipe as a perfectly conducting one. In this case, the electromagnetic ﬁeld of the
charge is the same as in free space and is given by Eqs. (4). For what follows, we
will need only the magnetic ﬁeld Hθ,

Hθ =

2q
r

δ(z − ct).

Using the mathematical identity

δ(z − ct) =

1

2πc Z ∞

−∞

dωe−iω(t−z/c),

we will decompose Hθ into a Fourier integral,

Hθ(r, z, t) = Z ∞

−∞

dωHθω(r)e−iωt+iωz/c,

where

Hθω(r) =

q

πrc

.

(6)

(7)

(8)

(9)

In the limit where the skin depth δ corresponding to the frequency ω, δ =

c/√2πσω, is much smaller than the pipe radius , δ ≪ b, we can use the Leontovich

boundary condition [5] that relates the tangential electric ﬁeld Et on the wall with
the magnetic one,

Et = ζH × n,

(10)

where n is the unit vector normal to the surface and directed toward the metal,
and

ζ(ω) = (1 − i)r ω

8πσ

.

Combining Eqs.(10), (11) and (9), we ﬁnd

Ezω|r=b = −(1 − i)r ω

8πσ

q
πbc

.

(11)

(12)

Equation (12) gives us the longitudinal electric ﬁeld on the wall, but we need the
ﬁeld on the axis of the pipe. To ﬁnd the radial dependence of Ezω, we use Maxwell’s
equations, from which it follows that the electric ﬁeld in a vacuum satisﬁes the wave
equation. In the cylindrical coordinate system the wave equation for Ez is

1
c2
1
c2

=

∂2Ez(r, z, t)

∂2t

∂2Ez(r, z, t)

∂2t

− ∆Ez(r, z, t)
∂2Ez(r, z, t)
−

∂2z

1
r

∂
∂r

r

−

∂Ez(r, z, t)

∂r

= 0.

(13)

Substituting the Fourier component Ezω(r)e−iω(t−z/c) into this equation, we ﬁnd

1
r

∂
∂r

r

∂Ezω
∂r

= 0.

(14)

This equation has a general solution Ezω = A+ B ln r, where A and B are arbitrary
constants. Since we do not expect Ez to have a singularity on the axis, B = 0.
Hence the electric ﬁeld does not depend on r, Ezω = const, and

Ezω|r=0 = Ezω|r=b,

(15)

implying that Ezω|r=0 is given by the same Eq. (12). Note that we have shown
here that in the ultrarelativistic case the longitudinal electric ﬁeld inside the pipe
is constant throughout the pipe cross section.

To ﬁnd Ez(z, t) we make the inverse Fourier transformation,

Ez(z, t) = Z ∞

−∞

dωEzωe−iω(t−z/c),

which gives

Ez(z, t) = (i − 1)

q

πcbr 1

8πσ Z ∞

−∞

dω√ωe−iω(t−z/c).

(16)

(17)

The last integral can be taken analytically in the complex plane (see the Appendix),
with the result

Ez(z, t) =

q

2πbr c
σs3 ,

(18)

for s > 0. For the points where s < 0, located in front of the charge, Ez = 0 in
agreement with the causality principle. The positive sign of Ez indicates that the
trailing charge (if it has the same sign as q) will be accelerated in the wake.

In our derivation we assumed that the magnetic ﬁeld on the wall is the same as
in the case of perfect conductivity. However, the magnetic ﬁeld is generated not
only by the beam current, but also by a displacement current,

jdisp
z =

1
4π

∂Ez
∂t

.

(19)

that vanishes in the limit of perfect conductivity. To be able to neglect the correc-
tions to Hθ due to jdisp
, we must require the total displacement current to be much
less then the beam current. In the Fourier representation, the time derivative ∂/∂t
reduces to multiplication by −iω, and the requirement is

z

or

πb2 1
4π

ωEzω ≪ Iω =

q
2π

,

(cid:16)ω
c(cid:17)3/2

≪ r 4πσ
cb2 .

(20)

(21)

In the space-time domain, the inverse wavenumber c/ω corresponds to the distance
s, and the condition of applicability of Eq. (18) is,

s ≫ s0 = (cid:18) cb2

4πσ(cid:19)1/3

.

(22)

The behavior of Ez for very small values of s, s < s0, can be found in Ref. 6.Here
we note only that the singularity in Eq. (18) saturates at small s, and the electric
ﬁeld changes sign and becomes negative at s = 0. This ﬁeld decelerates the leading
charge, as expected from the energy balance consideration.

VI WAKE DEFINITION

The electromagnetic interaction of charged particles in accelerators with the sur-
rounding environment is usually a relatively small eﬀect that can be considered
as a perturbation.
In the zeroth approximation, we can assume that the beam
moves with a constant velocity along a straight line. We solve Maxwell’s equation,
ﬁnd the ﬁelds, and then take into account the eﬀect of these ﬁelds on a particle’s
motion. In this approach we neglect the second-order eﬀects because the motion
along the perturbed orbit can only slightly change the ﬁelds computed in the zeroth
approximation. Those corrections are usually small, especially for ultrarelativistic
particles.

Another important feature of the interaction between the generated electromag-
netic ﬁeld and the particles is that in many cases of practical importance it is
localized in a region small compared with the length of the beam orbit. It also
occurs on a time scale much smaller than the characteristic oscillation times of the
beam in the accelerator (such as betatron and synchrotron periods). This allows
us to consider this interaction in the impulse approximation and characterize it by
the amount of momentum transferred to the particle.

Taking into account the above considerations, we will introduce the notion of the
wake in the following way. Consider a leading particle 1 of charge q moving along

v2

x

y

R

s

v

1

z

FIGURE 4. A leading particle 1 and a trailing particle 2 move parallel to each other in a vacuum
chamber.

axis z with a velocity close to the speed of light, v ≈ c, so that z = ct (see Fig.
4). A trailing particle 2 of unit charge moves parallel to the leading one, with the
same velocity, at a distance s with oﬀset ρ relative to the z-axis. The vector ρ
is a two-dimensional vector perpendicular to the z-axis, ρ = (x, y). Although the
two particles move in a vacuum, there are material boundaries in the problem that
scatter the electromagnetic ﬁeld and result in interaction between the particles.

Let us assume that we solved Maxwell’s equation and found the electromagnetic
ﬁeld generated by the ﬁrst particle. We calculate the change of the momentum
∆p of the second particle caused by this ﬁeld as a function of the oﬀset ρ and the
distance s,

∆p(ρ, s) = Z ∞

−∞

dt [E(ρ, z, t) + ˆz × B(ρ, z, t)]z=ct−s .

(23)

Note that we integrate here along a straight line — the unperturbed orbit of the
second particle. The integration limits are extended from minus to plus inﬁnity,
assuming that the integral converges.

Since the beam dynamics is diﬀerent in the longitudinal and transverse direc-
tions, it is useful to separate the longitudinal momentum ∆pz from the transverse
component ∆p⊥. With the proper sign and the normalization factor c/q, these two

Ρ
components are called the longitudinal and transverse wake functions (or simply
wakes),

c
q

wl(ρ, s) = −
c
q

wt(ρ, s) =

∆pz = −
c

∆p⊥ =

c

q Z dtEz|z=ct−s,

q Z dt [E⊥ + ˆz × B]z=ct−s .

(24)

Note the minus sign in the deﬁnition of wl — it is introduced so that the positive
longitudinal wake corresponds to the energy loss of the trailing particle (if both
the leading and trailing particles have the same sign of charge). The deﬁned wakes
have dimension cm−1 in CGS units and V/C in SI units.1

Because of the causality principle, the wakeﬁeld does not propagate in front of

the leading charge, hence

wl(ρ, s) ≡ 0,

wt(ρ, s) ≡ 0,

for s < 0 .

(25)

It was assumed above that the electromagnetic ﬁeld is localized in space and
time and the integral in Eq. (23) converges. There are cases, however, where this
is not true and the source of the wake is distributed uniformly along an extended
path, such as the resistive wall wake of a long pipe, considered in Section V. In
this case it is more convenient to introduce the wake per unit length of the path
by dropping the integration in Eq. (23):

wl(ρ, s) = −
1
wt(ρ, s) =
q

1
Ez|z=ct−s,
q
[E ⊥ + ˆz × B]z=ct−s .

(26)

In this deﬁnition, the wakes acquire an additional dimension of inverse length, and
has the dimension cm−2 in CGS and V/C/m in SI.

VII PANOFSKY-WENZEL THEOREM

Several general relations between longitudinal and transverse wakes can be ob-
tained from Maxwell’s equation without specifying the boundary condition for the
ﬁelds.

Let us introduce the vector R = (ρ,−s) (the negative sign in front of s is due
to measuring s in the negative direction of z, see Fig. 4) and consider momentum
∆p in Eq. (23) as a function of R. Let us assume that the electric and magnetic
ﬁelds are speciﬁed through the vector potential A(r, t) and the scalar potential

1) A useful relation between the units is 1 V/pC = 1.11 cm−1.

φ(r, t), and compute ∆p for the given ﬁelds. It is convenient to use the Lagrangian
formulation of the equations of motion,2

d
dt

∂L
∂v

=

∂L
∂r ≡ ∇L,

with the Lagrangian for the trailing unit charge in the electromagnetic ﬁeld

L = −mc2r1 −

v2
c2 +

1
c

Av − φ.

Putting Eq. (28) into Eq. (27) yields (p = mγv)

d

dt (cid:18)p +

1
c

A(cid:19) = ∇(cid:18)1

c

Av − φ(cid:19) .

(27)

(28)

(29)

Now, integrating this equation along the orbit of the trailing particle, x = const,
y = const and z = ct − s, and assuming that the ﬁelds A and φ vanish at inﬁnity,
we ﬁnd

∆p(R) = Z dt∇(cid:18)1
c
q
c∇RW (R),

=

Av − φ(cid:19)

where we introduced the wake potential W ,

W (R) =

=

c

c

c

Av − φ(cid:19)

q Z dt(cid:18)1
q Z dt (Az − φ) .

(30)

(31)

In the last equation we used v ≈ cˆz.
We just proved an important relation that states that all three components of
the vector ∆p can be obtained by diﬀerentiation of a single scalar function W .
Recalling now the relation between the components of ∆p and the wakes, Eq.
(24), we ﬁnd that

wl = −

∂W
∂(−s)

=

∂W
∂s

,

wt = ∇ρW,

and hence

∂wt
∂s

= ∇ρwl.

(32)

(33)

2) This approach to the derivation of the Panofsky-Wenzel theorem is due to A. Chao.

This relation is usually referred to as the Panofsky-Wenzel theorem. Note that ∇ρ
is a two-dimensional gradient with respect to coordinates x and y.
One of the most important computational applications of the Panofsky-Wenzel
theorem is that knowledge of the longitudinal wake function wl allows us to ﬁnd
the transverse wake wt by means of a simple integration of Eq. (33).

We now prove another important property of W :

it is a harmonic function of

variables x and y,

∆⊥W ≡

∂2W
∂x2 +

∂2W
∂y2 = 0.

(34)

To prove this, we will use the fact that both A and φ satisfy the wave equation in
free space, (∂2/∂t2 − c2∆)A = (∂2/∂t2 − c2∆)φ = 0. Hence

c

0 =

c

q Z dt(cid:18) ∂2
q Z dt(cid:18) ∂2
= −
∂2W
∂x2 −

∂t2 − c2∆(cid:19) (Az − φ)
∂x2 +
∂2W
∂y2 +

∂y2(cid:19) (Az − φ) +
q Z dt(cid:18) ∂

= −

+ c

∂2

∂t

c

c

q Z dt(cid:18) ∂2
∂z(cid:19)(cid:18) ∂
∂t − c

∂t2 − c2 ∂2
∂z(cid:19) (Az − φ) .

∂z2(cid:19) (Az − φ)

∂

∂

The last integral in this equation vanishes because

∂
∂t

+ c

∂
∂z ≈

∂
∂t

+ v∇ =

d
dt

and

+ c

∂t

Z dt(cid:18) ∂
dt (cid:18) ∂
= Z dt

d

∂

∂t − c

∂z(cid:19)(cid:18) ∂
∂z(cid:19) (Az − φ)

∂

∂

∂z(cid:19) (Az − φ)

∂t − c

= 0.

(35)

(36)

(37)

It is interesting that the wake potential W turns out to be a relativistic invariant.

A covariant expression for it can be written as

W = −

1

q Z ∞

−∞

Akukdτ,

(38)

where Ak = (φ,−A) is the 4-vector potential, uk = (cγ, cγv) is the 4-vector velocity,
and τ is the proper time for the particle.

VIII SYSTEMS WITH A SYMMETRY AXIS

In Section VI we deﬁned the wake as a function of the trailing particle oﬀset
relative to the path of the leading particle. In practical applications we are also
interested in how the wake depends on the trajectory of the leading particle. We
will assume that the system under consideration has a symmetry axis, and choose
it as the z-axis of the coordinate system (see Fig. 5). Now the leading particle 1

2

v

R

s

z

Ρ'

x

y

1

v

FIGURE 5. Both the leading particle 1 and the trailing particle 2 are oﬀset relative to the axis
of the chamber.

moves in the z direction with an oﬀset given by vector ρ′, and the trailing particle
travels parallel to the leading one, with the same velocity, at a distance s behind
the leading one, and with oﬀset ρ relative to the axis. The vectors ρ′ and ρ are
the two-dimensional vectors perpendicular to the z-axis. The wake is still deﬁned
by Eq. (24), but now it will be considered as a function of ρ′, ρ, and s

wl = wl(ρ, ρ′, s),
wt = wt(ρ, ρ′, s).

(39)

Usually the vacuum chamber is designed so that the system axis serves as an
ideal orbit for the beam. Deviations from it are relatively small, and both vectors
ρ and ρ′ are typically much smaller than the size of the vacuum chamber. We can
neglect them in wl and introduce the longitudinal wake function that depends only
on s,

wl(s) = wl(0, 0, s).

(40)

If the vacuum chamber also has some symmetry elements (e.g., it has either
circular, elliptical or rectangular cross section), the transverse wake on the axis,
where ρ, ρ′ = 0, vanishes, wt(0, 0, s) = 0. For small values of ρ, ρ′ we can expand
wt(ρ, ρ′, s) keeping only the lowest-order linear terms. That gives a tensor relation
between the transverse wake and the oﬀsets,

wt(ρ, ρ′, s) =

W 1(s)ρ +

W 2(s)ρ′,

↔

↔

(41)

Ρ
↔

↔

W 1 and

where
W 2 are the two-dimensional tensors of rank 2. An example of
the wake calculation for elliptical and rectangular cross sections of the pipe can be
found in Ref. 7.

IX AXISYMMETRIC SYSTEMS

In an axisymmetric system W depends only on the absolute values of ρ, ρ′, and
the angle θ between them. We can always chose a coordinate system such that the
vector ρ′ lies in the x-z plane (see Fig. 6), so that the potential function W will be
a periodic even function of angle θ in a cylindrical coordinate system. Decomposing

2

ρ

ρ'

q

1

FIGURE 6. Vectors ρ and ρ′ in an axisymmetric system.

W in Fourier series in θ yields

W (ρ, ρ′, θ, s) =

∞

Xm=0

Wm(ρ, ρ′, s) cos mθ.

Putting this equation into Eq. (34) gives

∞

Xm=0

(cid:18) 1

ρ

∂
∂ρ

ρ

∂Wm
∂ρ −

m2

ρ2 Wm(cid:19) cos mθ = 0,

from which we can ﬁnd an explicit dependence of Wm of ρ,

Wm(ρ, ρ′, s) = Am(ρ′, s)ρm.

(42)

(43)

(44)

In Eq. (44) we discarded a singular solution of Eq. (43) Wm ∝ ρ−m.
out to be

It is also possible to ﬁnd the dependence of Wm versus ρ′ (see [8]), which turns

Am(ρ′, s) = Fm(s)(ρ′)m.

(45)

Using Eq. (32) we now ﬁnd for the longitudinal and transverse wake functions

wl = X w(m)

l

,

wt = X w(m)

t

(46)

where

w(m)
l = (ρ′)mρmF ′
t = m(ρ′)mρm−1Fm(s)hˆr cos mθ − ˆθ sin mθi ,
w(m)

m(s) cos mθ,

(47)

where ˆr and ˆθ are the unit vectors in the radial and azimuthal directions in the
cylindrical coordinate system. Remember that in this equation we assume that the
leading particle is in the plane θ = 0.

Equations (47) are valid for arbitrary values of ρ and ρ′. Near the axis, where the
oﬀsets are small, the higher-order terms with large values of m in these equations
also become small. In this case, we can keep only the lower-order terms with m = 0
(monopole) and m = 1 (dipole) wakes. For the monopole wake we ﬁnd

wl ≡ w(0)

l = F ′

0(s),

(48)

which shows that the longitudinal wake does not depend on the radius in an axisym-
metric system. We also see that the monopole transverse wake vanishes, w(0)
t = 0.
does not depend on ρ′, sometimes it is more convenient to compute

Since w(0)

l

the monopole wake for an oﬀset orbit, ρ′ 6= 0, rather than on the axis.

^
q

ρ

^
r

q

ρ'

^ (cid:13)
r cosq-q sinq

^

FIGURE 7. Vectors ρ and ρ′ and unit vectors in cylindrical coordinate system.

For the dipole wake (m = 1), the vector ˆr cos θ − ˆθ sin θ lies in the direction of
the x axis, that is in the direction of ρ′, see Fig. 7. Hence,

w(1)

t = ρ′F (s).

(49)

The wake given by Eq. (49) is usually normalized by the absolute value of the
oﬀset ρ′, and the scalar function w(1)

t /ρ′ is called the transverse dipole wake wt,

wt(s) = F (s).

(50)

Such a transverse wake has the dimension cm−2 or V/C/m.3 In this deﬁnition, a
positive transverse wake means a kick in the direction of the oﬀset of the driving
particle (if both particles have the same charge).

3) If the original wake is deﬁned per unit length, as in Eq. (26), then wt will have the dimension
V/C/m2 or cm−3.

X RESISTIVE WALL WAKE FUNCTIONS

We are now in a position to ﬁnd the wakes generated by a particle in a circular
pipe with resistive walls. Using Eq. (18) and the deﬁnition Eq. (24) gives the
longitudinal wake

wl(s) = −

1

2πbr c
σs3 .

(51)

The minus sign here means that the trailing charge is accelerated in the wakeﬁeld.
Let us now calculate the dipole transverse wake due to the resistive wall. First,
we need to solve for the electromagnetic ﬁeld of the leading charge q moving with
an oﬀset ρ′ in a circular pipe. From the point of view of excitation of dipole modes,
this charge can be considered as having a dipole moment d = qρ′. In the zeroth
approximation of perturbation theory, the electromagnetic ﬁeld of a dipole moving
with the speed of light in a perfectly conducting pipe is

E = 2δ(z − ct)(cid:20)2(d · r)r − dr2

r4

+

d

b2(cid:21) ,

H = ˆz × E .

(52)

The ﬁrst term in the expression for E is a vacuum ﬁeld of a relativistic dipole, and
the second one is due to the image charges, which are generated in order to satisfy
the boundary condition on the metal surface.

Following the derivation in Section V, we ﬁnd the magnetic ﬁeld on the wall,

Hθ =

4d
b2 cos θδ(z − ct),

and take its Fourier transform,

Hθω =

2d
πcb2 cos θ ,

(53)

(54)

where the angle θ is measured from the direction of d. Then using the Leontovich
boundary condition, Eq. (12), for the electric ﬁeld Ezω,

Ezω|r=b = −(1 − i)r ω

8πσ

2d
πcb2 cos θ,

and making the inverse Fourier transformation, we obtain Ez on the wall

Ez(z, ρ = b, ρ′, t) =

qρ′

πb2r c

σs3 cos θ ,

(55)

(56)

where s = ct − z. Recalling that, according to Eq. (47) the dipole wake is a linear
function of ρ, we conclude that

Ez(z, ρ, ρ′, t) =

qρρ′

πb3 r c

σs3 cos θ ,

(57)

and the function F ′

1(s) is

F ′
1(s) = −

1

πb3r c
σs3 ,

which gives the following result for the transverse wake deﬁned by Eq. (50):

wt(s) =

2

πb3r c

σs

.

(58)

(59)

Analogous to the longitudinal wake, Eq. (18), this formula is valid only for s ≫ s0
(see Eq. (22)).

XI WAKEFIELD IN A BUNCH OF PARTICLES

Up to now we have studied the interaction of two point charges traveling some
distance s apart. If a beam consists of N particles with the distribution function
λ(s) (deﬁned so that λ(s)ds gives the probability of ﬁnding a particle near point
s), a given particle will interact with all other particles of the beam. To ﬁnd the
change of the longitudinal momentum of the particle at point s we need to sum the
wakes from all other particles in the bunch,

∆pz(s) =

Ne2

c Z ∞

s

ds′λ(s′)wl(s′ − s).

(60)

Here we use the causality principle and integrate only over the part of the bunch
ahead of point s. In the ultrarelativistic limit the energy change ∆E(s) caused by
the wakeﬁeld is equal to c∆pz, so Eq. (60) can also be rewritten as

∆E(s) = Ne2Z ∞

s

ds′λ(s′)wl(s′ − s).

(61)

Two integral characteristics of the strength of the wake are the average value of
the energy loss ∆Eav, and the rms spread in energy generated by the wake ∆Erms.
These two quantities are deﬁned by the following equations:

∆Eav = Z ∞

−∞

ds∆E(s)λ(s),

and

∆Erms = (cid:20)Z ∞

−∞

ds(∆E(s) − ∆Eav)2λ(s)(cid:21)1/2

.

(62)

(63)

As an example, let us calculate ∆Eav and ∆Erms for the resistive wall wake given

by Eq. (51) and a Gaussian distribution function,

ρ(s) =

1

√2πσs

exp(cid:18)−

s2
2σ2

s(cid:19) ,

(64)

where σs is the rms bunch length. Note that, since w in Eq. (51) is the wake per
unit length of the pipe, we need to multiply the ﬁnal answer by the pipe length L.
A direction substitution of the wake Eq. (51) into Eq. (61) gives a divergent
integral when s′ → s.4 To remove the divergence, we need to recall that according
to Eq. (48) the longitudinal wake is equal to the derivative of the longitudinal wake
0(s) with F0 = (πb)−1pc/σs for s > 0, and F0 = 0 for s < 0. We
potential, wl = F ′
then rewrite Eq. (61) as

ds′λ(s′)

dF0(s′ − s)

ds
F0(s′ − s)

∆E(s) = Ne2LZ ∞
= −Ne2LZ ∞

−∞

ds′ dλ(s′)
ds
σz(cid:19) ,
G(cid:18) s

s
Ne2Lc1/2
bσ3/2
z σ1/2

=

where the function G(x) is

(65)

(66)

G(x) =

1

21/2π3/2 Z ∞

x

ye−y2/2dy

√y − x

.

The plot of the function G (s/σz) is shown in Fig. 8, where the positive values
of s correspond to the head of the bunch. We see that in the resistive wake the
particles lose energy in the head of the bunch and get accelerated in the tail. On
the average, of course, the losses overcome the gain. For the average energy loss
one can ﬁnd an analytical result:

∆Eav =

Γ( 3
4)

23/2π3/2

Ne2c1/2
bσ3/2
z σ1/2

.

(67)

Numerical integration of Eq. (63) shows that the energy spread generated by the
resistive wake is approximately equal to ∆Eav:

∆Erms = 1.06 ∆Eav.

(68)

If the beam is traveling in the pipe with an oﬀset y relative to the axis, it will be
deﬂected in the direction of the oﬀset, by the transverse wakeﬁelds. To calculate
the deﬂection angle θ we use the relation

4) The integral diverges because Eq. (51) is not valid for very small values of s, see Eq. (22).

G

0.1

0

-5

-2.5

0
s(cid:144)sz

2.5

5

FIGURE 8. Plot of the function G (s/σz).

θ(s) =

∆p⊥(s)

p

= yL

Ne2

ds′λ(s′)wt(s′ − s)

=

NLreyc1/2
γb3σ1/2
z σ1/2

where the function H(x) is

H(x) =

s

cp Z ∞
σz(cid:19) ,

H (cid:18) s

21/2

π3/2 Z ∞

x

e−y2/2dy

√y − x

.

The plot of the function H (s/σz) is shown in Fig. 9.

The deﬂection angle averaged over the distribution function is

θav =

Γ( 1
4)

21/2π3/2

NLreyc1/2
γb3σ1/2
z σ1/2

,

and the rms spread is

h(θ − θav)2i1/2 = A1/2 NLreyc1/2

γb3σ1/2

z σ1/2

,

where

A =

2

π5/2 (cid:20)K (cid:18)3

4(cid:19) −

Γ2(1/4)

4√π (cid:21)

and K is the complete elliptic integral. The numerical value of A1/2 is 0.186.

(69)

(70)

(71)

(72)

(73)

0.6

0.4

0.2

H

0

-5

-2.5

0
s(cid:144)sz

2.5

5

FIGURE 9. Plot of the function H (s/σz).

XII DEFINITION OF IMPEDANCE AND RELATION

BETWEEN IMPEDANCE AND WAKE

Knowledge of the longitudinal and transverse wake functions gives complete in-
formation about the electromagnetic interaction of the beam with its environment.
However, in many cases, especially in the study of beam instabilities, it is more con-
venient to use the Fourier transform of the wake functions, or impedances. Also, it
is often easier to calculate the impedance for a given geometry of the beam pipe,
rather than the wake function. Recall, that in Section V we actually ﬁrst com-
puted the Fourier components of the wakes, and then, using the inverse Fourier
transformation, found the wakes.

For historical reasons the longitudinal Zl and transverse Zt impedances are de-

ﬁned as Fourier transforms of wakes with diﬀerent factors,

Zl(ω) =

dswl(s)eiωs/c ,

1

c Z ∞
c Z ∞

0

0

i

Zt(ω) = −

dswt(s)eiωs/c .

(74)

Note that the integration in Eqs. (74) can actually be extended into the region of
negative values of s, because wl and wt are equal to zero in that region.

Impedance can also be deﬁned for complex values of ω such that Imω > 0 and
the integrals, Eq. (74), converge. So deﬁned, the impedance is an analytic function
in the upper half-plane of the complex variable ω.

We must keep in mind that other authors sometimes introduce deﬁnitions of the
impedance that diﬀer from the one given above. In Refs. 2 and 9 the longitudinal

impedance is deﬁned as a complex conjugate to the one given by Eq. (74). Here
we follow the deﬁnitions of Refs. 1 and 10.

From the deﬁnitions in Eq.
following symmetry conditions:

(74) it follows that the impedance satisﬁes the

ReZl(ω) = ReZl(−ω),
ReZt(ω) = −ReZt(−ω),

ImZl(ω) = −ImZl(−ω),
ImZt(ω) = ImZt(−ω).

The inverse Fourier transform relates the wakes to the impedances:

wl(s) =

wt(s) =

−∞

1

2π Z ∞
2π Z ∞

i

∞

dωZl(ω)e−iωs/c ,

dωZt(ω)e−iωs/c .

(75)

(76)

It turns out that the wakeﬁeld can actually be found if only the real part of the

impedance is known. Indeed, we can rewrite Eq. (76) for wl as

1

wl(s) =

2π Z ∞

dωhReZl(ω) cos

ωs
c − ImZl(ω) sin
For negative values of s this formula should give wl = 0, hence
c (cid:21) ,
ω|s|

dω(cid:20)ReZl(ω) cos

0 = Z ∞

+ ImZl(ω) sin

ωs
c

∞

∞

ωs

c i .

from which it follows that

wl(s) =

1

π Z ∞

∞

dωReZl(ω) cos

ωs
c

=

2

π Z ∞

0

dωReZl(ω) cos

ωs
c

.

A similar derivation for the transverse wake gives

wt(s) =

2

π Z ∞

0

dωReZt(ω) sin

ωs
c

.

(77)

(78)

(79)

(80)

XIII ENERGY LOSS AND ReZL

We can relate the energy loss by the bunch to the real part of the longitudinal

impedance. Indeed,

−∞

∆Eav = N 2e2Z ∞
= N 2e2Z ∞
2π Z ∞

N 2e2

=

−∞

−∞

−∞

dsλ(s)Z ∞
dsλ(s)Z ∞
dωZl(ω)|ˆλ(ω)|2,

−∞

ds′λ(s′)wl(s′ − s)
2π Z ∞
ds′λ(s′)

−∞

1

dωZl(ω)e−iω(s′−s)/c

(81)

where ˆλ(ω) = R ∞

of ω, and

−∞ dsλ(s)eiωs/c. Since ˆλ(−ω) = ˆλ∗(ω), |ˆλ(ω)|2 is an even function

∆Eav =

Q2

π Z ∞

0

dωReZl(ω)|ˆλ(ω)|2,

where Q = Ne.

For a point charge, λ(s) = δ(s), ˆλ(ω) = 1, and the energy loss is

∆Eav =

e2

π Z ∞

0

dωReZl(ω).

(82)

(83)

XIV KRAMERS-KRONIG RELATIONS

Equations (79) and (80) relate ReZ(ω) to the wake function. Since Z(ω) is given
by Fourier transformation of w(s), the knowledge of ReZ(ω) allows us to ﬁnd Z(ω),
and hence ImZ(ω). This means that ImZ(ω) and ReZ(ω) are functionally related
to each other. Mathematically this relation is manifested in the Kramers-Kronig
dispersion relation, which can be written as

Z(ω) = −

i
π

P.V.Z ∞

−∞

Z(ω′)
ω′ − ω

dω′,

(84)

where P.V. stands for the principal value of the integral. Taking the real and
imaginary parts of this equation gives explicit relations between ReZ and ImZ:

ReZ(ω) =

1
π

ImZ(ω) = −

P.V.Z ∞
P.V.Z ∞

1
π

−∞

−∞

dω′,

ImZ(ω′)
ω′ − ω
ReZ(ω′)
ω′ − ω

dω′.

(85)

XV USEFUL FORMULA FOR IMPEDANCE

CALCULATION

Assume that we have a solution of an electromagnetic problem corresponding
to the current on the axis of a pipe with the time and space dependence given by
e−iωt+iωz/c. Speciﬁcally, we know the electric ﬁeld on the axis, Ezω(z)e−iωt. How
can longitudinal impedance be found in terms of Ezω(z)?

The longitudinal wake is equal to the integrated ﬁeld Ez generated by a point
charge moving with the speed of light. The current corresponding to this point
charge can be decomposed into a Fourier integral:

cqδ(z − ct) = Z ∞

−∞

dω

q
2π

e−iω(t−z/c).

(86)

Since we know the electric ﬁeld generated by each harmonic, we can ﬁnd the ﬁeld
due to the point charge as a superposition of Ezω:

Ez(z, t) =

For wl we then have

q

2π Z ∞

−∞

dωEzω(z)e−iωt.

(87)

wl(s) = −

= −

1

2π Z ∞
2π Z ∞

1

−∞

−∞

dωd(ct)Ezω(ct − s)e−iωt
dωdzEzω(z)e−iω(z+s)/c.

Comparing Eq. (88) with Eq. (74) we ﬁnd

Zl(ω) = −Z ∞

−∞

dzEω(z)e−iωz/c.

(88)

(89)

Hence the longitudinal impedance can be obtained simply by making Fourier trans-
formation of Ezω(z).

XVI SMALL PILLBOX CAVITY IN ROUND PIPE

As an example of using Eq. (89) we will derive here the longitudinal impedance
Zl(ω) for a small axisymmetric cavity (pillbox) in a round perfectly conducting
pipe, see Fig. 10. We assume that the wavelength associated with the frequency ω
is much larger than the dimension of the pillbox, c/ω ≫ g, h.

g

h

b

FIGURE 10. Small pillbox cavity in a round pipe. The dashed line near the wall shows the
integration path in Eq. (92).

First, we need to ﬁnd the solution of Maxwell’s equations corresponding to a unit
current Iω = e−iωt+iωz/c on the axis. Since the cavity is small, the magnitude of the

magnetic ﬁeld at the location of the cavity (z = 0) is approximately equal to Hθ
on the wall of the pipe

Hθ =

2
bc

.

(90)

Because Ezω does not depend on r (see Section V) we can choose the integration
path in Eq. (89) close to the wall, as shown in Fig. 10, rather than the pipe axis.
Along this path Ezω is not equal to zero only in the cavity gap, where |z| ∼ h, and
e−iωz ≈ 1. We have

Zl(ω) = −Z ∞
≈ −Z ∞

−∞

−∞

dzEzω(z)e−iωz/c

dzEzω(z) =

1
c

dΦ
dt

iω
c

= −

Φ,

(91)

where Φ is the magnetic ﬂux in the cross section of the cavity, Φ = Hθhg. As a
result,

Zl(ω) = −iω

2gh
bc2 = −iωZ0

gh
2πbc

,

(92)

where Z0 = 4π/c = 377 Ohm. What we obtained is a purely inductive longitudinal
impedance, which can be rewritten as

Zl(ω) = −i

ω
c2L,

(93)

where the inductance L = 2gh/b. In CGS units the inductance has a dimension of
cm, 1 cm = 1 nH.
A more detailed calculation [11] shows that our method gives only an approximate
solution of the problem. In addition to the solenoidal electric ﬁeld generated by
the time-varying magnetic ﬂux in the cavity, there is also a contribution due to
the potential component of the electric ﬁeld. This results in a diﬀerent numerical
coeﬃcient in Eq. (92) which depends on the ratio g/h. For example, for g = h the
correction factor is 0.84.

XVII

INDUCTIVE IMPEDANCE

We saw in the previous section that a small pillbox is characterized by inductive
impedance if the frequency is not very large. This is a common feature of many
small perturbations whose size is much smaller than the pipe radius (e.g., small
holes, shallow obstacles on the wall, etc.) — for not very large frequencies their
impedance is purely inductive.

The longitudinal wake corresponding to the inductive impedance can be found

by using Eq. (76):5

wl(s) = Lδ′(s).

(94)

Because of the inductive wake, slices of the beam can change their energy, al-
though the net energy loss for the bunch is zero because the real part of the
impedance vanishes. We can ﬁnd the energy change as a function of position
within the bunch by using Eq. (61). Integration gives
∆E(s) = −e2NLλ′(s).
For a Gaussian distribution function this reduces to

(95)

ξe−ξ2/2
√2π
where ξ = s/σz. For the rms energy spread we ﬁnd

e2NL
σ2
z

∆E(s) =

,

h∆E2i1/2 = 3−3/4(2π)−1/2 e2NL

σ2
z

.

XVIII CAVITY IMPEDANCE

(96)

(97)

In the more general case of a large cavity (Fig. 11) the beam excites cavity
eigenmodes and the longitudinal wake in the cavity is composed of contributions

FIGURE 11. An RF cavity with beam pipes.

from single modes,

wl(s) = Xn

w(n)(s).

(98)

5) Since the integral involved in the calculation of wl(s) actually diverges at ω → ∞, it should
be treated as a generalized function. It is easier to verify Eq. (94) by putting it into Eq. (74)
and checking that the resulting impedance is given by Eq. (93).

For perfectly conducting walls, assuming that the modes do not propagate into the
beam pipes,6 the mode frequencies ωn are real. It should be no surprise that each
partial wakeﬁeld oscillates with the frequency of the mode ωn,

w(n)(s) = 2kn cos(cid:16) ωns
c (cid:17) ,

(99)

where kn is the loss factor, which depends on the geometry of the cavity and the
mode number. As an example, for a cylindrical cavity with b = l and TM010 mode,
k010 = 4.5/l. For a more rigorous derivation of the wake for a cavity, see Ref. 12.
The cavity impedance for this wake can be calculated by using Eqs. (74). They

give

ReZl = πkn[δ(ω + ωn) + δ(ω − ωn)],
ImZl = kn(cid:20)

ω + ωn

+

1

1

ω − ωn(cid:21) .

(100)

It is also easy to generalize the above wake for a cavity with lossy walls when
the frequency of the mode has a small imaginary part γn, γn ≪ ωn. The wake now
decays with time as

wl(s) = 2kne−γs/c cos(cid:16)ωns
c (cid:17) .

(101)

Again using Eq. (74), we can calculate the impedance. It has two peaks: one in
the vicinity of ω = ωn and the other in the vicinity of ω = −ωn. Assuming that ω
is close to ωn, we ﬁnd

Zl =

kn

γ − i (ω − ωn)

.

REFERENCES

(102)

1. A. W. Chao, Physics of Collective Beam Instabilities in High Energy Accelerators

(Wiley, New York, 1993).

2. B. W. Zotter and S. A. Kheifets, Impedances and Wakes in High-Energy Particle

Accelerators (World Scientiﬁc, Singapore, 1998).

3. A. W. Chao and M. Tigner, Handbook of Accelerator Physics and Engineering (World

Scientiﬁc, Singapore, 1999).

4. L. D. Landau and E. M. Lifshitz, The Classical Theory of Fields, vol. 2 of Course of
Theoretical Physics, 4th ed. (Pergamon, London, 1979) (Translated from the Rus-
sian).

5. L. D. Landau and E. M. Lifshitz, Electrodynamics of Continuous Media, vol. 8 of
Course of Theoretical Physics, 2nd ed. (Pergamon, London, 1960) (Translated from
the Russian).

6) This is true if the frequency of the mode is above the cutoﬀ frequency for the pipe.

6. K. L. F. Bane and M. Sands, The Short-Range Resistive Wall Wakeﬁelds, Tech. Rep.

SLAC-PUB-95-7074, SLAC (December 1995).

7. R. L. Gluckstern, J. van Zeijts, and B. Zotter, Phys. Rev. E47, 656 (1993).
8. K. L. Bane, P. B. Wilson, and T. Weiland, in Proc. US Particle Accelerator School:
Physics of Particle Accelerators, Upton, N.Y., 1983 (American Institute of Physics,
New York, 1985), no. 127 in AIP Conference Proceedings, pp. 875–928.

9. P. B. Wilson, in M. Month and M. Dienes, eds., Proc. US Particle Accelerator School:
Physics of Particle Accelerators, Batavia, 1987 (American Institute of Physics,
New York, 1989), no. 184 in AIP Conference Proceedings, pp. 525–564.

10. S. A. Heifets and S. A. Kheifets, Review of Modern Physics 63, 631 (1991).
11. S. S. Kurennoy and G. V. Stupakov, Particle Accelerators 45, 95 (1994).
12. P. Wilson, High Energy Electron Linacs: Applications to Storage Ring RF Systems

and Linear Colliders, Tech. Rep. SLAC-AP-2884 (Rev.), SLAC (November 1991).

APPENDIX

We show here how to calculate the integral in Eq. (17),

I(ξ) = Z ∞

−∞

dω√ωe−iωξ,

(A1)

where ξ = t − z/c = s/c. First, we change the integration variable ω to ζ = ωξ,

I(ξ) =

1

ξ3/2 Z ∞

−∞

dζpζe−iζ.

(A2)

We then consider ζ as a complex variable. In order to make the integrand a single-
valued function in the complex plane, we make a cut along the negative imaginary
half-axis and deform the integration path from a straight line to a contour, shown
in Fig. 12. The integral I(ξ) can now be split into two parts, I1(ξ) and I2(ξ),
corresponding to the left and right branches of the integration contour.

In the ﬁrst integral I1(ξ) we change the complex integration variable ζ to the

real positive variable τ , ζ = e3πi/2τ = −iτ , so that √ζ = e3πi/4√τ = (i− 1)√τ /√2.

This gives for I1

(i − 1)√τ

∞

(−idτ )

√2
dτ√τ e−τ

I1(ξ) =

1

(i + 1)

ξ3/2 Z 0
√2ξ3/2 Z 0
√π(i + 1)
23/2ξ3/2 .
= −

=

∞

e−τ

(A3)

For the second integral I2(ξ) we choose the real positive variable τ such that ζ =

e−πi/2τ = −iτ , which means that √ζ = e−πi/4√τ = (1 − i)√τ /√2 and

1ζ

+

+ 

4Aζ

FIGURE 12. Complex plane ζ. The wavy line indicates the cut. The deformed integration
contour consists of two paths, C1 and C2, corresponding to the integrals I1 and I2, respectively.

I2(ξ) =

1

ξ3/2 Z ∞

0

(1 − i)√τ

√2

e−τ

(−idτ )

= I1(ξ).

Hence

I(ξ) = I1(ξ) + I2(ξ) = −

√π(i + 1)
21/2ξ3/2 .

Substituting this equation into Eq. (17) gives Eq. (18).

(A4)

(A5)

