3
0
0
2
 
r
a

M
 
6
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
2
2
0
3
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Chaos and the Continuum Limit in Nonneutral Plasmas and Charged Particle Beams

Henry E. Kandrup∗
Department of Astronomy, Department of Physics,
and Institute for Fundamental Theory, University of Florida, Gainesville, FL 32611

Ioannis V. Sideris†
Department of Physics, Northern Illinois University, DeKalb, IL 60115

Courtlandt L. Bohn‡
Department of Physics, Northern Illinois University, DeKalb, IL 60115 and
Fermilab, Batavia, IL 60510
(Dated: February 2, 2008)

This paper summarises an investigation of discreteness eﬀects and the continuum limit for time-
independent, nearly collisionless N -body systems of charged particles interacting via an unscreened
1/r2 force, allowing for bulk density distributions corresponding to potentials that admit both
regular and chaotic orbits. Both for orbit ensembles and for individual orbits, for N → ∞ there
is a smooth convergence towards a continuum limit. At least for moderately large values of N
discreteness eﬀects are extremely well modeled by Gaussian white noise with energy relaxation time
tR, and hence diﬀusion constant D, consistent with the scaling tR ∝(N/ ln Λ)tD, with Λ the Coulomb
logarithm and tD a natural ‘dynamical’ time scale, as predicted by a Fokker-Planck description.
Discreteness eﬀects accelerate emittance growth for an initially localised ensemble of orbits (‘clump’).
However, even allowing for discreteness eﬀects one can distinguish clearly between orbits which, in
the continuum limit, feel a regular (nonchaotic) potential, so that emittance grows as a power law
in time, and chaotic orbits, for which the emittance grows exponentially. For suﬃciently large
N , one can implement a clear distinction between two diﬀerent ‘kinds’ of chaos acting in N -body
systems. Short range microchaos, associated with close encounters between individual charges,
is a generic feature of the N -body problem, giving rise to large positive Lyapunov exponents χN
which do not decrease with increasing N even if the bulk potential is integrable. Alternatively,
there is the possibility of larger scale macrochaos, characterised typically by somewhat smaller
Lyapunov exponents χS, which will be present only if the bulk potential admits global stochasticity.
Conventional computations of the largest Lyapunov exponent provide estimates of χN , leading to
the oxymoronic conclusion that N -body orbits which look nearly regular and have sharply peaked
Fourier spectra are ‘very chaotic.’ However, the ‘range’ of the microchaos is set by the typical
interparticle spacing which, as N increases, becomes progressively smaller, so that, for suﬃciently
large N , this microchaos, albeit very strong, is largely irrelevant macroscopically. A more careful
numerical analysis allows one to derive estimates of both χN and χS.

I.

INTRODUCTION AND MOTIVATION

To what extent can a ‘nearly collisionless’ N -body sys-
tem such as a nonneutral plasma or a charged particle
beam be modeled by a smooth density distribution and
a smooth bulk potential, either statistically or at the level
of individual orbits? In particular, is there a well deﬁned
N
continuum limit? The idealisation of a smooth
potential is extremely convenient, both conceptually and
computationally. However, as noted, e.g., by beam dy-
namicists [1], it is not completely clear when – or if –
such an idealisation is justiﬁed.

→ ∞

Even assuming that there is a well-deﬁned continuum
limit, how large must N be before the continuum ap-
proximation is justiﬁed? And to what extent can residual
discreteness eﬀects be modeled in the context of a Fokker-
Planck description? The conventional Fokker-Planck de-
scription [2][3] was formulated to extract statistical prop-
erties of orbit ensembles and distribution functions over
long time scales, assuming implicitly that the bulk po-

tential is regular. To what extent, then, can Langevin
realisations [4] of a Fokker-Planck equation yield reliable
information about individual orbits over comparatively
short time scales, particularly if the orbits are chaotic?

This is an issue of practical importance for systems like
high intensity charged-particle beams. In older, low in-
tensity beams, the contribution of the space charge to the
total potential is comparatively minor compared to the
conﬁning magnetic ﬁeld, but in high intensity beams the
space charge can become extremely important. To what
extent, then, is one justiﬁed in idealising the space charge
by a smooth density distribution that generates a smooth
macroscopic potential? Is it, e.g., really legitimate to ig-
nore discreteness eﬀects entirely in a bunch comprised of
1010 protons with a transverse emittance of a few

109
∼
microns?

−

The situation is especially suspect in that experience
with ‘nearly collisionless’ self-gravitating systems [5] in-
dicates that the continuum limit must be subtle. One
, orbits in an N -body system
believes that, for N

→ ∞

will in fact converge towards characteristics in the cor-
responding smooth potential. However, N -body orbits
evolved in a density distribution corresponding to an in-
tegrable potential are typically ‘very chaotic’ with large
positive Lyapunov exponents even though the integrable
characteristics have vanishing Lyapunov exponent!

For ﬂows in smooth potentials, it is straightforward to
distinguish macroscopically between phase mixing asso-
ciated with regular versus chaotic orbits [6]. In particu-
lar, chaotic ﬂows tend to mix exponentially fast, whereas
regular ﬂows only mix as a more modest power law in
time. Will this distinction persist in N -body systems?
One might, e.g., worry that if N -body orbits correspond-
ing to integrable characteristics have large positive Lya-
punov exponents, ‘regular’ ﬂows comprised of such orbits
would exhibit behaviour resembling chaotic phase mixing
in smooth potentials! Understanding the bulk properties
of phase mixing in N -body systems is important, e.g., in
light of recent grid code simulations [7] indicating that
chaotic phase mixing may be responsible for ‘anomalous
relaxation’ observed in charged-particle beams, including
the University of Maryland ‘ﬁve beamlet’ experiment [8].
A complete resolution of these issues will require an
analysis of ‘honest’ (i.e., direct summation [9]) numerical
integrations for systems comprised of very large particle
number N , which is not yet practical. However, consid-
erable insight may be derived by considering the simpler
case of orbits and orbit ensembles evolved in ‘frozen-N ’
systems, i.e., time-independent N -body systems gener-
ated by randomly sampling a speciﬁed smooth density
distribution. In particular, by comparing orbits in such
frozen-N systems with characteristics with the same ini-
tial condition evolved in the corresponding smooth po-
tential, one can quantify the extent to which, as a func-
tion of N , N -body orbits and smooth potential charac-
teristics actually coincide. Such is the objective of this
paper.

Section II focuses on the behaviour of orbits and or-
bit ensembles in frozen-N realisations of two simple po-
tentials, one integrable and the other almost completely
chaotic. The principal conclusions here are (i) that there
is a well-deﬁned macroscopic convergence towards the
continuum limit, both for individual orbits and for or-
bit ensembles, and (ii) that discreteness eﬀects can be
extremely well-mimicked by Gaussian white noise in the
context of a Fokker-Planck or Langevin description.

Section III considers the more realistic ‘thermal equi-
librium model’ [10], well known from beam dynamics.
For appropriate choices of parameter values, this model
admits [11] large measures of both regular and chaotic
orbits, so that one encounters a new feature [12], namely
transitions between regular and chaotic behaviour trig-
gered by discreteness eﬀects. As for the simpler models
considered in Section II, one observes clear distinctions
between regular and chaotic phase mixing, although dis-
creteness eﬀects, again well modeled by a Fokker-Planck

2

description, can be surprisingly important. Even when N
is large, individual orbits can exhibit frequent changes in
behaviour corresponding macroscopically to transitions
between regularity and chaos; and the scaling implict
in a Fokker-Planck description suggests that, for chaotic
109
orbits, even a total particle number as large as N
∼
may not be large enough to justify a continuum limit.

Section IV focuses on Lyapunov exponents and the
meaning of chaos in N -body systems. The principal con-
clusion here is that two distinct ‘types’ of chaos can be
present in the N -body problem, characterised by two dif-
ferent sets of Lyapunov exponents associated with physics
on diﬀerent scales. Close encounters between particles
trigger microchaos, a generic feature of the N -body prob-
lem, which leads to large positive Lyapunov exponents
χN . If, however, the bulk smooth potential is chaotic, one
also encounters macrochaos, which is again characterised
by positive, albeit typically much smaller, Lyapunov ex-
ponents χS. N -body realisations of integrable systems
remain chaotic, even for large N , in the sense that χN
does not decrease towards zero for N
. Despite this,
however, microchaos becomes progressively less impor-
tant macroscopically in that the range of this chaos, i.e.,
the scale on which the microchaos-driven exponential di-
vergence of nearby orbits terminates, decreases with in-
creasing N .

→ ∞

Section V summarises the principal conclusions and

speculates on potential implications.

II. N -BODY FLOWS AND N -BODY ORBITS IN
REGULAR AND CHAOTIC POTENTIALS

A. Models considered

The computations described in this Section were per-
formed for two models which, albeit not representative of
‘real’ equilibrium systems, are of signiﬁcant pedagogical
value in illustrating the nature of the continuum limit.
In particular, since one model is integrable and the other
almost completely chaotic, it is simple to identify sep-
arately how discreteness eﬀects impact regular versus
chaotic orbits, an issue that becomes more diﬃcult in
‘realistic’ systems which admit a complex coexistence of
both regular and chaotic orbits.
Model 1. A constant density triaxial ellipsoid, for which

ρ(r) =

3Q

4πabc × (cid:26)

1
0

if m2
1,
if m2 > 1,

≤

(1)

with

For m

≤

2

m

y2
b2 +
1, this corresponds to a space-charge potential

x2
a2 +

z2
c2 .

=

(2)

Φsc(r) = Φ0

1
2

−

ax2 + ω2
ω2
(cid:0)

b y2 + ω2

c z2

(3)

(cid:1)

with Φ0 a constant and frequencies ωa, ωb, and ωc re-
lated to the axis values a, b, and c in terms of incomplete
elliptic integrals. The system was assumed conﬁned by
an external potential Φext =
2Φsc. It follows that, in
the continuum limit, each charge evolves in an integrable
time-independent potential of the form (modulo a con-
stant)

−

Φreg(r) =

2
2
ax

+ ω

2

2
b y

+ ω

2

2
c z

(4)

(cid:1)

1
2

ω
(cid:0)

∼

10.

0.4663, ωb ≈

Attention focused primarily on the parameter values a =
1.95, b = 1.50, and c = 1.05, which, assuming units for
which Q
0.5508,
1, implies [13] that ωa ≈
≡
and ωc ≈
0.6753. It follows that the orbital time scale
2π/ω
tD ∼
Because this potential is integrable, one knows that,
in the continuum limit, only regular phase mixing is pos-
sible. However, the situation is even more exceptional:
because of the harmonic character of the potential, i.e.,
the fact that the force is linear, every charge will orbit
with the same frequencies so that, in the absence of dis-
creteness eﬀects, there can be no systematic phase mixing
and no emittance growth in an initially localised clump.
All emittance growth associated with this potential must
be attributed to discreteness eﬀects.
Model 2. Perturbing Model 1 by introducing a spheri-
cally symmetric, attractive spike of charge near the ori-
gin, which yields a modiﬁed potential

Φcha(r) = Φreg(r)

q
√r2 + ℓ2

−

≈

with ℓ = 10−3. Attention here focused on a central
charge q = 10−1.5Q
0.03162, which leads to a potential
1, the
for which, for orbits restricted energetically to m
phase space is almost completely chaotic [14]. (The bulk
properties of the potential are insensitive to the precise
value of ℓ for ℓ < 10−2 or so; but most of the chaos is
lost for much larger values of ℓ.)

≤

Frozen-N charge density distributions of the form

ρN =

1
N

N

Xi=1

δD(r

ri)

−

(6)

(7)

were generated by randomly sampling the smooth density
distributions ρ. These correspond to N -body potentials

ΦN (r) =

1
N

−

N

Xi=1

1
ri)2 + e2

(r

−

p

which incorporate a tiny softening parameter e [15]. Un-
less otherwise stated, all Figures in this paper were gen-
erated from integrations with e = 10−5.

Orbits were integrated in frozen-N realisations with
106 using a variable time step scheme that conserved
N
the energy of each charge to at least one part in 105. Esti-
mates of the largest (ﬁnite time) Lyapunov exponent [16]

≤

3

were obtained in the usual way by simultaneously track-
ing the evolution of a small initial perturbation, periodi-
cally renormalised at ﬁxed time intervals ∆t.

The eﬃcacy of phase mixing was tested by generat-
ing localised clumps of 1600 initial conditions sampling a
10−3 and evolv-
∆r
phase space region of size
|
ing these into the future in both the smooth potential and
the corresponding N -body potential (7). The resulting
orbital data were analysed to compute emittances

| ∼ |

∆v

| ∼

r2
ǫa ≡ qh
aih
as well as the total

v2
ai − h

ravai

2

(a = x, y, z),

(8)

ǫ = (ǫxǫyǫz)

1/3

.

(9)

The degree to which individual N -body orbits did, or
did not, ‘look highly irregular’ was quantiﬁed by com-
puting the orbital complexity [17] of their Fourier spec-
tra. This entailed determining for each orbit the quan-
tities nx, ny, and nz, deﬁned as the minimum number
of frequencies required to capture a ﬁxed fraction k of
the power in each direction, and then assigning a total
complexity

n(k) = nx + ny + nz.

(10)

In order to obtain a reasonably sharp Fourier spec-
trum, orbital data were typically recorded at intervals
δt = 0.05, a time corresponding to less than 1% of a
typical orbital period.

(5)

B. Regular and chaotic phase mixing

In the continuum limit, initially localised clumps char-
acterised by the integrable potential (4) exhibit no sys-
tematic tendency to disperse. Because each orbit ex-
ecutes harmonic motions with the same three frequen-
cies, the charges remain close together, returning to their
original x0, y0, and z0, after periods τx, τy, an τz. Dis-
creteness eﬀects break this exact periodicity and trigger a
systematic spread. This is illustrated in Figure 1, which
exhibits the x and y coordinates of the same 1600 orbit
ensemble with E = 1.0 at ﬁve diﬀerent times, allowing
for frozen-N backgrounds with N = 103.5 and N = 105.
For N = 103.5, this dispersal is comparatively rapid, the
charges having spread to sample the entire allowable con-
ﬁguration space within t = 128, a time corresponding to
only 10 orbital periods or so. For the larger system with
N = 105, the dispersal is considerably slower, requiring
a time t
512, roughly four times larger, to achieve a
∼
comparable spread.

The situation is very diﬀerent for the potential (5), for
which, even in the continuum limit, the particle phase
space is almost completely chaotic.
In this case, one
observes exponentially fast chaotic phase mixing in the

smooth potential, and allowing for discreteness eﬀects
only accelerates the process. This is evident from Figure
2, which exhibits the x and y coordinates for a 1600 orbit
clump, again with E = 1.0, evolved in frozen-N realisa-
tions with N = 103.5, N = 104.5, and N = 105.5, as well
as (in the right hand column) the smooth potential. Even
128 is suﬃcient for
for the smooth potential, a time t
particles to sample most of the energetically accessible
phase space.

∼

The visual impression that the chaotic clump disperses
far more rapidly can be quantiﬁed by computing the
emittance ǫ as a function of time. The left hand column
of Figure 3 exhibits ǫ(t) for the same ensemble of initial
conditions used to generate Figure 1, now allowing for
frozen-N backgrounds with N = 103.0, 103.5, 104.0, 104.5
and and 105.0. For the smallest value of N it is not com-
pletely clear whether ǫ grows exponentially or as a power
103.5, the growth is dis-
law in time. However, for N
103.5
tinctly subexponential. Indeed, the data for N
are well ﬁt by an emittance growth law

≥

≥

(t/tG)1/2

ǫ

∝

(11)

where

(12)

→ ∞

N tD.

tG ∝
Extrapolating to the limit N
yields the expected
result that there can be no systematic emittance growth.
The left hand column of Figure 4 exhibits analogous
results for the initial conditions used to generate Fig-
ure 2, now plotted on a logarithmic scale, allowing for
N = 102.5, 103.5, 104.5, 105.5, and, in the bottom panel,
the smooth potential. It is evident that, for the smooth
potential, ln ǫ exhibits a roughly linear growth during the
interval (say) 10 < t < 100, corresponding to an expo-
nential growth in emittance. This is hardly surprising.
The fact that individual orbits in the clump are chaotic
implies that they should diverge exponentially so that, at
least for small ǫ(0), one would expect ǫ to grow exponen-
tially at a rate comparable to the value of a typical (ﬁnite
time) Lyapunov exponent χS for the smooth potential.
For this ensemble, the mean exponent for the interval
0 < t < 256 assumed the value
= 0.056, which
corresponds to the slope of the dashed line in panel (i).
Allowing for discreteness eﬀects clearly accelerates the
rate of chaotic phase mixing. For the two smaller values
of N , 102.5 and 103.5, the growth again appears expo-
nential, albeit at a larger rate; but for the systems with
N = 104.5 and 105.5 the evolution is clearly more com-
plex. Indeed, a careful examination of the data for these
two cases suggests strongly that the evolution can be de-
composed into two largely distinct exponential phases,
χS and the
the former characterised by a growth rate
latter by a slower rate
χS. This is consistent with the
analysis to be presented later in Section IV, which indi-
cates that two sorts of chaos can act in N -body systems,

χSi
h

≫

∼

4

large scale macrochaos characterised by a Lyapunov ex-
ponent χS and shorter range microchaos characterised by
χS. (For very small N , the
a Lyapunov exponent χN ≫
microchaos also acts on macroscopic scales, thus over-
whelming any observational eﬀects associated with the
much weaker macrochaos: hence the (near-)absence of
the second exponential phase in panels (a) and (c)!) The
data summarised in Figure 4 are consistent with a second
exponential phase with

N −1/2

exp(χSt),

ǫ

∝

(13)

the form of which will be motivated in Section IId.

The results derived here for Model 2 which, in the
continuum limit, corresponds to a chaotic potential, are
likely generic for bulk density distributions correspond-
ing to a chaotic potential. However, the results for Model
1 are special in that there is no systematic emittance
growth in the continuum limit. If, as one would expect
in a ‘real’ system, the bulk potential exhibits at least
some anharmonicities, regular phase mixing will trigger
linear emittance growth even in the continuum limit. In
this case, allowing for discreteness eﬀects will again ac-
celerate the growth of emittance, but the exact form of
this enhanced growth can be more complex, even though
it will again be subexponential. Section III will exhibit
additional examples of how discreteness can accelerate
emittance growth for both regular and chaotic clumps.

C.

Individual Orbits and the Continuum Limit

The preceding indicates that, as N increases, orbit en-
sembles evolved in frozen-N backgrounds more closely
resemble orbit ensembles with the same set of initial
conditions evolved in the corresponding smooth poten-
tial. This does not, however, necessarily imply that indi-
vidual orbits also converge towards characteristics in the
smooth potential. To what extent, then, is it true that, as
N increases, individual trajectories come to more closely
resemble smooth potential characteristics?

The most obvious – and compelling – check is visual:
do frozen-N orbits ‘look like’ smooth potential charac-
teristics when N becomes suﬃciently large? As a sim-
ple, and extreme, example, consider a constant density
spherical system without a central spike where, in the
continuum limit, Φreg reduces to an isotropic harmonic
oscillator potential; and select an initial condition which,
in the smooth potential, corresponds to a circular orbit.
Results derived from integrations of such an initial con-
dition in diﬀerent frozen-N systems are exhibited in Fig-
ure 5, which shows representative frozen-N orbits gener-
ated for particle number varying between N = 102.5 and
N = 105.5, along with the smooth potential orbit. For
the four smallest values of N , there is no obvious hint
that the orbit ‘should’ be circular or that there ‘should’
be a net sense of circulation, although there is a crude

visual sense that, as N increases, the orbit becomes ‘less
tangled.’ However, for N = 104.5 one starts to discern a
clear sense of net circulation, for N = 105.0 the orbit has
clearly become centrophobic (thus suggesting that angu-
lar momentum is at least approximately conserved), and
for N = 105.5 the orbit arguably resembles a ‘distorted’
or precessing circular orbit.

x(ω)
|
|

As is illustrated in Figure 6, the visual impression that
the orbit is becoming more nearly circular can be cor-
roborated by constructing the Fourier spectra of the or-
bital data. For the three smallest values of N , the quan-
tity
is obviously broad band, although there is a
peak at or near the circular frequency associated with
the smooth potential orbit. For N = 104.0 and 104.5 the
peak becomes appreciably sharper, and for N = 105.0
and 105.5 one sees only slight irregularities in the spectra
which translate into the visual appearance of precession.
The conclusion is obvious: as N increases, frozen-N
orbits come to more closely approximate the smooth or-
bit, both visually and in terms of their power spectrum.
Analogous results obtain for more generic initial condi-
tions evolved in this and other integrable potentials.

Convergence of orbits in terms of their Fourier spec-
tra is important in justifying straightforward applications
of nonlinear dynamics to many-body systems interact-
ing via long range forces. Many physical phenomena
in many-body systems, including accelerator modes [18],
modulational diﬀusion [19], and resonant relaxation [20],
are attributed to resonant couplings between, e.g., the
natural frequencies of individual regular orbits and the
frequency or frequencies associated with some perturba-
tion. However, such applications can only be justiﬁed if
the ‘real’ N -body orbits have frequencies that adequately
approximate the frequencies associated with characteris-
tics in the smooth potential.

The degree of irregularity exhibited by individual or-
bits can be quantiﬁed by computing Fourier complexity,
as deﬁned in Eq. (10). The results of one such investi-
gation are summarised by the curves with diamonds in
Figure 7, which exhibit n(0.95), the mean number of fre-
quencies required to capture 95% of the total power, for
collections of 100 initial conditions evolved in frozen-N
backgrounds with diﬀerent N . (The triangles will be dis-
cussed in the following subsection.) In each case, the ini-
tial conditions were integrated for a time T = 128, with
orbital data recorded at ﬁxed intervals δt = 0.05. The
data were then Fourier analysed using an FFT solver to
translate a set of 2j points into a set of j Fourier am-
plitudes. The upper panel was generated for orbits in
the integrable Model 1, the lower panel for the strongly
chaotic Model 2.
In each panel, the solid curve repre-
sents the mean complexity computed in the unperturbed
smooth potential. Error bars were computed by dividing
the 100 initial conditions in half and analysing each half
separately.

5

≥

∼

→ ∞

ing function of N which converges towards the continuum
value for N
. For smaller values of N , the regular
and chaotic ensembles have comparable complexities, al-
though the regular ensemble is slightly less (
20%) com-
plex. However, for larger values of N there are clear dis-
tinctions between the regular and chaotic ensembles, the
105 being nearly twice as com-
chaotic ensembles for N
plex as the regular ensembles. Indeed, for other choice
of regular models the complexity can be even lower: The
fact that the smooth potential complexity in panel (a) is
as large as it is reﬂects the fact that the regular orbits
used to generate this Figure were relatively complex ‘box’
orbits, with the topology of Lissajous ﬁgures, which, even
in the continuum limit, require two or three frequencies in
each direction to capture as much as 95% of the power. If
instead n(0.95) is computed for an ensemble of initial con-
ditions corresponding to circular orbits, the complexity
converges towards a continuum limit with n(0.95) = 3.

D. Modeling N -body orbits and ﬂows by Gaussian
white noise

Conventional wisdom holds that discreteness eﬀects
can be idealised as friction and Gaussian (nearly) white
noise in the context of a Fokker-Planck description [2].
Taken literally, this suggests that individual N -body or-
bits can be well-mimicked by Langevin simulations. How-
ever, it is not completely clear to what extent this is really
true. The original derivation of the Fokker-Planck equa-
tion (and most if not all of its tests) restricted attention
to the statistical properties of orbit ensembles or distri-
bution functions over comparatively long time scales, as-
suming implicitly that the bulk potential in which the
particle evolves is nonchaotic. Can the friction/noise
paradigm describe correctly short time behaviour and/or
the behaviour of individual orbits, especially in a chaotic
potential?

Granted the validity of a Fokker-Planck description,
a simple rule connects N to the strength of the friction
and noise. Assuming that the noise is characterised by a
temperature per unit mass Θ comparable to the magni-
tude of the particle energy, the coeﬃcient of dynamical
friction η deﬁnes an energy relaxation time tR = η−1.
However, an evaluation of the Fokker-Planck coeﬃcients
in a binary encounter approximation leads to the predic-
(N/ ln Λ)tD, with ln Λ the Coulomb log-
tion that tR ∝
arithm. Given the assumption of a nonneutral plasma,
the treatment of Λ must necessarily be somewhat heuris-
tic [21]. However, there is a general agreement that Λ
should scale as some power of N , so that tR, and hence
the diﬀusion constant D, should satisfy

t−1
R ∝

D

η

∝

∝

ln N
N

.

(14)

It is evident that, in both cases, n(0.95) is a decreas-

The obvious question, then, is whether frozen-N simula-

∝

tions with speciﬁed N can be well-mimicked by Langevin
simulations with η

(ln N/N ).

Two practical issues arise in testing this prediction.
The ﬁrst is that, because of the limited range of N that
can be explored, it is impractical to test the subdominant
ln N dependence: for N < 103 or so, the very notion of
a bulk potential fails; for N > 106 computations become
prohibitively expensive. One must instead restrict at-
N −1,
tention to testing the simpler scaling relation η
i.e.,

∝

ln η = p

ln N,

−

(15)

The second point is more serious. The usual Langevin

for some constant p.

equation reads [4]

d2ra
dt2 =

−∇aΦ

−

η

dra
dt

+ Fa,

(a = x, y, z),

(16)

where ηdra/dt represents a dynamical friction. Fa repre-
sents Gaussian white noise, which is characterised com-
pletely by its ﬁrst two moments:

Fa(t)
i
h

= 0,

(a, b = x, y, z)

and

= 2ηΘδabδD(t1

Fa(t1)Fb(t2)
h
i
2ηΘ the diﬀusion constant entering into a
with D
Fokker-Planck description. By choosing Θ to equal the
initial energy one can ensure that the average energy of
the orbits remains unchanged.

(17)

t2),

−

≡

Such an equation is clearly unsatisfactory here. En-
ergy is conserved absolutely for frozen-N orbits, so that
one must also impose energy conservation on any scheme
which aims to mimic its eﬀects. (For very small η, energy
remains almost conserved for very long times. However,
comparatively small N should correspond to relatively
large η, which implies large changes in energy and, as
such, signiﬁcant changes in the phase space regions ac-
cessible to the noisy orbit.) For this reason, the noisy
integrations described here were performed using a mod-
iﬁed energy-conserving noise [22].

This entailed (1) eliminating the dynamical friction al-
together, (2) again imparting random kicks as in Eq. (17),
but (3) renormalising the modiﬁed velocity at each time
step by an overall factor, i.e., v(t + δt)
αv(t + δt),
with α so chosen that E(t + δt) = E(t). Modulo this
complication, the noise was integrated using a standard
algorithm [23] based on a fourth order Runge-Kutta in-
tegration scheme with ﬁxed time step δt. The integra-
10−4, it having been
tions were performed for δt = 2
conﬁrmed that the statistical eﬀects of the noise were
insensitive to the precise value of δt for δt < 10−3.

→

×

At the level of orbit ensembles, as probed by the emit-
tance and other bulk moments, the results of frozen-
N simulations are in fact extremely well-mimicked by

6

Langevin simulations, at least for comparatively large N .
The degree to which this is true can be inferred by con-
trasting the right and left hand columns of Figures 3 and
4. As discussed already, the left hand columns of Figures
3 and 4 exhibit, respectively, time-dependent emittances
for Models 1 and 2, allowing for several diﬀerent values
of N . The right hand panels exhibit data generated from
Langevin integrations of the same initial conditions, al-
lowing for amplitudes η satisfying Eq. (15) with p = 0.5,
so that, e.g., N = 105.5 corresponds to η = 10−5.0. For
the smallest values of N (and hence the largest values of
η) – corresponding to panels (a) and (b) in Figure 3 and
panels (a) - (d) in Figure 4, the agreement is not all that
103.5
good. However, for larger particle number – N
104.5 for the chaotic sys-
for the regular system and N
tem –, the agreement is obviously quite good.

≥

≥

∼

The bottom right hand panel in Fig. 4 was generated
for orbits evolved with a considerably smaller value of
η, namely η = 10−7.5, this corresponding to the largest
noise amplitude that does not alter appreciably the emit-
tance growth observed in the smooth potential. To the
extent that the scaling of Eq. (15) is in fact correct for
0.5, the fact that larger values of η have an apprecia-
p
ble eﬀect on emittance growth implies that, even over an
interval as short as t = 128, corresponding to
10 orbital
time scales tD, one requires N > 107 to justify a contin-
uum limit! Even though the collisional relaxation time
tD, discreteness eﬀects can be
scale tR ∝
(N/ ln N )tD ≫
106.5 on a time scale as
important in a system with N
10tD.
short as

∼

≈

∼

As is evident from Figure 7, this agreement also ex-
tends to the level of individual orbits. As described
already, the diamond curves in this Figure were de-
rived from frozen-N integrations. The other curves,
constituted of triangles, were generated from exactly
the same initial conditions, now integrated, however, in
the smooth potential while being subjected to energy-
conserving Gaussian noise with Θ = E and variable η. To
the extent that conventional Fokker-Planck theory is cor-
rect, one would anticipate a correspondence between N
and η of the form given by Eq. (15). The noisy points in
Figure 7 were in fact identiﬁed with the frozen-N points
assuming the validity of the scaling (15) with p = 0.6.
is that, given this identiﬁca-
The obvious fact, then,
tion, the curves n(N ) and n(η) rather nearly coincide.
Even at the level of the complexity of individual orbits,
frozen-N orbits can be well-mimicked by noisy orbits with
ln η + ln N = const.

Granted that discreteness eﬀects can be mimicked by
Gaussian white noise, the scaling relations (11) and (13)
are easily understood. At least for a harmonic potential,
it is straightforward to derive analytic solutions to the
Langevin equation (16) for moments like
[3].
Alternatively, it is easily seen that the Fokker-Planck
equation associated with Eq. (16) implies that the clump

xvxi
h

x2
h

or

i

7

(24)

(25)

(26)

emittance satisﬁes

dǫ2
x
dt

= 2ηΘ + 2η

x2

v2

xv

2

.

(18)

i

(cid:17)

ih

v2

i − h

(cid:16)h
Assuming, however, that the initial emittance is ex-
tremely small, at early times one can approximate that
x2
; and, to the extent that the growth time
h
is long compared with the characteristic crossing time,
= E/ω2,
one can average over oscillations to set
with E the initial energy. It then follows that, for early
times,

x2
h

i ≈ h

xv

ih

i

i

2

The additional assumption is that the particles can be
characterised by a one-particle distribution function of
E/kBT ), with
the Maxwell-Boltzmann form, f
kBT the temperature. This implies a bulk number den-
sity satisfying

exp(

∝

−

n(x) = n(0) exp

1
2 m(ω

x)2
·
kBT

−

−

(cid:20)

qφ(x)

(cid:21)

(22)

where φ(x) is deﬁned implicitly as a function of n via the
relations (in mks units)

(19)

2φ(x) =

∇

q
ε0

−

n(x),

φ(0) =

φ(0) = 0.

(23)

∇

Following, e.g., [11], the problem can be cast into di-
mensionless form by expressing length and frequency in
units of the Debye length and plasma frequency, i.e.,

ǫx ≈ (cid:16)

2EΘηt
ω2

(cid:17)

1/2

.

Combining Eq. (19) and the analogous formulae for ǫy
and ǫz with the scaling relation η
1/N leads immedi-
ately to Eq. (11). The same diﬀusive t1/2 behaviour also
arises for δrrms and δvrms.

∝

A somewhat more heuristic argument can account for
the scaling (13) associated with a chaotic potential. If
the initial emittance ǫ(0) = 0, it is clear that, in the ab-
sence of discreteness eﬀects, ǫ(t) would continue to vanish
identically: two smooth integrations of the same initial
condition will not yield divergent orbits, even if the orbits
are chaotic. However, discreteness eﬀects act to ‘kick’ two
nearly coincident orbits apart, at which point they will
tend to diverge at a rate set by the Lyapunov exponent
χS associated with the bulk potential. Assuming, how-
ever, that the ‘kicks’ are random, their eﬀects will scale
as η1/2 rather than η; but combining this with Eq. (15)
implies that [24]

δvrms ∝
Eq. (13) follows since ǫ scales as δrrms and δvrms.

δrrms ∝

N −1/2 exp(χSt).

(20)

III. THE THERMAL EQUILIBRIUM MODEL

A. Deﬁning the model

Consider now a more realistic example, the thermal
equilibrium model [10], which, in the continuum limit,
admits large measures of both regular and chaotic or-
bits [11]. This model allows for a collection of N identi-
cal charged particles, interacting electrostatically, that is
constrained by linear restoring forces to manifest triax-
ial symmetry, the focusing forces in diﬀerent orthogonal
directions being characterised in general by unequal fre-
quencies. Individual particles thus have energy

E =

mv2 +

m(ω

x)2 + qφ(x),
·

1
2

1
2

(21)

where x and v denote particle position and velocity, m
and q denote the mass and charge, ω = (ωx, ωy, ωz) rep-
resents the three frequencies associated with the focusing
force, and φ(x) is the collective space-charge potential.

2
D =
λ

ε0kBT
n(0)q2 ,

ω

2
p =

n(0)q2
ε0m

,

and by introducing a dimensionless potential

Φ(x) =

qφ(x)
kBT

.

With appropriate rescaling, the net result is a density
distribution of the form

n(x) = exp

Ω2R2(x)

1
2

(cid:20)−

Φ(x)
(cid:21)

,

−

where

2
∇

Φ(x) =

n(x),

−

Φ(0) =

Φ(0) = 0.

(27)

∇

Here Ω2 = (ωy/ωp)2 and R2 = (x/a)2 + y2 + (z/c)2, in
terms of scale lengths a and c satisfying a = ωy/ωx and
c = ωy/ωz . The minimum permissible focusing strength
corresponds to

Ω = Ωu = 1/

(1/a2) + 1 + (1/c2).

(28)

p

The experiments described here were performed assum-
ing parameter values a2 = 0.5, c2 = 1.5, and Ω =
1.0001/√3, for which a typical orbital time scale tD ∼
20.
These parameters represent a beam that is moder-
ately, but not strongly, dependent on space charge. Con-
sider, for example, a proton bunch with 1 µm root mean
squared normalised emittance spanning 3 cm full ‘ra-
dius’. If the bunch is described by the thermal equilib-
2 mm and the bunch
rium model, the Debye length is
109 protons, this corresponding
population is the
to a bunch charge

3
×
0.5 nC.

∼

In general it does not appear possible to solve eqs. (26)
and (27) analytically. This makes both the generation of
N -body realisations of the density and the computation
of orbits in the smooth potential much more diﬃcult.
However, these diﬃculties can be, and were, resolved

∼
∼

using numerical techniques described in [11]. In princi-
ple, the accelerations for the N-body thermal equilibrium
model should be given by

¯a =

1
2

−∇h

Ω2R2 +

1
4π

N
Nm

N

Xi=1

1
ri|

r
|
p

−

(29)

2 + e2

i

with N the number of frozen particles and Nm satisfying

Nm =

∞

Z

−∞

d3r exp

Ω2R2

1
2

(cid:20)

Φ(r)
(cid:21)

.

−

(30)

In practice, however, one cannot perform this integral,
even numerically, since Φ was only evaluated on a ﬁ-
nite grid. For this reason, the integral was ﬁrst solved
with limits coinciding with the grid boundaries, but then
renormalised by a small constant factor so that plots of
the potential and density in the smooth and frozen-N
conﬁgurations overlapped perfectly.

B. Regular and chaotic phase mixing

∝

The top four left hand panels of Fig. (8) exhibit emit-
tance growth for an initially localised orbit ensemble
evolved in frozen-N realisations of the thermal equilib-
rium model, selected with energy suﬃciently small that
the constant energy hypersurface in the smooth poten-
tial is completely regular. Since the size of the accessible
phase space is roughly ten times larger than was the case
for the oscillator models, the initial conditions sampled a
10−2. It is evident
region ten times larger,
that, as for the integrable oscillator model considered in
Section II, the emittance growth is power law rather than
exponential; and, at least for N = 105.5 and N = 106.0,
it is well ﬁtted by a growth law ǫ

∆r
|

t1/2.

| ∼ |

| ∼

∆v

The bottom left panel exhibits emittance growth for
the same orbit ensemble evolved in the smooth poten-
tial. Here the evolution is clearly linear, rather than
square root, the expected behaviour for smooth orbits
in generic integrable potentials where nearby initial con-
ditions correspond to slightly diﬀerent orbital frequen-
cies.
(Recall that, for the oscillator Model 1, there is
zero emittance growth in the continuum limit.) That ǫ
grows much faster for the frozen-N model with N = 106.0
than for orbits in the smooth potential indicates clearly
that, for the thermal equilibrium model, N = 106.0 is not
a suﬃciently large particle number to justify a continuum
approximation, even over an interval as short as t = 512.
The top four right hand panels demonstrate that dis-
creteness eﬀects can again be well-mimicked by energy-
conserving Gaussian white noise with Θ = E and N
and η related as in Eq. (15) although, in this case, the
0.5. The bottom
1.5, rather than p
best ﬁt value p
right panel exhibits the emittance growth for an ensem-
ble evolved with η = 10−6.5, the largest noise amplitude
that does not signiﬁcantly alter emittance growth in the

≈

≈

8

∼

smooth potential. Presuming that the scaling (15) can
again be extended to larger N and smaller η, one infers
that, for the purpose of predicting emittance growth in
this regular ensemble, the smallest value of N for which
the continuum limit can be justiﬁed is N

108.

Figure 9 exhibits analogous data for a higher energy en-
semble which, in the continuum limit, corresponds com-
pletely to chaotic orbits.
It is evident that, as for the
chaotic model in Section II, the evolution is exponential
overall, rather than power law; and that discreteness ef-
fects again have an important eﬀect. Also evident from
a comparison of left and right hand panels is that, as for
regular orbits, discreteness eﬀects can be well-mimicked
by noise with N
1.5. Most striking, how-
ever, is the fact that, in this case, even much weaker noise
can accelerate emittance growth appreciably. For this
chaotic ensemble, discreteness eﬀects must correspond to
a noise amplitude satisfying η < 10−8.0 or so before a con-
tinuum limit can be justiﬁed. Chaotic orbits are far more
susceptible to low amplitude noise than are regular orbits.
Presuming again that the scaling relation (15) holds, this
implies that for the case of chaotic orbit ensembles, the
continuum limit cannot be justiﬁed for N < 109.5.

1/η and p

≈

∝

This, coincidentally, is roughly the number of parti-
cles in the equilibrium proton bunch described in Sec.
III A. Accordingly, in studying the dynamics of beams
with moderate space charge, one may not be able to as-
sume the validity of the continuum limit with complete
conﬁdence, even for a system in equilibrium. The situ-
ation may be even more problematic for a beam that is
signiﬁcantly out of equilibrium, since the resulting time-
dependent potential would be expected to generate a
larger population of chaotic orbits [25].

C. Transitions between regular and chaotic
behaviour

At very low energies, where the total potential is nearly
harmonic, all smooth potential orbits are regular, so that
discreteness eﬀects can only act to deﬂect frozen-N or-
bits from one regular trajectory to another. However, at
higher energies the smooth potential admits a complex
coexistence of regular and chaotic orbits. This implies
the possibility that discreteness eﬀects can deﬂect frozen-
N orbits from regular to chaotic characteristics and vice
versa [12]. Of obvious interest then is how fast, as a
function of N , such transitions occur.

For example, an accelerator designer relying on the
Vlasov equation and an analysis based on a smooth,
macroscopic potential would neglect these microscopic
transitions and their corresponding impact on chaotic
mixing. Thus the physics of collective relaxation and
global emittance growth would be improperly modeled
and the results, at least in principle, would be suspect.
The consequences of such an omission depend on the

problem at hand, but one might expect them to be es-
pecially severe for nonequilibrium beams where chaotic
dynamics is likely to be more prevalent [25].

If one selects a localised ensemble of initial conditions
corresponding to regular orbits in the smooth potential
and integrates these initial conditions into the future,
discreteness eﬀects will, if suﬃciently strong, eventually
trigger transitions from regularity to chaos. That such
transitions actually occur can be determined by a visual
inspection of individual frozen-N orbits which can be ob-
served to become abruptly ‘more irregular’ in appear-
ance.
If, moreover, large numbers of transitions occur
over very short times, this can make the emittance asso-
ciated with an initially localised ensemble, which ought
to grow as a power law in time, exhibit instead a more
rapid, roughly exponential, increase.

However, an accurate determination of the relative
fraction of the orbits which are still regular requires a
more careful analysis. This was done by recording the
phase space coordinates of individual frozen-N orbits at
various times t > 0, and evolving these into the future
in the smooth potential to determine whether the result-
ing smooth potential characteristics were still regular or
whether instead they had become chaotic. The most
straightforward fashion in which to determine whether
the orbits are chaotic would have been to compute an
estimate of the largest (ﬁnite time) Lyapunov exponent.
Given, however, that the potential cannot be expressed
in terms of elementary functions, this would have proven
extremely expensive computationally. For that reason,
distinctions between regularity and chaos were based in-
stead on the computed complexities of the characteris-
tics. As discussed elsewhere (e.g., [11], [17], and refer-
ences cited therein), such a criterion typically coincides
almost exactly with more conventional criteria based on
Lyapunov exponents.

Presuming that the system is ergodic and that dis-
creteness eﬀects are suﬃciently strong that they can in
principle convert any orbit from regular to chaotic, and
vice versa, it would seem clear what such an analysis
ought to reveal. (1) At suﬃciently late times, indepen-
dent of N the relative fraction of chaotic orbits generated
from any initial ensemble should (to within statistical un-
certainties) coincide with the relative measure of chaotic
orbits on the constant energy hypersurface, i.e., to the
relative volume of the chaotic portions of the constant
energy hypersurface. (2) Assuming, however, that dis-
creteness eﬀects are more important for smaller N , the
time required to converge towards this asymptotic value
should be an increasing function of N . As N increases,
transitions should become more rare.

As illustrated in Fig. 10, which summarises computa-
tions with particle number between 104.5 and 106.0, this
expectation was in fact conﬁrmed. For frozen-N sys-
tems with number as small as N = 104.5, nearly 40% of
the orbits in an initially regular ensemble had become

9

∼

chaotic within a time t = 64, a time corresponding to
only
3tD, and the relative measure f of chaotic orbits
appears to have asymptoted towards a time-independent
value by t = 128. The relative measure of chaotic orbits
for computations with N = 105.0 grew more slowly in
time; but, by t = 512, the relative measure had again
0.4. For larger values of N , f re-
approached a value f
mains a monotonically increasing function of time, but
transitions are suﬃciently rare that one does not ap-
proach an equilibrium population within a time as short
as t = 512

25tD.

∼

∼

IV. LYAPUNOV EXPONENTS FOR
MICROCHAOS AND MACROCHAOS

A. Ordinary Lyapunov exponents

As N increases, frozen-N orbits come to more closely
resemble smooth potential characteristics generated from
the same initial condition, both visually and in terms of
their Fourier spectra. One might therefore expect that,
at least for a regular, i.e., nonchaotic, smooth potential,
the value of the largest Lyapunov exponent χN should
decrease with increasing N and converge towards zero
for N
. Such, however, is not the case. Rather, as
is also true for gravitationally interacting systems of par-
ticles [22], for both regular and chaotic orbits the value
of χN is comparatively insensitive to N ; and there are
even indications that χN might increase with increasing
N .

→ ∞

Figure 11 exhibits the value of the largest Lyapunov ex-
ponent χN as a function of N for a single initial condition
evolved in frozen-N integrations with softening parame-
ters varying between e = 10−5 and e = 10−1. Figure 12
exhibits the same data, now plotting χN as a function of
e for diﬀerent values of N . In both Figures, each point
was generated by integrating the same initial condition
used to generate Figures 5 and 6 for a total time t = 256
in 10 diﬀerent frozen-N realisations of Model 1. In the
continuum limit this initial condition corresponds to an
integrable circular orbit with vanishing Lyapunov expo-
nents; and, as was evident from Figure 5, the frozen-N
orbits for larger N look much more regular in appear-
ance than do the orbits with smaller N . Despite this,
however, at least for the smallest values of e, χN does
not decrease with increasing N . As probed by χN , orbits
with N = 102.5 and 105 are comparably chaotic!

However, for larger values of e, χN does decrease with
increasing N . That this should be the case is easily un-
derstood. Because the bulk potential is integrable, the
chaos must at some level be associated with close en-
counters between nearby charges; but introducing a soft-
ening parameter de facto ‘turns oﬀ’ encounters on scales
shorter than e. If the charge density is suﬃciently large
that encounters with separation < e become common,

the simulation will have artiﬁcially, and erroneously, re-
duced this source of chaos, yielding a smaller χN .

0.056.

That the value of χN for nearly unsoftened frozen-
N integrations is insensitive to whether the smooth po-
tential is regular or chaotic is illustrated in Figure 13,
which exhibits χN as a function of N for integrations
with e = 10−5 for the same initial condition integrated
in both Models 1 and 2. That Figure also emphasises
another important point, namely that χN is typically
larger than any Lyapunov exponent χS associated with
motion in the smooth potential by an order of magnitude
or more. For this particular initial condition, χN ≈
0.82
whereas χS ≈
That χN should be insensitive to the choice of N , at
least for unsoftened simulations, might seem rather cu-
rious. However, it is not hard to understand why this
might be so for a 1/r2 force. Given that the microchaos
disappears completely in the continuum limit, it would
seem clear that it must be associated with a sequence of
‘random’ interactions between a ‘test’ charge and a col-
lection of ‘ﬁeld’ charges. However, this suggests that the
χ−1
Lyapunov time t∗
N associated with the growth of
a small initial perturbation can be estimated by consid-
ering tidal eﬀects associated with a pair of charges sepa-
rated by a distance r comparable to (some ﬁxed fraction
of) the typical interparticle separation rsep. This tidal
acceleration scales as

≡

d2δr
dt2 = (δr

)a

·∇

∝

q
r3
sep

δr

≡

δr
t2
∗

,

(31)

n−1/3

with q the magnitude of an individual charge. Given,
N −1/3Rsys, with Rsys the
however, that rsep ∼
∼
size of the system and n a characteristic number density,
and that q = Q/N , with Q the total charge, it follows
that the time scale t∗, and hence χN , should be indepen-
dent of N . As N increases, the sizes of the individual
charges and the cube of the typical interparticle separa-
tion both decrease as N −1, so that the ratio is indepen-
dent of particle number.

A more careful argument [26] actually allows one to
prove analytically that, in the absence of softening, χN
cannot decrease towards zero with increasing N . For
simple geometries, an analytic expression for the average
value of the stability matrix entering into the deﬁnition
of χN can be formulated in terms of a 3N -dimensional
integral. This integral cannot be evaluated analytically,
but one can derive rigorous bounds which ensure that
the largest eigenvalue remains positive even for N
;
→ ∞
and, even more strikingly, Monte Carlo evaluations of the
integrals suggests that χN should be a slowly increasing
function of N . In other words, viewed in terms of χN ,
orbits become more chaotic as N increases, even though,
for the case of a regular potential, they become more
regular in appearance! [27]

The obvious inference is that N -body Lyapunov expo-
nents χN do not provide a useful characterisation of the

10

degree of chaos associated with an orbit, at least when
that orbit is viewed macroscopically.

B. Microchaos and macrochaos in the N -body
problem

That frozen-N orbits have large positive Lyapunov ex-
ponents χN , even for the case of an integrable potential,
but that distinctions between regular and chaotic poten-
tials are clearly manifested in the phase mixing of ini-
tially localised clumps would suggest that there are two
diﬀerent, and comparatively distinct, potential sources of
chaos in the N -body problem.

On the one hand, one would expect microchaos, trig-
gered by close encounters between individual charges,
which is manifested only on very short scales, comparable
to, or perhaps somewhat larger than, the typical inter-
particle spacing. This source of chaos should be generic
to the N -body problem, irrespective of the form of the
bulk potential, generating randomness qualitatively sim-
ilar to what arises in pinball. On the other hand, there
is also the possibility of larger scale macrochaos, which
would be expected if and only if the bulk potential admits
global stochasticity.

∼

If these expectations are in fact correct, two nearby
initial conditions evolved in a frozen-N realisation of any
χN un-
potential should diverge exponentially at a rate
til their separation becomes somewhat larger than a typ-
ical interparticle spacing, at which point the microchaos
would ‘turn oﬀ.’ If the bulk potential is regular, no other
source of chaos could act and the two orbits would con-
tinue to diverge as a more modest power law. If, however,
the bulk potential is chaotic, macrochaos would still act,
resulting in a continued exponential divergence, albeit at
χS typically much smaller than χN . In this case,
a rate
exponential divergence should be replaced by a power law
divergence only once the separation has become macro-
scopic.

∼

This three-stage evolution for chaotic orbits is clearly
illustrated in Figure 14, which exhibits data for frozen-N
simulations with N = 105.0, 105.5, and 106.0. The three
curves in that ﬁgure were each generated by selecting
50 ﬁducial initial conditions in a phase space region of
10−4 and 50 perturbed initial conditions that
size 5
were subjected to a displacement δx = 10−5, evolving
each initial condition into the future and computing as a
function of time the phase space separation [29]

×

(32)

p|

2.
|

δZ =

δv
|

δr
2 +
|
That δZ experiences two distinct stages of exponential
evolution, at very diﬀerent rates is especially evident in
the curve with N = 106.0. The solid lines accompanying
that curve have slopes 0.82 and 0.056, corresponding, re-
spectively, to the mean values of the N -body χN and the
smooth potential χS for those initial conditions.

As N increases, the initial exponential phase termi-
nates for smaller values of δZ. The microchaos responsi-
becomes
ble for this ﬁrst phase will ‘turn oﬀ’ when
large compared with a typical interparticle spacing, but
that interparticle spacing scales as N −1/3.

δr
|
|

Figure 15 shows the analogue of Figure 14, now gen-
erated for regular initial conditions in the thermal equi-
librium model. Once again there is an initial exponential
growth at a rate comparable to χN , but in this case there
is no evidence of a second exponential phase. Rather, the
initial exponential phase is followed immediately by an
interval of power law divergence.

One other point, not obvious from these Figures, is
that the scaling with N observed for the ﬁnal power law
phase is diﬀerent for the regular and chaotic systems.
For regular orbits, the phase space separation δZ, like
δr
, satisﬁes a linear growth law
|
|
|

δv
|

and

with

δZ(t)

(t/tG),

∝

N −1/2tD.

tG ∝

tG ∝

(1/ ln N )tD.

(33)

(34)

(35)

For chaotic orbits, one ﬁnds that δZ again grows linearly
in time, but that the growth time

C. Alternative interpretations of Lyapunov
exponents

The standard deﬁnition of Lyapunov exponents implies
that they probe the average rate of divergence for two
nearby chaotic orbits in a single system. However, for
the N -body problem, Lyapunov exponents also quantify
two other eﬀects which, as a practical matter, are of equal
importance:
1. Lyapunov exponents probe the rate at which orbits
generated from the same initial condition but evolved in
two diﬀerent frozen-N systems diverge from one another.
2. Lyapunov exponents probe the rate of divergence asso-
ciated with orbits evolved from the same initial condition
in both a frozen-N system and in the smooth potential.

This means that Lyapunov exponents also provide in-
formation about the degree to which characteristics gen-
erated in the smooth potential can be interpreted as pro-
viding a pointwise approximation to real frozen-N orbits
with the same initial condition, as well as the degree to
which orbits in two diﬀerent frozen-N systems remain
close to one another in a pointwise sense.

This is important at a practical level. In a real exper-
iment one may perhaps be able to ensure that a given
N -body system constitutes (nearly) a fair sampling of
some speciﬁed density distribution, but the details of the
actual N -body distribution are likely inaccessible. Of

11

obvious interest, therefore, are the questions: to what
extent will orbits in two diﬀerent N -body systems coin-
cide? and to what extent do such orbits coincide with
characteristics in the bulk potential associated with the
smooth density distribution?

Figure 16 exhibits the analogue of Figure 14, now
generated by comparing the same 50 initial conditions
evolved in two diﬀerent frozen-N systems. Figure 17
compares orbits in a frozen-N system with orbits in the
smooth potential. In each case, the duration of the initial
interval of especially fast exponential divergence is signif-
icantly reduced, but the second interval with divergence
at a rate

χS is still conspicuous.

It is not hard to understand why the smooth poten-
tial χS provides information about orbits in diﬀerent
frozen-N simulations and/or their relation to orbits in
the smooth potential. As noted already, discreteness ef-
fects can be extremely well-mimicked by noise, at least
mesoscopically. However, after the rapid decay of any
initial transients, multiple noisy realisations of the same
initial condition corresponding to a chaotic orbit typi-
cally diverge exponentially in such a fashion that [24]

∼

δZ

(Θη)1/2 exp(χSt)

N −1/2 exp(χSt),

∝

∝
where the second proportionality follows from the ob-
served scaling η

1/N .

(36)

∝

V. CONCLUSIONS

Viewed macroscopically, there is a precise sense in
which, as N increases, trajectories in frozen-N sys-
tems converge towards characteristics in the correspond-
ing smooth potential. For very small particle number,
N < 104 or so, the notion of an average bulk potential
fails and orbits in frozen-N systems are very diﬀerent
from smooth potential characteristics. In particular, the
usual distinctions between regularity and chaos that exist
in a smooth potential seem completely lost. [28] However,
for larger N one begins to observe clear distinctions be-
tween orbits evolved from initial conditions which, in the
continuum limit, correspond to regular versus chaotic or-
bits.

In particular, although discreteness eﬀects cannot be
neglected, phase mixing of initially localised orbit ensem-
bles in a frozen-N environment allows for clear distinc-
tions between ‘regular’ and ‘chaotic’ clumps. Just as for
clumps evolved in a smooth potential, emittance growth
for a regular frozen-N clump proceeds as a power law
in time, whereas it is roughly exponential for a chaotic
clump. However, in both cases the growth is more rapid
than in the smooth potential. Discreteness eﬀects ac-
celerate emittance growth for both regular and chaotic
clumps.

In terms of both the statistics of orbit ensembles and
the complexity of individual orbits, discreteness eﬀects

η

∝

can be extremely well-mimicked by Gaussian white noise
in the context of a Fokker-Planck, or Langevin, descrip-
tion, with a coeﬃcient of dynamical friction η and a
diﬀusion constant D consistent with the predicted scal-
ing D
(ln Λ)/N , with ln Λ the Coulomb logarithm.
A Fokker-Planck/Langevin description appears justiﬁed
even when considering the short time behaviour of in-
dividual orbits. This suggests strongly that Langevin
simulations can be used to assess the importance of dis-
creteness eﬀects in systems where N is too large to allow
honest direct summation integrations.

∝

To the extent that such an extrapolation is justiﬁed,
one concludes that discreteness eﬀects can remain im-
portant even for very large N , especially for the case of
chaotic orbits. Consider, e.g., the role of discreteness
eﬀects in accelerating emittance growth for an initially
localised clump. For the case of the thermal equilibrium
model, a relatively benign system without particularly
large density contrasts and without internal substruc-
tures, one needs N = 108 or more to justify the con-
tinuum approximation in tracking the evolution of a reg-
10−3 the size
ular clump conﬁned initially to a region
of the accessible phase space. For the case of a chaotic
clump of comparable size, one needs at least N = 109.5.
This has obvious implications for beams in that it aﬀects
macroscopic mixing and associated changes in the overall
phase-space volume. Discreteness eﬀects are also impor-
tant because they can trigger transitions between regular
and chaotic behaviour, a potentially serious problem for
charged particle beams. One might, e.g.,, try to initialise
a bunch in such a fashion that, although the bulk poten-
tial admits chaotic orbits, only regular regions are popu-
lated, thus aiming to facilitate emittance compensation.
The problem, however, is that discreteness eﬀects could
transform signiﬁcant numbers of orbits from regular to
chaotic, thus making compensation far more diﬃcult.

∼

The time scale associated with transitions between reg-
ularity and chaos increases with increasing N , such tran-
sitions being impossible in the continuum limit; but for
any ﬁnite N there is presumably a maximum time over
which it is safe to ignore these transitions. The criti-
cal point, then, as is evident from Fig. 10, is that that
time can be much shorter than the collisional relaxation
time tR. To the extent that discreteness eﬀects in the
thermal equilibrium model can be mimicked by Gaus-
sian white noise, particle number N = 106 corresponds
10−4.5, which in turn implies a relaxation time
to η
It is, however, evident that, for a
tR ∼
N = 106 realisation of the thermal equilibrium model,
transitions from regularity to chaos can be important al-
ready within a time t < 102.5 or so! By contrast, the
dynals time scale tD ∼
It should also be stressed that, even if discreteness ef-
fects are too weak to facilitate frequent transitions be-
tween regularity and chaos, they could well play an im-
portant role in accelerating diﬀusion through a complex

104.5.

∼
η−1

20.

∼

12

chaotic phase space. Generic smooth potentials admit-
ting both regular and chaotic orbits have chaotic phase
space regions partitioned by complex structures associ-
ated with cantori in two dimensions and the Arnold web
in three which, albeit not acting as absolute obstructions,
serve as ‘entropy’ barriers to slow phase space trans-
port [30]. The important point, then, is that even very
low amplitude Gaussian white noise can dramatically ac-
celerate diﬀusion through such barriers [31]. To the ex-
tent that discreteness eﬀects can be modeled as Gaussian
white noise, they too should act as a signiﬁcant source of
accelerated phase space transport.

The meaning of ‘chaos’ in the N -body problem is nec-
essarily somewhat subtle. In particular, it is important
to recognise that two distinct sources of chaos can ex-
ist, associated with physics on diﬀerent scales. Short
range microchaos, associated with close encounters be-
tween individual charges, is a generic feature of the N -
body problem, independent of the form of the bulk po-
tential. However, there is also the possibility of larger
scale macrochaos which arises if and only if, in the con-
tinuum limit, the bulk potential admits chaos. The im-
portant point, then, is that these two distinct sources of
chaos can be characterised separately by diﬀerent sets of
Lyapunov exponents. Close encounters trigger an expo-
nential separation of nearby trajectories at a rate χN .
The bulk potential triggers an exponential separation at
a rate χS which is typically much smaller.

→ ∞

Standard numerical computations of Lyapunov expo-
nents yield estimates of the much larger χN , a quantity
that does not decrease with increasing N . This leads to
the seemingly oxymoronic conclusion that the N -body
problem remains strongly chaotic for very large N , even
if the potential is integrable in the N
limit and even
if orbits ‘look’ nearly regular and have Fourier spectra
that are nearly periodic. The crucial point, however, is
that even though microchaos remains strong in the sense
that χN does not decrease with increasing N , it becomes
progressively less important macroscopically. The scale
on which the exponential divergence saturates is compa-
rable to a typical interparticle separation rsep, a distance
that decreases as N −1/3 with increasing N . By track-
ing the divergence of nearby orbits, starting with initial
separations
rsep and continuing until the separation
becomes macroscopic, it is possible to extract estimates
of both χN and χS.

≪

Finally, it should be noted that, as applied to the N -
body problem, the smooth potential Lyapunov exponent
χS does not simply quantify the average divergence of
two nearby trajectories in a single frozen-N simulation.
It also quantiﬁes the rate at which a frozen-N trajectory
will diverge from a smooth potential characteristic with
the same initial condition and the rate at which orbits
with the same initial condition diverge in diﬀerent frozen-
N simulations, two quantities which, in some settings,
could be even more important physically.

HEK was supported in part by NSF AST-0070809.
IVS and CLB were supported in part by Department
of Education Grant G1A62056.

∗ Electronic

address:

www.astro.ufl.edu/~galaxy

† Electronic address: sideris@nicadd.niu.edu
‡ Electronic address: clbohn@fnal.gov

kandrup@astro.uﬂ.edu;

[1] J. Struckmeier, Phys. Rev. E54, 830 (1996)
[2] M. N. Rosenbluth, W. M. MacDonald, and D. L. Judd,

Phys. Rev. 107, 1 (1957).

[3] S. Chandrasekhar, Rev. Mod. Phys. 15, 1 (1943),
[4] See, e.g., N. G. van Kampen, Stochastic Processes in
Physics and Chemistry (North Holland, Amsterdam,
1981).

[5] See, e.g., H. E. Kandrup and H. Smith, Astrophys. J.
386, 635 (1992), M. Hemsendorf and D. Merritt, Astro-
phys. J. 580, 606 (2002).

[6] See, e.g., H. E. Kandrup, Mon. Not. R. astr. Soc. 301,
960 (1998), H. E. Kandrup and S. J. Novotny, Celestial
Mech., submitted, astro-ph/0204019 (2002).

[7] R. A. Kishek, P. G. O’Shea, and M. Reiser, Phys. Rev.

[8] I. Haber, D. Kehne, M. Reiser, and H. Rudd, Phys. Rev.

Lett. 85, 4514 (2000).

A 44, 5194 (1991).

[9] See, e.g., R. W. Hockney and J. W. Eastwood, Computer
Simulations Using Particles (Hilger, Philadelphia, 1988).
[10] M. Brown and M. Reiser, Phys. Plasmas 2, 965 (1995).
[11] C. L. Bohn and I. V. Sideris, Phys. Rev. ST AB, in

[12] See, e.g., C. L. Bohn and J. R. Delayen, Phys. Rev. E50,

[13] S. Chandrasekhar, Ellipsoidal Figures of Equilibrium

(Yale, New Haven, 1969).

[14] H. E. Kandrup and I. V. Sideris, Celestial Mech. 82, 61

press.

1516 (1994).

(2002).

13

[16] P. Grassberger, R. Badii, and A. Poloti, J. Stat. Phys.

51, 135 (1988)

[17] H. E. Kandrup, B. L. Eckstein, and B. O. Bradley, As-

tron. Astrophys. 320, 65 (1997).

[18] B. Chirikov, Phys. Rept. 52, 265 (1979).
[19] J. J. Tennyson, in Nonlinear Dynamics and the Beam-
Beam Interaction, edited by M. Month and J. C. Herrera
(AIP, New York, 1979).

[20] K. Rauch and S. Tremaine, New Astron. 1, 149 (1996).
[21] T. O’Neill, private communication. One textbook on non-
neutral plasmas, R. C. Davidson, An Introduction to the
Physics of Nonneutral Plasmas (Redwood City, Addison-
Wesley, 1990), notes that ‘a detailed calculation is gen-
erally formidable.’

[22] H. E. Kandrup and I. V. Sideris, Phys. Rev. E64, 056209
(2001), I. V. Sideris and H. E. Kandrup, Phys. Rev. E65,
066203 (2002).

[23] A. Griner, W. Strittmatter, and J. Honerkamp, J. Stat.

[24] S. Habib, H. E. Kandrup, and M. E. Mahon, Phys. Rev

Phys. 51, 95 (1988).

E53, 5473 (1996).

Physics, in press.

(2001).

[25] See, e.g., H. E. Kandrup, Springer Lecture Notes in

[26] I. V. Pogorelov, University of Florida Ph. D. dissertation

[27] Recent numerical

simulations

self-
gravitating systems performed by Hemsendorﬀ and Mer-
ritt [5] are completely consistent with this prediction, the
data there suggesting that χN (N ) should increase loga-
rithmically as N increases.

interacting

of

[28] By increasing the value of the softening parameter ǫ, one
can ‘force’ the frozen-N system to more closely resemble
the smooth density distribution; but this comes at the
cost of supressing physical eﬀects associated with ﬁnite
N which are present in real systems.

[29] It is the phase space separation δZ that enters into the
deﬁnition of a Lyapunov exponent. See, e.g., [30].
[30] A. J. Lichtenberg and M. A. Lieberman, Regular and

Chaotic Dynamics, Springer, Berlin (1992).

[31] I. V. Pogorelov and H. E. Kandrup, Phys. Rev E60, 1567

[15] A very tiny softening parameter serves to stabilise nu-
merical integrations but has essentially zero impact on
the physics. See, e.g., Ref. [9].

(1999).

14

FIG. 1: The x and y coordinates of 1600 initially localised
points evolved in frozen-N realisations of the regular potential
(4) with N = 103.5 (left column) and N = 105.0 (right col-
umn) at diﬀerent times t. From top to bottom, t = 16.0,
t = 32.0, t = 64.0, t = 128.0, and t = 256.0.
In each
case, the integrations were performed with softening parame-
ter e = 10−5.

15

FIG. 2: The x and y coordinates of 1600 initially localised
points evolved in frozen-N realisations of the chaotic potential
(5) with variable N at diﬀerent times t. From left to right,
one has N = 103.5, N = 104.5, N = 105.5 and the smooth
potential. From top to bottom, t = 16.0, t = 32.0, t = 64.0,
t = 128.0, and t = 256.0. Once again e = 10−5.

16

FIG. 3: The three-dimensional emittance ǫ = (ǫxǫyǫz)1/3
computed for the same regular clump used to generate FIG-
URE 1, allowing for both frozen-N backgrounds and energy-
conserving white noise. (a) N = 103.0. (b) η = 10−2.5 (c)
N = 103.5. (d) η = 10−3.0 (e) N = 104.0. (f) η = 10−3.5 (g)
N = 104.5. (h) η = 10−4.0 (i) N = 105.0. (j) η = 10−4.5

17

FIG. 4: The three-dimensional emittance ǫ = (ǫxǫyǫz)1/3
computed for the same chaotic clump used to generate FIG-
URE 2, allowing for both frozen-N backgrounds and energy-
conserving white noise. Note the logarithmic scale.
(a)
N = 102.5. (b) η = 10−2.0. (c) N = 103.5. (d) η = 10−3.0. (e)
N = 104.5. (f) η = 10−4.0. (g) N = 105.5. (h) η = 10−5.0. (i)
The smooth potential. The dashed line corresponds to a slope
equaling the mean Lyapunov exponent hχSi for the orbits. (j)
η = 10−7.5, the strongest noise without an appreciable eﬀect
on ǫ.

18

FIG. 5: The x − y projection of a frozen-N orbit generated
from an initial condition corresponding in the smooth poten-
tial to a circular orbit. (a) N = 102.5. (b) N = 103.0 (c)
N = 103.5. (d) N = 104.0 (e) N = 104.5. (f) N = 105.0 (g)
N = 105.5. (h) The smooth potential orbit.

19

FIG. 6: The power spectrum |x(ω)| for the orbits exhibited
in the preceding Figure. (a) N = 102.5. (b) N = 103.0 (c)
N = 103.5. (d) N = 104.0 (e) N = 104.5. (f) N = 105.0 (g)
N = 105.5. (h) The smooth potential orbit.

20

FIG. 7:
(a) Diamonds show the complexity n(0.95), deﬁned
as the mean number of frequencies required to capture 95% of
the total power, computed for a collection of 100 initial con-
ditions integrated in frozen-N realisations of the integrable
Model 1 with variable N . Triangles show the same quantity
for the same initial conditions integrated in the smooth po-
tential but subjected to Gaussian white noise with variable η
The solid line exhibits the mean complexity for orbits evolved
in the unperturbed smooth potential. (b) The same as (a),
generated from the same initial conditions but now computed
for the strongly chaotic Model 2.

21

FIG. 8: The three-dimensional emittance ǫ computed for a
clump of regular initial conditions for the thermal equilibrium
model, allowing for both frozen-N backgrounds and energy
conserving white noise. (a) N = 104.5. (b) η = 10−3.0. (c)
N = 105.0. (d) η = 10−3.5. (e) η = 105.5. (f) η = 10−4.0. (g)
N = 106.0. (h) η = 10−4.5. (i) Unperturbed motion in the
smooth potential. (j) η = 10−6.5, the largest value of η that
does not signiﬁcantly impact emittance growth.

22

FIG. 9: The three-dimensional emittance ǫ computed for a
clump of chaotic initial conditions for the thermal equilibrium
model, again allowing for both frozen-N backgrounds and en-
ergy conserving white noise. (a) N = 104.5. (b) η = 10−3.0.
(c) N = 105.0. (d) η = 10−3.5. (e) N = 105.5. (f) η = 10−4.0.
(g) N = 106.0. (h) η = 10−4.5. (i) Unperturbed motion in the
smooth potential. (j) η = 10−8.0, the largest value of η that
does not signiﬁcantly impact emittance growth.

23

FIG. 10: The percentage of frozen-N orbits generated from a
clump of regular initial conditions and evolved in the thermal
equilibrium model which, at time t, have been converted to
chaotic orbits. From top to bottom, the curves correspond
to frozen-N backgrounds with N = 104.5, N = 105.0, and
N = 105.5, and N = 106.0.

FIG. 11: Mean value of the largest Lyapunov exponent χN
as a function of N for diﬀerent choices of softening parameter
e, computed for regular initial conditions evolved in Model 1.
e = 10−5: solid line and diamonds. e = 10−4: dashed line and
squares. e = 10−3: dot-dashed line and triangles. e = 10−2:
triple-dot-dashed line and crosses. e = 10−1: dots and stars.

24

FIG. 12: Mean value of the largest Lyapunov exponent χN
as a function of softening parameter e for diﬀerent choices of
N , computed for regular initial conditions evolved in Model
1. N = 105.0: solid line and pluses. N = 104.5: broad dashed
line and stars. N = 104.0: triple-dot-dashed line and crosses.
N = 103.5: dot-dashed line and squares. N = 103.0: dashed
line and triangles. N = 102.5: dots and diamonds.

FIG. 13: Mean value of the largest Lyapunov exponent χN
as a function of N for the same initial condition integrated in
the integrable Model 1 (solid curve) and the chaotic Model 2
(short dashed curve). In both cases, e = 10−5. The broad-
dashed line at the bottom corresponds to the smooth poten-
tial Lyapunov exponent χS for the same initial condition in-
tegrated in the smooth potential corresponding to Model 2.

25

FIG. 14: The mean phase space separation |δZ(t)| for 50
nearby pairs of initial conditions evolved in frozen-N reali-
sations of the chaotic Model 2 with (from top to bottom)
N = 105.0, 105.5, and 106.0. The solid line has a slope
χS = 0.056, equal to the the mean value of the largest smooth
potential Lyapunov exponent. The dashed line has a slope
χN = 0.82, equal to the mean value of the largest N -body
exponent.

FIG. 15: The same as the preceding for regular orbits in the
thermal equilibrium model. The dashed line again has a slope
equal to the mean value of the largest N -body Lyapunov ex-
ponent. Note the absence of the second exponential phase.

26

FIG. 16: The mean phase space separation |δZ(t)| for 50
initial conditions evolved in two diﬀerent frozen-N realisations
of Model 2 with (from top to bottom) N = 105.0, 105.5, and
106.0. The solid line again has a slope χS = 0.056, equal
to the mean value of the largest smooth potential Lyapunov
exponent.

FIG. 17: The mean phase space separation |δZ(t)| for 50
initial conditions evolved in Model 2, both in the smooth po-
tential and in a frozen-N system with (from top to bottom)
N = 105.0, 105.5, and 106.0. The solid line again has a slope
χS = 0.056, equal to the mean value of the largest smooth
potential Lyapunov exponent.

