3
0
0
2
 
n
a
J
 
0
3
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
3
7
0
1
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Calculation of the Coherent Synchrotron Radiation Impedance from a Wiggler∗

SLAC-PUB-9628
January 2003

Juhao Wu,† Tor Raubenheimer,‡ and Gennady Stupakov§
Stanford Linear Accelerator Center, Stanford University, Stanford, CA 94309
(Dated: February 2, 2008)
(Submitted to Physical Review Special Topics—Accelerators and Beams)

Most studies of Coherent Synchrotron Radiation (CSR) have only considered the radiation from
independent dipole magnets. However, in the damping rings of future linear colliders, a large fraction
of the radiation power will be emitted in damping wigglers. In this paper, the longitudinal wakeﬁeld
and impedance due to CSR in a wiggler are derived in the limit of a large wiggler parameter K.
After an appropriate scaling, the results can be expressed in terms of universal functions, which are
independent of K. Analytical asymptotic results are obtained for the wakeﬁeld in the limit of large
and small distances, and for the impedance in the limit of small and high frequencies.

PACS numbers: 29.27.Bd; 41.60.Ap; 41.60.Cr; 41.75.Fr
Keywords: Coherent Synchrotron Radiation; Wakeﬁeld; Impedance; Wiggler

I.

INTRODUCTION

Many modern advanced accelerator projects [1, 2, 3]
call for short bunches with low emittance and high peak
current where coherent synchrotron radiation (CSR) ef-
fects may play an important role. CSR is emitted at
wavelengths longer than or comparable to the bunch
length whenever the beam is deﬂected [4, 5]. The strin-
gent beam requirements needed for short wavelength
SASE Free-Electron Lasers have led to intensive theo-
retical and experimental studies [6, 7, 8, 9, 10, 11, 12,
13, 14, 15, 16, 17] over the past a few years where the
focus has been on the magnetic bunch compressors re-
quired to obtain the high peak currents.
In addition
to these single-pass cases, it is also possible that CSR
might cause a microwave-like beam instability in stor-
age rings. A theory of such an instability in a storage
ring has been recently proposed in Ref. [18] with exper-
imental evidence published in [19]. Other experimental
observations [20, 21, 22, 23, 24] may also be associated
with a CSR-driven instability as supported by additional
theoretical studies [25, 26, 27].

The previous study of the CSR induced instability
assumed that the impedance is generated by the syn-
chrotron radiation of the beam in the storage ring bend-
ing magnets [18]. In some cases (e.g. the NLC damping
ring [28]), a ring will include magnetic wigglers which
introduce an additional contribution to the radiation
impedance. The analysis of the microwave instability
in such a ring requires knowledge of the impedance of
the synchrotron radiation in the wiggler. Although there
have been earlier studies of the coherent radiation from a
wiggler or undulator [29, 30], the results of these papers
cannot be used directly for the stability analysis.

∗Work supported by the Department of Energy contract DE-AC03-
76SF00515
†Electronic address: jhwu@SLAC.Stanford.EDU
‡Electronic address: tor@SLAC.Stanford.EDU
§Electronic address: stupakov@SLAC.Stanford.EDU

In this paper, we derive the CSR wake and impedance
for a wiggler. We focus our attention on the limit of
a large wiggler parameter K because this is the most
interesting case for practical applications. It also turns
out that, in this limit, the results can be expressed in
terms of universal functions of a single variable after an
appropriate normalization.

The paper is organized as follows. In Sec. 2, we write
down equations for the energy loss of a beam in a wiggler.
We then derive the synchrotron radiation wakeﬁeld in the
limit of a large wiggler parameter K in Sec. 3. In Sec.
4, we obtain the synchrotron radiation impedance for a
wiggler, and in Sec. 5 we discuss our results.

II. ENERGY LOSS AND LONGITUDINAL
WAKE IN WIGGLER

E

The longitudinal wake is directly related to the rate of
/dt of an electron in the beam propagating
energy loss d
in a wiggler. For a planar wiggler, a general expression
for d
/dt as a function of the position s of the electron
in the bunch and the coordinate z in the wiggler was
[30]. We reproduce here the results of
derived in Ref.
that work using the authors’ notation:

E

d
E
c dt

= e2 kw

d s′ D(ˆs

ˆs′, K, ˆz)

−

d λ(s′)
ds′

,

(1)

s

−∞

Z

where λ(s) is the bunch linear density,

D(ˆs, K, ˆz) =

1
ˆs −

2

×

∆

−

K 2 B(∆, ˆz) [sin ∆ cos ˆz + (1
∆2 + K 2 B2(∆, ˆz)

−

cos ∆) sin ˆz]

,(2)

B(∆, ˆz) = (1

cos ∆

∆ sin ∆) cos ˆz

−
+ (∆ cos ∆

−
sin ∆) sin ˆz ,

(3)

−

2

In this limit, the expression for D, Eq. (2) can also be
simpliﬁed:

D(ζ, ˆz) = 2

sin ∆ cos ˆz + (1

cos ∆) sin ˆz

−
B(∆, ˆz)

,

(10)

1/K. Again, the
as long as ∆ is not too small, ∆
parameter K is eliminated from this equation. A detailed
analysis supporting this approximation can be found in
Appendix A.

≫

III. WAKEFIELD

Using Eq. (6) and (10) we ﬁnd

G(ζ) =

π

d ˆz

2
π

0
Z

sin ∆ cos ˆz + (1

cos ∆) sin ˆz

−
B(∆, ˆz)

,

(11)

where ∆ = ∆(ζ, ˆz) is implicitly determined by Eq.
(9). The integrand in this equation has singularities at
points ˆz = ˆzs where B(∆(ζ, ˆzs), ˆzs) = 0.
It is shown
in Appendix B that in the vicinity of a singular point
ˆzs)1/3, and the singularity is integrable.
B(∆(ζ, ˆz))
We plot in Fig. 1 the function G(ζ) calculated by nu-
merical integration. A characteristic feature of the func-
tion G is the presence of cusp points, at which the func-
tion reaches local maxima and minima. An approximate

(ˆz

−

∝

and ∆ is the solution of the transcendental equation

1 +

K 2
2

∆
2
−
(cid:19)
(cos ∆ cos 2ˆz + sin ∆ sin 2ˆz)

K 2
4 ∆ {

[2(1

+

(cid:18)

ˆs =

×

cos ∆)

∆ sin ∆]

−

2(1

cos ∆)
}

−

. (4)

−

−

In the above equations, we use the following dimension-
less variables: ˆs = γ2 kw s and ˆz = kw z. The parameter
∆ is equal to kw (z
zr), where z and zr are the projected
coordinates on the wiggler axis of the current position of
the test particle and the retarded position of the source
particle, respectively. The internal coordinate s is deﬁned
so that the bunch head corresponds to a larger value of s
than the tail. The wiggler parameter K is approximately
K
93.4 Bw λw, with Bw the peak magnetic ﬁeld of the
wiggler in units of Tesla and λw the period in meters. In
addition, γ is the Lorentz factor, e is the electron charge,
c is the speed of light in vacuum, and kw = 2π/λw is
the wiggler wavenumber. Note that the function D is
a periodic function of ˆz with a period equal to π. Also
1, we still assume a
note that, desipte assuming K
1.
small-angle orbit approximation, i.e., K/γ

≫

≈

We introduce the longitudinal wake W (s) of the bunch
as the rate of the energy change averaged over the z co-
ordinate:

≪

1
e2

d ¯
E
c dt

−

=

kw

−

s

−∞

Z

d s′ G(s

s′)

−

d λ(s′)
ds′

, (5)

W (s) =

where

G(s) =

d ˆz D(ˆs, K, ˆz),

(6)

π

1
π

0
Z

and we dropped K from the list of arguments of the func-
tion G. The positive values of W correspond to the en-
ergy loss and the negative values imply the energy gain.
The usual longitudinal wake w(s) corresponding to the
interaction of two particles is then deﬁned as

w(s) =

kw

−

d G(s)
d s

,

(7)

G

so that

W (s) =

ds′ w(s

s′)λ(s′).

(8)

−

s

−∞

Z

Note that the wake Eq. (7) is localized in front of the
particle and vanishes behind it, w = 0 for s < 0.

In the limit of large K, we can neglect unity in the
ﬁrst bracket of Eq. (4), assuming that K 2/2
1. Such
an approximation is valid, if we are not interested in the
very short distances of order of (K kw γ2)−1 (0.5˚A for
the NLC damping ring wiggler [28]). We also introduce
ˆs/K 2 which eliminates the parameter
a new variable ζ
K from Eq. (4):

≫

≡

0.0

−0.2

−0.4

−0.6

−0.8

−1.0

0

1

2

4

5

6

3
2ζ/π

FIG. 1: The solid curve represents the G(ζ) deﬁned in Eq.
(11) as a function of the normalized coordinate 2ζ/π. The
(×)-signs are the approximation given in Eq. (12).

ζ(∆, ˆz) =

∆ sin ∆]

+

[2(1

cos ∆)

1
4∆ {

∆
4
(cos ∆ cos 2ˆz + sin ∆ sin 2ˆz)
.
2(1

−

−

cos ∆)
}

−

×
−

location of these cusp points and the value of the func-
tion G at these points can be understood with a simple
physical argument presented in Appendix C. It turns out
that the minima are located at distances s between the
particles equal to the integer number of the fundamental

(9)

3

(12)

(17)

(18)

(19)

radiation wavelength in the wiggler, and the maxima ap-
proximately correspond to the distance equal to an odd

number of half-wavelength. A simple analytical calcula-
tion in Appendix C gives the following results

G(ζ) =

0 ;

(

−

4 (2 n+1) π
4+[(2 n+1) π]2 ;

for ζ = n π
for ζ

2 with n = 1, 2,
(2n+1) π
4

1

· · ·

(2n+1) π with n = 0, 1,

≈

−

· · ·

These are the “
agreement with the numerical result.

×

” points in Fig. 1, showing very good

In Eq. (3), we keep only the largest term

A. Short-range limit

B(∆, ˆz) =

∆ sin(∆

ˆz) .

−

−

(16)

In the limit ζ
1 as well. Eq.
expansion of the right-hand side:

1, it follows from Eq. (9) that ∆
≪
≪
(9) can then be solved using a Taylor

For D, one now ﬁnds,

∆ =

1/3

.

24 ζ
cos2 ˆz

(cid:18)

(cid:19)

(13)

with

D(ζ, ˆz)

F (ζ, ˆz)
ζ

,

≡

Expanding the integrand in Eq. (11), keeping only the
ﬁrst non-vanishing term in ∆ and substituting ∆ from
Eq. (13) yields

G(ζ) =

dˆz cos2/3 ˆz

π

2
(3 ζ)1/3

1
π
4 32/3 Γ
5 √π Γ

−

−

0

Z
11
6
4
3

=

ζ−1/3

0.99 ζ−1/3. (14)

≈ −

(cid:0)
(cid:0)

(cid:1)
(cid:1)
The above result can also be obtained if one considers
a wiggler as a sequence of bending magnets with the
bending radius R = γ/kwK
. Indeed, in a bending
cos ˆz
|
2 s−1/3/(3 R2)1/3
dipole, the corresponding Gbend(s) =
[7, 8]. Averaging Gbend over the wiggler period yields
Eq. (14). The reason why such a model gives the correct
result in this limit, is that the formation length of the ra-
diation is much shorter than the wiggler period, and one
can use a local approximation of the bending magnet for
the wake.

−

|

F (ζ, ˆz)

≡

2 sin(ˆz

∆(ζ, ˆz)) −

1
2

,

sin ˆz

−

where the function ∆(ζ, ˆz) is implicitly determined by
Eq. (15). Averaging over one wiggler period, we ﬁnd

G(ζ)

¯F (ζ)
ζ

,

≡

with

¯F (ζ)

d ˆz F (ζ, ˆz)

≡

=

π

1
π
1
2 π

0
Z

−

(cid:18)

π +

d ˆz

π

0
Z

sin ˆz

sin(ˆz

∆)

−

(cid:19)

.

(20)

B. Long-range limit

In the limit ζ

1, the parameter ∆ is also large, and

≫
Eq. (9) can be further simpliﬁed:

ζ =

∆
4 −

sin ∆ cos(∆

2ˆz)

−

.

4

(15)

It is easy to check that the function ¯F is periodic, ¯F (ζ+
π/2) = ¯F (ζ), and ¯F (0) = 0, ¯F (π/4) =
1 in agreement
with Eq. (12). The average value ¯F (ζ) is equal to
1/2.
−
Since ¯F is periodic in ζ with a period of π/2, using Eq.
(20), we get a Fourier series representation for ¯F (ζ):

−

¯F (ζ) =

1
2

−

+

1
2

∞

Jn

2n + 1
2

Jn+1

−

(cid:19)

2

2n + 1
2

(cid:18)

(cid:19)(cid:21)

n=0 (cid:20)
X

(cid:18)

cos(4(2n + 1)ζ) ,

(21)

8

6

4

2

0

n
o
i
t
c
n
u
F
 
n
e
e
r
G
 
e
k
a
W
 
d
e
z

i
l

a
m
r
o
N

where Jn(x) is the Bessel function of the ﬁrst kind.
Derivations of the Fourier coeﬃcients are presented in
Appendix D. In Fig. 2, we plot the function ¯F (ζ) deﬁned

in Eq. (21) for one period.

The corresponding long-range wake is then

4

G(ζ) =

1
2ζ

−

+

1
2ζ

∞

Jn

2n + 1
2

Jn+1

−

(cid:19)

2

2n + 1
2

(cid:18)

(cid:19)(cid:21)

n=0 (cid:20)
X

(cid:18)

cos(4(2n + 1)ζ) .

(22)

It is worth noting, that the asymptotic expression in
1 in Ref. [30] is incorrect—instead of the ¯F -
the limit ζ
function the authors obtained a sine function, which only
corresponds to the fundamental mode of the radiation
and neglects contribution from higher-order harmonics.

≫

0.0

F

−0.5

−1.0

0.0

Fig. 3.

−2

0

1

2
2ζ/π

3

4

3:

The

FIG.
function
−w(s)[K/(γkw)]2 as a function of the normalized coor-
dinate 2ζ/π.

normalized wake Green

1.0

IV.

IMPEDANCE

wiggler radiation spectrum I(ω) [31]:

0.5
2ζ/π

FIG. 2: Plot of ¯F (ζ) of Eq. (21).

The longitudinal wake deﬁned in Eq. (7) is plotted in

The impedance Z(k) is deﬁned as the Fourier trans-

form of the wake,

∞

Z(k) =

ds w(s) e−iks

0

Z

−

=

i k

∞

K 2
γ2

0
Z

dζ G(ζ) e− 4 i k

k0 ζ ,

(23)

where k0 ≡
tion wavenumber.

4γ2kw/K 2 is the wiggler fundamental radia-

We evaluated the integral in Eq. (23) using numeri-
cally calculated values of the function G(ζ) in the inter-
50. The
val [ζmin, ζmax], where ζmin ≈

10−3 and ζmax ≈

contribution to the integral outside of this interval was
calculated using asymptotic representations Eqs.
(14)
and (22).

The resulting imaginary and real parts of
impedance are shown in Fig. 4 and Fig. 5 respectively.

the

The real part of the impedance can be related to the

ReZ(ω) =

π
e2 I(ω) .

(24)

The spectrum I(ω) in the limit K
1 is calculated in
Appendix E. It shows a perfect agreement with the result
presented in Fig. 5.

≫

Simple analytical formulae for the impedance can be

obtained in the limit of low and high frequencies.

The low-frequency impedance corresponds to the ﬁrst
term in Eq. (22) for function G which does not oscillate
with ζ:

G(ζ) =

1
2 ζ

.

−

(25)

5

e
c
n
a
d
e
p
m

i
 
d
e
z

i
l

a
m
r
o
n
 
e
h
t
 
f
o
 
t
r
a
p
 
y
r
a
n
g
a
m

i

I

2.0

1.5

1.0

0.5

0.0

−0.5

−1.0

0

e
c
n
a
d
e
p
m

i
 
d
e
z

i
l

a
m
r
o
n
 
e
h
t
 
f
o
 
t
r
a
p
 
l
a
e
R

3.5

3.0

2.5

2.0

1.5

1.0

0.5

0.0

1
2
Normalized wavenumber

3

4

0

1
2
Normalized wavenumber

3

4

FIG. 4: The imaginary part of the normalized impedance
Z(k)/kw as a function of the normalized wavenumber k/k0.
Solid line—numerical solution from Eq. (23), dotted line—
analytical low-frequency asymptotic behavior from Eq. (26),
and dashed line—analytical high-frequency asymptotic be-
havior from Eq. (27).

FIG. 5: The real part of the normalized impedance Z(k)/kw
as a function of the normalized wavenumber k/k0. Solid line—
numerical solution from Eq. (23), dotted line—analytical low-
frequency asymptotic behavior from Eq.
(26), and dashed
line—analytical high-frequency asymptotic behavior from Eq.
(27).

Using the deﬁnition in Eq. (23), we then obtain the low-
frequency asymptotic behavior of the impedance as

Z(k) =

i 2 kw

γE + log

−

π kw

≈

k
k0 (cid:20)
k
1
k0 (cid:20)

−

+ i

π
2

(cid:21)

4k
k0 (cid:19)
(cid:18)
k
k0 (cid:19)(cid:21)

(cid:18)

2 i
π

log

,

(26)

0.5772 is the Euler Gamma constant. This
where, γE ≈
asymptotic low-frequency impedance is plotted in Figs.
4 and 5 for comparison with the numerical solution.

Since we have an analytical expression for the short-
(14), we get the asymptotic high-

range G(ζ) in Eq.
frequency impedance as

Z(k) =

i

−

11
6 Γ
6
5 √π Γ
(cid:2)

0.71 i A

≈ −

A

4
(cid:3)
3
Kkw
(cid:3)
γ

(cid:2)

2/3

k1/3

Kkw
γ

2/3

(cid:18)

(cid:19)

k1/3 ,

(27)

(cid:18)
with A = 3−1/3Γ(2/3)(√3 i
0.94 [18]. This
−
asymptotic high-frequency impedance is plotted in Figs.
4 and 5 for comparison with the numerical solution.

1.63 i

1)

≈

−

(cid:19)

V. DISCUSSION AND CONCLUSION

In this paper, we derived the wakeﬁeld and the
impedance for wigglers with K 2/2
1 due to the syn-
chrotron radiation. Analytical asymptotic results are

≫

obtained for the wakes in the limit of small and large
distances, and for the impedance in the limit of small
and high frequencies. The results obtained in this pa-
per are used for the beam instability study due to the
synchrotron radiation in wigglers [32].

Acknowledgments

The authors thank Drs. A.W. Chao, S.A. Heifets,
Z. Huang of Stanford Linear Accelerator Center, Drs.
S. Krinsky, J.B. Murphy, J.M. Wang of National Syn-
chrotron Light Source, Brookhaven National Labora-
tory for many discussions. Work was supported by the
U.S. Department of Energy under contract DE-AC03-
76SF00515.

APPENDIX A: DETAILS FOR DERIVING EQ.
(10)

∼

−

≪

cos ∆) sin ˆz]

In the limit of ∆

1, according to Eq. (3), B

∆2.
In the numerator of the second term on the right hand
side of Eq. (2), we would have K 2B(∆, ˆz)[sin ∆ cos ˆz +
(1
1/K.
≫
This is allowed, since we are interested in the limit of
1. Hence, ∆ is neglected in the numerator. In the
K
denominator of the second term, then K 2B2
≫
∆2, as long as ∆
1/K, hence ∆2 is dropped. There-
fore, the second term of Eq. (2) is on the order of 1/∆.

∆, as long as ∆

K 2∆3

K 2∆4

≫

≫

≫

∼

∼

∼

≫

≪

1, we have
According to Eq. (4), in the limit of ∆
K 2∆, so the ﬁrst term of Eq. (2) is on the order of
ˆs
1/(K 2∆), hence is much smaller than the second term in
the limit of K
1. Therefore the ﬁrst term 1/ˆs could
be dropped. All these considerations lead us to Eq. (10).
1, according to Eq. (4), we have
For ∆
K 2
1. Now,
ˆs
∼
∼
in Eq.
1, we can neglect ∆
in comparison with K 2 in the numerator and ∆2 in the
denominator of the second term on the right hand side.
We then note that the second term is on the order of 1,
1,
and is much larger than the ﬁrst term 1/ˆs
hence we can drop 1/ˆs to obtain Eq. (10).

1 and K
1. Eq. (3) suggests that B(∆, ˆz)

∼
≫
(2), in the limit of K

K −2

≫

≪

≫

∼

∼

≫

∆. For K

Now let us study the limit of ∆

1. Eq. (3) suggests
that B(∆, ˆz)
1, then in Eq. (2), ∆ and
≫
∆2 could be dropped in the numerator and denominator
of the second term on the right hand side, respectively.
The second term is on the order of 1/∆. Now, according
K 2∆.
to Eq. (4), in the limit of ∆
1, the ﬁrst term of Eq. (2),
Hence, in the limit of K
which is on the order of 1/(K 2∆), is negligible, compared
with the second term. Hence, we obtained Eq. (10).

1, we have ˆs

≫

≫

∼

So, in general, for large K, as long as ∆ is not too
1/K, the simpliﬁcation leading to Eq.

small, i.e., ∆
(10) is always acceptable.

≫

APPENDIX B: SINGULAR POINTS IN D(ζ, ˆz)

To ﬁnd the scaling of the singularity, we assume that
at the vicinity of the zeroes ˆzs of B(∆, ˆz), the leading
term scales as

6

(B2)

then we have

B′

α b (ˆz

ˆzs)α−1 ,

≈

−

where the prime indicates the derivative with respect to
ˆz.

Let us ﬁrst calculate B′. From Eq. (3) we have,

B′ =

sin ˆz + sin(ˆz

−
+ cos(ˆz

∆)
−
cos(ˆz

−

∆)∆

−

−

∆)∆∆′ .

(B3)

To ﬁnd ∆′, we revert to Eq. (9), where, we ﬁnd

∆′ =

C(∆, ˆz)
B2(∆, ˆz)

(B4)

with

C(∆, ˆz) = 2 sin(2ˆz

∆) sin

∆

(cid:18)

∆
2
(cid:19)
∆
2

cos

−

−
∆
2

(cid:18)

(cid:19)

(cid:18)

(cid:19)

(cid:21)

2 sin

×

(cid:20)

∆

.

(B5)

Note that C(∆, ˆz) is a well deﬁned function at the zeroes
of B(∆, ˆz).

Combining Eqs. (B1), (B3), (B4), (B5), we have, near

the zeroes ˆzs,

B′(∆, ˆz) =

b2 (ˆz

ˆzs)2α ,

Ξ

−

(B6)

B

b (ˆz

≈

−

ˆzs)α ,

(B1)

where,

Ξ =

cos(ˆz

∆)∆

C(∆, ˆz)

|ˆz=ˆzs;∆=∆(ζ,ˆzs)

−

−

−

−

×

(cid:26)

=

cos(ˆz

∆)∆

2 sin(2ˆz

∆) sin

∆

2 sin

−

∆
2

(cid:18)

(cid:19)

×

(cid:20)

∆
2

cos

−

∆
2

∆

(cid:18)

(cid:19)

(cid:18)

(cid:19)

Here, ˆzs is deﬁned as the solution of B(∆(ζ, ˆzs), ˆzs) = 0.
Therefore, combining Eqs. (B6) and (B2), we ﬁnd the
scaling index α = 1/3 and b = (3 Ξ)1/3. This means that
D(ζ, ˆz) has only an integrable singularity at z = zs with
D

ˆzs)−1/3.

(ˆz

∝

−

As a numeric illustration of the origin of the singular-
ity, we plot in Fig. 6 functions B(∆(ζ, ˆz), ˆz) and ∆(ζ, ˆz)
for ζ = 1.0. This plot shows that at the point where
B = 0, both derivatives B′ and ∆′ are inﬁnite, in accor-
dance with Eqs. (B2) and (B4).

ˆz=ˆzs;∆=∆(ζ,ˆzs)

.

(B7)

(cid:21)(cid:27)(cid:12)
(cid:12)
(cid:12)
(cid:12)

APPENDIX C: SIMPLE PHYSICS MODEL

Here, we give some explanation about the peaks and

the zeroes in Fig. 1 based on a simple physics model.

The CSR wake is actually the ﬁeld emitted by a trail-
ing particle which acts on the particle in front. Using a
model presented in Ref. [8], the longitudinal force on the
leading particle can be thought of as the component of
the trailing particle’s transverse Coulomb ﬁeld projected
onto the leading particle’s direction of motion:

W|| = eE⊥(z) sin θ ,

(C1)

where E⊥(z) is the magnitude of the transverse Coulomb

6

4

2

0

−2

−4

−6

0

1

2

3

Z

FIG. 6: A concrete example for ζ = 1.0. Solid line: B(∆(ζ =
1.0, ˆz), ˆz) as a function of ˆz; Dashed line: ∆(ζ = 1.0, ˆz) as a
function of ˆz.

θ

E

θ

θ

1-2003(cid:13)
8663A1

FIG. 7: Physics model to explain the longitudinal CSR wake.

1-2003(cid:13)
8663A2

FIG. 8: Physics model to explain the peaks and zeroes of
G(s) shown in Fig. 1. The solid line stands for the electron
trajectory. The ellipses stand for the electrons. The arrows
stand for the instantaneous direction of the motion. We group
the four electrons into two pairs, one with solid arrows and
the other with dashed arrows.

7

electric ﬁeld at the retarded position from the trailing
particle at retarded time. The argument z indicates that
the amplitude of the transverse electric ﬁeld is actually
varying along the trajectory. In Eq. (C1), θ is the angle
between the direction of motion of the trailing particle
and that of the particle at front. To illustrate the model,
we give a schematic plot in Fig. 7.

To understand the wiggler wakeﬁeld, let us look at the
four electrons in Fig. 8. The pair with solid arrows is
separated by integer number times of the wiggler funda-
mental radiation wavelength. During their journey, when
the light emitted by the trailing electron cathches the
electron in front, the instantaneous direction of motion
of the front electron is always parallel to the direction
of motion of the trailing electron at the retarded time
when it emitted the light. Hence we have θ = 0. So
according to Eq. (C1), the longitudinal force is always
zero. This explains the zeroes in the longitudinal wake
potential plotted in Fig. (1). The pair with dashed ar-
rows is separated by odd integer number times of half of
the wiggler fundamental radiation wavelength. Averaged
over one period, they make the largest angle between the
instantaneous direction of motion of the front electron
and the direction of motion of the trailing electron at the
retarded time. Hence according to Eq. (C1), the longi-
tudinal force reaches maximum. This explains the peaks
shown in Fig. (1).

Let us calculate the values at these cusps points. Ac-
cording to Eq. (9), when ∆ = 2nπ, we have ζ = nπ/2.
According to Eq. (11), the numerator of the integrand
is zero at ∆ = 2nπ, while B(∆, ˆz) = 2nπ sin ˆz accord-
ing to Eq. (3). Hence the integral is zero. So we have
. We ﬁnd that it is true in
G(nπ/2) = 0 for n = 1, 2,
the numerical solution in Fig. 1.

· · ·

At ∆ = (2n + 1)π, according to Eqs. (11) and (3), we

get

G(ζ) =

π

dˆz

2
π

2 cos ˆz

2 sin ˆz
(2n + 1)π sin ˆz

0
Z
4 (2 n + 1) π
4 + [(2 n + 1) π]2

=

−

−
for ∆ = (2n + 1) π. (C2)

According to Eq. (9), we have

ζ =

∆
4 −

2
∆

cos2 ˆz

∆
4 −

1
∆

≈

for ∆ = (2n+1) π. (C3)

In the above approximation, we average ζ over one period
in ˆz. This becomes a good approximation, when ∆ is
large. This manifests itself in Fig. 1. As we ﬁnd from
Fig. 1, with the increasing of ζ, therefore, the increasing
of ∆, the above approximate value gets closer and closer
to the numerical solution. Combining the results at the
zeroes and the peaks, we get Eq. (12).

APPENDIX D: CALCULATION FOR THE
FOURIER COEFFICIENTS

Since we ﬁnd that the function ¯F (ζ) is periodic in ζ
with a period of π/2, we could represent it in a Fourier

series. The calculation for the Fourier coeﬃcients are
straightforward. We here illustrate one example. For
m = 1, 2,

,

· · ·

8

¯F (ζ) cos[4(2m + 1)ζ]
h

i ≡

dζ ¯F (ζ) cos[4(2m + 1)ζ]

dζ cos[4(2m + 1)ζ]

dˆz

π
2

0
Z

2π

=

=

2
π2

1
π2

π

0
Z

0
Z

π
2

4
π

0
Z
π

sin ˆz

0
Z

sin(ˆz

∆)

−

−

(cid:20)

d∆

dˆz sin ˆz sin(ˆz

∆) cos

(2m + 1)∆

(2m + 1) sin[2(∆

ˆz)]

−

2

−

(2m + 1) sin 2ˆz
2

−

(cid:21)

.

(D1)

Notice that, we have used the deﬁnition of ¯F in Eq. (20).
We also changed integral variable pair (ζ, ˆz) to (∆, ˆz),
using Jacobian obtained from Eq.
(15). To complete
the integral in Eq. (D1), we make use of the well-known
identities

corresponding to the forward direction along the wiggler
axis, and φ = 0 to be the plane of electron motion. For a
2 c kw γ2/(K 2/2 + γ2 θ2) is the fundamen-
large K, ω1 ≈
tal radiation frequency, and

cos(z cos θ) =

ǫ2n(

)nJ2n(z) cos 2nθ ,

(D2)

Gm(K, γ θ, φ)

∞

n=0
X

−

∞

(
−
n=0
X

with, ǫ0 = 1, ǫn = 2 for n = 1, 2,

, and

· · ·

sin(z cos θ) = 2

)nJ2n+1(z) cos(2n + 1)θ .

(D3)

where, we deﬁne

All the other Fourier coeﬃcients, including the average
value
1/2, are obtained in the same manner.
We then obtain the Fourier series representation in Eq.
(21).

¯F (ζ)
i
h

−

=

and

(cid:0)

APPENDIX E: REAL PART OF THE
IMPEDANCE AND THE WIGGLER RADIATION
SPECTRUM

and in turn

[33] and that of Krinsky et al.

Our approach to calculate I(ω) is based on the paper
of Alferov et al.
[34].
The only diﬀerence is that we are dealing with large K
case, hence we could eliminate K from the equations as
was done for the impedance. Let us illustrate this in the
following. The energy radiated per electron per unit solid
angle per unit frequency interval per unit length is given
by

and

S1 ≡

∞

n=−∞
X

S2 ≡

∞

n=−∞
X

For ﬁnite, but large N ,

≈

4 m2
1
2 K 2 + γ2 θ2
2
m
−
(cid:19)
1 sin2 φ
+ (γ θ)2 S2

S1 +

S2

(cid:18)

(cid:0)

(cid:1)

[S1 γ θ cos φ

2 {

1

2 K 2 + γ2 θ2
2 γ θ cos φ

2

(cid:21)

,

(E2)

(cid:9)

,

(cid:1)

ξz ≡

4

K 2
K 2
2 + γ2 θ2

ξx ≡

2 K γ θ cos φ
K 2
2 + γ2 θ2

,

(E3)

(E4)

Jn(m ξz) J2n+m(m ξx) ,

(E5)

n Jn(m ξz) J2n+m(m ξx) .

(E6)

dI(ω)
dΩ

=

e2 γ2 N
c λw

∞

m=1
X

Gm(K, γ θ, φ)Hm

,

(E1)

ω
ω1 (cid:19)

(cid:18)

where m is the harmonic number of frequencies in the
spectrum. N is the number of periods of the wiggler.
The polar coordinates θ and φ are deﬁned so that, θ = 0

Hm

ω
ω1 (cid:19)

(cid:18)

=

sin2

N π

h
π2 N 2

ω
ω1 −

m

(cid:16)
ω
ω1 −

m

(cid:17)

(cid:16)

,

(cid:17)i
2

(E7)

determines the bandwidth of the radiation. In our theory,
we focus on an inﬁnite long wiggler, i.e., we are interested

9

ω1 δ(ω

. Under such condition, we have
in the limit of N
m ω1)/N . Now we are ready to get the
Hm →
radiation spectrum by integrating over the entire solid
angle.

→ ∞

−

Notice, the integrand has a period of π, hence we need
only integrate for one period. S1 and S2 are further sim-
pliﬁed as

I(ω) =

d θ sin θ

(E8)

π

0
Z

2π

d φ

d I(ω)
d Ω

.

0
Z

Due to the δ-function in Hm, the integral over θ could
be done ﬁrst. Also due to the fact that θ is small, we
θ. Then the integral in Eq. (E8) is
approximate sin θ
reduced into a 1-D integral as the following,

≈

and

I(k) =

∞

4 e2
c λw

m=1 Z
X

π
2

− π
2

d φ

m

(cid:18)

k
k0 (cid:19)

−

S1 cos φ

S1 +

S2

2
m

× 



1 sin2 φ
+ S2


−

(cid:18)

.

(cid:9)

2 cos φ

m

(cid:19)

k
k0

−

m

(cid:16)

2




(cid:17)
(E9)

S1 =

∞

n=−∞
X

Jn

k
2k0 (cid:19)

(cid:18)

×

J2n+m

cos φ

 

8k
k0 (cid:18)

s

m

−

k
k0 (cid:19)!

,

(E10)

∞

S2 =

n Jn

n=−∞
X

(cid:18)

×

J2n+m

cos φ

 

k
2k0 (cid:19)
8k
k0 (cid:18)

s

m

−

k
k0 (cid:19)!

.

(E11)

Now based on Eqs. (24) and (E9), we could compute

the real part of the impedance as

Re[Z(k)]

2 kw

≡

∞

m=1 Z
X

π
2

− π
2

d φ

m

(cid:18)

k
k0 (cid:19)

−

S1 cos φ

S1 +

S2

−

(cid:18)

2 cos φ

m

(cid:19)

2
m

× 








2

m

(cid:16)

k
k0

−





(cid:17)

+ S2

1 sin2 φ


. (E12)



Notice K is eliminated from this equation, as long as
K is large. We sum up the ﬁrst 30 harmonics to obtain
the real part of the normalized impedance up to the 4th
harmonic. Adding higher harmonics will not change the

impedance within this frequency region within numerical
accuracy. The result is identical to Fig. 5, supporting
the validity of our calculation.

[1] T.O. Raubenheimer, Progress in the Next Linear Collider
Design. AIP Conference Proceedings, Vol. 578 P. 53-64,
July 9, 2001; NLC ZDR Design Group, SLAC Report-
474, Stanford, USA, 1996.

[2] TESLA: The Superconducting Electron-Positron Linear
Collider with an Integrated X-Ray Laser Laboratory,
Technical Design Report, DESY, Germmany, March,
2001.

[3] Linac Coherent Light Source (LCLS) Conceptual De-
sign Report, SLAC-R-593, UC-414, Stanford, USA, April
2002.

[4] R. Warnock, P. Morton, Part. Accel. 25, 113 (1990).
[5] K.Y. Ng, Part. Accel. 25, 153 (1990).
[6] B.E. Carlsten, T.O. Raubenheimer, Phys. Rev. E 51,

1453 (1995).

[7] J.B. Murphy, S. Krinsky, R.L. Gluckstern, Part. Accel.,
57, 9 (1997); J.B. Murphy, S. Krinsky, R.L. Gluckstern,
Proc. 1995 IEEE Part. Accel. Conf., P. 2980 (IEEE, Pis-
cataway, NJ 1996); A. Faltens, L.J. Laslett, Part. Accel.,
4, 151 (1973).

[8] Ya.S. Derbenev, et al., DESY Report DESY-TESLA-

FEL-95-05, DESY, Germany (1995).

[9] Ya.S. Derbenev, V.D. Shiltsev, SLAC Report: SLAC-

PUB-7181, 1996.

[10] M. Dohlus, T. Limberg, Nucl. Instrum. Methods Phys.

Res., Sect. A 393, 494 (1997).

[11] E.L. Saldin, E.A. Schneidmiller, M.V. Yurkov, Nucl. In-
strum. Methods Phys. Res., Sect. A 398, 373 (1997); G.
Stupakov, P. Emma, Proc. 2002 Euro. Part. Accel. Conf.,
P. 1479 (Paris, France, 2002).

[12] R. Li, Proc. 1998 Euro. Part. Accel. Conf., P. 1230
(Stockholm, Sweden, 1998); R. Li, Nucl. Instrum. Meth-
ods Phys. Res., Sect. A 429, 310 (1999).

[13] H. Braun, F. Chautard, R. Corsini, T.O. Raubenheimer,

P. Tenenbaum, Phsy. Rev. Lett. 84, 658 (2000).

[14] H. Braun, R. Corsini, L. Groening, F. Zhou, A. Kabel,
T.O. Raubenheimer, R. Li, T. Limberg, Phsy. Rev. ST
Accel. Beams 3, 124402 (2000).

[15] S. Heifets, G. Stupakov, S. Krinsky, Phys. Rev. ST Accel.

Beams, 5, 064401 (2002).

10

[16] Z. Huang, K.-J. Kim, Phys. Rev. ST Accel. Beams, 5,

Res., Sect. A 458, 605 (2001).

[17] E.L. Saldin, E.A. Schneidmiller, M.V. Yurkov, Nucl. In-
strum. Methods Phys. Res., Sect. A 483, 516 (2002).
[18] G. Stupakov, S. Heifets, Phys. Rev. ST Accel. Beams, 5,

074401 (2002).

054402 (2002).

[19] J.M. Byrd et al., Proc. 2002 Euro. Part. Accel. Conf., P.
659 (Paris, France, 2002); J.M. Byrd et al., Phys. Rev.
Lett. 89, 224801 (2002).

[20] ˚A. Anderson et al., Opt. Eng. 39, 3099 (2000).
[21] M. Abo-Bakr et al., Proc. 2000 Euro. Part. Accel. Conf.,
P. 720 (Vienna, Austrain, 2000); M. Abo-Bakr et al.,
Phys. Rev. Lett. 88, 254801 (2002).

[22] U. Arp et al., Phys. Rev. ST Accel. Beams 4, 054401

(2001).

[23] G.L. Carr et al., Nucl. Instrum. Methods Phys. Res.,
Sect. A 463, 387 (2001); G.L. Carr et al., Nature 420,
153 (2002).

[24] B. Podobedov et al., Proc. 2001 IEEE Part. Accel. Conf.,
P. 1921 (IEEE, Piscataway, NJ, 2002); S. Kramer et
al., Proc. 2002 Euro. Part. Accel. Conf., P.1523 (Paris,
France, 2002).

[25] J.-M. Wang, Phys. Rev. E, 58, 984 (1998); J.-M. Wang,
C. Pellegrini, Brookhaven National Laboratory Report:
BNL-51236 (1979).

[26] J.B. Murphy, J.M. Wang, Nucl. Instrum. Methods Phys.

[27] M. Venturini, R. Warnock, Phys. Rev. Lett. 89, 224802

(2002).
[28] A. Wolski,
rameters,
http://awolski.lbl.gov/nlcdrlattice/default.htm).

“NLC Damping Rings:

and Resources”,

Information

Lattice Pa-
(URL:

[29] Y.-H. Chin, Proceedings,

the 4th Advanced ICFA
Beam Dynamics Workshop on Collective Eﬀects in
Short Bunches, Tsukuba, Japan, Sep. 24-29, 1990; also
Lawrence Berkeley National Laboratory Report: LBL-
29981, ESG-118, Dec. 1990.

[30] E.L. Saldin, E.A. Schneidmiller, M.V. Yurkov, Nucl. In-
strum. Methods Phys. Res., Sect. A 417, 158 (1998).
[31] A.W. Chao, Physics of Collective Beam Instabilities in
High Energy Accelerators (Wiley, New York, 1993).
[32] J. Wu, G. Stupakov, T. Raubenheimer, “Impact of the
Wiggler Coherent Synchrotron Radiation Impedance on
the Beam Instability”. SLAC-Report: SLAC-PUB-9629,
(To be submitted to Phys. Rev. ST - Accel. Beams, 2003).
[33] D.F. Alferov, Yu.A. Bashmakov, E.G. Bessonov, Zh.
Tekh. Fiz., 43, 2126 (1973); Eng. transl. in Sov. Phys.
Tech. Phys., 18, 1336 (1974).

[34] S. Krinsky, M.L. Perlman, R.E. Watson, Handbook on
Synchrotron Radiation, Vol. 1, P. 65, Edited by E.E.
Koch, North-Holland Publishing Company, 1983.

