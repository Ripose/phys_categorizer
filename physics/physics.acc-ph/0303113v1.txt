3
0
0
2
 
r
a

M
 
7
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
3
1
1
3
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

DEUTSCHES ELEKTRONEN-SYNCHROTRON

DESY 03-031

March 2002

A Method for Ultrashort Electron Pulse
Shape-Measurement Using Coherent
Synchrotron Radiation

Gianluca Geloni

Department of Applied Physics, Technische Universiteit Eindhoven,
P.O. Box 513, 5600MB Eindhoven, The Netherlands

Evgeni Saldin and Evgeni Schneidmiller

Deutsches Elektronen-Synchrotron DESY,
Notkestrasse 85, 22607 Hamburg, Germany

Mikhail Yurkov

Particle Physics Laboratory (LSVE), Joint Institute for Nuclear Research,
141980 Dubna, Moscow Region, Russia

A Method for Ultrashort Electron Pulse
Shape-Measurement Using Coherent
Synchrotron Radiation

G. A. Geloni a E. L. Saldin b E. A. Schneidmiller b
M. V. Yurkov c

aDepartment of Applied Physics, Technische Universiteit Eindhoven, The
Netherlands
bDeutsches Elektronen-Synchrotron (DESY), Hamburg, Germany
cJoint Institute for Nuclear Research, Dubna, 141980 Moskow region, Russia

Abstract

In this paper we discuss a method for nondestructive measurements of the longi-
tudinal proﬁle of sub-picosecond electron bunches for X-Ray Free Electron Lasers
(XFELs). The method is based on the detection of the Coherent Synchrotron Radi-
ation (CSR) spectrum produced by a bunch passing a dipole magnet system. This
work also contains a systematic treatment of synchrotron radiation theory which
lies at the basis of CSR. Standard theory of synchrotron radiation uses several
approximations whose applicability limits are often forgotten: here we present a
systematic discussion about these assumptions. Properties of coherent synchrotron
radiation from an electron moving along an arc of a circle are then derived and
discussed. We describe also an eﬀective and practical diagnostic technique based on
the utilization of an electromagnetic undulator to record the energy of the coher-
ent radiation pulse into the central cone. This measurement must be repeated many
times with diﬀerent undulator resonant frequencies in order to reconstruct the mod-
ulus of the bunch form-factor. The retrieval of the bunch proﬁle function from these
data is performed by means of deconvolution techniques: for the present work we
take advantage of a constrained deconvolution method. We illustrate with numerical
examples the potential of the proposed method for electron beam diagnostics at the
TESLA Test Facility (TTF) accelerator. Here we choose, for emphasis, experiments
aimed at the measure of the strongly non-Gaussian electron bunch proﬁle in the
TTF femtosecond-mode operation. We demonstrate that a tandem combination of
a picosecond streak camera and a CSR spectrometer can be used to extract shape
information from electron bunches with a narrow leading peak and a long tail.

2 July 2011

1 Introduction

Electron bunches with very small transverse emittance and high peak cur-
rent are needed for the operation of XFELs [1,2]. This is achieved using a
two-step strategy: ﬁrst generate beams with small transverse emittance using
an RF photocathode and, second, apply longitudinal compression at high en-
ergy using a magnetic chicane. The bunch length for XFEL applications is of
order of 100 femtoseconds. Since detailed understanding of longitudinal dy-
namics in this new domain of accelerator physics is of paramount importance
for FEL performance, experiments on this subject are planned in test facili-
ties. The femtosecond time scale is beyond the range of standard electronic
display instrumentation and the development of nondestructive methods for
the measurement of the longitudinal beam current distribution in such short
bunches is undoubtedly a challenging problem: in this paper we discuss one
of these methods, which is based on spectral measurements of Coherent Syn-
chrotron Radiation (CSR) produced by a bunch passing a dipole magnet or
an undulator.

After the compression stage, the CSR pulse can be analyzed, for example,
with a spectrometer. As we point out in Section 2, we can decompose the
coherent radiation spectrum, P (ω), into the product of the square modulus of
2, and the single particle radiation spectrum,
the bunch form factor,
p(ω) [3]. The CSR spectrum, then, provides information on the bunch form
2 from
factor, although one has to keep in mind that, in order to ﬁnd
P (ω), one needs the quantity p(ω).

¯F (ω)

¯F (ω)

|

|

|

|

Section 3 contains a systematic treatment of synchrotron radiation theory.
All the results presented in this section are derived from fundamental laws of
electrodynamics and the reader can follow the whole derivation process from
beginning to end. We use a synthetic approach to present the material: simple
situations are studied ﬁrst, and more complicated ones are introduced gradu-
ally. Previous experience in synchrotron radiation theory would be helpful but
is not absolutely necessary, because all the required material is independently
derived. In this respect our paper is reasonably self-contained.

A clear message in this work is that reexamination of dogmatic ”truths”
can sometimes yield surprises. For years we were led to believe that famous
Schwinger’s formulas [4] are directly applicable to the case of synchrotron ra-
diation from dipole magnet and even now no attention is usually paid to the
region of applicability of these expressions. While such formulas are valid in
order to describe radiation from a dipole in the X-ray range, their long wave-
length asymptotic are not valid, in general. Analytical study of this matter
was ﬁrst performed in the 80’s [5]. However, standard texts on synchrotron
radiation theory do not seem to provide a derivation of the expression for the

1

synchrotron radiation from an electron moving along an arc of a circle. In
Section 3 we present such a derivation, which we believe is quite simple and
instructive. Properties of coherent synchrotron radiation from dipole magnets
in the time domain are derived and discussed too.

Standard theory of synchrotron radiation relies upon other approximations
too, and it seems interesting to pay attention to their region of applicability.
To be speciﬁc, two important limitations are discussed. First, it is usually
assumed that the observer lies at inﬁnite distance from the source. Second,
people don’t pay attention to the fact that, in real experimental conditions,
the radiation is seen by the detector through some limited aperture. Thus,
both ﬁnite distance eﬀects and diﬀraction eﬀects are ignored. The aperture
sizes and the distances for which the latter assumptions are valid are so large,
in long wavelength range, as to be of limited practical interest. We can draw
at least two main conclusions from Section 3: ﬁrst, long wavelength radiation
spectrum distortions can arise, physically, from violation of the far zone as-
sumption or from aperture limitations (or both). Second, a CSR diagnostic
method based on the famous Schwinger’s formulas (or the ones derived in
[5]) is of purely theoretical interest. In real accelerators, the long wavelength
synchrotron radiation from bending magnet in the near zone integrates over
many diﬀerent vacuum chamber pieces with widely varying aperture and p(ω)
is usually a very diﬃcult quantity to calculate with great accuracy.

An eﬀective and practical technique based on the spectral properties of
undulator radiation can be used to characterize the bunch proﬁle function.
The method we describe in Section 4 uses an electromagnetic undulator and
it is based on recording the energy of coherent radiation pulses in the central
cone. This coherent radiation energy turns out to be proportional, per pulse,
to the square modulus of the bunch form-factor at the resonant frequency of
the fundamental harmonic. The measurement must be repeated many times
with diﬀerent undulator resonant frequencies (which are tuned by changing
the undulator parameters) in order to reconstruct the modulus of the bunch
form-factor.

The retrieval of the bunch proﬁle function from the modulus of its form
factor is preformed, in Section 5, by means of a deconvolution technique.
For the present work we choose a constrained deconvolution method. This
consists in ﬁnding the best estimate of the bunch proﬁle function, F (t), for
a particularly measured form-factor modulus,
, including utilization
of any a priori available information about F (t). In the end of the paper we
illustrate with a numerical example the potential of the proposed technique
for diagnostics at the TESLA Test Facility accelerator. Here we have chosen,
for emphasis, an experiment aimed at measuring the strongly non-Gaussian
electron bunch proﬁle at TTF, Phase 2 in femtosecond mode operation. The
femtosecond mode operation is based on the experience obtained during the

¯F (ω)

|

|

2

operation of the TTF FEL, Phase 1 [6] and it requires one bunch compressor
only. An electron bunch with a sharp spike at the head is prepared with an
rms width of about 20 microns and a peak current of about one kA. This
spike in the bunch generates FEL pulses with duration below one hundred
femtoseconds. We demonstrate that a tandem combination of a picosecond
streak camera and CSR spectrometer can be used to extract shape information
from electron bunches with a narrow leading peak and a long tail.

2 Physics of coherent synchrotron radiation

To begin our consideration, let us recall some well-known aspects of CSR.
From a microscopic viewpoint, the electron beam current at the entrance of
a bending magnet is made up of moving electrons arriving randomly at the
entrance of the bending magnet:

J(t) = (

e)

−

δ(t

tk) ,

−

N

Xk=1

·

) is the delta function, (

where δ(
e) is the (negative) electron charge, N
is the number of electrons in a bunch and tk is the random arrival time of
the electron at the bending magnet entrance. The electron bunch proﬁle is
described by the proﬁle function F (t). The beam current averaged over an
ensemble of bunches can be written in the form:

−

The proﬁle function for an electron beam with Gaussian current distribution
is given by:

J(t)

= (

e)NF (t) .

h

i

−

F (t) =

1
√2πσT

exp

 −

t2
2σ2

T !

.

and the probability of arrival of an electron during the time interval (t, t + d t)
is just equal to F (t) d t.

The electron beam current, J(t), and its Fourier transform, ¯J(ω), are con-

nected by

¯J(ω) =

∞

Z−∞

exp(i ωt)J(t) d t = (

e)

exp(i ωtk) ,

N

Xk=1

−

3

J(t) =

1
2π

∞

Z−∞

exp(

−

i ωt) ¯J(ω) d ω = (

e)

−

δ(t

tk)

−

N

Xk=1

and, therefore, the average value of

¯J(ω)

2 can be written as:

¯J(ω) ¯J ∗(ω)

= e2N + e2

i

exp(i ωtk)

exp(

i ωtn)

.

−

i

|

|

ih

Xk6=nh

exp(i ωtk)
The expression
i
proﬁle function F (t), since:

h

is nothing but the Fourier transform of the bunch

h

h

exp(i ωtk)

=

F (tk) exp(i ωtk) d tk = ¯F (ω) .

∞

i

Z−∞

Thus we can write:

¯J(ω)

2

|

i

h|

= e2N + e2N(N

1)

¯F (ω)

2 ,

−

|

|

where the Fourier transform of the Gaussian proﬁle function has the form:

¯F (ω) = exp

ω2σ2
T
2 !

.

 −

(1)

Above we described the properties of the input signal in the frequency
domain. The next step is the derivation of the spectral function connecting
the Fourier amplitudes of the output ﬁeld and the Fourier amplitudes of the
input signal. We will investigate the synchrotron radiation in the framework
of a one-dimensional model. Also, we will assume that the cross section of the
particle beam is small compared with the distance to the observer, so that
the path length diﬀerence from any point of the beam cross section to the
observer are small compared to the shortest wavelength involved.

The component of synchrotron radiation electric ﬁeld in time domain, Ex,y(t),

and its Fourier transform, ¯Ex,y(ω), are connected by

Ex,y(t) =

1
2π

∞

Z−∞

¯Ex,y(ω) exp(

i ωt) d ω ,

−

and the Fourier harmonic for ω < 0 is deﬁned by the relation ¯E∗(ω) = ¯E(
ω).
On the other hand, the Fourier harmonic of the electromagnetic ﬁeld and the

−

4

Fourier harmonic of the current at the dipole magnet entrance are connected
by:

¯Ex,y(ω) = Ax,y(ω) ¯J(ω) , ω > 0 ,

where Ax,y(ω) is the synchrotron radiation spectral function of the dipole.
Since the radiation power is proportional to the square of the radiation ﬁeld,
the averaged total power at a certain frequency ω is given by the expression:

P (ω) = p(ω)[N + N(N

1)

¯F (ω)

2] ,

−

|

|

(2)

where p(ω) is the radiation power from one electron. The ﬁrst term N in
square bracket represents ordinary incoherent synchrotron radiation with a
power proportional to the number of radiating particles. The second term rep-
resents coherent synchrotron radiation. The actual coherent radiation power
spectrum depends on the particular particle distribution in the bunch. For
photon wavelengths equal and longer than the bunch length, we expect all
particles within a bunch to radiate coherently and the intensity to be pro-
portional to the square of the number of N of particles rather than linearly
proportional to N, as in the usual incoherent case. This quadratic eﬀect can
greatly enhance the radiation since the bunch population can be from 108 to
1011 electrons. On the other hand the coherent radiation power falls oﬀ rapidly
for wavelengths as short or even shorter than the rms bunch length.

¯F (ω)

A method for estimating the bunch proﬁle function F (t) is to compute the
factor p(ω), to measure the CSR power spectrum P (ω) and to deduce the
2 from equation (2). However, it is clear that the retrievable
factor
information about the proﬁle function will, in general, not be complete, for
it is the particular measured square modulus of the form-factor that can be
obtained, not the complex form-factor itself.

|

|

3 Radiation from dipole magnet

The phenomenon of coherent synchrotron radiation has been introduced in
a conceptual way in the preceding section. As was pointed out, the CSR power
2,
spectrum is the product of the square modulus of bunch form-factor
and the single-particle power spectrum p(ω). Any diagnostics method based on
CSR must devote therefore attention to correctly determinate the synchrotron
radiation spectrum from one electron p(ω), for this quantity plays a critical
role in the form-factor measurement. In the present section we will deal with
the properties of the single-particle radiation in time and in frequency domain
as well as with the CSR properties in time domain. In order to give the sub-

¯F (ω)

|

|

5

Fig. 1. Geometry for synchrotron radiation production from a bending magnet

ject a semblance of continuity, it will be desirable to introduce considerable
matter which can be found in any of standard text on synchrotron radiation
theory (see for example [3],[7],[8]). The typical textbook treatment consists in
ﬁnding the expression for the synchrotron radiation spectrum from an electron
moving in a circle. However, no attention is usually paid to the region of ap-
plicability of the derived expressions. For instance, the standard extension of
the theory to the case of synchrotron radiation from dipole magnet is based on
the assumption that the energy spectrum formula is equivalent to the famous
Schwinger’s formula [4]. While this formula is valid for the X-ray range, it
does not provide a satisfactory description in the long wavelength asymptotic
[5]. Moreover Scwinger’s formulas are found in the limit of an inﬁnite observer
distance and under the approximation of no limiting aperture through which
the radiation is collected. Here we pay particular attention to the region of
applicability of Schwinger’s formulas; speciﬁcally, we derive expressions for the
time and frequency dependence of the electromagnetic radiation produced by
an electron moving along an arc of a circle, and we investigate how the CSR
ﬁeld pulse in the time domain is modiﬁed in more realistic situations.

3.1 Radiation ﬁeld in the time domain

Let us start reviewing how a single electron radiates as it moves in a dipole
˙~β, of magnitude
magnet. The electron is subjected to an acceleration, ˙~v = c
c2β2/R so that a distant observer detects the electric and magnetic ﬁelds in
the form of electromagnetic waves from the radiating electron. Fig. 1 shows
the relationship between the observer at a ﬁxed point P , whose coordinates are
(~r0, t), and the radiating electron at ( ~R, t′), t′ being the emission (or retarded)
time. The fundamental laws of electrodynamics tell that the electric ﬁeld of
e) moving along an arbitrary trajectory is given by the Lienard-
a charge (

−

6

Fig. 2. Synchrotron radiation production from circular motion. Directions of accel-
eration vector as seen by an observer at P , drawn in plane view

E

 (A.U.)

x

1.0

0.8

0.6

0.4

0.2

0.0

-0.2

7

-10

-8

-6

-4

-2

0

2

4

6

8

10

t

c

Fig. 3. Time variation of a synchrotron radiation pulse generated by a highly rela-
tivistic electron moving in a circle as seen by an observer in the orbital plane

Wiechert formula

~E(t) =

(

|

−
~r

e)
2

|

1
γ2 


(~n

(1

−

−
~n

~β)
~β)3 
r


·

+

(
c

e)
−
~r
|

|





~n

[(~n

×
(1

~β)
×
~β)3

−
~n

−

·

˙~β]

,


r


where ~n is a unit vector along the line from the point at which the radiation is
emitted at the emission time to the observation point at the observation time,
and we understand that the quantity in brackets must be evaluated at the
retarded time t′ = t
. The latter equation consists of two distinct

~r(t′)

1
c |

−

|

Fig. 4. Synchrotron radiation production from an arc of a circle. Directions of ac-
celeration vector as seen by an observer at P , drawn in plane view

 (A.U.)
E
x

1.0

0.8

0.6

0.2

0.0

0

 

-0.2

8

 

0.4

^
Magnet Length φ

 = 2.5
m

-2

2

ω
c

t

Fig. 5. Time variation of a synchrotron radiation pulse generated by a highly rel-
ativistic electron moving along an arc of a circle. The normalized bending angle is
ˆφm = γφm = 2.5

parts. The ﬁrst is inversely proportional to the square of the distance between
radiation source and observer, depends only on the charge velocity and is
known as velocity or Coulomb ﬁeld. The second is inversely proportional to
the distance from the charge, depends also on the charge acceleration and it
is known as acceleration or radiation ﬁeld. At large distances from the moving
electron, the acceleration-related term dominates, and it is usually associated
to the electromagnetic radiation of the charge. The region of space where
the radiation ﬁeld dominates is called a far (or wave) zone and the radiative

 (A.U.)
E
x

1.0

0.8

0.6

0.2

0.0

 

0.4

^
Magnet Length φ
 = 1.5
m

-2

0

 

2

ω
c

t

Fig. 6. Time variation of a synchrotron radiation pulse generated by a highly rel-
ativistic electron moving along an arc of a circle. The normalized bending angle is
ˆφm = γφm = 1.5

electric ﬁeld in the far zone is given by the formula

~Er(t) =

(
c

e)
−
~r0 |
|





~n

[(~n

×
(1

~β)
×
~β)3

−
~n

−

·

˙~β]

.


r


We can use (3) to look at all kinds of interesting problems. This is a compli-
cated expression, but it is easy enough to be used in a computer calculation
which can be further visualized as a geometrical picture. Such geometrical
pictures will give us a good qualitative description of the situation. Usual the-
ory of synchrotron radiation is based on the assumption that the electron is
moving on a circle and radiation is observed from the whole circular trajec-
tory, so that in each cycle we get a sharp pulse of electric ﬁeld. A far-ﬁeld
computation of the predicted time dependence of synchrotron radiation for
circular motion is presented in Fig. 3. The horizontal component of electric
ﬁeld plotted versus the normalized variable ωct, where ωc = 3γ3c/(2R) is the
critical frequency of synchrotron radiation. The ﬁeld in the orbital plane has
a zero around t = ω−1

. Numerically from Fig. 3 one obtains

c

(3)

(4)

∞

Z−∞

~Er d t = 0 .

9

 (A.U.)
E
x

1.0

0.8

0.6

0.2

0.0

-0.2

 

0.4

^
Magnet Length φ

 = 0.5
m

-2

0

 

2

ω
c

t

Fig. 7. Time variation of a synchrotron radiation pulse from a short bending magnet.
The normalized bending angle is ˆφm = γφm = 0.5

Fig. 8. Geometry for an inﬁnite uniform current progressing through an arc of a
circle and relative position of an observer

It is interesting to stress the fact that equation (4) is strictly related to the well-
known result that a uniformly charged ring does not radiate. In fact, starting
e)
from (4) one can show that a system of N identical equidistant charges (
moving with constant velocity v along a circle does not radiate in the limit
for N
e)N = const, and the electric and the magnetic ﬁelds of
−
the system are the usual static values.

→ ∞

and (

−

It is important to realize that (4) is valid only when the electron is moving
in a circle. But we now want to study synchrotron radiation from an electron

10

moving along the arc of a circle (see Fig. 4). By inspecting Fig. 5 - 7, one
can see that when the electron moves in arcs of circles with diﬀerent angular
extensions φm, the time-average of the electric ﬁeld is nonzero.

Let us consider for a moment (in parallel with what has been done in the
case of a circle) the case of inﬁnitely long electron bunch with the homoge-
neous linear density λ0 and current I =
evλ0. A current circuit consists of
the arc and semi-inﬁnite straight lines (see Fig. 8). The angle between the
straight lines is equal to the bending angle φm of the magnet. The fact that
the average electric ﬁeld from a single particle is diﬀerent from zero means
that the acceleration ﬁeld from our inﬁnite circuit must be diﬀerent from zero
too. Then we have deal with an intriguing paradox, since it is a well known
result that an uniform electron current does not radiate, not only in the case
of circular motion, but independently from the trajectory 1 .

−

|

, where

~r⊥ |
~r

It is possible to explain this contradiction in very simple terms as follows.
First of all we know that the velocity (electric) ﬁeld from a line current (in-
~r⊥ |
cluding our case) is proportional to 1/
is the distance of
the observer from the line charge. Second, in our case, the acceleration part
of the electric ﬁeld is proportional to 1/
is the distance of the
observer from the magnet (since the acceleration ﬁeld sources are strictly lim-
ited to the particles in the magnet only). The situation is depicted in Fig. 8:
the ratio
is ﬁnite for any position of observer therefore there is no
region in space where the acceleration ﬁeld dominates. This last observation
solves our paradox since, in the case of inﬁnite charge current in an arc of a
circle, we cannot talk about far zone at all, although a non-zero acceleration
ﬁeld is present.

, where

~r⊥ |

~r

~r

/

|

|

|

|

|

|

|

|

It is interesting to discuss, at this point, the shape of the coherent syn-
chrotron radiation ﬁeld pulse under diﬀerent trajectories. What we have been
dealing with before is simply a far ﬁeld analysis of the single-particle radiation
ﬁeld. When a large number of electrons move together, all the same way, the
total ﬁeld will be a linear superposition of the individual particle ﬁelds. Of
course the result depends upon the longitudinal distribution of the electrons.
One aspect of the problem that we can immediately deal with is the coher-
1/γ.
ent synchrotron radiation production from a ”short” magnet, i.e. φm ≪
We can assert that the ﬁeld appears as shown in Fig. 9. In fact the time-
dependence of the ﬁeld has, for every electron, the shape shown in Fig. 7 and
the total ﬁeld emitted by the electron bunch is represented by a sum of these
pulses, one for each radiating electron. In the limit for ”short” magnets, the
reader can easily come to the intuitive conclusion that the time proﬁle of the

1 It can be proved that the radiative interaction force in the longitudinal direction
(parallel, at any time, to the velocity vector by deﬁnition) is equal to zero at any
point of such circuit

11

Fig. 9. Coherent synchrotron radiation production from a ”short” magnet. The
time proﬁle of the electron bunch density is linearly encoded onto the electric ﬁeld
of the radiation pulse. Spikes correspond to spontaneous radiation, and average
value of electric ﬁeld corresponds to CSR. The width of the temporal proﬁle of the
electric ﬁeld corresponds directly to the electron bunch length, and the shape of the
temporal proﬁle is proportional to the longitudinal distribution within the bunch

electron bunch density is linearly encoded onto the electric ﬁeld of the radia-
tion pulse. The width of the temporal proﬁle of the electric ﬁeld corresponds
directly to the electron bunch length, and the shape of the temporal proﬁle is
proportional to the longitudinal bunch distribution.

We have just argued that the bunch density is linear encoded onto the elec-
tric ﬁeld as in Fig. 9; nevertheless, in Fig. 9, we illustrate small ﬂuctuations
which occur in the ﬁeld amplitude too. The reason for this is that the electron
bunch is composed of large number of electrons, thus ﬂuctuations always exist
in the electron beam density due to shot noise eﬀects. For any synchrotron
radiation beam there is some characteristic time, which determines the time
scale of the random ﬁeld ﬂuctuations. This characteristic time is called co-
herence time τc of synchrotron radiation and its magnitude is of the order
of the pulse duration from one electron. The physical signiﬁcance of these
ﬂuctuations is that there is a short wavelength radiation component of the
radiation in the range of the inverse pulse duration from a single electron.
Simple physical considerations show that the energy spectrum of this hard
radiation component is order of P (ω)
Np(ω). This explains the relation
between small ﬂuctuations of the radiation ﬁeld amplitude and spontaneous
(incoherent) emission of synchrotron radiation.

≃

Up to this point we only talked about coherent radiation from a ”short”
magnet. Ultimately we want to consider CSR production from an arc of a
circle. An easier step in this direction consists in the analysis of the CSR time
pulse from a circular motion. It is possible, indeed, to derive a simple analytical
expression for the CSR pulse from a bunch with an arbitrary distribution of

12

the linear density satisfying the following condition:

R
cγ3

d F (t)

d t ≪

F (t) .

The latter condition simply indicates that the characteristic length of the
bunch is much larger than R/γ3. Let us express the total CSR pulse as a
superposition of single particle ﬁelds at a given position in the far zone:

~ECSR(t) =

~Er(t

τ )NF (τ ) d τ ,

−

∞

Z−∞

where we calibrated the observer time in such a way that, when F (τ ) = δ(τ ),
the single particle radiation pulse has its maximum at t = 0. To calculate
the integral in (6) one should take into account the property (4) of the kernel
~Er(t
τ ) which has been discussed above. Using (4) and (5) one can simplify
equation (6) in the following way. The integral (6) is written down as a sum
of three integrals

−

τ )NF (τ ) d τ +

τ )NF (τ ) d τ ,

(7)

~ECSR(t) =

τ )NF (τ ) d τ

t−δ1

Z−∞

~Er(t

−

t+δ2

+

Zt−δ1

~Er(t

−

∞

Zt+δ2

~Er(t

−

where δ(1,2) satisfy the following conditions:

δ(1,2) ≫

R
cγ3 ,

d F (t)

δ(1,2)

d t ≪

F (t) .

The bunch proﬁle function is, therefore, a slowly varying function of the time
and we simply take F (τ ) outside the integral sign and call it F (t) when cal-
culating the second integral of (7):

t+δ2

Zt−δ1

~Er(t

−

τ )NF (τ ) d τ

NF (t)

≃

~Er(t

−

τ ) d τ .

Then we remember that the average of the electric ﬁeld over time is zero when
an electron is moving in a circle. As a result, we rewrite the integral in the

t+δ2

Zt−δ1

13

(5)

(6)

(8)

(9)

form:

t+δ2

Zt−δ1

~Er(t

−

τ ) d τ =

~Er(t

−

τ ) d τ +

~Er(t

−

τ ) d τ 

.

(10)

t−δ1

− 



Z−∞

∞

Zt+δ2




Taking into account (9) and (10), the expression for CSR pulse becomes

~ECSR(t) =

t−δ1

Z−∞

~Er(t

−

τ )NF (τ ) d τ

NF (t)

t−δ1

Z−∞

~Er(t

τ ) d τ

−

∞

+

Zt+δ2

~Er(t

−

τ )NF (τ ) d τ

NF (t)

−

~Er(t

−

τ ) d τ .

(11)

−

∞

Zt+δ2

Integrating by parts, the ﬁrst pair of integrals on the right hand side of (11)
can be joined in a single one; the same can be done with the second pair:

~ECSR(t) =

t−δ1

−

Z−∞

Φ

~Er
h

(t

τ )N

d F (τ )
d τ

d τ

∞

Φ

~Er
h

i

−

Zt+δ2

(t

τ )N

−

−

i
d F (τ )
d τ

d τ ,

(12)

where Φ
primitive of the radiation ﬁeld from one electron.

is a primitive of ~Er. What is left to do now is to evaluate a

~Er

h

i

To calculate the primitive of ~Er we use (3) and note that the electric ﬁeld
is expressed in terms of quantities at the retarded time t′. The calculation
is simpliﬁed if we use the following consideration: since, in general d t/ d t′ =
(1

~β) and

~n

−

·

d
d t′ 


~n

[(~n

×
(1

~n

−

~β)]
~β) 


×

·

=





~n

[(~n

×
(1

~β)
×
~β)2

−
~n

−

·

˙~β]

,





we also have

d
d t 


~n

[(~n

×
(1

~n

−

~β)]
~β) 


×

·

=





~n

[(~n

×
(1

~β)
×
~β)3

−
~n

−

·

˙~β]

.





Thus we can write ~ECSR(t) as

14

Fig. 10. Geometry for synchrotron radiation from circular motion

~ECSR(t) =

+

c

e
~r0 |

|

e
~r0 |
~n

×
(1

t−δ1

Z−∞

~n

[(~n

×
(1

~n

×

·

−





[(~n

~n

−

~β)]
~β) 


×

·

(t−τ )

~β)]
~β) 

d F (τ )
d τ

(t−τ )

N

c

|

∞

Zt+δ2





N

d F (τ )
d τ

d τ

d τ ,

(13)

.

|

−

τ )

1
c |

~r(t′)

where the quantity in brackets must be evaluated at the retarded time t′ =
(t

−
Now we would like to compute the quantities required for (13). Since (8)
holds, we can substitute the function in brackets in both integrals on the right
R/(cγ3). Because the
hand side of (13) with its asymptotic behavior at τ
angles are very small and the relativistic γ factor is very large, it is very useful
to express (13) in a small angle approximation. The triple vector product is
calculated from Fig. 10

≫

~n

[~n

×

×

~β] = ω0t′~ex + θ~ey .

Here θ is the vertical angle, ω0 = c/R is the revolution frequency and ~ex,y are
unit vectors directed along the x and y axis of the ﬁxed Cartesian coordinate
system (x, y, z) shown in Fig. 10. The deﬁnition of ~n and ~R can be used to
compute the scalar product in the denominator in (13) so that

~n

·

~β = β cos θ cos ω0t′

β(1

θ2/2)(1

(ω0t′)2/2) .

≃

−

−

We assume, here, that the vertical angle is small enough and we can leave out
the cosine factor. We can now write ~ECSR(t) as

(14)

(15)

15

~ECSR(t) =

∞

+

"

Zt+δ2

c




2e
~r0 |
|
(ω0t′~ex + θ~ey)
(ω0t′)2



t−δ1

"

Z−∞

(ω0t′~ex + θ~ey)
(ω0t′)2

N

d F (τ )
d τ

d τ

#(t−τ )

N

d F (τ )
d τ

#(t−τ )

.

d τ 




(16)

Yet, part of the integrand in (16) is still expressed as a function of t′, which
has to be converted in a function of t

τ using the explicit dependence

τ = t′ +

t

−

1
c |

~r(t′)

= t′

|

−

R
c

cos θ sin ω0t′ .

−

Since we assume the vertical angle is very small, we may use the replacement
cos θ

1. We can therefore approximate t

τ by

≃

t′ +

1
c |

~r(t′)

= |

|

~r0 |
c

+ t′(1

β) +

−

−
0(t′)3
ω2
6

.

We conventionally ﬁxed ~Er(0) as the maximum value of the ﬁeld (in time) and
R/(cγ3) only, therefore we can
we are interested in the asymptotic for τ
0(t′)3/6 . Solution of this equation allows us to write
τ = ω2
simply write t
−
equation (16) as

≫

~ECSR(t) =

|
[6ω0(t
h

t−δ1

+

Z−∞

2eN
~r0 |
c

∞




Zt+δ2

[6ω0(t
h

−
[6ω0(τ

τ )]1/3~ex + θ~ey
t)]2/3

i

d F (τ )
d τ

d τ

−



τ )]1/3~ex + θ~ey
τ )]2/3

i

−
[6ω0(t

d F (τ )
d τ

−

d τ

.






(17)

Limitation (8) indicates that the contribution from the integrands in the right
hand side of (19) are negligible in the region (t + δ2, t
δ1) and therefore we
can rewrite (19) in its ﬁnal form:

−

~ECSR(t) =

2eN
~r0 |
c

|

∞

"

Z−∞

ε(t
[6ω0 |

−
t

τ )~ex
τ

|

−

]1/3 +

θ~ey
t

−

[6ω0 |

τ

]2/3 #

|

d F (τ )
d τ

d τ .(18)

where

ε(t

τ ) = 1

for 0 < (t

τ ) <

,

ε(t

τ ) =

1
−

for

− ∞

< (t

−

−

∞
τ ) < 0 .

−

−

16

(A.U.)
E
x

1.0

0.8

0.6

0.4

0.2

0.0

-0.2

-3000

-2000

-1000

0

1000

2000

3000
ω
t
c

Fig. 11. Time structure of a CSR pulse from a Gaussian electron bunch moving in
a circle. Here θ = 0. Circles present the results obtained from direct superposition
of single particle pulses, while the solid line corresponds to the shape calculated by
means of (18). The rms bunch length is σT = 100λc/c, where λc = 4πR/(3cγ3)

It might be worth to remark that the ultimate reason for using the auxiliary
times δ(1,2) in the derivation of (18) is that they help recognizing the validity
of the asymptotic substitution, since otherwise a direct integration by parts
of (6) would immediately give

~ECSR(t) =

e
~r0 |

|

c

∞

Z−∞

~n

[(~n

×
(1

~n

−

~β)]
~β) 


×

·





(t−τ )

N

d F (τ )
d τ

d τ .

Under the accepted limitation on the axial gradient of the beam current, this
equation transforms to (18).

As an example we show how to use (18) in order to calculate the CSR
pulse. Let us concentrate on the CSR radiation produced in the orbital plane.
In this case θ = 0 and it is obvious that the radiation for such an observer
is horizontally polarized. To be speciﬁc, we consider an electron beam with a
Gaussian axial proﬁle of the current density

F (t) =

1
√2πσT

exp

 −

t2
2σ2

T !

,

17

where σT is the rms electron pulse duration. The rms is assumed to be large,
R/(cγ3). When θ = 0 and bunch proﬁle is Gaussian proﬁle, we can
σT ≫
write (18) in the form

Ex(t) =

2(

−
(2π)1/261/3σ3

e)N
Tω1/3
0 c

∞

~r0 |

|

Z−∞

τ )τ
1/3 exp

ε(t
t

−
τ

|

−

|

τ 2
2σ2

T !

 −

d τ .

(19)

Fig. 11 presents comparative results obtained by means of analytical calcula-
tions (solid curve, calculated with (19)) and numerical results (circles, calcu-
lated by direct superposition of single pulses from (6)). It is seen from these
plots that there is a very good agreement between numerical and analytical
results.

It is relevant to make some remarks about the region of applicability of
(18). It is important to realize that (18) is valid only when the electrons
are moving in a circle and the observer is located in such a way that both
the velocity term in Lienard-Wiechert formula can be neglected and the unit
vector ~n can be considered constant. Another basic assumption is that the
current density changes slowly on the scale of R/γ3. As a rule, this condition
is well satisﬁed in all practical problems. It should be also mentioned that
the above expressions are good approximations only for small enough vertical
angles (even though they may be immediately generalized). In fact we used
the replacement cos θ
1 in the retardation equation and, in practice, such an
(σ/R)2/3, where σ is the characteristic
assumption is valid for the range θ2
length of electron bunch.

≪

≃

Now we want to extend the latter results to the case of an arc of a circle.
At this point we ﬁnd it convenient to impose the following restriction 2 : we
focus only on the radiation seen by an observer lying at large distance from
the sources, on the tangent to the electrons orbit at the middle point of the
magnet. In this case we can continue to use the ﬁxed coordinate system (x, y, z)
shown in Fig. 10. The observation point and the vector ~n are within the (y, z)-
plane and radiation is emitted at an angle θ with respect to the z-axis. Let us
start expressing the total CSR pulse as a superposition of single particle ﬁelds
at the given position in the far zone. In the case of an arc of a circle equation
(6) modiﬁes as follows:

~ECSR(t) =

τ )NF (τ ) d τ .

t+T

Zt−T

~Er(t

−

(20)

2 The reader can wonder why it is necessary to describe this particular situation.
The answer is that this is a diﬃcult subject, and the best way to study it is to do it
slowly. Although here we deal with a particular example, all the expressions which
we derive are immediately generalizable

18

Here the time T in the integration limits is in loco of a window function in
the integrand, in order to cut the contributions of the single particle radia-
tion pulse when the electron is not in the arc. This expression contains the
observation time T , which should be replaced by the retarded time t′
e. The
two times are related by

2T = t′

e +

~r(t′
e)

1
c |

1
c |

,

~r0 |

| −

where t′
analysis focuses on the case of a long bending magnet, γφm ≫
and (5), the ﬁeld of the CSR pulse is readily shown to be

e = φm/(ω0) and φm is the bending magnet angular extension. Our
1. Using (4)

~ECSR(t) =

~Er(t

τ )NF (τ ) d τ

NF (t)

t−δ

Zt−T

−

t−δ

Z−∞

~Er(t

τ ) d τ

−

t+T

+

Zt+δ

~Er(t

−

τ )NF (τ ) d τ

NF (t)

−

~Er(t

−

τ ) d τ .

(21)

−

∞

Zt+δ

As we have already done previously, we assume that δ satisﬁes condition (8).
Adding and subtracting suitable edge terms one can still perform integration
by parts, thus obtaining:

t+T

Z−∞

~ECSR(t) = NF (t + T )

~Er(t

τ ) d τ

NF (t

T )

−

−

−

~Er(t

τ ) d τ

−

t−δ

Φ

~Er

(t

h

i

−

Zt−T

τ )N

−

d F (τ )
d τ

d τ

t+T

Φ

~Er

(t

h

i

−

Zt+δ

τ )N

−

d F (τ )
d τ

d τ .

(22)

t−T

Z−∞

Since condition (8) holds for δ we may substitute the 3rd and the 4th integral
in (22) with a single integral in which the primitive, Φ
, is substituted by its
~EA
r

~Er
h
asymptotic for large values of the argument, Φ
. Under the assumption
of a long bending magnet (ωcT
1) the 1st and the 2nd integral can be
i
expressed by means of the primitive asymptotic too. Moreover, we can perform
a change of variables in all the integrals t
τ . As a result expression (22)
can be written in the form:

→

≫

−

τ

h

i

~ECSR(t) =

NF (t + T )

~EA

r (τ ) d τ

−

NF (t

T )

−

−

~EA

r (τ ) d τ

T

Z∞

∞

Z−T

19

T

Φ

~EA
r
h

i

−

Z−T

(τ )N

τ )

d F (t
−
d τ

d τ .

(23)

(24)

~Er
Using the ultrarelativistic approximation we can calculate a primitive Φ
using (14) and (15). Again we assume that the vertical angle is very small so
i
that we may use the replacement cos θ

1. In this situation we have

h

≃

~n

[(~n

×
(1

~n

×

·

−

~β)]
~β) ≃

ω0t′~ex + θ~ey
(ω0t′)2/2

This quantity must be evaluated at the retarded time t′
tution these expressions in (23) gives

≃

[6τ /ω2

0]1/3. Substi-

~ECSR(t) =

2eN
~r0 |
c
+ [F (t + T ) + F (t

|

T




Z−T

"


−

T )]

[F (t + T )

F (t

T )]

−

−

−

]1/3 +

ε(τ )~ex
τ

|

[6ω0 |
~ex
(6ω0T )1/3
θ~ey
(6ω0T )2/3 )

,

θ~ey
τ
[6ω0 |

|

τ )

d F (t
−
d τ

d τ

]2/3 #

where T = φ3

m/(12ω0).

As an example of the application of this expression, consider the situation
when θ = 0 and bunch proﬁle is a Gaussian. According to (24) the CSR ﬁeld
in this case is given by

Ex(t) = G1(t) + G2(t)

where

G1 =

−
(2π)1/261/3σ3

2(

e)N
Tω1/3
0 c

T

ε(τ )(t
τ

|

|

~r0 |

|

Z−T

τ )

−
1/3

exp

(t

τ )2

−
2σ2

T !

 −

d τ ,

2eN

G2 =

(2π)1/261/3σT(ω0T )1/3c

~r0 |

|

exp
"

 −

(t + T )2
2σ2

T !

+ exp

(t

T )2

−
2σ2

T !#

.

 −

Fig. 12 presents the results of calculations with the analytical formula (24).
Comparison with numerical results shows a very good agreement.

20

^ρ = 2.0 

 = 100 L
o

f

 Convolution with r
 G
 + G
2
1
 G
1
 G
2

-4

-2

2

4

(σ/c)-1 t 

(A.U.)
E
x

1.0

0.8

0.6

0.4

0.2

 

0

 

0.0

-0.2

-0.4

-0.6

Fig. 12. Time structure of the CSR pulse from a Gaussian electron bunch moving
along an arc of a circle. Here θ = 0, ˆρ = φ3
m/(6ω0σT) = 2. The physical meaning
of the magnet length parameter ˆρ will be clear after reading Section 3.3. Circles
present the results obtained from direct superposition of single particle pulses. The
solid line corresponds to the shape calculated by means of (24)

3.2 Radiation ﬁeld in the frequency domain

Let us now go back to our single particle treatment and proceed to the
calculation of the spectrum of the electromagnetic radiation produced by an
electron during a dipole magnet pass. We know that, in general, for any kind
of motion

d2 W
d Ω d t

c

~r

|

=

2

~E(t)

|

|
4π

2

|

.

~E

|

2 is the squared modulus of the electromagnetic ﬁeld vector at
Here
the observation point. The stationary observer who is detecting the radiation
emitted into the solid angle d Ω measures the total energy as

|

d W
d Ω

=

c

2

|

~r0 |
4π

∞

|

Z−∞

~Er(t)

2 d t ,

|

~r
where we used the fact that, in the far ﬁeld approximation, the distance
|
|
~r0 |
=
is much larger than
(see Fig. 1). From the discussion above, we know that the radiation pulse is
emitted over a very short period of time so that the only ﬁnite contribution
to this integral comes from times close to t = 0. Extension of the integral to

, and the zero order expansion reads

~r(t′)

~R

|

|

|

|

|

21

(25)

(26)

inﬁnite times is only a mathematical convenience which does not aﬀect the
physical result.

The general method to derive the frequency spectrum is to transform the
electric ﬁeld from the time domain to the frequency domain.Expressing the
electrical ﬁeld ~Er(t) by its Fourier transform, we set

~Er(ω) =

~Er(t) exp(

i ωt) d t .

−

∞

Z−∞

Applying Parseval’s theorem we have

∞

|

Z−∞

~Er(ω)

2 d ω = 2π

|

~Er(t)

2 d t

|

∞

|

Z−∞

and the total absorbed radiation energy from a single pass is therefore

d W
d Ω

=

c
8π2 |

2

~r0 |

∞

|

Z−∞

~Er(ω)

2 d ω .

|

Evaluating the electric ﬁeld by Fourier components we derive an expression
for the spectral distribution of the radiation energy

d2 W
d ω d Ω

=

c
4π2 |

2

~r0 |

|

~Er(ω)

2

|

In order to calculate the Fourier transform we can use (3) and note that
the electric ﬁeld is expressed in terms of quantities at the retarded time t′.
The calculation is simpliﬁed if we express the whole integrand in (25) at the
~r(t′)
retarded t′ remembering t′ = t

:

~Er(ω) =

(
c

e)
−
~r
|

|

∞

Z−∞





~n

[(~n

×
(1

−

1
c |
~β)
×
~β)2

−
~n

−

·

|
˙~β]





exp[i ω(t′+

/c)] d t′ .

~r

|

|

~R

~r(t′)

|

|
~r(t′)

is much larger than
=

Since the distance
, the zero order approxi-
|
(see Fig. 1). However, such approximation
mation would make
is not good enough in the exponential factor and we must take the next ap-
~n
~r0 | −
proximation order writing
|
˙~β]
~β)
×
~β)2

~R(t′). Therefore we get

~r0 |
|
~r(t′)
=

~R(t′)/c)] d t′ . (27)

exp[i ω(t′

~Er(ω) =

×
(1

(
c

−
~n

[(~n

−

~n

~n

∞





|

·

·

|

|

|

|

e)
−
~r0 |
|

Z−∞



−

·



22

We established some basic equations in the frequency domain with which we
can start calculations for individual problems. Analytical calculations can be
performed without big diﬃculty in two limiting cases, namely the case of
circular motion and ”short” magnet.

3.2.1 Radiation from circular motion

In his paper on synchrotron radiation, Schwinger gives remarkable formulas
for the radiation spectrum in the case of an electron moving in a circle [4].
One can ﬁnd textbooks telling that Schwinger’s formulas apply to the analysis
of synchrotron radiation from an electron moving along the arc of a circle too
(see for example [8]). This extension is not a physical law: it is merely the
statement of an approximation which is valid about the entire wavelength
range interesting for the ordinary user. In this context, a critical study of
the theoretical status of Schwinger’s formulas seems to be of considerable
importance.

We are going to apply (27) to our analysis of synchrotron radiation from
circular motion taking advantage of an expression we previously used in Sec-
tion 3.1: in the case of circular motion ~Er(ω) can be evaluated remembering
that

d
d t′ 


~n

[(~n

×
(1

~n

−

~β)]
~β) 


×

·

=





~n

[(~n

×
(1

~β)
×
~β)2

−
~n

−

·

˙~β]

,





Integration by parts yields

∞

Z−∞




~n

=

×

(1

~n

[(~n

×
(1

~β)
×
~β)2

−
~n

−

·

~β]
~β)

[~n

~n

×

·

−
∞

exp

˙~β]




i ω(t′
h

exp[i ω(t′

~n ~R(t′)/c)] d t′

−

~R(t′)/c)

~n

·

−

t′=∞

(cid:12)
(cid:12)
t′=−∞
i
(cid:12)
(cid:12)
(cid:12)
(cid:12)
~R(t′)/c)

i ω

−

Z−∞

~n

[~n

×

×

~β] exp

i ω(t′
h

~n

·

−

d t′ .

i

(28)

The reason for using integration by parts is that the contribution from the
ﬁrst term (which to be evaluated at t′ =

) is zero. Thus we can write

±∞

d2 W
d ω d Ω

=

∞

e2ω2
4π2c (cid:12)
(cid:12)
Z−∞
(cid:12)
(cid:12)
(cid:12)
(cid:12)

~n

[~n

×

×

~β] exp

i ω(t′
h

~n

·

−

~R(t′)/c)

d t′

.

(29)

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

i

23

We must emphasize, however, that this expression is not valid in general, but
only when a particle is moving in a circle.

The integrand in (29) can be expressed in components to simplify the inte-
gration. If we look in the plane of the circle, radiation does not depend upon
the azimuthal angle. There is a better way to write out the integrand in (29)
by making use of the azimuthal symmetry, which allow one to use again the
ﬁxed coordinate system (x, y, z) shown in Fig. 10. The observation point is
far away from the source point and we focus on the radiation that is centered
about the tangent to the orbit at the source point. The observation point P
and the vector ~r and ~n are therefore within the (y, z)-plane and radiation is
emitted at angle θ with respect to the z-axis. Following the above discussion
the azimuthal angle is constant and set to φ = π/2. The deﬁnition of ~n and
~R can be used to compute the scalar product in the exponential term in (29)
so that

~R = R cos θ sin ω0t′ ,

~n

·

where θ is the vertical angle and ω0 = c/R. Since the angles are small and the
relativistic γ factor is large, we can replace

cos θ

1

≃

−

θ2/2 ,

sin ω0t′

ω0t′

0(t′)3/6 .
ω3

≃

−

Therefore the exponential factor becomes

t′

−

R
c

cos θ sin ω0t′ =

1 + γ2θ2

+

t′
2γ2

(cid:16)

c2(t′)3
6R2

.

(cid:17)

The triple vector product in (27) can be evaluated in a similar way as

~n

[~n

×

×

~β] = ω0t′~ex + θ~ey ,

We can now write ~Er(ω) as

∞

(
−
c
|

e)ω
~r

|

θ exp

~ex 

Z−∞


t′
2γ2


i ω

 

 

ω0t′ exp

i ω

 

 

1 + γ2θ2

+

(cid:16)

(cid:17)

t′
2γ2

1 + γ2θ2
(cid:16)
c2(t′)3
6R2 !!

d t′



(cid:17)

+

c2(t′)3
6R2 !!

d t′




(30)

~Er(ω) =

∞

+~ey 
Z−∞


.








The integrals in (30) can be expressed in terms of modiﬁed Bessel functions

24

as ﬁrst pointed out by Schwinger [4]. For this we need a change of variables
as follows:

τ =

γω0t′
(1 + γ2θ2)1/2 ,

ξ =

ω
2ωc

3/2

,

1 + γ2θ2
(cid:16)

(cid:17)

where ωc = 3γ3ω0/2. With these substitutions we get integrals of the form

∞

∞

Z0

Z0

τ sin

3
2

ξ

(cid:18)

(cid:18)

τ +

1
3

τ 3

(cid:19)(cid:19)

d τ =

K2/3(ξ) ,

cos

3
2

ξ

(cid:18)

(cid:18)

τ +

1
3

τ 3

(cid:19)(cid:19)

d τ =

K1/3(ξ) ,

1
√3

1
√3

The Fourier transform of the electrical ﬁeld (30) ﬁnally becomes

~Er(ω) =

γ(1 + γ2θ2)

√3(
c

|

−
~r0 |

e)ω
ωc

K2/3(ξ)~ex + i
"

γθK1/3(ξ)
(1 + γ2θ2)1/2 ~ey

#

.

Using (26) we get an expression for the spectral distribution:

d2 W
d ω d Ω

=

3e2ω2
4π2cω2
c

γ2(1 + γ2θ2)2

K 2

2/3(ξ) +

"

γ2θ2
1 + γ2θ2 K 2

1/3(ξ)

.

#

(31)

Quite often an observer is interested in the synchrotron radiation energy emit-
ted over all vertical angles. Integration of equation (31), over the angle θ gives
the required result. We note that the solid angle d Ω = d θ d φ and that radi-
ation does not depend upon the azimuthal angle. So we can write

d2 W
d ω d φ

=

3e2ω2γ2
4π2cω2
c

∞

Z−∞

(1 + γ2θ2)2

K 2
"

2/3(ξ) +

γ2θ2K 2

1/3(ξ)
1 + γ2θ2 #

d θ .

(32)

The angle θ appears in (32) in rather a complicated way which makes it diﬃ-
cult to perform the integration directly. We shall not describe the integration
process in detail, not only because it is available in the form of comprehensive
treatises [3], but also because this is a pure mathematical problem. If we look
it up in [3] we see that (32) can be written as

d2 W
d ω d φ

=

√3e2γ
4π

∞

Zω/ωc

ω
ωc









25

K5/3(y) d y

.

(33)

Fig. 13. Radiation ﬁeld from an electron moving along a circle in the time and in
the frequency domain

Fig. 14. Radiation ﬁeld from an electron moving along an arc of a circle in the time
and in the frequency domain

Equation (33) is the required expression for the frequency spectrum of the
radiation from an electron moving along a trajectory which is a circle. For a
small argument ω/ωc ≪
1 we may apply an asymptotic approximation for the
modiﬁed Bessel’s function and get

ω
ωc

∞

Zω/ωc

K5/3(y) d y

1.33

≃

for ω/ωc ≪

1 .

1/3

ω
ωc (cid:19)

(cid:18)

Most textbooks on synchrotron radiation discuss equation (33). However, no
attention is usually paid to the region of applicability of this equation. Calcu-
lations which led to (33) are only valid for an electron moving in a circle. On
the other hand we want to study synchrotron radiation from a dipole mag-
net too. Consider what would happen if, instead of an electron moving in a
circle, we had an electron which moves along the arc of a circle. Fig. 13-15

26

Fig. 15. Radiation ﬁeld from an electron moving along a short bending magnet in
the time and in the frequency domain

sketch the expected frequency spectrum. These ﬁgures provide an illustration
of the transition from the usual synchrotron radiation by an electron in a
circle to radiation by an electron moving along an arc of a circle. The ﬁrst
sketch (Fig. 13) describes radiation from a circle. It is useful to consider fur-
ther the relationship between the time domain and the frequency domain. The
frequency spectrum of the radiation pulse is given by the expression (33): the
Fourier transform at ω = 0, ¯E(0), is zero because E(t) averages to zero (see
Fig. 3).

In the case of dipole magnet, things are quite diﬀerent. The frequency spec-
trum may be obtained calculating the Fourier transform of the time distri-
bution of the electric ﬁeld at the observer’s position. It can be obtained nu-
merically without much work by noticing that we can use curves in Fig. 5-7.
As a result, we can deﬁne general properties of the spectrum without any
analytical calculations. Consider Fig. 14, 15. As these curves illustrate, when
the electron moves along an arc of a circle, the spectral distribution does not
tend to zero when ω
0. Although this fact may look surprising, this is quite
natural, since the average of the electric ﬁeld over time is nonzero when an
electron moving along the arc of a circle.

→

3.2.2 Radiation from an electron moving along the arc of a circle

Many texts on synchrotron radiation theory do not seem to provide a deriva-
tion of the expression for the radiation spectrum from an electron moving
along an arc of a circle. Here we present such a derivation, which we believe
to be quite simple and instructive. Analytical studies of this problem were
ﬁrst performed in [5]. A similar treatment may also be found in the book [9].
Our consideration is restricted to the simplest case from an analytical point
of view, namely the case of a bending angle φm very small compared with

27

Fig. 16. Geometry for synchrotron radiation from an electron moving along an arc
of a circle

the 1/γ. No assumptions on the magnetic ﬁeld parameters have been made
to derive the radiation spectrum in the form of equation (27): therefore, our
starting point is the same as that for the radiation spectrum calculation from
a circular motion in the previous subsection. Introducing the notation

~G(t′) =

~n

[(~n

×
(1

~β)
×
~β)2

−
~n

−

·





˙~β]

,





we rewrite (27) in the form:

~Er(ω) =

(
c

e)
−
~r0 |
|

∞

Z−∞

~G(t′) exp[i ω(t′

~R(t′)/c)] d t′ ,

~n

·

−

Now we have to perform the integration. The function ~G(t′) is a smooth curve
and does not vary very much across the very narrow bending angle region in
the case of a short magnet: therefore we may replace it by a constant. In other
words, we simply take ~G(t′) outside the integral sign and call it ~G0. In this
case the integral over t′ in the latter equation is calculated analytically

exp[i ω(t′

~n ~R(t′)/c)] d t′

Lm/(2cβ)

Z−Lm/(2cβ)

~Er(ω) =

e) ~G0
~r0 |
sin

(
−
c
|
e) ~G0Lm
−
~r0 |
c

|

(

=

(1

~n~β)ωLm/(2cβ)
~β)ωLm/(2cβ)

i

−
~n

.

h
(1
h

−

·

−

i

28

(34)

Next we compute the quantities required for expressing explicitly the latter
equation. If the system has no azimuthal symmetry, the angular distribution
of radiation depends on two variables. These may be taken (Fig. 16) to be the
z plane, and the azimuthal angle φ. We can
angle θ between ~n and the x
˙~β, and ~n as:
now write down the components of the vectors ~β,

−

~β = β~ez ,

˙~β = ˙β~ex =

β2c
R

~ex ,

~n = cos θ sin φ~ex + sin θ~ey + cos θ cos φ~ez .

These deﬁnitions can be used to get the triple vector product

~n

[(~n

×

−

~β)

×

˙~β] = ˙β

cos2 θ sin2 φ

1 + β cos θ cos φ

~ex

h(cid:16)
+ (sin θ cos θ sin φ) ~ey +

cos2 θ cos φ sin φ

(cid:17)
β cos θ cos φ

~ez

.

(35)

−

−

(cid:16)

(cid:17)

i

We can use these expressions to compute the Fourier transform (34). The
spectral distribution is proportional to the square of electric ﬁeld and if we
follow through the algebra we ﬁnd that

d2 W
d ω d Ω

=

e2L2
m
4π2R2c

σ + A2
π)

(A2
β cos θ cos φ)4

sin2 [(1
[(1

β cos θ cos φ)ωLm/(2cβ)]

−
β cos θ cos φ)ωLm/(2cβ)]2

,

(1

−

−

where the following notation has been introduced: Aσ = sin φ
−
Aπ = cos θ cos φ. The quantities Aσ, Aπ are characteristics of the σ
components of the single-particle linearly polarized radiation.

−

β sin θ and
and π

−

We emphasize the following features of this result. The radiation is very
much collimated in the forward direction, most of the energy being emitted
within the cone ∆Ω = ∆φ∆θ of γ−2. The radiation maximum is reached
at θ = 0, φ = 0. Spectral properties of the radiation are deﬁned by the
function [sin2 ω/ωc]/[ω/ωc]2, where the critical frequency is ωc = 2c/[(1
−
β cos θ cos φ)Lm]. The spectrum from an electron in a ”short” magnet is prac-
tically ”white noise” spreading from zero up to the frequencies ω
ωc. As one
can see, the spectral properties of radiation considered here are signiﬁcantly
diﬀerent from those of synchrotron radiation from an electron moving in a
circle 3 .

≃

3 There is an obvious analogy between the synchrotron radiation from ”short”
magnet and radiation from bremsstrahlung eﬀect. The mathematics of the two
problems is essentially the same

29

3.3 Limitations of standard results

|

|

|

As already pointed out, we can decompose the CSR spectrum, P (ω), into
¯F (ω)
2 with the
the product of the square modulus of bunch form-factor
|
¯F (ω)
2 from P (ω), one
radiation spectrum from one electron p(ω). To ﬁnd
needs the quantity p(ω), which is usually very diﬃcult to know with great
accuracy within the long wavelength range. Actually, as already discussed,
the well-known theory of synchrotron radiation uses approximations which
are valid under certain conditions, inappropriate under others. In particular,
Schwinger approach relies on several assumptions, which we review once again:
ﬁrst, the observer is located in such a way that the velocity term in the Lienard-
Wiechert formula can be completely neglected and that the unit vector ~n can
be considered constant throughout the electron evolution. Second, a circular
trajectory is postulated. Finally, no aperture limitations is considered at all.
These assumptions must be analyzed in order to understand how the CSR
pulse is altered in realistic situation. In this subsection we will deal separately
with all of them.

Let us imagine that our electron bunch moves along an arc of a circle and
that there is no aperture limitation. We can take into account, then, eﬀects
as a ﬁnite distance between the source and observer, a ﬁnite magnet length
and the presence of velocity ﬁelds by means of (6) where the expression for
the electric ﬁeld is given by the strict Lienard-Wiechert formula. Analytical
methods are of limited use in the study of CSR in the near zone, and numerical
calculations must be selected. The application of similarity techniques allows
one to present numerical results in such a way that they are both general and
directly applicable to the calculation of speciﬁc device situations. The use of
similarity techniques enables one not only to reduce the number of parameters
but also to reformulate the problem in terms of variables possessing a clear
physical interpretation. Each physical factor inﬂuencing the CSR production
is matched by its own reduced parameter. For the eﬀect under study this
reduced parameter is a measure of the corresponding physical eﬀect. When
some eﬀect becomes less important for coherent radiation, it simply falls out
of the number of the parameters of the problem.

For our present purposes we would like to concentrate completely on the
temporal structure of the CSR pulse. For any CSR pulse there exist some
characteristic time, which determines the CSR pulse duration. Its magnitude is
of order of the inverse of the frequency spread in the CSR beam. The behavior
of the CSR pulse proﬁle as a function of dimensionless parameters provides
information on the spectrum distortion. To be speciﬁc, we consider the case of
an electron beam with a Gaussian axial proﬁle of the current density. When
comparing the temporal structure of CSR pulses, it is convenient to use a
normalized ﬁeld amplitude: here, the normalization is performed with respect

30

to the maximal ﬁeld amplitude. The rms electron pulse duration is assumed
R/(cγ3) and we focus on the radiation pulse seen about the
to be large σT ≫
tangent to the orbit at the middle point of magnet. When the vertical angle
θ = 0 the normalized coherent ﬁeld amplitude Ex(t)/Emax is a function of six
dimensional parameters:

t ,

v , R , Lm ,

σT ,

~r0 |

|

.

It is relevant to note that only two dimensions (length and time) are suﬃcient
for a full description of the ﬁeld proﬁle: after appropriate normalization it is
a function of four dimensionless parameters only:

Ex(t)/Emax = ˆEx = D(ˆt, ˆσ, ˆρ, ˆr0) ,

(36)

where ˆt = t/σT is the dimensionless time, ˆσ = ω0σTγ3 is the dimensionless
(cσT)−1/3R−2/3 is the dimensionless distance
electron pulse duration,
between source and observer, ˆρ = φ3
m/(6ω0σT) is the magnet length parameter.
In the general case the universal function D should be calculated numerically
by means of strict Lienard-Wiechert formulas.

~r0 |

|

The changes of scale performed during the normalization process, mean that
we are measuring time, bunch length, distance from the source and magnet
length as multiples of ”natural” CSR units. There is a physical reason for being
able to write the ﬁeld proﬁle as in (36): let us explain this fact beginning with a
qualitative analysis of the radiation from an electron moving in a circle, in the
long wavelength asymptotic. Synchrotron radiation is emitted from a rather
small area and we need to determine this area for observers whose detection
systems collect information over a long time period σT. The radiation pulse
length is equal to the time taken for the electron to travel along any arc AB,
reduced by the time taken for the radiation to travel directly from the arc
extreme A to B. Between point A and point B we have a deﬂection angle
φ, so that σT ≃
2R sin(φ/2)/c, and sin(φ/2) can be approximated
φ3/48 for small angles. Then the pulse duration reduces
by sin(φ/2)
≃
Rφ3/(24c). The radiation source extends over some ﬁnite length
to σT ≃
Lf = (cσT)1/3R2/3 along the particle path. We see that the reduced
Rφ
≃
distance can be expressed as ˆr0 =
/Lf. One can ﬁnd that the ratio
(Rφm)3/(6L3
f ) is equal to ˆρ, which we use now as a measure of ﬁnite magnet
length eﬀects.

Rφ/(βc)

~r0 |

φ/2

−

−

|

3.3.1 Finite distance eﬀects

Let us imagine that our electron bunch moves in a real circle and there is
no aperture limitation. We can ﬁrst consider the contribution given by the

31

f

 Analytical results
 r
 r
 r
 r
 r
 r

 =        L
0
f
 = 2     L
0
 = 3     L
0
 = 5     L
0
f
 = 10   L
0
f
 = 100 L
0

f

f

(A.U.)
E
x

1.0

0.8

0.6

0.2

0.0

0

 

 

0.4

-4

-2

2

4

(σ/c)-1 t 

Fig. 17. Time structure of a CSR pulse from a Gaussian electron bunch moving
in a circle at diﬀerent reduced distance between source and observer. Here θ = 0.
The dashed curve is calculated within the far zone approximation (19). Numerical
calculations have been performed with strict Lienard-Wiechert formula

acceleration ﬁeld alone and then focus on the contributions by the velocity
ﬁeld. When the electron bunch radiates from a circle the spectrum is obviously
independent of the ˆρ parameter. In the long wavelength asymptotic (ˆσ
≫
1) the acceleration ﬁeld is described by one dimensionless parameter only:
(cσT)−1/3R−2/3 is the dimensionless distance between
ˆr0, where ˆr0 =
|
radiation source and observer.

~r0 |

The region of applicability of Schwinger’s formulas requires the dimension-
less distance to have a large value ˆr0 ≫
1. In fact, as previously explained,
Lf, and this length
the radiation source extends over some ﬁnite length Rφ
Rφ2. The vector ~n
corresponds to a transverse size of the radiation source d
changes its orientation between point A and point B of an angle of order d/r0,
where r0 is the distance between source and observer. Our estimates show
φ, the vector ~n in Lienard-Wiechert formula is almost
that in the case d/r0 ≪
constant when the electron moves along the formation length Rφ. Thus, we
can conclude that the unit vector ~n can be considered constant throughout
the electron evolution only if r0 ≫

≃
≃

Lf.

The results of numerical calculations for several values of ˆr0 are presented in
Fig. 17. Calculations have been performed using the strict Lienard-Wiechert
formula. The plots in Fig. 17 give an idea of the region of validity of the far
zone approximation considered above. At large distance the CSR pulse proﬁle
is simply the far zone proﬁle (19). One can see that (19) works well at ˆr0 = 100.

32

cr

 Analytical Result
 σ
 σ
 σ
 σ

1 = 100 λ
2 = 10   λ
3 = 10   λ
4 = 100 λ

;   R=1 m;  γ = 20
;   R=1 m;  γ = 20
;   R=1 m;  γ = 200
;   R=1 m;  γ = 200

cr

cr

cr

(A.U.)
E
x

1.0

0.8

0.6

0.4

0.2

-4

-2

2

4

0.0

0

(σ/c)-1 t

Fig. 18. Illustration of similarity techniques. Time structure of a CSR pulse from
a Gaussian electron bunch moving in a circle for various sets of parameters. The
reduced distance is held constant, ˆr0 = 15. The solid curve is calculated within
the far zone approximation (19). Numerical calculations have been performed with
strict Lienard-Wiechert formula

(A.U.)
E
x

1.0

 σ
 σ
 σ

1 = 100 λ
2 = 10   λ
1 = 100 λ

cr

cr

cr

;   R=1 m;  γ = 20
;   R=1 m;  γ = 20
;   R=1 m;  γ = 200

-4

-2

2

4

(σ/c)-1 t

Fig. 19. Illustration of similarity techniques. Time structure of a CSR pulse from
a Gaussian electron bunch moving in a circle for various sets of parameters. The
reduced distance is held constant, ˆr0 = 0.15. Numerical calculations have been
performed with strict Lienard-Wiechert formula

Then, at ˆr0 = 3, the CSR pulse envelope is visibly modiﬁed. As the distance is
decreased, the diﬀerence between the approximate and the strict pulse proﬁle
becomes signiﬁcant. From a practical point of view this set of plots covers all
the region of interest for the distance between observer and sources.

 

0.4

0.8

0.6

0.2

0.0

0

 

33

To check that no mistakes have been made in our similarity techniques we
evaluate the normalized CSR pulse proﬁle for several sets of problem param-
eters. The reduced distance is held constant. In the present example, these
values are ˆr0 = 0.15, 15. The plots are calculated, numerically, using the strict
Lienard-Wiechert formula. Fig. 18, Fig. 19 show such plots. It is seen that
there is a good agreement with the prediction that the acceleration ﬁeld from
a circle in long wavelength asymptotic is a function of the reduced distance
only.

3.3.2 Velocity ﬁeld eﬀects

Usual theory of synchrotron radiation is based on the assumption that ac-
celeration ﬁeld dominates and all the results presented above refer to the case
when there is no inﬂuence of the velocity ﬁeld on the detector. The acceler-
ation ﬁeld dominates in the far zone only, and we want to study near zone
eﬀects too. The physics of coherent eﬀects studied by means of general expres-
sions for the Lienard-Wiechert ﬁelds is much richer than that of the simpliﬁed
radiation ﬁeld model considered above. In the long wavelength asymptotic the
velocity part of the coherent electric ﬁeld from a particle in a circle is a func-
tion of two dimensionless parameters: the reduced distance parameter ˆr0 and
the reduced electron pulse duration parameter ˆσ:

E(v)(t)/Emax = ˆE(v) = D(ˆt, ˆσ, ˆr0) ,

(37)

where the normalization of the velocity ﬁeld is performed with respect to the
maximal acceleration ﬁeld amplitude.

To show that this is correct we can perform a simple check. In Fig. 20 we
present numerical calculation results for the velocity ﬁeld for diﬀerent sets of
parameters. The reduced distance and the reduced electron pulse duration are
held constant. It is seen that all numerical results agree rather well. Therefore
the plots in Fig. 20 convince us that the dimensionless equation (37) provides
an adequate description of the numerical calculations.

Fig. 21 and Fig. 22 show the dependence of the normalized velocity ﬁeld
amplitude on the value of the reduced electron pulse duration for diﬀerent
values of the reduced distance. Using these plots we can give a quantitative
description of the region of applicability of the radiation ﬁeld model. It is seen
from the plots in Fig. 22 that in the near zone we cannot neglect the inﬂuence
of the velocity ﬁeld on the detector.

Let us now estimate the importance of the velocity ﬁeld eﬀect. Let us start
considering the total velocity ﬁeld pulse as a superposition of single particle
ﬁelds at a given position in the far zone. To calculate the integral one should

34

 (A.U.)
E
x

 γ = 20
 γ = 200

r

 = L
f
0

0.20

0.15

0.10

 

0.05

0.00

0

 

-4

-2

2

4

(σ/c)-1 t 

Fig. 20. Illustration of similarity techniques. Electric ﬁeld pulse due to velocity
term from a Gaussian electron bunch moving in a circle for various sets of param-
eters. The reduced distance and reduced bunch length are held constant, ˆr0 = 1
and ˆσT = 100 respectively. Numerical calculations have been performed with strict
Lienard-Wiechert formula

take into account the property of its kernel. In the far zone the velocity ﬁeld
from one electron is close to an antisymmetric function and the average of
the electric ﬁeld over time is close to zero. The approach used in section
3.1 can be also used to compute the coherent velocity ﬁeld. Under the long
electron bunch condition the kernel (velocity ﬁeld from one electron) can be
substituted by its asymptotic behavior. If we wish to estimate the normalized
amplitude of the coherent velocity ﬁeld we can get it simply by dividing the
asymptotic behavior of the velocity ﬁeld kernel by the asymptotic behavior of
the acceleration ﬁeld kernel, so that, in the far zone, the normalized velocity
(cσT/R)1/3 is the natural
R/(γ2θ2r0), where θ
ﬁeld is of order Ev/Eacc ≃
cγ3/R. Using
synchrotron radiation opening angle with frequency ω
normalized variables we get

σ−1
T ≪

≃

≃

ˆE(v) ≃

0 ˆσ−2/3
ˆr−1

for

ˆσ, ˆr0 ≫

1 .

As we can see from Fig. 21, numerical calculations in the far zone conﬁrm
this simple physical consideration. The value of ˆEv that we can expect is
found remembering that, in the example given in Fig. 21, ˆr0 = 100, ˆσ = 100;
therefore the normalized velocity ﬁeld would be about 0.0004, which is the
same order of magnitude as results of numerical calculations (0.0002). Also,
ˆEv varies roughly as ˆσ−2/3.

35

r

 = 100 L
f
0

 σ = 10   λ
 σ = 50   λ
 σ = 100 λ

cr
 
cr

cr

-4

-2

2

4

(σ/c)-1 t 

(A.U.)
E
x

0.0006

0.0004

0.0002

 

0.0000

0

 

-0.0002

-0.0004

-0.0006

Fig. 21. Electric ﬁeld pulse due to velocity term from a Gaussian electron bunch
moving in a circle at diﬀerent reduced bunch length. The reduced distance is held
constant, ˆr0 = 100. Here θ = 0 and the normalization is performed with respect to
the maximal acceleration ﬁeld amplitude

The normalized velocity ﬁeld amplitude decreases, as we see from our esti-
mations, linearly with distance, which means that if we are in the near zone
at ˆr0 = 1 there will be ˆEv ≃
0.04. Numerical calculation results show that,
at the value ˆr0 = 1, we have ˆEv = 0.2. We should say that our approximate
treatment of coherent velocity ﬁeld breaks down once source and observer get
as close as they are at ˆr0 ≃
1. We have, however, a simple explanation for that.
In addition to the antisymmetric part of kernel we have just described, there
is also a symmetric part. When source and observer are far apart the observer
sees only the antisymmetric part and the average of electric ﬁeld from one
electron is close to zero. At very close distances there begins to be some extra
symmetric part of the kernel. This symmetric ﬁeld, which also varies with the
separation, should be, of course, included in more precise estimates.

3.3.3 Finite magnet length eﬀects

Until now we have considered the case in which electrons moves in a circle.
Here we will generalize this situation and study the case where the electrons
move along an arc of a circle. In order to fully characterize the magnet length
required to assure the accuracy of the circular motion model, it is necessary
to specify the distortion of Schwinger spectrum associated with all interesting
magnet lengths in an experiment. Normalizing equation (24), we obtain that,
under the far ﬁeld approximation, the CSR pulse proﬁle is a function of only
one dimensionless parameter ˆρ = φ3
m/(6ω0σT), where φm is the magnet angu-

36

r

 = L
f
0

 σ = 10   λ
 σ = 50   λ
 σ = 100 λ

cr
 
cr

cr

(A.U.)
E
x

0.4

0.2

0.0

0

-4

-2

2

4

(σ/c)-1 t 

Fig. 22. Electric ﬁeld pulse due to velocity term from a Gaussian electron bunch
moving in a circle at diﬀerent reduced bunch length. The reduced distance is held
constant, ˆr0 = 1. Here θ = 0 and the normalization is performed with respect to
the maximal acceleration ﬁeld amplitude

lar extension. The region of applicability of Schwinger’s formulas require the
parameter ˆρ to have a large value ˆρ
1. Using the plots presented in Fig. 23,
one can characterize quantitatively the region of applicability of the circular
motion model.

≫

3.3.4 Diﬀraction eﬀects

Another problem concerns radiation spectrum distortions: this has to do
with aperture limitations. In real accelerators, the long wavelength synchrotron
radiation from bending magnets integrates over many diﬀerent vacuum cham-
ber pieces with widely varying aperture. The SR spectrum formed by such a
system will be perturbed by the presence of an aperture and we should seek
a mathematical mean for predicting these perturbations.

One may wonder how the existence of an aperture in an accelerator vacuum
chamber and in a beam line, which is relatively far from the source, can inﬂu-
ence the synchrotron radiation spectrum. To illustrate this point, we consider
the situation shown in Fig. 24. The object of interest is an electron moving
in a circle. Between the observer and the source there is an aperture with
a characteristic dimension d. Qualitatively, an observer looking at a single
electron is presented with a cone of radiation characterized by an aperture

37

ρ = 50.0
^
 
ρ = 5.0
^
  
ρ = 3.0
^
 
ρ = 2.0
^
 
ρ = 1.0
^
 
^ρ = 0.5
  

(A.U.)
E
x
1.0

 

0.4

0.8

0.6

0.2

0.0

0

 

-4

-2

2

4

(σ/c)-1 t 

Fig. 23. Time structure of a CSR pulse in the far zone from a Gaussian electron
bunch moving along an arc of a circle at diﬀerent reduced magnet lengths. Here
θ = 0. Calculations have been performed with anaytical formula (24). Results at
ˆρ = 50 (solid curve) agree with our analytical expression (19) for circular motion
within 1%

q

≃

d/R. Fig. 24 shows part of the trajectory of an electron
angle of order θ
travelling along an arc of a circle of radius R. At ﬁrst glance this intuitive
argument indicates that the frequency spectrum may be obtained by reducing
the situation shown in Fig. 24 to Fig. 4 and simply calculating radiation from
an electron moving along a trajectory which is an arc of a circle. However, the
situation is more complicated than that. The ﬁeld at P can be represented as
a sum of two parts - the ﬁeld due to the source plus the ﬁeld due to the wall,
i.e. due to the motions of the charges in the wall. The latter kind of radiation
ﬁeld can be described in terms of diﬀraction theory. Diﬀraction is the process
by which radiation is redirected near sharp edges. As it propagates away from
these sharp edges, it interferes with nearby non-diﬀracted radiation, produc-
ing interference patterns. A ﬁnite aperture introduces, therefore, diﬀraction
eﬀects speciﬁc to the geometry and clearly dependent on the wavelength. For
structures such as pinholes it is found that these diﬀraction patterns propagate
away from the structure at angles of order θd ≃
c/ωd, where d is the character-
istic aperture dimension. The region of applicability for the far diﬀraction zone
ωd2/c,
where eﬀects play a signiﬁcant role is given by the relation La ≫
where La is the distance between observer and aperture. When the wavelength
is about Rθ3
(d3/R)1/2, the latter condition transforms to La ≫
Rθ.
This simple physical argument indicates that the situation shown in Fig. 24
(Rd)1/2 cannot be reduced to the situation shown in Fig. 4. The
at La > Rθ

Ld ≃

Ld ≃

≃

≃

38

Fig. 24. Depiction of the eﬀects of an aperture limitation. CSR from a circle allows
us to measure the bunch proﬁle form-factor in a frequency range down to ωa only

signiﬁcance of the discussed limitation cannot be fully appreciated until we
determine typical values of the parameters that can be expected in practice.
0.03, so that at distance greater
For example, if R = 3m and λ = 100µm, θ
than 10 cm from the aperture, a 1 cm diameter hole would be suﬃciently
narrow to perturb signiﬁcantly the synchrotron radiation spectrum at that
wavelength.

≃

The computation of spectrum distortions for practical accelerator applica-
tions is a rather diﬃcult problem. One encounters vacuum chamber compo-
nents which require special attention and sophisticated techniques should be
developed to deal with this situation. The character of spectrum distortions
largely depends on the actual geometry and on the material of the vacuum
chamber, so that we may expect signiﬁcant complications in the determination
of these distortions along a vacuum enclosure of the actual device. The vacuum
chamber of an accelerator presents a too complicated geometry to allow an
analytical expression for spectrum distortions. In principle each section of the
vacuum chamber must be treated individually. By employing two or three-
dimensional numerical codes it may be possible to determine the spectrum
for a particular component. Yet, every accelerator is somewhat diﬀerent from
another and will have its own particular spectrum distortions. For this reason,
in this discussions we focused only on basic ideas about aperture limitations.

4 Radiation from an undulator

To optimally meet the needs for beam diagnostic measurements with the
features of synchrotron radiation, it is desirable to provide speciﬁc radiation
characteristics that cannot be obtained from bending magnets but require
special magnetic systems. To generate speciﬁc synchrotron radiation charac-

39

teristics, radiation is often produced by special insertion devices installed along
the particle beam path. An insertion device does not introduce a net deﬂec-
tion of the beam and we may therefore choose any arbitrary ﬁeld strength
which is technically feasible to adjust the radiation spectrum to experimental
needs. In this Section we discuss the basic theory of one such devices, a planar
undulator, and its applications to CSR diagnostics.

4.1 Basic theory of undulator radiation

The magnetic ﬁeld on the axis of a planar undulator is given by

~H(z) = ~eyHw sin(kwz) ,

where ~ey is the unit vector directed along the y axis of the Cartesian coordinate
system (x, y, z) in Fig. 25. The Lorentz force is used to derive the equation of
motion of an electron with energy γmec2 in the presence of a magnetic ﬁeld.
Integration of this equation gives

~vx(z) = ~excθw cos(kwz) ,

where θw = K/γ and K = eHw/(mec2kw) is the undulator parameter. It is
useful to present another form of this expression convenient for numerical cal-
λw(cm) where λw = 2π/kw. The transverse
culations: K = 0.093
and longitudinal velocity components are related by ( ˙z)2 = β2c2
( ˙x)2, which
gives

Hw(kGs)

×

−

×

βz = βav −

K 2
4γ2 cos 2kwz ,

where βav = β[1
undulator.

−

K 2/(4γ2)] is the mean velocity of the electron along the

It is generally assumed that the distance between the undulator and the
observation point is much larger than the undulator length. This assumption
is usually referred to as far ﬁeld approximation. Suppose this condition is met.
Denoting with ~r, as usual, the vector from the electron position at the retarded
time to the observation point and with ~r0 the vector from the coordinate origin,
placed somewhere inside the undulator, to the observation point we compute
~R with ~n = ~r0/
~r
. The unit vector from the retarded source
particle to the observer is, from Fig. 25

~r0 −

~r0 |

≃

~n

|

·

~n = cos φ sin θ~ex + sin φ sin θ~ey + cos θ~ez .

40

Fig. 25. Radiation geometry for the undulator ﬁeld

Fig. 26. Synchrotron radiation production from successive poles

The vector ~R, which describes the motion of the electron in the x
can be obtained from the previous treatment:

−

z plane,

x(t) =

sin(kwβavct) ,

z(t) = βavct

K
kwγ

K 2
8kwγ2 sin(2kwβavct) .

−

Let us ﬁnd the Fourier harmonics of the radiation ﬁeld from an electron moving
along the undulator. As in section 3.2, our starting point is equation (27) since,
once again, this is a rigorous equation under the assumption of a large distance
between observer and radiating electron. Note that the integration in (27) is
to be performed over all time but in practice, without loss of generality, it
can be restricted to the time during which the electron is passing through the
undulator. We can write:

~Er(ω) =

(
c

e)
−
~r0 |
|

NwT

Z0





~n

[(~n

×
(1

~β)
×
~β)2

−
~n

−

·

˙~β]





exp[i ω(t′

~n

·

−

~R(t′)/c)] d t′ ,(38)

41

where T = λw/(cβav), and Nw is the number of undulator periods. The integral
in the latter expression can be represented as a sum of Nw integrals over
each undulator period (see Fig. 26). Integrating by parts (38) and taking into
account the sum of the geometric progression

exp(i nφ) =

exp i(Nw + 1)φ/2

sin Nwφ/2
sin φ/2

Nw

Xn=1

we ﬁnd

~Er(ω) =

(
c

e)
−
~r0 |
|
sin Nwω(1
sin ω(1

−

i ω

T

×

Z0

~n

[~n

×

×

~n

×

(1

[~n

~n

×

·

−

~β]
~β)




βavnz))T /2

−
βavnz)T /2
−
~β] exp

i ω(t′
h

~n

·

−

exp

i ω(t′
h

~n

·

−

~R(t′)/c)

exp [i(Nw −

1)ω(1

−

t′=NwT

(cid:12)
(cid:12)
t′=0
i
(cid:12)
(cid:12)
(cid:12)
(cid:12)
βavnz)T /2]

~R(t′)/c)

d t′

.

i






For our purposes, it is most convenient to express the latter equation in the
form

1)ω(1

βav cos θ)T /2]

−

~Er(ω) =

~n

[~n

× (

×
×
exp [i ω(1

−

c

|

~r0 |
~β0]

exp [i(Nw −

2 i(
(1
(1

−
−
−
(1

e)
βav cos θ)
βav cos θ)
~β0)
βav cos θ)T /2] sin [Nwω(1

−

~n

·

×

−

1
T

×

T

Z0

[ω(1

βav cos θ)T /2]

−

sin Nwω(1
sin ω(1

βav cos θ)T /2

−
βav cos θ)T /2

−

~n

[~n

×

×

~β] exp

i ω(t′
h

~n

·

−

~R(t′)/c)

d t′

.

βav cos θ)T /2]

−

i






Here c~β0 = c~β(0) = c~β(NwT ) is the initial and ﬁnal velocity of the elec-
tron. From the shape of the interference function sin2(Nwx)/ sin2(x) we pre-
dict that important contributions to the second term will occur when x =
ω(1
βav cos θ)T /2 does not diﬀer signiﬁcantly from the resonance value x = π.
The maximum of the absolute value at resonance is, then, proportional to the
number of periods Nw and, on the assumption of Nw ≫
1, we can neglect the
ﬁrst term.

−

(39)

(40)

42

The spectral distribution of the radiation energy is given by equation (26).
Taking the square modulus of (40) and keeping the resonance term only, we
ﬁnd

(41)

=

e2ω2
4π2c "

sin Nwω(1
sin ω(1

βav cos θ)T /2
−
βav cos θ)T /2 #

−

~n

[~n

×

×

~β] exp

i ω(t′
h

~n

·

−

~R(t′)/c)

d t′

.

i

d2 W
d ω d Ω
T

Z0

× (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Let us now analyze the interference function in (41)

f (ω) =

sin Nwω(1
sin ω(1

βav cos θ)T /2
−
βav cos θ)T /2 #

"

2

and study some of its consequences. The whole curve is localized near

ω = ωres = 2ckwγ2

1 +

+ γ2θ2

.

K 2
w
2

−1

#

−

"

The latter condition is called resonance condition and tells us the radiation
frequency as a function of the undulator period λw, the undulator parameter
Kw, the electron energy γmec2, and the polar angle of observation θ. Let
us concentrate on the radiation produced in the forward direction. In this
case θ = 0 and there is no vertically polarized radiation. By means of an
angular ﬁlter, whose principle is shown in Fig. 27, we can obtain the undulator
radiation from the central cone. Note that for the radiation within the cone
of half angle

θcen = q

w/2

1 + K 2
γ√Nw

,

the relative spectral FWHM bandwidth is ∆ω/ω = 0.89/Nw. This means that
we have a very sharp central maximum with very weak subsidiary maxima
on the sides. In fact, it is possible to prove that the intensity at the next
maximum is less than 5% of the ﬁrst maximum intensity (see Fig. 28). There
is another important feature of the interference function: if the frequency is
increased by any multiple of ωres, we get other strong maxima of interference
function at ω = 2ωres, 3ωres, 4ωres, and so forth. Near each of these maxima
the pattern of Fig. 28 is repeated.

43

Fig. 27. Undulator radiation with an angular ﬁlter

Fig. 28. Radiated wavetrain from a single electron traversing an undulator, as de-
tected into the central cone, and corresponding spectral distribution function

There is no forward radiation for even harmonics of the fundamental fre-
quency ωres. Let us brieﬂy justify the latter statement. First let us calculate
the integral in (41). At θ = 0 the triple vector product is

~n

[~n

×

×

−

·

~β] = ~β

~n(~n

~β) = βx~ex =

cos(kwz)~ex .

K
γ

(42)

The exponential factor in (41) can be evaluated in a similar way

exp

i mω0(t′
h

~n

·

−

i

~R(t′)/c)

= exp [i mkwz + i Q sin 2kwz] ,

(43)

where m is integer,

Q = K 2mω0/(8kwγ2) = mK 2

w/(4 + 2K 2

w) ,

44

and ω0 = 2γ2kw/[c(1 + K 2
harmonic at θ = 0. Using (42) and (43), together with the expansion

w/2)] is the resonance frequency of the fundamental

exp[i Q sin(2kwz)] =

Jn(Q) exp(2 i nkwz) ,

n=+∞

n=−∞
X

where Jn is the Bessel function of order n, we obtain:

[~n

×

×

~β] exp

i mω0(t′
h
λw

~n

·

−

~R(t′)/c)

d t′

=

i

Jn(Q)

cos(kwz) exp[i(2n + m)kwz] d z

,

(44)

T

~n

Z0

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
K 2
(cid:12)
γ2 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

n=+∞

n=−∞
X

Z0

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

which is non-zero only when m + 2n
1 = 0. When m is odd the spectral
±
and angular density of the radiation energy emitted at zero angle by a single
electron during the undulator pass is given by the expression

d2 W (ωm)
d ω d Ω (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

e2N 2

wγ2m2A2

JJK 2
w

c(1 + K 2

w/2)2

sin2[πNw(ω
[πNw(ω

ωm)/ωm]

−
ωm)/ωm]2

,

=

θ=0

−

where the following notation has been introduced: ωm = mω0,

AJJ = [J(m−1)/2(Q)

J(m+1)/2(Q)] .

−

When deriving the latter expression, we used the following relation for the
1)nJn(Q). Now we can proceed to calculate
Bessel functions: J−n(Q) = (
the energy radiated into the central cone at the fundamental harmonic. In
the small angle approximation the solid angle is equal to d Ω = θ d θ d φ.
Integration of spectral and angular density over ω and φ gives us factors ω0/Nw
and 2π respectively. We also have integrate over θ from 0 to θcen. Altogether,
the energy radiated into the central cone by a single electron is given by

−

∆Wcen ≃

πe2A2
c(1 + K 2

JJω0K 2
w
w/2)

,

(45)

where, in this case, AJJ = [J0(Q)

J1(Q)] and Q = K 2

w/(4 + 2K 2

w).

−

45

Fig. 29. Scheme for electron bunch length diagnostics based on CSR from an undu-
lator

4.2 Bunch length diagnostic technique based on coherent radiation from an

undulator

Above, a brief treatment of undulator radiation was given in view of beam
diagnostics applications which we are going to describe in this paragraph. Our
technique relies on using an electromagnetic undulator and on recording the
energy of the coherent radiation pulse into the central cone. The conﬁguration
is sketched in Fig. 29. The electron bunch passes through the undulator and
produces a CSR pulse at some speciﬁc resonant frequency ω0(K). The signal
(energy of the CSR pulse within central cone) is recorded by a bolometer;
as we will explain in this subsection, repetitions of this measurement with
diﬀerent undulator resonant frequency allow one to reconstruct the modulus
of the bunch form factor.

The undulator has, in our scheme, a high magnetic ﬁeld and a large K

value. A 40 cm magnetic period and a relativistic factor γ
≃
a fundamental wavelength of about 100 microns when K
hand, the transverse velocity of the electron is small: βx ≪
of these conditions gives an inequality 1
generality, we will consider satisﬁed.

≪

≪

K

≫

1
103 would produce
30. On the other
≃
1. The combination
γ which, with a little loss of

The principle of operation of the proposed scheme is essentially based on
the spectral properties of the undulator radiation. A sample of undulator
radiation spectrum at zero angle is shown in Fig. 30. The distribution of the
radiated energy within diﬀerent harmonics depends on the value of K. For
K
1 we will get strong undulator maxima at ω = 3ω0, 5ω0 and so forth (as
already discussed, the radiation spectrum along the undulator axis includes
only odd harmonics). The bunch form factor is the exponential function (1)
and the square modulus of bunch form-factor falls oﬀ rapidly for wavelengths

≫

46

Fig. 30. Some typical spectra of the longitudinal electron distribution and un-
dulator spectral distribution function. The bandwidth of the undulator radiation
(∆ω/ω0 = 0.89/Nw) must always be as small as the desired spectral resolution

shorter than the eﬀective bunch length. The fast drop oﬀ is evident and for
wavelength of about three times shorter than the eﬀective bunch length the
radiation power is reduced to about 1 % of the maximum pulse energy at the
fundamental harmonic. As a result, sharp changes of the bunch form-factor
result in an attenuation of the high undulator harmonics. This point is made
clear upon examination of the spectra presented in Fig. 30: actually, the bunch
form-factor cut-oﬀ aﬀects all higher undulator harmonics which are, therefore,
suppressed.

|

Our goal is to ﬁnd the relationship between the expected value of radiation
energy per pulse and the square modulus of the bunch form-factor. In general,
¯F (ω)
2 will vary much more slowly in ω than the sharp resonance term. The
|
two functions might appear as shown in Fig. 30. In such cases, we can replace
¯F (ω)
2 at the center of the sharp resonance
|
|
curve and take it outside of the integral. What remains is just the integral
under the curve of Fig. 28, which is, as we have seen, just equal to (45). Thus,
the energy radiated into the central cone by an electron bunch is given by

2 by the constant value

¯F (ω0)

|

|

∆WCSR ≃

πe2A2
c(1 + K 2

JJω0K 2
w
w/2)

N 2

¯F (ω0)

2 ,

|

|

(46)

We emphasize the following feature of this result: the CSR radiation energy
per pulse is proportional to the square modulus of the bunch form-factor at
the resonant frequency. This fact allows one to reconstruct such quantity by
repeated measurements of ∆WCSR at diﬀerent resonant frequencies ω0.

47

4.3 Physical remarks

The typical textbook treatment of the undulator radiation problem (see [3],
[8]) consists in ﬁnding the expression for the undulator radiation spectrum
from (29). However, no attention is usually paid to the region of applicability
of this expression. In general this is not correct. In the undulator case, it is
important to realize that (29) is valid only when the resonance approximation
is met. Naturally, the resonance approximation cannot be expected to be valid
when an insertion device has only a few periods. A second important limitation
concerns the far ﬁeld approximation. It is generally assumed that the distance
between the undulator and the observer is much larger that the undulator
length. This approximation is often assumed without any real justiﬁcation
other than the simpliﬁcation that results. Such an assumption may or may
not be valid, depending on the case.

5 Constrained deconvolution

If both modulus and phase of the bunch form-factor were somehow mea-
sured, we would then known the Fourier spectrum of the bunch; an inverse
Fourier transform of the measured data ¯F (ω) would then yield the desired
proﬁle function F (t) with a resolution limited by the maximum achievable
frequency range. Unfortunately, in practice, it is impossible to extract the
phase information from the CSR measurement. A more realistic task is to
measure the modulus of bunch form-factor only: in Section 4 we proposed a
method to perform such a measurement, but independently on the technique
selected, the following problem arises, to study what information about the
bunch proﬁle can be derived from the collected experimental data: the prob-
lem is generally referred to as phase retrieval. There exist some cases in which
the absence of phase information is of no consequence. For example, any sym-
metrical density distribution can be recovered from the knowledge of the form
factor modulus only. An example is given by a bunch with a Gaussian density
distribution. In practice, the situations in which this assumption is satisﬁed
are probably rather limited.

A possible solution to the loss of phase information was suggested by Wolf
[10]. A step forward toward the solution of the problem, is based on the fol-
lowing consideration: if

¯F (ω) =

¯F (ω)

|

|

exp [i φ(ω)] ,

48

then

ln

¯F (ω)
h

i

= ln

¯F (ω)

+ i φ(ω) .

|

|

φ(ω) =

2ω
π

−

∞

Z0

ln
|
(ω′)2

¯F (ω′)

−

ω2 d ω′ .
|

It can be proved that if ln
recoverable from the modulus by the relation

¯F (ω)
h

i

is an analytical function, the phase will be

¯F (ω)
h

Unfortunately, the analyticity of ¯F (ω) is not a suﬃcient condition to assure
analyticity for ln
in that same region. The most obvious reason for
this is the possible existence of zeros of ¯F (ω) which lead to singularities in
. In some situation the function ¯F (ω) may have no zeros, in which
ln
case the so-called minimum phase solution is valid [11]. However, in general,
i
zeros will be present, and their localization will be unknown a priori.

¯F (ω)
h

i

It should be noticed that, whereas the dispersion relation method is very
elegant and conceptually simple, it is not necessarily the ”simplest” method to
use in practice. For any given problem, the various possible approaches should
be considered, for one may be distinctly easier than another, depending on
the problem at hand.

In the particular case of interest, namely an electron bunch originating by
the XFEL driver accelerator, we can combine a-priori knowledge about the
bunch density distribution with measured information about the bunch form
factor. We know that, in the case under examination, the bunching process in
zero order approximation can be treated by single particle dynamical theory.
We cannot neglect the CSR induced energy spread and other wake ﬁelds when
we calculate the transverse emittance, but we can neglect them when we cal-
culate the longitudinal current distribution, simply because their contribution
to the longitudinal dynamics is small. As a result, we will show that we can
deﬁne a general temporal structure of the electron bunch after compression
without any measurements. The purpose of the measurement is then to deter-
mine the numerical value of the parameters on which such temporal structure
depends. In this case, suﬃcient information is provided by the modulus of the
bunch form-factor, allowing us to ignore the phase information. The process
of ﬁnding the best estimate of the proﬁle function F (t) for a particular mea-
sured modulus of the bunch form-factor, including utilization of any a priori
information available about F (t) refers to a technique called ”constrained de-
convolution” which will be exempliﬁed below in detail. Although the context in
which the suggestion of this method was made ﬁrst was spectroscopy [12], the
ideas apply equally well in the present context of bunch proﬁle reconstruction.

49

]

V
e
M

[
 
 

E

410

405

400

395

390

 

 

 

403

 

404

]

V
e
M

[
 
 

E

402

0

10

20

30

0.0

0.2

0.4

0.6

0.8

1.0

t [ps]

t [ps]

Fig. 31. Typical phase space distribution of electrons after full compression with a
single bunch compressor. The plot on the right presents an enlarged fraction of the
plot on the left. The head of the bunch is at the left side

Let us consider an example which shows the deconvolution process in easy-
to-understand circumstances. For emphasis we choose, here, an experiment
aimed at measuring the strongly non-Gaussian electron bunch proﬁle at TTF,
Phase 2 in femtosecond mode operation. The femtosecond mode operation is
based on experience obtained during the operation of the TTF FEL, Phase 1
[6] and it requires one bunch compressor only. An electron bunch with a sharp
spike at the head is prepared, with rms width of about 20 microns and a peak
current of about one kA. This spike in the bunch generates FEL pulses with
duration below one hundred femtoseconds. An example of the longitudinal
phase-space distribution for a compressed beam with RF curvature eﬀect is
shown in Fig. 31, when the longitudinal bunch charge distribution involves
concentration of charges in a small fraction of the bunch length. In the fem-
tosecond mode the ﬁrst TTF magnetic chicane only will be operational, and
this will be the default mode of operation for ﬁrst lasing.

Bunch compression for relativistic situations can eﬀectively be achieved, at
the time being, only by inducing a correlation between longitudinal position
and energy oﬀset with an RF system and taking advantage of the energy de-
pendence of the path length in a magnetic bypass section (a so-called magnetic
chicane). In order to study the CSR diagnostic for a compressed bunch, let us
ﬁrst ﬁnd the longitudinal charge distribution for our bunch model when it is
fully compressed by a chicane (here we assume that the perturbation of the
bunching process by CSR is negligible). Downstream of the chicane the charge
distribution is strongly non-Gaussian with a narrow leading peak and a long
tail, as it is seen from the simulation results in Fig. 31. Our attention is fo-
cused on determining the longitudinal density distribution after compression.
As ﬁrst was shown in [13] there is an analytical function which provides quite
a good approximation for the simulation data. The current distribution along
the beam after a single compression is given by

50

 

 

3000

2000

]

A

[
 
 
I

1000

0

-0.2

0.0

0.2

0.4

t [ps]

Fig. 32. Current distribution along the bunch reconstructed from an ideal set of
experimental data for the form-factor and correct value of time constant for the
bunch tail (solid curve). Circles present data from a tracking simulation code

I(t)

I0 exp

≃

≃

I(t)

 −

t2
2τ 2
0 !
t/τ1)

A exp (

−
(t + t0)/τ1

q

for

t1 > t >

;

−∞

for

t > t1 > 0 .

(47)

Equation (47) gives a good ﬁt. To illustrate how good an approximation to
the actual current distribution is provided by (47), we show in Fig. 32 the
current as a function of time, ﬁrst the numerical simulation data, then as
computed from (47). Equation (47) involves four independent parameters in
the calculation of longitudinal density distribution: τ0, which characterizes the
local charge concentration (non-Gaussian feature) of the compressed density,
τ1, which characterizes the bunch tail and ﬁtting parameters, t0 and t1. In
this case detailed information on the longitudinal bunch distribution (actu-
ally constants: τ0, τ1 and t0, t1) can be derived from the particular measured
square modulus of the bunch form-factor by using an independently obtained
tail constant τ1 (for example by means of a streak camera). A quantity of con-
siderable physical interest is the parameter τ0 which characterizes the leading
peak. The value of τ0 can be related to the value of the initial local energy
spread ∆γ/γ in the electron beam if the compaction factor R56 of the mag-
netic chicane is known. Fig. 33 shows plots of the peak current versus time
for several values of the local energy spread. By comparing these curves, some
feeling can be obtained about the eﬀective reduction in peak current. As the
energy spread is increased from 5 keV to 15 keV, the maximum peak current

51

 

3000

1

2000

]

A

[
 
 
I

1000

2

0

3

 

-0.2

0.0

0.2

0.4

0.6

0.8

1.0

t [ps]

Fig. 33. Typical current distribution along the bunch after full compression with a
single bunch compressor. Curve 1, 2, and 3 correspond to local energy spread of 5,
10, and 15 keV at the entrance of the bunch compressor. The head of the bunch is
at the left side. The charge of the bunch is 3 nC

falls from 3.5 kA to 2 kA.

The highest time resolution obtainable by means of a streak camera is in the
sub-picosecond range. By means of coherent radiation, the resolution can be
made comparatively high because the resolution is determined by the spectral
range in the measurement. Hence, this method will be useful for monitoring
an ultra-short electron bunch at TTF FEL. In the TTF FEL Phase 2 the mea-
surement of CSR spectrum can be made by using long period electromagnetic
undulator as shown in Fig. 34. As already said, for the complete determina-
tion of the bunch proﬁle function, downstream of the ﬁrst TTF FEL bunch
compressor, a measurement of the bunch length can be made independently
by using a sub-picosecond resolution streak camera. The limiting resolution
of the streak camera will prevent the measurement of the spike width. Never-
theless, the streak camera can detect the long time tail which is outside the
CSR detector response.

The signiﬁcance of the proposed scheme cannot be fully appreciated until we
determine typical values of the energy in the radiation pulse detected within
the central cone that can be expected in practice. In the case of TTF FEL,
the bunch form factor modulus falls oﬀ rapidly for wavelengths shorter than
40 microns. At the opposite extreme, the dependence of the form factor on the
exact shape of the electron bunch is rather weak and can be ignored outside
the wavelength range 40µm < λ < 100µm. This point is made clear upon
examination of the curves presented in Fig. 35. The energy in the radiation

52

Fig. 34. Bunch length measurement scheme for TTF XFEL. The CSR source uses
the spent electron beam coming from the XFEL

 

1

2

3

 

0.1

0.01

|
 

F

|

1E-3

1E-4

0

50

100

150

200

 [ m]

Fig. 35. Form-factor of the electron bunch corresponding to the bunch proﬁles shown
in Fig. 33

pulse can be estimated simply as in (46). From Fig. 36 it is quite clear that in
the 40µm
100µm wavelength region of the CSR spectrum any local energy
spread in the electron beam smaller than 20 keV produces energies larger than
0.1µJ in the radiation pulse.

−

To conclude this section we present examples of deconvolution of computer
generated data; we hope that these will provide useful insight into the practical
limits of deconvolution. We will demonstrate that constrained deconvolution
is a useful experimental tool testable at each step in its development. By far
the easiest and most informative way to examine the deconvolution process is
to use a computer in place of a CSR spectrometer. By simulating a spectrum

53

 

10

1

2

100

]
J

[
 
 

E

R

I

1

0.1

0.01

3

 

0

50

100

150

200

 [ m]

Fig. 36. Energy in the radiation pulse detected within central cone. Curves 1, 2,
and 3 correspond to a local energy spread of 5, 10, and 15 keV at the entrance to
the bunch compressor (see Fig. 33). The bunch charge is 3 nC

rather than using an actual CSR spectrometer to record it, we have a complete
control over such factors as resolution, shape and noise. Also, we know what
the perfectly deconvolved proﬁle function would look like. In the deconvolution
of actual CSR spectral data, the presence of noise is usually the main limiting
factor: the eﬀects of noise on deconvolution are demonstrated in the following.
For the purpose of examining the deconvolution process, we begin with noisy
data, which of course, can be realized in a simulation process. When other
aspects of deconvolution, such as errors in the prior information are examined,
noiseless data are used.

Our goal is to discover the limiting sensitivity of the measurement technique
considered. Attention is therefore turned to the crucial question of how accu-
rately the bunch proﬁle parameters can be measured by this technique when
the errors in the input data cannot be neglected. Surely, the preferable way
to answer the question about errors in bunch form-factor measurement is the
computer experiments way. The eﬀects of various errors are included in a full
simulation of deconvolution procedure. One important question to answer is
about how well the modulus of bunch form factor must be known in order to
perform a successful deconvolution. To obtain the sensitivity to error eﬀects,
we use a set of input error data for a simulated bunch proﬁle spectrum (see
Fig. 37). A 40% rms error (variable over the undulator scan) is included. The
sensitivities of the ﬁnal bunch proﬁle function to the simulation input errors
are summarized in Fig. 38. Only one random seed has been presented here
as an example, but several seeds have been run with similar success. Fig. 38

54

40

60

80

100

 [ m]

Fig. 37. Electron bunch form factor corresponding to the case of 10 keV energy
spread at the entrance of the bunch compressor. The solid curve presents an ideal
40%
measurement. Symbols present ﬁve sets of measurements with relative error

±

 

 

 

 

|
 

F

|

]

A

[
 
 
I

0.1

0.01

1E-3

3000

2000

1000

0

-0.2

0.0

0.2

0.4

t [ps]

Fig. 38. Current distribution reconstructed from ﬁve sets of measurements with rel-
ative error
40% (see Fig. 37). The solid line corresponds to an ideal measurement.
The tail time constant in all cases is 9 ps

±

50%. It is seen that
shows that rms of CSR measurement should be within
the constrained deconvolution method is insensitive to the errors in the bunch
form-factor.

±

55

3000

2000

]

A

[
 
 
I

1000

0

 

 

7 ps

11 ps

-0.2

0.0

0.2

0.4

t [ps]

Fig. 39. Current distribution reconstructed from an ideal set of experimental data
for the form-factor (see Fig. 37), but with diﬀerent values of time constants, 7 and
11 ps, for the bunch tail (dotted lines). The solid line corresponds to the correct
value of the time constant, 9 ps

As shown above, the bunch proﬁle function is given by (47). An important
issue to deal with consists in determining the dependence of the deconvolved
function on the tail constant. One way to investigate this matter is to use a
set of tail constants which diﬀer from the real one in the deconvolution of a
simulated spectrum. Fig. 39 shows the results of such a test. At ﬁrst glance
all three traces of Fig. 39 are practically identical, indicating that the tail
parameter is less important than it would have probably been expected. We
can therefore conclude that the width of the tail parameter should be within
50% of the proper value. However, if the correct tail function is not readily
±
determined (by a streak camera) there is some justiﬁcation for deconvolution
with a ”good guess” because even the extreme case shown in Fig. 39 is superior
to trace the proﬁle function without prior information.

6 Concluding remarks

Electron pulse-shape measurement is achieved by a three-step process.

(i) In the ﬁrst step spectrum of coherent radiation P (ω) is measured. Coherent
radiation from dipole magnet is emitted over a wide spectrum and should
be analyzed with a spectrometer or interferometer. The proposed technique
of using CSR from an undulator may be a more promising approach. The

56

basic measurement in this case is extremely simple: the energy of the coherent
radiation pulse within the central cone is recorded by a bolometer. In order to
use the radiation from the undulator it has to be ﬁltered: for such a purpose,
a simple pinhole can be used.

|

¯F (ω)

(ii) The second step is to deduce the modulus of the bunch form-factor from
the equation P (ω) = p(ω)N 2
2; p(ω) should be applied to the result
|
of the measurement, to obtain the bunch form factor. A careful analysis of
the diagnostic instrumentation is required to ﬁnd its exact p(ω) function. The
computation of the single-particle spectrum for practical accelerator applica-
tions is a rather diﬃcult problem. The long wavelength synchrotron radiation
from bending magnets in the near zone integrates over many diﬀerent vacuum
chamber pieces and the quantity p(ω) is usually very diﬃcult to know with
good accuracy within the long wavelength range. In principle, modern com-
puters allow one to perform direct calculation of the factor p(ω). The results
of such simulations will depend on a large number of parameters. They will
provide the possibility of obtaining a numerical answer for a speciﬁc set of
input data, but hardly help to understand the physics of the problem. Success
come to those who start from the physical point of view and begin by making
the right kind of approximations, knowing what is large and what is small in
a given complicated situation. We hope that the simple model employed here
oﬀers a useful introduction to the more formidable problems which arise in
the computation of spontaneous emission spectrum distortions for real accel-
erators.

(iii) The third step consists in the reconstruction of the electron bunch proﬁle
from the measured data. The CSR spectrum measurement has an important
limitation: it does not provide any information on the phase content of the
pulse. It is clear that the retrievability of the information about the electron
bunch proﬁle function will in general not be complete, for it is the particular
measured square modulus of the form-factor that can be obtained, not the
complex form-factor itself. No spectral phase information is available, and the
complete proﬁle function cannot be obtained in general. Nevertheless, the less
complete information can be exceedingly useful in many cases. For example,
downstream of the bunch compressor the bunch charge distribution is strongly
non-Gaussian with a narrow leading peak and a long tail. In this case detailed
information about the longitudinal bunch distribution can be derived from the
2 by measuring the bunch tail constant with
measured square modulus
a streak camera and by using all a-priori available information about proﬁle
function. In this paper we demonstrate that constrained deconvolution is a
useful experimental tool testable at each step in its development. Although
the present work is concerned primarily with fully compressed electron bunch
downstream of the ﬁrst bunch compressor, its applicability is not restricted
to that area only: for example, multistage bunch compression is a suitable
candidate for treatment by the methods described here.

¯F (ω)

|

|

57

We thank J. Botman, W. Brefeld, R. Brinkmann, B. Faatz, A. Fateev, J.
Feldhaus, M. Koerfer, O. Kozlov, J. Krzywinski, J. Luiten, T. Moeller, D.
Noelle, J. Pﬂueger, P. Piot, E. Ploenjes, J. Rossbach, S. Schreiber, M. v.d.
Wiel for many useful discussions. We thank J.R. Schneider and D. Trines for
interest in this work.

Acknowledgments

References

[1] TESLA Technical Design Report, DESY 2001-011, edited by F. Richard et al.,

and http://tesla.desy.de/

[2] The LCLS Design Study Group, LCLS Design Study Report, SLAC reports

SLAC- R521, Stanford (1998) and http:
www-ssrl.slacstanford.edu/lcls/CDR

[3] H. Wiedemann, ”Particle Accelerator Physics” (Springer, Berlin, 1995)

[4] J. Schwinger, Phys. Rev. 75, 1912 (1949)

[5] V. G Bagrov, N. I. Fedosov, and I. M. Ternov, Phys. Rev. D 28, 2464 (1982)

[6] V. Ayvazyan et al., Phys. Rev. Lett. 88(2002)104802

[7] J. D. Jackson, ”Classical electrodynamics” (John Wiley and Sons, New York,

1975)

[8] P. J. Duke, ” Synchrotron radiation” (Oxford University Press, Oxford, 2000)

[9] V. A. Bordovitsyn (Editor), ”Synchrotron Radiation Theory And Its

Development” (World Scientiﬁc, Singapure-London, 1999)

[10] E. Wolf, Proc. Phys. Soc., 80, 1269 (1962)

[11] S. R. Robinson, J. Opt. Soc. Am., 68, 87 (1978)

[12] P. A. Jansson (Editor), ”Deconvolution with application in spectroscopy”

Academic Press, Inc. (1984)

[13] R. Li, Nucl. Instr. and Meth. A 475(2001)498

58

