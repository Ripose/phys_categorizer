Chaotic orbits in thermal-equilibrium beams: existence and

dynamical implications

Courtlandt L. Bohn1,2 and Ioannis V. Sideris1

1Northern Illinois University,

DeKalb, IL 60115

2Fermilab, Batavia, IL 60115

(Dated: February 2, 2008)

Abstract

Phase mixing of chaotic orbits exponentially distributes these orbits through their accessible

phase space. This phenomenon, commonly called “chaotic mixing”, stands in marked contrast

to phase mixing of regular orbits which proceeds as a power law in time. It is operationally ir-

reversible; hence, its associated e-folding time scale sets a condition on any process envisioned

for emittance compensation. A key question is whether beams can support chaotic orbits, and if

so, under what conditions? We numerically investigate the parameter space of three-dimensional

thermal-equilibrium beams with space charge, conﬁned by linear external focusing forces, to de-

termine whether the associated potentials support chaotic orbits. We ﬁnd that a large subset of

the parameter space does support chaos and, in turn, chaotic mixing. Details and implications are

enumerated.

PACS numbers: 41.75.-i, 05.70.Ln, 29.27.Bd, 45.10.Na, 98.10.+z

3
0
0
2
 
y
a
M
 
1
3
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
6
0
0
6
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

I.

INTRODUCTION

Rapid, inherently irreversible dynamics is a practical concern in producing high-brightness

charged-particle beams. Time scales of irreversible processes place constraints on methods

for compensating against degradation of beam quality caused by, for example, space charge.

This is a very important practical matter because compensation must be fast compared to

these processes, and this aﬀects the choice and conﬁguration of the associated hardware.

A beam bunch with space charge comprises an N -body system with typically 3N degrees

of freedom. Upon coarse-graining, i.e., “smoothing” the system to remove granularity, the

collective space-charge force remains. One might conjecture that this force, when nonlinear,

may support chaotic orbits. One example is the University of Maryland ﬁve-beamlet experi-

ment that shows presumably irreversible dissipation of the beamlets after a few space-charge-

depressed betatron periods [1]. Simulations of the experiment reveal a substantial fraction

of globally chaotic orbits [2], and phase mixing of these orbits thereby presents itself as a

contributing evolutionary mechanism. This example pertains to a strongly time-dependent

nonequilibrium system, yet one might conjecture that nonlinear space-charge forces in a

static system could support chaotic orbits as well. We shall explore this conjecture.

An initially localized clump of chaotic orbits will, via phase mixing, grow exponentially

and eventually reach an invariant distribution. This is “chaotic mixing” [3, 4]. Strictly

speaking, the process is reversible in that it is collisionless and its dynamics is included in,

e.g., Vlasov’s equation. Nonetheless, when the invariant distribution spans a global region

of the system’s phase space, chaotic mixing is a legitimate relaxation mechanism in that it

drastically smears correlations. Moreover, from a practical perspective, the process is strictly

irreversible because inﬁnitesimal ﬁne-tuning is needed to reassemble the initial conditions. It

is also distinctly diﬀerent from phase mixing of regular orbits, i.e., linear Landau damping [5],

a process that winds an initially localized clump into a ﬁlament over a comparatively narrow

region of phase space. Whereas chaotic mixing proceeds exponentially over a well-deﬁned

time scale and can cause global, macroscopic changes in the system, phase mixing of regular

orbits carries a power-law time dependence, proceeds on a time scale depending on the

distribution of orbital frequencies across the clump, and acts only over a portion of the

phase space. Accordingly, ascertaining conditions for, and time scales of, chaotic mixing in

beams is an undertaking of practical importance.

2

In this paper we consider a family of thermal-equilibrium (TE) conﬁgurations of

beam bunches with space charge,

i.e., nonneutral plasmas, conﬁned by linear external

forces [6, 7, 8]. For simplicity, we treat the dynamics in a reference frame that comoves

with the bunch and has its origin aﬃxed to the bunch centroid. Particle motion in this

reference frame is taken to be nonrelativistic; transforming from the bunch frame to the

laboratory frame is straightforward [9]. In the laboratory frame the space-charge force de-

creases inversely with the square of the beam energy. For the transverse component, this

arises from the partial cancellation between the self-magnetic and self-electrostatic forces;

while for the longitudinal component, it is due to Lorentz contraction [10]. Nonetheless,

there are many situations involving high-brightness beams wherein space charge is impor-

tant. Contemporary examples include low-to-medium-energy hadron accelerators such as

those that drive spallation-neutron sources or serve as boosters for high-energy machines,

heavy-ion accelerators, and low-energy electron accelerators such as photoinjectors [11].

Thermal-equilibrium beams are of practical interest in connection with, e.g., high-current

radiofrequency linear accelerators. While conventional designs of such machines lead to

bunches that are out of equilibrium, a design strategy that keeps the beam at or near

thermal equilibrium has been formulated [12]. The principal motivation for this alternative

strategy is to circumvent equipartitioning processes that cause emittance growth and halo

formation.

Because a TE conﬁguration is a maximum-entropy conﬁguration, is static, and is mani-

festly stable [13], one might expect its intrinsic dynamics to be entirely benign. The expecta-

tion is questionable. The density distribution of such a conﬁguration is uniform in its interior

and falls to zero over a distance commensurate to the Debye length. Thus, large-amplitude

orbits will explore this “Debye tail,” during which time they experience a nonlinear force.

The question we seek to answer is whether the nonlinear force in the Debye tail can cause a

signiﬁcant number of orbits to be chaotic. The answer is unequivocally “no” for spherically

symmetric or inﬁnitely long cylindrically symmetric conﬁgurations because their potentials

are integrable and thereby support only regular orbits. However, breaking the symmetry

can generate chaotic orbits, as will become apparent in the analysis to follow.

Our study involves a comprehensive suite of numerical experiments concerning orbital

dynamics in smooth (coarse-grained) TE conﬁgurations. We establish a quantitative mea-

sure of chaos in orbits and use this measure to distinguish between regular and chaotic

3

orbits. We then evolve initially localized clumps of particles in the smooth potentials. The

experiments are fast if the potentials are analytic, but they are much slower if the potentials

must ﬁrst be tabulated numerically over a grid. As part of the preliminaries, Sec. II presents

a semianalytic theory for estimating the time scale for chaotic mixing. In general the TE

conﬁgurations, speciﬁed in Sec. III, must be found numerically. Section IV presents a means

for rapidly constructing approximate, semianalytic models of their potentials. With these

models we are able to survey the parameter space and obtain a zeroth-order assessment of

the prevalence and degree of chaos; this is done in Sec. V. Section VI concerns examples for

which the potential is accurately determined via a numerical solution of Poisson’s equation

on a grid. For these examples the experiments of Sec. V are repeated, and the results are

compared to those derived from the semianalytic approximation. Section VII summarizes

the ﬁndings, discusses their implications while providing a comparison with the theory of

Sec. II, and presents a path for follow-on work.

II. ESTIMATED TIME SCALE FOR CHAOTIC MIXING

Before embarking on numerical studies, it is wise to ascertain whether chaotic mixing can

indeed proceed rapidly. One can construct an analytic tool to estimate the chaotic-mixing

rate, although its application involves the tacit assumption, or initial knowledge, that chaotic

orbits are present. In this section we sketch the methodology leading to analytic predictions.

Additional details are available elsewhere [14, 15].

The past few years have seen development of a geometric method proposed by M. Pettini

to quantify chaotic instability in Hamiltonian systems with many degrees of freedom. The

central idea is to describe the dynamics in terms of average curvature properties of the

manifold in which the particle orbits are geodesics. The method hinges on the following

assumptions and approximations; they are discussed thoroughly in Ref. [16]: (1) a generic

geodesic is chaotic; (2) the manifold’s eﬀective curvature is locally deformed but otherwise

constant; (3) the eﬀective curvature reﬂects a gaussian stochastic process; and (4) long-

time-averaged properties of the curvature are calculable as phase-space averages over an

invariant measure, speciﬁcally, the microcanonical ensemble. The gaussian process is the

zeroth-order term in a cumulant expansion of the actual stochastic process; assumption

(3) is that the zeroth-order term suﬃces. The end result relates chaotic instability to the

4

geometric properties of the manifold deﬁned by the long-time-averaged orbits. In short, the

theory is based on (often questionable) assumptions that chaos exists and is characterized

by ergodicity and a microcanonical ensemble, and it treats chaotic orbits as arising from

a parametric instability that can be modeled by a stochastic-oscillator equation.

It has

recently been adapted for application to low-dimensional, autonomous (time-independent)

Hamiltonian systems and, in tests against a wide variety of such systems, it was found

commonly to yield estimates of mixing rates that are good to within a factor

2 [15].

∼

Action principles in classical mechanics are tantamount to extremals of “arc lengths”;

thus, one can infer a metric tensor from an action principle [17]. The metric tensor manifests

all of the properties of the manifold over which the system evolves, with these properties

being calculable following standard methods of diﬀerential geometry. Of special interest is

the divergence of two initially nearby 3N-dimensional geodesics q and q + δq as governed

by the equation of geodesic deviation:

D2δqα
ds2 + Rα

βγδ

dqβ
ds

δqγ dqδ
ds

= 0,

in which D/ds denotes covariant diﬀerentiation with respect to the “proper time” s, Rα

βγδ is

the Riemann tensor derivable from the metric tensor, and summation over repeated indices

is implied with each index spanning the 3N degrees of freedom. Equation (1) is the basis

for determining the mixing rate χ as a measure of the system’s largest Lyapunov exponent,

a quantity that reﬂects the long-time behavior of the separation vector:

(1)

(2)

χ = lim
t→∞

1
t

δq(t)
|
δq(0)
|

ln |
|

.

Any number of action principles, and therefore any number of metric tensors, can

be selected to proceed further. Eisenhart’s metric [18], which is consistent with Hamil-

ton’s least-action principle,

is probably the most convenient choice.

It oﬀers easy cal-

culation of the Riemann tensor, and it avoids spurious results traceable to the singu-

lar boundary of the perhaps better-known Jacobi metric that is derivable from Mauper-

tius’ least-action principle [19]. Eisenhart’s metric operates over an enlarged conﬁgura-

tion space-time manifold in which the geodesics are parameterized by the real time t, i.e.,

ds2 = dt2 =

2V (q)(dq0)2 + δijdqidqj + 2dq0dq3N +1, in which V (q) is the potential energy

−

per unit mass (hereafter called the “potential”); δij (with the indices i, j running from 1 to

3N) is the unit tensor corresponding (without loss of generality) to a cartesian spatial coor-
0 dt′L(q, ˙q); and L is the Lagrangian. The resulting
R

dinate system, q0 = t; q3N +1 = t/2

−

t

5

geodesic equations for the spatial coordinates qi are Newton’s equations of motion, so the

particle trajectories correspond to a canonical projection of the Eisenhart geodesics onto the

conﬁguration space-time manifold. A convenient byproduct of the Eisenhart metric is that

the only nonzero components of the Riemann tensor are R0i0j = ∂i∂jV , in which ∂i = ∂/∂qi.

Using the aforementioned assumptions and approximations, Pettini and others [16, 20]

derive an expression for χ in terms of the curvature and its standard deviation averaged over

the microcanonical ensemble. The idea is that, as t

, chaotic orbits of total energy E

→ ∞

mix through the conﬁguration space toward an invariant measure, taken per assumption (4)

to be the microcanonical ensemble δ(H

E), over which time averages become equivalent

−

to phase-space averages. Speciﬁcally, for an arbitrary function A(q), the averaging process

is

Per Eisenhart’s metric, the average curvature κ and the ratio ρ

R

R

σ/κ, with σ denoting the

A

h

i ≡

lim
t→∞h

A
it =

dq

R

dq
R

d ˙q A(q)δ[H(q, ˙q)
d ˙q δ[H(q, ˙q)

−
E]

E]

.

−

≡

standard deviation of the curvature, are

κ = h∇
3N

, ρ =

2V

−

i
1

1
h
κ q

(

∇

2V )2
√3N

− h∇
1

−

2V

2

i

i

,

in which

2 denotes the Laplacian ∂i∂i, and ρ corresponds physically to the ratio of the

∇

average curvature radius to the length scale of ﬂuctuations [21]. By taking the curvature

to vary randomly along a chaotic orbit, one can reduce Eq. (1) to a stochastic-oscillator

equation that can be solved analytically. The solution yields an estimate of the largest

(3)

(4)

Lyapunov exponent χ:

χ(ρ) =

1
√3

L2(ρ)

1

−
L(ρ)

√κ;

L(ρ) =

T (ρ) +

1 + T 2(ρ)

, T (ρ) =

(cid:20)

q

1/3

(cid:21)

3π√3
8

ρ2
2√1 + ρ + πρ

.

(5)

The geometric quantities derive from the 6N-dimensional microcanonical distribution.

Anticipating that granularity takes a long time to aﬀect mixing, and wishing to identify con-

ditions for rapid mixing, we now consider the inﬂuence of the 3-dimensional coarse-grained

space-charge potential Vs on a generic chaotic orbit. The largest Lyapunov exponent for the

coarse-grained system equates to the chaotic-mixing rate. We presume the assumptions and

approximations stated at the outset carry over to the coarse-grained system; the main jus-

tiﬁcation is that the aforementioned previous work concerning low-dimensional autonomous

6

Hamiltonians has shown the mixing rate in such systems usually depends only weakly on

the dynamical details [15]. We take the external focusing potential Vf to be quadratic in the
x)2/2, wherein ω = (ωx, ωy, ωz)

coordinates x comoving with the bunch, i.e., Vf (x) = (ω

·

corresponds to the focusing strength; the total potential is V = Vf + Vs. Per Eq. (4) and

Poisson’s equation the quantities κ and σ are determined from

p(x), in which
p(x) = n(x)q2/(ǫom), n(x) is the (smoothed) particle density, q and m
f = ω2
ω2
are the single-particle charge and rest mass, respectively, and ǫo is the permittivity of free

y + ω2

x + ω2

z , ω2

f −

2V = ω2

ω2

∇

space. We then have

κ =

1
2

h

ω2

f − h

ω2

p(x)

i

i

, ρ =

1
h
κ q

n2(x)

n(x)

2

− h
n(0)√2

i

i

.

(6)

Inserting these results into Eq. (5) gives the associated time scale for chaotic mixing,
tm ≡
the case when substructure is present, ρ will be appreciable, and in turn Eq. (5) makes

1/χ. When the standard deviation of the density distribution is large, as can be

clear that tm will be a few space-charge-depressed periods 2π/√κ. Accordingly, the space-

charge-depressed period, a quantity commensurate to the orbital period of a typical particle,

constitutes a “dynamical time” tD for charged-particle beams.

To underscore the potential impact of collisionless relaxation via chaotic mixing, it is

of interest to compare tm to the collisional relaxation time tR. Perhaps the simplest way

to develop an order-of-magnitude estimate of tR in a charged-particle bunch (a nonneutral

plasma) is to calculate the time required for a typical particle velocity to change by of order

0.1N/lnN, wherein the Coulomb logarithm is conservatively taken to be lnN. If

itself presuming collisions comprise a sum of incoherent binary interactions [22]. The result
is tR/tD ∼
we substitute plausible parameter values for real high-brightness beams, we ﬁnd tR ≫
for example, N = 6.25

tR when chaotic mixing

tD;

109 (1 nC) gives tR ∼

107 tD; hence, tm ≪

×

is prominent. The remaining question is whether there is a signiﬁcant population of globally

chaotic orbits to mix, a question to which we now turn our attention.

III. THE EQUATIONS OF THERMAL EQUILIBRIUM

Consider a system, i.e., a bunch, of N identical charged particles, e.g., electrons or pro-

tons. For simplicity, invoke a Cartesian coordinate system whose origin lies at the bunch

centroid. Assume all particle velocities in this coordinate system are nonrelativistic. The

7

particles mutually interact via the Coulomb force and are conﬁned by a static, externally

applied, linear focusing force. The focusing force may have diﬀerent strengths along the

three Cartesian axes. Assume, apart from this focusing force, that the system is isolated

and is in thermal equilibrium. Accordingly, the total energy E of each particle is conserved:

E =

mv2 +

m(ω

x)2 + qφ(x) ;

1
2

1
2

·

(7)

wherein ω = (ωx, ωy, ωz) corresponds to the focusing strength; x = (x, y, z) denotes co-

ordinates; m, v, and q are the particle’s rest mass, speed, and charge, respectively; and

φ(x) = (m/q)Vs is the space-charge potential arising from the collective Coulomb force.

To proceed, one would in principle work with the 6N-dimensional microcanonical dis-

tribution of particles. This distribution includes interactions at all scales, ranging from

particle-on-particle to a single particle interacting with the bulk, smooth potential from all

other particles. Discreteness eﬀects from 1/r2 particle collisions generate chaos [23]; they

cause nearby particle trajectories to separate exponentially. The rate of exponential sep-

aration, i.e., the Lyapunov exponent, is an increasing function of N [24].

In this sense,

larger N gives rise to more chaos. However, the scale at which the separation saturates is

a decreasing function of N. Accordingly, in large-N, high-charge-density systems such as

beams with space charge, discreteness establishes microchaos [25, 26, 27, 28]. At the other

extreme, that of a single particle interacting with the bulk, smooth potential, exponential

separation of nearby chaotic particles (if any are present) saturates at a global scale, cor-

responding to a state of macrochaos. Thus, initially nearby chaotic orbits evolve in three

stages [29]: (1) very rapid exponential divergence that saturates at a scale large compared to

the initial interparticle spacing but small compared to the system size; followed by (2) rapid

exponential divergence that persists until the particles are globally dispersed; followed by

(3) less rapid power-law divergence on a time scale

(ln N)tD, in which tD is a dynamical

∝

time commensurate to the orbital period. If, in the smooth potential, the initially nearby

particles execute regular motion rather than chaotic, then stage (2) is absent, and stage (3)

proceeds on the much longer time scale

(N 1/2)tD [27].

∝

Our interest here is in stage (2). Speciﬁcally, we are concerned about the existence of, and

time scale for, macroscopic chaos, i.e., chaotic mixing into the global region of phase space

that is energetically accessible to the individual particles. Accordingly, we specialize to the

smooth 6-dimensional distribution function of a single particle, recognizing that discreteness

8

eﬀects vanish on macroscopic scales as the number density grows. For the TE beam, this

is just the Maxwell-Boltzmann distribution, f (x, v)

exp(

H/kT ), in which H = E is

∝

−

the Hamiltonian, k is Boltzmann’s constant, and T is the beam temperature. The number

density follows upon integrating over velocity space, and the space-charge potential follows

upon solving Poisson’s equation:

(8)

(9)

(10)

(11)

(12)

n(x) = n(0) exp

−

1
2 m(ω

·

x)2
kT

−

"

qφ(x)

;

#

2φ(x) =

∇

q
ǫo

−

n(x), φ(x = 0) =

φ(x = 0) = 0,

∇

wherein ǫo is the permittivity of free space.

A much more convenient formulation arises by using dimensionless variables. We intro-

duce the Debye length λD0 and angular plasma frequency ωp0, both deﬁned in terms of the

centroid number density n(0):

λ2
D0 ≡

ǫokT
n(0)q2 ; ω2

p0 ≡

n(0)q2
ǫom

.

We then measure all lengths in the unit of λD0, i.e., x

x/λD0, and all times in the

↔

unit of 1/ωp0, i.e., t

ωp0t. In addition, we introduce the dimensionless potential Φ(x)

↔

qφ(x)/(kT ), and we normalize n(x) to the centroid density n(0), i.e., n(x)

≡
n(x)/n(0).

↔

The number density and Poisson’s equation then reduce to their dimensionless forms:

n(x) = exp

Ω2R2(x)

Φ(x)

;

1
2

(cid:20)−

(cid:21)

−

∇

2Φ(x) =

n(x), Φ(x = 0) =

Φ(x = 0) = 0;

y, and R2(x) = (x/a)2 + y2 + (z/c)2, with the “scale lengths”
ω2

wherein Ω2

≡

∇
(ωy/ωp0)2

↔

≡

−

≡

a and c deﬁned as a

ωy/ωx and c

ωy/ωz.

Equations (11) and (12) self-consistently provide the structure of the entire family of

smoothed TE conﬁgurations. The parameter Ω governs the strength of external focusing vis-

`a-vis space charge. The scale lengths a and c set the overall geometry: a = c = 1 corresponds

to spherical symmetry, a = c

= 1 corresponds to cylindrical symmetry, and a

= 1, c

= 1,

a

= c establishes a triaxial conﬁguration. The extreme case of maximum space charge

corresponds to a density that is strictly uniform over the volume of the conﬁguration, in

which case Φ =

Ω2R2/2 inside the beam. Upon substituting into Poisson’s equation, we see

−

that the associated conﬁguration carries the parameter Ω = Ωu = 1/

(1/a2) + 1 + (1/c2).

9

q

6
6
6
6
This is the minimum permissible focusing strength; the bunch is unconﬁned if Ω < Ωu, and

the corresponding constraint on the parameter space is

1
a2 +

1
c2 ≥

1

Ω2

−
Ω2

.

(13)

(14)

Hence, the parameter set [a, c; Ω] fully speciﬁes a TE conﬁguration.

Upon solving for the space-charge potential Φ(x), one can calculate orbits of test particles

in the total potential. Their trajectories follow from the (dimensionless) equation of motion:

d2x
dt2 =

1
2

−∇ (cid:20)

Ω2R2(x) + Φ(x)

.

(cid:21)

One can, of course, introduce arbitrary initial conditions for the orbits. In our experiments,

the initial condition on the velocity is v(0) = 0, and the total energy E of a particle thereby

corresponds to the potential energy associated with the initial position x(0).

A key challenge in exploring orbital dynamics throughout the parameter space is to

integrate large numbers of orbits rapidly for suﬃciently long evolutionary times. Ideally,

one would have analytic solutions for the density-potential pairs, from which the force on

a particle at each time step can be quickly evaluated. Unfortunately, the equations of

equilibrium generally do not submit to analytic techniques. Thus, in principle, one must

solve these equations numerically, e.g., over a grid. However, as delineated in the following

section, it is possible to formulate approximate, semianalytic solutions, and these solutions

enable a search of a broad range of the parameter space for regions that support chaotic

orbits. We now turn to that exploration. Subsequently, for select cases, we compare these

results against those derived from fully self-consistent numerical solutions.

IV. APPROXIMATE SOLUTIONS TO THE EQUATIONS OF EQUILIBRIUM

A method to solve the equations of equilibrium is through a sequence of successive ap-

proximations [30]. A way to begin such a sequence is as follows: (1) As a ﬁrst approximation,

represent the system as a conﬁguration stratiﬁed on similar and similarly situated concen-

tric ellipsoids. A “homeoid” is a shell that is bounded by two similar and similarly situated

concentric ellipsoids, and in which the surfaces of constant density are ellipsoids that are

similar to, concentric with, and similarly situated with respect to the bounding ellipsoid.

Thus, the charge density is “homeoidally striated” in the ﬁrst approximation (as is later il-

lustrated in Fig. 13). Determine the stratiﬁcation by solving a spherically symmetric model

10

of the equations of equilibrium. (2) In the second approximation, derive the space-charge

ﬁeld corresponding to the homeoidally striated charge density, and then solve exactly the

equations of equilibrium in this ﬁeld. (3 and up) Repeat the process until the density and

potential converge.

In practice, one can carry out steps (1) and (2) of this recipe using

semianalytic methods; to go further requires numerical techniques.

A. Determination of the structure in the ﬁrst approximation

To invoke a spherically symmetric model of Eq. (12), we take the potential to be stratiﬁed

over ellipsoids on which R(x) takes a constant value. Then the spherically symmetric model

corresponds to solving

1
R2

d
dR  

R2 dΦ0(R)
dR !

=

1
2

Ω2R2

Φ0(R)

;

−

(cid:21)

Φ0(0) =

= 0.

(15)

exp

(cid:20)−

−
dΦ0
dR (cid:12)
R=0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

This model deﬁnes the “zeroth approximation” Φ0(R) to the potential. In general Eq. (15)

must be solved numerically; however, the solution is rapidly and easily accomplished with

the aid of, e.g., a Runge-Kutta algorithm.

ﬁrst approximation to the number density:

Once Φ0(R) is determined, the corresponding homeoidally striated density becomes the

n1(R) = exp

Ω2R2

Φ0(R)

.

−

(cid:21)

1
2

(cid:20)−

By inspection [31], one can write down the space-charge potential corresponding to the

number density n1(R), and this becomes the ﬁrst approximation to the potential:

Φ1(x) =

dr r n1(r)

ac
2 Z

0
∞

−
ac
2 Z

0

∞

du
∆(u) Z
du
∆(u) "

r

R(x;u)

0
dΦ0(r)
dr

=

+ Φ0(r)

,

#r=R(x;u)

(16)

(17)

wherein the second equality follows from an integration by parts, and the quantities ∆(u)

and R(x; u) are

∆(u) =

(a2 + u)(1 + u)(c2 + u) ,

R(x; u) =

q

s

x2
a2 + u

+

y2
1 + u

+

z2
c2 + u

.

11

Hence, in the ﬁrst approximation the number density is homeoidally striated, but the space-

charge potential is not.

B. Determination of the structure in the second and higher approximations

The number density in the second approximation, n2(x), follows upon substituting Φ1(x)

calculated from Eq. (17) into Eq. (11). For the special case of spherical symmetry, all orders

of approximation agree with one another, but this is of course not true for a general triaxial

geometry. To go further requires numerical methods, e.g., solving Poisson’s equation for the

potential Φ2 corresponding to the density n2, substituting the result into Eq. (11) to obtain

n3, and successively repeating the process until convergence is achieved. As discussed in

Sec. VI below, we use a diﬀerent method, a multigrid algorithm, for solving Eqs. (11) and

(12) numerically.

V. SURVEY OF THE PARAMETER SPACE

Gathering suﬃcient data to support precise, statistically based conclusions concerning

orbital behavior in a given potential requires integrating thousands of orbits in that potential.

And before these orbits can be tracked, the potential needs to be ascertained to suﬃcient

accuracy. In principle, and for each choice of parameters, one must construct the “exact”

potential Φ(x) by numerically solving the corresponding Poisson equation. This can be a

computationally tedious process, and the solution is by necessity deﬁned over a grid. Next,

orbit integration through the grid requires accurate interpolation to evaluate the potential

and corresponding particle acceleration between grid points. For suﬃcient resolution, the

time steps need to be appropriately small; accordingly, many interpolations are required,

and integrating many orbits is computationally time-consuming. This process is feasible

for studying a few choices of parameter sets, and it underlies the results of Sec. VI below.

However, to survey the entire parameter space, i.e., to investigate many choices of parameter

sets, the process becomes prohibitive. For this purpose one must resort to using approximate

potentials.

Sec. IV above details a sequence of approximations, the ﬁrst elements of which are semi-

analytic. The zeroth-order potential Φ0, derived from Eq. (15), is easy to evaluate, and it

12

enables fast, high-precision orbital integration. However, Φ0 itself may be a crude approxi-

mation to the exact potential; the approximation gets progressively worse as the parameter

sets deviate further from spherical symmetry. One might expect the potential Φ1 of the

ﬁrst approximation to provide a better model. However, its underlying integral, given in

Eq. (17), adds additional complexity and time to the orbit integrations. We tried evaluating

this integral at each time (thus position) step along the orbit, but doing so made the orbit

computations prohibitively long. The alternative is to evaluate the integral over a grid and

then do orbit integrations through the grid. As previously mentioned, integrations through

a grid are too computationally expensive to enable a parameter survey. Moreover, if one

is able to solve Poisson’s equation for the exact potential Φ(x), then there is neither com-

putational beneﬁt nor motivation for using Φ1. Our strategy is to explore a few choices of

parameter sets in the exact potential to strengthen conclusions from our survey, and this

necessitated developing the Poisson solver described in Sec. VI. For these reasons, we use the

potential of the zeroth approximation, Φ0, to survey the parameter space. For a few speciﬁc

parameter sets for which the results of the zeroth approximation look especially interesting,

we then check the results using the numerically evaluated exact potential, Φ(x).

A. Solution for the zeroth-order potential

Per Eq. (13), the minimum possible focusing strength corresponding to a spherically

symmetric system is Ω = Ωu = 1/√3. Accordingly, we choose focusing strengths in keeping

with the following labeling convention:

Ωi =

1
√3

1 + 101−i
h

−

101−Imax

,

i

(18)

with i = 1, 2, ..., Imax and Imax = 10. Choices of parameters [a, c; Ωi] then must be selected

based on the constraint of Eq. (13) which bounds the parameter space of exact potentials.

Note, however, that we can examine any desired geometry: oblate axisymmetric (for which

a = 1, c < 1), prolate axisymmetric (for which a = c < 1), and the full range of oblate-

through-prolate triaxial systems. Hereafter we refer to “Case 1, Case 2,...” according to

“i = 1, 2, ...” in Eq. (18), respectively.

Plots of Φ0(R) versus R derived from Eq. (15) appear in Fig. 1. Also shown are the

corresponding proﬁles of the number densities n1(R) constructed in the ﬁrst approximation.

13

For larger “case numbers” i, the density contains larger quasi-uniform central regions. In the

outer regions the density decreases, over a length commensurate to the Debye length, to a

low-density tail. The space-charge force in the quasi-uniform “core” is correspondingly quasi-

linear; however, it is manifestly nonlinear in the “Debye fall-oﬀ region” (henceforth called

the “Debye tail”). Fig. 1 shows that the choices of Ωi per Eq. (18) span a wide range of space

charge. At the one extreme, zero space charge, the density proﬁle is gaussian. Then, the

range of i spans from small space charge (i = 1) for which the density proﬁle is approximately

gaussian, through the fully space-charge-dominated, uniform beam (i = Imax = 10) for which

Ω = 1/√3. Note that Case 5 (Ω

1.0001/√3) represents “intermediate space charge”; the

≃
density falls oﬀ over a length scale comparable to that of the core.

B. Methodology for orbital analysis

1. Samples of orbits, power spectra, and complexity

After choosing a parameter set [a, c; Ωi] and solving for Φ0[R(x)], we began by generating

2000 initial coordinates uniformly spanning the volume occupied by the core and Debye tail

of the density n1[R(x)]. The initial velocities were all chosen to be zero. Next, starting with

these initial conditions, for every orbit we integrated the equations of motion, cf. Eq. (14),
using Φ = Φ0 for at least 100 orbital periods and, in most cases, for >
∼

200 orbital periods.

The integrations were done using a ﬁfth-order Runge-Kutta algorithm [32] with variable time

step. As the integration proceeded, we computed the largest short-time Lyapunov exponent

of each orbit using a well-established algorithm in the ﬁeld of chaotic dynamics [33]. The

idea is to evolve two initial conditions that start from a very close distance for about one

dynamical time, then renormalize to bring the two particles close together again, and repeat

the process until the average exponent associated with the orbital separation converges to

an almost stable value. Typically convergence was achieved within

100 orbital periods.

After computing the orbits, we extracted the power spectrum for each orbit using a fast-

Fourier-transform algorithm [32]. In doing so, we recorded each orbit at a rate

40 times

per orbital period. From the spectrum we computed the total power. Then we sorted the

spectral frequencies in descending order, and starting from the highest frequency we added

as many frequencies as were needed to reach 90% of the total power. The required number

∼

∼

14

of frequencies is deﬁned to be the “complexity” n of the orbit [34].

2. Criterion for chaos

Our ﬁrst and foremost interest is to determine how many of the 2000 orbits in our sample

are chaotic in a given TE conﬁguration. Accordingly an objective, quantitative criterion

for chaos is needed. There is no universally accepted criterion; hence, we developed our

own using the following rationale. Both the largest short-time Lyapunov exponent χ and

the complexity n are well-established, conventional measures of chaos [35]. A ﬁrst piece of

information for deﬁning the criterion comes from plotting n versus χ for all of the orbits.

Fig. 2 provides an example. It shows that (a) n increases approximately linearly with χ,

as one might expect since both quantities are measures of chaos, and (b) the regular orbits

occupy a sharply deﬁned region close to the origin of the n-vs.-χ plot. The borders of this

“region of regularity” thereby oﬀer three possible criteria for chaos: one involving only the

Lyapunov exponent, one involving only the complexity, and one involving both quantities.

We chose to base our criterion only on the complexity for the following reason. Though

no problem arises in computing Lyapunov exponents in the zeroth approximation, such is

not the case in the exact potential, wherein we found that longer integration times are

required to achieve adequate convergence. Recall that the exact potential must be speciﬁed

over a three-dimensional grid. Accordingly, interpolation errors and discontinuities between

the cells can aﬀect computations of Lyapunov exponents because they involve the distance

between two initially nearby orbits, which is a local property that is sensitive to the grid size

and the order of interpolation. By contrast, a computation of complexity, in that it involves

the Fourier spectrum of an individual orbit, avoids reference to nearby orbits and is thus a

global property inﬂuenced little by the grid size, a notion that we corroborated during the

course of our numerical studies. For simulations in exact potentials, we chose a grid size

and interpolation algorithm (cf. Sec. VI below) such that numerical errors had negligible

eﬀect on the computation of individual orbits. A standard measure of the “goodness” of an

orbital integration is the degree to which total energy is conserved [36]; for every orbit we
10−6. This is some two orders of

achieved conservation of total energy with relative error

magnitude better than contemporary standard practice.

≤

Investigations of n-vs.-χ plots for many zeroth-order TE potentials led us to a speciﬁc

15

quantitative criterion, namely, an orbit is categorized as chaotic if its complexity n > 20 [cf.

Fig. 2(c)]. This choice was also checked and conﬁrmed by carefully inspecting hundreds of

plots of individual orbits in several geometries.

Plots of two representative orbits, one regular and one chaotic, as well as their power

spectra in the x-direction and their surfaces of section in the dz/dt-vs.-z phase space, appear

in Fig. 3. Both orbits have similar total energies and evolve in Φ0 corresponding to Case

5 and a2 = 1.0, c2 = 0.25, a strongly oblate spheroid. The ﬁrst orbit has n = 8 and
χ = 0.028 t−1

D ; the second orbit has n = 178 and χ = 0.640 t−1

D . Their diﬀerences are

striking. One major diﬀerence concerns their power spectra. The regular orbit exhibits two

very distinct frequencies in its spectrum, whereas the chaotic orbit features a near-continuum

spanning a large number of frequencies. The surfaces of section are computed by recording

dz/dt and z when x = y = 0. The regular orbit is seen to stay within a localized region

of the dz/dt-vs.-z phase space, whereas the chaotic orbit largely ﬁlls a global area of phase

space commensurate to its total energy.

Results of a numerical experiment that highlights the largest Lyapunov exponent, i.e.,

the rate of global chaotic mixing, appears in Fig. 4. Here, four initially localized clumps

comprising 500 chaotic orbits evolve in the zeroth-order potential Φ0 corresponding to Case

5 and a2 = 0.5, c2 = 1.5, a triaxial conﬁguration. Each clump initially occupies a cube of

size 0.053 in the conﬁguration space. The ﬁgure reveals that each clump mixes through a

global region of phase space with an e-folding time comparable to a dynamical time tD, taken

here to be the orbital period corresponding to the total energy of the individual particles

comprising the clump. After some tens of tD each clump has spread through a volume

commensurate to the total particle energy.

C. Survey results

Our strategy for surveying the parameter space of the TE conﬁgurations is as follows. We

conduct the survey using the zeroth-order potential Φ0 found from Eq. (17). Recall that this

potential depends on the focusing strength Ω and, through R(x), the scale lengths (a, c);

we thus choose a speciﬁc parameter set [a, c; Ω]. Then we integrate 2000 initial conditions

generated by uniformly sampling (1) the volume spanned by the conﬁguration, and afterward

(2) the volume spanned only by the Debye tail. Having established the criterion for chaos

16

(complexity n > 20), we identify and count the chaotic orbits in the respective sample, and

we express this number as a percentage of the sample. This percentage may be viewed as

an indication of the extent to which a given parameter set supports globally chaotic orbits.

However, it should not be taken too literally in that the initial conditions are distributed

uniformly through a volume; they are not weighted by the actual density distribution.

Our numerical experiments fall largely into two categories. Category I pertains to keeping

Ω ﬁxed to its Case 5 value (intermediate space charge), i.e., i = 5 in Eq. (18), and then

varying a and c within the constraint of Eq. (13). Category II pertains to keeping c2 = 0.5

ﬁxed, and then varying Ω and a.

Figures 5 and 6 depict the percentage of chaotic orbits for a portion of the Category I

experiments. Also shown in the bottom panels of these ﬁgures are the initial conditions,

projected onto the (x, z)-plane, corresponding to the axisymmetric conﬁgurations for which

a2 = 0.5. In addition, results from analogous experiments in exact potentials are plotted for

comparison. The ﬁgures exhibit a number of features. First and foremost is the indication

that most of the conﬁgurations support a considerable population of chaotic orbits. This

is true even for axisymmetric conﬁgurations, but of course it is not true for spherically

symmetric conﬁgurations in that their potentials are integrable. Second, orbits for which

the initial conditions all lie within the Debye tail reﬂect a higher percentage of chaos than

were they distributed through the entire conﬁguration space. Third, prolate axisymmetric

conﬁgurations (for which only one datum is shown in each of these ﬁgures) support little

chaos. Fourth, for reasons to be elaborated in Sec. VI below, the exact potentials support

less chaos than their zeroth-order counterparts.

Further analysis reveals that, for conﬁgurations in which they are present, essentially

all of the chaotic orbits originate in the Debye tail. Figure 7 dramatically illustrates this

ﬁnding. To assemble this ﬁgure, the initial conditions are sorted and binned into increments

of R spanning 0.1 units of length. Then, in each increment, the complexity n of every orbit

is computed, and the complexities are averaged to obtain

. The process is repeated for

n
i

h

all of the increments, and then for many diﬀerent parameter sets. The results,

n(R)

versus

h

i

R for Case 5 with a2 = 0.5 and several choices of c2, comprise Fig. 7.

Figure 8 depicts the percentage of orbits for the Category II experiments for which the

initial conditions are uniformly distributed over the volume spanned by the conﬁguration.

Cases corresponding to intermediate space charge would seem to support more chaos. This

17

ﬁnding makes sense when juxtaposed against the limiting cases of zero space charge at

one extreme and zero Debye tail, i.e., the uniform beam, at the other extreme. With zero

space charge, only the linear forces of the external potential inﬂuence the particles. For

the uniform beam the external and space-charge potentials cancel one another so that the

particles move freely, apart from reﬂections at the boundary of the conﬁguration. In both

extremes the orbits are all regular, excepting billiard eﬀects, if any, associated with shapes of

boundary surfaces of uniform bunches. The ﬁgure also suggests that prolate, axisymmetric

TE conﬁgurations support little chaos.

VI. NUMERICAL EXPERIMENTS IN EXACT POTENTIALS

As a matter of principle, one must be concerned about the extent to which subtle structure

in the potential can inﬂuence the qualitative behavior, and in particular the chaoticity, of

an orbit. One well-known example is that of the Toda potential; the full Toda potential

is integrable and supports only regular orbits, but generally a truncated Toda potential is

not integrable and supports a population of chaotic orbits [3]. Our survey of the parameter

space of TE conﬁgurations centered on the use of Φ0, a generally crude approximation to

the true potential. The survey suggests a large region of the parameter space supports

sizeable populations of chaotic orbits, wherein all of these orbits reach into the Debye tail.

We may expect in general that the density proﬁle, particularly that of the Debye tail,

corresponding to the exact potential is considerably diﬀerent from that corresponding to

Φ0. For example, in the limit of distances very far from the centroid, the exact space-charge

potential will approach spherical symmetry, whereas Φ0 is everywhere homeoidally striated.

Accordingly, to check and have conﬁdence in the qualitative results of Sec. V, we must repeat

the numerical experiments in a suitably broad collection of exact potentials. As mentioned

earlier, the reason we did not base the survey on exact potentials is that the respective

numerical experiments are computationally expensive.

To integrate Eq. (12) governing the exact potential Φ(x), which is a fully three-

dimensional partial diﬀerential equation (PDE), we chose a multigrid algorithm [37]. The

algorithm requires boundary conditions be speciﬁed over the surface of the volume occupied

by the grid. We chose a cubic grid volume greatly exceeding the volume of interest, i.e.,

that spanning the Debye fall-oﬀ of the density. Then we calculated the boundary conditions

18

over the surface of this volume using the formalism of the ﬁrst approximation, speciﬁcally,

Eq. (17). Because the resulting boundary conditions are only ﬁrst approximations to the

true boundary conditions, we checked our numerical solutions by varying the positions of

the bounding surfaces of the grid by factors of ﬁve, and we found negligible change in the

results over the volume of interest. Applying the multigrid algorithm to three dimensions

involves nontrivial manipulations of the inherent restriction, interpolation, and relaxation

routines.

In the process, a nonlinear algebraic equation emerges due to the nonlinearity

of the PDE. It was solved using an iterative method that combines Newton-Raphson and

bisection techniques [32].

After tabulating the exact potential in three dimensions, we used a ﬁfth-order Runge-

Kutta algorithm with variable time step to evolve the individual orbits in time, within

which the force at every time (thus position) step was computed using a three-dimensional

interpolation scheme. The resulting orbits conserved total energy with relative error better
than 10−6 and sometimes as low as 10−7.

Figure 9 exempliﬁes the diﬀerence between the zeroth-order and exact potentials. The top

two panels present isopotential contours in the (x, z)-plane for Case 5 with a2 = 0.5, c2 = 1.5,

a triaxial conﬁguration. The bottom panels show how the two potentials compare along

each of the (x, y, z)-axes. Obviously there are, and there should be, diﬀerences, but the

important question is to what extent these diﬀerences alter the qualitative evolution of the

orbits and, in turn, the complexities that characterize them? Analogous graphs for Case

5 and a2 = 1.0, c2 = 0.25, a strongly oblate spheroid, appear in Fig. 10, from which the

respective diﬀerences are seen to be much more pronounced.

Figure 11 provides a visual comparison of a chaotic orbit starting from the same initial

condition and evolving in the zeroth-order and exact potentials of Fig. 9. Although orbits in

the two potentials diﬀer quantitatively, in many cases they are qualitatively similar in that

they explore a similar volume of phase space and have similar morphology. This pertains

to the example of Fig. 11; however, this one example does not in any way guarantee every

orbit that is chaotic in the potential of the zeroth approximation is also chaotic in the exact

potential. Statistical comparisons of orbital complexities respective to the zeroth-order and

exact potentials for several Case 5 conﬁgurations appear in Fig. 12, and these show that

the complexities in the two potentials can diﬀer considerably depending on the speciﬁc

parameter set under study.

19

Following the procedure delineated in Sec. V C, we also computed the percentage of

chaotic orbits in a broad range of exact Case 5 potentials. The results, juxtaposed against

their counterparts computed using Φ0, appear in Table I and in Figs. 5 and 6. For these

examples, there is generally a smaller percentage of chaotic orbits in the exact potential than

in the zeroth approximation. The explanation is simple: compared to the density n1[R(x)],

the density derived from the exact space-charge potential Φ(x) is quasi-uniform over a larger

volume and falls to small values over a shorter scale length. Accordingly, the conﬁguration-

space volume over which the space-charge force is markedly nonlinear, i.e., the Debye tail,

is smaller. Figure 13 illustrates the diﬀerence in the density proﬁles corresponding to the

approximate and exact solutions. In the limit of spherical symmetry the proﬁles are identical,

and they disagree more strongly as they become less spherically symmetric. Most notable

is the comparison between Figs. 13(e) and (f) concerning a strongly oblate spheroid, where

we see that the corresponding exact density distribution is much more uniform than that of

the zeroth approximation. This accounts for the strong discrepancy revealed in Fig. 12(d)

concerning orbital chaoticity. It is also consistent with expectations based on ﬁrst principles:

the closer a system is to being one-dimensional (e.g., sphere, cylindrically symmetric disc,

inﬁnite symmetric cylinder, in which particle motion is integrable), the less is the population

of chaotic orbits. However, the essential observation is that, in most cases, the exact TE

conﬁgurations do indeed support substantial populations of chaotic orbits in keeping with

expectations that surfaced from the survey based on approximate solutions.

VII. SUMMARY, IMPLICATIONS, AND FUTURE WORK

We have explored orbital dynamics and phase mixing in thermal-equilibrium beams for

which the potential is the superposition of an external potential quadratic in the coor-

dinates and the self potential arising from space charge. The associated parameter space

spans the full range of symmetries, i.e., spherical, cylindrical, and triaxial, and the full range

of density proﬁles, i.e., gaussian (corresponding to negligible space charge) through uniform

(corresponding to maximal space charge). To reiterate, the main ﬁndings concerning chaos

in these systems, “discovered” in the context of zeroth approximations to the space-charge

potentials and aﬃrmed with the respective exact potentials, are: (1) conﬁgurations cor-

responding to a large portion of the parameter space support considerable populations of

20

chaotic orbits, (2) essentially all of the orbits that are chaotic reach into the Debye tail where

the collective space-charge force is manifestly nonlinear, (3) prolate axisymmetric conﬁgura-

tions support little chaos, but prolate triaxial conﬁgurations can support considerable chaos,

and (4) strongly oblate spheroids support little chaos, but moderately oblate spheroids can

support considerable chaos.

It is of interest to compare theoretical predictions concerning TE conﬁgurations, for which

we herein have established the existence of chaotic orbits, with results of our numerical

experiments. In terms of the dimensionless quantities introduced in Sec. III, the parameters

κ and ρ of Eq. (6) take the form

κ =

Ω2

1
2 (cid:20)

(cid:18)

1
a2 + 1 +

1
c2

n(x)

h
, ρ = q

(cid:19) − h

i(cid:21)

− h
κ√2

n2(x)

n(x)

2

i

i

.

(19)

and Eq. (5) then yields the mixing rate χ. A comparison between theory and numerical

experiments appears in Fig. 14 wherein the simulation results reﬂect statistics from initially

localized clumps of 2000 particles that were started at zero velocity at various points in

conﬁguration space corresponding to various total particle energies E. The ﬁgure presents a

plot of the mixing rate χ versus

E

in the Case 5 conﬁguration with a2 = 4/5, c2 = 4/3, a

slightly triaxial system. This conﬁguration is “not too far away” from spherical symmetry,

which means the zeroth approximation Φ(x) = Φ0 is correspondingly reasonable. It also

means only a modest population (

5% for this parameter set) of chaotic orbits is supported.

The ﬁgure was derived within the framework of the zeroth approximation because therein

the Lyapunov exponents, i.e., mixing rates, can be accurately computed from the simulations

|

|

∼

and the microcanonical averages required for the theory likewise can be easily and accurately

evaluated. The numerical experiments span a range 0.5

60, corresponding to

E

≤ |

| ≤

25, i.e., extending from within to well beyond the Debye drop-oﬀ in the density

11

R

≤

≤

proﬁle. The agreement between theory and numerical experiments is remarkably close.

One can see from the numerical experiments described herein that chaotic mixing takes

place on an e-folding time scale comparable to a dynamical time (an orbital period). This

is very fast compared to, e.g., collisional relaxation; hence, one must account for this col-

lisionless process when designing an accelerator for the production of high-peak-current,

high-brightness beams. For example, particles comprising a beam out of equilibrium will, if

globally chaotic, redistribute themselves globally and irreversibly on a dynamical time scale.

Because perturbations induced, e.g., by transitions in the beamline will drive a beam away

21

from equilibrium, chaotic mixing can be a dynamic of practical importance. Consider the

case of a TE conﬁguration: a small perturbation from image charges passing through an

external irregularity in the beamline will distort the Debye tail. If a substantial fraction of

particles in the Debye tail are chaotic, which is the case for a wide range of bunch geometries,

a corresponding fraction of the orbits comprising the distortion will quickly mix throughout

the volume of the conﬁguration. The work done by the external perturbation in setting up

the distortion will thereby appear in the form of a larger conﬁguration-space volume. If the

perturbation is strong enough so that mixing in momentum space associated with conse-

quent time-dependence in the potential is also substantial, then some of the work done will

also appear in the form of a larger momentum space. The net eﬀect is a larger emittance.

If there are many such perturbations along the beamline, the cumulative emittance growth

may be troublesome.

The present investigation and its associated implications concern only very speciﬁc, time-

independent, single-species systems, i.e., beams (or nonneutral plasmas) in thermal equilib-

rium. These are the most benign systems imaginable, yet we found even they can support

chaotic orbits. Any perturbation will create a nonequilibrium, time-dependent system that

will subsequently evolve self-consistently. Accordingly, the space-charge potential can be

complicated, particularly if the perturbation is strong. The only sensible conjecture un-

der such conditions is that the corresponding population of chaotic orbits will be larger,

and in turn chaotic mixing will be more prevalent. Exploratory numerical simulations of

an equipartitioning system and of merging beamlets have supported this notion [2]. Fur-

ther exploration of time-dependent beams is warranted and will likely prove illuminating,

particularly in regard to deciphering time scales for emittance growth, halo formation, etc.

By using only smooth potentials we have restricted our analysis to the six-dimensional

phase space of a single particle. Accordingly we have suppressed dissipative eﬀects of colli-

sions in particular, and force ﬂuctuations in general. Such eﬀects can only enhance chaos,

as has been demonstrated, e.g., in numerical experiments concerning self-gravitating sys-

tems [27]. As the next step, we have constructed frozen N-body representations of the

charge densities of the TE conﬁgurations and with these representations are repeating the

numerical experiments described herein. One of our objectives is to determine the mini-

mum number of particles needed to reproduce the dynamics associated with smooth time-

independent potentials. Results will be described in a forthcoming paper [28]. In the future

22

it will be of interest to do likewise for time-dependent systems and ultimately ascertain, e.g.,

conditions under which the Vlasov equation governing the six-dimensional phase space of a

single particle can be applied with conﬁdence.

Acknowledgments

We thank Henry Kandrup for helpful discussions and for ﬁnancially supporting one of us

(IVS) through NSF Grant AST-0070809 in the early stages of this work. We also beneﬁted

from useful conversations with Rami Kishek. Most of this work was supported through U.S.

Department of Education Grant G1A62056.

[1] M. Reiser, Theory and Design of Charged Particle Beams, (Wiley, New York, 1994), Sec. 6.2.2.

[2] C.L. Bohn, I.V. Sideris, H.E. Kandrup, and R.A. Kishek, in Proceedings of the XXI Linear

Accelerator Conference, Paper TU435, http://linac2002.postech.ac.kr/, (2002).

[3] H.E. Kandrup and M.E. Mahon, Phys. Rev. E 49, 3735 (1994).

[4] D. Merritt and M. Valluri, Astrophys. J. 471, 82 (1996).

[5] D. Sagan, Am. J. Phys. 62, 450 (1994).

[6] R.C. Davidson and H. Qin, Phys. Rev. ST-AB 2, 114401-1 (1999).

[7] N. Brown and M. Reiser, Phys. Plasmas 2, 965 (1995).

[8] M. Reiser and N. Brown, Phys. Rev. Lett. 71, 2911 (1993).

[9] M. Reiser, Theory and Design of Charged Particle Beams, op. cit., Sec. 5.4.3.

[10] A.W. Chao, Physics of Collective Beam Instabilities in High Energy Accelerators, (Wiley, New

York, 1993), p. 26.

[11] For example, see Space Charge Dominated Beams and Applications of High-Brightness Beams,

edited by S.Y. Lee, AIP Conf. Proc. No. 377 (AIP, New York, 1996).

[12] M. Reiser and N. Brown, Phys. Rev. Lett. 74, 1111 (1995).

[13] R.C. Davidson, Phys. Rev. Lett. 81, 991 (1998).

[14] C.L. Bohn, in The Physics of High Brightness Beams, edited by J. Rosenzweig and L. Seraﬁni

(World Scientiﬁc, Singapore, 2000), pp. 358-368.

[15] H.E. Kandrup, I.V. Sideris, and C.L. Bohn, Phys. Rev. E 65, 016214 (2001).

23

[16] M. Pettini, Phys. Rev. E 47, 828 (1993); L. Casetti, C. Clementi, and M. Pettini, Phys. Rev.

E 54, 5969 (1996); L. Casetti, M. Pettini, and E.G.D. Cohen, Phys. Rep. 337, 237 (2000).

[17] H. Goldstein, Classical Mechanics, (Addison-Wesley, Reading, MA, 1950), pp. 228-235.

[18] L.P. Eisenhart, Ann. Math. 30, 591 (1929).

[19] J. Szczesny and T. Dobrowolski, Ann. Phys. (NY) 77, 161 (1999).

[20] P. Cipriani and M. Di Bari, Planet. Space Sci. 46, 1499 (1998).

[21] L. Casetti, R. Livi, and M. Pettini, Phys. Rev. Lett. 74, 375 (1995).

[22] M.N. Rosenbluth, W.M. MacDonald, and D.L. Judd, Phys. Rev. 107, 1 (1957).

[23] J. Struckmeier, Phys. Rev. E 54, 830 (1996).

[24] M. Hemsendorf and D. Merritt, Astrophys. J. 580, 606 (2002).

[25] H.E. Kandrup and I.V. Sideris, Phys. Rev. E 64, 056209-1 (2001).

[26] I.V. Sideris and H.E. Kandrup, Phys. Rev. E 65, 066203-1 (2002).

[27] H.E. Kandrup and I.V. Sideris, Astrophys. J. (in press).

[28] H.E. Kandrup, I.V. Sideris, and C.L. Bohn, Phys. Plasmas (in preparation).

[29] H.E. Kandrup, in Proceedings of the 2002 Athens Workshop on Galaxies and Chaos, Theory

and Observations, Springer Lecture Notes in Physics (in press).

[30] C.L. Bohn, Astrophys. J. 268, 646 (1983).

[31] S. Chandrasekhar, Ellipsoidal Figures of Equilibrium, (Yale, New Haven, 1969), Theorem 12,

[32] W.H. Press, S.A. Teukolsky, W.T. Vetterling, and B.P. Flannery, Numerical Recipes in C,

(Cambridge Univ. Press, NY, 1993).

[33] G. Bennetin, L. Galgani, A. Giorgilli, and J.M. Strelcyn, Meccanica 15, 9 (1980)

[34] H. E. Kandrup, B. L. Eckstein, and B. O. Bradley, Astron. and Astrophys. 320, 65 (1997).

[35] M. Tabor, Chaos and Integrability in Nonlinear Dynamics (Wiley, New York, 1989).

[36] R.W. Hockney and J.W. Eastwood, Computer Simulation Using Particles (IOP, London,

p. 52.

1988).

[37] A. Brandt, Mathematics of Computation 31, 333 (1977).

24

Table I. Percentage of chaotic orbits: approximate vs. exact potentials

Whole conﬁguration space:

a2

0.5

0.5

0.5

1.0

1.0

a2

0.5

0.5

0.5

1.0

1.0

Debye fall-oﬀ interval:

c2

0.50

1.50

2.00

0.25

0.50

c2

0.50

1.50

2.00

0.25

0.50

% 0th

6.95

35.50

36.55

33.20

19.85

% 0th

7.55

43.40

42.90

37.55

29.45

% exact

5.90

19.45

17.15

7.05

26.05

% exact

7.32

35.50

36.55

7.05

24.55

25

FIG. 1: (a) Space-charge potential Φ0 vs. R for Ω corresponding to Cases 2-8 as deﬁned in Eq. (18).

(b) Number density n1 vs. R for Cases 2-8.

26

FIG. 2: (a) Distribution f (χ), in arbitrary units, of Lyapunov exponents χ (Case 5, a2 = 0.5, c2 =

1.5) in the zeroth approximation Φ0. The unit of χ is t

−1
D . The distribution peaks at low values of

χ for which the respective orbits are regular. The dotted line, hand-drawn at the point where the

distribution levels oﬀ, suggests one possible criterion of chaos. (b) Distribution f (n) of complexities

n corresponding to the orbits of the ﬁrst panel, which looks qualitatively similar to f (χ).

(c)

Complexities n versus Lyapunov exponents χ. The inset reveals that the concentration of regular

orbits near the origin lies inside sharply deﬁned boundaries.

27

FIG. 3: Two representative orbits in the potential Φ0 of the zeroth approximation (Case 5,

a2 = 1.0, c2 = 0.5), one regular (a,c,e) for which n = 8 and χ = 0.028 t

−1
D , and one chaotic (b,d,f)

for which n = 178 and χ = 0.640 t

−1
D , each with similar total energies: (a,b) orbits on (x,z)-plane;

(c,d) power spectra in x-direction; (e,f) surfaces of section dz/dt vs. z.

28

FIG. 4: Snapshots of four diﬀerent clumps of chaotic orbits (Case 5, a2 = 0.5, c2 = 1.5) evolving

in the potential Φ0. Each clump initially occupies a cube of volume 0.053, but exponentially grows

to ﬁll a volume commensurate to the total particle energy.

29

FIG. 5: Top: Percentage of chaotic orbits for Case 5 vs. c2 in the potential Φ0 with diﬀerent

choices of a2. The initial conditions uniformly sample the region 0

15, which in essence

R

≤

≤

covers the volume spanned by Case 5 conﬁgurations [cf. Fig. 1(b)]. Results derived from exact

solutions Φ(x) of Poisson’s equation are also plotted for comparison; they are joined by a dotted

line (a2 = 1, c2 < 1) or by dashed lines (a2 = 0.5). These exact results are to be compared to

their zeroth-order counterparts delineated with blackened symbols to aid the eye. Bottom: Initial

conditions, projected onto the (x, z)-plane, used for a2 = 0.5; z-axis is vertical.

30

FIG. 6: Same as Fig. 5, but with initial conditions that uniformly sample only the Debye tail

15. For ease of visualization, the bottom panel shows only the initial conditions for which

≤

R

0.

9

y

≤

∼

31

FIG. 7: Average complexity

versus homeoidal coordinate R for Case 5 in the potential Φ0

n
h

i

with a2 = 0.5 and diﬀerent choices of c2. Essentially all of the chaotic orbits reach into the Debye

tail.

32

FIG. 8: Percentage of chaotic orbits in the potential Φ0 with c2 = 0.5 and Ω corresponding to

Cases 3-8 as deﬁned in Eq. (18). Diﬀerent curves correspond to diﬀerent choices of a2. The initial

conditions uniformly sample the respective conﬁgurations.

33

FIG. 9: Comparisons between the space-charge potential Φ0 in the zeroth approximation and the

exact potential Φ(x) (Case 5, a2 = 0.5, c2 = 1.5): (a) isopotential contours of Φ0, (b) isopotential

contours of Φ(x), (c,d,e) proﬁles along the (x, y, z)-axes, respectively (blue and red curves pertain

to Φ0 and Φ(x), respectively).

34

FIG. 10: Same as Fig. 9, but with a2 = 1.0, c2 = 0.25.

35

FIG. 11: A chaotic orbit in the zeroth-order potential (top panels) and exact potential (bottom

panels) of Fig. 9 evolved from the same initial conditions. The orbit is similar, but not identical,

in the two potentials.

36

FIG. 12: Average complexity

versus homeoidal coordinate R for zeroth-order (blue) and exact

n
h

i

(red) Case 5 potentials with: (a) a2 = 0.5, c2 = 0.5; (b) a2 = 0.5, c2 = 1.5; (c) a2 = 0.5, c2 = 2.0;

(d) a2 = 1.0, c2 = 0.25; (e) a2 = 1.0, c2 = 0.5.

37

FIG. 13: Comparisons between the density distributions of the ﬁrst approximation n1[R(x)] (left)

and exact solution n(x) (right) for Case 5 with: (a,b) a = c = 1.0 (spherical), (c,d) a2 = 0.5, c2 =

1.5 (triaxial), (e,f) a2 = 1.0, c2 = 0.25 (strongly oblate spheroid).

38

FIG. 14: Theoretical results (dashed curve) and numerical results (diamonds) for the mixing rate

χ of chaotic orbits vs. total particle energy

(Case 5, a2 = 4/5, c2 = 4/3). The unit of χ is t

−1
D .

E
|

|

39

