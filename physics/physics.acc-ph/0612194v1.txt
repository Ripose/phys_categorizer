6
0
0
2
 
c
e
D
 
0
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
9
1
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Spin motion at and near orbital resonance in storage rings
with Siberian Snakes
I: at orbital resonance∗

D P Barber†
mpybar@mail.desy.de

M Vogt
vogtm@mail.desy.de

Deutsches Elektronen–Synchrotron, DESY, 22607 Hamburg, Germany

Abstract

Here, and in a sequel, we invoke the invariant spin ﬁeld to provide an in–depth study
of spin motion at and near low order orbital resonances in a simple model for the eﬀects
of vertical betatron motion in a storage ring with Siberian Snakes. This leads to a clear
understanding, within the model, of the behaviour of the beam polarisation at and near
so–called snake resonances in proton storage rings.

1

Introduction

In earlier papers we and collaborators have emphasised the utility of the invariant spin ﬁeld
(ISF) and the amplitude dependent spin tune (ADST) for analysing spin motion in circular
particle accelerators and storage rings [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]. In particular, under certain
conditions, the ISF is unique up to a global sign and in that case it allows estimates to be
made of the maximum equilibrium beam polarisation and the maximum time averaged beam
polarisation in proton storage rings. Then, for example, for a given equilibrium distribution of
particles in phase space, the maximum attainable polarisation at the chosen high energy can be
estimated before embarking on extensive computer simulations of the eﬀect on the polarisation
of acceleration from low energy. Once a machine conﬁguration has been found which appears
to be acceptable at the chosen high energy, one then studies the eﬀect of acceleration to assess
whether the conﬁguration is still acceptable. Acceleration can involve crossing many spin–orbit
resonances and that can lead to a loss of polarisation. The latter problem can be partially solved
by the inclusion in the ring of so–called Siberian Snakes [11, 12], magnetic ﬁeld conﬁgurations
that cause the average spin precession rate on the design orbit to be independent of the nominal
beam energy. Nevertheless, spin–orbit resonances can still occur but their identiﬁcation then
often requires a more careful deﬁnition of the spin precession rate than has been common
among practitioners, involving the amplitude dependent spin tune. A full understanding also

∗DESY preprint DESY 06–220. Published in: New Journal of Physics 8 (2006) 296. Worldwide copyright

by: Institute of Physics and Deutsche Physikalische Gesellschaft (2006)

†Also Visiting Staﬀ Member at the Cockcroft Institute, Daresbury Science and Innovation Campus, and at

the University of Liverpool, UK.

1

requires a careful deﬁnition of an adiabatic invariant for spin motion. In most of the numerical
investigations described in [1, 2, 3, 4, 5, 6, 7, 9, 10], orbital resonance is avoided. Moreover,
it is shown that the spin–orbit systems tend to avoid exact spin–orbit resonance. These and
other matters are explained and illustrated in great detail in the sources cited above. In order
to keep this paper to a reasonable length we will assume that the reader is familiar with that
material.

Of course, the ISF and the concepts derived from it, may be of little help if the ISF is not
unique. That can be the case if the orbital motion is resonant or if the system is on spin–orbit
resonance [5, 7]. Nevertheless, as we show below, special choices from sets of non–unique ISF’s
can be useful for investigating spin motion near some kinds of orbital resonance. Moreover,
the ISF is still useful at rational vertical orbital tunes corresponding to the so–called odd order
snake “resonances”. At these tunes the Siberian Snakes apparently do not succeed in preventing
loss of polarisation during acceleration [13, 14, 15, 16, 17, 18]. However, with the exceptions of
[19, 20, 5, 21], discussions about spin motion at or near to these tunes have made no reference
to the ISF. The treatment in [19, 20] involved a mathematical approximation to the model used
in this paper. Then in [5] it was pointed out for the ﬁrst time that at these tunes the ISF is an
irreducibly discontinuous function of the vertical orbital phase and that the discontinuities can
be moved, thereby demonstrating non–uniqueness. In [21] the necessity of the discontinuities
was disputed (see Section 3.4). In Section 2 we explain that exactly at these special tunes,
the term “snake resonance” does not ﬁt with our preferred deﬁnition of spin–orbit resonance.
Nevertheless, for simplicity, we adopt the now traditional nomenclature. In [5] it was also made
clear how non–uniqueness can occur at other rational tunes.

|

|

T21(p)

In this paper and in a sequel (called Part II) we extend the investigations in [5]. In the initial
and pioneering work on snake resonances in [13, 14, 15], emphasis was placed on the signiﬁcance
of the so–called “perturbed spin tune”, a measure of the angles of spin rotation around the real,
unit length, eigenvectors of 1–turn SO(3) spin maps. See also [22]. However, these eigenvectors
are usually not solutions of the Thomas–Bargmann–Michel–Telegdi (T–BMT) equation along
the trajectories. Thus, while it is clear from calculations that the “perturbed spin tune” can
show strong variations, we do not consider its behaviour to be relevant to the discussion [8].
In [13, 14, 15] spin motion was also analysed in terms of an essentially perturbative expansion
of the p–turn SU(2) spin transfer matrix, T (p), and it was found that at snake–resonance
could increase without limit as the number of turns p increased. In so far as
tunes,
it relates to positions in tune space, this behaviour, which is an artifact of the perturbative
approach, appears to be consistent with the snake resonance phenomenon. However, although
an unlimited increase of a matrix element in a perturbative expression for a rotation matrix does
suggest exceptional behaviour, it destroys the unitarity of the matrix, thereby demonstrating
an invalid approximation and implying a consequent limitation of the predictive power of the
calculation. For example, in the absence of other input, one might suppose that an unlimited
could infer that initially vertical spins are simply ﬂipped. Alternatively, the
growth of
growth might be a hint that the vertical component of the beam polarisation oscillates as spins
rotate around a horizontal axis. Lastly, simulations reported in [10, 23, 24] demonstrate the
eﬀects of varying the rate of acceleration near snake–resonance tunes. The number of turns
needed to traverse a given energy range depends on the energy gain per turn. Then, if weight
is given to the perturbative treatment, the number of turns determines how large
can
become. The rate of acceleration is certainly important in the Froissart–Stora calculation [25]
of the loss of polarisation when crossing spin–orbit resonances in rings without snakes, and
the phenomenology is well understood. However, the simulations in [10, 23, 24] show that the

T21|

T21|

|

|

2

dependence of the ﬁnal polarisation on the acceleration rate can be complex and unexpected
and that no clear picture emerges.

To summarise, in our opinion, although snake resonances have presented problems [17, 18],
the numerical and theoretical investigations made so far have provided no completely coherent
picture of spin motion at and near snake–resonance tunes, either with or without acceleration.
These papers provide a new contribution towards such a picture, at least within our adopted
simple model. We carry out our study against the background of our standard philosophy,
namely that to detect exceptional behaviour, one should start spin–orbit tracking simulations
with an equilibrium distribution of particles in phase space and with each spin parallel to the
ISF vector corresponding to the position of the particle in phase space [7]. Then any unexpected
behaviour is signalled by long term or turn–to–turn variations of the polarisation of the beam.
This gives a much cleaner view of the situation than if one just begins in the common way
with spins parallel to the direction of the ISF on the closed orbit. Accordingly, with the ISF at
the centre of our discussion we show how, in the cases considered, the long term behaviour of
spins can be inferred, at least qualitatively, from some features of the ISF. On low order orbital
resonance, an ISF can be calculated almost trivially from the spin maps of a few turns.

For our purposes, and in order to allow direct comparison, it suﬃces just to consider a
model used in earlier literature [13, 14, 15], namely a model with two Siberian Snakes. Since
the ranges of the relevant parameters and the number of possible conﬁgurations is huge, this
study, which is mainly numerical, is not exhaustive. We fully appreciate that storage rings do
not run on low order orbital resonance, that spin–orbit resonances need not be well separated,
that particles have three modes of oscillation and that particle motion in real rings can be
nonintegrable. Nevertheless our study provides useful insights.

The paper is structured as follows. We continue in Section 2 by recalling the simple idealised
and traditional model of spin motion for protons considered in [5, 13, 14, 15] and specify the
notation commonly used to describe it. Then in Section 3 we use the model to study spin
motion exactly at orbital resonances including an odd order snake resonance and show how the
chief features of spin motion can be guessed from the characteristics of the ISF. We summarise
our studies in Section 4. Part II of this study completes the picture by addressing spin motion
close to, but not at, an odd order snake–resonance tune. The numerical calculations were
carried out with purpose–built spin–orbit tracking codes, with the spin–orbit tracking facilities
in the code SPRINT [3, 4] and with the SODOM–II algorithm [26] embedded in SPRINT.

2 Recapitulation – the single resonance model with two

snakes

Spin motion in the electric and magnetic ﬁelds at the point ~z in the 6–dimensional phase
space at beam energy E0 and at the position s around the ring, is described by the T–BMT
precession equation d~S/ds = ~Ω(~z; s, E0)
~S [27, 28, 1] where ~S is the spin expectation value
(“the spin”) in the rest frame of the particle and ~Ω(~z; s, E0) contains the electric and magnetic
ﬁelds in the laboratory and depends on the beam energy E0. The ISF, whose value at (~z; s)
is denoted by ˆn(~z; s), is a 3–vector ﬁeld of unit length obeying the T–BMT equation along
particle trajectories (~z(s); s) and fulﬁlling the periodicity condition ˆn(~z; s + C) = ˆn(~z; s) where
C is the circumference1. Thus ˆn( ~M(~z; s); s + C) = ˆn( ~M (~z; s); s) = R3×3(~z; s)ˆn(~z; s) where
1We emphasise that the non–trivial ISF vector ˆn(~z; s) should not be confused with the trivial vector ~n used

×

to denote ~Ω in [15, equation 2.46] and in [29, equation 1] and having the same periodicity.

3

·

|

|

|

ˆn
|

~M (~z; s) is the new position in phase space after one turn starting at ~z and s, and R3×3(~z; s) is
the corresponding spin transfer matrix. For convenience we have suppressed the dependence
of ~M , R and ˆn on E0. In addition to the kinematical constraint
= 1, a complete deﬁnition
of the ISF requires the speciﬁcation of a constraint on its regularity with respect to ~z. For
example, one could require that ˆn(~z; s) is continuous in ~z.
It is clear that such regularity
conditions are needed since, for example, a piece–wise continuous ISF exists if a continuous
one exists but not vice versa. See Section 3.4 and [5]. However, since the emphasis of the
paper is on numerical results, we only occasionally dwell on the matter of regularity. We use
the term “global uniqueness” if two ISF’s can diﬀer only by a sign. Thus in the case of global
ˆn, exist as in Section 3.1 or none, as in Section 3.4. We
uniqueness, either exactly two ISF’s,
±
ˆn′ = 0, so that ˆn
use the term “local uniqueness” if any two ISF’s, ˆn and ˆn′ are parallel, i.e. ˆn
and ˆn′ can diﬀer only by a sign function. Of course global uniqueness implies local uniqueness
but not vice versa. Since the issue of local uniqueness is beyond the scope of this paper, it will
be addressed only brieﬂy. If an ISF exists and parameters such as E0 are constant, the scalar
product Js = ~S

is invariant along a trajectory.

ˆn/

×

~S

For a turn–to–turn invariant particle distribution in phase space, a distribution of spins
initially aligned along the ISF remains invariant from turn–to–turn, i.e., in “equilibrium”.
Moreover, for integrable orbital motion and away from both orbital resonances and spin–orbit
of ˆn over the phases on a torus is the maximum
resonances (see below), the average
attainable time averaged beam polarisation Plim. Away from orbital resonances and spin–
orbit resonances the actual time averaged polarisation can be written as PlimPdyn where the
Pdyn =
depends on the history of the beam [4]. For a turn–to–turn invariant particle
distribution in phase space Plim =
is also the maximum attainable equilibrium beam
i|
polarisation. This is reached when Pdyn = 1.

ˆn(~z; s)

ˆn(~z; s)

Js

|h

|h

|h

i|

i|

Under appropriate conditions Js is an adiabatic invariant while system parameters such as
the beam energy E0 are slowly varied [3, 9]. In fact ˆn then serves as a “template” for spin
motion. Several examples of this are given in Section 3.

The ADST νs( ~J) at the amplitudes (actions) ~J, is the number of spin precessions around
the ˆn per turn on a trajectory, viewed in a so–called uniform precession frame (UPF). See [7] for
precise deﬁnitions for smooth systems, i.e., systems with continuously diﬀerentiable functions,
and for an explanation of how a particular ADST is, in fact, a member of an equivalence
class. Note that although the systems in this paper are not smooth in s due to the presence of
point–like snakes (see below), their smoothness in ~z facilitates a close analogy with the smooth
systems of [7].

In general, an ADST does not exist if the trajectory is on orbital resonance but on the other
hand, one avoids running a machine on orbital resonances, at least those of low order. If an
ADST exists, it depends only on ~J, hence the name ADST.

The ADST provides a way to quantify the degree of coherence between the spin and or-
bital motion and thereby predict how strongly the electric and magnetic ﬁelds along particle
trajectories disturb spins. In particular, the spin motion can become very erratic close to the
spin–orbit resonance condition νs( ~J) = k0 + k1Q1 + k2Q2 + k3Q3 where the Q’s are orbital
tunes and the k’s are integers. Near these resonances the ISF can spread out so that Plim is very
ˆn(~0; s).
small. The spin tune on the design orbit ν0 ≡
In this paper we shall be concerned mainly with those orbital resonances where the Q’s are
rational. We write the fractional parts, [Qi], of rational tunes Qi (i = 1, 2, 3) as ai/bi where
the ai and bi are integers. Here and later the brackets [...] are used to signal the fractional
part of a number. For rational [Qi] a trajectory is periodic over c turns where c is the lowest

νs(~0) always exists and so does ˆn0(s)

≡

4

common multiple of the bi. This opens the possibility that in this case the ISF at each (~z; s)
can be obtained (up to a sign) as the unit length real eigenvector of the 3
3 orthogonal
matrix representing the c–turn spin map (c.f. the calculation of ˆn0 from the 1–turn spin map
on the closed orbit). However, the corresponding eigentune cνc extracted from the complex
eigenvalues Λc = e±2πicνc, depends in general on the synchrobetatron phases at the starting
~z. Thus in general νc cannot be used to ﬁnd a spin tune. Nevertheless if c is very large the
dependence of νc on the phases can be very weak so that it can approximate well the ADST of
nearby irrational tunes. For non–resonant orbital tunes, the spin tune can be obtained using
the SODOM–II algorithm [26] or from averaging the pseudo spin tune [3, 4].

×

k0 ±

In perfectly aligned ﬂat rings with no solenoids, ˆn0 is vertical and ν0 can be chosen to be
aγ0 where γ0 is the Lorentz factor on the closed orbit and a is the gyromagnetic anomaly of the
particle. In the absence of skew quadrupoles, the primary disturbance to spin is then from the
radial magnetic ﬁelds along vertical betatron trajectories. The disturbance can be very strong
and the beam polarisation can be small near the condition aγ0 = κ
Q2 where k0 is an
integer and mode 2 is vertical motion. This can be understood in terms of the “single resonance
model” (SRM) whereby a rotating wave approximation is made in which the contribution to ~Ω
from the radial ﬁeld along a vertical betatron trajectory is dominated by the Fourier component
at κ with resonance strength ǫ(J2). The SRM can be solved exactly and the ISF is given by
[30] ˆn(φ2) =
κ is the distance in tune space
to the parent resonance, λ = √δ2 + ǫ2, φ2 is the diﬀerence between the vertical betatron phase
and the phase of the Fourier component and (ˆe1, ˆe2, ˆe3) are horizontal, vertical and longitudinal
so that it is 90◦ at δ = 0 for
unit vectors. The tilt of ˆn away from the vertical ˆn0 is
non–zero ǫ. At large
, the equilibrium polarisation directions ˆn(J2, φ2; s), are almost parallel
to ˆn0(s) but as we see from the above formula, at δ = 0, ˆn lies in the horizontal plane and
Plim = 0. In this simple model νs exists and is well deﬁned near spin–orbit resonances for all
Q2.
In our calculations we choose the phase of the Fourier harmonic to be zero so that φ2
represents the phase of the vertical betatron motion.

(δˆe2 + ǫ(ˆe1 cos φ2 + ˆe3 sin φ2)) /λ where δ = aγ0 −

arcsin(ǫ/λ)

±

≡

δ

|

|

|

|

ˆe2 = +1 in one half ring and

It is found both in practice and in simulation, that in the absence of special measures,
acceleration of the beam through δ = 0 at practical rates can lead to loss of beam polarisation.
This loss can be ascribed to a loss of invariance of Js and it can be quantiﬁed in terms of
the Froissart–Stora formula [25]. Luckily, the loss of polarisation can be reduced by installing
pairs of Siberian Snakes [11, 12], magnet systems which rotate spins by π, independently of ~z,
around a “snake axis” in the machine plane. For example, one puts two snakes at diametrically
opposite points on the ring. Then ˆn0 ·
1 in the other. With the
snake axes relatively at 90◦, the fractional part of ν0 becomes 1/2 for all γ0. For calculations
one often represents the snakes as elements of zero length (“point–like snakes”). Then if, in
addition, the eﬀect of vertical betatron motion is described by the SRM, and orbital resonances
are avoided, at most J2, the fractional part of the ADST is 1/2 too, independently of γ0
[10, 31, 5]. This is a special feature of this model. Thus for [Q2] away from 1/2, the system
is not at the ﬁrst order spin–orbit resonance νs(J2) = [Q2]. Therefore such resonances are
not crossed during acceleration through δ = 0 and the polarisation can be preserved. This is
conﬁrmed by tracking simulations. However, simulations have shown also that the polarisation
can still be lost if [Q2] = ˜a2/2˜b2 where here, and later, ˜a2 and ˜b2 are odd positive integers
with ˜a2 < 2˜b2 [13, 14, 15]. This is the “snake resonance phenomenon” and it has also had
practical consequences [13, 14, 15, 17, 18], especially for small ˜b2. Such a [Q2] ﬁts the condition
˜a2)/2 + ˜b2[Q2]. Since such tunes correspond to orbital resonance an ADST does not
1/2 = (1
exist at most amplitudes. Then, according to our deﬁnition the system is not on a spin–orbit

−

−

5

−

˜a2)/2 + ˜b2[Q2]. However, for nearby irrational [Q2] an ADST can exist,
resonance νs(J2) = (1
namely with the value 1/2. Then one can say that the system is close to spin–orbit resonance.
This case is studied in Part II. Because the system is on orbital resonance and using the analogy
with the smooth systems [7], even a smooth ˆn need not be globally unique. Even if it were,
there would be no guarantee that the maximum time averaged polarisation on a torus would
be given by
. We investigate these matters in the next section. Note that the rings
in the Relativistic Heavy Ion Collider, RHIC [17, 18] contain two snakes and that the RHIC
team has avoided running near snake–resonance vertical tunes. Even away from the dangerous
orbital tunes just mentioned, snake layouts should be chosen carefully. Methods for choosing
layouts are discussed in [3, 4].

ˆn(~z; s)

|h

i|

Although one can describe spin motion in terms of orthogonal 3x3 matrices, here, we prefer
to use SU(2) matrices. Correspondingly, the orientation of a spin is encoded in a two–component
spinor2. We write the SU(2) matrices as

I cos(ψ/2)

i~σ

ˆm sin(ψ/2)

−

·

where I is the 2
2 unit matrix, ˆm is the unit vector along the eﬀective rotation axis, ψ is the
angle of rotation around that axis and the three components of ~σ are the Pauli matrices. The
rotation is right handed when ψ > 0. Equation (1) can be re–written as

×

Ir0 −

i~σ

~r

·

i = 1. We call the real ordered quadruple (r0, ~r) a unit quaternion [32, 4]. Spin

3
i=0 r2

P

where
maps are then concatenated using the multiplication rule
(a0, ~a) (b0, ~b) = (a0b0 −

~a

·

~b, a0~b + ~ab0 + ~a

~b) = (c0, ~c)

×

0 −

where (a0,~a), (b0,~b) and (c0, ~c) are unit quaternions. The elements of the usual 3
3 matrices
are given by Rij = (2r2
1)δij +2rirj +2r0ǫijkrk where δij is the Kronecker symbol and ǫijk is the
Levi–Civita symbol. Note that the Rij are homogeneous quadratic forms in the ri. This implies
that Rij(r0, ~r) = Rij(
~r) which simply reﬂects the fact that SU(2) covers SO(3) twice. In
this paper, as in [5], we consider a system with two point–like snakes placed at diametrically
opposite points on the ring. The snake axes are respectively at 0◦ and 90◦ to the longitudinal
direction. The eﬀect of vertical betatron motion is modelled by the SRM. The components of
2 just before the ﬁrst (0◦) snake are then
the unit quaternion for one turn starting with phase φ0

r0,

−

−

×

(1)

(2)

(3)

r0 =

r1 =

r2 =

r3 =

sin(2φ0

2 + 2πκ)

sin2 πλ
2

(cid:16)

(cid:18)−

ǫ
2
λ (cid:17)
ǫ
λ
cos2 πλ

−

2 − (cid:18)

2

δ
λ (cid:19)

sin πλ sin πκ

ǫ
λ

(cid:18)−

sin πλ cos πκ + 2

2

ǫ
δ
λ
λ
−
sin2 πλ

sin2 πλ
2

2

ǫ
λ (cid:17)
sin2 πλ
2

2 − (cid:16)
ǫ
δ
λ
λ

cos πκ

(cid:19)
sin2 πλ
2

sin(φ0

2 + πκ)

cos(2φ0

2 + 2πκ)

sin πκ

sin(φ0

2 + πκ) .

(cid:19)

(4)

As mentioned above, on orbital resonance, the vector ˆn can be obtained (up to a sign) as the
eigenvector of unit length of the appropriate c–turn spin map. In terms of unit quaternions, ˆn

2 Of course, these spinors should not be interpreted as “spin wave functions”: here we are dealing with

classical equations of motion for spin expectation values.

6

is simply the unit vector along the vector ~r(c) for the c–turn unit quaternion and we are free to
choose the sign.

δ

It is clear from (4) that with small but non–zero ǫ/λ, the 1–turn spin map is close to a
rotation by the angle π around an axis close to the vertical. This is expected on physical
, i.e., far from the parent resonance, or at small ǫ, the perturbation
grounds too: at large
embodied in ǫ is relatively unimportant and the spins precess by an amount per turn similar to
that on the design orbit. Then, the map for an odd number of turns is also close to a rotation
by the angle π around the vertical but the map for an even number of turns is close to the
identity. If λ is an even integer, the 1–turn spin map is always a rotation by the angle π around
the vertical.

|

|

It is straightforward to show that at most small values of ǫ/λ and with [Q2] = a2/b2, the
rotation vector ~r(b2) for a b2–turn map is close to vertical for [Q2] = 1/3, 2/3, 1/5, 2/5, 3/5,
4/5, 1/7, 2/7, 3/7, 4/7, 5/7, 6/7, . . . and for [Q2] = 1/4, 3/4, 1/8, 3/8, 5/8, 7/8, 1/12,
5/12, 7/12, 11/12, . . ., and that unless λ is an even integer, it is close to the horizontal plane
for [Q2] = 1/6, 5/6, 1/10, 3/10, 7/10, 9/10, 1/14, 3/14, 5/14, 9/14, 11/14, 13/14,
,
· · ·
corresponding to snake resonances.

3 Polarisation in the model ring at rational [Q2]

We now use our model to study and contrast the equilibrium beam polarisation, the time
averaged beam polarisation and the beam polarisation surviving after acceleration, for the ﬁrst
members of the three classes of rational tunes just listed, namely for [Q2] = 1/3, 1/4 and 1/6.
We are primarily interested in [Q2] at and near 1/6 but the other cases serve to familiarise the
reader with the “normal” cases.

3.1 Oﬀ orbital resonance

To set the scene, and at variance with the title of this section, we ﬁrst consider a case where the
system is oﬀ orbital resonance and oﬀ spin–orbit resonance so that the smooth ISF ˆn is globally
unique. Thus ﬁgure 1 shows the components of ˆn for δ = 0 in the range 0 < [φ2/2π]
1 obtained
≤
by stroboscopic averaging [1, 2, 3, 4] at the irrational tune Q2 = 47+√5
2 = 47.236067977 . . .3.
In this and in all other ﬁgures in this paper, the spins are viewed just before the 0◦ snake.
Furthermore, for all calculations in this paper, the resonance strength, ǫ, is 0.4 and the integer
k0 is 1800, corresponding to a proton energy of about 970 GeV. These are the values used in
[5] and we use them again here to allow comparisons to be made.

−

We remind the reader that ˆn is 2π–periodic in φ2. In principle, the stroboscopic averaging
could have been carried out at each value of [φ2/2π] separately. However, away from orbital
resonances one can cover a torus by simply ﬁnding ˆn at some [φ2/2π], setting a spin parallel to
this ˆn and then recording the spin components while transporting the spin for a large number
of turns. Since Js is invariant along a trajectory we then have the components of ˆn all along the
trajectory. This is the approach adopted for ﬁgure 1 and we see conﬁrmation that ˆn is a single
of ˆn over φ2 is vertical and Plim = 0.47.
valued continuous function of [φ2/2π]. The average
The ADST is 1/2.

ˆn
i

h

Figure 2 shows the beam polarisation, sampled every hundred turns for 106 turns, for an
1 at δ = 0 when the

ensemble of particles distributed uniformly in the range 0 < [φ2/2π]

3Of course, we are aware that in calculations in a digital computer, all irrational numbers must be represented

≤

by rational numbers, but then of very high order.

7

0.5

1

0

-0.5

n

n1
n2
n3

-1

0

%

/
 

2
P

100
80
60
40
20
0
-20
-40
-60
-80
-100

 

 

8

0.25

0.75

1

0.5
2/2π]

[φ

Figure 1: The three components of ˆn(φ2) for the SRM with 2 Siberian Snakes with axes at 0◦ and 90◦ and
for [Q2] = 0.236067977 . . .. Viewing point: just before the 0◦ snake. δ = 0 and ǫ = 0.4.

0

0.2

0.4

0.6

0.8

1

turns /106

Figure 2: For initially vertical spins, the vertical component of the beam polarisation, sampled every 100
turns, at δ = 0 for [Q2] = 0.236067977 . . ..

spins are all initially vertically upward. The horizontal components remain at zero but the
vertical component oscillates, at least for millions of turns, between time independent maxima
and minima with a time average of about 0.3. As expected, this is less than Plim. A constant
polarisation equal to the maximum 0.47 could have been attained by setting the spins initially
parallel to their respective ˆn vectors. See also ﬁgure 9 in [1]. Inspection of the turn–by–turn
data reveals that the oscillations have a period of about four turns, as expected for a [Q2] close
to one quarter and an ADST of 1/2. In the simple SRM and at δ = 0 the analogous simulation
1 as the spins precessed around
would exhibit a beam polarisation oscillating between +1 and
the horizontal ˆn at a rate λ = ǫ.

−

0.5

1

0

-0.5

n

n1
n2
n3

-1

0

0.25

0.75

1

0.5
2/2π]

[φ

Figure 3: The three components of ˆn(φ2) at δ = 10.6 for [Q2] = 0.236067977 . . ..

Figure 3 shows the components of ˆn for the parameters of ﬁgure 1 except with δ = 10.6,
a value corresponding to a beam energy far from that of the parent resonance, with non–even
λ but otherwise arbitrary. The vectors ˆn(φ2) are almost vertical so that Plim is high, namely
0.998. Figure 4 shows the curve for Plim together with the beam polarisations, as ensembles
are accelerated through δ = 0 at the rates of 100 MeV, 500 MeV and 1 GeV per turn (p.t.).
The acceleration is simulated by incrementing δ by four equal amounts, namely just after each
snake and at the mid–points of the two arcs. At the start, δ =
10.6 and the particles are
distributed uniformly in [φ2/2π] with each spin initially set parallel to its corresponding ˆn(φ2),
0.19 for
which is almost vertical. For protons, a rate of 100 MeV per turn corresponds to ∆
the change of aγ0 per turn. For this rate the beam polarisation follows the curve for Plim vs.
δ, dipping to the value 0.47 at δ = 0. Moreover, detailed inspection shows that at each δ the
distribution of spins matches the ISF. This is a nice demonstration of the adiabatic invariance
of Js in this case [9]. The invariance of Js is lost at the higher rates. Slightly diﬀerent curves
are obtained if the spins are set vertically upward at the start.

−

≈

The rate of 100 MeV per turn corresponds to a value ǫ2/α

5.3 in the Froissart–Stora
formula [25] where α = ∆/2π. The Froissart–Stora formula describes the ﬁnal polarisation
when a spin–orbit resonance is crossed in the SRM and for these parameters it would predict
almost full spin ﬂip, corresponding to adiabaticity. However, our model includes the snakes and
there are therefore no ﬁrst order spin–orbit resonances to cross. So the Froissart–Stora formula
does not apply. Nevertheless for our model, the rate of 100 MeV per turn is adiabatic.

≈

 

9

Plim
0.1 GeV p.t.
0.5 GeV p.t.
1.0 GeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 4: With each spin initially parallel to its ˆn, the beam polarisation sampled turn–by–turn, for [Q2] =
10.6 to δ = +10.6 at the rates of 100 MeV, 500 MeV and 1 GeV
0.236067977 . . . during acceleration from δ =
per turn.

−

3.2 On orbital resonance: [Q2] = 1/3

We now consider our ﬁrst case of orbital resonance, namely with Q2 = 47 + 1/3, corresponding
to odd a2 and b2. Figure 5 shows the components of ˆn at δ = 0 and ǫ = 0.4. These components
are obtained by normalising to unity the ~r(3) corresponding to three turns in the range 0 <
1/3, namely 0◦ to 120◦, and then transporting the ˆn for each [φ2/2π] in this range
[φ2/2π]
for two or more turns with the 1–turn spin map, thereby ﬁlling up the full phase range. Note
of ˆn over
that the curves are single valued functions of [φ2/2π] as required. The average
is vertical. While the smooth ISF ˆn of ﬁgure 5 is globally
[φ2/2π] in ﬁgure 5 is 0.05 and

≤

|h

i|

ˆn

ˆn
i

h

 

0
δ

 

n1
n2
n3

2
P

0

1

0.5

-0.5

-1

n

0.5

1

0

-0.5

-1

0

0.25

0.75

1

0.5
2/2π]

[φ

Figure 5: The three components of ˆn(φ2) at δ = 0 for [Q2] = 1/3.

unique, one looses global uniqueness if one allows discontinuities, as demonstrated in ﬁgure 6.
There, we introduce changes of sign in ˆn by hand at the arbitrarily chosen angles of 17.5◦ and
90◦, while constructing ˆn in the range 0◦ to 120◦ using ~r(3). We then transport this ˆn for two or
more turns as before. Naturally, the sign–discontinuities (often simply called “discontinuities”

10

from now on) are transported too. In particular, we see that the transported ˆn is still a single
valued function of [φ2/2π]. The average
in ﬁgure 6 is 0.164. It is clear that neither ˆn
nor
are unique. Of course, an unlimited number of discontinuities could be introduced
in the same way. Then the curves would be smooth almost nowhere. Each of the ˆn obtained
in this way would correspond to a permissible equilibrium spin distribution. The ˆn obtained

|h

|h

i|

i|

ˆn

ˆn

n

0.5

1

0

-0.5

-1

0

0.5

1

0

-0.5

n

n1
n2
n3

-1

0

n1
n2
n3

 

 

11

0.25

0.75

1

0.5
2/2π]

[φ

Figure 6: The three components of ˆn(φ2) at δ = 0 for [Q2] = 1/3. Sign–discontinuities have been introduced
by hand.

by stroboscopic averaging [1] over the whole range 0 < [φ2/2π]
1 can have discontinuities
with positions that depend on the “seed” spin ﬁeld used in the stroboscopic average but these
discontinuities can be removed to give the curves in ﬁgure 5. Since these discontinuities are
sign discontinuities, we do not exclude the possibility that the ISF is locally unique. However,
this issue is beyond the scope of this paper since it would lead us into a discussion of regularity
conditions.

≤

0.25

0.75

1

0.5
2/2π]

[φ

Figure 7: The three components of ˆn(φ2) at δ = 10.6 for [Q2] = 1/3.

If the long term tracking simulation of ﬁgure 2 is repeated but with [Q2] = 1/3, the vertical
component of the beam polarisation oscillates quickly between about -0.3 and +0.8 for at least

|h

i|

106 turns with a time average of about 0.25. This is higher than the

5
signiﬁcance can be attributed to this since

is not unique.

ˆn

·

ˆn

|h

i|

in ﬁgure 5 but no

Figure 7 shows the components of the smooth ISF ˆn for the conditions of ﬁgure 5 but with
is high as expected, namely 0.997 since ~r(3) is close to vertical. The existence
δ = 10.6.
of the ˆn of ﬁgure 7, means that an ensemble of exactly vertical spins is close to a permissible
equilibrium spin distribution.

|h

i|

ˆn

Figure 8 shows the beam polarisation for acceleration through δ = 0 from δ =

10.6 to
δ = +10.6 at the rates of 50 MeV, 300 MeV and 1 GeV per turn for this Q2. At the start, the
particles are distributed uniformly in [φ2/2π] and the spins are set parallel to the almost vertical
ˆn vectors of the smooth ISF. Up to an acceleration rate of 50 MeV per turn, Js is invariant, with
the beam polarisation dipping down to 0.05 around δ = 0 and returning to a high value at the
end. This is a demonstration that with the chosen smooth ˆn, Js can be adiabatically invariant,
although the proof in [9] does not guarantee this because the system is on orbital resonance.
At the higher acceleration rates, the invariance is lost. By using stroboscopic averaging for
irrational [Q2] near 1/3 one ﬁnds ISFs similar to that in ﬁgure 5.

−

2
P

0

1

0.5

-0.5

-1

−

0.05 GeV p.t.
0.30 GeV p.t.
1.00 GeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 8: With each spin initially parallel to its ˆn, the beam polarisation, sampled turn–by–turn, for [Q2] = 1/3
during acceleration from δ =

10.6 to δ = +10.6 at the rates of 50 MeV, 300 MeV and 1 GeV per turn.

3.3 On orbital resonance: [Q2] = 1/4

For our second case of orbital resonance we choose Q2 = 47 + 1/4, corresponding to an odd a2
and a b2 which is twice an even integer. Figure 9 shows the components of ˆn at δ = 0 and ǫ = 0.4
obtained, in analogy with the previous case, from ~r(4) in the range 0 < [φ2/2π]
1/4 and from
transporting those ˆn for three or more turns. In this case we see “stray” points at multiples of
45◦ corresponding to the phases where the 4–turn map is the identity. For this ﬁgure we have
imposed the constraint that the components are continuous in the range 0◦ to 90◦, apart from
the stray points. If we had not imposed smoothness, the components would have changed sign
at 45◦ and the resulting discontinuities would have been transported to the remainder of the
phase range. So, for these parameters and for [Q2] = 1/4, ˆn can have discontinuities as in the
case of any rational Q2. But in contrast to a case discussed below, these discontinuities can be
suppressed. The ˆn obtained by stroboscopic averaging over the whole range 0 < [φ2/2π]
1
is smooth as in ﬁgure 9. Of course, as in the case of [Q2] = 1/3, we can also introduce an

≤

≤

 

0
δ

12

unlimited number of sign–discontinuities. The curves of ﬁgure 9 give

= 0.43. Note the

ˆn

|h

i|

0.25

0.75

1

0.5
2/2π]

[φ

Figure 9: The three components of ˆn(φ2) at δ = 0 for [Q2] = 1/4.

similarity between ﬁgure 9 and ﬁgure 1. Such similarities are seen with other irrational [Q2]
near 1/4 and indicate a weak dependence of ˆn on such irrational [Q2]. This is consistent with
the prediction in [4, Section 4.8] that in mid–plane symmetric rings the ISF is well behaved
close to the condition ν0 = k0 + 2k2Q2, (k0, k2 ∈
If the long term tracking simulation of ﬁgure 2 is repeated but with [Q2] = 1/4, the vertical
component of the beam polarisation oscillates quickly, initially between about -0.1 and +0.7.
106 turns. The
But these limits gradually change and become 0.1 and 0.4 respectively after 5
time average of about 0.25. This is lower than the
in ﬁgure 9 but no signiﬁcance can be
ˆn
attributed to this since

is not unique.

Z).

|h

i|

ˆn

·

Figure 10 shows the components of ˆn for the conditions of ﬁgure 9 but with δ = 10.6. The
δ

is 0.99. Note that in contrast to the 3–turn map used for [Q2] = 1/3, at large

average
the 4–turn map is close to the identity. Nevertheless, ~r(4) is close to vertical.

|h

i|

ˆn

|

|

|h

i|

 

 

0.5

1

0

-0.5

n

n1
n2
n3

-1

0

0.5

1

0

-0.5

n

n1
n2
n3

-1

0

0.25

0.75

1

0.5
2/2π]

[φ

Figure 10: The three components of ˆn(φ2) at δ = 10.6 for [Q2] = 1/4.

Figure 11 shows the beam polarisation as the simulation of ﬁgure 4 is repeated for [Q2] = 1/4.

13

At the start, the spins are set parallel to the almost vertical ˆn vectors of the smooth ISF.
Up to an acceleration rate of 100 MeV per turn, Js is invariant, with the beam polarisation
dipping down to 0.43 around δ = 0 and returning to a high value at the end. This is again a
demonstration that with the chosen ˆn, Js can be adiabatically invariant although the system is
on orbital resonance. At the higher acceleration rates, the invariance is lost.

0.10 GeV p.t.
0.50 GeV p.t.
1.00 GeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 11: With each spin initially parallel to its ˆn, the beam polarisation, sampled turn–by–turn, for [Q2] =
10.6 to δ = +10.6 at the rates of 100 MeV, 500 MeV and 1 GeV per turn.
1/4 during acceleration from δ =

3.4 On orbital resonance: [Q2] = 1/6

We now come to the ﬁrst of the two cases of primary interest for this study, namely the case
when [Q2] = 1/6, i.e., a case of a snake resonance. Again, the integer part of Q2 is 47 and
ǫ = 0.4. Figure 12 shows the components of ˆn at δ = 0 obtained by transporting for ﬁve or
more turns the ˆn obtained from ~r(6) in the range 0 < [φ2/2π]

1/6.

≤

2
P

0

1

0.5

-0.5

-1

−

n

0.5

1

0

-0.5

-1

0

 

0
δ

 

n1
n2
n3

1/2
2/2π]

[φ

14

1/6

1/3

2/3

5/6

1

Figure 12: The three components of ˆn(φ2) at δ = 0 for [Q2] = 1/6.

We see stray points at phases which are multiples of 30◦ and 90◦ corresponding to the phases
where the 6–turn map is the identity. The vector ~r(6) has sign–discontinuities at these points

but for this ﬁgure we have imposed the constraint that the components of ˆn are continuous in
the range 0◦ to 60◦, apart from the stray points. One sees that ˆn still has discontinuities, namely
at phases which are multiples of 60◦. Thus, in spite of smoothing ˆn in the initial range of 0◦
to 60◦, discontinuities persist. They cannot be removed without creating a vector ﬁeld which
becomes double valued when it is transported turn–by–turn. However, the discontinuities can
be moved. These eﬀects explain the failure of the MILES algorithm for ˆn at snake–resonance
tunes in [21] where the need for discontinuities in this model is nevertheless disputed. It is clear
that the curves in ﬁgs. 7 and 8 in [21] do not represent ˆn [5].
Stroboscopic averaging over the whole range 0 < [φ2/2π]

1 generates the curves of ﬁgure
12 directly i.e., without extra smoothing. The discontinuities of ˆn occur at phases where
the raw stroboscopic average passes through zero. The passage through zero is smooth. So
discontinuities in ˆn do not imply discontinuities in the stroboscopic average.

≤

Our numerical calculations show that ˆn has such discontinuities at snake–resonance tunes

at most values of ǫ and that the minimum number of discontinuities is 2˜b2.

Of course, if ˆn is represented as the locus of points on the unit 2–sphere, one ﬁnds disjoint
over [φ2/2π] in ﬁgure 12 is 0.13. An arbitrary number of extra

ˆn

segments. The average
discontinuities can be introduced by hand.

|h

i|

If the long term tracking simulation of ﬁgure 2 is repeated but with [Q2] = 1/6, the polari-
sation oscillates quickly, but with constant upper and lower limits with a time average of about
106 turns. Thus the time averaged polarisation does not vanish. This is
0.1, at least up to 5
illustrated in ﬁgure 13.

·

%

/
 

2
P

100
80
60
40
20
0
-20
-40
-60
-80
-100

 

15

0

1

4

5

2
3
turns /106

Figure 13: For initially vertical spins, the vertical component of the beam polarisation, sampled every 1000
turns, at δ = 0 for [Q2] = 1/6.

|

|

δ

Figure 14 shows ˆn obtained as for ﬁgure 12 but with δ = 10.6. Except when λ is an even
(and also at small ǫ). The value of ~r(6) is very small
integer this is typical of the ˆn at large
and the 6–turn spin map is close to a rotation of 2π around ˆn. The discontinuities persist
but in contrast to the earlier examples, the vertical component of ˆn is close to zero and the
horizontal components are piece–wise almost independent of [φ2/2π]. The average
is
essentially zero. It would remain close to zero if sign–discontinuities were introduced by hand.
Since the horizontal components of ˆn are piece–wise almost independent of [φ2/2π] but also
diﬀerent, and since the 1–turn spin map is a rotation of about π around an axis close to the
vertical, it essentially changes their signs from turn to turn, causing the discontinuities. Such

ˆn(φ2)

|h

i|

n1
n2
n3

n

0.5

1

0

-0.5

-1

0

1/6

1/3

2/3

5/6

1

1/2
2/2π]

[φ

Figure 14: The three components of ˆn(φ2) at δ = 10.6 for [Q2] = 1/6.

for [Q2] = 1/3 or [Q2] = 1/4 in ﬁgures 7 and 10 because
discontinuities do not occur at large
ˆn is close to vertical. The curves of ﬁgure 14 deform continuously into those of ﬁgure 12 as
δ is reduced to zero. The analogous curves for the other three tunes show the same kind of
behaviour and, of course, that behaviour is a prerequisite for Js is to be invariant in ﬁgures 4,
8 and 11.

δ

|

|

For [Q2] = 1/6 with ǫ = 0.4 and large non–even integer λ, all equilibrium spin distributions
have spins close to the horizontal plane. Thus a spin distribution in which all spins are initially
vertically upward cannot be in equilibrium. This is conﬁrmed in ﬁgure 15 where we repeat
10.6 and [Q2] = 1/6. We
the long term tracking simulation of ﬁgs. 2 and 13 but at δ =
now see that the polarisation falls, but slowly, over many tens of thousands of turns and
subsequently oscillates around zero. Then the time averaged polarisation is close to
i| ≈
0. Nevertheless, since the system is on orbital resonance, the theorem [3, 4] on the maximum
time averaged polarisation does not enforce this. Although the initial spin distribution is not

ˆn(φ2)

−

|h

%

/
 

2
P

100
80
60
40
20
0
-20
-40
-60
-80
-100

0

1

4

5

2
3
turns /106

Figure 15: For initially vertical spins, the vertical component of the beam polarisation, sampled every 1000
turns, at δ =

10.6 for [Q2] = 1/6.

−

 

 

16

 50 keV p.t.
 10 MeV p.t.
500 MeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 16: The beam polarisation for [Q2] = 1/6 during acceleration from δ =
−
rates of 50 KeV, 10 MeV and 500 MeV per turn with the spins initially parallel to ˆn.

10.6 to δ = +10.6 at the

 50 keV p.t.
 10 MeV p.t.
500 MeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 17: With each spin initially parallel to its ˆn,
the rates of 50 KeV, 10 MeV and 500 MeV per turn with [Q2] = 1/6.

Js
h

i

during acceleration from δ =

10.6 to δ = +10.6 at

−

2
P

0.15

0.1

0.05

0

-0.05

-0.1

s

>

 
|

J
|
 

<

1

0.8

0.6

0.4

0.2

0

 

0
δ

 

0
δ

17

50 keV p.t.
10 MeV p.t.
50 MeV p.t.

-10 -8

-6

-4

-2

2

4

6

8

10

Figure 18: For initially vertical spins, the beam polarisation for [Q2] = 1/6 during acceleration from δ =
to δ = +10.6 at the rates of 50 KeV, 10 MeV and 50 MeV per turn.

−

10.6

0

1

4

5

3
2
turns /106

Figure 19: The beam polarisation for [Q2] = 1/6 when δ is frozen at +10.6 after the acceleration cycle of
ﬁgure 18, and the spins are tracked for a further 5

106 turns.

2
P

0

1

0.5

-0.5

-1

%

/
 

2
P

100
80
60
40
20
0
-20
-40
-60
-80
-100

 

0
δ

 

50 keV p.t.
10 MeV p.t.
50 MeV p.t.

·

18

δ

in equilibrium, it is not surprising that it takes about 105 turns before the polarisation reaches
the eigentune, 6ν6, of the 6–turn spin map is almost
zero. This is due to the fact that at large
|
independent of [φ2/2π] and very close to an integer for this case. Since Js is invariant along a
trajectory, we can view the motion of a spin as a precession at a ﬁxed angle cos−1(~S
)
|
around its ˆn. In this case the angles are about 90◦. With eigentunes almost independent of
[φ2/2π] and close to an integer, the projections of spins on the planes perpendicular to their
respective ˆn’s spread out (decoher) only slowly. Then, at the viewing position, the spins return
almost to their original directions after six turns.

ˆn/

~S

·

|

|

|

|

δ

For large

, the 1–turn spin map corresponds to a rotation of about π around an axis close
to the vertical. So, it is again no surprise that the polarisation in ﬁgure 15 takes many turns
(e.g., over 100), ˆn can be taken to be horizontal but the
to reach zero. For even larger
polarisation remains vertical and it takes many millions of turns for it to show signs of falling.
There is no fall if λ is an even integer since then, the 6-turn map is the identity.

δ

|

|

ˆn

Figure 16 shows the beam polarisation for acceleration through δ = 0 at the rates of 50
KeV, 10 MeV and 500 MeV per turn for [Q2] = 1/6. At the start, the particles are uniformly
distributed in [φ/2π] and the spins are set parallel to the almost horizontal ˆn vectors of that ISF
which deforms into the ISF’s of ﬁgures 12 and 14. The initial beam polarisation is essentially
zero. During acceleration at rates up to 50 KeV per turn, the beam polarisation rises to 0.13,
corresponding to the
of ﬁgure 12, and then returns to around zero. A detailed inspection
of the data shows that for a rate of 10 MeV per turn, the spins deviate slightly from their
respective ˆn vectors at large
. However, this eﬀect is not apparent in the average over
[φ2/2π] contained in the beam polarisation. This is again a demonstration that with the chosen
ˆn and the chosen layout of accelerating cavities, Js can be approximately invariant even for
these discontinuous ISF’s and that at the higher acceleration rates, the invariance is lost. The
approximate invariance is conﬁrmed in ﬁgure 17 which shows the corresponding behaviour of the
phase average of Js,
. In ﬁgure 17 we have suppressed data at δ’s where ˆn is indeterminate
because λ is an even integer.

Jsi

|h

i|

δ

h

|

|

Figure 18 shows the beam polarisation as the simulation of ﬁgure 16 is repeated but with the
spins initially vertically upward and for rates of 50 KeV and 10 MeV per turn and for 50 MeV
per turn, where Js is still approximately invariant. For these rates of acceleration the angle
between a spin and its ˆn remains around 90◦. Then the beam polarisation during acceleration
depends just on the geometry of the ISF and on the history of the rate of decoherence of the
projections of the spins on the planes perpendicular to the ˆn’s. These rates depend, in turn,
on the magnitude of 6ν6 and its dependence on [φ2/2π]. We therefore expect that the ﬁnal
polarisation could depend sensitively on the magnitude of the rate of acceleration and on its
time dependence. This is conﬁrmed in ﬁgure 18 which shows that at a rate of 50 KeV per turn,
the polarisation is eﬀectively lost at positive δ but that at the much higher rate of 50 MeV per
turn the ﬁnal polarisation is around -0.4 at the end of the acceleration cycle. By now, the reader
will have realised that the polarisation of -0.4 cannot represent an equilibrium state. This is
conﬁrmed in ﬁgure 19 where, after acceleration up to δ = 10.6, δ is frozen and the ensembles
106 turns. Figure 19 shows that after some large oscillations the
are tracked for a further 5
polarisation gradually decays to zero in a way and on a time scale familiar from ﬁgure 15. It
also shows that although the polarisation can be small at the end of the acceleration (as in
the case of 10 MeV/turn), the spin distribution is by no means isotropic but is such that the
106 turns, the curves of spin
polarisation can return to a large value later. In fact after the 5
vector versus [φ2/2π] are smooth curves for all three acceleration rates4. This suggests that

·

·

4 This vindicates the advice in [7, Section I] on the use of the term “depolarisation”.

19

contrary to conventional expectation, a complete loss of polarisation is not inevitable during
acceleration exactly at a snake resonance with [Q2] = 1/6, at least not within the conﬁnes of
our model. This completes Part I of our investigation.

4 Summary and conclusion

·

δ

In this paper we have presented and contrasted four scenarios for spin motion on and oﬀ orbital
resonance within the conﬁnes of our simple model, and by this means we have developed a
clean, elegant account of the special features of spin motion at a snake resonance.
In all
four cases ~S
ˆn is an invariant at low enough rates of acceleration. For the ﬁrst three cases
([Q2] = 0.236067977 . . . , 1/3, 1/4) the ISF is close to vertical at large
, i.e., far away from
the energy for the parent resonance, and the spin motion is unexceptional. For example, after
acceleration from a large negative δ to a high positive δ, an initially vertical spin is still close
to vertical. These cases serve to emphasise the exceptional form of the ISF when [Q2] = 1/6.
In this case, far away from the parent resonance, the ISF lies close to the horizontal plane.
Then in contrast to the other three cases, an ensemble of particles with a uniform distribution
of [φ2/2π] and with vertically upward spins, cannot be at spin equilibrium. The subsequent
evolution of the beam polarisation depends on the chosen initial δ and is exempliﬁed in ﬁgures
13 and 15. In particular, the polarisation oscillates at a rate depending on the proximity of
the eigentune of the 6–turn spin map to an integer and on the extent of the variation of that
eigentune with [φ2/2π]. Then at the energy of the parent resonance (δ = 0), the polarisation
oscillates quickly and the time averaged polarisation is small but non–zero. At most large
,
|
the time averaged polarisation is zero but the polarisation oscillates slowly and it reaches zero
for the ﬁrst time only after many thousands of turns.

δ

|

|

|

|

|

δ

As soon as one sees that at most large

the ISF for [Q2] = 1/6 lies close to the horizontal
plane, it is no surprise that in this case the time averaged beam polarisation can become small
in the long term. Acceleration adds little to the story, except that within our model, after
10.6, the ﬁnal polarisation depends on
starting with an ensemble of vertical spins at δ =
the rate at which one passes from the spin motion underlying ﬁgure 15 to the spin motion
underlying ﬁgure 13 and then beyond to large positive δ. The key features of spin motion at
[Q2] = 1/6 are encoded in the ISF. We see no necessity to invoke the perturbed spin tune
[14, 15]. Instead, we appeal to the eigentune of the 6–turn spin map, a quantity with physical
signiﬁcance.

−

We emphasise that the main results presented here refer to a very special case, namely for
our model right at [Q2] = 1/6 and with ǫ = 0.4. As pointed out in [5], the ISF is extremely
complicated for values of [Q2] just below and just above 1/6. This is consistent with the
prediction in [4, Section 4.8] that in mid–plane symmetric rings the ISF need not be well
Z). Thus in Part II of this
behaved close to the condition ν0 = k0 + (2k2 + 1)Q2, (k0, k2 ∈
study we extend our calculations to cover such values of [Q2] and to larger values of ǫ. It will
be shown there that although the ISF for [Q2] = 1/6 has the special form described above, this
is an exception and that the loss of polarisation during acceleration near to [Q2] = 1/6 has a
diﬀerent origin. We also comment on the ﬁndings in [10, 23, 24].

The analysis should then be extended to real synchrobetatron motion with misalignments
for a typical optic of a real ring and with the ﬁelds of real snakes. See, for example, [33].
Other snake–resonance tunes should also be covered. We note with interest that according
to simulations for RHIC, the loss of polarisation during acceleration is less severe when the
simulations are carried out with the magnetic ﬁelds of real snakes rather than with point–like

20

snakes [34].

Acknowledgements

We thank K. Heinemann, G. H. Hoﬀstaetter and J.A. Ellison for useful discussions and for
valued collaboration and we thank L. Malysheva for help during the preparation of this paper.

References

(1999).

[1] K. Heinemann and G.H. Hoﬀstaetter, Phys.Rev. E 54(4), 4240 (1996).

[2] G.H. Hoﬀstaetter, M. Vogt and D.P. Barber, Phys. Rev. ST Accel. Beams 11(2), 114001

[3] G.H. Hoﬀstaetter, “High Energy Polarised Proton Beams: a Modern View”, Springer Tract

in Modern Physics, Vol 218, Springer (2006).

[4] M. Vogt, Ph.D. Thesis, University of Hamburg, Germany, DESY-THESIS-2000-054 (2000).

[5] D.P. Barber, R. Jaganathan and M. Vogt, Proc. 15th Int. Spin Physics Symposium,
Brookhaven National Laboratory, Long Island, U.S.A., September 2002. AIP proceedings
675 (2003). Extended version: arXiv physics/0502121 (2005).

[6] G.H. Hoﬀstaetter, M. Vogt, Phys. Rev. E 70, 056501 (2004).

[7] D.P.Barber, J.A. Ellison and K. Heinemann, Phys. Rev. ST Accel. Beams 7, 124002 (2004).

[8] D.P.Barber, J.A. Ellison and K. Heinemann, Phys. Rev. ST Accel. Beams 8, 089002 (2005).

[9] G. H. Hoﬀstaetter, H.S. Dumas and J.A. Ellison, Phys. Rev. ST Accel. Beams 9, 014001

(2006).

[10] K. Yokoya, SSC CDG report SSC-189 (1988).

[11] Ya. S. Derbenev and A. Kondratenko, Soviet Physics Doklady 20, 562 (1976).

[12] Ya. S. Derbenev et al. Particle Accelerators 8, 115 (1978).

[13] S.Y. Lee and S. Tepikian, Phys. Rev. Letts. 56, 1653 (1986).

[14] S.Y. Lee, Proc. 8th Int. Symp. on High Energy Spin Physics, Minneapolis, U.S.A., Septem-

ber 1988, AIP proceedings 187 (1989).

[15] S.Y. Lee, “Spin Dynamics and Snakes in Synchrotrons”, World Scientiﬁc (1997).

[16] A. Luccio, Brookhaven National Laboratory Technical Report BNL-52481, (1995).

21

World Scientiﬁc (2005).

Scientiﬁc (2005).

Russia (1997).

[17] V.Ptitsyn et al., Proc. 16th Int. Spin Physics Symposium, Trieste, Italy, October 2004,

[18] M. Bai et al., Proc. 16th Int. Spin Physics Symposium, Trieste, Italy, October 2004, World

[19] V.I. Ptitsin, Ph.D. thesis (in Russian), Budker Institute of Nuclear Physics, Novosibirsk,

[20] V.I. Ptitsin, Proc. 12th Int. Symp. on High Energy Spin Physics, Amsterdam, Holland,

September 1996, World Scientiﬁc (1997).

[21] S.R. Mane, Nucl. Instr. Meth. A528, 667 (2004).

[22] S.Y. Lee and S.R. Mane, Phys. Rev. ST Accel. Beams 8, 089001 (2005).

[23] J. Buon, Proc. workshop on Polarized Beams at the SSC, Ann Arbor, Michigan, U,S,A,,

1985, AIP proceedings 145 (1986).

[24] V.I. Ptitsin, AGS/AD Technical Note 419, Brookhaven National Laboratory, U.S.A.

(1995).

[25] M. Froissart and R. Stora, Nucl. Instr. Meth. 7, 297 (1960).

[26] K. Yokoya, DESY report 99-006 (1999), arXiv physics/9902068.

[27] J.D. Jackson, “Classical Electrodynamics”, 3rd edition, Wiley (1998).

[28] D.P. Barber, K. Heinemann and G. Ripken, Z. f. Physik C64, 117 (1994).

[29] S.Y. Lee, Phys. Rev. ST Accel. Beams 9, 074001 (2006).

[30] S.R. Mane, Fermilab technical report TM-1515 (1988).

[31] S.R. Mane, Nucl. Instr. Meth. A480, 328 and A485, 277 (2002).

[32] W.R. Hamilton, Proceedings of the Royal Irish Academy 2, 424 (1844).

[33] V.H. Ranjbar et al., Phys. Rev. Lett. 91, 034801 (2003)

[34] M. Xiao and T. Katayama, University of Tokyo Technical Report CNS-REP-51 (2003).

22

