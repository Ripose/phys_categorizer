DESY 03-108

August 2003

The Free Electron Laser Klystron Ampliﬁer
Concept

E.L. Saldin a, E.A. Schneidmiller a, and M.V. Yurkov b

aDeutsches Elektronen-Synchrotron (DESY), Notkestrasse 85, D-22607 Hamburg,
Germany
bJoint Institute for Nuclear Research, Dubna, 141980 Moscow Region, Russia

Abstract

The simplest high gain free electron laser (FEL) ampliﬁer concept is proposed.
A klystron ampliﬁer has the useful property that the various electronic processes
take place in separate portions of the ampliﬁer, rather than overlapping as in FEL
ampliﬁer with an uniform undulator. The klystron consists of two fundamental
parts: succession of 2-3 cascades (modulator), and an output undulator (radiator)
in which the modulated electron beam coherently radiates. Each cascade consists of
uniform undulator and dispersion section. Unlike distributed optical klystrons, we
have a high gain per cascade pass. This has a few consequences. First, klystron gain
does not depend on the bunch compression in the injector linac, i.e. maximum gain
per cascade pass at high peak beam current is the same as at low peak beam current,
without compression. Conventional, short-wavelength FEL ampliﬁer and distributed
optical klystron require electron beam peak current of a few kA. Second, there are
no requirements on the alignment of the cascade undulators and dispersion sections,
because, in our (high gain) case, there is no need for radiation phase matching. There
are applications, like XFELs, where the unique properties of high gain klystron FEL
ampliﬁer are very desirable. Such a scheme allows one to decrease the total length of
the magnetic system. In this paper we discuss also implementation of the proposed
SASE FEL scheme for the frequency multiplier, for femtosecond experiments, and
multi-user soft X-ray facility.

3
0
0
2
 
g
u
A
 
4
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
0
6
0
8
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Preprint submitted to

1 Introduction

High gain FEL ampliﬁers are of interest for a variety of potential applications
that range from X-ray lasers [1,2] to ultraviolet MW-scale industrial lasers
[3]. There are various versions of the high gain FEL ampliﬁer. A number of
high gain FEL ampliﬁer concepts may prove useful for XFEL applications.
Two especially noteworthy ones are the FEL ampliﬁer with a single uniform
undulator [1,2] (see Fig. 1) and the distributed optical klystron [4–7] (see
Fig. 2). The high gain cascade klystron ampliﬁer described in this paper is
an attractive alternative to other conﬁgurations for operation in the X-ray
wavelength range (see Fig. 3).

Let us ﬁrst investigate qualitatively the processes that take place in any FEL
ampliﬁer; this investigation should also enable us to distinguish somewhat
more accurately between the so-called distributed optical klystron concept and
the new high gain klystron ampliﬁer concept. In any FEL, several processes
must take place, either separately or simultaneously. The ﬁrst process that
must occur in any FEL is energy modulation. Energy modulation means the
application of radiation ﬁelds to the electrons as they move in their trajectories
under the action of undulator magnetic ﬁelds, in such a way that the energies
of these electrons are varied in some periodic fashion. It is then necessary to
take advantage of this phase-dependent motion.

The second process, then, that must occure in a FEL is the conversion of
this variation in the motion of the electrons into a usable form. It is neces-
sary to turn the variations in the electron energy into a radiation frequency
current, which can deliver energy to the electromagnetic ﬁeld; i.e., the varia-
tions in velocity must be converted into density variations. The ways in which
this conversion is brought about are numerous, and FEL ampliﬁer types are
distinguished by their conversion mechanism.

It may be useful to illustrate processes at this point to see how energy modu-
lation and conversion into density modulation take place in some of the types
of FEL ampliﬁer. In a conventional high gain FEL ampliﬁer with a single uni-
form undulator energy modulation and bunching occurs both simultaneously
and continuously along the undulator. Energy modulation occurring at any
one point continues to aﬀect bunching at points beyond, with additional mod-
ulation being added as the beam moves along. The problem of electromagnetic
wave ampliﬁcation in the uniform undulator refers to a class of self-consistent
problem. To solve the problem, the ﬁeld equations and equations of particle
motion should be solved simultaneously. When the FEL ampliﬁer operates in
linear regime the transverse distribution of the radiation ﬁeld remains ﬁxed,
while its amplitude grows exponentially with undulator length.

2

Fig. 1. Schematic diagram of conventional SASE FEL

Fig. 2. Schematic diagram of distributed optical klystron

Perhaps the simplest FEL ampliﬁer, from pedagogical point of view, is the high
gain klystron ampliﬁer. This simplicity arises from the fact that the important
processes of energy modulation of the beam and subsequent conversion of the
energy modulation to density modulation occur in distinctly separate regions
of the FEL and thus may be considered in a sequential manner. This separabil-
ity of functions aids materially in developing an understanding of modulation
and bunching phenomena.

In its simplest conﬁguration the klystron ampliﬁer consists of an input un-
dulator (energy modulator), and an output undulator (radiator) separated
by a dispersion section. In the input undulator an incident electron beam is
subjected to a radiation ﬁeld, which produces an energy modulation, a modu-
lation which after dispersion section, is converted into an density modulation
in the beam. In the output undulator the bunched beam radiates coherently.
This process, of conversion of energy modulation to bunching by the action of

3

Fig. 3. Schematic diagram of high gain cascade klystron ampliﬁer

a dispersion section, is one of the characteristics of the klystron and is one of
the reasons why this device is so useful in many connections.

We have considered the two-undulator klystron ampliﬁer. In some experimen-
tal situations this simplest conﬁguration is not optimal. For example, this
study has shown that in the soft X-ray wavelength range the maximal (in-
tensity) gain of this ampliﬁer does not exceed 30-40 dB. The obvious and
technically possible solution of the problem of gain increase might be to use a
klystron with three or more undulators. Suppose that we have a three undu-
lator (or so-called two-cascade) klystron, and that we introduce a very small
signal into the ﬁrst undulator. This will result in a small value of the ampli-
tude of energy modulation, and a resulting rather small power output from
the second undulator. Nevertheless, the radiation ﬁeld amplitude in the second
undulator will still be much greater than that in the ﬁrst undulator, on ac-
count of the considerable ampliﬁcation of the ﬁrst cascade. We now disregard
the power produced by the second undulator, but consider its eﬀect on the
electron beam passing through its magnetic system. The considerable radia-
tion ﬁeld in the second undulator will produce a further energy modulation of
the beam and, when it emerges on the far side of the second undulator, it will
have a large energy modulation, which, with a second dispersion section, will
result in optimum bunching. This bunched beam then enters the third (radia-
tor) undulator, and produces a large amount of power. In other words, we have
essentially combined two stages of ampliﬁcation by incorporating essentially
two klystrons in a single unit. The ﬁnal power is no greater than could be
produced by a two-undulator klystron with the same output undulator, but
we can secure this power with a much weaker input signal.

Let us consider now the problem of a periodically spaced sequence of undu-
lators and dispersion sections, with the electron beam traversing each in suc-
cession. The larger the number of cascades the longer is the ampliﬁer length.

4

Suppose that the increase of total length (gain) of ampliﬁer is tempered by an
accompanying decrease in the length (gain) of cascade. From this approach at
very large number of cascades and small gain per cascade pass we are led to
the other device, which was the subject of the papers [4–7]: the ”distributed
optical klystron”. At ﬁrst glance this is essentially the extension klystron am-
pliﬁer, extended to a very large number of cascades. However, as noted earlier,
this ampliﬁer is considerably more complicated in principle than a klystron
ampliﬁer with high gain per cascade pass. When the gain per cascade pass
is small, the cascades cannot be considered independent. It is important to
realize that the cascades are connected optically, so that the radiation pro-
duced, for example, into the ﬁrst undulator passes on into the second and
produces additional energy modulation of the beam. It is clear that we cannot
conveniently treat the theory of distributed klystron by the same method we
used in the klystron case. Because of the low gain per cascade pass used for
the distributed klystron, it cannot be approximated as scheme with separate
functions, and the klystron ampliﬁer theory has all based on that assumption.
A quite diﬀerent approach to the problem, which proves to be more suited
to mathematical development of distributed klystron theory, is more along
the lines of an analogy with the theory of conventional FEL ampliﬁer with
uniform undulator. The problem of electromagnetic wave ampliﬁcation in the
distributed klystron refers to a class of self-consistent problems. For instance,
when the distributed klystron operates in linear regime its amplitude gain
grows exponentially with cascade numbers. From a study of the rate of ex-
ponential build-up of the electromagnetic wave we can ﬁnd the gain of the
ampliﬁer.

Our theory of klystron ampliﬁer is based on the assumption that beam density
modulation does not appreciably change as the beam propagates through the
undulator. This approximation means that only the contributions to the radi-
ation ﬁeld arising from the initial density modulation are taken into account,
and not those from the induced bunching. At very long klystron undulators we
are led to device, which is the subject of the papers [8,9]. Two-segment high
gain FEL ampliﬁer is variant of the standard high-gain FEL ampliﬁer with
uniform undulator. Because of the high gain per undulator pass used for this
modiﬁcation, it cannot be approximated as scheme with separate functions.

The klystron ampliﬁer analysis is not only relevant from a pedagogical point
of view. There are reasons to expect that the new concept of FEL ampliﬁer
discussed here can be of interest for short wavelength applications such as X-
ray SASE FELs. Generation of X-ray radiation using klystron ampliﬁers has
many advantages, primarily because of the separation of electronic processes,
gain, and potentially low sensitivity to alignment. In principle, the gain of the
klystron ampliﬁer can be increased indeﬁnitely by adding additional cascades
along the beam. In practice, with three-cascade klystron ampliﬁer, a gain in
excess of 80 dB may be obtained in the soft X-ray wavelength range. At this

5

level, the shot noise of the beam is ampliﬁed up to saturation and a cascade
klystron ampliﬁer operates as soft X-ray SASE FEL.

Now our intention is to develop certain physical ideas about the operation of
the klystron ampliﬁer, the characteristics of its radiation, and those features
that set it apart from other FEL sources in the short wavelength region of
the spectrum. The resonance properties of the radiation of the electron beam
in the klystron can be understood as follows. Since a dispersion section is
a nonresonant device, the klystron bandwidth is restricted by the resonance
properties of the cascade undulator, that is, by its number of periods Nw.
The typical ampliﬁcation bandwidth of the klystron in the soft X-ray wave-
102). Since we study the
length range is on the order of one percent (Nw ≃
start-up from shot noise, we assume the input current to have a homogeneous
spectral distribution. At large number of undulator periods the spectrum of
transversely coherent fraction of radiation is concentrated within the narrow
band, ∆λ/λ

N −1
w .

≃

The actual physical picture of start-up from noise should take into account
that the ﬂuctuations of current density in the electron beam are uncorrelated
not only in time but in space too. Thus a large number of transverse radia-
tion modes are excited when the electron beam enters the undulator. These
radiation modes have diﬀerent gain. Obviously, as cascade number progresses,
the high gain modes will predominate more and more and we can regard
the klystron as a ﬁlter, in the sense that it ﬁlters from arbitrary radiation
ﬁeld those components corresponding to the high gain modes. If we consider
the undulator radiation from the point of view of paraxial optics, then we
immediately see that the high gain modes are associated with radiation prop-
agating along the axis of the undulator, as opposed to radiation propagating
at an angle to the axis which has a low gain. Consider an electron beam of
radius rb moving in the (cascade) undulator with length Lw. The parame-
ter NF = r2
b/(λLw) can be referred to as the Fresnel number. Here λ is the
radiation wavelength. The requirement for the mode selection to be quickly
holds at small value of the Fresnel number. Hence, for thin electron beam with
Fresnel number of NF ≃
1, the emission will emerge in a single (fundamental)
transverse mode and the degree of transverse coherence of output radiation
will approach unity.

As mentioned above, ampliﬁcation in each cascade is a two-step process. Since
we study the start-up from shot noise there is no electromagnetic ﬁeld at the
undulator entrance and the modulation of the beam density serves as the input
signal for the klystron ampliﬁer. The radiation ﬁeld produced an ponderomo-
tive potential across the undulator; as is now known from general FEL theory,
this voltage modulates the energy of the electron beam. Then the energy mod-
ulation causes modulation of the beam density in the dispersion section. If we
can neglect beam bunching in the cascade undulator, the amplitude of en-

6

E

E

≃

R56I0.

ergy modulation at the undulator exit, δ
, is proportional to the resonance
Fourier component of beam current, δIin = ainI0. Here ain is the initial beam
microbunching at the resonant wavelength, and I0 is the peak beam current.
We now examine the behaviour of the electrons as they travel in a dispersion
section. Like the situation with usual microwave klystron, the Bessel function
factor J1(X) represents the microbunching at the dispersion section exit. The
parameter X in our case is proportional to the product of the amplitude of
energy modulation δ
and the compaction factor of the dispersion section
R56. In the high gain linear regime X is much smaller then unity and we make
X/2. Thus, microbunching at the cascade exit is
the approximation J1(X)
R56I0ain. When a cascade op-
proportional to input signal amplitude, aout ∼
erates in the high gain linear regime the gain per cascade pass is independent
of input signal amplitude and proportional to the product of the compaction
factor and the peak beam current, G = aout/ain ∼
If we build a klystron, we want to have small number of cascades and high
gain. One might think that all we have to do is to get enough gain per cascade
pass - we can always increase compaction factor R56 and we can always in-
crease G, and there is no reason why we cannot use the simple two-undulator
klystron scheme. So the limitations of a gain per cascade pass are not that it
is impossible to build a dispersion section that has a very large compaction
factor. In fact, one of the main problems in klystron ampliﬁer operation is
preventing spread of microbunching due to energy spread into the electron
beam. This energy spread is unimportant when the compaction factor of dis-
persion section is relatively small, but we shell see that energy spread is of
fundamental importance in the case of very large compaction factor. To get
a rough idea of the spread of the microbunching, the position of the par-
ticles within the electron bunch at the dispersion section exit has a spread
R56∆γ/γ, where ∆γ/γ is the local energy spread into
which is equal to ∆z
the electron beam. And how big is ∆z in the spread-out microbunching? We
know that uncertainty in the phase of the particles is about ∆ψ
2π∆z/λ.
Therefore, the largest compaction factor that we can have is approximately
λγ/(2π∆γ). This is what we wanted to deduce - that the gain maximum
R56 ≃
I0/∆γ. It is of course desirable that
per cascade pass varies as ratio Gmax ∼
the klystron gain be maximum. An experimenter can easily tune the gain of
the klystron by tuning the magnetic ﬁelds in the dispersion sections. It should
be pointed out that the local energy spread plays a very important role in the
operation of the FEL klystron ampliﬁer, and this characteristic distinguishes
the klystron from conventional FEL ampliﬁer.

≃

≃

Electron bunches with very small transverse emittance and high peak current
are needed for the operation of conventional XFELs. This is achieved using
a two-step strategy: ﬁrst generate beams with small transverse emittance us-
ing an RF photocathode and, second, apply longitudinal compression at high
energy using a magnetic chicane. Although simple in ﬁrst-order theory, the

7

physics of bunch compression becomes very challenging if collective eﬀects
like space charge forces and coherent synchrotron radiation forces (CSR) are
taken into account. Wakeﬁelds of bunches as short as 0.1 mm have never been
measured and are challenging to predict.

The situation is quite diﬀerent for klystron ampliﬁer scheme described in our
paper. An distinguishing feature of the klystron ampliﬁer is the absence of ap-
parent limitations which would prevent operation without bunch compression
in the injector linac. According to our discussion above, the gain maximum
per cascade pass is proportional to the peak current and inversely proportional
to the energy spread of the beam. Since the bunch length and energy spread
are related to each other through Liouville’s theorem, the peak current and
energy spread cannot vary independently of each other in the injector linac.
To extent that local energy spead is proportional to the peak current, which
is usually the case for bunch compression, the gain will be independent of
the actual peak current. We see, therefore, that klystron gain in linear regime
depends only on the actual photoinjector parameters. This incipient propor-
tionality between gain and I0/∆γ is a temptation, in designing an XFEL, to
go to very high values of I0/∆γ and very long values of bunch length.

Let us present a speciﬁc numerical example for the case of a 4th generation
soft X-ray light source based on the use RF photoinjector and superconducting
linac with duty factor 1 %. The average brilliance of a klystron facility operat-
ing without bunch compression in the injector linac surpasses the spontaneous
undulator radiation from 3rd generation synchrotron radiation facilities by 4
or more orders of magnitude. Decreasing the peak current also decreases the
peak brilliance of the SASE FEL radiation by about of factor 100, but this
is still 6 order of magnitude higher than that of 3rd generation synchrotron
radiation sources.

Our studies have shown that the soft X-ray cascade klystron holds great
promise as a source of radiation for generating high power single femtosec-
ond pulses. The obvious temporal limitation of the visible pump/X-ray probe
technique is the duration of the X-ray probe. At a klystron facility operating
without bunch compression, the X-ray pulse duration is about 10 ps. This is
longer than the timescale of many interesting physical phenomena. The new
principle of pump-probe techniques described in section 6 oﬀers a way around
this diﬃculty. Section 6 also deals with the design strategy for the multi-user
distribution system for an X-ray laboratory. An X-ray laboratory should serve
several, may be up to ten experimental stations which can be operated inde-
pendently according to the needs of the user community. On the other hand,
the prefered layout of a conventional SASE FEL is a linear arrangement in
which the injector , accelerator, bunch compressors and undulators are nearly
collinear, and in which the electron beam does not change direction between
accelerator and undulators. The situation is quite diﬀerent for the klystron

8

ampliﬁer scheme proposed in our paper. Since it operates without bunch com-
pression in the injector linac, the problem of emittance dilution in the bending
magnets does not exist. An electron beam distribution system based on un-
bunched electron beam can provide eﬃcient ways to generate a multi-user
facility - very similar to present day synchrotron radiation facilities.

It may be wondered, after hearing of all of the wonderful properties of the
high gain klystron ampliﬁer, why this advance in XFEL techniques occurred
only this year. It should be note that the XFEL which was proposed in 1982
[10] has had nearly 20 years of development. One of the explanations is as
follows. For years we were led to believe that local energy spread into electron
beam which delivered from a photoinjector is relatively large. Recent analysis
of experimental results obtained at TTF SASE FEL [11] shows that the value
of the local energy spread should be revised. After bunch compression, it is ex-
2.5 kA) or smaller which is signiﬁcantly
pected to be about 0.2 MeV (for I0 ≃
less than the previously projected value of 1 MeV. This decrease signiﬁcantly
improves operation of klystron ampliﬁer and extends the safety margin for
X-ray klystron facility operation.

This paper is intended primarily for the experimental scientist or XFEL pro-
gram manager who has to design XFELs and who wishes to undestand the
operating principles of XFELs. The material to be discussed provides the nec-
essary background information required for making strategic XFEL design
decisions. In this paper the electronic processes that occur in an XFEL will
be discussed in elementary fashion. The XFEL theory has a, not entirely un-
deserved, reputation for diﬃculty and obscurity. This is due partly to the
complexity of systems in which (shot) noise is input signal and partly to the
unfamiliar nature of some of the mathematical tools involved (integrodiﬀeren-
tial equations). Klystron ampliﬁers are one of the simplest examples of high
gain FEL ampliﬁers and therefore we shall use them as an introduction to
the techniques of XFEL theory. In the klystron ampliﬁer case little demand
is made on the reader’s mathematical ability. The mathematics that is in-
volved is particularly simple, involving very simple diﬀerential equations and
algebraic operations and no integrodiﬀerential equations. Such introduction to
the operating principles of XFELs has never been done before, to our knowl-
edge.

2 Interaction between electrons and ﬁelds in an undulator

Klystron ampliﬁers amplify the input signal. To describe the klystron ampliﬁer
operation, we ﬁrst deﬁne the initial conditions. Important practical kind of
initial condition refers to the case when there is no radiation ﬁeld at the
undulator entrance and the modulation of the beam current density serves as

9

the input signal for the ampliﬁer. As stated in the introductory section, in
undulator two physical processes take place simultaneously:

1) The modulated electron beam excites electromagnetic waves which are
propagated along the undulator;

2) The electric ﬁeld components of these waves produce a modulation of the
energy of the electrons.

The approach discussed in this section consists of deriving for these two process
separate expressions which, when joined, give quantitative information about
the composite phenomena taking place in the undulator. We assume that the
density modulation eﬀect is negligible. Hence, electrons passing through the
ﬁrst undulator receive only energy modulation, but no density modulation.
Density modulation present when the electrons enter the second undulator,
must have developed while the electrons were traveling in the dispersion sec-
tion. This eﬀect will be discussed later.

2.1 Collective ﬁelds produced by the modulated electron beam in an undulator

−

The simplest form of bunched beam is found if we have swarm of electrons,
all moving in the same direction (say the z-direction) with the same velocity
(say v), but in which the number of electrons per unit volume (say n) depends
e) we can easily ﬁnd the current
on z. Then if the charge on the electron (
density at any value of z. The quantity n must really be a function of z/v
t,
on account of the velocity v of the electrons. Thus, the current density at point
t) indicates the function n of
z, at time t, is
−
the argument z/v
t. Unless n is a constant independent of its argument, this
will lead to a current density which varies with time. The simplest variation of
n for our present purposes is a superposition of a constant, or d-c component,
t, with an angular frequency ω. First we
and a periodic function of z/v
consider the case where n is simply a constant plus a single cosine term:
n(z/v
t)]. We must note one important fact: n
−
can never become negative, and hence ain cannot be greater than unity.

t) = n0[1 + ain cos ω(z/v

t), where n(z/v

evzn(z/v

−

−

−

−

−

−

To understand the basic principles of klystron ampliﬁer operation, let us con-
sider the helical undulator. The magnetic ﬁeld on the axis of the helical un-
dulator is given by

~Hw = ~exHw cos(kwz)

~eyHw sin(kwz) ,

−

where kw = 2π/λw is the undulator wavenumber and ~ex,y are unit vectors
directed along the x and y axes of the Cartesian coordinate system (x, y, z).

10

~Hw)/c is used to derive the equations of motion
The Lorentz force ~F =
×
e) and mass me in the presence of the magnetic
of electrons with charge (
ﬁeld. The explicit expression for the electron velocity in the ﬁeld of the helical
undulator has the form:

e(~v

−

−

~v⊥(z) = cθw [~ex cos(kwz)

~ey sin(kwz)] ,

−

c.

x + v2

y + v2

which means that the electron in the undulator moves along a constrained
helical trajectory parallel to the z axis. The angle of rotation is given by the
v2/c2)−1/2 is the
relation θw = K/γ = λweHw/(2πmec2γ), where γ = (1
−
relativistic factor and v2 = v2
z . As a rule, the electron rotation angle
θw is small and the longitudinal electron velocity vz is close to the velocity of
light, vz ≃
Let us consider a bunched relativistic electron beam moving along the z axis
in the ﬁeld of a helical undulator. In what follows we use the following as-
sumptions: i) the electrons move along constrained helical trajectories in par-
allel with the z axis; ii) the radius of the electron rotation in the undulator,
rw = θw/kw, is much less than the transverse size of the electron beam. Next
let us assume that electron beam density at the undulator entrance is simply
t)], where ain = const. In other words we con-
n = n0(~r⊥)[1 + ain cos ω(z/vz −
sider the case in which there are no variations in amplitude and phase of the
density modulation in the transverse plane.

Under these assumptions the transverse current density may be written in the
form

~j⊥ =

e~v⊥(z)n(~r⊥, z/vz −
−

t) =

e~v⊥n0(~r⊥)[1 + ain cos ω(z/vz −
−

t)] ,

where we calibrated the time in such a way that current density has its max-
imum at time t = 0, at point z = 0. Even through the measured quantities
are real, it is generally more convenient to use complex representation. For
this reason, starting with real ~j⊥, one deﬁnes the complex transverse current
density:

jx + i jy =

ecθwn0(~r⊥) exp(

−

i kwz)[1 + ain cos ω(z/vz −

−

t)] .

(1)

−

ωt) will add to give a total current proportional to exp(

Transverse current have the angular frequency ω and two waves traveling in
the same directions with variations exp i(ωz/vz −
i(ωz/vz +
i kwz) cos ω(z/vz−
kwz
ωt) indicates a fast wave, while the factor
t). The factor exp i(ωz/vz −
ωt) indicates a slow wave. The use of the word ”fast”
i(ωz/vz + kwz
exp
(”slow”) here implies a wave with a phase velocity faster (slower) than the
beam velocity.

ωt) and exp

kwz

kwz

−

−

−

−

−

−

11

Now we should consider the electrodynamic problem. Using Maxwell’s equa-
tions, we can write the equation for the electric ﬁeld:

c2 ~

∇ ×

(~
∇ ×

~E) =

∂2 ~E/∂t2

4π∂~j/∂t .

−

−

Then make use of the identity

~
∇ ×

(~
∇ ×

~E) = ~
∇

(~
∇ ·

~E)

~
∇

−

2 ~E ,

where ~
inhomogeneous wave equation for ~E:

∇ ·

~E can be found from the Poisson equation. Finally, we come to the

2 ~E

c2 ~
∇

∂2 ~E/∂t2 = 4πc2 ~
∇

−

ρ + 4π∂~j/∂t .

(2)

This equation allows one to calculate the electric ﬁeld ~E(~r, t) for given charge
and current sources, ρ(~r, t) and ~j(~r, t). Thus, equation (2) is the complete and
correct formula for radiation. However we want to apply it to a still simpler
circumstance in which the second term (or, the current term) in the right-hand
side of (2) provides the main contribution to the value of the radiation ﬁeld.
Since in the paraxial approximation the radiation ﬁeld has only transverse
components, we are interested in the transverse component of (2). Thus we
consider the wave equation
2 ~E⊥ −

∂2 ~E⊥/∂t2 = 4π∂~j⊥/∂t ,

c2 ~
∇

(3)

which relates the transverse component of the electric ﬁeld to the transverse
component of current density.

We wish to examine the case when the phase velocity of the current wave is
close to the velocity of light. This requirement may be met under resonance
condition

ω/c = ω/vz −

kw .

(4)

First we may point out that the statement of (4), the condition for the relation
between ω, kw and vz, is the condition for synchronism between the transverse
electromagnetic wave and the fast transverse current wave with the propagat-
kw. With a current wave traveling with the same phase
ing constant ω/vz −
speed as the electromagnetic wave, we have the possibility of (space) resonance
between electromagnetic wave and electrons. If this is the case cumulative in-
teraction between bunched electron beam and transverse electromagnetic wave
takes place. We are therefore justiﬁed in considering the contributions of all
the waves except the synchronous one to be negligible.

12

−

−

It would be nice to ﬁnd an explanation of resonance condition (4) which is
elementary in the sense that we can see what is happening physically. Let
us call the plane electromagnetic wave velocity c, which is of course, related
to the phase constant by k = ω/c. Then the velocity of the beam relative
to the electromagnetic wave is merely c
vz. With this relative velocity, the
frequency of the electromagnetic waves as seen by the electrons is give by
ωe = (c
vz)k, where we have used the obvious relation between the phase
constant k and the wavelength of the electromagnetic wave, k = 2π/λ. Re-
lation for ωe can be written as ωe = ω
kvz. Under the condition when (4)
holds, we see by comparison with that equation that this would be merely
the undulator frequency ωe = kwvz. Accordingly, the condition of (4) that we
have imposed is merely that the electron velocity is such that as the electron
run past the electromagnetic waves, the apparent frequency they see is the
undulator frequency. This is the basic eﬀect involved in this interaction. If
the apparent frequency is the undulator frequency, a cumulative eﬀect on the
electromagnetic wave results, since the waves are being driven at a frequency
corresponding to natural rotation frequency of the electrons in the magnetic
ﬁeld. Another way of saying the same thing is that in the frame of reference
moving with the electrons, the electromagnetic waves have a Doppler-shifted
frequency equal to undulator frequency.

−

Any state of transverse electromagnetic wave can always be written as a linear
combination of the two base states (polarizations). By giving the amplitudes
and phases of these base states we completely describe the electromagnetic
wave state. It is usually best to start with the form which is physically clearest.
We choose the Cartesian base states and seek the solution for ~E⊥ in the form

Ex,y = ˜Ex,y(z, ~r⊥) exp[i ω(z/c

t)] + C.C.

−

(5)

Here and in what follows, complex amplitudes related to the ﬁeld are written
with a tilde. The description of the ﬁeld given by (5) is quite general. However,
the usefulness of the concept of carrier wave number is limited to the case
where the amplitude is slowly varying function of z.

To determine the form of ˜Ex,y(z, ~r⊥) we substitute (1) and (5) into (3). We
have

2
⊥ +

2 i ω
c

∂
∂z

+

∂2
∂z2 )  

˜Ex
˜Ey!

+ C.C.

t)]

~
−
∇
(
cos(kwz)

exp[i ω(z/c

=

4π

−

ω
c  

−

sin(kw)!

eθwainn0(~r⊥) sin ω(z/vz −

t) .

(6)

Here ~
∇

2
⊥ is the Laplace operator in transverse coordinates.

13

Now we have an apparently simple pair of equations - and they are still exact,
of course. The question is, how to solve these equations? First we simplify
the equations obtained by noting that for a radiation ﬁeld it is reasonable
to assume that ˜Ex,y(z, ~r⊥) are slowly varying functions of z (because of the
radiation directivity) so that ∂2 ˜Ex,y/∂z2 may be neglected. The correspond-
ing requirement for the complex amplitude is
. In
other words, the radiation pulse must not change signiﬁcantly while traveling
through a distance comparable with the wavelength λ = 2π/k. This assump-
tion is not a restriction. Such is the case in all practical cases of interest.
Diﬀerential equations becomes

∂ ˜Ex,y/∂z

˜Ex,y |

|≪

k

|

|

2
⊥ +

~
∇

2 i ω
c

∂
∂z )  

˜Ex
˜Ey!

+ C.C.

exp[i ω(z/c

t)]

−
(
cos(kwz)

sin(kw)!

ω
c  

−

= 4π

eθwainn0(~r⊥) sin ω(t

z/vz) .

(7)

−

The reader may well wonder why such a transformation is useful; therefore we
digress temporarily to address this question.

Such a transformation immediately modiﬁes the hyperbolic wave equations to
the parabolic equations. We should stress that the equations (7) are preferable
for an analytical solution, since the mathematical techniques are always con-
nected with more conventional parabolic equations. Although equations (7)
cannot be solved in general, we will solve them for some special cases. These
equations can be simpliﬁed further by noting that the complex amplitudes
˜Ex,y will not vary much with z, especially in comparison with the exponential
i kwz). The slow wave of transverse current oscillates very rapidly
terms exp(
about an average value of zero and, therefore, does not contribute very much
to the rate of change of ˜Ex,y. So we can make a reasonably good approximation
by replacing these terms by their average value, namely, zero. We will leave
them out, and take as our approximation:

−

2
⊥

~
∇

 

˜Ex
˜Ey!

+

2 i ω
c

∂
∂z  

˜Ex
˜Ey!

=

i
1!

− 

ω
c

2π

eθwainn0(~r⊥) exp(

i Cz) .

(8)

−

kw
Even the remaining terms, with exponents proportional to C = ω/vz−
will also vary rapidly unless C is near zero. Only then will the right-hand side
vary slowly enough that any appreciable amount will accumulate when we
integrate the equations with respect to z. The required conditions will be met
if

ω/c

−

C

kw

≪

1

≪

kwz .

14

In other words, we use the resonance approximation here and assume that
complex amplitudes ˜Ex,y are slowly varying in the longitudinal coordinate. By
∂ ˜Ex,y/∂z
”slowly varying” we mean that
. For this inequality
to be satistied, the spatial variation of ˜Ex,y within an undulator period λw =
2π/kw has to be small.

˜Ex,y |

kw |

|≪

|

Equations (8) are simple enough and can be solved in any number of ways.
One convenient way is the following. Taking the sum and the diﬀerence of the
two we get

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

˜Ex + i ˜Ey

= 2π i

eθwainn0(~r⊥) exp(

i Cz) ,

(9)

−

ω
c

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

˜Ex −

i ˜Ey

= 0 .

(cid:16)

(cid:16)

(cid:17)

(cid:17)

(10)

These equations describe the general case of electromagnetic wave radiation
by the bunched electron beam in the helical undulator. Equation (9) and (10)
refer to the right- and left-helicity components of the wave respectively. The
solutions for the right- and left-helicity waves are linearly independent 1 . It
follows from (9) and (10) that only those waves are radiated that have the
same helicity as the undulator ﬁeld itself.

Of course we could predict such a result. The electric ﬁeld, ~E⊥, of the wave
radiated in the helical undulator in resonance approximation is circularly po-
larized and may be represent in the complex form:

Ex + i Ey = ˜E(z, ~r⊥) exp[i ω(z/c

t)] .

−

(11)

Finally, the equation for ˜E can be written in the form

2
⊥ +

~
∇

 

2 i ω
c

∂
∂z !

ω
c

˜E = 2π i

eθwainn0(~r⊥) exp(

i Cz) .

(12)

−

Equation (12) is an inhomogeneous parabolic equation. Its solution can be
expressed in terms of a convolution of the free-space Green’s function (impulse

1 In the general case these components are not independent, but are connected by
the boundary conditions on the vacuum chamber walls. It is usually assumed that
the vacuum chamber walls are placed far enough from the electron beam, formally
at inﬁnity. Such an approximation well describes FEL ampliﬁers operating in the
visible down to X-ray wavelength range. To describe FEL ampliﬁer operating in
the far-infrared wavelength range one should take into account the inﬂuence of the
walls on the ampliﬁcation process

15

response)

G(z

z′, ~r⊥ −

−

~r′
⊥) =

1
4π(z

exp

"

z′)

−

i ω

|
2c(z

~r⊥ −
−

2

~r′
⊥ |
z′)

#

(13)

with the source term. When the right-hand side of (12) is equal to zero, it
transforms to the well-known paraxial wave equation in optics.

The radiation process displays resonance behaviour and the amplitude of elec-
tric ﬁeld depends stronly on the value of the detuning parameter C. With the
approximation made in getting (12) the equation can be solved exactly, but
the work is a little elaborate, so we won’t do that until later when we take
up the problem of output radiation characteristics. Now we will ﬁnd an exact
solution for the case of perfect resonance. When the parameters are tuned to
perfect resonance, such that C = 0, the solution of the equation (12) has the
form

˜E(z, ~r⊥) =

i eθwωain
2c

z

Z0

d z′
z′

−

z

Z

d ~r′

⊥n0(~r′

⊥) exp

i ω

|
2c(z

~r⊥ −
−

"

2

~r′
⊥ |
z′)

#

,

(14)

where (z, ~r⊥) and (z′, ~r′
point, respectively.

⊥) are the coordinates of the observation and the source

Let us consider an axisymmetric electron beam with gradient proﬁle of the
j0S(r), where r is the
current density. In this case we have
−
radial coordinate of the cylindrical system (r, φ, z) and S(r) describes the
transverse proﬁle of the electron beam. To be speciﬁc, we write down all the
expressions for the case of a Gaussian transverse distribution:

evzn0(~r⊥) =

−

evzn0(~r⊥) =

j0S(r) =

−

−

I0
2πσ2 exp

−

r2
2σ2 !

,

 −

where I0 is the total beam current. At this point we ﬁnd it convenient to
impose the following restriction: we focus only on the radiation see by an
observer lying on the electron beam axis. When r = 0 and the beam proﬁle is
Gaussian, we can write (14) in the form

˜E0(z) =

i θwωainI0
2σ2c2

z

Z0

d z′
z′

−

z

∞

Z0

r′ exp

(r′)2
2σ2 #

"−

exp

i ω(r′)2
2c(z

"

z′) #

−

d r′ .

16

Integrating ﬁrst with respect to r′, we have

˜E0(z) =

i θwωainI0
2c2

z

Z0

z

−

d z′
z′ + i kσ2 ,

(15)

where k = ω/c is the radiation wavenumber. The physical implications of
this result are best understood by considering some limiting cases. It is con-
venient to rewrite this expression in a dimensionless form. After appropriate
normalization it is a function of one dimensionless parameter only:

ˆE0 = f (ˆz, β) = i

ˆz

Z0

ˆz

−

d ˆz′
ˆz′ + i β

,

where ˆz = z/Lw is the dimensionless coordinate along the undulator, Lw is
the total undulator length, β = kσ2/Lw is the diﬀraction parameter and

ˆE0 = ˜E/En = 2c2 ˜E/(θwωainI0)

is the normalized ﬁeld amplitude. The changes of scale performed during the
normalization process, mean that we are measuring distance along the un-
dulator and electron beam size as multiples of ”natural” undulator radiation
units. Let us study the asymptotic behaviour of the ﬁeld amplitude at large
ˆz′ and we have
values of the diﬀraction parameter β. In this case β
asymptotically:
ˆE0 →

as β

→ ∞

(16)

ˆz/β

≫

−

ˆz

.

Now let us study the asymptote of a thin electron beam. In this case β
0
and the function f (ˆz, β) can be evaluated in the following way. First we remark
that the integral can be expressed as p + i q:

→

f (ˆz, β) = i

ˆz

Z0

ˆz

−

d ˆz′
ˆz′ + i β

=

ˆz/β

Z0

d x
1 + x2 + i

ˆz/β

Z0

x d x
1 + x2

The ﬁrst integral should go from 0 to ˆz/β, but 0 is so far from ˆz/β that
the curve is all ﬁnished by that time , so we go instead to
- it makes no
diﬀerence and it is much easier to do the integral. The integral is an inverse
tangent function. If we look it up in a book we see that it is equal to π/2. The
second integral can be expressed as logarithm function. Thus we have

∞

ˆE0 →

π/2 + i ln(ˆz/β)

as β

0 .

(17)

→

17

It is interesting to note that in the case of a thin electron beam, the radia-
tion ﬁeld, acting on the electrons is almost constant along the undulator axis,
which is a little strange, because the modulated electron beam radiates elec-
tromagnetic waves along the undulator. But that is the way it comes out -
fortunately a rather simple formula 2 .

→

Special attention is called to the fact that in the thin electron beam case, at
0, amplitude ˜E(z) is a complex function. One immediately recognizes
β
the physical meaning of the complex ˜E0(z). Note that electric ﬁeld (response)
is given by fast wave of transverse current (”force”) times a certain factor.
This factor can either be written as p + i q, or as a certain magnitude ρ times
exp(i δ). If it is written as a certain amplitude ρ times exp(i δ), let us see what
it means. This tells us that electric ﬁeld is not oscillating in phase with the fast
wave of transverse current, which has (at C = 0) the phase ψ = ωz/c
ωt,
but is shifted by an extra amount δ(z). Therefore δ(z) represent the phase
shift of the response.

−

To get an intuitive picture on what happens with the radiation beam inside
the near zone according to equation (14), let us ﬁrst choose thin beam asymp-
totic. This is an example in which diﬀraction eﬀects play an important role.
Simple physical consideration can lead directly to a crude approximation for
the radiation beam cross-section. There is a complete analogy between the
radiation eﬀects of the bunched electron beam in the undulator and the radi-
ation eﬀects of a sequence of periodically spaced oscillators. The radiation of
these oscillators always interferes coherently at zero angle with respect to the
undulator axis. When all the oscillators are in phase there is a strong intensity
in the direction θ = 0. An interesting question is, where is the minimum? If
we have a triangle with a small altitude r
zθ and a long base z, then the di-
zθ2/2.
agonal s is longer than the base. The diﬀerence is ∆ = s
When ∆ is equal to one wavelength, we get a minimum. Now why do we get
λ? Because the contributions of various oscillators are
a minimum when ∆
then uniformly distributed in phase from 0 to 2π. In the limit of small size of
the electron beam interference will be constructive within an angle of about
θc ≃
In the limit of large electron beam size, the spread of the angle distribution can
be found from a two-dimensional Fourier transform of the ﬁeld. The radiation
ﬁeld across the electron beam may be presented as a superposition of plane
waves, all with the same wavenumber k = ω/c. The value of k⊥/k gives the sine
of the angle between the z axis and the direction of propagation of the plane
θ. We can expect that
wave. In the paraxial approximation k⊥/k = sin θ

1/√kz.

r2/2z

≃

−

≃

≃

≃

z

≃

2 For FEL experts who happen to be reading this we should add that our logarith-
mic term in (17) and the logarithmic growth rate asymptote for conventional FEL
ampliﬁer at small diﬀraction parameter (see [12]) are ultimately connected

18

Fig. 4. Apparent photon source size in the case of a thin electron beam. The photon
source extends over undulator length Lw along the particle path
(kσ)−1,
the typical width of the angular spectrum should be of the order θc ≃
a consequence of the reciprocal width relations of the Fourier transform pair
∆k⊥σ

1.

≃

√kLw or (another
The boundary between these two asymptotes is about kσ
σ2
way to write it) σ2
dif = Lw/k. A rough estimate for the diﬀraction eﬀects
≃
Lw/(kσ), which simply means that the diﬀraction expansion
to be small is σ
of the radiation at undulator length must be much less than the size of the
beam. Another way to write this condition is kσ2/Lw = β
1. The parameter
≫
β can be referred to as the electron beam Fresnel number.

≫

≃

Our estimates show (see Fig. 4) that in the case of a thin beam the square of
the radiation beam grows linearly with the undulator length

Srad ≃

(zθc)2

z/k

≃

for β

1 .

≪

In the case of a wide electron beam the most of the radiation overlaps with
the electron beam

Srad ≃

σ2 = const.

for 1

β .

≪

Up to this point we only talked about electric ﬁeld amplitude on the electron
beam axis. Ultimately we want to consider the distribution of the electric
ﬁeld over the full electron beam cross-section. The full analysis is a diﬃcult
analytical problem. The calculations can be performed without great diﬃculty
in two limiting cases, namely, the cases of diﬀraction parameter very large and
very small comared with unity. To calculate equation (14) we note that the
behaviour of Green’s function (13) for kσ2/Lw ≫
1 approaches the behaviour
of the delta function. The source function n0(~r′
⊥) does not vary very much
~r′
Lw/k in the case of a wide electron beam:
across the region
⊥ |

~r⊥ −

≃

|

2

19

therefore we can replace it by a constant. In other words, we simply take
n0(~r′
⊥) outside the integral sign and call it n0(~r⊥). In this case the integral
over source coordinates ~r′

⊥ in (14) is calculated analytically

˜E(z, ~r⊥) = πeθwzainn0(~r⊥) =

θwzainI0
2cσ2

exp

r2
2σ2 !

 −

as β

1 .

(18)

≫

We emphasize the following features of this result. At exact resonance (C = 0)
amplitude ˜E is a real function. This tells us that electric ﬁeld is oscillating in
phase with the fast wave of transverse current.

Let us turn next to the second case where β
1. It should be noted that
dealing with klystron ampliﬁer this situation is more preferable than the pre-
vious one. In thin electron beam case there is only a small variation in electric
ﬁeld amplitude over electron beam cross section. This feature follows natu-
rally from the fact that the radiation expands out and electron beam becomes
thin with respect to the radiation beam. Using (14), we ﬁnd that the ﬁeld
amplitude inside the thin electron beam is given by the formula

≪

˜E(z, ~r⊥) =

θwωainI0
2c2

π
2

(cid:20)

+ i ln

cz
ωσ2

(cid:18)

(cid:19)(cid:21)

as β

1 .

≪

(19)

The nonzero imaginary term is a manifestation of the fact that electric ﬁeld
is not oscillating in phase with the fast wave of transverse current.

In (14) we have the general solution of the problem of ﬁnding the ﬁeld produced
by modulated current, and this is the ﬁrst part of the problem of the operation
of the high gain klystron ampliﬁer. The next question which we must take up
is the converse one: Given an electric ﬁeld of the type we have just considered,
what is the electronic motion in such a ﬁeld?

2.2 Self-interaction within a modulated electron beam moving in an undulator

Since, the wavelength of the radiation pulse is much less than either the trans-
verse electron beam size or the pulse length it can be accurately represented
by a wave traveling at ω/k
c. Further, since the electron also travels at
c, the electron and the radiation remain essentially overlapped during
vz ≃
the transit through the undulator. Although the radiation ﬁelds alone do not
aﬀect the electron trajectory, the interaction of the transverse radiation elec-
tric ﬁeld with the transverse oscillations of the electron induced by the static
undulator magnetic ﬁeld causes the electron to either gain or lose energy.

≃

As simple example of the interaction between electrons and electromagnetic

20

wave in an undulator we shall consider a circularly polarized plane electromag-
netic wave propagating parallel to the electron beam. The ﬁeld of the elec-
tromagnetic wave has only a transverse component, so the energy exchange
between the electron and the electromagnetic wave is due to the transverse
component of the electron velocity. The rate of electron energy change is

d
E
d t

= mec2 d γ
d t

=

e~v⊥ ·
−

~E⊥ ,

where ~E⊥ is the vector of the electric ﬁeld of the wave:

~E⊥ = E

~ex cos [ω(z/c
{

−

t)] + ~ey sin [ω(z/c

t)]

.

}

−

Remembering that d z = vz d t we ﬁnd

=

(vxEx + vyEy)

e
vz
−
eθwE
eθwE cos [kwz + ω(z/c
eθwE cos ψ .

{

cos(kwz) cos [ω(z/c

−

d
E
d z

≃ −
=
−
=
−

t)]

sin(kwz) sin [ω(z/c

t)]
}

−

−
t)]

−

(20)

The phase ψ has a simple physical interpretation and is equal to the angle
between the transverse velocity of the particle, ~v⊥, and the vector of the elec-
tric ﬁeld. For eﬀective energy exchange between the electron and the wave, the
~E⊥) should be kept nearly constant along the whole undu-
scalar product (e~v⊥ ·
lator length, i.e. a synchronism should be provided. This resonance condition
may be written as

d ψ = kw d z + (ω/c) d z

ω d t = 0 .

−

Remembering that d z = vz d t, we have kw + ω/c
λ = 2πc/ω,

−

ω/vz = 0. Or, since

λw/vz = λ/(c

vz) .

−

Thus, we see that synchronism takes place when the wave advances the elec-
tron beam by one wavelength at one undulator period. This resonance con-
dition is exactly equation (4), so we have come full circle. Electromagnetic
wave excitation and production of the electron beam energy modulation are
ultimately connected.

From this simple analysis it is apparent that the electron’s relative position
within a radiation wavelength will determine whether it consistently gains or

21

loses energy as it travels through the undulator magnet. A convenient variable
for the description of the interaction between electrons and electromagnetic
wave in an undulator is the phase ψ. The relevant value of the phase ψ is that
at the location of the particle. Hence, the total derivative of ψ is given by

d ψ
d z

= C =

∂ψ
∂z

+

∂ψ
∂t

d t
d z

= kw +

ω
c −

ω
vz

.

Thus, the phase of the particle changes when the resonance condition is not
satisﬁed exactly.

Since discrete electrons are considered, their entrance into the interaction re-
gion is conveniently described in terms of their entrance phase positions rel-
ative to one cycle of the modulating electromagnetic wave at the input, i.e.
ωt0, where t0 is the
z = 0. An entrance phase variable is deﬁned by ψ0 =
entrance time. Let the initial electron energy be
E0. Thus, at a given displace-
ment plane the electron will have a kinetic energy deviation

−

(ψ0, z)

− E0 =

−

eθw

E

d zE cos (ψ0 + Cz) ,

z

Z0

if ψ0 is the arrival phase of this particular electron at the undulator entrance.

We should remark that our analysis of the interaction between electrons and
radiation in an undulator gives a result that is somewhat simpler than we
would actually ﬁnd in nature. All of our calculations have been made for the
plane electromagnetic wave with phase velocity equal to the velocity of light.
The actual radiation wave in an undulator will experience an amplitude change
and a phase shift due to the radiation process. The electric ﬁeld of the wave
radiated in the helical undulator can be represented by equation (11). We can
also write this expression as

˜E(z, ~r⊥) exp i ω(z/c

t) =

˜E(z, ~r⊥)

−

|

|

exp i[ω(z/c

t) + ψe(z, ~r⊥)] ,

−

which says that radiation wave is not ordinary transverse plane wave. Our
ﬁnal result for the kinetic energy deviation is therefore

E − E0 =

−

eθw

d z

|

˜E(z, ~r⊥)

|

z

Z0

cos [ψ0 + Cz + ψe(z, ~r⊥)] ,

(21)

This expression deserves some remarks. In dealing with start-up from the elec-
tron beam density modulation the appropriate ”frame of reference” is moving
with the fast wave rather than at the velocity of light. The angle between the

22

transverse velocity of the particle and the vector of the electric ﬁeld is given
by

ψ = ψ0 + Cz + ψe(z, ~r⊥) ,

where Cz + ψe(z, ~r⊥) represent the phase shift of the radiation wave (”re-
sponse”) relative to the fast wave (”force”). What do we use for the entrance
phase in our formula (21)? We use the entrance phase position relative to one
cycle of the fast wave at the input. For simplicity of analysis, we consider the
cases in which there are no variations in phase of the density modulation in
the transverse plane at the undulator entrance. In those cases an entrance
phase variable is deﬁned by ψ0 =

ωt0, where t0 is the entrance time.

−

We have what we need to know - the electron beam energy modulation at the
undulator exit (21). We are ready to ﬁnd energy modulation, because we have
already worked out what ﬁeld is produced by a bunched electron beam inside
the near zone (14). These equations are not well suited for quick calculation of
the energy modulation at a particular diﬀraction parameter. We may, however,
express (14) in much simpler form for very small and very large diﬀraction
parameters, making use of limiting expressions (18) and (19). Let us see what
happens if the diﬀraction parameter β is large. At exact resonance (C = 0)
using (18) the energy modulation amplitude achieved at a given displacement
plane can be written as:

=

ainθ2
w
4

z2
σ2

I0
γIA

−

exp

r2
2σ2 !

 −

cos ψ0 ,

δ

E
E

(22)

where IA = mec3/e

17kA is the Alfven current.

≃

Now let us analyze this expression and study some of its consequences. To
develop a useful mathematical formalism for the description of interaction
between electrons and ﬁelds in an undulator we must choose the appropriate
coordinate system to maximize physical clarity. We chose at the beginning of
this section to use the stationary coordinate system z. For example, the beam
density at point z, at time t is

n(z/vz −

t) = n0 + ainn0 cos ω(z/vz −

t).

A convenient way of description the particle beam dynamics is to use a co-
ordinate system z′ that moves at a velocity vz with respect to the stationary
coordinate system z. When a particular electron enters the undulator, its ini-
tial position is z′
0 in the moving coordinate system. The electron would remain
stationary at z′
0 in the moving coordinate system; in the stationary coordi-
nate system, at a time t, it would have moved a distance from the entrance

23

−

t0), where t0 is the entrance time. Let us write an expression for beam
z = vz(t
density modulation in terms of the moving coordinate system introducing the
wave number k′ deﬁned by k′ = ω/vz = 2π/λ′, where λ′ is a wavelength of the
modulation frequency, i.e. the distance through which a particle travels in a
cycle of modulation frequency. We may thus write n(z′
0).
Note that k′z′
ωt0 = ψ0 and this expression may be rewritten in the terms
0 =
of arrival phase

0) = n0 +ainn0 cos (k′z′

−

n(ψ0) = n0 + ainn0 cos ψ0 ,

where we calibrated time in such a way that when a particular electron enters
the undulator at time t = 0, its initial position is z′ = 0 in the moving
coordinate system. Just as we expected, in the case of wide electron beam, the
beam energy modulation is oscillating in phase with beam density modulation.

In the case of thin electron beam, things are quite diﬀerent. For a small diﬀrac-
tion parameter β
1 we may apply an asymptotic approximation for the ﬁeld
amplitude (19) and get

≪

=

ainθ2
wωz
2c

−

I0
γIA (cid:26)

π
2

δ

E
E

cos ψ0 − (cid:20)

ln

(cid:18)

1

sin ψ0

.

(cid:19) −

(cid:21)

(cid:27)

cz
ωσ2

(23)

Thus, we see that, in the case of thin electron beam, the beam energy mod-
ulation is not oscillating in phase with beam density modulation. Equations
(22) and (23) give us an idea of what we should expect. Generally we can try
to calculate the energy modulation precisely by using the (14) and (21). That
is the end of our calculations of the electron beam energy modulation, but
there is one physically interesting thing to check, and that is the conservation
of energy.

2.3 Power balance

As any oscillating charge radiates energy, so must a modulated electron beam
moving along an undulator radiate energy. If the system radiates energy, then
in order to preserve conservation of energy we must ﬁnd that electron beam en-
ergy is being lost. An interesting question is, what forces are electrons working
against? That is interesting question which can be completely and satisfacto-
rily answered for modulated electron beam in an undulator. What happens in
this: in bunched beam, the ﬁelds produced by the moving charges in one part
of the undulator react on the moving charges in another part of the undulator.
We can calculate these forces and ﬁnd out how much work they do, and so ﬁnd
the right rule for the radiation force. We can make this calculation because at

24

short distance we know the electric ﬁeld. Above we calculated the radiation
ﬁeld inside the near zone (14).

In our system energy is transported both in the form of electromagnetic waves
and in kinetic energy. The well-known Poynting vector represents the electro-
magnetic power ﬂow; the kinetic-power ﬂow is merely the number of electrons
crossing per unit area per unit time multiplied by the kinetic energy per elec-
tron. Consider ﬁrst the electromagnetic power. In the paraxial approximation
the diﬀraction angles are small, the vectors of the electric and magnetic ﬁeld
are equal in absolute value and are perpendicular to each other. Thus, the
expression for the radiation power, W , can be written in the form:

W =

c
4π Z |

~E⊥ |

2 d~r⊥ ,

· · ·

where (
) denotes averaging over a cycle of oscillation of the carrier wave. If
we consider a system with ﬁelds and bunched electron beam in an undulator,
the energy stored in any volume ﬂuctuates sinusoidally with time. But on the
average there is no increase or decrease in the energy stored in any portion
of the volume, so that the below conservation theorem holds if averaged over
time, although the integrals might not be zero instantaneously because of the
time variations in the energy storage.

Since the radiation ﬁeld inside the near zone has the form of equation (14),
than W is given by:

W =

c
4π Z |
wa2
in

=

e2ω2θ2
16πc

~E⊥ |

2 d ~r⊥ =

z

d ~r⊥ 
Z0


Z

z

c
4π Z |
d z′
z′

Z

−

˜E(z, ~r⊥)

2 d ~r⊥

|

d ~r′

⊥n0(~r′

⊥) exp

i ω

|
2c(z

~r⊥ −
−

"

2

~r′
⊥ |
z′)

z

d z′′
z′′

−

z

Z

× 


Z0



d ~r′′


⊥n0(~r′′

⊥) exp

i ω

|
2c(z

~r⊥ −
−

2

~r′′
⊥ |
z′′)

"−

.

#




#




(24)

The product of integrals over z′ and z′′ can be represent as

z

Z0

z

Z0

z

Z0

z′

Z0

Φ(z′) d z′

Φ∗(z′′) d z′′ =

Φ(z′) d z′

Φ∗(z′′) d z′′ + C.C.

The integral over transverse coordinate ~r⊥ is equal to

25

(25)

(26)

d ~r⊥ exp

i ω

|
2c(z

~r⊥ −
−

"
∞

2

~r′
⊥ |
z′) −

d x

d y exp

[(x

−

i ω
2c

(

∞

Z

=

2

~r′′
⊥ |
z′′)

#
y′)2]

−

i ω

~r⊥ −
|
2c(z
−
x′)2 + (y
z′

z

−

Z−∞

[(x

Z−∞
i ω
2c
2π i c
ω

−

=

−

(z

x′′)2 + (y
z′′

z
−
z′)(z
z′

−

−
z′′

−

y′′)2]

)

−

z′′)

exp

"−

i ω

~r′
⊥ −
|
2c(z′
−

2

~r′′
⊥ |
z′′) #

.

As a result, expression (24) can be written in the form:

W =

wa2
in

i ωe2θ2
8

exp

×

"−

i ω

~r′
⊥ −
|
2c(z′
−

z

Z0

z′

d z′

Z0
2

~r′′
⊥ |
z′′) #

d z′′
z′′
z′

−

+ C.C.

d ~r′
⊥

d ~r′′

⊥n0(~r′

⊥)n0(~r′′
⊥)

Z

Z

Latter expression can be written in terms of the complex amplitude of the
radiated ﬁeld ˜E(z, ~r⊥). Using (14) and (26) we obtain the expression for W :

W =

i eθwcain
4

z

Z0

Z

d z′

d ~r′

⊥n0(~r′

⊥) ˜E(z′, ~r′

⊥) + C.C.

(27)

The radiation power, W , must be equal to the diﬀerence of the electron beam
power at the exit and the entrance of the undulator. The rate of the energy
change for a single electron is given by

/ d z =

d

E

eθw |
−

˜E(z, ~r⊥)

|

cos[ψ0 + ψe(z, ~r⊥)] .

To obtain the mean power loss by the electron beam, we should multiply this
cainn0 cos ψ0 average over
value by the particle ﬂux density vzainn0 cos ψ0 ≃
time, and integrate over the beam cross-section and the undulator length.
Finally, we obtain the following result:

2π

z

d ψ0

d z′

1
2π

Z

Z0
˜E(z′, ~r′

Z0
⊥)

|

∆We =

eθw |
−

×

n

d ~r′

⊥ {

cainn0(~r′

⊥) cos ψ0}

cos[ψ0 + ψe(z′, ~r′

⊥)]
o

26

=

i eθwcain
4

−

z

Z0

Z

d z′

d ~r′

⊥n0(~r′

⊥) ˜E(z′, ~r′

⊥) + C.C.

(28)

Comparing this expression with (27), we see that the radiation power and the
change in the electron beam power have equal absolute values and are opposite
in sign, i.e. ∆We + W = 0. So, power balance takes place.

3 The region of applicability

Our theory of klystron ampliﬁer is based on the assumption that beam den-
sity modulation does not appreciably change as the beam propagates through
the undulator. When the resonance condition takes place, the electrons with
diﬀerent arrival phases acquire diﬀerent values of the energy increments (pos-
itive or negative), which results in the modulation of the longitudinal velocity
of the electrons vz with the radiation frequency ω. Since this velocity mod-
ulation is transformed into density modulation of the electron beam during
the undulator pass, an additional radiation ﬁeld exists because of variation
in amplitude density modulation. Instead, we assume that the amplitude of
the electron beam density modulation has the same value at all points in the
undulator. This approximation means that only the contributions to the radi-
ation ﬁeld arising from the initial density modulation are taken into account,
and not those arising from the induced bunching.

3.1 Induced bunching

It is interesting to estimate the amount of bunching produced during the
undulator pass. The velocity vz of the electron at given displacement plane z
is given by

vz(

) = v0 + δvz(z, ~r⊥) cos[ψ0 + δ(z, ~r⊥)]

where v0 = vz(
frequency oscillation. From (23) we can ﬁnd δvz remembering that vz ≃
(d vz/ d

E0) is the injected velocity, and δvz is a small amplitude of high
c and

c/(γ2

)

|E=E0≃
ainθ2

≃

δvz(z)

wωzI0

z E0). We have
γ2
z γIA
.

−1

(cid:16)

(cid:17)

(29)

We now examine the behaviour of these electrons as they travel a certain
distance in an undulator. Since successive electrons are not traveling with

E

E

27

the same velocity, bunching takes place. To calculate a numerical value for
the current, we must compute the actual arrival time of the various electrons
at the undulator exit. The appropriate expression is formulated by means of
the law of conservation of charge. Quantitatively, we can say that during an
inﬁnitesimal interval of time d t1, a total charge d q = I1 d t1 passes through
plane z1. We follow the same particles (i.e. the same charge) through the plane
z2 at some later time t2. These particles will pass through the z2 plane during
the an inﬁnitesimal time interval d t2 which may be shorter or longer than
d t1. In either case, the instantaneous current I2(t2) due to the charge passing
through z2 plane in the interval d t2 is obtained from d q = I2 d t2. Obviously,
the two charges are the same since we are following the same set of particles.
Hence due to this charge, there is a current through z2 plane I2 = I1 d t1/ d t2.
If an electron has velocity vz when it leaves point z1 and maintains this velocity,
then its transit time to point z2 is given by the expression

t2 = t1 +

z2 −

z1
v0 + δvz cos ωt1 ≃

t1 +

z1

z2 −
v0

1
"

−

δvz
v0

cos ωt1

.

#

(30)

This equation provides us with the relation between the arrival time t2 at point
z2 for the particular group of charges which left point z1 at the departure time
t1. It is possible to calculate current at point z2 for small values of δvz/v0 by
diﬀerentiating the last equation and substituting in equation I2 = I1 d t1/ d t2.
This procedure leads to

I1

I2 ≃

1 + α sin ωt1 ≃

−

I1 (1

α sin ωt1) ,

z1)δvz/v2

where α = ω(z2 −
0. This equation is obviously still not in a useful
form, since it also only gives the current at point z2 in terms of departure
times of the charges from point z1. However, by using (30) again (to eliminate
t1) and using the fact that α

1, one can write approximately

I2 ≃

I1 {
1

−

α sin [ωt2 −

≪
k (z2 −

z1)]
}

,

where the terms that have been neglected in t1 would have contributed only
terms of the order of α2 to the current I2. Thus the induced bunching that we
want at the point z2 due to the velocity modulation at the point z1 is equal
to α = ω(z2 −
0. Now we ﬁnd the total induced bunching at the point
z2 by ﬁnding the induced bunching there from each point z1 < z2, and then
adding the contributions from all the points. To calculate this sum we need
to use (29). We have, then,

z1)δvz/v2

δa =

z2

ω
v2
0

Z0

(z2 −

z1)

d vz
d z1

d z1 ≃

ainω2θ2

wz2

2I0

c2γ2

z γIA

−1

.

(cid:16)

(cid:17)

(31)

28

Thus, the requirement for the induced bunching to be small can be written as
δa
ain. The result of a more careful analysis shows that the last condition
can be written as

≪

(32)

ω2θ2

wL2

wI0

6c2γ2

z γIA

(cid:16)

−1

(cid:17)

1 .

≪

3.2 Energy spread

During the passage through an undulator the electron density modulation can
be suppressed by the longitudinal velocity spread in the electron beam. For
eﬀective operation of klystron ampliﬁer the value of suppression factor should
be close to unity. If there is an (local) electron energy spread into the electron
, there will be a corresponding longitudinal velocity spread given by
bunch, ∆
E
/(γ2
c∆
z E0). To get a rough idea of the spread of electron density modulation,
the position of the particles within the electron beam at the undulator exit
has a spread which is equal to

E

∆z′

Lw∆vz/v0 ≃

Lw∆
E

≃

−1

,

γ2
z E0

(cid:16)

(cid:17)

We know that uncertainty in the phase of the particles is about ∆ψ0 ≃
2π∆z′/λ′. Therefore, a rough estimate for the microbunching spread to be
small is

ωLw∆
E

cγ2

z E0

(cid:16)

(cid:17)

−1

1 .

≪

It is clear that we have made several rough approximations. Besides various
factors of two we have left out, we have used ∆
, where we should have
used variance
. All of these reﬁnements can be made; the result of a
more careful analysis shows that for the Gaussian distribution function the
suppression factor is equal to exp
. So a better
answer is
i

/ (2c2γ4
z E

ω2L2
wh

−
h

(∆

(∆

2
0 )

)2

)2

E

E

E

i

h

i

ω2L2
w
2c2γ4
z

(∆

h

)2
E
i
2
0 ≪
E

1 .

Remembering that λw = 2γ2

c, we have

(2πNw)2

(∆

)2

/

2
0 ≪

E

i

E

h

z λ and v0 ≃
1 ,

(33)

where Nw is the number of undulator periods. This condition is not a re-
striction. Let us present a speciﬁc numerical example. For unbunched electron

29

beam the local energy spread is about
h
energy is
q
is the case in all practical cases of interest.

E0 = 500 MeV, the last condition can be written as Nw ≪

5 keV. If the nominal
104. Such

i ≃

(∆

E

)2

3.3 Transverse emittance

For a klystron ampliﬁer it is of great interest to maximize the gain per cascade
pass which is proportional to the amplitude of electric ﬁeld inside the electron
beam. It is usually desired to optimize the ampliﬁer to achieve the highest
possible gain coeﬃcient for a given total current I0. Reducing the particle beam
cross-section by diminishing the betatron function reduces also the size of the
radiation beam and increases, according to (18), the amplitude of the electric
ﬁeld. This process of reducing the beam cross section is, however, eﬀective
only up to some point. Further reduction of the particle beam size would
have practically no eﬀect on the radiation beam size because of diﬀraction
eﬀects (19). It is therefore prudent not to push the particle beam size to
values much less than the difraction limited radiation beam size. From the
preceding discussion we may want to optimize the beam geometry as follows.
For maximum ampliﬁcation, the transverse size of the electron beam has to
be matched to the diﬀraction limited radiation beam size

σ <

λLw/(2π) .

q

The wavelength and undulator length dictates the choice of the optimal trans-
verse size of the electron beam.

One might think that all we have to do is to get electric ﬁeld amplitude to
a maximum - we can always reduce electron beam cross section and we can
always increase gain. So it is not impossible to build an electron focusing sys-
tem that has a small betatron function. In fact, one of the main problems in
klystron ampliﬁer operation is preventing the spread of microbunching due to
angle spread into the electron beam. Some electrons traverse the undulator
not along or parallel to the z
axis, but at a small angle θ. If there is an rms
angular divergence σ′ within the electron bunch there will be a correspond-
(σ′)2/2. We assume that
ing longitudinal velocity spread given by ∆vz/vz ≃
the amplitude of beam modulation does not appreciably change as the beam
propagates through the undulator. To avoid an decrease in the amplitude of
the beam modulation, the longitudinal velocity spread must be small enough
Lw∆vz/vz ≪
(σ′)2

λ/(2π). This gives the condition

λ/(2πLw) .

−

≪

30

The last two conditions can be written as

ǫ/π = σσ′

λ/(2π) ,

≪

where ǫ is the transverse electron beam emittance. The last condition can be
seen as ”phase matching” of the electrons and radiation. To produce maximal
gain the particle beam emittance must be less than the diﬀraction limited
radiation emittance. Obviously, this condition is easier to achieve for long
wavelengths. For optimal gain for a 30 nm radiation, for example, the electron
beam emittance must be smaller than about 10−6π rad.
cm. This condition
may be easily satisﬁed in practice.

−

4 Bunching by energy modulation

/

In two-undulator klystron, energy modulation occurs in the ﬁrst undulator and
the conversion to density modulation in the dispersion section. The dispersion
section is designed to introduce the energy dependence of a particle’s path
length, ∆z = R56δ
E0. Several designs are possible, but the simplicity of a
four-dipole magnet chicane is attractive because it adds no net beamline bend
angle or oﬀset and allows simple tuning of the momentum compaction, R56,
with a single power supply. The trajectory of the electron beam in the chicane
has the shape of an isosceles triangle with base length L. The angle adjacent
to the base, θB, is considered to be small. For ultra-relativistic electrons and
small bend angles, the net R56 of the chicane is given by (see Fig. 5)

E

R56 = Lθ2

B .

Optimal parameters of the dispersion section can be calculated in the following
way. The phase space distribution of the particles in the ﬁrst undulator is
described in terms of the distribution function f (P, ψ0) written in ”energy-
E − E0 and ψ0 = 2πz′/λ′ = ω(z/v
phase” variables P =
E0 is the
nominal energy of the particle and ω is the angular frequency. Before entering
the ﬁrst undulator, the electron energy distribution is assumed to be Gaussian:

t), where

−

f0(P ) =

1

2π

(∆

)2

h

E

i

q

exp

P 2
(∆

 −

2

h

)2

!

i

E

.

The present study assumes the density modulation at the end of ﬁrst undulator
to be very small and there is an energy modulation P0 cos ψ0 only. Then the
distribution function at the entrance to the dispersion section is

f0(P + P0 sin ψ0) .

31

Fig. 5. Schematic of dispersion section

After passing through the dispersion section with dispersion strength d ψ0/ d P ,
the electrons of phase ψ0 and energy deviation P will come to a new phase
ψ0 + P d ψ0/ d P . Hence, the distribution function becomes

f (P, ψ0) = f0

P + P0 sin

 

ψ0 −

 

P

d ψ0
d P !!

.

The dispersion strength parameter and compaction factor are connected by
the relation

d ψ0
d P

=

2π
λ′

d z′
d

E

=

2π
λ′

R56

E0

.

The integration of the phase space distribution over energy provides the beam
density distribution, and the Fourier expansion of this function gives the har-
monic components of the density modulation converted from the energy mod-
ulation [13]. At the dispersion section exit, we may express current I in the
form

I = I0

f (P, ψ0) d P = I0 + 2I0

exp

∞

Z−∞

Jn

nP0

×

 

d ψ0
d P !

cos(nψ0) .

∞

Xn=1

1
2



−



n2

(∆

)2

h

E

i  

2

d ψ0
d P !





(34)

We ﬁnd a set of harmonic waves, of which the fundamental term, with angu-
lar frequency ω, is the one of importance in an ampliﬁer. This fundamental

32

involves the phase variation cos ψ, but it is multiplied by the amplitude term

aout = 2J1

P0

 

d ψ0
d P !

exp

1
2 h

(∆

)2

E

i  

2

d ψ0
d P !



−



.





For small input signal we may assume that the argument of the Bessel func-
tion is small. The function J1(X) approaches X/2 for small X; thus the mi-
crobunching approaches

aout = P0

exp

d ψ0
d P

1
2 h

(∆

)2

E

i  

2

d ψ0
d P !



−



.





We see that microbunching depends greatly on the choice of the dispersion
section strength. An attempt to increase of the amplitude of the fundamental
harmonic, by increasing the strength of dispersion section, is countered by
a decrease of the exponential factor. The microbunching aout has clearly a
maximum

and the optimum strength of the dispersion section is

(aout)max =

P0

2.72

(∆

)2

h

E

i

q

d ψ0
d P !max

 

=

1

.

(∆

)2

E

i

h
q

(35)

(36)

E0 = 500 MeV, λ = 30 nm.
Consider the situation at
Appropriate substitution in (36) show that the optimal compaction factor is
equal to R56 = Lθ2

= 5 keV,

B = 500 µm.

h
q

(∆

E

i

)2

5 The properties of a klystron ampliﬁer

We can now piece together the information we have obtained in the preceding
sections, and discuss the behaviour of the klystron as an ampliﬁer of the
electron beam intensity modulation. The present section is concerned with
cascade ampliﬁers designed for conditions approximating maximum gain per
cascade pass.

33

5.1 Klystron ampliﬁer gain

In the section 2 we learned that when a modulated electron beam passes
through an undulator, the radiation ﬁeld modulates the energy of the elec-
trons. In order to calculate the energy modulation we can use (14) and (21)
and note that energy modulation at the undulator exit generally can be writ-
ten as p cos ψ0 + q sin ψ0, or as ρ cos(ψ0 + δ). When the gain per cascade pass
ain), the cascades can be considered independent. In
is high enough (aout ≫
this case we do not see the eﬀect of phase shift δ, but see only total amplitude
of modulation equal to ρ = √p2 + q2.

We are going to apply (14) to our analysis of energy modulation taking ad-
vantage of similarity techniques we used in section 2.1. The beam, of peak
current I0, is modulated in energy by the input undulator, and acquires an
energy modulation amplitude on the electron beam axis, of amount

δ

E
E

= F (β)

δ

E
E

 

!0

,

where

δ

E
E

 

!0

=

ainθ2
wωLw
2c

I0
γIA

,

and universal function F (β) should be calculated numerically by using (14).
The physical implication of this result are best understood by considering
some limiting cases. Equations (22) and (23) give us an idea what we should
expect in the case of wide and thin electron beam. We have asymptotically:

F (β)

1/(2β)

as

β

,

→ ∞

F (β)

π2/4 + [ln(1/β)

1]2

as

−

β

0 .

→

→

→

q

A natural and interesting choice is to calculate the gain in thin beam case
which we can identify with maximal gain. Note that the dependence of the
factor F (β) on the exact size of the bunch in the thin beam asymptote is
rather weak. Thus F (β)
1 is a reasonable approximation. Finally, the energy
≃
modulation amplitude can be estimated simply as:

δ

E
E

δ

E
E

≃  

!0

=

ainθ2
wωLw
2c

I0
γIA

for

β < 1 .

(37)

The energy modulated beam then enters the dispersion section, in which den-

34

sity modulation is developed. From equations (35) and (37) the over-all gain
per cascade pass at resonance may be readily be obtained if optimum disper-
sion section strength is assumed; thus

G0 =

aout
ain ≃

θ2
wω0Lw
2√2.72c

I0
∆γIA

for

β < 1 ,

(38)

where the following notation has been introduced: ∆γ =
Putting θw = K/γ, Lw = Nwλw, ω0 = 2π/λ = 4πγ2
in (38) gives

ec4.
)2
i
h
z = γ2/(1+K 2)
z c/λw and γ2
q

/m2

(∆

E

G0 ≃

1.2π

K 2
(1 + K 2)

NwI0
∆γIA

for

β < 1 .

(39)

The equation (39) tells us the maximal gain of cascade as a function of number
of undulator periods Nw, undulator parameter K, peak current I0 and rms
local energy spread ∆γ.

For conventional XFELs the following problem exists. The required very small
transverse beam emittance can be obtained only in a photoinjector. The bunch
length must be shortened. The distribution of particles in phase space is given
either by the injector characteristics and the injection process. Longitudinal
phase space can be exchanged by special application of magnetic and RF
ﬁelds. This is done in a specially designed beam transport line consisting of a
nonisochronous transport line (magnetic chicane) and an accelerating section
installed at the beginning of the bunch compressor. Liouville’s theorem is not
violated because the energy spread in the beam has been increased through
the phase dependent acceleration in the bunch compression system.

The cascade gain with continually optimized strength of the dispersion section
would be directly proportional to I0/∆γ. We have a rather surprising result.
We know that ratio I0/∆γ depends on the parameters of photoinjector but
not on the bunch compression. We expect this ratio to depend only on the
longitudinal emittance. So the simple result says that the klystron gain is
independent of absolute value of peak current. The change in peak current
with change of bunch length is compensated by the larger energy spread. Since
I0/∆γ is independent of bunch length, the gain would then be independent of
bunch compression.

The formula for the gain which we derived (39) refer to the case of the helical
undulator. For somewhat wider generality, although we are still making some
special assumption about undulator magnetic structure, we shall calculate the
characteristics of the klystron ampliﬁer with a planar undulator. The magnetic
ﬁeld on the axis of the planar undulator is given by ~H = ~exHw cos (kwz). The

35

explicit expression for the electron velocity in the ﬁeld of the planar undulator
~eycθw sin(kwz), where θw = K/γ = λweHw/(2πmec2γ). It
has the form: vy =
is not hard to go through the derivation of electron beam energy modulation
again. If we do that, and calculate the gain the same way, we get

−

G0 =

aout
ain ≃

wA2
θ2
JJω0Lw
4√2.72c

I0
∆γIA

for

β < 1 ,

(40)

where

AJJ = [J0(Q)

J1(Q)] ,

−

Jn(Q) is a Bessel function of nth order,

Q = θ2

wω0/(8kwγ2) = K 2/(4 + 2K 2) .

When we simpliﬁed the expression for Q, we used the resonance condition for
the planar undulator ω0 = 2γ2kw/[c(1 + K 2/2)]. It is convenient to rewrite the
expression (40) in the form:

G0 ≃

1.2π

A2
JJK 2
(2 + K 2)

NwI0
∆γIA

for

β < 1 .

(41)

The signiﬁcance of the proposed scheme cannot be fully appreciated until we
determine typical values of the gain per cascade pass that can be expected in
practice. Let us present a speciﬁc numerical example for the case of a klystron
ampliﬁer with a planar undulator. With the numerical values λw = 3 cm, K =
1.42, γ = 103, the resonance value of wavelength is λ = 30 nm. If the number
of the undulator period is Nw = 100, normalized transverse emittance ǫn =
2π µm, and betatron function is equal to the undulator length, the diﬀraction
parameter is about β
0.4. Remembering the results of section 2, we come to
the conclusion that we can treat this situation as an klystron ampliﬁer with
thin electron beam. It is shown that the residual energy spread in the TTF
FEL injector is on the order of a few keV only, even at a peak current of 100
A. If I0 = 100 A, and
= 5 keV, appropriate substitution in (41)
E
shows that the intensity gain per cascade pass is about G2

h
q

104.

(∆

≃

)2

i

0 ≃

It has been seen above that there are deﬁnite upper limits to the gain of a
two undulator klystron with a given current. It is obvious that a gain much
higher than that allowed by these limits may be obtained by using more than
one stage of ampliﬁcation. In the three-undulator type of klystron, called the
cascade-ampliﬁer klystron, the additional undulator (and dispersion section),
which lies between the input and output undulators, has no need of radiation

36

phase matching. Second cascade is excited by the bunched beam that emerges
from the ﬁrst cascade, and it produces further bunching of the beam. Cascade
bunching in a high-gain cascade ampliﬁer results in current components just
like those of simple bunching; the equivalent intensity gain, which determines
the cascade bunching, is given by G2
0 , where m is the number of
cascades. In practice, with a two-cascade klystron ampliﬁer, an intensity gain
in excess of 80 dB may be obtained at wavelengths around 30 nm. This simple
description is valid when beam modulation amplitude at the exit of the last
cascade is much smaller than unity. What happens when this condition is not
met is discussed later.

eq = G2m

Fluctuations of the electron beam current serve as an input signal to the
XFEL. The initial modulation of the electron beam is deﬁned by the shot
nose and has a white spectrum. When the electron beam enters the ﬁrst un-
dulator, the presence of the beam modulation at frequencies close to resonance
frequency initiates the process of radiation. The study has shown (see section
10−7 at I0 = 100 A,
5) that the mean square value of input is about
Nw = 100 and λ = 30 nm. It is seen that saturation in the cascade klystron
should occur at an exit of the second cascade in this situation. Thus, we con-
clude that a klystron ampliﬁer which consists of a succession of 2-3 cascades
can operate as a soft X-ray SASE FEL.

a2
ini ≃

3

h

·

)2

(∆

h
q

A disadvantage of using conventional FEL ampliﬁer at small peak current is
the enormously long undulator that is required. Let us calculate the param-
eters of the conventional SASE FEL for the value I0 = 100 A of the peak
= 5 keV, ǫn = 2πµm, γ = 1000, λw = 3 cm,
current. Suppose
K = 1.42, focusing beta function is equal to 3 m. Numerical solution of the
corresponding 3-D eigenvalue equation (see [12]) demonstrates that the ﬁeld
3.7 m. Well-known that saturation in a
gain length should be about lg ≃
SASE FEL with uniform undulator occurs after approximately 10 exponential
ﬁeld gain lengths. Remembering the total undulator length of the two-cascade
klystron ampliﬁer, we come to the conclusion that a signiﬁcant impruvement
in this parameter for klystron ampliﬁer can be achieved.

E

i

5.2 Klystron ampliﬁer bandwidth

All of the foregoing discussion of klystron ampliﬁer gain has been concerned
solely with the gain at resonance - that is ω = ω0. Nothing has been said
about ampliﬁcation bandwidth. Now, we would like to ﬁnd out how the gain
varies in the circumstance that the seed signal frequency ω is nearly, but not
exactly, equal to 4πγ2
z c/λw. It is not hard to go through the derivation of
electron beam energy modulation again. If we take C
= 0, the solution of the
wave equation (12) has the form

37

6
˜E(z, ~r⊥) =

i eθwωain
2c

d ~r′

⊥n0(~r′

⊥) exp

× Z

i Cz′)

z

d z′

z

Z0
i ω

z′ exp(
~r′
⊥ |
z′)

−
~r⊥ −
−

|
2c(z

−

2

"

.

#

(42)

(43)

Using (21) the energy modulation achieved at nonzero detuning parameter
can be written as

=

δ

E

−

i exp(i ψ0)

d ~r′

⊥n0(~r′

⊥) exp

× Z

z

e2θ2

wωain
4c

i ω

Z0
~r⊥ −
−

|
2c(z′

"

d z′ exp(i Cz′)

2

~r′
⊥ |
z′′) #

+ C.C.

z′

Z0

d z′′
z′

−

z′′ exp(

−

i Cz′′)

Now we shall calculate the energy modulation on the electron beam axis.
When r = 0 and beam proﬁle is Gaussian, we have

i ei ψ0 ainθ2
wω
4c

I0
γIA

=

−

z

Z0

d z′

d z′′

z′

Z0

ei C(z′−z′′)
z′′ + i kσ2 + C.C.

z′

−

Let us see what happens if the diﬀraction parameter β is large. In this case
we have asymptotically:

=

ei ψ0 ainθ2
w
4σ2
−

I0
γIA

z

Z0

z′

Z0

d z′

d z′′ei C(z′−z′′) + C.C.

δ

E
E

δ

E
E

The integrals over z′ and z′′ in the latter equation are calculated analytically

ei ψ0

d z′

d z′′ei C(z′−z′′) + C.C.

z

Z0

z′

Z0

=

sin2(Cz/2)
(C/2)2

(Cz/2)

sin(Cz/2) cos(Cz/2)

cos ψ0 +

−

sin ψ0 .

(44)

(C/2)2

Taking into account the deﬁnition of the detuning parameter we ﬁnd that C is
connected by a simple relation with the frequency deviation: ω
ω0 = ∆ω =
2γ2
z C. If we follow through the simple algebra we ﬁnd that

−

38

1.0

0.8

)
x
(
f

0.6

0.4

0.2

0.0

 

-15

-10

-5

0

5

10

15

Fig. 6. Frequency response curve

=

ainθ2
w
4

L2
w
σ2
[πNw∆ω/ω0]

−

δ

E
E
+

sin2[πNw∆ω/ω0]
[πNw∆ω/ω0]2

I0
γIA (
sin[πNw∆ω/ω0] cos[πNw∆ω/ω0]
[πNw∆ω/ω0]2

cos ψ0

−

sin ψ0

.

)

(45)

The energy modulation at the undulator exit can be written as p cos ψ0 +
q sin ψ0. The intensity gain G2 = a2
in is proportional to (p2 + q2). It is
out/a2
interesting to plot this gain as a function of input signal frequency in order
to see how sensitive it is to frequencies near the resonant frequency ω0. We
show such a plot in Fig. 6, where the following notation has been introduced:
x = πNw∆ω/ω0,

2

G(x)
G(0) #

"

= f (x) =

sin4(x)

x4 +

[x

sin(x) cos(x)]2

−

x4

.

(46)

−

The curve falls rather abruptly to zero for (ω
ω0) = 1.7ω0/(πNw) and never
regains signiﬁcant size for large frequency deviations. So, for large value of
diﬀraction parameter, the frequency response curve is f (x). This is also true
for the practically important case in which the diﬀraction parameter is close to
unity. Let’s examine the implication of this results for a real klystron ampliﬁer.
Suppose that the electron beam is in the undulator for a reasonable length, say
for 100 periods. Then we can calculate that the FWHM of the ampliﬁcation
bandwidth is equal to (∆ω)FWHM/ω0 = 1.1/Nw ≃
We have, then, a clear picture of the nature of the operation of the klystron

1 %.

 

x

39

ampliﬁer with nonzero detuning parameter, and a calculation of the band-
width to be obtained from it. A detail analytical theory of the ampliﬁcation
at C
= 0 and ﬁnite transverse electron beam size is rather complicated, but
the discussion which we have given here is enough for ordinary purposes.

5.3 Output of klystron ampliﬁer

The ampliﬁcation process in the klystron ampliﬁer can be divided into two
stages, linear and nonlinear. During the linear stage of ampliﬁcation, signif-
icant growth of the beam modulation amplitude and of the electromagnetic
ﬁeld amplitude takes place. Nevertheless, the beam modulation is much less
than unity in the cascade undulators, and the largest fraction of the radia-
tion power is produced in the output undulator, when the beam modulation
becomes about unity.

Suppose we have a modulated electron beam at the exit of the last cascade.
The problem of electromagnetic wave radiation in the output undulator refers
to a class of self-consistent problem. There is considerable analogy between
the nonlinear mode operation of the conventional FEL ampliﬁer and klystron
ampliﬁer. In the high gain linear regime of a conventional FEL ampliﬁer the
typical length of the change in the radiation ﬁeld amplitude is about the gain
length lg ≃

Γ−1, where for the one dimensional model

Γ =

I0θ2
wω
z γIAσ2 #

2cγ2

"

1/3

.

In the case of a uniform output undulator, the bunched beam eﬀectively in-
teracts with the electromagnetic wave along a length which is of the order
of the gain length lg. At this stage of the self-interaction electrons lose the
visual fraction of their energy which results in the violation of the resonance
condition. As a result, the beam is overmodulated, most electrons fall into
the accelerating phase of the ponderomotive potential and the electron beam
starts to absorb power from the electromagnetic wave. This is analogous to
the situation with a conventional FEL ampliﬁer. Like the eﬃciency of the
conventional FEL ampliﬁer, the eﬃciency η of the klystron ampliﬁer with a
long enough uniform output undulator is limited by the value of the eﬃciency
parameter ρ:

ρ = cγ2

z Γ/ω ,

η

≃

It should be note that the saturation eﬃciency of the klystron ampliﬁer does
not depend on the amplitude of the input signal when the klystron ampliﬁer

40

6
operates in the high-gain regime, i.e. when ain/aout ≪
For some purposes it is convenient to express ρ in a diﬀerent form

1.

ρ =

2/3

cγz
2ωσ (cid:21)

(cid:20)

I0
γIA #

"

1/3

K 2
1 + K 2 #

"

1/3

.

(47)

Thus the eﬃciency of the klystron ampliﬁer, deﬁned in this particular way,
depends on only the one-third power of peak current, a very weak dependence.
Let us make a calculation of η for some cases. Suppose I0 = 100 A, ǫn = 2πµm,
γ = 1000, λw = 3 cm, K = 1.42, focusing beta function is equal to 3 m; then by
equation (47) it follows that η
0.13 %. Returning to (47), we could imaging
the injector linac running at a I0 = 2.5 kA. As we mentioned above, the
dependence of η on the peak current is rather weak. As a result, the eﬃciency
is increased by only a factor three (η

0.4 %) for I0 = 2.5 kA.

≃

Let us present a speciﬁc numerical example for the case of a fourth-generation
light source. One of the key parameters to compare diﬀerent radiation sources
is their brilliance, which is simply given by the spectral ﬂux divided by the
transverse photon phase space. We illustrate with numerical example the po-
tential of the proposed klystron ampliﬁer scheme for the SASE FEL at the
TESLA Test Facility accelerator. The average brilliance of the conventional
TTF SASE FEL at a wavelength of λ

30 nm is about

≃

≃

Bav ≃

1022 photons/s/0.1%BW/mm2/mrad2

for the case when I0 = 2.5 kA [1]. Average photon ﬂux and average brilliance
η, the dependence of Bav on the
varies simply as eﬃciency η. Since Bav ∝
electron peak current is contained completely in the term ρ. If I0 = 100 A, ap-
propriate substitution in (47) shows that the average brilliance of the cascade
klystron ampliﬁer without bunch compression at a wavelength of λ
30 nm
is about

≃

Bav ≃

3

·

1021photons/s/0.1%BW/mm2/mrad2 .

On the other hand, at a wavelength of 30 nm brilliance of a third-generation
synchrotron light source is equal to

1017photons/s/0.1%BW/mm2/mrad2 .

Bav ≃

A comparison to synchrotron light sources shows the drastic improvement of
average brilliance at the klystron sources. The average brilliance of the klystron
facility operating without bunch compression in the injector linac surpasses the

41

spontaneous undulator radiation from third-generation synchrotron radiation
facilities by four or more orders of magnitude. However, it is not only the high
average brilliance which makes a klystron ampliﬁer facility a unique research
tool in the VUV and soft X-ray regime, the radiation from this facility shows
a very high peak brilliance too. Average brilliance is normalized to seconds at
the highest possible repetition rate while the peak brilliance is the brilliance
scaled to the length of a single pulse. Another type of current dependence are
expected for peak brilliance, a 4/3 power dependence Bpeak ∝
. The peak
brilliance of the conventional TTF SASE FEL at a wavelength of λ
30 nm
is about

I 4/3
0

≃

Bpeak ≃

1029 photons/s/0.1%BW/mm2/mrad2 .

On the other hand, the peak brilliance of the cascade klystron ampliﬁer with-
out bunch compression at a wavelength of λ

30 nm is about

≃

Bpeak ≃

1027photons/s/0.1%BW/mm2/mrad2 .

Decreasing the peak current also decreases the peak brilliance of the SASE
FEL radiation by about of factor 100, but this is still 6 orders of magnitude
higher than that of 3rd generation synchrotron radiation sources.

A cascade klystron ampliﬁer can be modiﬁed to increase signiﬁcantly the spec-
tral brightness of output radiation. A reliable method to increase the klystron
ampliﬁer eﬃciency consists in an adiabatic change of the output undulator
parameters (or, in other words, by the use of so-called undulator tapering).
When the electron bunch passes through the last dispersion section the energy
modulation leads to an eﬀective (nonlinear) compression of the particles. Then
the bunched electron beam enters a tapered output undulator, and from the
very beginning produces strong radiation because of the large spatial bunch-
ing. The strong radiation ﬁeld produces a ponderomotive well which is deep
enough to trap the particles, since the original beam is relatively cold. The
radiation produced by these captured particles increases the depth of the pon-
deromotive well, and they are eﬀectively decelerated. As a result, much higher
power can be achieved than for the case of a uniform undulator.

In [14] we have described the tapering undulator scheme for a SASE FEL.
Simulations using the code FAST provide a ”full physics” description of the
process. Despite the original spiking seeding the process of the electron density
modulation, we eﬀectively trap a signiﬁcant fraction of the particles, and can
achieve much higher power than for the case of an untapered output undulator.
Another important feature of the radiation from a tapered undulator is the
signiﬁcant suppression of the sideband growth in the nonlinear regime. This
means that in the proposed scheme the spectral brightness of the radiation

42

is increased proportionally to the radiation power. In the case of a uniform
undulator the peak brightness is reached at the saturation point and is then
reduced due to sideband growth.

6 Klystron ampliﬁer start-up from shot noise

Till now we have considered the electron beam as a continuous medium when
describing the theory of klystron ampliﬁer. To some extent this is idealization,
since in reality the beam current is produced by a large number of moving elec-
trons. If we consider the microstructure of the electron current, we ﬁnd that
electrons enter the undulator randomly in time and space. So, we can expect
that the FEL ampliﬁer should possess intrinsic noise properties. Here it is rel-
evant to remember that FELs form a separate class of vacuum-tube devices.
The analysis of the noise properties of traditional vacuum-tube ampliﬁers has
always been an important problem. This has been mainly connected with the
practical need for reducing the intrinsic noise of the ampliﬁer. The result of
the experience obtained during these investigations shows that there always
exists the fundamental eﬀect of shot noise originating from the random emis-
sion of the electrons from the cathode. When we analyze this eﬀect for the
parameters of traditional microwave ampliﬁers, we ﬁnd that it is complicated.
In particular, suppression of the shot noise in some frequency band can occur
due to space charge eﬀects. Besides the shot noise eﬀect, there are a num-
ber of diﬀerent sources of noise which inﬂuence the operation of traditional
vacuum-tube ampliﬁers.

Fluctuations of the electron beam current serve as the input signal in the
XFEL. As for the FEL ampliﬁer operating in short wavelength range, its
noise properties are deﬁned only by the shot noise. At optical frequencies the
quieting eﬀect of space-charge limitation seems negligible. An FEL ampliﬁer
which starts up from shot noise is frequently known as a self-ampliﬁed spon-
taneous emission (SASE) FEL. However, it is worth mentioning that such an
essentially quantum terminology does not reﬂect the actual physics of the pro-
cess. The ampliﬁcation process in the SASE FEL has its origin in the density
ﬂuctuations in the electron beam. The latter eﬀect is completely classical.

The shot noise is the pure ﬂuctuations in number which correspond to the
fact that photoemission is a random process. The rate at which electrons are
emitted from a photocathode is not constant in time. The emission process
is a random one and it is impossible to predict the time dependence of the
instantaneous current. Any such random ﬂuctuations in the beam current
correspond to an intensity modulation of the beam current at all frequencies
simultaneously - including, of course, the frequency to which the undulator is
tuned. When the electron beam enters the ﬁrst undulator, the presence of the

43

beam modulation at frequencies close to the resonance frequency initiates the
process of radiation.

The emission of electrons from the cathode is believed to be a Poisson pro-
cess, and from this assumption alone the total ﬂuctuation in current can be
deduced. Why is this the right rule, what is the fundamental reason for it,
and how is it connected to anything else? The explanation in deep down in
quantum mechanics. When electromagnetic ﬁelds are incident on a photosur-
face, a complex set of events can transpire. The major steps in this process
can be identiﬁed as absorption of a quantum light energy (i.e. a photon) and
the transfer of that energy to an excited electron, transport of the excited
electron to the surface, and ﬁnally, release of the electron from the surface.
When laser light having a deterministic variation of intensity over space and
time is incident on a photosurface, the ﬂuctuations of the photons obey Pois-
son statistics. This explains the relation between fundamental photon ”shot
noise” and shot noise in the electron beam.

When describing the physical principles, it is always important to ﬁnd a model
which provides the possibility of an analytical description without loss of es-
sential information about the features of the random process. In the ﬁrst anal-
ysis of the problem, we adopt some rather simplifying assumptions that are
only occasionally met in practice. We will investigate the klystron ampliﬁer
start-up from shot noise in the framework of the one-dimensional model which
assumes the input shot noise and output radiation have a full transverse co-
herence. This assumption allow us to assume that the input shot noise signal
is deﬁned by the value of total beam current. In reality the ﬂuctuations of
the electron beam current density are uncorrelated in the transverse dimen-
sion. Using the notion of the beam radiated modes, we can say that many
transverse radiation modes are radiated when the electron beam enters the
undulator. The one-dimensional model can be used for the calculations of sta-
tistical properties of transversely coherent output current. In practice such an
assumption is valid for the current at the exit of klystron with a thin electron
beam. During the ampliﬁcation process in a klystron, the number of trans-
verse modes decreases, and the contribution of the coherent radiation to the
total radiation power is increased up to full coherence. With this assumption,
attention can be concentrated completely on temporal coherence eﬀects.

We study the case when the initial modulation of the electron beam is deﬁned
by the shot noise and has a white spectrum. Since in the linear regime all the
harmonics are ampliﬁed independently, we can use the results of the steady-
state theory for each harmonic and calculated the corresponding Fourier har-
monics of the output current. The electric current in the time domain, I(t),

44

and its Fourier transform, ¯I(ω), are connected

I(t) =

1
2π

∞

Z−∞

¯I(ω) exp(

i ωt) d ω .

−

The klystron ampliﬁer has a response which can be economically expressed as
a frequency response curve G(ω). Thus, the Fourier harmonic of the current
at the dispersion section exit and the Fourier harmonic of the input current
are connected by the relation:

¯Iout(ω) = G(ω) ¯I(ω)

ω > 0 .

When ω < 0 the Fourier harmonic is deﬁned by the relation ¯I ∗(ω) = ¯I(
−
It is convenient to isolate explicitly the slowly varying complex amplitude

ω).

I(t)

−

I0 = ˜I(t)e− i ω0t + C.C. ,

where

˜I(t)e− i ω0t =

¯I(ω)e− i ωt d ω .

∞

1
2π

Z0

The real output current consists of a carrier modulation of frequency ω0 sub-
jected to random amplitude and phase modulation. The Fourier decomposition
of the output current contains frequencies spread about ω0. It is not possible in
practice to resolve the oscillations in I(t) that occur at frequency of the carrier
modulation. A good experimental resolving time is of order of picoseconds, at
least four orders of magnitude too long to detect oscillations at the frequency
ω0. It is therefore appropriate for comparison with experiment to average the
theoretical results over a cycle of oscillation of the carrier modulation. The
deviation δI = I(t)
I0 has a zero cycle-average. According to (49), the cycle
average of the square of the current deviation is

−

(δI)2 = 2

˜I(t)

2 .

|

|

Shot noise is a random statistical process and statements about shot noise are
probability statements. These are most easily handled using the concept of
a statistical ensemble, drawn from statistical mechanics. If the physical con-
struction of the injector and set of the external parameters (e.g supply voltage,
photoinjector laser beam parameters) which specify its state are known, then
these parameters deﬁne a deﬁnite statistical ensemble to which the injector
belongs.This ensemble consists of identical copies of the injector subject to

45

(48)

(49)

(50)

identical macroscopic external conditions. Any external property of the injec-
tor, e.g. its laser light on the photosurface, will depend, however, not only
on these given parameters but also on the exact microscopic internal state
of the photocathode, and each copy of the injector in the ensemble will lead
to a diﬀerent output. We shall always denote ensemble averages by
. In
practice the XFEL injector is required to produce a single electron bunch at
a repetition rate of 100 - 100 000 bunch/s and averaging symbol
simply
means the ensemble average over electron bunches.

h· · ·i

h· · ·i

6.1 Shot noise in a linear ampliﬁer

The output ﬂuctuations, expressed as current ﬂuctuations, have a mean square
value

∞

∞

(δIout)2

=

i

h

1
2π2

d ω

d ω′G(ω)G∗(ω′)

¯I(ω) ¯I ∗(ω′)

.

h

i

Z0

Z0

To calculate correlation of the spectral components of the output beam cur-
rent, we should consider a microscopic picture of the electron beam current
at the undulator entrance. We start the analysis for the case of a rectangular
electron pulse of ﬁnite duration T and then we go over to the limit of an in-
ﬁnitely long pulse. The electron beam current is made up of moving electrons
randomly arriving at the entrance of the undulator:

I(t) = (

e)

−

δ(t

tk) ,

−

N

Xk=1

· · ·

) is the delta function, (

e) is the charge of the electron, N is the
where δ(
number of electrons in a bunch and tk is the random arrival time of the electron
at the undulator entrance. The beam current averaged over an ensemble of
the bunches can be written in the form:

−

I(t)

=

h

i

(

e)N
−
T

=

I0

−

for

< t <

.

T
2

−

T
2

The electron beam current I(t) and its Fourier transform ¯I(ω) are connected
by:

¯I(ω) =

ei ωtI(t) d t = (

ei ωtk ,

∞

Z−∞

e)

−

N

Xk=1

46

I(t) =

¯I(ω)e− i ωt d ω = (

1
2π

∞

Z−∞

e)

−

δ(t

tk) .

−

N

Xk=1

Now we can calculate the ﬁrst-order correlation of the complex Fourier har-
monics ¯I(ω) and ¯I(ω′):

¯I(ω) ¯I(ω′)

= e2

h

i

exp(i ωtk −

i ω′tn)

.

+

N

N

*

Xk=1

Xn=1

Expanding this relation, we can write:

¯I(ω) ¯I(ω′)

h
= e2

N

i
exp[i(ω

*

Xk=1
N

Xk=1h

ω′)tk]

+ e2

−

+

exp(i ωtk −

i ω′tn)

+

*

Xk6=n

Xk6=nh

= e2

exp[i(ω

ω′)tk]
i

−

+ e2

exp(i ωtk)

exp(

ih

i ω′tn)

.

i

−

(51)

The probability of the arrival of an electron during a time interval (t, t + d t)
is equal to d t/T . It is easy to ﬁnd that

exp(i ωtk)

=

i

h

1
T

T /2

Z−T /2

ei ωtk d tk = ¯F (ω) ,

where

¯F (ω) =

−1

ωT
2 (cid:19)

(cid:18)

sin

ωT
2 (cid:19)

(cid:18)

.

Substituting (52) to the (51), we obtain:

When

N

¯F (ω)

2

1 ,

|

|

≪

h

h

i

i

¯I(ω) ¯I ∗(ω′)

= e2N ¯F (ω

ω′) .

−

47

¯I(ω) ¯I ∗(ω′)

= e2N ¯F (ω

ω′) + e2N(N

1) ¯F (ω) ¯F ∗(ω′) .

(53)

−

−

we can write the following expression for the ﬁrst-order spectral correlation:

(52)

(54)

(55)

Let us consider the case of an inﬁnitely long electron pulse with the homoge-
neous linear density and current I0. In this limit (T
, eN/T =
const.) the ﬁrst-order correlation of the complex Fourier harmonics has the
form:

→ ∞

→ ∞

, N

¯I(ω) ¯I ∗(ω′)

h

= eI0 lim
T →∞

i

T ¯F (ω
h

−

i

ω′)

= 2πeI0δ(ω

ω′) .

−

The following representation of the delta function has been used here:

δ(ω0 −

ω) =

sin[(ω0 −
π(ω0 −

ω)T
ω)

as T

.

→ ∞

The deﬁnition given in (57) can be used to prove the basic property of the
delta function. Let f (ω) be any function of ω that is non-singular at ω = ω0,
and consider the integral

f (ω)δ(ω0 −

ω) d ω =

ω2

1
π

lim
T →∞

Zω1

f (ω)

sin[(ω0 −
(ω0 −

ω)T ]
ω)

d ω .

Changing the variable of integration to x = (ω

ω0)T gives

−

f (ω)δ(ω0 −

ω) d ω =

=

f (ω0)

1
π

∞

Z−∞

sin x
x

1
π

lim
T →∞

(ω2−ω0)T

Z
(ω1−ω0)T

f ((x/T ) + ω0)

sin x
x

d x

d x = f (ω0) ,

proved ω1 < ω0 < ω2 .

(58)

ω2

Zω1

ω2

Zω1

Inclusion of the delta function in an integral therefore picks out the value of
the integrand at the point speciﬁed by the constant in the delta function.

Thus, if a current of mean value I0 ﬂows in the input of an ampliﬁer whose
frequency response curve is G(ω), the output ﬂuctuations are

(δIout)2

= 2

i

h|

h

˜I(t)

=

2

|

i

G(ω)

2 d ω .

|

eI0
π

∞

|

Z0

(56)

(57)

(59)

(60)

We can also write (59) in the form

(δIout)2

=

i

h

eI0
π |

G(ω0)

2 ∆ωA ,

|

48

where the eﬀective ampliﬁcation bandwidth of the klystron is deﬁned as

∆ωA =

∞

|
|

Z0

G(ω)
G(ω0)

|
|

2
2 d ω .

(δIin)2

= eI0∆ωA/(π)

h

i

We can further express this result by saying that the mean square value of the
output is equivalent to a ﬂuctuating current of mean square value

at the input. Note that it has not been necessary to make any assumptions
about the ampliﬁcation process. The result is completely general; that is, it
applies for any type of linear vacuum-tube ampliﬁer [15].

With the preceding results in hand, it should now be possible to estimate,
for example, the amplitude of initial beam density modulation ain. For this
purpose it is convenient to express the result (59) in a diﬀerent form. Noting
that

w we can write

(δIin)2

N −1

=

a2
ini

I 2
0 and ∆ωA/ω0 ≃

h

i

eω0/(I0πNw) = 1/Nc ,

(61)

h
a2
ini ≃

h

where Nc = NλNw/2 is the number of cooperating electrons, and Nλ =
2πI0/(eω0) is the number of electrons per radiation wavelength. If I0 = 100 A,
λ = 30 nm, and Nw = 100, appropriate substitutions in (61) show that the
a2
mean square value of input is about
ini ≃

10−7.

3

h

·

Now we return to the question about the electron bunch proﬁle. Equation
(53) is not only true at the arbitrary chosen rectangular bunch proﬁle, but of
course it is true at any other bunch proﬁle, and thus under the condition (54)
in the long electron bunch limit the output intensity ﬂuctuations are all the
same. (The ﬁnal statement (59) does not involve the bunch proﬁle function,
which appeared only in the intermediate arguments.) Let us discuss the region
of validity of the approximation (54) for diﬀerent bunch proﬁle functions. If
we consider the case of rectangular bunch proﬁle, we ﬁnd that the region of
applicability of condition (54) is less than that for the case of a Gaussian
bunch of the same duration. This is due to the fact that the bunch form factor
2, decreas more slowly with the increase in frequency. On the other
|
hand, in a realistic situation there is no sharp boundary of the bunch and the
T . When the
beam current falls to zero during some time interval ∆σT ≪
beam current at the edge falls in accordance with a Gaussian law, ∆σT must
obey the following conditions:

¯F (ω)

|

∆σT/T

1 , ∆σTω

1 , N/(∆σTω)4(ωT )2

≪

≫

1 .

≪

49

102 the value (∆σTω)4(ωT )2 is equal to 1016.
When ωT
As a rule, the number of particles in the bunch, N, is less than or about 1011,
so condition (54) is fulﬁlled.

104 and ω∆σT ≃

≃

6.2 Temporal coherence

The shot noise in the electron beam is a Gaussian random process. The
klystron ampliﬁer operated in linear regime can be considered as a linear ﬁlter
which does not change the statistics of the signal. As a result, we can deﬁne
general properties of the beam density modulation after the dispersion section
without any calculations. For instance, the square of instantaneous amplitude
of density modulation ﬂuctuates in accordance with the negative exponential
distribution. We can also state that the spectral density of the electron beam
modulation and ﬁrst-order time correlation function should form a Fourier
transform pair (this is the Wiener Khintchine theorem).

The correlation between the output currents at times t and t′ has the form:

δIout(t)δIout(t′)

=

˜Iout(t) ˜I ∗

out(t′)

i

h

h

exp[

i ω0(t

i

−

−

t′)] + C.C.

Using (48) and (56) we calculate the correlation between the complex ampli-
tude ˜I(t) and ˜I ∗(t′):

˜Iout(t) ˜I ∗
∞
1
4π2

h

=

out(t′)

d ω

Z0

i ω0(t

i
∞

exp[

−
d ω′ exp(

−

t′)]

−
i ωt + i ω′t′)G(ω)G∗(ω′)

¯I(ω) ¯I ∗(ω′)

i

h

d ω exp[

i ω(t

t′)]

G(ω)

2 .

−

−

|

|

(62)

Z0
∞

Z0

=

eI0
2π

We deﬁne the ﬁrst-order time correlation function as follows:

g1(t

t′) =

−

˜I(t) ˜I ∗(t′)

h
˜I(t)

i
˜I(t′)

2

|

i

2

|

ih|

h|

q

Using (50), (59) and (62) we can write

∞

d ω

|

G(ω)

2 exp[

i(ω

ω0)(t

−

t′)]

−

.

g1(t

−

t′) =

0
R

−

2

|

d ω

G(ω)

|

|
∞

0
R

50

The integral should go from 0 to
ﬁnished by that time , so we go instead to minus
If we do that we get

∞

, but 0 is so far from ω0 that the curve is all
- it makes no diﬀerence.

∞

∞

g1(t

−

t′) =

−∞
R

d(∆ω)

G(∆ω)

2 exp[

i(∆ω)(t

−

t′)]

−

.

|

|

d(∆ω)

G(∆ω)

2

|

|
∞

−∞
R

(63)

−

where ∆ω = (ω
ω0). Therefore, the slowly varying correlation function and
the normalized spectrum of the narrow band-signal are a Fourier transform
pair. It is seen from latter expression that the ﬁrst-order correlation function
1(t′
possess the property g1(t
t). When the klystron gain curve
is symmetrical with respect to the resonance frequency, ω0, the function g1 is
2 is symmetric
real. In our approximation, the klystron gain function
with respect to ∆ω and the integration therefore needs to be performed only
from 0 to
with the result being doubled. Inserting (46) into the integrand
(63) we get

t′) = g∗

G(∆ω)

∞

−

−

|

|

∞

0
R

g1(τ ) =

f (x) cos(xτ /α) d x

.

f (x) d x

∞

0
R

t′. The integral
Here we use the following notation α = πNw/ω0, τ = t
is a Fourier transform of f (x). In Fig. 7 we present a plot of ﬁrst-order time
correlation function. First, let us notice a remarkable feature of that plot.
> 2α = Nwλ/c. Of course we could
τ
The correlation function is zero for
predict such a result. Remembering that the synchronism takes place when
the electromagnetic wave advance the electron beam by one wavelength at one
undulator period (see section 3), we see that 2α is the total relative slippage
of the wave with respect to the electron beam.

−

|

|

In many applications it is desirable to have a precise and deﬁnite meaning
for the term ”coherence time.” Such a deﬁnition can be made in terms of
the complex correlation function, but there are a multitude of deﬁnitions in
t′) that can be imagined. However, in future discussions there
terms of g1(t
is one deﬁnition that arises most naturally and most frequently. Following the
approach of Mandel, we deﬁne the coherence time, τc, as

−

τc =

∞

|

Z−∞

g1(τ )

2 d τ .

|

Its magnitude is of the order of the inverse of the output frequency spread.

51

1.0

0.8

)

(

g

1

0.6

0.4

0.2

0.0

)
t
(

I

2

0.0

0.5

1.0

1.5

2.0

Fig. 7. First-order time correlation function

c

 

 

 

 

t

52

Fig. 8. Time dependence of the cycle-averaged output intensity modulation corre-
sponds to the shot noise ﬂuctuations in the input beam current, obtained from a
computer simulation. The dashed line shows the mean square value of the output
current ﬂuctuations averaged over a time long compared to τc

In all theory that follows, attention is restricted to modulated electron beams
whose frequency spreads are small compared with the mean frequency, that
is, where ω0τc is very much larger than unity. Figure 8 illustrates the type of
ﬂuctuations that occur in the cycle-averaged intensity modulation. The ﬁgure
has been constructed by a computer simulation of the ﬁrst cascade output in

≪

5 fs.

which the summation is carried out explicitly for the real number of electrons
in the electron bunch. The instantaneous intensity modulation varies in an
unpredictable manner about the average value, and it is this kind of variation
that characterizes the phenomenon as noise. It is seen that substantial changes
in the square value of amplitude occur over a time span τc, but this quantity
is reasonably constant over time intervals ∆t
τc. The value of the coherence
time for the case of klystron is given by τc = 0.94α = 0.47Nwλ/c. With the
numerical values Nw = 100 and λ = 30 nm the value of coherence time is
τc ≃
Our discussion of the current ﬂuctuations would be incomplete if we did not
refer the reader to another method of average calculation. The klystron output
coherence time, τc, is in femtosecond range and I0 = const. over the time span
τc is a good assumption in all practical problems. Clearly we can assume
that the current in question is adequately modelled as a ergodic and hence
stationary random process. A stationary process obeys statistical laws and
is subject to conditions that do not vary with time. For a stationary process
time and ensemble averages are equivalent. In this case averaging symbol
simply means the average over a period much longer compare with τc.

h· · ·i

7 Further applications of klystron

In the preceding sections we have given a simple discussion of a soft X-ray
cascade klystron ampliﬁer. We have not only neglected many features of the
klystron ampliﬁer, but we have also completely omitted some important ap-
plications. We shall mention three here: the frequency multiplier, a scheme for
femtosecond experiments, and multi-user soft X-ray facility.

7.1 Klystron frequency multipliers

The remaining application of the klystron which we shall mention is the fre-
quency multiplier. We have seen, in section 3, that the bunched beam at large
values of the bunching parameter has not only a fundamental radiation fre-
quency component, but also has considerable intensity in its harmonics. It is
then possible to have an input undulator operating at one frequency, and an
output undulator operating at a multiple of this frequency. The radiation in
the output undulator will then be excited by the harmonic component in the
electron beam, and the klystron will operate as a combination of frequency
multiplier and ampliﬁer. A possible application would be to the production of
very high frequencies. A klystron gets more and more diﬃcult to construct, as
the frequency becomes higher and higher, on account of the reduced period of

53

the undulators. If we use a frequency multiplier klystron to reach the highest
frequencies, it is only the output undulator which must be made with the
smallest period; the cascade undulators, operating at a lower frequency, can
be made with larger period, and this can accommodate an injector with larger
emittance and make the source easier to construct.

The idea of using two undulators, with the second undulator resonant to one
of the harmonics of the ﬁrst one (the so-called ”after-burner” scheme), was
considered in [16–18]. The technique of using an conventional FEL ampliﬁer
as a frequency multiplier relies on the fact that spatial bunching in the ex-
ponential gain regime can be very strong. The ﬁrst uniform undulator is long
enough to reach saturation and produce strong spatial bunching in harmon-
ics. The bunched beam generates coherent radiation in the second undulator
which immediately follows the ﬁrst one. The main problem with this approach
is the large induced (correlated) energy spread which will be generated by the
bunching of the electron beam at the fundamental frequency. While this en-
ergy spread is necessary for the bunching, it degrades the performance of the
radiation section at the harmonic frequency.

The problem to be solved is how to prolong the interaction of the bunched
electron beam with the electromagnetic wave in the harmonic radiator undu-
lator. The present section is concerned with frequency doubler, designed for
conditions approximating maximum eﬃciency. A reliable method to increase
the frequency doubler eﬃciency is to use a cascade klystron in which the input
undulator operates at the fundamental resonance, the penultimate undulator
operates at the fundamental harmonic, and the output undulator operates at
the second harmonic. In particular it can be shown that a so-called 1-1-2 SASE
scheme may operate with rather high eﬃciency in the soft X-ray wavelength
range. (The numbers 1,2 here designate the resonant harmonic number for
each undulator.) The klystron gain is controlled in such a way that the max-
imum energy modulation of the electron beam at the penultimate undulator
exit is about equal to the local energy spread. This is much smaller than the
induced energy spread of the electrons at the exit of a saturated conventional
SASE FEL. As a result, the operation of a frequency doubler is based on
prolonged interaction of the bunched electron beam with the electromagnetic
wave in the harmonic radiator. In contrast to the after-burner method, in a
two-cascade 1-1-2 scheme frequency doubler operation is based on prolonged
interaction of the bunched electron beam with the electromagnetic wave in
the output undulator and copious coherent emission at double frequency is
produced. The doubler eﬃciency can be optimized by monitoring the output
radiation intensity at double frequency as a function of the compaction factor
of the ﬁrst and second dispersion section. In [14] we have described an eﬀective
frequency doubler for SASE FELs. For the ﬁrst time the frequency multipli-
cation scheme has been analyzed for SASE FELs. Computer modeling with
time-dependent code FAST has demonstrated that the ﬁnal output power of

54

a 1-1-2 klystron doubler is no smaller than that which could be produced by
a 2-2-2 klystron with the same electron beam parameters.

7.2 Scheme for femtosecond experiments

Time-resolved experiments are used to monitor time-dependent phenomena.
The standard technique for high-resolution time-resolved experiments is the
pump-probe scheme in which a process is started by a short pulse of radia-
tion (pump) and the evolution of the process is then observed (probed) after
a delay by means of a second pulse of radiation, generally at another pho-
ton energy. The obvious temporal limitation of the visible pump/X-ray probe
technique is the duration of the X-ray probe. Here we will concentrate on the
performance which can be obtained by a klystron XFEL operating without
bunch compression in the injector linac. At these sources, the X-ray pulse du-
ration is about 10 ps. This is longer than the timescale of many interesting
physical phenomena. The new principle of pump-probe techniques described
below oﬀers a way around this diﬃculty.

Our studies have shown that the soft X-ray cascade klystron holds great
promise as a source of radiation for generating high power single femtosec-
ond pulses. Our femtosecond soft X-ray facility concept is based on the use of
an X-ray SASE FEL combined with a femtosecond quantum laser [19]. The
operation of a femtosecond soft X-ray SASE FEL is illustrated in Fig. 9. An
ultrashort laser pulse is used to modulate the density of electrons within the
femtosecond slice of the electron bunch at a frequency ωopt. The seed laser
pulse will be timed to overlap with the central area of the electron bunch.
This ultrashort laser pulse serves as a seed for a modulator which consists
of an uniform undulator and a dispersion section. The interaction of seed
pulse with the electron beam produces an energy modulation at ωopt. This en-
ergy modulation is converted into spatial bunching in the dispersion section.
Density modulation at the modulator exit is about 20 %. The energy modu-
lation introduced by the modulator is smaller than the local energy spread.
Following the modulator the beam enters the ﬁrst undulator of the klystron
ampliﬁer which is resonant with soft X-ray radiation at frequency ω0. The
process of ampliﬁcation in the soft X-ray klystron ampliﬁer develops in the
same way as was explained in previous sections: ﬂuctuations of the electron
beam current density serve as the input signal. At the chosen level of density
(energy) modulation the SASE process develops nearly in the same way as
with a non-modulated electron beam because of the large ratio of cooperation
length to optical wavelength. By the time the beam is bunched in the klystron
cascades, at frequency ω0, the density modulation amplitude has reached sat-
uration. This leads to amplitude modulation of the density at the sidebands
ωopt. The sideband density modulation takes place at the part of the
ω0 ±

55

Fig. 9. Scheme for time-resolved experiments based on the generation of femtosecond
pulses by sideband-seeded soft X-ray cascade klystron ampliﬁer. In this scheme, a
femtosecond soft X-ray pulse is naturally synchronized with the femtosecond optical
pulse from the seed laser and cancels jitter

electron pulse deﬁned by the duration of the seed laser pulse, which is much
shorter than the electron pulse. Following the last cascade the beam enters
ωopt. Because
the output undulator which is resonant at the frequency ω0 −
the beam has a large component of bunching at the sideband, coherent emis-
sion is copiously produced within the femtosecond slice of the electron bunch.
Analytical methods are of limited use in to the study of the sideband-seeded
SASE FEL and numerical simulations must be used. Simulations with time-
dependent code FAST provide a ”full physics” description of the process in a
sideband-seeded SASE FEL. The results of numerical simulations conﬁrm our
simple physical considerations [19].

We assume that the SASE bandwidth is much less than the separation of
the sidebands from the main peak. This requirement is of critical importance
to the overall performance of the femtosecond SASE FEL facility. In this
case, the (output) undulator can be used to distinguish the sideband density
modulation from the density modulation at the central frequency. Obviously,
this requirement is easier to achieve for long radiation wavelengths. For 300 nm
laser radiation and for 30 nm output radiation, for example, the ampliﬁcation
bandwidth of the cascade klystron must be much smaller than 10 %. This
condition may be easily satisﬁed in practice. The long (unbunched) electron
pulse is one of the advantages of the adopted FEL design. Since the electron
pulse duration (about 10 ps) is much longer than the time jitter of the electron
and seed laser pulses (about
1 ps), the synchronization of the optical laser
with the electron pulses is not a problem.

±

Pump-probe techniques which are commonly used with optical lasers, are
highly desirable in order to make full use of the femtosecond soft X-ray pulses.

56

Fig. 10. Description of the sideband generation for the case of the density modulation
as initial condition

Since, in this case, precise timing is needed with a jitter of less than 10 fs, in
[19] we suggested to combine the femtosecond soft X-ray pulses generated by
the sideband-seeded SASE FEL with optical pulses generated by the seed laser
system. It should be emphasized that in the proposed scheme a femtosecond
soft X-ray pulse is naturally synchronized with his femtosecond optical pulse
and cancels jitter. This development of XFEL based pump-probe experiments
allow us to investigate phenomena at timescale down to 100 fs.

7.3 Multi-user distribution system for XFEL laboratory

An X-ray laboratory should serve several, may be up to ten experimental
stations which can be operated independently according to the needs of the
user community. On the other hand, the multi-user distribution system has
to satisfy an additional requirement. Passing the electron bunch through the
bending magnets must avoid emittance dilution due to coherent synchrotron
radiation (CSR) eﬀects. For very short bunches and very high peak current,
CSR can generated energy spread in the bending magnets and thus dilute
the horizontal emittance. As a result, the prefered layout of a conventional
SASE FEL is a linear arrangement in which the injector , accelerator, bunch
compressors and undulators are nearly collinear, and in which the electron
beam does not change direction between accelerator and undulators.

The situation is quite diﬀerent for the klystron ampliﬁer scheme proposed
in our paper. Since it operates without bunch compression in the injector
linac, the problem of emittance dilution in the bending magnets does not ex-
ist. An electron beam distribution system based on unbunched electron beam
can provide eﬃcient ways to generate a multi-user facility - very similar to
present day synchrotron radiation facilities. A possible layout of a soft X-ray

57

Fig. 11. Diagram of a possible fourth-generation synchrotron facility using sponta-
neous emission free-electron laser klystron ampliﬁers

FEL laboratory based on an electron ring distribution system is shown in Fig.
11. The layout of the laboratory follows a similar approach as that used for
synchrotron light sources. The SASE FEL user facility consists of an injector
linac and electron beam distribution system. The injector is composed of a
RF gun with photocathode and a main (superconducting) linac. In order to
make eﬃcient use of the new source it is proposed to segment the full cir-
cumference of a distribution system into arcs which are repeated a number of
times to form a complete ring. Each cell includes a two-cascade klystron and
a bending magnet. A speciﬁc realization of the electron ring cell is sketched in
Fig. 12. The electron beam transport line guiding electrons from the injector
linac to the experimental hall is connected tangentially to one of the straight
sections of the electron ring. In order to obtain a useful separation between
the experimental areas behind the photon beam lines, an angle of 36 degrees
between two neighboring lines would be desirable. Thus, ten beam lines can
be installed on a complete electron ring. Using klystron (electromagnetic) dis-
persion sections in each cell as switching elements it is possible to quickly
switch the FEL photon beam from one experiment to the other, thus provid-
ing multi-user capability. Users can deﬁne the radiation wavelength for their
experiment independently of each other to a very large extent, since they use
diﬀerent undulators. Injector linac and electron beam transport lines operate
at ﬁxed parameters. At a ﬁxed electron energy the magnet gap of the klystron
undulators can be varied mechanically for wavelength tuning. This design
makes it possible to make various wavelengths of SASE radiation available in
the XFEL laboratory quasi-simultaneously. It is a great advantage that injec-
tor and electron beam transport lines in the new scheme of multi-user facility
operate at ﬁxed parameters and that an ”electron switchard” is not required.

When a relativistic electron beam passes through the undulator, it emits in-
coherent radiation. This process leads to an increase of the energy spread in

58

Fig. 12. Electron ring cell design. Using a klystron electromagnetic dispersion sec-
tion as a switching element it is possible to quickly switch oﬀ (on) the cell klystron
ampliﬁer thus providing multi-user capability. This design makes it possible to
make various wavelengths of SASE radiation available in the XFEL laboratory
quasi-simultaneously

the beam due to quantum ﬂuctuations of the undulator radiation. This eﬀect
grows signiﬁcantly with an increase in electron beam energy, strength ﬁeld
and length of the undulator. This eﬀect should be carefully taken into ac-
count when designing multi-user distribution system. For the case of planar
undulator the expression for the rate of energy diﬀusion can be written in the
following form[20]:

d
h

(∆γ)2
d z

i

=

7
15

λc
2π

reγ4k3

wK 2F (K) ,

(64)

≫

where λc is the Compton wavelength, re is the classical electron radius, F (K)
≃
1.2K for K
1. The next numerical example illustrates the amplitude of the
eﬀect. If γ = 103, K = 1.42, λw = 3 cm, and the total undulator length is
equal to 100 m, appropriate substitution in (64) shows that the energy spread
increase due to quantum ﬂuctuations is about
1 keV at the end
of the 10th klystron ampliﬁer, and has a negligible eﬀect on the klystron per-
formance.

h
q

i ≃

(∆

)2

E

8 Conclusion

The high-gain klystron ampliﬁer described in this paper is an attractive alter-
native to other FEL conﬁgurations for operation in short wavelength range.
An distinguishing feature of the klystron ampliﬁer is the absence of apparent
limitations which would prevent operation without bunch compression in the

59

injector linac. We have illustrated the proposed cascade klystron scheme us-
ing the parameters of the TESLA Test Facility. Although the present work
is concerned primarily for use in the soft X-ray spectrum, its applicability is
not restricted to that range, for example an X-ray SASE FEL is a suitable
candidate for application of cascade klystron scheme described here.

We thank R. Brinkmann, B. Faatz, J. Feldhaus, G. Geloni, M. Koerfer, J.
Pﬂueger, J. Rossbach for many useful discussions. We thank C. Pagani, J.R. Schnei-
der and D. Trines for interest in this work.

Acknowledgments

References

[1] TESLA Technical Design Report, DESY 2001-011, edited by Richard et al.,

and http://tesla.desy.de

[2] The LCLS Design Study Group, LCLS Design Study Report, SLAC reports
SLAC-R521, Stanford (1998) and http:www-ssrl.slacstanford.edu/lcls/CDR

[3] C. Pagani et al., Nucl. Instrum. Methods A 455(2000)733

[4] J.C. Gallardo, C. Pellegrini, Nucl. Instrum. Methods A 296(1990)448

[5] V.N. Litvinenko, Nucl. Instrum. Methods A 304(1991)463

[6] V.A. Bazylev, M.M. Pitatelev, Nucl. Instrum. Methods A 358(1995)64

[7] G.R. Neil, H.P. Freund, Nucl. Instrum. Methods A 475(2001)381

[8] N. A. Vinokurov, Nucl. Instrum. Methods A 375(1996)264

[9] J. Chen, et al., Nucl. Instrum. Methods A 375(1996)299

[10] Ya. S. Derbenev, A. M. Kondratenko and E. L. Saldin, Nucl. Instrum. Methods

193(1982)415

[11] V. Ayvazyan et al., Phys. Rev. Lett. 88(2002)194802

[12] E.L. Saldin, E.A. Scheidmiller, M.V. Yurkov, The physics of Free Electron

Lasers, Springer, Berlin-Heiderberg-New York, 1999

[13] P.L. Czonka, Part. Accel. 8, 225 (1978)

[14] J. Feldhaus et al., Preprint DESY 03-092, DESY, Hamburg, 2003

[15] D. A. Bell, Electrical noise, D. Van Nostrand Company, LTD, London, 1960

60

[16] R. Bonifacio, L. De Salvo, and Pierini, Nucl. Instrum. Methods A 293(1990)627

[17] Ciocci, et al., IEEE J. Quantum Electron. 31 (1995)1242

[18] W. M. Fawley et al., Proceedings of the IEEE 1995 Particle Accelerator

Conference, 1996, p.219

[19] E.L. Saldin, E.A. Scheidmiller, M.V. Yurkov, Optics Commun. 205(2002)385

[20] E.L. Saldin, E.A. Scheidmiller, M.V. Yurkov, Nucl. Instrum. Methods A

381(1996)545

61

