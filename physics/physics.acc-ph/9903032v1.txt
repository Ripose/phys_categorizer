9
9
9
1
 
r
a

M
 
8
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
2
3
0
3
0
9
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Hamiltonian Methods for the Study of
Polarized Proton Beam Dynamics in
Accelerators and Storage Rings

V.V. Balandin and N.I. Golubeva

Institute for Nuclear Research of RAS,

60th October Anniversary Pr., 7a, Moscow 117 312, Russia

Abstract

The equations of classical spin-orbit motion can be extended to a
Hamiltonian system in 9-dimensional phase space by introducing
a coupled spin-orbit Poisson bracket (18) and a Hamiltonian
function (20). After this extension and by establishing connections
between initial and extended systems it becomes possible to apply the
methods of the theory of Hamiltonian systems to the study of
polarized particle beam dynamics in circular accelerators and storage
rings. Some of those methods have been implemented in the com-
puter code FORGET-ME-NOT [1, 2].

1

Contents

1 Introduction

5
5

7
7
8

1.1 The Classical Equations of Spin-Orbit Motion . . . . . . . . .

2 The Hamiltonian Extension of the Equations of Classical

Spin-Orbit Motion
2.1 Poisson Bracket . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Hamiltonian Dynamical Systems . . . . . . . . . . . . . . . . .
2.3 Hamiltonian Extension of the Equations of Classical Spin-

Orbit Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

2.4 Connection between the Triangular System and its Hamilto-

nian Extension . . . . . . . . . . . . . . . . . . . . . . . . . . 11

3 Hamiltonian Methods for the Extended System

13

3.1 Degenerate Poisson Brackets and Reduction of the Order of a

Hamiltonian System . . . . . . . . . . . . . . . . . . . . . . . 13

3.2 Degenerate Poisson Brackets for Global Variables, or Local

Darboux Coordinates ? . . . . . . . . . . . . . . . . . . . . . . 13

3.3 The Properties of Solutions of the Extended Equations of Spin-
Orbit Motion Independent of the Speciﬁc Choice of the Hamil-
tonian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

4 Canonical Transformations and the Introduction of Machine

Coordinates for Circular Accelerators
18
4.1 Canonical Transformations of Phase Space . . . . . . . . . . . 19
4.2 Nonautonomous Canonical Transformations
. . . . . . . . . . 23
4.3 The Coordinate Frame Connected with the Closed Design Orbit 26
4.3.1 Transformation of Orbital Variables . . . . . . . . . . . 26
4.3.2 Transformation of Spin Variables and Longitudinal Mo-

mentum . . . . . . . . . . . . . . . . . . . . . . . . . . 27

4.4 Change of Independent Variable in Nonautonomous Hamilto-

nian Equations

4.5 Length Along the Design Orbit as Independent Variable
4.6 The Hamiltonian in New Variables up to First Order with

. . . . . . . . . . . . . . . . . . . . . . . . . . 28
. . . 31

Respect to Spin Variables

. . . . . . . . . . . . . . . . . . . . 32

5 Linear Diﬀerential Equations of Spin Motion

34

2

5.1 Matrix Representation of the Hamiltonian Function and Sim-

ple Properties of Solutions . . . . . . . . . . . . . . . . . . . . 35
5.2 Linear Equations of Spin Motion with Periodic Coeﬃcients . . 37
. . . . . . . . . . . 37
5.2.1
5.2.2 Real Jordan Canonical Forms of SO(3) Matrices . . . . 38
5.2.3
Skew-symmetric Real Logarithm of SO(3) Matrices . . 40
5.2.4 Normal Forms for Hamiltonians of Linear Equations of

Some Properties of SO(3) Matrices

Spin Motion with Periodic Coeﬃcients . . . . . . . . . 41

5.3 Connection between the SO(3) and SU(2) Groups and the Lax

Form of the Equations of Spin Motion . . . . . . . . . . . . . 43

6 Normal Forms for the Spin-Orbit Hamiltonian

45

6.1 Canonical Transformations of Spin-Orbit Variables which Map

the Origin into Itself
. . . . . . . . . . . . . . . . . . . . . . . 46
6.1.1 Linear Canonical Transformations . . . . . . . . . . . . 46
6.1.2 Factorization Theorem . . . . . . . . . . . . . . . . . . 48
6.2 General Description of the Normal Form Algorithm . . . . . . 49
. . . . . . . . . . . . . . . . 50
6.2.1 Extension of Phase Space
6.2.2 Linear Normalization . . . . . . . . . . . . . . . . . . . 51
6.2.3 Recursive Loop of Nonlinear Normalization . . . . . . . 52
6.2.4 Normalization Theorem . . . . . . . . . . . . . . . . . 56

7 General Properties of Systems whose Hamiltonians are Nor-

mal Forms
56
7.1 Normal Forms and Invariant Functions . . . . . . . . . . . . . 57
7.2 Action-Angle Type Coordinates . . . . . . . . . . . . . . . . . 58
. . . . . . . . . . . . . . . 59
7.3 Normal Form in Nonresonant Case
. . . 61
7.4 Normal Form in the Case of a Single Isolated Resonance
Single Resonance Between Orbital Tunes . . . . . . . . 62
Single Spin-Orbit Resonance . . . . . . . . . . . . . . . 63

7.4.1
7.4.2

8 Methods of Numerical Integration

65
8.1 Canonical Numerical Methods for Hamiltonian Equations . . . 65
8.1.1 Recursively Generated High Order Canonical Integrators 66
8.1.2 Low Order Canonical Integrators for Equations of Clas-

sical Spin-Orbit Motion . . . . . . . . . . . . . . . . . 68

8.2 Approximately Canonical Numerical Methods for Short-Term

Tracking (Numerical Methods for the Triangular System) . . . 70

3

9 Additional Transformations of the Spin-Orbit Hamiltonian 72
. . . . . . . . . . 73

9.1 Closed Design Orbit and Reference Particle
9.2 Deviations of Orbital Coordinates from the Solution for the

Reference Particle . . . . . . . . . . . . . . . . . . . . . . . . . 77
9.3 Scaling of the Orbital Variables . . . . . . . . . . . . . . . . . 78
9.4 The General Form of the Spin-Orbit Hamiltonian in New Co-

ordinates up to First Order with Respect to Spin Variables . . 79

10 Acknowledgments

A How to Transform the Equations of the Electromagnetic Field
to Curvilinear Coordinates Associated with the Closed De-
sign Orbit

B Simple Canonical Coordinates for the Periodic Solution

C Sketch of the Proof of the Factorization Theorem

D How to Integrate Linear Equations of Spin Motion in Quadra-

tures if We Know their Partial Solution

E Noncanonical Scaling of the Orbital Variables in the Case of

the Simplest Storage Regime

F FORGET-ME-NOT, a Computer Code for the Study of Po-

larized Beam Dynamics

82

83

85

88

91

96

98

4

1 Introduction

We began writing this paper in the summer of 1994 year following the
suggestion of D.Barber to summarize our results of the investigation of the
dynamics of unpolarized and polarized proton beams, which we obtained
during 1991-1993 and which were only partly available and only in the very
compressed form of conference proceedings.

After starting this work it became clear that it would be better to sep-
arate the available material into several papers, and for the ﬁrst one we
chose those results which can be incorporated together with help of the re-
search technique which we call Hamiltonian extension of the equations
of classical spin-orbit motion. Such important topics as the computa-
tion and analysis of the one-turn Taylor maps for spin and orbit motion,
spin dependent invariant functions and their connection with the Derbenev-
Kondratenko vector, the normal form algorithm for equations of spin motion
in the SU(2) representation and, of course, many more practical subjects
related to the question how to preserve the polarization of a particle beam
during acceleration will not appear in the present paper and will be published
later.

For various reasons the publication has been prolonged for almost three
years, and now we are glad to be free from this, but, at the same time,
we are not too enthusiastic about the necessity to write up the remaining
unpublished results.

1.1 The Classical Equations of Spin-Orbit Motion

The quasi-classical description of the motion of a relativistic nonradiat-
ing point particle with spin in accelerators and storage rings includes the
equations of orbit motion which we write in the Hamiltonian form

d~q
dt

=

∂Horbt
∂~p

,

d~p
dt

=

∂Horbt
∂~q

−

and the Thomas-BMT equation [3, 4] for the classical spin vector ~s

(1)

(2)

Here

d~s
dt

=

~W

h

~s

×

i

Horbt = c

~π 2 + m2

0 c2 + e Φ

q

5

e
m0γc 


~W =

(1 + γG) ~

~
~π
G
B
(cid:16)
(cid:17)
m2
0c2(1 + γ) −

~π

·

1
m0c  

G +

1
1 + γ !

~
E

~π
h

−

B −


i

is the time. The vectors ~q = (q1, q2, q3) and ~p = (p1, p2, p3)
and t
are canonical position and momentum variables, and ~s = (s1, s2, s3) is the
classical spin vector of length ¯h/2 . The parameters e and m0 are the charge
2)/2
and the rest mass of the particle, c is the velocity of light, G = (g
which quantiﬁes the anomalous spin g factor, γ is the Lorentz factor, ~π
is kinetic momentum vector, ~
are the electric and magnetic ﬁelds,
E
and ~A and Φ are the vector and scalar potentials.

and ~
B

−

×

= curl ~q ~A

~
B

=

~
E

−

grad ~q Φ

1
c

∂ ~A
∂t

−

~π = ~p

e
c

~A

−

(3)

(4)

(5)

γ =

eΦ

Horbt −
m0c2

2

~π
m0c !

 

1 +

= v
u
u
t

Later on we will refer to the system (1)-(2) as the triangular system (the
equations of spin motion contain the orbital variables but the evolution of
orbital variables does not depend on the spin degree of freedom).

Remark: In the Hamiltonian picture of orbital motion we cannot deﬁne
the Lorentz factor (5), in the usual way, in terms of the absolute value v of
the particle velocity ~v

1
(v/c)2

,

v2 = ~v

~v

·

γ =

1
q

−
but instead need to express it through canonical variables.

6

2 The Hamiltonian Extension of the Equa-

tions of Classical Spin-Orbit Motion

The Poisson bracket lies at the basis of the modern point of view of the
Hamiltonian formalism. The idea of axiomatic introduction of the bracket
very likely belongs to Dirac. In this section we recall the necessary deﬁnitions
from the theory of Hamiltonian systems and introduce coupled spin-orbit
Poisson brackets which give us the canonical extension of the equations of
classical spin-orbit motion.

2.1 Poisson Bracket

Let M be a ﬁnite-dimensional manifold (phase space) and C ∞(M) be

the linear space of smooth functions f : M

R . The binary operation

,

{∗

∗}

×

: C ∞(M)

C ∞(M)

C ∞(M)

→

→

called the Poisson bracket satisﬁes the relations

bilinearity :

λf + µg, h
}

{

= λ

f, h
}

{

+ µ

g, h
}

{

antisymmetry :

f, g

=

}

g, f

}

−{

Leibnitz rule :

f, g

h
}

·

=

f, g

h + g

} ·

f, h
}

· {

{

{

{

+

Jacobi identity :

f, g

, h
}

}

{{

h, f

, g

+

}

}

{{

g, h
}

{{

, f

}

= 0

where λ, µ are arbitrary constants.

Let ~z be local coordinates on a manifold M . From the bilinearity and

Leibnitz rule it follows that for any ﬁxed function h , the linear operator

h,

{

∗}

: C ∞(M)

C ∞(M)

→

is a diﬀerentiation and hence may be represented in the form (see, for example
[14, 15])

h,

{

∗}

= Ah

i (~z)

∂
∗
∂zi

7

(6)

(here and further on the summation over repeated indices is implied). From
(6) one ﬁnds by direct substitution of functions zi that

Comparing (6) and (7) we obtain

A h

i (~z ) =

h, zi}

{

h,

{

∗}

=

∂
∗
∂zi

{

h, zi}
. By successively applying (8) to the

(8)

Consider the Poisson bracket
f,
expressions

and

f, g

}

we obtain

{

∗}

f, g

=

{

}

{
, zj}
{∗
f, zj}

{

∂g
∂zj

=

zi, zj}

{

∂f
∂zi

∂g
∂zj

Now we introduce the skew-symmetric matrix ˆJ = (
{
the Poisson bracket (9) in the form

zi, zj}

) and represent

f, g

= grad ~z f

{

}

·

ˆJ grad ~z g

Thus in a ﬁxed local coordinate system ~z , the Poisson bracket is completely
deﬁned if we know the values ˆJ ij =

as functions of ~z .

{
The matrix ˆJ is called the structural matrix of a Poisson bracket.

zi, zj}

2.2 Hamiltonian Dynamical Systems

Again let ~z be local coordinates on a manifold M . Hamiltonian

systems by deﬁnition have the form:

(7)

(9)

(10)

(11)

d~z
dτ

=

~z, H
{

}

where H = H(τ, ~z) is an arbitrary function (possibly depending explicitly
on τ 1), called the Hamiltonian. Using the representation of Poisson bracket
(10) we can rewrite equations (11) as

d~z
dτ

= ˆJ(~z ) grad ~z H
1Until now the equations of classical spin-orbit motion (1)-(2) are written using the
time t as independent variable, but later on we will change this independent variable to
be a path length along the design orbit z. This is the reason for us, here and further on,
to formulate general results, which are not sensitive to the speciﬁc form of the variables
and Hamiltonians used, we denote the independent variable as τ .

(12)

8

Let h = h(~z ) be an arbitrary function and ~z(τ ) be the solution of the
system (11) with initial condition ~z(τ0) = ~z0 . It is clear that the derivative
of the function h(τ ) = h(~z(τ )) for the Hamiltonian system (11) has the
form

dh
dτ

=

h, H

{

}

From (13) we can obtain the expansion of h(τ ) with respect to a small

τ = τ

△

τ0

−

h(τ ) = h(τ0) +

τ

h, H

(τ0) + O(

△

{

}

τ 2)

△

Writing f (τ ) and g(τ ) instead h(τ ) in (14) and calculating their Poisson
brackets with respect to the variables ~z0 , we see that

(13)

(14)

f, g

(τ ) =

f, g

(τ0) +

{

}

{

}

+

τ (

f,

g, H

△

{

{

}}

(τ0) +

f, H

, g

(τ0)) + O(

{{

}

}

τ 2)

△

(15)

Applying Jacobi identity to the terms of order

τ in (15) one ﬁnds

f, g

(τ ) =

f, g

(τ0) +

{

}

τ

f, g

△

{{

}

(τ0) + O(

τ 2)

△

△
, H

}

{
or, equivalently

}

f, g

(τ )

{

}

f, g

(τ0)

}

− {
τ
△

=

f, g

, H

(τ0) + O(

τ )

{{

}

}

△

(16)

The formula (16) in the limit when
property of the solution of the Hamiltonian system:

→

△

τ

0 gives us the fundamental

The ﬂow of a Hamiltonian system preserves the Poisson bracket:2

d
dτ {

f, g

=

f, g

, H

}

{{

}

}

(17)

2We use the term ′′preserve′′ to mean that the algebraic form is not changed.

9

2.3 Hamiltonian Extension of the Equations of Classi-

cal Spin-Orbit Motion

We now introduce the Poisson bracket3

f (~z), g(~z)

= f ~q ·

g ~p −

f ~p ·

g ~q + [ f ~s ×

}

g ~s ]

~s

·

{

(18)

in the 9-dimensional phase space ~z = (~x, ~s) of 6 orbital variables ~x = (~q, ~p)
and 3 spin variables ~s
and consider a Hamiltonian system of ordinary
diﬀerential equations

d~z
dt

=

~z, H
{

}

with the Hamiltonian function

In the variables ~q, ~p and ~s the system (19) can be written as

(19)

(20)

(21)

(22)

(23)

and we will understand the equations (21)-(23) as the Hamiltonian exten-
sion of the equations of classical spin-orbit motion (1)-(2).

Note that the matrix ˆJ(~z) for the spin-orbit Poisson bracket (18) has
3Note that when applied to the spin variables only, the Poisson bracket (18) gives the

usual result

si, sj

= ǫijk sk.

{

}

H = Horbt(t, ~x) + ~W (t, ~x)

~s

·

d~q
dt

=

∂Horbt
∂~p

+

∂

~s

~W
·
∂~p

(cid:16)

(cid:17)

d~p
dt

=

∂Horbt

−

∂~q −

∂

~s

~W
·
∂~q

(cid:16)

(cid:17)

d~s
dt

=

~W
h

~s

×

i

10

the form

ˆJ(~z) =

(24)

0
0
0
1
−
0
0
0
0
0




















0
0
0
0
1
−
0
0
0
0

0 1 0 0
0 0 1 0
0 0 0 1
0 0 0 0
0 0 0 0
1 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0

−

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
s2
s3 −
0
s1
s3
0
s1
s2 −
0




















−

and is not a constant matrix (in contrast to the case of classical Poisson
brackets), but depends on spin variables. The structural matrix (24) can
also be written in the more compact block diagonal form

ˆJ(~z) = diag (J, Js(~s ))

where a 6

6 constant matrix J is the symplectic unit [12] and

×

s2
s3 −
0
s1
s3
0
−
s1
s2 −
0
2.4 Connection between the Triangular System and its

Js(~s ) = 









Hamiltonian Extension

We now wish to point out some ways for establishing the connections
between properties and solutions of the system (21)-(23) and the initial tri-
angular system (1)-(2) (truncation procedures). We will do this without
ascribing any physical sense to the spin dependent members in the
right sides of equations (21), (22) 4.

Because the statements, which will be listed below, are connected not
with the speciﬁc form of the spin-orbit Hamiltonian, but only with proper-
ties of the spin-orbit Poisson bracket, let us consider an arbitrary smooth
Hamiltonian function possibly depending nonlinearly on the variables ~s

H = H(τ, ~z) = H(τ, ~x, ~s )

(25)
4 Note that some authors (see, for example [33, 34]) ascribe the spin dependent members
on the right sides of equations (21)-(22) to a quasi-classical eﬀect of the spin on the orbit
motion, so that in that case no truncation procedures are needed.

11

and introduce, in correspondence to the Hamiltonian system

d~x
dτ

= J grad ~x H,

= Js(~s ) grad ~s H

(26)

the triangular truncated system deﬁned as

= J

(grad ~x H)

·

|~s=~0 ,

= Js(~s)

(grad ~s H)

·

|~s=~0

(27)

d~s
dτ

d~s
dτ

~z(τ, τ0, ~z0) = (~x(τ, τ0, ~x0, ~s0), ~s(τ, τ0, ~x0, ~s0))

is the solution of (26) which passes through the point ~z0 = (~x0, ~s0) when
τ = τ0 , then

~z∗(τ, τ0, ~z0) = (~x∗(τ, τ0, ~x0), ~s∗(τ, τ0, ~x0, ~s0))

d~x
dτ

a) If

where

~x∗(τ, τ0, ~x0) = ~x(τ, τ0, ~x0, ~0)

and ~s∗(τ, τ0, ~x0, ~s0) =

gives us the solution of (27).

be represented in the form

b) If the system (26) admits an invariant function V (τ, ~z ) which can

V (τ, ~z ) = Vm(τ, ~z ) + V>m(τ, ~z )

where Vm is a homogeneous polynomial of degree m in variables ~s , and

~s0

∂~s
∂~s0 (cid:12)
~s0=~0 ·
(cid:12)
(cid:12)
(cid:12)
(cid:12)

lim
|~s|→0

m = 0

V>m
~s
|

|

then Vm(τ, ~z ) is a ﬁrst integral of the system (27).

c) If ~x(τ, τ0, ~x0) def= ~φ(τ, τ0, ~x0) is a solution of the ﬁrst of the equations
(27), then the system (27) can be written as a family of Hamiltonian systems
(τ0, ~x0) with the Hamiltonian
of the type (26) depending on parameters
function

~W

τ, ~φ(τ, τ0, ~x0)

~s

where

~W (τ, ~x ) = (grad ~s H)

(cid:16)

·

(cid:17)

~s=~0
(cid:12)
(cid:12)
(cid:12)

12

3 Hamiltonian Methods for the Extended Sys-

tem

3.1 Degenerate Poisson Brackets and Reduction of the

Order of a Hamiltonian System

If there are nontrivial functions (Casimir functions) fl(~z ) (maybe given

locally on the manifold M) such that

fl, h
}

{

= 0

(28)

for any function h(~z ) then the matrix ˆJ(~z ) is degenerate and this Poisson
bracket is said to be degenerate. (For a degenerate matrix ˆJ (~z ) of constant
rank, the functions fl
in (28) locally always exist.)

If all (at least all functionally independent) Casimir functions fl have
been found, then from properties (13) and (28) it follows that for an arbitrary
Hamiltonian the trajectories of the system (11) ~z(τ ) lie on the intersecting
level surfaces

fl(~z ) = cl = const

(l = 1, 2, . . . , m)

(29)

where the Poisson bracket no longer remains degenerate.

Locally any Poisson bracket of constant rank can be brought into the

form (Darboux theorem)

Onn

In Onm
In Onn Onm
−
Omn Omn Omm

ˆJ = 







is a n

(30)

is a k

l zero matrix and In

where Okl
n identity matrix,
and dim M = 2n + m . Thus in local coordinates we obtain the classical
Hamiltonian system with n degrees of freedom depending on m parameters
(c1, c2, . . . , cm in (29)).

×

×

3.2 Degenerate Poisson Brackets for Global Variables,

or Local Darboux Coordinates ?

The spin-orbit Poisson bracket (18) is degenerate. It has the nontrivial
2 and on the level surface f1 = const > 0 its rank

Casimir function f1 =

~s

|

|

13

is constant and is equal to 8. This means that we can decrease the dimensions
of the system (26) by introducing Darboux coordinates. Thus we obtain the
classical Hamiltonian system with 4 degrees of freedom depending
2 . It is clear that the Darboux coordinates are not
on one parameter
|
unique and may be introduced in various ways. We consider only one typical
example.

~s

|

Let ~i, ~j, ~k be an arbitrary orthogonal system of unit vectors in three

dimensional space R3 satisfying the condition

We introduce three new spin variables ψ, J, I by the equations

~i

~j

·

h

~k

×

i

= 1

~i = J

~j = √I

J 2 cos(ψ)

~k = √I

J 2 sin(ψ)

−

−

~s

~s

~s

·

·

·






(31)

(32)

(33)

or, equivalently

~s(ψ, J, I) = J

~i + √I

J 2

cos(ψ)

~j + sin(ψ)

·

−

(cid:16)

·

~k

·

(cid:17)

Here J is the projection of the spin vector on the ~i-axis, ψ is the polar
2 . In the new variables the spin
angle in the transverse plane and I =
part of motion equations (26) becomes

~s

|

|

˙ψ = HJ ,

˙J =

Hψ,

−

˙I = 0

where the Hamiltonian (25) takes on the form

H(τ, ~x, ψ, J, I) = H(τ, ~x, ~s(ψ, J, I))

Unfortunately, when

(grad ~s H)

(cid:16)

2

+

~j

·

(cid:17)

(grad ~s H)
(cid:16)

·

2

~k

(cid:17)

= 0

this coordinate system cannot be extended onto the whole sphere I = const >
J 2 = 0. This means we need to have a
0, since it has a singularity for I
whole atlas of local coordinates systems (at least two local coordinate systems

−

14

6
deﬁned by diﬀerent vectors ~i1, ~j1, ~k1 and ~i2, ~j2, ~k2 in (31)) for a complete
description of spin motion on the sphere in the electric and magnetic ﬁelds
depending on time and position of the particle. We will have the same diﬃ-
culties with any other Darboux coordinates because they are deﬁned by the
topological properties of the sphere. So the way pointed by the Darboux
theorem does not look like the most natural or straightforward ap-
proach to the problem of investigation of polarized beam dynamics
and we prefer to study the equations of spin-orbit motion using initial global
variables ~x, ~s and the Poisson bracket (18) (degenerate).

Remark: Note that in Darboux coordinates considered here the Hamil-

tonian (20) linear with respect to spin variables takes on the form

H = Horbt +

~W
(cid:16)

~i

·

(cid:17)

J + √I

J 2

−

~W

~j

·

(cid:16)(cid:16)

(cid:17)

cos (ψ) +

sin (ψ)

~W

~k

·

(cid:16)

(cid:17)

(cid:17)

and the condition (33) now reads as

~W

~j

·

2

+

~W

(cid:16)

(cid:17)

(cid:16)

~k

·

2

(cid:17)

= 0

3.3 The Properties of Solutions of the Extended Equa-
tions of Spin-Orbit Motion Independent of the Spe-
ciﬁc Choice of the Hamiltonian

Which properties of solutions are independent of the speciﬁc choice of
the Hamiltonian function in the equations of motion (11)? These are, for
example, properties connected with the existence of Casimir functions and
with the preservation of the Poisson bracket along the trajectories of the
Hamiltonian system.

The spin-orbit Poisson bracket (18) has the Casimir function

2. This
means that the length of the vector ~s(τ ) is preserved during the motion, i.e.

~s

|

|

~s(τ )

|

| ≡ |

~s(τ0)

|

Let

~z(τ ) = ~φ(τ, τ0, ~z0) be the solution of the system (26), where

~φ(τ0, τ0, ~z0) = ~z0. Using the Taylor series expansion of the function ~φ(τ, τ0, ~z0)
with respect to spin variables we obtain:

~x(τ ) = ~F (τ, τ0, ~x0) + O(

~s(τ ) = A(τ, τ0, ~x0)

)

|

~s0 |
~s0 + O(

2)

~s0 |

|

·

15






(34)

6
where A(τ, τ0, ~x0) is a 3
bracket (18). Using this property we ﬁnd:

×

3 matrix. The map (34) preserves the Poisson

a) The Jacobian matrix of the vector-function ~F (τ, τ0, ~x0) is symplectic:

⊤

J

∂ ~F
∂~x0 






∂ ~F
∂~x0 






= J

Here the 6
indicates transpose of a matrix.

×

6 matrix J is the symplectic unit [12] and the symbol ’

’
⊤

b) Every element of the matrix A(τ, τ0, ~x0) is equal to its own cofac-
3 real nonsingular matrix this means that A(τ, τ0, ~x0) is an

tor. For a 3
orthogonal matrix and det A(τ, τ0, ~x0) = 1 , i.e.

×

A(τ, τ0, ~x0)

SO(3)

∈
We have brieﬂy discussed the properties connected with the existence
of Casimir functions and with the preservation of the Poisson bracket, but
without doubt, Liouville’s theorem on the conservation of volume is one of
the most popular properties of classical Hamilton systems (at least in the
accelerator physics) which is independent of the choice of a speciﬁc Hamilto-
nian. Strictly speaking, this is a statement about the existence of an integral
invariant (dim ~z-dimensional) of the density g(~z )

1.

It is well known [13] that the system of ordinary diﬀerential equations

≡

d~z
dτ

= ~f(τ, ~z )

with continuously diﬀerentiable right hand side admits a non-negative con-
tinuously diﬀerentiable function g(~z ) (in particular the function g(~z )
1)
which serves as the density appearing in an integral invariant if and only if

≡

div ~z

g(~z ) ~f (τ, ~z )
(cid:16)

(cid:17)

= 0

For the Hamiltonian system (12) the equality (35) has the form

div ~z (g(~z ) ˆJ(~z ) grad ~z H(τ, ~z )) = 0

(35)

(36)

It follows from (36) that the Hamilton system (12) will preserve the phase
space volume for a given Hamiltonian function H if and only if

div ~z ( ˆJ(~z ) grad ~z H) =

∂ ˆJij
∂zi

∂H
∂zj

·

=

∂ ˆJij
∂zi !

∂H
∂zj

Xj  

Xi

= 0

(37)

16

Example: Deﬁning in the two-dimensional Euclidean space the Poisson

bracket by the equality

z1, z2}
we will have the Hamiltonian system

{

= z1

dz1
dτ

= z1

∂H
∂z2

,

dz2
dτ

=

z1

−

∂H
∂z1

(38)

z2 . Then a solution of the system (38) is given by means

Suppose H = a
of the formulae

·

z2(τ ) = z2(0),

z1(τ ) = z1(0)

eaτ

·

Consequently, an image of the single square

0

≤

z1(0)

1,

≤

0

≤

z2(0)

1

≤

will have the area eaτ after a displacement along trajectories. The area is
preserved for a = 0 , and

0 for a < 0 , and
Examining the condition (37) we ﬁnd that the Hamiltonian system will
conserve phase space volume independently from the choice of Hamiltonian
function if and only if

for a > 0.

−→ ∞

−→

= 0,

j = 1, . . . , dim ~z

(39)

For the spin-orbit Poisson bracket all the values (39) vanish and consequently,
the phase volume in the 9-dimensional space is preserved.

Moreover the phase volume is the integral invariant and in the reduced
8-dimensional phase space, this is a direct product of the two-dimensional
sphere of a ﬁxed radius ρ > 0 and the 6-dimensional space of orbital variables
2 ). To proof this fact consider an
(level surface of the Casimir function
|
arbitrary suﬃciently small domain D and introduce the spherical coordinates

~s

|

∂ ˆJij
∂zi (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Xi

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

~s

~s

~s

·

·

·






~i = ρ cos θ sin ϕ

~j = ρ cos θ cos ϕ

~k = ρ sin θ

17

(40)

θ

≤

−

π
2 , 0

2π and where the unit vectors ~i, ~j and ~k ,
π
where
2 ≤
≤
~k
satisfying the condition ~i
= 1 and forming an orthogonal basis, are
·
chosen in such a way that the coordinate transformation (40) is nonsingular
within some open set which includes the domain D. In new variables the
equations of motion (26) have the form

ϕ
~j
h

≤
×

i

dx
dτ

= J grad ~x H,

dρ
dτ

= 0

dθ
dτ

=

1
ρ cos θ

∂H
∂ϕ

,

dϕ
dτ

=

1
ρ cos θ

∂H
∂θ

−

(41)

(42)

If we neglect the equation

dρ
dτ

= 0

it is easy to check that the remaining system of eight equations has the
integral invariant with the density

g = ρ2 cos θ

(43)

but the density (43) is just the density of a volume in the 8-dimensional
phase space considered.

Remark: One can check that the properties listed above are correct
not only for the extended but also for the original triangular system (in
fact, this was the criterion for their selection). For the triangular system
these properties can be regarded as properties independent of the choice of
external electromagnetic ﬁeld.

4 Canonical Transformations and the Intro-
duction of Machine Coordinates for Circu-
lar Accelerators

In the theory of circular accelerators it is useful to describe the spin-orbit
motion in terms of a curvilinear coordinate system associated with the design
orbit. In the previous sections we have introduced Hamiltonian extension of
the equations of classical spin-orbit motion. Hamiltonian systems have a very

18

special form, and the special form is not preserved by an arbitrary change
of variables. In this section we describe the transformations of phase space
that are canonical with respect to Poisson bracket (18) and preserve that
special form, and which allow us to make coordinate transformations using
the Hamiltonian function (20) directly instead of the equations of motion.

If we linearize the resulting Hamiltonian equations with respect to spin
variables and then neglect the eﬀect of spin on the orbit motion (triangular
truncation procedure) we obtain the transformed version of the triangular
system too.

4.1 Canonical Transformations of Phase Space

As was already noted, in a ﬁxed local coordinate system ~z the Poisson
bracket is completely deﬁned if we know the values of the elements of the
skew-symmetric matrix ˆJ = (
) as functions of ~z. Before introducing
the canonical transformations we will discuss the converse problem. Under
k matrix ˜J (~z ) will the binary
what conditions on the skew-symmetric k
operation

zi, zj}

×

{

F ˜J (f, g) = grad ~z f

˜J grad ~z g

·

be a Poisson bracket? This operation is automatically bilinear and antisym-
metric and satisﬁes the Leibnitz rule. Hence the operation F ˜J (
) will be
the Poisson bracket if and only if it satisﬁes the Jacobi identity. The Jacobi
identity written in terms of elements of the matrix ˜J has the form (see, for
example [14, 15])

∗

∗

,

∂ ˜Jij
∂yl

∂ ˜Jmi
∂yl

∂ ˜Jjm
∂yl

+ ˜Jjl ·

˜Jml ·
Returning to the main theme, consider a coordinate transformation from
old variables ~z to new variables ~y in the Hamiltonian system of ordinary
diﬀerential equations (12)

i, j, m = 1, . . . , k

+ ˜Jil ·

= 0,

(44)

~z = ~ϕ(~y )

(45)

with a nondegenerate Jacobian matrix (dim ~z = dim ~y = dim M = k)

∂ ~ϕ
∂~y !

 

= 





· · ·

· · ·

∂ϕ1
∂yk

...

∂ϕk
∂yk







∂ϕ1
∂y1

...

∂ϕk
∂y1

19

If we take into account the connection between the gradients of the Hamil-
tonian function H in old and new variables

−⊤

∂ ~ϕ
∂~y !

 

grad ~y H(τ, ~ϕ(~y )) = grad ~z H(τ, ~z )

(46)

we easily obtain from (12) the diﬀerential equations for ~y

−1

d~y
dτ

=

∂ ~ϕ
∂~y !

 

ˆJ (~ϕ(~y ))

−⊤

∂ ~ϕ
∂~y !

 

grad ~y H(τ, ~ϕ(~y ))

(47)

We now introduce the function
symmetric matrix

˜H(τ, ~y ) = H(τ, ~ϕ(~y )) and the skew-

(cid:12)
(cid:12)
~z=~ϕ(~y )
(cid:12)
(cid:12)
(cid:12)
(cid:12)

˜J(~y ) =

ˆJ(~ϕ(~y ))

−1

∂ ~ϕ
∂~y !

 

−⊤

∂ ~ϕ
∂~y !

 

and rewrite the system (47) in the form

d~y
dτ

= ˜J(~y ) grad ~y

˜H

Equation (48) resembles a Hamiltonian system with a new Hamiltonian func-
tion ˜H(τ, ~y). But in fact it will actually only be a Hamiltonian system (in-
dependently from the choice of speciﬁc Hamiltonian) if the matrix ˜J satisﬁes
the Jacobi identity (44). This condition looks very complicated, but there
are two important situations when it becomes trivial:

1. The matrix ˜J (~y ) is constant (independent from ~y ).
2. The matrix ˜J (~y ) is equal to the matrix ˆJ(~y ).
Example 1: For the Darboux coordinates (31) the matrix ˜J has the

form (30) and hence is constant.

Example 2: Introduce the new spin-orbit variables by the equations

(48)

(49)

If the Jacobian matrix of the vector-function ~F is symplectic then the matrix
˜J is equal to the matrix ˆJ (24).

~xold = ~F (~xnew)

~sold = ~snew






20

Now we are ready to introduce the necessary deﬁnitions.
Deﬁnition 1: A coordinate transformation ~z = ~ϕ(~y ) is a Poisson
satisﬁes the Jacobi

˜J(~y )

transformation of phase space if the matrix
identity (44).

Deﬁnition 2: A coordinate transformation ~z = ~ϕ(~y ) is a Canonical
transformation of phase space if the matrix ˜J(~y ) is equal to the matrix
ˆJ(~y ).

The Poisson transformations preserve the Hamiltonian form of the initial
system, but their subset, canonical transformations, has additional helpful
properties. Rewrite the condition ˜J (~y ) = ˆJ(~y ) in the form

ˆJ(~ϕ(~y )) =

∂ ~ϕ
∂~y !

 

ˆJ(~y )

⊤

∂ ~ϕ
∂~y !

 

(50)

The equality (50) means that the image of the Poisson brackets of coor-
dinates functions is equal to the Poisson brackets of the images. Thus a
canonical transformation is an ′′isometry′′ of phase space, and we can ﬁnd
the Hamiltonian equations in new variables by just making the coordinate
transformation in the Hamiltonian function (as in the usual way).

Example 3: The solution ~z(τ ) = ~φ(τ, τ0, ~z0) of the Hamiltonian system

(11) for any ﬁxed τ

τ0 is a canonical transformation of phase space:

≥

ˆJ(~φ(τ, τ0, ~z0)) =

∂~φ
∂~z0 

Remark 1: The condition for the map (45) to be symplectic is often

∂~φ
∂~z0 


ˆJ(~z0)

(51)









⊤

used not in the form following from (50)

where the matrix J is the symplectic unit, but in the form

It can be easily shown that since J 2 =
I these two conditions are equiv-
alent, but it is not true in general that (52) and (53) are equivalent even for

−

⊤

∂ ~ϕ
∂~y !

 

J

∂ ~ϕ
∂~y !

 

= J

⊤

∂ ~ϕ
∂~y !

 

J

∂ ~ϕ
∂~y !

 

= J

21

(52)

(53)

a constant nondegenerate matrix ˆJ in (50). To illustrate this let us intro-
duce a Poisson bracket in four-dimensional Euclidean space by means of the
structural matrix

ˆJ = 




and consider the map

−

0 1
1 0
0 0
0 0

0 0
0 0
0 a
a 0

−



,






a = const

z1 = y1,

z2 = y2 −

y4,

z3 = a y1 + y3,

z4 = y4

which is generated as a displacement along trajectories of the Hamiltonian
z4 for the time τ = 1. Calculating the Jacobian matrix
system with H = z1 ·
of this map we can check that (52) is satisﬁed but that (53) gives

⊤

ˆJ

∂~z
∂~y !

 

∂~z
∂~y !

 

= ˆJ + 





1

−

1

0
0
0

0 0 a2
0 0
0 0
a2 0 0

−
0
0
0








Remark 2: Let a Poisson transformation satisfy the equality

= ˆJ

if

a2

= 1

ˆJ(~ϕ(~y )) = c

∂ ~ϕ
∂~y !

 

ˆJ(~y )

⊤

∂ ~ϕ
∂~y !

 

(54)

for some nonzero constant c. If the relation (54) holds, then in the new local
coordinates the structural matrix of the Poisson bracket is determined by
the matrix ˜J(~y ) = c ˆJ(~y ) . If c
= 1 this transformation is not canonical.
Sometimes for c
= 1 it is useful to introduce for the transformed system a
new Poisson bracket, determined by the matrix ˜J(~y ) = ˆJ(~y ) . Deﬁning
the new Hamiltonian by means of the rule

˜H(τ, ~y ) = c

H(τ, ~ϕ(~y ))

·
we can consider the transformed system as being Hamiltonian with the
′′same′′ Poisson bracket. For instance, in accelerator physics this method
is used in studying betatron oscillations when the transverse momenta are
normalized by the value of the kinetic momentum of a reference particle,
which is assumed be a constant.

22

6
6
6
6
4.2 Nonautonomous Canonical Transformations

Except for transformations of the type (45), in this paper more general

transformations of variables are used

~z = ~ϕ(τ, ~y )

(55)

depending on τ as a parameter. Then we need to answer the question: ′′In
what case is the transformation (55) canonical and how is the new Hamilto-
nian to be calculated?′′

Deﬁnition 3: A coordinate transformation ~z = ~ϕ(τ, ~y ) is a nonau-
the condition

tonomous canonical transformation if for any ﬁxed τ
(50) holds and there is a diﬀerentiable function ˆF (τ, ~y ) such that

ˆJ(~y )

grad ~y

ˆF =

·

−1

∂ ~ϕ
∂~y !

∂ ~ϕ
∂τ

·

−  

(56)

Then the new Hamiltonian is given by the formula

˜H(τ, ~y ) = H(τ, ~ϕ(τ, ~y )) + ˆF (τ, ~y )

Example 4: Deﬁning in the two-dimensional Euclidean space the Poisson

bracket by the equality

{
it easy to check that the coordinate transformation

z1, z2}

= z1 + z2

z1 = (1 + b) y1 + b y2 + c

z2 =

b y1 + (1

−

b) y2 −

−

c






(57)

is canonical independently from the choice of constants b and c. Letting now
b and c be functions of τ we ﬁnd that for the set y1 + y2 6
= 0 the equation
(56) has the solution

ˆF (τ, y1, y2) =

(y1 + y2)

sign(y1 + y2) ln

−

db
dτ −

y1 + y2|

|

dc
dτ

and that this solution is unique up to an additive arbitrary function of the
variable τ . This means that if

dc
dτ 6

= 0

23

we cannot consider the transformation (57) to be a nonautonomous canonical
transformation because the equation (56) does not have diﬀerentiable solu-
tions (at least in the neighbourhood of the set y1 + y2 = 0). So for general
Poisson brackets the solvability of the equation (56) does not follow from
satisfying the condition (50) for all values of τ .

We will not set ourselves the target of studying the general properties
of nonautonomous canonical transformations, but instead we consider some
examples directly connected with the purpose of this paper.

Example 5: Let ~z(τ ) = ~φ(τ, τ0, ~z0) be a solution of a canonical system

with the Hamiltonian ˜F (τ, ~z ) , so that

∂~φ
∂τ

= ˆJ (~φ )

grad ~z

˜F (τ, ~z )

·

(58)

Taking into account (46) and (51) one obtains from (58)

(cid:12)
(cid:12)
~z=~φ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

−1

∂~φ
∂τ

∂~φ
∂z0 






= ˆJ (~z0)

grad ~z0

˜F (τ, ~φ(τ, τ0, ~z0))

(59)

·

From (59) and (51) it follows that a coordinate transformation

~z = ~φ(τ, τ0, ~y )

is nonautonomous canonical and the new Hamiltonian is given by

˜H(τ, τ0, ~y ) = H(τ, ~φ(τ, τ0, ~y ))

˜F (τ, ~φ(τ, τ0, ~y ))

(60)

−

As a particular case, the formula (60) contains the Hamiltonian version of
the method of variation of constants when H = H1 + H2 and the function
˜F is chosen to be H1 .

Example 6: Generalizing example 2 consider the transformation:
~xold = ~F (τ, ~xnew)

With the assumption that the Jacobian matrix of the vector function ~F (τ, ~x)
with respect to the variables ~x is symplectic for all values of τ , the equation
(56) is reduced to

(61)

~sold = ~snew






grad ~x

ˆF =

⊤

J

∂ ~F
∂τ

∂ ~F
∂~x 






24

The same symplecticity condition allows us to show that the matrix

⊤

J

∂
∂~x 







∂ ~F
∂~x 


∂ ~F
∂τ 



is symmetric and, consequently, that the equation (61) has a solution (deﬁned
up to some additive Casimir function).

Omitting a proof, we also point out that if only orbital variables are
transformed, then we can use the classical technique of generating functions.

Example 7: The linear transformation of spin variables

will satisfy (50) if and only if A
(56) now becomes:

∈

SO(3) for all values of τ . The condition

~xold = ~xnew

~sold = A(τ ) ~snew






0

∂ ˆF
∂s3 −

∂ ˆF
∂s2












∂ ˆF
∂s3

−

0

∂ ˆF
∂s2 −

∂ ˆF
∂s1

∂ ˆF
∂s1

0












= A⊤ dA
dτ

(62)

(63)

where the function ˆF does not depend on ~x.

Taking the derivative with respect to τ in the identity

we ﬁnd that the matrix

A⊤(τ ) A(τ ) = I

A⊤ dA
dτ

is skewsymmetric, and hence that (63) has a solution which can be expressed
as follows

ˆF =

A⊤ dA

 

dτ !23 ·

s1 −  

A⊤ dA

dτ !13 ·

s2 +

A⊤ dA

 

dτ !12 ·

s3

So (62) will be a nonautonomous canonical transformation for an arbitrary
diﬀerentiable matrix A

SO(3).

∈

25

4.3 The Coordinate Frame Connected with the Closed

Design Orbit

In this section the words ′′the closed design orbit′′ mean some suitable
closed curve which has a continuous unit tangent vector. Let the closed
design orbit be described by the vector ~r0(z) , where z is the length along
this curve. Supplement the unit tangent vector

~T =

d~r0
dz

with two unit vectors ~N and ~B satisfying the conditions
~N
h

~B
h

~N =

~B =

~T =

~N

×

×

~T

~T

i

i

h

,

,

~B

×

i

or, equivalently

~N

~B = 1

~T
h

×

·
The triplet ~T , ~N , ~B thus forms an orthogonal right handed coordinate
system. We assume that the evolution of this coordinate system as the
variable z changes is described by a periodic solution of the system of ordinary
diﬀerential equations of the Fresnet type

i

d ~T
dz
d ~N
dz
d ~B
dz

=

h ~N

α ~B

−

−

= +h ~T + æ ~B

= +α ~T

æ ~N

−

We will ﬁnd the transformation from the old spin-orbit coordinates to the new
spin-orbit coordinates connected with the vectors ~T , ~N , ~B as a composition
of two successive transformations: the ﬁrst one changes the orbital variables
and second one changes the spin variables and the longitudinal momentum.

4.3.1 Transformation of Orbital Variables

In the new coordinate system an arbitrary orbit-vector ~r

lying in a
suﬃciently small neighbourhood of the closed design orbit can be written in
the form

~r = ~r0(z) + x ~N + y ~B

26

We will take the parameters z, x, y to be the new orbital variables. The
transition from the old coordinates to the new coordinates is made, as usual,
with the help of the generating function depending on the new position and
old momentum variables

F (~r, ~p ) =

~r0(z) + x ~N + y ~B
(cid:16)

·

(cid:17)

~p

−

The new momenta are given by the equations

Pz =

= ~p

(1 + hx + αy) ~T + æ
(cid:16)

(cid:16)

x ~B

−

y ~N

(cid:17)(cid:17)

∂F
∂z

∂F
∂x

∂F
∂y

−

−

−

·

·

·

= ~p

~N

= ~p

~B

Px =

Py =

This transformation is a canonical transformation with respect to the spin-
orbit Poisson bracket.

4.3.2 Transformation of Spin Variables and Longitudinal Momen-

tum

The new spin variables are introduced via the equation

~sold = C(z) ~snew

~N(z), ~B(z), ~T (z)

where C(z) =

is a 3
Since the matrix C depends on the variable z the coordinate transforma-
tion (67) is not canonical. To make it canonical we change the longitudinal
momentum too:

3 matrix.

×

(cid:17)

(cid:16)

z = P new
P old

z

α sx + h sy −

−

æ sz

Here sx, sy, sz are the components of the spin vector ~snew .

The coordinate transformation (67), (68) satisﬁes the condition (50) and
hence is canonical. Since the old Hamiltonian contains all vectors as scalar
and cross products then the new Hamiltonian will have the same form as
the old one if we imagine that all vectors in (20) are written in terms of

(64)

(65)

(66)

(67)

(68)

27

the projections on the unit vectors ~N , ~B, ~T and we take into account the
formulae

p ~N = ~p

·

~N = Px,

p ~B = ~p

·

~B = Py

p ~T = ~p

~T =

·

1
1 + hx + αy

(Pz −

æ (xPy −

yPx)

α sx + h sy −

−

æ sz)

which we can easily obtain from (64)-(66) and (68). Here we have reverted
to using the symbol Pz

instead of P new

.

z

4.4 Change of Independent Variable in Nonautonomous

Hamiltonian Equations

Let the right hand part of the ﬁrst equation of the Hamiltonian system

(11) satisfy the condition

dz1
dτ

=

z1, H(τ, ~z )

= 0

{

} 6

(69)

This means that the variable z1(τ ) changes monotonically with changing τ
(strictly increasing or strictly decreasing) so that one can introduce it as new
independent variable. In many cases of practical importance the new ′′time′′
scale connected with z1 gives us certain advantages and we wish to discuss
the procedure of its introduction for Hamiltonian systems.

For convenience we introduce following notation

~z def= (q, p, y1, y2, . . . , yk−2) = (q, p, ~y )

(70)

for the components of the vector ~z and assume that the matrix ˆJ for the
Hamiltonian equations (11) has the form

ˆJ(~z ) =

(71)

This is not a restriction, because on the one hand the spin-orbit Poisson
bracket (18) has the necessary form and on the other hand any matrix ˆJ can

−

0 1 0
1 0 0
0 0
...
...
0 0












. . .
. . .

0
0

¯J(~y)












28

be brought into this form if the condition (69) holds. With the new notations
the system (11) becomes

dq
dτ

=

∂H
∂p

,

dp
dτ

=

∂H
∂q

,

−

dyi
dτ

= ¯Jij(~y )

∂H
∂yj

,

i = 1, . . . , k

2

(72)

−

and the condition (69) now reads as

∂H
∂p 6

= 0

We will interpret the procedure of changing the independent variable as a
procedure of the reduction of an autonomous Hamiltonian system to a family
of nonautonomous Hamiltonian equations of smaller dimension deﬁned on the
level surfaces of the initial Hamiltonian function. With this aim in mind we
introduce two additional canonical variables (E, υ) and the new Hamiltonian

(υ, E, ~z ) = H(υ, ~z )

E

−

H

to obtain an autonomous Hamiltonian system in a higher dimensional phase
space

dq
dτ

=

∂
H
∂p

,

dp
dτ

=

∂
H
∂q

−

dyi
dτ

= ¯Jij(~y )

∂
H
∂yj

,

i = 1, . . . , k

2

−

dE
dτ

=

∂
H
∂υ

,

dυ
dτ

=

∂
H
∂E

−

= 1

Using the condition (73) we obtain the diﬀerential equations for the new

independent variable q

dyi
dq

=

dyi
dτ ·

dτ
dq

= ¯Jij(~y )

/∂yj
/∂p

∂
H
∂
H

,

i = 1, . . . , k

2

(77)

−

dE
dq

=

dE
dτ ·

dτ
dq

=

/∂υ
/∂p

,

∂
∂

H
H

dυ
dq

=

dυ
dτ ·

dτ
dq

=

/∂E
/∂p

∂
H
∂
H

−

(78)

29

(73)

(74)

(75)

(76)

(79)

(80)

(81)

(82)

(83)

We now wish to show that the equations (77), (78) are the family of nonau-
tonomous Hamiltonian systems deﬁned on the level surfaces

(E, υ, q, p, ~y ) = c0

H

p = K(E, υ, ~y, q, c0)

Let

we have

be the solution of the equation (79). According to the implicit function
theorem this solution exists if the condition (73) holds. Taking the derivative
with respect to the variable yi
in the identity

(E, υ, q, K(E, υ, ~y, q, c0), ~y) = c0

H

0 =

∂
H
∂yi

+

∂
H
∂p ·

∂K
∂yi

∂K
∂yi

=

−

/∂yj
/∂p

∂
H
∂
H

From (81) it follows that

Similarly we obtain

∂K
∂E

=

/∂E
/∂p

,

∂
H
∂
H

−

∂K
∂υ

=

/∂υ
/∂p

∂
∂

H
H

−

Comparing (77), (78) and (82), (83) and introducing the Hamiltonian func-
tion

ˆH =

−

K(E, υ, ~y, q, c0)

we see that the equations (77), (78) become the family of nonautonomous
Hamiltonian systems depending on the parameter c0

dE
dq

=

∂ ˆH
∂υ

,

dυ
dq

=

∂ ˆH
∂E

,

−

dyi
dq

= ¯Jij(~y )

∂ ˆH
∂yj

,

i = 1, . . . , k

2

(84)

−

30

After solving the system (84) for a ﬁxed value of c0 we can ﬁnd the dependence
of p on q using the identity

p(q) = K(E(q), υ(q), ~y(q), q, c0)

and then determine q as a function of τ from the equation

τ

−

τ0 =

q

Zq0

dq
g(q)

(85)

where

g(q) =

(E(q), υ(q), q, p(q), ~y(q))

= 0

∂
H
∂p

(equation (85) follows from the ﬁrst of equations (72)).

Now we have to remember that we did not start from an autonomous
system (74)-(76) but from nonautonomous system (72). This means that
we do not need equation (85) because we have the dependence τ (q) from
the second equation of (84) (υ is just another notation for τ ). We also
have freedom in the choice of the initial condition for the variable E. This
means that we can choose a single ﬁxed value of the parameter c0 (usually
c0 = 0) and replace the initial nonautonomous Hamiltonian system by the
nonautonomous Hamiltonian system (84) with the same matrix ˆJ as in (71).

4.5 Length Along the Design Orbit as Independent

Variable

For a circular accelerator the spin-orbit Hamiltonian is always a periodic
function of the variable z, but its dependence on time may be more compli-
cated (for example, in the acceleration mode). This is one of the reasons for
introducing the length along the design orbit as the independent variable.
We will assume that

(86)

The condition (86) approximately means that during the motion in the ac-
celerator the particle cannot reverse its direction.

∂H
∂Pz

= 0

31

6
6
Following the previous subsection we introduce two additional canonical

variables (E, τ )5 and the new Hamiltonian

= H(τ, x, Px, y, Py, z, Pz, sx, sy, sz)

E

−

H

dE
dt

=

∂
H
∂τ

,

dτ
dt

=

∂
H
∂E ≡

−

1

Now we need to solve the equation

(E, τ, x, Px, y, Py, z, Pz, sx, sy, sz) = 0

with respect to variable Pz to obtain the new Hamiltonian

Pz(E, τ, x, Px, y, Py, sx, sy, sz, z)

H

ˆH =

−

(87)

(88)

on the variable Pz is more complicated
The dependence of the Hamiltonian
than in the pure orbital case, but nevertheless, we can solve the equation (87)
with any required precision with respect to spin variables using the method
of successive iterations.

H

4.6 The Hamiltonian in New Variables up to First Or-

der with Respect to Spin Variables

In this subsection we discuss the general form of the spin-orbit Hamil-
tonian in the new variables (E, t, x, Px, y, Py)6 up to the ﬁrst order with
respect to spin variables. This Hamiltonian is

ˆH = ˆHorbt(E, t, x, Px, y, Py, z) + ˆHspin(E, t, x, Px, y, Py, z, ~s )

(89)

with

ˆHorbt =

æ (x Py −

−

y Px)

−

(1 + h x + α y)

·

eΦ)2

(E

A ~T +

e
Px −
· 
c

5Reserving for a while the new symbol τ for the time t appearing in the spin-orbit

Py −

− (cid:18)

− (cid:18)

−
c2

0 c2

A ~N

A ~B

m2

e
c

e
c

−

=

s





(cid:19)

(cid:19)

2

2

Hamiltonian, and still reserving the symbol t for the independent variable.

6Here and in the Hamiltonian (88) we have reverted to using the symbol t instead of τ .

32

=

æ x π ~B + æ y π ~N −

(1 + h x + α y) π ~T −

−

e
c

Az

and

+

ˆHspin =

α sx + h sy −

−

æ sz +

(1 + h x + α y)(E

e Φ)
2

−
e
c A ~N

(E−eΦ)2
c2

c2

r

m2

0c2

−

Px −

−

(cid:16)

−

(cid:16)

(cid:17)

Py −

e
c A ~B

(cid:17)

~W

2

·

~s =

=

α sx + h sy −

−

æ sz + (1 + h x + α y)

m0 γ
π ~T

~W

~s

·

Here ~W has the same form as in (20) with ~π, ~
B
projections on the vectors ~N , ~B, ~T

, ~
E

written in terms of

π ~N = Px −

e
c

A ~N ,

π ~B = Py −

e
c

A ~B

(E

eΦ)2

π ~T =

s

−
c2

m2

0c2

−

Px −

− (cid:18)

2

e
c

A ~N

− (cid:18)

(cid:19)

Py −

e
c

A ~B

2

(cid:19)

=

(E

eΦ)2

=

 

−
c2

m2

0c2

π2
~N −

π2
~B!

−

−

1/2

and we use the notation

Az = (1 + h x + α y) A ~T + æ (x A ~B −

y A ~N )

The value of γ is deﬁned now through the new canonical variable E

To obtain the Hamiltonian (89) we have used the condition (86) in the form

γ =

E

e Φ

−
m0 c2

∂H
∂Pz

> 0

33

so that the vector ~T is chosen with the same orientation as the direction of
particle ﬂight in the accelerator.

To complete the description we also give the expressions for the projec-
tions on ~N , ~B, ~T of the electric and magnetic ﬁelds in terms of the vector
and scalar potentials.

The magnetic ﬁeld:

B ~N =

B ~B =

1

1

1 + h x + α y ·  

∂Az
∂y −

∂A ~B
∂z −

æ y

B ~T

!

1 + h x + α y ·  

∂A ~N
∂z −

∂Az
∂x

+ æ x

B ~T

!

The electric ﬁeld:

B ~T =

∂A ~B
∂x −

∂A ~N
∂y

E ~N =

−

E ~B =

−

∂Φ
∂x −

∂Φ
∂y −

1
c

1
c

∂A ~N
∂t

∂A ~B
∂t

E ~T =

−

1
1 + hx + αy  

∂Φ
∂z

+ æ

∂Φ
∂x −

x

∂Φ
∂y !! −

1
c

∂A ~T
∂t

y
 

(Useful formulae which allow us to get the equations for vector and scalar
potentials in our curvilinear coordinate system may be found in the Appendix
A).

5 Linear Diﬀerential Equations of Spin Mo-

tion

In this section we discuss the situation in which the Hamiltonian function
is linear in the spin variables and does not depend on the orbit variables. In
particular, this case includes the description of the behaviour of the spin
vector on the closed (or any other chosen) trajectory of orbital motion, using
the triangular system.

34

5.1 Matrix Representation of the Hamiltonian Func-

tion and Simple Properties of Solutions

The Hamiltonian function, which is linear in spin variables and does not

depend on orbit variables, has the form

We now construct the skewsymmetric matrix C( ~w) according to the rule

H(τ, ~s ) = ~w(τ )

~s

·

(90)

where w1, w2, w3 are the components of the vector ~w

C( ~w) = 

w3 w2
0
−
w1
w3
0
−
w2 w1
0









−

~w = (w1, w2, w3)

It is easy to verify that with the help of the matrix C( ~w) the Hamiltonian
(90) can be written as follows

H(τ, ~s ) =

~s

curl ~s (C( ~w)

~s )

·

1
2

·

and the equations of motion take the form

d~s
dτ

= C ( ~w(τ ))

~s

·

(91)

(92)

The matrix representation (91) of the Hamiltonian function (90) resem-
bles the representation of the Hamiltonian of linear orbit motion as a quadratic
form and is particularly convenient for linear nonautonomous canonical trans-
formations of variables. Introduce, for example, the new spin variables ~u by
the equation

~s = A(τ ) ~u,

A(τ )

SO(3)

(93)

∈

Substituting (93) in the equation of motion (92), we obtain

d~u
dτ

=

A⊤CA

 

A⊤ dA

~u

dτ ! ·

−

35

where

A⊤C( ~w)A

A⊤ dA
dτ

−

is a skewsymmetric matrix again. Consequently, the Hamiltonian function
in the new variables ~u can be written in the form

H(τ, ~u ) =

~u

curl ~u

1
2

·

A⊤CA

  

A⊤ dA

~u

dτ ! ·

!

−

(94)

The following simple properties of the matrix notation are almost obvious:

a) curl ~s ( A

~s ) + curl ~s ( B

~s ) = curl ~s ( (A + B)

~s )

·

·

·

b) A⊤C( ~w) A = C

A⊤

~w

for A

SO(3)

·

(cid:17)

(cid:16)

∈

Let M(τ, τ0) be the fundamental matrix solution of (92). It has been

mentioned in subsection 3.3 that for any τ

τ0

≥
SO(3)

M(τ, τ0)

∈

(95)

If the vector ~w is constant (does not depend on τ ) and
matrix M is determined via the matrix C( ~w) from the formula

| 6

~w

|

= 0 , then the

M(τ, τ0) = exp ((τ

τ0) C( ~w)) =

−

I + sin(

~w

(τ

τ0))

|

|

−

+ (1

cos(

~w

(τ

−

|

|

−

τ0)))

·  

C( ~w)
~w

·

|

|

2

C( ~w)
~w

|

!

|

(96)

~w

|

|

In the case

= 0 the matrix M is equal to the identity matrix.

The properties of the solutions of the system of linear diﬀerential equa-
tions (92) given below follow from the Hamiltonian character of the system
(92) (in the case studied here it is equivalent to the fact that the matrix
C( ~w) in (92) is real skewsymmetric):

a) The norm of every solution is conserved.
b) The angle between any two solutions is conserved.
c) If ~n(τ ) and ~m(τ ) are solutions of the system (92), then

~l(τ ) = [~n(τ )

~m(τ )]

is a solution too.

×

36

d) The function ~n(τ )

~s is a constant of motion of the system (92)

if and only if ~n(τ ) is a solution.

·

e) If the vector ~w(τ ) in (90) has period T in τ , then the system (92)

has a T -periodic solution.
~w(τ )

f) If the vector

in (90) has period T in τ and the system (92)
has two linearly independent T -periodic solutions, then any solution of the
system (92) is T -periodic.

5.2 Linear Equations of Spin Motion with Periodic Co-

eﬃcients

period 2π in τ , that is

Now we consider a Hamiltonian function (90) in which the vector ~w has

~w(τ + 2π)

~w(τ )

≡
We shall attempt to obtain a Hamiltonian function (94) of the simplest form
by means of the linear coordinate substitution (93) with a 2π-periodic matrix
A(τ ).

5.2.1 Some Properties of SO(3) Matrices

Recall that the symbol SO(3) denotes the group of 3

3 real orthogonal

matrices with the determinant equal to 1.

∈

Let A

SO(3). Since A−1 = A⊤, the spectrum of this matrix is symmet-
ric about the unit circle (that is, if µ is an eigenvalue of a SO(3) matrix, then
so is µ−1). From the fact that the matrix is real it follows that the spectrum
is also symmetric about the real axes. Taking into account the condition
det A = 1, we obtain that the eigenvalues of the matrix A have the form

×

µ1 = 1,

µ2, 3 = cos λ

i sin λ

±

where

cos λ =

(Tr(A)

1)

−

1
2

The next three lemmas give us some additional helpful properties of SO(3)
matrices.

37

Lemma 1: A 3

3 nonsingular real matrix A belongs to the SO(3) group

if and only if every element of the matrix A is equal to its own cofactor.

×

Note, if every element of a 3

3 real singular matrix A is equal to its own

cofactor then A = 0.

×

Lemma 2: All the eigenvalues of a matrix A

SO(3) are distinct if and

only if A

= A⊤ (or, equivalently, A2

= I).

Lemma 3: If all the eigenvalues of a matrix A

SO(3) are distinct then

∈

∈

the nonzero vector
~k
~k
|

~n =

~k = (a32 −

,

a23, a13 −
is a unit eigenvector of the matrix A corresponding to the unit eigenvalue,
i.e. A~n = ~n.

a31, a21 −

a12)

|

5.2.2 Real Jordan Canonical Forms of SO(3) Matrices

Let ~n be an eigenvector of A corresponding to the unit eigenvalue

Supplement the vector ~n with two unit vectors ~m and ~l satisfying the
condition

A ~n = ~n,

~n

= 1

|

|

~m

~l
h

·

×

i

~n

= 1

B =

~m, ~l, ~n

SO(3)

∈

to form an orthogonal basis. Then the matrix

(cid:17)
In the new basis, constructed with vectors ~m, ~l and ~n , the matrix A will
have the form

(cid:16)

¯A = B−1AB = B⊤AB = 

It follows from the condition ¯A
sent this matrix in the form

∈

A ~m
·
A ~m
·
0

~m A~l
·
~l A~l
·
0

~m 0
~l
0
1

SO(3)



∈




SO(3) that for some angle ψ we can repre-





¯A = 



+ cos(ψ) + sin(ψ) 0
sin(ψ) + cos(ψ) 0
1

−

0

0






38

6
6
Using the equality AB = B ¯A , we obtain
A

~m = cos(ψ)

~m

·
A

·

~l = sin(ψ)

·

sin(ψ)

−

·
~m + cos(ψ)

~l

·
~l

·

or, in complex form,

A

~m + i~l

= exp(i ψ)

~m + i~l

(97)

i~l
It follows from (97) that
are the corresponding eigenvectors of the matrix A (in particular, ψ =

i ψ) are the eigenvalues and ~m

±

±

(cid:17)
exp(

·

(cid:16)

(cid:17)

·

(cid:16)

λ (mod 2π))

The matrix ¯A is a real Jordan canonical form of the matrix A. We

±
will denote it by ¯A1. All possible canonical forms are given by the list

+ cos(ψ) + sin(ψ) 0
sin(ψ) + cos(ψ) 0
1

−

0

0

0

0

+ cos(ψ) 0 + sin(ψ)
1
sin(ψ) 0 + cos(ψ)

−
1
0 + cos(ψ) + sin(ψ)
sin(ψ) + cos(ψ)
0

0

0

,

,











,



¯A1 = 



¯A3 = 



¯A5 = 



+ cos(ψ)
sin(ψ) 0
−
+ sin(ψ) + cos(ψ) 0
1

0

0

+ cos(ψ) 0
1
+ sin(ψ) 0 + cos(ψ)

sin(ψ)
0

−

0

0

0
1
0 + cos(ψ)
sin(ψ)
0 + sin(ψ) + cos(ψ)

−













¯A2 = 



¯A4 = 



¯A6 = 





It is clear that all matrices ¯Ai are similar one to another. For example,




−

B⊤
i

¯A Bi = ¯Ai,

i = 1, . . . , 6

where Bi ∈

SO(3) and

B1 = 

, B2 = 



, B3 = 

1 0 0
0 1 0
0 0 1







1 0
0 0
0 1



0
1
−
0






1
0
0

0
1
−
0

0
0
1
−
0 1
1 0
0 0

−














0
0
1




B4 = 

, B5 = 

, B6 = 

1
0
0

0 0
0 1
1 0




−

0 0 1
0 1 0
1 0 0




−











We note that if ψ = 0 (mod 2π), then all matrices ¯Ai are equal one
to another (and equal to the identity matrix). If ψ = π (mod 2π), then
¯A1 = ¯A2, ¯A3 = ¯A4 and ¯A5 = ¯A6.

39

5.2.3 Skew-symmetric Real Logarithm of SO(3) Matrices

If the determinant of the matrix A is nonzero, then

ln(A) = K

is deﬁned as a solution of the equation

exp(K) = A

(98)

We now consider the problem of ﬁnding skewsymmetric real solutions of

equation (98) in the case, when A

∈
SO(3) and A

SO(3).
= A⊤ , then all real logarithms of the

matrix A are skewsymmetric matrices and can be expressed by formula

Lemma 4: If A

∈

ln(A) =

2 ln λ
λ∗
λ

−

A

(cid:16)

A⊤

−

(cid:17)

where λ and λ∗ are complex conjugate eigenvalues of the matrix A distinct
from unity.

If A = A⊤ then not all real solutions of equation (98) are skewsymmetric

matrices. For example

exp 

0 wd 0
0 0
0 0

w/d
0

−



= 

1
−
0
0

0 0
1 0
0 1

−

for all real d





= 0 and all real w = π (mod 2π).




SO(3)

∈






Lemma 5: Let ~n, ~m, and ~l be the orthogonal basis connected with
SO(3) and deﬁned in the previous subsubsection. Then all real

matrix A
skewsymmetric logarithms of the matrix A are given by the formula

∈

ln(A) = (ω + 2πk)

= (ω + 2πk)

C(~n)

·

0
n3
n2

−

n3
0
n1

n2
n1
0

−






· 



−

where real ω (0

ω < 2 π) satisﬁes the equation 7

≤

exp(iω) =

~m + i~l

A

~m + i~l

(99)

(cid:17)
7Here and further on for complex vectors ~u, ~v

(cid:16)

(cid:16)

(cid:17)
Cn we deﬁne ~u

~v = u1
·

·

v∗
1 +. . .+un

v∗
n.

·

1
2

·

∈

40

6
6
and k is an arbitrary whole number.

Note that the right hand side in (99) is just another expression for one of
the eigenvalues (which we say is ′′conjugate with vector ~n′′) of the matrix A,
and hence the equation (99) always has a real solution.

Below in this paper we will use the notation lns A for real skewsymmetric

values of the function ln A.

Remark: In accordance with Lemma 5

lns I = 2 π k

C(~n )

·

where ~n and k are an arbitrary unit vector and an arbitrary integer respec-
tively.

5.2.4 Normal Forms for Hamiltonians of Linear Equations of Spin

Motion with Periodic Coeﬃcients

For simplicity ﬁx τ0 = 0 and let M(τ ) be the fundamental matrix of

solution of the system (92). Then

M(τ + 2π) = M(τ )

M(2π)

·

Deﬁnition 1: A transformation of variables

~s = A(τ )~u,

A(τ )

SO(3)

∈
is called a normalizing transformation, if

a) A(τ + 2π)

A(τ )

≡

b) the Hamiltonian in the variables ~u does not depend on τ

c) the matrix A⊤(2π)

M(2π)

A(2π) is a real Jordan canonical form

·

·

Deﬁnition 2: The result of the application of the normalizing transfor-
mation to the Hamiltonian (90) with the periodic vector ~w(τ ) is called the
normal form of the Hamiltonian for linear equations of spin motion with
periodic coeﬃcients.

Let ¯M be one of the real Jordan canonical forms of the matrix M(2π)

and let the matrix B

SO(3) be such that

∈

B⊤M(2π) B = ¯M

41

Lemma 6: The matrix

A(τ ) = M(τ ) exp

lns M(2π)

B

(cid:18)−
deﬁnes the normalizing transformation, which takes the initial Hamiltonian
(90) into the normal form

(cid:19)

τ
2π

¯H(~s) =

1
2

~s

curl ~s

·

1
2π

(cid:18)

(cid:16)

lns ¯M

~s

(cid:19)

·

(cid:17)

Examining all possible real Jordan canonical forms of the matrix M(2π)

and explicitly calculating the logarithm in (100) we get

Lemma 7: The Hamiltonian (90) with the 2π-periodic vector ~w(τ ) can

be reduced to the following normal forms

(100)

(101)

¯H(~s ) = (

λ + k)

sm

±

·

where

and the sign ′+′ or ′
chosen arbitrarily.
The number

−

λ =

arccos

(Tr(M(2π))

1)

1
2π

1
2

(cid:18)

(cid:19)

−

}

∈ {

′ in front of λ, m

1, 2, 3

and the integer k can be

±
of the choice of k and of the sign
tune to a value lying in the region from 0 to 0.5.

±

λ + k in (101) is called the spin tune. Using the freedom
in front of λ we can normalize the spin

Note, that if A

= I then the set of Hamiltonians (101) contains all possible

normal forms. This is easy to see from the fact that if the Hamiltonian

1
2

·

~s

curl ~s (C

~s )

·

is a normal form, then the matrix exp(2πC) is a real Jordan canonical form
of the matrix M(2π).

Another way to bring a 2π-periodic Hamiltonian linear in spin to the
simplest form with help of a 2π-periodic coordinate transformation can be
extracted from the results of Appendix B.

42

6
5.3 Connection between the SO(3) and SU(2) Groups
and the Lax Form of the Equations of Spin Motion

×

The fundamental matrix solution M(τ, τ0) of the linear diﬀerential equa-
3 matrix and consists of 9 elements, but
tions of spin motion (92) is a 3
since M(τ, τ0)
SO(3) it can be described completely with the help of a
smaller number of parameters using the connection between the SO(3) and
SU(2) groups. Usually in accelerator physics this connection is established
in the framework of the spinor formalism [16, 17]. The method we shall use
in this subsection (following [6]) gives us the same results, but does not use
the concept of spinors (at least in explicit form).

∈

Let us recall the deﬁnition of the SU(2) group:
a 2

2 matrix U with complex coeﬃcients belongs to the SU(2) group if
’ indicates complex conjugation

×

U ∗ = I (the asterisk ’
∗

·

det U = 1 and U
of a matrix).

From this deﬁnition it follows that any matrix U

SU(2) has the form

∈

U =

a
b
b∗ a∗

,

!

 

−

We now deﬁne the matrix

a

a∗ + b

b∗ = 1

·

·

(102)

L =

s3
s1 −

is2

 

s1 + is2

,

s3 !

−

L∗ = L

(103)

corresponding to the vector ~s and introduce the anti-Hermitian matrix B

B =

i
2 ·  

w3
w1 −

iw2

w1 + iw2
w3

−

,

!

B∗ =

B

−

(104)

By means of the matrices L and B one can write the equations of spin motion
(92) in the form of a Lax equation

·
Note that the right hand side of equation (105) satisﬁes the condition

−

·

= B

L

L

B

(105)

dL
dτ

(B

L

L

B)∗ = B

L

L

B

·
Lemma 8: If the matrix U(τ, τ0) satisﬁes the equation

−

−

·

·

·

dU
dτ

·

= B

U,

U(τ0, τ0) = I

(or U(τ0, τ0) =

(106)

I)

−

43

then U(τ, τ0)

SU(2) and the solution of (105) is given by the formula

∈
L(τ, τ0) = U(τ, τ0)

L(τ0, τ0)

U ∗(τ, τ0)

·

·

(107)

Remark 1: Because (107) is a similarity transformation it follows that
τ0 the matrices L(τ, τ0) and L(τ0, τ0) have the same eigenvalues.

for any τ
In our case this means that for any τ

≥

τ0

≥
~s(τ0)

|

~s(τ )

|

| ≡ |

Remark 2: The equation of spin motion (92) can be written in the form
(105) using another choice of the matrices L and B, diﬀerent from (103) and
(104). See, for example, [6].

The following formulae give us the connection between the matrix U(τ, τ0)

in (107) and the fundamental matrix solution of (92) M(τ, τ0):

M = 

Re(a2
Im(a2
2

b2)
−
b2)
−
Re(ab∗)




·

−

Im(a2 + b2)
Re(a2 + b2)
Im(ab∗)
2
−

·

2
·
−
2
·
−
aa∗

Re(ab)
Im(ab)
bb∗

−






(108)

Introduce the quantities

v =

(m11 + m22 + i (m21 −

m12)) = a2

w =

(m22 −

m11 −

i (m21 + m12)) = b2

1
2

1
2

where mkl are the elements of the matrix M. Since for the orthogonal matrix
M we have

w

w∗ + v

v∗ =

(m2

11 + m2

12 + m2

21 + m2

22)

= 0

·

·

1
2

then using (102) and (108) we can deﬁne the elements of the matrix U by
the equations

a =

√v,

b =

1
2a (m13 + i m23),

if v

= 0,

b =

√w, a =

1
2b (m13 + i m23), otherwise.

±

±






−

−

44

6
6
Remark 3: The freedom of the choice of sign in these formulae (and also
in (106)) is connected with the fact that the SU(2) group overlaps the SO(3)
group twice.

If the vector ~w does not depend on τ , then the solution of equation

(106) has the form

U(τ, τ0) = U(τ0, τ0)

cos

 

 

|

(τ

τ0)

−

! ·

I +

|

~w
2

sin

|

~w
2

 

2
~w

|

|

|

(τ

τ0)

B

! ·

!

−

where U(τ0, τ0) =
matrix U(τ, τ0)

±
U(τ0, τ0).

≡

I and we assumed

= 0 . In the case

= 0 the

~w

|

| 6

~w

|

|

The usage of the SU(2) representation of SO(3) matrices not only allows
us to reduce the number of free parameters, but is also helpful for some
analytical calculations. Consider, for example, the matrix

ˆL = i (Re(a)

I

·

−

U) =

Im(a)

Im(b)

Im(b) + i

Re(b)

 

·

Re(b)

i
−
·
Im(a)

!

−

It is easy to verify that this matrix commutes with the matrix U, i.e.

ˆL = U ˆL U ∗

Comparing (109) and (107) we get

Lemma 9: Let U be a SU(2) matrix, corresponding to a given A

SO(3) . If A

= I then

~n =

1

(Re(a))2

1
q

−

(Im(b),

Re(b), Im(a))

−

is a unit eigenvector of the matrix A, corresponding to unit eigenvalue.

(109)

∈

6 Normal Forms for the Spin-Orbit Hamilto-

nian

In this section we will consider the Hamiltonian system associated with
the coupled spin-orbit Poisson bracket in a neighbourhood of a stationary
point (or periodic solution) which can be canonically transformed to be the

45

6
origin8. In order to understand the properties of the solutions of such systems
it is helpful ﬁrstly to ﬁnd a coordinate substitution which reduces the original
equations to the simplest possible form. Here we describe an algorithm which
allows us to make coordinate transformations working not with equations of
motion, but directly with the Hamiltonian function.

6.1 Canonical Transformations of Spin-Orbit Variables

which Map the Origin into Itself

We shall be working with a phase space consisting of 2n + 3 variables

~z = (~x, ~s ) = (~q, ~p, ~s ) = (q1, . . . , qn, p1, . . . , pn, s1, s2, s3)

In this subsection we shall study canonical (i.e.
preserving) nonsingular (i.e. with nondegenerate Jacobian matrix) maps

the Poisson bracket (18)

~zf = ~Z(~zi)

(110)

where the components of the real vector function ~Z(~z ) are power series in
~z without constant terms.

6.1.1 Linear Canonical Transformations

The map which linearizes any symplectic map in the neighborhood of a
ﬁxed point is always a linear symplectic map. Does this apply to our case,
where we are dealing with maps which are not symplectic but instead are
canonical with respect to the Poisson bracket (18)?

Lemma 1: The nonsingular real linear transformation

is canonical if and only if the matrix A has the form

~zf = A ~zi

A = diag (Aorbt, Aspin)

8If ~z∗(τ ) is a solution of a Hamiltonian system associated with the coupled spin-orbit
~z∗(τ ) will be a canonical
~0. The question of what type of simple canonical

Poisson bracket then the parallel displacement ~znew = ~zold
transformation if and only if ~s∗(τ )
coordinates can be introduced for an arbitrary solution is studied in Appendix B.

−

≡

46

where

Aorbt ∈

Sp(2n),

Aspin ∈

SO(3)

In more detail the map (110) can be written as

Using the condition of spin-orbit Poisson bracket preservation (50) it is pos-
sible to show that always

Thus we have the following:

canonical map if and only if

Lemma 2: The linearization of the canonical map (110) is a linear

~xf = ~X(~xi, ~si)

~sf = ~S(~xi, ~si)






~S

~x, ~0
(cid:16)

(cid:17)

= ~0

∂ ~X
∂~s

~0, ~0
(cid:16)

(cid:17)

= 0

So the answer to the above question is negative in the general case. The
linearization of the nonsingular canonical map (in its usual meaning) is not
bound to be a linear canonical transformation.

Deﬁnition 1: A polynomial P (~z ) = P (~x, ~s ) is quasi-homogeneous

of degree m in its arguments ~x, ~s if it satisﬁes the equation

P (t ~x, t2 ~s ) = tm

P (~x, ~s )

·

for every value of t.

will be denoted by

Hs(m).

a linear transformation

The set of all quasi-homogeneous polynomials of degree m (m = 0, 1, 2, . . .)

Deﬁnition 2: The quasi-linearization of the map (110) is deﬁned as

~zf = As ~zi

47

which acts invariantly on classes
of the diﬀerence

Hs(m) 9 and minimizes the Euclidean norm

∂ ~Z
∂~z

~0
(cid:16)

(cid:17)

As

−

Lemma 3: The quasi-linearization of the map (110) exists, is unique, is

a linear canonical map and is deﬁned by the matrix

As = diag

∂ ~X
∂~x





∂ ~S
∂~s

,

~0, ~0
(cid:16)

(cid:17)

~0, ~0
(cid:16)

(cid:17)





(111)

Remark: The equality (111) can be used as deﬁnition of quasi-linearization.

In this case deﬁnition 2 becomes a statement which must be proven.

6.1.2 Factorization Theorem

The use of the change of coordinates in the form of the power series
(110) is not too convenient for our purpose because the proof of canonicity is
reduced to the checking of an inﬁnite number of conditions for the coeﬃcients
of the Taylor expansion of the vector function ~Z(~z). Dragt and Finn [18] have
shown that any symplectic map in the neighborhood of a ﬁxed point may
be represented in the form of a composition of a linear symplectic map and
a sequence of displacements along trajectories of the Hamilton system with
Hamiltonians which are homogeneous polynomials of powers 3, 4, 5, . . .. A
similar factorization is applicable in our case too, if instead of homogeneous
polynomials we use Hamiltonians from the classes

Deﬁnition 3: We will say that the function V (~z )

Hs(m).

∈ Os(m) , if

lim
t→0

∃

1
tm V (t ~x, t2 ~s )

∈ Hs(m)

Factorization Theorem A: For every canonical map of the form (110)
m) can

3 functions Fk(~z )

k

∈ Hs(k) (3

≤

≤

and for every integer m
be found, such that

≥

~Z(~z ) =m : As : exp(: F3 :) . . . exp(: Fm :) ~z
9 This means that for an arbitrary m = 0, 1, 2, . . . and for an arbitrary P (~z )

s(m)

∈ H

we have that P (As ~z )

s(m).

∈ H

48

Here As is the matrix of the quasi-linearization of the map (110) and the
symbol ’=m’ means that the diﬀerence of the right and left parts is a function
from the class

Here the exponential Lie operators are deﬁned as usual as a power series
(see, for example [19]) involving the spin-orbit Poisson bracket (18), and the
action of the operator : As :

is deﬁned by means of the rules

Os(m).

for a smooth function f , and

: As : f (~z ) = f (: As : ~z )

: As : ~z = As ~z

for the identity mapping ~z.

The proof of the factorization theorem A is outlined in Appendix C.
Applying theorem A to the canonical map ~Z −1(~z ) and then inverting the

factorization obtained we get

Factorization Theorem B: For every canonical map of the form (110)
m) can

3 functions Gk(~z )

k

∈ Hs(k) (3

≤

≤

and for every integer m
be found, such that

≥

~Z(~z) =m exp(: Gm :) . . . exp(: G3 :) : As : ~z

Remark: The classical Poisson bracket of two homogeneous polynomials
2. The
−
Hs(l) with respect

of degree m and l is a homogeneous polynomial of degree m + l
same property holds for functions from classes
to the spin-orbit Poisson bracket.

Hs(m) and

6.2 General Description of the Normal Form Algo-

rithm

Consider a periodic real Hamiltonian function H(τ, ~z ) of period 2π with
respect to τ which in a neighbourhood of the point ~z = ~0 can be expanded
in quasi-homogeneous polynomials in ~z beginning with degree 2

H(τ, ~z ) = H2(τ, ~z ) + H3(τ, ~z ) + . . . + Hk(τ, ~z ) + . . .

(112)

The purpose of this subsection is to ﬁnd the simplest possible form (normal
form) to which the Hamiltonian function (112) can be reduced by means
of a nonlinear canonical coordinate transformation of the type (110) which
depends periodically on τ as a parameter.

49

6.2.1 Extension of Phase Space

Introduce two additional variables E, v and deﬁne the Poisson bracket

and the new Hamiltonian by the rules:

(v, E, ~z ) = H(v, ~z )

E

−

H

E, v

= 1,

{

}

v, zi}

{

=

E, zi}

{

= 0,

i = 1, 2, . . . , 2n + 3

According to the factorization theorem B, for any given truncation order
m every canonical transformation of coordinates of the type (110), depend-
ing periodically on τ as a parameter, can be represented with the required
precision in the form of an operator

Yk=m

3

3

Yk=m

exp(: Gk(τ, ~z ) :) : As(τ ) :

(113)

In order to extend (113) to the canonical transformation in the extended
phase space, we rewrite (113) in the form:

exp(: Gk(v, ~z ) :) : As(v) :

(114)

and deﬁne the action of the operator : As(v) : on the identity mapping
(v, ~z, E) by the rules

: As(v) : v = v,

: As(v) : ~z = As(v) ~z

: As(v) : E = E

1
2

−

′

A⊤

orbt J A

orbt ~x

~x +

·

1
2

~s

·

curl~s (A⊤

spin A

spin ~s )

′

Here

As(v) = diag (Aorbt(v), Aspin(v))

′

A

orbt =

dAorbt
dv

,

′

A

spin =

dAspin
dv

and the 2n

2n matrix J is the symplectic unit matrix.

×

50

The exponential Lie operators are deﬁned again by their power series
with the help of the extended Poisson bracket for which we will keep the
same notation

.

,

Now, informally speaking, the problem of ﬁnding the normal form can
be expressed as follows: Find the simplest quasi-homogeneous polynomials
¯Hk ∈ Hs(k) (2
can
be reduced to the Hamiltonian

m) such that the initial Hamiltonian function

H

≤

≤

k

{∗

∗}

¯
H

=

m

Xk=2

¯Hk(v, ~z ) + ˜H>m(v, ~z )

E,

−

˜H>m ∈ Os(m + 1)

by means of a nonlinear canonical coordinate transformation, which is deﬁned
by the operator (114). Here informal means that we have not yet deﬁned the
exact sense of the word ′′simplest′′. The usual way to do this is to introduce
the simplest form for the quasi-quadratic polynomial ¯H2 axiomatically and
then to deﬁne ¯Hk as functions which satisfy the condition
= 0.

E

¯Hk, ¯H2 −

{

}

6.2.2 Linear Normalization

First we wish to simplify the quasi-quadratic part H2 of the Hamiltonian
by means of the canonical transformation : As :. Denote

H

H2 =

P (v) ~x

~x + ~w(v)

~s

·

·

1
2

where P (v) is a real symmetric matrix of order 2n and P (v + 2π)
and where the real vector ~w(v) satisﬁes ~w(v + 2π)

≡

P (v),

Applying the operator

we get the
following formula for the quasi-quadratic part ¯H2 of the new Hamiltonian
Hnew = : As :

: As(v) :

H

H

~w(v).
to the Hamiltonian

≡

¯H2 =

A⊤

orbt (P Aorbt + JA′

orbt) ~x

~x +

·

1
2

+

~s

curl ~s

1
2

·

A⊤

spin

(cid:16)

(cid:16)

C( ~w) Aspin −

A′

spin

~s

(cid:17)

(cid:17)

Below we will study the most important case for applications (to which
we will refer later on as the orbital elliptical case) when all the eigenvalues
of the one-turn revolution matrix of the system

d~x
dv

= JP (v) ~x

51

are distinct and lie on the unit circle (the general algorithm will be published
elsewhere). Combining the results of the previous section and the well known
normal form theory of classical linear Hamiltonian systems (see, for example
[20, 21]) we are able to ﬁnd real matrices Aspin ∈
Sp(2n)
2π-periodic in v such that ¯H2 ﬁnally takes the form

SO(3) and Aorbt ∈

¯H2 =

k + p2
q2
k

æk
2

(cid:16)

+ λs ·

s3

(cid:17)

where the values æk and λs are called the characteristic frequencies (or
the linear orbital and spin tunes).

6.2.3 Recursive Loop of Nonlinear Normalization

Let the functions ¯Hk and Gk be already deﬁned for k = 3, . . . , l

Applying the operator exp(: Gl :) to the Hamiltonian

1.

−

¯H2 + . . . + ¯Hl−1 + ˜Hl + . . .

E def=

−

exp(: Gl−1 :) . . . exp(: G3 :) : As :

(v, E, ~z )

and collecting the remainders from the class
obtaining the functions ¯Hl and Gl

H
Hs(l), we get the equation for

∂Gl
∂v

+

Gl, ¯H2}

{

= ¯Hl −

˜Hl

(115)

This is the so-called homology equation. We say that the quasi-homogeneous
polynomial Gl takes the quasi-homogeneous polynomial ˜Hl
homogeneous polynomial ¯Hl

into the quasi-

if (115) holds.

In order to solve the homology equation (115) we introduce complex co-

ordinates ~w = (~η, ~ξ, ~u ) related to the old coordinates
~z = (~q, ~p, ~s ) by means of a standard linear transformation ~z = Q ~w :

qk =

(ηk + ξk),

1 + i
2

1

i

pk =

−
2

(ηk −

ξk)

−

s1 =

(u1 + u2),

1 + i
2

1

i

s2 =

−
2

(u1 −

u2)

−

k = 1, . . . , n

52

It is easy to verify that the matrix Q has the following properties:

s3 = u3

QQ∗ = I,

Q2 =

Q∗

−

where the asterisk ′′

′′ indicates complex conjugation of a matrix.

This is a Poisson transformation, but it is not canonical (although it is
symplectic with respect to orbital variables). The nonzero Poisson brackets
of the new basis functions are given by the equalities:

∗

= 1,

ηk, ξk}
{
In the new coordinates the equation (115) has the form

u1, u3}

u1, u2}

= u3,

iu1,

−

=

{

{

u2, u3}

{

= iu2

∂gl
∂v

+

gl, ¯h2}

{

= ¯hl −

˜hl

(116)

where we have used the notation

¯h2( ~w ) = ¯H2(Q ~w ) = iækηkξk + λsu3,

˜hl(v, ~w ) = ˜Hl(v, Q ~w )

gl(v, ~w ) = Gl(v, Q ~w ),

¯hl(v, ~w ) = ¯Hl(v, Q ~w )

Expanding the coeﬃcients of the monomials in the polynomials gl , ˜hl and
¯hl

in Fourier series with respect to v 10

gl = gN IJL

l

exp(iNv) ηIξJuL

¯hl = ¯hN IJL

l

exp(iNv) ηIξJuL

˜hl = ˜hN IJL

l

exp(iNv) ηIξJuL

(117)

(here the summation is made over all integers N and over all nonnegative
= l11)
integer vectors I, J
and substituting them in the equation (116) we obtain a system of equations
for the coeﬃcients:

R3 satisfying the condition

Rn, L

L
|

+2

+

∈

∈

J

I

|

|

|

|

|

·

i

J)

[N + (I

~æ + (L2 −
10We assume that this Fourier series converges absolutely.
for the integer vector ~k
11Here the function

L1)

λs]

−

·

·

·

gN IJL
l

Rm is deﬁned as

−

= ¯hN IJL
l

˜hN IJL
l

(118)

~k
|

|

=

k1
|

|

+ . . . +

km
|

.
|

∈

53






| ∗ |

Deﬁnition 4: The characteristic frequencies æ1, . . . , æn, λs satisfy a
resonance relation of order K if there exist integers kl not all equal to
zero such that

k1æ1 + . . . + knæn + kn+1λs = 0 (mod 1)

k1 |

|

+ . . . +

kn |

|

+ 2

kn+1 |

· |

= K

(119)

(120)

The number of the linearly independent integer solutions k1, . . . , kn+1 of
equation (119) is an important characteristic of the frequencies æ1, . . . , æn, λs,
and we will call it the multiplicity of the resonance.

Note that our deﬁnition of the order of a resonance (multiplier 2 in front
of kn+1 in (120)) is diﬀerent from the usual one, and corresponds to the
deﬁnition of quasi-homogeneity.

Deﬁnition 5: A quasi-homogeneous polynomial

¯hl(v, ~w ) = ¯hN IJL

l

exp(iNv) ηIξJuL

is said to be a complex normal form if

N + (I

J)

|
that is, the normal form contains only resonant terms.

−

·

·

|

~æ + (L2 −

L1)

λs | · |

¯hN IJL
l

= 0

In each quasi-homogeneous polynomial

hl = hN IJL

l

exp(iNv) ηIξJ uL

(121)

we isolate the resonant part h′
terms of (121) whose indices satisfy

l, which contains all those and only those

N + (I

J)

~æ + (L2 −

·

−

L1)

λs = 0

A quasi-homogeneous polynomial h′′
part of the quasi-homogeneous polynomial hl. Obviously, hl = h′
also introduce the resonant H ′
l
homogeneous polynomial Hl(v, ~z ) as

l = hl −
and nonresonant H ′′
l

·
h′
l is called the nonresonant
l + h′′
l . We
parts of a quasi-

H ′

l(v, ~z ) = h′

l(v, Q∗~z ),

H ′′

l (v, ~z ) = h′′

l (v, Q∗~z )

54

where h′
quasi-homogeneous polynomial hl(v, ~w ) = Hl(v, Q ~w ).

l(v, ~w ) and h′′

l (v, ~w ) are the resonant and nonresonant parts of the

According to the deﬁnition 5, if the quasi-homogeneous polynomial ¯hl is

a complex normal form, then ¯h′

l = ¯hl .

Deﬁnition 6: A quasi-homogeneous polynomial

¯hl(v, ~w ) = ¯hN IJL

l

exp(iNv) ηIξJuL

is said to be a nonresonant complex normal form if

|
that is, the normal form contains only trivial resonant terms.

−

||

|

|

|

|

L2 −

L1 || · |

¯hN IJL
l

= 0

N

+

I

J

+

Deﬁnition 7: A quasi-homogeneous polynomial ¯Hl(v, ~z) is said to be a
(nonresonant) normal form if after the standard transformation ~z = Q ~w
we obtain the quasi-homogeneous polynomial ¯hl(v, ~w) = ¯Hl(v, Q ~w) which is
a (nonresonant) complex normal form.

It is easy to see (comparing deﬁnitions 5 and 7, and equation (118))
that for every given quasi-homogeneous polynomial ˜Hl there is the quasi-
homogeneous polynomial Gl which takes ˜Hl into the normal form ¯Hl. Here
l and the normal form ¯Hl are uniquely determined,
the nonresonant part G′′
and the resonant part G′
l can be speciﬁed arbitrarily.
Among the quasi-homogeneous polynomials Gl which take ˜Hl into the
l = 0 and we call it basic.

normal form ¯Hl we select the one for which G′

H

H

Remembering that the initial Hamiltonian function

is real (the values
of the function are real for real values of arguments) and that after a real
canonical transformation : As(v) : we again have the real Hamiltonian func-
, we wish to ﬁnd conditions on the functions Gl that will
tion : As(v) :
guarantee the reality of the transformation from : As(v) :
to normal form
. Denote by ˆh(v, ~w) the quasi-homogeneous polynomial in which all the
¯
H
coeﬃcients of the powers of ~w are complex conjugates (as functions of v) of
the corresponding coeﬃcients in the quasi-homogeneous polynomial h(v, ~w).
Lemma 4: Suppose that in the homology equation (115) ¯H2 and ˜Hl are
real functions. Then the normal form ¯Hl will be a real function and the
necessary and suﬃcient conditions that the quasi-homogeneous polynomial
Gl (which takes ˜Hl into the normal form ¯Hl) will be a real function are that
its resonant part G′

l(v, ~z ) satisﬁes the condition

H

l(v, ~w ) = ˆg′
g′

l(v,

Q∗ ~w ) where

l(v, ~w ) = G′
g′

l(v, Q ~w )

(122)

−

55

In particular, the basic solution of the homology equation Gl (G′
takes ˜Hl into the normal form ¯Hl will be a real function.

l = 0) which

6.2.4 Normalization Theorem

Now we are ready to summarize the results of this section as follows
Normalization Theorem: In the orbital elliptical case, for a real initial

Hamiltonian of the form

(v, E, ~z ) =

Hk(v, ~z )

E,

−

Hk ∈ Hs(k)

H

and for every integer m
≥
depending periodically on v and deﬁned by an operator

3 there exists a real canonical transformation

exp(: Gk(v, ~z ) :) : As(v) :

∞

Xk=2

3

Yk=m

under which the initial Hamiltonian becomes a real Hamiltonian

(v, E, ~z ) =

¯
H

æk
2

k + p2
q2
k
(cid:16)

(cid:17)

+ λs ·

s3 +

m

Xk=3

¯Hk(v, ~z ) + ˜H>m(v, ~z )

E

−

˜H>m ∈ Os(m + 1)

and all quasi-homogeneous polynomials
such that
¯Hk ∈ Hs(k)
are normal forms. Here the resonant parts of the quasi-
homogeneous polynomials Gk may be chosen arbitrarily satisfying condition
(122); then the nonresonant parts of Gk and ¯Hk are uniquely deﬁned.

7 General Properties of Systems whose Hamil-

tonians are Normal Forms

A Hamiltonian system whose Hamiltonian function is a normal form has,
as a rule, an abundance of symmetries, and this enables the order to be
lowered. This is the advantage of a normal form over an arbitrary Hamilto-
nian function. We will not discuss the technical details of the procedure of
lowering the order here, but concentrate on the question of ﬁnding invariant
functions (conservations laws). For convenience we will use the complex co-
ordinates ~w, but it is helpful to remember that in the original coordinates ~z
all functions that we use will be functions with real values.

56

7.1 Normal Forms and Invariant Functions

Writing a normal form ¯
H

¯h = ¯h(v, E, ~w) = ¯
H

where

in complex coordinates ~w we have

(v, E, Q ~w) = iækηkξk + λsu3 +

(123)

∞

Xk=3

¯hk −

E

¯hk = ¯hN IJL

k

exp(iNv) ηIξJ uL

and the summation is made over all integers N and over all nonnegative
integer vectors I, J, L satisfying the conditions

I

|

|

+

J

+ 2

|

|

L
|

|

= k

N + (I

J)

~æ + (L2 −

·

−

L1)

λs = 0

·

We denote by

all integer solutions of equation (119). The dimension of
multiplicity of the resonance. Let a vector ~m
~m

the linear subspace of Rn+1 that is the linear hull of
is equal to the
, i.e.

L
Rn+1 be orthogonal to

. Then the function

L

L

∈

⊥ L

F ~m = i mk ηk ξk + mn+1 u3

(124)

satisﬁes the condition
n + 1
dim

F ~m, ¯h
}

{

functionally independent invariants of the type (124).
Besides that an arbitrary normal form commutes with the function

−

L

= 0 and is hence an invariant. So we have

F = ¯h

(i æk ηk ξk + λs u3 −

−

E)

and with the Casimir function

1 + s2
s2

2 + s2

3 = 2 i u1 u2 + u2
3

(125)

(126)

Remark: And, of course, the Hamiltonian (123) is always a constant of

motion (in extended phase space).

57

7.2 Action-Angle Type Coordinates

Instead of the standard cartesian coordinates

η1, . . . , ηn,

ξ1, . . . , ξn, u1, u2, u3

for normal form analysis and construction we can use action-angle type
canonical polar coordinates

ρ1, . . . , ρn+2, ϕ1, . . . , ϕn+1

(127)

introduced with the help of the formulae

ηl =

2ρl exp(iϕl),

ξl =

1 + i
2

−

q

1 + i
2

q

2ρl exp(

iϕl)

−

u1 =

2ρn+1 exp(

iϕn+1),

u2 =

2ρn+1 exp(iϕn+1)

1

i

−
2

q

−

1

i

−
2

q

l = 1, . . . , n

u3 = ρn+2

Note that this change of variables is not deﬁned on the set

. . .

η1 ·

ηn ·

ξn ·
·
and, as in the case of the standard linear transformation Q, it is a Poisson
transformation, but it is not canonical (and is not even symplectic with
respect to the orbital variables12).

u2 = 0

u1 ·

ξ1 ·

. . .

·

The nonzero Poisson brackets of the new basis functions are given by the

equalities

ϕl, ρl}

{

= 1,

l = 1, . . . , n

ρn+1, ϕn+1}

{

= ρn+2,

ϕn+1, ρn+2}

{

= 1

12The symplecticity with respect to the orbital variables can be easily achieved, if nec-

essary, by interchanging the places of the orbital actions and angles in (127).

58

and the Hamilton equations with the Hamiltonian function H(~ρ, ~ϕ) take the
form

dρl
dt

=

∂H
∂ϕl

,

−

dϕl
dt

=

∂H
∂ρl

l = 1, . . . , n

dρn+1
dt

= ρn+2 ·

∂H
∂ϕn+1

,

dϕn+1
dt

=

ρn+2 ·
−

∂H
∂ρn+1

+

∂H
∂ρn+2

dρn+2
dt

=

∂H
∂ϕn+1

−

q

q

l = 1, . . . , n

s3 = ρn+2

The direct transition from the original variables ~z to the polar coordinates

introduced above has the form

ql =

2ρl sin(ϕl),

pl =

2ρl cos(ϕl)

q

s1 =

2ρn+1 cos(ϕn+1),

s2 =

2ρn+1 sin(ϕn+1)

q

7.3 Normal Form in Nonresonant Case

In the nonresonant case (dim

= 0) the normal form (123) contains

only those monomials for which

L

I = J,

L1 = L2, N = 0

and hence we can rewrite it as

¯h = i æk ηk ξk + λs u3 + ¯hIL1L3 (ηξ)I (u1u2)L1 uL3

E

3 −

(128)

59

where the summation is made over all nonnegative integer vectors I and over
all nonnegative integers L1, L3 satisfying the condition

2

I

|

|

+ 4L1 + 2L3 ≥

3

According to (124) the functions

iη1ξ1,

. . . ,

iηnξn,

u3

(129)

are constants of motion. Taking into account that ¯h is independent of v,
and subtracting from the Casimir function (126) the invariant u2
3 we get two
additional invariants

E,

iu1u2

(130)

Altogether (129) and (130) give us n+3 independent integrals of motion. This
allows us to consider the system with the Hamiltonian (128) as integrable.
Moreover it is easy to ﬁnd the general solution by quadrature. Let us do this
in the original real variables.

In the variables ~z the Hamiltonian (128) can be written as

= ¯H (J1, . . . , Jn, I1, I2)

¯
H

E

−

(131)

where

Jk =

k + p2
q2
k

,

I1 =

1 + s2
s2
2

,

I2 = s3

(cid:17)

(cid:17)

1
2

(cid:16)

1
2

(cid:16)

are the functions (129), (130) expressed in variables ~z , and the equations of
motion take the form

dqk
dτ

= ωk pk,

dpk
dτ

=

ωk qk

−

(132)

ds1
dτ

=

Ω s2,

−

ds2
dτ

= Ω s1,

= 0

(133)

Here we have used the notations

ωk (J1, . . . , Jn, I1, I2) =

(134)

ds3
dτ

∂ ¯H
∂Jk

,

60

Ω (J1, . . . , Jn, I1, I2) =

(135)

∂ ¯H
∂I2 −

∂ ¯H
∂I1 ·

I2

and we have omitted the trivial equations for the variables v and E.

Fixing for simplicity τ0 = 0 and taking into account that the functions
(134) and (135) are constants of motion, we get the solution of the system
(132), (133) in the form

qk(τ ) = cos(ω0

kτ ) qk(0) + sin(ω0

kτ ) pk(0)

pk(τ ) =

sin(ω0

kτ ) qk(0) + cos(ω0

kτ ) pk(0)

−

s1(τ ) = cos(Ω0τ ) s1(0)

sin(Ω0τ ) s2(0)

−

s2(τ ) = sin(Ω0τ ) s1(0) + cos(Ω0τ ) s2(0)

s3(τ ) = s3(0)

where ω0
at the initial time τ = 0 .

k and Ω0 are the values of the functions (134) and (135) calculated

Obviously, these formulae give us the solution of the triangular system

too, if we redeﬁne ωk and Ω in (134), (135) as
∂ ¯H
∂Jk (cid:12)
I1=I2=0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ωk (J1, . . . , Jn) =

, Ω (J1, . . . , Jn) =

∂ ¯H
∂I2 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

The values ωk and Ω are called the (nonlinear) orbital and spin tunes
respectively.

I1=I2=0

7.4 Normal Form in the Case of a Single Isolated Res-

onance

We shall say that the Hamiltonian function ¯
H
resonance normal form13 if there exist integers

is a generalized single

. . . ,

k0
1,

n+1, N 0
k0
13In order to keep the size of this paper within reasonable bounds we shall not discuss
the formal aspects of constructing of the real canonical transformation which will bring
the initial Hamiltonian to a single resonance normal form because this procedure is almost
the same as that described in subsection 6.2.

61

where not all k0
this function has the form

l are zero such that when written in complex coordinates ~w

¯h = i æk ηk ξk + λs u3 + ¯hN IJL exp(iNv) ηIξJ uL

E

−

(136)

and so that in the expansion (136) there are only those terms whose indices
for some integer m = m(N, I, J, L) satisfy

Il −

Jl = m

k0
l ,

·

l = 1, . . . , n

L2 −

L1 = m

k0
n+1, N = m

N 0,

·

I

|

|

+

J

+ 2

L

|

|

|

| ≥

3

·

Thus, the normal form (136) contains only those monomials for which

N + (I

J)

~æ + (L2 −

·

−

L1)

λs =

·

= m

N 0 + k0
1 ·

æ1 + . . . + k0
n ·

·

æn + k0

n+1 ·

λs

(cid:17)

(cid:16)
and we do not require the condition

N 0 + k0
1 ·

æ1 + . . . + k0
n ·

æn + k0

λs = 0

n+1 ·

to be satisﬁed.

∈

Let a vector ~m

Rn+1 be orthogonal to the vector ~k0 . Then the function

F ~m = i mk ηk ξk + mn+1 u3

(137)

is an invariant. So, together with the Casimir function (126) and the Hamil-
tonian (136), we have n+ 2 functionally independent integrals of motion, and
in the remainder of this subsection we shall ﬁnd an additional invariant that
will allow us to consider the single resonance problem as integrable.

7.4.1 Single Resonance Between Orbital Tunes

If we have a single resonance between orbital tunes (i.e. k0

n+1 = 0) then

the required additional invariant is given by an expression

F = i ε k0

k ηk ξk +

¯h + E

i æk ηk ξk −

−

λs u3

(cid:17)

(cid:16)

(138)

62

where the quantity

ε =

ækk0

k + N 0
~k0
2

k

k

is called the distance from orbital resonance.
If the integral (138) is
independent of the integrals of the form (137) and of the Casimir function
If
(126), the single resonance normal form (136) is completely integrable.
not, then ¯h + E is a series in iη1ξ1, . . . , iηnξn, iu1u2, u3 only, and the addi-
tional integral will be F = ik0
kηkξk. Hence, we are always in the situation of
complete integrability.

The triangular truncated equations of spin motion corresponding to the

Hamiltonian (136)

du1
dτ

=

iΩu1,

−

du2
dτ

= iΩu2,

= 0, Ω =

(139)

u1=u2=u3=0

can be easily integrated by quadrature if we know the solution of the orbital
part of equations of motion. In the original variables the system (139) will
take the form

ds1
dτ

=

Ωs2,

−

ds2
dτ

= Ωs1,

= 0, Ω =

s1=s2=s3=0

∂¯h
∂u3 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂ ¯
H
∂s3 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

and this allows us to draw a number of conclusions. For example, we can
state that in principle, it is possible to organize slow extraction of a polarized
proton beam using a third-integer orbital resonance without signiﬁcant loss
of polarization.

Remark: Note that the case considered here includes, in our opinion,
the correct treatment of the situation when the synchrotron frequency is very
small compared to the other frequencies in the system (as, for example, in
the case of HERA-p ring [11]).

7.4.2 Single Spin-Orbit Resonance

If k0

n+1 6

= 0 then as an additional invariant we can take the function

F = ε u3 +

¯h + E

i æk ηk ξk −

−

λs u3

(cid:17)

(cid:16)

(140)

du3
dτ

ds3
dτ

63

where the quantity

ε =

æk k0

k + λs k0
k0
n+1

n+1 + N 0

is called the distance from spin-orbit resonance. If the integral (140) is
independent of the integrals of the form (137) and of the Casimir function
(126), the single resonance normal form (136) is completely integrable. If not,
then ¯h + E is a series in iη1ξ1, . . . , iηnξn, iu1u2, u3 only, and the additional
integral will be F = u3. Hence, again we are in the situation of complete
integrability.

In more detail the invariant (140) can be written as

F (v, ~η, ~ξ, ~u ) = ε u3 + ¯hN IJL exp(iNv) ηIξJuL

and we see that in general it does not satisfy the condition F (v, ~η, ~ξ,~0)
≡
0, which is very important for application to the triangular system. This
situation can be easily changed if we choose n invariants of the type (137) in
the form

V1 = iη1ξ1 −

u3,

. . . ,

Vn = iηnξn −

k0
1
k0
n+1

k0
n
k0
n+1

u3

(141)

and instead of F use the invariant

¯F = F

¯h0II0 i−|I| V I

So the triangular system will have the spin dependent integral of motion

u1 +

u2 +

∂ ¯F
∂u1 (cid:12)
~u=~0 ·
(cid:12)
(cid:12)
(cid:12)
(cid:12)

u3

∂ ¯F
∂u3 (cid:12)
~u=~0 ·
(cid:12)
(cid:12)
(cid:12)
(cid:12)

and hence the solution for spin can be obtained by quadrature following, for
example, the procedure described in Appendix D (a detailed analysis will be
published in a separate paper).

Remark: The set of invariants (141) show us that a proton beam cannot
be split into two polarized parts with diﬀerent amplitudes using the classical
Stern-Gerlach eﬀect at a single spin-orbit resonance as has been suggested in
[34]. For related comments see [33, 35].

−

X|I|>1

∂ ¯F
∂u2 (cid:12)
~u=~0 ·
(cid:12)
(cid:12)
(cid:12)
(cid:12)

64

8 Methods of Numerical Integration

Today symplectic tracking methods for orbital motion (methods which
conserve the classical Poisson bracket14) are common tools in accelerator
physics and we believe that such methods, which conserve the Poisson bracket
(18) exactly or with high accuracy, are the most suitable ones for numerical
simulation of the equations (21)-(23). For simplicity we consider the case
of autonomous Hamiltonian functions. In the nonautonomous case we can
repeat all the steps, introducing two additional canonical variables to obtain
an autonomous Hamiltonian system in a higher dimensional phase space.

Those methods, of course, are mainly of theoretical interest, but in appli-
cation to the triangular system (practical interest) the Hamiltonian approach
allows us to reduce the initial problem of numerical integration of the system
(1)-(2) to that of symplectic integration of the equations of orbital motion
(1) only.

8.1 Canonical Numerical Methods for Hamiltonian Equa-

tions

Let K be a compact subset of the manifold M, and the autonomous
N (here N is some
Hamiltonian function H(~z ) be zero onto the set M
compact subset of M containing K). Then the solutions of the Hamiltonian
system (11) generate the one-parameter group of the canonical transforma-
tions of phase space

\

T (τ ) : M

M,

T (0) = I

→

Consider a one-parameter family of canonical transformations

Tm(τ ) : M

M

→

deﬁned for

< τ0 (0 < τ0).

τ

|

|

We will say that Tm(τ ) approximates T (τ ) in a neighbourhood of the

identity mapping with the order m (with respect to K), if for all ~z

K

∈

T (τ ) ~z

Tm(τ ) ~z

= O(τ m+1)

k

−

k

14Numerical integration schemes for diﬀerential equations which preserve other qualita-
tive properties (like autonomous Hamiltonian or, more generally, ﬁrst integral conserving
algorithms, and so forth) are discussed in [22], and more recent references may be found
in [23]

65

Here

k · k
each ~z0 ∈
all points

τ
for
|
the equation

|

is the norm in Euclidean space, containing the manifold M.

A one-parameter family Tm(τ ) is said to be locally computable if for
K there is a chart U (from the atlas of the manifold M) containing

< τ0 and a vector function ~FU such that ~zτ is deﬁned uniquely by

~zτ = Tm(τ ) ~z0

~FU (τ, ~z0, ~zτ ) = ~0

Deﬁnition: A locally computable one-parameter family of canonical
transformations Tm(τ ) is said to be a canonical integrator of order m of
the group T (τ ), if Tm(τ ) approximates T (τ ) with the order m.

8.1.1 Recursively Generated High Order Canonical Integrators

Let us assume that by some method we ﬁnd a canonical integrator of
order m of the group T , which has in each of the charts U the formal
representation15

Tm(τ ) = exp(:

τ H + τ m+1Rm(τ, U) :) + O(τ r+1)

(142)

−

where m < r.

The purpose of the present section is to demonstrate a general approach
for constructing higher order integrators starting from integrator (142) of
order m.

Following [24, 25] we consider the mapping

P (τ ) =

T qj
m (pj τ )

n

Yj=1

(143)

where the exponents qj are nonzero integers and the coeﬃcients pj are
real numbers. Substituting the representation (142) in (143) and combining
15 The representation (142) holds if, for example, we assume the constancy of the rank
of the Poisson bracket, the possibility of introducing Darboux coordinates globally in each
of the charts U and some smoothness properties of the integrator considered.

66

the product of exponential operators into a single Lie exponent using the
Campbell-Baker-Hausdorﬀ formula we have

P (τ ) = O(τ r+1) +

+ exp(:

τ (qjpj)H + τ m+1(qjpm+1

)Rm(0, U) + O(τ m+2) :)

j

(144)

−

If qj , pj satisfy the conditions

pj = 1,

qj ·

pm+1
j

= 0

qj ·

(145)

r then from (144) it follows that the mapping (143) is a

and m + 1
canonical integrator of order m + 1 of the group T (τ ) .
Besides that, if m is an even number, m + 2

≥

r , Tm(τ ) is time

≥

reversible, so that

Tm(τ ) Tm(

τ ) = I

−

qn+1−j = qj,

pn+1−j = pj

then (143) gives us a time reversible canonical integrator of order m + 2.

Obviously, the scheme (143) may be recursively applied any number of
times to obtain a canonical integrator of required order l (of course, with
the assumption that this order l is not bigger than r).

Example : Let

am =

rm + lm

 

rm
lm (cid:19)

(cid:18)−

1
m+1

−1

!

,

bm =

1
m+1

am

rm
lm (cid:19)

(cid:18)−

where nonzero integers rm, lm (rm 6

=

±

lm) for odd m satisfy the condition

rm lm < 0

and

Then

rm ·
rm ·

am

am+1
m






+ lm ·
+ lm ·
67

bm

= 1

bm+1
m

= 0

so that (145) is satisﬁed for n = 2 and hence the integrator of order m + 1
can be chosen in the form

Tm+1(τ ) = T rm

m (am τ ) T lm

m (bm τ )

If additionally m and

rm|
|
then the integrator of order m + 2 can be taken as

are even numbers, and Tm(τ ) is time reversible,

Tm+2(τ ) = T

m (am τ ) T lm

m (bm τ ) T

rm
2

rm
2
m (am τ )

Remark : Note that the recursive scheme considered is slightly more
general than that used in [24, 25]. Here it is not necessary that the integers
qj
in (143) are positive and the initial integrator is not assumed to be time
reversible.

8.1.2 Low Order Canonical Integrators for Equations of Classical

Spin-Orbit Motion

In order to be able to start the recursive procedure described above, we
now turn to the problem of constructing low order canonical integrators for a
Hamiltonian system. We will give a few examples, and other helpful recipes
(and references) may be found in [22, 26, 27, 28].

Example 1: If ˆJ the structure matrix of Poisson bracket is constant,
then for any constant matrix A , satisfying the condition ˆJ = A ˆJ + ˆJA⊤ ,
the mapping

where

~zτ = ~z0 + τ ~ϕ(A ~zτ + (I

A) ~z0)

−

~ϕ(~z ) = ˆJ grad ~z H(~z )

is a canonical integrator of ﬁrst order. In the special case when A = 1
2I , this
integrator is a second order approximation, is time reversible, and is known
as the mid-point rule [22].

Example 2: The property that the integrator is canonical is preserved
under Poisson transformations. This simple remark combined with example
1 allows us to construct ﬁrst or second order canonical integrators for the
equations of classical spin-orbit motion, because we know the explicit form
of the transition formulae to Darboux coordinates. Note that although this

68

approach is applicable for arbitrary dependence of the Hamiltonian function
on orbit and spin variables, its computer realization requires the use of more
than one (at least two) local coordinate systems.

Example 3: Consider a Hamiltonian function which depends on spin

variables only in the linear combination ~i

~s

H = H

·
~s

(cid:17)

~x, ~i
(cid:16)

·

~i

·

h

~j

~k

×

i

= 1

Without loss of generality we can assume that
vector ~i with two unit vectors ~j and ~k satisfying the condition

= 1. Supplement the

~i
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

so that the triplet ~i, ~j, ~k forms an orthogonal coordinate system.

Then the mapping given by the system of equations

~sτ = 

~i
~j
~k

⊤
















1
0
0 cos(ατ )
0 sin(ατ )

0
sin(ατ )
cos(ατ )

−

~i
~j
~k












~s0







~xτ = ~x0 + τ ~ϕ

~xτ + ~x0
2

 

, ~i

~s0

·

!

is a time reversible canonical integrator of second order deﬁned in the initial
variables (global ones in 9-dimensional phase space). Here J is the symplectic
unit and

~ϕ

~x, ~i
(cid:16)

ω

~x, ~i
(cid:16)

~s

~s

·

·

(cid:17)

(cid:17)

= J grad ~x H

= ~i

·

grad ~s H

~x, ~i
(cid:16)

~x, ~i
(cid:16)

~s

~s

·

·

(cid:17)

(cid:17)

α = ω

~xτ + ~x0
2

 

, ~i

~s0

·

!

Example 4: If the Hamiltonian function H(~x, ~s ) can be represented in

the form of the sum

H(~x, ~s ) = H1

+ . . . + Hm

~x, ~i1 ·

~s

(cid:16)

(cid:17)

69

~x, ~im ·

~s

(cid:16)

(cid:17)

then the mapping

A~im
Hm

τ
2 (cid:19)

(cid:18)

τ
2 (cid:19)

(cid:18)

. . . A

~i2
H2

A

~i2
~i1
H1 (τ ) A
H2

. . . A~im
Hm

τ
2 (cid:19)

(cid:18)

τ
2 (cid:19)

(cid:18)

where A~i
integrator of second order.
canonical integration for Hamiltonians linearly dependent on spin.

H is the integrator of example 3, gives us a time reversible canonical
It solves (at least in theory) the problem of

8.2 Approximately Canonical Numerical Methods for
Short-Term Tracking (Numerical Methods for the
Triangular System)

The length of the vector ~s is commensurate with Planck’s constant ¯h.

If we perform the renormalization

then the equations of spin-orbit motion corresponding to the Hamiltonian
function H(~x, ~s ) become

~sold →

¯h
2 ·

~snew,

~snew |

|

= 1

d~x
dτ

d~snew
dτ

= J grad ~x Horbt(~x) + O(¯h)

=

~W (~x )

~snew

+ O(¯h)

h

×

i

where

Horbt(~x) = H

and

~W (~x) = (grad ~s H(~x, ~s ))

|~s=~0

~x, ~0
(cid:16)

(cid:17)

Consequently both the eﬀect of spin on the orbit motion and the induced
nonlinear inﬂuence of spin on itself, are very small and we will neglect them,
if the integration interval T satisﬁes the condition

This means that with high accuracy we can reduce the initial problem of nu-
merical integration of the equations of spin-orbit motion to that of symplectic

T << ¯h−1

70

integration of orbital motion equations only. We will now demonstrate this
in a few steps.

First, for any vector ~U(~x) we can approximate the action of the mapping

exp

: ~U (~x)

~s + O

−
(cid:16)

·

2

~s
|
(cid:16)

|

(cid:17)

:
(cid:17)

on phase space variables with required precision by means of the explicit
formulae

~xf = ~xi

(146)

~sf =

I +





sin

~U

|

|
(cid:16)
~U
|

where

|

(cid:17)

A(~xi) +

|

(cid:17)

A2(~xi)

~si

(147)

1

−

~U

cos
~U

|

|
(cid:16)
2
|

A = 




−

U3 U2
0
−
U1
U3
0
−
U2 U1
0






Second, for any given positive integer k and using the Campbell-Baker-

Hausdorﬀ formula it is possible to ﬁnd vectors

~W 1(~x, τ ),

~W 2(~x, τ ),

~W 3(~x, τ ),

~W 4(~x, τ )

so that the following decomposition formulae obtain

exp (

: τ H :) = exp

: τ

Horbt + ~W

~s + O

·

2

~s
|
|

(cid:16)

(cid:17)(cid:17)

=k

−

τ
2

−
(cid:16)

(cid:16)

~W 1
(cid:16)

·

exp

:

Horbt :

exp

: τ

~s + O

(cid:18)−

(cid:19)

−

(cid:16)

2

~s
|

|

(cid:16)

(cid:17)(cid:17)

:
(cid:17)

exp

(cid:18)−

:

Horbt :

=k

(cid:19)

=k exp

:

τ
2

(cid:16)

(cid:18)−

~W 2

~s + O

·

2

~s
|
(cid:16)

|

(cid:17)(cid:17)

:
(cid:19)

exp (

: τ Horbt :)

−

·





:
(cid:17)

τ
2

exp

·

(cid:18)−

:

τ
2

(cid:16)

~W 2

~s + O

·

2

~s
|
(cid:16)

|

(cid:17)(cid:17)

:
(cid:19)

=k

71

=k exp (

: τ Horbt :) exp

: τ

~W 3

~s + O

−

2

~s
|
|

(cid:16)

(cid:17)(cid:17)

:
(cid:17)

=k

−
(cid:16)

·

(cid:16)

2

=k exp

: τ

~s
|
(cid:16)
Here τ is the size of the integration step and =k indicates that the diﬀerences
between the right and left side have at least the order O(

: τ Horbt :)

~s + O

k+1).

(148)

exp (

−
(cid:16)

:
(cid:17)

(cid:17)(cid:17)

−

τ

(cid:16)

·

|

~W 4

Finally, let us select a decomposition formula from (148) and hence one of
the vectors ~W i(~x), i = 1, 2, 3, 4. If we use the combination of some symplectic
integration method of order k for orbital motion and the formulas (146), (147)
for the mapping

|

|

exp

: λ

~W i(~x, τ )

~s + O

2

~s
|
(cid:16)

:
(cid:17)

·
(λ = τ /2 for i = 2, or λ = τ for i = 1, 3, 4) we will obtain a numerical method
which has the order k, is symplectic for the orbital motion and automatically
maintains the length of a spin vector equal to its initial value.

(cid:17)(cid:17)

(cid:16)

(cid:16)

|

Horbt,

Horbt, ~W
n

−

oo

τ 2
12 ·

hn

Horbt, ~W

~W

i

×

o

Example:

~W 1 = ~W +

τ 2
24 ·

τ 2
24 ·

n

hn

for k = 4 and

~W 3 = ~W +

for k = 2 .

~W 2 = ~W +

Horbt, ~W

~W

×

o

−

i

τ 2
12 ·

n

Horbt,

Horbt, ~W
n

oo

τ
2 ·

Horbt, ~W
n

o

,

~W 4 = ~W

τ
2 ·

−

Horbt, ~W
n

o

Here the notation

means the vector with components:

Horbt, ~U

n

o

(

Horbt, U1}

{

,

Horbt, U2}

{

,

Horbt, U3}

)

{

9 Additional Transformations of the Spin-Orbit

Hamiltonian

One of the most important problems in the design of accelerators is the
problem of providing electric and magnetic ﬁelds which can hold a charged

72

particle beam in a suﬃciently small neighbourhood of some geometrical line
which we already introduced in subsection 4.3 under the name of closed
design orbit16. One of the commonly used approaches to ﬁnd a solution is to
create electric and magnetic ﬁelds for which the given geometrical line will
be the projection on R3 of the six-dimensional trajectory of orbital motion
in these ﬁelds, such that this trajectory has to be stable with respect to
small perturbations of the initial conditions and of the values of electric and
magnetic ﬁelds. We will now call this trajectory the reference particle,
and all transformations of the spin-orbit Hamiltonian in this section will be
more or less connected with this concept.

9.1 Closed Design Orbit and Reference Particle

Since in the ﬁnal form of the equations we would like to keep the possibility
to treat eﬀects like misalignments of diﬀerent electromagnetic elements of
the accelerator, ﬂuctuations in the values of electric and magnetic ﬁelds,
inﬂuence of space charge, etc., we will assume that the reference particle
is not a trajectory resulting from the Hamiltonian function (89), but is a
solution of the system with Hamiltonian function

˜H = ˜Horbt + ~0

~s =

·

æx˜π ~B + æy˜π ~N −
−

(1 + hx + αy)˜π ~T −

˜Az

e
c

(149)

where

˜π ~N = Px −

e
c

˜A ~N ,

˜π ~B = Py −

e
c

˜A ~B

(E

e ˜Φ)2

˜π ~T =

 

−
c2

m2

0c2

˜π2
~N −

˜π2
~B!

−

−

1/2

and the components of the vector potential ˜A ~N , ˜A ~B , ˜Az , and the scalar
potential ˜Φ , generally speaking, are not equal to the corresponding values
16In fact in this paper we never use the condition for the closed design orbit to be a
closed curve, and so the equations derived can be used in applications to linear accel-
erators, cyclotrons and etc. Note also that in order to be more consistent in a coupled
spin-orbit formalism the closed design orbit should be considered as a curve in the six-
dimensional space of three orbital and three spin coordinates, but we do it in fact by
assuming that for the spin part this curve satisﬁes the equation ~s = ~0 for all the times.

73

in the Hamiltonian function (89)17.

Now we must discuss the conditions under which the functions

x0(z),

P 0

x (z),

y0(z),

P 0

y (z), E0(z),

t0(z)

(150)

will be the solution of the equations of motion corresponding to the Hamil-
tonian (149), and the conditions under which the projection of this solution
on R3 will coincide with the closed design orbit.

Since x and y were introduced in subsection 4.3 as the transverse devia-

tions from the closed design orbit it is necessary that

x0(z)

0

≡

and

y0(z)

0

≡

(151)

Substituting (150) and (151) in the equations

dx
dz

dy
dz

=

=

∂ ˜Horbt
∂Px
∂ ˜Horbt
∂Py

= æy +

=

æx +

−

(1 + hx + αy)
˜π ~T
(1 + hx + αy)
˜π ~T

˜π ~N

˜π ~B

we obtain that the momenta P 0

x and P 0

y have to be

P 0

x (z) =

e
c

˜A0

~N (z)

and

P 0

y (z) =

e
c

˜A0

~B(z)

(152)

where

˜A0
~N (z) = ˜A ~N (x0(z), y0(z), z, t0(z))

~B(z) = ˜A ~B(x0(z), y0(z), z, t0(z))
˜A0

Then putting (150)-(152) in the equations

dE
dz

dt
dz
17Sometimes it is helpful to assume that even the charge and the rest mass of the
reference particle are diﬀerent from the corresponding values in the Hamiltonian function
(89) too.

−

=

=

,

∂ ˜Horbt
∂E

∂ ˜Horbt
∂t

74

(153)

(154)

(155)

(156)

we obtain that E0(z) and t0(z) have to satisfy the equalities

dE0
dz

=

0

e
c  

∂ ˜Az
∂t !

−

+

e
˜π0
~T ·

E0 −
c2

e ˜Φ0

0

∂ ˜Φ
∂t !

·  

dt0
dz

=

1
˜π0
~T

E0 −
c2

e ˜Φ0

where

˜Φ0(z) = ˜Φ(x0(z), y0(z), z, t0(z)),

˜π0
~T =

e ˜Φ0)2
(E0 −
c2

s

m2

0c2

−

0

∂ ˜Φ
∂t !

 

=

,

x=x0,y=y0,
z=z,t=t0

∂ ˜Φ
∂t (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

The two remaining equations

0

∂ ˜Az
∂t !

 

=

∂ ˜Az
∂t (cid:12)
x=x0,y=y0,
z=z,t=t0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dPx
dz

=

∂ ˜Horbt
∂x

,

−

dPy
dz

=

∂ ˜Horbt
∂y

−

give us two additional conditions which have to be satisﬁed too

d ˜A0
~N
dz

e
c

= h˜π0

~T +

0

e
c  

∂ ˜Az
∂x !

−

e
˜π0
~T ·

E0 −
c2

e ˜Φ0

0

∂ ˜Φ
∂x !

 

d ˜A0
~B
dz

e
c

= α˜π0

~T +

0

e
c  

∂ ˜Az
∂y !

−

e
˜π0
~T

E0 −
c2

e ˜Φ0

0

∂ ˜Φ
∂y !

 

Here

0

∂ ˜Φ
∂x !

 

=

0

∂ ˜Az
∂x !

 

=

,

x=x0,y=y0,
z=z,t=t0

,

x=x0,y=y0,
z=z,t=t0

∂ ˜Φ
∂x (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
∂ ˜Az
∂x (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

0

∂ ˜Φ
∂y !

 

=

0

∂ ˜Az
∂y !

 

=

∂ ˜Φ
∂y (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
∂ ˜Az
∂y (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

75

x=x0,y=y0,
z=z,t=t0

x=x0,y=y0,
z=z,t=t0

So we ﬁnd that the necessary and suﬃcient conditions for the functions (150)
to be a reference particle with respect to a given closed design orbit and elec-
tromagnetic ﬁeld are the conditions (151)-(156). These conditions (especially
(155) and (156)) looks rather complicated, but in practice they can often be
satisﬁed with the help of a very simple model of the closed design orbit (a
sequence of line segments and arcs) and a corresponding piecewise constant
model of the electromagnetic ﬁelds. We will not discuss in this paper the
conditions of stability of this trajectory (and diﬀerent deﬁnitions of stabil-
ity) because this is one of the major problems of accelerator physics and it
deserves special detailed consideration.

The reference particle is a trajectory, but for this trajectory just as for
some real particle, we deﬁne quantities such as Lorentz factor γ0, relative
velocity β0, and modulus of the velocity and kinetic momentum vectors,
which we will denote by v0 and π0 respectively:

γ0 =

e ˜Φ0

E0 −
m0c2

,

β0 =

1
s

−

1
γ2
0

,

v0 = β0c

π0 = m0γ0v0 = m0γ0β0c = m0γ0c

1
s

−

1
γ2
0

e ˜Φ0)2
(E0 −
c2

−

=

s

m2

0c2 = ˜π0
~T

In these new notations the equations (153) and (154) can be rewritten as

dE0
dz

=

0

e
c  

∂ ˜Az
∂t !

−

+

e
β0c  

∂ ˜Φ
∂t !

0

,

dt0
dz

=

1
β0c

=

1
v0

(157)

Note that sometimes it is more convenient to introduce the reference
particle axiomatically just as an arbitrary set of six functions (150) satisfying
only the conditions

x0(z)

0,

≡

y0(z)

0,

≡

dt0
dz 6

= 0

In this case we deﬁne the value of v0 using the second equation in (157),
and after this β0 , γ0 and π0 will be deﬁned as follows

β0 =

v0
c

,

γ0 =

π0 = m0 γ0 β0 c

1

,

β2
0

1
q

−

76

In order, in the following, to have a uniform treatment for both ways of
introducing the reference particle, for the axiomatic case we will deﬁne also
~N , ˜A0
˜A0

~B and ˜Φ0 as

˜A0

~N =

c
e

P 0
x ,

˜A0

~B =

c
e

P 0
y ,

˜Φ0 =

E0 −

m0γ0c2
e

9.2 Deviations of Orbital Coordinates from the Solu-

tion for the Reference Particle

Since the reference particle is a reﬂection of our understanding (or of our
desire) of how the accelerator should behave it is natural to introduce as
new coordinates the deviations of orbit variables from the trajectory of the
reference particle. Let us deﬁne new coordinates (x, y, σ) and new momenta
(Px, Py, ε) as

xnew = xold,

ynew = yold,

= P old

x −

x = P old
P 0

x −

= P old

y −

y = P old
P 0

y −

e
c

˜A0
~N

e
c

˜A0
~B

P new
x

P new
y

ε

σ

=

(t

−

−

t0) ,

= E

E0

−

The orbit Hamiltonian in new variables has the form18

ˆHorbt =

æ x π ~B + æ y π ~N −
−

(1 + hx + αy) π ~T −

e
c

Az +

+ ε

+ σ

dt0
dz

dE0
dz

+

d ˜A0
~N
dz

x

e
c 


+ y

d ˜A0
~B
dz 


where now

~π = (π ~N , π ~B, π ~T )

π ~N = Px −

∆A ~N ,

π ~B = Py −

e
c

e
c

∆A ~B

18 Note, that before this transformation E was a generalized coordinate and t was a
t0) as the new generalized coordinate

generalized momentum, but now we choose σ =
and ε = E

(t
E0 becomes a generalized momentum.

−

−

−

77

π ~T =

m2

0c2

(cid:16)

γ2
(cid:16)

1

−

−

(cid:17)

π2
~N −

π2
~B

(cid:17)

1/2

∆A ~N = A ~N −

˜A0
~N , ∆A ~B = A ~B −

˜A0

~B, ∆Φ = Φ

˜Φ0

−

γ = γ0 +

ε

e∆Φ

−
m0c2

and the spin part keeps the same form as in subsection 4.6 with the compo-
nent of the vector ~π and γ deﬁned above.

The variable σ describes the diﬀerence in arrival times at the position
z between a given particle and the reference particle, and the quantity ε is
their energy deviation. It seems to be more suitable to use another pair of
canonical variables

σnew = β0 c σold

and

εnew =

εold
β0c

where the new σ describes the longitudinal separation of the particle from
the centre of the bunch. This canonical transformation does not concern any
another variables and the new orbital part of the Hamiltonian becomes

ˆHorbt =

æ x π ~B + æ y π ~N −
−

(1 + hx + αy) π ~T −

e
c

Az +

+ ε +

σ
β0c

dE0
dz

+

σε
π0γ2
0

dπ0
dz

+

d ˜A0
~N
dz

x

e
c 


+ y

d ˜A0
~B
dz 


whereas the spin part ˆHspin remains the same if we take into account the
new expression for γ

γ = γ0 +

β0
m0c  

ε

−

e
β0c

∆Φ

!

9.3 Scaling of the Orbital Variables

The canonical scaling of the orbital variables which we use in this paper

is

xnew = √π0xold,

P new
x

=

P old
x
√π0

78

ynew = √π0yold,

P new
y

=

σnew = √π0σold,

εnew =

P old
y
√π0

εold
√π0

This scaling is diﬀerent from that usually used in accelerator physics (see

Appendix E) and is applicable for both storage and acceleration regimes.

9.4 The General Form of the Spin-Orbit Hamiltonian
in New Coordinates up to First Order with Re-
spect to Spin Variables

Before writing out the ﬁnal form of the spin-orbit Hamiltonian we would
like to note that various authors use various coordinate systems for the treat-
ment of fully coupled transverse and longitudinal motion (synchro-betatron
motion). Our variables are closest in their physical meaning to the coordi-
nates used in [30, 31].

In the variables introduced above the spin-orbit Hamiltonian takes the

following ﬁnal (at least for this paper) form

ˆH = ˆHorbt + ˆHspin

ˆHorbt =

æx

−

π ~B
√π0 !

 

+ æy

π ~N
√π0 ! −

 

(√π0 + hx + αy)

π ~T
√π0 ! −

 

e
c

Az +

+ √π0 ε +

σ
√π0 β0 c

dE0
dz

+

d ˜A0
~N
dz

x

e
√π0 c 


+ y

+

d ˜A0
~B
dz 


+

1
π0  

σ ε
γ2
0

+

x Px + y Py + σ ε
2

dπ0
dz

!

ˆHspin =

α sx + h sy −
−

æ sz + (√π0 + h x + α y)

m0 γ
√π0 π ~T

~W

~s

·

79

where

~W =

−

e
m0γc 


(1 + γG) ~

B −

~π

~
G
B
(cid:16)
(cid:17)
m2
0c2(1 + γ) −

~π

·

1
m0c  

G +

1
1 + γ !

~
E

×

~π
h


i


~π = (π ~N , π ~B, π ~T )

π ~N = √π0

Px −

 

e
√π0 c

∆A ~N

,

!

π ~B = √π0

Py −

 

e
√π0 c

∆A ~B

!

π ~T =

m2

0c2(γ2

1)

π2
~N −

π2
~B

−

−

q

γ = γ0 +

√π0 β0
m0 c  

ε

−

e
√π0 β0 c

∆Φ

!

γ0 =

E0 −

e ˜Φ0

,

m0 c2

π0 = m0 γ0 β0 c

Remembering that the electric and magnetic ﬁelds, and the vector and scalar
potentials are supposed to be deﬁned in the curvilinear coordinate system
connected with the closed design orbit (see subsection 4.6 and appendix A
for more details) and using the conversion formulae

x′ = x /√π0,

y′ = y /√π0,

t′ = t0 −
z′ = z

x = √π0 Px + (e/c) ˜A0
P ′
~N

y = √π0 Py + (e/c) ˜A0
P ′
~B

σ /

√π0 β0 c
(cid:16)

(cid:17)

,

E′ = E0 +

√π0 β0 c
(cid:16)

(cid:17)

ε

from these variables, denoted here as z′, x′, P ′
y, E′, t′ , to our ﬁnal
canonical coordinates z, x, Px, y, Py, σ, ε we obtain the rule for the sub-
stitution of the arguments of the mentioned above functions

x, y′, P ′

F (t′, x′, y′, z′)

F

t0 −

 

→

σ
√π0β0c

,

x
√π0

,

y
√π0

, z

!

80

In our ﬁnal variables the relations between ﬁelds and potentials become:
The magnetic ﬁeld:

B ~N =

√π0 + h x + α y ·  

√π0

∂Az
∂y −

∂A ~B
∂z −

æ y
√π0 B ~T

!

√π0

√π0

B ~B =

√π0 + h x + α y ·  

∂A ~N
∂z −

√π0

∂Az
∂x

+

æ x
√π0 B ~T

!

B ~T = √π0

∂A ~B
∂x −

 

∂A ~N
∂y !

where

Az =

1
√π0

((√π0 + h x + α y) A ~T + æ (x A ~B −

y A ~N ))

The electric ﬁeld:

E ~N = √π0

β0

 

∂A ~N
∂σ −

∂Φ
∂x !

E ~B = √π0

β0

 

∂A ~B
∂σ −

∂Φ
∂y !

E ~T = √π0

β0

 

∂A ~T
∂σ −

1
√π0 + h x + α y  

∂Φ
∂z

+ æ

y

 

∂Φ
∂x −

x

∂Φ
∂y !!!

To have the spin part of the Hamiltonian in more detailed form, let us
~s and write out

introduce a vector ~Ω by means of the equality ˆHspin = ~Ω
its components Ωx , Ωy and Ωz :

·

Ωx =

α + (√π0 + h x + α y)

−

e
√π0 π ~T c ·

(1 + γ G)

· "−

B ~N +

G (π ~N B ~N + π ~B B ~B + π ~T B ~T ) π ~N
0 c2 (1 + γ)

m2

+

81

1

+

m0 c  

G +

1
1 + γ !

(π ~B E ~T −

π ~T E ~B)

#

Ωy = h + (√π0 + h x + α y)

e
√π0 π ~T c ·

(1 + γ G)

· "−

B ~B +

G (π ~N B ~N + π ~B B ~B + π ~T B ~T ) π ~B
0c2(1 + γ)

m2

+

1

+

m0 c  

G +

1
1 + γ !

(π ~T E ~N −

π ~N E ~T )

#

Ωz =

æ + (√π0 + h x + α y)

−

e
√π0 π ~T c ·

(1 + γ G)

· "−

B ~T +

G (π ~N B ~N + π ~B B ~B + π ~T B ~T ) π ~T
0 c2 (1 + γ)

m2

+

+

1
m0 c  

G +

1
1 + γ !

(π ~N E ~B −

π ~B E ~N )

#

10 Acknowledgments

The authors are very grateful to the DESY MPY group for hospitality and
support. We wish to thank Desmond P. Barber for stimulating discussions
and for continued encouragement. We thank A.M. Kondratenko, Ya.S. Der-
benev and H. Mais for many interesting and useful discussions. The careful
reading of the manuscript by D.P. Barber is gratefully acknowledged.

82

A How to Transform the Equations of the
Electromagnetic Field to Curvilinear Co-
ordinates Associated with the Closed De-
sign Orbit

The purpose of this appendix is to point out the form which diﬀerential
operators entering in the Maxwell system of equations for the electromag-
netic ﬁeld will have in the curvilinear coordinates considered (they could be
equations for the vector and scalar potentials, or direct equations for the
electric ~
E

In the coordinate system used every vector ~A can be uniquely represented

and magnetic ~
B

ﬁelds)

in the form

~A = A ~N ·

~N + A ~B ·
(at least in a suﬃciently small neighbourhood of closed design orbit).
As physical Components of ~A we understand the values

~B + A ~T ·

~T

A ~N = A ~N (t, x, y, z), A ~B = A ~B(t, x, y, z), A ~T = A ~T (t, x, y, z)

Introduce the vectors

~Tz = (1 + hx + αy) ~T + æ

x ~B

y ~N

−

(cid:16)

(cid:17)

~Nz = (1 + hx + αy) ~N + æy ~T

~Bz = (1 + hx + αy) ~B

æx ~T

−

and deﬁne Az , Ax , and Ay as projections of the vector ~A on the vectors
~Tz , ~Nz and ~Bz respectively

Az = ~A

~Tz ,

Ax = ~A

~Nz ,

·

Ay = ~A

~Bz

·

Using the quantities introduced above we get the following formulae:

The Gradient of a Scalar Function:

·

83

grad φ =

φ =

∇

1
1 + hx + αy "

∂φ
∂z ·

~T +

∂φ
∂x ·

~Nz +

∂φ
∂y ·

~Bz

#

The Laplacian of a Scalar Function:

∆φ =

2φ =

∇

1
1 + hx + αy "

∂
∂z

φ

∇

·

(cid:16)

~T

+

(cid:17)

∂
∂x

φ

·

∇
(cid:16)

~Nz

+

∂
∂y

(cid:17)

(cid:16)

~Bz

φ

∇

·

#

(cid:17)

The Divergence of a Vector Field:

div ~A =

~A =

∇ ·

1
1 + hx + αy "

∂A ~T
∂z

+

∂Ax
∂x

+

∂Ay
∂y #

The Curl of a Vector Field:

1

=

1 + hx + αy " 

∂A ~B
∂x −

∂A ~N
∂y !

~Tz +

∂Az
∂y −

 

∂A ~B
∂z !

~N +

curl ~A =

~A =

∇ ×

+

∂A ~N
∂z −

 

∂Az
∂x !

~B

#

The Laplacian of a Vector Field:
The Laplacian of a vector ﬁeld, if it is needed, can be expressed using the

above formulae using the equality

∆ ~A =

~A)

(

∇

∇ ·

(

~A)

− ∇ ×

∇ ×

84

B Simple Canonical Coordinates for the Pe-

riodic Solution

Let the diﬀerential equations of spin-orbit motion

d~z
dτ

=

~z, H(τ, ~z )
{

}

T -periodic in τ and with possible nonlinear dependence of the Hamiltonian
function H(τ, ~z ) on the variables ~s have the T -periodic solution ~z∗(τ )

~x(τ ) = ~x∗(τ ),

~s(τ ) = ~s∗(τ )

satisfying the condition

~s∗(0)
|

| 6

= 0

~z∗(τ ) which converts the
Since the parallel displacement ~znew = ~zold −
solution (158) into the origin ~0 is not a canonical transformation with respect
to the coupled spin-orbit Poisson bracket if (159) holds, in this Appendix we
introduce other simple canonical coordinates for the periodic solution (158).

Introduce the real skewsymmetric matrix

0

∂H
∂s3

−

∂H
∂s2

∂H
∂s1

0











0

−

∂H
∂s1



∂H
∂s3

∂H
∂s2

−

C(τ, ~z ) =








and write ˆC(τ ) = C(τ, ~z∗(τ )) .

It is easy to check that the unit vector

periodically dependent on τ satisﬁes the equation

~n(τ ) =

~s∗(τ )

1
~s∗(0)
|
|

d~n
dτ

= ˆC(τ ) ~n

85

(158)

(159)

(160)

Let us assume that we have found two unit vectors ~m(τ ) and ~l(τ )
T -periodic in τ which supplement the vector ~n(τ ) to form an orthogonal
coordinate system satisfying the condition

·
i
Introduce new coordinates ~y, ~u with the help of the canonical transformation

≡

×

h

~m(τ )

~l(τ )

~n(τ )

1

(161)

~x = ~x∗(τ ) + ~y ,

~s = A(τ ) ~u

A(τ ) =

~m(τ ), ~l(τ ), ~n(τ )

SO(3)

(cid:16)

∈

(cid:17)

In the variables ~y, ~u the Hamiltonian function takes the form

Hnew = Hold (τ, ~x∗(τ ) + ~y, A(τ )~u) + ~y

J

d~x∗
dτ −

1
2

~u

curl ~u

·

A⊤ dA
dτ !

 

·

and the periodic solution ~z∗(τ ) is now expressed as follows

~y∗ = ~0,

~u∗ = (0, 0,

~s∗(0)
|
|

)

Now we wish to discuss the problem of existence and possible freedom of

choice of the vectors ~m(τ ) and ~l(τ ) introduced above.

Taking the derivative with respect to τ in the identities

~m(τ )

~n(τ ) = 0,

~m(τ )

~m(τ ) = 1

·

·

we have

d ~m
dτ −

 

ˆC(τ ) ~m

! ·

Subtracting the identity ˆC ~m
we ﬁnd that the vector

·

~n = 0

and

~m = 0

(162)

d ~m
dτ ·

~m = 0 from the second of the equalities (162)

is orthogonal to the vectors ~n and ~m for all values of τ , and hence can be
represented in the form

d ~m
dτ −

ˆC(τ ) ~m

d ~m
dτ −

ˆC(τ ) ~m = ψ1(τ )~l

86

Similarly we have

From the condition

d~l
dτ −

ˆC(τ )~l = ψ2(τ ) ~m

~l

~m

= 0

d
dτ
ψ1(τ ) def= ψ(τ ) , i.e. the vectors ~m, ~l satisfy the

(cid:16)

(cid:17)

·

it follows that ψ2(τ ) =
system of diﬀerential equations

−

d ~m
dτ

= ˆC(τ ) ~m

ψ(τ )~l,

−

d~l
dτ

= ˆC(τ )~l + ψ(τ ) ~m

(163)

The solution of (163), written in complex notation, is

~m(τ ) + i~l(τ ) = exp

i

ψ(η)dη

D(τ )( ~m(0) + i~l(0))

(164)

where D(τ ) is the fundamental matrix solution of (160) so that

τ

Z0









dD
dτ

= ˆC(τ ) D,

D(0) = I

Remembering that the vectors ~m and ~l must be T -periodic in τ we have
from (164)

D(T )( ~m(0) + i~l(0)) = exp

ψ(η)dη

( ~m(0) + i~l(0))

(165)

so that

T

i
−

Z0





T

exp

ψ(η)dη

i
−

Z0













·

is an eigenvalue and ~m(0) + i~l(0)
matrix D(T ). Multiplying (165) onto the vector ~m(0) + i~l(0) we get

is the corresponding eigenvector of the

ψ(η)dη

=

D(T )( ~m(0) + i~l(0))

( ~m(0) + i~l(0))

(166)

T

exp

i
−

Z0





1
2





87

This arguments can be reversed to show that the diﬀerentiable unit vec-
tors ~m(τ ) and ~l(τ ) T -periodic in τ will supplement the vector ~n(τ ) to
form an orthogonal basis satisfying the condition (161) if and only if they
do so for τ = 0 and then satisfy the diﬀerential equations (163) for some
continuous function ψ(τ ) for which the equality (166) holds.

Applying the transformation ~s = A(τ ) ~u described above to the Hamil-

tonian

H = ~w(τ )

~s,

~w(τ + 2π)

~w(τ )

·

≡

discussed in subsubsection 5.2.4 we ﬁnd that in the variables ~u this Hamil-
tonian becomes

H = ψ(τ )

u3

·

and is hence a normal form for all possible functions ψ(τ ) satisfying (166),
which are independent of τ .

C Sketch of the Proof of the Factorization

Theorem

The purpose of this appendix is to prove the factorization theorem A.
The matrix of the quasi-linearization As is uniquely deﬁned by the formula

(111). Introduce maps

M2 = : As : ,

Mk =

Mk−1 exp(: Fk :) ,

k = 3, . . . , m

Using induction in k, we will show that the functions Fk ∈ Hs(k) can be
chosen in such a way that the conditions

~X(~x, ~s ) =k+1 ~x + ~Xk(~x, ~s )

~S(~x, ~s ) =k+2 ~s + ~Sk+1(~x, ~s )

−1
k

−1
k

M

M






(167)

are fulﬁlled where ~Xk ∈ Hs(k) and ~Sk+1 ∈ Hs(k + 1).
theorem.

It is easy to see that the equality (167) for k = m gives the proof of the

Obviously, (167) is correct at k = 2. Applying the operator

exp(

: Fl(~z) :)

−

88

to both parts of (167) for k = l
k = l, if the function Fl satisﬁes the equations

−

1 we obtain that (167) will be correct for

Fl, ~x

{

}

= ~Xl−1,

Fl, ~s

}

{

= ~Sl

(168)

The structural matrix of the spin-orbit Poisson bracket has the form

ˆJ(~z ) = diag (J, Js(~s ))

where the 2n

2n matrix J is the symplectic unit and

×

Js(~s ) = 

s2
s3 −
0
s1
s3
0
s1
s2 −
0
With the help of the matrix ˆJ the equations (168) can be written in the form
of the system







−



Represent the vector function ~Xl−1 in the form of a sum

J

grad ~x Fl =

·

~Xl−1

−

Js(~s )

grad ~s Fl =

·

~Sl

−

~Xl−1 =

~X H

l−2k−1

[ l−1
2 ]

Xk=0

where ~X H
k (~x, ~s ) are homogeneous polynomials of degree k in the variables
~x and the symbol [m] denotes the biggest integer which is smaller or equal
to m.

Lemma 1: Any solution Fl(~z)

∈ Hs(l) of the system (169)-(170) is given

by the formula

where V (~s )

J ~X H

l−2k−1 −

V (~s )

[ l−1
2 ]

1

Fl = ~x

·

l

2k

−

Xk=0
∈ Hs(l) satisﬁes the equation
grad ~s V = ~Sl

Js(~s)

·

~0, ~s
(cid:16)

(cid:17)

89

(169)

(170)

(171)

The proof of this and following Lemmas is left as an exercise for the

interested reader.

Starting from this point, we can forget about the existence of the orbital
variables ~x, because the proof of Theorem 1 has been reduced to ﬁnding the
solution of equation (171), depending only on variables ~s.

Let Hs(k) be the class of homogeneous polynomials of degree k in the
Hs(k) of the

variables ~s. Our current task is to ﬁnd the solution V (~s)
equation

∈

where the vector function ~f

Hs(k), k

1 satisﬁes the condition

grad V = ~f (~s )

Js(~s)

·

grad

= div

∈
~s
(cid:16)

·

~f

(cid:17)

≥
~f
(cid:16)

~s

·

(cid:17)

The condition (173) follows from requiring that the map (110) is canonical.
Hs(k) of the system (172) exists, then

Lemma 2: If the solution V (~s)

it satisﬁes the equation

∈

k(k + 1) V

~s
− |

|

2 ∆V = R(~s )

where

R(~s ) = ~s

curl ~f ,

·

∆ =

+

+

∂2
∂s2
1

∂2
∂s2
2

∂2
∂s2
3

Lemma 3: If the solution of the equation (174) exists, then for odd k it
is unique and for even k the diﬀerence between any two solutions is given by
the formula

−
where c is an arbitrary constant.

V1(~s )

V2(~s ) = c

k

~s
· |

|

Lemma 4: The equation (174) has a solution if and only if

If (175) holds then the function

∆[ k+1

2 ]R(~s ) = 0

V =

2j ∆j R(~s )

~s
aj |

|

[ k−1
2 ]

Xj=0

90

(172)

(173)

(174)

(175)

(176)

where

j

aj =

1
2i + 1)(k

2i)

−

(k

−

Yi=0

satisﬁes the equation (174).

Lemma 5:

and therefore,

∆j

~s
(cid:16)

·

curl ~f

= ~s

curl

·

∆j ~f
(cid:16)

(cid:17)

(cid:17)

~s
(cid:16)

·

∆[ k+1
2 ]

curl ~f

= 0

(cid:17)

So in Lemmas 2 - 5 we have established that if the solution of the system
(172) exists, then it is unique (up to an additive Casimir function of the
k at even k) and is given by the formula
spin-orbit Poisson bracket (18) c
(176). Substituting (176) in (172), we obtain:

~s
· |

|

Lemma 6: The necessary and suﬃcient conditions for the solvability of

the equation (172) are that

~f = 0

~s

·

and

div ~f = 0

(177)

The complete solution of the problem is
Lemma 7: If ~f
Hs(k), then conditions (177 ) and (173) are equivalent.
Remark: From (167) it follows that the actual precision of the represen-
tation of spin variables (functions ~S(~x, ~s )) in theorems 1 and 2 is higher by
Os(m)) than the precision of the represen-
one order (in the sense of classes
tation of orbital variables.

∈

D How to Integrate Linear Equations of Spin
Motion in Quadratures if We Know their
Partial Solution

For general linear homogeneous systems of ordinary diﬀerential equations
of order n knowledge of one nontrivial solution allows us to lower the order

91

of the system by one unit. So, in order to be able to ﬁnd the general solution
in quadratures we need to know n
1 linearly independent solutions. In this
appendix we will show that due to a special symmetry, third order linear
equations of spin motion can be integrated completely if we know only one
partial solution.

−

Let the vector

satisfy the system

~n(τ ) = (n1(τ ), n2(τ ), n3(τ )),

~n(τ )
|

|

= 1

d~s
dτ

= ~W (τ )

~s = C

~W (τ )

~s

×

(cid:16)

(cid:17)

(178)

Without loss of generality we will consider the τ -interval on which one of
components of the vector ~n(τ ) is not equal to zero. Let it be n2(τ ). If on
the considered interval n1(τ )
= 0) we can begin by making a
coordinate transformation ~snew = B~sold where the matrix

= 0 (or n3(τ )

B = 




0
1
0

−

1 0
0 0
0 1






1
0
0

0 0
0 1
1 0

or B = 









−











Introduce the vectors

~m(τ ) =

(n2(τ ),

n1(τ ), 0)

−

~l(τ ) = ~n(τ )

~m(τ ) =

×

(n1(τ )n3(τ ), n2(τ )n3(τ ), n2

3(τ )

1)

−

1
n2

3(τ )

1
q

−

1
n2

3(τ )

1
q

−

~m(τ )

=

|

|

~l(τ )
|

|

= 1

~s def= A(τ )

~s

·

~m(τ )
~l(τ )
~n(τ )

~u = 




·






92

and the new variables

6
6
In the new variables the system (178) becomes

d~u
dτ

=

dA
dτ ·

 

A⊤ + A

C

·

~W
(cid:16)

·

(cid:17)

A⊤

~u def= C

! ·

~b(τ )
(cid:16)

(cid:17)

~u

·

(179)

where the components of the vector ~b(τ ) are

b1 =

d~n
dτ ·

~l + ~n

b2 =

d~n
dτ ·

−

~m

~n

C

·

−

~m

~W
(cid:16)

(cid:17)

C

·

~W

~l,

(cid:16)

(cid:17)

b3 =

d~l
dτ ·

~m + ~l

C

~W

~m

·

(cid:16)

(cid:17)

Since the vector ~n(τ ) satisﬁes the system (178), then b1(τ )
0 . After some simple manipulations we get for ω = b3

≡

0 and b2(τ )

≡

(W1(τ ) n1(τ ) + W2(τ ) n2(τ ))

(180)

ω(τ ) =

1

1
n2

3(τ )

−
and hence the solution of the system (179) is

cos Ψ(τ, τ0)
sin Ψ(τ, τ0)
0

−

sin Ψ(τ, τ0) 0
cos Ψ(τ, τ0) 0
0 1

·






~u(τ ) = 




where

Ψ(τ, τ0) =

ω(ε) dε

~u(τ0) def= K(τ, τ0)

~u(τ0)

·

So the solution of the initial system (178) can be expressed now as follows

~s(τ ) = A⊤(τ ) K(τ, τ0) A(τ0) ~s(τ0)

where the matrix A(τ ) has the form

n2(τ )
√1−n2

3(τ ) −

n1(τ )
√1−n2

3(τ )

0

A(τ ) =

n1(τ )n3(τ )
√1−n2
3(τ )

n2(τ )n3(τ )
√1−n2

3(τ ) −

n2

3(τ )

1

−

q

n1(τ )

n2(τ )

n3(τ )

























τ

Zτ0

93

Remark: It is easy to see that in fact the procedure described above is
= 0 (which

= 0 , n2

1(τ ) + n2

2(τ )

applicable for condition weaker than n2(τ )
is equivalent to

< 1).

n3(τ )

Example: The equations of spin motion generated by the model Hamil-

|

|

tonian of the stationary single resonance problem

H(τ, ~s ) = ε cos(Ωτ + φ)

s1 + ε sin(Ωτ + φ)

s2 + λ

s3

(181)

·

·

·

for ε

= 0 have the nontrivial (2π/Ω)-periodic solution

~n(τ ) =

(ε cos(Ωτ + φ), ε sin(Ωτ + φ), λ

Ω)

1

−

ε2 + (λ

Ω)2

−

q
which satisﬁes the condition

The (2π/Ω)-periodic matrix A(τ ) deﬁned by this solution has the form

n3(τ )

< 1 for all values of τ .

|

|

ε
|ε| sin(Ωτ + φ)

ε
|ε| cos(Ωτ + φ)

0

−

A(τ ) =

ε
|ε|

λ−Ω
ω cos(Ωτ + φ)

ε
|ε|

λ−Ω
ω sin(Ωτ + φ)

ε
ω cos(Ωτ + φ)

ε
ω sin(Ωτ + φ)












|ε|
ω

−

λ−Ω
ω












where ω, calculated in accordance with (180), is

ω =

ε2 + (λ

Ω)2 = const

−
So the fundamental matrix solution of the stationary single resonance prob-
lem

q

M(τ, τ0) = A⊤(τ ) K(τ, τ0) A(τ0)

94

6
6
6
expressed in terms of matrix elements mij takes the following form

m11 = α sin(Ωτ0 + φ) +

cos(Ωτ + φ)

cos(Ωτ0 + φ)

m12 =

λ−Ω
ω β +

ε
ω

(cid:18)

(cid:16)

(cid:17)

m13 = ε
ω

λ−Ω
ω cos(Ωτ + φ)

cos(Ωτ + φ)

sin(Ωτ0 + φ)

α cos(Ωτ0 + φ)

m21 = ζ sin(Ωτ0 + φ) +

sin(Ωτ + φ)

cos(Ωτ0 + φ)

m22 =

λ−Ω
ω γ +

ε
ω

(cid:18)

(cid:16)

(cid:17)

m23 = ε
ω

λ−Ω
ω sin(Ωτ + φ)

sin(Ωτ + φ)

sin(Ωτ0 + φ)

ζ cos(Ωτ0 + φ)

(cid:16)

(cid:16)

2

2

λ−Ω
ω β +

ε
ω

2

(cid:16)

(cid:17)

(cid:18)

β

−

(cid:17)

λ−Ω
ω γ +

ε
ω

2

(cid:16)

(cid:17)

(cid:18)

(cid:19)

(cid:19)

γ

−

(cid:17)
sin(ω(τ

−

−

(cid:19)

−

(cid:19)

−

m31 = ε

ω (ϑ cos(Ωτ0 + φ)

τ0)) sin(Ωτ0 + φ))

m32 = ε

ω (sin(ω(τ

−

τ0)) cos(Ωτ0 + φ) + ϑ sin(Ωτ0 + φ))

m33 =

cos(ω(τ

τ0)) +

2

ε
ω

−

(cid:16)
where we have used the notations

(cid:16)

(cid:17)

λ−Ω
ω

2

(cid:17)

α = cos(ω(τ

τ0)) sin(Ωτ + φ) + λ−Ω

ω sin(ω(τ

τ0)) cos(Ωτ + φ)

β = λ−Ω

ω cos(ω(τ

γ = sin(ω(τ

τ0)) cos(Ωτ + φ)

−

−
τ0)) cos(Ωτ + φ) + λ−Ω

sin(ω(τ

τ0)) sin(Ωτ + φ)

ω cos(ω(τ

τ0)) sin(Ωτ + φ)

−

−

ζ = λ−Ω

ω sin(ω(τ

−

τ0)) sin(Ωτ + φ)

cos(ω(τ

τ0)) cos(Ωτ + φ)

−

−

−

−

−

ϑ = λ−Ω

ω (1

−

cos(ω(τ

τ0)))

−











95

E Noncanonical Scaling of the Orbital Vari-
ables in the Case of the Simplest Storage
Regime

In the case of the simplest storage regime, that is

π0(z)

const > 0,

≡

it is typical in accelerators physics to keep the orbital position variables
unchanged and to normalize the corresponding momenta to the value of the
design kinetic momentum π0. So, following tradition, we would like to have
the possibility to describe the orbital motion using the new variables






xnew = xold,

ynew = yold,

σnew = σold

P new
x

= P old

x /π0,

P new
y

= P old

y /π0,

εnew = εold/π0

(182)

where the superscript ′old′ indicates variables of subsection 9.2.

Unfortunately the coordinate transformation (182) is not symplectic and
even if for the study of the orbital motion alone we can treat this transforma-
tion as canonical using a rescaled Hamiltonian (see remark 2 in subsection
4.1), we cannot proceed in the same manner for the case of fully coupled
equations of spin-orbit motion. So we will restrict ourselves to presenting
the Hamiltonian which will give us the correct form of the triangular system
in new variables. This will not be applicable to the study of the eﬀect of
the spin on the orbit motion if we admit the complete equations of motion
(21)-(23).

In the variables introduced above the spin-orbit Hamiltonian becomes

˘H = ˘Horbt + ˘Hspin

˘Horbt =

ˆHorbt
π0

=

æ x ˘π ~B + æ y ˘π ~N −
−

(1 + hx + αy) ˘π ~T −

e
π0c

−

Az + ε +

σ
π0β0c

dE0
dz

+

d ˜A0
~N
dz

x

e
π0c 


+ y

d ˜A0
~B
dz 


96

˘Hspin =

α sx + h sy −
−

æ sz +

(1 + hx + αy)
˘π ~T

~˘W

~s

·

where

~˘W =

−

e
π0c 


(1 + γG) ~

B −

~˘π

π2
0G
m2

~
B
0c2(1 + γ) −

~˘π

(cid:16)

(cid:17)

·

π0
m0c  

G +

1
1 + γ !

~˘π

~
E

×

h


i


~˘π = (˘π ~N , ˘π ~B, ˘π ~T )

˘π ~N =

π ~N
π0

= Px −

e
π0c

∆A ~N ,

˘π ~B =

π ~B
π0

= Py −

e
π0c

∆A ~B

˘π ~T =

π ~T
π0

=

γ2
1
−
0γ2
β2
0 −

s

˘π2
~N −

˘π2
~B

γ = γ0 + γ0β2
0

ε
 

−

e
π0β0c

∆Φ

!

For such scaling the conversion formulae between variables in the curvilin-
y, E′, t′

ear coordinate system connected with the closed orbit z′, x′, P ′
and our ﬁnal coordinates z, x, Px, y, Py, σ, ε have the form

x, y′, P ′

x = π0Px + (e/c) ˜A0
P ′
~N

y = π0Py + (e/c) ˜A0
P ′
~B

σ/(β0c),

E′ = E0 + (π0β0c) ε

x′ = x,

y′ = y,

t′ = t0 −
z′ = z

The rule for the substitution of the arguments reads now as

F (t′, x′, y′, z′)

F

t0 −

 

→

, x, y, z

!

σ
β0c

97

The expressions for the projections of the magnetic ﬁeld and for Az keep
the same form as in subsection 4.6, and the connection between the electric
ﬁeld and the potentials becomes

E ~N =

∂Φ
∂x

−

+ β0

E ~B =

∂Φ
∂y

−

+ β0

∂A ~N
∂σ

∂A ~B
∂σ

E ~T =

1
1 + hx + αy  

∂Φ
∂z

−

+ æ

y

 

∂Φ
∂x −

x

∂Φ
∂y !!

+ β0

∂A ~T
∂σ

F FORGET-ME-NOT, a Computer Code for
the Study of Polarized Beam Dynamics

The computer code FORGET-ME-NOT has been written for the study
of unpolarized and polarized beam dynamics and among other things includes
the following important options:

1. Calculation of the strengths of the imperfection spin resonances and
ﬁrst order intrinsic spin resonances with betatron oscillations with the help
of an averaging method.

2. Calculation of one-turn Taylor maps for orbit and spin motion up to
arbitrarily high order with respect to the amplitudes of the betatron and
synchrotron oscillations and determination of

2.1. Invariant functions of the orbit motion.
2.2. Equilibrium polarization direction.
2.3. Dependence of orbit and spin tunes on the invariants of orbit motion

(spread of orbit and spin tunes).

3. Numerical tracking of particles with spin in accelerators and storage

rings preserving:

3.1. Symplecticity with respect to the 6-D orbit motion.
3.2. Orthogonality with respect to the 3-D spin motion.
All options use the same physical model. The use of various approaches
allows us to understand the computed results from various points of view.
FORGET-ME-NOT, for example, has been applied to the investigation of

98

schemes for preserving the polarization in the TRIUMF KAON Booster [6, 7],
to the investigation of spin motion at high energies in the HERA proton ring
[11] and to the study of the possibility to accelerate the polarized proton
beam in the Nuclotron ring in Dubna [32].

99

References

[1] Balandin, V.V., Golubeva, N.I., Nonlinear Spin Dynamics, Proc. XV
Int. Conf. High Energy Accelerators, Hamburg, 1992, Int. J. Mod. Phys.
A, 2B, 998, (1992).

[2] Balandin, V.V., Golubeva, N.I., Hamiltonian Methods for the Study of
Polarized Proton Beam Dynamics in Accelerators and Storage Rings,
Computational Accelerator Physics Conference, Williamsburg, Virginia,
USA, (1996).

[3] Thomas, L.H., Philos. Mag., 3:1, (1927).

[4] Bargmann, V., Michel, L., and Telegdi, V.L., Precession of the polariza-
tion of particles moving in a homogeneous electromagnetic ﬁeld, Phys.
Rev. Lett., 2(10):435-436, (1959).

[5] Landay, L.D., Lifshitz, E.M., The Classical Theory of Fields, Volume 2

of Course of Theoretical Physics, London-Paris, 1959.

[6] Balandin, V.V., Golubeva, N.I., Investigation of Spin Motion in the

Booster Lattice, TRIUMF Report TRI-DN-93-K236, (1993).

[7] Balandin, V.V., Golubeva, N.I., Fast Betatron Tune Jumps and Partial
Siberian Snakes for Preserving the Polarization in the Booster Lattice,
TRIUMF Report TRI-DN-93-K240, (1993).

[8] Balandin, V.V., Golubeva, N.I., Taylor Maps and Calculations of Equi-
librium Polarization Direction for Proton Storage Rings, Particle Accel-
erator Conference, Washington, USA, (1993).

[9] Balandin, V.V., Golubeva, N.I., Investigation of Spin Resonance Cross-
ing in Proton Circular Accelerators, Particle Accelerator Conference,
Washington, USA, (1993).

[10] Balandin, V.V., One of Methods to Extract Truncated Taylor Map for
Orbital and Spin Motion in Proton Storage Rings, Particle Accelerator
Conference, Washington, USA, (1993).

[11] Balandin, V.V., Golubeva, N.I., Barber, D.P., Studies of the Behaviour
of Proton Spin Motion in HERA-p at High Energies, DESY M 96-04,
(1996).

100

[12] Guillemin V., Sternberg S., Symplectic Techniques in Physics, Cam-

bridge University Press, 1984.

[13] Nemytskij, V.V., Stepanov, V.V. Qualitative theory of diﬀerential equa-
tions, Moscow-Leningrad: OGIZ 1947. (English translations: Princeton
University Press, 1960.)

[14] Dubrovin, B.A., Fomenko, A.T., Novikov, S.P., Modern Geometry -
Methods and Applications, Nauka, Moscow 1979. (English translations
in two parts: Part 1: The geometry of surfaces, transformation groups
and ﬁelds, Graduate Texts in Mathematics 93, Springer-Verlag, 1984;
Part 2: The geometry and topology of manifolds, Graduate Texts in
Mathematics 104, Springer-Verlag, 1985.)

[15] Olver, P.J., Applications of Lie Groups to Diﬀerential Equations, Second
Edition, Graduate Texts in Mathematics 107, Springer-Verlag, 1993.

[16] Montague, B.W., Elementary Spinor Algebra for Polarized Beams in

Storage Rings, Particle Accelerators, Vol. 11, (1981).

[17] Cartan, E. The Theory of Spinors. HERMAMN, Paris, 1966.

[18] Dragt, A.J., Finn, J.M., Lie Series and Invariant Functions for Analytic

Symplectic maps, J.Math. Phys, 17, (1976).

[19] Dragt, A.J., Lectures on nonlinear Orbit Dynamics, in Physics of High

Energy Particle Accelerators, AIP Conf. Proc. 87, (1982).

[20] Bruno, A.D., The restricted 3-Body Problem. Nauka, Moscow 1986. (En-
glish translations in: de Gruyter Expositions in Mathematics 17, Walter
de Gruyter, 1994.)

[21] Yakubovich, V.A., Starzhinskii, Linear diﬀerential equations with peri-
odic coeﬃcients and their applications. Nauka, Moscow 1972. (English
translations in two parts: Vol. 1,2, Israel Program for Scientiﬁc Trans-
lations, Jerusalem, and Wiley, New York, 1975.)

[22] Marsden, J.E., Lectures on Mechanics, Cambridge University Press,

1992.

[23] Quispel, G.R.W., Capel, H.W., Solving ODEs numerically while pre-

serving a ﬁrst integral , Phys. Lett. A 218, 223, (1996).

101

[24] Suzuki, M., Fractal decomposition of exponential operators with applica-
tions to many-body theories and Monte Carlo simulations, Phys. Lett.
A 146, 319, (1990).

[25] Suzuki, M., General theory of higher-order decomposition of exponential

operators and symplectic integrators, Phys. Lett. A 165, 387, (1992).

[26] Sanz-Serna, J.M., Calvo, M.P., Numerical Hamiltonian Problem, Lon-

don; New-York: Chapman and Hall, 1994.

[27] Yoshida, H., Construction of Higher Order Symplectic Integrators, Phys.

Lett. A 150, 262, (1990).

[28] Forest, E., Bengtsson, J., Reusch, M.F., Application of the Yoshida-
Ruth techniques to implicit integration and multi-map explicit integra-
tion, Phys. Lett. A 158, 99, (1991).

[29] Levich, Benjamin G., Theoretical Physics, Volume 1: Theory of the Elec-
tromagnetic Field. Theory of Relativity, Amsterdam-London, 1970.

[30] Mais, H., Ripken, G., Theory of Coupled Synchro-Betatron Oscillations

(I), DESY M-82-05 and later papers.

[31] Barber, D.P., Mais, H., Ripken, G., Willike, F., Nonlinear Theory of
Coupled Synchro-Betatron Motion, DESY 86-147 and later papers.

[32] Kondratenko, A.M., Golubeva, N.I., Depolarization of Proton Beam
in the Nuclotron Ring at JINR, VII Workshop on High Energy Spin
Physics, Dubna, July 1997.

[33] a) Derbenev, Ya.S., How the Stern-Gerlach eﬀect could work for polar-
ization in storage rings?, University of Michigan, Ann Arbor, Preprint
UM HE 90-23, 1990.
b) Derbenev, Ya.S., The Stern-Gerlach method in charged particle stor-
age rings. - 1. The double-resonance Stern-Gerlach eﬀect, University of
Michigan, Ann Arbor, Preprint UM HE 90-30, 1990.
c) Derbenev, Ya.S., The Stern-Gerlach method in charged particle stor-
age rings. - 2. The neo-classical Stern-Gerlach eﬀect, University of
Michigan, Ann Arbor, Preprint UM HE 90-32, 1990.

[34] Niinikoski, T.O., Rossmanith, R., Nucl.Inst.Meth., A255, 469(1987).

102

[35] Barber, D.P., Heinemann, K., Ripken, G., A canonical 8-dimensional
formalism for classical spin-orbit motion in storage rings. I. A new pair
of canonical variables, Z. Phys. C65 117-142(1994).

103

