8
9
9
1
 
r
p
A
 
7
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
9
0
0
4
0
8
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

The Dynamic Aperture and the High Multipole
Limit

G. Parzen

February 6, 1998
BNL-65364

Contents

1 Introduction

2 The high multipole limit in 2-dimensions

3 The high multipole limit in 4 dimensions

4 High multipole limit and the dynamic aperture

5 RHIC lattice results

6 Deﬁnition of stability

7 Transfer functions for lattice elements

8 Longterm eﬀects and the high multipole limit

1

3

12

17

22

30

32

34

1

Abstract

Tracking studies have indicated that for a lattice whose elements all have
a single ﬁeld multipole present, all having the same order k, the dynamic
aperture approaches a non zero limit when k becomes very large. The dy-
namic aperture and other properties of the lattice, as k becomes large, will
be called the high multipole limit. It will be shown that the high multipole
limit provides a reasonable estimate of the dynamic aperture of an acceler-
ator, and the other properties of the high multipole limit found below are
useful for understanding the stability of the accelerator. The high multipole
limit is easily computed and it also provides an estimate of how much can
be gained by correcting the lower ﬁeld multipoles. The above results will be
illustrated by tracking studies done with a simple one cell lattice, and with
a RHIC lattice having six low beta insertions.

Chapter 1

Introduction

Tracking studies have indicated [1] that for a lattice whose elements all have
a single ﬁeld multipole present, all having the same order k, the dynamic
aperture approaches a non-zero limit when k becomes very large. The dy-
namic aperture and other properties of the lattice, as k becomes large, will
be called the high multipole limit. It will be shown that the high multipole
limit provides a reasonable estimate of the dynamic aperture of an acceler-
ator, and the other properties of the high multipole limit found below are
useful for understanding the stability of the accelerator. The high multipole
limit is easily computed and it also provides an estimate of how much can
be gained by correcting the lower ﬁeld multipoles.

The above results will be illustrated by tracking studies done with a sim-
ple one cell lattice, and with a RHIC lattice having six low beta insertions.
The properties of the high multipole limit that are demonstrated in these
tracking studies can be used to answer the following kinds of questions about
the dynamic aperture:

1. Up to which order multipole does one have to correct to regain the

aperture loss due to the ﬁeld multipoles present.

2. How much is the aperture loss due to the ﬁeld multipoles present.

The following are some properties of the high multipole limit discussed
below which can be useful in understanding the stability of a given lattice:

1. The stability boundary in the high multipole limit is dominated and
determined by one set of elements in the lattice, and that is the set
of elements which have the smallest value of R/β0.5, where β is the
linear beta function at the element and R is the multipole parameter
that corresponds to the magnet radius.

1

CHAPTER 1.

INTRODUCTION

2

2. Analytical results can be found for the stability boundary in the high
multipole limit which can be used to estimate the loss in aperture due
to the multipoles present in the lattice.

3. The stability boundary in the high multipole limit does not depend on
the strength of the multipoles or on the choice of the linear tunes, νx
and νy. This leads to the suggestions that the stability boundary of
a lattice is insensitive to the magnitude of the higher multipoles, and
the linear tune needs to be chosen to avoid the resonances driven by
the lower order multipoles. Higher and lower multipoles are deﬁned
below.

Chapter 2

The high multipole limit in
2-dimensions

This section will be devoted to establishing the basic rule for the high mul-
tipole limit in 2-dimensional phase space. Consider a linear periodic lattice
where each element of the lattice is perturbed by a single non-linear ﬁeld
multipole, and the order of this multipole, k, is the same in each element.
The ﬁeld multipole will produce a ﬁeld in each element whose vertical com-
ponent, By, in the median plane is given by

By = B0 bk xk,

bk = b/Rk

(2.1)

In computing the high multipole limit, we will be computing the dynamic
aperture of this lattice for diﬀerent values of k, and in particular for large
values of k. R may vary from element to element, but does not vary with
k. b may vary from element to element, and b may also vary with k but
not by large factors.The dominant variation in bk with k is given by the
1/Rk factor.(More exactly, (∆b/b)1/k approaches 1 for large enough k,
where ∆b is the largest change in b either from element to element or as
a function of k.) For an actual accelerator, R may be chosen as the radius
of the magnet coil, and the measured b = bkRk has to satisfy the above
conditions in order to apply the high multipole limit results found below.
Let x0, px0 be the initial particle coordinates. One may deﬁne the stability
boundary to be a closed curve in x0, px0 such that for any choice of x0, px0
outside this boundary the particle motion for a given number of periods will
be considered unstable. The deﬁnition of stability is discussed in section 6.
The basic rule may now be stated as follows:

Basic rule for the high multipole limit in 2 dimensional phase space.

3

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

4

(2.2)

(2.3)

For a particle moving through a linear periodic lattice in the 2 dimen-
sional phase space of x, px, in the presence of non linear ﬁeld multipoles bk,
which have the form

bk = b/Rk

the stability boundary which encloses the stable area in x0, px0, for a given
number of periods and for large enough k, is given by

ǫ(x0, px0) = [R2/βx]min

ǫ(x, px) = γx x2 + 2αx x px + βx p2
x
[R2/βx]min is the minimum value of R2/βx in the elements of the lattice
where bk is not zero, and γx, αx, βx are the linear parameters of the lattice.
An analytical argument can be given which indicates what lies behind
Eq. 2.3. For very large k, the multipole ﬁeld as given by Eq. 2.1 approaches
zero when x in any element is smaller than the R value of that element.
Thus for small enough x, ǫ(x, px) becomes a constant of the motion. Some
thought will then show that the element with the smallest value of R2/βx
determines the largest emittance that is stable, which is given by Eq. 2.3.
A possible ﬂaw in this argument is that for a given k, no matter how large,
when x gets close enough to the stability boundary , the multipole ﬁeld can
become appreciably diﬀerent from zero.

The above basic rule will be justiﬁed below by doing a number of numer-
ical tracking experiments, tracking particles through a number of diﬀerent
lattices. Most of the tracking experiments reported below are done with a
simple one cell lattice. The results found will be further illustrated with
results for a RHIC lattice with 6 low beta insertions.

The simple one cell lattice

The simple one cell lattice initially used in this study consists of a fo-
cussing quadrupole, qf , and a defocussing quadrupole, qd, separated by drift
spaces of equal length. The perturbing non-linear ﬁeld multipole is initially
placed in the middle of qf . The observation point for measuring the dy-
namic aperture is initially chosen to be at the middle of the perturbing ﬁeld
multipole. This simple one cell lattice will be referred to as the simple one
cell lattice.

The perturbing ﬁeld multipole is a point multipole which produces a
vertical ﬁeld on the median plane whose integrated strength, ﬁeld times
length, is given by

B0 b xk/Rk

(2.4)

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

5

The parameters B0, b, R are usually chosen to make the lattice resemble the
RHIC lattice, with nonlinear eﬀects of the same order as those seen in RHIC.
To examine the high multipole limit one will be particularly interested in
ﬁnding the dynamic aperture for large values of k.

The transfer functions, that give the ﬁnal particle coordinates for a given
set of its initial coordinates for each element in the lattice, are given in
section 7. For the reasons given there, the exact equations of motion are
used in ﬁnding the transfer functions. The parameters of the quadrupole
and drift spaces are initially chosen to produce the tune νx0 = 0.1740. This
tune was chosen to lie in a region free of all resonances up to the tenth order,
and it lies between the 1/5 and 1/7 resonances. The lattice parameters are
given in section 7.

xsl0 vs k at qf for the simple lattice with a single bk at qf

The basic rule for the hml (high multipole limit), and Eq. 2.3 will be
illustrated by doing tracking runs using the simple one cell lattice. A single
ﬁeld multipole bk, as given by Eq. 2.4, will be placed in the middle of the
focusing quadrupole qf . The particle will be started with px0 = 0, and x0
will be varied to ﬁnd the largest x0 that is stable for 100 periods, which will
be denoted by xsl0. This will be done for diﬀerent values of k, the order
of the multipole. According to Eq. 2.3, since in this case px0 = 0, αx = 0,
one should ﬁnd for large enough k that xsl0 = R. Here R was chosen as
R = 0.04 m. The results are shown in Fig. 2.1.

One sees that at lower values of k, xsl0 varies rapidly and then levels out
at a value close to xsl0 = R = 0.04. The high multipole limit gives a good
approximation for xsl0 starting with the relatively low values of k > 10 for
non-linear multipoles of the order of those expected in RHIC. It will be seen
below that this property helps to make the high multipole limit useful for
estimating the dynamic aperture of an accelerator.

The stability surface at qf for the simple lattice with a single bk at qf

The stability boundary in the high multipole limit will now be found
for the simple one cell lattice with just one bk at qf . To ﬁnd the stability
surface in x0, px0, one can search along diﬀerent directions in x0, px0 space
to ﬁnd the stability boundary in that direction. One may write the initial
coordinates as

x0 = (βx ǫx0)0.5cos(απ/2)
px0 = (ǫx0/βx)0.5sin(απ/2)

(2.5)

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

6

xsl0               xsl0  vs  k

b=.024

0.1

0.08

0.06

0.04

0.02

2.5

5

k
7.5 10 12.5 15 17.5 20

Figure 2.1: A plot of xsl0 versus k for the simple one cell lattice with a
single multipole of order k at qf . xsl0 is the largest x0 that is stable for 100
periods. px0 = py0 = y0 = 0 and 2 dimensional motion. In the ﬁgure xs10
represents xsl0 .

α gives the direction of search in x0, px0 and ǫx0 is the initial linear emittance
for this choice of x0. px0 at qf where αx = 0, βx = 68.4497 m. To do
the search ǫx0 will be increased until the motion becomes unstable for a
particular choice of α. The value of ǫx0 that lies on the stability boundary
for this search direction will be denoted by ǫxsl0. According to the basic rule
for the high multipole limit, Eq. 2.3, we should ﬁnd that ǫxsl0 is constant
for all directions at the value ǫxsl0 = R2/βx = 23.37482740. This would
establish the basic rule for this lattice. This tracking study is done with a
single ﬁeld multipole, bk, at the middle of qf . In order to ﬁnd the stability
boundary for the high multipole limit, k is chosen at the large value of
k = 1 · 106. The results of this tracking study are shown in Table 2.1, where
ǫxsl0 is shown as a function of α.

One sees in Table 2.1 that ǫxsl0 for diﬀerent directions is almost constant
at the value 23.37482740 as predicted by the basic rule. However, there is a
variation in ǫxsl0 of about .2%, which appears to show that the basic rule for
high multipole limit, Eq. 2.3, is not exact but has a small error in it. This
error is not important for the main results of this paper. This particular
study shows that it is convenient to have a precise deﬁnition of stability such
as is given in section 6.

xslo at qd for the simple lattice with a single bk at qf

Our next step will be to consider the stability limit at some other location

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

7

α
−1
−0.75
−0.5
−0.25
0.
0.25
0.5
0.75
1.

ǫxsl0
23.3893
23.3749
23.3756
23.3748
23.3747
23.386
23.4199
23.4024
23.3893

Table 2.1: The linear emittance, ǫxsl0, computed for diﬀerent points, x0, px0
on the stability boundary in the hml, corresponding to diﬀerent directions
in x0, px0 space, at the location of qf in the simple one cell lattice. The
parameter α gives the diﬀerent directions according to Eqs. 2.5. ǫxsl0 is in
mm mrad.

in the lattice, where βx is not at its maximum value, such as at qd where
βx is βx = 21.12345678. According to the basic rule for the high multipole
limit for the simple one cell lattice, the stability limit in x0 when px0 = 0 at
qf , xsl0f , is related to the stability limit at qd, xsld, at large enough k, by

xsl0d = (βxd/βxf )0.5 xsl0f

(2.6)

where βxf and βxd are the beta functions at qf and qd. This is illustrated
in Table 2.2 where xslf and xsld are compared as a function of k, the order
of the ﬁeld multipole at qf .

k
1000000
10000000
100000000

xslqd
0.02248406
0.0224841
0.02248411

xslqf
0.03999994
0.03999999
0.03999999

[xslqd/xslqf ]qβxf /βxd
1.0000187
1.0000193
1.0000198

Table 2.2: A table showing how well xsl0 in the hml varies like β0.5
through
x
the lattice. xslo is the largest x0 that is stable for 100 periods for the simple
one cell lattice when px0 = 0 with a single multipole of order k at qf . xsl0 at
qf and qd are indicated by xsl0f and xsl0d, and βxqf and βxqd are the linear
beta functions at qf and qd. All lengths are in meters.

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

8

One sees from Table 2.2 that the prediction of the basic rule for this case,
as given by Eq. 2.6, is valid with an error of about 2 10−5. The reason for
varying k was to show that the error found was not due to k not being large
enough as the basic rule for the high multipole limit holds only for large
enough k values. The error in computing the beta functions also appears to
be too small to account for the error found in Table 2.2.

xslo at qd and qf for the simple lattice with a single bk at qf and a bk at
qd with a diﬀerent R value

We will now consider the case of the simple one cell lattice with two ﬁeld
multipoles present; one at qf and one at qd. The ﬁeld multipole at qd will
have an R-value (see Eq. 2.4), Rqd which is diﬀerent from the R-value, Rqf ,
of the multipole at qf . According to the basic rule for the hml, Eq. 2.3,
when Rqd = Rqf , the multipole at qf will dominate in determining the hml
since [R2/βx]min will occur at qf where βx has its maximum. In particular,
Eq. 2.3 gives xsl0 when ps0 = 0 as xsl0f = Rqf , while xsl0 at qd is given by
Eq. 2.6 as xsl0d = q[βxd/βxf ]Rqf . If one now reduces Rqd, the multipole at
qf will continue to dominate until Rqd reaches the value q[βxd/βxf ]Rqf , and
then the multipole at qd will start to dominate, and xsl0d will be given by
Rqd while xsl0f will be given by q[βxf /βxd]Rqd. These results are illustrated
by the computed results given in Table 2.3 where xsl0f and xsl0d are shown
as Rqd/Rqf is decreased from 1 to 0.2. For this lattice Rqf is held constant
at 0.04 m and q[βxd/βxf ] = 0.56209177.

It will be suggested below that the high multipole limit provides a rea-
sonable measure of the dynamic aperture. Assuming this to be so, then the
basic rule for the hml states that in an accelerator the dynamic aperture is
dominated by the magnet with the smallest R/β0.5
x . For example, if an ac-
celerator has 6 insertions with 6 crossing points, with similar magnets that
are excited to give diﬀerent βx at the crossing points, the magnet which
has the largest βx will dominate and determine the dynamic aperture[2].
This magnet is located in the insertion with the smallest βx at the crossing
point. The dynamic aperture at other locations in the lattice will scale like
(βx/βxmax)0.5 where βxmax is the largest βx in the lattice.

The dependence of xsl0 vs k at qf on the strength of ﬁeld multipole, b

In the previous tracking studies, the multipole present is assumed to
have the form, bk = b/Rk, where b is the integrated strength of the point
multipole. b and R can vary from one element in the lattice to another.

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS

9

Rqd/Rqf
1.
0.9
0.8
0.7
0.6
0.55
0.5
0.4
0.3

xsl0qf
0.03999
0.03999
0.03999
0.03999
0.03999
0.03914
0.03558
0.02846
0.02134

Rqd
0.04
0.036
0.032
0.028
0.024
0.022
0.02
0.016
0.012

xsl0qd
0.02248
0.02248
0.02248
0.02248
0.02248
0.02199
0.01999
0.01599
0.01199

Table 2.3: A table showing that the stability boundary in the hml is de-
termined by the element in the lattice with the smallest value of R/β0.5
x .
Results shown are for the simple one cell lattice with a single multipole with
the same order at qf and qd. Rqf , Rqd and xsl0f , xsl0d are the R and xsl0
parameters at qf and qd. All lengths are in meters.

The basic rule for the high multipole limit, Eq. 2.3, does not show any
dependence on b. Tracking studies show that when b is increased, the high
multipole limit is unchanged, but one must go to a larger value of k before
the high multipole limit is reached. The studies also show that for large
enough values of k, xsl0, the largest stable x0 when px0 = 0, goes like b(1/k).
This indicates that for large enough k, xsl0 is insensitive to the size of b.
For RHIC, the high multipole limit is reached for relatively low values of k,
k ∼ 10, and this result is insensitive to the size of the non-linear multipoles.
Assuming the high multipole limit is a good measure of the dynamic aperture
of an accelerator, then the dynamic aperture of an accelerator should be
insensitive to the size of the higher multipoles, k larger than 10 for RHIC.
Fig. 2.2 shows xsl0 plotted against k for the simple one cell lattice with
a single bk at qf . The two plots shown are for b = 0.024 m and for b = 0.24
m.

One sees that the same high multipole limit is reached at about k = 10

for b = .024 and about k = 24 for b = 0.24.

Fig. 2.3 shows that xsl0 ∼ b(1/k) by plotting xsl0(0.024)/xsl0(0.24)/10(1/k)

against k. This ratio should approach 1 for large k if xsl0 ∼ b(1/k).

In the above it was shown that xsl0 ∼ b(1/k) which shows the dependence
of xsl0 on b for a ﬁxed k. A more complete result which also shows the

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS 10

xsl0               xsl0  vs  k

b=.024

0.1

0.08

0.06

0.04

0.02

b=.24

2.5

5

k
7.5 10 12.5 15 17.5 20

Figure 2.2: A plot showing how xsl0 versus k depends on the strength, b, of
the single multipole at qf for the simple one cell lattice, by comparing two
cases where b diﬀers by a factor of 10. In the ﬁgure xsl0 represents xsl0.

dependence on k is

xsl0 ∼ b(1/k)/k

(2.7)

The dependence of the high multipole limit stability boundary on the choice
of linear tunes, νx and νy

Tracking studies done with the simple one cell lattice indicate that the
stability boundary in the high multipole limit does not depend on the choice
of linear tunes, νx and νy. This leads to the suggestion, see section 8, that the
linear tunes be chosen to avoid the resonances driven by the lower multipoles.
The term lower multipoles is deﬁned below.

CHAPTER 2. THE HIGH MULTIPOLE LIMIT IN 2-DIMENSIONS 11

 xsl0(.024)/xsl0(.24)/10^(1/k)  vs  k

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

2.5

5

7.5 10 12.5 15 17.5 20

k

Figure 2.3: A plot showing that xsl0 depends on the multipole strength like
xsl0 ∼ b(1/k) for large k, by comparing two cases where b diﬀers by a factor
of 10. In the ﬁgure, xsl0 represents xsl0.

Chapter 3

The high multipole limit in 4
dimensions

In 2 dimensional phase space motion, the stability boundary that encloses
the stable area in x0, px0 in the high multipole limit is given by

ǫ(x0, px0) = [R2/βx]min

(3.1)

One may ask what is the stability boundary for motion in 4 dimensional
phase space in the high multipole limit. To answer this, one has to consider
the motion of a particle moving in a lattice whose only nonlinear ﬁeld in
each element is that of a single multipole given by

By + iBx = −B0 b((x + iy)/R)k

(3.2)

where R may depend on s, and so may b although not by very large fac-
tors. To ﬁnd the high multipole limit stability boundary, one may use the
argument given in section 2. For very large k, and for x2 + y2 not close to
R2, Eq. 3.2 shows that By ∼ Bx ∼ 0. Thus for x2 + y2 not close to R2,

ǫx(x, px) = ǫx0,

ǫy(y, py) = ǫy0

(3.3)

where ǫx0, ǫy0 are two constants and ǫx and ǫy are the linear emittance
invariants. In addition for stable motion one has

Equation 3.4 can be restated as, using Eq. 3.3,

(x2 + y2) < R2

(βx ǫx0 + βy ǫy0) < R2

12

(3.4)

(3.5)

CHAPTER 3. THE HIGH MULTIPOLE LIMIT IN 4 DIMENSIONS 13

Eq. 3.4 limits the range of ǫx0, ǫy0 for which the motion is stable. On the
stability boundary , ǫx and ǫy are constant with the values of ǫx0 and ǫy0
respectively, and for each set of values of ǫx0 and ǫy0 that are on the stability
boundary, x2 + y2 must be less than or equal to R2 for each element and at
some point around the lattice x2 + y2 must be equal to R2.

Eqs. 3.3 through 3.5 deﬁne the stability boundary in the high multipole
limit. The stability boundary for the high multipole limit may be visualized
as a curve in ǫx0, ǫy0 space as shown in Fig. 3.1. For motion in 4 dimensional
phase space, there does not appear to be a simple solution for the stability
boundary in ǫx0, ǫy0 space. This solution may depend on the particular
form of βx(s), βy(s). There are, however, 3 points on the stability boundary
for which one can ﬁnd simple results. These are the 3 points for which 1.
ǫx0 = 0, 2. ǫy0 = 0 and 3. ǫx0 = ǫy0.

epy0 vs epx0 (mm. mrad.)

epy0
80

70

60

50

40

30

20

10

5

10

15

20

25

30

35

40

epx0

Figure 3.1: A plot showing the stability boundary in the hml for 4 dimen-
sional motion, for the simple one cell lattice, as a plot of ǫy0 versus ǫx0.
epy0, epx0 represent ǫy0, ǫx0.

For the ǫy0 = 0 point, Eqs. 3.3 through 3.5 give

ǫx0 = [R2/βx]min,

ǫy0 = 0

(3.6)

[R2/βx]min is
as the value of ǫx0 on the stability boundary when ǫy0 = 0.
the minimum value of R2/βx around the lattice. With this value of ǫx0 and
ǫy = 0, one can show that (x2 + y2) is less than or equal to R2 at every
element in the lattice. Similarly for ǫx0 = 0, one ﬁnds

ǫy0 = [R2/βy]min,

ǫx0 = 0

(3.7)

CHAPTER 3. THE HIGH MULTIPOLE LIMIT IN 4 DIMENSIONS 14

When ǫx0 = ǫy0, one ﬁnds

ǫx0 = ǫy0 = [R2/(βx + βy)]min

(3.8)

The three points on the stability boundary given by Eqs. 3.6 through 3.8
provide a fairly good picture of the stability boundary. A fairly good approx-
imation can be obtained by drawing two straight lines between the known
three points.

For accelerators which have insertion regions where βx, βy have excep-
tionally large values which occur in magnets which have the same R value,
Rins, then Eqs. 3.6 through 3.8 can written as

ǫx0 = R2
ǫy0 = R2
ǫx0 = ǫy0 = R2

ins/βxmax,
ins/βymax,

ǫy0 = 0
ǫx0 = 0
ins/(βx + βy)max

(3.9)

βxmax is the largest βx in the lattice, and βymax and (βx +βy)max have similar
meanings.

Often, in tracking studies one does runs with initial values ǫx0 = ǫy0 and
px0 = 0, py0 = 0, increasing x0 until the motion becomes unstable for a given
number of periods. The corresponding value of x0 may be labeled xsl0. If
one does tracking studies where all the bk present have the same k value,
then for large enough k, the basic rule high multipole limit in 4 dimensions
states that xsl0 will approach a non-zero value given by Eq. 3.8 as

xsl0 = q(βx0/R2

0)[R2/(βx + βy)]min

(3.10)

where βx0 and R0 are these parameters at the element where xsl0 is mea-
sured. For the insertion case described by Eq. 3.9, xsl0 is given by

xsl0 = (R0/Rins)qβx0/(βx + βy)max

(3.11)

In Fig. 3.1, ǫy0 is plotted against ǫx0 showing the stability boundary in
the initial emmitance space of ǫx0, ǫy0. This curve was found by a tracking
study using the simple one cell lattice with a single bk at qf . k was chosen
at the large value of k = 1 106, so that the curve is a good approximation
of the high multipole limit. In this case the stability boundary in ǫx0, ǫy0 is
almost a straight line. A simple approximation of the stability boundary is
a straight line connecting the end points, the ǫx0 = 0 point and the ǫy0 = 0
point. According to Eqs. 3.6 through 3.8 this straight line is given by

ǫx0/[R2/βx]min + ǫy0/[R2/βy]min = 1

(3.12)

CHAPTER 3. THE HIGH MULTIPOLE LIMIT IN 4 DIMENSIONS 15

For the simple one cell lattice used here, where bk is not zero only at the qf
element, then [R2/βx]min = R2/βxqf and [R2/βy]min = R2/βyqf , R = 0.04
m and βxqf = 68.4497, βyqf = 21.6265. One ﬁnds in this case that the
three points on the stability boundary as given by Eqs. 3.6 through 3.8 agree
with the tracking results with an error less than 5 10−3.

One may note that if [R2/βx]min = [R2/βy]min, which is true for RHIC
because βx = βy at the low beta crossing points and tends to be true for
proton colliders, then Eq. 3.12 gives

ǫx0 + ǫy0 = constant

(3.13)

on the stability boundary. Tracking studies indicate that Eq. 3.13 is roughly
true for RHIC. Assuming the high multipole limit provides a reasonable
estimate of the dynamic aperture of the actual accelerator, then the above
shows that the result that the total emittance, ǫx0 + ǫy0, is roughly constant
on the stability boundary is accidental in the sense that it depends on the
properties of the beta functions at the crossing points. If these beta functions
are not equal, then Eq.3.12 will replace Eq. 3.13.

Figure 3.2 illustrates the result given by Eq. 3.10 for xsl0 for the case
when ǫx0 = ǫy0, and px0 = py0 = 0 in the high multipole limit. In ﬁg. 3.2
xsl0 is plotted against the multipole order, k. The results were found in a
tracking study using the simple one cell lattice with a single bk at qf . For this
lattice, with the parameters used, R = 0.04 m, and at qf , βx, βy = 68.4497,
21.6265 m. Eq. 3.10 then gives for xsl0 at very large k, xsl0 = .0349 m.
Fig. 3.2 shows that xsl0 is approaching a value at large k near 0.0349m. At
k = 20, xsl0 = .0348 m was found.

CHAPTER 3. THE HIGH MULTIPOLE LIMIT IN 4 DIMENSIONS 16

xsl0

0.1

0.08

0.06

0.04

0.02

2.5

5

k
7.5 10 12.5 15 17.5 20

Figure 3.2: A plot of xsl0 versus k for the simple one cell lattice with a single
multipole of order k at qf , for 4 dimensional motion when px0 = 0 = py0
and ǫy0 = ǫx0. In the ﬁgure, xsl0 represents xsl0 and is in meters.

Chapter 4

High multipole limit and the
dynamic aperture

The high multipole limit gives a result for the stability boundary that en-
closes the stable area in x0, px0. The goal of this section is to show that
the high multipole limit gives a reasonable approximation for the stability
boundary when all the ﬁeld multipoles are present and the lower multipoles
have been corrected. Conversely, the high multipole limit indicates how
much may be gained by correcting the lower multipoles. The phrase lower
multipoles will be more precisely deﬁned below. Also one will see that when
the nonlinear ﬁeld multipoles are not too large, as is the case in RHIC, the
high multipole limit provides a rough but useful estimate of the dynamic
aperture.

Motion in 2 dimensional phase space

The above statements can be illustrated by the results of a tracking
study in 2 dimensional phase space using the simple one cell lattice with
non linear multipoles only at qf . To simulate the multipoles present in an
accelerator, the point like nonlinear ﬁeld at qf is given by

By = B0 mathrmb(x/R)2(1 − (x/R)50)/(1 − x/R)

(4.1)

Eq. 4.1 gives a nonlinear ﬁeld which contains all multipoles from k = 2
to about k = 50, where all the multipoles decrease like 1/Rk. With the
parameters chosen as R = 0.04m, b = 0.024, this lattice resembles the
RHIC accelerator without insertions.

Fig. 4.1 shows the stability boundary in x0, px0 space as measured at qf .
Two boundaries are shown; one is the high multipole limit, and the other

17

CHAPTER 4. HIGH MULTIPOLE LIMIT AND THE DYNAMIC APERTURE18

px0
                 px0 vs x0

hml

-0.04

-0.02

0.02

x0

0.04

0.0006

0.0004

0.0002

-0.0002

-0.0004

-0.0006

Figure 4.1: A plot of px0 versus xo showing the stability boundary for 2
dimensional motion in the simple one cell lattice with all multipoles from
k = 2 to k = 50 at qf . The stability boundary in the high multipole limit is
also shown. In the ﬁgure, px0,x0 represent px0, p0.

boundary, that is contained inside the hml boundary, is the stability bound-
ary when all the multipoles are present as given by Eq. 4.1. According to
the suggestions made at the beginning of this section, the diﬀerence between
these two boundaries shows the loss in stable phase space due to the lower
multipoles, and also how much phase space can be gained by correcting the
lower multipoles.

The term lower multipoles will be deﬁned as follows.

If one looks at
Fig. 2.1 and Fig. 3.2 which plot xsl0 vs k for the two cases, ǫy0 = 0 and
ǫy0 = ǫx0, one sees that xsl0 gets close to the value given by the high
multipole limit at about k = 10 for the simple one cell lattice. This value
of k where xsl0 gets close to the value given by the hml will be called khml.
The lower multipoles are those multipoles for which k is less than khml. Let
us now correct the lower multipoles from k = 2 to k = 9 giving the plot
shown in Fig. 4.2.

Fig. 4.2 shows that by correcting b2 to b9, the stable phase space area has
been increased so that it lies fairly close to the high multipole limit result,
but still lies within the high multipole limit. If one corrects more multipoles
past b9, the stability boundary will increase approaching the result for the
high multipole limit. Results found using a RHIC lattice will be presented
in section 6 which will also support the validity of the suggestions made in
this section about the connection between the dynamic aperture and the
high multipole limit. One may note that Fig. 4.1 shows that the loss in

CHAPTER 4. HIGH MULTIPOLE LIMIT AND THE DYNAMIC APERTURE19

px0
                 px0 vs x0

hml

-0.04

-0.02

0.02

x0

0.04

0.0006

0.0004

0.0002

-0.0002

-0.0004

-0.0006

Figure 4.2: A plot of px0 versus xo showing the stability boundary for 2
dimensional motion in the simple one cell lattice with multipoles from k = 10
to k = 50 at qf . The lower multipoles, k = 2 to k = 9 have been corrected.
The stability boundary in the high multipole limit is also shown.
In the
ﬁgure, px0,x0 represent px0, x0.

stable phase space due to the non linear multipoles used is about a factor
of 2. About the same factor will be found for a RHIC lattice. Thus one can
say that the hml provides a rough but useful estimate of dynamic aperture
when the multipoles present are of the order of those expected in RHIC,
overestimating the stable phase area in 2 dimensional phase space by about
a factor of 2.

Motion in 4 dimensional phase space

The suggestions made at the beginning of this section can be illustrated
by the results of a tracking study in 4 dimensional phase space using the
simple one cell lattice with nonlinear multipoles only at qf . To simulate the
multipoles present in an accelerator, the point like nonlinear ﬁeld at qf is
given by

By + iBx = B0 b((x + iy)/R)2(1 − (x + iy)/R)50)/(1 − (x + iy)/R) (4.2)

Eq. 4.2 gives a nonlinear ﬁeld which contains all multipoles from k = 2
to about k = 50, where all the multipoles decrease like 1/Rk. With the
parameters chosen as R = 0.04m, b = 0.024, this lattice resembles the
RHIC accelerator without insertions.

Fig. 4.3 shows the stability boundary in ǫx0, ǫy0 space as measured at
qf . Two surfaces are shown; one is the high multipole limit, and other

CHAPTER 4. HIGH MULTIPOLE LIMIT AND THE DYNAMIC APERTURE20

surface, that is contained within the high multipole limit surface, is the
stability boundary when all the multipoles are present as given by Eq. 4.2.
According to the suggestions made at the beginning of this section, the
diﬀerence between these two boundaries shows the loss in stable phase space
due to the lower multipoles, and also how much phase space can be gained
by correcting the lower multipoles.

epy0 vs epx0

hml

epy0
80

70

60

50

40

30

20

10

5

10

15

20

25

30

35

40

epx0

Figure 4.3: A plot of ǫy0 versus ǫx0 showing the stability boundary in ǫx0,
ǫy0 space for 4 dimensional motion in the simple one cell lattice when all the
multipoles from k = 2 to k = 50 are present at qf . The stability boundary
in the high multipole limit is also shown. In the ﬁgure, epy0,epx0 represent
ǫy0, ǫx0.

One may note that the high multipole limit stability boundary in ǫx0,
ǫy0 space is a curve with zero thickness. However for the simple one cell
lattice with all the multipoles present the ǫy0 vs ǫx0 stability curve has a
certain smear or non-zero thickness. This is because for a choice of ǫx0, the
ǫy0 that lies on the stability boundary depends on the choice of x0, px0, y0,
py0. The curve shown in Fig. 4.3 was obtained with px0 = py0 = 0.

Let us now correct the lower multipoles from k = 2 to k = 9 giving the
plot shown in Fig. 4.4. Fig. 4.4 shows that by correcting b2 to b9, the stable
phase space area has been increased so that it lies fairly close to the high
multipole limit result, but still lies within the high multipole limit boundary.
If one corrects more multipoles past b9, the stability boundary will increase
approaching the result for the high multipole limit. Results found using
a RHIC lattice will be presented in section 5 which will also support the
validity of the suggestions made in this section about the connection between
the dynamic aperture and the high multipole limit. The results shown in

CHAPTER 4. HIGH MULTIPOLE LIMIT AND THE DYNAMIC APERTURE21

Figs. 4.3, and 4.4 also show how one can obtain misleading conclusions by
looking at the results for just one direction in ǫx0, ǫyo space like the ǫx0 = ǫy0
direction. In this case the dynamic aperture actually became smaller for this
direction when the k = 2 to 9 multipoles were corrected.

epy0 vs epx0

hml

epy0
80

70

60

50

40

30

20

10

5

10

15

20

25

30

35

40

epx0

Figure 4.4: A plot of ǫy0 versus ǫx0 showing the stability boundary in ǫx0,
ǫy0 space for 4 dimensional motion in the simple one cell lattice when the
multipoles from k = 10 to k = 50 are present at qf . The multipoles from
k = 2 to k = 9 have been corrected. The stability boundary in the high
multipole limit is also shown. In the ﬁgure, epy0,epx0 represent ǫy0, ǫx0.

Chapter 5

RHIC lattice results

This section will illustrate the suggestions made in section 4 that the high
multipole limit gives a reasonable estimate of the dynamic aperture when
the lower multipoles are corrected by giving the results of tracking studies
done with an early version of the RHIC lattice [3]. This lattice has random
non linear multipoles in each element from k = 2 up to and including order
k = 20. Skew multipoles are also present. The lattice has 6 insertions
with 6 low beta crossing points at which βx = 6 m and βxmax = 236m,
βymax = 236m, (βx + βy)max = 309 m. At qf in the normal cell, where x,
px, y, py are observed, βx = 56 m, βy = 8.72m.

The high multipole limit in RHIC

In RHIC, the random multipoles in each element decrease roughly as
Rk. Because the multipoles are chosen randomly corresponding to given rms
values [3], multipoles of diﬀerent order or diﬀerent k values, have diﬀerent
strengths or diﬀerent b values. Elements with diﬀerent R values are also
present. The elements that have the smallest values of R2/βx or R2/βy, and
which are the dominant elements, are in the insertions at the locations of
βxmx and βymx. The RHIC lattice diﬀers from the simple one cell lattice
in the presence of the chromaticity correcting sextupoles. In RHIC, besides
the random multipoles whose rms values decrease like 1/Rk, there is also
a set of multipoles, the chromaticity correcting sextupoles, which do not
ﬁt into the 1/Rk pattern of the random multipoles. Because of this, it is
necessary to change the deﬁnition of the high multipole limit for RHIC.
As described above, the high multipole limit is found by doing a series of
tracking studies in which all the elements of the lattice have one multipole
present of the same order, k, and the particle motion for very large k is

22

CHAPTER 5. RHIC LATTICE RESULTS

23

the high multipole limit.
In the case of RHIC this procedure is changed
in that in each tracking study the chromaticity correcting sextupoles are
present as well as the random multipoles of order k. With this change in
the deﬁnition of the high multipole limit, it is again suggested that the high
multipole limit gives a reasonable estimate of the dynamic aperture when
the lower multipoles are corrected. This will be illustrated by the following
tracking results found using a RHIC lattice. This procedure for deﬁning the
high multipole limit can be used for any lattice for which there is another
nonlinear ﬁeld present as well as a set of multipoles that decrease like 1/Rk;
for example, one systematic multipole may be exceptionally large.

This new deﬁnition of the high multipole limit changes the results found
in sections 2 and 3 for the stability boundary in the high multipole limit. For
very large k, and for x2 + y2 smaller than R2 in each element, the particle
motion is that of a particle in the presence of the chromaticity correcting
sextupoles. In addition for stable motion one has

(x2 + y2) < R2

(5.1)

To ﬁnd the stability boundary, one needs to know what is the maximum
value of x2 + y2 for a given x0, px0, y0, py0. In section 3, this was given by
the linear beta functions. In eﬀect, one has to know what corresponds to
the beta functions for the chromaticity correcting sextupoles for computing
the maximum value of x2 + y2. A semi-empirical solution of this problem
will given below. One might notice one needs to answer this question only if
one wants to have analytical results for points on the stability boundary in
the high multipole limit like those given by Eqs. 3.6 through 3.8. One can
always ﬁnd the stability boundary in the high multipole limit with tracking
studies without much diﬃculty.

Fig. 5.1 shows xsl0 plotted against k. In this study each element contains
only one multipole of order k, and the multipoles in all the elements all have
the same k value and the chromaticity correcting sextupoles are also present.
Two curves are shown. For one curve ǫy0 = 0, and for the second curve,
ǫy0 = ǫx0.

xsl0 is the largest x0 that is stable for 500 turns when py0 = px0 = 0.
Fig. 5.1 is similar to Fig. 3.2 found for the simple one cell lattice and shows
that xsl0 approaches a non zero limit as k becomes large. Using the results
found by tracking runs one can ﬁnd a result for computing xsl0 or ysl0 in the
high multipole limit in RHIC. For the case when the chromaticity correcting
sextupoles are absent, xsl0 and ysl0 are given by Eq. 3.9 as

xsl0 = (R0/Rins)qβx0/βxmax,

ǫy0 = 0

CHAPTER 5. RHIC LATTICE RESULTS

24

xsl0

0.08

0.07

0.06

0.05

0.04

0.03

0.02

0.01

epy0=0

epy0=epx0

2.5

5

k
7.5 10 12.5 15 17.5 20

Figure 5.1: A plot of xsl0 versus k for RHIC. Each element has a single
multipole of the same order, k. For one curve ǫy0 = 0 and px0 = py0 = 0.
For the other curve ǫy0 = ǫx0 and px0 = py0 = 0. xsl0 is computed for 500
turns. In the ﬁgure, xsl0,epy0,epx0 represent xsl0, ǫy0, ǫx0.

xsl0 = (R0/Rins)qβx0/(βx + βy)max,

ǫy0 = ǫx0

(5.2)

ysl0 = (R0/Rins)qβy0/βymax,

ǫx0 = 0

where βx0, βy0 and R0 are these parameters at the element where xsl0 is
measured and for the insertion case described in section 3. To obtain a result
that may be valid when chromaticity correcting sextupoles are present, we
will replace Eqs. 5.3 by

xsl0 = f1 (R0/Rins)qβx0/βxmax,

ǫy0 = 0

xsl0 = f2 (R0/Rins)qβx0/(βx + βy)max,

ǫy0 = ǫx0

(5.3)

ysl0 = f3 (R0/Rins)qβy0/βymax,

ǫx0 = 0

In Eq. 5.3, f1, f2, f3 can be found by using the results for xsl0 and ysl0
found with tracking studies done for RHIC. This gives the results

xsl0 = (R0/Rins)qβx0/βxmax,

ǫy0 = 0

xsl0 = 0.707(R0/Rins)qβx0/(βx + βy)max,

ǫy0 = ǫx0

(5.4)

ysl0 = (R0/Rins)qβy0/βymax,

ǫx0 = 0

Eqs. 5.4 may be understood in the following way. The chromaticity
correcting sextupoles in RHIC do not greatly distort the particle motion.

CHAPTER 5. RHIC LATTICE RESULTS

25

0 + y2

The stability surface in 2 dimensional phase space is a mildly distorted
ellipse, as will be seen below. The main eﬀect of the chromaticity correcting
sextupoles is due to the coupling of the x and y motions, so that x2 + y2
will grow from x2
0 by a factor which is found to be close to 1.414. Thus
in Eqs. 5.4, the ǫy0 = 0 and the ǫx0 = 0 results are unchanged from those
found when the chromaticity correcting sextupoles are absent, while in the
ǫx0 = ǫy0 case, the x, y coupling changes the result for xsl0 by the factor
0.707. Although Eqs. 5.4 were found using tracking results for RHIC, they
may be used for other proton storage rings when the chromaticity correcting
sextupoles play about the same role in distorting the particle motion. Note
that the factor of 0.707 in Eqs. 5.4 is not based on analytical considerations,
but was found though tracking studies with RHIC.

Fig. 5.2 shows the stability boundary in the high multipole limit for
motion in 2 dimensional phase space, ǫy0 = 0. Tracking runs of 500 turns
were used. The stability boundary is almost elliptical, showing that the
chromaticity correcting sextupoles do not distort the motion very much.

px0
              px0 vs x0

hml

0.0006

0.0004

0.0002

-0.0002

-0.0004

-0.03 -0.02 -0.01

0.01 0.02 0.03

x0

Figure 5.2: A plot showing the stability boundary for 500 turns in the high
multipole limit for motion in 2 dimensional phase space for a RHIC lattice.
In the ﬁgure, px0,xo represent px0, x0.

Fig. 5.3 shows the stability boundary in the high multipole limit for
motion in 4 dimensional phase space, in ǫy0 vs ǫx0 space. Tracking runs of
500 turns were used with px0 = py0 = 0 and with a single multipole with
k = 20 present in each element. This surface has some thickness or smear
which can be found by doing tracking runs with px0 and py0 not 0. This
curve is almost a straight line, and using Eqs. 5.3, it is described very well
by Eq. 3.12 which in this case can be written as

ǫx0/[R2

ins/βxmx] + ǫy0/[R2

ins/βymx] = 1

(5.5)

CHAPTER 5. RHIC LATTICE RESULTS

26

epy0

epy0 vs epx0

hml

20

15

10

5

5

10

15

20

epx0

Figure 5.3: A plot showing the stability boundary in the high multipole
limit for motion in 4 dimensional phase space for a RHIC lattice in ǫy0 vs
ǫx0 space. Tracking runs of 500 turns were used with px0 = py0 = 0 and
with a single multipole with k = 20 present in each element. In the ﬁgure,
epy0,epx0 represent ǫx0, ǫx0 which are in mm mrad.

Motion in 2 dimensional phase space

Tracking studies were done with a RHIC lattice to ﬁnd the stability
boundary for motion in 2 dimensional phase space, y0 = py0 = 0. The
results are shown in Fig. 5.4. Two curves are shown. The outer curve is
the stability boundary in the high multipole limit as was shown in Fig. 5.2.
The inner curve is the path in x, px for the last x0 that was stable for 500
turns as one increased x0 with px0 = 0 and all the multipoles from k = 2
to k = 20 are present. According to the suggestion being made here about
the signiﬁcance of the high multipole limit stability boundary, one would
say that the lower multipoles have reduced the stable phase space by about
36%. This loss in phase space can be recovered by correcting the lower
multipoles, k less than about 10. Again, it is suggested here that the high
multipole limit stability boundary indicates the stable phase space when the
lower multipoles are corrected and it indicates the loss in phase space due
to the lower multipoles.

Fig. 5.5 is similar to Fig. 5.4 except that the multipoles from k = 2
to k = 10 have been omitted. One sees that as the lower multipoles are
corrected, the stability boundary approaches that of the high multipole limit.
The loss in phase space has now been reduced to about 10%. Particle
motions that came even closer to the hml and appeared to be stable for
500 turns were seen and were rejected because of a rather large smear and
scatter.

CHAPTER 5. RHIC LATTICE RESULTS

27

px0
              px0 vs x0

hml

-0.03 -0.02 -0.01

0.01 0.02 0.03

x0

Figure 5.4: A plot showing the stability boundary for 500 turns for 2 di-
mensional motion in RHIC with all the multipoles from k = 2 to k = 20
present. The stability boundary in the high multipole limit is also shown.
In the ﬁgure, px0,x0 represent px0, x0.

px0
              px0 vs x0

hml

-0.03 -0.02 -0.01

0.01 0.02 0.03

x0

0.0006

0.0004

0.0002

-0.0002

-0.0004

0.0006

0.0004

0.0002

-0.0002

-0.0004

Figure 5.5: A plot showing the stability boundary for 500 turns for 2 dimen-
sional motion in RHIC with the multipoles from k = 11 to k = 20 present.
The multipoles for k = 2 to k = 10 have been corrected. The stability
boundary in the high multipole limit is also shown. In the ﬁgure, px0,x0
represent px0, x0.

CHAPTER 5. RHIC LATTICE RESULTS

28

Motion in 4 dimensional phase space

Fig. 5.6 shows the results of tracking studies done with a RHIC lattice
to ﬁnd the stability boundary for motion in 4 dimensional phase space. The
stability boundary is shown by plotting ǫy0 versus ǫx0 for the case where
px0 = py0 = 0. Two curves are shown. The outer boundary is the stability
boundary in the high multipole limit. The inner boundary is the stability
boundary when all the multipoles from k = 2 to k = 20 are present. The hml
boundary was found by having only the k = 20 multipole present. Fig. 5.6
shows a loss in 4 dimensional phase space of about 40% due to the presence
of the lower multipoles.

epy0

epy0 vs epx0

hml

20

15

10

5

5

10

15

20

epx0

Figure 5.6: A plot showing the stability boundary for 500 turns for 4 di-
mensional motion for a RHIC lattice with all the multipoles from k = 2 to
k = 20 present. The stability boundary in the high multipole limit is also
shown. In the ﬁgure, epy0,epx0 represent ǫy0, ǫx0 are in mm-mrad.

Fig. 5.7 shows the result when the multipoles from k = 2 to k = 10 are
corrected. One sees that as one corrects the lower multipoles, the stability
boundary approaches the high multipole limit stability boundary, and the
loss in 4 dimensional phase space is reduced to about 10%.

CHAPTER 5. RHIC LATTICE RESULTS

29

epy0

epy0 vs epx0

hml

20

15

10

5

5

10

15

20

epx0

Figure 5.7: A plot showing the stability boundary for 500 turns for 4 di-
mensional motion for a RHIC lattice with the multipoles from k = 11 to
k = 20 present. The multipoles for k = 2 to k = 10 have been corrected.
In the
The stability boundary in the high multipole limit is also shown.
ﬁgure epy0,epx0 represent ǫy0, ǫx0 and are in mm-mrad.

Chapter 6

Deﬁnition of stability

In order to establish the properties of the high multipole limit, it is conve-
nient to have a deﬁnition of stable motion which allows the stability bound-
ary to be determined precisely. In considering the motion of a particle in an
accelerator, one might consider the particle motion for a certain number of
periods to be stable if the particle motion stays within certain bounds, like
those given by the vacuum tank, to be acceptable for the operation of the
accelerator. Such a deﬁnition of stable motion, which allows a particular
amount of acceptable growth in the particle motion, is not convenient for
establishing the properties of the high multipole limit. A deﬁnition of sta-
ble motion is given below which will precisely determine whether a particle
motion for a given number of periods is stable. This deﬁnition may seem
artiﬁcial. However, a good deal of numerical tracking shows that the stabil-
ity limits found using this deﬁnition are usually close to the stability limits
that would be acceptable for an accelerator.

Consider the motion of a particle in a coordinate system which is based
on a reference orbit where the independent coordinate is taken to be s,
the distance along the reference orbit. The position of the particle is then
described by x, y, and s, where x, y are the coordinates along two directions
perpendicular to the reference orbit. The components of the momentum are
If the energy of the particle is assumed to
then given by px, py and ps.
remain constant during the tracking, then ps can be computed from ps =
(p2 − p2
y)0.5, p being the total momentum of the particle. The motion
x
of the particle over a given number of periods will be said to be unstable
if during the tracking of the particle over the given number of periods,
y becomes larger than p2. ps becoming
ps becomes imaginary or p2
imaginary means that the formulation of the equations of motion based on

x + p2

− p2

30

CHAPTER 6. DEFINITION OF STABILITY

31

the given reference orbit has broken down because ps has changed sign, and
the particle has reversed its direction along the reference orbit so that s is
decreasing with time.

The above deﬁnition of unstable motion over a given number of periods
may seem artiﬁcial. However it has the advantage that the stability of a
particular particle motion over a given number of periods can be precisely
determined. Much experience with tracking also indicates that it is a use-
ful deﬁnition and usually gives results that are close to the stability limits
that would be acceptable for an accelerator. This deﬁnition of stability is
convenient for establishing the above results for the high multipole limit.
This precise deﬁnition of stability allows the stability limit to be calculated
with great accuracy, and the tracking searches for the stability boundary
can be automated. In order to use this deﬁnition of stability, one has to use
the exact equations of motion. If one uses the approximations often used
for large accelerators, where the radical (p2 − p2
y)0.5 is expanded out
x
assuming that px/p and py/p are much smaller than one, one will obtain
invalid results as the expansion is not valid when p2 − p2
y is near zero
x
and the radical is about to become imaginary.

− p2

− p2

The deﬁnition of stability being proposed here has the following advan-

tages:

1. It avoids having to decide whether a particular particle motion is un-
stable when some growth occurs and it is not obvious whether the
growth is acceptable or not.

2. With this deﬁnition of stability tracking searches for points on the
stability boundary can be automated as it provides a simple test for
stability.

I would propose that one develops the results using this deﬁnition of stability
and leave as a separate question whether the results are meaningful for an
actual lattice.

Chapter 7

Transfer functions for lattice
elements

In doing the tracking studies, one needs to know the transfer functions for
each element of the lattice. The transfer functions allow one to compute the
ﬁnal coordinates of the particle from the initial coordinates for each element.
As was indicated in section 6, the transfer functions have to satisfy the exact
equations of motion in order to use the deﬁnition of stability given in section
6. This can be accomplished by using the procedure [4] of replacing a magnet
with point magnets at the ends of the magnet separated by a drift space.
By breaking the magnet up into pieces, one can approach the exact solution
of the equations of motion by making the pieces smaller. One change in this
procedure will be used here, which is that the reference orbit used will be
made up of a series of smoothly joining straight lines and circular arcs [5].
The transfer functions are then given in Ref. [5]. The circular arcs of the
reference orbit are located at the dipoles in the lattice, and each arc has the
curvature ρ which depends on the strength of the dipole. 1/ρ = 0 at the
quadrupoles and drift spaces.

It is assumed that each magnet is broken up into a number of pieces.
A magnet piece going from s = s1 to s = s2 and of length h = s2 − s1 is
replaced by point magnets at the ends separated by a drift space of length
h. In the following, qx = px/p, qy = py/p, qs = (1 − q2
x

y)0.5.

− q2

A. Transfer functions for point magnets

The transfer functions for a point magnet located at s = s1 is

x2 = x1, y2 = y1,

32

CHAPTER 7. TRANSFER FUNCTIONS FOR LATTICE ELEMENTS33

1
qx2 = qx1 +
Bρ
qy2 = qy1 − 1
Bρ

h
2
h
2

sin θ
θ
sin θ
θ

(1 + x1/ρ)

Bx(x1, y1),

(1 + x1/ρ)

By(x1, y1),

(7.1)

h is the length of the magnet piece, θ = h/ρ. The ﬁeld components By and
Bx are assumed to depend only on x, y and do not change along the magnet,
and that Bs = 0.

B. Transfer functions for drift spaces

For a region along s in the lattice where 1/ρ = 0 for the reference orbit

qx2 = qx1, x2 = x1 + qx1L12,
qy2 = qy1, y2 = y1 + qy1L12,
L12 = (s2 − s1)/qs1
− q2
qs = (1 − q2
x

y)/1/2,

L12 is the path length between s1 and s2.
For a region where 1/ρ is not zero,

(7.2)

(7.3)

qx2 = qx1 cos θ + qs1 sin θ,
qs2 = −qx1 sin θ + qs1 cos θ,

θ = (s2 − s1)/ρ,
x2 = x1 + (1 + x1/ρ)2ρ sin(θ/2)

× qx1 cos θ/2 + qs1 sin θ/2
−qx1 sin θ + qs1 cos θ

,

L12 = (1 + x1/ρ)ρ sin(θ)/qs2,
qy2 = qy1, y2 = y1 + qy1L12

C. Transfer functions for the simple one cell lattice

This lattice has only point quadrupoles and drift spaces. For the transfer
functions of the point quadrupoles one can use Eqs. 7.1, replacing (h/2)By
and (h/2)Bx by the integrated ﬁelds of the point magnet. For the drift
spaces one can use Eqs. 7.2. The initial parameters that were used for the
simple one cell lattice are the following:

quadrupole integrated strength = 436.647 KG
drift space length = 20m
multipole ﬁeld, bk = b / Rk, b = 0.024, R = 0.04m
Bρ = 8400 KG. m
B0 = 35 KG

Chapter 8

Longterm eﬀects and the
high multipole limit

The stability boundary in the high multipole limit for 2 dimensional phase
space does not appear to depend on nprd, the number of periods the particle
is tracked. However many tracking studies have indicated that the stability
boundary shrinks slowly the longer the particle is tracked. If one accepts
the statement that the stability boundary in the high multipole limit is
the boundary that is approached when the lower multipoles are corrected,
then one can remove the apparent contradiction by the suggestion that the
shrinking of the stability boundary, when nprd is increased, is due to the
presence of the lower multipoles, and this eﬀect can be reduced by correcting
the lower multipoles.

The following tracking study done with the simple one cell lattice sup-
ports the previous statements. If one considers xsl0, the largest x0 that is
stable for a given number of periods when px0 = 0, then one ﬁnds that xsl0
decreases as nprd is increased. Using nprd = 102 and nprd = 104, one ﬁnds
the dx0/x0, the fractional decrease in xsl0 for these two values of nprd is
dx0/x0 = 0.033 when all the multipoles are present. If one corrects some of
the lower multipoles by omitting the multipoles for k=2 to k=9, then one
ﬁnds that dx0/x0 is decreased by a factor of 6 to dx0/x0 = 0.005.

Avoiding resonances of order 10 or higher

It is sometimes suggested that in choosing the operating point for su-
perconducting proton storage rings, one should avoid resonances of order
10 or higher. A basis for this rule is provided by the high multipole limit.
The range of the lower multipoles that reduce the dynamic aperture below

34

CHAPTER 8. LONGTERM EFFECTS AND THE HIGH MULTIPOLE LIMIT35

that given by the high multipole limit is given by the parameter khml de-
ﬁned in section 4. For RHIC, khml is about khml = 10. Since the important
multipoles in aﬀecting the dynamic aperture are the 10 lowest multipoles,
it would seem desirable to avoid resonances up to 10 or higher which are
the resonances driven by the 10 lowest multipoles in lowest order. If one
would increase the strength of the non-linear multipoles by a factor of 10,
thus raising khml to about khml = 20, the above argument would suggest
that one should avoid resonances up to order 20 or higher.

Bibliography

[1] G. Parzen, Higher order magnet ﬁeld multipoles, aperture eﬀects and

tracking studies, BNL report RHIC-AP-25 (1986).

[2] G. Parzen, Dynamic aperture for lattices with some beta = 2 insertions,

BNL report AD/RHIC-AP-75 (1989).

[3] Conceptual design of RHIC, BNL report BNL-52195, (1989).

[4] L. Schachinger and R. Talman. Teapot, A thin element tracking pro-

gram, SSC-52 (1985).

[5] G. Parzen, Symplectic tracking using point magnets and a reference
orbit of circular and straight lines. Phys. Rev. E ,Vol. 51, No.3, p. 51
(1995).

36

