9
9
9
1
 
l
u
J
 
1
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
3
0
7
0
9
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Radiative Polarization, Computer Algorithms and
Spin Matching in Electron Storage Rings a

D.P. Barber and G. Ripken
Deutsches Elektronen–Synchrotron, DESY,
22603 Hamburg, Germany.
( E-mail: mpybar@mail.desy.de, ripken@mail.desy.de)

We present a set of notes, meant for quick reference, on radiative po-
larization, computer algorithms and spin matching in electron storage
rings.

2.7.7. Radiative Polarization in Electron Storage Rings

The Sokolov-Ternov eﬀect [1] Relativistic electrons in a storage ring emit syn-
chrotron radiation (Sec.3.1 in [27]). A very small fraction of the radiated photons
and
cause spin ﬂip. For electron spins aligned along a uniform magnetic ﬁeld, the
ﬂip rates diﬀer and this leads to a build-up of spin polarization antiparallel to
↓↑
the ﬁeld. Positrons become polarized parallel to the ﬁeld. The transition rates for
electrons are

↑↓

W↑↓ =

W↓↑ =

5√3
16

5√3
16

e2γ5~
ec2
m2
ρ
|
|
e2γ5~
ec2
m2
ρ
|

|

3

3

1 +

1

−

(cid:18)

(cid:18)

8
5√3

8
5√3

(cid:19)

(cid:19)

Pst =

W↓↑
W↑↓ −
W↑↓ + W↓↑

=

8
5√3

= 0.9238

For positrons, interchange plus and minus signs here and elsewhere b.

The equilibrium polarization in a uniform magnetic ﬁeld is independent of γ,

For a beam with zero initial polarization, the time dependence for build-up to equi-
librium is

P (t) = Pst [1

exp (

t/τ0)]

−

−

where the build-up rate is

aContributions to the Handbook of Accelerator Physics and Engineering, Eds. A.W. Chao and M.
Tigner, World Scientiﬁc, 1999. Also as DESY report 99-095.
bρ is the radius of curvature of the orbit and the other symbols have their usual meanings.

τ −1
0 =

5√3
8

e2γ5~
ec2
m2
ρ
|

|

3

1

(1)

(2)

(3)

(4)

τ0 depends strongly on γ and ρ but is typically minutes or hours. When ρ depends
on the distance along the design orbit s, i.e. ρ = ρ(s), just average Eq.(4) over the
circumference C. Then for a ﬂat ring in which all bending magnets have the same ρ

τ −1
0

[s−1]

2π
99

E[GeV]5
C[m]ρ[m]2

≈

(5)

(6)

(7)

(8)

(9)

(10)

The Baier-Katkov ﬂip rate For electron spins initially aligned along an arbitrary
unit vector ˆξ the generalization of Eq.(1) is [2]

W =

1
2τ0 (cid:20)

1

2
9

−

( ˆξ

ˆs)2 +

·

8
5√3

ˆξ

·

ˆb
(cid:21)

where ˆs = direction of motion and ˆb = (ˆs
×
the electric ﬁeld vanishes and the motion is perpendicular to the magnetic ﬁeld.
The corresponding instantaneous rate of build-up of polarization along ˆξ is

. ˆb is the magnetic ﬁeld direction if

˙ˆs)/

˙ˆs
|

|

τ −1
bk = τ −1

0

1

2
9

( ˆξ

ˆs)2

·

−

(cid:21)

(cid:20)

The T-BMT equation Neglecting radiative spin ﬂip, the motion of the centre-of-
mass spin expectation value ~ξ of a relativistic charged particle traveling in electric and
~ξ (Sec.2.7.1
magnetic ﬁelds is governed by the Thomas-BMT equation d~ξ/dt = ~Ω
in [27]).

×

We write

~Ω = ~Ωref + ~ωimp + ~ωsb

where ~Ωref is due to design ﬁelds on the design orbit and ~Ωref + ~ωimp(
~Ωco) is due to
ﬁelds on the closed orbit whereby ~ωimp is due to ﬁeld imperfections and corrections.
~ωsb is due to synchrotron and/or betatron motion with respect to the closed orbit.

≡

On the closed orbit the T-BMT equation

can be solved in the form

d
dt

~ξ = ~Ωco

~ξ

×

~ξ(s) = Rco

3×3(s, s0)~ξ(s0)

where Rco
3×3 is a rotation matrix. The real unit eigenvector (rot. axis) for the one turn
matrix Rco
3×3(s + C, s), denoted by ˆn0(s), is the periodic spin solution on the closed
ˆy. The one turn
orbit. For a perfectly aligned ﬂat ring with no solenoids, ˆn0(s) =
matrix has a complex conjugate pair of eigenvalues e±i2πνspin. Given ˆn0, we introduce

±

2

a pair of unit vectors ( ˆm0, ˆl0) such that ˆn0 ×
obey

ˆm0 = ˆl0, ˆl0 ×

ˆn0 = ˆm0, fulﬁll Eq.(9), and

ˆm0(s0 + C) + iˆl0(s0 + C) = ei2πνspin

ˆm0(s0) + iˆl0(s0)
h

i

The ( ˆm0, ˆl0) are usually not periodic in s. But by applying a further rotation by an
angle ψspin(s) around ˆn0 we can construct the vectors ( ˆm, ˆl),

ˆm(s) + i ˆl(s) = e−iψspin(s)

ˆm0(s) + iˆl0(s)
h

i

By choosing ψspin(s + C)
with period C. The vectors ( ˆm, ˆl) are needed in Sec 2.7.8.

−

ψspin(s) = 2πνspin, the set (ˆn0, ˆm, ˆl) is then periodic in s

The closed orbit spin tune νspin is the number of spin precessions per turn around
ˆn0. For a perfectly aligned ﬂat ring without solenoids νspin = aγ, where a = (g
2)/2
(see Sec.2.7.1 in [27]). In this section and in Sec. 2.7.8 we use the symbol “a” instead
of the symbol “G” used in the rest of the Handbook. Only the fractional part of the
spin tune can be extracted from the numerical values of the eigenvalues e±i2πνspin. For
the deﬁnition of spin tune away from the closed orbit see [3].

−

The Baier-Katkov-Strakhovenko (BKS) equation Neglecting the eﬀect of
stochastic (synchrotron radiation) photon emission on the orbit and imagining that all
particles remain on the closed orbit, the equation of motion for electron polarization
is [4, 5]

d ~P
dt

= ~Ωco

~P

×

−

1
τ0(s)

~P

2
9

−

ˆs( ~P

ˆs) +

·

8
5√3

ˆb(s)

(cid:20)
In the case of horizontal motion in a vertical magnetic ﬁeld, we have ~Ω = (aγc/ρ)ˆy,
and ˆb(s) = ˆy.

(cid:21)

By integrating the BKS equation, one ﬁnds the generalized Sokolov-Ternov for-
mula for the asymptotic electron polarization in arbitrary magnetic ﬁelds along the
closed orbit,

~Pbks =

8
5 √3

−

ˆn0

ds ˆn0(s)·ˆb(s)
|ρ(s)|3
[1− 2
9 (ˆn0(s)·ˆs)2]
|ρ(s)|3

H
ds

See [6] for a compilation of time scales. Usually, in rings containing dipole spin
rotators (Secs.2.7.3, 2.7.4 in [27]) the polarization

cannot reach 0.9238 [7].

H

~Pbks|

|

The BKS polarization build-up rate is

τ −1
bks =

5√3
8

e2γ5~
ec2
m2

1
C

I
This is in accord with Eq.(7) by replacing ˆξ

1

−

ds

(cid:2)

2

9 (ˆn0 ·
ρ(s)
|
|

3

ˆs)2

(cid:3)

ˆn0 and averaging.

→

3

(11)

(12)

(13)

(14)

(15)

Radiative depolarization The stochastic element of photon emission together
with damping determines the equilibrium phase space density distribution. The same
photon emission also imparts a stochastic element to ~ωsb and then, via the T-BMT
equation, spin diﬀusion (and thus depolarization) can occur [8]. The polarization is
the result of a balance between the Sokolov-Ternov eﬀect and this radiative depo-
larization. In the approximation that the orbital motion is linear, the value of the
polarization is essentially the same at each point in phase space and azimuth and the
polarization is aligned along the Derbenev-Kondratenko vector ˆn [9].

The unit vector ﬁeld ˆn depends on s and ~u

(x, px, y, py, z, δ). ˆn(~u; s) satisﬁes
the T-BMT equation at (~u; s) and is periodic: ˆn(~u; s) = ˆn(~u; s + C). On the closed
orbit ˆn(~u; s) reduces to ˆn0(s).

≡

The Derbenev–Kondratenko–Mane formula Taking into account radiative de-
polarization due to photon-induced longitudinal recoils, the equilibrium electron po-
larization along the ˆn ﬁeld is [9, 10, 3]

Pdk =

8
5√3

−

ds

1
|ρ(s)|3

ˆb

ds

D
H
1
|ρ(s)|3 (1

2
9(ˆn

−

H

D

(ˆn

∂ ˆn
∂δ )
−
ˆs)2 + 11
18

s

E

∂ ˆn
∂δ

·

·

2

)

s

E

(cid:0)

(cid:1)

where < >s denotes an average over phase space at azimuth s. This formula diﬀers
from Eq.(14) by the inclusion of the terms with ∂ ˆn
∂δ and use of ˆn instead of ˆn0. The
ensemble average of the polarization is

~Pens,dk(s) = Pdk h

ˆn
is

h

and
of the ensemble average, Pens,dk(s), is essentially independent of s.

is is very nearly aligned along ˆn0(s) (see the angle estimate below). The value
ˆn
The eﬀect of transverse recoil can also be included but contributes derivative terms
∂δ and can be neglected
∂δ were to vanish, a Pdk of 99.2 % could be reached

∂δ which are typically a factor γ smaller than ∂ ˆn

∂δ is very small [11, 12]. If ∂ ˆn

analogous to ∂ ˆn
unless ∂ ˆn
[11, 12, 3].

In the presence of radiative depolarization Eq.(15) becomes

τ −1
dk =

5√3
8

e2γ5~
ec2
m2

1
C

ds

*

I

1

−

2
9(ˆn

ˆs)2 + 11
18
3
ρ(s)

|

·
|

2

∂ ˆn
∂δ

(cid:0)

(cid:1)

+s

This can be written in the form:

1
τdk

=

1
τst

+

1
τdep

,

where τ −1

st can be (very well) approximated by τ −1

bks in (15) and

τ −1
dep =

5√3
8

e2γ5~
ec2
m2

1
C

ds

*

2

11
18

∂ ˆn
∂δ
ρ(s)
(cid:0)

|

3
(cid:1)

|

+s

I

4

(16)

(17)

(18)

(19)

(20)

The time dependence for build-up from an initial polarization P0 to equilibrium is

P (t) = Pens,dk

1

e−t/τdk

+ P0e−t/τdk

(21)

−
This formula can be used to calibrate polarimeters (see Eqs.(21) and (22), Sec.2.7.8)
[13]. However, the calibration will be imprecise if ∂ ˆn
∂δ in the numerator of Eq.(16) is
not well enough known. For examples of build-up curves see [7].

(cid:3)

(cid:2)

Resonances Away from the spin–orbit resonances (see also Eq.(11), Sec.2.7.8)

νspin = k + kxνx + kyνy + kzνz

(22)

≈

ˆn(~u; s)
ˆn0(s). But near resonances ˆn(~u; s) deviates from ˆn0(s) by typically tens of
milliradians at a few tens of GeV and the deviation increases with distance in phase
space from the closed orbit. The spin orbit coupling function ∂ ˆn
∂δ , which quantiﬁes the
depolarization, can then be large and the equilibrium polarization can then be small.
ˆn
1: the ensemble average polarization
Note that even very close to resonances,
is| ≈
is mainly inﬂuenced by the value of Pdk in Eq.(16).

|h

To get high polarization, one must have (∂ˆn/∂δ)2

machine optimization required to make ∂ ˆn

1 in dipole magnets. The
∂δ small is called spin matching (Sec.2.7.8).

≪

If τ −1

Asymmetric wigglers
bks is very low because the energy is low and/or the
average curvature is small the polarization rate can be enhanced (see Eq.(15)) by
installing an “asymmetric wiggler”, i.e. a string of dipoles in which short dipoles with
high ﬁelds are interleaved with long dipoles with low ﬁelds of opposite polarity while
ensuring that the ﬁeld integral of the string vanishes. For more details, and discussion
of advantages and disadvantages see [6]. A particular potential disadvantage is that
the enhanced radiation loss can require that extra rf power be installed and that the
energy spread increases so that the depolarization rate increases owing to stronger
synchrotron sideband resonances (Sec.2.7.8).

Kinetic polarization The (numerator) term linear in ∂ ˆn
∂δ in Eq.(16) is due to a
correlation between the spin orientation and the radiation power [6]. In rings where
ˆn0 is horizontal due, say, to the presence of a solenoid Siberian Snake (Secs.2.7.3,
2.7.4 in [27]) [14], ∂ ˆn
∂δ has a vertical component in the dipole ﬁelds. This can lead to a
build-up of polarization (“kinetic polarization”) even though the pure Sokolov–Ternov
eﬀect vanishes. The rate is τ −1
dk .

Phase space and polarization evolution equations
density ψ obeys an equation of the Fokker–Planck type (Sec.2.5.4 in [27])

If the orbital phase space

∂ψ
∂s

=

LFP ψ

5

(23)

where
by the “Bloch” equation

LFP is the orbital Fokker–Planck operator, then the spin diﬀusion is described

∂ ~
P
∂s

=

~
P

+ ~¯Ω

~
P

×

LFP

(24)

where ~¯Ω = ~Ω/(ds/dt) and ~
(density in phase
P
space per particle of spin angular momentum) [15, 16]. To include the Sokolov–Ternov
eﬀect see [17].

is the “polarization density”

2/~

≡

×

Beam energy calibration A polarized electron beam can be depolarized by apply-
ing a weak oscillating magnetic ﬁeld perpendicular to ˆn0 with a frequency frf related
to the fractional part of the spin tune ˜νspin by

frf = fc˜νspin

or frf = fc(1

˜νspin)

(25)

−

where fc is the circulation frequency of the beam [18]. Thus the required frf gives an
accurate measurement of ˜νspin and this gives high relative precision knowledge of νspin.
By relating νspin to the average energy of each beam, high precision measurements
of the centre–of–mass energy of colliding e+–e− beams and of the masses of vector
mesons such as the Υ’s and the Z can be obtained [19, 20, 21, 22, 23]. Other beam
parameters can also be measured [24]. The polarization need not be large for these
measurements so that by Eq.(21) the depolarization can be repeated at intervals of
about τdk.

Concluding remarks For an overview of measurements see [25, 7, 26]. For an
overview of the theoretical background see [3].

References

1. A.A. Sokolov, I.M. Ternov, Sov. Phys. Dokl. 8 N012 (1964) 1203
2. V.N. Baier, V.M. Katkov, Sov. Phys. JETP. 25 (1967) 944
3. Articles by D.P. Barber (some with co-authors), in proceedings of ICFA work-
shop “Quantum Aspects of Beam Physics”, Monterey, U.S.A., 1998, World
Scientiﬁc (1999). Also as DESY Report 98-96 and at Los Alamos archive:
physics/9901038 – physics/9901044

4. V.N. Baier, V.M. Katkov, V.M. Strakhovenko, Sov. Phys. JETP. 31 (1970) 908
5. E. Storck, Z. Naturforsch. 23a (1968) 1914
6. B. Montague, Physics Reports 113 (1984)
7. D.P. Barber et al., Phys. Lett. 343B (1995) 436
8. V.N. Baier, Yu. Orlov, Sov. Phys. Dokl. 10 (1966) 1145
9. Ya.S. Derbenev, A.M. Kondratenko, Sov. Phys. JETP. 37 (1973) 968
10. S.R. Mane, Phys.Rev. A36 (1987) 105–130

6

11. D.P. Barber, S.R. Mane, Phys.Rev. A37 (1988) 456
12. L.N. Hand, A. Skuja, Phys.Rev.Lett. 59 (1987) 1910
13. D.P. Barber et al., Nucl.Inst.Meth. A338 (1994) 166
14. C.W. de Jager, V. Ptitsin, Yu.M. Shatunov, Proc. 12th Int. Symp. High

Energy Spin Physics, World Scientiﬁc (1997)

15. K. Heinemann, DESY Report 97-166 (1997) and at Los Alamos archive:

physics/9709025

16. K. Heinemann, D.P. Barber, talk at Frascati, May 1998. To be published in
Nuovo Cimento A. Also as DESY Report 98-0145 (1998) and at Los Alamos
archive: physics/9901045.

17. Ya.S. Derbenev, A.M. Kondratenko, Sov. Phys. Dokl. 19 (1975) 438
18. Kh.A. Simonian, Yu.F. Orlov, Sov. Phys. JETP. 18 (1964) 123
19. Yu.M. Shatunov, A.N. Skrinsky, Particle World 1 (1989) 35
20. R. Assmann et al., Z. f. Physik C66 (1995) 567
21. M. Placidi et al., European Part.Acc.Conf. 1998
22. D.P. Barber et al., Phys. Lett. 135B (1984) 498
23. W.W. MacKay et al., PRD 29 (1984) 2483
24. D.P. Barber, in “Electroweak Eﬀects at High Energies”, Ed. H.B. Newman,

Plenum Press (1985) 399

25. D.P. Barber, Proc. 12th Int. Symp. High Energy Spin Physics, loc.cit.
26. Yu.M. Shatunov, PA 32 (1990) 139
27. Handbook of Accelerator Physics and Engineering, Eds. A.W. Chao and M.

Tigner, World Scientiﬁc (1999)

7

2.7.8. Computer Algorithms and Spin Matching

There are two classes of computer algorithm for estimating the equilibrium polariza-
tion in real rings:

(i) Methods based on evaluating ∂ ˆn

∂δ in the Derbenev–Kondratenko–Mane (DKM)

formula (Eq.(16) of Sec.2.7.7) given the ring layout and magnet strengths; and

(ii) The SITROS [1] algorithm which estimates τdep (Sec.2.7.7) using Monte–Carlo

tracking.

of the spin and orbital motion:

The class (i) algorithms are further divided according to the degree of linearization

(ia) The SLIM family (SLIM [2, 3], SLICK [4], SITF [1]) and SOM [5] and ASPIR-
RIN [6]. The latter two utilize the “betatron–dispersion” formalism outlined below
and all are based on a linearization of the orbital and spin motion.

(ib) SMILE [7]: Linearized orbital motion but nonlinear spin motion;
(ic) SODOM [8]: Linearized orbital motion but nonlinear spin motion;
(id) SpinLie: Nonlinear orbital motion and nonlinear spin motion (Sec.2.7.9 in

[45]); and

(if) SPRINT [9]: Linearized orbital motion but nonlinear spin motion.

The linear approximation – SLIM We now present expressions for ∂ ˆn
∂δ in an
approximation in which the orbit and spin motion are linearized and in which ~ωsb
(Sec.2.7.7) is linearized as in Eq.(2) below (the SLIM formalism). In linear approxi-
mation we write (see Sec.2.7.7)

ˆn(~u; s) = ˆn0(s) + α(~u; s) ˆm(s) + β(~u; s)ˆl(s)

α2 + β2

1 and we write the components ωsb

z , ωsb

x , ωsb
y

in the form

valid for
[10, 11]

p

≪

where ~u
particular px = x′ and py = y′ (except in solenoids).

(x, px, y, py, z, δ) describes motion with respect to the closed orbit.

≡

In

The detailed forms of the matrix F3×6 for bending magnets, quadrupoles, skew
quadrupoles, solenoids and rf cavities can be found in [11, 12]. The orbit motion
in sextupoles is linearized. For example for a quadrupole, deﬁning ˜g =
(1 + aγ) g
where g = e
p0

∂By
∂x one has

−

ωsb
z
ωsb
x
ωsb
y









= F3×6

x
px
y
py
z
δ





















F(s) =

0 0 0 0 0 0
0 0 ˜g 0 0 0
˜g 0 0 0 0 0





8





(1)

(2)

(3)

×

(4)

(5)

(6)

In linear approximation the combined orbit and spin motion is described by 8

8 transport matrices of the form

ˆM =

(cid:18)

M6×6
06×2
G2×6 D2×2

(cid:19)

acting on the vector (~u, α, β), where M6×6 is a symplectic matrix describing orbital
motion and G2×6 describes the coupling of the spin variables (α, β) to the orbit and
depends on ˆm(s) and ˆl(s) (see e.g. Eq.(14)). D2×2 is a rotation matrix associated
with the spin basis rotation of Eq.(12) in Sec.2.7.7 [10, 11].
The eigenvectors for one turn deﬁned by ˆM(s0 + C, s0)

~qµ are written

~qµ = ˆλµ ·

·

in the form

~qk(s0) =

,

~q−k(s0) = [~qk(s0)]∗

~vk(s0)
~wk(s0)

(cid:18)

(cid:19)

for k = I, II, III ;

~qk(s0) =

, ~q−k(s0) = [~qk(s0)]∗

~06(s0)
~wk(s0)

(cid:18)

(cid:19)

for k = IV

i2πνk and with ν−k =

for arbitrary s0. The ~vk are the eigenvectors for orbital motion with eigenvalues
νk (k = I, II, III). These eigenvectors obey
λk = e−
−
the orthogonality relations, and have the normalization of [2]. The corresponding
i2πνIV with
eigenvalues of ˆM(s0 + C, s0) are ˆλk = λk (k = I, II, III) and ˆλIV = e−
νIV = νspin and with ν−IV =

νIV .

The spin parts of the eigenvectors ~wk(s0) (k = I, II, III) and ~wIV (s0) can be

−

written as

~wk(s0) =

G(s0 + C, s0)~vk(s0)

−

D(s0 + C, s0)
h

ˆλk

−

i

−1

for k = I, II, III ;

~wIV (s0) =

1
√2

1
i
−

(cid:18)

(cid:19)

e−i ψspin(s0)

for k = IV

and

~w−k(s0) = [ ~wk(s0)]∗ , (k = I, II, III, IV )

In this linear approximation ˆn(~u; s) can be obtained via [13, 14, 11]

ˆn(~u; s)

ˆn0(s)

−

=

Ak ~wk(s) + A−k ~w−k(s)

(7)

}

≡

(cid:18)

{

(cid:19)

α(~u; s)
β(~u; s)

9

where the amplitudes Ak are determined by the orbit via

~u (s) =

Ak~vk(s) + A−k~v−k(s)

(8)

}

{

Xk=I,II,III

Then with respect to the (ˆn0, ˆm, ˆl) frame,

∂ˆn
∂δ ≡

i

v∗
k5 ~wk −
{

vk5 ~w∗
k}

Xk=I,II,III
2 Im

=

−

v∗
k5 ~wk

Xk=I,II,III

Note that this is independent of the phase space vector ~u and that ∂ ˆn
∂δ is periodic in
azimuth in the machine coordinate system. In this approximation the depolarization
time is then (Eq.(20), Sec.2.7.7)

τ −1
dep,lin =

55√3
36

e2γ5~
ec2
m2

1
C

s0+C

s0

Z

2

d˜s

1
ρ(˜s)

|

Im

3

|

µ=1  
X

Xk=I−III

[v∗

k5(˜s)wkµ(˜s)]

This is the formula used in SLIM to calculate the depolarization rate. SLIM is
based on thin lens optics. SLIM–like programs for thick lens optics are SLICK and
SITF.

In this linearized theory the vectors ˆn(~u; s) and ∂ ˆn

∂δ display only ﬁrst order reso-

nance behaviour, namely the resonances

νspin = k + kIνI + kIIνII + kIIIνIII

|

+

with
+
|
theory is not valid beyond the limit
II

kII|
kI|
y and III

kIII|
z.

|

= 1. They arise from the denominator matrix in Eq.(6). The
x,

1. In a fully uncoupled optic I

α2 + β2

→

→
This formalism forms the natural language for the method of maximizing the
polarization called “spin matching”. Thus comments on the other programs will be
postponed until later.

p

≪

(9)

2

!

(10)

(11)

→

Spin matching in the SLIM formalism In practice the spin matching of real
rings takes place in stages as follows.

Stage 1: Strong synchrobeta spin matching of the perfectly aligned ring

From Sec.2.7.7 it is clear that to maximize the polarization we must minimize τ −1
dep.
Then by Eq.(10) we need to minimize v∗
k5 (k = I, II, III) or the components of ~wk
at azimuths where 1/
k5 determine the orbit excitation due to

3 is large. The v∗

ρ(s)

|

|

10

−

y
synchrotron radiation (Sec.2.1.4 in [45]) [15]. In particular, for rings without x
coupling, v∗
II5 usually vanishes in the arcs since the vertical dispersion ηII vanishes.
However, v∗
II5 does not vanish inside spin rotators (Secs.2.7.3, 2.7.4 in [45]) contain-
ing vertical bends. On the other hand v∗
I5 tends not to vanish in the arcs since the
= 0. Finally, v∗
horizontal dispersion ηI
III5 essentially never vanishes. Each case
must be evaluated individually but the minimal recipe is to try to minimize ~wk for
3 is suﬃciently large. This
(k = I, II, III) only at azimuths where
vk5(s)
|
in turn requires (Eq.(6)) that G(s + C, s)
~vk(s) for (k = I, II, III) be minimized.
·
This must be achieved by designing the ring layout with this in mind and then pro-
viding suﬃcient ﬂexibility in the optics by providing enough independently powered
quadrupoles. Subsequent calculations with SLIM will indicate whether the match
criteria for the adopted design suﬃce.

ρ(s)

2/

|

|

|

2/

Consider, for example, a speciﬁc mode, k. Label those bending magnets at which
(k). Then the suppression of depolar-
, µnk
vk5(s)
|
ization associated with the kth mode requires that ~wk(sµi) = 0 for all (i = 1 to nk).
In general (see Eq.(6)) this in turn requires [16]

3 is large by µ1

(k), µ2

ρ(s)

(k),

· · ·

|

|

|

G(sµ2, sµ1) ~vk(sµ1) = 0
G(sµ3, sµ2) ~vk(sµ2) = 0

...

G(sµ1 + C, sµn) ~vk(sµn) = 0

(12)

where we suppressed the superscript label “k”. To fulﬁll Eq.(12) we then require the
Gij(sµl+1, sµl) to vanish when the jth component of ~vk does not vanish. The matrix
G can be written in the form

G(s2, s1) =

d˜s D(s2, ˜s) G0(˜s) M(˜s, s1)

s2

s1

Z

where

·

F

(cid:18)

(13)

G0 =

ly
my (cid:19)

lx
mx −

ls
ms −
−
Thus Gij(sµl+1, sµl) depends on the orientation of the ( ˆm, ˆl) vectors so that in some
cases some elements of Gij(sµl+1, sµl) vanish automatically. But in general these con-
ditions can only be fulﬁlled by adjusting quadrupole strengths — while maintaining
other necessary features of the orbital optics. We call this strong synchrobeta spin
matching. A section of the ring satisfying a condition in Eq.(12) is “spin transpar-
ent” for mode k. The interpretation is immediate: the overall spin–orbit coupling for
the section vanishes for mode k. Clearly, the exact spin matching conditions are very
dependent on the layout of a machine and each case must be handled individually.
In thin lens approximation the G matrix for a quadrupole of length lq is

G =

(cid:18)

0

˜qly

˜qlx
0 0 0
−
−
+˜qmy 0 +˜qmx 0 0 0

(cid:19)

11

(14)

6
where ˜q = (1 + aγ) g lq. The thin and thick lens forms of G for other magnet types
are given in [2, 3, 17].

If the Gij(sµl+1, sµl) cannot be brought to zero while maintaining an acceptable
optic, then the G(sµl + C, sµl)
~vk(sµl) themselves should be minimized. This essen-
tially means that the eﬀects of elements of the G matrices of sections of the ring are
made to partially cancel one another. The spin matching of a ring with a solenoid
Siberian Snake (Secs.2.7.3, 2.7.4 in [45]) has provided an example of this [6]. By
Eq.(7) reduction of G(s + C, s)
~vk(s) for (k = I, II, III) also reduces the angle
between ˆn and ˆn0 at azimuth s.

·

·

Alternative Stage 1: Harmonic synchrobeta spin matching of the perfectly aligned ring

If the strong spin matching methods just described are impractical for some rea-
son, another approach aimed at minimizing the strengths of depolarizing resonances
can be adopted.

Rewrite Eq.(6) as

[ wk1(s0)

i wk2(s0) ] =

∓

e±iψspin(s0+C)

s0+C

−

[e±i2πνspin

e−i2πνk]

−

s0

Z

d˜sj(∓)
k

(˜s)e−i2π[νk±νspin]˜s/C

j(∓)
k

(˜s) = e±i[2πνspin˜s/C−ψspin(˜s)]
+∞

= j(∓)
k

(˜s + C) =

ims

lx±
ls±
(cid:0)
c(∓)
kp e+i2πp˜s/C

imx

imy

ly±

F~vk(˜s)e+i2πνk ˜s/C

(cid:1)

p=−∞
X

d˜sei2π[ νk±νspin−p ]˜s/Ce∓iψspin(˜s)

ims

ls±

imx

lx±

imy

ly±

F~vk(˜s)

[ wk1(s0)

i wk2(s0) ] = e±iψspin(s0) i

∓

(cid:0)

C
2π

(cid:1)

+∞

p=−∞
X

c(∓)
kp

e−i2π[ νk±νspin−p ]s0/C
νspin −

[ νk±

p ]

The condition that ~wk(sµi) = 0 for all (i = 1 to nk) is now be replaced by

[ wk1(sµi)

i wk2(sµi) ] = e±iψspin(sµi ) i

∓

+∞

C
2π

c(∓)
kp

e−i2π[ νk±νspin−p ]sµi /C
νspin −

p ]

= 0

[ νk±
˜p = 0 the sum over p is dominated by the
k ˜p . This corresponds to the spins’ seeing a stationary ﬁeld in the
k ˜p , which rotates spins away from ˆn0. Note that

νspin −

p=−∞
X

Near to the resonance νk ±

term containing c(∓)
(ˆn0, ˆm0, ˆl0) frame, proportional to c(∓)
c(∓)
k ˜p

is independent of sµi.

12

with

=

⇒

c(∓)
kp =

C

1
C

0
Z

so that

Approximate spin matching can be achieved for all sµi by adjusting the optics so
that an appropriate set of the c(∓)
k ˜p are small. This is called harmonic synchrobeta
spin matching. See also [16, 18]. For mode k and orbit amplitudes Ak and A−k
the strengths of the resonances are proportional to Akc+
k ˜p. The concept
of resonance strength is important for the acceleration of polarized protons (Sec.2.7.5
in [45]). Normally only the case of ﬂat rings is considered so that ˆn0 is vertical.
The formalism presented here shows how to deﬁne resonance strength for arbitrary
orientations of ˆn0. See also [19, 20]. On resonance with ei2π[ νk±νspin−˜p ]˜s/C = 1, the
coeﬃcients c(∓)

k ˜p and A−kc−

k ˜p take the form

c(−)
k ˜p =

d˜se−iψspin(˜s)

ls + ims

lx + imx

ly + imy

F~vk(˜s)

0

Z

(cid:0)
for νk + νspin = ˜p ;

C

C

1
C

1
C

c(+)
k ˜p =

d˜se+iψspin(˜s)

0

Z
for νk −

(cid:0)
νspin = ˜p

·

(cid:1)

·

(cid:1)

ims

ls −

lx −

imx

ly −

imy

F~vk(˜s)

(15)

These can be obtained from the SLIM algorithm by calculating the matrix G at
the resonance for one turn but without the backward spin basis rotation (Eq.(12),
Sec.2.7.7) that, in SLIM, is applied at the end of one turn [12].

Reformulation in terms of beta functions and dispersion[21]

We can reformulate Stage 1 by making a transformation of the particle coordinates
from ~u

(˜x, ˜px, ˜y, ˜py, ˜z, δ) via the transformation

(x, px, y, py, z, δ) to ~˜u

≡

where

~˜u = K

~u

·

≡



1
0
0
0
0
0
1
0
0
0
0
0
1
0
0
0
0
0
1
0
η3 1
η1 η4 −
η2 −
0
0
0
0
0

η1
−
η2
−
η3
−
η4
−
0
1



K(s) =








(η1, η2, η3, η4) is the periodic solution of the lin-
whereby the dispersion vector ~η
earized equations of motion for (x, px, y, py) with δ = 1 and without the rf cavities.
Then









≡

˜x = x

δη1,

˜y = y

δη2 .

−

−

13

The matrix K is symplectic so that the formalism remains canonical. In particular,
the new transfer matrices ˜M and eigenvectors ~˜vµ are obtained via

and

and

˜M(s2, s1) = K(s2)

M(s2, s1)

K−1(s1)

˜M(s + C, s) = K(s)

M(s + C, s)

K−1(s)

·

·

·

·

~˜vµ(s) = K(s) ~vµ(s)

=

⇒

so that the eigenvalues and orthogonality conditions are unchanged [12]. Furthermore
the new matrices ˜F and ˜G are

˜F(s) = F(s)

K−1(s)

·

˜G(s2, s1) = G(s2, s1)

K−1(s1)

·

2

The depolarization rate then takes the form

τ −1
dep,lin =

55√3
36

e2γ5~
ec2
m2

1
C

s0+C

d˜s

1
ρ(˜s)

s0

Z

3

|

µ=1  
X

with fk =
that in the special case, or the approximation, of no orbital coupling, the 6
matrices just consist of three 2

2 matrices on the diagonal.

Xk=I−III
k5 and ~˜wk = ~wk. This formulation has the advantage
6 orbit

n=1 [K −1]5n ·

kn = v∗
˜v∗

P

×

6

|

The eigenvectors ~˜vk(s) of the revolution matrix are then written in the form

×

Im

[ fk(˜s) ˜wkµ(˜s) ]

2

!

~˜vI =

, ~˜vII =

, ~˜vIII =

~tx
~02
~02









~02
~ty
~02









~02
~02
~tz





;





~tr =

1
2βr(s) (cid:18)
−
x, y, z) and the fk are given by fI ≡

p

(r
≡
(˜vII3η4 −
−
closely related to the factor

˜vII4η3) and fIII(s)

fz =

≡

βr(s)
[αr(s) + i]

e−iψr(s)

(cid:19)
(˜vI1η2 −
−

fx =

fy =
βz
2 e−iψz(s). The functions fI and fII are

˜vI2η1) ; fII ≡

ηk

2 + (αkηk + βkη′
βk

k)2

(k = I, II)

q

14

in [22]. fIII is in practice almost independent of s (see below). Note that these
α’s and β’s are Courant–Snyder parameters and should not be confused with the
quantities in Eq.(1). With these coordinates the ˜F matrix for a quadrupole takes the
form

˜F =





0 0 0 0 0
0
˜gη3
0 0 ˜g 0 0
˜g 0 0 0 0 ˜gη1





We can write

~˜wk(s0) =

D(s0 + C, s0)

˜G(s0 + C, s0)

~˜vk(s0)

·

−

h

−1

ˆλk

−

i

for (k = I, II, III) and we use a representation of the ˜G matrix in the form

˜G(s2, s1) =

d˜s D(s2, ˜s) ˜G0(˜s) ˜M(˜s, s1)

s2

s1

Z

with

˜G0 =

ls
ms −
−

lx
mx −

ly
my (cid:19)

·

˜F

(cid:18)
In thin lens approximation the ˜G matrix for a quadrupole is

˜G =

0

˜qly
˜qlx
−
+˜qmy 0 +˜qmx 0 0 κ2 (cid:19)

0 0 κ1

−

(cid:18)

˜qlxη3 and κ2 = +˜qmyη1 + ˜qmxη3. We see that as a result
where κ1 =
of separating the transverse coordinates into betatron and dispersion contributions,
columns six of ˜F and ˜G contain terms depending on dispersions.

˜qlyη1 −
−

The strong spin matching condition ~˜wk = 0 for suppressing depolarization now
amounts to setting the ˜G(sµl+1, sµl) ~˜vk(sµl) to zero in analogy with Eq.(12). Then
in the special case, or approximation, of a fully uncoupled optic and by taking into
account only the depolarizing inﬂuence of quadrupoles this is equivalent to requiring
[23, 24]:

d˜s

βx(˜s)g(˜s)e−i ψx(˜s) [ ly(˜s)

i my(˜s) ] e∓iψspin(˜s) = 0

For horizontal motion:

(1 + aγ)
√2

1
C

−

sµl+1

sµl

Z

p

For vertical motion:

(1 + aγ)
√2

1
C

−

sµl+1

sµl

Z

q

±

±

15

d˜s

βy(˜s)g(˜s)e−i ψy(˜s) [ lx(˜s)

i mx(˜s) ] e∓iψspin(˜s) = 0

(16)

(17)

For longitudinal motion:

(1 + aγ)
√2

1
C

−

ηy [lx(˜s)

×{

±

sµl+1

d˜s

[αz(˜s) + i]
βz(˜s)
Z
imx(˜s)] + ηx [ly(˜s)

sµl

p

g(˜s)e−iψz(˜s)

imy(˜s)]
}

±

e∓iψspin(˜s) = 0

(18)

Since in practice synchrotron motion is well approximated by simple harmonic
0. Then Eq.(18) may be

motion [25], βz(s) is almost independent of s and αz(s)
approximated by

≈

(1 + aγ)
√2

i
√βz

1
C

−

sµl+1

d˜sg(˜s)e−iψz(˜s)

sµl

Z

±

e∓iψspin(˜s)

ηy [lx(˜s)

i mx(˜s)] + ηx [ly(˜s)

×

{

i my(˜s)]
}

±

= 0

(19)

Harmonic synchrobeta spin matching in terms of beta functions and dispersion
follows the path detailed earlier under “Alternative Stage 1” but with the eigenvectors
~˜vk and the matrices ˜F. Typical expressions can be found in [24].

Commentary

Spin matching should be carried out using thick lenses so that the optic is correct.
Strong spin matching by minimizing the integrals in Eqs.(16–18) requires explicit in-
tegration. Furthermore Eqs.(16–18) must be modiﬁed if there is signiﬁcant orbital
coupling. Thus in practice the numerical ﬁtting involved in strong spin matching
can be carried out most simply by minimizing the Gij(sµl+1, sµl) since these already
represent integrals and do not need knowledge of the dispersion. Moreover these
matrices are precisely those contained in the SLIM program so that cross checks be-
tween programs are simpliﬁed. Another advantage of working with the G matrix is
that it allows sections of the ring to be studied and made transparent in isolation
since no knowledge of Courant–Snyder parameters is needed; use of G emphasizes
the local nature of spin transparency. On the other hand Eqs.(16–18) and the split–
up versions depend on Courant–Snyder parameters and these in turn depend on the
structure of the whole ring so that the “locality” is masked. When studying the spin
transparency of a ring, it is often useful for diagnostic purposes to set elements of the
G or the ˜G matrices to zero artiﬁcially and thereby obtain an impression of which
sections of the ring are most dangerous. For example by switching oﬀ column six of
˜G in quadrupoles, the eﬀect of dispersion can be cleanly separated from the eﬀect of
betatron motion. One can also investigate the system by using the matrix handling
facilities in symbolic algebra programs and the fact that the G and ˜G of magnets or
strings of magnets often depend in a simple way on the elements of the corresponding
M and ˜M [17]. Finally, the G and ˜G matrices are in general energy dependent. But
a spin match made at the design energy is usually still eﬀective for a few tens of MeV
above and below, except near resonances.

16

Some examples

In a perfectly aligned ﬂat ring (no vertical bends) with no solenoids and no x
coupling, the depolarization rate τ −1
is needed.

y
dep,lin vanishes (see below) so that no spin matching

−

A spin rotator (Secs.2.7.3, 2.7.4 in [45]) based on dipoles and containing no
quadrupoles is automatically almost spin transparent since the elements of G are usu-
ally smaller in dipoles than in quadrupoles [17]. Dipole rotators containing quadrupoles
need explicit spin matching [26].

Spin rotators based on a combination of solenoids (which rotate ˆn0 from the
vertical into the horizontal) and dipoles (to make the polarization longitudinal at an
IP) [17] are not automatically transparent. They also cause x
y coupling. However,
by sandwiching quadrupoles and skew quadrupoles among sections of solenoid the
coupling can be eliminated and by careful choice of the sandwich structure some
terms in columns 1 to 4 of G for the rotator can be made small at the same time
[17]. Column 6 remains troublesome but for antisymmetric solenoid schemes [17] the
columns 6 of the rotators cancel each other. For further discussion on solenoids see
[27, 28].

−

For a straight section (e.g. surrounding an IP) where the polarization is longi-
tudinal and which only contains quadrupoles and drifts, the spin precession angle is
a linear combination of the overall orbit deﬂections ∆px and ∆py in the quadrupole
ﬁelds [17]. Thus spin transparency implies making ∆px and ∆py vanish for all or-
bits. If the straight section is geometrically and optically left–right symmetric, this
can be achieved with an optic for which tan ∆ψx =
αy where
the ∆ψ’s are the phase advances between the IP and the outer end of the straight
section and the α’s appertain to the outer end. So the eight conditions that columns
1 to 4 of the G matrix vanish have been reduced to two conditions by the symmetry.
Furthermore, this is an example where the spin matching conditions reduce to purely
optical conditions.

αx and tan ∆ψy =

−

−

These conditions can also be formulated directly in terms of G. By choosing
ˆl = ˆy and ˆm = ˆx and requiring that the elements G11 and G23 vanish for the stretch
from the IP to the outer end, G vanishes for the whole straight section for arbitrary
orientation of ˆm, ˆl around the longitudinal ˆn0.

If the straight section contains rf cavities, their inﬂuence on the spin transparency

can often be neglected.

Other examples of the use of symmetry to simplify the spin match can be found
in [24] where spin matching using variants of Eqs.(16–18) for a ring with dipole ro-
tators is discussed. The results of a calculation with SLICK before and after a spin
match can be found in [29]. Experimental observations resulting from successful spin
matching involving spin rotators are described in [30].

Computer programs for strong spin matching

Strong spin matching facilities based on evaluation of spin–orbit integrals (e.g. Eqs.(16–
18) ) are built into the programs ASPIRRIN and SOM. To do spin matching in terms

17

of G the code SPINOR [31] can be used.

Stage 2: Harmonic closed orbit spin matching

Once the perfectly aligned ring has been spin matched, the eﬀects of misalignment
must be addressed. In a perfectly aligned ﬂat ring with no solenoids, ˆn0 is vertical so
that ly and my are zero. Then by inspection of the G matrix elements for horizontal
bends, quadrupoles and rf cavities it is clear that for no x
y coupling, columns 1,
2, 5 and 6 of G(s + C, s) vanish so that by Eq.(6) ~wI(s) and ~wIII(s) are zero. In
particular columns 1 and 2 of G and columns 1, 2 and 6 of ˜G vanish. Moreover, for
y coupling v∗
no x
dep,lin is automatically zero. In
in spin rotators) ˆn0 is made vertical in the arcs by
rings with vertical bends (e.g.
design.

II5 vanishes. Then by Eq.(10) τ −1

−

−

In real misaligned rings there is a vertical closed orbit distortion and ˆn0 is tilted
from the vertical in the arcs (see below) so that the above mentioned columns of
G and ˜G for the arc quadrupoles do not vanish. In practice the tilts can be tens
of milliradians and they increase with energy (they are roughly proportional to aγ)
but even these small angles can lead to strong depolarization so that it is essential
that the ring be very well aligned from the beginning. Note that vertical closed orbit
distortion leads primarily to depolarization due to horizontal synchrobetatron motion
in the arcs. Note also that tilts of tens of milliradians cause a negligible decrease of
the underlying ST polarization (Eq.(14), Sec.2.7.7).

If there is a vertical correction coil and a BPM near each quadrupole, one can
try to minimize the combined vertical kick (“kick minimization”) [32] applied to the
orbit by each quadrupole and its correction coil and thereby reduce the tilt of ˆn0 due
to the distorted orbit’s being oﬀ centre in the (misaligned) quadrupoles. This also
reduces the generation of spurious vertical dispersion so that the driving of νy and
νz (Eq.(11)) resonances is avoided. This presupposes that the positions with respect
to the quadrupoles of the BPM’s are well known. These relative positions can be
estimated using beam–based calibration (Sec.4.5.5 in [45])[32]. However, kick mini-
mization will not be eﬀective if, say, the dipoles have signiﬁcant tilt misalignments.
If these measures are insuﬃcient, a further method for bringing ˆn0 closer to the
vertical is needed. ˆn0, and thus its tilt, for the distorted ring can be obtained as
described in Sec.2.7.7 but one gains more insight by using a perturbation theory
based on SLIM concepts [33]. Viewed from the (ˆn0, ˆm, ˆl) frame calculated for the
design orbit, the ﬁrst order deviation of ˆn0 from the design orientation can be written
as

[δn01(s)

iδn02(s)] =

−

C
2π

i
−

hk

ei2πks/C
νspin
k

−

Xk

where the hk are Fourier coeﬃcients given by

hk =

s0+C

1
C

s0

Z

d˜s [d1(˜s)

id2(˜s)] e−ik2π˜s/C

−

18

Here

d1
d2 (cid:19)

(cid:18)

=

ls
ms −
−

lx
mx −

ly
my (cid:19)

(cid:18)




F

~uco −

·

e
p0 

∆Bs

1+aγ0
1+γ0

∆Bx(1 + aγ0)
∆By(1 + aγ0)












where the ∆Bx,y,s are ﬁeld errors and ~uco is the deviation of the 6–D closed orbit from

the design orbit. δˆn0 can be minimized by using correction coils to adjust the closed
orbit (e.g. by generating closed bumps so that the luminosity is not aﬀected) in such
a way that the real and imaginary parts of hk, with k near νspin, are small. This
technique is called harmonic closed orbit spin matching and is embodied in the
program FIDO [34, 35]. See [18] also. If the machine distortions are not well known
and if the closed orbit cannot be measured well enough, the closed orbit correction
If the distortions
must be carried out empirically by observing the polarization.
and the orbit are well enough known the correction coil strength can be calculated
ab initio (deterministic harmonic closed orbit spin matching) [36]. The correction
scheme should be chosen so that it achieves the maximum eﬀect on δˆn0 with the
smallest possible additional orbit distortion.

Harmonic closed orbit spin matching can in principle be used to minimize the
δˆn0 due to an uncompensated solenoid placed at the position of a nominally vertical
ˆn0. However, this is achieved more eﬃciently by generating relatively antisymmetric
vertical orbit bumps (spanning horizontal bend magnets) on each side of the solenoid
[37, 38].

It might also be useful to weight δˆn0(s) by a periodic function p(s) [39]. In that
case one tries to minimize p(s)δˆn0(s). This is worth trying, for example, if the main
source of depolarization due to misalignments is the coupling of non-zero ly and my
to the horizontal dispersion in the arcs (see Eq.(19)). This is often the case, as can be
seen by examining the numerical values of the contributions of each mode (I, II, III)
in Eq.(10). Then p(s) is taken to be η1.

To minimize p(s)δˆn0(s) one must minimize the harmonics ˜hk of

˜h(s) = p(s)(d1 −
= ˜h(s + C)

id2) + p′(s) [δn01(s)

iδn02(s)]

−

p(s) [δn01(s)

iδn02(s)] =

−

i C
2π

−

˜hk

ei2πks/C
k−νspin

k

P

whereby

Stage 3: Further tuning

Harmonic closed orbit spin matching can generate spurious vertical dispersion and
this in turn generates vertical emittance (nonzero v∗
II5 (Sec.2.1.4 in [45])) and also
ensures that column 6 of ˜G for the quadrupoles does not vanish. Thus extra depo-
larization can occur. It might then be useful to overlay a harmonic vertical betatron

19

match (k = II in Eq.(15)) on any existing Stage 1 match, assuming that is possi-
ble. Likewise, to overcome the eﬀect of spurious vertical dispersion in column 6 of
˜G one could use extra vertical correction coils to overlay a harmonic vertical disper-
sion match (k = III in Eq.(15)). Usually both of these two extra matches would be
empirical. One could also try to combine the harmonic closed orbit match and the
harmonic vertical dispersion match into one procedure.

Stage 4: Beam–beam spin matching

The beam–beam interaction is equivalent to a nonlinear lens and can spoil a spin
match. The eﬀect of the beam–beam interaction on the polarization is not fully
understood but it has been suggested that the beam–beam depolarization can be
reduced by balancing the beam–beam deﬂection of spins against subsequent deﬂec-
tions taking place in the ring quadrupoles. The condition for minimizing the eﬀect of
vertical kicks is independent of the current and charge distribution in the opposing
beam and takes the form [40]

ilx

mx −
β∗
y

+

p

±
X

e− i
2 (νspin±νy)
4 sin νspin±νy

2

±

C

0

Z

p

ds g

βye±iψy (mx + ilx) = 0

An equivalent prescription in SLIM formalism allows an arbitrarily coupled optic to
be treated [41].

Higher order resonances To go beyond the linearization of spin contained in
Eq.(1) one writes

ˆn(~˜u; s) = (1

α2

−

−

β2)1/2ˆn0(s) + α ˆm(s) + βˆl(s)

(20)

|

|

+

+

±

≤

≡ |

(for α2 + β2
1) and does not linearize the T–BMT equation. Then spin–orbit
resonances of arbitrarily high order can appear in ∂ ˆn
∂δ [7]. The strength decreases
kIII|
kII|
kI|
). In practice the most intrusive higher order
with the order (
νk + kIIIνIII. These “synchrotron sideband
resonances are those for which νspin = k
resonances” of the ﬁrst order parent resonances are due to modulation by energy
oscillations of the instantaneous rate of spin precession around ˆn0. They originate in
the part due to synchrotron motion in the term ~ωsb
ˆn0 appearing in the full equations
of spin motion (i.e. beyond the SLIM level) [42]. The depolarization rate associated
with sidebands of isolated parent resonances (νspin = k
νk) is approximately pro-
portional to the depolarization rate for the parent resonances. Thus the eﬀects of
synchrotron sideband resonances can be reduced by doing the spin matches described
above. Explicit formulae for the proportionality constants (“enhancement factors”)
can be found in [43, 44]. The underlying strength parameter (the “modulation index”)
of synchrotron sideband resonances is (aγσδ/νz)2 which increases strongly with the
energy and energy spread.

±

·

20

Other computer codes The SMILE algorithm is restricted to linearized orbital
motion and calculates ∂ ˆn
∂δ by an extension of the ﬁrst order perturbation theory of
SLIM to high order using Eq.(20) and full 3–D spin motion. The algorithm involves
multi–turn spin–orbit tracking. High order resonance eﬀects are manifested by reso-
nance denominators but the formalism ensures that the vector ˆn is of unit length. The
highest required absolute values of the kI, kII, kIII are speciﬁed as input parameters.
SODOM represents ˆn by a spinor notation. The periodicity condition ˆn(~u; s) =
ˆn(~u; s + C) (Sec.2.7.7) is equivalent to periodicity in the three phases of linearized
orbital motion and the one turn 2
2 spinor transfer matrix on a synchrobeta orbit is
also periodic in the initial orbital phases. The spinor transfer matrix and ˆn(~u; s) are
then represented by Fourier series. The Fourier coeﬃcients are obtained numerically
and ˆn(~u; s) can then be reconstructed. By constructing ˆn at many points in phase
space ∂ ˆn
∂δ can be obtained by numerical diﬀerentiation.The highest required absolute
values of the kI, kII, kIII are speciﬁed as input parameters.

×

The algorithm SpinLie utilizes Lie algebraic methods (Sec.2.7.9 in [45]) and can

handle non-linear orbit motion and 3–D spin motion.

The vector ˆn(~u; s) can also be obtained by stroboscopic averaging using the code
∂δ can then be calculated by numerical diﬀerentiation. This algorithm

SPRINT. ∂ ˆn
automatically includes all orders of resonance.

The above algorithms all exploit the DKM formula (Eq.(16),Sec.2.7.7) but the
SITROS program simulates the depolarization process directly using a Monte–Carlo
tracking simulation of the eﬀects on the orbit and then on the spin of stochastic photon
emission and damping and delivers an estimate of τdep. The equilibrium polarization
is then obtained from the approximation (Sec.2.7.7)

Peq = Pbks

τtot
τbks

1
τtot

=

1
τbks

+

1
τdep

.

(21)

(22)

This ignores the (normally small) term ∂ ˆn

∂δ in the numerator of the DKM formula.

where

References

1. J. Kewisch et al., Phys.Rev.Lett. 62 N04 (1989) 419; The program SITF is part

of the SITROS package.

2. A.W. Chao, Nucl.Inst.Meth. 180 (1981) 29
3. A.W. Chao, AIP Proc. 87, (1981) 395
4. SLICK is a thick lens version of SLIM by D.P. Barber. Private notes (1982)
5. K. Yokoya, User’s manual of SOM: Spin–Orbit Matching (1996)
6. C.W. de Jager, V. Ptitsin, Yu.M. Shatunov, Proc. 12th Int. Symp. High

Energy Spin Physics, World Scientiﬁc (1997)

7. S.R. Mane, Phys.Rev. A36 (1987) 105–130

21

8. K. Yokoya, KEK Report 92-6 (1992)

K. Yokoya, DESY Report 99–006 (1999) and at the Los Alamos archive:
physics/9902068

9. K. Heinemann, G.H. Hoﬀst¨atter, Phys. Rev. E54 N04 (1996) 4240
10. H. Mais, G. Ripken, DESY Report 83-62 (1983)
11. D.P. Barber, K. Heinemann, G. Ripken, Z. f. Physik C64 (1994) 117–167
12. D.P. Barber, G. Ripken, DESY report on spin dynamics and spin matching in

preparation.

13. S.R. Mane, DESY Report 85-125 (1985) and Cornell Report CLNS-86/750
14. D.P. Barber, K. Heinemann, G. Ripken, DESY Report M-92-04 (1992)
15. A.W. Chao, J. Appl. Phys. 50 (1975) 592
16. H. Mais, G. Ripken, DESY Report M-84-04 (1984)
17. D.P. Barber et al., Particle Accelerators 17 (1985) 243
18. R. Rossmanith, R. Schmidt, Nucl.Inst.Meth. A236 (1985) 231
19. G.H. Hoﬀst¨atter et al., in Nonlinear and Stochastic Beam Dynamics in Accel-

erators, DESY Report 97-161 (1997)

20. V. Balandin, N. Golubeva, D.P. Barber, DESY Report M-96-04 (1996)
21. H. Mais, G. Ripken, DESY Report 86-29 (1986)
22. M. Sands, SLAC 121 (1970)
23. A.W. Chao, K. Yokoya, KEK Report 81-7 (1981)
24. J. Buon, K. Steﬀen, Nucl.Inst.Meth. A245 (1986) 248
25. D.P. Barber et al., DESY Report 86-147 (1986)
26. A. Blondel, J. Jowett, Proc. 8th Int. Symp. High Energy Spin Physics, AIP

Proc. 187 (1989)

27. A.A. Zholents, V.N. Litvinenko, BINP (Novosibirsk) Preprint 81–80 (1981).

English translation: DESY Report L–Trans 289 (1984)

28. D.P. Barber et al., DESY Report 82–76 (1982)
29. D.P. Barber, Proc. 9th Int. Symp. High Energy Spin Physics, Springer (1991)
30. D.P. Barber et al., Phys.Lett. 343B (1995) 436
31. L. Hand and A. Skuja, DESY HERA Report 85-18 (1985); The program

SPINOR has been updated and modernized by D.P. Barber.

32. D.P. Barber et al., European Part.Acc.Conf. 1996
33. D.P. Barber et al., DESY Report 85-44 (1985)
34. S.R. Mane, DESY HERA Report 85-23 (1985)
35. D.P. Barber et al., Nucl.Inst.Meth. A338 (1994) 166
36. R. Assmann et al., Proc. 11th Int. Symp. High Energy Spin Physics, AIP

Proc. 343 (1995)

37. K. Steﬀen, DESY Report M-82-25 (1982)
38. A. Blondel, CERN LEP Note 629 (1990)
39. D.P. Barber, G. Ripken, DESY HERA Report 87-15 (1987)
40. J. Buon, Proc. 6th Int. Symp. High Energy Spin Physics, Journal de Physique,

Colloque C2, Tome 46 (1985)
41. D.P. Barber, Private notes (1995)
42. K. Yokoya, Particle Accelerators 13 (1983) 85
43. S.R. Mane, Nucl.Inst.Meth. A292 (1990) 52

22

44. S.R. Mane, Nucl.Inst.Meth. A321 (1992) 21
45. Handbook of Accelerator Physics and Engineering, Eds. A.W. Chao and M.

Tigner, World Scientiﬁc (1999)

23

