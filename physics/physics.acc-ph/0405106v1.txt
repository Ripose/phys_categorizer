4
0
0
2
 
y
a
M
 
0
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
6
0
1
5
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Beam-Breakup Instability Theory for Energy Recovery Linacs

Georg H. Hoﬀstaetter and Ivan V. Bazarov
Laboratory for Elementary Particle Physics, Cornell University, Ithaca, New York 14853

Here we will derive the general theory of the beam-breakup instability in recirculating linear
accelerators, in which the bunches do not have to be at the same RF phase during each recirculation
turn. This is important for the description of energy recovery linacs (ERLs) where bunches are
recirculated at a decelerating phase of the RF wave and for other recirculator arrangements where
diﬀerent RF phases are of an advantage. Furthermore it can be used for the analysis of phase errors
of recirculated bunches. It is shown how the threshold current for a given linac can be computed
and a remarkable agreement with tracking data is demonstrated. The general formulas are then
analyzed for several analytically solvable cases, which show: (a) Why diﬀerent higher order modes
(HOM) in one cavity do not couple so that the most dangerous modes can be considered individually.
(b) How diﬀerent HOM frequencies have to be in order to consider them separately. (c) That no
optics can cause the HOMs of two cavities to cancel. (d) How an optics can avoid the addition of
the instabilities of two cavities. (e) How a HOM in a multiple-turn recirculator interferes with itself.
Furthermore, a simple method to compute the orbit deviations produced by cavity misalignments
has also been introduced.
It is shown that the BBU instability always occurs before the orbit
excursion becomes very large.

I.

INTRODUCTION

Synchrotron light sources based on Energy Recovery
Linacs (ERLs) show promise to deliver X-ray beams with
both brilliance and X-ray pulse duration far superior to
the values that can be achieved with storage ring technol-
ogy. This is due to the fact that the emittances in an ERL
are largely determined by a laser-driven source, technol-
ogy which has been improving steadily over the years,
and will undoubtedly improve further. To generate high
brilliance high ﬂux X-rays it is necessary to accelerate
beams to the energies (several GeV) and with the cur-
rents (several 100 mA) that are typical in these storage
rings. This would require that the linac delivers a power
of order 1 GW to the beam. Without somehow recovering
this energy after the beam has been used, such a device
would be practically unfeasible. Energy recovery [1] can
be achieved by decelerating high energy electrons to gen-
erate cavity ﬁelds which in turn accelerate new electrons
to high energy. With this, large beam powers that are
not accessible in a conventional linac, can be produced.
Several laboratories have proposed high power ERLs
for diﬀerent purposes. Designs for light production with
diﬀerent parameter sets and various applications are be-
ing worked on by Cornell University [2, 3], BNL [4],
Daresbury [5], TJNAF [6], JAERI [7], the University of
Erlangen [8], Novosibirsk [9], and KEK [10]. TJNAF
has incorporated an ERL in its design of an electron–
ion collider (EIC) [11] for medium energy physics, while
BNL is working on an ERL–based electron cooler [12] for
the ions in the relativistic ion collider (RHIC). The work
at TJNAF, JAERI and Novosibirsk is based on existing
ERLs of relatively small scale.

One important limitation to the current that can be ac-
celerated in such an ERL is given by the beam-breakup
(BBU) instability. The size and cost of all these new ac-
celerators certainly requires a very detailed understand-
ing of this limitation.

A theory of BBU instability in recirculating linacs,
where the energy is not recovered in the linac, but where
energy is added to the beam when it returns after each
recirculation turn, was presented in [13]. Such a linac
can consists of many cavities and several recirculation
turns can be used. This original theory was additionally
restricted to scenarios where the bunches of the diﬀerent
turns are in the linac at about the same accelerating RF
phase, such as in the so-called continuous wave (CW) op-
eration where every bucket is ﬁlled. Tracking simulations
[14] compared well with this theory. In the following we
therefore refer to it as the CW recirculator BBU theory.
It determines above what threshold current Ith the trans-
verse bunch position x displays undamped oscillations in
the presence of a higher order mode (HOM) with fre-
quency ωλ. If there is only one higher order mode and one
recirculation turn with a recirculation time tr in the linac,
the following formula is obtained for T12 sin ωλtr < 0:

Ith = −

2c2
Q )λQλωλ

e( R

1
T12 sin ωλtr

,

(1)

where c is the speed of light, T12 is the element of the
transport matrix that relates initial transverse momen-
tum px before and x after the recirculation loop, e is the
elementary charge, (R/Q)λQλ is the impedance (in units
of Ω) of the higher order mode driving the instability,
Qλ is its quality factor. A corresponding formula had
already been presented in [21]. Occasionally, additional
factors are found when this equation is stated [15, 16, 19].
We give a concise derivation which shows that no such
additional factors are required.

In the past eﬀorts have been made to derive threshold
currents from the analysis of experimental data obtained
at the TJNAF FEL-ERL [16, 19] using the CW recircula-
tor BBU theory. The data has not been interpreted satis-
factorily, and at least part of the reason could be that the
underlying theory had not been derived for ERL opera-
tion. The theory presented in this paper should therefore

2

be used to extend and improve these previous analysis re-
sults, as it is directly applicable to ERL operation.

Here we will derive the general theory of the beam-
breakup instability in recirculating linear accelerators, in
which the bunches do not have to be at the same RF
phase during each recirculation turn, similar to what has
ﬁrst been presented in [20]. First we treat the simplest
case of one dipole HOM and one recirculation turn. Then
we allow many HOMs and many recirculations, and ﬁ-
nally we analyze several analytically solvable cases.

II. ONE DIPOLE HOM AND ONE
RECIRCULATION

For recirculating linacs, the simplest case of one HOM
and one recirculation loop has long been described [17].
Previous theories which assume that the recirculation
time is an integral number of RF periods should not be
used when investigating ERLs. Next we derive more gen-
eral formulas that may be applied for arbitrary recircu-
lation times.

where the wake function W (τ ) describes the transverse
force at time τ after the HOM was excited. The mo-
mentum transfer is described by an eﬀective transverse
voltage of the HOM, V (t) = c

e ∆px(t).

Assuming that all bunches are injected on the cav-
ity’s central axis, they do not excite dipole HOMs on
their ﬁrst path through the cavity. However, the eﬀec-
tive transverse voltage of the HOM determines what kick
∆px(t) the bunch sees and what position it will have
when it returns to the cavity after the recirculation time
tr. The transfer matrix element T12 maps the transverse
momentum px(t) to x(t + tr) = T12px(t). Inserting this
into Eq. (2) leads to an integral equation for the HOM’s
eﬀective voltage,

V (t) =

W (t − t′)I(t′)T12

V (t′ − tr)dt′ .

(3)

e
c

t

−∞

Z

To solve this integral equation, one assumes that the
current is a continuous stream of short pulses being in-
jected at multiples of an interval between bunches tb, so
that the current on the second turn is given by

∞

m=−∞
X

A. The Dispersion Relation

I(t) = I0tb

δD(t − tr − mtb) ,

(4)

In the simplest model of multi-pass beam breakup,
bunches are injected into a cavity, which is assumed to
have one dipole HOM (e.g. T M11-like mode), accelerated
in the cavity and then recirculated to pass the cavity a
second time before they are ejected. In the case of a two-
turn recirculating linac, each bunch would be accelerated
on both passes through the linac and ejected to a user
area. The RF phase of the bunch would therefore be ap-
proximately the same on both passes. In an ERL, the RF
phase on the second pass through the cavity is shifted by
π with respect to the ﬁrst pass so that the energy that
the bunch gains in the ﬁrst pass is returned to the cav-
ity during the second pass and the bunch is ejected with
reduced energy into a beam dump.

If a dipole HOM is excited in the cavity, then a bunch
that enters the cavity on axis experiences a transverse
kick and starts to oscillate around the design orbit of the
recirculation loop and returns to the cavity with a trans-
verse oﬀset. This oﬀset leads to a change in the energy
of the HOM. If it increases the HOM energy, transverse
kicks experienced by subsequent bunches will be larger,
which will in turn lead to a further growth of the HOM
energy once the kicked bunch returns to the linac: an
instability develops.

To describe this eﬀect, we use the ideas and nomen-
clature from [18]. When a current I(t′) passes the cavity
during its recovery loop at a time t′, the charge I(t′)dt′
with the transverse oﬀset x(t′) excites the dipole HOM,
creating a transverse momentum for particles traveling
through the cavity subsequently at time t,

∆px(t) =

W (t − t′)x(t′)I(t′)dt′ ,

(2)

e
c

δD being the Dirac-delta function. Note that tb is an
integer multiple of the RF circulation time t0 = 2π/ω0
for the RF frequency ω0. We write the recirculation time
in terms of the time tb between bunches as

with an integer nr and δ ∈ [0, 1). For a recirculating linac
one has

tr = (nr − δ)tb ,

δtb ≈ nt0 ,

(5)

(6)

and for an ERL one has δtb ≈ (n + 1
2 )t0 for some integer
n. A “+” sign in Eq. 5 that deﬁnes δ may seem more
natural but our choice leads to simpliﬁed equations.

The HOM voltage at a time t ∈ [ntb + tr, ntb + tr + tb)

is given by

V (t) = I0tbT12

W (t − tr − mtb)V (mtb) .

(7)

n

e
c

m=−∞
X

Evaluating this at the time t = ntb + tr when the recir-
culated bunches pass through the cavity leads to

∞

e
c

V (ntb + tr) = I0tbT12

W (mtb)V ([n − m]tb) . (8)

m=0
X
In the CW recirculator BBU theory this diﬀerence equa-
tion was dealt with by assuming that the voltage can be
written as V (t) = V0e−iωt for t = ntb where a positive
imaginary part of ω indicates instability. Note that this
does not require V (t) to be a harmonic function, but that
it can be a linear combination of harmonic functions with

frequencies ω + m 2π
for integers m. This distinction has
tb
not been always made clear and is a potential source of
confusion [19]. One obtains the equation

1
I0

e
c

∞

= tbT12

eiωtr

W (mtb)eiωmtb .

(9)

m=0
X
The smallest value of the current I0 for which there is a
real ω is the threshold current Ith of the instability.

We proceed by writing V (t) in terms of its Laplace
transform, retaining all possible frequencies in HOM volt-
age, which automatically enables proper description of
arbitrary recirculating conﬁguration:

V (t) =

1
2π

∞−ic0

−∞−ic0

Z

˜V (ω′)e−iω′tdω′ .

(10)

Note that this is not the conventional way of writing a
Laplace transform. We have chosen this notation in order
to make it appear more similar to a Fourier Transform.
It also makes the subsequent notation more similar to the
CW recirculator BBU theory. The Laplace transform is
used rather than the Fourier transform since we want to
analyze the onset of instability where the frequencies ω
become complex. With the following deﬁnition

˜V Σ(ω) =

˜V (ω +

(11)

2π
tb

n)

we obtain

n=−∞
X

∞

∞

˜V Σ(ω) = tb

V (ntb)eiωntb .

(12)

n=−∞
X
Since ˜V Σ(ω) is periodic with 2π/tb, it has a Fourier series,
and its Fourier coeﬃcients are V (ntb). This shows that
˜V Σ(ω) does not vanish. We can therefore choose t =
(n + nr)tb in Eq. (7) and sum over n,

˜V Σ(ω) = tb

V ([n + nr]tb)eiω[n+nr]tb

(13)

= I0t2

bT12
∞

e
c
∞

×

n=−∞
X

m=0
X
e
c

∞

n=−∞
X

∞

m=0
X

W ([m + δ]tb)V ([n − m]tb)eiω[n+nr]tb

= I0tbT12

eiωnr tb

W ([m + δ]tb)eiωmtb ˜V Σ(ω) .

This ﬁnally yields the dispersion relation between I0 and
ω which can be used for all δ. A corresponding derivation,
which has treated the beam recirculation in a way that
can be applied to ERLs, has been presented in [20]. We
believe that this paper should be referenced more often,
since it is hardly referenced, whereas the earlier papers
with CW recirculator BBU theory, which was not derived
for ERLs, are often referenced in the context of ERLs,
where they are not strictly applicable.

3

(14)

(15)

B. The Far-Field Wake

The sum in the dispersion relation

1
I0

= tbT12

eiωnr tbw(δ) ,

e
c

w(δ) =

W ([n + δ]tb)eiωntb ,

∞

n=0
X

can be computed when the far-ﬁeld approximation for
the wake function is used,

W (τ ) =

R
Q

(cid:18)

(cid:19)λ

ω2
λ
2c

ωλ
2Qλ

e−

τ sin ωλτ .

(16)

λ = ωλ ± i ωλ
With ω±
2Qλ
sum can be evaluated if Im(ω) > − ωλ
2Qλ

and ω+ = ω + i ωλ
2Qλ
and becomes

the required

w(δ) =

W ([n + δ]tb)eiωntb

(17)

∞

n=0
X
R
Q

(cid:18)

R
Q

=

=

×

eiω+
λ δtb
1 − ei(ω+

λ +ω)tb

−

e−iω−
λ δtb
1 − e−i(ω−

λ −ω)tb #

(cid:19)λ

ω2
λ
4ic "
ω2
λ
4c

e−iωδtb

(cid:19)λ

(cid:18)
eiω+(δ−1)tb sin(ωλδtb) − eiδω+tb sin(ωλ[δ − 1]tb)
cos ω+tb − cos ωλtb

.

The dispersion relation thus becomes

I0 =

2
KT12

e−iωnr tb

ωλ
2Qλ

e

δtb [cos(ω+tb) − cos(ωλtb)]

e−iω+tb sin(δωλtb) − sin([δ − 1]ωλtb)

,

with K = tb
persion relation of the CW recirculator BBU theory:

(18)
ω2
2 . For δ = 0 this becomes the dis-
λ

c2 ( R

Q )λ

e

I0 =

2
KT12

e−iωtr cos(ω+tb) − cos(ωλtb)

.

sin(ωλtb)

(19)

This describes the case when the recirculated bunches are
in the same buckets as the accelerated bunches. When
the recirculated bunches are just between accelerated
bunches, then δ = 1
2 ,

I0 =

1
KT12

e−iωtr cos(ω+tb) − cos(ωλtb)
cos(ω+tb/2) sin(ωλtb/2)

.

(20)

For the case that every bucket is ﬁlled, this would be an
ERL with tb = t0. The dispersion relation for ERLs for
other δ is less simple than Eq. (20) and has δtb = (n +
1
2 )t0 in Eq. (18). This occurs when the decelerating and
accelerating bunches are not perfectly centered between
each other.

4

ǫ cot ωtr

ǫ cot ωtr

∆ωtb

∆ωtb

0.75

0.5

0.25

0

-0.25

-0.5

-0.75

0.75

0.5

0.25

0

-0.25

-0.5

-0.75

3

3.05

3.2

3.25

3

3.05

3.2

3.25

3.1
ω

3.15
tb
2π

3.1
ω

3.15
tb
2π

FIG. 2: ∆ωtb (blue dots) and ǫ cot ωtr (blue and green
curves).
The curve is dark blue in the region where
T12 sin ωtr < 0 and light green otherwise. The ω of the in-
stability is given by the intersection of the dotted line with a
dark blue solid curve for which ∆ω is smallest. Left: A case
of T12 sin ωλtr < 0. Right: A case of T12 sin ωλtr > 0.

I0 = ∓

e−iωnr tb eiωλ,0±δtb (∆ωtb + iǫ) .

(22)

2
KT12

Within the linearization, the phase factors could be com-
bined to eiωtr . This is not done in order to retain
the symmetries of Eq. (21) for ω → ω + 2π/tb and for
ω → −ω∗, i.e. ∆ω → −∆ω∗ and ωλ,n± → ωλ,−n∓.

Due to these symmetries, the real current close to
ωλ,n± is the same for each of these frequencies. With-
out loss of generality we therefore use ωλ,n± = ωλ and
no longer require the symmetries,

I0 = −

e−iωtr (∆ωtb + iǫ) .

(23)

2
KT12

Since I0 must be real, ∆ωtb sin ωtr = ǫ cos ωtr leading to
the following two equivalent equations,

I0 = −

ǫ
K

2
T12 sin ωtr

,

(24)

I0 = −sign(sin ωtr)

ǫ2 + (∆ωtb)2 .

(25)

2
KT12

p

For this formula to describe the threshold current, it is
required that I0 > 0 and therefore T12 sin ωtr < 0.

Figure 2 shows ∆ωtb and ǫ cot ωtr versus ωtb ∈ [0, π]
for tr = 6.88tb. The dotted line and the curve have to
meet at a region where T12 sin ωtt < 0, which is indicated
by a dark blue curve.

When nrǫ ≪ 1, i.e. HOM decay is negligible on the
time scale of recirculation time, then ω ≈ ωλ in the region
where T12 sin ωλtr < 0 and one obtains

I0 = −

ǫ
K

2
T12 sin ωλtr

,

(26)

which is the traditional and commonly used approxima-
tion in Eq. (1) which had been derived for δ = 0.

FIG. 1: I0(ω) in the complex plain for ω ∈ [0, π/tb]. The scale
is arbitrary.

assuming ∆ωtb ≪ 1. This leads to

C. The Threshold Current

For a given positive current I0, the values of ω that
satisfy the dispersion relation Eq. (18) will in general
be complex. If they all have negative imaginary parts,
the beam motion is stable. If one of them has positive
imaginary part it will be unstable.

For small currents the beam motion is stable. When
the current is increased, at some point, one of these ω
will become real. At this point the threshold current
is reached. The threshold current Ith is therefore the
smallest current I0 for which there is a real ω that satisﬁes
the dispersion relation. To ﬁnd this current, we note that

I0(ω +

) = I0(ω) , I0(−ω∗) = I ∗

0 (ω) .

(21)

2π
tb

It is therefore suﬃcient to investigate ω ∈ [0, π/tb].

Figure 1 shows I0(ω) in the complex plain for ω ∈
[0, π/tb]. The intersection with the real axis that has the
smallest positive value yields the threshold current.

III. APPROXIMATE THRESHOLD CURRENT

It can often be justiﬁed to linearize in ǫ = ωλ
2Qλ

tb, ǫ ≪ 1,
which describes a situation when HOM decay is negli-
gible on the time scale of the bunch spacing tb. This
applies to linacs when nearly every RF bucket is ﬁlled.
The smallest |I0| in Eq. (18) is obtained when cos ωtb
is close to cos ωλtb, which occurs whenever ω is close to
ωλ,n± = ±ωλ + n 2π
for any integer n. Due to Eq. (21),
tb
all these frequencies lead to the same threshold current.
We therefore additionally linearize in ∆ω = ω − ωλ,n±,

ln(Ith[A])

3

2

1

0

-1

-2

-3

3

2

1

0

-1

-2

-3

5.4

5.6

5.8

6

tr/tb

ln(Ith[A])

5.4

5.6

5.8

6

tr/tb

FIG. 3: Threshold current obtained by tracking (red dots)
and approximate analytical solution (top) and by a numerical
solution (bottom) of the dispersion relation Eq. (18). Param-
eters: nr − δ ∈ [6.135, 7.234], (R/Q)λ = 100 Ω, Qλ = 104,
T12 = −10−6 eV/c, ωλtb = 9.67.

In the region with T12 sin ωλtr > 0 one obtains ωnr ≈

nπ, which can be used in Eq. (25),

I0 =

2
K|T12| s

1
n2
r

ǫ2 +

Mod(ωλtr, π)2 .

(27)

For nrǫ ≫ 1, i.e. when HOM damping is substantial on
the recirculation time scale, one again uses Eq. (25) with
ωtr ≈ (2n ∓ 1
2 )π, where the + or − sign is determined by
the sign of T12 sin ωλtr,

I0 =

2
K|T12| s

1
n2
r

π
2

ǫ2 +

Mod(ωλtr ±

, 2π)2 .

(28)

Note that in this case the threshold current weakly de-
pends on tr and can be estimated simply by I0 =
2ǫ/K|T12|.

One can perform these approximations more accu-
rately, for example, by approximating cot ωtr by a line
or second order curve. However, in regions where nrǫ is
not much larger or much smaller than 1, simple formulas
cannot be found.

Figure 3 (top) shows the threshold current obtained
with the approximate analytic solution compared with
the threshold current that is found by tracking particles
for the simple case of one cavity with one HOM and one
recirculation loop.

5

Figure 3 (bottom) compares the same tracking re-
sults with a numerical solution of the dispersion rela-
tion Eq. (18). The data agrees remarkably well with the
approximate formula in the region where ∆ω is small,
i.e. where I0 is relatively small. In the region where the
threshold current is relatively large, the agreement with
the approximate expression is not satisfactory, however.
To ﬁnd the threshold current with Eq. (18), the small-
est positive real value of I0 for ω ∈ [0, π/tb] was found
by linearly interpolating 100 points in the region ω ∈
[ωλ − 1
nr

, ωλ + 1
nr

π
tb

π
tb

].

A.

Instability Growth Rate

We denote the threshold current by ˆI0 and the real
frequency ˆω ∈ [0, π/tb] satisﬁes Eq. (18) for this current.
When the current I0 is slightly larger than ˆI0, there is
one frequency ω(I0) that satisﬁes Eq. (18) and is close to
ˆω. It has a positive imaginary part. All other frequen-
cies ω at which Eq. (18) holds and for which therefore
˜V Σ(ω) might not vanish have an imaginary part that is
not positive.
In Eq. (10) there are therefore exponen-
tially growing terms. For currents that are only slightly
larger than the threshold current, the complex frequency
ω(I0) can be expanded with respect to ∆I = I0 − ˆI0,

e−iωt = e−i[ˆω+ℜ{ dω

dI0

∆I}]teℑ{ dω

dI0

∆I}t .

(29)

The rise time per current of the instability is thus given
by α = ℑ{ dω
. The dispersion relation Eq. (18) leads
dI0
to a long formula. However, using the simpliﬁed Eq. (22)
leads to

}| ˆI0

α = ℑ

1
dI0/dω

=

=

(cid:8)
1
ℑ
ˆI0
1
ˆI0tb

ˆI0

(cid:12)
(cid:12)
(cid:9)
(cid:12)
− inrtb +
(cid:12)

tb
(ˆω − ωλ)tb + iǫ

−1

(cid:8)(cid:0)

4ǫ + ( ˆI0KT12)2nr
4 + 8nrǫ + ( ˆI0KT12nr)2

.

(cid:1)

(cid:9)

(30)

Provided parameters are not in the region where the
curves diverge in Fig. 3 (top), i.e. sin ωλtr is not close
to zero, the following approximate formulas hold for the
growth rate: For nrǫ ≪ 1 one obtains α = 1
ǫ and for
ˆI0tb
nrǫ ≫ 1 one obtains α = 1
ˆI0tb

1
nr

.

IV. MULTIPLE DIPOLE HOMS AND
MULTIPLE RECIRCULATIONS

Recirculating linacs with many cavities and several re-
circulation loops have been considered early on [13, 18].
Here we use the same nomenclature as much as possible.
The N higher order modes, which can be associated with
diﬀerent cavities, are numbered by an index i. The Np
passes through the linac are numbered by an index I.

6

where n(t, tI

i ) = Maxm(t ≥ mtb + tI
∞

i ). Computing

V L
i =

Vi(ntb + tL

i )eiωntb

(38)

leads to

n=−∞
X

V L
i =

I0tb

Wi(mtb + tL

i − tI

i ) (39)

∞

∞

Np

n=−∞
X
NIJ (i−1)

m=m∗
X

I=1
X

e
c

I

J=1
X

j=1
X

×

T IJ
ij Vj ([n − m]tb + tJ

j )eiωntb .

The second summation starts at m∗ = n − n(ntb + tL
which can be simpliﬁed by writing tI
i )tb,

i − δI

i , tI
i )

i = (nI
i δI

i − nI

i ]tb, [δ−

i ]tb)
i ]tb ≥ [m + δL

i − δI

i ]tb)

(40)

m∗ = n − n([n + nL
= −Maxm([nL
= nI
i − nL

i − nI
i + γi(I, L) ,
i > δI

where γi(I, L) = 1 if δL
the summation index m now leads to

i and 0 otherwise. Shifting

V L
i =

I0tb

e
c

∞

∞

Np

n=−∞
X

m=0
X

I=1
X

I

NIJ (i−1)

Wi([m + γi(I, L) + δI

i − δL

i ]tb)

× Vj ([n − m − nI

i + nL

i − γi(I, L)]tb + tJ

J=1
X

j=1
X
j )eiωntb .

and with δi(I, L) = γi(I, L) + δI
i , which is between
0 and 1, shifting the index n ﬁnally leads to the relation

i − δL

(41)

T IJ
ij

i (t), pI

The horizontal position and momentum that the beam
has at time t in the HOM i during turn I is denoted
i (t) = (xI
~zI
i (t)). The transport matrix that trans-
ports the phase space vector ~zJ
j at HOM j during turn J
to ~zI
ij and the time it takes to transport
i
a particle from the beginning of the ﬁrst turn to HOM
i during turn I is denoted tI
i . The beam is propagated
from after HOM i − 1 to after HOM i by

is denoted TIJ

i (t) = TII
~zI

ii−1 · ~zI

i−1(t − [tI

i − tI

i−1]) +

0
e
c Vi(t)

(cid:18)

(cid:19)

. (31)

This equation can be iterated to obtain the phase space
coordinates as a function of the HOM strength that cre-
ates the orbit oscillations. With the matrix element
ij = (TIJ
T IJ

ij )12 one obtains

xI
i (t) =

T IJ
ij

Vj(t − [tI

i − tJ

j ])

(32)

I−1

N

J=1
X

j=1
X
i−1

j=1
X

e
c

e
c

+

T II
ij

Vj(t − [tI

i − tI

j ]) .

The strength Vi(t) of the HOM i is created by all parti-
cles that have traveled through that HOM via the integral

Vi(t) =

Wi(t − t′)I I

i (t′)xI

i (t′)dt′ ,

(33)

t

Np

−∞

Z

I=1
X

where I I
i (t) is the current at time t that the fraction of
the beam has which passes the HOM i on turn I. Com-
bining this with Eq. (32) leads to the following integral-
diﬀerence equation:

t

Np

−∞

I=1
X
NIJ (i−1)

I

Z

e
c

×

j=1
X

J=1
X
N,
i − 1,

(

if I 6= J;
if I = J.

NIJ (i − 1) =

(35)

Now the approximation of short bunches is used. The
current is given at time t by pulses that are equally spaced
with the distance tb,

This reduces the integral to a sum,

Vi(t) =

I0tb

Wi(t − tI

i − mtb)

(37)

×

ij Vj (mtb + tJ
T IJ

j ) ,

∞

m=−∞
X

n(t,tI
i )

Np

m=−∞
X
NIJ (i−1)

I=1
X

e
c

I

J=1
X

j=1
X

Vi(t) =

Wi(t − t′)I I

i (t′)

(34)

V L
i =

I0tb

Wi([m + δi(I, L)]tb)

(42)

ij Vj(t′ − [tI
T IJ

i − tJ

j ])dt′ ,

ij eiω[m+nI
T IJ

i −nL

i +γi(I,L)]tbV J
j

.

The following sum is equivalent to that in Eq. (17),

wi(δ) =

Wi([m + δ]tb)eiωmtb .

(43)

∞

Np

m=0
X
NIJ (i−1)

I=1
X

e
c

I

×

J=1
X

j=1
X

∞

m=0
X

Np

Equation (42) reduces to

1
I0

V L
i =

e
c

tb

I

I=1
X
NIJ (i−1)

I I
i (t) =

I0tbδ(t − tI

i − mtb) .

(36)

wi(δi(I, L))eiω(tI

i −tL

i +δi(I,L)tb)

×

ij V J
T IJ
j

.

J=1
X

j=1
X

(44)

If a vector ~V is introduced that has the coeﬃcients V I
i ,
this equation can be written in matrix form,

1
I0

~V = W(ω)U~V ,

(45)

where the matrix M = W(ω)U is determined by
Eq. (44). When all electrons are considered to have the
speed of light, tI
i does not depend on the HOM
number i and we therefore drop this index and obtain
the following matrix coeﬃcients:

i − tL

wi(δ(I, L))eiωTop( tI −tL

tb

)tb T IJ
ij

Np

M LJ

ij =

e
c

tb

I=J+Θj,i
X
1,
if j ≥ i;
0, otherwise,

(

Θj,i =

where Top(x) is the smallest integer that is equal to or
larger than x. With Kronecker ˆδik this determines the
matrices W and U to be

tbwi(δ(I, L))eiωTop( tI −tL

tb

)tb δik ,

e
c

W LI

ik =
kj = T IJ

U IJ

kj ΘI,J+Θj,k .

(47)

(48)

For each frequency ω, I −1

is an eigenvalue of M(ω).
0
Since the eigenvalues are in general complex, but I0 has
to be real, the threshold current is determined by the
largest real eigenvalue of M(ω). The matrix has the
properties

M(ω +

) = M(ω) , M(−ω∗) = M∗(ω) ,

(49)

2π
tb

and it is therefore again suﬃcient to investigate ω ∈
[0, π/tb] to ﬁnd the threshold current.

Note that V Np

N never appears on the right hand side of
Eq. (42) so that the dimension of M can be reduced by
one to N × Np − 1. Furthermore the dimension can be
reduced when two fractional parts δI
j are equal
since then V I
j are identical. Note also that for
N = 1 and Np = 2 Eq. (42) reduces to the dispersion
relation for one HOM in Eq. (18).

i and V J

i and δJ

A.

Instability Growth Rate

The growth rate of the instability is again computed
by ﬁrst obtaining the threshold current ˆI0 and the real
frequency ˆω for which ˆI −1
is an eigenvalue of M(ˆω). If
this is the kth eigenvalue λk(ω) of the matrix M(ω), then
the growth rate of the instability is given by

0

α = − ˆI −2

0 ℑ

−1

dλk
dω

(cid:8)(cid:0)

(cid:1)

(cid:12)
(cid:12)
(cid:9)
(cid:12)
(cid:12)

.

I0= ˆI0

(50)

V. MULTIPLE HOMS IN ONE CAVITY

The presented theory for multiple HOMs and multi-
ple recirculation turns can in general only be evaluated
with computers. However, for some simple situation an
analytical understanding is possible.

7

One such case is an accelerator with one recirculation
loop and one cavity in which many HOMs can be ex-
cited. The (1, 2) matrix elements that refer to transport
between HOMs for the same pass are zero, T JJ
ij = 0. All
matrix elements that describe the recirculation loop are
identical, T IJ
ij = T12 if I 6= J. The matrix elements in
Eq. (46) are then given by

M L2

ij = 0 , M L1

ij =

tbwi(δ(2, L))eiωTop( t2 −tL

tb

tb)T12 .

e
c

(46)

Equation (45) becomes with δ = δ(2, 1),

(51)

1
I0

V 1
i =

e
c

tb

wi(δ)eiωnr tb T12V 1
j

.

(52)

j
X

e
c

A summation over the index i shows that
be nonzero when

j V 1

j can only

1
I0

= tbT12

eiωnr tb

wi(δ) .

(53)

P

i
X

P

Comparing this with Eq. (14) shows that one only has to
i wi(δ) to arrive at
replace w(δ) of the single HOM by
the threshold formula for the multi-HOM case. To ﬁnd
the smallest real I0 that Eq. (53) can produce for real
i wi(δ) has to be maximized. The sum is especially
ω,
large when the denominator of one of the terms is very
small, i.e. when cos ωtb ≈ cos ωλtb.

P
When the HOM frequencies modulo 2π/tb are suﬃ-
ciently diﬀerent for the diﬀerent HOMs, the maximal ab-
i wi(δ) will be close to the largest abso-
solute value of
lute value that any of the wi(δ) could have individually.
This is due to the fact that all the wj(δ) for j 6= i are rel-
atively small for frequencies ω for which the denominator
of wi(δ) is small.

P

For HOM frequencies that are suﬃciently diﬀerent in
the above sense, the threshold current for several HOMs
therefore does not diﬀer signiﬁcantly from the threshold
current of the worst individual HOM.

Figure 4 shows how the threshold current changes
when the frequency of one HOM is ﬁxed at a small thresh-
old current with | sin ω1tr| = 1 and a second HOM fre-
quency is varied. Superimposed is Ith if only the sec-
ond HOM is present. It is apparent that the HOM that
would produce the larger threshold-current if it was solely
present only inﬂuences the threshold current of the pair
when the frequencies ±ω1 mod 2π/tb and ±ω2 mod 2π/tb
are closer together than about ∆ωλ = ǫ/tb = ωλ/2Qλ.

One can draw the conclusion that in the case of
many HOMs they do not interact destructively when the
frequencies ±ωλ mod 2π/tb are not very close together.
Tracking simulations also demonstrate this eﬀect.

One strategy to increase the BBU threshold current
is the introduction of HOM frequency spreads between
cavities. As an example, Fig. 5 shows the threshold cur-
rent found by tracking as a function of uniform frequency
spread of 20 HOMs in a single cavity. For all three curves
(R/Q)λQλ is the same. It is seen that for lower Qλ, the

ln(Ith[A])

overlaps and as a result to less pronounced diﬀerences in
the threshold for diﬀerent HOM frequencies.

8

1

2

3

4

ω2 [GHz]

where the matrix N is given by

FIG. 4: Dark black curve: the threshold current ln(Ith[A]) for
one HOM at ω1/2π = 2 GHz as a function of a second HOM
with frequency ω2. Light green curve: threshold current when
only the second HOM is present. Light red lines: frequencies
for which cos ω2tb ≈ cos ω1tb where the threshold current is
not simply the minimum of the threshold currents produced
by the individual HOMs.

w2(0)T 11



w1(δ)αrT 21
11
21 + w2(δ)αrT 21
w1(0)T 21
11

w1(δ)αrT 21
12
21 w2(δ)αrT 21
22 w2(δ)αrT 22
21
w1(0)T 21
12

0

0

.



(55)


The third row is similar to the ﬁrst row and eliminating
it by similarity transformations leads to the 2 × 2 matrix

-2

-3

-4

-5

10

9

8

7

6

5

4

3

2

1

)

A

(
 
t
n
e
r
r
u
c
 
d
o
h
s
e
r
h
t

l

Q = 2000 

Q = 1000 

Q = 500 

0

0

1

2

3

4

5
frequency spread (MHz)

6

7

8

9

10

FIG. 5: The threshold current Ith as a function of uniform
equidistant frequency spread for 20 HOMs in a single cav-
ity. Abscissa displays frequency diﬀerence between the two
HOMs adjacent in frequency. Parameters: ¯ωλ/2π = 2 GHz,
−6 eV/c, tr = 1.000125 ·
(R/Q)λQλ = 5000 Ω, T12 = −10
−6 s, ω0/2π = 1.3 GHz. Threshold is determined by track-
10
ing with accuracy 0.1%.

curve begins to saturate for larger frequency spread than
for the high Qλ case. It is also seen that the threshold
for frequency spread ωλ/2Qλ is similar in all three cases.
Both observations are consistent with the above assertion
that HOMs do not interfere when they are further apart
than ωλ/2Qλ. The fact that oscillations in the Fig. 5
are smaller for low Qλ is consistent with the conclusion
that a broader HOM resonance peak should lead to more

VI. ONE DIPOLE HOM IN TWO CAVITIES

In order to see how two dipole HOMs interact, we will
now analyze a set of two HOMs with one recirculation
loop, i.e. Np = 2. We abbreviate δ = δ(2, 1) and αr =
eiωnrtb . The dispersion relation is then given by

V 1
1
V 1
2
V 2
1

1
I0 







=

tbN

e
c

V 1
1
V 1
2
V 2
1









(54)

w1(δ)αr
0

w2(0)
w2(δ)αr

×

0
w2(δ)αr
T 21
11
21 + w1(0)
21 + T 21
T 11
w1(δ)αr

(cid:19)

(cid:18)

 

T 21
12
21 T 21
T 22

22 !

.

(56)

Even though ω1(δ) appears in the denominator, the
formula for the eigenvalues of this matrix does not con-
tain such a denominator. Therefore the largest real eigen-
value will again occur at a frequency ω for which one
of the HOM frequencies satisﬁes cos(ωtb) ≈ cos(ωλtb).
The term wi(δ) and wi(0) of the other HOM can then
again be neglected, so that for suﬃciently diﬀerent HOM
frequencies mod 2π/tb the threshold current is again ap-
proximately determined by the HOM which would have
the smallest Ith if there were no other HOMs present.

We therefore now assume that the two HOMs are
equal, w1 = w2. Now one can perform an approxima-
tion analogous to Eq. (23) leading to

N = −

eiωtr

K
2

1
∆ωtb + iǫ

×

21 + e−iωtr (T 11
T 21

21 + T 22

(cid:18)

T 21
12
21 ) T 21
22 (cid:19)

.

T 21
11

(57)

It is interesting to analyze whether the eﬀect of the
two HOMs can cancel. A cancellation could occur most
naturally when the linac and the recovery loop are mirror
symmetric. A mirror symmetry of the linac means that
the beta functions of the ﬁrst pass, going from low to
high energy, are the mirror image of those of the second
pass, going from high to low energy. An example of such
an optics is shown in Fig. 6.

Since the (1, 2) element of the transport matrix be-
tween a region with momentum p0 and a region with

momentum p can be written with Twiss parameters as

Each bunch passes the linac Np = 2Nr times and the

T12 =

sin ∆Ψ ,

(58)

ββ0
pp0

s

this symmetry leads to T 22
21 . An additional mirror
22 = T 21
symmetry of the return arc leads to T 21
11 . The
eigenvalues of the matrix in Eq. (57) then become,

21 = T 11

1
I0

= −

eiωtr

K
2

1
∆ωtb + iǫ

×

(59)

T 21
11 ±

(cid:20)

q

12 (T 21
T 21

21 + 2e−iωtr T 11
21 )
(cid:21)

.

Since there are two solutions to the quadratic eigenvalue
equation, to every eigenvalue that is smaller than 1/Ith
of a single cavity, there exists in general the one that is
larger. Therefore two cavities do not compensate their
instabilities, but it is possible to decouple the cavities to
the extent that the combined threshold current is just
as large as that for a single cavity. For this, one has to
choose T 21
12 = 0, i.e. the phase advance of the return arc
has to be a multiple of π.

Since the kick of a HOM disturbs the beam most at
low energy, the ﬁrst and the last cavity of an ERL are the
strongest contributors to BBU. It seems therefore advis-
able to adjust the phase advance of the arc to a multiple
of π also when the linac has more than two cavities.

A. Multiple Recirculation Turns

One could envision a multi-turn recirculating linac as
ERL. The beam would pass the same linac Nr times to
reach its top energy, and subsequently it would be decel-
erated in just as many turns through the linac. The cur-
rent in the cavities would be 2Nr times higher than the
current that is available at high energy. One could there-
fore conjecture that the BBU threshold current is Nr
times smaller than for a one-turn ERL. Here we will show
that the threshold current can be signiﬁcantly smaller
than that conjecture and in general can be expected to
decrease quadratically with Nr.

)

m

(
 
n
o
i
t
c
n
u
f
 
a
t
e
b

60

50

40

30

20

10

0

0

50

100

150

200
position in linac (m)

250

300

350

400

FIG. 6: Example of a mirror-symmetric linac optics. Dark red
curve (light green curve) is horizontal (vertical) beta function
in the linac for accelerating beam. Dashed lines show lattice
function for decelerating beam.

9

(62)

(63)

matrix in Eq. (46) becomes

M LJ =

e
c

tb

Np

I=J+1
X

w(δ(I, L))eiωTop( tI −tL

tb

)tb T IJ ,

(60)

where the lower indexes have been suppressed since only
one HOM is considered. The eigenvalue equation thus
becomes

1
I0

V L =

e
c

tb

Np

Np

J=1
X

I=J+1
X

w(δ(I, L))eiωTop( tI −tL

tb

)tbT IJ V J ,

An approximation equivalent

to that

Eqs. (23) and (57) results in

(61)
leading to

1
I0
Np

V L = −

Np

×

1
K
2
∆ωtb + iǫ
eiω[Top( tI −tL

tb

J=1
X

I=J+1
X

)−δ(I,L)]tbT IJ V J .

Comparing the exponent on the right hand side to those
in Eqs. (44) and (46) shows that this can be written as

V LeiωtL

= −

K
2

1
∆ωtb + iǫ

×

1
I0
Np

Np

eiω(tI −tJ )T IJ V J eiωtJ

.

J=1
X

I=J+1
X

Since the right hand side does not depend on L, all the
terms V J eiωtJ
are equivalent and the condition that they
do not vanish is

1
I0

= −

K
2

1
∆ωtb + iǫ

I>J
XX

eiω(tI −tJ )T IJ ,

(64)

where the double sum goes over all pairs of I and J for
which I > J. Similar to the condition obtained from
Eq. (23) which is analyzed with Fig. 2, the fact that I0
has to be real entails the condition

∆ω
ǫ

cos(ω[tI − tJ ])T IJ
sin(ω[tI − tJ ])T IJ =

.

(65)

I>J
PP
I>J
PP
I>J sin(ω[tI − tJ ])T IJ > 0, we again
In regions where
obtain the approximation that ω ≈ ωλ. The equation for
the threshold current of an Nr times recirculating ERL
I Nr
corresponds therefore to that of the case without
th
recirculation in Eq. (1),

PP

I Nr
th = −

2c2
Q )λQλωλ

e( R

1

sin(ω[tI − tJ ])T IJ .

(66)

A comparison with Eq. (1) shows that this current
is smaller than the one-turn ERL by a factor of up to

I>J
PP

I>J |T IJ |/|T12|. This is in agreement with earlier result
presented in [21]. Assuming that all matrix elements are
PP
of about equal magnitude, the threshold current in an Nr
times recirculating ERL is therefore in general smaller by
about a factor of Nr(2Nr − 1). This conclusion is con-
sistent with tracking results for microtrons [22] and for
two-turn ERL [23]. The scaling in a particular case, how-
ever, can be quite diﬀerent depending on details of the
lattice design, e.g. approximate scaling with Nr was re-
ported in [24].

10

The voltage seen by bunch i on turn L is therefore
l=−∞ Vlei 2π
given by ¯V L
so that for the time
tb
tL
i , Eq. (68) can be written as

i =

ltL
i

∞

¯V L
i = I0tb

Wi(tL

i − tI

i − mtb)

(71)

P

n(tL

i ,tI
i )

Np

m=−∞
X
NIJ (i−1)

I=1
X

I

×





J=1
X

j=1
X

Np

I=1
X

T IJ
ij

¯V J
j − xI

.

0i

e
c





VII. CAVITY MISALIGNMENTS

After performing the summation over m one obtains

In the derivation above,

it was assumed that the
bunches travel along the cavities’ symmetry axes when
the current is below the threshold for BBU instability.
When the cavities are misaligned, the beam will excite
dipole higher order modes even below the threshold and
the trajectory will be disturbed by these modes.

Let us assume that the ith cavity is misaligned with
respect to the path adjustment of the Ith turn by xI
0i,
leading to the misalignment vector ~x0. The dipole HOMs
that are excited by the beam are now not only due to the
beam position ﬂuctuation that is produced by the HOMs
themselves, but additionally due to the cavity misalign-
ments. The HOM voltages in Eq. (33) are therefore given
by

Vi(t) =

Wi(t − t′)I I

i (t′)[xI

i (t′) − xI

0i]dt′ .

(67)

With the manipulations that led to Eq. (37) this leads to

¯V L
i = I0tb

wω=0
i

(δ(I, L))

(72)

I

NIJ (i−1)

×





J=1
X

j=1
X

T IJ
ij

¯V J
j − xI

,

0i

e
c

where the superscript ω = 0 means that w(δ) is computed
with Eq. (17) for ω = 0.

Comparing with Eqs. (44) and (45) shows that this can

be written as

~¯V = I0W(0)U~¯V − I0W(0)~x0 ,

(73)

with W = W(0) and U from Eqs. (47) and (48). The
vector of voltages is therefore given by ~¯V = [I0WU −
I]−1I0W~x0. Equation (32) can now be used to compute
the beams distance from the cavity center at each turn
and each cavity. One obtains

Vi(t) = I0tb

Wi(t − tI

i − mtb)

(68)

i (tI
xI

i ) − xI

0i =

t

Np

−∞

Z

I=1
X

n(t,tI
i )

Np

m=−∞
X
NIJ (i−1)

I=1
X

I

×



T IJ
ij

Vj (mtb + tJ

j ) − xI

e
c

j=1
X
Following the derivation to Eq. (44) leads to

J=1
X



.

0i



V L
i = I0tb

wi(δi(I, L))eiω(tI

i −tL

i +δi(I,L)tb)

Np

I=1
X

I

NIJ (i−1)

×





J=1
X

j=1
X

T IJ
ij

j − xI
V J
0i

e
c

∞

n=−∞
X

eiωntb

.(69)





For all oscillation frequencies that are not multiples of the
bunch repetition frequency, ω = 2πl/tb, l is an integer,
∞
n=−∞ eiωntb vanishes so that the condition
the term xI
0i
for V L
i (ω) to be non-zero is the same as for the BBU
instability without misalignments xI
0i. Below threshold,
the HOM voltage therefore has the following form:

P

Vi(t) =

Vlei 2π

tb

lt .

(70)

∞

l=−∞
X

I

NIJ (i−1)

J=1
X

j=1
X

T IJ
ij

¯V J
j − xI

0i ,

(74)

e
c

~x − ~x0 = U[I0WU − I]−1I0W~x0 − ~x0 (75)

= [I0UW − I]−1~x0 .

Evaluating this for a single cavity with a single HOM

leads to

x − x0 =

x0
e
c I0tbT12wω=0(δ) − 1

.

(76)

For δ = 1

2 and with ǫ = ωλ
2Qλ

tb one obtains

x − x0 = x0

I0KT12

− 1

.

(77)

2 sin ωλtb
cosh ǫ
cosh ǫ − cos ωλtb

2

−1

(cid:21)

(cid:20)

There is a current I0 at which the denominator be-
comes 0 and the orbit deviation would become very large.
The question arises whether this current is larger than
the BBU threshold Ith or smaller, so that large orbit ex-
cursions would present a new kind of instability.

This problem does not only arise for the single HOM
case of Eq. (75) but also for the general case of Eq. (77).

11

Very large orbit excursions x occur for currents for which
the matrix inverse does not exist.

The inverse matrix to be inverted is (I0WU − 1)−1 =
I0A Diag[(λi − 1/I0)−1] A−1, where A is the matrix that
diagonalizes W(0)U. We therefore see that 1/I0 for
which the orbit gets very large is given by the eigenval-
ues of W(0)U. These values are naturally smaller than
1/Ith, which is the largest eigenvalue of W(ω)U that is
produced for any frequency ω.

This proves that the BBU instability always occurs

before the orbit excursion becomes very large.

sonal computer. This duration is suﬃcient to determine
the onset of transverse BBU instability in most practical
cases.

The output of the code contains amplitudes of HOM
voltages as a function of time, which is used to determine
the growth rate of the instability by ﬁtting an exponen-
tial. Several successive calls are made to the tracking
unit to determine the threshold. The length of the track-
ing time is estimated from Eq. (30) based on the desired
accuracy in threshold determination.

IX. CONCLUSION

VIII. TRACKING RESULTS

The tracking code BI (stands for beam instability) was
developed to perform studies of beam breakup in recir-
culating linacs [25]. The algorithm models point charge
bunch interactions with HOMs in linacs, taking into ac-
count proper time delays between the cavities, transfer
maps, etc., allowing BBU simulations due to longitudi-
nal, transverse and other higher order modes in a general
linac conﬁguration.

The basic algorithm can be summarized as following.
The string of HOMs that a bunch sees in its lifetime be-
tween injection and ejection points is represented by a list
of pointers to the actual cavities. The proper time delays
between cavities is also stored for each pointer. E.g. for N
HOMs and Np passes, the list of pointers would be N Np
long pointing to N HOMs. This approach allows one to
represent any recirculation conﬁguration without limita-
tions. As the train of bunches is injected into the struc-
ture, the next instance when any bunch sees any pointer
is determined, and the HOM voltage in the correspond-
ing cavity is updated. Then, this bunch is pushed to the
next pointer where its coordinates are stored, waiting
for its turn in time to be the next bunch going through
a pointer. This way no bunches end up ahead of time
precluding a situation when a bunch sees a cavity with
incorrectly updated HOM ﬁelds, i.e. causality is properly
realized. Furthermore, the algorithm is general enough to
allow modeling of the longitudinal instability where tim-
ing between diﬀerent bunches is no longer kept ﬁxed. The
practical realization of this algorithm is relatively fast, al-
lowing the tracking of a complete 5 GeV ERL with 300
HOMs for 0.1 ms in less than a minute on an average per-

For dipole HOMs we have derived the BBU theory for
arbitrary recirculation times, so that the theory can be
applied to ERLs. The resulting equations have been used
to ﬁnd analytical results for (1) multiple HOMs in one
cavity, (2) two equal HOMs for a one-turn ERL, and
(3) one HOM for a multiple times recirculating ERL.
For (1) the numerical observation that it often suﬃces to
include only the strongest of several diﬀerent HOM was
explained and the distance in frequency was derived for
which one can consider two HOMs as diﬀerent, for (2)
it was shown that two cavities do not cancel each others
instability but that they can be arranged so that they
do not add dangerously, and for (3) was shown that the
BBU threshold current for an Nr times recirculating ERL
is roughly up to Nr(2Nr − 1) times smaller than that in
a corresponding one-turn ERL.

Furthermore, a simple method to compute the orbit de-
viations produced by cavity misalignments has also been
introduced. And it is shown that the BBU instability
always occurs before the orbit excursion becomes very
large.

Several comparisons with tracking data verify the ap-
plicability of the theory and of the tracking program. The
conclusions should be useful in determining and optimiz-
ing the maximum current for the many ERLs that are
currently in design and pre-proposal stages worldwide.

X. ACKNOWLEDGMENTS

We thank Joseph Bisognano and Geoﬀrey Kraﬀt for
careful reading of the manuscript and for their useful
comments.

[1] M. Tigner, Nuovo Cimento 37, 1228 (1965).
[2] S.M. Gruner, M. Tigner (eds.), Report No. CHESS 01-

003, 2001.

[3] G.H. Hoﬀstaetter et al., in Proceedings of the 2003 Par-
ticle Accelerator Conference, Portland, OR (IEEE, Pis-
cataway, NJ, 2003), pp. 192-194.

[4] I. Ben-Zvi et al.,

in Proceedings of the 2001 Particle
Accelerator Conference, Chicago, IL (IEEE, Piscataway,
NJ, 2001), pp. 350-352.

[5] M.W. Poole et al., in Proceedings of the 2003 Particle Ac-
celerator Conference, Portland, OR (IEEE, Piscataway,
NJ, 2003), pp. 189-191.

[6] S.V. Benson et al., in Proceedings of the 2001 Particle
Accelerator Conference, Chicago, IL (IEEE, Piscataway,
NJ, 2001), pp. 249-252.

[7] M. Sawamura et al., in Proceedings of the 2003 Parti-
cle Accelerator Conference, Portland, OR (IEEE, Piscat-
away, NJ, 2003), pp. 3446-3448.

[8] D.E. Berkaev et al., in Proceedings of the 2002 European
Particle Accelerator Conference, Paris, France (CERN,
Geneva, 2002), pp. 724-726.

[9] G.N. Kulipanov, A.N. Skrinsky, N.A. Vinokurov, J. Syn-

chrotron Rad. 5, 176 (1998).

[10] T. Suwada et al., in Proceedings of the 2002 ICFA Beam
Dynamics Workshop on Future Light Sources, Japan.
[11] L. Merminga et al., in Proceedings of the 2002 European
Particle Accelerator Conference, Paris, France, (CERN,
Geneva, 2002), pp. 203-205.

[12] I. Ben-Zvi et al., in Proceedings of the 2003 Particle Ac-
celerator Conference, Portland, OR (IEEE, Piscataway,
NJ, 2003), pp. 39-41.

[13] J.J. Bisognano, R.L. Gluckstern, in Proceedings of the
1987 Particle Accelerator Conference, Washington, DC
(IEEE Catalog No. 87CH2387-9), pp. 1078-1080.

[14] G.A. Kraﬀt, J.J. Bisognano, in Proceedings of the 1987
Particle Accelerator Conference, Washington, DC (IEEE
Catalog No. 87CH2387-9), pp. 1356-1358.

[15] K. Beard, L. Merminga, B.C. Yunn, in Proceedings of
the 2003 Particle Accelerator Conference, Portland, OR
(IEEE, Piscataway, NJ, 2003), pp. 332-334.

[16] L. Merminga, I.E. Campisi, D.R. Douglas, G.A. Kraﬀt,

12

J. Preble, B.C. Yunn, in Proceedings of the 2001 Particle
Accelerator Conference, Chicago, IL (IEEE, Piscataway,
NJ, 2001), pp. 173-175.

[17] J.J. Bisognano, G.A. Kraﬀt, in Proceedings of the 1986
Linear Accelerator Conference, Stanford, CA (SLAC-
303), pp. 452-454.

[18] G.A. Kraﬀt, J.J. Bisognano, S. Laubach, unpublished,

1987.

1994

[19] N.S.R. Sereno, Ph.D. Dissertation, University of Illinois,

[20] B.C. Yunn, in Proceedings of the 1991 Particle Accel-
erator Conference, San Francisco, CA (IEEE Catalog
No. 91CH3038-7), pp. 1785-1787.

[21] R.E. Rand, Recirculating electron accelerators (Harwood
Academic Publishers, New York, 1984), Section 9.5.
[22] L. Merminga, B.C. Yunn, JLAB Technical Report No.

TN-97-032, 1997

[23] I.V. Bazarov, LEPP Technical Report No. ERL 02-4,

2002, http://lepp.cornell.edu/public/ERL/

[24] H. Herminghaus, H. Euteneuer, Nuclear Instruments and

Methods 163, 299 (1979).

[25] Available at http://lepp.cornell.edu/~ib38/

