DEUTSCHES ELEKTRONEN-SYNCHROTRON
in der HELMHOLTZ-GEMEINSCHAFT

DESY 04-112
July 2004

Theory of space-charge waves on gradient-proﬁle relativistic electron
beam: an analysis in propagating eigenmodes

Gianluca Geloni, Evgeni Saldin, Evgeni Schneidmiller and Mikhail Yurkov
Deutsches Elektronen-Synchrotron DESY, Hamburg

4
0
0
2
 
l
u
J
 
5
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
2
0
7
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

ISSN 0418-9833

NOTKESTRASSE 85 - 22607 HAMBURG

Theory of space-charge waves on gradient-proﬁle relativistic electron beam:
an analysis in propagating eigenmodes

2

Gianluca Geloni,∗ Evgeni Saldin, Evgeni Schneidmiller, and Mikhail Yurkov†
Deutsches Elektronen-Synchrotron,
Notkestrasse 85, 22607 Hamburg,
Germany
(Dated: February 2, 2008)

We developed an exact analytical treatment for space-charge waves within a relativistic electron
beam in terms of (self-reproducing) propagating eigenmodes. This result is of obvious theoretical
relevance as it constitutes one of the few exact solution for the evolution of charged particles under
the action of self-interactions. It also has clear numerical applications in particle accelerator physics
where it can be used as the ﬁrst self-consistent benchmark for space-charge simulation programs.
Today our work is of practical relevance in FEL technology in relation with all those schemes where
an optically modulated electron beam is needed and with the study of longitudinal space-charge
instabilities in magnetic bunch compressors.

PACS numbers: 52.35.-g, 41.75.-i

I.

INTRODUCTION

The evolution problem for a collection of charges under
the action of their own ﬁelds when certain initial condi-
tions are given is, in general, a formidable one. Numerical
methods are often the only way to obtain an approximate
solution, while there are only a few cases in which ﬁnding
an exact treatment is possible.

In this paper we report a fully self-consistent solution
to one of these problems, namely the evolution of a rel-
ativistic electron beam under the action of its own ﬁelds
in the (longitudinal) direction of motion. The problem
of longitudinal space-charge oscillations has been, so far,
solved only from an electrodynamical viewpoint [1], or us-
ing limited one-dimensional models [2]. On the contrary,
in our derivation the beam, which is assumed inﬁnitely
long in the longitudinal direction, is accounted for any
given radial dependence of the particle distribution func-
tion.

An initial condition is set so that the beam is consid-
ered initially modulated in energy and density at a given
wavelength. When the amplitude of the modulation is
small enough the evolution equation can be linearized.
An exact solution can be found in terms of an expansion
in (self-reproducing) propagating eigenmodes.

Our ﬁndings are, in ﬁrst instance, of theoretical impor-
tance since they constitute one of the few exact solutions
known up to date to the problem of particles evolving
under the action of their own ﬁelds.

Next to theoretical and academical

interest of our
study we want to emphasize here its current relevance

∗Electronic address: gianluca.aldo.geloni@desy.de; Also at Depart-
ment of Applied Physics, Technische Universiteit Eindhoven, The
Netherlands
†Also at Joint Institute for Nuclear Research, Dubna, Moscow Re-
gion, Russia

to applied physics and technology. For example, particle
accelerator physics in general and FEL physics in partic-
ular make large use of simulation codes (see for instance
[3, 4, 5]) in order to obtain the inﬂuence of space-charge
ﬁelds on the beam behavior. Yet, these codes are bench-
marked against exact solutions of the electrodynamical
problem alone (i.e. solutions of Poisson equation) and
only recently [2] partial attempts have been made to
benchmark them against some analytical model account-
ing for the system evolution. However, such attempts
are based on one-dimensional theory which can only give
some incomplete result. On the contrary, we claim that
our ﬁndings can be used as a standard benchmark for
any space-charge code from now on.

To give some up-to-date example of practical applica-
tions (besides, again, theoretical and numerical impor-
tance) we wish to underline that our results are of rel-
evance to an entire class of problems arising in state-
of-the-art FEL technology. In fact, several applications
rely on feeding (optically) modulated electron beams into
an FEL. For instance, optical seeding is a common tech-
nique for harmonic generation [6]. Moreover pump-probe
schemes have been proposed that couple the laser pulse
out of an X-ray FEL with an optical laser. To solve
the problem of synchronization between the two lasers
a method has been proposed, which makes use of a sin-
gle optically modulated electron beam in order to gener-
ate both pulses. This proposal relies on the passage of
this electron beam through an X-ray FEL and an opti-
cally tuned FEL [7]: given the parameters of the system,
plasma oscillations turn out to be a relevant eﬀect to
be accounted for.
It is also worth to mention, as an-
other example, the relevance of plasma oscillation theory
in the understanding of practical issues like longitudinal
space-charge instabilities in high-brightness linear accel-
erators. High-frequency components of the bunch current
spectrum (at wavelengths much shorter than the bunch
length) can induce, through self-interaction, energy mod-
ulation within the electron beam which is then converted

into density modulation when the beam passes through
a magnetic compression chicane, thus leading to beam
microbunching and break up. When longitudinal space-
charge is the self-interaction driving the instability (see
[8]), one is interested to know with the best possible ac-
curacy how plasma oscillations modulate the bunch, in
energy and density, before the compression chicane.

Our calculations can be applied to these cases directly
or in support to macroparticle simulations thus providing
outcomes of immediate practical importance.

Throughout this paper we will make use of cgs units.
Our work is organized as follows. Next to this Introduc-
tion, in Section II, we pose the problem in the form of
an integro-diﬀerential equation which makes use of nat-
urally normalized quantities. In Section III we present
our main theoretical results. In the following Section IV
we describe some applications and important exempliﬁ-
cations of the obtained results, including the role of the
initial condition. Finally, in Section V we come to con-
clusions.

in energy and density is customary. Once the modula-
tion wavelength λm has been ﬁxed, it is natural to deﬁne
the phase ψ = ωm (z/vz(E0) − t), where vz(E0) ∼ c is
the longitudinal electron velocity at the nominal beam
kinetic energy E0 = (γ − 1)mc2, ωm = 2πvz/λm, t is the
time and z the longitudinal abscissa. Upon this, and af-
ter what has been said about the choice of longitudinal
dynamics, it is appropriate to operate in energy-phase
variables (P, ψ), P being the deviation from the nominal
energy.

In this spirit the total derivative of the phase ψ is given

by:

dψ
dz

=

∂ψ
∂z

+

∂ψ
∂t

dt
dz

=

ωm
vz(E0)

−

ωm
vz(E)

.

(1)

Now, if we assume that the particle energy is not signiﬁ-
cantly diﬀerent from the nominal energy we can expand
v(E) in E around E0. Keeping up to second order terms
in E and using the deﬁnition of P we ﬁnd

II. THEORY

A. Position of the problem

dψ
dz

=

ωmP
cγ2
z E0

,

We are interested in developing a theory to describe
longitudinal plasma waves in a relativistic electron beam.
In order to do so we have to ﬁnd a way to translate in
mathematical terms the idea of dealing with the longi-
tudinal dynamics only, while keeping intact the general
three-dimensional description of the system (electromag-
netic ﬁelds and particle distribution).

Immediately related with the development of a theory,
is its range of applicability. The idea of selecting longi-
tudinal dynamics translates from a physical viewpoint in
the assumption that the longitudinal space-charge ﬁelds,
alone, describe the system evolution. This corresponds
to a situation with physical parameters tuned in such
a way that, on the time-scale of a longitudinal plasma
oscillation, transverse dynamics does not play a role.

One may, of course, devise diﬀerent methods to select
the longitudinal dynamics alone: actually he will come
up with some ideal approximation of what real focus-
ing systems in modern linear accelerators do, provided
that the β-functions are large enough with respect to the
plasma wavelength.

Whatever the practical or ideal mean chosen to select
longitudinal dynamics such a choice translates, from a
mathematical viewpoint, in the choice of dynamical vari-
ables along the direction of motion only, while transverse
coordinates enter purely as parameters in the description
of the ﬁelds and of the particle distribution.

Our beam is initially modulated at some wavelength
λm, in density and energy. This is no restriction because,
as said in Section I, the modulation amplitude is consid-
ered small enough so that we can linearize the evolution
equation. Then, a Fourier analysis of any perturbation

of

fact

took

advantage

|E=E0≃ c/(γ2

that
the
where we
z E0), where γz = (1 −
(dvz/dE)
vz(E0)2/c2)−1/2.
Note that, here, we distinguish
from the very beginning between γ and γz (or v and
vz). In fact our theory can be applied to the case of an
electron beam in vacuum as well as to the case of a beam
under the action of external electromagnetic ﬁelds, for
in the ﬁrst situation γ = γz,
example in an undulator:
strictly, while in the latter they obviously have diﬀerent
values.

The full derivative of P is simply given by

dP
dz

= −eEz ,

where Ez(z, ψ) is the space-charge ﬁeld in the z direc-
tion. Eq. (2) and Eq. (3) are the equation of motion
for our system and they can be interpreted as Hamil-
ton canonical equations corresponding to the Hamilto-
nian H(ψ, P, z):

H = e

dψEz +

Z

ωm
2cγ2
z

P 2
E0

.

(4), alone, deﬁnes our theory. The
In this sense, Eq.
bunch density distribution will be then represented by
the density f = f (ψ, P, z; r⊥), where the semicolon sep-
arates dynamical variables from parameters and it will
be subjected to the (Vlasov) evolution equation

∂f
∂z

+

∂H
∂P

∂f
∂ψ

−

∂H
∂ψ

∂f
∂P

= 0

3

(2)

(3)

(4)

(5)

with appropriate initial condition at z = 0. Here we are
interested in a beam initially modulated in energy and
density; moreover, as said in Section I, the modulation
must be small enough to ensure that linearization of Eq.
(5) is possible. Thus we will take f (ψ, P, z; r⊥)|z=0 =
f0(P ; r⊥) + f1(ψ, P, z; r⊥)|z=0. f0 is a so called unper-
turbed solution of the evolution equation Eq. (5), and
it does not depend on z, while f1 is known as the per-
turbation; it is understood that, in order to be in the
linear regime, f1 ≪ f0 for any value of dynamical vari-
ables or parameters. In the following we assume that the
dynamical variable P and the parameter r⊥ are separa-
ble in f0 so that we may write f0(P ; r⊥) = n0(r⊥)F (P ),
where the local energy spread function F (P ) is consid-
ered normalized to unity. The initial modulation can be
written as a sum of density and energy modulation terms:
f1(ψ, P, z; r⊥)|z=0 = f1d(ψ, P ; r⊥) + f1e(ψ, P ; r⊥).

On the one hand f1d is responsible for a pure density

modulation and can be written as

f1d(ψ, P, z; r⊥) = a1d(r⊥)F (P ) cos(ψ) ,

(6)

where we set to zero an unessential, initial modulation
phase.

On the other f1e is responsible for a pure energy mod-

ulation and can be assumed to be

f1e(ψ, P, z; r⊥) = a1e(r⊥)

cos(ψ + ψ0) ,

(7)

dF
dP

where ψ0 is an initial (relative) phase between den-
sity and energy modulation. Finally it is convenient
to deﬁne complex quantities ˜f1d = a1dF , and ˜f1e =
a1e(dF /dP )eiψ0 so that f1|z=0 = ( ˜f1d + ˜f1e)eiψ + CC. In
the linear regime, then, one can write f1(ψ, P, z; r⊥) =
˜f1(P, z; r⊥)eiψ + CC.
Further deﬁnition of ˜Ez =
˜E(z; r⊥) in such a way that Ez = ˜Ezeiψ + ˜E∗
z e−iψ al-
lows one to write down the Vlasov equation, Eq.
(5),
linearized in ˜f1:

∂ ˜f1
∂z

+ i

ωmP
cγ2
z E0

˜f1 − e ˜Ez

= 0 .

∂f0
∂P

(8)

Eq. (8) is far from being the ﬁnal form of the evolution
equation, since we still have to couple it with Maxwell
equations, which constitute the electrodynamical part of
the problem. However an integral representation of ˜f1
can be given at this stage:

˜f1 = ˜f1|z=0

e

− iωmP z
cγ2

z E0 +en0

dz′ ˜Eze

i ωmP
cγ2
z E0

(z′−z)

. (9)

dF
dP

z

0

Z

Let us now introduce the longitudinal current density
1 e−iψ, where j0(r⊥) ≃
jz(z; r⊥) = −j0(r⊥) + ˜j1eiψ + ˜j∗
−∞ dP ˜f1. Eq. (9) can be inte-
ecn0(r⊥) and ˜j1 ≃ −ec
grated in P thus giving
R

∞

4

∞

˜j1 = −ec

dP

a1dF + a1e

−∞
z

Z
−ej0

dz′

(cid:18)
˜Ez

∞

dP

0
Z

(cid:20)

−∞

Z

dF
dP
dF
dP

eiψ0

(cid:19)
i ωmP
cγ2
z E0

e

−i ωmP z
cγ2
z E0

e

(z′−z)

. (10)

(cid:21)

The next step is to present the equation for the electric
ﬁeld ˜Ez which, coupled with Eq. (10), will describe the
system evolution in a self-consistent way.

We start with the inhomogeneous Maxwell equation

for the z-component of the electric ﬁeld

∇2Ez −

1
c2

∂2Ez
∂t2 = 4π

∂ρe
∂z

+

4π
c2

∂jz
∂t

,

(11)

where ρe is the electron charge density. Remembering the
deﬁnition of complex quantities ˜Ez and ˜j1 and accounting
for the fact that ρe ≃ jz/vz one can rewrite Eq. (11) as

∇2
⊥

˜Ezeiψ
(cid:16)

∂2 ˜Ezeiψ

∂z2 −
∂˜j1eiψ
+
∂z

1
c2
4π
c2

∂2 ˜Ezeiψ
∂t2
∂˜j1eiψ
∂t

+

(cid:17)
=

4π
vz

, (12)

where ∇2
⊥ is the Laplacian operator over transverse coor-
dinates. Explicit calculations of partial derivatives with
respect to t and z give

∂2 ˜Ezeiψ

∂z2 =

∂2 ˜Ez
∂z2 + 2i

ωm
vz

∂ ˜Ez
∂z

 

−

ω2
m
v2
z

˜Ez

!

eiψ ,

(13)

∂2 ˜Ezeiψ

∂t2 = −ω2

m

˜Ezeiψ ,

∂˜j1eiψ
∂z

=

∂˜j1
∂z

eiψ + i

˜j1eiψ ,

ωm
vz

∂˜j1eiψ
∂t

= −iωm˜j1eiψ .

(14)

(15)

(16)

Substitution back into Eq. (12) yields (vz ≃ c):

∇2
⊥

˜Ez +

∂2 ˜Ez
∂z2 + 2i
4π
vz

=

ωm
vz
∂˜j1
∂z

∂ ˜Ez
∂z

+

−

˜Ez
ω2
m
z c2
γ2
4πiωm
˜j1 . (17)
z c2
γ2

It is reasonable to assume that the envelope of ﬁelds and
currents vary slowly enough over the z coordinate, in
order to neglect ﬁrst and second derivatives with respect

to z in Eq. (17). Mathematically, this corresponds to the
requirements

guided by Eq. (21) to introduce the transverse size pa-
rameter

≪

km
2γ2
z

,

˜Ez
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

≪

k2
m
γ2
z

˜Ez

∂ ˜Ez
∂z (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
∂2 ˜Ez
∂z2 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂˜j1
∂z

≪

km
γ2
z

˜j1

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

,

and

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)
where we introduced the wave number km = 2π/λm. We
note that 2γ2
z λm is, roughly, the ﬁeld formation length:
by imposing conditions (18), (19) and (20) we are requir-
ing that the characteristic lengths of variation for current,
ﬁeld and its derivative are much longer than the ﬁeld for-
mation length (actually condition (19) over the variation
of the ﬁeld derivative already included in condition (18),
since γ2
z ≫ 1): this simply means that we can neglect
retardation eﬀects or, in other words, that the ﬁelds are
known at a certain time, when the charge distribution are
known at the same time. This assumption is not a re-
striction and it is veriﬁed in all cases of practical interest.
Then Eq. (17) is simpliﬁed to

(18)

(19)

(20)

q = kmr0/γz .

(23)

Eq. (21) can now be written in its ﬁnal dimensionless
form:

ˆ∇2
⊥

ˆEz − q2 ˆEz = iq2ˆj1 ,

(24)

where ˆ∇2
malized transverse coordinates.

⊥ is the Laplacian operator with respect to nor-

By analyzing Eq. (10) and using the normalized quan-
tities deﬁned above we recover a dimensionless variable
ˆz = ΛP z, where ΛP is given by

ΛP =

4I/(IAr2

0γγ2
z )

1/2

,

(25)

(cid:3)
IA = mc3/e being the Alfven current.

(cid:2)

Using Eq.

(25) and looking now at the exponential
factors in Eq. (10) it is straightforward to introduce the
dimensionless energy deviation ˆP = P/(ρE0), ρ being
deﬁned by

∇2
⊥

˜Ez −

˜Ez
ω2
m
z c2 =
γ2
which forms, together with Eq.
description for our system.

4πiωm
z c2
γ2

˜j1 ,

(21)

(10), a self-consistent

From the deﬁnition of ˆP it follows immediately that the
factor ρE0 is a natural measure for energy deviations.
The rms energy spread h(∆E)2i can be measured by the
dimensionless parameter

ρ =

Λpγ2
z
km

.

ˆΛ2

T =

h(∆E)2i
ρ2E 2
0

.

5

(26)

(27)

Similarity techniques can be now used in order to ob-
tain a dimensionless version of Eq. (10) and Eq. (21).
First note that the dependence of j0 on the transverse
coordinates can be expressed, in all generality, as

j0 = I0S0(r⊥/r0)

S0(r⊥/r0)dr⊥

,

(22)

(cid:20)Z

−1

(cid:21)

where I0 is the beam current, r0 the transverse pro-
the typical transverse size of the
ﬁle parameter (i.e.
beam), S0 the transverse proﬁle function of the beam and
the integral in dr⊥ is calculated over all the transverse
plane. Furthermore it is understood that the normaliza-
tion of S0 is chosen is such a way that S0(0) = 1.
It
is then customary to introduce the current density pa-
so that we can de-
rameter J0 = I0
ﬁne quite naturally the dimensionless current densities
ˆj0 = j0/J0 ≡ S0(r⊥/r0) and ˆj1 = ˜j1/J0.
It follows
from Eq. (21) that the electric ﬁeld should be normal-
ized to E0 = 4πJ0/ωm, which suggests the deﬁnition
ˆEz = ˜Ez/E0. For the normalization of the transverse
coordinates we use ˆr = r⊥/r0 so that one is naturally

S(r⊥/r0)dr⊥

(cid:2)R

−1

(cid:3)

The local energy spread distribution F (P ) was de-
ﬁned as normalized to unity, so that it is customary to
introduce ˆF ( ˆP ) as the distribution function in the re-
duced momentum ˆP also normalized to unity. For ex-
ample, when the energy spread is a gaussian we have
ˆF ( ˆP ) = (2π ˆΛ2
T ≪ 1 our
beam can be considered cold meaning that ˆF ( ˆP ) ≃ δ( ˆP ).
However note that, in order to specify quantitatively the
range of validity of the cold beam assumption with re-
spect to the values of ˆΛ2
T , one should ﬁrst solve the more
generic evolution problem for a non-cold beam and then
study the limit for small values of ˆΛ2
T .

T )−1/2e− ˆP 2/(2 ˆΛ2

T ). When ˆΛ2

Now Eq. (10) can be expressed in the ﬁnal, dimension-

less form:

∞

ˆj1 =

d ˆP

ˆa1d ˆF + ˆa1e

−∞

Z

 

d ˆF
d ˆP !

e−i ˆP ˆz

6

ˆz

∞

−S0

dˆz′

ˆEz

0

Z

"

−∞

Z

d ˆF
d ˆP

d ˆP

ei ˆP (ˆz′−ˆz)

, (28)

#

where ˆa1d = −eca1d/J0 and ˆa1e = −eceiψ0a1e/(J0ρE0).
One can combine Eq.
(24) in order to
obtain a single integrodiﬀerential equation for ˆEz or, al-
ternatively, an integral equation for ˆj1.

(28) and Eq.

As regards the description of the evolution in terms of
(24) yields

(28) in Eq.

ˆEz, direct substitution of Eq.
immediately

In the case of a cold beam ˆF ( ˆP ) = δ( ˆP ) and Eq. (32)
transforms to

ˆEz = −i (ˆa1d + iˆa1e ˆz) + S0

dˆz′ (ˆz′ − ˆz) ˆEz .

(33)

ˆz

0
Z

Finally, after double diﬀerentiation with respect to ˆz
we get back the well-known pendulum equation for one-
dimensional systems:

ˆ∇2
⊥

ˆEz − q2 ˆEz = iq2

d ˆP

ˆa1d ˆF + ˆa1e

∞

−∞

Z
ˆz

dˆz′

 

∞

ˆEz
"

−∞

Z

d ˆF
d ˆP !

e−i ˆP ˆz

d ˆP

ei ˆP (ˆz′−ˆz)

.

d ˆF
d ˆP

−iq2S0

0
Z

#

(29)

On the other hand, the description of our system in terms
of ˆj1 can be obtained ﬁrst by solving Eq. (24) and then
substituting the solution in Eq. (10). For the solution of
Eq. (24) we can use the following result (see for example
[9]):

ˆEz = −

dˆr(s)
⊥

ˆj1K0

iq2
2π

Z

q | ˆr⊥ − ˆr(s)
⊥ |
(cid:17)

(cid:16)

,

(30)

where K0 indicates the modiﬁed Bessel function of the
second kind. Then, substitution in Eq. (28) yields

ˆj1 =

d ˆP

ˆa1d ˆF + ˆa1e

∞

−∞

ˆz

Z
dˆz′

0
Z

(cid:20)Z

+

iq2
2π

S0

e−i ˆP ˆz

d ˆF
d ˆP !
q | ˆr⊥ − ˆr(s)
⊥ |
(cid:17)
. (31)

ei ˆP (ˆz′−ˆz)

#

 
dˆr(s)
⊥

ˆj1K0

∞

(cid:16)
d ˆF
d ˆP
d ˆP

×

−∞

Z

Note that the description of the system in terms of ﬁelds
or currents is completely equivalent. Using one or the
other is only a matter of convenience; it will turn out
in the following Sections that the description in terms
of the ﬁelds is particularly suitable for analytical ma-
nipulations, while the description in terms of currents is
advisable in case of a numerical approach.

It is interesting to explore the asymptote of Eq. (29)
for q → ∞. In this case one obtains the following simpli-
ﬁed equation for the ﬁeld evolution:

ˆEz = −i

d ˆP

ˆa1d ˆF + ˆa1e

∞

−∞

Z
ˆz

dˆz′

d ˆF
d ˆP !

e−i ˆP ˆz

 

∞

ˆEz
"

−∞

Z

d ˆF
d ˆP

d ˆP

ei ˆP (ˆz′−ˆz)

. (32)

#

+iS0

0
Z

(34)

∂2 ˆEz
∂ ˆz2 + S0 ˆEz = 0 .
In this approximation, and in the particular case S0 =
1, we recover the one-dimensional plasma wave number
Λp, which agrees with the normalization ˆz = Λpz.
It
should be noted that such a normalization is natural in
the limit q → ∞ but it progressively loses its physical
meaning as q becomes smaller and smaller: of course,
using our dimensionless equations for q ≪ 1 will still
yield correct results, because the equations are correct,
but the normalization ﬁts no more the physical feature
of the system, in that case.

Eq. (32), which describes the system evolution in the
limit q → ∞, corresponds to the the one-dimensional
case. We can use Eq. (32) and impose ˆz = 0 thus getting
the electromagnetic ﬁeld at the beginning of the evolu-
tion, i.e. the solution of the electromagnetic problem in
the limit q → ∞:

This can be easily written in dimensional form as

ˆEz = −iˆj1| ˆz=0 .

Ez =

4i
kmr2

−

I1
c

0 (cid:18)

(cid:19)

,

(35)

(36)

where j1 ≃ I1/(πr2

0).

We can check Eq. (36) with already known results in
scientiﬁc literature.
In fact, the ﬁeld generated by an
electron beam modulated in density in free space can be
easily calculated in the system rest frame (see e.g.
[1]
and [10]). In the limit of a pancake beam (i.e. for large
transverse dimension) the following impedance per unit
length of drift has been found:

Z =

4i
kmr2
0

.

(37)

The ﬁrst factor on the right hand side of Eq. (36), which
is the impedance per unit drift according to our calcula-
tions, is exactly the result in Eq. (37) which proves that
our starting equation Eq. (29) can be used to solve cor-
rectly the electromagnetic problem in the case q → ∞,
as it must be.

Finally, before proceeding, it is worth to estimate the
value of our parameters for some practical example and
to see how our assumptions compare with an interest-
ing case. Nowadays photo-injected LINACs, to be used
as linear colliders or FEL injectors constitute cutting
edge technology as regards electron particle accelera-
tors. Currents of about 3 kA with energy such that
γ ∼ 103 can be achieved together with quite a small
energy spread h(∆E)2i1/2 ∼ 100 keV, radial dimensions
of order r0 ∼ 100 µm and a normalized emittance ǫn ∼ 1
mm mrad.
In these conditions, a typical modulation
wavelength of about 1 µm will lead to a value of q ∼ 1,
which is well outside the region of applicability of the
one-dimensional theory so that a generalized theory like
the ours must be used.
It is interesting to note that,
by means of the deﬁnitions of q and Λp, we can write
ρ = [I/(γIA)]1/2q−1: this suggests that a natural mea-
sure for the current is indeed γIA which is, in practice,
the Alfven-Lawson current (see [11], [12], [13]). In our
numerical example q ∼ 1 and the value of ρ is actually
determined by the ratio I/(γIA) ∼ 2 · 10−4. As a result
ρ ∼ 10−2: this means that our simpliﬁed Maxwell equa-
tion, Eq. (21), is valid up to an accuracy of 10−2. More-
over, in this case, ˆΛ2
T ∼ 10−4 so that the cold beam case
turns out to be of great practical interest. Finally ǫn ∼ 1
mm mrad. This corresponds, for γ ∼ 103, to a betatron
function βf ∼ γr2
0/ǫn ∼ 10 m. Our choice of consider-
ing the longitudinal motion alone is satisﬁed when the
period of a plasma oscillation is much shorter than the
period of a betatron oscillation, that is when Λpβf ≫ 1.
It should be noted, though, that this estimation cannot
have a rigorous mathematical background before a more
comprehensive theory, including the eﬀects of transverse
dynamics, is developed: only then our present theory can
be reduced to an asymptote of a more general situation,
and conditions for its applicability can be derived in a
rigorous way. Keeping this fact in mind, in our example
Λp ∼ 3 · 10−1m−1 which means Λpβf ∼ 3 signifying that
this particular case is at the boundary of the region of
applicability of our theory.

III. MAIN RESULT

Given Eq. (29) with appropriate initial conditions for
ˆj1|ˆz=0
it is possible to ﬁnd an analytical solution to the
evolution problem. The method is similar to the one
used for the solution of the self-consistent problem in
FEL theory (see [14]) and relies on the introduction of
the Laplace transform of ˆEz, namely:

following ordinary diﬀerential equation:

⊥ − q2(1 − i ˆDS0)
i

ˆ∇2
h
where

¯E = iq2

ˆD0ˆa1d + ˆDˆa1e
(cid:16)

(cid:17)

,

(39)

and

ˆD0 =

∞

d ˆP

ˆF
p + i ˆP

,

−∞

Z

ˆD =

∞

d ˆP

d ˆF /d ˆP
p + i ˆP

−∞

Z

with the boundary conditions ¯E −→ 0 for |ˆr⊥| −→ ∞
and ∂ ¯E/∂ˆr⊥ −→ 0 for |ˆr⊥| −→ ∞. We can rewrite Eq.
(39) as

L ¯E = f ,

having introduced

L = ˆ∇2

⊥ + ˆg(ˆr⊥, p) ,

f (ˆr⊥, p) = iq2

ˆD0ˆa1d + ˆDˆa1e
(cid:16)

(cid:17)

and

7

(40)

(41)

(42)

(43)

(44)

ˆg(ˆr⊥, p) = −q2(1 − i ˆDS0) .

(45)

Eq.

Note that only Eq. (29) can beneﬁt from the use of the
Laplace transform but not the integral equation Eq. (31).
(42) is a nonhomogeneous, linear, second-order
diﬀerential equation. We are interested in solving Eq.
(42) for any given p such that Re(p) > 0. Solution is
found if we can ﬁnd the inverse of the operator L, namely
a Green function ¯G obeying the given boundary condi-
tions; in this case we simply have

¯E =

dˆr′
⊥

¯G(ˆr⊥, ˆr′

⊥)f (ˆr′

⊥) .

(46)

Z

A. Generic approach

¯E(p, ˆr⊥) =

dˆze−pˆz ˆEz ,

(38)

∞

0
Z

with Re(p) > 0. The advantage of the Laplace transform
technique is that the evolution equation is transformed
from the integrodiﬀerential equation Eq. (29) into the

Depending on the choice of ˆg, i.e. on the choice of S0,
ˆF and p, the diﬀerential operator L can change its char-
acter completely making L more or less diﬃcult to deal
with. For example, the case of a self-adjoint operator is
obviously a simple situation, since its eigenvalues are real
and its eigenfunctions form a complete and orthonormal

8

set for the space of squared-integrable functions L2 (de-
ﬁned over the entire transverse plane through ˆr⊥) with
respect to the internal product:

formulate the applicability region of this method in terms
of properties of S0 and ˆF as it would be desirable.

With this in mind one can use the fact that ¯G ≡ L−1

and write

< h | g >=

dˆr⊥gh∗ .

(47)

Z
Then, such a orthonormal set can be used to provide,
quite naturally, an expansion for ¯G.

However, in the most general situation, L is not self-
adjoint: to see this, it is suﬃcient to note that ˆg is not
real. As a result, the eigenvalues of L are not real, its
eigenfunctions are not orthogonal with respect to the in-
ternal product in Eq. (47), we do not know wether the
spectrum of L is discrete, completeness is not granted and
we cannot prove the existence of a set of eigenfunctions
either.

To the best of our knowledge there is no theoretical
mean to really deal with our problem in full generality.
When not self-adjoint operators are encountered in diﬀer-
ent branches of Physics (see, for example, [18] and [19])
mathematical rigorousness is somehow relaxed assuming,
rather than proving, certain properties of the operator.
We will do the same here assuming, to begin, the exis-
tence of eigenfunction sets; then, as for example has been
remarked in [18] and [19] one can consider, together with
the spectrum of L deﬁned by the eigenvalue problem:

also the spectrum of its adjoint, deﬁned by

LΨj = ΛjΨj

L∗Ψ∗

j = [Λj]∗Ψ∗
j .

(48)

(49)

It can be shown by using the bi-orthogonality theorem
[20] that

< Ψ∗

j |Ψi >=

dˆr⊥ΨjΨi = δji .

(50)

Z

In other words the sequence {Ψj}j admits {Ψ∗
j }j as a
bi-orthonormal sequence. Then one has to assume com-
pleteness and discreteness of the spectrum so that the
following expansion is correct:

¯G =

| ¯GΨj >< Ψ∗

j | ,

(51)

j
X

We ascribe to alternative theoretical approaches and nu-
merical techniques the assessment of the validity region
of this assumption, which should be ultimately formu-
lated in terms of a restriction on the possible choices of
S0 and ˆF . In other words we give here a general method
for solving our problem which is valid only under the ful-
ﬁllment of certain assumptions, but we make clear that
it is not possible, to the best of our knowledge, to strictly

¯G(ˆr⊥, ˆr′

⊥) =

Ψj(ˆr⊥)Ψj(ˆr′
Λj

⊥)

.

(52)

j
X
Finally, substituting Eq. (52) in Eq. (46) one gets

¯E =

Ψj(ˆr⊥)
Λj

Z

j
X

dˆr′

⊥Ψj(ˆr′

⊥)f (ˆr′

⊥) .

(53)

To ﬁnd ˆEz we use the inverse Laplace transformation
that is the Fourier-Mellin integral:

ˆEz(ˆz, ˆr⊥) =

dp ¯E(p, ˆr⊥)epˆz ,

(54)

1
2πi

α+i∞

α−i∞

Z

where the integration path in the complex p-plane is par-
allel to the imaginary axis and the real constant α is pos-
itive and larger than all the real parts of the singularities
of ¯E.

The application of the Fourier-Mellin formula comes
with another, separate mathematical problem related
with the ability of performing the integral in Eq. (54).
One method to calculate the integral is to use numerical
techniques and integrate directly over the path deﬁned,
on the complex p-plane, by Re(p) = α.

Yet, there is some room for application of analytical
techniques left. In fact, under the hypothesis that ¯E is
also deﬁned, except for isolated singularities, as an ana-
lytical function on the left half complex p-plane and on
the imaginary axis and under the hypotesis that ¯E → 0
uniformly faster than 1/|p|k for a chosen k > 0 and for
Arg(p) within [π/2, 3π/2] one could use Jordan lemma
and close the integration contour of Eq. (54) by a semi-
circle at inﬁnity on the left half complex p-plane. An
obvious (and well-known) problem is that ¯E is deﬁned
only for Re(p) > 0 according to Eq. (38). Yet, if the
border points at Re(p) = 0 are regular points of ¯E (ex-
cept for isolated singularities) then one can consider the
(unique) analytical continuation of ¯E along the border,
from the original domain of analyticity (i.e. the points
p with Re(p) > 0 except for isolated singularities) to
the entire complex plane (again, isolated singularity ex-
cluded). Then one can still apply Jordan lemma on the
analytic continuation of ¯E (provided that it obeys the
other assumption), because the ﬁnal result is the inte-
gral in Eq. (54) which is uniquely deﬁned by the original
function ¯E for Re(p) > 0.

The problem is trivially solved for the case of a cold
beam because ˆF = δ( ˆP ) so that ˆD0 = 1/p and ˆD =
−i/p2. Then Eq. (53) deﬁnes indeed an analytic function
in all points of the complex plane with the exception
of p = 0 and the points such that Λj(p) = 0. All the

+ π ˆF ′(ip)

Re(p) = 0 , (56)

ˆEz(ˆz, ˆr⊥) =

Φj(ˆr⊥)eλj ˆz

hypothesis of Jordan lemma are veriﬁed and the method
can be applied without any problem.

The situation is completely diﬀerent in the case of a
generic energy spread function ˆF .
In fact by inspec-
tion of Eq. (40) and Eq. (41) one is immediately con-
fronted with the fact that the integrands in ˆD0 and ˆD
are, usually, singular at all the points of the imaginary
axis Re(p) = 0 since the integration in ˆP is taken from
−∞ to +∞. As a result the points Re(p) = 0 are not reg-
ular points of ¯E and ¯E cannot be analytically continued
through the border Re(p) = 0.

This problem is the same encountered in the treatment
of Landau damping (see [21]). Of course one may follow
the solution proposed by Landau and present particular
deﬁnitions of ˆD0 and ˆD at Re(p) = 0 that are

+ π ˆF (ip)

Re(p) = 0 (55)

ˆD0 = (P )

∞

d ˆP

ˆF
p + i ˆP

−∞

Z

and

ˆD = (P )

∞

d ˆP

d ˆF /d ˆP
p + i ˆP

−∞

Z

so that D0 and D are now regular for Re(p) = 0 and can
be (uniquely) continued at Re(p) < 0 by

+ 2π ˆF (ip)

Re(p) < 0

(57)

ˆD0 =

∞

d ˆP

ˆF
p + i ˆP

−∞

Z

and

ˆD =

∞

d ˆP

d ˆF /d ˆP
p + i ˆP

−∞

Z

+ 2π ˆF ′(ip)

Re(p) < 0 .

(58)

In this way the deﬁnition of ¯E could be extended, ex-
cept for isolated singularities, to an analytical function
on the entire complex p-plane and, if ˆF ( ˆP ) behaves rela-
tively well, Jordan lemma can be applied without further
problems.

Yet, we think that the application of Landau’s pre-
scription, i.e. the deﬁnition in Eq. (55) and Eq. (56)
should be taken with extreme caution. As it is reviewed
by Klimontovich [15] and references therein, Landau’s
method is equivalent to the introduction of additional as-
sumptions on the system, namely the adiabatic switching
on of the space-charge ﬁeld at t = −∞.

Another method equivalent to Landau’s consists, as
has been remarked long ago by Lifshitz [17], in the in-
troduction of a small dissipative term into the linearized
Vlasov equation which ceases to be non-dissipative from
the very beginning. The Vlasov equation is then solved
by Fourier technique and the limit for a vanishing dissi-
pating term is taken in the ﬁnal result, which leads, in
the end, to Landau’s result. Yet, the limit for a vanishing
dissipation must be taken in the ﬁnal formulas in order to
recover Landau’s coeﬃcient and not before. This means

9

that Landau’s method consists in the introduction of ad-
ditional assumptions regarding the system under study
or equivalently, in changing the very nature of the equa-
tions describing our system (from non-dissipative to dis-
sipative): therefore in practical calculations, we prefer to
deal only with the case of a cold beam where the orig-
inal non-dissipative nature of the system is maintained
without problems, leaving the other case to future study.
Such a viewpoint constitutes a restriction but as we have
seen in the previous Section the cold beam case is prac-
tically quite an important issue: in this Section, we will
present our results in full generality without ﬁxing ˆF but
keeping in mind, however, all the warnings discussed be-
fore.

In any case and again, in all generality, we can say
that wether or not the conditions of Jordan lemma are
satisﬁed depends on the distribution ˆF ( ˆP ). In the case
Jordan lemma is applicable one can ﬁnd a closed, analytic
expression for ˆEz:

−1

dΛj(p)
dp

∞

"(cid:18)
dˆr′
⊥Φn(ˆr′

(cid:19)p=λj #

⊥)f (ˆr′

⊥, λj) , (59)

j
X

×

0
Z

where Φj(ˆr⊥) = Ψj(ˆr⊥, p = λj ) and λj are solutions of
the equations:

Λj(p) = 0

(60)

(48) as Λj =
or, which is the same, solution of Eq.
0: from this viewpoint the functions Φnj constitute the
kernel of the operator L and λj are the values of p such
that L admits a non-empty kernel.

It is interesting to note that {Φj}j is a subset of {Ψj}j,p
naturally suited to expand any function of physical in-
terest (the ﬁeld ˆEz). In this sense, one may say that the
ﬁelds are subjected to constraints given by Maxwell equa-
tions, which are codiﬁed through the operator L; these
constraints are implicitly used during the anti-Laplace
transform process, thus selecting only those {Ψj}j,p of
physical interest. In this spirit, although p is mathemat-
ically allowed to span over all the complex plane with
Re(p) > 0, only the particular values for which p = λj
have physical meaning in the ﬁnal result.

An explicit expression for (dΛj(p)/dp)p=λj can be

found. Using Eq. (50) and Eq. (48) we can write

Λj =

dˆr⊥ΨjLΨj .

(61)

Z

Then, diﬀerentiating Eq. (61) we have

dΛj
dp

=

dˆr⊥

∂g
∂p

Ψ2
j

Z

(62)

Our ﬁnal result is therefore written as follows:

which may be rewritten using Eq. (66) as:

ˆEz(ˆz, ˆr⊥) =

ujΦj(ˆr⊥)eλj ˆz ,

(63)

where the coupling factor uj is given by

j
X

uj =

dˆr′

⊥Φj(ˆr′
dˆr′
⊥

⊥)f (ˆr′
⊥, λj)
Ψ2
j

∂g
∂p

R

.

(64)

p=λj
i

(cid:17)

hR

(cid:16)
Eq. (63) describes the evolution of the system under the
action of self-ﬁelds in a generic way, for any bunch trans-
verse shape S0, for any choice of local energy spread ˆP
and any initial condition (under the assumptions men-
tioned before). Our solution is indeed an analysis in
(self-reproducing) propagating eigenmodes of the electric
ﬁeld.

We have seen that, due to the fact that L is in general
not self-adjoint, the modes Ψj are not orthogonal in the
sense of Eq. (47) nor, as a consequence, Φj are. More-
over, even if Ψj were orthogonal, Φj are chosen among
the Ψj at diﬀerent values of p so that orthogonality of
It is
Φj with respect to Eq. (47) is also not granted.
possible, however, to formulate appropriate initial condi-
tions to obtain a single propagating mode as a solution
of our self-consistent problem. This demonstrates that
single modes have physical meaning besides being math-
ematical tools for function decompositions.

Suppose, for example, that we wish to excite a single
mode at ﬁxed values of j. On the one hand Eq. (63) is
simpliﬁed to

and, diﬀerentiating with respect to z, one also obtains

ˆEz = ujΦj eλj ˆz

∂ ˆEz
∂ ˆz

= λj ˆEz .

(65)

(66)

and

10

(70)

(71)

Finally, if ˆa1e 6= 0, comparison of Eq. (70) and Eq. (67)
gives:

O ˆEz|ˆz=0

= −

ˆa1e .

q2
λj

ˆa1e
ˆa1d

= −iλj .

Since for plasma oscillations λj has to be imaginary, Eq.
(71) ﬁxes the phase ψ0 = lπ (with l integer number).
The actual shape of ˆa1d (and ˆa1e) is obtained, modulus
(65),
a multiplicative constant, by substitution of Eq.
calculated at ˆz = 0, in Eq. (67) and it is ﬁxed by the
following condition:

ˆa1d = O(Φj) .

(72)

We will now present some remarkable example of how
to apply Eq. (63) and explore, in particular cases, the
applicability region of our method.

We will start our exploration discussing the situation
of an axis-symmetric beam which is still quite a generic
one. Given the symmetry of the problem we will make
use, from now on, of a cylindrical (normalized) coordinate
system (ˆr, φ, ˆz), with obvious meaning of symbols.

Since ˆj1 = ˆj1(ˆr, ˆz, φ), ˆEz = ˆEz(ˆr, ˆz, φ) and f =
it is convenient to decompose them in az-

f (ˆr, p, φ),
imuthal harmonics according to

ˆj1(ˆz; ˆr, φ) =

ˆj(n)
1

(z, ˆr)e−inφ ,

(73)

ˆEz(ˆz; ˆr, φ) =

ˆE(n)
z

(ˆz; ˆr)e−inφ

(74)

∞

n=−∞
X

∞

n=−∞
X

∞

n=−∞
X

On the other hand, the evolution equation, Eq. (29) at
ˆz = 0 reads:

f (ˆr, p, φ) =

f (n)(ˆr, p)e−inφ .

(75)

O ˆEz|ˆz=0

= iq2ˆa1d ,

(67)

Moreover, in cylindrical coordinates we have

where we introduced

O = ˆ∇2

⊥ − q2 .

(68)

The same Eq. (29) diﬀerentiated with respect to ˆz and
evaluated at ˆz = 0 gives

ˆ∇2

⊥ =

1
ˆr

∂
∂ˆr

ˆr

∂
∂ˆr

(cid:20)

(cid:21)

+

1
r2

∂2
∂φ2 .

(76)

These deﬁnitions allow us to write our equations and
results for the n-th azimuthal harmonic of the electric
ﬁeld.
In this situation the operators L and O can be
written as

∂ ˆEz
∂ ˆz !| ˆz=0

O

 

= −q2ˆa1e ,

(69)

L =

∂2
∂ˆr2 +

1
ˆr

∂
∂ˆr

−

n2
ˆr2 + ˆg(ˆr, p) ,

(77)

(78)

(79)

where, now, S0 = S0(ˆr) in the deﬁnition of ˆg and

O =

∂2
∂ˆr2 +

1
ˆr

∂
∂ˆr

−

q2 +

(cid:18)

n2
ˆr2

(cid:19)

so that

L ¯E(n) = f (n) ,

Having specialized our results to the axis-symmetric case
it is worth to spend some words on the nature of the oper-
ator L in one particular case. As we have said at the be-
ginning of this section, the case of a self-adjoint operator
is a particularly blessed one. It is interesting to note that
in the axis-symmetric case, when S0, ˆF and p are such
that ˆg is real, we deal with a singular Sturm-Liouville
problem as it is shown immediately by multiplying side
by side by ˆr Eq.
In fact, in this case L can be
written in the usual form presented in Sturm-Liouville
theory:

(79).

L =

∂
∂ˆr

ˆr

∂
∂ˆr

(cid:20)

(cid:21)

n2
ˆr

−

+ ˆrˆg(ˆr, p) .

(80)

In this case given the internal (axisisymmetric) product
in L2:

∞

0

< h | g >=

dˆrˆrgh∗ ,

(81)

Z
self-adjointness condition for L is satisﬁed in the interval
[0, ∞) by all the functions in the linear space S which
we deﬁne as the space of integrable-square functions not
singular with their ﬁrst derivatives at ˆr = 0 and such
that, for any f, g chosen in S the following condition is
satisﬁed:

ˆr [g∗(ˆr)f ′(ˆr) − f (ˆr)g′∗(ˆr)] = 0 .

(82)

lim
ˆr→∞

Note that S is a subset of L2.

This is of course a very particular situation, interesting
to discuss but unfortunately not very useful in practise,
since in order to solve our problem we still have to as-
sume that Eq.
(51) is correct for a generic p. When
this assumption is made, in the axis-symmetric case our
results Eq. (63) and Eq. (64) take the form

ˆE(n)
z

(ˆz, ˆr) =

unjΦnj(ˆr)eλ(n)

j ˆz ,

(83)

where

j
X

unj(ˆr) =

.

(84)

∞

0 dˆr′ ˆr′Φnjf (n)(ˆr′, λ(n)
R
hR

∞
0 dˆr′ ˆr′

Ψ2
nj

∂g
∂p

(cid:16)

(cid:17)

j

p=λ(n)
j
i

)

11

Within this special situation we will now treat in de-
tail the case of a stepped or parabolic transverse proﬁle.
Further on we will see how the solution for the stepped
transverse proﬁle can be used to obtain a semi-analytic
solution for any transverse proﬁle.

B. Stepped proﬁle

Consider the case of a step function S0 = 1 for ˆr < 1
In this case ˆg(ˆr, p) inside the

and S0 = 0 for ˆr ≥ 1.
operator L is simply given by

ˆg(ˆr, p) =

1 + 1
p2

−q2
−q2

(cid:16)

(

(cid:17)

ˆr < 1
ˆr ≥ 1

,

(85)

Let us restrict to the assumption of a cold beam with
F ( ˆP ) = δ( ˆP ). Then ˆD = i/p2.

First we look for the solutions of Eq. (48) with the
boundary condition that ψnj and their ﬁrst derivatives
vanish at inﬁnity. The search for the eigenfunctions can
be broken down into an internal (ˆr < 1) and an exter-
nal (ˆr > 1) problem, with the conditions of continuity for
ψnj and its derivative across the boundary, since the ﬁnal
result, the electric ﬁeld, is endowed with these properties
too. We recognize immediately that the internal and the
external problems are, respectively, the complex Bessel
and modiﬁed Bessel equations with appropriate bound-
ary conditions.

Keeping in mind the physical nature of our problem,
we impose that ψnj must be regular functions of ˆr over
[0, ∞). Then, without loss of generality, we can exclude
Bessel functions Yn and In from entering our expression
for ψnj.

Since for the ﬁeld calculations we are interested in ﬁnd-
) we can

ing the eigenfunctions φnj = ψnj(ˆr, p = λ(n)
impose Λ(n)

j = 0, thus obtaining

j

φnj(ˆr) =

C1Jn(αj ˆr)
C2Kn(qˆr)

(cid:26)

ˆr < 1
ˆr ≥ 1

,

(86)

where αj ≡

ˆg(ˆr, p)|

p=λ

,ˆr<1

(n)
j

and λ(n)

j

are roots of

Λ(n)
Im-
(p) = 0, to be still determined at this stage.
j
posing continuity of ψnj and its derivative at ˆr = 1 one
ﬁnds

r

C2 = C1

Jn(αj)
Kn(q)

,

(87)

which leaves the choice of an unessential multiplicative
constant, and

αjJ ′

n(αj)Kn(q) − qK ′

n(q)Jn(αj) = 0 .

(88)

Eq. (88) can be rewritten with the help of recurrence
relations for Bessel functions in the following form:

Im(λ(n)

)
  j  

    

12

αjJn+1(αj )Kn(q) − qKn+1(q)Jn(αj ) = 0 .

(89)

j

j

j

Eq.
(89) is our eigenvalue equation, deﬁning the val-
ues of αj or, equivalently, of λ(n)
. Since q is real and
positive one must have that αjJn+1(αj )/Jn(αj) is real
it can be shown that αj must
and positive. Then,
be real. As a result λ(n)
are imaginary and such that
) < 1. For any given eigenvalue λ(n)
−1 < Im(λ(n)
−λ(n)
is solution of Eq. (89) corresponding to fast and
j
slow plasma waves: from now on we will consider, for sim-
plicity of notation, only the branch Im(λ(n)
) > 0. Note
that from a physical viewpoint, the condition that λ(n)
is
imaginary means that we are in the absence of damped
or ampliﬁed oscillations. On the other hand, the fact
that Im(λ(n)
) < 1 means that plasma oscillations have a
minimum wavelength given by 2π/Λp.

, also

j

j

j

j

j

j

1, Fig.

It is interesting to plot the behavior of Im(λ(n)

), pa-
rameterized for several values of n and j as a function
3 show the behav-
2 and Fig.
of q. Fig.
ior, as a function of q, of the ﬁrst ﬁve eigenvalues for
the ﬁrst three azimuthal harmonics. It should be noted
that Im(λ(n)
) increases with q and therefore with r0,
j
but Λp scales as r−1
0 ; as a result, the period of the self-
reproducing solution identiﬁed by ﬁxed values of n and j,
that is 2π/(ΛpIm(λ(n)
)), will increase as r0 is increased.
As it can be seen by inspection all the imaginary parts
of the eigenvalues converge to 1 as q → ∞; this can
also be derived directly from Eq.
(89). As q → ∞
we have Kn(q) ≃ Kn+1(q), so that Eq. (89) gives sim-
ply Jn(αj) = 0; this is possible only when αj = νn,j,
where νn,j is the j-th root of Jn. Then, in this limit,
λ(n)
n,j) and
→ −1 since
j
q → ∞. Note that convergence to unity tends to get
(cid:16)
slower as n and j increase. On the other hand, when q
becomes smaller and smaller the plasma wavelength as-
sociated with each mode starts to diﬀer signiﬁcantly from
Λp and, as noted before, we should use an eﬀective ˜Λp in
place of Λp in our dimensionless quantities in order for
these to retain their physical insight.

= −q2/(q2 + ν2

λ(n)
j

(cid:17)

(cid:16)

(cid:17)

2

2

The asymptotic behavior of Im(λ) for q ≪ 1 can be
derived directly from Eq. (89) too. We consider ﬁrst the
case n = 0. In the limit q ≪ 1 we have qK1(q)/K0(q) ∼
−(ln q − ln 2 + γE)−1, where γE is the Euler gamma con-
stant. We remember that xJ1(x)/J0 ∼ x2/2 for x2 ≪ 1

2

λ(n)
j
(cid:16)

and that

∼ −q2/(α2

j ). Neglecting − ln 2 + γE

2

(cid:17)
λ(0)
0
(cid:16)

∼ q2 ln q. This result is only valid
we easily ﬁnd
for q2/λ2 ≪ 1 which corresponds, once plotted in Fig.
1, to the solution for j = 0 only. The case j > 0 is
solved using the fact that −(ln q)−1 ≪ 1: then the eigen-
value equation is solved only when αj ∼ ν1,j which means

(cid:17)

 j = 0
 j = 1
 j = 2
 j = 3
 j = 4
 Asymptotes

1,0

0,8

0,6

0,4

0,2

0,0

0,01

0,1

10

1
n = 0

q

FIG. 1: The ﬁrst ﬁve (imaginary) eigenvalues λ(n)
of i as a function of q for n = 0.

j

in units

2

(cid:17)

∼ −q2/ν1,j for j > 0.

λ(0)
j
For n 6= 0 instead, when q ≪ 1 we have
(cid:16)
qK1(q)/K0(q) ∼ 2n. Then, since 2nJn(x) ∼ xJn−1(x) +
xJn+1(x), we ﬁnd Jn−1(αj) = 0 and,
therefore,
λ(0)
∼ −q2/νn−1,j. These asymptotic limits are com-
j
pared with the actual solutions of the eigenvalue equation
(cid:16)
in Fig. 1, Fig. 2 and Fig. 3.

(cid:17)

2

Note that in the region q ≪ 1, if the alternative nor-
malization using ˜Λp is selected, ρ shows only a weak log-
arithmic dependence on the transverse beam size q in
the case n = 0, j = 0 and no dependence on q in the
other cases. Looking at the slopes in the ﬁgures we can
conclude that, with the use of ˜Λp in place of Λp, ρ is,
for realistic choices of I, much smaller than unity. The
same applies when q → ∞: in this case ˜Λp ≃ Λp and ρ
will also be small with respect to unity. As a result ρ,
deﬁned using ˜Λp, can be considered much smaller than
unity in a wide range of parameters which justiﬁes, at
least in this particular situation, the assumptions used
in the derivation of Eq. (21).

We can now write our ﬁnal solution in the following

form:

ˆE(n)
z

(ˆz, ˆr) =

( P
P

j unjJn(αj ˆr)eλ(n)
j ˆz
j unj

Kn(q) Kn(qˆr)eλ(n)

Jn(αj )

j ˆz

ˆr < 1

ˆr ≥ 1

,

(90)

and the coupling factors unj are given by:

unj =

Jn(αj ) d

1

Kn(q)

0 dξJn(αjξ)ξf (n)(ξ)
dp [αJn+1(α)Kn(q) − qKn+1(q)Jn(α)]p=λ(n)
j
(91)

R

,

Im(λ(n)

)
  j  

    

 j =0
 j =1
 j =2
 j =3
 j =4
 Asymptotes

1,0

0,8

0,6

0,4

0,2

0,0

1,0

0,8

0,6

0,4

0,2

0,0

0,01

0,1

10

1
n = 1

FIG. 2: The ﬁrst ﬁve (imaginary) eigenvalues λ(n)
of i as a function of q for n = 1.

j

in units

Im(λ(n)

)
  j  

    

 j = 0
 j = 1
 j = 2
 j = 3
 j = 4
 Asymptotes

0,01

0,1

10

1
n = 2

FIG. 3: The ﬁrst ﬁve (imaginary) eigenvalues λ(n)
of i as a function of q for n = 2.

j

in units

where α ≡

g(ˆr, p)|ˆr<1.

p

At this point we should show that the expansion Eq.
(51) is correct, so that the method used up to now can
be rightfully applied. Yet we cannot do this. We assume
this fact, instead, and we prove that this assumption is
right both using numerical techniques in Section IV and
with the help of an alternative analytical technique here:
in fact, interestingly enough, one can solve Eq. (39) also
by ﬁnding directly a Green function without any partic-
ular expansion simply imposing that the Green function
obeys L ¯G(n) = 0 for all ˆr except ˆr = ˆr′, where it must be
continuous and such that its derivative is discontinuous
(the diﬀerence of the left and right limit must equal 1/ˆr).

q

q

13

Moreover it must be ﬁnite at ˆr = 0. We do not work out
details, which can be found in [9], but we underline the
fact that the anti-Laplace transform of ¯E(n) calculated
with this method coincides with our previous result Eq.
(90). Note that in the case the Green function is de-
rived without the expansion in Ψnj the ﬁnal solution for
ˆEz is automatically valid, but still subjected to the as-
sumptions on the validity of Jordan lemma; without the
introduction of other assumptions on the system under
study we can safely say that our result holds for the case
of a cold beam only.

C. Parabolic proﬁle

A parabolic transverse proﬁle corresponds to the case
S0(ˆr) = 1 − k2
1 ˆr2. This is one of the few proﬁles for which
the evolution problem can be solved analytically. The
study of this situation oﬀers, therefore, the possibility
of crosschecking analytical and numerical results with or
without the use of the semi-analytical method described
in Section III D.

In the parabolic case ˆg(ˆr, p) inside the operator L is

given by

ˆg(ˆr, p) =

1 + 1−k2
p2

1 ˆr2

−q2
−q2

(cid:16)

(

ˆr < 1
ˆr ≥ 1

(cid:17)

,

(92)

Here we assume, strictly, F ( ˆP ) = δ( ˆP ). Solution for the
homogeneous problem deﬁned by L can be found in [9],
since it is of relevance in FEL theory as well. We can use
that solution in order to solve our eigenvalue problem,
and to write the expressions for the eigenfunctions Ψnj
to be inserted in Eq. (63). Let us introduce the following
1 , d2 = Λ(n)
notations: µ2 = i ˆDq2 − Λ(n)
,
j
ǫ = (n + 1)/2 − µ2/(4δ). After some calculation we ﬁnd:

, δ2 = i ˆDK 2

j

Ψnj(ˆr) =

ˆrne−δˆr2/2
e−δ/2

1F1(ǫ, n + 1, δˆr2)
1F1(ǫ, n + 1, δ) Kn(dˆr)
Knd

(

ˆr < 1
ˆr ≥ 1

.

(93)
where 1F1 is the conﬂuent hypergeometric function, and
the eigenvalue equation analogous of Eq. (89) is now

δKn(d)

2ǫ(n + 1)−1

1F1(ǫ + 1, n + 2, δ)

− 1F1(ǫ, n + 1, δ)] + dKn+1(d) 1F1(ǫ, n + 1, δ) = 0 (94)

(cid:2)

Once more we should show that the expansion Eq. (51)
is correct. We assume this fact, and we present a cross-
check of our result Eq. (93) using numerical techniques
in Section IV.

D. Multilayer method approach

An arbitrary gradient axisymmetric proﬁle can be ap-
proximated by means of a given number of stepped pro-

ﬁles, or layers, superimposed one to the other. This
means that results in Section III B can be used to con-
struct an algorithm to deal with any proﬁle (see [9] or
[14] for more details and a comparison with the same
technique in FEL physics).

The normalized radius of the beam boundary is simply
unity; let us divide the region 0 < ˆr < 1 into K layers,
assuming that the beam current is constant within each
layer. Within each layer k, according to Eq. (29), the
solution for the eigenfunction is of the form

Φ(k)

n = ckJn(µk ˆr) + dkNn(µk ˆr) ,

(95)

where (k − 1)K < ˆr < k/K, ck and dk are constants, Jn
and Nn are the Bessel functions of ﬁrst and second kind
of order n, and

k = −q2(1 − i ˆDSk−1/2) .
µ2

(96)

Here Sk−1/2 = S0(ˆrk−1/2) and ˆrk−1/2 = (k − 1/2)/K. To
avoid singularity of the eigenfunction at ˆr = 0 we should
let d1 = 0. Then, the continuity conditions for the eigen-
functions and its derivative at the boundaries between
the layers allow one to ﬁnd all the other coeﬃcients. The
continuity conditions can be expressed in matrix form in
the following way:

14

(102)

The two relations above can be also written in matrix
form as:

ck
dk

TK

= b

,

(cid:18)

(cid:19)

(cid:18)

(cid:19)

1
1

where the coeﬃcient b can be expressed in terms of the
coeﬃcient c1 by multiple use of Eq. (97). Since c1 can
be chosen arbitrarily, we may set c1 = 1 to obtain the
following matrix equation:

TK × TK−1 × ... × T1

= T

= b

. (103)

1
0

1
0

1
1

(cid:18)

(cid:19)

(cid:18)

(cid:19)

(cid:18)

(cid:19)

The matrix T depends on the unknown quantity ˆΛ. The
other unknown quantity in Eq. (103), the coeﬃcient b,
can be easily excluded, thus giving the eigenvalue equa-
tion:

(T )11 = (T )21 ,

(104)

which allows one to ﬁnd the eigenvalue ˆΛ. Then using
Eq. (97) and Eq. (102) it is possible to calculate the
eigenfunction.

ck+1
dk+1

ck
dk

= Tk

, k = 1, 2, ..., K − 1 ,

(97)

(cid:18)

(cid:19)
where the coeﬃcients Tk are given by (ˆrk = k/K):

(cid:19)

(cid:18)

IV. APPLICATIONS AND
EXEMPLIFICATIONS

A. Algorithm for numerical solution

(Tk)11 = (π/2)ˆrk [µkJn+1(µk ˆrk)Nn(µk+1 ˆrk)
−µk+1Jn(µk ˆrk)Nn+1(µk+1 ˆrk)] ,
(Tk)12 = (π/2)ˆrk [µkNn+1(µk ˆrk)Nn(µk+1 ˆrk)
−µk+1Nn(µk ˆrk)Nn+1(µk+1 ˆrk)] ,
(Tk)21 = −(π/2)ˆrk [µkJn+1(µk ˆrk)Jn(µk+1 ˆrk)
−µk+1Jn(µk ˆrk)Jn+1(µk+1 ˆrk)] ,
(Tk)22 = −(π/2)ˆrk [µkNn+1(µk ˆrk)Jn(µk+1 ˆrk)
−µk+1Nn(µk ˆrk)Jn+1(µk+1 ˆrk)] .

(98)

Eq. (29) also dictates the form of the solution for the
eigenfunction outside the beam ˆr ≥ 1, satisfying the con-
dition of quadratic integrability:

Φn(ˆr) = bKn(qˆr), Re(q) > 0 .

(99)

Then, continuity at the boundary, i.e. at ˆr = 1 gives the
following relations:

ckJn(µk) + dkNn(µk) = bKn(q)

(100)

and

µkckJn+1(µk) + µkdkNn+1(µk) = bKn+1(q) .

(101)

The results in Section III constitute one of the few ex-
isting solutions for the evolution problem of a system of
particles and ﬁeld. Yet, to derive it, we had to rely on
several assumptions, among which that of a small pertur-
bation, in order to get linearized Maxwell-Vlasov equa-
tions. This is not too restrictive, since in practice one
has often to deal with space-charge waves in the linear
regime, but it would be interesting to provide a solution
for the full problem. From this viewpoint, the only way
to proceed is the development of some numerical code
based on macroparticle approach capable to deal with
the most generic problem. As a ﬁrst, initial step towards
this more ambitious goal we present here a numerical
solution of the evolution equation in the case of an axis-
symmetric beam, that we will cross-check with our main
result, Eq. (63). In order to build a numerical solution
one may, in principle, use Eq. (29), but it turns out more
convenient to make use of Eq. (31).

Eq. (31) can be specialized to the axis-symmetric case
by integration of Eq. (30) over the azimuthal angle φ
which leads to

ˆEz = −iq2

1

0
Z

dˆr′

ˆr′
"

∞

n=−∞
X

ˆj(n)
1 G(n)e−inφ

,

(105)

#

2

4

6

z^

8

 

10

12

14

0,0

2,0

1,0
 

0,5

1,5

r^

2

4

6

z^

8

 

10

12

14

0,0

2,0

1,0
 

0,5

1,5

r^

ˆE = Re( ˆEz) as a function of ˆz and ˆr. Here q = 1,
FIG. 4:
n = 0 and the ﬁrst ﬁve eigenfunctions have been used. A
stepped transverse proﬁle has been used.

ˆE = Re( ˆEz) as a function of ˆz and ˆr. Here q =
FIG. 6:
1, n = 0 and the ﬁrst ﬁve eigenfunctions have been used.
A gaussian transverse proﬁle proportional to e−ˆr2/(2σ2) with
σ = 2.0 has been used.

15

   Analytical
  Numerical

z = 0^

^z = 6

0,4

0,2

-0,2

-0,4
0

 E^

0,0

E^

0,4

0,2

0,0

-0,2

-0,4

^z = 12

^z = 9

^z = 3

0,4

0,2

-0,2

-0,4
0

 E^

0,0

0,4

0,2

-0,2

-0,4
0

 E^

0,0

2

4

6

z^

8

 

10

12

14

0,0

2,0

1,0
 

0,5

1,5

r^

0,0

0,5

1,0

1,5

2,0

r^

ˆE = Re( ˆEz) as a function of ˆz and ˆr. Here q =
FIG. 5:
1, n = 0 and the ﬁrst ﬁve eigenfunctions have been used.
A parabolic transverse proﬁle proportional to 1 − k2
1 ˆr2 with
k1 = 1.0 has been used.

FIG. 7: Comparison between analytical results (solid line)
and numerical methods (circles). ˆE = Re( ˆEz) is plotted as
a function of ˆr for several values of ˆz. Here q = 1, n = 0
and the ﬁrst ﬁve eigenfunctions have been used. A stepped
transverse proﬁle has been used.

where

of the ﬁeld can be written from Eq. (105) as

G(n)(ˆr, ˆr′) =

(cid:26)

In(qˆr)Kn(qˆr′)
In(qˆr′)Kn(qˆr)

ˆr < ˆr′
ˆr > ˆr′

,

(106)

ˆE(n)

z = −iq2

dˆr′ ˆr′ˆj(n)

1 G(n) .

(107)

1

0
Z

In being the modiﬁed Bessel functions of the ﬁrst kind of
order n. The equation for the n-th azimuthal harmonic

Therefore, under the assumption of a cold beam, Eq. (31)
can be rewritten as

E^

0,4

0,2

0,0

-0,2

-0,4

z=12^

z=3^

z=9^

z=12^

z=9^

z=3^

E^

0,4

0,2

0,0

-0,2

-0,4

z=0^

z=6^

z=0^

z=6^

0,0

0,5

1,0

1,5

2,0
r^

FIG. 8: Comparison between analytical results (solid line),
multilayer approximation with 15 layers (dotted line) and nu-
merical methods (circles). ˆE = Re( ˆEz) is plotted as a func-
tion of ˆr for several values of ˆz. Here q = 1, n = 0 and the
ﬁrst ﬁve eigenfunctions have been used. A parabolic trans-
verse proﬁle proportional to 1 − k2
1 ˆr2 with k1 = 1.0 has been
used.

   Analytical
   Multilayer

0,0

0,5

1,0

1,5

2,0
r^

FIG. 9: Comparison between multilayer approximation with
15 layers (solid line) and numerical methods (circles). ˆE =
Re( ˆEz) is plotted as a function of ˆr for several values of ˆz.
Here q = 1, n = 0 and the ﬁrst ﬁve eigenfunctions have been
used. A gaussian transverse proﬁle proportional to e−ˆr2/(2σ2)
with σ = 2.0 has been used.

16

    Multilayer
    Analytical
   Numerical

ˆz

+q2S0

dˆz

(ˆz′ − ˆz)

0

Z

(cid:20)

0

Z

1 = ˆa(n)
ˆj(n)
1
dˆr′ ˆr′ˆj(n)

1d + iˆzˆa(n)
1 G(n)

1e

, (108)

(cid:21)

which can be easily transformed, by double diﬀerentia-
tion with respect to ˆz into the integro-diﬀerential equa-
tion:

d2ˆj(n)
dˆz2 = −q2S0
1

1

0
Z

dˆr′ ˆr′G(n)ˆj(n)

.

1

(109)

(109) is of course to be considered together with
Eq.
proper initial conditions for ˆj1 and its z-derivative at
z = 0. The interval (0, 1) can be then divided into an
arbitrary number of parts so that Eq.
(109) is trans-
formed in a system of the same number of 2nd order
coupled diﬀerential equations. The possibility of trans-
forming Eq.
(109) in a system of 2nd order coupled
diﬀerential equations explains the choice of starting, in
this case, with Eq.(31) instead of Eq. (29): in this way
our system can be solved straightforwardly by means
of numerical techniques. To do so we used a 4th-order
Runge-Kutta integration method, which gave us the so-
lution of the evolution problem in terms of the beam
current. Then, using Eq. (107) we could get back ˆEz
and we compared obtained results with Eq. (63) for dif-
ferent choices of transverse proﬁles. The real ﬁeld Ez
should be recovered, for any particular situation, passing
to the dimensional quantity ˜Ez and, then, remembering
Ez = ˜Ezeiψ + ˜E∗
z e−iψ: yet, all relevant information is
included in Re( ˆEz). To give ﬁrst a general idea of the
obtained result we present, in Figs. 4, 5 and 6, Re( ˆEz)
as a function of ˆz and ˆr in the case of stepped, gaussian
and parabolic proﬁle respectively, with parameters choice
speciﬁed in the ﬁgure captions.
In all cases the initial
conditions are proportional to the transverse distribution
functions (stepped, gaussian, parabolic), ˆF ( ˆP ) = δ( ˆP )
and n = 0. We consider only initial density modulation
(i.e. ˆa1e = 0). Note that, in order to be consistent with
the perturbation theory approach we should really choose
ˆa1d ≪ 1, since it is normalized to the bunch current den-
sity. However using, for example, ˆa1d = ρ with ρ ≪ 1
will simply multiply our results by an inessential factor
ρ so, for simplicity, we chose ρ = 1. Note the oscilla-
tory behavior in the ˆz direction. Comparison with the
Runge-Kutta integration program are shown in Figs. 7,
8 and 9. In the parabolic case, both pure analytical solu-
tion and solution with multilayer approximation method
are present, while in the gaussian case only a solution
with the multilayer method is possible, to be compared
with the numerical Runge-Kutta result. This comparison
shows that the assumption of the validity of Eq. (51) is
correct in the parabolic case, and validates it once more
for the stepped proﬁle situation.

E^
0,025

0,020

0,015

0,010

0,005

0,000

-0,005

E^
0,025

0,020

0,015

0,010

0,005

0,000

-0,005

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

^
z = 0, q = 1

^
z = 0, q = 100

17

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

E^
1,0

0,8

0,6

0,4

0,2

0,0

r^

r^

0,0

0,2

0,4

0,6

0,8

1,0

1,2

0,0

0,2

0,4

0,6

0,8

1,0

1,2

r^

FIG. 10: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d =
e−ˆr2/(2σ) with σ = 0.1 at ˆz = 0 and for q = 1. The ﬁnal
result is the sum of the ﬁrst ﬁfty modes, here.

FIG. 12: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d =
e−ˆr2/(2σ) with σ = 0.1 at ˆz = 0 and for q = 100. The ﬁnal
result is the sum of the ﬁrst ﬁfty modes. Here n = 0.

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

^
z = 10, q = 1

0,0

0,2

0,4

0,6

0,8

1,0

1,2

FIG. 11: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d =
e−ˆr2/(2σ) with σ = 0.1 at ˆz = 10 and for q = 1. The ﬁnal
result is the sum of the ﬁrst ﬁfty modes, here.

B. The role of the initial condition

Here we present some further exempliﬁcation of the

obtained results.

In particular we are interested in investigating, in a few
cases, what is the role of the initial condition in the ﬁnal
results, in order to develop some common sense regarding
our analytical formulas.

The main parameter in our system is the transverse
beam extent q. However, intuitively, one can set two lim-
iting initial conditions: one in which only a small part of
the transverse section of the beam is modulated and the
other in which all of it is modulated. Depending on the
proﬁle of the initial modulation, one can have excitation
of many modes or only a few, while the conditions for ex-
citation of a single mode have been discussed in Section
III. The transverse parameter q will ﬁx the eigenvalue
problem and, therefore, the oscillation wavelength (in the
z direction) of the various modes. If q is smaller than or
comparable to unity we expect to have appreciable dif-
ferences in the eigenvalues, which lead to a quick (in ˆz)
change of the relative phases between diﬀerent modes. As
a result the initial shape of the ﬁelds will change pretty
soon. On the other hand, when q is larger than unity,
we will have all the eigenvalues converging to unity as in
the one-dimensional case, which means that the relative
phases between diﬀerent modes will stay ﬁxed for a much
longer interval in ˆz and the initial shape of the ﬁelds will
not change during the evolution.

To exemplify this situation we set up several calcu-
lations using our analytical solutions to the initial value
problem. In particular we considered two cases q = 1 and
q = 100, and a radial stepped proﬁle. Again, we consider
only initial density modulation (i.e. ˆa1e = 0) and we
in the ﬁrst we set ˆa1d = e−ˆr2/(2σ)
study two subcases:
with σ = 0.1 and in the second we put ˆa1d = 1. As said
before, in order to be consistent with the perturbation
theory approach we should really choose ˆa1d ≪ 1, since
it is normalized to the bunch current density but using,
for example, ˆa1d = ρ with ρ ≪ 1 will simply multiply

18

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

r^

r^

E^

0,0

-0,2

-0,4

-0,6

-0,8

E^

0,40

0,35

0,30

0,25

0,20

0,15

0,10

0,05

0,00

E^

0,40

0,35

0,30

0,25

0,20

0,15

0,10

0,05

0,00

^
z = 10, q = 100

^
z = 0, q = 1

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

r^

0,0

0,2

0,4

0,6

0,8

1,0

1,2

0,0

0,2

0,4

0,6

0,8

1,0

1,2

FIG. 13: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d =
e−ˆr2/(2σ) with σ = 0.1 at ˆz = 10 and for q = 100. The ﬁnal
result is the sum of the ﬁrst ﬁfty modes. Here n = 0.

FIG. 14: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d = 1 at
ˆz = 0 and for q = 1. The ﬁnal result is the sum of the ﬁrst
ﬁfty modes. Here n = 0.

our results by an inessential factor ρ so, for simplicity,
we chose, again, ρ = 1. Moreover we considered the az-
imuthal harmonic n = 0.

Figures 10 and 11 present the ﬁrst ﬁve eigenfunctions
(with relative weights and phases) and the sum of the
ﬁrst ﬁfty (i.e. the ﬁnal result) for ˆa1d = e−ˆr2/(2σ) with
σ = 0.1 at ˆz = 0 and at ˆz = 10 and for q = 1. As one
can see, the relative phases have changed and the shape
of the total ﬁeld, our ﬁnal result, has also changed with
ˆz.

On the contrary, Figs. 12 and 13 present the ﬁrst ﬁve
eigenfunctions (with relative weights and phases) and the
sum of the ﬁrst ﬁfty (i.e.
the ﬁnal result) for ˆa1d =
e−ˆr2/(2σ) with σ = 0.1 at ˆz = 0 and at ˆz = 10, and
for q = 100. Here the relative phases have almost not
changed and the shape of the total ﬁeld, our ﬁnal result,
is also remained unvaried (of course one must account for
the fact that the system is undergoing plasma oscillation,
so the shape, and not the ﬁeld magnitude, is what is
important here).

For comparison, it is interesting to plot analogous ﬁg-
ures for the second situation, that is ˆa1d = 1. Figs. 14
and 15 depict the situation for q = 1 at ˆz = 0 and ˆz = 10
respectively. The way the phases behave is similar to
what has been seen before, i.e. there is a rapid change
in the relative phases between the modes, but now it is
more diﬃcult to see from the plots because, in contrast
with the case of ˆa1d = e−ˆr2/(2σ) already the ﬁrst mode
is suﬃcient to ﬁt the initial conditions relatively well so
that the ﬁeld shape is almost unchanged. In Figs. 16 and
17 we plot, instead, the case q = 100 always as ˆz = 0 and
ˆz = 10 respectively, and with ˆa1d = 1. Here it is easy to

^
z = 10, q = 1

0,0

0,2

0,4

0,6

0,8

1,0

1,2

FIG. 15: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d = 1 at
ˆz = 10 and for q = 100. The ﬁnal result is the sum of the
ﬁrst ﬁfty modes. Here n = 0.

see, once more, that the relative phases between diﬀerent
modes are almost unchanged. What is of interest in this
latter set of four pictures is the way diﬀerent modes are
working together to satisfy initial conditions, in compari-
son with the way they mix in the case for ˆa1d = e−ˆr2/(2σ):
note, in particular, how the ﬁrst mode is almost enough
to satisfy the initial conditions (Figs. 14 and 15), while
in Figs. 10 and 11 it is almost completely suppressed.

19

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

r^

r^

E^

1,50

1,25

1,00

0,75

0,50

0,25

0,00

-0,25

-0,50

-0,75

-1,00

E^
1,00

0,75

0,50

0,25

0,00

-0,25

-0,50

-0,75

-1,00

-1,25

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

z = 0^

E^

0,4

0,2

0,0

-0,2

-0,4

-0,6

-0,8

-1,0

E^

0,4

0,2

0,0

-0,2

-0,4

-0,6

-0,8

-1,0

r^

r^

^
z = 0, q = 100

0,0

0,2

0,4

0,6

0,8

1,0

1,2

0,0

0,2

0,4

0,6

0,8

1,0

1,2

FIG. 16: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d = 1 at
ˆz = 0 and for q = 100. The ﬁnal result is the sum of the ﬁrst
ﬁfty modes. Here n = 0.

FIG. 18: The ﬁnal result and the ﬁrst ﬁve modes when the
initial condition is set in order to excite the third mode alone.
The ﬁnal result is the sum of the ﬁrst ﬁfty modes. Here n = 0.

^
z = 10, q = 100

 Final result
 1st  Mode
 2nd Mode
 3rd Mode
 4th Mode
 5th Mode

^
z = 10

0,0

0,2

0,4

0,6

0,8

1,0

1,2

0,0

0,2

0,4

0,6

0,8

1,0

1,2

FIG. 17: The ﬁnal result and the ﬁrst ﬁve modes ˆa1d = 1 at
ˆz = 10 and for q = 100. The ﬁnal result is the sum of the
ﬁrst ﬁfty modes. Here n = 0.

FIG. 19: The ﬁnal result and the ﬁrst ﬁve modes when the
initial condition is set in order to excite the third mode alone.
The ﬁnal result is the sum of the ﬁrst ﬁfty modes. Here n = 0.

(90) we must set (modulus a constant factor):

This should not be a surprise, considering that we may
actually select a single mode by ﬁxing appropriate initial
conditions as described in Eq. (71) and Eq. (72). For
instance, if we ﬁx ˆa1e = 0 and we want to excite only the
jth mode for a given value of the azimuthal harmonic n
in the case S0 = 1, then, according to Eq. (72) and Eq.

ˆa1d =

∂2Jn(αj ˆr)
∂ˆr2

+

1
ˆr

∂Jn(αj ˆr)
∂ˆr

−

q2 +

Jn(αj ˆr)

n2
ˆr2

(cid:19)

(cid:18)

(110)
where αj is deﬁned in Eq. (89). For example if we choose
n = 0 and j = 2 (third mode) for q = 1 we obtain the

results presented in Fig. 18 at ˆz = 0 and in Fig. 19 at
ˆz = 10. As it can be seen by inspection only the third
mode is excited and evolves. Our condition Eq. (110) set
strictly to zero the contributions of all the modes with
j 6= 2. Of course, in practice, actual data plotted in
the ﬁgures show ﬁnite contributions of the other modes
ascribed to the ﬁnite accuracy of our computations: to
be precise, the diﬀerence between the ﬁnal result (sum of
the ﬁrst ﬁfty modes) and the third mode alone was found
to be on the fourth signiﬁcative digit.

V. CONCLUSIONS

In this paper paper we presented one of the few self-
consistent analytical solutions for a system of charged
particles under the action of their own electromagnetic
ﬁelds. Namely, we considered a relativistic electron beam
under the action of space-charge at given initial con-
ditions for energy and density modulation and we de-
veloped a fully analytical, three-dimensional theory of
plasma oscillations in the direction of the beam motion.
We used the assumption of a small modulation so that
we could investigate the system behavior in terms of a
linearized Vlasov equation coupled with Maxwell equa-
tion, under the assumption that ﬁeld retardation eﬀects
can be neglected. Then we introduced normalized quan-
tities according to similarity techniques and we provided
two equivalent presentations for the evolution problem
in terms of a integrodiﬀerential equation for the electric
ﬁeld and of a integral equation for the beam current.

The integrodiﬀerential equation for the ﬁelds was par-
ticularly suited to be solved with the help of Laplace
transform techniques: we did so in all generality and
we discussed the mathematical diﬃculties involved in
the general treatment, namely the assumption of a well-
behaved diﬀerential operator allowing eigenmodes expan-
sion of the Green function and the problem of the ana-
lytic continuation of the Laplace transform of the ﬁeld to
all the complex plane (isolated singularities excluded), in
relation with the application of the Fourier-Mellin inte-
gral to antitransform ¯E. Our considerations led us to
restrict our attention to the cold beam case. We special-
ized the general method to the important cases of stepped
and parabolic transverse proﬁles, which are among the
In particular, the
few analytically solvable situations.

20

stepped proﬁle case could be used to develop a semi-
analytical technique to solve the evolution problem for
the ﬁeld using an arbitrary transverse shape.

We tested our results by discussing the limit for the
1-D theory (q → ∞). We also developed an algorithm
able to solve the evolution problem in terms of the beam
currents. The integral equation for the currents could be
easily approximated to a system of second order ordinary
diﬀerential equations which could be solved by means of
numerical Runge-Kutta integration method. Once the
solution for the current was known we recovered the elec-
tric ﬁeld evolution by integration of the current with a
suitable Green function. Numerical and analytical or
semi-analytical solutions for the ﬁelds were then com-
pared and gave a perfect agreement.
In this way we
could state that the assumption of the correctness of the
eigenmodes expansion for the Green function has been
proved, for some particular proﬁles, by means of numer-
ical crosschecks (in the stepped proﬁle case, by means of
alternative analytical techniques too).

Finally we exempliﬁed the role of the initial condition,
which we have seen to control the way one ore more
modes interact together to give the ﬁnal result. In partic-
ular we have shown how to build up initial conditions in
such a way that a single mode is excited and propagates
through. We checked our prescription by setting up par-
ticular initial conditions and looking at the propagation
of various eigenmodes.

In conclusion we proposed, checked and analyzed, both
from physical and mathematical viewpoint, a theory of
space-charge waves on gradient-proﬁle relativistic elec-
tron beams. This work is of fundamental importance,
since it is one of the few known analytical solution to
evolution problems for systems of particles and ﬁelds. In
particular, today, it is of great relevance in the physics of
FEL and high-brightness linear particle accelerators.

VI. ACKNOWLEDGEMENTS

(DESY), Michele Correggi

We thank Reinhard Brinkmann (DESY), Martin
(SISSA), Klaus
Dohlus
Floettman (DESY) and Helmut Mais (DESY) for use-
ful discussions. We thank Jochan Schneider (DESY) and
Marnix van der Wiel (TUE) for their interest in this
work.

[1] J. Rosenzweig et al. in Proc. of Advanced Accelerator

Workshop, Lake Tahoe, 1996

[2] C. Limborg-Deprey, Z. Huang, J. Welch et al., in Pro-
ceedings of EPAC2004, Lucerne, Switzerland, to be pub-
lished

[5] The LCLS Design Study Group, LCLS Design Study Re-
port, SLAC reports SLAC- R521, Stanford (1998) and
http://www-ssrl.slacstanford.edu/lcls/cdr

[6] L.-H. Yu, M.Babzien, I. Ben-Zvi et al., Science, 289

[3] M. Dohlus, K. Floettmann, O.S.Kozlov et al., Nucl. Instr.

[7] J. Feldhaus, M. Koerfer, T. Moeller et al., DESY 03-091,

(2000)

ISSN 0418-9833

and Meth. A, 2004, in press

[4] TESLA Technical Design Report, DESY 2001-011,
edited by F.Richard et. al., and http://tesla.desy.de/

[8] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, DESY
TESLA-FEL-2003-02 and Nucl. Instr. and Meth A, 2004,

in press

[16] Yu. L. Klimontovich, Statistical Physics, Harwood Aca-

[9] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, The
Physics of Free Electron Lasers, Springer-Verlag, 2000

demic Publ., New York, 1986

[17] E.M. Lifshitz and L. P. Pitaevskii, Physical Kinetics,

[10] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov,

Moscow, Nauka, 1979

Physics Reports, 260, 1995 p. 187
[11] H. Alfven, Phys. Rev. 55, 425 (1939)
[12] J.D. Lawson, J. Electron. Control 3, 587, (1957)
[13] C.L. Olson and J.W. Poukey, Phys. Rev. A, 9 2631 (1974)
[14] E.L. Saldin, E.A. Schneidmiller and M.V. Yurkov, Optics

Communications, 186, 2000 Pages 185-209

[15] Yu. L. Klimontovich, Physics-Uspekhi 40 (1), 1997

[18] S. Krinsky and L.H. Yu. Phys. Rev. A 35 (1987), p. 3406
[19] A.E. Siegman, Phys. Rev. A 39 (1989), p. 1253
[20] Bernard Friedman, Principles and Techniques of Applied

Mathematics (Wiley, New York, 1956)

[21] G. Ecker, Theory of Fully Ionized Plasma, Academic

Press, New York, 1972

21

