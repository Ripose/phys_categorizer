PNU-NTG-12/2004
PNU-NuRI-09/2004
Nonlinear Dynamical Behaviors of the Equilibrium Longitudinal
Distribution by Localized Wakes in an Electron Storage Ring

S.-H. Park∗,1, † H.-Ch. Kim,1, ‡ J.K. Ahn,1, § and E.-S. Kim2, ¶
1Department of Physics & Nuclear Physics and Radiation Technology Institute (NuRI),
Pusan National University, Busan 609-735, Korea
2Pohang Accelerator Laboratory, POSTECH,
San 31, Pohang, Kyungbuk 790-784, Korea
Abstract
We investigate the eﬀects of a localized constant wake and a localized linear wake on the lon-
gitudinal beam distribution in equilibrium. We also examine the eﬀects of the composite wake
on the particle distribution when the constant wake and linear wake simultaneously exist in the
ring. While moving around the parameter space, the system can show bifurcation phenomena
and transition features between periodic states. We study the dynamical states in a beam, us-
ing the multi-particle tracking method in a Gaussian approximation. They show good qualitative
agreement.

PACS numbers: 29.20.Dh
Keywords: wakes, bifurcation, electron storage ring, multi-particle tracking

4
0
0
2
 
c
e
D
 
4
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
7
2
0
2
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

∗ Present address: LG.PHILIPS LCD, 161, Imsoo-dong, Kumi, Kyungbuk 730-350, KOREA
†Electronic address: shpark@lgphilips-lcd.com
‡Electronic address: hchkim@pusan.ac.kr
§Electronic address: ahnjk@pusan.ac.kr
¶Electronic address: eskim1@postech.ac.kr

1

I.

INTRODUCTION

When a beam is stored in a storage ring, the beam is aﬀected by a wake force that is
generated by an electromagnetic interaction between the beam and the components of the
ring. The wake force disturbs the distribution of particles in the beam. Various approaches
to investigate the particle distribution have been performed. It was usually assumed that
the wake force was averaged over one turn and was distributed uniformly in the ring. In fact,
however, the wake sources may be localized. Therefore, such assumptions of an averaged
and uniform wake force may cause diﬀerent dynamical behaviors of the system from real
ones in many cases. To see the eﬀects due to such position-dependent wake forces, Hirata [1]
investigated the particle distribution in a beam, assuming a constant localized wake. Hirata
et al. [2] then showed that the equilibrium bunch length in electron storage rings could
exhibit a cusp-catastrophe behavior. Kim et al. [3] found that several multi-periodic states
in particle distributions of a beam could also exist for a constant wake.

The aim of the present work is at investigating dynamic behaviors of the longitudinal
beam distribution in the presence of the wake that has two components localized at one
position of the ring. Here, we consider the linear wake as well as the constant one as
sources of the localized wakes. It is also of great interest to see how the longitudinal beam
distribution behaves dynamically under the composite constant and linear wakes in a ring.
The dynamical behaviors of the beam distribution will be examined with the damping time,
the strength of the wake force, and the synchrotron tune considered. It will be shown that
the dynamic system under two localized wake sources may present quite diﬀerent dynamic
behavior from that with an individual wake source taken into account.

The paper is organized as follows: In Section 2, we brieﬂy describe the model which is
used in order to investigate the equilibrium logitudinal distribution of the beam particles in
a Gaussian approximation. In Section 3, we study the dynamical states of the distribution
of particles in a beam. To check the validity of the results from the present model, we also
compare them with those from the multi-particle tracking in Section 4. Finally, Section 5 is
devoted to discussion and conclusion.

II. THE MODEL

A. Longitudinal dynamics

We assume that there are two localized wake sources at one position of the ring. To
describe dynamics of the particle distribution in longitudinal phase space, we introduce the
following normalized longitudinal variables:

x1 =

longitudinal displacement
σz

, x2 =

energy deviation
σE

,

where σz is the natural bunch length and σE stands for the natural energy spread. The
center of the bunch is located at x1=0 such that x1 > 0 corresponds to the rear part of the
bunch. The motion of a particle in a ring can then be modeled as follows:

1) Radiation

2

x′
1 = x1

x′
2 = Λx2 + (1

 

Λ2)1/2ˆr !

−

2) Wake

x′
1 = x1
x′
2 = x2

 

−

φ(x1) !

3) Synchrotron oscillation

x′
1
x′
2 !

 

= U

x1
x2 !

,

 

where

U =

cos(2πν)
sin(2πν) cos(2πν) !

sin(2πν)

.

 

−

2/Te), Te being the synchrotron damping time divided
In the above equations, Λ = exp(
by the revolution time, ν the synchrotron tune and ˆr a Gaussian random variable with zero
mean and unit standard deviation.

−

After one turn in the ring, the motion of a particle is described by

x′
1
x′
2 !

 

= U

Λx2 + (1

 

−

x1
Λ2)1/2ˆr

.

φ(x1) !

−

The wake force is given by

φ(x1) =

ρ(x1

u)W (u)du,

∞

0
Z

−

where ρ(x) is the longitudinal charge density normalized to unity, and W (u) stands for the
longitudinal wake function multiplied by eQ/σE, where e is the electron charge and Q the
total charge in a bunch.

In the present work, we consider the constant as well as the linear wake functions: W (u) =
aΘ(u) (Θ being the unit step function) and W (u) = bu, where a and b denote the strengths
of the wake.

B. Gaussian model

We assume the wake to disappear at a short distance behind the particles producing it so
that one can neglect multi-turn eﬀects of the wake. Generally, leading particles in a bunch
lose energy due to wake ﬁelds. In order to meet this condition, we note that the signs of a
and b in the wake functions should be positive.

Since it is not realistic to observe individual particles, we are more interested in statistical

quantities such as

¯xi =

xii

h

, σij =

(xi −

h

¯xi)(xj −

¯xj)

,

i

3

(1)

(2)

(3)

(4)

(5)

(6)

(7)

where i, j are either 1 or 2, which are the moments of the phase-space distribution Ψ(x1, x2).
In reality, we require all of higher order moments to reproduce Ψ(x1, x2). We always ap-
proximate Ψ(x1, x2) as

Ψ(x1, x2) =

1
2π√detσ ×

exp[

1
2

−

σ−1
i,j (xi −

¯xi)(xj −

¯xj)].

Xi,j

For simplicity, however, we assume here that the distribution function in phase space always
remains Gaussian even under the inﬂuence of the wake force. We thus need to consider only
the ﬁrst- and second-order moments.

With the same treatment as in Ref. [1] used, each mapping in Eqs. (1)-(3) can be given

Further calculations lead us to obtain for the constant wake [2]
1 = ¯x1, ¯x′
¯x′

2 = ¯x2

a/2,

As for the linear wake, we derived the following relations from eqs. (11) and (12)

2 = Λ¯x2,
12 = Λσ12,
Λ2)

as :
1) Radiation
¯x′
1 = ¯x1, ¯x′
11 = σ11, σ′
σ′
22 = Λ2σ22 + (1
σ′
2) Wake
1 = ¯x1, ¯x′
¯x′
2 = ¯x2
11 = σ11, σ′
σ′
12 = σ12
σ′
(x2
22 = σ22
2

− h

−

φ

−

h

−

,
(x1
+

i
− h
¯x2)φ

i

¯x1)φ)
φ2

,
i
φ
i − h

−
h

2.

i

11 = σ11, σ′
σ′

−
12 = σ12

σ′
22 = σ22

a

√σ12
√πσ11

−

a

√σ11
2√π

,

−

+ a2/12.

1 = ¯x1, ¯x′
¯x′

σ′
11 = σ11, σ′

σ′
22 = σ22

−

,

−

2 = ¯x2

b
r

σ11
π
bσ11
2
bσ12 + b2σ11(0.608998 +

12 = σ12

−

,

1
π

).

3) Synchrotron oscillation

¯x′
i =

Uij ¯xj,

σ′
ij =

UijσhkUjk.

Xj
2

Xh,k=1

(8)

(9)

(10)

(11)

(12)

(13)

(14)

(15)

(16)

(17)

(18)

Note that the mappings for ¯xi and σij are related to each other for the constant wake
function. However, those for ¯xi depend on σ11 for the linear wake function due to the fact
that we have utilized the approximation of the Gaussian distribution .

4

III. DYNAMICAL BEHAVIOR OF THE GAUSSIAN MODEL

If S is the mapping described by Eq. (14) or Eq. (16), then a period-one ﬁxed point

σ = (σ11, σ12, σ22) is deﬁned by

while the period-two ﬁxed point is deﬁned by

with σ1 and σ2 occurring in alternating pairs at successive turns as

σ = S(σ),

σ = S[S(σ)]

σ1,2 = S(σ2,1).

One can easily extend the deﬁnition to period-n states.

ν

≤

≤

≤

0.3, 1

Te ≤

1500 and 0 < a

First, let us consider the dynamical behavior of the system for the constant wake function.
In a previous work [3], one of the authors studied the dynamic states in the parameter space
set: 0.01
45. The results are summarized in Table I,
≤
which shows four diﬀerent behaviors, depending on the synchrotron tune. Those numbers in
Table I denote existing period states, i.e. 1 stands for the period-one state, 2 does the period-
two state, and 1-2 denotes the period-one and period-two states existing simultaneously. The
parameter space shows that several types of equilibrium states such as period-one, period-
two, period-three, period-four can exist stably depending on the parameter space (Te and
a).

In the case of the linear wake function, it is shown that the period-one state only exists
as an equilibrium state. The tracking of the mapping for the period-one state is drawn in
Fig. 1, where the features of the trajectories are indicated near the period-one ﬁxed point. In
the left panel of Fig. 1 the ﬁxed point is depicted at (σ11, σ22) = (0.53105, 0.53105), whereas
in the right panel the ﬁxed point is drawn at (σ11, σ22) = (0.05341, 0.22875).

When it comes to the composite wake of the constant and linear ones (aΘ + bu), Fig. 2
depicts the trackings of the mapping with the diﬀerent b for ν = 0.20. The system plotted in
Fig. 2(a) presents the period-two state, in which the ﬁxed points are located at (σ11, σ22) =
(15.43191, 17.01573) and (24.96073, 31.95213). However, when the strength of the linear
wake becomes larger, the number of the ﬁxed points is reduced to one, as shown in Fig. 2(b).
Thus the system shows the period-one state that has a ﬁxed point at (σ11, σ22) = (6.31035,
9.77105).

= 0 and b

Figure 3 shows the trackings of the mapping for the composite wake in ν = 0.05. Given
= 0, b = 0, which means that the system is under the constant wake, the system turns
a
out to be in the period-three state. However, when a
= 0, the system may
exist in diﬀerent states. In the panel (a) of Fig. 3 it is still in the period-three state with
b = 0.01. In that case, the strength of the linear wake is small so that the system shows
similar behavior to the constant wake case. The ﬁxed points are located at (σ11, σ22) =
(0.78431, 17.25226), (1.257, 2.34851) and (0.35848, 6.9652). As the strength of the linear
wake becomes larger, the state of the system starts to get changed. When b is 0.5, the
system is found in the period-two state with ﬁxed points at (σ11, σ22) = (0.26121, 5.89856)
and (0.24996, 4.39433). If b is set to be 5.0, the system turns back to the period-three state
again. The ﬁxed points exist at (σ11, σ22) = (6.86404, 17.82114), (2.46592, 32.71493) and
(3.61459, 89.64147). Putting b = 7.5, we ﬁnd that the system lies in the period-one state. In
the panels (a) and (b) of Fig. 4 and in (c),(d) show the equilibrium of σ11 for the constant

5

6
6
6
(a)

(b)

2.4

2.0

1.6

0.8

0.4

0.0

1.2

22

 

2.0

22

4.0

3.5

3.0

2.5

1.5

1.0

0.5

0.0

0.0

0.4

0.8

1.2

1.6

2.0

2.4

0.0

0.2

0.4

0.6

0.8

1.0

1.2

11

11

FIG. 1: Features of trajectories for the linear wake. The parameters are initially given for the left
panel (a) Te= 10, b = 0.5, ν = 0.25, σ11 = 2, σ12 = 0, σ22 = 1, while for the right panel (b) Te =
15, b = 2.0, ν = 0.05, σ11 = σ22 = 1, σ12=0.

 

 

25

20

15

5

0

22

10

(b)

11

0

3

6

9

12

15

FIG. 2: Features of trajectories for the composite wake. The parameters are initially given as Te
= 25, ν = 0.20, a = 10, σ11 = σ22 = 5, σ12 = 0. b = 0.25 for the left panel (a), while b = 1.0 for
the right panel (b).

and the composite wakes with Te slowly changed, respectively, while in the panels (a) and
(c) the equilibrium of σ11 is shown when Te increases from 0 to 30. In the panels (b) and
(d) of Fig. 4, we ﬁnd the processes reversed. There are two transition points in Fig. 4(a):
The system shows the transitions from period-one to period-two and then from period-two
to period-one. The reverse process for the constant wake is shown in the panel (b) of Fig.
4 and it also has two transition points but the transition states are diﬀerent from those in
the panel (a): It is found that the period-three state changes to the period-two one and vice
versa. On the other hand, In the panel (c) of Fig. 4 the composite wake plays a role of
changing the period-one to the period-two state and vice versa. In the panel (d) of Fig. 4

6

240

200

160

80

40

0

120

22

 

0

3

6

9

12

(d)

11

FIG. 3: Features of trajectories for the composite wake. The parameters are initially given as Te
= 15, ν = 0.05, σ11 = σ22 = 1, σ12 = 0, a = 10. In the panel (a) b = 0.01, while in (b), (c), and
(d), b=0.5, 5.0, and 7.5, respectively.

we see the same behavior as in the panel (c).

Trackings of the mapping for the composite wake indicate that when b is small the system
turns out to be similar to that for the constant wake, while when the b becomes larger, it
changes to another state. Thus, in conclusion, when two diﬀerent kinds of wakes exist, the
dynamical behavior of the system can be changed, depending on the relative magnitude of
the strength of the wake: they may show diﬀerent stability behaviors in the parameter space
from the case of a single wake.

7

FIG. 4: The bifurcations due to the constant and the composite wakes for ν = 0.05. In the panels
(a) and (b) the equilibrium of σ11 for the constant wake with the parameters of a = 10 and σ11 =
σ22 = 1 and σ12 = 0 are shown, respectively. In the panels (c) and (d) the equilibrium of σ11 for
the composite wake with the parameters of a = 10 and σ11 = σ22 = 1, σ12 = 0 with b = 5.0 are
shown. (a) and (c) represent σ11 when Te slowly changes from 0 to 30, and (b) and (d) represent
their reverse processes.

IV. MULTI-PARTICLE TRACKING

In this section, we examine the reliability of the results from the present model obtained
in Secion 3. The Gaussian Ansatz in the model is considered as a particle distribution of a
beam, however, the real distribution can be rather far from the Gaussian one. We thus need
to compare the Gaussian distribution with the multi-particle tracking in order to see whether

8

FIG. 5: Phase-space distribution for the period-one state from the multi-particle tracking for the
linear wake function. The parameters are given as Te = 10, ν = 0.25, b = 0.25 and 20, 000 turns.
The equilibrium state shows the same distribution per turn.

the results obtained from the model are merely caused by the simpliﬁcation of the model.
In the case of the constant wake function, we use a sorting routine for the calculation of the
wake force acting on each particle, i.e. the wake force φ that a given particle experiences
is obtained by counting the total number of particles preceding it. As for the linear wake
function, we calculate individual distances of the preceding particles in order to derive the
wake force acting on each particle. Thus, the φ is obtained by summing the distances of
preceding particles. The initial particle coordinates in the longitudinal phase space are
generated as Gaussian random numbers with zero mean and unit standard deviation. We
use Eq. (5) to perform the multi-particle tracking in the phase-space coordinates of 10000
macro-particles.

First, we observe the equilibrium states of the particle distribution in the case of the
linear wake. The phase space which brings out the multi-particle tracking for ν = 0.25 is
depicted in Fig. 5. It is obtained by tracking 10000 particles after 20000 turns. It is shown
that the equilibrium state in the multi-particle tracking accounts for the period-one state. It
is also examined that the only equilibrium state for the linear wake is found in the period-1
state in the parameter of the synchrotron tunes ranging from 0.01 to 0.3, irrespective of the
initial conditions. It is in a good agreement with that of the Gaussian model.

We also ﬁnd the equilibrium states of the particle distribution due to the composite eﬀect
of the constant and the linear wakes. In the panels (a) and (b) of Fig. 6, the phase space
yielding the results of the multi-particle tracking for ν = 0.2 is plotted. It is obtained by
tracking 10000 particles after 20000 turns. The panels (a) and (b) of Fig. 6 show the period-
two state from 19999 turns and 20000 turns, respectively. The equilibrium distributions with
the period-two state presents the same distribution by two turns. It is also shown that when
b becomes larger, the equilibrium states in the multi-particle tracking produces the transition
from the period-two state to the period-one one and vice versa. Here, we see that periodic

9

FIG. 6: Phase-space distribution for the period-two state from the multi-particle tracking for the
composite wake function. The parameters are given as ν = 0.20, Te = 22, a = 8 and b = 0.18.
(a) and (b) shows the phase space distributions at 19,999 and 20,000 turns, respectively. The
equilibrium state shows the same distribution per two turns.

states shown by the Gaussian model also appear in the multi-particle tracking.

As a result, we ﬁnd that the results from the Gaussian model are in a qualitative agree-
ment with those from the multi-particle tracking in the presence of the linear wake: The
existence of the period-doubling bifurcation and the transition between the periodic states.
Note that in the present work we only have evaluated the results of the multi-particle track-
ing for ν = 0.2 in order to show that the simple Gaussian model with the composite wake
explains well the behaviors of periodic states and the transition between them, compared to
the results from the multi-particle tracking for 0.01

0.3.

ν

≤

≤

V. DISCUSSION AND CONCLUSION

In the present work, we have investigated the nonlinear dynamical behaviors and stable
periodic states on the longitudinal beam distribution, using both the Gaussian model and
multi-particle tracking. It was shown that these periodic states have bifurcations to other
periodic states. These behaviors are observed in both the Gaussian model and multi-particle
tracking. The model calculations showed the period-one state in the dynamic state of a
particle distribution in a beam for the linear wake. It is also conﬁrmed by the multi-particle
tracking method. When both the constant wake and linear wake simultaneously exist, the
parameter space in which the periodic states exist can be changed by the magnitude of the
linear wake. It was concluded that the Gaussian model seems to be useful in investigating
qualitatively the particle distribution in the longitudinal phase space.

One of the main purposes in the present work was to investigate the eﬀects of the com-
posite cases taking into account the constant and linear wakes. We examined the dynamical

10

behaviors of the equilibrium bunch length and their stability for a localized constant and
linear wakes. Though the Gaussian model seems to be too simple, the results from the
model are in a good agreements with those from the multi-particle tracking method. When
both a constant and linear wakes exist in a ring, it was shown that the transition between
the periodic states depends on the relative strengths of the two wakes.

Acknowledgments

The work of HChK was supported by Pusan National University. The work of JKA was
supported by Korea Institute of Science & Technology Evaluation and Planning(KISTEP)
and Ministry of Science & Technology (MOST), Korean government through its BAERI
program. JKA is grateful to the PAL, where a part of the present work has been achieved.

[1] K. Hirata: Part. Accel. 22 (1987) 57.
[2] K. Hirata, S. Petracca and F. Ruggiero: Phys. Rev. lett. 66 (1991) 1693.
[3] E.-S. Kim and M. Yoon: IEEE Trans. Nucl. Sci. 48 (2001) 181.
[4] E.-S. Kim and K. Hirata: KEK Report 95-5 (1995).

11

TABLE I: Synchrotron tune and stable periodic states for the case of the constant wake function.

Synchrotron tune Existing periodic state
0.244
0.153
0.103
0.01

0.30 1
0.243 1; 2; 1-2
0.152 1; 2; 1-2; 1-3; 2-3
0.102 1; 2; 1-3; 1-4; 2-3; 1-3-4; 2-3-4

≤
≤
≤
ν

≤
≤
≤

ν
ν
ν

≤

≤

12

