7
0
0
2
 
r
a

M
 
9
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
8
8
1
3
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

SLAC-PUB-12370
DESY-07-023
February 2007

Impedance Calculations of Non-Axisymmetric
Transitions Using the Optical Approximation∗

K.L.F. Bane, G. Stupakov
Stanford Linear Accelerator Center,
Stanford University, Stanford, CA 94309

I. Zagorodnov
Deutsches Elektronen-Synchrotron, Notkestrasse 85, 22603 Hamburg, Germany

Abstract
In a companion report, we have derived a method for ﬁnding the impedance at high frequencies
of vacuum chamber transitions that are short compared to the catch-up distance, in a frequency
regime that—in analogy to geometric optics for light—we call the optical regime. In this report
we apply the method to various non-axisymmetric geometries such as irises/short collimators in a
beam pipe, step-in transitions, step-out transitions, and more complicated transitions of practical
importance. Most of our results are analytical, with a few given in terms of a simple one dimensional
integral. Our results are compared to wakeﬁeld simulations with the time-domain, ﬁnite-diﬀerence
program ECHO, and excellent agreement is found.

Submitted to Physical Review Special Topics–Accelerators and Beams

∗ Work supported by Department of Energy contract DE–AC02–76SF00515 and and by the EU contract

011935 EUROFEL.

1

I.

INTRODUCTION

In many current and future accelerator projects short, intense bunches of charged particles
are transported through vacuum chambers that include objects such as transitions, irises,
and collimators. For example, in the beam delivery system of the International Linear
Collider (ILC) 3 nC, 300 µm-long bunches encounter many collimators on their way to
the interaction region [1]. Or, in the undulator region of the Linac Coherent Light Source
(LCLS) a 1 nC, 20 µm-long bunch passes by square-to-round transitions, bpm’s, and other
changes in chamber geometry [2]. Wakeﬁelds generated by such changes in vacuum chamber
geometry can negatively aﬀect the beam emittance and ultimately the performance of an
accelerator. Numerically obtaining the strength of the wakeﬁelds or, equivalently, of the
impedances for short bunches in such vacuum chamber objects can be diﬃcult, in particular
when the object is long and non-cylindrically symmetric.

In a recent paper [3] we developed a method to solve such seemingly diﬃcult problems in
a so-called optical approximation. This method is valid in the limit of high frequencies and
reduces the calculation of the impedance to the two dimensional integration of potential
functions. In this report we make use of this method to work out solutions to a selection
of 3D (shorthand for non-cylindrically symmetric) geometries that can be encountered in
today’s accelerators.

The geometry of the problems to be considered is, in general, of the type sketched in
Fig. 1. An in-going beam pipe (region A with cross-section proﬁle SA) is followed by a
short transition (the gap or aperture region G with cross-section SG) and ends in an out-
going pipe (region B with cross-section SB). We limit consideration to cases where SG is
contained within the intersection of SA and SB [SG ⊆ (SA ∩ SB)]. The transition need
not be smooth like the one in the ﬁgure. A speed of light beam passes through the three
regions on a straight line that we call the design orbit. At ﬁrst there is no assumption on
transverse symmetry in the three region. However, we do assume that the axes of regions
A and B are parallel to the design orbit. Note that if SG = SB the structure is called a
step-in transition (by which we mean a short, inward transition), if SG = SA it is a step-out
transition (a short, outward transition). If SA = SB, with the aperture of SG smaller than
the beam pipes, then the structure is an iris (a metallic diaphragm with a hole or slot) or
short collimator in a beam pipe.

FIG. 1: Sketch of a generalized 3D transition, showing the regions A, G, and B, with cross-sections
SA, SG, and SB, respectively.

We are interested in ﬁnding the high frequency longitudinal or transverse impedance of a

2

general transition such as is sketched in Fig. 1. The impedance regime can be described as
the regime of geometric optics. This regime is applicable provided that (1) the frequency is
high and (2) the transition is short. By condition (1), we mean that the frequency ω (cid:29) c/g,
with c the speed of light and g the minimum aperture of the structure. If the transition is
tapered, we require further that ω (cid:29) c/(gθ), with θ the taper angle. By condition (2), we
mean that the length of the transition is short compared to the catch-up distance, (cid:96) = g2ω/c.
Note that in the optical regime the high frequency longitudinal impedance of a structure
is resistive, with the impedance Z(cid:107) real and independent of frequency. The transverse
impedance Z⊥ is also real and depends on frequency as ω−1.

The method of Ref. [3] can be used to ﬁnd the impedance, for example, for an iris in a
beam pipe, a step-in or step-out transition, and a short collimator. Also, there are objects
that we call long collimators; i.e. collimators that have a ﬁxed (minimum) aperture over a
length that is long compared to the catch-up distance (cid:96), with transitions at the front and
back ends. For long collimators our methods also apply, provided that the two transitions
satisfy the above two conditions. For such a collimator the impedance is the sum of the
impedances of its two transitions. Note, however, that for intermediate length collimators,
those of length comparable to the catch-up distance, our methods do not apply.

In Ref. [3] the impedance of a general transition in the optical regime is developed follow-
ing a systematic approach. Earlier work on the subject was focused on speciﬁc geometries
and often was rather informal in nature. Balakin and Novokhatski were among the ﬁrst to
address the question of impedance in the optical regime [4]. Heifets and Kheifets studied
the longitudinal impedance of round step-in and step-out transitions (in the optical regime)
numerically by ﬁeld matching [5]. For round, long collimators the dipole mode impedance
was obtained rigorously in Ref. [6], and the higher azimuthal mode impedances, more infor-
mally, in Ref. [7]. The impedance of short and long, round and 3D collimators was studied
numerically in Refs. [8], [9]; it was found, for example, that the impedances of short and
long collimators, in general, diﬀer signiﬁcantly in amplitude (by a factor ∼ 2 in the round,
transverse case).

The impedances that we obtain in this report following our method will also be compared
to numerical results obtained by the computer program ECHO [10]. This program solves
Maxwell’s equations to ﬁnd the wakeﬁeld of an ultra-relativistic Gaussian bunch within
(perfectly conducting) metallic boundaries of fully 3D geometry. From the wakeﬁelds of a
suﬃciently short bunch the impedance in the optical regime can be obtained directly. In
the present report discussions of ECHO calculations will be brief; their main purpose is to
conﬁrm our results and to give us conﬁdence in our method.

This report is organized as follows: In Section II the method of calculation, derived in
the companion paper, Ref. [3], is presented. At the end of this section some details of the
ECHO simulations will be given. The heart of the present report, however, is the next
four sections where our method is applied to 3D transition examples. The problems that
we solve are example irises or short collimators within a beam pipe (Section III), step-in
transitions (Section IV), step-out transitions (Section V), and more complicated transitions
(Section VI). In these sections our results will be compared brieﬂy to ECHO simulation
results. Section VII gives the conclusions. In the Appendix speciﬁc limits for the impedance
of an elliptical step-out transition are derived. Note that although we follow the method
of Ref. [3] in this report, the notation used here is not exactly the same. Note also that
Gaussian units will be used throughout; to convert impedances to MKS units, one multiplies
by the factor Z0c/4π, with Z0 = 377 Ω.

3

II.

IMPEDANCE CALCULATIONS

Consider a general (transversely non-symmetric) transition. Let the design orbit follow
the z-axis, with the particle motion in the +z direction. The transverse impedance of a
general transition consists of monopole, dipole, and quadrupole components (with respect
to the design orbit) that involve tensors, and the method of Ref. [3] can, in principle, deal
with such problems. However, to simplify, in this report we will limit consideration to
geometries for which the design orbit lies on a vertical symmetry plane of the boundaries,
deﬁned by (horizontal coordinate) x = 0. Then the transverse (vertical, y) impedance (with
respect to the reference trajectory) can be written as

Z⊥,tot = Z⊥,m + y1Z⊥,d + y2Z⊥,q ,

(1)

where the three terms are called the (transverse) monopole, dipole, and quadrupole contri-
butions; where y1 is a small oﬀset of particle 1 (the leading particle), and y2 a small oﬀset
of particle 2 (the trailing particle, see Fig. 2). Note that the horizontal impedance has an
equation equivalent to Eq. (1), with the quadrupole term equal to (−Z⊥,q).

FIG. 2: Sketch of a transition showing the relationship of the design trajectory and the vertical
oﬀsets of particle 1, y1, and particle 2, y2 (the particles are indicated by red dots). For the
calculations the oﬀsets y1, y2, are assumed to be small.

For most of the examples of this paper, the system has also a horizontal symmetry plane
and the design orbit lies in this plane. In such a case Z⊥,m = 0; if, in addition, y1 = y2 = y0
we can deﬁne a normalized total impedance

Z⊥ =

= Z⊥,d + Z⊥,q .

Z⊥,tot
y0

(2)

By convention, this is the normal deﬁnition of total transverse impedance for bi-symmetric
problems. (In this paper, however, we will calculate the individual terms Z⊥,d and Z⊥,q as
well as Z⊥ for bi-symmetric problems.) The transverse wake at position s within a bunch
(s < 0 is toward the head), normalized to the oﬀset y0, in the optical regime is given by

W⊥(s) =

Z⊥(ω)˜λz(ω)e−iωs/c dω = (ωZ⊥)

λz(s(cid:48)) ds(cid:48) ,

(3)

i
2π

(cid:90) ∞

−∞

(cid:90) s

−∞

with ˜λz(ω) the Fourier transform of the line charge density λz(s). To arrive at the last
expression in this equation we have used the fact that, in the optical regime, Z⊥ ∝ ω−1.
Thus the quantity (ωZ⊥) is independent of frequency. The result is proportional to the
integral of the line charge density (and in the longitudinal case, it is proportional to the

4

line charge density itself). The kick factor κ⊥, the average kick experienced by the beam
per unit charge per unit oﬀset, is the integral of W⊥(s) when weighted by the longitudinal
charge density. In the optical regime the kick factor is simply given by the constant

κ⊥ =

(ωZ⊥)
2

.

In Ref. [3] using the Panofsky-Wenzel theorem [11], the transverse monopole, dipole, and
quadrupole terms are related to longitudinal monopole, dipole, and quadrupole impedances:

Z⊥,m =

Z(cid:107),m ,

Z⊥,d =

Z(cid:107),d ,

Z⊥,q =

Z(cid:107),q .

c
ω

2c
ω

c
ω

The longitudinal impedances can, in turn, be obtained from integrals involving the Green
functions to Poisson’s equation (the potentials) in regions A and B of the transition of
interest. In the case of the monopole part

Z(cid:107),m =

∇ϕm,B · ∇ϕd,B dS −

∇ϕm,A · ∇ϕd,B dS

,

(6)

(cid:20)(cid:90)

1
2πc

SB

(cid:90)

SG

with the integrals taken over the cross-section areas SB and SG, respectively. Here the
monopole and quad potentials in region A are given by the solutions to

∇2ϕm,A = −4πδ(y)δ(x) ,

∇2ϕd,A = 4πδ(cid:48)(y)δ(x) ,

with boundary conditions ϕm,A = 0, ϕd,A = 0, on metallic boundary CA that encloses SA.
Similar equations hold for ϕm,B and ϕd,B of region B.

In the case of the dipole part of the impedance

Z(cid:107),d =

(cid:20)(cid:90)

1
2πc

SB

(∇ϕd,B)2 dS −

∇ϕd,A · ∇ϕd,B dS

.

(cid:21)

For the quad part of impedance

(cid:20)(cid:90)

1
2πc

SB

Z(cid:107),q =

∇ϕm,B · ∇ϕq,B dS −

∇ϕm,A · ∇ϕq,B dS

.

The quadrupole potential in region B is given by the solution to

∇2ϕq,B = −2πδ(cid:48)(cid:48)(y)δ(x) ,

(cid:90)

SG

(cid:90)

SG

(4)

(5)

(7)

(8)

(9)

(10)

with ϕq,B = 0 on boundary CB. Finally, the longitudinal impedance on the reference
trajectory is given by:

Z(cid:107),long =

(∇ϕm,B)2 dS −

∇ϕm,A · ∇ϕm,B dS

.

(11)

(cid:20)(cid:90)

1
2πc

SB

(cid:90)

SG

To obtain the needed potentials ϕm, ϕd, ϕq, we begin with the Green function solution

to

∇2G(x, y, y0) = −4πδ(x)δ(y − y0) ,

(12)

where G = 0 on the boundary C of the surface of interest S. Here the source particle is
located at x = 0, y = y0. For region S, ϕm(x, y) = G(x, y, 0),

ϕd(x, y) =

(cid:20) ∂
∂y0

(cid:21)
G(x, y, y0)

y0=0

,

ϕq(x, y) =

G(x, y, y0)

.

(13)

1
2

(cid:20) ∂2
∂y2
0

(cid:21)

y0=0

(cid:21)

(cid:21)

(cid:21)

5

As was shown in Ref. [3], with the help of Green’s ﬁrst identity [12],

(cid:90)

S

(cid:90)

C

(φ∇2ψ + ∇φ · ∇ψ) dS =

φn · ∇ψ dl ,

(14)

the surface integrals involved in the impedance equations can be converted to line integrals.
In this formula φ and ψ are functions that can be diﬀerentiated twice; S is a surface over
which a surface integration is performed; C is the contour that encloses S and over which a
line integral is performed; and n is a unit normal vector pointing outward from the contour.
This device is used throughout the examples of this report.

Numerical Comparisons

A great number of ECHO simulations were performed to test and verify our results. ECHO
is a 3D, time-domain ﬁnite diﬀerence program that calculates wakeﬁelds generated by an
ultra-relativistic bunch passing through the structure. ECHO has two features that make
these 3D, optical regime simulations tractable. (1) A method to reduce the so-called “mesh
dispersion”—errors generated in time-domain mesh programs that are especially diﬃcult
(2) An indirect
to deal with for the combination of short bunches and long structures.
method of calculating wakes in 3D structures that eliminates long downstream beam pipes,
which would be needed in the case of direct wake calculation with very short bunches. Since
the ECHO simulations play a supporting role in the present report, other than comparing
results, we will only discuss them brieﬂy. For a more detailed report on ECHO, see e.g.
Ref. [10].

A few comments on the parameters used in the ECHO simulations: The bunches in the
simulations are Gaussian. Typically we choose σz = g/10, with g the minimum vertical half
aperture of the iris or transition. For a ﬂat iris or beam pipe we take the structure half-width
w = 10g. (In this report we use the word ﬂat to mean “having a rectangular cross-section
with a small height to width ratio.”) For a small iris in a beam pipe or a transition opening
into a large beam pipe, the beam pipe is square with half-height 10g. We take mesh sizes to
be 1
8 σz, in the longitudinal, horizontal, vertical directions, respectively. Irises have
the thickness of one longitudinal mesh size. For bi-symmetric structures ECHO calculates
the dipole and quadrupole components of the wakes independently.

5 σz, 5

8 σz, 5

To demonstrate the validity of the optical approximation, and how one moves out of the
optical regime as the bunch length increases, we consider the problem of a thin round iris
of radius g in a round beam pipe of radius b. We choose b/g = 4. We perform ECHO
calculations for bunch lengths in the range σz/g = 0.02 to 4. In Fig. 3 we plot twice the
kick factor of our results as function of bunch length. According to Eq. 4, in the optical
regime 2k⊥ = ωZ⊥, which is a number independent of bunch length or frequency. We see
that the result of our numerical calculation is fairly constant up until σz/g ∼ 0.2, after
which the validity of the optical approximation starts to break down. In more detail, we
give in Fig. 4 the actual wake functions for four example bunch lengths as obtained by
ECHO. The (Gaussian) bunch shape, with the head to the left, is indicated by the black
dashes. The analytical wake of a Gaussian bunch in a round iris in the optical regime,
2σz)]/g2, with erf(x) the error function, is also given (the red dashes).
W⊥ = [1 + erf(s/
We see that, although the weighted average of the wake agrees well for σz/g ∼ 0.2, good
agreement between the wakes over ±4σz is not obtained until σz/g ∼ 0.04.

√

6

FIG. 3: Twice the kick factor k⊥ of a thin round iris in a beam pipe vs. rms bunch length σz, as
obtained by ECHO. The iris radius is g.

FIG. 4: Transverse wake of a thin round iris in a beam pipe as obtained by ECHO. Results for bunch
lengths over iris radius σz/g = 0.04, 0.16, 0.4, and 0.8 are given. The (Gaussian) bunch shape, with
the head to the left, is indicated by the black dashes. The analytical wake of a Gaussian bunch in
2σz)]/g2, with erf(x) the error function, is
a round iris in the optical regime, W⊥ = [1 + erf(s/
also given (the red dashes).

√

III.

IRIS/SHORT COLLIMATOR IN BEAM PIPE

We begin by performing calculations of examples with thin irises or short collimators in a
beam pipe (for an example, see Fig. 5). In these cases the solution is given by a particularly
simple “clipping” type calculation of the energy impinging on the iris wall.

For these examples the beam pipes in Region A and B are identical, i.e. SB = SA. Thus

Eqs. (5), (8), (9), give

Z⊥,d =

(cid:90)

1
2πω

SB −SG

(∇ϕd,B)2 dS ,

Z⊥,q =

(cid:90)

1
πω

SB −SG

∇ϕm,B · ∇ϕq,B dS .

7

(15)

(16)

FIG. 5: An iris in a beam pipe.

(cid:90)

1
2πω

CG

(cid:90)

1
πω

CG

Both equations involve integrals over the metallic surface of the iris. Using Green’s ﬁrst
identity and considering the fact that ∇ϕ2 = 0 in any region that precludes the axis, we
can write Eqs. (15), (16), as one dimensional integrals. For example, Eq. (15) becomes

Z⊥,d =

ϕd,Bn · ∇ϕd,B dl ,

(17)

where the integral on the right is a line integral over the curve that encloses the area of SG,
which we denote by CG, and n is a unit vector normal to this curve in the direction of the
axis (an identical integral over CB was dropped, since ϕd,B = 0 on CB). Similarly,

Z⊥,q =

ϕm,Bn · ∇ϕq,B dl .

(18)

The examples dealt with in this section are: (I1) a small, ﬂat iris (or horizontal slot)
in a beam pipe, (I1b) the same but with the design orbit shifted vertically, (I2) a small
rectangular iris, (I3) a small elliptical iris, (I4) a ﬂat iris (not necessarily small) in a ﬂat
beam pipe. In all cases except I1b, the design orbit is on a horizontal symmetry plane. A
cross-section view of the geometries is sketched in Fig. 6. Dimension labels and the design
orbit location are also shown.

In the following subsections (except for subsection I4) we will assume that the pipe radius
is very large compared to the iris aperture. We can use the free-space Green function for a
particle vertically oﬀset by y0:

G(x, y, y0) = − ln[x2 + (y − y0)2] .

From this Green function we obtain the potentials:

ϕm = − ln(x2 + y2) , ϕd =

2y

x2 + y2 , ϕq =

y2 − x2
(x2 + y2)2 .

Then using these potentials, we perform the calculations of Eqs. (17), (18).

(19)

(20)

8

FIG. 6: Cross-section views of the iris/short collimator geometries considered in this section (for
case I4 a longitudinal view is also given). Dimension labels are given, and the design orbit location
is indicated by the red dot. In cases I1-I3 the beam pipe aperture is speciﬁed as large compared to
the iris aperture; in case I4 the beam pipe is ﬂat, with vertical aperture 2b. For case I4 two colors
are used for the boundaries as an aid in visualization.

The error in transverse impedance introduced by the approximation of the free-space
Green function is relatively small. For example, in the case of a round (i.e. cylindrically
symmetric) iris of radius g within a round beam pipe of radius b it is known that the
correction to the ﬁrst order term is (g/b)4 [8].

I1. Flat Iris or Horizontal Slot in Large Pipe

Consider a large beam pipe containing an iris with a horizontal slot of vertical size 2g,
with g very small compared to the beam pipe size. We take the reference trajectory to be

9

the symmetry line, so the monopole term Z⊥,m = 0. The dipole term is given by

Z⊥,d = −

ϕd,B(x, g)

(x, g) dx ,

2
πω

(cid:90) ∞

0

∂ϕd,B
∂y

and similarly for the quadrupole term. With the free-space potentials the integrals can be
performed analytically, and after some algebra we obtain

(21)

(22)

Z⊥,d = Z⊥,q =

1
ωg2 , Z⊥ =

2
ωg2 .

We see that the dipole and quad terms are equal, and that the total result is the same as
the leading order impedance for a round, thin iris of radius g [8]. Note that for a ﬂat iris
that is oriented vertically, we have Z⊥,d = −Z⊥,q = 1/(ωg2) and Z⊥ = 0.

I1b. Case of Shifted Design Orbit

We can also ﬁnd the impedance for the case the design orbit is shifted vertically by ∆y.
In this case the (transverse) monopole term Z⊥,m dominates the transverse impedance, and
we can neglect the eﬀect of Z⊥,d and Z⊥,q [see Eq. (1)]. The transverse monopole term is
obtained using Eqs. (5), (6). Then the calculation proceeds in the same manner as before:

Z⊥,m = −

(cid:90) ∞

(cid:20)
ϕd,B(x, g − ∆y)

1
πω

0

(x, g − ∆y)

(23)

+ ϕd,B(x, −g − ∆y)

(x, −g − ∆y)

dx .

(cid:21)

∂ϕm,B
∂y
∂ϕm,B
∂y

We ﬁnd that the transverse impedance is given by

Z⊥,m =

(cid:20)

1
ω

1
g − ∆y

−

1
g + ∆y

(cid:21)

.

(24)

For small ∆y, Z⊥,m = 2∆y/(ωg2), which is consistent with our earlier results.

I2. Rectangular Iris

For the case of a rectangular iris with a small aperture of 2w by 2g (horizontal by vertical)
the calculation follows the same procedure as before; however, the integration now is a line
integral along the rectangular aperture. We perform integrals like

Z⊥,d = −

ϕd,B(x, g)

(x, g) dx +

ϕd,B(w, y)

(w, y) dy

.

(25)

2
πω

(cid:20)(cid:90) w

0

∂ϕd,B
∂y

(cid:90) g

0

∂ϕd,B
∂x

(cid:21)

The ﬁnal solution is

Z⊥,d =

Z⊥,q =

Z⊥ =

2
πωg2
2
πωg2
4
πωg2

α + arccot(α) + α2 arctan(α)
α2

α(−1 + α2) + (1 + α2)[−arccot(α) + α2 arctan(α)]
α2(1 + α2)

α + (1 + α2) arctan(α)
1 + α2

10

(26)

FIG. 7: For a rectangular iris in a beam pipe, the transverse impedances Z⊥, Z⊥,d, Z⊥,q, normalized
to 2/(ωg2), as functions of β = (w − g)/(w + g). Plotting symbols give ECHO numerical results.

where α = w/g.

The results, when normalized to 2/ωg2, are plotted as functions of β = (w − g)/(w + g)
in Fig. 7. Note that when β = 1 the results agree with the results for the iris with the
inﬁnitely wide horizontal slot, given above. For β = −1 (an inﬁnitely high vertical slot)
Z⊥,q = −Z⊥,d = −1/(ωw2) and Z⊥ = 0. For the special case of a square aperture Z⊥ =
Z⊥,d = 2( 1
2 )/g2 and Z⊥,q = 0. Note that the horizontal impedance is obtained from
Eqs. (26) by exchanging w and g.

π + 1

In Fig. 7 ECHO numerical results for Z⊥,d and Z⊥,q are shown by the plotting symbols.

We see good agreement with the results of our method.

I3. Elliptical Iris

The impedance calculation for an elliptical iris with a small aperture, with axes w by
g (horizontal by vertical), follows in a similar manner to the rectangular iris case. The
equations that need to be solved are Eqs. (17), (18). We see that the elliptical case is more
complicated in that it requires the formation of n · ∇ϕq,B and of the length metric on the
ellipse of the iris, though the ﬁnal solution is quite simple. We ﬁnd that

Z⊥,d =

1
ωg2

(cid:18)

1 +

(cid:19)

g2
w2

, Z⊥,q =

1
ωg2

(cid:18)

1 −

(cid:19)

g2
w2

, Z⊥ =

2
ωg2 .

(27)

We ﬁnd that for an elliptical iris Z⊥ is independent of the size of the horizontal axis w!
As was true for the rectangular iris, the horizontal impedance of the elliptical iris can be
obtained by exchanging w and g in the solution equations. In Fig. 8 we plot the analytical
results and compare with ECHO numerical results. We see good agreement.

11

FIG. 8: For an elliptical iris in a beam pipe, the transverse impedances Z⊥, Z⊥,d, Z⊥,q, normalized
to 2/(ωg2), as functions of β = (w − g)/(w + g). Plotting symbols give ECHO numerical results.

I4. Flat Iris in Flat Beam Pipe

Consider a ﬂat iris of height 2g centered within a ﬂat beam pipe of height 2b. We begin

this problem with the Green function between two parallel plates of aperture 2b [13]

G(x, y, y0) = ln

(cid:34)

cosh πx
cosh πx

2b + cos π(y+y0)
2b − cos π(y−y0)

2b

2b

(cid:35)

.

The calculation procedure is the same as for the free-space-to-ﬂat-iris example, Example I1.
The potentials are

ϕm,B(x, y) = ln

ϕd,B(x, y) =

ϕq,B(x, y) =

π
2b
π2
8b2

(cid:20) cosh πx
cosh πx

(cid:21)

2b

2b + cos πy
2b − cos πy
sin πy
b
2b − cos2 πy

2b

2b

cosh2 πx
(−2 + cosh πx

b + cos πy

b ) cosh πx

2b cos πy
(cid:1)2

2b

.

(cid:0)cosh2 πx

2b − cos2 πy

2b

The ﬁnal solution is

Z⊥,d =

Z⊥,q =

Z⊥ =

πα2
2ωg2 csc2(πα)[2π(1 − α) + sin(2πα)]
πα2
ωg2 csc(πα)[1 + π(1 − α) cot(πα)]
πα2
2ωg2 csc2(πα/2)[π(1 − α) + sin(πα)]

where α = g/b. These curves are plotted in Fig. 9. The round case, with g and b, represent-
ing, respectively, the radii of the iris and of the beam pipe, (Z⊥)round = 2(1/g2−g2/b4)/ω [8],
is also shown (the dashes). We note that Z⊥ is always close to and larger for the ﬂat than
for the round case.

12

(28)

(29)

(30)

FIG. 9: For a ﬂat iris with aperture 2g in a ﬂat beam pipe of aperture 2b, the transverse impedances
Z⊥, Z⊥,d, Z⊥,q as functions of α = g/b. Plotting symbols give ECHO numerical results. The round
case, (Z⊥)round = 2(1/g2 − g2/b4)/ω, is also shown (dashes).

In Fig. 9 ECHO numerical results for Z⊥,d and Z⊥,q are again shown by plotting symbols.
We see basically good agreement with the results of our method. We should point out one
subtlety however. For g/b = 0.8 the numerically obtained wake begins to take on some
inductive character and the result for impedance begins to deviate from our analytical
solution (particularly Z⊥,d). We attribute this to the fact that, for the parameters used in
the simulations, (b − g)/b = σz; as (b − g)/b (cid:46) σz we are beginning to leave the optical
regime.

Longitudinal Impedance

If we know the geometry of both the beam pipe and the iris we can also obtain the
longitudinal impedance, Z(cid:107),long. For the longitudinal impedance we begin with Eq. (11),
which we convert to a line integral, and obtain

Z(cid:107),long = −

(cid:90) ∞

2
πc
(cid:90) ∞

0

ϕm,B

∂ϕm,B
∂y

(x, g) dx

=

8
c

0

sin πα cosh πx
cos 2πα − cosh 2πx

ln

(cid:18) cosh πx − cos πα
cosh πx + cos πα

(cid:19)

dx ,

(31)

with α = g/b. The last integral we evaluate numerically. The result, when normalized to
4/c, is shown in shown in Fig. 10. For comparison, the round case impedance (with g and
b representing, respectively, the iris and beam pipe radius), is also shown. We see that the
longitudinal impedance in the ﬂat case is always less than in the round case.

13

FIG. 10: For a thin ﬂat iris with aperture 2g in a ﬂat beam pipe of aperture 2b, the longitudinal
impedance Z(cid:107),long as function of α = g/b. The round case, (Z(cid:107))round = 4 ln(b/g)/c, is also shown
(dashes).

IV. STEP-IN TRANSITION

For the dipole component of impedance of a step-in transition we replace, in Eq. (8), SG

by SB, and use Green’s ﬁrst identity to obtain

Z(cid:107),d =

(cid:20)(cid:90)

1
2πc

CB
(cid:90)

CB

ϕd,Bn · ∇ϕd,B dl −

ϕd,B∇2ϕd,B dS

−

ϕd,Bn · ∇ϕd,A dl +

ϕd,B∇2ϕd,A dS

= 0

(32)

(cid:21)

(cid:90)

SB
(cid:90)

SB

The ﬁrst and third integrals are zero because ϕd,B = 0 on boundary CB; the second and
fourth integrals cancel because the Laplacian is the same independent of region.

The same kind of analysis shows that Z(cid:107),q = 0 in a step-in transition, and that Z(cid:107),m = 0
also in non-symmetric step-in transitions. Since speciﬁcs of the geometry were not used in
our derivation, we conclude that the total transverse impedance is zero for a (short) step-
in transition of any geometry. Similarly the longitudinal impedance of any short step-in
transition is also zero in the optical regime (something that has been known to be true for
the special case of a round step-in transition [4], [5]). We conclude that the longitudinal
and transverse impedance of any step-in transition, in the optical regime, is zero!

The impedance of a long collimator is just the sum of the impedances of a step-in and a
step-out transition. Since the impedance of a step-in transition is zero, the impedance of a
long collimator is the same as that of a step-out transition alone, the impedance of which
we will study in the following section.

V. STEP-OUT TRANSITION

An example step-out transition is sketched in Fig. 11 (the particles move in the +z
direction). The examples dealt with in this section are: (T1) a ﬂat beam pipe that transitions
to larger ﬂat beam pipe, (T2) a rectangular pipe that transitions to a large pipe, and (T3) an
elliptical pipe that transitions to a large pipe. Cross-section views of the geometries (and

14

a longitudinal view in case (T1) are sketched in Fig. 12. Dimension labels and the design
orbit location are also shown.

FIG. 11: A step-out transition. The particles move in the +z direction.

For the impedance of a step-out transition we replace, in Eq. (8), SG by SA. The
impedance function (in the dipole case) Z(cid:107),d of a step-out transition can be written, be-
ginning with Eq. (8), as

Z(cid:107),d =

(∇ϕd,B)2 dS −

∇ϕd,A · ∇ϕd,B dS

(cid:21)

(cid:20)(cid:90)

SB

(cid:20)(cid:90)

1
2πc
1
2πc

=

SB
(cid:90)

SA

(cid:90)

(cid:90)

SA

SA

(∇ϕd,B)2 dS −

(∇ϕd,A)2 dS

−

∇ϕd,A · ∇(ϕd,B − ϕd,A) dS

.

(cid:21)

(33)

(34)

By using Green’s identity one can easily see that the last integral is zero. Thus

Z(cid:107),d =

(cid:20)(cid:90)

1
2πc

SB

(∇ϕd,B)2 dS −

(∇ϕd,A)2 dS

.

(cid:21)

(cid:90)

SA

This result can be interpreted as 2/c times the static ﬁeld energy of a dipole in region B
minus that of a dipole in region A. This principle—that the longitudinal impedance (here
longitudinal dipole impedance) of a step-out transition in the optical regime is given by
twice the diﬀerence in the static ﬁeld energy in the two regions—was ﬁrst elaborated for
the round step-out transition (longitudinal case) by Heifets and Kheifets [5]. The principle
was then used for obtaining higher order wakes (azimuthal mode number m > 0) of (long)
round collimators [7], and also for speciﬁc 3D structures [8].

We see that a main diﬀerence in the calculation of the impedance of a step-out transition
and of an iris is that, in the former case the surface integrals are performed over a region
that includes the source charges of the potentials, and in the latter case the region of the
charges is excluded. In the step-out transition case, however, it turns out that even though

15

FIG. 12: Cross-section views of the step-out transition geometries considered in this section (for
case T1 a longitudinal view is also given). Dimension labels are given, and the design orbit location
is indicated by the red dot. In cases T2-T3 the outgoing beam pipe aperture is speciﬁed as large
compared to the incoming beam pipe aperture; in case T1 the outgoing beam pipe is ﬂat, with
vertical aperture 2b. For case T1 two colors are used for the boundaries as an aid in visualization.

the potentials diverge at the source charges, for the impedance two terms with the same
divergence are subtracted, and the impedance is ﬁnite.

By regrouping integrals and using Green’s identity we can write the impedance of a step-
out transition in terms of a simple line integral. The impedance function (for example, in
the dipole case) can be written, beginning with Eq. (8), as

Z(cid:107),d =

(cid:20)(cid:90)

(cid:20)(cid:90)

1
2πc
1
2πc

=

SB −SA

CB −CA
(cid:90)

(∇ϕd,B)2 dS −

∇ϕd,B · ∇(ϕd,A − ϕd,B) dS

(cid:21)

(cid:90)

SA

(cid:90)

ϕd,Bn · ∇ϕd,B dl −

ϕd,B∇2ϕd,B dS

−

ϕd,Bn · ∇(ϕd,A − ϕd,B) dl +

ϕd,B∇2(ϕd,A − ϕd,B) dS

SB −SA
(cid:90)

SA

= −

1
2πc

CA

(cid:90)

CA

ϕd,Bn · ∇ϕd,A dl .

(cid:21)

(35)

To go from the second to the third form of the impedance in this equation, we use the fact
that ϕd,B = 0 on CB, that ∇2ϕd,B = 0 in the region SB − SA, and that ∇2(ϕd,A − ϕd,B) = 0
everywhere.

However, we can obtain formulas for the impedance of a step-out transition that are even

16

simpler. The dipole part of the impedance, for example, can be written as

ϕd,Bn · ∇ϕd,B dl −

ϕd,B∇2ϕd,B dS

Z(cid:107),d =

(cid:20)(cid:90)

1
2πc

CB
(cid:90)

CA

(cid:90)

SB
(cid:90)

SA

−

ϕd,An · ∇ϕd,B dl +

ϕd,A∇2ϕd,B dS

.

(36)

The line integrals are zero again. Combining the remaining terms and substituting for ∇2ϕ
from Eq. (7), we obtain

Z⊥,d = lim
x,y→0

2
ω

∂
∂y

[ϕd,B(x, y) − ϕd,A(x, y)] .

(37)

Both dipole potential terms diverge in the limit x, y → 0; however, the divergences are the
same, and Z⊥,d is ﬁnite.

For the quad component of impedance of a step-out transition we replace, in Eq. (9), SG

by SA, and use Green’s ﬁrst identity to obtain

Z(cid:107),q =

(cid:20)

(cid:90)

−

1
2πc

SB

(cid:90)

SA

ϕq,B∇2ϕm,B dS +

ϕm,A∇2ϕq,B dS

,

(38)

where the line integral terms are again zero. Substituting for the Laplacians from Eqs. (7),
(10), using the relation limx,y→0[∂2ϕm,A(x, y)/∂y2 − 2ϕq,A(x, y)] = 0, and going to Z⊥,q we
obtain

(cid:21)

(cid:21)

Z⊥,q = lim
x,y→0

[ϕq,B(x, y) − ϕq,A(x, y)] .

Similarly, the transverse monopole impedance is

Z⊥,m = lim
x,y→0

[ϕd,B(x, y) − ϕd,A(x, y)] ;

the longitudinal impedance is given by

Z(cid:107),long = lim
x,y→0

[ϕm,B(x, y) − ϕm,A(x, y)] .

4
ω

2
ω

2
c

(39)

(40)

(41)

We see that, once the Green functions are known, obtaining the impedances of step-out
transitions (as well as long collimators) is a relatively straightforward matter. Whereas an
equation of the form Eq. (34) can be interpreted to mean that the longitudinal impedance
in the optical regime is 2/c times the static ﬁeld energy of a charge distribution in region B
minus that of one in region A, these simpler equations can be interpreted to mean that the
longitudinal impedance is 2/c times the potential diﬀerence at the charge distribution in
region B minus that at the charge in region A.

As was the case with the irises/short collimators, for a transition into a large beam pipe,
one also doesn’t need to know details of the large beam pipe in order to calculate the leading
order behavior of a transverse impedance. In the equations for impedance one can take the
potentials in region B to be derived from the free-space Green function, given in Eq. (19).

17

T1. Flat Transition

In the case of a ﬂat, symmetric, step-out transition going from aperture 2g to 2b, we

substitute the potentials Eqs. (29) into Eqs. (37), (39). We obtain

Z⊥ =

π2
2ω

(cid:18) 1

g2 −

(cid:19)

1
b2

,

(42)

with Z⊥,q = 1
2 Z⊥,d. We see thus that the transverse impedance of a ﬂat step-out transition
(or of a long, ﬂat collimator) is a factor π2/8 times the transverse impedance of a long,
round collimator, if we take the half-heights in the former case to be equal to the radii
in the latter [6]. In Fig. 13 we plot the theoretical dependence and compare with ECHO
numerical results (the plotting symbols). We see that the agreement is very good.

FIG. 13: For a step-out transition from a ﬂat pipe of aperture 2g into a ﬂat pipe of aperture 2b,
the transverse impedances Z⊥, Z⊥,d, Z⊥,q as functions of α = g/b. Plotting symbols give ECHO
numerical results for comparison.

If we perform the longitudinal impedance calculation for the ﬂat step-out transition we
ﬁnd that Z(cid:107),long = 4 ln(b/g)/c, which is the same as for the round case, if we take the
half-heights in the ﬂat case to be equal to the radii in the round one.

For a design orbit that is shifted by ∆y from the symmetry axis, we ﬁnd, using Eq. (40),

Z⊥,m =

(cid:20) 1
g

π
ω

tan

−

tan

π∆y
2g

1
b

(cid:21)

.

π∆y
2b

(43)

Note that for a beam close to the wall at e.g. y = g, Z⊥,m = 2/[ω(g − ∆y)], which is twice
as large is we found for the close-to-the-wall impedance in the case of an iris (see Eq. (24)).

T2. Rectangular Transition

Consider a rectangular pipe of width 2w and height 2g that transitions into a large beam
pipe, and a design orbit that follows the symmetry line of the rectangular pipe. The Green’s
function for Poisson’s equation in a rectangular pipe has been obtained by Gluckstern, et

18

al [14]. Their result is:1

G(x, y, y0) = −4

n=1

∞
(cid:88)

sin

e− nπw

2g cosh nπx
2g
n cosh nπw
2g
(cid:2)x2 + (y − y0)2(cid:3) sinh2 πx
sinh2 πx

nπ
2g

(cid:40)

+ ln

− ln (cid:2)x2 + (y − y0)2(cid:3) .

(y + g) sin

(y0 + g)

nπ
2g

4g + cos2 π
4g + sin2 π

4g (y + y0)
4g (y − y0)

(cid:41)

(44)

The last term contains the singularity. The other terms are everywhere ﬁnite, and the sum
in the ﬁrst term converges well.

For our calculation we take region B to have the free space Green function, i.e. the same
as the last term in Eq. (44). Thus we have no singularities left in our impedances, since
they all involve the diﬀerence of potentials in the two regions. Our ﬁnal result is

Z⊥,d =

1 + 24

(cid:34)

(cid:34)

π2
3ωg2

π2
6ωg2

m
1 + e2πmα

(cid:35)

,

2m − 1
1 + eπ(2m−1)α

(cid:35)

,

∞
(cid:88)

m=1
∞
(cid:88)

m=1

Z⊥,q =

1 − 24

(45)

with α = w/g. We perform the sums numerically. The results, when normalized to
π2/(2ωg2), are plotted as functions of β = (w − g)/(w + g) in Fig. 14 (Z⊥ = Z⊥,d + Z⊥,q).
Note that when β = 1 the results agree with the leading order behavior for the ﬂat transi-
tion, given above. For β = −1 (a step-out transition from an inﬁnitely high vertical beam
pipe) Z⊥,q = −Z⊥,d = −π2/(6ωw2) and Z⊥ = 0. For the special case of a square beam pipe
Z⊥ = Z⊥,d = (0.697)π2/(2ωg2), which is 86% of the result for a round pipe with radius g,
4/(ωg2); and Z⊥,q = 0. The plotting symbols in the ﬁgure give ECHO numerical results,
and we see good agreement. Finally, note that the horizontal impedance is obtained from
Eqs. (45) by exchanging w and g.

1 Note that there is a typo in their Eq. (5.11).

19

FIG. 14: For a rectangular step-out transition to a large beam pipe, the leading order dependence
of the transverse impedances Z⊥, Z⊥,d, Z⊥,q, normalized to π2/(2ωg2), as functions of β = (w −
g)/(w + g). The plotting symbols give ECHO numerical results for comparison.

T3. Elliptical Transition

Consider an elliptical pipe of horizontal axis w and vertical axis g that transitions into a
large beam pipe, and a design orbit that follows the symmetry line of the elliptical pipe. The
Green’s function for Poisson’s equation in an elliptical pipe has been obtained by Gluckstern,
et al [14]. For the case w ≥ g it is given by 2

G(x, y, y0) = −4

(cid:34)

∞
(cid:88)

e−nu0
n
− ln (cid:2)x2 + (y − y0)2(cid:3) ,

n=1

ReTn( x+iy

d ) ReTn( iy0
d )
cosh nu0

+

ImTn( x+iy

d ) ImTn( iy0
d )
sinh nu0

(cid:35)

with Tn the Chebyshev polynomials of the ﬁrst kind, d2 = w2 − g2, and u0 = arccoth (w/g).
[Note that G, as given here, is not zero but constant on the elliptical boundary, a fact,
however, that does not aﬀect our results.] The calculation procedure is the same as for the
rectangular step-out transition. In the elliptical case we ﬁnd that
d )(cid:3)

∞
(cid:88)

ˆϕd(x, y) = 8

ˆϕq(x, y) = −4

(−1)mIm (cid:2)T2m−1( x+iy
e2(2m−1)u0 − 1
(−1)mRe (cid:2)T2m( x+iy
e4mu0 + 1

d )(cid:3)

,

,

m=1
∞
(cid:88)

m=1

(46)

(47)

with ˆϕ signifying the part of the potential that does not contain the singularity. Note that
the horizontal (x) impedance of a step-out transition is equal to the (vertical) impedance
of the transition after it has been rotated by 90◦. Thus to obtain the impedances for an

2 Note that there is a typo in their version of this equation, their Eq. (4.36).

20

elliptical step-out transition with w < g we calculate the x impedances for the rotated case,
following the analogous procedure to what we use for ﬁnding the y impedances.

We ﬁnally obtain

Z⊥,d =

16
ωg2(α2 − 1)

Z⊥,q =

32
ωg2(α2 − 1)

∞
(cid:88)

m=1

∞
(cid:88)

m=1

2m − 1
(cid:17)2m−1

,

− 1

(cid:16) α+1
α−1

m
(cid:17)2m

,

+ 1

(cid:16) α+1
α−1

(48)

with α = w/g (valid for all α). We have simpliﬁed the results by using the relation e2u0 =
(α + 1)/|α − 1|. The sums are performed numerically. The results are plotted as functions
of β = (w − g)/(w + g) in Fig. 15. The plotting symbols in the ﬁgure give ECHO numerical
results, and we see good agreement. We see that we obtain the expected results for the
round case (β = 0), Z⊥,d = 4/(ωg2) and Z⊥,q = 0; for the ﬂat case (β = 1), Z⊥,d = 2Z⊥,q =
π2/(3ωg2). For the case of a horizontally inﬁnitesimally narrow elliptical pipe (β = −1) we
ﬁnd that Z⊥,d ≈ −Z⊥,q = 1/(ωw2), and that the total impedance Z⊥ = 2/(ωg2). Note that
in this limit Z⊥ has the same value as we obtained for any small elliptical iris in a beam pipe
(see Eq. (27)). Details of how all three limits are arrived at can be found in the Appendix.

FIG. 15: For an elliptical step-out transition to a large beam pipe, the leading order dependence
of the transverse impedances Z⊥, Z⊥,d, Z⊥,q, normalized to π2/(2ωg2), as functions of β = (w −
g)/(w + g). The plotting symbols give ECHO numerical results for comparison.

VI. MORE COMPLICATED TRANSITIONS

In this section we give two examples that are neither an iris/short collimator in a beam
pipe, nor a step-in or step-out transition. The examples are: (U1)–misaligned ﬂat beam
pipes, and (U2)–LCLS-type rectangular-to-round transitions. See Fig. 16. A cut-away
perspective view of a pair of the LCLS transitions is also given in Fig. 17.

21

FIG. 16: Cross-section view (from upstream end; left ﬁgures) and longitudinal view (right ﬁgures) of
more complicated transitions: U1–misaligned ﬂat pipes, and U2–LCLS-type rectangular-to-round
transitions. Dimension labels are given; the design orbit location is indicated by the red dot. Two
colors are used as an aid in visualization.

FIG. 17: A matching pair of LCLS rectangular-to-round transitions in cut-away perspective view.
The distance L between transitions is much larger than the catch-up distance for the nominal bunch
length.

U1. Misaligned Flat Beam Pipes

Consider ﬁrst two ﬂat beam pipes with thick walls and aperture 2g that are perfectly
aligned and joined at z = 0. The design orbit lies in the horizontal symmetry plane. Now
imagine shifting the z > 0 pipe vertically by ∆y (|∆y| < g) and the z < 0 pipe by −∆y,
and keeping the design orbit unchanged. Note that the resulting transition no longer has a
horizontal symmetry plane.

Let us sketch out the calculation of the transverse impedance Z⊥,m for this structure (for

22

∆y > 0). The potentials for this problem are given by

ϕm,A(x, y) = G(x, y + ∆y, ∆y) , ϕd,A(x, y) =

∂G
∂y0

(x, y + ∆y, y0)

(cid:12)
(cid:12)
(cid:12)
(cid:12)y0=∆y
(cid:12)
(cid:12)
(x, y − ∆y, y0)
(cid:12)
(cid:12)y0=−∆y

,

∂G
∂y0

ϕm,B(x, y) = G(x, y − ∆y, −∆y) , ϕd,B(x, y) =

,

(49)

with the ﬂat pipe Green function G(x, y, y0) given by Eq. (28), but with b replaced by g.
Note that, for this geometry, the aperture SG is the intersection of SA and SB.

Beginning with Eq. (6), and using Green’s identity, we obtain

Z(cid:107),m =

ϕd,Bn · ∇ϕm,B dl −

ϕd,B∇2ϕm,B dS

ϕd,Bn · ∇ϕm,A dl +

ϕd,B∇2ϕm,A dS

.

(50)

(cid:21)

The ﬁrst integral above is zero, because ϕd,B is zero on boundary CB, and the second
and fourth integrals cancel. We are left with the third integral, which implies a transverse
impedance (see Eqs. 5):

Z⊥,m = −

ϕd,Bn · ∇ϕm,A dl

(cid:20)(cid:90)

CB

1
2πc
(cid:90)

−

CG

1
2πω
1
2πω

(cid:90)

CG
(cid:90) ∞

0

= −

ϕd,B(x, g − ∆y)

(x, g − ∆y) dx .

(51)

Note that the contribution of the integral at y = −g + ∆y is zero because this is a boundary
of region B. We obtain, ﬁnally, the analytical result (valid for either sign of ∆y)

Z⊥,m =

sgn(∆y) − π

1 +

+ π csc

[|∆y| < g] ,

(52)

(cid:20)

1
ωg

(cid:18)

(cid:19)

|∆y|
g

cot

π∆y
g

(cid:21)

π∆y
g

with sgn(x) meaning the sign of x. We note that Z⊥,m is positive for positive ∆y, and that
it is odd in ∆y. Also, note that as ∆y → g, Z⊥,m → 3/[ω(g − ∆y)]. The result of Eq. 52
(for ∆y > 0) is plotted in Fig. 18. Plotting symbols give ECHO results; we see excellent
agreement with our results. The function,

(cid:90)

SB

(cid:90)

SG

∂ϕm,A
∂y

(Z⊥)approx =

(cid:32)

3
ωg

1
1 − ∆y
g

−

1
1 + ∆y
g

(cid:33)

,

gives a good approximation to the impedance (see the dashes in the ﬁgure).

Obtaining the longitudinal impedance Z(cid:107),long for the misaligned pipe, one follows a similar

procedure. In this case we ﬁnd that the solution is given by

Z(cid:107),long = −

ϕm,B(x, g − ∆y)

(x, g − ∆y) dx

[∆y > 0]

(cid:90) ∞

0

1
πc
2 cos α
π

(cid:90) ∞

ln

0

∂ϕm,A
∂y
(cid:20) cosh x − sin α
cosh x + sin 3α

(cid:21)

= −

dx
cosh x − sin α

,

with α = 1
2 π∆y/g. We solve the integral numerically. The result, for ∆y > 0, is plotted
in Fig. 19. Note that Z(cid:107),long is even with respect to ∆y. The plotting symbols give ECHO
results, and we see reasonably good agreement with our results. As a scale comparison the
impedance of a round, step-out transition, from radius g to radius g + ∆y, (Z(cid:107),long)round =
4 ln(1 + ∆y/g)/c, is also given in the plot (the dashes).

(53)

(54)

23

FIG. 18: For the misaligned, ﬂat pipe of aperture 2g, the transverse impedance Z⊥,m as func-
tion of misalignment parameter ∆y/g. Plotting symbols give ECHO results. The approximation,
(Z⊥,m)approx, is also shown (dashes).

FIG. 19: For the misaligned, ﬂat pipe of aperture 2g, the longitudinal impedance Z(cid:107),long as function
of misalignment parameter ∆y/g. Plotting symbols give ECHO results. As a scale comparison the
impedance of a round, step-out transition, from radius g to radius g + ∆y, (Z(cid:107))round = 4 ln(1 +
∆y/g)/c, is also given (dashes).

U2. LCLS Rectangular-to-Round Transition

In the LCLS undulator region there are 33 pairs of rectangular-to-round transitions. The
rectangular aperture has horizontal width 2w = 10 mm by vertical height 2g = 5 mm; the
round aperture has radius a = 4 mm. The axes of the two pipes are aligned. The transitions
are abrupt. The bunch length in this region is 20 µm (rms). Thus our optical regime formulas
are applicable. Note that these transitions are neither step-in nor step-out transitions. In
the LCLS undulator region the longitudinal impedance is the more important one, and this
is the one we calculate here. A numerical ECHO calculation has found that the longitudinal
impedance of a pair of transitions (one rectangular-to-round and one round-to-rectangular
transition) equals 1.21/c [9].

24

Beginning with Eq. (11), and using Green’s ﬁrst identity, we obtain

Z(cid:107),long = −

ϕm,Bn · ∇ϕm,A d(cid:96) .

(55)

(cid:90)

1
2πc

CG

Here SG is the intersection of SA and SB. The integration path CG follows the rectangular
boundary at the top and bottom, and the circular boundary on the right and left (see
Fig. 16). In the rectangular-to-round case [or we can say the rectangular-to-circular (rtc)
case] with impedance Z(cid:107),rtc region A is the rectangular pipe, region B is the circular pipe.
In the circular-to-rectangular (ctr) case with impedance Z(cid:107),ctr the regions are reversed.

The circular monopole potential is given by ϕm,c = − ln[(x2 +y2)/a2]; and the rectangular
monopole potential, by ϕm,r = G(x, y, 0), with G given by Eq. (44). Then we have as
rectangular-to-circular impedance

Z(cid:107),rtc = −

ϕm,c(x, g)

(x, g) dx .

(56)

√

a2−g2

2
πc

(cid:90)

0

∂ϕm,r
∂y

The contribution from the circular part of the boundary is zero, since ϕm,c is zero on this
boundary. In the circular-to-rectangular case

√

(cid:90) arctan(g/

a2−g2)

Z(cid:107),ctr = −

2a
πc

0

ϕm,r(a cos θ, a sin θ)

(a cos θ, a sin θ) dθ ,

(57)

∂ϕm,c
∂r

where ∂ϕm,c/∂r(x, y) = −2/(cid:112)x2 + y2. The contribution from the rectangular part of the
boundary is zero, since ϕm,r is zero on this boundary. These integrals can easily be solved
numerically, and the sums coming from ϕm,r converge well.

To do a small parameter study, let us keep the shape of the rectangular pipe ﬁxed, with
w = 2g, and let us vary a from g to w. In Fig. 20 we plot the results, giving the impedance
of a rectangular-to-circular transition, Z(cid:107),rtc, of a circular-to-rectangular transition, Z(cid:107),ctr,
and the sum of one of each type, (Z(cid:107))total, as functions of a/g. We see that each of the single
transition curves goes to zero exactly where that transition becomes a step-in transition.
For the actual design of the LCLS transition (a/g = 1.6), the rtc transition has 7.5 times
the impedance of the ctr transition. In Fig. 20 the black dot gives (Z(cid:107))total as obtained by
ECHO, and we see good agreement: our calculation gives 1.24/c and the ECHO result is
1.21/c.

VII. CONCLUSIONS

We have used a method, that we derived in a companion report [3], to ﬁnd impedances in
the optical regime, and applied it to various 3D beam pipe transitions that one encounters
in vacuum chambers of accelerators. The method is applicable to high frequencies and
transitions that are short compared to the catch-up distance. Our examples are of four
types: an iris/short collimator in a beam pipe, a step-in transition, a step-out transition,
and more complicated transitions. (Note that a long collimator with ends that are short
transitions has an impedance that is the sum of the impedances of a step-in and a step-
out transition, and is thus also included.) Most of our results are analytical, with a few
given in terms of a simple one dimensional integral. We believe that all of our results are
new. We have also compared (most of) our results with numerical simulations with the
computer program ECHO, a ﬁnite-diﬀerence program that solves Maxwell’s equations of an

25

FIG. 20: Longitudinal impedance for transitions of the LCLS rectangular-to-circular type, giving
Z(cid:107),rtc, Z(cid:107),ctr, and their sum (Z(cid:107))total as functions of circular radius a. The rectangle width 2w = 4g.
The ECHO result for (Z(cid:107))total, from Ref. [9], is given by the black dot.

ultra-relativistic bunch within metallic boundaries of 3D geometry, and the agreement is
excellent. Note that our method is a much simpler way of obtaining impedances than the
simulations.

We have focused on transverse impedances. For bi-symmetric (horizontal and vertical
mirror symmetric) examples, a bunch moving at a small oﬀset from the symmetry axis will
excite a transverse impedance composed of both a dipole and a quadrupole component. For
such problems we give both components. The iris/short-collimator-in-a-beam-pipe examples
we solve include irises with small aperture that are (I1) ﬂat, (I2) rectangular, (I3) elliptical;
also included is (I4) a ﬂat iris (not necessarily small) in a ﬂat beam pipe. An interesting
result is that the vertical impedance of an elliptical iris is independent of the horizontal axis
of the ellipse.

For a step-in transition of any shape we ﬁnd that all impedances (transverse and lon-
gitudinal) are zero. For a step-out transition (which in the optical regime has the same
impedance as a long collimator) we give the solution for (T1) a ﬂat step-out transition to
a ﬂat beam pipe, (T2) a rectangular step-out transition, and (T3) an elliptical step-out
transition. We ﬁnd, for example, that the transverse impedance of a ﬂat, long collimator in
a ﬂat beam pipe is π2/8 times the impedance of the inscribed round, long collimator in a
round beam pipe. The more complicated transitions examples we solve are (U1) misaligned
ﬂat pipes and (U2) the LCLS rectangular-to-round transitions.

The method of Ref. [3] is powerful; it allows one to calculate the impedance in the optical
regime of a truly large class of transitions. We have demonstrated this with a small number
of relatively simple examples, compared to what is possible.

Acknowledgements

We thank CST GmbH for letting us use CST MICROWAVE STUDIO for the meshing for
the ECHO simulations. We also thank B. Podobedov for running a GdﬁdL test simulation
for us.

26

Appendix: Limiting Values of the Impedance of Elliptical Transitions

The solution for the elliptical step-out transition with axes w by g (horizontal by vertical),

Eqs. 48, can be written as

Z⊥,d =

Z⊥,q =

4(1 − β)2
ωg2β

8(1 − β)2
ωg2β

∞
(cid:88)

m=1
∞
(cid:88)

m=1

2m − 1
β−(2m−1) − 1

,

m
β−2m + 1

,

where β = (w − g)/(w + g). We derive here the limits for β = 0 (a step-out transition from
a round beam pipe), β = 1 (from an elliptical pipe with inﬁnitesimal height), and β = −1
(from an elliptical pipe with inﬁnitesimal width).

In this limit, only the m = 1 term contributes to Z⊥,d and no term contributes to Z⊥,q.

We obtain the round step-out transition results

Z⊥,d =

4
ωg2 ,

Z⊥,q = 0 .

The Limit for β = 0

The Limit for β = 1

Let us consider the dipole impedance ﬁrst. For β = 1 − (cid:15), with (cid:15) a small positive number,
the sum peaks when 2m(cid:15) ≈ ln m, i.e. for a large value of m. Thus the sums can be replaced
m → (cid:82) dm. Changing variables to x = β−(2m−1), dx = −2(ln β)x dm, we
by integrals, (cid:80)
obtain

Z⊥,d = lim
β→1

2
ωg2

(1 − β)2
β(ln β)2

(cid:90) ∞

1

ln x
(x − 1)

dx
x

.

The integral equals π2/6, and

(1 − β)2
β(ln β)2 = 1 .

lim
β→1

The calculation for Z⊥,q is similar. Our ﬁnal result is the same as for the ﬂat pipe step-out
transition

Z⊥,d =

π2
3ωg2 ,

Z⊥,q =

π2
6ωg2 ,

Z⊥ =

π2
2ωg2 .

(58)

(59)

(60)

(61)

(62)

27

The Limit for β = −1

Let γ = −β. Then our equations become

Z⊥,d =

4(1 + γ)2
ωg2γ

∞
(cid:88)

2m − 1
γ−(2m−1) + 1

,

Z⊥,q = −

8(1 + γ)2
ωg2γ

m=1
∞
(cid:88)

m=1

m
γ−2m + 1

.

∞
(cid:88)

m=1

f (m) ≈

f (1)
2

+

(cid:90) ∞

1

f (x) dx −

f (cid:48)(1) ,

1
12

To ﬁnd the leading order behavior of Z⊥ we need to go to second order in the calculation.
To do this we will use the Euler-Maclaurin formula relating sums to integrals [15]

where (cid:48) denotes taking the derivative of a function. The formula is valid if the sum converges.
The approximation is good if (cid:82) ∞
1

|f (cid:48)(cid:48)(cid:48)(x)| dx is small.

Let us consider ﬁrst the dipole part. We want the solution for γ = 1 − (cid:15), with (cid:15) a small,

positive parameter that we, in the end, let go to zero. For the dipole part

f (m) =

16
ωg2

2m − 1
γ−(2m−1) + 1

.

There are three terms on the right side of Eq. 64 that we need to calculate. The ﬁrst term
f (1)/2 = 4/(ωg2). The integral term, done like before, is

(cid:90) ∞

1

f (x) dx = lim
γ→1

8
ωg2

1
(ln γ)2

(cid:90) ∞

1/γ

ln x
(x + 1)

dx
x

.

Note that for this order of calculation, in the integral on the right, the lower limit of
integration is 1/γ instead of 1. This integral

(cid:90) ∞

1/γ

ln x
(x + 1)

dx
x

=

− ln

π2
6

(cid:19)

(cid:18) 1 + γ
γ

1
2

ln γ −

(ln γ)2 + Li2(−1/γ) ,

(67)

with Li2(x) the polylogarithmic function of order 2. We combine this result with the terms
in front of the integral in Eq. 66, expand around γ = 1, and substitute γ = (g + w)/(g − w);
we ﬁnd that the second, integral contribution to Eq. 64 equals

(cid:20) π2
6w2 +

(cid:18) π2
18

1
ω

− 2

(cid:21)

(cid:19) 1
g2

.

The third term in Eq. 64, −f (cid:48)(1)/12 = −4/(3g2). We sum all three contributions to
obtain Z⊥,d. Exactly the same technique is used for Z⊥,q (note, however, that the equation
corresponding to Eq. 66 will have an integral with lower limit 1/γ2, not 1/γ). We ﬁnally
obtain

(63)

(64)

(65)

(66)

(68)

Z⊥,d =

Z⊥,q =

+

(cid:20) π2
6w2 +
π2
6w2 +

(cid:18) 2
3
(cid:18) 4
3

−

(cid:20)

π2
18

(cid:21)

(cid:19) 1
g2
(cid:19) 1
g2

π2
18

−

1
ω
1
ω

(cid:21)

.

28

The leading order behavior of these impedances, in this limit, is Z⊥,d = −Z⊥,q = π2/(6ωw2).
Summing the two impedances together, we ﬁnd that the total impedance equals Z⊥ =
2/(ωg2). This value of total impedance is the same as we found for any small elliptical iris
in a beam pipe. This result appears to agree with the numerical calculation of the original
sums, which is plotted in Fig. 15.

[1] K. Yokoya, in 2005 International Linear Collider Physics and Detector Workshop and Second

ILC Accelerator Workshop (Snowmass, CO, 2005).

[2] Report SLAC-R-593, 2002.
[3] G. Stupakov, K. Bane, I. Zagorodnov, “Optical approximation in the theory of geometric

impedance,” SLAC-PUB-12369, February 2007.

[4] V. E. Balakin and A. V. Novokhatski, in Proceedings of the 12th International Conference
on High-Energy Accelerators, edited by F. T. Cole and R. Donaldson (Fermilab, Batavia, IL,
1983), p. 117.

[5] S. A. Heifets and S. A. Kheifets, Rev. Modern Phys. 63, 631 (1991).
[6] E. Gianfelice and L. Palumbo, IEEE Trans. Nucl. Sci. 37, 1081 (1990).
[7] F. Zimmermann, et al, in Proceedings of the European Particle Accelerator Conference, Sitges,

1996 (1996), pp. 504–506.

[8] I. Zagorodnov and K. L. F. Bane, in Proceedings of the European Particle Accelerator Confer-

[9] K. L. F. Bane and I. Zagorodnov, in Proceedings of the European Particle Accelerator Confer-

ence, Edinburgh, 2006 (2006), pp. 2859–2861.

ence, Edinburgh, 2006 (2006), pp. 2952–2954.

[10] I. Zagorodnov and T. Weiland, Phys. Rev. ST-AB 8, 042001 (2005).
[11] W. K. H. Panofsky and W. Wenzel, Rev. Sci. Instr. 27, 967 (1956).
[12] J. D. Jackson, Classical Electrodynamics, 3rd Ed., (J. Wiley & Sons, New York, 2001).
[13] P. Morse and H. Feshbach, Methods of Theoretical Physics, Part II, (McGraw-Hill, New York,

1953), p. 1240.

[14] R. Gluckstern, J. Van Zeijts, B. Zotter, Phys. Rev. E 47, No. 1, 656 (1993).
[15] See e.g. C. M. Bender and S. A. Orszag, Advanced Mathematical Methods for Scientists and
Engineers I: Asymptotic Methods and Pertubation Theory, (Springer, New York, 1999), p. 305.

29

