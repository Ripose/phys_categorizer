Quasiperiodic spin–orbit motion and spin tunes
in storage rings ∗

D. P. Barbera, J. A. Ellisonb and K. Heinemanna
Deutsches Elektronen–Synchrotron, DESY, 22603 Hamburg, Germany

Department of Mathematics and Statistics, The University of New Mexico,

a

b

Albuquerque, New Mexico 87131, U.S.A.

Abstract

We present an in–depth analysis of the concept of spin precession frequency for
integrable orbital motion in storage rings. Spin motion on the periodic closed orbit of
a storage ring can be analyzed in terms of the Floquet theorem for equations of motion
with periodic parameters and a spin precession frequency emerges in a Floquet expo-
nent as an additional frequency of the system. To deﬁne a spin precession frequency
on nonperiodic synchro–betatron orbits we exploit the important concept of quasiperi-
odicity. This allows a generalization of the Floquet theorem so that a spin precession
frequency can be deﬁned in this case too. This frequency appears in a Floquet–like
exponent as an additional frequency in the system in analogy with the case of motion
on the closed orbit. These circumstances lead naturally to the deﬁnition of the uni-
form precession rate and a deﬁnition of spin tune. A spin tune is a uniform precession
rate obtained when certain conditions are fulﬁlled. Having deﬁned spin tune we deﬁne
spin–orbit resonance on synchro–betatron orbits and examine its consequences. We
give conditions for the existence of uniform precession rates and spin tunes (e.g. where
small divisors are controlled by applying a Diophantine condition) and illustrate the
various aspects of our description with several examples. The formalism also suggests
the use of spectral analysis to “measure” spin tune during computer simulations of spin
motion on synchro–betatron orbits.

4
0
0
2
 
c
e
D
 
3
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
7
5
1
2
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

∗An extended version of Phys. Rev. ST Accel. Beams 7(12), 124002 (2004).

1

5 Introduction to the Quasiperiodicity of the Spin Motion.Deﬁnition of the Spin Tune 24

6 The Invariant Spin Field and the Quasiperiodicity of the Spin Motion

Contents

1 Introduction

2 General Properties of the Spin Motion

3 Spin Motion on the Closed Orbit

4 Quasiperiodicity and a Diophantine Condition

9 Spectral Analysis of Quasiperiodic Spin Motion

7 The Single Resonance Model

8 The Moser-Siegel Model

10 Discussion and Conclusion

1 Introduction

2

9

13

16

30

41

45

46

52

This paper provides a rigorous discussion of the concept of spin precession frequency on
synchro–betatron orbits in storage rings. To set the scene we begin by introducing some
key physical ideas via the equations of orbit and spin motion and the notion of spin–orbit
equilibrium.

The spin expectation value S (“the spin”) in the rest frame of, for example, a proton, an
electron or a muon moving in electric and magnetic ﬁelds under the inﬂuence of the Lorentz
force precesses according to the Thomas–Bargmann–Michel–Telegdi (T–BMT) equation [1]

dS/dt = ˜Ω(E, B, v)

S ,

×

(1.1)

where the precession vector ˜Ω depends on E, B and v which are respectively the electric and
magnetic ﬁelds, and the velocity. Particle motion with respect to the synchronous closed, i.e.
periodic, orbit is described in terms of three pairs of canonical variables which we combine
into a vector u with six components. For example, two of the pairs can describe transverse
motion and one pair can describe longitudinal (synchrotron) motion within a bunch. Since
we are dealing with storage rings we take the orbital motion to be bounded. In this paper
we ignore radiation, interparticle interactions and interactions with the vacuum system. In
(1.1) the independent variable is the time t. However, since the electric and magnetic guide
ﬁelds in particle accelerators and storage rings are ﬁxed in space it is more convenient to
adopt the standard practice of replacing t with the angular position around the ring, the
azimuth θ = 2πs/L, where s is the distance around the ring and L is the circumference.

2

Since E, B and v depend on u and θ we can now rewrite (1.1) in the form

dS/dθ = Ω(θ, u(θ))

S

×

(1.2)

where Ω is the precession vector obtained from ˜Ω by rescaling with dt/dθ and transforming
to machine coordinates [2].

If the beam is in equilibrium, i.e. if the the phase space density ρ(θ, u) is 2π–periodic
in θ, we then write it as ρeq so that ρeq(θ, u) = ρeq(θ + 2π, u). We normalize it to unity:
duρeq = 1. The necessary condition for this kind of equilibrium, namely that at a ﬁxed u
the ﬁelds are 2π–periodic in θ, is automatically fulﬁlled in a storage ring. But of course the
R
boundedness of the motion is also required. Conditions necessary for beam equilibrium and
a way of calculating ρeq using ergodic theory and the concept of “stroboscopic averaging”
are described in detail in [3].

The statistical properties of the spins are encoded in the quantum mechanical spin density
matrix. But for spin 1/2 particles this can be completely parametrized by the polarization
vector [4]. For particle beams we need the local polarization Ploc(θ, u) at each point in
phase space u. Ploc(θ, u) is the average of the normalized spin vectors, S/
, at u, where
denotes the Euclidean norm. We deﬁne the polarization of the whole beam, the “beam

S
|

|

| · |
polarization”, at a given azimuth as

duρeqPloc.

R

Since the T–BMT equation (1.2) is linear in S and since the particles at (θ, u) all see the
same Ω(θ, u), Ploc(θ, u(θ)) also obeys the T–BMT equation [5]. Furthermore, the length
of Ploc(θ, u) is constant along a phase space trajectory. For a storage ring at ﬁxed energy,
Ω is 2π–periodic in θ at a ﬁxed position in phase space u so that Ω(θ, u) = Ω(θ + 2π, u).
This opens up the possibility of a spin distribution that is the same from turn to turn, i.e.
in equilibrium. Then Ploc(θ, u(θ)) not only obeys the T–BMT equation, but Ploc(θ, u) is
2π–periodic in θ for ﬁxed u and we then write it as Peq so that Peq(θ, u) = Peq(θ + 2π, u).
We denote the unit vector along Peq(θ, u) by n(θ, u). This also obeys the T–BMT equation
along orbits and is 2π–periodic in θ: n(θ, u) = n(θ + 2π, u).

The method described in [3] for constructing ρeq can be extended as in [6] for constructing
n and from the treatments in [3] it is clear that the existence of ρeq and n do not require
that the orbital motion be integrable. But, of course, the conclusions of [3] are still valid if
the motion is integrable. Moreover, particle motion in storage rings is usually close enough
to integrability to allow the motion to be characterized in terms of well deﬁned betatron and
synchrotron frequencies. This, in turn, allows predictions to be made about beam stability
via the concept of orbital resonance. Thus, in the remainder of this paper we will assume
that the orbital motion is integrable. Then, as we shall see, the stability of spin motion can
also be discussed in terms of resonance, namely “spin–orbit resonance”. Of course, integrable
orbital motion and spin–orbit equilibrium are idealizations. Nevertheless, these idealizations
often provide useful starting points for calculations.

For integrable particle motion the position of a particle in phase space is represented by
three pairs of action–angle variables (Ji, φi, i = 1, 2, 3) and is determined by a Hamiltonian
H(J). Thus the orbital phase space is partitioned into disjoint tori, each of which is char-
(φ, J). The
acterized by a unique set of J s. We now deﬁne u := (φ1, φ2, φ3, J1, J2, J3)
actions are constants of the motion and for ﬁxed J the constant rate of advance of each φi,
ωi(J) := ∂H/∂Ji = dφi/dθ, is called an orbital tune. These frequencies are the number of

≡

3

oscillations per turn around the ring. In beam physics such frequencies are often referred to
as tunes and we have adopted that usage. We will only consider storage rings running at
ﬁxed nominal energy.

For integrable motion, the 2π–periodicity in θ of Ω, Peq and n is accompanied by 2π–
periodicity in φ1, φ2 and φ3. So as well as being a solution to the T–BMT equation along
orbits u(θ), n satisﬁes nontrivial periodicity conditions. In our later discussions on quasiperi-
odicity we will require that it also depend suﬃciently regularly on the azimuth and the orbital
angles, i.e. n must be “smooth” in the sense deﬁned in the main text. This corresponds to
the expectation that Peq also be smooth. The equilibrium density ρeq is also 2π–periodic in
θ and oﬀ orbital resonance it just depends on J.

|

|

|

|

|

|

|

|

R

R

R

R

R

dJρeq(J)

dJρeq(J)

dφ n
|

Peq(θ, φ, J)

Peq(θ, φ, J)

dφ n(θ, φ, J)

dφ n are parallel. This is easy to see by noting that if

Since for every J the ﬁeld n(θ, φ, J) is invariant from turn to turn, it is now often called the
invariant spin ﬁeld (ISF). The ISF is a central object in the theory of polarization in storage
rings [7, 8, 9, 10]. For example, for an ISF suﬃciently regular in J, oﬀ orbital resonance and
away from the spin–orbit resonances to be deﬁned below, an upper limit to the equilibrium
beam polarization at a particular θ is
and it is reached only when
the
were to vary over
a torus, the beam polarization would vary from turn to turn. So equilibrium implies that
Peq(θ, φ, J)
is constant over a torus. The maximum equilibrium polarization on each torus
|
at some θ
is reached when
= 1. Note that a zero value for
does not mean that the beam is depolarized. It could well be that the beam is fully polar-
ized at each point in phase space but that the geometry of n causes the integral to vanish.
Then, if a change of parameters were to change the geometry of n so that the integral were
to become nonzero, and if the change were carried out adiabatically, the beam polarization
would reappear. Furthermore, the fact that the integral vanishes at one position θ does not
mean that it vanishes at other positions. We prefer to reserve the term “depolarization” for
a deﬁnitely irreversible loss of polarization such as occurs in the presence of noise or for an
eﬀectively irreversible loss of the kind that can occur when spin–orbit resonances are crossed
[11]. See Sec. X too. Although we have introduced n via the notion of equilibrium, the inte-
also contains useful information when the spin distribution is not in
gral
equilibrium:
gives an upper limit for the time averaged polarization away
R
from spin–orbit resonances. The maximum is reached on each torus when the polarization
R
R
= 1. See [12, Section 2.2.8] and [13, Section 4.4]. An
is in equilibrium and with
example of the origin and behavior of nonequilibrium beam polarization is given in Figure
9 in [6] where large oscillations are evident. However, polarimeters and particle detectors
cannot collect data quickly enough to make such oscillations observable. Instead, only the
time averaged polarization can be observed or exploited. But as we have just seen, we can
still estimate its maximum value. That depends only on the geometry of n and it is reached
for each torus when the spread of n is minimized. The ISF also provides a perfect tool for
estimating the long term eﬀects on the beam polarization of small perturbations such as
radiation [7] or electric and magnetic ﬁelds which cause nonintegrable orbital motion. In
particular, one begins with a spin–orbit system which is invariant from turn to turn, i.e. with
an equilibrium orbital distribution and with spins set parallel to the n(θ, u). Then, since
the system is initially in equilibrium, the eﬀects of the perturbations cannot be masked by
the natural, potentially large, variations of the beam polarization of the kind depicted in
Figure 9 in [6]. An ability to construct n(θ, u) for integrable orbital motion and understand

dφ n
|
|
dJρeq(J)

Peq(θ, φ, J)

dJρeq(J)

dφ n
|

R

|

|

|

4

its behavior is then indispensable.

For our integrable orbital motion of electrons and protons and up to energies of a few
GeV, an approximate n can be calculated in a ﬁrst order perturbation theory by an extension
of the code SLIM [14, 15], and in higher order perturbation theory by the codes, SMILE [10],
Forget–me–Not [16] and SpinLie [17]. However, for the high magnetic ﬁelds characteristic of
proton rings running at energies of hundreds of GeV, perturbative methods are inadequate.
Then the method of stroboscopic averaging as in the code SPRINT [6] should be used. This
is a numerical, nonperturbative algorithm and yields high accuracy for real rings even when
all modes of orbit oscillation are included simultaneously. One can also use Fourier methods
as in the codes SODOM2 [18] or MILES [19]. SODOM2 has been very useful for orbital
motion restricted to one plane [13]. MILES gives explicit formulae which are applicable to
some simple models. So far, the only practical general way to calculate the invariant spin
ﬁeld is to use stroboscopic averaging.

As for any dynamical system we hope to understand more about spin motion by studying
its spectrum of frequencies. Various quantities, which seem at ﬁrst sight to be related to
spin frequencies, can be found in the literature and we will mention some in Section 10. But
a true component of a spectrum quantiﬁes long term behavior. Thus any deﬁnition of spin
precession frequency should reﬂect that stipulation. The choice can be further narrowed
by requiring that the spectrum give useful clues about the behavior of sets of spins, and
in particular about the beam polarization. After all, the experimenters using the beams in
storage rings are just interested in the beam polarization, not individual spins.

Experience has shown that the best choice for characterizing spin motion in storage rings
is the traditional one [20, 21, 22], namely the so–called amplitude dependent spin tune (brieﬂy
“spin tune”), which we usually denote by ωs. Assuming n exists, the spin tune measures the
number of spin precessions around n(θ, u), per turn around the ring, for a particle on the
orbit u(θ) and it provides a way to quantify the correlation between the spin motion and the
orbital motion which “drives” it, and thereby forecast a qualitative aspect of spin motion,
namely the degree of regularity of the spin motion. In particular, the spin motion can in
general become very erratic when a spin tune is near a low order resonance condition

ωs = m0 + m1 ω1 + m2 ω2 + m3 ω3 = m

(1, ω),

(1.3)

·
m2|

|

|

|

+

+

m1|

m3|

where m is a vector of integers and the quantity
is usually called the
order of the resonance. Correspondingly, close to spin–orbit resonance n(θ, u) can become
a very sensitive function of u. This sensitivity has immediate consequences for work with
polarized beams. For example, the maximum attainable equilibrium beam polarization of
a stored high energy proton beam can be unacceptably low or the rate of depolarization,
due to synchrotron radiation, of a stored electron beam can be unacceptably high [7]. Note,
/(2π)3 on a torus can sometimes be small away from spin–orbit
however, that the
resonance and that proximity to a spin–orbit resonance, especially one of high order, does not
/(2π)3 on a torus is low. The resonance might be very
automatically imply that the
weak. Another feature of our deﬁnition of spin frequency is that, as we shall see, it is this
quantity whose spectrum one obtains in a straightforward spectral analysis of spin motion
during spin–orbit tracking simulations. In other words:
in an ideal world with technology
which could select particles on a torus at a ﬁxed J, it could be measured.

dφ n
|

dφ n
|

R

R

|

|

5

Right at the resonance condition (1.3), n is in general nonunique. However, as we shall
see, our spin–orbit systems exhibit a tendency to avoid exact spin–orbit resonance. Since
Ω in general depends on J and the particle energy on the closed orbit, ωs usually varies
with J (hence “amplitude dependent spin tune”), and the particle energy on the closed
orbit. We will call the latter the “beam energy”. We emphasize that n is a ﬁeld over
the six dimensional phase space so that synchrotron motion is built in from the start. Thus
although ωs varies with the beam energy and J1, J2 and J3, it does not change during a period
of synchrotron motion. If n were deﬁned on four dimensional transverse phase space and
the energy oscillations due to synchrotron motion were added as an afterthought, it would
not be useful for describing equilibrium polarization. Instead, we would have to characterize
the beam polarization using time averages. We return to this theme in Section 10. On the
closed orbit, i.e. for J1 = J2 = J3 = 0, an n exists which is independent of φ. We denote it
by n0 [15].

The calculation of spin tune on the closed orbit presents no problem: it can, as we shall
see, be extracted from an eigenvalue of the 1–turn spin map. But the deﬁnition of spin
tune for J
= 0, i.e. on synchro–betatron orbits is much more subtle. Moreover, it requires
precision. Notions of spin frequency for synchro–betatron orbits appearing in the literature
are often not precisely presented and some appear to possess no capacity for predicting the
qualitative aspects of spin motion in storage rings.

This brings us to the purpose of this paper. This is to provide a rigorous discussion of
the concept of spin precession frequency on synchro–betatron orbits and thereby consolidate
a framework for systematizing and classifying spin motion in storage rings. For this we make
a careful mathematical study of the consequences for spin motion of the periodicities of Ω
in θ, φ1, φ2 and φ3, using precise deﬁnitions and carefully formulated theorems and we make
use of the ISF and other concepts which we distill from the literature and “folklore” on spin
dynamics in storage rings [6, 7, 8, 9, 12, 13, 16, 18, 20, 21, 22, 23, 24, 25]. For example,
we will show that under the appropriate conditions, the existence of the ISF with the above
mentioned periodicities implies that the θ dependence of the general solutions of (1.2) will
contain ﬁve frequencies. Four of them are the orbital tunes ω1, ω2, ω3 and the circulation
tune ωc = 1, i.e. the frequency associated with the 2π–periodicity in θ. A ﬁfth tune emerges
which, under circumstances to be described, is a spin tune ωs. The general solutions will then
be found to be quasiperiodic with the tunes 1, ω1, ω2, ω3, ωs. Moreover the results obtained
here can be viewed as a generalization of Floquet theory. Given the confusion surrounding
deﬁnitions of spin precession frequencies, the treatment of the kind that we provide here
seems to be very necessary. Our assumptions about Ω are weak enough to cover the situations
of most interest for storage rings, namely typical integrable synchro–betatron motion. Several
of our theorems assume the existence of n but although we have ways to ﬁnd approximate
n, the determination of complete conditions for its existence is an outstanding mathematical
issue. This question can, for example, be investigated using ergodic theory [26, 27] and the
method of stroboscopic averaging. See [3]. Moreover, simulations indicate that approximate
ISFs do exist. This means that one obtains objects which, at least approximately, behave
like an ISF. Moreover in some instances approximations even lead to an Ω for which an exact
ISF can be found, e.g. as in the single resonance model - see Section 7.

Although we have introduced the vector n by studying spin–orbit equilibrium, it was
ﬁrst discussed by Derbenev and Kondratenko as a vehicle for constructing joint action–

6

6
angle variables for spin and orbital motion from their semiclassical spin–orbit Hamiltonian
[21, 22, 2, 7, 16]. This Hamiltonian is derived from the Dirac Hamiltonian by a Foldy–
Wouthuysen transformation taken to ﬁrst order in ~ [7].
In that picture the spin tune
emerges as the rate of advance of a spin phase [21, 22, 2]. The terms at ﬁrst order in ~ in the
Derbenev–Kondratenko Hamiltonian are those containing spin and these terms imply a force
of the Stern–Gerlach (S–G) type [4]. The S–G forces on trajectories appear at ﬁrst order
in ~ and a “back reaction” on the spin of the S–G perturbation to the orbit would involve
an addition to the spin precession rate of order ~. However, in this paper the eﬀect of S–G
forces on spin and orbit motion is neglected and we just operate with the Lorentz force and
the T–BMT equation and for the Lorentz force and Ω just include, as is usual, the terms of
zeroth order in ~. There are several reasons for this approach. First, it is far from clear what
form the S–G forces should take. In fact there is considerable ambiguity in the choice of the
S–G forces. This is covered in detail in [28]. See [29] too and the bibliography in [28]. The
second ground has to do with the size of the S–G forces. Since the S–G forces are of ﬁrst
order in ~ they are extremely small compared to the Lorentz forces which are of zeroth order
in ~ 1. They are also small compared to typical spurious perturbations to trajectories like
noise and collective eﬀects. So S–G forces would not cause changes of practical signiﬁcance
to the results that we present. In particular, in practical situations in a storage ring there
would be no signiﬁcant change in the phenomenology of spin–orbit resonances even if the
S–G forces were to cause tiny changes in the orbital tunes. The third ground is that it is
far from clear that it makes sense to treat an essentially quantum mechanical system with
a classical “over interpretation” of the inﬂuence of the S–G force on the spin. An example
of an eﬀect which is not taken into account by a naive application of classical S–G forces, is
given in [30]. It is implied there that long term shifts of an orbit due to S–G forces will be
nulliﬁed when the spin undergoes a quantum ﬂip and the S–G force then acts in the reverse
direction. See [2, p.137] for a classical perspective on this. In summary, we believe that a
too literal interpretation of the S–G–like forces in the semiclassical spin–orbit Hamiltonian
could lead to manipulations and conclusions of little relevance and utility for illuminating
the core phenomenology of spin motion in typical storage rings [31, 32]. We believe that
the ﬁrst priority is to begin with just the Lorentz force and the T–BMT equation. Then, as
mentioned earlier, once the equilibrium state of the system has been deﬁned, other inﬂuences
such as nonlinear ﬁelds, noise, collective eﬀects, synchrotron radiation and the very small
S–G–like eﬀects can be included as perturbations.

The paper is structured as follows. In Section 2 we begin by discussing some important
consequences of (1.2). Here we introduce the central concept of a uniform precession frame
(UPF) and the associated uniform precession rate (UPR). The UPF provides a coordinate
system for spin. Then in Section 3 we give a detailed discussion of spin motion on the
closed orbit where Ω is independent of φ so that the Floquet theorem applies. Sections 2
and 3 contain standard results but we present them in forms which motivate their extension
in later sections. Section 4 contains the deﬁnition of a quasiperiodic function and collects

1For example, at the r.m.s.

radius of the 920 GeV/c proton beam in a quadrupole magnet in the
HERA proton ring [12, 13], a rough estimate for the transverse S–G force from the Derbenev–Kondratenko
Hamiltonian gives a S–G force which is about 10−12 of the Lorentz force on a proton. At a ﬁxed radius this
ratio is essentially independent of the beam energy. The S–G energy at that radius is of the order of 10−21 of
the kinetic energy. The S–G energy in a HERA dipole magnet is of the order of 10−19 of the kinetic energy.

7

some properties useful for the discussion following. In particular it deﬁnes a Diophantine
condition needed for handling a problem with small divisors. The key ideas are formalized
in Lemmas 4.3, 4.7 and 4.8. Section 5 uses the concept of a UPF, quasiperiodic with orbital
frequencies, to deﬁne the proper UPR, the spin tune and spin–orbit resonance. The main
theorem in Section 5 is Theorem 5.3 which allows us to deﬁne equivalence classes of spin
tunes. The presentation in Sections 2, 3, 4 and 5 is deliberately rather general and abstract.
Then in Section 6 we introduce a ﬁeld called the invariant frame ﬁeld (IFF) which is used to
construct UPFs. There we consider the angular phase space as a whole to prove theorems
about the concepts introduced in Section 5. We also connect the abstract ideas introduced
earlier to a familiar physical idea, namely that if the orbital tune were oﬀ orbital resonance
(1, ω) = 0 only with the vector of integers m = 0), the existence of a nonunique ISF
(m
would imply that the system were on spin–orbit resonance. The main theorems in Section
6 are Theorems 6.3 - 5. Theorem 6.3 is used in the proof of Theorem 6.5 and it is generally
our main tool for showing that a torus is “well–tuned”. The proof of Theorem 6.3 relies on
Theorem 5.3. Some examples of the formalism for model Ω s are presented in Sections 6, 7
and 8. Note that, except for some examples, we allow the number of action–angle pairs, d,
1) although for spin motion in storage rings, the case d = 3 is the
to be arbitrary (but
most important. To aid the reader we mark the key equations with a ⋆⋆⋆ on the left.

≥

·

As a byproduct of the quasiperiodic structure of the solutions we suggest using spectral
analysis as a way of “measuring” the spin tune during spin–orbit tracking simulations and
thereby complementing other methods already in use [8, 9, 18, 12, 13, 23, 33]. Spectral
analysis may also lead to a practical method for deciding whether an invariant spin ﬁeld
exists. These ideas are presented in Section 9 and formalized in Theorems 9.1 and 9.2.

The paper is summarized in Section 10 where our concepts are also related to simulations

and used to discuss some popular notions.

For the rest of the paper, apart from Section 10, we will now adopt a more eﬃcient
notation whereby we use the symbols J = (J1, ..., Jd), ω = (ω1, ..., ωd) and φ = (φ1, ..., φd),
Rd) to mean respectively the list of orbital actions, orbital tunes and orbital
(J, ω, φ
angles. From now on we will also adopt the frame dependent abbreviations S = (S1, S2, S3),
Ω = (Ω1, Ω2, Ω3) and n = (n1, n2, n3). Generally, if φ appears as an independent variable in
a function, the function will be 2π–periodic in φ1, ..., φd. In that case we say for brevity that
the function is 2π–periodic in φ.

∈

In terms of the new notation, the T–BMT equation and the equations of orbital motion

are

˙S =
A
˙J = 0,

(θ, φ, J)S ,

˙φ = ω(J),

(1.4)
(1.5)

where
Ω3,

−A31 = Ω2 and

is a real skew–symmetric 3

3 matrix with nonzero elements

−A21 =
A
Ω1. The dot over a symbol denotes diﬀeren-
A13 =
−
−
tiation w.r.t. θ. Because the J dependence is only parametric, we will often suppress the
is 2π–periodic in θ and in φ. For brevity
symbol J in ω and
we just say that functions with such periodicity are 2π–periodic. On the closed orbit, i.e.
is independent of φ. Note that on the torus J = 0 the angular variables φ
for J = 0,
is independent of φ. But their inclusion is very
play a largely artiﬁcial role because here

×
−A32 =
(θ, φ). Clearly,

A12 =

A23 =

, e.g. as in

A

A

A

A

A

8

convenient as it allows one to treat all tori on the same basis. Then all deﬁnitions, e.g. that
of the ISF, apply to all tori.

A function is called C r, if the function together with all of its partial derivatives up to
and including those of order r are continuous. In this paper we will assume that, for ﬁxed
is a C 1 function of (θ, φ). A C 1 function will be called smooth. The smoothness of
J,
A
corresponds to the fact that in real storage rings, the magnetic and electric ﬁelds are
A
smooth functions of space and time. The labels for the deﬁnitions, propositions, theorems
and lemmas are chosen in a way which indicates their relative positions in the text.

2 General Properties of the Spin Motion

We begin by establishing some basic components of our formalism.

Clearly (1.5) gives J(θ) = J0 and φ(θ) = ω(J0)θ + φ0 where J0 and φ0 are the actions
and phases at θ = 0. Thus an orbit is labeled by (φ0, J0). But if we consider a ﬁxed torus
J0 we often suppress the symbol J0. By “a ﬁxed torus J0” we mean that the orbital tune
has the value ω(J0) and that the spin motion is characterized by the function
(θ, φ, J0) of
θ and φ. Equation (1.4) thus becomes

A

⋆⋆⋆

˙S = A(θ; φ0, ω)S , S(0; φ0, ω) = S0 ,

where the real skew–symmetric A is deﬁned by

A(θ; φ0, ω) :=

(θ, ωθ + φ0) .

A

As will become clear from Deﬁnition 4.1 in Section 4, A(θ; φ0, ω) is a quasiperiodic function
of θ with the tunes (frequencies) 1, ω1, ..., ωd. The solutions of (2.1) can be written as
S(θ; φ0, ω) = Φ(θ; φ0, ω)S(0; φ0, ω) in terms of the principal solution matrix at φ0 which is
the 3

3 matrix Φ(θ; φ0, ω), deﬁned uniquely by the initial value problem

×

∂Φ(θ; φ0, ω)
∂θ

Φ(0; φ0, ω) = I.

= A(θ; φ0, ω)Φ ,

(2.1)

(2.2)

(2.3)

(2.4)

Thus the principal solution matrix at φ0 is the spin transport matrix from the azimuth 0 to
the azimuth θ. Occasionally we call a solution S(θ; φ0) of (2.1) a “spin trajectory” at φ0.
The choice θ = 0 for the starting azimuth does not imply a loss of generality as can be seen
by considering the general initial value problem S(θ0) = S0, φ(θ0) = φ0 for (1.4) and (1.5).

Note that A(θ; φ0) and Φ(θ; φ0) are 2π–periodic in φ0 and that by the smoothness of A
the principal solution matrix is a smooth function of (θ, φ0) [34, 35]. We will sometimes
suppress the symbols φ0 and ω in S, A and Φ. The key property of Φ(θ) is that it belongs
to SO(3), i.e.

ΦT (θ)Φ(θ) = I = Φ(θ)ΦT (θ)

and

det(Φ(θ)) = 1 ,

(2.5)

as is easily proved using (2.3) and (2.4).

Let S1

0 and S2

0 be two initial conditions for (2.1) and let a

real inner product. Then S1(θ)

S2(θ) = (Φ(θ)S1
0 )

(Φ(θ)S2

·

b = a1b1 + a2b2 + a3b3 be the
S2
0 ) = (ΦT (θ)Φ(θ)S1
0)
0

·

0 = S1
S2
0 ·

·

·

9

so that the inner product of any two solutions of (2.1) is conserved. In particular, the length
of a spin vector and the angle between any two spin trajectories at the same φ0 is conserved.
In addition, it is easy to show that the cross product of two solutions is a solution. In the
remainder of this paper we will, for convenience, allow spins S to have arbitrary length.

An interesting property of (2.1) is that knowledge of one solution completely determines
Φ by a simple integration. It is a standard result for linear systems that knowledge of one
solution can be used to reduce the dimension by one. Here it reduces the dimension by two
because of the special structure of Φ in (2.5) as we will now demonstrate.

Let v3(θ) be a solution of (2.1), i.e. a spin trajectory at φ0, and let v3 be of norm 1.

Choose v1(θ) and v2(θ) so that

V (θ) :=

v1(θ), v2(θ), v3(θ)

(cid:2)
is a SO(3) matrix. One can for example require v1 and v2 to be solutions of ˙vk = (v3
(k=1,2), whence we can assume that V (θ) is smooth, i.e. a C 1 function.
Ψ on (2.3) and (2.4) deﬁned by

Next we make a transformation Φ

(cid:3)

This gives

where

→

Φ = V (θ)Ψ.

˙Ψ = C(θ)Ψ , Ψ(0) = V T (0) ,

C(θ) = V T (θ)

A(θ)V (θ)

˙V (θ)

.

(cid:16)

−

(cid:17)

SO(3),

Since V (θ)
C by the
skew symmetry of A. Therefore C is skew–symmetric as expected for rotations. The third
column of C is

V T (θ) ˙V (θ) and thus C T = V T (AT V + ˙V ) =

˙V T (θ)V (θ) =

−

−

∈

0
0
1 


C





= V T

Av3

˙v3

= 0,

−

(cid:0)

(cid:1)

since v3 is a solution of (2.1), and the skew symmetry of C yields

(2.6)

˙v3)

vk

×

×

(2.7)

(2.8)

(2.9)

C(θ) = cV (θ)

=: cV (θ)

,

J

(2.10)

where (2.10) also serves to deﬁne

. Therefore

J

Ψ(θ) = exp

cV (θ′)dθ′

V T (0)

as is easily checked by diﬀerentiation. Finally,

0
1
0

1 0
−
0
0
0
0











J



Z0

θ

θ



J



Z0

10









⋆⋆⋆

Φ(θ; φ0) = V (θ) exp

cV (θ′)dθ′

V T (0).

(2.11)

The exponentials in these equations can be evaluated by noting that

exp(

τ ) =

J





cos τ
sin τ
0

sin τ 0
0
1

−
cos τ
0

.





(2.12)

(2.13)

(2.14)

˙V )].

−

So we have constructed the complete principal solution matrix by starting from just one
solution of (2.1) and assuming the existence of a smooth V . This is the result we were aiming
for.

Note that by (2.9),(2.10) we have

It follows that ˙v1 = Av1
v2

v3 + v1

˙v1 = Ω

−

·

·

·

˙V (θ) = A(θ; φ0)V (θ)

J
cV v2 from which we deduce cV = v2

−

cV (θ)V (θ)

.

˙v2. Thus we obtain the useful formula

(Av1

˙v1) = v2

(Ω

v1)

·

−

·

×

−

In addition, since T r[

2] =

J

−

Remarks:

cV (θ) = Ω(θ, ωθ + φ0)

v3(θ) + v1(θ)

˙v2(θ).

·
2, it follows from (2.13) that cV =

·

(1/2) T r[

V T (AV

−

J

(1) Equation (2.7) is equivalent to a change of basis for spin whereby S is expressed as
S = V (θ) ˆS = ˆS1v1 + ˆS2v2 + ˆS3v3 so that ˆS is the spin in the rotating frame represented
ˆS(0).

by the matrix V . Moreover

ˆS so that ˆS(θ) = exp

˙ˆS = cV (θ)

cV (θ′)dθ′

θ

J

J

(cid:18)

0
R

(cid:19)

Thus ˆS3 is constant and ˆS precesses around (0, 0, 1) at a nonconstant rate cV (θ). From
(2.14) the rate cV is, as one would expect, just a combination of the projection of Ω
onto v3 and the rate, v1
˙v2, of rotation of v1 and v2 around v3. In our discussion of
spin tune in later sections it will be useful to deﬁne a frame in which the spin precesses
uniformly. From (2.11) we have

·

S(θ) = V (θ) exp

(cV (θ′)

ν)dθ′

exp (

νθ) V T (0)S(0) ,

−



J

θ



J

Z0


where ν is an arbitrary constant. Thus with the change of basis



S = U(θ) ˆS ,

U(θ) = V (θ) exp

θ



J



Z0

(cV (θ′)

ν)dθ′

,

−





ˆS and we have deﬁned a frame U whose third column is a spin
we obtain
trajectory and in which spin has a constant precession rate ν. In the following we will

J

˙ˆS = ν

be interested in the case where the mean ¯cV = limT →∞(1/T )

cV (θ)dθ of cV exists

and we will choose ν = νV where νV = ¯cV mod 1 and is in [0,1). Thus we can write
cV (θ) = ˜cV (θ) + νV + kV where ˜cV represents the ﬂuctuating part of cV with zero mean
and where the integer kV is chosen such that νV ∈

[0, 1).

T

0
R

11

(2) The ideas in Remark 1 lead to some precise deﬁnitions. On a given torus, let U(θ)

SO(3) be such that the principal solution matrix at φ0 can be written as

∈

(2.15)

Φ(θ; φ0) = U(θ) exp(

νθ)U T (0) ,

J

where ν is constant and in [0, 1). Then U is called a uniform precession frame (UPF)
at φ0 and ν, which is uniquely determined by U, is called the uniform precession rate
(UPR) for U and is denoted by νs(U). We then call (2.15) a standard form of the
principal solution matrix.

Under certain conditions which will be described in Deﬁnition 5.5, νs(U) will be called
a spin tune. Note that, due to (2.15), U(θ) is smooth in θ and satisﬁes the ordinary
diﬀerential equation:

˙U(θ) = A(θ; φ0)U(θ)

νU(θ)

,

J

−

(2.16)

where ν = νs(U). In particular by (2.16) the vector described by the third column
of U obeys (2.1) so that it is a spin trajectory with unit length. Moreover, for every
constant ν the initial value problem deﬁned by (2.16) and the arbitrary initial matrix
U(0)
νθ). Thus every
solution U(θ) of (2.16) with U(0)
[0, 1) is a UPF at φ0 and its UPR
νs(U) equals ν, i.e.

SO(3) has the unique solution U(θ) = Φ(θ; φ0)U(0) exp(

SO(3) and ν

−J

∈

∈

∈

˙U (θ) = A(θ; φ0)U(θ)

νs(U)U(θ)

.

J

−

Because T r[

2 ] =

2, for every UPF U one has the useful formula

J

−
νs(U) =

(1/2) T r[

(U T AU

U T ˙U )] ,

J

−

−

(2.17)

(2.18)

which follows from (2.17). Note that the interval [0, 1) is just a matter of choice – any
convenient half open interval of length 1 could be chosen, e.g. (0, 1].

(3) In this section and in the rest of this paper, the concepts of orthonormal reference frame
and SO(3) matrix are interchangeable. Moreover the elements of the columns of such
a matrix are just the components of the unit coordinate vectors of the corresponding
frame, as for example in (2.6). Thus we will often identify the columns with such
vectors.

(4) It can be shown that if V : R

SO(3) with V =: [v1, v2, v3], is a smooth and 2π–

→

2π
0

dθv1(θ)

periodic function (e.g. a 2π–periodic UPF) then the fractional part of
˙v2(θ), is independent of v1 and v2, i.e. the fractional part of
χ := (1/2π)
χ only depends on v3. If v3 were represented in the “spinor formalism” [13] then it
would be found that the fractional part of χ is the geometrical phase of v3 in the sense
of [36].

R

·

Finally, we summarize the basic eigenstructure of an SO(3) matrix R and its exponential
representation in terms of a skew–symmetric matrix B in the following lemma.

12

Lemma 2.1 a) Let R be a 3
SO(3) matrix W exist such that the spectrum of R, λ(R), is the set
the eigenvalues are on the unit circle) and such that

3 matrix in SO(3). Then a real number µ

×

{

∈
eiµ, e−iµ, 1

[0, 2π) and a
(whence

}

RW = W

cos µ
sin µ
0





−
cos µ
0

µ) ,

= W exp(

sin µ 0
0
1 

Furthermore, any such W = [w1, w2, w3]
iw2) and Rw3 = w3. Also, by (2.19),

(2.19)

J

where in the second equality we used (2.12).
satisﬁes the relations R(w1
R = eBµ where the matrix B = W
b) Conversely, if B is a real skew–symmetric matrix and if λ(B) =
matrix W exists such that B = W

iµ)(w1
W T is skew–symmetric.

iw2) = exp(

W T .

±

±

∓

J

J

i, 0

, then a SO(3)

i,

{

−

}

The proof is elementary. See for example [37, 38]. Note that the relation Rw3 = w3 simply
means that w3 lies along the “axis of rotation” for R.

3 Spin Motion on the Closed Orbit

In this section we consider the case J = 0, so that the A of (2.2) has no φ0 or ω dependence
and is 2π–periodic and smooth in θ. This case corresponds to the 2π–periodic motion of the
particle on the closed orbit and the following theorem applies.

Floquet Theorem: For J = 0, there exists a ˆν
SO(3) such that
the principal solution matrix deﬁned by (2.3) and (2.4) is independent of φ0 and can be
decomposed as

∈

∈

[0, 1) and ˆW

⋆⋆⋆

Φ(θ) = ˆp(θ) ˆW exp(

ˆνθ) ˆW T ,

J

(3.1)

SO(3) is 2π–periodic and smooth and where ˆp(0) = I. Moreover,

where the matrix ˆp(θ)
λ(Φ(2π)) =

eiˆν2π, e−iˆν2π, 1

∈

.

{
Proof: Since, at J = 0,
Lemma 2.1a, we know that there exist µ
eiµ, e−iµ, 1
}
{
λ(Φ(2π)) =
{
matrix is that

and Φ(2π) = e ˆBµ where ˆB = ˆW
eiˆν2π, e−iˆν2π, 1

}
(θ, φ) is independent of φ, Φ(θ; φ0) is independent of φ0. From
SO(3) such that λ(Φ(2π)) =
[0, 1),
and Φ(2π) = e ˆB ˆν2π. A key property of the principal solution

ˆW T . Then with µ = 2πˆν, ˆν

[0, 2π) and ˆW

A

J

∈

∈

∈

}

Φ(θ + 2π) = Φ(θ)Φ(2π) ,

(3.2)

which we can see by noting that the l.h.s. of (3.2) is a solution matrix of (2.3) by the 2π–
periodicity of A and the r.h.s. is a solution matrix of (2.3) since Φ is. They are equal, by the
uniqueness of solutions to the initial value problem for (2.3) and (2.4), since they are equal
at θ = 0.

13

Deﬁne ˆp by ˆp(θ) := Φ(θ)e− ˆB ˆνθ. Clearly ˆp(0) = I and ˆp(θ)

ˆB is skew–symmetric. The periodicity of ˆp is clear because

∈

SO(3) since Φ

SO(3) and

∈

ˆp(θ + 2π) = Φ(θ + 2π) exp(

ˆB ˆν(θ + 2π)) = Φ(θ)Φ(2π) exp(

ˆB ˆν2π) exp(

ˆB ˆνθ) = ˆp(θ) ,

−

−

−

where (3.2) is used at the second equality.

✷

Using the Floquet theorem we now make several remarks concerning the principal solution
matrix deﬁned by (2.3),(2.4) when J = 0, i.e. when A is independent of φ0 and 2π–periodic
in θ. The “ ˆ ” symbol which was speciﬁc to the theorem is not needed in the following
remarks.

Remarks:

i,

(1) If Φ(θ) = p(θ) exp(Bνθ), where ν

∈
i, 0
}

[0, 1), where the real skew–symmetric matrix B
and where the matrix p(θ) is 2π–periodic, then
has the spectrum λ(B) =
p, B, ν will be called Floquet parameters. In particular ν is called a Floquet frequency.
Thus the Floquet theorem states that Floquet parameters exist and it implies that
the principal solution matrix depends on two frequencies where the Floquet frequency
emerges in addition to the circulation tune ωc = 1. Note that the Floquet parameter
p(θ) is a smooth element of SO(3) with p(0) = I.

−

{

∈

SO(3) exists such that W

(2) If p, B, ν are Floquet parameters as deﬁned in Remark 1, then from Lemma 2.1b a
W T = B, whence Φ(θ) = p(θ)W eJ νθ(p(0)W )T . Thus
W
at every φ0, p(θ)W is a 2π–periodic UPF with UPR ν, as deﬁned in Section 2. We
conclude that every Floquet frequency is a UPR of a 2π–periodic UPF and that (recall
Remark 2 of Section 2) a 2π–periodic unit–length function of θ exists, which is a spin
trajectory at every φ0. This is the n0 mentioned in the Introduction.

J

Conversely, if U is a 2π–periodic UPF, then by (2.15)

Φ(θ) = U(θ) exp(

νs(U)θ)U T (0) =: p(θ) exp(Bνθ) ,

(3.3)

J

where p, B, ν, deﬁned by

p(θ) := U(θ)U T (0) ,

B := U(0)

U T (0) ,

ν = νs(U) ,

J

fulﬁll all conditions of Floquet parameters. Thus the UPR of every 2π–periodic UPF is
a Floquet frequency, i.e. for 2π–periodic UPFs the UPR emerges as a Floquet frequency
and thus as an extra frequency of the system. We conclude that the set of Floquet
frequencies is identical with the set of UPRs which correspond to 2π–periodic UPFs.

(3) To study the set of Floquet frequencies in more detail, we ﬁrst consider two sets p, B, ν

and ˜p, ˜B, ˜ν of Floquet parameters, i.e.

Φ(θ) = p(θ) exp(Bνθ) = ˜p(θ) exp( ˜B˜νθ) .

(3.4)

From (3.4) at θ = 2π, we obtain Φ(2π) = exp(2πBν) = exp(2π ˜B ˜ν), so that λ(Φ(2π)) =
e2πiν, e−2πiν, 1
. Thus the set of Floquet frequencies has at most

e2πi˜ν, e−2πi˜ν, 1

=

{

}

{

}

14

two elements and (due to the Floquet theorem) at least one element. In particular,
the set of Floquet frequencies has either one element (which then is equal to 0) or it
has two elements ν, 1
ν, both of them positive. Note that a Floquet frequency which
is in [0, 1/2] always exists. Moreover, as we will see when we introduce the general
concept of spin tune with Deﬁnition 5.5, the set of spin tunes contains this set of Flo-
quet frequencies (see Remark 4 of Section 6). This in turn allows us to select one of
the Floquet frequencies as a “preferred” spin tune which we denote by ν0. In fact this
corresponds to the customary choice in which eiν02π is an eigenvalue of Φ(2π) [14, 15].

−

(4) By the deﬁnition of Floquet parameters, ν = 0 is a Floquet frequency iﬀ Φ(2π) = I.
From Remark 3 it follows that if 0 is a Floquet frequency, then it is the only Floquet
frequency. Furthermore all solutions of (2.1) are 2π–periodic iﬀ ν = 0 is a Floquet
frequency. It follows by Remark 2 that for the case ν = 0 every 2π–periodic UPF has
a zero UPR. See also Remark 4 in Section 6 and Theorem 6.4.

The Floquet theorem does not give a method for constructing the principal solution
matrix at J = 0 since ˆp is deﬁned by Φ, W and ˆν — it is a theorem about its properties.
We now construct, by the method pointed out in Remark 1 of Section 2, a standard form
for the principal solution matrix in order to compute Floquet parameters used in, or implied
by, other treatments of spin motion on the closed orbit [15, 24, 39]. We ﬁrst show that the
matrix (2.6) exists and can be chosen to be 2π–periodic in θ.

Let ξ3 with length 1 denote the eigenvector for eigenvalue 1 of the SO(3) matrix Φ(2π).
Then the solution of (2.1) with S0 = ξ3 is 2π–periodic since S(θ) = Φ(θ)ξ3 = Φ(θ)Φ(2π)ξ3 =
Φ(θ + 2π)ξ3 = S(θ + 2π). We now deﬁne v3(θ) := Φ(θ)ξ3. To complete the construction of
the matrix V we must now construct the 2π–periodic vectors v1 and v2. To do this we can,
for example, assume that a constant unit vector e exists such that v3(θ)
e has no zeros.
×
Then we can deﬁne v1(θ) := v3(θ)
v1(θ). In any case
the Floquet theorem ensures the existence of a smooth and 2π–periodic SO(3) matrix V (θ),
whose third column is v3(θ): just choose a SO(3) matrix V (0) whose third column is ξ3 and
then choose V (θ) = ˆp(θ)V (0).

and v2(θ) := v3(θ)

v3(θ)

e
|

e/

×

×

×

|

We now consider an arbitrary smooth 2π–periodic SO(3) matrix V whose third column
is a solution of (2.1) and we construct a 2π–periodic UPF and the corresponding standard
form for the principal solution matrix. From (2.9) and (2.10) cV (θ) is 2π–periodic and can
be written as cV = ¯cV + ˜cV where, as before, ¯cV and ˜cV are the mean and zero–mean parts
of cV . From Remark 1 of Section 2 we can write

U(θ) = V (θ) exp(

(α(θ) + kV θ))

J

(3.5)

θ

[0, 1) and the integer kV are chosen such that νV +kV = ¯cV .
where dα/dθ = ˜cV and where νV ∈
The principal solution matrix is then given by (3.3) with νs(U) = νV . Because the mean of
˜cV vanishes, the integral
α(θ)) and U(θ) are
2π–periodic in θ.

0 ˜cV (θ′)dθ′ is 2π–periodic in θ and thus exp(
J
R

The standard form for the principal solution matrix that we promised is given by the
ﬁrst equality in (3.3), where U is deﬁned by (3.5), and the UPR corresponding to U is given
kV . In (3.5) we have a procedure to calculate U(θ) and νs(U) and thus
by νs(U) = ¯cV −

15

Φ(θ), knowing a periodic solution of (2.1). From U(θ) and νs(U) one can construct Floquet
parameters as in Remark 2.

Remarks:

(5) From Remark 2 it is clear that the unit–length 2π–periodic spin trajectory n0 exists

and from Remark 4 it is clear that the direction of n0 is not unique iﬀ ν0 = 0.

(6) The above construction for v3(θ) is easily done numerically. First integrate (2.3) from
θ = 0 to θ = 2π numerically to determine Φ(2π) and then solve the linear system
Φ(2π)ξ3 = ξ3. Then v3 can be found on a grid of points in [0, 2π] by numerically
integrating (2.1) with S0 = ξ3. This is the way that n0(θ) is constructed in SLIM [14]
and other related spin codes.

(7) Since v3 is a 2π–periodic solution of (2.1) so is

v3. One can therefore replace V =
v3]. By (2.14) it follows that with this replacement
( 1
v3] leads
2, 1) then [v1,
−
2), so that one can choose V in (3.5) so as to put the UPR of U in [0, 1
2].

−
leads to νV ∈

¯cV . Thus if [v1, v2, v3]

[v1, v2, v3] by V = [v1,
¯cV becomes
(0, 1
to νV ∈

v2,

v2,

−

−

−

−

4 Quasiperiodicity and a Diophantine Condition

In the previous section we set up the Floquet form for the principal solution matrix for the
case J = 0 where A(θ) is 2π–periodic. However, one of our aims is to obtain an analogous
form when J
= 0, i.e. when A contains the frequency vector ω in addition to the circulation
tune 1. For this and other purposes we need to introduce the concept of quasiperiodicity.

A periodic function has one basic frequency whereas a quasiperiodic function has a ﬁnite
number of basic frequencies (tunes) denoted by ν = (ν1, ν2, . . . , νk). We give the following
deﬁnition.

Deﬁnition 4.1: a) A function f : R
Rk if a continuous and 2π–periodic function F : Rk

→

R exists and

R is said to be quasiperiodic with tune vector ν in

⋆⋆⋆

→
f (θ) = F (νθ) .

C is said to be quasiperiodic with tune vector ν in Rk if its real and
A function f : R
imaginary parts are quasiperiodic with tune vector ν in Rk. A real or complex matrix valued
function is said to be quasiperiodic with tune vector ν in Rk if its components are.
b) The spectrum of a quasiperiodic f is deﬁned by Λ(f ) :=

R : a(f, λ)

, where

= 0

→

λ

{

∈

}

c) The mean of f is deﬁned by

a(f, λ) := lim
T →∞

f (θ) exp(

iλθ)dθ .

−

1
T

T

0
Z

¯f := a(f, 0) ,

and the zero–mean part of f is denoted by ˜f and deﬁned by f =: ¯f + ˜f .

(4.1)

(4.2)

(4.3)
✷

The class of functions so deﬁned will be denoted by

(ν; k), where we refer to ν as the
tune vector and k as the order. If either ν or k are obvious from the context or not relevant

Q

16

6
6
we may omit either or both. We prove that a(f, λ) exists in Lemma 4.3d. Note that for k = 1
all functions in

are periodic. A tune vector ν is said to be nonresonant if the equation

Q

m

ν := m1ν1 +

+ mkνk = 0,

·

· · ·

∈

Zk (i.e. m is a k vector of integers), has m = 0 as the only solution. If there are
where m
nontrivial solutions then ν is said to be resonant. For some applications, e.g. as in Lemma
4.3d, a tune vector may be assumed to be nonresonant, since otherwise the order can be
reduced, as the following lemma shows.

Lemma 4.2 If f is in
ˆk

k.

Q

≤

(ν; k), then a nonresonant ˆν exists such that f is in

(ˆν; ˆk), where

Q

→

(ν; k) and let f : R

R. Then f (θ) = F (νθ) where F : Rk

→
If ν is nonresonant, then nothing has to be proved.

R
Proof: Let f
∈ Q
is continuous and 2π–periodic.
If
ν = 0, then f is constant, so that f
2
R,
and there exists nonzero m
∈
deﬁned by ˆF (z1, ..., zk−1) := F (
mkzk−1, m1z1 + ... + mk−1zk−1), is continuous
and 2π–periodic and f (θ) = F (νθ) = ˆF (ˆνθ) where ˆν :=
(1/mk)(ν1, ..., νk−1). The case
mk = 0 can be dealt with analogously because m is nonzero. We have therefore shown that
f
= 0. If ˆν is resonant, we can repeat the above procedure until
a nonresonant tune vector is obtained. For complex valued functions and matrix valued
✷
functions the proof proceeds analogously.

∈ Q
Zk such that m
mkz1, ...,

(1; 1). If ν is resonant and nonzero then k

ν = 0. If mk 6

= 0, then ˆF : Rk−1

1), where ˆν

(ˆν; k

∈ Q

→

≥

−

−

−

−

·

A diﬀerent proof of Lemma 4.2 can be found in [40, Appendix 3.8].

Q

The order in every

with domain Rk+l. Thus for an arbitrary real vector µ in Rl,
later use we note that if a is an integer, exp(

can also be increased since the F in (4.1) can be viewed as a function
(ν, µ; k + l). For
(1; 1).
(ν) obviously depends on ν, but two diﬀerent ν can generate the
is unaltered if ν is replaced by ˆν = Qν where Q is a matrix
(ν; k). To see this let
(ν; k). Then there exists a function F such that (4.1) holds. Let H(z) := F (Q−1z).
(ˆν; k) since f (θ) = H(ˆνθ).

The class of functions
same class. For example,
with integer entries and determinant
f
Then H is 2π–periodic since Q−1 has integer entries, and f
The converse is proved in the same way.

aθ) is 2π–periodic in θ and therefore in

(ˆν; k) iﬀ f

1, i.e. f

(ν; k)

∈ Q

⊂ Q

∈ Q

∈ Q

∈ Q

Q

Q

Q

Q

±

J

The periodic function F in Deﬁnition 4.1 has the Fourier series

Fm exp(im

z),

·

Xm∈Zk

where the Fourier coeﬃcients of F are deﬁned by

Fm :=

1
(2π)k

2π

2π

0
Z

· · ·

0

Z

F (z) exp(

im

−

z)dz1 · · ·

·

dzk

and where m

z := m1z1 +

+ mkzk. If F is of class C k and if we deﬁne

·

· · ·

SN (z) :=

Fm exp(im

z) ,

·

Xm∈Zk

||m||≤N

17

(4.4)

(4.5)

(4.6)

6
then the sequence
fN }
sequence
representation

{

converges uniformly to F on Rk [41, p.411]. Furthermore, the
, deﬁned by fN (θ) := SN (νθ), converges uniformly to f . Thus we have the

SN }

{

f (θ) = lim
N→∞

fN (θ) = lim
N→∞

Fm exp(i(m

ν)θ),

·

(4.7)

Xm∈Zk

||m||≤N

for f in terms of the Fourier coeﬃcients of F . Here the norm
:= max
is the max norm, i.e.

mk|}
For our deﬁnition of quasiperiodicity F is only required to be in C 0, not in C k. Thus in

of the integer vector m

m1|

, ...,

m

m

{|

||

||

||

||

|

.

general (4.7) does not apply and we need the following lemma.

Lemma 4.3 a) Let F be a continuous and 2π–periodic real or complex matrix valued func-
tion on Rk. Then the sequence

, deﬁned by

{

ΣN }
ΣN (z) :=

AN,m Fm exp(im

z) ,

·

Xm∈Zk

||m||≤N

(4.8)

converges uniformly to F on Rk, where

AN,m :=

k

N + 1

mn|

.

− |
N + 1

n=1
Y

b) If f
∈ Q
F (νθ), then

(ν; k) and if F is a continuous and 2π–periodic function on Rk such that f (θ) =

f (θ) = lim
N→∞

ΣN (νθ) = lim
N→∞

AN,mFm exp(i(m

ν)θ),

(4.9)

·

Xm∈Zk

||m||≤N

where the convergence is uniform. Thus (4.9) generalizes (4.7) to this less smooth case.
c) Let ν be nonresonant under the conditions of Lemma 4.3b. Then the mean of f , deﬁned
by (4.3), exists and is given by

¯f = F0 :=

1
(2π)k

2π

2π

0
Z

· · ·

0

Z

F (z)dz1 · · ·

dzk

(4.10)

and the Fourier coeﬃcients Fm of F in (4.5) satisfy the relation

Fm = lim
T →∞

f (θ)e−i(m·ν)θdθ = lim
T →∞

F (νθ)e−i(m·ν)θdθ .

(4.11)

1
T

T

0

Z

1
T

T

0

Z

In particular, f = 0 implies F = 0.
d) Let f be in
e) Let f be in

(ν; k). Then a(f, λ) exists for all λ.
Zk
(ν; k). Then Λ(f )

ν : m

m

⊂ {

·

∈

.

}

Q
Q

18

✷
Proof of Lemma 4.3a: See for example [42].
✷
Proof of Lemma 4.3b: A simple consequence of Lemma 4.3a.
Proof of Lemma 4.3c: That ¯f exists and equals F0 is proved for example in [43, Section
✷
10.3]. The proof of (4.11) is similar.
(ˆν; ˆk), where ˆν
Proof of Lemma 4.3d: Let f
∈ Q
iλ θ).
is nonresonant and where f exp(
✷
Applying Lemma 4.3c we conclude that a(f, λ) exists for all λ.
Proof of Lemma 4.3e: Since a(ΣN (ν

) denotes the function which maps θ to f (θ) exp(

), λ) and a(f, λ) exist by Lemma 4.3d we have

(ν; k). Then by Lemma 4.2, f exp(

∈ Q

iλ

iλ

−

−

−

)

·

·

|
=

a(ΣN (ν

lim
T →∞

|

), λ)
·
−
T
1
T

0

a(f, λ)

|
(ΣN (νθ)

)

a(ΣN (ν

|
·
f (θ)) exp(

−

f, λ)

|
iλθ)dθ

−

·
=

−

Z
where we note that ΣN (ν
norm. It follows that

·

sup
θ

|

| ≤

ΣN (νθ)

f (θ)

,

(4.12)

−

|

) and f are bounded functions and where

denotes the Euclidean

|·|

lim
N→∞

a(ΣN (ν

), λ) = a(f, λ) ,

·

(4.13)

since the convergence in (4.9) is uniform. If λ
and (4.13) gives a(f, λ) = 0. Thus if λ
Zk
Λ(f )

ν : m

6∈ {

m

.

6∈ {
m
·

ν : m

m
·
ν : m

∈

∈
Zk

Zk

}

}

, then λ

, then a(ΣN (ν

·

), λ) = 0
Λ(f ), so that
✷

6∈

⊂ {

·

∈

}

Remarks:

(1) Lemma 4.3a is a multidimensional generalization of Fej´er’s theorem and it shows that
a continuous function can be recovered from its Fourier coeﬃcients. For k = 1, ΣN in
. For k > 1 it is a natural generalization
SN }
(4.8) is the Ces`aro sum of the sequence
of Ces`aro summability and is one of many techniques for summation. The claim in
Lemma 4.3c that ¯f = F0, is a “ﬂow” version of Weyl’s equidistribution theorem which
is one of the main theorems of ergodic theory [26],[27, Chapter 3],[43]. Of course, if F
is in C k then SN and ΣN converge to the same function F .

{

(2) Deﬁnition 4.1 gives f in terms of F , and Lemma 4.3a and (4.11) show how to recover
F given f with nonresonant ν. Furthermore Lemma 4.3b gives a representation for f
even when (4.7) is not valid. If ν is resonant then Lemma 4.3 does not allow F to be
recovered. However we can ﬁnd ˆF for the nonresonant tune vector ˆν of Lemma 4.2.

(3) If f is quasiperiodic, then by Theorem 4.3d ¯f exists, whence ˜f := f

and the mean of ˜f exists. In particular ¯˜f = f
zero–mean part of f .

−

¯f is quasiperiodic
−
¯f = 0 which justiﬁes calling ˜f the

νθ : θ

(4) From (4.8) and (4.11) we see that F , for nonresonant ν, is determined by its values on
the curve D′ :=
. That this is to be expected can be shown as follows.
Because F is 2π–periodic, the knowledge of F at the points of D′ implies that F is
. But ˜D
even known at the points of the larger set ˜D :=
is dense in Rk since ν is nonresonant and any continuous function is determined by its
values on a dense set.

νθ + 2πM : θ

R, M

Zk

R

∈

∈

∈

}

{

}

{

19

The following deﬁnition will be convenient in some of our proofs:

Deﬁnition 4.4: A function f : R
R is said to be almost periodic if a complex sequence fn
N
and a real sequence λn exist such that the sequence of functions
n=1 fn exp(iλnθ) converges
C is said to be almost periodic if its real and
uniformly to f as N
→
imaginary parts are. A real or complex matrix valued function is said to be almost periodic
✷
if it is almost periodic in each component.

. A function f : R

→ ∞

P

→

Remark:

(5) Due to Lemma 4.3b, the quasiperiodic functions form a subset of the almost periodic
In contrast to the quasiperiodic functions, the almost periodic functions
functions.
generally have no ﬁnite set of basic frequencies. The Fourier representation of such a

∞

n=1
P

function is given by

fn exp(iλnθ), where

is the set of frequencies. A quasiperi-

λn}

{

odic function can be written in this way, but (4.7) is often more convenient for analysis.
Almost periodic functions were introduced by H. Bohr and a standard modern treat-
ment can be found in [44], and in summarized form in the appendix of [35].

We have now provided the basic machinery needed to deal with the quasiperiodic func-
tions appearing in the following sections. In the remainder of this section we treat a special
aspect of quasiperiodicity, namely the so called small divisor problem and we show how one
solves this problem by using suﬃciently diﬀerentiable functions. This material will only be
needed in Theorems 6.5c-d.

Integration as in the deﬁnition of α(θ) in Section 3 (see (3.5)) is, of course, a smoothing
operation and the integral of a periodic function with zero mean is periodic. It is perhaps
surprising then that the integral of a quasiperiodic function with zero mean is not necessarily
quasiperiodic. This is an example of the so–called small divisor problem. To see this let ν
(ν; k) with zero mean with its associated F in C k. Deﬁne
be nonresonant and let f be in
0 f (θ′) dθ′ for f given by (4.7). Because of the uniform convergence in (4.7) we can
g(θ) =
interchange limit and sum giving
R

Q

θ

g(θ) = lim
N→∞

Xm∈Zk

0<||m||≤N

i(m

ν)−1Fm

−

·

exp(i(m

ν)θ)

·

(cid:18)

−

1

.
(cid:19)

(4.14)

However, although g is well deﬁned, it may not be quasiperiodic if k
2. The source of the
ν, while not zero, can be arbitrarily small and this can lead
problem is that the divisor m
to an unbounded g, thereby contradicting (4.1). We give such an example in Section 8. To
ﬁnd a suﬃcient condition for quasiperiodicity we deﬁne

≥

·

GN (z) :=

Xm∈Zk

0<||m||≤N

i(m

ν)−1Fm

−

·

exp(im

z)

1

,

·

−

(cid:19)

(cid:18)

(4.15)

and note that g(θ) = limN→∞ GN (νθ) so that GN converges on the lines z = νθ + 2πl in
Rk where l is an integer. Now suppose that GN converges pointwise in Rk to a function G.
Then G is 2π–periodic and g(θ) = G(νθ). Since g is continuous, G is continuous along the

20

lines z = νθ + 2πl, but Deﬁnition 4.1 requires that G be continuous everywhere on Rk. So
we need a condition that ensures both pointwise convergence of GN and the continuity of
the limit. Uniform convergence guarantees both, and a suﬃcient condition for this is a so
ν can be to zero.
called “Diophantine condition” which places a condition on how close m
In the following we will be concerned with the tune vector ν = (1, ω) where 1 is the
Rd is the orbital tune. Thus we formulate the Diophantine condition
circulation tune and ω
and the convergence of GN in terms of ν = (1, ω) and k = d + 1. See [40, Appendix 4] for
some details on Diophantine conditions and [45] for further discussion and its use in another
beam dynamics context.

∈

·

Deﬁnition 4.5: The tune vector ω
positive τ , ω is in the Diophantine set Ω(τ ) :=

∈

Rd is said to satisfy a Diophantine condition if, for

γ∈(0,1] Ω(τ, γ) where Ω(τ, γ) is the set

ω

{

∈

Rd :

m

(1, ω)

|

·

γ

S
m
||

||

| ≥

−τ , m

Zd+1, m

= 0

∈

}

.

✷

Note that the symbol Ω is also used in the Introduction for the precession vector. However
its meaning should be clear from the context.

·

|

}

||

||

−τ

∈

Z

−

S

m

m

· · ·

Rd :

m
k

(1, ω)

(τ, γ, m), where

m∈Zd+1\{0} Z

= 1 and m1 6

It follows from the deﬁnition that Ωc(τ, γ) =
< γ

ω
|
(τ, γ, m) is either empty or a thickened d
(1, ω) = m0 + m1ω1 +

(τ, γ, m) :=
. For ﬁxed (τ, γ) and for each m the “resonant zone”
{
1 dimensional plane centered on the resonant
Z
+ mdωd = 0, with thickness proportional to γ. For
plane, m
·
example, when d = 1,
= 0 the corresponding zones are intervals centered
k
on the three points in R: ω1 = η where η
, each with thickness 2γ. When
d = 2,
= 0 the corresponding zones are centered on the twelve lines
with thickness either 2γ or √2γ.
in R2: ω1 = η, ω2 = η, ω2 =
ω1 + η where η
More generally, if m = (m0, ˆm) with m0 ∈
) then one can show by using
< γ||m||−τ
rotations in Rd that
| ˆm| + ω1|
.
| ˆm| }
Z
−τ /
. For m
Thus the thickened d
ˆm
m
||
|
||
−
such that ˆm = 0 the resonance condition cannot be satisﬁed and we have
(τ, γ, m) =
.
Z
Note also that

1, 0, 1
}
(Zd
\ {
{
(τ, γ, m) has thickness 2γ

(τ, γ, m) can be rotated into the set

(τ, γ, m) is undeﬁned for m = 0.

1 dimensional plane

= 1 and (m1, m2)

∈ {−
Z and ˆm

∈ {−

1, 0, 1

0
}
ω

m
k

Rd :

±

Z

∈

∈

m0

∅

k

}

|

|

Z

Deﬁnition 4.6 (orbital resonance): We say that the torus at J is oﬀ orbital resonance if
(1, ω(J)) is nonresonant (otherwise we say that it is on orbital resonance) and this is certainly
Ω(τ ). Usually, (1.5) is said to be resonant if ω is resonant. Our usage is
the case if ω(J)
✷
diﬀerent because our basic system is (2.1), which includes the circulation tune, 1.

∈

k

m
k

We can now interpret Ω(τ, γ) as the closed set in Rd constructed by successively remov-
(1, ω) = 0, with
ing the open resonance zones, corresponding to the resonance planes m
increasing
. Thus its construction is similar to the construction of a Cantor set. The
resonance planes are dense in Rd and thus Ω(τ, γ) is small in the sense that it has an empty
interior. However, we will show in the proof of Lemma 4.8 that it is large in the sense that
for τ > d + 1 the Lebesgue measure of its complement relative to Rd is proportional to γ (in
the sense of (4.23)) which can be arbitrarily small. We could take our Diophantine set to be
Ω(τ, γ) for γ small as in [45]. Here we take the larger set Ω(τ ).

·

21

6
6
∈

(1, ω))−1 Fm| ≤
and thus GN converges
m
Now if ω
uniformly if
converges. Thus the Diophantine condition leads to a simple
suﬃcient condition for the quasiperiodicity of g. In this context we now state and prove the
following lemma which addresses the diﬀerentiability of F .

Ω(τ, γ) then
Fm|
m

Fm|

γ−1

(m

P

||

||

||

||

·

|

|

|

τ

τ

Lemma 4.7 Let F : Rd+1
where 0 < τ < n
uniformly on Rd+1 to a smooth function G which is 2π–periodic. Moreover,
F (z).

Ω(τ )
R, given by (4.15) with ν = (1, ω), converges
(1, ω) =

R be of class C n and 2π–periodic and let F0 = 0. Let ω

2. Then GN : Rd+1

G(z)

→

→

∇

−

−

∈

d

·

Proof: Because a constant M
for every τ > 0,

≥

0 exists such that

m

M (see [41, p.409]), we have,

n

Fm| ≤

|

||

||

τ

m

||

||

Fm| ≤

|

M

Xm∈Zd+1

0<||m||≤N

||

||

Xm∈Zd+1

0<||m||≤N

m

τ −n = M

jτ −n

1 .

(4.16)

N

j=1
X

Xm∈Zd+1

||m||=j

A combinatorial argument gives

3d+1(d + 1)jd .

1

≤

Xm∈Zd+1

||m||=j

(4.17)

Moreover, if ω

Ω(τ, γ), then

(m

(1, ω))−1

γ−1

m

τ and (4.16) and (4.17) give

∈

|

·

| ≤

||

||

(m

|

(1, ω))−1Fm| ≤

·

3d+1(d + 1)Mγ−1

jτ −n+d .

(4.18)

d

2 we conclude that the l.h.s. of (4.18) converges as N

for every
−
It follows that GN converges uniformly to a continuous function G which is

→ ∞

−

Xm∈Zd+1

0<||m||≤N

Ω(τ ).

Since τ < n
ω
2π–periodic.
From (4.15) we have

∈

GN (z) =

∇

·

Xm∈Zd+1

0<||m||≤N

(m

(1, ω))−1Fm exp(im

z) m .

(4.19)

Then if ω

Ω(τ, γ) and repeating the above argumentation we ﬁnd

∈

GN (z)

|∇

| ≤

(m

|

(1, ω))−1Fm| |

·

m

| ≤

√d + 1

(m

|

(1, ω))−1Fm| ||

·

m

||

Xm∈Zd+1

0<||m||≤N

Xm∈Zd+1

0<||m||≤N

(4.20)

3d+1(d + 1)3/2Mγ−1

jτ +1−n+d .

≤

N

j=1
X

22

N

j=1
X

·

Thus, if ω
p.117]) means that G is C 1 and

Ω(τ ),

∇

∈

GN converges uniformly and a standard result (see [46, 8.6.3],[47,

G(z) = lim
N→∞

∇

·

Xm∈Zd+1

0<||m||≤N

(m

(1, ω))−1Fm exp(im

z) m .

(4.21)

·

(1, ω) = limN→∞ ∇

·

·

GN (z)

(1, ω) = F (z) since, with n

d + 1, the
✷

≥

G(z)
It follows that
SN in (4.6) converge.
Remark:

∇

(6) To prove (4.17) we deﬁne the sets s :=

m

s :
||
d+1
i=1 si and that si contains 2(2j + 1)d elements. Then

and si :=

= j

m

m

∈

∈

||

{

{

}

Zd+1 :

}

= j

. It follows that s =

mi|
|
s contains no more than 2(d + 1)(2j + 1)d elements and because
S
2(2j + 1)d

3(2j + 1)d

3(3j)d = 3d+1jd ,

≤

≤

we conclude that s contains no more than 3d+1(d + 1)jd elements, thus proving (4.17).

Lemma 4.7 provides the basic framework that we need for discussing the uniform con-
vergence of the sequence GN . In particular it shows that as n increases beyond τ + d + 2
the small divisor problem loses much of its potency. This comes as no surprise because the
M implies that the Fourier coeﬃcients decrease with increasing
inequality
more rapidly as n increases. Then with growing n the small divisor in (4.15) can come

Fm| ≤

m

m

||

||

n

|

||

||
closer to zero without destroying the convergence.

However, although Lemma 4.7 takes the mystery out of the working of the Diophantine
condition, it puts the burden on determining which ω are in the set Ω(τ ) and it is not so
easy to decide, oﬀ orbital resonance, if ω is in Ω(τ ). But some relief comes from the following
lemma, which shows that if τ > d + 1 then the complement, Ωc(τ ), of Ω(τ ) is a small set in
terms of Lebesgue measure. If in addition τ < n
2, the sequence GN converges uniformly
for almost every ω. For these two conditions to be consistent we thus need n > 2d + 3.
These results will be central to the statement and proof of Theorems 6.5c-d.

−

−

d

Lemma 4.8 If τ > d + 1, then µ(Ωc(τ )) = 0, where µ denotes the Lebesgue measure.

ω

Proof: Let B(R) :=
|
from Deﬁnition 4.5, Ωc(τ, γ)
S(R, m)) is undeﬁned for m = 0.
We will show below that

∈

∩

{

Rd :

ω

R
| ≤
B(R) =

}

and deﬁne S(R, m) :=
m∈Zd+1\{0}

S(R, m). Note that

Z

(τ, γ, m)

B(R). Then
∩
(τ, γ, m) (hence

Z

µ(S(R, m))

2γRd−1α(d

1)

m

||

||

−

−τ ,

(4.22)

where α(n) := πn/2/Γ(n/2 + 1) (note that α(d) is the volume of B(1)).
Assuming the validity of (4.22),

µ

Ωc(τ, γ)

B(R)

2γRd−1α(d

(cid:18)

∩

≤

(cid:19)

1)

−

m

−τ .

||

||

Xm∈Zd+1\{0}

S

≤

23

∞

j=1
X

∞

j=1
X

As before (see (4.17))

Therefore

m

−τ =

||

||

∞

j−τ

Xm∈Zd+1\{0}

j=1
X

Xm∈Zd+1

||m||=j

3d+1(d + 1)

jd−τ .

1

≤

µ

Ωc(τ, γ)

B(R)

2γRd−1α(d

1)3d+1(d + 1)

jd−τ ,

(4.23)

(cid:18)

∩

≤

(cid:19)

−

and for τ > d + 1 the series converges. Now Ωc(τ, 1/p) decreases monotonically to Ωc(τ ) as
the positive integer p

. Therefore

→ ∞

µ

Ωc(τ )

B(R)

∩

(cid:18)

= lim
p→∞

µ

(cid:18)

(cid:19)

Ωc(τ, 1/p)

B(R)

= 0

∩

(cid:19)

by continuity and the ﬁniteness of Lebesgue measure restricted to B(R) where the second
equality follows from (4.23). Since this is true for all R we obtain the required result.

To prove (4.22) we ﬁrst recall that

(τ, γ, m) is empty if m = (m0, 0, ..., 0). Thus S(R, m)
can only be nonempty if m = (m0, ˆm) with m0 ∈
) so that we only have
to consider this case. Using the fact that volumes are invariant under rotations it follows
from the remarks after Deﬁnition 4.5 that

Z and ˆm

(Zd

\ {

Z

∈

}

0

µ(S(R, m))

µ

ω

B(R) :

≤

∈

m0
ˆm
|

|

|

+ ω1|

< γ

m

||

||

−τ

,

}

(cid:19)

(4.24)

where we also used the fact that 1/
immediately yield (4.22). Furthermore, for d

| ≤

|

1. If d = 1 then (4.24) and the fact that α(0) = 1

2, we conclude from (4.24) that

≥

{
(cid:18)
ˆm

µ(S(R, m))

Rd :

2 + ... + ω2
ω2

R,

d ≤

+ ω1|

< γ

m

−τ

||

||

}

d ≤

R,

ω1|

|

< γ

m

||

||

= 2γRd−1α(d

m

−τ ,

−

||

||

(cid:19)
1)

≤

µ

ω

{
(cid:18)

∈

q
2 + ... + ω2
ω2

= µ

ω

Rd :

{
(cid:18)

∈

q

m0
ˆm
|

|

|
−τ

}

(cid:19)

−τ and radius R
where the r.h.s. is just the volume of the cylinder in Rd with height 2γ
and where in the ﬁrst equation we used the fact that volumes are invariant under translations.
✷
This completes the proof.

m

||

||

5 Introduction to the Quasiperiodicity of the Spin Mo-

tion.
Deﬁnition of the Spin Tune

We can now continue the study of the principal solution matrix Φ(θ; φ0, ω) for (2.1) which
is deﬁned by the initial value problem

∂Φ
∂θ

= A(θ; φ0, ω)Φ ,

Φ(0; φ0, ω) = I

(5.1)

24

where

(5.2)

(5.3)

A(θ; φ0, ω) :=

(θ, ωθ + φ0) .

A

(1, ω; d + 1). One of the aims of
; φ0, ω) is quasiperiodic in
In the language of Section 4 A(
this paper is to deﬁne the spin tune for this system. We are guided by the special case J = 0
of Section 3 and therefore, and as will become clear below, our emphasis in this section is on
; φ0, ω) is quasiperiodic and can be written in the
principal solution matrices, Φ, where Φ(
·
standard form,

Q

·

⋆⋆⋆

Φ(θ; φ0, ω) = U(θ) exp(

νθ)U T (0) ,

J

[0, 1) and both may
where U is a quasiperiodic SO(3) matrix in
depend on (φ0, ω).
(1, ω, ν; d + 2) with a very
simple frequency structure in the tune ν. Such principal solution matrices fulﬁll a generalized
Floquet theorem.

In that case all solutions of (2.1) are in

(1, ω; d + 1) and ν

Q

Q

∈

·

There has been extensive study of the equation ∂Φ/∂θ = A(θ; y)Φ, where the matrix
A(
; y) is almost periodic and y is a vector of parameters, one goal being to ﬁnd conditions
under which almost periodic solutions exist (see for example [44, 48]). However our problem
(5.1) is quite special because of the parameter dependence of A induced by
(θ, φ) in (5.2).
In fact, for every integer N we have

A

A(θ + 2πN; φ0, ω) = A(θ; 2πNω + φ0, ω) ,

(5.4)

A

The case J = 0 where A(

; φ0, ω)) of the principal solution matrix.

which follows from (5.2) and the 2π–periodicity of
(θ, φ) in θ. We will return to this in
Section 9 where we will see that condition (5.4) has useful consequences for the spectrum
Λ(Φ(
·

(1; 1) and independent of φ0
and ω, was discussed in Section 3. There we found a solution of (2.1) in
(1; 1), namely
v3(θ) = ˆp(θ)ξ3. All other linearly independent solutions are in
(1, ν; 2). The latter follows
directly from the Floquet theorem, but more importantly also from the construction of
the 2π–periodic UPF using v3 which led, with U in
(1; 1), to the representation (5.3).
It is this construction that points the way for a generalization of the Floquet theorem to
A

; φ0, ω) is 2π–periodic, i.e. in

(1, ω; d + 1).

Q

Q

Q

Q

·

∈ Q
We begin with the following proposition.

Proposition 5.1 Consider the initial value problem

˙S = A(θ)S , S(0) = S0 ,

(5.5)

(ν; k) and make the following assumptions:

with a real skew–symmetric 3
a) Equation (5.5) has a nonzero solution v3 in
b) There exists a smooth SO(3) matrix V = [v1, v2, v3] in
˙v1). Since c
c) Let c := v2

3 matrix A

(ν; k).

(Av1

∈ Q

Q

×

−
Remark 3 of Section 4). We assume that

∈ Q

·

˜c(θ′)dθ′

(ν; k).

∈ Q

(ν; k).

Q

(ν; k) its mean, ¯c, and zero-mean part, ˜c, exist (recall

θ

0
R

25

Then all solutions of (5.5) are in

(ν, νk+1; k + 1) where νk+1 = ¯c mod 1 and νk+1 ∈
Q

[0, 1).

Proof: From (c) there is an integer l such that c(θ) = ¯c + ˜c(θ) = νk+1 + l + ˜c(θ) and by the
same calculation that leads to (2.11) the principal solution matrix for (5.5) is

Φ(θ) = V (θ) exp

˜c(θ′)dθ′ + lθ)

exp (

νk+1θ) V T (0) .

θ

(

Z0



J



J





Clearly, Φ(θ)

(ν, νk+1; k + 1) and thus all solutions are quasiperiodic as stated.

✷

∈ Q

However as pointed out in Section 4, even if conditions a) and b) are fulﬁlled condition
c) might still be problematic since the integral of a zero–mean quasiperiodic function may
not be quasiperiodic.

To continue our discussion of the quasiperiodic structure of the principal solution matrix
deﬁned in (5.1) and its potential representation in (5.3) we elaborate on the deﬁnition of
UPF and UPR from Remark 2 in Section 2.

∈

Deﬁnition 5.2 (UPF and UPR): Consider (5.1) for a ﬁxed φ0 on a ﬁxed torus J0. If ν
[0, 1)
and U
SO(3) exist such that the principal solution matrix at φ0 can be written as in
(5.3), then the orthonormal coordinate system represented by U is called a UPF (uniform
precession frame) at φ0 and ν =: νs(U) is called the UPR (uniform precession rate) for U.
(1, ω; d + 1), then it is called proper. A UPR is called proper if it corresponds
If U
to a proper UPF. The set of all proper UPFs at φ0 is denoted by U(φ0) and the set of all
proper UPFs on the torus is given by U :=
φ0∈Rd U(φ0). In addition we denote the set of
all proper UPR s at φ0 by Ξ(φ0) and then the set of all proper UPR s on the torus is given
S
✷
by Ξ :=

∈ Q

∈

φ0∈Rd Ξ(φ0).

S

For further background material see Remarks 1 and 2 in Section 2. Recall that in Deﬁnition
5.2 “on a ﬁxed torus J0” means that the orbital tune has the value ω(J0) and that the spin
, J0). Recall also that we often suppress the
,
motion is characterized by the function
·
symbol J0. From the discussion in Section 2 we know that UPFs always exist. However the
existence of a proper UPF imposes additional constraints. For example Proposition 5.1 gives
rise to the existence of a proper UPF for (5.1) (and a proper UPR) but the conditions are
rather severe. If a proper UPF U at φ0 exists, then clearly Φ(
(1, ω, νs(U); d + 2).
However it is unknown if the converse holds although this is a reasonable conjecture. Note
that for each proper UPR there is an inﬁnite number of proper UPFs: if U is a proper UPF
at φ0 then U exp(

y) is a proper UPF at φ0 if y is a real constant.

; φ0)

∈ Q

A

(

·

·

It is easy to see that if a proper UPF U exists at a given φ0, then for all ν

[0, 1) such

J

Zd, ˜U(θ) := [u1(θ),

u2(θ),

∈
u3(θ)]

that ν =
exp(

±
(j0 + j

νs(U) + j0 + j

ω, where (j0, j)

Z

∈

×

·

·

ω)θ) is a proper UPF at that φ0 with νs( ˜U ) = ν. This motivates the
·
−J
deﬁnition of an equivalence relation where ν1 and ν2 in [0, 1) are said to be equivalent - and
ω. The
1, 1
we write ν1 ∼
equivalence relation partitions the interval into equivalence classes [ν] :=
}
∈
ν2. We note that if ω has one
[ν2] =
ν2 and [ν1]
such that [ν1] = [ν2] iﬀ ν1 ∼
irrational component then each [ν] is a dense subset of [0, 1). To see this suppose that ω1 is

Zd such that ν2 = εν1+j0+j

ν2 - iﬀ there exist (ε, j0, j)

×
iﬀ ν1 6∼

[0, 1) : µ

∈ {−

}×

∼

Z

∩

µ

∅

{

ν

·

±

±

26

irrational. Then εν + j1ω1 mod 1 is dense as j1 varies over Z so that µ = εν + j0 + j
dense in [0, 1) as j0 and j vary.

·

ω is

From the above motivation for the deﬁnition of equivalence it is clear that if ν1 ∈

Ξ(φ0)
Ξ(φ0). Now suppose that U1 and

Ξ(φ0), i.e. [ν1]

ν2 implies ν2 ∈

1 (0)U2(0) so that the l.h.s. is in

then the equivalence ν1 ∼
U2 are in U(φ0) and that νs(U1) = ν1. Then exp(
U T
·
by Lemma 4.3e. It is plausible that jd+2 =
Then since U2 is an arbitrary member of U(φ0), Ξ(φ0)
the joint conditions [ν1]

Ξ(φ0) and Ξ(φ0)

Q

±

J

⊂
νs(U2)θ) = U T

1. If that is so, then ν1 = νs(U1)

2 (θ)U1(θ) exp(

νs(U1)θ)
J
ω +jd+2νs(U1)
νs(U2).
[ν1]. In fact this is the case, and

∼

·

[ν1] can be embodied in a theorem.

⊂

(1, ω, νs(U1); d+2). Thus νs(U2) = j0 +j

⊂

⊂

Theorem 5.3 If Ξ(φ0) is nonempty with an element ν, then [ν] = Ξ(φ0).

Although all proper UPR s are equivalent at a given φ0 on the torus J0, it is not true in
general that all proper UPR s on the torus are equivalent. But if they are, we then say that
the torus is well–tuned and we call any ν
Ξ a spin tune. Since this situation is central to
this paper, we delay the proof of Theorem 5.3 in order to formalize this deﬁnition.

∈

Deﬁnition 5.4 (well–tuned): A torus is said to be well–tuned iﬀ the following two conditions
hold:
a) Φ(
·
b) Let U and ˆU be in U, then νs(U)
Theorem 5.3, [ν]

; φ0) has a proper UPF for each φ0 ∈
Ξ so that then, [ν] = Ξ.

Rd, i.e. each U(φ0) is nonempty.
Ξ, [ν]

νs( ˆU ). Thus for every ν

Ξ and, by

∼

⊃

∈

A torus that is not well–tuned is called ill–tuned.

⊂

✷

Note that by Theorem 5.3 a torus is well–tuned iﬀ the Ξ(φ0) have an element in common.
This criterion is very convenient and we will use it for example in the proof of Theorem 6.3a.
Note also that Ξ(φ0) always contains at most countably many elements. In particular, if a
torus is well–tuned then Ξ contains at most countably many elements.

Deﬁnition 5.5 (spin tune): Let a torus J0 be well–tuned, then each element of Ξ is called
✷
a spin tune. Thus for each spin tune ν, [ν] = Ξ.

To prove Theorem 5.3 we need the following lemma.

Lemma 5.6 Let exp(ic0θ), where c0 is a real constant, be in
exists n

≥
ν. Moreover n is unique if ν is nonresonant.

Zk such that c0 = n

(ν; k) with k

Q

1. Then there

∈

·

Proof: First of all we observe that

Also, by Lemma 4.3e we see that Λ(exp(ic0 ·
m

⊂ {
ν : m

c0 ∈ {

·

)) =

Λ(exp(ic0 ·
))

.

c0}
ν : m

{

·

m

Zk

.

}

∈

Zk

}

∈

. Hence by (5.6):

(5.6)

(5.7)

27

Thus n

Zk exists such that c0 = n

ν. Clearly n is unique if ν is nonresonant.

✷

∈

We can now prove Theorem 5.3.

Proof of Theorem 5.3: Consider U =: [u1, u2, u3] and ˆU =: [ˆu1, ˆu2, ˆu3], both in U(φ0), and
deﬁne the smooth functions g± : R

C by

·

→

g± := (u1

iu2)

(ˆu1 + iˆu2) .

±

·

(5.8)

It follows from (2.17) that

so that

˙g± = i

νs( ˆU )

νs(U)

g± ,

±

(cid:19)

(cid:18)

(cid:18)

⊃

∅

g±(θ) = exp

i(νs( ˆU)

νs(U))θ

g±(0) .

(5.9)

±

(cid:19)

Q

Because U and ˆU are in
(1, ω; d + 1), (5.8) ensures that g± are also in
if g+ is not the zero function then by (5.9) exp(i(νs( ˆU) + νs(U))θ) is in
Lemma 5.6 νs( ˆU ) + νs(U) = m
·
exist such that νs( ˆU)+νs(U) = m
νs( ˆU )
νs(U) = m
since otherwise uj
·
such that either νs( ˆU ) + νs(U) = m
·
exists such that νs( ˆU ) = ενs(U) + m
·
Theorem 5.3 we also have that Ξ(φ0)

(1, ω; d + 1). Now,
(1, ω; d + 1) and by
Zd+1
Zd+1 exist such that
(1, ω). By deﬁnition either g+ or g− is diﬀerent from the zero function,
·
Zd+1 exist
ˆuk = 0 for (j, k = 1, 2) which is obviously false. Thus m
∈
1, 1
(1, ω). Hence ε
}
[νs(U)]. But by the remarks before
✷

∈
(1, ω). Similarly either g− = 0 or m

(1, ω) or νs( ˆU)
−
(1, ω), i.e. Ξ(φ0)

Zd+1. Thus either g+ = 0 or m

(1, ω) for some m

νs(U) = m

[νs(U)].

Q
Q

∈ {−

−

⊂

∈

∈

·

·

Remarks:

(1) For the case of J = 0 and arbitrary φ0 each Floquet frequency ν0 is in Ξ(φ0) (see
Remark 2 in Section 3). We will see in Remark 4 of Section 6 that the torus J = 0 is
well–tuned so that every Floquet frequency ν0 is a spin tune.

(2) As we will see in Remarks 13 and 14 in Section 6, matrices

(θ, φ) can be found with

which there are tori where Ξ(φ0)

=

for every φ0 but which are not well–tuned.

A

(3) Consider a well–tuned torus. We say that the torus is on a “spin–orbit resonance” if

Ξ. Thus on spin–orbit resonance the set of spin tunes reads as
0
∈
ω; j0 ∈
ωs ∈
Ξ =
condition amounts to (1.3). In general the condition takes the form

[0, 1) : ωs = j0 + j

Z, j

Zd

∈

{

}

·

. For d = 3 the spin–orbit resonance

ωs = m0 + m1 ω1 +

+ md ωd

(5.10)

. Thus on a well–tuned torus, if
and the order of the resonance is
· · ·
one φ0 has resonant spin motion then all φ0 have resonant spin motion. Of course the
same is true for nonresonant spin motion. This is a key aspect of being well–tuned:
spin–orbit resonance is not deﬁned in terms of a spin frequency ωs that varies with φ0

md|

m1|

+

|

|

· · ·
+

28

6
in the sense that [ωs] is dependent on φ0. An important consequence of this deﬁnition
of resonance is presented in Theorem 6.4. Clearly, the order of a resonance depends
on the chosen ωs and that in turn depends on the chosen UPF. Thus the order of a
spin–orbit resonance is frame dependent. However, in practice the order is ﬁxed by
choosing a “preferred” spin tune and the corresponding UPF for every J. The way
to do this will be explained in Section 10 where some numerical results on spin–orbit
resonance are also mentioned. A numerical method for computing Ξ is outlined in
Section 9.

(4) If one component of ω is irrational and if the torus is well–tuned, then from the previous
discussion the sets Ξ and [0] are countable dense subsets of [0, 1). Thus even though the
complement of Ξ is uncountable and a number chosen at random from [0, 1) is unlikely
to be a spin tune, Ξ contains spin tunes arbitrarily close to any number in this interval.
This simply implies that every spin tune (in particular the preferred spin tune) is close
to a number in the resonance set [0] so that the system is always arbitrarily near to
a high order resonance. Although the set [0] is a dense subset of [0, 1), the subset of
low order spin–orbit resonances is not dense in [0, 1). Thus the closeness of a preferred
spin tune ωs to a number in the set [0] does not mean that ωs is near to a low order
spin–orbit resonance.

(5) The set ΞJ of proper UPR s on the torus J is a function of J which is uniquely deter-

mined by the J dependence of
A
depends on extra parameters like the beam energy, then the set ΞJ is also a function of
these parameters. Thus if all tori are well–tuned the spin tunes ωs will vary with J and
any extra parameters. Therefore the distance
from
the spin–orbit resonance condition (5.10) depends on J and any extra parameters.

and the orbital tune ω. Of course, if in addition,

m1 ω1 − · · · −

md ωd|

m0 −

ωs −

A

|

(6) Consider a torus for which U(φ0)

·

∅

=

; φ0). The corresponding UPR s νs(U(

for each φ0 and for each φ0 choose a single
; φ0)) deﬁne a function of φ0. If
proper UPF U(
; φ0)) can be chosen to be a constant. However for
the torus is well–tuned, then νs(U(
an ill–tuned torus, νs(U(
; φ0)) usually has to vary with φ0. This nonconstant function
can nevertheless be continuous and we present examples in Remarks 13 and 14 in
; φ0)),
Section 6. However, because of the freedom to choose the proper UPR s, νs(U(
this function is usually very irregular and discontinuous.

·

·

·

·

(7) If a torus is ill–tuned, then in domains of φ0 where νs(U(

that there are some φ0 s for which the resonance condition νs(U(
holds.

·

; φ0)) varies with φ0, it is likely
ω

; φ0)) = m0 + m

·

·

(8) If the principal solution matrix Φ can be written as

Φ(θ; φ0) = p(θ; φ0) exp

B(φ0)ν(φ0)θ

,

(5.11)

(cid:18)
[0, 1), B(φ0) is a real skew–symmetric matrix with spectrum
; φ0) is in

and the matrix p(

i, 0

(cid:19)

(1, ω; d + 1), then p, B, ν will be

Q

where ν(φ0)
λ(B(φ0)) =

∈
i,
{

−

}

·

29

6
·

∈

SO(3), with p(0; φ0) = I. Because p(

called generalized Floquet parameters at φ0. In particular ν(φ0) will be called a gen-
eralized Floquet frequency. By deﬁnition the generalized Floquet parameter p(θ; φ0)
is smooth in θ and p
; φ0) has the same
; φ0), the p, B, ν are indeed generalizations of the Floquet param-
periodicities as A(
eters introduced in Section 3. Note that (5.11) generates a large class of A s, namely
A(θ; φ0) = (∂Φ/∂θ)(θ; φ0)ΦT (θ; φ0), where Φ is given by (5.11).
If p(θ; φ0), B(φ0), ν(φ0) are generalized Floquet parameters at φ0, then from Lemma
W T (φ0) = B(φ0), whence Φ(θ; φ0) =
2.1b a W (φ0)
p(θ; φ0)W (φ0)eJ ν(φ0)θ(p(0; φ0)W (φ0))T . Thus p(θ; φ0)W (φ0) is a proper UPF at φ0
with UPR ν(φ0).
Conversely, if U(θ; φ0) is a proper UPF at φ0, then by (2.15), Φ can be written as in
(5.11) with p, B, ν given by

SO(3) exists such that W (φ0)

J

∈

·

p(θ; φ0) := U(θ; φ0)U T (0; φ0) ,
ν(φ0) := νs(U(

; φ0)) .

·

B(φ0) := U(0; φ0)

U T (0; φ0) ,

J

Therefore the UPR corresponding to a proper UPF is a generalized Floquet frequency
and is thus a frequency additional to those in A in analogy with the Floquet fre-
quency which emerges in the case where A is 2π–periodic. We conclude that the set of
generalized Floquet frequencies at an arbitrary φ0 is identical with the set Ξ(φ0).
at some φ0 implies that generalized Floquet param-
Note that the condition Ξ(φ0)
eters exist at that φ0. This can be viewed as a generalized Floquet theorem. Moreover,
if the torus is well–tuned, then for every φ0 generalized Floquet parameters exist and
the set of generalized Floquet frequencies is the same at every φ0 and is identical with
the set Ξ of spin tunes.

=

∅

(9) The spin trajectories at a given φ0 are quasiperiodic if Ξ(φ0)

; φ0)
(1, ω; d + 1) which give rise to nonquasiperiodic spin trajectories (see Section 8).

but there are A(

in

=

∅

·

Q

6 The Invariant Spin Field and the Quasiperiodicity of

the Spin Motion

In this section we present an application of the concepts introduced in Section 5. In particular
, J), a torus admits an invariant
we consider the important situation where for a given
spin ﬁeld, a central object in the theory of polarization whose relevance was explained in
the Introduction. It was pointed out there that the invariant spin ﬁeld is a solution to the
T–BMT equation along particle orbits and that it is 2π–periodic in θ and φ. We now return
to it and show, among other things, that if the torus is oﬀ orbital resonance, the existence
of a nonunique invariant spin ﬁeld implies that the system is on spin–orbit resonance. We
begin by studying general spin ﬁelds.

A

(

·

Let

(θ, φ) be a ﬁeld such that S(θ; φ0) :=
starts with phase φ0 at θ = 0. By (2.1) we must have

S

S

(θ, φ0 + ωθ) is the spin of the particle which

d
dθ

S(θ; φ0) =

(θ, ωθ + φ0) =

(θ, ωθ + φ0)

(θ, ωθ + φ0)

DS

A

S

30

6
6
and thus the evolution of the ﬁeld is described by the partial diﬀerential equation

⋆⋆⋆

=

(θ, φ)

.

DS

A

S

DS

(θ, φ), where Dk will denote the derivative with respect
(θ, φ) = D1S
Here,
to the k-th argument, be it scalar or multicomponent. Consider the generalized principal
solution matrix ϕ(θ, φ), deﬁned by

(θ, φ) + ω

· ∇φS

then the general solution of (6.1) is given by

ϕ =

(θ, φ)ϕ ,

ϕ(0, φ) = I ,

D

A

(θ, φ) = ϕ(θ, φ)

(0, φ

ωθ) .

S

−

S

This can be seen directly: since

is a derivation,

(θ, φ) =

ϕ(θ, φ)

(0, φ

ωθ) +

D

DS

D

(cid:18)

S

(cid:19)

−

ϕ(θ, φ)

(0, φ

ωθ)

and

(0, φ

ωθ)

= 0. Equations (6.1) and (6.2) are amenable

D

S

−

D

S

−

(cid:18)

(cid:19)

(cid:19)
to solution by the method of characteristics. In this case the characteristics for (6.1) are just
the spin trajectories S(

, φ0) and the characteristics for (6.2) are just the Φ(
·

Now suppose, as in Section 2, that we know one solution of (6.1). Let
V
such that its third column is this solution and make the transformation ϕ

(θ, φ) be in SO(3)

ψ deﬁned by

, φ0).

(cid:18)

·

→

ϕ =

ψ.

V

ϕ = (

)ψ +

D

DV

ψ =

ψ

AV

VD

Then

so that

and thus

ψ =

CV (θ, φ)

J

ψ ,

D

ψ(0, φ) =

T (0, φ) ,

V

where, in analogy to Section 2,

CV is deﬁned by
T (
) =

V

AV − DV

,

CV J

CV =

−

(1/2) T r[

T

(

T

)] ,

J

V

AV − V

DV

=

DV

AV − CV VJ

which is analogous to (2.13).
Equation (6.5) also can be solved by the method of characteristics giving

(6.1)

(6.2)

(6.3)

(6.4)

(6.5)

(6.6)

(6.7)

(6.8)

ψ(θ, φ) = exp

CV(θ′, ωθ′ + φ

−

ωθ)dθ′

T (0, φ

ωθ) ,

−

(6.9)

θ



J



Z0



V



31

as is easily checked by direct substitution in (6.5). The generalized principal solution matrix
thus becomes

ϕ(θ, φ) =

(θ, φ) exp

V

CV(θ′, ωθ′ + φ

−

ωθ)dθ′

T (0, φ

ωθ) .

(6.10)

−



V



The principal solution matrix of (5.1) is easily constructed from the generalized principal
solution matrix as the following theorem shows.

θ



J



Z0

Theorem 6.1 Let
satisfying (6.1). Then the principal solution matrix at φ0 on the torus is given by

(θ, φ) be a smooth SO(3) matrix on a ﬁxed torus, with third column

V

⋆⋆⋆

Φ(θ; φ0) = ϕ(θ, ωθ + φ0) =

(θ, ωθ + φ0)

exp

·



J

CV (θ′, ωθ′ + φ0)dθ′



V

T (0, φ0) .

(6.11)

V

θ

Z0


Proof: Clearly Φ(0; φ0) = I. Moreover, Φ satisﬁes (5.1) because (d/dθ)
0 CV (θ′, ωθ′ + φ0)dθ′ =
R

CV(θ, ωθ + φ0).

AV − CVVJ

and (d/dθ)



θ

V

(θ, ωθ + φ0) =

✷

We now give several deﬁnitions. In particular we give a formal deﬁnition of the invariant
spin ﬁeld.

S

∈

(θ, φ)

Deﬁnition 6.2 (ISF,IFF): Consider a ﬁxed torus.
R3 is said to be a spin ﬁeld for (2.1) iﬀ
a) A ﬁeld
in φ and if it satisﬁes the partial diﬀerential equation (6.1). A spin ﬁeld
invariant spin ﬁeld (ISF) for (2.1) if it is also 2π–periodic in θ and
= 1.
|S|
b) An SO(3) matrix,
is smooth in (θ, φ), 2π–
periodic in φ and if its third column is a spin ﬁeld. A frame ﬁeld is called an invariant frame
ﬁeld (IFF) for (2.1) iﬀ it is also 2π–periodic in θ. Thus the third column of an IFF is an ISF.
A uniform IFF,
CV as deﬁned by (6.7) is constant (independent
✷
of (θ, φ)) and in [0, 1).

is smooth in (θ, φ), 2π–periodic
is called an

(θ, φ), is called a frame ﬁeld for (2.1) iﬀ

, is such that the function

V

V

V

S

S

Note that in (6.10) both

and ϕ are frame ﬁelds.

V

·

; φ0), deﬁned by U(θ; φ0) :=

Theorem 6.3 a) Consider a ﬁxed torus.
U(
Moreover the torus is well–tuned and
b) Consider a ﬁxed torus. If
(6.8), where

CV is given by (6.7).

V

If a uniform IFF

(θ, φ0 + ωθ), is a proper UPF at φ0 with νs(U(

exists then, for every φ0,
CV .
is a frame ﬁeld then it satisﬁes the partial diﬀerential equation

CV is a spin tune.

; φ0)) =

V

V

·

Proof of Theorem 6.3a: From Theorem 6.1 it follows that U(
νs(U(

·
(1, ω; d + 1) so that the UPF U(

; φ0) is a UPF at φ0 with UPR
; φ0) is proper.

; φ0) is in

; φ0)) =

·

CV . Of course, U(

·

·

Q

32

CV is contained in each Ξ(φ0) we conclude (recall the comment after Deﬁnition 5.4)
✷

Because
that the torus is well–tuned and that
Proof of Theorem 6.3b: With

CV is a spin tune.

=:

v1, v2, v3

,

V

(cid:2)

(cid:3)

wj := (

)vj ,

D − A

(6.12)

(6.13)

(6.14)

T

)].
✷

and

so that

and since

is in SO(3) and

v3 satisﬁes (6.1), we have:

V

S ≡

·

w1 = (w1

v2)v2 ,

w2 =

(w1

v2)v1 ,

w3 = 0 ,

−

·

Because T r[

2 ] =

2, it follows from (6.14) that w1

v2 = (1/2) T r[

T

(

J

−

·

J

V

AV − V

DV

DV − AV

= (w1

v2)

.

·

VJ

We now make some further remarks on IFFs and ISFs.
Remarks:

(1) The name “invariant frame ﬁeld” (IFF) is chosen so as to reﬂect the fact that like the

ISF it is 2π–periodic in θ.

(2) If

V

is an IFF, then we call the v1, v2 in (6.12) pseudo–u1, u2–axes. They are used in the
program SPRINT for the numerical calculation of the spin tune [6, 8, 9, 12, 13, 23, 25].
If the IFF is uniform, then v1, v2 are called u1, u2–axes (see also [22, 24]). An example
of a numerical calculation of u1, u2–axes can be found in [13]. See Section 10 also.

(3) From the proof of Theorem 6.3b it follows for every IFF

that (see also [24])

V

CV (θ, φ) = v1
Thus if v2 is an ISF, then

·

(θ, φ)v2 +

v2

= Ω

v3 + v1

−A

(cid:18)
CV = 0 and

V

D

(cid:19)

·

is a uniform IFF.

v2) .

(

·

D

(6.15)

(4) A uniform IFF always exists for the closed orbit so that by Theorem 6.3a the torus
J = 0 is well–tuned. This follows easily from the fact that in this case proper UPFs
are uniform IFFs (see Remark 2 in Section 3). Thus at J = 0 every Floquet frequency
is a spin tune by Remark 1 of Section 5. Note also that for J = 0 any 2π–periodic spin
trajectory S with

= 1 is an ISF.

S

|

|

(5) Because the coeﬃcients of the partial diﬀerential equation (6.1) are 2π-periodic, it is
plausible that an ISF exists. But as we signaled earlier, it remains as a mathematical
challenge to prove it and in Remark 14 we will give an example where no ISF exists.
The coeﬃcients of the partial diﬀerential equation (6.8) are also 2π-periodic so that it

33

is again plausible, but again mathematically challenging to prove, that an IFF exists.
Note that if an ISF
is easily constructed in analogy with the
V
construction of V (θ) in Section 3 if there is a 2π–periodic smooth unit vector which is
(see also [24]). However, if there is no such unit vector then it
nowhere parallel to
can happen that an IFF

with the third column

exists, then an IFF

does not exist.

S

S

V

S

If an ISF does exist, it might not be unique.
resonance, as shown in the following theorem.

In that case the torus is on a spin–orbit

Theorem 6.4 Consider the case of a ﬁxed torus which is oﬀ orbital resonance and assume
that an ISF, n, exists. Let n be nonunique, i.e. let ˆn be another ISF such that the vector
product of n and ˆn is nonzero at some (θ, φ). Then a uniform IFF exists (so that the torus
is well–tuned) and the system is on a spin–orbit resonance.

D

Proof: Let n and ˆn be ISFs whose vector product is nonzero at some (θ, φ) and let the torus
2 is a smooth and 2π–periodic function
be oﬀ orbital resonance. We observe that F :=
n
×
F = 0. As will be shown below, it follows that oﬀ orbital resonance the function F
with
is constant. Thus the angle between the ISFs is the same at all points and m, deﬁned by
m := (n
n, m, n] is an IFF.
ˆn)/
:= [m
Due to Remark 3 the IFF
CV = 0. We conclude from Theorem 6.3a that
the torus is well–tuned and that 0 is a spin tune. In particular the torus is on a spin–orbit
resonance (see also Remark 3 in Section 5).

, is an ISF, perpendicular to n. Therefore

is uniform with

ˆn
|

ˆn
|

×

×

×

V

V

n

|

|

To complete the proof, we now consider a smooth and 2π–periodic function

: Rd+1

R

→

F

for which

= 0. We deﬁne

: Rd+1

R via

DF

(θ, φ + ωθ) .

(6.16)

H

→
(θ, φ) :=

H

F

Hence
H
smooth, we have

(θ, φ) is a smooth function 2π-periodic in φ such that D1H

= 0. Because

is

H

(θ, φ) =

(0, φ) +

H

H

0
Z
is 2π-periodic in θ, we obtain

Because

F

θ

D1H

(θ0, φ)dθ0 =

(0, φ) .

H

(6.17)

0 =

(2π, φ)

(0, φ) =

(2π, φ

2πω)

(0, φ) ,

F

− F

H

−

− H

whence by (6.17)

−
Thus for the Fourier coeﬃcients gr := (1/2π)d
follows that

H

0 =

(0, φ

2πω)

(0, φ) .

(6.18)

(0, φ) exp(

ir

φ)dφ of

(0,

) it

−

·

H

·

gr = exp(2πir

(6.19)

2π
0

· · ·

R

− H
2π
0 H
R
ω)gr ,

·

34

Zd. Because (1, ω) is nonresonant gr vanishes for r
(0, φ) is constant, i.e. independent of φ. Therefore by (6.17)

where r
4.3a
independent of θ, φ and then by (6.16)

H

∈

= 0. Thus by Lemma
(θ, φ) is constant, i.e.
✷

H

(θ, φ) is constant, i.e. independent of θ, φ.

F

Theorem 6.4 addresses the uniqueness of the ISF as well as its nonuniqueness. In partic-
ular, the contrapositive of Theorem 6.4 yields: if oﬀ orbital resonance a uniform IFF exists
and if the system is not on spin–orbit resonance, then the ISF is unique up to a sign. This
behavior was predicted earlier in [22].

We now focus on the case where an IFF exists and CV is not constant. We ﬁrst deﬁne

CV (θ, ωθ + φ0) .
(1, ω; d + 1), its mean, ¯cV(φ0), and zero–mean part, ˜cV(θ; φ0), exist. We

cV(θ; φ0) :=

(6.20)

Since cV(
thus have an important decomposition of CV , namely,

; φ0)

∈ Q

·

CV (θ, φ) = ¯cV(φ
Since the l.h.s. is 2π–periodic, the r.h.s. is too and in fact ¯cV(φ
ωθ) are
individually 2π–periodic as we check in Lemma 6.6a below. From (6.21) the integral in the
exponential of (6.10) is

ωθ) and ˜cV(θ; φ

ωθ) + ˜cV(θ; φ

(6.21)

ωθ) .

−

−

−

−

θ

Z0

CV (θ′, ωθ′ + φ

−

ωθ)dθ′ = θ¯cV (φ

ωθ) + βV(θ, φ) ,

−

where

Clearly
equation

D

βV (θ, φ) :=

˜cV(θ′; φ

ωθ)dθ′ .

−

θ

Z0

−

D

α(θ, φ) = ˜cV(θ; φ

ωθ) =: ˇ
F

−

(θ, φ).

βV(θ, φ) = ˜cV(θ; φ

ωθ), which leads to consideration of the partial diﬀerential

Then for every solution α of (6.24)

βV(θ, φ) = α(θ, φ)
The existence of a 2π-periodic α will be important below (note that ˇ
F

α(0, φ

ωθ) .

−

−

We now write

is always 2π-periodic).

where the integer kV(φ0) is uniquely determined by the condition νV (φ0)
generalized principal solution matrix from (6.10) now becomes

∈

¯cV(φ0) = νV(φ0) + kV(φ0) ,

(6.26)

[0, 1). The

ϕ(θ, φ)

=

=

V

U

(θ, φ) exp

(α(θ, φ)

α(0, φ

ωθ) + kV(φ

ωθ)θ + νV(φ

ωθ)θ)

−

−

(cid:18)
(θ, φ) exp (

J

J

νV(φ

−

−
ωθ)θ)

−
T (0, φ

U

T (0, φ

V

(cid:19)

ωθ)

−
(6.27)

ωθ) ,

−

35

(6.22)

(6.23)

(6.24)

(6.25)

6
where

where

(θ, φ) :=

(θ, φ) exp

(α(θ, φ) + kV(φ

ωθ)θ)

.

(6.28)

(cid:18)
Then the principal solution matrix becomes

U

V

−

(cid:19)

Φ(θ; φ0) = U(θ; φ0) exp(

νV (φ0)θ) U T (0; φ0),

(6.29)

J

J

U(θ; φ0) :=

(θ, ωθ + φ0)

U
(θ, ωθ + φ0) exp

=

V

J

(cid:18)

(α(θ, ωθ + φ0) + kV(φ0)θ)

.

(6.30)

(cid:19)

We can now state and prove the next basic result of this section. The proof will depend, in
part, on Lemma 6.6b which follows later in order not to break the ﬂow. Theorems 6.5c-d
use the Diophantine condition.

·

·

·

(

(

V

∈

A

A

; φ0),

3 and let

If an IFF,

, J0) be in C r.

, exists in C r and if

CU = νV.
d
−
−

, J0) be in C r. If an IFF,

Ω(τ ) then a uniform IFF exists (and thus the torus is well-tuned).

, exists and (6.24) has a smooth and 2π–periodic solution α, then U(

,
U
CU = νV. Moreover the torus is well–tuned and
; φ0), deﬁned for every φ0 by (6.30), is a proper UPF at φ0 whose UPR is a spin tune

Theorem 6.5 Consider a ﬁxed torus J0.
a) If an IFF,
deﬁned by (6.30), is a proper UPF at φ0 with UPR equal to νV (φ0).
b) If the conditions of Theorem 6.5a hold and if the torus is oﬀ orbital resonance, then
deﬁned by (6.28) is a uniform IFF and
U(
; φ0)) =
and νs(U(
·
c) Let 0 < τ < r
ω(J0)
d) Let r > 2d + 4 and let
in a Borel subset
µ-almost every ω(J0) in

, exists in C r for every ω(J0)
of Rd then a uniform IFF exists (and thus the torus is well-tuned) for

.
R
Proof of Theorem 6.5a: It is clear from (6.30) that U(
follows from (6.29).
Proof of Theorem 6.5b: From (6.28),
and 2π–periodic. Therefore
by Lemma 6.6b,
by Theorem 6.3a U(
torus is well–tuned.
Proof of Theorem 6.5c: From (6.7),
that the torus is oﬀ orbital resonance (since ω(J)
¯cV is a constant. Thus, by (6.21), ˇ
F
τ < r

(1, ω; d + 1) and the result
✷
is smooth
CU = νV. Thus
is a uniform IFF. Therefore
; φ0) is a proper UPF at φ0 with UPR νV which is a spin tune and the
✷
are in C r. Using the fact
Ω(τ )), we have by Lemma 6.6b that
¯cV is in C r−1. It follows from the condition

U
CU is constant, independent of φ0. Hence

CV is in C r−1 since
=

is an IFF. From (6.7) an easy calculation gives

have the same third column and

3 and Lemma 4.7 that

; φ0) is in

CV −

and

and

R

Q

A

∈

U

U

U

V

V

V

V

d

·

·

·

−

−

1
(1, ω)

ˇ
Fm exp(im

·

(θ, φ)) ,

(6.31)

α(θ, φ) =

Xm∈Zd+1\{0}

im

·

36

is smooth and 2π–periodic in θ and φ and that it satisﬁes (6.24), where ˇ
Fm denotes the m–th
✷
Fourier coeﬃcient of ˇ
F
3) is not empty so that we pick a τ in
Proof of Theorem 6.5d: The interval (d + 1, r
that interval. Because τ < r
) a
uniform IFF (and thus a well-tuned torus). Because τ > d + 1 we have by Lemma 4.8 that
✷
µ–almost every ω(J0) in

. The claims now follow from Theorems 6.5b and 6.3a.
d

3 we have, by Theorem 6.5c, for ω(J0)

. This proves our claim.

is in Ω(τ )

(Ω(τ )

∩ R

−

−

−

−

∈

d

R

∩ R

We now complete the discussion by stating and proving the Lemmas 6.6a and 6.6b mentioned
earlier in this section.

Lemma 6.6 a) If
θ and in φ.
b) If
constant.

V

V

denotes an IFF, then ¯cV(φ

ωθ) and ˜cV(θ; φ

ωθ) are 2π–periodic in

−

−

denotes an IFF and if the torus is oﬀ orbital resonance, then ¯cV, νV and kV are

Proof of Lemma 6.6a: The periodicities in (6.21) can be demonstrated as follows:

T

1
T

0 CV (θ′, φ
Z
ω(θ + 2π) + ωθ′)dθ′

−

ω(θ + 2π) + ωθ′)dθ′

¯cV(φ

−

ω(θ + 2π)) = lim
T →∞

2π, φ

−

T

0 CV (θ′
Z

T −2π

−2π

Z

−
CV (θ′′, φ
1
T

ωθ + ωθ′′)dθ′′

−
0

T

−2π −

(cid:18)Z

T −2π(cid:19)
Z

= lim
T →∞

= lim
T →∞

1
T
1
T

−

−

= ¯cV(φ

ωθ) + lim
T →∞

= ¯cV(φ

ωθ) ,

CV(θ′′, φ

−

ωθ + ωθ′′)dθ′′

(6.32)

, φ) is 2π–periodic and at the
where at the second equality we have used the fact that
last equality we have used the fact that
CV is bounded. This shows that the ﬁrst term on the
r.h.s. of (6.21) is 2π–periodic in θ and thus that all three terms in (6.21) have this periodicity
✷
property. That all three terms in (6.21) are 2π–periodic in φ is trivial.
Proof of Lemma 6.6b: Oﬀ orbital resonance we ﬁnd, due to (6.20) and by applying Lemma
2π
4.3c, ¯cV(0) = ¯cV(φ0) = (1/2π)(d+1)
CV dθdφ. Thus ¯cV , νV and kV in (6.26) are
0
✷
φ0-independent in this case.

CV (

2π
0

· · ·

·

R

R

Remarks:

(6) The 2π–periodicity in θ and φ of ¯cV (φ

the formal Fourier series

cm,nei(nθ+m·φ) of

−

ωθ) and ˜cV(θ; φ
−
CV where n
∈

ωθ) is suggested by examining
Zd. Then it is easy to
Z, m

show that the resonant module part of this sum, deﬁned by m
corresponds to ¯cV(φ
˜cV(θ; φ
orbital resonance the relation n+m
i.e. it is independent of φ0 as in Lemma 6.6b.

Zd+1
= 0 corresponds to
ωθ). Their formal Fourier series display the 2π–periodicity in θ and φ. Oﬀ
ω = 0 implies that n = m = 0 so that ¯cV(φ0) = c0,0,

ωθ). The remaining part with m

·
(1, ω)

−

−

∈

·

·

∈
(1, ω) = 0 for m

m,n
P

37

6
(7) Under the conditions of Theorem 6.5a, νV(φ0) is the UPR at φ0 associated with the
UPF deﬁned in (6.30). However the UPF is not unique since the principal solution
matrix in (6.29) can be written as

Φ(θ; φ0) = U(θ; φ0) exp(

J
so that ˆU (θ; φ0) = U(θ; φ0) exp(

h(φ0)) exp(

νV(φ0)θ) exp(

h(φ0))U T (0; φ0),

J

−J
h(φ0)) is also a UPF for an arbitrary smooth h(φ0).

J

(8) Under the conditions of Theorem 6.5a, and using the notation in (6.12), S(θ; φ0) =
Φ(θ; φ0)v3(0, φ0) gives a solution of (2.1) which is in
(1, ω; d + 1). This is easy to
check by (6.29): since
with zero
eigenvalue, S(θ; φ0) = v3(θ, φ(θ)) and νV (φ0) has dropped out. By (6.29) all other
linearly independent solutions are in

T (0, φ0)v3(0, φ0) = (0, 0, 1) is the eigenvector of

(1, ω, νV(φ0); d + 2).

Q

J

V

Q

(9) The IFF underlying the deﬁnition (6.26) of νV(φ0) is, of course, not unique. For

2, 1) then by changing the signs of v2 and v3 we ﬁnd νV(φ0)
( 1
2). Thus in analogy to the case J = 0 in Remark 7 in Section 3 we can choose

∈

∈
V

example, if νV (φ0)
(0, 1
such that νV ∈

[0, 1

2].

(10) If

V
νV =

denotes a uniform IFF, then cV, ¯cV, νV, kV are constant and ˜cV is zero. In particular
CV.

(11) Under the conditions of Theorem 6.5b it is possible, by rotating an arbitrary IFF into
a uniform IFF, to construct a proper UPF at every point φ0 of the torus such that the
UPR is independent of φ0 and is a spin tune.

(12) Theorem 6.5a holds on and oﬀ orbital resonance although if ω does not satisfy a
Diophantine condition, appropriate solutions of (6.24) may not exist. Note also that
in Section 8 we will consider an example where the conditions of Theorem 6.1 hold
but where it turns out that the conditions of Theorem 6.5a cannot hold due to the
presence of nonquasiperiodic spin motion.

(θ, φ) := √2J cos(φ

(13) To illustrate Theorem 6.5, it is instructive to consider simple, but perhaps unphysical,
with d = 1.
models. Here we will use the model deﬁned by
J
This represents a precession around the vertical and, of course, such an
will not
is a smooth and 2π–periodic function
be found in real storage rings. Note that
and, because (0, 0, 1) is an ISF, we can choose the IFF
= I so that by (6.7)
CV (θ, φ) = √2J cos(φ
θ). We ﬁrst consider a case on orbital resonance, ω = 1. From
(6.20), cV (θ; φ0) = √2J cos(φ0), whence ¯cV(φ0) = cV(θ; φ0), ˜cV = 0. Clearly (6.24) is
solved with α = 0 and (6.30) gives U(θ; φ0) = exp (
; φ0) is a proper
UPF at φ0 with UPR νV(φ0), where νV(φ0) and the integer kV(φ0) are determined by
the condition

kV(φ0)θ). This U(

as

θ)

A

A

A

−

−

J

V

V

·

kV(φ0) + νV(φ0) = √2J cos(φ0) .

(6.33)

Obviously, if J > 0, Ξ has uncountably many elements so that the torus is ill–tuned;
in particular, by Theorem 6.3a, no uniform IFF exists.

38

We now consider the case of irrational ω. From (6.20), cV(θ; φ0) = √2J cos((ω
1)θ +
φ0), thus ¯cV = 0 and ˜cV(θ; φ0) = cV(θ; φ0). Since ¯cV = 0, νV and kV are zero and since
α(θ, φ) = cV(θ; φ
1). Then (6.28)
(θ, φ) = exp
θ)
is a uniform
CU = 0. Hence by Theorem 6.3a the torus is well–tuned and on a spin–orbit
(cid:17)

ωθ), we have α(θ, φ) = √2J sin(φ
(√2J/(ω
1)) sin(φ

−
. One observes that

θ)/(ω

D
gives
U
IFF and
resonance.

−

−

−

−

−

J

U

(cid:16)

(14) In Theorems 6.3–5, we assumed that an ISF exists and for the physically interesting
s we hope this is true. It is also clear from Section 3 that for J = 0 an ISF does
= 0 this assumption in the theorems is not superﬂuous as
such that proper UPFs exist

A
exist. Nevertheless, for J
we will now show by constructing, for a ﬁxed torus, an
at every φ0 but an ISF does not.

A

We consider the case where d = 1, ω = 1 and where
is given by

A

(θ, φ) depends only on φ

θ and

−

(θ, φ)

A

ˆ
(φ
A

−

≡

θ) :=



0
Ω3(φ
Ω2(φ

−

−
−

−

Ω3(φ
θ)
0
θ) Ω1(φ

−

θ) Ω2(φ
Ω1(φ
0

−

θ)

−
−

θ)
θ)

.



−


Here the function Ω is smooth and 2π–periodic and we assume
solution matrix is given by Φ(θ; φ0) = exp( ˆ
A
with spectrum λ( ˆ
Ω(φ0)
,
Ω(φ0)
(φ0)) =
|
A
SO(3)-matrix W (φ0) exists such that

i
|
−

Ω
|
(φ0)θ). Because ˆ
A
, 0

< 1. The principal
is skew–symmetric
, it follows by Lemma 2.1b that a

i
|



}

{

|

|

ˆ
(φ0) = W (φ0)
A

|

Ω(φ0)

W T (φ0) .

|J

(6.34)

Hence

J |
so that W (φ0) is a proper UPF at φ0 with UPR

Φ(θ; φ0) = W (φ0) exp(

Ω(φ0)

|
Ω(φ0)

|

.

|

θ)W T (φ0) ,

(6.35)

We now proceed to construct an Ω such that an ISF does not exist. If an ISF n exists
then, by (6.3) and Theorem 6.1, we have

Φ(2π; φ0)n(0, φ0) = n(0, φ0 + 2πω) ,

for all φ0. Then, by (6.35),

exp(

Ω(φ0)

2π)W T (φ0)n(0; φ0) = W T (φ0)n(0; φ0) .

|
= integer, i.e. if Ω(φ0)

J |

|

Ω(φ0)

If
eigenvalue 1 is parallel to (0, 0, 1). In addition, since ˆ
A
that

| 6

= 0, then every eigenvector of exp(

2π) for
J |
(φ0)Ω(φ0) = 0, (6.34) implies

Ω(φ0)

|

W T (φ0)Ω(φ0) = 0 .

J

39

6
6
It follows that W T (φ0)n(0; φ0) and W T (φ0)Ω(φ0) are parallel to (0, 0, 1). Hence n(0; φ0) =
const

Ω(φ0). We conclude that for Ω(φ0)

= 0

×

Thus if an ISF n exists, then

n(0; φ0) =

Ω(φ0)/

Ω(φ0)

.

±

|

|

n(0, φ0) =

(cid:26)

Ω(φ0)/
if

|

±
ξ

Ω(φ0)

|

Ω(φ0) = 0 ,

if

Ω(φ0)

= 0

where ξ is arbitrary of norm one. To obtain our example, we present a smooth Ω such
does not have a continuous extension to those φ0, where Ω(φ0) = 0.
that Ω(φ0)/
|
Let ψ(x) := 1/ sin(x) and

Ω(φ0)

|

Ω(φ0) :=

(cid:26)

(1/2) sin3(φ0)(cos(ψ(φ0)),
sin(φ0) = 0 .
0

if

−

sin(ψ(φ0)), 0)

if

sin(φ0)

= 0

It is easy to show that Ω is smooth with
periodic. However

Ω
|

|

< 1 so that

(θ, φ) is smooth and 2π–

A

Ω(φ0)/

Ω(φ0)

=

|

|

sin(φ0)
sin(φ0)

|

|

(cos(ψ(φ0)),

sin(ψ(φ0)), 0) ,

sin(φ0)

= 0

−

does not have a continuous extension to all of φ0. Thus there is no ISF.

In summary, we have an example of a torus on orbital resonance for which a proper
UPF exists at each φ0 but which is ill–tuned because the set
}
is a subset of Ξ and has uncountably many elements. Furthermore there is no ISF and
thus no IFF. Of course, an
as exotic as that deﬁned here will not emerge from the
ﬁelds of a real storage ring.

(1/2)
|

: φ0 ∈

sin3(φ0)

A

R

{

|

(15) Now that IFFs are available we present another generalization of the Floquet Theorem.
Starting with (6.29) and assuming that the conditions of Theorem 6.5a hold, we write

Φ(θ; φ0) = U(θ; φ0) exp(
= U(θ; φ0)U T (0; φ0)U(0; φ0) exp(

J

νV(φ0)θ)U T (0; φ0)

νV (φ0)θ)U T (0; φ0)

= p(θ; φ0) exp

B(φ0)ν(φ0)θ

,

(cid:18)

(cid:19)

(6.36)

where

p(θ; φ0) := U(θ; φ0)U T (0; φ0) , B(φ0) := U(0; φ0)

U T (0; φ0) , ν(φ0) := νV (φ0) ,

and where U is given by (6.30). Thus U is a proper UPF. It follows from Remark 8
; φ0), B(φ0), ν(φ0) are generalized Floquet parameters at φ0. Thus
of Section 5 that p(
under the conditions of Theorem 6.5a we have generalized Floquet parameters and
have obtained a generalization of the Floquet theorem at every φ0. Note that νV(φ0)
is given by (6.26).

·

J

J

40

6
6
6
6
(16) For speed and practicality, simulations of particle motion in storage rings are often
made with the approximations that the ﬁelds at the ends of magnets fall to zero
abruptly (the “hard edge approximation”) or that a magnet has zero length but the
s are not smooth in
correct ﬁeld integral (the “thin lens approximation”). Then the
θ so that the theory of this paper would have to modiﬁed. For example an ISF would
be deﬁned without imposing smoothness in θ. The IFF would also not be smooth in
θ. We return to these matters in Section 10.

A

We now prove a simple partial converse of Theorem 6.3a which gives a large class of well–
tuned

s with a uniform IFF.

A

A

D

Theorem 6.7 Let q(θ, φ) be a SO(3) matrix which is of class C 2 and 2π–periodic such that
q(0, φ) = I and let b be a constant real skew–symmetric matrix. Let A be deﬁned by (5.2)
with

q + qb)qT . Then a uniform IFF exists, so that the torus is well–tuned.

= (

:= qW exp(

Proof: Because b is skew–symmetric, by Lemma 2.1b a constant SO(3) matrix W exists
[0, 1) and the integer m is constant. Deﬁning
such that b = (ν + m)W
(θ, φ) is 2π–periodic and
we have

mθ), we observe that the smooth SO(3) function
CV = ν. For the third column of
v3 =
(0, 0, 1) .
(0, 0, 1) =

W T , where ν

J
AV −

. Hence

V
that

(6.37)

V
V

DV

VJ

=

J

∈

ν

D

DV

AV

is an IFF. The IFF

is uniform so that by Theorem 6.3a
✷

V

So it is an ISF and therefore
the torus is well–tuned.

V

Remark:

(18) We obtain the principal solution matrix as in (6.29), with νV = ν and

U(θ; φ0) = q(θ, ωθ + φ0)W exp (

mθ) .

(6.38)

J

Combining (6.29) and (6.38) gives the generalized Floquet form

Φ(θ; φ0) = q(θ, ωθ + φ0)W exp (

(m + ν) θ) W T = q(θ, ωθ + φ0) exp(bθ).

J

We now apply some ideas of this section to some more simple models. Then in Section
9 we return to the general case and consider the spectrum of the principal solution matrix.

7 The Single Resonance Model

In this section we examine the so–called “single resonance model”. This model provides
an approximation for the matrix
and it is frequently used in approximate descriptions
of spin–orbit resonance eﬀects both in proton and electron rings [6, 49]. The reason for its
popularity is that it can be solved exactly and delivers useful indications about behavior
near spin–orbit resonance even though
is an approximation. Since it can be solved exactly
it provides an example for Φ(θ; φ0) in (6.29) and (6.30).

A

A

41

The single resonance model eﬀectively describes the spin motion for a particle limited
to a harmonic vertical betatron oscillation around a horizontal circular design orbit. Thus
there is only one pair of action–angle variables J, φ, and d = 1. The matrix
then contains
terms due to a constant vertical magnetic ﬁeld and terms due to a radial quadrupole ﬁeld
oscillating with the tune ω = dφ/dθ. The radial ﬁeld can be decomposed into two counter
rotating horizontal components rotating with the tune ω. Close to resonance it is suﬃcient
to consider just one of the rotating ﬁeld components and to neglect the other [15, 49]. The
matrix

then takes the form:

A

(φ) :=

A





−

0
σ1

σ1
−
0

σ2√2J sin(φ) σ2√2J cos(φ)

σ2√2J sin(φ)
σ2√2J cos(φ)
0

−





,

(7.1)

where σ1 and σ2 are real constants describing the strength of the vertical ﬁeld and of the
is a smooth function of φ, independent of
rotating horizontal ﬁeld respectively. Note that
θ.

A

Our ﬁrst aim is to show that a proper UPF exists at every φ0. We ﬁrst consider the case
= ω, σ2√2J
2J. Then it is easy to verify that (see

= 0 and deﬁne σ :=

ω)2 + 2σ2

A

⋆⋆⋆

σ1 6
also [6])

(σ1 −

p

v3(φ) =

σ2√2J cos(φ)
σ2√2J sin(φ)
σ1 −

ω

1
σ 



.





(7.2)

This is 2π–periodic and it satisﬁes (6.1). It is thus an ISF. Since (1, 0, 0)
can deﬁne v2(φ)

v3(φ) by

×

v3(φ)

= 0, we

⊥

v2(φ) :=

(1, 0, 0)
(1, 0, 0)

|

×
×

v3(φ)
v3(φ)

0

=

σ2

1
2J cos2(φ) 
2σ2

:= [v1, v2, v3] is smooth and 2π–periodic. It is thus an

−
σ2√2J sin(φ)

(7.3)

p

σ1





−

ω

|

,

and v1(φ) by v1 := v2
V
IFF. By (6.15),(7.2),(7.3) we obtain

v3. Thus

×

CV(φ) = Ω(φ)

v3(φ) + v1(φ)

v2(φ)) = σ +

(

·

D

·

σω(σ1 −
2σ2
−

ω)
2J cos2(φ)

,

σ2

(7.4)

so that

¯cV (φ0) = lim
T →∞

(1/T )

T

0
Z

dθ′ CV (ωθ′ + φ0) = (1/2π)

dφ CV(φ) ,

(7.5)

2π

0
Z

where we use the 2π–periodicity of CV. Thus ¯cV(φ0) is independent of φ0. Since [50, p.379]

π/2

0
Z

(σ1 −

dφ

ω)2 sin2(φ) + σ2 cos2(φ)

=

2σ

π
σ1 −

|

,

ω

|

42

6
6
and since by (7.4) and (7.5)

¯cV = σ +

= σ +

= σ +

ω)

σω(σ1 −
2π
σω(σ1 −
π
2σω(σ1 −
π

ω)

2π

dφ

0
Z
π

(σ1 −

dφ

ω)2 cos2(φ) + σ2 sin2(φ)

0
Z
ω)

(σ1 −

π/2

ω)2 cos2(φ) + σ2 sin2(φ)
dφ

0
Z

(σ1 −

ω)2 sin2(φ) + σ2 cos2(φ)

,

(7.6)

we can make the assignments

¯cV = σ + ω sign(σ1 −

ω) ,

˜cV (φ) =

σω(σ1 −
2σ2
−

ω)
2J cos2(φ) −

σ2

ω sign(σ1 −

ω) . (7.7)

Because ˜cV does not depend on θ one ﬁnds that (6.24) has smooth solutions α(φ) which do
not depend on θ and that one of those solutions reads as

α(φ) =

dφ′ ˜cV(φ′) .

φ

1
ω

0

Z

(7.8)

Since 0 =
2π–periodic in φ. Thus Theorem 6.5a applies and one concludes that U(

dφ˜cV(φ) and by the 2π–periodicity of ˜cV(φ) it follows by (7.8) that α(φ) is

; φ0), deﬁned by

2π
0

R

U(θ; φ0) =

(φ0 + ωθ) exp

V

φ0+ωθ

(

1
ω

J

(cid:18)

φ0

Z

dφ′ ˜cV(φ′) + kVθ)

,

(7.9)

·

(cid:19)

is a proper UPF at φ0 with UPR νV . Here νV and the integer kV are uniquely determined
by ¯cV via (6.26) and (7.7). Because νV is contained in each Ξ(φ0) we conclude (recall the
comment after Deﬁnition 5.4) that the tori are well–tuned when σ1 6
We now discuss the general case using the machinery of Section 6.

= ω and σ2√2J

= 0.

Proposition 7.1 The single resonance model has a uniform IFF for every value J of the
orbital action variable. Hence the corresponding torus is well–tuned.

Proof:

For

(θ, φ) := exp(φ

) one obtains

Y

J

where

T (

Y

AY − DY

) = E ,

(7.10)

E :=



0
σ1 −
0

ω

−

σ1 + ω
0
σ2√2J

0
σ2√2J
0

−

.



This has eigenvalues λ(E) =
is a uniform IFF and



iσ,


. If σ = 0, then E = 0 and, due to (6.6) and (7.10),
CY = 0. Thus by Theorem 6.3a the tori are well–tuned and 0 is a

iσ, 0

−

}

{

= 0, then by Lemma 2.1b we can choose W

SO(3) such that

Y
spin tune. If σ

W −1EW = σ

=: (ν + k)

,

∈

J

J

43

6
6
where the integer k is chosen such that ν

[0, 1). We now deﬁne

∈

Y

(θ; φ) :=

(θ; φ)W exp(kθ

) ,

J

U

and obtain

T (

U

AU − DU
is a uniform IFF and
k is a spin tune.

−

) = ν

.

J
CU = ν = σ

It follows by (6.6) that
U
tori are well–tuned and σ

Remarks:

k. Thus by Theorem 6.3a the
✷

−

(1) The proof of Proposition 7.1 and Deﬁnition 5.5 show that the spin tunes ωs of the

single resonance model have the form

ωs = εσ + jω + k ,

(7.11)

1, 1

; j, k

∈ {−

Z. Conversely every constant of the form (7.11) is a spin
where ε
In particular the set Ξ(φ0) is
tune of the single resonance model, if it is in [0, 1).
independent of φ0. Note that for the single resonance model, spin tunes exist also on
orbital resonance, i.e. for rational ω. See Remark 4 too.

∈

}

(2) The case σ2√2J = 0 represents the absence of betatron motion, i.e. motion on the
design orbit. In this case ε, j, k can be chosen in (7.11) such that the spin tune reduces
to σ1.

(3) From the expression for σ it is clear that during variation of σ1, the spin tune in (7.11)
comes closest to the spin–orbit resonance ωs = k + jω when σ1 = ω. However for the
case σ2√2J

= 0 of principle interest, the resonance condition is not reached.

(4) If ω is an integer, the matrix A is one–turn periodic and the ISF can be obtained
as the eigenvector of length 1 of the one–turn principal solution matrix. Moreover,
every proper UPF is one–turn periodic and its UPR can be obtained from the complex
eigenvalues of the one–turn principal solution matrix just as in Section 3. Of course, this
UPR is a spin tune. If ω is rational, the ISF can be obtained as the eigenvector of length
1 of the appropriate multi–turn principal solution matrix. See, e.g.
[51]. Every proper
UPF is then multi–turn periodic and its UPR is extracted from the corresponding
complex eigenvalues and is again a spin tune. Note that this circumstance that a spin
tune exists even on orbital resonance has its origin in the facts that the single resonance
model has only one orbital frequency and that

is independent of θ.

A

(5) If the orbital tune is rational then with Proposition 7.1 we have an example of a torus
which is on orbital resonance but is nevertheless well–tuned. This is an example for
which the torus may be on orbital resonance but still satisfy the conditions of Theorem
6.3a.

44

6
8 The Moser-Siegel Model

In this section we construct and study an illustrative but unphysical model which, for reasons
which will become clear, we will call the “Moser-Siegel model”. This model has d = 1, can
be solved exactly, and has two real parameters σ1, σ2, where σ1 > 1. For certain choices of
the orbital tune ω and of σ1, σ2 the Moser-Siegel model provides an example of spin motion
which is nonquasiperiodic. The matrix

of the Moser-Siegel model takes the form:

:=

A

A21J

,

A21(θ, φ) :=

σ−k−l
1

ηkl sin(kφ

lθ) ,

−

(8.1)

A

∞

Xk,l=1

⋆⋆⋆

where

ηkl :=

1 ,

1 ,

(cid:26)

−

if kσ2 −
if kσ2 −

l
0 ,
≥
l < 0 ,

is smooth (in fact C ∞) and 2π–periodic. The latter follows from the
and by deﬁnition
for a nonnegative integer n, which follows from the ratio test and
convergence of
which implies that the series in (8.1) and the series of all its derivatives converge uniformly
(see [46, 8.6.3],[47, p.117]).

A
∞
k=1 knσ−k

P

1

A(θ; 0) = f (θ)

,

f (θ) =

J

σ−k−l
1

ηkl sin((kω

l)θ) .

−

Clearly f

(1, ω; 2) and for an irrational ω, ¯f = 0 by Lemma 4.3c, so that

For φ0 = 0,

∈ Q

where

∞

Xk,l=1

J

Φ(θ; 0) = exp (

g(θ)) ,

g(θ) :=

˜f (θ′)dθ′ .

θ

Z0

(8.2)

(8.3)

(8.4)

Because the function g has been used in [52, Paragraph 36], we call our model the Moser–
Siegel model.

Proposition 8.1 For some ω
these values, exp(ig) is not quasiperiodic whence Φ(

6∈

Q there exist values of σ1, σ2 such that g is unbounded. For

; 0) is not quasiperiodic.

·

Q exist such that g
Proof: It is shown in [52, Paragraph 36] that values of σ1, σ2 and of ω
is unbounded. Thus, for these values, ˜f is an almost periodic function whose integral, g, is
unbounded. It then follows (see [44, Chapter 6]) that exp(ig) is not almost periodic, whence
✷
at least one of cos(g) and sin(g) is not almost periodic.

6∈

Remarks:

(1) Proposition 8.1 shows that for certain values of σ1, σ2 and of ω the principal solution
. In particular, for those

matrix at φ0 = 0 is not quasiperiodic, so that Ξ(φ0 = 0) =
values the torus is ill–tuned so that, by Theorem 6.3a, it has no uniform IFF.

∅

45

(2) The unit matrix obviously provides an IFF for the Moser-Siegel model. Thus Propo-
sition 8.1 demonstrates that the existence of an IFF is neither suﬃcient for having a
uniform IFF nor for having a well–tuned torus. In the context of Theorem 6.5a this
means that the existence of an IFF does not necessarily admit a smooth solution α of
(6.24), which is 2π-periodic.

9 Spectral Analysis of Quasiperiodic Spin Motion

In the code SPRINT, ISFs are calculated nonperturbatively in three ways, namely by stro-
boscopic averaging, by the SODOM2 algorithm and by adiabatic antidamping [6, 8, 9, 12,
13, 23, 25]. Perturbative algorithms for obtaining ISFs are listed in the Introduction. More-
over the spin tune is calculated nonperturbatively in SPRINT by logging the spin precession
around the ISF or by the SODOM2 algorithm. We will make further comments on these
simulations in Section 10.

The fact that under appropriate conditions the set of generalized Floquet frequencies is
the set of spin tunes, suggests a further way to obtain the spin tune, namely by spectral
analysis of quasiperiodic functions. The way forward is contained in the following theorem.
As we shall see, we can also use spectral analysis to construct the ISF.

Theorem 9.1 Consider a uniform IFF
a) Let S be a spin trajectory at φ0. If 0
Section 5, then S is in
b) Let S be a spin trajectory at φ0 and let the torus be oﬀ orbital resonance. Also, let 0
Then ˆS, deﬁned by

on a ﬁxed torus. Then the following holds.
V
CV ], where the equivalence class [
[
∈

CV ] is deﬁned in
CV ].
[

(1, ω; d + 1).

Q

6∈

ˆS(θ) := lim
N→∞

Xm∈Zd+1

||m||≤N

AN,m exp(iθm

(1, ω))a

S, m

(1, ω)

,

(9.1)

·

·

(cid:18)

(cid:19)

with AN,m :=

d+1
n=1

N +1−|mn|
N +1

, satisﬁes the relation

Q

ˆS(θ) = n(θ, φ0 + ωθ) ˆS(0)

n(0, φ0) ,

·

where n is the ISF n :=
c) For arbitrary φ0,

V

(0, 0, 1). Moreover, ˆS is a spin trajectory in

(1, ω; d + 1).

Q

⋆⋆⋆

Λ(Φ(
·

; φ0))

ε

CV + m

·

⊂ {

(1, ω) : (ε, m)

0, 1,

1
−

} ×

∈ {

Zd+1

.

}

Proof of Theorem 9.1a: For ﬁxed φ0, deﬁne U(θ) :=
U is a proper UPF at φ0 and we have

V

(θ, φ0 + ωθ) so that by Theorem 6.3a

Φ(θ; φ0) = U(θ) exp(

J CV θ)U T (0) .

Thus if 0

CV ], then Φ(
[

·

∈

; φ0), and therefore S, is in

(1, ω; d + 1).

Q

(9.2)

(9.3)

✷

46

(9.4)

(9.5)

(9.6)

CV

(cid:19)
(9.7)

Proof of Theorem 9.1b: Because the U, deﬁned in the proof of Theorem 9.1a, is in
Q
1) and because the torus is oﬀ orbital resonance we can use Lemma 4.3b-c to write

(1, ω; d+

U(θ) = lim
N→∞

Xm∈Zd+1

||m||≤N

AN,m exp(iθm

(1, ω))a

U, m

(1, ω)

.

·

·

(cid:18)

(cid:19)

∆± :=

1
2 

1
i
∓
0

i 0
±
0
1
0
0

,

∆0 :=





0 0 0
0 0 0
0 0 1





,






and recalling (2.12), we have

exp(

J CV θ) = ∆+ exp(i

CV θ) + ∆− exp(

CV θ) + ∆0 ,
i
−

a

U exp(

), m

(1, ω)

= a

U∆+, m

(1, ω)

+ a

U∆−, m

(1, ω) +

·

− CV

(cid:19)

(cid:18)

·

(cid:18)

(cid:19)
.

J CV ·

·

(cid:18)

·

+a

U∆0, m

(1, ω)

(cid:19)

(cid:18)
CV ], then
[
Λ(U). Then 0 = a

6∈

±CV 6∈ {
U, m

m

(1, ω) : m

Zd+1

.

It follows from Lemma 4.3e that

·
(1, ω)

·

∓ CV

(cid:19)

}

∈
so that (9.7) leads to

a

U exp(

), m

(1, ω)

= a

U∆0, m

(1, ω)

.

(9.8)

J CV ·

·

(cid:19)

(cid:18)

·

(cid:19)

(cid:18)

(cid:18)

Combining (9.3), (9.4), (9.8) we obtain

U(θ)∆0 = lim
N→∞

Xm∈Zd+1

||m||≤N

AN,m exp(iθm

(1, ω))a

U∆0, m

(1, ω)

·

(cid:18)

AN,m exp(iθm

(1, ω))a

U exp(

), m

(1, ω)

J CV ·

AN,m exp(iθm

(1, ω))a

Φ(

; φ0)U(0), m

(1, ω)

.

·

·

·

·

(cid:19)

(cid:19)

(cid:19)

= lim
N→∞

= lim
N→∞

Xm∈Zd+1

||m||≤N

Xm∈Zd+1

||m||≤N

(cid:18)

(cid:18)

·

·

·

47

U(θ)∆0U T (0) = lim
N→∞

AN,m exp(iθm

(1, ω))a

Φ(

; φ0), m

(1, ω)

.

(9.9)

·

(cid:18)

·

(cid:19)

Xm∈Zd+1

||m||≤N

With

so that

Since 0

±CV 6∈

Hence

Then, because S is a spin trajectory at φ0,

U(θ)∆0U T (0)S(0) = lim
N→∞

AN,m exp(iθm

(1, ω))a

Φ(

; φ0)S(0), m

(1, ω)

·

·

(cid:18)

·

(cid:19)

Xm∈Zd+1

||m||≤N

= lim
N→∞

Xm∈Zd+1

||m||≤N

AN,m exp(iθm

(1, ω))a

S, m

(1, ω)

= ˆS(θ) ,

·

·

(cid:18)

(cid:19)

(9.10)

where the last equality follows from (9.1). From (2.17), (9.3), (9.5), (9.10) it follows that

˙ˆS(θ) = ˙U (θ)∆0U T (0)S(0) =

A(θ; φ0)U(θ)

− CVU(θ)

J

∆0U T (0)S(0)

(cid:19)

(cid:18)

= A(θ; φ0)U(θ)∆0U T (0)S(0) = A(θ; φ0) ˆS(θ) .

(9.11)

Thus ˆS is a spin trajectory at φ0. By (9.10) and because U is proper, ˆS is in
(1, ω; d + 1), then by Lemmas 4.3b and 4.3c

If S is in

Q

(1, ω; d + 1).

Q

S(θ) = lim
N→∞

Xm∈Zd+1

||m||≤N

AN,m exp(iθm

(1, ω))a

S, m

(1, ω)

,

(9.12)

·

·

(cid:18)

(cid:19)

so that in this special situation, ˆS = S. Thus, for an arbitrary spin trajectory S at φ0, the
ˆˆS of S from the double application of (9.1) is equal to the single transform
double transform
ˆS so that (9.10) yields

U(θ)∆0U T (0) ˆS(0) =

ˆˆS(θ) = ˆS(θ) .

(9.13)

If θ = 0, (9.13) becomes an eigenproblem for ˆS(0). The solution is ˆS(0) =
Inserting this into (9.13) yields

ˆS(0)
|

±|

U(0)(0, 0, 1).

ˆS(θ) =

ˆS(0)
|

±|

n(θ, φ0 + ωθ) = n(θ, φ0 + ωθ) ˆS(0)

n(0, φ0) ,

(9.14)

and where S is an arbitrary spin trajectory at φ0. ✷

where n denotes the third column of
Proof of Theorem 9.1c: By (9.3) and (9.6) we have

V

Φ(θ; φ0) = U(θ)

∆+ exp(i

CV θ) + ∆− exp(

CV θ) + ∆0
i
−

U T (0) .

(9.15)

·

(cid:19)

If λ

Λ

U∆+ exp(i

)U T (0)

, then

CV ·

∈

(cid:18)

(cid:18)

(cid:19)

λ

− CV ∈

Λ

U∆+U T (0)

.

(cid:19)
Because U is proper and with Lemma 4.3e, Λ(U∆+U T (0))
with (9.16), λ

(1, ω) : m

. Then

Zd+1

(cid:18)

∈

}

(9.16)

m

(1, ω) : m

Zd+1

. Thus

⊂ {

·

∈

}

U∆+ exp(i

)U T (0)

CV ·

⊂ {CV + m

·

(1, ω) : m

Zd+1

.

}

∈

(9.17)

∈ {CV + m
Λ

·

(cid:18)

(cid:19)

48

In an analogous way

Moreover,

; φ0))

Λ(Φ(
·
Λ

⊂  
ε

⊂ {
Remarks:

Λ

U∆− exp(

i
CV ·
−

)U T (0)

⊂ {−CV + m

·

(1, ω) : m

Zd+1

.

}

∈

(9.18)

(cid:18)

(cid:19)

Λ

U∆0U T (0)

m

(1, ω) : m

(cid:18)

⊂ {

·

(cid:19)

Zd+1

.

}

∈

(9.19)

Combining (9.15), (9.17), (9.18), (9.19) gives

U∆+ exp(i

)U T (0)

CV ·
(1, ω) : (ε, m)

Λ

∪
0, 1,

(cid:18)

(cid:19)

∈ {

1
−

} ×

i
CV ·
−
Zd+1

.

}

(cid:18)
CV + m

·

U∆− exp(

)U T (0)

Λ

U∆0U T (0)

∪

(cid:19)

(cid:18)

(cid:19)!

✷

(1) Let the conditions of Theorem 9.1b hold and let the spin trajectory S at φ0 be in
(1, ω; d + 1). In this special situation (9.12) holds, i.e. (9.1) becomes the spectral
(1, ω; d + 1), i.e. in general (9.1) is

Q
expansion of S. However, in general S is not in
not the spectral expansion of S because only the tunes m
If the conditions of Theorem 9.1b hold then ˆS is parallel to an ISF and with (9.1) and
(9.2) one could, at least in principle, attempt to compute the ISF by doing numerical
spectral analysis on an arbitrary spin trajectory. Of course, by Theorem 6.4, the ISF
n is unique up to a sign and, by Theorem 6.3a, the torus is well–tuned.

(1, ω) appear in (9.1).

Q

·

(2) Consider a ﬁxed torus and assume that a uniform IFF exists so that, due to Theorem
6.3a, the torus is well–tuned. Then, due to Remark 8 in Section 5, the set of generalized
Floquet frequencies is the same at every φ0 and is identical with the set Ξ of spin tunes.
m
Therefore Theorem 9.1c implies, for arbitrary φ0, that for every λ in Λ(Φ(
·
·
(1, ω) : m
the fractional part of λ is a generalized Floquet frequency at φ0,
and in particular a spin tune. Thus as conjectured earlier, spin tunes can indeed be
obtained by spectral analysis.

; φ0))

Zd+1

\ {

∈

}

Theorem 9.1c addresses the spectrum, Λ(Φ(
·

; φ0)), for the conditions stated but gives
no information on its dependence on φ0. However, under certain conditions, the special
; φ0)) is independent of φ0
parameter dependence of A given in (5.4) guarantees that Λ(Φ(
·
as we show in the next theorem.

Consider a ﬁxed torus and denote Φ(θ + 2πN; φ0)ΦT (2πN; φ0) by Π(θ; φ0), where N is

an integer. We conclude from (5.1) and (5.4) that Π satisﬁes the initial value problem

∂Π(θ; φ0)
∂θ

= A(θ; 2πNω + φ0)Π(θ; φ0) ,

Π(0; φ0) = I.

(9.20)

Because Φ(θ; 2πNω + φ0) is the unique solution of this initial value problem (see also Section
2), we obtain

Φ(θ; 2πNω + φ0) = Φ(θ + 2πN; φ0)ΦT (2πN; φ0) ,

(9.21)

49

valid for arbitrary φ0 and arbitrary integer N. Thus the basic property of A in (5.4) leads
; φ) is known at a
to the basic property of Φ as manifested in (9.21). It follows that if Φ(
·
Zd. Then if in addition
ﬁxed φ0 then it is known for all φ = φ0 + 2πNω + 2πM with M
(1, ω) is nonresonant it follows by continuity that it is known for all φ on the torus.

∈

Theorem 9.2 Consider a ﬁxed torus J0 oﬀ orbital resonance and assume that a φ0 exists
; φ), λ) exists and is
such that Ξ(φ0)
∅
continuous in φ. Moreover, for all φ, Λ(Φ(
·

. Then for every real λ and all φ

; φ)) = Λ(Φ(
·

Rd, a(Φ(

∈
; φ0)).

=

·

Proof: Since Φ(

+ 2πN; φ0) is quasiperiodic, it is easy to see from Deﬁnition 4.1 that

·

a(Φ(

+ 2πN; φ0), λ) = exp(iλ2πN)a(Φ(

; φ0), λ)

(9.22)

·

·

and the basic identity (9.21) gives

a(Φ(

; φ0 + 2πNω), λ) = exp(iλ2πN)a(Φ(

; φ0), λ)ΦT (2πN; φ0) .

(9.23)

·

·

Therefore

Λ(Φ(
·

; φ0)) = Λ(Φ(
·

; φ0 + 2πNω + 2πM)) ,

for all N
the spectrum of the principal solution matrix on the set

∈

∈

Z, M

Zd, where we also used the fact that Φ(θ; φ0) is 2π–periodic in φ0. Thus

D′ :=

φ0 + 2πNω + 2πM : N

Z, M

∈

Zd

}

∈

{

is the same as the spectrum of the principal solution matrix at φ0. Because (1, ω) is non-
resonant, D′ is dense in Rd. Now ﬁx λ and let h(φ) := a(Φ(
D′ and assume
h(φ0)

= 0 so that λ

; φ0)). Then

; φ), λ) for φ

∈

·

h(φ0 + 2πNω)Φ(2πN; φ0)

h(φ0 + 2πNω)

√3

|

| ≤

h(φ0 + 2πNω + 2πM)

,

|

(9.26)

|
where we used (9.23) for the ﬁrst equality and where for the second inequality we used the
fact that

|

Λ(Φ(
·
=

∈
h(φ0)

|

|

0 <
|
= √3

XΦ(2πN; φ0)

√3

X

,

(9.27)

|

|

|

:=

| ≤

X11X ∗

|
which follows from the SO(3) nature of Φ. As always,
denotes the Euclidean norm, i.e.
11 + X12X ∗
X
33. If h is continuous and 2π–periodic and deﬁned
|
all over Rd then, since D′ is dense in Rd,
; φ))
h(φ)
> 0 then, by exchanging the roles of φ and φ0, we
for all φ. Conversely if, for a given φ,
|
; φ))
obtain
Λ(Φ(
·
for all φ and it remains to show that h is deﬁned and continuous on Rd. The 2π–periodicity
of h then follows immediately. We ﬁrst state the following lemma.

> 0 for all φ and thus Λ(Φ(
·

> 0 so that Λ(Φ(
·

; φ)) for all φ. Thus Λ(Φ(

; φ0)) = Λ(Φ(
·

12 + ... + X33X ∗

Λ(Φ(
·

|
; φ0))

|
h(φ)

h(φ0)

; φ0))

| · |

p

⊂

⊃

|

|

·

|

(9.24)

(9.25)

50

6
6
Lemma 9.3 For ﬁxed λ and nonresonant (1, ω), let

Φq,λ(φ) :=

Φ(θ; φ) exp(

iλθ)dθ

(9.28)

−

q

1
q

0

Z

converge uniformly for all φ in the set D′ of (9.25) as the positive integer q
converges uniformly on Rd. In particular a(Φ(
in φ.

. Then Φq,λ
; φ), λ) exists for all φ in Rd and is continuous

→ ∞

·

C9
Proof of Lemma 9.3: The space Y of bounded (w.r.t. Euclidean norm) functions g : Rd
is a complex normed space w.r.t. the norm supφ∈Rd
and obviously Φq,λ is a sequence
in Y . Because C9 is complete, so is Y (see for example [46, Section 7.1]). Thus to show that
Φq,λ converges uniformly on Rd it suﬃces to show that it is a Cauchy sequence in Y , i.e. for
all positive δ there is a positive integer m such that for all integers with j, k

m we have

g(φ)

→

|

|

≥

sup
φ∈Rd |

Φj,λ(φ)

Φk,λ(φ)

< δ .

−

We also observe that

sup
φ∈Rd |

Φj,λ(φ)

Φk,λ(φ)

−

= sup

φ∈D′ |

|

Φj,λ(φ)

Φk,λ(φ)

,

−

|

which follows from the continuity of
Equation (9.30) implies that (9.29) is equivalent to the statement

Φk,λ(φ)

Φj,λ(φ)

−

|

|

in φ and from D′ being dense in Rd.

sup
φ∈D′ |

Φj,λ(φ)

Φk,λ(φ)

< δ .

−

Clearly (9.31) holds because, by assumption, Φq,λ(φ) converges uniformly on D′. Thus Φq,λ
; φ), λ) exists for all φ in Rd and is continuous in φ.
converges uniformly on Rd, so that a(Φ(
✷

·

To complete the proof of Theorem 9.2 we now show that the conditions of Lemma 9.3

are fulﬁlled, i.e. that Φq,λ converges uniformly on D′, for every λ. Clearly we have

|

|

a(Φ(

; φ0 + 2πNω), λ) = lim
q→∞

·

Φq,λ(φ0 + 2πNω)

= exp(iλ2πN)a(Φ(

; φ0), λ)ΦT (2πN; φ0)

·

and to show that the limit in (9.32) is uniform on D′ we estimate

exp(iλ2πN)a(Φ(

; φ0), λ)ΦT (2πN; φ0)

exp(iλ2πN)a(Φ(

; φ0), λ)ΦT (2πN; φ0)

|

|

·

−

·

−

Φ(θ; φ0)ΦT (2πN; φ0) exp(

iλ(θ

2πN))dθ

Φq,λ(φ0 + 2πNω + 2πM)
|
=

−

Φq,λ(φ0 + 2πNω)
1
q

2πN +q

|

|

−

Z
−
√3
|

2πN
exp(iλ2πN)a(Φ(
1
q

2πN +q

·
Φ(θ; φ0) exp(

2πN

=

≤

Z

; φ0), λ)ΦT (2πN; φ0)

iλθ)dθ

|
a(Φ(

·

−

; φ0), λ)

.

|

−

51

(9.29)

(9.30)

(9.31)

(9.32)

(9.33)

By using the ﬁrst equality of (9.32) with N = 0 and by noting that Φ(
·
have, for all N,

; φ0) is bounded we

2πN +q

lim
q→∞ |

1
q

2πN

Z
; φ0) exp(

Φ(θ; φ0) exp(

iλθ)dθ

a(Φ(

; φ0), λ)

= 0 .

−

−

·

|

(9.34)

Moreover because Φ(
) is almost periodic it follows (see [44, Chapter 3]) that
·
the convergence in (9.34) is uniform on the domain Z of N. Hence (9.33) implies that Φq,λ
✷
converges uniformly on D′.

iλ

−

·

Thus we have proved, under the conditions of Theorem 9.2, that Λ(Φ(
·

; φ0)) is indepen-

dent of φ0.
Remark:

(3) Remark 2 shows that under the conditions of Theorem 9.1 the spin tune can indeed
be discovered from a spectral analysis of the spin ﬂow for arbitrary φ0. In particular,
since the spin motion is quasiperiodic and the torus is well tuned, the spectrum has
; φ0)) will consist of sharp “lines” which
at most countably many elements and Λ(Φ(
·
can then be “measured”. Moreover, oﬀ orbital resonance and under the conditions
; φ0)) are equal. However, if the torus is ill–tuned but the
of Theorem 9.2, all Λ(Φ(
·
; φ0)) will consist of sharp
spin motion is quasiperiodic (so that the spectrum Λ(Φ(
·
; φ0)) over the torus will contain
lines), we expect that the union of the spectra Λ(Φ(
·
uncountably many elements. The models in Remarks 13 and 14 in Section 6 provide
examples. Note that in the absence of quasiperiodicity or even almost–periodicity, as
for example in the Moser-Siegel model of Section 8, there may be diﬃculties in even
computing the spectrum. In practice, the spectrum can be obtained by tracking three
mutually orthogonal spins along an orbit and storing their values at each of a very
large number of turns before applying a discrete Fourier transform to the data (a well-
known way of doing numerical Fourier analysis can also be found in [53]). But since
this spectrum can be very dense, it can be diﬃcult to identify the spin tunes. Thus it
would be useful to begin with small amplitudes, i.e. tori with small J, and look for a
ωs close to that for the closed orbit, which can be calculated as in Section 3. The spin
tune at higher amplitudes could then be identiﬁed by continuing away from the closed
orbit. We return to this theme in Section 10. Finally, tracking a spin trajectory which
is parallel to an ISF would give a spectrum without ωs.

(4) Of course, there might be cases where the dependence of Λ(Φ(

; φ0)) on φ0 leading to
the ill–tuning mentioned in Remark 3, is very weak so that the sharp lines are just
broadened. Intuition suggests that in such cases, spin–orbit resonance–like phenemena
might still be expected. But, of course, the deﬁnitive conditions under which such
phenomena could occur, will only become clear by careful analysis.

·

10 Discussion and Conclusion

In the foregoing sections we have presented a thorough step by step account of the circum-
stances under which spin motion may be quasiperiodic on integrable particle orbits and have

52

thereby put previous studies of the concept of spin tune onto a rigorous basis. In particular,
(1, ω1, ..., ωd; d + 1) and by introducing certain conditions
we considered integrable orbits in
(e.g. Diophantine conditions) and assuming the existence of an ISF we obtained conditions
(1, ω1, ..., ωd, ωs; d + 2) where ωs is a spin tune. We
under which the spin motion is in
have also shown how, by introducing UPFs, the spin motion can be represented in terms of
generalized Floquet forms.

Q

Q

The scenarios covered by our treatment and the relationships between them are summa-

rized by the Venn diagram of Figure 1.

4

5

3

2

1

6

7

Figure 1: The logical connections between the various scenarios.

The meanings of the domains in Figure 1 are as follows:

Inside the black circle: all tori, i.e. for arbitrary real skew–symmetric 3

3 matrices
, J0) and arbitrary orbital tunes ω(J0), which are smooth and 2π–periodic in θ

×

,
(
A
·
and φ.

·

Inside the red ellipse: tori which have an ISF

Inside the blue ellipse: tori, which at every φ0 have a proper UPF (note that for those
tori every spin trajectory is quasiperiodic)

Inside the green ellipse: tori which are well–tuned (see Section 5)

Inside the yellow ellipse: tori which are oﬀ orbital resonance

Inside the pink ellipse: tori with a uniform IFF

53

•

•

•

•

•

•

The numbered circles label speciﬁc examples, namely:

•

•

•

•

•

•

Example 1: the single resonance model oﬀ orbital resonance (see Section 7)

Example 2: the torus J deﬁned in Remark 13 in Section 6, for the case of irrational
ω(J)

Example 3: the single resonance model on orbital resonance (see Section 7)

Example 4: the torus deﬁned in Remark 13 in Section 6, for the case ω = 1

Example 5: a torus deﬁned in Remark 14 in Section 6

Example 6: the Moser-Siegel model (for certain choices of the parameters ω, σ1, σ2) -
see Section 8

Example 7: see below

•
Analytical solutions for spin motion or the ISF for the

s arising in real storage rings
cannot be obtained and it is not even known whether an ISF exists in general. Nevertheless
it seems that it usually exists for storage rings of interest. This is supported by a large
amount of numerical work in which, for the cases studied, it was possible to construct at
least a very good approximation to an ISF [6, 8, 9, 11, 12, 13, 23, 25]. Note that in these
simulations hard edge and some thin lens representations of ﬁelds were used so that the
s
were not smooth. See Remark 16 in Section 6.

A

A

Those studies also included calculations of the spin tune using SPRINT, either beginning
with the pseudo–u1, u2–axes or using the SODOM2 algorithm whereby the spin tune is ob-
tained by solving an eigenproblem for Fourier coeﬃcients in an SU(2) formalism. Numerical
simulations with both methods suggest that a spin tune normally exists if the torus is oﬀ
orbital resonance. This is the situation considered by Theorem 6.5d which implies that if we
and if a 2π–periodic unit vector exists which is nowhere parallel to
, then we
have a ISF
almost always have a spin tune (see Remark 5 in Section 6). For this and the other results
in this paper it has been convenient to prescribe that the
s are smooth. But the demon-
stration of ISFs and spin tunes in [6, 8, 9, 11, 12, 13, 23, 25] indicates that the smoothness
condition can often be relaxed. For convenience, in the remainder of this section we will use
the term ISF in this spirit. We hope in the future to be able to present a treatment of the
ISF and the spin tune in which the requirement of smoothness is relaxed.

A

S

S

An example of a situation where an ISF might not exist even in crude approximation,
namely near 803.5 GeV in the HERA ring, is given in [13]. If the spin motion is nonquasiperi-
odic, this case would correspond to example 7 in Figure 1.

The spin tune is a crucial quantity for characterizing the stability of spin motion. Spins
behave somewhat like driven oscillators where the driver is the magnetic and electric ﬁelds
along particle orbits. Near spin–orbit resonance, there is potential for marked qualitative
changes in the spin motion which may then be quite erratic. The special nature of spin–orbit
resonance is already clear from the fact that the ISF need not be unique at resonance. See
Theorem 6.4. Moreover, it is clear that it would make little sense to deﬁne a spin–orbit
resonance condition in terms of a UPR νs depending on φ0: such a νs would in general

54

take diﬀerent values for diﬀerent particles on a torus so that it would be impossible for the
particles on a torus to be simultaneously on resonance and there would be no enhancement
of our ability to systematize spin motion. This was the reason for insisting that a torus be
well–tuned before considering spin–orbit resonance.

As mentioned in the Introduction and in Remark 5 of Section 5, it is clear that ωs
can vary with the beam energy and with J. This is conﬁrmed by simulations in SPRINT
[6, 8, 9, 11, 12, 13, 23, 25], hence the name “amplitude dependent spin tune”. To study the
dependence of ΞJ on J (recall Remark 5 of Section 5), it is necessary to choose a “preferred”
member of ΞJ . For the calculations with SPRINT the choice is made as follows.

The spin tune ν0 ∈

[0, 1) and the corresponding UPF are found on the closed orbit using
the method outlined in Section 3. Normally ν0 is set signiﬁcantly diﬀerent from zero in
order to ensure that the direction of n0 is close to the “design” direction in spite of the
presence of the usual misalignments of the ring [7, 15, 39]. Then as in Remark 3 in Section
9, the preferred spin tune at nonzero amplitudes is selected by requiring that it and the
corresponding UPF vary continuously with amplitude and reduce continuously to the spin
tune and UPF on the closed orbit.

With this procedure in place, simulations in which the ISF and the spin tune are cal-
culated over a range of ﬁxed amplitudes or energies indeed show that the spin motion can
become erratic near a spin–orbit resonance. Moreover, in such cases there is a tendency for
the ISF to become very sensitive to the parameter being varied. With this prescription, one
also ﬁnds that the strongest variations of the ISF occur near low order resonances and that
high order resonance eﬀects are usually unimportant. For the details of these calculations
and results, the reader is referred to [6, 8, 9, 11, 12, 13, 23, 25]. These ﬁndings are consis-
tent with perturbation theoretical calculations of the ISF as in [10] 2. The nonperturbative
calculations also show that near spin–orbit resonance the spin tune tends to avoid exact ful-
ﬁllment of the resonance condition. As we have already indicated in Remark 3 of Section 7,
the spin tune for the single resonance model (see (7.11)) also avoids the spin–orbit resonance
condition as σ1 is varied through the condition σ1 = ω.

In a ring without so–called Siberian Snakes (see below) the closed orbit spin tune ν0
usually varies with the beam energy [7, 14]. It is then sometimes implied in the literature
that in a beam with a large energy spread, the synchrotron motion causes the particles to
oscillate to and fro across spin–orbit resonances as the spin tune ωs oscillates. This crossing
of resonances is then supposed to be the source of the low beam polarization that would
be seen. However, we have seen that a spin tune ωs on a torus (J1, J2, J3) is a constant.
As usual we assign J3 to synchrotron motion. Thus ωs does not oscillate and there is no
resonance crossing. Nevertheless, we do expect that a large energy spread can lead to small
beam polarization. This is explained by the fact that for particles of large enough J3, n
varies strongly with the φ3. Then the maximum permissible equilibrium beam polarization
can indeed be small [7].

Studies of the eﬀect on polarization of real resonance crossing can be found in [11, 12,
13, 23]. The consequences for the polarization of crossing ﬁrst order resonances are usually
quantiﬁed using the Froissart–Stora formula [54]. But in [11, 12, 13, 23] it is shown that the

2Note that in [10] the perturbation expansions calculate n

n0. Then the ωs for the closed orbit appears

in the resonance factors, not the ωs for nonzero orbital amplitudes.

−

55

Froissart–Stora approach can be generalized to describe the change of the polarization at the
crossing of higher order resonances too. This is a further illustration of the value of using a
wisely deﬁned spin tune for identifying resonances and for understanding their properties

The spin tune can be obtained in SPRINT via the pseudo–u1, u2–axes or by using the
SODOM2 algorithm. However, as we have seen in Section 9 the spin tune might also be
obtained (“measured”) by a spectral analysis of the spin motion. This oﬀers an attractive
alternative. As in the case of the other two methods the preferred spin tune would have to be
identiﬁed among the many spectral lines by matching onto the spin tune of the closed orbit.
We have also seen in Section 9 that the ISF might be obtainable, if it exists, by spectral
analysis of spin motion. Spectral analysis may thus lead to a criterion for deciding whether
an invariant spin ﬁeld exists. Other criteria for the existence of the ISF are already available
for stroboscopic averaging and the SODOM2 algorithm.

We now complete this discussion by mentioning other quantities that have been used in

attempts to deﬁne a spin precession frequencies.

±

As explained in Remark 3 in Section 3, for motion on the closed orbit the spin tune can be
obtained trivially from the complex eigenvalues of the 1–turn principal solution matrix. This
2πνs(U)) U T (0)
does not normally work oﬀ the closed orbit since Φ(2π; φ0) = U(2π) exp (
2πiνs(U)) are generally not the complex eigenvalues. So the reader
and for this the exp(
will agree that on synchro–betatron orbits the spin tune usually cannot be obtained from
the complex eigenvalues of the 1–turn principal solution matrix. In fact in general the real
eigenvector of the general 1–turn principal solution matrix Φ(θ + 2π; φ0)ΦT (θ; φ0) starting
at θ is not even a spin trajectory and is not parallel to an ISF [55, p.27, for example]: the
term “spin closed orbit” which is sometimes used for the ISF, is inappropriate. Moreover
in the simulations with SPRINT the sensitivity of the ISF to variation of parameters shows
no correlation with the spin precession rate extracted from the complex eigenvalues of the
1–turn principal solution matrix. Of course eigenvalues of 1–turn principal solution matrices
are easy to calculate but for J

= 0 they usually have no useful function.

J

The model described in [32, equation 21] provides an example. It concerns orbits which
are said in [31] to be exceptional. It is stated there that exceptional orbits are characterized
by the feature that the spin tune depends on orbital phase and this is discussed in close
conjunction with Stern–Gerlach forces. As we point out in the Introduction, S–G forces can
have no practical relevance for understanding spin resonance. The model in [32] involves
the single resonance model (see Section 7) and a single thin lens Siberian Snake. A Siberian
Snake [56, 57] of the kind used here is a magnet system that rotates a spin by the angle π
around an axis in the plane of the ring [55, p.71]. In the notation of Section 7 the parameters
in [32] are σ1 = ω and σ2√2J = 3/2. At all φ0 the 1–turn principal solution matrix Φ(2π; φ0)
starting at the snake represents a rotation around the vertical by an angle depending linearly
on φ0. Then the ISF is vertical at the snake at all φ0 on this torus and for this zero–measure
range of J, the ISF at the snake is the same as the real unit–length eigenvector of the 1–
turn principal solution matrix. 3 The orbital tune ω is arbitrary. The eigentunes extracted
from the complex eigenvalues of Φ(2π; φ0), vary linearly with φ0. Therefore if a particle is
followed along an orbit, these eigentunes normally change abruptly between one turn and
the next. Other 1–turn eigentunes would be obtained if other positions around the ring were

3Note that in this discussion we allow the ISF to be discontinuous in θ.

56

6
×

chosen for θ = 0. Nevertheless, it is claimed in [31, 32] that the eigentune for Φ(2π; φ0) is
2π
spin tune. Obviously this is not a spin tune in the sense of our treatment. We have
taken account of the fact that an eigentune in the SU(2) formalism used in [31, 32] is one half
of a corresponding eigentune in our formalism. Although this Φ(2π; φ0) and its eigentune
are discussed in association with S–G forces, the inclusion of S–G forces is not necessary to
obtain either. In fact by exploiting techniques additional to those used in this paper one can
show that these parameters simply provide an example of ill–tuning and that this case would
be entered next to example 6 in the diagram of Figure 1. The inclusion of S–G eﬀfects clouds
the issue. It is not clear from [31, 32] whether these phase dependent eigentunes serve some
useful function such as indicating the stability of spin motion. We give another example of
the use of the eigentune of a 1–turn principal solution matrix below.

The situation with regard to the utility of eigenvectors and eigentunes is more subtle for
tori on orbital resonance where ω1, ω2, ... are rational. The orbit and A are then periodic over
an appropriate number, M, of whole turns. Thus in analogy with the method in Remark 6 in
Section 3, there is a possibility of calculating n at θ = 0 as the unit–length real eigenvector
of the M–turn principal solution matrix and in general it would be a function of φ0. The
imaginary part of the exponent of a complex eigenvalue of this principal solution matrix
would provide the M–turn advance of the phase of spin rotation around n and this could
be used to obtain the average 1–turn spin phase advance. This would usually depend on φ0
and in such cases it could not be used to deﬁne a spin tune. But it could be used to deﬁne
a νV (see (6.26)).

So, as is usual at orbital resonance, an ISF can exist in general but normally there is
no spin tune. We note in passing that the M–turn complex eigentunes are 2π–periodic in θ
and φ, just like
. Moreover, because eigenvalues of matrices are invariant under similarity
transformations, the eigentunes are invariant when the starting point for the eigenanalysis is
shifted along the orbit. Examples of an unwise use of the term spin tune can be found in [58]
where the dependence of the multi–turn eigentune on φ0 is made explicit. See [31, 32] too.
Again, a “tune” depending on φ0 cannot be used for studying spin–orbit resonance. Calling
such a quantity a spin tune can create confusion. See Remark 4 in Section 9 also.

A

If, on orbital resonance with rational tunes, the torus is ill–tuned, then one can expect
that either there are more or fewer proper UPRs than one would have on a well–tuned torus.
Thus a spectral analysis along the lines of that in Section 9, applied to every φ0 on the torus,
could be a useful diagnostic tool to signal these two cases of ill–tuning. Note that in the
examples in Remarks 13 and 14 in Section 6 there are too many UPRs. Therefore one might
expect that on orbital resonance with rational tunes an ill–tuned torus had too many proper
UPRs.

Although an M–turn eigentune is in general φ0 dependent, we might expect that an
approximation to the spin tune ωs on a well–tuned torus oﬀ orbital resonance could be
obtained by setting the orbital tunes to rational values near to the actual tunes but such
that M were very large. Indeed this is the essence of a popular perception. In eﬀect, although
usually not clearly stated, the underlying hope is that for the smooth guide ﬁelds of real
rings and for large enough M, the average 1–turn spin phase advance is only very weakly
dependent on φ0 and that therefore a good approximation to ωs can be obtained. That
would be consistent with the heuristic expectation that for large enough M the inﬂuence
of the initial φ0 become diluted. Such behavior might also be expected if the high order

57

−

ωθ) in (6.21) are very small owing to the smoothness of
Fourier coeﬃcients in the ˜cV(θ, φ
the ﬁelds. See [24, p.66] for a hint of how the Fourier coeﬃcients come in here. We hope in
the future to be able to present a rigorous treatment of this approximation. This approach
has been adopted in [58] to indicate that oﬀ orbital resonance the spin tune is a half integer
at most J in the model to be discussed in the next paragraph. However, any attempt to
ﬁnd an approximate value for a spin tune by using M–turn maps for nearby rational tunes
should at least be checked for convergence and consistency. See Remark 4 in Section 9 too.
Further discussion around the topic of rational tunes can be found in [51] in which the
nature of the so–called “snake resonances” is studied. These refer to a large loss of beam
polarization during acceleration in a model in which the spin motion in most of the ring
is approximated by the single resonance model and the spin motion is stabilized by pairs
of idealized, i.e. thin lens, Siberian Snakes [59]. The Siberian Snakes have the eﬀect of
ﬁxing ν0 at 1/2 independently of the beam energy [55, p.70]. Snake “resonances” occur at
rational orbital tunes ω for which, in the notation of (5.10), 1/2 = m0 + m1 ω with odd
m1. In [51] it is made evident that at these tunes and for most J
= 0 there is no amplitude
dependent spin tune so that one is not dealing with spin–orbit resonances. Moreover at most
orbital amplitudes the ISF deﬁned there (i.e. without insistence on smoothness) is irreducibly
discontinuous at some orbital phases [51]. Of course, since rational tunes correspond to
orbital resonance, it should come as no surprise, given the content of our paper, that there is
no amplitude dependent spin tune in this case. We have explicitly chosen our nomenclature
to be consistent with earlier usage [18] and thereby contribute clarity to the classiﬁcation
of phenomena. It could be that the pathological behavior in this model, namely the large
loss of polarization, is due to the use of the simpliﬁed but singular representation for the
snake ﬁelds.
In this connection we note with interest that according to simulations for
RHIC, the loss of polarization during acceleration is less severe when the simulations are
carried out with the magnetic ﬁelds of real snakes than with the singular ﬁelds of thin lens
snakes [60]. This indicates that predictions from simpliﬁed, mathematically singular models
should be treated with some caution. For recent experimental work around vertical orbital
tunes corresponding to “snake resonance”, see [61]. In any case the use of the term “snake
resonance” is a good illustration of the confusion that arises from an imprecise use of the
concept of spin–orbit resonance.

A model involving the single resonance model and two thin snakes provides the second
example of the use of the eigentune from the 1–turn principal solution matrix. Simulations
described in [59, p.98–100] show some loss of polarization for all nonzero 2σ2
2J during accel-
eration, even away from the rational orbital tunes associated with snake “resonances”. It is
implied there that this loss stems from the fact that during the acceleration, the eigentune
from the 1–turn principal solution matrix, which in [59] is called the “perturbed spin tune”,
oscillates to and fro across a spin–orbit resonance as the orbital phase advances from turn to
turn. But in this example the 1–turn eigenvector of the principal solution matrix is usually
not even parallel to the ISF. So it is even more diﬃcult to imagine that the “perturbed spin
tune” can characterize long term spin motion. Thus an alternative picture for the loss of
polarization must be sought.

As mentioned in Remarks 1 and 4 in Section 7, for the straightforward single resonance

model a spin tune does exist on orbital resonance.

This completes our discussion of notions of spin precession frequency.

58

6
We now conclude by summarizing the main message. This is, that, by just employing the
Lorentz force and the T-BMT equation and with the help of the concept of quasiperiodicity,
we are able to provide a rigorous and broad treatment of the concepts of proper uniform
precession rate, spin tune and the invariant spin ﬁeld by common methods used for ordinary
diﬀerential equations. This allows us to focus on the main phenomena without the distraction
of perturbations such as noise, collective eﬀects and synchrotron radiation.
In principle
they can be included by using perturbation theory. We have discussed putative Stern–
Gerlach forces in the Introduction. The advantages of a clear, universally accepted and useful
deﬁnition of spin tune has been made evident by the examples in the foregoing paragraphs.

Acknowledgements

We thank Georg Hoﬀstaetter, Helmut Mais, Mathias Vogt, Kaoru Yokoya and the late
Gerhard Ripken for important and fruitful discussions on this and related topics. In addition,
JAE gratefully acknowledges the support from DOE grant DE-FG03-99ER41104 and from
DESY during a sabbatical in 1997–1998 when the core elements of this work were ﬁrst
assembled into a manuscript.

References

[1] J.D. Jackson, “Classical Electrodynamics”, 3rd edition, Wiley (1998).

[2] D.P. Barber, K. Heinemann and G. Ripken, Z. f. Physik C64, 117 (1994).

[3] J.A.Ellison and K. Heinemann, “Periodic Spin Fields and Phase Space Densities: Stro-
boscopic Averaging and the Ergodic Theorem”, submitted for publication (2004).

[4] K. Gottfried, “Quantum Mechanics: Fundamentals”, Addison Wesley (1989).

[5] K. Heinemann and D.P. Barber, Nucl. Instr. Meth. A463, 62 and A469, 294 (2001).

[6] K. Heinemann and G.H. Hoﬀstaetter, Phys. Rev. E 54 (4), 4240 (1996).

[7] D.P. Barber et al., ﬁve articles in proceedings of ICFA workshop “Quantum Aspects
of Beam Physics”, Monterey, U.S.A., 1998, edited by P. Chen, World Scientiﬁc (1999).
Also in extended form as DESY Technical Report 98-096 (1998) and e–print archive:
physics/9901038, 9901041, 9901042, 9901043, 9901044.

[8] D.P. Barber, G.H. Hoﬀstaetter and M. Vogt, Proc. 1998 European Part. Acc.
(EPAC98), Stockholm, Sweden, June 1998. Available electronically at:

Conf.
http://epac.web.cern.ch/EPAC/Welcome.html.

[9] D.P. Barber, G.H. Hoﬀstaetter and M. Vogt, Proc. 13th Int. Symp. High Energy Spin

Physics, Protvino, Russia, September 1998, World Scientiﬁc (1999).

[10] S.R. Mane, Phys. Rev. A36, 105 (1987).

59

[11] G.H. Hoﬀstaetter and M. Vogt, Phys. Rev. E 70, 056501 (2004).

[12] G.H. Hoﬀstaetter, “A modern view of high energy polarized proton beams”. To be

published as a Springer Tract in Modern Physics.

[13] M. Vogt, Ph.D. Thesis, University of Hamburg, DESY Technical Report DESY–

THESIS–2000–054 (2000).

[14] A.W. Chao, Nucl. Instr. Meth. 180, 29 (1981). Modern notation: replace n by n0.

[15] D. P. Barber and G. Ripken, “Radiative Polarization, Computer Algorithms and Spin
Matching in Electron Storage Rings”, in the Handbook of Accelerator Physics and
Engineering, Edited by A.W. Chao and M. Tigner, World Scientiﬁc, 2nd edition (2002).

[16] V.V. Balandin and N.I. Golubeva, DESY Technical Report 98-16 (1998).

[17] Yu. Eidelman and V. Yakimenko, Particle Accelerators 50, 261 (1995).

[18] K. Yokoya, DESY Technical Report 99-006 (1999) and e–print archive: physics/9902068.

[19] S.R. Mane, Nucl. Instr. Meth. A498, 1 (2003).

[20] Ya.S. Derbenev and A.M. Kondratenko, Sov. Phys. JETP 35, 230 (1972).

[21] Ya.S. Derbenev and A.M. Kondratenko, Sov. Phys. JETP 37, 968 (1973).

[22] K. Yokoya, DESY Technical Report 86-57 (1986).

[23] D.P. Barber, G.H. Hoﬀstaetter and M. Vogt, Proc. 14th Int. Spin Physics Symposium,

Osaka, Japan, October 2000, AIP proceedings 570, (2001).

[24] D.P. Barber, K. Heinemann and G. Ripken, DESY Technical Report M-92-04 (1992),

second revised version, September 1999.

[25] G.H. Hoﬀstaetter, M. Vogt and D.P. Barber, Phys. Rev. ST Accel. Beams 2, 114001

(1999).

York (1989).

physics/9611001.

[26] Y.G. Sinai (Ed.), Encycl. of math.sciences V. Dynamical Systems II, Springer, New

[27] I.P. Cornfeld, S.V. Fomin and Y.G. Sinai, “Ergodic Theory”, Springer, New York (1982).

[28] K. Heinemann, DESY Technical Report 96-229 (1996) and e–print archive:

[29] A.A. Pomeransky, R.A. Senkov and I.B. Khriplovich, Phys. Usp. 43 (10), 1055 (2000).

See also
I.B. Khriplovich and A.A. Pomeransky, Surveys High Energy Phys. 14, 145 (1999) and
e–print archive gr-qc/9809069.

60

[30] Ya.S. Derbenev, University of Michigan–Ann Arbor, Technical Report UM–HE–90–30

(1990).

[31] S.R. Mane, Nucl. Instr. Meth. A498, 52 (2003).

[32] S.R. Mane, Proc. 15th Int. Spin Physics Symposium, Brookhaven National Laboratory,

Long Island, U.S.A., September 2002. AIP proceedings 675 (2003).

[33] D.P. Barber, J.A. Ellison and K. Heinemann, Proc. 14th Int. Spin Physics Symposium,

Osaka, Japan, October 2000, AIP proceedings 570, (2001).

[34] H. Amann, “Ordinary Diﬀerential Equations: Introduction to Nonlinear Analysis”, de

Gruyter, (1990).

(1980).

by n0.

New York (1988).

(1988).

377, Springer (1974).

[35] J. K. Hale, “Ordinary Diﬀerential Equations”, 2nd ed., Krieger, Malabar, Florida

[36] Y. Aharonov and J. Anandan, Phys. Rev. Letts. 58 (16), 1593 (1987).

[37] J. N. Franklin, “Matrix Theory”, Prentice Hall, New Jersey (1968).

[38] H. Goldstein, “Classical Mechanics”, Addison Wesley, 2nd ed.,New York (1982).

[39] D.P. Barber et al., DESY Technical Report 85-44 (1985). Modern notation: replace n

[40] P. Lochak and C. Meunier, “Multiphase Averaging for Classical Systems”, Springer,

[41] T.W. Koerner, “Fourier Analysis”, Cambridge University Press, Cambridge (1988).

[42] W. Maak, “Fastperiodische Funktionen”, 2nd ed., Springer, Berlin (1967).

[43] V.I. Arnold, “Mathematische Methoden der klassischen Mechanik”, Birkhaeuser, Basel

[44] A. M. Fink, “Almost Periodic Diﬀerential Equations”, Lecture Notes in Math., Vol.

[45] H. S. Dumas, J. A. Ellison and M. Vogt, SIAM J. App. Dynam. Syst. 3, 409 (2004).

[46] J. Dieudonne, “Foundations of Modern Analysis”, Academic Press, New York (1960).

[47] S. Lang, “Real Analysis”, Addison Wesley, Reading (1973).

[48] T. Yoshizawa, “Stability Theory and the Existence of Periodic Solutions and Almost

Periodic Solutions”, Springer, New York (1975).

[49] S.R. Mane, Nucl. Instr. Meth. A321, 21 (1992).

[50] I.S. Gradstein and I.M. Ryshik, “Tables of Integrals, Series, and Products”, Academic

Press, New York (1965).

61

[51] D.P. Barber et al., Proc. 15th Int. Spin Physics Symposium, Brookhaven National

Laboratory, Long Island, U.S.A., September 2002. AIP proceedings 675 (2003).

[52] C. L. Siegel and J. K. Moser, “Lectures on Celestial Mechanics”, Springer, New York

(1971).

[53] J. Laskar, Physica D67, 257 (1993).

[54] M. Froissart and R. Stora, Nucl. Instr. Meth. 7, 297 (1960).

[55] B. Montague, Physics Reports 113, 1 (1984).

[56] Ya. S. Derbenev and A. Kondratenko, Soviet Physics Doklady 20, 562 (1976).

[57] Ya. S. Derbenev et al. Particle Accelerators 8, 115 (1978).

[58] S.R. Mane, Nucl. Instr. Meth. A480, 328 (2002).

[59] S.Y. Lee, “Spin Dynamics and Snakes in Synchrotrons”, World Scientiﬁc (1997).

[60] M.Xiao and T. Katayama, University of Tokyo Technical Report CNS-REP-51 (2003).

[61] M. Bei et al., Proc. 16th Int. Spin Physics Symposium, Trieste, Italy, October (2004).

To be published by World Scientiﬁc.

62

