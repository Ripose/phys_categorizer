5
0
0
2
 
b
e
F
 
3
2
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
1
2
1
2
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Spin tune in the single resonance model with a
pair of Siberian Snakes

D. P. Barber∗, R. Jaganathan† and M. Vogt∗

∗Deutsches Elektronen–Synchrotron, DESY, 22603 Hamburg, Germany.
†The Institute of Mathematical Sciences, Chennai. Tamilnadu 600113, India.

Abstract. Snake “resonances” are classiﬁed in terms of the invariant spin ﬁeld and the amplitude
dependent spin tune. Exactly at snake “resonance” there is no continuous invariant spin ﬁeld at most
orbital amplitudes.

PROLOGUE

This is an extended version of the paper with the same title published in the proceedings
of the conference SPIN2002 [1]. A key aspect of the original paper was that the invariant
spin ﬁeld for snake “resonances” is irreducibly discontinuous at most orbital amplitudes.
However, details were omitted owing to the page limit. In the meantime other papers
[2, 3] have appeared which discuss the invariant spin ﬁeld at snake “resonances” and it
has become clear that it would be useful to extend [1] to give more details.

We begin by presenting a slightly polished version of the original paper. Then the

additional material is presented as an addendum. The citations are also updated.

INTRODUCTION

Spin motion in storage rings and circular accelerators is most elegantly systematised in
terms of the invariant spin ﬁeld (ISF) and the amplitude dependent spin tune (ADST).
Here we apply them in the context of snake ”resonances”. We begin by brieﬂy recapitu-
lating some necessary basic ideas. For more details see [4, 5, 6, 7].

×

Spin motion in electric and magnetic ﬁelds at the 6–dimensional phase space point~z
and position s around the ring, is described by the T–BMT precession equation d~S/ds =
~W (~z; s)
~S [8, 4] where ~S is the spin expectation value (“the spin”) in the rest frame of
the particle and ~W (~z; s) contains the electric and magnetic ﬁelds in the laboratory. The
ISF, denoted by ˆn(~z; s), is a 3–vector ﬁeld of unit length obeying the T–BMT equation
along particle orbits (~z(s); s) and fulﬁlling the periodicity condition ˆn(~z; s +C) = ˆn(~z; s)
where C is the circumference. Thus ˆn( ~M(~z; s); s + C) = ˆn( ~M(~z; s); s) = R3
3(~z; s) ˆn(~z; s)
where ~M(~z; s) is the new phase space vector after one turn starting at~z and s and R3
3(~z; s)
is the corresponding spin transfer matrix. The scalar product Js = ~S
ˆn is invariant along
an orbit, since both vectors obey the T–BMT equation. Thus with respect to the local ˆn

·

×

×

1

the motion of ~S is simply a precession around ˆn. The ﬁeld ˆn can be constructed at each
reference energy where it exists without reference to individual spins.

}

i|

|h

hi

∈{

1, 2

ˆn(~z; s)

on a phase space torus at each s, where

The chief aspects of the ISF are that: 1) For a turn–to–turn invariant particle distri-
bution in phase space, a distribution of spins initially aligned along the ISF remains
invariant (in equilibrium) from turn–to–turn, 2) for integrable orbital motion and away
from orbital resonances the ISF determines the maximum attainable time averaged po-
denotes the average
larisation Plim =
over the orbital phases, 3) under appropriate conditions Js is an adiabatic invariant while
system parameters such as the reference energy are slowly varied, 4) it provides the
main axis for orthonormal coordinate systems at each point in phase space which serve
to deﬁne the ADST which in turn is used to deﬁne the concept of spin–orbit resonance.
These coordinate systems are constructed by attaching two other unit vectors ˆu1(~z; s)
and ˆu2(~z; s) to all (~z, s) such that the sets ( ˆu1, ˆu2, ˆn) are orthonormal. Like ˆn, the ﬁelds ˆu1
and ˆu2 are 1–turn periodic in s: ˆui(~z; s +C) = ˆui(~z; s) for i
. With the basis vectors
ˆu1 and ˆu2 we can quantify the rate of the above mentioned spin precession around ˆn:
it is the rate of rotation of the projection of ~S onto the ˆu1, ˆu2 plane. Except on or close
to orbital resonance, the ﬁelds ˆu1(~z; s) and ˆu2(~z; s) can be chosen so that the rate of
precession is constant and independent of the orbital phases [9, 5, 6, 7]. The number of
precessions per turn “measured” in this way is called the spin tune. The spin tune, n s(~J),
depends only on the orbital amplitudes (actions) ~J, hence the name ADST. The choice
of some ˆu1(~z; s) and ˆu2(~z; s) satisfying the condition ˆui(~z; s + C) = ˆui(~z; s) for i
1, 2
}
is not unique. An inﬁnity of others can be chosen by suitable rotations of the ˆui around
ˆn. These lead to the equivalence class of spin tunes obtained by the transformation:
n s(~J)
n s(~J) + l0 + l1Q1 + l2Q2 + l3Q3 for any integers l where the Q(~J)’s are the
tunes on a torus of integrable orbital motion 1. The ADST provides a way to quantify
the degree of coherence between the spin and orbital motion and thereby predict how
strongly the electric and magnetic ﬁelds along particle orbits disturb spins. In particular,
the spin motion can become very erratic close to the spin–orbit resonance condition
n s(~J) = m0 + m1Q1 + m2Q2 + m3Q3 where the m’s are integers. At these resonances
the ISF can spread out so that Plim is very small. Examples of the behaviour of Plim near
spin–orbit resonance and the application of a generalised Froissart–Stora description of
the breaking of the adiabatic invariance of Js while crossing resonances during variation
of system parameters can be found in [6, 7, 10, 11]. Note that: 1) the resonance condition
is not expressed in terms of the spin tune n (~0) on the closed orbit, 2) a “tune” describing
spin motion but depending on orbital phases could not be meaningful in the spin–orbit
resonance condition, 3) if the system is on spin–orbit resonance for one spin tune of
the equivalence class, it is on resonance for all others. In general ˆu1 and ˆu2 do not obey
the T–BMT equation along an orbit (~z(s); s). But at spin–orbit resonance, they can be
chosen so that a spin ~S is at rest in its local ( ˆu1, ˆu2, ˆn) system. Then ˆu1(~z; s) and ˆu2(~z; s)
do obey the T–BMT equation so that the ISF ˆn(~z; s) is not unique.

∈{

⇒

Nowadays we emphasise the utility of the ISF for deﬁning equilibrium spin distri-
butions. However, it was originally introduced for bringing the combined semiclassi-

1 For a recent detailed discussion of these concepts, see [3].

2

cal Hamiltonian of spin–orbit motion into action–angle form for calculating the effects
of synchrotron radiation [12]. The initial Hamiltonian is written as Hs
C (Q1J1 +
Q2J2 +Q3J3) +~W
~S. By viewing the spin motion in the ( ˆu1, ˆu2, ˆn) systems, a new Hamil-
·
n s(~J′)Js is ob-
tonian in full action–angle form Haa
s
−
tained which is valid at ﬁrst order in ¯h [9]. This emphasises again that, as with all action–
angle formulations, the spin frequency cannot depend on orbital phases. Moreover, it is
easy to show that at orbital resonance, ( i.e. k0 + k1Q1 + k2Q2 + k3Q3 = 0 for suitable
integers k) the “diagonalisation” of the Hamiltonian (i.e. ﬁnding the ˆu1, ˆu2) might not
be possible [9]. Thus at orbital resonance the ADST may not exist. On the other hand,
one avoids running a machine on such resonances. The spin tune on the closed orbit
n 0 = n s(~0) always exists and so does ˆn0(s) = ˆn(~0; s).

C (Q′1J′1 + Q′2J′2 + Q′3J′3) + 2p

o = 2p
−

o = 2p

C

For our present purposes there are two kinds of orbital resonances: resonances where
at least one of the Q’s is irrational and those where all are rational. We write the rational
tunes as Qi = ai/bi (i = 1, 2, 3) where the ai and bi are integers. Then for the second
type, the orbit is periodic over c turns where c is the lowest common multiple of the bi.
This opens the possibility that in this case the ISF at each (~z, s) can be obtained (up to a
sign) as the unit length real eigenvector of the c–turn spin map (c.f. the calculation of ˆn0
from the 1–turn spin map on the closed orbit.). However, the corresponding eigentune
2p icn c, depends in general on the
cn c extracted from the complex eigenvalues l c = e±
orbital phases at the starting ~z. Thus in general n c is not a spin tune and should not be
so named [13]. Nevertheless if c is very large the dependence of n c on the phases can be
very weak so that it can approximate well the ADST of nearby irrational tunes. This is
expected heuristically since the inﬂuence of the starting phase can be diluted on forming
the spin map for a large number of turns. At non–zero amplitudes, both for irrational or
rational Q’s, the eigentune of the 1–turn spin map usually has no physical signiﬁcance.
Of course, it normally depends on the orbital phases and the corresponding eigenvectors
are normally not even solutions of the T–BMT equation.

For non–resonant orbital tunes, the spin tune can be obtained using the SODOM–II
algorithm [14] whereby spin motion is written in terms of two component spinors and
SU(2) spin transfer matrices. The functional equation ˆn( ~M(~z; s); s) = R3
3(~z; s) ˆn(~z; s)
is then expressed in terms of a Fourier representation, w.r.t. the orbital phases, of the
spinors and of the 1–turn SU(2) matrices. The spin tune appears as the set of eigentunes
of an eigen problem for Fourier components and ˆn is reconstructed from the Fourier
eigenvectors. SODOM–II delivers the whole spin ﬁeld on the torus ~J at the chosen s.

×

THE SINGLE RESONANCE MODEL

In perfectly aligned ﬂat rings with no solenoids, ˆn0 is vertical and n 0 is in the equiv-
alence class containing ag 0 where g 0 is the Lorentz factor on the closed orbit and
a is the gyromagnetic anomaly of the particle. In the absence of skew quadrupoles,
the primary disturbance to spin is then from the radial magnetic ﬁelds along verti-
cal betatron trajectories. The disturbance can be very strong and the polarisation can
fall if the particles are accelerated through the condition ag 0 = k
Q2 where
mode 2 is vertical motion. This can be understood in terms of the “single resonance

k0

±

≡

3

·

≥

ˆe2

so that it is 90◦ at d = 0 for non–zero e . At large

model” (SRM) whereby a rotating wave approximation is made in which the contri-
bution to ~W
from the radial ﬁelds along the orbit is dominated by the Fourier har-
monic at k with strength e (J2). The SRM can be solved exactly and the ISF is given
by [15] ˆn(f 2) = sgn(d ) (d ˆe2 + e ( ˆe1 cos f 2 + ˆe3 sin f 2)) /√d 2 + e 2 where d = ag 0
k ,
f 2 is the orbital phase, ( ˆe1, ˆe2, ˆe3) are horizontal, vertical and longitudinal unit vec-
0 is used. The tilt of ˆn away from the vertical ˆn0 is
tors and the convention ˆn
arcsin(e /√d 2 + e 2)
, the equilib-
|
rium polarisation directions ˆn(J2, f 2; s), are almost parallel to ˆn0(s) but during acceler-
ation through d = 0, ˆn varies strongly and the polarisation will change if the adiabatic
invariance of Js violated. The change in Js for acceleration through d = 0 is given by
the Froissart–Stora formula. The ADST which reduces to ag 0 on the closed orbit is
n s = sgn(d )√d 2 + e 2 + k . Note that the condition d = 0 is not the spin–orbit resonance
condition. On the contrary, as d passes through zero n s jumps by 2e with our convention
for ˆn and avoids fulﬁlling the true resonance condition: for particles with non–zero e ,
ag 0 is just a parameter. In this simple model n s exists and is well deﬁned near spin–
orbit resonances for all Q2. This is also true in more general cases if orbital resonance is
avoided.

−

|

|

|

d

THE SINGLE RESONANCE MODEL WITH A PAIR OF SIBERIAN
SNAKES

Snake “resonances”

·

−

ˆe2 = +1 in one half ring and

Polarisation loss while accelerating through d = 0 can be reduced by installing pairs
of Siberian Snakes, magnet systems which rotate spins by p
independently of~z around
a “snake axis” in the machine plane. For example, one puts two snakes at diametrically
1 in the other. With
opposite points on the ring. Then ˆn0
the snake axes relatively at 90◦, n 0 is in the equivalence class containing 1/2 for all g 0.
For calculations one often represents the snakes as elements of zero length (“pointlike
snakes”). Then if, in addition, the effect of vertical betatron motion is described by the
SRM, and orbital resonances are avoided, calculations with SODOM–II, perturbation
theory [16] and the treatment in [13] suggest that n s(J2) is in the equivalence class
containing 1/2 too, independently of g 0 but also of J2. Thus for Q2 sufﬁciently away
from 1/2 no spin–orbit resonances n s(J2) = k0
Q2 are crossed during acceleration
through d = 0 and the polarisation can be preserved. This is conﬁrmed by tracking
calculations. However, such calculations and analytical work show that the polarisation
can still be lost if the fractional part of Q2, [Q2], is ˜a2/2˜b2 where here, and later, ˜a2 and
˜b2 are odd positive integers with ˜a2 < 2˜b2 and where here and later the brackets [...]
are used to signal the fractional part of a number. This is the so–called “snake resonance
phenomenon” and it also has practical consequences [17, 18, 19], especially for small ˜b2.
˜a2)/2 + ˜b2[Q2]. But calculations (see below)
Such a [Q2] ﬁts the condition 1/2 = (1
show that exactly at [Q2] = ˜a2/2˜b2 the ADST may not exist. If it doesn’t, it isn’t in
the equivalence class for 1/2. Then we are not dealing with a conventional resonance
˜a2)/2 + ˜b2[Q2] and the term resonance is inappropriate. Depolarisation
n s(J2) = (1

±

−

−

4

in this model has also been attributed to the fact that for non–zero J2 the eigentune of
the 1–turn spin map, which depends on f 2, is 1/2 at some values of f 2 [17]. However,
such a quantity does not describe spin–orbit coherence. Snake “resonances” are usually
associated with acceleration but it has been helpful in other circumstances [6, 7, 10] to
begin by studying the static properties of the system, namely with the ISF. We now do
that for the SRM with two snakes for representative, parameters.

Numerical study

±

−

±

≤

25 106 turns) at 500 equally spaced f 2 in the range 0

Figure 1 shows Plim (just before a snake) and n s for 25000 equally spaced [Q2]’s
between 0 and 0.5 for e = 0.4 and d = 0. At each [Q2], ˆn is calculated by stroboscopic
2p and Plim
averaging [4] (
is obtained by averaging over these f 2. The ADST is obtained from SODOM–II. If the
ADST exists SODOM–II delivers a part of the equivalence class, namely the spectrum
0.5 + l2Q2] for a range of contiguous even l2 restricted by the necessarily ﬁnite size
[
±
of the matrix of Fourier coefﬁcients. Only even l2 are allowed by the algorithm. For
0.5
irrational Q2 the range of l2 is large. For rational Q2 the spectrum can include
but is otherwise highly degenerate or contains none or just a very few of the required
members [
0.5 + l2Q2]. Thus the existence of an ADST is easily checked. The central
horizontal row of points in ﬁgure 1 shows the common member +0.5 of the equivalence
class of the ADST at the values of [Q2] where the ADST exists. There is an ADST
for most [Q2]’s used. The ﬁrst row of dots up from the bottom marks [Q2] values
where there is no ADST. As expected, these are all at rational [Q2]’s such as 1/5, 1/4,
2/5 . . . or ˜a2/2˜b2 = 1/6, 3/14, 3/10 . . . and the [cn c] computed for these [Q2] show f 2
dependence. The curved line shows Plim and the second row of dots from the bottom
marks [Q2] values where the ISF obtained by stroboscopic averaging did not converge
for all phases. These coincide with sharp dips in Plim and are at or near [Q2] = ˜a2/2˜b2,
i.e in the snake “resonance” subset of the [Q2]’s in the ﬁrst row. Thus snake “resonance”
is already a static phenomenon. Near such [Q2]’s, the ISF, which for just one orbital
mode is a closed curve in three dimensions, becomes extremely complicated as ˆn strives
to satisfy its deﬁning conditions. Right at [Q2] = ˜a2/2˜b2 the nonconvergence occurs
at [f 2/2p ] = j/2˜b2 for integers j = 1, ..., 2˜b2 and, moreover, the ISF is discontinuous
at these phases 2. For [Q2] = ˜a2/4˜b2 ( ˜a2 < 4˜b2), Plim and the ISF show no special
behaviour. These observations are consistent with the perturbative result [7] that for
mid–plane symmetric systems, ˆn should be well behaved near even m2 but may show
exotic behaviour close to odd m2 = ˜b2. As expected, Plim and the ISF also show no
special behaviour for [Q2] = a2/˜b2 (a2 < ˜b2). Some snake “resonances” such as that at
[Q2] = 1/30 are narrower than 0.00002 in [Q2] and are missed in this scan. Plim also has
several dips at values of [Q2] (e.g. at 0.341) which appear to have no special signiﬁcance,
but which should still be avoided at storage. The results for 0.5
1.0 are the
reﬂection in 0.5 of the curves and points shown. Qualitatively similar results are obtained

[Q2]

≤

≤

2 Note that in [3] it was convenient to require that the magnetic and electric ﬁelds and the ISF were smooth
in f and s. Here we drop that requirement since we are dealing with models with pointlike snakes.

5

with equally distributed odd pairs of snakes set to give n 0 = 1/2. The ISF and Plim usually
vary signiﬁcantly with s.

Plimn
s
Poorly conv. Strob. Ave.
s

No n

0.5

s

1

0

0

0.05

0.1

0.15

0.2

0.3

0.35

0.4

0.45

0.5

0.25
[Q2]

FIGURE 1. Plim (left axis) and a component of the ADST (right axis) for the SRM with d = 0, e = 0.4
and with 2 Siberian Snakes with axes at 90◦ and 0◦.

Radial component
Vertical component
Longitudinal component

0.8

0.6

0.4

0.2

0

m

i
l

P

t
n
e
n
o
p
m
o
C

0.5

1

0

-0.5

-1

0

0.5
2 /2p ]

[f

1

FIGURE 2. The three components of ˆn(f 2) for the SRM with 2 Siberian Snakes with axes at 90◦ and
0◦ and for [Q2] = 1/6. Viewing point: just before a snake. d = 0 and e = 0.4.

6

n
Addendum

≤

A typical example for an ISF at a snake “resonance” is shown in ﬁgure 2. This shows
the components of the ISF for [Q2] = 1/6 and e = 0.4. In this case they are obtained by
1/2˜b2,
using the 6–turn spin map to calculate the vector ˆn in the range 0 < [f 2/2p ]
namely 0 to 60 degrees, while applying the constraint that ˆn should be continuous in
f 2. Then the ˆn for each f 2 in this range is transported with the 1–turn spin map for
six, or more, turns. One sees that ˆn changes sign at values of f 2 which are multiples of
60 degrees so that the ISF is discontinuous as advertised. The six sets of stray points
at [f 2/2p ] = 1/12, 1/4 . . . are at phases f 2 where the 6–turn spin map is the identity.
At these phases ˆn obtained in this way is arbitrary and the algorithm delivers values
dominated by numerical noise. Of course, if the ISF is represented as the locus of points
on the surface of the unit 2–sphere, this ISF gives disjoint segments. It is also easy
to demonstrate that the positions of the discontinuities can be shifted. Thus at snake
“resonances” the invariant spin ﬁeld is not only discontinuous but also non–unique and
to an extent which goes far beyond the non–uniqueness at the phases f 2 at which the
6–turn spin map is the identity. The ISF shows analogous behaviour at other snake
“resonances”. This is in stark contrast to the case, say, of the pure SRM. Note that
discontinuities would not be allowed for irrational [Q2], but that they are not prohibited
for rational [Q2]. Moreover, theorems on uniqueness of the ISF require the existence of
a spin tune and that the system is away from orbital resonance. Of course, for snake
“resonances” with very high values of ˜b2, the ISF and the corresponding conﬁguration
of equilibrium polarisation is very complicated. It is then far from clear whether the
ISF is a useful concept for these simple models involving just one plane of orbital
motion and singular, i.e., non–physical ﬁelds, although, of course, such models have
been instrumental in presaging the loss of polarisation observed in real storage rings
[17, 18, 19].

The ISF obtained from the real eigenvector of the multi–turn spin map is also non–
unique for [Q2] = ˜a2/4˜b2, namely at those [f 2/2p ] where the 4˜b2–turn spin map is the
identity. Moreover, additional discontinuities in the sign can be added by hand, thereby
enhancing the choice of ISF’s. But in contrast to the case of snake “resonances” such
discontinuities remain optional.

Further aspects of these matters will be reported elsewhere.
It is instructive to compare the discontinuous curves in ﬁgure 2 with the smooth curves
in ﬁgures 7 and 8 in [2] 3. These are also said to represent ISF’s at snake “resonances”.
The vectors corresponding to the curves in ﬁgure 2 satisfy the T–BMT equation by
construction and they are single valued in [f 2/2p ] as required for an ISF. However,
if the vectors for the curves in ﬁgures 7 and 8 in [2] are transported according to the
T–BMT equation, they are not single valued in [f 2/2p ]. Alternatively, if those curves
are taken to represent single–valued functions of [f 2/2p ], as depicted, then they do not
represent spin motion, i.e., motion according to the T–BMT equation. Either way, the
curves in those ﬁgures do not represent ISF’s at snake “resonances”.

3 It is also shown in [2] that the curve in ﬁgure 1 can be reproduced by the MILES algorithm by the same
author. MILES, like SODOM–II, is based on SU(2) and Fourier expansions.

7

SUMMARY

A snake “resonance” is at root a static phenomenon characterised by an invariant spin
ﬁeld which, for the simple models discussed here, is irreducibly discontinuous in f 2
for most orbital amplitudes. Moreover, on and near snake “resonance”, there is no
amplitude dependent spin tune so that the snake “resonances” of these models are
not simple spin–orbit resonances. The mechanism, in terms of Js, for polarisation loss
during acceleration through d = 0 at and near such [Q2]’s is under study.

We thank K. Heinemann, G. H. Hoffstaetter and J.A. Ellison for useful discussions.

REFERENCES

1. D.P. Barber, R. Jaganathan and M. Vogt, Proc. 15th Int. Spin Physics Symposium, Brookhaven

National Laboratory, Long Island, U.S.A., September 2002. AIP proceedings 675 (2003).
S.R. Mane, Nucl. Instr. Meth. A528 667 (2004).

2.
3. D.P.Barber, J.A. Ellison and K. Heinemann, Phys. Rev. ST Accel. Beams 7(12), 124002 (2004).
4. K. Heinemann and G.H. Hoffstaetter, Phys.Rev. E 54(4) 4240 (1996).
5. G.H. Hoffstaetter, M. Vogt and D.P. Barber, Phys. Rev. ST Accel. Beams 11(2) 114001 (1999).
6. G.H. Hoffstaetter, “A modern view of high energy polarised proton beams”, To be published as a

Springer Tract in Modern Physics.

J.D. Jackson, “Classical Electrodynamics”, 3rd edition, Wiley (1998).

7. M. Vogt, Ph.D. Thesis, University of Hamburg, DESY-THESIS-2000-054 (2000).
8.
9. K. Yokoya, DESY report 86-57 (1986).
10. D.P. Barber, G.H. Hoffstaetter and M. Vogt, SPIN 2000, AIP proceedings 570 (2001).
11. G.H. Hoffstaetter and M. Vogt, Phys. Rev. E 70, 056501 (2004).
12. D.P. Barber et al., in “Quantum Aspects of Beam Physics”, Monterey, 1998, World Scientiﬁc (1999).
13. S.R. Mane, Nucl. Instr. Meth. A480, p.328 and A485, p.277 (2002).
14. K. Yokoya, DESY report 99-006 (1999), Los Alamos archive: physics/9902068.
15. S.R. Mane, Fermilab technical report TM-1515 (1988).
16. K. Yokoya, SSC CDG report SSC-189 (1988).
17. S.Y. Lee, “Spin Dynamics and Snakes in Synchrotrons”, World Scientiﬁc (1997).
18. A.Luccio, V.Ptitsyn and V. Ranjbar, Proc. 15th Int. Spin Physics Symposium, Brookhaven National

Laboratory, Long Island, U.S.A., September 2002. AIP proceedings 675 (2003).

19. M. Bai et al., Proc. 16th Int. Spin Physics Symposium, Trieste, Italy, October (2004). To be published

by World Scientiﬁc.

8

