4
0
0
2
 
p
e
S
 
0
1
 
 
]
h
p
-
c
c
a
.
s
c
i
s
y
h
p
[
 
 
1
v
4
5
0
9
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Coherent Beam-Beam Tune Shift of Unsymmetrical Beam-Beam
Interactions with Large Beam-Beam Parameter

Department of Physics & Astronomy, The University of Kansas, Lawrence, KS 66045

Department of Physics, Cornell University, Ithaca, NY 14850

Lihui Jin and Jicong Shi

Georg H. Hoﬀstaetter

Abstract

Coherent beam-beam tune shift of unsymmetrical beam-beam interactions was studied experi-

mentally and numerically in HERA where the lepton beam has a very large beam-beam parameter

(up to ξy = 0.272). Unlike the symmetrical case of beam-beam interactions, the ratio of the coher-

ent and incoherent beam-beam tune shift in this unsymmetrical case of beam-beam interactions

was found to decrease monotonically with increase of the beam-beam parameter. The results of

self-consistent beam-beam simulation, the linearized Vlasov equation, and the rigid-beam model

were compared with the experimental measurement. It was found that the coherent beam-beam

tune shifts measured in the experiment and calculated in the simulation agree remarkably well but

they are much smaller than those calculated by the linearized Vlasov equation with the single-mode

approximation or the rigid-beam model. The study indicated that the single-mode approximation

in the linearization of Vlasov equation is not valid in the case of unsymmetrical beam-beam in-

teractions. The rigid-beam model is valid only with a small beam-beam parameter in the case of

unsymmetrical beam-beam interactions.

PACS: 29.27.Bd, 29.20.-c, 29.27.-a, 05.45.-a

Corresponding author:

Jack Shi, Department of Physics & Astronomy, University of Kansas, Lawrence, KS 66045

Phone: 785-864-5273; Fax: 785-864-5262; Email: jshi@ku.edu

1

I. INTRODUCTION

To achieve a substantial increase of luminosity in a storage-ring collider, limited options include

increase of bunch currents, reduction of beam sizes at interaction points (IPs), and increase of the

number of colliding bunches. The ﬁrst two measures unavoidably increase head-on beam-beam

forces which could lead to collective (coherent) beam-beam instabilities [1, 2]. Understanding of

coherent beam-beam eﬀects especially in the nonlinear regime is therefore of primary importance

for achieving high luminosity in a storage-ring collider with high-intensity beams.

To study the coherent beam-beam eﬀect, one important quantity that can be measured exper-

imentally is the coherent beam-beam tune shift. Without beam-beam interactions and without

considering nonlinearities in the lattice, the two counter-rotating beams oscillate transversely with

frequencies that correspond to lattice tunes (betatron tunes without collision) if they deviate from

close orbits. With beam-beam interactions, the particle distributions of the beams are perturbed

and evolve with time according to the Vlasov equation [1]. The dynamics of the beams could

therefore be complicated by multi-mode oscillations of the beam distributions. If considering only

the stable oscillation of beam centroids (coherent dipole oscillation), the frequency spectrum of the

beam-centroid oscillation has two primary frequencies for each degree of freedom of the transverse

motion. These primary frequencies correspond to the tunes measured during collision. The dif-

ferences between these measured collision tunes and the lattice tunes are the coherent beam-beam

tune shifts [1, 3, 4]. Over decades, many studies have been conducted on the relationship between

the coherent beam-beam tune shift and the beam-beam parameter that measures the strength of

the beam-beam interaction [3-13]. Two theoretical models, the linearized Vlasov equation [1] and

the rigid-beam model [5], have been studied extensively for cases of weak beam-beam perturbation

in which the beam-beam parameter is relatively small. When the two beams have the same or very

close lattice tunes, the calculation of the coherent beam-beam tune shift based on the linearized

Vlasov equation with single-mode approximation agrees with beam measurements and computer

simulations [3, 4, 6, 7]. The rigid-beam model is inconsistent with the linearized Vlasov equation

2

and was therefore proven to be wrong by beam measurements in this case [6, 7]. When the two

beams have very diﬀerent lattice tunes, on the other hand, the calculation based on the rigid-beam

model provides a good agreement with beam measurements [5, 8, 14]. In both of these models, the

equilibrium beam distributions were assumed to be Gaussian distributions for easing the calcula-

tions. In the case of weak beam-beam perturbation, this assumption is fairly good as the beams

were observed to stay close to a Gaussian.

The situation of strong beam-beam perturbations with relatively large beam-beam parameter

is much more complicated and less understood. When the beam-beam parameter exceeds a thresh-

old, the beam-beam interaction could induce a chaotic coherent beam-beam instability. After the

onset of the instability, the closed orbits could become unstable for the beam centroids and two

beams could develop a spontaneous unstable coherent oscillation [2, 15]. When the beam-beam

parameter is below the beam-beam threshold, the coherent beam oscillation is stable. It is, how-

ever, not clear whether the linearized Vlasov equation or the rigid-beam model are still valid in the

regime of strong beam-beam perturbation. As many eﬀorts are being made to further increase the

beam-beam parameter in upgrades of current and developments of future storage-ring colliders, an

understanding of the coherent beam-beam tune shift in this regime not only is necessary for the

interpretation of the tune measurement during operation of colliders with high-intensity beams but

also could shed light on the onset of the chaotic coherent beam-beam stability.

To explore the beam-beam eﬀect with a large beam-beam parameter a beam experiment, the

HERA 2000 beam study, was performed on HERA [Hadron Electron Ring Accelerator at DESY

(Deutsches Elektronen-Synchrotron), Hamburg, Germany] in which a 920 GeV proton (p) beam

and a 27.5 GeV positron (e+) beam collided at two IPs, H1 and ZEUS [16]. The beam-beam

interaction in HERA is a typical case of unsymmetrical beam-beam interaction as the two beams

have very diﬀerent lattice tunes and beam-beam parameters (strong p beam and weak e+ beam).

In the experiment, the vertical beam-beam parameter of the e+ beam was varied from 0.068 to

0.272 by changing the vertical beta-function of the e+ beam at two IPs. The emittance of the e+

3

beam and the luminosity were measured as functions of the beam-beam parameter. One important

phenomenon observed in this experiment is that the measured coherent beam-beam tune shifts of

the e+ beam are much smaller than those calculated from the rigid-beam model. This is the ﬁrst

experimental evidence indicating that the traditional models of the coherent beam-beam tune shift

are no longer valid in the situation of strong beam-beam perturbations.

To have a better understanding of the experimental data, we reconstructed the HERA beam

experiment with a self-consistent beam-beam simulation. Remarkable agreement between the ex-

periment and the simulation was observed on emittance growth and luminosity reduction. More

signiﬁcantly, the computer simulation conﬁrmed the experimental result of very small coherent

beam-beam tune shifts in this case of a very large beam-beam parameter. To examine the validity

of the theoretical models for the coherent beam-beam tune shift, the linearized Vlasov equation and

the rigid-beam model were solved for the HERA experiment. Since the distribution of the e+ beam

signiﬁcantly deviated from the Gaussian due to the strong beam-beam interaction, the solutions of

the linearized Vlasov equation and the rigid-beam model were calculated with the beam distribu-

tions obtained from the beam-beam simulation instead of assuming Gaussian distributions. It was

found that for the unsymmetrical beam-beam interaction with a large beam-beam parameter, the

result of the rigid-beam model is inconsistent with the beam experiment and beam simulation even

though a more accurate beam distribution was used in the calculation. The coherent beam-beam

tune shifts calculated from the linearized Vlasov equation with the single-mode approximation were

also found to be signiﬁcantly diﬀerent from the result of the beam experiment and beam simulation

no mater whether the beam-beam parameter is large or small. As the linearization of the Vlasov

equation is expected to be valid for at least a small beam-beam parameter, this discrepancy sug-

gests that the single-mode approximation used for solving the linearized Vlasov equation may not

be valid in the case of unsymmetrical beam-beam interactions. Unfortunately, without the single-

mode approximation the linearized Vlasov equation for the problem of beam-beam interactions is

currently unsolvable computationally due to the unsolved degeneracy problem of a matrix with

4

mode coupling.

This paper is organized as follows. Section II summarizes the results of the HERA 2000 beam

experiment. In Section III, the self-consistent beam simulation for the HERA beam experiment is

discussed. In Section IV, the coherent beam-beam tune shifts calculated by using the rigid-beam

model or the linearized Vlasov equation are compared with the experiment/simulation results. The

details of the coherent tune calculation with the theoretical models are presented in Appendix A

and B. The characteristics of the coherent beam-beam tune shift in the unsymmetrical case of

beam-beam interactions are discussed in Section V. Section VI contains a summary remark.

II. HERA 2000 BEAM EXPERIMENT

In the luminosity upgrade of HERA, the beam-beam parameters of the electron beam have been

nearly doubled. To examine any possible luminosity reduction due to beam-beam eﬀects, a series

of beam experiments were performed in HERA [14, 16]. In the HERA 2000 beam experiment, the

e+ beam was used to collide with the p beam at the two IPs and the eﬀect of a large beam-beam

parameter of the lepton beam was explored by increasing the vertical beta-function (βe,y) of the

e+ beam at the IPs. The vertical beam-beam parameter (ξe,y) of the e+ beam is related to βe,y by

[17]

ξe,y =

reNp
2πγe

βe,y
σp,y(σp,x + σp,y)

(1)

where re and γe are the classic radius and Lorentz factor of positron, respectively, and Np is the

number of protons per bunch. The horizontal and vertical size of the p beam at the IPs are given by

σp,x and σp,y. In the experiment, the p beam current (Ip) was ﬁxed. Since the beam-beam parameter

of the p beam is very small, there was little change in the p beam size as it was observed during the

experiment. The vertical beam-beam parameter ξe,y is therefore linearly proportional to βe,y in this

case. During the experiment, after the proton current was ﬁlled, ξe,y was increased from 0.068 to

0.272 as βe,y was changed from 1.0 to 4.0 m while other lattice parameters were kept as constants.

It should be noted that with two IPs in the HERA experiment a beam-beam parameter of 0.272

5

is among the highest ever achieved in storage-ring colliders. Table 1 lists the e+ beam current

(Ie) and the beam-beam parameters of the e+ and p beam at βe,y where the measurement was

performed. For the p beam, Ip = 90 mA, the beta-function at the IPs were (βp,x, βp,y) = (7.0, 0.5)

m; the lattice tunes were (νx, νy) = (31.291, 32.297); and the emittance without collision was

(ǫ0x, ǫ0y) = (3.82, 3.18) nm. For the e+ beam, βe,x = 2.5 m, (νx, νy) = (52.169, 52.246), and

(ǫ0x, ǫ0y) = (32.0, 1.28) nm. Other beam parameters can be found in [16]. The e+ and p beam

sizes were not matched during the collision. In the experiment, the emittance of the e+ beam and

the luminosity were measured as functions of βe,y at both the IPs. In Figs. 1 and 2, the measured

emittance and the speciﬁc luminosity were plotted, with discrete points, as functions of ξe,y. For

each ξe,y where the measurement was performed, two data points correspond to the measurement

at the two IPs, respectively. The speciﬁc luminosity is deﬁned as

Ls = NcolL

/(IeIp) where Ncol

and

are the number of colliding bunches and the luminosity, respectively [14]. As shown in

L

Fig. 1, the vertical emittance growth of the e+ beam increases monotonically and smoothly with

the increase of ξe,y. This is the characteristics of the incoherent beam-beam eﬀect in contrast to

the coherent beam-beam eﬀect of which the emittance growth as a function of the beam-beam

parameter could experience certain jumps (phase transitions) due to the onset of the coherent

beam-beam instability [2]. To conﬁrm that the luminosity reduction in Fig. 2 is indeed due to the

emittance blowup, the luminosity calculated with the measured emittance by using the standard

formula [16] is also plotted in the Fig. 2. The agreement between the measured luminosity and the

calculated luminosity in Fig. 2 shows a consistency in the emittance and luminosity measurement.

In the experiment, the collision tunes of the e+ beam were also measured at βe,y = 4.0 m as νx =

52.160 and νy = 52.233. The coherent beam-beam tune shift of the e+ beam is therefore only ∆νx =

0.009 and ∆νy = 0.013 while from the rigid-beam model ∆νx = 0.016 and ∆νy = 0.042 if both the

beams are Gaussian [14]. The measured coherent beam-beam tune shifts in this case are inconsistent

with the traditional understanding of beam coherent oscillation. Moreover, in the symmetrical case

of beam-beam interactions, the ratio of the coherent and incoherent beam-beam tune shift has a

6

value approximately ranging from 1.2 for round beams to 1.3 for ﬂat (one-dimensional) beams [4].

Since the beam-beam parameters of the p beam is very small, the distribution of the p beam in

the HERA experiment is still very close to a Gaussian. The incoherent beam-beam tune shifts

that are the tune shifts of a single particle with an inﬁnitesimal betatron oscillation are 2ξe,x =

0.082 and 2ξe,y = 0.544 for the e+ beam in the horizontal and vertical plane, respectively. The

ratios of coherent and incoherent beam-beam tune shifts of the e+ beam are ∆νe,x/(2ξe,x) = 0.11

and ∆νe,y/(2ξe,y) = 0.024 at βe,y = 4.0 m. The coherent beam-beam tune shifts in this case of

unsymmetrical beam-beam interactions with a large beam-beam parameter are therefore extremely

small as compared with the incoherent beam-beam tune shifts or compared with the symmetrical

case of beam-beam interactions.

III. RECONSTRUCTION OF HERA BEAM EXPERIMENT WITH NUMERICAL

SIMULATION

To have a better understanding of the measured data in the HERA experiment, we have recon-

structed the experiment with a self-consistent beam-beam simulation. This numerical study also

served as a detailed benchmark of our beam-beam simulation code with the experimental measure-

ment. In the simulation, the linear HERA lattice with the two IPs was used. The code used in

this study is an expanded version of [2] that is currently capable of studying beam-beam eﬀects of

proton or lepton beams with any aspect ratio (ratio between vertical and horizontal beam size).

The two colliding beams were represented by a million macro-particles with given initial Gaussian

distributions in transverse phase space. Without beam-beam interactions, the initial beam distri-

bution used in the simulation matches exactly with the lattice. Beam-beam interaction at each the

IP was represented by a kick in transverse phase space and the kick was calculated by using the

particle-in-cell method as described in Ref.

[2]. Since the beams in the HERA experiment were

ﬂat, a uniform mesh extending to

20σ in the conﬁguration space with a grid constant of 0.2σ

±

was necessary in this case. Tracking of particle motion was conducted in four-dimensional trans-

7

verse phase space without synchrotron oscillations and momentum deviations. For lepton beams,

the quantum excitation and synchrotron damping were treated as kicks in each turn during the

tracking. The horizontal kick is [18]

∆x = e

−1/(2τx)x +

∆px = e

−1/(2τx)px +

1

−

h(cid:16)

1

−

h(cid:16)

−1/(2τx)
e

ǫx

1/2

w1

(cid:17)
−1/(2τx)
e

i
ǫx

1/2

w2

(cid:17)

i

(2)

where x and px are the normalized horizontal coordinate and its conjugate momentum, ǫx is the

horizontal emittance, and w1 and w2 are random numbers with a Gaussian distribution that is

centered at zero and has unit standard deviation. The damping time in horizontal and vertical

direction, τx and τy, have the unit of turns. For HERA, τx = 436 and τy = 600, respectively. The

vertical kick has a similar formula.

With the beam-beam simulation, the emittance growth of the e+ beam and the speciﬁc lumi-

nosity were calculated as functions of ξe,y for the HERA experiment and the results were plotted

in Figs. 1 and 2 as solid lines. Both the emittance and the luminosity plot show a remarkable

agreement between the experiment and the simulation. Figure 3 plots the evolution of the vertical

emittance of the e+ beam at diﬀerent βe,y. In all these cases, after a quick emittance blowup, the

beam emittance is re-stabilized and, consequently, an equilibrium (or quasi-equilibrium) state of

the e+ beam was reached. During the emittance blowup, the particles in the beam core escape

quickly to the beam tails. Without the onset of the coherent beam-beam instability, the particles

in the beam tails are stable for the beam-beam interaction. This re-stabilization of the beam emit-

tance is therefore due to a depopulation of the beam core and is consistent with the experimental

observation that the beam lifetime and operation conditions were good during the experiment even

in the case of ξe,y = 0.272 [16].

In the beam simulation, the coherent beam-beam tune shift was also calculated. Fig. 4 is

the calculated power spectrum of the coherent oscillation of the e+ beam at βe,y = 4.0 m. Due

to the quantum ﬂuctuation, the e+ beam has always a very small oscillation which is enough for

8

the calculation of the coherent frequency if the numerical noise is small. Since a large number of

particles were used for each of the beams, in this simulation the numerical noise was very low and

we were able to calculate the coherent frequency without applying oﬀ-center kicks on the beams.

The spectrum was calculated by the fast Fourier transformation (FFT) of the beam centroid motion

from the 5000th to 9000th turn. Since at the 5000th turn the beam has already reached its quasi-

equilibrium, the transient state of the beam was thrown out during the tune calculation (see Fig.

3). As shown in Fig. 4 the power spectrum peaks at 0.1605 and 0.2331 in the horizontal and

vertical planes, respectively, which corresponds to νx = 52.161 and νy = 52.233 for the beam

coherent tunes during collision. This simulation result agrees excellently with the experimental

measurement of νx = 52.160 and νy = 52.233. The beam-beam simulation therefore conﬁrmed the

coherent beam-beam tune shift measured in the HERA beam experiment.

To understand the very small coherent beam-beam tune shift in this case of very large beam-

beam parameter, the dynamics of the beam particle distributions was studied during the beam

simulation. As shown in Fig. 5, the distribution of the e+ beam deviates from a Gaussian distri-

bution with a signiﬁcant drop at the beam core and a growth of the beam tails. Compared with

the distribution of the e+ beam, a Gaussian beam that has the same emittance of the e+ beam has

more particles in the core. The real coherent beam-beam tune shift measured in the experiment and

calculated with the beam simulation is therefore smaller than that calculated from the rigid-beam

model with Gaussian beams. Moreover, the assumption of Gaussian beams in all the theoretical

models of the coherent beam-beam oscillation neglects the eﬀect of the φ-dependence of the beam

equilibrium distributions, where φ is the angle of the action-angle variable. In the HERA beam

experiment, the equilibrium (quasi-equilibrium) distribution of the e+ beam in fact has a strong

φ-dependence as shown in Fig. 6. For a comparison, the initial distribution used in the simulation

was also plotted in the Figure and shows no φ-dependence as it should be. In order to compare

the experimental/simulation result with calculations of theoretical models, the theoretical models

need to be modiﬁed to include the φ-dependence of non-Gaussian equilibrium distributions.

9

IV. VALIDITY OF THEORETICAL MODELS FOR BEAM COHERENT

OSCILLATION

Two theoretical models, the rigid-beam model and the linearized Vlasov equation with the

single-mode approximation, were examined with the HERA experiment. For the rigid-beam model,

the coherent tunes were calculated with two diﬀerent methods: assuming a Gaussian distribution as

the equilibrium distribution of the e+ beam [Eqs. (A10) and (A14) in Appendix A.1] or using the

non-Gaussian quasi-equilibrium distribution of the e+ beam obtained in the beam-beam simulation

(Appendix A.2). In the case of the Gaussian distribution, the beam sizes used in Eq. (A14) are

of the experimental measurement or the beam-beam simulation. The small diﬀerences in the

beam sizes measured in the experiment or calculated from the simulation (see Fig. 1) made little

diﬀerence in Eq. (A14). For the linearized Vlasov equation, the horizontal coherent tunes were

obtained by solving the initial-value problem of the linearized Vlasov equation with the single-mode

approximation in the horizontal plane. The details of the calculations are in Appendix A and B.

Tables II and III list the ratio of the coherent and incoherent beam-beam tune shifts of the e+

beam, ∆νe,x/(2ξe,x) and ∆νe,y/(2ξe,y), calculated in the beam simulation or calculated with the

theoretical models for the cases of βe,y = 1.0 and 4.0 m, where ∆νe,x and ∆νe,y are the horizontal

and vertical coherent beam-beam tune shift of the e+ beam. The experimental measurement

at βe,y = 4.0 m is also included in Table II. The signiﬁcant discrepancy between the results of

the models and the results of the experiment/simulation shows that the theoretical models are

inconsistent with the experiment and simulation. Note that the rigid-beam model with the beam

distribution from the simulation did a little better than that with Gaussian distribution. To further

examine the failure of the theoretical models, a beam-beam simulation was conducted for the case

of βe,y = 1.0 m but with only one tenth of the p-bunch current used in the experiment, i.e.

ξe,y = 0.0068. The result is listed in Table IV and shows that the rigid-beam model with either

the Gaussian distribution or the distribution obtained from the simulation are in a good agreement

with the beam simulation. In fact, the quasi-equilibrium distribution of the e+ beam in this case

10

is very close to a Gaussian. This re-conﬁrms many previous studies that the rigid-beam model is

correct for unsymmetrical beam-beam interactions with relatively small beam-beam parameter.

In the case of the linearized Vlasov equation, as shown in Tables II-IV, the calculation yielded

wrong results no matter how small the beam-beam parameter is.

In the calculation with the

Vlasov equation, several approximations were employed. Among them, the linearization, the one-

dimensional beam, and the single-mode approximation are the three major approximations that

cannot be directly justiﬁed by the experimental observations (see Appendix B). The linearization of

the Vlasov equation should not play the leading role in its failure for the unsymmetrical beam-beam

interaction since the linearization should be valid for a relatively small beam-beam parameter. To

verify the validity of the one-dimensional approximation, we did a series of beam-beam simulations

for the case of βe,y = 1.0 m, ξe,y = 0.068 or 0.0068, but with a diﬀerent beam aspect ratio (σy,e/σx,e)

ranging from 0.063 to 0.120. In all these cases, the horizontal coherent beam-beam tune shift was

found to be very similar to that of the HERA experiment. Note that in the HERA experiment

and in all the cases in Tables II-IV, σy,e/σx,e = 0.126. This indicates that the horizontal coherent

beam-beam tune shift is not sensitive to the aspect ratio of the beam. Similar phenomenon has

also been observed in the symmetrical case of beam-beam interactions [4]. The large discrepancy in

the coherent beam-beam tune shifts calculated with the linearized Vlasov equation as compared to

that obtained from the experiment/simulation is apparently not due to the approximation of one-

dimensional beam. With the single-mode approximation, on the other hand, the only oscillation

mode of the beam distribution that was kept in the calculation is the m = 1 mode in Eq. (B6).

As shown in Fig. 6, the equilibrium distribution of the e+ beam [f1,0(I, φ) in Eq. (B4)] depends

strongly on φ. In this case, the dominant mode of the equilibrium distribution is the m = 2 mode

which has a φ-dependence of ei2φ. As the m = 2 mode could be a dominant intrinsic mode of

the system, the single-mode approximation could be inconsistent with the dynamics of the beam.

In order to study the eﬀect of mode couplings in the linearized Vlasov equation, we have derived

the eigenvalue equation of the linearized Vlasov equation that is similar to Eq. (B13) but includes

11

high-order modes. After truncating higher-order modes at m = mp, M in Eq. (B13) becomes a

(2mp + 1)(2lp + 2)

(2mp + 1)(2lp + 2) matrix where lp is the number of grids on the mesh of the

×

action space and M1 and M2 in Eq. (B14) are no longer diagonal matrices (see Appendix B). We

have, however, failed in obtaining a set of orthogonal eigenvectors for the eigenvalue equation of the

linearized Vlasov equation because M is a singular (ill-conditioned) matrix when the mode couplings

are included. Similar problem has also been encountered when including the mode coupling in the

case of symmetrical beam-beam interactions.

V. COHERENT VERSUS INCOHERENT BEAM-BEAM TUNE SHIFT

In the symmetrical case of beam-beam interactions, the ratio of the coherent and incoherent

beam-beam tune shift is approximately a constant of 1.2 for round beams and 1.3 for ﬂat beams

[4]. Note that with symmetrical beam-beam interactions, the beam-size growths of the two beams

are symmetrical and the beam distributions are usually close to a Gaussian when the beam-beam

parameter is below the threshold of the onset of coherent beam-beam instability [2, 15]. The

coherent beam-beam tune shift depends linearly on the beam-beam parameter in a fairly large

range of beam-beam parameter [4]. On the contrary, in the HERA experiment the ratio of the

coherent and incoherent beam-beam tune shift of the e+ beam decreases monotonically with the

increase of the beam-beam parameter as shown in Fig. 7. This diﬀerent characteristic of the

coherent beam-beam tune shift stems mainly from the mismatch in the equilibrium distributions

of two unsymmetrical colliding beams. In the HERA experiment, the beam size of the e+ beam

at the IPs is slightly larger than that of the p beam initially without collision (see Table I). When

the beam-beam parameter is small such as in the case of ξe,y = 0.0068, the beam-size growth is

insigniﬁcant and the beams are close to the Gaussians. The ratio of the coherent and the incoherent

beam-beam tune shift of the e+ beam is simply determined by the mismatch in the initial beam

sizes without collision as described by Eq. (A14) of the rigid-beam model. When the beam-beam

parameter is large, on the other hand, the beam-size growth of the e+ beam is signiﬁcant (see Fig.

12

1) and dominates the beam-size mismatch. Moreover, the particle distribution of the e+ beam

deviates signiﬁcantly from a Gaussian distribution (see Fig. 5). In this situation, the size of the

e+ beam is much larger than that of the p beam and a large number of e+ particles escape to the

beam tails that is away from the core of the p beam. The coherent beam-beam tune shift of the e+

beam thus becomes much smaller than that in the case of two matched Gaussian beams. Note that

for two matched Gaussian beams, the ratio of the coherent and incoherent beam-beam tune shift is

0.5 for unsymmetrical beam-beam interactions. As the beam-size growth and the resultant beam-

size mismatch increase with the beam-beam parameter, the ratio of the coherent and incoherent

beam-beam tune shift of the e+ beam decreases with the beam-beam parameter. In general, the

equilibrium states of the Vlasov equation in Eq. (B4) are diﬀerent for two unsymmetrical colliding

beams due to the asymmetry of beam-beam perturbations. The mismatch in the distributions as

well as the beam sizes is, in principle, independent of the initial states of the beam distributions and

the initial beam-size mismatch as long as the considered equilibrium state of the Vlasov equation

in Eq. (B4) is well isolated and is the only one that is close to the initial beam distributions. The

beam-size mismatch in the unsymmetrical case of beam-beam interactions is therefore intrinsic

and unavoidable especially when the beam-beam parameter is larger. Moreover, this beam-size

mismatch increases with the strength of beam-beam perturbations. The functional dependence of

the coherent beam-beam tune shift on the beam-beam parameter in Fig. 7 is therefore a general

characteristic of unsymmetrical beam-beam interactions.

Figure 7 also plots ∆νe,y/(2ξe,y) as a function of ξe,y calculated based on the rigid-beam model.

It shows that when the beam-beam parameter is large, the rigid-beam model results in a similar

ξe,y-dependence of ∆νe,y/(2ξe,y) even though it overestimates the coherent beam-beam tune shift.

Note that in the rigid-beam model, this ξe,y-dependence is due to the beam-size mismatch as given

in Eq. (A14). At a large ξe,y, the beam-size mismatch is dominated by the beam-size growth of

the e+ beam. This suggests that the result of the rigid-beam model in Eq. (A14) provides an

approximation of the functional dependence of the coherent beam-beam tune shift to the intrinsic

13

beam-size mismatch in unsymmetrical beam-beam interactions with large beam-beam parameters.

VI. CONCLUSION

The coherent beam-beam tune shift was studied in the case of unsymmetrical beam-beam

interactions where the two beams have very diﬀerent beam-beam parameters and betatron tunes.

The results of a self-consistent beam-beam simulation, the rigid-beam model, and the linearized

Vlasov equation were compared with the beam measurement in the HERA 2000 Beam Study.

Remarkable agreement was found between the beam simulation and the HERA experiment in a

wide range of and, especially, at very large beam-beam parameters of the lepton beam. The rigid-

beam model was found to be only correct when the beam-beam parameter is small. The result of

the linearized Vlasov equation with the single-mode approximation is inconsistent with the result

of the beam experiment/simulation in either cases of large or small beam-beam parameter. The

failure of the linearized Vlasov equation could be due to the single-mode approximation used in

solving the linearized Vlasov equation. A study of the dynamics of the beam distribution showed

that the high-order modes are important to the beam dynamics in this situation. An attempt

to include high-order modes in the calculation has, however, not been successful because of the

diﬃculty in ﬁnding a set of orthogonal eigenvectors for the linearized Vlasov equation. Recently,

eﬀorts have been made to include the angle-dependence of beam distributions in an expansion of

the Vlasov equation [19]. More studies are needed for a relevant solution of the linearized Vlasov

equation for the unsymmetrical beam-beam interaction. Currently, the numerical simulation is the

only reliable approach for an prediction of the coherent beam-beam tune shift in this situation.

One interesting phenomenon observed in this study is the very small coherent beam-beam tune

shift in this unsymmetrical case of beam-beam interactions.

It was found that the ratio of the

coherent and incoherent beam-beam tune shift of the weak lepton beam in HERA decreases from

0.3 to 0.02 as the incoherent beam-beam tune shift increases from 0.01 to 0.54. On the contrary,

in the symmetrical case of beam-beam interactions, this ratio maintains approximately a constant

14

of 1.2 for a round beam or 1.3 for a ﬂat beam in a large range of beam-beam parameter. The

reason for this diﬀerent characteristic of the coherent beam-beam tune shift is the intrinsic beam-

size mismatch between two unsymmetrical colliding beams due to the diﬀerence in the equilibrium

distributions of the two beams. This intrinsic mismatch in the beam distributions due to beam-beam

interactions becomes more pronounced as the strength of beam-beam perturbations increases. The

ratio of the coherent and incoherent beam-beam tune shift decreases, in general, with the increase

of beam-beam parameters in the unsymmetrical case of beam-beam interactions.

APPENDIX A. COHERENT BEAM-BEAM TUNE SHIFT FROM RIGID-BEAM

MODEL

The coherent beam-beam tune shift in the rigid-beam model has been studied before for the

unsymmetrical beam-beam interaction. Previous studies are, however, limited to the special cases

where either the two beams have the same [8] or very diﬀerent [14] beam-beam parameters. More-

over, all of them assumed that the beams are Gaussian. In the following, a general formula of the

rigid-beam model is derived that can be apply to any case of unsymmetrical beam-beam interaction

with either Gaussian or non-Gaussian beams.

Let ρi (~r, θ) be the distribution of beam i in the normalized conﬁguration space where i = 1

or 2, ~r = (x, y) are the normalized coordinates of the transverse space, and θ the azimuthal angle

associated with the path length along the closed orbit. The beam centroid in the normalized space

can be calculated by ~Ri =

~rρi (~r, θ) d~r. Considering a linear lattice with one IP, the transverse

motion of the beam centroid can be described by

R

d2 ~Ri
dθ2 + Ωi ·

~Ri = (

1)i+1 λi ~F

−

2π

"

δ(θ

2πn)

.

−

#

n
X
2 diagonal matrix with (Ωi)11 = ν2

i,x and (Ωi)22 = ν2

i,y, where (νi,x, νi,y)

(A1)

In Eq. (A1), Ωi is a 2

×

are the fractional parts of the betatron tunes of the lattice for beam i. The main part of the

15

beam-beam kick in Eq. (A1) is

+∞

+∞

Z−∞

Z−∞

~F =

ρ1 (~r1, θ) ρ2 (~r2, θ) ~G

β1/2
1,x x1 −

2,x x2 , β1/2
β1/2

1,y y1 −

β1/2
2,y y2

d~r1d~r2

(A2)

(cid:16)

(cid:17)

where ~G(x, y) = ~r/r2 is the Green Function of the beam-beam interaction and (βi,x, βi,y) are

the horizontal and vertical beta-function of beam i at the IP, respectively. The strength of the

beam-beam kick for the horizontal component of Eq. (A1) is

λi = λi,x =

aiNj
πγi

νi,xβ1/2
i,x

where i =1 or 2, j =1 or 2, but i

= j; Nj is the number of particles per bunch of beam j; ai the

classical radius of the particle in beam i; and γi the Lorentz factor of beam i. With the deﬁnition

of the beam-beam parameters in Eq. (1), this kick strength can be written as

λi,x =

σj,x(σj,x + σj,y)

(A3)

2νi,x ξi,x
β1/2
i,x

where (ξi,x, ξi,y) and (σi,x, σi,y) are the beam-beam parameters and the rms beam sizes at the IP

of beam i. For the vertical component of Eq. (A1), λi = λi,y can be easily obtained by exchanging

x and y in Eq. (A3).

In the rigid-beam model of the coherent beam-beam oscillation, the shapes of the particle

distributions in phase space are assumed to not change with time during the beam oscillation while

the centers of the distributions oscillate with the beams’ coherent tunes. The distribution during

the beam oscillation is thus assumed to be ρi(~r, θ) = ρ0i(~r

~Ri), where ρ0i(~r) is the equilibrium

−

distribution when the beam is centered at the closed orbit. In general, ~F in Eq. (A2) is a function

of moments of phase-space variables and the time-dependence of ~F is implicitly through all the

moments. (To have a better picture of this, one may consider a moment expansion of beam particle

distributions in phase space). With the rigid-beam approximation, ~F depends on the lowest-order

moments ~R1 and ~R2 only,

+∞

+∞

~F =

ρ01

~r1 −
(cid:16)

~R1

ρ02

(cid:17)

~r2 −
(cid:16)

~R2

~G

(cid:17)

β1/2
1,x x1 −
(cid:16)

Z−∞

Z−∞

2,x x2 , β1/2
β1/2

1,y y1 −

β1/2
2,y y2

d~r1d~r2

(A4)

(cid:17)

16

6
Note that the rigid-beam model may fail in cases where the variation of the distributions is im-

portant during the beam coherent oscillation. To ﬁnd the oscillation frequencies of ~Ri, one can

average the beam-beam kick in Eq. (A1) over one turn (2π in longitudinal direction) and expand

~F into a Taylor series of ~Ri. Keeping only the linear terms of ~Ri, Eq. (A1) becomes a coupled

four-dimensional harmonic oscillator,

d2 ~Ri
dθ2 + Ωi ·

~Ri = (

1)i+1λi

−

A1 ·

~R1 + A2 ·

~R2

(cid:16)

(cid:17)

where i = 1 or 2, and Ai are 2

2 matrices with

×

∂ ~F
∂ ~Ri (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
If both the beams are mirror symmetric with respect to the horizontal and vertical plane, Ai

~R1=0, ~R2=0

Ai =

(A6)

.

are diagonal matrices and the horizontal and vertical coherent oscillation are decoupled. The two

eigenfrequencies for the coherent oscillation in the horizontal plane can then be solved as

ν± =

1
√2 r

1 + ω2
ω2

2 ±

ω2

1 −

ω2
2

q
(cid:0)

2 + 16ν1,xν2,xδω1δω2
(cid:1)

where

for i = 1 or 2. If δωi << νi,x and in Eq. (A7)

i = ν2
ω2

i,x −

2νi,xδωi

δωi = λi,x (Ai)11 / (2νi,x)

(ω2

1 −

2)2 >> 16ν1,xν2,xδω1δω2
ω2

(A5)

(A7)

(A8)

(A9)

then the coherent frequencies of the two beam are

ν+ = ω1 = ν1,x −
ν− = ω2 = ν2,x −
where ν+ and ν− are the horizontal coherent tunes of beam 1 and beam 2, respectively. Note that

(A10)




δω2

δω1



in the unsymmetrical case of beam-beam interactions, the two eigenfrequencies do not correspond

17

to the so called 0- (or σ-) and π-modes of symmetrical beam-beam interactions. The condition in

Eq. (A9) can be further simpliﬁed as

ν1,x −
|

ν2,x|

>>

δω1δω2 .

p

(A11)

Therefore, if the diﬀerence of the lattice tunes is much larger than the geometric average of the

coherent beam-beam tune shifts of the two beams, the coherent beam-beam tune shifts can simply

be calculated with Eq. (A10). Note that in the HERA experiment this condition was fulﬁlled. For

the case of strong-weak beam-beam interactions such as ξ1,x >> ξ2,x, one can expand ν± in terms

of λ2,x/λ1,x. Keeping only the dominant term in the coherent beam-beam tune shifts yields

δω1

ν+ = ν1,x −
ν− = ν2,x −

ν2
1,x
−ν2

2,x

2,x

−ν2
−2ν1,xδω1

ν2
1,x

δω2





(A12)

where ν+ and ν− are the coherent frequencies of the weak (beam 1) and strong (beam 2) beam,

respectively. In the ﬁrst equation of Eq. (A12), since the zeroth-order term (δω1) of λ2,x/λ1,x exists

and dominates the coherent beam-beam tune shift of beam 1, the ﬁrst- or higher-order terms were

neglected. In the second equation of Eq. (A12), on the other hand, the zeroth-order term is zero and

the ﬁrst-order term was thus kept. Note that if the lattice tunes of the two beams are very diﬀerent,

Eq. (A12) is equivalent to Eq. (A10). If the denominator in Eq. (A12), ν2

1,x −

ν2
2,x −

2ν1,xδω1, is

small, an analysis of the higher order terms shows that the expansion in terms of λ2,x/λ1,x is no

longer accurate and the coherent tunes have to be calculated by using Eq. (A7). The two coherent

frequencies in the vertical plane can be easily obtained by exchanging x and y and changing (Ai)11

with (Ai)22 in Eqs. (A7)-(A12). As shown in our study (see Section IV), this approach of the

rigid-beam model is quite good in the case of unsymmetrical beam-beam interactions with a small

beam-beam parameter.

A.1. Gaussian Beams

In the case that ρ0i are Gaussian distributions, matrix Ai in Eq.

(A6) can be calculated

18

(A13)

(A14)

analytically with Eq. (A4) as

(Ai)11 =

β1/2
i,x
Σx(Σx + Σy)

where Σx =

1,x + σ2
σ2

2,x and Σy =

1,y + σ2
σ2

2,y. The matrix element of (Ai)22 can be simply

obtained by exchanging x and y in Eq. (A13). Substituting Eqs. (A2) and (A13) into Eq. (A8)

q

q

yields

δωi = ξi,x

(σj,x + σj,y)σj,x
(Σx + Σy)Σx

where i = 1 or 2; j = 1 or 2; but j

= i. When i = 1, Eq. (A14) gives the coherent beam-beam

tune shifts of the weak beam [beam 1 in Eq. (A12)] obtained previously by Hoﬀstaetter for the

strong-weak case of beam-beam interactions [14].

If (ν1,x, ν1,y) = (ν2,x, ν2,y) and (σ1,x, σ1,y) =

(σ2,x, σ2,y), Eq. (A7) is reduced to the formula obtained by Hirata [5]. If (ξ1,x, ξ1,y) = (ξ2,x, ξ2,y)

and (σ1,x, σ1,y) = (σ2,x, σ2,y), Eq. (A7) is reduced to the formula obtained by Hofmann [8].

A.2. Non-Gaussian Beams

For non-Gaussian beams, especially the distributions obtained from beam-beam simulations

such as that in Figs. 5 and 6, matrices Ai in Eq. (A6) cannot be obtained analytically but can be

calculated numerically by using Eq. (A4). The coherent frequencies can then be calculated with

Eq. (A7) or directly from Eq. (A5) if the horizontal and vertical motion are coupled.

APPENDIX B. COHERENT BEAM-BEAM TUNE SHIFT FROM LINEARIZED

VLASOV EQUATION

The use of the linearized Vlasov equation has been very successful for the coherent beam-

beam tune shift in the case that two beams have the same or very close lattice tunes [4].

In

order to ﬁnd the coherent beam-beam tune shift, one needs to identify the coherent frequencies

from the eigenfrequencies of the linearized Vlasov equation. The linearized Vlasov equation, in

principle, has inﬁnite numbers of eigenfrequencies associated with inﬁnite numbers of oscillation

modes. For real beams, the number of the eigenfrequencies of the beam oscillation in transverse

space is twice of the number of particles in a bunch. When two beams have the same lattice tunes,

19

6
the coherent frequencies can be easily identiﬁed since the eigenfrequencies that correspond to the

coherent frequencies are separated from the rest of the eigenfrequencies that form a continuous

band (many close eigenfrequencies lines) [4]. Although, it is not very clear mathematically why this

separation occurs. The situation becomes more complicated when two beams have very diﬀerent

lattice tunes.

In this case, all the eigenfrequencies are in one or two continuous bands and the

coherent frequencies cannot be identiﬁed by only solving the eigenfrequencies. In order to ﬁnd the

coherent frequencies in the HERA beam experiment, we will instead solve the initial-value problem

of the linearized Vlasov equation for the coherent beam oscillation.

Consider only the horizontal motion (very ﬂat beam) in a linear lattice with one IP. In terms

of action-angle variable, the Hamiltonian for the betatron motion of beam i (i = 1 or 2) can be

written as

beams, as

Hi(I, φ, θ) = Hi,0(I) + Ui(I, φ, θ)

2π

δ(θ

2πn)

(B1)

"

n
X

−

#

where Hi,0 = νi,xI is the Hamiltonian associated with the betatron motion in the linear lattice and

Ui is the potential energy for the beam-beam interaction that can be written, for one-dimensional

Ui(I, φ, θ) = Ui[fj] =

ξi,xσ2
j,x
βi,x

2

−

2π

∞

Z0

Z0

fj(I

′

′
, φ

, θ) ln

2βi,xI sin φ

′
2βj,xI ′ sin φ

′

′
dφ

dI

(B2)

(cid:16)q

−

q

(cid:17)

where i = 1 or 2, and j = 1 or 2, but i

= j. The action-angle variables are related to the normalized

variables by x = √2I sin φ and p = √2I cos φ. fi(I, φ, θ) is the particle distribution of beam i in

phase space and satisﬁes the Vlasov equation. For convenience, we also deﬁne a functional Ui[fj] in

Eq. (B2) for the potential integral. In Eq. (B2), ln(x

x′) is the Green function for the potential

−

of beam-beam interaction in one-dimensional space. If only the coherent beam-beam tune shifts

are interested, one can get rid of the periodic δ-function in the Hamiltonian in Eq. (B1) by average

the beam-beam force over one turn. The Vlasov equation for fi can then be written as

∂fi
∂θ

+ νi,x

∂fi
∂φ

=

Ui, fi}
{

(B3)

20

6
where

is the Poisson bracket. Assume that the beams have reached equilibrium distributions

{ }
fi,0 that satisfy

νi,x

∂fi,0
∂φ

=

Ui,0, fi,0}
{

where Ui,0(I, φ) = Ui[fj,0]. Consider that beam i experiences a small perturbation from its equi-

librium distribution ψi(I, φ, θ) = fi(I, φ, θ)

fi,0(I, φ). The linearized equation for ψi(I, φ, θ) can

−

be obtained by subtracting Eq.(B4) from Eq. (B3) and neglecting the term

Ui[ψj], ψi}

{

which is

higher-order in ψi as

where Vi(I, φ, θ) = Ui[ψj].

∂ψi
∂θ

+ νi,x

∂ψi
∂φ

=

Ui,0, ψi}
{

+

.
Vi, fi,0}
{

To solve Eq. (B5), one can convert it into a system of inﬁnite numbers of coupled ordinary

diﬀerential equations of modes by using Fourier transformation

ψi(I, φ, θ) =

dν

ψi,m(I, ν)ei(mφ−νθ)

(B6)

∞

∞

Z−∞

m=−∞
X

where ν is the oscillation frequency of the beams and m numbers modes. The m = 1 mode

corresponds to the coherent dipole oscillation. To further simplify the problem, one may use the

single-mode approximation in which only the mode with m = 1 is kept in the linearized Vlasov

equation [4]. It turns out that the use of single-mode approximation is not only a convenience but

also a necessity. Without the single-mode approximation, no eﬀective method is available for the

general solution of Eq. (B5), except for simpliﬁed models as in Ref.

[19]. Substituting Eq. (B6)

into Eq. (B5), multiplying e−iφ and integrating φ over 2π on the both sides of Eq. (B5), and only

ν ¯ψi(I, ν) = νi,x ¯ψi(I, ν) + Qi(I) ¯ψi(I, ν) +

Gi(I, I

′

) ¯ψj(I

′

′

, ν)dI

(B7)

keeping the m = 1 mode yields

where ¯ψi(I, ν) = ψi,1(I, ν),

∞

Z0

Qi(I) =

2π

1
2π

Z0

∂Ui,0
∂I

dφ

21

(B4)

(B5)

(B8)

and

′

Gi(I, I

) =

ξi,xσ2
j,x
2βi,xI
π

2π

Z0

p

p

e−iφ sin φ′

−

p

βi,xI sin φ

βj,xI ′ sin φ′

(cid:18)

2I cos φ

∂fi,0
∂I −

sin φ

∂fi,0
∂φ

(cid:19)

′
dφ

dφ

(B9)

If the equilibrium distributions are independent of φ such as for Gaussian beams, the imaginary term

of Gi(I, I ′) is zero. Otherwise, this imaginary term contributes a damping to the linearized Vlasov

equation when ¯ψi is stable or an excitation when ¯ψi is unstable. If the equilibrium distributions

fi,0 are Gaussian, with a similar algebraic treatment in Ref.

[4], the integrals in Eqs. (B8) and

(B9) can be calculated analytically as

Gi

′

I, I

= ξi,x rij e

−(zi+z′

j)/2

(cid:1)
where i = 1 or 2; j = 1 or 2; but i

(cid:0)

= j. zi = βi,xI/σ2

Qi(I) =

ξi,xσ2
j,x
βi,xI

−

1

−

(cid:16)

−βi,xI/σ2
e

j,x

1
2

min

(cid:17)
zi, rijz′
j
(cid:17)
(cid:16)
zi, rijz′
max
j
(cid:17)
j = βj,xI ′/σ2
j,x, and rij = σ2





(cid:16)




i,x, z′

j,x/σ2

i,x.

(B10)

(B11)

B.1. Eigenfrequencies and Eigenvectors of Linearized Vlasov Equation

To further proceed with Eq. (B7), one may discretize the action space (I) into a mesh and

solve the equation on the grids [3, 4]. Let I = l∆I where ∆I is the grid size; l = 0, 1, 2, ...

lp;

and lp∆I is the size of the mesh. Since the distributions decay to zero quickly as I increases, a

mesh that covers several σi,x is good enough for a calculation of the coherent frequency. In order

to have an accurate frequency for the lattice tune in the eigenfrequencies of Eq. (B7), however, the

mesh has to be large enough so that the incoherent beam-beam tune shift at I = lp∆I is negligible.

In this study, we therefore used lp∆I = 160 ǫi,x and ∆I = 0.05 ǫi,x, where ǫi,x is the normalized

emittance of beam i. Let ¯ψi(l∆I, ν) = ¯ψil(ν). Eq. (B7) can then be converted into a system of

linear algebraic equations on the mesh,

ν ¯ψil = νi,x ¯ψil + Qi (l∆I) ¯ψil + ∆I

Gi (l∆I, k∆I) ¯ψjk .

(B12)

that leads to an eigenvalue problem

(B13)

lp

Xk=0

M~V = ν ~V

22

6
(B14)

(B15)

(B16)

where

~V =

¯ψ10, ¯ψ11,
(cid:16)

· · ·

, ¯ψ1lp, ¯ψ20, ¯ψ21,

, ¯ψ2lp

T

.

· · ·

(cid:17)

M is a 2(lp + 1)

2(lp + 1) matrix

×

M1 O1

O2 M2







M = 





×

where M1, M2, O1, and O2 are (lp+1)

(lp+1) matrices. Because of the single-mode approximation,

M1 and M2 are diagonal matrices with the diagonal elements

and the elements of Oi are

(Mi)kk = νi,x −

Qi ((k

1)∆I)

−

(Oi)kl = Gi ((k

1)∆I, (l

1)∆I)

−

−

where k = 1, ..., (lp + 1); l = 1, ..., (lp + 1); and i = 1 or 2. If the equilibrium distributions are

Gaussian, all these matrix elements in Eqs. (B15) and (B16) can be calculated analytically by

using Eqs. (B10) and (B11). In the case of the HERA experiment, the equilibrium distribution of

the p beam is still very close to a Gaussian but the e+ beam is no longer a Gaussian beam (see

Figs. 5 and 6). Let beam 1 and 2 be the e+ and p beam, respectively. M1 and O2 can then be

obtained analytically. The matrix elements of M2 and O1, on the other hand, have to be calculated

numerically by using Eqs. (B8) and (B9) with the quasi-equilibrium distribution of the e+ beam

obtained from the beam simulation.

With the eigenvalue equation in Eq. (B13), the eigenfrequencies and a set of orthogonal eigen-

vectors for the linearized Vlasov equation can be found numerically. If the two beams have the

same lattice tune, the eigenfrequencies of Eq. (B13) are identical to that obtained in Ref.

[4].

Fig. 8a is an example of eigenfrequencies of Eq. (B13) for the case of ν1,x = ν2,x and ξ1,x = ξ2,x.

It shows that in the symmetrical case of beam-beam interactions the coherent frequency (the ﬁrst

frequency line from the left of Fig. 8a) is separated from the rest of the eigenfrequencies that form a

continuous band. The width of the band equals the incoherent beam-beam tune shift. The coherent

23

frequency can therefore be easily identiﬁed in this case. Note that the coherent beam-beam tune

shift calculated from this coherent frequency is the same as that in Ref. [4]. The situation is more

complicated when the two beams have very diﬀerent lattice tunes. Fig. 8b plots the eigenfrequen-

cies for the case of the HERA experiment. In this case, the eigenfrequencies are divided into two

groups, one for each beam. For the e+ beam, the eigenfrequencies form a continuous band that

starts at the lattice tune of the e+ beam and has a width of the incoherent beam-beam tune shift

of the e+ beam. Because there were two IPs in the HERA experiment, the incoherent beam-beam

tune shift in Fig. 8b is 2ξe,x = 0.082 for the e+ beam. The characteristics of the eigenfrequencies for

the p beam, in principle, is similar to that of the e+ beam. Since the beam-beam parameter of the

proton beam is very small (ξ2,x = ξp,x ∼
into a single line (the ﬁrst line from the left of Fig. 8b) that corresponds to the lattice tune of

10−4), all the eigenfrequencies for the p beam degenerate

the p beam. In the case of very unsymmetrical beam-beam interactions, therefore, the coherent

frequencies cannot be simply identiﬁed from the eigenfrequencies of the linearized Vlasov equation.

It should be noted that because of a very small beam-beam parameter of the p beam, during

the HERA experiment no coherent beam-beam tune shift was observed on the proton beam. The

matrix elements of O2 are very small as compared with the diagonal elements of M1 and M2.

O2 can therefore be approximated as a zero matrix and the eigenfrequencies for the e+ beam can

be easily obtained from M1 ~V1 = ν ~V1, where ~V1 =

¯ψ10, ¯ψ11,

is the sub vector space

, ¯ψ1lp

· · ·

T

(cid:17)

(cid:16)

associated with the e+ beam. Since M1 is diagonalized, solving the eigenfrequencies and a set of

orthogonal eigenvectors of M1 is trivial. The eigenfrequencies and eigenvectors obtained from M1

were found to be the same as that of Eq. (B13) in the sub vector space associated with the e+

beam in this case.

B.2. Initial-Value Problem for Coherent Frequencies

Let

ν1,
(cid:16)

· · ·

, νlp+1, νlp+2,

, ν2lp+2

and

· · ·

· · ·

~V (1),

, ~V (lp+1), ~V (lp+2),

, ~V (2lp+2)

be the

· · ·

(cid:16)
eigenfrequencies and eigenvectors of the discretized and linearized Vlasov equation where M~V (n) =

(cid:17)

(cid:17)

νn ~V (n).

In the HERA experiment, the lattice tunes of the two beams are very diﬀerent and,

24

therefore, the two eigenfrequency bands of Eq. (B13) are well separated (see Fig. 8b). In this case,

are the eigenfrequencies for the e+ beam when n = 1, ..., lp + 1 and the eigenfrequencies for

νn}
{
the p beam when n = lp + 2, ..., 2lp + 2. In the discretized action space, the perturbation of the

beam distribution ψ1(I, φ, θ) and ψ2(I, φ, θ) can be represented as a vector,

~ψ(θ) = ( ψ1(0, φ, θ), ψ1(∆I, φ, θ),

, ψ1(lp∆I, φ, θ), ψ2(0, φ, θ),

, ψ2(lp∆I, φ, θ) )T .

· · ·

· · ·

With the single-mode approximation, the general solution of ψ1(I, φ, θ) and ψ2(I, φ, θ) can then be

obtained from a superposition of the eigenvectors of the linearized Vlasov equation,

~ψ(θ) =

Ck ~V (k)ei(φ−νkθ)

2lp+2

Xk=1

(B17)

are constants and can be determined with an initial condition, ψ1(I, φ, 0) and ψ2(I, φ, 0).

2 is the oscillation amplitude of the beam distributions with the frequency of νk, the

2 v.s. νk corresponds to the frequency spectrum of the coherent oscillation. The

2-νk diagram, therefore, provides the coherent tunes when ψ1(I, φ, 0)

0 and

→

Consider a small kick that kicks beam 1 away from its equilibrium distribution f1,0(I, φ), where

f1,0(I, φ) is known numerically from the beam-beam simulation. The initial perturbation of the

where

Ck}
{
Ck|
|
diagram of

Since

Ck|
|
two peaks in the

ψ2(I, φ, 0)

0.

→

Ck|
|

beam distribution is

ψ1(I, φ, 0) = f1,0(x + x0, px)

f1,0(x, px) =

gm(I)eimφ

(B18)

−

m
X

and ψ2(I, φ, 0) = 0 where x0 is the initial kick. With the single-mode approximation, ψ1(I, φ, 0)

≃
g1(I)eiφ and ~ψ(0) = ~g eiφ where ~g = ( g1(0), g1(∆I) , ..., g1(lp∆I), 0 , ..., 0 )T . Note that the

second half of the vector are all zero because beam 2 is not kicked. On the other hand, from Eq.

(B17)

~ψ(0) =

2lp+2



Xk=1

Ck ~Vk

eiφ =

V ~C

eiφ

(cid:16)

(cid:17)

(B19)

where V is a (2lp +2)

The coeﬃcients


(2lp +2) matrix of which the ith column is ~Vi and ~C =



C1, C2, ..., C2lp+2

T

.

×
can then be calculated from ~C = V−1~g. It should be noted that the initial
Ck}
{

(cid:17)

(cid:16)

25

kick on the beam distributions in Eq. (B18) can be in any direction in phase space since the coherent

frequency is the frequency of an inﬁnitesimal oscillation. For near-integrable systems considered

in this study, the phase-space region in the vicinity of the origin is integrable and only consists of

invariant circles (tori). It is therefore isotropic. The coherent frequencies calculated were indeed

found to be independent of the direction of the initial kick.

Figure 8 plots the calculated

2-νk diagrams for the symmetrical case of beam-beam inter-

Ck|
|

actions where ν1,x = ν2,x and ξ1,x = ξ2,x (Fig. 9a) and for the HERA experiment (Fig. 9b). In

Fig. 9a, the peak with an arrow is the calculated coherent frequency that is the same as that in

Fig. 8a. In Fig. 9b, the main peak indicates the calculated coherent frequency of the e+ beam

in the HERA experiment. The small peak in the lower right corner is the coherent frequency of

the p beam. Figure 10 plots the calculated coherent beam-beam tune shift of the e+ beam as

a function of initial kick x0 for the case of the HERA experiment. It shows that the calculated

coherent beam-beam tune shift increases with the decrease of x0 and converges as x0 approaches

zero. This amplitude dependence of the coherent frequency is consistent with the beam simulation.

Since the coherent frequency is the frequency of an inﬁnitesimal oscillation, the convergence of the

calculated coherent frequency at x0 →
study (see Section IV), the linearized Vlasov equation with single-mode approximation is a valid

0 provides the wanted coherent frequency. As shown in our

approach for the coherent beam oscillation with symmetrical beam-beam interactions but not with

unsymmetrical beam-beam interactions.

ACKNOWLEDGMENTS

This work is supported by the US Department of Energy under Grant No. DE-FG02-04ER41288.

The authors would like to thank the Center for Advanced Scientiﬁc Computing at the University

of Kansas for the use of the Supercomputer. The authors thank F. Willeke for many stimulating

discussions. J. Shi would also like to thank DESY for the ﬁnancial support for a trip to DESY at

an early stage of our collaboration.

26

References

[1] A.W. Chao and R.D. Ruth, Part. Accel. 16, 201 (1985).

[2] J. Shi and D. Yao, Phy. Rev. E62, 1258 (2000).

[3] R.E. Meller and R.H. Siemann, IEEE Trans, NS-28, 2431 (1981).

references herein.

[5] K. Hirata, Nucl. Instr. Meth. 269, 7 (1988).

[6] H. Koiso, et al., Part. Accel. 27, 83 (1990).

[7] E. Keil, CERN Report, CERN-LEP-NOTE-294, (1981).

[4] K. Yokoya and H. Koiso, Part. Accel. 27, 181 (1990), KEK Report 89-14 (1989), and the

[8] A. Hofmann, in PROC. OF THE WORKSHOP ON BEAM-BEAM EFFECTS IN LARGE

HADRON COLLIDERS, edited by J. Poole and F. Zimmermann, CERN-SL-99-039 AP, (1999),

p. 56.

[9] A. Piwinki, IEEE Trans. NS-26, 4268 (1979).

[10] R. Talman, CLNS-84/610, (1984).

[11] Y. Alexahin, Part. Accel. 59, 43 (1998).

[12] M. Vogt, T. Sen, and J.A. Ellison, Phys. Rev. ST Accel. Beams 5, 024401 (2002).

[13] M.P. Zorano and F. Zimmermann, Phys. Rev. ST Accel. Beams 3, 044401 (2000).

[14] G.H. Hoﬀstaetter in HERA Accelerator Studies 1999, edited by G.H. Hoﬀstaetter, DESY

HERA 00-02. (2000). p. 6.

[15] L. Jin and J. Shi, Phy. Rev. E69, 036503 (2004).

27

[16] G.H. Hoﬀstaetter in HERA Accelerator Studies 2000, edited by G.H. Hoﬀstaetter, DESY

HERA 00-07. (2000). p. 5.

[17] M. Sands, Stanford Linear Accelerator Center Report No. SLAC-121 (1970).

[18] K. Hirata and F. Ruggiero, LEP Note 611, (1988).

[19] B. S. Schmekel, G. H. Hoﬀstaetter, and J. T. Rogers, Phys. Rev. STAB6, 104403 (2003).

28

Table I. Some beam parameters used in HERA 2000 beam experiment. The horizontal size of the

e+ beam at the IPs is σe,x = 283 µm. The horizontal and vertical size of the p beam at the IPs are

σp,x=164 µm and σe,y=39.9 µm, respectively.

βe,y (m)

Ie+ (mA) σe,y(µm)

ξe,x/ξe,y

ξp,x/ξp,y (10−4)

1.0

1.5

2.0

3.0

4.0

19

18

17

3.5

2.6

35.8

43.8

50.6

62.0

72.0

0.041/0.068

2.54/1.40

0.041/0.102

2.35/1.06

0.041/0.136

2.18/0.85

0.041/0.204

0.43/0.14

0.041/0.272

0.31/0.09

Table II. The coherent beam-beam tune shifts of the e+ beam at βe,y = 4.0 m (ξe,y = 0.272).

“Experiment” and “Simulation” are the coherent tunes measured in the experiment and calculated

in the beam simulation, respectively. “Rigid-Real” and “Rigid-Gaussian” are the coherent tunes

calculated by using the rigid-beam model with a Gaussian distribution and with the distribution

from the simulation, respectively. “Vlasov Eq.” is the coherent tunes calculated with the linearized

Vlasov equation.

βe,y = 4.0 m

νe,x

∆νe,x/(2ξe,x)

νe,y

∆νe,y/(2ξe,y)

Experiment

0.1600

Simulation

0.1605

Rigid-Real

0.1555

Rigid-Gauss

0.1531

Vlasov Eq.

0.1123

0.69

0.2330

0.2331

0.2194

0.2040

0.024

0.024

0.049

0.077

0.110

0.104

0.164

0.194

29

Table III. The same as Table II, but for βe,y = 1.0 m (ξe,y = 0.068).

βe,y = 1.0 m

νe,x

∆νe,x/(2ξe,x)

νe,y

∆νe,y/(2ξe,y)

Simulation

0.1600

Rigid-Real

0.1517

Rigid-Gauss

0.1475

Vlasov Eq.

0.121

0.110

0.212

0.263

0.58

0.2172

0.2074

0.1996

0.212

0.284

0.341

Table IV. The same as Table III, but with only one tenth of the p-bunch current used in the

experiment (ξe,y = 0.0068).

βe,y = 1.0 m

νe,x

∆νe,x/(2ξe,x)

νe,y

∆νe,y/(2ξe,y)

Simulation

0.1672

0.224

0.2414

0.337

Rigid-Real

0.1668

Rigid-Gauss

0.1668

Vlasov Eq.

0.165

0.263

0.268

0.53

0.2406

0.2406

0.396

0.399

30

FIGURE CAPTIONS

Figure 1. Emittance of the e+ beam as a function of ξe,y. ǫ0 is the emittance without collision.

Discrete points are from the experiment and continuous curves from the beam simulation. Circles

and curve a is the vertical emittance. Crosses and curve b are the horizontal emittance. The two

experimental data points at each ξe,y where the measurement was performed correspond to the

measurements at H1 and ZEUS.

Figure 2. The speciﬁc luminosity as a function of ξe,y. Circles are from the experiment and

continuous curves from the beam simulation. The two experimental data points at each ξe,y where

the measurement was performed correspond to the measurements at H1 and ZEUS. Crosses are the

luminosity calculated with the measured emittance in Fig. 1 assuming Gaussian beam distributions.

Figure 3. Evolution of the vertical emittance of the e+ beam calculated with the beam simulation

for the cases of HERA beam experiment at (a) βe,y = 1.0 m; (b) βe,y = 1.5 m; (c) βe,y = 2.0 m; (d)

βe,y = 3.0 m; and (e) βe,y = 4.0 m.

Figure 4. Power spectrum of the centroid motion of the e+ beam in (a) horizontal and (b)

vertical direction for the case of HERA beam experiment at ξe,y = 0.272 (βe,y = 4.0 m). The beam

centroid motion was calculated during the beam simulation. Note that in this case the incoherent

beam-beam tune shifts for the two IPs are 0.082 and 0.544 in the horizontal and vertical plane,

Figure 5. The projection of the particle distribution of the e+ beam in the vertical direction

obtained by the beam simulation for the case of HERA beam experiment at ξe,y = 0.272 (βe,y = 4.0

m).

(a) The initial Gaussian distribution, (b) the distribution at the 5000th turn, and (c) the

Gaussian distribution of which the standard deviation is the same as that of the beam distribution

respectively.

in (b).

Figure 6. The angle dependence of the particle distribution of the e+ beam obtained by the

beam simulation for the case of HERA beam experiment at ξe,y = 0.272 (βe,y = 4.0 m). (a) The

initial Gaussian distribution, (b) the φx-dependence and (c) the φy-dependence of the distribution

31

at the 5000th turn.

Figure 7. The ratio of the coherent and incoherent beam-beam tune shift as a function of the

beam-beam parameter of the e+ beam in the vertical plane calculated from (a) the beam-beam

simulation and (b) the rigid-beam model with the Gaussian distribution.

Figure 8. Eigenfrequencies of Eq. (B13) for the case of (a) ν1,x = ν2,x, ξ1,x = ξ2,x and (b) the

HERA beam experiment. In (a), the dashed line marks the lattice tune that corresponds to the

0-mode. The single isolated line on the left is the coherent frequency that corresponds to a ratio

of the coherent and incoherent beam-beam tune shift of 1.35. In (b), the dashed lines mark the

lattice tunes of the e+ beam (the left line) and p beam (the right line), respectively. The single

isolated line on the right is the degenerated eigenfrequencies for the p beam and the band on the

left is for the e+ beam. The vertical axis has no physical meaning.

2 as a function of νk for the cases of Fig. 8. The arrows indicate the coherent

Figure 9.

Ck|
|

frequencies.

Figure 10. Calculated coherent beam-beam tune shift by using the linearized Vlasov equation

as a function of initial kick x0 on the distribution of the e+ beam [see Eq. (B15)] for the case of

the HERA experiment at βe,y = 1.0 m.

32

