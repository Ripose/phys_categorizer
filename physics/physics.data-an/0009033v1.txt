0
0
0
2

 

p
e
S
9

 

 
 
]
n
a
-
a
t
a
d

.
s
c
i
s
y
h
p
[
 
 

1
v
3
3
0
9
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Bayesian Blocks: Divide and Conquer,

MCMC, and Cell Coalescence

Approaches

Jeﬀrey D. Scargle

NASA-Ames Research Center
MS 245-3, Moﬀett Field, CA1

From the 19th International Workshop on Bayesian Inference and
Maximum Entropy Methods (MaxEnt ’99), August 2-6, 1999, Boise
State University, Boise, Idaho, USA. This conference proceedings
will be published (Josh Rychert, Editor).

Key Words: Poisson process, changepoint detection, time series, image process-
ing, Voronoi tessellation

Abstract. Identiﬁcation of local structure in intensive data – such as time series, im-
ages, and higher dimensional processes – is an important problem in astronomy. Since
the data are typically generated by an inhomogeneous Poisson process, an appropriate
model is one that partitions the data space into cells, each of which is described by a
homogeneous (constant event rate) Poisson process. It is key that the sizes and loca-
tions of the cells are determined by the data, and are not predeﬁned or even constrained
to be evenly spaced. For one-dimensional time series, the method amounts to Bayesian
changepoint detection. Three approaches to solving the multiple changepoint problem
are sketched, based on: (1) divide and conquer with single changepoints, (2) maximum
posterior for the number of changepoints, and (3) cell coalescence. The last method
starts from the Voronoi tessellation of the data, and thus should easily generalize to
spaces of higher dimension.

1) Email: jeﬀrey@sunshine.arc.nasa.gov

I

INTRODUCTION: THE DATA ANALYSIS

PROBLEM

Developments in detector technology for high energy astrophysics2 have led to
observation systems capable of reporting accurate arrival times for individual pho-
tons. These times, while not binned, are quantized in microsecond-scale units I like
to call “ticks” – since they are in fact generated by the ticking of the computer clock
on-board the spacecraft. In the approximation where the ticks are short compared
to time scales of interest, we very accurately have a Poisson process. Note that,
depending on the nature of the variability of the process, diﬀerent mathematical
models apply, as indicated in the table below.

Nature of
Variability

Mathematical
Model Process

Constant

Homogeneous Poisson

Deterministic

Inhomogeneous Poisson

Random

Doubly Stochastic Poisson
(Cox Process)

A number of mathematical references [20,36,1,2,40] describe the nature of spa-
tial Poisson processes. Time series are the 1D special case, consisting of streams of
numbers representing photon detection times. In this context, the Poisson distribu-
tion is so accurate that it is hardly an approximation. Statisticians seem to have a
hard time understanding this point. I believe the culprit is the fact that the Poisson
process is usually taught as the limit of a binomial process or the like. Technically,
our data do comprise a ﬁnite Bernoulli lattice [40], since typically more than one
event cannot be recorded at a given tick. (See [8] for an interesting discussion of a
lattice theory of quantum ﬁelds.) But the rates in units of events3 per tick are so

2) The term high energy astrophysics is used loosely for both the study of astronomical objects
which produce and emit large amounts of energy, and for observations of radiation consisting of
high-energy photons, e.g. X-rays and gamma-rays. Often the two meanings coincide.
3) We use the term event for photon detections, or other data points.

2

low that the probability of such multiple events is very low.

In practice, the most signiﬁcant imperfection is a departure, not from the as-
sumed distribution, but from the assumption of independence of the process at
diﬀerent times. Photon detectors always have a ﬁnite dead time – an interval after
the detection of one event during which another photon cannot be recorded, either
because the detector mechanism itself is temporarily paralyzed, or the data system
is too busy processing the event. This yields interdependences in the detection of
photons close together in time.

The discrete nature of photon counting data is most often considered a challenge.
Many analysts ﬁrst bin their data and then apply standard methods. Further,
the notion is rife that not only are bins necessary, but that they must be large
and contain enough events to produce a “statistically signiﬁcant sample.” This is
wrong and wasteful. Analysis can be carried out directly on the event data. It is
my belief that the discreteness and utter simplicity of the fundamental event – a
photon was detected or it wasn’t – are a big advantage. This simplicity and the
fact that the observational errors accurately follow a distribution with essentially
no free parameters4 mean that the posterior marginalization can be carried out
exactly, at least for some of the nuisance parameters [see Eqs. (4) and 5].

Happily, the simplicity of the basic events allows almost immediate generalization
of one-dimensional results to data spaces of higher dimension. Simple examples are
cases where the photons, in addition to being timed, are also tagged with spectral
and spatial information – i.e. energies of photons and their location on the sky.
Processes that sample the density of events in spaces of various dimension (denoted
D) include:

• time series (D = 1)

• other sequential data (D = 1; e.g., genetic sequences)

• images (D = 2)

• time sequences of images (D = 3)

• time sequences of spectra (D = 2)

• points in parameter spaces (any D)

The corresponding data types have in common that they comprise sets of points in
some well deﬁned space. Since the underlying process deﬁnes the intensity of some
physical quantity over the space, we call these intensive data. The actual data
can consist of a list of points, or the number of points in pre-selected bins (e.g.
image pixels), or other data modes. A problem of broad interest is the detection
of local5 structures in such data. Pulses, or other time-domain structures in time

4) The Poisson rate parameter is pretty closely nailed at the local event rate.
5) I use the term local to distinguish features of limited extent from global features, such as
periodic signals extending over the whole of the data space.

3

series data, features in images and clusters in parameter spaces of various dimension
(classiﬁcation) are examples.

For one-dimensional time series, the method of Bayesian Blocks approximates the
signal as a piecewise constant Poisson process [35]. Generalizing this representation
to a space, denoted S, of arbitrary dimension, the basic problem can be phrased
as the following relatively straightforward Bayesian Maximum a posteriori (MAP)
problem:

Consider all partitions of S into subvolumes, or cells.

Model the event rate within each cell as a homogeneous Poisson

Process.

Among all such partitioned models, which is the most likely?

We determine the parameters in order of how fundamental they are to the nature
of the model. The piecewise constant Poisson nature of the model is assumed, so
the most fundamental parameter is Ncp, the number of changepoints. This is deter-
mined by marginalizing all of the other parameters – the locations of the change-
points and the Poisson rates between them. Then the locations of the changepoints
are determined. Finally, the block event rates are determined; trivially, the MAP
value is just the ratio of N, the number of events in the cell, to V , its volume.

The resulting evidence in favor of this model for a single cell, called the marginal
likelihood, and deﬁned below in Eq. (4), is a simple function of V and N [below,
Eqs. (4) and (5), and also see [35]]. For binned data and other data modes, and for
other distributions than the Poisson one assumed here, the likelihood is similarly an
explicit function of the same two parameters. We assume the cells are independent,
so the total likelihood is the product of the likelihoods of the cells (see Section III).

II EXACT BAYES FACTORS

For the multiple changepoint problem we need to evaluate the posterior proba-
bility for piecewise constant models, given the data. An important simpliﬁcation is
that the marginal likelihoods and posterior probabilities for such models factor into
the product of the same quantities for each independent segment of the model. We
refer to these segments as blocks in 1D contexts, and as cells in higher dimensions.
This section gives the computation of the posterior for a single cell, which can then
be used in various ways – such as the evaluation of Bayes factors for comparison of
two or more models. The general form of Bayes factor comparing two models M1
and M2, given data D {c.f. [15], eq. (6.4)} is:

Bayes factor(M2; M1) =

p(D|M2)
p(D|M1)
4

= R p(λ2|M2)p(D|λ2, M2)dλ2
R p(λ1|M1)p(D|λ1, M1)dλ1

(1)

where p(λ|M) is the prior on λ and p(D|λ, M) is the likelihood. Given the discussion
above, it is easy to compute the appropriate factor for a Poisson model with rate
parameter λ (units: events per unit volume) for a set of events in some block or cell.
The Poisson Likelihood, obtained by multiplying likelihoods for individual sample
bins, is

L(N|λ, V ) = e−V λλN

(2)

The usual Poisson factorial does not appear because the number of counts in a tick
is 0 or 1. Marginalizing λ using the conjugate Poisson prior ( [15]; Section 2.7, p.
49-50)

p(λ) =

βα
Γ(α)

e−βλλα−1 ,

(3)

the contribution to the Bayes factor for a cell – often called the marginal likelihood
– is

P (M|D) = Z ∞

0

p(λ)L(N|λ, V )dλ =

βα
Γ(α)

Γ(N + α)
(V + β)N +α

.

(4)

Based on a prior assigning a uniform distribution to the probability of occurrence
of a single event, the marginal likelihood

P (M|D) =

Γ(N + 1)Γ(V − N + 1)

Γ(V + 2)

,

(5)

was derived in [35]. A function of the same two suﬃcient statistics, N and V , it
behaves similarly to the marginal likelihood in Eq. (4), but was found less accurate
in simulation studies such as the one discussed below.

III THREE APPROACHES TO THE MULTIPLE

CHANGEPOINT PROBLEM

We now have to evaluate the above marginal likelihood for each segment of a
piecewise homogeneous Poisson model consisting of successive, independent6 blocks
of data, and cobble the results together. The next section describes three ways to
do this. The ﬁrst two seem eﬀective in 1D, but have problematical extensions to
higher dimensions. The third was inspired by its simplicity in 2D and 3D. All
three methods are demonstrated on the same synthetic 1D data.

A An Iterative Approach: Top Down

6) That is, due to a fundamental property of the Poisson distribution, random variables corre-
sponding to counts in successive blocks (or diﬀerent cells in general) are independent. This fact
should not be confused with independence of the actual Poisson rates, which in general does not
hold.

5

As detailed in [35], the formulas above allow easy computation of the Bayes
factor comparing (1) the two-block model in which the interval is segmented into
two parts at a changepoint, with (2) a single Poisson model for the whole interval.
The decision whether to keep an interval unsegmented or to divide it into two
subintervals is based on comparison of the corresponding marginal likelihoods. Let
Φ(N, V ) stand for the marginal likelihood corresponding to a Poisson model for a
volume of size V containing N events, such as one of the two functions given above.
Then an interval should be broken in two if

Φ(Ni, Vi)Φ(Ni+1, Vi+1) − Φ(N, V ) > 0 ,

(6)

where the putative changepoint divides the interval of size V into two parts, of
size Vi and Vi+1 = V = Vi, containing Ni and Ni+1 = N − Ni events, respectively.
This criterion is easily computed as a function of the location of the changepoint.
The interval is then segmented at the point that maximizes the expression in Eq.
(6). This divide and conquer scheme is applied ﬁrst to the whole data interval, and
then iteratively to any subintervals found at the previous step. When this criterion
favors segmentation of no further intervals, computation halts.

Figure 1 shows the results for synthetic data generated by a piecewise constant
Poisson process, between eleven known changepoints. I used a modiﬁed form of the
Blocks function popularized by David Donoho, Iain Johnstone, and the WaveLab
project [3] as a sample function with many discontinuities that can be detected
using wavelet methods (see Fig. 1 in [27]). The original function has blocks of
negative amplitude, which will not do as Poisson rates. Hence I added a constant,
3 1
2, to the classic Blocks function, and then generated points obeying the Poisson
distribution.

The three panels show three divide and conquer iterations. It can be seen that
the various changepoint locations are found rather accurately, allbeit with the single
changepoint algorithm. In the early steps the posterior has multiple peaks at the
various changepoints, but only the highest one is used at each step. There is
a tendency for changepoints determined early in the process to be less accurate.
These errors are not corrected as the iteration proceeds, but the algorithm could
be modiﬁed to do so.

B Maximum Posterior for Ncp via MCMC

It is clear that the above method is not rigorous, in that it does not solve for
all of the changepoints simultaneously. It is relatively straightforward, however, to
remedy this with a more rigorous, but also more computationally intensive scheme.
If there are multiple changepoints, say Ncp in number, the full posterior is just the
product of the posteriors of all the subintervals. The marginalization of all the
locations of the changepoints requires evaluating the Ncp-dimensional integral7 of
the posterior over all values of the changepoint locations.

7) In practice, this is a ﬁnite sum, e.g. over a bin index or an event index.

6

Results obtained in this way, using a simple Markov Chain Monte Carlo (MCMC)
method, are surprisingly good. Figure 2 shows the block representation of the same
data as in Figure 1, obtained from a simple MCMC evaluation of the marginal
likelihood as a function of the number of changepoints. The maximum posterior
was at 16 changepoints (17 blocks), compared to the correct value of 11. The
“extra” blocks are narrow, and while they do not look pretty, they will not much
aﬀect derived quantities (such as pulse widths, rise times, etc).

The good performance with only a few iterations may be due to a combination

of several factors:

• the well behaved nature of the data

◦ low dynamic range of the signal

◦ well behaved backgrounds

◦ exact Poisson statistics for the observational uncertainties

• a simple, exact Likelihood; only one parameter

• the fact that the posterior does not have to be computed accurately to distin-

guish one value of Ncp from another

• the useful characteristics of the ﬁnal model are not that sensitive to Ncp

Nevertheless, when the number of changepoints and the number of data points are
large, the computation is quite long. Since there is little global communication,
in the sense that the location of a change point in one part of the observation
interval aﬀects that of one elsewhere, breaking the data up into smaller intervals is
an eﬀective way to speed up the overall computation.

C Cell Coalescence (Bottom Up)

Based on preliminary tests, a new algorithm may be a signiﬁcant improvement
over either of the above approaches. It begins with a ﬁne-grained segmentation,
namely the Voronoi tessellation of the data points, and merges these many cells to
form fewer, larger ones. The outline of the algorithm is simple:

7

Bayesian Cell Coalescence

(0) Initial Segmentation: Voronoi Tessellation of the Events

(1) Compute Bayes Factor for Merging Each Pair of Adjacent Cells

(2) Identify Largest Bayes Factor (at i)

(3) If Largest Bayes Factor is < 1, HALT!

(4) Otherwise Merge Pair of Cells with Largest Bayes Factor:

• Ni ← Ni + Ni+1
• Vi ← Vi + Vi+1
• Delete Cell i + 1

(5) Go to 1

While there is no rigorous justiﬁcation for this procedure, one has the sense that
it should come reasonably close to obtaining the optimal solution. At each step in
the iteration the local event rate in a cell is N
V , the number of events in the cell
divided by its volume. The rate estimates for the initial cells, 1
V , are reasonable
estimates of the ﬁne-grain, local event rate if these cells are assigned roughly their
surrounding volume, extending approximately halfway to neighboring points. An
obvious choice for the initial partition is thus the Voronoi tessellation [40,19] of the
data points. The Voronoi cell for a data point consists of all the space closer to
that point than to any other data point.

The Voronoi tessellation of a set of points on an interval (1D) is trivial:

it
is simply the set of intervals spanned by pairs of midpoints between successive
data points. Many algorithms exist for computing Voronoi tessellations in higher
dimensions [21,13,32,11], allowing one to address problems such as cluster detection
in parameter spaces, and identiﬁcation of structures in images. Since the marginal
posteriors discussed above are valid for piecewise constant Poisson data in any
dimension, the methods demonstrated here for 1D should apply in general.

The decision whether to merge two cells or to halt, Step (3), is based on com-
parison of the Bayes factors. Using the same notation as above, in Eq. (6), cells i
and i + 1 are merged if

Φ(Ni + Ni+1, Vi + Vi+1) − Φ(Ni, Vi)Φ(Ni+1, Vi+1) > 0

(7)

and kept separate otherwise. When this criterion favors the merging of no further
cells, computation halts.

8

Figure 3 demonstrates the application of this algorithm to the same synthetic
data as in the previous two examples. The top panel depicts the state part way
into the iterations, but is not far from the initial Voronoi tessellation, one Voronoi
cell for each data point. Successive panels show the evolution of the representation
as the cells merge into fewer, larger ones. In the last panel, the halting criterion
mentioned above has just terminated the iteration. It can be seen that most of the
changepoints are accurately detected. Several though are missed.

IV RELATED WORK

It is well known that Bayesian methods are well-suited to ﬁnding changepoints
(e.g. [30,34]; see also Appendix C of [16]). In [42] methods similar to those de-
scribed here are used to ﬁnd changepoints in binned data, to an accuracy better
than the bin size. A number of recent publication are relevant to this problem
[37,17,18,42,6,34,38,39,31,7] and [22–29]. More recently, Raftery and colleagues
have developed similar methods, mainly for 2D problems. In [5] the Voronoi sites
are ﬁducial markers for the cells, not the tessellation deﬁned by the individual data
points. Other approaches are described in [14,4,10,41,33]. Bayesian methods are
also useful for segmentation of autoregressive models, with applications to speech
processing [9].

After this article was completed, I became aware that NASA’s Chandra X-ray
Observatory, is using an unbinned source detection technique much like cell coales-
cence, and starting from the same Voronoi tessellation [12]. Source cells are merged
with a percolation process based on a sample estimate of the density distribution.

V ACKNOWLEDGEMENTS

I am greatful to Alanna Connors, Seth Digel, Tom Loredo, and Jay Norris for
helpful comments and encouragement. This work is partly funded by the NASA
Applied Information Systems Research Program.

REFERENCES

1. Andersen, P. K., Borgan, O., Gill, R. D., and Keiding, N. (1993), Statistical Models
Based on Counting Processes, Springer Series in Statistics, Springer-Verlag: New
York

2. Barndorﬀ-Nielsen, O. E., Kendall, W. S., and van Lieshout, M. N. M. (1999),
Stochastic Geometry: Likelihood and Computation, Chapman & Hall/CRC: Boca
Raton

3. Buckheit, J. B. and Donoho, D. L. (1995), Wavelab and Reproducible Research, in

Wavelets and Statistics, pp. 53-81, Springer-Verlag: Berlin.
http://stat.Stanford.EDU:80/~wavelab/

9

4. Byers, S. D., and Raftery, A. E. (1998) “Nearest Neighbor Clutter Removal for
Estimating Features in Spatial Point Processes,” J. American Statistical Association,
June 1998. Also (1996) Technical Report No. 305, Dept. of Statistics, University of
Washington.

5. Byers, S. D., and Raftery, A. E. (1997) “Bayesian Estimation and Segmentation of
Spatial Point Processes using Voronoi Tilings,” Technical Report No. 326, Dept. of
Statistics, University of Washington.

6. Carlin, B. P. Galfand, A. E. and Smith A. F. M. (1992) “Hierarchical Bayesian

analysis of changepoint problems,” Applied Statistics, 41, pp. 389-408.

7. Chib, S. (1998) “Estimation and Comparison of Multiple Change Point Models,”

Journal of Econometrics, 85, pp. ?

8. Christ, N. H., Friedberg, R., and Lee, T. D. (1982) “Random Lattice Field Theory,”
Nuclear Physics, B202, pp.89-125. [Reprinted in the series Contemporary Physics,
Rota, G.-C., Sharp, D., eds, in the volume T. D. Lee: Selected Papers, Volume 3:
Random Lattices to Gravity, 1986, Feinberg, G.. ed., Birkh¨auser: Boston

9. Cmejla, R. and Sovka, P. (1999) Application of Bayesian Autoregressive Detector

for Speech Segmentation, ICSPAT99
http://amber.feld.cvut.cz/user/cmejla/Publications.html

10. Dasgupta, A. and Raftery, A. E. (1998) “Detecting Features in Spatial Point Pro-
cesses with Clutter via Model-Based Clustering,” J. American Statistical Associa-
tion, 93, pp 294-320. Also (1995), Technical Report No. 295, Dept. of Statistics,
University of Washington.

11. de Berg, M., van Kreveld, M., and Overmars, M., and Schwarzkopf, O. (1997),

Computational Geomerty: Algorithms and Applications, Springer-Verlag: Berlin

12. Ebeling, H. and Wiedenmann, G. (1993), “Detecting structure in two dimensions
combining Voronoi tessellation and percolation,” Physical Review E, 47, pp 704-
710. See http://asc.harvard.edu/udocs/docs/docs.html#detect

13. Edelsbrunner, H./ (1987), Algorithms in Computational Geometry, Springer-Verlag:

Berlin

14. Fraley, C., and Raftery, A. E. (1998) “How Many Clusters? Which Cluster Method?
Answers Via Model-Based Cluster Analysis,” em Computer Journal, 41, pp. 578-588.
Also Technical Report No. 329, Dept. of Statistics, University of Washington.

15. Gelman, A., Carlin, and J. B., Stern, H. S. and Rubin, D. B. (1995) Bayesian Data

Analysis, Chapman & Hall, New York

16. Gregory, P. C. and Loredo, T. J. (1992) “A New Method for the Detection of a
Periodic Signal of Unknown Shape and Period,” Astrophysical Journal, 398, pp. 146-
168.

17. Gustafsson, F. (1996) “The marginalized likelihood ratio test for detecting changes,”

IEEE Transactions on Automatic Control, 41, pp. 66-78.

18. Gustafsson, F. (1999) “A Change Detection and Segmentation Toolbox for Matlab”
19. Klein, R. (1989), Concrete and Abstract Voronoi Diagrams, Lecture Notes in Com-

puter Science No. 400, Springer-Verlag: Berlin

20. Kutoyants, Yu. A. (1998), Statistical Inference for Spatial Poisson Processes, Lecture

Notes in Statistics No. 134, Springer-Verlag: Berlin

21. Noltemeier, H./ ed. (1988), Computational Geometry and its Applications, Lecture

10

Notes in Computer Science No. 333, Springer-Verlag: Berlin

22. Ogden, T. notes: Change-points in Poisson Data

http://www.stat.sc.edu/~ogden/slides/temp.html.

23. Ogden, T. and Lynch, J. D. (1998) “Bayesian analysis of Change-point models,”
Bayesian Inference in Wavelet Based Models, P. Muller and B. Vidokovic eds.,
Springer-Verlag: New York

24. Ogden, T. and Cheng, C. (1997) “Testing for abrupt jumps with wavelets,” Proceed-
ings of the 1997 Conference on the Interface of Statistics and Computer Science, 56,
pp. 293-302.

25. Ogden, T. and Wes, R. W. (1998) “Continuous-time Estimation of a Change-point in
a Poisson Process,” Journal of Statistical Computation and Simulation, 56, pp. 293-
302.

26. Ogden, T. (1996) “Wavelets in Bayesian Change-point Analysis,” American Statis-
tical Association, 1996 Proceedings of the Section on Bayesian Statistical Science,
pp. 164-169.

27. Ogden, T. and Parzen, E. (1996) “Data Dependent Wavelet Thresholding in Non-
parametric Regression with Change-point Applications,” Computational Statistics
and Data Analysis, 22, pp. 53-702.

28. Ogden, T. and Parzen, E. (1996) “Change-point Approach to Data Analytic Wavelet

Thresholding,” Statistics and Computing, 6, pp. 93-99.

29. Ogden, T. and Sugiura, N. (1994) “Testing Change-points with Linear Trend,” Com-

munications in Statistics B: Simulation and Computation, 23, pp. 287-322.

30. `O Ruanaidh, J. J. K. and Fitzgerald, W. J. (1996) Numerical Bayesian Methods

Applied to Signal Processing, Springer: New York

31. Pettitt, A. N. (1979) “A non-parametric approach to the change-point problem,”

Journal of Applied Statistics, 28, pp. 126-135.

32. Preparata, F. P., and Sahmos, M. I. (1985), Computational Geometry: An Introduc-

tion, Springer-Verlag: New York

33. Raftery, A. E. (1993) “Change Point and Change Curve Modeling in Stochastic
Processes and Spatial Statistics,” Technical Report No. 253, Dept. of Statistics,
University of Washington.

34. Raftery, A. E. and Akman, V. E. (1986) “Bayesian analysis of a Poisson process with

a change-point,” Biometrika, 73, pp. 85-89.

35. Scargle, J. D. (1998) “Studies in Astronomical Time Series Analysis. V. Bayesian
Blocks, A New Method to Analyze Structure in Photon Counting Data,” Astrophys-
ical Journal, 504, pp. 405-418.

36. Snyder, D. L. and Miller, M. I. (1991), Random Point Processes in Time and Space,

Second Edition, Springer-Verlag: New York

37. Stark, J. A., Fitzgerald, W. J. and Hladky, S. B. (1997) “Multiple-order Markov
Chain Monte Carlo Sampling Methods with Application to a Changepoint Model”
38. Stephens, D. A. (1994) “Bayesian retrospective multiple-changepoint identiﬁcation,”

Journal of Applied Statistics, 43, pp. 159.

39. Stephens, D. A. and Smith, A. F. M. (1992) “Bayesian edge-detection in images via

changepoint methods”

40. Stoyan, D. Kendall, W. S. and Mecke, J. (1995) Stochastic Geometry and its Appli-

11

cations. 2nd edition, John Wiley & Sons: New York

41. Walsh, D. and Raftery, A. E. (1999) “Detecting Mines in Mineﬁelds with Linear
Characteristics,” Technical Report No. 359, Dept. of Statistics, University of Wash-
ington.

42. Webster, R. and Ogden, R. T. (1998) Continuous-time Estimation of a Change-point

in a Poisson Process

12

FIGURE 1. Block representations based on the divide and conquer algorithm. The piecewise
homogeneous Poisson data were generated from a modiﬁcation of Donoho’s Blocks function. The
actual changepoints used to generate the data are shown as vertical lines at the bottom, and the
changepoints determined on the ﬁrst three steps of the iteration are dashed lines.

13

FIGURE 2. Block representations based on the MCMC algorithm. The piecewise homogeneous
Poisson data were generated from a modiﬁcation of Donoho’s Blocks function. The actual change-
points used to generate the data are shown as vertical dashed lines. Spurious, narrow blocks have
been emphasized (e.g. the one at about t = 0.76.

14

FIGURE 3. Block representations using the Cell Coalescence algorithm. The top panel shows
the overly ﬁne segmentation in the early stages of the iteration. In successive panels the process
is converging toward a coarser representation. The bottom panel shows the ﬁrst stage at which
the Bayes factor contraindicates merging of all of the remaining blocks. The actual changepoints
used to generate the data are shown as vertical dotted lines.

15

