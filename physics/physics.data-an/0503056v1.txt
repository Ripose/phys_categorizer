5
0
0
2
 
r
a

M
 
8
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
6
5
0
3
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Recurrence time analysis, long-term correlations, and extreme events

Eduardo G. Altmann∗ and Holger Kantz
Max Planck Institute for the Physics of Complex Systems,
N¨othnitzer Strasse 38, 01187 Dresden, Germany.
(Dated: February 2, 2008)

The recurrence times between extreme events have been the central point of statistical analyses in
many diﬀerent areas of science. Simultaneously, the Poincar´e recurrence time has been extensively
used to characterize nonlinear dynamical systems. We compare the main properties of these statis-
tical methods pointing out their consequences for the recurrence analysis performed in time series.
In particular, we analyze the dependence of the mean recurrence time and of the recurrence time
statistics on the probability density function, on the interval whereto the recurrences are observed,
and on the temporal correlations of time series. In the case of long-term correlations, we verify the
validity of the stretched exponential distribution, which is uniquely deﬁned by the exponent γ, at the
same time showing that it is restricted to the class of linear long-term correlated processes. Simple
transformations are able to modify the correlations of time series leading to stretched exponentials
recurrence time statistics with diﬀerent γ, which shows a lack of invariance under the change of
observables.

PACS numbers: 05.10.Gg,05.45.Tp,02.50.-r,91.30.Px
Keywords: recurrence time, extreme events, time series, long-term correlations, earthquakes

I.

INTRODUCTION

A. Recurrence times

Recurrence time analysis is a powerful tool to charac-
terize temporal properties of well deﬁned events [1, 2].
It has been recently extensively performed in a rich va-
riety of experimental time series:
records of the cli-
mate [3, 4, 5], seismic activities [6], solar ﬂares [7], spikes
in neurons [8], turbulence in magnetic conﬁned plasma [9]
and stock market indices [10]. Calculated essentially in
the same way, these analyses receive diﬀerent names:
waiting time distribution, interocurrence time statistics,
distribution of interspike intervals, distribution of lami-
nar phases, etc. Through a uniﬁed perspective, we dis-
cuss the main properties of these statistical methods,
which allows us to reinterpret and specify many previ-
ous results. By a careful discussion of the relevance of
the probability density function (PDF) of the time series
data we can easily understand and, in a particular case,
reject results on earthquake statistics (Sec. II).
In the
case of long-term correlated linear time series we obtain
a closed expression for the stretched exponential distribu-
tion of recurrence times which is valid for diﬀerent recur-
rence intervals. We show also the lack of invariance of the
long-term correlations of the time series under transfor-
mations that simulate the choice of diﬀerent observables
of the system (Sec. III). Before reporting these results
we start with a proper deﬁnition of time series recurrence
times, we compare it to the Poincar´e recurrences and we
discuss brieﬂy some important recent applications of the
recurrence time analysis.

∗Electronic Address:edugalt@pks.mpg.de

Time series recurrences
Assuming a time series point of view, in this paper we
study the statistical properties of the recurrence time T .
, n = 1, . . . , N , and having de-
Given a time series
ﬁned a recurrence interval I as a subset of the data range,
then the ith recurrence time Ti is the time interval ∆n be-
tween the ith and the i + 1st visit of a time series point
in I. The recurrence time statistics (RTS) is obtained
as the distribution P (T ) of the sequence of recurrence
times Ti.

xn}

{

Evidently, the sequence of recurrence times generated
this way depends sensitively on the choice of I, which in
fact will be one prominent issue of this paper. While for
the recurrence of extreme events the recurrence interval
is deﬁned by the points above a threshold [1]

(1)

(2)

Iext(q) = [q,

[ ,

∞

in a more general way it may be deﬁned around a posi-
tion Xc with a semi-width δ [9, 11]

I(Xc, δ) = [Xc −
Both kinds of intervals are illustrated in Fig. 1.

δ, Xc + δ] .

Poincar´e recurrences
In dynamical systems’ theory, another concept of recur-
rence, known as Poincar´e recurrences, plays a central
role. Given a closed Hamiltonian system with ergodic-
ity on the energy shell, the famous Poincar´e recurrence
theorem asserts that almost all trajectories (except for
of
a set of zero measure) started inside some subset
the phase space Γ will return to it inﬁnitely many times.
In the limit of vanishing volume of this subset, the time
between consecutive recurrences is the Poincar´e recur-
rence time. Despite the well known debates about the

V

T=110

T=79

(b)

Iext
q

0.4

0.3

)
x
(
ρ

I2

0.2

I1

0.1

(a)

4

2

x

0

−2

−4

0

50

150

200

100
t

0

−4

−2

0
x

2

q

4

I1

I2

Iext

FIG. 1: Gaussian distributed time series with recurrence in-
tervals with measure µ(I) = 0.01, what implies hT i = 100.
One extreme interval Iext(q = 2.3263) = [2.3263, ∞[ and
two recurrence intervals I1(−2, 0.0922) = [−1.9078, −2.0922],
I2(0, 0.0125) = [−0.0125, 0.0125] illustrated in the (a) time
series and (b) probability density function.

foundations of statistical mechanics (Zermello paradox)
these ideas motivated throughout the years also mathe-
matical studies [12] and, more recently, applications of
recurrence analysis to many diﬀerent dynamical systems
(see Ref. [13] and references therein).

∈

Surprisingly, as far as we know, no connection be-
tween the two recurrence approaches described above
were made until now. The most evident way to estab-
lish this relationship is to deﬁne an observable x = x(~γ),
Γ is the trajectory in phase space of the
when ~γ(t)
Hamiltonian system. The recurrence volume
is mapped
to an interval I
on the real axis by the observation func-
V
tion x(~γ). However, the sequence of recurrence times of
is
the series xn := x(~γ(t = n∆t)) with respect to I
V
generally not identical to the sequence of Poincar´e recur-
, since there is usually
rences of ~γ(t) with respect of
a large set ¯
due to the non-
V
will be of
invertibility of x(~γ). Moreover, generally I
V
the kind of I(Xc, δ) rather than Iext(q).

which also maps to I
V

V

V

However, as we will show in this paper, the analogy
with Poincar´e recurrences motivates issues related to the
recurrence times of extreme events which will reveal fun-
damental insight into their properties. Two main results
will be the lack of invariance of the RTS under change of
the observable and the fact that long-term correlations
are not fully characterized by the autocorrelation func-
tion.

B. Earthquakes and SOC models

The recurrence time between extreme events was re-
cently used in the analysis of diﬀerent experimental time
series [3, 4, 5, 6, 7, 8]. One of the most important exam-
ples of this analysis, which is going to be discussed later in

2

this paper, is the study of the waiting time between earth-
quakes or avalanches in models exhibiting self-organized
criticality (SOC). The idea of studying recurrences in
SOC started with the ﬁrst connections between SOC and
earthquakes [14]. More recently, the investigation of seis-
mic catalogs of diﬀerent regions of the globe indicate the
existence of a universal distribution of recurrence times
between big earthquakes [6], which may be roughly de-
scribed as a power-law distribution

P (T )

T −

α,

∝

(3)

followed by a faster decay. Simple SOC models have a
Poisson (exponential) distribution of recurrence times,
what was used as argument against the use of SOC to
model not only earthquakes [15] but also (and originally)
solar ﬂares [7]. However, non-Poissonian distributions
are obtained in more sophisticated SOC models [16, 17],
what keeps open the debate over the use of SOC in these
ﬁelds, with the RTS as one of its central ingredients.

C. Long-term correlations and recurrence times

{

xn}

If time series data

are exponentially (short range)
correlated, the RTS is well known to be Poissonian, i.e.,
exponential for all T , independent of the choice of I (in
0) [11]. The same result
the limit of small interval µ(I)
applies to Poincar´e recurrences (including independence
of
) if the underlying dynamics is hyperbolic, i.e., in
well deﬁned mathematical way fully chaotic [18]. Also in
this case, correlations decay fast. Hence, for systems with
an exponential decay of correlations, details of deﬁning
recurrence times and further details of the system are
irrelevant; instead there exists a unique RTS.

→

V

Many time series data have been found to be long-
term correlated, i.e., their mean autocorrelation time di-
verges [3, 4, 19]. Typically, this situation is character-
ized in the time series
= 0) by the
exponent 0 < γc < 1 of the power-law decay of the auto-
correlation function as a function of the time s

(assuming

xni
h

xn}

{

Cx(s) =

xixi+si
h

=

N

xixi+s ∼

s−

γc .

(4)

1

N

s

−

s

−

Xi=1

In a recent paper [1], Bunde et al. analyzed the eﬀect of
long-term correlations on the return periods of extreme
events, i.e., of recurrence times obtained using recurrence
intervals of type (1). The main results of Ref. [1, 2] for
long-term correlated time series can be summarized by
the following three points. While the ﬁrst was obtained
considering statistical arguments, the two others were
based on numerical simulations.
(i) The mean recurrence time is equal to the inverse of
the fraction of extreme points in the series

=

T
h

i

Ntotal
Nextreme

.

(ii) The statistics of T follows a stretched exponential

(5)

ln P (T )

(T /

T
h

)γ ,
i

∝ −
where γ = γc is identical to the correlation exponent in
Eq. (4).
(iii) The series of recurrence times is long-term correlated
with an exponent γT close to γc.

Statement (i) is the time series analogous of Kac’s
Lemma (Sec. II), statement (ii) will be veriﬁed carefully
(Sec. III B) once we have established the full functional
form of the stretched exponential (5), and statement (iii)
seems not to be generally valid (Sec. III D).

Even if one might argue that based on Ref. [1] the va-
lidity of Eq. (5) is established only for the class of the
model data chosen there, the reproduction of these ﬁnd-
ings for empirical data [3, 4] suggests some generality of
the stretched exponential distribution. Here, the link to
Poincar´e recurrences shows the opposite: Hamiltonian
systems with mixed phase space are long-term correlated
and show power-law tails in the statistics of Poincar´e
recurrence times [13]. In this case, the long-term correla-
tions are originated by the stickiness of chaotic trajecto-
ries near the border of integrable islands. They cause a
kind of intermittent dynamics and manifest themselves in
complicated higher-order temporal correlations. In fact,
the temporal properties of typical data are not fully spec-
iﬁed by the autocorrelation function, Eq. (4), what ex-
plains why there cannot be a unique RTS for long-term
correlated data. Connections between the long-term cor-
relation exponent γc and the RTS have to be established
independently in every class of long-term correlated dy-
namical systems, as was done for Hamiltonian systems
with mixed phase space [13] and fractal renewal point
processes [20]. We argue in Sec. III B that the results of
Ref. [1] described above are valid for long-term correlated
linear time series [2]. In this paper we propose a closed
expression for the RTS of time series of this class, which
is valid for recurrence intervals of both types (1) and (2).

II. MEAN RECURRENCE TIME

The mean recurrence time

T
h

i ≡

lim
Ne→∞

1
Ne

Ne

X1

Ti,

3

statistics of recurrence times. In the time series analysis
this measure is estimated as the fraction of valid events
(points inside the recurrence interval) µ(I) = Nevents/N .
Intuitively, relation (6) states simply that the total ob-
servation time t is given by

T
t = N ∆t = Neventsh

.
i

Besides the RTS P (T ) the PDF ρ(x) of the series of
points itself is typically used to characterize the time se-
ries. Contrary to other time series analyses (as the de-
trended ﬂuctuation analysis discussed below), the RTS
is independent of the PDF. In particular, it is irrelevant
whether the second moment of the PDF is ﬁnite. A time
series with a well behaved (Gaussian) PDF can have ei-
ther exponential or power-law RTS [28]. Reversely, a
time series with fat tails in the PDF can lead to a RTS
that might be Poisson or power-law [29]. The reason for
this is simple: the RTS depends on the sequence of the
time series points and changes under their temporal rear-
rangement, which does not change the PDF of the data.
While the RTS is independent of the PDF of the series,
the opposite happens to the mean recurrence time
.
i
Once the recurrence interval is deﬁned, whether by re-
lation (1), (2) or by any other possible deﬁnition, the
PDF ρ(x) provides

through relation (6).

T
h

These two apparently trivial observations, i.e., inde-
on the PDF,
pendence of the RTS and dependence of
shed new light on previous results. In what follows, we
exemplify these points in the analysis of recurrence times
between earthquakes, already mentioned in Sec. I B. De-
spite (or because of) the complexity of this ﬁeld it has
an important simplicity: the Gutenberg-Richter law

T
h

i

T
h

i

ρ(M )

e−

b ln(10)M ,

∝

(7)

where A, b are constants and M is the magnitude of the
earthquake, which is proportional to the logarithm of the
released energy. The constant b is almost the same for
diﬀerent parts of the world and the empirical law (7) is
M . 7.5. From our perspective this means
valid for 2
that the PDF of the time series of seismic activity is
given[30].

≤

The mean recurrence time between earthquakes of a
given magnitude M is obtained inserting the PDF given
by (7) in relation (6), and using the interval of the
type (2) with Xc = M ,

is a direct result of the choice of the recurrence interval.
In area preserving dynamical systems Kac’s lemma [12]
is equal to the ergodic mea-
states that the inverse of
i
sure of the recurrence interval µ(I). In the case of sta-
tionary time series, as illustrated in Fig. 1, an equivalent
result is obtained from the normalized PDF ρ(x),

T
h

= µ(I)

ρ(x)dx,

(6)

∆t
T
h

i

≡ Zx

I

∈

where ∆t is the sampling rate used to record the time
series[27]. This is the most important constraint to the

−

(1

(8)

(M ) = T0eb ln(10)M ,
T
h
i
b ln(10)
where T0 ∝
e−b ln(10)δ ) . This relation is equivalent to
the one obtained previously through a “mean-ﬁeld ap-
proach” [14]. In Ref. [17] it is noted the “remarkable”
10bMc, which is nothing else
scaling of
than a consequence of relation (6) when intervals of the
type (1) are used with q = Mc.
So far, the relation between

and the PDF was used
to show that the mean waiting time between earthquakes
is directly related to the Gutenberg-Richter law, but has

(M
i

Mc)

T
h

T
h

≥

∝

i

                                  

                                  

(a)

(b)

4

nothing to do with temporal correlations between earth-
quakes. On the other hand, the RTS obtained from earth-
quakes records [6] is an independent result that can be
used as a test for the dynamical models of earthquakes.
Recently, it was suggested that in SOC models the se-
quence of avalanches is uncorrelated [7, 15] (see [23] for
a counterexample) and should thus be discarded. The
solution of this debate is beyond the scope of this paper.
Nevertheless, we note that, as a consequence of the un-
relatedness of ρ(x) and P (T ), shuﬄing data of whatever
distribution randomly (as was done for the time series
of seismic activity in Ref. [15]) trivially implies P (T ) of
being exponential, also for ﬁnite recurrence intervals [11].

102

100

γ

i

 
g
n
s
a
e
r
c
e
d

10−2

)
τ
(

γ

p

10−4

10−6

10−8

10−10

γ=1
γ=0.8
γ=0.6
γ=0.4
γ=0.2
γ=0.1
γ=0.05

)
γ
a
/
γ
p
(
n
−

l

102

101

100

10−1

10−2

10−3

d

e

c

r

e

a

s

i

n

g

 γ

decreasing γ 

III.

STATISTICS OF RECURRENCE TIMES

10−4 10−3 10−2 10−1 100 101 102 103 104
τ

10−4 10−3 10−2 10−1 100 101 102 103 104
τ

A. Closed expression of the stretched exponential
distribution

FIG. 2: The stretched exponential distribution (10) for dif-
ferent values of the exponent γ.

We generalize the distribution proposed in Ref. [1] for
the RTS of long-term correlated time series. Motivated
by result (ii), mentioned in Sec. I C, suppose that the
stretched exponential distribution

Pγ(T ) = ae−

(bT )γ

(9)

[. This is
is valid for all recurrence times T
actually a stronger assumption than Eq. (5). As any
RTS, Eq. (9) must satisfy the following two conditions:
normalization

]0,

∞

∈

∞

Z
0

P (T )dT = 1,

and the analogous of Kac’s lemma (6)

∞

T
h

i ≡ Z
0

T P (T )dT =

1
µ(I)

.

Imposing these two conditions to the distribution (9),
it is possible to express the constants a and b as func-
tions of γ and µ(I). Further simpliﬁcation is obtained
performing the following transformation of variables τ =
T
<T > = µ(I)T , i.e., counting the time in units of the
mean recurrence time. The complete stretched exponen-
tial distribution for recurrence times is then written as

pγ(τ ) = aγe−

(bγ τ )γ

aγ = bγ

γ
Γ(1/γ) ,

bγ =

(21/γ )2Γ( 2+γ
2√π

2γ )

,

(10)

, with 




and depends exclusively on the exponent γ.

Equation (10) is illustrated in Fig. 2 for diﬀerent val-
ues of γ in two diﬀerent ways. Graph (a) (log-log) shows
that decreasing the value of γ the distribution starts from
the exponential (Poisson) case (γ = 1) and approaches
0) with an exponent α = 1.5. Graph
a power-law (γ

→

(b) shows the distribution in the form that the stretched
exponentials are seen as straight lines [1, 3, 4]. Generally,
to obtain graph (b) from (a) one needs to divide the dis-
tribution P (T ) by the correct pre-factor a = P (0), which
is typically unknown. Distribution (10) shows the de-
pendence of the pre-factor a on the exponent γ when the
stretched exponential pγ(τ ) is valid in the whole interval
of times. For experimental or numerical data, where nei-
ther a nor γ are known a priori, the relation between both
is useful to correctly visualize and ﬁt the RTS. We note
that in practice the numerical ﬁtting of the exponent γ
is very sensitive and typically depends on the choice of
the pre-factor a.

B. Numerical results for long-term correlated
linear time series

We compare now the stretched exponential distribu-
tion (10) to the numerical results of the RTS obtained
in long-term correlated time series. As in Ref. [1], the
data were generated using the Fourier transform tech-
nique [21]:
imposing a power-law decay on the Fourier
spectrum

fx(k)

k−

β ,

(11)

∝
with 0 < β < 0.5 and choosing phase angles at random,
we obtain through an inverse Fourier transform the long-
2β in
term correlated time series in x with γc = 1
−
Eq. (4). The data are Gaussian distributed with
=
x
i
h
0, σ = 1, and Eq. (6) was used to calculate the times
τ = T /

Having speciﬁed the power spectrum or, correspond-
ingly, the autocorrelation function for sequences of Gaus-
sian random numbers means to have ﬁxed all parameters
of a linear stochastic process. Hence, in principle, the co-
eﬃcients of an auto regressive (AR(r)) or moving average

T
h

.
i

(MA(r)) process can be uniquely determined, where, due
to the power-law nature of spectrum and autocorrelation
function, the orders r of either of these models have to be
inﬁnite [22]. Hence, the following results are valid for the
class of linear long-term correlated processes [2]. In other
words, higher order correlations for this class of processes
follow trivially from the two-point correlations.

(a)

(b)

)
τ
(
p

γ

101

100

10−1

10−2

10−3

10−4

10−5

10−6

101

)
γ
a
/
γ
p
(
n
−

l

100

10−1

10−2

10−1

101

102

10−2

10−1

101

102

100

τ

5

FIG. 3:
(color online) RTS of long-term correlated linear
time series with N = 225 ≈ 3 107 points for diﬀerent values
of γc (symbols). Lines are the stretched exponential distri-
bution (10) with γ = γc. The recurrence interval is extreme
with µ(Iext) = 10

−2.

We show in Fig. 3 that the stretched exponential dis-
tribution (10) with γ = γc describes considerably well
the RTS, obtained using extreme intervals (Eq. (1)), of
long-term correlated linear time series. The agreement
is especially good for small values of γc (long correla-
0).
tions) and q
This result is a generalization of the result (ii) [1] since,
using Eq. (10) and considering γ = γc, the comparison
between the theoretical and numerical distributions has
no free parameter and no ﬁtting is made.

(which is equivalent to µ(I)

→ ∞

→

(a)

(b)

101

100

)
a

γ

/
γ

p
(
n
−

l

10−1

10−2

10−3

Xc=0
Xc=1
Xc=2
Xc=∞
γ=1
γ=0.8
γ=0.55
γ=0.3
γ=0.1

τ

Xc=0

101

(c)

100

10−1

10−2

10−3

10−1 100 101 102
102

100

101

τ

10−3

10−2

10−1

100

101

102

10−3

10−2

10−1

FIG. 4: (color online) RTS of long-term correlated linear time series with γc = 0.1 and diﬀerent recurrence intervals (centered
in Xc with measure µ(I) = 10−3). The lines are stretched exponentials distributions and the symbols connected by lines are
the numerical simulations. From (a) to (b) we use the values given by aγ of the best ﬁtting of Eq. (10) in (a). In (c) we analyze
−2 (shifted by
the case Xc = 0 for diﬀerent values of µ(I), from bottom to top: µ(I) = 10
−3. The gray lines are the Poissonian distribution (γ = 1 in Eq. (10)). aγ=1 = 1 was used for all three cases.
10) and µ(I) = 10

−1 (shifted down by 102), µ(I) = 10

γ
c=0.1
γ
c=0.4
γ
c=0.7
γ=0.1
γ=0.4
γ=0.7

100

τ

)
τ
(
p

γ

102

101

100

10−1

10−2

10−3

10−4

10−5

Furthermore, we verify in Fig. 4 that, for small µ(I),
the distribution (10) is valid also for recurrence intervals
in the inner part of the data range (centered at Xc and
, approaching the
deﬁned by Eq. (2)). When Xc → ∞
extreme interval, the value of γ in Eq. (10) approaches
the value of the correlation exponent γc. Decreasing the
value of Xc towards the mean value of the PDF (
= 0)
x
i
h
results in an increase of γ. This case was analyzed care-
fully in Fig. 4c, where the dependence of the RTS on the
size of the recurrence interval µ(I) is shown. While for
big intervals the stretched exponential seems not to hold,
when µ(I)
0 (the limit Poincar´e was interested in) the
distribution for Xc = 0 tends to the upper limit γ = 1,
the Poisson distribution.

→

→

In summary, the RTS of long-term correlated linear
time series with exponent γc, in the limit of small inter-
val µ(I)
0, is described by the stretched exponential
distribution (Eq. (10)) for all recurrence times T and for
recurrence intervals of both types (1) and (2). The ex-
ponent γ is a continuous and monotonically decreasing
function of the center Xc of the recurrence interval, with
the limits

γ =

(cid:26)

γc when Xc → ∞
1 when Xc = 0.

(extreme),

(12)

This result has a simple interpretation in terms of the
long-term correlations contained in the time series. Cal-
culating the RTS to a speciﬁc interval measures the cor-
relation between events inside this interval. In this sense,
our result suggests that the long-term correlations of the
time series are concentrated in the extreme events (large
ﬂuctuations) and vanish for events near the mean value
(small ﬂuctuations). Relation (12) can then be inter-
preted as: approaching pure extreme events (µ(I)
0
) the RTS shows the whole correlation and
and Xc → ∞
0
thus γ = γc. Approaching pure middle events (µ(I)
and Xc = 0) no correlation is detected and consequently
the Poisson distribution (γ = 1) is recovered.

→

→

C. Change of observables

The link between recurrence times on time series and
Poincar´e recurrences (Sec. I A) motivates the issue of
the change of observables. All of the empirical data ex-
hibiting long-term correlations mentioned before repre-
sent systems which involve a huge number of degrees of
freedom. Hence, there is a similarly huge arbitrariness
in choosing a given observation function x(~γ), and the
natural question is what to expect when we change this
observation function.

For instance, the correlations in the weather can be
studied through records of the daily maximum temper-
ature or of the daily precipitation [3]. For the ﬁrst ob-
servable, long-term correlations for times larger than 10
days were found with an exponent γ
0.7 for continental
stations, independent of the location and of the climatic

≈

6

zone of the weather station. On the other hand, the se-
ries of precipitation, obtained in the same locations and
for the same time windows, are not long-term correlated.
A similar situation is observed in ﬁnancial market data.
While the ﬂuctuation of prices are typically uncorrelated
the volatility is long-term correlated [24]. This gives al-
ready a clue that correlations measured on a given time
series do in fact characterize the ﬂuctuations of the given
observable but do not characterize the underlying system
in a more abstract way.

−

Here we want to study the dependence of correla-
tions and RTS on the chosen observable in more de-
tail by comparing the properties of diﬀerent observables.
Generally, both observables x and y are functions of
dimensional phase space vectors ~γ, and no sim-
the d
ple function connecting x and y exists. Since we are
starting from time series data without underlying multi-
dimensional phase space, we will restrict the analysis to
a subclass of changes of observables, where in fact y is
given by a nonlinear (potentially non-invertible) function
of x. Hence, we construct time series of diﬀerent observ-
ables y as functions of the original long-term correlated
time series of the variable x. Having in mind a recurrence
interval deﬁned through (Xc, δ) by relation (2), consider
the following reversible transformation

yn =

1
(Xc −

,

xn −
which is essentially the inverse of the original series
.
xn}
If the x-series is Gaussian distributed as considered pre-
viously, the PDF of the new series

is given by

δ)

{

{

yn}
2 (1/y+(Xc−

1

δ))2

,

ρ′(y) =

1
√2π

1
y2 e−

(13)

(14)

which is illustrated in Fig. 5 for the case Xc = 1, δ =
0.0207. In this ﬁgure it is also shown that the interval I1,
deﬁned by the same (Xc, δ) in x, is transformed into an
extreme interval in y. On the other hand, the extreme
interval I2 in x is transformed into a recurrence interval
in the middle of the PDF of y. Since the sequence of
recurrence times T obtained using the original intervals
in the x-series is also obtained using the transformed in-
tervals in the y-series, the RTS remains invariant under
simultaneous transformation of variables and recurrence
intervals. Therefore, the previous observation that the
change of the recurrence interval in the x-series does not
aﬀect the functional form of the stretched exponential
distribution (10), but does aﬀect the exponent γ, carries
over to transformations of the form (13). For instance,
the RTS of a series obtained from transformation (13)
applied to a time series x with γc = 0.1, is well described
by the stretched exponential distribution (10) with (see
0.55 for extreme interval (I1 in Fig. 5b)
Fig. 4): γ
and γ = 0.1 for central interval (I2 in Fig. 5). This result
holds for all reversible transformations.

≈

An important fundamental question in this context is
the behavior of the long-term correlations under trans-

(a)

100

(b)

tions of
{
of qDF A.

yn}

are coherently noticeable for small values

7

0.4

0.3

0.1

)
x
(
ρ

0.2

10−1

)
y
(
’
ρ

10−2

10−3

10−4

0

−4

−2

2

4

−20 −10

0

20

30

40

I2

I1

0
x

I1

I2

10
y

FIG. 5: PDF of the series (a) of x (Gaussian) and (b) of y
(Eq. (14) with Xc = 1, δ = 0.0207). The points inside the
interval I1(Xc = 1, δ = 0.0207) in x become extreme events
in y. The opposite happens for the extreme interval I2 =
Iext(q = 2.3263).

≈

formations of variables. Whereas the normalized auto-
correlation function remains unchanged under shifts and
rescalings of x, this is not the case under transformations
like (13), where the transformed time series of y is not
long-term correlated at all, despite the long-term correla-
0.5).
tions of the original x-series (see Fig. 6 where h(2)
We characterize the y-series using the multi-fractal de-
trended ﬂuctuation analysis [19], which is a much more
powerful tool than the simple autocorrelation function,
since for diﬀerent values of the parameter qDF A diﬀerent
In order to distin-
scales of ﬂuctuations are ampliﬁed.
guish between the multifractality due to long-term cor-
relations and due to a broad PDF, the typical procedure
is to shuﬄe the time series randomly, i.e., we choose ran-
domly a new order of the N points of the original time
series. Since the shuﬄed series loses all its temporal cor-
relations but retains the same PDF, the diﬀerence be-
tween the results of the two series (original and shuﬄed)
is exclusively due to temporal correlations. In Fig. 6 we
show the multi-fractal analysis (MF-DFA1 [19]) for the
long-term correlated, Gaussian distributed, linear time
and for the transformed (through Eq. (13))
series
xn}
time series
. As expected, in the ﬁrst case roughly
yn}
a single generalized Hurst exponent h(s) is obtained for
all scales in the original (h(s) = 1
γc/2 = 0.95) and
shuﬄed (h(s) = 0.5) time series. Due to the broad tails
present in Eq. (14), both the y-series and its shuﬄed ver-
sion have multi-fractal spectrum, shown by the nontrivial
dependence of h(qDF A) on qDF A. The diﬀerence between
the two, which measures the eﬀect of the temporal cor-
relations, appears for small scales, where the generalized
Hurst exponent of the shuﬄed series is smaller. This
result is consistent with the interpretation made at the
end of Sec. III B that the correlations of the x-series is
concentrated on the extreme events. Through transfor-
mation (13), the extreme events in x are mapped into
very small ﬂuctuations in y and the temporal correla-

−

{

{

1.25

1

0.75

0.5

0.25

)

A
F
D
q
(
h

x (γ
c=0,1)
x − shuffled
y
y − shuffled

0
qDFA

0

−8

−6

−4

−2

2

4

6

8

FIG. 6: Generalized Hurst exponent of the time series of x
and y (N = 220 ≈ 106 points) as a function of the scale qDF A.
The horizontal gray lines are the non-correlated value (h =
0.5) and the expected value for γc = 0.1 (h = 1−γc/2 = 0.95).
The diﬀerence between the original and the shuﬄed time se-
ries measures the eﬀect of the correlation at each scale qDF A.

Through transformation (13) we provide an example of
equivalence between the RTS of diﬀerent observables ob-
tained using extreme intervals, and the RTS calculated
in the same series but using diﬀerent recurrence inter-
vals. Always when the transformation of observables is
invertible, there exist a one-to-one correspondence be-
tween the original extreme values and a new interval.
This provides another justiﬁcation to the generalization
of the recurrence of extreme events to general recurrence
intervals, proposed in Sec. I A inspired by the analogy to
the Poincar´e recurrences.

D. The series of recurrence times

It is also interesting to apply the distinction between
the time properties of the series and its PDF, discussed
in Sec. II, to the series of recurrence times
T1, T2, ...TN e}
itself [25]. In this case this means that the PDF, which
is the RTS of the original time series, is independent of
its correlation and shows that the results (ii) and (iii)
stated in Sec. I C are independent. This is an important
remark when prediction algorithms are considered, since
in many cases the correlation between the waiting times
is more important than their distribution [26].

{

The result (iii) of Ref. [1] is veriﬁed in Fig. 7 through
the multifractal analysis of the series of recurrence
Instead of the same correlation exponent we
times T .
ﬁnd a multifractal spectrum. It is necessarily originated
by the long-term correlations since the PDF of these se-
ries are stretched exponential distributions, as veriﬁed in
Fig. 4, which do not have fat tails.

1.2

1

0.8

)

A
F
D
q
(
h

0.6

Xc=0
Xc=1
Xc=2
extreme

0.4

0

2

4
qDFA

6

8

FIG. 7: Multifractal spectrum for the series of recurrence
times ({T1, T1, ..., TNe}) obtained for intervals with µ(I) =
0.01, and diﬀerent values of Xc in long-term correlated linear
time series with γc = 0.1 (Ne = 218 ≈ 2 × 105).

IV. DISCUSSION AND CONCLUSION

Well established regimes of decay of the RTS are ex-
ponentials and power-laws, and, only recently observed,
stretched exponentials. We have obtained a closed ex-
pression for the stretched exponential distribution of re-
currence times uniquely deﬁned by the exponent γ. As
limits γ = 1 and γ = 0, respectively, we recover the
exponential and the power-law decay from these (with
the restriction that the power is ﬁxed to 3/2), suggesting
that stretched exponentials describe recurrences in sys-
tems that have neither exponential nor power-law RTS
but that lie in between these two cases. We have veriﬁed
numerically that the stretched exponential distribution
is in good agreement with the numerical results obtained
for long-term correlated linear time series, similarly to
what was done in Ref. [1]. From the point of view of these
previous results, listed in Sec. I C, we have identiﬁed (i)
with Kac’s lemma; generalized (ii) to the stretched expo-
nential distribution (10), which is a function of a single
parameter and is valid for all recurrence intervals through
Eq. (12); and generalized (iii), showing that the sequence
of recurrence times has a multi-fractal spectrum, with an
exponent γT diﬀerent from γc. In order to verify if the
ﬂuctuations around the stretched exponential distribu-
tion, shown in the ﬁgures of Sec. III B, are a consequence
of numerical limitations or real deviations, an analytical
deduction of the stretched exponential distribution (10)
is necessary, what remains an open task.

8

{

xn}

Performing simple reversible transformations (like
Eq. (13)) on the original long-term correlated linear time
series
, we have shown that the stretched exponen-
tial distribution characterizes also the RTS of extreme
events in time series that are not long-term correlated.
The presence and absence of long-term correlations in
the series of the original observable x and of the trans-
formed observable y, respectively, is similar to the one re-
ported above for climatic records (temperature and pre-
cipitation) and stock-market indexes (volatility and ﬂuc-
tuation of price). It is remarkable that this interesting
behavior is obtained already through the simplest possi-
ble approach, i.e., two diﬀerent observables that depend
directly and exclusively on each other. These considera-
tions emphasize that the temporal characterization of the
system through the autocorrelation or RTS depend cru-
cially on the chosen observable. By analyzing both the
dependence of the exponent γ of the stretched exponen-
tial distribution with the center of the recurrence interval
(relation (12)) and the multi-fractal spectrum of the y-
series (FIG. 6) we conclude that, in long-term correlated
linear time series, the correlations are concentrated in the
extreme events.

Many interesting questions arise if one supposes that
the measurements in a given experiment lead to the time
series of the observable y, introduced in Sec. III C, and
that no natural access to the observable x exists. The
y-series has a complex multi-fractal spectrum (Fig. 6),
a strange PDF (Eq. (14)) and a non-trivial dependence
of the RTS with the recurrence interval. Nevertheless,
through a simple transformation (the inverse of rela-
tion (13)) one arrives at the x-series, that has a mono-
fractal spectrum, is Gaussian distributed and has a sim-
ple (Eq. (12)) dependence of the RTS on the recurrence
interval. This suggests the existence, in some situations,
of “distinguished observables” where the time series anal-
It is an interesting open
ysis is extremely simpliﬁed.
problem to develop a procedure able to determine the
transformation (when it exists) that lead to the “distin-
guished observables”.

Acknowledgments

The authors thank J. Davidsen for helpful discussions
and for the careful reading of the paper. E.G.A. thanks
E.C. da Silva and I.L.Caldas for illuminating discussions
on related topics. This work was supported by CAPES
(Brazil) and DAAD (Germany).

[1] A. Bunde, J. F. Eichner, S. Havlin, and J. W. Kantel-

hardt. Physica A, 330:1, 2003.

[2] A. Bunde, J. F. Eichner, J. W. Kantelhardt and

S. Havlin. Phys. Rev. Lett., 94, 048701 (2005).

Nonextensive

E. Koscielny-Bunde, D. Rybski, and D. Vjushin.
Entropy-Interdisciplinary Appli-
In
cations.
2003).
arXiv:physics/0208019.

(Oxford Univ. Press, New York,

[3] A. Bunde, J. Eichner, R. Govindan, S. Havlin,

[4] M. S. Santhanam and H. Kantz. Physica A, 345: 713,

2005.

2002.

2002.

1989.

[5] To associate the recurrence time with residence time in
stochastic resonances see R. B. Alley, S. Anandakrishnan,
and P. Jung. Paleoceanography, 16(2):190, 2001.

[6] P. Bak et al. Phys. Rev. Lett., 88(17):178501, 2002;
Phys. Rev. Lett., 92(10):108501, 2004;
A. Corral.
Phys. Rev. Lett.,
N. Scafetta and B. J. West.
92(13):138501, 2004; J. Davidsen and C. Goltz Geophys.
Res. Lett., 31:L21612, 2004.

[7] G. Boﬀetta et al. Phys. Rev. Lett., 83(22):4662, 1999.
[8] J. Davidsen and H. G. Schuster. Phys. Rev. E, 65:026120,

[9] M. S. Baptista, I. Caldas, M. Heller, and A. A. Ferreira.

Physics of Plasmas, 8:4455, 2001.

[10] M. S. Baptista and I. L. Caldas. Physica A, 312:539,

[11] E. G. Altmann, E. C. da Silva, and I. L. Caldas. Chaos,

[12] M. Kac. Bulletin of the American Mathematical Society,

14(4):975, 2004.

53:1002, 1947.

[13] G. M. Zaslavsky. Physics Reports, 371:461, 2002.
[14] A. Sornette and D. Sornette. Europhys. Lett., 9(3):197,

[15] X. Yang, S. Du, and J. Ma.

Phys. Rev. Lett.,

[16] K. Christiansen and Z. Olami.

J. Geophys. Res.,

92(22):228501, 2004.

97(B6):8729, 1992.

[17] R. S´anchez, D. E. Newman, and B. A. Carreras. Phys.

Rev. Lett., 88(6):068302, 2002.

[18] M. Hirata. Ergod. Th. Dyn. Systems, 13(3):533,1993. Hi-

rata et al. Comm. Math. Phys., 206:33,1999.

[19] J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde,
S. Havlin, A. Bunde, and H. E. Stansley. Physica A,
316:87, 2002.
[20] S. Thurner

Fractals,

5(4):565,

1997.

al.

et

arXiv:adap-org/9709006.

9

[21] S. Prakash, S. Havlin, M. Schwartz, and H. E. Stanley.

Phys. Rev. A, 46(4):R1724, (1992).

[22] G. E. P. Box, G. M. Jenkins, and G. C. Reinsel. Time
forecasting and control (Prentice Hall,

series analysis :
New Jersey, 1994).

66:050101(R), 2002.

41(3):239, 1998.

[23] J. Davidsen and M. Paczuski.

Phys. Rev. E,

[24] M. Potters, R. Cont, and J. Bouchaud. Europhys. Lett.,

[25] The (multi-) fractal properties of the recurrence times
were studied from diﬀerent perspectives
V.
Afraimovich and G. M. Zaslavsky, Phys. Rev. E, 55
(5):5418 (1997) and N. Hadyn et al. Phys. Rev. Lett.,
88 (22):224502 (2002).

in:

[26] M. S. Mega et al. Phys. Rev. Lett., 90(18):188501, 2003.
[27] When there is no such parameter, as in the series of earth-
quakes, the time scale is deﬁned by the total number of
events and the total recording time.

[28] Take for instance the analysis made in Sec. III B which
will give the desirable RTS if we choose γc = 1 or γc → 0
respectively.

[29] These are obtained if we apply the transformation (13)
below again to uncorrelated (γ = 1) or correlated (γ = 0)
time series respectively.

[30] This assumption is not completely precise since in order
to use extreme intervals (deﬁned by Eq. (1)) it is neces-
sary to know the PDF in the limit M → ∞. In the case of
earthquakes it is well known, from general energy consid-
erations, that a faster decay of the Gutenberg-Richter law
is necessary asymptotically. In order to obtain a suﬃcient
statistics in the analyses of experimental data, the choice
of q in Eq. (1) is usually considerably smaller than 7.5
and the inﬂuence of the unknown asymptotic of the PDF
becomes negligible.

