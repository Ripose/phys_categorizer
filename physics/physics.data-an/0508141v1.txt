5
0
0
2
 
g
u
A
 
9
1
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
1
4
1
8
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Automated Chirp Detection with Diﬀusion Entropy:
Application to Infrasound from Sprites

M. Ignaccolo1,∗, T. Farges2, E. Blanc2, and M. F¨ullekrug1
1Department of Electronic and Electrical Engineering, University of Bath, UK and
2Commisariat `a l’Energie Atomique, DASE, Bruy`eres le Chˆatel, France.
(Dated: February 2, 2008)

We study the performance of three diﬀerent methods to automatically detect a chirp in background
noise. (1) The standard deviation detector uses the computation of the signal to noise ratio. (2)
The spectral covariance detector is based on the recognition of the chirp in the spectrogram. (3)
The CASSANDRA detector uses diﬀusion entropy analysis to detect periodic patterns in noise. All
three detectors are applied to an infrasound recording for detecting chirps produced by sprites. The
CASSANDRA detector provides the best trade oﬀ between the false alarm rate and the detection
eﬃciency.

PACS numbers: 05.45.Tp,89.20.-a,52.80.Mg

I.

INTRODUCTION

Chirps are periodic signals with an instantaneous fre-
quency changing in time. Chirps are produced by a va-
from lightning generated whistlers [1]
riety of sources:
to the acoustic emission of bats [2] and whales [3]. Re-
cently the presence of chirps in infrasound recording has
been associated with the occurrence of sprites over thun-
derstorm clouds [4]. Several methods of chirp detection
have been developed, operating in both the time domain
(multiple frequency tracker [5] and recursive least square
algorithm [6]) and the frequency domain (Page’s test [7]
and Hough transform [8, 9]).

In this work we introduce two new methods for chirp
detection. The spectral covariance detector and the CAS-
SANDRA detector. The spectral covariance detector
operates in the frequency domain and uses the corre-
lation between diﬀerent frequency bins of the spectro-
gram [10] as an indicator of the chirp occurrence. The
CASSANDRA (Complex Analysis of Sequences via Scal-
ing AND Randomness Assessment ) detector operates in
the time domain [11, 12] and uses diﬀusion entropy anal-
ysis [13, 14]. We study the performance of these two
detectors and compare the results with a standard signal
to noise ratio detector (standard deviation detector).

Sprites [15] and other recently discovered Transient Lu-
minous Events (TLEs) above thunderstorm clouds, such
as elves [16], blue jets [17] and gigantic jets [18] are
the subject of intense research [19]. TLEs connect the
lower layer of the atmosphere (troposphere: below 10
km) where the weather activity occurs with the upper
levels of the atmosphere (80-100 km). Knowledge of the
sprite occurrence rate is of primary interest to address the

∗Correspondent Author. Email: eexmi@bath.ac.uk.
Web Page:
http://staﬀ.bath.ac.uk/eexmi/mywebpage/home/mywebpage.htm

relevance of these phenomena and their global impact on
the atmosphere.

The outline of this work is the following. In Section II
we brieﬂy discuss the infrasound signature of sprites. In
Section III we discuss the details of each detector and its
performance in sprite detection. In Section IV we draw
our conclusions.

II. SPRITES AND THEIR INFRASOUND
SIGNATURE

Sprites are TLEs with a typical duration from a few
milliseconds up to a few hundred milliseconds. They are
generated by the electric ﬁeld pulse of a “parent” posi-
tive cloud-to-ground (+CG) lightning discharge [20]. The
vertical extension of sprites is ≃45 km, starting from ≃40
km up to ≃85 km, while their horizontal extension can
range from 20-50 km. Since the ﬁrst optical observa-
tions [15], Sprites have been observed over thunderstorm
clouds in North America [21], Europe [22] and Japan
[23]. Electromagnetic signatures from sprites have been
reported in the Extremely-Low Frequency (ELF) range
(10Hz-3kHz) [24] and with Earth-ionosphere cavity reso-
nances [25].

The possibility that sprites could generate an infra-
sound signature was ﬁrst suggested by Lizska [26]. The
ﬁrst report of sprite signature is by [4]. The sprite sig-
natures are located in the 1-10 Hz frequency range and
in many cases a linear chirp of increasing frequency with
time is observed. This signature is caused by the spatial
extent of the sprite (from 20 to 50 km) [4], its orien-
tation with respect to the infrasound station, and the
reﬂectivity properties of the thermosphere [27]. Pressure
waves generated from diﬀerent regions of the sprite will
be reﬂected at diﬀerent altitudes in the thermosphere
with diﬀerent absorption and dispersion properties be-
fore reaching the infrasound station. The net result is
that pressure waves coming from the nearest end of the

 1

 2

 3

 4

 5

 6

 7

 8

 9

)
z
H

(
 
f

 10

 0

sprite will arrive ﬁrst at the station with a low frequency
content. Pressure waves coming from the farthest end
of the sprite will arrive later at the station with a high
frequency content. Sprite signatures which show an im-
pulsive feature instead of a chirp, are the result of a small
spatial extension or of the alignment with the infrasound
station (regardless of spatial extent).

The data set used to test the automated chirp detec-
tors is shown in Fig. 1. It is the original signal recorded
with a 20 Hz sampling rate at the infrasound station in
Flers (210 km West of Paris, France) from 2:30 UT to
4:00 UT on the 21st of July 2003. During this hour and
half an intense thunderstorm occurred in central France.
Optical observations reported 28 sprites in the thunder-
storm region. From these 28 sprites, 12 signatures were
detected in the infrasound recording, 9 signatures were
chirps with an average duration ¯T ≃12-15 seconds as iden-
tiﬁed by visual inspection.

The sprite signatures are not visible in Fig. 1 because
their intensity is very small compared to those of the
slow pressure (f .1 Hz) ﬂuctuations caused by the wind.
But the spectrogram in the range 1 − 10 Hz as in Fig. 2
shows the chirp signature of a sprite. Therefore before
applying any detection method, we high pass ﬁlter the
infrasound recording in order to eliminate the very slow
wind ﬂuctuations (f .1 Hz).

 1.2

 0.8

 0.4

 0

-0.4

)
a
P

(
 
e
r
u
s
s
e
r
P

-0.8
02:30:00

03:00:00

03:30:00

04:00:00

Time (UT)

FIG. 1: The infrasound recording at the Flers station from
2:30 to 4:00 UT on the 21st of July 2003. The values represent
the pressure ﬂuctuations (in Pascal) registered by a micro-
barograph.

III. AUTOMATED DETECTORS AND THEIR
PERFORMANCE

The performance of an automated detector operating
with a threshold τ is measured by the Detection Eﬃ-
ciency DE(τ ) and by the False Alarm rate F A(τ ) . The
number of sprites occurring NO can be obtained from the

log (E(t,f)/(Pa2))

-6

-5

-4

-3

-2

-1

2

 20

 40

 80

 100

 120

 60

t (s)

FIG. 2: A chirp signature of a sprite is identiﬁed plotting
the energy density (spectrogram) E(t, f ) of the signal in the
time-frequency plane for the 1-10 Hz frequency range. This
plot refers to the 2 minute long time interval of the original
data starting at 2:55:30 UT. The time resolution is 0.5 s and
the frequency resolution is 1/256 Hz. This signature exhibits
an extremely good signal to noise ratio.

number of sprites detected ND(τ ) by

NO = ND(τ )

1 − F A(τ )
DE(τ )

.

(1)

The ideal detector has a threshold τ with no false
alarm rate (F A(τ ) = 0) and perfect detection eﬃciency
(DE(τ ) = 1). This implies NO = ND(τ ). The optimal
threshold τ is the best compromise between detection ef-
ﬁciency and false alarm rate. A threshold with zero false
alarm rate and a small detection eﬃciency is not desir-
able because it means that only rare events are detected
(perfect chirp signals unaﬀected by noise). In this case
the number of detected occurrences are aﬀected by noise.
The same is true for a perfect detection eﬃciency but a
large false alarm rate where many detections result from
signatures other than chirps.

Therefore we investigate the properties of the detec-
tion eﬃciency (DE) and the false alarm rate (FA) as a
function of the threshold τ for each detector.

A. The standard deviation detector

The standard deviation detector detects a chirp when
the signal intensity exceeds a given threshold. We calcu-
late the signal intensity changes in the high pass ﬁltered
infrasound recording, by moving a window of length Ls
through the data and evaluating at each time the stan-
dard deviation of the data inside the window. We choose
Ls = 256 data points. This corresponds to a 12.8 seconds
long time interval: a time interval in the expected range
of the average duration ( ¯T ≃12-15 s) of a sprite chirp sig-
nature. The variation of the standard deviation is shown

3

DE(τ)
FA(τ)

 1.2

 1

 0.8

 0.6

 0.4

 0.2

)
τ
(
A
F

 
 
)
τ
(
E
D

in Fig. 3. The horizontal line indicates the threshold
τ = 0.015 Pa., while the bottom diagonal line indicates
the long term trend of the standard deviation. The in-
tensity follows the day-night cycle of temperature, with
a maximum around noon and a minimum around mid-
night. In Fig. 3 the intensity slowly increases as the sun
rise approaches at 4:00 UT.

A detector based on the standard deviation should con-
tinuously scale the threshold to take in account the ef-
fect of change of intensity in time or particularly windy
conditions. Here we use the standard deviation detec-
tor for comparison with the spectral covariance detector
and the CASSANDRA detector. Therefore we use a con-
stant threshold for the entire duration (2 hours) of the
infrasound recording.

Fig. 4 shows the detection eﬃeciency and the false
alarm rate for diﬀerent values of the threshold τ .
It
is evident that the standard deviation detector has no
good compromise between false alarm rate and detec-
tion eﬃciency. For values of τ ≤ 0.017 we have a de-
tection eﬃciency (DE ≥ 0.6 or 60%) but a false alarm
rate (FA ≥ 0.75 or 75%). Raising the threshold lowers
the false alarm rate to about 0.6 (60%) but the detection
eﬃciency decreases to less than 0.3 (30%). These results
for the standard deviation detector are not surprising:
every chirp signature implies an increase in the signal to
noise ratio but the inverse conjecture is not true.

 0.06

 0.05

 0.04

 0.03

 0.02

 0.01

)
a
P

(
 
σ

 0
02:30

03:00

03:30

04:00

Time (UT)

FIG. 3: The variation of the standard deviation σ of the high
pass ﬁltered signal in a 12.8 second long interval. The hor-
izontal dashed line indicates a threshold of 0.015 Pa. The
diagonal dotted line at the bottom shows the increase in in-
tensity of the pressure ﬂuctuations as sun rise approaches.

B. The spectral covariance detector

The spectral covariance detector rests on the appli-
cation of the spectral covariance of the spectrogram to
detect chirp signatures of increasing frequency (Fig. 2).
In this section, we introduce the spectral covariance and

 0
 0.01

 0.015

 0.02

 0.025

 0.03

 0.035

τ

FIG. 4: Standard deviation detector: the Detection Eﬃciency
(squares) and the False Alarm rate (circles) as a function of
the threshold τ .

discuss the performance of the spectral covariance detec-
tor for the infrasound chirp signatures of sprites.

1. Spectral covariance

The Spectrogram of a signal

is its energy density
E(t, f ) in the time-frequency plane. A linear chirp of
increasing frequency will appear as a diagonal line in the
spectrogram (Fig. 2). The inclination of the line with
respect the horizontal axis is proportional to the rate v
at which the frequency of the chirp changes in time. The
spectral covariance uses the covariance between the en-
ergy density E(t, f ) relative to two diﬀerent frequencies
to detect the presence of a diagonal line in the spectro-
gram. The covariance of time delay δ relative to the
frequencies f and f + fs is

Cf,fs (δ) =< E(t, f )E(t + δ, f + fs) >t,

(2)

where < ... >t denotes the time average and fs>0 is the
frequency shift.

For a white noise signal, the computed spectrogram
E(t, f ) is a randomly ﬂuctuating function in both the ar-
guments t and f . Thus, every delay δ has the same prob-
ability of maximizing the covariance Cf,fs (δ). The same
holds true if a periodic component of ﬁxed frequency fo
is superimposed on the noise. In this case, if both f and
f +fs are diﬀerent from fo then E(t, f ) and E(t+δ, f +fs)
are randomly ﬂuctuating functions, if f =fo then E(t, fo)
is constant but E(t + δ, f + fs) is a randomly ﬂuctuat-
ing function and vice-versa. In the case of a linear chirp
with initial frequency fi and ﬁnal frequency ff > fi the
covariance Cf,fs (δ) will have a maximum at δmax 6= 0
whenever the frequencies f and f + fs are in the range
[fi, ff ] or, equivalently,

fs < ff − fi.

(3)

The value δmax is inversely proportional to the rate v at
which the frequency of the chirp is changing:

δmax =

fs
v

.

(4)

Finally, in the case of an impulsive signature (a straight
line) in the spectrogram like the one of the
vertical
thunder produced by a lightning, we expect δmax=0
(v→ +∞).

To use the covariance of Eq. (2) for detecting linear
chirps with a variable frequency range we need to elimi-
nate its dependence on a particular frequency f without
loosing the useful properties in chirp detection. Thus we
average the covariance over all frequencies and deﬁne the
spectral covariance of delay δ and frequency shift fs as

SCfs(δ) =< Cf,fs (δ) >f ,

(5)

where < ... >f denotes the frequency average. The delay
δmax for which the spectral covariance of Eq. (5) holds its
maximum value, has exactly the same properties of the
delay δmax relative to the covariance of Eq. (2). In Fig. 5
we plot the covariance Cf,fs and the spectral covariance
SCfs as a function of the delay δ for the 2 minute long
spectrogram of Fig. 2. The chirp of Fig. 2 produces large
values of the covariance for frequencies f between 3 and 4
Hz and delays δ between 5 and 10 seconds. The spectral
covariance has its maximum for δmax≃6 seconds. This
value of δmax corresponds (Eq. 4) to a rate of frequency
change v≃0.13 Hz/s and an inclination of the chirp sig-
nature in the spectrogram of ≃58o (Fig. 2).

log (Cf,fs

(δ)/(Pa4))

-10

-9

-8

-7

-6

(a)

-5

 20

(b)

SCfs

)
z
H

(
 
f

 1

 3

 5

 7

 9

)

4

a
P
µ
(
 
)
δ
(

s

f

C
S

0.16
0.12
0.08
0.04
0

 0

 5

 15

 10
δ (s)

 10
δ (s)

 0

 5

 15

 20

FIG. 5: (a) The covariance Cf,fs (δ) as a function of the delay
δ (in seconds) for the spectrogram of Fig. 2. Here fs=10/256
Hz (≃0.8 Hz). (b) The spectral covariance SCfs as a function
of the delay δ (in seconds).

can be detected.

4

(6)

the location t is examined and the delay δmax(t) evalu-
ated. Then the interval is shifted and centered to the new
location t + u and the correspondent δmax(t + u) is eval-
uated. Consecutive intervals containing a linear chirp of
increasing frequency will result in consecutive equal val-
ues of the delay δmax(t) 6= 0. For a linear chirp of time
duration ¯T , the number nCEV of consecutive equal values
of the delay δmax is in the range

¯T
u

≤ nCEV .

I
u

.

In real cases a chirp signature in the spectrogram will
produce similar consecutive values of the delay δmax(t).
The automated detection algorithm measures the disper-
sion of nCEV consecutive values of δmax(t) around their
mean. A detection will be reported if the relative disper-
sion (the ratio between the standard deviation and the
average) is below a given threshold τ .

There are some numerical limitations in the evalua-
tion of the spectral covariance SCfs which must be con-
sidered. (1) Numerically, one evaluates the energy con-
tained in a box of dimension ∆t×∆f centered in the
location (t, f ) of the time-frequency plane [10]. The nu-
merical energy density EN UM (t, f ) is obtained dividing
the energy by the dimension of the box. The locations
(t, f ) for which the numerical energy density EN UM (t, f )
is computed belong to a grid of steps δt in the time do-
main and δf in the frequency domain. The intervals
δt and δf are the time and frequency resolution of the
spectrogram, while the intervals ∆t and ∆f are the time
and frequency localization of the spectrogram. Typically,
∆t>δt and ∆f >δf . These numerical limitations impose
a lower bound on the frequency shift fs

fs > ∆f.

(7)

If the condition of Eq. (7) is not satisﬁed, the numerical
energy densities EN UM (t, f ) and EN UM (t, f + fs) used
in the evaluation of the spectral covariance (Eq. 5) refer
to two overlapping intervals of frequencies. In this case
Eq. (4) may not be satisﬁed. (2) The duration I imposes
a limitation on the values of delays δ for which a sta-
tistically meaningful numerical evaluation of the spectral
covariance, is possible. If δR . I is the maximum delay
used in evaluating the spectral covariance, only linear
chirps with a rate of frequency change of

v >

fs
δR

(8)

2. Chirp detection

The spectral covariance detector operates as follows.
An interval of the spectrogram of duration I centered in

3. Application to infrasound from sprites

A visual inspection of the chirp signatures of the 9
sprites present in the infrasound recording examined,
shows that the diﬀerence between the ﬁnal and the ini-
tial frequency of the chirps is ≈2-2.5 Hz. We evaluate the

5

spectrogram with a frequency resolution of 1/256 Hz and
we set the frequency shift fs to 10/256 Hz (0.78125 Hz).
This value of the frequency shift satisﬁes the inequali-
ties of Eqs. (3) and (7). We select I=30 s and δR=20 s.
With this value of δR only chirps with a rate of frequency
change v greater than 0.039 Hz/s can be detected. These
chirps will produce signatures of inclination greater than
27o in a 2 minutes long display of the spectrogram. The
shift u of two consecutive intervals of duration I is chosen
to be equal to 3.2 seconds and consequently (Eq. 6) we
set nCEV =7. Finally we want to exclude the possibility
to detect impulsive signature from lightning. This signa-
tures in theory should produce a δmax=0 s, corresponding
to vertical lines (inclination of 90o) in the spectrogram.
In practice, however, it is better to exclude δmax too close
to zero. We consider only those delays δmax>1.8 s cor-
responding to an inclination of ≃80o in a 2 minute long
display of the spectrogram.

In Fig. 6, we plot the sequence of delay δmax(t) for
the same 2 minute long time interval of the infrasound
recording used for Fig. 2. The presence of the chirp co-
incide with consecutive almost equal values of the delay
δmax(t) (around t=60 s). Before and after the chirp sig-
nature a small number of consecutive similar values of
δmax(t) (around t=20 s and t=100 s) and some isolated
ﬂuctuating values. In Fig. 7, we plot the detection eﬃ-
ciency and the false alarm rate for diﬀerent values of the
threshold τ . As for the standard deviation detector there
is no good compromise between the false alarm rate and
the detection eﬃciency. For values of τ > 0.1 the spectral
covariance detector has a detection eﬃciency of almost
80%, but a false alarm rate superior to 90%. Lowering
the threshold results in a false alarm rate slightly below
80%, but in a drop of the detection eﬃciency from ≃80%
to ≃20%. This behavior of the detection eﬃciency and of
the false alarm rate has two causes. (1) “Spurious” sig-
natures (not from sprite) produce a sequence of values of
δmax with a small (≤0.05 or 5%) relative dispersion. (2)
Sprites signatures may produce sequence of delay δmax
with an large (>0.1 or 10%) relative dispersion.

)
s
(
 
)
t
(

x
a
m

δ

 20

 16

 12

 8

 4

 0

 0

)
τ
(
A
F

 
 
)
τ
(
E
D

 1.2

 1

 0.8

 0.6

 0.4

 0.2

 0

 0.2

 20

 40

 80

 100

 120

 60
t (s)

FIG. 6: The delay δmax (in seconds) for a interval of duration
I of the spectrogram centered at the location t (in seconds).
This plot refers to the same 2 minute long interval of the
original data used for Fig. 2. The dashed line at the bottom
indicates the delays δmax=1.8 s expected for a signature with
a inclination of ≃80o in a 2 minutes long spectrogram.

DE(τ)
FA(τ)

 0.15

 0.05

 0

 0.1
τ

FIG. 7: Spectral covariance detector: the Detection Eﬃciency
(squares) and the False Alarm rate (circles) as a function of
the threshold τ .

1. Diﬀusion entropy analysis

C. The CASSANDRA detector

The detector described in this section derives its name
from the CASSANDRA analysis [11, 12]: an application
of diﬀusion entropy analysis [13, 14] to non stationary
time series [28]. In the following we brieﬂy discuss the
details of the diﬀusion entropy analysis and the changes
to the original [11, 12] formulation of the CASSANDRA
analysis necessary for the detection of chirps. We then
show the results of the application of the CASSANDRA
detector to the infrasound chirp signature of sprites.

The application of the diﬀusion entropy analysis to a
time series is made of two steps. Step 1: use the time
series to create a diﬀusion process. Step 2: monitor,
as diﬀusion takes place, the entropy of the probability
density function (pdf) describing the diﬀusion process.
The behavior of the entropy is indicative of the statistical
properties of the time series analyzed.

The ﬁrst step of the diﬀusion entropy analysis is com-
puting all the possible sums of any n consecutive terms
of the time series {ξj } of length L, namely:

k+n−1

xk,n =

ξj

k = 1, ..., L − n + 1.

j=k
P
and n = 1, ..., L.

k+n−1

(9)

xk,n =

ξj + ξM
j

j=k
X
k+n−1

(cid:0)

(cid:1)
k+n−1

ﬂuctuation {ξj} we can write the sum xk,n of Eq. (9) as

6

=

ξj +

j = xnoise
ξM

k,n + xperiodic

k,n

(12)

j=k
X

j=k
X

k = 1, ..., L − n + 1.

and n = 1, ..., L.

k,n

k,n

ξM
has the
The addition of the periodic component
j
eﬀect of shifting the position xnoise
at time n of the k-th
(cid:9)
(cid:8)
diﬀusion trajectory by the quantity xperiodic
. If n is not
a multiple of the period M , the shift xperiodic
depends on
the index k. Therefore diﬀerent diﬀusion trajectories are
shifted by a diﬀerent quantity. This results in a bigger
“spreading” of the diﬀusion trajectories and therefore in
a larger value of the diﬀusion entropy S(n). When n is
a multiple of the period M , the shift xperiodic
is inde-
pendent from the index k. In this case all the diﬀusion
trajectories are shifted by the same quantity and the dif-
fusion entropy S(n) does not change.

k,n

k,n

Moreover, Fig. 8 shows how the “bending” of the dif-
fusion entropy S(n) becomes smaller and smaller as the
time n increases. The standard deviation of the sum
xnoise
(Eq. 12) of n consecutive terms of the random
k,n
ﬂuctuations {ξj} increases as n increases. The standard
deviation of the sums xperidodic
(Eq. 12) of n consecutive
is limited and it
terms of the periodic component
is periodic of period M : it vanishes whenever n is a mul-
tiple of the period M , it increases, reaches a maximum
and then decreases in between two consecutive periods.
Therefore the contribution to the diﬀusion entropy S(n)
of the periodic component becomes smaller and smaller
compared to that of the random values {ξj } and so does
the “bending” eﬀect.

ξM
j

k,n

(cid:9)

(cid:8)

2. CASSANDRA analysis

The CASSANDRA analysis is the application of the
diﬀusion entropy analysis to smaller intervals of a time
series such that the diﬀerences between the results in
each interval reﬂect the statistical changes occurring in
the time series itself. To compare the diﬀerences between
the diﬀusion entropy of diﬀerent intervals of a time series,
the authors of [11, 12, 28] use the following quantity

CLs(t) =

[St(n) − (St(1) + 0.5 ln(n))] .

(13)

1
N

N

n=1
X

In Eq.(13), t is the position in the time series where the
small interval of length Ls is centered, St is the diﬀusion
entropy relative to this interval of the time series and N
is the maximum time for which the evaluation of St(n) is
statistically meaningful. CLs(t) is the diﬀerence between

This procedure describes a diﬀusion process if we con-
sider the sequence ξj as the sequence of ﬂuctuations of
a diﬀusing trajectory and n as the time for which the
diﬀusion process has taken place. Consequently, each of
the L−n+1 values xk,n can be thought as the position
of a diﬀusion trajectory after a time n starting from the
location 0 at n=0. The second step is computing the pdf
ρ(x, n) of ﬁnding a trajectory in the location x after a
time n and its diﬀusion entropy

S(n) = −

ρ(x, n) ln ρ(x, n)dx.

(10)

Z

The numerical evaluation of S(n) is done by dividing at
each time n the diﬀusion space in cells of equal size ∆(n)
centered around the location xj . The size ∆(n) must be
small enough for the pdf ρ(x, n) to be constant inside the
cell. In this case,

S(n) ≃ −

p(xj, n) ln p(xj , n) + ln ∆(n)

(11)

j
X

with

p(xj , n) = ρ(xj, n)∆(n).

The choice of having a temporal dependence on the cell
size ∆ is due to the necessity of satisfying the condition
ρ(xj , n) constant inside a cell and the probability p(xj, n)
being large enough for a meaningful statistical evaluation
with L−n+1 trajectories at time n (Eq. 9). A choice of
a small ﬁxed size cell will satisfy the former condition
but not the latter when n increases and the diﬀusion
trajectories explore larger intervals of the diﬀusion space.
A time series {ξj } of random uncorrelated numbers
drawn from a distribution of ﬁnite variance generates a
diﬀusion process that rapidly becomes Brownian [29]. As
a consequence, the diﬀusion entropy S(n) will rapidly
approach a regime of linear increase on a logarithmic time
scale with slope 0.5 [30].

(cid:9)

(cid:8)

ξM
j

The addition to the random time series {ξj} of a pe-
with a periodicity of M data
riodic component
points, has the eﬀect of “bending” the diﬀusion entropy:
the periodic component increases the value of S(n) at
times n that are not multiples of M and has no eﬀect
on the value of S(n) at times n multiples of M . As a
consequence, the times n multiple of the period M are
now points of local minima for the diﬀusion entropy S(n).
The “bending” eﬀect is shown clearly in Fig. 8. When
is added to a random noise
a periodic component

ξM
j

(cid:8)

(cid:9)

noise
noise+periodic
slope 0.5

)
n
(
S

 2.5

 4

 3.5

 3

 2

 1.5

 1

 1

 10
n

 100

FIG. 8: The diﬀusion entropy S(n) as function of time n
of gaussian noise (line and white squares) and of gaussian
noise plus a periodic component (line and black squares). The
periodic component has a periodicity of M of 8 data points.
The full line represents the increase of S(n) with a slope of
0.5 on a logarithmic time scale.

the “local” diﬀusion entropy St(n) and one that, starting
from the same value at n = 1, increase with a slope of 0.5
on a logarithmic time scale. Therefore, CLs(t) is an indi-
cation of how diﬀerent the diﬀusion process generated by
the data in the small interval centered at t is from Brown-
ian diﬀusion. The quantity CLs(t) of Eq. (13) is useful in
detecting increases of the diﬀusion entropy St(n) with an
average slope smaller or larger than 0.5 as a result of the
local correlation properties. But in our case, we want to
detect chirps in background noise. Intervals containing
a chirp will result in a “bended” diﬀusion entropy with
the times n of the local minima of St(n) depending on
the chirps instantaneous frequency. For this reason we
evaluate, instead of the quantity deﬁned in Eq. (13), the
cumulative slope change CSCLs(t) and the time ˜nLs(t)
of the ﬁrst local minima of St(n).

The cumulative slope change for a interval of length
Ls centered at the position t of the time series is deﬁned
as

CSCLs(t) =

1
N − 2

N −2

n=0
X

|θt(n + 1) − θt(n)|
ln(n + 2) − ln(n)

,

(14)

where

θt(n) =

St(n + 1) − St(n)
ln(n + 1) − ln(n)

.

(15)

St(n) and N of Eq. (14) are the same quantities as in
Eq. (13), while θt(n) of Eq. (15) is the slope of the line
connecting two consecutive values of the diﬀusion entropy
St(n) when plotted on a logarithmic time scale. The cu-
mulative slope change of Eq. (14) is the weighted sum of
the absolute value of the diﬀerence between two consec-
utive slopes. The weights are the intervals of time (on

7

a logarithmic time scale) during which the slope diﬀer-
ence is evaluated. Slope changes happening at later times
are weighted more. This compensates the fact that the
“bending” of the diﬀusion entropy becomes smaller as n
increases. The cumulative slope change is able to dis-
tinguish intervals of the time series where the diﬀusion
entropy St(n) is “bended” from those where it is not.
The time of the ﬁrst local minima ˜nLs(t) is the ﬁrst time
n for which the conditions θt(n−1) < 0 and θt(n) > 0 are
satisﬁed. If these condition are not met for any n < N
then we set ˜nLs(t) = N . Therefore for an interval of
length Ls centered at the position t which contains only
noise ˜nLs(t) = N [31]. For a sequence of intervals with a
periodic component of ﬁxed period M < N , ˜nLs(t) = M .
Finally for a sequence of intervals containing a chirp sig-
nature ˜nLs(t) will change accordingly to the local chirp
frequency.

3. Chirp detection

For the purpose of chirps detection we need to use
the cumulative slope change CSCLS (t) together with the
time of ﬁrst local minima ˜nLs(t). . We deﬁne the chirp
cumulative slope change cCSCLs(t) as

˜nLS (t) = N
˜nLS (t) = M < N t ∈ J

0 if

(

(16)

CSCLs(t) otherwise

cCSCLS (t) = 



The set J is the set of the all the locations t for which
consecutive constant values of ˜nLS (t) = M < N are en-
countered. The chirp cumulative slope change of Eq. (16)
vanishes for intervals containing only noise or a periodic
component of ﬁxed period M . The CASSANDRA de-
tector detects a chirp when the chirp cumulative slope
change cCSCLs(t) exceeds a given threshold τ .

4. Application to infrasound from sprite

As for the standard deviation detector we choose Ls =
256 corresponding to a 12.8 seconds long time interval.
Moreover, we dichotomize the signal such that every data
point above the average is +1 and every data point be-
low the average is −1. This drastic procedure has three
advantages. (1) The night-day cycle of the intensity in
the infrasound recording (Fig. 3) is eliminated by the
dichotomization. Thus, a unique threshold independent
from the time of day can be set for the purpose of auto-
mated detection. (2) The problem of choosing an appro-
priate value of ∆(n) for diﬀerent times n in Eq. (11) is
simpliﬁed: a unitary cell will be used for all the values of
n explored. (3) The signal to noise ratio is “preserved”
by the dichotomization: a very intense sprite signature
will result in an almost perfect periodic pattern with de-
creasing frequency, while a weak signature will be diﬃcult

8

DE(τ)
FA(τ)

 0.4

 0.45

 0.5

 0.55

 0.6

 0.65

 0.7

 0.75

 0.8

 0.85

τ

FIG. 10: CASSANDRA detector: the Detection Eﬃciency
(squares) and the False Alarm rate (circles) as a function of
the threshold τ .

would expect to get a better false alarm rate lowering the
threshold, but this is not the case (panel (b)). Finally we
see how raising the threshold in the CASSANDRA detec-
tor improves the false alarm rate without compromising
the detection eﬃciency (panel (c)).

CSC(t)
ñ(t)
cCSC(t)

to recognize because the noise will randomly aﬀect the
pattern.

In Fig. 9 we plot the chirp cumulative slope change
cCSCLs(t), the cumulative slope change CSC(t) (for
clarity the cumulative slope change has been moved down
with respect the chirp cumulative slope change) and the
time of the ﬁrst local minima ˜n(t) for the same insert of
2 minutes used for Fig. 2. We clearly see that the chirp
signature produces a big value of the cumulative slope
change and that the time of ﬁrst local minima ˜nLs detects
its change in frequency passing with continuity from 7 to
4. The chirp cumulative slope change of Eq. (16) reduces
the possibility of a false alarm annulling the cumulative
slope change in the case of noise or periodic component
with ﬁxed periodicity.,

Finally, in Fig. 10 we plot the the detection eﬃciency
and the false alarm rate for diﬀerent values of the thresh-
old τ . The CASSANDRA detector has a good compro-
mise between the false alarm rate and the detection eﬃ-
ciency. For a threshold value of 0.8 the false alarm rate
is null and the detection eﬃciency is about 66%.

)
τ
(
A
F

 
 
)
τ
(
E
D

 1.2

 1

 0.8

 0.6

 0.4

 0.2

 0

)
t
(

C
S
C
c
 
 
)
t
(
ñ
 
 
)
t
(

C
S
C

 12

 10

 8

 6

 4

 2

 0

−2

 0

 20

 40

 80

 100

 120

 60

t (s)

FIG. 9: The cumulative slope change CSCLS (squares), the
time ˜n (full line) of the ﬁrst local minima of the diﬀusion
entropy St(n) and the chirp cumulative slope change cCSCLS
(dotted line) as a function of the position t (in seconds). The
plot refer to the same 2 minute long interval of the original
data used for Fig. 2. The cumulative slope change has been
translated down for clarity. The horizontal line at the bottom
indicates a threshold of 0.8.

IV. CONCLUSION

The plots of the detection eﬃciency and false alarm
rate as a function of the threshold τ (Figs. 4, 7 and 10)
indicate that the CASSANDRA detector is the one with
the best trade oﬀ between detection eﬃciency and false
alarm rate. This is conﬁrmed by the plot of Fig. 11. We
see how raising the threshold τ in the case of the stan-
dard deviation detector (panel (a)) does not lower the
false alarm rate. For the spectral covariance detector we

9

(a)

04:00

(b)

04:00

(c)
(c)

03:00

03:30

Time (UT)

03:00

03:30

Time (UT)

)
a
P

(
 
σ

i

i

n
o
s
r
e
p
s
d
 
e
v
i
t
a
e
r

l

C
S
C
c

 0.06

 0.05

 0.04

 0.03

 0.02

 0.01

 0.2

 0.15

 0.1

 0.05

 1.6

 1.2

 0.8

 0.4

 0
02:30

 0
02:30

 0
02:30

03:00

03:30

04:00

Time (UT)

FIG. 11: Comparison between the three diﬀerent detectors
used. (a) The standard deviation detector. (b) The spectral
covariance detector. (c) The CASSANDRA detector. In all
cases the the dashed vertical line indicate the time of the
sprite signatures, while the horizontal dotted lines indicates
a threshold.

[1] “Whistlers and Related Ionospheric Phenomena”, R. A.
Helliwell, Stanford University Press, Stanford (1965).
[2] R. A. Carmona, W. L. Hwang and B. Torresani, IEEE

Trans. Sig. Proc., 45(10), 2586 (1997).

[3] J. K. B. Ford, Canadian Journ. Zool, 69, 1454 (1991).
[4] T. Farges, E. Blanc, A. Le Pichon, T. Neubert and T.
H. Allin, Geophys. Res. Lett., 32, L01813, (doi:10.1029
2004GL021212), (2005).

Virgilio in Emergent Nature ed. by Novak M.M., World
Scientiﬁc, Singapore(2002).

[12] P. Allegrini, V. Benci, P. Grigolini, P. Hamilton, M.
Ignaccolo, G. Menconi, L. Palatella, G. Raﬀaelli, N.
Scafetta, M. Virgilio, J. Yang, Chaos, Solitons & Fractals
15, 517 (2003).

[13] N. Scafetta, P. Hamilton, P. Grigolini, Fractals, 9, 193

[5] P. Tichavsky and P. Handel, Sig. Proc., 43 (5), 1116

[14] P. Grigolini, L. Palatella, G. Raﬀaelli, Fractals, 9, 439

(1995).

30 (4), 1253 (2000).

(2), 553 (2002).

[6] O. Macchi and N. Bershad, Sig. Proc., 39 (3), 583 (1991).
[7] B. Chen and P. Willet, IEEE Trans. Aero. Elect. Syst.,

249, 48 (1990).

[15] R.C. Franz, J.R. Nemzek and J.R. Wrinckler, Science,

[8] Y. Sun an P. Willet, IEEE Trans. Aero. Elect. Syst., 38

[9] B. Carlson, E. Evans and S. Wilson, IEEE Trans. Aero.

Elect. Syst., 30 (1), 102 (1994).

[10] “A Wavelet Tour of Signal Processing” 2nd Edition, S.

Mallat, Academic Press, San Diego (1999).

[11] P.Allegrini, P. Grigolini, L. Palatella, G.Raﬀaelli and M.

[16] H. Fukunishi, Y. Takahashi, M. Kubota, K. Sakanoi, U.
S. Inan, W. A. Lyons, Geophys. Res. Lett., 23 (16), 2157
(1996).

[17] V. P. Pasko, Nature, 423, 927 (2003).
[18] H.T. Su, R.R. Hsu, A.B. Chen, Y.C. Wang, W.S. Hsiao,
W.C. Lai, L.C. Lee, M. Sato, and H. Fukunishi, Nature,
423, 974 (2003).

[19] “NATO Advanced Study Institute on Sprites, Elves and

(2001).

(2001).

intense lightning discharges”, M. Fullekrug, E. Mareev
and M. J. Rycroft, Kluvers, Dordrecht (2005).

[20] J. D. Boccippio, E. R. Williams, S. J. Heckman, W. A.
Lyons, I. T. Baker, and R. Boldi, Science, 269, 1088
(1995).

[21] D. D. Sentman and E. M. Wescott, Geophys. Res. Lett.

20, 2857 (1993).

[22] T. Neubert, T. H. Allin, H. Stenbaek-Nielsen, E. Blanc,

Geophys. Res. Lett., 28 (18), 3585 (2001).

[23] Y. Takahashi, R. Miyasato, T. Adachi, K. Adachi, M.
Sera, A. Uchida and H. Fukunishi, Jour. Atm. and Solar-
Terr. Phys., 65, 551 (2003).

[24] M. Stanley, M. Brook, P. krehbiel and S. A. Cummer,

Geophys. Res. Lett., 27 (6), 871 (2000)

[25] M. SAto and H. Fukunishi, Geophys. Res. Lett., 30 (16),

1859 (doi:10.1029 2003/gl017291), (2003)

[26] L. Lizska, J. Low Freq. Vibr. and Act. Cont., 23 (2), 85

(2004).

[27] E. Blanc, Ann. Geophys., 3, 6673 (1985).

10

[28] M. Ignaccolo, P. Grigolini and G. Gross, Chaos Solitons

& Fractals, 20, 87 (2004).

[29] This is a consequence of the Central Limit Theorem.
[30] For a Brownian diﬀusion the pdf ρ(x, n) can be written
as 1
tδ ) with δ = 0.5 and the function F (y) a Gaus-
sian. In this case, a straightforward calculation shows
that S(n) = A + δ ln n, with A a constant and δ = 0.5.

tδ F ( x

[31] Intervals of a time series including only noise can produce
a diﬀusion entropy S(n) with a ﬁrst local minima ˜nLs <
N particularly when Ls is so small that the statistics
necessary to evaluate S(n) is not optimal. Therefore we
register only the ﬁrst times of local minima which are
statistically relevant. The ﬁrst times of local minima of
S(n) are statistically relevant if θ(n)−θ(n−1)
θ(n)+θ(n−1) > α. In a run
with one million diﬀerent sequences of random gaussian
noise of length Ls = 256 only 0.1% where statistically
relevant if α = 0.3.

