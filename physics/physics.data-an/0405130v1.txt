4
0
0
2
 
y
a
M
 
5
2
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
0
3
1
5
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Detecting non-linearities in data sets. Characterization of Fourier phase maps using
the Weighted Scaling Indices.

Roberto A. Monetti, Wolfram Bunk, Ferdinand Jamitzky, Christoph R¨ath, and Gregor Morﬁll
Center for Interdisciplinary Plasma Science (CIPS) Max-Planck-Institut
f¨ur extraterrestrische Physik Giessenbachstr. 1, 85748 Garching, Germany
(Dated: 2nd February 2008)

We present a methodology for detecting non-linearities in data sets based on the characterization
of the structural features of the Fourier phase maps. A Fourier phase map is a 2D set of points
M = {(φ~k, φ~k+ ~∆)}, where φ~k is the phase of the k-mode of the Fourier transform of the data set
and ~∆ a phase shift. The information thus rendered on this space is analyzed using the spectrum
of weighted scaling indices to detect phase coupling at any scale ~∆. We propose a statistical test
of signiﬁcance based on the comparison of the properties of phase maps created from both the
original data and surrogate realizations. We have applied our method to the Lorenz system and
the logarithmic stock returns of the Dow Jones index. Applications to higher dimensional data are
straightforward. The results indicate that both the Lorenz system and the Dow Jones time series
exhibit signiﬁcant signatures of non-linear behavior.

PACS numbers: 05.45.-a 02.50.-r 89.20.-a

The ﬁrst step in the characterization of a data set is
usually the calculation of the ’linear properties’, i.e. the
power spectrum and the amplitude distribution. How-
ever, in many cases the estimation of higher-order prop-
erties is required. For instance, given an image it is possi-
ble to generate from it a new one by shuﬄing the Fourier
phases. The resulting image may look diﬀerent although
the phase shuﬄing process preserves the power spectrum
of the original one. Then, the Fourier phases contain in-
formation which is beyond the linear properties of the
data, the so-called non-linear properties. A challenging
problem is then the extraction and characterization of the
information contained in the Fourier phases. The phases
are a powerful indicator of the structure of a data set. It
was early noticed that an image synthesized by keeping
the Fourier amplitudes and changing the Fourier phases
retains almost no feature of the original image. How-
ever, image synthesized by keeping the Fourier phases
and changing the Fourier amplitudes conserve most of the
structure observed on the original image [1]. Studies of
Fourier phase coupling are mostly found in the ﬁeld of as-
trophysics where the aim is to characterize the growth of
large-scale structure in the universe [2, 3] and to test for
non-Gaussian signatures in the Cosmic Microwave Ra-
diation Background [4]. Except for these few cases, the
methods to test for non-linearities have never focused
on the analysis of phase correlations, although some of
them are based on phase randomization procedures. This
is probably due to diﬃculties in constructing good es-
timates out of phases since they are circular quantities
(deﬁned modulo 2π) and not translational invariant, as
was already noted in [2, 3, 4]. In this work, we present a
method to analyze the Fourier phase information based
on the assessment of the so called ’Fourier Phase Maps’.
First, the method of surrogates [5, 6, 7, 8, 9] is used
to generate an ensemble of data sets which mimic the
linear properties of the original data set however wip-
ing out higher-order correlations. Then, we generate for

both the original data set and the surrogate data phase
maps which are subsequently characterized by means of
the spectrum of weighted scaling indices [10, 11]. If the
computed measure for the original data is signiﬁcantly
diﬀerent from the value obtained for the surrogate data
set, one can infer that the data were generated by a non-
linear process.

Consider an N -dimensional data set { ~xi} with Fourier
phases {φ~k}. Given a phase shift ~∆ a phase map
is deﬁned as the two dimensional set of points M =
{(φ~k, φ~k+ ~∆)}. All possible wave numbers ~k are consid-
ered up the the Nyquist frequency so as not to include
redundant information. The phase maps posses attract-
ing features which are useful to reveal non-linear prop-
erties. First, it is well known that the Fourier transform
of a random Gaussian variable has uncorrelated and uni-
formly distributed phases in the interval [−π, π]. Then,
the plot of the phase map generated by such a vari-
able will be a uniform point distribution on the square
bounded by y = ±π and x = ±π. Here, we gener-
ate surrogate data sets using the iterative amplitude ad-
justed Fourier transform algorithm (ITAAFT) [7, 8]. By
means of this method, we generate surrogate data sets
which keep the same amplitude distribution in real space
and power spectrum of the original data set however de-
stroying higher-order correlations. It has been recently
demonstrated that this algorithm can be generalized for
two and three dimensional data sets [12, 13]. The surro-
gate method destroys higher-order properties by means
of a phase randomization procedure. Thus, we expect the
phase maps of surrogate data to be more uniform. This
is actually the phase map feature which will be charac-
terized in order to develop a test for non-linearities.

We have used the Scaling Index Method (SIM) to
quantify the structural features of the phase maps. This
technique which was inspired in the analysis of nonlinear
systems [14, 15] has been successfully applied in diﬀerent
ﬁelds of research, ranging from astrophysical to medical

applications [10, 11, 13, 16, 17]. The SIM characterizes
the structural features of a point distribution by means
of the analysis of its local scaling behavior.

We ﬁrst deﬁne a local weighted cumulative point dis-
j sR(d(~xi, ~xj)), where sR(•)
tribution ρ as ρ(~xi, R) =
denotes a kernel function which depends on the scale pa-
P
rameter R and a distance measure d(•). In principle, any
diﬀerentiable kernel function and any distance measure
can be used. The weighted scaling indices α(~xi, R) are
then obtained by calculating the logarithmic derivative
of ρ(~xi, R) with respect to R,

α(~xi, R) =

∂ log ρ(~xi, R)
∂ log R

=

R
ρ

∂
∂R

ρ(~xi, R) .

(1)

We use the Euclidean norm as distance measure and a
set of exponential shaping functions. So, the expres-
sion for ρ simpliﬁes to ρ(~xi, R) =
, where
dij = k~xi − ~xjk. The exponent q controls the weighting
of points according to their distance to the point where α
is calculated. In this study, we use q = 2. The weighted
scaling indices can then be written as

j e−(

dij
R )q

P

α(~xi, R) =

j 2( dij

R )2e−(
dij
j e−(
R )2

P

2

dij
R )

.

(2)

P
It should be noted that the use of shaping functions has
two advantages, namely (i) one obtains an analytical ex-
pression for α(~xi, R), and (ii) the scaling region is only
determined by the parameter R. The scaling-index αi
characterizes the structural surrounding of ~xi. The prob-
ability P (α)dα = Prob(α ∈ [α, α+dα]) is therefore a sta-
tistical measure of the distribution of elementary struc-
tural components. The choice of the scaling region is not
a trivial task and is crucial to obtain meaningful results
using this technique. Although one is normally guided by
the size of the substructures under investigation, various
scaling ranges should be considered in order to obtain
meaningful results.

Consider a 2D nearly uniform phase map. Since the
scaling index α describes the local scaling behavior, most
of the α-values will be close to α = 2, leading to a nearly
Gaussian frequency distribution centered at α = 2. How-
ever, if the phase map contains structure, the frequency
distribution will show a weaker signal around α = 2 and
new α-values will appear. The circular property of the
phases implies that the embedding square is topologically
equivalent to a torus. Then, the calculation of scaling in-
dices was performed using periodic boundary conditions.
We propose a statistical test of non-linearities based
on the P (α) spectrum. First, we generate surrogate data
sets using the ITAAFT algorithm. Then, we create for
the original and the surrogate data sets phase maps for
phase shifts ~∆ = { ~∆1, · · · , ~∆m}, where ~∆m is the maxi-
mum phase shift considered. The signiﬁcance is deﬁned

2

through the following expression

S(α, ~∆l) =

Po(α, ~∆l)− < Ps(α, ~∆l) >
σ(Ps(α, ~∆l))

l = 1, · · · , m,

(3)
where Po is the frequency distribution of the original
phase map, and < Ps > and σ(Ps) are the mean value
and the standard deviation over the frequency distribu-
tions of the phase maps of the surrogate realizations.
Equation (3) is meaningful only when Ps(α, ~∆) are Gaus-
sian distributed. Although there is no proof for this state-
ment, simulations show that mixing processes satisfy this
condition. Then, S is measured in units of standard devi-
ations. As mentioned above, we expect that the original
(non-linear) data set leads to wider P (α) spectra while
the surrogate data sets will produce P (α) spectra with
a stronger signal around α = 2. Then, the statistical
test will give a positive result if the following condition
is satisﬁed

α : S(α, ~∆) < −2.6
α : S(α, ~∆) > 2.6

αi ∈

(

1.90 ≤ α ≤ 2.1,
α elsewhere,

(4)

where the value 2.6 corresponds to 1% of the quantile of
the normal distribution. However, even when the con-
dition given by Eq.
(4) holds we are not certain that
original and surrogate phase maps are signiﬁcantly dif-
ferent since the scaling index is a local structure measure.
In fact, every scaling index value corresponds to a region
on the phase map. Thus, Eq. (4) determines the region
of the phase maps where we can signiﬁcantly diﬀerentiate
between the original and surrogate phase maps. In the
case that this region is tiny, we can not state that the
original and the surrogate phase maps are signiﬁcantly
diﬀerent. In order to address this problem, we deﬁne a
new quantity Ξ through the following expression

V
V

Ξ(~∆) =

Po(αi, ~∆) ,

(5)

αi
X

where αi are the α-values that satisfy Eq. (4). It should
be noted that 0 ≤ Ξ ≤ 1.

Thus, Ξ can be interpreted as the probability to sig-
niﬁcantly distinguish between the original and the sur-
rogate phase maps. The probability Ξ accounts for both
the signiﬁcance and the extent of the region where a non-
uniform structure exists.

We have applied our statistical test to two time se-
ries, namely the z-component of the Lorenz system in a
chaotic regime and the logarithmic stock returns of the
Dow Jones. In both cases, we generate 20 surrogates us-
ing the ITAAFT algorithm and phase shifts in the range
∆ = {1, · · · , 100} are considered. The phase map struc-
ture is analyzed using the SIM with R = 0.8.

Figure 1(a) shows the time series of the z-component of
the Lorenz system in a chaotic regime and a surrogate re-
alization. One can clearly observe diﬀerences between the
time series although they have not only the same ampli-
tude distribution but also the ﬂuctuations show the same

(b)

2
10

0
10

-2

10

)
s
(
F

(b)

-1

10

)
s
(
F

-2

10

4

0

-4

-8

z

-12

-16

0

(a)

)
P
(
g
o
l

 

∆

0

-0.2

-0.4

-0.6

-0.8

(a)

-1

0

Original
Surrogate

Original
Surrogate

10000

20000

30000

∆t

10

-4
0
10

1
10

2
10
s

3
10

4
10

Figure 1: a) Time series of the z-component of the Lorenz
system in a chaotic regime σ = 10, r = 28, and b = 8/3
and below a surrogate realization. b) Log-log plot of the scal-
ing of the ﬂuctuations obtained using the DFA2. The curves
have been shifted to allow for comparison. c) Phase map of
the Lorenz system for ∆ = 1. d) Phase map of a surrogate
realization for ∆ = 1.

5000

10000

days

10

-3
0
10

1
10

2
10
s

3
10

4
10

Original
Surrogate

15000

Original
Surrogate

Figure 2: a) Time series of the logarithmic daily returns of
the Dow-Jones for the period 1930-2003. Below, a surrogate
realization. b) Log-log plot of the scaling of the ﬂuctuations
obtained using the DFA2. The curves have been shifted to
allow for comparison. c) Phase map of the logarithmic returns
of the Dow Jones for ∆ = 1. d) Phase map of a surrogate
realization for ∆ = 1.

scaling behavior (see Fig. 1(b)). The scaling behavior of
the ﬂuctuations was obtained using the Detrended Fluc-
tuation Analysis of order 2 (DFA2) [18]. This analysis is
equivalent to the power spectrum analysis [19]. Figure
1(c) and 1(d) show phase maps for these time series. We
observe that the phase map of the original time series dis-
plays high and low density regions. Although the phase
map of the surrogate time series is actually more uniform,
it still displays a great deal of structure. In fact, most of
the the surrogate realizations of the Lorenz system gener-

3

Figure 3: Frequency distribution of α-values. a) Lorenz sys-
tem. b) Dow Jones index. In both cases, the full line (dashed
line) indicates the original phase map (surrogate phase map).

ated using the ITAAFT algorithm display phase coupling
and only some of them are free from phase correlations.
Figure 3(a) shows the frequency distribution of scaling
indices P (α) for the phase maps shown in Fig. 1. P (α)
of the surrogate realization is narrower and more concen-
trated around α = 2 which is the value expected for a
uniform distribution. Figure 4(a) shows the signiﬁcance
for a phase shift ∆ = 28. We observe that a high signiﬁ-
cance is obtained for a wide range of scaling index values.
The lines at S = 20 were included in intervals where di-
vergencies appear. Figure 4(c) shows the probability Ξ
versus ∆. It indicates that the probability to signiﬁcantly
diﬀerentiate between the original Lorenz time series and
the surrogates oscillates around Ξ ∼ 0.40. As expected,
the Lorenz system shows signatures of non-linear behav-
ior.

Several studies of single stock have focused on the sta-
tistical analyses of the dynamics to model the ﬁnancial
markets [20]. It has been noticed that economic indices
exhibit a non-linear behavior [21, 22] which share some
qualitative features with turbulence [23, 24, 25]. How-
ever, understanding the process that underlies the macro-
scopic behavior of the stocks remains at a speculative
level. As noticed above, the Fourier phases are a pow-
erful indicator of the data structure. It is then relevant
to unveil and quantify the properties of the phases for
stock indices. Typically, the economic indices show a
correlated short-time behavior (few days) which crosses
over to an uncorrelated asymptotic behavior. Figure 2(a)
shows the logarithmic returns of the day to day closing
price of the Dow Jones index in the period 1930-2003 [26]
and a surrogate realization. Figure 2(b) shows the scal-
ing behavior of the ﬂuctuations. The asymptotic regime
is governed by an exponent γ ∼ 0.5 which is the signature
of uncorrelated behavior [18]. However, the phase maps
shown in Fig. 2(c) and 2(d) reveal a new scenario. The
phase map for the original Dow Jones index displays a
high density diagonal band and low density regions. On
the other hand, the phase map for the surrogate real-
ization looks quite uniform. In this case, the ITAAFT
algorithm always generates surrogates free from phase
coupling. Figure 3(b) shows the frequency distribution
of scaling indices for the original and the surrogate phase
maps. The spectrum of scaling indices for the phase map

4

ability Ξ almost vanishes.

We have developed a new test for non-linearities based
on the characterization of the Fourier phase maps using
the SIM. As expected, the Lorenz system showed signa-
tures of non-linear behavior at all ∆ scales. However, we
have noted that for this time series the ITAAFT algo-
rithm is not always able to generate surrogates free from
phase coupling. Then, our method could also be used to
assess the quality of surrogate data sets since the perfor-
mance of the generating algorithms is data dependant.
Even though the ﬂuctuations of the Dow Jones index
display an uncorrelated asymptotic regime, this time se-
ries contains non-linearities which seem to be stronger
than in the Lorenz system. This is probably because the
ITAAFT algorithm is unable to generate surrogates free
from phase coupling for the Lorenz system. Our results
indicate that a novel characteristic scale of non-linearities
∆c exists for the Dow Jones index. These ﬁndings may
be useful to deeper understand the market dynamics and
thus improve the results of risk assessments.

This method can be applied to higher dimensional data
sets since algorithms to generate surrogates in higher di-
mensions are available [12, 13]. In cases where weak non-
linearities may be present as in the Cosmic Microwave
Background of radiation [3, 4], the use of local structure
measures for the assessment of the phase maps, like the
scaling indices, instead of global measures may be more
appropriate since global measures may average important
local details of the maps. The development of quite sen-
sitive tests is particularly relevant for this problem where
the presence or absence of non-Gaussian signatures will
support diﬀerent evolutionary theories of the universe.

Figure 4:
a) Signiﬁcance for Lorenz system. The dashed
horizontal lines at S = ±2.6 indicate 1% of the quantile of
the normal distribution. b) Idem for the Dow Jones index. c)
Probability to signiﬁcantly diﬀerentiate between original and
surrogate phase maps for the Lorenz system. d) Idem for the
Dow Jones index.

of the surrogate realization shows a sharp peak around
α = 2. As occurred for the Lorenz system, Fig. 4(b)
shows that high S values are obtained for a wide range
of scaling indices. Figure 4(d) indicates that there is
a high probability to signiﬁcantly diﬀerentiate between
the original Dow Jones index and the surrogate realiza-
tions for phase shifts up to ∆c ∼ 20. Below ∆c, the
non-linearities appear to be stronger than in the Lorenz
system. However, increasing the phase shift ∆ the prob-

[1] A. Oppenheim and J. Lim, Proc. IEEE 69, 529 (1981).
[2] P. Coles and L. Chiang, Nature 406, 376 (2000).
[3] P. Coles, L. Chiang, and P. Naselsky, MNRAS 337, 488

[4] L. Chiang, P. Naselsky, O. Verkhodanov, and M. Way,

Astrophys. J. 590, L65 (2003).

[5] J. Theiler, S. Eubank, A. Longtin, B. Galdrikian, and

J. Farmer, Physica D 590, 77 (1992).

[6] J. Theiler and D. Prichard, Physica D 110, 221 (1996).
[7] T. Schreiber, Phys. Rev. Lett. 80, 2105 (1998).
[8] T. Schreiber and A. Schmitz, Phys. Rev. Lett. 77, 635

[9] T. Schreiber and A. Schmitz, Physica D 142, 346 (2000).
[10] C. Raeth and G. Morﬁll, J. Opt. Soc. Am. A 14, 3208

(2002).

(1996).

(1997).

[11] F. Jamitzky, R. Stark, W. Bunk, S. Thalhammer,
C. Raeth, T. Aschenbrenner, G. Morﬁll, and W. Heckl,
Ultramicros. 86, 241 (2000).

[12] C. Raeth, W. Bunk, M. Huber, G. Morﬁll, J. Retzlaﬀ,

and P. Schuecker, MNRAS 337, 413 (2002).

[13] C. Raeth and P. Schuecker, MNRAS 344, 115 (2003).
[14] P. Grassberger, R. Badii, and A. Politi, J. Stat. Phys.

51, 135 (1988).

[15] T. Halsley, M. Jensen, L. Kadanoﬀ, I. Procaccia, and

B. Shraiman, Phys. Rev. A 33, 1141 (1986).

[16] H.Boehm, C. Raeth, R. Monetti, D. Mueller, D. Newitt,
S. Majumdar, E. Rummeny, G. Morﬁll, and T. Link, Inv.
Radiol. 38, 269 (2003).

[17] R. Monetti, H. Boehm, D. Mueller, D. Newitt, S. Majum-
dar, E. Rummeny, T. Link, and C. Raeth, Proc. SPIE:
Med. Imag. 5032, 1777 (2003).

[18] C. Peng, S. Buldyrev, S. Havlin, M. Simons, H. Stanley,
and A. Goldberger, Phys. Rev. E 49, 1685 (1994).
[19] C. Heneghan and G. McDarby, Phys. Rev. E 62, 6103

(2000).

[20] Proc. Int. Workshop on Econophysics & Stat. Finance,
Physica A 269, eds. R. Mantegna (Issue 1 1999).

[21] D. Hsieh, J. Finance 46, 1839 (1991).
[22] T.-H. Lee, H. White, and C. Granger, J. Econometrics

56, 269 (1993).

[23] R. Mantegna and E. Stanley, Nature 376, 46 (1995).
[24] S. Ghashghaie, W. Breymann, J. Peinke, P. Talkner, and

Y. Dodge, Nature 381, 46 (1996).

[25] R. Mantegna and E. Stanley, Nature 383, 587 (1996).
is
[26] This
http://ﬁnance.yahoo.com/.

available

freely

data

set

at

