February 9, 2008

2:44 WSPC/Trim Size: 11in x 8.5in for Proceedings

Catasti˙PHYSTAT05˙GPPC

6
0
0
2
 
y
a
M
 
6
1
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
0
3
1
5
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

BIAS-FREE ESTIMATION IN MULTICOMPONENT MAXIMUM LIKELIHOOD FITS
WITH COMPONENT-DEPENDENT TEMPLATES

1

P. CATASTINI

I.N.F.N.-Sezione di Pisa, Universit´a di Siena, Italy
E-mail: pierluigi.catastini@pi.infn.it

G. PUNZI

I.N.F.N.-Sezione di Pisa, Scuola Normale Superiore, Pisa, Italy
E-mail: giovanni.punzi@pi.infn.it

The possibility of strong biases in a multicomponent Maximum Likelihood ﬁts with component-dependent templates
has been demonstrated in some toy problems. We discuss here in detail a problem of practical interest, particle
identiﬁcation based on time-of-ﬂight or dE/dx information. We show that large biases can occur in estimating
particle fractions in a sample if diﬀerences between the momentum spectra of particles are ignored, and we present a
more robust ﬁt technique, allowing bias-free estimation even when the particle spectra in the sample are unknown.

1. Introduction

It has been shown in some toy problems1 that strong
biases may occur in a multicomponent Maximum
Likelihood ﬁt whenever the templates, i.e. the func-
tions, used to parameterize the probability distribu-
tions used in the ﬁt are not ﬁxed but depend on
event observables. An interesting example of such
a problem in the practice of experimental High En-
ergy Physics is the statistical separation of diﬀerent
kinds of particles on the basis of limited–precision
measurements of particle–dependent quantities, like
Time–of–Flight or energy loss (dE/dx).

2. Particle Fractions estimation

Consider a sample of particles generated by a cer-
tain physical process in our experiment. We know
that the given sample is a mixture of known particle
types, for example P ions, Kaons and P rotons, but
unfortunately we don’t know the fractions of each
type, respectively indicated by fπ, fK, fP . Let’s
assume that our experimental apparatus includes a
Particle Identiﬁcation (P ID) device, providing the
measurement of some quantities whose distribution
depends on the particle type. Using this P ID infor-
mation we want to estimate fπ, fK and fP , by means
of an Unbinned Maximum Likelihood ﬁt of our data
sample.

The above problem is very common in particle
physics, for example it occurs in separating diﬀerent
decay modes of a given particle3 (same ﬁnal state
multiplicity and topology but diﬀerent ﬁnal state

particle types), in studies of fragmentation of heavy
quarks2, or in optimizing the performances of algo-
rithms for tagging the ﬂavor of B mesons2.

We will consider two common methods for par-
ticle identiﬁcation: one is based on the measurement
of energy loss of charged particles due to the ion-
ization of a gas or of a semiconductor (often the
same device used to measure particle momentum),
the so called dE/dx measurement; the other is based
on the measurement of the Time-of-Flight (T OF )
of the particle. A common feature of PID devices
based on the above principles is that the separation
power between diﬀerent particles is not a constant,
but strongly depends on the momentum of the given,
unknown, particle. A clear example of this feature is
shown in Fig 1 where the dE/dx mean response of
diﬀerent particles is plotted as a function of momen-
tum in the drift chamber of a typical High-Energy
Physics experiment. Assuming that the resolution of
the measurement is constant, the separation power
dramatical changes in a short momentum range. As
a consequence of the dependence of the mean value
of the P ID response on the particle momentum, the
templates describing the P ID variable’s p.d.f. are
not ﬁxed but depend, on an event-by-event base, on
the momentum of the particle: we clearly are in the
situation described in1 where the templates of the ﬁt
depend on a component of the ﬁt itself.

February 9, 2008

2:44 WSPC/Trim Size: 11in x 8.5in for Proceedings

Catasti˙PHYSTAT05˙GPPC

2.1. The Likelihood expression

P (pidi|momi, typej)

(5)

2

/

>
x
d
E
d
<

32

30

28

26

24

22

20

18

16

14

-110

1

Momentum [GeV/c]

Fig. 1. The mean value of the energy loss of charged particles
as a function of the momentum in a typical experiment.

Consider, for simplicity, only the P ID information
provided by a dE/dx measurement. Our observables
are then the dE/dx (pid) and the momentum of the
track (mom).We will indicate as type the particular
particle hypothesis. Unfortunately, we cannot simply
write the Likelihood function as:

L(fj) =

(
X
Y
i
j=π,K,P

fjP (pidi|momi, typej)).

(1)

Using expression (1) may give a strongly biased re-
sult if our additional variable, the momentum, has
diﬀerent distributions depending on the particle type
(see next section). As discussed in1, whenever the
templates used in a multi–component ﬁt depend on
additional observables, to avoid the bias it is nec-
essary to use the correct, complete Likelihood ex-
pression, including the explicit distributions of all
observables for all classes of events. In our case, the
above implies that we need to include in our Like-
lihood the momentum distributions of each particle
type. We should also notice that in practice those
distributions are almost always diﬀerent.

We then write the correct Likelihood function as:

L(fj) =

(
X
Y
i
j=π,K,P

fjP (pidi, momi|typej)

(2)

=

(
Y
X
i
j=π,K,P

fjP (pidi|momi, typej)

×P (momi|typej)),

with the condition:

fj = 1.

X
j=π,K,P

(3)

3. A toy study

We generated a sample of diﬀerent particle types
with known composition as follow:

• P ID variable is distributed, for each particle, ac-
cording to a typical resolution function (i.e. the
template used in the ﬁt) deﬁned as:

P IDmeasured − P IDexpected(mom)

(4)

Note the dependence on momentum of the ex-
pected P ID.

It is important to note that we have chosen
typical realistic values for all needed parameters.

This distribution represents:

in Eq. (2).

• Momenta of the particles are distributed according
a Gaussian N (µj, σj), where j = π, K, P and:

µπ = 1.00, µK = 1.25, µP = 1.25,

σπ = σK = σP = 0.50.

Those distributions obviously represent:

P (momi|typej)

(6)

of equation 2.

• Particle fractions where ﬁxed to:

fπ = 50%,

fK = 35%,

fP = 15%.

We then used an unbinned Maximum Likelihood ﬁt
to estimate the particle fractions of the sample using
the Likelihood function described in Eq. (2) where:

P (momi|typej) = N (µj, σj ).

(7)

In Fig. 2 (upper plot) the distribution of the estima-
tors for fπ and fP are shown for thirty toy samples of
ten thousand particles each. As expected, the frac-
tions returned by the ﬁt are well centered on the true
values given by the input.

Conversely, the same distributions obtained with
the incomplete Likelihood function of Eq. (1) (Fig.
2, lower plot) are aﬀected by a bias much larger than
the nominal statistical uncertainty of those measure-
ments, due to the diﬀerence in the momentum distri-
bution of each particle type. This demonstrates that
the eﬀect predicted in 1 is actually very signiﬁcant
in real–life problems of Particle Identiﬁcation.

February 9, 2008

2:44 WSPC/Trim Size: 11in x 8.5in for Proceedings

Catasti˙PHYSTAT05˙GPPC

Pion and Proton Fraction Estimators

Pion

Proton

Pion

Proton

25

20

15

10

5

0

25

20

15

10

5

0

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5
Fraction

Pion and Proton Fraction Estimators

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5
Fraction

Fig. 2. The Pion and Proton fraction estimator distributions
when the complete (top) and incomplete (bottom) Likelihood
expression is used.

3.1. The case of unknown momentum

distributions

Writing the complete Likelihood function consider-
ing the distribution of all the observables used in the
ﬁt is relatively straightforward in principle.

On the other hand, in practice, we often have
poor information about those distributions; some-
times they are completely unknown. It is the case,
for example, of the particle fractions produced during
the fragmentation of heavy quarks where the corre-
sponding momentum distributions are unknown and
no functional hypothesis can be made.

Considering what was shown in the previous sec-
tion, we now wonder how to avoid the bias and write
the complete Likelihood if the additional observable
distributions are unknown.

If no speciﬁc functional form can be assumed,
we may want to use a general one, e.g. we could
consider a Series Expansion as a description of the
distributions with the expansion coeﬃcients left as
free parameters to be determined by the ﬁt.

We then write the momentum term of the Like-

lihood function (2):

P (momi, typej) =

amjUm(momi)

(8)

X
m

3

Coming back to our toy sample, we considered
Orthogonal Polynomials as a basis for the expansion.
Amongst a number of possibilities, we selected Sec-
ond Type Chebyshev Polynomials (denoted by Um).
We then replaced in expression (2) the term Eq.
(8) and we performed again the un-
(7) with Eq.
binned Maximum Likelihood Fit, this time by ﬁtting
also the parameters of the polynomial expansion. As
shown in Fig. 3, now the bias is brought back to
zero, as it was when we assumed perfect knowledge of
the individual momentum distributions of each par-
ticle type. We have been able to avoid the bias in

Pion and Proton Fraction Estimators

Pion

Proton

25

20

15

10

5

0

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5
Fraction

Fig. 3. The Pion and Proton fraction estimator distributions
using a Series Expansion as a parameterization of the momen-
tum distribution.

the fraction ﬁt, without any particular assumption
on the functional form of the momentum distribu-
tions. In such a way we simulated the practical case
where no information is known about the additional
observable distributions. Please notice also that just
the ﬁrst seven terms of the Second Type Chebyshev
Expansion were needed in order to parametrize each
particle type momentum distribution. Another in-
teresting aspect is that comparing Fig. 3 to Fig. 2
no signiﬁcant degradation in the resolution of the
estimator is observed, although the number of pa-
rameters is increased. In Fig. 4 the projections of
the ﬁt to the toy sample are shown.

3.2. A more complicated case: Time of

Flight

Suppose that our P ID information is obtained by
the measurement of the Time of Flight. The ex-
pression of the expected TOF is a function of two
observables:

where m is the order and Um are the basis vectors
used for the series expansion.

T OFexpected(mom, L) =

L/c
q1 + (mj/mom)2

(9)

February 9, 2008

2:44 WSPC/Trim Size: 11in x 8.5in for Proceedings

Catasti˙PHYSTAT05˙GPPC

4

1000

900

800

700

600

500

400

300

200

100

25

20

15

10

5

0

700

600

500

400

300

200

100

Total

Pions

Kaons

Protons

Pion

Proton

0
0.5

1

1.5

2

2.5

3
Momentum [GeV/c]

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5
Fraction

Fig. 4. The momentum projections for each particle type su-
perimposed on the corresponding generated distributions.

Fig. 5. The Pion and Proton fraction estimator distributions
using two Series Expansions as a parameterization of the mo-
mentum and the arclength distributions.

L(fj) =

(
X
Y
i
j=π,K,P

fjP (pidimomi, arci|typej)(10)

4. Conclusions

where L is the length travelled by the particle during
its time measurement (arclength) and it is a func-
ton of the production angle of the particle (in the
cylindrical geometry of the TOF detector), c is the
speed of light, mj is the mass of the particle hypoth-
esis j and mom is again the momentum. Both the
momentum and the arclength distributions could be
diﬀerent for each particle type, i.e., both observables
could be source of bias in the particle fractions esti-
mation. Assuming no correlations between the mo-
mentum and the arclength, we have to modify the
expression (2) to be:

=

(
X
Y
i
j=π,K,P

fjP (pidi|momi, typej)

×P (momi|typej)

×P (arci|typej)).

We then added the simulation of the arclength in
our toy sample according to a normal distribution
N (µj, σj ) using the values:

µπ = 90, µK = 100, µP = 110,

σπ = σK = σP = 25.

Considering again the case where no information
is available about the distributions of each particle
type, we used the same technique of the Series Ex-
pansion for both variables. We repeated our ﬁt on
thirty toy samples and also in this case, as shown in
Fig. 5, no bias was observed for our estimator. It
is also interesting to observe that we used just three
terms of the Chebyshev Expansion for the arclength
parameterization, that results in an approximate de-
scription of data (see arclength projections in Fig. 6)
but it doesn’t aﬀect the results of the ﬁt.

Total

Pions

Kaons

Protons

0
50

60

70

80

90

100

110

120

140
130
Arclength [cm]

150

Fig. 6. The arclength projections for each particle type su-
perimposed on the corresponding generated distributions.

In this short paper we focused on a practical and
common problem of particle physics: the estimation
of the particle type fractions using Particle Identiﬁca-
tion information. We showed that a signiﬁcant bias
can arise from the use of an incomplete expression
of the Likelihood under realistic conditions. We also
considered a practical problem where no information
was assumed about an observable. We eliminated the
bias by using Series Expansions of the unknown dis-
tributions in orthogonal polynomials, where the co-
eﬃcients of the expansions are free parameters deter-
mined by the ﬁt. We also considered a more compli-
cated example where two relevant observables have
unknown distributions, and also in this case the Se-
ries Expansion was successful in avoiding biases in
determining the fractions of each component.

References

1. G. Punzi, physics/0401045.
2. K. Anikeev et al., hep-ph/0201071.
3. G. Punzi, in Proceedings of 32nd International Con-
ference on High-Energy Physics (ICHEP04), hep-
ex/0504045.

