6
0
0
2
 
g
u
A
 
7
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
2
7
0
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

H¨older-exponent-MFDFA-based test for
long-range correlations in pseudorandom
sequences

∗
†
, Khristo Tarnev1,3 and Holger Kantz1
,
Nikolay K. Vitanov1,2,

1 Max Planck Institute for the Physics of Complex Systems,
N¨othnitzer Str. 38, 01187, Dresden, Germany
2 Institute of Mechanics, BAS, Akad. G. Bonchev Str., Block
4, 1113 Soﬁa, Bulgaria
3 Department of Applied Physics, Technical University of
Soﬁa,1000 Soﬁa, Bulgaria

Abstract

We discuss the problem for detecting long-range correlations in se-
quences of values obtained by generators of pseudo-random numbers.
The basic idea is that the H¨older exponent for a suﬃciently long se-
quence of uncorrelated random numbers has the ﬁxed value h = 1/2.
The presence of long-range correlations leads to deviation from this
value. We calculate the H¨older exponent by the method of multifractal
detrended ﬂuctuation analysis (MFDFA). We discuss frequently used
tests for randomness, ﬁnite sample properties of the MFDFA, and the
conditions for a correct application of the method. We observe that
the ﬂuctuation function Fq used in the MFDFA reacts to trends caused
by low periodicity presented in the pseudo-random number generator.
In order to select appropriate generators from the numerous programs
we propose a test for the ensemble properties of the generated pseudo-
random sequences with respect to their robustness against presence of
long-range correlations, and a selection rule which orders the genera-
tors that pass the test. Selecting generators that successfully pass the

∗corresponding author
†email:vitanov mpipks-dresden.mpg.de

1

ensemble test and have good performance with respect to the selec-
tion rule is not enough. For the selected generator we have to choose
appropriate pseudo-random sequences for the length of the sequence
required by the solved problem. This choice is based on the close-
ness of the H¨older exponent of the generated sequence to its value 1/2
characteristic for the case of absence of correlations.

1 Pseudorandom sequences, H¨older exponent
and multifractal detrended ﬂuctuation anal-
ysis

Computer random number generators have many applications in physics as
for an example in the Monte Carlo methods [1, 2] or in the nonlinear time
series analysis [3, 4]. Computers implement deterministic algorithms, hence
they are not able to generate sequences of truly random numbers. Thus the
randomness of the sequences is relative: What can be random enough for
one application may not be random enough for another application. The
computer generated sequences are called pseudorandom, and in order to be
appropriate for scientiﬁc applications they have to satisfy many requirements
and must pass extensive statistical tests. For an example the period of the
generator (the number of diﬀerent results before the generator repeats itself)
must be as large as possible. Another requirement is that the generated num-
bers should not be correlated among themselves. A signiﬁcant class of such
correlations are the long-range correlations which decay much slower than
exponentially with time or distance and are observed in many systems in the
Nature [5, 6]. The autocorrelation function cn = hηiηi+ni of a pseudoran-
dom sequence {ηα} ideally should be a Kronecker δn,0. cn is not a convenient
tool for detecting long-range correlations among the numbers in the sequence
since the presence or absence of weak correlation at large n is usually masked
by statistical ﬂuctuations. Hence we have to apply a separate test to detect
them. In this paper we propose such a test which is based on the simple fact
that the H¨older exponent for the sequence of uncorrelated random numbers
has the ﬁxed value of 1/2 (for more details see the Appendix). The deviation
from this value for large n is evidence for possible long-range correlations in
the sequences generated by the used pseudo-random numbers generator.

The H¨older exponent is a measure of irregularity of a curve at a singular

point [7, 8]. Let us consider a function z(t). Its τ -oscillation at value t is

(1)

oscτ (t) = sup
|t−t′|≤τ

z(t′) − inf

z(t′).

|t−t′|≤τ

2

The graph of z(t) is fractal if oscτ (t)/τ → +∞ uniformly with respect to
t. For diﬀerentiable z(t) the ratio osc(t)/(2τ ) tends to dz/dt for τ → 0.
When the limes superior of the ratio is inﬁnite, there is no derivative, and
the H¨older exponent measures the singularity of the graph of z(t) in this
point. A function z(t) is H¨olderian of exponent h if a constant c exists such
that for all t′
(2)

| z(t) − z(t′) |≤ c | t − t′ |h

or in terms of τ −oscillations oscτ (t) ≤ cτ h. If oscτ (t) ≥ cτ h the function z(t)
is anti-H¨olderian of exponent h at the point t. The relation between cn and
the H¨older exponent for the case of Hurst noise is discussed in the Appendix.
We recall from there the relationship (for large n)

(3)

cn = h(2h − 1)n2h−2.

For the case of pure white noise (cn = 0), h = 1/2. When h > 1/2, cn > 0,
i.e., the series of data are correlated and when h < 1/2, cn < 0, i.e., the data
series are anti-correlated.

We shall calculate the H¨older exponent for our pseudorandom sequences
by means of the MFDFA method [9] which is brieﬂy described in the Ap-
pendix. We perform all calculations by means of the MFDFA(1),i.e., linear
ﬁt of the trend in each segment (When the ﬁt is made by polynomial of p-th
order the method is denoted as MFDFA(p)). Our choice p = 1 respects the
fact that no trend is to be expected in the investigated sequences of numbers.
Below we shall discuss a test for long-range correlations and not for a trend
in the generated sequences of pseudorandom numbers. If such a trend exists
it has to be detected by other tests. But even in the case when these addi-
tional tests are not performed the MFDFA reacts to the presence of trends
and nonstationarities. This sensitivity is know to exist for DFA [10, 11] and
as we shall observe below it exists for the case of MFDFA too.

We use as random number generators several generators from [12] namely
ran0, ran2, ran3, a quick and dirty generator which we call qdg as well as the
generator based on the program G05CAF from the NAG library. ran0 is the
minimal standard generator which has to be satisfactory for most applica-
tions but if its parameters are not appropriately chosen the generator can
have correlations. The generator ran2 is claimed to be very good one and
without serial correlations up to limits of its ﬂoating point precision. ran3 is
based on the algorithm due to Knuth [13]. qdg is based on a cycle containing
the lines of code

. . .

3

jran=mod(jran*ia+ic,im)
ran=ﬂoat(jran)/ﬂoat(im)
. . .

where im, ia, ic are appropriately chosen parameters. The above generators
are not tested and compared with respect of long-range correlations.

The paper is organized as follows.

In the following section we discuss
the properties of the investigated generators with respect for standard tests
for randomness. Finite sample properties of the MFDFA method are in-
vestigated in section III in order to select interval of appropriate values for
the parameter q of the method for which the test for randomness has to be
performed. In the section IV the behavior of the ﬂuctuation function of the
MFDFA method is discussed for the investigated generators and it is shown
that the ﬂuctuation function is a good indicator for deviation from fractality
In section V we discuss an en-
and presence of trends in the generators.
semble test for long-range correlations in the random number generators as
well as rules for selection of (i) most appropriate generator for the required
length of the sequence and (ii) most appropriate sequences generated by a
selected generator. Some concluding remarks are summarized in the last
section where we discuss MFDFA(0) and MFDFA(1) with respect to their
sensitivity to detect deviations from the case h = 1/2. In the Appendix we
describe shortly the relationship between the correlation function and the
H¨older exponent as well as the MFDFA method.

2 Behavior of generators with respect to stan-

dard tests

In order to be sure that ran0, ran2, ran3, qdg and G05CAF produce se-
quences close to random ones we have tested them by standard tests such as
a frequency test or a serial correlations test [1]. The general diﬃculty with
statistical test on ﬁnite sequences lies in the statistical ﬂuctuations. For the
latter tests they are perfectly known. We expect that the generators gener-
ate sequences of pseudorandom numbers with histograms uniform in some
interval ( [0, 1] for ran0, ran2, ran3, G05CAF and [−1, 1] for qdg). In order to
perform the frequency test we sort a generated sequence of N numbers into B
bins with expected mean value of the numbers in each bin M = N/B. If the
actual number of random numbers in the j−th bin is Mj we can construct
the quantity

(4)

ν = (1/ν)χ2 = (1/ν){
χ2

[(Mj − M)2/M]}

B

Xj=1

4

with ν = B − 1 degrees of freedom. χ2
ν must be diﬀerent from 0 because of
presence of some ﬂuctuations in a histogram of a ﬁnite sequence of numbers.
However the value of χ2
ν must be not too large because large values are the
evidence for the concentration of numbers in some bins and thus the generator
is not random. χ2 was calculated for ν = 49 degrees of freedom and for a
good random number generator χ2 has the value of about 40 for a sequence
of 50000 pseudorandom numbers. Characteristic values for the investigated
generators are presented in Table I. We note (i) the good performance of the
quick and dirty generator qdg for small length of the generated pseudorandom
sequences opposite to the case of large length of the sequence and (ii) the fact
that the diﬀerent generators have diﬀerent performance for diﬀerent lengths
of the sequence. We can conclude that all generators except the qdg passed
this test and we observe that the choice of the appropriate generator depends
on the lengths of the pseudorandom sequence we need.

As a second test we have calculated the autocorrelation at lag ν

(5)

cν =

1
σ2 h(xn − hxi)(xn−ν − hxi)i

where hxi and σ2 are the mean and the variance of the sequence. Several
typical results for the investigated generators are presented in Table II. The
small values of the autocorrelations show that the generators successfully pass
this test. This fact supports the observation that the long-range correlations
could be quite good masked so that the pseudorandom number generators
with such correlations could pass the standard correlation tests. We can
conclude that except for the cases of very inappropriate generators the stan-
dard tests do not supply us with much information about the question if
the pseudorandom generator we want to use is free from long-range correla-
tions. We have to design other tests to detect such correlations. The test
and rules which are discussed below are based on the use of the H¨older expo-
nent which is calculated by means of the multifractal detrended ﬂuctuation
analysis (MFDFA) method.

3 Finite sample properties of MFDFA

Before we apply the MFDFA method to our pseudorandom number sequences
we have to understand its ﬁnite sample properties. For inﬁnite uncorrelated
sequences of values the H¨older exponent has the ﬁxed value h = 1/2. We dis-
cuss here in detail ﬁnite sample properties of sequences generated by two of
the generators: the generator ran2 which is claimed to be quite good in [12],
and the generator ran0. The investigation of sequences generated by C05CAF

5

and ran3 leads to the same conclusions. We estimate the H¨older exponent
h(q) from a sample of length N for ensemble of pseudorandom sequences (For
the role of the parameter q see the Appendix ). The MFDFA method will
be consistent when h(q) → 1/2 with increasing length N of the sample, and
unbiased when the ensemble average hh(N )(q)i → 1/2. Our observation is
that the MFDFA method is consistent but biased for large | q |. For the in-
vestigation of the ﬁnite sample properties of the two generators we have used
at least 10 ensembles each of 25 random sequences (i.e. at least 250 diﬀerent
sequences). For larger number of sequences in the ensembles the results for
h(q) do not change signiﬁcantly and the only signiﬁcant eﬀect is the decreas-
ing of the standard deviation of the mean. We test the consistency of the
method by keeping parameters unchanged except for the length of the time
series which is increased . Several characteristic results for the generator ran0
are presented in Fig. 1. These results as well the results from other similar
calculations starting from diﬀerent seeds of the generator parameter idum of
ran2 show that the MFDFA method is consistent. However, the method is
biased for large | q | as it can be seen from Fig. 1 and Fig. 2. We observe that
for small | q | (the numerical experiments lead us to the conclusion that small
is | q |≤ 2) h(q) stays around 0.5 but for larger | q | signiﬁcant deviations
exist (i) when we increase the length of the sequence and keep smix and smax
constant (Fig.1), and (ii) when we keep the length of the sequence constant
and increase smax (Fig. 2). A part of the bias of the method for large | q |
can be removed by increasing sample size because for small sample size we
have limited number of values with low probability. Nevertheless our advice
is that all test for long-range correlations must be performed for small | q |.
As generators generate only pseudorandom sequences we can not expect to
obtain exactly 1/2 as a value for h. Our numerical investigation has shown
that diﬀerences of 0.005 are admissible, i.e., the generator (from the point
of view of ensembles of generated sequences) can be considered safe with
respect to long range correlations when for small | q | (between 0 and 2) its
ensemble h(q) spectrum is between 0.495 and 0.505.

4 Behavior of the ﬂuctuation function

When we investigate sequences from a pseudo-random numbers generator
ﬁrst of all we have to check if the ﬂuctuation function Fq(s) from the MFDFA
method really scales as a power of s for diﬀerent values of q. We expect
Fq(s) to be a straight line on the log-log scale (panels (a),(b),(c)) of Fig.3)
. Deviations from this behavior are evidence for a problem. In panel (d) we
see a broken line with a break point approximately at 1/2 of the period of

6

generator which is characteristic for sequences with periodic trend. Hence
the MFDFA method reacts on trends in the generated sequences i.e. it can
be used as a warning message for presence of trends too. In addition, even if
the ﬂuctuation function is a straight line, but the value of h is signiﬁcantly
diﬀerent from 0.5 for small | q |, this is an evidence for presence of long-range
correlations in the sequence of pseudo-random numbers. In panels (a)-(c) of
Fig. 3 we observe that with increasing length of the sequence for ran2 Fq(s)
comes closer to a straight line. This could be expected because the larger
length leads to a better statistics as the form of the sequence histogram
approaches the ideal assumed histogram form. Panel (f) shows a comparison
between ﬂuctuation functions for characteristic sequences generated by ran0
and ran2. We observe that ran2 is more robust than ran0 with respect to
long-range correlations because the ﬂuctuation function lines for diﬀerent q
are closer to straight lines for the case of the generator ran2 for all range
of segment lengths s. Fluctuation functions for ran0 are more dispersed for
large lengths of the segment s.

We haven’t obtained satisfactory results for the generator qdg. This
means that the ﬂuctuation function does not scale as power law of the length
of the segment (as in the case of the vales of im=6075, ia=106, ic=1283), or
the scaling exponent is quite signiﬁcant from 0.5 as for an example in the
case of the values of parameters im=233280, ia=9301, ic=49297.

5 A test and selection rules

On the basis of obtained results we can formulate a test and rules of selection
among pseudo-random numbers generators and among sequences generated
by a generator. The test determines the conditions under which a random
number generator can be considered to generate large amount of sequences
free from long-range correlations. We note here that no absolute test exists,
i.e., a generator can be good for one required length of the sequence but
another generator could be better for another length of the sequence. Let us
have several pseudo-random numbers generators and let us want to choose
these of them which generate large amount of sequences free of long-range
correlations. This choice can be made on the basis of the following test on
the ensembles of pseudorandom sequences.

For a given random number generator take at least 10 diﬀerent ensembles
each of at least 25 pseudorandom sequences and calculate the H¨older exponent
by means of MFDFA(1) method for | q |≤ 2. If for all ensembles the ﬂuctuation
function Fq(s) scales as power law for all q and the H¨older exponent is between
0.495 and 0.505 the random number generator can be considered to be able to

7

generate large amount of sequences free from long-range correlations.

Generators which pass the above test have to be preferred with respect
to generators that fail the test. Thus one can select generators with small
probability of generating sequences possessing long-range correlations (for
the required length of the sequence). The next question which arises is how
to order the appropriate generators and to select one of them. The answer is
given by a selection rule which is based on a power-law scaling property of
the ﬂuctuation function and on closeness of corresponding H¨older exponent
to 1/2 and states

Let us have two pseudo-random numbers generators which pass the above
test. Let us calculate the ﬂuctuation function Fq(s) for at least 10 diﬀerent
ensembles each of at least 25 sequences for the two generators. The generator
which has closer to power law form of Fq(s) for all q and for which the h(q) is
closer to 1/2 is more robust with respect to long-range correlations.

An extensive investigation leaded us to the following ranking of the gen-

erators with respect of the test and the selection rule

1. ran2

2. G05CAF

3. ran3

4. ran0

Despite the fact that a generator passes the test and it is selected by the
selection rule each pseudorandom sequence has to be tested separately i.e.
the generator can be chosen among a manifold of generators but nevertheless
some of its sequences can have long-range correlations among their values.
Therefore after choosing the most appropriate generator (for the required by
the solved problem length of the pseudorandom sequence) we have to test
every generated sequence for presence of long range correlations. The best
sequences are selected by a selection rule which is analogous to the above
selection rule namely that the appropriate sequences have H¨older exponents
most close to 1/2 for | q |< 2. Several results for pseudorandom sequences
from diﬀerent generators are presented in Table III. The sequences are chosen
for illustration of the fact that each generator can generate sequences for
which h is considerably diﬀerent from 1/2.

6 Concluding remarks

In this paper we have used the multifractal detrended ﬂuctuation analysis to
investigate the behavior of the H¨older exponent for sequences of pseudoran-

8

dom numbers obtained by several random number generators. Theoretically
the H¨older exponent for a large enough sequence of random numbers must
have a ﬁxed value h = 1/2 regardless of the order q of the ﬂuctuation func-
tion in the MFDFA method. The deviations from randomness lead to three
kinds of changes: (i) The ﬂuctuation function Fq(s) is not a straight line on
a log-log plot. This is evidence for presence of some trend in the generated
the generator is very bad one; (ii) When Fq(s) scales as a
sequences i.e.
power law of s, h(q) is a straight line signiﬁcantly diﬀerent from 1/2 for all
values of q for | q |≤ 2. This indicates presence of long-range correlations but
if h do not depend on q the generated sequence has monofractal properties
up to smallest investigated length of the segments of the MFDFA; and (iii)
h(q) could be close to 1/2 for some values of | q | but not for all values for | q |
for | q |≤ 2. This means presence of long-range correlations and multifractal
properties of the generated sequences. The existence of bias at large | q |
means that MFDFA must be used very carefully when one calculates charac-
teristic fractal quantities for sequences of values with multifractal properties.
Our case here is a monofractal one (theoretically h has a value, independent
on q) but nevertheless we have to take into account this bias by restriction
on the values of | q |.

The simplest variants of the MFDFA from the point of view of the ﬁtting
polynomial are MFDFA(0) and MFDFA(1). Above we have used MFDFA(1).
It is possible to use MFDFA(0) in the formulated test and selection rules (i.e.
to use MFDFA without local detrending). Let us discuss the properties of
MFDFA(0) and MFDFA(1) with respect to their application to sequences of
pseudorandom numbers. Let us assume that our sequence of pseudorandom
numbers is divided into Ns segments each of length s and let us write the
proﬁle function Y for the ν-th segment as

(6)

Y [(ν − 1)s + i] = i1/2 + δν(i)
where δν(i) is the deviation of Y from i1/2 at the i-th value of the ν-th
segment. For the ﬁtting polynomial we assume

(7)

yν(i) = aνi + bν

where aν and bν are constant coeﬃcients. If aν = bν = 0 we have MFDFA(0)
variant of the MFDFA method. When aν 6= 0 and (or) bν 6= 0 we have the
MFDFA(1) variant of the MFDFA method.

From (6) and (7) we obtain for the variation F 2(ν, s) for the ν-th segment

(for large enough values of s)

F 2(ν, s) =

− aνbνs +

δ2
ν(i) +

2i1/2δν(i) −

s
2

1
s

s

Xi=1

9

1
s

s

Xi=1

(8)

(9)

where

(10)

(11)

where

(12)

(13)

2aν
s

s

Xi=1

iδν(i) −

δν(i) +

2bν
s

s

Xi=1

νs2
a2
2

+ b2

ν −

aνs3/2 − bνs1/2

Let for simplicity below q = 2. Then for the ﬂuctuation function we have

F2(s) =

P + Q + S

q

2Ns

(cid:19)
contains the terms corresponding to the ideal case,

Xν=1 (cid:18)

P =

1
2Ns

s
2

− aνbνs

Q = Q∗ + Q∗∗

Q∗ =

1
2sNs

Q∗∗ =

1
2sNs

s

2Ns

Xi=1
2Ns

Xν=1
2Ns

Xi=1

Xν=1

[δ2

ν(i) + 2i1/2δν(i)]

[2aνiδν(i) − 2bνδν(i)]

are the terms containing the ﬂuctuations δν(i). Q∗ depends only on the
ﬂuctuations and Q∗∗ depends on the ﬂuctuations and on the trend. Finally

(14)

R =

2Ns

1
2Ns

aνs2
2

+ b2

ν − aν3/2 − bνs1/2

Xν=1  
contains the terms which depend only on the local trend.

!

For the case of MFDFA(0) (aν = bν = 0) P = Q∗∗ = 0. In the ideal case
Q∗ should be negligible and F2(2) ∝ s1/2 for large s i.e. the H¨older exponent
is h = 1/2. In the real case Q∗ could lead to deviation from h = 1/2 and if
these deviations are large this is an indicator for presence of problems in the
generated sequence.

For the case of MFDFA(1) the sensitivity can be higher as we have more
terms that can aﬀect the value of the H¨older exponent. The term P in
this case is again proportional to s1/2 independent on the values of the local
trend coeﬃcients aν and bν. For large enough s and large enough sequence
of random numbers all other terms should be negligible and h ∝ 1/2.
In
the real situation deviations can come from Q∗, Q∗∗ and from R which for
large s is proportional to s2. When the local trends are correlated (i.e. some

10

kind of global trend is presented) then R ( which for large s could become
larger than P ) could lead to h close to 1 instead to h ≈ 1/2 as in the case
without long-range correlations. Similar situation is observed for other values
of q. For an example when q = 4 the term P is a sum of terms of the kind
s2(1/4 + 2a2
ν + aνbν) (i.e. P ∝ s2) and the dominant for large s member
of R is proportional to s4. In summary if we do not want to use MFDFA
with local detrending we can base our test and rules on MFDFA(0). In this
case the deviation from the ideal case (i.e. from h = 1/2) is evaluated on the
basis of quantities like Q∗. When we use MFDFA(1) we can gain additional
sensitivity with respect to deviations of h from 1/2.

νb2

Finally we note that the MFDFA is not the only possibility for calculation
of H¨older exponent. Another method is the WTMM (wavelet transform
modulus maxima) method [14, 15, 16, 17, 18]. MFDFA is shown to have
slight advantages for negative q and short time series [9]. For long time
series the WTMM could have advantages with respect to MFDFA and thus
for length of sequences larger than 107 values the formulated tests above
should be used on the basis of the results of the WTMM method. In such a
case instead of scaling of the ﬂuctuation function Fq(s) one has to study the
scaling of the partition function Zq(a) used in the WTMM.

7 Acknowledgments

N.K.V. thanks to Alexander von Humboldt Foundation and to NFSR of the
Ministry of Education and Science of Bulgaria for support of his research
through the Grant # MM 1201/02.

A The importance of the exponent h and MFDFA

Let us consider the general one-dimensional random walk in discrete time. It
is a sum of steps which can be either discrete or continuous. Let the walking
particle starts at the origin. After N steps its position XN is a sum of N
mutually independent random variables. We are interested in a situation
when these variables have the same distribution function F of mean µ and
ﬁnite variance σ2. It can be shown on the basis of the central limit theorem
that for large N XN is approximately normally distributed with mean Nµ
and variance Nσ2 [19, 20, 21]. Thus the standard deviation of this random
walk scales as N h with h = 1/2.

In order to understand better the H¨older exponent h let us consider a
sequence of observations ηi, i = 1, 2, , . . . , N. We choose a reference size m0

11

and sizes m such that mp = N, where p is the number of segments each
of size m. For ﬁxed m we calculate the mean value M(m) and the stan-
dard deviation S(m) for each segment and construct the relative dispersion
R(m) = S(m)/M(m). From general manifold of all possible data sequences
we shall consider these for which we can observe

(15)

[R(m)/R(m0)] = (m/m0)h−1,

where for simplicity we consider h to be a constant. Mandelbrot [7] calls
similar ﬂuctuations and noise Hurst noise in order to notify the important
contribution of Hurst [22] to the research of processes with long-range corre-
lations. By means of (15) we obtain a system of equations for the correlation
functions
(16)

cτ = hηiηi+τ i = C1/C2

where

(17)

(18)

C1 = [N/(N − τ )]

ηiηi+τ − (

ηi)2/N

N −τ

Xi=1

N

Xi=1

N

C2 =

η2
i − (

ηi)2/N,

N

Xi=1

Xi=1
for τ = 1, 2, . . . , n. The system is

(19)

(n − 1)ci = (1/2)

n2h − n
(cid:17)
(cid:16)

n−1

Xi=1

and it has the solution [23, 24]

(20)

cn = (1/2)n2h

(1 + (1/n))2h − 2 + (1 − (1/n))2h
h

i

.

For very large value of n we can represent the term in [. . .] as Taylor series
and as a result we obtain the relationship between the autocorrelation and
the H¨older exponent
(21)

cn = h(2h − 1)n2h−2.

Recently a multifractal detrended ﬂuctuation analysis method has been
proposed for the analysis of long-range correlation of nonstationary time
series [9]. Here we present the variant of the method useful for calculation of
signiﬁcantly diﬀerent from zero positive H¨older exponents. The ﬁrst step of
the method is to calculate the mean hxi of the investigated time series. Then
i
we calculate the proﬁle function Yi =
i = 1, 2, . . . , N. After
k=1(xk−hxi),
calculation of Yi we divide the time series into segments and calculate the
P
variation for each segment. The division is into Ns =int(N/s) segments and

12

because the obtained segments would not include some data at the end of the
investigated time series, additional Ns segments are added, which start from
the last value of the sequence in the direction to the ﬁrst value of sequence.
In order to calculate the variation we have to calculate the local trend (the
ﬁtting polynomial yν(i) for each segment of length s where s is between an
appropriate minimum and maximum value). The variations are deﬁned as

(22)

F 2(ν, s) =

{Y [(ν − 1)s + i] − yν(i)}2

for the ﬁrst Ns segments and

(23)

F 2(ν, s) =

{Y [N − (ν − N)s + i] − yν(i)}2

s

Xi=1

1
s

s

1
s

Xi=1

for the second Ns segments. Finally we construct the q-th order ﬂuctuation
function

(24)

Fq(s) = {[1/(2Ns)]

[F 2(ν, s)]q/2}1/q.

2Ns

Xν=1

For monofractal time series Fq(s) has to scale as s of constant power h which
for sequences of random numbers has the value 1/2. Even in presence of
local correlations extending up to a characteristic range s∗ the exponent
h = 1/2 would be unchanged when s >> s∗. If the correlations do not have
characteristic lengths the exponent h would be diﬀerent from 1/2 [25, 26].

References

[1] S. S. M. Wong. Computational Methods in Physics and Engineering.

World Scientiﬁc, Singapore, 1997.

[2] G. S. Fishmann. Monte Carlo. Concepts, Algorithms and Applications.

Springer, New York, 1996.

[3] H. Kantz and T. Schreiber. Nonlinear Time Series Analysis. Cambridge

University Press, Cambridge, 1997.

[4] R. Hegger, H. Kantz, and T. Schreiber. CHAOS, 9:413–435, 1999.

[5] H. E. Stanley, S. V. Buldirev, A. L. Goldberger, S. Havlin, C. K. Peng,

and M. Simons. Physica A, 200:4–24, 1993.

13

[6] H. E. Stanley, S. V. Buldirev, A. L. Goldberger, Z. D. Goldberger,
S. Havlin, R. N. Mantegna, S. M. Ossadnik, C. K. Peng, and M. Si-
mons. Physica A, 205:214–253, 1994.

[7] B. B. Mandelbrot. The Fractal Geometry of Nature. Freeman, New

York, 1982.

[8] C. Tricot. Curves and Fractal Dimension. Springer, New York, 1995.

[9] J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde, S. Havlin,

A. Bunde, and H. Eugene Stanley. Physica A, 316:87–114, 2002.

[10] K. Hu, P. Ch. Ivanov, Z. Chen, P. Carpena, and H. Eugene Stanley.

Phys. Rev. E, 64:011114, 2001.

[11] Z. Chen, P. Ch. Ivanov, K. Hu, and H. Eugene Stanley. Phys. Rev. E,

65:041107, 2002.

[12] W. H. Press, A. Teukolsky, W. T. Vetterling, and B. P. Flannery. Nu-
merical Recipes in Fortran. The Art of Scientiﬁc Computing. Cambridge
University Press, Cambridge, 1992.

[13] D. E. Knuth. The Art of Computer Programming, vol. 2 Seminumerical

Algorithms. Addison-Wesley, Reading, MA, 1981.

[14] J. F. Muzy, E. Bacry, and A. Arneodo. Phys. Rev. Lett., 67:3515–3518,

1991.

74:3293–3296, 1996.

[15] A. Arneodo, E. Bacry, P. V. Graves, and J. F. Muzy. Phys. Rev. Lett.,

[16] A. Arneodo, Y. d’Aubenton Carafa, E. Bacry, J. F. Muzy, and C. Ther-

mes. Physica D, 96:291–320, 1996.

[17] A. Arneodo, S. Maneville, J. F. Muzy, and S. G. Roux. Phil. Trans. R.

Soc. London A, 357:2415–2438, 1999.

[18] A. Arneodo, N. Decoster, P. Kestener, and S. G. Roux. Advances in

Imaging and Electron Physics, 126:1–92, 2003.

[19] Y. G. Sinai. Probability Theory. Springer, Berlin, 1992.

[20] D. R. Cox and H. D. Miller. The Theory of Stochastic Processes. Chap-

man & Hall, London, 1965.

14

[21] G.H. Weiss. A Primer in Random Walkology. p.p.120-161 in A. Bunde

and S. Havlin (eds.) Fractals in Science, Spinger, Berlin, 1994.

[22] H. E. Hurst, R. P. Black, and Y. M. Simaika. Long Term Storage, An

Experimental Study. Constable, London, 1965.

[23] J. B. Bassingthwaighte and R. P. Beyer. Physica D, 53:71–84, 1991.

[24] J. B. Bassingthwaighte, L. S. Liebovitch, and B. J. West. Fractal Phys-

iology. Oxford University Press, New York, 1994.

[25] A. Bunde and S. Havlin (Eds.). Fractals in Science. Springer, Berlin,

1994.

[26] G. Rangarajan and M. Ding (Eds.). Processes with Long-Range Corre-

lations. Springer, Berlin, 2003.

15

Table 1: χ2 test for several pseudorandom number generators. idum=2 for
ran0, ran2, ran3. im=6075, ia=106, ic=1283 for qdg.

Number of points
104
105
106
107

ran0
46.30
46.29
42.04
41.25

ran2
39.83
44.38
43.29
57.33

ran3
45.13
57.13
38.84
41.38

qdg
7.14
2.35
16.54
165.84

G05CAF
42.25
41.34
59.68
56.35

Table 2: Autocorrelations cν for several pseudorandom number generators.
Length of generated sequences is 105 values.
idum=2 for ran0, ran2, ran3.
im=6075, ia=106, ic=1283 for qdg.
ran3
-0.0013
-0.0076
-0.0061
-0.0023

qdg
0.0017
-0.00009
-0.000098
-0.0048

ran2
-0.00098
-0.0033
0.0043
0.0013

G05CAF
0.00086
0.0018
0.0055
0.0019

ran0
-0.0061
-0.0008
-0.0029
-0.0045

ν
102
103
104
5 · 104

Table 3: H¨older exponent h for several pseudorandom number generators.
Length of the pseudorandom sequences: 106 values.
initialized with
G05CBF(0). ∗∗: initialized with G05CBF (2).

∗:

generator
ran0 (idum=10)
ran0 (idum=20)
ran2 (idum=10)
ran2 (idum=20)
ran2 (idum=4)
ran3 (idum=10)
ran3 (idum=20)
ran3 (idum=2)
G05CAF ∗
G05CAF ∗∗

q=-2.95
0.500 ± 0.005
0.543 ± 0.004
0.536 ± 0.005
0.533 ± 0.007
0.489 ± 0.006
0.513 ± 0.005
0.470 ± 0.004
0.499 ± 0.005
0.479 ± 0.007
0.494 ± 0.005

q=-1.95
0.501 ± 0.004
0.542 ± 0.004
0.535 ± 0.005
0.534 ± 0.006
0.489 ± 0.006
0.512 ± 0.005
0.469 ± 0.004
0.499 ± 0.005
0.479 ± 0.006
0.495 ± 0.004

q=-0.95
0.502 ± 0.004
0.540 ± 0.004
0.535 ± 0.005
0.534 ± 0.006
0.489 ± 0.006
0.510 ± 0.004
0.469 ± 0.004
0.500 ± 0.005
0.480 ± 0.006
0.495 ± 0.004

q=0.05
0.503 ± 0.004
0.539 ± 0.004
0.535 ± 0.005
0.535 ± 0.005
0.489 ± 0.005
0.508 ± 0.004
0.470 ± 0.004
0.501 ± 0.004
0.481 ± 0.005
0.496 ± 0.004

q=1.05
0.505 ± 0.003
0.537 ± 0.004
0.535 ± 0.005
0.535 ± 0.005
0.489 ± 0.005
0.506 ± 0.004
0.470 ± 0.004
0.502 ± 0.004
0.482 ± 0.005
0.497 ± 0.004

0.506
0.535
0.536
0.536
0.489
0.504
0.470
0.503
0.483
0.498

16

0.44

−20

−10

10

20

h

0.5

h

0.56

0.54

0.52

0.48

0.46

0.56

0.54

0.52

0.5

0.48

0.46

0.44

0.56

0.54

0.52

0.48

0.46

h

0.5

(a)

(b)

(c)

0
q

0
q

0
q

−20

−10

10

20

0.44

−20

−10

10

20

Figure 1: Inﬂuence of the length of sequence on the h(q) spectrum. Generator
ran0, ensemble averages for ensemble of 25 time series. The segment length s
is between smin = 10 and smax = 1000 for all panels. The lengths of sequences
are 104 points for panel (a) 105 points for panel (b) and 106 points for panel
(c). The h(q) spectra are denoted by solid lines and the dashed lines denote
the correspondent h(q) spectrum plus/minus the standard deviation of the
mean for the correspondent value of q.

17

h

0.5

h

h

0.56

0.54

0.52

0.5

0.48

0.46

0.44

0.56

0.54

0.52

0.48

0.46

0.56

0.54

0.52

0.5

0.48

0.46

0.44

−20

−10

10

20

0.44

−20

−10

10

20

(a)

(b)

(c)

0
q

0
q

0
q

−20

−10

10

20

Figure 2: Inﬂuence of the length of segment s on the h(q) spectrum of the gen-
erator ran2. The investigated sequences of numbers are obtained for idum=2
and have length of 250000 values. The h(q) spectrum is denoted by a solid
line. The two doted lines denote the h(q) spectrum plus/minus the standard
deviation of the mean for the correspondent value of q. Panel (a): h(q) spec-
trum for s between smin = 10 and smax = 1000. Panel (b): h(q) spectrum
for s between smin = 100 and smax = 10000. Panel (c): h(q) spectrum for s
between smin = 1000 and smax = 25000.

18

2

10

1

10

Fq(s)

0

10

2

10

1

10

Fq(s)

0

10

10

-1
10

1

(a)

(b)

(c)

-1

10

1

10

2

10
s

3

10

-1

10

1

10

2

10
s

3

10

-1

10

1

10

2

10
s

3

10

2

10

1

10

Fq(s)

0

10

2

10

Fq(s)
10

1

0

10

10

-1
10

2

2

10

1

10

Fq(s)

0

10

2

10

1
10
Fq(s)

0

10

1

10

(d)

(e)

(f)

2

10

3

10

s

4

10

3

10

4

10

s

5

10

2
10
s

3
10

Figure 3: Fluctuation function Fq(s) for the pseudorandom sequences from
ran2 and ran0. From bottom to the top at each panel the lines are for q =
2, 4, 6, 8. Panels (a)-(c): Results for ran2, idum=2. Panel (a): Fluctuation
functions for a sequence of 104 points. The values of the H¨older exponent
are: h = 0.505 ± 0.002 (q = 2); h = 0.505 ± 0.004 (q = 4); h = 0.503 ± 0.004
(q = 6); h = 0.499 ± 0.005 (q = 8). Panel (b): Fluctuation function for
a sequence of 105 points. h = 0.499 ± 0.001 (q = 2); h = 0.501 ± 0.001
(q = 4); h = 0.505 ± 0.002 (q = 6); h = 0.509 ± 0.003 (q = 8). Panel (c):
Fluctuation function for a sequence of 106 points. h = 0.500±0.0004 (q = 2);
h = 0.502 ± 0.001 (q = 4); h = 0.504 ± 0.001 (q = 6); h = 0.506 ± 0.001
(q = 8). Panel (d): Fluctuation function for ran0 with parameters a = 343,
q = 127773, r = 2836, m = aq + r = 43828975 . Period of the generator is
4880, idum=2. Panel (e): Fluctuation function for random number generator
ran0 with parameters a = 16807, q = 127773, r = 2836, m = aq + r =
idum=2, sequence of 106 values. h = 0.511 ± 0.003 for q = 2;
2147483647.
h = 0.506 ±0.003 for q = 4; h = 0.501 ±0.002 for q = 6; h = 0.498 ±0.002 for
q = 8. a = 16807, q = 127773, r = 2836, m = aq + r = 2147483647 for ran0.
Panel (f): Comparison between ﬂuctuation functions for sequences generated
by the generators ran0 and ran2. Length of the sequences 105 points. idum=2
for the two generators. Parameters of the generators a = 16807, q = 127773,
r = 2836, m = aq + r = 2147483647 for ran0. Circles: Fluctuation functions
for ran2. Squares: Fluctuation functions for ran0. Solid lines: Power-law ﬁts
for the sequence generated by ran2. From bottom to the top: q = 2, 4, 6, 8.

19

