2
0
0
2
 
b
e
F
 
7
2
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
0
2
0
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Multifractal Detrended Fluctuation Analysis of Nonstationary Time Series

Jan W. Kantelhardt1,2, Stephan A. Zschiegner1, Eva Koscielny-Bunde3,1, Armin Bunde1,
Shlomo Havlin4,1, and H. Eugene Stanley2
1 Institut f¨ur Theoretische Physik III, Justus-Liebig-Universit¨at, D-35392 Giessen, Germany
2 Center for Polymer Studies and Department of Physics, Boston University, Boston MA 02215, USA
3 Potsdam Institute for Climate Impact Research, P. O. Box 60 12 03, D-14412 Potsdam, Germany
4 Department of Physics and Gonda-Goldschmied Medical Diagnostics Research Center, Bar-Ilan University, Ramat-Gan 52900, Israel

We develop a method for the multifractal characterization of nonstationary time series, which is based on
a generalization of the detrended ﬂuctuation analysis (DFA). We relate our multifractal DFA method to the
standard partition function-based multifractal formalism, and prove that both approaches are equivalent for
stationary signals with compact support. By analyzing several examples we show that the new method can
reliably determine the multifractal scaling behavior of time series. By comparing the multifractal DFA results
for original series to those for shufﬂed series we can distinguish multifractality due to long-range correlations
from multifractality due to a broad probability density function. We also compare our results with the wavelet
transform modulus maxima (WTMM) method, and show that the results are equivalent.

PACS numbers: 05.40.-a, 05.45.Tp

I. INTRODUCTION

In recent years the detrended ﬂuctuation analysis (DFA)
method [1] has become a widely-used technique for the de-
termination of (mono-) fractal scaling properties and the de-
tection of long-range correlations in noisy, nonstationary time
series [2–5]. It has successfully been applied to diverse ﬁelds
such as DNA sequences [1,6], heart rate dynamics [7,8], neu-
ron spiking [9], human gait [10], long-time weather records
[11], cloud structure [12], geology [13], ethnology [14], eco-
nomics time series [15], and solid state physics [16]. One
reason to employ the DFA method is to avoid spurious detec-
tion of correlations that are artifacts of nonstationarities in the
time series.

Many records do not exhibit a simple monofractal scaling
behavior, which can be accounted for by a single scaling ex-
In some cases, there exist crossover (time-) scales
ponent.
s× separating regimes with different scaling exponents [3,4],
e. g. long-range correlations on small scales s ≪ s× and an-
other type of correlations or uncorrelated behavior on larger
scales s ≫ s×. In other cases, the scaling behavior is more
complicated, and different scaling exponents are required for
different parts of the series [5]. This occurs, e. g., when the
scaling behavior in the ﬁrst half of the series differs from the
scaling behavior in the second half.
In even more compli-
cated cases, such different scaling behavior can be observed
for many interwoven fractal subsets of the time series. In this
case a multitude of scaling exponents is required for a full de-
scription of the scaling behavior, and a multifractal analysis
must be applied.

In general, two different types of multifractality in time se-
ries can be distinguished: (i) Multifractality due to a broad
probability density function for the values of the time series.
In this case the multifractality cannot be removed by shuf-
ﬂing the series. (ii) Multifractality due to different long-range
(time-) correlations of the small and large ﬂuctuations. In this
case the probability density function of the values can be a

1

regular distribution with ﬁnite moments, e. g. a Gaussian
distribution. The corresponding shufﬂed series will exhibit
non-multifractal scaling, since all long-range correlations are
destroyed by the shufﬂing procedure. If both kinds of mul-
tifractality are present, the shufﬂed series will show weaker
multifractality than the original series.

The simplest type of multifractal analysis is based upon the
standard partition function multifractal formalism, which has
been developed for the multifractal characterization of nor-
malized, stationary measures [17–20]. Unfortunately, this
standard formalism does not give correct results for nonsta-
tionary time series that are affected by trends or that cannot
be normalized. Thus, in the early 1990s an improved multi-
fractal formalism has been developed, the wavelet transform
modulus maxima (WTMM) method [21], which is based on
wavelet analysis and involves tracing the maxima lines in the
continuous wavelet transform over all scales. Here, we pro-
pose an alternative approach based on a generalization of the
DFA method. This multifractal DFA (MF-DFA) does not re-
quire the modulus maxima procedure, and hence does not in-
volve more effort in programming than the conventional DFA.
The paper is organized as follows: In Section II we de-
scribe the MF-DFA method in detail and show that the scal-
ing exponents determined via the MF-DFA method are iden-
tical to those obtained by the standard multifractal formalism
based on partition functions. In Section III we introduce sev-
eral multifractal models, where the scaling exponents can be
calculated exactly, and compare these analytical results with
the numerical results obtained by MF-DFA. In Section IV, we
show how the comparison of the MF-DFA results for original
series to the MF-DFA results for shufﬂed series can be used to
determine the type of multifractality in the series. In Section
V, we compare the results of the MF-DFA with those obtained
by the WTMM method for nonstationary series and discuss
the performance of both methods for multifractal time series
analysis.

II. MULTIFRACTAL DFA

A. Description of the method

The generalized multifractal DFA (MF-DFA) procedure
consists of ﬁve steps. The ﬁrst three steps are essentially iden-
tical to the conventional DFA procedure (see e. g. [1–5]). Let
us suppose that xk is a series of length N , and that this series
is of compact support, i.e. xk = 0 for an insigniﬁcant fraction
of the values only.
• Step 1: Determine the “proﬁle”

i

Xk=1

Y (i) ≡

[xk − hxi] ,

i = 1, . . . , N.

(1)

Subtraction of the mean hxi is not compulsory, since it would
be eliminated by the later detrending in the third step.
• Step 2: Divide the proﬁle Y (i) into Ns ≡ int(N/s) non-
overlapping segments of equal length s. Since the length N of
the series is often not a multiple of the considered time scale s,
a short part at the end of the proﬁle may remain. In order not to
disregard this part of the series, the same procedure is repeated
starting from the opposite end. Thereby, 2Ns segments are
obtained altogether.
• Step 3: Calculate the local trend for each of the 2Ns seg-
ments by a least-square ﬁt of the series. Then determine the
variance

F 2(s, ν) ≡

{Y [(ν − 1)s + i] − yν(i)}2

(2)

for each segment ν, ν = 1, . . . , Ns and

F 2(s, ν) ≡

{Y [N − (ν − Ns)s + i] − yν(i)}2

(3)

s

i=1
X

1
s

s

1
s

i=1
X

for ν = Ns +1, . . . , 2Ns. Here, yν(i) is the ﬁtting polynomial
in segment ν. Linear, quadratic, cubic, or higher order poly-
nomials can be used in the ﬁtting procedure (conventionally
called DFA1, DFA2, DFA3, . . .) [1,8]. Since the detrending
of the time series is done by the subtraction of the polynomial
ﬁts from the proﬁle, different order DFA differ in their capa-
bility of eliminating trends in the series. In (MF-)DFAm [mth
order (MF-)DFA] trends of order m in the proﬁle (or, equiv-
alently, of order m − 1 in the original series) are eliminated.
Thus a comparison of the results for different orders of DFA
allows one to estimate the type of the polynomial trend in the
time series [3,4].
• Step 4: Average over all segments to obtain the qth order
ﬂuctuation function

1
2Ns

(

2Ns

ν=1
X

Fq(s) ≡

F 2(s, ν)

q/2

(4)

(cid:2)
where, in general, the index variable q can take any real value
except zero [22]. For q = 2, the standard DFA procedure is

(cid:3)

1/q

,

)

retrieved. We are interested in how the generalized q depen-
dent ﬂuctuation functions Fq(s) depend on the time scale s
for different values of q. Hence, we must repeat steps 2 to 4
for several time scales s. It is apparent that Fq(s) will increase
with increasing s. Of course, Fq(s) depends on the DFA order
m. By construction, Fq(s) is only deﬁned for s ≥ m + 2.
• Step 5: Determine the scaling behavior of the ﬂuctuation
functions by analyzing log-log plots Fq(s) versus s for each
value of q. Several examples of this procedure will be shown
in Section III. If the series xi are long-range power-law corre-
lated, Fq(s) increases, for large values of s, as a power-law,

Fq(s) ∼ sh(q).

(5)

In general, the exponent h(q) may depend on q. For stationary
time series, h(2) is identical to the well-known Hurst expo-
nent H (see e. g. [17]). Thus, we will call the function h(q)
generalized Hurst exponent.

For monofractal time series with compact support, h(q) is
independent of q, since the scaling behavior of the variances
F 2(s, ν) is identical for all segments ν, and the averaging pro-
cedure in Eq. (4) will give just this identical scaling behavior
for all values of q. Only if small and large ﬂuctuations scale
differently, there will be a signiﬁcant dependence of h(q) on q:
If we consider positive values of q, the segments ν with large
variance F 2
s (ν) (i. e. large deviations from the corresponding
ﬁt) will dominate the average Fq(s). Thus, for positive values
of q, h(q) describes the scaling behavior of the segments with
large ﬂuctuations. Usually the large ﬂuctuations are character-
ized by a smaller scaling exponent h(q) for multifractal series
[23]. On the contrary, for negative values of q, the segments
ν with small variance F 2
s (ν) will dominate the average Fq(s).
Hence, for negative values of q, h(q) describes the scaling
behavior of the segments with small ﬂuctuations, which are
usually characterized by a larger scaling exponent.

However, the MF-DFA method can only determine posi-
tive generalized Hurst exponents h(q), and it already becomes
inaccurate for strongly anti-correlated signals when h(q) is
close to zero. In such cases, a modiﬁed (MF-)DFA technique
has to be used. The most simple way to analyze such data
is to integrate the time series before the MF-DFA procedure.
Hence, we replace the single summation in Eq. (1), which is
describing the proﬁle from the original data xk, by a double
summation,

˜Y (i) ≡

[Y (k) − hY i] .

(6)

i

Xk=1

Following the MF-DFA procedure as described above, we ob-
tain generalized ﬂuctuation functions ˜Fq(s) described by a
scaling law as in Eq. (5), but with larger exponents ˜h(q) =
h(q) + 1,

˜Fq(s) ∼ s

˜h(q) = sh(q)+1.

(7)

Thus, the scaling behavior can be accurately determined even
for h(q) which are smaller than zero (but larger than −1) for

2

some values of q. We note that ˜Fq(s)/s corresponds to Fq(s)
in Eq. (5). If we do not subtract the average values in each step
of the summation in Eq. (6), this summation leads to quadratic
trends in the proﬁle ˜Y (i). In this case we must employ at least
the second order MF-DFA to eliminate these artiﬁcial trends.

where q is a real parameter as in the MF-DFA above. Some-
times τ (q) is deﬁned with opposite sign (see e. g. [17]).

Using Eq. (11) we see that Eq. (12) is identical to Eq. (10),
and obtain analytically the relation between the two sets of
multifractal scaling exponents,

B. Relation to standard multifractal analysis

For stationary, normalized records with compact support
the multifractal scaling exponents h(q) deﬁned in Eq. (5) are
directly related, as shown below, to the scaling exponents τ (q)
deﬁned by the standard partition function-based multifractal
formalism.

Suppose that the series xk of length N is a stationary, nor-
malized sequence. Then the detrending procedure in step 3
of the MF-DFA method is not required, since no trend has to
be eliminated. Thus, the DFA can be replaced by the stan-
dard Fluctuation Analysis (FA), which is identical to the DFA
except for a simpliﬁed deﬁnition of the variance for each seg-
ment ν, ν = 1, . . . , Ns, in step 3 [see Eq. (2)]:

FA(s, ν) ≡ [Y (νs) − Y ((ν − 1)s)]2.
F 2

(8)

Inserting this simpliﬁed deﬁnition into Eq. (4) and using
Eq. (5), we obtain

|Y (νs) − Y ((ν − 1)s)|q

∼ sh(q).

(9)

1/q

)

For simplicity we can assume that the length N of the series
is an integer multiple of the scale s, obtaining Ns = N/s and
therefore

|Y (νs) − Y ((ν − 1)s)|q ∼ sqh(q)−1.

(10)

1
2Ns

(

2Ns

ν=1
X

N/s

ν=1
X

This already corresponds to the multifractal formalism used
e. g. in [18,20]. In fact, a hierarchy of exponents Hq similar
to our h(q) has been introduced based on Eq. (10) in [18].

In order to relate also to the standard textbook box counting
formalism [17,19], we employ the deﬁnition of the proﬁle in
Eq. (1). It is evident that the term Y (νs) − Y ((ν − 1)s) in
Eq. (10) is identical to the sum of the numbers xk within each
segment ν of size s. This sum is known as the box probability
ps(ν) in the standard multifractal formalism for normalized
series xk,

ps(ν) ≡

xk = Y (νs) − Y ((ν − 1)s).

(11)

The scaling exponent τ (q) is usually deﬁned via the partition
function Zq(s),

Zq(s) ≡

|ps(ν)|q ∼ sτ (q),

(12)

νs

Xk=(ν−1)s+1

N/s

ν=1
X

3

τ (q) = qh(q) − 1.

(13)

Thus, we have shown that h(q) deﬁned in Eq. (5) for the MF-
DFA is directly related to the classical multifractal scaling ex-
ponents τ (q). Note that h(q) is different from the generalized
multifractal dimensions

D(q) ≡

τ (q)
q − 1

=

qh(q) − 1
q − 1

,

(14)

that are used instead of τ (q) in some papers. While h(q) is
independent of q for a monofractal time series with compact
support, D(q) depends on q in that case. Our assumption of
compact support of the series xk can be directly observed in
Eq. (14), since the fractal dimension of the support is D(0) ≡
−τ (0) = 1.

Another way to characterize a multifractal series is the sin-
gularity spectrum f (α), that is related to τ (q) via a Legendre
transform [17,19],

α = τ ′(q) and f (α) = qα − τ (q).

(15)

Here, α is the singularity strength or H¨older exponent, while
f (α) denotes the dimension of the subset of the series that is
characterized by α. Using Eq. (13), we can directly relate α
and f (α) to h(q),

α = h(q) + qh′(q)

and f (α) = q[α − h(q)] + 1.

(16)

III. FOUR ILLUSTRATIVE EXAMPLES

A. Example 1: monofractal uncorrelated and long-range
correlated series

As a ﬁrst example we apply the MF-DFA method to
monofractal series with compact support, for which the gen-
eralized Hurst exponent h(q) is expected to be independent of
q,

h(q) = H and τ (q) = qH − 1.

(17)

Such series have been discussed in the context of conventional
DFA in several studies before, see e.g. [3–5]. Long-range cor-
related random numbers are usually generated by the Fourier
transform method, see e. g. [17,24]. Using this method we can
generate long-range anti-correlated (0 < H < 0.5), uncorre-
lated (H = 0.5), or (positively) long-range correlated (0.5 <
H < 1) series. The latter are characterized by a power-law de-
cay of the autocorrelation function C(s) ≡ hxk xk+si ∼ s−γ
for large scales s with γ = 2 − 2H if the series is stationary.

Alternatively, all stationary long-range correlated series can
be characterized by the power-law decay of their power spec-
tra, S(f ) ∼ f −β with frequency f and β = 2H − 1. Note
that H corresponds to the Hurst exponent of the integrated
time series here.

Figure 1 shows the generalized ﬂuctuation functions Fq(s)
for all three types of monofractal series (H = 0.75, 0.5, 0.25)
and several q values. On large scales s, we observe the
expected power-law scaling behavior according to Eq. (5),
which corresponds to straight lines in the log-log plot.
In
Fig. 1(d), the scaling exponents h(q) determined from the
slopes of these straight lines are shown versus q. Although
a slight q dependence is observable, the values of h(q) are al-
ways very close to the H of the generated series that has been
analyzed. The degree of the q dependence observed for this
monofractal series allows to estimate the usual ﬂuctuation of
h(q) to be expected for monofractal series in general.

Next, we analyze multifractal series for which τ (q) can be
calculated exactly, and compare the numerical results with the
expected scaling behavior.

B. Example 2: binomial multifractal series

In the binomial multifractal model [17–19], a series of N =

2nmax numbers k with k = 1, . . . , N is deﬁned by

xk = an(k−1)(1 − a)nmax−n(k−1),

(18)

where 0.5 < a < 1 is a parameter and n(k) is the number of
digits equal to 1 in the binary representation of the index k,
e. g. n(13) = 3, since 13 corresponds to binary 1101.

The scaling exponents τ (q) can be calculated straightfor-
wardly. According to Eqs. (11) and (18) the box probability
p2s(ν) in the νth segment of size 2s is given by

p2s(ν) = ps(2ν − 1) + ps(2ν)
= [(1 − a)/a + 1]ps(2ν) = ps(2ν)/a.

Thus, according to Eqs. (12) and (18),

Zq(s) =

[ps(ν)]q =

[ps(2ν − 1)]q + [ps(2ν)]q

N/s

ν=1
X

N/2s

ν=1
X
(1 − a)q
aq

=

(cid:20)

N/2s

ν=1
X

+ 1

[ps(2ν)]q

N/2s

(cid:21)

ν=1
X

and according to Eqs. (12) and (13),

τ (q) =

− ln[aq + (1 − a)q]
ln(2)

,

h(q) =

−

1
q

ln[aq + (1 − a)q]
q ln(2)

.

Note that τ (0) = −1 as required. There is a strong non-
linear dependence of τ (q) upon q, indicating multifractality.
The same information is comprised in the q dependence of
h(q). The asymptotic values are h(q) → − ln(a)/ ln(2) for
q → +∞ and h(q) → − ln(1 − a)/ ln(2) for q → −∞. They
correspond to the scaling behavior of the largest and weakest
ﬂuctuations, respectively. Note that h(q) becomes indepen-
dent of q in the asymptotic limit, while τ (q) approaches linear
q dependences.

Figure 2 shows the MF-DFA ﬂuctuation functions Fq(s)
for the binomial multifractal model with a = 0.75. The re-
sults for MF-DFA1 and MF-DFA4 are compared in parts (a)
and (b). Fig. 2(c) shows the corresponding slopes h(q) for
three values of a together with the exact results obtained from
Eq. (20). The numerical results are in good agreement with
Eq. (20), showing that the MF-DFA correctly detects the mul-
tifractal scaling exponents. Figures 2(d) and (e) show the cor-
responding exponents τ (q) = qh(q) − 1 [see Eq. (13)] and
the corresponding f (α) spectrum calculated from h(q) using
the modiﬁed Legendre transform (16). Both are also in good
agreement with Eq. (19). We have also checked that the re-
sults for the binomial multifractal model remain unchanged if
the double summation technique [see Eq. (6)] is applied. We
obtain slopes ˜h(q) = h(q) + 1 as expected in Eq. (7). Note
that there is no need to use this modiﬁcation, except if h(q) is
close to zero or has negative values.

C. Example 3: dyadic random cascade model with log-Poisson
distribution

For another independent test of the MF-DFA, we employ an
algorithm based on random cascades on wavelet dyadic trees
proposed in [25] (see also [26]). This algorithm builds a ran-
dom multifractal series by specifying its discrete wavelet co-
efﬁcients cn,m, deﬁned recursively,

c1,1 = 1,

cn,2m−1 = W cn−1,m,

cn,2m = W cn−1,m,

where n = 2, . . . , nmax (with N = 2nmax) and m =
1, . . . , 2n−2. The values of W are taken from a log-Poisson
distribution, |W | = exp(P ln δ + γ), where P is Poisson dis-
tributed with hP i = λ. There are three independent parame-
ters, λ, δ, and γ. Inverse wavelet transform is applied to create
the multifractal random series xk once the wavelet coefﬁcients
cn,m are known,

nmax

2n−1

n=1
X

m=1
X

where ψn,m(k) is a set of wavelets forming an orthonor-
mal wavelet basis. Here, we employ the Haar wavelets,
ψn,m(k) ≡ 2(n−nmax−1)/2ψ[2n−nmax−1k − m] with ψ(x) ≡
1 for 0 < x ≤ 0.5, ψ(x) ≡ −1 for 0.5 < x ≤ 1 and ψ(x) ≡ 0
otherwise. For this model the multifractal scaling exponents
are given by [25]

(19)

(20)

4

= [(1 − a)q + aq]

[p2s(ν)]q = [(1 − a)q + aq] Zq(2s)

xk =

cn,mψn,m(k),

(21)

τ (q) =

λ(1 − δq) − γq
ln 2

− 1,

h(q) = [λ(1 − δq) − γq]/(q ln 2).

(22)

(23)

Figure 3 shows the MF-DFA ﬂuctuation functions Fq(s)
for the dyadic random cascade model. The numerically deter-
mined slopes h(q) for three sets of parameters are compared
with the exact results obtained from Eq. (23) and the good
agreement shows that the MF-DFA correctly detects the mul-
tifractal scaling exponents. Large deviations occur only for
very small moments (q < −10), indicating that the range of q
values should not exceed −10.

D. Example 4: uncorrelated multifractal series with power-law
distribution function

The examples discussed in the previous three subsections
were based on series involving long-range correlations. In the
present example we want to apply the MF-DFA method to
an uncorrelated series, that nevertheless exhibits multifractal
scaling behavior due to the broad distribution of its values. We
denote by P (x) the probability density function of the values
xk in the series. The distribution P (x) does not affect the
multifractality of a series on large scales s, if all moments

h|x|qi ≡

|x|qP (x) dx

(24)

∞

−∞

Z

distribution (25) diverges. Now the whole series consists of
Ns ≡ int(N/s) segments of length s and not just of one
segment. For some segments ν, [F 2(s, ν)]1/2 is larger than
its typical value xmax(s) = s1/α, since the maximum within
the whole series of length N is xmax(N ) = N 1/α.
In or-
der to calculate Fq(s) [Eq. (4)], we need to take into account
the whole distribution Ps(y) of the values y ≡ [F 2(s, ν)]1/2.
Since each of the maxima in the Ns segments corresponds
to an actual number xk and these xk are random numbers
from the power-law distribution (25), it becomes obvious, that
the distribution of the maxima will have the same form, i. e.
Ps(y) ∼ P (x = y) for large y. Small values of y are ex-
cluded because of the maximum procedure, but the large xk
values are very likely to be identical to the maxima of the
corresponding segments. Since the smallest maxima for seg-
ments of length s are of the order of xmax(s) = s1/α, the
lower cutoff for Ps(y) must be proportional to s1/α. From
∞
As1/α Ps(y) dy = 1 (with an
the normalization condition
unimportant prefactor A < 1) we get
R
Ps(y) = Aααsy−(α+1).

(26)

Now Fq(s) [Eq. (4)] can be calculated by integration from
the minimum value As1/α of y ≡ [F 2(s, ν)]1/2 to the maxi-
mum value N 1/α. For s ≪ N we obtain

Fq(s) ∼

yqPs(y) dy

1/α

N

As1/α

"Z
1/q

∼

1/q

#

s1/q
s1/α

(q > α)
(q < α)

.

are ﬁnite. Here we choose a (normalized) power-law proba-
bility distribution function,

P (x) = αx−(α+1)

for 1 ≤ x < ∞ with α > 0

(25)

∼

AαsN q/α−1 − Aqsq/α
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

Comparing with Eq. (5), we ﬁnally get

(cid:26)

and P (x) = 0 for x < 1, where already the second moment
diverges if α ≤ 2. In this case, the series exhibits multifractal
scaling behavior on all scales. Note, that Eq. (25) becomes
identical to a Levy distribution of class α for large values of
x. The parameter α is not related to the H¨older exponent α in
Eq. (15). The scaling properties of random walks with Levy
distributed steps (Levy ﬂights and Levy walks) have been an-
alyzed in [27–29]. The multifractal nature of Levy processes
has been investigated in [30,31].

In order to derive the multifractal spectrum, let us consider
s uncorrelated random numbers rk, k = 1, . . . , s, distributed
homogeneously in the interval [0, 1]. Obviously, the typical
value of the minimum of the numbers, rmin(s) ≡ mins
k=1rk,
will be rmin(s) = 1/s. It can be easily shown that the num-
bers rk are transformed into numbers xk distributed accord-
ing to the power-law probability distribution function (25) by
rk → xk = r−1/α
. Thus, the typical value of the maximum
k=1xk = [rmin(s)]−1/α =
of the xk will be xmax(s) ≡ maxs
s1/α.

k

If α ≤ 2, the ﬂuctuations of the proﬁle Y (i) [Eq. (1)] and
the corresponding DFA variance F 2(s, ν) [Eq. (2)] will be
dominated by the square of the largest value x2
max(s) = s2/α
in the segment of s numbers, since the second moment of the

h(q) ∼

(cid:26)

1/q
(q > α)
1/α (q ≤ α)

.

(27)

Note that τ (q) follows a linear q dependence, τ (q) = q/α − 1
for q < α, while it is equal to zero for q > α according
to Eq. (13). Hence, the series of uncorrelated power-law dis-
tributed values has rather bi-fractal [31] instead of multifractal
properties. Since h(2) = 1/2 holds exactly for all values of
α, it is not possible to recognize the multifractality due to the
broad power-law distribution of the values if only the conven-
tional DFA is applied. The second moment shows just the
uncorrelated behavior of the values. In a very recent preprint
[29] this behavior has been interpreted as a failure of the DFA
and corresponding non-detrending methods for series with a
broad distribution, and another method to determine the ex-
ponent 1/α has been proposed. We believe that a multifractal
description with more than one exponent is required to charac-
terize this kind of series, and thus any method calculating just
one exponent will be insufﬁcient for a full characterization.

Figure 4(a) shows the MF-DFA3 ﬂuctuation functions for
series of independent random numbers xk ∈ [1, ∞) dis-
tributed according to Eq. (25) with α = 1. Since the scaling
exponents h(q) become very close to zero asymptotically for

5

large positive values of q according to Eq. (27), we must use
the modiﬁed MF-DFA technique involving the double sum as
described in the last paragraph of Subsection II.A. Hence, for
this technical reason, ˜Fq(s)/s is calculated instead of Fq(s).
The corresponding slopes ˜h(q) − 1 are identical to h(q), see
Eq. (7). In Fig. 4(b) the slopes h(q) for series with α = 0.5,
1.0, and 2.0 are compared with the theoretical result Eq. (27),
and nice agreement is observed.

IV. COMPARISON OF THE MULTIFRACTALITY FOR
ORIGINAL AND SHUFFLED SERIES

A. Distinguishing the two types of multifractality

As already mentioned in the introduction, two different
types of multifractality in time series can be distinguished.
Both of them require a multitude of scaling exponents for
small and large ﬂuctuations. (i) Multifractality of a time se-
ries can be due to a broad probability density function for the
values of the time series, and (ii) multifractality can also be
due to different long-range correlations for small and large
ﬂuctuations. The example discussed in Subsection III.D, the
uncorrelated multifractal series with a power-law probability
density function, is of type (i), while the examples discussed
in Subsections III.A – III.C are of type (ii), where the prob-
ability density function of the values is a regular distribution
with ﬁnite moments [32].

Now, we would like to distinguish between these two types
of multifractality. The most easy way to do so is by analyzing
also the corresponding randomly shufﬂed series. In the shuf-
ﬂing procedure the values are put into random order, and thus
all correlations are destroyed. Hence the shufﬂed series from
multifractals of type (ii) will exhibit simple random behavior,
hshuf (q) = 0.5, i. e. non-multifractal scaling like in Fig. 1(b).
For multifractals of type (i), on the contrary, the original h(q)
dependence is not changed, h(q) = hshuf (q), since the mul-
tifractality is due to the probability density, which is not af-
fected by the shufﬂing procedure. If both kinds of multifrac-
tality are present in a given series, the shufﬂed series will show
weaker multifractality than the original one.

10

The effect of the shufﬂing procedure is illustrated in
Fig. 5(a), where the MF-DFA2 ﬂuctuation functions F shuf
−10 (s)
and F shuf
(s) are shown for shufﬂed series for three of the
multifractal examples taken from the previous section. Ran-
dom behavior, hshuf (q) = 0.5, is observed for the series that
were long-range correlated or generated from the dyadic ran-
dom cascade model before the shufﬂing procedure [upper four
curves in Fig. 5(a)]. In contrast, we observe the original multi-
fractal scaling for the shufﬂed multifractal series with power-
law probability density function P (x) ∼ x−2 [lower two
curves in Fig. 5(a)]. The hshuf (q) dependences are shown in
Fig. 6, which can be compared with the corresponding slopes
shown in Figs. 1(d), 3(b), and 4(b). Thus, the ﬂuctuation
analysis of the shufﬂed series, F shuf
(s), directly indicates the

q

presence of type (i) multifractality, which is due to a broad
probability distribution, by deviations from hshuf (q) = 0.5.

Now we want to determine directly the magnitude of the (ii)
multifractality, which is due to correlations. For that purpose
we compare the ﬂuctuation function for the original series,
Fq(s), with the result for the corresponding shufﬂed series,
F shuf
(s). Differences between these two ﬂuctuation func-
q
tions directly indicate the presence of correlations in the orig-
inal series. These differences can be observed best in a plot
of the ratio Fq(s)/F shuf
(s) versus s [33]. Since the anoma-
lous scaling due to a broad probability density affects Fq(s)
and F shuf
(s) in the same way, only multifractality due to cor-
q
relations will be observed in Fq(s)/F shuf
(s). This is illus-
trated in Fig. 5(b) for the same three multifractal examples as
in Fig. 5(a). In order not to have increased statistical errors in
the results when considering the ratio Fq(s)/F shuf
(s) instead
of Fq(s) itself, F shuf
(s) can be calculated by averaging over
a large number of randomly shufﬂed series generated from the
same original series.

q

q

q

q

The scaling behavior of the ratio is

Fq(s)/F shuf

q

(s) ∼ sh(q)−hshuf (q) = shcor(q).

(28)

If only distribution
Note that h(q) = hshuf (q) + hcor(q).
multifractality [type (i)] is present, h(q) = hshuf (q) depends
on q and hcor(q) = 0. On the other hand, deviations of
hcor(q) from zero indicate the presence of correlations, and
a q dependence of hcor(q) indicates correlation multifractal-
ity [type (ii)].
If only correlation multifractality is present,
hshuf (q) = 0.5 and h(q) = 0.5 + hcor(q). If both, distribu-
tion multifractality and correlation multifractality are present,
both, hshuf (q) and hcor(q) depend on q.

B. Signiﬁcance of the results

In Figs. 1-6 we have shown the results of the MF-DFA for
single conﬁgurations of long time series. Now we address
the signiﬁcance and accuracy of the MF-DFA results for short
series. How much do the numerically determined exponents
h(q) vary from one conﬁguration (sample series) to the next,
and how close are the average values to the theoretical val-
ues? In other words, how large are the statistical and system-
atical deviations of exponents practically determined by the
MF-DFA for ﬁnite series? These questions are particularly
important for short series, where the statistics is poor. If the
values of h(q) are determined inaccurately, the multifractal
properties will be reported inaccurately or even false conclu-
sions on multifractal behavior might be drawn for monofractal
series.

To address the signiﬁcance and accuracy of the MF-DFA
results we generate, for each of the three examples considered
already in Fig. 5, 100 series of length N = 213 = 8192 and
calculate h(−10), h(+10), hshuf (−10), and hshuf (+10) for
each of these series. The corresponding histograms are shown
in Fig. 7. For the long-range power-law correlated series with

6

H = 0.75 we ﬁnd the following mean values and standard
deviations of the generalized Hurst exponents:

h(−10) = 0.80 ± 0.03, hshuf (−10) = 0.56 ± 0.02,
hshuf (+10) = 0.48 ± 0.02.
h(+10) = 0.72 ± 0.04,

The mean values for the original series are rather close to, but
not identical to the theoretical value H = 0.75. The mean
value for q = −10 is about two standard deviations larger
than 0.75, while the value for q = +10 is slightly smaller.
These deviations, though, certainly cannot indicate multifrac-
tality, since we analyzed monofractal series. Instead, they are
due to the ﬁnite, random series, where parts of the series have
slightly larger and slightly smaller scaling exponent just by
statistical ﬂuctuations. By considering negative values of q
we focus on the parts with small ﬂuctuations, which are usu-
ally described by a larger scaling exponent [23]. For positive
values of q we focus on the parts with large ﬂuctuations usu-
ally described by a smaller value of h. Thus for short records
we always expect a slight difference between h(−10) and
h(+10) even if the series are monofractal. If this difference
is weak, one has to be very careful with conclusions about
multifractality. Practically it is always wise to compare with
generated monofractal series with otherwise similar properties
before drawing conclusions regarding the multifractality of a
time series. In addition to the statistical ﬂuctuations of the h
values, the average h(−10) is usually determined slightly too
large, while h(+10) is slightly too small. The same behav-
ior is obtained if the WTMM method is used instead of the
MF-DFA, as we will show in Subsection V.C.

The same kind of difference is also observed for the aver-
age hshuf (−10) and hshuf (+10) values. After all correlations
have been destroyed by the shufﬂing, hshuf = 0.5 is expected
since the probability density is Gaussian with all ﬁnite mo-
ments. The deviations from hshuf = 0.5 we observe for the
ﬁnite random series are characteristic for monofractal series
of this length (N = 8192). Only for the second moment we
obtain hshuf (2) = 0.5 exactly if a sufﬁcient number of series
is considered.

For multifractal series generated from the dyadic random
cascade model, Fig. 7(c,d) shows the histograms of the scal-
ing exponents h(−10), h(+10), hshuf (−10), and hshuf (+10).
Their averages and standard deviations,

h(−10) = 0.69 ± 0.04, hshuf (−10) = 0.57 ± 0.02,
hshuf (+10) = 0.48 ± 0.02.
h(+10) = 0.54 ± 0.02,

have to be compared with the theoretical values from Eq. (23),
h(−10) = 0.743 and h(+10) = 0.567. Surprisingly, the
mean h(−10) is smaller than the theoretical value in this ex-
ample, but for the mean h(+10) the deviation is similar to
the deviation observed for the monofractal data in the pre-
vious example. Again, similar results are obtained with the
WTMM method. For the shufﬂed series, the mean general-
ized Hurst exponents are practically identical to those for the
shufﬂed monofractal series [the average hshuf (−10) is larger

by half the standard deviation], and both are evidently consis-
tent with monofractal uncorrelated behavior, h(q) = 0.5, as
discussed above. Hence, the series from the dyadic random
cascade model show no signs of distribution multifractality
and are characterized by correlation multifractality only.

The histograms of the scaling exponents for our last exam-
ple, the power-law distributed random numbers with P (x) ∼
x−2, are shown in Fig. 7(e,f). The corresponding mean values
and standard deviations,

h(−10) = 1.24 ± 0.09,
h(+10) = 0.11 ± 0.03,

hshuf (−10) = 1.26 ± 0.09,
hshuf (+10) = 0.11 ± 0.04.

show obviously no differences between original and shufﬂed
series as expected for uncorrelated series. This indicates that
the multifractality is due to the broad probability density func-
tion only. The values have to be compared with h(−10) = 1
and h(+10) = 0.1 from Eq. (27). As usual, the average value
of h(−10) is too large because we analyzed short series.

V. COMPARISON TO THE WAVELET TRANSFORM
MODULUS MAXIMA METHOD

A. Brief description of the wavelet transform modulus maxima
method

The wavelet transform modulus maxima (WTMM) method
[21] is a well-known method to investigate the multifractal
scaling properties of fractal and self-afﬁne objects in the pres-
ence of nonstationarities. It is an application of the wavelet
transform with continuous basis functions. One deﬁnes the
wavelet-transform of a series xk of length N by

W (n, s) =

xk ψ[(k − n)/s].

(29)

1
s

N

Xk=1

Note that in this case the series xk are analyzed directly in-
stead of the proﬁle Y (i) deﬁned in Eq. (1). Here, the function
ψ(x) is the analyzing wavelet and s is, as above, the scale
parameter. The wavelet is chosen orthogonal to the possi-
ble trend. If the trend can be represented by a polynomial,
a good choice for ψ(x) is the m-th derivative of a Gaussian,
ψ(m)(x) = dm(e−x
/2)/dxm. This way, the transform elimi-
nates trends up to (m − 1)th order.

2

Now, instead of averaging over all values of W (n, s), one
averages, within the modulo-maxima method, only the lo-
cal maxima of |W (n, s)|. First, one determines for a given
scale s, the positions ni of the local maxima of |W (n, s)|
as function of n, so that |W (ni − 1, s)| < |W (ni, s)| ≥
|W (ni + 1, s)| for i = 1, . . . , imax. Then one sums up the
qth power of these maxima,

Z(q, s) =

|W (ni, s)|q.

(30)

imax

i=1
X

7

The reason for this maxima procedure is that the absolute
wavelet coefﬁcients |W (n, s)| can become arbitrarily small.
The analyzing wavelet ψ(x) must always have positive values
for some x and negative values for other x, since it has to be
orthogonal to possible constant trends. Hence there are always
positive and negative terms in the sum (29), and these terms
might cancel. If that happens, |W (n, s)| can become close
to zero. Since such small terms would spoil the calculation
of negative moments in Eq. (30), they have to be eliminated
by the maxima procedure. In the MF-DFA, the calculation of
the variances F 2(s, ν) in Eq. (2), i. e. the deviations from the
ﬁts, involves only positive terms under the summation. The
variances cannot become arbitrarily small, and hence no max-
imum procedure is required for series with compact support.
In addition, the MF-DFA variances will always increase if
the segment length s is increased, because the ﬁt will always
be worse for a longer segment. In the WTMM method, in
contrast, the absolute wavelet coefﬁcients |W (n, s)| need not
increase with increasing scale s, even if only the local maxima
are considered. The values |W (n, s)| might become smaller
for increasing s since just more (positive and negative) terms
are included in the summation (29), and these might cancel
even better. Thus, an additional supremum procedure has been
introduced in the WTMM method in order to keep the depen-
dence of Z(q, s) on s monotonous: If, for a given scale s, a
maximum at a certain position ni happens to be smaller than a
i ≈ ni for a lower scale s′ < s, then W (ni, s)
maximum at n′
i, s′) in Eq. (30). There is no need for such
is replaced by W (n′
a supremum procedure in the MF-DFA.

Often, scaling behavior is observed for Z(q, s), and scal-
ing exponents ˆτ (q) can be deﬁned that describe how Z(q, s)
scales with s,

Z(q, s) ∼ sˆτ (q).

(31)

The exponents ˆτ (q) characterize the multifractal properties of
the series under investigation, and theoretically they are iden-
tical to the τ (q) deﬁned in Eq. (12) [21] and related to h(q) in
Eq. (13).

B. Examples for series with nonstationarities

Since the WTMM method has been developed to analyze
multifractal series with nonstationarities, such as trends or
spikes, we will compare its performance with the performance
of the MF-DFA for such nonstationary series. In Fig. 8 the
MF-DFA ﬂuctuation function Fq(s) and its scaling behavior
are compared with the rescaled WTMM partition sum Z(q, s)
for the binomial multifractal described in Subsection III.B.
To test the detrending capability of both methods, we have
added linear as well as quadratic trends to the generated mul-
tifractal series. The trends are removed by both methods, if
a sufﬁciently high order of detrending is employed. The de-
viations from the theoretical values of the scaling exponents
h(q) [given by Eq. (20)] are of similar size for the MF-DFA

and the WTMM method. Thus, the detrending capability and
the accuracy of both methods is equivalent.

We also obtain similar results for a monofractal long-range
correlated series with additional spikes (outliers) that consist
of large random numbers and replace a small fraction of the
original series in randomly chosen positions. The spikes lead
to multifractality on small scales s, while the series remains
monofractal on large scales. Thus, the effects of the spikes
are eliminated neither by the WTMM method nor by the MF-
DFA, but both methods again give rather equivalent results.

C. Signiﬁcance of the results

The last problem we address is a comparison of the signiﬁ-
cance of the results obtained by the MF-DFA and the WTMM
method. The signiﬁcance of the MF-DFA results has already
been discussed in detail in Subsection IV.B. Here we will
compare the signiﬁcance of both methods for short and long
series.

We begin with the signiﬁcance of the results for random
series involving neither correlations nor a broad distribution
[as in Fig. 1(b)]. Fig. 9 shows the distribution of the mul-
tifractal Hurst exponents h(−10) and h(+10) calculated by
the MF-DFA as well as by the WTMM using the relation
h(q) = [ˆτ (q) + 1]/q based on Eq. (13). Similar to the results
presented in Fig. 7, we have analyzed 100 generated series of
uncorrelated random numbers. In addition, we compare the
results for the (relatively short) series length N = 213 = 8192
and for N = 216 = 65532.
Ideally, both, h(−10) and
h(+10), should be equal to the Hurst exponent of the uncorre-
lated monofractal series, H = 0.5. The histograms show that
similar deviations as well as remarkable ﬂuctuations of the
exponents occur for both methods, as discussed in Subsection
IV.B for the MF-DFA. We ﬁnd the following mean values and
standard deviations,

h(−10) = 



and h(+10) = 


0.55 ± 0.03 for MF-DFA (N = 8k)
0.52 ± 0.02 for MF-DFA (N = 64k)
0.58 ± 0.05 for WTMM (N = 8k)
0.56 ± 0.03 for WTMM (N = 64k)
0.49 ± 0.03 for MF-DFA (N = 8k)
0.49 ± 0.02 for MF-DFA (N = 64k)
0.46 ± 0.04 for WTMM (N = 8k)
0.48 ± 0.02 for WTMM (N = 64k)

.



As already discussed in Subsection IV.B, the deviations of the
average h(q) values from H = 0.5 do not indicate multifrac-
tality. For the WTMM method and short series, one has to be
very careful in order not to draw false conclusions from results
like h(−10) = 0.58 and h(+10) = 0.46. The corresponding
results of the MF-DFA are closer to the theoretical value.

Figure 10 shows the distribution of the multifractal scaling
exponents h(−10) and h(+10) calculated for generated mul-
tifractal series from the binomial model with a = 0.75 de-
scribed in Subsection III.B. Like for Fig. 9, 100 generated se-
ries have been analyzed for each of the histograms. Now, the

8

differences between the distributions of h(−10) and h(+10)
are much larger, indicating multifractality. We ﬁnd

h(−10) = 



and h(+10) = 


1.88 ± 0.06 for MF-DFA (N = 8k)
1.89 ± 0.03 for MF-DFA (N = 64k)
1.86 ± 0.05 for WTMM (N = 8k)
1.89 ± 0.02 for WTMM (N = 64k)
0.50 ± 0.02 for MF-DFA (N = 8k)
0.51 ± 0.01 for MF-DFA (N = 64k)
0.46 ± 0.01 for WTMM (N = 8k)
0.47 ± 0.01 for WTMM (N = 64k)

.



These values must be compared with the theoretical values
h(−10) = 1.90 and h(+10) = 0.515 from Eq. (20). Again,
the MF-DFA results turn out to be slightly more signiﬁcant
than the WTMM results. The MF-DFA seems to have slight
advantages for negative q values and short series, but in the
other cases the results of the two methods are rather equiva-
lent. Besides that, the main advantage of the MF-DFA method
compared with the WTMM method lies in the simplicity of
the MF-DFA method.

VI. CONCLUSION

We have generalized the DFA, widely recognized as a
method to analyze the (mono-) fractal scaling properties of
nonstationary time series. The MF-DFA method allows a re-
liable multifractal characterization of multifractal nonstation-
ary time series. The implementation of the new method is not
more difﬁcult than that of the conventional DFA, since just
one additional step, a q dependent averaging procedure, is re-
quired. We have shown for stationary signals that the gen-
eralized (multifractal) scaling exponent h(q) for series with
compact support is directly related to the exponent τ (q) of
the standard partition function-based multifractal formalism.
Further, we have shown in several examples that the MF-DFA
method can reliably determine the multifractal scaling behav-
ior of the time series, similar to the WTMM method which is
a more complicated procedure for this purpose. For short se-
ries and negative moments, the signiﬁcance of the results for
the MF-DFA seems to be slightly better than for the WTMM
method.

Contrary to the WTMM method, the MF-DFA method as
described in Subsection II.A requires series of compact sup-
port, because the averaging procedure in Eq. (4) will only
work if F 2(s, ν) > 0 for all segments ν. Although most
time series will fulﬁll this prerequisite, it can be overcome by
a modiﬁcation of the MF-DFA technique in order to analyze
data with fractal support: We restrict the sum in Eq. (4) to the
local maxima, i. e. to those terms F 2(s, ν) that are larger than
the terms F 2(s, ν − 1) and F 2(s, ν + 1) for the neighboring
segments. By this restriction all terms F 2(s, ν) that are zero
or very close to zero will be disregarded, and series with frac-
tal support can be analyzed. The procedure reminds slightly
of the modulus maxima procedure in the WTMM method (see

Subsection V.A). There is no need, though, to employ a con-
tinuously sliding window or to calculate the supremum over
all lower scales for the MF-DFA, since the variances F 2(s, ν),
which are determined by the deviations from the ﬁt, will al-
ways increase when the segment size s is increased. In the
maxima MF-DFA procedure the generalized Hurst exponent
h(q) deﬁned in Eq. (5) will depend on q and even diverge
for q → 0 for monofractal series with non-compact support.
Thus, it is more appropriate to consider the scaling exponent
τ (q), calculating

[F 2(s, ν)]q/2 ∼ sτ (q).

(32)

F 2(s,ν−1)<F 2(s,ν)≥F 2(s,ν+1)
X

This extended MF-DFA procedure will also be applicable for
data with fractal support.

In a later work we will apply the MF-DFA method to a

range of physiological and meteorological data.

Acknowledgements

We would like to thank Yosef Ashkenazy for useful discus-
sions and the Deutsche Akademischer Austauschdienst, the
Deutsche Forschungsgemeinschaft, the German Israeli Foun-
dation, and the Minerva Foundation for ﬁnancial support.

[1] C.-K. Peng, S. V. Buldyrev, S. Havlin, M. Simons, H. E. Stan-
ley, and A. L. Goldberger, Phys. Rev. E 49, 1685 (1994); S. M.
Ossadnik, S. B. Buldyrev, A. L. Goldberger, S. Havlin, R.N.
Mantegna, C.-K. Peng, M. Simons, and H.E. Stanley, Biophys.
J. 67, 64 (1994).

[2] M. S. Taqqu, V. Teverovsky, and W. Willinger, Fractals 3, 785

(1995).

[3] J. W. Kantelhardt, E. Koscielny-Bunde, H. H. A. Rego, S.

Havlin, and A. Bunde, Physica A 295, 441 (2001).

[4] K. Hu, P. Ch. Ivanov, Z. Chen, P. Carpena, and H. E. Stanley,

Phys. Rev. E 64, 011114 (2001).

[5] Z. Chen, P. Ch. Ivanov, K. Hu, and H. E. Stanley, Phys. Rev. E

65, xxxx (April 2002), preprint physics/0111103.

[6] S. V. Buldyrev, A. L. Goldberger, S. Havlin, R. N. Mantegna,
M. E. Matsa, C.-K. Peng, M. Simons, and H. E. Stanley, Phys.
Rev. E 51, 5084 (1995); S. V. Buldyrev, N. V. Dokholyan, A.
L. Goldberger, S. Havlin, C.-K. Peng, H. E. Stanley, and G. M.
Viswanathan, Physica A 249, 430 (1998).

[7] C.-K. Peng, S. Havlin, H. E. Stanley, and A. L. Goldberger,
Chaos 5, 82 (1995); P. Ch. Ivanov, A. Bunde, L. A. N. Amaral,
S. Havlin, J. Fritsch-Yelle, R. M. Baevsky, H. E. Stanley, and
A. L. Goldberger, Europhys. Lett. 48, 594 (1999); Y. Ashke-
nazy, M. Lewkowicz, J. Levitan, S. Havlin, K. Saermark, H.
Moelgaard, P. E. B. Thomsen, M. Moller, U. Hintze, and H.
V. Huikuri, Europhys. Lett. 53, 709 (2001); Y. Ashkenazy, P.
Ch. Ivanov, S. Havlin, C.-K. Peng, A. L. Goldberger, and H. E.
Stanley, Phys. Rev. Lett. 86, 1900 (2001).

9

versus s must be larger than the corresponding slope for Fq(s)
with q > 0. Thus, h(q) for q < 0 will usually be larger than
h(q) for q > 0.

[24] H. A. Makse, S. Havlin, M. Schwartz, H. E. Stanley, Phys. Rev.

E 53, 5445 (1996).

[25] A. Arneodo, E. Bacry, and J. F. Muzy, J. Math. Phys. 39, 4142
(1998); A. Arneodo, S. Manneville, and J. F. Muzy, Europhys.
J. B 1, 129 (1998).

[26] Y. Ashkenazy, S. Havlin. P. Ch. Ivanov, C. K. Peng, V. Schulte-
Frohlinde, and H. E. Stanley, cond-mat/0111396 (unpublished).
[27] M. F. Shlesinger, B. J. West, and J. Klafter, Phys. Rev. Lett. 58,

1100 (1987).

[28] S. Havlin and Y. Ben Avraham, Diffusion and Reactions in
Fractals and Disordered Systems, (Cambridge University Press,
Cambridge, 2000), p. 48, and references therein.

[29] N. Scafetta and P. Grigolini, cond-mat/0202008 (unpublished).
[30] S. Jaffard, Probab. Theory Rel. 114, 207 (1999).
[31] H. Nakao, Phys. Lett. A 266, 282 (2000).
[32] The example of the binomial multifractal series (Subsection
III.B) can also show multifractality due to a broad probabil-
ity density function for the values xk. If the parameter a is
chosen to be very close to one or if very long series are con-
sidered, corresponding to large values of nmax, the minimum
value in the series, (1 − a)nmax , will be very small compared
with the maximum value anmax [see Eq. (18)]. In this case the
log-binomial probability density function will become broad,
approaching a log-normal form. Since the scaling behavior of
uncorrelated log-normal distributed series corresponds to the
multifractal scaling behavior observed in the example of uncor-
related power-law distributed series with α = 2 (see Subsection
III.D), distribution multifractality [type (i)] will occur in addi-
tion to the correlation multifractality [type (ii)]. For the series
with a = 0.75 and N = 8192 (nmax = 13) considered in Sub-
section III.B, we observe only type (ii) multifractality caused
by long-range correlations.

[33] The ratio Fq(s)/F shuf

q

(s) can also be used to eliminate sys-
tematic deviations from the expected power-law scaling behav-
ior that occur at very small scales s < 10 especially for small
values of q (see Figs. 1-3). A similar procedure has already
been introduced for the conventional DFA recently (see Sub-
section 3.1 of [3]). Since the deviations are systematic for the
MF-DFA method, they occur in both, Fq(s) and F shuf
(s), and
they should cancel in the ratio.

q

[8] A. Bunde, S. Havlin, J. W. Kantelhardt, T. Penzel, J.-H. Peter,

and K. Voigt, Phys. Rev. Lett. 85, 3736 (2000).

[9] S. Blesic, S. Milosevic, D. Stratimirovic, and M. Ljubisavljevic,
Physica A 268, 275 (1999); S. Bahar, J. W. Kantelhardt, A.
Neiman, H. H. A. Rego, D. F. Russell, L. Wilkens, A. Bunde,
and F. Moss, Europhys. Lett. 56, 454 (2001).

[10] J. M. Hausdorff, S. L. Mitchell, R. Firtion, C.-K. Peng, M. E.
Cudkowicz, J. Y. Wei, and A. L. Goldberger, J. Appl. Physiol-
ogy 82, 262 (1997).

[11] E. Koscielny-Bunde, A. Bunde, S. Havlin, H.E. Roman, Y. Gol-
dreich, and H.-J. Schellnhuber, Phys. Rev. Lett. 81, 729 (1998).
K. Ivanova and M. Ausloos, Physica A 274, 349 (1999); P.
Talkner and R.O. Weber, Phys. Rev. E 62, 150 (2000).

[12] K. Ivanova, M. Ausloos, E. E. Clothiaux, and T. P. Ackerman,

Europhys. Lett. 52, 40 (2000).

[13] B. D. Malamud and D. L. Turcotte, J. Stat. Plan. Infer. 80, 173

(1999).

[14] C. L. Alados and M. A. Huffman, Ethnology 106, 105 (2000).
[15] R. N. Mantegna and H. E. Stanley, An Introduction to Econo-
physics (Cambridge University Press, Cambridge, 2000); Y.
Liu, P. Gopikrishnan, P. Cizeau, M. Meyer, C.-K. Peng, and
H. E. Stanley, Phys. Rev. E 60, 1390 (1999); N. Vandewalle, M.
Ausloos, and P. Boveroux, Physica A 269, 170 (1999).

[16] J. W. Kantelhardt, R. Berkovits, S. Havlin, and A. Bunde, Phys-
ica A 266, 461 (1999); N. Vandewalle, M. Ausloos, M. Houssa,
P. W. Mertens, and M. M. Heyns, Appl. Phys. Lett. 74, 1579
(1999).

[17] J. Feder, Fractals (Plenum Press, New York, 1988).
[18] A.-L. Barab´asi and T. Vicsek, Phys. Rev. A 44, 2730 (1991).
[19] H.-O. Peitgen, H. J¨urgens, and D. Saupe, Chaos and Fractals

(Springer-Verlag, New York, 1992), Appendix B.

[20] E. Bacry, J. Delour, and J. F. Muzy, Phys. Rev. E 64, 026103

(2001).

[21] J. F. Muzy, E. Bacry, and A. Arneodo, Phys. Rev. Lett. 67, 3515
(1991); J. F. Muzy, E. Bacry, and A. Arneodo, Int. J. Bifurcat.
Chaos 4, 245 (1994); A. Arneodo, E. Bacry, P. V. Graves, and J.
F. Muzy, Phys. Rev. Lett. 74, 3293 (1995); A. Arneodo et al. in:
The science of disaster: climate disruptions, market crashes,
and heart attacks, ed. by A. Bunde and H. J. Schellnhuber
(Springer-Verlag, Berlin, 2002).

[22] The value of h(0), which corresponds to the limit h(q) for q →
0 for time series with compact support, cannot be determined
directly using the averaging procedure in Eq. (4) because of the
diverging exponent. Instead, a logarithmic averaging procedure
has to be employed,

1
4Ns

(

2Ns

ν=1
X

F0(s) ≡ exp

ln

F 2(s, ν)

∼ sh(0).

(33)

)
(cid:3)

(cid:2)
Note that h(0) cannot be deﬁned for time series with fractal
support, where h(q) diverges for q → 0.

[23] For the maximum scale s = N the ﬂuctuation function Fq(s)
is independent of q, since the sum in Eq. (4) runs over only two
identical segments (Ns ≡ [N/s] = 1). For smaller scales s ≪
N the averaging procedure runs over several segments, and the
average value Fq(s) will be dominated by the F 2(s, ν) from
the segments with small (large) ﬂuctuations if q < 0 (q > 0).
Thus, for s ≪ N , Fq(s) with q < 0 will be smaller than Fq(s)
with q > 0, while both become equal for s = N . Hence, if we
assume an homogeneous scaling behavior of Fq(s) following
Eq. (5), the slope h(q) in a log-log plot of Fq(s) with q < 0

10

 

 

 

 

10-1

(a)

)
s
(

F

q

10-3

10-5

)
s
(

F

q

10-2

10-4

)
s
(

F

q

10-1

10-3

(b)

(c)

)
q
(
h

1.00 (d)
0.75
0.50
0.25

(e)

)
q
(

10

0

-10

-20

101

102

s
 

103

104

 

 

 

 

 

(a)

(b)

(c)

(d)

)
s
(

F

q

)
s
(

F

q

)
q
(
h

)
q
(

10-2
10-4
10-6
10-8

10-3
10-5
10-7
10-9

4
3
2
1
0
0

-30

-60

1.0

-20

(e)

)

(a
f

0.5

0.0

0.0

 

 

0

 

101

102

s

103

104

 a = 0.90, MF-DFA1
 a = 0.75, MF-DFA1
 a = 0.75, MF-DFA4
 a = 0.60, MF-DFA1

-10

q

10

20

 q = 10
 q = 2
 q = 0.2
 q =  -0.2
 q =  -2
 q = -10

 

 

 

 

 

-20

-10

0

q

10

20

0.5

1.0

1.5

2.0

FIG. 1. The MF-DFA ﬂuctuation functions Fq(s) are shown
versus the scale s in log-log plots for (a) long-range correlated
monofractal series with H = 0.75, (b) uncorrelated random series
with H = 0.5 (white noise), and (c) long-range anti-correlated se-
ries with H = 0.25. The different symbols correspond to the differ-
ent values of the exponent q in the generalized averaging procedure,
q = −10 (2), −2 (◦), −0.2 (△), +0.2 (▽), +2 (3), and q = +10
(+). MF-DFA2 has been employed, and the curves have been shifted
by multiple factors of 4 for clarity. The straight dashed lines have
the corresponding slopes H and are shown for comparison. Part (d)
shows the q dependence of the asymptotic scaling exponent h(q) de-
termined by ﬁts in the regime 200 < s < 5000 for H = 0.25 (2),
0.5 (◦), and 0.75 (△). The very weak dependence on q is consis-
tent with monofractal scaling. In part (e) the q dependence of τ (q),
τ (q) = qh(q) − 1, is shown.

FIG. 2. The MF-DFA ﬂuctuation functions Fq(s) are shown ver-
sus the scale s in log-log plots for the binomial multifractal model
with a = 0.75 (a) for MF-DFA1 and (b) for MF-DFA4. The symbols
are the same as for Fig. 1. The straight dashed lines have the corre-
sponding theoretical slopes h(−10) = 1.90 and h(+10) = 0.515
and are shown for comparison. In part (c) the q dependence of the
generalized Hurst exponent h(q) determined by ﬁts in the regime
50 < s < 500 is shown for MF-DFA1 and a = 0.9 (△), a = 0.75
(◦), and a = 0.6 (2), as well as for MF-DFA4 and a = 0.75 (▽).
Parts (d) and (e) show the corresponding exponents τ (q) and the cor-
responding singularity spectrum f (α) for a = 0.75 determined by
the modiﬁed Legendre transform (16), respectively. The lines are the
theoretical values obtained from Eq. (20).

11

t
t
t
t
a
a
a
 

 

 

0

 

10-1

(a)

10-3

)
s
(

F

q

10-5

101

(b)

(c)

)
q
(
h

)
q
(

 

1.2
1.0
0.8
0.6

10

0

-10

-20

(a) 

101

(b)

(c)

103

)
s
(

101

q

F

10-1

10-3

)
q
(
h

)
q
(

 t

2

1

0
0
-10
-20
-30
-40

102

s

103

104

 l  = 1, d  = 0.90, g  = -d 4/2
 l  = ln 2, d  = 0.90, g  = -d 4/2
 l  = 1, d  = 0.93, g  = -2d 4/5

FIG. 4. (a) The modiﬁed and rescaled MF-DFA3 ﬂuctuation func-
tions ˜Fq(s)/s[∼= Fq(s)] are shown versus the scale s in a log-log
plot for a series of independent numbers with a power-law probabil-
−(α+1) with α = 1. The symbols
ity density distribution P (x) ∼ x
are the same as for Fig. 1. The straight dashed lines have the cor-
responding theoretical slopes h(−10) = 1 and h(+10) = 0.1 and
are shown for comparison. (b) The q dependence of the generalized
Hurst exponent h(q) = ˜h(q) − 1 determined by ﬁts on large scales s
is shown for MF-DFA3 and α = 0.5 (2), 1.0 (◦), and 2.0 (△). The
lines are the theoretical values obtained from Eq. (27). In part (c) the
corresponding τ (q) is shown. The broad distribution of the values
leads to multifractality (bi-fractality) in all three cases.

 

 

 

103

(a)

-20

-10

0

q

10

20

FIG. 3. (a) The MF-DFA2 ﬂuctuation functions Fq(s) are shown
versus the scale s in a log-log plot for the dyadic random cascade
model with log-Poisson distribution with parameters λ = 1, δ = 0.9,
and γ = −δ4/2. The symbols are the same as for Fig. 1. The
dashed straight lines have the theoretical slopes h(−10) = 0.743
and h(+10) = 0.567 and are shown for comparison.
(b) The q
dependence of the generalized Hurst exponent h(q) determined by
ﬁts is shown for MF-DFA2 and different parameters (see legend).
The lines are the theoretical values obtained from Eq. (23). In part
(c) τ (q) = qh(q) − 1 is shown.

 

)
s
(

10-2

f
u
h
s

0
1
±
F

10-7

)
s
(

f
u
h
s

0
1
±
F

 
/
 
)
s
(

0
1
±
F

100

10-2

10-4

10-6

10-12

101

(b)

102

 
s

103

104

 

102

s

103

104

 a
 a
 a

 = 0.5
 = 1.0
 = 2.0

-20

-10

q

10

20

 

101

102

s

103

104

10

FIG. 5.

(a) The MF-DFA ﬂuctuation functions F shuf

−10 (s) (open
symbols) and F shuf
(s) (ﬁlled symbols) are shown versus the scale s
in a log-log plot for randomly shufﬂed series of long-range correlated
series with H = 0.75 (2), for the dyadic random cascade model with
log-Poisson distribution with parameters λ = ln 1, δ = 0.9, and
γ = −δ4/2 (◦), and for power-law distributed random numbers xk
−2 (△). The correlations and the multifractality are
with P (x) ∼ x
destroyed by the shufﬂing procedure for the ﬁrst two series, but for
the broadly distributed random numbers the multifractality remains.
The dashed line has the slope H = 0.5 and is shown for comparison.
(b) The ratios of the MF-DFA2 ﬂuctuation functions Fq(s) of the
original series and the MF-DFA2 ﬂuctuation functions F shuf
(s) of
the randomly shufﬂed series are shown versus s for the same mod-
els as in (a), correlated series (▽), dyadic random cascade model
(3), and power-law distributed random numbers (+ for q = −10,
× for q = +10). The deviations from the slope hcor = 0 indicate
long-range correlations.

q

 

 

12

t
t
t
 

 

0

 

 

 

FIG. 7.

(a) Histograms of the generalized Hurst exponents
h(−10) (black bars) and hshuf (−10) (grey bars) for 100 gener-
ated monofractal series with H = 0.75. The exponents have
been ﬁtted to MF-DFA2 ﬂuctuation functions in the scaling range
400 < s < 2000.
(b) Same as (a), but for h(+10) and
hshuf (+10).
(c,d) Same as (a,b), but for the dyadic random cas-
cade model with log-Poisson distribution and parameters λ = ln 1,
δ = 0.9, and γ = −δ4/2. The corresponding theoretical values are
h(−10) = 0.743 and h(+10) = 0.567 from Eq. (23) for the original
series and hshuf = 0.5 for the shufﬂed series. From the histogram
of h(+10) it would be hard to draw any conclusions regarding mul-
tifractality. (e,f) Same as (a,b), but for power-law distributed random
−2. The corresponding the-
numbers with the distribution P (x) ∼ x
oretical values from Eq. (27) are h(−10) = 1 and h(+10) = 0.1
for the original and the shufﬂed series. The length of all series is
L = 8192. The ﬁgure shows that correlations and multifractality due
to correlations (a-d) are eliminated by the shufﬂing procedure, while
multifractality due to a broad distribution (e,f) remains. It further al-
lows to estimate the statistical ﬂuctuations in the scaling exponents
h(q) determined by the MF-DFA for monofractal (a,b), correlation
multifractal (c,d) and distribution multifractal (e,f) series.

(a)

(b)

)
q
(

f
u
h
s
h

1.0

0.5

)
q
(

f
u
h
s

10

0

-10

-20

(a)

(c)

(e)

60

40

20

0

60

40

20

0

60

40

20

s
e
i
r
e
s
 
f
o
 
#

s
e
i
r
e
s
 
f
o
 
#

s
e
i
r
e
s
 
f
o

 

#

-20

-10

q

10

20

FIG. 6. (a) The q dependence of the slopes hshuf (q) of the same
models as in Fig. 5(a). The lines indicate the theoretical values:
H = 0.5 for shufﬂed data with narrow distribution, and h(q) from
Eq. (27) for the series of numbers with a power-law probability den-
sity distribution. The symbols are the same as in Fig. 5. Part (b)
shows τshuf (q) = qhshuf (q) − 1.

 

 

 

 

(b)

(d)

 

 

 

 

 

 
0.4 0.5 0.6 0.7 0.8

 
0.4 0.5 0.6 0.7 0.8

(f)

 original
 shuffled

 

 

 

(d)

101

(c)

102

s

103

 linear trend, MF-DFA2
 linear trend, WTMM
 quadratic trend, MF-DFA2
 quadratic trend, WTMM
 quadratic trend, MF-DFA3

 

0
1.0 1.1 1.2 1.3 1.4 1.5
10), hshuf(-

10)

h(-

0.0 0.1 0.2 0.3 0.4
h(+10), hshuf(+10)

-20

-10

q

10

20

 

 q = 10
 q = 2
 q = 0.2
 q =  -0.2
 q =  -2
 q = -10

 

 

 

 

 

0

 

(a)

(b)

)
s
(

F

q

10-3
10-5
10-7
10-9

q
/
)
)
s
,

q
(
Z
 
s
(

g
o
l

0
1

2
0
-2
-4
-6

2.5
2.0
1.5
1.0
0.5

0

-20

-40

)
q
(
h

)
q
(

 t

13

t
t
-
-
t
FIG. 8. (a) The MF-DFA2 ﬂuctuation functions Fq(s) are shown
versus the scale s in log-log plots for the binomial multifractal model
with a = 0.75 and an additional linear trend xk → xk +k/500L. (b)
The scaled WTMM partition functions [sZ(q, s)]1/q are shown for
the same series and the same values of q. The symbols are the same
as for Fig. 1. (c) The q dependence of the generalized Hurst expo-
nent h(q) for the generated series with linear trend for the MF-DFA2
(2) and the second order WTMM (◦) methods. Corresponding re-
sults for a binomial multifractal with an additional quadratic trend
are also included for MF-DFA2 (△) and second order WTMM (▽)
methods. The quadratic trend causes deviations from the line indicat-
ing the theoretical values [obtained from Eq. (20)], which disappear
if MF-DFA3 is employed (×). The values of h(q) have been deter-
mined by ﬁts to Fq(s) and Z(q, s) in the regime 50 < s < 2000.
The relation h(q) = [˜τ (q) + 1]/q from Eq. (13) has been used to
convert the exponent ˜τ (q) from Eq. (31) into h(q). (d) The q depen-
dence of τ (q).

100

(a)

100
0

(c)

80

60

40

20

80

60

40

20

s
e
i
r
e
s
 
f
o
 
#

s
e
i
r
e
s
 
f
o
 
#

0
1.7

 

 

(b)

 MF-DFA
 WTMM

(d)

 

 

 

 

 

 

 

1.8

1.9
10)

h(-

2.0

0.4

0.5
h(+10)

0.6

FIG. 10. Same as Fig. 9 for the binomial model with a = 0.75.
The theoretical values of the generalized Hurst exponents are
h(−10) = 1.90 and h(+10) = 0.515 according to Eq. (20).
The ﬁgure shows that our ﬁndings regarding the performance of the
MF-DFA and WTMM methods for uncorrelated monofractal series
in Fig. 9 also hold for multifractal series.

 

 

 

 

 

(b)

 MF-DFA
 WTMM

 

(d)

60 (a)

0
60 (c)

s
e
i
r
e
s
 
f
o
 
#

40

20

s
e
i
r
e
s
 
f
o
 
#

40

20

0

 

 

 

0.5

0.6

h(-

10)

0.7

0.4

0.5
h(+10)

0.6

FIG. 9.

(a) Histograms of the generalized Hurst exponents
h(−10) for 100 random uncorrelated series with H = 0.5. The ex-
ponents have been ﬁtted to MF-DFA2 ﬂuctuation functions F−10(s)
(black bars) in the scaling range 40 < s < 2000 and to WTMM
results Z(−10, s) (grey bars) in the scaling range 5 < s < 250. The
length of the series is L = 8192. The relation h(q) = [ˆτ (q) + 1]/q
from Eq. (13) has been used to convert the exponent ˆτ (q) from
Eq. (31) into h(q).
(c,d) Same
as (a,b), but for longer series (L = 65536), where statistical ﬂuc-
tuations are reduced. The ﬁgure shows that the MF-DFA seems to
give slightly more reliable results than the WTMM method for short
series and negative moments (q = −10), see (a). In the other cases,
the performance of both methods is similar.

(b) Same as (a), but for h(+10).

14

-
-
