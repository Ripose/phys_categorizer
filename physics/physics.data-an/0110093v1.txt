1
0
0
2
 
t
c
O
 
1
3
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
3
9
0
0
1
1
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Bayesian inference for inverse problems

Ali Mohammad-Djafari

Laboratoire des Signaux et Systèmes,
Supélec, Plateau de Moulon, 91192 Gif-sur-Yvette, France

Abstract. Traditionally, the MaxEnt workshops start by a tutorial day. This paper summarizes my
talk during 2001’th workshop at John Hopkins University. The main idea in this talk is to show how
the Bayesian inference can naturally give us all the necessary tools we need to solve real inverse
problems: starting by simple inversion where we assume to know exactly the forward model and
all the input model parameters up to more realistic advanced problems of myopic or blind inversion
where we may be uncertain about the forward model and we may have noisy data.

Starting by an introduction to inverse problems through a few examples and explaining their
ill posedness nature, I brieﬂy presented the main classical deterministic methods such as data
matching and classical regularization methods to show their limitations. I then presented the main
classical probabilistic methods based on likelihood, information theory and maximum entropy and
the Bayesian inference framework for such problems. I show that the Bayesian framework, not
only generalizes all these methods, but also gives us natural tools, for example, for inferring the
uncertainty of the computed solutions, for the estimation of the hyperparameters or for handling
myopic or blind inversion problems. Finally, through a deconvolution problem example, I presented
a few state of the art methods based on Bayesian inference particularly designed for some of the
mass spectrometry data processing problems.

INTRODUCTION

Forward and inverse problems

In experimental science, it is hard to ﬁnd an example where we can measure directly
a desired quantity. Describing mathematical models to relate the measured quantities to
the unknown quantity of interest is called forward modeling problem. The main object
of a forward modeling is to be able to generate data which are as likely as possible to the
observed data if the unknown quantity was known. But, almost always, we want to use
this model and the observed data to make inference on the unknown quantity of interest:
This is the inversion problem. To be more explicit, let take an example that we will use
all along this paper to illustrate the different aspects of inverse problems. The example
is taken from the mass spectrometry where the ideal physical quantity of interest is the
components mass distribution of the material under the test. There are many techniques
used in mass spectrometry. The Time-of-Flight (TOF) technique is one of them. In this
technique, one measures the electrical current generated on the surface of a detector by
the charged ions generated by the material under the test. Finding a very ﬁne physical
model to relate the time variation of this current to the distribution of the arrival times
of the charged ions, which is itself related to the components mass distribution of the
material under the test, is not an easy task. However, in a ﬁrst approximation, assuming

that the instrument is linear and its characteristics do not change during the acquisition
time of the experiment, a very simple convolution model relates the raw data g(t) to the
unknown quantity of interest f (t):

g(τ ) =

f (t) h(τ − t) dt,

(1)

Z

where h(t) is the point spread function (psf) of the instrument. Figure 1 shows an
example of data observed (signal in b) for a theoretical mass distribution (signal in a).

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

0

100

200

300

400

500

600

700

800

900

1000

0

100

200

300

400

500

600

700

800

900

1000

FIGURE 1. Blurring effect in TOF mass spectrometry data:
observed data.

a) desired or theoretical spectrum, b)

In this example, the forward problem consists in computing g given f and h which is
given by a simple convolution operation. The inverse problem of inferring f given g and
h is called deconvolution, the inverse problem of inferring h given g and f is called psf
identiﬁcation and the inverse problem of inferring h and f given only g is called blind
deconvolution.

In my talk, I have given many more examples such as image restoration

or Fourier synthesis inversion

g(x′, y′) =

f (x, y) h(x′ − x, y′ − y) dx dy,

Z Z

Z

g(τ ) =

f (ω) exp {−jωτ } dω

(2)

(3)

as well as a few non linear inverse problems. I am not going to detail them here, but I
try to give a uniﬁed method to deal with all these problems. For this purpose, ﬁrst we
note that, in all these problems, we have always limited the number of data, for example

yi = g(τi), i = 1, . . . , m. We also note that, to be able to do numerical computation, we
need to model the unknown function f by a ﬁnite number of parameters x = [x1, . . . , xn].
As an example, we may assume that

n

f (t) =

xjbj(t)

(4)

j=1
X
where bj(t) are known basis functions. With this assumption the raw data
y = [y1, . . . , ym] are related to the unknown parameters x by

yi = g(τi) =

Hi,j xj with Hi,j =

bj(t)h(t − τi) dt

(5)

n

j=1
X

ZZ

which can be written in the simple matrix form y = Hx. The inversion problem can
then be simpliﬁed to the estimation of x given H and y. Two approaches are then in
competition:
i) the dimensional control approach which consists in an appropriate choice of the basis
functions bj(r) and n ≤ m in such a way that the equation y = Ax be well conditioned;
ii) the more general regularization approach where a classical sampling basis for bj(r)
with desired resolution is chosen no matter if n > m or if A is ill conditioned. In
the following, we follow the second approach which is more ﬂexible for adding more
general prior information on x.

We must also remark that, in general, it is very difﬁcult to give a very ﬁne mathe-
matical model to take account for all the different quantities affecting the measurement
process. However, we can almost always come up with a more general relation such as

yi = hθ(x) + ǫi,

i = 1, . . . , m

(6)

where θ represents the unknown parameters of the forward model (for example the
amplitude and the width of a Gaussian shape psf in a deconvolution problem) and
ǫ = [ǫ1, . . . , ǫm] represents all the errors (measurement noise, discretization errors and
all the other uncertainties of the model). For the case of linear models we have

y = Hθx + ǫ.
In this paper we focus on this general problem. We ﬁrst consider the case where the
model is assumed to be perfectly known. This is the simple inversion problem. Then we
consider the more general case where we have also to infer on θ. This is the myopic or
blind inversion problem.

(7)

Even in the simplest case of perfectly known linear system and exact data:

i) the operator H may not be invertible (H −1 does not exist);
ii) it may admit more than one inverse (∃G1 and G2|G1(H) = G2(H) = I where I is
the identity operator); or
iii) it may be very ill-posed or ill-conditioned (meaning that there exists x and x + αδx
for which

never vanishes even if α 7→ 0 [1, 2].

H −1(x) − H −1(x + αδx)

These are the three necessary conditions of existence, uniqueness and stability of
Hadamard for the well-posedness of an inversion problem. This explains the fact that,

(cid:13)
(cid:13)

(cid:13)
(cid:13)

in general, even in this simple case, many naïve methods based on generalized inversion
or on least squares may not give satisfactory results. The following ﬁgure shows, in a
simple way, the ill-posedness of a deconvolution problem. On this ﬁgure, we see that
three different input signals can result three outputs which are practically indistinguish-
able from each other. This means that, data matching alone can not distinguish between
any of these inputs.

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

1

0.8

0.6

0.4

0.2

0

0

100

200

300

400

500

600

700

800

900

1000

−→

−→

1

0.8

0.6

0.4

0.2

0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
−10

0

100

200

300

400

500

600

700

800

900

1000

−8

−6

−4

−2

0

2

4

6

8

10

0

100

200

300

400

500

600

700

800

900

1000

0

100

200

300

400

500

600

700

800

900

1000

FIGURE 2.
able outputs.

Ill-posedness of a deconvolution problem: Inputs on the left give practically indistinguish-

As a conclusion, we see that, apart from the data, we need extra information. The art of
inversion in a particular inverse problem is how to include just enough prior information
to obtain a satisfactory result. In the following, ﬁrst we summarize the classical deter-
ministic approaches of data matching and regularization. Then, we focus on probabilistic
approaches where errors and uncertainties are taken into account through the probability
laws. Here, we distinguish, three classes of methods: those which only account for the
data errors (error probability distribution matching and likelihood based methods), those
which only account for uncertainties of unknown parameters (entropy based methods)
and those which account for both of them (Bayesian inference approach).

DATA MATCHING AND REGULARIZATION METHODS

Exact data matching

Let consider the discretized equation yi = hi(x) + ǫi, i = 1, . . . , m; and assume ﬁrst

that the model and data are exact (ǫi = 0). We can then write y = h(x).

Assume now the system of equations is under determined, i.e., there is more than one
solution satisfying it (for example when the number of data is less than the number of
unknowns). Then, one way to obtain a unique solution is to deﬁne an a priori criterion,
for example ∆(x, m) to choose that unique solution by

(8)

(9)

x = arg min
h(x)=y

{∆(x, m)}

where m is an a priori solution and ∆ a distance measure.

b

In the linear inverse problems case, the solution to this constrained optimization
can be obtained via Lagrangian techniques which consists in deﬁning the Lagrangian
L(x, λ) = ∆(x, m) + λt(y − Hx) and searching for (

x) through

λ,

λ = arg minλ {D(λ) = infx L(x, λ)}
x = arg minx
L(x,
b

λ)

b

b

(

b

n
Noting that ∇xL = ∇x∆(x, m) − H tλ and ∇λL = y − Hx and deﬁning G(s, m) =
supx{xts − ∆(x, m)} the algorithm to ﬁnd the solution
– Determine G(s, m) = supx{xts − ∆(x, m)};
D(λ) = λty − G(H tλ, m)
– Find
– Determine

λ = arg minλ

x becomes:

o

b

b

;

(cid:9)

2 kx − mk2 then G(s, m) = mts + 1

H tλ

2 which results to

2 ksk2, ∇sG =
λ = (HH t)−1(y −

b

λ).

x = ∇sG(H t
As an example, when ∆(x, m) = 1
m + s and D(λ) = λty − mtH tλ + 1
2
Hm) and the solution is given by

(cid:8)

b

b

x = m + H t(HH t)−1(y − Hm).

(10)

b

(cid:13)
(cid:13)

(cid:13)
(cid:13)

One can remark that, when m = 0 we have
minimum norm generalized inverse solution.

b

x = H t(HH t)−1y and this is the classical

Another example is the classical Maximum Entropy method case where ∆(x, m) =
b
KL(x, m) is the Kullback-Leibler distance or cross entropy between x and the a priori
solution m:

KL(x, m) =

xj ln

− (xj − mj)

(11)

xj
mj

j
X

Here, the solution is given by

xj = mj exp

−[At

λ]j

with

λ = arg min

D(λ) = λty − G(Atλ, m)

(12)

h

i

b

b

λ

(cid:8)

(cid:9)

b

where G(s, m) =
j mj (1 − exp [−sj]). But, unfortunately here D(λ) is not a quadratic
function of λ and thus there is not an analytic expression for
λ. However, it can
be computed numerically and many algorithms have been proposed for its efﬁcient
computation. See for example [3] and the cited references for more discussions on the
computational issues and algorithm implementation.

P

b

The main issue here is that, this approach gives a satisfactory solution to the unique-
ness of the inverse problem, but in general, the performances obtained by the resulting
algorithms stay sensitive to error on the data.

Least squares data matching and regularization

When the discretized equation y = h(x) is over-determined, i.e., there is no solution
satisfying it exactly (for example when the number of data is greater than the number of
unknowns or when the data are not exact), one can try to estimate them by:

x = arg min

{∆(y, h(x))} ,

x

(13)

(14)

where ∆(y, h(x)) is a distance measure in the data space. The case where ∆(y, h(x)) =
ky − h(x)k2 is the classical Least Squares (LS) criterion.

b

For a linear inversion problem y = Hx, it is easy to see that any

x which satisﬁes
x = H ty is a LS solution. If H tH is invertible and well-
the normal equation H tH
x = (H tH)−1H ty is again the unique generalized inverse solution.
conditioned then
But, in general, this is not the case: H tH is rank deﬁcient and we need to constrain the
space of the admissible solutions. The constraint LS is then deﬁned as

b

b

b

x = arg min

ky − Hxk2

.

x∈C

(cid:8)
where C is a convex set. The choice of the set C is primordial to satisfy the three
conditions of a well-posed solution. An example is the positivity constraint: C = {x :
∀j, xj > 0}. Another example is C = {x : kxk < α} where the solution can be computed
via the optimization of

(cid:9)

b

J(x) = ky − H(x)k2 + λ kxk .

(15)

The main technical difﬁculty is the relation between α and λ. The minimum norm LS
solution can also be computed using the singular value decomposition [4]. The main
issue here is that, even if this approach has been well understood and commonly used,
it assumes implicitly that the noise and the x are Gaussian. This may not be suitable in
some applications, and more speciﬁcally in mass spectrometry data processing where
the unknowns are spiky spectra.

A more general regularization procedure is to deﬁne the solution to the inversion
problem y = H(x) + ǫ as the optimizer of a compound criterion J(x) = ky − Hxk2 +
λφ(x) or the more general criterion

J(x) = ∆1(y, Hx) + λ∆2(x, m).

(16)

where ∆1 and ∆2 are two distances or discrepancy measures, λ a regularization param-
eter and m an a priori solution[5]. The main questions here are: i) how to choose ∆1
and ∆2 and ii) how to determine λ and m.

For the ﬁrst question, many choices exist:

– Quadratic or L2 distance: ∆(x, z) = kx − zk2 =
– Lp distance: ∆(x, z) = kx − zkp =
j |xj − zj|p;
– Kullback distance: ∆(x, z) =
j xj ln(xj/zj) − (xj − zj);
– Roughness distance: ∆(x, z) any of the previous distances with zj = xj−1 or zj =
(xj−1 + xj+1)/2 or any linear function zj = ψ(xk, k ∈ N (j)) where N (j) stands for
the neighborhood of j. (One can see the link between this last case and the Gibbsian
energies in the Markovian modeling of signals and images.)

j(xj − zj)2;

P

P

P

The second difﬁculty in this deterministic approach is the determination of the reg-
ularization parameter λ. Even if there are some techniques based on cross validation
[6, 7, 8], there is not natural tools for their extension to other hyperparameters in a nat-
ural way.

As a simple example, we consider the case where both ∆1 and ∆2 are quadratic:
Q. The optimization problem, in this case, has an

W + λ kx − mk2

J(x) = ky − Hxk2
analytic solution:

x =

H tW H + λQ

H tW y − Qm)

−1

which can also be written

(cid:0)

(cid:1)

(cid:0)

(cid:1)

b
x = m + Q−1H t

HQ−1H t + λ−1W −1

−1

(y − Hm)

(17)

(18)

(cid:0)

(cid:1)

b

HH t + λ−1I
H tH

which is a linear function of the a priori solution m and the data y. Note also
that when m = 0, Q = I and W = I we have
x =
x =
−1 y and when λ = 0 we obtain the generalized inverse solutions
H t
b
x =
(cid:0)
As we mentioned before, the main practical difﬁculties in this approach are the choice
(cid:0)
of ∆1 and ∆2 and the determination of the hyperparameters λ and the inverse covariance
b
matrices W and Q.

−1 H ty or
(cid:1)

−1 H ty or

H tH + λI

x = H t

HH t

−1 y.

b

b

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:1)

As a main conclusion on these deterministic inversion methods, we can say that,
even if, in practice, they are used and give satisfaction, they lack tools to handle with
uncertainties and to account for more precise a priori knowledge of statistical properties
of errors and unknown parameters. The probabilistic methods can exactly handle more
easily these problems as we will see in the following.

PROBABILISTIC METHODS

Probability distribution matching and maximum likelihood

The main idea here is to account for data and model uncertainty through the as-
signment of a theoretical distribution pY |X(y|x) to the data. In probability distribution
matching method, the main idea is to determine the unknown parameters x by minimiz-
ing a distance measure ∆(ρ, p) between the empirical histogram ρ of the data deﬁned

as

we have

ρ(z)

△
=

1
N

i
X

δ(zi − yi)

(19)

and the theoretical distribution of the data pY |X(z|x).

When ∆(p, ρ) is choosed to be the Kullback-Leibler mismatch measure

KL[ρ, p]

ρ(z) ln

ρ(z)
pY |X(z|x)

dz

△
=

ZZ
= −

ZZ

ρ(z) ln pY |X(z|x) dz +

ρ(z) ln ρ(z) dz

(20)

ZZ

x = arg min

{KL [ρ, p]} = arg min

−

ρ(z) ln pY |X(z|x) dz

.

(21)

x

x

(cid:26)

ZZ

(cid:27)

It is then easy to see that, for the i.i.d. data, this estimate becomes equivalent to the
maximum likelihood (ML) estimate

b

x

(cid:8)

x = arg min

− ln pY |X(z|x)|z=y

pY |X(y|x)

.

(22)

= arg max
x

In the case of a linear model and Gaussian noise, it is easy to show that the ML estimate
becomes equivalent to the LS one, which in general, does not give satisfactory results as
we have discussed it in the previous section.

b

(cid:9)

(cid:8)

(cid:9)

The important point to note here is that, in this approach, only the data uncertainty
is considered and modeled through the probabilty law pY |X(y|x). We will see in the
following that, in contrary to this approach, in information theory and maximum entropy
methods, the data and model are assumed to be exact and only the uncertainty of
x is modeled through an a priori reference measure µ(x) which is updated to an a
posteriori probabilty law p(x) by optimizing the KL mismatch KL(p, µ) subject to the
data constraints.

Maximum entropy in the mean

The main idea in this approach is to consider x as the mean value of a quantity X ∈ C,
where C is a compact set on which we want to deﬁne a probability law P : x = EP {X}
and the data y as exact equality constraints on it:

y = Hx = HEP {X} =

Hx dP (x).

(23)

ZZC

Then, assuming that we can translate our prior information on the unknowns through a
prior law (a reference measure) dµ(x), we can determine the distribution P by:

maximize −

ln

dP (x)

s.t. y = Hx = HEP {X} .

(24)

dP (x)
dµ(x)

ZZC

The solution is obtained via the Lagrangian:

ln

L(x, λ) =

ZZC (cid:20)
dP (x, λ) = exp

dP (x)
dµ(x)

− λt(y − Hx)

dP (x)

(cid:21)

and is given by:

λt[Hx] − ln Z(λ)

dµ(x), where

Z(λ) =

exp

λt[Hx]

dµ(x). The Lagrange parameters are obtained by searching

(cid:2)

(cid:3)

ZZC

the unique solution (if exists) of the following system of non linear equations:

(cid:2)

(cid:3)

∂ ln Z(λ)
∂λi

= yi,

i = 1, · · · , M.

(25)

x(λ) = EP {X} =

Then, naturally, the solution to the inverse problem is deﬁned as the expected value of
x dP (x, λ). The interesting point here is that,
this distribution:
the solution
– Via optimization of a dual criterion: The solution
b
s = H t
dual variable
b

λ) can be computed without actually computing P in two ways:

x is expressed as a function of the

s) = ∇sG(

λ by

x(

x(

b

R

s, m) where
b

G(s, m) = ln Z(s, m) = ln
b

b

b

b

exp

stx
b

dµ(x), m = Eµ {X} =

x dµ(x)

ZZC

(cid:2)

(cid:3)

ZZC

and

λ = arg max

D(λ) = λty − G(H tλ)

.

(cid:9)
– Via optimization of a primal or direct criterion:

(cid:8)

λ

b
x = arg min

x∈C

{H(x, m)} s.t. y = Hx where H(x, m) = sup
s

{stx − G(s, m)}.

b

Another interesting point is the link between these two options:
i) Functions G and H depend on the reference measure µ(x);
ii) The dual criterion D(λ) depends on the data and the function G;
iii) The primal criterion H(x, m) is a distance measure between x and m which means:
H(x, m) ≥ 0 and H(x, m) = 0
iff x = m; H(x, m) is differentiable and convex
on C and H(x, m) = ∞ if x 6∈ C;
iv) If the reference measure is separable: µ(x) =
dP (x, λ) =

N
j=1 µj(xj) then P is too:

N
j=1 dPj(xj, λ) and we have

Q

G(s, m) =

j
X

gj (sj, mj) , H(x, m) =

hj(xj, mj),

xj = g′

j(sj, mj).

Q

j
X

where gj is the log Laplace transform (Cramer transform) of µj:

b

and hj is the convex conjugate of gj:

{sx − gj(s)}.

gj(s) = ln

exp [sx] dµj(x);

Z
hj(x) = max

s

The following table gives three examples of choices for µj and the resulting expres-

sions for gj and hj:

µj(x)

Gaussian:
Poisson:
Gamma:

exp

− (1/2) (x − m)2
(mx/x!) exp [−m]
xα−1 exp [− (x/m)]

(cid:2)

(cid:3)

gj(s)
(1/2) (s − m)2
exp [m − s]
ln(s − m)

hj(x, m)
(1/2) (x − m)2
−x ln (x/m) + m − x
− ln (x/m) + (x/m) − 1

We may remark that the two famous expressions of the Burg ln x and Shannon −x ln x
entropies are obtained as special cases.

As a conclusion, we see that the Maximum entropy in mean extends in some way the
classical ME approach by giving other expressions for the criterion to optimize. Indeed,
it can be shown that when we optimize a convex criterion subject to the data constraints
we are optimizing the entropy of some quantity related to the unknowns and vise versa.
However, as we have mentioned, basically, in this approach the data and the model are
assumed to be exact even if some extensions to the approach gives the possibility to
account for the errors [9]. In the next section, we see how the Bayesian approach can
naturally account for both uncertainties on the data and on the unknown parameters x.

BAYESIAN INFERENCE APPROACH

In Bayesian approach, the main idea is to translate our prior knowledge on the errors
ǫ and on the unknowns x to prior probability laws p(ǫ) and p(x). The next step is to
use the forward model and p(ǫ) to deduce p(y|x). The Bayes rule can then be used to
determine the posterior law of the unknowns p(x|y) from which we can deduce any
information about the unknowns x. The posterior p(x|y) is thus the ﬁnal product of the
Bayesian approach. However, very often, we need a last step which is to take out the
necessary information about x from this posterior. The tools for this last step are the
decision and estimation theories.

To illustrate this, let consider the case of linear inverse problems y = Hx + ǫ. The
ﬁrst step is to write down explicitly our hypothesis: starting by the hypothesis that ǫ is
zero-mean (no systematic error), white (no time correlation for the errors) and assuming
that we may only have some idea about its energy σ2
ǫ = 1/(2φ1), and using either
the intuition or the Maximum Entropy Principle (MEP) lead to a Gaussian prior law:
ǫ ∼ N (0, 1/(2φ1)I). Then, using the forward model with this assumption leads to:

p(y|x, φ1) ∝ exp

−φ1ky − Hxk2

.

(26)

The next step is to assign a prior law to the unknowns x. This step is more difﬁcult and
(cid:2)
needs more caution. In inverse problems, as we presented, x represents the samples of a
signal or the pixel values of an aerian image. Very often then we have ensemblist prior
knowledge about the signals or images concerned by the application and we can model
them. The art of the engineer is then to choose the appropriate model and to translate
this information to a probability law to reﬂect it.

(cid:3)

Again here, let illustrate this step, ﬁrst through a few general examples and then more

speciﬁcally the case of mass spectrometry deconvolution problem.

In the ﬁrst example, we assume that, a priori we do not have (or we do not want
or we are not able to account for) any knowledge about the correlation between the
components of x. This leads us to

p(x) =

pj(xj).

(27)

j
Y
Now, we have to assign pj(xj). For this, we may assume to know the mean values mj
and some idea about the dispersions about these mean values. This again leads us to
Gaussian laws N (mj, σ2
xj = 1/(2φ2), ∀j we
obtain

xj ), and if we assume the same dispersions σ2

p(x) ∝ exp

−φ2

|xj − mj|2

= exp

−φ2 kx − mk2

(28)

(cid:2)
With these assumptions, using the Bayes rule, we obtain

"

j
X

#

(cid:3)

p(x|y) ∝ exp

−φ1 ky − Hxk2 − φ2 kx − mk2

.

(29)

(cid:3)

(cid:2)

This posterior law contains all the information we can have on x (combination of our
prior knowledge and data). If x was a scalar or a vector of only two components, we
could plot the probability distribution and look at it. But, in practical applications, x may
be a vector with huge number of components. Then, even if we can obtain an expression
for this posterior, we may need to summarize its information content. In general then, we
may choose, equivalently, between summarizing it by its mode, mean, marginal modes,
etc . . . , or use the decision and estimation theory to deﬁne point estimators to be used
x which
to compute (best representing values). For example, we can choose the value
corresponds to the mode of p(x|y)– the Maximum a posteriori (MAP) estimate, or the
x which corresponds to the mean of this posterior– the Posterior mean (PM)
value
estimate, or when interested to the component xj, to choose
xj corresponding to the
mode of the posterior marginal p(xj|y).

b

We can also generate samples from this posterior and just look at them as a movie
or use them to compute the PM estimate. We can also use it to compute the posterior
covariance matrix (P = E {(x −
x is the posterior mean), from
which we can infer on the uncertainty of the proposed solutions.

x)t} where

x)(x −

b

b

In the Gaussian priors case we just presented, it is easy to see that, the posterior law is
b
also Gaussian and all these estimates are the same and can be computed by minimizing

b

b

J(x) = − ln p(x|y) = ky − Hxk2 + λ kx − mk2 with λ =

(30)

φ2
φ1

=

σ2
ǫ
σ2
x

.

We may note here the analogy with the quadratic regularization criterion (16) with the
emphasis that the choice ∆1(y, Hx) = ky − Hxk2 and ∆2(x, m) = kx − mk2 are
the direct consequences of Gaussian choices for prior laws of the noise p(ǫ) and the
unknowns p(x).

The Gaussian choice for pj(xj) is not always a pertinent one. For example, we may
a priori know that the distribution of xj around their means mj are more concentrated

but great deviations from them are also more likely than a Gaussian distribution. This
knowledge can be translated by choosing a Generalized Gaussian law:

p(xj) ∝ exp

−

|xj − mj|p

,

1 ≤ p ≤ 2.

1
2σ2
x

(cid:20)

(cid:21)

In some cases we may know more, for example we may know that xj are positive

values. Then a Gamma prior law

p(xj) = G(α, mj) ∝ (xj/mj)−α exp [−xj/mj]

would be a better choice.

prior law

In some other cases we may know that xj are discrete positive values. Then a Poisson

(31)

(32)

(33)

p(xj) ∝

exp [−mj]

mxj
j
xj!

is a better choice.

In all these cases, the expression of the posterior is p(x|y) ∝ exp [−J(x)] with J(x) =
ky − Hxk2 + λφ(x) where φ(x) = − ln p(x). It is interesting to note the different
expressions of φ(x) for the prior laws discussed and remark that they contain different
entropy expressions for the x.

The last general example is the case where a priori we know that xj are not indepen-
dent, for example when they represents the pixels of an aerian image. We may then use
a Markovian modeling

p(xj|xk, k ∈ S) = p(xj|xk, k ∈ N (j)),

(34)

where S = {1, . . . , N} stands for the whole set of pixels and N (j) = {k : |k − j| ≤ r}
stands for r-th order neighborhood of j.

With some assumptions on the border limits, such models again result to the opti-

mization of the same criterion with

φ(x) = ∆2(x, z) =

φ(xj, zj) where zj = ψ(xk, k ∈ N (j))

(35)

j
X

with different potential functions φ(xj, zj).

A simple example is the case where zj = xj−1 and φ(xj, zj) any function in between

the following:

|xj − zj|α, α ln

xj ln

+ (xj − zj)

xj
zj

+

xj
zj

,

xj
zj

(cid:27)

(cid:26)

See ([10, 11, 12, 13]) for some more discussion and properties of these potential func-
tions.

As one of the main conclusions here, we see that, as it concerns the MAP estimation,
the Bayesian approach is equivalent to the general regularization. However, here the

choice of the distance measure ∆1(y, Hx) depends on the forward model and the
hypothesis on the noise and the choice of the distance measure ∆2(x, m) depends on
the prior law chosen for x.

One more extra feature here is that, we have access to the whole posterior p(x|y) from
which, not only we can deﬁne an estimate but also, we can quantify its corresponding
remained uncertainty. We can also compare posterior and prior laws of the unknowns to
measure the amount of information contained in the observed data. Finally, as we will
see in the following, we have ﬁner tools to model unknown signals or images and to
estimate the hyperparameters.

OPEN PROBLEMS AND ADVANCED METHODS

As we have remarked in previous sections, in general, the solution of an inverse problem
depends on our prior hypothesis on errors ǫ and on x. Before applying the Bayes rule,
we have to assign the prior laws to them. From the forward model and assumptions
on ǫ we assign p(y|x, φ1) and from the assumptions on x we assign p(x|φ2). This
step is one of the most crucial part of the applicability of the Bayesian framework for
inverse problems. Modeling a signal and ﬁnding the corresponding expression for the
prior law p(x|φ2) is not an easy task. This choice may have many consequences: the
complexity of the computation of the posterior and consequently the computation of
any point estimators such as MAP (which needs optimization) or PM (which needs
integration either analytically or by Monte Carlo methods). This modeling depends also
on the application. We discuss this point through the particular deconvolution problem
in mass spectrometry.

Appropriate modeling of input signal

We actually had started this discussion in previous section and we saw that, at least
for linear inverse problems with a white Gaussian assumption of the noise, the posterior
has for expression: p(x|y) ∝ exp [−J(x)] with

J(x) = ky − Hxk2 + λφ(x)

(36)

with φ(x) = − ln p(x). Thus the expression and properties of J(x), and consequently
those of the posterior p(x|y) depend on the prior p(x). For example if p(x) is Gaussian
then

φ(x) = − ln p(x) =

x2
j

j
X

is a quadratic function of x. Then the MAP or PM estimates have the same values and
their computation needs the optimization of a quadratic criterion which can be done
either analytically or by using any simple gradient based algorithm. But the Gaussian
modeling is not always an appropriate one. Let take our example of deconvolution of

mass spectrometry data. We know a priori that the input signal must be positive. Then a
truncated Gaussian will be a better choice:

φ(x) =

x2
j ,

if xj ≥ 0; else φ(x) = ∞.

j
X

But, we know still more about the input signal: it has pulse shapes, meaning that, if we
look at the histogram of the samples of a typical signal, we see that great number of
samples are near to zero but great deviations from this background are not rare. Thus, a
generalized Gaussian

φ(x) =

|xj|p with 1 ≤ p ≤ 2;

if xj ≥ 0; else φ(x) = ∞.

j
X

or a Gamma prior law

would be better choices.

j
X

φ(x) =

ln xj + xj if xj ≥ 0; else φ(x) = ∞.

We can also go further in details and want to account for the fact that we are looking
for atomic pulses. Then we can imagine a binary valued random vector z with p(zj =
1) = α and p(zj = 0) = 1 − α, and describe the distribution of x hierarchically:

p(xj|zj) = zj p0(xj)

(37)

(38)

with p0(xj) being either a Gaussian p(xj) = N (m, σ2) or a Gamma law p(xj) = G(a, b).
The second choice is more appropriate while the ﬁrst results on simpler estimation
algorithms. The inference can then be done through the joint posterior

p(x, z|y) ∝ p(y|x) p(x|z) p(z)

The estimation of z is then called Detection and that of x Estimation. The case where
j p(zj) = αn1(1 − α)(n−n1) with n1 the number of ones and n the
we assume p(z) =
length of the vector z, is called Bernoulli process and this modelization for x is called
Bernoulli-Gaussian or Bernoulli-Gamma as a function of the choice for p0(xj).

Q

The difﬁcult step in this modeling is the detection step which needs the computation

of

p(z|y) ∝ p(z)

p(y|x) p(x|z) dx

(39)

ZZ

and then its optimization over {0, 1}n where n is the length of the vector z. The cost of
the computation of the exact solution is huge (a combinatorial problem).

Many approximations to this optimization have been proposed which result to differ-
ent algorithms for this detection-estimation problem [14]. Many Monte Carlo techniques
have also been proposed for generating samples of z and x from the posterior and thus
compute the PM estimates of x. Giving more details on this modeling and details of
corresponding algorithms is out of the scope of this paper.

The results on the following ﬁgure illustrate this discussion. Here, we used the data
in ﬁgure 1 and computed x by optimizing the MAP criterion (36), with different prior
laws p(x) ∝ exp [−λφ(x)] in between the following choices:
a) Gaussian: φ(x) =
b) Gaussian truncated on positive axis: φ(x) =
P
c) Generalized Gaussian truncated on positive axis: φ(x) =
d) Entropic prior φ(x) =
e) Gamma prior: φ(x) =

P
xj ln xj − xj, xj > 0,
ln xj + xj, xj > 0.

|xj|p with p = 1.1, xj > 0.

x2
j , xj > 0,

x2
j ,

P

P
P

10

0

0

100

200

300

400

500

600

700

800

900

1000

10

0

0

100

200

300

400

500

600

700

800

900

1000

10

0

0

100

200

300

400

500

600

700

800

900

1000

10

0

0

100

200

300

400

500

600

700

800

900

1000

10

0

0

100

200

300

400

500

600

700

800

900

1000

FIGURE 3. Deconvolution results with different priors:
axis c) Generalized Gaussian. d) −x ln x entropic prior e) ln x entropic or Gamma prior.

a) Gaussian b) Gaussian truncated to positive

As it can be seen from these results 1 , for this application, the Gaussian prior does not
give satisfactory result, but in almost all the other cases the results are more satisfactory,
because the corresponding priors are more in agreement with the nature of the unknown
input signal.

x ln x − x

xp

x2

−3

x 10

4.5

3.5

2.5

5

4

3

2

1

0.5

0

0

1.5

ln x + x

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

FIGURE 4. Plots of the different prior laws p(x) ∝ exp [−λφ(x)]: a) Truncated Gaussian φ(x) =
x2, λ = 3 b) Truncated generalized Gaussian φ(x) = xp, p = 1.1, λ = 4; c) Entropic φ(x) = x ln x −
x, λ = 10 d) Entropic φ(x) = ln x + x, λ = 0.1.

The Gaussian prior (a) is not at all appropriate, Gaussian truncated to positive axis (b)
is a better choice. The generalized Gaussian truncated to positive axis (c) and the −x ln x
entropic priors (d) give also almost the same results than the truncated Gaussian case.
The Gamma prior (e) seems to give slightly better result (less missing and less artifacts)
than all the others. This can be explained if we compare the shape of all these priors
shown in ﬁgure (4). The Gamma prior is sharper near to zero and has longer tail than
other priors. It thus favorites signals with greater number of samples near to zero and still
leaves the possibility to have very high amplitude pulses. However, we must be careful
on this interpretation, because all these results depend also on the hyperparameter λ
whose value may be critical for this conclusion. In these experiments we used the same
value for all cases. This brings us to the next open problem which is the determination
of the hyperparameters.

1 Remark that the results are presented on a logarithmic scale for the amplitudes to show in more detail
the low amplitude pulses. We used log(1 + a) scale in place of y scale which has the advantage of being
equal to zero for a=0.

Hyperparameter estimation

The Bayesian approach can be exactly applied when the direct (prior) probability laws
p(y|x, φ1) and p(x|φ2) are assigned. Even, when we have chosen appropriate laws, still
we have to determine their parameters φ = [φ1, φ2]. This problem has been addressed
by many authors and the subject is an active area in statistics. See [15, 16, 17, 6],
[18, 19, 20, 21, 22] and also [8, 23, 24].

The Bayesian approach gives natural tools to handle this problem by considering
φ = (φ1, φ2) as extra unknown parameters to infer on. We may then assign a prior law
p(φ) to them too. However, the way to do this is also still an open problem. We do not
discuss it more in this paper. The readers are invited to see [25] for some extended
discussions and references. When this step is done, we can again use the Bayesian
approach and compute the joint posterior p(x, φ|y) from which we can follow three
main directions:
– Joint MAP optimization: In this approach one tries to estimate both the hyperparame-
ters and the unknown variables x directly from the data by deﬁning:

(

x,

φ) = arg max

{p(x, φ|y)} where p(x, φ|y) ∝ p(y|x, φ) p(x|φ) p(φ)

(40)

(x,φ)

b

b

and where p(φ) is an appropriate prior law for φ. Many authors used the non informative
prior law for them.
– Marginalization: The main idea in this approach is to distinguish between the two sets
of unknowns: a high dimensional vector x representing in general a physical quantity
and a low dimensional vector φ representing the parameters of its prior probability laws.
This argument leads to estimate ﬁrst the hyperparameters by marginalizing over the
unknown variables x:

p(φ|y) ∝ p(φ)

p(y|x, φ) p(x|φ) dx

(41)

and then, using them in the estimation of the unknown variables x:

ZZ

φ = arg max

{p(φ|y)} −→

x = arg max

p(x|y,

φ)

.

(42)

φ

b

x

n

o

b

b
Note also that when p(φ) is choosed to be uniform, then p(φ|y) ∝ p(y|φ) which is the
likelihood of the hyperparameters φ and the corresponding maximum likelihood (ML)
estimate has all the good asymptotic properties which may not be the case for the joint
MAP estimation. However, for practical applications with ﬁnite data we may not care
too much about the asymptotic properties of these estimates.
– Nuisance parameters: In this approach the hyperparameters are considered as the
nuisance parameters, so integrated out of p(x, φ|y) to obtain p(x|y) and x is estimated
by

x = arg max

{p(x|y)} where p(x|y) =

p(y, x, φ) dφ

(43)

x

b

ZZ

– Joint Posterior Mean: Here, x and φ are estimated as the posterior means:

x = E {x|y} =

x p(x|y) dx and

φ = E {φ|y} =

φ p(φ|y) dφ.

(44)

ZZ

ZZ

b

b

The main issue here is that, excepted the ﬁrst approach, all the others need integrations
for which, in general, there is not analytical expressions and their numerical computation
cost may be very high. At the other hand, unfortunately, the estimation by the joint
maximization has not the good asymptotic properties (when number of data goes to
inﬁnity) of the estimators obtained through the marginalization or expectation. However,
in ﬁnite number of data, a comparison of their relative properties is still to be done. To
see some more discussions and different possible implementations of these approaches
see [24]. We have also to mention that, we can always use the Markov Chain Monte
Carlo (MCMC) techniques to generate samples from the joint posterior p(x, φ|y) and
then compute the joint posterior means and corresponding variances. It seems that these
techniques are growing up. However, I see two main limitations for their application on
real data: their huge computational cost and the need for some discussions on the tools
to control their convergences.

Myopic or blind inversion problems

Consider the deconvolution problems (1) or (2) and assume now that the psf h(t) or
h(x, y) are partially known. For example, we know they have Gaussian shape, but the
amplitude a and the width σ of the Gaussian are unknown. Noting by θ = (a, σ) the
problem then becomes the estimation of both x and θ from y = Hθx + ǫ. The case
where we know only the support of the psf but not its shape can also be casted in the
same way with θ = [h(0), . . . , h(p)]

Before going more in details, we must note that, in general, the blind inversion prob-
lems are much harder than the simple inversion. Taking the deconvolution problem, we
have seen in introduction that, the problem even when the psf is given is ill-posed. The
blind deconvolution then is still more ill-posed, because here there are more fundamental
under-determinations. For example, it is easy to see that, we can ﬁnd an inﬁnite num-
ber of pairs (h, x) which result to the same convolution product h ∗ x. This means that,
to ﬁnd satisfactory methods and algorithms for these problems need much more prior
knowledge both on x and on h, and in general, the inputs must have more structures (be
rich in information content) to be able to obtain satisfactory results.

Conceptually however, the problem is identical to the estimation of hyperparameters
in previous section and any of the four approaches presented there can be used. One
may wish however to distinguish between these parameters of the system θ = (a, σ) and
those hyperparameters of the prior law model descriptions φ = (σ2
ǫ , σ2
x, . . . ). In that case,
one can try to write down p(x, θ, φ|y) and use one of the following:
– Joint MAP estimation of x, θ and φ: (

{p(x, θ, φ|y)}.

x,

θ,

– Marginalize over x and estimate θ and φ using: (

b

φ) = arg max

{p(θ, φ|y)} and

φ) = arg max
(x,θ,φ)
θ,

b

b

(θ,φ)

b

b

then, estimate x using:

x = arg maxx
– Marginalize over x and θ and estimate φ using:

p(x|y,

φ)

θ,

o

n

.

b

b

b

φ = arg max

{p(φ|y)} ,,

φ

then estimate θ using:

p(θ|y,

φ)

and ﬁnally, estimate x using:

b

o

θ,

p(x|y,

n
x = E {x|y},

x = arg maxx
– Joint Posterior Mean: Here, x, θ and φ are estimated through their respective posterior
means:
b

φ = E {φ|y}.
Here again, the joint optimization stays the simpler but we must be careful on in-
terpretation of the results. For others, one can either use the Expectation-Maximization
(EM) algorithms and/or MCMC sampling tools to approximately compute the necessary
integration or expectation computations and overcome the computational cost issues.

o
θ = E {θ|y} and

b

b

b

b

b

b

θ = arg maxθ
φ)
b

.

n

CONCLUSIONS

In this paper I presented a synthetic overview of methods for inversion problems starting
by deterministic data matching and regularization methods followed by a general pre-
sentation of the probabilistic methods such as error probability law matching and like-
lihood based and the information theory and maximum entropy based methods. Then,
I focused on the Bayesian inference. I show that, as it concerns the maximum a pos-
teriori estimation method, one can see easily the link with regularization methods. We
discussed however the superiority of the Bayesian framework which gives naturally the
necessary tools for inferring the uncertainty of the computed solution, for the estimation
of the hyperparameters or for handling myopic and blind inversion problems. We saw
also that probabilistic modeling of signal and images is more ﬂexible for introduction of
practical prior knowledge about them. Finally, we illustrated some of these discussions
through a deconvolution example in mass spectrometry data processing.

REFERENCES

1. M. Bertero, T. A. Poggio, and V. Torre, “Ill-posed problems in early vision,” Proceedings of the

IEEE, 76, pp. 869–889, août 1988.

2. G. Demoment, “Image reconstruction and restoration: Overview of common estimation structure
and problems,” IEEE Transactions on Acoustics, Speech and Signal Processing, ASSP-37, pp. 2024–
2036, décembre 1989.
J. Skilling, “Theory of maximum entropy image reconstruction,” in Maximum Entropy and Bayesian
Methods in Applied Statistics, Proc. of the Fourth Max. Ent. Workshop, J. H. Justice, ed., (Calgary),
Cambridge Univ. Presse, 1984.

3.

4. R. J. Hanson, “A numerical method for solving fredholm integral equations of the ﬁrst kind using

5.

singular values,” SIAM Journal of Numerical Analysis, 8, pp. 616–622, 1971.
J. Idier, A. Mohammad-Djafari, and G. Demoment, “Regularization methods and inverse problems:
an information theory standpoint,” in 2nd International Conference on Inverse Problems in Engi-
neering, (Le Croisic), pp. 321–328, juin 1996.

6. D. M. Titterington, “Common structure of smoothing techniques in statistics,” International Statisti-

cal Review, 53, (2), pp. 141–170, 1985.

7. G. H. Golub, M. Heath, and G. Wahba, “Generalized cross-validation as a method for choosing a

good ridge parameter,” Technometrics, 21, pp. 215–223, mai 1979.

8. N. Fortier, G. Demoment, and Y. Goussard, “GCV and ML methods of determining parameters
in image restoration by regularization: Fast computation in the spatial domain and experimental
comparison,” Journal of Visual Communication and Image Representation, 4, pp. 157–170, juin
1993.

9. G. Le Besnerais, J.-F. Bercher, and G. Demoment, “A new look at entropy for solving linear inverse

problems,” IEEE Transactions on Information Theory, 45, pp. 1565–1578, juillet 1999.

10. A. Mohammad-Djafari and J. Idier, “Scale invariant Bayesian estimators for linear inverse problems,”

in Proc. of the First ISBA meeting, (San Francisco, CA), août 1993.

11. S. Brette, J. Idier, and A. Mohammad-Djafari, Scale invariant Markov models for Bayesian inver-
sion of linear inverse problems, pp. 199–212. Maximum Entropy and Bayesian Methods, Kluwer
Academic Publ., Cambridge, UK, J. Skilling & S. Sibusi ed., 1994.

12. S. Brette, J. Idier, and A. Mohammad-Djafari, “Scale invariant Markov models for linear inverse
problems,” in Proc. of the Section on Bayesian Statistical Sciences, (Alicante,), pp. 266–270, Amer-
ican Statistical Association, 1994.

13. S. Brette, J. Idier, and A. Mohammad-Djafari, “Scale invariant Bayesian estimator for inversion of

noisy linear system,” Fifth Valencia Int. Meeting on Bayesian Statistics, juin 1994.

14. F. Champagnat, Y. Goussard, and J. Idier, “Unsupervised deconvolution of sparse spike trains using
stochastic approximation,” IEEE Transactions on Signal Processing, 44, pp. 2988–2998, décembre
1996.

15. P. Hall and D. M. Titterington, “Common structure of techniques for choosing smoothing parameter
in regression problems,” Journal of the Royal Statistical Society B, 49, (2), pp. 184–198, 1987.
16. T. J. Hebert and R. Leahy, “Statistic-based MAP image reconstruction from poisson data using Gibbs

prior,” IEEE Transactions on Signal Processing, 40, pp. 2290–2303, septembre 1992.

17. V. Johnson, W. Wong, X. Hu, and C.-T. Chen, “Image restoration using Gibbs priors: Boundary
modeling, treatement of blurring, and selection of hyperparameter,” IEEE Transactions on Pattern
Analysis and Machine Intelligence, PAMI-13, (5), pp. 413–425, 1984.

18. L. Younès, “Estimation and annealing for Gibbsian ﬁelds,” Annales de l’institut Henri Poincaré, 24,

19. L. Younes, “Parametric inference for imperfectly observed Gibbsian ﬁelds,” Prob. Th. Rel. Fields,

pp. 269–294, février 1988.

82, pp. 625–645, 1989.

20. C. A. Bouman and K. D. Sauer, “Maximum likelihood scale estimation for a class of Markov random
ﬁelds penalty for image regularization,” in Proceedings of the International Conference on Acoustic,
Speech and Signal Processing, vol. V, pp. 537–540, 1994.

21. J. A. Fessler and A. O. Hero, “Complete data spaces and generalized EM algorithms,” in Proceedings
of the International Conference on Acoustic, Speech and Signal Processing, (Minneapolis, Min-
nesota), pp. IV 1–4, 1993.

22. K.-Y. Liang and D. Tsou, “Empirical Bayes and conditional inference with many nuisance parame-

ters,” Biometrika, 79, (2), pp. 261–270, 1992.

23. A. Mohammad-Djafari, “On the estimation of hyperparameters in Bayesian approach of solving
inverse problems,” in Proceedings of the International Conference on Acoustic, Speech and Signal
Processing, (Minneapolis, MN), pp. 567–571, IEEE, avril 1993.

24. A. Mohammad-Djafari, A full Bayesian approach for inverse problems, pp. 135–143. Kluwer

Academic Publishers, Santa Fe, NM, K. Hanson and R.N. Silver ed., 1996.

25. R. E. Kass and L. Wasserman, “Formal rules for selecting prior distributions: A review and anno-
tated bibliography,” technical report no. 583, Department of Statistics, Carnegie Mellon University,
Submitted to J. of American Statistical Association, 1994.

