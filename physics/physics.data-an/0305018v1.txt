3
0
0
2
 
y
a
M
 
6
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
8
1
0
5
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Bayesian inference of nanoparticle-broadened x-ray line

proﬁles

N. Armstrong∗†, W. Kalceﬀ‡, J. P. Cline & J. Bonevich

National Institute of Standards and Technology,

Gaithersburg, Md 20899, USA

University of Technology Sydney,
‡

PO Box 123, Broadway NSW 2007, AUSTRALIA

Abstract

A single and self-contained method for determining the crystallite-size distribution

and shape from experimental x-ray line proﬁle data is presented. We have shown that the

crystallite-size distribution can be determined without assuming a functional form for the

size distribution, determining instead the size distribution with the least assumptions by

applying the Bayesian/MaxEnt method. The Bayesian/MaxEnt method is tested using

both simulated and experimental CeO2 data. The results demonstrate that the proposed

method can determine size distributions, while making the least number of assumptions.

The comparison of the Bayesian/MaxEnt results from experimental CeO2 with TEM

results is favorable.1

1 Introduction

The analysis of x-ray line proﬁle broadening can be considered as solving a series of

inverse problems. There are usually two steps:— removing the instrumental contribution

(deconvolution), and determining the broadening contribution in terms of crystallite size

∗E-mail: Nicholas.Armstrong@uts.edu.au
†Present address: Department of Applied Physics, University of Technology Sydney, PO Box 123, Broadway

NSW 2007, AUSTRALIA.

1Invited talk and paper at Accuracy in Powder Diﬀraction III, 22-25 April 2001, NIST, Gaithersburg, USA.

1

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

2

and microstrain. Here we are concerned with quantifying only the size broadening, in

terms of the shape and size distributions of the crystallites. We present a method that

removes the instrumental broadening and determines the particle size distribution in a

single step. The general theoretical framework developed makes it possible to determine

the crystallite shape and average dimensions, and to fully quantify these results by also

assigning uncertainties to them.

There are two approaches that can be adopted. The ﬁrst assumes functional forms

for the size distribution and shape of the crystallite, and applies a least squares ﬁtting to

determine the parameters deﬁning the size distribution (Krill & Birringer 1998, Langford

et al. 2000). For pragmatic reasons, this approach is often used to ensure numerical

stability; however, it is based on an explicit assumption for the crystallite size distribution

and does not take into account the uniqueness of the solution.

The second approach takes into account the non-uniqueness of the problem of deter-

mining the size distribution P (D) from the experimental data, by assigning a probability

to the solutions and enabling an average solution to be determined from the set of solu-

tions; moreover, it also allows any a priori information and assumptions to be included

and tested. This approach is embodied in the Bayesian and maximum entropy methods

(Gull 1989, Skilling 1989a, Bryan 1990, Sivia 1996). Essentially, Bayesian theory tells us

how to express and manipulate probabilities. It might be said, therefore, that Bayesian

theory helps us to ask the appropriate questions, while the maximum entropy method

tells how to assign values to quantities of interest.

2 X-ray line proﬁles

2.1 Observed proﬁle

The observed line proﬁle, g(2θ), can be expressed as

g(2θ) =

k(2θ

2θ′) f (2θ′) d(2θ′) + b(2θ) + n(2θ)

(1)

−

Z

where k(2θ) deﬁnes the instrument proﬁle and considers the imperfect optics of the diﬀrac-

tometer; f (2θ) is the specimen proﬁle, which (apart from strain eﬀects which are not

covered here) characterizes the size broadening due to microstructural properties of the

specimen (i.e. crystallite shape, distribution and dimensions); b(2θ) and n(2θ) are the

background level and the noise distribution, respectively. The observed proﬁle, (1), can

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

3

also be expressed in terms of reciprocal-space units, s, centered about s0 = 2 sin θ0

, as

λ

g(s) = g(2θ)

d(2θ)
ds

(2)

where d(2θ) = λ

cos θ ds.

The problem we face is determining the size distribution and shape of the crystallites

from (1), given our knowledge of the instrument kernel, k(2θ), and our understanding

of the counting statistics, σ2. We also want to quantify the specimen proﬁle and size

distribution by assigning error bars to them. Before addressing these questions, we review

line proﬁle broadening from nanocrystallites.

2.2 Crystallite-size broadening

The line proﬁle, Ip(s, D), from a specimen consisting of crystallites of the same size and

shape can be expressed in terms of the common-volume function (Stokes & Wilson 1942)

Ip(s, D) = 2

V (t, D) cos 2πst dt

(3)

τ

0

Z

where Ip(s, D) is the intensity proﬁle given by the dimensions of the crystallite, D =

. The common-volume function of the crystallite, V (t, D), quantiﬁes the
Di; i = 1, 2, 3
{
}
volume between the crystallite and its ‘ghost’, shifted a distance t parallel to the diﬀraction

vector. The dimension τ represents the maximum length of the crystallite in the direction

of the diﬀraction vector, and can be expressed in terms of the dimensions of the crystallite,

D, such that τ

τ (D). The boundary conditions for the common-volume function are

≡

V (0, D) = V0, where V0 is the volume of the crystallite, and V (

τ, D) = 0. Fig. 1 shows a

±

schematic of a crystallite and its ghost shifted a distance t in the direction [hkl]; the shaded

region represents the common volume between the crystallite and its ghost. V (t, D) is

symmetrical about the origin over the range t

τ, τ ]. This implies that V (t, D) is

[
−

∈

an even function over this range. A simple example is a set of spherical crystallites with

diameter D, for which the common-volume is given by (Stokes & Wilson 1942)

V (t, D) =

(t + 2 D)(t

D)2

−

π
12

and using (3) the corresponding line-proﬁle is (Stokes & Wilson 1942, Langford et al. 2000)

Ip(s, D) =

1
16π3s4 +

D2
8πs2 −

cos(2πsD)

16π3s4 −

D sin(2πsD)
8π2s3

(4a)

(4b)

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

4

Figure 1: The crystallite (solid line) and its ‘ghost’ (dashed line) shifted a distance t in the direction of the

scattering vector [hkl]. The crystallite and ghost have dimensions, D =

D1, D2, D3

. The shaded region

{

}

represents the common volume between the crystallite and ghost. The maximum thickness of the crystallite

in the direction [hkl] is τ . The common-volume function has the boundary conditions, V (0, D) = V0 and

V (

τ, D) = 0. As t

τ , V (t, D)

0. The graph of this function over t represents the Fourier coeﬃcients

±

→

→

from which the area- and volume-weighted sizes can be determined.

where τ (D) = D for spherical crystallites and in the limit of s

0 (4b) reduces to

→

Ip(0, D) = πD4/8.

Essentially, (3) is the Fourier transform of the V (t, D), and noting V (t, D) is an even

function, the odd (sine) terms in the Fourier transform vanish. This also implies that

the size-broadened proﬁles will always be symmetrical about the Bragg angle, 2θ0. From

(3) and Fig. 1, it is clear that information concerning the dimensions and shape of the

crystallite is given in V (t, D).

2.3 Particle-size distribution, P (D)

A powder specimen would not normally consist of crystallites all having the same size,

but it can be assumed that the crystallites can have the same shape, based on kinetics

arguments. The eﬀect of the particle-size distribution on the common volume is to ‘blur’

the broadening eﬀects of a single crystallite.

The size-broadened line proﬁle from a distribution of crystallites, P (D)

D, with

D

dimensions in the range D to D +

D can be expressed as

f (s) = 2

˜V (t) cos 2πst dt,

s

∀

∈

, +

[
−∞

]

∞

(5)

D

∞

0

Z

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

5

(6)

(7a)

(7b)

where ˜V (t) is the modiﬁed common-volume function due to the inﬂuence of the particle-

size distribution,

˜V (t) =

V (t, D) P (D)

D.

D

∞

t

Z

D

In (6) a generalized measure,

D, has been used which is dependent on the crystallite

shape and coordinate system. The area-weighted size,

iv, and
column-length distribution (or area-weighted size distribution), pa(t), can be determined

t
ia, volume-weighted size,
h

t
h

from (6) (Wilson 1968, Wilson 1971). It can be seen from (6) how the shape and distribu-

tion of the crystallites inﬂuence the area- and volume-weighted quantities. Substituting

(6) into (5), we have

f (s) = 2

V (t, D) P (D)

D

cos 2πst dt

∞

∞

=

t

0 (cid:20)Z
Z
∞
2

τ

0
Z

(cid:20)

0

Z

D

(cid:21)
V (t, D) cos 2πst dt

P (D)

D

D

(cid:21)

where in going from (7a) to (7b) the order of integration has been changed and t is

integrated out. In addition we note that V (t, D)

0 for t

[0, τ ] and V (t, D) = 0 for

≥

∈

t > τ . Inside the brackets of (7b), we have Ip(s, D) from (3). Hence, (7b) can be written

as

f (s) =

Ip(s, D) P (D)

D,

D

s

∀

∈

, +

[
−∞

]

∞

(8)

∞

0

Z

where we deﬁne the proﬁle kernel, Ip(s, D), as the size-broadened line proﬁle given by a

single crystallite with dimensions D. In (8), we notice that the eﬀect of P (D) is to weight

the superposition of size proﬁles over the range of D to D +

D.

D

2.4 Determining P (D) from g(s)

In analysing the size distribution, we want to ensure that the statistics of the observed

proﬁle can be carried directly into quantifying the size distribution. Equation (8) expresses

the specimen proﬁle, f (s), in terms of the particle-size distribution and the shape of

the nanocrystallites, while (1), after transformation into s-space, expresses the observed

proﬁle in terms of f (s). Combining these two equations, the experimental data, g(s), can

be expressed in terms of the particle-size distribution, P (D) as

g(s) =

k(s

s′) Ip(s′, D) P (D) ds′

D + b(s) + n(s)

D

+∞

+∞

+∞

−

−∞

Z
K(s, D) P (D)

=

0

Z

0

Z

D + b(s) + n(s)

D

(9a)

(9b)

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

6

where the scattering kernel, K(s, D), ‘rolls up’ the instrumental eﬀects and the proﬁle

kernel, given by

K(s, D) =

s′) Ip(s′, D) ds′.

(10)

+∞

−∞

Z

k(s

−

In (10), the dummy variable s′ is being integrated out. The results given by (9b) and (10)

enable the particle-size distribution to be extracted directly from the experimental data.

This ensures that the statistics of the experimental data are transferred to quantifying

the uncertainty in the solution. This approach also addresses a diﬃculty of the two-fold

approach discussed by Armstrong & Kalceﬀ (1999).

3 Bayesian & maximum entropy methods

3.1 The uniqueness of P (D)

In (9) we have a single expression for the observed proﬁle in terms of the crystallite size

distribution and shape, background level, and statistics of the experiment; information

concerning the crystallite properties has been incorporated.

In seeking to determine P (D) from g(s), the issue of uniqueness for P (D) becomes

important, for two reasons: ﬁrstly, because of the ‘conditioning’ of the kernels, particularly

K(s, D); and secondly, due to the presence of statistical noise, σ.

Generally, K(s, D) will be ill-conditioned. This can be demonstrated in a numerical

calculation by expressing K(s, D) as a matrix, K; we can show det KT K

0. This

∼

implies that the column vectors of K are (nearly all) linearly dependent, which has dire

consequences, as any attempt to determine P (D) (given g(s), K(s, D), σ and b(s)), pro-

duces a set of solutions

rather than a unique solution. The presence of statistical

P (D)
}
{

noise in the data simply worsens the situation, in that the ill-conditioning of K(s, D)

ampliﬁes the noise and the solution is swamped by spurious and unphysical oscillations

(Armstrong & Kalceﬀ 1998). Faced with this situation, the following question arises:

How do we develop a method to extract a unique P (D) from g(s), given our knowledge

of K(s, D), b(s) and σ2?

3.2 Some observations

Before proceeding with developing a ‘method’ to determine the crystallite size and shape

from the observed data, g(s), some observations concerning these distributions need to be

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

7

made.

The integral equations given by (1) and (9) refer to a set of continuous functions.

However, the recording of the observed and instrument proﬁles is made in discrete time

intervals. To convey this, we express the observed proﬁle, specimen proﬁle and size distri-

bution as vectors, such that g =

gi; i = 1, 2, 3, . . . , M
{
Pj ; j = 1, 2, 3, . . . , N
{

fj′; j′ = 1, 2, 3, . . . , N ′
}
{
. The scattering kernel K(s, D) can be expressed
}

, f =
}

and P =

as matrix, K =

i & j

by taking the product of the instrument kernel and

Kij;
{

∀

}

the line proﬁle kernel. The instrument kernel can be evaluated in 2θ-space, such that

R =

k(2θi −
{

cos θ ds
can be mapped into s-space. Similarly, the proﬁle kernel can be evaluated over s and D,

j′); i = 1, 2, 3, . . . , M & j′ = 1, 2, 3, . . . , N ′

, and using d(2θ) = λ
}

2θ′

such that Ip =

Ip j′j; j′ = 1, 2, 3, . . . , N ′ & j = 1, 2, 3, . . . , N
{

gives K = R Ip and is an [M

N ] matrix, such that N < N ′

. The matrix product
}
M .

×

≤

There are two fundamental properties which g(2θ), f (2θ), P (D) and V (t, D) all share.

The ﬁrst is that these distributions are positive deﬁnite; that is, the observed proﬁle g(2θ)

and specimen function f (2θ) represent intensities which are positive values. The second

property is that these distributions are additive; that is, the sum of the distributions

over a region represents a physically meaningful quantity (Sivia 1996). For example, the

integrated intensity of g(s) can be related back to the structure factor of the lattice, while

the integrals

f (s) ds and

V (t, D) dt are inversely proportional to the integral breadth

and quantify the specimen broadening in terms of size and strain contributions. The

R

R

integral for P (D) is a special case, in that it must be unity. This ensures that we can

attribute a probability for a particular D and detemine its moments.

These two observations are important in formulating a ‘method’ that can determine

both the specimen proﬁle from the observed x-ray diﬀraction proﬁle and an underlying

distribution such as the size distribution, P (D), while dealing with the issue of uniqueness.

That is, we expect our method to extract this information from the observed data and

produce results which preserve the positivity and additivity of the proﬁle or distribution.

It should also be possible to incorporate the properties of positivity and additivity without

making additional assumptions about, say, the functional/analytical form of the specimen

proﬁle or size distribution. These conditions ensure that the specimen proﬁle or size

distribution determined from the observed proﬁle can be interpreted in general terms.

In order to assign values to these distributions and preserve their additivity and pos-

itivity, a suitable function must be selected. Based on these observations and various

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

8

arguments, the entropy function and maximum entropy principle are found to be the only

consistent approach to inferring discrete probabilities (see Shore & Johnson 1980, Johnson

& Shore 1983, Tikochinsky et al. 1984, Gull & Skilling 1984, Skilling 1989b, Skilling 1990,

Goambo & Gassiat 1997).

3.3 Bayes’ theorem for P (D)

In analyzing size-broadened proﬁles, the central aim is to quantify the shape and size

distribution of the crystallites, given the experimental data. Bayesian theory is well

suited for testing a hypothesis in the presence of experimental data. This is achieved by

quantifying the a posteriori probability distribution for P, conditional on the experimental

data and statistical noise. The formulation of Bayes’ theorem is general and can also be

applied to determining f .

Using Bayes’ theorem, the a posteriori probability for P is given by

Pr(P
|

g, m, K, σ, α,

) =

I

Pr(P
|

m, α,
Pr(g

) Pr(g
I
m, K, σ,
|

|

P, K, σ,
)

)

I

I
’, viz. the observed proﬁle g, an a priori model m,
This is conditional on everything after ‘
|

the scattering kernel K, statistical noise σ, a constant α, and any additional background

(11)

information concerning the experiment,

.

I

On the right-hand side of (11) there are several terms that require further discussion.

The likelihood probability distribution Pr(g

P, K, σ,

) deﬁnes the probability of

|

I

measuring g, given a size distribution P, proﬁle kernel K, and statistical noise σ. That is,

we include our hypothesis P, and determine how probable it is to measure g, given this

hypothesis, K and σ. The likelihood function is approximated as a Gaussian distribution

for large counts (>> 10) by applying the central limit theorem,

Pr(g

P, K, σ,

) =

exp[

L(P, g, K, σ)]

(12a)

|

1
ZL(σ)

1
2

−

I

M

Xi=1

L =

2

gi −

(cid:16)

N
j=1 Kij Pj
σ2
i

(cid:17)

P

M

ZL(σ) =

2π σ2
i

Yi=1 q
√2π σ2
= det
{

,
}

(12b)

(12c)

(12d)

where

and

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

9

such that

√2π σ2
{

}

×

is an [M

M ] diagonal matrix.

The variance is deﬁned in terms of the observed counts and estimated background-level

as σ2

i = gi + best

i

. In (12a), the kernel, K has been included as it contains information

about the shape of the crystallites and will inﬂuence the solution. We notice from (12b)

that the matrix form of (9) has been incorporated.

The term Pr(P
|

I

m, α,

) deﬁnes how probable is our hypothesis P, given it is a pos-

itive and additive distribution and conditional on an a priori model, m. The a priori

probability distribution can be expressed as

Pr(P
|

m, α, I) =

1
ZS(α)

exp [α S(P, m)] .

(13a)

The entropy function is given as (Skilling 1989a),

where the normalization term, ZS(α) is given as

S(P, m) =

Pj −

mj −

Pj ln (Pj/mj) .

N

Xj=1

ZS(α) =

P exp [α S(P, m)]

(13b)

(13c)

(13d)

(13e)

N
2

Z

D

2π
α

(cid:19)
(cid:18)
N
(2π)
2
√det αI

=

=

and the integration in (13c) involves the measure

P =

D

− 1
N
2
j=1 P
j

dPj.

The log term in (13b) ensures that positive and additive distributions are obtained

Q

and that P will have these fundamental characteristics. The a priori model, m, deﬁnes

our ignorance/knowledge about P. That is, if we are unsure of the shape of P, it is

best to admit our ignorance by assigning a uniform distribution over a speciﬁed range.

The a priori model may also include data gathered from other sources, such as electron

microscopy (e.g. TEM, SEM and SPTM) techniques.

It may also include theoretical

or analytical models. For example, recently in the literature (see Krill & Birringer 1998,

Langford et al. 2000, Ung´ar et al. 2001) there has been a widespread use of the log-normal

distribution for P. However, in the Bayesian formulation we do not explicitly deﬁne P

as a log-normal distribution, but set the a priori model as a log-normal distribution and

test it in the presence of the observed data.

S(P, m) is essentially a measure for P relative to m. Suppose the model m was

found to be a log-normal distribution and its parameters determined using least squares

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

10

analysis.

If the resulting P lies ‘close’ to m, the change in S will be small and there

will be little diﬀerence between P and m; also, this would imply that the underlying

crystallite-size distribution in the specimen is a log-normal distribution with values similar

to those determined for m, since this assumption has been tested in the presences of the

experimental data. On the other hand, if P lies ‘some distance’ from m, the change in S

will be large; this would result in a considerable diﬀerence between m and P and would

imply that the underlying size distribution is not a log-normal distribution with the values

estimated for m.

The denominator term in (11) has an important application in selecting between var-

ious kernels, K, for diﬀerent crystallite shapes.

It is called the evidence (Gull 1989),

(14)

(15)

Pr(g

m, K, σ,

) =

|

I

P

D

Z

Z

dα Pr(P, g, α
|

m, K, σ,

).

I

Including all the necessary terms, the a posteriori probability distribution for P can

be expressed as

Pr(P
|

g, m, K, σ, α,

) =

I

1
ZS(α) ZL(σ)

eQ

Pr(g

m, K, σ,

|

)

I

where Q = α S

1
2 L. For convenience, Q

−

≡

Q(P, α), since P and α are the only

two unknown terms. The α term in Q(P, α) can be interpreted as an undetermined

Lagrangian multiplier.

Determining the most probable size distribution, ˆP, depends on maximizing (15),

which in turn requires determining the global minimum for Q(P). There are several
algorithms for determining ˆP from Q(P), given its nonlinear characteristics (see Skilling

& Bryan 1984, Bryan 1990).

The approach we follow in determining the crystallite-size distribution is similar to

that outlined by Bryan (1990) and Jarrell & Gubernatis (1996). We start with a large α

value and step towards α

0. For a given α, we determine P such that

Q = 0. After

≈
stepping through a range of α values, a set of solutions,

∇

P(α)
, is formed parameterized
}
{

by α. The average distribution,

P
, can be determined from the set of solutions
i
h

P(α)
,
}
{

=

P
i
h

αmax

αmin

Z

I

dα P(α) Pr(α
|

g, m, K, σ,

).

I

(16)

where Pr(α
|

g, m, K, σ,

) is normalized to unity for α

[αmin, αmax]. In the application

∈

of the Bayesian/MaxEnt method, the selected range was deﬁned by α

[10−2, 105]. The

∈

average particle size distribution can be used to determine the average specimen proﬁle,

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

11

f
h

,
i

f
h

i

=

dα IpP(α) Pr(α
|

g, m, K, σ,

)

I

αmax

αmin
Z
P
= Ip h
.
i

3.4 Determining Pr(α

g, m, K, σ,
|

)

I

The α parameter in (15) is important in coupling the entropy function S(P, m) with

the likelihood function L(P). It is also a ‘nuisance parameter’ and its inﬂuence can be

integrated out. In evaluating (16), it is necessary to determine Pr(α
|

g, m, K, σ,

); we

I

do this by integrating out the inﬂuence of P,

Pr(α
|

g, m, K, σ,

) =

I

g, m, K, σ,

)

P Pr(P, α
|
) Pr(P
|
Pr(g

Pr(α

| I

P

D

D

I
) Pr(g
|
)

I

m, α,

|

I
m, K, σ,
1
ZS(α) ZL(σ)

)

Pr(α
| I
m, K, σ,
|
P eQ(P, α),

)

I

Z

Z

Pr(g

D

Z

=

=

×

P, K, σ,

)

I

and expanding Q(P, α)

Q( ˆP, α) + 1

2 (P

ˆP)T

≈

−

∇∇

−

Q(P

ˆP) about ˆP for a given α. We

note

Q = 0 for P = ˆP for a given α. On integrating, we have

∇

Pr(α
|

g, m, K, σ,

)

I

1
ZS(α) ZL(σ)

)

|

)

Pr(α
| I
Pr(g
m, K, σ,
I
(2π)N q/2 eQ( ˆP, α)
Q(α)
)

∇∇
Pr(α
| I
m, K, σ,

p
Pr(g

det

≈

×

=

|
det αI
det(αI + ˆΛ)

I
eQ( ˆP, α)

× s

1
ZL(σ)

)

(17a)

(17b)

(17c)

where

∇∇
KT

1
2

≡ ∇∇
ˆP
{

1
2

Q( ˆP, α)

Q(α) and ˆΛ are the eigenvalues of (

S)− 1

2

L (

S)− 1

2 =

−∇∇

∇∇

−∇∇

ˆP
{
(17a), we have introduced the a priori distribution for α, Pr(α

. The quantities in parentheses represent diagonal matrices.
}

). Generally, we set

σ−2
{

K
}

In

}

| I

Pr(α

| I

) as a uniform model over a range [αmin, αmax]. Using (17) we can evaluate (16).
) and ˆΛ for each ˆP and α in the range of

g, m, K, σ,

In practice, we determine ln Pr(α
|

I

[αmin, αmax].

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

12

3.5 Resolving overlapped proﬁles

The formalism presented here enables single and overlapped proﬁles, and even whole

patterns to be analyzed, provided that crystallite-size eﬀects are the major broadening

component. Line proﬁles are generally overlapped due to low unit cell symmetry. However,

specimen broadening, such as size broadening from crystallites, can also cause proﬁles

to be overlapped.

In this case, the underlying invariant quantity is the crystallite-size

distribution, P. The above integral equations for overlapped peaks can be expressed in

terms of P. The general form of (9) does not change; the term that does change is the

kernel, K(s, D),

K(s, D) =

+∞

−∞

Z

q
X

k(s

−

s′; s′

0q) Ip(s′, D) ds′

(18)

where s′

0q = 2 sin θ0q/λ and θ0q is the Bragg angle at the qth peak in the pattern. The
0q) term expresses the instrument kernel at each peak position, θ0q. The Ip(s′, D)
term is invariant over the range of s. In terms of the Bayesian analysis presented above,

s′; s′

k(s

−

nothing else changes.

3.6 Error analysis

Determining the errors in P over regions of importance is a ﬁnal test for the quality of P.

The error bars for P are dependent on the choice of the a priori model and the quality

of the observed data, σ.

It is only possible to assign error bars over a deﬁned region, because the errors between

points are strongly correlated (Skilling 1989a, Sivia 1996). The region of interest may

consist of features in the specimen proﬁle or size distribution which may not be physical,

such as ripples in the tails of the distribution or a second peak suggesting a bimodal

distribution. Over the deﬁned region, we are interested in the average integrated ﬂux

(Skilling 1989a),

where w is a ‘window function’ deﬁned as,

N

N

ρ =

Pjwj/

wjwj

Xj=1

Xj=1

= PT w/wT w

r′,

1

r

j

≤
0, otherwise

≤

wj =






(19)

(20)

(21)

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

13

and the region of interest is deﬁned by rr′. Expanding Pr(P
) about
|
2 (P− ˆP)T ∇∇Q(P− ˆP). This is a Gaussian centered
ˆP, we have Pr(P
|
about ˆP. By inspection, the covariance matrix for P is given by

Q)−1, where the

g, m, K, σ, α,

g, m, K, σ, α,

∝

I

I

e

)

1

(
∇∇

−

Q)−1 are strongly correlated with neighboring elements. Following the

elements in

(
∇∇

−

suggestion of Skilling (1989a) the variance for P is

Hence, we can assign error bars over a region of interest to the integrated ﬂux of P.

P = wT
σ2

Q)−1

w/wT w.

(
∇∇

−

(cid:2)

(cid:3)

(22)

3.7 Fuzzy pixel approach for determining f

It is often important to assess the specimen broadening by determining f , without making

any assumptions concerning its functional form. This can be performed by deconvolving

(1). However, in determining f ‘ringing eﬀects’ can appear in the solution. The ringing

is often due to noise eﬀects which are ampliﬁed and appear as unphysical oscillations in

the solution (for example see Fig. 6 in Armstrong & Kalceﬀ 1999). The above theory

assumes that smoothing is applied globally. However, the ringing eﬀects are local artifacts.

In order to introduce ‘local’ smoothing, we must address how to decompose f . Explicit

in the composition of f is that it is expressed as a superposition of delta functions,

f (2θ) =

δ(2θ

2θl) al

−

N

Xl=1

(23)

where a =

a1, a2, . . . , aN }
{

is the set of coeﬃcients that deﬁne the amplitude of f at the

lth position. However, (23) assumes a global smoothness, while the ringing eﬀects are

local eﬀects.

Following the suggestion of Sivia (1999, 1996), we blur δ(2θ) by including the spatial

correlation length or width. To do this, we choose a basis function which includes a spatial

correlation length as its width and reduces to δ(2θ) in the limit of the width going to zero.

That is, we make the pixel at the lth position of f fuzzy. A simple choice is to express f

in terms of a sum of Gaussian function,

f (2θ) =

exp

N

Xl=1

(2θ

2θl)2

−
2 ω2

al

(cid:21)

−

(cid:20)

(24)

→

where ω is the width of the spatial correlation or fuzzy pixel. In the limit of ω

0, (24)

reduces to (23).

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

14

In matrix notation (24) becomes,

f = F a

(25)

where F is an [N

N ] matrix containing the elements of the Gaussian function.

×

How do we determine the optimum ω given the observed data, kernel and statistical

noise?

The tools for addressing this question have been presented. That is, we employ Bayes’

theorem to determine the a posteriori probability distribution for ω conditional on the

observed line proﬁle. The ω which maximises the resulting a posteriori probability dis-

tribution becomes the optimum fuzzy pixel width, ˆω. At a practical level, we replace the

equations where P appears with a, and the kernel K is replaced by

G = R F

(26)

where G

G(ω).

≡

a and α,

Applying Bayesian theory, the distribution for ω can be determined by integrating out

Pr(ω

g, m, σ,

) =

|

I

D

Z

Z

dα Pr(a, α, ω

g, m, σ,

(27a)

)

I

D
Z
Pr(a

dα Pr(α

| I
Z
g, m, σ, α, ω,

) Pr(ω

)

| I

=

×

|

).

I

a

a

|

Following the same steps as in (17), we have

Pr(ω

g, m, σ,

|

)

I

1
ZS(α) ZL(σ)

≈

×

Pr(α

)

) Pr(ω
| I
| I
m, σ,
Pr(g
)
|
I
N
2 eQ(α, ω)
(2π)
det

Q(α, ω)

.

∇∇

where Q(a, α, ω) = α S(a)

L(a, ω) for the unknown terms a, α and ω; and

Q(α, ω)

p

∇∇

≡

aQ(α, ω).

a

∇

∇
Error bars can also be attributed to a and f . Using the results discussed in

the covariance matrix for a,

aQ can be determined. The corresponding covariance

matrix for f can be determined from

f Q = F

aQ FT . On applying (22) the error

f

∇

∇

a

∇

∇

bars for f can be determined.

−

a

∇

∇

Traditionally this problem has been solved by applying classical techniques, such as

the Stokes (1948) method. In order to overcome the numerical instability of the Stokes

(27b)

(27c)

3.6,

§

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

15

method, methods such direct convolution (Howard & Snyder 1989, Howard & Preston

1989) and proﬁle ﬁtting methods, such as the Voigt function (Wu et al. 1998, Balzar

& Ledbetter 1993, Langford 1992, de Keijser et al. 1983, de Keijser et al. 1982) have

been developed. These approaches assume an analytical proﬁle function for the specimen

proﬁle; the convolution product between the instrument and specimen proﬁle is reﬁned,

by updating the parameters that deﬁne the specimen proﬁle, until the error between the

calculated and observed data is minimized. These methods are a means to an end. There

is often no physical basis for choosing a particular proﬁle function, except that it results

in a minimized error (Armstrong 1999). However, the Bayesian/fuzzy pixel/MaxEnt

approach determines the maximally uncommitted solution or the solution with the least

assumptions (Wu 1997), given all the available data and information.

4 Generating & analyzing simulated CeO2 data

4.1 Generating the simulated data

Particle-size distribution, P (D).

In order to test the Bayesian/MaxEnt method,

simulated data for the 200 and 400 line proﬁles from CeO2 were generated. The crystallites

were assumed to be spherical in shape with a log-normal crystallite-size distribution,

P (D) =

1
2π D2 ln2 σ0

exp

1
2

ln(D/D0)

2

"−

(cid:18)

ln σ0 (cid:19)

#

p
where D0 is the median and σ2
and variance, σ2

0 is the log-normal variance. The average diameter,

hDi, of the distribution are related to these quantities by

and

= D0 eln2 σ0/2

D
h

i

hDi = D2
σ2

0 eln2 σ0

eln2 σ0
(cid:16)

−

1

.

(cid:17)

(28a)

D
h

,
i

(28b)

(28c)

The log-normal parameters used were D0 = 13.03 nm and σ2

0 = 2.89. Using (28b)

and σ2

and (28c), the average diameter and variance were determined to be,

= 15.00 nm
hDi = 73.17 nm2, respectively. Using the results from Krill & Birringer (1998)(see
Equations 6-8, p625), the corresponding area- and volume-weighted sizes were determined.

D
h

i

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

16

The area- and volume-weighted diameters for spheres are related to the sizes (Langford

et al. 2000) by

and

D
h

ia =

3
t
2 h

ia

The area- and volume-weighted sizes,

proﬁle, f , and Fourier coeﬃcients, A(t), by using (Warren 1969)

4
t
iv =
3 h
ia and

t
h

D
h

t
h

iv.
iv, can be determined from the specimen

(29b)

The volume-weighted size is inversely related to the integral breadth and can be deter-

mined either directly from the specimen proﬁle, f , or from its Fourier coeﬃcients, A(t),

t
h

−1
a =
i

−

dA(t)
dt

.

t→0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

β =

f (s) ds/fmax

∞

∞

−∞

Z

2
(cid:20)
t
h

0
Z
−1
v ,
i

=

=

A(t) dt

−1

(cid:21)

(29a)

(30)

(31a)

(31b)

(31c)

where β is in reciprocal space units.

17.56 nm and

Using (30) and (29), the area-weighted size and diameter were determined as

ia =
ia = 26.34 nm, respectively. Using (31a) and (29), the volume-weighted
iv = 34.91 nm, respec-
iv = 26.18 nm and
tively. These settings are considered as the theoretical values for the simulated data.

size and diameter were determined as

D
h

D
h

t
h

t
h

The Bayesian/fuzzy pixel/MaxEnt results are compared with the theoretical sizes and

percentage diﬀerences are determined.

Line proﬁles, f (2θ) & k(2θ). Using the parameters for the size distribution, the
specimen proﬁle for spherical crystallite, f (2θ), was modelled over the range (2θ0 ±
at a step size of 0.01 ◦2θ (see (8)). The simulation of the specimen proﬁle over this

10) ◦2θ

range minimized any artifacts in the Fourier coeﬃcients. The instrument proﬁle, k(2θ),

was modelled on the diﬀractometer parameters and LaB6 line-position standard reference

material, as discussed in

5. The split-Pearson VII function for the 200 line consisted of

§

the following parameters: FWHMlow = 0.030 ◦2θ, FWHMhigh = 0.027 ◦2θ and mexp,low =

6.928, mexp,high = 11.324, where mexp are the split-Pearson exponents. The ‘low’ and

‘high’ subscripts are with respect to the Bragg positions, 2θ0 (see Fig. 7).

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

17

Generating g(2θ). The observed line proﬁles, g(2θ), for the 200 and 400 lines con-

sisted of the convolution of the specimen line proﬁle, f (2θ), with the instrument line

proﬁle, k(2θ), Poisson noise, and a linear background level, b(2θ). Statistical noise was

also imparted onto the background before adding it to the convoluted product. This is

expressed by (1).

The generation of g(2θ) was carried out over 2θ0 ±

10 ◦2θ in order to minimize any

truncation errors. The maximum peak height for the 200 line proﬁle was set to 6500 counts

(without background level and noise or a total of 7835 counts including background level

and noise) and the peak-to-background ratio, Rpb, was set to 6.0. The corresponding

percentage error in the peak maximum was determined using

σpeak =

1
(Rpb −

1)

(cid:20)

Rpb(Rpb + 1)
Imax,bg

1
2

×

(cid:21)

100%

(32)

where Imax,bg is the maximum number of counts, including background level. Simulated

g(2θ) for the 200 and 400 line proﬁles are shown in Fig. 2. The uncertainty for the 200

line was 1.5% in the peak height. Similarly, for the 400 line the maximum peak height

was set to 1500 counts (2646 counts including background level and noise), the average

peak-to-background ratio was set to 2.4; and the estimated statistical uncertainty in the

peak height was found to be 4.0%.

In order to simulate realistic conditions, the Bayesian/MaxEnt analysis of the g(2θ)

was carried out in a truncated region (2θ0 ±
400 line proﬁles. In the analysis, the background level was assumed to be unknown and

2) ◦2θ for the 200 and (2θ0 ±

1.5) ◦2θ for the

was approximated by a linear function over this region. This was achieved by examining

the Fourier coeﬃcients of g(2θ) as the level was raised/lowered until distortions (i.e.

‘hook eﬀect’ etc.) were removed. Fig. 2 shows the simulated g(2θ) before and after the

background level estimation for the 200 and 400 line proﬁles.

Generating the kernels, R, Ip & K The numerical evaluation of the instrument

kernel R, line proﬁle kernel Ip, and scattering kernel K, are an important aspect in the

application of the Bayesian/MaxEnt method. The evaluation of the fuzzy pixel kernel, F,

is also important in the implementation of the fuzzy pixel/MaxEnt method in determining

the specimen proﬁle, f . This section expands on

3.2.

§

The advantage of the Bryan algorithm (Bryan 1990) and the Bayesian/MaxEnt algo-

rithm is that the search direction (or subspace) is deﬁned by the singular value decompo-

sition (SVD) of the scattering kernel, K. This approach is numerically eﬃcient (in that

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

18

(a)

(c)

8000

6000

4000

2000

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

0

3000
2500

2000

1500
1000

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

500
0
67.9

(b)

(d)

)
s
t
i
n
u

.
r
b
A
(

y
t
i
s
n
e
t
n
I

g
o
L

10

8

6

4

2

0

8

6

4

2

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

g
o
L

0
67.9

32

33
Position ◦2θ

34

35

32

33
Position ◦2θ

34

35

68.9

69.9

70.9

68.9

69.9

70.9

Position ◦2θ

Position ◦2θ

Figure 2: Simulated observed 200 and 400 CeO2 proﬁles, g(2θ). (a) The 200 proﬁle (solid line) and estimated

background level (dashed line) over (2θ0

2) ◦2θ, the range over which the analysis was carried out.

(b)

±

Logarithm of the 200 proﬁle before (solid line) and after (dashed line) the background estimation. (c & d) Plots

corresponding to (a) and (b), respectively, for the 400 proﬁle over (2θ0

1.5) ◦2θ

±

it reduces the number of ﬂoating point operations) and also numerically stable, since it

does not utilize the full column-space of the kernels. As was pointed out in

3.2, the

§

vector-space spanned by the column vectors of K may be all (or nearly all) linearly de-

pendent, causing it to be ill-conditioned. The ill-conditioned characteristics are overcome

by the SVD of K, V Σ UT , where the ‘singular space’ spanned by the column vectors of

U is used to deﬁne the subspace in which the size distribution can be determined.

The instrument kernel, R, is an [M

N ′] matrix. The elements of this matrix can

×
2θj′), where M

be determined by Rij′ = k(2θi −
reciprocal-space, s, by multiplying each column of R by d(2θ)/ds = λ/ cos θj′.

≥

N ′. This matrix can be mapped into

The line proﬁle kernel expresses (3) as an [N ′

N ] matrix, Ip ≡

×

[Ip j′j], consisting of the

line proﬁle from a speciﬁc common volume (i.e. shape) function. The formalism presented

here is completely general and any shape function can be used where appropriate. In this

study, we have employed the common-volume function for spherical crystallites (see 4),

Ip j′j = 


1
16π3s′4
j′
πD4
j
8

+

D2
j
8πs′2
j′ −

cos(2πs′

j′ Dj )
j′ −

Dj sin(2πs′
8π2s′3
j′

16π3s′4

j′ Dj)

for s′

for s′

= 0

j′ 6
j′ = 0

(33)

where the second term in (33) ensures that the line proﬁle from a single spherical crystallite



Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

19

is ﬁnite for s = 0.

The evaluation of the scattering kernel, K, is the matrix product of the instrument

kernel (mapped into s-space), R, and the line proﬁle kernel, (33). Using (10)

K(si, Dj) = δD δs′

k(si −

j′) Ip(s′
s′

j′, Dj)

Xj′

Kij = δD δs′

Rij′ Ip j′j

Xj′
K = δD δs′ R Ip

(34a)

(34b)

(34c)

where R has been mapped into s-space, δs′ is the step size in s′-space and approximates the

integration in (10), while δD is the step size in D-space and approximates the integration

in (9). Care must be taken in selecting δD to avoid the under-sampling of (33).

4.2 Applying the fuzzy pixel/MaxEnt method for f (2θ)

This approach involves determining the specimen proﬁle from the simulated data. It is

equivalent to solving the deconvolution problem, (1), and is an important ﬁrst step in

assessing the nature of the specimen broadening. In the past, we have applied the Skilling

& Bryan (1984) algorithm with global smoothing (see Sivia 1996), which we refer to here

as the ‘old’ MaxEnt method. However, in this section we apply the Fuzzy Pixel/MaxEnt

method discussed in

3.7, to determine f (2θ). The results are also compared with those

§

from the ‘old’ MaxEnt method, and their reliability in reproducing the log-normal param-

eters for the crystallite-size distribution (set in

4.1) are assessed.

§

The specimen line proﬁles from the ‘old’ MaxEnt approach are given in Fig. 3. These

results were compared with the theoretical specimen proﬁles by evaluating the Rf and

Rw values. A summary of these and subsequent analyses is given in Table 1.

The ‘old’ MaxEnt method is not based on a Bayesian formalism (see Gull 1989, Skilling

1989a) and spurious oscillations can appear in the solution specimen proﬁle. This second

point becomes important in analyzing high angle/low intensity proﬁles. This is further

illustrated by inspecting the residuals in Fig. 3(b), where the amplitude of the residuals

is large in comparison with the normalized peak height. We contrast the results in Fig. 3

with the fuzzy pixel/MaxEnt method discussed in

3.7. Using this theory, the fuzzy pixel

distribution specimen proﬁles are shown in Fig. 4. The fuzzy pixel distribution determines

the optimum fuzzy pixel width, ω (see (27)). For the 200 line, the optimum value was

found to be ˆω

0.07 ◦2θ and for the 400 line, ˆω

0.05 ◦2θ. This deﬁnes the correlation-

≈

length scale of the noise in the simulated data and essentially ﬁlters out the noise eﬀects.

§

≈

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

20

y
t
3
i
s
n
e
t
n
2
I
d
e
s
i
1
l
a
m
r
o
0
N

(a)

(b)

3
y
t
i
s
n
e
2
t
n
I

d
e
1
s
i
l
a
m
r
o
0
N

32

33
Position ◦2θ

34

35

67.9

68.9

69.9

70.9

Position ◦2θ

Figure 3: ‘Old’ MaxEnt specimen proﬁles for the 200 and 400 line proﬁles. (a) The theoretical 200 specimen

proﬁle (solid line), ‘old’ MaxEnt specimen proﬁle (long dashed line + error bars) and the residuals (short dashed

line). (b) Corresponding results for the 400 line proﬁle, as shown in (a). The horizontal error bars in (a) &

(b) represent non-overlapping region of interest, while the vertical error bars represent the uncertainty in the

averaged integrated ﬂux over the region of interest.

It is evident from the residuals of the multiple orders that smoothing of the specimen

proﬁle has been achieved using this approach.

Using the line proﬁles determined and assuming a spherical crystallite shape, the

parameters of the underlying log-normal size distribution can be reproduced by following

the approach of Krill & Birringer (1998). These results are shown in Table 1. The analysis

has produced mixed results, due to the stringent but realistic conditions imposed on the

background estimation. Comparing the 200 line proﬁle results for the ‘old’ MaxEnt and

fuzzy pixels methods, there is a noticeable improvement in the latter results over the

former. This is not only seen in an improved Rf value, but also in the reproduced log-

normal parameters. In the case of the 400 line, we notice that the Rf value has improved

by a factor of

3 and the volume-weighted size by a factor of

1.5 for the fuzzy

∼

∼

pixel/MaxEnt approach. However, the area-weighted size for the 400 line proﬁle has not

improved. As a consequence, when the underlying log-normal parameters are determined

from the area- and volume-weighted sizes no improvements are gained.

These results for the 400 line proﬁle can be explained by the low peak-to-background

ratio, statistical uncertainty, and the presence of systematic errors arising from the back-

ground estimation. The peak-to-background ratio for the 400 line proﬁle is 2.4. This low

value results in an increased uncertainty in the estimated background level. From (32),

we notice that as the peak-to-background ratio increases, the peak height uncertainty

decreases and the dominant source of uncertainty becomes the statistical noise.2 The

2Taking (32), we see that in the limit of Rpb

1, σp

→

→ ∞

. On the other hand, in the limit of Rpb

,
→ ∞

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

21

0.02

0.03

0.04

0.06

0.07

0.08

0.05
ω ◦2θ

32

33
Position ◦2θ

34

35

0

(a)

]
)

I

,

σ

,

m

,

g

ω
(
r
P

[
g
o
l

-100

|

-200

-300

]
)

20

I

0

,

σ

,

m

,

g

ω
(
r
P

[
g
o
l

-20

|

-40

-60

-80

(c)

(b)

(d)

y
t
3
i
s
n
e
t
n
2
I
d
e
s
i
1
l
a
m
r
o
0
N

3
y
t
i
s
n
e
2
t
n
I

d
e
1
s
i
l
a
m
r
o
0
N

0.01

0.02

0.03

0.04

0.05

0.06

67.9

68.9

69.9

70.9

ω ◦2θ

Position ◦2θ

Figure 4: The fuzzy pixel distribution and MaxEnt solutions for the 200 and 400 line proﬁles.

(a) The

log Pr(ω

g, m, σ,

) distribution used to determine the optimum fuzzy pixel width, ˆω

0.07 ◦2θ for the 200

|

I

≈

specimen proiﬂe. (b) Theoretical specimen proﬁle (solid line), fuzzy pixel/MaxEnt specimen proﬁle (long dashed

line + error bars) and the residuals (short dashed line) for the 200 line proﬁle. (c) The log Pr(ω

g, m, σ,

)

distribution used to determine the optimum fuzzy pixel width, ˆω

I
0.05 ◦2θ for the 400 specimen proiﬂe. (d)

|

≈

Theoretical specimen proﬁle (solid line), fuzzy pixel/MaxEnt specimen proﬁle (long dashed line + error bars)

and the residuals (short dashed line) for the 400 line proﬁle. The horizontal error bars in (a) & (c) represent

the non-overlapping region of interest, while the vertical error bar represents the uncertainty in the averaged

integrated ﬂux over the region of interest.

variance of the observed proﬁle is determined by two components: the Poisson count-

ing statistics, which can be approximated as √g, for g >> 10 counts, and the estimated
background level, best; it can be expressed as σ2 = g + best. The presence of statistical

uncertainty and the low peak-to-background ratio introduces uncertainties to the slope

and intercept of the estimated background level. In turn, this introduces systematic errors

to the Fourier coeﬃcients of f (Armstrong 1999). Although the fuzzy/pixel method has

been successful in improving the quality of the line proﬁle (which amounts to reducing

the statistical error in the solution line proﬁle), the systematic errors have propagated

to the Fourier coeﬃcients of the specimen proﬁle and in turn to the area-weighted size.

Additional calculations and applying the above analysis to simulated data with zero back-

σp

1/

Imax,bg. For example, with R

15, σp

1.2/

Imax,bg.

→

p

∼

∼

p

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

22

’old’ MaxEnt

Fuzzy Pixel/MaxEnt

Results

Rf (%)

Rw (%)

a (nm)
t
i
h
a (nm)
D
i
h
v (nm)
t
h
i
v (nm)
D
i
h
D0 (nm)

σ0

D
(nm)
i
h
hDi (nm2)
σ2

200

4.2

2.9

±
29.8

0.2

±

±
35.51

0.09

±

±

±

±

±

19.9

0.1 (13.3%)

20.4

0.1 (16.0%)

17.89

0.07 (1.9%)

20.5

0.1 (16.5%)

26.63

0.07 (1.7%)

28.0

0.2 (7.1%)

25.86

0.04 (1.2%)

27.4

0.2 (4.8%)

19.3

0.4 (48.1%)

18.4

0.5 (41.5%)

14.3

0.2 (10.1%)

19.8

0.6 (52.0%)

1.52

0.01 (10.7%)

1.57

0.02 (7.8%)

1.650

0.007 (3.0%)

1.52

0.02 (10.6%)

21.06

0.43 (40.4%)

20.4

0.5 (36.0%)

16.3

0.2 (8.4%)

2.6

0.6 (44.1%)

84

5 (15.3%)

93

7 (27.2%)

75

3 (2.9%)

89

8 (22.4%)

200

2.7

3.0

±
26.8

0.1

±

±
34.48

0.05

±

±

±

±

±

400

3.1

3.7

±
30.7

±
36.6

0.2

±

0.3

±

±

±

±

±

400

10.9

3.7

±
30.5

±
37.4

0.2

±

0.2

±

±

±

±

±

Table 1: Area- and volume-weighted sizes for the 200 and 400 specimen line proﬁles (f ) from the ‘old’ MaxEnt

and fuzzy pixel/MaxEnt methods.

D
h

a and
i

D
h

v values were determined using (29). The D0, σ0,
i

D
h

i

and σ2

hDi

values were determined from (28). The percentage diﬀerences between the calculated and theoretical values are

given in parentheses.

ground (i.e. only Poisson noise) show percentage diﬀerences between the calculated and

theoretical results of . 5% for both the 200 and 400 fuzzy pixel/MaxEnt specimen pro-

ﬁles. This highlights the diﬃculty of analyzing high-angle/weak line proﬁles, which clearly

requires a good understanding of the background level in order to reduce the inﬂuence of

systematic errors.

The application of the fuzzy pixel/MaxEnt method for determining f (2θ) enables the

specimen broadening to be assessed. This is important in the application of methods such

as those of Warren-Averbach and Williamson-Hall. Furthermore, the analysis discussed

here can be used as the a priori information of the Bayesian/MaxEnt analysis. The

fuzzy pixel/MaxEnt approach overcomes the diﬃculties in commonly used deconvolution

techniques (see Armstrong & Kalceﬀ 1998) and resolves the ‘ringing eﬀects’ in Armstrong

& Kalceﬀ (1999).

4.3 Bayesian/MaxEnt method for P (D) using diﬀerent m(D)

The next stage in the analysis of the simulated data is applying the Bayesian/MaxEnt

method to determine the particle distribution, P (D). In addition, two diﬀerent approaches

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

23

for determining a model, m(D), were explored and their eﬀects on P (D) were quantiﬁed.

The two approaches were (i) uniform model over D

[0, 60] nm and (ii) ‘low resolution’

∈

approach (Armstrong 1999) using the log-normal distribution parameters determined in

4.2 as the prior.

§

Uniform model The Fourier coeﬃcients A(t) of the fuzzy pixel/MaxEnt specimen

proﬁles (not shown here) suggest the maximum size of the crystallites is

60 nm, since

A(t)

D

∈

0 at this length. Using this information, a uniform distribution was deﬁned over

∼
[0, 60] nm. The corresponding Bayesian/MaxEnt results are shown in Fig. 5. The

posterior distribution for α is shown in Figs. 5(a) & (c) for the 200 and 400 proﬁles,

respectively. This distribution was used to average over the set of solutions

for each

case. The Bayesian/MaxEnt results are given in Fig. 5(b) & (d) for the 200 and 400

∼

P
}
{

proﬁles respectively.

Using a uniform model, the Bayesian/MaxEnt size distributions where compared with

the theoretical size distribution, P (D). The Bayesian/MaxEnt results share ‘global’ fea-

tures with the theoretical size distributions. However, ‘local’ features are poorly deﬁned,

especially in the region of 0 . D . 10 nm. This is a direct consequence of the uniform

model and the lack of relevant information in the data; that is, it assigns an equal weight

to all sizes over D. The vertical error bars in both cases correctly represent the misﬁtting

between the theoretical and Bayesian/MaxEnt size distributions; additionally, their mag-

nitude also signiﬁes that a uniform model transfers little or no useful information. This

can also be seen in the parameters for the Bayesian/MaxEnt distribution compared with

their theoretical values in Table 2. In determining the log-normal parameters from the

Bayesian/MaxEnt P (D), the ﬁtted distribution produce reasonable results. This suggests

that, although the a proiri model is uniform, the Bayesian/MaxEnt method can ‘extract’

some information concerning the underlying distribution from the simulated data.

‘Low resolution’ approach A log-normal a priori model used in the Bayesian/MaxEnt

method was deﬁned from the D0 and σ0 of the 200 fuzzy pixel/MaxEnt line proﬁle (see Ta-

ble 1). Unlike the uniform model, this model deﬁnes local features of the size-distribution.

The Bayesian/MaxEnt results using this model are shown in Fig. 6 and the determined

parameters in Table 2. Before discussing the results, it is interesting to point out that

the log-normal model and theoretical size-distribution produce a diﬀerence of 15.8%. One

of the aims of this section is to assess whether this diﬀerence has been imparted to the

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

24

0

0.25

0.5

1

1.25

1.5

0.75
Alpha, α

10

20

30
Diameter, D (nm)

40

50

60

(a)

(c)

)

,

σ
m

,
g

α
(
r
P

4

I
3

|

2

1

0

1.5

)

I

1

,

σ
m

,
g

α
(
r
P

|

0.5

0

0

(b)

(d)

0.08

0.06

0.04

0.02

)

D

(
P

0

0

0

0

0.08

0.06

0.04

0.02

)

D

(
P

1

2
Alpha, α

3

4

10

20

30
Diameter, D (nm)

40

50

60

Figure 5: Bayesian/MaxEnt crystallite size distributions using a uniform a priori model.

(a) The

Pr(α
|

I

g, m, σ,

) distribution, (17), used to average over the set of solutions,

(b) The theoretical

P(α)
}

.

{

crystallite size distribution (solid line), Bayesian/MaxEnt size distribution (long dashed line + error bars), and

the uniform a priori model (short dashed line). (c) & (d) The corresponding Pr(α
|

I

g, m, σ,

) distribution and

Bayesian/MaxEnt size distribution for the 400 line proﬁle.

Uniform model

‘Low’ Res. Model

Results

Rf (%)

D0 (nm)

σ0

13.9

0.3 (6.5%)

11.9

14.8

0.2 (13.4%)

12.5

0.2 (4.4%)

1.589

0.003 (6.5%)

2.14

1.612

0.002 (5.1%)

1.544

0.002 (9.2%)

D
(nm)
h
i
hDi (nm2)
σ2

15.5

0.3 (3.0%)

57

3 (22.0%)

16.6

0.2 (10.4%)

13.7

0.2 (8.7%)

70

2 (3.9%)

39

1 (46.7%)

400

40.0

0.9 (8.8%)

±
0.03, (25.8%)

2 (5.8%)

±
145 (> 100%)

±
15

197

±

200

22.2

±

±

±

±

400

19.1

±

±

±

±

200

23.0

±

±

±

±

Table 2: P (D) results from the Bayesian/MaxEnt method for the 200 and 400 line proﬁles using diﬀerent a

priori models. The values for D0, σ0,

hDi were determined by ﬁtting the Bayesian/MaxEnt solutions
with a log-normal distribution. The percentage diﬀerence between calculated and theoretical values are given

D
h

i

and σ2

in parentheses.

Bayesian/MaxEnt size-distribution.

Comparing the a posteriori distribution for α using a uniform model (see Figs. 5 (a)

& (c)) with that of the log-normal distribution, given in Figs. 6(a) & (c), we notice that

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

25

the eﬀect of the log-normal model is to shift the distribution in α-space and widen it.

Essentially the solution space parameterized by α has been expanded to encompass those

solutions which correspond to the available a priori and experimental data.

The Bayesian/MaxEnt size distributions, given in Figs. 6(b) & (d), compare reasonably

well with the theoretical distribution. However, there is noticeable misﬁtting between

these distributions. Further, the Bayesian/MaxEnt solution has been shifted slightly

relative to the log-normal model. This is also evident in the Rf for the 200 and 400 size

distributions, given in Table 2. The Rf for both solutions has increased relative to the

log-normal model by an additional

∼
percentage diﬀerences for the D0, σ0,

3

−
D
h

hDi parameters for the 200 fuzzy pixel
solution, given in Table 1 (i.e. third column), with those given in Table 2 using the ‘low

i

and σ2

6%. This can also be seen by comparing the

resolution’ method, where there is a slight increase in the percentage diﬀerence, with the

exception of the σ2

hDi value. Additional calculations suggest that misﬁtting between the
solution and theoretical size distributions arises from errors in the a prior model. The

inﬂuence of the background estimation which was problematic in the fuzzy pixel analysis

does not seem to be a factor in this analysis.

While there exists some misﬁtting between the solution and theoretical size distribu-

tions, the vertical error bars correctly account for this misﬁtting. This characteristic of

the Bayesian/MaxEnt can be seen for both the uniform and non-uniform models.

In-

deed, this feature of the method ensures that it is fully quantitative, and represents a

clear strength over existing methods. Comparing these solutions with those using a uni-

form model, considerable improvement in the size distribution has been achieved. The

‘local’ information deﬁned in the log-normal a priori model has been imparted to the

Bayesian/MaxEnt solution.

This analysis also demonstrates the diﬃculty in estimating a suitable non-uniform

model based on the current techniques. Further, any uncertainty in the model parameters

is also passed on to the solution distribution. This indicates the need to quantify the

uncertainty in the model parameters and quantify how these uncertainties are passed on

to the solution size distribution.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

26

10

20

40

50

60

30
Alpha, α

10

20

30
Diameter, D (nm)

40

50

60

(a)

(c)

0.1

)

,

σ

,

m

,
g

α
(
r
P

I

0.08

0.06

0.04

|

0.02

0

0

)

I

0.3

0.2

,

σ

,

m

,
g

α
(
r
P

|

0.1

0

0

(b)

(d)

0.08

0.06

0.04

0.02

)

D

(
P

0

0

0.1

0.08

0.06

0.04

0.02

)

D

(
P

0

0

10
Alpha, α

20

10

20

30
Diameter, D (nm)

40

50

60

Figure 6: Bayesian/MaxEnt crystallite size distributions using a log-normal a priori model.

(a) The

Pr(α
|

I

g, m, σ,

) distribution, (17), used to average over the set of solutions,

(b) The theoretical

P(α)
}

.

{

crystallite size distribution (solid line), Bayesian/MaxEnt size distribution (long dashed line + error bars) and

the low-resolution a priori model (short dashed line). (c) & (d) The corresponding Pr(α
|

g, m, σ,

) distribution

I

and Bayesian/MaxEnt size distribution for the 400 line proﬁle.

5 Experimental Details

Analysis of the simulated data highlighted diﬃculties of background estimation and the

eﬀect of the a priori model on the Bayesian/MaxEnt size distribution. However, this

analysis provided a useful understanding of the experimental condition which were used

in conducting an appropriate set of measurements. The fuzzy pixel/Bayesian/MaxEnt

methods were applied to experimental CeO2 diﬀraction data to determine the specimen

proﬁles, crystallite shape, and size distribution. These results are compared with trans-

mission electron microscopy data.

5.1 XRD Details

The CeO2 specimen used here was prepared for the recent CPD and IUCR size round

robin by Lou¨er & Audebrand (2001).

Diﬀraction patterns were collected on a Siemens D5003 diﬀractometer equipped with
3Certain commercial materials, equipment and software are identiﬁed in order to adequately specify the

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

27

a focusing Ge incident beam monochromator, sample spinner and a scintillation detector.

Copper Kα1 radiation with a wavelength λ = 0.15405945 nm was used. The divergence

slit was 0.67 ◦, while the receiving optics included a slit of 0.05 ◦ and 2 ◦ Soller slits. Data

were collected in discrete regions straddling the maxima of each proﬁle, with the step and

scan width of each region being varied in correspondence with the FWHM. Count times

were varied so as to obtain an approximately constant total number of counts for each

scan region. The instrument proﬁle function was determined using a split-Pearson VII

proﬁle shape function ﬁtted to 22 reﬂections collected from SRM 660a (LaB6). Fig. 7,

shows the FWHMs and exponents for the split-Pearson VII proﬁle function. The low-

and high-FWHMs were ﬁtted using (Cheary & Cline 1995)

FWHM2 = A tan2 θ + B cot2 θ + C tan θ + D,

(35)

while the low- and high-exponents were ﬁtted using a ﬁfth-order polynomial.

(a)

(b)

θ
2
◦

M
H
W
F

0.10

0.08

0.06

0.04

0.02

s
t
n
e
n
o
p
x
E

12.00

9.00

6.00

3.00

0.00

20

40

60

120

140

20

40

80

100
Position ◦2θ

60

80

100
Position ◦2θ

120

140

Figure 7: Calibration plots for the split-Pearson VII line proﬁles, generated from the SRM 660a (LaB6)

diﬀraction pattern and used to model the instrument function, K(2θ). (a) The FWHM vs 2θ for low- (+ &

solid line) and high- (

& dashed line) angle sides of the peak. (b) The exponents vs 2θ for low- (+ & solid

line) and high- (

& dashed line) angle sides of the peak.

×

×

The count times for the CeO2 data were optimized using (32) so that the percentage

error was kept in the range 1-3% for all peaks in the CeO2 pattern. The scan ranges for

the CeO2 data were considerably wider, in proportion to the FWHM, than those used for

the data collection from SRM 660a. This ensured a reasonable determination of the tails

of the proﬁles and background levels. The CeO2 200 line proﬁle is shown in Fig. 8(a).

This illustrates a typical experimental line proﬁle using the above conditions and settings.

The estimated (linear) background level is also shown. A log plot of the 200 line before

experimental procedure. Such identiﬁcation does not imply a recommendation or endorsement by NIST, nor

does it imply that the materials or equipment or software are necessarily the best available for the purpose.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

28

and after the background estimation is shown in Fig. 8(b). The procedure for determining

the background level is as described in

4.1.

§

(a)

(b)

8000

6000

4000

2000

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

0

)
s
t
i
n
u

.
r
b
A
(

y
t
i
s
n
e
t
n
I

g
o
L

10

8

6

4

2

0

32

33
Position ◦2θ

34

35

32

33
Position ◦2θ

34

35

Figure 8: CeO2e Experimental 200 proﬁle, g(2θ): (a) The observed 200 proﬁle (solid line) and estimated

background level (dashed line) over (2θ0

2) ◦2θ, the range over which the analysis was carried out.

(b)

±

Logarithm of the 200 measured proﬁle before (solid line) and after the background estimation (dashed line).

5.2 TEM Details

Particle agglomerates were gently crushed in ethanol using a mortar and pestle. A portion

of the dilute slurry was dispersed on a holey carbon ﬁlm and left to dry. Once in the TEM,

a series of micrographs of particles were taken at a ﬁxed magniﬁcation of 200k

. In the

×

preliminary examination reported here, these negatives were scanned and analysed by

manually approximating the particle size with an oval. The oval’s major and minor axes

were adjusted so as to tangentially intersect the particle surface facets.

There are several sources of error in the measurements: TEMs typically have a 5% error

in length scale measurements; also, imaging the particle clusters means that particles are

at diﬀerent heights, which results in Fresnel fringes around the particles making it harder

to identify particle edges. Further, larger particles give better contrast and it is easier to

detect their edges, so it is possible to inadvertently preferentially choose larger particles

over smaller ones.

A frequency histogram for about 850 particles is shown in Fig. 12(d). This ﬁgure also

shows the Bayesian/MaxEnt size distributions (discussed in

6.2) determined from the

§

non-overlapped hkl proﬁles of the CeO2 diﬀraction pattern. A TEM micrograph of the

CeO2 crystallites is shown in Fig. 13. It can be seen from the larger particles that they

have a spherical-like morphology.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

29

6 Analysis of CeO2 x-ray diﬀraction data

Two levels of application of the Bayesian and MaxEnt theory has been chosen in our

analysis. We refer to these as the qualitative and quantitative approaches, to reﬂect their

degree of rigor (see

6.1 & 6.2, respectively).

§

6.1 Qualitative analysis

The qualitative analysis is used to determine the type and nature of specimen broadening,

by ﬁrst determining the specimen proﬁle, f , followed by the application of the Warren-

Averbach and Williamson-Hall methods. The integral breadths, from a Williamson-Hall

plot, identify the presence of both strain- and size-broadening contributions, while plotting

multiple-order Fourier coeﬃcients and all other available Fourier coeﬃcients on the same

axes, also allows size- and strain-broadening contributions be identiﬁed (see Armstrong

1999).

We have introduced the fuzzy pixel/MaxEnt method for determining f to ensure that

no artifacts (such as spurious oscillations in the tails of f ) are promulgated to the solution,

and also to preserve the positivity of f .

We stress that unlike traditional methods, the approach in this section makes no as-

sumptions at all about the nature of the specimen proﬁle or broadening (i.e be it Gaussian,

Lorentzian, Voigtian etc.). Thus, in further distinction from traditional deconvolution

approaches, our approach facilitates the subsequent unbiased assessment of anisotropic

broadening in the specimen, for example using contrast factors (Ung´ar & Tichy 1999).

Fig. 9 shows an example of the fuzzy pixel/MaxEnt method applied to the CeO2

measured 200 line proﬁle given in Fig. 8. Fig. 9(a) is an example of the ‘old’ MaxEnt

method, showing the eﬀect of noise ampliﬁcation. On applying the fuzzy pixel/MaxEnt

method, the correlation length scale for the proﬁle was determined, as discussed in

3.7

§

and is shown in Fig. 9(b); the subsequent f and Fourier coeﬃcients for the 200 line proﬁle

are given in Figs. 9(c) & (d), respectively. As demonstrated in the analysis of the simulated

data, there is noticeable improvement in the quality of the solution line proﬁle using the

fuzzy pixel/MaxEnt method. This approach was applied to all the non-overlapped line

proﬁles, including 111, 200, 220, 400, 422, 511 and 531.

The volume- and area-weighted sizes were determined from the Williamson-Hall plot

and Fourier coeﬃcients, respectively. These results are shown in Fig. 10 and summarized

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

30

(a)

(c)

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

d
e
s
i
l
a
m
r
o
N

)
s
t
n
u
o
C
(

y
t
i
s
n
e
t
n
I

3
2.5

2
1.5

1

0.5
0

3
2.5

2

1.5
1

0.5
0

32

33
Position ◦2θ

34

35

0.02

0.03

0.04

0.06

0.07

0.08

0.05
ω ◦2θ

30
t (nm)

0

(b)

(d)

]
)

I

,

σ

,

m

,

g

ω
(
r
P

[
g
o
l

-100

|

-200

-300

)
t
(
A

.

ﬀ
e
o
c

e
z
i
S

1.0

0.8

0.6

0.4

0.2

0.0

25.0

20.0

15.0

)

m
n
(

a

i

10.0

t

h

5.0

0.0

32

33
Position ◦2θ

34

35

0

10

20

40

50

60

Figure 9: Specimen proﬁles from the ‘old’ MaxEnt method and fuzzy pixel/MaxEnt method for the measured

CeO2 200 line. (a) ‘Old MaxEnt’ specimen proﬁle (solid line + error bars). (b) log Pr(ω

g, m, σ,

) distribution

|

I

to determine the optimum fuzzy pixel width, ˆω

0.07 ◦2θ. (c) Fuzzy Pixel/MaxEnt specimen proﬁle (solid line

+ error bars). (d) Fuzzy Pixel/MaxEnt Fourier coeﬃcients (solid line).

≈

in Table 3.

)

1
−
m
n
(

∗
β

0.10

0.08

0.06

0.04

0.02

0.00

(a)

111
200

220

422

531

400

511

(b)

111

220

422

531

200

400

511

60

80
Position ◦2θ

0

2

4

6

8

10

12

14

0

20

40

100

120

d∗ (nm−1)

Figure 10: Volume- and area-weighted sizes from the Fuzzy Pixel/MaxEnt line proﬁles for measured CeO2

data. (a) Classical Williamson-Hall plot of the integral breadths, showing no dependency on hkl. This suggests

that the crystallites are spherical in shape. (b) Area-weighted sizes determined from the Fourier coeﬃcients of

the Fuzzy Pixel/MaxEnt line proﬁles.

Fig. 10(a) shows the Williamson-Hall plot for the non-overlapped line proﬁles. It is

evident that size eﬀects are the dominant source of specimen broadening, since there

is no detectable slope in the integral breadth data. Moreover, there is no systematic

variation of the integral breadths with hkl, further suggesting that the crystallite shape

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

31

hkl

111

200

220

400

422

511

531

htia

(nm)

hDia

(nm)

htiv

(nm)

hDiv

(nm)

D0

(nm)

σ0

hDi

(nm)

19.21 ± 0.05

28.81 ± 0.07

22.88 ± 0.03

30.50 ± 0.04

25.0 ± 0.2

1.270 ± 0.007

25.7 ± 0.2

16.04 ± 0.06

24.06 ± 0.08

22.22 ± 0.05

29.63 ± 0.06

14.3 ± 0.2

1.578 ± 0.007

15.9 ± 0.2

18.92 ± 0.04

28.38 ± 0.06

23.24 ± 0.04

31.00 ± 0.05

22.8 ± 0.2

1.345 ± 0.006

23.8 ± 0.2

15.76 ± 0.06

23.64 ± 0.09

22.03 ± 0.11

29.4 ± 0.2

13.7 ± 0.3

1.59 ± 0.01

15.3 ± 0.3

15.45 ± 0.08

23.2 ± 0.1

21.5 ± 0.1

28.6 ± 0.1

13.7 ± 0.3

1.58 ± 0.01

15.2 ± 0.3

15.91 ± 0.07

23.9 ± 0.1

21.9 ± 0.1

29.2 ± 0.2

14.4 ± 0.3

1.57 ± 0.01

16.0 ± 0.3

15.04 ± 0.04

22.55 ± 0.07

21.9 ± 0.1

29.20 ± 0.16

11.8 ± 0.2

1.66 ± 0.01

13.5 ± 0.2

Average

16.6 ± 0.2

24.9 ± 0.2

22.2 ± 0.2

29.6 ± 0.3

16.5 ± 0.6

1.51 ± 0.03

17.9 ± 0.7

σ

2
hDi
2
)

(nm

39 ± 2

58 ± 2

52 ± 2

56 ± 3

54 ± 3

57 ± 3

53 ± 3

53 ± 7

Table 3: Summary of CeO2 data analysis. The area- and volume-weighted sizes were determined from the

specimen proﬁle of the fuzzy pixel/MaxEnt method. The

t
h

a and
i

t
h

v results were determined directly from f
i

using (30) and (31), respectively. The area- and volume-weighted diameters were determined using (29), while

the log-normal parameters were determined from Krill & Birringer (1998) and using (28).

is independent of hkl. From these results, we can infer that the average shape of the

crystallites is spherical. This is further supported by the area-weighted sizes shown in

Fig. 10(b). These results were determined by applying (30) to the Fourier coeﬃcients of

the fuzzy pixel/MaxEnt specimen proﬁles and plotted over the entire 2θ-range. Again, the

relative uniformity of this plot suggests that size eﬀects are the major source of specimen

broadening and that crystallites are near-spherical in shape. Deviations for the 111 and

220 data points in Fig. 10(b) arise from the diﬀerentiation of (30) in the region t

0,

→

where perturbations in the Fourier coeﬃcients cause large changes in the area-weighted

size (Armstrong 1999). In addition, the Fourier coeﬃcients for all the non-overlapped hkl

lines suggest that the maximum crystallite size is

be seen in Fig. 9(d), where A(t)

0 for

50

∼

∼

−

50

60 nm. An example of this can

∼
60 nm. This can also be seen from the

−

discussion in

2.2 and by inspecting Fig. 1, where the boundary conditions for A(t) (or

§

V (t)) are deﬁned in terms of the maximum size in the direction of the scattering vector.

Referring to Table 3, a spherical crystallite shape model was used to determine the

area- and volume-weighted diameters, together with (29a) and (29b), respectively. The

log-normal distribution parameters, D0, σ0,

hDi were determined using the
equations developed by Krill & Birringer (1998) and (28), which relate the log-normal

D
h

i

and σ2

parameters to the area- and volume-weighted sizes and the average diameter,

D
h

, and
i

variance σhDi.

It can be seen from Fig. 9 and Table 3, that the area- and volume-weighted sizes are

relatively uniform for the 2θ (or hkl) range. The quoted uncertainty for the averages was

determined from a sum of squares of the uncertainties in the tabulated results.

The average results for D0 and σ0, were used to deﬁne a log-normal a priori model

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

32

in the Bayesian/MaxEnt method (see

6.2). By deﬁning the a priori model as a log-

§

normal distribution, we are essentially testing the assumption that the size distribution

is a log-normal distribution.

If the underlying size distribution is indeed log-normal, with parameters close to those

in Table 3, then we would expect the Bayesian/MaxEnt solution to lie ‘close’ to the a

priori model. However, if the Bayesian/MaxEnt solution were ‘some distance’ from the

a priori model, this would imply that either the underlying parameters or the model

were inappropriately deﬁned. The former case was demonstrated in analysis of the simu-

lated data (see

4.3), where uncertainties in the log-normal model were passed onto the

§

Bayesian/MaxEnt solution; the latter case requires additional Bayesian analysis to test

possible models (Sivia et al. 1993, Loredo & Lamb 2001).

In summary, the qualitative analysis has applied the fuzzy pixel/MaxEnt method to de-

termine the specimen proﬁle f for all non-overlapped line proﬁles from the CeO2 measured

data (see Fig. 9). This enabled subsequent analyses to determine the Fourier coeﬃcients,

integral breadths, and the area- and volume-weighted sizes. Fig. 10 and Table 3 clearly

indicate that the CeO2 specimen on average consists of spherical crystallites. While a

log-normal distribution can be ﬁtted to these results, a quantitative method such as the

Bayesian/MaxEnt technique is needed to determine the CeO2 size distribution directly

from the experimental data and to verify the assumption of a log-normal model.

6.2 Quantitative analysis

The quantitative analysis method uses the a priori information determined from the

qualitative analysis and the available experimental data (such as the instrument and proﬁle

kernels, statistical uncertainties and experimental line proﬁles) to directly determine the

crystallite size distribution.

The MaxEnt method also enables an a priori model to be included, while quantifying

the uncertainty in the solution size distribution.

In this section, we apply the Bayesian/MaxEnt method to the CeO2 data. The anal-

ysis presented here follows the steps discussed in

4.3. Two a priori models are used:

§

– (i) a uniform model, and (ii) the log-normal distribution determined in

6.1. The

§

Bayesian/MaxEnt size distributions for each case are ﬁtted with a log-normal distribu-

tion, while the size distributions from (ii) are compared with the TEM size distribution,

with very good agreement.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

33

Uniform model A uniform model was deﬁned over the region of D

[0, 60] nm

determined by the Fourier coeﬃcients of the specimen proﬁle, where A(t)

0. This is

∈

∼

illustrated by the Fourier coeﬃcients for the 200 line proﬁle, given in Fig. 9(d). The

Bayesian/MaxEnt size distributions using this model are shown in Fig. 11 for the 200 line

proﬁle (see Fig. 11 (a & b)). The size distributions for the non-overlapped line proﬁles

are given in Fig. 11 (c & d).

(a)

0.6
α

(c)

111
200
220
400
422
511
m(D)

)
I
,

σ

,

m

,
g
α
(
r
P

6.00

4.00

|

2.00

0.00

0.08

0.06

0.04

)

D

(
P

0.02

0.00

(b)

(d)

)

D

(
P

0.08

0.06

0.04

0.02

0.00

25.0

20.0

15.0

)

m
n
(

i

10.0

D

h

5.0

0.0

111

220

422

531

200

400

511

0

0.2

0.4

0.8

1

1.2

0

10

20
30
40
Diameter D (nm)

50

60

0

10

20
30
40
Diameter D (nm)

50

60

0

20

40

100

120

60

80
Position ◦2θ

Figure 11: CeO2 Bayesian/MaxEnt crystallite-size distribution using a uniform a priori model over D

[0, 60] nm: (a) The Pr(α
|

I

g, m, σ,

) distribution, (17), used to average over the set of solutions,

the 200 line proﬁle; (b) Bayesian/MaxEnt crystallite-size distribution (solid line + error bars) and the a priori

∈
for

P(α)
}

{

model over D

[0, 60] nm; (c) CeO2 Bayesian/MaxEnt crystallite-size distributions for the various CeO2 hkl

∈

proﬁles; (d) Average diameters from the uniform model (+) and log-normal models (

). The horizontal lines

×

represent the average for each model.

The uncertainties in the Bayesian/MaxEnt size distribution for the 200 line proﬁle

indicate how little useful a priori information has been transferred from the uniform

model to the ﬁnal distribution. We also notice that the ﬁnal distribution is some distance

from the model, illustrating that the underlying CeO2 crystallite size distribution consists

of a non-uniform structure. As can be seen in Fig. 11(c), the size distributions are poorly

deﬁned in the range of D

[0, 5] nm; while for D & 5 nm the non-uniform structure

∈

is evident. Since the size distribution is the only invariant quantity, we also expect the

solution for each hkl to be the same. From the size distributions given in Fig. 11(c), there

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

34

hkl

111

200

220

400

422

511

D0

(nm)

13.1

14.7

15.5

15.8

11.1

14.3

0.4

0.3

0.4

0.8

0.2

0.3

±

±

±

±

±

±

±

1.9

0.1

1.61

0.03

1.70

0.08

16.3

16.4

17.8

1.7

0.1

18

1

1.728

0.007

12.8

1.66

0.05

16.3

D
h
i
(nm)

0.8

0.4

0.6

0.2

0.4

±

±

±

±

±

±

±

σ2
hDi
(nm2)

140

43

69

7

104

120

25

48

±

±

±

±

±

58

2

78

95

±

±

15

71

σ0

±

±

±

±

±

±

±

Average

14

1

1.7

0.2

16

2

Table 4: Size distribution results using a uniform a priori model in the Bayesian/MaxEnt method. The

Bayesian/MaxEnt size distributions given in Fig. 11(c) were ﬁtted with a log-normal size distribution and the

above parameters determined.

is a broad agreement between the distributions, with the exception of the 111 and 422

cases. Both of these distributions lie at the extremities of the diﬀraction pattern and are

more likely to be susceptible to larger experimental uncertainties.

The Bayesian/MaxEnt size distributions were ﬁtted with a log-normal model and the

and σ2

D0, σ0,

hDi parameters determined. These results are given in Table 4. The
uncertainties in the solution distributions for the uniform model are also reﬂected in the

D
h

i

uncertainties in the ﬁtted quantities. This is especially the case for the variance of the size

distributions, σ2

hDi, with an error of

∼

80%. This large uncertainty is a consequence of

the scatter of size distributions shown in Fig. 11(c). Such scatter is also noticeable when

the average diameters,

values for D0, σ0,

D
h

i

, (Table 4) are plotted, as shown in Fig. 11(d). The average
D
i
h
and σ2

hDi are again in broad agreement with results determined in

6.1, once the uncertainties are taken into account.

§

In summary, the use of the uniform model in the Bayesian/MaxEnt method has shown

that there is a non-uniform structure to the CeO2 size distributions. However, the lack

of information in this model results in large uncertainties and considerable scatter of the

distributions when plotted on the same axes (see Fig. 11(c)).

Log-normal model The parameters for the log-normal distribution determined in

6.1 were used as the non-uniform a priori model in the Bayesian/MaxEnt method. The

§
model was deﬁned over the range of D

[0, 60] nm.

∈

The Bayesian/MaxEnt size distributions for this model are shown in Fig. 12. The

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

35

results are listed in Table 5. Figs. 12(a) & (b) show the results for the 200 size distribution

using this model. The Bayesian/MaxEnt solution lies close to the log-normal model,

while the uncertainties have decreased considerably compared with the size distribution

(using a uniform model) in Fig. 11(b); however, although the vertical error bars have

decreased, they are still considerable. This can be explained in terms of the inﬂuence

of the peak-to-background ratio. As discussed in

4.2, the variance of the experimental

§

data is determined by two terms, the statistical noise and the variance on the estimated

background level.

If the peak-to-background ratio is large (& 10), then the statistical

noise dominates and the corresponding error bars in the Bayesian/MaxEnt distribution

become small when the solution is close to the underlying size distribution. This has been

demonstrated using computer simulations. However, if the peak-to-background ratio is

ﬁnite (< 10), the corresponding error bars in the MaxEnt/Bayesian solution remain ﬁnite

regardless of how close the solution is to the underlying distribution. This is a direct

consequence of determining the size distribution directly from the experimental data.

The Bayesian/MaxEnt size distributions for all the non-overlapped hkl line proﬁles are

shown in Fig. 12(c). They lie very close to each other, reﬂecting the invariance of the size

distribution and remaining close to the log-normal model. The scatter in the size distri-

butions that was noticeable in Fig. 11(c) for the uniform model has disappeared. Further,

these results imply that the underlying size distribution from the CeO2 crystallites can be

described by a log-normal distribution. Comparing these results with the TEM size distri-

bution, very good agreement is obtained for 14 . D . 60 nm. Due to its poor statistics,

the TEM size distribution is ill-deﬁned for D . 14 nm. As mentioned above, the CeO2

agglomerates were not separated, making it diﬃcult to identify the smaller crystallites

and contributing to the poorly deﬁned region for D . 14 nm. The TEM size distribution

given in Fig. 12(d), represents a preliminary set of data and further results are currently

being collated.

The correspondence between the Bayesian/MaxEnt size distributions and the TEM

distribution is very good for D

14 nm. The size distributions shown in Fig. 12(c)

≥

were ﬁtted with a log-normal distribution and the D0, σ0,

hDi parameters were
determined. These results are shown in Table 5. The ﬁtted distribution compared very

D
h

i

and σ2

closely with the solution distribution. The small uncertainties in the ﬁtted quantities of

Table 5 reﬂect the quality of the Bayesian/MaxEnt distributions. This can also be seen

in the low uncertainty in the variance, σ2

hDi, which is

8%.

∼

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

36

0

5

10

20

25

30

0

10

20
30
40
Diameter D (nm)

50

60

(a)

(c)

)
I
,

σ

,

m

,
g
α
(
r
P

0.20

0.15

0.10

|

0.05

0.00

)

D

(
P

0.08

0.06

0.04

0.02

0.00

15
α

111
200
220
400
422
511
531
m(D)

(b)

(d)

TEM Data
111
200
220
400
422
511
531

0.08

0.06

0.04

)

D

(
P

0.02

0.00

)

D

(
P

0.08

0.06

0.04

0.02

0.00

0

10

20
30
40
Diameter D (nm)

50

60

0

10

20

30
Diameter D (nm)

40

50

60

Figure 12: CeO2 Bayesian/MaxEnt crystallite-size distribution using a log-normal a priori model over D

[0, 60] nm. (a) Pr(α
|

I

g, m, σ,

) distribution, (17), used to average over the set of solutions

line. (b) Bayesian/MaxEnt crystallite-size distribution (solid line + error bars) and the a priori model (dashed

∈
, for the 200

P(α)
}

{

line) over D

[0, 60] nm. (c) CeO2 Bayesian/MaxEnt crystallite-size distributions for the non-overlapped line

proﬁles. (d) Comparison of TEM and Bayesian/MaxEnt size distributions. Due to diﬃculties in de-aggregating

the CeO2 particles and identifying smaller crystallites, the TEM size distribution is poorly deﬁned for D

14 nm.

≤

However, for D

14 nm, the comparison is excellent.

∈

≥

The average quantities given in Table 5 can be considered to represent the size dis-

tribution for the CeO2 specimen. Hence, the use of the fuzzy pixel/Bayesian/MaxEnt

methods has determined the specimen proﬁle, f , and enabled size eﬀects to be identiﬁed

as the major source of specimen broadening. The analysis of the line proﬁles has shown

that the crystallite shape is spherical, on average. The Fourier coeﬃcients of the specimen

proﬁles also show that the crystallites have a maximum size of

60 nm. This was subse-

∼

quently shown from the Bayesian/MaxEnt size distributions. Using this information, the

Bayesian/MaxEnt method successfully determined the CeO2 size distribution. While the

size distributions using a uniform a priori model broadly agree with the results from the

fuzzy pixel analysis, the uncertainty in the results is large; on using a log-normal a priori

model considerable improvements in the size distribution were obtained. The non-uniform

structure in the model has been transferred to the Bayesian/MaxEnt solution.

The TEM micrograph of the CeO2 specimen, shown in Fig. 13, conﬁrms the results

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

37

hkl

111

200

220

400

422

511

531

15.9

0.2

1.505

0.008

17.2

0.2

16.64

0.04

1.469

0.005

17.91

0.04

15.68

0.06

1.502

0.008

17.04

0.08

15.48

0.01

1.480

0.005

16.72

0.03

15.86

0.07

1.4799

0.0002

17.12

0.08

48.7

16.21

0.07

1.497

0.002

17.58

0.08

54.7

16.32

0.07

1.500

0.005

17.72

0.09

D
h
i
(nm)

±

±

±

±

±

±

±

±

σ2
hDi
(nm2)

54

51

52

46

56

52

2

1

2

1

1

3

±

±

±

±

±

±

±

±

0.5

0.6

D0

(nm)

±

±

±

±

±

±

±

±

σ0

±

±

±

±

±

±

±

±

Average

16.0

0.2

1.49

0.01

17.3

0.3

Table 5: Size distribution results using a log-normal a priori model in the Bayesian/MaxEnt method. The

Bayesian/MaxEnt size distributions given in Fig. 11(c) were ﬁtted with a log-normal size distribution and the

above parameters determined.

that have been determined from the x-ray diﬀraction data. From the micrograph, it

can be seen that the crystallites are near-spherical in shape.

It can also be seen that

the crystallites are in the range of size predicted by crystallite-size analysis. Considerable

overlapping of the crystallites, which complicates the task of gathering suﬃciently reliable

data for the TEM size distribution is evident.

7 Conclusion

The central aim of this study was to develop a single and self-contained method for

determining the crystallite-size distribution and shape from experimental line proﬁle data.

We have shown that the crystallite-size distribution can be determined without assuming

a functional form for the size distribution, determining instead the size distribution with

the least assumptions.

This was achieved by reviewing size broadening theory showing how the observed line

proﬁle can be expressed in terms of the instrument kernel, line proﬁle kernel and size

distribution.

It was also shown that the instrument and line proﬁle kernels could be

combined into a single kernel, hence enabling the simultaneous removal of instrumental

broadening while determining the size distribution (see

2).

§

The development of this method made use of two fundamental observations— that

distributions such as the specimen proﬁle and size distribution must be both positive

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

38

Figure 13: A TEM micrograph of the CeO2 specimen taken at a magniﬁcation of 200 k

. The crystallites

×

appear to have a spherical-like shape and size that are in the range predicted by the crystallite-size analysis

presented here.

and additive. Drawing on extensive theoretical developments, the entropy function was

selected as the function that can attribute values to the specimen line proﬁle and size dis-

tribution, while preserving the positivity and additivity of the proﬁle and distribution. It

can be also argued that the entropy function is the only function that produces consistent

results in the light of experimental data (see

3.2).

§
Using the mathematical and statistical foundations of Bayesian theory, the a pos-

teriori distributions of P (D) in terms of the experimental data, statistical noise and

scattering kernel can be determined. By maximizing this distribution, the most probable

size distribution can be calculated from the experimental line proﬁle, without making any

assumptions concerning the functional form of the size distribution. Determining the most

probable size distribution addresses the inherent non-uniqueness and ill-conditioning in

the integral equations arising from scattering and instrumental broadening. The general-

ity of this formalism enables any crystallite shape to be used and any number of principal

axes, D =

D1, D2, D3}
{

corresponding size distributions.

, of the crystallite shape can be included in determining the

Simulated data were used to test the fuzzy pixel and Bayesian/MaxEnt methods on

size-broadened line proﬁles. The reliability of these methods was established by showing

that they can reproduce the underlying parameters of the area- and volume-weighted

sizes, and the parameters of the size distributions.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

39

The application of these methods to CeO2 experimental data generally produced very

good results. The line proﬁle analysis applying fuzzy pixel/MaxEnt methods produced

reliable and consistent results over a wide range of low-, mid- and high-angle proﬁles.

The application of the Bayesian/MaxEnt method to the CeO2 data demonstrated

that this method can determine size distributions, while making the minimum number of

assumptions. The use of a uniform a priori model produced broadly consistent results

with the fuzzy pixel/MaxEnt method; however, the lack of information deﬁned in this

model was evident in the large uncertainties of the estimated quantities.

Using the fuzzy pixel/MaxEnt results as the log-normal a priori model demonstrated

that once ‘useful’ information is encoded in the model, improvements in the size distri-

butions and considerable reduction in the uncertainties can be achieved. Analysis of the

x-ray diﬀraction proﬁles using the log-normal model in the Bayesian/MaxEnt method re-

vealed that the crystallites are spherical in shape, with a size distribution corresponding

to the distribution in Fig. 12 and average quantities in Table 5. The comparison of these

Bayesian/MaxEnt results with TEM results is favorable, but it does reveal shortcom-

ings in the collected TEM data arising from particle aggregation. The TEM distribution

micrographs support the results from the line proﬁle analysis.

The use of simulated and experimental data demonstrates that the fuzzy pixel/Bayesian/

MaxEnt methods are fully quantitative in their ability to determine and attribute errors

to the solution line proﬁles and size distributions.

Although the results from the Bayesian/MaxEnt method are in good agreement and

address the limitations of the earlier work (see Armstrong & Kalceﬀ 1999, Armstrong

1999), several important issues have been raised and are the subject of further investi-

gation. These concern the accurate background estimation of the observed line proﬁle

and are very important; for example, the analysis of simulated data demonstrated how

systematic errors aﬀect the Fourier coeﬃcients. Recently, David & Sivia (2001) have de-

veloped a Bayesian technique for estimating the background, which can be adopted in this

method. Another problem encountered was in the estimation and quantifying of a non-

uniform a priori model. In this analysis we have used the information determined from

the fuzzy pixel/MaxEnt method; however, the issue of determining the a priori model

can also be addressed in a Bayesian context, by using a process of model selection (Sivia

et al. 1993, Loredo & Lamb 2001) and deﬁning an a posteriori distribution of parameters

in the model (Jarrell & Gubernatis 1996). Further, only single line proﬁles were analyzed

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

40

here; while the formalism has been expressed for overlapped line proﬁles, demonstrat-

ing that Bayesian/MaxEnt method is ﬂexible in its application, additional analysis of

overlapped line proﬁles is needed and this will be followed in future studies.

The literature has seen considerable debate over the type of distribution that best

describes the distribution of sizes (see Blackman et al. 1994, Krill & Birringer 1998, Kiss

et al. 1999, Langford et al. 2000). In the analysis presented here we have simply used a

log-normal distribution to demonstrate that the Bayesian/MaxEnt method can reproduce

the parameters. Moreover, the position we have taken in developing the Bayesian/MaxEnt

method is that we are not concerned with the type of distribution; rather, we have pro-

duced a reliable and consistent method that can determine the specimen proﬁle and/or

the size distribution, given our understanding of the experimental data, statistical noise

and instrumental eﬀects.

References

Sydney, Australia.

460.

Armstrong, N. (1999), Application of the maximum entropy method to x-ray proﬁle

analysis, PhD thesis, Department of Applied Physics, University of Technology,

Armstrong, N. & Kalceﬀ, W. (1998), ‘Eigen-system analysis of x-ray diﬀraction pro-

ﬁle deconvolution methods explains ill-conditioning’, J. Appl. Cryst. 31, 453–

Armstrong, N. & Kalceﬀ, W. (1999), ‘A maximum entropy method for determining

the column-length distributions from size-broadened X-ray diﬀraction proﬁles’,

J. Appl. Cryst. 32, 600–613.

Balzar, D. & Ledbetter, H. (1993), ‘Voigt-function modeling in Fourier analysis of

size- and strain-broadened x-ray diﬀraction peaks’, J. Appl. Cryst. 26, 97–103.

Blackman, J. A., Evans, B. L. & Maaroof, A. I. (1994), ‘Analysis of island-size

distributions in ultrathin metallic ﬁlms’, Phys. Rev. B 49(19), 13863–13871.

Bryan, R. K. (1990), ‘Maximum entropy analysis of oversampled data problems’,

Eur. Biophys. J. 18, 165–174.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

41

Cheary, R. W. & Cline, J. P. (1995), ‘An analysis of the eﬀect of diﬀerent instrumen-

tal conditions on the shapes of x-ray powder line proﬁles’, Adv. X-Ray Anal.

38, 75–82.

David, W. I. F. & Sivia, D. S. (2001), ‘Background estimation using a robust

Bayesian analysis’, J. Appl. Cryst. 34, 318–324.

de Keijser, T. H., Langford, J. I., Mittemeijer, E. J. & Vogels, A. B. P. (1982), ‘Use

of the Voigt function in a single-line method for the analysis of x-ray diﬀraction

line broadening’, J. Appl. Cryst. 15, 308–314.

de Keijser, T. H., Mittemeijer, E. J. & Rozendaal, C. F. (1983), ‘The determination

of crystallite-size and lattice-strain parameters in conjunction with the proﬁle-

reﬁnement method for the determination of crystal structures’, J. Appl. Cryst.

16, 309–316.

Goambo, F. & Gassiat, E. (1997), ‘Bayesian methods and maximum entropy for

ill-posed inverse problems’, Annals Stat. 25(1), 328–350.

Gull, S. F. (1989), Developments in maximum entropy data analysis, in J. Skilling,

ed., ‘Maximum Entopy and Bayesian Methods’, Kluwer Acad. Publ., Nether-

Gull, S. F. & Skilling, J. (1984), ‘Maximum entropy image reconstruction’, IEE

lands, pp. 53–71.

Proc. F131, 646–659.

Howard, S. A. & Preston, K. D. (1989), ‘Proﬁle ﬁtting of powder diﬀraction pat-

terns’, Rev. Min. 20, 217–275.

Howard, S. A. & Snyder, R. L. (1989), ‘The use of direct convolution products in

proﬁle and pattern ﬁtting algorithms. I. Development of the algorithms’, J.

Appl. Cryst. 22, 238–243.

Jarrell, M. & Gubernatis, J. E. (1996), ‘Bayesian inference and analytic continuation

of imaginary-time quantum Monte Carlo data’, Phys. Reports 269, 133–195.

Johnson, R. W. & Shore, J. E. (1983), ‘Comments on and correction to ”Axiomatic

derivation of the principle of maximum entropy and principle of minimum

cross-entropy”’, IEEE Trans. IT 26(6), 942–943.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

42

Kiss, L. B., S¨oderland, J., Niklasson, G. A. & Granqvist, C. G. (1999), ‘The real ori-

gin of lognormal size distributions of nanoparticles in vapor growth processes’,

NanoStruct. Mater. 12, 327–332.

Krill, C. E. & Birringer, R. (1998), ‘Estimating grain-size distribution in nanocrys-

talline material from x-ray diﬀraction proﬁle analysis’, Phil. Mag. A77(3), 621–

640.

Langford, J. I. (1992), ‘The use of the Voigt function in determining microstructural

properties from diﬀraction data by means of pattern decomposition’, NIST

Spec. Pub. 846, 110–126.

Langford, J. I., Lou¨er, D. & Scardi, P. (2000), ‘Eﬀect of a crystallite size distribution

on X-ray diﬀraction line proﬁles and whole-pattern ﬁtting’, J. Appl. Cryst.

33, 964–974.

Loredo, T. J. & Lamb, D. Q. (2001), Bayesian analysis of neutrinos observed from

supernova SN1987A. URL:http://xxx.lanl.gov/ps/astro-ph/0107260.

Lou¨er, D. & Audebrand, N. (2001), University of Rennes. For details see links at

www.iucr.org/iucr-top/comm/cpd/projects/index.html.

Shore, J. E. & Johnson, R. W. (1980), ‘Axiomatic derivation of the principle of

maximum entropy and principle of minimum cross-entropy’, IEEE Trans. IT

26(1), 26–37.

Oxford.

Sivia, D. S. (1996), Data Analysis: A Bayesian Tutorial, Oxford Science Pub.,

Sivia, D. S. (1999), Private communication.

Sivia, D. S., David, W. I. F., Knight, K. S. & Gull, S. F. (1993), ‘An introduction

to Bayesian model selection’, Physica D66, 234–242.

Skilling, J. (1989a), Classic maximum entropy, in J. Skilling, ed., ‘Maximum En-

tropy and Bayesian Methods’, Kluwer Acad. Publ., Netherlands, pp. 45–52.

Skilling, J. (1989b), The eigenvalues of mega-dimensional matrices, in J. Skilling,

ed., ‘Maximum Entropy and Bayesian Methods’, Kluwer Acad. Pub., Nether-

lands, pp. 455–566.

Armstrong et al. (2001). “Bayesian inference of nanoparticle-broadened x-ray line proﬁles”

43

Skilling, J. (1990), Quantiﬁed Maximum Entropy, in P. F. Foug´ere, ed., ‘Maximum

Entropy and Bayesian Methods’, Kluwer Acad. Pub., Netherlands, pp. 341–

350.

Skilling, J. & Bryan, R. K. (1984), ‘Maximum entropy image reconstruction: general

algorithm’, Mon. Not. R. astr. Soc. 211, 111–124.

Stokes, A. R. (1948), ‘A numerical Fourier analysis method for the correction of

width and shapes of the lines on x-ray powder photography’, Proc. Phys. Soc.

London A61, 382–391.

Stokes, A. R. & Wilson, A. J. C. (1942), ‘A method of calculating the integral

breadths of Debye-Scherrer lines’, Proc. Camb. Phil. Soc. 38, 313–322.

Tikochinsky, Y., Tishby, N. Z. & Levine, R. D. (1984), ‘Consistent inference of

probabilities for reproductive experiments’, Phys. Rev. Lett. 52(16), 1357–1360.

Ung´ar, T., Gubicza, J., Rib´arik, G. & Borb´ely, A. (2001), ‘Crystallite size dis-

tribution and dislocation structure determined by diﬀraction proﬁle analysis:

principles and practical application to cubic and hexagonal crystals’, J. Appl.

Cryst. 34, 298–310.

Ung´ar, T. & Tichy, G. (1999), ‘The eﬀect of dislocation contrast on x-ray line proﬁles

in untexturd polycrystals’, Phys. Stat. Sol. (a) 171, 425–434.

Warren, B. E. (1969), X-ray Diﬀraction, Addison-Wesley, Massachusetts.

Wilson, A. J. C. (1968), ‘On variance as a measure of line broadening in diﬀractom-

etry: Eﬀect of distribution of sizes on the apparent crystallite size’, J. Appl.

Wilson, A. J. C. (1971), ‘Some further considerations in particle-size broadening’,

Cryst. 1, 194–196.

J. Appl. Cryst. 4, 440–443.

Wu, E., Gray, E. M. A. & Kisi, E. H. (1998),

‘Modelling dislocation-induced

anistropic line broadening in Rietveld reﬁnements using a Voigt function. I:

General principles.’, J. Appl. Cryst. 31, 356–362.

Wu, N. (1997), The Maximum Entropy Method, Springer-Verlag, Berlin.

