4
0
0
2
 
n
a
J
 
1
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
6
0
0
1
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Dynamic Models and Nonlinear Filtering
of Wave Propagation in Random Fields

Gazillion Bits, Inc., San Jose, CA 95134, USA

Haiqing Wei

ABSTRACT

In this paper, a general model of wireless channels is established based on the physics of wave propagation. Then
the problems of inverse scattering and channel prediction are formulated as nonlinear ﬁltering problems. The
solutions to the nonlinear ﬁltering problems are given in the form of dynamic evolution equations of the estimated
quantities. Finally, examples are provided to illustrate the practical applications of the proposed theory.

Keywords: channel estimation and prediction, nonlinear ﬁltering, fast fading, random ﬁeld.

1. INTRODUCTION

In modern engineering, the problem of modeling wave propagation in a random ﬁeld of scattering objects and
of the associated signal processing, has become more and more important, with wide applications ranging from
wireless communications, to radar or sonar object detection, to medical imaging using microwave or infrared
light.
In all of the applications, the ﬁrst thing is obviously to understand and model the wave propagation
in random ﬁelds. In the object detection and imaging applications, the signal processing is usually an inverse
scattering problem, that is to ﬁnd out the conﬁguration and dynamics of the scattering objects in the random
ﬁeld, based on the data of received signals and the known transmitted signal. When applied to the ﬁeld of
wireless communications, for instance, channel estimation and prediction for dynamic power control or adaptive
modulation, the problem goes one step deeper and becomes ﬁltering and predicting the dynamics of the channel
response, given some observed data of the past channel response. A powerful model of wave propagation will be
established based upon the physics of wave scattering, by which the channel response may be computed explicitly
as a functional of the random ﬁeld of scattering objects. Then, it becomes natural to approach the problem of
estimating and predicting the channel response in two steps: solving the inverse scattering problem ﬁrst, then
calculating the channel response using the solved dynamics of the scattering objects.

Such a natural two-step approach seems to have been overlooked in the existing literature of communications.
In fact, the traditional approaches try to avoid the inverse scattering problem. They often start directly from
some presumed stochastic models of the channel response, without looking into the actual random ﬁeld of
scattering objects at all. In the Rayleigh fading model that has been widely used since the early days of wireless
communications,1 the physical scattering environment is absent from the consideration, while the received signal
is assumed to be a sum of many diﬀerently delayed and weighted versions of the transmitted signal, where the
weighting coeﬃcients are complex Gaussian and independent, the delay times modulo 1/fc are also independent
and uniformly distributed in [0, 1/fc), with fc being the center frequency of the carrier.2 When there is one
strong, dominating component, e.g. from line-of-sight propagation, the Rayleigh model is slightly modiﬁed into
the Ricean fading model. Both models are based on the assumption of a large number of scattering objects,
which may not always be the case. In case an adaptive mechanism is employed to control the transmitter power
or vary the transmission bit rate, the channel estimation and prediction circuit has to be very fast to follow the
dynamics of the channel response.3 The previous channel models have become inadequate in millimeter wave
mobile communications, where the channel is fast-fading, namely, the bit duration is short comparing to the
dynamics of channel response.4 In fact, the inadequacy of the old models may be held responsible for a general
opinion among many wireless engineers that in many fast-fading systems, it might be impossible to estimate the
channel state information (CSI) so to adapt the system accordingly.5 Such a pessimistic view has even inspired a
lot of work concerning the capacity and coding schemes of future high speed and fast-fading wireless channels.5, 6
A generally used estimation of the fading speed is based upon the assumption that the signal fading experienced
by two receivers become uncorrelated when the separation between the receivers is signiﬁcantly larger than the

1

carrier wavelength.7 However, in the Rayleigh or Ricean model, the signal fading is governed by a Gaussian law
of distribution, which implies the equivalence between uncorrelation and independence. So even in principle, the
signal fading seen in one region does not contain any information for the signal fading in another region just a
few wavelengths away. This imposes a serious limitation upon the estimation of CSI. For instance, consider a
wireless link with the carrier frequency around 1.9 GHz, so the wavelength is about 0.158 meter. It takes merely
8 milliseconds for a mobile with speed 20 m/s to travel through one wavelength. It seems, according to the
Rayleigh and Ricean models, that an estimator for the CSI has to accomplish its task well within a millisecond,
and the obtained CSI can be regarded as reliable for no longer than 8 milliseconds.

We think that the above limit on the CSI estimation of a fast-fading channel is over pessimistic. Our point
of view is that for any wireless link in a given physical environment, the channel response is the result of the
superposition of waves propagating via multiple paths, where each signal path is a geometric route that starts
from the transmitter, possibly hits one or more scattering objects, and ﬁnally reaches the transmitter. The
physical environment that contains the scattering objects is called a scattering environment. The response of a
wireless channel is actually deterministic, conditioned upon the scattering environment and the locations of the
transmitter and receiver inside the scattering environment. The randomness of wireless channels arises only from
the variety of scattering environments. In a wireless channel model based on the physics of wave propagation in a
scattering environment, a natural choice for the “channel state” would be the state of the scattering environment,
namely the positions and velocities of the scattering objects as well as their physical eﬀects on the wave. So the
estimation of CSI boils down to estimating the positions, velocities, and attenuation coeﬃcients of the scattering
objects. Such channel state should remain largely time-invariant over a much longer time period. As an example,
consider a scattering environment in which the distance among the scattering objects, the transmitter, and the
receiver is at least several tens of meters, so that the mobile receiver or transmitter experiences the same scattering
environment even after it travels over 10 meters. With the 20 m/s mobile speed, it takes 0.5 second to cover
that distance, which is more than 60 wavelengths for a carrier frequency around 1.9 GHz.

There have been previous works adopting a deterministic model of signal fading,8–10 but in most of them
the eﬀect of the scattering environment is represented by a superposition of plane waves in proximity to the
receiver, whose interference pattern is sampled by the receiver. This representation only works for a frequency-
nonselective channel,2 where the frequency bandwidth of the signal is too narrow to resolve the delay times
of diﬀerent paths. When the signal bandwidth is suﬃciently large to resolve the path delays, the plane wave
representation breaks down, a more advanced model that captures both the direction of arrivals and the path
delays is necessary. Moreover, the previous works8–10 estimate the CSI using various spectral estimation tech-
niques, which do not guarantee the optimality of the solutions. In this paper, we shall ﬁrst establish a complete
model of wireless channels based on the physics of wave propagation. Then the problems of inverse scattering and
channel prediction are formulated as nonlinear ﬁltering problems. The solution to the nonlinear ﬁltering problem
will be given in the form of a dynamic evolution equation (the ﬁltering equation) for the estimated quantities,
just like the Kalman ﬁltering equation for the linear ﬁltering problem.11
In most practical applications, the
ﬁlter equation may be implemented, or at least be approximated, by a state-possessing machine driven by an
innovation input. In our particular applications, it happens that both the state of the scattering environment
and the observation process are governed by linear diﬀerential equations. Note that even though the system
equations are linear, the Kalman ﬁlter may still be sub-optimal, unless the initial probability law of the system
state is Gaussian. It is proven mathematically that the nonlinear ﬁlter produces the optimal estimation for the
interested quantity. Even the nonlinear ﬁlter may not be easily implemented in practice, its solution provides a
benchmark for evaluating the performance of other sub-optimal estimators. The theory of nonlinear ﬁltering has
been well established, many textbooks exist, covering its fundamental principles and applications, especially to
the ﬁeld of control engineering,12–14 however it has not made much appearance in the ﬁeld of communication
engineering. Apart from an attempt to solve the channel prediction problem for fast-fading wireless channels,
the present paper is intended to introduce the nonlinear ﬁltering theory as a powerful tool for signal processing
and system optimization in the ﬁeld of communication engineering.

2. RANDOM SCATTERING FIELDS AND WAVE PROPAGATION THEREIN

Throughout the present paper, a suﬃciently large probability space (Ω, F , P ) is assumed in which all random
variables under consideration are deﬁned. In the wave-involved applications mentioned in the beginning of the

2

introduction, there is often a random scattering ﬁeld (RSF) consisting of scattering objects, due to which the
signal wave from a transmitter to a receiver undergoes multiple scattering and propagates along various geometric
paths associated with diﬀerent power losses, diﬀerent time delays and direction of arrivals, as pictured in Fig.1.
The spatial domain E ⊆ IRq accommodating the scattering objects together with the signal transmitter and the
receiver is called the scattering environment, where q ∈ IN is the dimension of the space under consideration,
usually q = 2 or 3. In general, an RSF, denoted by S(t; r, v), may contain spatially extensive scattering objects,
which could be continuously distributed in the real space and the velocity space, namely the conﬁguration space.
Fig.1 only shows a special RSF with discrete scattering objects, which may be the most adopted model.15, 16 A
discrete RSF is often modeled by a compound point process17, 18 in the conﬁguration space E × IRq,

S(t; r, v) =

Skδ(r − rk)δ(v − vk),

(1)

N (t)

k=3
X

where r = (r1, · · · , rq)′ ∈ E and v = (v1, · · · , vq)′ ∈ IRq denote∗ the position and the velocity respectively, and
hence {(rk, vk)}N (t)
k=3 are conﬁguration coordinates for the scattering objects, which are the realization points of
a space-time point process in [0, ∞) × E × IRq. Here N (t) is the total number of points occurred up to time t
anywhere in E ×IRq. The scattering objects are indexed by the integers k ≥ 3, the indices k = 1, 2 are reserved for
the transmitter and the receiver respectively. For each k ≥ 3, Sk is a complex-valued random variable associated
with the kth realization point, which represents the scattering response of the corresponding scattering object
to the signal. Although the discrete RSF model is chosen here to simplify the discussion, it should be pointed
out that, a more general RSF model might, and should be used when necessary, for example, when describing a
scattering environment with continuously distributed scattering objects. In fact, all mathematical formulae with
S(t; r, v) involved in the present paper are formulated in such general forms that they hold for any D′(E × IRq)-
valued process S(t; r, v), where D′(E × IRq) denotes the Hilbert space of the complex-valued, linear functionals
of functions in E × IRq, which are usually called distributions or generalized functions.19, 20

T

 

R

Figure 1. A typical random scattering ﬁeld, in which the signal wave propagates from a transmitter to a receiver along
various geometric paths as a result of the interaction with the scattering objects.

The RSF imprints itself on the channel response between a wave transmitter and a signal receiver, all of
which lie in the scattering environment E. In general, both the transmitter and the receiver could be extensive
in space, as being the case when antenna arrays are employed. Therefore we use x(t; r1, v1) and y(t; r2, v2) to
denote the spatially extensive signal amplitudes of the transmitter and the receiver respectively, both of which
are complex-valued and square integrable in the Lebesgue sense, namely, x, y ∈ L2([0, ∞) × E × IRq, C), where
C is the set of complex numbers. Recalling the theory of wave scattering which says that the otherwise freely

∗In this paper, A′ denotes the transpose of A, for any vector or matrix A.

S k

3

propagating signal wave from a source is perturbed by the scattering objects, and the actual wave in space is the
superposition of the free-running wave and all of the scattered waves. The Huygens-Fresnel principle21, 22 further
states that the scattered wave from each scattering object, often called the second wave, is again a free-running
wave coming out of the object, with an amplitude proportional to that of the incident wave, and the proportional
coeﬃcient is called the scattering response of the object. In general, it is rather complicated to calculate the
actual wave in an exact manner, which involves the solution of an integral equation or a series expansion using
the Feynman diagram.23, 24 The complication has to do with the multiple scattering eﬀects. However, when
the scattering objects are sparsely distributed in space, their eﬀect on the signal wave may be easily calculated
using the perturbation theory. In particular, the ﬁrst-order perturbation theory approximates the actual wave by
superposing the free-running wave and the second waves excited by it at the scattering objects. For an obvious
reason, the ﬁrst-order perturbation is also called the single-bounce approximation. When considering only the
contribution of the second waves, the single-bounce approximation results in an input-output relation of the
spatially extensive signals x(t; r1, v1) and y(t; r2, v2) in their low-pass equivalent form,2

N (t)

k=3 ZE×IRq
X

y(t; r2, v2) =

x(t − τ1k − τk2; r1, v1)l(cτ1k)Skl(cτk2) exp(i2πγ1k2t)dr1dv1,

(2)

where τ1k and τk2 are the time delays associated with the signal propagation from the transmitter to the kth
object and from the kth object to the receiver respectively, which satisfy the following equations,

τ1k =

|r1 − rk(t − τk2)|
c

, τk2 =

|rk(t − τk2) − r2|
c

, ∀ k ≥ 3.

Also in the above equations, c is the speed of the wave, l(cτ ) is the propagation loss that depends only on the
propagation distance cτ , and

γ1k2

def=

f0[v1 − vk(t − τk2)] · [r1 − rk(t − τk2)]
c|r1 − rk(t − τk2)|

+

f0[vk(t − τk2) − v2] · [rk(t − τk2) − r2]
c|rk(t − τk2) − r2|

,

is the Doppler frequency shift experienced by the signal with the central carrier frequency f0. Note that the time
delays {τk2}k≥3 are implicitly deﬁned in equation (3), although an explicit formula may be derived when the
kinetic motions of the scattering objects are given explicitly. For example, if the velocity diﬀerence vk(t) − vk(t −
τk2) is neglected for all k ≥ 3, that is to ignore the velocity variation during the time of the wave propagating
from the scattering object to the receiver, then the following equation holds,

which is easily solved to give an explicit formula,

cτk2 = |rk(t) − vk(t)τk2 − r2|, ∀ k ≥ 3,

τk2 =

p

[c2 − |vk(t)|2]|rk(t) − r2|2 + {[rk(t) − r2] · vk(t)}2 − [rk(t) − r2] · vk(t)
c2 − |vk(t)|2

, ∀ k ≥ 3.

(6)

Then the time delays {τ1k}k≥3 are explicitly computed using equations (3) and (6). Similarly, equation (4) could
be simpliﬁed if all {vk}k≥3 are treated as constants during the interval [t − τk2, t],

γ1k2

def=

f0[v1 − vk(t)] · [r1 − rk(t) + vk(t)τk2]
c|r1 − rk(t) + vk(t)τk2|

+

f0[vk(t) − v2] · [rk(t) − vk(t)τk2 − r2]
c|rk(t) − vk(t)τk2 − r2|

, ∀ k ≥ 3.

(7)

Neglecting the object velocity variation during the time of wave propagation is often an excellent approximation
to make, especially when dealing with electromagnetic waves, which travel at the ultimate speed in nature,
c = 3.0 × 108 m/s. Even for ten kilometers of propagation distance, the time delay is merely 1/30 millisecond,
during which no macroscopic scattering object can change its speed for much. Furthermore, the highest speed
of most macroscopic objects is no more than a millionth of the light speed. Consequently, equation (6) may be
simpliﬁed,

(3)

(4)

(5)

(8)

τk2 =

|rk(t) − r2|
c

−

[rk(t) − r2] · vk(t)
c2

, ∀ k ≥ 3,

4

by neglecting terms of the second or higher powers of vk(t)/c, ∀ k ≥ 3. Or even simpler, while still an extremely
good approximation for the propagation of electromagnetic wave, the time delays may be calculated as,

τ1k =

|r1 − rk(t)|
c

, τk2 =

|rk(t) − r2|
c

, ∀ k ≥ 3.

To write the input-output relation in a more compact form, we deﬁne

τ2(r, v; r2)

def
=

p

(c2 − |v|2)|r − r2|2 + [(r − r2) · v]2 − (r − r2) · v
c2 − |v|2

, ∀ k ≥ 3,

τ1(r1; r, v; r2) def=

|r1 − r + vτ2(r, v; r2)|
c

, ∀ k ≥ 3,

γ(r1, v1; r, v; r2, v2) def=

f0(v1 − v) · [r1 − r + vτ2(r, v; r2)]
c|r1 − r + vτ2(r, v; r2)|

+

f0(v − v2) · [r − vτ2(r, v; r2) − r2]
c|r − vτ2(r, v; r2) − r2|

,

L(r1, v1; r, v; r2, v2) def= l[cτ1(r1; r, v; r2)]l[cτ2(r, v; r2)] exp[i2πγ(r1, v1; r, v; r2, v2)],

then we use equation (1), together with equations (6), and (7) to rewrite equation (2) as,

y(t; r2, v2) =

x[t − τ1(r1; r, v; r2) − τ2(r, v; r2); r1, v1]

Z(E×IRq)2

× L(r1, v1; r, v; r2, v2)S[t − τ2(r, v; r2); r, v]dr1dv1drdv.

(14)

This equation shall serve as the fundamental input-output relation describing the propagation of spatially exten-
sive signals in an RSF, up to the single-bounce approximation. It is evident that the received signal y(t; r2, v2)
is a bilinear functional of x(t; r1, v1) and S(t; r, v), for any ﬁxed (t; r2, v2). More speciﬁcally, y(t; r2, v2) is a
linear functional of x(t; r1, v1), if L(r1, v1; r, v; r2, v2)S(t; r, v) is regarded as an integration kernel; or y(t; r2, v2)
could be viewed as a linear functional of S(t; r, v), with x(t; r1, v1)L(r1, v1; r, v; r2, v2) serving as an integration
kernel.

3. THE DYNAMICS OF RSF

Let us consider the case in which the set of scattering objects is ﬁxed in time and the scattering response of each
object is time-independent. Nevertheless, the RSF is still time-varying when the objects are subject to kinetic
motion. We shall employ an RSF model so general that the scattering objects are subject to accelerations
that depend upon the position. Speciﬁcally, the motion of the kth scattering object, k ≥ 3, is described by a
diﬀerential equation,

where f (r) is an IRq-valued function representing the deterministic acceleration exerted upon the scattering
objects. Since the total number of scattering objects within the environment E is assumed to be ﬁxed in time,
it is a random variable N = N (ω). As mentioned before, all random variables and processes are deﬁned on the
“grand” probability space (Ω, F , P ). Let

S(t; r, v) def=

Skδ(r − rk)δ(v − vk),

then S(t; r, v) is a space-time compound point process17, 18 in the space [0, ∞) × E × IRq. Let U denotes the
Hilbert space of all generalized functions in E × IRq, namely U def= D′(E × IRq), then S(t; r, v) may also be viewed
as a U -valued random process indexed by t ∈ [0, ∞). Next we attempt to derive a partial diﬀerential equation
for S(t; r, v) using equations (15), (16) and (17).

drk = vkdt,
dvk = f (rk)dt,

N

k=3
X

5

(9)

(10)

(11)

(12)

(13)

(15)
(16)

(17)

While explicitly parameterized by r and v, the RSF S(t; r, v) of equation (17) is implicitly a function of the
k=3, described by the diﬀerential equations (15) and (16). By diﬀerentiating equation (17),

processes {(rk, vk)}N
it is obtained that,

dS(t; r, v) =

Skδ(v − vk)dδ(r − rk) +

Skδ(r − rk)dδ(v − vk)

=

Skδ(v − vk)

k
X
vkdt +

∂δ(r − rk)
∂rk

Skδ(r − rk)

∂δ(v − vk)
∂vk

f (rk)dt

= −

Skδ(v − vk)

vkdt −

Skδ(r − rk)

k
X

k
X

∂δ(r − rk)
∂r

∂δ(r − rk)
∂r

∂δ(v − vk)
∂v

f (rk)dt

∂δ(v − vk)
∂v

f (r)dt,

k
X

k
X

k
X

= −

Skδ(v − vk)

vdt −

Skδ(r − rk)

k
k
X
X
for all k ≥ 3, where in the last step, two identities have been used,

δ(v − vk)vk ≡ δ(v − vk)v, ∀ k ≥ 3,
δ(r − rk)f (rk) ≡ δ(r − rk)f (r), ∀ k ≥ 3.

The partial diﬀerential operator ∂/∂r is deﬁned as a row vector,

and the operator ∂/∂v is similarly deﬁned. Note that f (r) is valued as a q-dimensional column vector. When a
row vector is followed by a column vector, it is understood that the scalar product in the space IRq takes place.
Noticing two more identities,

∂
∂r

def=

∂
∂r1

(cid:20)

, · · · ,

∂
∂rq (cid:21)

,

∂S(t; r, v)
∂r

∂S(t; r, v)
∂v

=

=

Skδ(v − vk)

Skδ(r − rk)

∂δ(r − rk)
∂r

∂δ(v − vk)
∂v

,

,

k
X

k
X

dS(t; r, v) = −

∂S(t; r, v)
∂r

vdt −

∂S(t; r, v)
∂v

f (r)dt.

one may easily simplify equation (18) into a partial diﬀerential equation governing the RSF,

Deﬁne a linear operator A : U → U , such that for any ξ ∈ U ,

then equation (24), together with a proper initial condition, is immediately recognized as an inﬁnite dimensional
linear system25, 26 in the Hilbert space U ,

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

(26)

(27)

where S0 is an (F , B(U ))-measurable random variable, B(U ) is a Borel σ-algebra of subsets of U . It is to be
stressed again that the dynamic equations (26) and (27) are applicable to any RSF S(t) ∈ U = D′(E × IRq),
although the derivation of the equations is exempliﬁed by the special case of discrete RSF for simplicity.

Aξ(r, v) def= −

v −

f (r),

∂ξ
∂r

∂ξ
∂v

dS(t) = AS(t)dt,
S(0) = S0,

6

4. SIGNAL DETECTION

As discussed in section 2, when a spatially extensive signal x(t; r1, v1) is transmitted, a spatially extensive receiver
will catch a signal y(t; r2, v2), which may be degraded by a white Gaussian noise. Let

Y (t; r2, v2)

def
=

y(s; r2, v2)ds + Z(t; r2, v2),

(28)

t

0
Z

where Z(t; r2, v2) is an H-valued Wiener process representing the observation noise, with H def= L2(E × IRq), that
is, the space of square Lebesgue integrable functions in E × IRq. It is also assumed that the covariance operator
of Z(t), denoted by R, is uniformly positive deﬁnite. Using equation (14), with the simpliﬁed calculation of delay
times in (9), we can write,

dY (t; r2, v2) =

x

t −

|r1 − r| + |r − r2|
c

; r1, v1

L(r1, v1; r, v; r2, v2)

(cid:19)

"Z(E×IRq)2

(cid:18)
|r − r2|
c

× S

t −

; r, v

dr1dv1drdv

dt + dZ(t; r2, v2),

Y (0) = 0,

(cid:18)

(cid:19)

(cid:21)

(29)

(30)

which is the signal detection equation, or called the observation equation. With the observation data {Y (s)}0≤s<t,
two estimation problems emerge, depending upon the actual application goal:

1) estimating and predicting S(t), when {x(s)}0≤s≤t is known;

2) estimating x(t), when {S(t)}0≤s≤t is known.

The ﬁrst problem is related to various applications of inverse scattering, such as radar object detection, channel
estimation and prediction for wireless communications; while the second problem is speciﬁc to signal detection,
especially to the optimal design of a receiver in communications. In the present paper, we are interested in the
ﬁrst estimation problem, in which the signal x(t; r1, v1) is regarded as a known quantity. Deﬁne a time-dependent
linear operator G(t) : U → H, such that for any time-varying function ξ(t) ∈ U , ∀ t ≥ 0,

G(t)ξ(t)(r2, v2) def=

x

t −

|r1 − r| + |r − r2|
c

Z(E×IRq)2

(cid:18)

(cid:19)

; r1, v1

L(r1, v1; r, v; r2, v2)ξ

t −

; r, v

dr1dv1drdv, (31)

|r − r2|
c

(cid:18)

(cid:19)

then the observation equations (29) and (30) are of the form,

dY (t) = G(t)S(t)dt + dZ(t),
Y (0) = 0,

where Y (t) and Z(t) are H-valued random processes, with H = L2(E × IRq), while G(t) is a time-dependent
linear operator in LHS(U, H), with the time-dependence originated from the known and time-varying signal x(t),
LHS(U, H) being the space of all Hilbert-Schmidt operators from U to H.

The system equations (26), (27) and the observation equations (32), (33) constitute a nonlinear ﬁltering

problem, that is to compute the conditional probability,

Π(t)(ψ(t)) def= E[ψ(t, S(t))|Y (s), 0 ≤ s ≤ t],

b

where ψ(t, ξ) ∈ C1,2
([0, ∞) × U ) is a given test function, which is bounded and has continuous ﬁrst and second
order Fr´echet derivatives with respect to t and ξ respectively. The essence of the nonlinear ﬁltering problem is
to obtain the optimal estimation of the interested quantity ψ(t, S(t)), based on the observation data up to time
t, {Y (s)}0≤s≤t. In most practical applications, it is suﬃcient to obtain a dynamic evolution equation for the

(32)
(33)

(34)

7

estimated ψ(t, S(t)), usually in the form a diﬀerential equation driven by the observation data, which can be
implemented, or simulated, by a state-possessing machine or circuit. Accordingly, a dynamic evolution equation
for the estimated quantity may be regarded as a solution to the nonlinear ﬁltering problem. Thanks to the greatly
advanced theories of nonlinear ﬁltering and of ﬁnite and inﬁnite dimensional systems, such dynamic evolution
equations have been well established as solutions to the nonlinear ﬁltering problems.

5. CHANNEL ESTIMATION AND PREDICTION
For the general theory of nonlinear ﬁltering, the readers are referred to the excellent textbooks12–14 and references
therein, especially the original papers. Here we shall formulate the problem in a less general form, but to suit
our applications better. We are interested in an inverse scattering problem, which is recast as, given,

to compute,

S(0) = S0,
dS(t) = AS(t)dt,
dY (t) = G(t)S(t)dt + dZ(t), Y (0) = 0,

Π(t)(ψ(t)) = E[ψ(t, S(t))|Y (s), 0 ≤ s ≤ t],

where Z(t) is an H-valued Wiener process, with covariance operator R, which is uniformly positive deﬁnite. S0
is an (F , B(U ))-measurable random variable with probability measure Π0. Z(t) and S0 are independent. The
operators A and G(t) are deﬁned in (25) and (31) respectively. Although we have successfully formulated the
general inverse scattering problem as a nonlinear ﬁltering problem for an inﬁnite dimensional linear system, we
shall not present the general solution to the problem, in order to limit the scope and length of the discussion.
The general solution involves much elaborate notations and concepts in functional analysis, as well as somewhat
tedious arguments of convergence, which does not seem to ﬁt the purpose of the present paper.
Interested
readers, however, are referred to the literature.27, 28

What we shall focus here, is a special case of discrete RSF with the accelerations of the scattering objects
being neglected, namely, all objects are moving with constant velocities. The goal of inverse scattering is to
ﬁnd out the initial position rk and velocity vk, as well as the attenuation coeﬃcient Sk to the wave, for each
scattering object k, 3 ≤ k ≤ N , based upon the received signal {Y (s)}0≤s≤t and the known transmitted
signal {x(s)}0≤s≤t. However, the total number of scattering objects N is usually random, and to pin down
the conﬁguration coordinates {(rk, vk)}N
k=2 from scratch is highly diﬃcult. A more practical approach is to
discretize the initial conﬁguration space into small regions and label each of them by an integer n, 1 ≤ n ≤ M ,
then to assign a complex-valued random variable Sn as the scattering response to the center of the nth region,
which is coordinated by (rn, vn). The idea is, when the initial conﬁguration space is divided into suﬃciently
small regions, the scattering objects within any region n, 1 ≤ n ≤ M , become non-resolvable, their scattering
responses superposed together is represented by a single scattering point sitting at the center of the region with
a scattering response Sn. The result of the discretization is to remove the coordinates of the scattering objects
in the initial conﬁguration space from the set of the unknowns, but to let the complex random variables {Sn}M
n=1
bear all the information about the scattering environment. The probability law of {Sn}M
n=1 may be obtained
from some experimental data, or calculated from an empirical model of the distribution of scattering objects in
an actual geographical environment.15, 16 For instance, if the distribution of objects is quite sparce in an area,
then the probability of Sn = 0 is high, for any 1 ≤ n ≤ M . Let

then S is a random variable in CM , whose probability law is known and denoted by Π0 just as before. Since the
scattering response of each object is assumed time-invariant, the RSF S(t), now CM -valued, is time-independent,

(35)
(36)

(37)

(38)

(39)

The transmitter and receiver are also discrete in the conﬁguration space, which consist I and J antenna elements
located at {(r1i, v1i)}I
j=1 respectively. As a consequence, the transmitted signal x(t) is a

i=1 and {(r2j, v2j)}J

S def= (S1, S2, · · · , SM )′,

dS(t) = 0, S(0) = S.

8

CI -valued signal, while the Wiener noise Z(t) at the receiver and the received signal Y (t) are CJ -valued random
processes,

x(t)

Y (t)

Z(t)

def= (x1(t), x2(t), · · · , xI (t))′,
def= (Y1(t), Y2(t), · · · , YJ (t))′,
def= (Z1(t), Z2(t), · · · , ZJ (t))′.

Again let R(t) denote the covariance matrix of the Wiener process Z(t), which is uniformly positive deﬁnite.
Deﬁne a J × M matrix G(t) = {gjn(t)}1≤j≤J,1≤n≤M , such that,

I

gjn(t) def=

x

t −

|r1i − rn| + |rn − r2j|
c

i=1
X

(cid:18)

(cid:19)

; r1i, v1i

L(r1i, v1i; rn, vn; r2j, v2j), ∀ 1 ≤ j ≤ J, ∀ 1 ≤ n ≤ M,

(43)

where the function L is deﬁned in (13), then the discrete version of the observation equation (29) is formulated
as,

dY (t) = G(t)Sdt + dZ(t), Y (0) = 0.

With the trivial system equation (39) and the simple observation equation (44), the inverse scattering problem

is to compute,

Π(t)(ψ(t)) = E[ψ(t, S(t))|Y (s), 0 ≤ s ≤ t] = E[ψ(t, S)|Y (s), 0 ≤ s ≤ t],
where ψ(t, ξ) ∈ C1,2
([0, ∞) × CM , C) is a given test function, which is bounded and has continuous ﬁrst and
second order derivatives with respect to t and ξ respectively. For the convenience in presenting the following
ﬁltering equations, let B : [0, ∞) × CM → CJ be a function such that,

(45)

b

B(t, ξ)
B′(t, ξ)

def= G(t)ξ, ∀ t ≥ 0, ∀ ξ ∈ CM ,
def= ξ′G′(t), ∀ t ≥ 0, ∀ ξ ∈ CM .

It is a trivial matter to verify the conditions in order to apply the Kushner-Stratonovitch equation,12, 13

dΠ(t)(ψ(t)) = Π(t)

dt + [Π(t)(B′(t)ψ(t)) − Π(t)(ψ(t))Π(t)(B′(t))]

× R−1(t)[dY (t) − Π(t)(B(t))dt], almost surely, ∀ t > 0,

Π(0)(ψ(0)) = Π0(ψ(0)) =

ψ(0, ξ)dΠ0(ξ).

∂ψ
∂t

(cid:18)

(cid:19)

ZCM

Another well known solution to the nonlinear ﬁltering problem is the Zakai equation,12, 13 which governs the
so-called unnormalized conditional probability p(t)(ψ(t)),

dp(t)(ψ(t)) = p(t)

dt + p(t)(B′(t)ψ(t))R−1(t)dY (t), almost surely, ∀ t > 0,

∂ψ
∂t

(cid:19)
p(0)(ψ(0)) = Π0(ψ(0)) =

(cid:18)

ψ(0, ξ)dΠ0(ξ).

ZCM
The relation between p(t) and Π(t) is given by,

Π(t)(ψ) =

, ∀ test function ψ,

p(t)(ψ)
p(t)(1)

where p(t)(1) satisﬁes,

dp(t)(1) = p(t)(B′(t))R−1(t)dY (t), almost surely, ∀ t > 0,
p(0)(1) = 1.

9

(40)

(41)

(42)

(44)

(46)

(47)

(48)

(49)

(50)

(51)

(52)

(53)

(54)

As a simpler example, consider a ﬂat-fading channel from a single transmitter element to a single receiver
element, where the frequency bandwidth of the channel is suﬃciently narrow that the time delays among the
signal paths are insigniﬁcant, however, the channel response experiences a fast oscillation due to the motion of the
receiver, or the transmitter, or the scattering objects. The goal is to estimate the channel state and to predict
the channel response, based on the known transmitted signal and the data of received signal. This problem
has been tackled before with the help of various spectral estimation techniques,8–10 which do not guarantee
the optimality of the solutions. It is therefore of great interest to formulate the problem using the language of
nonlinear ﬁltering, and to see what kind of optimal solution may be obtained. The observation equation, namely,
the channel input-output relation, has a very simple low-pass equivalent form,2

dY (t) = x(t)h(t)dt + dZ(t), Y (0) = 0,

(55)

where x(t) and Y (t) are the transmitted signal and the integrated version of the received signal respectively,
and h(t) is the time-varying channel response, all C-valued, while Z(t) is a C-valued Wiener process with a
uniformly positive deﬁnite covariance function R(t). The channel response h(t) is a superposition of many
Doppler components,

K

h(t) =

ak exp(i2πfkt), − fmax ≤ f1 < f2 < · · · < fK ≤ fmax,

(56)

k=1
X
where fmax is the maximum Doppler frequency shift, and {fk}K
k=1 constitutes a partition of the frequency band
[−fmax, fmax], and ak ∈ C is the constant amplitude of the kth Doppler component, 1 ≤ k ≤ K. It is assumed
that the partition {fk}K
k=1 is suﬃciently ﬁne to justify the discrete approximation to the Doppler shifts. Deﬁne
a function F : [0, ∞) × CK → C, such that,

F (t, ξ) def= x(t)

exp(i2πfkt)ξk, ∀ ξ = (ξ1, ξ2, · · · , ξK)′ ∈ CK.

K

k=1
X

The nonlinear ﬁltering problem for channel estimation and prediction is formulated as, given,

a def= (a1, a2, · · · , aK)′ ∈ CK, with probability law Π0,
dY (t) = F (t, a)dt + dZ(t), Y (0) = 0,

to compute,

where ψ ∈ C1,2
equation,

b

(60)
([0, ∞) × CK, C) is a test function. Again, the solution is given by the Kushner-Stratonovitch

Π(t)(ψ(t)) = E[ψ(t, a)|Y (s), 0 ≤ s ≤ t],

dΠ(t)(ψ(t)) = Π(t)

dt + [Π(t)(F (t)ψ(t)) − Π(t)(ψ(t))Π(t)(F (t))]

× R−1(t)[dY (t) − Π(t)(F (t))dt], almost surely, ∀ t > 0,

Π(0)(ψ(0)) = Π0(ψ(0)) =

ψ(0, ξ)dΠ0(ξ),

∂ψ
∂t

(cid:18)

(cid:19)

ZCK

or by the Zakai equation,

dp(t)(ψ(t)) = p(t)

dt + p(t)(F (t)ψ(t))R−1(t)dY (t), almost surely, ∀ t > 0,

∂ψ
∂t

(cid:19)
p(0)(ψ(0)) = Π0(ψ(0)) =

(cid:18)

ψ(0, ξ)dΠ0(ξ),

ZCK
then the probability Π(t)(ψ(t)) is calculated as,

(57)

(58)
(59)

(61)

(62)

(63)

(64)

(65)

Π(t)(ψ(t)) =

p(t)(ψ(t))
p(t)(1)

.

10

6. CONCLUSION

It has been argued that the input-output response of a wireless channel in a given scattering environment is
actually deterministic in nature, conditioned on the positions and velocities of the scattering objects, as well
as the locations and velocities of the transmitter and receiver in the environment. Using a physical model of
wave propagation, the channel response is calculated explicitly as a functional of the random scattering ﬁeld.
Consequently, the best choice of the channel state information for wireless channels may be the state of the
random scattering ﬁeld, which can remain unchanged for a suﬃciently long time, even for the “fast-fading
channels” in the conventional sense. As far as the problem of channel estimation and prediction is concerned,
there seems to be no fundamental limit imposed by the physics of wave scattering, no matter how short is the
carrier wavelength and how fast the mobiles move as long as the inter-object separation is much larger than the
distance that any mobile can travel within the time duration of interest. Only practical limits may rise from the
speed and complexity of the actual signal processing circuits. The problems of inverse scattering, formulated as
nonlinear ﬁltering problems, are solved in terms of dynamical evolution equations for the estimated quantities.
However, the ﬁltering equations cannot be implemented with little diﬃculty using today’s signal processing
circuits. Both better numerical algorithms and more advanced electronics are desired, in order to take fully the
advantage of the nonlinear ﬁlters in practical applications.

REFERENCES

1. W. C. Jakes Jr. (editor), Microwave Mobile Communications. New York: John Wiley & Sons, 1974.
2. J. G. Proakis, Digital Communications, 4th ed. Boston: McGraw-Hill, 2000.
3. R. A. Ziegler and J. M. Cioﬃ, “Estimation of time-varying digital radio channels,” IEEE Trans. Veh. Techn.,

vol. 41, no. 2, pp. 134-151, 1992.

4. E. Biglieri, J. Proakis, and S. Shamai (Shitz), “Fading channels: information-theoretic and communications

aspects,” IEEE Trans. Infor. Theo., vol. 44, no. 6, pp. 2619-2692, 1998.

5. B. M. Hochwald and T. L. Marzetta, “Unitary space-time modulation for multiple-antenna communications

in Rayleigh ﬂat fading,” IEEE Trans. Infor. Theo., vol. 46, no. 2, pp. 543-564, 2000.

6. I. C. Abou-Faycal, M. D. Trott, and S. Shamai (Shitz), “The capacity of discrete-time memoryless Rayleigh-

fading channels,” IEEE Trans. Infor. Theo., vol. 47, no. 4, pp. 1290-1301, 2001.

7. J. Salz and J. H. Winters, “Eﬀect of fading correlation on adaptive arrays in digital mobile radio,” IEEE

Trans. Veh. Technol., vol. 43, no. 4, pp. 1049-1057, 1994.

8. T. Eyceoz, A. Duel-Hallen, and H. Hallen, “Deterministic channel modeling and long range prediction of

fast fading mobile radio channels,” IEEE Comm. Lett., vol. 2, no. 9, pp. 254-256, 1998.

9. A. Duel-Hallen, S. Hu, and H. Hallen, “Long-range prediction of fading signals,” IEEE Sig. Proc. Mag., vol.

10. J.-K. Hwang and J. H. Winters, “Sinusoidal modeling and prediction of fast fading processes,” GLOBE-

17, no. 3, pp. 62-75, 2000.

COM’98, vol. 2, pp. 892-897, 1998.

11. T. Kailath, A. H. Sayed, and B. Hassibi, Linear Estimation. Upper Saddle River, N.J.: Prentice Hall, 2000.
12. V. Krishnan, Nonlinear Filtering and Smoothing: An Introduction to Martingales, Stochastic Integrals, and

Estimation. New York: Wiley, 1984.

13. A. Benssoussan, Stochastic Control of Partially Observable Systems. Cambridge University Press, 1992.
14. N. U. Ahmed, Linear and Nonlinear Filtering for Scientists and Engineers. Singapore: World Scientiﬁc,

1998.

15. J. S. Sadowsky and V. Kafedziski, “On the correlation and scattering functions of the WSSUS channel for

mobile communications,” IEEE Trans. Veh. Tech., vol. 47, pp. 270-282, 1998.

16. J. Fuhl, A. F. Molisch, and E. Bonek, “Uniﬁed channel model for mobile radio systems with smart antennas,”

IEE Proc. - Radar, Sonar Navig., vol. 145, no. 1, pp. 32-41, 1998.

17. P. M. Fishman and D. L. Snyder, “The statistical analysis of space-time point processes,” IEEE Trans.

Inform. Theory, vol. 22, pp. 257-274, 1976.

18. D. L. Snyder and M. I. Miller, Random Point Processes in Time and Space, 2nd ed. New York: Springer-

Verlag, 1991.

11

19. I. M. Gelfand, Generalized Functions. New York: Academic Press, 1964.
20. L. Schwartz, Th`eorie des Distributions. Paris: Hermann, 1966.
21. J. D. Jackson, Classical Electrodynamics, 2nd ed. New York: John Wiley & Sons, 1975.
22. J. W. Goodman, Introduction to Fourier Optics, 2nd ed. New York: McGraw-Hill, 1996.
23. A. Ishimaru, Wave Propagation and Scattering in Random Media. New York: Academic Press, 1978.
24. M. C. W. van Rossum and Th. M. Nieuwenhuizen, “Multiple scattering of classical waves: microscopy,

mesoscopy, and diﬀusion,” Rev. Mod. Phys., vol. 71, no. 1, pp. 313-371, 1999.

25. R. F. Curtain and A. J. Pritchard, Inﬁnite Dimensional Linear Systems Theory. Berlin; Heidelberg:

26. Y. Sawaragi, T. Soeda, and S. Omatu, Modeling, Estimation, and Their Applications for Distributed Pa-

rameter Systems. Berlin; Heidelberg: Springer-Verlag, 1978.

27. G. Da Prato and J. Zabczyk, Stochastic Equations in Inﬁnite Dimensions. Cambridge University Press,

Springer-Verlag, 1978.

1992.

28. N. U. Ahmed, M. Fuhrman, and J. Zabczyk, “On ﬁltering equations in inﬁnite dimensions,” J. Functional

Analysis, vol. 143, no. 1, pp. 180-204, 1997.

12

