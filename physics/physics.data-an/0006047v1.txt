Estimating the K function of a point process with

an application to cosmology *

Michael L. Stein1, Jean M. Quashnock1,2 and Ji Meng Loh1

TECHNICAL REPORT NO. 485

1Department of Statistics
The University of Chicago

Chicago, Illinois 60637
2Department of Physics

Carthage College

Kenosha, WI 53140

March 1999

Revised May 2000

0
0
0
2

 

n
u
J
 

9
1

 
 
]
n
a
-
a
t
a
d

.
s
c
i
s
y
h
p
[
 
 

1
v
7
4
0
6
0
0
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

* This work was supported in part by National Science Foundation grants DMS 95-04470 and 99-71127 (Loh

and Stein) and NASA grant NAG 5-4406 and NSF grant DMS 97-09696 (Quashnock) .

Estimating the K function of a point process with

an application to cosmology *

Michael L. Stein, Jean M. Quashnock and Ji Meng Loh

Abstract: Motivated by the study of an important data set for understanding the

large-scale structure of the universe, this work considers the estimation of the reduced

second moment function, or K function, of a stationary point process on R observed

over a large number of segments of possibly varying lengths. Theory and simulation

are used to compare the behavior of isotropic and rigid motion correction estimators

and some modiﬁcations of these estimators. These results generally support the use

of modiﬁed versions of the rigid motion correction. When applied to a catalog of

astronomical objects known as absorbers, the proposed methods conﬁrm results from

earlier analyses of the absorber catalog showing clear evidence of clustering up to 50

h−1 Mpc and marginal evidence for clustering of matter on spatial scales beyond 100

h−1 Mpc, which is beyond the distance at which clustering of matter is now generally

accepted to exist.

Key words: Reduced second moment function; bootstrapping; large-scale structure of

the universe; heavy-element absorption-line systems

AMS 1991 subject classiﬁcations: Primary 62M30; secondary 62P35, 60G55.

Running title: Estimation for point processes

* This work was supported in part by National Science Foundation grant DMS 95-04470 and 99-71127 (Loh and

Stein) and NASA grant NAG 5-4406 and NSF grant DMS 97-09696 (Quashnock) .

1. Introduction

One way to describe a stationary spatial point processes is through some measure of clumpi-

ness of the events of the process. A commonly used measure of clumpiness is the reduced second

moment function K(t), deﬁned as the expected number of events within distance t of a typical

event of the process divided by the intensity of the process. For a homogeneous Poisson process

on Rd, K(t) = µdtd, where µd is the volume of a unit ball in d dimensions. Thus, values of K(t)

greater than µdtd are indicative of a process that is clumpier than Poisson and values less than

µdtd are indicative of a process that is more regular than Poisson. When estimating K(t) based

on observing a process within a bounded window W , a central problem is that for any event in W

that is within t of the boundary of W , we do not know for sure how many other events are within

t of it. Baddeley (1998) describes a number of ways of accounting for these edge eﬀects. Although

there is quite a bit of asymptotic theory for how these estimators behave when the underlying

process is Poisson (Ripley 1988, Stein 1993), much less is known for non-Poisson processes.

An interesting aspect of asymptotic theory for point processes is how one should take limits.

Ripley (1988) and Stein (1993) consider a single growing window, which might appear to be the

obvious way to take limits. However, Baddeley, et al. (1993) describe applications in which point

processes are observed in many well-separated windows. For this setting, Baddeley and Gill (1997)

argue that it is natural to consider taking limits by keeping the size of these windows ﬁxed and

letting their number increase. As they point out, one advantage of this approach is that the edge

eﬀects do not become negligible in the limit, since for any ﬁxed t, the fraction of events that are

within t of a window boundary does not tend to 0. Thus, for comparing diﬀerent approaches for

handling edge eﬀects, increasing the number of windows may be more informative than allowing

a single region to grow in all dimensions, for which the fraction of events that are within t of a

window boundary does tend to 0. Another advantage of taking limits by letting the number of

windows increase is that if the process is independent in diﬀerent regions, then limit theorems are

easier to prove. This is particularly the case when the windows are all well-separated translations

1

of the same set so that the observations of the process on the multiple windows can be reasonably

modeled as iid realizations. Baddeley and Gill (1997) use this approach to obtain weak convergence

results for estimators of K and other functions describing point process behavior. The resulting

limiting variances are diﬃcult to evaluate and Baddeley and Gill (1997) only give explicit results

for what they call the sparse Poisson limit, in which the intensity of a homogeneous Poisson process

tends to 0.

This work studies the estimation of K for a process on R when the windows are segments of

varying lengths. The fact that the windows are one-dimensional greatly simpliﬁes the calculation of

estimators and permits the explicit derivation of some of their properties. The fact that the segment

lengths vary provides for an interesting wrinkle on the approach of Baddeley and Gill (1997).

Notably, simulation results in Section 6 show that the diﬀerences between certain estimators are

much greater when the segment lengths are unequal.

Section 2 describes a cosmological problem that motivated the present study. Vanden Berk,

et al. (1996) put together a catalog of what are known as absorption-line systems, or absorbers,

detected along the lines-of-sight of QSOs (quasi-stellar objects or quasars). This catalog, a pre-

liminary version of which can be obtained from Daniel Vanden Berk (danvb@astro.as.utexas.edu),

provides important evidence about the large-scale structure of the universe. To a ﬁrst approxima-

tion, in appropriate units, the locations of these absorbers along the lines-of-sight can be viewed

as multiple realizations of a stationary point process along segments of varying length.

Section 3 describes the estimators of K used in this paper and gives explicit expressions for the

commonly used rigid motion correction and isotropic correction estimators when the observation

region is a collection of line segments of varying lengths. In addition, Section 3 provides an explicit

expression for a modiﬁcation to the rigid motion correction advocated in Stein (1993). The fact

that this estimator can be calculated explicitly is in contrast to the situation in more than one

dimension, in which case, calculating this modiﬁed rigid motion correction requires numerous

numerical integrations even for simple regions such as circles and rectangles. Finally, following

2

on an idea of Picka (1996), Section 3 introduces another approach to modifying the rigid motion

correction and isotropic correction. When the underlying process is homogeneous Poisson, Picka’s

modiﬁcation of the rigid motion correction has similar properties to the estimator proposed in

Stein (1993), but theoretical results in Section 5 and simulation results in Section 6 suggest that

his approach may have some advantages and we recommend the adoption of the resulting estimator

for routine use.

When the underlying process is homogeneous Poisson, Section 4 derives some asymptotic

theory for the various estimators as the number of segments on which the process is observed in-

creases. As in the case of a single growing observation window studied in Stein (1993), the modiﬁed

rigid motion correction asymptotically minimizes the variance of the estimator of K(t) among a

large class of estimators possessing a type of unbiasedness property. Furthermore, if the segments

are of equal length, then it is possible to give explicit comparisons between various estimators. In

particular, the ratio of the asymptotic mean squared error of the ordinary rigid motion correction

to that of the modiﬁed rigid motion correction equals 1 plus a positive term proportional to the

expected number of events per line segment. Thus, the beneﬁt of the modiﬁcation is modest when

this expectation is small, around 1, say, but can be quite substantial when this expectation is large.

Section 5 considers asymptotic results when the underlying process is not necessarily ho-

mogeneous Poisson, the segments are all of equal length and the processes on diﬀerent segments

are independent.

In this case, it is essentially trivial to obtain a central limit theorem for the

estimators of K used here. From the general result, it is diﬃcult to make comparisons between

the various estimators. However, if the process on the diﬀerent segments are each homogeneous

Poisson but with intensities that vary from segment to segment according to some sequence of iid

positive random variables, it is possible to give simple expressions for the asymptotic variances of

the rigid motion correction and the two modiﬁcations of this estimator. These results show that

the modiﬁcation in Stein (1993) has strictly smaller asymptotic variance than the ordinary rigid

motion correction. Furthermore, the modiﬁcation of Picka (1996) has strictly smaller asymptotic

3

variance than the modiﬁcation in Stein (1993) unless the random intensities have 0 variance, in

which case, the two modiﬁed estimators have equal asymptotic variance.

Section 6 reports on the results of a simulation study comparing the ordinary rigid motion

correction and the two modiﬁcations for both Poisson and non-Poisson processes, and equal and

unequal segment lengths. While there is no theory showing the general superiority of the modiﬁed

estimators for non-Poisson processes, the modiﬁed estimators do, for the most part, outperform

the unmodiﬁed estimator. The advantage of the modiﬁed estimators tend to be larger when the

process is more regular than Poisson, when the segment lengths are unequal and when t is near

the length of the longest available segment.

Section 7 applies the rigid motion correction and the two modiﬁcations of it described in

Section 3 to the estimation of K for the absorber catalog. In addition, approximate conﬁdence

intervals are obtained using bootstrapping based on viewing the segments as the sampling units.

All three estimates are similar and conﬁrm the ﬁnding in Quashnock and Stein (1999) of clear

evidence of clustering up to at least 50 h−1 Mpc. In addition, the conﬁdence intervals based on

the modiﬁed procedures produce a slightly stronger case for clustering of absorbers beyond 100

h−1 Mpc. Whether there is clustering of matter at such large scales and for the high redshifts in

the absorber catalog is a critical issue in modern cosmology, since presently used models for the

evolution of the universe have diﬃculty explaining such clustering (Steidel, et al. 1998, Jing and

Suto 1998).

2. The absorber catalog

The cosmological principle, which states that on large enough spatial scales, the distribution

of matter in the universe is homogeneous and isotropic, is a central tenet of modern cosmology

(Peebles 1993). In cosmology, it is convenient to measure distances in units of h−1 Mpc, where

Mpc, or megaparsec, is 3.26 × 106 light years and h is an inexactly known dimensionless number

that is believed to be between 0.5 and 0.75. As is common in the cosmological literature, in

4

reporting distances determined from redshifts, we will assume that Hubble’s constant, H0, equals

100 h km s−1 Mpc−1. To help calibrate one’s thinking about such distances, 1 h−1 Mpc is a typical

distance between neighboring galaxies. It is now generally agreed that galaxies cluster up to scales

of 10–20 h−1 Mpc (Davis and Peebles 1983, Loveday, et al. 1995). Furthermore, clustering on

such scales can be reproduced by computer simulations of the evolution of the universe based on

our present understanding of this evolution (see Zhang, et al. 1998 and the references therein).

However, there is some evidence of clustering of matter on scales of up to 100 h−1 Mpc (see

Quashnock, Vanden Berk and York (1996) and the references therein) and a few cosmologists have

speculated that clustering may exist at all spatial scales (Coleman and Pietronero 1992, Sylos

Labini, Montuori and Pietronero 1998), despite the fact that clustering at all scales contradicts

both the cosmological principle and the considerable evidence that supports it (Peebles 1993, p.

20, 45 and 221). Thus, determining the extent to which clustering of matter is present is of

fundamental importance to modern cosmology.

One way to measure the clustering of matter is through the direct observation of large

numbers of galaxies. Several galaxy surveys in various regions of the sky have been done in recent

years (Mart´ınez 1997); Pons-Border´ıa, et al. (1999) describe recent work on estimating second

moment structures of galaxy locations from such surveys. The presently ongoing Sloan Digital Sky

Survey will be by far the largest such survey and will contain roughly 108 galaxies, approximately

106 of which will have spectroscopically measured redshifts (Margon 1999). An object’s redshift

gives its velocity relative to the Earth, which, using Hubble’s Law, yields its approximate distance

from the Earth. Galaxy surveys are limited by the fact that galaxies are diﬃcult to observe directly

beyond several hundred h−1 Mpc. QSOs, on the other hand, are extremely bright and focused

objects that can be readily detected at distances of several thousand h−1 Mpc, going back to nearly

the beginning of the universe. Matter that falls on the line-of-sight between the QSO and the Earth

can absorb light from the QSO and thus be detected from the Earth even though this matter cannot

be directly observed. Certain types of matter absorb light in a characteristic pattern of frequencies

5

that can be used to identify the matter and, through the redshift of this absorption pattern, the

relative velocity of this matter to the Earth. Astronomical objects detected in this way are called

absorption-line systems or absorbers. As noted by Crotts, Melott, and York (1985), catalogs of

absorbers provide a means for estimating the clustering of matter over very large spatial scales.

Vanden Berk et al. (1996), Quashnock, Vanden Berk and York (1996) and Quashnock and Vanden

Berk (1998) make use of an extensive catalog of heavy-element absorption-line systems drawn from

the literature to investigate the clustering of matter at various scales. York, et al. (1991) describe

an earlier version of this catalog and a preliminary version of an updated catalog is available from

Daniel Vanden Berk (danvb@astro.as.utexas.edu). Here we will use the same absorber catalog as

in Quashnock and Stein (1999), who examined clustering in 352 C IV absorbers (absorbers detected

from the absorption-line patterns of C IV, or triply ionized carbon) along 274 QSO lines-of-sight.

Although the relationship between C IV absorbers and galaxies is unclear, they do appear to track

the general spatial patterns of galaxies (Lanzetta, et al. 1995, Quashnock and Vanden Berk 1998),

and hence provide a plausible means for assessing the clustering of visible matter on large scales.

Because the universe expands over time and, due to the ﬁnite velocity of light, the more

distant an object the further in the past we observe it, the method used for converting redshifts

into distances from Earth is critical to the analysis of this catalog. Redshifts are generally denoted

by z and, according to Hubble’s law, an object observed at redshift z is seen at a time when

distances between objects were approximately (1 + z)−1 times their present values. To correct

for the expansion, here, as in Quashnock and Stein (1999), we use what are called comoving

coordinates, which scale up all distances to what they would be today if all the matter in the

universe moved exactly with the Hubble ﬂow (Peebles 1993). Thus, in examining the clustering of

absorbers in comoving coordinates, we have removed the most important eﬀects of the universe’s

expansion.

If one did not make this correction, the volume density of absorbers would drop

approximately like (1 + z)3 as z decreases and we move towards the present.

6

For various reasons, it is only possible to detect C IV absorbers along a segment of each

line-of-sight. The mean length of these segments in comoving units is 303.3 h−1 Mpc, with a

range of 7.5 h−1 Mpc to 439.8 h−1 Mpc. For this catalog, the median redshift of the absorbers is

about 2.2, with the bulk of absorbers having redshifts from about 1.5 to 3. Our analysis acts as if

clustering is both stationary in time and homogeneous in space. We are more accurately examining

an average clustering over the range of redshifts in the sample at a cosmic epoch corresponding to

a characteristic redshift of 2.2 (when the universe was about 1/3 its present scale and about 1/6

its present age). Section 7 provides further discussion of this issue and its possible inﬂuence on our

results.

As in Quashnock and Stein (1999), we will act as if the absorber catalog can be viewed as

multiple partial realizations of some stationary point process on R along a series of segments. In

particular, we will not attempt to use any information about the physical location of these segments

in three-dimensional space. Using this simpliﬁcation, we will then be able to apply the methods

described in the next section to the absorber catalog.

3. Methodology

Suppose M1, . . . , Mp are simple, stationary point processes on R with a common probability

law having intensity λ and reduced second moment function K. We do not necessarily assume that

M1, . . . , Mp are independent. For a Borel subset A of R, let Mj(A) be the number of events of Mj

contained in A. If [0, Qj] is the interval on which we observe Mj, then we can write the observation

domain as D =

{[0, Qj], j}, so that (x, ℓ) ∈ D implies ℓ ∈ {1, . . . , p} and x ∈ [0, Qℓ]. Deﬁne

p
∪
j=1

Nj = Mj([0, Qj]), N+ =Pp

j=1 Nj and denote the realized value of N+ by n. For j = 1, . . . , N+,

let (Xj, Lj ) be the random locations of these observed events with realized values (xj, ℓj) for

j = 1, . . . , n.

The basic principle behind all edge-corrected estimators of K described by Ripley (1988)

is to ﬁrst ﬁnd an exactly unbiased estimator of λ2 × volume of observation domain × K(t) and

7

then to divide by an estimator of (λ2 × volume). Here, the volume of the observation domain is

Q+ =Pp

j=1 Qj. For a symmetric function φ on D × D, deﬁne T (φ) =Pj6=k φ(cid:0)(Xj, Lj), (Xk, Lk)(cid:1).

Then the unbiasedness constraint requires that

ET (φ) = λ2Q+K(t)

(1)

for any reduced moment function K. Estimating λ2 by N+(N+ − 1)/Q2

+ yields

eK(t) =

Q+T (φ)

N+(N+ − 1)
0

if N+ > 1,

otherwise

as a natural estimator of K(t).

There is an inﬁnite array of functions φ satisfying (1). Two popular choices are the rigid

motion correction (Ohser and Stoyan 1981) and the isotropic correction (Ripley 1976). Asymptotic

results in Sections 4 and 5 suggest that modiﬁed versions of the rigid motion correction have good

large sample properties when the underlying process is Poisson, so we focus on this correction

here, although we also give some results for the isotropic correction for comparison. It is fairly

elementary to prove that the rigid motion correction satisﬁes (1) when the observation domain D

is a subset of R. First, for a stationary point process M on R with intensity λ, deﬁne the reduced

second moment measure K by λ2K(ds)dx = 2E{M (dx)M (x + ds)}, in which case, the reduced

second moment function K is given by K(t) =R(0,t] K(ds). Denote the indicator function by 1{·},

use |A| to indicate the Lebesgue measure of the set A ⊂ R and As to indicate the set A translated

by the amount s. The rigid motion correction is given by

φ(x, y) =

1{|x − y| ≤ t}|D|

|D ∩ Dx−y|

.

We can then write

T (φ) =Zs∈[−t,0)∪(0,t]Zx∈R

M (dx)M (x + ds)

1{x ∈ D, x + s ∈ D}

|D ∩ Ds|

8

= 2Zs∈(0,t]Zx∈R

M (dx)M (x + ds)

1{x ∈ D, x + s ∈ D}

|D ∩ Ds|

,

so that

E{T (φ)} = 2Zs∈(0,t]Zx∈R

λ2K(ds)

1
2

1{x ∈ D, x + s ∈ D}

|D ∩ Ds|

dx

= 2Zs∈(0,t]

1
2

λ2 |D ∩ Ds|
|D ∩ Ds|

K(ds)

= λ2K(t).

One way to view the setting where D is a collection of line segments is to think of these

segments as being widely spaced intervals on R, in which case, we just have a special case of the

treatment in the preceding paragraph. However, it will be helpful in the subsequent development

to think of D as

p
∪
j=1

{[0, Qj], j}. The rigid motion correction can then be deﬁned by taking φ to be

φR(cid:0)(x, k), (y, ℓ)(cid:1) =

Q+1{|x − y| ≤ t, k = ℓ}
Pp
j=1(Qj − |x − y|)+ ,

where 1{·} is an indicator function. To write the isotropic correction in terms of a symmetric

function, let

φI(cid:0)(x, k), (y, ℓ)(cid:1) =

Q+ −Pp

Q+1{|x − y| ≤ t, k = ℓ}{αℓ(x, y) + αℓ(y, x)}

j=1 min{(2|x − y| − Qj)+, Qj}

,

(2)

where αℓ(x, y)−1 = 1{x+|y−x| < Qℓ}+1{x−|y−x| > 0}. Deﬁne eKR(t) = Q+T (φR)/{N+(N+−1)}
and eKI (t) = Q+T (φI )/{N+(N+ − 1)}, where it is understood that eKR(t) = eKI(t) = 0 for N+ ≤ 1.

We have used Ohser’s extension of the isotropic correction to cover the case t > 1

2 min(Q1, . . . , Qp)

(Ohser 1983). As Ripley (1988, p. 32) notes, this extension is generally not of much practical value

when there is a single contiguous observation window. However, when there are multiple windows

of various sizes, the extension is critical. For the absorber catalog, for example, one is certainly

interested in estimating K at distances greater than 3.75 h−1 Mpc, the value of 1

2 min(Q1, . . . , Qp)

in the catalog.

9

Note that φI(cid:0)(x, k), (y, ℓ)(cid:1) = φR(cid:0)(x, k), (y, ℓ)(cid:1) = 0 if k 6= ℓ, which just says that pairs of

observations on diﬀerent segments do not contribute to the estimate of K(t). Since we have made

no assumption about the joint distribution of M1, . . . , Mp, for (1) to be valid, it is necessary to

satisfying

assume φ(cid:0)(x, k), (y, ℓ)(cid:1) = 0 whenever k 6= ℓ. Thus, throughout this work, we will only consider φ
(A) φ(cid:0)(x, k), (y, ℓ)(cid:1) = 0 for k 6= ℓ.

We next show how to apply to the present setting the method developed in Stein (1993) for

improving upon any estimator of K of the form Q+T (φ)/{N+(N+ − 1)} with φ satisfying (1). Sup-

pose (X, L) is uniformly distributed on D in the sense that P (L = ℓ) = Qℓ/Q+ and the density of

X given L = ℓ is uniform on [0, Qℓ]. Then M1, . . . , Mp stationary with common distribution imply

j=1 g(Xj, Lj) = λQ+Eg(X, L),

that for any real-valued function g for which E|g(X, L)| < ∞, EPN+
so thatPN+

choose g to minimize

j=1{g(Xj, Lj) − Eg(X, L)} is an unbiased estimator of 0. The idea in Stein (1993) is to

varn(cid:20)T (φ) −

nXj=1

{g(Xj, Lj) − Eg(X, L)}(cid:21),

where varn means to compute the variance under binomial sampling: N+ = n is ﬁxed and, for

j = 1, . . . , n, (Xj, Lj) are independent and all have the same distribution as (X, L). Proposition 1

in Stein (1993) shows that for n ≥ 1 and (y, m) ∈ D, a minimizing g is 2(n − 1)h(y, m; φ)/Q+,

where h(y, m; φ) =Pp

Now deﬁne

ℓ=1R Qℓ

0 φ(cid:0)(x, l), (y, m)(cid:1)dx. Under (A), h(y, m; φ) =R Qm

0

φ(cid:0)(x, m), (y, m)(cid:1)dx.

T ∗(φ) = T (φ) −

2(N+ − 1)

Q+

N+Xj=1

{h(Xj, Lj ; φ) − Eh(X, L; φ)} .

Note that if φ satisﬁes (1), Eh(X, L; φ) = 2t. Under binomial sampling, we always have varn{T ∗(φ)}

≤ varn{T (φ)}. This suggests that the estimator bK(t) = Q+T ∗(φ)/{N+(N+ − 1)} for N+ > 1 and
0 otherwise may be preferred over eK(t). As with the unmodiﬁed estimators, bKR(t) indicates that
φ = φR and bKI (t) indicates that φ = φI .

10

Picka (1996) suggests another approach to modifying estimates of second moment measures.

He considered random sets for which the probability of any ﬁxed point being in the random set is

positive, but his approach can also be applied to point processes, for which this probability is 0. For

ℓ=1R Qℓ

0

point processes, his idea corresponds to using an estimator of λQ+ other than N+ in eK. For any real-
valued function c on D satisfyingPp
estimator of λ. Let us consider estimators of K(t) of the form Q+T (φ)/{bλcQ+(bλcQ+ − 1)}. It is
However, for Q+ suﬃciently large, bλc − λ and Q−1

not generally possible to calculate the exact variance of such estimators under binomial sampling.

c(x, ℓ)dx = Q+,bλc = Q−1

which suggests using a ﬁrst-order Taylor series approximation to obtain

+ T (φ) − λ2K(t) should be small in probability,

j=1 c(Xj, Lj) is an unbiased

+ PN+

Q+T (φ)

bλcQ+(bλcQ+ − 1)

≈

1

λ2Q+

T (φ) −

2K(t)

λ

(bλc − λ).

(3)

For a given φ and subject to c satisfying the unbiasedness constraint, now consider minimizing

the variance of the right side of (3) when M1, . . . , Mp are iid Poisson processes with intensity λ.

It is a straightforward variational problem to show that a minimizing c is given by c(x, ℓ; φ) =

h(x, ℓ; φ)/(2t). Deﬁne

˘K(t) =

Q+T (φ)

j=1 c(Xj, Lj; φ)(cid:8)PN+
PN+

j=1 c(Xj, Lj ; φ) − 1(cid:9)

φ = φR or φ = φI .

for N+ > 1 and ˘K(t) = 0 otherwise. As with eK and bK, subscripts R or I on ˘K indicate that
When M1, . . . , Mp are iid Poisson processes, bK(t) and ˘K(t) should behave similarly. To see

this, ﬁrst use Taylor series to obtain

1

λ2Q+

T (φ) −

2

λQ+

N+Xj=1

bK(t) ≈

h(Xj, Lj; φ) + 2{2t − K(t)}

N+
λQ+

+ 2K(t).

11

From this approximation and (3), when K(t) = 2t, both bK and ˘K are approximately

h(Xj, Lj; φ) + 4t.

1

λ2Q+

T (φ) −

2

λQ+

N+Xj=1

Thus, for Q+ large, the two estimators will be similar when M1, . . . , Mp are iid Poisson processes,

but they are not necessarily similar otherwise.

Even for simple regions in two or more dimensions, calculating h(·; φ) requires numerical

integrations. However, when the observation region is D =

p
∪
j=1

{[0, Qj], j}, then it is possible to

give an explicit expression for h(x, ℓ; φR) for (x, ℓ) ∈ D. For convenience, we will assume that the

Qjs have been arranged in increasing order. For r < Qp, deﬁne j(r) = min1≤j≤p{j : Qj ≥ r} and

let U (r) = Pp

Furthermore, deﬁne

j=1(Qj − r)+. For j = 1, . . . , p, let Uj = U (Qj) and set Q0 = 0 so that U0 = Q+.

κ(x, t) =

j(x∧t)−1Xj=1

1

p − j + 1

log(cid:18) Uj−1

Uj (cid:19) +

1

p − j(x ∧ t) + 1

log(cid:26) Uj(x∧t)−1
U (x ∧ t)(cid:27) ,

where a sum whose upper limit is less than its lower limit is deﬁned to be 0 and x ∧ t is the

minimum of x and t. Then

Q−1

+ h(x, ℓ; φR) = κ(x, t) + κ(Qℓ − x, t)

(4)

(see the appendix). If the segment lengths are all equal, κ(x, t) = p−1 log[Q/{Q − (x ∧ t)}].

It is also possible to evaluate h(x, ℓ; φI ) explicitly, but the resulting expression is rather

cumbersome. If t < 1

2 min(Q1, · · · , Qp), then the denominator in the deﬁnition of φI in (2) equals

Q+ whenever |x − y| ≤ t, which greatly simpliﬁes matters. In this case, it is possible to show that

h(x, ℓ; φI ) = t + (x ∧ t) + {(Qℓ − x) ∧ t} −

12

1

2(cid:16) x

2

∧ t(cid:17) −

1

2(cid:18) Qℓ − x

2

∧ t(cid:19) .

A second special case yielding a simple result is when Q1 = · · · = Qp = Q. When t < 1

2 Q, the

preceding expression for h applies and for t ≥ 1

2 Q,

h(x, ℓ; φI ) =

+ {x ∧ (Q − x)} + Q log"

{x ∧ (Q − x)} ∨ (Q − t)# ,

1
2 Q

3Q
4

where x ∨ y is the maximum of x and y.

There is a considerable literature in astrophysical journals on estimating second order char-

acteristics of galaxy locations based on galaxy surveys in large, contiguous regions of the sky.

Mart´ınez (1997) and Stoyan and Stoyan (2000) provide two recent reviews of this work. Astro-

physicists have generally focused on estimating the pair correlation function, which is, after a

normalization, just the derivative of the K function. For example, for a stationary point process

M on R, assuming K is diﬀerentiable, the pair correlation function is 1

2 K ′. Similar to bK here,

Landy and Szalay (1993) make use of unbiased estimators of 0 to modify estimators of second order

characteristics. Moreover, similar to ˘K, Hamilton (1993) describes estimators of the pair correla-

tion function of the form T (φ)/bλ2 in which λ2 is estimated by something other than the obvious

estimator. We prefer to estimate K rather than the pair correlation function because it separates

the problem of handling edge eﬀects from that of density estimation and the consequent smoothing

problem. If one wants to estimate the pair correlation function, we recommend ﬁrst computing

an appropriately edge-corrected estimate of K and then diﬀerentiating a smoothed version of this

estimate.

4. Asymptotic theory when the truth is Poisson

There are a number of ways one might take limits to study the properties of the estimators

proposed in the previous section. One possibility would be to ﬁx p and let the Qjs tend to ∞. In this

approach, the fraction of the observation region within a ﬁxed distance of an endpoint of a segment

tends to 0 and, as in Ripley (1988) and Stein (1993), the variance of all reasonable estimators of

K(t) for ﬁxed t have the same ﬁrst-order asymptotic behavior under binomial sampling. However,

13

for the absorber catalog, in which p = 274 and the number of absorbers per line is 1.28, a more

relevant choice is to uniformly bound the Qjs and let p → ∞. This limiting approach keeps the

fraction of the observation region within a ﬁxed distance of an endpoint of a segment bounded away

from 0 with the result that the diﬀerences between various estimators under binomial sampling

show up in the leading terms for the asymptotic variance. Hansen, Gill and Baddeley (1996) and

Baddeley and Gill (1997) take a similar asymptotic approach for studying estimators of properties

of spatial point processes based on observing the process in an increasing number of identical and

distantly spaced windows.

We now consider adapting the asymptotic results in Ripley (1988) and Stein (1993) to the

present setting. First, we give exact expressions for the variance under binomial sampling of both

eK(t) and bK(t). Following Ripley (1988), for a symmetric function φ on D × D satisfying (A),

deﬁne

S(φ) =

S2(φ) =

0

pXj=1Z Qj
0 Z Qj
0 (cid:26)Z Qj
pXj=1Z Qj
pXj=1Z Qj
0 Z Qj

φ(cid:0)(x, j), (y, j)(cid:1)dx dy,
φ(cid:0)(x, j), (y, j)(cid:1)dx(cid:27)2
φ(cid:0)(x, j), (y, j)(cid:1)2dx dy.

dy,

0

0

S1(φ) =

and

Under (A) (Ripley 1988),

varn{T (φ)} =

2n(n − 1)

Q2
+

(cid:26)S2(φ) +

2n − 4

Q+

S1(φ) −

2n − 3

Q2
+

S(φ)2(cid:27)

and (Stein 1993)

varn{T ∗(φ)} =

2n(n − 1)

Q2
+

(cid:26)S2(φ) −

2
Q+

S1(φ) +

1
Q2
+

S(φ)2(cid:27) .

(5)

(6)

We now want to study what happens as p → ∞. Suppose Q1, Q2, . . . is a sequence of positive

numbers and the subscript p is used to indicate the dependence of a term on the number of

14

segments observed, so that Dp =

j=1 Qj and N+p is the total number of

p
∪
j=1

{[0, Qj], j}, Q+p =Pp

events on Dp. Suppose {φp} is a sequence of functions for which the domain of φp is Dp × Dp and

φp is symmetric for all p. In addition to φp satisfying (A) for all p, we will assume the following

regularity conditions:

(B) The φps are uniformly bounded;

(C) For each p, φp satisﬁes the unbiasedness constraint in (1);

(D) The Qjs are bounded away from 0 and ∞.

Under (A)–(D), we have S(φp) = 2tQ+p = O(p), S1(φp) = O(p) and S2(φp) = O(p) but is not o(p).

It follows that as p → ∞,

S2(φp) −

2

Q+p

S1(φp) +

1
Q2
+p

S(φp)2 = S2(φp)(cid:8)1 + O(cid:0)p−1(cid:1)(cid:9).

(7)

Comparing (6) and (7) suggests that minimizing S2(φp) subject to (A)–(D) is nearly the same as

minimizing varn{T ∗(φp)}. Stein (1993) shows that subject to (C), the rigid motion correction gives

a minimizer of S2(φp). The appendix gives an explicit expression for S2(φR) in terms of elementary

functions.

We next obtain an analog to Proposition 2 in Stein (1993), which demonstrates the asymp-

totic optimality under the Poisson model for bKR among a certain class of estimators as the dimen-

sions of a single observation window increase. For a sequence of functions {φp} on Dp × Dp and a

sequence of functions {gp} on Dp × {0, 1, . . .}, deﬁne the statistic Θ(φp, gp) by

Θ(φp, gp) =

Q+p

N+p(N+p − 1)T (φp) −

N+pXj=1(gp(cid:0)(Xj, Lj), N+p(cid:1) −

1

Q+p

pXℓ=1Z Qℓ

0

gp(cid:0)(x, ℓ), N+p(cid:1)dx)

if N+p > 1 and 0 otherwise. Write Eλ to indicate expectations assuming M1, M2, . . . are inde-

pendent Poisson processes with constant intensity λ independent of p. All ensuing asymptotic

results in the rest of this section involve expectations over the Poisson model and can be proven by

ﬁrst conditioning on N+p, using the fact that under this model, the conditional distribution of the

15

observed events on Dp follows binomial sampling, and ﬁnally, by averaging over the distribution

of N+p, which follows a Poisson distribution with mean λQ+p.

Proposition 1. Suppose {φp} satisﬁes (A)–(C), Eλ(N+pXj=1(cid:12)(cid:12)gp(cid:0)(Xj, Lj ), N+p(cid:1)(cid:12)(cid:12)) < ∞ for all
p, the Qjs satisfy (D) and p−1P(Qj − t)+ is bounded away from 0 as p → ∞. Then

p2(cid:20)EλnbKR(t) − 2to2

− Eλ {Θ(φp, gp) − 2t}2(cid:21)

is bounded from above as p → ∞.

The assumption that p−1P(Qj − t)+ is bounded away from 0 as p → ∞ guarantees that {φR
satisﬁes (B). Since, under the conditions of Proposition 1, Eλ(cid:8)bKR(t) − 2t(cid:9)2
bKR asymptotically minimizes the mean squared error among all sequences of estimators of the

this result says that when the underlying processes are independent Poisson with equal intensity,

form considered in the proposition.

= O(p−1) as p → ∞,

p }

Let us now make some comparisons of the asymptotic mean squared errors of some esti-

mators of K(t) under the Poisson model when all Qjs equal Q and s = t/Q. From (6), we get

EλnbK(t) − 2to2

∼ 2

λ2p2Q2 S2(φp). Thus, (17) in the appendix implies

∼ −

4
λ2p

log(1 − s)

and (20) in the appendix implies

EλnbKR(t) − 2to2
×

4
λ2p

∼

EλnbKI(t) − 2to2

s + 3
4 s2
12 + 1
2 s + 3
1
17
24 − log 2 − log(1 − s)

2 s2

(8)

(9)

if 0 < s ≤ 1
3 ,
3 ≤ s ≤ 1
if 1
2 and
if 1
2 ≤ s < 1.

From Proposition 1, the right side of (9) must be at least as large as the right side of (8) for all

s ∈ (0, 1). In fact, it is a straightforward exercise to show analytically that the right side of (9)

is strictly greater than the right side of (8) for all s ∈ (0, 1). Thus, as p → ∞, the modiﬁed rigid

motion estimator bKR performs nonnegligibly better than either the ordinary or modiﬁed isotropic

16

estimator for any t ∈ (0, Q) under the Poisson model, although the improvement over the modiﬁed

isotropic estimator is minor. Figure 1 shows the ratio of the asymptotic variances for bKI (t) and
bKR(t) under the Poisson model, which reaches a maximum of approximately 1.032 near t = 0.247Q.
The asymptotic results in (8) and (9) are unchanged if ˘KR and ˘KI replace bKR and bKI.

We next compare the modiﬁed and unmodiﬁed rigid motion estimators as p → ∞ when all

Qjs equal Q. From (5),

EλneK(t) − 2to2

∼

2

λ2p2Q2 S2(φp) +

4

λp2Q2 S1(φp) −

16t2
λpQ

.

Using (17) and (18) in the appendix then yields

where

4

∼

EλneKR(t) − 2to2
λ2p(cid:2)− log(1 − s) + 4λQ{γ(s) − s2}(cid:3) ,
0 (cid:20)Z 1
4Z 1

dy(cid:21)2

1{|x − y| ≤ s}

1 − |x − y|

dx.

1

γ(s) =

0

(10)

(11)

Equation (19) in the appendix gives a more explicit expression for γ. Note that

γ(s) − s2 =

1

0 (cid:20)Z 1
4Z 1

0

1{|x − y| ≤ s}

1 − |x − y|

dy − 2s(cid:21)2

dx,

which is strictly positive for all s ∈ (0, 1].

Comparing (8) and (10) shows that, in terms of mean squared error, the asymptotic relative

advantage of either modiﬁed rigid motion estimator over the unmodiﬁed rigid motion estimator

is proportional to λQ, the expected number of events per segment. Figure 2 plots 4{γ(s) −

s2}/{− log(1 − s)}, which is less than 0.124 for all s ∈ (0, 1) and is less than 0.061 for all s < 0.9.

Thus, at least for equal Qjs, we should not expect a large improvement under the Poisson model

due to the modiﬁcations when there are only 1.28 events per segment as in the absorber catalog.

Simulation results in Section 6 show that larger improvements can occur with unequal Qjs.

17

5. Some asymptotic theory for non-Poisson processes

There is a decided lack of asymptotic theory that permits useful comparisons of estimators of

K when the underlying process is not Poisson. Stein (1995) derives results showing the advantage

of estimators like bK over those like eK, but the asymptotic approach taken there requires that

the distance t at which one is estimating K be large compared to the distances at which the

underlying process shows nontrivial dependence. When the observation window is made up of

many segments, especially if the Qjs are equal and the Mjs are independent, it appears feasible

to develop some useful asymptotic results for non-Poisson processes. This section describes some

general asymptotic results for the estimators eK, bK and ˘K described in Section 3. These results

are used to demonstrate that if M1, M2, . . . are, conditional on Λ1, Λ2, . . ., independent Poisson

processes with Mj having intensity Λj, where the Λjs are iid positive random variables, then as

p → ∞, ˘KR(t) is superior to bKR(t), which is in turn superior to eKR(t).

Suppose M1, M2, . . . are iid simple, stationary point processes on R with intensity λ and

reduced second moment function K. Assume Q = Q1 = Q2 = · · · and let X1j, . . . , XNjj be

the locations of the Nj events from Mj on (0, Q). For a bounded, symmetric function φ on

(0, Q) × (0, Q), deﬁne Φj =Pk6=ℓ φ(Xkj, Xℓj). Analogous to (1), suppose EΦj = λ2QK(t) for any
reduced second moment function K for the Mjs. Deﬁne Gj = (2t)−1PNj

EGj = λQ. Using these deﬁnitions, the estimators described in Section 3 are given by

0 φ(Xkj, y)dy, so that

k=1R Q

and

j=1 Gj
j=1 Nj

+ 4t

pQPp
eK(t) =
j=1 Nj(cid:16)Pp
Pp
4tPp
bK(t) = eK(t) −
Pp
pQPp
j=1 Gj(cid:16)Pp
Pp

˘K(t) =

18

j=1 Φj

j=1 Nj − 1(cid:17) ,

j=1 Φj

j=1 Gj − 1(cid:17) .

Furthermore, since {Nj, Φj, Gj}∞

j=1 is an iid trivariate sequence, we can readily derive the limiting

distribution of these estimators. Speciﬁcally, if E(N 4

1 ) < ∞, then Φ1 and G1 have ﬁnite second

moments, so as p → ∞,

where

L
→ indicates convergence in distribution and Σ is the 3 × 3 covariance matrix of (N1, Φ1, G1).

L

→ N (0,eV ), λQp1/2{eK(t) − K(t)}

L
→

L
→ N (0, Σ),

1

1

1

j=1 Nj − λQ

j=1 Φj − λ2QK(t)

p1/2

pPp
pPp
pPp


Using ﬁrst-order Taylor series, we get λQp1/2{eK(t) − K(t)}
N (0,bV ) and λQp1/2{ ˘K(t) − K(t)}

L
→ N (0, ˘V ), where

j=1 Gj − λQ

eV = 4K(t)2 var(N1) +

1
λ2 var(Φ1) −

4K(t)

λ

cov(N1, Φ1),

1
λ2 var(Φ1) + 16t2 var(G1) −

4{K(t) − 2t}

λ

cov(N1, Φ1)

bV = 4{K(t) − 2t}2 var(N1) +

8t
λ

−

cov(Φ1, G1) + 16{K(t) − 2t} cov(N1, G1)

and

˘V = 4K(t)2 var(G1) +

1
λ2 var(Φ1) −

4K(t)

λ

cov(Φ1, G1).

As expected, ˘V = bV when K(t) = 2t.

To calculate the limiting behavior of these estimators for any given φ, Q and law of M1, we

only have to compute the covariance matrix Σ and plug the results into (12)–(14). In some limited

cases this computation can be done analytically or more often by numerical integration; otherwise,

Σ is easily approximated by simulation whenever M1 can be readily simulated.

We now consider a simple setting in which Σ can be explicitly derived. Suppose M1, M2, . . .

are, conditional on Λ1, Λ2, . . ., independent Poisson processes with Mj having intensity Λj, where

the Λjs are iid positive random variables. Such a model could serve as an approximation for a Cox

process (Daley and Vere-Jones 1988, Section 8.5) observed over widely spaced segments where the

random intensity function Λ(·) of the process has little variation over distances of length Q but

19

(12)

(13)

(14)

the segments are suﬃciently spaced so that the behavior of Λ(·) in diﬀerent segments is essentially

independent.

Next, suppose φ(x, y) = Q1{|x − y| ≤ t}/(Q − |x − y|), so that we are using the rigid motion

estimator. In this case, the elements of Σ can be readily calculated in terms of the moments of Λ1.

Writing mj for E(Λj

1), we have λ = m1, K(t) = 2tm2/m2
1,

var(N1) = Qm1 + Q2(m2 − m2

1),

var(Φ1) = 16Q3γ(cid:18) t
t2 γ(cid:18) t

Q(cid:19) m3 − 4Q2 log(cid:18)1 −
Q(cid:19) m1 + Q2(m2 − m2

var(G1) =

Q3

1),

cov(N1, Φ1) = 4tQm2 + 2tQ2(m3 − m1m2),

t

Q(cid:19) m2 + 4t2Q2(m4 − m2

2),

cov(N1, G1) = Qm1 + Q2(m2 − m2
1)

and

cov(Φ1, G1) =

4Q3

t

γ(cid:18) t
Q(cid:19) m2 + 2tQ2(m3 − m1m2).

Each of these results can be obtained by conditioning on Λ1. For example,

var(Φ1) = E{var(Φ1 | Λ1)} + var{E(Φ1 | Λ1)}

= E"4Λ3
φ(x, y)dy(cid:27)2
0 (cid:26)Z Q
1Z Q
= 16Q3γ(cid:18) t
Q(cid:19) m3 − 4Q2 log(cid:18)1 −

0

dx + 2Λ2

1Z Q
0 Z Q

0

φ(x, y)2dx dy# + var(2tΛ2

1Q)

t

Q(cid:19) m2 + 4t2Q2(m4 − m2

2),

where the second step follows from (10) in Ripley (1988, p. 30) and the last step uses (17) and (18)

in the appendix.

Plugging these results into (12)–(14) yields

var(Φ1) − 16t2Q

var(Φ1) − 16t2Q

1
m2
1

1
m2
1

eVR =
bVR =

+ 16t2Q2 m2(m2

m2
2
m3
1
(m2 − m2

1)2

2 − m1m3)
m4
1

,

− 16Q3γ(cid:18) t

Q(cid:19)(cid:18) 2m2

m1

− m1(cid:19) + 16t2Q2 m2(m2

2 − m1m3)
m4
1

m3
1

20

and

˘VR =

1
m2
1

var(Φ1) − 16Q3γ(cid:18) t

Q(cid:19) m2

2
m3
1

+ 16t2Q2 m2(m2

2 − m1m3)
m4
1

,

where the subscript R indicates that the asymptotic variance is for the appropriate version of the

rigid motion estimator. Thus,

eVR −bVR = 16Q3(cid:18) 2m2

m1

− m1(cid:19)(cid:26)γ(cid:18) t

Q(cid:19) −

t2

Q2(cid:27) ,

which is positive on (0, 1) since γ(s) − s2 > 0 for s ∈ (0, 1) and m2 ≥ m2

1. Furthermore,

(15)

(16)

bVR − ˘VR = 16Q3 (m2 − m2

m3
1

1)2

(cid:26)γ(cid:18) t

Q(cid:19) −

t2

Q2(cid:27) ,

m2 = m2

1 and bVR = ˘VR.

which is positive on (0, 1) whenever m2 > m2

1. Thus, bVR > ˘VR unless var Λ1 = 0, in which case,

The arguments in this section largely carry over to estimators for the reduced second moment

function of iid point processes on Rd observed over

p
∪
j=1

{A, j} for some A ⊂ Rd. In particular, (12)–

(14) still hold if, at the appropriate places, 2t is replaced by µdtd, the volume of a ball of radius

t in Rd. Furthermore, the comparisons between eVR, bVR and ˘VR in (15) and (16) still hold after
replacing γ(t/Q) − t2/Q2 byRA(cid:8)RA φ(x, y)dy − µdtd(cid:9)2dx.

6. Simulation study

The asymptotic results in the preceding two sections provide only limited information about

the relative advantages of the various estimators, especially for non-Poisson processes or unequal

Qjs. Because the estimators eKR, bKR and ˘KR can all be explicitly calculated, it is fairly straight-

forward to study the behavior of these estimators via simulation. This section reports some results

from a simulation study that considers equal and unequal Qjs and three models for the law of the

point processes. For the unequal segment length case, p = 50 and Qj = 0.1j for j = 1, . . . , p and

for the equal segment length case, p = 50 and each Qj = 2.55, so that Q+ = 127.5 in both cases.

21

The three processes reported on here are all stationary renewal processes; that is, the waiting times

between consecutive events are iid random variables. In each case, the intensity of the process is

1, so that EN+ = 127.5 in all simulations. Stationary renewal processes are straightforward to

simulate on an interval [0, Q]. If F is the cdf (cumulative distribution function) for the waiting

times and µ < ∞ is the mean waiting time, then to obtain a stationary process on [0, ∞), use

µ−1R x

0 {1 − F (y)}dy for the cdf of the time of the ﬁrst event after 0 (Daley and Vere-Jones 1988,

p. 107). Simulate a random variable from this distribution; if it is greater than Q then one is done

and there are no events in [0, Q] for this realization of the process. If not, simulate random waiting

times with cdf F until one gets the ﬁrst event after Q and use the preceding events as the realization

of the process on [0, Q]. Here, we consider waiting time densities f that are exponential with mean

1 (in which case the Mjs are Poisson processes), f (x) = 4xe−2x for x > 0 (a gamma density with

parameters 2 and 1

2 ) and f (x) = 24/(2+x)4 for x > 0. Figure 3 plots K(t)−2t for renewal processes

with the last two waiting time densities, which shows that the ﬁrst of these corresponds to a process

more regular than the Poisson and the second is more clumped than the Poisson. For the gamma

waiting times, it is possible to show that for x 6= 0, P {M1(dx) = 1 | M1({0}) = 1} = 1 − e−4x and

hence that K(t) = 2t − 1

2 (1 − e−4t). For the third waiting time density, we cannot give an analytic

expression for K(t), although Theorem 1 in Feller (1971, p. 366) implies that K(t) − 2t → 2 as

t → ∞. The values for K(t) in Figure 3 for this process were obtained by simulation. Since the

mean waiting times are all equal, the variances of the waiting times provide another measure of

clumpiness with larger variances corresponding to a clumpier process. For the exponential waiting

times, the variance is 1, for the gamma case, the variance is 1

2 and for the last case the variance is

3.

Figures 4–6 show the results of simulations for both sets of segment lengths and all three

processes. For each scenario, the three estimators were calculated at a range of distances for 10,000

simulations. Generally speaking, bKR and ˘KR behave similarly and are superior to eKR, especially
at longer distances when the Qjs are unequal. Figure 4 shows the mean squared errors for bKR.

22

In all cases, the contributions of the squared biases to the mean squared errors are practically

negligible and are always less than 0.5%. As expected, the mean squared errors grow with t,

especially for the unequal segment length case as t gets near 5, the longest segment length available.

Another expected result is that the mean squared errors increase with increasing clumpiness of the

underlying process. Figure 5 compares eKR and bKR. We see that bKR is generally superior, although
eKR is sometimes slightly better for smaller t. The relative advantage of bKR (and ˘KR) over eKR

tends to be greater for more regular processes, which qualitatively agrees with the asymptotic

results in Stein (1995). The advantage also tends to be greater for unequal segment lengths,

demonstrating that theoretical results obtained for equal segment lengths may not accurately

reﬂect the diﬀerences between estimators when segment lengths are unequal. Figure 6 compares

bKR and ˘KR. From the theoretical results in the previous section, we should expect these estimators

to behave similarly when the waiting time density is exponential so that the underlying model is

Poisson. The simulations show that the estimators also tend to behave very similarly for some

non-Poisson models, especially when the segment lengths are equal. Neither estimator dominates

the other, although ˘K tends to be slightly superior for t nearly as large as the longest segment

length.

For highly regular processes, bKR can be substantially inferior to either eKR or ˘KR for t

suﬃciently small. The problem is caused by the fact that in such circumstances, having a pair

of events within t of each other is rare, so that var{T (φ)} is much smaller than under a Poisson

model with the same intensity, whereas the variance of

T (φ) − T ∗(φ) =

2(N+ − 1)

Q+

N+Xj=1

{h(Xj, Lj; φ) − Eh(X, L; φ)}

is not much diﬀerent for a highly regular process than for a Poisson process. As a consequence,

subtracting oﬀ T (φ) − T ∗(φ) from T (φ) tends to inﬂate the variance of the estimator. As an

example of a highly regular process, consider the stationary renewal process with waiting time

density 66

5! x5e−x/6 for x > 0, a gamma density with parameters 6 and 1

6 . This waiting time

23

distribution has mean 1 and variance 1

6 and corresponds to a highly regular point process. It is

possible to show that

K(t) = 2t −

5
6

+

1
6

e−12t +

1
3

cos(33/2t)(e−9t + e−3t) +

1

31/2

sin(33/2t)(cid:18) 1

3

e−9t + e−3t(cid:19)

for this process. Figure 7 shows that bKR is notably inferior to either eKR and ˘KR for t suﬃciently
small; for larger t, it is competitive with ˘KR and clearly superior to eKR. The overall winner is

˘KR, which performs well for all t.

We are unaware of any circumstances in which ˘KR performs substantially worse than either

bKR or eKR. Thus, we recommend routinely using ˘KR to estimate K, although routine adoption

for processes in more than one dimension will require the development of the necessary software.

7. Application to absorber catalog

Figure 8 displays the estimators eKR, bKR and ˘KR as applied to the absorber catalog described

in Section 2. The three estimators are very similar and, as expected, show clear evidence of clus-

tering of absorbers. To obtain some idea about the uncertainty of these estimates, as in Quashnock

and Stein (1999), approximate 95% pointwise conﬁdence intervals were obtained by bootstrapping

using the 274 segments as the sampling units. Speciﬁcally, using the notation in Section 5, simu-

lated absorber catalogs were produced by sampling with replacement from (Qj; X1j, . . . , XNj j) for

j = 1, . . . , 274, so that when one selects a segment, one automatically selects the absorber locations

that go with this segment. The conﬁdence bands displayed in Figure 8 are then what Davison and

Hinkley (1997, p. 29) call the basic bootstrap conﬁdence limits and are based on 999 simulated

catalogs. All three estimators yield similar conﬁdence intervals, which is disappointing but per-

haps not unexpected given the strong clustering that exists in the absorber catalog and the ﬁnding

in the simulation study that the advantage of the modiﬁcations decreases as clustering increases.

For these bootstrapping intervals to be appropriate, (Qj; X1j, . . . , XNj j) for j = 1, . . . , 274 should

be iid random objects. Since the segments are of widely varying lengths, if the Qjs are viewed

24

as ﬁxed, the identically distributed assumption is false. However, if we view the Qjs as being

a sequence of iid positive random variables that are independent of the locations of absorbers,

then the identically distributed assumption may be reasonable. Whether or not the independence

assumption is reasonable depends on the spatial extent of clustering among absorbers. If there

is no spatial dependence in absorber locations beyond, say, 100 h−1 Mpc, then the independence

assumption is not seriously in error, since few pairs of segments are within this distance of each

other. If, however, nonnegligible clustering exists well beyond 100 h−1 Mpc, then the independence

assumption is more problematic.

Analyses of galaxy surveys (Davis and Peebles 1983, Loveday, et al. 1995) show that visible

matter clusters on scales of up to 20 h−1 Mpc. Thus, it is more interesting to investigate how

K(t) − 2t changes at distances beyond 20 h−1 Mpc than to look at K itself. Figure 8 shows that

bKR(t)−2t generally increases until about 200 h−1 Mpc and it is important to assess the uncertainty
in this pattern. Applying the bootstrapping procedure to eKR(t) − eKR(t0) for t0 = 20, 50, 100 and

150 h−1 Mpc, Quashnock and Stein (1999) concluded that there was strong evidence for clustering

from 20 to 50 h−1 Mpc and from 50 to 100 h−1 Mpc, but at best marginal evidence for clustering

beyond 100 h−1 Mpc. The results with the modiﬁed estimates (not shown) conﬁrm the clear

evidence for clustering from 20 to 50 h−1 Mpc and from 50 to 100 h−1 Mpc. Figure 9 shows the

lower bounds for pointwise 95% conﬁdence intervals for K(t) − K(100) − 2(t − 100). The modiﬁed

estimators yield slightly stronger evidence of clustering beyond 100 h−1 Mpc, which is mostly due

to the fact that the modiﬁed estimates of K(t) − K(100) − 2(t − 100) are slightly larger than the

unmodiﬁed estimates for t around 200 and not because the modiﬁed intervals are narrower. If one

used 99% pointwise conﬁdence intervals in Figure 9, then for all t > 100 and all three estimators,

the lower conﬁdence bounds are negative. Thus, the conclusion in Quashnock and Stein (1999)

that there is perhaps marginal evidence for clustering beyond 100 h−1 Mpc is not altered by using

the modiﬁed estimators.

25

As discussed in Section 2, the broad range of redshifts in the absorber catalog implies that we

are looking at the universe at a broad range of times. The use of comoving units largely equalizes

the intensity of absorbers across redshifts, but it does not equalize the clustering.

Indeed, by

dividing the absorber catalog into groups based on their redshift, Quashnock and Vanden Berk

(1998) found evidence that as redshift decreases, clustering on the scales of 1 to 16 h−1 Mpc

strongly increases across the range of redshifts in the absorber catalog. Quashnock and Vanden

Berk (1998) further note that this increase in clustering with decreasing redshift is consistent with

what is known through theory and simulations about how gravity should aﬀect the evolution of

the clustering of absorbers over time. Using the various forms of the rigid motion estimator of K

described here on groups of the absorber catalog with similar redshifts, we also ﬁnd that on the

scale of a few tens of h−1 Mpc, clustering increases substantially with decreasing redshift over the

range of redshifts in the absorber catalog (results not shown). Thus, on these shorter scales, our

estimates of K measure an average clustering over the range of redshifts in the absorber catalog.

In contrast, Quashnock, Vanden Berk and York (1996) found no evidence that clustering at

scales of 100 h−1 Mpc changes over the redshift range in the absorber catalog. Similarly, when

looking at, say, ˘KR(t)− ˘KR(100) for t > 100 based on higher and lower redshift parts of the catalog,

we ﬁnd no systematic diﬀerence in the estimates as a function of redshift. For example, dividing the

274 segments in the catalog into two groups of size 137 based on redshift, ˘KR(150)− ˘KR(100) equals

150.8 for the lower redshift group and 151.4 for the higher redshift group. Thus, we do not believe

that the modest evidence we ﬁnd for clustering at these larger scales is due to inhomogeneities

across time in the distribution of absorbers.

8. Summary

For studying the behavior of edge-corrected estimators of the K function of a point process,

taking the observation domain to be a sequence of segments has a number of desirable consequences.

First, explicit expressions are available for a number of the more popular estimators, which is often

26

not the case for regions in more than one dimension. The availability of such explicit expressions

eases the study of the properties of these estimators via both theory and simulation. In addition,

studying settings in which the number of segments is large yields results that highlight the diﬀer-

ences between the various methods of edge-correction. In particular, simulation results show that

allowing the segment lengths to vary generally increases the diﬀerences between estimators. The

overall conclusion about the merits of the various estimators is that ˘KR, a modiﬁcation of the rigid

motion estimator based on an approach suggested by Picka (1996), is the estimator of choice.

The absorber catalog studied here shows that multiple windows of varying size can arise in

practice. Although it is somewhat disappointing that the bootstrap conﬁdence intervals for the

ordinary rigid motion corrected estimator and its modiﬁcations are very similar, this result is not

too surprising in light of the simulation results showing that the beneﬁt of the modiﬁcations is

smaller for clustered processes. The simulation results indicate that the modiﬁed estimators can

have substantially smaller mean squared errors for Poisson or more regular processes, especially if

the segment lengths vary substantially.

Appendix. Proofs

We ﬁrst derive (4) assuming, for convenience, the Qjs have been arranged in increasing

order. We have

1
Q+

h(x, ℓ; φR) =

1
Q+

0

=Z Qℓ
=Z x
=Z x

0

0

pXj=1Z Qj

0

φR(cid:0)(x, ℓ), (y, j)(cid:1)dy

1{|x − y| ≤ t}

U (|x − y|)

dy

1{|x − y| ≤ t}

U (|x − y|)

1{|x − y| ≤ t}

U (|x − y|)

x

dy +Z Qℓ
dy +Z Qℓ−x

0

27

1{|x − y| ≤ t}

U (|x − y|)

dy

1{|Qℓ − x − y| ≤ t}

U (|Qℓ − x − y|)

dy.

Thus, to verify (4), we need to show that

κ(x, t) =Z x

0

1{|x − y| ≤ t}

U (|x − y|)

dy.

Now

Z x

0

1{|x − y| ≤ t}

U (|x − y|)

dy =Z x

(x−t)+

dy

U (x − y)

=

x−Qk

j(x∧t)−1Xk=1 Z x−Qk−1
+Z x−Qj(x∧t)−1

(x−t)+

Pp
Pp

dy

j=k(Qj − x + y)

dy

j=j(x∧t)(Qj − x + y)

,

which equals κ(x, t) by calculus.

We next derive S2(φR), again assuming the Qjs have been arranged in increasing order. By

the symmetry of φR,

S2(φR) = 2Q2

+

pXj=1Z Qj

0

Z x

0

1{x − y ≤ t}
U (x − y)2 dy dx,

so taking v = x − y and then switching the order of integration yields

S2(φR)
2Q2
+

=

=

=

=

0

1

0

0

U (v)2 dv dx

Qj − v
U (v)2 dv

pXj=1Z Qj
Z x∧t
pXj=1Z Qj∧t
j∧{j(t)−1}Xℓ=1
pXj=1
k=ℓ(Qk − v)(cid:9)2 dv +
(cid:8)Pp
j∧{j(t)−1}Xℓ=1 (cid:26) Qj − Qℓ
pXj=1
pXj=j(t)(cid:20)

{p − j(t) + 1}U (t)

Z Qℓ

(p − ℓ + 1)Uℓ

Qj − v

Qj − t

Qℓ−1

+

−

28

pXj=j(t)Z t

Qj(t)−1

Qj − v

k=j(t)(Qk − v)(cid:9)2 dv
(cid:8)Pp
Uℓ−1(cid:19)(cid:27)

(p − ℓ + 1)2 log(cid:18) Uℓ

1

−

Qj − Qℓ−1

(p − ℓ + 1)Uℓ−1

−

Qj − Qj(t)−1

{p − j(t) + 1}Uj(t)−1

−

1

{p − j(t) + 1}2 log(cid:26) U (t)

Uj(t)−1(cid:27)(cid:21) .

Using the deﬁnition of U (t), the second sum simpliﬁes to {p − j(t) + 1}−1 log{Uj(t)−1/U (t)} and

by switching the order of summation and using the deﬁnition of Uℓ, the ﬁrst sum equals

−

Qj − Qℓ−1

(p − ℓ + 1)Uℓ−1

+

−

Uℓ−1

(p − ℓ + 1)Uℓ−1

+

1

(p − ℓ + 1)2 log(cid:18) Uℓ−1
Uℓ (cid:19)(cid:27)
log(cid:18) Uℓ−1
Uℓ (cid:19)(cid:27)

p − ℓ + 1

1

j(t)−1Xℓ=1

(p − ℓ + 1)Uℓ

pXj=ℓ(cid:26) Qj − Qℓ
j(t)−1Xℓ=1 (cid:26)
j(t)−1Xℓ=1

p − ℓ + 1

Uℓ

1

(p − ℓ + 1)Uℓ

=

=

log(cid:18) Uℓ−1
Uℓ (cid:19) .

Thus,

S2(φR) = 2Q2

+

j(t)−1Xℓ=1

1

p − ℓ + 1

log(cid:18) Uℓ−1

Uℓ (cid:19) +

2Q2

+

p − j(t) + 1

log(cid:26) Uj(t)−1
U (t) (cid:27) .

If Q1 = · · · = Qp = Q, then for t < Q, j(t) = 1, so

S2(φR) = −2pQ2 log(cid:18)1 −

t

Q(cid:19) .

(17)

Calculating S1(φR) is more diﬃcult and we only give the special case Q1 = · · · = Qp = Q.

Setting s = t/Q, we then have

S1(φR) = pZ Q

0 (cid:26)Z Q

0

Q1{|x − y| ≤ t}

Q − |x − y|

dy(cid:27)2

dx = 4pQ3γ(s),

(18)

where γ is deﬁned in (11). To evaluate γ, write

0

1

0 (cid:20)Z x
2Z 1
0 (cid:20)Z x
2Z 1

+

1

0

1{x − y ≤ s}

1 − x + y

dy(cid:21)2

dx

1{x − y ≤ s}

1 − x + y

γ(s) =

=

1

2Z 1

0

log2{1 − (x ∧ s)} dx +

log{1 − (x ∧ s)} log{(1 − s) ∨ x} dx.

1{z − x ≤ s}

1 − z + x

dz(cid:21) dx

x

dy(cid:21)(cid:20)Z 1
2Z 1

1

0

Now

Z 1

0

log2{1 − (x ∧ s)}dx = 2s + 2(1 − s) log(1 − s)

29

and for s ≤ 1
2 ,

Z 1

0

log{1 − (x ∧ s)} log{(1 − s) ∨ x}dx = − log2(1 − s) − 2s log(1 − s)

whereas for s > 1
2 ,

0

log{1 − (x ∧ s)} log{(1 − s) ∨ x} dx

Z 1
= −2(1 − s) log(1 − s) − 2s log s log(1 − s) +Z s

1−s

log(1 − y) log y dy.

Hence,

γ(s) = s + (1 − 2s)+ log(1 − s) − 1(cid:26)s ≤

1

2(cid:27) 1

2

log2(1 − s)

− 1(cid:26)s >

1

2(cid:27) s log s log(1 − s) +Z (s−1/2)+

0

log(cid:18) 1

2

− y(cid:19) log(cid:18) 1

2

+ y(cid:19) dy.

(19)

y < x < Qℓ we have

Let us next consider computing S2(φI ). Deﬁning R(v) = Q+ −Pp
φI(cid:0)(x, ℓ), (y, m)(cid:1) =

1{x − y ≤ t, ℓ = m}Q+

1 + 1{2x − y < Qℓ}

R(x − y)

(cid:20)

+

1

Thus, taking v = x − y,

j=1(2v − Qj)+, then for

1

1 + 1{2y − x > 0}(cid:21) .

1

1 + 1{2x − y < Qℓ}

+

1

1 + 1{2y − x > 0}(cid:21)2

dy dx

S2(φI )
2Q2

+

=

=

=

0

1{x − y ≤ t}

pXℓ=1Z Qℓ
0 Z x
pXℓ=1Z Qℓ
0 Z x∧t
pXℓ=1Z t∧Qℓ

R(x − y)2 (cid:20)
R(v)2(cid:20)
R(v)2Z Qℓ

(cid:20)

1

1

0

0

v

1 + 1{x + v < Qℓ}

1

1

1 + 1{x + v < Qℓ}

+

1

1 + 1{x > 2v}(cid:21)2
1 + 1{x > 2v}(cid:21)2

1

+

dv dx

dx dv.

Now [1+1{x+v < Qℓ}]−1 +[1+1{x > 2v}]−1 takes on values 2, 3

2 and 1 depending on, respectively,

whether none, one or both of x + v < Qℓ and x > 2v are true. Thus,

S2(φI)
2Q2
+

=

3 Qℓ

pXℓ=1(Z t∧ 1

0

9
4 2v + 1(Qℓ − 3v)

R(v)2

dv

30

2 Qℓ

t∧ 1

+Z t∧ 1
pXℓ=1(Z t∧ 1

0

3 Qℓ

3 Qℓ

=

9
4 (2Qℓ − 4v) + 4(3v − Qℓ)

R(v)2

dv +Z t∧Qℓ

t∧ 1

2 Qℓ

4(Qℓ − v)

R(v)2

dv)

Qℓ + 3
2 v

R(v)2 dv +Z t∧ 1

t∧ 1

3 Qℓ

2 Qℓ

1
2 Qℓ + 3v
R(v)2

dv +Z t∧Qℓ

t∧ 1

2 Qℓ

4(Qℓ − v)

R(v)2

dv) .

While it is possible to evaluate these integrals explicitly, the resulting expressions do not

appear to simplify as in the case for the rigid motion estimator. When Q1 = · · · = Qp = Q, we do

obtain a fairly simple explicit result. By taking u = v/Q, we get

3

0

S2(φI ) = 2pQ2"Z s∧ 1
+Z s
= 2pQ2(Z s∧ 1

0

3

s∧ 1
2

2

2 u

s∧ 1
3

1 + 3

4 − 4u

{1 − (2u − 1)+}2 du +Z s∧ 1
{1 − (2u − 1)+}2 du#
3 (cid:18) 1
u) du +Z s∧ 1

(1 +

3
2

s∧ 1

2

2

1
2 + 3u

{1 − (2u − 1)+}2 du

+ 3u(cid:19) du +Z s

s∧ 1
2

1

1 − u

du) ,

so that for s = t/Q < 1,

S2(φI ) = 2pQ2 ×

s + 3
4 s2
12 + 1
2 s + 3
1
17
24 − log 2 − log(1 − s)

2 s2

if 0 < s ≤ 1
3 ,
3 ≤ s ≤ 1
if 1
2 and
if 1
2 ≤ s < 1.

(20)

References

Baddeley, A. (1998). Spatial sampling and censoring. In Stochastic Geometry: Likelihood and

Computation (O. E. Barndorﬀ-Nielsen, W. S. Kendall and M. N. M. van Lieshout, eds.) Chapter

2. Chapman and Hall, London.

Baddeley, A. and Gill, R. D. (1997). Kaplan-Meier estimators of distance distributions for

spatial point processes. Ann. Statist. 25 263–292.

Baddeley, A. J., Moyeed, R. A., Howard, C. V. and Boyde, A. (1993). Analysis of a three-

dimensional point pattern with replication. Appl. Statist. 42 641–668.

31

Coleman, P. H. and Pietronero, L. (1992). The fractal structure of the universe. Phys.

Reports 213 311–389.

Crotts, A. P. S., Melott, A. L. and York, D. G. (1985). QSO metal-line absorbers: the key

to large-scale structure? Phys. Letters B 155B 251–254.

Daley, D. J. and Vere-Jones, D. (1988). An Introduction to the Theory of Point Processes.

Springer-Verlag, New York.

Davis, M. and Peebles, P. J. E. (1983). A survey of galaxy redshifts. V. The two-point

position and velocity correlations. Astrophys. J. 267 465–482.

Davison, A. C. and Hinkley, D. V. (1997). Bootstrap Methods and Their Application. Cam-

bridge University Press.

Feller, W. (1971). An Introduction to Probability Theory and Its Applications, vol. II. Wiley,

New York.

Hamilton, A. J. S. (1993). Toward better ways to measure the galaxy correlation function.

Astrophys. J. 417 19–35.

Jing, Y. P. and Suto, Y. (1998). Confronting cold dark matter cosmologies with strong

clustering of Lyman break galaxies at z ∼ 3. Astrophys. J. 494 L5–L8.

Landy, S. L. and Szalay, A. S. (1993). Bias and variance of angular correlation functions.

Astrophys. J. 412 64–71.

Lanzetta, K. M., Bowen, D. B., Tytler. D. and Webb, J. K. (1995). The gaseous extent of

galaxies and the origin of Lyman-alpha absorption systems: A survey of galaxies in the ﬁelds of

Hubble Space Telescope spectroscopic target QSOs. Astrophys. J. 442 538–568.

Loveday, J., Maddox, S. J., Efstathiou, G. and Peterson, B. A. (1995). The Stromlo-APM

redshift survey. II. Variation of galaxy clustering with morphology and luminosity. Astrophys. J.

442 457–468.

Margon, B. (1999). The Sloan Digital Sky Survey. Phil. Trans. R. Soc. Lond. A 357 93-103.

32

Mart´ınez, V. J. (1997). Recent advances in large-scale structure statistics.

In Statistical

Challenges in Modern Astronomy II (G. J. Babu and E. D. Feigelson, eds.) 153–166. Springer,

New York.

Ohser, J. (1983). On estimators for the reduced second moment measure of point processes.

Math. Oper. Statist. ser Statist. 14 63–71.

Ohser, J. and Stoyan, D. (1981). On the second-order and orientation analysis of planar

stationary point processes. Biom. J. 23 523–533.

Peebles, P. J. E. (1993). Principles of Physical Cosmology. Princeton University Press.

Picka, J. (1996). Variance-reducing modiﬁcations for estimators of dependence in random

sets. Ph. D. dissertation, Department of Statistics, University of Chicago.

Pons-Border´ıa, M.-J., Mart´ınez, V. J., Stoyan, D., Stoyan, H. and Saar, E. (1999). Compar-

ing estimators of the galaxy correlation function. Astrophys. J. 523 480–491.

Quashnock, J. M. and Stein, M. L. (1999). A measure of clustering of QSO heavy-element

absorption-line systems. Astrophys. J. 515 506–511.

Quashnock, J. M. and Vanden Berk, D. E. (1998). The form and evolution of the clustering

of QSO heavy-element absorption-line systems. Astrophys. J. 500 28–36.

Quashnock, J. M., Vanden Berk, D. E. and York, D. G. (1996). High-redshift superclustering

of quasi-stellar object absorption-line systems on 100 h−1 Mpc scales. Astrophys. J. 472 L69-L72.

Ripley, B. D. (1988). Statistical Inference for Spatial Processes. Cambridge University Press,

Cambridge.

Steidel, C. C., Adelberger, K. L., Dickinson, M., Giavalisco, M. Pettini, M. and Kellogg, M.

(1998). A large structure of galaxies at redshift z ∼ 3 and its cosmological implications. Astrophys.

J. 492 428–438.

Stein, M. L. (1993). Asymptotically optimal estimation for the reduced second moment

measure of point processes. Biometrika 80 443–449.

33

Stein, M. L. (1995). An approach to asymptotic inference for spatial point processes. Statist.

Sinica 5 221–234.

Stoyan, D. and Stoyan, H. (2000). Improving ratio estimators of second order point process

characteristics. Scand. J. Statist. in press.

Sylos Labini, F., Montuori, M. and Pietronero, L. (1998). Scale-invariance of galaxy cluster-

ing. Phys. Reports 293 61–226.

Vanden Berk, D. E., Quashnock, J. M., York, D. G., Yanny, B. (1996). An excess of C IV

absorbers in luminous quasars: evidence for gravitational lensing? Astrophys. J. 469 78–83.

York, D. G., Yanny, B., Crotts, A., Carilli, C., Garrison, E. and Matheson, L. (1991). An

inhomogeneous reference catalogue of identiﬁed intervening heavy element systems in spectra of

QSOs. Mon. Not. Roy. Astron. Soc. 250 24–49.

Zhang, Y., Meiksin, A., Anninos, P. and Norman, M. L. (1998). Physical properties of the

Lyα forest in cold dark matter cosmology. Astrophys. J. 495 63–79.

34

35

36

37

38

39

40

41

42

43

