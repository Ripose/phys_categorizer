4
0
0
2
 
b
e
F
 
9
1
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
9
9
0
2
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Bayesian Estimation for Land Surface Temperature
Retrieval: The Nuisance of Emissivities

1

John A. Morgan
The Aerospace Corporation
P. O. Box 92957
Los Angeles, CA 90009

Abstract— An approach to the remote sensing of land
surface temperature is developed using the methods of
Bayesian inference. The starting point is the maximum en-
tropy estimate for the posterior distribution of radiance in
multiple bands. In order to convert this quantity to an es-
timator for surface temperature and emissivity with Bayes’
theorem, it is necessary to obtain the joint prior probability
for surface temperature and emissivity, given available prior
knowledge. The requirement that any pair of distinct ob-
servers be able to relate their descriptions of radiance under
arbitrary Lorentz transformations uniquely determines the
prior probability. Perhaps surprisingly, surface temperature
acts as a scale parameter, while emissivity acts as a location
parameter, giving the prior probability

P (T, ǫ | K) =

dT dǫ

const
T

Given this result, it is a simple matter to construct estima-
tors for surface temperature and emissivity. Monte Carlo
simulations of land surface temperature retrieval in selected
MODIS bands are presented as examples of the utility of
the approach.

Keywords— Remote Sensing, Land Surface Temperature,

Sea Surface Temperature.

I. Introduction

THIS paper derives the joint prior probability for sur-

face temperature and emissivity for the land sur-
face temperature retrieval problem in remote sensing. It
presents analysis necessary for formulating a Bayesian ap-
proach to that problem, together with a Monte Carlo simu-
lation of land surface temperature (LST) and surface emis-
sivity extractions.

After a brief description of the problem and the method
of attack, the maximum entropy estimator for the mis-
match between sensed and forward model radiance is given.
Next, the joint prior probability for surface temperature
and emissivity is obtained. This quantity is required in
order to construct a useable estimator for surface temper-
ature and emissivity. With the prior probability in hand,
it is a simple matter to construct expressions for the ex-
pected values of surface temperature and emissivity con-
sistent with sensor aperture radiances and available prior
knowledge. Finally, a sample temperature-emissivity sepa-
ration is presented using MODTRAN calculations both for
the forward model and for simulated sensor radiances.
c
(cid:13)

2004 The Aerospace Corporation

II. The Temperature-Emissivity Separation

Problem amd its Discontents

Increasingly capable remote sensing technology has
sparked interest in exploiting thermal emission from sur-
faces both for remote sensing of surface temperature and
of emissivity. On the one hand, surface temperature studies
form a signiﬁcant portion of the science goals of MODIS,
ASTER, and MTI, while AVHRR has been used opera-
tionally for sea surface and land surface temperature stud-
ies for many years. On the other, the use of emissivity
information in thermal portions of the spectrum for geo-
logical remote sensing has grown rapidly in recent years,
and is as prominent in the science goals of MODIS and
similar instruments as is surface temperature.

Accordingly, the problem of temperature-emissivity sep-
aration merits close examination. The entirety of the in-
formation about a radiating surface comes from the ther-
mal radiation it emits, conventionally parameterized as the
product of blackbody radiation at the surface temperature
T and the emissivity ǫk,

Is = ǫkBk(T )

(1)

at each wavenumber k. Suppose one observes a radiat-
ing patch of a surface at each of n wavenumber intervals,
and that one knows how to correct for the eﬀects of line-
of-sight (LOS) attenuation and contamination by radiance
from other sources. One then has n equations of the form
(1), but n+1 unknowns, including the surface temperature.
In the absence of knowledge about T or ǫk from extraneous
sources, one has an underdetermined problem.

A variety of methods has been proposed for handling the
temperature-emissivity separation (TES) problem. In most
approaches to this problem, simultaneous LST and band
emissivity retrieval depends upon specifying an emissivity
value in one or more reference bands. The MODIS Land
Surface Temperature (LST) algorithm[1] seeks a pair of ref-
erence channels in a part of the thermal spectrum in which
the emissivity of natural surfaces displays very limited vari-
ation, and may therefore be regarded as known with good
conﬁdence. Multiband emissvities inferred on this basis are
called ”relative” emissivities[2]. Algorithms using this ap-
proach include the reference channel method[3] and emis-
sivity normalization[4]. In the former, a value of emissivity
is assumed for one band, and in the latter, an approximate
surface temperature is obtained by noting that emissivity

cannot exceed unity, in order to close the system of equa-
tions. Other relative emissivity retrieval methods include
the temperature-independent spectral index method[5] and
spectral ratios[6]. The study by Li et al.[2] shows that all of
these relative emissivity retrieval algorithms are closely re-
lated, and argues that they may be expected to show com-
parable performance. A diﬀerent approach has been pro-
posed for analysis of Multispectral Thermal Imager (MTI)
data[7], in which radiances are collected from a surface with
looks at nadir and 60 degrees oﬀ-nadir, assuming a known
angular dependence of emissivity, in order to balance equa-
tions and unknowns. The physics-based MODIS LST algo-
rithm[1] exploits observations taken at day and at night, on
the assumption that band emissivites do not change over
periods of a few weeks.

It is clear that the methods described depend upon a pri-
ori assumptions about the variation of emissivity, either
with wavelength, or with look angle, or over time, from
which one would like to be free. The approach taken in
this work diﬀers from most approaches to TES in two ways:
First, the algorithmic approach to be described uses radio-
metric inversion. That is, it explicitly inverts the equa-
tion of transfer in order to infer surface properties from
radiance incident upon a sensor aperture. By contrast, an
approach relying upon semiempirical regression analyses
relating surface temperature to brightness temperature in
multiple bands has been used for many years with AVHRR
data, and is advertised as the preferred method for MODIS.
Second, it uses a Bayesian approach to inference of surface
parameters. This approach allows one to treat emissivities
as ”nuisance” parameters which may be integrated out of
a posterior distribution function between parsimoniously
chosen, and hence ”uninformative,” limits.

It might appear odd to use as an approach to the sepa-
ration of temperature and emissivity a Bayesian estimator
which, in essence, allows one to ignore the actual value of
emissivity. Equation (1) shows that radiance is linear in
emissivity. However, the Planck function goes as a fairly
high power of the temperature in the LWIR, and is close to
exponential in temperature in the MWIR. Any roughness
in the treatment of sensed radiance-as in allowing the as-
sumed emissivity in the estimator to take on a wide range
of values-may, therefore, be expected to lead to compara-
tively small errors in the inferred surface temperature. In
fact, it turns out that the posterior distribution for surface
temperature to be developed gives sharp limits to allowable
surface temperature even in the presence of considerable
latitude in the value of possible emissivities. In most cases,
only a narrow range of surface temperature is consistent
with the sensed radiance in multiple bands, whatever be
assumed about emissivity.

Once a reasonably good estimate of surface temperature
is in hand, it is a simple matter to insert it into estimators
for the individual band emissivities, and for the uncertainty
in those values consistent with available knowledge. The
a priori limits on emissivity may then be contracted, and
a new estimate of surface temperature obtained. The ex-

2

pectation values of surface temperature and emissivity may
thus be reﬁned iteratively. It is also possible to search for a
(local) maximum for the posterior likelihood for these pa-
rameters. Because the TES problem is underdetermined,
this will not give a unique global maximum, but, given
the insensitivity of surface temperature estimates to small
emissivity errors, the local maximum can be expected to
give results close to the physical values for the parameters
of interest.

III. Maximum Entropy Estimators for Surface

Parameters

Consider the problem of estimating surface temperature
and emissivity from radiance detected by a remote sen-
sor. The sensor supplies measurements of radiance I at
the aperture. A forward model is required to compute the
value of aperture radiance as a function of, among other
things, the parameters we wish to extract. Assume for con-
venience that the sensor has very ﬁne spectral resolution.
For a Lambertian surface bounding a plane-parallel atmo-
sphere with rectilinear propagation, the forward model ra-
diance may be described at each wavenumber k by a form
of the Duntley equation

IF (k) = ǫkBk(T )exp(

)+ρkI ↓

k (0)exp(

)+I ↑

k (τ ) (2)

τk
µ

−

τk
µ

−

k (τ ) and I ↓
I ↑
k (0) are the upwelling radiance at nadir optical
depth τ (top of the atmosphere, or TOA, for spaceborne
sensors; µ is the cosine of the angle with respect to zenith)
and the downwelling radiance at the surface, respectively.
Bk(T ) is the Planck function at surface temperature T .
The emissivity is ǫk, and the surface reﬂectance ρk = 1
ǫk.
In what follows it will be assumed that the only unknown
quantities in the preceding equation are T and ǫk. Gen-
eralization of the analysis which follows to the case of re-
ﬂectance not equal to one minus the emissivity poses no
diﬃculties.

−

An estimator for the probability that, given observed ra-
diances I(k), the surface parameters T and ǫk take on par-
ticular values, is constructed in the following way (vide. the
dissertation of Bretthorst[8] and references cited therein;
also a related discussion in Landau and Lifschitz[9], pp.
343-5). The posterior probability for T and ǫk is given by
Bayes’ theorem as

P (T, ǫk

I, K) = P (T, ǫk

K)

|

P (I

T, ǫk, K)
K)

|
P (I

|

|

(3)

where K denotes available knowledge. The quantity P (I
|
K), the prior probability of the radiance I, may be ab-
sorbed into an overall normalization and does not concern
us further.
It may be that the surface T is of interest,
whatever the value of emissivity. In this case, one is free
to denigrate ǫk as a ”nuisance” parameter and integrate it
out of (3), as will be done below.

Consider the remaining factors in (3) in turn, starting
T, ǫk, K) of observing ra-
with the direct probability P (I
diance I given T , ǫk, and other a priori knowledge K.

|

With aid of the forward model, it is possible to recast this
quantity in more tractable form. By hypothesis,

and assigning the prior probability

g(T ′, ǫ′)dT ′dǫ′

I(k) = IF (k) + ek

(4)

where the error in spectral radiance ek is attributed to
noise processes. The prior probability for the noise P (ek
|
T, ǫk, K) is now obtained by a maximum entropy argument.
If the noise power is assumed known, the noise probability
is the function which maximizes the information-theoretic
entropy subject to constraints imposed by the value of the
noise power and overall normalization of probability,

+∞

S =

+∞

−∞

−

Z
e2P (e

|

λ1

−∞

Z

P (e

K)log(P (e

K))de

|

−

|

−

+∞

−∞

Z

|

K)de

λ2

P (e

K)de.

(5)

The function maximizing (5) is a Gaussian,

P (e

K) =

|

1
√2πσ

exp

e2
2σ2

(cid:21)

−

(cid:20)

where the Lagrange multipliers for noise power and nor-
malization have been written in terms of the RMS noise
radiance σ. Upon substituting (4) for the noise term, the
probability of detecting a radiance I given T , ǫ, and noise
σ becomes

P (I

T, ǫ, σ) = exp

|

(I

IF )2

−
2σ2

dI
σ

(cid:21)

−

(cid:20)

This is also the likelihood function for T and ǫ. In order to
formulate an estimator for T and ǫ, it remains to ﬁnd the
prior probability

where

(6)

(7)

In order for the pair to agree as to the form of the estimator,
the priors must be related by

g(T ′, ǫ′)dT ′dǫ′ = J −1f (T, ǫ)dT dǫ

where

J = det

∂(T ′, ǫ′)
∂(T, ǫ)

(cid:20)
is the Jacobian determinant for the transformation between
descriptions in the parameter space.

(cid:21)

Assuming both are sober, Vladimir and Estragon must
always be able to relate their descriptions of the sensed ra-
diance by a Lorentz transformation. Let us consider active
transformations for concreteness. Suppose that Vladimir
wishes to describe events in a frame of reference moving
at velocity β = v/c along the observation axis, denoted
x, with respect to the frame preferred by Estragon.
(It
is convenient, although not actually necessary, to suppose
that the x axis is also the axis of photon propagation.)
Lorentz invariance requires that Vladimir’s (unprimed) and
Estragon’s (primed) description of events be invariant un-
der any Lorentz transformation

P (T, ǫ

K) = f (T, ǫ)dT dǫ

(8)

|

(The appropriate prior for noise is known to be the Jeﬀreys
form, but is omitted here because it is assumed that the
noise contribution is known.)

We now follow Jaynes’ prescription for ﬁnding an unin-
formative prior probability[10],[11],[12]. Assume two equiv-
alent observers record the same sensor aperture radiance,
and interpret it as greybody emission characterized by a
surface temperature and emissivities, and subject to LOS
attenuation. Vladimir detects surface thermal emission I
in a solid angle Ω, and describes the surface with parame-
ters T and ǫ, and the attenuation with optical depth τ
µ :

He assigns prior probability in light of his knowledge re-
garding the problem

I = ǫkBk(T )exp(

τk
µ

)

−

f (T, ǫ)dT dǫ

(9)

(10)

On the other hand, Estragon agrees with Vladimir on the
deﬁnition of the Planck function, emissivity, and LOS at-
tenuation, but describes the same situation with surface
emission I ′ in Ω’, and parameters T ′, ǫ′, and τ
µ′ , reporting

′

I ′ = ǫ′

k′ Bk′ (T ′)exp(

τ ′
k′
µ′ )

−

Estragon and Vladimir relate their description of time in-
p
tervals by

so their descriptions of frequency or wavenumber are re-
lated by

where γ is real and positive.

How does the pair relate their descriptions of radiance?
Let a bundle of δn photons with mean energy p0 = ¯hck
and uncertainty δp0 = ¯hcδk originate in a small area δA of
the radiating surface in a small time interval δt, collimated
within a small solid angle δΩ, and propagate unattenu-
ated to an observer. The surviving photons arriving at the
observer’s location comprise a collisionless photon gas. A
single photon in the bundle occupies a phase space volume

Vx

Vk = δA(cδt)

×

¯h3k2δkδΩ

×

while the bundle occupies a 6 δn-dimensional phase space
volume

Vphase = [VxVk]δn

Equation (21) is a Lorentz invariant at any point on a pho-
ton trajectory. By Liouville’s theorem, it has the same
value at every point on that trajectory. So long as the

(11)

x = γ(x′

βt′)

t = γ(t′

βx′)

−

−

1

γ =

β2

1

−

∆t = γ∆t′

k′ = γk

3

(12)

(13)

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

photons remain collisionless they can neither leave their
original volume of phase space, nor enter another. How-
ever Vladimir or Estragon choose to describe the patch of
emitting surface δA, the time interval δt, the solid angle
interval δΩ or the photon wavenumber k, they must agree
as to the number of photons δn in the bundle. Hence, both
(20) and the ratio

N =

δn
VxVk

=

δn
¯h3δAδtk2δkδΩ

are invariant along a photon trajectory.

Spectral radiance is deﬁned as

Ik

≡

d(energy)
d(time)d(area)d(f requency)d(solidangle)

.

(23)

Rewriting the radiance as

Ik =

¯hkδn
δAδtδkδΩ

= ¯h4k3N,

gives

Ik
k3 = invariant
for any component of the total radiance along a given line
of sight[13]. Equation (25) prescribes the value of a Lorentz
scalar, and therefore holds in any inertial frame[14], with
two consequences for this problem:
1. The Planck function obeys

(25)

or

the right-hand side can have no dependence upon T or T ′,
while the left-hand side cannot be an arbitrary function of
g or k. The only remaining possibility is

Bk(T ′/γ)
Bk(T )

ǫk
ǫ′
γk

=

= const.

(22)

The set of Lorentz transformations forms a group[15], so
this relation holds for γ = 1. The constant must therefore
equal unity.

Next allow τ to diﬀer from zero in (28). In

k3ǫ′
k′ Bk′ (T ′)
k′3ǫkBk(T )

=

exp(

exp(

τk
µ )
τ ′
k′
µ′ )

−

−

the left-hand side has, by hypothesis, no dependence upon
LOS transmission, while the right-hand has no dependence
upon surface properties so, again, both sides equal a con-
stant, and, from (26) and (34), we ﬁnd

(24)

k3ǫ′
k′ Bk′ (T ′)
k′3ǫkBk(T )

=

ǫ′
γk′Bγk(γT )
ǫkγ3Bk(T )

= 1

(36)

−
LOS attenuation does not aﬀect the validity of (34).

(26)

Thus, the most general relation which respects a Lorentz

transformation carrying wavenumber k to k′ = γk is

Bγk(γT )
γ3

= Bk(T )

as may also be seen by direct substitution in

Bk(T ) =

1
π2

exp

k3
¯hck
kB T

.

1

−

i
2. Vladimir and Estragon must agree that

i

h

h

ǫ′
k′ Bk′ (T ′)exp(

′
τ
k′
µ′ )

−

=

ǫkBk(T )exp(

τk
µ )

−

k3

k′3

(28)

and

Consider ﬁrst the case of no attenuation, τ = 0. Then

The Jacobian is therefore

f (T, ǫk) = γg(γT, ǫ′

(41)
Invocation of the principle of indiﬀerence1 to assert Es-
tragon and Vladimir must use the identical description of
events, and thus assign the same prior probabilities,

γk).

or

ǫ′
k′ Bk′ (T ′)
k′3

=

ǫkBk(T )
k3

k′ Bk′ (T ′) = γ3ǫkBk(T ).
ǫ′

Bγk(T ) = γ3Bk(T /γ).

k′ Bk′ (T ′/γ) = ǫkBk(T ).
ǫ′

One also has, from (23),

leads to the functional equation

Combining (19), (30), and (31) gives

The solution of (43) is

Now, Vladimir and Estragon also agree that, while they
must lie between 0 and 1, emissivities are otherwise com-
pletely arbitrary functions of wavenumber, and by hypoth-
esis have no dependence upon temperature. In

yielding

Bk(T ′/γ)
Bk(T )

=

ǫk
ǫ′
γk

f (T, ǫ)dT dǫ =

dT dǫ

(45)

(33)

1As given by Jaynes[10], p. 128, in an extension of the original
concept introduced by Laplace to encompass indiﬀerence between de-
scriptions by distinct but equally cogent observers.

exp(

exp(

−

τk
µ )
τ ′
k′
µ′ )

= 1

T ′ = γT

ǫ′
k′ = ǫ′

γk = ǫk.

J = γ

f (T, ǫ) = g(T, ǫ)

f (T, ǫk) = γf (γT, ǫk).

f (T, ǫ) =

const.
T

const.
T

(27)

(29)

(30)

(31)

(32)

4

(34)

(35)

(37)

(38)

(39)

(40)

(42)

(43)

(44)

for the prior probability.

One now argues this form of the prior is least informative
as to emissivity. No functional dependence upon a param-
eter should enter the form of the prior probability that is
not imposed by the requirements of invariance and indiﬀer-
ence. Any such dependence would amount to the admission
that we possess additional knowledge about emissivity be-
yond that assumed. That is, (45) is the unique choice of
prior probability that assumes nothing about the value of
ǫk beyond what is dictated by the problem statement. A
standard argument (found, for example, in [8], pp. 9-15)
then shows that prior knowledge about limits on the value
of emissivity should appear in the limits of integration used
in constructing marginal distributions for T .

Surface temperature thus obeys the Jeﬀreys prior, while
emissivity obeys the Bayes prior. Both results may appear
somewhat surprising, especially that for emissivity. From
the manner in which it appears in the expression for radi-
ance, one’s naive expectation might be that emissivity is
a scale parameter. However, the relation between the de-
scription of emissivity as seen by Vladimir and Estragon
more resembles what one would expect of a location pa-
rameter: They must agree on the value of emissivity, but
are free to assign it to diﬀerent wavenumbers.

The result just obtained will now be extended to the sit-
uation in which radiance is sensed in bands wide enough
that that it cannot be regarded as a function of wavenum-
ber, but must be treated as an integral over a passband.
One then writes, for the contribution of surface emission
to the total radiance at the sensor aperture in band i,

k2

k1

Z

τk
µ

−

)dk

ǫi

≡

k2

k1

Z

ǫkBk(T )exp(

Bk(T )exp(

)dk (46)

k2

It is always possible to do this by the mean value theo-
rem for integrals, and it is frequently the case that the
right-hand side of (46) expresses all available knowledge
concerning the radiant properties of the emitting surface.

Vladimir describes the surface emission by

ǫi

Bk(T )exp(

)dk =

ǫkBk(T )exp(

)dk (47)

τk
µ

−

τk
µ

−

k2

k1

Z
with

τk
µ

−

k2

k1

Z

0, k < k1

ǫi, k1

k

k2

≤
≤
0, k > k2

ǫ(k) =






while, by (37)-(39), Estragon describes things by

γk2

γk1

Z

kB′
ǫ′

k(γT )exp(

τ ′
k′
µ′ )dk′

−

γk2

ǫi

≡

γk1

Z

B′

k(γT )exp(

τ ′
k′
µ′ )dk′

−

(48)

where

with

0, k′ < γk1

ǫi, γk1

k′

γk2

≤
≤
0, k′ > γk2

ǫ′(k′) =






5

(49)

(50)

(52)

(53)

Comparison of the two expressions for surface emission,
(47) and (48), leads to the immediate conclusion that the
Jacobian connecting the two descriptions of surface tem-
perature and band emissivity is

J = det

∂(T ′, ǫ′)
∂(T, ǫ)

(cid:21)

(cid:20)

= γ,

f (T, ǫ)dT dǫ =

const.
T

T dǫ

and

once more.

k2

k1

"Z

k2

k1

"Z

k2

As an application of these results, consider the marginal
posterior probability for T given observation of radiance
at a ﬁnite number of wavenumbers given that the surface
emissivity in band i is known to lie between ǫmin(i) and
ǫmax(i). From (2), deﬁne

a =

(Bk(T )

Ik

(0)) exp(

)dk

,

(51)

τk
µ

−

2

#

−

↓

b = b1b2

with

and

b1 = 2

(Bk(T )

Ik

(0)) exp(

−

↓

τk
µ

−

)dk

#

b2 =

Ik

(0)exp(

) + Ik

(τ )

dk

"Z

k1 (cid:18)

↓

↑

(cid:19)

Ii

,

#

−

(54)

τk
µ

−

c =

Ik

(0)exp(

) + Ik

(τ )

dk

Ii

(55)

"Z

k1 (cid:18)

↓

↑

(cid:19)

−

#

τk
µ

−

2

Then (dropping subscript i for the moment) (3) and (7)
give

P (T

I, ǫ, σ)

|

1
√2πσ

∝

exp

(aǫ2 + bǫ + c)
2σ2

(cid:21)

−

(cid:20)

(56)

The marginal distribution obtained by integrating over the
nuisance parameter ǫ is

P (T

I, σ)

1
√2πσ

∝

ǫmax

exp

ǫmin

Z

−

(cid:20)

(aǫ2 + bǫ + c)
2σ2

(cid:21)

dǫ (57)

Completing the square in the exponent allows this to be
written as

P (T

I, σ)

1
√a

∝

exp

c
"− (cid:2)

b2/4a
2σ2

−

#

(cid:3)

H(ǫmax, ǫmin) (58)

|

|

H(ǫmax, ǫmin) = erf

a/2(ǫmax + b/2a)

" p

erf

−

" p

σ

σ

#

#

a/2(ǫmin + b/2a)

(59)

for each band i. The joint posterior probability for observ-
ing radiances Ii, i = 1, n is

P (T

Ii,i=1,n, σ) =

P (T

Ii, σ)

(60)

|

|

n

i=1
Y

R

R

R

and an estimator for T is

=

T
h

i

Tmax
Tmin T P (T
Tmax
Tmin P (T

R

Ii,i=1,n, σ) dT
T
|
Ii,i=1,n, σ) dT
T

|

(61)

if T is known to lie between a minimum and a maximum,
or

Tmax
Tmin P (T
Tmax
Tmin P (T
An estimator for the emissivity in band i is given by

Ii,i=1,n, σ)dT
Ii,i=1,n, σ) dT
T

T
h

=

R

i

|

|

R

(62)

=

ǫ
h

i

ǫmax
ǫmin ǫP (T
ǫmax
ǫmin P (T

|

|

Ii,i=1,n, σ)dǫ

Ii,i=1,n, σ)dǫ

(63)

This form has the advantage that estimates of the surface
T are signiﬁcantly less sensitive to discrepancies between
sensed and modeled radiances than are estimates of emis-
sivity. An estimate of T obtained from (58) and (61) with
uninformative limits on emissivity may be close enough in
practice for accurate emissivity retrievals by (63). (Equa-
tion (63) may be evaluated in closed form with elementary
functions; however, the resulting expression is quite cum-
bersome and is omitted here.)

IV. Monte Carlo Simulation of MODIS Land

Surface Temperature Retrieval

A land surface temperature retrieval algorithm has been
developed using the results just derived. While the intent of
the work reported in this paper is to unshackle LST estima-
tion from emissivity knowledge, the algorithm also retrieves
emissivity estimates, and may be thought of as a TES al-
gorithm if desired. It is purported to be optimal neither in
execution speed nor accuracy, although the requirement for
only one forward model calculation per retrieval suggests
that it will not impose an extreme computational burden
in practice. The algorithm is used to simulate LST re-
trieval from a notional exoatmospheric sensor that records
radiance from a patch of the Earth’s surface at a speciﬁed
signal-to-noise ratio(SNR). It is assumed that the domi-
nant noise contribution arises from the shot noise of the
radiance incident upon the sensor aperture.

The starting point is the posterior distribution for sur-
face temperature (58). To compute it, the coeﬃcients a(T ),
b(T ), and c given by (51)-(55) are obtained as a function
of surface temperature.
Isaacs two-stream MODTRAN4
calculations supply those forward-model spectral quanti-
ties which are independent of surface temperature: Up-
welling radiance at TOA, downwelling radiance at the sur-
face, and LOS attenuation. The forward model assumes
perfect knowledge of atmospheric parameters, but is com-
puted with the surface albedo parameter SALB=1.00 for

6

all bands (i.e., surface emission in the model is completely
suppressed.) The surface thermal emission component is
computed directly from the Planck function and spectral
attenuation.

It should be noted that the MODTRAN-computed quan-
tities used in the forward model have no dependence upon
true surface temperature or emissivity. Because SALB is
forced to equal unity, the boundary temperature parameter
used in MODTRAN has close to no eﬀect on the forward
radiance calculations. However, it should not diﬀer greatly
from a physically reasonable value, since MODTRAN ad-
justs the atmospheric temperature proﬁle in the lower zones
to interpolate smoothly between surface conditions and a
ﬁducial layer in the atmosphere.

In outline, the algorithm works as follows. Equation
(58) gives the distribution of surface temperature consis-
tent with observed radiances and the initial range of emis-
sivities. This distribution typically diﬀers from zero only
within a narrow range about the true surface temperature.
Within this range, (62) is used for each of n bands and
for all bands jointly to compute n + 1 separate estimates
of the surface temperature. The actual surface tempera-
ture is assumed to lie between the extreme values of this
set of expected values, which now determine the allowable
range. The joint temperature distribution and the various
expectation values for surface temperature are next reﬁned
using the contracted range of a-priori credible surface tem-
peratures in (58), now calculated with a ﬁner temperature
mesh. After a few iterations of this procedure, the diﬀerent
surface temperature expectation values obtained from (62)
reliably converge to a single value lying close to the true
surface temperature. A convergence radius for the diﬀer-
ent estimates of 0.01 K was used. Emissivities are then ob-
tained by substitution of the joint surface temperature es-
timate into the expression for band emissivity expectation
values, (63). Equation (56) being a Gaussian distribtuion,
it is possible to reﬁne the a-priori limits on credible emis-
sivites by specifying a threshold of m standard deviations.
Six is used for the examples presented here. The revised a-
priori emissivity limits and surface temperature limits may
then be used to restart the entire sequence just outlined, if
desired. This additional iterative loop was omitted in the
simulations to be presented.

Monte Carlo simulations of LST retrieval in a selected
subset of MODIS bands illustrate the performance of the
algorithm. The bands chosen appear in Table 1. MOD-
TRAN calculations are used both as simulated TOA ra-
diances in MODIS bands and as the forward model. Each
Monte Carlo realization of TOA radiance is calculated with
MODTRAN parameters listed in Table 2 selected as uni-
form deviates within the limits shown. A second draw in-
troduces errors for the fallible forward model as shown in
the last column. Thus, for examples, the surface visibility,
which MODTRAN uses to parameterize aerosol eﬀects, is
chosen to lie between 5 and 30 km for each Monte Carlo
4 km is added to
realization. A random error of up to
this value of visibility for use in calculation of the fallible

±

7

(67)

forward model for each realization. The surface temper-
20K. Surface
ature is varied randomly from ”truth” by
emissivities in all bands are chosen to lie randomly between
0.75 and 0.99.

±

One thousand Monte Carlo realizations each were calcu-
lated for day and night, with a mid-latitude summer at-
mosphere. Generous bounds for the initial a-priori limits
on LST and band emissivity were assumed, subject to the
physical upper bound on surface emissivity:

Table 1. MODIS bands used in simulations

MODIS band wavelength limits

notional snr

20
21
23
29
31
32

3.660-3.840 µ
3.929 − 3.989µ
4.020-4.080 µ
8.400-8.700 µ
10.870-11.280 µ
11.770-12.270 µ

350
350
350
1000
1000
1000

Table 2. Monte Carlo parameter ranges

MODTRAN
parameter

minimum
value

maximum fallible forward
value

model error

nadir view angle
surface visibility
column water vapor
thin cirrus altitude
thin cirrus thickness
thin cirrus opacity
solar azimuth
solar elevation
viewng azimuth
viewing elevation

180 deg
30 km

125 deg
5 km
0.33 × MLS 1.00
8 km
1 m
0.05/km
0 deg
20 deg
0 deg
35 deg

12 km
20 m
0.2/km
90 deg
60 deg
90 deg
90 deg

±0.125 deg
± 4 km
±0.2
±0.5 km
±25 m
±0.025/km
±0.125 deg
±0.125 deg
±0.125 deg
±0.125 deg

Next, the simulated MODIS TOA radiances are contam-
inated with notional sensor noise. Finally, the algorithm
requires an estimated variance for the noise radiance, pa-
rameterized in terms of a signal-to-noise ratio. SNR was
chosen to lie on the low end of values inferred from MODIS
N E∆T values[16] with the aid of the following estimate.
The error in TOA radiance from noise sources is estimated
as, roughly,

δI =

δT + O(δT )2

∂I
∂T

∂Is
∂T

∼=

N E∆T

(64)

where

Is = ǫ

Bk(T )exp(

)dk

(65)

τk
µ

−

Z∆k

is the attenuated surface thermal emission at TOA, leading
to

SN R =

−1

δI
I

(cid:18)

(cid:19)

∼=

(cid:18)

∂log(Is)
∂T

−1

(cid:19)

N E∆T

(66)

This quantity was computed for each Monte Carlo realiza-
tion; the SNR values used for the retrievals, which apppear
in Table 1, conservatively underestimate (66). Performance
of the algorithm appears not too sensitive to the exact noise
contamination added to the simulated band radiances, or
to the exact SNR assumed in the retrieval, as long as nei-
ther is grossly erroneous.

200K
0.7

T
ǫi

≤
≤

≤
≤

500K
0.99

Note that the lower limit for emissivities, and both limits
for LST, lie outside the range sampled by the Monte Carlo
draws. Summary statistics for the LST and emissivity re-
trievals appear in Table 3.

Table 3. Monte Carlo mean errors,
standard deviations

Case

Day

Night

+0.90 ± 1.30

LST error(K) +0.89 ± 1.33
ǫ20 error
ǫ21 error
ǫ23 error
ǫ29 error
ǫ31 error
ǫ32 error

−0.011 ± 0.026 −0.010 ± 0.024
−0.017 ± 0.036 −0.018 ± 0.035
−0.020 ± 0.052 −0.025 ± 0.051
−0.016 ± 0.033 −0.016 ± 0.032
−0.008 ± 0.025 −0.007 ± 0.025
−0.012 ± 0.031 −0.012 ± 0.030

≤

In the majority of cases, acceptable estimates of LST
and band emissvities were obtained using all six bands
from Table 2, with the SNR chosen to equal the assumed
noise variance in the simulations which appears in Table
1. However, in a small number of simulations (two night-
time, nine daytime, for the simulations presented here) it
proved impossible to ﬁnd an acceptable solution with all six
bands. The solution instead tended to badly erroneous val-
ues (e.g., T
100K, and emissivities pegged at the lmits
of the prior). Inspection of the posterior probabilities from
(61) revealed that in these anomalous cases one or more of
the individual band posterior probabilities fails to overlap
signiﬁcantly with the product of the remaining posterior
distributions, leading to a joint posterior probability that
eﬀectively vanishes. This phenomenon is presumably re-
latated to the fact that the number of ”anomalous” cases
decreases notably when the lower bound on the band emis-
sivity prior is reduced to 0.7, even though the minimum
value used in the Monte Carlo realizations was 0.75. Ex-
perimentation showed that, in all of the anomalous cases, it
was possible to get a satisfactory LST retrieval with some
three-band subset of the original six. The LST so obtained
could then be inserted into the expectation value for band
emissivity to yield emisssivities for all six bands. In some
cases it proved necessary to reduce the assumed SNR for
outlier bands.

The anomalous cases tend to have one or more of the
randomly-varied simulation parameters lie at the limits of
their assumed uniform distributions, which suggests that
the diﬃculty might be an artifact of the way the Monte
Carlo draws were made. Thus, none of the truth values
for the daytime anomalous T -retrievals lay in the middle
of the range of the simulations. All but one lay near the

lower end of that range. In any event, all 2000 Monte Carlo
realizations led to a successsful retrieval of both LST and
six band emissivities.

Examination of the χ2 statistic for the retrieval errors
shows that the estimator is (slightly) biased. For the 991
”normal” daytime temperature retrievals, χ2 is 1.48 per
degree of freedom. The corresponding values for surface
emissivity range between 1.1 and 1.26 per degree of free-
dom. The values for anomalous retrievals are 1.22 per de-
gree of freedom for surface temperature, and between 0.95
and 3.7 per degree of freedom for emissvities. However, the
distribution of errors is very accurately Gaussian (as should
be expected). If the mean error is subtracted before calcu-
lating χ2 for all daytime retrievals, the result is identically
0.999 per degree of freedom for surface temperature and all
six band emissivities.

A t-means test shows that the anomalous retrievals have
signiﬁcantly diﬀerent mean errors from the normal ones.
Despite this, the accuracy of retrievals from the anomalous
cases does not actually depart greatly from that of the rest
of the simulation. The mean temperature error is
±
1.78K (anomalous), to be compared with 0.89K
1.33K
(normal), while the worst mean emissivity discrepancy is

1.03K

±

−

0.06

0.06.

−

±

V. Discussion

Points which should be addressed in further develop-

ments of practical algorithms:

1. It appears that this approach to TES works largely
because the range of plausible surface temperature values
consistent with band radiances and an uninformative range
of band emissivity is quite constricted, as a consequence of
the strong temperature dependence of the Planck function.
It turns out not to be terribly diﬃcult to get a tempera-
ture estimate that is close enough to truth that it can be
inserted into the least sophisticated imaginable estimator
for band emissivity (63), and still lead to acceptably accu-
rate results.

Once the algorithm has gotten to an iteration in which
the current expectation values for temperature and band
emissivities are close enough to the true values that the
posterior distribution is jointly Gaussian in T as well as in
the ǫi, it is apparent both that convergence to the true val-
ues will occur as assumed in this algorithm, and that these
values will maximize the likelihood. However, at present,
there is no proof in hand that the procedure outlined above
actually converges, or that, given that it does, it converges
to the true surface temperature and emissivity combina-
tion. It appears to do both to good accuracy in practice.

However, the algorithm did-initially-fail to converge to
an acceptable solution in about 1% of the realizations. As
recounted in the previous section, it proved possible in ev-
ery case to adapt the search strategy so as to successfully
retrieve both LST and emissivities for all bands. The suc-
cessful recovery strategies all had the eﬀect of maximizing
the numerical joint posterior probability, by some combi-
nation of 1) eliminating from the estimator band poste-

8

rior probabilities whose eﬀective nonvanishing support did
not intersect that of the joint probability of the remaining
bands, or forcing intersection by broadening the support of
the outlier posterior probabilities by 2) loosening limits on
the prior, or 3) reducing the assumed SNR of some bands
in the retrieval.

The solutions obtained are, in any event, not unique,
because the TES problem is underdetermined. Considered
as a surrogate for maximum likelihood solutions, the al-
gorithm solutions approximate only local maxima, and it
might be possible to ﬁnd maxima which give a poor account
of temperature and emissivity. This has not happened in
simulations performed to date.

2. The algorithm as presently formulated appears to be
unnecessarily complicated. It seems certain that it sopera-
tion can be signiﬁcantly streamlined. For practical applica-
tions, it will be necessary to eliminate redundant elements
of the calculation.

3. The model for band radiances in this memo treated
them independently, apart from the prior knowledge that
the surface temperature for all bands must be the same.
The bulk of Bretthorst’s 1987 dissertation[8] addresses
problems involving more sophisticated models for obser-
vations, which would appear to oﬀer real advantages in the
present context.

4. Perhaps the least satisfactory feature of this algo-
rithmic approach is its dependence upon an accurate for-
ward radiance model. To the extent MODTRAN can be
regarded as supplying radiance estimates which are zero-
mean error estimates of the true radiance, the eﬀect of
radiance prediction error on this algorithm may simply be
regarded as a contribution to the noise variance. But in real
life, a forward model can be expected to have systematic
errors that need not originate as unbiased stationary Gaus-
sian processes. The question whch has been addressed in
this work is: Given an accurate forward model (in the sense
just described), what surface temperature and band emis-
sivities are consistent with observed radiances and knowl-
edge of their error statistics? A harder question, which will
be the focus of further developments, is: Given a fallible,
but reasonably accurate, forward model, what surface tem-
peratures and band emissivities can possibly be consistent
with observations and available knowledge, no matter what
the forward model error, so long as it falls within known
limits?

VI. Conclusion

A simple argument, based on inherent physical symme-
tries that the description of surface thermal emission must
obey, leads to the appropriate prior probabilities for surface
temperature and emissivity. These lead to the maximum
entropy estimator for inversion of the Duntley equation in
the presence of noise, from which an estimator of surface
temperature may be constructed that treats emissivity as a
nuisance parameter. MODTRAN-based simulations show
that temperature-emissivity separation is successfully per-
formed by iteration between the temperature estimator,

9

and a similar estimator for surface emissivity.

References

[1] Wan, Z.-M., MODIS Land-Surface Temperature Algorithm The-
oretical Basis Document, Institute for Computational Earth Sys-
tem Science, University of California, Santa Barbara, 1999

[2] Li Z.-L.,F. Becker, M. P. Stoll, and Z. Wan, ”Evaluation of Six
Methods for Extracting Relative Emissivity Spectra from Ther-
mal Infrared Images,” Rem. Sens. Env., vol. 69, pp. 197-214, 1999
[3] Kahle, A. B., and R. E. Alley, ”Separation of Temperature and
Emittance in Remotely Sensed Radiance Measurements,” Rem.
Sens. Env., vol. 42, pp. 107-111, 1992

[4] Kealy, P. S., and S. J. Hook, ”Separating Temperature and Emis-
sivity in Thermal Infrared Multispectral Scanner Data: Implica-
tions for Recovering Land Surface Temperatures,” IEEE Trans.
Geosci. Remote Sensing, vol. 31, pp. 1155-1164, 1993

[5] Li Z.-L., and F. Becker, ”Feasibility of Land Surface Temperature
and Emissivity Determination from AVHRR Data,” Rem. Sens.
Env., vol. 43, pp. 67-85, 1993

[6] Watson, K., ”Spectral Ratio Method for Measuring Emissivity,”

Rem. Sems. Env., vol. 42, pp. 113-116, 1992

[7] Borel, C. C., and J. . Szymanski, ”Physics-based Water and Land
Temperature Retrieval,” in Handbook of Science Algorithms for
the Multispectral Thermal Imager, B. W. Smith, Ed., Los Alamos
National Laboratory and Savannah River Technology Center,
1998

[8] Bretthorst, L., Bayesian Spectral Analysis and Parameter Esti-
mation, Dissertation, Washington University, St. Louis, MO, 1987
[9] Landau, L. D., annd L. Lifshcitz, Statistical Physics, Addison-

Wesley: Reading, MA, 1958

[10] Jaynes, E., ”Prior Probabilities,” IEEE Trans. on Systems Sci-

ence and Cybernetics, vol. SSC-4, pp. 227-241, 1968

[11] Jaynes, E., ”The Well-Posed Problem,” Found. Physics 3, pp.

477-493, 1973

[12] Jaynes, E., ”Marginalization and Prior Probabilities,” in
Bayesian Analysis in Econometrics and Statitstics, A. Zellner,
Ed., North-Holland Publishing Co.: Amsterdam, 1980

[13] Misner, C. W., K. S. Thorne, and J. A. Wheeler, Gravitation,

Freeman: San Francisco, 1973

[14] Weinberg, S., Gravitation and Cosmology, John Wiley and Sons:

New York, 1972

[15] Einstein, A., ”Zur elektrodynamik bewegter K¨orper,” Ann.

Physik, vol. 17, pp. 891-921, 1905

[16] Guenther, B., X. Xiong, V. V. Salmonson, W. L. Barnes, and
J. Young, ”On-orbit perfromance of the Earth Observing System
Moderate Resolution Spectroradiometer; ﬁrst year of data,” Rem.
Sens. Env. 83, pp. 16-30, 2002

