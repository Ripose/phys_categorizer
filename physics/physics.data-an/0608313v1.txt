Detrending Moving Average variance:

a derivation of the scaling law

Sergio Arianos∗ and Anna Carbone†

Dipartimento di Fisica,

Politecnico di Torino,

Corso Duca degli Abruzzi 24,

I-10129 Torino, Italy

(Dated: February 9, 2008)

Abstract

The Hurst exponent H of long range correlated series can be estimated by means of the De-

trending Moving Average (DMA) method. A computational tool deﬁned within the algorithm is

the generalized variance σ2

DM A = 1/(N − n)

i[y(i) −

yn(i)]2 , with

yn(i) = 1/n

k y(i − k) the

moving average, n the moving average window and N the dimension of the stochastic series y(i).

P

P

e

e

This ability relies on the property of σ2

DM A to scale as n2H. Here, we analytically show that σ2

DM A

is equivalent to CH n2H for n ≫ 1 and provide an explicit expression for CH .

PACS numbers: 05.40.-a, 05.45.Tp

6
0
0
2
 
g
u
A
 
1
3
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
3
1
3
8
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

INTRODUCTION

Long-memory stochastic processes are ubiquitous in ﬁelds as diﬀerent as condensed mat-

ter, biophysics, social science, climate change, ﬁnance [1, 2, 3, 4]. The development of

methods able to quantify the statistical properties and, in particular, to extract the Hurst

exponent of long-range correlated signals continue therefore to draw the attention not only

of the physicist community [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]. For long-memory corre-

lated processes, the value of the Hurst exponent H ranges from 0 < H < 0.5 and from

0.5 < H < 1 for negative and positive persistence respectively; H = 0.5 is found in fully

uncorrelated signals. Several techniques have been proposed in the literature to study the

scaling properties of time series. We limit ourselves to mention here only a few of them

such as the seminal work by Hurst on rescaled range statistical analysis (R/S), the modiﬁed

R/S analysis, the multi-aﬃne analysis, the detrended ﬂuctuation analysis (DFA), the peri-

odogram regression (GPH) method, the (m,k)-Zipf method, the detrended moving average

analysis (DMA). The challenge is to get the Hurst exponent H, that is related to the fractal
dimension D = 2 − H, by means of more and more accurate and fast algorithms. The meth-

ods of extraction of the scaling exponents from a random signal exploit suitable statistical

functions of the series itself. The rescaled range statistical analysis (R/S) was ﬁrst intro-

duced by Hurst to describe the long-term dependence of water levels in rivers and reservoirs.

It provides a sensitive method for revealing long-run correlations in random processes. This

analysis can distinguish random time series from correlated time series and gives a measure

of a signal roughness. The Detrended Fluctuation Analysis (DFA) is a very popular scaling

technique to estimate the power-law correlation exponents of random signals in the time

domain. Recently, a method called Detrended Moving Average (DMA) technique for the

analysis of the persistence has been proposed [13]. The striking diﬀerence between the DMA

and the previously proposed (R/S, DFA) methods is that a division of the series in boxes is

not needed by the DMA algorithm. The scaling property is obtained by using a simple con-

tinuous function: the moving average. This fact makes the DMA algorithm highly eﬃcient

from the computational point of view. Many properties of the DMA have been studied and

applications have been demonstrated [14].

In this work, we provide an analytical derivation that the DMA variance scales as a power
DM A ∼ CHn2H. The analytical ﬁndings are compared with the

law with exponent 2H, i.e. σ2

2

simulation data obtained by calculating the DMA variance of surrogate Fractional Brownian

motions with diﬀerent values of H, generated by the Random Midpoint Displacement (RMD)

algorithm [16].

METHOD

function:

(1a)

(1b)

(1c)

(1d)

First we describe the main steps of the DMA algorithm. The technique is based on the

σ2
DM A =

N

1
N − n

y(i) − ˜yn(i)

2

i

i=n h
X
n

1
n

˜yn(i) =

y(i − k)

k=0
X
The Eq. (1a) deﬁnes a generalized variance of the random path y(i) with respect to the

moving average

yn(i) (Eq. (1b)). The function

yn(i) is calculated by averaging the n-past

value in each sliding window of length n. In so doing, the reference point of the averaging

process is the last point of the window. The dynamic averaging process and the DMA

e

e

algorithm can be however referred to any point within the window, by generalizing the

Eqs. (1a,1b) as follows:

σ2
DM A =

1
N − n

y(i) − ˜yn(i)

2

i

N −nθ

Xi=n(1−θ) h
n(1−θ)

k=−nθ
X

˜yn(i) =

1
n

y(i − k)

Upon variation of the parameter θ in the range [1, 0], the reference point of

yn(i) is accord-

ingly set within the moving window n. In particular, consider the following three relevant

cases: (i) θ = 0 corresponds to calculate

yn(i) over all the past points within the window

n; (ii) θ = 1

2 corresponds to calculate
window n; (iii) θ = 1 corresponds to calculate

e

yn(i) over n/2 past and n/2 future points within the

yn(i) over all the future points within the

e

window n respectively.

e

e

In order to calculate the Hurst exponent of the series, the DMA algorithm is implemented

as follows. The moving average

yn(i) is calculated for diﬀerent values of the window n, with

e

3

n ranging from 2 to a maximum value nmax determined by the size of the series. The σDM A,

deﬁned by the Eqs.(1a, 1c), is then calculated for all the windows n over the interval [n, N].

For each

yn(i), the value of σDM A corresponding to each

yn(i) is plotted as a function of n

on log-log axes. The most remarkable property of the log-log plot is to exhibit a power-law
e
DM A ∼ CHn2H , allowing thus to calculate the scaling exponent H of

dependence on n, i.e. σ2

e

the signal y(i).

DERIVATION OF THE SCALING RELATIONSHIP

The variance deﬁned by the Eqs.(1) will be analytically deduced in the limit N ≫ n ≫ 1

for fractional Brownian path. The calculation will be performed for the DMA variance with

moving average

yn(i) referred to an arbitrary point within the moving window. We will

prove that:

e

with

DM A ∼ CHn2H ,
σ2

n ≫ 1

CH =

1
2H + 1

(cid:20)
(cid:0)

(1 − θ)2H+1 + θ2H+1

−

1
2(H + 1)(2H + 1)

(cid:21)

(cid:1)

By simple transformation of the Eq. (1c), one obtains:

(N − n)σ2

DM A =

y(i)

y(i − k)

N −θn

N −θn

n−θn

y2(i) − 2
n

i=n−θn
X

i=n−θn
X

k=−θn
X

+

1
n2

N −θn

n−θn

i=n−θn  
X

k=−θn
X

y(i − k)

2

!

(2)

(3)

(4)

Let us consider each term separately. The ﬁrst term on the right hand side of the equation

(4) writes:

y2(i) =

i2H ≃

(N − θn)2H+1 − (n − θn)2H+1

(5)

N −θn

N −θn

i=n−θn
X

i=n−θn
X

1
2H + 1

(cid:2)

(cid:3)

The second term on the right hand side:

N −θn

n−θn

N −θn

i+θn

− 2
n

y(i)

i=n−θn
X

k=−θn
X

y(i − k) = − 2
n

y(i)

y(j)

i=n−θn
X

j=i−n+θn
X

4

(cid:3)

(cid:3)

(N − θn)2H+1 − (n − θn)2H+1

N 2H+2 − n2H+2 − (N − n)2H+2

(cid:3)

≃ − 1

2H + 1
(cid:2)
1
2(H + 1)(2H + 1)

1
n

−

(cid:2)

+

n2H
2H + 1

(cid:2)

(1 − θ)2H+1 + θ2H+1

(N − n)

(6)

(cid:3)

Finally, the third term:

1
n2

≃

N −θn

n−θn

N −θn

i+θn

y(i − k)

2 =

1
n2

2

y(j)

(cid:0)

i=n−θn
X

k=−θn
X
1
2(H + 1)(2H + 1)

1
n

(cid:1)

i=n−θn
X

(cid:2)

j=i+θn−n
X

(cid:3)

N 2H+2 − n2H+2 − (N − n)2H+2

(cid:2)
n2H
2(H + 1)(2H + 1)

−

(N − n)

(7)

(8)

(9)

(10)

Summing the contributions from each term we obtain

DM A ≃
σ2

(1 − θ)2H+1 + θ2H+1

−

1
2H + 1

(cid:20)

(cid:0)

1
2(H + 1)(2H + 1)

n2H

(cid:21)

(cid:1)

One can easily check that σ2

DM A takes the following expressions for θ = 0 and θ = 1 and for

θ = 1/2:

• θ = 0 or θ = 1 ; i.e. when the moving average is referred to the last or to the ﬁrst

point of the window, it is

CH ≃

1
2(H + 1)

• θ = 1

2 : the average is referred to the center of the window

CH ≃

1
2(H + 1)

− 1 − 2−2H
2H + 1

(cid:2)

(cid:3)

The above calculations have been performed for a fractional brownian motion with variance

σ2 = t2H . It can be easily shown that for the general case of a fractional brownian motion
DM A = DHCHn2H .

with variance σ2 = DHt2H , the Eq. (8) will asymptotically behave as σ2

5

TABLE I: Intercept (A) and slope (B) for the curves plotted in Fig.1.

θ = 0

θ = 0.5

θ = 1

H

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

A

-0.73211

-1.48755

-2.23912

-2.99192

-3.72180

-4.45987

-5.17084

-5.84043

-6.51500

B

0.13220

0.21675

0.30962

0.40900

0.50752

0.61307

0.71296

0.79625

0.87257

RESULTS AND DISCUSSION

A

-0.84280

-1.62576

-2.41792

-3.20887

-4.00245

-4.80327

-5.60555

-6.40763

-7.27298

B

0.14151

0.22023

0.30952

0.40212

0.50058

0.60187

0.70333

0.79829

0.89698

A

-0.71759

-1.47214

-2.22270

-2.97326

-3.70336

-4.44063

-5.14974

-5.82297

-6.49215

B

0.12861

0.21294

0.30555

0.40421

0.50301

0.60843

0.70776

0.79277

0.86705

In this section, the values of CH obtained by calculating the DMA variance of artiﬁcial

fractional Brownian motions are compared with those calculated using the Eq. (8).

In Fig.(1), the results of the DMA algorithm implemented over artiﬁcial fractional random

walks generated by the random midpoint displacement algorithm are shown. The length of

the walks is N = 223 and the Hurst exponent ranges from 0.1 to 0.9 with step 0.1. The

curves in the three ﬁgures refer respectively to three values of the parameter θ, namely

θ = 0, θ = 0.5 and θ = 1. The slopes of the curves plotted in Fig.(1) are plotted in Fig.(2).

The slopes and the intercepts of the curves plotted in Fig.(1) are reported in Table I. From

the data shown in Table I, it is possible to deduce that the DMA with θ = 0.5 performs

better with positively correlated signals with 0.5 < H < 1, while the DMA with θ = 0 and

θ = 1 performs better with negatively correlated signals with 0 < H < 0.5. In Fig.(3), the

theoretical values of CH, calculated by using the Eq.(8), are compared with those obtained

by the intercepts of the curves plotted in Fig.(1) for θ = 0.5 (data of the 2nd column of

Table I [19]).

It is interesting a comparison of the Eqs. (9,10) with the corresponding ones obtained

for the DFA method, that we will brieﬂy recall here. According to the DFA method, the

6

1

2

3

4

5

10

10

10

10

10

1

2

3

4

5

10

10

10

10

10

 

n

 

n

 

=0

=0.5

 

 

 

-3

10

DMA

0

10

-1

10

-2

10

-4

10

-5

10

-6

10

0

10

-1

10

-2

10

-3

10

-5

10

-6

10

-7

10

0

10

-1

10

-2

10

-3

10

-4

10

-5

10

-6

10

DMA

-4

10

DMA

1

2

3

4

5

10

10

10

10

10

=1

n

7

FIG. 1: Log-log plot of the function σDM A deﬁned by the Eq. 1 for artiﬁcial series generated by

0.9

  =0.0

  =0.5

  =1.0

1.0

0.8

0.7

0.6

0.5

t

u
o

H

0.4

0.3

0.2

0.1

0.0

 

H

in

 

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

FIG. 2: Values of the slopes of the function σDM A plotted in Fig.(1) for three diﬀerent values of

the parameter θ respectively equal to 0, 0.5 and 1.

integrated proﬁle y(i) is divided into boxes of equal length n. In each box, the signal y(i)

is best-ﬁtted by an ℓ-order polynomial yn,ℓ(i), which represents the local trend in that box.

The diﬀerent order of the DFA-ℓ (e.g.,DFA-0 if ℓ = 0, DFA-1 if ℓ = 1, DFA-2 if ℓ = 2, etc) is

obtained according to the order of the polynomial ﬁt. Finally, for each box n, the variance:

N

DF A ≡ 1
σ2
N

[y(i) − yn(i)]2

i=1
X
is calculated. The calculation is then repeated for diﬀerent box lengths n, yielding the

behavior of σDF A over a broad range of scales. For scale-invariant signals with power-law

correlations, the following relationship between the function σDF A and the scale n holds:

DF A ∼ n2H.
σ2

The asymptotic behavior of the DFA-0 and DFA-1 functions has been investigated by

Raymond and Bassingthwaighte in [18] and by Taqqu, Teverovsky and Willinger in [17]

respectively. Raymond and Bassingthwaighte worked out the following relation (Eq.(21) of

Ref. [18]) for the asymptotic scaling of the σDF A−0 function [20]:

(11)

(12)

(13)

σ2
DF A−0

≃

1
2H + 1

−

1
2(H + 1)

n2H

(cid:19)

(cid:18)

8

 DMA theory

 DFA  theory

 DMA simulation

 DFA  simulation

 

1

0.1

H

C

0.01

1E-3

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

FIG. 3: Values of CH for the DMA algorithm for θ = 0.5 (squares) and for the DFA-1 algorithm

applied to the same series (circles). The solid lines represent the values of CH calculated by using

the expressions (8) and (14) respectively.

The asymptotic behavior of the DFA-1 function is reported in the Appendix of [17]:

σ2
DF A−1

≃

2
2H + 1

+

1
H + 2

− 2

n2H

H + 1

(cid:19)

(cid:18)

(14)

In Fig. 3, the values of CH for the DMA and the DFA are shown. It can be observed that

the behavior of CH obtained from the simulations (square and circles) follows quite well the
analytical curves (solid lines) around H ≃ 0.5. Deviations are observed at the extrema of

the H range. Such deviations might be related either to the DFA and DMA sensitivity or

to the RMD accuracy. This issue, which is beyond the scope of the present eﬀort, will be

addressed in a future paper.

CONCLUSIONS

We have analytically derived the asymptotic scaling behavior of the DMA algorithm

proposed in [13]. We have compared the analytical results with those obtained from the

simulations of fractional Brownian paths with assigned values of H obtained by the Random

Midpoint Displacement.

 

H

9

∗ Electronic address: arianos@infn.to.it; Permanent address: Theoretical Physics Department,

Universit´a di Torino, Italy

† Electronic address: anna.carbone@polito.it; URL: http://www.polito.it/noiselab

[1] R. N. Mantegna and H. E. Stanley, An Introduction to Econophysics : Correlations and

Complexity in Finance (Cambridge University Press, New York, 2000).

[2] W. Willinger, R. Govindan, S. Jamin, V. Paxson, and S. Shenker, PNAS, 99, 2573 (2002)

[3] W. S. Lam, W. Ray, P. N. Guzdar and R. Roy, Phys. Rev. Lett. 94, 010602 (2005)

[4] S. O. Ferreira et al. Appl. Phys. Lett. 88, 244102 (2006)

[5] J. Feder, Fractals (Plenum, New York, 1988)

[6] Hurst, H.E., Transaction of the American Society of Civil Engineers 116, 770; (1951)

[7] B. B. Mandelbrot and J. R. Wallis, Water Resources Res. 5, No. 2, 321 (1969).

[8] C.-K. Peng, S. V. Buldyrev, A. L. Goldberger, S. Havlin, M. Simons, and H. E. Stanley,

Phys. Rev. E, 47, 3730 (1993); C.-K. Peng, S. V. Buldyrev, S. Havlin, M. Simons, H. E. Stan-

ley, and A. L. Goldberger, Phys. Rev. E, 49, 1685 (1994)

[9] N. Vandewalle and M. Ausloos, Phys. Rev. E, 58, 6832, (1998)

[10] K. Ivanova, M. Ausloos, Physica A 265, 279 (1999); Eur. Phys. J. B 8, 665, (1999)

[11] G. Rangarajan and M. Ding, Phys. Rev. E 61, 004991 (2000)

[12] C. Heneghan and G. McDarby, Phys. Rev. E 62, 6103 (2000)

[13] E. Alessio, A. Carbone, G. Castelli, V. Frappietro, Eur. J. Phys. B, 27, 197, (2002)

[14] A. Carbone, G. Castelli and H. E. Stanley, Phys. Rev. E, 69, 0161, (2004); A. Carbone,

G. Castelli and H. E. Stanley, Physica A, 344, 267, (2004)

[15] T. Di Matteo, T. Aste, M. M. Dacorogna, J. of Banking and Finance 29, 827, (2005)

[16] R. Voss, Random fractal forgeries, in Fundamental Algorithms for ComputerGraphics, (1985)

R.A. Earnshaw, editor, NATO ASI Series F, 17, Springer-Verlag, NewYork, 805-835.

[17] M. S. Taqqu, V. Teverovsky and W. Willinger, Fractals, 3, 785 (1995)

[18] G. M. Raymond , J. B. Bassingthwaighte, Physica A 265, 85, (1999)

[19] Since the Fractional Brownian motions, used for the simulations plotted in Fig. (1), have been

generated by the Random Midpoint Displacement algorithm. In the calculation of CH it must

be kept in mind that: σ2

RM D = (1 − 22H−2)/22Hν σ2

gauss

where ν is the number of steps

10

of the RMD algorithm.

[20] It is easy to check that the ”scaled windowed variance without any trend correction” in Ref.[18]

is indeed equivalent to the DFA-0 variance. Note that the sentence ”without trend correction”

is not fully appropriate. The function obtained by ﬁtting the random walks y(i) by constant

segment in each box corresponds indeed to a zeroth-order approximtion of the trend of y(i).

11

