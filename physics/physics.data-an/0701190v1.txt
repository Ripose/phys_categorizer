7
0
0
2
 
n
a
J
 
6
1
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
0
9
1
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Networks of Recurrent Events, a Theory of Records, and an Application to Finding
Causal Signatures in Seismicity

J¨orn Davidsen,1, ∗ Peter Grassberger,1, 2 and Maya Paczuski1
1Complexity Science Group, Department of Physics and Astronomy,
University of Calgary, Calgary, Alberta, Canada T2N 1N4
2Institute for Biocomplexity and Informatics, University of Calgary, Calgary, Alberta, Canada
(Dated: February 17, 2014)

We propose a method to search for signs of causal structure in spatiotemporal data making mini-
mal a priori assumptions about the underlying dynamics. To this end, we generalize the elementary
concept of recurrence for a point process in time to recurrent events in space and time. An event is
deﬁned to be a recurrence of any previous event if it is closer to it in space than all the intervening
events. As such, each sequence of recurrences for a given event is a record breaking process. This
deﬁnition provides a strictly data driven technique to search for structure. Deﬁning events to be
nodes, and linking each event to its recurrences, generates a network of recurrent events. Signiﬁ-
cant deviations in properties of that network compared to networks arising from (acausal) random
processes allows one to infer attributes of the causal dynamics that generate observable correlations
in the patterns. We derive analytically a number of properties for the network of recurrent events
composed by a random process in space and time. We extend the theory of records to treat not
only the variable where records happen, but also time as continuous. In this way, we construct a
fully symmetric theory of records leading to a number of new results. Those analytic results are
compared in detail to the properties of a network synthesized from time series of epicenter locations
for earthquakes in Southern California. Signiﬁcant disparities from the ensemble of acausal networks
that can be plausibly attributed to the causal structure of seismicity are: (1) Invariance of network
statistics with the time span of the events considered, (2) Appearance of a fundamental length scale
for recurrences, independent of the time span of the catalog, which is consistent with observations
of the “rupture length”, (3) Hierarchy in the distances and times of subsequent recurrences. As ex-
pected, almost all of the statistical properties of a network constructed from a surrogate in which the
original magnitudes and locations of earthquake epicenters are randomly “shuﬄed” are completely
consistent with predictions from the acausal null model.

PACS numbers: 02.50.-r,05.65.+b,91.30.Dk,05.45.Tp

I.

INTRODUCTION

Many striking features of physical, biological or social
processes can be portrayed as patterns or clusters of lo-
calized events. These can be ﬂips of magnetic domains in
a ferromagnet leading to Barkhausen noise [1, 2], traﬃc
jams [3], booms and busts of markets and economies [4],
forest ﬁres [5], the spread of infections [6] and global pan-
demics, extinctions of species [4, 7, 8], neural spikes [9],
solar ﬂares [10, 11], or earthquakes [12, 13, 14] – to name
a few. A generic attribute in all these cases is that one
event can trigger or somehow induce another one to oc-
cur – or possibly numerous further events. Sometimes,
as in the prototype sandpile model [15], an accounting
of causes and their eﬀects leads to an interpretation in
terms of avalanches - where causal connections between
clustered events (“topplings”) are explicitly rationalized
by the microscopic state and rules of the dynamical sys-
tem. More often than not, though, the network of causal
connections cannot be resolved from the data at hand
and remains ambiguous. Thus, one is often confronted
with inferring a plausible causal structure from clusters

∗Electronic address: davidsen@phas.ucalgary.ca

of localized events without a detailed or “fundamental”
knowledge of the true microscopic dynamics. This re-
mains a stubbornly impenetrable problem despite some
progress in special cases (see e.g. Ref. [16] and references
therein).

We aim to establish a general procedure of plausible
inference based on sequences of data in space and time,
or more generally for any temporal sequence of data. The
essential idea for the method of analysis discussed here
is that of a recurrence. Our deﬁnition of recurrences is a
generalization of “returns” for a point process to higher
dimensional data structures that evolve in time. Loosely
spoken - recurrences involve a pair of localized events
where the latter one is suﬃciently close to the ﬁrst one
to suggest a causal connection.

A. An example of contextual dependence

For illustration consider the two events: (A) First, Al-
ice drops a banana, and (B) then Bob falls down. If A
and B are suﬃciently close in space and time then one
can reasonably infer that it is likely that Bob slipped on
the banana and fell down (“A caused B”), but should
these events be suﬃciently separated then A is less likely
to have contributed to B’s occurrence. For instance, Bob

could have been distracted by the banana, or fell for an-
other reason related to A without actually slipping di-
rectly on the banana – so the two events may still be
connected without A being exclusively the cause of B.
This secondary eﬀect is also less likely if suﬃcient time
has past between the two events. Eventually Alice or an-
other party may pick up the banana or Bob’s fall may
have happened so far away that it would be unlikely for
him to have slipped on it.

As this example shows, it is not always clear what we
should mean by ’suﬃciently close’ to infer a causal con-
nection. One option might be to call a localized event B
a recurrence of an earlier event A, if its spatial distance
is less than some chosen length l [17]. In addition to in-
troducing a length scale, this choice fails to admit that
the plausibility of causal connections typically becomes
weaker with time – as the example above makes plain. In
addition, the likelihood that the later event (B) may be
triggered by a third intervening event increases with time
as well. These considerations might suggest that l should
shrink with time. On the other hand, the fact that inﬂu-
ences usually spread either diﬀusively or with ﬁnite speed
could suggest the opposite - that l increases with time.
Spreading of inﬂuence is hypothesized, for instance, in
theories of “aftershock zone diﬀusion” (see Ref. [18] and
references therein). Other, more complicated scenarios
are also conceivable.

This discussion is meant to clarify that without suf-
ﬁciently accurate a priori knowledge of the underlying
microscopic dynamics any deﬁnition of closeness based
on predeﬁned scales is arbitrary and might signiﬁcantly
alter the inferred causal structure. To avoid this prob-
lem, or more generally to minimize the inﬂuence of the
observer, we take the view that, to begin with, a suitable
deﬁnition of closeness ought to be purely contextual, and
depend only on the actual history of events. Taking this
as our starting point – that we know the observed his-
tory of events but do not know the underlying dynamics –
we propose a contextual method to establish recurrences
that uses ’zero knowledge’ of the underlying physical pro-
cesses. As a result, our deﬁnition is generic and can ap-
ply to a wide variety of situations. This approach serves
as a starting point to analyze data for systems where
the underlying dynamics is obscure, mysterious or even
misconceived. It comprises a fundamental extension of
the concept of recurrences for a point process to recur-
rent events in space and time that allows the inference of
causal relations from available or possible observations.

B. Contextual relationships represented by a
network

In the approach described here, the inferred relation-
ship between each pair of events is based on the closeness
of the pair relative to all the other events that have oc-
curred in the data set. An event B is designated to be
a recurrence of a previous one A if it is closer to A —

2

compared to any other event occurring in the time inter-
val between A and B. By this construction, each recur-
rence is a new “record” in the sequence of distances that
subsequent events have from A.
In other words, each
recurrence is a record breaking event [19, 20, 21].

This method of inferring relationships between pairs of
events is naturally expressed as a network of connected
events where each event is a node in the graph, and each
recurrent pair is linked with a time directed edge. Sig-
niﬁcant deviations in the statistics of the resulting net-
work from that for a random process (which lacks any
causal relations between events) highlights relevant parts
of the causal dynamical process(es) generating the pat-
terns. In principle, the events themselves do not have to
take place in real physical space, but can occur in any
space as long as it is equipped with a metric that de-
ﬁnes distances. As a starting point, here we only discuss
spatiotemporal point processes and take as our test bed
a well-characterized, extensive and comparatively accu-
rate catalog [22] of earthquake epicenters for Southern
California.

C. Outline

Section II explains our method for constructing net-
works of recurrent events and the relation to record
breaking statistics.
In Section III, the null hypothesis
of independent, random events is introduced and a num-
ber of analytic results are obtained for it. We extend the
mathematical theory of record breaking statistics to the
case where both space (or the variable which ﬂuctuates
and in which records take place) and time (or the order-
ing of events) are treated on the same footing. Treating
both space and time as continuous symmetrizes the the-
ory – making it more concise. These results allow us
to discover statistical features in the actual network of
recurrences that are unlikely in the acausal random pro-
cess and, hence, plausibly due to causal structures in the
underlying dynamics.

Section IV describes the application to seismicity. The
network analysis reveals new statistical features of seis-
micity — with robust scaling laws that are invariant over
a range of diﬀerent time scales. This apparent invariance
with respect to the time span is diametrically opposed
to the behavior for a random process, where all statis-
tical distributions depend explicitly on the time span
over which events are recorded. The rupture length and
its scaling with magnitude (while being invariant with
respect to the time span of the history) emerges from
the data analysis without being predeﬁned by the mea-
surement process.
It is a generic measure for distance
between recurrent events. These results indicate that
our method is, indeed, tending to identify causally re-
lated events rather than acausal pairs. Further, the rel-
ative separations for subsequent recurrences in space (or
time) form a hierarchy with unexpected properties. All
of these properties disappear when a history constructed

by “shuﬄing” the original earthquake catalog is analyzed
using the same method. In that case, almost all results
agree with predictions of the acausal null model. On the
basis of these results, we argue that the particular fea-
tures where we observe strong deviations between the ac-
tual history and the acausal null model can be attributed
to causal structures in the dynamics of seismicity. We
end with a summary and outlook for future works and
applications.

II. SYNTHESIZING THE NETWORK OF
RECURRENCES

Consider a series of events ai, with i = 1 . . . N , that
are ordered in time such that event ai precedes event
aj if i < j. The events ai are in the following iden-
tiﬁed with their spatio-temporal position. We assume
that a metric is deﬁned in space, and we denote by dij
the spatial distance between events ai and aj. Simple ex-
amples are spatiotemporal point processes taking place
in 3-dimensional Euclidean space or on the surface of a
sphere. The only property of the metric relevant to this
discussion is that (spatial) distances between all pairs of
events can be ordered, e.g. from smallest to largest, and
the ordering relation is transitive. The same is of course
true for time distances.

The network of recurrent events is deﬁned as follows
(see Fig. 1): All events ai are represented as nodes and
two nodes i and j with i < j are connected by a directed
link or edge eij if event aj is a recurrence of ai. This
occurs if and only if dij < dik for all k with i < k < j.
Thus a recurrence is a new record with respect to dis-
tance. Note that eij and eji cannot both exist since the
directionality of links is determined by the time ordering.
Hence, if i < j only eij can exist. To summarize: the def-
inition of recurrence implies that, for all 2 < j < n, event
aj is automatically a recurrence of event aj−1 and, thus,
all links e(j−1)j exist. Event aj is also a recurrence of
any previous event ai if it is closer to ai than every other
event ak that occurred in between the two, i.e., for all ak
with i < k < j.

As long as only one event occurs at a time, the di-
rected network consists of a single cluster in which each
node is linked to at least one other node. Each node i
has an in-degree kin
, which is the number of links point-
i
ing to it from events in its past, as well as an out-degree
kout
, which is the number of links emanating from i –
i
corresponding to the number of records of event i. The
are hypothe-
collection of in-nodes Ii =
j
{
sized to reﬂect the potential cause(s) of event ai while the
set of out-nodes Oi =
are hypothesized
to contain the eﬀect(s) of ai. Although it is natural to
contemplate associating a weight factor to each link, this
requires further assumptions. Here we do not deal with
this issue and consider all links to have the same weight.
This is in our view a “zero’th order” assignment of causes
and their eﬀects based purely on the history of events

eij exists

eji exists

}

{

}

j

|

|

3

4

8

2

7

3

6

1

5

FIG. 1: Eight events in 2D space labelled according to their
order of occurrence in time. The synthesized network of re-
currences is shown as described in the text.

and their relationships to each other in space and time.
Note that even in this case, a single event can have many
causes corresponding to all of its incoming links, so the
network aspect of causal relations is not lost in this limit.
Weighted networks of seismic events were constructed us-
ing a diﬀerent methodology in Refs. [14, 23, 24].

While this network construction, based on record
breaking events, is directly applicable to ﬁxed collections
of events, it can also be applied when the number of
events N increases over time. The result of adding a new
event aN +1 is to increase the number of links by at least
one, namely eN (N +1), without altering any pre-existing
links. Hence, the property of being a recurrence is pre-
served in all cases under addition of new nodes in time.
Also the collections of in-nodes for all pre-existing nodes
remains unchanged. Yet, the out-degree of any node i
with i < N + 1 can increase by one, namely if aN +1 is
a recurrence of ai. So the networks are, in this sense,
dynamically stable growing networks [25, 26].

Some tools and measures already exist to quantify sta-
tistical topological features of networks, and to reveal the
organization of the dynamical process(es) giving rise to
the events in terms of network statistics [25, 26]. The
dependence of the network statistics can be examined
by varying the time span of the history synthesized into
a network, space window over which the history is ob-
served, and/or selection criteria for what is deﬁned as
an event (in the seismic application discussed later, this
could e.g. be the range of earthquake magnitudes). Our
approach opens up a new view of dynamical organiza-
tion of spatiotemporal activity in terms of the (static)
topology of complex networks – as was also discussed
in [14, 23, 24, 27, 28]. We also believe it possible that
new developments in network theory may turn out to be
even more powerful in analyzing dynamical systems. For

the work described here, standard methods of network
analysis are already suﬃcient to plausibly infer certain
causal relations in seismic behavior solely from the cat-
alog of earthquake magnitudes, epicenter locations and
times.

It is easily seen that these joint distributions also factor-
ize under the above assumptions as,

µn(l1, t1; . . . ln, tn) =

µ1(li, ti)

(4)

n

i=1
Y

III. THE ACAUSAL NULL MODEL AND A
THEORY OF RECORDS

with

4

A. General remarks

In order to be able to extract causal characteristics of
the dynamics from the network of recurrences, we math-
ematically establish statistical properties in a null model,
where the events in space and time are random, uncor-
related and causally unrelated. Then any statistically
signiﬁcant deviation of the observed network from this
null hypothesis can be attributed to correlations among
events and thereby to causal structure in the underlying
dynamics giving rise to the observed history. The con-
clusions about the relation to causality are robust as long
as the relevant properties of any acausal null model are
well represented by those we study.

In the following we shall discuss several variants of the
null model. In all of them, both space and time are con-
tinuous. To the best of our knowledge, the theory of
records has up to now been developed only for discrete
time and continuous space [19, 20, 21]. As we shall see,
when both variables are continuous the core of the theory
becomes symmetric under exchange of space and time, al-
lowing for a more concise formulation. This symmetry is
obviously lost when making one of the variables discrete.
Let us denote by ρ(x1, t1; . . . xn, tn) the joint prob-
ability density for having events at locations (xi, ti),
i = 1, . . . n. Our basic assumptions are that:

(a) Events are independent and identically distributed

(iid),

ρn(x1, t1; . . . xn, tn) =

ρ1(xi, ti).

(1)

n

i=1
Y

(b) The single-event distributions factorize,

ρ1(x, t) = ρx(x)ρt(t).

(2)

In particular, when ρt(t) = const, Eq. (2) means that we
dxdtρ1(x, t) = N ,
have a stationary system. Note that
the total average number of events in the history, as long
as this number is ﬁnite.

R

Instead of event distributions themselves, we shall in
the following use the distributions of space-time distances
relative to some reference event or “Event-0” at (x0, t0),

µn(l1, t1; . . . ln, tn) =

x0
dyiδ(
|

yi| −

−

li)]

×

(3)

ρn(x0, t0; y1, t0 + t1; . . . yn, t0 + tn).

n

[
Z
i=1
Y

µ1(l, t) = µl(l)µt(t).

(5)

The functions µl(l) and µt(t) might in general depend on
the reference point, x0. We will not indicate this depen-
dence explicitly, unless it is relevant for the calculation.
First, we consider the special case µl(l) = µt(t) = 1,
which holds if the system is stationary, 1-dimensional,
homogeneous, and has the suitable space-time density
of events. The next step is when either one of these
functions or both are equal to one up to ﬁnite cut-oﬀs and
zero beyond, i.e. µl(l) = Θ(λ
t).
Physically, λ is not only the maximal possible distance
between two events (due to ﬁniteness of space), but it
is also the rate at which events occur per unit time, if
µt(t) = 1. Similarly, a ﬁnite value of σ indicates not only
that events are observed in a ﬁnite time window, but
also that the average number of events per unit distance
is ﬁnite.

l) and/or µt(t) = Θ(σ

−

−

B. Canonical coordinates

Fortunately,

it is suﬃcient to discuss these simple
cases, because for any non-singular densities µl(l) and
µt(t) the problem can be reduced to one of them by a
change of coordinates. Consider the two transformations

l

0
Z

∞

0
Z

t

0
Z

∞

0
Z

ξ =

dl′µl(l′) ,

τ =

dt′µt(t′) .

(6)

Clearly, ξ is a positive and monotonically increasing func-
tion of l, while τ is a positive and monotonically increas-
ing function of t. Due to conservation of probability, both
have unit density

µξ(ξ) = Θ(λ

ξ) ,

µτ (τ ) = Θ(σ

τ ),

(7)

−

−

where we have denoted by λ and σ the integrals over µl
and µt, respectively,

λ =

dl′µl(l′) ,

σ =

dt′µt(t′).

(8)

Thus, the distributions of events in ξ and τ are cut-oﬀ
sharply at λ and σ, respectively. Note that λ and σ can
be inﬁnite.

Thus, for general space and time distributions, we can
ﬁrst do all calculations in the “canonical coordinates” ξ
and τ , and then translate the results, using inverse trans-
formations of Eq. (6), back to the original coordinates
l, t. Examples are given below. In the following we al-
ways assume that ξ and τ are deﬁned by Eq. (6) and,
thus, Eq. (7) holds for all positive ξ and τ .

5

pτ (τ ) =

dξ p(ξ, τ ) = 1/τ .

(11)

∞

0
Z

Assuming that the system is translationally invariant in
time and fractal in space, i.e. µt(t) = b = const and
µl(l) = aDlD−1, we obtain for the densities in the origi-
nal coordinates

pl(l) = µl(l)pξ(ξ(l)) =

aDlD−1

alD = D/l ,

pt(t) = µt(t)pτ (τ (t)) = b[bt]−1 = 1/t .

(12)

(13)

Thus the recurrence density in time is independent of
the event rate (per unit space-time region). Similarly, for
an event distribution with given (fractal or Euclidean)
non-trivial dimension, the recurrence density depends on
the dimension but not on the parameter a. Also, notice
that pt(t) is completely independent of the spatial event
distribution µl(l), and pl(l) is independent of µt(t).

For homogeneous and monofractal stationary spatial
distributions both pt and pl are independent of the ref-
erence point deﬁning the recurrences. This is no longer
true for multifractals, where pl(l) depends on the local
(pointwise) dimension at the event which deﬁnes the re-
currences.

The analog of Eq. (13) for discrete time is a classic
result in the theory of records [19, 20, 21]. In contrast,
Eq. (12) was ﬁrst reported in [27], as far as we know.

D. Finite space and inﬁnite time — and vice versa

Let us assume that µt(t) is not normalizable but µl(l)

λ <

,

∞

σ =

.

∞

Now, of course, pξ(ξ) = 0 for ξ > λ. For ξ < λ, on the
ξτ )

other hand, pξ(ξ) is still given by integrating exp(
over all positive values of τ as in Eq. (10), i.e.

−

pξ(ξ) =

Θ(λ

ξ) .

−

1
ξ

In terms of the original coordinates, one ﬁnds

pl(l) = µl(l)pξ(ξ(l)) =

.

µl(l)
l
0 dl′ µl(l′)
R

In contrast, pτ (τ ) is obtained by integrating Eq. (9)

over the ﬁnite domain 0 < ξ < λ, which gives

pτ (τ ) =

(1

e−λτ ).

1
τ

−

In the stationary case, when t is just proportional to
τ , the density of recurrences in t is given by the same
formula with λ replaced by the rate of events per unit t.
The additional term compared with Eqs. (11) and (13)
reﬂects the probability that no recurrence occurs up to
time τ and t, respectively.

(14)

(15)

(16)

(17)

(ξ,τ)i-2

ξ

(ξ,τ)i-1

(ξ,τ)i

(ξ,τ)i+1

(0,0)

τ

FIG. 2: A typical chain of recurrences in canonical coordi-
nates. The reference event or Event-0 for all these recurrences
is at the origin τ = ξ = 0. The event at (ξi, τi) is a recurrence
of the event at (0,0) if and only if no event is in the shaded
region.

In canonical coordinates, a typical sequence of recur-
rences is drawn schematically in Fig. 2. For all recur-
rences i, ξi+1 < ξi and τi+1 > τi. This is symmetric
under the exchange ξ
i. The
τ, λ
probability that a given event (ξ, τ ) is a recurrence of
Event-0 at (0,0) is equal to the chance that no event oc-
curred in the rectangular region [0, τ ]
[0, ξ], which is
ξτ ) due to the unit space-time density of
equal to exp(
events in the (ξ, τ )-plane. Hence, the joint probability
density function (PDF) of recurrences is given by the
same exponential,

σ , and i

↔ −

↔

↔

×

−

p(ξ, τ ) = e−ξτ ,

is,

(9)

except for the possible cut-oﬀs at λ and/or σ, beyond
which the density of recurrences is zero; p(ξ > λ, τ ) =
p(ξ, τ > σ) = 0.

C.

Inﬁnite space and time domains

∞

For a detailed discussion of the spatial and temporal
distributions of recurrences we deal separately with the
cases of ﬁnite and inﬁnite λ and/or σ. We ﬁrst consider
the case where neither µl(l) nor µt(t) is normalizable,
. This, for example, describes the case
i.e. λ = σ =
of stationary and homogeneous systems in inﬁnite D-
dimensional Euclidean space, where µt(t) = const and
lD−1. But it holds also approximately for fractal
µl(l)
distributions in space (if we neglect eﬀects of lacunarity
[29]), with D being the fractal dimension. Notice that
0 dllD−1 =
The spatial and temporal density distributions of re-
R
currences in canonical coordinates are obtained by inte-
grating Eq. (9) to obtain the marginals,

for all values of D.

∞

∝

∞

pξ(ξ) =

dτ p(ξ, τ ) = 1/ξ ,

(10)

∞

0
Z

6

(26)
(27)

(28)

(29)

(30)

∞

, σ =

In the opposite case (λ <

) of ﬁnite event
rate per unit distance and inﬁnite rate per unit time (cor-
responding typically to inﬁnite space and ﬁnite time, with
ﬁnite space time density of events), the situation is com-
pletely symmetric. In that case pτ (τ ) is cut-oﬀ sharply at
a ﬁnite value, while pξ(ξ) is cut-oﬀ with an exponential
correction term as in Eq. (17).

∞

E. Finite space and ﬁnite time

Now both pξ(ξ) and pτ (τ ) are obtained by integrating

Eq. (9) over ﬁnite domains,

pξ(ξ) =

Θ(λ

ξ)(1

e−σξ),

1
ξ
1
τ

−

−

−

−

pτ (τ ) =

Θ(σ

τ )(1

e−λτ ).

(18)

(19)

→

Thus, pξ(ξ) asymptotically approaches the constant
0 while for intermediate arguments
σ in the limit ξ
we recover the 1/ξ decay for inﬁnite space and time do-
mains given in Eq. (10). For large arguments, the density
sharply drops to zero at ξ = λ. pτ (τ ) asymptotically ap-
0 while for
proaches the constant λ in the limit τ
intermediate arguments we recover the 1/τ decay for in-
ﬁnite space and time domains given in Eq. (11). For large
arguments, the density sharply drops to zero at τ = σ.
The respective transition points ξ∗ and τ ∗ between the
constant behavior for small arguments and the decaying
behavior for intermediate arguments can be deﬁned in
the standard way by requiring that the argument of the
exponential equals

1, i.e.,

→

−

σξ∗
λτ ∗

1,
1.

≡
≡
Speciﬁc realizations of such a process include station-
ary systems observed over a ﬁnite time window, where
events occur only in a ﬁnite region of space — or are
only recorded when they fall into that region. One ex-
ample is µt(t) = bΘ(T
l)
with positive constants T and R. In this case, Eq. (18)
translates into

t) and µl = aDlD−1Θ(R

−

−

abT DlD−1
D/l
0

l∗(T ), l < R ,
l∗(T ), l < R ,

for l
≪
for l
≫
for l > R ,

and Eq. (19) translates into

abRD
1/t
0

t∗(L), t < T ,
t∗(L), t < T ,

for t
≪
for t
≫
for t > T ,

pl(l) =






pt(t) =






with

and

l∗(T )

(abT )−1/D ,

t∗(L)

[abRD]−1 .

≡

≡

= abT RD be the average total number of
Finally, let
observed events. Then the expressions for the transition
points are particularly simple

N
h

i

l∗(N ) = L/
N
h
t∗(N ) = T /
N
h

1/D,
i
.
i

In this simple example and in the situations discussed
in subsection III D, we have assumed that translational
invariance holds. However, this is generally not true.
Speciﬁc realizations of such processes include stationary
systems observed over a ﬁxed ﬁnite time window, where
events occur only in a ﬁxed ﬁnite region of space — or
are only recorded when they fall into that region. Due to
the lack of translational invariance, the distributions of
distances (spatial and temporal) between events depend
on the deﬁning event. We discuss the consequences of
broken translational invariance now.

For concreteness and simplicity, let us assume a sta-
tionary system where events occur uniformly on an in-
terval 0 < x < L with periodic boundary conditions,
with space-time density α. They are recorded only in
the time window 0 < t < T . In general, the distributions
of distances between events in a bounded space-time re-
gion depend on the reference point (x0, t0), but in the
present case this simpliﬁes due to the periodic bound-
ary condition: The recurrence distributions depend on
t0, but not on x0. More precisely,

µl(l; x0, t0) = 2αΘ(L/2
µt(t; x0, t0) = Θ(T

l),
t),

−
t0 −

−

(20)
(21)

for positive arguments t and l, respectively. Note that the
asymmetrical attribution of the factor α to µl is arbitrary.
t0) and λ = αL. The
relations between original and canonical coordinates are

This ansatz gives σ = (T

−

ξ(l) =

2αl
αL

0 < l < L/2
l > L/2 ,

(cid:26)

t
T

τ (t) =

t0

(cid:26)

−

0 < t < T
t > T

−
t0 .

t0

−

(22)

(23)

(24)

(25)

The recurrence PDFs are obtained by inserting this
into Eqs. (18,19) and transforming back to the original
coordinates. The average distributions of distances be-
tween recurrences and reference points are obtained by
averaging over t0. The ﬁnal results are

pl(l)
h

it0 =

pt(t)
h

it0 =

1
l
1
t

(cid:20)
(1

1

e−2αlT
−
2αlT

1

−

e−αLt)(1

−

(cid:21)
t
T

−

Θ(L/2

l),

(31)

)Θ(T

t),

(32)

−

−

These detailed results are included in order to demon-
strate that exact calculations are possible in the most
simple case. But in more realistic cases no exact results
can be expected. As a general rule, the simple power

(33)

q(τ, τ ′) =

laws of Eqs. (12,13) will hold for intermediate values of
l and t, but corrections will be necessary both for large
and for small l and t – as follows from Eqs. (18,19). The
corrections render the distributions ﬁnite at small values
of the arguments, and they cut them oﬀ at large ones.

The cut-oﬀs at large l and t occur just at the sizes of the
system. Their detailed shapes depend, as suggested by
comparing Eqs. (31,32) with Eqs. (22,23), on the speciﬁc
properties of the system at large scales. The behavior at
small distances is more general.

To see this, let us consider Eq. (32) in more detail.
There the deviation from the inﬁnite system limit hap-
pens when αtL

1, i.e. at a time

≈
t

t∗(L)

(αL)−1

,

≈

≡
which exactly coincides with Eq. (25) for the transla-
tional invariant case. Since α is the density of events in
space-time, t∗ is the average time delay between succes-
sive events. Obviously, recurrences cannot follow each
other faster than events.
Similarly in Eq. (31), the
deviation from the inﬁnite system limit happens when
1, which coincides with the expression for l∗(T )
2αlT
in the translational invariant case given by Eq. (24).

≈

Not only is the scaling of l∗ and t∗ identical to the
translational invariant case but also the qualitative be-
t∗,
pt(t)
haviors of
h
respectively, are identical. This strongly suggests that
the results given in Eqs. (22,23,24,25) capture the essen-
tial behavior for scales smaller than the large scale cut-oﬀ
– even when translational invariance is explicitly broken.

it0 and of

it0 for l

l∗ and t

pl(l)
h

≪

≪

F. Correlations between recurrences and
properties of recurrences with ﬁxed rank

Let p(l, t; l′, t′) be the PDF that two events at space-
time positions (l, t) and (l′, t′) are both records – not
necessarily subsequent ones. Referring to Fig. 2, and
using Bayes’ theorem in canonical coordinates, we are
interested in the probability that no other event occurs
in either of the two rectangles associated to the events,
which is determined by the union of the two rectangular
areas. Hence if τ > τ ′ and ξ < ξ′, then

p(ξ, τ ; ξ′, τ ′) = e−ξτ −(ξ

Θ(σ

τ )Θ(λ

ξ′) .

(34)

′−ξ)τ

′

−
This directly determines p(l, t; l′, t′).

−

Integrating over ξ and ξ′ gives the joint PDF for having

recurrences at times τ and τ ′,

λ

dξ′

′

ξ

0
Z

0
Z
1
τ τ ′

p(τ, τ ′) =

dξ e−ξτ −(ξ

′−ξ)τ

′

Θ(σ

τ )

−

′

τ e−λτ
τ

τ ′e−λτ
τ ′

1

=

−
−
, this gives p(τ, τ ′) = (τ τ ′)−1, for τ ′ < τ < σ
For λ =
so the two recurrences are uncorrelated. For ﬁnite λ,

τ ) .(35)

Θ(σ

∞

−

−

"

#

7

records are correlated; i.e. p(τ, τ ′)
= pτ (τ )pτ (τ ′). For
a stationary process, these results hold in the original
coordinate t as well.

Alternatively, let q(l, t; l′, t′) be the probability that
two events at (l, t) and (l′, t′) are successive records. As-
suming again that τ > τ ′ and ξ < ξ′, we now demand
that both are records, as above, and also that no other
event happens in the rectangle [ξ′, ξ]

[τ ′, τ ], or

q(ξ, τ ; ξ′, τ ′) = e−ξ

τ Θ(λ

′

τ ) .

(36)

×
ξ′)Θ(σ

−

−

Integrating over ξ and ξ′ gives the joint PDF for having
successive records at times τ and τ ′ to be

′

ξ

λ

dξ′

′

dξ e−ξ

τ Θ(σ

0
Z
(1 + λτ )e−λτ

τ )

−

(37)

for τ ′ < τ < σ .

0
Z
1
τ 2

=

1

−

(cid:2)

(cid:3)

Hence, times to successive recurrences are always corre-
, the joint PDF is q(τ, τ ′) = 1/τ 2 for
lated. When λ =
τ ′ < τ < σ.

∞

For the PDF of the ratio of the times of successive
records x = τ ′/τ > 0, it directly follows for ﬁnite λ that

qτ (x) =

dτ ′q(τ (x), τ ′)

σx

0
Z

= Θ(1

x)

−

(i

−

∞

i=1
X

dτ
dx

(cid:12)
(cid:12)
1)(
(cid:12)
(cid:12)
i
·

−
i!

(cid:12)
(cid:12)
λσ)i
(cid:12)
(cid:12)

,

(38)

which is constant in the interval [0; 1]. This is also the re-
sult in the original coordinates, if the system is stationary
τ and x = t′/t.
– in which case t

We now discuss spatial distance distributions of recur-
rences with ﬁxed rank i, and ﬁrst consider a ﬁnite sta-
tionary system inﬁnitely extended in time (σ =
). Let
p(i)
ξ (ξ) be the spatial distance PDF for the i-th recurrence
2, the recursion relation
following Event-0. For any i

∞

∝

p(i)
ξ (ξ) =

dξ′ q(ξ

ξ′)p(i−1)
ξ
|

(ξ′) ,

(39)

≥

λ

ξ
Z

ξ′) is the conditional PDF, given
exists. The quantity q(ξ
|
that the previous recurrence happened at distance ξ′, for
the distance of the next recurrence. One easily shows
that

q(ξ

ξ′) =
|

1
ξ′ Θ(ξ′

ξ)

−

independently of i, so that

The solution for ﬁnite λ is

p(i)
ξ (ξ) =

ξ
Z

λ

dξ′
ξ′ p(i−1)

ξ

(ξ′) .

p(i)
ξ (ξ) =

Θ(λ
(i

ξ)
−
1)!

−

ln

λ
ξ

(cid:18)

(cid:19)

i−1

.

(40)

(41)

(42)

6
If the event density in original coordinates was µ(l) =
aDlD−1Θ(R
l)/RD, i.e., conﬁned to a disc with radius
R, then the last equation translates into

−

Considering that each event except the last one in the
sequence of N events initiates its own sequence of records,
and hence is an Event-0, gives

8

(43)

P out(k, N )

p(i)
l (l) = aΘ(R

DilD−1

1)!RD (ln R/l)i−1 ,

l)

−

(i

−

while Eq. (40) gives for the PDF of the ratio x = l/l′ > 0

ql(x) = DxD−1Θ(1

x) .

−

(44)

,
These last results have to be modiﬁed when σ <
∞
i.e. when there is a ﬁnite observation window in time.
In that case we are not guaranteed that at least i recur-
rences exist, and thus p(i)
l (l) has to be replaced by the
conditional PDF, conditioned on the existence of
i re-
currences. That requires a more extensive development
than we take up here.

≥

G. Distribution of the number of recurrences – or
the degree distributions

The out-degree distribution P out(k, N ) is the proba-
bility that a randomly chosen event out of a sequence of
N events has k records. This probability can be deduced
using previous results from the theory of records [19, 20,
21, 30, 31]. We assume that the system is stationary,
with a ﬁnite rate of events per unit time. We denote
the event deﬁning recurrences as Event-0. We use the
fact that recurrences are records in the sense that each
recurrence is an event that is closer to Event-0 than all
previous events that happened after Event-0. Consider
a series of i events following Event-0. The probability
that event j is a record is 1/j and the probability that
it is not is (j
1)/j. Hence the probability that there
is precisely one record in a series of i events following
1)/j = 1/i. Notice that the
Event-0 is Pi(1) =
−
ﬁrst event after Event-0 is always a record. The proba-
bility that there are precisely two records in the series of
i events is

i
j=2(j

Q

−

Pi(2) =

i

i

j

1

−
j

(cid:16)

j=2
Y

(cid:17)

Xl1=2(cid:16)

l1
l1 −

1 ×

=

1
i

1
l1

(cid:17)

i

Xl1=2

1
l1 −

1

.

(45)
Continuing with standard methods it is possible to show
that the probability of ﬁnding precisely k records in a
series of i events, Pi(k), is given by

Pi(k) =

1
i

(l1 −

1)

· · ·

1
(lk−1 −

1)

X1<l1<···<lk−1≤i
Sk
i |
i!
(ln i)k−1
1)!
i(k

,

−

= |

≈

where the symbol S indicates Stirling’s number of the
1.
ﬁrst kind and the last expression holds for i

k

≫

≫

N −1

1
N

≈

(ln i)k−1
i(k

1)! ≈

(ln(N ))k
N k!

,

(47)

i=1
X

−
where the last step involves approximating the sum as
an integral, which is valid for large N . Therefore, the
out-degree distribution for a random process of N
1
events is a Poisson distribution with mean degree
ln N [31].

≫
k
i ≈
h

Furthermore, the probability to have out-degree one,
P out(1, N ), can be computed exactly [19, 31]: For those
nodes the closest event in space is also the closest in time.
i).
For event i, this happens with probability 1/(N
Thus,

−

P out(1, N ) = N −1

N −1

i=1
X

1

−

N

i ≈

ln(N ) + eM
N

,

(48)

.
→ ∞

where we have approximated the harmonic series by
0.58 is the Euler-
the corresponding integral and eM ≈
Mascheroni constant. Note that Eq. (48) is exact in the
limit N

For the in-degree distribution, P in(k, N ), similar con-
siderations apply: Event i is a recurrence of event j
(0
j), which is inde-
pendent of N . This allows to compute the in-degree dis-
tribution P in

j < i) with probability 1/(i

i (k) of event i:

≤

−

P in

i (k) =

1
i

i−k

i−k+1

i−1

· · ·

Xl2=l1+1

Xlk−1=lk−2+1

1
l1l2 · · ·

lk−1

Xl1=0
Sk
i |
i!
(ln(i))k−1
1)!
i(k

−

= |

≈

,

≤

−

P in(k, N ) =

1
N

N −1

i=1
X

for 0 < k

i

1 and zero otherwise. Hence

P in

i (k)

(ln(N ))k
N k!

≈

.

(50)

As expected for a fully random process, P in(k, N ) is iden-
tical to P out(k, N ) and well-approximated by a Poisson
distribution with mean degree

ln N for N

1.

k
h

i ≈

≫

H. Degree correlations

(49)

(46)

Due to the acausal nature of the null model, the joint
probability Pi(kin, kout) that event i has in-degree kin
and out-degree kout factors for all nodes i. As a result

Pi(kin, kout) = PN −i(kout)P in

(51)

i (kin)
out−1

(ln (N
(N

i))k
−
i)(kout

−

1)!

−

(ln (i))k
i(kin

in−1

1)!

−

≈

This allows us to compute the mean out-degree of all
events with a given in-degree in a sequence of N events

9

kout
h

(kin, N ) =
i

N −1

N −1

kout 1
N

Xkout=0

i=1
X

Pi(kin, kout)/P in(kin, N )

1 +

≈

(ln (N

1

−

1))kin

1
Z

N −1

in

(ln (i))k
N

1

−

−

i

di

.

(52)

i

kout
h

weakly depends on kin due to the
The out-degree
fact that the rank of each event implicitly couples its
in- and out-degree in a ﬁnite sequence of events. For
instance, if the rank of an event is small (large) com-
pared to N , the in-degree is more likely to be small, but
the out-degree is more likely to be large. Consequently,
(kin, N ) decreases with kin for ﬁxed N . For sim-
kout
h
i
ilar reasons, weak correlations also appear between the
in-/out-degree of a node and the in-/out-degree of its re-
currences. For example, a large (small) in-degree for a
node implies on average a small (large) out-degree for
its recurrences. Similarly, the out-degree (in-degree) of
recurrences increases on average with the out-degree (in-
degree) of their Event-0.

IV. APPLICATION TO SEISMIC PATTERNS

Seismicity is a prime example where localized events
in space and time can be accurately and, with certain
caveats, exhaustively recorded. It is also a phenomenon
where the causal features of the dynamics responsible for
the patterns are subject to ongoing debate and uncer-
tainty. Seismic data involving many earthquakes occur-
ring over large regions of space and time exhibit a num-
ber of regularities. These include clustering, fault traces
and epicenter locations with fractal statistics, as well as
scaling laws like the Omori and Gutenberg-Richter (GR)
laws (see e.g. Refs. [12, 13, 32] for a review). Given that
the associated earthquake patterns in space and time are
readily observable, approaches based on the concept of
spatiotemporal point processes have been amply demon-
strated to be feasible [14, 33, 34, 35, 36, 37]. In that case,
the description of seismicity is reduced to recording the
size or magnitude of each earthquake, its epicenter and
its time of occurrence.

To test the suitability of our method to characterize
seismicity in a way that makes it possible to infer relevant
causal features of its dynamics, we study, as in Ref. [27] a
“relocated” earthquake catalog from Southern California
[22] which has improved relative location accuracy within
clusters of similar events, the relative location errors be-
ing less than 100m [38, 39]. The catalog is assumed to
be homogeneous from January 1984 to December 2002
and complete for events larger than magnitude mc = 2.5
[40]. Restricting ourselves to epicenters located within
(32.5◦N, 36.0◦N ) and
the rectangle (120.5◦W, 115.0◦W )

×

FIG. 3: (Color online) Spatial pattern of seismicity in South-
ern California for the earthquake catalog [22] considered here,
as described in the text.

to magnitudes larger than mc gives N = 22217 events
(see Fig. 3). In order to test for robustness and the depen-
dence on magnitude, we analyze this sub-catalog and sub-
sets of it, obtained in two diﬀerent ways: By (a) selecting
diﬀerent threshold magnitudes, namely m = 3.0, 3.5, 4.0
giving N = 5857, 1770, 577 events, respectively, or (b)
using a shorter period from January 1984 to December
1987 giving N = 4744 events for magnitude threshold
m = mc.

Fig. 4 shows recurrences with magnitude m

2.5 de-
ﬁned by our method for one of the biggest events in the
catalog, the Hector Mine earthquake of magnitude 7.1
that occurred on October 16, 1999. The actual spatial
and temporal distance between the Hector Mine event
and each of its recurrences is listed in Table I.

≥

A. Spatial distances of recurrences

Fig. 5 shows the estimated PDF pm(l) that a recur-
rence with magnitude larger than m occurs at a spa-
tial distance l. By deﬁnition, this is the same as the
probability density function of all records for a catalog
with threshold magnitude m. The PDFs exhibit a typical
distance, l∗(m), where the distributions peak, which in-
creases with magnitude. For suﬃciently large l, all distri-

10

243˚24'

243˚36'

243˚48'

34˚36'

34˚24'

34˚12'

34˚00'

34˚36'

34˚24'

34˚12'

34˚00'

243˚24'

243˚36'

243˚48'

FIG. 4: (Color online) Map showing the 7.1 Hector Mine
earthquake and its recurrences as deﬁned by our method. The
size of the symbols linearly scales with the magnitude of the
event and its color corresponds to the time of occurrence (from
red to yellow, to green, to cyan, to blue and to magenta).

TABLE I: List of recurrences of the Hector Mine earthquake
as deﬁned by our method for threshold magnitude m = 2.5.

rank
1
2
3
4
5
6
7
8
9
10

magnitude
6.7
4.2
4.8
4.2
4.2
4.5
2.5
2.5
2.7
2.6

l (km)
74.22
38.25
18.42
2.53
2.34
1.13
0.46
0.41
0.39
0.27

T (h)
0.0095
0.0681
0.0846
0.0922
0.1364
0.2655
2.0353
6.2956
9.3093
46.7896

butions show a power law decay with an exponent
1.05
up to a cutoﬀ. This cutoﬀ corresponds to the size of the
region in Southern California that we consider, and hence
is a ﬁnite size eﬀect. For small distances l < l∗(m), we
observe an approximately linear increase.

≈

With a suitable scaling ansatz, the diﬀerent curves in
Fig. 5 fall onto a universal curve, except at the ﬁnite size
cutoﬀ. The inset in Fig. 5 shows results of a data collapse
using

pm(l)

l−1.05F (l/100.45m) .

(53)

∼

The scaling function F has two regimes, a power-law in-
crease with exponent
2.05 for small arguments and a
constant regime at large arguments. The transition point
between the two regimes can be estimated by extrapo-

≈

FIG. 5: (Color online) Distribution of distances l of recurrent
events for sets with diﬀerent magnitude thresholds m. The
distribution for m = 2.5 up to 1988 is also shown and is al-
most indistinguishable from the data for the full catalog with
m = 2.5 – showing the invariance of the distribution with
respect to the time span of the recorded events. Filled sym-
bols correspond to distances below 100 m and are unreliable
due to location errors. The inset shows a data collapse, ob-
tained by rescaling distances and distributions according to
Eq. (53). The full straight line has slope 2.05; the vertical
dashed line indicates the pre-factor L0 in the scaling law for
the characteristic distance, l

(m) = L0 × 100.45m.

∗

lating them and selecting the intersection point, giving
L0 = 0.012km. For the characteristic distance that ap-
pears in F we ﬁnd

l∗(m)

L0 ×

≈

100.45m.

(54)

1. Discovery of Causal Structure

Although pm(l) has the same overall shape as the dis-
tribution p(l) of the ﬁnite null model (see Eq. (22)), there
are fundamental diﬀerences with respect to the depen-
dence on the time span over which events are recorded.
For the earthquake data, pm(l) and in particular l∗(m)
do not depend on the time span at all but rather depend
directly on m. This conclusion comes from the explicit
comparison of two diﬀerent observation periods in Fig. 5
with the same m. With the exception of the smallest val-
ues of l, p2.5(l) is largely unaltered if only the sub-catalog
up to 1988 is analyzed and l∗ does not change at all. Yet,
in the null model l∗ depends explicitly on the ﬁnite time
span of the observation period, T , as shown in Eq. (24).
Hence the spatio-temporal ordering of earthquakes de-
termines the value of l∗, regardless of the duration of
the observation period – as long as it is large enough to
obtain suﬃcient statistics to determine l∗(m) and small
enough that seismic correlations do not disappear over
that time span. The characteristic length must there-
fore reﬂect robust physical properties of the underlying
dynamics. Its (quasi)-invariance, unlike the null model,

therefore reﬂects causal structure in the dynamics of seis-
micity. As a result, if one re-arranges the seismic cata-
log by “shuﬄing” the locations and magnitudes of events
(see Section IV B 1), then the invariance of l∗ is lost and
the distribution of recurrences behaves the same as the
null model for D = 2 (see Eqs. (22,24)). To sum up:
the invariance of l∗(m) is an indicator of causality and is
thereby a physically meaningful length scale in the dy-
namics of seismicity over the time scales we can explore
with statistical methods – minutes to decades.

2.

Identiﬁcation with the Rupture Length

The almost complete lack of dependence of pm(l) (ex-
cluding very small values of l) on the considered time
span indicates in particular that recurrences with l
≪
l∗(m) are either greatly suppressed at large time scales
l∗(m) are greatly enhanced
or that recurrences with l
≈
at short time scales compared to the null model with
constant rate. As we will show below, it is likely to be a
combination of both eﬀects.

Physically, such a behavior is reasonable if we identify
l∗ with the rupture length of the earthquake that starts
a chain of recurrences. As described by Omori’s law [41],
the rate of seismic activity tends to increase directly after
an earthquake nearby, i.e., close to the rupture area of
the event. Moreover due to the stress relief within the
rupture area itself, it exhibits less seismic activity for
l∗(m) at shorter
awhile. Hence activity increases for l
≈
l∗(m) over longer
times, but gets suppressed for l
times.

≪

′

′

×

≈

×

0.02

10m

100.46 m

This identiﬁcation is also aﬃrmed by the fact that the
scaling of l∗(m) with m is close to the estimated behavior
of the rupture length LR(m′)
/2km given
in Ref. [42] and remarkably close to LR(m′) = √AR ≈
km given in Ref. [43], where m′ is the
0.018
magnitude of the earthquake and AR its rupture area.
The agreement between the latter and Eq. (54) suggests
that the characteristic length scale of distances for re-
current events is indeed the rupture length, deﬁned in
terms of the rupture area l∗ = LR ≡
√AR. Thus, our
approach allows us to recover the rupture length as a
causal consequence of the dynamics purely based on the
spatio-temporal organization of seismicity without any
additional knowledge of the microscopic dynamics and
the actual rupture processes that occur – even, in fact,
treating the seismic events as point like in space and time.
The identiﬁcation l∗ = LR is also consistent with the
fact that the description of earthquakes as a point pro-
cess breaks down at the rupture length. Below that scale,
the relevant distance(s) between earthquakes is not de-
termined solely by their epicenter positions but also by
the relative orientation and size of the extended ruptures
in 3D space. Thus, we expect to ﬁnd a diﬀerent corre-
lation structure for distances smaller than the rupture
In fact, this is precisely what our data show,
length.
l∗(m)
namely a linear increase at small distances, l

≪

11

(see the main part of Fig. 5 and also the straight line
with a slope of 2.05 in the inset of Fig. 5).

3. Robustness of l

(m)

∗

≈

The lengths l∗ observed for the values of m we consider
are larger than the location errors (
100m). Simula-
tions show that p4(l) (blue triangles in Fig. 5) does not
change substantially if the epicenters in the catalog are
randomly relocated by a small distance up to one kilome-
ter. Yet, the maximum for p2.5(l) shifts to larger l with
this procedure, destroying the scaling of l∗(m). Since the
smallest l∗ that obeys the data collapse is
160m, the
data collapse we observe for the original data veriﬁes that
the relative location errors are indeed less than 100 m,
or of that order [44]. Furthermore, the absence of any
anomaly due to location errors near 100m in Fig. 5 indi-
cates that recurrences within the rupture area lack corre-
lations. This is also supported by Eq. (22) which predicts
l for l < l∗ if events are
the observed behavior pm(l)
happening uniformly and randomly in 2D space during
a ﬁnite observation period, or are recorded as happening
randomly in space due to location errors.

≈

∝

4. Spatial Hierarchy of Subsequent Records

To clarify the behavior of pm(l), we break it into dif-
ferent parts, which can be classiﬁed by the rank of the
respective recurrence. Since pm(l) is the PDF that any
recurrence occurs at distance l for a data set with thresh-
old magnitude m, we have for any ﬁnite number of events
N ,

pm(l) =

prec(i)pm

i (l) =

N −1

i=1
X

N −1
i=1 Nipm
N −1
i=1 Ni

i (l)

,

P

(55)

P
where prec(i) is the probability that a randomly chosen
recurrence is an i′th recurrence, Ni
is the number of
events in the sequence that have at least i recurrences (or
out-going links), and pm
i (l) is the conditional PDF that,
given that a recurrence is an i’th recurrence, it happens
at distance l.

Fig. 6 is analyzed according to the ansatz that the dis-
1 (l), has the scaling form

tribution of ﬁrst recurrences, pm

1 (l) = l−δr ˜F (l/100.45 m),
pm

(56)

0.6 and ˜F

≈

with δr ≈
F (see Eq. (53) and the in-
In particular, the same
set of Fig. 5 for comparison).
characteristic distance l∗(m) appears as for pm(l). More-
over, we ﬁnd that the latter is true for all pm
i (l) which is
further evidence that the interpretation of l∗ as the rup-
ture length is correct. The behavior of pm
1 (l) indicated in
Fig. 6 and described by Eq. (56) extends earlier results
for a catalog from Southern California with lower spatial

12

FIG. 6: (Color online) Distribution of distances l of the ﬁrst
recurrence for diﬀerent magnitude thresholds m. Inset: Data
collapse obtained by rescaling distances and distributions ac-
cording to Eq. (56).

FIG. 7: (Color online) Distribution of recurrence distance ra-
tios li+1/li for m = 2.5 and diﬀerent values of i with l0 = 634.3
km. The straight line corresponds to a decay with exponent
0.6.

resolution (
dependence on m [33].

≈

1km) which did not allow to resolve the

Related to the distribution of distances for recurrent
events is the distribution of distance ratios li+1/li of con-
secutive recurrences. Here recurrences are ordered such
that recurrence i + 1 directly follows recurrence i. For
i = 0, we take l0 = 634.3 km, which is the largest pos-
sible distance in the region covered by the catalog. By
construction these ratios are always between zero and
one. We denote by qm
i (x) the PDF that li+1/li = x for
each event that has an (i + 1)th recurrence. As indicated
in Fig. 7, the data for m = 2.5 and i = 0 (black circles)
x−δr with δr ≈
scale over a wide region as q2.5
0.6.
∼
pm
This is expected since qm
1 (l). Although each
0 (x)
distribution q2.5
1 also
show (more restricted) power law decay comparable to
q2.5
1 they also exhibit a peak that be-
0 (x). For li+1/li →
comes more pronounced with increasing i. This is due to
recurrences occurring at almost the same distance (but
not at the same place!) conﬁrming that recurrences are
suppressed close by, within the rupture area, but are en-
hanced just outside that area.

∼
(x) is diﬀerent, the curves for i

0 (x)

≥

i

i

(x) and pm

The observed behavior of q2.5

1 (l) is very dif-
ferent from the behavior predicted by the null model.
For the null model,
in the long time limit, Eq. (44)
i (x) = DxD−1 which is not only independent of
gives qm
i but also purely determined by D – and is increasing
for D > 1 rather than decreasing. Similarly, Eq. (43)
lD−1 for the null model. For Southern
gives pm
California, it has been found that D = D2 = 1.2 [33, 34],
x0.2
which would lead to an increasing function qm
rather than a decaying power law behavior. Although
the above predictions of the null model are only strictly
true in the inﬁnite time limit, we point out that repeat-
ing this analysis for a “shuﬄed” catalog reveals behavior
in agreement with the null model and diametrically op-

i (x)

1 (l)

∼

∝

posed to the results shown in Fig. 7 for the actual seismic
record [34].

i

(x) and pm

Thus, the observed behavior of q2.5

1 (l) as
well as the value of δr are not determined by the spatial
distribution of seismicity alone but reﬂect causal struc-
tures leading to the complex spatiotemporal organization
of seismicity. Moreover, the shape of pm
1 (l) shows that the
ﬁrst recurrence is much more likely to happen at a typical
distance of l∗ than predicted by the null model. This en-
hancement goes along with a suppression of recurrences
l∗ as the increasing (with i) peak at x = 1 for
with l
qm
i (x) indicates. These results conﬁrm the overall picture
l∗(m) are greatly suppressed
that recurrences with l
l∗(m) are
at large time scales while recurrences with l
greatly enhanced at short time scales.

≪

≪

≈

B. Network properties

i

We now turn to the analysis of seismicity in terms
of the topology of its network of recurrences. Fig. 8
shows the in- and out-degree histograms for diﬀerent val-
ues of m, which are compared to Poisson distributions
with the same respective mean degree and normaliza-
= 7.40, 6.24, 5.20, 4.35 for m = 2.5, 3.0, 3.5, 4.0,
k
tion (
h
respectively). A Poisson out-degree and in-degree distri-
bution is expected for the null model (see Eq. (47) and
Eq. (50)). For the actual seismic network, the out-degree
distributions are signiﬁcantly diﬀerent from a Poissonian
[45]. In particular, the network keeps a preponderance
of nodes with small out-degree as well as an excess of
nodes with large out-degree compared to a Poisson dis-
tribution. This eﬀect becomes more pronounced with
increasing magnitude. The behavior of the out-degree
distribution implies that the network topology is able to
discern consequences of the causal structure of seismicity.
For the in-degree distributions, we ﬁnd that they roughly

13

FIG. 8: (Color online) In- and out-degree histograms for dif-
ferent values of m. Open (red) symbols correspond to the in-
degree, ﬁlled (black) symbols correspond to the out-degree.
Error bars can be estimated as
N (k). The red lines corre-
spond to Poisson distributions with the same respective mean
and normalization.

p

Note, however, that

agree with a Poisson distribution although there are still
signiﬁcant deviations from the null model for k = 1 [46].
— which is the same for the
in- and out-degree — decreases with m, simply because
the number of events N shrinks with m. This is shown in
Fig. 9 where
is also displayed for a randomly shuﬄed
catalog.

k
h

k
h

i

i

1. Shuﬄing Procedure

≥

The shuﬄing was performed in the following way: Con-
sider all events in the catalog with magnitude m′
mc =
2.5. Shuﬄe the magnitudes and the epicenter locations
separately, keeping the times of occurrence, and then ap-
ply the recurrence analysis for the diﬀerent subsets de-
ﬁned by diﬀerent magnitude thresholds as before. The
shuﬄed catalog can, thus, be considered as a realization
of a random process with no spatiotemporal correlations.
Based on the null model and Eq. (47), we expect a Pois-
son out-degree distribution with
ln N which is
exactly what we ﬁnd for the randomly shuﬄed catalog.
This dependence of
can be clearly seen in Fig. 9. Yet,
for the original earthquake data we ﬁnd for large N

i ≈

k
h

k
h

i

k
h

i ≈

0.8 ln N.

(57)

Hence, the average number of recurrences is signiﬁcantly
less than for the null model, which is presumably related
to the fact that recurrences with l < l∗(m) are suppressed
– as discussed earlier. Fig. 9 gives further evidence that
recurrences emphasize particular aspects of spatiotem-
poral clustering, associated with the causal dynamics of
seismicity.

(Color online) Mean degree hki as a function of
FIG. 9:
number of events N (or magnitude m). Open symbols cor-
respond to the original catalog for diﬀerent values of m,
while ﬁlled symbols correspond to the shuﬄed catalog (see
text). The lines correspond to best ﬁts giving hkioriginal =
−1.03 + 0.84 ln N and hkishuf f led = −0.47 + 1.01 ln N .

2. Degree-degree Correlations

The causal structure of seismicity does not, however,
induce strong degree-degree correlations between events
and their recurrences other than those arising from the
temporal order of a ﬁnite sequence of events – as in the
acausal null model. Panels A to C in Fig. 10 show the
average out-degree and in-degree of recurrences as a func-
tion of the in-degree or out-degree of their corresponding
Event-0 [47]. There are no qualitative diﬀerences be-
tween the actual earthquake catalog from California and
a surrogate, which is a randomly shuﬄed version of the
In particular, the behavior shown in panel A
catalog.
and B agrees with the acausal null model (see discussion
following Eq. (52)). Note that the oﬀset between the
two data sets is simply due to diﬀerent
of the two
networks.

k
h

i

kout
h

The situation is diﬀerent for the dependence of the
mean out-degree on the in-degree of the same node. As
has a weak dependence on kin in
shown in Eq. (52),
i
decreases with kin. This
kout
the null model such that
h
is exactly what we ﬁnd for the shuﬄed catalog as shown
in panel D of Fig. 10. However, the same panel also
shows that for the actual earthquake catalog
in-
creases with kin – exactly the opposite of the null model.
Moreover, kin <
implies kout <
on average. This
is again consistent with a causal dynamics where earth-
quakes are clustered in space and time.

kout
h

k
h

k
h

i

i

i

i

14

which is the value for the shuﬄed catalog. It has to be
pointed out, though, that the average is performed over a
diﬀerent number of nodes in the two cases since the shuf-
ﬂed catalog hardly contains any events with out-degree
equal to one. For the shuﬄed catalog, there are only 15
events with kout = 1, which is close to the expected value
of 10.6 for the random model – see Eq. (48). This value
is two orders of magnitude less than for the original data.
Another diﬀerence between the two data sets is the
distribution of Ci. For the actual earthquake data, the
distribution is much broader. The standard deviation
for the distribution is 0.2146 compared to 0.0934 for the
shuﬄed catalog. This diﬀerence is mainly due to the fact
that the original data contain many events with Ci = 0
or Ci = 1 – unlike the shuﬄed catalog.

C. Temporal distances of recurrences

(Color online) Distributions of recurrence times
FIG. 11:
for diﬀerent threshold magnitudes m. The distribution for
m = 2.5 up to 1988 is also shown. Filled symbols correspond
to times below 90 seconds which are underestimated and un-
reliable due to measurement restrictions. The inset shows the
rescaled distributions.

The temporal distances between events and their re-
currences can be analyzed in the same way as the spa-
tial distances. The PDF pm(t) for the recurrence times
for diﬀerent threshold magnitudes m is shown in Fig. 11.
These all decay roughly as 1/tα with α
0.9 for interme-
diate times as indicated in the inset. The apparent scal-
ing region in Fig. 11 shows some curvature, though. Due
to the ﬁnite duration of the catalog, there is an observa-
tional cut-oﬀ at the longest time scales. At the shortest
time scales, pm(t) goes over to a constant limit. While
the shape of the distribution is roughly similar to the null
model (see Eq. (23)), pm(t) for the earthquake catalog is
independent of m and, hence, the number of events in the
catalog. This invariance is (again) at odds with the null
model where the temporal rate Λ = abRD determines the

≈

FIG. 10: (Color online) The average in-/out-degree of the
recurrences of all nodes with a given in-/out-degree (A-C)
for m = 2.5. Open (black) circles correspond to the origi-
nal earthquake catalog from California, ﬁlled (blue) diamonds
correspond to the shuﬄed catalog. The mean degree is indi-
cated by the (red) solid line and the (orange) dashed line, re-
spectively. Panel D shows the average out-degree of a node as
a function of its in-degree. Open (green) circles correspond to
the original earthquake catalog from California, ﬁlled (blue)
diamonds correspond to the shuﬄed catalog. The black dash-
dotted line is the approximation for the null model given in
Eq. (52).
In this panel, the behavior of the original earth-
quake data is qualitatively very diﬀerent from the null model
and the shuﬄed catalog.

3. Clustering coeﬃcient

Other network properties include various measures of
clustering.
In general terms, clustering quantiﬁes how
well connected the neighbors of a node are among them-
selves. In the case of recurrences, it refers to the likeli-
hood that recurrences of the same event are also recur-
rences of each other. There are diﬀerent, inequivalent
deﬁnitions of the clustering coeﬃcient C [48]. Here we
focus on the deﬁnition based on the local clustering co-
eﬃcient Ci adapted to directed networks.

For all nodes i with out-degree larger than one, the
clustering coeﬃcient Ci is given by the ratio of existing
links Ei between its kout
recurrences to a possible num-
ber of such links, 1
2 kout
1). Then the clustering
i −
coeﬃcient C of the network is deﬁned as the average over
all nodes i with out-degree larger than one

(kout

i

i

C =

=

Cii
h

2Ei
(kout

kout
i

(cid:28)

i −

1)

(cid:29)i

.

(58)

This deﬁnition implies, for example, that the cluster-
ing coeﬃcient of an Erd¨os-Renyi graph is equal to the
the probability of linking each pair of nodes, plink =
k
h

/(N
i
For the data from California, we obtain C = 0.2647 for
m = 2.5. This is signiﬁcantly larger than C = 0.1825,

1) = Crand.

−

transition point and Λ itself depends on the number of
events N as shown in Eqs. (25,27).

As described below, the analysis for the shuﬄed cata-
log shown in Fig. 12 is consistent with the acausal null
model. As predicted by the null model, the distributions
for the shuﬄed catalog must be rescaled by the rate of
events in order to obtain a data collapse. Furthermore,
the invariant behavior (with respect to magnitude m) we
observe for recurrences in the original catalog diﬀers sub-
stantially from earlier results for waiting time distribu-
tions between subsequent earthquakes [34, 35, 36, 37]. It
reﬂects a new non-trivial feature of the spatiotemporal
dynamics of seismicity that appears when events other
than the immediately subsequent ones – used to conven-
tionally deﬁne waiting times – are considered.

FIG. 12: (Color online) Distributions of recurrence times in
the shuﬄed catalog (see text) for diﬀerent threshold magni-
tudes m. Filled symbols correspond to times below 90 seconds
which are underestimated and unreliable due to measurement
restrictions. The inset shows the distributions rescaled by the
respective rate of events Λm. The solid line corresponds to a
best ﬁt assuming the functional form given in Eq. (23). The
dashed line highlights the transition point between the con-
stant behavior and the 1/t decay.

For the shuﬄed catalog, pm(t) closely follows the the-
oretical prediction of Eq. (23) and in particular the de-
pendence on m – or rather on N through Λ. As shown
in the inset of Fig. 12, the diﬀerent distributions — with
the obvious exception of the observational cut-oﬀ at the
largest time scales — collapse onto a single curve if t
is rescaled by the respective rate Λm. Here, Λm is the
mean rate of earthquakes above magnitude threshold m
for the observation period. Notably, the main deviation
from the stationary null model is that the location of the
transition point for the shuﬄed catalog is not at Λmt = 1
but rather at Λmt = 0.02. This is expected and due to
the fact that the rate of seismic activity — which is pre-
served in the shuﬄed catalog — is not constant over time
but exhibits large ﬂuctuations as indicated, for example,
by Omori’s law [41].

The relative times between subsequent recurrences in

15

i

the hierarchy can be analyzed in the same way as dis-
tances were in Sec. IV A 4. Fig. 13 shows the PDFs for
the ratios ti/ti+1 for subsequent recurrences. For the
cases shown, two power-law regimes seem to exist: For
arguments smaller than about 10−3, q2.5
(ti/ti+1) decays
0.6 roughly independent of i, for
with an exponent δt ≈
larger arguments the decay is slower and the exponent
apparently decreases further with i. Clearly, the broad-
est scaling regime materializes for t1/t2.

The behavior of q2.5

1 (t1/t2) for 10−3 < t1/t2 ≪

1 could
be compared to Eq. (38), although the latter was derived
for the translational invariant case. Equally important,
Eq. (38) only holds for the stationary null model. As dis-
cussed above, seismic activity is not constant over time
but exhibits large ﬂuctuations. Fig. 13 shows that these
ﬂuctuations as well as the loss of translational invariance
are responsible for the behavior for arguments larger than
about 10−3, since there is no observed diﬀerence between
the original and the shuﬄed catalog. Yet, the devia-
tions between the original data and the shuﬄed catalog
for smaller arguments indicate that these arise from the
complex spatiotemporal organization of seismicity.

V. SUMMARY

This paper provides a method to detect features in a
temporal sequence of observations that can be plausibly
attributed to causal dynamics even when the observer
has no a priori knowledge of the underlying dynamics.
Our starting point is to generalize the concept of a re-
currence for a point process in time to recurrent events
in space and time. An event is deﬁned to be a recur-
rence of any previous event if it is closer to it in space
than all the intervening events; i.e.
if it constitutes a
record breaking event. Hence, the causal structure of
events may be described as a network of events linked
to their recurrences. Each event can have many previ-
ous events pointing to it (its potential causes) and many
future events (its eﬀects). Causality can be plausibly in-
ferred when the statistical properties of the network and
the statistics of the records deviate strongly from those
resulting from almost any acausal process.

We derive analytically many properties for the net-
work of recurrent events composed by a random process
in space and time. In doing so, we develop a fully sym-
metric theory of records where both the variable in which
records occur and time, itself, are continuous. This sim-
pliﬁes the theory and in our view makes it more elegant.
We discover a number of new results for record breaking
statistics.

Many of those results are compared to the network
synthesized from time series of epicenter locations for
earthquakes in Southern California. Signiﬁcant dispari-
ties that can be attributed to causality are mainly coming
from the invariance of network statistics with the time
span of the events considered. This is presumably re-
lated to an observed hierarchy in the distances and times

16

FIG. 13: (Color online) Distribution of recurrence time ratios ti/ti+1 for m = 2.5. The straight line has slope -0.62. Open
symbols correspond to the original earthquake catalog, ﬁlled symbols to the shuﬄed catalog (see text).

of subsequent recurrences. As a result a fundamental
length scale for recurrences is obtained solely from the
earthquake epicenter data, which can be identiﬁed as the
rupture length. All these signiﬁcant deviations disappear
when the analysis is repeated for a surrogate in which the
original magnitudes and locations of earthquake epicen-
ters are randomly “shuﬄed”. Almost all of the latter
results are completely consistent with predictions from
the acausal null model.

Our results are robust with respect to modiﬁcations of
the rules used to construct the network, e.g., using spatial
neighborhoods such that the construction becomes sym-
metric under time reversal or taking into account mag-
nitudes. All such modiﬁcations have the drawback that
they do not deﬁne a record breaking process consisting of
recurrences to each event. Our results are also unaltered
if we exclude links with propagation velocities larger than
6km/sec (

0.1% of all links) which are unphysical.

≈

By building certain speciﬁc features of causality into
null models, it is possible to reﬁne predictions and ex-
amine what features in the network of seismicity are due
to those aspects of causality and what are yet to be ex-
plained. It remains to be seen how general our method
will turn out to be. In principle it can be applied to any
high resolution data set where events occur in space and
time.
Immediate applications may include analyses of
other geophysical or astrophysical data sets, or analyses
of models to validate or falsify them.

Acknowledgments

We thank the Southern California Earthquake Center

(SCEC) for providing the data.

[1] P. J. Cote and L. V. Meisel, Phys. Rev. Lett. 67, 1334

(1991).

410, 242 (2001).

[2] J. P. Sethna, K. A. Dahmen, and C. R. Myers, Nature

[3] K. Nagel and M. Paczuski, Phys. Rev. E 51, 2909 (1995).
[4] P. Bak, How nature works (Copernicus, New York, 1996).
[5] P. Bak, K. Chen, and C. Tang, Phys. Lett. A 147, 297

[6] D. L. Turcotte, Rep. Prog. Phys. 62, 1377 (1999).
[7] J. P. Crutchﬁeld and P. Schuster, Evolutionary Dynam-
ics: Exploring the Interplay of Selection, Accident, Neu-
trality, and Function (Oxford University Press US, NY,
NY, 2003).

[8] B. Drossel, Advances in Physics 50, 209 (2001).
[9] W. R. Softky and C. Koch, Neural Computation 4, 643

(1990).

(1992).

[10] D. Hughes, M. Paczuski, R. O. Dendy, P. Helander, and
K. G. McClements, Phys. Rev. Lett. 90, 131101 (2003).

[11] M. Paczuski and D. Hughes, Physica A 342, 158 (2004).
[12] D. L. Turcotte, Fractals and chaos in geology and geo-
physics (Cambridge University Press, Cambridge, UK,
1997), 2nd ed.

[13] S. Stein and M. Wysession, An introduction to seismol-
ogy, earthquakes, and earth structure (Blackwell Publish-
ing, Oxford, UK, 2002).

[14] M. Baiesi and M. Paczuski, Nonlin. Proc. Geophys. 12,

1 (2005).

59, 381 (1987).

[15] P. Bak, C. Tang, and K. Wiesenfeld, Phys. Rev. Lett.

[16] W. Marzocchi, L. Zaccarelli, and E. Boschi, Geophys.

Res. Lett. 31, L04601 (2004).

[17] In fact this is the deﬁnition of the ǫ- recurrence as dis-

cussed in Ref. [49].

[18] A. Helmstetter, G. Ouillon, and D. Sornette, J. of Geo-

phys. Res. 108, 2483 (2003).

[19] N. Glick, The American Mathematical Monthly 85, 2

[24] M. Baiesi, Physica A 360, 534 (2006).
[25] R. Albert and A.-L. Barabasi, Rev. Mod. Phys. 74, 47

[42] Y. Y. Kagan, Bull. Seismol. Soc. America 92, 641 (2002).
[43] D. L. Wells and K. J. Coppersmith, Bull. Seismol. Soc.

[20] V. B. Nevzorov, Theory Prob. Appl. 32, 201 (1987).
[21] V. B. Nevzorov, Records: Mathematical theory, vol. 194
of Translations of Mathematical Monographs (American
Mathematical Society, Providence, Rhode Island, 2001).
from

obtained
catalog
http://www.data.scec.org/ftp/catalogs/SHLK/.

[22] The

seismic

was

[23] M. Baiesi and M. Paczuski, Phys. Rev. E 69, 066106

(1978).

(2004).

(2002).

[26] M. E. J. Newman, SIAM Review 45, 167 (2003).
[27] J. Davidsen, P. Grassberger, and M. Paczuski, Geophys.

Res. Lett. 33, L11304 (2006).

[28] A. Shreim, P. Grassberger, W. Nadler, B. Samuelsson,
J. E. S. Socolar, and M. Paczuski (2006), archive preprint
cond-mat/0610447.

[29] B. B. Mandelbrot, in Fractal Geometry and Stochastics,
edited by C. Bandt, S. Graf, and M. Z¨ahle (Birkh¨auser
Verlag, Basel, 1995).

[30] P. Sibani, M. Brandt, and P. Alstrøm, Int. J. Mod. Phys.

12, 361 (1998).

[31] J. Krug and K. Jain, Physica A 358, 1 (2005).
[32] J. B. Rundle, D. L. Turcotte, R. Shcherbakov, W. Klein,
and C. Sammis, Review of Geophysics 41, 1019 (2003).
[33] J. Davidsen and M. Paczuski, Phys. Rev. Lett. 94,

048501 (2005).

L21612 (2004).

Rev. Lett. 88, 178501 (2002).

[36] A. Corral, Phys. Rev. E 68, 035102 (2003).

17

[37] A. Corral, Phys. Rev. Lett. 92, 108501 (2004).
[38] P. Shearer, E. Hauksson, G. Lin, and D. Kilb, Eos Trans.

[39] P. Shearer, E. Hauksson, and G. Lin, Bull. Seismol. Soc.

[40] S. Wiemer and M. Wyss, Bull. Seismol. Soc. America 90,

AGU 84, 46 (2003).

America 95, 904 (2005).

859 (2000).

of Tokyo 7, 111 (1894).

[41] F. Omori, Journal of College Science, Imperial University

America 84, 974 (1994).

[44] Note that a systematic dependence of the location error
on magnitude has not been reported in the literature and
is also not present in the catalog at hand. It is unlikely
that the characteristic length we see (l
(m)) is merely an
artifact due to location error growing with magnitude.

∗

[45] For m = 2.5, the hypothesis that the out-degree distribu-
tion is Poissonian is rejected by the χ2-test at the 99.5%
signiﬁcance level. Speciﬁcally, we ﬁnd χ2
0 = 66.7 × 103 for
22 degrees of freedom.

[46] For m = 2.5, the hypothesis that the in-degree distribu-
tion is Poissonian is rejected by the χ2-test at the 99.5%
signiﬁcance level. Speciﬁcally, we ﬁnd χ2
0 = 88.7 for 15
degrees of freedom.

[47] The averages were performed over all links emanating
from events with ﬁxed in-degree or out-degree, respec-
tively.

[34] J. Davidsen and C. Goltz, Geophys. Res. Lett. 31,

[48] S. N. Soﬀer and A. V´azquez, Phys. Rev. E 71, 057101

[35] P. Bak, K. Christensen, L. Danon, and T. Scanlon, Phys.

[49] J.-P. Eckmann, S. O. Kamphorst, and D. Ruelle, Euro-

(2005).

phys. Lett. 4, 973 (1987).

