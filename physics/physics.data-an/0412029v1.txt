4
0
0
2
 
c
e
D
 
4
 
 
]
n
a
-
a
t
a
d
.
s
c
i
s
y
h
p
[
 
 
1
v
9
2
0
2
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Spectral Mixture Decomposition by Least
Dependent Component Analysis

Sergey A. Astakhov a,∗, Harald St¨ogbauer a,
Alexander Kraskov a,b, Peter Grassberger a

aJohn von Neumann Institute for Computing, Forschungszentrum J¨ulich,
D-52425, J¨ulich, Germany
bDivision of Biology, California Institute of Technology, Pasadena, CA 91125,
USA

Abstract

A recently proposed mutual information based algorithm for decomposing data
into least dependent components (MILCA) is applied to spectral analysis, namely
to blind recovery of concentrations and pure spectra from their linear mixtures. The
algorithm is based on precise estimates of mutual information between measured
spectra, which allows to assess actual statistical dependencies between them. We
show that linear ﬁltering performed by taking second derivatives eﬀectively reduces
the dependencies caused by overlapping spectral bands and, thereby, assists re-
solving pure spectra. In combination with second derivative preprocessing, MILCA
shows decomposition performance comparable with modern specialized chemomet-
rics algorithms. The results are illustrated on a number of simulated and experi-
mental (infrared and Raman) mixture problems, including spectroscopy of complex
biological materials.

Key words: multivariate curve resolution, independent component analysis (ICA),
mutual information, MILCA, nonnegativity

1 Introduction

The problem of estimating parameters (concentrations and pure spectra) of
a linear mixture model underlying a set of spectroscopic measurements has
spurred growth of more than 20 algorithms [1] that now form an arsenal
∗ Corresponding author: Tel.: +49 2461 612315; Fax: +49 2461 612430.
Email address: s.astakhov@fz-juelich.de (Sergey A. Astakhov).

Preprint submitted to Analytica Chimica Acta

20 February 2014

known as multivariate self-modeling curve resolution tools (for reviews see
[2,3,4,5,6,7,8,9]). Although advanced to the point that they have been imple-
mented as commercial software (e.g., [10,11,12,13]), these techniques still leave
space for new developments [14,15,16].

In their pioneering work, Lawton and Sylvestre [17] proposed decomposition of
mixed spectral signals into independent pure components. In practice, this will
not be feasible, since diﬀerent chemical species do not necessarily have com-
pletely independent spectra (e.g., because they may contain same or similar
functional groups). Thus, any residual statistical dependencies in the recovered
sources might either signal a failure of the method, or reﬂect the fact that the
goal of achieving independent spectra was inconsistent. Aside from that, there
have been only relatively few attempts [18,19,20,21,22,23,24,25,26,27,28,29] to
use statistical (in)dependence of recovered sources (measured, e.g., by mutual
information [30]) as a criterion in multivariate curve resolution.

Viewed in a broader context, using these statistical dependencies constitutes
the basis for the rapidly growing ﬁeld of Independent Component Analysis
(ICA) or, more generally, Blind Source Separation (BSS) [31,32,33,34,35]. A
speciﬁc feature of multivariate spectral curve resolution is that in most spec-
troscopic techniques the instrumental signals are nonnegative. In ICA or BSS,
sources are not generally assumed to be of deﬁnite sign, although there are a
number of papers [36,37,38,39,40,41] in the BSS literature which deal specif-
ically with non-negative sources. Clearly, such methods capable of eﬃcient
decomposing nonnegative mixtures can be of potential use in analytical prac-
tice.

The ICA approach rests on the underlying assumption of statistical indepen-
dence of original (pure) sources [32,33]. In such a case pure signals can be
recovered by ﬁnding a demixing transformation that minimizes dependencies
between estimates. If the original independent sources and concentrations are
positive, then also the estimates should be so [39] and nonnegativity can be
used as a test of decomposition. Alternatively, nonnegativity may serve as a
target property in optimization, together with other properties such as max-
imal independence (see, for example, the Nonnegative PCA algorithm [40,41]
and several chemometrics techniques that use the nonnegativity constraint
[1,12,15,16,17,42]).

As we already pointed out, in realistic problems the original spectral signals
are not perfectly independent (“overlapping bands”). These dependencies orig-
inate from similarities in the chemical structure, e.g., due to the presence of
similar functional groups. Such mixtures are typically hard to decompose. This
raises diﬃculties in straightforward use of general purpose ICA algorithms. In
spectral analysis, the overlap problem has motivated the development of spe-
cialized curve resolution methods. For instance, one group of algorithms is

2

based on the idea of “pure variables” [43]. A “pure variable” is a wavelength
at which only one of the components contributes. Determination of pure vari-
ables for all mixture components is then a key to decomposition. This way
to avoid the problem of overlapping bands was successfully implemented in
several algorithms, e.g., KSFA [44], SIMPLISMA [10], and IPCA [45]). More
recently, Band-Target Entropy Minimization (BTEM [16,46]) has been pro-
posed which involves an explicit (made by visual inspection [16]) choice of
spectral features (target regions) to be retained in the course of constrained
optimization. While eﬃcient and highly ﬂexible, supervised band selection has
the drawbacks of being neither fully automated nor completely blind [2].

Since ICA is in most applications confronted with signals that cannot be lin-
early decomposed into independent sources, a more proper name would in
such cases be “Least dependent Component Analysis” (LCA). Analyzing de-
pendencies between reconstructed sources should then be an integral part of
the method. A technical problem for such an analysis is the need for fast, ro-
bust, precise and bias free estimators for mutual information (MI). In a recent
paper we employed a novel MI estimator with notably improved properties
[47] in what we called Mutual Information based Least dependent Component
Analysis (MILCA [48]). MILCA combines several features: (i) a high perfor-
mance ICA algorithm; (ii) output reliability tests; (iii) cluster analysis of re-
constructed sources for residual interdependencies; and (iv) joining highly de-
pendent sources into multi-dimensional sources. It has been extensively tested
and compared to other ICA algorithms on various blind separation problems.
MILCA was found to outperform existing algorithms based on cruder approxi-
mations of mutual information (or other measures of independence) [48]. Some
of those, e.g., FastICA [18,19,20,21,22,25,26,28], JADE [21,23,24,34], Infomax
[27,35], had been employed in earlier applications of ICA to spectral curve
resolution.

In this paper we study the potential of MILCA, assisted by proper data pre-
processing, in model-free blind spectral curve resolution. Unlike specialized
chemometrics techniques, MILCA does not make use of nonnegativity, nor
does it rely on band selection in any form. One could of course include vio-
lations of nonnegativity in some way as a contribution to the cost function
(which would otherwise be just the mutual information) to be minimized.
However, we will not do this here, partly because it is not a priori clear how
to weight these two contributions. Instead, the present study elaborates on
how violations of nonnegativity correlate with the quality of decomposition,
and we will make direct comparisons with other chemometrics algorithms.

The paper has the following structure. Section 2 introduces our approach to
computing mutual information. It gives a description of the MILCA algorithm
along with the preprocessing and measures of performance used. In Section 3
the data sets analyzed in this work are brieﬂy described. Section 4 concentrates

3

on main results and, ﬁnally, conclusions are in Section 5.

2 Methods

2.1 Mutual information

For a multivariate continuous random variable (X1, X2, ..., XM ) with given
marginal and joint densities µi(xi) and µ(x1, x2, ..., xM ), the mutual informa-
tion is given by [30,47,48,49]

I(X1, X2, ..., XM ) =

H(Xi) − H(X1, X2, ..., XM ),

M

Xi=1

H(Xi) = −

µi ln µidxi

Z

where

and

H(X1, X2, ..., XM ) = −

µ ln µ dx1dx2...dxM

Z

are the diﬀerential entropies [30].

The MI is a measure of statistical dependence of the M variables, which means
that it is zero if they are strictly independent, and it is positive otherwise. The
advantages of MI is that it is sensitive to all types of dependencies (while, e.g.,
Pearson’s coeﬃcient is sensitive only to linear correlations) and it has a well
deﬁned information theoretic meaning. Also, due to the grouping property [47],
it can be decomposed for any partitioning of the set {X1, X2, ..., XM } into de-
pendencies within groups of Xi and dependencies between these groups, e.g.,
I(X1, X2, X3) = I(X1, X2) + I((X1, X2), X3). This leads directly to a con-
ceptually extremely simple method of mutual information based hierarchical
clustering (MIC [49]).

When the variables Xi represent experimental measurements, information
about them is usually given by a ﬁnite number of samples (realizations)
xk
i , k = 1, 2, . . . , N, and MI has to be estimated by statistical inference.
In our present case, the raw data will be an M × N matrix X of M spectra

4

(1)

(2)

(3)

xi sampled at N wavelengths (frequencies) νk each

X =

1 x2
x1
2 x2
x1

1 . . . xN
1
2 . . . xN
1
. . . . . . . . . . . .

M x2
x1

M . . . xN
M













.













(4)

Note that we view each spectrum as a random variable Xi (i = 1, 2 . . . , M)
and the N spectral values xk
i , k = 1, 2, . . . , N as its realizations. This should
be contrasted to the alternative point of view where each spectral value at
a given frequency νk deﬁnes a random variable Xk, k = 1, 2, . . . , N, and
xk
i , i = 1, 2, . . . , M are its realizations. Our task consists in computing (and
subsequently minimizing) the MI estimator ˆI(X) of the spectral data given by
Eq. (4). Obviously, the realizations ξk = (xk
M ) are not independent
of each other, but in the following we shall neglect this and use estimators
developed for independent identically distributed realizations.

2, . . . , xk

1, xk

The estimators given in [47] (which are actually closely related to the estimator
for diﬀerential Shannon entropies used in [50]) are based on k-nearest neighbor
statistics. They have been shown to give rather precise estimates of MI in
any dimension M. In particular, they seem to be numerically free of bias for
independent signals (when MI is equal to zero). But even when this is not the
case, their bias and variance seem to be smaller than those of other estimators
[47].

2.2 Least dependent component approach

As in the basic multivariate curve resolution setting, linear ICA starts out
with a mixture model in the form

X = AS,

(5)

where X is a M × N matrix of mixed signals, S is a K × N matrix of unknown
pure components (s1, s2, ..., sK), and A is an M ×K mixing matrix (concentra-
tions). The problem is to reconstruct blindly S and A from the observations
X, assuming that the original sources are as “independent” as possible. More
precisely, the demixing transformation W (which is an estimate for A−1) is
sought such that it minimizes the mutual information estimator ˆI(Y) of the
estimated components Y = WX. The ICA decomposition is deﬁned up to
scaling (intensity ambiguity [51]) and permutation of sources [39]. In the sim-
plest version of the MILCA algorithm which we apply here, the MI between

5

components yi is computed at equal frequencies νk (possible dependencies
between sources at diﬀerent frequencies can be assessed, e.g., using “delay”
vectors; for details on this technique and also for a non-instantaneous mixing
ansatz see [48]).

The ﬁrst step in ICA usually comprises principal component analysis (PCA),
also called prewhitening [32], which minimizes linear correlations in the data.
The number of sources (K ≤ M) is estimated in PCA by taking only decorre-
lated components with highest eigenvalues. Then the demixing transformation
splits into a K × M prewhitening matrix V and a square rotation matrix R:

W = RV.

(6)

Thus, the ICA problem reduces to searching the minimum of ˆI(Y) under pure
rotation Y = RZ of prewhitened vectors Z = VX. An important simpliﬁca-
tion comes from the fact that rotation matrix can be further decomposed
K
i,j Ri,j, where each two-dimensional rotation Ri,j acts on (zi, zj)
into R =
and is obtained so that it minimizes pairwise mutual information ˆI(yi, yj).
Convergence to the minimum of ˆI(Y) is achieved once all Ri,j have been opti-
mized iteratively (for implementation details we refer to [48]). Drawing a line
to curve resolution methods, R resolves rotational ambiguity [51] by bringing
the estimates as close to the initial independence assumption as possible.

Q

The use of proper preprocessing of data can signiﬁcantly improve performance
of curve resolution algorithms. Here we study how MILCA performs on second
derivative (SD) spectral data which are known to be better suited for spectral
analysis of complex mixtures [19,52,53,54,55,56] than the original spectra. We
will explain why such preprocessing improves ICA decomposition performance.
Speciﬁcally, one proceeds from original mixture vectors X to their second
derivatives X′′ with respect to frequency (wavelength), approximated either
by ﬁnite diﬀerences

∼ x(νk−1) − 2x(νk) + x(νk+1),

(7)

d2x(ν)
dν2

(cid:12)
(cid:12)
νk
(cid:12)
(cid:12)
(cid:12)

or by means of smoothing polynomial Savitzky-Golay diﬀerentiation [57].
Then, PCA and MI minimization can be performed on X′′, yielding W′′ and
Y′′ (here and below double primes indicate quantities estimated using SD
data, whereas superscript (0) will indicate estimates obtained in the original
space). Due to linearity of Eqs. (5) and (7), W′′ represents an estimate for
demixing matrix A−1. The estimates for pure spectra (in the original space)
can be recovered by applying the demixing transformation W′′ on the original

6

measured mixture signals

Y = W′′X.

2.3 Measures of performance

(8)

(9)

(10)

(11)

Bearing the scaling and permutation ambiguities in mind, a good quality mea-
sure for ICA results is the Amari index [33,48,50], which quantiﬁes how well
the demixing transformation W agrees with true mixing matrix A (if such is
known)

P (W, A) =

1
2K

K

(
Xi,j=1

|pij|
maxk |pik|

+

|pij|
maxk |pkj|

) − 1,

where pij = (WA)ij. The Amari index P vanishes if W deviates from A−1
only in scaling and permutation of elements, and it increases as the quality of
decomposition becomes poor.

Other measures of decomposition performance are applied to match recon-
structed components with pure original sources. To compare our results with
those of [16], we shall use the inner product of normalized pure and estimated
spectral vectors

In addition, we introduce a scaled overall measure of positivity of the K vectors
yi forming the matrix Y

i(y, s) =

(y · s)
|y||s|

.

π(Y) =

1
K

K

Xi=1

j:yij>0 yij
N
j=1 |yij|

.

P

P

3 Spectral data

If all vectors are strictly positive, π(Y) = 1, while it is less than one otherwise.

Four exemplary data sets (A through D) taken from the literature were cho-
sen to evaluate the performance of MILCA on typical spectral curve resolution

7

problems. These included both artiﬁcial and experimental mixtures with var-
ious number of components M, number of data points N and quality (e.g.,
noise level, presence of experimental background, line widths).

3.1 Simulated 3-component mixtures (A)

To compose a statistically representative test set of randomized mixtures we
ﬁrst collected a pool of 99 experimental infrared absorption spectra in the
range 550 − 3830 cm−1 (822 data points each) taken from the NIST database
[58]. The set was selected to contain organic compounds having common struc-
tural groups (halogen-, alkyl-, nitro-substituted benzene derivatives, phenols,
alkanes; alcohols, thiols, amines, esters), so that their spectra have multiple
overlapping bands and are, thereby, mutually dependent. After that a sam-
ple of 10000 random triples of three-component mixtures (M = K = 3) was
constructed by randomly choosing normalized pure spectra from the pool and
applying random mixing matrices A. The resulting sample represents then a
set of blind source separation problems on strictly positive strongly dependent
sources such that they have ˆI(S) 6= 0.

3.2 Near-infrared data set (B)

The second separation problem was chosen from the publicly available database
[59] which was established in [60] to facilitate evaluation and comparison of
chemometrical methods. The near-infrared (1100 − 2500 nm, 700 data points
per spectrum) test sample ﬁrst analyzed by Windig and Stephenson [56,61]
consists of 140 experimental mixtures of ﬁve pure solvents (methylene chloride,
2-butanol, methanol, dichloropropane, acetone). For this data set both the con-
centrations for each mixture and the reference spectra of the pure components
are available. The fractional concentrations of the four mixture components
were chosen form the set {10%, 22.5%, 35%, 47.5%, 60%}. The fractional con-
centration of the ﬁfth component were set to make the concentrations add up
to 100% [56].

3.3 6-component infrared mixtures (C)

To compare MILCA directly with the BTEM algorithm we also analyze here
the same data as those used in the original work of Widjaja et al. [16] taking
14 randomized experimental 6-component mixtures of toluene, n-hexane, ace-
tone, 3-phenylpropionaldehyde (aldehyde), 3,3-dimethylbut-1-ene (33DMB),

8

and dichloromethane (DCM) [62]. To test performance, we used also the ref-
erence (pure) spectra of these compounds given in [16] (all spectra are FT-IR
in the range 950 −3200 cm−1 with 5626 intensities). Notice that the authors of
[16] measured and decomposed a set of 18 spectra (including the experimental
background). For more details, see the footnote [62].

3.4 Raman spectra of brain samples (D)

True blind source separation by MILCA was performed on the spectral data
measured from human brain samples by Kraﬀt et al. [63]. Taken from neuro-
surgical resection material, the normal brain tissues of white and gray matter
were subject to near-infrared Raman microspectroscopy, as were also the tu-
mor specimens of glioma (astrocytoma W HO◦3) and meningioma (W HO◦1)
types. The selected range was 600 − 3500 cm−1 covered by 3282 wavelengths.
For each of the 4 samples, 20 to 42 measurements had been made resulting
in 117 spectra. While variability across the sample is small, spectroscopically
resolved diﬀerences between the four distinct specimens are noticeable. This
allows to attempt blind mixture decomposition taking all 117 spectra together
to extract common least dependent components in each sample and estimate
their average concentrations. These results obtained blindly by MILCA were
subsequently compared to the same Raman spectra of four pure substances
(protein albumin from bovine serum, lipids from bovine brain extract, choles-
terol from lanoline, and water) which were used in [63], assuming that they
approximate the main constituents of the brain tissues.

4 Results and discussion

In order to reveal and illustrate potential pitfalls arising from dealing with
highly dependent spectral signals, we ﬁrst ran MILCA on a simple synthetic
2-component mixture of o-xylene and p-xylene, two compounds with very simi-
lar molecular structures and highly overlapping spectra (the spectral data were
taken from [58]). The distribution on Fig. 1a shows that prewhitening (PCA) of
the initially strictly positive components already leads to decorrelated vectors
that cannot be made positive by any further pure rotation. Typically, in cases
like this, minimizing the MI results in one component being poorly resolved,
in appreciable violations of positivity and deviations from the pure signal it-
self (Figs. 1b,d). Obviously, this is even more severe for higher dimensional
mixtures. It is therefore likely that in a problem with originally nonnegative
overlapping sources already the ﬁrst step (prewhitening) may be counterpro-
ductive. This seems to be the reason why algorithms based on PCA, followed
by subsequent rotation of decorrelated vectors into the positive domain (e.g.,

9

[40,41]), have so far met with limited success only.

When performing ICA in derivative space, nonnegativity of the components
reconstructed by means of Eq. (8) is much better preserved (see Figs. 1c,e and
ﬁgures shown below). One might be tempted to relate this to the fact that
positivity is not manifest in derivative space itself, but this is not true. The
main reason for the improvements is that preprocessing with second deriva-
tives eliminates slowly varying components from the spectra, and it is these
slowly varying components which show most of the undesired dependencies be-
tween pure spectra. Seen from this point of view, discarding slow components
in any multi-resolution decomposition such as, e.g., a wavelet decomposition
(notice that we speak here of wavelets in frequency space, not in the time
domain) would presumably have similar eﬀect as taking second derivatives.
This is opposed to selecting non-overlapping bands in the ICA analysis, which
corresponds to discarding spectral regions. Indeed, one might apply both tech-
niques (band targeting and ﬁltering out slow components) in combination, but
we shall not do this in the present paper.

We next studied behavior of MILCA (with and without SD preprocessing) on
a large sample of synthetic randomized 3-component mixtures (data set A).
To demonstrate the eﬀect of SD preprocessing, Fig. 2a shows the mutual infor-
mations of original triples of sources and those after taking second derivatives
(Eq. (7)). There is a clear trend towards lowering MI by SD preprocessing.
This means that taking derivatives ﬁlters out mostly the information which is
common to all 3 spectra, and which is, therefore, detrimental to MILCA. Since
SD acts as a high-pass ﬁlter, the eﬀect can be traced to amplifying rapidly
varying components in partially overlapping spectral regions. The observed
gain in decomposition performance can be further understood by noting that
the MI of the estimated components are closer to the MI of the pure compo-
nents, if MILCA is performed in derivative space (Figs. 2b,c). Finally, Fig. 2d
conﬁrms that the match between MI of reconstructed signals and MI of original
signals (both estimated in the original space) improves when SD preprocessing
is involved (compare to Fig. 2c).

A more direct measure of performance (or quality of decomposition) is given by
the degree to which the estimated demixing transformation corresponds to the
actual mixing matrix and how well the nonnegativity is preserved. For this we
gathered the statistics of the Amari index P (Eq. (9)) and positivity measure
π (Eq. (11)) over the same test set A. As expected, the decomposition becomes
more diﬃcult as the sources become more dependent. But while this is very
pronounced when MILCA is performed in the original space (Fig. 3a), it is
hardly visible when second derivatives are used (Fig. 3b). In fact, MILCA with
SD preprocessing was able to reconstruct successfully most of spectra from set
A (Figs. 3d,f), in contrast to MILCA without SD preprocessing (Figs. 3c,e).
Amari index values P < 0.1 indicate good decomposition quality, whereas

10

P > 0.3 can be considered as unacceptable. Somewhat surprisingly, the strong
(and expected) correlation between Amari index and non-negativity seen when
MILCA is done without ﬁltering (Fig. 3e) is nearly completely eliminated after
SD preprocessing (Fig. 3f). This suggests that nonnegativity alone may not
be an optimal target in spectral curve resolution.

In the following applications to experimental mixtures we will only use MILCA
with second derivative preprocessing.

The test problem B oﬀered a large set of mixtures to be decomposed, while
each spectrum was relatively scarce in the number of data points (wave-
lengths). The ﬁve components have strong overlaps in the most informative
range 2000 − 2500 nm (see Fig. 4), with only a few spectral features (also
partly overlapping) at lower wavelengths to facilitate decomposition. Since
the signals appeared rather smooth without much measurement noise, we per-
formed MILCA on second derivatives computed by ﬁnite diﬀerences (Eq. (7))
(Savitzky-Golay smoothing did not improve results in this case). The resolved
components were found to match the reference spectra fairly well with only
minor violations of nonnegativity. The largest mismatches are observed for
methylene chloride and 2-butanol (Figs. 4a,c).

To test how well the original concentrations were recovered, in the right panels
of Fig. 4 we plot the estimated concentrations versus the original ones. Since
the original concentrations were nearly quantized (see Sec. 3.2 and [56]), the
vertical scatter of each point cloud indicates the inaccuracies of the source
reconstruction. They are slightly larger than those obtained in [56] with SIM-
PLISMA, but MILCA produced notably fewer false negative concentrations:
they occurred only for methylene chloride and 2-butanol (Figs. 4b,d) which
show also the worst spectral reconstruction (Figs. 4a,c).

The next comparison was made with the BTEM algorithm [16,46]. For this
we used the same data (set C) as in [16]. The large number of data points per
spectrum and cleanness of the data even without background subtraction [62]
allowed to work with second derivatives. In this case a Savitzky-Golay ﬁlter
with 81 point window and 7th order polynomial gave best performance. Fig. 5
depicts the resolved components plotted together with the reference (pure)
spectra. Although the MILCA approach does not speciﬁcally focus on pre-
serving certain spectral features, we ﬁnd all the major bands reproduced rea-
sonably well. Some distortions appear mostly in the overlap range 2800 − 3200
cm−1 which was also a source of imperfections in the BTEM analysis [16].
In Table 1 we give a quantitative comparison between SIMPLISMA, BTEM,
and MILCA, with the inner product i (Eq. (10)) used as performance measure.
Compared to BTEM, MILCA demonstrates almost equally high performance
while being more straightforward in that it does not use band selection. How-
ever, on this data set the combination of SIMPLISMA and alternating least

11

squares [10,12] evidently outperforms both. On the other hand, as reported in
[16], IPCA [45] and OPA [64] algorithms were less eﬃcient.

Finally, we proceed to a more realistic, true blind source separation problem in
which no exact information on chemical composition is known. As non-invasive
spectroscopic methods are more and more used in the analysis of biological
materials and in vivo measurements [20,22,23,38,63,65], they oﬀer an increas-
ing variety of such “black” [2] mixture separation problems. Here we analyze
the results of a Raman spectroscopy study of brain specimens [63] (set D) to
see whether MILCA decomposition could be helpful in quantifying the abun-
dances of major chemical species present in the brain. In [63] it was shown
that a 4-component model can be used to explain a large part of the complex
Raman spectra from brain samples. In their work Kraﬀt et al. [63] assumed
that the main spectral contributions are that of proteins, lipids, cholesterol
and water, for which reference spectra were obtained. Then they determined
concentrations of these components by making a linear ﬁt to the experimental
data. We attempted to do the same in a blind manner, applying MILCA to
the original experimental set of spectra. The decomposition was complicated
by the high level of measurement noise (Fig. 6a), so Savitzky-Golay smoothing
derivatives (19 point window, polynomials of order 7) were used to preprocess
the data. The ﬁrst four least dependent components resolved by MILCA are
plotted in Figs. 6b-e (the ﬁfth and higher order components contained pre-
dominantly noise). We found that each of them was indeed very similar to one
of the spectra from the model set (dashed curves in Figs. 6b-e), which sup-
ports the result of [63] that the model set represents the main constituents of
the tissues. In addition, MILCA gives also estimates for the mixing matrices,
i.e., for the concentrations. Based on these, we found the following lipid-to-
protein average concentration ratios: 6.5 (white matter), 1.2 (gray matter), 0.5
(astrocytoma), and 0.4 (meningioma). This trend may be of diagnostic value
and is consistent with the model ﬁt parameters of [63] and with studies by
alternative methods [66,67].

5 Conclusions

We have approached several spectral curve resolution problems by a new blind
source separation algorithm based on accurate estimates of mutual information
(MILCA, available online at [68]). We showed that, with proper preprocess-
ing, decomposition into least dependent components is suﬃcient to achieve
a separation performance comparable to that of state of the art specialized
chemometrics techniques.

Least dependent component analysis is a general statistical method with a very
wide range of potential applications (here we refer to the extensive ICA liter-

12

ature surveyed, e.g., in [32,33]). It was designed to perform completely blindly
without using any a priori or empirical information such as the locations of
pure variables or nonnegativity of original sources. An important advantage of
MILCA over other ICA methods is the fact that it can use (in)dependencies
down to very small scales. Thus it can make eﬃcient use of high pass ﬁltered
signals where most of the dependencies due to overlapping bands have been re-
duced. In practice, this may be helpful, e.g., in cases when reliable localization
of pure variables is complicated by severe overlaps or noise. Also, opposite to
the methods that use nonnegativity, MILCA is applicable to alternating sign
signals, as is the case, e.g., in EPR spectroscopy [25].

As our simulations on a large data set (10000 mixtures) have shown, the use
of properly chosen preprocessing (second derivatives) leads to reduction of
nuisance dependencies which would otherwise give unwanted contributions to
mutual information. The latter is the the only cost function in our method. In
this sense, ﬁltering out slowly varying contributions is consistent with the goal
of ﬁnding least dependent components in the data performed by minimizing
their mutual information.

The conceptual simplicity of the MILCA approach is expected to be advan-
tageous to applied spectroscopists, and this contrasts it with novel but rather
sophisticated curve resolution algorithms [16,46]. On the other hand, MILCA
allows for several generalizations discussed already in [48]. These include mix-
ing with small spectral shifts and testing the independence of spectra at diﬀer-
ent frequencies. In addition, it should be feasible to include the nonnegativity
constraint in the cost function. All this would of course make the analysis
more complicated and introduce several new parameters to be optimized, but
it could lead to substantial further improvements.

Acknowledgements

We would like to thank Prof. D.L. Massart, Prof. P.K. Hopke for pointing us
to the useful source [59] and Dr. W. Windig for sending the data [61]. We are
grateful to Prof. M. Garland, Dr. E. Widjaja who shared their spectra [16] and
Dr. C. Kraﬀt for the original data from [63] and for discussions. S.A. thanks
Prof. S.P. Mushtakova and Dr. D.A. Smirnov for suggestions.

13

References

235.

[1] P.J. Gemperline, Anal. Chem. 71 (1999) 5398.

[2] Y.-Z. Liang, O.M. Kvalheim, R. Manne, Chemometr. Intell. Lab. Syst. 18 (1993)

[3] S.D. Brown, S.T. Sum, F. Despagne, Anal. Chem. 68 (1996) 21R.

[4] P. Geladi, Spectrochim. Acta B 58 (2003) 767.

[5] P. Geladi, B. Sethson, J. Nystr¨om, T. Lillhonga, T. Lestander, J. Burger,

Spectrochim. Acta B 59 (2004) 1347.

[6] A. de Juan, R. Tauler, Anal. Chim. Acta 500 (2003) 195.

[7] P.K. Hopke, Anal. Chim. Acta 500 (2003) 365.

[8] B. Lavine, J.J. Workman, Anal. Chem. 76 (2004) 3365.

[9] J.-H. Jiang, Y. Liang, Y. Ozaki, Chemometr. Intell. Lab. Syst. 71 (2004) 1.

[10] W. Windig, J. Guilment, Anal. Chem. 63 (1991) 1425.

[11] http://www.acdlabs.com

[12] R. Tauler, B. Kowalski, S. Fleming, Anal. Chem. 65 (1993) 2040.

[13] http://www.eigenvector.com

[14] M.N. Leger, P.D. Wentzell, Chemometr. Intell. Lab. Syst. 62 (2002) 171.

[15] G. Peintler, I. Nagypal, I.R. Epstein, K. Kustin, J. Phys. Chem. A 106 (2002)

3899.

[16] E. Widjaja, C. Li, W. Chew, M. Garland, Anal. Chem. 75 (2003) 4499.

[17] W.H. Lawton, E.A. Sylvestre, Technometrics 13 (1971) 617.

[18] D. Nuzillard, S. Bourg, J. M. Nuzillard, J. Magn. Reson. 133 (1998) 358.

[19] J. Chen, X. Z. Wang, J. Chem. Inf. Comput. Sci. 41 (2001) 992.

[20] C. Ladroue, A.R. Tate, F.A. Howe, J.R. Griﬃths, Lect. Notes Comput. Sc. 2412

(2002) 441.

(2003) 697.

[21] S. Triadaphillou, A.J. Morris, E.B Martin,

in: Proc. 4th International
Symposium on Independent Component Analysis and Blind Signal Separation
(ICA2003), Nara, Japan, 2003, p. 879.

[22] C. Ladroue, F.A. Howe, J.R. Griﬃths, A.R. Tate, Magnet. Reson. Med. 50

[23] Y. Huang, P.J.G. Lisboa, W. El-Deredy, A.R. Tate, Statist. Med. 22 (2003) 147.

14

[24] E. Visser, T.-W. Lee, Chemometr. Intell. Lab. Syst. 70 (2004) 147.

[25] J.Y. Ren, C.Q. Chang, P.C.W. Fung, J.G. Shen, F.H.Y. Chan, J. Magn. Reson.

166 (2004) 82.

[26] X. Bi, T.H. Li, L. Wu, Chem. J. Chinese Univ. 25 (2004) 1023.

[27] X. Shao, G. Wang, S. Wang, Q. Su, Anal. Chem. 76 (2004) 5143.

[28] M. Scholz, S. Gatzek, A. Sterling, O. Fiehn, J. Selbig, Bioinformatics 20 (2004)

[29] H. Gao, T.H. Li, K. Chen, X. Bi, S.F. Lin, Chinese J. Anal. Chem. 32 (2004)

[30] T.M. Cover, J.A. Thomas, Elements of Information Theory, Wiley, New York,

2447.

993.

1991.

[31] P. Comon, Signal Process. 36 (1994) 287.

[32] A. Hyv¨arinen, J. Karhunen, E. Oja, Independent Component Analysis, Wiley,

New York, 2001.

[33] A. Cichocki, S. Amari, Adaptive Blind Signal and Image Processing. Learning

Algorithms and Applications, Wiley, New York, 2002.

[34] J.-F. Cardoso, Neural Comput. 11 (1999) 157.

[35] A.J. Bell, T.J. Sejnowski, Neural Comput. 7 (1995) 1129.

[36] D.D. Lee, H.S. Seung, Nature 401 (1999) 788.

[37] G. Buchsbaum, O. Bloch, Vision Res. 42 (2002) 559.

[38] P. Sajda, S. Du, L. Parra, in M.A. Unser, A. Aldroubi, F. Laine (Eds.), Wavelets:
Application in Signal and Image Processing X (SPIE Proc. Ser., Vol.5207), 2003,
p. 321.

[39] A. Cichocki, P. Georgiev, IEICE T. Fund. Electr. EA. E86A (2003) 522.

[40] M.D. Plumbley, E. Oja, IEEE T. Neural Networ. 15 (2004) 66.

[41] E. Oja, M. Plumbley, Neural Comput. 16 (2004) 1811.

[42] P. Paatero, U. Tapper, Environmetrics 5 (1994) 111.

[43] F.J. Knorr, J.H. Futrell, Anal. Chem. 51 (1979) 1236.

[44] E.R. Malinowski, Anal. Chim. Acta 134 (1982) 129.

[45] D. Bu, C.W. Brown, Appl. Spectrosc. 54 (2000) 1214.

[46] L. Guo, F. Kooli, M. Garland, Anal. Chim. Acta 517 (2004) 229.

[47] A. Kraskov, H. St¨ogbauer, P. Grassberger, Phys. Rev. E 69 (2004) 066138.

15

[48] H. St¨ogbauer, A. Kraskov, S.A. Astakhov, P. Grassberger, Phys. Rev. E (2004)

(in press, preprint at http://arxiv.org/physics/0405044).

[49] A. Kraskov, H. St¨ogbauer, R.G. Andrzejak, P. Grassberger, Europhys. Lett.
(2004) (submitted, preprint at http://arxiv.org/q-bio.QM/0311037).

[50] E.G. Learned-Miller, J.W. Fisher, J. Machine Learning Research 4 (2004) 1271.

[51] R. Tauler, A. Smilde, B. Kowalski, J. Chemom. 9 (1995) 31.

[52] T.C. O’Haver, G.L. Green, Anal. Chem. 48 (1976) 312.

[53] T.C. O’Haver, Anal. Chem. 51 (1979) 91A.

[54] W. Windig, Chemometr. Intell. Lab. Syst. 23 (1994) 71.

[55] H. Mark, J. Workman, Spectroscopy 18 (2003) 32.

[56] W. Windig, D.A. Stephenson, Anal. Chem. 64 (1992) 2735.

[57] A. Savitzky, M.J.E. Golay, Anal. Chem. 36 (1964) 1627.

[58] NIST Mass Spec Data Center. S. E. Stein, director, “Infrared Spectra” in NIST
Chemistry WebBook, NIST Standard Reference Database Number 69, Eds. P. J.
Linstrom and W. G. Mallard, March 2003, National Institute of Standards and
Technology, Gaithersburg, MD, 20899 (http://webbook.nist.gov).

[59] ftp.clarkson.edu/pub/hopkepk

[60] P.K. Hopke, D.L. Massart, Chemometr. Intell. Lab. Syst. 19 (1993) 35.

[61] W. Windig, Chemometr. Intell. Lab. Syst. 36 (1997) 3.

[62] In [16], the authors analyzed 15 mixtures instead of 14 mixtures, although two
of the spectra given in their data set (spectra #1 and #2) are identical. They
also measured three background spectra with varying content of moisture and
CO2, bringing their total number of spectra to 18. They performed then the
BTEM analysis on all 18 spectra. However, since the background spectra are
known to contain no contributions from the 6 mixture components of interest,
it does not seem reasonable to treat them by any algorithm set up for blind
source separation. Instead, in our analysis we ﬁrst decomposed the background
signals into three least dependent components (spectra of water, CO2 and
spectrometer background). After that these components were projected out by
orthogonalizing in derivative space, and ﬁnally we performed MILCA on the 14
cleaned spectra. The results obtained in this way were practically the same as
those from the most simple approach where we just neglected the background
and did not do anything to minimize its eﬀect. In view of this, in the following
we discuss only the results obtained with the latter simple method.

[63] C. Kraﬀt, S. Miljanic, S.B. Sobottka, G. Schackert, R. Salzer,

in: G.A.
Wagni`eres, (Ed.), Diagnostic Optical Spectroscopy in Biomedicine II (SPIE
Proc. Ser. Vol.5141), 2003, p. 230.

16

[64] C. S´anchez, J. Toft, B. van den Bogaert, D. L. Massart, Anal. Chem. 68 (1996)

79.

[65] C. Kraﬀt, Anal. Bioanal. Chem. 378 (2004) 60.

[66] R. Campanella, J. Neurosurg. Sci. 36(1992) 11.

[67] A. Gaigneaux, C. Decaestecker,

I. Camby, T. Mijatovic, R. Kiss, J.M.

Ruysschaert, E. Goormaghtigh, Experimental Cell Research 297 (2004) 294.

[68] http://www.fz-juelich.de/nic/cs/software

17

1 and zk

Fig. 1. PCA and MILCA applied to a mixture of o-xylene and p-xylene. Scatter
plots of (a) PCA components zk
2 (k = 1, 2, . . . , 822) in the original space (z1
and y(0),k
and z2), (b) ICA components (y(0),k
) reconstructed in the original space,
1
(c) recovered components (yk
2 ) with ICA done in SD space (see Eq. (8)).
Panel (d) shows y(0)
(dashed curve) and the true pure spectra s1 and s2 (solid
1
curves). The component y(0)
is indistinguishable from s2. Panel (e) is the same for
2
y1 and y2 obtained by MILCA in derivative space. In this case, the estimates are
almost indistinguishable from the true sources. Also shown are values of the inner
product i (Eq. (10)) and the Amari index P (Eq. (9)).

1
1 and yk

18

Fig. 2. Preprocessing and MILCA decomposition of 3-component mixtures (statis-
tics over 10000 cases, data set A): (a) MI of the second derivatives of the pure sources
S′′ plotted against MI of the original sources S; (b) MI of estimated SD spectra Y′′
against MI of the pure SD spectra S′′; (c) similar to panel (b), but without using
second derivatives at all (MILCA is performed in the original space, producing esti-
mates Y(0)); (d) again similar to panel (c), but with MILCA done using SD signals,
in which case the estimates in the original space Y are obtained through Eq. (8).
Deviations from the straight lines indicate diﬀerences between quantities plotted on
the vertical and horizontal axes.

19

Fig. 3. MILCA performance statistics (10000 mixtures, data set A). Left (right)
panels show results for MILCA in the original (second derivative) space: (a,b) MI of
sources plotted against the Amari indices P (Eq. (9)) of the decompositions; (c,d)
distributions of Amari indices over the test set; (e,f) dependence of the positivity
measure π (Eq. (11)) on the Amari index P .

20

Fig. 4. Left column: Near-infrared spectra of estimated (solid curves) and original
pure (dashed curves) components (data set B). The components were methylene
chloride (a), 2-butanol (c), methanol (e), dichloropropane (g), and acetone (i). Right
column: Estimated versus actual concentrations of these components. The straight
lines have unit slopes and pass through the origin.

21

Fig. 5. Data set C: reconstructed by MILCA (solid) and reference [16] (dashed)
spectra of toluene (a), n-hexane (b), acetone (c), aldehyde (d), 33DMB (e), DCM
(f).

22

SIMPLISMA+ALS BTEM MILCA

toluene

n-hexane

acetone

aldehyde

33DMB

DCM

0.973

0.995

0.899

0.953

0.963

0.967

0.954

0.992

0.886

0.899

0.983

0.904

0.987

0.990

0.933

0.901

0.964

0.909

Table 1
Data set C: performance of MILCA in comparison to the other curve resolution
algorithms as measured by the values of inner product, Eq. (10), between recon-
structed and reference spectra shown on Fig. 5. Numerical data for SIMPLISMA
and BTEM we taken from Table 3 of [16].

23

Fig. 6. Blind determination of composition of human brain tissue and tumors (data
set D). Exemplary near-infrared Raman spectra (a) of normal white and gray mat-
ter, astrocytoma and meningioma tumors (from bottom to up). The four (b–e) es-
timated components (solid curves) plotted to compare with the model set (dashed
curves) [63] consisting of protein (b), lipids (c), cholesterol (d) and water (e).

24

