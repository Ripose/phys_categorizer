 2
*

 3

 4  5

 6

 7

    0

    1

    2

    3

    4

    5

    6

    7

    8

(m)

 1
*

   14
   12
   10
    8
    6
    4
    2
    0
    0
   -2
   -4
   -6
   -8
  -10
  -12
  -14

       20

       15

       10

        5

        0

    0

Random
    5

Random

Systematic
Exact Value
Systematic

   10

   15

Error (Percent)

   20

     16

     14

     12

     10

      8

      6

      4

      2

      0

    0

    5

30 Shots

60 Shots

90 Shots

180 Shots

180 Shots
90 Shots
60 Shots

30 Shots
   25

   10

   20
Percent Random Error

   15

RECONSTRUCTION OF INITIAL BEAM CONDITIONS
AT THE EXIT OF THE DARHT II ACCELERATOR*

Arthur C. Paul, LLNL, Livermore, CA 94550, USA

Abstract

We  consider  a  technique  to  determine  the  initial
beam  conditions  of  the  DARHT  II  accelerator  by
measuring  the  beam  size  under  three  different  magnetic
transport  settings.  This  may  be time gated to resolve the
parameters  as  a  function  of  time  within  the  2000  nsec
pulse.  This  technique  leads  to  three  equations  in  three
unknowns with solution giving the accelerator exit beam
radius, tilt, and emittance. We ﬁnd that systematic errors
cancel  and  so  are  not  a  problem  in  unfolding  the  initial
beam  conditions.  Random  uncorrelated  shot  to  shot
errors  can  be  managed  by  one  of  three  strategies:  1)
make  the  transport  system  optically  de-magnifying;  2)
average over many individual shots; or  3)  make  the  ran-
dom  uncorrelated  shot  to  shot  errors  sufﬁciently  small.
The high power of the DARHT II beam requires that the
beam  transport  system  leading  to  a  radius  measuring
apparatus  be  optically  magnifying.  This  means  that  the
shot  to  shot  random  errors  must  either  be  made  small
(less  than  about  1%)  or  that  we  average  each  of  the
three  beam  radius  determinations  over  many  individual
shots.

1  THE DARHT II BEAMLINE

The DARHT II beamline[1] consists of a series  of
transport  solenoid  lens  and  a  kicker  system  to  chop  the
beam  to  be  sent  to  the  X-ray  converter  target.  Between
the  accelerator  exit  and  the  kicker  is  a  series  of  three
solenoids,  lens  S0,  S2,  and  S3.  Lens  S3  matches  the
beam  to  the  kicker  system.  Solenoid  S2  is  used  in  con-
junction  with  an  insertable  beam  dump,  the "shuttle
dump",  to  blow  the  beam  up  to  a  point  that  the  density
of  energy  deposition  in  the  dump  is  small  enough  to
allow  the  dumps  survival.  Solenoid  S0,  between  the
accelerator  and  S2,  is  used  to  generate  different  beam
transport conditions for unfolding the initial beam condi-
tions  at  the  exit  of  the  accelerator.  A  viewing  port  just
in  front  of  S2  is  used  to  measure  the  beam  radius.  The
beam must be several cm in  radius  to  allow  the  survival
of  the  viewing foil.  The beam exiting this foil has been
scattered  to  the  point,  that  solenoid  S2  and  the  large
beam emittance induced by scattering in the viewing foil
is sufﬁcient to diverge the beam on the shuttle dump.

2  THE PROCEDURE

We deﬁne several terms that will be used in this

-------------------------------
* This work performed under the auspices of the U.S.
Department of Energy by University of California
Lawrence Livermore National Laboratory under contract
No. W-7405-Eng-48.

work  in  order  to  avoid  ambiguity.  A "shot" is  a  2  usec
beam  pulse  from  the  accelerator.  At  minimum,  three
shots  are  required  to  re-construct  the  initial  beam  condi-
tions.  A  measurement  of  radius  can  be  either  a  single
radius  measurement  or  the  average  value  of  many  indi-
vidual  measurements.  To  avoid  confusion,  we  will  use
the  term "determination" to  be  the  measured  radius
value  used  in  the  procedure  of  beam  reconstruction.
Three  radius  determinations  are  required  to  re-construct
the  beam  parameters.  These  three  determinations require
three  shots  if  each  determination  is  made  using  a  single
shot, or 3N shots if each determination is the average of
N  radius  measurements  for  each  determination.  The
procedure of re-construction unfolds from the determina-
tions the beam emittance, initial radius and tilt. A single
unfolding  yields  a  value  for  the  beam  emittance,  initial
radius  and  tilt.  Several  unfoldings  can  be  averaged  to
give an improved value of these parameters.

Consider  solenoid  S2  set  to  7.5  kG  to  expand  the
beam  onto  the  shuttle  dump  almost  independent  of  how
the  beam  address  S2.  Consider  a  viewing  foil  to  be
inserted  into  the  beamline  at  the  pump  port  just  in  front
of  S2.  This  is  the  location  were  we  make  the  radius
measurements.  Take  the  point  for  beam  re-construction
to  be  located  0.1111  meters  beyond  the  exit  of  the
accelerator.  The  transport  of  the  beam  from  the  re-
construction  point  to  the  view  port  is  then  given  by  a
ﬁeld  free  region  L1,  solenoid  lens  S0,  and  ﬁeld  free
region L2.

V =

1

0
0

L

2
1
0

º 0

0

0

0
1

0

0

0
L

2
1

C2
- kSC
- SC
º kS2

k- 1SC
C2

- k- 1S2
- SC

SC
- kS2
C2
- kSC

k- 1S2 ø
SC
k- 1SC
C2

1

0
0

L

1
1
0

º 0

0

0

0
1

0

0

0
L

1
1

x
x¢
y
º y¢

2.1

C2- kL

SC

2

(L

1

+L

2

)C+k- 1S- L

L

1

2

kS

SC- kL

S2

2

(k- 1- kL

L

1

2

)S2+(L

+L

1

2

)SC

R =

- kSC

C- L

kS

1

- kS2

SC- kL

S2

1

S2- SC

kL

2

(kL

L

1

2

- k- 1)S2- (L

+L

1

2

)SC

C2- kL

SC

2

(L

1

+L

2

)C2+(k- 1- kL

L

1

2

)SC

kS2

- SC+kL

S2

2

- kSC

C2- kL

SC

1

Here  L1,  L2 are  the  drifts  between  the  re-construction
point  and  S0,  and  S0  and  the  view  port  respectively,
C = cosq
,  k = B⁄(2Br )  ,  and q = kLs are  the
solenoid focusing terms.

,  S = sinq

Three  such  transformations  are  required,  one  each
at a given setting of solenoid S0, say 0, 3.5, and 4.5 kG.
Consider  three  shots  with  the  initial  beam  conditions  of
r=0.5  cm,  tilt=0,  and  emittance  3.0  cm-mr,  the  nominal
matched  design  values.  For  the  three  S0  settings  above,
ﬁgure 1, the beam at the view port would be

Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
º
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
‘ ‘
‘ ‘
‘ ‘
‘ ‘

11

22

33

44

=

2.306
5.792
2.306
º 5.792

1.669
10.350
1.669
º 10.350

3.692
18.705
3.692
º 18.705

cm
mr
cm
mr

2.3

‘ ‘
‘ ‘

s 11 is  the  horizontal  projection  of  the  beam  envelope,
s 33 is  the  vertical  projection  of  the  beam  envelope.
Here  the  beam  radius  is (cid:214)
‘ ‘
s 33 as  the  beam  is
round and in its principle coordinate system, x=y=r.

s 11 = (cid:214)
‘ ‘

3  THE SIGMA MATRIX

Let s be the matrix characterizing the phase space
ellipse  bounding  all  particles  in  the  beam.  Let  R  be  the
linear  transformation  matrix  from  the  point  of  beam
reconstruction  to  the  location  of  the  beam  size  measure-
ment.  A point (x,x’) on the phase ellipse is given by

s 22x2 - 2s 12xx¢ + s
s 21
s 22

s 11
s 21

(x,x¢ )

11x¢ 2 = det(s ) 
- 1 (cid:236)

(cid:254) = 1 

x (cid:252)
(cid:238) x¢

3.1

3.2

In  the  principle  coordinate  system  of  a  round  beam
represented  by  the  vector  space  ( x, x¢ , y, y¢ )T we  have
x = y and x¢ = y¢
.  If the beam is un-correlated between
x and y, then s 31 = s 32 = s 41 = s 42 = 0 , and from sym-
metry s 13 = s 23 = s 14 = s 24 = 0  ,  but  possibly  tilted  in
the horizontal and vertical phase space, then s 21 and s 43
would be non-zero, and eq(3.2) becomes
- 1

(x,x¢ ,y,y¢ )

s 11
s 21
0
º 0

s 21
s 22
0
0

0
0
s 33
s 43

0 ø
0
s 43
s 44

x (cid:252)
x¢
y
(cid:238) y¢

= 1 

3.3

The four dimensional linear transformation matrix

R =

R11
R21
R31
º R41

R12
R22
R32
R42

R13
R23
R33
R43

R14
R24
R34
R44

3.4

transforms the sigma matrix by the similarity transform

s = R s o RT

3.5

Deﬁne  the  initial  reconstruction  sigma  matrix  elements
of s o for  a  round  beam  to  be:  a ” s
,
b ” s
.  The  square  of  the
measured round beam size r2 ” s

= s 330

= s 430

33 is given by

,  c ” s

110

210

220

r2 = (cid:236)

2 (cid:252)
2 + R13

(cid:238) R11

(cid:254) a + 2

(cid:238) R11R12

(cid:254) b + (cid:236)

2 (cid:252)
2 + R14

(cid:238) R12

(cid:254) c

3.6

= s 440
11 ” s
+ R13R14

Here  we  have  explicitly  expanded  eq(3.5)  in  terms  of
matrix  eq(3.4)  to  represent s 11 in  terms  of  the  initial
beam  sigma  elements  (a,b,c)  and  the  values  of  the
transformation  matrix.  Three  sets  of  radius  determina-
tions,  r1, r2,  and  r3 allow  reconstruction  of  the  initial
beam parameters, a, b, and c.

2 = C11 a + C12 b + C13 c
r1
2 = C21 a + C22 b + C23 c
r2
2 = C31 a + C32 b + C33 c
r3

3.7

= Ø

C11,C12, ....  are  the  known  combinations  of  the  transfor-
jth  determination.
mation  matrix  elements  for 
Cj1
,  Cj3
j
Inverting  we  have  the  desired  initial  reconstructed  beam
parameters.

the 
+ R13R14

2 ø
2 + R14

2 ø
2 + R13

º R11R22

,  Cj2

º R11

º R12

= Ø

= Ø

j

j

=

1_ ____
detC

11

o

21

o

22

o

33
C

33

C
- C
º C

C

22

21
C

- C
+ C
- C

C

23

23
C

32
C

31

21

32

31

22

- C

11

C
- C

C

33

12
C

33
C

+ C
- C
+ C

32
C

13

C

13

31
C

11

32

31

12

C

12

C
- C

23
C

23

11
C

C

11

22

- C
+ C
- C

C

13

22
C

21

13
C

12

21

2
r1
2
r2
2
º r3

4  RECONSTRUCTION

Lets  consider  a  case  of  beam  reconstruction  using
three  shots  with  each  radius  determination  subject  to  a
systematic  error.  As  each  radius  determination  would
have  the  same  error,  the  reconstructed  initial  beam
radius  should  systematically  have  that  same  error,  and
the beam emittance being an area should have twice that
error.  Deﬁne  the  systematic  measured  radius  error  to  be
d r , then

e_ __ = 2

o

d r_ __
R

4.1

Lets  now  consider  a  case  of  un-correlated  random
errors  in  the  three  shots  used  to  reconstruct  the  beam
initial  conditions.  If  the  beam  size  is  magniﬁed  by  the
"optics" of  the  lens  system,  then  a  measurement  error d r
will  be  magniﬁed  by  the  system  magniﬁcation  M.  As
the  three  measurements  are  un-correlated,  the  magniﬁed
errors  will  not  cancel  and  we  expect,  for  small  errors
that the emittance error should grow as

e_ __ = 2M

o

d r_ __
R

4.2

Note  for  small Md r
,  that  the  emittance  curve  is  a
straight  line  with  slope  M  times  that  of  the  systematic
error  curve,  ﬁgure  2.  For  large Md r the  emittance  curve
parallels  the  systematic  error  curve.  The  transition
between these two regimes appears to be some fractional
power of the parameter Md r .

e_ __ = 1 + a zn - b z2n + .......

o

z ” M

r_ __
R

4.3

4.4

Figure  2  shows  the  unfolded  beam  emittance  as  a  func-
tion  of  the  magnitude  of  the  un-correlated  random  error
in  the  beam  size  determination.  The  shape  of  the  curve
is  approximated  by  eq(4.3)  with  a=0.2,  b=0.004,  and
n=2/3.  Let  M  be  some  measure  of 
the  optical
magniﬁcation of the system and d r be the radius error.

Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
º
(cid:214)
s
(cid:214)
s
(cid:214)
s
(cid:214)
s
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
(cid:214)
‘
(cid:214)
‘
‘
‘
Ø
(cid:239)
º
ø
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
(cid:236)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:254)
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
(cid:236)
(cid:252)
ß
ø
ß
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
º
s
s
s
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
Ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ø
(cid:239)
(cid:239)
(cid:239)
(cid:239)
(cid:239)
ß
e
d
e
d
e
d
e_ __ = 1 + 0.2z2⁄3 - 0.004 z4⁄3

o

4.5

Consider  our  example  with  M=5.39 d r⁄R=10% , e
a=0.2, n=2/3, then

= 8.44 ,

o

7  REFERENCES

[1] "DARHT-II Downstream Beam Transport Beamline",
G.A.Westenskow, L.R.Bertolini, P.T.Duffy, A.C.Paul
this proceedings.

e_ __ = anMzn- 1

d r_ __
R

4.6

o
1.90e

e =

= 16.0  cm- mr

o

almost a 100% error in the reconstructed emittance.

5  NUMBER OF REQUIRED SHOTS

We consider two strategies for rendering the beam
emittance from N shots.  The ﬁrst uses one unfolding of
the  emittance  based  on  three  radius  determinations  were
each  radius  determination  is  the  average  of  N/3  shots.
Call  this  scenario  A.  The  second  strategy  is  based
averaging  N/3  emittance  unfoldings  each  of  which  are
the  result  of  three  radius  determination  with  each  radius
determination  consisting  of  a  single  shot.  Call  this
scenario  B.  The  ﬁt  to  the  emittance  error  curves  are
represented by eq(5.1)

e = a1 x + a2 xn

5.1

x is the error in percent and e
is the emittance in cm-mr.
This equation is used to ﬁt scenarios A and B.  Scenario
A  is  well  represented  by  a  0.72  power  law.  Scenario  B
is  represented  by  a  0.5  -  0.6  power  law.  Note  that  the
lower  bounds,  are  straight  lines  for  large  errors  given  a
lower  bound  to  the  emittance  independent  of  the  value
of the random error, ﬁgure 3.

The  reason  that  making  many  emittance  determi-
nations  with  out  averaging  the  radius  values  gives  an
better  value  for  the  average  value  of  the  unfolded  beam
emittance  is  that  values  of  emittance  that  by  the  luck  of
the draw (random number sequence) that are negative or
zero  are  averaged  out  by  the  positive  random  values.  In
scenario A,  were  we  unfold  just  one  emittance  but  aver-
age  the  radius  determinations  yield  a  negative  or  zero
value for some random sequences. With just one unfold-
ing  there  are  no  positive  values  to  average  this  unfor-
tunate value.

6  CONCLUSIONS

The beam emittance is related to the area in phase
space  occupied  by  the  particles  comprising  the  beam.
The reconstruction of the emittance by a radius measure-
ment  with  error d r
should  yield  an  error  in  the  emit-
tance  of  at  most 2d r
.  With  a  system  of  optical
magniﬁcation  M  the  error  is 2Md r .  Use  of  the  shuttle
dump  diagnostic  on  DARHT  II  to  determine  the  beam
emittance  to  within  a  factor  of  two  using  a  minimum
number  of  shots  requires  either  1)  the  random  un-
correlated  shot  to  shot  errors  be  less  than  about  1%,  or
2) we average 30 to 60 shots using scenario B with ran-
dom errors some where in the range of 5 to 10 percent.

Figure  1.  Over  plot  of  the  three  beam  envelopes  for  the
example  of  beam  reconstruction  with  solenoid  S0  at  0,
3.5,  and  4.5  kG.  The  radius  measurement  is  made  at
view port located at 7.20 meters.

Figure  2.  Unfolded  beam  emittance  vs  random  error  in
the  beam  radius  measuremet.  The  exact  value  and  the
range  of  values  for  a  systematic  error  is  also  shown.
The radial magniﬁcation of 5.4 ampliﬁes the error.

Figure  3.  Required  number  of  shots  for  a  given  emit-
tance  range  vs  radial  error  using  averaging  of  emittance
value  method.  Nominal  beam  radius  0.95  cm,  tilt  -0.35,
and emittance of 8.44 cm-mr.

e
e
d
d
