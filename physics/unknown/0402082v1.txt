Generalized Paraxial Ray Tracing Derived from Geodesic Deviation 
 
 
David R Bergman 

Department of Physics, Saint Peter’s College, Kennedy Boulevard, Jersey City, NJ 

dbergman@spc.edu 

Abstract 

Paraxial  ray  tracing  ray  tracing  procedures  have  become  widely  accepted 

techniques  for  acoustic  models  in  seismology  and  underwater  acoustics.    To  date  a 

generic  form  of  these  procedures  including  fluid  motion  and  time  dependence  has  not 

appeared  in  the  literature.    Identifying  the  characteristic  curves  of  the  equations  of 

hydrodynamics with the null geodesics of a pseudo–Riemannian manifold allows for an 

immediate generalization of the procedure to be extracted from the equation for geodesic 

deviation.    With  the  recent  need  for  shallow  water  acoustic  modeling  these  general 

paraxial  ray  trace  equations  serve  as  an  ideal  supplement  to  ordinary  ray  tracing  in 

predicting  the  deformation  of  acoustic  beams  in  random  environments.    The  general 

procedure is derived and applied to layered medium. 

PACS:  43.20.Dk, 43.28Py, 43.30.Cq 

 

 

 

 

 

 

 

 

 

1 

Section 1.  Introduction 
 
 

Paraxial ray tracing has become widely used in Seismology where motion of the 

medium  can  be  ignored.    Recently  it  has  been  suggested  by  the  author  that  a 

generalization  of  this  procedure  applicable  to  random  media  may  be  derived  from  the 

equation  of  geodesic  deviation  on  a  Pseudo-Riemannian  manifold  [3].    The  ability  to 

extend these procedures to more general situations will allow for their use in studying ray 

propagation  in  a  random  media  having  a  positive  impact  on  the  development  of  novel 

techniques  in  active  SONAR  modeling  and  its  use  towards  the  understanding  of 

underwater environments.  In paraxial ray trace procedures ray paths within a ray bundle 

or tube are determined by solving a linear system of second order differential equations 

along  one  ray  path  rather  than  repeatedly  solving  the  ray  equation  with  different  initial 

conditions [4].  From the results of this procedure the neighboring ray close to a specific 

solution of the ray equations may be mapped and the geometric spread of a ray bundle 

determined.    

 

The equation for  geodesic deviation, commonly  used in differential  geometry to 

study the existence of conjugate points along geodesics of a differential manifold, is used 

to  derive  a  generic  paraxial  ray  trace  procedure.    This  type  of  procedure  is  commonly 

used  in  general  relativity  to  study  gravitational  tidal  forces  in  material  systems  used  as 

gravitational  wave  detectors,  gravitational  lensing  effects  and  theoretical  analysis  of 

planetary  motion  [10],  [13],  [1].    While  the  application  of  differential  geometry  to 

dynamical systems predates general relativity its presence in this area of modern physics 

is  more  than  just  a  convenient  tool  but  a  paradigm  shift  as  the  existence  of  the 

 

2 

gravitational force field  is replaced with the concept of  a flexible space  time geometric 

structure determined by the distribution of matter and energy.     

 

It is worth noting that while the identification of acoustic rays with null geodesics 

was  first  illustrated  by  R.  White  in  1973  some  ten  years  later  the  connection  was 

discovered again in the general relativity community and has become known as acoustic 

GR (or acoustic analog models of black holes) [18].  In this area the interest is in both the 

mathematical and possible experimental similarities between the behavior of the acoustic 

field in the presence of supersonic flow in He3 and the phenomena of Hawking radiation 

produced by a black hole [19].  Unruh [18] derives the four dimensional eikonal equation 

by  perturbing  all  fields  about  some  background  configuration  and  taking  the  small 

wavelength,  high  frequency,  limit  of  the  resulting  system.    A  significant  feature  of  this 

approach is the necessary requirement that the fluid be irrotational, 

u

0=

.  The same 

geometric  identification  has  been  made  by  several  authors  in  the  acoustics  community.  

By  differentiating  the  equations  of  hydrodynamics  White  derives  an  equation  for  the 

acoustic  field  containing  essentially  the  same  Lorentz  invariant  operator  introduced  by 

Unruh  along  with  a  velocity  dependant  source  term  [21].    Whereas,  by  studying  the 

characteristics  of  the  hydrodynamic  equation  Thompson  arrives  at  the  same  metric 

structure  and  null  geodesic  equation  for  the  canonical  momentum  associated  with  the 

rays, indicating that the identification of the characteristics with null geodesics is valid in 

any environment [14]. 

The  identification  of  rays  with  the  null  geodesics  of  a  differential  manifold  is 

taken as an operational definition.  Ray trace algorithms based on this identification treat 

the  four  dimensional  space  time  coordinates  x

  and  t  as  the  degrees  of  freedom  of  a 

 

 

3 

·
(cid:209)
(cid:0)
(cid:0)
(cid:1)
dynamical  system  with  underlying  Lorenz  symmetry  and  allow  one  to  generalize  to 

include arbitrary environmental parameters 

tx
),(

 and 

txc
),(

.   

u

 

The presence of differential geometry in modern physics for the past 75 years has 

led to the development and use of many sophisticated techniques that are employed in the 

development  of  the  paraxial  approximation  presented  here  and  the  analysis  of  layered 

media.  Although much of the formalism can be extracted from texts on general relativity 

and  mathematical  physics  the  techniques  are  somewhat  novel  to  the  field  of  acoustics.  

Additionally the  geometric relationship between  the four dimensional deviation and the 

deviation between equal time rays, while simple and elegant, is not trivial, and the reader 

is  referred  to  the  classic  text  book  literature  in  these  fields  [5],  [7],  [10],  [11],  [20]. 

 

This article is divided into four sections, section 1 being the introduction.  Section 

2 introduces the mathematical machinery necessary for constructing a paraxial ray trace 

algorithm in a random media and the geometrical significance of the quantities involved.    

In  section  3  the  technique  is  applied  to  layered  media  with  fluid  motion  where  the 

technique of identifying isometries of the metric tensor with conserved currents is applied 

to the problem to determine the ray tangent at all point along the ray.  Some time is spent 

deriving common integrals found in underwater acoustics as well as the generalized form 

of  Snell’s  law  originally  found  by  Kornhauser  [8].    These  well  known  results  emerge 

from  the  differential  geometric  point  of  view  as  isometries  or  symmetries  of  the 

underlying geometry allowing one to identify Snell’s law as conservation of energy and 

momentum of a massless particle traveling along the ray.  Although these results are not 

new their derivation is novel and serves as a consistency check.  These results are then 

fed into the deviation equation with attention being focused on effective two dimensional 

 

4 

(cid:1)
(cid:1)
(cid:1)
ray  systems  where  it  is  discovered  that  the  equations  of  parallel  transport  need  not  be 

solved and a basis may be chosen by inspection resulting in a scalar equation for a single 

component  of  the  deviation  vector.    The  effects  of  environmental  parameters  on  the 

focusing  properties  of  the  medium  are  discussed  in  general  and  some  exact  solutions 

presented.  Although a complete recipe for the construction of a numerical procedure is 

presented  in  its  entirety  the  applications  presented  in  this  article  are  geared  mainly 

towards  situations  where  either  an  exact  solution  may  be  derived  or  general  properties 

inferred  without  explicit  numerical  or  analytical  results.    Since  examples  of  problems 

with  exact  solutions  are  rare  their  presentation  serves  both  a  research  and  pedagogical 

value towards acoustic modeling and understanding the techniques involved.  In section 

four the conclusions are summarized and discussed.   

 

The  standard  conventions  of  tensor  analysis  on  a  differential  manifold  is  used 

throughout, the reader is referred to the literature for notation [10], covariant tensors are 

denoted kA   contravariant  tensors

kA   and  indices  are  raised  and  lowered  by  the  metric 

tensor 

A =

k

j

Ag
kj

.    The  author  uses  a  different  signature  for  the  metric  tensor  than 

White,  following  the  trend  commonly  found  in  general  relativity  and  much  of  the 

standard  jargon  used  throughout  is  common  in  general  relativity.    The  index  notation 

used throughout serves a dual purpose in labeling tensor components with respect to the 

manifold  with  inner  product 

m ng   and  components  of  vector  quantities  in  ordinary 

Euclidian space, such as the fluid velocity 

.  In the first case indices may be raised and 

u

j

lowered by the metric tensor and its inverse while in the latter case there is no difference 

between covariant and contravariant notation, 

u =
j

u

j

.  

 

5 

Section 2.  Derivation of the Paraxial Ray Trace Procedure 
 
 

The geometry of the characteristics, ray paths, derived from the basic equations of 

hydrodynamics in an inhomogeneous environment is described by a metric tensor and its 

inverse, as shown below. 

1) 

gm n

=

2

(

c

u

2

)

i

u

u

j

d

ij

 

 

 

1a) 

m n

g

=

1
2
c

1
j

u

u

k

2

d

c

jk

uu
j

k

 

As a consequence of Lorentz invariance the eikonal can be identified will a Null hyper-

surface  embedded  in  four  dimensional  space-time  defined  by  its  four  dimensional 

gradient 

m

  through  the  relation, 

g m n

Q = .    This  identification  is  consistent 

0

m

n

with the characteristic found in equation 4, Thompson [14], and the system of ordinary 

differential  equations  describing  the  rays  is  identical  to  the  geodesic  equation  for  the 

metric  in  equation  1.    The  geodesics  of  a  differential  manifold  determined  by  the 

equation, 

2) 

 

m

2
xd
l
2
d

G+

m

a b

a

dx
l
d

b

dx
l
d

=

0

 

 

 

 

 

 

 

6 

(cid:2)
(cid:3)
-
-
-
(cid:4)
(cid:5)
(cid:4)
(cid:5)
-
(cid:6)
(cid:7)
(cid:5)
(cid:5)
(cid:7)
(cid:3)
(cid:4)
(cid:4)
(cid:6)
(cid:2)
-
-
-
-
¶
Q
¶
Q
¶
may  be  derived  from  the  Lagrangian 

L

=

m

xxg

m n

2/n

,  where  l   is  an  affine  parameter 

for  the  curve  (an  affine  parameter  traverses  equal  portions  of  the  curve  in  equal 

increments).    It  is  possible  in  general  to  use  any  function 

)(lf

  which  is  strictly  a 

monotonic increasing function to parameterize a curve but not every choice will lead to 

an affine parameterization of the curve and will alter the form of equation 2, while affine 

transformations, 

s

= l
a

+

b

, leave equation 2 unchanged.   Null  geodesics  are  solutions 

to  equation  2  subject  to  the  constraint 

2

ds = ,  which  merely  states  that  the  rays  are 

0

curves  of  zero  length  in  four  dimensions.    For  the  metric  given  in  equation  1  this 

constraint  leads  to 

2

dt

+

dx dx

u
2

dxdt

=

0

  the  general  case  being 

(

2

c

(cid:9)(cid:10)(cid:9)

u

u

)

g dt
00

2

+

i
g dx dx

j

ij

+

g dtdx
02
i

i

= .  From this null constraint one can derive the following 

0

constraint  on 

xd

dt

  (the  quantity  we  normally  associate  with  the  three  dimensional 

velocity of the acoustic ray) 

3) 

 

g

ij

g

00

j

i
dx dx
dt dt

+

2

g
g

0

i

00

i

dx
dt

= -

1

. 

Using equations 3 and 1 Fermat’s principle for rays in a moving fluid may be derived [9], 

[19].  For the metric given in equation 1, equation 3 states that the ray velocity relative to 

the moving fluid equal the local sound speed  (

xd

dt

) (

u

xd

dt

)

=

u

2c

.  To derive an 

equation for 

xd

dt

 we begin by writing the equations for time and space separately using 

equation 2.  The equations for the space coordinates and time along the ray path implied 

by equation 2 are given below. 

7 

 

 

 

(cid:8)
(cid:8)
-
-
(cid:215)
(cid:215)
-
(cid:215)
(cid:9)
(cid:9)
(cid:9)
(cid:9)
(cid:11)
-
(cid:215)
-
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:11)
k

2
xd
l
2
d

G+

k

ij

i

dx
l
d

j

dx
l
d

G+

k

00

dt
l
d

dt
l
d

G+
2

k

i

0

i

dx
l
d

dt
l
d

=

0

 

2
td
l
2
d

G+

0

ij

i

dx
l
d

j

dx
l
d

G+

0

00

dt
l
d

dt
l
d

G+
2

0

i

0

i

dx
l
d

dt
l
d

=

0

 

Changing the parameter along the ray from  l  to t leads to, 

k

2
xd
2
dt

+

l
2
dtd
)
(
l
ddt

2

2

k

dx
dt

G+

k

ij

i

dx
dt

j

dx
dt

G+

k

00

G+
2

k

i

0

=

0

 

i

dx
dt

l
2
dtd
)
(
l
ddt

2

2

G+

0

ij

i

dx
dt

j

dx
dt

G+

0

00

G+
2

0

i

0

=

0

 

i

dx
dt

Using equation 7 to replace the second term in equation 6 gives 

k

2
xd
2
dt

0

ij

i

dx
dt

j

dx
dt

G+

0

00

G+
2

0

i

0

i

dx
dt

k

dx
dt

 

 

          

G+

k

ij

G+

k

00

G+
2

k

i

0

=

0

 

i

dx
dt

j

dx
dt

i

dx
dt

 

 

 

 

 

 

4) 

5) 

6) 

7) 

8) 

 

 

 

 

 

 

 

 

 

8 

The  connection  symbols  (Cristoffel  symbols  of  the  second  kind)  appearing  in  the 

definition  of  a  geodesic  are  given  in  terms  of  the  first  derivatives  of  the  metric  tensor 

(cid:13)
(cid:13)
(cid:14)
(cid:15)
(cid:16)
(cid:16)
(cid:17)
(cid:18)
G
-
through the relation 

n

a b

=

g

m b

a

¶+

g

m a

b

g

a b

m

.  Substitution of the metric in 

)

(

n m

g

1
2

equation one leads to the following for the Christoffle symbols.  

11a) 

 

0

00

=

(

1
c
2

2

2

c

t

u

(
c

2

)
)

=

u

2

d

u

ln

c

+

uu
i

j

2

2
c

S

ij

 

11b) 

 

0

i

0

=

1
c
2

2

(

(
c

2

i

)

u

2

+

u

j

w

)

¶=

ij

ln

c

i

u

j

2

2
c

S

ij

 

11c) 

i

00

=

(
u

i

1
c
2

2

2

c

t

2

c
2

u
t

i

¶+
2
c

(
c

2

i

)

u

2

uu
i

(
c

2

)2
)

 

u

       

=
 

u

i

d

ln

c

u

u
t

i

¶+

cc
i

wu
j

ij

1
2

(
c

d
2

ki

uu
k

i

)
S

 

jk

j

u
22
c

11d) 

i

j

0

=

(
c

2

w

ij

1
c
2

2

uu
i

k

w

¶+
u
i

kj

(
c

2

j

)2
)

 

u

       

¶=
u
i
 

ln

c

j

+

w

1
2

kj

k

uu
i
22
c

S

jk

 

11e) 

 

0

ij

1=
c 2
2

S

ij

 

11f) 

 

k

ij

=

k

u
c 22

S

ij

 

9 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

¶
-
¶
G
-
(cid:209)
(cid:215)
-
¶
G
-
(cid:19)
(cid:12)
(cid:12)
-
-
¶
G
-
(cid:209)
(cid:215)
-
-
¶
-
¶
G
(cid:20)
(cid:20)
-
-
-
¶
-
-
(cid:19)
-
-
G
-
G
G
Expressions for the Christoffel symbols involving spatial derivatives of the fluid velocity 

have  been  reduced  as  far  as  possible  to  terms  involving  the  quantities  such  as  the  fluid 

vorticy 

w

ij

u
i

j

u
j

i

, fluid shear and compression 

ijS

u
i

j

¶+

u
j

i

.  The reduction 

makes certain identifications easier, such as identifying effects due to fluid vorticy, shear 

and compression.  Similar expression may be found for the Cristoffel symbols of the first 

kind which are needed later in calculations of the covariant Riemann tensor. 

Using the reduced Christoffel symbols and after some simple algebra the equation 

for the 3 dimensional ray paths as a function of time becomes 

12) 

(
xd

k

)

u

k

(
x

=

dt

)

k

(
xS
ij

i

k

u
2 2
c

)(
x

j

u

i

)

j

u

(
x

j

S

jk

1
2

)j

 

u

                     

(
x

j

jk

)

j

u

c

c

k

+

u

j

S

kj

+

j

w

 

jk

 

          

+

u

k

)
(
d

u

ln

c

+

(
r

2

)

u

ln

u

1
2
)c

 

1
2
(
x

w

k

 

 

 

where 

=(cid:22)
r

ˆk
x e
k

  and 

d

u

¶=

u
(cid:215)+

t

,  the  directional  derivative  along  u

,  are  introduced 

simply  as  a  convenient  shorthand.    Letting 

t

dt

  be  a  solution  to  equation  12 

k =

k

dx

(more  generally  equation  8)  the  components  of  the  tangent  vector  of  any  affine 

parameterized null curve may be written as 

, where 

T =0

lddt

.   It is a 

)kt

(
10=m
T
T
)kt

(
1=m

straight forward matter to check that 

t

 satisfies the null condition. 

Equation 12 explicitly demonstrates the relation of the Eikonal gradient to the ray 

through the identification 

nc ˆ

” x

u

 and can be used to determine either the evolution of 

x

 or  nˆ .  In the original approach taken by White the contravariant ray equation are not 

10 

 

 

 

 

 

 

 

¶
-
¶
”
¶
”
-
-
-
-
-
-
(cid:21)
(cid:21)
(cid:21)
(cid:21)
(cid:21)
¶
-
-
-
(cid:21)
(cid:209)
(cid:215)
-
-
(cid:22)
(cid:22)
(cid:23)
(cid:22)
(cid:23)
(cid:24)
(cid:23)
(cid:23)
(cid:209)
(cid:22)
(cid:22)
(cid:24)
(cid:25)
(cid:25)
(cid:26)
(cid:25)
-
(cid:26)
(cid:25)
explicitly  presented  leaving  instead  the  equations  for  the  covariant  ray  tangent,  or  the 

conjugate  momentum  variables  associated  with 

the  generalized  coordinates, 

demonstrating  the  presence  of  Doppler  shifts  due  to  explicit  time  dependence  in  the 

environmental parameters, see equation 35 of reference [21]. 

 

  The canonical momentum variables are defined as 

p

m

d

d
xA

m

=

n

xg
m n

 leading 

to  the  identification  of  the  spatial  momentum  and  energy, 

p

-=
x

u

t

=

ˆ
nct

  and 

-=

p

0

)ncxt
(
ˆ

,  White  identifies  the  latter  with  the  frequency  content  of  the  acoustic 

signal.  From these definitions the phase front normal, or the gradient of the eikonal can 

be  identified  as  the  dual  vector  to  the  ray  tangent.    The  definition  of  the  covariant  ray 

tangent, or canonical momentum, here can be made to coincide with the definition of the 

quantities  0r ,  1r ,  2r ,  3r  given by Thompson [14]. 

The behavior of neighboring geodesics is governed by the Jacobi equation, 

13) 

 

m

2
YD
l
2
d

(
R

m

+

a n b

b

a
TT

)

g

l

(

)

n

Y

=

0

 

where, 

aT  is the tangent to the geodesic 

g

)(l

 parameterized by  l  and 

m
DT

m

 is 

F

D ”
l
d

the  covariant  derivative  along  the  geodesic.    The  specific  geodesic  labeled 

g

F

)(l

, 

referred  to  as  the  fiducial  geodesic  is  used  as  a  reference  curve  for  tracing  geodesics 

within a neighborhood of 

.  The components of the Riemann curvature, 

mR

a n b

, and 

g

)(l

F

the covariant Riemann tensor, 

m a n bR

, are given in a coordinate basis by 

 

 

 

 

 

11 

(cid:27)
(cid:27)
”
(cid:21)
(cid:20)
(cid:21)
(cid:21)
(cid:20)
(cid:20)
(cid:215)
(cid:26)
(cid:25)
(cid:26)
14) 

 

m

R

a n b

¶=

n

m

a b

b

m

a n

G+

m

l n

l

a b

m

l b

l

a n

, 

and 

 

 

 

 

 

15) 

 

R

m a n b

¶=

{
m

n

a b

;

}

{
m

b

a n

;

}

G+

r

a n

{
r

}

m b

;

r

a b

{
r

}m n

;

, 

respectively.    The  vector  field 

mY ,  referred  to  as  the  Jacobi  field  or  geodesic  deviation 

vector,  measures  the  local  separation  of  neighboring  geodesics  relative  to  a  chosen 

reference  geodesic.   In  general  relativity it is identified with the relative  acceleration of 

nearby  freely  falling  test  particles  (for  time  like  geodesics  representing  the  free  fall 

motion  of  massive  test  particles).      Equation  13  is  a  special  case  of  a  more  general 

deviation  equation  for  which 

mY   is  constrained  by 

m

n
gTY

0=m n

,  i.e.  the  deviation 

vector is held orthogonal to the geodesic (in the 

m ng  sense) [2].  To convert equation 13 

into  an  ordinary  differential  equation  in  l   a  non  rotating,  pseudo-orthonormal,  frame 

field is introduced along 

)(lg

 [5].  Letting 

mT  serve as one of the coordinate directions a 

second null vector, 

mL , satisfying the condition 

m

n
gTL

1-=m n

, is chosen as the second 

basis vector.  To complete the local geodesic coordinate basis two space-like directions, 

a
1e  and 

b
2e , satisfying the conditions 

a
IeT

0=a

, 

a
IeL

0=a

 and 

a
I ee

a
J

=

d

IJ

 for I, J = 1, 

2 are introduced.  After defining this pseudo-orthonormal basis at an initial point on 

)(lg

 

the basis must be parallel transported along 

 to define a new basis at each point by 

)(lg

solving the parallel transport equation. 

12 

G
G
-
G
G
¶
-
G
G
-
¶
-
17) 

 

m

(
ˆ
eDT
m

I

a

)

=

G+

a

m n

(
m
ˆ
eT

I

n

)

=

0

 

a

)

(
ˆ
ed
I
l
d

An important consequence of this construction is that the deviation vector points 

in  four-dimensional  space-time  from  the  fiducial  geodesic, 

  to  a  point  on  a 

g

)(l

F

neighboring  geodesic, 

)(l

,  with  the  same  value  of  affine  parameter  l .    Since  time 

g

N

will not be an affine parameter the deviation vector will not necessarily remain “in phase” 

in the traditional sense with the fiducial ray path.  This does not pose any problems in the 

geometric  description  of  neighboring  curves  since  the  Jacobi  field  simply  maps  out  the 

local  space-time  geometry  in  a  tube  surrounding 

without  prejudice  to  any 

g

)(l

F

coordinate  and  time  is  just  another  coordinate  in  the  four  dimensional  geometric 

paradigm.  After a family of neighboring rays is mapped in space time by the Jacobi field 

a cross section of the ray tube at a constant value of coordinate time may be constructed 

and the resulting picture interpreted as a surface of constant time, i.e. all rays hitting the 

equal time cross section have equal time of flight from the source to that surface.  It will 

turn out to be the case that the appropriate three dimensional equal time slice is generated 

automatically from the four dimensional geometric description. 

The initial space-like basis is chosen to be purely spatial in the coordinate frame, 

(
ˆ
e

I

)

=m

(
0

)

ˆ
e

I

,  to  ensure  that  the  rays  are  emitted  from  the  source  at  the  same  time.  

This  places  a  restriction  on  the  null  vector 

mL .    Using  equation  1  the  constraint 

(
m
ˆ
IeT

)

=m

0

 reduces to 

ˆ
eI

(
t

u

) 0
=

, indicating that the initial two dimensional space-

like hyper-surface is tangent to the Eikonal surface at the initial point on 

)(lg

.  Imposing 

 

 

13 

-
(cid:215)
(cid:11)
(cid:11)
the other constraints on the second null vector 

mL  leads to, 

m
L

=

(
1

1
c
2

+

)u
2

t

.  It is a 

straight  forward  matter  to  check  that  all  conditions  defining  our  pseudo-orthonormal 

basis  are  satisfied  by  this  choice.    Furthermore,  it  is  easy  to  check  that  the  linear 

combination, 

=

Et

m

T

+

m
L

,  defines  a  time-like  direction 

1
cT

2

0

=

Et

(
1

1
c

)u

  that  is 

orthogonal  to  our  two-dimensional  space-like  hyper-surface 

  at  all  points  in  space-

Ieˆ

time,  that  (

m

) (

)

m

E

t

E

t

1-=

  and  that,  after  a  slight  bit  of  algebra,  this  time-directed  unit 

vector is parallel transported along and null geodesic, 

m

tEDT
m

(

)
0=a

.  By construction, 

the null basis vectors are parallel propagated automatically, leaving only the spatial basis 

Ieˆ

 to be computed.   

Even  though  the  initial  basis  vectors  are  chosen  such  that  (
ˆ
e

)

=m

(
0

I

)

ˆ
e

I

  and 

(
t

u

) 0
=

ˆ
eI

 upon propagation along the geodesic 

)(lg

 the vectors 

Ieˆ

 will pick up 

time components and the purely spatial portion will not in general remain parallel to the 

three dimensional surface of equal time.  Essentially the deviation vector begins to turn 

toward the coordinate time axis so that it always remains orthogonal, in the 

m ng  sense, to 

the time-like direction  

=

Et

(
1

1
c

)u

. 

It is desirable to seek  a  description of the orthogonal separation of rays at equal 

values  of  time  as  this  will  be  the  primary  quantity  that  determines  the  geometric 

transmission loss in an acoustic beam as it travels through the medium.  Using the metric 

given in equation 1 along with the null constraint it is a straight forward matter to show 

that  the  four  dimensional  orthogonality  relation 

n
m
ˆ
geT
I

=m n

0

  implies  the  relation 

 

14 

(cid:20)
(cid:20)
-
(cid:20)
-
(cid:215)
(cid:11)
(cid:11)
(cid:20)
(
t

u

) (
ˆ
e

I

)
0
ˆ
Tte
I

0

=

0

  and  with  a  little  algebra  one  can  show  that  the  normalization 

condition 

m
n
ˆˆ
gee
I
I

=m n

1

  implies 

ˆ
e

I

ˆ
et

0 =
I

1

 with respect to the ordinary dot product in 

three  dimensional  space.    Hence  the  three  dimensional  vector 

k

~
e

ˆ
e

k
I

0ˆ
e
I

k

dx

dt

  is 

tangent to the equal time three-dimensional Eikonal surface everywhere along the ray and 

obeys  the  three  dimensional  orthonormality  condition  as  it  is  propagated  along  the  ray.  

Hence,  once  the  full  deviation 

Y

m

=

m
ˆ
eY
11

+

m
ˆ
eY
22

  is  calculated  the  equal  time  deviation 

vector 

~
Y

k

=

(
k
ˆ
eY
1
1

)

+

(
ˆ
eY
2

k
2

k
0
ˆ
et
1

)0

2

k
ˆ
et

  may  be  constructed  with  the  result  that 

~
Y

=

m
YY

m

=

2
Y
1

+

2
Y
2

.    While  the  basis 

  drops  out  of  the  calculation  for  the 

Ieˆ

geometric  spread  of  the  rays  their  calculation  is  still  required  for  a  solution  to  the 

deviation components 

IY  in the internal frame.   

Projected  into  the  non  rotating  pseudo-orthonormal  basis  equation  13  is  reduced 

to the linear second order equation, 

18) 

 

2
Yd
I
l
2
d

+

YK
IJ

J

=

0

 

with, 

Y

I

ˆ=

a
Yge
a b
I

b

, and the curvature matrix 

K

R

m a n b

a

n
b
m
ˆˆ
eeTT
J
I

IJ

 is introduced, sum 

over J = 1, 2 is implied.  Since the space like basis is parallel propagated and the metric is 

a  covariant  constant  quantity,  a  factor  of 

s
ˆ   may  be  brought  through  the  covariant 
Ieg
m s

derivative  in  the  first  term  of  equation  13.    If  the  curvature  is  positive  definite  every 

where along the ray then neighboring rays in all directions tend to converge and a three 

dimensional  ray  bundle  will  focus,  possibly  forming  caustics,  periodically.    If  the 

15 

 

 

 

 

-
(cid:215)
-
(cid:20)
(cid:20)
(cid:20)
-
(cid:25)
-
”
-
-
”
curvature is zero or negative everywhere along the ray then neighboring rays will tend to 

eventually diverge (initial conditions play as important a role in the formation of a focal 

point as the properties of the medium).  The condition 

>K

11

0

, 

>K

22

0

 and 

det

IJK

>

0

 

along 

)(lg

 may be viewed as a strong condition resulting in convergence of all rays in 

all directions about the fiduciary ray.  If this condition is not satisfied then rays in some 

directions  may  converge  while  others  diverge,  as  happens  to  be  the  case  in  a  layered 

medium.  The condition for positive definiteness of the curvature matrix may serve as a 

test  for  the  stability  of  a  ray  system  as  well  as  to  determine  the  validity  of  a  paraxial 

approximation  since  clearly  if  Y  grows  too  large  it  will  no  longer  be  a  good 

approximation to a neighboring ray in the system.  It should be stressed however that an 

occasional occurrence of non positive curvature does not signal the breakdown of such an 

approximation  altogether.    Given  a  preset  tolerance  for  the  distance  between  rays  as 

estimated by the deviation, which may  be due to an error tolerance, 

Y <

D

 as  long  as 

this tolerance condition is satisfied the deviation vector may be used to approximate the 

location  of  neighboring  geodesics.    It  may  happen  for  example  that  rays  in  a  region  of 

space  with  positive  curvature  initially  enter  a  negative  curvature  region  briefly  only  to 

enter  a  convergence  zone  before  being  separated  by  a  distance  greater  than  the  desired 

The covariant Riemann tensor components in a Cartesian coordinate basis derived 

from the metric in equation 1 are listed below. 

tolerance.    

 

 

 

19) 

 

R

nimj

=

1
24
c

(
SS
mn

ij

)

 

SS
mi

nj

16 

-
20) 

S

j

ik

S

ij

k

ln

Sc

ik

j

ij

k

R

0

ikj

=

(

1
2

)

+

(
S

1
2

)c

 

ln

           

+

u
n
24
c

(
SS
ik

jn

SS
ij

kn

+

w

S

ik

jn

w

S

ij

kn

)

 

 

 

 

 

 

 

 

 

 

 

21) 

R

00
i

j

-=

S

t

ij

1
2

(

n

u

1
2

¶+

S

j

in

w

j

in

)

¶+
c

+

c

j

i

S

ij

ln

c

 

t

1
2

          

+

uu
mn
4 2
c

(
SS
ij

nm

2

SS
in

jm

)

w

S

im

jn

(
SS
im

jm

1
4

+

w

S

im

jm

+

w

S

jm

im

)

 

                                  

(
S

u

+

n
2

ln

+
Sc

ln

Sc

ij

n

in

j

jn

i

)c

 

ln

Other relevant terms may be calculated using the symmetries of the Riemann tensor. 

When  equation  18  is  expanded  into  a  sum  over  individual  components  of  the 

Riemann  tensor  we  are  left  with  terms  of  the  form 

R

,  defining  the  second 

m

a n b

a

T

n b

I

rank  antisymmetric  tensor 

m n

I

n
m
ˆ
eT
I

n
ˆ
eT

m
I

. 

  The  tensor, 

,  is  parallel 

m n

I

transported  along  any  geodesic  (this  follows  from  the  fact  that 

mT   and 

n

Ieˆ   are  parallel 

transported that any higher order tensor constructed from them is parallel transported as 

well).    Furthermore, 

  naturally  describes  the  three  dimensional  equal  time  eikonal 

m n

I

embedded in three dimensional Euclidian space.  The mixed (time - space) components 
(
dx

, are clearly proportional 

of the tensor, 

(
0
ˆ
eT

)
ˆ
edt

k
ˆ
eT

0
ˆ
eT

=

=

=

)

0

k

k

0
I

~
0
k
eT
I

0
I

k
I

k
I

I

to  the  equal  time  Eikonal  tangents  defined  in  an  earlier  paragraph  while  the  pure  space 

components, 

ik

=

I

i
ˆ
eT

k
I

k
ˆ
eT

k
I

=

~
k
i
eT
I

~
i
k
eT
I

, are equal to the components of the cross 

product 

IeT ~·

 in three dimensions.  The transport equation for 

m n

I

 is then, 

17 

¶
-
¶
¶
-
¶
-
-
¶
¶
¶
-
¶
-
-
-
¶
-
¶
¶
L
-
”
L
L
L
-
-
L
-
-
L
(cid:20)
L
22) 

 

m n

I

G+

m

a

a b

T

b n

I

G+

n

a b

a

T

m b

I

0=

. 

d
l
d

 

 

Either  of  equations  17  or  22  may  be  used  to  determine  the  basis  along  the  ray.    The 

identification of the quantities in the auxiliary basis with the equal time eikonal tangents 

allows  one  to  make  use  of  powerful  intuitive  tools  later  on.    When  the  free  index 

appearing  in  the  deviation  equation,  equation  18,  is  summed  over  the  internal  basis  we 

are left with the following quantities 

K

=

IJ

R

m n a b

m n

a b

I

J

. 

1
4

 

Equations  17,  18  and  22  are  linear  and  may  be  solved  for  by  use  of  standard 

propagator techniques.  In each case, equations 17 and 18, the field at any point along the 

ray  may  be  expressed  as  a  linear  operator  acting  on  the  initial  values  of  that  field,  e.g. 

e =
ˆ

a
I

a
eM
b

b
I

0ˆ

 and 

Y =

I

YA
IJ

0J

, and an equation for the evolution of the operator itself is 

produced  from  the  original  differential  equation  for  the  field.    This  approach  is  used 

extensively  in  the  paraxial  ray  trace  approach  employed  in  Seismology  [4].    In  general 

relativity the operator approach is used to analyze the global structure of space time using 

the Raychudhuri equations, although for problems in theoretical relativistic astrophysics 

such  techniques  are  not  necessarily  employed  as  a  general  rule  [5],  [1].    In  the  case  of 

purely  two  dimensional  problems,  such  as  surface  waves  and  layered  media,  the 

geometric constraints are enough to completely determine the basis vectors by inspection 

rendering the transport equations superfluous.  In the next section the approach outlined 

above  is  applied  to  two  dimensional  problems  and  layered  media.    Since  in  these  cases 

the  basis  is  automatically  given  by  the  ray  tangent  and  the  Jacobi  equation  is  a  scalar 

equation the operator approach is not developed further and the reader is referred to the 

18 

L
L
L
L
L
following references for details on the technique, its application and an interpretation of 

the operator formalism [4], [5]. 

 

Equation 18 is a system of two second order linear differential equations, identical 

to two coupled harmonic oscillators with variable spring constants, and the solutions will 

depend on two constants of integration 

0Y  and 

0Y

.  The construction of the auxiliary basis 

vectors and their interpretation allows one to make contact with the physical situation at 

hand.    The  components  of  the  equal  time  deviation  vector 

  approximate  a  small 

~
IY

element  of  arc  length  within  the  Eikonal  surface  in  the 

Ie~   direction.        Modeling  the 

behavior  of  a  small  section  of  a  wave  front  requires  an  appropriate  choice  of  initial 

conditions  for  the  deviation  vector.    Firstly,  for  any  initial  phase  front  some  fixed  non 

zero value 

0Y  is chosen.  Then, for a plane region 

=Y

0

0

, for a convex (spherical) patch 

0

  (such  that  rays  are  initially  receding  from  each  other)  and  for  a  concave  region 

0

  (such  that  rays  are  initially  approaching  each  other).    For  a  point  source  simply 

choose the conditions for a convex region with 

=Y

0

0

 and 

>Y

0

0

.   

 

Regarding  the  analysis  of  acoustic  phenomena  in  a  random  media  equation  18 

serves  a  dual  purpose.    Firstly  it  can  be  used  to  determine,  given  the  environmental 

parameters  as  analytic  functions  or  numerical  data,  whether  ray  divergence  or 

convergence will occur for a given ray by evaluation of the coefficients 

IJK  along the ray 

in  question.    Secondly,  if  it  is  determined  that,  for  a  given  set  of  initial  conditions,  the 

rays in a tube surrounding a fiduciary ray do not diverge, the solutions to equation 18 can 

be used to map neighboring rays relative to the chosen fiduciary ray rather than solving 

the ray equation several times over for a given set of initial conditions.  If the coordinates 

>Y

0

<Y

0

 

19 

(cid:26)
(cid:26)
(cid:26)
(cid:26)
(cid:26)
of  the  fiduciary  ray  in  three  dimensional  space  are 

)(t

  the  neighboring  rays  are 

x k
F

approximated by the Cartesian coordinates 

x

k
N

)(
t

=

x

k
F

)(
t

+

~
k
)(
tY

.  Denoting the general 

solution of equation 18 

, the initial conditions may be chosen such that they 

(
~
;
YYtY
0

j
0 ,

k

)j

describe the initial shape of the cross section of a beam and its initial rate of change.  By 

~
tracing  Y

  for  fixed  t  and  all  values  of  initial  conditions,  a  picture  of  the  beam  cross 

section  at  any  later  time  may  be  constructed.    The  area  of  the  planar  cross  section  is 

calculated using 

tA
)(

~
tY
)(

~
tYd
)(

~
, where  Y

~
 and  Yd

 may be expressed in terms of 

=

1
2

~
Y  and 
0

~
Yd
0

.  Although such a description of the ray bundle is a planar approximation and 

ignores any spherical bulging that may occur, this method of modeling the beam should 

remain quite accurate as long as a reasonable tolerance is placed on the allowed size of 

the deviation vector, e.g. 

 which states that the deviation is less than the 

~ <<
Y

1
mR

a n b

radius of curvature in any direction.   

Section 3.  Application to Layered Media 

Over the years several generalizations of Snell’s law for special circumstances of 

a  moving  fluid  have  been  introduced  [6],  [8],  [11],  [12],  [16],  [17].    In  all  cases  the 

existence of a cyclic variable is required to derive the result.  To the author’s knowledge 

the earliest derivation of a generic Snell’s law for rays in a moving fluid valid for large 

Mach numbers can be found in Kornhauser (1953), equation 35 of reference [11].   

Through the purely geometric treatment of acoustic rays as geodesics of a metric 

space  these  conservation  laws  emerge  in  a  natural  way  by  identifying  isometries  of  the 

 

 

 

 

20 

(cid:27)
·
metric.  Once the isometries of a manifold are found a conserved current for each can be 

constructed  from  the  infinitesimal  generator  of  the  isometry.    The  technique  is  used 

extensively  in  general  relativity  to  describe  particle  motion  in  terms  of  energy 

conservation  in  an  effective  potential  rather  than  through  the  geodesic  equations.    The 

technique is used here to derive Snell’s Law in a moving fluid for cases with translational 

symmetry.  For a more detailed account of the use of isometries and Killing’s theorem the 

reader  is  referred  to  appendix  C  of  Wald  [20],  and  O’Neill  [11].    The  resulting 

conservation  laws  allow  for  an  exact  solution  to  the  full  four  dimensional  frame 

calculation  and  lead  to  a  very  simple  form  for  the  sectional  curvature  for  an  arbitrary 

layered media without the need to explicitly solve for the rays. 

The  presence  of  a  cyclic  coordinates  in  the  metric,  labeled Cx ,  leads  to  a 

conservation law for the corresponding momentum, 

23) 

 

dp
C
l
d

=

dg

b

T

b
l

C
d

x

d

a
C

=

b

Tg
a b
l

d

0=

 

where 

ax
C   is  the  Killing  vector  in  the  direction  of  the 

Cx   coordinate  curves.    When 

applied to the acoustic metric Snell’s law can be interpreted as conservation of the ratio 

momentum/energy of the acoustic ray.  

Specializing to a time independent  environment  with Killing vector 

ax =
t

(
1 0

)

 

leads to the conservation law 

24) 

 

(
c

2

u

2

)

dt
l
d

u

rd
l
d

=

k

. 

2

21 

  

 

 

 

 

 

(cid:25)
(cid:215)
-
-
-
(cid:20)
(cid:20)
Traditionally this is associated with the energy of the particle and for our choice of metric 

signature 

  is  negative.    With  the  null  condition  equation  24  may  be  written  as 

k

2

(
rdr

dt

)

u

(cid:215)=

ˆ
ncr

-=

k

2

, relating the “energy” to the angle between the phase normal 

and  the  ray  tangent.    Next,  consider  a  problem  of  a  layered  medium  where  c  and  u

 

depend on only one coordinate, say z, ideal for approaching depth dependant problems in 

underwater or atmospheric acoustics.  In principle there are two more conserved currents, 

which  may  be  thought  of  as  components  of  the  ray’s  translational  momentum.    The 

situation  is  the  same  if  we  consider  the  problem  in  cylindrical  coordinates  with  the 

interpretation that there is no angular deviation of the ray from its initial plane and there 

exists one conserved current in the radial direction.  All things considered, it suffices to 

look  at  the  Killing  vector  in  one  direction,  the  x  direction.    With  x  the  second  cyclic 

coordinate the Killing vector 

0 1 0 0

 leads to the corresponding conservation 

ax =
x

(

)

law, 

 

 

 

 

 

25) 

 

dx
l
d

dt
l
d

u

x

=

k

. 

1

Imposing the null constraint on the components of the tangent vector leads to, 

26) 

 

(
c

2

)

u

2

dt
l
d

2

+

rd
l
d

rd
l
d

2

dt
l
d

u

rd
l
d

=

0

, 

which may be solved for  T

, letting 

T

=

ˆ
T n

. 

22 

-
(cid:215)
(cid:21)
(cid:20)
(cid:20)
(cid:20)
(cid:21)
(cid:20)
(cid:25)
-
(cid:215)
-
(cid:215)
(cid:28)
(cid:29)
(cid:30)
(cid:31)
 
!
-
-
"
"
"
"
(cid:25)
(cid:25)
(cid:25)
27) 

 

rd
l
d

=

dt
l
d

u

+

ˆ
n

2

c

u

2

(
u

+

)

2

ˆ
n

=

dt
l
d

u

||

+

2

c

2

u

 

In the above expression the relation 

u

2

=

u

2

||

u
^+

2

 is used, with 

 component of fluid 

u

||

=

velocity  along  the  ray  and 

  component  of  fluid  velocity  perpendicular  to  the  ray.  

=^u

Inserting this result into each of equations 24 and 25 leads to  

28) 

29) 

 

 

(
(
c

2

)

u

2

+

u

(

u

||

||

dt
l
d

+

2

c

u

2

=

k

 

2

)
)

(

n

x

(

u

dt
l
d

+

||

2

c

)

u

2

)

u

x

=

k

 

1

Taking the ratio of equations 28 and 29 and defining 

k ”

k

k

1

2

 leads to the final result, 

30) 

 

n

x

(

u

u

(
c

2

+
)

+

||

2

u

c

2

(

u

)

u

2

u

+

2

c

||

||

=

k

. 

x
u

)

2

As a simple consistency check consider the limit 

0

.  This leads immediately to the 

u ﬁ

usual version of Snell’s law in a layered media, 

xn c
/

=

const

.

y
 or  cos

=

/

c

const

.

  This 

result  is  applied  to  the  special  case  of  a  depth  dependant  sound  speed  and  a  depth 

dependant velocity field 

u

u=

ˆ
( )
x z i

.  The angle between the ray and the velocity field is 

the same as the x – component of the unit normal, which allows for the simplification,  

23 

 

 

 

 

 

 

 

#
$
%
&
’
(
-
#
$
%
&
’
(
(cid:215)
-
(cid:215)
^
)
)
)
-
-
^
-
-
^
-
-
-
-
^
^
(cid:25)
(cid:11)
31) 

 

em

2

2

y

cos
e
+

2

1

e

2

m

em

2

+

m

y
cos
em

1
y
cos

+

e

2

m

2

2

y

sin
m

2

2

1

e

2

y

sin

2

m

2

cos

2

y

=

k

, 

in  which 

e =

0cu

  is  defined  as  the  local  Mach  number  and 

m =

0 /c

c

  is  the  index  of 

refraction (Kornhauser’s notation is used).  This result can be compared to equation 35 of 

Kornhauser,  where  use  of  the  trigonometric  identity 

cos

2

J

+

2

J

sin

=   shows  they  are 

1

identical [8].   

 

It  is  also  worth  noting  that  the  standard  integrals  one  encounters  in  the  study  of 

underwater  acoustics  in  layered  stationary  media  may  be  derived  using  this  formalism.  

Specializing to a static stationary medium and using a conformal metric [20] in the form 

-=

0

2

dt

+

(
rdrd

)

zc
)(/

2

 the three Killing vectors 

ax =
t

(
1 0

)

, 

ax =
x

(

0 1 0 0

 and 

)

)0100=ax

(

y

 lead to the following conservation laws. 

32) 

 

h
-==

pt

,     

p x

=

k

=

1

,      

p y

=

k

=

2

dt
l
d

1
zc
)(

2

dx
l
d

1
zc
)(

2

dy
l
d

 

The  first  expression  of  equation  32  implies that  time  is  a  proper  affine  parameter.    The 

line element of the problem implies the relation  

33) 

 

dt
l
d

2

+

1
)(
zc

2

dx
l
d

2

+

1
)(
zc

2

dy
l
d

2

+

1
)(
zc

2

dz
l
d

2

=

0

. 

Inserting equation 31 into equation 33 and solving for 

dz /

ld

 leads to  

24 

 

 

 

 

 

 

-
-
-
-
)
)
(cid:215)
(cid:25)
(cid:13)
(cid:14)
(cid:15)
(cid:16)
(cid:17)
(cid:18)
(cid:13)
(cid:14)
(cid:15)
(cid:16)
(cid:17)
(cid:18)
(cid:13)
(cid:14)
(cid:15)
(cid:16)
(cid:17)
(cid:18)
(cid:13)
(cid:14)
(cid:15)
(cid:16)
(cid:17)
(cid:18)
-
35) 

 

=

zc
1)(

a-

2

zc
)(

2

 

dz
dt

where equation 32 has been explicitly used to change from 

ld  to  dt .  From the second 

and  third  relations  in  equation  32  we  derive  the  relation 

2

x

+

2

y

==
r

)(zc

a2

  for  the 

horizontal  ray  speed.    In  equation  35  the  ray  parameter 

a

k

2

+

k

1

2

2

h

/

  is 

introduced.   

 

Although the  generalized version of Snell’s  Law provides one with the shape of 

the  acoustic  rays,  it  is  not  sufficient  for  calculating  the  sectional  curvature  needed  to 

determine  the  deviation  from  equation  18,  hence  the  tangent  vector  along  the  four 

dimensional ray as a function of  l  must be determined.  Consider a medium described 

by a depth dependant sound speed 

)(zc

 and a depth dependant fluid velocity of the form 

u

zx
)(

u

z
)(

.  Specializing for the time being to rays that are in the x – z plane as such 

rays  do  not  have  torsion,  and  constitute  an  effective  two  dimensional  system.    In  the 

discussion special results for the case 

0=¢c

)(zu

, 

 arbitrary will be pointed out.   

Equations  24  and  25  lead  to  the  following  first  order  ordinary  differential 

equations for the ray trajectory. 

36) 

37) 

 

 

2

c

dt
l
d

=

k

2

u k

 

1

dx
l
d

=

k

c

1
2

(
c

2

)

+

u

2

k

c

2
2

u

 

25 

 

 

 

 

 

(cid:26)
(cid:26)
(cid:26)
*
+
,
-
.
/
”
”
-
-
38) 

 

2
-=*

dz
l
d

k

2
1

+

(

k

2

1
2
c

u k

)2

 

1

The last equation is derived from the null condition which reads 

39) 

 

 

2

c

2
+*

dt
l
d

dz
l
d

2
-=*

k

2
1

 

before  substitution  of  equation  36  into  equation  39.    Defining  the  ray  parameter 

a =

k

k

1

2

 as before, equations 36 and 38 together imply the following integral relating 

time of flight to depth.   

40) 

 

=

t

zc
1)(

2

z
)(

zc
)(

2

 

dz
b

In equation 40 the modified ray parameter is defined

b

)(
z

a

1(

a u

(

z

))

.  The equation 

for 

dx

dt

 also contains this new ray parameter. 

41) 

 

u

z
)(

=

b

2)()(
zcz

 

dx
dt

Equation 36 indicates that rays could encounter a turning point in the time direction when 

u =

k

k

2

1

.  It follows from equation 39 that the presence of a turning point in time along 

26 

 

 

  

  

 

 

 

 

-
+
,
-
.
/
+
,
-
.
/
+
,
-
.
/
-
-
D
-
”
-
any  ray  implies  the  unphysical  result  that  ( )

2 <z

0

.    Without  loss  of  generality  one  can 

choose 

0>t

,  measuring  positive  time  for  increasing  l   leading  to  the  restriction 

u <

k

k

2

1

  along  any  ray.    By  equation  38  we  see  that 

0=z

  when 

–=u

c–

, 

k

2

k

1

, and from the previous comment solutions corresponding to the plus sign in 

the absolute value may be ignored, leaving 

–=u

c-

 to determine the turning points in 

the z direction.  Setting equation 39 equal to zero implies 

u

=

k
k

1

1

2/

(

)

2

2/

+

2

c

 

for the allowed turning points of the ray in the x direction.  For 

0

 the ray turns in a 

>k
1

region  where 

0<u

  while  for 

<k
1

0

  we  have 

0>u

  for  the  turning  point.    These 

comments  are  entirely  general,  holding  for  any  layered  media,  and  this  behavior  may 

easily be verified in the case for the linear velocity profile considered by Kornhauser.  In 

the  general  case  differentiating  equation  38  implies 

differentiation of equation 41 and use of the last result implies 

z

2
tc

-=

(
uk
1

+¢

)ztcc

2

  while 

-=

(
uk
1

+¢

)ttcc

.  The 

constant 

k   is  related  to  the  x  component  of  the  Eikonal  gradient  along  the  ray, 

1

=

(
dxt

dt

)u

=

 

xnct ˆ

k

1

, and may be positive, negative or zero.   

 

The  Christoffel  symbols  for  a  generic  time  independent  layered  media 

derived from equations 11a through 11e are listed below. 

 

 

 

 

42a) 

 

z

x

0

=

2

c

0

xz

=

u ¢

 

1
2

42b) 

 

z

00

=

cc

uu

 

27 

(cid:26)
0
(cid:26)
W
”
W
W
*
+
,
-
.
/
W
-
W
0
0
0
0
¢
(cid:27)
(cid:27)
(cid:27)
(cid:27)
¢
-
(cid:27)
(cid:26)
G
G
¢
-
¢
G
42c) 

 

0

0

z

=

1
c
2

2

(
2

cc

)uu

 

42d) 

 

x

0

z

=

(
u
2

cc

1
c
2

2

uu
2

)u

2

 

c

42e) 

 

x

xz

=

uu

 

1
22
c

From  the  point  of  view  of  treating  the  rays  as  time  parameterized  trajectories, 

there  is  no  need  to  solve  the  transport  equations  for  the  parallel  propagated  basis.    The 

single basis vector for the eikonal,  e~ , may be constructed by simply rotating the normal 

=

nˆ

rd

dt

u

 by 90o in the x – z giving the following expressions for the components of 

the second rank antisymmetric tensor 

m n

, 

te x
ˆ

0ˆ
xe

–=

cz

 and 

te z
ˆ

0ˆ
ze

=

k

1

c

 and 

the  useful 

relation 

x
ˆ
ze

z
ˆ
xe

–=

k

2

c

,  which 

is  derived 

from 

the 

identity 

i
ˆ
eT

k
I

k
ˆ
eT

k
I

=

~
k
i
eT
I

~
i
k
eT
I

 the expressions for the Eikonal tangent and the ray equations 

38 through 40.   

The  Cartesian  components  of  the  covariant  Riemann  tensor  derived  from  the 

acoustic metric and equation 15 are listed below. 

43a) 

 

xxR
00

=

(
u ¢

2

)
4

 

28 

 

 

 

 

 

 

 

 

¢
-
¢
G
¢
-
¢
-
¢
G
¢
G
(cid:11)
(cid:11)
-
L
0
0
0
-
1
0
0
-
-
(cid:27)
(cid:27)
-
-
43b) 

 

Rxzxz

=

2

(
)
u ¢
4c

2

 

43c) 

 

R zxz
0

=

(
c

u
2

1
c
4

2

+¢

(
uu

)

2

)u

 

2

cc

43d) 

 

R zz
00

-=

(

1
c
4

2

4

3
cc

+¢

2

3
c

(
u

)

2

+

uu
2

4

c

uu

+¢

u

2

(
u

4

cc

)2

)

 

Using  the  basis  vector 

  and  the  tangent 

T

meˆ

m

=

m

x

  along 

)(lg

  the  sectional 

curvature may be calculated by expanding 

K

m n

a b

 explicitly to give  

1
= R
4

m n a b

44) 

 

=
RK

00

xx

(

)

2

0

x

(

)

2

0

z

+

R

00

zz

+

R

xzxz

(

)

2

xz

+

2

R
0

zxz

0

z

xz

. 

After  equations  43a  through  43d  and  the  expressions  for  the  components  of  the 

antisymmetric  tensor 

  are  inserted  in  equation  44  and  equations  37  through  39  are 

m n

used to eliminate 

 equation 44 reduces to equation 45 

mx

45) 

 

=

K

k

c

1
2

d
dz

(
u

(

k

2

)
)

+

k

uk
1

2
1

c
c

 

 

 

 

 

 

 

 

 

 

29 

¢
¢
-
¢
¢
¢
¢
-
¢
¢
¢
¢
-
(cid:26)
L
L
L
L
L
L
L
L
(cid:26)
¢
¢
-
¢
for  the  sectional  curvature  for  the  hyper-plane  spanned  by 

m eT
ˆ,

m

.    The  equation  for 

geodesic  deviation  in  local  non-rotating  coordinates  reduces  to  a  second  order  linear 

equation for a single scalar field, equation 48. 

48) 

 

2
Yd
l
2
d

+

k

2

748

2

a

d
dz

2

c

(
u

(
1

a u

)
)

+

a

2

243

Y

=

0

 

c
c

It  is  understood  that  the  second  term  in  equation  48  is  evaluated  along  the  specific 

geodesic 

)(lg

 in question.  Equation 48 may be converted into a differential equation in 

the variable z instead of  l  in the case of a layered medium.  In general, this does not lead 

to  an  exact  solution.    But  for  the  special  case  =c

constant  can  be  reduced  to  a  single 

integral.  Before going further some comments are in order regarding the different terms 

that  appear  in  equation  47  and  their  effect  on  ray  divergence  or  convergence.    The  last 

term  simply  states  that  c ¢

  governs  the  focusing  properties  of  the  medium  due  to  the 

inhomogeneous sound speed.  A ray propagating in a region with 

¢c

0>¢

 will eventually 

encounter conjugate points while rays propagating in regions where 

¢c

0<¢

 will diverge 

from  one  another.    The  effects  of  fluid  motion  can  be  broken  up  into  two  terms, 

k

u

t
1

(
u

) (
k

2

)2

c

1

.  The second term is always negative, causing ray divergence.  In the 

first term 

0>t

 and the focusing effects are determined by the relative sign of 

k  and u ¢

1

.  

This term will cause focusing of acoustic rays when 

 are the same sign.  As a 

k  and  u ¢

1

consequence  a  constant  fluid  velocity  has  no  effect  on  the  stability  of  neighboring  rays 

while a fluid velocity with a constant gradient could interfere with the focusing caused by 

an inhomogeneous sound speed with 

¢c

0>¢

. 

30 

 

 

 

5
6
¢
¢
-
¢
¢
¢
-
¢
¢
(cid:26)
0
¢
¢
 

Now  consider  the  special  case  of  a  layered  medium  with  =c

  constant.    Using 

equations 38 through 41 and the expressions for  z

 and  t

 introduced earlier the sectional 

curvature  is  simply 

K

-=

.    Changing  variables  to  z,  along  any  segment  of  the  ray 

zd
dz

where 

0„z

, in the first term and defining a new field through 

Y

Zz

 converts equation 

48  into  a  first  order  equation  in  the  variable  Z ¢ ,  where  dot  denotes  derivative  with 

respect to affine parameter and prime denotes differentiation with respect to z.  Equation 

48  then  reduces  to  equation  (

3

¢Zz

)

=

0

  which  implies 

3
Zz

=¢

c
1

.    After  a  second 

integration and solving for Y the general solution for the Jacobi field is 

49) 

 

>4?

Y

=

z

c
1
3
z

:4;

+

dz

c

2

. 

For  cases  when 

0=z

  identically  along  the  ray  one  cannot  perform  the  change  of 

variables from  l  to z and such cases must be treated separately.    

Rays  with 

=k
1

0

  have  special  significance.    Kornhauser  points  out  that  for  a 

linear fluid velocity and constant sound speed these rays act as asymptotes for the other 

rays  in  the  system.    Some  of  his  conclusions  can  be  generalized  here.    In  any  case 

equations  38  and  40  may  be  solved  by  inspection  to  yield 

t

l

  and 

z

–=

+

ct

0z

.  

Equation  39  reduces  to 

x

)(z

,  which  simply  states 

)(z

  along  the  ray.    By  a 

=

u

t

k
2=
c

u=

dx
dt

change  of  variables  x(z) 

–=

dx

dz

,  which  may  be 

integrated 

to  yield 

)(u
z
c

31 

 

 

 

 

0
0
0
0
0
0
(cid:26)
(cid:26)
”
¢
9
0
<
=
0
0
(cid:26)
9
9
=

x

x

0

u

1
c

)(
z

dz

.  These results generalize the special case considered by Kornhauser, 

which predicts for the linear case a special ray 

x

2~ z

 that acts as an asymptote for rays 

that do not have turning points in the z direction.  Rays with 

0

 (in the same direction 

>k
1

as the fluid) will turn before  reaching the 

0

 curve  while rays with 

=k
1

<k
1

0

 (against 

the fluid) will approach the 

0

 curve asymptotically.  Finally, equation 48 reduces to 

=k
1

K = 0 along the ray 

0

, hence the Jacobi field for this case reduces to 

Y

=k
1

= l
Y
0

+

Y
0

.  

 

For  a  linear  fluid  velocity  profile, 

  and  c  =  constant,  the  second  term 

az=u

vanishes and 

K

-=

2

k

a

2
1

2

c

.  The deviation equation may immediately be integrated to 

yield 

Y

(
Y
0

=

)
sinh(

K

l

K

)

+

Y
0

cosh(

l

K

.    Hence  neighboring  rays  initially  at  the 

same  position  will  diverge  at  a  rate  of 

Y

c
)/

  with  respect  to  the 

affine  parameter.    The  ray  coordinates  may  also  be  solved  in  this  case  to  yield 

l
)(

t

sinh(

lk
a
1

c
)/

 hence the ray divergence is linear in time for a linear fluid velocity 

just as in the case of no fluid motion.  While this result may be surprising this trend is not 

)
(
Y
0

=

)
sinh(

K

lk
a
1

a generalization as the next example illustrates. 

 

Consider the case of symmetric fluid velocity profile, of which 

u

zx
)(

=

2

az

 is an 

example.    More  generally  consider 

u

>zx
)(

0

  such  that 

u

)0(

=

0

, 

¢u

)0(

=

0

  and 

u

)0(

=

s

with 

=k
1

  a  positive  constant.    For  such  fluid  velocities  the  comments  regarding  rays 

0

 are valid.  Consider rays fired horizontally from a source placed at z = 0 with 

0=z

  along  which 

dx

/

dt

= - 1
a

=

c

, 

2

k=tc

, 

ˆ =ze

1

  and 

ˆ 0
e

= xe
ˆ

=

0

.    Equation  47 

2

gives 

K

  and  the  deviation  vector  has  the  form 

Y

=

Y
0

cos

(
w l

)

+

(
w l

)

 

sin

Y
0
w

2

k
2=
4
c

s
c

 

32 

–
(cid:26)
9
9
(cid:181)
¢
¢
(cid:26)
9
0
with 

”w

K

.  Since 

l~x

 and 

l~t

 along this ray, the deviation exhibits oscillatory 

behavior in  any of the variables  x, t or  l .  This form of solution indicates  that, to first 

order, a ray fired along the symmetry axis will contain conjugate points down stream, i.e. 

focal  points  and  caustics  are  expected  to  form  periodically.    In  spite  of  an  explicit 

appearance of 

 in equation 47 it can be shown that the ray  equations as  well as the 

k

2

Jacobi equation are manifestly independent of this parameter when coordinate time, depth 

or  three–dimensional  arc  length  parameterizations  are  used.    For  time  parameterization 

along  this  ray  the  time  between  consecutive  conjugate  points  is 

T =

p

s
c

  while  the 

horizontal distance between consecutive conjugate is 

R =

p

s

c

. 

Extending the discussion of the symmetric fluid velocity profile a bit further, note 

that the results of the special case 

0

 hold in general, recalling that for these rays the 

=k
1

sectional  curvature  vanishes  resulting  in  divergent  behavior  of  neighboring  rays.  

Furthermore for rays fired in the negative x direction the sectional curvature is negative 

and non zero, 

K

-=

 leading to exponentially divergent behavior of neighboring 

2

k

2
4
c

s
c

ray in any of the variables x, t or  l .  The 

=k
1

0

 rays in this case divide the x- z plane 

into two separate regions of positive (in the direction of the moving fluid) and negative 

(against the moving fluid) curvature (see figure 1). 

 

 

33 

 

 
Figure  1.    Depiction  of  rays  formed  by  the  velocity  profile  described  above.    A 
symmetric waveguide is created for rays fired along the fluid velocity anywhere within 
 
the  convergence  zone.    Rays  fired  against  the  wind  spread  apart,  while  those  with 
=k
  define  the  boundary  between  convergence  and  divergence  zones  and  is  of  the 
1

0

form 

x

=

x

0

u

)(
z

dz

. 

1
c

 

 

 

 

 

 

 

 

 

 

34 

–
Section 5.  Discussion and Conclusion 

 

The  general  procedure  for  a  paraxial  ray  tracing  algorithm  may  be  outlined  as 

follows.    Given  the  environmental  parameters 

tx
),(

  and 

txc
),(

,  either  as  analytic 

u

functions or numerical data, determine a specific solution (or set of solutions) to equation 

12 as the fiduciary  ray (ray system) 

.  Solve equations 17 or 22 to determine the 

g

)(l

F

parallel propagated basis at ever point along 

.  This specific tangent field and space 

g

)(l

F

like  basis  defined  on 

  along  with  the  Riemann  tensor  components  given  in 

g

)(l

F

equations 19 through 21 are used to set up the equation for the deviation vector, equation 

18.    Equation  18  may  then  be  solved  numerically,  or  in  some  cases  analytically  by 

propagator  techniques  to  a  desired  accuracy  for  any  initial  conditions  on  the  deviation 

vector, recalling that the initial conditions are chosen to model the initial shape of a small 

patch  of  the  phase  front.    Given  specific  input  values  for  the  matrix  components 

appearing in equation 18 one can check for the existence of convergence and divergence 

zones along the  ray to determine if the  ray is stable and if the procedure  is expected to 

remain valid, within a desired accuracy.  If it is determined that the sectional curvature is 

positive  definite  everywhere  along 

  we  can  immediately  conclude  that  conjugate 

g

)(l

F

points exist along 

 and that as long as the ray can be extended indefinitely  down 

g

)(l

F

stream  these  conjugate  points  will  exist  periodically.    Applying  the  conjugate  point 

theorems  of  differential  geometry  if  an  upper  and  lower  bound  exist  such  that 

k

1

,ˆ,
TYTYR

,ˆ(

)

k

2

  then  conjugate  points  appear  with  a  period 

T

  [7].  

p

k

2

p

k

1

These  conjugate  points  are  identified  as  focal  points  along  the  ray.    If  the  sectional 

curvature  is  zero  or  negative  everywhere  along 

  then  neighboring  rays  will 

g

)(l

F

 

35 

(cid:25)
(cid:25)
(cid:25)
£
£
£
£
eventually  diverge  (a  single  caustic  may  form  if  the  initial  region  is  concave  but 

otherwise  one  does  not  expect  the  periodic  development  of  focal  points  further  down 

stream).    In  situation  where  a  ray  may  enter  convergence  and  divergence  zones 

occasionally one can not conclude from checking the Riemann tensor whether conjugate 

points will occur and how frequently.  In these cases the paraxial procedure may still be 

employed  as  long  as  the  deviation  remains  within  a  desired  tolerance  limit  (the 

divergence zones may not occur frequently enough or for a long enough time to prevent 

future  ray  crossing  or  invalidate  the  first  order  approximation  to  the  neighboring  ray 

coordinates).   

 

It is worth noting that the formalism appearing in Seismic Ray Tracing, Cerveny 

[4], follows from the differential geometric treatment of the problem presented in section 

2.    For  cases  where 

u

=tx
),(

0

  identically  and 

txc
),(

xc
)(

  the  acoustic  the  metric 

=

appearing in equation 1 may be replaced by 

ds

2

-=

2

dt

+

(
xdxd

)

2

/

c

x
)(

 by performing a 

conformal  transformation.    The  geometry  of  the  null  hypersurface  is  immune  to  any 

conformal  changes  in  the  metric  tensor  as  long  as  the  affine  parameter  is  appropriately 

changed,  (

~
l
d

W=
a

2

l
d

  and 

~
g

a b

W=

2

g

a b

)  [20].    In  this  case  coordinate  time  becomes 

the  affine  parameter  for  the  geodesics  of  the  conformal  metric  and  the  null  geodesics 

correspond to the space - like geodesics a three dimensional space with conformal inner 

product [11].  In this new metric space “distance” is equivalent to the travel time between 

two points on the ray.  The corresponding Chistoffel symbols and Riemann tensor are  

50) 

 

k

ij

-=

(
d

ln

c

+

d

ln

c

ki

j

kj

i

d

ij

k

)c

 

ln

 

 

 

36 

(cid:25)
(cid:25)
(cid:25)
(cid:25)
)
)
)
(cid:215)
¶
-
¶
¶
G
and 

 

 

 

 

51) 

 

k

R

mjn

X=

kjmnpq

p

q

ln

c

¶+

ln

c

p

ln

q

d

kn

mj

d

d

kj

mn

ln

c

ln

c

 

)c

(
d

+

)

(

respectively,  with 

{
(
d

d

d

d

)
d

(
d

+

d

d

d

)
d

}
. 

  A  straight 

kjmnpq

kj

pm

mj

pk

qn

mn

qk

kn

qm

pj

forward application of equation 17 to this case demonstrates that the parallel propagated 

frame field appearing in Cerveny is identical to that predicted here.   

For  purely  two  dimensional  systems,  i.e.  surface  waves  or  effective  two 

dimensional  ray  systems  in  underwater  acoustics,  the  sectional  curvature  appearing  in 

equation 18 is given by 

(cid:209)=
cK

2

c

c

c

.  Common examples of sound speed profiles 

used in modeling deep ocean acoustic wave  guides appearing in standard texts, such as 

Tolstoy  and  Clay,  may  be  analyzed  using  the  Jacobi  equation.    Specifically  the  sound 

speed profile 

)(
zc

=

C

cosh

, appearing in reference [15], produces a space of 

constant positive curvature 

.  The deviation vector can be solved exactly  for all 

rays  in  this  system  with  the  result 

tY
)(

=

A

cos(

tK

)

+

B

sin(

tK

)

.    One  can  conclude 

from this that periodic focusing will occur along each and every ray bundle with the same 

frequency  regardless  of  the  placement  of  the  source,  Tolstoy  demonstrates  the  focusing 

effect specifically for a source placed on the wave guide symmetry axis.  The time versus 

depth  integral  can  be  performed  in  this  case  leading  to  the  result  that  the  travel  time 

between turning points is independent of initial conditions, hence the point like focusing 

demonstrated in reference [15] will always occur.    

(

)CzK

/

0

0KK =

37 

¶
¶
¶
(cid:209)
(cid:215)
(cid:209)
-
@
@
-
-
”
X
(cid:209)
(cid:215)
(cid:209)
-
(cid:25)
(cid:25)
 

The  exact  ray  paths  can  be  found  for  the  sound  speed 

+=)(
zc

a

bz

  [15].    The 

induced  metric  space  is  known  in  the  literature  as  a  Lobeschevsky  space  and  is  an 

example of a space of constant negative curvature.  The deviation vector in this case may 

be  found  by  inspection  to  be 

tY
)(

A

cosh(

B

sinh(

tK

)

,  implying  that  all  rays 

=

tK

)

+

diverge exponentially from each other.   

 

The  vast  amount  of  exact  solutions  that  may  be  found  for  layered  media  with  a 

moving  fluid  not  only  serve  as  important  for  their  pedagogical  value  in  acoustic  and 

differential  geometry  but  may  serve  as  decent  approximations  to  real  life  situations  in 

underwater  or  atmospheric  acoustics.    Especially  in  cases  where  there  is  fluid  motion 

along with an approximately constant sound speed as equation 49 represents formally an 

exact solution in terms of a single integral. 

Acknowledgments 

The  author  would  like  to  thank  The  ASEE  (American  Society  for  Engineering 

Education)  and  the  Naval  Research  Lab  (N.R.L.)  in  Washington  D.C.  for  sponsoring  a 

summer faculty fellowship for the summer of 2003 during which time some parts of this 

work were completed.  Portions of this work as well as its authorship were completed in 

part  using  resources  provided  by  New  York  University  through  the  Faculty  Resource 

Network,  special  thanks  to  their  staff.    The  author  would  also  like  to  acknowledge  Dr. 

Daniel Wurmser, N.R.L., for sponsoring the fellowship and for collaboration and helpful 

comments during the start of the project.  Finally special thanks to Dr. Roger Gauss, Dr. 

Robert Gragg, N.R.L., for helpful suggestions. 

 

 

 

 

38 

References: 
 

2003 

Cambridge 

949, 1953 

Heinemann 

[1]  Abromowicz, M. A., and Kluzniak, W., Epicyclic Orbital Oscillations in Newton’s 

and Einstein’s Dynamics, General Relativity and Gravitation, Vol. 35, No. 1, pp. 69 – 77, 

[2]  Bazanski, S., L., Kinematics of relative motion of test particles in general relativity 

(1), Ann. Inst. Henri Poincare, Section A, Vol. XXVII, No. 2, 1977, p. 155 - 144 

[3]  Bergman, D. R., Generalized Paraxial Ray Trace Procedure Derived from 

Riemannian Geometry, ARLO (in review) 

[4]  Cerveny, V., Seismic Ray Theory, Cambridge University Press 

[5]  Hawking, S. W., Ellis, G. F. R., The Large Scale Structure of Space – Time, 

[6]  Heller, G. S., Propagation of Acoustic Discontinuities in an Inhomogeneous Moving 

Liquid Medium, JASA, Vol. 25, No. 5, pp. 950, 1953 

[7]  Kobayashi, S & Nomizu, K, Foundations of Differential Geometry Volume I and 

Volume II, John Wiley & Sons, INC 

[8]  Kornhauser, E. T., Ray Theory for Moving Fluids, JASA, Vol. 25, No. 5, pp. 945 – 

[9]  Lifshitz, E. M. and Pitaevskii, Fluid Mechanics, 2nd edition, Butterworth & 

[10]  Misner, C. W., Thorne, K. S., Wheeler, J. A., Gravitation, Freeman 

[11]  O’Neill, B., Elementary Differential Geometry, Academic Press  

 

39 

[12]  Rudenko, O. V., Sukhorukova, A. K., and Sukhorukov, A. P., Full Solutions to the 

Equations of Geometrical Acoustics in Stratified Moving Media, Acoustical Physics, Vol. 

43, No. 3, 1997, pp. 339 – 343 

[13]  Schneider, P., Ehlers, J., Falco, E. E., Gravitational Lenses, Springer-Verlag 

[14]  Thompson, R. J., Ray Theory for an Inhomogeneous Moving Medium, J. Acoust. 

Soc. Am., Vol 51, No. 5 (Part 2), p. 1675, 1972 

[15]  Tolstoy, I., and Clay, C. S., Ocean Acoustics, Theory and Experiment in 

Underwater Sound, McGraw-Hill, 1966, (specifically page 157) 

[16]  Ugincius, P., Acoustic-Ray Equations for a Moving, Inhomogeneous Medium, J. 

Acoust. Soc. Am., Vol 37, No. 3, p. 476, 1965 

[17]  Ugincius, P., Ray Acoustics and Fermat’s Principle in a Moving Inhomogeneous 

Medium, J. Acoust. Soc. Am., Vol 51, No. 5 (Part 2), p. 1759, 1972 

[18]  Unruh, W. G., Experimental black hole evaporation?, Phys. Rev. Lett., 46, 1351 – 

1353, 1981 

arXiv:gr-qc/9712010, 1997  

[19]  Visser, M., Acoustic black holes: horizons, ergospheres, and Hawking radiation, 

[20]  Wald, R. M., General Relativity, The University of Chicago Press 

[21]  White, R. W., Acoustic Ray Tracing in Moving Inhomogeneous Fluids, J. Acoust. 

Soc. Am., Vol 53, No. 6, p. 1700, 1973 

 
 

 

 

40 

