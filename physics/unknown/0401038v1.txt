Применение нейронных сетей для анализа состояния тонких 
пленок органических соединений на поверхности воды. 
Филимонов А.В., Валькова Л.А., Ососков Г.А. 

Аннотация 

В  статье  рассматривается  возможность  применения  нейронных  сетей  для 
анализа состояния тонких пленок в определенном фазовом состоянии, а именно: 
интерполяция  экспериментальных  данных.  В  данной  работе  нейронные  сети 
используются  как  метод  для  построения  модели  процесса  сжатия  слоев 
органических соединений на поверхности раздела фаз вода - воздух. 

 

Постановка задачи 

В  [1]    исследуется  поведение  тонких  пленок  3  –  нитро  –  5  –  трет  –  бутил  – 
фталоцианина  меди  (CuPc*)  на  поверхности  воды  при  сжатии.  Данное 
соединение (рис. 1) используется для изучения сенсорных наноматериалов.  

tC4H9

X

X

tC4H9

N

Cu

N

X

N

N

tC4H9

X

 

tC4H9
Рисунок 1. CuPc* (X=NO2). 
В  ходе  сжатия  оцениваются  такие  физические  параметры  пленки  как: 
площадь  А,  приходящаяся  на  одну  молекулу,  и  поверхностное  давление  π.  На 
основе  полученных  данных  строятся  графики:  π=f(A-1)  и  πА=g(π).  Нас 
интересуют линейные участки графиков, т.к. они соответствуют  определенным 
фазовым состояниям. Используя линейные зависимости: 

π=a+EA-1                                                                   (1) 
πA=C+πAmol                                                                                                 (2) 
можно  оценить  величину,  характеризующую  фактор  сжатия  слоя  в 
определенном фазовом состоянии, E и предельную площадь, приходящуюся на 
одну молекулу, Amol.  

Для оценки параметров E и Amol при изменении условий формирования слоя 
(в  частности,  начальной  поверхностной  концентрации)  требуется  каждый  раз 
проведение  нового  эксперимента  и  расчетов.  Для  сокращения  количества 
экспериментов 
модель, 
построенную на основе использования нейронных сетей [2, 3].  

математическую 

использовать 

предлагается 

При  построении  модели  было  выяснено,  что  нейронные  сети  нельзя 
использовать  “в  лоб”  для  моделирования  экспериментальных  зависимостей 
π=f(A-1)  и  πА=g(π)  при  различных  начальных  концентрациях.  Как  будет 
показано  ниже,  эта  проблема  связана  с  наличием  фазовых  переходов 
(переходных  точек  между  линейными  и  нелинейными  участками).  На  основе 
этого  факта  был  предложен  метод  выявления  фазовых  переходов  с  помощью 
нейронных сетей. 

Т.к.  экспериментальные  зависимости  π=f(A-1)  и  πА=g(π)  не  удалось 
корректно  смоделлировать,  то  во  второй  части  этой  главы  предлагается 
альтернативный подход для оценки параметров E и Amol. 

Для выбора оптимальной структуры сети использовался метод динамической 

оптимизации структуры сетей [4].  

Выявление фазовых переходов 

Для  выявления  фазовых  переходов  используется  способность  нейронных 
  и  противоречивые  данные.  Делается  это 

сетей  выявлять  аномальные 
следующим образом.  

аномальными 

точками.  Действительно, 

Нейронная сеть обучается на апроксимацию зависимостей π=f(A-1) и πA=g(π). 
Если  имеются  противоречивые  или  аномальные  данные,  то  при  тестировании 
сети они дадут максимальную погрешность распознавания. Фазовые переходы и 
являются 
не  может 
апроксимировать  кусочные  функции,  а  анализируемые  графики  зависимостей  
являются  такими  функциями,  поскольку  состоят  из  линейных  и  нелинейных 
участков.  Аномальными  точками  в  этом  случае  будут  точки  перехода  между 
линейными  участками,  а  это  и  есть  фазовые  переходы.  Сеть  будет  пытаться 
представить график в сглаженном виде. Если наложить друг на друга графики, 
смоделированные  сетью  и  полученные  экспериментальным  путем,  можно 
убедиться,  что  наибольшие  расхождения  (погрешности)  приходятся  на  точки 
фазовых переходов (рис. 2). 

сеть 

/

m
N
m

 
,
π

40

35

30

25

20

15

10

5

0

NN

Experiment

Error

1,0

0,8

0,6

0,4

0,2

0,0

/

m
N
m

 
,
r
r
E

0,01

0,02
0,03
A-1, mol/nm2

0,04

Рисунок 2. Графики зависимостей π=f(A-1), полученных экспериментальным 
путем  и  смоделированных  сетью,  при  начальной  поверхностной  концентрации 
N0=6,1.·107, Моль·.м-2. 

Для  того,  чтобы  определить,  какие  именно  пики  на  рисунке  являются 
фазовыми переходами необходим критерий отбора. В качестве такого критерия 
значение  для  погрешности 
было  предложено  использовать  пороговое 
распознавания.  Если  значение  погрешности  распознавания  больше  порогового 
значения,  то  данная  точка  является  фазовым  переходом.  Порог  определялся 

 

эмпирически  исходя  из  следующих  соображений.  Во  время  эксперимента 
замеры площади А делались через одинаковые интервалы. При таких условиях 
число  экспериментальных  точек,  принадлежащих  нелинейным  участкам 
зависимостей π=f(A-1) и πА=g(π), составляет в среднем 15-20 % от общего числа 
точек. Таким образом, для порогового значения задается условие: выше порога 
должно находиться не более 15-20% экспериментальных точек. 

Крупным недостатком такого подхода является предположение, что значения 
площади А распределены равномерно. Стоит изменить условия эксперимента и 
данный критерий работать не будет. 

В таблице 1 представлены результаты поиска фазовых переходов с помощью 

С нейросетями 

Без нейросетей1 

E·1021, Дж 

π1-π2,  мН·м-1 

E·1021, Дж 

нейросетей и без них. 
Таблица 1. 
 
.·107, 
N0
Моль·.м-2 
0.9 
1.1 

π1-π2,  мН·м-1 

<1.5 
<0.55 
>4 
>12 
<1.18 
>8 
<1.12 
>6 
<0.58 
0.86-4.98 
14.81-21.03 
>39.76 
<0.77 
5.85-17.88 
>29.96 
<0.45 
3.3-10.03 
20.05-20.23 
>28.99 
<0.95 
>5.55 

4.83 
2.3 
113.97 
93.98 
1.2 
52.94 
2.14 
67.09 
2.17 
26.04 
61.46 
14.15 
0.92 
74.94 
4.03 
2.09 
46.55 
8.50 
3.78 
3.73 
79.54 

1.7 
2 

2.1 

3 

4 

6.1 

8.8 

<2 
<0.8 
>7 
>5 
<1 
>9 
<1 
>10 
<1 
1-6 
8-28 
>40 
<0.4 
10-21 
>32 
<0.6 
6-20 
22-31 
>32 
<0.2 
>8.5 

 
Ошибка 
(%) 
5.29 
8.69 
4.22 
8.75 
8.33 
18.55 
6.54 
10.54 
3.22 
18.62 
5.44 
8.12 
8 
17.64 
25.55 
0.47 
8.72 
16.47 
17.98 
15.22 
11.62 

5.1 
2.1 
119 
103 
1.1 
65 
2 
75 
2.1 
32 
65 
13 
1 
91 
3 
2.1 
51 
7.1 
3.1 
4.4 
90 

 
Из  таблицы  видно,  что  среднее  расхождение  результатов,  полученных  с 
помощью  нейросетей,  и  результатов  табличных  составляет  10.85  %.  Таким 
образом,  несмотря  на  несовершенство  критерия  отбора  пороговых  точек, 
подход с использованием нейросетей позволил получить результаты близкие к 
табличным. 

                                                           
1 Используются табличные данные из [1]. 

 

Интерполяция данных 

В  данной  работе  предлагается  представить  E  и  Amol  как  функции  от 
начальной  поверхностной  концентрации  молекул  в  слое,  величины  обратной  к 
площади, приходящейся на одну молекулу и поверхностного давления. 

E = E(N0, A-1, π)                                                       (4) 
Amol = A(N0, πA, π)                                                      (5) 
Одновременно  с  задачей  нахождения  E  и  Amol  необходимо  определить  те 
значения  π,  которые  соответствуют  линейным  участкам  на  графиках 
зависимостей  π=f(A-1)  и  πА=g(π),  поскольку  E  и  Amol  определены  только  для 
этих участков.  

Идея  заключается  в  следующем.  Предлагается  смоделировать  зависимость 
π=π(A,  N0)  с  помощью  нейронной  сети.  При  этом  имитируются  условия 
эксперимента, когда А изменяется равномерно. Если бы не проблема, связанная 
с  фазовыми  переходам, 
то  для  выявления  линейных  участков  на 
смоделированной  кривой  и  определения  их  характеристик  можно  было  бы 
использовать  методики,  описанные  в  предыдущем  параграфе.  Поэтому 
предлагается использовать иной подход, который заключается в использовании 
двух дополнительных нейросетей обученных на моделирование зависимостей 4 
и 5.  

Используется  следующая  схема.  При  фиксированном  значении  начальной 
концентрации  на  вход  сети  поочередно  смоделированные  значения  π  и  А.  На 
выходе сети, в зависимости от того на что эта сеть была обучена, получаются E 
или Amol. Если построить графики зависимости E = E(A-1, π) и Amol = A(πA, π), то 
те  значения  π,  которые  соответствуют  линейным  участкам  на  графиках 
зависимостей π=f(A-1) и πА=g(π), образуют горизонтальные плато.  

Для  того,  чтобы  определить  Amol  и  E,  а  также  диапазон  изменения  π  для 
каждого линейного участка, достаточно прогистограммировать Amol и E по всем 
точкам.  На  точки  фазовых  переходов,  которым  соответствуют  нелинейные 
участки  зависимостей  π=f(A-1)  и  πА=f(π),  в  среднем  приходится  менее  15  % 
экспериментальных  точек.  Поэтому  при 
гистограммировании  бины  с 
наибольшим  количеством  попавших  внутрь  этого  бина  точек  соответствуют 
линейным  участкам  (рисунок  3).  Границы  бина  определяют  начало  и  конец 
участка.    Середина  бина  соответствует  среднему  значению  Amol  и  E  в  данном 
фазовом состоянии. 

Рисунок 3. Гистограммирование величины Amol при начальной концентрации 

N0=0.9.107 Моль.м-2. 

В  таблицах  2  и  3  сравниваются  результаты  полученные  с  помощью 

интерполяции с результатами полученными в результате эксперимента.  

 

Таблица 2. Интерполяция Amol. 
N0
Моль.м-2  π 1- π2, мН·м-1 

Интерполяция 

.107, 

1.7 

2.1 

2.2 

4 

<3 
>12 
<2 
14-19 
<1 
>14 
<4 
>6 
Нет 

Amol, нм2 
1.84 
0.91 
1.85 
0.9 
1.83 
0.89 
1.22 
0.9 
Нет 

Табличные данные2 

π 1- π2, мН·м-1 
<10 
>10 
<2 
12-30 
<2 
>3 
<4 
5-15 
28-31 

Amol, нм2 
1.7 
1.0 
2.1 
0.85 
1.6 
1.2 
1.3 
0.95 
0.95 

 
Используемый тип НС: персептроны. 
Метод обучения: Resilient Propagation. 
Конфигурация  сети:  2  нейрона  в  входном  слое,  17  нейронов  в  первом 

скрытом слое, 9 – во втором скрытом слое, 1 – в выходном слое. 
Опорные точки: N0 = 0,9; 1,1; 2; 3; 6.1; 8.8 . 107 Моль.м-2.  
В 

полученными 
экспериментальным  путем  и  с  помощью  интерполяции, составляет 11,4 %,  т.е. 

результатами, 

расхождение 

среднем, 

между 

                                                           
2 Используются табличные данные из [1]. 

нейронная  сеть  интерполирует  значение  Amol  почти  с  90%  точностью.  Это 
вполне  приемлемый  результат.    Таким  образом,  нейронная  сеть  способна 
апроксимировать зависимость 5 при любых значениях начальной концентрации 
как  для  первого  слоя,  когда  молекулы  располагаются  на  значительном 
расстоянии друг от друга и значение поверхностного давления невелико, так и 
для сжатых слоев, когда молекулы начинают взаимодействовать друг с другом. 

Интерполяция 

Таблица 3. Интерполяция E. 
.107, 
N0
Моль.м-2 
1.7 
2 
2.1 
4 

π1- π2, мН·м-1 
<0.8 
<0.85 
<1.34 
<0.64 

E·1021, Дж 
2.2 
1.5 
2.34 
1.7 

 

Табличные данные 
π 1- π2, мН·м-1 
<2 
<1 
<1 
<0.4 

E·1021, Дж 
2.9 
1.1 
2 
1 

Используемый тип НС: персептроны. 
Метод обучения: Resilient Propagation. 
Конфигурация  сети:  2  нейрона  в  входном  слое,  14  нейронов  в  первом 

скрытом слое, 10 – во втором скрытом слое, 1 – в выходном слое. 

среднем, 

Опорные точки: N0 = 0,9; 1,1; 3; 6.1 . 107 Моль.м-2.  
расхождение 
В 

полученными 
экспериментальным  путем  и  с  помощью  интерполяции,  составляет  30  %,  т.е. 
нейронная сеть интерполирует значение E с 70 % точностью. Это означает, что 
при интерполяции E следует учитывать какие – то иные входные параметры.  

результатами, 

между 

 
Обсуждение результатов 
С помощью нейросетей удалось провести интерполяцию Amol. Amol корректно 
интерполируется  при  любых  значениях  поверхностного  давления,  площади, 
приходящейся на одну молекулу, и начальной концентрации, т.е. зависимость 5 
справедлива при любых допустимых π и N0.  

E  удалось  интерполировать  только  при  малых  значениях  π.  Тестирование 
показало,  что  сеть  работает  с  70  %  эффективностью.  Очевидно,  что  при 
больших 
начинают 
взаимодействовать между собой, что не учитывается в данной модели. 
 

давления  молекулы 

поверхностного 

значениях 

Заключение 

Использование  нейронных  сетей  для  построения  модели  процесса  сжатия 
слоев  органических  соединений  на  поверхности  раздела  фаз  вода  –  воздух 
позволяет  проводить  интерполяцию  экспериментальных  данных.  Благодаря 
сокращается  время  на  проведение 
такой  интерполяции 
экспериментов. 

существенно 

Предельную площадь, приходящуюся на одну молекулу, можно представить 
как  функцию  от  начальной  концентрации,  площади,  приходящейся  на  одну 
молукулу,  и  поверхностного  давления.  Это  справедливо  как  для  низких 
давлений, так и для высоких.  

Величину,  характеризующую  сжимаемость  слоя,  удалось   интерполировать  
только при малых значениях поверхностного давления, когда взаимодействием 
между молекулами можно пренебречь. 

Благодарности 

Работа  выполнена  при  поддержке  Российского  Фонда  Фундаментальных 

Исследований (Проект № 03-02-16643a). 

Литература 
1.  L.Valkova,  N.Borovkov,  M.Pisani,  F.Rustichelli.  Three-dimensional  structure  of 
the copper porphyrazine layers at the air-water interface. Thin Solid Films. 2001. 
V.401 (1-2). P.267-272 

2.  Hecht-Nielsen R.,Neurocomputing, Addison-Wesley publishing company, 1989. 
3.  Khanna T. Foundations of neural networks, Addison-Wesley publishing company, 

1990. 

4.  Г.А.  Ососков,  А.В.  Филимонов,  Динамическая  оптимизация  структуры 

персептронов, Сообщение ОИЯИ, Р11-2002-274, Дубна, 2002 

