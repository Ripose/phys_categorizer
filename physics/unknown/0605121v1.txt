Preprint submitted to Elsevier Science1 May 2006Simulating the Charge Dispersion Phenomena in Micro Pattern Gas Detectorswith a Resistive AnodeM. S. Dixit*a, b and A. RankinaaDepartment of Physics, Carleton University1125 Colonel By Drive, Ottawa, ON, K1S 5B6, CanadaandbTRIUMF, Vancouver, BC, CanadaAbstract:The TPC for the International Linear Collider (ILC) will need to measure about 200 track pointswith a transverse resolution close to 100 µm. The resolution goal is beyond the capability of theconventional proportional wire/cathode pad TPC and Micro-Pattern Gas Detectors (MPGD) arebeing developed to meet the challenge. The standard MPGD readout techniques will, however,have difficulty in achieving the ILC-TPC resolution goal with the 2 x 6 mm2 wide pads as wasinitially envisioned. Proposals for smaller width pads will improve the resolution but will requirea larger number of readout channels and increase the TPC detector cost and complexity. The newMPGD readout concept of charge dispersion has the potential to achieve the ILC-TPC resolutiongoal without resorting to narrower pads. This was recently demonstrated in cosmic ray tests of asmall prototype TPC read out with MPGDs using the charge dispersion technique. Here wedescribe the simulation of the charge dispersion phenomena for the MPGD-TPC. The detailedsimulation includes initial ionization clustering, electron drift, diffusion effects, the intrinsicdetector pulse-shape and electronics effects. The simulation is in excellent agreement with theexperimental data and can be used to optimize the MPGD charge dispersion readout for the TPC.Key words: Gaseous detectors, Position Sensitive Detectors, Micro-Pattern Gas Detectors,Simulation, Gas Electron Multiplier.PACS: 29.40 Cs, 29.40 Gx1. IntroductionThe Time Projection Chamber (TPC) [1] is a prime candidate for the main charged particletracker at the future International Linear Collider (ILC). The ILC-TPC operating in a ~ 4 Tmagnetic field should measure 200 track points with a transverse resolution 100 µm for driftlengths in excess of 2 m. The resolution goal is near the fundamental limit from the ionizationelectron statistics and transverse diffusion in the TPC gas, and beyond the capability of theconventional proportional wire/cathode pad TPC [2].A TPC read out with Micro Pattern Gas Detectors (MPGD), such as the Gas Electron Multiplier(GEM) [3] and the Micromegas [4], has the potential to reach the ILC resolution goal. In normaltracking applications, MPGDs typically achieve 40 - 50 µm resolution [5] with ~ 200 µm pitch                                                  *Corresponding author; tel.: +1-613-520-2600, ext. 7535; fax: +1-613-520-7546.Email address: msd@physics.carleton.ca (M. S. Dixit).2anode pads. In conventional proportional wire TPCs, much wider cathode pads are read out tocompute the charge centroid, which determines the avalanche r-! coordinate with precision. Thefundamental resolution limit for the wire TPC comes from the E"B and track angle systematiceffects [6,7]. These effects are negligible for the MPGD readout as the scale over which the Eand B fields are not parallel is much smaller and also there is no preferred direction in contrast tothe wire readout. MPGD anode pads, 2 x 6 mm2 in size were initially proposed for the ILC-TPCreadout [8]. With the strong suppression of transverse diffusion in high magnetic fields, the trackionization charge clusters arriving at the TPC endplate will then often be confined to only one ortwo pads. This makes the anode pad centroid determination difficult and results in loss ofresolution. Reducing the pad width to improve resolution will require a larger number of readoutchannels and increase the detector cost and complexity.In an attempt to improve the charge centroid determination and hence the spatial resolution forwide pads, a novel concept of position sensing from charge dispersion [9] has been developedwhere the MPGD anode is made of a thin high surface resistivity film. The resistive anode isbonded to the readout plane with an insulating layer of glue, which acts as a dielectric spacerbetween the two planes. The composite anode-readout pad plane structure forms a distributed 2-dimensional resistive-capacitive network. Any localized charge arriving at the anode surface willbe dispersed with the RC time constant determined by the anode surface resistivity and thecapacitance per unit area, the latter determined by the spacing between the anode and readoutplanes and the dielectric constant of the glue. With the avalanche charge dispersing and coveringa larger number of pads with time, wider pads can be used for position determination. The chargedispersion process can be completely described by material properties and geometry and, incontrast to diffusion which is statistical in nature, there is no loss of accuracy in determining thecentroid of a wider distribution. Fig. 1 shows the schematics of the double GEM test cell used inour initial tests of the charge dispersion readout concept. Fig. 1. Schematic of a double GEM test cell designed for charge dispersion studies.The first proof of principle tests of charge dispersion for the GEM were carried out using acollimated soft x-ray source and have been previously published [9]. These were followed bycosmic ray resolution studies of a prototype TPC read out with GEM [10] and with Micromegas[11] using the charge dispersion technique. In this paper, we present the results of a detailedsimulation of the charge dispersion phenomenon based on the model described in [9]. The chargedispersion effect is first calculated for a single point-like charge cluster deposited instantaneouslyon the resistive anode. The finite extent of the charge cluster due to longitudinal and transversediffusion, the effects of intrinsic rise-time of the MPGD charge pulse and the rise- and fall-timeeffects in electronics are then included. Track signals can be generated by summing signals dueto individual charge clusters along the track. The simulation is in excellent agreement with the3observed features of charge dispersion and can be used to optimize the charge dispersion readoutsystem parameters for TPC.2. Modeling the charge dispersion phenomenaIf a charge is deposited on the resistive anode, the equation describing the time evolution of thesurface charge density function on the two dimensional continuous RC network is given by [9]:! "#"t=h"2#"x2+"2#"y2$ % & ’ ( ) , (1)where ! h=1RC.The solution to equation 1 for a resistive anode of finite size is an infinite Fourier series. Aclosed form solution becomes possible, however, for the case of a delta function point chargedeposited at x = y = t = 0 and when the edges are at infinity: ! "#(x,y,t)=12$th% & ’ ( ) * 2exp+x2+y2()4th[]. (2)The true initial charge profile is not a delta function but has a finite size and can be described bya Gaussian with a width determined by transverse diffusion. For a cluster with charge Nqe, theanode surface charge density as a function of space and time is obtained by convoluting equation2 with the Gaussian describing the finite charge cluster of width w:! "(x,y,t)=Nqe2#(2ht+w2)exp$x2+y2()2(2ht+w2)()[].   (3)The charge on a pad can be found by integrating the charge density function over the pad area:! Qpad(t)=Nqe4erf(xhigh2"xy)#erf(xlow2"xy)$ % & & ’ ( ) ) erf(yhigh2"xy)#erf(ylow2"xy)$ % & & ’ ( ) ) .(4)where xlow, xhigh, ylow, yhigh define the pad boundaries, and ! "xy=2th+w2.The charge is also not deposited instantaneously. The detector pulse has a finite intrinsic risetime and the signal is also affected by electron arrival time spread due to longitudinal diffusion.To compare to experiment, the characteristics of the front-end charge preamplifiers need also tobe included. The parameterization of these time dependent effects is described below.The intrinsic rise-time of the detector charge pulse:  From Ramo’s theorem [12], the chargepulse on the GEM anode rises linearly with time as the electrons drift in the induction gaptoward the anode at a constant drift velocity.R (t) = t/Trisefor 0  < t  < Trise(5)       = 1for t  > Trise       = 0for t  < 0where Trise is the time, taken by an electron cluster to traverse the GEM induction gap.4Longitudinal diffusion: Longitudinal diffusion increases the size of electron charge clusters in thedrift direction.  The arrival time distribution of electrons at the resistive anode is a Gaussian withstandard deviation # determined by the longitudinal diffusion coefficient for the gas and the drifttime. The longitudinal cluster profile takes the form:! L(t)=1"2#exp$t22"2(). (6)Electronics shaping time effects: The timing characteristics of the front-end charge preamplifierare included into the charge dispersion model as follows. The step response of a charge amplifierconsists of an exponential rise, tr, and an exponential decay, tf  described by equation 7.! A(t)=exp"ttf()1"exp(ttr)[]for t > 0(7)= 0for t < 0The individual time effects are combined to create a single function describing the timedependence of the model. The convolution of R(t), L(t) and A(t) yields:! I(t)=12Triseexp"2a2/2#at()erft#Trise#"2a"2$ % & ’ ( ) +1* + , - . / #exp"2b2/2#bt()erft#Trise#"2b"2$ % & ’ ( ) +1* + , - . / +exp"2a2/2#at#Trise()()erft#2Trise#"2a"2$ % & ’ ( ) +1* + , - . / #exp"2b2/2#bt#Trise()()erft#2Trise#"2b"2$ % & ’ ( ) +1* + , - . / +exp"2a2/2#at()erft#"2a"2$ % & ’ ( ) +erft#Trise#"2a"2$ % & ’ ( ) * + , - . / #exp"2b2/2#bt()erft#"2b"2$ % & ’ ( ) +erft#Trise#"2b"2$ % & ’ ( ) * + , - . / * + , , , , , , , , , , , , , , , , , , - . / / / / / / / / / / / / / / / / / / .(8)where ! a=1tf;b=1tf+1tr.The convolution of I(t) and Qpad(t) results in the full theoretical model, which is compared to theexperiment. This convolution is handled numerically.3. Simulation – ResultsAt the basic level, the model describes the charge dispersion phenomena for a single chargecluster. The model was first tested by comparing simulation to the measurements made usingcollimated soft x rays from a copper target x-ray tube [9]. X-ray photon conversions in the gasproduce initial ionization charge clusters. A double-GEM test cell was modified for the charge5dispersion studies. A 25 µm thick Carbon-loaded Kapton foil with a surface resistivity of 530 k$per square was bonded to the readout pad plane with 50 µm thick insulating layer of glue. Thecapacitance density of the anode with respect to the readout plane was about 0.21 pF/mm2 withthe glue acting as a dielectric spacer. The measurements were carried out with the test cell filledwith Ar/CO2 90/10 gas. The gas gain was about 3500.The readout plane, shown in Fig 5 (a), hadfive rows of twelve pads, 2 x 6 mm2 each. The front-end electronics and the data acquisitionsystem were the same as described in [9].With the x-ray tube run at 6.5 kV, the average photon energy was about 4.5 keV as low energybremsstrahlung photons from the x-ray tube were absorbed by the x-ray tube and detectorwindows. A ~ 40 µm diameter hole in a thin brass disk in front of the detector produced areduced pinhole image of the x-ray tube focal spot in the GEM drift gap. The GEM test cellgeometry, the electric fields, and the diffusion properties of the gas determine the physicaldimensions of the electron avalanche charge cluster arriving at the resistive anode. For the x-raymeasurements reported here, we estimate that the charge cluster arriving at the anode had atransverse RMS width of about 250 µm and a longitudinal RMS spread in time of about 13 ns.Fig. 2. Simulated and observed primary pulse for the x-ray spot centered on pad 3 – see Fig. 5 forthe pad layout. The simulation is normalized to the experiment.6The simulation was used to compute the detailed shapes and amplitudes of charge dispersionpulses. As an example, Fig. 2 shows the measured and the simulated primary charge pulse forpad 3 with the x-ray spot centered on the pad – see Fig 5(a) for the pad layout. The amplitude ofthe simulated pulse is normalized to the measured primary pulse. With the same normalization,the simulation reproduces the detailed shape and the amplitude of the observed secondary pulseon the next neighbor pad shown in Fig. 3. The small difference between the measured and thesimulated pulse is due to the existence of induced pulse. We have previously reported on themeasurement of induced pulses in GEM detectors [13,14]. The induced pulses were not includedin the simulation as they deposit zero net charge on the pads and do not contribute to the chargedispersion signal.Fig. 3. Measured and simulated secondary pulses on Pad 4 from charge dispersion with the x-rayspot centered on Pad 3. The normalization determined for the primary pulse on Pad 3 was used tonormalize the simulated secondary pulse. The difference (dotted line) between the simulationand the experiment (solid line) comes from the induced signal due to electron drift in the GEMinduction gap. Induced signals were not simulated as they deposit zero net charge and do notaffect charge dispersion signals.7The simulation was next used to generate single cluster pad response function (PRF) for chargedispersion. Pad signals were first generated by incrementing the charge cluster position acrossthe pad width in small steps. The theoretical PRF is determined from simulated pulse amplitudesas a function of cluster position with respect to the pad centre. Fig. 4 shows the theoretical andthe measured PRFs for pads 2, 3 and 4 for the pad layout shown in Fig. 5 (a). The theoreticalPRF is in good agreement with the data. The small differences can be attributed to point-to-pointvariations of capacitance per unit area and the anode surface resistivity.Fig. 4 Simulated pad response functions (PRF) compared to the measured PRFs for pads 2, 3 and4. The pad layout is shown in Fig. 5 (a). The differences between the simulation and themeasured PRFs are attributed to local variations in the system RC constant. Nevertheless, thesimulated PRF is in good agreement with the data.The model of charge dispersion was also tested for particle tracks using cosmic ray data [10] fora small GEM readout TPC with 15 cm long drift region. A sample track is shown in Fig. 5. Padsignals for a particle track are simulated by summing the response of the pad to the ionizationcharge clusters produced by the track. Since we have no detailed information on the cluster sizedistribution for a particular track, the clustering effect was taken into account in an approximateway. Equal size equally spaced charge clusters were generated along the fitted track with the sumof cluster charges over each pad set equal to the measured pad charge. The transverse and8longitudinal dimensions of the clusters at the readout were determined from diffusion computedfor the track geometry for the event. Simulated pulses were generated for pads in the middle rowand compared to the measured pulses. The simulation is in excellent agreement with theexperiment as can be seen in Fig. 5.Fig. 5. (a) The schematics of the pad layout used for the x-ray and TPC cosmic ray tests. Thecentral 5 row of pads with 2 x 6 mm2 pads were used for tracking and the two outer rows withsingle long pads were used for triggering. (b) Cosmic ray track signals on the five middle pads ineach of the tracking rows. (c) Measured and simulated cosmic ray track signals for the fivemiddle pads in the central tracking row.4. ConclusionsA detailed physical model has been developed to describe the charge dispersion phenomena inMPGDs with a resistive anode. The simulation developed for this study provides an excellentdescription of the experimental measurements and can therefore be used as a basis for a fullsimulation of a TPC with charge dispersion readout. Although the charge dispersion simulationand experimental measurements reported in this paper are for the GEM TPC readout, the modelis equally applicable to the Micromegas.5. Acknowledgements: We thank Alain Bellerive for carefully reading the manuscript and for helpful suggestions. Thisresearch was supported by a project grant from the Natural Sciences and Engineering ResearchCouncil of Canada. TRIUMF receives federal funding via a contribution agreement through theNational Research Council of Canada.9References:1. D. R. Nygren, A Time Projection Chamber - 1975, Presented at 1975 PEP Summer Study,PEP 198 (1975), and Included in Proceedings.2. W. Blum and L. Rolandi, Particle detection with Drift Chambers, Springer Berlin, 1993, pp.179—184.3. F. Sauli, Nucl. Instrum. Meth., A386 (1997) 531.4. Y. Giomataris et al., Nucl. Instrum. Meth., A376 (1996) 29.5. F. Sauli and A. Sharma, Ann. Rev. Nucl. Part. Sci. 49 (1999) 341.6. C. K. Hargrove et al., Nucl. Instrum. Meth., A219 (1984) 461.7. S. R. Amendolia et al., Nucl. Instrum. Meth., A283 (1989) 573.8. Worldwide Study of the Physics and Detectors for Future e+ e- Linear Colliders(http://physics.uoregon.edu/~lc/randd.html).9. M. S. Dixit et al., Nucl. Instrum. Meth., A518 (2004) 689.10. R.K.Carnegie et al,’“First Tracking Experience for MPGD TPC readout with ChargeDispersion on a Resistive Anode, Proceedings of International Conference on Linear e+ e-Colliders,  LCWS2004, Paris (2004).11. A. Bellerive et al., Spatial Resolution of a Micromegas TPC Using the Charge DispersionSignal, Proceedings of International Linear Collider Workshop, LCWS2005,  Stanford, USA,arXiv:physics/0510085.12. S. Ramo, Proc. IRE, 27 (1939) 584.13. M.S. Dixit et al, Proceedings of Workshop on Micro-Pattern Gas Detectors, Orsay France(1999).14. D. Karlen et al, Physics and experiments with future linear e+e- colliders, LCWS2000,American Institute of Physics Conf. Proc. Vol 578.