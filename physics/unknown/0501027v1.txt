FERMILAB-TM-2271-AD 

Improvement in RF Curves for Booster Running at High 

Intensities 

Xi Yang and Rene Padilla 

Fermi National Accelerator Laboratory 

Box 500, Batavia IL 60510 

Abstract 

A feed-forward ramp can be implemented in Booster to compensate the beam energy loss 

at different beam intensities for the purpose of minimizing the radial error signal.  This 

can be done only when we have a good understanding about the dependence between the 

beam energy loss per turn and the beam intensity experimentally.  Besides, based upon 

this  understanding  we  can  predict  the  required  accelerating  voltage  at  the  transition 

crossing  for  different  beam  intensities,  which  can  be  extremely  helpful  for  Booster 

running at higher beam intensities than ever before.   

Introduction 

The proton beam is accelerated from 400 MeV to 8 GeV in Booster in a time of 33.3 ms, 

while the RF frequency sweeps from 37.8 MHz to 52.9 MHz.  The low-level RF system 

(LLRF)  together  with  the  bias  running  closed  loop  maintains  the  correct  phase  relation 

between the circulating beam bunches (CB) and the accelerating gap voltage.[1]  The RF 

phase angle is continuously adjusted to maintain the required rate of energy gain.  LLRF 

includes  two  feedback  systems;  phase  feedback  (fast  feedback)  keeps  a  constant  phase 

relation  between  the  CB  and  the  low-level  frequency  signal  (LO-Freq),  which  is 

generated by the VXI LLRF,[2] and radial feedback (slow feedback) keeps the beam at 

the correct radial position.  The bias running closed loop maintains the minimum phase 

error between the RF drive and the cavity field.   

The LLRF uses four approximate programmed curves to control the acceleration 

process:  FREQ,  Bias,  ROF,  and  RAG.    With  the  input  of  the  phase  error  from  phase 

 

 

 

 

 

1

feedback of LLRF, VXI LLRF generates the LO-Freq using the FREQ program in such a 

way  that  the  LO-Freq  has  the  same  frequency  and  a  constant  phase  difference  with  the 

CB through a cycle.  The radial feedback system takes the signal from the radial position 

(RPOS) and compares it with the radial offset (ROF), which specifies the desired radial 

position through the cycle.  The phase shift drive signal (PSDRV) is the sum of BDOT, 

which is the differentiation of the magnet ramp, and the product of the radial gain (RAG) 

and  the  radial  error  signal,  which  is  the  difference  between  RPOS  and  ROF.    Phase 

shifter shifts the phase  of the  LO-Freq  at the  amount of PSDRV before the  LO-Freq is 

sent to the high-level RF system (HLRF) as the RF drive.  The Bias programs the bias 

supply current in order to keep the cavity field following the RF drive.   

 

System Analysis 

Phase  detector  of  the  LLRF  phase  feedback  is  continuously  comparing  the  phase 

difference between the CB signal from the long-18 gap detector and the LO-Freq before 

it is delivered to the phase shifter, and the phase difference is sent to VXI LLRF as the 

phase error for the correction of the LO-Freq phase through a cycle.  Since the bandwidth 

of the LLRF phase detector is 1 MHz, the LO-Freq before the phase shifter is being kept 

at a constant phase relation with the CB.  PSDRV (Vpsdrv) in unit of volt can be calculated 

using eq.1 with a calibration constant of 9º/V. 

V

psdrv

t
)(

a
⋅=

tdB
)(
dt

(
R

+

t
)(

−

tR
)(
of

⋅

R

gain

pos

)

t
(

).

                                                                  1 

Here, B(t) is the magnet-ramp value at time t in a cycle.  dB(t)/dt  (BDOT) is a sine-wave 

with a frequency of the Booster rep rate 15 Hz.  The amplitude of BDOT can be set to 

one since its contribution to PSDRV can be adjusted experimentally via the multiplier a.  

Rpos(t) is the radial position of the CB from the long-18 beam position monitor (BPM), 

Rof(t) is the desired radial position via the ROF curve, and Rgain(t) is the radial gain via the 

RAG curve.    

RFSUM is the vector sum of the RF accelerating voltages from all the cavities in 

the ring.  The synchronous phase, which is the phase of the beam centroid relative to the 

sine wave of RFSUM,[3] can be calculated from PSDRV in the desired situation that the 

phase difference between the cavity field and the RF drive is zero, as shown in eq.2. 

 

2

sφ

t
)(

9
⋅=

V

psdrv

t
)(

9
⋅=

a

⋅





tdB
)(
dt

(
R

+

)(
t

−

)(
tR
of

⋅

R

gain

pos

)


.)(
t



                                          2 

 Here, 

)(tsφ  is the desired synchronous phase at time t in unit of degree.   

Since PSDRV can be measured for each Booster cycle, the desired synchronous 

phase can be calculated using eq.2.  The desired synchronous phase (

)(tsφ ) and measured 

RFSUM 

(V(t))  can  be  used 

to  calculate 

the  effective  accelerating  voltage 

(V(t)×Sin(

)(tsφ ).  Also, the effective accelerating voltage is the sum of the accelerating 

voltage required by BDOT and the energy loss per beam turn.  The accelerating voltage 

required by BDOT is known from the magnet ramp.[3]  So the energy loss per beam turn 

can be estimated from the difference between the effective accelerating voltage and the 

accelerating voltage required by BDOT.  The energy loss per beam turn can be obtained 

as a function of the beam intensity through a cycle using the linear approximation after 

PSDRV is measured at several beam intensities.  Finally, one can predict what PSDRV 

should be at a known beam intensity.    

Example and Prediction 
RFSUM  and  PSDRV  were  measured  at  extracted  beam  intensities  of  0.4×1012  protons 

and  4.7×1012  protons,  and  they  are  shown  in  Figs.  1(a)  and  1(b).    The  black  and  red 

curves in each plot represent the results for extracted beam intensities of 0.4×1012 protons 

and 4.7×1012 proton respectively.  The desired synchronous phase is calculated from the 

PSDRV data, as shown in Fig. 1(b), using eq.2, and the result is shown in Fig. 1(c).  The 

accelerating  voltage  per  beam  turn  required  by  BDOT  is  shown  in  Fig.  1(d).[3]    The 

effective accelerating voltage is calculated using “V(t)×Sin(

)(tsφ ” from RFSUM (V(t)), 

as shown in Fig. 1(a), and the desired synchronous phase (

)(tsφ ), as shown in Fig. 1(c), 

and the result is shown in Fig. 1(e).  The energy loss per beam turn is estimated from the 

difference  between  the  effective  accelerating  voltage,  as  shown  in  Fig.  1(e),  and  the 

accelerating voltage required by BDOT, as shown in Fig. 1(d), and the result is shown in 

Fig.  1(f).    The  linear  dependence  between  the  beam  energy  loss  per  turn  and  the  beam 

intensity can be estimated using eq.3.     

 

3

 

tk
)(

=

NtV
,(
(

N

2

eff




)

−

N

2
−

)

1

eff

NtV
,(
)
10





12

1

.

                                                                                              3 

Here,  Veff(t,N)  is  the  effective  accelerating  voltage  at  time t  in  a  cycle  for  the  extracted 

beam intensities of N protons, and k(t) is the linear coefficient of the dependence between 

the beam energy loss per turn and the beam intensity.  The difference of the red curve and 
the black curve in Fig. 1(e) is the same with the difference in Fig. 1(f).  N2 =4.7×1012 is 
the  extracted  beam  intensity  of  the  red  curve,  and  N1  =0.4×1012  is  the  extracted  beam 

intensity of the black curve.  The linear coefficient k(t) is calculated using eq.3, and the 

result is shown in Fig. 1(g).  Finally, the effective accelerating voltage for the extracted 

beam intensity N can be predicted using eq.4. 

NtV
,(

)

eff

=

tk
)(

⋅

NtV
,(

eff

1

).

                                                                              4 





NN
−
12
10

1


+


In the situation of N=6.5×1012, the effective accelerating voltage is calculated using eq.4, 

and the result is shown as the blue curve in Fig. 2(a).  The black curve in Fig. 2(a) is the 

same as the black curve in Fig. 1(a). 

 

Comment 

From the approximation of the linear dependence between the beam energy loss per turn 

and the beam intensity, the energy loss for different beam intensities through a cycle can 

be predicted, and it can be applied as a feed-forward ramp  to PSDRV for the purpose of 

compensating the intensity-dependent beam energy loss and minimizing the radial error 
signal.  In the situation of the extracted beam intensity of 6.5×1012, as shown in Fig. 2(a), 

the beam needs more RF accelerating voltage at the transition crossing than it gets now.  

This  can  be  achieved  by  adjusting  the  attenuation  to  the  Anode  program  before  it  is 

delivered  to  the  modulators  of  RF  stations.    The  setup  of  the  attenuation  to  the  Anode 

program is for protecting the power amplifiers of RF stations.   

Another approach for getting more effective accelerating voltage at the transition 

crossing is to find a way to decrease the energy loss of the high intensity beam.  From the 

past  experience,  the  injection  mismatch  blew  the  beam  emittance  and  made  the  energy 

loss smaller than that in the matched situation, as shown in Fig. 2(b).  Both the black and 

 

4

red curves are at the extracted beam intensity of 4.7×1012.  The red curve represents the 

injection mismatched situation with a smaller PSDRV signal than the black curve, which 

represents  the  matched  injection  situation.    Here,  the  smaller  the  PSDRV  signal  is,  the 

less  the  effective  accelerating  voltage  is.    However,  the  aperture  limit  to  the  allowed 

increase in the beam emittance should also be considered, especially for the high intensity 

situation.     

 

Acknowledgement 

Special  thanks  should  be  given  to  Bill  Pellico  for  his  help  in  understanding  the  LLRF 

issues related to this work. 

References: 

[1]  K.  C.  Harkay,  “A  Study  of  Longitudinal  Instabilities  and  Emittance  Growth  in  the 

Fermilab Booster Synchrotron”, Ph.D thesis, Purdue University, 1993. 

[2] “Low Level RF Talk”, www-ad.fnal.gov/Proton/NewBoosterWWW/Boster.htm. 

[3] X. Yang and J. MacLachlan, “Energy Loss Estimates at Several Beam Intensities in 

the Fermilab Booster”, FERMILAB-TM-2244. 

 

 

 

 

 

 

 

 

 

 

 

 

 

5

)

V
K

(
 

M
U
S
F
R

)

V

(
 

V
R
D
S
P

1000

900

800

700

600

500

400

300

10

8

6

4

2

0

-2

-4

-6

-8

-10

0

0

5

10

15

20

25

30

35

Time (ms)
Fig. 1(a)

1 turn, 12 turns

5

10

15

20

25

30

35

Time (ms)
Fig. 1(b)

 

 

 

 

6

 

180

160

140

120

100

80

60

40

20

0

)
e
e
r
g
e
d
(
 
e
s
a
h
P
 
s
u
o
n
o
r
h
c
n
y
S
d
e
r
i
s
e
D

 

600

500

400

300

200

100

)

V
K

(
 
e
g
a

t
l

o
V
g
n

 

i
t

l

a
r
e
e
c
c
a
F
R

 

0

0

1 turn, 12 turns

0

5

10

15

20

25

30

35

Time (ms)
Fig. 1(c)

 

 

5

10

15

20

25

30

35

Time (ms)
Fig. 1(d)

 

7

1 turn, 12 turns

5

10

15

20

25

30

35

Time (ms)
Fig. 1(e)

1 turn, 12 turns

900

800

700

600

500

400

300

200

100

)

V
k
(
 
e
g
a
t
l
o
V
 
g
n
i
t
a
r
e
e
c
c
A
 
e
v
i
t
c
e
f
f

l

E

0

0

300

250

200

150

100

50

0

-50

)

V
k
(
 
n
r
u
T
 
r
e
p
 
s
s
o
L
 
y
g
r
e
n
E

 

 

0

5

10

15

20

25

30

35

Time (ms)
Fig. 1(f)

 

8

 

60

50

40

30

20

10

0

-10

0

)

2
1
0
1
/
V
k
(
 
)
t
(
k

5

10

15

20

25

30

35

Time (ms)
Fig. 1(g)

 

Fig.  1(a)  RFSUM  measured  at  extracted  beam  intensities  of  0.4×1012  protons  (black 

Fig.  1(b)  PSDRV  measured  at  extracted  beam  intensities  of  0.4×1012  protons  (black 

curve) and 4.7×1012 protons (red curve). 

curve) and 4.7×1012 protons (red curve). 

Fig.  1(c)  desired  synchronous  phase  for  extracted  beam  intensities  of  0.4×1012  protons 

(black curve) and 4.7×1012 protons (red curve). 

Fig. 1(d) the accelerating voltage per beam turn required by BDOT in a Booster cycle. 

Fig.  1(e)  the  effective  accelerating  voltage  for  extracted  beam  intensities  of  0.4×1012 

protons (black curve) and 4.7×1012 protons (red curve). 

Fig.  1(f)  the  energy  loss  per  beam  turn  estimated  for  extracted  beam  intensities  of 

0.4×1012 protons (black curve) and 4.7×1012 protons (red curve). 

Fig.  1(g)  the  linear  dependence  between  the  beam  energy  loss  per  turn  and  the  beam 

intensity estimated for a Booster cycle. 

 

 

 

 

 

 

9

1000

800

600

400

200

 
f
o
r
 
6
.
5
e
1
2
 
p
r
o
t
o
n
s
 
(

K
V

)

E

l

f
f
e
c
t
i
v
e
 
A
c
c
e
e
r
a
t
i
n
g
 
V
o
l
t
a
g
e

 

0

5

10

15

20

25

30

0

35

Time (ms)
Fig. 2(a)

1000

900

800

700

600

500

400

)

V
k
(
 

M
U
S
F
R

12

10

8

6

4

2

0

-2

-4

-6

-8

)

V

(
 

V
R
D
S
P

0

5

10

15

20

25

30

35

Time (ms)
Fig. 2(b)

 

Fig. 2(a) the effective accelerating voltage calculated at the extracted beam intensity of 

Fig. 2(b) PSDRV measured at the extracted beam intensity of 4.7×1012.  The black curve 

represents  the  situation  with  a  matched  injection,  and  the  red  curve  represents  the 

situation with a mismatched injection. 

6.5×1012. 

 

 

10

