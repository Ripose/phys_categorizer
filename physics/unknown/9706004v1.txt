DTP/97/23
May 1997

Virasoro character identities and Artin
L-functions.

A. Taormina1 and S.M.J. Wilson 2

Department of Mathematical Sciences, University of Durham,
Durham DH1 3LE, England

ABSTRACT

Some identities between unitary minimal Virasoro characters at levels m =
3, 4, 5 are shown to arise as a consequence of relations between Artin L-
functions of diﬀerent quadratic ﬁelds. The deﬁnitions and concepts of num-
ber theory necessary to present the theta function identities which can be
derived from these relations are introduced. A new inﬁnite family of iden-
tities between Virasoro characters at level 3 and level m = 4a2, for a odd
and 1 + 4a2 = a′2p where p is prime is obtained as a by-product.

7
9
9
1
 
n
u
J
 
2
 
 
]
h
p
-
h
t
a
m

[
 
 
1
v
4
0
0
6
0
7
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1email address Anne.Taormina@durham.ac.uk
2email address S.M.J.Wilson@durham.ac.uk

1 Introduction

Two sets of intriguing identities between unitary minimal Virasoro characters were
presented in [4]. They are remarkable in various respects. First they provide a rewrit-
ing of the Virasoro characters at level m = 3 (resp. m = 4) in terms of diﬀerences
of quadratic expressions in Virasoro characters at level m = 4 (resp. m = 3, 5).
Second, they are stronger identities than the ones obtained by repeated use of the
Goddard-Kent-Olive sumrules [1] for the cosets [SU(2)1 ×
SU(2)1]/SU(2)3
SU(2)1]/SU(2)4. Third, their generalisation to higher levels is
and [SU(2)1 ×
proving to be a highly nontrivial problem. The proof given in [4] uses inﬁnite product
representations of level m = 3, 4, 5 Virasoro characters, as well as the celebrated Jacobi
triple identity and standard properties of generalised theta functions [2]. However, it
does not shed any light on the underlying structure of these identities, and therefore
oﬀers no clue on how to generalise them to higher values of the level.

SU(2)1 ×

SU(2)2 ×

In this paper, we use the powerful machinery of number theory 3 to prove the
same identities, and we provide a solid framework within which more identities can
be unveiled. We establish relations between two imaginary quadratic extensions over
Q, which we call K and K′ throughout. Given a Galois extension N of Q which
contains K and K′, we deﬁne two subgroups of the Galois group Γ = Gal(N/Q) to
be ∆ = Gal(N/K) and ∆′ = Gal(N/K′). The deep roots of the Virasoro identities
considered lie in the ability to identify, given N, pairs of characters χgal and χ′
gal of
dimension one on ∆ and ∆′, which induce the same character on Γ,

χgal↑Γ

∆

= χ′

.

gal↑Γ
∆′

(1.1)

(1.2)

Now, by a standard result, the Artin L-function of an induced character coincides with
the Artin L-function of the original character. So, given (1.1), one has,

L(χgal) = L(χgal↑Γ

∆

) = L(χ′

gal↑Γ
∆′

) = L(χ′

gal).

As explained later, the L-functions appearing in the expression (1.2) are related to
ray class theta functions. The latter obey nontrivial identities which can be derived
from the relations (1.2) as χgal and χ′
gal vary. Theorem 4.3 describes these identities
and oﬀers a practical way to identify relations between the generalised theta functions
in terms of which the Virasoro characters can be expressed. However its formulation
requires some ground work in number theory. We introduce the necessary mathemat-
ical jargon and results without the rather technical proofs, which will be presented
elsewhere [5].

The paper is organised as follows. Section 2 sets the notations for coset theta
functions [2], and emphasizes their rˆole in the description of the Virasoro characters

3A standard textbook discussing the tools needed is [3]

1

O

identities considered in [4]. Since Theorem 4.3 is a result about ray class theta functions,
we proceed in Section 3 to rewrite coset theta functions as ray class theta functions.
In order to do so, we introduce ray class groups over K with conductor F . These
K (the ring of integers over K) which generalises
provide a classiﬁcation of ideals in
the classiﬁcation modulo n of integers prime to n. The rˆole of the modulus is played,
in imaginary quadratic ﬁelds, by the conductor F . The three theorems at the end
of Section 4 are the key to understanding the underlying algebraic structure of the
Virasoro identities (2.4,2.5), but are also powerful tools in searching for more such
identities. The ﬁrst two subsections of Section 4 provide a brief discussion of the
ray class characters and norm maps required in Theorems 4.2, 4.3 and 4.4. We show
in Section 5 how the Virasoro identities presented in [4] arise as a consequence of
30]) and K′ = Q[i] (resp.
Theorems 4.3 and 4.4 when K = Q[√
2] (resp. K = Q[√
K′ = Q[√
10]). As an illustration of the power of the tools developed in this paper, we
also provide an inﬁnite family of identities between unitary minimal Virasoro characters
at level m = 3 and unitary minimal Virasoro characters at level m = 4a2 for a odd and
1 + 4a2 = a′2p with p prime. The ﬁrst member of this family, at a = 1, is the collection
of identities (2.4).

−

−

−

2 Coset theta functions

The m(m−1)
are analytic functions of the variable q = e2iπτ , τ

independent unitary minimal Virasoro characters at level m (m
0 deﬁned by,

C, Imτ

2

≥

2, m

N)

∈

χV ir (m)

r,s

(q) = η−1(q)

∈
θr(m+1)−sm,m(m+1)(q)
h

−

≥

θr(m+1)+sm,m(m+1)(q)

,

(2.1)

i

with the integers r and s in the following ranges,

r = 1, 2, . . . , m

1;

s = 1, . . . , r.

−

The generalised theta functions at positive integer k are given by,

for ℓ integer, and the Dedekind eta function η(q) can be rewritten as the diﬀerence of
two generalised theta functions at level 6,

θℓ,k(q) =

2

qk(n+ ℓ
2k )

n∈Z
X

η(q) = q

1
24

∞

1
Yn=0 (cid:16)

−

qn+1

= θ1,6(q)

θ5,6(q).

−

(cid:17)

χV ir (3)
1,i

(q) = ǫijk(

1)j+kχV ir (4)
j,4

(q) χV ir (4)
k,2

(q)

−

2

(2.2)

(2.3)

(2.4)

From (2.1) and (2.3), it is easy to see that the identities presented in [4], namely,

and

χV ir (4)
1,1
χV ir (4)
1,2

(q)

(q)

±

±

(q)

(q)

χV ir (4)
3,1
χV ir (4)
3,2
χV ir (4)
2,1
χV ir (4)
2,2

(q) =

χV ir (3)
1,1
h
χV ir (3)
(q) =
1,1
h
(q) = χV ir (3)
(q) = χV ir (3)

2,2

2,2

(q)

(q)

(q)

(q)

±

χV ir (3)
2,1
χV ir (3)
2,1
±
χV ir (5)
2,1
χV ir (5)
1,1

h

(q)

(q)

i h

χV ir (5)
2,2
χV ir (5)
1,2
i h
χV ir (5)
3,1
χV ir (5)
4,1

(q)

i

(q)

,

,

(q)

(q)

∓

∓

−

−

χV ir (5)
3,2
χV ir (5)
4,2

(q)

(q)

,

,

i

i

h
can be rewritten as identities involving quadratic expressions in generalised theta func-
tions at diﬀerent levels. For instance, (2.4) becomes,

i

V (1, 2)V (4

3i, 3) = ǫijk(

1)j+kV (5j

16, 4)V (5k

8, 4)

−

−

−

−

where we have introduced the V functions,

with the properties,

V (r, m) = θr,m(m+1) −

θr(2m+1),m(m+1),

V (r, m) = V (
V (r, m) =

−

−
V (r(2m + 1), m).

r, m) = V (r + 2km(m + 1), m),

k

Z;

∈

(Here, and in future, we will not express the variable q.) We note that,

= V (r(m + 1)

sm, m)/η

and χV ir(m)

r,r

= V (r, m)/η,

χV ir(m)
r,s
η = θ1,6 −

−
θ5,6 = V (1, 2).

We ﬁrst remark that the generalised theta functions (2.2) are coset theta functions

Let X be a suitably sparse subset of a real or hermitian, positive deﬁnite, inner

in the following sense.

product space V . Choose d

R+. We deﬁne,

∈

and we note that for a scalar α, we may deﬁne αX =

αx

x

X

and then,

θ(X; d) =

qkxk2/d,

Xx∈X

{
2 d) = θ(X; d).

|

∈

}

θ(αX;

α

|

|

When X is a coset v + Λ of a lattice Λ in V , we shall call the function θ(X; d) a coset
theta function. If Λ′ is a lattice in another space V ′, and if v′
Λ′
V ′, and that (v + Λ)
is a lattice in V

∈
(v′ + Λ′) = (v, v′) + Λ

×
Λ′. We then get,

V ′, we ﬁnd that Λ

⊕

θ((v, v′) + Λ

×

×
Λ′; d) = θ(v + Λ; d)θ(v′ + Λ′; d).

From (2.2), (2.10) and (2.11), we see that,

×

r
2k

θr,k = θ(

+ Z;

) = θ(

+ √kZ; 1),

r
2√k

1
k

3

(2.5)

(2.6)

(2.7)

(2.8)

(2.9)

(2.10)

(2.11)

(2.12)

i.e. the generalised theta function θr,k is a theta function for the coset X = r
the lattice Z in V = R. Then we ﬁnd, identifying R

R with R

iR = C,

2k + Z of

θr,kθs,ℓ

(2.12)
= θ((r/2√k)
(2.11)
= θ((rλℓ0 ±
def= θ(α + J; d)

⊕
i(s/2√ℓ) + (√kZ + i√ℓZ); 1)

⊕

±
sµ√D) + 2hλℓ0µ

µk0, λ√D

h

igp; 4kℓℓ0/h)

where k, ℓ
∈
square free as is D =
in R is a theta function for the coset X = v + Λ def= α + J of a lattice

N, h = hcf (k, ℓ), ¯k = k/h = µ2k0 and ¯ℓ = ℓ/h = λ2ℓ0 with k0 and ℓ0
k0ℓ0. So the product of two generalised theta functions θr,kθs,ℓ

−

(2.13)

(2.14)

with

and

J = 2hλℓ0µ

µk0, λ√D

h

igp

|

µk0, λ√D

h

igp =

{

µk0n + λ√Dm

n, m

Z
}

∈

α = rλℓ0 ±

sµ√D.

The next step is to rewrite this coset theta function in terms of a ray class theta
function in imaginary quadratic ﬁelds.
In order to do so, we introduce in the next
section the relevant deﬁnitions and properties of imaginary quadratic ﬁelds.

3 From coset to ray class theta functions

Let K and K0 be two ﬁelds and K
K0. Then K is called an extension ﬁeld of K0.
The degree of the extension, noted [K : K0], is the dimension of K as a vector space
over K0. In particular, if [K : K0] = 2, the extension is a quadratic extension. In this
paper, we work mainly with imaginary quadratic extensions of Q and we introduce the
basic deﬁnitions and concepts as applied to them.

⊃

3.1 Ideals and prime factorization in imaginary quadratic

ﬁelds.

Let D be a negative integer with no square factor other than 1, and put

K = Q[√D] =

a + b√D

a, b

|
an imaginary quadratic extension of Q. We deﬁne
integers in K. This means that if D

O
2 or 3(mod4),

{

Q

,

}

∈

K to be the ring of all algebraic

K = Z[√D] =

a + b√D

a, b

=

1, √D

Z
}

∈

h

igp,

|

O

(3.1)

≡

{

4

and if D

1(mod4),

≡

K = Z

1

2(1 + √D)

=

1, 1

2(1 + √D)

.

gp

O

i
It is easy to see that every number in K is the ratio of two algebraic integers. A unit
of
K is
O
denoted

O
×. We note in passing,

K whose reciprocal lies in

K. The group of units of

K is an element of

O

O

K

D

E

h

Proposition 3.1 The units of
if D =

1, the 6th roots of unity if D =

O

K are those roots of unity which lie in K, vis.

3 and

1
{±

−
K generated by α1, ..., αn ∈
O

}

otherwise.

K is the set of

K-linear

O

1,

i
}
±

{±

A fractional ideal I of

combinations of the generators αi:

O

−

I = (α1, ..., αn)OK

γiαi |

γi ∈ O

K

.

}

def=

n

{

Xi=1

In other words, I is a lattice spanning K which is closed under multiplication by
0
elements of
is called a principal ideal. Note that

K. A fractional ideal (α)OK = α

K, generated by a single α

\ {

K

O

O

∈

}

α

K = β

O

K

O

⇐⇒

α/β

∈ O

×.

K

(3.2)

(K) for the set of all fractional ideals of

(K) for the subset of
(K) is an abelian group under ideal multiplication, whose

K and

O

P

We write
those which are principal.
neutral element is

K,

I

I

O

I.J = (α1, ...αn)OK.(β1, ..., βm)OK =

n

m

{

Xi=1

Xj=1

γijαiβj |

γij ∈ O

K

.

}

C

∈ I

In particular, α
group,

O

(K), is deﬁned to be the quotient group of

(K) by

O

O

P

K.β

K = αβ

K, so

(K) is a subgroup of

(K). The ideal class

I

I
(K).

P

If I

(K) is a subset of

prime ideal of
O
from
K. (Technically,
Every fractional ideal I
powers of prime ideals Qi,

O

{
}
∈ I

O

K, then I is said to be an integral ideal of

K. By a
K we shall mean an integral ideal which is contained in no other apart
is also a prime ideal of
K but we shall ignore this fact.)
(K) may be uniquely factorized as a product of integer

O

O

0

I =

vQi (I)
Q
i

.

m

Yi=1

The integer vQi(I) is called the valuation of I at the prime ideal Qi. Thus, only ﬁnitely
(K) is integral
many of the valuations vQ(I) are non-zero. As one might expect, I
(K), we say that I divides J
if and only if vQ(I)
(we write I

∈ I
J) if JI −1 is an integral ideal. It follows that

0 for all prime ideals Q. If I, J

∈ I

≥

|

vQ(I)

vQ(J)

Q

≤

∀

⇐⇒

I

J

|

I

J.

⇐⇒

⊃

5

Therefore the least common multiple of a pair of ideals I and J is the largest ideal
contained in them both and their highest common factor is the smallest lattice which
contains them both. Thus

I is said to be coprime to J if their hcf is

lcm(I, J) = I

J and hcf(I, J) = I + J =

a + b

a

I, b

∩

{
K. Note that in this case

∈

|

O

J

.

}

∈

I

J = lcm(I, J) = IJ.

∩

(3.3)

we deﬁne its norm

N
K/I. The norm of a principal ideal α

A useful parameter of integral ideals is the norm. If I is an integral ideal of

α
O
|
O
any fractional ideal J is a quotient II ′−1 of integral ideals, we may deﬁne

K,
(I) to be the (ﬁnite) number of elements in the quotient group
2. Since
(J) =
(I ′). This deﬁnition is unambiguous since, in fact, the norm is multiplicative:

K is easily found since

K) =

|
N

(I)/

(α

N

O

O

N

N

(IJ) =

(I)

(J).

(3.4)

N
From this we see, also, that the norm of an integral ideal gives a clue as to its prime
factors since (in a quadratic ﬁeld) the norms of these must be p or p2 for some prime
number p.

N

N

Indeed, all prime ideals of K occur as prime factors of p

K for some prime number
K is itself prime or there is such an ideal,

O

p. Either there is no ideal of norm p and p
Pp. In this case,

O
K = Pp ¯Pp,
(3.5)
and there are exactly one or two ideals of norm p according as Pp = ¯Pp or not. In the
K of norm p (if there is one). We
rest of this paper Pp will stand for a prime ideal of
will make no explicit choice unless this is necessary.

O

O

p

of solutions to the congruence x2

If p is an odd prime integer, then the number of ideals of norm p in

K is the number
= 0 or
1 is the quadratic residue symbol, cf. subsection 4.1). (In all the cases that we will

D mod p. (That is, 1 +

O
where

D
p

D
p

≡

(cid:16)

(cid:17)

(cid:17)

(cid:16)

±
examine there will be just one ideal of norm 2.)

3.2 Ray class groups

Ray class theta functions are based on ray classes which we now introduce. These
classify ideals in a way which generalises the classiﬁcation, modulo n, of integers prime
to n. For ideals of K, the modulus n is replaced by an integral ideal F , called the
IF (K) of quotients of those ideals which are
conductor, and we work in the subgroup
prime to F , that is,

IF (K) =

I

(K)

vP (I) = 0 if P

F

.

|
We identify a subgroup K1,F of K× of elements which are, in some sense, 1 modulo F .
K which are congruent mod F and coprime to F .
These are quotients of elements of
Thus,

∈ I

O

}

{

|

K1,F =

λ/µ

λ

µ

F, µ

K + F =

K, λµ

= 0

.

{

|

−

∈

O

O

}

(3.6)

6

6
PF (K) =
We put
K
F is the quotient group,

O

α

{

α

K1,F }

∈

|

. Then the ray class group of

K with conductor

O

CF (K) = IF (K)
PF (K)

.

Each element of

The ray class group is, in fact, a ﬁnite group. Note that,
PF (K), for some I
CF (K) is a coset I
CP F (K), the subgroup of
We shall work, in particular, with

(K).
∈ IF (K). We denote this
coset more compactly as [I]F . We refer to it as the ray class of I with conductor F .
CF (K) of ray classes
of principal ideals. We shall shorten our notation of such classes by writing [γ]F for
CF (K) to
[γ
K]F . Clearly,
O
(K) given by [I]F 7→
[I]OK. This homomorphism is, in fact, surjective and so we have
C
a short exact sequence of groups,

CP F (K) is the kernel of the group homomorphism from

COK(K) =

C

0

→ CP F (K)

→ CF (K)

redF

OK
→ C

(K)

0.

→

(3.7)

We conclude with two useful lemmas (with F integral, as above).

Lemma 3.2 Let H
(ii) If, further, β
(iii) Conversely, if α and β

(K). (i) If α
∈ I
α
−

∈

F H then β/α

O

H and β/α

∈

∈
Proof: (i) hcf(αH −1, F ) = αH −1 + F = (α

∈

K + F H = H then αH −1

K1,F and so [βH −1]F = [αH −1]F .

∈ IF (K).
F H.

K1,F then β

α

−

∈

K + F H)H −1 =

O

K.

O

(ii) Since

(K) is ﬁnite, H n = γ

Put λ = βαn−1/γ and µ = αn/γ. Since α

C

K for some positive integer n and γ
H and β

∈
α modulo F H, we have

K.

O

Moreover, µ

K + F = (αH −1)n + F =

∈

≡

λ

≡

βαn−1/γ

αn/γ

µ modulo F H n/γ = F.

≡

−

≡
K. So β/α = λ/µ

K1,F .

∈
K + F =

O

O

K, where λ

µ

F and µ

K. Whence, by (3.3),

O

(iii) Now β = α(λ/µ)
F = µF .
µ
α

K
∩
But β

O

O

−
β

∈
α

−

∈

∩

H and also β

α = (λ

µ)α/µ

F H(1/µ). So

−

H

F H(1/µ) = (1/µ)H(µ

F ) = (1/µ)H(µF ) = F H.

∈

K

O

∩

(i) αi/αj = (αiH −1)(αjH −1)−1

Lemma 3.3 Suppose that α1, α2, α3 and α4 ∈
And if α1α2 ≡

α3α4 modulo F H 2 then

∈ IF (K).

(ii) [α1/α4]F = [α3/α2]F .

K

F H and αiO

\

K + F H = H. Then

Proof: (i) is clear from Lemma 3.2(i). From Lemma 3.2(ii) — with H 2 instead of

H —

and (ii) follows from this.

[α1α2H −2]F = [α3α4H −2]F

O

∈

−

7

3.3 The ray class theta function.

For any ray class x in the ray class group
R+ as follows,
of x with scale factor d

CF (K), we deﬁne the ray class theta function

∈

θ(x; d) =

qN (I)/d.

XI∈x,I⊂OK

(I) is the norm of I (see (3.4)). More generally, if W =

Here
formal complex linear combination of ray classes, we write,

N

x∈CF (K) nxx is a

P

θ(W ; d) =

nxθ(x; d).

(3.8)

Xx∈CF (K)

Also, abusively, if X and Y are subsets of
the sums of their elements so that, for instance,

CF (K), we can regard them as standing for

θ(X

Y ; d) =

θ(x; d)

θ(y; d).

−

Xx∈X

−

Xy∈Y

Now the quadratic ﬁeld coset theta functions as in (2.13) can be rewritten as ray
class theta functions in the following way. (We do not tackle here the most general
cases as we assume that the lattice J of (2.14) is an ideal of
K. In the general case
the coset must ﬁrst be split up as a union of cosets of ideals (c.f. 5.19) and a sum of
ray class theta functions will be obtained.)

O

∈ I

∈

\

Let J

(K) and α

K

J. Put H = hcf(α

K, J) = α

K + J and F = JH −1,

an integral ideal of

K. Thus, by Lemma 3.2(i), [αH −1]F ∈ CF (K)
O
K which are 1 modulo F and let wF be
its order. We have the following relation between coset and ray class theta functions,

×)F be the group of those units of

Let (

O

O

K

O

O

Theorem 3.4 With α, J, F , and H as above.

θ(α + J; d) = wF θ([αH −1]F ; d/

(H)),

N

(3.9)

Proof: Put Y for the set of all integral ideals in [αH −1]F .
The proof of the theorem is eﬀected by the following lemma which sets up a wF
to 1 correspondence between the terms in the two theta sums and in which, since

(βH −1) =

β

2/

(H), the powers of q are scaled by 1/

(H).

|
N
Lemma 3.5 The map f : α+J

N

|

→
Proof: By Lemma 3.2(ii), if β

H. So f (β)
Let I
IH = β

O
Now α

K. Thus f (β)

⊂ O
∈
Y . Then I(αH −1)−1

∈
K with β = αδ.
H and β

IH

Y deﬁned by f (β) = βH −1 is wF to 1 and surjective.

∈

α + J then f (β)
∈
Y and f is well-deﬁned.
∈ PF (K). So, IHα−1 = δ
H. So, by Lemma 3.2(iii), β

O

[αH −1]F . But β

α

K + J =

∈

O

∈

K, where δ

K1,F . Thus

α + F H = α + J. Of

N

∈
⊂
course, f (β) = βH −1 = IHH −1 = I. Therefore f is surjective.

∈

∈

8

To complete the proof we show that

f −1(I) = β(

K

×)F .

Suppose ω
∈
Moreover, by (3.2), f (ωβ) = f (β) = I. Thus f −1(I) contains β(

1+F and so, since βF

×)F . Then ω

O

⊂

∈

K

(

HF = J, βω

∈
×)F .
f −1(I) then, certainly, β′

O

K

We must show the reverse inclusion. If β′

by (3.2), β′ = ωβ with ω
Thus, applying Lemma 3.2(iii) with H =
as required.

∈ O

K

×. But, by Lemma 3.2(ii) with β′ = α, ω = β′/β
β(

1 modulo F . Thus β′

K, ω

O

≡

β+J = α+J.

K = β

O

K so,
K1,F .
×)F ,
K

O
∈
O

∈

O

∈

3.4 An example of reduction to ray classes

As an illustration of use of the above identity and of (2.13), and as a ﬁrst step in
proving the identities (2.4), we reduce a generic theta product occurring in the L.H.S.
of (2.4) to a coset theta functions and then (in the main case) to a ray class theta
function.

First, by (2.13),

θ(1+6a),6θs(1+6b),12 = θ(αs(a, b) + J; d)

(3.10)

−

≡

2) α

where (since, taking k = 6 and ℓ = 12 we have h = (6, 12) = 6, λ = µ = k0 = 1 and
D =

1, √D
We note that for a, b taking the values 0 or 1, and for s = 1,

αs(a, b) = 2(1 + 6a) + s(1 + 6b)√D, J = 24

5, the L.H.S. of
(3.10) gives all the terms in the three products V (1, 2)V (4
3i, 3), i = 1, 2, 3, which
are the left hand sides of (2.4). We recall that generalised theta functions satisfy the
following relations,

and d = 96.
2,

i
−

−

−

h

θℓ,k = θ−ℓ,k = θℓ+2k,k.
So we work in the imaginary quadratic ﬁeld K = Q(√
ρ = √
−
K = P 2
factorisations 2
norms 2 and 3, respectively. So J = P 6

2. Then, from (3.1),
2 and 3

and J = 24
K =
O
K = P3 ¯P3, where P2 = ρ
O

1, ρ
h
i
2 P3 ¯P3.

O
O

O

−

2) and we introduce the notation
K. We ﬁnd (see 3.5) prime
K and P3 = (1 + ρ)OK with

In order to apply (3.9), we ﬁrst need to determine the ideal H, which is the hcf of
1 mod 3 and assume
K

J and the principal ideal generated by αs(a, b). Suppose that s
for the moment that s is odd (so s
and 2 + ρ = ρ(1

1 mod 6). Then α = 2 + ρ + 6β for some β

ρ). So

∈ O

≡

≡

−

α

K = P2 ¯P3(1

ρ(1 + ρ)β)OK,

−
where the last ideal is clearly not contained in P2 or P3. Thus H = P2 ¯P3 and, using
(3.4), the norm of H is,

O

The conductor (i.e. F of (3.9)) is

(H) =

(P2)

N

N

N

( ¯P3) = 2

3 = 6.

×

JH −1 = P 6

2 P3 ¯P3(P2 ¯P3)−1 = P 5

2 P3 = 4P2P3.

9

Thus, by (3.9), the coset theta function (3.10) reduces, for s
class theta function,

≡

1 mod 6, to the ray

θ(1+6a),6θs(1+6b),12 = θ

αs(a, b)
ρ(1

−

 "

ρ) #4P2P3

; 16

.

!

3.5 Description of principal ray classes and change of con-

ductor.

Let K and F be again as in subsection 3.3. A standard result (though not diﬃcult to
prove) is the following description of the units of the quotient ring

K/F :

O

K/F )× =

α + F

α

K + F =

K

.

(

O

|

{
}
K) with (3.2), one can obtain the following exact

O

O

Combining Lemma 3.2 (with H =
sequence describing

O

CP F (K),
(

K

0

O
Here the ﬁrst map is inclusion, the second takes u to u + F and πF takes α + F to [α]F .

→

→

→

O

×)F → O

×

K

(

K/F )× πF

→ CP F (K)

0

(3.11)

In our analysis of section 5, we will need to relate ray class groups corresponding to
F . This relation is provided by the reduction

two conductors ˜F and F such that ˜F
map,

|

redF

˜F :

CF (K)

˜F (K) : [I]F →

→ C

[I] ˜F .

(3.12)

This is, in fact, a surjective group homomorphism of which the projection of (3.7) is a
special case.

Comparing (3.7) for F and ˜F it is easy to see that the kernel of the reduction map
˜F of (3.12) lies in

redF

CP F (K). From (3.11) it now follows that
(

K/F )×

α + F

α

1 mod ˜F

ker redF

˜F = πF {

∈

O

|

≡

.

}

If F = Q ˜F , and Q and ˜F have no common factors, one gets an isomorphism (the

Chinese Remainder Theorem),

(

K/F )×

(

K/Q)×

(

K/ ˜F )× : α + F

(α + Q, α + ˜F ).

O

O

O

→

×
CP F (K) and we
Clearly, isomorphisms of this sort are useful in the description of
generalise the compact notation introduced above for classes of principal ideals in the
following way. If γ + F is the pre-image of (α + Q, β + ˜F ), we write [α, β]F for [γ]F .
Note that for u

K)×,

→

(

(3.13)

∈

O

[α, β]F = [uα, uβ]F .

(3.14)

10

It is easy to see that the kernel of redF
if A

˜F (K), then

˜F is

[α, 1]F |

{

⊂ CP

α+Q

(

K/Q)×

. More generally,

∈

O

}

(redF

˜F )−1(A) =

[α, β]Q ˜F |

{

α + Q

(

K/Q)×, β + ˜F

∈

O

.

A
}

∈

(3.15)

If

(Q) = p then Z/pZ and

K/Q have the same number p of elements. In fact,

N
since Q ¯Q = p

K (see 3.5)), Z

O
Q = pZ and so the map,

O

∩

Z/pZ

K/Pp by n + pZ

n + Pp,

(3.16)

7→
is a ring isomorphism. Thus in this case the elements of
with n an integer mod p.

→ O

CP F (K) may be written [n, β]F

4 Relations between ray class theta functions of

diﬀerent quadratic ﬁelds

The identities (2.4) and (2.5) are a consequence of relations between ray class theta
functions of two diﬀerent imaginary quadratic ﬁelds. However, to describe these rela-
tions, which are stated in Theorem 4.3, we need to deﬁne ray class characters for these
two quadratic ﬁelds and their corresponding L-functions. We also use the theory of
Artin L-functions in a crucial step (Theorem (4.2)).

4.1 Ray class characters

→

CF (K)

Let χ :
C× be a multiplicative character of the ray class group with conductor
F . We deﬁne the conductor Fχ of the character χ to be the biggest of all ideals I
dividing F such that the kernel of χ contains the kernel of the reduction map (3.12)
CI (K). In fact, Fχ is the sum of all such ideals. Since the reduction
from
map is surjective, χ deﬁnes a character χFχ on

CF (K) to

CFχ(K) deﬁned by the equation,

Thus, for all I divisible by F χ, χ also deﬁnes a character χI of

CI (K) by,

χ([J]F ) = χF χ([J]F χ).

χI([J]I )=. χF χ([I]F χ).

Note that χI also has conductor F χ. We refer to the collection of all such characters
χI as “the ray class character χ for K”.

We are now in a position to specialise to the problem at hand. Let us introduce two
complex quadratic ﬁelds K = Q[√D] and K′ = Q[√D′] where D and D′ are negative,
square free integers. We shall also sometimes consider D′′ = DD′/(D, D′)2, which is
square free and positive, along with the quadratic ﬁeld K′′ = Q[√D′′] = Q[√DD′].
Here, (a, b) is the highest common factor of the pair of integers a, b.

11

The integer
not. The integers
f
K′ and K′′ over Q.)
f

D is deﬁned to be D or 4D according to whether 4 divides (D

1) or
D′′ are deﬁned similarly. (These are the discriminants of K,

D′ and

−

In order to deﬁne a particular ray class character ψ for K, we ﬁrst describe a
function φ, which is, eﬀectively, the Dirichlet character corresponding to the quadratic
ﬁeld K.

f

Let p be a prime number and m an integer not divisible by p. Then the quadratic
m has a

1 according to whether x2

is deﬁned to be 1 or

residue symbol,
solution modulo p or not.

(cid:16)

(cid:17)

m
p

≡

For positive integers n prime to 2D we deﬁne φ(n) =

1 by the following rules:

±

(i) φ(n) is the quadratic residue symbol

if n is prime.

−

D
n

(cid:16)

(cid:17)

(ii) φ(n) = φ(p1)φ(p2)...φ(pr) if the prime factorization of n is n = p1p2...pr.

(In fact φ(n) depends only on the residue of n modulo

D).

The function φ′ is deﬁned similarly to φ (using D′ instead of D).

Let F = 2DD′

K. We deﬁne the character ψF on

O

f

CF (K) by

ψF ([I]F ) def= φ′(

(I)),

N

where I is integral and
(I) is the norm of the ideal I — deﬁned in the previous section
before (3.4). Hence we obtain a ray class character ψ for K. (This is the character
corresponding the ﬁeld extension KK′ of K.) The conductor of this character is (as
shown in [5])

N

where a = 1 if all of
f
ψ′ for K′ is deﬁned similarly, and its conductor is,
f

D,

D′ and

f

f

f

f

D′′ are even. Otherwise a = 0. The ray class character

Fψ = 2a

D′/(

D,

D′),

Fψ′ = 2a

D/(

D′,

D).

(4.1)

(4.2)

4.2 Galois groups and norm maps

f

f

f

We ﬁrst identify the elements of the Galois group of the ﬁeld KK′ over Q. In general, if
L is a ﬁeld extension of the ﬁeld L0, the group of automorphisms of L which leaves every
element of L0 ﬁxed is called the Galois group of L over L0, and is denoted Gal(L/L0).
Its order is at most the degree of the extension. In particular, the biquadratic extension
KK′ =
has Galois group Gal(KK′/Q) =
a, b, c, d
1, δ, δ′, γ

a + b√D + c√D′ + d√D√D′

, where

∈

Q

{

}

|

{

}

δ :

√D
√D′

(cid:26)

√D
√D′ ,

7→
7→ −

δ′ :

√D
√D′

(cid:26)

√D
√D′

7→ −
7→

and γ = δδ′.

12

Thus γ acts as complex conjugation on both K and K′ and thus gives the non-trivial
element of the Galois group of either ﬁeld over Q. In what follows we shall use expo-
nential notation for the action of Galois elements. Thus xδ means x is acted on by δ
and x1−γ = x(xγ)−1.

Secondly, if L

L0 is an extension of algebraic number ﬁelds, then there exist norm
⊃
L/L0, from the group of units of L to the group
homomorphisms, both denoted by
of units of L0, and from the group of fractional ideals of L to the group of fractional
ideals of L0. Thus,

N

L/L0 :
L/L0 :

N
N

L×
(L)

I

L0×
(L0)

: λ
: I

→
→ I

L/L0(λ),
L/L0(I).

7→ N
7→ N

These norms are related by the fact that they ‘agree’ on elements λ of L. That is,

Moreover, if I

(L), one has,

∈ I

L/L0(λ

L) =

L/L0(λ)

L0.

O

N

O

N

If the extension L over L0 is quadratic with Gal(L/L0) =

1, σ

, then, for λ

{

}

L×,

∈

and for I

(L), we have

∈ I

N
This equation determines the norm map on ideals since the map,

O

(L0)

I

→ I

(L) : J

J

L,

O

7→

is injective. In particular, if L = KK′ and L0 = K, one has that, for I
J

(K),

∈ I

(KK′) and

∈ I

KK′/K(I)

KK′ = I 1+δ

and

N

O

(J)

K = JJ .

N

O

Finally, choose a fractional ideal F in

(K) which is contained in the conductor Fψ

(4.1), and which is self-conjugate, i.e.,

I

F

(K), F

∈ I

Fψ

⊂

and F γ (= F ) = F.

We deﬁne a subgroup AF and a coset SF in the ray class group

AF

def= ker(ψF )1−γ =

For F ′

Fψ′ we deﬁne A′
Note that if ψF ([I]F ) =
−
contained in F , we ﬁnd that,

⊂

{

[I/I −1]F |
F ′ and S′
F ′

ψF ([I]F ) = 1

, SF

}
⊂ CF ′(K′), similarly.

CF (K) by,

def=

[II −1]F |

{

ψF ([I]F ) =

.
1
}
−
(4.3)

1 then SF = (I/I)AF . Also if F1 is a self-conjugate ideal

AF = redF1

F (AF1) and SF = redF1

F (SF1).

(4.4)

(I)Z =

L/Q(I).

N

N

L/L0(λ) = λ1+σ

N

L/L0(I)

L = I 1+σ.

13

4.3 The three crucial theorems

To provide a link between the arithmetic of K and that of K′ we need to give a
correspondence between conductors in

K and in

K′.

O

O

N

Deﬁnition 4.1 We say that a pair (F, F ′) of self-conjugate ideals, F
(F ′) ˜D′.
Fψ, F ′
F ′

(K′) is admissible if F

(F ) ˜D =

F ′

ψ′ and

(K) and

∈ I

⊂

⊂

N

∈ I

In this subsection we present our main theorem for producing identities, Theorem
4.3, which is a practical theorem relating ray class theta functions of diﬀerent quadratic
ﬁelds. Given an admissible pair (F, F ′), the theorem describes coincidences between
certain combinations of ray class theta functions of K with conductor F and similar
combinations of ray class theta functions of K′ with conductor F ′.

acters for the ray class groups
then give a crucial relation between them in Theorem (4.2).

The origin of these coincidences can be described in terms of L-functions of char-
CF ′(K′). We ﬁrst deﬁne such L-functions,
Given the deﬁnition (3.8) of theta functions for a formal complex linear combination
of ray classes θ(W ; d), one obtains the corresponding L-function L(W ) by using the
modiﬁed Mellin transform, Md, which sends qt to (td)−s,

CF (K) and

Md(θ(W ; d)) = L(W ) =

nxL(x),

(4.5)

Xx∈X

where L(x) =

I∈x,I⊆OK N

(I)−s.

Now, if χ is a ray class character of K with conductor Fχ dividing F , we may deﬁne

P

the L-function of the ray class character χ with conductor F as follows,

LF (χ) def=

χ(x)L(x) =

Xx∈CF (K)

XI∈IF (K),I⊆OK

χ([I]F )

(I)−s.

N

We put L(χ) = LFχ(χ). We now have,

Theorem 4.2 Let (F, F ′) be an admissible pair and let χ and χ′ be characters of
CF (K) and

CF ′(K′) such that

(i) χ is 1 on AF and
−
(ii) For all I
Then LF (χ) = LF ′(χ′).

∈ IF F ′OKK′ (KK′), χ([
N

1 on SF .

KK′/K(I)]F ) = χ′([

KK′/K′(I)]F ′).

N

The proof relies on the theory of Artin L-functions. In fact, for a suitable extension
N of KK′, the characters χ and χ′ deﬁne, under the Artin correspondence of class ﬁeld
theory, characters χgal of ∆ = Gal(N/K) and χ′
gal of ∆′ = Gal(N/K′). Now the Artin
L-functions of χgal and χ′

gal are, by deﬁnition, the L-functions of χ and χ′,

L(χgal) = L(χ),

L(χ′

gal) = L(χ′).

14

One proves [5] that, under the conditions of the theorem, χgal and χ′
character of Γ = Gal(N/Q),

gal induce the same

χgal↑Γ

∆

= χ′

.

gal↑Γ
∆′

Since their Artin L-functions coincide with that of the induced character, one must
have,

L(χ) = L(χgal) = L(χ′

gal) = L(χ′).

(4.6)

The result follows.

We are now ready to state the main theorem of this paper.

It is obtained by
summing (multiplied by suitable roots of unity) all the instances of (4.6) for a given
admissible pair of conductors (a sort of ﬁnite Fourier inversion) and applying the inverse
of the Mellin transform given in (4.5).

Theorem 4.3 Let (F, F ′) be admissible and let I be an integral ideal of
no common factor with F F ′
KK′. Put J =

KK′/K(I) and J ′ =

KK′ having
KK′/K′(I). Then

O

θ(AF [J]F ; d)

−

N
O
θ(SF [J]F ; d) = θ(A′

F ′[J ′]F ′; d)

−

N
F ′[J ′]F ′; d),

θ(S′

(4.7)

for d

R.

∈

Unfortunately, as will be exempliﬁed in the next section when we discuss the ﬁrst
set of Virasoro character identities (2.4), coset theta functions may give rise, by ap-
plication of (3.9), to theta functions of ray classes with respect to non-self-conjugate
conductors. The following theorem describes situations where such theta functions
may be replaced by theta functions of ray classes with self-conjugate conductors. It
relies on the cancellation available from the relationship (for self-conjugate F )

L([ I ]F ) = L([I]F ).

Theorem 4.4 Let F , P and J be (integral) ideals of
conjugate, that P is maximal and prime to F and that J is prime to P F .

K. Suppose that F is self

Let B be a subgroup of

coset B[P/P ]F and put ˜B and ˜T for the inverse images of B and T in

F and [J/J]F . Put T for the

CF P (K).

O
CF (K) containing both [P/P ]2

Then

θ( ˜B[J]F P ; d)

θ( ˜T [J]F P ; d) = θ(B[J]F ; d)

θ(T [J]F ; d).

(4.8)

−

−

We shall apply this result in cases where B = AF and T = SF . We note that in
this case, the conditions of the second paragraph of the above theorem hold, provided
F , ψ(J) = 1 and ψ(P ) =
fψ |
The proofs of the above theorems (or rather the corresponding theorems for L-
functions) may be found in [5]. We now use them to prove the Virasoro identities (2.4,
2.5), but also to uncover a whole family of identities between Virasoro characters at
higher levels, of which the identities (2.4) are the simplest example.

−

1.

15

5 Virasoro identities

In the next three subsections, we use the algebraic tools developed in this paper to
prove the identities (2.4). We ﬁrst show in subsection 5.1. how to relate ray class
theta functions associated with the two relevant quadratic ﬁelds K = Q[√
2] and
K′ = Q[√
1] using Theorem 4.3. We then rewrite the identities as in (2.6). To make
contact with Theorem 4.3, we express the left hand side (resp. the right hand side ) of
CF ′(K′)) for
(2.6) in terms of diﬀerences of ray class theta functions for
self-conjugate conductors F (resp. F ′). This is carried out in detail in subsections 5.2.
and 5.3.

CF (K) (resp.

−

−

Remarkably, the three distinct diﬀerences of ray class theta functions appearing in
the RHS of (2.6) are obtained each time one considers quadratic expressions in Virasoro
unitary minimal characters at level m = 4a2 for a odd and 1 + 4a2 = a′2p with p prime,
in a way described in Theorem (5.1), subsection 5.3. This does then provide an inﬁnite
class of new identities between the Virasoro characters at level m = 3 and Virasoro
characters at level m = 36, 100, 196, . . . We also remark (5.23) how the LHS of these
identities may be rewritten as sums of Virasoro characters at any of an inﬁnite series
of higher levels m = 675, 131043, . . .

The subsection 5.4. gives a somewhat terser account of how to prove the second
30] and

set of identities (2.5). There, the two relevant quadratic ﬁelds are K = Q[√
K′ = Q[√

10].

−

We recall (see Section 3) that in what follows, Pp (resp. P ′

p) stands for a maximal

ideal of

K (resp. of

K′) of norm p when p is prime.

−

O

O

5.1 Relations between ray class theta functions

As already remarked at the end of Section 3, the expression on the left hand side of
the identities (2.6) is associated with the quadratic ﬁeld Q[√D] with D =
2, while
the right hand side is associated with the quadratic ﬁeld Q[√D′] with D′ =
1. So, in
the notations adopted in this paper, one has K = Q[ρ] with ρ = √
1, ρ
igp,
K′ × =
and the units of
i
.
}
±

1,
Consider the two ray class characters ψ and ψ′ deﬁned in subsection 4.1. Their
D′′ = 8,

{±
conductors are given by the expressions (4.1,4.2) with ˜D =
so a = 1). Thus,

−
−
2,
K =
−
O
1, i
igp and

. Also, K′ = Q[i],

8, ˜D′ =

1
{±

4 (and

K are

K′ =

× =

h
O

O

O

O

−

−

K

}

h

g

Fψ =

Fψ′ =

2[8,4]
8

2[4,8]
4

(cid:16)

OK

(cid:17)

OK′

= (2)OK

= (4)OK′ .

(cid:17)
(Note that, especially in subscripts, we shall write principal ideals (α) instead of α
or α

K′).

(cid:16)

K

O

K′ are principal ideal domains, i.e. all their ideals are principal, so
that, using (3.11), we can easily identify the ray class groups of K and K′ associated

K and

O

O

O
Both

16

(5.1)

(5.2)

with the above conductors,

C(2)(K) =

CFψ (K) =

CFψ′ (K′) =

CP (2)(K)
(
O
≃
Both groups are of order 2, and so ψ and ψ′ are the only non trivial (1-dimensional)
characters of

[1 + ρ](2)igp
h
i
h
}
±

[1 + 2i](4)igp.

K/(2))× =
1,

C(4)(K′) =

CP (4)(K′)

≃
O
K′/(4))×/

{±

=

(

CFψ (K) and

CFψ′ (K′). We thus have,
ψ([α](2)) = 1

if α

1 mod (2)

≡

otherwise

=

1
−

ψ′([α](4)) = 1 if α
=

1 or
≡ ±
otherwise.

±

i mod (4)

1
−

The next step is to calculate the A’s and S’s of (4.3) for the admissible pairs of
ideals (F, F ′) (see Deﬁnition 4.1) that we shall be using. Put P2 = (ρ)OK as before and
K′ (noting that P ′
P ′
2 = (1 + i)OK′ , the prime ideal of norm 2 in
K′). Then
2
(4P2, (8)OK′ ) and ((4)OK, 4P ′
2) are admissible pairs for K and K′. We concentrate on
the ﬁrst pair as the data for the second pair will come easily by (4.4). By (5.1),

2 = 2

O

O

ker ψ4P2 =

∈ O
Thus, in this case, the A-group is trivial,

{

[1 + 2α]4P2 |

α

K

}

=

[1 + 2a + 2bρ]4P2 |

{

a, b

.

Z
}

∈

A4P2 = (ker ψ4P2)1−γ =

[1]4P2}

,

{

(5.3)

since 1 + 2a + 2bρ = 1 + 2a
1 + 2a + 2bρ mod 4P2 (= (4ρ)) (and γ acts as
conjugation). In order to obtain the coset S4P2 (Deﬁnition (4.3)), we must choose an
ideal I in
1. We take I = (1 + ρ)OK. Then we ﬁnd that
S4P2 consists of the class

≡
I4P2(K) such that ψ [I]4P2 =

2bρ

−

−

[I/ ¯I]4P2 = [(1 + ρ)(1

ρ)−1]4P2 = [3(

1 + 2ρ)/9]4P2 = [

3 + 2ρ]4P2 = [5

2ρ]4P2. (5.4)

We also need A′

−

−
(8) and its coset S′
(8) for K′. Note that now,

−

±

ker ψ′

(8) =

[1 + 4α](8) |

{

α

K′

∈ O

}

=

[1 + 4a + 4bi](8) |

{

a, b

,

Z
}

∈

and so

A′

(8) = ker ψ′

(8))1−γ =

[1](8)}

,

{

since, modulo (8), 1 + 4a + 4bi
(1 + 2i)OK′ , ψ′[I](8) =

≡

1, and so we ﬁnd that S′

(8) consists of the class

1 + 4a

4bi = 1 + 4a + 4bi. Moreover, with I =

[I/ ¯I](8) = [(1 + 2i)(1

2i)−1](8) = [5(1 + 2i)2/25](8) = [

1 + 4i](8) = [1 + 4i](8). (5.7)

−

−

−

(5.5)

(5.6)

−

17

For the second pair of conductors we ﬁnd that the ideal (4)OK divides the ideal
2 divides (8)OK′ . So we can obtain the new A’s and S’s by reduction using

4P2, and 4P ′
(4.4)

A(4) =

[1](4)}
{
2)1−γ =
{
Now take I, F and F ′ in Theorem 4.3 to be successively

and S(4) = [1 + 2ρ](4),
and S′

2 = (ker ψ′

[1]4P ′

2 = [5]4P ′

A′

4P ′

4P ′

4P ′

2}

2.
2 = [3]4P ′

(5.8)

(1

KK′,
ρ)OKK′ ,
KK′,

O
−
O

and 8
and 8

K′;
O
K′; and
O
4P ′
2.

K, and

4P2
4P2
4

O

This gives the following relations between ray class theta functions of the ﬁelds Q[ρ]
and Q[i],

θ([1 + 2ρ]4P2; 16)

θ([1]4P2; 16)

−

θ(S4P2; 16) = θ([1](8); 16)
θ([1 + 2ρ]4P2S4P2; 16) = θ([3](8); 16)
θ([1](4); 8)
2; 8)

θ(S(4); 8) = θ([1]4P ′

−

−

θ(S′
(8); 16)
θ([3](8)S′
θ(S′
2; 8).

4P ′

−
−
−

(8); 16)

(5.9)

Here, for the second line we have calculated the norms of (1

ρ) from KK′ to K

−

and from KK′ to K′ as follows

KK′/K(1
KK′/K′(1

N
N

−
−

ρ) = (1
ρ) = (1

−
−

ρ)2 =
−
ρ)(1 + ρ) = 3.

(1 + 2ρ),

5.2 Reduction of V products to ray class theta functions

We have shown at the end of section 3 how to rewrite a product of two generalised
theta functions as a ray class theta function, namely,

θ(1+6a),6θs(1+6b),12 = θ

(5.10)

αs(a, b)
ρ(1

−

ρ) #P3F

 "

; 16

,

!

with s
product V (1, 2)V (s, 3) as a linear combination of ray class theta functions,

1 mod 6 and F = 4P2. From (2.7) and the above relation, we obtain the V

≡

V (1, 2)V (s, 3) = (θ1,6 −

θ7,6)(θs,12 −

θ7s,12) = θ(W ; 16),

(5.11)

where

W = [βs]P3F (q(0, 0) + q(1, 1)

q(1, 0)

q(0, 1))

−

−

∈ CP3F (K),

(5.12)

with βs = αs(0, 0)/((1

ρ)ρ) and q(a, b) = [αs(a, b)/αs(0, 0)]P3F .
CP3F (K) =
explained after (3.13), following the decomposition

We express the elements [δ]P3F of

−

CP P3F (K) in the form [α, β]P3F as

K/P3F )×

(

O

∼= (

O

K/P3)×

(

K/F )×.

×

O

18

In order to apply Theorem 4.3 we shall combine the ray classes of (5.11) to make
classes with respect to the self-conjugate conductor F using Theorem 4.4. We take
by 5.3) and SF (=
P , B and T of that theorem to be, respectively, P3, AF (=
by 5.4). The choice of P = (1 + ρ) and T are consistent since from (5.1),
[5
1. We ﬁrst identify ˜B and ˜T and then compare them to the classes

[1]F }

−

{

2ρ]F }
{
ψ([1 + ρ]) =
q(a, b).

−

Theorem 4.4 are

We know that

(P3) = 3. So (
N
1, 1]P3F }
[
±
{
Now αs(1, 1) = 7αs(0, 0). So

O
and ˜B[5

−

K/P3)× =

1 + P3}

{±

2ρ]P3F , respectively.

and by, (3.15), ˜B and ˜T of

q(1, 1) = [7]P3F = [1,

1]P3F = [

1, 1]P3F ,

(5.13)

−

by (3.14). Also, 7αs(1, 0) = 98 + 7sρ

αs(0, 1) mod 24. So

αs(0, 1)/(ρ(1

ρ))

7αs(1, 0)/(ρ(1

ρ)) mod P3F

≡

−

≡

and hence

Again, αs(0, 0)(5

2ρ)

−

≡ · · · ≡

q(0, 1) = [7]P3F q(1, 0) = [1,

1]P3F q(1, 0).

−
αs(1, 0) mod 24. So, in the same way,

−

−

q(1, 0) = [5

2ρ]P3F q(0, 0).

−

Thus

q(0, 0), q(1, 1)
}

{

= ˜B and

q(1, 0), q(0, 1)
}

{

= ˜T

Putting this information into (5.12) we get, from 5.11,

V (1, 2)V (

s

, 3) = θ([βs]P3F ˜B; 16)

θ([βs]P3F ˜T ; 16) = θ([βs]F ; 16)

θ([βs]F SF ; 16)

−

−

(5.14)

by Theorem 4.4. Moreover, βs = 1 if s = 1 and βs = 1 + 2ρ if s = 5.

If s =

2 one can divide the coset in (3.10) by

ρ to get,

|

|

−

θ(1+6a),6θ2(1+6b),12 = θ(2(1 + 6b)

(1 + 6a)ρ + (J/P2); 8).

Here we have the same situation as before with snew = 1 except that the rˆooles of a
and b are reversed, the ray class conductor is 4P3 and the scale factor 8 instead of 16.
The same analysis goes through with F = 4

K and we obtain

V (1, 2)V (2, 3) = θ([1](4); 8)

θ(S(4); 8).

(5.15)

Thus we have shown that the left hand sides of the identities (2.6) may be rewritten
as the left hand sides of the identities (5.9). To complete our proof of (2.6) we shall,
in a similar manner, show that the right hand sides of (2.6), which may be described
by the V products

V (r, 4)V (rf, 4) + V (7r, 4)V (7rf, 4)

(5.16)

for (r, f ) = (1, 2), (3, 2) and (1,3), are equal to the right hand sides of the identities
(5.9).

−

O

−

−

19

5.3 An inﬁnite family of identities

In fact the expressions (5.16) are only the ﬁrst set of an inﬁnite family of quadratic
expressions in the V functions which reduce to the right hand sides of (5.9). We now
prove this reduction for the whole family and thus obtain (by 2.9) an inﬁnite family of
identities between Virasoro characters at level m = 3 and products of those at levels
m = 4a2 where a is odd and 1 + 4a2 = pa′2 with p prime.

Theorem 5.1 Let a, a′ and p be integers such that a
1 mod 4, p is prime and
4a2 + 1 = pa′2. Put m = 4a2 and c = aa′. Then, for r odd and prime to p and ǫ = 0
or 1,

≡

p−1
2

c−1

c−1

Xv=0

Xu=1

Xw=0
where ˆu = (u + 5p(1
6−ǫ, P ′
F ′ = P ′
2
(see 5.7 and 5.8).

V (cˆu(r+8vp), m)V (cˆu((2a

ǫp)r+8wp), m) = θ([r]F ′

[rδ]F ′, 24−ǫ), (5.17)

−

−

u)) and the ray classes on the right are deﬁned in K′ = Q[i] with
= S′
F ′

2 = (1 + i)OK′ (as in subsection 5.1) and δ = 1 + 4i so that

[δ]F ′

−

{

}

Actually, the theorem gives just three diﬀerent relations. These correspond to the
choices (r, ǫ) = (1, 0), (3, 0) and (1, 1) and have as right hand sides the three right hand
sides of (5.9). Moreover if we take a = 1 and p = 5, so m = 4, a′ = c = 1 and ˆ2 =
23
and put f =

= 2 or 3, then the LHS in Theorem 5.1 becomes,

2a

ǫp

−

|

−

|

V (r, 4)V (rf, 4) + V (23r, 4)V (23rf, 4).

Now we may make this expression more economical by replacing 23 by 7 (since 23
207
≡
we have,

7 modulo 2m(m + 1) = 40, 9 = 2m + 1 and V (r(2m + 1), m) =

9 =
V (r, m)). So

×

−

V (r, 4)V (rf, 4) + V (7r, 4)V (7rf, 4) = θ([r] ˜F ′; 24−ǫ)

θ([r] ˜F ′S′

˜F ′; 24−ǫ).

(5.18)

−

Taking (r, f ) = (1, 2), (3, 2) and (1, 3), and using (5.14), (5.15) and (5.9) we get the
identities (2.6).

Before we can prove Theorem 5.1, we need some preparation.
Suppose that Λ

Λ′ are lattices in the inner product space V . Then there is a
Λ (a transversal of Λ over Λ′) of the same size as the quotient group Λ/Λ′
subset T
such that (w + Λ′) and (w′ + Λ′) are disjoint for distinct w and w′ in T . Then, for any
v

V ,

⊃

⊂

v + Λ =

(v + w) + Λ′

∈

and so,

θ(v + Λ; d) =

θ((v + w) + Λ′; d).

(5.19)

[w∈T

Xw∈T

20

Lemma 5.2 Suppose that k = c2k′ with c and k′
common factor with c. Then

∈

N. Choose b

Z to have no

∈

θcb(r+2jk′),k = θbr,k′.

(5.20)

c−1

Xj=0

Proof: Now

Whereas

θcb(r+2jk′),k = θ

cb(r + 2jk′)
2k

 

+ Z;

= θ

1
k !

br
2k′ + bj

!

  

+ cZ;

1
k′ !

.

θbr,k′ = θ

 

1
k′ !

br
2k′ + Z;
0, b, . . . , (c

.

But since b is invertible mod c, the set
cZ. So the identity follows by (5.19). As an immediate consequence we have,

1)b
}

is a transversal for Z over

−

{

Corollary 5.3 If m(m + 1) = k above then

c−1

Xj=0

V (cb(r + 2jk′), m) = θbr,k′

θbr(2m+1),k′.

(5.21)

−

We remark, by the way, that taking m = 242, c = 99, k′ = 6 and b = r = 1 gives a

RHS in (5.21) of θ1,6 −

θ5,6 = η and we obtain,

χV ir(242)

99(1+12j),99(1+12j) = 1.

(5.22)

This is the ﬁrst in an inﬁnite series of such identities (though, presumably not the ﬁrst
with RHS 1). The next, however has m = 23762 and c = 109

89 = 9701.

×

Again, we may solve the Pellian equation

(2m + 1)2

48c2 = 1

(i.e. m(m + 1) = 12c2)

and choose one of the (inﬁnitely many) solutions such that 2m + 1
7 modulo 24.
(e.g. m = 675, c = 175; m = 131043, c = 37829.) In Lemma 5.2, we now have k′ = 12
θ7r,12 = V (r, 3) and we obtain, for instance,
and b = 1 gives a RHS in (5.21) of θr,12 −

≡

χV ir(675)
175(1+24j),175(1+24j) = χV ir(3)

r,r

.

(5.23)

This is the ﬁrst in an inﬁnite series of such identities which (taking r = 1,
rewrite the left hand sides of (2.4).

−

2 and

5)

−

98

Xj=0

−

174

Xj=0

21

Proof of Theorem 5.1 : Note the congruences 2a

2 mod 8 and p

5 mod 8

(so also 5p

1 mod 8). In particular, ˆu

≡

≡
u mod p and ˆu

1 mod 8.

≡

≡

≡

(i) We ﬁrst rewrite the left hand side of (5.17) as a sum of diﬀerences of coset theta
functions.

Now 2m + 1 = 2p(a′)2

2p

1 modulo 8p. So by (5.21), the uth term in the

outer summation on the LHS of (5.17) is

1

−

≡

−

LHS(u) = (θr ˆu,4p −

θr ˆu(2p−1),4p)(θ(2a−ǫp)r ˆu,4p −

θ(2a−ǫp)r ˆu(2p−1),4p).

Applying (2.13), (with k = l = h = 4p, λ = µ = k0 = ℓ0 = 1 and D =

1)

−

LHS(u) = θ(rˆuα1 + 8p

K′; 16p)

O
θ(rˆuα3 + 8p

O

θ(rˆuα2 + 8p
K′; 16p) + θ(rˆuα4 + 8p

O

−

K′; 16p)

K′; 16p),

(5.24)

O

where,

−

−
−

α1 = 1 + (2a
(2a
α2 = 1
−
α3 = (2p
1)
−
1)(1 + (2a
α4 = (2p

pǫ)i;
pǫ)(2p
(2a

−
−
−

1)i);

−
pǫ)i

(2p
−
pǫ)i) = (2p

≡

−

1)α2 mod 8p;

1)α1.

−

(Note that (2p

1)2

1 mod 8p.) Now ˆu is u mod p and 1 mod 8. So

u

p

u

≡ −

≡

−

u mod p

\p
−

≡

1

and therefore

ˆu(2p

1)

1(10

1)

−

≡

≡

u mod 8

\p
−

ˆu(2p

1)

u mod 8p.

\p
−

−
ˆu(2p

≡
1)

−

−

−

≡

≡

and

Thus

rˆuα4 ≡
Hence the LHS of (5.17) may be rearranged as

r(\p
−

u)α1

and rˆuα3 ≡

r(\p
−

u)α2.

p−1
2

Xu=1

p−1

Xu=1

LHS(u) =

(θ(rˆuα1 + 8p

K′; 16p)

θ(rˆuα2 + 8p

K′; 16p)) ,

(5.25)

O

−

O

since doubling the range of the sum exactly compensates for the elimination of the last
two terms of (5.24). We now prepare to express these coset theta functions as ray class
theta functions using (3.9) and to reduce the natural conductors using Theorem 4.4.
2ai)OK′ . So (cf. 3.5), P and P are

K′ = P P , where P = (1

We note ﬁrst that p

O
distinct prime ideals of norm p and by (3.16),

−

(

K′/P )× =

u + P

u

Z, 1

u

p

1

.

(5.26)

∈
We shall apply Theorem 4.4 with K, P , F , B and T of that theorem being re-
by 5.7). The

spectively K′, P , F ′ = (P ′

by 5.6) and S′

O

≤

≤

−

{

}

|

2)6−ǫ, A′

F ′ (=

F ′ (=

[1]F ′

[δ]F ′

{

}

{

}

22

choice of P and T are consistent since 1
ψ([P ]) =

1.

−

−

We express the elements of

following the decomposition

2ai

1

2i mod 4 and so, from (5.2),

≡

−

CP F ′(K′) in the form [α, β]P F ′ as explained after (3.13),

O
Then, by (3.15) and (5.26), ˜B of Theorem 4.4 is

O

×

O

(

K′/P F ′)×

K′/P )×

(

K′/F ′)×,

∼= (

˜B def=

redP F ′
F ′

−1

(cid:16)

(cid:17)

and ˜T = ˜B[δ′]P F ′, provided [δ′]F ′ = [δ]F ′.

(B) =

[u, 1]P F ′

1

u

p

1

}

−

≤

≤

=

[ˆu]P F ′

1

u

p

1

}

−

≤

≤

|

{

|

{

(ii) We examine ﬁrst the case when ǫ = 0. Then α1O
K′ prime
to 2P , the highest common factor H of (βα1)OK′ and (8p)OK′ = 8P P is P . Therefore,
using the relation (3.9) between coset and ray class theta functions for the ray class
group

K′ = P and so, for β

∈ O

CP F ′(K′), we get,

θ(βα2 + 8p

K′; 16p) = θ([β]P F ′; 16).

(5.27)

O
Now ˜T = ˜B[α2/α1]P F ′, since α2/α1 = 1
2ai)i is prime to P and congruent to δ
4(1
modulo 8. Thus, applying (5.27) to (5.25) (with β = rˆu or rˆuα2/α1) we ﬁnd that the
LHS of (5.17) is

−

−

p−1

Xu=1

(θ([rˆu]P F ′; 16)

θ([rˆuα2/α1]P F ′; 16)) = θ( ˜B[r]P F ′, 16)

θ( ˜T [r]P F ′, 16)

−

−

= θ([r]F −

[rδ]F ; 16),

(5.28)

by Theorem 4.4, as required.

(iii) Now consider the case when ǫ = 1.

For β

K′ prime to 2P , the highest common factor, H, of (β(1+2ai)(1+i))OK′ =

∈ O
βP P2 and (8p)OK′ = P ′
2

6P P is P P ′

2. Therefore, using (3.9) again, we get

θ(β(1 + 2ai)(1 + i) + 8p

K′; 16p) = θ([β]P F ′; 8),

(5.29)

Put βj = αj/((1 + 2ai)(1 + i)), for j = 1, 2. Then, since 2a

2 mod 8,

≡

(1 + i)β1 =

1 + 2ai

−
(1 + 2ai)

pi

= 1

(1

2ai)i

−

−

1
≡ −

−

i mod 8.

So β1 ≡ −
expression) β1 is prime to P . Thus ˜B[β1]P F ′ = ˜B.

1 modulo (8/(1 + i))OK′ = F ′ and so [β1]F ′ = [1]F ′ and (from the third

Again

(1 + i)β2 =

1 + 2ai

2p + 4a)

ip(1
−
−
(1 + 2ai)

= 1

i(1

2ai)(1

2p + 4a).

−

−

−

O

23

1

(i + 2)(1

2 + 4)

3(1 + i) modulo 8. So

So β2 is prime to P and (1 + i)β2 ≡
i)

(1

β2 ≡ −

−
3 =

−
(4 + i)

2
−
≡ −
iδ mod 4P ′
2.

−
Hence ˜B[β2]P F ′ = ˜T . Thus, applying (5.29) to (5.25) (with β = rˆuβ1 or rˆuβ2) we ﬁnd
that the LHS of (5.17) is

≡ −

−

−

(θ([rˆuβ1]P F ′; 8)

θ([rˆuβ2]P F ′; 8)) = θ( ˜B[r]P F ′, 8)

θ( ˜T [r]P F ′, 8) = θ([r]F −

−

[rδ]F ; 8),

p−1

Xu=1
by Theorem 4.4, as required.

−

5.4 The second set of identities

The proof of the second set of identities (2.5) relies on Theorem 4.3, as did the proof
of the identities (2.4) in subsection 5.1. However now, the relevant quadratic ﬁelds
are K = Q[√
10]. By (3.1), their rings of algebraic integers are
−
K = Z[√
10]. By (4.1, 4.2), the conductors of the ray class
−

O
characters ψ and ψ′ introduced in subsection 4.1 are given by,

30] and K′ = Q[√
K′ = Z[√

−
30] and

O

−

Fψ = (2a)OK = (2)OK = P 2
2
Fψ′ = (3

and
2a)OK′ = (6)OK′ = 3P ′
2

2,

×

(5.30)

since D′′ = 3 and so ˜D′′ = 12, and a = 1.

The calculation of ψ and ψ′ is complicated by the fact that ideals in

K and

need not be principal ideals:
C
and [P13]OK are generators of
C
CP (2)(K) generate
γ
≡

1 mod P2 and these values determine ψ.
Similarly, taking [P ′
13]OK′ as generator of
K

O

K′
(K′) is of order 2. In fact [P11]OK
(K) is of order 4 and
C
(K) so that, by (3.7), [P11](2) and [P13](2) together with
C(2)(K). We ﬁnd that ψ = 1 on [P11](2) and [P13](2) and on [γ](2) if
(K′), we eventually conclude that ψ′ = 1
1 mod 2
10 mod 3 are satisﬁed (this is the only way to ensure that the
K′/(3)× is cyclic of order 8 generated

(P2∪
K — note that

C
K′) if either both or neither of α

∈ O

O

O

−

≡

\

3

13](6) and on [α](6), for α

on [P ′
and α
1 or
conductor is no larger than 6
by the coset of µ′ = 1 + 2√

≡ ±

√

±

O
O
10.). Again these values determine ψ′.

they
We use the admissible pair (F, F ′) of conductors where F = P5P34P2 and F ′ =

−

5(3)4P ′
P ′

2. Thus

CP F (K) is the image of
K/P5)×
(
∼= (

K/F )×

O

×
(using (3.13) twice) and we denote its elements [n, m, α]F , accordingly, slightly gener-
alising the notation introduced before (3.14). We ﬁnd,

O

O

O

×

(

K/P3)×

(

K/4P2)×,

(5.31)

ker ψF =

[P11]F , [P13]F , [n, m, 1 + 2α]F |

h

n

∈

Z

−

5Z, m

Z

∈

−

3Z

igp

24

(5.32)

(recalling (3.16) we see that we can take n and m to be integers). The classes
[n, m, 1 + 2α]1−γ
turn out to be trivial, and for µ = 1 + 2√

30, one has,

[P11]1−γ

F = [µ/11]F = [11µ]F = [1,

−
1, 3µ]F ,

−

F

O

since P 2

11 = µ

K and 112

1 mod F . Similarly,

≡
[P13]1−γ
F = [(7 + 2√

30)/13]F = [

1, 1, 3µ]F .

−

−

So, in the notation of Theorem 4.3,

AF = (ker ψF )1−γ =

=

[1]F , [1, 1,

[1,
h
1]F , [

1, 1, 3µ]F igp
1, 3µ)]F , [
−
3µ]F }
1, 1,
1, 1, 3µ]F , [
−
−

−
−

{

−
F = [1, 1, (1 + ρ)2(31)−1]F = [1, 1,

3µ]F , and

Also, [1, 1, 1 + ρ]1−γ

−

−

SF = AF [1, 1,

3µ]F = AF [

1, 1, 1]F .

(5.33)

Again ker ψ′

F ′ = B

B[1, µ′, 1 + √

10]F ′, where

∪

B =

13]F ′, [n, β, 1 + 2α]F ′

n

|

Z

∈

−

5Z, β

−

−

[P ′

h
13]1−γ

We ﬁnd [P ′
[1, µ′, 1 + √

F ′ = [1, √
−
10]1−γ
F ′ = [1,

A′

F ′ =
=

−
[1, √
[1,

h
{

±

10,

−
1, 1]F ′, [1,

−

10,
√

−
−
−
1]F ′, [1, √
√

±

−

1]F ′, [n, β, 1 + 2α]1−γ
3µ′]F ′. So
10,

−

±

igp
±

1 or

√

10 mod 3

≡ ±
F ′ = [1,

±
−
1, 1]F ′, and

igp.

10,

3µ′]F ′, [1,

−
10,

−
1]F ′, [1,

1, 1]F ′
1, 3µ′]F ′, [1,

−

−

±

√

10,

−

−

3µ′]F ′

.

}

(5.34)

Also, [1, 1, 1 + √

10]1−γ

F ′ = [1, 1,

3µ′]F ′, and

−

F ′ = A′
S′

−
F ′[1, 1,

−

3µ′]F ′ = A′

F ′[1,

1,

±

−

1]F ′.

(5.35)

Now (because there are ideals of norm 13 in both
KK′ such that

O

O

K and

K′) there is an ideal ˜P

in

O

KK′/K( ˜P ) = P13

and

KK′/K′( ˜P ) = P ′

13.

N

N

Again, let p be a prime such that p

1 mod 12. Then, by quadratic reciprocity,

So

K′′ has an ideal P ′′

p of norm p. It follows (from the identities of section 4.2) that

O

KK′/K(P ′′

p O

N

KK′) = p

K and

KK′/K′(P ′′

KK′) = p

K′.

p O

O

O

N

≡
3
p !

 

=

p
3 (cid:19)

(cid:18)

= 1.

25

Now, if n is prime to 5 and congruent to 1 mod 12 we may choose (by Dirichlet’s
theorem) p

n mod 120. Then, taking I of Theorem 4.3 to be ˜P P ′′

≡

[
N

KK′/K(I)]F = [pP13]F = [nP13]F

and [

KK′/K′(I)]F ′ = [pP ′

N

p , we ﬁnd that
13]F ′ = [nP ′

13]F ′.

So that, by Theorem 4.3,

−
(Here sets AF , SF etc. stand for the sums of their elements.)

θ([nP13]F (AF −

SF ); d) = θ([nP ′

13]F ′(AF ′

SF ′); d)

(5.36)

In particular, let r
ζs

ζr mod 8; and let
0 mod 5. Then, choosing n congruent to s (and ζt) mod 5, to 1 mod 3 and

ζ mod 4, where ζ =

1; let 2

≡

−

≡

±

s

t
to ζr mod 8, we have

≡

6≡

θ([P13]F [s, 1, 2

−
where we have used the fact that [ζ, 1, ζ]F ′ = [1, ζ, 1]F ′ lies in A′
F ′. Note that we can
take

−

SF ); d) = θ([P ′

13]F ′[t, 1, r]F ′(AF ′

SF ′); d),

(5.37)

s]F (AF −

(
(
(
(

1,
11,
3,
7,

−
−
−

1, 1 ) . . .
(i)
5, 1 ) . . .
(ii)
5, 13 ) . . . (iii)
1, 13 ) . . . (iv)

−
−

(s, r, t) = 



(5.38)

We now set about reducing the identities (2.5) between Virasoro characters to
identities like (5.37). As a ﬁrst step, we rewrite the former using the V functions
deﬁned in 2.7. This gives,

η[V (1, 4)
3, 4)
η[V (

V (11, 4)] = [V (1, 3)
V (7, 4)] = [V (1, 3)

V (5, 3)][V (2, 5)
V (5, 3)][V (

∓
4, 5)

V (8, 5)]

V (14, 5)]

(5.39)

±
±

−

−

∓

±
±

and

where

ηV (2, 4) = V (2, 3)[V (1, 5)
ηV (6, 4) = V (2, 3)[V (7, 5)

V (19, 5)]
V (13, 5)].

−
−

(5.40)

We concentrate on the four identities (5.39) here, since the last two (5.40) can be
treated in a very similar way. Using the properties of V functions described in (2.8,
2.9), the relations (5.39) can be expressed in the following compact form,

V (1, 2)V (s, 4) = V V (r, t),

(5.41)

V V (r, t) def= V (r, 3)V (2t, 5) + V (

5r, 3)V (32t, 5),

−

with (s, r, t) taking the values (5.38). These equations and hence the ﬁrst four identities
in (2.5) will follow from (5.37) when we show that, for the (s, r, t) of (5.38) and with
d = 240,

2V (1, 2)V (s, 4) = LHS of (5.37)

(5.42)

26

and

2V V (r, t) = RHS of (5.37).

(5.43)

We tackle (5.42) ﬁrst. Applying (2.13) (both signs), we ﬁnd

2θr,6θs,20 = T (α) def= θ(α + J; d) + θ( ¯α + J; d),

where α = 10r + sρ, J = 40P3 and d = 2400. Assume r prime to 6 and s to 10. We
ﬁnd that the h.c.f of α

K and J is H = P2P5 and, since F = JH −1,

O

T (α) = θ([αH −1]F + [¯αH −1]F ; 240) = θ([αH −1]F ([1]F + [¯α/α]F ); 240).

Now put β = 10 + ρ and, choosing b prime to 10, put ˆα = 10r + bsρ. Then

α ˆβ

−

ˆαβ = 10(b

1)(r

s)ρ

10F.

−

−

∈

Since H 2 = 10

K, it follows from Lemma 3.3(ii) that

O
[ˆα/α]F = [ ˆβ/β]F =

= [b, 1, 2

b + (b

1)ρ]F = ǫ(b), say,

· · ·

−

−

using the 3-component notation developed above. Also, N(βH −1) = 13. So we may
take P13 = βH −1 and then [αH −1]F = [P13]F ǫ(s). We have now

T (α) = θ([P13]F ǫ(s)([1]F + ǫ(

1)); 240).

−
2m + 1 mod 2m(m + 1) for m = 2 and m = 4, (2.7) can be rewritten

Now, since
for these m values as,

31

−

≡

So, taking b = 31 and r = 1 in α and ˆα,

V (r, m) = θr,m(m+1) −

θ31r,m(m+1).

2V (1, 2)V (s, 4) = T (α) + T (31α)

T ( ˆα)

T (31 ˆα) = θ(X(s); 240)

−

−

where

Now, [31]F = [1, 1,

1]F , ǫ(

1) = [

X(s) = [P13]F ǫ(s)([1]F + [31]F )([1]F + ǫ(

1))([1]F −
−
1, 1, 3µ]F and ǫ(31) = [1, 1, 3µ]

ǫ(31)).

SF . So

−

−

−
X(s) = [P13]F ǫ(s)(AF −
1 mod 4. Thus we have proved (5.42).

if s

≡
Applying (2.13) again, we ﬁnd

SF ) = [P13]F [s, 1, 2

∈
s]F (AF −

−

SF ),

2θr,12θ2t,30 = T (α) def= θ(α + J; d) + θ( ¯α + J; d)

where α = 5r + 2t√

10, J = 60P ′

2 and d = 1200.

−

27

We assume

We ﬁnd that the h.c.f of α

O

r

≡

1 mod 6 and t prime to 5 and t
K and J is H = P ′

≡

5 and, since F ′ = JH −1,

1 mod 3.

(5.44)

T (α) = θ([αH −1]F ′ + [¯αH −1]F ′; 240) = θ([αH −1]F ′([1]F ′ + [¯α/α]F ′); 240)

(5.45)

Now put β = 5 + 2√
5ar + 2bt√
10. Then

−

−

10 and, choosing a

1 mod 6 and b prime to 15, put ˆα =

≡

α ˆβ

−

ˆαβ = 10(b

a)(r

t)√

10

5F ′,

−

−
K, it follows from Lemma 3.3(ii) that

−

∈

since r

t mod 3. Since H 2 = 5

≡

O
[ˆα/α]F ′ = [ ˆβ/β]F ′ =

where

= [1, 1, a]F ′ǫ′(b),

· · ·

(5.46)

ǫ′(b) = [b,

(1 + b)

−
= [b, 1, 1]F ′,

(b
−
if b

−
≡

1)√
1 mod 6.

−

10, 1 + 2(b

1)√

10]F ′

−

−

In particular, from (5.45),

T (α) = θ([αH −1]F ′([1]F ′ + ǫ′(

1)); 240).

−

Now, from (2.7),

V (r, 3) = θr,12 −

θ7r,12

and V (2t, 5) = θ2t,30 −

θ2(−11t),30,

1 mod 3. This ensures that if r = r0
where we took the minus sign so that 7
≡ −
and t = t0 satisfy (5.44) then so do all the pairs (r, t) of the products T (α) = 2θr,12θ2t,30
in the expansion of V V (r0, t0) using (5.48). Expressing each such product as in (5.47)
and using (5.46) several times with diﬀerent choices of a and b, we ﬁnd, writing α0 =
5r0 + 2t0√

10, that

11

≡

V V (r0, t0) = θ(X; 240),

(5.49)

−

where

X = [α0H −1]F ′([1]F ′ + [1, 1,
ǫ′(
−
SF ′).

. . . = [α0H −1]F ′(AF ′

([1]F ′

×

−
−

5]F ′ǫ′(16))
11)

×

−

−

[1, 1, 7]F ′ + [1, 1, 7]F ′ǫ′(

11))([1]F ′ + ǫ′(

1))

−

−

Now, N(β) = 25 + 40 = 65. So N(βH −1) = 13. Hence we may choose P ′
and then

13 = βH −1

[α0H −1]F ′ = [P ′

13]F ′[α0/β]F ′ = [P ′

13]F ′[1, 1, r0]ǫ(t0).

So, if t0 ≡

1 mod 6,

13]F ′[t0, 1, r0]F ′(AF ′
Thus we have proved (5.43) and, as observed there, the ﬁrst and second lines of (2.5)
now follow.

SF ′).

−

X = [P ′

(5.47)

(5.48)

28

6 Conclusions

Over the years, two-dimensional conformal ﬁeld theory has proven to be a true goldmine
for those studying string theory as well as statistical mechanics. Its underlying algebraic
structure is the inﬁnite dimensional Virasoro algebra. Although its representation
theory has been thoroughly analysed, it is remarkable that identities between unitary
minimal Virasoro characters of low level, of the kind discussed in this paper, have
not been of use in any ‘physical’ context we are aware of. These identities could
therefore be regarded as mathematical curiosities, but our aim here has been to provide
a solid mathematical framework within which they naturally appear as the consequence
of relations between two ‘well chosen’ imaginary quadratic extensions over Q. The
formalism used is borrowed from number theory, and provides, together with a new
proof of the identities (2.4, 2.5), a new inﬁnite family of identities between Virasoro
characters at level 3 and level m = 4a2, for a odd and 1 + 4a2 = a′2p where p is prime.
From the number theory point of view, the interesting result is Theorem 4.3,
which describes relations between ray class theta functions of two diﬀerent imaginary
quadratic ﬁelds K and K′, under a certain number of constraints presented in Section
4. That these relations, when the pair (K,K′) is diﬀerent from (Q[√
1]) and
(Q[√
10]) but still obeys the constraints of Section 4, lead to other identities
between unitary minimal Virasoro characters, is neither proven nor disproven at this
stage.

30], Q[√

2], Q[√

−

−

−

−

Acknowledgments

One of us (A.T.) acknowledges the U.K. Engineering and Physical Sciences Research
Council for the award of an Advanced Fellowship.

References

[1] Goddard P., Kent A., Olive D.: Unitary representations of the Virasoro and

Super-Virasoro algebras. Commun. Math. Phys. 103 105 (1986).

[2] Kac V.G. and Peterson D.H.: Inﬁnite-dimensional Lie algebras, theta functions

and modular forms. Adv. in Math. 53 125 (1984).

[3] Lang S.: Algebraic number theory, Addison-Wesley (1970).

[4] Taormina A.: New identities between unitary minimal Virasoro characters. Com-

mun. Math. Phys. 165 69 (1994).

[5] Wilson S.M.J. : Relations between ray class L-functions of diﬀerent quadratic

ﬁelds. in preparation

29

