 

 
 

 

 

 

Detecting substeps in the rotary motors of FoF1-ATP synthase by 
Hidden Markov Models 

N. Zarrabia, M. G. Düsera, R. Reutera, S. D. Dunnb, J. Wrachtrupa, M. Börsch*a 
a3rd Institute of Physics, University of Stuttgart, Pfaffenwaldring 57, 70550 Stuttgart, Germany; 
bDepartment of Biochemistry, University of Western Ontario, London, Ontario, Canada N6A 5C1 

ABSTRACT 

FoF1-ATP synthase is the enzyme that provides the 'chemical energy currency' adenosine triphosphate, ATP, for living 
cells. The formation of ATP is accomplished by a stepwise internal rotation of subunits within the enzyme. We monitor 
subunit rotation by a single-molecule fluorescence resonance energy transfer (FRET) approach using two fluorophores 
specifically  attached  to  the  enzyme.  To  identify  the  stepsize  of  rotary  movements  by  the  motors  of  ATP  synthase  we 
simulated  the  confocal  single-molecule  FRET  data  of  freely  diffusing  enzymes  and  developed  a  step  finder  algorithm 
based on 'Hidden Markov Models' (HMM). The HMM is able to find the proximity factors, P, for a three-level system 
and for a five-level system, and to unravel the dwell times of the simulated rotary movements. To identify the number of 
hidden states in the system, a likelihood parameter is calculated for the series of one-state to eight-state HMMs applied to 
each set of simulated data. Thereby, the basic prerequisites for the experimental single-molecule FRET data are defined 
that  allow  for  discrimination  between  a  120°  stepping  mode  or  a  36°  substep  rotation  mode  for  the  proton-driven  Fo 
motor of ATP synthase. 

Keywords: Rotary motor, FoF1-ATP synthase, FRET, single-molecule, Hidden Markov Model 
 

1.  INTRODUCTION 

The biological function of FoF1-ATP synthase is the catalysis of ATP formation from ADP and phosphate. Therefore, the 
enzyme utilizes the difference of the electrochemical potential of protons (or sodium ions in some organisms) across a 
lipid  membrane,  i.e.  a  pH  difference  plus  an  electric  potential  generated  by  ion  concentration  differences.  FoF1-ATP 
synthases  are  embedded  in  the  inner  mitochondrial  membrane,  the  thylakoid  membrane  of  chloroplasts,  and  in  the 
plasma membrane of bacteria. The membrane-bound Fo part of ATP synthase contains the proton translocation pathway, 
and the F1 part accommodates three catalytic binding sites for ATP or ADP plus phosphate, respectively, at the interface 
of the β and α subunits (Fig. 1).  
Since the concept of the 'binding change mechanism' had been suggested by P. Boyer1 subunit rotation of the two distinct 
motors  of  FoF1-ATP  synthase  is  investigated  with  biochemical2  and  spectroscopical3  methods.  The  rotary  catalytic 
mechanism was supported by structural details of the F1 part of ATP synthase obtained by X-ray crystallography4, and in 
1997 direct videomicroscopic evidence of ATP-driven rotation was provided using surface-immobilized single F1 parts5. 
The  proposed  application  of  the  F1  part  as  a  biological  rotary  nanomotor  in  bionanotechnology6  was  followed  by  the 
unraveling of substeps using nanometer sized beads as a marker of rotation7. 
The  rotational  mode  of  the  Fo  motor  has  been  studied  by  confocal  single-fluorophore  anisotropy8  and  by 
videomicroscopy  of  single  beads  attached  to  Fo  9,  10.  We  apply  a  single-molecule  FRET  approach11-13  using  two 
fluorophores to monitor the rotary motions of the Fo motor. The FRET donor is covalently attached to the non-rotating a 
subunit  of  the  Fo  motor  by  genetic  fusion  of  the  autofluorescent  protein  'enhanced  GFP'  to  the  C  terminus  of  a  14. 
Rhodamine  derivatives  are  used  as  the  FRET  acceptor.  'Alexa-568'  (or  'Atto-594',  respectively)  is  bound  to  a  single 
cysteine  in  the  rotating  ring  of  10  c  subunits15.  Rotation  of  the  c  ring  will  result  in  a  sequence  of  distance  changes 
between  these  two  fluorophores,  and,  accordingly,  the  FRET  efficiency  is  expected  to  change  stepwise  (Fig. 1).  The 
determination  of  FRET  efficiency  levels  and  the  dwell  times  were  done  manually  in  the  time  trajectories  of  double- 
 

*m.boersch@physik.uni-stuttgart.de; phone (49) 711 6856 4632; fax (49) 711 6856 5281; www.m-boersch.org 

 
 

 

 

 

 

labeled ATP synthases, which were reconstituted into liposomes and were freely diffusing through the confocal single-
molecule detection volume. 

Our preliminary single-molecule FRET data indicate a stepwise movement of the c ring during ATP-hydrolysis driven 
rotation that likely corresponds to three-step rotation with a stepsize of about 120° (Fig. 2a,b) in agreement to the single-
molecule anisotropy data8 and the videomicroscopy of single beads10. In contrast, proton-driven c ring rotation during 
ATP  synthesis  seems  to  involve  smaller  stepsizes,  i.e.  10  substeps  per  full  rotation  with  a  stepsize  of  36°  (Fig. 2c,d). 
However, during the same measurements also larger stepsizes were detected that could correspond to 108° or 144° steps. 
To  overcome  the  limitations  of  a  potentially  biased  manual  single-molecule  FRET  data  analysis,  a  robust  software 
approach is needed.  

Fig. 1. Models of the FRET-labeled FoF1-ATP synthase embedded in a lipid vesicle and of the FRET distance changes upon 
c ring rotation. Left, the F1 motor consists of the non-rotating subunits α3β3δ and the rotating γ and ε subunit. The Fo 
motor  comprise  the  static  subunits  ab2  and  the  rotating  ring  of  10  c  subunits.  The  FRET  donor  EGFP  (gray  dot)  is 
directly bound to subunit a. Only one c subunit is labeled with the FRET acceptor 'Alexa-568' (or 'Atto-594') on the 
opposite side of the membrane (black dot). Middle, the FRET efficiency between a nearest position of the labeled c and 
EGFP  is  high  (black  arrow)  and  low  for  the  most  distant  position  of  c  (light  gray  arrow).  Right,  evenly  spaced 
arrangement of the ten possible positions of the FRET acceptor at one c subunit (bottom view). During c ring rotation 
FRET efficiency changes according to 36° substeps (1→2→3→4→) can be estimated and discriminated from larger 
stepsizes (1→5→3'→1→). 

 

2.1  FRET-labeled FoF1-ATP synthase 

2.  EXPERIMENTAL PROCEDURES 

Preparation procedures of the FRET-labeled FoF1-ATP synthase from Escherichia coli to monitor c ring rotation will be 
described in detail elsewhere. Briefly, we used a genetic fusion of the 'enhanced Green Fluorescent Protein', EGFP, to 
the C terminus of subunit a that has been constructed by Y. Bi (University of Western Ontario, Canada), combined with 
the additonal cysteine mutation at the c2 position in the c subunit constructed by D. J. Cipriano (University of Western 
Ontario, Canada). FoF1-ATP synthase was purified from bacterial membranes as described11-13. Attaching the Alexa-568 
(Molecular  Probes)  or  Atto-594  (Atto-tec)  to  a  single  cysteine  of  detergent-solubilized  FoF1  was  accomplished  a  4°  C 
using  the  maleimide  derivatives  of  the  fluorophores.  Rhodamine  labeling  efficiency  was  determined  by  UV-VIS 
absorption  spectroscopy  using  the  EGFP  absorbance  as  an  internal  concentration  reference.  After  labeling,  ATP 
hydrolysis rates were measured as a control. Enzymes were reconstituted in an excess of preformed liposomes (radii of 
about 100 nm) to assure the ratio of a single enzyme per liposome. The FRET-labeled FoF1-ATP synthases in liposomes 
were stored as 5 µl aliquots at -80° C. 

 
 

 

 

2.2  Confocal single-molecule FRET measurements 

Single-molecule  FRET  measurements  were  performed  on  a  confocal  inverted  microscope  in  epi-fluorescence 
configuration (Olympus IX71) using an argon ion laser for cw excitation at 488 nm (model 2020, Spectra Physics) or an 
amplified  frequency-doubled  laser  diode  for  pulsed  excitation  at  488  nm  (~  60  ps  pulses  at  80  MHz,  PicoTA  490, 
Picoquant)14.  A  water  immersion  objective  (UPlanSApo  60x,  1.2  N.A.,  Olympus)  focused  the  attenuated  laser  beams 
into  a droplet of buffer  containing  10  to 100  pM FoF1. Fluorescence  from  single  FoF1  diffusing  through  the  excitation 
volume of about 5 fl was split into two or three spectral ranges by a combination of consecutive dichroic mirrors (AHF) 
and  detected  by  three  avalanche  photodiodes  (SPCM  AQR-14,  Perkin  Elmer),  APDs,  after  passing  interference  filters 
(AHF).  Out-of-focus  fluorescence  was  rejected  by  a  150  µm  pinhole.  To  investigate  the  photophysics  of  the  FRET 
acceptor  Alexa-568,  confocal  fluorescence  correlation  spectroscopy,  FCS,  was  performed  independently  using  cw 
excitation at 561 nm (solid-state laser Jive, Cobolt). 

The signals of the APDs were counted by TCSPC (time correlated single photon counting) electronics from Becker & 
Hickl.  For  the  two-APD  configuration  of  single-molecule  FRET  measurements  with  high  photon  count  rates,  we 
installed  the  novel  SPC-152  device  consisting  of  two  synchronized  PC  cards.  FCS  measurements  were  feasable  with 
count rates up to 2 MHz per channel. A polarizing beam splitter was integrated into the detection pathway in order to 
measure the cross correlation functions for correlation times from 10 ns to 1 s in arbitrary parts of the time trajectories 
using the synchronized 'macro time' information of each photon. For three and four channel detection, we employ a SPC-
630 PC card with an 8 channel router as described previously.  

FRET data analysis was performed after binning the photons of the multichannel time trajectories to 1 ms intervals by 
our software 'Burst_Analyzer'16. FRET distances were determined from the proximity factor trajectory, that is, the ratio 
of the corrected fluorescence intensity of the acceptor channel, IA, and the sum of donor and acceptor intensities, ID+IA, 
binned  in  1  ms  intervals.  Alternatively,  a  maximum  likelihood  estimation  approach  based  on  photon  distribution 
statistics was used yielding the FRET distance17. FCS curves were calculated using a fast multiple tau algorithm18. 

 

2.3  Simulation of confocal single-molecule FRET data 

Single-molecule fluorescence data of a freely diffusing single particle, that is, a single fluorophore or the FRET-labeled 
FoF1 in a spherical liposome with a radius of 100 nm, was simulated by a 'random walk' through a virtual laser focus (or 
detection volume) in a three dimensional box. The time interval for the Brownian motion simulation was set to 100 µs. 
The detection volume was defined by three dimensional Gaussians and placed within the center of the box. Dimensions 
of the confocal detection volume were taken from the experiment resulting in a prolate ellipsoid with a lateral radius of 
650 nm (intensity decayed to 1/e2 in the x-y dimensions) and an axial radius of 3.3 µm (intensity decayed to 1/e2 in the z 
dimension). The volume of the ellipsoid was 5.84 fl using the 2σ values which corresponds to 13.5 % of the intensity 
maximum. The diffusion of the single particle was restricted to a box with a length of 1.95 µm in x and y direction, and a 
height of 9.90 µm in z corresponding to a total volume of 37.64 fl. The diffusion properties of the particle were chosen 
according  to  the  experimental  data,  that  is,  the  diffusion  constant  of  the  FoF1  in  a  spherical  liposome  was  100  times 
smaller than the diffusion constant of a single fluorophore. When the particle hit a wall of the box, it was forced to re-
enter the box in the next simulated time frame from the opposite side. The maximum fluorescence intensity of a particle 
in  the  center  of  the  detection  volume  was  set  to  100  counts/ms.  The  concentration  of  the  particles  was  kept  in  the 
picomolar  range  resulting  in  a  single  particle  in  the  box  at  any  time.  10  time  trajectories  of  10  s  duration  each  were 
simulated and visualized using the software 'Burst_Analyzer'. The intensity autocorrelation functions of these simulated 
trajectories were calculated, and the mean number of molecules in the detection volume as well as the diffusion constants 
of  the  particle  were  calculated  and  compared  to  the  initial  values of  the Monte  Carlo  simulation.  This  simulation  was 
programmed in MATLAB (Mathworks, Inc.). 

Fluctuating  FRET  efficiencies  within  the  bursts  were  generated  by  a  superposition  of  the  intensity  trajectory  with  the 
FRET level trajectory of a single particle. The FRET level trajectory was calculated using a sequence of three (or five) 
FRET levels. The dwell time of a FRET level and the transition probabilities between adjacent FRET levels were given 
by the ratio of rate constants for forward and backward transitions using experimental data from single-molecule FRET 
measurements of proton-driven rotation in FoF1. The simulated photon bursts with FRET level transitions were passed to 
the software 'Burst_Analyzer' and bursts were defined using intensity based thresholds. FRET level analysis including 

 

 
 

 

 

 

dwell  time  calculation  for  the  intermediary  FRET  levels  were  accomplished  by  procedures  published  previously14  for 
comparison with the HMM analysis. 

2.4  Hidden Markov Models and FRET data analysis 

Marked  bursts  containing  proximity  factor  trajectories  with  1  ms  time  resolution  were  the  output  from  the 
'Burst_Analyzer' and were further analyzed using Hidden Markov Models. The HMM analysis software was written in 
MATLAB  and  is  based  on  the  toolbox  provided  by  K.  Murphy19.  Given  the  number  of  HMM  states  representing  the 
FRET levels in the simulated bursts, the software optimized the mean values of the FRET levels from starting values and 
provided  the  dwell  times  as  well  as  the  transition  probabilities.  For  the  three  FRET  level  simulation  and  for  the  five 
FRET  level  simulation  data,  a  series  of  HMMs  with  different  numbers  of  one  to  eight  hidden  states  were  used  and 
compared. The most likely number of hidden states, that describe the simulated data set best, is found by the Bayesian 
information criterion, BIC.  

3.  CONFOCAL SINGLE-MOLECULE FRET MEASUREMENTS OF FREELY 

DIFFUSING FOF1-ATP SYNTHASE 

Unraveling the stepsize of linear and rotary biological motors with nm precision requires long observation times for the 
individual stopping position of the single motor as well as long time trajectories that allow for observation of multiple 
turnover steps for appropriate statistics. This has been achieved for the ATP-driven F1 motor of ATP synthase using a 
surface-attached F1 and a polystyrene bead (or gold bead) as a marker of rotation, which was not photobleached during 
the measurement time of more than one hour. The same method was applied to the Fo motor during ATP-driven rotation 
of the c ring.  

3.1  c ring rotation in FoF1-ATP synthase monitored by single-molecule FRET 

However,  FoF1-ATP  synthase  has  to  be  embedded  into  a  lipid  membrane  and  a  pH  difference  has  to  be  generated  to 
monitor proton-driven rotation of the Fo motor during ATP synthesis. Rotation of the c ring was successfully monitored 
using  the  fluorescence  anisotropy  of  a  single  Cy3  attached  to  one  c  subunit  of  a  Na+-driven  ATP  synthase.  The  low 
photon count rate limited the resolution of the stepsize in this approach.  

We use single-molecule FRET to monitor c ring rotation in FoF1-ATP synthase during catalysis (Fig. 2). As the FRET 
donor, EGFP was permanently fused to the C terminus of subunit a in the Fo part. EGFP is a protein with a molecular 
mass of 27 kDa, but the fusion to the C terminus of subunit a did not block the rotary movements of the γ and ε subunits 
nor the c ring. The FRET acceptor was either 'Alexa-568' or 'Atto-594'. These rhodamine derivatives were bound to a 
cysteine at residue position 2 in one c subunit. The diameter of the c ring is about 5 nm, and the expected height of the 
EGFP  chromophore  is  approximately  4.2  nm  above  the  level  of  rotation  of  the  FRET  acceptor.  Accordingly,  distance 
changes between the two fluorophores in Fo are expected to occur from 4.2 nm up to 7.5 nm. This is the ideal distance 
change to be measured accurately by FRET assuming a Förster radius between 5 and 6 nm. The single-molecule FRET 
efficiency is calculated as the proximity factor P.  

The P values were found to change between 0.1 and 0.9 during ATP hydrolysis as well as ATP synthesis. While large 
steps  (comprising  3  or  more  substeps)  were  observed  during  ATP  hydrolysis,  the  FRET  efficiency  changes  during 
proton-driven c  ring  rotation  could  not be described unequivocally  by  either  large stepping or a persistent  ten-stepped 
rotation in 36° substeps.  

3.2  Intensity fluctuations and FRET level transition determination 

Due  to  the  Brownian  movement  through  the  laser  focus,  the  total  fluorescence  intensity  is  spatially  dependent  and 
fluctuates.  For  transient  low  count  rates,  the  apparent  proximity  factor  approaches  values  around  0.5  because  of  a 
background fluorescence detected on both FRET donor and acceptor channels.  

 

 
 

 

 

 

 

 

 

 

 

Fig.  2.  Photon  bursts  and  proximity  factor  trajectories  of  single  FRET-labeled  FoF1-ATP  synthase  in  a  liposome  during 
catalysis. In the lower parts of the diagrams the gray traces display the FRET donor intensity binned in 1 ms, the black 
traces show the FRET acceptor intensity. Upper row, stepwise FRET efficiency changes during ATP hydrolysis (with 
FRET  acceptor  Atto-594).  The  large  stepsize  is  defined  by  a  repeating  sequence  of  three  FRET  levels  according  to 
manual  FRET  data  analysis.  Lower  row,  FRET  efficiency  changes  during  ATP  synthesis.  Multiple  FRET  distance 
changes  occur  before  the  starting  first  FRET  level  of  the  burst  is  reached  again  according  to  manual  FRET  data 
analysis. 

4.  THE HMM APPROACH TO ANALYZE SINGLE-MOLECULE FRET  

The  Hidden  Markov  Models  approach  has  to  identify  the  number  of  FRET  levels  and  the  transitions  between  these 
levels. The method accounts for the intensity fluctuations within a single photon burst. To develop and evaluate the use 
of HMMs we started with a simulation of photon burst of freely diffusing particles with known FRET level transition 
rates.  In  the  following  step,  HMMs  with  predefined  numbers  of  hidden  states  were  trained  on  the  simulated  data  set. 
Finally,  the  best  model  with  a  minimum  number  of  HMM  states  was  determined  using  the  Bayesian  information 
criterion.  

4.1  Monte Carlo simulation of confocal FRET trajectories 

4.1.1  To  simulate  the  intensity  distribution  in  the  confocal  laser  excitation  volume,  a  three  dimensional  Gaussian  was 
chosen and placed in the center of the simulation box. Three dimensional Brownian motion is related to the diffusion 
coefficient by20 

 
 

 

 

 

 

 
 

 

 

 

 

D=

2

x

6

t

res

 

with x, mean distance after a time interval tres (time resolution of the simulation, 100 µs). The time resolution has to be 
high  enough  to  accurately  map  the  trace  of  the  particle  in  and  out  of  the  detection  volume.  Therefore,  the  mean 
fluorescence intensity is given by the spatial detection efficiency of the constant intensity I0: 
)

 
+
with ω0, lateral radius, and z0, axial radius of the excitation volume21. 

zyxI
,(
),

)0

(
−

(
−

exp

exp

(2) 

ω
0

(
x

)

=

2

2

y

z

z

I

 

2

0

2

2

4.1.2 The double-labeled FoF1 exhibits a FRET level i with i=1...Q. Q is the number of distinct FRET levels for a full 
turn of the rotary motor of FoF1. Each FRET level is defined by a given value of the proximity factor, Pi. We simulated a 
three FRET level system (Q=3, P1=0.3, P2=0.5 and P3=0.7) and a five FRET level system (Q=5, P1=0.2, P2=0.35, P3=0.5, 
P4=0.65, P5=0.8). FRET level transitions were allowed for neighboring FRET levels only. 

The probability kii to find the FoF1 remaining in the same FRET level i after one time step tres=100 µs of the simulation 
was related to the dwell time, tdwell 
(
−

 
(3) 
To obtain a preferred direction of rotation, the transition probabilities to the neighboring FRET levels i+=i+1 and i–=i–1 
were related by 

= exp

dwell

res

)

k

t

t

ii

 

Furthermore, all transition probabilities from state i had to sum up to 1 

4.1.3 The time dependent, fluctuating fluorescence intensity I(t) of FoF1 in the actual FRET level i at time t is devided 
into a FRET donor intensity, ID, and a FRET acceptor intensity, IA, by the time dependent proximity factor P(t) 

k

ii
+

k

ii
−

20=

 

k

ii

+

k

ii
+

+

k

ii
−

1=

 

I D
I A

t
)(

t
)(

tP
)(

(
1
−=
tItP
)()(

=

)
 

tI
)(

 

4.1.4  We  consider  the  number  of  detected  photons  on  both  channels  at  time  t  to  be  randomly  distributed  due  to  shot 
noise, which is described by the distribution of Poisson (ζ, probability density function to detect k photons)22  

ζ

channel

channel

(

I

),
(
kt

)

=

exp

(
−

I

channel

))(
t

 

k

)(
t

I

channel
k
!

We generated Poisson distributed random variables with the time dependent ID and IA to obtain the single-molecule time 
trajectory. In the same way, we added a background noise of Inoise=3 counts/ms for each channel. 

4.1.5 To validate the simulated photon burst trajectories we calculated the fluorescence autocorrelation function G(τ) of 
the FRET donor channel. From the fit we obtained the diffusion time, τDiff, of FoF1 through the detection volume23  

τDiff corresponded to the typical times of experimental FCS measurements of FoF1 in liposomes, that is, about 26 ms in 
the simulation. The initial diffusion constant, D, was regained by23 

G

1)(
τ

+=

1
N

⎛
⎜
⎜
⎝

1
ττ
+

1

Diff

⎛
⎞
⎜
⎟
⎟
⎜
⎠
⎝

1

1

+

(
ω
0

)
2

z

0

ττ

Diff

2/1
⎞
⎟
⎟
⎠

 

D

=

2
ω
0
4
τ

Diff

 

4.1.6 For the next step of the simulation the time trajectories were re-binned to 1 ms time resolution, which corresponds 
to the standard time resolution of the single-molecule FRET experiments. The photon bursts were identified by threshold 
values after background subtraction of 3 counts/ms on both FRET channels. A minimum level of 10 counts/ms on FRET 
donor  or  acceptor  channel  started  the  burst  identification  and  4  counts/ms  marked  the  outer  boundaries  of  a  burst.  A 

(1) 

(4) 

(5) 

(6) 
(7) 

(8) 

(9) 

(10) 

 

 
 

 

 

 

 

 

 

 

 

 

minimum burst length threshold was set to 5 ms, and within one bursts, the intensities were allowed to drop below the 
minimum level for up to 15 ms. Longer off-times resulted in a separate burst. Examples of simulated bursts are shown in 
Fig. 4a,b. After building the list of bursts, the retrieval process of the internal FRET level transitions was started. 

4.2  The HMMs based on Beta probability density functions of the proximity factor of a three (and a five) FRET 

level system 

Hidden Markov Models consist of four components: 

kij, transition probabilities between state Si to state Sj, with i,j=1...Q 

•  Q, number of hidden states Si  
• 
•  α, observables 
• 

f(α), emission probability function 

The  simulation  (as  well  as  the  single-molecule  FRET  experiment)  provides  two  intensity  trajectories.  However,  the 
intramolecular distance between the two fluorophores is the only observable for the HMM. The proximity factor  

is  used  as  a  measure  for  the  distance.  Considering  the  intensities  ID  and  IA  as  independent  Poisson  variables,  the 
probability density function f(P) of the proximity factor P is distributed according to the Beta law24, 25 

P

=

I
A
+

I

D

I

A

 

(
Pf

)

=

P

I

A

(
1 1
−

−

P

)
I

1
−

D

 

)
with the Beta function B defined by Gamma functions 

IB
(

1
I
,
DA

IB
(

I
,
DA

)

=

(
I
Γ
A
(
I
Γ

A

()
I
Γ
I
+

)
D
)

D

 

The mean 

(Pf

)

 remains 

(
Pf

=)

I
A
+

I

D

I

A

. 

The standard deviation σ of the Beta function is given by 

σ

=

⎡
⎢
⎢
⎣

(

I

I
I
AD
) (
2
I

+

I

+

I

+

)
1

1

2

 

⎤
⎥
⎥
⎦

A
The presence of a constant background noise Ii

D

D

A

(
Pf

=)

(
I
A
noise
D

+
)

I
+

)
+

noise
A
(
I

A

(
I

D

+

I

I

noise
A

 

)

P=µ  
1

=σ

(
P

I

1

−

P

1(
−+

)PP
)

 

noise on both channels shifts the expectation value of the proximity factor 

Only  for  the  case  of  high  photon  count  rates,  the  distributions  of  the  proximity  factor  from  the  experiment  can  be 
approximated  by  Gaussians.  Then,  the  mean  value,  µ,  and  the  standard  deviation,  σ,  describing  the  Gaussian  can  be 
expressed by the proximity factor P and the sum of the intensities I=ID+IA of both channels24  

Recently this approximation was used with an HMM applied to single-molecule FRET data26. However, this is only true, 
if the sum intensity I is constant for each observable α. The experimental confocal single-molecule FRET data of FoF1 in 
liposomes show strong fluctuations of the sum intensity due to Brownian motion in the detection volume. The different 
intensities result in different standard deviations. Furthermore, the approximation of the Beta function by a Gaussian is 
not sufficient for low count rates (Fig. 3). 

(11) 

(12) 

(13) 

(14) 

(15) 

(16) 

(17) 

(18) 

 
 

 

 

 

 

 

 

 

 

Fig.  3.  Left,  the  Markov  Model  with  three  hidden  states  Si  is  described  by  the  transition  probability  matrix  K.  Middle,  beta 
probability density functions for proximity factors P1=0.1, P2=0.3, P3=0.5, P4=0.8 and a total intensity I=ID+IA=100 a.u.. The 
probability function could also be described by a Gaussian. Right, beta probability density functions for proximity factors 
P1=0.1, P2=0.3, P3=0.5, P4=0.8 and a total intensity I=ID+IA=10 a.u.. The shape of the probability functions p1 and p4 differ 
significantly from a Gaussian. 

In order to describe the distribution of an observed variable P, the probability density function is built by a sum of N 
Gaussians  described  by  the  mean  values  µi  and  their  standard  deviation  σi.  The  likelihood  of  the  measured  proximity 
factor of a data point can be expressed as  

Pf
(

|

)
,
σµ

=

exp

(
−

Pd
(

|

))
,
σµ

 

1
N

)
(
2
σπ

2

1

2

with the Mahalanobis distance d(P|µ,σ). 

We replaced the multivariate Gaussian probability density function (eq. 19) by the Beta probability density function to 
characterize  the  distribution  function  of  the  measured  proximity  factor  trajectory.  In  contrast  to  the  Gaussian 
approximation, the shape of the emission probability function f(α) is adjusted to the actual intensity in every time step 

IPf
(
,

|

)
α

=

1
I
,
DA

)

IB
(

I

A

P

(
1 1
−

−

P

)
I

1
−

D

 with 

I D

(
−= 1

) IP

 and 

I A =

IP

. 

The probability for a specific sequence of states S is composed of the product of the emission probability f at time t and 
the transition probability k from the state S(t) to the next state S(t+1): 

L

∏=

t

tPf
(
(

),

tI
|)(

)
α

k

tStS
)(
(

+

)1

 

With this equation it is possible to determine the likelihood L of a given state sequence in a time trajectory of length T. 
The most likely state sequence given the data, the transition probability matrix and the emission probability functions, 
can  be  found  within  an  order  of  T  as  described27.  Furthermore,  the  HMM  parameters  (α,  K)  can  be  optimized  by  a 
maximum  likelihood  approach  using  the  iterative  Baum-Welch-algorithm28.  Once  the  optimal  parameters  α  and  K  are 
estimated, the calculation of the Viterbi-path of all bursts yields the classification of each time step to a hidden state S. 
This procedure yields a statistical description of the 'hidden steps' of the rotational subunit movements within the ATP 
synthase.  

By comparing several HMMs with a different number of hidden states, it is possible to decide, which model describes 
the data best, by comparing the overall likelihood of all bursts. This can be done by the Bayesian information criterion 
(BIC). The increased likelihood of a system with additional hidden states is compensated by a penalty term29: 

 

BIC

−=

log2

(
QL
+

2

) ∑+

log

1

A

iBurst

 

iBurst

with Q, the number of hidden states (penalty term for redundant states) and AiBurst, number of the assigned states within a 
single burst (penalty term for shortened dwell times).  

(19) 

(20) 

(21) 

(22) 

 
 

 

 

 

 

 

 

 

 

 

Fig. 4. Results of the HMM analysis with three hidden states Si of the simulated three FRET level system (left) and of the 
HMM with five hidden states Si of the simulated five FRET level system (right). Upper row, photon bursts of single 
simulated  FoF1  with  sum  intensity  fluctuations.  The  HMM  extracted  FRET  levels  of  the  complete  data  set  are 
superimposed on the proximity factor trajectory of the single FoF1. Second row, FRET level histograms. Lower row, 
dwell time distributions of the intermediary FRET levels as found by the HMMs. 

 
 

 

 

 

 

 

 

5.  RESULTS  

The results of the recovery processes for a given three and a five FRET level system by the HMM approach are shown in 
Fig. 4  and  summarized  in  Table 1.  The  hidden  state  trajectory  of  the  proximity  factor  had  been  recovered  from  the 
binned  simulated  data  in  the  presence  of  Poisson  distributed  noise.  The  hidden  states  of  a  five  level  system  had  been 
resolved. Due to additional background noise, the resulting proximity factor of the hidden states corresponding to low 
and high proximity factors were shifted towards the value 0.5. This effect increases with decreasing signal-to-noise ratio 
of the simulated data.  

In  addition,  background  noise  leads  to  a  deviation  of  the  proximity  factor  histogram  (Fig. 4c,d)  from  the  expected 
distributions  (Fig. 3).  Some  parts  of  the  burst  have  a  count  rate  which  is  lower  than  the  average  count  rate  of  the 
background noise. Due to the similar noise levels of both channels, these parts are best described by an HMM state with 
a proximity factor around 0.5. Therefore, the number of retrieved FRET levels with a proximity factory around 0.5 is 
higher than expected. 

Table 1. HMM retrieval of proximity factors P and dwell times for the simulated FRET level system 

three FRET level system 
P (given for simulation): 
P (found by HMM with 3 states):  
dwell time (given): 
dwell time (found): 

 
0.30, 0.50, 0.70 
0.36, 0.52, 0.67 
20.0 ms 
16.1 ± 0.6 ms 

five FRET level system 
P (given for simulation): 
P (HMM with 5 states): 
dwell time (given): 
dwell time (found): 

 
0.20, 0.35, 0.50, 0.65, 0.80 
0.24, 0.37, 0.48, 0.61, 0.75 
20.0 ms 
16.4 ± 0.5 ms 

The  mean  dwell  times  retrieved  for  the  three  and  the  five  level  systems  were  shorter  than  the  initial  values  for  the 
simulation. In principle the dwell times of the first and the last FRET level of a burst entering or leaving the detection 
volume  remain  unknown.  Defining  a  burst  by  intensity  thresholds  leads  to  an  additional  shortening  of  the  state 
trajectories due to splitting up into separate bursts. These effects shorten the average dwell time of the retrieved states 
and are not compensated in the current HMM approach. 

Fig. 5. The BIC for the three FRET level system (left) and the five FRET level system (right) 

 

 

To determine the most likely HMM for the given FRET level system, the BIC (eq. 23) of different HMMs was applied 
for  the  three  and  five  FRET  level  system  (Fig.  5).  The  maximum  for  the  three  FRET  level  system  was  found  for  the 
HMM with 4 states, the maximum for the five FRET level system was found for the HMM with 5 states. The details of 
the  HMMs  are  summarized  in  Table  2.  We  noticed  that  each  supernumerous  state  leads  to  strong  decrease  in  the 
corresponding dwell times. For example, the 4-state HMM for the three FRET level system found 4 states with P=0.33, 
0.45, 0.55 and 0.67 with the corresponding dwell times 10.8, 5.5, 5.8 and 9.6 ms. The initial simulated state at P=0.50 

 

 
 

 

 

 

 

 

 

1. 

2. 

3. 
4. 

5. 

6. 

7. 

8. 

was divided into the two states 0.45 and 0.55 with fast internal transitions. In general, more states resulted in very short 
dwell times (Tab. 2). 

Table 2. Three and five FRET level systems with retrieved proximity factors and dwell times 

n-state HMM 
2 
3 
4 
5 
6 
 
2 
3 
4 
5 
6 

0.39 / 11.2 
0.36 / 12.6 
0.33 / 10.8 
0.01 / 0.04 
0.41 / 0.03 

0.39 / 17.9 
0.32 / 11.3 
0.27 /   7.7 
0.24 /   6.3 
0.11 /   0.4 

three FRET level system  with proximity factor P / dwell time (ms) 

0.59 / 13.6 
0.52 / 16.6 
0.45 /   5.5 
0.36 / 12.9 
0.33 / 10.4 

0.62 / 18.4 
0.52 / 15.3 
0.43 / 12.3 
0.37 / 10.8 
0.29 /   7.3 

 
0.67 / 10.0 
0.55 /   5.8 
0.51 / 17.0 
0.45 /   5.6 

 
0.69 / 11.9 
0.58 / 12.3 
0.48 / 15.5 
0.44 / 12.6 

 
 
0.67 /   9.6 
0.65 / 12.9 
0.54 /   6.8 

 
 
0.73 /   8.0 
0.61 / 12.3 
0.57 / 12.0 

 
 
 
0.52 / 0.06 
0.67 / 8.8 

 
 
 
0.75 / 8.1 
0.71 / 7.4 

five FRET level system  with proximity factor P / dwell time (ms) 

 
 
 
 
0.51 / 0.04 

 
 
 
 
0.89 / 0.3 

The next  steps  towards  a  software-based unbiased  analysis  of  confocal single-molecule  FRET  data will  include  a fine 
tuning of the BIC to identify the initial number of FRET levels and to use experimental single-molecule FRET data of 
the rotary motors of FoF1-ATP synthase. 

Acknowledgements 

The authors thank D.J. Cipriano and Y. Bi (University of Western Ontario) for the genetics of the FoF1-ATP synthase 
mutants,  P.  Gräber  and  co-workers  (University  of  Freiburg,  Germany)  for  the  help  with  enzyme  preparations  and 
reconstitution methods, W. Becker for the SPC-152 PC cards and D. von Gegerfelt (Cobolt) for the Jive laser. Financial 
support  from  the  Deutsche  Forschungsgemeinschaft  (BO  1891/8-1  and  BO  1891/10-1)  and  from  the  Landesstiftung 
Baden-Württemberg (Network of Competence: Functional Nanostructures) is gratefully acknowledged. 

REFERENCES 

P.  D.  Boyer,  "The  Binding  Change  Mechanism  for  ATP  Synthase  -  Some  Probabilities  and  Possibilities", 
Biochim. Biophys. Acta. 1140, 215-250 (1993). 
T. M. Duncan, V. V. Bulygin, Y. Zhou, M. L. Hutcheon, R. L. Cross, "Rotation of subunits during catalysis by 
Escherichia coli F1-ATPase." Proc. Natl. Acad. Sci. USA 92, 10964-10968 (1995). 
D. Sabbert, S. Engelbrecht, W. Junge, "Intersubunit rotation in active F-ATPase", Nature 381, 623-5 (1996). 
J.  P.  Abrahams,  A.  G.  W.  Leslie,  R.  Lutter,  J.  E.  Walker,  "Structure  at  2.8  Å  resolution  of  F1  ATPase  from 
bovine heart mitochondria." Nature 370, 621-628 (1994). 
H.  Noji,  R.  Yasuda,  M.  Yoshida,  K.  Kinosita,  Jr.,  "Direct  observation  of  the  rotation  of  F1-ATPase",  Nature 
386, 299-302 (1997). 
R. K. Soong, G. D. Bachand, H. P. Neves, A. G. Olkhovets, H. G. Craighead, C. D. Montemagno, "Powering an 
inorganic nanodevice with a biomolecular motor", Science 290, 1555-8 (2000). 
R.  Yasuda,  H.  Noji,  M.  Yoshida,  K.  Kinosita,  Jr.,  H.  Itoh,  "Resolution  of  distinct  rotational  substeps  by 
submillisecond kinetic analysis of F1-ATPase", Nature 410, 898-904 (2001). 
G. Kaim, M. Prummer, B. Sick, G. Zumofen, A. Renn, U. P. Wild, P. Dimroth, "Coupled rotation within single 
F0F1 enzyme complexes during ATP synthesis or hydrolysis", FEBS Lett 525, 156-63 (2002). 

 
 

 

 

9. 

10. 

11. 

12. 

13. 

14. 

15. 

16. 

17. 

18. 

19. 
20. 
21. 

22. 

23. 

24. 

25. 
26. 

27. 

28. 

29. 

 
 

Y.  Sambongi,  Y.  Iko,  M.  Tanabe,  H.  Omote,  A.  Iwamoto-Kihara,  I.  Ueda,  T.  Yanagida,  Y.  Wada,  M.  Futai, 
"Mechanical rotation of the c subunit oligomer in ATP synthase (F0F1): direct observation", Science 286, 1722-
4 (1999). 
H. Ueno, T. Suzuki, K. Kinosita, Jr., M. Yoshida, "ATP-driven stepwise rotation of FoF1-ATP synthase", Proc 
Natl Acad Sci U S A 102, 1333-8 (2005). 
M. Börsch, M. Diez, B. Zimmermann, R. Reuter, P. Gräber, "Stepwise rotation of the γ-subunit of EFoF1-ATP 
synthase  observed  by  intramolecular  single-molecule  fluorescence  resonance  energy  transfer",  FEBS  Letters 
527, 147-152 (2002). 
M. Diez, B. Zimmermann, M. Börsch, M. König, E. Schweinberger, S. Steigmiller, R. Reuter, S. Felekyan, V. 
Kudryavtsev, C. A. Seidel, P. Gräber, "Proton-powered subunit rotation in single membrane-bound F0F1-ATP 
synthase", Nat Struct Mol Biol 11, 135-41 (2004). 
B. Zimmermann, M. Diez, N. Zarrabi, P. Gräber, M. Börsch, "Movements of the ε-subunit during catalysis and 
activation in single membrane-bound H+-ATP synthase", Embo J 24, 2053-63 (2005). 
M. G. Düser, N. Zarrabi, Y. Bi, B. Zimmermann, S. D. Dunn, M. Börsch, "3D-localization of the a-subunit of 
F0F1-ATP  synthase  by  time  resolved  single-molecule  FRET",  Progress  in  Biomedical  Optics  and  Imaging  - 
Proceedings of SPIE 6092, 60920H (2006). 
M. G. Düser, D. J. Cipriano, N. Zarrabi, S. D. Dunn, M. Börsch, "Proton-driven c subunit rotation within the F0 
motor of a single ATP synthase", Biochimica Et Biophysica Acta-Bioenergetics 302-302 (2006). 
N. Zarrabi, B. Zimmermann, M. Diez, P. Gräber, J. Wrachtrup, M. Börsch, "Asymmetry of rotational catalysis 
of single membrane-bound F0F1-ATP synthase", Progress in Biomedical Optics and Imaging - Proceedings of 
SPIE 5699, 175-188 (2005). 
G. F. Schröder, H. Grubmüller, "Maximum likelihood trajectories from single molecule fluorescence resonance 
energy transfer experiments", Journal of Chemical Physics 119, 9920-9924 (2003). 
M.  Wahl,  I.  Gregor,  M.  Patting,  J.  Enderlein,  "Fast  calculation  of  fluorescence  correlation  data  with 
asynchronous time-correlated single-photon counting", Optics Express 11, 3583-3591 (2003). 
K. P. Murphy, Computing Science and Statistics. 2001. 
A. Einstein, "A new determination of the molecular dimensions", Annalen Der Physik 19, 289-306 (1906). 
M. Börsch, P. Turina, C. Eggeling, J. R. Fries, C. A. Seidel, A. Labahn, P. Gräber, "Conformational changes of 
the H+-ATPase from Escherichia coli upon nucleotide binding detected by single molecule fluorescence", FEBS 
Lett 437, 251-4 (1998). 
J. R. Fries, L. Brand, C. Eggeling, M. Kollner, C. A. M. Seidel, "Quantitative identification of different single 
molecules  by  selective  time-resolved  confocal  fluorescence  spectroscopy",  Journal  of  Physical  Chemistry  A 
102, 6601-6613 (1998). 
J.  Widengren,  U.  Mets,  R.  Rigler,  "Fluorescence  Correlation  Spectroscopy  of  Triplet-States  in  Solution  -  a 
Theoretical and Experimental-Study", Journal of Physical Chemistry 99, 13368-13379 (1995). 
M.  Dahan,  A.  A.  Deniz,  T.  J.  Ha,  D.  S.  Chemla,  P.  G.  Schultz,  S.  Weiss,  "Ratiometric  measurement  and 
identification of single diffusing molecules", Chemical Physics 247, 85-106 (1999). 
V.K.Rohatgi, Statistical inference. Wiley, New York, 1984. 
S.  A.  McKinney,  C.  Joo,  T.  Ha,  "Analysis  of  single-molecule  FRET  trajectories  using  hidden  Markov 
modeling", Biophysical Journal 91, 1941-1951 (2006). 
A. J. Viterbi, "Error Bounds for Convolutional Codes and an Asymptotically Optimum Decoding Algorithm", 
Ieee Transactions on Information Theory It13, 260-269 (1967). 
L. E. Baum, T. Petrie, G. Soules, N. Weiss, "A Maximization Technique Occurring in Statistical Analysis of 
Probabilistic Functions of Markov Chains", Annals of Mathematical Statistics 41, 164-171 (1970). 
R. T. T. Hastie, and J. Friedman, The Elements of Statistical Learning: Data Mining, Inference, and Prediction. 
Springer-Verlag, New York, 2001. 

