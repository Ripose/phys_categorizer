 

Consistent thermodynamic derivative estimates  
for tabular equations of state.  
 

Gary A. Dilts 

Continuum Dynamics Group 

Los Alamos National Laboratory  

Mail Stop D413, Los Alamos NM 87544 

Received March 4, 2005 

PACS: 47.11.+j, 83.85.Pt, 64, 02.70.-c 

 

 

ABSTRACT 

Numerical simulations of compressible fluid flows require an equation of 
state  (EOS)  to  relate  the  thermodynamic  variables  of  density,  internal 
energy,  temperature,  and  pressure.  A  valid  EOS  must  satisfy  the 
thermodynamic conditions of consistency (derivation from a free energy) 
and  stability  (positive  sound  speed  squared).  In  many  cases  an  analytic 
EOS is sufficient, but in many others, particularly when phase transitions 
are  significant,  the  EOS  is  complicated  and  can  only  be  specified  in  a 
table.  For  tabular  EOS’s  such  as  SESAME  from  Los  Alamos  National 
Laboratory, these can take the form of a differential equation relating the 
derivatives  of  pressure  and  energy  as  functions  of  temperature  and 
density,  along  with  positivity  constraints.  Typical  software  interfaces  to 
such  tables  based  on  polynomial  or  rational  interpolants  compute 
derivatives  of  pressure  and  energy  and  may  enforce  the  stability 
conditions,  but  do  not  enforce  the  consistency  condition  and  its 
derivatives. The consistency condition is important for the computation of 
various  dimensionless  parameters  of  an  EOS  which  may  involve 
derivatives up to second order. These parameters are in turn important for 
the  development  of  more  sensitive  artificial  viscosities  and  Riemann 
solvers  that  accurately  model  shock  structure  in  regions  near  phase 
transitions. We describe a new type of table interface based on the tuned 
regression  method,  which  is  derived  from  a  constrained  local  least 
squares  regression  technique.  It  is  applied  to  several  SESAME  EOS’s 
showing how the consistency condition can be satisfied to round-off while 
computing  first  and  second  derivatives  with  demonstrated  second-order 
improvement  of  14  orders  of  magnitude  over 
convergence.  An 
conventional  derivatives  is  demonstrated,  although  the  new  method  is 
apparently  two  orders  of  magnitude  slower,  due  to  the  fact  that  every 
evaluation requires solving an 11-dimensional  nonlinear system.  

 

1

1. INTRODUCTION 

The two most common techniques for modeling the heat generated by shock waves 

in the numerical simulation of compressible flows are artificial viscosity [1] and the 
Riemann solver [2]. Over the years, these have seen many enhancements and variations. 
For comprehensive summaries, see [3--5]. Unfortunately, the Riemann solver is only well 
developed for the ideal gas equation of state. Some attempts have been made for more 
complicated analytic EOS’s, such as the Mie-Gruneisen EOS [6--7], but real materials in 
general have such a complicated EOS that it can only adequately be expressed in a table, 
for which there is no Riemann solver yet published. The SESAME library [8--9], which 
is widely used at Los Alamos National Laboratory and has been distributed throughout 
the world, contains tabular EOS’s for many elements and will be the source of our 
examples. Our treatment in this paper is specific to the choice of variables used in 
SESAME but it may be straightforwardly modified for others. 

The mathematical description of the behavior of shock waves in real fluids with an 
arbitrary equation of state was described in detail in [10]. Four dimensionless quantities 
are important: 

 

γ

= −

,

Γ = −

,

g

=

V P
∂
P V
∂

S

V T
∂
T V
∂

S

PV T
∂
2
S
T
∂

,

V

G

=

1
2

2

2

V
γ

P
∂
2
P V
∂

S

.  (1) 

,

,

P V T S
,

γ is the adiabatic exponent,  Γ  is the Grüneisen coefficient, 

represent pressure, specific volume, temperature, and entropy, 

The symbols
respectively. The quantity 
is the dimensionless specific heat, and  G  is the fundamental derivative. The quantities 
g
γ and  G  represent the slope and curvature of isentropes in the  P V− plane, respectively. 
The quantity G  is most important for the determination of shock wave structure. 
0<G(cid:0) , shocks occur in rarefaction. In a 
When
numerical simulation this information must be incorporated into the switch used to turn 
on artificial viscosity or in the solution constructed by a Riemann solver. First and second 
order approximate Riemann solvers for real EOS’s would make extensive use of  G . 
Clearly, in order to construct these solvers we must first know how to compute physically 
realistic values of 

, shocks occur in compression; when 

 from tables. 

0>G

G

Assume for the moment we have internal energy 

E
. The thermodynamic definitions of pressure

 expressed as a function of 

P

and 

specific volume V and entropy 
temperatureT are 

S

 

 

and imply that  

P

= −

,

T

=

E
∂
V
∂

S

E
∂
S
∂

 

V

P
∂
S
∂

V

= −

T
∂
V
∂

. 

S

2 

 

(2) 

(3) 

 

 

 

 

This is the thermodynamic consistency condition and it amounts to a differential equation 
that a valid equation of state must satisfy. In the SESAME tables, pressure and energy are 
expressed as functions of temperature and density. With temperature and density 
independent, condition (3) takes the form  

using various thermodynamic identities [10]. Thermodynamic stability requires that the 
Hessian of  E  be jointly convex in V and , which leads to the conditions  

S

2

E
∂
2
S
∂

V

≥

0,

≥

0,

2

E
∂
2
V
∂

S

2

E
∂
2
S
∂

2

E
∂
2
V
∂

V

S

⎛
≥ ⎜
⎝

2

E
∂
V
S
∂ ∂

2

⎞
⎟ . 
⎠

With temperature and density independent these are satisfied if  

P T
=

+

2
ρ

P
∂
T
∂

E
∂
∂
ρ

 

E
∂
T
∂

≥

0,

0
≥ . 

P
∂
ρ
∂

(4) 

(5) 

(6) 

P

and 

Equations (4) and (6) are thus constraints on any derivatives one might construct from the 
SESAME table data for
E
also be satisfied in the evaluation of the quantities in equation 
involves second derivatives, so the derivatives of 
density also need to be satisfied to make 
subject of this paper.  

 in order for them to be physically realistic. They must 
G
(1). The computation of 

 physically realistic. How to do all this is the 

(4) with respect to temperature and 

G

 

That satisfaction of these constraints is not automatic for traditional derivative 
evaluation schemes is illustrated by Table 1, which shows the average absolute value of 
the log-scale of the normalized consistency error, 

+ , where  

sgn ln 1
ε

ε

ls

≡

(
)
ε

ε

= − +

P T

+

2
ρ

P T
+

+

2ρ

(7) 

P
∂
T
∂

E
∂
∂
ρ

⎞
⎟
⎠

⎛
⎜
⎝

P
∂
T
∂

E
∂
∂
ρ

⎞
⎟ , 
⎠

⎛
⎜
⎝

using several common methods [11--12] for computing derivatives of SESAME table 
2984 for molybdenum. Since pressure and energy vary by 6 and 12 orders of magnitude 
respectively in this example the normalizing denominator is necessary for a fair 
75 135×
assessment of the error. The table grid was  37 65×
, and the evaluation grid was 
The standard deviation for all methods was approximately 1.0e-15. Thus at most points, 
traditional derivatives match the consistency condition to a little less than three decimal 
∂ was -33.2 
places. The minimum value of  

∂  was -0.198 Mbar-cc/K, and of  P ρ∂

E T
∂

. 

Mbar-cc/g using birational derivatives. These are well below the minimum allowed 
values of zero according to (6). The other methods showed similar results. Some software 
interfaces have options to enforce these positivity constraints [11], but it is not done in a 
way which simultaneously guarantees satisfaction of the consistency constraints. In the 
rest of this paper, we elucidate a technique to do precisely this. 

 

3

 

 

Table 1. 

Method 

Error 

bilinear 

0.00665

biquadratic

0.00240

birational 

0.00175

bihermitian

0.00107

 
Table 1. Average absolute value of the log-scale of the normalized consistency error (7) 
for various derivative methods in common use. Bilinear, biquadratic, and birational 
methods are described in [11]. The “bihermitian” method is the bicubic hermitian method 
described in [12]. The actual software package of [11] was used for the first three 
methods, and the author’s implementation was used for the last. 

2. NUMERICAL METHODS

The tuned regression estimator (TRE) method [13] allows us to estimate derivatives 
of tabular EOS data while simultaneously guaranteeing (4) and (6). We shall summarize 
briefly the basic ideas of that paper and refer the reader thereto for more background, 
generality, detail and examples. Here, we shall just remark that it grew out of the 
application of the statistical method of local regression estimators [14] to the numerical 
solution of differential equations. 

m

-dimensional data values 

Let us suppose we have data points in two dimensions 
iu = ⊂ Rm
{ }N
i
1
valued function of two variables 
u
:
1
2
 at an arbitrary point
of  
x x
,

2
→R
)
2
∈ R

=

(

u

x

m

{ }N
iy = ⊂ R
i
 which we presume to sample a continuous 

 with associated 

m

-

2

1

. Suppose we want to estimate  derivatives 

R
. First, we describe traditional polynomial 

n

interpolation methods, in a formalism that will prepare us for local and tuned regression 
estimation.  

Suppose the data points make up a Cartesian grid. Let a column vector of 

n

monomials 

p

:

2
→R

n

R

or 16. The derivative corresponding to a monomial 

 be chosen from Table 2. Of course 
b
)

) (

(

x

x

a

j

i

n

is 

 will be restricted to 4, 9, 
) (

a b
+∂

x
∂

x
∂

(

)

. 

b

a

j

i

be a subset of the data points of size consisting of the most-centered sub-grid that 

x of 

Z
Let
encloses
3 3×
methods, respectively. Denote the elements of 
between indices of points in

, and  4

2 2×

, 

n

4×

 points for the bilinear, biquadratic, and bicubic 
z…
k
 and let  be a map 
i = … n
1,
k iy
( )

z
1{ ,
 and data points such that 

z=  for 
i

, }n

 by

Z

. We wish 

,

to approximate 

( )
u x

 by 

exactly interpolated. Let

 matrix. We require

an 

m n×
4 

, whereζ is a m n× matrix such that the data are 

n

(
p z

)
Q vζ = , and thus
v Qζ
=
 

] , an  n n×  matrix, and

1
−

. For any 

m

,

,

v

=

u
[

…

]n
( )
( )
1
-valued function 

u

k

k

, 

Z
)
(
( )
ˆu x
p xζ=
)
(
(cid:34)
Q p z
[
,
,
=
1

∂ ∂ …  be an  m n×  matrix whose columns are the 
f

]

,

 

,

f

[

n

uJ

( )
x =

)
(
f
x
f x , let 
∂ ∂
0
derivatives corresponding to the monomials in 
( )
x
= Λ

( )
xζ=
J
p

)
ζ = Λ , and polynomial interpolants are said to reproduce the basis 

, where 

(
p y
i

. If 

x
1

iu

J

,

ˆu

p , which we call the jet matrix. Then 
and 

Λ is a constant  m n×  matrix, then 

v = Λ Q

(
p x . It is well-

)

known that they converge with order n for smooth data, but produce oscillations near 
discontinuities. The great advantage of polynomial interpolation is speed, as the
depends only on the

iy  and need be computed only once for all x .  

Q

 matrix 

 

Method 

bilinear 

biquadratic 

Table 2. 
 

Monomials 

 
1
0
0 1
x x x x
,

,

T

⎤
⎦

⎡
1,
⎣

0
1
x x
,

, (

x

0 1
x x

, (

1 2
x
) ,

 
0 2
) ,

0 2
)

1
0
x x x

(

,

1 2
) , (

x

0 2
) (

1 2
x
)

⎤⎦

⎡⎣
1,
(
x

bicubic 

⎡⎣
1,
(
x

0
1
x x
,

, (

x

0 2
) ,

0 1
x x

, (

1 2
x
) , (

x

x

0 2
)

1
x x x
0

(

,

1 2
) , (

1 3
x
) ,

 
0 3
) , (

0 3
)

1
x

, (

x

0 2
) (

1 2
x
) ,

0
x x
(

1 3
) , (

x

0 3
) (

1 2
x
) , (

x

0 2
) (

1 3
x
) , (

x

0 3
) (

1 3
x
)

⎤⎦

Table 2. Sets of monomials used for several traditional interpolation schemes [11--12]. 
The biquadratic method here includes 3 extra terms of cubic and quartic order than that 
described in [11], which might properly be termed the “quadratic” method.  

 

 

are determined by the value of a real-valued weight function 

The tuned regression method is a meshfree method and as such, notions of nearness 
w x y , instead of a grid. 
,
iy , and has compact 
w x y  is small, x is far away 

(
The weight function is generally smooth, centrally peaked about
)

support. When 
from iy . Although the grids used in the SESAME tables are non-uniformly spaced 
Cartesian, meshfree techniques may be applied to them. In this paper, we use the weight 
function  

x is close to iy . When 

w x y )
( ,

 is large,

(

)

,

i

i

i

(
w x y

,

j

)

=

N N
1
1
h h
j

j

2
2

B
4

1
x

1
y
j

−
1
h
j

⎛
⎜
⎜
⎝

⎞
⎟
⎟
⎠

B
4

2

x

y

2
j

−
2
j

h

⎛
⎜
⎜
⎝

, 

⎞
⎟
⎟
⎠

(8) 

where 4B is the cubic B-spline, defined by  

2

 
 

 

( )
B z
4

⎧ −
1
⎪
= ⎨
⎪⎩

3
2

z
(

1
4

2

+

3
4

,

z

≤

1

2

−

z

, 1

<

z

≤

2

3

3

z
)

 

 

 

 

 and 

are constants such that the integral of 

 is 1. We use a vector smoothing 

jW

and 

1N
length
h

2N
1
h h
,
j

=

[

j

]T

2
j

. 

Now let 

(
J x

)

 represent the 

n n×  jet matrix of p . It has been verified for a large set 

of monomial bases that the shifted basis has the form 
(
p x y
,
i

(
)
x p y
i

≡

=

J

)

(

)

1
−

 

(
D p y
i

−

x

)

, 

(9) 

where

D

 is a constant diagonal matrix. Suppose that 

( )xβ is a  m n×  matrix whose 

columns are derivative estimates of  u , the same derivatives that are used in

( )
J x

. Then 

,

)

 is the Taylor series expansion from  x to iy . Now suppose that we want 

( )
(
x p x y
β
i
)xβ  to satisfy a set of differential constraints at x , say
(
function theorem, this implies that a subset of theβcan be eliminated, or equivalently, 
we can change variables to a smaller number of variables γ such that

. Through the implicit 

) 0β =

β

D

(

 

and

(
D E

. Our Taylor series then takes the form

) 0
(
)
γ =
(
E F
mapping is given by 
average error of the Taylor Series expansion from x to all nearby points iy with  

(
p x y
,
i
. We measure the 
γ=

(
(
γE
(
F E

)
)
x
)γ
(
)

)β β=
)

(
)
β= F

 with 

and

γ

(

)
(
γ= E
)
. The inverse 

)
(
R (cid:0)(cid:0)
x
=

(
−∑
u

j

E

(
γ

(

x

)

)

(
p x y
,
i

2

)

)

(
w x

,

y

j

)

. 

(10) 

j

If we optimize

estimates of 

)xR (cid:0) with respect to ( )xγ by solving
(
( )
and all of its derivatives through
u x
(
xβ

R
∂
)xβ . The constraints will be satisfied 
(
. This constitutes the general method of tuned 

, we will obtain optimal 

0γ
∂ =

D

) 0
≡

(

)

to round-off by construction:

The case where  β=E

 is known as the local regression estimator (LRE), and has an 

regression.  

explicit solution: 

β

( )
x

=

∑

u
ψ
i
i

T

(

x

)

,

ψ
i

( )
x

1
−

=

P

( )
)
x p x y w x y
i
i

(

(

,

,

)

(
P x

)

=

∑

(
p x y p x y w x y
,
i

)

)

(

(

,

,

i

i

)

T

i

i

 

(11) 

It is well-studied in the statistics literature [14] and it is easy to show it has the form 
β

, similar to polynomial interpolants, and it has the reproducing 

ζ=

( )
( )
x J x

( )
x

property, just like polynomial interpolants and the moving-least squares (MLS) 
estimators used in the engineering literature [15]. In fact, the zeroth-derivative estimate 
of LRE is identical to that of MLS [13]. The convergence rates for x ∈ R  for the ν-th 

3 

 

derivative are 
matrix

( )P x

n ν− +  for  n ν− odd and 

1

n ν− +  for  n ν− even [14]. The moment 

2

in (11) becomes singular when the data points in the neighborhood 

x become coplanar, or there are less than  n of them, so the smoothing length must be 

of
made large enough to prevent these two situations. If it is too large however the 
procedure becomes expensive, as more neighbors are included in the sums. The proper 
selection of smoothing length for LRE is a fine art discussed in [14]. It is not known 
exactly how much of that discussion applies to TRE, but in practice, it is seen that at least 
neighbors are also required. It is also wise to monitor condition numbers in the course 
n
of solution. 

The present application makes use of the following specializations:

x

]
[
T ρ=
,

T

, 

y
i

T ρ=
,
i
i

[

]T

, 

u

=

[

E P
,

T

]

, and 

p

β

D

E
∂

,

=

T

E

⎡
1,
⎣
⎡
⎢
= ⎢
⎢
⎣
)
=
β β
1,0

P

(

P
∂

F

(

=
β β

)

E

(
)
γ

=

2

,
ρ

T

2,

T

,
ρ

2
ρ

E
∂

P
∂

∂
ρ

∂
ρ

T
∂

T
∂

T

2

⎤
⎦

,

2

∂

E

2

∂

P

2

T
∂

2

T
∂

−

T

−
β ρ β

2

1,1

0,2

=

0,

β β β
1
,5
1,1

(cid:34)

0,5

,

,

T

=

,
γ

,

,

0,0

…

⎡
⎣
γ
γ
⎡
0
1
⎢
2
T
γ ργ γ
⎣
6

+

2

6

⎤
⎦
γ
5
γ
10

⎤
⎥
⎦

…

(cid:34)

=

.
β

2

∂

E

2

∂

P

T
∂ ∂

ρ

T
∂ ∂

ρ

2

∂

E

2

∂

P

,

⎤
⎥
⎥
⎥
⎦

2
∂
ρ

2
∂
ρ

 

(12) 

We have eliminated 1,0β , which represents the pressure, through
evaluation and optimization of (10) is aided by the observation that it can be rewritten as  
(

, to defineγ. The 

)
E , 

(13) 

R(cid:0)
=

T
E E

0=D

U
2

Tr

Tr

W

P

−

+

 

T

where  

and

p
i

=

(
p x y
,
i

)

,

(
w w x y
i

=

,

i

)

.  

P

=

∑

i

p p w U
i
i

,

T
i

=

u p w W
i
i

,

T
i

=

∑ T w
u u
i
i

i

 

(14) 

∑

i

i

This prescription addresses the consistency condition (4), but the stability conditions 

(6) require further attention. We define three possible differential constraints to use: 

which represent the consistency and stability conditions and adopt a multi-pass algorithm 
to enforce all constraints simultaneously: (i) First, we try (15)(a) everywhere. (ii) 

Tβ
−
1,0

−
β ρ β

2

0,2

=

0

( )
a
(
)
b  
( )
c

1,1
β
0,1
β
1,2

=

0

=

0

 

(15) 

4

 

 

 

Where 0,1
Where 1,2
both 

0,1

0β < in the result of (i) we apply the combination of (15)(a) and (b). (iii) 

0β < in the result of (i) we apply the combination of (15)(a) and (c). (iv) Where 

0β <  and 

0β <  in (i), or where 

0β < in (ii) or 

0β <  in (iii), we apply the  

1,2

0,1

1,2

0,1β and 

combination of (15)(a),(b) and (c). For the SESAME tables examined to date the number 
of locations where (ii)-(iv) are required is very small. The technique results in the values 
of 

1,2β  being clamped to zero in regions where passes (i)-(iii) cause them to be 
corresponding to the 

negative. In the software, one needs to code four possibilities for
combinations in passes (i)-(iv). For the four different passes we solve constrained 
,β β , {
}
systems with {
,β β , {
1,0
0,1
1 11, 10 10, 9 9
results in solving1
×
×
of tuned regression: by eliminating some derivatives, we solve a smaller system with 
enhanced accuracy. The penalty is that the smaller system is more complicated.  

 systems, respectively. This illustrates a key feature 

β β β eliminated respectively, which 

}1,0β ,{
×

}

}

E

1,2

1,2

1,0

1,0

0,1

,

,

Both local regression and tuned regression in regions where only the consistency 

constraint is enforced produce approximations with smoothness equal to that of the 
weight function. 

E

P

A Mathematica [16] program has been written to symbolically optimize (13) for 
. It then generates code which is spliced into a C++ library 

arbitrary ,U ,W  and 
called LORELI (LOcal REgression LIbrary) which is used to operate on the SESAME 
data. The appendix exhibits the expressions for
program in terms of the matrices in 
(15) are active. 

(14) when the various combinations of constraints in 

 generated by this Mathematica 

R

3. EXAMPLE: ANALYTIC 

u

,

J

∂

∂

u

=

u
[ ,

Let

uJ =
That is, u is a quadratic function that exactly satisfies the consistency and stability 
conditions. Such an example is given by  

, and suppose that

uJ = Λ , and
J

∂ ∂
T

u
ρ

u
ρ

u

∂

]

D

,

,

,

T

∂ 2
u
ρ

2
T

(

) 0

. 

u

=

E
P

⎡
⎢
⎣

⎤
⎥
⎦

=

⎡
⎢
⎢
⎣

T
− + + +

1

2

ρ

T
2
ρ ρ
+

 

⎤
⎥
⎥
⎦

− +

T T

−⎡
Λ = ⎢
0
⎣

1 1

1

2 0 0
2

⎤
⎥
⎦

. 

−

1 0 0 1

(16) 

(17) 

Now suppose that

u
i

=

(
u y
i

)

= Λ

(
p y
i

)

. Then  

R

( )
x

=

Λ

(
p y
i

)

−

E

(
γ

(

x

)

)

J

1
−

( )
(
x p y
i

2

)

)

(
)i
w x y
,

 

(18) 

∑

(

i

with 

 

 

 

5 

 

u

)

)

(

(

)

J

x

x

E

=

= Λ

(
γ

( uJ

(
J x

γ = F

, because

is minimized if

and  R is identically zero. 

)
)
In other words, tuned regression possesses the reproducing property just like polynomial 
interpolation and local regression: a polynomial solution of the differential constraints 
evaluated at discrete points { }iy will be exactly reproduced at an arbitrary{ , }T ρ , to 
round-off. and can be used by a software implementation as a verification tool. The 
LORELI library mentioned above has been so checked on this example and does indeed 
reproduce to round-off. On the basis of these results we surmise that the tuned regression 
method for SESAME data is at least third-order accurate. There is a formal proof , but its 
presentation is out of scope here, however numerical examples below will confirm it. 

4. EXAMPLE: OXYGEN 

We choose SESAME table 5011 for Oxygen at low temperatures as our first example 

because the 23x51 grid is fairly uniform. Most SESAME tables have grids that are 
exponential in character to handle the many orders of magnitude variation of temperature 
and density required. This leads to ill-conditioned matrices in the TRE solution process, 
and requires special treatment as described below. Table 5011 however does not present 
this problem. On a 45x103 grid TRE agrees well with the input data and produces no 
discernable difference to the eye. Figure 1 shows the pressure derivative with respect to 
density, and a prominent feature is the flat annulus at low temperature. This is a region 
where the stability constraints were active, and the algorithm did what it was supposed to. 
The zeroth derivative estimates were not seen to echo this feature to the eye, which 
illustrates how the derivatives are estimated independently in TRE. The estimate of the 
derivative is not the derivative of the estimate, as it is in finite element or spectral 
methods. The two do converge however as the data become dense and the smoothing 
length goes to zero. The value of the un-normalized consistency error was everywhere 
less than 1.e-13, which is close to round-off, as promised. Figure 2 shows the relative 
error between the TRE result and the input table values when the input and output grid 
are identical. There is good agreement except at low temperatures where the constraints 
become active.  

5. LOGARITHMIC FORM 

2

∂ 2R
γ

As mentioned above, the exponential grids present in many SESAME tables present 
numerical difficulties, so a method must be devised to treat the ill-conditioned matrices 
that appear in the Newton solver for the equations
0γ
∂
∂ =
because the wide range of powers that appear in the moment matrix 
drastically out of balance when applied to very large numbers. For example, assume 8 
decades of range in table coordinates and 45 points, which gives a ratio of  about 1.5 in 
the size of successive intervals. Adjusting 
h
1810
to verify the condition number of 
when 
way to restore good conditioning is to use a preconditioner in the solver, and this is under 

 so that there are 49 neighbor points it is easy 

. These occur 
in (13) get 

( )P x

2510≈

. One 

when 

and 

410

610

P ≈

R
∂

x ≈

x ≈

 

6

 

 

 

 

investigation. Another way is to logarithmically scale the variables. To scale the 
independent variables we use the following transformation: 

τ

=

T
ln ,

r

=

ln ,

. 
ρ ε ρ
=

e

(19) 

In terms of these variables, the consistency and stability conditions become  

P

+ =
ε

P
∂
∂
τ

+

∂
ε
r
∂

∂
ε
∂
τ
P
∂
r
∂

≥

0

≥

0

( )
a

b
(

)

 

(

c

)

(20) 

These we refer to as semi-log constraints. It is the simplest form of the consistency 
condition and is linear, just like the original consistency condition, and thus requires only 
one 11x11 solve at most points. This coordinate change was found to work for a few 
tables, but a further step was required to get satisfactory behavior, because even though 
the new grid is not exponential, the data for pressure and energy has become exponential, 
and the problem of ill-conditioned matrices still appears. We now transform the 
dependent variables by means of  

ε
s
η

=

,

min
(
−
ε ε
s

−
ε ε
0
)
,

ln

=

p

=

s
=

ζ

ln

min
(

P P
−
0
)
.

P P
−
s

,

 

(21) 

The new energy and pressure minima 0ε and 
rest of this paper we set them equal to 1 so that the quantities
value of zero and are always positive otherwise. The larger we make 

0P

ζ and ηhave a minimum 
0ε and 

 the flatter 

0P

 are arbitrary but must be positive. In the 

the transformed data surfaces become in the large. The consistency and stability 
conditions for 

ζ and ηare 

exp

(
ζ

)

−

1

+

exp

(
)
η

⎛
⎜
⎝

ζ
∂
τ
∂

⎞
⎟
⎠

⎛
⎜
⎝

∂
η
r
∂

⎞
⎟
⎠

−

1

=

p

s

+

ε
s

a
( )

ζ
∂
r
∂
η
∂
∂
τ

≥

0

≥

0

b
( )

 

(22) 

(

c

)

Notice now that the consistency constraint is nonlinear, whereas previously it was linear. 
We refer to these as log-log constraints. We use the LRE solution (11) as the initial 
condition for a Newton solver or steepest-descent solver to optimize R . In practice, we 
typically see convergence in 3-5 Newton iterations with this initial condition. The same 
four-pass strategy for enforcing the stability constraints applies as was used before. 

The LORELI library thus contains twelve separate encodings of the residual function 
and its derivatives: for each type of constraint (flat, semi-log, and log-log), there are four 

7 

 

versions corresponding to the combination of consistency and stability constraints listed 
in the four passes following equation (15). The appendix exhibits these residual 
functions. 

The expressions for the dimensionless derivatives when logarithmic transformations 

are employed are given by: 
(
−
ζ η
e
(
ζ
τ

ζ η
−
e

ζ
e

γ

=

p

s

Γ =

,

r

2
τ

+
ζ ζη
τ
)
η
τ

ζ
e

+

)

,

η
τ
(

η
−

e

g

=

+

ζ
e

)

,

p

s
η
τ

e
(
e

(
(

 

 

 

G (cid:0)
e
=

η
−

r

(

2

ζ
+

e

) (

3
2
−
ηζ η ζ
τ

(
)
(
2
ζ ζ ζ η ζ η
rr
τ τ

ζ
e

τ τ

3
τ

+

−

+

+

2
r

)

ττ

r

2
η

2

r

ζ
+

e

r

η
+
η
r
τ

2
−
))

r

η
e
(

η
+

+

+

2
e
(
2
ζ
2
e
η ζ
τ

2
τ

2

r
e e
s

+

+

η
e
ζη
r
τ

3
e
(
r
2
e p
)
)

r

ζ
+ +

2
η
ζζ η
r
τ τ τ

+

 

(23) 

2
−

e

2

r

ζ
+
ζ
ττ

+

−

3
e

s

r

)
η
+
ζ η
r
τ

+

The reciprocal factors of  τη  and 
τη  become significant if the specific heat becomes small 
as discussed below.  The expression for  G  makes use of the consistency constraint (22a). 
One could further incorporate its derivatives with respect to τand 

: r

2

e

−
τ ζ
e

(
2
ζ ζ ζ
τ
ττ

−

−

τ

)

−

η
e

(

−

r

e

−

ζ
e

(
(
ζ ζ
r
τ

)
1
− +

ζ
r
τ

)

−

r

τ

+

(
)
1
η η η
r
τ

)
2
− +
η η η
r
r
rr

−
(

η
e

+

)

0
=
)
)

 

=

0

but the derivation of the log-log TRE method would have to be modified to add these two 
equations as constraints to those of (22). As it stands, the expression for  G  in (23) is 
consistent with the log-log TRE method implied by (22) above.  

6. EXAMPLE: MOLYBDENUM 

The log-log TRE method was applied to SESAME table 2984 for Molybdenum and 

, and once again there was no discernable difference to the eye between the two . 

, the output grid was 

the results are shown in Fig. 3. The input grid size was  37 65×
75 135×
The normalized log-log consistency error, given by  
(
ζ
e

ζ
e
ζ
τ

η
e
η
r

η
e

η
e

η
e

ζ
e

ζ
e

ε
s

+

+

−

+

−

p

p

+

+

+

+

+

 

s

)
η
r

ζ
τ

ε
s

s

 

(24) 

 

8

was smaller in magnitude than 2e-16 at all points as required and is 14 orders of 
magnitude smaller than the values of Table 1 obtained by traditional derivatives, a 
substantial improvement. The condition number of the final iteration of the Newton 
, and the number of Newton 
solver at each evaluation point was everywhere less than 
iterations required to converge to a tolerance of 1.e-13 was at all points between 1 and 4 
iterations, a very reasonable number for such a nonlinear problem. The condition 
numbers are rather high, but it appears possible to reduce them considerably by a simple 
scaling procedure which may be reported in subsequent publications.  

510

The dimensionless quantities of  (23) were computed using the TRE derivatives. At 
high temperatures, the values of γand G approach the theoretical values for monatomic 

ideal gases of 5/3 and 4/3, respectively, which gives some confidence to the calculations. 
On the other hand, at lower temperatures, there seem to be rather large divergent regions 
which correlate well with the flat regions at lower temperature in the plot of  η τ∂

∂  in 

Fig. 4 which have low values ( 1.e-03). This is significant because the expressions 
2
)η τ∂
for
∂

∂  in the denominator, and G has

 and in equations 

(23) have η τ∂

γ, 

Γ

≤

g

(

. To 

test that this is the cause of the divergent regions, the dimensionless derivatives are 
multiplied by the appropriate power of  η τ∂
∂ and plotted in Fig. 5. The divergent 
behavior has been mostly eliminated and in the plot of γ one can see the outline several  
phase boundaries.  At low T and high ρwe expect to find the solid phase, and at 
lowT and low ρwe expect to find the mixed phase. In these two phases, the theory 

leading to the definition of the dimensionless derivatives is incomplete because it does 
not include the effects of deviatoric strains or stresses and thus nonsensical results may 
be inescapable. Also, there are known jump conditions on γand Γ that may come into 

play across phase transitions, and these have not been enforced. One of the main points of 
all this calculation is the determination of the sign of G , which is negative mostly in the 
mixed phase region, so the ability to provide reliable guidance to numerical methods for 
shock waves in these regions is clouded. In light of these observations, it seems an 
appropriate approach is to include the explicit phase boundaries in the EOS evaluator and 
make reasonably correct estimates of the dimensionless derivatives when they are 
crossed. It is also possible that some of the divergent behavior seen with TRE is caused 
by numerical difficulties in early iterations of the Newton solver, and this should be 
investigated. 

Figure 6 shows theγcalculated by birational method of the EOSPAC library [11], 

which does not contain any divergent regions like the TRE result. Figure 7 shows a 
comparison ofγ by birational and TRE at three different temperatures, roughly 2 eV, 1 
keV, and 100 keV. In general, for positive ln ρ, the two agree fairly well, except at the 

high-density boundary of the table. At the highest temperatures, both results approach the 
theoretical value for an ideal gas. For negative ln ρ, the two results are always in 

disagreement. Perhaps this is because the constraints are more active in that region. This 
too should be further investigated. 

9 

 

To compare the computational cost of each method, a grid of 750x1350=1012500 

points was constructed. The EOSPAC birational evaluation on a 1.7GHz Pentium IV 
system took 5.7 sec. The time for LRE was 172 sec, which involved neighbor finding 
using a general two-dimensional binning algorithm and solving and performing one 6x6 
linear solve. The log-TRE method doing a single 11x11 linear solve took 249 sec, and the 
log-log-TRE method doing multiple 11x11 solves took 634 sec, which are 40 and 100 
times slower than EOSPAC, respectively. This is disappointing, but not unexpected 
because in addition to the linear solves involved, the algebra for TRE is much more 
complicated than for EOSPAC or even LRE. In practice, this computational cost can be 
avoided by evaluating all derivatives of an EOS on a fine grid and storing them for later 
evaluation by normal means of interpolation, such as LRE. Presumably the consistency 
condition would not be violated too much. This too needs further investigation. It must be 
observed that a linear TRE formulation is possible which would guarantee the 
consistency condition and involve only a 5x5 solve. Presumably, this would be 
competitive with LRE and EOSPAC from a performance viewpoint, but one would not 
be able to use it to compute the fundamental derivative, which requires quadratic TRE at 
a minimum. 

The LORELI implementation of log-log TRE was applied to tables for copper 
(3333), aluminum (3719), and tin (2160) with similar results, except for some anomalous 
divergences in one corner which seem to be due to poor choice of smoothing length. 
When the smoothing length is too small, there are too few neighbors, and the LRE or 
TRE methods develop ill-conditioned matrices. It becomes an issue near a table boundary 
because there are fewer neighbors than in the interior. If the smoothing length is too 
large, it may not be possible to satisfy the constraints with finite values. For LRE there is 
a fairly well-developed methodology for choosing the smoothing length, but more 
research is needed to do the same for TRE. 

The molybdenum table 2984 does not appear to contain Maxwell constructions for 
the removal of van der Waals loops. When the log-log TRE method is applied to tables 
that seem to have Maxwell constructions, such as gold (SESAME 2700), there are severe 
convergence problems in the vicinity thereof. This may be because second-order 
interpolation methods generally sustain oscillations in the vicinity of discontinuities, and 
perhaps because of the exponentials in the TRE method, these oscillations cause serious 
ill-conditioning in the solvers, both Newton and steepest descent. Some tables seem to 
have apparently arbitrary abrupt transitions at the edges which also cause a similar 
problem. These tables may require more physical adjustments at the edges before the 
TRE method is robust on them. Clearly the issue of Maxwell constructions requires more 
research. Perhaps they can be detected, by a linear LRE estimate for example, which 
always seems to be monotone (although a proof is unknown to the author), and then a 
separate technique applied. This is left for future investigations.  

 

10

7. CONVERGENCE AND ACCURACY 

To test convergence of  the TRE method, we use the following biquartic EOS  
)(
1
2
+
ρ ρ ρ

2
ρ ρ ρ
(

)
1
+ +
T
6

+
)(
1 2

(
= −

− )
6

+ +

T
3

(25) 

P

E

T

T

T

T

T

=

+

+

+

+

+

2

3

1
6

 

3

4

3

2

2

4

2

3

 

k

2

,

)

)

k

2

4
− −

0,

,1

y
Δ =

4yΔ

7 17×

(0.5, 0.5

points centered at 

= … 8  in each 

which satisfies the consistency and stability constraints. It is not reproducible by either 
quadratic or cubic polynomial, LRE, or TRE methods. This EOS was sampled on a grid 
of 1
with spacing 
dimension to generate a table of energy and pressure that was input to the various 
estimation procedures operating on  5 5×  grid centered at (
. 
0.5, 0.5 with spacing 
The error in the estimates was measured and two sample results for pressure are plotted 
in Fig. 8. The curves have been truncated on the left where convergence ceased for each 
method. In particular, the linear methods were the most robust (working at smaller mesh 
spacings), followed by the quadratic and cubic methods. The bicubic hermitian method 
was the least robust. Table 3 shows the convergence rates for the various methods coded 
by the author. The local regression methods converge in keeping with the theoretical 
rates given in section 2 above. The tuned regression zeroth derivatives converge at the 
same rates as the quadratic local regression estimator, which is encouraging. For zeroth 
derivatives the convergence is fourth order, which is remarkable since only a quadratic 
polynomial is used in the modeling. Table 4 shows the  log
convergence curves, which gives an indication of the relative accuracy of the various 
methods. The various regression methods trade advantages in different derivatives with 
their competitors of like polynomial order. The bihermitian method, as coded by the 
author, seems to have a markedly higher intercept than the other cubic methods, implying 
that a finer table is required to get the same accuracy as a bicubic or cubic LRE method 
could get. The tuned regression estimator does the best job on consistency of course, as 
evidenced by the intercept value. The other methods all converge in consistency error, as 
they must if they converge at all, but unless you build consistency into the algorithm, you 
can not guarantee it. 

yΔ =  intercept of the 

0

lre1

lre2

lre3

bilinear

biquad

bicubic

biherm

E

P

E T
∂ ∂

P T
∂ ∂

E ρ∂ ∂

P ρ∂ ∂
2 E T ρ
∂ ∂
2P T ρ
∂ ∂

∂

∂

Consistency

2

2

2

2

2

2

2

4

4

2

2

2

2

2

2

2

3.9

3.9

4

4

4

4

2

2

4

2

2

1

1

1

1

1

1

1

3

3

2

2

2

2

2

2

2.1

4

4

3

3

3

3.9

2.9

2.9

3.1

4.3

4.4

3.3

3.4

3.4

3.6

2.2

2.4

3.4

 

Table 3. 
 

tre

3.9

4.1

2

2

2

2

2

2

 

 

11 

Table 3. Convergence rate for various method on biquartic EOS (25). Linear local 
regression can not compute second derivatives accounting for vacancies in column 2. 
Tuned regression gets consistency to round-off, so no convergence figure appears in its 
column. “Biherm” denotes bicubic hermitian. 

lre1

lre2

bilinear

biquad

bicubic

biherm

E

P

E T
∂ ∂

P T
∂ ∂

E ρ∂ ∂

P ρ∂ ∂
2 E T ρ
∂ ∂
2P T ρ
∂ ∂

∂

∂

Consistency

0.4

0.2

0.9

0.6

0.6

0.8

0.9

0.7

0.5

0.4

0.6

1

0.8

0.8

0.7

1.1

1.3

0.2

Table 4. 
 

lre3

0.9

1

1

1.3

0.8

1.5

1.4

1.6

0.1

tre

0.4

0.4

1

0.6

0.9

0.7

1.1

1.3

-15.5
 

0.4

0.3

0.9

0.3

0.6

0.9

1.3

1.4

0.1

0.4

0.4

0.8

0.1

0.3

0.9

1.1

1.2

0

0.1

0.6

-0.2

0.1

0.7

0.7

1

1.2

1.4

2.8

3.3

3

3.2

2.3

2.9

3

-0.1

-0.3

 

Table 4. Extrapolated 

log

yΔ =

0

 intercept of convergence curves similar to those of Fig. 

8. For methods of like order of convergence, these figures indicate relative accuracy. 
“Biherm” denotes bicubic hermition. 

8. MESHFREE ILLUSTRATION 

S

310

SPε =

Finally, in Fig. 9(a), we show the molybdenum table 2984 sampled at 21583 random 
points  uniformly  distributed  across  the  full  range  of  temperature  and  density  using  the 
log-log  TRE  of  section  5  with 
,  which  flattens  the  graphs  of  ηand 
= −
ζ compared to Fig. 3. Each point is colored with the value ofζ obtained from TRE. This 
data is then used as an input “table” for resampling at a finer uniform random distribution 
of 64749 points, again using log-log TRE. The results are plotted in Fig. 9(b) and exhibit 
the expected behavior. The consistency error was zero to fifteen decimal places as with 
the other TRE examples. The significance of the meshfree nature of TRE for EOS data is 
that traditional rectangular-grid tables may be supplemented with extra data points near 
Maxwell  construction  or  phase  change  boundaries  to  achieve  greater  resolution  near 
these discontinuities with no loss of consistency or accuracy.  

9. CONCLUSION 

We have shown that traditional numerical derivatives of equation of state tables do 
not simultaneously satisfy the thermodynamic consistency and stability conditions, and 
that a tractable method to do so can be developed from the tuned regression estimator.  
The LORELI implementation has demonstrated the reproducing property for quadratic 
analytic EOS’s which satisfy the consistency and stability conditions. Trials on a few 
SESAME tables have shown that the consistency and stability constraints can be 
simultaneously enforced to round-off without sacrificing accuracy and that theoretical 
values for γand  G  are approached at high temperature. Versions of the theory and 

 

12

software were developed for flat, semi-log, and log-log coordinates, the last being 
necessary to handle tables with exponential grids. The convergence rates follow those of 
the statistical local regression estimator, giving fourth order for zeroth derivatives, and 
second order for first and second derivatives. The TRE method is apparently much more 
expensive than traditional derivatives, however. The meshfree character of the TRE 
method was convincingly demonstrated and provides a basis for augmenting 
conventional tables with extra data points near physical discontinuities. There are 
outstanding issues regarding phase boundaries, Maxwell constructions, and table-edge 
drop-offs which require further research before the technique can be made into a fully 
robust tool. 

13 

 

APPENDIX: RESIDUAL EXPRESSIONS 

The residual for the consistency constraint given in (15a) is  

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

W11
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

Γ1

Γ3

Γ2

(cid:3)

P11 Γ0
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) Γ0

(cid:3) P23 Γ2 (cid:3) P24 Γ3 (cid:3) P25 Γ4 (cid:3) P26 Γ5

(cid:3) P12 Γ1 (cid:3) P13 Γ2 (cid:3) P14 Γ3 (cid:3) P15 Γ4 (cid:3) P16 Γ5

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U11 (cid:3)
(cid:3)
P22 Γ1
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
P44 Γ3
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

W22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U12 (cid:3)
(cid:3)
(cid:2)
(cid:5)
(cid:5)
(cid:4)(cid:4)(cid:4)(cid:5)U14 (cid:3)
(cid:7)(cid:7)(cid:7) (cid:3) Γ4
(cid:7)(cid:7)(cid:7) (cid:3) Γ5
(cid:6)
(cid:3)
(cid:6)
(cid:2)
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)U21 Ρ2 (cid:3) P13 Γ7 Ρ2 (cid:3) P14 Γ8 Ρ2 (cid:3) P15 Γ9 Ρ2 (cid:3) P16 Γ10 Ρ2 (cid:5) U13 (cid:3)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)
(cid:3)
P11 T 2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

P35 Γ4 (cid:3) P36 Γ5 (cid:3) (cid:8)T P11 Ρ2 (cid:3) P12 Ρ2 (cid:9) Γ6

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)
P55 Γ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)T U21 (cid:5) U22 (cid:3)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)
P11 Ρ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P45 Γ4 (cid:3) P46 Γ5

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U15 (cid:3)
(cid:3)

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3) Γ6
(cid:6)

(cid:3) P56 Γ5

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)

(cid:8)T P13 (cid:3) P23 (cid:9) Γ7 (cid:3) (cid:8)T P14 (cid:3) P24 (cid:9) Γ8 (cid:3) (cid:8)T P15 (cid:3) P25 (cid:9) Γ9 (cid:3) (cid:8)T P16 (cid:3) P26 (cid:9) Γ10

P66 Γ5
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U16

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:3)

P33
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ2 (cid:3) P34 Γ3 (cid:3)
(cid:6)

(cid:3) P12 T (cid:3)

P22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ6 (cid:3)
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

Γ7

Γ9

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U23 (cid:3)
(cid:3)
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U25 (cid:3)
(cid:3)

P33 Γ7
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
P55 Γ9
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P34 Γ8 (cid:3) P35 Γ9 (cid:3) P36 Γ10

(cid:3) P56 Γ10

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ10
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)

P66 Γ10
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U26

(cid:5)
(cid:7)(cid:7)(cid:7)
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ8
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U24 (cid:3)
(cid:3)

P44 Γ8
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P45 Γ9 (cid:3) P46 Γ10

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

with  

(cid:2) (cid:2) (cid:2)
(cid:4)(cid:4)
(cid:3)

Γ0

Γ5
Γ2 Ρ2 (cid:5) T Γ6 Γ6 Γ7 Γ8 Γ9 Γ10

Γ1 Γ2 Γ3 Γ4

(cid:5)
(cid:7)(cid:7)
(cid:6)

. 

The residual for the constraints (15)(a) and (b) active is  

W11
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

Γ2

Γ1

(cid:3)

P11 Γ0
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) Γ0

(cid:3) P13 Γ1 (cid:3) P14 Γ2 (cid:3) P15 Γ3 (cid:3) P16 Γ4

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U11 (cid:3)
(cid:3)
P44 Γ2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

W22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U14 (cid:3)
(cid:3)
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)U21 Ρ2 (cid:3) P13 Γ6 Ρ2 (cid:3) P14 Γ7 Ρ2 (cid:3) P15 Γ8 Ρ2 (cid:3) P16 Γ9 Ρ2 (cid:5) U13 (cid:3)
(cid:3)

(cid:3) P45 Γ3 (cid:3) P46 Γ4

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U15 (cid:3)
(cid:3)

P55 Γ3
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ3
(cid:6)

(cid:3) P56 Γ4

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)
(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ4
(cid:6)
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)
P11 Ρ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

P66 Γ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3)

P33
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U16

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)
(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ1 (cid:3) P34 Γ2 (cid:3)
(cid:6)

P35 Γ3 (cid:3) P36 Γ4 (cid:3) (cid:8)T P11 Ρ2 (cid:3) P12 Ρ2 (cid:9) Γ5

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3) Γ5
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)T U21 (cid:5) U22 (cid:3)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)

P11 T 2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P12 T (cid:3)

P22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ5 (cid:3)
(cid:6)

(cid:8)T P13 (cid:3) P23 (cid:9) Γ6 (cid:3) (cid:8)T P14 (cid:3) P24 (cid:9) Γ7 (cid:3) (cid:8)T P15 (cid:3) P25 (cid:9) Γ8 (cid:3) (cid:8)T P16 (cid:3) P26 (cid:9) Γ9

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

Γ6

Γ8

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U23 (cid:3)
(cid:3)
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U25 (cid:3)
(cid:3)

P33 Γ6
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
P55 Γ8
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P34 Γ7 (cid:3) P35 Γ8 (cid:3) P36 Γ9

(cid:3) P56 Γ9

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ9
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)

P66 Γ9
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U26

(cid:5)
(cid:7)(cid:7)(cid:7)
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ7
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U24 (cid:3)
(cid:3)

P44 Γ7
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P45 Γ8 (cid:3) P46 Γ9

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

with 

(cid:2) (cid:2) (cid:2)
(cid:4)(cid:4)
(cid:3)

Γ0

0 Γ1 Γ2 Γ3 Γ4
Γ1 Ρ2 (cid:5) T Γ5 Γ5 Γ6 Γ7 Γ8 Γ9

(cid:5)
(cid:7)(cid:7)
(cid:6)

. 

 The residual for the constraints (15)(a) and (c) active is  

  (A1) 

(A2) 

 

(A3) 

(A4) 

 

14

W11
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3)

W22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U12 (cid:3)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U15 (cid:3)
(cid:3)

(cid:3) Γ0

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U11 (cid:3)
(cid:3)
P22 Γ1
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
P55 Γ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

Γ1

Γ4

P16 Γ9 Ρ2 (cid:5) U13 (cid:3)

Γ6

Γ7

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)T U21 (cid:5) U22 (cid:3)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U24 (cid:3)
(cid:3)

P44 Γ7
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

P11 Ρ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)
P11 T 2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

P11 Γ0
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P12 Γ1 (cid:3) P13 Γ2 (cid:3) P14 Γ3 (cid:3) P15 Γ4 (cid:3) P16 Γ5

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:3) P23 Γ2 (cid:3) P24 Γ3 (cid:3) P25 Γ4 (cid:3) P26 Γ5

(cid:3) P56 Γ5

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ5
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)

P66 Γ5
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U16

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ2
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U14 (cid:3)
(cid:3)

P44 Γ3
(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ3
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
(cid:6)
2
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)U21 Ρ2 (cid:3) P14 Γ7 Ρ2 (cid:3) P15 Γ8 Ρ2 (cid:3)
(cid:3)

(cid:3) P45 Γ4 (cid:3) P46 Γ5

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:3)

P33
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ2 (cid:3) P34 Γ3 (cid:3) P35 Γ4 (cid:3) P36 Γ5 (cid:3) (cid:8)T P11 Ρ2 (cid:3) P12 Ρ2 (cid:9) Γ6
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:3) P12 T (cid:3)

P22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ6 (cid:3) (cid:8)T P14 (cid:3) P24 (cid:9) Γ7 (cid:3) (cid:8)T P15 (cid:3) P25 (cid:9) Γ8 (cid:3) (cid:8)T P16 (cid:3) P26 (cid:9) Γ9
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:3) P45 Γ8 (cid:3) P46 Γ9

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ8
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U25 (cid:3)
(cid:3)

P55 Γ8
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P56 Γ9

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ9
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)

P66 Γ9
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U26

(cid:5)
(cid:7)(cid:7)(cid:7)
(cid:6)

(cid:2) (cid:2) (cid:2)
(cid:4)(cid:4)
(cid:3)

Γ0

Γ2 Ρ2 (cid:5) T Γ6 Γ6

Γ1 Γ2 Γ3 Γ4 Γ5
0 Γ7 Γ8 Γ9

(cid:5)
(cid:7)(cid:7)
(cid:6)

. 

The residual for the constraints (15)(a), (b) and (c) active is  

W11
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P13 Γ1 (cid:3) P14 Γ2 (cid:3) P15 Γ3 (cid:3) P16 Γ4

(cid:3)

(cid:3) Γ0

P11 Γ0
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U11 (cid:3)
(cid:3)
P44 Γ2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

W22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2
P55 Γ3
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U14 (cid:3)
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
(cid:3)
2
(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)U21 Ρ2 (cid:3) P14 Γ6 Ρ2 (cid:3) P15 Γ7 Ρ2 (cid:3) P16 Γ8 Ρ2 (cid:5) U13 (cid:3)
(cid:3)

(cid:3) P45 Γ3 (cid:3) P46 Γ4

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U15 (cid:3)
(cid:3)

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ3
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)
(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ4
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)
(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ1 (cid:3)
(cid:6)

(cid:3) P56 Γ4

P11 Ρ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3)

P33
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

P66 Γ4
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U16

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

P34 Γ2 (cid:3) P35 Γ3 (cid:3) P36 Γ4 (cid:3) (cid:8)T P11 Ρ2 (cid:3) P12 Ρ2 (cid:9) Γ5

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)
(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)T U21 (cid:5) U22 (cid:3)
(cid:3)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:4)
(cid:3)

P11 T 2
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P12 T (cid:3)

P22
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) Γ5 (cid:3) (cid:8)T P14 (cid:3) P24 (cid:9) Γ6 (cid:3) (cid:8)T P15 (cid:3) P25 (cid:9) Γ7 (cid:3) (cid:8)T P16 (cid:3) P26 (cid:9) Γ8
(cid:6)

(cid:5)
(cid:7)(cid:7)(cid:7)(cid:7) (cid:3)
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U24 (cid:3)
(cid:3)

P44 Γ6
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P45 Γ7 (cid:3) P46 Γ8

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ7
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)(cid:5)U25 (cid:3)
(cid:3)

P55 Γ7
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:3) P56 Γ8

(cid:5)
(cid:7)(cid:7)(cid:7) (cid:3) Γ8
(cid:6)

(cid:2)
(cid:4)(cid:4)(cid:4)
(cid:3)

P66 Γ8
(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)(cid:2)
2

(cid:5) U26

(cid:5)
(cid:7)(cid:7)(cid:7)
(cid:6)

(cid:2) (cid:2) (cid:2)
(cid:4)(cid:4)
(cid:3)

Γ0

Γ1 Ρ2 (cid:5) T Γ5 Γ5

0 Γ1 Γ2 Γ3 Γ4
0 Γ6 Γ7 Γ8

(cid:5)
(cid:7)(cid:7)
(cid:6)

. 

(A5) 

(A6) 

(A7) 

(A8) 

 

with 

Γ2

Γ1

Γ5

Γ6

 

with 

15 

 

 

REFERENCES 

[1] J. Von Neumann and R. D.Richtmeyer, J. Appl. Phys. 21, 232 (1950) 

[2] S.K.Godunov, Mat. Sb. 47, 271 (1959) 

[3] C. Hirsch, Numerical Computation of Internal and External Flows (John Wiley & 

Sons, New York, 1990) Vol. 2,  

[4] E.F. Toro, Riemann Solvers and Numerical Methods for Fluid Dynamics (Springer-

[5] R.J. Leveque, Finite Volume Methods for Hyperbolic Problems (Cambridge 

Verlag, New York, 1997) 

University Press, 2002 

[6] G.H.Miller and Puckett E.G., J. Comp. Phys. 128, 134 (1996)  

[7] Shyue, K.M., J. Comp. Phys. 171, 678 (2001) 

[8] K. S. Holian, ed., T-4 Handbook of Material Properties Data Bases, Los Alamos 

National Laboratory Report LA-10160-MS, 1984 (unpublished) 

[9] S.P.Lyon and J.D.Johnson, SESAME: The Los Alamos National Laboratory Equation 
of State Database, Los Alamos National Laboratory Report LA-UR 92-3407, 1992 
(unpublished) 

[10] R.Menikoff and B.J. Plohr, Rev Mod Phys 61, 75 (1989) 

[11] D.A.Pimentel, EOSPAC 5 User Manual, Los Alamos National Laboratory Report 

LA-UR 03-4510, 2003 (unpublished) 

[12] F. N. Fritsch, The LEOS Interpolation Package, Lawrence Livermore National 
Laboratory Report UCRL-ID-148554-REV-1, March 12, 2003 (unpublished) 

[13] G.A.Dilts, A.Haque and J. Wallin, in Meshfree Methods for Partial Differential 

Equations, edited by M. Griebel and M. A. Schweitzer, Lecture Notes in 
Computational Science and Engineering 26, (Springer-Verlag, Berlin, 2002) 

[14] J. Fan and I. Gijbels, Local Polynomial Modeling and Its Applications (Chapman 

and Hall, London, 1996)  

[15] T. Belytschko, Lu, Y.Y., and Gu, L., Int. J. Num. Meth. Eng. 37, 229 (1994) 

[16] Wolfram Research, Inc., Mathematica, Version 5.0, Champaign, IL (2003) 

 

16

FIGURES 

FIG. 1. TRE result for  P ρ∂

∂  with consistency and stability constraints active. Note flat 

annulus at low temperature caused by activation of stability constraint (box).

 

17 

 

FIG. 2. Error for Oxygen table 5011 when input grid equals output grid. (a) Energy. (b) 
Pressure. 

                 

 

 

18

 

 

       

      

 

FIG. 3. Results of log-log TRE on table 2984. 75 x 135 grid. (a) Log of shifted energy. 
(b) Log of shifted pressure. 

19 

 

 

FIG. 4.  η

∂ ∂ from log-log TRE on table 2984.  

        
τ

 

 

20

 
∂  or 
FIG. 5. Dimensionless derivatives by log-log TRE on table 2984 multiplied by  η τ∂
its square. (a) Log-scale of  η
.  (d) Log-scale of (

τ γ
. (b) Log-scale of  η
)2

∂ ∂ Γ .  (c) Log-scale of 

∂ ∂
η

∂ ∂
η

∂ ∂

G . 

    

g

τ

τ

τ

21 

 

 

 

 

FIG. 6. Plot of γ using EOSPAC derivatives for table 2984. 

 

22

 

FIG. 7. Comparison of EOSPAC and TRE values of γ at 

T =

2 ev, 1 kev, 100 kev

. 

23 

 

 

 

 

FIG. 8. Error of various methods on analytic EOS of (25) as a function of  mesh spacing 
in the input table for ζ and consistency.  

 

 

 

24

 

 

 

(a)

 (b) 

FIG. 9. (a) SESAME table 2984 sampled at 21583 uniformly distributed random points 
using log-log TRE. (b) Sampling of the data from (a) at 64749 different uniformly 
distributed random points using log-log TRE. In these examples 

. Each 

310

= −

SPε =

S

point is colored with the value of the interpolant. 

25 

 

