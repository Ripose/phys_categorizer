On the calculation of diffusion coefﬁcients in conﬁned ﬂuids and interfaces

with an application to the liquid-vapor interface of water

Pu Liu, Edward Harder, and B. J. Berne

Department of Chemistry and Center for Bimolecular Simulation

3000 Broadway, New York, New York 10027

Columbia University

(November 17, 2003)

Abstract

We propose a general methodology for calculating the self-diffusion tensor from

molecular dynamics for a liquid with a liquid-gas or liquid-solid interface. The stan-

dard method used in bulk ﬂuids, based on computing the mean square displacement

as a function of time and extracting the asymptotic linear time dependence from this,

is not valid for systems with interfaces or for conﬁned ﬂuids. The method proposed

here is based on imposing virtual boundary conditions on the molecular system and

computing survival probabilities and speciﬁed time correlation functions in different

layers of the ﬂuid up to and including the interfacial layer. By running dual simula-

tions, one based on MD and the other based on Langevin dynamics, using the same

boundary conditions, one can ﬁt the Langevin survival probability at long times to

the MD computed survival probability, thereby determining the diffusion coefﬁcient

as a function of distance of the layers from the interface. We compute the elements

of the diffusion tensor of water as a function of distance from the liquid vapor inter-

face of water. Far from the interface the diffusion tensor is found to be isotropic, as

(cid:0)(cid:2)(cid:1)

expected, and the diffusion coefﬁcient has the value

.22 ˚A

/psec in agreement

with what is found in the bulk liquid. In the interfacial region the diffusion tensor

1

(cid:3)
(cid:0)(cid:5)(cid:4)(cid:6)(cid:1)

(cid:0)(cid:8)(cid:7)(cid:9)(cid:1)

is axially anisotropic, with values of

. 8 ˚A

/psec and

. 5 ˚A

/psec for the

components parallel and normal the interface surface respectively. We also show that

diffusion in conﬁned geometries can be calculated by imposing appropriate bound-

ary conditions on the molecular system and computing time correlation functions

of the eigenfunctions of the diffusion operator corresponding to the same boundary

conditions.

2

(cid:3)
(cid:3)
I. INTRODUCTION

Molecular dynamics (MD) computer simulations provide a powerful tool for analyzing macro-

scopic transport coefﬁcients like diffusion at a microscopic level. The use of computer simulation

(cid:10)(cid:12)(cid:11)

to analyze the properties of water is a common tool

and the calculation of the self-diffusion

coefﬁcient from simulation has yielded consistent results to experiment for modern water mod-

els.

In uniform ﬂuids, two methods have been used to compute the self-diffusion coefﬁcient from

molecular dynamics trajectories. In one of these methods, one computes the mean-square dis-

(cid:14)(cid:16)(cid:15)(cid:18)(cid:17)(cid:20)(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

(cid:3)(cid:26)(cid:25)

placement (MSD) of the molecules,

as a function of time and ﬁts this to the asymptotic

time dependence predicted from the diffusion equation,

(cid:14)(cid:27)(cid:15)(cid:28)(cid:17)(cid:29)(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

(cid:21)(’

(cid:25) (cid:31)"!$#&%

(1)

(2)

This is the Einstein relation, from which the diffusion coefﬁcient can in turn be expressed in terms

of the MD calculated autocorrelation function of the velocity, giving the Green-Kubo relation,

+(cid:28),

%(cid:2))

(cid:21)((cid:14)

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)/.

(cid:19)(cid:16)0(cid:20)(cid:23)

v

v

where

is the dimensionality of the system. These methods are derived from the ordinary diffusion

equation with free boundary conditions and are thus only suitable for calculations in homogeneous

ﬂuids.

If, instead, we wish to determine the diffusion coefﬁcient of liquids conﬁned to cavities, or

in inhomogeneous regions such as, for example, either the air-water interface or the interface

between water and various solids,

neither the Einstein relation nor the Kubo relation are valid

–

approaches. In conﬁned liquids the mean square displacement will be bounded by the size of

the conﬁned region and it will be difﬁcult to unambiguously ﬁnd the diffusion coefﬁcient. In

inhomogeneous systems, molecules will stay in the region of interest only for a ﬁnite time and then

will explore other regions. Since the diffusion coefﬁcient will be different for different regions, the

time dependence of the MSD, computed for particles initially in the region of interest, will only

become linear at times long enough for the molecules to sample all regions, and then its slope will

give the diffusion coefﬁcient averaged over all regions. How then will we be able to determine the

3

(cid:3)
(cid:13)
(cid:3)
*
#
-
#
(cid:25)
#
1
2
diffusion coefﬁcient for the region of interest. Moreover for such systems the spatial distribution

at equilibrium will not be uniform and the appropriate phenomenological equation will be the

Smoluchowski equation and not the free diffusion equation from which the Einstein relation is

derived.

In this paper we present various strategies for determining the diffusion coefﬁcients

in such systems. In the case of a liquid vapor interface, the asymmetry of the interface region

introduces unique features in interfacial self diffusion. Special care is required in the analysis of

such properties and necessitates an accurate determination of the diffusion tensor in the interfacial

region.

Since the simple diffusion equation is not valid for conﬁned or inhomogeneous systems a

new approach is necessary. In the methods proposed here we make use of molecular dynamics

with virtual boundary conditions. Lacking new methods, Eqs. (1) and (2) have been used in the

past and continue to be applied to the interfacial region of liquids. When used for interfaces,

the system is divided into layers. The MSD for particles in any layer is calculated even if their

trajectories carry them out of the layer. If the layer is thin, the linear time dependence will reﬂect

diffusion in neighboring layers as well. Moreover in the interfacial layer the molecules will be

diffusing according to the Smolochowski equation, not the free diffusion equation, so that use of

the Einstein relation to determine the diffusion coefﬁcient is questionable.

This article introduces a new methodology for calculating the diffusion tensor in an inhomo-

geneous system in Section II and applies this methodology to the study of the air-water interface

in Section III. The methodology is different for diffusion in a direction perpendicular to the in-

terface than for a direction parallel to the interface. In both cases we introduce virtual absorbing

boundaries at the boundaries of layers. For determination of the diffusion coefﬁcient parallel to the

interface,

, we generalize the Einstein relation and show that the MSD of particles that remain

(cid:19)(cid:22)(cid:21)4(cid:23)

!(cid:20)3

in the layer asymptotically varies as

(cid:19)(cid:22)(cid:21)4(cid:23)

, so that an MD determination of the survival

probability in the layer,

, and the MSD allows determination of the parallel component of

the diffusion tensor. For determination of the diffusion coefﬁcient perpendicular to the interface

we propose a dual simulation technique. The gist of this method is to perform MD with virtual

absorbing boundary conditions at each layer and to perform a sequence of Langevin dynamics sim-

4

%
(cid:4)
(cid:31)
%
(cid:4)
(cid:21)
3
ulations each with the potential of mean force determined from the MD, but with different values

of friction coefﬁcient

characterizing motion in a direction perpendicular to the interface. One

can ﬁnd the value of the friction coefﬁcient that gives the best ﬁt of the Langevin survival proba-

bility in a layer to that found by MD for that layer.

)76$8/9;:

can then be found from the Stokes-Einstein

relation,

. This “Dual Simulation Method” requires a rather subtle deﬁnition of the

boundaries for the Langevin dynamics. We also show that, in some cases, we can determine the

diffusion coefﬁcient for ﬂuids in conﬁned geometries as well as for

in layers with absorbing

boundary conditions from a computation of the autocorrelation function of the eigenfunctions of

the diffusion operator corresponding to these boundary conditions. The various approaches are

tested in a variety of ways.

This study was motivated by our interest in water hydrogen bond dynamics in the liquid-vapor

interface.

Previous studies have shown that diffusion makes an important contribution to the

(cid:10)(cid:12)(cid:10)

hydrogen-bond dynamics.

Before understanding hydrogen bond dynamics in interfaces we must

understand diffusion there. Thus we apply our methodology to the liquid-vapor interface of liquid

water.

II. METHODOLOGY

Since the presence of the interface breaks the symmetry of the liquid, diffusion in such a system

is described by an anisotropic Smoluchowski equation:

<(cid:20)=?>

(cid:19)(cid:30)@BAC(cid:21)ED

@GFHAC(cid:21)

.EJK.HL

(cid:19)(cid:27)S&(cid:23)C(cid:23)(cid:16)T

(cid:19)(cid:30)@BAC(cid:21)ED

@EF(cid:29)AU(cid:21)

)7I

INMPO

IRQ

(3)

(cid:19)(cid:22)@BAC(cid:21)ED

@EF(cid:29)AC(cid:21)(cid:12)V(cid:26)(cid:23)

where

is the conditional probability distribution function, and

is the diffusion ten-

sor. Taking the z-axis to be perpendicular and the x and y axes to lie parallel to the interface, a

system with a ﬂat interface will be axially symmetric around the z-axis. The equilibrium density

-ZY\[B]

WX(cid:19)(cid:16)S&(cid:23)

(cid:19)(cid:16)S&(cid:23)C(cid:23)

(cid:19)(cid:16)S&(cid:23)

O(cid:6)Q

(cid:19)U^

proﬁle along the z direction is given by

WX(cid:19)(cid:16)S&(cid:23)

, where

is the potential

of mean force (PMF). The density

is easily determined by MD and from this the PMF can

)a%(cid:8)b(cid:24)bc)d%(cid:8)e(cid:12)e

%(cid:8)_(cid:27)_P‘

be determined. The diffusion tensor will be diagonal in this frame with

. In

5

5
(cid:7)
%
(cid:7)
%
(cid:7)
5
(cid:7)
%
(cid:7)
(cid:10)
-
-
(cid:23)
(cid:19)
>
-
(cid:23)
>
J
)
W
Q
general the diffusion coefﬁcients will be a function of

; however, if we study molecules in suf-

ﬁciently thin layers parallel to the interface, we expect the diffusion coefﬁcients not to vary with

z within a layer, but of course they may vary from layer to layer, especially as we approach the

interfacial region. The Smoluchowski equation will then be separable in each layer. In this case

the Smoluchowski equation in each layer will be separable in x, y and z. The original equation (3)

can be decomposed into three independent equations:

<(cid:20)=f>

(cid:19)(cid:16)ghAC(cid:21)EDig

AU(cid:21)

(cid:19)(cid:27)gkAU(cid:21)GD

AC(cid:21)

(cid:23)lA

)j%(cid:8)b(cid:24)b

<(cid:29)=f>

(cid:19)(cid:27)mnAC(cid:21)ED

AU(cid:21)

(cid:19)(cid:16)mXAC(cid:21)EDim

AC(cid:21)

(cid:23)(cid:24)A

)j%(cid:8)e(cid:12)e

(cid:19)(cid:27)SoAC(cid:21)EDiS

AU(cid:21)

(cid:19)(cid:27)S&(cid:23)C(cid:23)(cid:16)T

(cid:19)(cid:27)SoAC(cid:21)EDiS

AU(cid:21)

(cid:23)(cid:24)A

)j%

_(cid:16)_

MPO

where,

(cid:19)(cid:30)@BAC(cid:21)ED

@EF(cid:29)AC(cid:21)(cid:12)V((cid:23)

(cid:19)(cid:16)SoAU(cid:21)GD

S\V\AC(cid:21)(cid:12)V(cid:26)(cid:23)

(cid:19)(cid:27)mnAC(cid:21)ED

mGV\AU(cid:21)pV((cid:23)

(cid:19)(cid:16)ghAC(cid:21)EDigoV\AU(cid:21)pV((cid:23)(cid:24)’

In order to analyze the dependence of diffusion on position relative to the interface we derive

and compute the components of the diffusion tensor for ﬁnite regions that range from the bulk

water phase to the interface. Any molecule initially present in a speciﬁed region that passes the

boundaries no longer contributes to the calculation. In the coordinates parallel to the interface (

and

) water diffusion is unbounded. In the

direction, we can postulate the boundary condition:

(cid:19)(cid:16)g

AC(cid:21)(cid:24)(cid:23)

0BA

and the initial condition:

(cid:19)(cid:27)ghAC(cid:21)EDig

AC(cid:21)

(cid:19)(cid:16)g|^}g

(cid:23)(cid:24)’

){z

rtsvu

=twx=fy

The same can be done for diffusion along the

-direction. Without loss of generality we take

in the following. Combined with Eqs. (4) and (5), we can get the familiar results for diffusion in

the x and y directions: >

(cid:19)(cid:16)ghAC(cid:21)EDig

Al0(cid:20)(cid:23)

(cid:127)H(cid:128)

Y(cid:129)[&](cid:9)(cid:130)

(cid:19)(cid:16)g|^}g

%(cid:8)b(cid:24)b

%(cid:8)b(cid:24)b

(cid:21)K(cid:131)

(cid:19)(cid:27)mnAC(cid:21)ED

Al0(cid:20)(cid:23)

(cid:127)H(cid:128)

Y\[&](cid:133)(cid:130)

(cid:19)(cid:27)m(cid:5)^Pm

%(cid:8)epe

%(cid:8)e(cid:12)e

(4)

(5)

(6)

(7)

(8)

(9)

(10)

(11)

6

S
-
-
(cid:23)
<
(cid:3)
b
>
g
-
-
m
-
-
(cid:23)
<
(cid:3)
e
>
-
-
<
=
>
-
-
(cid:23)
<
_
L
<
_
(cid:19)
<
_
Q
>
-
-
>
)
>
>
>
g
m
g
>
(cid:31)
q
)
>
-
-
(cid:23)
-
m
(cid:21)
-
)
0
-
)
*
~
(cid:21)
^
-
(cid:23)
(cid:3)
(cid:127)
A
>
m
-
)
*
(cid:132)
(cid:21)
^
-
(cid:23)
(cid:3)
(cid:127)
(cid:21)
(cid:131)
’
A very similar approach can be used for ﬂuids in a conﬁned geometry. For example for a

uniform ﬂuid in a rectangular box with reﬂecting boundary conditions, one may ﬁnd the eigen-

functions and eigenvalues of the diffusion operator subject to reﬂecting boundary conditions at

the walls. Then the decay of the autocorrelation functions are exponential with well deﬁned time

constants. MD of a ﬂuid between reﬂecting walls can then be used to calculate these correlation

functions and from their exponential decay at long times one can ﬁnd the diffusion coefﬁcients.

In spherical cavities, one can solve the diffusion equation with reﬂecting boundary conditions.The

eigenfunctions are spherical Bessel functions multiplied by spherical harmonics.

A. Diffusion coefﬁcients parallel to the interface

In the water-vapor system, we apply virtual absorbing boundary conditions to the MD to lo-

calize the contributions to the diffusion coefﬁcient to our speciﬁed ﬁnite regions. These are virtual

in that they are applied only to the analysis of MD trajectories and not to the generation of these

(cid:134)(cid:136)(cid:135)

trajectories. The eigenfunctions

, of Eq. (6) subject to these boundary conditions and the eval-

)(cid:137)%(cid:8)_(cid:16)_

uation of the perpendicular component of the diffusion tensor,

, that follows will be

discussed shortly. First we will focus on the simpler problem of evaluating the parallel compo-

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

nent,

, of the diffusion tensor, which is equal to either

or

.

(cid:138)(cid:140)(cid:139)(cid:141)Sj(cid:139)(cid:143)(cid:142)

The probability for a particle to remain in this region,

, can be determined by

integrating the conditional probability over

+|(cid:144)

+(cid:18)(cid:144)

,

,

,

,

and

:

(cid:19)(cid:22)(cid:21)4(cid:23)

(cid:19)(cid:16)SoAC(cid:21)EDiS

A(cid:24)0(cid:20)(cid:23)

(cid:19)(cid:16)S

(cid:23)(cid:24)’

b(cid:24)b

e(cid:12)e

In order to calculate the components

and

we formulate the mean square displacement

(cid:14)(cid:27)(cid:15)(cid:28)gh(cid:19)(cid:22)(cid:21)4(cid:23)

(cid:3)4(cid:25)(cid:147)(cid:146)

(cid:144)(cid:22)(cid:148)

for a ﬁnite region. In the

(cid:149)(cid:150)(cid:138)nA(cid:24)(cid:142)\(cid:151)

direction the mean square displacement,

, of particles that

remain in region

is:

(cid:14)(cid:27)(cid:15)(cid:28)gh(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

@EF

(cid:19)(cid:30)@BAC(cid:21)ED

@EF(cid:29)AU(cid:21)pV((cid:23)

(cid:19)(cid:30)@EV\(cid:23)(cid:24)(cid:19)(cid:27)g(cid:28)^}goV(cid:26)(cid:23)(cid:147)(cid:152)

(cid:144)(cid:22)(cid:148)

(12)

(13)

It is important to note that

){!(cid:20)3

%(cid:8)b(cid:24)b

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

(cid:21)(cid:26)’

(cid:14)(cid:16)(cid:15)(cid:18)S

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)(cid:16)(cid:21)

)7!(cid:29)%(cid:8)_(cid:16)_$3

.

7

%
(cid:7)
%
(cid:4)
g
g
-
m
m
-
S
-
S
3
)
(cid:145)
#
S
(cid:145)
#
S
-
>
-
>
-
%
%
g
(cid:145)
(cid:11)
(cid:3)
(cid:25)
(cid:146)
(cid:145)
(cid:11)
)
+
#
@
+
#
>
>
(cid:3)
(cid:25)
(cid:145)
(cid:11)
(cid:144)
‘
(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

The mean square displacement and the survival probability

(cid:153)(cid:154)(cid:19)(cid:30)(cid:21)(AC(cid:21)

M(cid:156)(cid:155)

are calculated from the simu-

(cid:149)(cid:150)(cid:138)XA(cid:24)(cid:142)\(cid:151)

lation as follows. Let

designate the set of all particles that stay in the layer

(cid:158)(cid:133)(cid:19)(cid:22)(cid:21)(cid:26)AU(cid:21)

M(cid:157)(cid:155)

M(cid:157)(cid:155)

during

the time interval between

(cid:158)(cid:159)(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

and

, let

be the number of such particles, and ﬁnally

let

designate the number of particles in the layer at time

. Then we compute:

(cid:14)(cid:16)(cid:15)(cid:18)gk(cid:19)

(cid:25)(cid:12)(cid:146)

(cid:19)(cid:16)g

(cid:19)(cid:22)(cid:21)

(cid:23)h^}g

(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)C(cid:23)

M«(cid:155)

(cid:144)(cid:22)(cid:148)

=t¢

=t¤&'(“

(cid:158)(cid:133)(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

£?⁄ƒ¥$§

and

(cid:158)(cid:159)(cid:19)(cid:30)(cid:21)(AC(cid:21)

M}(cid:155)

=t¢

(cid:158)(cid:133)(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

In the foregoing

%(cid:8)b(cid:24)b

is the total number of time steps averaged over. Thus we can obtain the

%(cid:8)e(cid:12)e

rtsvu

expression for

and similarly for

:

%(cid:8)b(cid:24)b

(cid:19)(cid:12)(cid:149)(cid:150)(cid:138)nAl(cid:142)‹(cid:151)(cid:29)(cid:23)

'(w

(cid:14)(cid:27)(cid:15)(cid:28)gh(cid:19)(cid:22)(cid:21)4(cid:23)

(cid:3)4(cid:25)(cid:147)(cid:146)

(cid:144)(cid:22)(cid:148)

!(cid:150)(cid:155)n3

It is important to note that the correlation functions deﬁned in Eq. (14) and Eq. (15) are not ordinary

two point correlation functions because the requirement that the particle be in the layer for the

M(cid:159)(cid:155)

whole time between

and

makes this a function of the whole history in this time interval and

M«(cid:155)

not just on its values at

and

.

B. The diffusion coefﬁcient perpendicular to the interface

It remains to discuss methods used to evaluate the component of the diffusion tensor perpen-

)›%(cid:8)_(cid:16)_

dicular to the interface,

. For ﬁnite regions sufﬁciently far away from the interface,

the density is uniform, the potential of mean force,

, is zero, and the Smoluchowski equation,

Eq. (6), reduces to the diffusion equation,

(cid:19)(cid:16)SoAC(cid:21)EDiS

AC(cid:21)

(cid:19)(cid:16)SoAU(cid:21)GD

AC(cid:21)

(cid:23)l’

)ﬁ%

_(cid:27)_

We can derive an analytical expression for the diffusion coefﬁcient with absorbing bound-

ary conditions by applying the commonly used Smoluchowski boundary condition deﬁned by

(cid:19)(cid:27)S(cid:176)^}S

(cid:138)nAC(cid:21)(cid:24)(cid:23)

(cid:19)(cid:27)SoAC(cid:21)

(cid:142)GAC(cid:21)(cid:24)(cid:23)

)ﬂz

A(cid:24)0(cid:29)(cid:23)

(cid:19)(cid:27)S

(cid:19)(cid:27)S

DiS

and

. The initial condition is

. Using the

8

(14)

(15)

(16)

(17)

3
(cid:23)
(cid:21)
(cid:21)
(cid:23)
(cid:21)
(cid:155)
(cid:23)
(cid:3)
(cid:145)
(cid:11)
)
*
9
(cid:160)
¡
(cid:10)
*
¡
=
(cid:11)
£
£
(cid:3)
A
3
(cid:19)
(cid:155)
(cid:23)
)
*
9
(cid:160)
¡
(cid:10)
(cid:23)
’
9
)
,
(cid:145)
(cid:11)
(cid:19)
(cid:155)
(cid:23)
’
(cid:21)
(cid:21)
(cid:21)
(cid:21)
%
(cid:7)
Q
<
=
>
-
-
(cid:23)
<
(cid:3)
_
>
S
-
-
>
)
)
0
>
)
)
0
>
-
-
-
(cid:23)
(18)

(20)

(21)

standard method of separation of variables,

we set

and solve Eq. (17) to

obtain the solution of the form:

(cid:19)(cid:16)SoAC(cid:21)EDiS

A(cid:24)0(cid:20)(cid:23)

(cid:134)(cid:181)·

(cid:19)(cid:16)S&(cid:23)U(cid:134)

(cid:19)(cid:16)S

(cid:19)C^(cid:5)(cid:19)(cid:27)¶

(cid:21)(cid:24)(cid:23)(cid:24)A

:(cid:150)•

_(cid:16)_

Y\[&]

(cid:19)(cid:16)SoAC(cid:21)EDiS

A(cid:24)0(cid:20)(cid:23)

(cid:19)(cid:16)S&(cid:23)(cid:30)†‡(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

)7–

where,

(cid:134)(cid:136)(cid:135)&(cid:19)(cid:27)S&(cid:23)

(cid:19)(cid:27)¶

(cid:19)(cid:27)S(cid:176)^}(cid:138)o(cid:23)

!(cid:29):$•„‚

:(cid:150)•

st”

are eigenfunctions of the diffusion operator satisfying the boundary conditions, where

.

The autocorrelation of any such eigenfunction is easily determined to be,

+|(cid:144)

+(cid:28)(cid:144)

(cid:14)p(cid:134)(cid:136)(cid:135)o(cid:19)(cid:27)So(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)C(cid:23)U(cid:134)

(cid:19)(cid:27)So(cid:19)(cid:16)0(cid:20)(cid:23)U(cid:23)

(cid:19)(cid:27)SoAC(cid:21)EDiS

AU(cid:21)

(cid:19)(cid:16)S

(cid:23)U(cid:134)»(cid:135)B(cid:19)(cid:27)S&(cid:23)C(cid:134)

(cid:19)(cid:16)S

(cid:25)(cid:6))

n=1,2...

(19)

•P)

(cid:142)x^}(cid:138)

“´`(cid:16)ˆ¯˜(cid:30)˜(cid:16)=

(cid:135)((cid:190)(cid:129)¿(cid:147)(cid:192)

•(cid:8)…E‰

(cid:19)(cid:16)S

Here

is the initial normalized probability distribution along

:$•

in the interval, which is a

uniform distribution (=

) in the bulk water regions.

The autocorrelation of the eigenfunction is easily determined from the simulation as,

(cid:14)p(cid:134)(cid:136)(cid:135)˘(cid:19)(cid:16)So(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)U(cid:23)C(cid:134)(cid:181)·

(cid:19)(cid:16)So(cid:19)(cid:27)0(cid:20)(cid:23)U(cid:23)

(cid:134)(cid:136)(cid:135)˘(cid:19)(cid:16)S

(cid:19)(cid:30)(cid:21)

(cid:23)C(cid:23)U(cid:134)(cid:181)·

(cid:19)(cid:27)S

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)U(cid:23)(cid:24)A

(cid:25)(cid:12)(cid:146)

M«(cid:155)

(cid:144)(cid:22)(cid:148)

=v¢

=t¤&'(“

(cid:158)(cid:133)(cid:19)(cid:22)(cid:21)4(cid:23)

£˙⁄¨¥$§

(cid:153)(cid:154)(cid:19)(cid:22)(cid:21)(cid:26)AU(cid:21)

M(cid:157)(cid:155)

(cid:149)(cid:150)(cid:138)nA(cid:24)(cid:142)\(cid:151)

where once again

designates the set of all particles that stay in the layer

(cid:158)(cid:133)(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

M}(cid:155)

during

the time interval between

and

,

is the number of particles in the layer at time

, and

is the total number of time steps averaged over.

Near the interface one must use the Smulochowski equation. Although not applied in this

paper, the eigenfunctions of for this equation (after being made self-adjoint) can easily be found

numerically. Evaluation of the autocorrelation function will again decay exponentially, allowing

one to determine the diffusion coefﬁcient as above.

Another route to determining the diffusion coefﬁcient, and the one adopted here, avoids solving

Eq. (6) directly, involves running Langevin dynamics simulations for the motion perpendicular to

the interface (the

direction) in parallel with our molecular dynamics simulations. This “dual

simulation method” is particularly useful for regions where the potential of mean force is non-

%(cid:8)_(cid:16)_

zero and one can no longer use the simple diffusion equation to solve for

. The Langevin

9

(cid:10)
(cid:3)
>
-
>
-
)
,
¡
(cid:135)
¢
(cid:10)
(cid:135)
(cid:135)
-
(cid:23)
(cid:128)
(cid:23)
(cid:3)
%
)
(cid:132)
(cid:128)
(cid:23)
A
·
(cid:135)
(cid:145)
#
S
(cid:145)
#
S
-
>
-
-
(cid:23)
>
-
·
(cid:135)
-
(cid:23)
)
*
§
’
>
-
(cid:23)
S
*
(cid:135)
(cid:145)
(cid:11)
)
*
9
(cid:160)
¡
(cid:10)
*
¡
=
(cid:11)
£
(cid:135)
£
(cid:23)
(cid:21)
(cid:21)
(cid:21)
9
S
equation for motion along the

direction is,

(cid:201)¸˚

(cid:19)(cid:27)S&(cid:23)

^(cid:204)5

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)lA

_(cid:16)_(cid:6)˝

M(cid:157)˛

(22)

(23)

where the ﬁrst term on the right is the mean force on the particle (arising from the presence of

(cid:19)(cid:16)S&(cid:23)

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

the interface) derived from the potential of mean force

,

is the random force which is

_(cid:16)_

assumed to be a Gaussian random process with a white noise spectrum, and

is the static fric-

tion coefﬁcient along the

-direction, which is related to the diffusion tensor through the Stokes-

Einstein relation:

_(cid:16)_ˇ)76$8—9(cid:209)%

_(cid:27)_

By comparing the survival probability, Eq. (15), determined from a full MD simulation with that

determined from an analogous Langevin dynamics (LD) simulation, we can determine the best-ﬁt

%(cid:8)_(cid:16)_

value for the diffusion coefﬁcient

. The dual simulation method proceeds as follows. One

computes the survival probability from both molecular dynamics and from a series of Langevin

%(cid:8)_(cid:16)_

simulations corresponding to different values of the diffusion coefﬁcient

(cid:138)R(cid:210)7S(cid:156)(cid:210)7(cid:142)

for a region deﬁned

by

. The correct value of the diffusion coefﬁcient is chosen to be the one that gives the

best ﬁt of the survival probability from LD to that from MD. As we show below, it will be necessary

to make corrections to the positions of the virtual absorbing boundaries in the LD simulations.

Another strategy, bearing a close connection to the above but not used in this study, is to

devise a dual simulation method in which one runs Smoluchowski dynamics (simulating the dif-

fusion process deﬁned by the Smoluchowski equation, unfortunately sometimes called Brownian

dynamics) in parallel with full MD. In this case one would use virtual absorbing boundaries for the

MD as deﬁned above, but with relevant corrections to the boundaries for the Smoluchowski dy-

namics (SD) simulation as discussed below. In fact whenever one calculates the time dependence

of dynamical properties that spring from the Smoluchowski or Langevin equation (LE), such as

the corresponding autocorrelation function of its eigenfunctions or survival probability, it will be

necessary to apply the relevant boundary corrections wherever the width of the layers appears

explicitly.

10

S
S
)
^
<
Q
<
S
S
Q
˛
5
S
5
‰
(cid:10)
’
C. Two corrections to the positions of the virtual boundaries

It is important to recognize that many dual simulation methods will require corrections to the

positions of the virtual absorbing boundaries.

Smoluchowski dynamics versus Langevin dynamics

In our molecular dynamics simulation of the air-water interface system the virtual absorbing

(cid:138)nAU(cid:21)4(cid:23)

(cid:142)EAC(cid:21)(cid:24)(cid:23)

(cid:211)\(cid:212)(cid:16)(cid:213)

(cid:211)\(cid:212)(cid:16)(cid:213)

(cid:19)(cid:16)S

(cid:19)(cid:16)S

boundary conditions are deﬁned by the ﬂux,

(cid:138)}(cid:210)dS}(cid:210)d(cid:142)

and

, for a region

(cid:211)\(cid:212)(cid:16)(cid:213)

(cid:19)(cid:16)S

deﬁned within

(cid:138)&(cid:17)EmXAC(cid:21)(cid:24)(cid:23)

(cid:142)((cid:214)G(cid:215)X¶

. Virtual absorbing boundaries are also deﬁned by the ﬂux,

, in Langevin dynamics. However in the Smoluchowski equation absorbing

(cid:138)B(cid:17)GmXAC(cid:21)EDiS

(cid:142)((cid:214)E(cid:215)X¶

A(cid:24)0(cid:20)(cid:23)

(cid:19)(cid:27)S

boundaries are deﬁned by the Smoluchowski boundary condition,

. The discrepancy between the Smoluchowski boundary condition for absorption and the real

(cid:10)(cid:27)(cid:216)

(cid:10)(cid:22)(cid:13)

absorbing boundary condition deﬁned by the ﬂux has been discussed at length.

(cid:10)(cid:22)(cid:13)

Waldenstrom

et. al.

have derived a correction factor for the width of the region, that equates the boundary

(cid:138)&(cid:17)EmXAC(cid:21)EDiS

(cid:142)((cid:214)G(cid:215)X¶

A(cid:24)0(cid:20)(cid:23)

(cid:211)\(cid:212)(cid:27)(cid:213)

(cid:19)(cid:16)S

condition

(cid:217)˙(cid:218)

(cid:217)´(cid:219)(cid:221)(cid:220)ƒ(cid:222)p(cid:223)

with the ﬂux boundary condition

M}!(cid:20)(cid:224)

–

:

(cid:224)Æ)d(cid:226)

:‹!$6$8—9;ª

_(cid:27)_

(24)

(25)

and where

is the corrected region width, necessary if one wants to use the Smoluchowski

boundary condition to solve the diffusion equation, (or run SD), for a simulation with boundary

)ﬂ•

(cid:211)\(cid:212)(cid:16)(cid:213)

(cid:220)ƒ(cid:222)p(cid:223)

condition

and width of length

.

Langevin versus Generalized Langevin Dynamics

Before proceeding we must determine if the static Langevin equation can accurately predict the

decay of either the survival probability or the decay of the autocorrelation function of any eigen-

function of the diffusion operator (or Smoluchowski operator) for thin layers of liquid. There is an

extensive literature showing that in real bulk liquids the generalized Langevin equation (GLE), not

11

=
)
)
0
=
)
)
0
=
)
#
)
0
>
)
#
-
)
0
>
)
#
-
)
0
=
)
0
¢
-
)
¢
-
A
(cid:128)
(cid:201)
%
(cid:3)
(cid:10)
¿
(cid:3)
A
(cid:217)
(cid:218)
¢
-
=
)
0
(cid:217)
(cid:219)
¢
-
the static friction LE, describes the single particle dynamics. For example, the velocity correlation

function exhibits marked deviations from the exponential decay predicted by the LE with static

friction. This arises from the fact that the correlation time of the force experienced by a particle is

of ﬁnite duration and not of zero duration as is implicit in the ordinary LE. The dynamic friction

in the GLE has an important affect on the mean square displacement. The memory effect in the

GLE leads to a mean-square displacement that initially increases faster than that predicted by the

LE with white noise friction. However, in the long time limit, the rate of increase of the MSD is

(cid:10)(cid:30)(cid:228)

the same for both the GLE and LE with the same static limit of the friction coefﬁcient.

The short

time discrepancy becomes important when one considers properties dependent on the boundary

such as the eigenfunction autocorrelation function or survival probability. Because the dynamics

predicted by the GLE leads to faster translational motion at short time than would be predicted by

the LE, particles described by the GLE initially distant from the boundaries eventually come close

to the boundaries, cross and are absorbed earlier than they would be if their motion was described

by the LE. In some sense we can regard the GLE as giving rise to a “jump distance”,

, that would

not be present in the LE simulation. Thus to a particle approaching an absorbing boundary the

position of the boundary will appear to be closer by the length

in GLE (or MD) as compared to

LE. To correct for this in the dual simulation method we propose to use an effective layer width for

the LE that is smaller than the width in the MD. This approach is similar in spirit to the correction

factor derived by Waldenstrom cf Eq. (24), discussed above,

(cid:217)v(cid:231)

(cid:192)(cid:150)(cid:230)

(cid:229)(cid:136)A

(cid:192)(cid:150)(cid:230)

where

is the corrected region width, (for two absorbing boundaries), necessary if one wants

to use the static LE (or the diffusion equation) in the dual simulation method and the width of the

region in MD is

(cid:14)(cid:16)(cid:15)(cid:18)S

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

. We conjecture that this jump distance is equal to the maximum difference

between

for the MD (or GLE) and LE simulations.

(26)

12

(cid:229)
(cid:229)
(cid:217)
)
ˆ
^
!
(cid:217)
(cid:217)
(cid:231)
ˆ
(cid:132)
(cid:3)
(cid:25)
III. THE APPLICATION TO THE VAPOR-WATER INTERFACE

A. The justiﬁcation of the memory effect correction

To test the validity of our conjecture, we ran stochastic molecular dynamics based on the GLE

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

_(cid:16)_

(cid:10)(cid:27)Ł

with memory friction

:

(cid:201)(cid:157)˚

(cid:19)(cid:16)S&(cid:23)

#(cid:29)(cid:155)

_(cid:16)_

M(cid:157)˛

(cid:19)(cid:30)(cid:21)—^

So(cid:19)

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)(cid:24)’

(27)

The Generalized Langevin dynamics (GLD) simulations were conducted with an exponential

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

-(Ø

_(cid:16)_

‰(cid:29)Œ

memory kernel

, where

is the static friction kernel corresponding to Eq. (23),

and

is the memory relaxation time. For a system with ﬁctitious absorbing boundaries at po-

(cid:142)ˇ^º(cid:138)

)(cid:237)(cid:236)

sitions

and

where

˚

, the survival probability is calculated. Langevin dynamics

(cid:142)(cid:136)^«(cid:229)

with the same static friction kernel and absorbing boundaries at positions

and

were

run varying

until the decay of the survival probability coincide for LD and GLD. The maximum

(cid:14)(cid:27)(cid:15)(cid:28)So(cid:19)(cid:22)(cid:21)4(cid:23)

difference in

for GLD and LD is computed and plotted in the Fig.[ 2](a) along with

as a function of the memory relaxation time. The two curves ﬁt with each other quite well, an

observation that supports our conjecture concerning the adjusted boundaries.

0$0

>˘(cid:239)

To provide further evidence for the conjecture, we run a

molecular dynamics simulation

(cid:10)(cid:30)(cid:240)

of a homogeneous isotropic sample of liquid water consisting of 256 TIP4P

water molecules with

periodic boundary conditions. From the velocity autocorrelation function, we adopt the method of

Berne and Harp

to calculate the friction kernel numerically, as shown in Fig. [ 2](b). We deter-

(cid:14)(cid:16)(cid:15)(cid:18)So(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

mined the maximum difference in

between GLD( with this empirical friction kernel)

0B’

*(cid:129)æ

and LD (with the corresponding static friction coefﬁcient), giving a value of

(cid:19)(cid:22)(cid:21)4(cid:23)

˚

. A plot of

the survival probability,

*\æ

, for this GLD with the empirical kernel, for the original MD and for

0&’

LD with width corrected by

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

˚

is given in Fig.[ 2](e). The close correspondence between

(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

(cid:192)(cid:150)(cid:230)

, determined from LD with the corrected width

, and

determined from either MD

or GLD ( with a friction kernel found from the MD) further justiﬁes are conjecture. [Agreement

between the original MD and GLD velocity autocorrelation functions and mean-square displace-

ments, and between the random force autocorrelation function used in the GLD and the friction

13

5
S
)
^
<
Q
<
S
^
+
=
-
5
(cid:155)
(cid:23)
˝
(cid:155)
(cid:23)
5
)
5
…
=
5
-
*
:
Ø
(cid:138)
(cid:142)
’
(cid:127)
(cid:238)
(cid:138)
M
(cid:229)
(cid:229)
(cid:132)
(cid:3)
(cid:25)
(cid:229)
(cid:127)
(cid:10)
2
(cid:132)
(cid:3)
(cid:25)
(cid:229)
)
(cid:238)
3
(cid:229)
)
(cid:238)
3
(cid:217)
3
kernel found from MD shown in Fig. [ 2](b)(c)(d), demonstrates the accuracy of this test of our

above conjecture.] Given the validity of this conjecture, we can now ﬁt the friction coefﬁcient

in LD simulations with corrected boundary conditions to MD using the dual method described

before. We do not need to determine the explicit time dependence of the friction kernel.

B. The parallel components

Before applying Eq. (16) to a liquid with an interface, we ﬁrst test this approach on the same

bulk water system used in our justiﬁcation of the correction factor. We compute the diffusion

’?(cid:242)

coefﬁcients in slabs of water of width

0ı(cid:244)(cid:159)0&’˙0

%(cid:8)b(cid:24)b(cid:243))

0B’

(cid:3)(cid:26):

%(cid:8)e(cid:12)eˇ)

0&’

perpendicular to the z-axis using Eq. (16). This method

0ı(cid:244)(cid:133)0B’˙0

(cid:3)(cid:26):

˚

gives

˚A

ps,

˚A

ps. We also used the Einstein relation (c.f.

Eq. (1)), in the standard way, to compute the diffusion coefﬁcient for this homogeneous system

0B’

0(cid:20)(cid:246)

(cid:3)(cid:26):

and found it to be

˚A

ps in agreement with our calculation,therefore validating this

methodology.

Liquid water with a liquid-vapor interface is prepared using 512 water molecules of the

(cid:10)(cid:30)(cid:240)(cid:24)(cid:11)

TIP4P/FQ

•/b|)(cid:247)•/e(cid:5))ł!

model. The resultant 3-D periodic simulation box is rectangular with dimensions

•/_(cid:176))

(cid:246)E(cid:242)

and

. The width of the water phase is approximately

˚

and is centered

about the middle of the box

. Further simulation details are given in the Fig.[ 1] caption.

Two water-vapor interface regions perpendicular to the

coordinate are present on either side of

)a(cid:236)

(cid:15)(cid:18)S

’˙(cid:242)

. The liquid is subdivided into layers of water of width

˚

perpendicular to the

-axis. The interface width is

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

and the center of the region is positioned at

˚

(cid:14)(cid:27)(cid:15)(cid:28)g

(cid:19)(cid:22)(cid:21)(cid:24)(cid:23)

(cid:25)C:‹!

˚

. We

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

evaluate

(cid:14)(cid:16)(cid:15)(cid:18)m

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

(cid:25)U:E!

and

in each of the layers of the liquid from Eq. (16). Plots of

and

for the slab in the middle of the bulk water phase and in the interface layer

are given in Fig.[1]. This ﬁgure also show the range over which the linear ﬁtting is applied, from

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

’?0(cid:5)^

’˙0

>˘(cid:239)

. The plot of

,

ranging from the middle of the bulk phase to the interface is

given in Fig.[ 1]. The error bars are calculated using block averaging over the trajectory.

14

(cid:236)
(cid:238)
(cid:236)
!
(cid:236)
!
%
)
(cid:236)
(cid:13)
(cid:242)
!
(cid:242)
(cid:238)
S
)
0
S
S
)
0
(cid:238)
S
(cid:236)
’
(cid:127)
(cid:238)
S
)
*
!
’
(cid:127)
æ
(cid:238)
(cid:3)
>
(cid:3)
>
!
(cid:236)
(cid:3)
C. The perpendicular component

For ﬁnite regions that border on the interface with water vapor, the potential of mean force is

signiﬁcantly different from zero and the long time diffusional motion will be given by the Smolu-

chowski equation, Eq. (6). For the purposes of the following discussion we deﬁne the liquid side

boundary at

and the vapor side boundary at

. To use the methods outlined before, we

0&A

assign ﬁctitious boundaries that are perfectly absorbing at

. Fig 1 shows how the density

varies as a function of position as one approaches the interface from inside the liquid as determined

”o(cid:252)

from MD. This proﬁle can be ﬁt to the hyperbolic tangent function,

*(cid:129)(cid:253)

as

WX(cid:19)(cid:27)S&(cid:23)

(cid:19)(cid:16)S(cid:5)^

T\W

Mœø(cid:24)ß

:E!

(28)

(29)

for the interfacial region. The potential of mean force in our water vapor interface is then deﬁned

rv”

as

(cid:19)(cid:16)S&(cid:23)

(cid:19)(cid:22)WX(cid:19)(cid:16)S&(cid:23)

(cid:23)(cid:24)’

6o9

Needless to say, it is difﬁcult to solve the Smoluchowski equation with this non-linear potential

of mean force analytically, thus necessitating the use of the dual LD simulation method for this

region.

_(cid:16)_

We have outlined two routes to determining the

component of the diffusion tensor. The

ﬁrst involves using the analytical expression, given by Eq. (20), for the decay of the autocorrela-

tion of the eigenfunction of the Smoluchowski Equation. When the solution of the Smoluchowski

Equation is difﬁcult to obtain, a second route, using dual simulation Langevin Dynamic simula-

%(cid:8)_(cid:16)_

tions can be used to evaluate

.

Before applying the analytical solution, Eq. (20) and the LD dual simulation method to a

liquid with an interface, we ﬁrst test this approach on the same homogeneous, isotropic sample

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

of liquid water used in the calculation of

’˙(cid:242)

and

. We compute the diffusion coefﬁcients in

slabs of water of width

perpendicular to the z-axis using Eq. (20). The autocorrelation of

˚

the eigenfunction or the survival probability is calculated from the MD simulation for a region

15

S
)
(cid:217)
S
)
0
S
)
(cid:217)
(cid:3)
-
)
*
!
L
*
L
!
’
(cid:246)
!
(cid:217)
(cid:23)
:
(cid:217)
-
Q
)
^
:
W
-
%
(cid:236)
(cid:238)
(cid:138)c(cid:210)(cid:140)Sc(cid:210)(cid:140)(cid:142)

(cid:142)(cid:254)^¸(cid:138)

’˙(cid:242)

•º)

)(cid:255)(cid:236)

deﬁned by

%(cid:8)_(cid:16)_

where

˚

. Using the diffusion equation and thus Eq. (20)

to solve for

requires two corrections to the width

. As discussed above the discrepancy

between the Smoluchowski boundary condition (

(cid:211)\(cid:212)(cid:16)(cid:213)

) used to solve the diffusion equation and

the real boundary condition (

) can be corrected using

deﬁned in Eq. (24). Secondly

)º(cid:236)

’˙(cid:242)

one must include the aforementioned memory correction

(cid:224)(cid:133))

0B’

0B’

!(cid:20)(cid:224)

giving an effective width

%(cid:8)_(cid:16)_|)

0&’

0(cid:176)(cid:244)

(cid:1)(cid:0)

(cid:2)(cid:3)(cid:2)

0&’?0

(cid:3)(cid:24):

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

, where

˚

and

˚

for this system. This method gives

˚A

ps =

=

. Using the Langevin dual simulation method requires only the memory

(cid:142)»^¸(cid:229)

correction leading to absorbing boundaries in the LD simulation at

%(cid:8)_(cid:16)_c)

(cid:244)70B’˙0

0B’

(cid:3)(cid:26):

and

. From the

dual Langevin method

˚A

ps in perfect agreement. The diffusion tensor is

found to be isotropic, as we expect for this system with values in agreement with the correct

diffusion coefﬁcient calculated using the Einstein relation (c.f. Eq. (1)), in the standard way,

0B’

0(cid:20)(cid:246)

˚A

ps. Thus our new method based on analyzing the MD data by imposing virtual

absorbing boundary conditions gives the same value for the diffusion coefﬁcient as the standard

method for the homogeneous system, thus vindicating the method.

%(cid:8)_(cid:16)_

S|(cid:210)

To evaluate

for the bulk water like regions (

˚

of our air-water interface system we

compute the autocorrelation of the eigenfunction with eigenvalue

and ﬁt to the exponential

in Eq. (20), (the results from dual simulation are equivalent for the bulk like regions). A plot of

’˙(cid:242)

the ﬁt for a

region centered in the middle of the bulk water phase is given in Fig.[ 3](a).

˚

We now apply the above LD dual simulation analysis to determine the components of the

diffusion tensor in the interfacial layers of our air-water interface system. The dual simulation

method is a little more complicated than the procedure for the previously discussed bulk water

(cid:14)(cid:16)(cid:15)(cid:18)So(cid:19)(cid:30)(cid:21)(cid:24)(cid:23)

like regions. The correction factor (

) is derived from the maximum difference of

between MD and LD for the same value of the diffusion coefﬁcient. Not knowing the value of

the diffusion coefﬁcient on the interface we resort to an iterative procedure. Initially we use dual

_(cid:16)_

simulation to solve for

without considering

. We then calculate

from the corresponding

MSD curves from MD and LD. Using this value of

%(cid:8)_(cid:16)_

we change the position of the boundaries in

the LD simulation and derive a new

using dual simulation. This procedure is repeated until

16

(cid:238)
•
>
)
0
=
)
0
(cid:224)
(cid:229)
(cid:217)
M
^
!
(cid:229)
*
0
(cid:127)
(cid:238)
(cid:229)
)
*
(cid:127)
(cid:236)
(cid:238)
(cid:236)
!
(cid:138)
M
(cid:229)
(cid:236)
0
!
%
)
(cid:236)
(cid:3)
:
*
0
(cid:238)
(cid:23)
¶
)
*
(cid:236)
(cid:238)
(cid:229)
(cid:132)
(cid:3)
(cid:25)
%
(cid:229)
(cid:229)
(cid:229)
>˘(cid:239)

0&’?0

(cid:3)(cid:26):

the change in the diffusion coefﬁcient is smaller than

%(cid:8)_(cid:16)_

˚

. A plot of the ﬁnal ﬁt for the

%(cid:8)b(cid:24)b

%(cid:8)e(cid:12)e

interface region is given in Fig.[ 3](b). The plot of

and the previously calculated

and

ranging from the middle of the bulk phase to the interface is given in Fig.[ 1]. The error bars are

calculated using block averaging over the trajectory.

So^

Implicit in the MD simulation is the

dependent interfacial potential of mean force. Because

of this the ordinary Einstein relation and the Green-Kubo equation for the diffusion coefﬁcient

(the time integral of the velocity autocorrelation function (VAF)) are no longer valid. Consider,

for example, Langevin dynamics along

with the systematic force arising from the interfacial

_(cid:16)_

potential of mean force and with a given static friction coefﬁcient

. In general the VAF will be

functionally dependent on the PMF as will be its integral, i.e. the presumed diffusion coefﬁcient,

will also be functionally dependent on the PMF. In contrast, for the Smoluchowski equation, the

diffusion coefﬁcient is independent of the PMF. Disregarding this, one might wonder what the

_(cid:16)_

value of

would be if applying the Einstein equation on the interface was correct. Using Eq. (1)

%(cid:8)_(cid:16)_Æ)

(cid:244)º0B’˙0

0B’

!(cid:150)(cid:236)

(cid:3)(cid:26):

for particles initially in the same interface region used above, we get

%(cid:8)_(cid:16)_

˚A

ps.

The value for

is clearly much smaller than found from the dual simulation method. Integrating

0&’´(cid:246)/(cid:244)(cid:159)0&’˙(cid:242)

ı(cid:244)(cid:133)0B’˙(cid:242)

%(cid:8)b(cid:24)b(cid:176))

%(cid:8)epe(cid:8))

0B’

(cid:3)(cid:26):

(cid:3)(cid:26):

the ﬁrst 3 ps of the Green-Kubo relation gives

%(cid:8)_(cid:16)_|)

0&’?(cid:242)

0B’

(cid:3)(cid:26):

(cid:5)(cid:4)

˚A

ps,

˚A

ps and

˚A

ps. One may argue that the uncertainties encountered are too large to make

a deﬁnitive statement. To clarify the inadequacy of using the Green-Kubo relation to compute

%(cid:8)_(cid:16)_

, we performed a very long LD simulation, like the one used in the dual simulation method

of the interfacial region. This mimics the MD. We determine the

%(cid:8)_(cid:27)_Æ)

0B’˙(cid:242)

(cid:3)4:

-component of the VAF for a

static friction consistent with

%(cid:8)_(cid:16)_ˇ)

0&’

!(cid:150)(cid:236)

(cid:3)(cid:26):

(cid:244)«0&’?0$(cid:242)

˚A

ps. Integrating the ﬁrst 10 ps of the VAF gives an

erroneous value of

˚A

ps, approximately half as large as the input value.

IV. DISCUSSION AND CONCLUSION

Far from the interface the diffusion tensor is found to be isotropic, as expected, and the dif-

fusion coefﬁcient has the value

.22 ˚A

/psec in agreement with what is found in the bulk

liquid.

As the layers approach the interface region all components of the diffusion tensor in-

17

*
(cid:238)
(cid:3)
S
5
%
!
(cid:236)
(cid:244)
S
!
%
(cid:6)
(cid:3)
(cid:13)
crease. This can be understood when one considers the source of water’s relatively slow mobility

in bulk water. In bulk water each molecule forms on average 3.6 hydrogen bonds with neighboring

water molecules. This hydrogen bonding network impedes the translational motion of the water

molecules. In the interface region the number of hydrogen bonds is approximately 2.5 per water

molecule.

The fewer hydrogen bonds reduce the effective friction felt by the water molecules

%(cid:8)_(cid:16)_

resulting in the larger diffusion coefﬁcient. The

component of the diffusion coefﬁcient of the

interface is approximately two times the value in bulk water, ( (cid:6)

b(cid:24)b

e(cid:12)e

.5 ˚A

/psec) while the components

parallel to the interface (

.8 ˚A

/psec) are approximately three and a half times the

bulk value. The axial anisotropy in the diffusion is related to the structural asymmetry of the

interface.

We suspect that the same qualitative behavior will be seen in all liquids, including classical

liquids such as liquid argon. In fact our simulations of liquid argon at reduced temperature and

)(cid:137)%(cid:8)e(cid:12)e(cid:133))›%(cid:8)_(cid:16)_

%(cid:8)b(cid:24)b(cid:133))›%(cid:8)e(cid:12)e

0&’f(cid:246)E(cid:242)

%(cid:8)b(cid:24)b

0B’

0B’

(cid:3)4:

>o(cid:239)

>o(cid:239)

>o(cid:239)

density

0&’

and

(cid:5)(cid:4)

%(cid:8)_(cid:16)_

gave

0&’

(cid:7)(cid:6)

(cid:9)(cid:6)

˚

in the bulk and

(cid:10)(cid:4)

(cid:11)(cid:6)

˚

and

˚

in the interfacial layer.

One can rationalize this behavior as follows. The barriers for diffusion perpendicular to the in-

terface will be larger than for diffusion parallel to the barrier, but will be smaller than for diffusion

in the bulk. A vacancy model for diffusion illustrates this. For diffusion to occur, a vacancy must

be next to the diffusing particle. Since ﬂuid relaxes around this vacancy, the barrier opposing a

jump into the vacancy depends on the “stiffness” of the ﬂuid with respect to density ﬂuctuations

transverse to the direction of the jumping particle. For a jump into a vacancy along the x of y di-

rection, we must consider the stiffness along the z direction, whereas for a jump into the vacancy

along the z direction, we must consider the stiffness along the x or y directions. In the interface we

expect the stiffness along z to be smaller than along x and y. Thus the barrier to diffusion along z

%(cid:8)b(cid:24)b|)N%(cid:8)e(cid:12)e

%(cid:8)_(cid:27)_

will be greater than the barrier to diffusion along either x or y, and

. Likewise

we expect that all barriers in the bulk will be larger than in the interface because the ﬂuid will be

stiffer there. This hand-waving argument is consistent with our observations.

In summary, we have developed a general method to calculate the self-diffusion coefﬁcient in

a ﬁnite region. This is very important since the mobility of the solvent molecules greatly effect the

18

(cid:10)
-
(cid:3)
%
)
%
(cid:6)
(cid:3)
(cid:236)
!
(cid:238)
…
(cid:8)
(cid:238)
(cid:3)
:
…
(cid:8)
(cid:127)
(cid:238)
(cid:3)
:
…
(cid:8)
(cid:210)
reactivity and dynamics of solutes such as proteins. In principle, our method can be extended to

more complicated geometries and different boundary conditions, to handle problems that include

the diffusivity of water in the ion channel or ’pocket’ near the active site in some enzymes.

ACKNOWLEDGMENT

This paper is dedicated by B.J.B. to Hans C. Andersen on the occasion of his sixtieth birthday.

Hans has been a valued colleague and friend for more than thirty years. This work was supported

by a grant to B.J. Berne from NSF (CHE-03-16896).

19

REFERENCES

M.P. Allen and D.J. Tildesley. Computer Simulation of Liquids. Oxford University Press Inc.,

New York, (1987).

D. Frenkel and B. Smit. Understanding Molecular Simulation. Academic Press, London, (2002).

S.W Rick, S.J. Stuart, and B.J. Berne. J. Chem. Phys., 101, 6141, (1994).

I. Benjamin. J. Chem. Phys., 97, 1432, (1992).

R.M. Townsend and S.A. Rice. J. Chem. Phys., 94, 2207, (1991).

D. Michael and I. Benjamin. J. Electroanal. Chem., 450, 335, (1998).

S.H. Lee and P.J. Rossky. J. Chem. Phys., 100, 3334, (1994).

M. Meyer, M. Mareschal, and M. Hayoun. J. Chem. Phys., 89, 1067, (1988).

S. Senapati. J. Chem. Phys., 117, 1812, (2002).

Pu Liu, Edward Harder, and B.J. Berne. to be published, (2003).

A. Luzar and D. Chandler. Nature, 379, 55, (1996).

E. Kreyszig. Advanced Engineering Mathematics. John Wiley & Sons, Inc., (1993).

K. Razi Naqvi, K.J. Mork, and S. Waldenstr (cid:12) m. Phys. Rev. Lett., 49, 304, (1982).

S. Harris. J. Chem. Phys., 75, 3103, (1981).

M. A. Burschka and U. M. Titulaer. J. Stat. Phys, 25, 569, (1981).

Concepcion Tojo and Panos Argyrakis. Phys. Rev. E, 54, 58, (1996).

M.E. Tuckerman and B.J. Berne. J. Chem. Phys., 95, 4389, (1991).

(cid:10)(cid:12)(cid:10)

(cid:10)(cid:22)(cid:13)

(cid:10)(cid:27)(cid:216)

(cid:10)(cid:22)(cid:228)

(cid:10)(cid:27)Ł

(cid:10)(cid:22)(cid:240)

W.L. Jorgensen, J. Chandrasekhar, J.D Madura, R.W. Impey, and M.L. Klein. J. Chem. Phys.,

79, 926, (1983).

20

(cid:10)
(cid:3)
(cid:13)
1
(cid:216)
(cid:228)
Ł
(cid:240)
2
(cid:10)
-
(cid:10)
(cid:3)
(cid:10)
1
B.J. Berne and G.D. Harp. advan. Chem. Phys., 17, 63, (1970).

J.W. Calm and J.E. Hilliard. J. Chem. Phys., 28, 258, (1958).

H.C. Andersen. J. comput. Phys, 52, 24, (1983).

(cid:3)(cid:12)(cid:3)

P. Ewald. Ann. Phys, 64, 253, (1921).

R. Zhou, E. Harder, H. Xu, and B.J. Berne. J. Chem. Phys., 115, 2348, (2001).

T. Darden, D. York, and L. Pedersen. J. Chem. Phys., 98(12), 10089, (1993).

B. A. Luty, I. G. Tironi, and W. F. van Gunsteren. J. Chem. Phys., 103(8), 3014, (1995).

R. W. Hockney and J. W. Eastwood. Computer Simulations Using Particles. IOP, Bristol, (1988).

21

(cid:10)
2
(cid:3)
-
(cid:3)
(cid:10)
(cid:3)
(cid:13)
(cid:3)
1
(cid:3)
(cid:216)
(cid:3)
(cid:228)
FIGURES

FIG. 1. (a) In order to calculate the components of diffusion parallel to our boundary surface we use

the generalized Einstein equation for the anisotropic diffusion equation (16). The bulk region is deﬁned as a

(cid:13)(cid:15)(cid:14)(cid:17)(cid:16)

(cid:13)(cid:15)(cid:14)(cid:20)(cid:19)

˚

region in the center of our water phase,The interface region is deﬁned in the text with a width of

˚

.

The portions of the curve we ﬁtted is between (cid:21)

and

. (b) Plot of the diffusion coefﬁcient in all

(cid:14)(cid:17)(cid:22)(cid:24)(cid:23)(cid:26)(cid:25)

(cid:13)(cid:15)(cid:14)(cid:17)(cid:22)(cid:24)(cid:23)(cid:26)(cid:25)

three Cartesian coordinates for

regions extending from the bulk up to the interface. A

trajectory

˚

(cid:13)(cid:15)(cid:14)(cid:17)(cid:16)

(cid:19)(cid:27)(cid:22)(cid:28)(cid:22)(cid:24)(cid:23)(cid:26)(cid:25)

is run in the NVE ensemble using the velocity-verlet integrator to update the atomic positions and velocities.

The atomic conﬁguration is recorded for data analysis every (cid:21)

.The coordinate correction algorithm,

(cid:22)(cid:28)(cid:29)(cid:30)(cid:25)

RATTLE,

is used to constrain the bond lengths allowing for a timestep of 1 fs in our simulations. To

(cid:3)(cid:12)(cid:3)

efﬁciently calculate the electrostatic interactions, mesh based approximations to the Ewald sum

can be

used.

–

We use the P3ME

method.

FIG. 2. (a)The plot of memory correction factor vs. (cid:31)

(inverse of characteristic time). The dash line

and solid line is the correction factor  

from the GLD and LD and the biggest difference of !

"$#&%(cid:26)’(cid:1)(*)

(cid:24)+ ,

respectively. The static friction corresponds to a

/.

˚

, 0

and water molecule mass. (b)

-,

(cid:22)(cid:15)(cid:14)

(cid:23)(cid:26)(cid:25)

(cid:13)1(cid:22)(cid:28)(cid:22)(cid:28)2

The friction kernel. The solid line is calculated from the velocity autocorrelation function of MD by solving

the Volterra equation numerically, see cited reference

for details. From the second ﬂuctuation-dissipation

theorem, the relationship between the friction kernel and the random force autocorrelation function (FAC)

_(cid:16)_

can be established as 3

’4(*)

"$78’

78’(cid:1)(*)

+ , where

’=<(cid:27)0>) and 7

is the random force. The curve

,65

59,;:

of FAC is scaled by

. (c) The velocity autocorrelation function (VAC) from the molecular simulation and

the GLD. (d) The mean-square displacement. The GLD simulation with real friction kernel can almost

reproduce the same MSD curve as the real MD simulation. The difference of the !

"$#8%(cid:26)’4(*)

is obvious.(e)

The survival probability from MD, GLD with real friction kernel and Langevin dynamics with width cor-

rected using mean square displacement prescription. The coincidence of these curves proves the accuracy

of the numerical kernel and the memory correction.

22

(cid:18)
(cid:18)
(cid:18)
(cid:3)
(cid:10)
(cid:3)
(cid:13)
(cid:3)
(cid:228)
(cid:3)
(cid:13)
(cid:3)
(cid:0)
(cid:21)
(cid:16)
(cid:18)
(cid:3)
,
(cid:10)
2
(cid:22)
)
_
_
.
_
5
(cid:3)
+
FIG. 3. (a)The decay of the autocorrelation function of the eigenfunction for the ﬁrst non-zero eigen-

value is ﬁt using a least squares method for the bulk region. See Eq. (20). (b) The decay of the survival

probability for the interface region. The survival probability is ﬁt for long times using a dual simulation

with Langevin Dynamics.

23

Mean Square Displacement for Interface and Bulk

(a)

Dxx (Interface)
Dyy (Interface)
fit region (Dxx in interface)
fit region (Dyy in interface)
Dxx (Bulk)
Dyy (Bulk)
fit region (Dxx in bulk)
fit region (Dyy in bulk)

5

10

15

time (ps)

z-dependance of Diffusion Coefficient

density profile

Dxx
Dyy
Dzz

(b)

1

y
t
i
s
n
e
D

0.5

0

15

2
/
)
t
(
P
/
D
S
M

8

6

4

2

0

0

t
n
e
i
c
i
f
f
e
o
C
 
n
o
i
s
u
f
f
i

D

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0

Fig 1.

5

10

|z| (Å)

24

0.12

0.1

0.08

0.06

0.04

0.02

 

r
o
t
c
a
F
n
o
i
t
c
e
r
r
o
C

0

0

D
S
M

1.5

2

1

0.5

0

0

Memory correction factor 
Dependance on kernel characteristic time

(a)

Diff sqrt(MSD)
Omega

50

100

200

250

300

150

alpha

Mean square displacement
MD GLD and LD

(d)

GLD (from MD kernel)
LD (D = 0.307)
MD 

Survival Probability: GLD and LD

(e)

GLD (w = 3.391 MD kernel)
LD (w = 3.391 Omega= 0.16)
MD (w = 3.391) 

1

2

3

4

5

0

0

5

15

20

10

time (ps)

time (ps)

Fig 2.

0.5

0.4

0.3

0.2

0.1

)
t
(
P

25

Eigenfunction autocorrelation function & Survival Probability

(b)

MD
Best fit LD

(a)

MD
Best fit 

5

10

20

25

30

15
time (ps)

5

15

20

10

time (ps)

)
t
(
P

0.2

0.4

0.3

0.1

0

0

Fig 3.

0.4

0.3

0.2

0.1

>
)
L
/
)
0
(
z

(
n
i
s
)
L
/
)
t
(
z

(
n
i
s
<

0

0

26

p
p
