1

 

Light propagation in a horizontally homogeneous Lambertian foliage:

Analytically solvable models

Antoine Royer
Département de Génie Physique, Ecole Polytechnique, Montréal, Québec H3C 3A7, Canada
Sophie Royer
Institut für Botanik, Universität Innsbruck, Austria

Various numerical methods exist for obtaining the radiances inside a canopy of leaves above a
partly reflecting ground. In view of testing the accuracy of these diverse methods, it is desirable
to have at one’s disposal non-trivial models possessing analytical solutions, against which to
compare numerical results. Such models are obtained in the present paper, for the case of a
horizontally homogeneous foliage of Lambertian leaves, modeled as a turbid medium. Our
treatment is more general than usual in that we allow the top and under sides of leaves to have
different optical coefficients. Besides being more realistic, this enables artificial situations, such
as extreme light trapping, testing the limits of the various numerical methods.

1.   Introduction

The problem of light propagation in foliage is of prime importance in various applied

fields of research, such as remote sensing, ecology, and agriculture [1-4]. The light climate inside

a canopy, as well as the light reflected to space, are usually obtained by numerically integrating a

light transport equation (LTE) [1-4].

Our aim is to eventually compute rates of photosynthesis inside canopies. These rates

interact with the leaf temperatures, and both depend non-linearly on the rates of absorption of

radiation by leaves. The latter in turn depend on the ambiant radiances, hence on thermal

emissions by leaves, which themselves depend non-linearly (again!) on leaf temperatures. Thus it

appears that the only feasible way to determine leaf temperatures is by iteration. Whence the

necessity of repeatedly integrating the LTE, which it is therefore imperative to do in minimum

time. The most widely used numerical integration method for doing so is an iterative procedure

[1-3], which we call ‘iterative integration’ (this is also often called ‘relaxation method’ [1]). This

iterative integration (which comes on top of the iterations over temperatures) may entail some

loss of accuracy, and be time-consuming in certain situations.

 

In a preceding paper [5], we proposed a new method for integrating transport equations,

by combining transfer matrices, transmission-reflection matrices, and Green’s matrices (TTRG).

2

This method turns out to be both faster and more accurate than iterative integration [1-3]. In

order to test the accuracy and limits of our method, as well as its speed, and compare it with

other methods, it is desirable to have at one’s disposal non-trivial models possessing analytic

solutions, against which to compare numerical results. The main purpose of the present paper is

to provide such models (which are also of intrinsic interest). These will be used in subsequent

papers to test the reliability of our method. Another purpose of the paper is to set up the basic

theory for subsequent papers presenting realistic calculations.

As is usual, the canopy is modeled as a turbid medium of flat leaf elements of zero

thickness and infinitesimal areas [1-4]. However, our treatment is more general than usual in that

we allow the top and bottom sides of leaves to have different optical properties. This is more

realistic. Also, it allows us to create artificial situations, such as extreme light trapping, to test the

limits of numerical methods. It will turn out that in cases of extreme light trapping, iterative

integration can become impractical, while our method remains as efficient

We restrict ourselves to a horizontally homogeneous canopy. Also, we do not distinguish

between photons of different frequencies or polarizations (although in papers dealing with rates

of photosynthesis, we shall, as is usual [1-4], treat separately visible, near infrared, and thermal

photons). The theory is set up for a canopy comprising a single species of leaf, the generalization

to several species being straightforward.

The paper has three parts. Part I defines the basic quantities of the theory, and derives the

light transport equation, and variants of it. Part II assumes purely Lambertian scattering and

emission (specular reflection will be incorporated in later papers). Part III formulates analytically

solvable models. Some technical details are relegated to two Appendices.

Notations and conventions: In order to make equations less cluttered and more readable, we will

often use a hat over scalars  c  to signify absolute value: Thus,  ˆc

c∫

≥ 0 . Using the step function

Q( )x , we also denote

x

± ∫

ˆ
x

(

±

Q

x

),

ˆ
x

∫

x

,             Q(

x >

=0
)

1,     Q(

x <

=0
)

0

(1)

We let the positive  z  direction point downwards (i.e., towards the ground surface). The unit

vector in direction  z  is denoted   uz ∫ ( ,

0 0 1 . Unit vectors in direction   W = ( ,

)mj , where

, )

3

m

∫ cos , are denoted:

q

,
WW == W W W
x

z

y

,

) = (
d d
,
q q j m j
=

sin cos , sin sin ,

,
)
q j q j m
d
)
d f
j m mj

(
f
W W

d d

( ,

m

W

=

=

=

d

)

p

1

z

cos

q

d

W

sin

(
=

Ú

Ú

-p

Ú

1
-

The scalar product of two unit vectors   WW = ( ,

)mj   and   WW¢ =

)m j   is
(
¢

,
¢

WW WW◊

a b

¢ = +

cos(

j j
- ¢

),

a

,
mm
¢

∫

b

∫

sin sin

q q 0

¢ ≥

We will need the integrals

d

WW WW WW

◊

d

W

◊
WW WW

¢ =
±

Ú
2
¢ = p

,

Ú

Ú

d
WW

m

=

±

= p

d

1
d
j m m
Ú
0
d
j
WW WW
◊

p

Ú

Ú

-p

p

-p

1
2
p

a
¢ = =

mm
¢

  

The angular d function  d
(
W W-

0

)

=

d m m d j j
0

-

-

) (

(

0   is such that
)

d

) (
d
W W W W

-

(

f

0

)

=

DWÚ

f

(
W

0

)

Ï
Ì
Ó

0

if

if

Œ
W DW

0

œ
W DW

0

where  DW   is some solid angle.

We define functions (with  a, b  given by (3), and   ˆm m∫

, etc.):

g

( ,
m m

)
¢ ∫

1
2
p

d
j

WW WW
◊

¢ =

p

Ú

-p

if

ˆ
ˆ
a b
≥
ˆ
a if a b

ˆ

£

a b

)

-

-

)
(
z m

∫

2

1

-

-
m m

1
-

cos

m

= -

d
m

cos

1
-

m

ˆ ˆ
Ï
mm
¢
Ô
Ì
2
(
ÓÔ
z
p

Ú

(see Appendix B.1). We also define, letting  u  stand for  +  or  - :

g

,
u u
i

f

(
,
m m m j
f
if

,

,

L

i

)

∫

1
2
p

p

Ú

-p

d
j
L

WW WW WW WW
u
i

◊

◊

i

f

u

f

,

j j j

-

∫

if

i

f

for which a complicated analytic form can be obtained (see Appendix B.2).

(2)

(3)

(4)

(5)

(6)

(7)

(8)

We write   W ŒD  if  m > 0  (W points downwards), and   W ŒU   if  m < 0  (upwards). A

function   f

W = m   independent of  j  is called azymuthally symmetric, or  j-symmetric for
(

)

)

(

f

short. Infinitesimal lengths, areas, and volumes are denoted   dl, da, and   d 3r, respectively.

Part I   General theory

4

This part concerns the general aspects of the theory. Section 2 defines the basic quantities

of the theory. Section 3 derives the light transport equation (LTE). Section 4 discusses extinction

coefficients, and writes them as a sum of two terms, due respectively to interception by leaf tops,

and by leaf bottoms. Section 5 restricts the theory to horizontally homogeneous situations.

Section 6 specifies the boundary conditions at the ground surface, and states global energy

balance. Finally, section 7 treats first-scattered-sunlight as an ‘emission’.

2   Basic quantities

for easy reference.

This section introduces the basic quantities of the theory. Some definitions are displayed

Photon flux (radiance): We refer to a photon travelling in direction   WW, or within   dW  about
WW, as a ‘photon   W ’, or a ‘photon   dW’. The photon flux   I(

, )W r   is defined by:

         I

(
W

r
, )

d da
W
W

=

d
number of photons  

 crossing per second an infinitesimal

W

area  

da
W

 perpendicular to  

r
at position  

( ,
x y z

, ).

WW

=

Ï
Ì
Ó

  

(9)

We will also refer to   I(

, )W r   as the radiance (though more properly, radiance is the energy

flux). The set of radiances   I(

, )W r   for all  W  is called the light climate at  r.

Leaf orientations and leaf area densities: The canopy is modeled as a turbid medium of flat leaf

elements of infinitesimal areas. Horizontal leaf elements are assumed azymuthally isotropic (i.e.,

j-symmetric), so that it suffices to specify the orientation of an inclined leaf element by the

normal   WWL   to its bottom surface. In the case of a horizontal leaf,  WWL

z= u , where   uz   is the unit

vector in direction  z  (downwards). We refer to a leaf with normal  WWL   as a ‘leaf  W L ’.

The canopy is characterized by a leaf area density  h(

, )W L r , defined by:

            h(

W

L

r
, )

d
W

L

d

3

r

= total leaf area oriented within  
d
W

L

  inside  
d

r

  at  
r

.

  

3

(10)

We also define  jL - integrated, and total, leaf area densities at  r:

˜(
h m
L

, )
r

( )
r

h

∫

Ú

p

∫

-p

Ú
d
(
W W
h
L

d
(
j h
L

,

r

W

L

)

1

,

r

L

) =

Ú

1
-

˜(
d
m h m
L
L

, )
r

(11)

5

The distribution l W L , r

(
of leaf inclinations  mL , are given by

)  of leaf orientations   W L , at position  r, and the distribution  ˜

,l mL r
(

)

(12)

(13)

(14)

(15)

(16)

(17)

L

W

(
l
˜
(
l m
L

,

r

,

r

) ∫ (
h
p
) ∫

-p

Ú

L

,

r

W

)
d
(
j l
L

r
( )

h

W

L

,

r

˜
) = (
h m
L

,

r

)

r
( )

h

They satisfy the normalizations

d

(
l
W W
L

L

,

r

) =

Ú

1

Ú

1
-

˜(
d
m l m
L

L

r
, )

1

=

Thus, the average of a function   f

)W   over   W L , and that of   f
(

L

)m   over   W L   or  mL, are:
(

L

f

(
W

L

)

∫

r

d
W

L

(
l m
L

,

r

)

f

(
W

L

),

Ú

f

(
m
L

)

∫

r

1

Ú-

1

˜
d
(
m l m
L

L

,

r

)

f

(
m
L

)

Leaf optical coefficients: A photon hitting a leaf is either scattered or absorbed. Scattering and

absorption coefficients for a horizontal leaf, s(

W

)
fÆ   and a(
Wi

)Wi , are defined by:

s(

W

i

Æ

d
)
W W
f

f

= probability for a photon  

W

i

to get scattered into  
d
W

f

.  

i

)

(
W
a

Ú1
= -
Moreover, emission coefficients  e(

d
W W
s
f

Æ

W

(

i

)W   are defined by:

)

f

=

 probability to get absorbed.

         e(

d
)W W

f

f

=

number of photons emitted per second 
  by a unit area of leaf.
into  
d

W

f

Ï
Ì
Ó

We will often think of scattering as ‘absorption’ followed by ‘emission’.

In the case of an inclined leaf with normal   WWL , these optical coefficients are denoted

sW W

L

fÆ(
W

i

(
), aW WL

)  and  eW WL

(

i

f

, )r , where we let emission depend on  r, since the

temperature of a leaf depends in general on its position inside the canopy.

3   Canopy optical coefficients and light transport equation (LTE)

In this section, we calculate local optical coefficients for the canopy, and then derive the

light transport equation (LTE), which tells us how the photon flux   I(

, )W r   varies in direction

W, due to scattering, absorption and emission by leaves.

Canopy optical coefficients: Let a photon   Wi  travel an infinitesimal distance    WWi dl   inside the

6

canopy. Denote its probability to hit a leaf by    G W i

) l, and that to get scattered into   d fW   by
l. Since    WWi dl   pierces at most one leaf element, and since an infinitesimal
d

d, r

(

f

i

W

  S

), r
d
W

Æ(
W
area  daL  of leaf   W L   is ‘seen’ as   WW WWi

◊

f

Lda

  by photons   Wi, we have, using (10) and (15):

L

(
G W

i

,

r

) =

d
(
h
W W
L

L

,

r

)

WW WW
◊
i
L

 

Ú
,

i

S

Æ(
W

)
The probability of absorption per unit distance is the difference

d
(
h
W W
L

Æ(
W

WW WW WW
s
L

) =

W

W

Ú

)

r

r

,

◊

L

L

i

f

f

i

,

r

W

i

(
A

i

,

r

) -
) = (
G W
d
(
h
=
W W
Ú
W, r

L

i

d
S
W W
f

Æ(
WW WW
◊
a
i
L

r
, )

Ú

L

,

r

W

f

(
WW

L

i

)
)

)d d 3
Letting also    E W
infinitesimal volume   d 3r  of canopy, we have:1

r

(

  be the number of photons emitted per second into   dW  by an

(18)

(19)

,
E W
(
  

L

,

r

r

Ú d L
(
h
W W

) =
)WWdl   is the flux of photons   W   emitted by a thickness   WWdl  of canopy.

,
(
WW

)
e

r

)

L

Thus,     E W, r

(

(20)

Scattered light as an ‘emission’: In view of (9), a number   dN
d iW   crosses per second an area   dai   perpendicular to   WWi. Over a distance    WWi dl   each photon
l  of getting scattered into   d fW . Hence the volume
d

has a probability   pi

  of photons

Wr
d
, )W

= (
I

da
i

W

fÆ =  S

f

i

f

i

i

i

d dal

i

  WWi

  scatters    dN

=

f

Æ   photons   d iW   into   d fW , per second. Thus, scattered photons

f

Æ(
W
dN p
i
i

), r
d
W

may be viewed as due to an ‘emission’ per unit volume

E scatt
  

,

r

W

)
The light transport equation: Consider a light beam of radiance   I

(
I
W W
i

Æ(
W

) =

    

W

Ú

)

(

d

S

r

r

,

,

f

i

f

i

(21)

, )W r   in direction   W f .
(

f

Over an infinitesimal distance    WW f dl, the beam looses a number    G W
(

due to interception by leaves, but gains a number      
‘emission’    E

E E
+

scatt

total

=

E total

W , r

f

(

. Whence the light transport equation (LTE)

f

,

,

r

r

d

W

I
) (
) l  of photons due to the total

) l  of photons

d

f

                                                  

1 Note that    E   in the present paper represents other objects than in Eqs.(33) et seq. of Ref.[5].

7

Ú

◊ —

I

(
W

f

r
, )

= -

(
G W

f

r
, ) (
I

W

f

r
, )

+

(
I
d
W W
i

i

r
, ) (
S

W

i

Æ

W

f

r
, )

E

(
W

f

+

r
, )

  

(22)    

  WW f

Continuity equation: Writing   WW◊ —

I(

W

r
, )

= — ◊

i

(
W

r   where   i
, )

(
W

, )
r

∫ WW I

(
W

, )
r

  is the photon

flux vector in direction  W, and integrating (22) over   W f , using (19), we get a continuity

equation for the net current   i r( ):

( )
i r

E

( )
r

A

( ),
r

=

  — ◊

∫ Ú
where    E ( )r   and    A( )r   are the total emission and absorption rates per unit volume:

-

d

IW

(
WWW

, )
r

( )
i r

r
( )

∫

E
  

Ú

d

(
E
W W

r
, ),

A

r
( )

∫

Ú

d I
(
W W

A
, ) (
r

r
, )

W

since the rate of absorption of photons  W  is   I

AW
r
,
(
)

(

,
W

r

).

4    Extinction and attenuation coefficients

The functions   G W(

, )r ≥ 0  defined in (18) are called extinction coefficients, because they

determine how a light beam gets attenuated due to interception by leaves. We note the bound

,
(
G W

r

) £

r
, )

( )
r
h   

(
Lh
W W

Ú d L
1 (equality corresponds to all leaves perpendicular to   WW).

=

since   WW WW◊

£L

Attenuation coefficients: Since the probability for a photon  W  to get intercepted by a leaf over a
distance   WWdl  is   G W(
r  to   r + WWl  satisfies    d

, )r dl , the probability   xW
l
dx

l   for the photon to go unimpeded from
)

. Whence the attenuation coefficient

r r + WW
( ,

= -

WG
x

W

  xW

r r
( ,

l
WW ))

+

e
= -

LW

r r
( ,

+

WW

l

)

     

where

r r
( ,

L

W

l
WW

)

+

∫

l
d
¢

,
(
G W

r

+

l
¢
WW

)

l

Ú

0

: Because we allow the top and bottom sides of leaves to have different

The coefficients  G±
optical properties, it is useful to define separate probabilities of interception   G+
and   G-

  by leaf bottoms (see notation (1)):

  by leaf tops,

(
G W
±

r
, )

∫

d
(
h
W W
L

L

r
, )

WW WW
◊
L

1
2

=

G

±

1
2

,

DG

±

=
G G
+

+

G
-

Ú
G
+

(
DG W

r
, )

∫

-

G
-

=

Ú

d
(
h
W W
L

L

r
, )

WW WW
◊
L

(23)

(24)

(25)

(26)

(27)

(28)

8

where we used   x

x
--

+

= . Since   WW WW

x

◊

L

(
= -

)
WW WW
◊
L

-

=

(
WW WW
◊ -
L

) , we have
+

+

(
G W
-

r
, )

=

(
G W
-

+

r
, )

=

d L
W

(
h

-

W

L

r
, )

WW WW
◊
L

+

Ú

jjjjL    - symmetric leaf area densities: Let us now consider the case that the leaf area densities

depend only on the inclination  mL   of leaves (hence are  jL-symmetric), that is:

(
W L
h

r
, )

=

1
2
p

˜(
h m
L

r
, )

=

( ) ˜(
r
h l m
L

1
2
p

r
, )

(see (11) and (12)). We then get from (28), using (4) and (14):

(
DG W

r
, )

=

DG

( , )
r
m

=

1
2
p

d
j
L

WW WW
◊
L

r
( )

h m m
L

=

r

(
G W

r
, )

=

( , )
r
m

G

=

1
2
p

d
j
L

WW WW
◊
L

=

h

r
( )

g

( ,
m m
L

)

r

1

Ú

1
-

˜
d
(
m h m
L
L

,

r

p

)

Ú

-p

1

Ú

1
-

˜
d
(
m h m
L
L

,

r

p

)

Ú

-p

where  mL r

  is the mean leaf inclination at  r, and the function   g( ,

)m m¢   was defined in (6).

Note, as is intuitively obvious, that   G(

±

u r
, )
z

( ) ˆ
r

h m   since   g

L

=

(

1 m
,
±

L

)

=

ˆ
m . The coefficients

L

(31) have simple analytic expressions for the following distributions of leaf inclinations:

Horizontal

:

˜(
l m
L
(
G W
±

r
, )

r
, )

1
)

(
-
d m
L
( ) ˆ
r
h m

=

=

(

Q

±

m

),

(
G W

r
, )

( ) ˆ
r
h m

=

Erect

:

˜(
l m
L
(
G W
±

r
, )

r
, )

)

(
d m
L
1
r
( )sin ,
q
p

h

=

=

(
G W

r
, )

=

2
p

h

r
( )sin

q

 

:
Isotropic

Semi

-

:
isotropic

,

˜
(
l m
L
,
(
G W
±

1
2

r

1
4

) =
r
) =
˜(
l m
L
(
r
, )
G W

r
, )

)

(
m
L
r
( ),

Q
=
1
2

h

=

r
( ),

h

(
G W

r
, )

=

1
2

h

r
( )

(
DG W

r
, )

=

1
2

r
( )
h m

(29)

(30)

(31)

(32)

(33)

(34)

(35)

The first two cases are obvious, since   WW WW◊
≥
for erect leaves. The isotropic case follows from (4). In the semi-isotropic case, one gets   DG
from (31), and   G  from (29) using   Q
(

=L m  for horizontal leaves, and   WW WW◊

= 1  and (4). In the erect and isotropic cases,

sinq 0

(
m
L

m
L

Q

=

+

-

)

)

L

G
+

-=
G

=

1
2

G

  since these leaf orientation distributions destroy the distinction between leaf tops

and leaf bottoms (the mean leaf inclination is zero).

5   Horizontal homogeneity

9

We will now assume that all quantities are independent of the horizontal coordinates  x, y.

Also, we let the canopy extend vertically from the ground at   z

zg=   to its top at  z0. Thus, the

leaf area densities  h
(
W

L

r =
, )

(
W
h

L z
, )

  vary vertically only, and vanish outside   (

z zg
,
0

)

.

Leaf area index (LAI): With the total leaf area density  h
useful to define the leaf area index (LAI)   L(

r =
( )
2   of a horizontal layer   (
)

z z1
,

h

z z1
,

2   as:
)

z   varying vertically only, it is
( )

       

L(
  

z z
,
2
1

)

∫

z

2

dz
Ú h

z
1

z
( )

=

total leaf area between  
z
1

and 

z
2

  per unit horizontal area.

(36)

Vertical attenuation: The probability xW

(

z z1
,

)
2   for a photon  W  to pass straight through a

horizontal layer  (

z z1
,

2   is given by (26)-(27) with   d
)

l = m :   
dz

x
W

(

z z
,
2
1

)

e

=

-

L

W

(

z z
,
1

2

)

,

L

W

(

z z
,
2
1

)

∫

dz

(
G W

z
, )

m

z

2

Ú

z
1

Note that if all the leaves are horizontal, then the fraction of photons  W   intercepted by a
horizontal layer  dz , namely   G W(

  by (32), is independent of  ˆm  (the distance

ˆ
m h=

z dz
, )

z dz
( )

travelled is    d

l

dz

=

ˆm, but the ‘view factor’   W W◊
= - L
e

z z
,
1

(

)

2

(

)

z z
,
2
1

LAI, and   xW
  is independent of  W. But in general, xW
ˆ
on the inclination   ˆm  of light rays. For example,   
(
,
LW z z
case (35). Thus, the LAI alone is not in general a reliable indicator of optical thickness.

= L

,
z z
2
1

z z1
,

) ˆ

1
2

(

(

)

2

1

m  in the semi-isotropic

)
2   depends strongly

=L

ˆ
ˆm); then,   
LW

(

z z
,
2
1

)

= L

(

z z
,
2
1

)

  is just the

Down and up fluxes: We will write

I

(
W

z
, )

=

D

Ï
Ì
U
Ó

(
W

z
, )

(
W

z
, )

if

if

W

Œ

W

Œ

U

D i e
( . .,

if

i e
( . .,

if

m

>

m

<

0

)

0

)

where   W ŒD  or   W ŒU   are shorthands for ‘W  points downwards’, or ‘upwards’. Also, we
denote by    D( )z   and    U( )z   the total ‘down’ and ‘up’ vertical photon fluxes, i.e., the numbers
of photons crossing a horizontal unit area at height z, per second:

z
( )

∫

D
  

Ú

0

m

>

d

ˆ
m

W

D

(
W

z
, ),

U

z
( )

∫

Ú

0

m

<

d

ˆ
m

U

(
W

W

z
, )

We will sometimes use the notations   I

(
W

)

I
,
(
W∫

z
0

0

)

, 

  D Dg
∫

(

gz

), etc.

The LTE: With all quantities dependent on the vertical coordinate  z  only, one can replace

everywhere  r  by  z . Also,  WW ==◊ —

∂ ∂m z, so that the LTE (22) becomes   

(37)

(38)

(39)

10

Ú

d
dz

mf
  

d
dz
  

I

(
W

f

, )
z

= -

(
G W

f

, ) (
z I

W

f

, )
z

+ W W
i

i

I

(

d

, ) (
z S

W Æ W

i

f

, )
z

(
WE

f

+

, )
z

(40)

The continuity equation (23) becomes, since   — ◊ = ∂

i

i
x x

+ ∂

i
y y

+ ∂

i , where   ∂ ∫ ∂ ∂

x

z z

x, etc.:

i z
( )

E

z
( )

-

=

A

z
( ),

i z
( )

∫

i z
( )
z

=

D

z
( )

-

U

z
( )

(41)

Black leaves: Leaves which do not scatter any light (absorbing it all), and moreover emit no

light, will be called ‘black’ leaves. If all the leaves are black, then   S

(
W

i

WÆ

f

, )
z

= 0   and

  E (

, )W f z = 0, in which case (40) has the solution

I

(
W

, )
z

=

I

(
,
W

)
z e
0

-

L

W

(

z

0

, )
z

,

L

W

(

, )
z z
0

=

dz

(
,
G W

)

z

¢

¢

m     

(42)

z

Ú

z

0

Here, ‘down’ radiances (m > 0) decrease exponentially, while ‘up’ radiances (m < 0)  increase
exponentially, as we go from the top  z0  to the bottom  zg  of the canopy.

6   Ground boundary conditions, energy balance

We now specify the boundary conditions at the ground surface   z

zg= , and then state the

global energy balance condition.

The ground boundary: Horizontally homogeneous ground optical coefficients  sg

),
WÆ(
W
)W , are defined as for a horizontal leaf, but only for   Wi DŒ   and   W f UŒ ,
(

)W   and  eg
(

ag

i

f

i

f

since the ground receives only ‘down’ light, and ‘emits’ only ‘up’ light. Similarly to (16),

a
g

(
W

i

)

<Ú1
= -

m

f

0

d

W

f

s

g

(
W

i

Æ

W

f

)

           Wi DŒ(

)

(43)

Since a unit area of ground intercepts from direction   Wi, and emits in direction  W f , beams of
cross-sections   ˆmi  and   ˆmf , the ‘up’ radiance just above the ground is

U

(
W

f

,

z

g

)

=

d D
i

W W

(

i

,

z

g

)

Úm

i

0

>

ˆ
ˆ
)
(
m m s
f

i

(
W

i

g

Æ +
W
f

)

1
ˆ
-
m e
f
g

(
W

f

)

       (mf < 0 )

(44)

The scattering term may be viewed as due to an ‘emission’  eg
Multiplying (44) by  ˆmf , and integrating over   W f UŒ , yields the ‘up’ current  

)W , similarly to (21).
(

f

)zg .

scatt

  U(

Substracting  

)zg   from the ‘down’ current  

  U(

z

g

)

=

D(
  

>Ú

m
i

0

d D
i

(
W W

i

,

z

g

ˆ
)
m
i

, and using (43),

yields the net vertical current just above the ground:

11

f

<

g

m

∫

Ú

E
  
  Eg   and  

(
i z

g

)

D

(

z

g

)

U

(

z

g

)

-

=

=

A E
-
g

g

d

0

W

f

e
g

(
W

f

),

A

g

∫

Ú

m
i

>

0

d D
i

W W

(

i

,

z

g

) ˆ
ma
i
g

(
W

i

)

(45)

where  

  Ag  are the total photon emission and absorption rates per unit area of ground.

Energy balance: Energy conservation requires that, at the top   z

z= 0   of the canopy:

)
)
A E
-

(

z
0

)

(

z
0

)

g

z

∫

=

-

E

dz

U

z
( )

D
)
E
  
)
)
where      
E   and     
A   are the total emission and absorption rates of the whole canopy plus ground,
)
)
per unit horizontal area. If      
E A=

 (what goes in must come out). Note that if

)
A

(46)

z
( )

A

A

dz

E

Ú

Ú

+

+

∫

,

g

g

z

z

z

0

0

g

z
( )

A( )
z
=

  at all heights  z, then  

  E
continuity equation (41). If    E
at all  z . This is the case, e.g., with non-emitting non-absorbing ‘white’ leaves and ground. All

  at all  z, and moreover  

  throughout the canopy, due the

, then    U

  E Ag
=

D( )
z
=

A E
-
g

z
( )

U

z
( )

g

g

, then    U D0
0=
z
( )
  D
=
-
A( )
z
=

z
( )

these relations provide very useful tests.

7   First-scattered sunlight treated as an ‘emission’

To do numerical computations, one must discretize photon directions. Because sharply

directional sunlight is very intense, putting its direction equal to one of the discrete directions

may entail sizable errors. So it is customary [1-3] to compute accurately the sunlight which has

been scattered once, and treat that as an ‘emission’.

Incident sunlight and skylight: Sunlight incident on the top  z0  of the canopy will be modeled as

h
a sharply directional radiance   D
0

(
W

)

h
0

(
-d
W W

h

)

, where   Wh   is the (downwards) direction of

=

sun rays (h  stands for ‘helios’). The incident diffuse skylight will be assumed ‘down’ isotropic,

d
i.e., of the same radiance in all ‘down’ directions,  D
0

)W =
(

d
D
0

  (d  stands for diffuse). Thus, the

total radiance  D
0

(
W

)

D
,
(
W=

z
0

)

  incident on the top  z0  of the canopy is

D

(
,
W

z
0

)

=

h
D
0

(
W

)

+

d
D
0

(
W

)

h
D
0

(
W

)

h
0

(
d
-
W W

h

=

),

d
D
0

(
W

)

=

d
D
0

The incident ‘down’ vertical fluxes will be denoted    D0

h   and   D0

d , that is, by (4) and (5):

 

h
D
0
  

=

>Ú

m

0

d

W

ˆ
m

h
D
0

(
W

)

=

h
0

ˆ ,
m
h

d
D
0

= p

d
D
0

    

(47)

(48)

12

These fluxes are assumed known (i.e., measured experimentally).

Sunlight inside the canopy: Inside the canopy, the sunlight radiance   D

  D h z( ), are attenuated due to interception by leaves. Writing    D h
in view of (48), we have:

h (

, )W , and vertical flux

z

( )
z

=

( ) ˆ
h z

m , so that   h z
(

h

)0

h
0=

h

D

(
W

, )
z

=

( )
h z

(
d
-
W W

h

),

D

h

( )
z

( ) ˆ
h z
m
h

=

( )
h z
  

=

h
0

x
h

( ),
z

( )
z

x
h

∫

x
W

h

(

, )
z z
0

e

=

z

Ú-

z

0

(
G W

h

z dz
)
,
¢

¢

ˆ
m
h

(49)

Since the attenuation  xh z( )  depends sensitively on   ˆmh , in general, sizable errors may ensue
from putting   Wh   equal to one of the discretized photon directions, as said earlier.

LTE for the diffuse radiance: Separating the total radiance   I

, )W   into ‘sun’ and ‘diffuse’
(

z

components,  I

I

h

Dd
+

=

, with   D

h (

, )W   given by (49), and substituting into (40) and (44), we

z

get the LTE for the diffuse radiance:

d
dz

m

f

U
  

d

I

(
W

f

z
, )

G
= - W

f

(

d

z I
, )

(
W

f

z
, )

d

I

(
W

i

z S
, ) (

W Æ W

i

f

z
, )

E

+

tot

(
W

f

z
, )

d
+ W
Ú

i

(50)

d

(
W

f

,

z

g

)

=

Ú >

m
i

0

d

d D
W
i

ˆ
ˆ
)
(
m m s
f

i

(
W

i

g

W
Æ +
f

)

tot
1
ˆ
-
m e
f
g

(
W

f

)

where    E

tot

=

E E
+

h

  and  e

tot
g

h
+
e e
g
g

=

  are sums of ‘true’ emissions,   E   and  eg, and of first-

scattered-sunlight ‘emissions’

h

E
  

(
W

f

, )
z

=

( ) (
h z S

W Æ W

h

f

, ),
z

h
e
g

(
W

f

)

D

=

h

(

z

g

)
s

g

(
W

h

Æ

W

f

)

(51)

Note, refering to (20), that one may define first-scattered sunlight leaf ‘emission’ coefficients

h
e
W

f

L

L

h

L

,

z

W

s
W

( )
h z

) =

◊
W W
h

(
The vertical fluxes are    D
( )
z
given by (39) with   I d   instead of  I. The canopy absorption rate    A( )z   may be written, on
substituting   I

)
  and    U

Æ(
W
z
( )
D

, where    D d   and    U d   are

  into (24):

U( )
z
=

zd
( )

(52)

z
( )

D

W

+

=

I

h

d

h

f

Dd
+

( )
z

=

d
d I
W W

(

, ) (
z A

, ),
z

W

A

h

( )
z

=

( ) (
h z A

, )
z

W

h

(53)

=

d

Ú

A A A

+

h

=
d

A
  

       

Part II   Lambertian scattering and emission

13

The above completes the general aspects of the theory. We now specialize to Lambertian

scattering and emission. Section 8 first defines Lambertian leaf and ground optical coefficients.

Section 9 then computes the canopy local optical coefficients for various azymuthally symmetric

(i.e., jL-symmetric) distributions of leaf orientations.

8   Lambertian leaves and ground

A rugged horizontal surface tends to emit equal radiances in all ‘up’ directions. Such ‘up’

isotropic emission is called Lambertian. Since a unit horizontal area emits a beam of cross-
section   ˆm  in direction   W , the number of photons  W  it emits is proportional to  ˆm .

Lambertian leaf optical coefficients: Thus, for a horizontal Lambertian leaf, we set

s

(
W

i

Æ

W

f

)

=

1
p

sgn

m
i

, sgn

m

f

,

(
W
e

f

)

=

)
ˆ
m s
f

)
ˆ
m e
f
sgn

1
p

m

f

(54)

( sgnm = +

-or

 is the sign of  m) where we allow the top and bottom sides of the leaf to have

different optical properties. We shall also use the notations  

stands for ‘down’, and  u  for ‘up’. Since   1
p

ˆm

dW , we see that  

=

1

± >Ú

m

0

)

)
s sdd ∫ + +

)

)
s sdu ∫ + - , etc., where  d
,   
)
e+

)  is the total

)
e-

 (

)

numbers of photons emitted, per second per unit area, by the top (bottom) of the leaf. Similarly,
)
s sdd ∫ + +
)
)
s sdu ∫ + -   (
  

)
 (  
s suu ∫ - - )  is the fraction of ‘down’ (‘up’) light transmitted through the leaf, and
)
s sud ∫ -+

)  the fraction reflected off the top (bottom) of the leaf. The fractions

)

)

absorbed are, by (16):

)
a
Ï
+
)
Ì
a
ÓÔ
-

 
)Wi
(
a
 

=

Note the constraints    0
)
)
)
a a a
-
+

+

∫

,

+ -

+ +

-

)
)
1
∫ -
s
s
)
)
1
∫ -
-
s s
-+
)
£
s m
sgn
,sgn
)
)
)
a a a
-
+

D

£

-

∫

- -

m

i

f

,

if

if

m
i

>

0

0

          ( 0

)
a

£

1

)

£±

m
i

<
)
)
+
s s± +
± -
)
)
)
e e e
-
+

+

∫

,

)
)
)
e e e
-
+

-

∫

D

1

,  and  

£ 1. It is convenient to also denote

(55)

(56)

Lambertian ground optical coefficients: For the ground coefficients, we set

  s

       

)
s
)
)
(for  mi > 0  and mf < 0 ), where    
sg   the fraction of light
eg  is the total emission rate, and    

Æ(
W

)
ˆ
m e
g
f

)
ˆ
m s
f

)
a
g

1
= -

) =

(
W

     

e
g

W

=

1
p

1
p

)

,

,

g

g

g

f

f

i

(57)

reflected. Equation (45) then becomes

   D U
-

g

g

=

)
D
a
g
g

)
e
g

-

or

U
g

=

D
g
g

+

)
s

)
e
g

14

(58)

(59)

(60)

(61)

(62)

(63)

In view of (51), the first-scattered-sunlight ‘emission’ by the ground is  

h

)
)
= D (
e sg
  

g

h

gz

).

Inclined leaves: For inclined leaves with normals  W L , terms  m =

◊W uz   in (54) become   W W◊

L :

s
W

L

(
W

i

Æ

W

f

)

=

1
p

sgn

◊
W W
i

L

, sgn

◊
W W
f

L

◊
W W
f

, sgn

L

◊
W W
f

L

r
( ),

r
( )

=

,

±

L

h

r
( )

◊
W W
h

L

sgn

◊
W W
h

L

,

±

)
h
e
W

)
s

)
s

L

◊
W W
i
)
e
W

L

r   depend on   W L , as well as on r, since the temperature of a leaf depends in

general on its orientation (especially relative to sun rays), and so does the first-scattered-sunlight

‘emission’ coefficient  

, ( )
±

r , following from (52).

)
h
eW L

Canopy optical coefficients: Using (1) and (18), we obtain for the canopy scattering coefficient:

e
  
W

(
W

r
, )

=

1
p

L

f
)
eW L , ( )
where we let    

±

The integral of (60) over   W f   yields 

G W r , by (28), or using (55)-(56):

, )

(

u
i

i

f

S
 

Ú
  

(
W Æ W

i

f

r
, )

=

d

W
L

(
W
h

L

r
, )

1
p

Ú

,
u u
i

f

W W
◊
i

L u
i

W

f

◊ W

L u

f

)
s

Â

,
u u
i

f

=±

)
su u
,

i

,
u u
i

f

Â
)
)
(
s s
+
+ +
r
, )
(
G W
)
a

(
G W
- -

-

i

r
, )

)
+ -
A

=

i

(
G W
+
, )
r
(
W
)
a

1
2

i

=

d

W

f

S

(
W Æ W

i

f

r
, )

=

r
, )

+

)
)
(
s s
+
--

)

-+

(
G W
-

i

r
, )

 

 A(

W

r
, )

=

(
G W
+ +

r
, )

+

)
a

(
G W

r
, )

+

1
2

)
a
D DG W

(

r
, )

in accordance with (19). All these results are quite intuitive. The local canopy emission    E (
in direction  W  , and the total local emission    E ( )r , per unit volume at  r, are

, )W r

r
( )

W ◊ W +
L

+

r
( )

,

-

L

W ◊ W
L

)
e
W

)
e
W

r
, )

L

,
+

[
d L
(
h
W W

)
e
W

]

-

)
e
W

)
e
W

L

)
( ) ( )
r
r
=h e

r
( )

∫

r
( )

+

L

+

r
( )

   

(64)

)
e
W

L

-

, and, on using (28):

r
, )
W =

E (
    

1 d L
W
Ú

p

(
W
h

L

E
    

r
( )

=
)
r
±=( )
e

d

E

(
r
, )
W =

W

Ú
r   is independent of  W L , then    E ( )
( )
r

Ú

L

L

r
( ),

r
, )

)
If    
e

W L ±

       

E (

r
, )
W =

1
p

r
( )

G
+

   

1
2
p

=

r
( ) (

G W

)
e
+
)
e

r

,
W(
r
, )

) +

1
p

1
2
p

+

)
e
-
)
D
e

r
( )

r
( )

G
-

,
W(
(
DG W

r

)
r
, )

)
            (if     
e

W L ±

)
r
±=( )
e

r )
( )

  (65)

9   Canopy optical coefficients for jjjjL- symmetric Lambertian leaves

           Let us now calculate the Lambertian canopy optical coefficients in the case that the leaf

15

(
area density  h
W L

r
, )

1
= p
2

˜(
h m
L

r
, )

  is  jL-symmetric. Using (8) and (14), we get from (60):

S

(
W

i

WÆ

f

r
, )

r
( )

=

h

,
u u
i

f

g

,
u u
i

f

(
,
m m m j
f
if

,

,

L

i

)

(
j j j

-

∫

if

i

f

)

(66)

r

)
s

=±Â

,
u u
i

f

where   gu u
,

i

f

(
m m m j   is known analytically, and the average is over  mL .

)

,

,

,

L

if

f

i

In the case of horizontal, isotropic, and erect (Lambertian) leaves,  S

(
W

i

WÆ r   has
, )

f

relatively simple analytic expressions. These are useful to indicate the allure of these coefficients

whenever a real canopy approaches one of these cases. If moreover

)
 
e

W L ±

)
r
±=( )
e

r     is independent of   W L
( )

as will be assumed in the rest of this section, then    E W, r
analytic expressions (32)-(35) for  G±
which   S

(

(
W

i

WÆ r   is not known analytically), one gets, assuming (67):

, )

f

)  is immediate from (65) and the

. For instance, in the semi-isotropic case (35) (a case for

    E (

W

r
, )

=

)
1
r
[
( )
4 h e
p

)
m e
D
+

r
( )

+

( )
r
]

(
Horizontal leaves: Putting  h
W L

r
, )

=

1
2
p

r
( ) (
h d m
L

-

1   in (18) and (20), yields:
)

S

(
W

i

Æ

W

f

r
, )

( ) ˆ
r
h m s

i

=

E
    

,
W

(

r

) =

( ) (
r
h e

W

r
, )

=

f

i

(
W

Æ

W
)
( ) ˆ
r
h me
sgn

1
p

r
( )

m

)
( ) ˆ ˆ
r
h mm s
i

f

1
p

)

=

sgn

m
i

,sgn

m

f

if (67) holds. Thus, a horizontal layer  dz  of canopy acts as a single large horizontal leaf.

(
Erect leaves: With  h
W
L
and  z m(

)  defined in (7):

       

S

(
W Æ W

i

f

r
, )

r
, )
(
W = p

2
-

E
   

1

4

=

2h
p
)
r
r
( ) ( )sin
h e

q

r
, )

1
= p
2

r
( ) (
h d m
L

)

, we get from (60),(65),(67) and (33), using (B.14)

r
( ) sin sin

)
q q s s z

+

)

(

i

f

+ +

--

) ( cos
-

j
if

)

+

)

)
(
s s z j
if
-+

) (cos

+

+ -

[

)
]

    (70)

where  j j j

-

∫

if

i

f

. These, like   G W±

(

, )r   in (33), vanish in vertical directions (as expected

since   sinq  plays, for vertical leaves, the role of  m

= cos   for horizontal leaves).

q

Isotropic leaves: With h
(

W L ,

r

1
4

) = p

h

r
( )

, there is no prefered direction, so that   S

(
W

i

WÆ r
, )

f

is a function only of the angle between   Wi  and   W f , or equivalently of its cosine   W Wi

◊

f

.

Likewise,  G W(
indeed get from (60),(65),(67) and (34), using (B.13):

, )r   is isotropic, see (34), and so is the emission    E (

, )W r   if (67) holds. We

(67)

(68)

(69)

16

S

(
W Æ W

i

f

E
   

r
, )
(
W =

r
, )

=

1
3
p
)
( ) ( )
r
r
h e

1
4
p

)

)

[
(

r
( )

(
h s s z
+ +

) -W ◊ W

+

--

i

f

) +

)
)
(
(
) W ◊ W
s s z
+

+ -

-+

i

f

]
)

(71)

)  decreases smoothly from  z(
, )

Since  z m(
W Æ W r   in (71) describes scattering that is predominantly backwards if the transmissions
S
(
)
)
s
s

= 0. Note that scattering is anisotropic

0= , the function

1=   to  z( )1

  to  z( )0

)
=
s+ +

)
=
s+ -

1
)- = p

-+

f

i

= 0, and forwards if the reflections  
)
s

)
s

)
s

=

=

=

+ -

--

-+

+ +

--
)
s

even if  

, being minimum in the sideways directions, because it is the

leaves nearly perpendicular to light rays which capture the most light (due   W Wi
leaves in turn ‘re-emit’ preferentially along their normals (due   W Wf

).

◊

◊

L

), and these

L

Part III    Analytically solvable models

We will now seek situations permitting the light climate   I(

analytically. In section 10 we find conditions leading to an isotropic light climate   I

(equal radiances in all directions), in which case the LTE simplifies and can be solved

analytically. Section 11 deals with horizontal leaves, for which the LTE can again be solved

analytically. Finally, section 12 studies a case of extreme light trapping by horizontal leaves.

, )W r   to be calculated
W r
, )
(

r=
I
( )

Black leaves: We first note a simple solvable case: With totally absorbing, non-emitting ‘black’

leaves, and a distribution of leaf orientations  l
(
W L

z = p
, )

1
2

˜(
l m
L

)

  uniform in  jL  and in  z , the

radiances inside the canopy are, by (42) and (31):

   I
(
W

, )
z

,
(
I
W=

)
z e
0

L

-

( )
z g

(

,

)

L

mm  ,           L

z
( )

∫

L

(

z z
, )
0

where    L( )z   is the total LAI above height  z, see (36).

10   Cases for which the radiance is isotropic

In this section, we find conditions producing isotropic radiances. This is of interest

because putting   I

W r
, )
(

r=
( )
I

  into the LTE (22),(44)  yields the far simpler LTE

WW
f

I

r
◊ — ( ) = -

(
G W

f

, ) ( )
I
r
r

  

d

(
W W
h

L

L

, )
r

=

Ú

d

I

( )
r

Ú
WW WW
◊
L
f

(

S
W W
i
(

b
W

(
W

L

W
)
1

Æ

i

, )
r

f

E

(
W

f

+

, )
r

)

f

-

I

( )
r

+

e
W

L

(
W

f

, )
r

}

+
{
(
W

I z
(

)

g

=

b
g

(
W

f

I z
) (

)

1
ˆ
+ -
m e
f
g

g

)

f

where we used (18) and (20), and defined

(72)

(73)

(74)

17

b
W

L

(
W

f

)

∫

WW WW
◊
f
L

d
W

i

WW WW
◊
i
L

s
W

L

(
W

i

Æ

W

f

)

b
g

(
W

f

)

∫

1
ˆ
-
m
f

Ú

W

i

Œ

D

ˆ
m s
i

g

(
W

i

Æ

W

f

)

1
-

Ú
d
W

i

(75)

(76)

(77)

Imagine now that an infinitesimal leaf element is inserted at  r  amid an isotropic light climate

I

W r
(
, )

r=
I
( )

. The latter will not be disturbed if each side of the leaf ‘emits’ a radiance identical

to that intercepted. Similarly for the ground surface. So we must have, for any direction  W f  (in

the following, the ‘ground’ equations apply only to the horizontally homogeneous case):

b

(
W

f

r
) ( )
I

1
ˆ
(
-
m e
W
f

f

+

r
, )

=

I

r
( ),

b
g

(
W

f

) (
I z

)

g

1
ˆ
-
m e
f
g

(
W

f

+

)

=

(
I z

)

g

where   b

(
W

f

)

b
∫ u

z

(
W

f

)

, like  e(

, )W f r , pertains to a horizontal leaf (with normal   WWL

z= u ):

b

(
W

f

)

∫

1
-
f

ˆ
Úm

d
W

i

ˆ
m s
i

(
W

i

Æ

W

f

)

Thus, a canopy of leaves and ground obeying (76) does not disturb an isotropic climate

I

W r
(
, )

r=
I
( )

. Moreover, it does not cause   I( )r   to vary with  r, since the right side of (73)

vanishes if (76) holds, so that  —

I( )r

=

0. It follows that if, for all   W f   and all  r:

ˆ
m

f

f

b

(
W

(
W
e

r =
, )

1
-(

)
)
, )W r = 0  satisfies the LTE, and is the solution provided it
(
is compatible with boundary conditions. In the horizontally homogeneous case, this requires the

then the uniform isotropic radiance   I

0      and       e

1
-(

(78)

(
W

(
W

)
)

b
g

=

I

)

I

I

0

g

f

f

f

f

ˆ
m

incident light at  z0  to be ‘down’ isotropic,  D

)W 0
(
,
z

0= .
I

With leaves not satisfying (76), it is still possible to have an isotropic radiance, provided

, )W L r   is such that the sum over leaf orientations averages out the disturbances caused by
h(
individual leaves (so that collectively the leaves do not disrupt an isotropic radiance). Isotropic

leaf orientations immediately come to mind.

W L r
(
, )
Isotropic leaf orientations: With h
S

1
= p
4

h

r
( )

, the local canopy scattering function

(
W

i

WÆ r   is a function of only the angle between   Wi  and   W f , so that its integral over   Wi

, )

f

is equal to that over  W f , hence to   G r

( ) - A( ), by (19). Then equation (73) becomes

r

I
  WW◊ —

r
( )

(
W
r

=

r
, ),

(
W
r

r
, )

(
WE

r
, )

-

∫

A

r
( ) ( )
r
I

(79)

, )W r   is the net gain (emission minus absorption) of photons  W  at r. Now, if
where  r(
r=
I
W r
(
( )
, )
I

  is isotropic, so will the thermal emission    E

W r
(
, )

1
= p
4

r
( )

E

  (since the leaves are

18

isotropically oriented), whence also  r
W r
(
, )
r
r( )r ∫ 0, for it says that if, e.g., r( )r > 0 , then   I( )r   increases in all directions (hence in both  WW
and  --WW, for any  WW). Thus, with isotropic leaf orientations, if    E (
isotropic radiance   I

, )W r = 0  uniform in  r  satisfies the LTE, and is the solution under the
(

. Then equation (79) makes sense only if

I0 , then an

W r
, )

= A

r
( )

r
( )

∫

I

proper boundary conditions, whatever the form of  s(

W

)
fÆ .
Wi

Lambertian leaves and ground: Let us now return to the individual leaf requirement (76). This is

compatible with only certain kinds of leaf optical coefficients, such as Lambertian (specular will

also do). By inserting the Lambertian coefficients (57),(59) into (75) we get: 2   
)
)
s s
+
+ +

)
)
s s
+
--

b
-

b
+

∫

∫

b

+ -

-+

)

m

,

,

f

f

(
W
(
W

b
g

f

=
)

=

b
sgn
)
s

g

so that (76) may be written, refering to (54):

)
e
±

1
  
p

r
( )

(
1
= -

b I
±

r
) ( ),

(
1
= -

I z
) (

)

g

g

=

I z
(

)

g

)
e
g

)
s

)
a
g

Noting now that the integral of (60) over   Wi  may be written (compare (61))

d

W

i

S

(
W Æ W

i

f

r
, )

=

b
+

(
G W
+

f

r
, )

+

b
-

(
G W
-

f

r  
, )

Ú

and using (65), we may rewrite (73) as

)
e
+

1
p

)
e
-

1
p

f

I

=

◊ —

r
( )

r
, )

(
G W
+

          WWf

r
) ( )
]
, )W r = 0  is
If (81) holds, then again the right side of (83) vanishes, so that   —
(
the solution under proper boundary conditions, whatever the distribution of leaf orientations. By

0, and   I

(
G W
-

1
(
- -

1
(
+ -

b I
+

b I
-

r
) ( )

(83)

I( )r

]+

r
, )

r
( )

r
( )

=

[

[

I

f

restricting the latter, we will next obtain isotropic radiances that are non-uniform in z.

jjjjL -symmetric Lambertian canopy: Using   G

± =

1
2

G

±

1
2

DG

  and   b
+

b
-+

= -2

)
a  together with

(56), rewrite (83) in the horizontally homogeneous case as 

)

+

                                                  
)
2 Note that   b
s s    pertains to what the leaf bottom ‘emits’, since  
=
)
-+
+
+ +
transmitted through from the other side, and  
s-+
)
)
)
contrast, 
s s
+
a
+
+ +
+ -
absorbed). If there is zero emission, then (81) implies  b
)
)
+
a± £ 1), i.e., zero absorption. Note that  
a± = 0  (since  
)
)
)
1
3
4 ,   
4 ,   
  
s-+ =
s+ - =
s+ + =

b
b
= 1, hence   b
-=
)
-
a± = 0  do not imply   b
1
2 .

)
a± = 0, but   b

)
1
4 ,   
s-- =

3
4   yield  

)
s+ +

= -1

3
2 ,  b

+ =

- =

+

+

  is the fraction of ‘down’ light

)
)
a a
-
+
-
= 1: For instance,

=

2

, hence

2
= -
b
-=

+

 the fraction of incident ‘up’ light reflected back down. By

  is the fraction of light incident on the top of the leaf that gets scattered (hence is not

(80)

(81)

(82)

19

d
dz

 m

f

( )
I z

1
2

(
G W

f

=

, )
z

)
e

1
p

[

)
a

( )
z

-

( )
I z

]+

1
2

(
DG W

f

, )
z

( )
z

+

(
b
+

-

) ( )
b I z
]
-

(84)

)
e
D

1
p

[

(
Assume now that  h
W L

z
, )

1
= p
2

˜(
h m
L

z
, )

  is jL-symmetric. Then,  DG W(

f

z
, )

(31), where   mL z

  is the mean leaf inclination at height  z. It follows that if    1
p

f

L z

=h m m   by
)
z
a( )
-

z
( )
)
e

I z
( )

=

0

,

then (84) can be divided by mf , and becomes:

I z
( )

1
2

z
( )
h m

=

L z

z
( )

+

b
(
+

-

b I z
) ( )
]
-

       if      1
p

)
e

)
z
a( )
=

I z
( )

Let us now (artificially) assume emissions proportional to   I z( ), by setting

)
   
e
±

z
( )

= p
)
e

c I z
±

( ),

)
z
a( )
=

= p

c I z
(
g

)
g ,           c

∫

c

++

c

-

The condition    1
p

I z   then becomes   c =
( )

)
a, and we get, putting   b

∫

b
±

+

c

±

:

±

I z
( )

1
z
( )
2h m

=

L z

b
(
-+

b I z
) ( )
-

 if       c

= ¤ +

b
+

b
-

2

=

)
a

)
eD

1
p

[

)
e
g

d
  
dz

d
dz

I

z
, )
(
W =

( )
I z

=

(
I z e
0

)

1
2

z

Ú

z

0

dz

(
h
¢

z

¢

)

m

L z

¢

(

b

b

-

-

)

+

,

b
±

∫

b
±

+

c

±

The radiance (88) is the solution of (87) provided boundary conditions are compatible with it,

namely   D

)W 0
z
,
(

)
)
0∫   is ‘down’ isotropic, and    
=
e ag
g

I

(
I z

)  in (81) holds, i.e.,   cg

g

)
a . In
g=

numerical tests, we will substitute (88) into (86), and verify how accurately our numerical

integration of the LTE (40),(44), with these emissions, gives back the light climate (88). Note
that if the distribution   ˜(

  of leaf inclinations is uniform in  z, then

)

l m
L

, )
z =

˜(
l m
L

( )
  I z

=

(
I z e
0

)

1
2 L

( )
z

m
L

(

b

b
--

)

+

,                 L

z
( )

∫

L

(

z z
, )
0

  

where    L( )z   is the LAI above  z . If   ˜(
= 1, implying (81), then   I z
b
( )
+

b
-=

=

l mL z =

, )

2   is isotropic, so that   mL z = 0, or if

1

(
I z

)
=0

I

0  is uniform, as found after Eq.(79).3

Example: One dimensional model: Suppose all photons travel along the  z axis, so that   WW = ±uz .

Assume also that  h( )z = 1  and   mL z = 1  for all z, and that all  

)
s ’s  are zero, i.e., there is no

                                                  
3 Note that   b
= 1  implies   c
+
±
each side of the leaf equals absorption. With  
immersed in thermal light of the same temperature.

b
-=

=

±

)
)
)
(
a s s

)
a   if  
, i.e., emission by
±
±=
)
a± = 1, this corresponds to black body leaves at a given temperature

)
=
s-+

), hence   c

)
s

-

+ -

+ -

-+

±

(85)

(86)

(87)

(88)

(89)

20

)
)
)
scattering, so that    
-=
a a a

=

+

=g

1. Then the ‘down’ and ‘up’ radiances at   D z( )  and  U z( )  at

z  consist of the incident radiance   D0  at   z

z= 0 , plus light emitted above or below  z , attenuated

due to interception by leaves, that is:

z

Ú

z

0

z z
(
- -

)

0

+

( )

( )
z

D z D e
=
0
  
where    E
=
local canopy emission    E (
c =

)
a 2  and    cg

, )
z

E

u

=

(

D

z

dz

E

¢

D

(

z e
)
¢

(

z z
- - ¢

)

,

( )
U z

=

e
g

e

z z
-

g

dz

E
U

¢

(

z e
)
¢

z z
- ¢

 

(90)

z

g

+

Ú

z

  and    E

U

( )
z

E

(

-u

z

=

, )
z

  are the ‘down’ and ‘up’ components of the

, )W z . If the isotropic radiance conditions are satisfied, i.e., if

)
a 1, see (87), then (88) becomes   I z D e c
g=

( )

=

=

1
2

0

(

c
--

)(

z z
-

+

)
0 . By then plugging

)  into (90), and doing the integrals using

( )
  ED z
c
c

-

+

-

( )
c I z

= +

= -

( )
c I z

,   EU z
( )
2 , one indeed gets   D z U z
( )
c

, and  eg

I z= (

( )

g

=

± = ±2

±

( )
I z

.

=

11   Canopy of horizontal Lambertian leaves

          In this and the next section, we will refer to equations in Ref.[5], which will be written as
)
s

I-(10), for instance. We here use the notations  

)
s+ - = du, etc.

)
s+ + = dd , 

)
s

With horizontal Lambertian leaves, the canopy optical coefficients are given by

(
G W

z
, )

( ) ˆ,
z
h m

=

(
W

i

S
  

Æ

W

f

z
, )

= p

f

E

W

,
z
(
)
1
( ) ˆ ˆ
z
-
h mm s
i

f

) = p

sgn

m

f

,sgn

m
i

)
1
( ) ˆ
z
-
h m e
sgn

f

m

f

 in view of (32) and (69). So the LTE (40) divided by  ˆmf , and (44), become:

sgn

m

f

I

(
W

f

z
, )

z
( )

=

h

I

(
W

-

[

        

d
dz

)
ms
i

, ) ˆ
z

sgn

m
i

,sgn

m

f

)
e
sgn

1
p

+

z
( )

m

f

]

1
p

Ú

f

z
, )

+
)
) ˆ
ms
i

i

d

I
(
W W
i
)
)
(
s
e
g

=

1
p

)
e
g

1
p

f

g

,

)

z

(
W

=

U
  

)
This will now be solved analytically, in the absence of emissions.

d D
W W
i

D
g
g

Ú

+

+

z

m
i

(

,

>

g

g

0

i

1
p

LTE for the total down and up fluxes: Multiplying (92) by   ˆmf , and integrating over   W f DŒ

or   W f UŒ , we get equations for the total vertical fluxes    D( )z   and    U( )z :
)
s
1
- +

( )
z
ˆ
˜ +
( )
z
¯

1
- +
)
s

( )
z
ˆ
˜
( )
z
¯

E
E
U

D
U

d
dz

)
s

( )
z

M

M

Ê
Á
Ë

Ê
Á
Ë

Ê
Á
Ë

Ê
Á
Ë

h

-

∫

du

dd

,

D

ud
)
s

uu

ˆ
˜
¯

D
U
)
s

( )
z
ˆ
˜ =
( )
z
¯
)
e
g

D
g
g

+

U
   
g

=

(we used (4) and (39)) where the ‘down’ and ‘up’ emitted vertical fluxes are

(91)

(92)

(93)

    E

D

( )
z

=

)
( )
z
h e
+

( ),
z

E
U

( )
z

=

)
z
( )
h e
-

( )
z

21

Eq.(93) has the form of the matrix transport equation I-(11) in Ref.[5], but in two dimensions (up

and down). The transfer matrix for a layer of   LAI = L   is, on using (A.4) and   s ∫

1

0

Ê
Á
Ë

0

ˆ
˜
1
-
¯

:

L

sM

T

e

=

1
2

e

=

L

Tr

(

sM

)

M sM 1

Tr

(

sM

)

1
2

-

∫

=

cosh

1
[

l
1
- +

+
1
2

Ê
Á
Ë

,
]
l l
)

(sinh )
M
L
)
)
(
s s
+
dd
)
s
-

uu

du

1

-

l
  

∫ -

det

L

M

L

=

,

D

D

det

M

)
s

1
2

)
s

1
2

2

∫ -
)
s

1
(
= -
)
s

)
)
s s
-
dd

=

uu

)
)
s s
du

0

≥

ud

Tr

(

sM

)

ud

)
s
)
)
(
s s
+
uu
dd
)
)
s
s
dd
)
)
(
s s
-
dd

-

11
2

1
2

1
2

1
4

uu

ˆ
˜
)
¯
2
) -

2

Note that   D ≥ -
)
)
s
s

) =
, by (55), so that  l  is always real. If there is zero emission, then the flux vector

1
) - -(

  since  

1
) -(

£ -1

£ -1

) ≥

1
(

-

0

uu

uu

dd

dd

uu

ud

uu

dd

du

)
s

)
s

  and

z
( ),

= (

D U   is given by   J

  J( )
z
be obtained analytically by using I-(19,20), since here   TDD,  TDU , etc., are scalars.

0 , see I-(14), and the ‘up’ flux    U(
)
z

( )
z
)

z z
( ,
0

) (
J

z
( )

T

=

)z0   can

The vertical fluxes    D( )z   and   U( )z   so obtained in fact provide the complete solution.
Indeed, because each horizontal layer  dz  of canopy acts as a Lambertian surface, all scattered

(and emitted if any) radiance is semi-isotropic, i.e., of the form

    D

scatt

(
W

, )
z

=

1
p

D

scatt

( ),
z

scatt

U

(
W

, )
z

=

1
p

U

scatt

( )
z

The only radiance possibly not semi-isotropic is the unscattered light

0
( )

  D

(
W

, )
z

∫

e

- L

( )
z

D

(
,
W

z
0

),

L

( )
z

∫

L

(

, )
z z
0

where we recalled, see after Eq.(37), that in the case of horizontal leaves:

(

z z
,
2
1

)

= - L
e

  xW

(

z z
,
1

2

)

,           

z

2

L(
  

z z
,
2
1

)

= Ú h  
( )
z
dz

z
1

scatt z
( )

Now,   U
=
where    D D0

=

(

U

( )
z

  (all ‘up’ light is necessarily scattered), while    D

scatt

( )
z

D

( )
z

e
- -

=

( )
z
DL

0 ,

)z
0

  is the vertical flux at  z0. So finally:

(
W

, )
z

=

1
p

U

( ),
z

U
  

D

(
W

, )
z

=

-

e

L

( )
z

D

(
,
W

z

0

)

+

1
p

(
D

( )
z

-

e

-

L

( )
z

D
0

)

U   into (92) gives back Eq.(93). Note also that if the leaves and ground

z
, )
(
W = p

1 D . Note that substituting

( )
z

1

0

1
p

= p D   is ‘down’ isotropic, see (48), then    D
1D
( ),
z
p

If    D
)W 0
z
,
(
z
, )
(
  I
W = {
are non-emitting and non-absorbing, then    U
fully isotropic, provided    D

D( )
z
=
= p D   is ‘down’ isotropic.

)W 0
z
,
(

( )
z
}

z
( )

1

0

z
, )
(
  by (46), so that   I
W = p

1 D   is
z
( )

(94)

(95)

(96)

(97)

(98)

(99)

22

12    A case of extreme light trapping

Consider the following situation:

(i)  There are no intrinsic emissions by the leaves or by the ground.

(ii)  All leaves are horizontal, completely transparent from the top, 
)
)
=
s sdu

)
sud = 1. Thus, 

from the bottom, 

= 0 , and there is zero absorption.

uu

)
sdd = 1, and totally reflective

(iii)  The ground is perfectly reflective:  R
g

d

W

s
f

g

(
W

i

Æ

W

f

)

=

.
1

∫

>Ú

m

f

0

This artificial situation will be treated in some detail, as a two-dimensional illustration of the

methods discussed in Ref.[5]. We let    L
the total LAI of the canopy. We will need the formula

z z
, )
0

z
( )

L

∫

(

  be the LAI above  z, and  

  L L∫ (

z zg
,
0

)

  be

N

Â

n

1
=

N n
-

a

N

1
-

m

N

0

=

m

a

a

1
= -(

Â=
)
sdd = 1, all ‘down’ light    D D D

+

1
-(

)

a

)

0

Heuristics: Since  

=
canopy reaches the ground  zg, where it is totally reflected. A fraction    t = -e L  of that reflected
light makes it to   z0  unimpeded, and escapes. The rest hits some leaf, and is reflected back down

h   incident on the top   z0  of the

d
0

0

(100)

to   zg , where it is reflected back up, and so on. Since there is no absorption and no emission,

what comes out must equal what comes in,   U D0
0=

, hence    U

D( )
z
=

z
( )

  at all z, by (41).

This is similar to a greenhouse with a perfectly reflecting surface at  zg, and at   z0  a

membrane letting all ‘down’ light from above through, but reflecting all ‘up’ light from below,

except for a fraction  t   that is let through. So radiation builds up between the two surfaces, until

it is sufficiently intense that what escapes equals what comes in, i.e., until  

  U U D
t g

=

=

0

0

, or

0 . For small    t = -e L, this buildup requires many back and forth reflections. Since the

DL

e=

U
g
  
kth  reflection adds    (
1

)

kD   to  

0

-t

  Ug , we indeed get, putting   r ∫ -1 t:

  
  U

g

1
(
= + +

r

2

r

+

...
)

D
0

1
= -(

r

)

1
-
D
0

1
-
D
0

,

=

t

r

1
∫ -

t

,

L

-

e

 

t

∫

(101)

Let  k  be the number of terms in the series (101) (hence of reflections) required to approximate
  t-1

0D   to within some relative error  d. Since

1
-

s

∫

t

s

k

=

+

•

Â

n k

= +

1

n

r

s

k

=

+

r

k

+

1          where       s
s

k

m

r

∫

k

=Â 0

m

(102)

23

the relative error is  d

∫

(

s

-

s

k

)

s

=

r

k

1

+

1
(
= -

t

)

k

1

+

, so that we require

1
+ ≥

(ln ) ln(
1
d

)

-

t

ª -

t

1
-

(ln )
d

= -

L

e

(ln )
d

  k

(103)

since   ln(

1 -

t

)

ª -

t  for small t. For instance,   L = 10  and  d =

-10 3  yield    eL

ª 22 000  and

k ª 152 000. Thus, for instance, Monte Carlo computations would be prohibitively long, since
each photon will rebound that many times, on average, before escaping.

Remark: Since fluxes get attenuated along their direction of propagation, radiances usually

decrease from the top  z0  to the bottom  zg  of the canopy. But in the present situation, the

radiances increase from  z0  to  zg, because light is not attenuated on the way down, while all ‘up’

light hitting a leaf gets reflected down to the ground.

Explicit solutions: We next solve the LTE (93) by using the three main methods of Ref.[5],

namely the direct transfer matrix method, the Green’s matrix method, and iterative integration. In

order to illustrate these methods with emission terms present, we will treat first-scattered sunlight

as an ‘emission’. Since    D
straight through it, hence is ‘re-emitted’ downwards, the local canopy ‘sun emissions’, integrated

h
0 , and since any sunlight intercepted by a leaf just goes

DL

e
= -

( )
z

( )
z

h

either over   W f DŒ   or over   W f UŒ , are:

        

h
D

E
  

( )
z

-

e

=

L

( )
z

h
D
h
0

( ),
z

h
E
U

( )
z

0
,

=

h
e
g

=

-

e

h
L
D
0

Transfer matrix method: Here,  M =

0
0

Ê
Á
Ë

ˆ
1
˜
1
-
¯

  in (93), so that   M = -Ê

1 2
0

Á
Ë

1
1 2

ˆ
˜
¯

  and   D =

1
4   in (95).

Thus, by (95) and I-(14)(b), the transfer matrix and propagated emissions are

z z
( ,
0

)

=

T
  

DD

T
T
UD

Ê
Á
Ë

DU

T
T
UU

ˆ
˜ =
¯

1

0

Ê
Á
Ë

L

z
( )

e

L

e

-
z
( )

,

1
ˆ
˜
¯

f

z
( )

=

D

f
f
U

ˆ
˜ =
¯

Ê
Á
Ë

Ê
Á
Ë

-

e

1
-(

h
0

z
( )

L D
)
0

ˆ
˜
¯

f
D
  
= (
E

where  

( )
z

h
D
0

=

dz

(
h
¢

z e
)
¢

L

(

z

)

¢

-

h
D
0

=

1
-(

L

z
( )

-

e

)

  and   f

zU ( ) = 0, by (98) and since

z

Ú

z

0

h
D

( )
z

( ),
z

Eh
  
I-(20), we get (here, Rg ,  T

0 , so that  
)

T
  
,
TDD

z z
( ,

DU

h

h
D

¢

(

(

z

)
E

)
¢ =

(
E
, etc., are scalars):

z

¢

),

0 . With   Rg = 1  and  
)

e
g
  

h
e
g

= - LD0   in

e

h

=

R T

g DD

T
UU

-

T
UD

-
R T

g DU

1
= =
1

,
1

=

R
0
  

e
0

=

R f
g D
T
UU

-
-

e
g

f
+
U
R T

g DU

h
D
0

=

whence    U U

=

0

d
0

=

d
R
D
0
0

e
0

+

=

D D D
0

=

+

d
0

h
0

, as should be. Also, by I-(14)(a):

(104)

(105)

(106)

24

d

D

U

( )
z
ˆ
˜ =
¯

( )
z

Ê
Á
Ë
  

T

( ,
z z
0

d
D
0
U
0

Ê
)
Á
Ë

ˆ
˜ +
¯

f

( )
z

=

L

z
( )

e

D D
-
0
z
( )
L
e
D
0

h

( )
z
ˆ
˜
¯

,

Ê
Á
Ë

h
D D D
0

d
0

0

=

+

(107)

h

( )
z

where    D
+
exponentially down the canopy (light trapping). Note that if    L   is large, then the denominator in

0 , that is, radiance increases

0 . Thus,   D

e
= -

z
( )

z
( )

z
( )

D

D

=

=

e

( )
z

DL

h

z
( )

DL

d

h

(106), namely  

T
UU
  

R T

g DU

-

=

L

e

-

(

e

L 1
-

) =

1, is the difference of two large numbers,   eL   and

  eL
- 1. So numerical nonsense is expected whenever    eL
numerical computations (in double precision), i.e., if    L >

> 1014   if 15 digits are carried in
ln
14 10

30

.

ª

Green’s matrix method: The transmission-reflection matrices and emission vectors for the whole

canopy follow from I-(22) and (105) with   z

zg=  (they are rather obvious):

r

ˆ
˜ =
¯

Ê
Á
Ë

1 1
0

-

t

t

,

ˆ
˜
¯

r t

t

Ê
Á
Ë
  

d
u

Ê
Á
Ë

ˆ
˜ =
¯

1
(
-Ê
Á
Ë

h
)D
t
0
0

ˆ
˜
¯

 ,              t = -e L

(108)

where  t  is the ‘up’ transmission through the whole canopy. Note that the total ‘emission’  d

from the bottom of the canopy (due to first-scattered sunlight ‘emission’) is equal to the

-t D h , because any sunlight intercepted by a leaf goes straight through
intercepted sunlight    (
1
it, hence is ‘re-emitted’ downwards, and is then propagated without attenuation down to  zg  (that

)

0

is, out of the foliage). Eqs. I-(33), in the case of a single ‘medium’ layer, become:

(109)

1

)-
zg= .

    

d

+

t

d
D
0
e
g

Ê
Á
Ë

ˆ
˜ =
¯

Ê
Á
Ë

d
D
0

(
1
+ -
t
h
D
0

t

h
)
D
0

,

ˆ
˜
¯

=

E
  

r

0

ˆ
˜ =
¯

Ê
Á
Ë

0 1
1

-
t
0

ˆ
˜
¯

Q

=

0
R
g

Ê
Á
Ë

2

Noting that    Q 2
1 1 Q . Here, 
-t
+(
)

1= -(

)t 1, hence    (
1
,
= (
J D U
  

d
g

g , see I-(33), and    J GE=
)
  =
Note that    G  is not obtainable numerically if  15 digits are carried and    L > 30, for then

Q

1
)(

Q

)

1
= -

-

+

=

Q t1, we deduce that    G

1
∫ -(
  in I-(34) yields (107) with   z

Q

-10 14   and  1 -t  is indistinguishable from 1. But of course, we would then use several
= -1 t   be too close to 1. To have    e mL
ln
7 10 15

t <
‘medium’ layers (indexed by  m), such that no   rm
say, these medium layers should be of LAI    Lm <

ª

.

m

< 10 7

Iterative integration:  With  N  thin layers of   LAI
matrices are given by (108) with  t  replaced by    Dt = -e

= L , the thin-layer transmission-reflection

N

NL

. Since the attenuated sunlight

incident on the  nth  layer (counting from the top  z0 ) is    (

)Dt

n

-1

h

0D , and   (

N

)Dt

= , the
t

25

iteration equations I-(39) read in the present case:

t
D

)
U
n

(
1
+ -

)(
t t
D
D

)

n

h
1
-
D
0

d
d
D D
=
1
n
n
-
d
U D
=
N

(
1
+ -
h
D
0

N
U
  
n

=

t
D

1
-

t
+
U
n

              (  Dt ∫ -e

NL

)

(110)

where  

  D D D

=

∫

N

g

(

gz

)  and  

  U U U

=

∫

N

g

(

gz

). It follows that

 

  U

n

=

(

)Dt

N n
-

U
N

,             

d
d
D D
=
0
n
  

1(
+ -

t
D

n

)
=Â

m

1

(
U

m

(

t
D

+

m

)

h
1
-
D
0

)

(111)

expressing that    U   decreases from   zg   to  z0, since any ‘up’ light hitting a leaf gets reflected

down to  zg, while ‘down’ light increases from  z0  to   zg   since nothing blocks it, and it picks up

on the way down all downwards reflected ‘up’ light, as well as all first-scattered sunlight

‘emissions’. Doing the sums in (111) (with   n N=

), by using (100)  and  t

)D
t∫ (

N , we get:

(112)

(113)

(114)

d
d
D D
-
0
N
  

(
1
= -

t
D

N

)
=Â

n

1

(

(

)

t
D

N n
-

U

N

(

t
D

+

n

)

h
1
-
D
0

Using    D U

=

N

d
N

h

-t 0   from (110), and    D D D

D

-

=

0

d
0

h
0

t

h
)
(
U D
+
0

) = -
(
1
, we rewrite (112) as  

)

N

  U D U

+0

=

g

r

g

           where         r = -1 t

Thus, if  

k( )   is the value of  

(
  Ug   obtained after the kth iteration, then  
U D U
g
  

( )
k
g

+

=

r

0

k

1 . So
)
-

Ug
  
( )0

with  

Ug
  

0∫ , successive iterations yield

( )1
U Dg
0=
  

,      

2
( )
g

U D D
0
  

=

+

0

r

,

L

( )
k
U D
=
0
g

k

=Â

m

0

m

r

so that again, 

k( )
U
g
  

Æ -t

1
D

0   as  k Æ •. The Green’s matrix method amounts to solving (113)

directly, namely  

)
shows that the  kth iteration adds in  kth scattered light.

1
= -(

  U

t

=

r

g

1
-
D
0

1
-
D
0

. Note that rewriting (114) as  

(
( )
k
U U
=
g
g
  

k

)

+-1

kr

D
0

In the above, we used the exact thin-layer transmission-reflection matrices, namely (108)

with   Dt  instead of  t . If these were treated to first order in the thin-layer thickness  Dz, as

usually has to be done in realistic numerical computations, then as argued after Eq. I-(46), the

thin-layer transmissions would be too small, and the reflections too large. This would lead to too

much light trapping in the present situation.

26

13   Conclusion

The numerical integration methods proposed in Ref.[5] will be used in subsequent papers

to compute light climates and rates of photosynthesis in realistic canopies. But the accuracy of

our methods will first be tested by applying them to the models discussed in the present paper,

and then comparing the numerical results with the analytical solutions. We will find that

accuracy, as well as speed, are generally much better than provided by the widely used iterative

integration [1-3]. The latter may in fact become impractical in certain situations, such as extreme

light trapping, while our method remains as efficient. For realistic canopies, however, iterative

integration is of sufficient accuracy (except perhaps in the case of grazing sunlight). But the fact

that our method is faster (as well as more accurate) is a significant advantage when repeated

integrations of the LTE must be done, as when iterating over leaf temperatures.

 

Let us end by indicating ways in which the basic theory (in Part I) can be generalized:

(i)  To allow for several kinds of leaves or phytoelements (twigs, fruits, etc.), define ‘leaf’ area

densities  hp

, )W r , and optical coefficients  sp  and  ep , for each kind  p  of phytoelement.
(

L

Then the canopy optical coefficients involve sums over  p.

(ii) To allow the frequency  n  and polarization  p  of photons to get changed by scatterings off

leaves, let  W  include  n  and  p, besides directions.

(iii) Note finally that horizontally non-homogeneous situations can also be treated by letting  W 

include horizontal coordinates (e.g., points of entry into the canopy at height  z0).

27

Appendix A: Functions of a  2 2¥  matrix

Denote, for any  2 2¥  matrix K, and any analytic function  f x( ):

k

=

1
2

Tr

,
K

,
K K 1

k

=
) =

-
•

0

=

det

K

l

= -
n

( )
n

1
!
n

f

( )
k

K

,

( )
n

f

( )
x

∫

n

d f dx

n

f

(

)

=

K

f k
+(

Â
We now have, since   TrK = 0 :

K

n

K

=

a

c

Ê
Á
Ë

b

a

-

,

ˆ
˜
¯

2

K

=

2

a

bc

+
0

Ê
Á
Ë

0

+

2

a

bc

ˆ
˜ = -
¯

det
1 K

2
l

1

=

so that   K

2

m

2

m

= l ,  K

1

2

m

1

+ = l . It follows that

K

2

m

f

K 1
) =

(

1
m

)!

f

(

2

0

(

2

m

)

( )
k

1
2

=

)
l

+

+

(
f k

-

•

Â
m
=
(
f k
[

m

2
l

+
)
1
] +
l

K

1
2
l

•

Â
[

0
m
=
(
f k

1
m
+

(

2

)!
1

f

(

2

m

)
1

+

)
l

+

-

(
f k

-

m

( )
k

2
l
)
]
l

K

In particular:

K

e

=

1
2

Tr

K K
e

,

e

K

e

1

cosh

l

+

K

(sinh )

l l

=

Appendix B: Some integrals involving  WW WW◊
¢

In this Appendix, we evaluate some integrals involving scalar products

W ◊ W¢ = +

a b

cos(

j j
- ¢

),

a

,
mm
¢

∫

b

∫

sin sin

q q 0

¢ ≥

where   sinq ≥ 0  since  q Œ p( ,
)0

. Also, m

=

cos

q

(
Œ -

, )1 1 , so that

1
-

cos

0m
( ,
Œ p

),

1
cos (
-

)
m

-

= p -

1
-

cos

m

We will use the function

)
(
z m

=

2

1

-

-
m m

1
-

cos

m

1
-

,
m

(

)
)
z m z m

=

-

(

+ p

m

(cos )
q

z

=

sin

q q q

-

cos

=

q

0
( ,
Œ p

),

m

(
Œ -

1 1
, )

= -

cos

d
m

Ú
d
sin ,
qq q

Ú

B.1   The functions  g( ,

)m m¢ : Denote

(A.1)

(A.2)

(A.3)

(A.4)

(B.1)

(B.2)

(B.3)

g

( ,
m m

)
¢ =

g

+

g

-

=

1
2
p

d
j

W ◊ W¢ =

d
j

a b
+

cos

j

(B.4)

g

±

( ,
m m

)
¢ =

1
2
p

W ◊ W¢ =

±

1
2

g

( ,
m m

)
¢ ±

1
2

mm
¢

p

-p

d
j

Ú
+

p

Ú

-p

p

p

-p

1
2
p

Ú
mm
¢

g
D

( ,
m m

)
¢ ∫

g

Ú
Note the integral and special values (since, e.g.,  b = 0   if  m¢ = 1):

W ◊ W¢ =

-

=

-p

+

-

d
j

g

1
2
p

( )
a

( )
b

( )
c

28

p

-p

Ú
a b

(
Æ - +
)
- ¢ =

1

Ú

1
-

( ,
d g
m m m

)
¢ =

1
2
p

d
W WW WW
◊

¢ =

1

Ú

p

g

1
( , )
m

=

Ú
Note also the symmetries, since   a b

-p

ˆ,
d
j m m

=

1
2
p

g

0
( , )
m

=

1
2
p

d
sin cos
j q j

=

1
p

sin

q

  

+

cos

j

cos(

j

+ p

)
)

 under  ( ,

m m

¢ Æ - ¢ :
( ,
)
)
m m

g

( ,
m m

)
¢ =

g

,
(
)
¢
m m

=

g

(

,
m m

)
¢ =

-

g

( ,
m m

g

(

,
- - ¢
m m

)

If   ˆa b≥ , then   a b

+

cos

j

=

(sgn )(

a a b

+

cos )

j   for all  j , so that   g

( ,
m m¢ =

)

(sgn )
a a

ˆ
= . If
a

ˆa b£ , then, since   b ≥ 0 , and   b

cosj + < 0  for   cosj < -a b:

a

g

+

( ,
m m

)
¢ =

c

j1
Ú
2
p

j
-
c

d
j

(

b

cos

j

+

a

) =

1
p

(

b

sin

j j
+
c

c

a

,
)

j
c

∫

1
-

cos

-(

a b

)

(B.8)

Hence, noting that   sin

jc

=

-1

(

a b

)

2 , and using (B.3):

g

( ,
m m

)
¢ =

2

g

+

-

g
D

=

ˆ ˆ
mm
¢
Ï
Ì
2
b
-(
z
ÓÔ
p

a b

a

) -

if

if

ˆ
a b
≥
ˆ
a b
£

Note that the symmetries (B.7) follow from  z m z m
)

=

-

(

(

)

+ p .
m

B.2   The functions  guu:  We next evaluate (u  stands for  +  or  - )

(B.5)

(B.6)

(B.7)

(B.9)

g

,
u u
i

f

(
,
m m m j
f
if

,

,

L

i

)

∫

W ◊ W W ◊ W
u
i

L

f

i

L u

f

   

 

   

(B.10)

d
j a
L
i

+

cos

j a
L u
i

f

+

cos(

+
j j
L
if

)

u

f

p

-p

Ú
b b
i

d
j
L

p

Ú

-p

f

=

where j j j

-

∫

if

i

f

, and  ai

a b
i
i

, a f

=

=

a b
f

f

, with

a
i

=

mm
i
L

,

b
i

=

sin sin
i

q q
L

,

a

f

=

m m
f
L

,

b

f

=

sin

q

f

sin

q
L

(B.11)

The integration (B.10) is over (one or two) intervals   (

,
j jL
1
L

2   wherein   ui
)

(
a
i

cos
j+
L

) >

0  and

cos(

+

+
j j
L
if

0   simultaneously. Hence,  b b g

1
-1
-
f
i

,
u ui

f

  is a sum of (one or two) terms

f

a
f
a
i

( ,
j j
L

2

)

-

f

a
f
a
i

)

a
, where  f
a
i

f

j j( ,

L

)  is the indefinite integral

f

a
f
a
i

)

+

=

Ú

cos

)
d
)
(
)
(
j a
-
j j
j a
L
L
L
i
sin(
)
j j a j j a j
L
L

( ,
j j
L
(
aa
i
  is not simple, but is known analytically, and easy to program on the computer.

2
)
-
j j
L

cos(

sin(

cos

sin

+

+

+

-

+

+

1
2

1
4

)

L

f

f

f

i

=

(B.12)

Thus   gu ui

,

f

)
) >
( ,
j j
L

1

u f

(
a

f

  

29

 B.3  Other integrals: We now show that

W W ◊ W W ◊ W =
u
i

L u

L

L

f

i

f

u u
i

-

W ◊ W
i

f

f

2
(
3z

)

d

Ú

p

Ú

-p

d
j
L

W ◊ W W ◊ W =
f

L

i

L u

f

u
i

1
2 sin sin
i

(
q q z

f

u u
i

f

-

cos(

-
j j
f
i

)       if   mL = 0
)

We first show that

p

-p

Ú
cos

( )
c f
,
u u
i

f

∫

d
j
L

cos

j

L u
i

cos(

)
-
j f
L

u

f

1
2

(
z

-

u u
i

f

cos )
f

=

Since   cos(

)
=j
-

j  and   cos(

j

)
+ p =

cos(

p -

)
j

= -

cos

j

, we have

( )
c f c

,
u u
i

=

f

,
u u
i

f

(

-
f

),

c
-

,
u u
i

f

( )
=
f c
u
i

,

-

u

f

( )
=
f c

,
u u
i

f

(

p -

)
f

Hence it suffices to evaluate  c f-+ ( )  for  f Œ p( ,
)0
x
cos cos
)

=
f j
L
, and (B.3), we get, for  f Œ p( ,
)0

. Putting  j

cos(

cos(

-

-

+

+

=

x

x

y

y

y

1
2

1
2

)

:

L

1
2

, using

( )
c f
-+

d
j
L

cos(

j
L

+

1
2

f

) cos(
-

j
L

1
2

)
f

-

+

=

Ú
= -

1
2

1
2

p+

1
f
2

Ú

1
2

p-

1
f
2

d
j
L

cos

2
j
L

+

cos

[

] =
f

1
2

(

sin

f f f

-

cos

) =

1
2

(cos )
f

z

(B.13)

(B.14)

(B.15)

(B.16)

(B.17)

We used  cos(

j
L

+

1
2

)
f

< ¤ Œ -
j
L

(

p
2

0

f
2

,

3
p
2

f
2

-

)

  and   cos(

>

0 ¤ Œ - +

j
L

p
2

(

f
2

,

p
2

f
2 ,
)

+

the intersection of the two intervals being   (

p
2

-

f
2

,

p
2

+

1
)
j
fL -
2
f , if  f Œ p( ,
)
)0

2

.

To prove (B.13), note that its left side is a function of the angle between  Wi  and  Wf , so
  where
(
m
i

that we may choose coordinate axes such that   Wi

0
,
)
j f
=
f

0 ,  W =
)

j0
,

(
m

=

=

=

=

f

f

i

cosf = W ◊ Wi

f . Then   W ◊ W =

L

i

1

2
m
L

-

jcos

L

,  W ◊ W =

L

f

1

2
m
L

-

cos(

j f
-
L

), so that

1

(B.13) =  d
Ú

1
-

p

Ú

-p

m
L

1(

2
m
L

)

-

d
j
L

cos

j

L u
i

cos(

)
j f
-
L

u

f

4
3

( )
c f
,
u u
i

f

=

(B.18)

As to (B.14), it follows from   W ◊ W =

L

sin cos(

q j j   if  mL = 0 , and (B.15).

-

)

L

We finally note the indefinite integrals (m

∫ cos ):

q

∫

=

f
1

( )
q

d
)
(
mz m

Ú
Ú
whence the definite integrals

Ú
(cos )
q

d
qz

( )
q

∫

f

2

(sin )
d

q q q q q

-

cos

sin

(

) =

1
2

q

-

3
8

sin

1
2
+
q q
4

cos

2
q

2
= -

cos

sin ,
q q q

-

q

0
( ,
Œ p

)

(B.19)

30

Ú
( )
2
p -

1

Ú

Ú

1
-

p

-p

)
(
d
mz m
±

=

f
1

( )
p -

f
1

( )
0

3
= p
4

,

d
W

(
z

± ◊

W W

3
)
¢ = p
2

2

(cos )
d
jz j

=

2

d
qz

(cos )
q

=

2

f

f

( )
0

8

=

(B.20)

By using (B.20) and  

d f
q

2

sin

q

f

1
= p
2

, one can verify (82) directly on (71) and (70).

p

Ú

0

p

Ú

0

References

[1]  J. Goudriaan, Crop Micrometeorology: A Simulation Study, Pudoc, Wageningen (1977)

[2]  R.B. Myneni, J. Ross and G. Asrar, A review on the theory of photon transport in leaf

canopies, Agricultural and Forest Meteorology, 45 (1989), 1-153

[3]  Photon-Vegetation Interactions, edited by R.B. Myneni and J. Ross, Springer 1991

[4]  H.H. Natsuyama, S. Ueno, A.P. Wang, Terrestrial Radiative Transfer, Springer 1998.

[5]  A. Royer and S. Royer, Integrating transport equations by combining transfer matrices,

transmission-reflection matrices, and Green’s matrices, in the context of light propagation in foliage,

arXiv.org/physics/0501064

