L A B O R A T O R I  N A Z I O NA LI   D I  FR A S C A T I

SIS – Pubblicazioni

      LNF-94/041 (P)
      5 September 1994

Wake Fields and Impedance

L. Palumbo 

◊)
◊*), V.G. Vaccaro @§) and M. Zobov 
◊)

INFN-LNF Frascati

§)  INFN, Sezione di Napoli
*) Università di Roma "La Sapienza"
@) Università di Napoli "Federico II"

Abstract

Knowledge  of  the  electromagnetic  interaction  between  a  beam  and  the  sur-
rounding  vacuum  chamber  is necessary  in  order  to  optimize  the  accelerator  per-
formance  in  terms  of  stored  current.  Many  instability  phenomena  may  occur  in
the machine because of the fields produced by  the  beam  and  acting  back  on  itself
as in a feedback device. Basically, these fields produce an extra voltage  and  energy
gain, affecting the longitudinal  dynamics,  and  a  transverse  momentum  kick  which
deflects  the  beam.  In  this  paper  we describe  the  main  features  of  this  interaction
with typical  machine components.

Lecture given at the
“CAS Advanced School on Accelerator Physics”
Rhodes – Greece 20 Sept. 1 Oct. (1994)

- 2 -

1.

INTRODUCTION

The so  called "collective effects"  are  responsible  of  many  phenomena  which  limit  the
performance  of  an  accelerator  in  terms  of  beam  quality  and  stored  current.  The  beam
traveling inside  a  complicated  vacuum  chamber,  induces  electromagnetic  fields  which  may
affect the dynamics of the beam itself. An  accelerator  can  be  seen  therefore  as  a  feedback
device, where any longitudinal or transverse perturbation appearing in the beam  distribution
may be amplified (or damped) by the e.m. forces generated by the perturbation itself.

The e.m. fields induced by the beam are referred to as wake fields due  to  the  fact  that
they are left mainly behind the traveling charge. In the limit case of a charge moving  at  the
light velocity, β=1, the fields can only stay behind the charge because of the causality prin-
ciple.

 The study of the longitudinal and transverse beam dynamics requires the knowledge of
the forces acting on the beam or, alternatively, the change in momentum caused by these e.m.
forces. The longitudinal wake potential (volts) is the voltage gain of a unit trailing charge due
to  the  fields  created  by  a  leading  charge.  The  transverse  wake  potential  (volts)  is  the
transverse momentum kick experienced by the beam because of  the  deflecting  fields.  They
are  sometimes  confused  with  the  wake  functions,  defined  as  the  wake  potentials  per  unit
charge (volt /coulomb) defining, therefore, a Green's function for the problem.

When we study the beam dynamics in the time domain, as usually done for linear accel-
erators, it is convenient to make use of the wake functions or potentials. On the other side the
frequency domain analysis is usually adopted for circular accelerators due to the intrinsic pe-
riodicity. There we need to compute the frequency Fourier transform of  the  wake  function,
which having Ohms units, is called coupling impedance.

In this paper we describe the main features of the electromagnetic fields induced in the
most typical components installed on the beam pipe of an accelerator. In some examples we
make  use  of  numerical  codes,  reliable  tools  for  the  estimate  of  wake  potentials  and
impedances, particularly useful in the design of the machine components. On  this subject we
address the readers to Ref. [1] where an exhaustive review on the available computer codes is
presented. Methods and techniques for measurements of wake potentials and impedance are
described in Ref. [2].

2. LONGITUDINAL WAKE FUNCTION AND LOSS FACTOR

2.1 Longitudinal wake function and loss factor of a point charge

Let us consider a charge  q1 traveling with constant velocity  v = βc on trajectories paral-
lel to the axis of a vacuum chamber. Let  z1 be the longitudinal position and  r1 the transverse
vector positions (Fig. 1).

- 3 -

q

1

r
1

z

1

z

z

r

q

Fig. 1 - Relevant coordinates system

The electromagnetic fields  E  and  B produced by the charge  q1 in the structure can be
derived  by  solving  the  Maxwell  equations  satisfying  proper  boundary  conditions.  The
Lorentz force acting on a charge  q  at a given position  r ,z :

(
F r, z, r1, z1 ;  t

) = q E r, z, r1, z1 ;  t

(

(
) + v × B r, z, r1, z1 ;  t

[

] 
)

(1)

has in general field components along and perpendicular to the trajectory. These e.m. fields
affect the dynamics of the charge itself and on any trailing charge as well. Calling τ the time
delay of the trailing charge with respect to the leading one, at any instant "t" the leading and
trailing charges have longitudinal coordinates  z1(t) = vt  and z(t) =  v(t - τ) respectively.

The energy lost by the charge  q1 is computed as the work done by the longitudinal e.m.

force along the structure:

(
11U r1

(
) = − F r1, z1, r1, z1 ;  t

) ⋅ dz

    ;     t =

z1
v  

The quantity U11 accounts for the energy loss in the resistive walls and in the diffracted
 
fields radiated caused by the discontinuities of the vacuum pipe. For  a point charge, apart of
particular cases, it is generally positive (energy loss).

The trailing charge also changes its energy under the effect of the fields produced by the

leading one:

(
21U r, r1 ; τ

(
) = − F r, z, r1, z1 ;  t

) ⋅ dz

    ;     t =

z1
v

+ τ
 

where the force is calculated on the charge q, on the same path but with a time delay τ.

(2)

(3)

∞

∫

−∞

∞

∫

−∞

- 4 -

The quantity U21 depending on the time delay τ can be positive (energy loss) or negative
(energy gain). As long as we consider charges moving on trajectories parallel to  the  z-axis,
the  magnetic  field  cannot  change  the  particles  energy,  the  product  v × B ⋅ dz = 0  being
identically zero. Accordingly, the energy gain of Eqs. (2) and (3) is computed considering the
longitudinal component of the electric field only.
In  the  above  definitions  we  have  considered  the  integration  over  an  infinite  path.  Of
 
course infinite structures do not exist in practice, neither in linac nor in accelerator rings. In
real machine components we may have fields confined in a limited region (for examples res-
onant  fields  below  the  beam  pipe  cut  off),  or  propagating  into  the  vacuum  chamber.
Extension of the integration path over an infinite pipe is certainly allowed in the former case.
In the latter, definition (3) gives an estimate of the energy gain, which is a good approxima-
tion as long as the field wavelength is short compared to the device length.

A real vacuum chamber is  formed  by  a  smooth  beam  pipe  with  regular  cross  section
(circular, rectangular or elliptic) and by various devices such as the RF  cavity, the kickers, the
diagnostic components etc. The exact solution of Maxwell equation for the whole structure is
impossible to obtain, even with the most sophisticated computer codes. Usually, one analyses
a component at a time and sum up the various effects. This  procedure  may  lead  to  inexact
estimates at high frequency where interference effects are not negligible.

It has to be underlined that in Eqs. (2) and (3) we assume the charge velocity unchanged
during the motion. One can imagine that an external force keeps constant the charge velocity
doing the work computed in Eqs.  (2,3).  In  absence  of  the  external  force,  this  work  corre-
sponds  to the energy loss  (or gain) of the charges, provided that the  velocity  of  the  charge
does not change significantly. In practice Eqs. (2,3) may be used when the relative change of
energy is very small, such not to produce an appreciable variation of the relativistic factor  β.
This is the case, for instance, of ultra-relativistic charges. Otherwise, one has to introduce the
equations of the dynamics combined to Maxwell equations.

We define loss factor  k the energy lost by  q1 per unit charge squared:

and longitudinal wake function  wz (r1, r2; τ)  the energy lost by the trailing charge  q  per unit
of both charges  q1 and q [3,4,5]:

(
k r1

) =

)

(
11U r1
2q
1

 [V/C]

       

wz (r ,r1; τ) =

21U (r, r1; τ)
1q q

  [V/C]

        

(4)

(5)

The explicit dependence on  β although omitted, should be borne in mind. We  note that
both the wake function and the loss  factor have the same units volt/coulomb. Sometimes  in
the literature one finds that the quantity  w(τ) is unproperly called wake potential; the wake
function is numerically equal to the potential seen  by  the  charge  only  when  one  considers
unity charges.

In some cases, such as infinite beam pipe with perfectly conducting or resistive walls, the
e.m. force is constant along the integration path; it is therefore useful to introduce the wake
function per unit length, volt/(coulomb meter), given by:

)
(
dwz r, r1, τ
dz

= − 1
1q q

(

Fz r, z, r1, z1 ;  t

)   ;    z = z1

− vτ

[V/Cm]

       

(6)

which, apart of the sign, is in practice the longitudinal force per unit charge acting on  q.  In
some other cases where we deal with periodic structures, we rather calculate a wake force per
unit period length.

It is worth noting that in the most cases of interest we deal with structures having  par-
ticular symmetric shapes: rectangular, elliptic, circular. Moreover, it is generally verified that
during  the  machine  operation  the  beam  can  only  slightly  be  displaced  from  the  axis.
Accordingly the above quantities can be expanded around the axis keeping only few relevant
terms. This multipolar expansion assumes a particular form in case of cylindrical symmetry
and ultra relativistic charges, as it will be shown in Sec. 2.6. The dominant term produced by
a charge on the axis is called monopole wake (Fig. 2).

- 5 -

q

z

q1

z1

Fig. 2 - Leading and trailing charges on the axis of a cavity with cylindrical symmetry

2.2 Beam loading theorem for a point charge

From the above definitions we easily derive that,  when  the  charges  travel  on  the  same
trajectory, the loss factor is given by the wake function in the limit of zero distance between
q1 and q. Omitting the radial dependence, one obtains :  k = wz (0) . This is generally true as
long as  β < 1, however, in the relevant case  β = 1 it has been proved that [3]:

k = wz (τ→ +
0 )

2

 

(7)

This property, referred to as fundamental theorem of the beam loading [3], is  a  conse-
quence of the causality principle. In fact, due to the finite propagation velocity of the induced
fields and to the motion of the source charge, the wake function is not symmetric with respect
to the leading charge (Fig. 3a). In the limit case of a charge with light velocity it exists only in
the region τ>0 (Fig. 3b), showing a discontinuity at the origin.

- 6 -

β<1

β=1

τ

τ

Fig. 3 - Example of wake functions for a)  β < 1, and b)  β = 1.

To prove the theorem, let us  consider the wake function produced by a point charge as

the sum of an even and odd function of τ (Fig. 4):

wz (τ) = wz

e(τ) + wz

o(τ)

wz, even

k

wz, odd

Fig. 4  - Even and odd part of the wake of Fig. 3a ( β < 1)

It is apparent that only  wz

e(τ) may change the energy of the point charge,  wz
zero at τ=0. Therefore we can say that the loss factor of a point charge is given by:

o(τ)  being

For  β = 1, we have that  wz (τ) = 0  forτ<0,  because  of  the  causality  principle.  In  this

region the wake vanishes if:

 

 

k = wz

e(τ = 0)

e(τ) = −wz
wz

o(τ)

τ

 (8)

τ

(9)

(10)

On the other side we have, for τ>0

- 7 -

e(τ) = wz
wz

o(τ)

 

wz (τ) = 2wz

e(τ) = 2wz

o(τ)

therefore from Eq.(9) we get:

e(τ→ 0) = wz (τ→ +
0 )

k = wz

2

(11)

(12)

(13)

We call the reader's attention on the fact that in general, as long as  β < 1, i.e. in all the
realistic cases, the wake is a continuous function of τ. Therefore, it is more than reasonable to
wonder about the meaning of Eq. (13) that applies only in  the  unrealistic  case  β = 1.  It  is
easy to see that although the wake be a continuous function for any realistic value of  β, its
shape approaches more and more the discontinuous curve of Fig. 3  when  β→ 1.  In  other
words, one could not, in principle, exchange the limits  τ→ 0  and  β→ 1.

2.2.1 Example: Point charge wake for a single resonating mode HOM.

As it will be shown in  Sec.  7.4,  a  point  charge 

1q   passing  through  a  resonant  cavity
excites all the resonating modes. In the limit case  β = 1,  each  mode  is  schematized  by  the
electric RLC parallel circuit driven by a point charge current  bi (τ) =

1q δ(τ):

ib

C

L

R

Fig. 5 - Scheme of a RLC parallel circuit driven by the current  bi (τ)

At the time τ=0 + we observe that the capacitor is charged with a voltage:

V( +0 ) = 1q
C

≡

oV  and  ˙V( +0 ) = V( +0 )

RC

(14)

- 8 -

˙˙V(τ) + 2Γ˙V(τ) + r

2ω V(τ) = 0

2Γ = 1
RC

 
,     and    

2ω = 1
LC

r

 

For t >0 the system will undergo free oscillations. In particular the voltage  V(τ) will be

a solution of differential equation of the circuit:

where:

gets:

Solving Eq.(15) with the initial conditions (14) and according to the definition (5), one

wz (τ) = V(τ)
1q

=  

−Γτe
C





cos(ω
r

τ) − Γ
ω
r

sin(ω
r

τ)


H(τ)  


where  H(τ) is the Heaveside function and

Using the merit factor of the circuit defined by:

(15)

(16)

(17)

(18)

 (19)

(20)

2ω = r

2ω − 2Γ

r

Q =

rω
2Γ

wo

= 1
C

=

rRω
Q

 

=

Γ
1
rω
4 2Q − 1
rω = rω 1 − 1
4 2Q

A qualitative behaviour of the wake function is shown in Fig. 6.

wz(τ)

τ

Fig. 6 - Wake function of a resonant mode

The loss factor, according to the definition (4), can be computed as the energy lost by the
unit charge after its passage through the cavity. Applying the energy conservation law, we can
obtain the energy lost by the charge  q1 as the e.m. energy initially stored in the capacitor. We
get:

which satisfies the beam loading theorem.
In terms of the merit factor Q we get:

- 9 -

k = 1
2C

= w(τ→ 0)
2

k =

rRω
2Q

2.3 Longitudinal wake function and loss factor of a bunch.

The  wake  function  defined  in  Eq.(5),  being  generated  by  a  point  charge,  is  a  Green
function and allows to compute the wake produced by any bunch  distribution.  Let  us  con-
sider now a bunch of particles moving on a trajectory parallel to  the  axis,  at  a  distance  r1,
with a longitudinal time distribution function  ib

τ( ) such that:

1q =

+∞
ib

∫

-∞

τ( )

 dτ
 

 

 

The wake function produced by the  bunch  distribution  at  a  point  with  time  delay  τ is
simply given by the convolution of the Green function over the bunch  distribution.  We  re-
mind  that,  in  practice,  the  convolution  integral  is  obtained  by  applying  the  superposition
principle. We split the distribution into an infinite number of infinitesimal slices and sum up
their wake contributions at the point τ. According to the definitions given so  far, the energy
lost by a trailing charge  q  because of the wake produced by the slice at τ' is:

dU(r, τ− τ' ) = q ib

τ'(

)wz (r, τ− τ' )dτ'  

summing up all the effects we get the wake function of a bunch distribution as:

Wz (r, τ) = U(r, τ)
1q q

= 1
1q

∞

∫

ib
−∞

τ'(

)wz (r ,τ− τ' )dτ'

 

For  a  bunch  traveling  with  velocity  "c",  because  of  the  causality,  the  above  folding

integral has the observation point "τ" as uppermost limit.

(21)

(22)

(23)

(24)

(25)

- 10 -

Once the bunch wake function  Wz (r, τ) is known, it is straightforward to derive the loss

factor of the charge distribution by applying again the superposition principle, we get:

 

K(r) = U(r)
2q
1

= 1
1q

Wz (r, τ)

 ib (τ) dτ 

∞

∫

−∞

which depends on the transverse displacement of the bunch.

2.3.1 Example: rectangular bunch distribution exciting a single HOM.

Let us consider a bunch distribution with a simple rectangular shape on the axis at r=0.

bi (τ) =  

[

1q
2T

(

H τ+ T

(
) − H τ− T

]
)

and compute the wake function of such a charge distribution assuming that it excites a single
HOM in a r.f. cavity. Further, let us assume that the factor Q  is so  high that, in the range of
interest, the impulsive wake function can be approximated by:

wz (τ) = wo cos(ω
r

τ)H(τ) 

By using the folding integral (25) we get two expressions of the bunch wake for τ inside

and outside the distribution. Inside the charge distribution, i.e. for  −T < τ< T , we get:
[
sin ω
r (τ+ T )
ω
rT

zW (τ) = ow
2

H(τ+ T )

]

 

(29)

It  is  worth  noting  that  in  the  limit  T→O ,  the  rectangular  distribution  becomes  an
zW (τ) → wz (τ). In  particular  it  is

1q δ τ( ) and the bunch wake 

impulsive function  bi (τ) =
interesting to see that:

Namely, looking at the center of the bunch, one finds that the wake function approaches

with continuity the limit value (7).

The bunch loss factor is obtained from Eq.(26) which gives:

(26)

(27)

(28)

(30)

(31)

lim
T→0

zW (0) = ow
2

K = ow
2

2





sin(ω
rT )
ω
rT





- 11 -

k = lim
T→0

K = ow
2

The "point charge" loss factor is derived from the above expression in the limit  T→O :

Therefore,  when  we  consider  any  bunch  distribution,  the  somewhat  "artificious"
arguments  presented  in  Sec.  2.2  are  unnecessary,  since  the  loss  factor  can  be  computed
strightforwadly from the bunch wake which turns out  to  be  continuous,  even  in  the  "point
charge" limit.

Finally we find externally to the distribution, i.e. for  τ≥ T :

zW (τ) =  

ow

sin(ω

τ)

rT )cos(ω
r
ω
rT

(

H τ− T

)

It  is  interesting  to  note  that  outside  the  distribution,  the  limit  for  T→0  and  τ→0  of

 
gives wo.
Eq. (33)

2.4 Loss factor and Poynting Vector

The bunch wake function has been defined as  the  energy  loss  by  a  bunch  crossing  a
given structure. We already said that the non-consistency due to the constant velocity of the
bunch can be avoided assuming an external force acting on the bunch (for instance related to
an electric external potential). Since the kinetic energy of the bunch is constant (constant ve-
locity) the work done by the external force has to be equal to the energy loss, according to the
energy conservation law. However, it is well known that, any electromagnetic energy loss  can
be computed as the flux of the Poynting vector over a closed surface surrounding the sources
of the fields.

The Poynting theorem states that the electromagnetic energy  Uem stored in a volume V

limited by the surface S can change because of homic losses and electromagnetic radiation:

 

∂Uem
∂t

= − P

∫ ⋅ ˆn dS +

S

∫

V

(

E ⋅ J

)
 dV

 

where  ˆn  is the unity normal to the surface S,  J is the current density,  E the electric field and
P is the Poynting vector defined as:

P =

 E × B

1
µ

(32)

(33)

(34)

(35)

Let us consider now a single charge moving on the axis of a given structure. The current

density is given by:

- 12 -

J(r, z,t) = q1v

 δ(z - vt)

δ(r)
2π r

We choose as surface S  a cylinder of infinitesimal radius around the charge trajectory.
Integrating Eq. (34) with respect to the time from  − ∞  to  + ∞ , and noting that in the volume
V Uem (t = −∞) = Uem (t = ∞), we get:

dt

(

E ⋅ J

)
 dV =

∞

∫

−∞

∫

V

∞

∫

∫ ⋅ ˆn dS

P

dt

−∞

S

 

Making use of (2),(4) and (36) we get for the loss factor:

k =

−1
q1

∞

∫

−∞


Ez z,t = z

v


 dz

=

∞

∫

−1
q1

−∞

S

∫ ⋅ ˆn dS

P

dt

(36)

(37)

(38)

2.5 The synchronous fields.

When  a bunch crosses the various elements installed on the  beam  pipe,  it  excites  sec-
ondary fields because of induction effects and diffraction phenomena. Some of these fields
are localized around the bunch, as for example the space charge or the  resistive  wall  fields,
others are localized in resonant structures like the r.f. cavity, and others, at high frequency can
propagate within the beam pipe. All these fields interact with the circulating beam.

Fig. 7 - DAΦNE Accumulator vacuum chamber (RF cavity, kicker tanks, bellows)

- 13 -

We  want  to  show  that  this  interaction  is  such  that  only  the  fields  components

synchronous with the charges can change the charges energy. In order to prove this statement

it is convenient to express the longitudinal electric field in terms of waves propagating in the

z-direction:

(
Ez z,t

) = 1
2π

∞

∫

∞

∫

−∞

−∞

dω

dκ

  ˜Ez

ω,  κ(

)e j(ωt −κz)

(39)

where we have omitted the explicit dependence on  (r, r1, z1).

The longitudinal electric field is given by a superposition of longitudinal  waves  having
any phase velocity, since  ω and  κ can vary from  −∞  to  ∞. Among these waves only those
having the same phase velocity of the charge can contribute to the energy gain and therefore

to  the  wake  function.  In  fact  let  us  put  the  field  expression  (39)  into  the  wake  function

definition (5), we get:

wz (τ) =

 

−1
q1

∞

∫

−∞


Ez z,t = z

v


+ τ


dz =

−1
2πq1

∞

∫

−∞

∞

∫

−∞

dω

 e jωτ

dκ

  ˜Ez

)
ω,  κ(

(
− jz κ−κ
o

)

dz

(40)

∞

∫

e

−∞

 

with  κ
o

=

ω

v

. We recognize the impulsive function:

1
2π

∞

∫

e

−∞

(
− jz κ−κ
o

)

(
dz = δ κ− κ
o

)

that allows to get the following simple expression:

wz (τ) =

(

˜Ez

κ = κ

)
 e jωτ
o,ω

dω

−1
q1

∞

∫

−∞

(41)

(42)

wherein it is apparent that only those  components  of  the  fields  propagating  with  the  same
phase velocity of the charge can produce a "surfing" effect. All the others in average do not
contribute.

- 14 -

The result found above deserve a further investigation.  In  fact  we  wonder  what  would
happen if, instead of an infinite structure one would consider a pipe with finite length, say L.
It is easy to see that integration between -L/2 and +L/2  does not give an impulsive function,
but:

1
2π

L/2

∫

e

− L/2

(
− jz κ−κ
o

)

dz = L
2π

]

[
) L
(
sin κ− κ
o
2
) L
(
2

κ− κ
o

(43)

which becomes again an impulsive function when  L → ∞. For  a finite length  L,  the  "sinc"
function (sin(x)/x) has a maximum at  κ
o

= κ, and the first zero at  κ
o

= κ± 2π/ L.

For long wavelength, the fields do not propagate being stored within a given device (e.g.
the cavity HOMs).  The actual integration path is therefore confined to a  limited  region,  the
fields being  evanescently  zero  above  the  pipe  cut-off.  On  the  other  hand,  for  short  wave-
lengths fields propagate into the beam pipe. There is a contribution of those harmonics that
do not perfectly average to zero their effect on the beam. However, according to Eq. (43) at
high frequencies this contribution is small, so that we can consider an infinite pipe instead of
a finite one, simplifying the calculation of the wake.

2.6 Expansion of the longitudinal wake in cylindrical symmetry

So  far we have  considered  the  case  of  general  boundaries,  assuming  the  two  charges
moving on any trajectory parallel to the axis. We have already mentioned that in general there
is no restriction on the transverse position of both charges. For simplicity we now consider
that the trajectories are parallel to the axis of a structure with cylindrical symmetry as shown
in Fig. 2. Let  (r1,φ
= 0, z1) be the coordinates of the leading charge and  (r,φ, z)those of the
trailing one. The density charge  q1  can be represented as a superposition of  multipole  mo-
ments in cylindrical coordinates:

1

ρ
1

= q1

δ(r − r1)
 r1

δ(φ)δ(z − z1)

with  z1

= βcτ. Exploiting the azimuthal periodicity we can write:

ρ
1

=

q1
2π

δ(r − r1)
 r1

δ(z − z1) α
m

∑ cos(mφ)

∞

m=0

with:

 

α
m

=





1,   m = 0
2,   m ≠ 0

(44)

(45)

(46)

- 15 -

According to the above expression the charge can be thought of  as  a  superposition  of
charged  rings  with  angular  dependence  cos(mφ) .  It  easy  to  see  for  instance  that  the
monopolar term with m=0 describes a  charged  ring  of  radius  r1  with  uniform  density.  In
cylindrical coordinates the e.m. fields created by the distribution (45) can be derived as sum
of multipole terms as well, showing therefore the same angular dependence. For each term we
can compute the effect of the longitudinal force. The resulting wake function will  show  the
following form:

wz (r, r1; τ) =

wz,m (r, r1; τ)

∞

∑

m=0

wz,m (r, r1; τ) = wz,m (r,r1; τ)cos(mφ)

2.7  Radial expansion of the wake function in the limit  γ → ∞ .

The e.m. fields produced by the traveling charge in a vacuum chamber are derived from

Maxwell equation imposing the boundary conditions at the pipe walls:

∇ × B  =  µ

oJ  +  

1
c2

∂E
∂t

∂B
∂t

ρ
ε
o

∇ × E  =   −  

∇ ⋅ E  =   −  

J = ρv

∇⊥

2 ˜Ez

−

2





ω
βcγ





˜Ez  =  0

∇⊥

2 ˜Ez

= 0

The longitudinal electric field can be thought of as produced by the current sources (the
bunch) and by the currents induced at the walls. Considering only the induced fields, it can
be shown that the fourier component synchronous with the charges is a solution of the fol-
lowing equation [6,7]:

In the limit  γ → ∞ , i.e. in the case of ultra relativistic charges, we have:

(47)

(48)

(49)

(50)

(51)

(52)

(53)

- 16 -

Solved in cylindrical symmetry, the above equation gives the following radial dependence

of the wake function [4,6,7]:

wz,m (r,r1; τ) = rmr1

m wz,m (τ)

(54)

The monopole term m=0, does not depend on the  radial  position  of  the  charges.  This
result, applied only to ultra relativistic charges, allows to simplify the evaluation of the wake
function by choosing a suitable integration path. Numerical codes [1,25,57,58] computing the
longitudinal  monopole  wake  function  of  charges  with  β=1,  in  structure  with  cylindrical
symmetry, perform the integration along trajectories at the radius of the beam pipe. Since the
longitudinal electric field vanishes on the pipe surface, the integration is limited to a shorter
path.

We  want to underline  that  the  expansion  (54)  concerns  only  the  secondary  fields  in-
duced by the beam. The primary fields produce the so  called space charge wake effects that
show a different radial dependence, (Sec. 6.3).

2.8 Wake function in accelerator rings

In the case of circular machines, the longitudinal position of the charge is given by the
coordinate θ. We compute the wake function by averaging the azimuthal electric field over a
revolution period  To :

w(τ) = −2πR Eθ(θ,t + τ)

To

Due  to  the  intrinsic  periodicity  of  the  e.m.  problem,  we  can  expand  the  longitudinal

electric field of a single charge as:

(55)

(56)

(
Eθ θ,t

) =

dω

 e jωt

)e
˜Ez n,ω(

− jnθ

∞

∫

−∞

∞

∑

n=−∞

which substituted in (55) gives:

∞

π
∫
w(τ) = −R dθ dω e jωτ
−π

∫

−∞

∞

∑

n=−∞

)e
˜Eθ n,ω(

(

− jθ n−ω/ω
o

)

(57)

The charge itself can be thought of as a train of charges with a beam current:

ib (τ) = q1

δ(τ− kTo )

∞

∑

k =−∞

- 17 -

Making use of (25) and (55), we have:

W(τ) = 1
1q

∞

∫

ib
−∞

τ'(

)w(τ− τ' )dτ'

=

∞

∑

k =−∞


w τ− 2πk

ω

o





∞

π
∫
W(τ) = −R dθ dω 
−π

∫

−∞

∞

∑

k=-∞

∞

∑

n=-∞

e jω(τ−2πk /ω
o )

)e
˜Eθ n,ω(

(

− jθ n−ω/ω
o

)

which, after some mathematics, becomes:

W(τ) = − 2πR
q1

∞

∑

n=−∞

(
˜Eθ n,nω
o

)e jnω

o

τ

3. LONGITUDINAL COUPLING IMPEDANCE

3.1 Definitions and properties

In the frequency domain we compute the spectrum of the point charge wake function as:

∞

∫

−∞

wz (r, r1; τ)
 e

− jωτ

dτ ≡ Z(r, r1;ω)

 

(60)

Which being measured in Ohms units is called  Coupling  Impedance.  Historically,  the
coupling impedance concept was introduced in the early studies of the instabilities arising in
the ISR at CERN [8].

The wake function is derived from the impedance by inverting the Fourier integral:

 

 

In the following we shall omit, for simplicity, the  radial  dependence.  Comparison  with

 
Eq.(42) shows that:

wz (r, r1; τ) = 1
2π

Z(r, r1;ω)

 e jωτ

dω 

∞

∫

−∞

Z(ω) = − 

(

˜Ez

κ = κ

)
o,ω

2π
q1

(58)

(59)

(61)

(62)

(63)

(64)

(65)

- 18 -

The coupling impedance is a complex quantity:

 

Z(ω) =

rZ (ω) + j

iZ (ω) 

rZ (ω) and 

iZ (ω) even and odd function of  ω  respectively.  It  is  easy  to  prove  this
with 
property of the impedance reminding that the wake potential  w(τ) is a real function of  τ. In
fact expanding the exponential in the integral of Eq. (61) we have:

∞

∫

[
−∞

wz (τ) = 1
2π
∞

+ j
2π

∫

[

 

−∞

 

rZ (ω)cos(ωτ) −

iZ (ω)sin(ωτ)

]
 dω
 

rZ (ω)sin(ωτ) + iZ (ω)cos(ωτ)

]
 dω

where the imaginary part vanishes if:

Zr (ω) =  Zr (−ω)
Zi (ω) = −Zi (−ω)

From Eqs. (8,60,64), we recognize that 
o(τ)  respectively:

e(τ) and  wz
wz

rZ (ω) and -

iZ (ω) are the Fourier transform of

e(τ) = 1
wz
2π

Zr (ω)

 cos(ωτ)dω

o(τ) =

wz

Zi (ω)

 sin(ωτ)dω

∞

∫

−∞
∞

−1
2π

∫

−∞

 

(66)

Furthermore, in the particular case of  β = 1,  the  wake  function  has  to  vanish  for  τ<0

where.  wz

e(τ) = −wz

o(τ). In terms of impedances Eq.(10) becomes:

∞

∫

−∞

∞

∫

−∞

Zr (ω)

 cos(ωτ)dω =

Zi (ω)

 sin(ωτ)dω
 

(67)

which expresses a general relationship between the real and imaginary part of the impedance.
It can be shown that the above relation is equivalent to the Hilbert transform relating the real
and imaginary part of a network impedance. In other words the Coupling Impedance defined
by Eq.(60) behaves like an usual circuit impedance only when the causality principle applies,
namely in the limit case of charges traveling with the velocity of light.

- 19 -

k = wz (τ→ +
0 )

2

∞

= 1

∫
π rZ
0

(ω)dω 

Recalling the relation (7) between loss  factor and wake potential for a point charge, we

 
get :

where we recognize that the real part of the impedance is the power spectrum of the energy
loss  of  a  unit  point  charge.  In  general,  the  complex  impedance  can  be  thought  of  as  the
complex power spectrum related to the energy loss.

 3.1.1 Example: Impedance of a single HOM in a rf cavity.

Using the wake function expression (17) derived for a single HOM, from the definition

(60) we have:

Z(ω) =

cos(ω
r

τ) −

sin(ω
r

τ)

−( jω+Γ)τ

dτ


e
 


ω

r R
Q

∞

∫

−∞





Γ
ω
r

R
ω
rω





Z(ω) =

1 + jQ

 

− rω
ω





It is easy to verify that the above impedance satisfies the properties (65) and (67).

 3.2 Bunch losses and wake function from the impedance

Consider a bunch radially displaced and with a charge distribution ib (τ), whose Fourier
zW (r; τ) and loss  factor can be expressed

spectrum is I(ω). The total bunch wake function 
in terms of  Z(ω)  by transforming the integrals (25) and (26), obtaining:

 

 

zW (r; τ) = 1
2πq1

Z(r;ω)

I(ω) 

e

jωτ

dω 

K(r) = 1
2πq

1

Zr (r;ω)

I(ω) 2 dω 

∞

∫

−∞

∞

∫

0

(68)

(69)

(70)

(71)

(72)

(73)

(74)

As an example for a bunch with Gaussian distribution:

- 20 -

− 

  (ωστ)2
2

 

I(ω) = q1 e

the loss factor is given by:

K(r) = 1
π

Zr (r;ω)
 e

−(ωστ)2

dω 

∞

∫

0

 

 

      

It is apparent that  the  loss  factor  is,  in  general,  a  function  of  the  r.m.s.  length  of  the

bunch distribution. It is interesting to note that there exists a  general  relation,  useful  in  the

measurements, between the frequency dependence of the impedance and the  dependence  of

the loss factor on the bunch length. For a Gaussian bunch:

Zr (ω) ∝ ωa ⇔ K ∝ στ

−(a+1) 

(75)  

3.3  Multipole longitudinal impedance for cylindrical symmetry

In Sec. 2.6 we have seen that the wake function created by a charge on a trajectory paral-

lel to the axis of a device with cylindrical symmetry, can be expanded into a sum of multipo-

lar terms. The wake expansion used in the impedance definition allows  to  express  also  the

impedance as a multipole expansion:

Z(r,r1,φ;ω) =

Zm (r,r1,φ;ω)

=

Zm (r,r1;ω)

cos(mφ)

(76)

∞

∑

m=0

∞

∑

m=0

For  ultra  relativistic  charges  the  radial  dependence  of  the  wake  function  is  known,

according to Eq.(54), we have:

Zm (r,r1;ω) =  rmr1

mZm (ω)

(77)

where  Zm (ω) has dimensions  Ω / m 2m .

4  TRANSVERSE WAKE FUNCTION

4.1 Transverse wake function and loss factor of a point charge

Let us consider now the leading charge transversely displaced with respect to the axis as
shown in Fig. 8. The charge excites in the structure electromagnetic fields which can be ex-
panded in their multipole components (dipole, quadrupole,  sextupole  etc.)  in  the  transverse
plane. For small transverse displacements the dipole term is of course dominant.

- 21 -

q1

r1
z1

q

z

Fig. 8 - The leading charge is transversely displaced

The trailing charge  q experiences a Lorentz force which has longitudinal and transverse

components. Therefore, it is subject to a transverse momentum kick given by:

∞
∫
21M (r, r1; τ) = F⊥ r, z, r1, z1 ;  t
-∞

(

) 
dz ,     t =

+ τ

z1
v

(78)

the integration, as for the longitudinal case is assumed over an  infinite  distance.  The  above
momentum kick, measured in Newton meter [Nm],  depends  on  the  pipe  shape  and  on  the
transverse position of both charges. In general, the transverse kick is not parallel to the dis-
placement of the leading charge. In fact an horizontal displacement can lead to both vertical
and horizontal kicks, and the same generally happens for a vertical displacement. Only in the
case of cylindrical symmetry, the two transverse directions are de-coupled for a beam on the
axis. The transverse kick per unit of both charges, measured in volt/coulomb [V/C], defines
the transverse wake function:

w ⊥ (r, r1; τ) =

M21(r, r1; τ)
q1q

    

  [V/C]

(79)

- 22 -

Analogously to the longitudinal case we find useful to define the dipole transverse loss
factor as the amplitude of the transverse momentum kick given to the charge by its own wake
per unit charge:

k⊥ (r1) =

M11(r1)
2
q1

    

     [V/C]

Usually  the  dipole  component  of  the  transverse  kick  is  the  dominant  term  for  ultra
relativistic charges. This term is proportional to the displacement of the charge  q1. For  this
particular case we define the transverse dipole wake function  as the transverse wake per unit
of transverse displacement:

                   
and a transverse loss factor:

' (r, r1; τ) =
w⊥

w ⊥ (r, r1; τ)
r1 

     [V/Cm]

' (r1) =
k⊥

M11(r1)
2r1
q1

     [V/Cm]
  

4.2  Transverse wake function and loss factor of a bunch

The transverse wake potential produced by a continuous bunch distribution, transversely

displaced by  r , can be obtained by applying the superposition principle; we get:

W⊥ (r; τ) =

w⊥ (r; τ− ′τ )

 ib ( ′τ )d ′τ

  [V/C]

      

1
1q

∞

∫

-∞

 
             

 

The bunch transverse loss factor [V/C] is:

the transverse wake and loss factor per unit displacement are:

K⊥ (r) =

W⊥ (r; τ) 

ib (τ)dτ

1
1q

∞

∫

-∞

' (r; τ) =

W⊥

W⊥ (r; τ)
r

' (r) =

K⊥

K⊥ (r)
r

measured in volt/(coulomb meter).

(80)

(80)  

(81)

(82)

(83)

(84)

(85)

- 23 -

Fr 

Fz 

= q Ez
(
= q Er
(
Fφ = q Eφ + vBr

)
− vBφ
)

=

∂Ez
∂r
∂Ez
1
∂φ
r

+

∂Er
∂z
∂Eφ
∂z

=

∂Bφ
∂t
∂Br
∂t

−

∇⊥Fz

=

∂F⊥
∂ζ

4.3  Relationship between longitudinal and transverse wake functions

Let us consider, for simplicity, a charge which moving with constant velocity v along the

z-axis, through an e.m. field. It will experience a e.m. force with components:

The Maxwell equations give:

from the above relationships, in a moving frame ζ=z-vt, we derive:

The  moving  frame  has  as  origin  of  the  axis  the  position  of  the  leading  charge
(z=vt→ζ=0), while on the trailing charge we have ζ=-vτ. Since we are considering the force
on  the  trailing  charge,  derivation  with  respect  to  ζ can  be  substituted  with  derivation  with
respect to τ:

− 1
v

∂
∂τ

w ⊥ (r, r1; τ) =  ∇⊥,rwz (r, r1; τ)      [V/Cm]

(89)

The  transverse  operator  ∇⊥   applies  on  r ,  the  transverse  coordinates  of  the  trailing

charge. The above relation is often referred to as "Panofsky-Wenzel" theorem [9].

If the leading charge is slightly displaced from the axis, we can expand the rhs  of (89)

retaining only the first order term [10]:

wz (r, r1; τ) ≈ wz (r,0; τ) + ∇⊥,r1

wz (r, r1; τ)

[

]

r1 = 0

⋅ r1

+ 0(r1)2

where  ∇⊥,r1
charge. From (89) we get:

 is the gradient operator acting on the transverse  coordinates  r1  of  the  leading

− 1
v

∂
∂τ

{
w ⊥ (r, r1; τ) =  ∇⊥,r wz (r,0; τ) + ∇⊥,r1

[

wz (r, r1; τ)

}

⋅ r1

]

r1 = 0

(86)

(87)

(88)

(90)

(91)

- 24 -

The first term in the brackets is a "monopole" contribution to the transverse impedance
which  disappears  for  a  particular  symmetric  geometry  (circular,  rectangular,  elliptic).  The
latter is the dipole transverse impedance, which, in the linear approximation, is obtained from
the  longitudinal  wake  expression  wz (r, r1; τ)by  applying  twice  the  transverse  gradient
operator to  r1 and  r :

− 1
v

∂
∂τ

w ⊥ (r, r1; τ) =  ∇⊥,r

∇⊥,r1

wz (r, r1; τ)

[

]

⋅ r1 

r1 = 0

For instance, in Cartesian and cylindrical coordinates, the transverse operator becomes:

∇⊥,r

∇⊥,r1

=

   ∇⊥,r

∇⊥,r1

=

∂2
∂x∂x1
∂2
∂y∂x1

∂2
∂x∂y1
∂2
∂y∂y1

∂2
∂r∂r1
∂2
1
∂φ∂r1
r

1
r1
1
rr1

∂2
∂r∂φ
∂2
∂φ∂φ
1

1

(92)

(93)

It is worth noting that in general, after the application of the matrix (93) to the vector  r1,

the transverse dipole wake is not necessarily directed along the offset of the driving charge.

4.4  Mode expansion in cylindrical symmetry

As for the longitudinal case, the transverse wake can be  expresses  as  superposition  of

multipoles terms [11]:

w ⊥ (r, r1; τ) =

w ⊥,m

(r, r1; τ)

(94)

∞

∑

m=0

For  γ → ∞ , making use of the expressions (47),(54) and (89), we get:

∂
∂τ

w ⊥,m

(r, r1; τ) = -c m wz,m (τ) rm-1r1

}
{
m cos(mφ)ˆr -  sin(mφ) ˆφ

(95)

The transverse  dipole  term  m=1  is  proportional  to  the  transverse  displacement  of  the
leading charge while it does not depend on the transverse position of  the  trailing  one.  It  is
easy to show that in cylindrical coordinates the dipole transverse force is directed along the
offset of the leading charge:

∂
∂τ

w ⊥,1

(r, r1; τ) = -c  wz,1(τ) r1

(96)

where,  we  remind,  wz,1  is  the  amplitude  of  the  dipole  longitudinal  wake  measured  in
V/(C m2). The same result is obtained by applying Eq. (92).

- 25 -

5. TRANSVERSE COUPLING IMPEDANCE

5.1 Definitions and properties

The Fourier transform of the transverse wake function in the frequency domain times the

imaginary unity defines the transverse coupling impedance:

∞
∫
j w⊥ (r, r2; τ) 
e
-∞

 

− jωτ

dτ ≡ Z⊥ (r, r2;ω)

    [Ω]

 

Historically,  the  imaginary  constant  was  introduced  in  order  to  make  the  transverse
impedance to play the same role as the longitudinal one in the beam stability theory. Since the
transverse dynamics is dominated by the dipole transverse wake, we can define the transverse
dipole impedance normalized to  r1 as:

' (r1, r2;ω) =
Z⊥

Z⊥ (r1, r2;ω)
r1

     [Ω/m] 
  

             
it has ohms/meter units. Conversely, the transverse wake is obtained from the inverse Fourier
transform of the transverse impedance:

w⊥ (r, r2; τ) =

Z⊥ (r, r2;ω) 

e jωτ

dω
 

j
2π

∞

∫

-∞

 

  

5.2  Relationship between longitudinal and transverse impedances

The Fourier transform of  (89)  gives  the  dipole  transverse  impedance  on  terms  of  the

longitudinal one:

Z⊥ (r, r1;ω) =  

∇⊥Z(r, r1;ω)      [Ω]        

c
ω

The transverse dipole impedance for an arbitrary shape, according to Eq. (92) is:

Z⊥ (r, r1;ω) =  

∇⊥,r

∇⊥,r1

Z(r, r1;ω)

c
ω

[

]

⋅ r1

r1 = 0

 

In cylindrical symmetry, applying (96) or (92) to Eqs. (76)  we get:

Z⊥,1

(r, r1;ω) =  

Z1(ω) r1    [Ω]        

c
ω 

(97)

(98)

(99)

 

(100)

(101)

(102)

- 26 -

6. UNIFORM BOUNDARIES

6.1 General properties

In this chapter we start the analysis of the wake fields and impedances for some relevant
cases: charge in the free space and in a  beam  pipe  with  uniform  cross  section.  Fields  and
potentials for these  cases  have  a  common  feature:  they  travel  together  with  the  charge.  In
other words, the fields map does not change during the charge flight, as long as the trajectory
is parallel to the pipe axis.

Considering a charge with velocity v=βc ˆz we may write:

E = -grad V + β2

z = -

z - grad⊥V

∂V
∂z

1
γ2

∂V
∂z

where the scalar potential  V(r,φ, z - vt) is the solution of the equation:

∇⊥

2 V +

1
γ2

∂2V
∂z 2

= -

ρ
ε

satisfying the boundary conditions. The Laplacian operator  ∇⊥
2  is applied  to  the  transverse
coordinates,  ρ is the charge density. The longitudinal wake potential per unit length is given
by:

∂w(r,φ, τ)
∂z

1
q

= -

Ez (r,φ, z − vt)

+τ

t = z
v

One  can  see  from  Eq.  (104)  that  in  the  ultra  relativistic  limit  γ → ∞ ,  fields  can  be

derived in the static approximation.

6.2  Relativistic charge in the free space

A point charge moving with constant velocity  vˆz  in the free space generates fields which
are solution of the Maxwell equations (48, 51).The fields can be derived applying the Lorentz
transform to the static field created by the charge in the rest frame. Because of the symmetry,
we have the fields [12]:

E(r, z,t) =

q
4πε
o

 

[
γ r + (z - vt)ˆz

[
  γ2(z - vt)2 + r 2

]
]3

2

 

B(r, z,t) =

ˆn × E(r, z,t)

β

c

(103)

(104)

(105)

(106)

(107)

- 27 -

where the  ˆn vector is directed from the charge to the observation point. The  magnetic  field
has only the azymuthal component  Bφ. It is well known that at high energies, because of the
relativistic contraction, the fields are mainly confined inside a region with an  opening  angle
1/ γ and perpendicular to the trajectory. The longitudinal field  Ez  vanishes as 1/ γ2, while Er
and  Bφ are proportional to  γ.




Ez r = 0,t = z
v


+ τ


=

−q
)2
(
βγcτ

4πε
o
γ

=

q
4πε
o
= qZo
4π

r 2

γ

r 2


Er r,t = z

v





Bφ r,t = z

v




(108)

(109)

(110)

Because of the fields confinement within an angular region of the order of 1/γ, at a given
distance r from the charge the fields can be thought of as generated by a relativistic  charge
distribution with line density λ. In the stationary approximation, applying the Gauss  law at a
cylindrical surface of radius r, we find an effective charge density  λ = qγ / r . The singulari-
ties at  τ = 0  and  r = 0  that can be removed by considering a charge  with  longitudinal  and
radial distribution.

According to the definition (6), since a test charge on  the  axis  would  experience  a  re-
pulsive force independently of its position, the longitudinal wake function per unit length is
an odd function of  τ. The corresponding impedance is purely imaginary. Because of the lack
of interest, we do not derive the explicit expressions of the wake and impedance. However, it
is  interesting  to  compute  the  amount  of  e.m.  energy  stored  in  a  region  outside  a  tube  of
radius  b :

U(r ≥ b) = 3π
16







ro
b

γ moc 2

(111)

where  ro  is the classic radius and  mo is the rest mass of an electron. The e.m. energy is pro-
portional to the kinetic energy of the charge.

P

θ

Er(θ,r)

θ

Fig. 9 - Electric field lines of a ultra relativistic charge in the free space
(Qualitative behaviour)

- 28 -

6.3  Cylindrical pipe with perfectly conducting walls

The fields produced by a point charge traveling inside a perfectly conducting cylindrical
pipe  are  found  from  the  scalar  potential  V(r,φ, z - vt)  solution  of  the  Maxwell  equation
(48,51), with homogeneous boundary conditions at the pipe wall r =b (Fig. 10).

b

φ r
1

r

Fig. 10 - Point charge inside a p.c. cylindrical pipe

Using  the density charge (44), in cylindrical coordinates we can express the scalar  po-

tential as sum of multipole terms [10]:

V(r,φ, z - vt) =

cos(mφ)

˜Vm (r,r1,κ)e

− jκ(z−vt)dκ

(112)

1
2π

∞

∑

m=0

∞

∫

−∞

where we made use of the Fourier transform from the z-space to the wave number domain  κ.
Each Fourier component  ˜Vm (r,r1,κ) is obtained by solving the  differential  equation  (104)
and imposing the boundary conditions at the pipe walls [10]. We get:

˜Vm (r,r1,κ) = qα
m
2πε
o








Km (ξ r)Im (ξ r1) − Im (ξ r1)
Im (ξ b)
Km (ξ r1)Im (ξ r) − Im (ξ r1)
Im (ξ b)

Km (ξ b)Im (ξ r);     r ≥ r1

Km (ξ b)Im (ξ r);     r ≤ r1

(113)

where  ξ = κ / βγ, and  Im ,  Km  are the modified Bessel functions.

The longitudinal coupling impedance per unit length, using (103) and (105), is given by:

∂Zm (r,r1,ω)
∂z

=

− jω
)2
q cβγ(

˜Vm r,r1,κ =





ω
βc





(114)

- 29 -

6.3.1  Monopole Longitudinal Impedance m=0, r<r  1

∂Zm=0
∂z

=

− jωZo
)2
2πc βγ(





Ko(ξ r1) − Io(ξ r1)
Io(ξ b)

Ko(ξ b)


Io(ξ r)


(115)

o / ε

o = 1 / cε

Where  Zo = µ

o  is the impedance of the vacuum.  The  behaviour  of  the
above term, purely imaginary, as function of  ξ b  is shown in  Fig.  11.  We  note  that  in  the
region  ξ b <<1, the impedance per  unit  length  grows  linearly,  and  does  not  depend  on  the
radial position of the trailing charge:

∂Zm=0
∂z

=

− jωZo
)2
2πc βγ(

ln







r1
b

(116)

For  ξ b >>1, the impedance shows an exponential roll off.

0.8

0.6

0.4

0.2

0

0

r = 0
r  = 0.5b
1

2

4

ξ b

6

Fig. 11 Monopole space charge impedance versus ξb

It is apparent that the impedance (116) does not satisfy the radial dependence (77) found
in the high energy limit. In fact this term is called Space Charge Impedance, and kept distin-
guished from the forces related to the secondary fields induced at the pipe walls. In the litera-
ture,  it  is  usually  presented  the  space  charge  monopole  term  due  to  a  disk  of  radius  a,
centered  on  the  pipe  axis.  Integrating  the  impedance  expression  (116)  over  the  charge
distribution  0 ≤ r1

≤ a , for  ξ b <<1, we get:

∂Zm=0
∂z

=

− jωZo
)2
4πc βγ(




1 + 2ln







b
a




(117)

- 30 -

Using the above expression in the inverse Fourier transform, we get in the limit  γ → ∞

the wake function per unit length:

∂wm=0
∂z

=

1
4πε
o

γ2




1 + 2ln







b
a




∂
∂z

δ(z − vt)

(118)

6.3.2 Simple physical approach for   γ → ∞

We have seen in Sec. 6.1 that at high energies one can solve Maxwell equations in the
static approximation.  Accordingly  we  derive  the  fields  produced  by  a  charged  cylinder  of
radius  a,  with  longitudinal  distribution  λ(z − vt) ,  moving  with  light  velocity  inside  a  p.c.
cylinder (Fig. 12).

Fig. 12 - On axis cylindrical bunch of radius "a"

For ultra relativistic charges, according to (103) and (104), the fields are derived by ap-

plying Gauss and Ampere laws; we get :

Er (r, z − vt) =

    








λ(z − vt)
2πε
o
λ(z − vt)
2πε
o

 

 

;     r ≤ a    

r
a 2
1
  ;     r ≥ a
r

Bφ(r, z − vt) =

    







λ(z − vt)Zo
2π
λ(z − vt)Zo
2π

 

 

;     r ≤ a    

r
a 2
1
  ;     r ≥ a
r

The scalar potential is  obtained  integrating  the  radial  field  (119)  from  the  disk  center

(r=0) to the pipe radius (r=b); we get:

V(r, z − vt) =

λ(z − vt)
4πε
o

2




1 − r



a




+ 2ln







b
a






(119)

(120)

(121)

- 31 -

And the wake function per unit length at  r = 0,  t =

+ τ becomes:

z
v

∂wm=0
∂z

= 1
qγ2

∂V
∂z

=

1
4πε
o

γ2q




1 + 2ln







b
a


 

∂λ(z − vt)
∂z

(122)

which reproduces Eq.(118) for a point charge with density  λ(z − vt) = qδ(z - vt).

6.3.3  Dipole longitudinal impedance m=1, r<r  1

The dipole impedance per unit length is:

∂Zm=1
∂z

=

− jωZo
2πc βγ(

)2 K1(ξ r1) − I1(ξ r1)

I1(ξ b)





K1(ξ b)


I1(ξ r)cos φ( )


(123)

In the limit  ξ b <<1 the dipole impedance is proportional to the transverse displacement

of the charge:

∂Zm=1
∂z

=

− jωZo
4πc(βγ)2





1
2
r1

− 1
b 2


rr1cos(φ)


(124)

6.3.4 Dipole transverse impedance  ξ b <<1

Applying the relationship (102) between dipole transverse and longitudinal impedances,

and noting that:

[

∇⊥ rcos(φ)

] = ˆrcos(φ) - ˆφsin(φ) ≡ ˆr1

(125)

we get the transverse dipole impedance per unit length and per unit transverse displacement:

∂ ′Z⊥,1(ω)
∂z

≡ 1
r1

dZ⊥,1(ω)
dz

=

− jZo
2π(βγ)2





1
2
r1

− 1
b 2


ˆr1


     [Ω/m2]

(126)

The same result could be obtained applying  Eq.(102),  recognizing  in  (124)  the  dipole

term  Zm=1 introduced in Eq.(76):

∂Zm=1
∂z

=

− jωZo
4πc(βγ)2





1
2
r1

− 1
b 2





(127)

Notice that according to the standard symbols, also the dipole term can  be  obtained  in

terms of radius of a cylindrical beam by putting  r1

= a  in Eqs.(124,126,127).

- 32 -

q = h − b
h + b

6.4  Elliptic pipe with perfectly conducting walls

The impedance expression Eqs.(116),(117), (126) and (127) have been extended to the
case of an elliptic pipe [13] in the ultra relativistic limit.  An  equivalent  radius  beq   is  intro-
duced for both longitudinal and transverse cases as function of the elliptic parameter:

(128)

where  h  and  b  are the pipe half-width and half-height respectively. The longitudinal equiva-
lent radius normalized to  b  is reported in Fig. 13. We  see that when  h >> b  the  curve  ap-
≅ 4b / π. In Fig.14 the transverse equivalent radius
proaches the parallel plates case with  beq
is reported as function of  q  for both horizontal and vertical oscillations.

1

0

0.2

0.4

0.6

0.8

1

q

Fig. 13 - Normalized equivalent radius for an elliptic pipe

b    / beq

2
(b   / b)
eq

1.3

1.2

1.1

2.5

2

1.5

4 / π

b

a

24 / π2

12 / π

2

v

h

1

0

0.2

0.4

0.6

0.8

1

q

Fig. 13 - Normalized ( beq /b)2 for horizontal (h) and vertical (v) oscillations

- 33 -

6.5 Pipe with lossy walls

When  consider a pipe  with  resistive  wall  of  infinite  thickness,  the  Maxwell  equations
have to be solved both in the pipe space and in the material with finite conductivity  σ where
the fourth Maxwell equation becomes:

∇ × B = εµ

+ µσE + µρv

(129)

∂E
∂t

Continuity of tangent magnetic field and normal electric field at the wall surface allows to
derive the e.m. fields components. The problem of a cylindrical pipe has been solved in the
ultrarelativistic limit [14] and for any value of the parameter  ξb [13]. Extension to the elliptic
pipe is found in Ref. [15] in the ultra relativistic limit. More recently the  impedance  for  an
arbitrary cross section has been developed [16,17] in the same approximation. Here we pre-
sent the results for the most relevant cases: circular, rectangular and elliptic pipe.

 The longitudinal impedance has the general expression:

where F is a form factor depending on the pipe cross  section, and  b  is the half-height of the
pipe cross  section ( b  is the  radius  in  the  circular  case).  The  inverse  Fourier  transform  of
Eq.(130) gives the wake function:

∂Zm=0
∂z

= 1 + j
2πb

ωZo
2cσ

 F

∂wz,m=0
∂z

= −F

1
4πb

Zo
πcσ

 τ-3

2

(130)

(131)

The above expression, being derived from a static approximation, fails at distances very

 
close to the charge. At very short distances the wake change sign as shown in Fig. 15.

w (  )τz

0

τ

τ-3/2

Fig. 15 -  Qualitative behaviour of the longitudinal wake of a lossy pipe

- 34 -

The transverse dipole resistive wall impedance is:

 

∂ ′Z⊥,1
∂z

≡ 1
r1

∂Z⊥,1
∂z

= F⊥

1 + j
2πb 3 Zo

δ ˆr1

        

[Ω/m2]

where  F⊥ is the transverse form factor for vertical and horizontal oscillations. The transverse
wake is:

d ′w⊥ ,1(τ)
dz

=

1
r1 

dw⊥ ,1(τ)
dz

= F⊥

1
πb 3

cZo
πσ

 τ-1

2      [V/m2C]

6.5.1 Circular beam pipe.

For a circular pipe,  F = 1 and  F⊥ = 1, the longitudinal monopole impedance is:

and for the transverse dipole impedance is:

Simple physical approach:

In the simple case of cylindrical symmetry, according to Sec. 2.4 and 3.1, the longitudi-
nal impedance can be computed as the complex power spectrum related to the energy flowing
into the lossy  walls. For  materials with a high conductivity, the fields inside the pipe are al-
most the same as in the p.c. case (perturbative approach). In the frequency domain we have:

∂Zm=0
∂z

= 1 + j
2πb

ωZo
2cσ

 

∂Z⊥,1
∂z

= 1 + j

2πb 3 Zo

δ

˜Er (ω) = qZo
2πr
˜Hφ(ω) = q
2πr

− jkz

 e

− jkz

 e

˜Hφ
The  continuity  conditions  at  the  boundary  r=b  requires  that  the  magnetic  field 
component  inside  the  material  surface  is  the  same  as  outside.  Inside  the  wall  the  field  is
sustained by a surface current flowing into the z-direction. The electric field  ˜Ez  is related to
˜Hφ by the Leontovich condition:

where:

˜Ez (ω) = Zc

˜Hφ(ω)

(137)

(132)

(133)

(134)

(135)

(136)

- 35 -

=

Zc

jωµ
o
σ

is the intrinsic impedance of the lossy  material. The flux of the Poynting vector at  the  pipe
wall gives:

∂Zm=0
∂z

= 2πbZc

˜Hφ

2 = 1 + j
2πb

ωZo
2cσ

 
 6.5.2 Rectangular cross section.

For  a rectangular beam pipe with half width  h  and half-height b, putting  λ = b / h, the

form factor F for the longitudinal impedance is :

F λ(



) = π





∞

∑

n=1,
odd

 

1
cosh2 nπ




2λ

+ λ

∞

∑

n=1,
odd

 

1
cosh2 nπλ




2

  








The form factor for the dipole transverse impedance in the x-direction:

λ(

) =

Fx

π3

8








∞

∑

n=1,
odd

 

n2
sinh2 nπ




2λ

+ λ3

 

∞

∑

n= 2,
even

n2
cosh2 nπλ




2

λ(
 
The function  Fy
first sum in the brackets:

) is simply obtained from eq.(141) by moving  the  factor  λ3  to  the

λ(

) =

Fy

π3

8

λ3

 

∞

∑

n=1,
odd

+

n2
sinh2 nπ




2λ

 

∞

∑

n= 2,
even

n2
cosh2 nπλ




2








The  behaviour  of  F λ(

 
Fig. 16 as a function of the parameter  q .

),  Fx

λ(

)  and  Fy

λ(

)  for  the  rectangular  pipe  is  presented  in















(138)

(139)

(140)

(141)

(142)

- 36 -

F

F
y

F
x

1

0.8

0.6

0.4

0.2

0

0

0.2

0.4

0.6

0.8

1

q

Fig. 16  - Form factors for a rectangular pipe

 

In the limit case of a pair of parallel plates  λ → 0, we have:

Fo 0( ) = 1,   Fx 0( ) =

,   Fy 0( ) =

π2

24

π2

12

 6.5.3 Elliptical beam pipe.

For  a beam pipe with an elliptical cross-section, major axis  2a and minor axis  2b, the

form factor is given as a function of the elliptic parameter  uo related to the parameter  q  by:

We get:

where

q = e

−2uo

F(uo ) = sinh(uo )

2π

∞

∫

0

G(uo,α)dα
sinh2(uo ) + sin2(α)

G(uo,α) = 2

∞

∑

m=−1

(−1)m cos(2mα)
cosh(2muo )

 

The transverse form factor in the x and y directions is:

 

Fx,y (uo ) = sinh3(uo )

4π

∞

∫

0

2

(uo,α)dα
Gx,y
sinh2(uo ) + sin2(α)

 

(143)

(144)

(145)

with

Gx (uo,α) = 2

(−1)m (2m + 1) 

Gy (uo,α) = 2

(−1)m (2m + 1) 

∞

∑

m=0

∞

∑

m=0

cos[(2m + 1)α]
cosh[(2m + 1)uo ]

sin[(2m + 1)α]
sinh[(2m + 1)uo ]

(146)

(147)

A graph of the numerical values of  F(uo ),  Fx,y (uo ) for the elliptical pipe is presented in

 
Fig. 17 as a function of the elliptic parameter  q .

- 37 -

F

F
y

F
x

1

0.8

0.6

0.4

0.2

0

0

0.2

0.4

0.6

0.8

q

1

Fig. 17 - F(uo ),and  Fx,y (uo ) as function of  q

7  NON UNIFORM BOUNDARIES

7.1  General properties

The uniform boundary cases described in the previous section allow to estimate the ef-
fect of smooth pieces  of  the  vacuum  chamber  on  the  beam  dynamics.  Usually  we  mainly
worry  about  the  resistive  wall  impedance,  which  produces  a  shift  of  the  transverse  tunes,
drives the head-tail and multibunch instabilities. The pipe  is,  however,  interrupted  by  many
devices installed on the machine, RF cavities, diagnostics, wigglers, cross section jumps etc.
 
Unlike the uniform boundary case, the discontinuities in the vacuum chamber are source
of  radiated  fields  which  do  not  travel  with  the  charge.  We  observe  several  consequences:
excitation of resonant HOMs in resonant structures, new configuration of the self field (after
a jump in the cross section), propagation of e.m. fields at frequencies above the cut-off of the
beam pipe [18].

As an example, in Fig. 18 we show the case of a relativistic point charge crossing a hole

in an infinite p.c. plane.

- 38 -

b

z

c τ

Fig. 18 - Relativistic charge passing through a hole of radius b.

The diffraction is caused by the primary fields which, impinging on the hole edge, pro-
duce secondary scattered fields propagating at the light velocity. The distance for the radiated
fields to catch up the charge itself is  z = γb. A test charge traveling a distance  βcτ ( β ≈ 1)
behind will be reached by the same fields at  z ≈ (b 2 − c 2τ2 ) / (2cτ).

 Another basic feature of the diffraction effects concerns the frequency bandwidth of the
power spectrum. Despite the point like nature of the charge, the primary  fields  exciting  the
= b / γ.The diffraction excitation has a power spectrum ex-
edge have an effective size  σ
≈ cγ / b above which there is an  ex-
tending up to a "radiation cut off frequency"  ω
ponential roll off.

rad
cut−off

eff

The geometry of Fig. 18 has  been  extensively  studied  [19].  A  ultra  relativistic  charge

passing through the hole loses the energy:

U11

= 2U(r ≥ b) = 3π
8







ro
b

γ moc 2

(148)

It is interesting to note that the energy loss  is twice as much as given by Eq. (111), i.e.
the amount of energy stored outside the tube of radius  b . This feature has been found also
for other geometries (such as the step discontinuity) : a ultrarelativistic point charge deposits
the same amount of energy in rebuilding the self field as in the radiated fields. This result, in
general, can be explained as the typical phenomenon occurring in the charge or discharge of a
capacitor.

At low frequencies the longitudinal impedance is [20]:

Z(ω) ≈ Zo
2πβ


log









1 + β
 − β+ iπ

1 − β



(149)

- 39 -

200

150

100

50

7.2 A step transition

 
Let us consider an abrupt change in the cross section of a circular beam pipe from a ra-
dius  b  to radius  d  (Fig. 19). When  the charge crosses  the  vacuum  chamber  discontinuity
secondary fields are scattered at the sharp edges. The total fields, "primary" plus "secondary"
diffracted fields, are such to restore the boundary condition at the pipe walls. This  problem
has  been  treated  by  several  authors  with  numerical  and  analytical  techniques  [21,22].  An
exact  analytical  solution  has  been  found  for  a  discontinuity  made  of  two  coaxial  circular
pipes  for  which  both  longitudinal  and  transverse  dipole  impedances  have  been  derived
[23,24]. Here we will report the main relevant results and features.

Fig. 19 - Step discontinuity in the beam pipe

  We  will distinguish two cases:  a  particle  exiting  into  a  beam  pipe  of  a  bigger  radius,
"step-out" case, and a particle entering a narrowing pipe,  "step-in"  case.  Theoretical  results
show that the impedance is mostly resistive  in  the  step-out  case  with  a  big  contribution  at
high frequencies above cut off, while in the step-in case the impedance is  low,  vanishing  at
high frequencies. In Fig. 20 we show examples of impedances for the step-in  and  step-out
problems, as derived with the computer code ABCI [25].

Z [Ω]
r

[Ω]

Zr

STEP-IN

STEP-OUT

20

40

60

80

20

40

60

80

100

f [GHz]

100

 

0

0

f [GHz]

Fig. 20 - Longitudinal impedances of a step-in and step-out discontinuity

150

100

50

0

-50

0

- 40 -

The impedances have a resonant behaviour just after the beam pipe cut-off and reaches a

constant asymptotic value at high frequencies. The asymptotic behaviour of the  real  part  of

the impedance is:

 

out ~
Zm=0

Zo
π

ln







d
b

and

in
Zm=0

~ 0

(150)

Such different results are explained by recognizing two main effects contributing to the

energy loss.  In the step  out  case,  when  the  charge  crosses  the  discontinuity,  the  self  field
restoring the boundary conditions, has to fill the extra space  b < r < d  between the two pipes,
while diffracted fields propagate into the pipes. Both these effects lead to an energy loss  that

can be put as:

q2kout = U(b < r < d) + Erad

(151)

where  Erad  is the energy radiated at the edges and  U(b < r < d)is the energy necessary  to
fill the region  b < r < d .

In  the  step-in  case,  the  radiated  energy  is  reflected  back  with  respect  to  the  particle

motion without changing its kinetic energy.

q2kout = −U(b < r < d) + Erad

(152)

For a point charge, since the radiated energy is taken out of the energy "missing" in the

smaller radius pipe:  Erad

≈ U(b < r < d), we have:

  q2kout ~ 2U(b < r < d)
q2kin ~ 0

(153)

We  remind  that  for  a  real  bunch  both  U(b < r < d)  and  Erad   depend  on  the  bunch
length. In particular, if the bunch spectrum does not cover significantly the frequency region
above the pipe cut-off, there is no radiation.

In Fig. 21 we show the dependence of the loss factor on the bunch-length for the step-in
and step-out cases, for a step with  b = 2cm and  d = 4cm. In this  case  we  find  that  a  long
bunch  loses  energy  in  the  step-out,  but  would  regains  the  same  amount  of  energy  in  a
symmetric step-in. Therefore, if a long bunch crosses a pipe enlargement formed by a step-
out and step-in sequence with same radii, the total energy loss is almost zero; in this case the

wake function inside the bunch is an odd function and the impedance practically inductive.

- 41 -

K [V/pC]

step-out

1.2

1

0.8

0.6

0.4

0.2

0

-0.2

0

step-in

1

2

3

cστ [cm]

4

Fig. 21 - Example of step-in and step-out loss factor versus bunch length

 

The dipole longitudinal and transverse impedance for a discontinuous coaxial  pipe  has
 
been  derived  in  [24].  The  model  allows  for  an  exact  solution  of  the  e.m.  problem,  and
furnishes simple expressions of the impedance at high frequencies that can be used also for
real step transitions:

out ~
Zm=1

Zo
2π2




1
b 2

− 1
d 2


rr1 cos(φ)

     

  [Ω]

in
Zm=1

~ 0

The high frequency transverse dipole impedance for the step out case is:

′Z⊥,1

≡ 1
r1

Z⊥,1

= cZo
2π2ω




1
b 2

− 1
d 2


 ˆr1

        

[Ω/m]

Simple physical approach.

To complete this section we find worth showing that the asymptotic expressions  (150)

can be derived in with a simple physical approach. We compute the energy U(b < r < d):

For ultra relativistic charges in a cylindrical pipe, the fields are almost the same as in the

free space:

 

U(b < r < d) = ε

dV

2

∫
o Er
V

Er ~

q
2πε

or







γ

b

(154)

(155)

(156)

(157)

- 42 -

Integration (156) gives:

                 

U(b < r < d) ~

kout = 2

∆W
q2 ~

q2Zo
2π
Zo
π

ln




ln




d
b

d
b








cγ
b









cγ
b

eff

Remind that  σ

= (b / γ) is the effective charge size and that as far as  kout is inversely
proportional to the size, we can expect that  Zr (ω) is a constant function of  frequency  (see
the discussion in 3.2). Now, applying the definition (72) and considering the spectrum of a
bunch with rectangular distribution, we get for a constant impedance:

K = 1
π

Zr (ω)

eff / 2c)

sin2(ωσ
(ωσ

eff / 2c)2

dω = Zr (ω)
σ
eff / c

.

∞

∫

0

From the comparison (158) and (159) the expected result follows.

7.3  Taper

  
If one uses long gradual tapers instead of the abrupt step transitions the total energy loss
may be drastically reduced. Indeed, the infinitely long taper reduces the radiated energy  Erad
to zero. For a point charge we have:

out ~
ktaper

in
ktaper

out
kstep

U(b < r < d)
q2
~ − U(b < r < d)
q2

= 1
2
= − 1
2

out
kstep

  
It means that in the limit of long tapers the  loss  factor  of  a  taper-out  reaches  half  the
value of the loss factor for a step-out. There may be even an energy gain for the taper-in case.
It must be considered, however, that in a vacuum chamber of a circular accelerator there are
taper-in and taper-out transitions. As it can be easily seen, long symmetric tapers reduce total
losses practically to zero:

Certainly, we can  not  use  infinitely  long  tapers  in  an  accelerator  design.  In  [18]  it  is
shown that for a short bunch of rms length σ the dependence of the longitudinal loss  factor
of a one-sided taper on its angle can be approximated by the formula:

k = ktaper
  

out + ktaper

in

~ 0

K = Zoc


2σπ3/ 2 1 −



˜η
1
2


 ln


d
b

(158)

(159)

(160)

(161)

(162)

where

For a symmetric taper   ˜η

1 / 2 is replaced by   ˜η

1. So, the condition:

- 43 -

˜η
1

= min 1,  





gσ
d − b

(

)2





gσ
d − b

(

)2

> 1

(163)

(164)

can  be  considered  as  an  approximate  criterion  to  choose  a  reasonable  taper  length.  We
should say here that the formula (162) is valid for short bunches when the main contribution
to the losses comes from the high frequency impedance and the diffraction model [18,26] can
be applied. Because of that we advice the reader to use numerical codes in order to check the
criterion (164) for any particular case. As an  example,  we  show  in  Fig.  22  the  loss  factor
versus the taper length g for a tapered out structure passing from b = 2 cm to d =  4 cm. One
can see that the loss factors for a bunch of 0.5 cm and 1.0 cm computed by the code ABCI,
approach an asymptotic value corresponding to the case of no radiation, at a value of g such
that  ˜η
= 1. For the 3 cm bunch length the whole bunch spectrum lies below the beam pipe
cut-off and no radiation occurs.

1

K [V/pC]

1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

σ = 0.5 cm
c τ

1 cm

3 cm

2

4

6

8

g [cm]

10

Fig. 22 - Loss factor of a tapered discontinuity

  7.4  Single cell cavity

Cross  section variations in an accelerator vacuum chamber can create resonant  cavities.
 
Part of the fields excited in the cavities is entrapped reflecting back and forth generating the
resonant modes. Above cut-off the amplitudes of the resonance drops  because of the energy
leakage  into  the  vacuum  chamber,  the  resonances  overlap  leading  to  the  smooth,  "broad-
band" impedance.

- 44 -

Zi

0

   A typical cavity impedance is shown in Fig. 23 At the frequencies below ωc a real high-
Q  cavity has many sharp resonance. In a RF  cavity the fundamental one  is  used  to  supply
energy to the beam; all the others are "parasitic" modes (higher order modes - HOM)  which
subtract energy from the beam. Above cut-off the resonances are broadened.

Zr

0

0

1

2

3

4

0

1

2

3

4

f [GHz]

f [GHz]

Fig. 23 - Typical impedance spectrum for a cavity with attached tubes

 7.4.1   Monopole HOM (longitudinal)

 
In Sec. 2.2.1 we have found the wake potential of a single HOM.  Following the results
(47) of Sec. 2.8 for cylindrical symmetry, we can write the longitudinal wake of a monopole
HOM (m=0) as:

wz,o(r, r1; τ) = 2ko(r,r1) −Γ

e

o

τ

cos(ω
o

τ) −

sin(ω
o

τ)

Γ
o
ω
o


H(τ)






ω
o
2Qo

with    Γ
o

=

2 − Γ
2 = ω
  ,  ω
2     
o
o
o

In Sec. 2.9 we have also found that in the ultra relativistic limit the monopole longitudinal
wake does not depend on the radial displacement of both leading and trailing charges  (54).
This result is conveniently exploited in the numerical codes where the loss  factor  ko(r,r1) is
computed at the pipe radius, thus limiting the calculation of the  energy  loss  over  a  definite
and limited path:

ko(r,r1) ≡ ko(b) =

ω
oRo
2Qo

= Vo(b) 2
2Uo

where  Vo(b) is the voltage gain computed at  r = b  and  Uo  is the average energy stored in
the HOM.

(165)

(166)

(167)

Applying  the  Fourier  transform  to  (165)  we  get  the  longitudinal  impedance  of  a

monopole resonant HOM:

 

  

It is interesting to note that the shunt impedance is also defined as:

where  Pod   is  the  power  dissipated  at  the  cavity  wall  or  in  any  damping  device
(loops,waveguides etc.), and  T  is the transit time factor defined as the ratio between the ac-
celerating voltage seen by a traveling charge and the voltage at the gap:

- 45 -

Z ω(

) =

Ro
ω
ω
o





 

−

ω
o
ω





1 + jQo

Ro

= Vo(b) 2
Pod

T 2

T =

1

Ez dz

∫

 

gap

∫

gap

Ez e jkzdz

which  takes  into  account  the  time  evolution  of  the  fields  during  the  cavity  crossing.  The
transit  time  factor  approaches  unity  at  low  frequencies  (wavelength  much  bigger  than  the
gap).

  In  the  low  frequency  limit  ω → 0  the  impedance  is  purely  inductive.  In  case  of  n

HOMs we have:

Z ω(

) = jω





Rn
ω
Qn
n





∑
n

= jωL

7.4.2   Dipole HOM (longitudinal)

  The wake potential of a single dipole (m=1) HOM for cylindrical symmetry is given by:

wz,1(r, r1; τ) = 2cos(φ)k1(r,r1) −Γ

e

1

τ

cos(ω

τ) −

1

sin(ω

τ)

1





Γ
1
ω
1


H(τ)


with    Γ
1

=

  ,  ω

2 − Γ
2 = ω
2    
1
1
1

ω
1
2Q
1

(168)

(169)

(170)

(171)

(172)

(173)

The dipole wake potential in the ultra relativistic  limit  is  proportional  to  the  transverse
displacements of both charges. Therefore, we may scale the loss  factor computed at the pipe
radius as:

- 46 -

k1(r,r1) ≡ k1(b)

rr1
b 2

k1(b) =

ω

1R1
2Q1

= V1(b) 2
2U1

(

Z1 r, r1;ω

) =

R1
ω
ω
1





−

ω
1
ω





1 + jQ1

rr1
b 2 cos(φ)

7.4.3   Dipole HOM (transverse)

The general relationship between transverse and  longitudinal  wake  functions  allows  to

obtain the transverse dipole wake function (96):

w⊥,1(r, r1; τ) = r1

2c

1b 2 k1(b) −Γ

e

1

ω

τ

sin(ω

τ)H(τ)

1

The transverse impedance (102) is:

Z⊥,1



(r, r1;ω) = c


ω

R1
b 2
ω

ω
1





r1

−

ω
1
ω





1 + jQ1

Z⊥,1

(r, r1;ω) =




ω
1
ω




′R⊥,1

ω



ω
1

r1

−

ω
1
ω





1 + jQ1

′R⊥,1

= cR1
ω
1b 2

=

ω
1
c

Urmel

R⊥

sometimes expressed as:

with

URMEL.

The quantities  R1 and 

′R⊥,1 are derivable from the output  data  of  numerical  codes  like

(174)

(175)

(176)

(177)

(178)

(179)

(180)

- 47 -

7.4.2 High frequency case

    The high frequency impedance is mainly due to the interaction of the charges  with  the
fields diffracted at the  cavity-pipe  edge.  When  the  bunch  length  is  much  smaller  than  the
beam  pipe  radius,  the  high  frequency  contribution  to  energy  loss  and  impedance  can  be
dominant. Numerical calculations require significant time to find the wake potentials of very
short  bunches,  therefore  an  analytical  analysis  of  the  high  frequency  behaviour  of  the
impedance (short range wake potential)  becomes  necessary.  Methods  of  diffraction  theory
are used to calculate the impedance at the high frequencies,   ω > > c / b. For a pill-box cavity
of length  g radius  d , Fig. 24, and with side pipes of radius  b   the  diffraction  model  gives
[27,28,29]:

Z ω(

(
) = 1 − j

) Zo
2πb

 

gc
ωπ

g

δ

l

z

 

d

b

Fig. 24 - Relevant parameters for a pill box with attached tubes.

The formula is valid for the region of parameters  where  g < < kb2   (a  'cavity  regime').
For  the  region  of  parameters  g > > kd 2  the  diffraction  model  of  [26]  gives  the  same
impedance as found for a "step":

 

In the transition region of parameters  kb2 < < g < < kd 2

The transition from the cavity to the step regime is explained by the transition from the
Fresnel diffraction for the cavity to the Fraunhofer diffraction for the step. It was shown that
the transition from one regime to another occurs when:

Z ω(

) = Zo
π

ln

d
b

Z ω(

) = Zo
2π

ln

gc
ωb2

2 gσ
d − b

(

)2 ~ 1

η =

  

(181)

(182)

(183)

(184)

- 48 -

The cavity regime is reached when the parameter  η < < 1. In the opposite case, η > > 1,

the regime of a step is fulfilled.
For a short Gaussian bunch, for which  σ < < b, the high frequency tail of the impedance
 
mainly contributes to the energy loss. In this case the longitudinal and transverse loss  factors
are given by:

g
πσ


, Γ 1

4




= 3.6256..

(185)

 

K = Zoc
4π2b
K⊥ = Zoc
4π





Γ 1

4
πgσ
b3

Simple physical approach

The high frequency behaviour of the impedance and loss factor is qualitatively explained
by the features of the fields diffracted at the cavity edges [30]. Consider a bunch of charge  q
and rms size σ passing a pill-box cavity (Fig. 24). The field excited by the head of the bunch
and diffracted by the left edge, touches the bunch tail if:

  l
c

= z + σ
βc

with

l = δ2 + z2

(186)

When  the  bunch  leaves  the  cavity,  for  z=g,  the  self-field  has  been  perturbed  in  the
δ ~ 2 σg . The bunch has to rebuild the field in this region in order to
shadow region with   
restore the boundary condition in the rhs  beam pipe. The e.m. energy removed in the shad-
owed region of Fig. 24 is:

if  δ < < b

 

:

thus giving:

 

U ~

q2
4πε
o

σ

b

∫

dr
r
b−δ

U ~

q2
4πε
o

δ

=

σ

b

q2
4πε
o

σ

2σg
b

K = U
q2

=

1
4πε

ob

2g
σ

(187)

(188)

(189)

Note that the condition  δ < < b implies also that  σ < < b (g is comparable with b) and
most part of the bunch spectrum lies well above the beam pipe cut-off frequency. As far as
the loss factor is inversely proportional to the bunch length the impedance scales as 1/ ω.
For  a point charge the effective bunch length is b / γ  giving  the  scaling  for  the  loss  factor
  k ~ γ .

- 49 -

7.5 Periodic r.f. structure

An array  of  periodic  cavities  shows  an  impedance  spectrum  similar  to  the  single  cell

cavity below the cut-off frequencies. Many sharp resonant modes  appear  in  the  impedance

spectrum corresponding to the normal modes of the single cavities  but  also  to  the  coupled

modes  between  cells,  like  in  a  system  of  coupled  oscillators.  Above  cut-off,  however,  the
broad impedance decays at high frequencies with the asymptotic law  ω−3/ 2  [31,32]. A quali-
tative picture of the diffraction phenomenon at the basis of such behaviour is given in [30].

Basically, the energy refilling becomes much less in a periodic structure, since the self-field

has no time to be rebuild from one cell to the next. The transition from the single cell regime

to the periodic structure regime has also been studied [33]. For  a structure of  M  rf cells of

period  d  and iris radius  b , we have the transition from the single cell regime to the periodic

structure regime at the frequency:

ω
t

≈ cMd
b 2

(190)

above which the impedance follows the single  cell  asymptotic  behaviour  ω−1/ 2.  It  is  worth
noting that in the periodic structure, the asymptotic decay  ω−3/ 2  makes the loss  factor inde-
pendent from the bunch length and from the energy. Similar expressions have been found for

the case of a charge  passing  through  an  array  of  holes  in  infinite  planes,  reproducing  the

same diffraction phenomenon [34,35].

7.6  Small  discontinuities

In a real vacuum chamber there are many small discontinuities such as shallow cavities,

tapers, masks, bellows, etc. In spite of the little size, their overall contribution to the inductive

impedance, up to rather high frequencies, cannot be neglected. These elements give the main
contribution to the longitudinal inductive impedance responsible for the potential-well bunch
lengthening process.

At low frequencies a satisfactory estimate of the inductive impedance  Z ω(

) = jωL  can
be  obtained  by  applying  Faraday's  law  in  the  static  approximation.  However,  it  has  been
shown that one can get more accurate results taking into account a correction factor coming
from distortion of the electric field at the chamber discontinuity [36]. Here we do not discuss
the method used by authors, but  reproduce  helpful  expression  for  the  impedance  of  some
typical discontinuities shown in Figs. 25.

- 50 -

g

θ

b

h

h

b

b

g

e

h

g

a

h

b

b

g

c

b

h

g

d

 Fig. 25  - Examples of vacuum chamber discontinuities

7.5.1 Shallow cavity  (Fig. 25a)

The low frequency impedance of the small short pill-box (g < h) is given by:

 

Z ω(

) = jω Zo
2πbc






gh − g2

2π


For the opposite extreme,  g >> h, but still  g < b:

 

Z ω(

) = jω Zoh2
2π2bc





2ln




2πg
h





+ 1



When the length  g of the pill-box is greater than the pipe radius  b , the pill-box can be
considered as composed of two independent steps each giving the following contribution to
the impedance:

The transverse impedance of the shallow cavity, if the assumption  (g,h) < b  is valid, is

Z ω(

) = jω Zoh2
4π2bc





2ln




2πb
h





+ 1



Z⊥ = jZo

g
πb2





d 2 − b2
d 2 + b2





given by :

where  d = b + h.

(191)

(192)

(193)

(194)

- 51 -

7.5.2 Shallow trapezoid (Fig. 25b)

For  a long shallow trapezoid  ( g >> h)  the  impedance  of  a  single  sloping  step  (taper)

with the slope angle  θ = πν has the form:

Z ω(

) = jω Zoh2
2π2bc



ln πν b


h


− 2cot πν


+ 3
2

− γ − ψ ν( ) −

π

2


cot πν− 1

2ν

(195)

γ = 0. 5772... is Euler's constant,  ψ ν(

where   
assumed to be short compared to the chamber radius, i. e. its length  l = h cot πν<< b.

) is the "psi"  function  and  the  transition  is

7.5.3 Shallow iris (Fig. 25c)

Two extreme cases can be considered for the iris geometry. When  g >> h the impedance
of the iris coincides with that of a shallow cavity. For the case of a thin (or deep) iris  g << h
the expression for the longitudinal impedance takes the form:

Z ω(

) = jω Zo
4bc





h2 + gh
π

[

2ln 8πg / h

(


]
) − 3



(196)

 6.5.4 Discontinuities of a triangular shape  (Fig. 25d,e)

A  short  discontinuity  of  a  triangular-shaped  cross-section  with  height  h   and  base  g

( g << h) has the following low-frequency impedance:

Z ω(

) = jω Zo
4πbc





gh − g2
π





The impedance of a triangular iris is given by:

Z ω(

) = jω Zo
4bc




h2 + 2gh
π

(1 − ln 2)




For  the case of shallow triangular perturbations,  h << g < b , both  the  enlargement  and

iris have the same inductive impedance, independent of  g:

Z ω(

) = jω2Zoh2 ln 2

π2bc

(197)

(198)

(199)

- 52 -

7.7 Elements of Beam Diagnostics

Each accelerator has numerous diagnostics elements such as button pick-ups, strip-line
beam position monitors, etc.. Impedance calculation of such elements is a rather difficult task.
Being  inserted  into  a  vacuum  chamber  a  diagnostics  element  brakes  the  vacuum  chamber
symmetry and one has to analyze the interaction of a bunch with a complicated 3-dimensional
structure.

Numerical solution to the problem is also not a simple task. Usually, sizes of the diag-
nostics element are small. This demands a very  fine  mesh,  and  so  large  computation  time.
Moreover, the image currents induced in the elements flow into the external circuits. The cor-
rect simulation of this external load appears to need additional analytical efforts or using re-
cently developed sophisticated numerical codes.
 
ω < < ω

The methods which allows an analytical treatment of the impedance at low frequencies,

c, is based on the electrical approach:

 -

the 3D  geometry is substituted by an equivalent circuit  consisting  of  concentrated  radio
technical elements and transmission lines;

 - methods of electric circuits and theory of transmission lines are used to find currents and

 -

voltages in the circuit elements;
in the case of matched load, the coupling impedance is defined by considering the power
lost by a bunch to be equal to that dissipated in the load. Some other consideration can be
taken into account to relate the beam coupling impedance with the currents and voltages in
the circuit elements.

Here we will closely follow the treatment of [39] in order to illustrate the method. Let

us consider a strip-line pick-up of the length l covering the azimuthal angle  φ (see Fig. 26).

Zs

Zs

2b

Zs

l

z

φ

b

x

Fig. 26  - Strip line pick-up

The strip plate together with the vacuum chamber wall create a transmission line of the
characteristic impedance  Zs . If the transmission line is terminated by a matching  resistance
Zs  at the each end, one can draw the equivalent scheme of Fig. 27.

- 53 -

Zs

l

i  /2φ

i  (t)φ

i  /2φ

Z
s

Zs

i  (t - l/v)
φ

Fig. 27 - Equivalent circuit for a strip line

where  iφ t( ) is the fraction of the image current intercepted by the strip plate:

iφ t( ) = −




φ

 ib t( )
2π

with  ib t( ) the beam current.

In the absence of a dielectric the signal velocity in the transmission line is equal to that of
light. Moreover, as  it  can  be  seen  from  the  equivalent  scheme,  the  strip-line  monitor  pos-
sesses directional property for the relativistic particle with β~c. In fact the signal appears only
across the upstream port (with respect to the beam velocity):

In turn, only a fraction   

φ/ 2 π of the total image current "sees" the potential difference,

from what follows that the average potential seen by a beam is:

V t( ) = Zs
2




φ


 ib t( ) − ib t − 2l

2π
c










Vb t( ) = V t( ) φ


2π




Applying  the  definition  of  the  impedance  as  a  response  for  the  sinusoidal  current

perturbation, we have:

Z ω(

) = Zs

2

[




φ


2π

sin2 κl(

) + j sin κl(

)cos κl(

]
)

The same result for the real impedance has been derived by considering the real power
dissipated in the upstream termination as the power lost by a bunch [38]. The imaginary part
was found by Hilbert transform.

(200)

(201)

(202)

- 54 -

Z⊥ ω(

) = c
b2

2






4

φ





sin2 φ


2




Z ω(
)
ω




The transverse impedance of a pair of symmetric strip-lines matched on  the  both  ends

has been found in [39]. In the direction perpendicular to the strip-lines:

(203)

(204)

(205)

where Z(ω) is the longitudinal impedance of that pair of striplines. A particle shifted with re-
spect to the system axis in the direction parallel to the strips does not experience any trans-
verse kick and the transverse impedance in the direction  Z⊥ ω(
  
The same method gives for a strip-line forming a transmission line with the beam pipe
with characteristic impedance  Zs  and terminated at the center by  Zs  the following longitudi-
nal impedance [39]:

) = 0.

Z ω(

) = Zs

2

(




φ


2π

1 − jκl

(
) 1 − e

− jκl

)

where  l is again the strip length and  φ is the azimuthal angle characterizing the fraction of
the image current intercepted by the strip plate.
 
The  longitudinal  coupling  impedance  of  a  small  button-like  pickup  of  a  radius  r
terminated trough a coaxial cable of the characteristic impedance  Zs  by a resistance R =  Zs
is [40]:

Z ω(

) =

2









ω
1
ω
2

ω/ ω
1
(
1 + ω/ ω
1

[

]

)2





ω
ω
1

+ j





with

ω
1

= 1
RC

    

and

    ω
2

= 2bc
r 2

where b is the beam pipe radius, C is the capacitance between the button and the beam pipe
πr2 / δ for  δ < < b being the gap between the
wall which is roughly estimated as:   C ~ ε
wall and the button.

0

Many examples can be found in the literature on the subject. However,  we  should  say
that the high frequency behaviour of the diagnostics elements has  not  been  satisfactory  in-
vestigated yet. One of the major problems, for the further investigation are the high frequency
resonances that can be excited in the structures formed by a diagnostics  element  and  beam
pipe walls. Some of such resonances can be associated with  standing  waves,  which  do  not
dissipate  their  power  in  the  external  terminations  [41].  Obviously,  the  high  frequency
resonances will give some additional inductive contribution to the low frequency impedance.

- 55 -

7.8 Holes and Slots in the vacuum chamber.

 In order to reduce the coupling impedance due to pumping volumes shielding screens
with a number of holes or slots are used. The number of such holes and slots may be large in
an accelerator and their contribution to the impedance have to be estimated. It is obvious that
because of absence of the axial symmetry a numerical solution of the problem is essentially
three  dimensional.  This  implies  very  time-consuming  computations  even  in  the  case  of  a
simplified model.

The method which allows analytical calculation of the impedance at  low  frequencies  is
based on the Bethe theory of diffraction by a small hole [42]. According to  the  theory,  the
small hole is excited by the incident electromagnetic waves created by a given current pertur-
bation.  Then,  the  diffracted  fields  can  be  obtained  replacing  the  hole  by  effective  surface
"magnetic" currents, which are necessary to satisfy the boundary conditions on the hole. The
coupling impedance is found by integrating the fields along the beam trajectory. At low fre-
quencies,   ω < < c / b, in the case of a small hole of radius h << b the impedance can be cal-
culated in terms of hole polarizability [43,44]. For a circular hole it gives:

As far as a single hole introduces the axial asymmetry, the transverse impedance depends

on the angle between the beam-offset and the direction to the hole:

Z ω(

) = jω Zo
6π2

h3
cb2

Z⊥ ω(

) = jZo

2h3
3π2b4 ar cosθ

where  ar  is the unit vector to the hole and  θ is the azimuthal angle between the direction and
the beam-offset.
It is worth noting, that for the number of  holes  M ≥ 3uniformly  spaced  in  one  cross
  
section the restoration of the axial symmetry occurs in a sense that the transverse kick is in
the  direction  of  the  beam  transverse  displacement  and  the  resulting  impedance  does  not
depend on the azimuthal positions of the holes:

Z⊥ ω(

) = jZo

h3
3π2b4 M r1

with  r1  being  the  unit  vector  in  the  direction  of  the  beam  displacement.  The  coupling
impedance of the circular hole falls with wall thickness t, reaching 56% of the value (206) for
t / h > 2 [44].

(206)

(207)

(208)

The  real  part  of  the  hole  impedance,  responsible  for  the  energy  losses,  is  usually

 
neglected because it is much smaller than the imaginary impedance. It is given by [43]:

The  same  method  gives  simple  analytical  expressions  for  the  impedance  of  small

 
longitudinal elongated elliptical slot of width w and length l such as w << l << b :

- 56 -

ω(

Zr

) = 5Zo
54π3




ωh
c




4 h2
b2

Z ω(

) = j

Zo
96π

ω

c

w4
b2l




ln


− 1


4l
w

Z⊥ ω(

) = j

Zo
24π

w4
b4l




ln

4l
w


− 1
 ar

Z ω(

) = j

Zo
96π

ω

c

l 3

4l

w


b2 ln







− 1



Z⊥ ω(

) = jZo

l 3

24πb4 ln









4l
w


− 1



ar cosθ

(209)

(210)

(211)

(212)

(213)

Analytical results are available  also  for  the  small  transverse  narrow  elliptical  slot  with

 
w<< l << b, cutting the wall image currents [45]:

More discussion on the small slot impedance calculations  and  estimates  can  be  found

in [46].
  When the sizes of slots and holes are comparable or larger than the beam pipe radius the
static solution to the problem is no longer valid. In that case analytical solutions are known
for two particular cases of a long narrow slot and a narrow gap.
 
It is clear from the physical point of view that the narrow  (w  <<  b)  long  (l  >>  b)  slot
distorts  the  fields  inside  a  vacuum  chamber  only  by  the  slot  ends.  Because  of  that  the
impedance  should  not  depend  on  the  length  of  such  a  slot.  Indeed,  according  to  the
perturbation method [47] the impedance of  a  narrow  long  (but  finite)  rectangular  slot  is  a
constant for   ωl / c > > 1:

Z ω(

) = j

Zo
4 2π(

πw2
)3b2

(214)

- 57 -

The impedance for the case of narrow  transverse  gap  of  width  g  <<  b  separating  two
ωg / c < < 1  the

pieces of the infinite beam pipe has been derived in Ref.[48]. In the  case    
longitudinal impedance of the gap is capacitive:

Z ω(

) = − j

Zoc
(
2ωb ln 16b / g

)

(215)

We should note here that for a beam pipe of a general cross-section in order to reduce
the coupling impedance it is preferable to distribute holes in places where fields created by a
bunch are minimal, for example, in corners [45]. In particular, for a rectangular beam pipe of
width  a  and  height  b  the  longitudinal  impedance  of  a  hole  situated  on  the  lateral  side
(xh = ±a/2)  and  displaced  by  yh  from  the  horizontal  plane  of  symmetry  (|yh|  <  b/2)  is
proportional to:

Z ω(

) ~

∞

∑





m=0

(
cos 2m + 1
(
cosh 2m + 1

)πyh / b
)πxh / b

2






(216)

As it can be easily seen, the closer to the corner (|yh|  → b/2) the smaller impedance we

have. This is certainly valid for small holes.
 
just mention that the coherence can be destroyed using non-uniform hole spacing.

Discussions  on possible coherent effects of many holes  can  be  found  in  [49,50].  We

8.  BROAD BAND IMPEDANCE MODELS

 
The impedance of an accelerator is usually a very complicated function of frequency with
many sharp peaks. This complexity of the impedance makes an  analytical  treatment  almost
impossible. However, in  the  study  of  the  single  bunch  dynamics,  one  finds  that  the  wake
potentials  over  the  bunch  length  is  of  main  interest.  This  implies  that,  in  the  frequency
domain, the bunch can not resolve the details of the  sharp  resonances  and  it  rather  experi-
ences an average effect (the peaks are smeared out). In order to demonstrate this we calculate
the wake potentials created by a bunch passing through a cavity, by means of the ABCI code.
The longitudinal impedance is found by Fourier transform of the wake potentials.
As it is clearly seen in Figs.  28 and 29, if one is interested in shorter range part of the
wake  the  resonant  impedance  peaks  are  transformed  into  the  smoother  and  broader
impedance.

r [m]

0.09

-Wz/|Wz|max

0.08

0.16

0.24

0.32

1

2

z [m]

-1

0

s [m]

3

 Fig. 28 - Pill-box cavity with tubes and wake function for  cστ= 3 cm

0.06

0.03

0

0

Z [Ω]
r

800

600

400

200

- 58 -

0.5

1

0

-0.5

400

200

0

-200

Z [Ω]
i

0

0

2

4

6

8

10
f [GHz]

-400

0

2

4

6

8

10

f [GHz]

Fig. 29 - Broad Band Impedance: FFT of the wake function over 3 m (solid line);
FFT of the wake function over 30 cm (dashed line).

Therefore,  the  actual  impedance  can  be  replaced  by  some  "broad-band  model
impedance",  which  usually  is  characterized  by  a  small  number  of  parameters,  allowing
analytical evaluation of stability limits or growth rates of single bunch instabilities.

 

8.1  Broad-band resonator model

The reduced frequency resolution has been the main  justification  for  using  the  broad-

 
band resonator model [51], historically being introduced first.

- 59 -

The actual impedance is replaced by that of a single mode cavity with a low quality factor

Q:

Z ω(

) =

Rs
ω
ω
r





  

−

ω
r
ω





1 + jQ

(217)

So, only 3 parameters, the shunt impedance  Rs, angular resonant frequency  ω

r , quality

factor  Q, are necessary to describe the impedance frequency behaviour.
For  long bunches a cavity shunt impedance  Rs is  estimated  by  averaging  the  resistive
 
part of parasitic resonance (which can be measured by means of perturbation method, or es-
timated by computer codes) to give the same energy loss as the whole cavity. Each resonance
contributes with only half the area of its spectrum.

ω

The  quality  factor  is  usually  taken  as  Q  =  1,  while  the  resonant  frequency
r  = ωcutoff =  2.4 (c / b), i. e.  frequency  cut-off  of  the  cavity  iris  of  the  radius  b .  These
choices are somewhat arbitrary and are satisfactory only for the case of long bunches, when
the whole bunch spectrum lies within the beam-pipe cut-off. As an example, let us  consider
again the cavity of Fig. 28. We  find out  that  the  effective  impedance  calculated  as  Fourier
transform  of  the  wake  over  30  cm  distance  behind  the  bunch  head  is  approximated
reasonably well by the broad band resonator impedance with  Rs = 138 Ω,  Q = 1 and fr = 2.2
GHz (which is close to the fcut-off = 2.5 GHz of the considered cavity) (Fig. 30).
 

[Ω]

Z
r

150

100

50

Z [Ω]
i

100

50

0

-50

0

0

2

4

6

8

10

-100

0

f [GHz]

 

2

4

6

8

10

f [GHz]

Fig. 30 - FFT of the wake function over 30 cm (solid). B. B. resonator impedance (dashed)

 
The parameters of the Broad-Band resonator can be found by measurements, for exam-
ple, by measuring bunch lengthening in an accelerator. At  the  project  stage  these  three  pa-
rameters can be evaluated by comparing the loss factor dependence on the bunch length  K  or
wake potentials along the bunch  Wz (τ), calculated numerically, with those corresponding to
the broad-band resonator.

- 60 -

For  the example in Fig. 30 we got Q  =  1, R =  138Ω and fr =  2.2  GHz.  However,  the
broad-band resonator model  has  some  disadvantages  which  can  become  important  for  the
extremely short or very long bunches.

Asymptotic frequency dependence of the broad-band resonator impedance is  ω−2, while
analytical study shows that the real part of the impedance decreases with frequency as  ω−1/2
for a cavity with attached tubes and as  ω−3/2for an array of periodic cavities. This  leads  to
incorrect energy loss estimate in the model, especially for very short bunches when the main
contribution to the total energy loss  is given  by  the  high-frequency  tail  of  the  longitudinal
impedance.
 
For very long bunches, according to the broad band resonator model, the loss  factor de-
creases with the third power of the bunch length, while numerical calculations with the time
domain codes shows that the loss  factor of realistic vacuum chamber elements  drops  much
faster, in an exponential fashion, with increasing σ for long bunches with Gaussian distribu-
tion.

8.2 Hofmann-Zotter impedance model

Two pairs  of  the  broad  band  impedance  models  were  proposed  by  A.  Hofmann  and
B. Zotter [52] to overcome the limitations of the broad band resonator model in the high fre-
quency  and  low  frequency  regions.  Both  can  be  adjusted  to  have  either  ω-1/2  or  ω-3/2
asymptotic behaviour of the real part of the impedance at high  frequencies.  In  the  low  fre-
quency region, for the first pair of the impedance models the real part increases as ω2 and, for
the special choice of the model parameters, as ω4 providing faster decrease of the loss  factor
with  bunch  length  (σ-5)  than  in  the  broad-band  resonator  model.  The  second  improved
impedance  model  yields  even  more  faster  decrease  of  the  loss  factor  with  bunch  length,
having an exponential character for very long bunches.

8.2.1 The first improved impedance model

The expression for the impedance model 1a) is:

Z x( ) = R





1
u

2
u + 1

−

α2
x 2 + α2


 + jR






1
u

2
u − 1

+

α2
x 2 + α2

− 2
x





where:

ω
ω
1

,

x =
  

u = x2 + 1, α =

ω
2
ω
1

(218)

(219)

- 61 -

The frequencies ω

 
2 and the shunt impedance R are to be chosen to fit the impedance
of  a  particular  structure.  For  very  high  frequencies,  the  asymptotic  behaviour  of  the
impedance is given by:

1, ω

Zr x( ) ~ x
  

−3/2,

Zi x( ) ~

2 − α
x

At low frequencies:

Zr x( ) ~
  




1
α2

− 5
8


 x2,

Zi x( ) ~




1
α

− 3
4

 


 x

For a special choice α = √8/5 the real part of the impedance increases as ω4 providing a
fast  decrease  of  the  loss  factor  with  bunch  length  ~  σ-5.  In  order  to  provide  the  high
frequency asymptotic behaviour ω-1/2 a different model was proposed:

 

Z x( ) = R






u2 + 1
u 2

−

α2
x 2 + α2

− jR





u − 1
u 2

−

αx
x 2 + α2










with:

ω
1
ω

,

x =
  

u = x2 + 1, α =

  

ω
2
ω
1

At low frequencies the impedance has the following behaviour:

Zr x( ) ~
  




1
α2

− 3
8


 x2,

Zi x( ) ~




1
α

− 1
2

 


 x

8.2.2 The second improved impedance model

While the first impedance model describes well high frequency behaviour, it still can not
supply  an  exponential  fall-off  of  the  loss  factor  with  bunch  length  for  long  Gaussian
bunches. In order to obtain this the real part of the impedance should vanish completely be-
low a certain "cut-off" frequency (as it is for a realistic structure where the impedance is zero
below the lowest mode). The second model impedances are chosen to satisfy this condition.
 

The 2a) real model impedance is given by the expression:

(220)

(221)

(222)

(223)

(224)

(225)

Zr x( ) = R

x − 1
x2

;

x > 1

Zr x( ) = 0;
  

x < 1

- 62 -

It has a maximum at x = ω/ω1 = 4/3 and becomes proportional to ω-3/2 at high frequen-

   
cies. The Hilbert transform gives the impedance imaginary part:

          

 

   A similar impedance model (2b) has an asymptotic decrease of the real part proportional
to the inverse square root of frequency at high frequencies. The real part is given by:

Zi x( ) = R
x2

Zi x( ) = R
x2
  

 

[

[

1 + x − 1 − x − x

x < 1

];

1 + x − x

];

x > 1

Zr x( ) = R

x − 1
x

;

Zr x( ) = 0;
  

x < 1

x > 1

   

Zi x( ) = R
x

Zi x( ) = R
x
  

[

[

2 − 1 + x − 1 − x

x < 1

];

2 − 1 + x

];

x > 1

(226)

(227)       

(228)

   
which has a maximum at x=2. The expression for the imaginary part is:

The  loss  factor  for  both  models,  2a  and  2b,  can  be  easily  obtained  by  numerical
 
integration. It drops  exponentially with bunch length for the two models for long  Gaussian
bunches.

8.3  Heifets-Bane impedance model

Recently, a new broad-band impedance model was proposed by S.  Heifets  [53]  as  the
further development of K. Bane's approach used in his analysis of the impedance of the SLC
damping ring [54,55]. The longitudinal impedance is described  phenomenologically  by  ex-
pansion over √ω :

(
) = jωL + R + 1 + jsign ω(
)

)
) ω B + 1 − jsign ω(

ω

˜Zc

+...
 

(229)

Z ω(
  

- 63 -

0

-0.2

-0.4

-0.6

-0.8

This model has been applied to estimate the broad-band impedance for SLAC B-factory
and  for  the  DAΦNE  main  rings  (Φ-factory)  [56].  Such  an  impedance  model  has  two
attractive features:
- First, the different terms of the expansion have a  clear  physical  interpretation,  describing

correctly particular impedance-generating elements.

- Second,  expressions  for  wake-fields  and  loss  factors  can  be  easily  found  analytically,

simplifying the fitting procedure to extract the model parameters.

 
The first term of the expansion represents  a  low  frequency  inductive  impedance.  This
impedance is typical for tapers, shielded bellows and vacuum ports, small discontinuities  as
slots, shallow cavities in flanges, shallow collimators and so  on.  Often,  these  elements  give
the main contribution to the impedance,  leading  to  the  excess  bunch  lengthening  as  in  the
case of SLC damping rings. For the small discontinuities the impedance remains inductive up
to rather high frequencies.
 

The wake function for a Gaussian bunch corresponding to the inductive term is given by:

 

It has a minimum (maximum) at τ = -στ(+στ):

 

Wz

τ( ) = −

Lτ
2πστ



3 exp − 1



2





τ
στ





2






 

Wmax

= −Wmin

=

L
2
2πeστ

(230)

(231)

The plot of -Wz(τ)/|Wz|max which is suitable to compare with TBCI [57] or ABCI [25]
code results for azimuthally symmetric structures or MAFIA [58] for 3D structures is shown
in Fig. 31.

-Wz/|Wz|max

-Wz/|Wz|max

0.5

1

0

-0.5

-1

-3

-2

-1

0

1

τ / στ
2

3

-1

-3

-2

-1

0

1

2

3

τ / στ

Fig. 31 - Normalized inductive wake functions: inductive and resistive

 
Eq. (231) allows to extract straightforward the inductance L from numerical results. The
loss  factor for the inductive impedance is zero. An example  of  a  shallow  cavity  and  corre-
sponding wake are shown in Fig. 32.

0

0

0.02

0.04

0.06

0.0

0.1

0.2

0.3

0.4

0.5

z [m]

-1

  Fig. 32 - Shallow cavity and wake function for cστ = 5 cm

 

The wake-field for the resistive term Z(ω) = R is:

wake function

s [m]

τ( ) = −

Wz

R
2πστ



exp − 1

2






τ
στ





2






(232)

The ratio -Wz(τ)/|Wz|max is shown in Fig. 33. In storage rings such a wake is expected
for  deep  cavities  for  bunches  with  length  comparable  with  the  beam  pipe  radius.  Fig.  33
reproduces an example of wake for SLC damping ring cavity [55].

-Wz/|Wz|max

charge density

- 64 -

0.5

1

0

-0.5

0.5

1

0

-0.5

-Wz/|Wz|max

charge density

wake function

r [m]

0.03

0.02

0.01

r [m]

0.18

0.135

0.09

0.045

0
-0.02

0.05

0.12

-1

0

0.19

0.2

z [m]

0.025

0.05

0.075

0.1

0.125

s [m]

Fig. 33  - Deep cavity and wake function for cστ = 1.4 cm

For good resistors the expression for the loss factor has a simple form:

K στ(

) =

R
2 πστ

(233)

- 65 -

0

-0.2

-0.4

-0.6

-0.8

The third term has the structure of the resistive wall impedance with the following wake-

function (See Fig. 34 a):

I−3/4

η(

) − I1/4

η(

) − I−1/4

η(

) ± I3/4

}e
)
η(

−η

(234)

where  η =

 and the ± sign corresponds to positive and negative "τ", respectively. Iν

are the modified Bessel functions of fractional order. Applying the loss  factor definition we
have:

Wz

τ( ) = B τ3/2
3
4στ

{

2





τ
2στ





where Γ(3/4)/2 = 0.6127....
 
attached tubes at high frequencies:

The forth term in (229) has the same dependence on ω as the impedance of a cavity with

K στ(

) =

B
3/2
πστ

)

(
Γ 3 / 4
2

(
1 − jsign ω(
)
ω

)

˜Zc

) =

Z ω(
  

The wake-function corresponding to the impedance is given by:

τ( ) =

Wz
  

˜Zc
2 στ

{

τ
στ

I−1/4

η(

) ± I1/4

}e
)
η(

−η

±sign  stands  for  positive  and  negative  "τ".  The  function  -Wz(τ)/|Wz|max  is  shown  in
Fig. 34b.

-Wz/|Wz|max

-Wz/|Wz|max

(235)

(236)

(237)

0.5

0

-0.5

-1

-3

-2

-1

0

1

-2

-1

0

1

2

3

τ / στ
2

3

-1

-3

τ / στ

Fig. 34 - Normalized wake functions corresponding to the cases:

) ωB
)
a)    1+ jsign ω(

(

          

)
b)    1− jsign ω(

˜Zc

ω

- 66 -

0.5

1

0

-0.5

Using (26) we obtain the expression for the loss factor:

K στ(

) =

B
3/2
πστ

)

(
Γ 3 / 4
2

(238)

with Γ(1/4)/2 = 1.8128...

The parameters L, R, B, Zc of the broad-band model are extracted from TBCI, ABCI or
MAFIA results by fitting the numerical  functions  W(τ)  and  K(στ)  to  above  analytical  ex-
pressions. In Fig. 35 we show an example of wake function for a cavity with attached tubes
where the high frequency behaviour is dominant.

r [m]

-Wz/|Wz|max

charge density

0.4

0.3

0.2

0.1

0
-0.05

Acknowledgments

References

0.05

0.15

0.25

0.35

0.45

0.05

0.1

0.15

0.2

wake function

z [m]

-1

0

s [m]

 Fig. 35 - Cavity with attached tubes and wake function for cστ = 2 cm

We wish to thank M. Serio for some enlightening comments and suggestions.

  [1] "Computer  Codes  for  Particle  Accelerator  Design  and  Analysis:  A  compendium",    LA-

UR-90-1766  (1990).

  [2] L.  Palumbo,  V.G.  Vaccaro,  "Wake  Fields  Measurements",  1988-Joint  US-CERN  Accel-
erator  School,  Lecture  Notes  in  Physics,  Springer  Verlag  Vol.  343,  M.  Month  and
S. Turner  Eds.  (1989).

  [3] P.B. Wilson, SLAC PUB 2884 (1982).
  [4] A.W. Chao, SLAC PUB-2946 (1982).
  [5] K. Bane, T. Weiland, P. Wilson SLAC PUB 3528 (1984).
  [6] T. Weiland, "On the Computation of Resonant  Modes  in  Cylindrical  Symmetric  Cavities,"

Nuclear  Instrument  and  Methods  Vol.  216,  329-349,  (1983).

  [7] T. Weiland, R. Wanzemberg, "Wake Fields and Impedances", DESY M-91-06, (1991).
  [8] V.G. Vaccaro, CERN ISR-RF/66-35 (1966).

- 67 -

  [9] W.K.H. Panofsky,  W.A.  Wenzel,  "Transverse  Deflection  of  Charged  particles  in  Radio-

Frequency Fields", Rev. Sci. Instrument, Vol 27 (1956).

[10] L.  Palumbo,  V.G.  Vaccaro  "Wake  Fields,  Impedance  and  Green's  Function",  CAS

Advanced  School,  Oxford  1986,  CERN  87-03  (1987).

[11] T.  Weiland,  "Transverse  Beam  Cavity  Interaction",  Nuclear  Instruments  and  Methods,

Vol. 212,  13  (1983).

[12] J.D. Jackson, "Classical Electrodynamics", Wiley NY (1975).
[13] L. Palumbo, V.G. Vaccaro,  G.  Wustefeld, "Coupling  Impedance  in  Circular  Accelerators,

Circular Beam, elliptic chamber", IEEE Trans, NS-31 (1984).

[14] P.L. Morton, V.K. Neil, A.M. Sessler, JAP 37, 3875 (1966).
[15] L.  Palumbo,  V.G.  Vaccaro,  "Coupling  Impedance  between  Circular  Beam  and  a  Lossy

Vacuum chamber in particle Accelerators", Il Nuovo Cimento Vol. 89 (1985).

[16] R.L. Gluckstern, J. van Zeijts, B.  Zotter,  "Coupling  Impedance  of  Beam  Pipes  of  General

Cross Section", CERN SL/AP 92-25  (1992).

[17] K.  Yokoya,  "Resistive Wall Impedance  of  Beam  Pipes  of  General  Cross  Section",  KEK

preprints  93-196  (1993).

[18] S.A.  Heifets, S.  A.  Kheifets, "Coupling  Impedances  in  Modern  Accelerators  "Review  of

Modern Physics, Vol. 63, No. 3 (1991).

[19] E.  Gianfelice,  G.  Dôme,  L.  Palumbo,  V.G.  Vaccaro,  L.  Verolino,  "A  canonical  Problem
for  the  Understanding  of  Energy  Diffraction  Losses  in  High  Energy  Accelerators",  Il
Nuovo  Cimento  Vol.  104  A  (1991).

[20] G. Dôme, L. Palumbo, V.G. Vaccaro, L. Verolino, "Longitudinal Impedance of a  Circular

Iris", Il Nuovo Cimento, Vol. A (1991).

[21] V.E.  Bakalin,  A.V.  Novokhatsky,  Proceedings  of  12th  Int.  Conf.  on  High  Energy

Accelerators, Batavia, Illinois, F.T. Cole and R. Donaldson Eds.(1983).

[22] S.A.  Kheifets  and  S.A.  Heifets,  "Radiation  of  a  Charge  in  a  Perfectly  Conducting

Cylndrical Pipe with a Jump in its Cross section", SLAC-PUB-3965 (1986).

[23] L.  Palumbo,  "Analytical  Calculation  of  the  Impedance  of  a  Discontinuity",  Particle

Accelerators  Vol.  25  (1990).

[24] E.  Gianfelice,  L.  Palumbo,  "Dipole  Impedance  of  a  Conducting  Cylindrical  Pipe  with  a

Discontinuous Cross Section", IEEE Trans, NS, Vol. 37 (1990).

[25] Y.H. Chin, "User Guide for New ABCI", LBL 33091, CERN SL/92-49 (AP) (1992).
[26] S.A. Heifets, "Diffractive Model of High Frequency Impedance", Phy. Rev. D40 (1989).
[27] J. D. Lawson, "Radiation from  a  Ring  Charge  Passing  Through  a  Resonator",  Rutherford

High  Energy  Laboratory  Report  RHEL/M144  (1968).

[28] G.D. Dôme, "Wake Potential  of  Relativistic Point  Charge  Crossing  a  Beam  Pipe  Gap:  An

Analytic Approach", IEEE Trans. Nucl. Sci. NS-23 (1985).

[29] K. Bane, M. Sands, "Wake-fields of Very Short Bunches in  an  Acceleating  Cavity", SLAC

[30] R. Palmer, "A Qualitative Study of Wakefields for Very Short Bunches", SLAC  PUB 4433

[31] V.  Balakin  and  A.  Novokhatsky,  Proceedings  of  the  13th  Conference  on  HEA,

PUB-4441  (1987).

(1987).

Novosibirsk  (1986).

[32] R.L.  Gluckstern,  "Longitudinal  Impedance  of  a  Periodic  Structure  at  High  Frequency",

University of Maryland (1988), also Phys. Rev. D39 (1989).

[33] S.A. Heifets and S.A. Kheifets, "High frequency Limit of  the  Longitudinal  Impedance  of

an Array of Cavities", SLAC PUB-4625, 1988 and Phys. Rev. D39 (1989).

- 68 -

[34] G.  Dome,  L.  Palumbo,  V.G.  Vaccaro,  L.  Verolino,  "A  Method  for  Computing  the
Longitudinal  Coupling  Impedance  of  Circular  Apertures  in  a  Periodic  Array  of  Infinite
Planes", Particle Accelerators, Vol. 36 (1991).

[35] G.  Dome,  L.  Palumbo  et  al.  "The  Frequency  Behaviour  of  the  Longitudinal  Coupling
Impedance of a Periodic Array of Diaphragms", EPAC Conference, Berlin (1992).
[36] S.S.  Kurennoy,  G.  V.  Stupakov,  "A  New  Method  for  Calculation  of  Low-Frequency

Coupling  Impedance",  SSC-preprint-332  (1993).
[37] Ng K.-Y., Preprint FNAL FN-389, Batavia (1983).
[38] Shafer R. E., "On the Coupling Impedance  of  Position  Monitor  Electrodes",  IEEE  Trans.

on Nuclear Science, Vol. NS-32 (1985).

[39] K.-Y. Ng, "Impedances of Stripline Beam-Position Monitors",  Particle  Accelerators,  1988,

Vol.  23,  pp.  93-102.

[40] M. Serio, private communications.
[41] K.-Y.  Ng,  "Longitudinal  Instabilities  and  Stability  Criteria",  In  AIP  Conference

Proceedings 184 - NY, (1989).

[42] Bethe H. A., Phys. Rev., V. 66, p. 163-182, (1944).
[43] S. Kurennoy, "Coupling Impedance of Pumping Holes", Particle Accelerators,  V.39,  No.1

(1992).

(1993).

(1979).

[44] R.L.  Gluckstern,  "Coupling  Impedance  of  a  Single  Hole  in  a  Thick  Wall  Beam

Pipe",CERN SL/92-05 (AP) (1992).

[45] S.  Kurennoy,  "Beam  Coupling  Impedance  of  Holes  in  Vacuum  Chamber  Wall",  IHEP

Preprint 92-84, Protvino, 1992 (in Russian).

[46] S.  Kurennoy,  "Pumping  Slots:  Coupling  Impedance  Calculations  and  Estimates",  SSCL-

Preprint-636  (1993).

[47] S.  Heifets,  "Broadband  Impedances  of  Accelerating  Structures:  Perturbation  Theory",

Particle Accelerators, V. 42, No. 3-4 (1993).

[48] S.  Kurennoy,  "On  Coupling  Impedance  of  Pumping  Holes",  SSCL-Preprint-312,  April

[49] R.L.  Gluckstern,  "Coupling  Impedance  of  Many  Holes  in  a  Liner  within  a  Beam  Pipe",

CERN SL/92-06  (AP)  (1992).

[50] M. Sands, "Energy Loss from Small Holes in the Vacuum Chamber", PEP-253 (1977).
[51] A. Hofman, J. Maidment, "Current Dependent Phenomena in  LEP", CERN LEP  note  169

[52] A. Hofman,  B.  Zotter,  "Improved  Impedance  Models  for  High  Energy  Accelerators  and

Storage Rings", CERN-LEP/TM-88-51 (1988).

[53] S. Heifets, "Broad Band Impedance of the B-Factory", SLAC/AP-93 (1992).
[54] K.  Bane, "The  Calculated  Longitudinal  Impedance  of  the  SLC  Damping  Ring",  SLAC-

PUB-4618  (1988).

[55] K. Bane, "Bunch lengthening in The SLC Damping Rings", SLAC-PUB-5177 (1990).
[56] S.  Bartalucci  et  al., "Broad  Band  Model  Impedance  for  DAΦNE  Main  Rings",  Nuclear

Instruments and Methods in Nuclear Research, A337 (1994).

[57] T. Weiland, Part. Accel. 15, 245, 292 (1984)
[58] R. Klatt, T. Weiland, SLAC Report 303 (1986).

- 69 -

INDEX

Abstract ………………………………………………………………………

1.

INTRODUCTION ……………………………………………………………

2. LONGITUDINAL WAKE FUNCTION AND LOSS FACTOR ………

Longitudinal wake function and loss factor of a point charge ……………

Beam loading theorem for a point charge ………………………………

Longitudinal wake function and loss factor of a bunch …………………

Loss factor and Poynting vector …………………………………………

Synchronous fields ………………………………………………………

2.6

2.7

Expansion of the longitudinal wake in cylindrical symmetry ……………
Radial expansion of the wake function in the limit  γ → ∞ ………………
2.8 Wake function in accelerator rings ………………………………………

3 LONGITUDINAL COUPLING IMPEDANCE …………………………

Definitions and properties ………………………………………………

Bunch losses and wake function from the impedance ……………………

3.3 Multipolar longitudinal impedance in cylindrical symmetry……………… 20

4 TRANSVERSE WAKE FUNCTION ………………………………………

20

Transverse wake function and loss factor of a point charge……………… 20

Transverse wake function of a bunch ……………………………………

Relationship between longitudinal and transverse wake functions ………

4.4 Mode expansion in cylindrical symmetry………………………………… 24

2.1

2.2

2.3

2.4

2.5

3.1

3.2

4.1

4.2

4.3

page

1

1

2

2

5

9

11

12

14

15

16

17

17

19

22

22

- 70 -

5 TRANSVERSE COUPLING IMPEDANCE ………………………………

24

Definitions and properties………………………………………………… 24

Relationship between longitudinal and transverse impedances…………… 25

6 UNIFORM BOUNDARIES …………………………………………………

General properties ………………………………………………………

Relativistic charge in the free space ………………………………………

Cylindrical pipe with perfectly conducting walls …………………………

Elliptic pipe with perfectly conducting walls ……………………………

Pipe with lossy walls ……………………………………………………

7 NON UNIFORM BOUNDARIES …………………………………………

General properties ………………………………………………………

Step transition ……………………………………………………………

Taper ……………………………………………………………………

Single cell cavity …………………………………………………………

Periodic r.f. structures……………………………………………………

Small discontinuities……………………………………………………… 49

Element of beam diagnostics ……………………………………………

Holes and slots in the vacuum chamber …………………………………

5.1

5.2

6.1

6.2

6.3

6.4

6.5

7.1

7.2

7.3

7.4

7.5

7.6

7.7

7.8

8 BROAD BAND IMPEDANCE MODELS …………………………………

8.1
8.2
8.3

Broad Band resonator model ……………………………………………
Hofman-Zotter model ……………………………………………………
Heifets-Bane model ……………………………………………………

Acknowledgments ……………………………………………………………

66

References ……………………………………………………………………

66

page

25

25

26

28

32

33

37

37

39

42

43

49

52

55

57

58
60
62

