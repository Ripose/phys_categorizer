 

 

 

 

 

 

FERMILAB-TM-2270-AD 

Booster High-level RF Frequency Tracking Improvement  

Via the Bias-Curve Optimization 

Xi Yang 

Fermi National Accelerator Laboratory 

Box 500, Batavia IL 60510 

Abstract 

It  is  important  to  improve  the  frequency  tracking  between  the  RF  drive  and  the  cavity 

field  for  the  purpose  of  reducing  longitudinal  phase  oscillations  and  increasing  the 

effective accelerating voltage.  And this is especially beneficial for Booster running at 

higher intensity with smaller beam emittance.  Optimizing the bias supply current curve 

for the ferrite tuners can reduce the phase error between the RF drive and the cavity field, 

and also improve the HLRF-to-LLRF frequency tracking efficiency. 

Introduction 
The Booster accelerates protons (H+) from 400 MeV to 8 GeV after the H− beam injected 

from the Linac is stripped to protons.  The RF frequency changes from 37.9 MHz to 52.9 

MHz to accelerate the beam in a Booster cycle.  Each Booster RF cavity contains three 

ferrite  tuners  (FT),  which  are  connected  to  the  accelerating  cavity  and  are  part  of  the 

resonating structure.[1]  The cavity resonant frequency is adjusted by changing the bias 

supply current for the purpose of varying the inductance of FT.   

The  relationship  between  the  bias  current  and  the  cavity  resonant  frequency  has 

been measured and applied as the bias curve (BC) for a Booster cycle.  However, there 

are some factors, such as the hysteresis of the ferrite, Booster rep rate, temperature, and 

beam loading, etc., which could change the relationship between the bias current and the 

cavity  resonance  frequency  and  make  the  required  bias  current  for  a  cavity  resonance 

 

1

frequency different from the measurement.  Also, since for a required rate of acceleration, 

the low-level RF system (LLRF) is continuously adjusting the RF drive to the cavity field 

to  maintain  the  correct  phase  relation  between  circulating  beam  bunches  and  the 

accelerating  gap  voltage,  the  cavity  resonance  frequency  varies  slightly  from  cycle  to 

cycle.[2]  Since the required cavity resonance frequency couldn’t be controlled only by a 

predetermined BC, a feedback loop (bias running closed loop) had been installed for each 

Booster  RF  station  to  minimize  the  phase  error  between  the  RF  drive  and  the  cavity 

field.[3]   

With the continuously increased requirement for Booster to deliver protons with 

higher  intensity  and  smaller  emittance,  it  is  important  for  us  to  improve  the  frequency 

tracking  between  the  RF  drive  and  the  cavity  field  for  the  purpose  of  reducing  phase 

oscillations longitudinally and increasing the effective accelerating voltage.  Besides, the 

feedback loop only can correct the phase error between the RF drive and the cavity field 

after the error appears.  Also, the correction time is limited by the time constant of the 

bias-tuning system and is about half a millisecond.  A procedure, which can be used to 

generate the optimal BC based upon the phase error signal from the pre-Booster cycle and 

the  cavity  Q  factor,  has  been  developed  to  improve  the  HLRF-to-LLRF  frequency 

tracking.   

 

Method 

The bias supply current for each RF station is the sum of three inputs, the BC signal, the 

phase  error  signal  and  the  DAC  signal.    The  DAC  signal  provides  an  offset  to  the  bias 

supply current in the beginning of a cycle and varies from station to station.  Here, we set 

it  to  zero.    The  BC  signal  is  obtained  from  Booster  console  program  B30  with  a 

calibration  constant  of  250  A/V,  as  shown  in  Fig.  1(a).    The  phase  error  signal  is 

generated by the analog device AD532 whose transfer function is [4] 

(
(

tX
)(
1

−

tX
2

)
)(

⋅

(
tY
)(
1

−

tY
(
2

I pes

t
)(

=

))
10

.

                                                                           1 

Here, t is the time in a Booster cycle, Ipes(t) is the phase error signal, and X1(t) is the phase 

error from the phase detector.  The phase detector is continuously comparing the phase 

difference between the cavity field and the RF drive and outputting it as the phase error in 

 

2

unit of volt with a calibration constant of 1 V/9°.  Y1(t) is the BC signal in unit of ampere, 

X2(t) and Y2(t) are zero due to the grounding.   

The phase error taken at a MiniBooNE event ($1D) from station #16 is shown in 

Fig. 1(b).  The phase error signal (PES), which is the product of Fig. 1(a) and Fig. 1(b) 

and then divided by 10, is shown in Fig. 1(c).  The total bias supply current, which is the 

sum of Fig. 1(a) and Fig. 1(c), is shown in Fig. 1(d).  It is important for us to notice that 

when station #16 was running at the bias current curve shown in Fig. 1(d) the PES still 

appeared as the curve shown in Fig. 1(c).   

The  frequency  difference  (∆f)  between  the  cavity  field  and  the  RF  drive  can  be 

calculated using the parallel-RLC circuit model,[5] as shown in eq.2, once the phase error 

from the phase detector is known.   

1
)
(
ω

Z

=

+

1
R
s

1
Lj
ω

+

Cj
ω

,
          

          

          

st
          
1

22
RL
s
)
2
2
ω
)
2

−

+

ω
2
ω

Re

(
Z

)
(
ω

)

=

2

2

)

−

=

Z

R
s

)
(
ω

(
Im

LR
s
2
ω

(
1
j
ω
(
2
R
1
−
s
(
Z
Im
(
Z
Re
,
          
∆+=
ωωω
0

LC
(
1
LC
)
)
          

(
)
ω
)
(
ω

))
(
ωφ

tan(

∆

=

=

+

ω

LC

22
L
)
22
L

ω
(
2
1
−
ω
L
ω

jR
s

,
          

          

2     

nd

,
          

          

3     

nd

LC

)

,
          

4     

th

          

          

          

          

5  

th

f
=∆

f

0

−

f

d

=

−≈

tan(

∆

(
))
ωφ

(

∆
ω
2
π

)

⋅





ω
0
Q
4
⋅
π

0



,
       
6


th

∆

(
)
ωφ

=

(
V

pes

)

⋅

9

⋅

πω
=
⋅

2

0

f

0

=

1

π
180

LC

,
          

          

          

          

7     

.
          

          

          

          

      
8

th

th

                                                      2 

Here, Z(ω) is the impedance of the parallel-RLC circuit at the angular frequency ω=2πf, 

Rs  is  the  shunt  impedance,  L  is  the  inductance,  C  is  the  capacitance,  f0  is  the  cavity 

resonance frequency, Q0 is the cavity quality factor at the resonance frequency, fd is the 

RF drive frequency, Vpes is the phase error between the cavity field and the RF drive in 

unit  of  volt,  and  ∆φ(ω)  is  the  phase  angle  of  Z(ω)  in  unit  of  radian.    Small  angle 

 

3

approximation and Taylor expansion of ω=ω0+∆ω to the 1st order of ∆ω are used in the 
calculation of ∆f from ∆φ(ω), Q0, and ω0, as shown in the 6th equation in eq.2.   

The cavity Q vs. time t in a Booster cycle is shown in Fig. 2(a).[2]  The RF drive 

frequency  (fd)  for  each  Booster  cycle  is  calculated  from  the  magnet  ramp,[6]  and  is 

shown  in  Fig.  2(b).    From  the  past  experience,  the  difference  between  the  HLRF 

frequency and the LLRF drive frequency couldn’t be bigger than half percent; otherwise 
part of the beam will fall off.  We can use 2πfd as ω0 in the 6th equation of eq.2 and get 

the  frequency  error  ∆f  for  the  $1D  event,  as  shown  in  Fig.  2(c).    The  cavity  resonance 

frequency is obtained using fd + ∆f (the sum of Fig. 2(b) and Fig. 2(c)), and the total bias 

current  vs.  the  cavity  resonance  frequency  is  shown  in  Fig.  2(d).    The  relationship 

between  the  bias  current  (I)  and  the  cavity  resonance  frequency  is  obtained  by  the 

exponential fit of the curve in Fig. 2(d), as shown in eq.3(a). 

I bc
(

f

)

a
⋅=

exp(

fb
⋅

)

=

.0

7768

⋅

exp(

.0

1505

⋅

f

).

                                                            3(a) 

Here, the unit of f is MHz.  We obtain eq.3(b) by differentiating eq.3(a). 

∆

Ibc

(

f

)

⋅=

ba

⋅

exp(

fb
⋅

)

f
≈∆⋅

.0

1169

⋅

exp(

.0

1505

⋅

f

)

f
∆⋅

                                          3(b) 

The  amount  of  bias  current,  which  should  be  adjusted  in  order  to  eliminate  the  phase 

error,  should  be  −∆Ibc,  and  the  result  is  shown  in  Fig.  2(e).    The  optimal  bias  current 

should  be  the  sum  between  the  total  bias  current  and  −∆Ibc,  as  shown  in  Fig.  2(f).  

However, ∆Ibc is less than 0.3% of the total bias current, and this can be understood by 

the calculation shown in eq.4, which is obtained through dividing eq.3(b) by eq.3(a). 

I
∆
I

(
bc
f
(

f
)
)

bc

f
f
∆⋅≤∆⋅=

b

b

≈

23.0

%.

                                                                                 4 

max

 

Comment 

The difference between the bias curve shown in Fig. 1(d) and the one shown in Fig. 2(f) 

is less than 0.3%, and more efforts are required for the optimal bias current curve in Fig. 

2(f) than those for the total bias current curve in Fig. 1(d).  Also some other fluctuations 

in Booster from cycle to cycle can be comparable or larger than 0.3%.  So it is helpful for 

us to modify the control system of the bias supply current and use the total bias current 

curve,  which  is  obtained  from  the  pre-Booster  cycle,  as  the  bias  current  curve  for  the 

 

4

present cycle and keep on updating the bias current curve frequently, at least from day to 

day.  Whenever it is possible, tuning the bias current curve to minimize the average phase 

error signal from all the stations will be helpful.  And the reason why we use the average 

phase error signal for tuning is because all the stations are running the same BC.  Using a 

separated  bias  current  curve  for  each  RF  station  can  remove  the  phase  error  from  the 

station-to-station difference and improve the HLRF-to-LLRF frequency tracking further.   

 

Acknowledgements 

The author gives thanks for the tremendous amount of help from the HLRF group in Fermilab,  

especially  to  Rene  Padilla,  John  Reid,  Tim  Berenc  and  Bob  Scala,  who  provided  the 

author with the technical information and guidance for this work. 

References: 

[1] E. L. Hubbard, Editor, “Booster Synchrotron”, FERMILAB-TM-405. 

[2]  K.  C.  Harkay,  “A  Study  of  Longitudinal  Instabilities  and  Emittance  Growth  in  the 

Fermilab Booster Synchrotron”, Ph.D thesis, Purdue University, 1993. 

[3] “Low Level RF Talk”, www-ad.fnal.gov/Proton/NewBoosterWWW/Booster.htm. 

[4] www.analog.com. 
[5] D. M. Pozar, Microwave Engineering, John Wiley & Sons, 2nd Edition, 1998. 
[6]  X.  Yang,  “Energy  Loss  Estimates  at  Several  Beam  Intensities  in  the  Fermilab 
Booster”, FERMILAB-TM-2244. 

 

 

 

 

 

 

5

2400

2200

2000

1800

1600

1400

1200

1000

800

600

400

200

)

A

(
 
l
a
n
g
S
C
B

 

i

)

V

(
 
r
o
r
r

E
 
e
s
a
h
P

2.0

1.5

1.0

0.5

0.0

-0.5

-1.0

-1.5

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 1(a)

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 1(b)

 

 

 

6

150

100

50

0

-50

-100

-150

-200

2500

2000

1500

1000

500

0

)

A

(
 
l
a
n
g
S

i

 
r
o
r
r

E
 
e
s
a
h
P

)

A

(
 
t
n
e
r
r
u
C
 
s
a
B

i

 
l
a
t
o
T

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 1(c)

 

 

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 1(d)

Fig. 1(a) the bias curve obtained from Booster console program B30 with a calibration of 

Fig. 1(b) the phase error taken at a MiniBooNE event ($1D) from station #16. 

Fig. 1(c) the phase error signal, which is the product of Fig. 1(a) and Fig. 1(b) and then 

250 A/V. 

divided by 10. 

Fig. 1(d) the total bias supply current, which is the sum of Fig. 1(a) and Fig. 1(c). 

 

7

1400

1200

1000

800

600

400

200

 

r
o
t
c
a
F
Q
 
y
t
i
v
a
C

54

52

50

48

46

44

42

40

38

36

)
z
H
M

(
 
y
c
n
e
u
q
e
r
F
 
e
v
i
r

D

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster cycle (ms)
Fig. 2(a)

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 2(b)

 

 

 

8

0.010

0.005

0.000

)
z
H
M

(
 
f
∆

-0.005

-0.010

-0.015

-0.020

2500

2000

1500

1000

500

0

)

A

(
 
t
n
e
r
r
u
C
 
s
a
B

i

 
l
a
t
o
T

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 2(c)

38

40

42

44

46

48

50

52

54

Cavity Resonance Frequency (MHz)
Fig. 2(d)

 

 

 

 

9

 

0.8

0.6

0.4

0.2

0.0

-0.2

-0.4

-0.6

-0.8

-1.0

)

A

(
 

I

c
b
∆
-

2500

2000

1500

1000

500

0

)

A

(
 
t
n
e
r
r
u
C
 
s
a
B

i

 
l
a
m

i
t
p
O

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 2(e)

 

 

2

4

6

8 10 12 14 16 18 20 22 24 26 28 30 32 34

Time in a Booster Cycle (ms)
Fig. 2(f)

Fig. 2(a) the cavity Q vs. time t in a Booster cycle. 

Fig. 2(b) the RF drive frequency (fd) for a Booster cycle. 

Fig. 2(c) the frequency error (∆f) of station #16 for the $1D event shown in Fig. 1(b). 

Fig. 2(d) the total bias current vs. the cavity resonance frequency. 

Fig. 2(e) the amount of bias current, which should be adjusted in order to eliminate the 

phase error shown in Fig. 1(b). 

Fig. 2(f) the optimal bias current. 

 

10

