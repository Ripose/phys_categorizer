PPPL–2222 (June 1985)
Phys. Fluids 29(1), 180–192 (Jan. 1986)

Current in Wave Driven Plasmas

Charles F. F. Karney and Nathaniel J. Fisch
Plasma Physics Laboratory, Princeton University
Princeton, NJ 08544

Abstract

A theory for the generation of current in a toroidal plasma by radio-frequency waves is presented.
The effect of an opposing electric ﬁeld is included, allowing the case of time varying currents to be
studied. The key quantities that characterize this regime are identiﬁed and numerically calculated. Circuit
equations suitable for use in ray-tracing and transport codes are given.

5
0
0
2
 
n
a
J
 
2
1
 
 
]
h
p
-
m
s
a
l
p
.
s
c
i
s
y
h
p
[
 
 
1
v
9
5
0
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

I.

INTRODUCTION

In recent years there has been considerable interest in generating steady-state currents in a plasma
with rf waves. In particular, it was predicted1 that these currents could be efﬁciently generated by waves
whose phase velocities are several times the electron thermal speed. This prediction has been conﬁrmed
by numerous experiments in which the current was driven by lower-hybrid waves. These results allow
us to contemplate a steady-state tokamak reactor in which the toroidal current is driven by lower-hybrid
waves. This is an attractive proposition not only because of the advantages inherent in steady-state
operation (less thermal stress, higher duty cycle, etc.), but also because it opens up the possibility that
the ohmic winding of the tokamak can be eliminated entirely, leading to a cheaper and more compact
reactor. This latter possibility can be realized if rf waves are successful not only in sustaining the plasma
current “steady-state current drive,” but also in increasing the plasma current “rf current ramp-up.” In fact,
experiments have demonstrated that this too is possible. From a theoretical point of view, the important
additional ingredient in these experiments is the dc electric ﬁeld which opposes the increase of the plasma
current. The electric ﬁeld is also present in schemes where the rf is used to recharge the transformer at
constant current.

Recently, we presented a theory for rf current drive in the presence of an electric ﬁeld.2 This theory
predicted that rf energy could be efﬁciently converted to poloidal ﬁeld energy if the wave phase velocity
were approximately equal to the electron runaway velocity. This theory has been compared3 with data
from the PLT experiment,4 and excellent agreement is found. In Ref. 2, the linearized Boltzmann equation
was approximately solved by integrating the corresponding Langevin equations using a Monte-Carlo
method. In this paper, we use a more elegant theory to calculate the efﬁciency of the current ramp-up
based on an adjoint formulation for the Boltzmann equation.5 Although the limits of validity of this
theory are the same as for Ref. 2, this theory is more amenable to accurate evaluation on a computer, and
it is more easily extended to include effects which are omitted here.

Let us begin by reiterating the physical picture given in Ref. 2. Consider an electron travelling in
the positive direction at several times the thermal speed and which has just absorbed an incremental
amount of rf energy. Suppose there is an electric ﬁeld tending to decelerate this electron. The question is:
Where does this incremental energy end up? If the electron is slow compared to the runaway velocity, the
electron slows down primarily due to collisions and so the rf energy goes to bulk heating. On the other
hand, if the electron is fast, the electron is slowed down by the electric ﬁeld. In this case, the rf energy
is coupled to the plasma circuit and appears as poloidal ﬁeld energy. Unfortunately, fast electrons have a
high probability of pitch-angle scattering into the reverse direction and running away. A runaway electron
drains energy out of the electric ﬁeld, leading to a degradation of the ramp-up efﬁciency. However, there
is a window around the runaway velocity where the electrons are slowed down principally by the electric
ﬁeld and yet where the probability of running away is very small. This is the favorable regime in which
rf energy can be efﬁciently converted to poloidal ﬁeld energy.

From the foregoing discussion, we see that two ingredients are needed for an accurate theoretical
treatment of this problem. First, the electric ﬁeld must be treated as large. In the efﬁcient regime, the
force on the electron due to the electric ﬁeld must be comparable to that due to collisions. Second, a
two-dimensional treatment is required. Analyses based on a one-dimensional Fokker–Planck equation
do not predict the important physical phenomenon of rf-generated reverse runaways.

We brieﬂy review the history of theoretical studies of current drive in the presence of an electric ﬁeld.
The earliest theoretical studies1 of lower-hybrid current drive assumed that there was no electric ﬁeld
in the plasma. This is the appropriate limit for a steady-state reactor. However, some of the early ex-
periments conducted to verify the predictions of the theory were conducted in regimes where the ohmic
electric ﬁeld was still present. This prompted a series of papers6–10 dealing with rf current drive in the
presence of an assisting electric ﬁeld (i.e., the electric ﬁeld and the rf both accelerate the electrons in
the same direction). The principal focus of these papers was the calculation of an enhanced runaway

2

rate when the phase velocity of the waves is in the neighborhood of the runaway velocity. An opposing
electric ﬁeld was treated by Borrass and Nocentini11 within the framework of a one-dimensional Fokker–
Planck analysis. A similar model has been employed more recently by Liu et al.12 As noted above, such
an analysis cannot include rf-generated reverse runaways. Also due to the crudity of the one-dimensional
equation, the results are only accurate to within a factor of order unity even when no runaways are gen-
erated. A two-dimensional treatment of the problem in the small electric ﬁeld limit has been given by
Start13 for the case of current drive by electron-cyclotron waves. This work neglected electron-electron
collisions. This defect was removed and the results generalized to arbitrary current-drive methods by
Fisch14 employing an adjoint formulation. This work yields accurate results when the electric ﬁeld is
small. However, the results are inapplicable in the regime of efﬁcient ramp-up where the phase velocity
is comparable to the runaway velocity. Our earlier paper2 was the ﬁrst to combine a two-dimensional
treatment with a large electric ﬁeld. This paper allowed an accurate calculation of the ramp-up efﬁciency
in cases of practical interest, and identiﬁed the regime in which high efﬁciencies can be expected. The
present work is a continuation and expansion of that earlier paper. Besides using the more sophisti-
cated method5 for solving the Boltzmann equation, we endeavor to give the results in a form that allows
both easy comparison with experiments and easy implementation within the framework of ray-tracing or
transport codes.

The paper is organized as follows: We begin with the linearized Boltzmann equation for the perturbed
electron distribution in the presence of an electric ﬁeld and an rf source (Sec. II). Some approximations
and normalizations are made to reduce this equation to a more manageable form. The use of the adjoint
method5 for solving the resulting equation is described (Sec. III). Next (Sec. IV) the adjoint equation is
solved numerically to give the runaway probability and the Green’s function for the current. The latter
quantity is reduced to a simple form which involves just two functions of velocity. An expression for
the total current density is given (Sec. V) and this is put into a form which is easy to calculate. How the
rf-driven current interacts with the electric ﬁeld to produce poloidal ﬁeld energy is considered (Sec. VI),
and the results are applied to experiments.

II. BOLTZMANN EQUATION

Consider a uniform electron-ion plasma, initially at equilibrium. For t > 0, it is subject to an electric
ﬁeld E(t) and a wave-induced ﬂux S(v, t). We will take the ions to be inﬁnitely massive, so that they
form a stationary background off which the electrons collide. If the electric ﬁeld and the wave-induced
ﬂux are weak enough, the electron distribution remains close to a Maxwellian for
is the
energy of an electron 1
2 mv2. Substituting f = fm + f1 into the Boltzmann equation for the electron
distribution f and linearizing then gives

. T where

E

E

∂
∂t

f1 +

qE(t)
m ·

∂
∂v f1 −

C(f1) =

∂
∂v ·

−

S

qE(t)

−

m ·

∂
∂v fm −

+

˙n
n

(cid:20)

3
2

E
T −

˙T
T

(cid:21)

(cid:17)

(cid:16)

fm,

(1)

where

and

fm = n

3/2

m
2πT

(cid:16)

(cid:17)

exp(

/T ),

−E

C(f ) = C(f, fm) + C(fm, f ) + C(f, fi)

is the linearized collision operator. Here q, m, n, and T are the electron charge, mass, number density,
and temperature. Note that q carries the sign of the electron charge (i.e., q =

e).

This equation is to be solved with initial condition f1(v, t = 0) = 0. We demand that the subsequent
, i.e., that it have zero density and energy. The

evolution of f1 be such that it be orthogonal to 1 and

−

E

3

zero-density condition is satisﬁed with ˙n = 0 since all the terms in Eq. (1) are particle conserving. The
zero-energy condition gives an equation for the time evolution of T

3
2

n

dT
dt

=

mS

v d3v + E

qvf1 d3v.

·

Z

·

Z

The two terms on the right-hand side represent the heating due to the waves and due to E

J.

We now make three simplifying assumptions: we assume that f1 is azimuthally symmetric about
the ambient magnetic ﬁeld; we take the electric ﬁeld to be constant and in the direction parallel to the
magnetic ﬁeld E = Eˆvk; and we restrict our attention to those cases where S is only ﬁnite where v
vt,
where v2
t = T /m is the thermal velocity. We may then solve Eq. (1) using the high-velocity form for C:

≫

·

C(f ) = Γ

1
v2

∂
∂v

f +

1 + Z
2v3

∂
∂µ

(1

−

µ2)

f

,

∂
∂µ

(cid:21)

(cid:20)
where µ = vk/v, Γ = nq4 ln Λ/4πǫ2
0m2, ǫ0 is the dielectric constant of free space, ln Λ is the Coulomb
logarithm, and Z is the effective ion charge state. We have included pitch-angle scattering and frictional
slowing down, but ignored energy diffusion. In the problem of steady-state current drive,15 the energy
diffusion term introduces corrections of order (vt/v)2. Another term neglected in this approximate col-
lision operator is the effect of the Maxwellian colliding off the perturbed distribution, C(fm, f ). The
corrections due to this term15 are of order (vt/v)3. With these approximations, the collision operator
does not depend on the electron temperature T . Formally, we may derive the form for C by taking
T

0. In this limit, we have fm →
→
It is convenient to introduce some normalizations. The runaway velocity vr is that velocity at which

nδ(v).

collisional frictional force equals the acceleration due to the electric ﬁeld

vr ≡ −

sign(qE)

mΓ/

qE
|

.
|

Notice that the sign of vr is opposite to the direction in which electrons run away. The Dreicer velocity16
is given by

√2 + Z vr. Similarly, we deﬁne a runaway collision frequency

p

−

The normalized time and velocity are given by

and

νr ≡

Γ/

3 .

vr|
|

τ = νrt

u = v/vr.

The components of v have to be normalized with care: u⊥ = v⊥/
.
vr|
|
This implies that uk/u = sign(vr)vk/v so that the conversion of the pitch-angle variable µ in v space
to that in u space involves multiplication by sign(vr). Other quantities are normalized in a similar
way; however, we shall use the same symbols as for the unnormalized quantities. Thus, the distribution
3, etc. Under this
functions f1 and fm are normalized to n/
normalization, Eq. (1) then becomes

3, the rf-induced ﬂux S to nνrvr/

, uk = vk/vr, and u = v/

vr|
|

vr|
|

vr|
|

−
with f1(u, τ = 0) = 0 and with the operator D deﬁned by

∂
∂τ

f1 + D(f1) =

∂
∂u ·

S,

(2)

D

≡ −

∂
∂uk −

1
u2

∂
∂u −

1 + Z
2u3

∂
∂µ

(1

−

µ2)

∂
∂µ

.

4

Equation (2) is singular at the origin. However, because f1 in Eq. (2) describes a physical particle
distribution, it obeys a particle conservation law near the origin. We therefore require that, close to
u = 0, f1(u) = N (τ )δ(u) with N (0) = 0 and

dN
dτ

= lim
u→0

1

−1

Z

2πf1(u, µ) dµ.

Equation (2) depends only on a single parameter Z. The dependence on the electric ﬁeld E can be
normalized away, since the electric ﬁeld deﬁnes the only natural velocity scale in the problem, vr.

Equation (2) is amenable to various methods of solution, and it is instructive to review these before
describing the method used here. The most straightforward approach is to integrate Eq. (2) directly on
a computer. This method allows S to be determined directly in terms of the electron distribution f .
However, a thorough understanding of the problem requires that many different forms of S be used.
Therefore, this procedure is costly because the several parameters used to specify S must be scanned.
This is essentially the method adopted in the early numerical studies of steady-state current drive by
lower-hybrid waves.17

The situation is improved to some extent by noting that Eq. (2) is a linear equation for f1. It may be

solved in terms of a Green’s function g given by the equation

+ D

g(u, τ ; u′) = 0

∂
∂τ

(cid:18)

(cid:19)

with g(u, τ = 0; u′) = δ(u

u′). The electron distribution is then given by the convolution

−
f1(u, τ ) =

τ

dτ

0
Z

Z

d3u′ S(u′, τ ′)

∂
∂u′ g(u, τ

·

−

τ ′; u′).

This approach reduces the problem to the determination of a single function g of two vector arguments
(u and u′) and a one scalar argument (τ ). However this is still a daunting computational task.
A closely related technique is to formulate the problem as a set of Langevin equations,18

where the pitch-angle scattering is represented by the stochastic term A(τ ). Assuming that u(τ ) = u and
µ(τ ) = µ are given (i.e., non-stochastic), then A(τ ) satisﬁes

du
dτ
dµ
dτ

=

1
u2 −

−

= A(τ )

−

µ,

1

µ2

,

−
u

A(τ )
h
i
A(τ )A(τ ′)
i

h

=

=

1 + Z
u3 µ,
(1

−
1 + Z
u3

−

µ2)δ(τ

τ ′),

−

where the angle brackets denote averaging over the ensemble deﬁned by all the realizations of A. Con-
sider following a particular electron using Eqs. (4). Suppose that the electron is observed to travel with
velocity u′ at τ = 0. Then g(u, τ ; u′) d3u is the probability that the velocity of the electron at time τ is
in the volume element d3u located at u. In Appendix A, it is shown that this conditional probability g
satisﬁes Eq. (3). Thus the solution to Eq. (3) can be found by determining the distribution of a large num-
ber of electrons obeying Eqs. (4) with initial conditions with u(τ = 0) = u′. Consequently, moments of
g can be determined by ensemble averages of the Langevin variables. For example, the current given by
Eq. (3) may be found by

d3u uµ g(u, µ, τ ; u′, µ′) =

u(τ )µ(τ )
i
h

.

Z

5

(3)

(4)

(5)

Equations (4) may be integrated numerically by noting that

τ +∆τ

A(τ ′) dτ ′

τ
Z

µ2)∆τ /u3
should be picked from an ensemble with mean
where u and µ are the values of those variables at time τ . As long as ∆τ is sufﬁciently small, further
details about the distribution of A are unimportant.

(1 + Z)µ∆τ /u3 and variance (1 + Z)(1

−

−

Now Eqs. (4) are the equations solved in our earlier paper.2 This shows the exact equivalence between
the approach adopted there and that employed in the present work. Because the Langevin equations
describe the electron behavior in a slightly more physical manner, they often help in the interpretation
of the solutions to the Boltzmann equation. This is especially true when some electrons run away. The
Langevin equations are also very easy to solve numerically by a Monte-Carlo method (as was done in
Ref. 2), although their solution tends to be much more costly than just solving Eq. (3) directly.

Equations (4) however may be easily solved analytically in the limit u

0 (this is equivalent to

taking the limit E

→
0). Taking an ensemble average of the equations, we obtain

→

du
dτ
µ
h
i
dτ

d

=

=

1
u2 ,
1 + Z
u3

−

−

.

µ
i
h

Note that u is not a stochastic variable in this limit. Consequently, the hierarchy of moment equations
may be closed at this point. These are the slowing-down equations solved by Fisch and Boozer19 to give
the current moment of electron distribution
. This shows that the approach used in that
= u
paper is equivalent to solving the Boltzmann equation.

uµ
i
h

µ
i
h

III. ADJOINT METHOD

(An exception is the limit E

The methods for solving the Boltzmann equation described in the previous section all entail a large
amount of computation.
0, when the ensemble-averaged Langevin
equations can be solved analytically.19) The problem with these methods is that they are all capable
of giving the electron distribution function f1. Since, in many cases, we are only interested in speciﬁc
moments of f1, we may hope to reduce the computational requirements substantially by using a method
that gives only those speciﬁc moments. Suppose we wish to determine a particular moment of f1, namely

→

(For instance, the current density would be given by h0(u) = uk.) Let us deﬁne the corresponding
moment of the Green’s function

H(τ ) =

d3u h0(u)f1(u, τ ).

Z

Z
The moment H is then given in terms of h by

h(u′, τ ) =

d3u h0(u)g(u, τ ; u′).

H(τ ) =

dτ ′

d3u S(u, τ ′)

τ

0

Z

Z

∂
∂u h(u, τ

·

−

τ ′).

What is needed is some method of calculating h which doesn’t involve having to ﬁnd g. This is

provided by the adjoint formulation of Fisch.5 He shows that h(u, τ ) satisﬁes

(6)

(7)

(8)

∂
∂τ

h + D∗(h) = 0,

6

with h(u, τ = 0) = h0(u) and with the operator D∗ deﬁned by

D∗

∂
∂uk

+

1
u2

∂
∂u −

1 + Z
2u3

∂
∂µ

(1

−

µ2)

∂
∂µ

.

≡

The singularity at the origin is handled by the boundary condition h(u = 0, τ ) = 0. The operators D and
D∗ are adjoint operators, so that

Z
for all f (u) and h(u) satisifying f (u

hD(f )

f D∗(h)

d3u = 0

−

(cid:0)
→ ∞

) = 0 and h(u = 0) = 0.

(cid:1)

Similar techniques were introduced earlier by Antonsen and Chu20 and by Taguchi21 for the study of
steady-state current drive. The signiﬁcant improvements afforded by Ref. 5 are the ability to determine
arbitrary moments of f1 and the inclusion of the time-dependence of f1. Both of these are important in
the problem of current ramp-up.

From the relation between the two Green’s functions h and g, we see that h has a simple interpretation.
Equations (3) and (4) describe the evolution of a group of electrons released at τ = 0 at velocity u′. Let
us suppose that we are interested in the current density so that h0(u) = uk. Then h(u′, τ ) gives the
mean current carried by those electrons a time τ later. How Eq. (8) works is easily seen by taking u
1
so that the electron only experiences the electric ﬁeld. In the Boltzmann equation, the electrons have
τ ˆuk at time τ . Correspondingly in the adjoint equation, the initial condition h0 is
slowed down to u′
transported in the reverse direction so that h(u′, τ ) = h0(u′
τ ˆuk). Thus at time τ , we are provided
with information about the electrons in their current location.

≫

−

−

Solving the Boltzmann equation by means of the adjoint formulation results in a great simpliﬁcation
of the problem. The adjoint equation (8) is an equation of equal complexity to the original Boltzmann
equation (2). However, by solving Eq. (8) for a particular initial condition, we can ﬁnd the corresponding
moment of f1 using Eq. (7) for any driving term S.

The proof that h is given by Eq. (8) is most easily carried out by assuming that Eq. (8) holds and
then by proving that h is related to the general Green’s function g by Eq. (6). Consider the equation for
g(u, τ ′; u′),

We multiply this equation by h(u, τ
between D and D∗ to give

(cid:18)

−

g(u, τ ′; u′) = 0.

∂
∂τ ′ + D
τ ′), integrate over all velocity space, and use the adjoint relation

(cid:19)

d3u h(u, τ

τ ′)

∂
∂τ ′ g(u, τ ′; u′) + g(u, τ ′; u′)D∗

−

Z

h(u, τ

τ ′)

= 0.

−

(cid:1)

(cid:0)

Substituting from Eq. (8) and integrating in τ ′ from 0 to τ , gives

d3u h(u, τ

Z

−

τ ′)g(u, τ ′; u′)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

τ

τ ′=0

= 0.

If we evaluate this expression using the initial conditions for g and h, we obtain Eq. (6).

Up until now, we have assumed that all the equations are solved in an inﬁnite velocity domain.
This is not a convenient formulation for numerical implementation where, necessarily, we wish to solve
equations in a ﬁnite domain. Here we shall only solve Eq. (8) in a spherical domain V such that u < ub.
We will choose ub to be sufﬁciently large that the interesting physics where the electric ﬁeld competes
with the collisions happens inside V . Outside V collisions may be ignored and the electrons are merely
freely accelerated by the electric ﬁeld. We must impose boundary conditions on Σ, the boundary of V .

7

Again we follow the treatment given in Ref. 5. We begin by noting that both Eq. (2) and Eq. (8) are
hyperbolic in the u direction. The boundary therefore divides into two pieces depending on whether
the characteristics enter or leave the domain. We deﬁne Σin (resp. Σout) as that portion of Σ on which
1/v2 < 0 (resp. > 0). The characteristics of Eq. (2) enter V on Σin and leave on Σout, while
−
those of Eq. (8) enter V on Σout and leave on Σin. Boundary conditions must be speciﬁed where the
characteristics enter the domain V . For ub sufﬁciently large, the solution beyond Σ may be determined
by ignoring collisions. Thus

−

µ

for u on Σin and

f1(u, τ ) = f1(u + τ ˆuk, 0) = 0

h(u, τ ) = h(u

τ ˆuk, 0) = h0(u

τ ˆuk)

−

−

for u on Σout. (If energy scattering had been included in the collision operator, the equations would
revert to parabolic, and boundary conditions would have to be speciﬁed over the whole of Σ. However,
there would be a boundary layer where the characteristics of the approximate equations are outgoing, and
the boundary conditions here would only weakly affect the solution in the interior of V .)

Although Eq. (8) was derived under the simplifying assumptions that the electric ﬁeld was constant
and the high-velocity form of collision operator is valid, the adjoint method as described in Ref. 5 applies
equally well without such restrictive assumptions. Thus, the equation adjoint to Eq. (1) reads5

∂
∂t′ −

qE(t
−
m

t′)

∂
∂v −

·

(cid:18)

C∗

h(v, t′; t) = q1 + q2E
(cid:19)

,

where C∗ is the operator adjoint to C. Since the full linearized collision operator is self-adjoint, we have
C∗(h) = C(fmh)/fm. Equation (9) is to be solved with the initial condition h(v, t′ = 0; t) = h0(v).
We restrict fmh to being orthogonal to 1 and
and q1 and q2 are chosen to ensure that this condition on
fmh remains satisiﬁed given that it is satisﬁed initially. It can then be shown5 that

E

d3v f1(v, t)h0(v) =

d3v S∗(v, t′)

∂
∂v h(v, t

·

−

t′; t),

t

dt′

0
Z

Z

Z

qE(t)/m

where S∗(v, t) = S(v, t) +
fm. This equation will enable us to incorporate the effects of a
slowly varying electric ﬁeld into our analysis. It also makes explicit the additive nature of those effects
due to the electric ﬁeld alone (i.e., with S∗ = (qE/m)fm) and those effects due to the rf combined with
the electric ﬁeld (i.e., with S∗ = S). Of course, the effects due to the electric ﬁeld alone are well studied
and give rise to phenomena such as the Spitzer–H¨arm conductivity22 and runaways.16

(cid:1)

(cid:0)

(9)

(10)

IV. SOLUTIONS TO THE ADJOINT EQUATION

Moments of the electron distribution f1 can now be calculated by solving Eq. (8) with the correspond-
ing initial and boundary conditions. In practice, this procedure still offers us too much information. Both
for a deeper understanding of the underlying physics and for easy implementation in numerical codes,
the trick is to discover the few important functions by which the major effects can be described. In this
section, we determine those functions needed for an accurate treatment of rf current ramp-up.

, or else they collapse into the electron bulk u

Let us suppose that rf ﬂux is present only for some ﬁnite time. Electrons obeying Eq. (2) then
eventually suffer one of two fates. Either they run away under the inﬂuence of the electric ﬁeld uk →
0. We classify these two groups of electrons as
−∞
→
“runaway” (subscript r) and “stopped” (subscript s) respectively. In a real plasma, i.e., T
= 0, even the
bulk particles will eventually run away. However the time tr it takes for these bulk electrons to run away
(vr/vt)2. Our analysis is valid for times short compared with the
is exponentially large, i.e., log tr ∼
bulk runaway time.

8

6
Runaways are very important in the calculation of the ramp-up efﬁciency because runaways gain
energy at the expense of the poloidal magnetic ﬁeld. Unless they are lost, even a small number of
runaways can greatly reduce the ramp-up efﬁciency. Runaways may be deﬁned as those particles with
where u0 is some arbitrary positive speed. (The number of runaways is independent
u > u0 for τ
and h0(u) = 1 for u > u0 and 0
of u0.) Therefore their number is given by Eq. (7) with τ
otherwise. The Green’s function for the runaway number is given by R(u)
) where R
obeys

h(u, τ

→ ∞

→ ∞

→ ∞

≡

D∗

= 0,

R(u)
(11)
with boundary condition R(u) = 1 on Σout. This function is the “runaway probability,” the probability
that an electron initially at u runs away under the combined inﬂuence of the electric ﬁeld and collisions.
Equation (11) was solved numerically with the boundary at ub = 10. A term ∂R/∂τ was included on
the left-hand side, and the resulting equation was integrated until τ = 100. A spherical (u, θ = arccos µ)
grid was used with a mesh size of 500
100. The equation was integrated with an ADI (alternating
direction implicit) scheme with a time step ∆τ = 0.01. The same method was used to solve the other
equations given below.

×

(cid:0)

(cid:1)

In Fig. 1, we plot R(u) for Z = 1. For u < 1, R is identically zero because the magnitude of the
electrical force is less than that of the frictional force. One of the most important applications of these
results is to drive current by lower-hybrid waves. In this case S is in the parallel direction and is localized
near u⊥ = 0. Therefore, we need only know R(uk, u⊥ = 0) which is plotted in Fig. 2 for Z = 1, 2, 5,
and 10. From this plot, we see that we can effectively avoid the creation of runaways by operating with
waves whose phase velocities lie in the range 0 < uk . 1.5.

The next important quantity to determine is the current density carried by f1. This is given (in units
of qnvr) by Eq. (7) with h0(u) = uk. The Green’s function for the current j(u, τ ) is therefore given
by ∂j/∂τ + D∗(j) = 0 with initial condition j(τ = 0) = uk and boundary condition j = uk −
τ on
Σout. This is the mean current (in units of qvr) carried by an electron initially at velocity u. In Fig. 3(a),
we plot j(u, τ ) as a function of τ for u = 5ˆuk and Z = 1. Because the presence of runaways leads to
τ ) for large times, it is helpful to distinguish the current carried by stopped and
a secular behavior (j
runaway electrons. We write

∼

j(u, τ ) =

1

R(u)

js(u, τ ) + R(u)jr(u, τ ).

−

(cid:0)

(cid:1)

The quantity js (resp. jr) is the mean current carried by an electron given that it eventually stops
(resp. runs away). An electron at velocity u runs away with probability R(u). Thus it contributes
uk to the stopped current and R(u)uk to the runaway current. These quantities are therefore
1
the initial conditions to the adjoint equations for (1
(cid:0)

R)js and Rjr respectively, so that

R(u)

−

(cid:1)

−

∂
∂τ

+ D∗

(1

R)js =

+ D∗

Rjr = 0,

−

∂
∂τ

(cid:19)

(cid:19)

τ on Σout.

(cid:18)
(cid:18)
with js(τ = 0) = jr(τ = 0) = uk and js = jr = uk −
The stopped and runaway currents js and jr are plotted in Figs. 3(b) and (c) for same case as Fig. 3(a).
Evidently, js vanishes for τ
(since the electrons cease to carry any current once they are stopped).
The time it takes for the electrons to be stopped is of the order of u. Assuming that this time is short
compared to the time scale for the variation of the rf ﬂux S, we may replace js(u, τ ) by Ws(u)δ(τ )
where Ws(u) =
0 js(u, τ ) dτ . The equation for Ws is obtained by integrating Eq. (8) over time to
give
R

Ws(u)
R)Ws = 0 on Σout. Ws can be interpreted as the energy (in units of mv2

r ) imparted to the
with (1
electric ﬁeld by an electron as it slows down. In Fig. 4(a), we plot Ws(u) for Z = 1. In the limit

R(u)

R(u)

→ ∞

(12)

D∗

uk,

(cid:2)(cid:0)

=

−

−

−

∞

1

1

(cid:1)

(cid:1)

(cid:0)

(cid:3)

9

, collisions are extremely weak, and all of the kinetic energy of the stopped particles goes into

uk → ∞
the electric ﬁeld, i.e.,

→
In the limit u
1, the electric ﬁeld weakly perturbs the electron motion. Then, Ws is given by the
theory of steady-state current drive,19,20 and corrections linear in the electric ﬁeld are given by the hot
conductivity.14 In our notation, these results may be summarized by

≪

Ws(uk → ∞

, u⊥ = 0)

1

2 u2
k.

Ws(u

1, µ) =

≪

µu4
5 + Z −

(2 + Z + 3µ2)u6
3(3 + Z)(5 + Z)

.

This function is plotted in Fig. 4(b). (An approximation to Ws correct to order u10 is given in Ap-
1, and the behavior of this function is
pendix B.) This linearized theory, however, is inapplicable for u
completely wrong for u & 1.

∼

Let us now turn to the contributions of the runaways to the current. The leading order contribution to

jr is

τ . Let us therefore write

−

jr(u, τ ) =

τ + jr0(u) + j′

r(u, τ ),

−

r(τ

)
→ ∞

where j′
∼
see Fig. 3(c). The function jr0 is given by
D∗

R(u)jr0(u)

= R(u),

1/τ and jr0 may be interpreted as the effective starting velocity for the runaways;

1, the runaway
with boundary condition jr0 = uk on Σout. This function is shown in Fig. 5. For u
(cid:0)
≫
electrons are only weakly perturbed by collisions so that jr0(u)
uk. Close to u = 1, collisions hold
back the runaway electrons and jr0(u) becomes large. However, it is not very important to know jr0 and
j′
r very accurately since they are usually dominated by the ﬁrst term in Eq. (14). We will approximate
jr0(u) by uk and will ignore j′

r(u, τ ) to give jr(u, τ ) = uk −
Finally, we can write the Green’s function for the current in an expedient form as

τ .

≈

(cid:1)

1

R(u)

j(u, τ ) =

(15)
In this form, it depends only on two scalar functions of u, namely R and Ws. Approximate ﬁts to these
functions are given in Appendix B. An easy but important generalization is possible here and that is
τ . For
to allow a loss mechanism for runaways. This is done by modifying suitably the term uk −
example, if the loss of runaways can be characterized by a loss time τloss, this term should be multiplied
by exp(

Ws(u)δ(τ ) + R(u)(uk −
(cid:1)

τ ).

τ /τloss).

−

(cid:0)

Using this formulation, many other moments of f1 may be found. For example, we may wish to
r ) as they leave the

know the mean perpendicular energy of the runaway particles
integration region V . (The loss rate for runaways may depend on this quantity.) This is given by
R(u)

E⊥r (in units of mv2

= 0,

D∗

−

2 u2

E⊥r = 1

with
this in Fig. 6. For electrons with uk > 1 and u⊥ = 0,
electrons to suffer appreciable pitch-angle scattering if they are to run away.

⊥ on Σout. (This result depends logarithmically on the value of ub.) We have plotted
E⊥r is about 3. This reﬂects the necessity for the

(cid:0)

E⊥r(u)
(cid:1)

V. CIRCUIT EQUATIONS

When rf energy is injected into a tokamak, it induces a ﬂux S of electrons in velocity space. The

power deposited per unit volume is then given by

(13)

(14)

(16)

prf (t) =

d3v mS(v, t)

v.

·

Z

10

Here, prf , S, and the other intensive physical quantities introduced in this section also depend on position
r. For brevity, this dependence is not shown in the arguments to these quantities. This equation may
In detailed studies of rf current ramp-up, based for instance on a ray-tracing
be used in two ways.
model, we can estimate S(v, t) on each ﬂux surface by solving a one- or two-dimensional Fokker–
Planck equation. Equation (16) then gives us the power deposition, prf . Alternatively, we can take the
experimental measurements together with an energy balance of the rf energy to give us an estimate of
prf . This, together with an approximate knowledge of where in velocity space the rf ﬂux is localized,
allows us to determine S. In addition to causing power absorption, the ﬂux S leads to numerous other
effects, such as rf-driven currents, rf-enhanced particle transport, etc. Here our primary concern is with
the rf-driven current. From Eq. (10), we see that this enters additively to the ohmic current so that the
total current density is given by the constitutive relation

J(t) = σ(t)E(t) + Jrf (t),

(17)

where σ(t) is the Spitzer–H¨arm conductivity22 for a Maxwellian plasma characterized by the background
electron temperature T (t), and Jrf is the rf-driven current density. Here we have assumed that
vt
so that in the absence of any rf we can ignore runaways. Incorporation of this effect merely requires the
addition of the current carried by the Dreicer runaway electrons in Eq. (17).

vr| ≫
|

The rf-driven current density is given by Eq. (10) with the h replaced by the current Green’s function
j and with S∗ = S. Let us begin by writing j in unnormalized units. The form for j given in Eq. (15)
will be sufﬁciently accurate for our purposes. Multiplying by qvr gives

j(v, t) =

R(u)

Ws(u)δ(t) + qR(u)

vk +

qvr
νr

1

−

(cid:0)

(cid:1)

qE
m

t

,
(cid:19)

(cid:18)

where u = v/vr. Here j is now a dimensional quantity, but Ws and R remain dimensionless functions of
a dimensionless argument. In deriving this form for j we assumed that E and n were constant. We now
relax this constraint, allowing them both to vary on a time scale long compared to the runaway collision
. (Recall that S is also allowed to vary on the same time scale.) We can then write j as
time ν−1

r

j(v, t

t′; t) =

−

qvr(t′)
νr(t′)

1

−

(cid:0)

(cid:1)

−

R(u′)

Ws(u′)δ(t

t′) + qR(u′)

vk +

E(s) ds

,

(18)

q
m

t

t′

Z

(cid:18)

(cid:19)

where u′ = v/vr(t′). The additional parametric argument t here has the same meaning as in Eq. (9). In
this form j(v, t
t′; t) is the mean current carried by an electron at time t given that it was traveling at
velocity v at time t′. From Eq. (10), the rf generated current density may now be written as

−

Jrf (t) =

t

dt′

0

Z

Z

d3v S(v, t′)

∂
∂v j(v, t

·

−

t′; t).

In order to write Jrf in a more useful form, we ﬁrst deﬁne a runaway density nr (in electrons per unit

volume). This is given by

with initial condition nr(t = 0) = 0. Substituting Eq. (18) into Eq. (19), we obtain

∂nr(t)
∂t

=

1
vr(t)

Z

d3v S(v, t)

∂
∂u R(u),

·

Jrf (t) = Js(t) + Jr(t),

where

(19)

(20)

(21a)

(21b)

(21c)

Js(t) =

d3v S(v, t)

R(u)

Ws(u),

q
νr(t)
q2
m

Z

∂Jr(t)
∂t

=

E(t)nr(t) + q

∂
∂u

·

1

−

(cid:0)
d3v S(v, t)

(cid:1)

∂
∂u R(u)uk,

·

Z

11

with Jr(t = 0) = 0. In Eqs. (20) and (21), u is normalized in terms of the runaway velocity at time
t, u = v/vr(t). These equations allow the current to be calculated by characterizing the runaway
population with just two state variables nr and Jr. Equations (16), (17), (20), and (21) sufﬁce to give a
detailed description of rf current ramp-up. In this form, Eq. (17) is suitable for substituting into a transport
or ray-tracing code. Furthermore, it would be easy to modify Eq. (20) to include a loss mechanism for the
runaways. Relativistic effects on the runaways could be included in an approximate fashion by limiting
to c the speed of light. Such effects could be treated in a more systematic manner by
Jr(t)/qnr(t)
|
|
modifying the term in large parentheses in Eq. (18) to read vk(t) where

vk(t) = pk(t)/mγ,
t

pk(t) = mvk +

qE(s) ds,

t′
Z
1 + p2
k(t)/m2c2.

γ =

q
t′; t) is valid for v2

The resulting expression for j(v, t
c2. Unfortunately, this is a
signiﬁcantly more cumbersome expression from which to calculate Jrf because, in order to determine the
state of the plasma at a particular instant, the entire runaway distribution must be given (instead of just
nr and Jr).

c2 and v2

r ≪

≪

−

VI. APPLICATIONS

The circuit equations written in Sec. V allow us to explore how Jrf interacts with the electric ﬁeld
to yield an efﬁcient conversion of rf energy into poloidal magnetic ﬁeld energy. It is helpful to convert
to extensive physical quantities by assuming that the plasma current is carried in a channel of area A in
which the plasma properties are approximately uniform. Thus, the total current is given by I = AJ, the
total rf power deposited in the electrons by Pin = 2πR0Aprf (where R0 is the tokamak major radius),
the loop voltage by V = 2πR0E, etc. The plasma current is again written as the sum of ohmic and rf
contributions

where RSp = 2πR0/Aσ is the plasma (Spitzer–H¨arm) resistance. Faraday’s law relates the rate of change
of the current to the voltage

where L is the total plasma inductance, which for simplicity we shall take to be constant, Vext is the
voltage induced by the external coils (usually a combination of the ohmic windings and the vertical ﬁeld
coils), and ˙I

dI/dt. Multiplying this equation by I and substituting for I from Eq. (22) gives

≡

I = V /RSp + Irf ,

V =

L ˙I + Vext,

−

˙W = Pext + Pel −

V 2
RSp

,

1

2 LI 2 is the poloidal ﬁeld energy, Pext ≡

VextI is the power coupled from the external
where W
≡
V Irf is the power coupled from the rf source into electromagnetic energy. This
circuits, and Pel ≡ −
equation describes the energy balance for the poloidal magnetic ﬁeld. The practical measure of the
efﬁciency of current ramp-up is

(22)

(23)

(24)

(25)

where Prf is the total rf power injected into the plasma. The rf power absorbed by the electrons Pin is
related to Prf by Pin = ηPrf where η is the absorption factor. The determination of η is beyond the scope

˙W

−
Prf

Pext

Pel −

=

V 2/RSp
Prf

,

12

Pel
Pin

=

R

d3u S

∂Ws/∂u
u

.

·
d3u S

·

Pel
Pin

=

ˆS

∂Ws/∂u
ˆS
u

,

·

·

Pel
Pin

=

∂Ws/∂u
u

.

of this paper; presumably it can be found by ray-tracing theories or by a power balance. The overall
picture of the ﬂow of power in an experiment is as follows: Rf power Prf is injected into the machine.
Of this a fraction η is absorbed by the resonant electrons; the rest may be absorbed by the ions or by the
vacuum vessel. A fraction Pel/Pin of this power is then converted into electromagnetic energy. Pext acts
as another source of poloidal ﬁeld energy, while the ohmic dissipation V 2/RSp acts as a drain. From
this discussion, we see that Pel/Pin describes the “ideal” efﬁciency of rf current ramp-up. The practical
efﬁciency is expressible in terms of this efﬁciency, η, and V 2/RSp.

The determination of Pel/Pin from Eq. (21) is complicated by the presence of runaways. Runaways
are deleterious to the ramp-up efﬁciency since their current is in the same direction as E and so they
subtract from Pel. For efﬁcient current ramp-up we must either avoid creating runaways by making sure
S is localized in that region of velocity space where the runaway probability R is small (see Figs. 1 and
2), or else take steps to lose the runaways. We can approximately treat these cases by taking R = 0 in
Eq. (21) to give

Since this involves the ratio of two integrals over u, the result is insensitive to the detailed form of S. In
cases of practical interest, we may assume that S is localized in u. Then, we have

R

(26)

(27a)

(27b)

where u is the normalized velocity of the resonant electrons.

For lower-hybrid waves we have ˆS = ˆuk and the waves interact with particles through the Landau
kkvk = 0, where ω and kk are the wave frequency and parallel wave number. Furthermore,
resonance ω
the typical perpendicular velocity of the resonant electrons equals the electron thermal velocity, so that
vk. Thus Eq. (26) is to be evaluated with uk = ω/kkvr and u⊥ = 0. This gives
v⊥ ∼

vt ≪

−

This efﬁciency is plotted in Fig. 7(a). Approximate ﬁts for this function are given in Appendix B.

On the other hand, for electron-cyclotron waves which interact through the Doppler-shifted cyclotron
kkvk = lΩ, where Ω is the cyclotron frequency and l is the harmonic number, we have

resonance ω
ˆS = ˆu⊥. In this case we evaluate Eq. (26) at uk = (ω

−

lΩ)/kkvr and u⊥ = 0 to give

∂Ws/∂u

Pel
Pin

=

−
(1/uk)∂Ws/∂µ
u

,

−

which is plotted in Fig. 7(b).

Using Eqs. (27), it is possible to identify regions of high conversion efﬁciency of wave energy to
electric energy, given the restriction of R small. Additionally, if the ohmic losses, V 2/RSp, are small,
then by Eq. (25), we see that the conversion of wave energy to poloidal ﬁeld energy can be of high
efﬁciency. This, in fact, is what has been achieved on the PLT experiment, where conversion efﬁciencies
of over 25% have been reported.4

An important practical consequence of the circuit equations derived here is that fast ramp-up rates,
i.e., large ˙I, are possible at high density. In fact, these fast ramp-up rates are necessary for high energy
conversion efﬁciencies at high density. This can be seen as follows: The efﬁciency, Pel/Pin, is a function
of the dimensionless parameter uk, depending, in addition, only weakly on Z. For a given machine and
a given wave phase velocity, the parameter uk depends only on the ratio, E/n; and the ramp-up rate,
˙I, depends only on the dc electric ﬁeld, E. Thus, the efﬁciency depends only on the ratio of ˙I to n. It

13

has been observed experimentally on the PLT experiment that high efﬁciency of converting rf energy
to magnetic ﬁeld energy is possible at a low plasma density. Thus, we can predict that a similar high
efﬁciency is possible in the event that the density and the ramp-up rate are scaled up together. In fact, for
large ramp-up rates, high density can actually be desirable in that it impedes the production of runaways.
Note that this window of desired density for a given ramp-up rate is counter to our intuition derived from
steady-state considerations, where the larger the density the less the current-drive efﬁciency.

There are several optimizations that one might wish to achieve in the ramp-up problem. One is
to maximize the energy conversion efﬁciency, Pel/Pin. A second is to minimize the ramp-up time,
I/ ˙I. The minimization of capital costs for the rf system, however, may demand that we
Tramp ≡
minimize Prf , the rf power required to ramp-up a given current.

We can express this more precisely with some convenient formulas. In the absence of the external

source Vext, the ramp-up rate may be written using Faraday’s law as

(28)

(29)

˙I

≈

5E
ln R0/a

MA
s

,

Prf ≈

1
η

1

2 LI 2
Tramp (cid:30)

Pel
Pin

,

where a tokamak inductance L
µ0R0 ln R0/a was assumed, and where E is the dc electric ﬁeld in
units of V/m. Note that the ramp-up rate depends linearly on E and is almost independent of geometry
(ln R0/a

1). The amount of dissipated rf power required can than be written as

≈

≈

if we neglect both ohmic losses (V 2/RSp) and the external source Pext. Thus, in extrapolating results
to larger tokamaks (higher 1
2 LI 2), we can maintain linear (in the required stored energy) power require-
ments, with the same ramp-up time and the same efﬁciencies, if the density scales linearly with ˙I and
hence with I. Here, the wave phase velocities also remain the same, and in the event of the same temper-
atures, the physics of the damping may be expected to be very similar, so that the percentage of incident
rf power that is absorbed, η, remains constant too.

1

≈

For example, using Fig. 7(a), we see that in PLT with n

1012 cm−3, T
24 mV/m. Here uk ≈

2
×
4 c, we ﬁnd reported ramp-up rates of ˙I = 120 kA/s, or E

1 keV, ω/kk ≈
1.4 and
6vt ≈
ideal efﬁciencies of about 33% at Z = 1 may be expected with little runaway production, consistent
with experimental data. Also, consistent with the data would be somewhat higher Z, but then only if the
conﬁnement of runaways were not perfect.
For reactor-grade tokamaks, say LI 2

10 MA, a ramp-up time which is longer
400 MJ and I
than that in PLT is desirable in order to minimize Prf and the capital cost of the rf system. For a 30 s
1012 cm−3 renders the ratio ˙I/n as in the PLT experiment. Employing a
ramp-up time, a density of 5
similar spectrum of waves (ω/kk = 1
4 c) in a plasma of temperature also similar to the PLT experiment
(T
40 MW would be
≈
required.

1 keV) implies a similar η (about 0.7). Thus, using Eq. (29), we see that Prf ≈

≈

≈

≈

≈

×

To summarize the tradeoffs here, we note that while Pel/Pin is minimized by considering only the
ratio ˙I/n, the minimization of Prf requires the Tramp be large. Thus, although very quick ramp-up
rates are indeed achievable at high density, the capital costs for such a system are proportionately larger
too. Balancing the desires for a quick ramp-up against those for low capital costs (low Prf ) points to
a parameter range of moderate density. Efﬁcient ramp-up is only achieved when, in addition to the
above restrictions, the temperature is moderate, since at high temperatures, V 2/RSp losses, neglected in
Eq. (29), begin to dominate. The regime where these ohmic losses dominate may be identiﬁed by writing

V 2
RSp ≈

LI 2
Tramp

L/RSp
Tramp

.

14

These losses represent only small corrections when V 2/RSp ≪

Prf , or, using Eq. (29), when

Tramp
L/RSp ≫

Pel
Prf

.

For the reactor-grade example, Pel/Pin ≈
time be longer than about 1
2 keV.

0.7, the above inequality requires that the ramp-up
4 of the L/RSp time. This restricts the temperature to somewhat less than

≈

1
3 , η

Restricting the temperature during a period of intense rf injection (perhaps 40 MW) requires a small
heat conﬁnement time during the start-up operation. In the above example, this may be as small as 30 ms.
Poor conﬁnement during the start-up phase may be helpful from the standpoint of runaway buildup too.
1%) of reverse runaways23 can seriously impede ramp-up if the runaways are
Even a small percentage (
well conﬁned. If the runaways are poorly conﬁned, then higher percentages may be tolerated, allowing
higher ramp-up rates and, consequently, higher energy conversion efﬁciencies for a given density.

∼

We are led thus to the following typical picture of rf ramp-up for pulsed tokamak operation. Start-up
can proceed in a low density plasma24 where the rf power is also used to initiate the plasma. Density
and rf power, and the ramp-up rate, are increased concomitantly as the plasma is brought to interesting
densities 1013–1014 cm−3. During this phase, the temperature is purposefully kept low, possibly through
a deliberate degradation of the conﬁnement of both runaway and thermal electrons. Hence the current is
programmed to reach a large value prior to the density, and both reach large values prior to the tempera-
ture. The ﬁnal step, in which the reactor is brought to reactor-grade temperature, occurs after the current
is ramped up and as a result of ceasing the deliberate degradation of conﬁnement.

VII. CONCLUSIONS

In this paper we have written down a set of circuit equations that describe the dynamics of an rf-
driven plasma. In arriving at these circuit equations, we systematically introduced approximations with
a goal of characterizing the driven plasma by a small number of functions of few variables that retain
the essential physics. Greater accuracy, possible at the price of more complex circuit equations, may
be obtained as a natural extension of the development here. The identiﬁcation and calculation here of a
minimal set of transport functions, however, provided a suitable and manageable description for a large
class of important problems.

The calculations of the runaway function R and of the energy conversion function Ws together pin-
point the preferred region for tokamak ramp-up operation. These functions depend only on the dimen-
sionless parameter u. The separate contributions of runaway and stopped currents may be described
using these functions of a single variable. The constitutive relations thus obtained are given by Eqs. (21).
These equations are in a form both suitable for implementation in a transport code and amenable to
obvious modiﬁcation in the event that more complex runaway models are desired.

There are several caveats to bear in mind in using these formulas. First, the time scale for variation of
the dc electric ﬁelds has been assumed long compared to other scales of interest, such as the particle
deceleration times. A violation of this scale separation would affect the normalizations through vr.
Second, knowledge of the rf spectrum is unlikely to be complete. This knowledge is necessary to give S,
the rf-induced ﬂux. Even if the incident rf energy is followed by ray-tracing codes, it remains possible
that other waves may be present. These other waves might arise either due to asymmetries in the particle
distribution functions or due to nonlinear effects associated with the incident spectrum. Third, particle
transport across ﬁeld lines was neglected in comparison to the effects along ﬁeld lines. The neglect of
these effects is possible for stopped electrons if they are stopped before they reach a ﬂux surface with
signiﬁcantly different conditions (vr different). For runaway electrons, these effects are always important
in that they provide a model for the runaway loss. As discussed after Eqs. (21), such model may be

15

included through a natural modiﬁcation of Eq. (21c).
model, at present, for runaway loss we have left the modiﬁcation of Eq. (21c) as an open issue.

In the absence of one particularly compelling

Finally, we should note that some of the most powerful conclusions of this paper occur in certain
special cases. It is often the case that the rf spectrum is not only known, but also localized, which enables
a particularly simple evaluation of the conversion efﬁciency, as in Eqs. (27). In the event of moderate
electric ﬁelds, or spectra localized at moderate phase velocities, it may be that R = 0 (no runaway
production), and an accurate runaway loss model would not be needed. In the event that runaways are
conﬁned well, the spectrum must be chosen carefully to assure that R = 0.

ACKNOWLEDGMENTS

CHO–3073.

This work was supported by the United States Department of Energy under Contract DE–AC02–76–

Appendix A. LANGEVIN EQUATIONS

Here we show that the conditional probability distribution g(u, τ ; u′) for Eqs. (4) satisﬁes Eq. (3).
The derivation follows those given in Refs. 18 and 25. Because the process described by Eqs. (4) is a
Markoff process, g satisﬁes the Smolucowski equation18

g(u, τ + ∆τ ; u′) =

d3u′′ g(u, ∆τ ; u′′)g(u′′, τ ; u′)

(A1)

for all τ > 0 and ∆τ > 0. Let us deﬁne

Subtracting g(u, τ ; u′) from Eq. (A1) gives

r(w, u, ∆τ )

g(u + w, ∆τ ; u).

Z

≡

Z

g(u, τ + ∆τ ; u′)

g(u, τ ; u′) =

d3u′′

r(u

u′′, u′′, ∆τ )g(u′′, τ ; u′)

−

−

−

r(u

(cid:2)
−

u′′, u, ∆τ )g(u, τ ; u′)

,

(A2)

where, because of the normalization condition for probabilities, the second term in the integral may be
reduced to g(u, τ ; u′). If we change the variable of integration to w = u
u′′, the right-hand side of
Eq. (A2) becomes

−

(cid:3)

d3w

r(w, u

w, ∆τ )g(u

w, τ ; u′)

r(w, u, ∆τ )g(u, τ ; u′)

.

−

−

−

Z

(cid:2)

For small ∆τ , the function r(w, u, ∆τ ) is highly localized about w = 0. We may therefore expand the
ﬁrst term in the integral, assuming that w is much smaller than u, to give

(cid:3)

−

−

r(w, u

w, τ ; u′)

w, ∆τ )g(u

r(w, u, ∆τ )g(u, τ ; u′)

∂
∂u r(w, u, ∆τ )g(u, τ ; u′)
·
∂2
∂u∂u r(w, u, ∆τ )g(u, τ ; u′).
Using this approximation in Eq. (A2), integrating by parts, dividing by ∆τ and taking the limit ∆τ
we ﬁnd as the equation for g(u, τ ; u′)

ww :

1
2

w

≈

+

−

0,

→

(A3)

∂
∂τ

g =

∂
∂u ·

Ag +

∂2
∂u∂u : Bg,

16

where

and

A(u) = lim

∆τ →0 −

B(u) = lim
∆τ →0

,

∆u
i
h
∆τ
∆u∆u
i
h
2∆τ

,

∆u
i
h

∆u∆u
i

h

=

=

Z

w r(w, u, ∆τ ) d3w,

ww r(w, u, ∆τ ) d3w.

Z
is the average value of u(τ + ∆τ )

∆u
i

∆u∆u
).
Thus
i
h
These quantities may be calculated directly from Eqs. (4) assuming that ∆τ is sufﬁciently small that u
does not change appreciably. We then obtain

u(τ ) given that u(τ ) = u (and similarly for

−

h

∆u
h

i

=

−

τ +∆τ

1

u(τ ′)2 + µ(τ ′)
(cid:29)

dτ ′

∆µ
i
h

=

≈ −

τ
Z

∆τ,

(cid:28)
1
u2 + µ
(cid:19)
A(τ ′)

(cid:18)
τ +∆τ

τ

Z

(cid:28)
1 + Z
u3 µ +

(cid:18)
τ +∆τ

τ +∆τ

≈ −

1

µ(τ ′)2

−
u(τ ′)

dτ ′

(cid:29)

1

µ2

−

−
u

∆τ,

(cid:19)
A(τ ′)A(τ ′′)
i

h

dτ ′ dτ ′′ + O(∆τ 2)

∆µ∆µ
i
h

=

τ
Z
(1

τ
Z
1 + Z
u3
∆u∆µ
i

h

−
=

≈
=

µ2)∆τ,

∆u∆u
h

i

∆µ∆u
h

i

= O(∆τ 2).

Here we have made use of the properties of A given in Eqs. (5). Writing Eq. (A3) in spherical coordinates
and substituting for the non-zero components of A and B, we obtain

∂
∂τ

g =

∂
∂u

1
u2
∂
∂uk

=

g +

u2Aug +

Aµg +

∂
∂µ

1
u2

∂
∂u

g +

1 + Z
2u3

∂2
∂µ2 Bµµg
∂
µ2)
∂µ

(1

−

∂
∂µ

g.

(A4)

−

This is the same equation as Eq. (3). Furthermore, from the deﬁnition of g as a conditional probability,
the initial condition for Eq. (A4) is also the same as for Eq. (3), namely, g(u, τ ; u′) = δ(u

u′).

Appendix B. NUMERICAL FITS

In this appendix, we give approximations for some of the important functions we have calculated.
These are suitable for incorporating into modeling codes. The approximations were found by choosing
a suitable analytic form containing several undetermined coefﬁcients and adjusting those coefﬁcients in
order to minimize the maximum relative error. The technique for carrying out this procedure is described
in Hastings’ classic work.26 The ﬁts were made to the numerical data presented in Sec. IV. This data
itself contains errors due to the numerical methods used. The main source of error is due to the ﬁnite size

17

of the numerical mesh and it is estimated that this introduces errors on the order of a percent. However,
near u = 0, the relative error in the numerical data for Ws and its derivative becomes large because
Ws = O(u4). Thus for u < 0.5, the ﬁts were made using the following analytical approximation instead
of the numerical data:

Ws =

µu4
Z + 5 −

(2 + Z + 3µ2)u6
3(3 + Z)(5 + Z)

2

+

(24 + 19Z + 3Z 2)µ + (9 + Z)µ3
(3 + Z)(5 + Z)(7 + 3Z)(9 + Z)
(cid:1)

u8

2

1041+1864Z+1189Z

3
+10(417+497Z+181Z2+21Z3)µ2+5(9+Z)(13+3Z)µ4
5(2 + Z)(3 + Z)(5 + Z)(7 + 3Z)(9 + Z)(13 + 3Z)

+316Z

u10

4

.

(cid:1)

− (cid:0)

(cid:0)
+30Z

This result was obtained by solving Eq. (12) for small u using MACSYMA.27 (The ﬁrst two terms in this
expansion are those derived by Fisch.14)

For each of the functions approximated, we give the analytic form of the approximation, the range
in which it is valid, a table of coefﬁcients, and the maximum relative error. The approximations should
not be used outside the range given. Also, note that the relative error quoted is the error in ﬁtting the
approximation to the numerical data which itself is in error by about a percent.
For µ = 1 and 1.4 < u < 8, the runaway probability R is approximated by

R(u, µ = 1) = exp

3
i=0 ai(u
3
i=1 bi(u

1)i
,
1)i !

−

−

  P
P

where b1 = 1 and the other coefﬁcients ai and bi are given in Table I. The maximum relative error is 1%.
For µ = 1 and 1 < u < 1.4, the same approximation may be used with small absolute error but large
relative error. For u < 1 and all µ we have R = 0 identically.

For µ = 1 and 0 < u < 5, the energy imparted to the electric ﬁeld Ws by stopped electrons is

approximated by

where b0 = 1 and the other coefﬁcients ai and bi are given in Table II. The maximium relative error is
2%. For µ =

P
1 and 0 < u < 1, Ws is approximated by

where the coefﬁcients ai are given in Table III and the maximium relative error is 1.5%.

For µ = 1 and 0 < u < 5, the function (∂Ws/∂u)/u is is approximated by

where b0 = 1 and the other coefﬁcients ai and bi are given in Table IV. The maximium relative error is
5%. For µ =

1 and 0 < u < 1, (∂Ws/∂u)/u is approximated by

Ws(u, µ = 1) =

4
i=2 aiu2i
3
i=0 biu2i

,

P

Ws(u, µ =

1) =

aiu2i,

−

5

i=2
X

1
u

∂
∂u

Ws(u, µ = 1) =

3
i=1 aiu2i
3
i=0 biu2i

,

P

P

1
u

∂
∂u

Ws(u, µ =

1) =

aiu2i,

−

4

i=1
X

18

where the coefﬁcients ai are given in Table V and the maximium relative error is 3%.

−

−

References

1N. J. Fisch, Phys. Rev. Lett. 41, 873 (1978).
2N. J. Fisch and C. F. F. Karney, Phys. Rev. Lett. 54, 897 (1985).
3C. F. F. Karney, N. J. Fisch, and F. C. Jobes, Phys. Rev. 32A, 2554 (1985).
4F. C. Jobes, S. Bernabei, T. K. Chu, W. M. Hooke, E. B. Meservey, R. W. Motley, J. E. Stevens, and S.

E. von Goeler, Phys. Rev. Lett. 55, 1295 (1985).

5N. J. Fisch, Phys. Fluids 29, 172 (1986).
6R. W. Harvey, J. C. Riordan, J. L. Luxon, and K. D. Marx, Proc. 4th Topical Conf. on Radio Frequency

Plasma Heating, Austin, Texas (1981), Paper C9.

7C. S. Liu, Z. G. An, D. A. Boyd, Y. C. Lee, L. Muschietti, K. Appert, and J. Vaclavik, Comments

Plasma Phys. Contr. Fusion 7, 21 (1982).

8L. Muschietti, J. Vaclavik, and K. Appert, Plasma Phys. 24, 987 (1982).
9Z. G. An, C. S. Liu, Y. C. Lee, D. A. Boyd, L. Muschietti, K. Appert, and J. Vaclavik, Phys. Fluids 25,

10K. Appert, A. H. Kritz, S. Succi, and J. Vaclavik, Proc. 11th European Conf. on Contr. Fusion and

997 (1982); 26, 345 (1983).

Plasma Phys., Aachen (1983), Part 1, 329.

11K. Borrass and A. Nocentini, Plasma Phys. and Contr. Fusion 26, 1299 (1984).
12C. S. Liu, V. S. Chan, and Y. C. Lee, Phys. Rev. Lett. 55, 2583 (1985).
13D. F. H. Start, Plasma Phys. 25, 793 (1983).
14N. J. Fisch, Phys. Fluids 28, 245 (1985).
15C. F. F. Karney and N. J. Fisch, Phys. Fluids 28, 116 (1985).
16H. Dreicer, Phys. Rev. 117, 329 (1960).
17C. F. F. Karney and N. J. Fisch, Phys. Fluids 22, 1817 (1979).
18M. C. Wang and G. E. Uhlenbeck, Rev. Mod. Phys. 17, 323 (1945) in Selected Papers on Noise and

Stochastic Processes, edited by N. Wax (Dover, New York, 1954).

19N. J. Fisch and A. H. Boozer, Phys. Rev. Lett. 45, 720 (1980).
20T. M. Antonsen and K. R. Chu, Phys. Fluids 25, 1295 (1982).
21M. Taguchi, J. Phys. Soc. Jpn. 52, 2035 (1983).
22L. Spitzer and R. H¨arm, Phys. Rev. 89, 977 (1953).
23D. C. Eder and E. J. Valeo, private communication (1984).
24F. C. Jobes, J. Stevens, R. Bell, S. Bernabei, A. Cavallo, T. K. Chu, S. Cohen, B. Denne, P. Efthimion,
E. Hinnov, W. Hooke, J. Hosea, E. Mazzucato, R. McWilliams, R. Motley, S. Suckewer, G. Taylor, J.
Timberlake, S. von Goeler, and R. Wilson, Phys. Rev. Lett. 52, 1005 (1984).

25E. M. Lifshitz and L. P. Pitaevskii, Physical Kinetics (Pergamon Press, Oxford, 1981).
26C. Hastings, Approximations for Digital Computers, Princeton University Press (Princeton, 1955).
27The Mathlab Group, MACSYMA Reference Manual, Version 10, Laboratory for Computer Science,

Massachusetts Institute of Technology (1983).

19

Tables

TABLE I. Coefﬁcients for approximation to R(u, µ = 1).

Z
1
2
5
10

a0
3.68063
4.97636
4.27687
4.94597

−
−
−
−

a1
4.23913
16.09015
4.33629
1.53482

−

−
−

−

a2
4.55894
0.83188
0.30338
0.10112

−

a3
0.39755
0.21737
0.05697
0.03087

−

b2
1.22774
6.84615
3.21315
2.45288

b3
1.41450
0.98649
0.47749
0.36896

−
−
−

TABLE II. Coefﬁcients for approximation to Ws(u, µ = 1).

Z
1
2
5
10

a2
0.16612
0.14200
0.09880
0.06537

a3
0.01495
0.04048
0.05152
0.03895

−
−
−
−

a4
0.00775
0.01145
0.01113
0.00738

b2
0.02240
0.00384
0.00559
0.02797

b3
0.01645
0.02440
0.02362
0.01526

TABLE III. Coefﬁcients for approximation to Ws(u, µ =

1).

Z
1
2
5
10

a2
0.16483
0.14186
0.09975
0.06651

−
−
−
−

a3
0.13420
0.09297
0.04781
0.02797

−
−
−
−

a5
0.24314
0.12870
0.03545
0.00934

−
−
−
−

TABLE IV. Coefﬁcients for approximation to (∂Ws/∂u)/u for µ = 1.

Z
1
2
5
10

a1
0.66445
0.56760
0.39906
0.27028

a2
0.36032
0.38984
0.32879
0.23261

−
−
−
−

a3
0.07328
0.08634
0.07670
0.05272

b1
0.17769
0.04019
0.28281
0.39140

−
−
−

b2
0.25452
0.24673
0.16275
0.07526

−
−
−
−

b3
0.07278
0.08508
0.07436
0.04981

TABLE V. Coefﬁcients for approximation to (∂Ws/∂u)/u for µ =

Z
1
2
5
10

a1
0.63673
0.55777
0.39704
0.26600

−
−
−
−

a2
1.39960
0.80763
0.33811
0.17342

−
−
−
−

a3
3.37662
1.43144
0.23607
0.01896

1.

−

a4
4.23684
2.03866
0.51011
0.13349

−
−
−
−

b1
0.37136
0.12253
0.19484
0.32456

−
−

−

a4
0.15346
0.06661
0.00606
0.00247

−

20

FIG. 1. The runaway probability R(u) for Z = 1. Parts (a) and (b) show R on two different scales. In (a)
the contours are equally spaced at intervals of 0.05. In (b) the lowest 7 contours are geometrically spaced
at intervals of 101/3 between 10−3 and 10−1; the remaining contours are equally spaced at intervals of
0.05 as in (a).

21

FIG. 2. R(uk, u⊥ = 0) for Z = 1, 2, 5, and 10.

22

FIG. 3. The current j(u, τ ) for u = 5ˆuk and Z = 1; (a) the total current j; (b) the stopped current js; (c)
the runaway current jr. For u = 5ˆuk, approximately 32% of the electrons run away.

23

FIG. 4. The energy imparted to the electric ﬁeld by the stopped particles Ws(u) for Z = 1. The innermost
contours are equally spaced at intervals of 0.005 between
0.05 and 0.05. The remaining contours are
equally spaced at intervals of 0.05. Part (a) shows the results of numerically solving Eq. (12); part (b)
shows Ws from the hot-conductivity theory Eq. (13).

−

24

FIG. 5. The function jr0(u) for Z = 1. The contours are equally spaced at intervals of 0.25.

FIG. 6. The perpendicular energy of the runaways
at intervals of 0.5.

E⊥r(u) for Z = 1. The contours are equally spaced

25

FIG. 7. Efﬁciency for lower-hybrid current drive (a) and for electron-cyclotron current drive (b) from
Eqs. (27).

26

