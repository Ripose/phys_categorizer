5
0
0
2
 
n
a
J
 
7
 
 
]
h
p
-
m
s
a
l
p
.
s
c
i
s
y
h
p
[
 
 
1
v
4
3
0
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

PPPL–1528 (Apr. 1979)
Phys. Fluids 22(11), 2188–2209 (Nov. 1979)

Stochastic Ion Heating by a Lower Hybrid Wave: II

Charles F. F. Karney

Plasma Physics Laboratory, Princeton University,
Princeton, New Jersey 08544

≫

k⊥|
The motion of an ion in a coherent lower hybrid wave (characterized by
and ω
Ωi) in a tokamak plasma is studied. For ions satisfying v⊥ > ω/k⊥, the
Lorentz force law for the ions is reduced to a set of diﬀerence equations which give the
Larmor radius and phase of an ion on one cyclotron orbit in terms of these quantities a
cyclotron period earlier. From these diﬀerence equations an earlier result [Phys. Fluids
21, 1584 (1978)] that above a certain wave amplitude the ion motion is stochastic, is
readily obtained. The stochasticity threshold is given a simple physical interpretation.
In addition, the diﬀerence equations are used to derive a diﬀusion equation governing
the heating of the ions above the stochasticity threshold. By including the eﬀects of
collisions, the heating rate for the bulk ions is obtained.

≪ |

kk

(cid:12)
(cid:12)

(cid:12)
(cid:12)

– 1 –

– 2 –

I.

INTRODUCTION

The motion of an ion in a plasma in the presence of a lower hybrid wave becomes
stochastic if the amplitude of the lower hybrid wave exceeds a threshold. This provides
a mechanism by which ions may be directly heated by the wave when using lower hybrid
waves to heat a tokamak plasma. In this paper we extend the work of an earlier paper1
(henceforth referred to as I), in which the stochasticity threshold was derived. The main
objects are to give a simple physical explanation of the stochasticity threshold, to derive the
velocity space diﬀusion coeﬃcient, and hence to determine the heating rate.

In I it was shown that for the purposes of computing the ion motion it may be assumed
that the magnetic ﬁeld is uniform if the fractional change in the magnetic ﬁeld over a
Larmor radius is small. Similarly, the lower hybrid wave may be treated as perpendicularly
2 (ω/Ωi)−1/6. Both these conditions
propagating if the wavevector, k, satisﬁes
are well satisﬁed in normal circumstances. Shear in the magnetic ﬁeld may also aﬀect the
motion;2 however, if the scale length of the shear greatly exceeds the Larmor radius, we
expect that this eﬀect may also be ignored. Thus, in this paper, we consider only the case
of an electrostatic wave propagating perpendicularly to a uniform magnetic ﬁeld; i.e.,

kk/k⊥

< 1

(cid:12)
(cid:12)

(cid:12)
(cid:12)

B = B0ˆz,

E = E0 ˆy cos(k⊥y

ωt).

−

As in I these ﬁelds are taken to be imposed, since only the motion of a small fraction of the
ions on the tail of the ion distribution function becomes stochastic, while the bulk ions and
electrons support the wave. Having determined the heating rate it will be possible to allow
for the damping of the wave.

Following I the Lorentz force law for an ion with mass, mi, and charge, qi = Zie, may

be written as

where length is normalized to k−1

¨y + y = α cos(y

νt),
⊥ and time to Ω−1

−

i

˙x = y,

(Ωi = qiB0/mi) and where

ν

α

≡

≡

ω/Ωi,

E0/B0
Ωi/k⊥

.

k⊥v⊥/Ωi,

r

≡

For later use we shall also deﬁne a normalized Larmor radius, r, by

where v2

⊥ = ˙x2 + ˙y2.

The plan of this paper is as follows: We ﬁrst reduce the Lorentz force law for the ion,
(2), to a set of diﬀerence equations (Sec. II) which determine the velocity and phase of the
ion in terms of its velocity and phase a cyclotron period earlier. These diﬀerence equations
have several symmetries which are presented in Sec. III and which simplify the study of the
ion motion. This is followed by a study of the ion motion for inﬁnitesimal E0 (Sec. IV)
where we show that the motion when ω is at a harmonic or half harmonic of the cyclotron
frequency has a very diﬀerent character from the motion at other frequencies. In Sec. V
we describe qualitatively the motion when E0 is ﬁnite. Here we deﬁne the stochasticity
threshold and explain it physically. The statisical properties of the ion motion above the
stochasticity threshold are described by the Krylov–Kolmogorov–Sinai entropy and the cor-
relation function which are examined in Secs. VI and VII. From the correlation function we

(1)

(2)

(3a)

(3b)

(3c)

– 3 –

ﬁnd the diﬀusion coeﬃcient (Sec. VIII). For times much longer than the correlation time
the ion motion in perpendicular velocity space is governed by a diﬀusion equation which
is derived in Sec. IX. This equation is checked against the exact equations of motion by
comparing a Monte Carlo solution of the diﬀusion equation with a simulation described in
I. Since the stochastic heating only aﬀects the tail ions we include a collision term in the
diﬀusion equation as a means of heating the bulk ions and electrons. The resulting Fokker–
Planck equation which describes the ion motion in two-dimensional velocity space (v⊥ and
vk) is reduced to a one-dimensional equation in v⊥ only (Sec. X). The one-dimensional Fok-
ker–Planck equation is checked against the two-dimensional equation by numerically solving
each of them (Sec. XI). Analytic steady-state solutions to the one-dimensional equation are
derived in Sec. XII which give results for the heating rates of the ions and electrons.

II. DERIVATION OF THE DIFFERENCE EQUATIONS

≫

≫

Ωi or ν

In this section we derive diﬀerence equations which approximately describe the motion
of the ion. The procedure involves integrating the equations of motion along unperturbed
orbits. Nonlinearity is introduced because we repeatedly correct the unperturbed trajecto-
ries. We assume that the wave frequency is much larger than the cyclotron frequency; i.e.,
ω
1. (This is the case for lower hybrid waves.) On a time scale between the
wave period and the cyclotron period the ion does not experience the eﬀects of the magnetic
ﬁeld and behaves, in some respects, as though in zero magnetic ﬁeld. Thus, when it passes
through the wave-particle resonance points, ω = k ˙v or ˙y = ν (Fig. 1), it will experience
kicks, which we can approximate by impulses. This is the physical picture that will guide
our derivation. We shall not be too concerned yet about the limits in which our approx-
imations are valid, prefering to rely on physical intuition. Appendix A gives an alternate
derivation starting from the Hamiltonian. While this derivation is less transparent, it does
enable us to state the limits of validity of the diﬀerence equations.

From Fig. 1 we see that for r > ν the particle passes through wave-particle resonance
twice per cyclotron orbit. We will approximate the force on the particle due to the electric
ﬁeld by impulses or delta functions at these two points and zero elsewhere.

In order to evaluate the area of the delta function forces we Taylor-expand the orbit
about the wave-particle resonance point using the unperturbed equation of motion, ¨y+y = 0.
Thus, we have

νt = yc + ˙y(tc)t′ + 1

2 ¨y(tc)t′2

y

−

νt

−

= φc −

1

2 yct′2,

−

tc, φc = yc −

where t′ = t
“collision,” and, by assumption,
term in (2), α cos(y
is the Dirac delta function and

−

νtc, tc and yc are the time and position of the wave-particle
˙y(tc) = ν. We substitute (4) into the electrostatic force
tc), where δ

νt), and approximate the resulting expression by B δ(t

−

B =

∞

−∞

Z

α cos(φc −

1

2 yct′2)dt′

= α(2π/

yc|
|

)1/2 cos[φc −

sign(yc)π/4]

(4)

(5)

– 4 –

[see Ref. 3, Eq. (4.3.144)]. We note that φc and hence B are the same (to ﬁrst order in
α) whether we compute tc and yc from the intersection of the orbit for t < tc with ˙y = ν
or from the intersection of the orbit for t > tc with ˙y = ν. This is so because yc and tc
are unchanged by the kick the ion receives, and because d(y
νt)/dt = 0 near the collision
(since ˙y = ν). As a consequence the mapping we deﬁne with the diﬀerence equations will
be invariant to time reversal, which in turn means that the mapping is measure-preserving,
a necessary condition for a non-dissipitive (i.e., Hamiltonian) system.

−

We deﬁne the cyclotron orbit as beginning and ending at y = 0,

Subscript, j, will refer to the orbit at the beginning of the jth or ending of the (j
orbit. A subscript, j + 1
˙y > 0. Finally, subscripts, + and

˙y < 0 (Fig. 1).
1)th
2 , will be used to refer to the middle of the jth orbit, where y = 0,

, will refer to the collisions with yc > 0 and yc < 0.

−

We describe the orbit by two parameters, a reduced Larmor radius,

−

≡
and the phase of the wave,

ρ

(r2

ν2)1/2

ν cos−1(ν/r) + νπ

π/4,

−

−

−

(Note that for r
quantities, v = θ + ρ, u = θ

ν, ρ

≫

∼

ρ.

−

Evaluating B− we note that φc =

so that

θ

νt

(mod 2π).

≡

r.) It is convenient to introduce the sum and diﬀerence of these

(r2

j −

−

ν2)1/2

ν[tj + π

cos−1(ν/rj )] =

−

−

vj −

−

π/4,

B− = α(2π)1/2(r2

ν2)−1/4 cos vj.

−

In (7) we have intentionally dropped the subscripts on r in the amplitude term. The
justiﬁcation for this is that r is large, so a change of order α in r has negligible eﬀect on the
amplitude factor compared with the same change in the argument to the cosine.

Working to order α we then ﬁnd

whence from (6)

[note that ∂ρ/∂r = (r2

where

rj+1/2 = rj + (ν/r)B−,

tj+1/2 = tj + π

(r2

−

ν2)1/2
r2

−

B−,

ρj+1/2 = ρj + ν(r2

ν2)1/2r−2B−,

−

ν(r2

ν2)1/2r−2B−

θj+1/2 = θj + νπ

−
ν2)1/2/r], and from (5)

−

−

uj+1/2 = uj + νπ

2πA cos vj,

−

vj+1/2 = vj + νπ,

A =

2
π

(cid:18)

(cid:19)

1/2 αν(r2

ν2)1/4

−
r2

.

(6a)

(6b)

(7)

(8a)

(8b)

(9a)

(9b)

(10a)

(10b)

(11)

(12a)

(12b)

(13a)

(13b)

(13c)

(13d)

(14)

(15)

(16)

(17)

Combining (10) and (12) we obtain the following diﬀerence equations which give the (j+1)th
orbit in terms of the jth orbit,

– 5 –

Similarly, we may show that

uj+1 = uj+1/2 + νπ,

vj+1 = vj+1/2 + νπ + 2πA cos uj+1.

u = θ

ρ,

−
2 (v + u),

θ = 1

v = θ + ρ,

ρ = 1

2 (v

u),

−

uj+1 −
vj+1 −

uj = 2πδ

2πA cos vj,

−

vj = 2πδ + 2πA cos uj+1,

A =

αν
r

H (1)′
ν

(r)

,

δ

(cid:12)
ν
(cid:12)
(cid:12)

≡

−

n,

(cid:12)
(cid:12)
(cid:12)

where

is the Hankel function of the ﬁrst kind and of order ν,

H (1)
1
2 , and n is an integer. In
ν
writing (14) we have made use of the expansion of the Bessel functions for r > ν + ( 1
2 ν)1/3
[Ref. 3, Eq. (9.3.3)]. Writing A in this way is mainly a notational convenience, although it
comes out naturally in this form when we use the whole cyclotron orbit as the unperturbed
orbit.4 We treat A as being a parameter (independent of ρ) in (13). We shall deﬁne T as
the mapping which takes a point to its iterate:

| ≤

δ
|

T (θj, ρj) = (θj+1, ρj+1).

The limits of validity of (13) are found to be (see Appendix A)

ν

1,

≫

r

ν

−

≫

2 ν)1/3,
( 1

(r2

ν2)3/2/r2.

A

≪

−

Note that the problem now just depends on two parameters, δ and A. This was rec-
ν, which is much more

ognized in I, but was only established analytically in the case r
restrictive than (17).

≫

The diﬀerence equations, (13), may be iterated numerically and compared with the
solution to the Lorentz force law, (2). Such a comparison is made in Fig. 2, where Fig.
2(a) is taken from I and Fig. 2(b) is obtained from the diﬀerence equations. We see that
there is excellent agreement, so that the diﬀerence equations indeed provide an accurate
approximation to the Lorentz force law.

We note that the kicks received by the ions happen at the Landau resonance points
(Fig. 1), and so it is interesting to compare the ion motion under the conditions described
by (17) with Landau damping in the absence of a magnetic ﬁeld. There are two important
diﬀerences. Because the magnetic ﬁeld sweeps the vector, v⊥, through all angles, the res-
onant particles in our case are those for which r > ν or v⊥ > ω/k⊥. These particles are
much more numerous than those satisfying the normal Landau resonance condition ˙y = ν or
vy = ω/k⊥. The second diﬀerence is that the kick that the particle receives, B, is a function
of the magnetic ﬁeld, since the magnetic ﬁeld causes the particle to spend only a short time
in resonance. In the linear limit of normal Landau damping the resonant particles remain
in resonance forever.

– 6 –

III. SIMPLE PROPERTIES OF THE DIFFERENCE EQUATIONS

The diﬀerence equations, (13), describe the mapping of the (θ, ρ) plane onto itself. It
models the nonlinear coupling of two harmonic oscillators, the parameter, δ, giving the
relation between the unperturbed frequencies and A giving the strength of the coupling.
The mapping is area-preserving, being derivable from the generating function,

F (uj+1, vj) = uj+1vj + 2πδ(uj+1 −

vj) + 2πA(sin uj+1 + sin vj).

(18)

[Equations (13c) and (13d) are given by uj = ∂F/∂vj and vj+1 = ∂F/∂uj+1, respectively.]
Thus, (13) describes a Hamiltonian system.

The (θ, ρ) plane is periodic (period 2π) in both the θ and ρ directions and so is topo-
logically equivalent to a 2π
2π torus. The periodicity in ρ is a consequence of taking A to
be independent of ρ. This, in turn, will allow a very simple determination of the diﬀusion
coeﬃcient (see Secs. VII and VIII). The periodicity in u and v allows a stronger statement
to be made, viz., the transformation,

×

leaves (13) invariant. This means it is suﬃcient to examine a range of 2π in θ and π in ρ.
Other transformations that leave the diﬀerence equations invariant are:

θ + π,

θ

→

ρ

ρ

π,

→

±

δ

δ

A

j

δ + 1;

→

δ,

A,

j,

→ −

→ −

→ −

θ

θ

θ

π

θ

π

→

−

→

−

→

−

θ,

π;

θ.

ρ

ρ;

→ −

The ﬁrst three of these allow a further restriction of the problem to 0
The last transformation shows the invariance of (13) to time reversal.

δ

≤

≤

1
2 and A

IV. SMALL AMPLITUDE SOLUTION

In this and the next section we examine some aspects of the transition from coherent

to stochastic behavior, beginning with the analysis for small A.

It is possible to write down the Hamiltonian for the diﬀerence equations, (A13). For
small A, canonical transformations similar to those in I may be performed, which allow a
solution to the problem. Here we take a diﬀerent approach which achieves the same results
in a more direct manner.

In the limit, A = 0, (13) describes two uncoupled harmonic oscillators. If δ is a rational
number, s/p, then all the points in the (θ, ρ) plane are pth-order ﬁxed points. If we now
let A be small, we expect θp −
ρ0 to be small also. In that case the diﬀerence
equations may be approximated be diﬀerential equations for ˙θ and ˙ρ. (It might seem that we
are going round in circles here. However, these diﬀerential equations will be much simpler
than the exact equations of motion, since they describe motion with only one degree of
freedom.) If we can ﬁnd the Hamiltonian, h, such that ˙θ = ∂h/∂ρ and ˙ρ =
∂h/∂θ, then
we have found an additional constant of the motion, h. Lines of constant h(θ, ρ) give the
trajectories of ions in the (θ, ρ) plane.

θ0 and ρp −

−

(19)

(20)

(21)

(22)

(23)

0.

≥

– 7 –

We begin with the case, δ = 0 (i.e., a cyclotron harmonic). Then (13) becomes

so that

u0 =

2πA cos v0,

−

u1 −
v1 −

v0 = 2πA cos u1 = 2πA cos u0 + O(A2),

θ0 = 2πA sin θ0 sin ρ0 + O(A2),

ρ0 = 2πA cos θ0 cos ρ0 + O(A2).

θ1 −
ρ1 −

These equations are Euler’s approximation to the solution of the diﬀerential equations,

˙θ = A sin θ sin ρ,

˙ρ = A cos θ cos ρ.

h =

A cos ρ sin θ.

−

[We deﬁne θj = θ(t = 2πj), etc.] These, in turn, are Hamilton’s equations for the Hamilto-
nian,

The trajectories of the ion in (θ, ρ) space, given by this Hamiltonian, are shown in Fig. 3(a).
This result is the same as that obtained by Timofeev5 using the full Hamiltonian for the
ion. Note that all particles exchange energy with the wave, but that the amount of energy
exchanged is bounded in time.

It is instructive to compare this result with standard linear theory. As we noted, our
approach is nonlinear because we repeatedly correct the unperturbed orbits. If this is not
AN . These orbits would appear as
done (almost) all the orbits are secular with ρN −
straight lines in the (θ, ρ) plane which are tangent to the curves drawn in Fig. 3(a) at the
initial positions of the ions. Because all the orbits are secular, the linear dielectric function
< τ where τ is
is divergent at a cyclotron harmonic (for kk = 0). Linear theory is valid for t
the inverse frequency of motion around the islands in Fig. 3(a). From (27) we ﬁnd τ = A−1
∼
(near the center of the islands).

ρ0 ∼

For δ = 1

2 (i.e., ω at a half harmonic of Ωi) we ﬁnd

u2 −
v2 −

u0 = 2π + 4π2A2 sin v0 cos u0 + O(A3),

v0 = 2π

4π2A2 cos v0 sin u0 + O(A3).

−

Ignoring the shift of u and v by 2π the diﬀerential equations for θ and ρ are

˙θ = πA2 sin 2ρ,

˙ρ =

πA2 sin 2θ,

−

which are derivable from the Hamiltonian,

The trajectories for this case are shown in Fig. 3(b).

h =

πA2 cos(θ + ρ) cos(θ

ρ).

−

−

The motion is very similar to the case, δ = 0, Fig. 3(a). The most important diﬀerence
is the extra factor of A in (30) as compared with (27) so that the exchange of energy with

(24a)

(24b)

(25a)

(25b)

(26a)

(26b)

(27)

(28a)

(28b)

(29a)

(29b)

(30)

– 8 –

the wave is much slower at a half harmonic. Indeed, to order A there is no exchange of
energy since the phase of the ion relative to the wave increases by about π each cyclotron
period, and so the kicks received by the ion on successive cyclotron orbits nearly cancel.
Thus, there is no contribution to the linear dielectric function from the half harmonics. We
expect the O(A2) change in the speeds of the particles in this case to lead to additional
nonlinear terms in the dielectric function which would cause a nonlinear damping of the
waves due to half-harmonic resonances.

In the general case where δ = s/p

= 0, 1

2 , we have

θ0 = 2πs + pπ2A2 cos(2ρ

−

δπ)

+ O(A3),

sin(πδ)

θp −

ρp −

ρ0 = O(A3).

(31a)

(31b)

These expressions were explicitly checked only for δ = 1
12 . The algebra
required to do the iterations and expansions of the diﬀerence equations is quite onerous, and
so was performed using the algebraic manipulation system, MACSYMA.6 We note that the
expression for ˙θ given by dividing (31a) by 2πp agrees with the expression for the frequencies
given by Eq. (43) of I. [This result in I was derived using canonical transformations on the
the Hamiltonian, (A1), and required considerably more eﬀort than (31).] The trajectories in
this case are ρ = const. [Fig. 3(c)]. In this case there is no net exchange of energy between
the particles and the wave.

12 , 1

8 , 5

3 , 3

4 , 1

8 , 1

6 , 1

V. THE STOCHASTIC TRANSITION

For ﬁnite A the motion becomes much more complicated. Here we brieﬂy discuss what
happens. The exposition is intended to complement that given in I, although there is some
overlap. General reviews of the transition to stochasticity may be found in Refs. 7–9.
We begin by noting the topological diﬀerence between the cases δ = 0, 1
2 and δ

= 0,
1
2 (Fig. 3). This leads to diﬀerences in the way that stochasticity develops, and because of
this we deﬁne the stochasticity threshold diﬀerently in the two cases.

With δ not close to 0 or 1

2 , higher-order terms in the diﬀerence equations, i.e., the
O(A3) terms in (31), cause islands to appear. The location of the islands may be derived by
θ0)/(2πp), (31a), be rational. Where these islands overlap the motion
requiring that (θp −
becomes stochastic [Fig. 2(b)]. However, the KAM (Kolmogorov–Arnold–Moser) theorem10
ensures that for suﬃciently small A some trajectories exist which span θ [again see Fig.
2(b)].
[These are KAM “surfaces” reﬂecting their dimensionality in the original problem,
although they only appear as lines in the (θ, ρ) plane.] These act as barriers, preventing ρ for
a given particle from increasing or decreasing by more that about π (since the KAM surfaces
repeat periodically in ρ). At some value of A the last KAM surface disappears, allowing
unrestriced motion in ρ. We deﬁne this value of A to be the stochasticity threshold, As. In
I the value of As was found to be about 1
4 . Recently accurate methods for determining As
have been developed by Greene,11 although applying these methods to the problem in hand
presents diﬃculties because the relevant resonances do not exist down to A = 0.

For δ equal to 0 or 1

2 , we have, for small A, all of phase space covered by islands [Fig.
3(a) and (b)]. When δ is not equal to 0 or 1
2 but is close to these values, Fig. 3(c) applies
/π)1/2, ﬁrst- and second-order
only for very small amplitudes. If A >
1
or A > (
|
islands appear. At larger amplitudes these islands can cover nearly all of phase space giving

δ
|

2δ

−

|

|

6
6
– 9 –

a picture similar to Fig. 3(a) and (b). The eﬀect of ﬁnite A in these cases is to produce
chains of islands within the main islands. These overlap close to the separatrix causing a
layer around the separatrix to become stochastic. For δ = 0 the thickness of this layer is
found12 to be on the order of

exp[

π/(2A)]

−

(32)

for small A; a similar exponential dependence is expected for δ = 1
2 . Thus, in contrast with
the previous case it is possible for ions to be heated even at low amplitudes. However, for
small A, the thickness of the stochastic layer, (32), is extremely small. This means ﬁrstly
that only a tiny fraction of particles will be in the stochastic region and secondly that those
that are will be heated very slowly. Therefore we deﬁne the stochasticity threshold in this
case as the value of A, As, for which the stochastic layer occupies a substantial fraction of
phase space. Note that this does not deﬁne a precise value of As. The deﬁnition is useful
however since (32) is a strong function of A. In I it was found that As had approximately
the same value as for δ

= 0, 1

2 , namely 1
4 .
The stochasticity threshold, As = 1

ν, which was given in I.

4 , has a simple physical interpretation. At this
value of A, the kick received by the particle on one transit through wave-particle resonance
(Fig. 1) is suﬃcient to change the phase that the particle sees when next in wave-particle
resonance by π/2 ( = 2πAs). This explanation, which is valid for r > ν, complements the
explanation in terms of trapping for the case r

≈
We end this section by looking at the eigencurves of the mapping. These are curves
in the (θ, ρ) plane which map into themselves on applying the mapping, T . A study of the
eigencurves provides another view of the stochastic transition. Again the reader is referred
to Refs. 7–9 for a fuller discussion of this. We consider only the case δ = 0. (Because of the
additional symmetries in this case, the eigencurves are easier to generate. Similar behavior
is observed for other values of δ.) When A is inﬁnitesimal the eigencurves are given by
Fig. 3(a); and Fig. 4 shows them for ﬁnite values of A. For ﬁnite but small A, most of
the eigencurves remain closed; these may be generated by iterating the mapping of a single
point many times. However, the eigencurves emanating from the hyperbolic ﬁxed points no
longer meet up. They are now inﬁnitely long open curves. They are generated as follows:
Close to the hyperbolic ﬁxed point, the mapping may be linearized. The eigencurves of the
linearized mapping are hyperbolæ. The asymptotes of the hyperbolæ are eigencurves on
which a point either moves away from or towards the ﬁxed point. These eigencurves are
called the unstable and stable manifolds respectively. Short straight line segments, which
connect a point with its image under T , are chosen on these unstable and stable manifolds.
These line segments are then repeatedly mapped forwards and backwards by applying T and
T −1; and the union of the mapped segments generates the open eigencurves. In practice,
only a few (less than 10) iterations are required. Figure 4(a) shows the eigencurves for
A = 0.3. We see that the open curves intersect each other at a ﬁnite angle, and start
oscillating as they approach the ﬁxed point. Because the mapping is area-preserving these
oscillations grow larger and larger as the ﬁxed point is approached. These curves occupy a
ﬁnite area which may be shown to be stochastic. As illustration of this we show the iteration
of a single point starting close to the hyperbolic ﬁxed point (Fig. 5). We see that it covers
nearly all the area outside the ﬁrst-order islands. All these points lie on a single eigencurve.
The area occupied by the eigencurves (i.e., the area of phase space that is stochastic) is
proportional to the angle at which the eigencurves ﬁrst intersect (approximately half way
between the ﬁxed points). This then gives another way, in addition to the method of island
overlap, of estimating the fraction of phase space that is stochastic. This angle again has

6
– 10 –

the exponential dependence on amplitude given in (32). In Fig. 4(b), A has been increased
to 0.35. Here we see the open eigencurves intersecting at a larger angle. In addition, the
elliptic ﬁxed points in Fig. 4(a) have turned into hyperbolic ﬁxed points with reﬂection [from
(B7) we ﬁnd that this happened at A = π−1
0.318]. Thus, open eigencurves emanate
from these points. However, the angle at which they intersect is so small that the area they
occupy is comparable to the thickness of the lines used to draw the ﬁgure. Eigencurves
corresponding to the original islands are still present. However, these have disappeared at
A = 0.45, Fig. 4(c). At this amplitude the two sets of open eigencurves intersect each other.
This may be seen by comparing this ﬁgure with Fig. 4(d), where we have extended one of
the eigencurves emanating from the hyperbolic ﬁxed point with reﬂection.

≈

VI. THE KRYLOV–KOLMOGOROV–SINAI ENTROPY

Having established that the ion motion becomes stochastic for A > As, we need to be
able to describe the motion above the stochasticity threshold. One of the most important
parameters in this regard is the Krylov–Kolmogorov–Sinai (KS) entropy, h. This is a mea-
sure of the local instability of trajectories and is deﬁned as the average rate of divergence
of neighboring (inﬁnitely close) trajectories. Thus, after N iterations the distance between
neighboring particles initially d0 apart is approximately d0 exp(hN ) (for d0 small and N
large).

The KS entropy is important for two reasons. Firstly, given a group of particles which
initially occupy a small region of phase space, ∆θ ∆ρ, we can estimate the number of itera-
tions for the phases, θ, of the particles to become random to be

log(2π/∆θ)/h.

(33)

Secondly, the exponential divergence of trajectories leads to a mixing of phase space, which
in turn results in the decay of the correlation function, Ck (Sec VII), and allows the motion
of the particle to be described by a diﬀusion equation.

In order to determine h we deﬁne a reference trajectory, (uj, vj). [It is more convenient
to work in (u, v) space.] We consider a neighboring trajectory, (uj + δuj, vj + δvj), where
δuj and δvj are inﬁnitesimals. Then δuj and δvj satisfy

where

If we deﬁne MN by

then h is given by

1

2πA sin vj

2πA sin uj+1

1

4π2A2 sin uj+1 sin vj!

.

Jj ≡  

−

δuj+1
δvj+1 (cid:19)

(cid:18)

= Jj

δuj
δvj (cid:19)

,

(cid:18)

−

N −1

j=0
Y

MN =

Jj,

h = Lim
N→∞

(log

ΛN |
|

/N ),

h =

,
log(ℓj+1/ℓj)
i
h

where ΛN is the largest (in magnitude) eigenvalue of MN . This deﬁnition is equivalent to9

(34)

(35)

(36)

(37)

(38)

– 11 –

ΛN |
|

Figure 6 shows log

where ℓj is the length of the vector (δuj, δvj) and the average is taken over a particle orbit.
/N as a function of n for various values of A. We see that
it does have a limiting value as N
and so h is well deﬁned. Figure 7 shows h as
a function of A for δ = 0.23. For A small, h is close to zero, because when the motion is
coherent neighboring trajectories diverge linearly, rather than exponentially. When A is still
below As, h becomes ﬁnite, since the reference trajectory was chosen in the stochastic part
of phase space (Fig. 2). As A passes through the stochasticity threshold there is a slight
drop in h. Finally, for A

As, h is on the order of log A.

→ ∞

We may derive the expression for h in the limit A
and smaller (in magnitude) eigenvalues of Jj, then for A
λj ≈ −

4π2A2 sin uj+1 sin vj,

≫
≫
µj = 1/λj.

As. If λj and µj are the larger
As we have

Furthermore, the eigenvectors corresponding to these eigenvalues are approximately ˆv and
ˆu respectively. Since the eigenvectors for diﬀerent Jj are nearly parallel to one another, the
eigenvalues of the product of the Jj are approximately the product of the eigenvalues of the
Jj; i.e.,

≫

ΛN ≈

λj .

N −1

j=0
Y

Substituting (39) into (40) we have

h =

log
h

λj |i
|

= 2 log(πA) +

log
h

,
4 sin uj+1 sin vj|i

|

where the average is taken over a particle orbit. Finally, we note that for A
As, a
particle’s orbit wanders over most of phase space, spending equal amounts of time in equal
areas of phase space (i.e., the particle’s orbit is approximately ergodic). Thus, the average
along the orbit may be replaced by a phase space average. The last term in (41) becomes

≫

0
Z
[see Ref. 3, Eq. (4.3.145)]. Thus, for A

2π

2(2π)−1

log

2 sin ψ
|

|

dψ = 0

As, we have

2 log(πA).

≫
h

≈

This is shown as a dashed line in Fig. 7.

VII. THE CORRELATION FUNCTION

We saw in the last sections that a group of particles initially close together in phase
space separate exponentially. This continues until a time on the order of h−1, (33). After
this time the phase of the particles may take on any values. We wish to ascertain the
behavior of the particles for longer times. More precisely, if we consider an ensemble of
, for large
particle trajectories, (θj, ρj), then what are the moments,
i
N ? (The brackets denote ensemble averages.)

(ρN −
h

ρN −
h

,
ρ0i

ρ0)2

Firstly, let us consider the average force on the ensemble,

ρN −
h
N

ρ0i

.

f

≡

(39)

(40)

(41)

(42)

(43)

(44)

– 12 –

f = h

ρ−N −
N

ρ0i

.

aj = ρj+1 −

ρj.

(ρN −
h

ρ0)2

=

i

N −1

N −1

i=0
X

j=0
X

.
aiaji
h

i + j
2

C

(cid:18)

, i

j

−

=

.
aiaji
h

(cid:19)

C(ℓ, k) = C(0, k)

Ck,

≡

Ck = C−k,

By shifting the origin of time by N (which leaves the diﬀerence equations invariant) we have
ρ−N i
ρ0 −
N

f = h

(45a)

,

and by reﬂecting time using the symmetry, (23), we have

From (45a) and (45b) we see that f = 0.

Turning to the second moment, we ﬁrst deﬁne an acceleration.

(In deﬁning aj, we do not treat ρ as a periodic variable.) Then we have

We deﬁne a correlation function, C, by

C has the following properties:

which follows from the invariance of the system to a shift in the origin of time, and

=

aiaji
h

. Because of (49a) the deﬁnition of Ck may include an average over a
since
single orbit, as well as an ensemble average. [We will usually use a subscript, N , to denote
the time (i.e., the iteration number), while a subscript, k, will denote a time diﬀerence.]

ajaii
h

Rewriting (47) in terms of Ck and using properties, (49), we ﬁnd

For N

we have

→ ∞

where the diﬀusion coeﬃcient,

(ρN −
h

ρ0)2

i

= N C0 +

2(N

k)Ck.

−

N −1

Xk=1

ρ0)2

(ρN −
h
, is given by

i

= 2

N,

D

D

1
2

D

=

C0 +

Ck

∞

Xk=1

and we have assumed that Ck decays suﬃciently rapidly so that the sum in (52) exists.

In order to ﬁnd Ck numerically we compute M orbits of length, L. Then Ck is approx-

imated by

Ck = (L

k + 1)−1

−

,
aℓaℓ+ki
h

L−k

Xℓ=0

where the average is now over the M orbits.

(45b)

(46)

(47)

(48)

(49a)

(49b)

(50)

(51)

(52)

(53)

– 13 –

> 1, Fig. 8(c).
∼

Figure 8 shows examples of the correlation function for δ = 0.23 and various values A.
When A < As, Fig. 8(a), Ck is highly oscillatory, and decays slowly. As A is increased above
the stochasticity threshold, the correlation time, kc, rapidly decreases, Fig. 8(b), becoming
approximately 0 for A

Note that in deﬁning the ensemble of orbits we did not specify what ρ0 was, so that dif-
ferent members of the ensemble could have diﬀerent values of ρ0. Because of the periodicity
of the diﬀerence equations, (13), in ρ, we know that ρ0
(mod 2π) is suﬃcient to determine
ρ0. Thus, the ensemble average provides an average of the initial conditions over an
ρN −
interval of 2π, which is of little consequence. Averaging along a given orbit (for A > As)
has the same eﬀect. Having performed this averaging, Ck is independent of ρ.

The situation is much more complicated in the original system described by the Lorentz
force law, (2). In that case the problem is not periodic in r, since A has a slow dependence
on r, (14). Now, we would be hiding this important dependence on r if we did not restrict
the starting positions of the orbits, r0. Similarly, we could not perform the averaging along
the orbit. Thus, Ck becomes a function of r, and it is more diﬃcult to compute, since less
averaging can be done. Finally, the diﬀusion coeﬃcient would be more diﬃcult to deﬁne
because, although
might be proportional to N for some range of N , it certainly
will not be proportional to N for large N , since the particles will be coming into regions
where A and Ck are diﬀerent.

(rN −
h

r0)2

i

These problems are all circumvented by using the diﬀerence equations. These allow a
. The dependence of the diﬀusion coeﬃcient

simple and rapid determination of Ck and
on r will be recovered through its dependence on A (Sec. IX).

D

VIII. THE DIFFUSION COEFFICIENT

D

≫

. In the limit A

We now turn to the diﬀusion coeﬃcient for the ions. We shall use (52) to deﬁne and
based on the observation
As we can obtain an estimate for
calculate
> 0 [see
of the last section that the correlation time is short in this limit, viz., Ck = 0 for
Fig. 8(c)]. In this case we have
, where the average is taken over
2 C0, with C0 =
an ensemble and down a trajectory. In the same spirit that we calculated the KS entropy,
As (Sec. VI), we shall assume that the ion trajectories are ergodic so
h, in the limit A
that the ensemble and trajectory averages may be replaced by a phase space average. Thus,
we obtain

a2
0i
h

= 1

k
|

≫

D

D

|

D

a2
= 1
0i
2 h
2 π2A2
= 1

v0)

[(v1 −

= 1
8 h
(cos u1 + cos v0)2
h

−

i

(u1 −

u0)]2

i

= π2A2(2π)−1

cos2 ψ dψ

2π

0
Z

= 1

2 π2A2.

When A is not large we expect the presence of islands to obstruct the diﬀusion of ions
leading to a value of
below (54). [This is reﬂected in the correlation function by the fact
that for small k, Ck>0 < 0; see Fig. 8(b).] Finally, for A < As diﬀusion is stopped. (Strictly
speaking this only happens when δ is not close to 0 or 1
2 , for then there are KAM surfaces

D

(54)

– 14 –

(55)

(56a)

(56b)

preventing the diﬀusion of ions. However, as discussed in Sec. V, the diﬀusion for A < As
for δ close to 0 or 1

to have the form,

2 is extremely slow.) We therefore expect
= 1

D

2 π2A2g2(A),
D
< As) = 0.
A
1, and g(
|
|

where g(A)

)
| → ∞
We test these ideas out by numerically ﬁnding

A
1, g(
|

→

≤

δ. We determine

by ﬁrst ﬁnding Ck using (53) and then computing

D

, and hence g(A), for various values of

D

K

Xk=1

= 1

2 C0 +

D

qkCk,

D
directly.

D

where qk is a windowing function given by

qk =

1,

1
2




1 + cos

π

K ′

k
−
K + 1

,

K ′

(cid:19)(cid:21)

for 0 < k

≤
for K ′ < k

K ′,

K.

≤

(cid:20)

(cid:18)



−
The reason for introducing a windowing function into (56) is to suppress the eﬀect of the
oscillations seen in Fig. 8(a). Criteria for choosing K and K ′ are K
1 for A < As
−
(in order to suppress the oscillations in Ck), K ′
kc for A > As (so as to include the major
contribution to
L, where L is the length of the orbits used to calculate
Ck, (53). This last condition arises because, from (53), the number of samples entering into
Ck is M (L
k + 1) which we wish to be large in order to suppress the statistical ﬂuctuations
in Ck.

), and ﬁnally K

K ′

≫

≫

≪

−

D

Note that if we had computed

ρ0)2 for M orbits, there
directly by measuring (ρL −
would be O(M −1/2).
. Thus, the error in
would be only M samples contributions to
When computing
using Ck we eﬀectively include all possible shorter orbits that make up
the orbit ρ0 to ρL. There are about L/kc independent orbits in an orbit of length, L. The
is then O[(kc/M L)1/2] which can be much less than the error when computing
error in

D

D

D

D

Figure 9 shows g(A) for three value of δ. Although g has the general form discussed
,
earlier, there are some anomalies. Instead of approaching unity monotonically as A
→ ∞
there is a tendency for g to oscillate about unity with a period of unity in A. This is
particularly noticeable with δ equal to 0.11 and 0.47. The oscillations are about
20% for
1
22. Also there is a very strong peak in g(A) for
δ = 0.47 and A = 0.55. Both these phenomena are due to the existence of “accelerator”
modes, or island systems for which the ion, rather than returning to its original island,
returns to an island displaced upwards or downwards in ρ by an integer multiple of π.

2 and about

10% for 20

≤

±

≤

±

≤

≤

A

A

Some of these accelerator modes are studied in Appendix B. From (B4) with m = 1
and n = 0 we ﬁnd that there exists a stable accelerating ﬁxed point for δ = 0.47 and
0.53 < A < 0.5971. So for A = 0.55 there are orbits in the island system for which
all lay outside this island system, they
ρN ∼ ±
could wander close to the island and become temporarily trapped close to the island (for up
to several hundred iterations). This results in a very slow decay of the correlation function
(Fig. 10), and an anomalously high diﬀusion coeﬃcient.

πN . Although the orbits used to calculate

D

As A is increased, a new set of accelerator modes appear at values of A equal to p
δ,
where p is an integer. The islands disappear by becoming unstable, shortly afterwards. This
seen in Fig. 9. Similar oscillation have been observed
leads to the oscillatory behavior in

±

D

– 15 –

by Chirikov9 for the so-called standard mapping. He also associated these oscillations with
the presence of accelerator modes.

In our case there are probably no accelerator modes present in the cases for which g(A)
is plotted in Fig. 9 (except the case previously discussed, i.e., δ = 0.47, A = 0.55). The
oscillations may however arise from the unstable ﬁxed points that remain after the islands
turn unstable. Such unstable ﬁxed points may marginally increase the correlation time and
hence the diﬀusion coeﬁcient. As δ is increased these ﬁxed points become more unstable
and the eﬀect is diminished. Choosing A in the small windows where the accelerator modes
exist would have given peaks in g(A) similar to the one at δ = 0.47 and A = 0.55. We
may argue that the peaks in g(A) that occur when the accelerator modes are present are
unphysical. In Appendix B we establish that the window in A for which these modes exist
is quite narrow. Now, as an ion is being accelerated or decelerated by one of these modes,
ρ and r, (6a), will be changing. Hence, after a while we must recognize that A, which is a
function of r, (14), will also change. This will “switch oﬀ” the accelerator modes after only
a few iterations, and the correlation times will similarly be limited. The eﬀect of the slow
change of A (which was ignored in deriving the diﬀerence equations) will be to remove the
peaks in g(A), leaving only the gentle decaying oscillations in g(A).

For these reasons g(A) was ﬁtted by the simplest smooth curve that reasonably ﬁts the

data. Figure 9 shows the functional form chosen, viz.,

g(A) = max

A2

A2
s

−
A2

(cid:18)

, 0

,

(cid:19)

with As = 1
4 . This form of g will be checked in the next section by solving the resulting
diﬀusion equation, and comparing the results with the solution of the exact equations of
motion, (2).

IX. DERIVATION OF A DIFFUSION EQUATION

With A > As we expect the distribution, f (ρ, N ), of a group of ions after N iterations
to spread according to a diﬀusion equation. We will brieﬂy outline the arguments that lead
to this result.

Suppose m is greater than the correlation time, kc, and let us look at the results of the
mapping only at times, N , which are an integer multiple of m. Then the mapping, T , may
be approximated by a Markovian process, which is described by a transition probability,
ρ2, N ) dρ2, which is the probability the a particle is found in the range, (ρ2, ρ2 + dρ2),
P (ρ1 |
given that it was at ρ1, N iterations earlier. P must satisfy

P (ρ1 |

ρ2, N ) =

dρ P (ρ1 |

ρ, k)P (ρ

ρ2, N

k)

|

−

Z

for all k such that k is a multiple of m and 0 < k < N .

For long times f will be spread over several periods in ρ.

In that case we are not
interested in the details of f that occur over the period, 2π, in ρ. We retain the important
physical eﬀects when we average f and P over a period in ρ. (Precisely this averaging is
carried out in computing Ck and
in Secs. VII and VIII.) In that case P only depends on
the diﬀerence, ρ2 −

D
ρ1, and we have
P (ρ1 |

ρ2, N ) = P (ρ2 −

ρ1, N ).

(57)

(58)

(59)

– 16 –

a1(N )/N = 0,

a2(N )/N = 2

,

D

∂P
∂N

=

∂2
∂ρ2 D

P.

∂f
∂N

=

∂
∂ρ D

∂
∂ρ

f,

The evolution of the distribution of ions, f , is given by

f (ρ, N ) =

dρ1 f (ρ1, N1)P (ρ

ρ1, N

N1).

−

−

Z

The moments of P ,

are the same as the moments,

an(N )

dρ ρnP (ρ, N ),

≡
ρ0)n

(ρn −
h

Z
, studied in Sec. VII. Thus, we have
i

for N

m.

≥

Following the analysis of Chandrasekhar13 and Wang and Uhlenbeck14 we may use (58)

to derive a Fokker–Planck equation for the evolution of P for N

kc:

≫

Substituting for f from (60) gives

where we have used the result that
is independent of ρ in order to write the diﬀusion
equation in its more usual form. Incidentally, although we derived (64) for A > As it clearly
are then zero, and f does not evolve.
gives satisfactory results for A < As, because g and
We now undo the normalizations made earlier. Writing N = t/2π and converting ρ to

D

D

r using (6a) we have

∂f
∂t

=

1
r

∂
∂r

r D
2π

∂ρ
∂r

−2 ∂
∂r

f,

(cid:18)
(r)/H (1)

(cid:19)
for r > ν + ( 1

R

−

dvk

H (1)′
ν
(cid:12)
(cid:12)
(cid:12)

ν2)1/2/r =

ν (r)
(cid:12)
(cid:12)
(cid:12)

where ∂ρ/∂r = (r2
2 ν)1/3. In writing (65) in
this form we have replaced the ﬁrst derivative operator in (64) by the cylindrical divergence
operator, in order to ensure conservation of particles. (The normalization of f is such that
dr 2πrf = 1. We will suppress the dependence of f on the velocity parallel to B, vk,
is now a function of
until we consider the eﬀects of collisions in Secs. X–XII.) Note that
R
with the second
r through A, i.e.,
derivative operator between (63) and (64). The argument for having
where it is in (65) is
that in the steady state f should be a constant in the stochastic region. This is a result of
the approximate ergodicity of the motion, when described by the exact equations of motion,
(2), and was observed in the simulation described in I. We shall presently compare the
results obtained by the diﬀusion equation with that simulation. Rewriting (65) using (55)
and (14) we obtain

[A(r)], so that we must justify our commuting

=

D

D

D

D

D

where

∂f
∂t

=

1
r

∂
∂r

rD

f,

∂
∂r

D(r) = D
2π

−2

∂ρ
∂r

(cid:18)

(cid:19)

=

π
4

αν
r

(cid:16)

g(A)

2

(cid:17)

H (1)

ν (r)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(60)

(61)

(62a)

(62b)

(63)

(64)

(65)

(66)

(67a)

– 17 –

for r

ν. We extend the deﬁnition of D to r < ν as follows:

≥

D(ν),

D(r) = 


0,

D(ν)[r

(ν

−

−

for ν

for ν

−

−

for r < ν

√α

r < ν,

≤

≤
2√α.

−

−

2√α)]2/α,

2√α

r < ν

√α,

(67b)

When numerically computing D we use the approximate forms for H and H ′,



(68a)

(68b)

(68c)

for r

≥

ν + ( 1

2 ν)1/3 and

(2/π)1/2(r2

ν2)−1/4,

(2/π)1/2(r2

ν2)1/4/r,

−

−

H (1)
(cid:12)
(cid:12)
(cid:12)
H (1)′
ν

ν (r)
(cid:12)
(cid:12)
(cid:12)
(r)

≈

≈

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

H (1)
(cid:12)
(cid:12)
(cid:12)

ν (r)
(cid:12)
(cid:12)
(cid:12)

≈

(cid:12)
(cid:12)
(cid:12)

H (1)

ν [ν + ( 1

,

2 ν)1/3]
(cid:12)
(cid:12)
(cid:12)

−

for ν

r < ν + ( 1

2 ν)1/3.

2 ν)1/3 and similarly for H ′. We will show the typical form of D in Sec. XI.
≤
Because of the restrictions on r in the derivation of the diﬀerence equations (Sec. II),
we must justify (67) for r < ν + ( 1
In this range, the choice of the form of D is
2 ν)1/3
motivated by the following considerations: Firstly, in the region, ν
trapping4 plays a dominant rˆole. This trapping is similar to the trapping of a particle by a
wave in the absence of a magnetic ﬁeld and its eﬀect is to cause a rapid mixing of f in this
region. This is modeled by (67) since D is approximately constant and has its maximum
value in this region. Secondly, we ﬁnd that particles are fed quite slowly into the trapping
√α. Finally,
region from below and this is given by the form of D for ν
the motion is coherent for r < ν

−
2√α in which case D is 0.

√α < r < ν + ( 1

2√α < r < ν

−

−

In order to check (66) and (67) we compare the results obtained using these equations
with the results of the simulation described in I. In the latter case the orbits of 50 particles
were found by integrating the exact equations of motion, (2). Because of the small number of
particles involved the comparison is most easily made if we solve (66) using a simple Monte
Carlo method described in Appendix C. It might seem as though we are back-tracking here,
by going back to diﬀerence equations. However, the Monte Carlo method for (66) diﬀers from
the original equations, (13), in two respects: ﬁrstly, the randomness is explicitly inserted;
and, secondly, we allow for the variation of D with r. This latter aspect of the solution we
present here allows us to justify the placement of D with respect to the derivative operators
in (66). Figures 11 and 12 show the comparison.
In each case we follow the motion of
N = 50 particles with initial perpendicular velocities, r0 = 23, and with α = 20, ν = 30.23.
The general features of these ﬁgures are discussed in I. For our purposes we see that there
is good agreement between the two simulations. In particular, note the agreement in the
short time behavior, Fig. 11(c) and (d), and in the averaged distribution function, Fig. 12.
< ν in (67b) and the
These two points respectively conﬁrm the form taken for D for r
∼
placement of D with respect to the derivative operators in (66). We conclude that (66) with
D given by (67) accurately models the diﬀusion of ions in the presence of a perpendicularly
propagating electrostatic wave.

We may write D in dimensional form by multiplying (67) by Ω3

i /k2

⊥ to give

– 18 –

(69)

(70)

D(v⊥) =

2

g2(A)γ,

H (1)

ν (r)
(cid:12)
(cid:12)
(cid:12)
2vtr)]2/v2
tr,

(cid:12)
(cid:12)
(cid:12)
(vph −

π
4

(E0/B0)2ω2Ωi
⊥v2
k2
⊥




D(vph),
D(vph)[v⊥ −
0,


vph,

for v⊥ ≥
vtr ≤
for vph −
for vph −
2vtr ≤
for v⊥ < vph −

v⊥ < vph,
v⊥ < vph −
2vtr,

vtr,

where g(A), ν, and r are given by (57), (14), and (3), vph = ω/k⊥, and vtr is the trapping
velocity,

vtr = (qiE0/mik⊥)1/2.

In (69) we have included an additional factor, γ, which is deﬁned as the fraction of time
that the ion orbits spend in the region of lower hybrid waves. This reﬂects the fact that the
ion can only diﬀuse a fraction, γ, of the time. In order to include the spatial variation of the
lower hybrid waves in such a simple way, two conditions must be satisﬁed. The ions must
spend many cyclotron periods in the lower hybrid waves, so that the diﬀerence equations are
applicable, and the motion is described by (64). The opposite limit, where the ion spends
a small fraction of a cyclotron period in the wave, has been considered by Lazarro15 in the
context of heating a fast beam of ions. Secondly, we must be able to model the lower hybrid
wave as a product of a single k component and a square-wave envelope. The ﬁrst condition
is usually satisﬁed in cases of practical interest and, because the lower hybrid waves travel
in well-deﬁned rays,16 the second condition is also normally satisﬁed. In cases where the
envelope of the lower hybrid waves is not a square wave, the deﬁnition of D, (69), may be
replaced by the average of (69), without the factor, γ, over the ion’s orbit. For a circulating
ion in a tokamak which covers a magnetic surface ergodically, γ is approximately the ratio
of the area of the intersection of the lower hybrid ray with the magnetic surface to the total
area of the magnetic surface. This ignores the ﬁnite extent of the lower hybrid wave in
the perpendicular direction. When this is included, γ is reduced since the cyclotron orbit
must be completely in the lower hybrid ray for the diﬀerence equations, (13), to hold. The
diﬀusion equation for the ions written in unnormalized form becomes

∂
∂v⊥
In the next sections we study the properties of this equation when we add a Fokker–Planck
collision term.

∂
∂v⊥

1
v⊥

∂f
∂t

v⊥D

(71)

f.

=

X.

INCLUSION OF COLLISIONS

We have seen that the ions can irreversibly exchange energy with the wave. However,
because ω/k⊥ is usually several times the ion thermal speed, only the tail ions are aﬀected.
Bulk heating only takes place when these ions collide with the background. We investigate
this process by including a Fokker–Planck collision term in (71) to give

∂f
∂t

=

1
v⊥

∂
∂v⊥

v⊥D

f +

∂
∂v⊥

∂f
∂t

.

(cid:18)

(cid:19)c

Since only a relatively few tail particles are aﬀected by the wave we can neglect the tail-tail
collisions when determining (∂f /∂t)c. We can thus linearize this term by assuming the the
background distributions of ions and electrons are Maxwellians. We then obtain17

(72a)

(72b)

(∂f /∂t)c =

˙Ji/β ,

−

β ∇

X

– 19 –

where β is a species label (i or e),

Jα/β =

−

mα
mα + mβ

να/β
s vfα +

1
4

να/β
⊥ v2

vfα

∇

(cid:18)
and expressions for the collision frequencies, ν, can be found in Ref. 18.

(cid:19)

+

1
2

να/β
k −

1
4

να/β
⊥

vv ˙
∇

vfα,

(72c)

We next simplify (72) by reducing it to a problem in only one velocity dimension, v⊥,
by integrating (72a) over vk. The procedure we follow for doing this is very similar to that
employed by Fisch19,20 to derive a one-dimensional Fokker–Planck operator in vk in order
to study rf-driven currents. When performing the integral over vk the term involving J α/β
drops out. We then need only to evaluate
⊥ . In order to do this we make three
assumptions: Firstly, we assume that f (= fi) has the form,

dvk J i/β

−

k

R

f (v⊥, vk) = F (v⊥)(2πTi/mi)−1/2 exp(

1

2 miv2

k/Ti);

−

(73)

i.e., the dependence of f on vk is that of a Maxwellian. Secondly, we assume that v2
⊥ ≫
Ti/mi. This allows us to replace v by v⊥ in the expressions for the collisions frequencies, so
that they drop out of the integral. Lastly, we assume that the background temperatures are
all equal so that Tβ = Ti. (Without this assumption additional sources and sinks of energy
are required to maintain an equilibrium.) Then we have

dvk J i/β

⊥ = Cβ ∂F/∂v⊥ + (miv⊥/Ti)Cβ F + O[Ti/(miv2

⊥)],

−

Z

where

and we have used18

Cβ = 1

2 νi/β

k v2

⊥ + 1

4 νi/β

⊥ Ti/mi,

mα
mα + mβ

να/β
s =

mαv2
Tβ

1
2

να/β
k

.

Substituting these results into the integral of (72a) over vk gives

∂F
∂t

=

1
v⊥

∂
∂v⊥

v⊥

D

+ C

∂F
∂v⊥

(cid:20)

∂F
∂v⊥

+

v⊥
v2
ti

F

,

(cid:19)(cid:21)

(cid:18)

β Cβ and v2

ti = Ti/mi. If D = 0, we recover a Maxwellian for F . Thus, we
where C =
shall use (77) to solve for F for all v⊥ even though it was derived only in the high velocity
P
limit. We expect that this will not entail much additional error as long as D is ﬁnite only
where (v⊥/vti)2 is large.

(74)

(75)

(76)

(77)

– 20 –

XI. NUMERICAL SOLUTION OF FOKKER–PLANCK EQUATION

A number of approximations need to be made in the derivation of the one-dimension-
al Fokker–Planck equation, (77). These leave the accuracy of (77) open to question. In
particular the factorization of f by (73) is not easy to rigourously justify. In this section we
compare the numerical solutions of the one-dimensional and two-dimensional Fokker–Planck
equations, (77) and (72). A similar, but more extensive, comparison has been carried out21
for the parallel one-dimensional Fokker–Planck equation for the electrons with a parallel
quasilinear diﬀusion term, derived by Fisch.19,20 For reasons that we will discuss we expect
better agreement in the present case. Therefore, we content ourselves with presenting here
the solution for one particular case.

⊥ −

piv2

3(ω2

ti/ω4)k4

Consider a hydrogen plasma with ion density, n0 = 1020 m−3, magnetic ﬁeld, B0 =
4 T, and temperature, Te = Ti = 2 keV. Let the lower hybrid wave be described by
ω/(k⊥vti) = 3.5, ω/ωlh = 1.3, and E0 = 106 V/m. The frequency of such a wave is
2.13 GHz. Its parallel wavenumber may be found by solving the dispersion relation Kkk2
k +
K⊥k2
⊥ = 0, where Kk and K⊥ are elements of the cold plasma dielectric
tensor. This gives ω/(kkvte) = 5.25 and a parallel index of refraction, nk = 3.06. This
wave represents a typical Fourier component of a lower hybrid wave near the center of the
tokamak, but before it has reached the point of thermal wave conversion. Note that, because
of the high value of ω/(kkvte), we expect electron Landau damping to be negligible. The
normalized parameters are then found from (3) to be ν = 35, α = 5.71. We take the extent
of the lower hybrid ray in the parallel direction to be ∆z = 0.4 m, the major radius of the
tokamak to be R = 2 m, and the angular extent of the wave in the poloidal direction to be
∆θ = π/4. The geometrical factor, γ, appearing in (69) is given by

∆θ
2π
[As discussed in Sec. IX, this value of γ should be slightly reduced to account for the ﬁnite
perpendicular extent of the waves. However, (78) is suﬃciently accurate for illustrative
purposes.] Substituting these values into D, (69), at v⊥ = ω/k⊥ gives

∆z
2πR

1
251

(78)

≈

=

γ

.

where we have written D in terms of a collisional diﬀusion coeﬃcient v2
ion collision frequency for thermal particles

tiνi/i

0

and νi/i
0

is the

D(ω/k⊥) = 1.5 v2

tiνi/i
0 ,

νi/i
0 =

λiiω4
pi
4πn0v3
ti

.

We take the Coulomb logarithm to be λii = λie = 15. With our parameters νi/i
×
103 s−1. The full shape of D is given in Fig. 13. This is used in the numerical integrations
of the Fokker–Planck equations.

0 = 4.31

We now solve the one-dimensional and two-dimensional Fokker–Planck equations, (77)
and (72), numerically. At t = 0 both f and F are taken to be Maxwellians with temperature,
Ti. The diﬀusion coeﬃcient is turned on with a linear ramp function between t = 0 and
t = (νi/i

0 )−1 and is kept constant thereafter.
Figure 14 shows the steady-state distributions. [In plotting the perpendicular distribu-

tion function in the two-dimensional case we have deﬁned

(79)

(80)

(81)

F (v⊥) =

dvk f (v⊥, vk).

Z

– 21 –

(82)

(83)

(84)

Note that this is consistent with (73).] Although the dependence of f on vk is not that
of a Maxwellian, the two results for F (v⊥) are in close agreement. The major diﬀerence
is that the tail of the distribution function is characterized by a temperature of Ti in the
one-dimensional case, but by about 1.16 Ti in the two-dimensional case.

The power dissipated by the wave is deﬁned by

while the power lost by the test distribution to the background distributions is

Pd =

2πn0mi

−

Z

v2
⊥D ∂F/∂v⊥ dv⊥,

in the two-dimensional case and

Pc = n0mi

v ˙Ji/β dv

β

Z X

Pc = 2πn0mi

⊥C[ ∂F/∂v⊥ + (v⊥/v2
v2

ti)F ] dv⊥

Z

in the one-dimensional case. These are plotted as a function of time in Fig. 15. The most
important quantity we wish to know is the steady-state power dissipation, P . As t
,
→ ∞
we have P = Pd = Pc. We see that there is close agreement between the one-dimensional
and two-dimensional values for P . (They diﬀer by about 3%.) However, the solution to
the one-dimensional equation reaches a steady state about 2 times faster than that of the
two-dimensional equation. From Fig. 15(a) we see that Pd nearly reaches its steady-state
1.4 ms, whereas Pc (and f also) reaches a steady state on a time
value at t = τd ≈
scale, τc, which is about 60/νi/i
0

or 14 ms.

6/νi/i

0 ≈

The agreement between the one- and two-dimensional treatments in the power dissi-
pated is much better than observed in the case of the parallel one-dimensional Fokker–Planck
equation for the electrons.21 This is so because the pitch-angle scattering terms, which are
the principle reason that f deviates from the form assumed in (73) are approximately 4
times less important in the case considered here. Two eﬀects contribute to this factor of
4: In our case electrons do not cause appreciable pitch-angle scattering; whereas, in the
other case, ions and electrons contribute equally. The other eﬀect is geometrical in origin
and arises because the perpendicular plane has two degrees of freedom, as opposed to the
parallel direction, which has only one.

We conclude that the one-dimensional Fokker–Planck equation, (77), gives accurate
results for the steady state distribution and for the power dissipated in the steady state,
P . The agreement on the time scales is worse, although we expect the one-dimensional
equations to give qualitatively correct results here.

XII. ANALYTIC SOLUTION OF THE ONE-DIMENSIONAL EQUATION

We now discuss the analytical solution of the one-dimensional Fokker–Planck equation,
(77). We shall be mostly concerned with the steady-state solution, since this is of the most
practical interest, and accurately approximates that given by (72). We will brieﬂy consider
the time scales given by (77). The methods we use and results we obtain are very similar to
those of Fisch,19,20 who treats the parallel one-dimensional Fokker–Planck equation. Most
of the analysis will be carried out for general collision term, C. We will however sometimes
need to know the functional dependence of C on v⊥. We shall therefore give the form of

vte. Using the forms for να/β
C in the limit vti ≪
assuming that Te = Ti, which is required in the derivation of (77), and λie = λii we have

given in Ref. 18 and

and να/β

v⊥ ≪

⊥

k

– 22 –

C = νi/i

0 v2
ti

3
2

v3
ti
v3
⊥

(cid:18)

+

v3
ti
v3
0 (cid:19)

,

v3
0
v3
ti

=

9Zi
2(2/π)1/2

1/2

,

mi
me (cid:19)

(cid:18)

v0
vti

=

6.23,
6.99,
7.48,

(

for hydrogen,
for deuterium,
for tritium.

where νi/i
0

is given by (80) and

or

The contributions of Ci and Ce to C are given by the ﬁrst and second terms in parentheses
in (85).

The steady-state solution to (77) is20

F (t

) = F0 exp

→ ∞

−

0
Z

v⊥

v⊥/v2
ti
1 + D/C

dv⊥,

where F0 is a normalization constant determined by

If D is only non-zero for v2

Z
v2
ti then

⊥ ≫

2πv⊥F dv⊥ = 1.

F0 ≈

(2πv2

ti)−1.

The power dissipated in the steady state is given by (82),

Z
This power dissipation is divided between the electron and ion backgrounds according to

P =

2πn0mi
v2
ti

Dv3
⊥
1 + D/C

F dv⊥.

Pβ =

2πn0mi
v2
ti

Z

CβDv3
⊥
C + D

F dv⊥,

where Pβ is the power deposited in the background species, β.

Equation (89) may be evaluated in two limits. Firstly, in the collision dominated regime,
C for all v⊥, F is approximately a Maxwellian and (89) becomes

for which D

≪

n0mi
v4
ti Z
If D(v⊥) = 0 for v⊥ < v1 and D(v⊥)
integral may be approximated by Laplace’s method to give

⊥ exp

Dv3

P =

ti (cid:19)

−

≈

(cid:18)

v2
⊥
2v2

dv⊥.

D0 (a constant) for v1 ≤

v⊥

< v1 + v2
∼

ti/v1, the

If v3

1 ≪

v3
0, nearly all of this goes to ion heating.

P

≈

n0mi(v1/vti)2D0 exp(

1

2 v2

1/v2

ti).

−

(85)

(86a)

(86b)

(87a)

(87b)

(88)

(89)

(90)

(91)

(92)

– 23 –

v2

v1

Z

Cv⊥
Dv2
ti

dv⊥ ≪

1,

The second limit we shall consider is the “plateau” limit, in which a plateau forms on
C otherwise. If D also

F . Suppose D = 0 for v⊥ < v1 or v⊥ > v2 (with v2 > v1) and D
satisﬁes

≫

then F is approximately constant between v1 and v2. Assuming v2
given by (88), (89) becomes

1 ≫

v2
ti, so that F0 is

P =

exp

n0mi
v4
ti

v2

v2
1
2v2

−

(cid:18)

ti (cid:19) Z

v1

Cv3

⊥ dv⊥.

Substituting for C from (85) we have

2 n0miνi/i

P = 3

4 (v4
where the ﬁrst and second terms in brackets are the contributions of P to the ion and
electron heating respectively.

0 vti[(v2 −

v1) + 1

v4
1)/v3

0] exp(

1/v2

2 v2

2 −

(95)

ti),

−

1

The time scales may be readily computed for this case. Since the time scales derived
from the one-dimensional equation are not very accurate, we shall merely quote the results.
The derivation closely follows that given in Ref. 19. The time for the distribution to ﬂatten
between v1 and v2 due to D is

If v1(v2 −

v1)

≫

v2
ti, the time scale for particles to collisionally ﬁll in the plateau is
ti/[v2

1 C(v1)],

τc = 1

1)v2
v2

or substituting for C, (85), with v3

τd = (v2 −

v1)2/D.

2 (v2
2 −
v3
0

1 ≪
τc = 1

3 (v2

2 −

v2
1)v1/(v3

tiνi/i
0 ).

The time scale for the saturation of Pc is τc, while τd is the time at which Pd nearly reaches
its steady-state value. For t > τd the power required for the wave to accelerate the ions
into the plateau decreases, while the power to maintain them there increases. Thus, Pd is
roughly constant for t > τd.

Many cases of interest will not be in the collisional or plateau limits. However, we may
still obtain approximate results by judiciously taking one or other limit. For instance, if
we consider the case treated in the previous section, we see that a plateau has formed over
part of the range where D is ﬁnite, Fig. 14(b). The plateau limit has some validity in this
case since D cuts oﬀ quite sharply at the low velocity end, Fig. 13, and so the height of the
plateau is fairly well determined. We take v1 to be given by

and v2 by

(Thus, at v2, F is a factor, e, lower than the plateau height.) These give v1 = 3.1 vti and
v2 = 5.9 vti, approximately. We then obtain

(93)

(94)

(96)

(97)

(98)

(99a)

(99b)

(100)

D(v1) = C(v1)

v2

ω/k⊥

Z

Cv⊥
Dv2
ti

dv⊥ = 1.

P

5

≈

×

10−2 n0miv2

tiνi/i
0 .

– 24 –

About 70% of this goes to heating the ions. Equation (100) is fairly close to the observed
10−2, Fig. 15(a). By far the most sensitive factor
value for which the numerial factor is 3.8
in determing P is v1, since the height of the plateau depends exponentially on v1. More
accurate estimates of the plateau height are possible. However, if a more accurate result
that (100) is required, it is probably easiest just to evaluate (87) and (89) numerically.

×

With these values of v1 and v2 the time scale become τd = 5/νi/i
0

[taking D to be given
by (79)] and τc = 26/νi/i
0 . These agree quite well with the results of the numerical solution
of (77) given in Fig. 15(b). However, as we noted these times (and, in particular, τc) diﬀer
from the times given by the two-dimensional Fokker–Planck equation.

XIII. DISCUSSION

We have computed the rate of diﬀusion of ions in perpendicular velocity space in the
presence of a uniform magnetic ﬁeld and a perpendicularly propagating electrostatic wave
for which ω
Ωi. The diﬀusion coeﬃcient is given by (69). From the results of I, it is seen
≫
that this diﬀusion coeﬃcient also applies to diﬀusion in a lower hybrid wave (for which kk is
k⊥) in a weakly inhomogeneous magnetic ﬁeld. The eﬀect of nonuniformity
ﬁnite, but kk ≪
of the lower hybrid wave is modeled by introducing the geometrical factor, γ, into (69).

In order to determine the heating rate, collisions are included, and a one-dimensional
Fokker–Planck equation, (77), is derived. From this the steady-state power dissipation, P ,
may be found, (89). Provided ω/(k⊥vti) becomes suﬃciently small (on the order of 4) this
may result in strong damping of the lower hybrid wave and eﬃcient heating of the ions.
(See the example in Sec. XI.)

These results may be used in a simulation of lower hybrid heating with a transport
code, provided the time scale for the evolution of the plasma exceeds τc. The quantities, Pe
and Pi, (90), which represent the powers deposited per unit volume, would then appear as
source terms in the equations for the electrons and ions. The wave would obey an evolution
equation

vgr ∂W (r, t)/∂r =

P (r, t)/γ,

−

(101)

where W is the energy density of the wave, r is the minor radius of the tokamak, and vgr
is the radial group velocity. In this equation t is a parameter. P and W would vary with
time as the background distributions evolve.

Lastly we consider the question of particle transport due to stochastic heating. Firstly,
there is the change in the transport coeﬃcients due to the altered distribution function of
the ions, Fig. 14. Since the heating initially takes place in the perpendicular direction, this
would lead to an increase in the number of trapped ions, which may have a deleterious
eﬀect on the transport. Secondly, the equations of motion, (2), give a shift in the guiding
centers of the ions. The amount of this shift is most easily calculated from the Hamiltonian,
I2 is the x guiding center position. (There is no shift in the y guiding center.)
(A1), since
Thus, we have
∆I2 = ∆I1/ν (after averaging over a cyclotron period) or, undoing the
normalizations

−

−

∆x = (k⊥/ω) ∆µ ˆk × ˆB,
2 miv2

where µ is the magnetic moment, 1
⊥/(qiB0). When considering heating by the injected
lower hybrid wave (rather than parametric decay products) k is mainly in the radial direction
and so ∆x is mostly in the poloidal direction. So this eﬀect does not lead to any outward
transport of ions.

(102)

– 25 –

ACKNOWLEDGMENTS

Rechester for useful discussions.

76–C–02–3073.

The author wishes to thank N. J. Fisch, J. M. Greene, J. A. Krommes, and A. B.

This work was supported by the U. S. Department of Energy under Contract No. EY–

APPENDIX A: DIFFERENCE EQUATIONS FROM THE HAMILTONIAN

In this appendix we derive the diﬀerence equations, (13), from the Hamiltonian for the
ion. Using this approach it is easy to establish what approximations are made. In I it was
shown that the motion of an ion in the ﬁelds, (1), is governed by the Hamiltonian,

H = I1 + νI2 −

α sin[(2I1)1/2 sin w1 −

w2]

= I1 + νI2 −

α

Jm[(2I1)1/2] sin(mw1 −

w2),

(A1)

∞

m=−∞
X

where the normalizations are the same as used in (2), Jm is the Bessel function of order m,
y = (2I1)1/2 sin w1, and x =
(2I1)1/2 cos w1. The action variable, I1, is related to the
I2 −
Larmor radius, r (3c), by I1 = 1
2 r2. We now perform a series of transformations, similar to
those made in Appendix C of I, to bring the sum in (A1) into the form of an inﬁnite sum
of the product of two trigonometric terms. Hamilton’s equations of motion may then be
written in terms of delta functions.

−

We ﬁrst transform (A1) to hatted variables using the generating function,
F2 = ˆI1(nw1 −

w2) + ˆI2w2,

where n is given by (15). Equation (A1) then becomes

ˆH =

δ ˆI1 + ν ˆI2 −

−

α

Jm[(2n ˆI1)1/2] sin

m
n

ˆw1 −

1

−

m
n

ˆw2

.

(cid:17)
Since ˆw1 is slowly varying, whereas ˆw2 is still rapidly varying (assuming n
contributions to the sum in (A3) come from m
in the sum to obtain

1) the dominant
n. Recognizing this we replace m by n + k

≫

≈

(cid:16)

i

h

m
X

(A2)

(A3)

ˆH =

δ ˆI1 + ν ˆI2 −

−

α

N

Xk=−N

Jn+k[(2n ˆI1)1/2] sin

1 +

ˆw1 +

ˆw2

,

(A4)

k
n

(cid:19)

(cid:20)(cid:18)

k
n

(cid:21)

( 1
2 ν)1/3.]
where N is some integer satisfying 1
≪
As a result of this inequality we approximate the factor (1 + k/n) by unity. We next use
the large argument expansion of the Bessel function

n. [It is convenient to choose N

≪

N

≈

Jm(r) = (2/π)1/2(r2

m2)−1/4

−

m cos−1(m/r)
(A5)
[Ref. 3, Eq. (9.3.3)], which is valid for r > m + ( 1
2 m)1/3. In order to put the Hamiltonian
into the required form we need to be able to do three things: approximate all the Bessel

m2)1/2

cos[(r2

π/4]

−

−

−

×

– 26 –

−

−

≈

≫

≫

n2

n2

N 4. With N

m2)−1/4 by (r2

ν2)−1/4, which requires r2

functions in (A4) using (A5), which requires r > (n + N ) + ( 1
2 n)1/3; replace the amplitude
factor (r2
N n; and to Taylor-expand
−
the argument of the cosine in (A5) in k about k = δ, keeping only the ﬁrst two terms, which
( 1
requires r2
2 ν)1/3.
The Bessel functions in (A4) then become
Jn+k(r) = (2/π)1/2(r2

−
( 1
2 ν)1/3 all these inequalities become r

−
where r = (2n ˆI1)1/2, R = g(r)
π/4, and φ = cos−1(ν/r).
ν2)1/2
We shall regard the r’s appearing in the amplitude factor and in the deﬁnition of φ as
being parameters. This requires that neither of these quantities change signiﬁcantly when
r changes by a period of the Bessel function, 2π(∂R/∂r)−1. The conditions on r and ν
already assumed are suﬃcient to guarantee this. In addition, if α exceeds the stochasticity
threshold, r may change by more than the period of the Bessel function, in which case we
must re-examine our assumptions about the constancy of the amplitude factor and φ. We
shall return to this point after we have derived the diﬀerence equations.

−
cos−1(ν/r)

ν2)−1/4 cos(R

kφ + δφ),

(A6)

(r2

≫

−

−

−

−

≡

ν

We now transform to a new set of variables, distinguished by tildes, using the generating

(A7)

function,

where G( ˆI1)

≡

F3 =
g[(2n ˆI1)1/2]. This gives

G( ˆI1) ˜w1 −

−

ˆI2 ˜w2,

(A8)
We solve both of these locally by expanding ˆI1 about some point ˆI10 and keeping only the
terms involving G′( ˆI10). Thus, we obtain

ˆw1 = G′( ˆI1) ˜w1.

˜I1 = G( ˆI1),

ˆI1 = ˜I1/G′( ˆI10) + const.,

(A9)
This is consistent with the approximations already made. Writing G′( ˆI10) in terms of the
Larmor radius, r (which, like ˆI10, we regard as constant), we have
G′( ˆI10) = g′(r) ∂r/∂ ˆI1 ≈

ν2)1/2ν/r2

ˆw1 = G′( ˆI10) ˜w1.

(A10)

(r2

Q.

≡

−

The Hamiltonian becomes

˜H =

˜I1 + ν ˜I2

δ
Q

−

α(2/π)1/2
ν2)1/4
(r2

−

−

Xk

cos( ˜I1 −

kφ + δφ) sin

Q ˜w1 +

˜w2

.

(A11)

k
n

(cid:18)

(cid:19)

Finally, we perform the scaling transformation,

M = Q ˜H,

J1 = ˜I1,

ψ1 = Q ˜w1,

J2 = Qν ˜I2,

ψ2 = ˜w2/ν,

(A12a)

(A12b)

(A12c)

so that the Hamiltonian is given by

M =

δJ1 + J2 −

−

A

cos(J1 −

kφ + δφ) sin(ψ1 + kψ2),

(A13)

∞

Xk=−∞

– 27 –

where A is given by (11) and we have approximated ν/n by unity to give the last term in
the argument to the sine. We have extended the limits of the sum to inﬁnity; the additional
terms introduced are non-resonant, and so do not have much eﬀect.

Hamiltons’s equations now give ˙ψ2 = 1 or ψ2 = t and

˙ψ1 =

δ + A

−

sin(J1 −

k

˙J1 = A

X
cos(J1 −

k

kφ + δφ) cos(ψ1 + kt).

kφ + δφ) sin(ψ1 + kt),

Deﬁning new variables,

X

γ = nπ

ψ1,

ρ = J1 + νπ,

u = γ

v = γ + ρ,

−
ρ,

−

we ﬁnd

˙u = δ

A

cos[v

(π

φ)δ

k(t + φ)]

k

X

−

−

−

−

= δ

2πA cos[v

(π

φ)δ]

−

−

ˆδ(t + φ

2πj),

−

(A16a)

˙v = δ + A

cos[

u

(π

φ)δ + k(t

φ)]

−

−

−

−

k

X

= δ + 2πA cos[u + (π

φ)δ]

−

ˆδ(t

φ

2πj).

−

−

(A16b)

−

∞

j=−∞
X

∞

j=−∞
X

We have used the notation, ˆδ, to denote the Dirac delta function (to distinguish it from the
variable, δ) and we have used the identity,

Deﬁning uj = u(t = 2πj

∞

∞

cos kt = 2π

ˆδ(t

−

2πj).

Xk=−∞
π) and similarly for v, we may obtain

j=−∞
X

−
uj+1 −
vj+1 −

uj = 2πδ

2πA cos vj,

−

vj = 2πδ + 2πA cos uj+1.

π
It is readily established that ρ as given by (A15a) agrees with (6a), and that γ at ψ2 = 2πj
is equal to w2 at w1 = 2πj
π and so is equal to θj as deﬁned in (6b). Thus, the diﬀerence
equations given in (A18) agree with those derived in Sec. II, (13). The ﬁnal condition on
the validity of (A18) is that the change in ρ in one iteration is insuﬃcient to cause an
appreciable change in A through r. (This then justiﬁes taking A to be a constant.) The
maximum change in ρ in one iteration is on the order of A. Therefore the fractional change
in A due to this change in ρ is

−

−

A

∂ log A
∂ρ

=

∂A
∂ρ

=

∂A
∂r

∂r
∂ρ ∼

αν
ν2)5/4 ,

(r2

−

(A19)

(A14a)

(A14b)

(A15a)

(A15b)

(A17)

(A18a)

(A18b)

– 28 –

where, in diﬀerentiating A we have only considered its dependence on r through (r2
Demanding that (A19) be small gives

−

ν2)1/4.

The other assumptions made are ν

1 and r

ν

≫

−

≫

≪

−
( 1
2 ν)1/3.

(r2

ν2)5/2/ν

or A

(r2

ν2)3/2/r2.

(A20)

α

≪

−

APPENDIX B: FIRST-ORDER ACCELERATOR MODES

We consider here the simplest of the accelerator modes. Such modes are island systems
2πn and
v0 = 2πm, where m and n are integers. The amount by which ρ increases per iteration

around ﬁrst-order ﬁxed points in the (u, v) plane; i.e., points for which u1 −
v1 −
is sπ, where s = m + n. From (13) the ﬁxed points are given by

u0 =

−

δ + A cos u0 = m,

A cos v0 =

δ

−

n.

−

In order for an island to exist, the ﬁxed point, (u0, v0), must be elliptic. The stability of
(u0, v0) is determined by the eigenvalues of the linearized mapping. From (35) we have

where U = πA sin u0 and V = πA sin v0. The eigenvalues are given by

J0 =

1
2U 1

2V
4U V

−

,

(cid:17)

−

(cid:16)

λ = 1

2U V

−

±

2(U 2V 2

U V )1/2.

−

The ﬁxed point is elliptic if λ is complex, which requires 0 < U V < 1. Substituting for
sin u0 and sin v0 gives

A2

(m

δ)2 > 0,

−

−

A2

(n + δ)2 > 0,

[A2

(m

δ)2][A2

(n + δ)2] < 1/π4,

−

−

−

−

,
as the conditions for ﬁrst-order accelerator modes. When
|
) then (B4) is satisﬁed. At this point elliptic and hyperbolic ﬁxed points appear
n + δ
|
|
(with diﬀerent signs for cos u0 or cos v0). As
is increased further (B4c) fails and the
A
|
|
elliptic ﬁxed point turns into a hyperbolic ﬁxed point with reﬂection. Thus, (B4) deﬁnes a
< Au, which is a function of δ, m, and n, in which ﬁrst-order elliptic ﬁxed
range, Aℓ <
points exist.

just exceeds max(
|

A
|
|

A
|

m

−

δ

|

2 and Au = ( 1

Figure 16 shows the behavior of the mode with m = 1 and n = 0 for δ = 1

2 . From (B4)
we see that for these parameters Aℓ = 1
4 + π−2)1/2 = 0.5927. At A = 0.55,
Fig. 16(a), the ﬁrst-order island is visible. This is surrounded by higher-order (4th and
32nd) accelerator modes. When A just exceeds Au, Fig. 16(b), the center of the ﬁrst-order
island becomes unstable, becoming a hyperbolic ﬁxed point, separating two second-order
islands. However, although this point is unstable, it is conﬁned to the island system, since
there are still eigencurves with the original topology surrounding the system of two islands
and one hyperbolic ﬁxed point. Thus, a point started close to the hyperbolic point will
be forever accelerated. These eigencurves are soon destroyed, however, allowing the escape
of particles starting near the ﬁxed point. In Fig. 16(c) we see that the particle spends on
the order of 1000 iterations encircling the second-order islands before escaping. As A is

(B1)

(B2)

(B3)

(B4a)

(B4b)

(B4c)

– 29 –

increased further, the second-order islands rapidly decrease in size, becoming unstable when
A is slightly greater that 0.601.

From Fig. 16 we see that we should study accelerator modes of many diﬀerent orders in
order to have a complete understanding of their eﬀect on the diﬀusion of particles. However,
while it is possible to thoroughly study ﬁrst-order ﬁxed points, just cataloguing the higher-
> 1. For example, there are over 100
order ﬁxed points becomes a monumental task for A
∼
second-order ﬁxed points present for A = 1. We will therefore pursue only the ﬁrst-order
ﬁxed points.

In Fig. 17 we show the range in

deﬁned by (B4) as a function of δ with s = 0, 1,
and 2. (For each value of s, all values of m and n satisfying m + n = s are considered.) The
pattern evident in these ﬁgures is repeated for higher values of s. From (B4) and Fig. 17
we see that an accelerator mode, with a given value of s, ﬁrst appears at

A
|
|

Aℓ =

(

|

s/2
|
s/2
|
δ
|

| ≤

|

,

+
δ
|
|
+ 1
δ
2 − |

,

|

1
2 .)

for s even,

for s odd.

(Recall that δ is deﬁned such that

The accelerator mode disappears at a slightly higher amplitude, but periodically reap-

pears (with diﬀerent m and n, but the same s) at

where p is a positive integer. For a given s, the gap in which the accelerator mode exists,
2 for s odd. In this
∆A
Au −
case we have

Aℓ, is widest when Aℓ =

s/2
|

= 1

δ
|

≡

|

Aℓ =

s/2
|
s/2
|

+ p,

δ
|
| ± |
( 1
δ
2 − |

| ±

(

) + p,
|

for s even,

for s odd,

, δ = 0 for s even and
|
s2
4

1
π2

1/2

+

.

(cid:18)

(cid:19)

Au =

For s = 0 (i.e., no acceleration), we have Aℓ = 0 and Au = 1/π. This is the range in which
the central ﬁxed points of the islands in Fig. 3(a) are stable. If

1 then

s
|

| ≫

When
with p

A
|
|
≫

greatly exceeds the minimum threshold for a given s, so the Aℓ is given by (B6)
1, we may ﬁnd an approximate solution for ∆A from (B4):

(B5)

(B6)

(B7)

(B8)

(B9)

∆A =

1
2π2Aℓ

.

,

1
2π2Aℓ
1
4π4sA2
ℓ

for s = 0,

,

for s

= 0.

∆A = 



Since the number of ﬁrst-order accelerator modes increases with increasing A (see Fig.
17), we are lead to ask how the fraction of phase space occupied by accelerator modes varies
with increasing A. We try to ﬁnd an upper bound on this quantity for the ﬁrst-order modes.
We estimate the size of an accelerator mode by noting that the maximum radius of the island
is given by the distance between the elliptic and hyperbolic ﬁxed points. We consider here
the pair of ﬁxed points that are born together and we assume that the islands are roughly
Aℓ)/Aℓ]1/2 (ignoring numerical factors).
circular. From (B1) this distance is about [(A
This is maximaized by letting A = Au. The maximum area of the island is then ∆A/Aℓ.

−

6
– 30 –

2A

s=1
X

∆A
Aℓ ∼

2A

1

log A
A3 .

sA3 ∼

s=1
X

For a given A, modes with s from 1 to about 2A can be present; thus, the total area of the
accelerator modes is on the order of

2 then there is
Here we have used the form of ∆A for p
an additional contribution of order A−2 from the mode that just appeared for the ﬁrst time
by satisfying (B5); in this case ∆A is given by (B8). This then dominates over (B10). In
either case the area of the accelerator modes decreases with A.

= 0, (B9). If δ = 0 or 1

1 and s

≫

However, the modes tend to line up close to cos u = 0 and cos v = 0, since (B4a),
say, may be well satisﬁed, when (B4b) becomes true. We should investigate whether the
modes can form a barrier inhibiting the diﬀusion of particles. The sum of the widths of the
accelerator modes is

2A

s=1
X

(sA3)−1/2

A−1,

∼

which also decreases with A.

We conclude that the eﬀect of the ﬁrst-order accelerator modes decreases with increasing
A. This leaves open the possibility that the eﬀect of all the accelerator modes may not
decrease. We have, however, observed no evidence of this.

We describe here the solution of (66) by a Monte Carlo method. We ﬁrst deﬁne a new

APPENDIX C: MONTE CARLO SOLUTION

velocity coordinate, µ = 1

2 r2, so that (66) becomes
∂f
∂
∂µ
∂t

∂
∂µ

r2D

=

f.

(The variable µ is proportional to the magnetic moment and is the same as the action, I1,
used in Appendix A.) We solve (C1) by dividing each cyclotron period up into M equal time
intervals of 2π/M . The distribution function is recorded by the positions of N particles,
µi,j, where the subscript, i, refers to the particle number and j to the time step, j = M t/2π.
The distribution function, f , is found by converting µ back to r and letting

f (r) =

δN
2πN r δr

,

where δN is the number of particles with velocity between r
advance f by the diﬀerence equation,

−

δr/2 and r + δr/2. We

µi,j+1 −

µi,j =

+δ+, with probability 1
2 ,
δ−, with probability 1
2 .

(

−

[Do not confuse δ± with the parameter, δ, deﬁned in (15).] In the limit, M
and δ− are given by δ(µ), where

→ ∞

, both δ+

However, there are corrections to the expressions of δ+ and δ− of order M −1 which must be
included if we are to correctly model (66). [If we do not include these corrections we end up

δ(µ)

(2πr2D/M )1/2.

≡

(B10)

(B11)

(C1)

(C2)

(C3)

(C4)

6
– 31 –

solving the equation, ∂f /∂t = (∂2/∂µ2)r2Df .] We derive these corrections by demanding
that the steady-state solution given by the (C3) agrees with the steady-state solution to
(C1), viz., f = const. Letting f be a constant (which we take to be unity), the ﬂux of
particles, S, at µ is

where

S(µ) = 1

2 [δ+(µ

ǫ+)

δ−(µ + ǫ−)],

−

−

ǫ+ = δ+(µ

ǫ+),

ǫ− = δ−(µ + ǫ−).

−

ǫ+ and µ will pass
Equation (C5) just expresses the fact that half the particles between µ
the point µ is one time step, and similarly for the particles between µ and µ + ǫ−. Setting
S(µ) to zero gives

−

δ−(µ + ǫ) = δ+(µ

ǫ) = ǫ.

Putting ǫ = δ(µ) we recover the correct result for δ+ and δ− in the limit, M
gives

→ ∞

δ−[µ + δ(µ)] = δ+[µ

δ(µ)] = δ(µ).

−

−

Equation (C8) has a very simple graphical representation which is shown in Fig. 18. In the
limits, M

0, we can make a Taylor series expansion about µ to give

and δ

→ ∞

→

This acts as a friction force which appears in the diﬀusion equation, (C1), when we write it
in the form,

δ+(µ)

δ−(µ) = d(δ2)/dµ.

−

∂f
∂t

=

∂
∂µ

−

∂r2D
∂µ

∂
∂µ

f

−

(cid:20)(cid:18)

(cid:19)

(r2Df )
(cid:21)

.

(C5)

(C6)

(C7)

. This

(C8)

(C9)

(C10)

From Fig. 18 we see that δ+ or δ− becomes double-valued if

> 1. This can
always be prevented by choosing M large enough. However, from the deﬁnition of D, (67),
√α. We avoid choosing M to be large
we see that D has quite large gradients for r < ν
to compensate for this by deﬁning δ+(µ) to be δ(µ) and basing the deﬁnition of δ− on δ+
with

dδ/dµ
|

−

|

δ−[µ + 2δ+(µ)] = δ+(µ) = δ(µ),

(C11)

which is obtained by letting ǫ = δ(µ
(C8).

−

ǫ) in (C7). In the limit, M

, (C11) agrees with

→ ∞

To summarize: We solve (C1) and hence (66) using the diﬀerence scheme, (C3), with

δ+ and δ− deﬁned by (C11) and (C4). M is chosen to be 25.

– 32 –

References

1C. F. F. Karney, Phys. Fluids 21, 1584 (1978).
2Y. Gell and R. Nakach, in Plasma Physics and Controlled Nuclear Fusion Research 1978,
(International Atomic Energy Agency, Vienna), paper IAEA–CN–37–G–1 (to be pub-
lished).

3M. Abramowitz and I. A. Stegun (editors), Handbook of Mathematical Functions, (U. S.

Government Printing Oﬃce, Washington, D.C., 1964).

4C. F. F. Karney, Ph.D. thesis, Massachusetts Institute of Technology (1977).
5A. V. Timofeev, Nucl. Fusion 14, 165 (1974).
6The Mathlab Group, MACSYMA Reference Manual, Version 9, Laboratory for Computer

Science, Massachusetts Institute of Technology (1977).

7M. V. Berry, in Topics in Nonlinear Dynamics, edited by S. Jorna, Am. Inst. Phys. Conf.

Proc., No. 46 (American Institute of Physics, 1978), p. 16.

8J. Ford, in Fundamental Problems in Statistical Mechanics, edited by E. D. G. Cohen

(North-Holland, Amsterdam, 1975), Vol. 3, p. 215.

9B. V. Chirikov, Phys. Repts. 52, 263 (1979).
10V. I. Arnold, Mathematical Methods of Classical Mechanics, translated by K. Vogtmann

and A. Weinstein (Springer-Verlag, 1978).
11J. M. Greene, J. Math. Phys. 20, 1183, (1979).
12A. Fukuyama, H. Momota, R. Itatani, and T. Takizuka, Phys. Rev. Lett. 38, 701 (1977).
13S. Chandrasekhar, Rev. Mod. Phys. 15, 1 (1943).
14M. C. Wang and G. E. Uhlenbeck, Rev. Mod. Phys. 17, 323 (1945).
15E. Lazarro, Lettere al Nuovo Cimento 22, 625 (1978).
16R. J. Briggs and R. R. Parker, Phys. Rev. Lett. 29, 852 (1972).
17B. A. Trubnikov, in Reviews of Plasma Physics, edited by M. A. Leontovich (Consultants

Bureau, N.Y., 1965), Vol. 1, p. 105.

18D. L. Book, NRL Plasma Formulary, Naval Research Lab. (1978).
19N. J. Fisch, Ph.D. thesis, Massachusetts Institute of Technology (1978).
20N. J. Fisch, Phys. Rev. Lett. 41, 873 (1978).
21C. F. F. Karney and N. J. Fisch, Phys. Fluids 22, 1810, (1979).

– 33 –

Fig. 1. Motion of an ion in velocity space, showing the kicks it receives when passing
through wave-particle resonance.

– 34 –

Fig. 2. Comparison of the diﬀerence equations, (13), with the Lorentz force law, (2). (a)
The mapping of the (θ, r) plane using (2) with ν = 30.23 and α = 2.2. [This is taken from
Fig. 3(b) of I.] (b) The mapping of the (θ, ρ) plane under T using (13), with δ = 0.23 and
A = 0.1424, which is given by (11) with ν = 30.23, α = 2.2, and r = 47.5. In each case the
trajectories of 24 particles are followed for 300 orbits. Thus, in (b) the points, T j(θ0, ρ0) for
0

300, are plotted for 24 diﬀerent initial conditions, (θ0, ρ0).

j

≤

≤

– 35 –

Fig. 3. Trajectories in the (θ, ρ) plane for small A and (a) δ = 0, (b) δ = 1
equal to 0 or 1
h, is constant.

2 , (c) δ = s/p (not
2 ). The trajectories are obtained by plotting curves for which the Hamiltonian,

– 36 –

Fig. 4. Eigencurves of the mapping, T , for δ = 0 and (a) A = 0.3, (b) A = 0.35, (c)
A = 0.45. (d) The extension of one of the eigencurves in (c) emanating from the hyperbolic
ﬁxed point with reﬂection.

Fig. 5. The iterates of a single point for δ = 0 and A = 0.3. The point is chosen to start
on one of the eigencurves emanating from the hyperbolic ﬁxed point and 10 000 iterates are
shown. Compare with Fig. 4(a).

– 37 –

Fig. 6. Plot of log
the reference trajectory was begun at u0 = 2, v0 = 6.

ΛN |
|

/N as a function of N for various values of A. Here δ = 0.23 and

Fig. 7. Plot of h against A for δ = 0.23, u0 = 2, v0 = 6. The dashed line is the asymptotic
result, (43).

– 38 –

Fig. 8. The correlation function, Ck, for δ = 0.23 and (a) A = 0.2, (b) A = 0.5, (c) A = 10.
Ck was computed using (53) with M = 10 and L = 5000. The orbits were all chosen in the
stochastic region.

– 39 –

Fig. 9. The function, g(A), against A for δ = 0.11 (crosses), 0.23 (triangles), and 0.47
(squares). (a) and (b) show two diﬀerent ranges of A. The point for δ = 0.47 and A = 0.55
is at g(A) = 2.8, and so lies oﬀ the scale in (a). The function, g, was evaluated using (55)
and (56) with M = 20, L = 2500, and (a) K ′ = 100, K = 150, (b) K ′ = 50, K = 100. The
solid line gives the approximate form for g, (57).

– 40 –

Fig. 10. The correlation function Ck for δ = 0.47, A = 0.55, when an accelerator mode is
present. Here we took M = 100 and L = 5000 in (53). The orbits used to compute Ck all
lay outside the accelerator mode.

– 41 –

Fig. 11. Maximum, minimum, and rms velocities of ions as given by, (a) and (c), solution
of the exact equations of motion, (2) (taken from I), and, (b) and (d), a Monte Carlo solution
of (66). In both cases the orbits of N = 50 particles were followed with α = 20, ν = 30.23,
and initial velocity, r0 = 23. In (c) and (d) the time scale is altered to show the short time
behavior more clearly.

– 42 –

Fig. 12. The perpendicular velocity distribution function for the particles in Fig. 11 aver-
aged over orbits 800–1100. (a) The distribution function obtained from the exact equation,
(2) (taken from I). (b) The distribution function obtained from (66).
In each case the
2πrf dr = 1.
normalization is such that

R

– 43 –

Fig. 13. The diﬀusion coeﬃcient D, (69), as a function of v⊥ for the case discussed in Sec.
XI.

– 44 –

Fig. 14. The steady-state solution for the distribution function. (a) The two-dimensional
distribution function, f , as given by the two-dimensional Fokker–Planck equation. (b) The
one-dimensional distribution function, F (v⊥), as given by integrating the two-dimensional
result over vk (solid line) and solving the one-dimensional Fokker–Planck equation (dashed
line).

– 45 –

Fig. 15. The power dissipated by the wave, Pd, and the power lost to the background
distributions, Pc, as a function of time for the example given in Sec. XI. The results for the
two-dimensional and one-dimensional cases are given in (a) and (b) respectively. The units
of the vertical axes are miv2

0 . The times τd and τc are shown in (a).

tin0νi/i

– 46 –

Fig. 16. Development of the ﬁrst-order accelerator mode with m = 1, n = 0, and δ = 0.5.
The cases shown are (a) A = 0.55, (b) A = 0.594, and (c) A = 0.595. For this mode Aℓ = 0.5
and Au = 0.5927. The crosses show the starting positions of the particles.

– 47 –

Fig. 17. The range, (Aℓ, Au), in which ﬁrst-order accelerator modes exist with (a) s = 0,
(b) s = 1, and (c) s = 2.

– 48 –

Fig. 18. The graphical construction for δ+(µ) and δ−(µ) from δ(µ); see (C8).

