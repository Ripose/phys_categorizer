Nonlocal Nonlinear Electrostatic Gyroﬂuid Equations:

A four-moment model

D. Strintzi and B.D. Scott

Max-Planck-Institut f¨ur Plasmaphysik,

EURATOM Association

D-85748 Garching, Germany

A.J. Brizard

Department of Physics, Saint Michael’s College

One Winooski Park, Colchester, VT 05439, USA

(Dated: October 8, 2004)

Abstract

Extending a previous single-temperature model, an electrostatic gyroﬂuid model that includes

anisotropic temperatures (T

k 6= T⊥) and can treat general nonlinear situations is constructed. The

model is based on a Lagrangian formulation of gyroﬂuid dynamics, which leads to an exact energy

conservation law. Diamagnetic cancelations are inserted manually in such a way that energy

conservation is preserved. Comparison with previous models shows a very good agreement for

zero-Larmor-radius terms in the gyroﬂuid equations of motion.

PACS numbers: 52.35.Ra, 52.30.Ex, 52.65.Tt

4
0
0
2
 
t
c
O
 
9
2
 
 
]
h
p
-
m
s
a
l
p
.
s
c
i
s
y
h
p
[
 
 
1
v
6
7
2
0
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

I.

INTRODUCTION

The gyroﬂuid model [1]-[6] is one of the most commonly used tools for understanding and

explaining tokamak turbulent transport. Although it is less accurate than the gyrokinetic

approach, it is computationally more eﬃcient and economic, and it retains most of the

qualitative features necessary to explain turbulent transport [2]-[6].

To correctly compute turbulent transport, and especially for those computations that

treat large-amplitude disturbances, or those that treat strong spatial variations in the plasma

parameters, a gyroﬂuid model should satisfy an exact energy conservation law. In linear

theory, a small deviation from energy conservation leads to a small change in the growth rate.

Turbulence, however, also includes several conservative transfer pathways that inﬂuence the

overall statistical equilibrium. Violation of energy conservation in this case can lead to

a source of free energy, and, hence, large errors in the description of the turbulent state.

Moreover, to study the nonlinear evolution subsequent to a linear growth rate, the model

should be fully nonlinear, while conserving energy.

In a previous paper [7], we derived a fully nonlinear set of electrostatic gyroﬂuid equa-

tions that satisfy an exact energy theorem. This set contains the evolution equations for

density, momentum, and perpendicular temperature, as well as the polarization equation

for the electrostatic potential. The energy conservation law, which is guaranteed by the

Noether method through the Lagrangian formulation of gyroﬂuid dynamics, is a unique and

important feature of this model, which is thought to be especially important for the numer-

ical simulation of turbulence. Although our previous single-temperature gyroﬂuid model is

consistent, it does not contain the parallel-temperature eﬀects necessary for a quantitatively

accurate description of turbulence in magnetized plasmas. In the present paper, we extend

our previous model to include these eﬀects. Although the model is still electrostatic, it

should give an accurate description of low β turbulent plasmas.

The extension to anisotropic temperatures (Tk 6= T⊥) turns out to be nontrivial. In the

single-temperature case, the constraints used in the variation of the Lagrangian density can

be chosen to be the particle and entropy conservation laws. In the two-temperature case, one

needs an additional constraint and one can no longer rely on (only) conservation laws. The

approach used here is to derive the constraints for the parallel and perpendicular pressure

through the full Chew-Goldberger-Low (CGL) equations [8, 9]. A further diﬀerence with our

2

previous work is the use of the virtual ﬂuid displacement ξ in deriving Eulerian variations

for the gyroﬂuid moments, instead of the Lagrangian-multiplier method (which turns out to

be algebraically more involved).

Gyroﬂuid equations that include anisotropic parallel and perpendicular pressures have

been derived previously through the derivation of moments of the gyrokinetic equation [1]-

[6]. Although these equations do not conserve energy, they agree to a large extent with our

present gyroﬂuid model.

The remainder of this paper is organized as follows. In Sec. II, we present the gyroﬂuid

Lagrangian and give the constraints on the density and anisotropic pressures used in the

variational principle. In Sec. III, we present the variation of the gyroﬂuid action functional,

and derive the gyroﬂuid equations of motion before the insertion of diamagnetic cancela-

tions, as well as the polarization equation. In Sec. IV, we derive the energy conservation law

by applying the Noether method. In Sec. V, we describe how the diamagnetic cancelations

are inserted into our gyroﬂuid equations and present the ﬁnal equations for density, momen-

tum, parallel and perpendicular pressures. We also present the explicit form of the energy

conservation law with each energy-exchange term clearly identiﬁed. Lastly, in Sec. VI, we

summarize our work and present our conclusions.

II. GYROFLUID LAGRANGIAN DENSITY AND LAGRANGIAN

CONSTRAINTS

A. Gyroﬂuid Lagrangian Density

The four-moment gyroﬂuid Lagrangian for the anisotropic-temperature model is con-

structed in the same way as that of the one-temperature model [7], based on the work of

Pﬁrsch and Correa-Restrepo [10]. Here, the gyroﬂuid Lagrangian density is deﬁned as

1
2

b

Lf =

nm

k + |uE|2
u2

−

p⊥ +

pk
2 (cid:19)

+ en

A ·

− kφk

,

(cid:18)

(cid:19)

u
c

(1)

(cid:16)

(cid:17)
b × ∇φ is the E × B velocity, uk ≡ u ·

(cid:18)

where uE = (c/B)
parallel to the magnetic ﬁeld B ≡ ∇ × A = B

b denotes the gyroﬂuid velocity
b, and the nonlocal operator k...k denotes a

b

gyroﬂuid gyro-averaging operator deﬁned as follows. First, we note that, in our four-moment

b

model, the electrostatic gyro-potential kφk depends on the perpendicular temperature T⊥ ≡

3

p⊥/n and is assumed not to depend on higher-order gyroﬂuid moments. Thus, a general

expression for kφk can be given as

kφk ≡ P

ρ2
2

 

∇2
⊥

!

φ =

P (k)(0)
2k k!

ρ2k∇2k

⊥ φ,

Xk

where ρ2 = (mc2/e2B2) T⊥ is the squared Larmor radius and P(x) represents a smooth

function such that P(0) ≡ 1, i.e., we have kφk → φ in the zero-Larmor-radius (ZLR) limit.

Two choices for P(x) will be discussed below; here, we note that the operator ∇2

⊥ in the
Taylor expansion (2) acts on φ alone. The Hermitian conjugate operator k...k† is deﬁned in

terms of Eq. (2) as

kχk† ≡

P (k)(0)
2k k!

Xk

∇2k
⊥

χ ρ2k
(cid:16)

(cid:17)

= P

∇2
⊥

 

ρ2
2 !

χ,

where χ is an arbitrary function and we made use of the identity

(2)

(3)

χkφk = φ kχk† + ∇⊥ ·

χ1 + ∇2

∇⊥φ − φ ∇⊥

χ1 + ∇2

+ (χ2 + · · ·) ∇⊥∇2

⊥φ − ∇2

⊥φ ∇⊥ (χ2 + · · ·) + · · ·

h (cid:16)

⊥χ2 + · · ·
(cid:17)

⊥χ2 + · · ·
(cid:17)

(4)

,

(cid:16)

i

where

χk ≡

∂(χkφk)
∂(∇2k
⊥ φ)

=

P (k)(0)
2k k!

χ ρ2k.

Note that the operator ∇2

⊥ in Eq. (3) now acts on χ and powers of the Larmor radius ρ.

The E ×B kinetic term m|uE|2/2 in Eq. (1) is the long-wavelength form of gyro-screening

(i.e., the ZLR part of the second-order potential term in the gyrokinetic Hamiltonian [11]),

which plays a major role in the derivation of the polarization equation. Although the E × B

kinetic term is only an approximation of the full second-order gyrokinetic Hamiltonian, it

is useful since the gyro-screening correction to the potential is important only for large

ﬂow velocities and long wavelengths. Thus, the addition of full ﬁnite-Larmor-radius (FLR)

eﬀects for this quadratic term will not alter any computational results. The fact that the

gyro-screening term appears only in the Hamiltonian leads to the appearance of polarization

eﬀects only in Poisson’s equation for the scalar potential φ, which is desirable for computa-

tional reasons.

Although the drift-ﬂuid Lagrangian of Ref. [10] and our gyroﬂuid Lagrangian are similar,

there exist three diﬀerences: (a) the gyroﬂuid Lagrangian (1) contains FLR corrections to

the scalar potential φ, (b) the anisotropic temperatures T⊥ and Tk are treated separately

4

rather than as a single isotropic temperature T , and (c) we have arranged the terms such

that the gyro-screening term appears only in the Hamiltonian (i.e., not in the symplectic

part involving contraction with u; see Ref. [7] for further details). The total Lagrangian

density for our four-moment gyroﬂuid model is the sum of the gyroﬂuid Lagrangian density

(1) and the Lagrangian density of the electric ﬁeld, expressed as

1
2

L =

nm

k + |uE|2
u2

− n

T⊥ +

(cid:16)

(cid:17)

 

Tk
2 !

+ en

A ·

− kφk

+

(cid:18)

(cid:19)

u
c

|E|2
8π

,

(5)

where the variational ﬁelds are the four gyroﬂuid moments (n, u, pk, p⊥) for each ﬂuid species

(here, summation over particle species is assumed wherever appropriate) and the electro-

static potential φ.

B. Lagrangian Constraints

In order to proceed with our variational principle, we introduce constraints on the gy-

roﬂuid moments (n, pk, p⊥), based on the continuity (mass conservation) equation

dn
dt

+ n ∇ · u = 0,

(6)

(7)

(8)

where d/dt = ∂/∂t+u · ∇ denotes the total time derivative, and the modiﬁed CGL equations

for the perpendicular and parallel pressures [8, 9]:

+ pk ∇ · u + 2 pk

dpk
dt
+ p⊥ ∇ · u + p⊥ (I −

dp⊥
dt

b : ∇u = − 2 ∇ · qk⊥ + 4 qk⊥ · (
b

b · ∇

b),

b
b
b) : ∇u = − ∇ · q⊥⊥ − 2 qk⊥ · (
b

b
b · ∇

b
b),

where qk⊥ and q⊥⊥ are the parallel and perpendicular heat ﬂuxes, respectively. The pressure

b

b

b

b

constraints, without the terms including the heat ﬂuxes, can be also be obtained by general

conservation laws. If the heat ﬂuxes are removed from the pressure equations (7)-(8), all

gyroﬂuid quantities ηa = (n, pk, p⊥) are directly related to the velocity u. Using these

equations as constraints for the Lagrangian density (5), we can obtain the evolution equation

for the gyroﬂuid velocity u.

displacement ξ by taking the limits

We obtain expressions for the Lagrangian variations ∆ηa in terms of the virtual ﬂuid

lim
∆t→0  

dηa
dt

∆t

!

≡ ∆ηa and

lim
∆t→0

(u ∆t) ≡ ξ,

5

so that the variations of the pressures from Eqs. (7) and (8) become

∆pk = − pk ∇ · ξ − 2 pk

b : ∇ξ
b

b
∆p⊥ = − p⊥ ∇ · ξ − p⊥ (I −

b

b) : ∇ξ
b

.






The heat-ﬂux terms in Eqs. (7)-(8), which were not used in the Lagrangian variations (11)

b

b

for pk and p⊥, are added to the pressure equations later on since they play an important role

in the diamagnetic cancelations; these cancelations refer to the fact that the diamagnetic

velocity does not lead to advection. The present Lagrangian formulation also requires one

additional Lagrangian variation:

∆u ≡ dξ/dt = ∂ξ/∂t + u · ∇ξ

(10)

for the ﬂuid velocity u. For a correct treatment of FLR eﬀects associated with the gyroﬂuid

electrostatic potential kφk, instead of the pressure variations we will use the temperature

variations, such that the set of the Lagrangian variations used will be:

(9)

(11)

∆n = − n ∇ · ξ

∆u = ∂ξ/∂t + u · ∇ξ

∆Tk = − 2Tk

b : ∇ξ
b

∆T⊥ = − T⊥

b

b

I −
(cid:16)

: ∇ξ

b

b

(cid:17)

b

b

.






where ∆n is obtained from Eq. (6).

Lastly, one should note that the gyroﬂuid Lagrangian density (5) was constructed, not

derived, and that the method adopted here is not a mathematical derivation of the gyroﬂuid

Lagrangian from the gyrokinetic (single-particle) Lagrangian. The validity of the present

gyroﬂuid Lagrangian follows from the validity of the resulting gyroﬂuid equations, as well

as the energy conservation law. The same applies to the constraint equations, e.g., Eqs. (7)-

(8), which can be introduced arbitrarily, and their validity follows from the validity of the

resulting evolution equations.

6

III. GYROFLUID DYNAMICAL EQUATIONS

In this Section, we present a variational principle based on the action functional S ≡

L d3x dt using the virtual-displacement method associated with the Eulerian variations

R
(δn, δu, δTk, δT⊥). Here, each Eulerian variation δχ is deﬁned in terms of its Lagrangian
variation ∆χ as δχ ≡ ∆χ − ξ · ∇χ, so that, using Eq. (11), we ﬁnd

δn = − ∇ · (n ξ)

δu = ∂tξ + (u · ∇)ξ − (ξ · ∇)u

δTk = −ξ · ∇Tk − 2Tk

b : ∇ξ
b

b
b
b : ∇ξ
b
δT⊥ = − ∇ · (T⊥ ξ) + T⊥

.






From the Eulerian variation of the gyroﬂuid Lagrangian (5), we can now derive the moment

b

b

equation for the gyroﬂuid velocity u, as well as the polarization equation for the scalar

potential φ. Note that the Eulerian variation δT⊥ in Eq. (12) is used also in connection with

the FLR dependence of kφk:

δkφk(φ, T⊥) ≡ kδφk + δT⊥

∂kφk
∂T⊥

,

where

∂kφk
∂T⊥

=

mc2
2 e2B2 P ′

ρ2
2

 

!

∇2
⊥

∇2

⊥φ ≡ Ω(φ, T⊥; B),

and P ′(x) denotes the ﬁrst derivative of P(x). As a result of the mass scaling in Eq. (14),

the ion FLR correction Ωi is much larger than the electron FLR correction Ωe.

A. Variation of the Lagrangian Density

It is straightforward to derive the total variation δL of the gyroﬂuid Lagrangian density

(5), which depends on the variational ﬁelds (n, u, Tk, T⊥, φ), so that we obtain

δL =

∇δφ · ∂L
∂(∇φ)

 

− en kδφk

+ δn

!

∂L
∂n

+ δu · ∂L
∂u

n
2

(cid:20)

−

δTk + (1 + e Ω) n δT⊥

.

7

(12)

(13)

(14)

(cid:21)
(15)

Here, from Eq. (5), we ﬁnd

∂L
∂n

=

m
2

u2
k +

e
c

A · u − e ψ −

T⊥ +

Tk

and

= n

m uk

b +

A

, (16)

1
2

(cid:18)

(cid:19)

∂L
∂u

e
c

(cid:19)

(cid:18)

b

where we introduced the deﬁnition

e ψ(φ, T⊥; B) ≡ e kφk − (mc2/2 B2) |∇φ|2,

(17)

which combines the linear (with FLR corrections) and nonlinear (in the ZLR limit) electro-

static terms of the gyrokinetic Hamiltonian [11].

By inserting the Eulerian variations (12) into the gyroﬂuid Lagrangian variation (15), we

obtain (after some algebra)

δL = − ξ ·

+ ∇ ·

u

∂
∂t

∂L
∂u

(

∂L
∂u !

+ ∇u · ∂L
∂u

 
∂L
∂n

+ ∇ · P∗ − n

∇
"

 

+ T⊥ +

Tk

+ e Ω ∇T⊥

!

# )

− δφ

∇ · ∂L
∂(∇φ)

 

+ kenk†

+

+ ∇ · Γ,

!

1
2
∂Λ
∂t

(18)

(20)

where the tensor P∗ denotes the FLR-corrected CGL pressure tensor

P∗ ≡ PCGL + e Ω p⊥ (I −

b) = pk
b

b + p⊥ (1 + e Ω) (I −
b

b),
b

(19)

the Hermitian conjugate operator k · · · k† is deﬁned in Eq. (3), and we introduced the scalar

b

b

b

b

b

b

ﬁeld

and the vector ﬁeld

Λ ≡ ξ · ∂L
∂u

,

Γ ≡ u Λ +

P∗ − n

 

· ξ + δφ

I

!

∂L
∂n
∂(enkφk)
∂(∇2
⊥φ)

∂L
∂(∇φ)
∂(enkφk)
∂(∇2

⊥φ) !

+

δφ ∇⊥

"  

− ∇⊥δφ

+ · · ·

.

#

(21)

Note that, while the last two terms ∂tΛ+∇ · Γ in Eq. (18) do not play a role in the variational
δL d3x dt = 0, they play a crucial role in the derivation of exact conservation laws

principle

based on the Noether method.

R

8

B. Gyroﬂuid Equations

1. Gyroﬂuid velocity

From the Eulerian variation of the Lagrangian density (18), the stationarity of the action

functional with respect to a arbitrary virtual ﬂuid displacement ξ yields the Euler-Poincar´e

equation

obtain

0 =

∂
∂t

∂L
∂u

+ ∇ ·

u

 

+ ∇u · ∂L
∂u

+ ∇ · P∗

− n

∇
"

 

∂L
∂n

+

Tk + T⊥

+ e Ω ∇T⊥

,

!

#

∂L
∂u !
1
2

(22)

(23)

which describes the evolution of the gyroﬂuid velocity u. Upon substituting the Lagrangian

derivatives (16) into the Euler-Poincar´e equation (22), and using the fact that the back-

ground magnetic ﬁeld B is assumed to be a time-independent nonuniform vector ﬁeld, we

0 = mn

+ u · ∇uk

b −

u × B∗ + en ∇ψ

∂uk
∂t

 

+ ∇p⊥ + T⊥ ∇ (e n Ω) + ∇

!

b

(p∆ − e Ω p⊥)
h

b

b

,

i
b
where p∆ = pk − p⊥, and we have introduced the following deﬁnitions

b

B∗ ≡ B + (mc/e) uk ∇ ×

b

en
c

b






B∗

k ≡ B∗ ·

b = B + (mc/e) uk

b · ∇ ×

b

,

(24)

b
b∗ ≡ B∗/B∗

k =

b + muk C

b

b

with the magnetic-curvature term C deﬁned as C ≡ (c/eB∗
k)

b × (

b · ∇

b).

b

b

Eq. (23) can also be written in a more compact form by introducing the gradient of ψ

b

b

b

evaluated at constant perpendicular temperature, ∇⊤ψ, deﬁned through Eqs. (2) and (14)

as

∇kφk = k∇φk +

∇B +

∇T⊥ ≡ ∇⊤kφk + Ω ∇T⊥,

∂kφk
∂B

∂kφk
∂T⊥

where ∂kφk/∂B ≡ − 2 (T⊥/B) Ω. Then Eq. (23) can be written as:

0 = mn

+ u · ∇uk

b −

u × B∗ + en ∇⊤ψ + ∇ · P∗.

(25)

∂uk
∂t

 

!

b

en
c

9

Note that the vector ﬁeld B∗ is NOT a divergenceless ﬁeld (since ∇uk 6= 0), as is common

to all guiding-center and gyrocenter Hamiltonian models (in which parallel gyroﬂuid velocity

uk is replaced with the parallel guiding-center velocity vk).

It is easy to see that Eq. (23) can be divided into two equations: one equation that

expresses the gyroﬂuid velocity u in terms of the gyroﬂuid moments (n, uk, pk, p⊥) and the

electrostatic potential φ, and one equation that describes the time evolution of the parallel

gyroﬂuid velocity uk. The ﬁrst equation is obtained by taking the cross-product of Eq. (23)

with

b, which yields the following expression for the gyroﬂuid velocity

e n ∇ψ + ∇p⊥ + T⊥ ∇ (e n Ω) + ∇

(p∆ − e Ω p⊥)
h

b

b

b

b

,



i
(26)


Therefore, according to Eq. 26, the gyroﬂuid velocity u, consists of the parallel velocity
uk ≡ u ·

b and the following perpendicular gyroﬂuid velocities

b
u ≡ uk

b∗ +

b
c
en B∗
k
b

×






b

b

uD ≡ (c/en B∗
k)

b × ∇p⊥

b
b × ∇ψ

b

uψ ≡ (c/B∗
k)

uC ≡ (p∆/n) C

,






(27)

which represent the diamagnetic velocity, the generalized E × B velocity, and the curvature-

drift velocity, respectively, and the following gyro-potential FLR corrections

wΩ ≡

× ∇(nΩ) and wC ≡ − eΩ T⊥ C

(28)

to the E × B velocity and curvature-drift velocity, respectively.

2. Evolution equation for u

k

dot-product of Eq. (23) with

The evolution equation for parallel gyroﬂuid velocity uk can be derived by taking the

mn

∂uk
∂t

 

+ u · ∇uk

= −

b∗ ·

en ∇ψ + ∇p⊥ + T⊥ ∇(enΩ)

b
− ∇ ·

(p∆ − eΩ p⊥)

,

i

b

b

h

h

10

i

(29)

b
cT⊥
nB∗
k
b

b∗:

b

!

forces.

for φ:

where we have used the identity (valid for any function f )

∇ · (f

b) =
b

∇ · (f

b)

b + f (

b · ∇

b),

so that we ﬁnd

b∗ · ∇ · (f

b
b
b) = ∇ · (f
b

h
b
b). The gyroﬂuid equation (29) for uk includes terms

b

b

b

i

associated with the parallel electric ﬁeld and its FLR corrections as well as parallel thermal

b

b

b

b

The set of gyroﬂuid equations of motion for the four gyroﬂuid moments (n, pk, p⊥, uk) are,

thus, given by Eqs. (6), (7)-(8), and (29), respectively. Each of these gyroﬂuid equations
involves the advection operator u · ∇ and the divergence ∇ · u; it is the diamagnetic part

of the advection operator that must be eliminated from Eqs. (7)-(8) and (29) by adding

suitable diamagnetic ﬂuxes.

C. Polarization Equation

The polarization equation for φ can be found by considering the terms in the variation

(18) that involve the variation of the potential δφ. Here, we must remember to add up the

contributions of all the species to the total Lagrangian density.

Using the variation of the Lagrangian density (18), we obtain the Euler-Lagrange equation

where summation over particle species (

j) is shown explicitly. Using Eq. (5), we ﬁnd

k(en)jk† + ∇ · ∂L
∂(∇φ)

,

0 =

j
X

∂L
∂(∇φ)

=

1
4π

P
∇φ +

(nm)jc2

B2 ∇⊥φ,

Xj

(30)

(31)

so that the Euler-Lagrange (30) becomes the polarization equation

k(en)jk† + ∇⊥ ·

(nm)jc2

B2 ∇⊥φ

!#

+

 

1
4π

Xj "

∇2φ = 0.

(32)

Comparing Eq. (32) with our previous one-temperature model [7], it is clear that the polar-

ization equation is not aﬀected by the introduction of the parallel temperature in the model.

This arises from the fact that the terms that contain the gyroﬂuid electrostatic potential (2)

do not depend on pk. Further details concerning Eq. (32) can be found in Ref. [7].

Lastly, we note that two versions for the function P(x), appearing in the deﬁnition of

the gyroﬂuid scalar potential (2), are commonly used in gyroﬂuid applications: the function

11

P(x) = ex or its Pad´e approximant P(x) = (1 − x)−1.

It is important to note that,

whatever form is adopted for the gyroﬂuid scalar potential kφk, it must be used consistently

throughout the model in order to ensure energy conservation.

IV. ENERGY CONSERVATION LAW

In this Section. we present the local and global forms of the energy conservation law,

as they arise from the application of the Noether method. For this purpose, we point out

that, as a result of the variational principle

δL d3x dt = 0, the only remaining terms in the

Eulerian variation of the Lagrangian density (18) become the Noether equation

δL =

+ ∇ · Γ,

(33)

R

∂Λ
∂t

where Λ and Γ are deﬁned in Eqs. (20)-(21). The energy and momentum conservation

laws are derived from the Noether equation (33) by considering inﬁnitesimal time and space

translations, respectively. In the present work, we focus our attention on the local and global

energy conservation laws associated with our electrostatic gyroﬂuid model.

A. Local energy conservation law

We derive the local form of the energy conservation law from the Noether equation (33)

by considering inﬁnitesimal time translations t → t + δt, from which we obtain the following

expressions for the virtual ﬂuid displacement ξ and the Eulerian variations δφ and δL:

ξ = − u δt,

δφ = − δt ∂tφ,

and δL = − δt ∂tL.

Inserting these expressions into Eqs. (20)-(21), we obtain

Λ ≡ − δt

Γ ≡ − δt

 

,

u · ∂L
∂u !
u · ∂L
∂u

 

u

"
∂φ
∂t

+

 

− n

∂L
∂n !

+ P∗ · u +

∂φ
∂t

∂L
∂(∇φ)

∇⊥

∂(enkφk)
∂(∇2
⊥φ)

− ∇⊥

∂φ
∂t

∂(enkφk)
∂(∇2
⊥φ)

+ · · ·

,

! #

where summation over ﬂuid species is implied wherever appropriate. By combining these

expressions, we arrive at the primitive form of the local energy conservation law;

(34)

(35)

(36)

∂ε′
∂t

+ ∇ · S′ = 0,

12

where the primitive energy density is

ε′ ≡ u · ∂L
∂u

− L =

nm u2

k + p⊥ +

1
2

pk
2

+

en ψ −

 

|E|2
8π !

,

(37)

and the primitive energy-density ﬂux is

S′ ≡ u

u · ∂L
∂u

 

− n

∂L
∂n !
∂(enkφk)
∂(∇2
⊥φ)

∂φ
∂t

∇⊥

+

(cid:18)

+

 
1
2

"

pk
2
∂(en kφk)
∂(∇2
⊥φ)

∂φ
∂t

∇⊥

 

= u

nm u2

k + p⊥ +

+ en ψ

+ P∗ · u +

∂φ
∂t

∂L
∂(∇φ)

− ∇⊥

∂φ
∂t

+ · · ·

∂(enkφk)
∂(∇2
⊥φ)
+ P∗ · u +

!
∂φ
∂t

∂L
∂(∇φ)

(cid:19)

!

+ · · ·

− ∇⊥

∂φ
∂t  

∂(en kφk)
∂(∇2
⊥φ)

+ · · ·

.

(38)

! #

In order to arrive at the ﬁnal form of the energy conservation law, we need to rearrange

terms in Eq. (37). By substituting the polarization equation (30) into Eq. (4), we ﬁnd

en kφk =

+ mn |uE|2 − ∇ · D,

(39)

|E|2
4π

where

∂(en kφk)
∂(∇2
⊥φ)
so that the last terms in Eq. (37) become

∂L
∂(∇φ)

D ≡ φ

−

∇⊥φ + φ ∇⊥

+ · · ·

(40)

∂(en kφk)
∂(∇2

⊥φ) !

 

en ψ −

=

nm |uE|2 +

− ∇ · D.

(41)

|E|2
8π

1
2

|E|2
8π

Hence, we express the primitive energy density (37) as ε′ ≡ ε − ∇ · D, where the ﬁnal form

of the energy density is deﬁned as

ε ≡

nm

k + |uE|2
u2

+ p⊥ +

+

(cid:16)

(cid:17)

pk
2

|E|2
8π

,

1
2

and we obtain the local form of the energy conservation law

where the ﬁnal form of the energy density ﬂux is deﬁned as

∂ε
∂t

+ ∇ · S = 0,

S ≡ S′ −

∂D
∂t

.

After some partial cancelations, the ﬁnal form of the energy density ﬂux is

S = u

nm u2

k + p⊥ +

+ en ψ

+ P∗ · u + Sφ,

1
2

(cid:18)

pk
2

13

(cid:19)

(42)

(43)

(44)

(45)

where P∗ · u = p⊥ (1 + eΩ) u + (p∆ − eΩ p⊥) uk

b and the electrostatic energy density ﬂux is

deﬁned as

b

Sφ = − φ

∂
∂t  

∂L
∂(∇φ)

+ ∇⊥

∂(en kφk)
∂(∇2
⊥φ)

+ · · ·

+ ∇⊥φ

!

∂
∂t  

∂(en kφk)
∂(∇2
⊥φ)

+ · · ·

.

(46)

!

In the next Section, after heat ﬂuxes are inserted back into the pressure evolution equations

and diamagnetic cancellations are performed with the addition of terms in the gyroﬂuid

equations, the local energy conservation law (43) is converted into a new energy equation
∂tε+∇ · S∗ = 0, in which heat ﬂuxes and diamagnetic-cancellation terms result in a modiﬁed
ε d3x satisﬁes the
energy density ﬂux S∗. This new form ensures that the total energy E =

global energy conservation law dE/dt = 0.

R

B. Global Energy Conservation Law

The global energy conservation law dE/dt = 0 can be derived from the local energy

conservation law (43) by integrating it over space. Here, the global energy is deﬁned as

E =

d3x

nm u2

k +

p⊥ +

Z

(cid:18)

1
2

"

pk
2 (cid:19)

+

1
2

 

nm|uE|2 +

|E|2
8π ! #

.

(47)

In this form, the parallel kinetic energy, the internal energy, and the electric ﬁeld energy

explicitly appear. In a later section, we will present the time evolution of each of the separate

terms that constitute the energy conservation law in order to identify the energy-exchange

processes that allow the transfer of energy between the three types of gyroﬂuid (parallel

kinetic, internal, and ﬁeld) energies.

V. DIAMAGNETIC CANCELATIONS AND ENERGY CONSERVATION

The gyroﬂuid velocity (23) contains the diamagnetic velocity uD. Since the gyroﬂuid

moment-equations are derived by inserting the gyroﬂuid velocity u in the Lagrangian con-

straints, diamagnetic advection terms appear in the equations of evolution for the parallel

velocity and the two anisotropic pressures. More speciﬁcally, the momentum equation for uk
contains the term uD · ∇uk, and the parallel and perpendicular pressure equations contain
a combination of the terms uD · ∇p and p∇ · uD (where here p is either pk or p⊥). These

diamagnetic-advection terms should be canceled in the gyroﬂuid evolution equations by the

14

introduction of appropriate terms containing higher-order moments [7]. These correspond

to the FLR corrections to perpendicular ﬂuxes in conventional ﬂuid models [15, 16], but

arise naturally due to grad-B and curvature drifts in the moment-based derivation of local

gyroﬂuid models [4].

Since the higher-order moment terms cannot be derived from the Lagrangian, the dia-

magnetic cancelations must be done manually. However, there exists a constraint in the

addition of higher-order moment terms, namely, that the global energy conservation law

should not be altered. Here, the terms added are derived from the Vlasov equation, and

FLR corrections are then introduced to conserve energy. Thus, the ﬁnal moment equations

are not directly derived from the Lagrangian, but they still conserve energy exactly.

A. Parallel Gyroﬂuid Dynamics

The diamagnetic cancelation needed for the parallel momentum equation (29) involves

the addition of the term − ∇ · Π∗

k, associated with the non-diagonal part of the pressure

tensor [13], on the right side of Eq. (29). From Vlasov theory, the diamagnetic-cancelation

term is found to be [14]:

− ∇ · Π∗

k = − ∇ ·

p⊥

= mnuD · ∇uk + p⊥ K(muk),

(48)

where the magnetic diﬀerential operator K(· · ·) is deﬁned by the identity

b
mc
eB∗
k
b

× ∇uk







b
c
eB∗
k
b

b
c
eB∗
k
b

∇ ·

g








× ∇f

=

· ∇f × ∇g − g K(f ),

(49)

valid for arbitrary functions f and g. As written here, Eq. (48) conserves energy by itself,
since uk ∇ · Π∗

k). Here, we should note that the substitution of B to B∗

k = ∇ · (uk Π∗

k is

done here, and throughout this Section, to make the diamagnetic cancelation exact.

The time evolution of the parallel kinetic energy density is, therefore, expressed as

∂
∂t (cid:18)

mn
2

u2
k

(cid:19)

= − ∇ ·

k u + uk Π∗
u2

k

(cid:19)

− u ·

en∇ψ + ∇p⊥ + T⊥∇(e n Ω) + ∇

mn
2

(cid:18)

n

where we used the expression (26) for the gyroﬂuid velocity to write uk

for the second term on the right side of Eq. (50).

b

( p∆ − e Ω p⊥ )
h

io

b

b

, (50)

b
b
b∗ · {· · ·} = u · {· · ·}

15

B.

Internal Energy

To consider the time evolution of the internal energy p⊥ + pk/2, we rewrite the two

pressure equations (7)-(8) in the form

+ ∇ · (pk u) + 2 pk

∂pk
∂t
+ ∇ · (p⊥ u) + p⊥ (I −

∂p⊥
∂t

b : ∇u = − 2 ∇ · qk⊥ + 4 qk⊥ · (
b

b · ∇

b) + 2 Qk, (51)

b
b
b) : ∇u = − ∇ · q⊥⊥ − 2 qk⊥ · (
b

b
b · ∇

b
b) + Q⊥,

(52)

where Qk and Q⊥ are additional terms (to be determined later) associated with FLR cor-

b

b

b

b

rections to the electrostatic scalar ﬁeld φ.

To zeroth order in the electrostatic potential φ, the heat ﬂuxes are derived from the

Vlasov equation directly and are found in Ref. [9] to be expressed as

and

qk⊥ =

× ∇Tk + pk uC,

1
2

b
cp⊥
eB∗
k
b

q⊥⊥ = 2

× ∇T⊥.

b
cp⊥
eB∗
k
b

(53)

(54)

Inserting these diamagnetic heat ﬂuxes, using the deﬁnition (49), we ﬁnd

− 2 ∇ · qk⊥ + 4 qk⊥ · (

b · ∇

b) = nuD · ∇Tk + p⊥ K(Tk)

for the parallel pressure equation (7), and

b

b

− 2 p⊥ C · ∇Tk − 2 ∇ ·

Tk p∆ C

(55)

(cid:16)

(cid:17)

− ∇ · q⊥⊥ − 2 qk⊥ · (

b · ∇

b) = 2 nuD · ∇T⊥ + 2 p⊥ K(T⊥) + p⊥ C · ∇Tk

(56)

for the perpendicular pressure equation (8).

b

b

Using Eqs. (51) and (52), the time evolution of the internal energy can, therefore, be

expressed as

ﬁeld energy.

∂
∂t (cid:18)

pk
2

+ p⊥

(cid:19)

= − ∇ ·

pk
2
(cid:20) (cid:18)
+ u · ∇ · PCGL +

+ p⊥

u + PCGL · u +

qk⊥ + q⊥⊥

(cid:16)

(cid:17) (cid:21)

(cid:19)

(cid:16)

Qk + Q⊥

,

(cid:17)

(57)

where suitable energy-conserving expressions for the FLR-corrected heat ﬂuxes Qk and Q⊥

are now determined by considering the expression for the time evolution of the electrostatic

16

C. Electrostatic Field Energy

By making use of the electrostatic ﬁeld energy equation (41), we write the following

expression for the time evolution of the electrostatic ﬁeld energy

∂
∂t  

mn
2

|uE|2 +

|E|2
8π !

= ∇ · ∂D
∂t

+

en ψ −

∂
∂t  

|E|2
8π !
∂p⊥
∂t

∂n
∂t

= e (ψ − T⊥ Ω)

+ eΩ

− ∇ · Sφ,

(58)

where we made use of the polarization equation (32) and the deﬁnition (46) for Sφ. Here,

using the gyroﬂuid continuity (6), we obtain

e (ψ − T⊥Ω)

= − ∇ · [ e (nψ − p⊥ Ω) u ] + en u · [ ∇ψ − ∇(T⊥Ω) ] ,

and, using the perpendicular pressure equation (52), we obtain

eΩ

∂p⊥
∂t

= − eΩ ∇ · (p⊥ u) − PΩ : ∇u − eΩ

∇ · q⊥⊥ + 2 qk⊥ · (

b · ∇

b) − Q⊥

= − ∇ · ( eΩ p⊥ u + PΩ · u ) + u · [ p⊥ ∇(eΩ) + ∇ · PΩ ]
b

b

h

i

− eΩ

∇ · q⊥⊥ + 2 qk⊥ · (

b · ∇

b) − Q⊥

,

b

b

i

where PΩ ≡ P∗ − PCGL = eΩ p⊥ (I −

b

b) denotes the FLR-correction to the CGL pressure

tensor. Hence, the ﬁrst two terms on the right side of Eq. (58) can be written as
b

b

e (ψ − T⊥ Ω)

+ eΩ

= − ∇ · ( e nψ u + PΩ · u )

∂p⊥
∂t

∂n
∂t

h

∂n
∂t

+ u · (en ∇ψ − en Ω∇T⊥ + ∇ · PΩ)

− eΩ

∇ · q⊥⊥ + 2 qk⊥ · (

b · ∇

b) − Q⊥

.

(59)

h

b

b

i

We now require that, in order for the last term QΩ ≡ Qk + Q⊥ appearing on the right side

of Eq. (57) to cancel the last three terms on the right side of Eq. (59), the latter terms must

be written up to an exact spatial divergence as

− eΩ ∇ · q⊥⊥ − 2 eΩ qk⊥ · (

b · ∇

b) + eΩ Q⊥ = − QΩ − ∇ · SΩ.

Hence, we set the additional terms Qk and Q⊥ in Eqs. (57) and (59) to be

b

b

Qk = 2 eΩ qk⊥ ·

b

b · ∇
(cid:16)

(cid:17)

b
Q⊥ = − q⊥⊥ · ∇(eΩ) − ∇ · (q⊥⊥ eΩ)

b

,






17

(60)

so that

QΩ ≡ Qk + Q⊥ = nwC · ∇Tk + 2 eΩ p⊥ K(T⊥) + 2n (2 wΩ − eΩ uD) · ∇T⊥,

(61)

and SΩ ≡ eΩ (2 + eΩ) q⊥⊥, with q⊥⊥ deﬁned in Eq. (54). Combining Eqs. (59)-(61) into

Eq. (58), the time evolution of the electrostatic ﬁeld energy is, therefore, expressed as

∂
∂t  

mn
2

|E|2
8π !

|uE|2 +

= − ∇ · ( e nψ u + PΩ · u + Sφ + SΩ )

+ u · (en ∇ψ − en Ω∇T⊥ + ∇ · PΩ) − QΩ.

(62)

D. Explicit form of the energy conservation law

When diamagnetic cancellations and heat ﬂuxes are introduced into the four-moment

gyroﬂuid equations, the local energy conservation law (43) is modiﬁed. By combining the

evolution equations for the parallel kinetic energy (50), the internal energy (57), and the

electrostatic ﬁeld energy (62), the local energy conservation law (43) becomes the local

energy equation

∂ε
∂t

+ ∇ · S = − ∇ ·

uk Π∗

k + qk⊥ + (1 + eΩ)2 q⊥⊥

,

(63)

εd3x still satisﬁes the global energy conservation

i

h
which ensures that the total energy E =

law dE/dt = 0.

R

We now identify the energy-exchange processes that transfer energy between the three

diﬀerent types of gyroﬂuid energy. First, we write down expressions describing the time

evolution of each type of energy (e.g., parallel kinetic energy, internal energy, and ﬁeld

energy). Thus, the contribution of each species to the integrated parallel kinetic energy (50)

is

d
dt Z (cid:18)

mn
2

u2
k

(cid:19)

d3x = −

u · (en ∇ψ − en Ω∇T⊥ + ∇ · P∗) d3x,

(64)

the contribution of each species to the integrated internal energy (57) is

d
dt Z (cid:18)

pk
2

(cid:19)

Z

+ p⊥

d3x =

[ u · (∇ · PCGL) + QΩ ] d3x,

(65)

and the contribution of each species to the integrated electrostatic ﬁeld energy (62) is

d
dt Z  

mn
2

|E|2
8π !

|uE|2 +

d3x =

[ u · (en ∇ψ − en Ω∇T⊥ + ∇ · PΩ) − QΩ ] d3x.

(66)

Z

Z

18

The terms on the right side of Eqs. (64)-(66) appear in pairs with opposite sign, and give

the energy-exchange processes. For example, the FLR-correction heat ﬂux QΩ is involved

in energy exchange between the electrostatic ﬁeld energy and the internal energy, while the
FLR-correction pressure tensor PΩ is involved in energy exchange between the electrostatic

ﬁeld energy and the parallel kinetic energy. The contributions from en ∇ψ, en Ω∇T⊥ and
∇ · PCGL in Eqs. (64)-(66), on the other hand, describe standard energy-exchange processes.

E. Comparison with Previous Models

We now write explicit ﬁnal expressions for the gyroﬂuid density n, the gyroﬂuid parallel

velocity uk, and the parallel and perpendicular gyroﬂuid pressures pk and p⊥. The gyroﬂuid

continuity is expressed in expanded form as

dEn
dt

n
h

(cid:16)

+ ∇ ·

uk

b∗ + uC + wC

= [ K(p⊥) + n K(e ψ) + T⊥ K(en Ω) ]

(cid:17)i

+ uD · ∇(en Ω) + wΩ · ∇n,

(67)

where dE/dt ≡ ∂/∂t + uψ · ∇. With the insertion of the diamagnetic-cancellation term (48),

the evolution equation for the gyroﬂuid parallel velocity is expressed in expanded form as

mn

∂uk
∂t

 

+ u′ · ∇uk

− p⊥ K(muk) = −

b∗ · [ en ∇ψ + ∇p⊥ + T⊥ ∇(enΩ) ]

b
− ∇ ·

(p∆ − eΩ p⊥)

h

,

i

b

b

(68)

where u′ ≡ u − uD denotes the gyroﬂuid velocity without its diamagnetic contribution.

Lastly, with the insertion of the diamagnetic-cancellation terms (55)-(56) and (60), the

gyroﬂuid parallel and perpendicular pressure equations are

b

!

∂pk
∂t

= − ∇ ·

pk u + 2 pk uk

b + 2 qk⊥

+ 2 u · ∇ ·

b

b

pk

(cid:16)

+ 4 (1 + eΩ) qk⊥ · (

b · ∇
b

b),

(cid:17)

(cid:16)

(cid:17)

b

b

(69)

and

∂p⊥
∂t

= − ∇ ·

p⊥ u + p⊥ (I −

b) · u + (1 + eΩ) q⊥⊥
b

+ u · ∇ ·

p⊥ (I −

b)
b

h
− 2 qk⊥ · (

b · ∇

b) − q⊥⊥ · ∇(eΩ),
b
b

i

h

i

b

b

(70)

where the heat ﬂuxes qk⊥ and q⊥⊥ are deﬁned in Eqs. (53) and (54).

b

b

b

b

19

The results of the present two-temperature gyroﬂuid model can be compared with the

previous one-temperature model presented in Ref. [7], where the gyroﬂuid equations are

derived by including the perpendicular temperature only. Since the FLR-corrected CGL

pressure tensor (19) includes the parallel pressure pk, the two gyroﬂuid models agree except

for the terms that arise from the pressure anisotropy p∆ = pk − p⊥.

Our results can also be compared with the gyroﬂuid model of Beer and Hammett [4], since

this Beer-Hammett model is the most extended one, which includes closures and contains

all the previously developed gyroﬂuid models. The equations of evolution of the gyroﬂuid

moments presented here are nearly identical to those of Beer and Hammett. The diﬀerences

that arise can be separated in two categories: (1) diﬀerences in the non-FLR terms and (2)

diﬀerences in the FLR terms.

The non-FLR terms coincide almost exactly in the two models, except terms that come

from closures of higher-order moments, which our model is not able to retrieve.

In our

model, gyroﬂuid moments higher than pressure moments cannot be included in the gyroﬂuid

Lagrangian, and the closures are done automatically when choosing the constraints for the

variation. Thus, for instance, Landau damping is not included in our model, though it can

be added by hand afterwards as long as the energy conservation remains exact. A special

diﬀerence in the non-FLR terms between the two models - and the only one of the kind

that appears - is a diﬀerent term in the momentum equation (68): the magnetic term K(uk)

in our model compared to 2 K(uk) in Ref. [4]. This diﬀerence arises from the fact that the

additional magnetic contribution originates from the parallel-parallel heat ﬂux qkk, which

we cannot fully retrieve.

The diﬀerences in the FLR terms between the two models arise from the higher-order

moment closures, but also because of the energy conservation law. Especially in the FLR

terms, previous models do not conserve energy. Although our polarization equation reduces

to the local one [5] and so is in agreement with the local model in the local limit, we do

not exactly retrieve the results of Ref. [5]. That is, although we ﬁnd a strong correlation

between n and kφk and p⊥ and Ω, there exists another FLR term that is not correlated with

p⊥. This diﬀerence arises because of the constraints introduced here, which lead to another

closure than that of Ref. [5].

20

VI. SUMMARY AND CONCLUSIONS

In this paper we have derived a set of electrostatic gyroﬂuid equations for an anisotropic

plasma, that describe the evolution of density, momentum, parallel and perpendicular pres-

sures. The fully inhomogeneous four-moment model also includes a polarization equation,

from which the electric ﬁeld is computed, and satisﬁes an exact energy conservation law that

includes energy-exchange terms involving parallel kinetic energy, internal energy, and ﬁeld

energy.

To guarantee energy conservation, we have used the Lagrangian approach in which all the

equations are derived by a variational principle. Diamagnetic cancelations were taken into

account in a second step, by the addition of terms that include gyroﬂuid moments higher

than the pressure. All non-electrostatic diamagnetic-corrections terms were computed from

the Vlasov equation, and FLR-corrected terms associated with φ were chosen so that the

energy conservation law is still satisﬁed.

The validity of the Lagrangian and the constraints introduced for the variational proce-

dure was veriﬁed by the validity of the ﬁnal evolution equations and the energy conservation

theorem. The fact that the set of equations conserves energy makes the model suited for

turbulence computations, and especially for those that treat large-amplitude disturbances,

or those that treat strong variations of the plasma parameters. Moreover, since the set

of equations is fully inhomogeneous, it is suitable for studying the nonlinear evolution of

various ﬁelds, independent of the linear growth phase.

The successful application of this technique to the four-moment gyroﬂuid model show

that it is feasible, although not trivial, to extend the Lagrangian formulation to include also

the heat ﬂuxes as dynamical variables, and, thus, arrive at a complete six-moment model.

This extension will be treated in future publications.

Acknowledgments

We gratefully acknowledge useful discussions with Profs. K. Lackner, D. Pﬁrsch, and

H. Weitzner, as well as Dr. D. Correa-Restrepo. One of us (AJB) also wishes to thank

Profs. K. Lackner and S. G¨unter for their invitation to visit the Max-Planck-Institut f¨ur

Plasmaphysik in Garching.

21

[1] A.J. Brizard, Phys. Fluids B 4, 1213 (1992).

[2] W. Dorland and G.W. Hammett, Phys. Fluids B 5, 812 (1993).

[3] R.E. Waltz, G.D. Kerbel, and J. Milovich, Phys. Plasmas 1, 2229 (1994).

[4] M.A. Beer and G.W. Hammett, Phys. Plasmas 3, 4046 (1996).

[5] B.D. Scott, Phys. Plasmas 7, 1845 (2000).

[6] P.B. Snyder and G.W. Hammett, Phys. Plasmas 8, 744 (2001).

[7] D. Strintzi and B.D. Scott, to appear in Phys. Plasmas.

[8] G.F. Chew, M.L. Goldberger, and F.E. Low, Proc. R. Soc. London Ser. A 236, 112 (1956).

[9] J.P. Mondt and J. Weiland, Phys. Fluids B 3, 3248 (1991); Phys. Plasmas 1, 1096 (1994).

[10] D. Pﬁrsch and D. Correa-Restrepo, Plasma Phys. Contr. Fusion 38, 71 (1996).

[11] T.S. Hahm, Phys. Fluids 31, 2670 (1988).

[12] B.D. Scott, Habilitation thesis (2001).

[13] F.L. Hinton and C.W. Horton, Jr, Phys. Fluids 14, 116 (1971).

[14] E.V. Belova, Phys. Plasmas 8, 3936 (2001).

[15] S. I. Braginskii, Rev. Plasma Phys. 1 (1965) 205.

[16] H. Grad, Commun Pure Appl Math 2 (1949) 331.

22

