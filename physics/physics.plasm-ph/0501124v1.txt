5
0
0
2
 
n
a
J
 
3
2
 
 
]
h
p
-
m
s
a
l
p
.
s
c
i
s
y
h
p
[
 
 
1
v
4
2
1
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

GEM – An Energy Conserving Electromagnetic Gyroﬂuid Model

Bruce D. Scott∗
Max-Planck-Institut f¨ur Plasmaphysik, Euratom Association, D-85748 Garching, Germany
(Dated: September 25, 2013)

The details of ﬂuctuation free energy conservation in the gyroﬂuid model are examined. The
polarisation equation relates ExB ﬂow and eddy energy to combinations of the potential and the
density and perpendicular temperature. These determine the combinations which must appear
under derivatives in the moment equations so that not only thermal free energy but its combination
with the ExB energy is properly conserved by parallel and perpendicular compressional eﬀects. The
resulting system exhibits the same qualitative energy transfer properties as corresponding Braginskii
or Landau ﬂuid models. One clear result is that the numerical model built on these equations
is well behaved for arbitrarily large perpendicular wavenumber, allowing exploration of two scale
phenomena linking dynamics at the ion and electron gyroradii. When the numerical formulation is
done in the globally consistent ﬂux tube model, the results with adiabatic electrons are consistent
with the “Cyclone Base Case” results of gyrokinetic models.

PACS numbers: 52.65.Tt, 52.35.Ra, 52.30.-q, 52.25.Fi

I.

INTRODUCTION – GYROFLUID ENERGY CONSERVATION IN GENERAL

Gyroﬂuid models, whose most prominent application has been to tokamak core turbulence as exempliﬁed by the
Cyclone Base Case [1], were originally constructed to incorporate ﬁnite ion gyroradius eﬀects at arbitrary order into
simple computations of turbulence occurring in largely two dimensional ﬂuid experiments [2]. To treat ion temperature
gradient (ITG) turbulence the temperatures were incorporated and the model acquired several new advection terms,
producing nonlinearities as well as drift frequency corrections, resulting from the eﬀect of temperature ﬂuctuations
on the gyroaveraging operator [3, 4]. However, although the nonlinearities were incorporated, much of the analysis
involved linear frequencies and growth rates and the nonlinearities were added largely as an afterthought. Speciﬁcally,
there was no complete energetic analysis of the type familiar from drift wave turbulence work [5, 6, 7, 8]. The GEM
model was introduced previously in the context of energetic considerations, including the correspondence between ﬂuid
drift and gyroﬂuid models under drift ordering [9]. We develop the energetics for the six-moment model including
temperature and parallel heat ﬂux dynamics herein, placing this model on a secure energetic footing for the ﬁrst time.
Under drift ordering [10], this energetics involves “ﬂuctuation free energy,” in which the thermal free energy enters as
the average squared amplitude of the density ﬂuctuations [5], with additional contributions from the average squared
amplitude of the temperature ﬂuctuations in the appropriately generalised models [7]. The rest of the free energy is
made up of contributions due to the ExB energy involving the electrostatic potential, the magnetic energy involving
the parallel magnetic potential, and the parallel free energy in not only the parallel velocities but also the parallel
heat ﬂuxes [8]. A properly constructed model should conserve this free energy in all processes except those involving
clearly identiﬁable sources (gradients) and sinks (dissipative processes such as resistivity, thermal conduction, or
Landau damping). Many models neglect this consideration because small errors in the energetics lead simply to
negligible contributions to the growth rate in a linear model. However, if the model is to be useful in a turbulent
setting, the energetics must be consistent in order to achieve a reliable saturated state in which the salient energetic
processes and the turbulent transport can be statistically measured.

The processes linking the thermal free energy to the ExB turbulence are of physical importance because the free
energy sources and sinks are not in the perpendicular equation of motion. The energy source given by the general proﬁle
gradient, is in the equations for the thermal state variables (density, temperatures). The dissipation processes are in
the equations for the parallel ﬂux variables (current, heat ﬂuxes). In saturation, the ExB energy itself is maintained
as a statistical balance between various conservative transfer eﬀects which connect to these sources and sinks in the
other parts of the dynamics (this neglects certain rotation damping processes which are often not considered). In this
balance it is important that the conservative nature of such processes such as shear Alfv´en dynamics or interchange
eﬀects is maintained in the model. The simplest example is an isothermal two dimensional magnetohydrodynamical

∗email: bds@ipp.mpg.de;
URL: http://www.rzg.mpg.de/~bds/

(MHD) interchange model, given by

niMic2
B2

∂
2
⊥
∂t ∇

φ =

TeK

−

ne)
(

e
ne) = neK
where the perpendicular Laplacian and curvature operator are deﬁned by
e

+ vE · ∇

ne
∂
∂t
e

(ne +

φ)
(

e

e
(b

[b

2
⊥ =
∇

−∇ ·

×

×∇

)]

=

K

∇ ·

c
B2 (B

)
×∇

h

i

vE =

b

c
B

φ

×∇

respectively, with B = Bb the equilibrium magnetic ﬁeld. The ExB velocity is given by

The curvature terms in Eqs. (1,2) respectively represent quasistatic compression of the diamagnetic current and the
ExB velocity.

Under drift ordering [10], the background parameters are constants except where operated upon by vE · ∇

ExB advection. The magnetic ﬁeld is treated as constant except for the existence of
velocity vE is treated as divergence free; the ﬁnite ExB divergence is accounted for by
equations by
terms,

, the
(). In the advection term, the
φ). If we multiply these
(
ne, respectively, and integrate over the entire spatial domain, we ﬁnd, neglecting surface

φ and (Te/ne)

−

K

K

e

e

e

e

dΛ

niMi
2

c2
B2

∂
∂t

Z

∂
∂t

Z

dΛ

neTe
2

2

=

ne
ne (cid:19)
e

(cid:18)

−

Z

∇⊥
(cid:12)
(cid:12)
(cid:12)

dΛ Te

2

φ

=

−

Z

(cid:12)
(cid:12)
e
(cid:12)
nevE · ∇

dΛ Te

neK

φ

(cid:16)

(cid:17)
e

e

log ne +

dΛ Te

Z

neK

φ

(cid:16)

(cid:17)
e

R

e
dΛ by itself gives the total volume. These two lines give the evolution of the ExB drift and thermal free energy,
where
() transfers free energy between these two pieces conservatively,
respectively. The interchange eﬀect represented by
as we would expect from a compressional process, because
() is at once a total divergence and a ﬁrst order linear
diﬀerential operator. The source is given by the advection of the background gradient, proportional to the average
ﬂux. This model will saturate only if there is a loss process at the boundary, or some nonlinear eﬀect enters to cause
the source to go to zero, or some additional eﬀect is considered in the model by which an explicit sink term appears
to balance the source (a detailed analysis of how this functions in a three dimensional drift Alfv´en model is given in
Ref. [8]).

K

K

e

In a gyroﬂuid model, there is no equation for the vorticity explicitly involving time derivatives. Instead, at the same
level of sophistication as above, there is an evolution equation for each of the species’ gyrocenter densities, as opposed
to space densities. In each density equation, the potential is gyroaveraged using a suitable convolution operator which
is described by a kernel in Fourier space:

φG = G

φ

=

Gk⊥

φk⊥ eik⊥·x

(cid:16)

(cid:17)
e

k⊥
X

e

e

1/2
The usual form for Gk⊥ is Γ
(bi), which is an average of the single particle form J0(k⊥v⊥/Ωi) averaged over the
0
perturbed distribution function [3]. The argument is bi = k2
i , where ρi is the thermal gyroradius and Ωi is the
gyrofrequency. Unless phenomena below the ion scale ρi are considered, electron gyroradius eﬀects are usually ignored,
so that Gk⊥ = 1 for them. The potential is given by a polarisation equation which equates the two space densities, each
given by a combination of the gyrocenter and polarisation densities, the latter involving the gyroscreened potential.
The equations appear as [2]:

⊥ρ2

∂
ne
∂t
e

+ vE · ∇

(ne +

ne) = neK

φ

Te
e K

−

ne)
(

e

(cid:16)

(cid:17)
e

e

2

(1)

(2)

(3)

(4)

(5)

(6)

(7)

(8)

(9)

3

(10)

(11)

(13)

(14)

(15)

(16)

(17)

∂
ni
∂t
e

+ uE · ∇

(ni +

ni) = niK

φG

+

ni)
(

Ti
e K

e
+

e
Ti

ρ

2
2
⊥
i ∇

G (
ni)
ni
e

(cid:16)

e

φ =

(cid:17)

ne
ne
e

e

1. The low-k⊥ form of this is just

Gyroscreening is distinct from gyroaveraging; in general this is given by another operator whose usual kernel in
2
k⊥-space is Γ0(bi)
⊥ form used in Eq. 11.
i ∇
It is important to note however that the same operator is involved in the gyroaveraging of the potential (Eq. 8) as
in the conversion of the gyrocenter density,
ni, to the ion space density given by the left side of Eq. (11). For the
ions, the operator is G; for the electrons, it is unity. Consistent with this, the ExB advection of the ion density occurs
with the gyroaveraged potential, with velocity
e

bi, which in real space yields the ρ2

−

−

e

c
B
while the electrons are advected by the “bare” version, the same vE as in Eq. (5). The curvature operator acts on
the total force potential of each species, respectively, i.e., the diamagnetic velocity divergences are necessarily kept in
the model, which cannot take the MHD form if both pressures are to contribute to charge separation.

uE =

(12)

×∇

φG

b

e

The point to be made here is the way in which the polarisation equation, Eq. (11), determines the acceptable form
for many of the diﬀerential operators in the moment equations. The ExB energy and the electron and ion thermal
free energies are given by

UE =

dΛ

niMi
2

c2
B2

2

φ

∇⊥

Ue =

dΛ

neTe
2

Z
(cid:12)
(cid:12)
e
respectively. Using Eq. (11) and the Hermitian property of G, we may recast UE as
(cid:12)

(cid:12)
(cid:12)
(cid:12)

Z

Z

(cid:18)

2

ne
ne (cid:19)
e

Ui =

dΛ

niTi
2

2

ni
ni (cid:19)
e

(cid:18)

e
which shows the ion and electron contributions separately. By similar means, the time derivatives are given by

UE = e

φG

ni
2 −
e

e

ne
φ
2
e
e

∂UE
∂t

= e

φG

∂
ni
∂t −
e

e

φ

=

∂
ne
∂t
e

e

−

Z

e
∂Ue
∂t

=

−

Z

dΛ Te

nevE · ∇

dΛ Te

neK

φ

dΛ Ti

niK

φG

−

Z

(cid:16)

(cid:17)
e

dΛ Te

neK

e
log ne +

(cid:17)

(cid:16)

e

∂Ui
∂t

=

−

Z

dΛ Ti

log ni +

dΛ Ti

e
niuE · ∇

Z

Z

e
φ

(cid:16)

(cid:17)
e

φG

(cid:17)

(cid:16)

e

e
niK

e

From this we can see that, since both polarisation and thermal energy for each species now follow from its density
equation, the density and corresponding gyroaveraged potential must appear together under spatial derivatives in all
conservative processes in order for the energetics to remain consistent. For the ions this is
ni, while for
the electrons it is
ni multiplied by the curvature
term in Eq. (10) yields a term which vanishes under the integration, conserving the free energy, and the same occurs
for the electrons upon multiplying the curvature term in Eq. (9) by

ne. Thus, for the ions, the combination

φG + (Ti/nie)

φG + (Ti/nie)

(Te/nee)

e
(Te/nee)

ne.

−

φ

φ

e

e

e

e

e

This is relatively trivial for such a one-moment gyroﬂuid model, but the central point is clear: the gyroﬂuid closure
arising from gyroaveraging must be done the same way in the polarisation and in the moment equations. That is,
in this case, the operator G in the gyroaveraged potential for a given species must be the same as the one operating
upon the corresponding density in the polarisation equation. In a model which incorporates the temperatures, this
extends to another gyroaveraging operator acting upon the temperature, and the same one acting upon the potential
producing extra ﬁnite gyroradius advection terms, plus corrections to the temperature wherever the latter appears
under parallel gradients or curvature terms. This is much more involved and will be treated in the next two sections,
one discussing the problems with the currently standard gyroﬂuid model, and the next one formulating the GEM
model. Then, the last section shows the applications of GEM to the damping of kinetic shear Alfv´en waves, to the
hyperﬁne electron gyroradius scale turbulence problem, and to the Cyclone Base Case which provides the standard
benchmark.

e

e

−

e

II. DRIFT ORDERING AND NORMALISATION CONVENTIONS

With many constant factors containing the physical units to be carried about while manipulating the equations,
it is convenient to go to a system of normalised units. While this is somewhat arbitrary, two examples are useful in
elucidating the salient units for gyroﬂuid turbulence. One of these is the prospect of force balance in the electrons
along the magnetic ﬁeld. There are several eﬀects which aﬀect the evolution of the electric current in the electron
Ohm’s law, but these all act to mediate the response of the electrons to the two static parallel forces: the pressure
gradient and the static part of the parallel electric ﬁeld, given by

nee

∇kφ

− ∇kpe = pe

e

∇kφ
Te − ∇k log pe

(cid:18)
assuming small disturbances from the equilibrium, and a ﬁeld line geometry in which the parallel gradient for ﬁnite
sized disturbances is not allowed to vanish (see below), a quasistatic balance between these two forces yields the
following relationship between the disturbances:

(cid:19)

If the parallel responses also equalises the temperature along the ﬁeld lines, we then have the combination

This situation is called adiabatic electrons, and the response to the force in Eq. (18) is called the adiabatic response.
The importance of the pressure force is what departs gradient driven turbulence in general from the world of MHD.
The adiabatic response indicates the useful units for the electrostatic potential and all the thermodynamic state
variables, which will be scaled in terms of Te/e, ne, or Te following the forms in Eq. (20).

The other useful example is closer to the idea of the gyroﬂuid formulation: the relationship between ion inertia and

polarisation. In the low-k⊥ limit, the ExB energy is the same as the ﬂuid one,

(cid:12)
(cid:12)
given in Eqs. (6,13). The functional derivative of UE with respect to
(cid:12)

(cid:12)
(cid:12)
e
(cid:12)

φ leads to the polarisation density

UE = niMi

=

v2
E
2

niMi
2

c2
B2

2

φ

∇⊥

given in Eq. (11). Expressing

φ in terms of Te/e and the densities in terms of nee, we ﬁnd

e

where ρs is the drift scale given by

This is equally well described in terms of the ion gyroradius,

ni
ne
0, because it is a purely inertial phenomenon. With several
The role of the drift scale remains, however, even if Ti →
species present, Te and ρs make good choices for the basis of the normalisation scheme, and we will use them herein.
We work in terms of an arbitrary number of charged ﬂuids, each with a particular background density and temper-
ature, and mass and charge state per particle. In terms of the electron density and temperature, ne and Te, the mass
of a main ion species Mi, and the unit of charge, e, we have a normalised background charge density

2
2
⊥
i ∇

e
φ
Te
e

Ω
nee

Te
Ti

(25)

=

ρ

=

e
φ
Te
e

pe
pe
e

=

e
φ
Te
e

ne
ne
e

= 0

Te
Te
e

Ω =

niMic2

2
B2 ∇
⊥

e

φ

e

e
φ
Te
e

Ω
nee

=

ni
ne

2
ρ2
⊥
s∇

2
s =

ρ

TeMic2
e2B2

az =

nzZ
ne

4

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(26)

5

(27)

(28)

(30)

(31)

(32)

(33)

temperature to charge ratio

and mass to charge ratio

τz =

Tz
ZTe

µz =

Mz
ZMi

c2
s = Te/Mi

k⊥ρs ∼

1

kk/k⊥ = O(δ)

for each species labelled by z. For electrons, these are ae = τe =
me/Mi. For each species, the
background mass density is given by azµz, pressure by azτz, and squared gyroradius by ρ2
z = µzτz, in units of
neMi, pe = neTe, and ρ2
In fusion applications the main ion is often considered to be deuterium,
and so the latter mass MD is used for Mi. However, with discharge experiments run at fusion-relevant normalised
parameters using several disparate ion types becoming increasingly important [11], it is important not to make this
choice automatic.

s, respectively.

1 and µe =

−

−

We work under drift ordering, also called gyrokinetic ordering. There are two basic perpendicular length scales:

the drift scale ρs and the background proﬁle scale L⊥. Drift ordering assumes their ratio to be small,

δ = ρs/L⊥ ≪
where δ is called the drift parameter. It also assumes that the relative amplitude of all the disturbances is small by
this same order, for example,

(29)

1

nz
nz ∼
e
and similarly for the parallel ﬂux variables (velocities, heat ﬂuxes) in terms of the sound speed cs given by

φ
e
Te ∼
e

Tz
Tz
e

= O(δ)

It also takes a “maximal” ordering with respect to perpendicular wavenumbers and the drift scale,

while assuming a ﬂute/drift ordering for the parallel wavenumber,

The signiﬁcance of these statements taken together is that the dynamics can be very nonlinear, in the sense that
vE · ∇ ∼
∂/∂t, even though the disturbance amplitude remains small. It therefore follows that all nonlinearities are
dropped except for the quadratic ones represented by ExB advection (vE · ∇
in a ﬂuid model, additionally all its
ﬁnite gyroradius relatives in a gyroﬂuid model) and, in an electromagnetic model, the “magnetic ﬂutter” nonlinearities
represented by the contributions due to the magnetic disturbances in the parallel gradient
∇k. With the ﬂute ordering
we assume that the disturbed and undisturbed parallel gradient pieces are of similar size.
An important implication of drift ordering on the treatment of the geometry concerns the divergences of the various
perpendicular drift ﬂuxes. The ExB velocity in an inhomogeneous magnetic ﬁeld has a ﬁnite divergence, so that both
vE would enter a ﬂuid model. However, under drift ordering, both the proﬁle and disturbance are
vE · ∇
advected at the same order by vE, while the factor of n multiplying the divergence is treated as a constant parameter.
This forces an explicit split between the advection and divergence terms. Due to their various cancellations [12, 13],
the diamagnetic ﬂuxes enter only in the divergences, so this splitting concerns solely the ExB velocity in a ﬂuid
model, plus the associated ﬁnite gyroradius forms in a gyroﬂuid model. Under drift ordering, then, the advection
term appears as a pure Poisson bracket form (between the two perpendicular coordinates in a ﬁeld aligned treatment,
or between all three pairs in general), multiplied by a constant coeﬃcient, and the divergence term appears as a
curvature term (through
, as above), whose properties are that (1) it is a pure divergence, (2) it is a ﬁrst order
diﬀerential operator with the linearity property, and (3) all curvature terms are linear in the dependent variables.

n and n

∇ ·

K

The further impact of drift ordering on the treatment of the magnetic geometry is summarised in the statement
that if the three coordinates are aligned to the magnetic ﬁeld such that one of them is parallel (s), one is radial (x,
across ﬂux surfaces, down the gradient), and the third (y) has vanishing projections to both the equilibrium magnetic
ﬁeld and the background gradient, then the variation of the geometry is retained only in s. Field aligning means
that only one contravariant component of B is nonvanishing, in this case Bs. These are the basic statements of ﬁeld

6

(34)

(35)

(36)

(37)

(38)

(39)

aligned coordinates and magnetic ﬂux tube geometry, as explained elsewhere [14, 15]. The principal consequence is
2
that the perpendicular Laplacian
⊥ involves only x and y, and the metric coeﬃcients depend only upon s. Note
∇
especially that this includes the variation of the ﬁeld strength B, whose variation along the magnetic ﬁeld is retained
⊥ (hence, B2 appears as a coeﬃcient in the normalised gyroradius in all gyroaveraging and
but commutes with
gyroscreening operations). Although the equations of the standard gyroﬂuid model and of GEM are expressed in
covariant terms, the ﬂux tube geometry enters when they are discretised in a numerical representation, and their
essential coordinate dependence is reﬂected in the abovementioned split between advection by and divergence of the
drift velocity. We will save further comment on this for the sections (below) describing the numerical scheme.

2
∇

Thermodynamic state variables are normalised in terms of their background quantities, the electrostatic potential
in terms of Te/e, and the parallel magnetic potential in terms of B0ρs. Additionally, a factor of δ is folded into all
the normalisations, leaving the ExB advective nonlinearities coeﬃcientless. This is expressed as

for the potentials, and

φ
δ−1 e
Te
e

←

φ

e

nz ←

e
uz k ←

δ−1

δ−1

nz
nz
e
uz k
cs
e

δ−1

Ak
B0ρsβe
e

Ak ←
e

δ−1

δ−1

Tz ←
e
qz k ←

Tz
Tz
e
qz k
nzTzcs
e

e
4πpe
B2

βe =

for the state and parallel ﬂux variables respectively, where

e

is the electron dynamical beta (this enters through Ampere’s law). The density and temperature are therefore treated
on an equal footing with respect to their ﬂux variables, the velocity and heat ﬂux, respectively. Additionally, in
both GEM and the standard gyroﬂuid model, parallel and perpendicular temperatures and parallel-parallel and perp-
parallel heat ﬂuxes are treated separately, leaving a six moment model, for both ions and electrons as previously [16],
and for all species herein.

We leave

∇k normalised in terms of L⊥. Hence, the size of the contravariant magnetic unit vector component bs
is comparable to L⊥/qR, where q is the magnetic pitch parameter (toroidal/poloidal magnetic ﬁeld, contravariant
component ratio), R is the toroidal major radius, and 2πqR gives the connection length along the magnetic ﬁeld lines.
The parameters governing core or edge turbulence result from competition between ExB turbulence and parallel
dynamics, and so the scale ratios enter the ion inertia and curvature parameters according to

ˆǫ =

2

qR
L⊥ (cid:19)

(cid:18)

ωB =

2L⊥
R

respectively. These lead to the parameters governing the parallel electron dynamics,

ˆβ = βeˆǫ

ˆµ =

me
Mi

ˆǫ

C =

0.51νe
cs/L⊥

ˆµ

These are the drift Alfv´en parameter, the electron inertia parameter, and the drift wave collisionality parameter,
respectively. For core turbulence C and ˆµ are small, and ˆβ can be in the range from small values to several times
0.1 in high performance tokamaks. For edge turbulence C and ˆµ are larger than unity, and the turbulence becomes
electromagnetic for ˆβ near or larger than unity.
Ideal and resistive ballooning regimes occur when ˆβωB > 1 or
CωB > 1, respectively. The magnetic shear parameter is ˆs, nominally given by d log q/d log r where r is the minor
radius but generalisable to arbitrary geometry (cf. Ref. [15]). It is usually of order unity. Under the shifted metric
ﬂuxtube geometry, ˆs enters only through the shifts incurred in the y-coordinate while taking derivatives with respect
to s [20]. Further details on the signiﬁcance of these parameters may be found in Ref. [9].

III. ENERGETIC PROBLEMS WITH THE STANDARD GYROFLUID MODEL

Most of the problems with the standard gyroﬂuid model [3, 4] arise from the ﬁnite Larmor radius (FLR) terms.
The closure approximations are done term by term in a reasonable way, but with subtle diﬀerences in the polarisation

equation and in the gyroﬂuid moment variable equations.
In the polarisation equation the gyroaveraging of the
distribution function is computed from density and temperature moments of a perturbed Maxwellian approximation.
φ), which is subject to
In the moment equations the gyroaveraging is done on the potential (concentrating here upon
derivatives and then to the moment integrals. These two procedures are in general diﬀerent unless one approaches
them simultaneously with energy conservation in mind. For this reason, the result that the model has inconsistencies
is not so unreasonable, particularly considering that its motivation starts with linear theory and only secondarily adds
the nonlinearities one needs for turbulence. Additional to this is an inconsistency in treating the higher moments
which arise from the curvature terms: a perturbed Maxwellian model is used for those terms while the model itself
retains the parallel heat ﬂux moments as dynamical variables. These diﬃculties are treated in turn, with the FLR
terms ﬁrst. The standard gyroﬂuid model is suﬃciently well constructed that these repairs are in the end a minor
matter.

e

There are three gyroaveraging operators used in the model, given by Eqs. (20,26,27) of Ref. [4],

φG = Γ

1/2
0

φ

1
2

2
⊥
∇

φG = b

∂Γ

1/2
0
∂b

φ

φG = b

∂2
∂b2

1/2
0

bΓ

φ

(cid:16)

(cid:17)

2
⊥
∇
bb

assuming a ﬁeld aligned coordinate system and a Fourier representation in the two perpendicular coordinates, such
that b = k2
i (the model concentrates on a single ion species and leaves the electrons to be adiabatic). We relabel
these in terms of Γ1, Γ2, and Γ3, given by

⊥ρ2

e

e

e

e

e

b

e

Γ1 = Γ

1/2
0

Γ2 = b

∂Γ1
∂b

Γ3 =

∂2
∂b2 (bΓ1)

b
2

and recast the gyroaveraged and FLR corrected potentials as

φG = Γ1

φ

ΩG = Γ2

φ

ΩG = Γ3

φ

for clarity. Note the factor of two inserted into the deﬁnition for Γ3, so that
limit.

e

e

e

e

The polarisation equation [17] is given by Eqs. (7,48), rewritten as Eq. (93), all from Ref. [4],

e

eb

eb

e
ΩG and

ΩG both have the same low-k⊥

Ti⊥ is the perpendicular temperature disturbance deﬁned as
preserving the normalisation of
the normalised (v2
1) moment of the perturbed distribution function. Hence three gyroaveraging operators appear
in the moment equations, but only two appear in the polarisation. Moreover, the Pad´e approximate forms are used
in the latter but not in the former. Even if this were repaired, using

φ in terms of Te, where

⊥ −

e

e

ne =

1 + b/2 −

ni

e

e

(b/2)
Ti⊥
(1 + b/2)2 +
e

Γ0

−
τi

1

φ

e

1/2
0

Γ

1
1 + b/2

→

in the gyroaveraging of the potential (cf. Sec. III.C.4 of Ref. [3]), it would be impossible to reconcile the fact that the

2
⊥ operator does not appear in the polarisation equation, which in terms of the gyroaveraging operators reads
∇
bb

Γ0

1

ne = Γ1

ni + Γ2

Ti⊥ +

(45)

For the purposes of energetic consistency it does not matter how or whether the Γ0
only which operators appear in the

e
e
Ti terms.

ni and

−

e

1 screening term is approximated,

The ExB energy is given by

−
τi

φ

e

Using Eq. (45) we may replace this according to

e

e

dΛ

1

Γ0

−
τi

Z

φ2
2
e

7

(40)

(41)

(42)

(43)

(44)

(46)

(47)

dΛ

1

Γ0

−
τi

 

Z

φ2
2
e

+

=

dΛ

φ

ne
φ
2 !
e
e

Z

Γ1

ni + Γ2
2

Ti⊥

!

e

 

e

e

Using the Hermitian property of the gyroaveraging operators and the deﬁnitions of the potentials, and placing the
electron contribution on the right side, we ﬁnd

dΛ

1

Γ0

−
τi

Z

φ2
2
e

=

dΛ

Z

φG

ni +
ΩG
2

Ti⊥

−

 

e

e

e

e

ne
φ
2 !
e
e

The drift energy is therefore expressed as a combination of potentials multiplied by thermal state variables.

If the electrons are adiabatic due to fast parallel dynamics on closed ﬂux surfaces, the electron density is itself

replaced by the potential according to

ne =

φ

φ

−

D

E
e

where the angle brackets denote the ﬂux surface (“zonal”) average. In this case the electron contribution is a sort of
e
ﬁeld energy which is combined with the proper drift energy to form the potential energy given by

e

φ

φ

1

Z

φ

−

+



Γ0

dΛ

φ
2 
e

The ﬂux surface average is subtracted because the adiabatic state arises through the large value of the parallel
wavenumber kk combined with the electron thermal velocity, in comparison with the dynamical frequencies, while for
the zonal component there is no action by
∇k. The adiabatic electron approximation does not hold in general, but it
is assumed in Refs. [3, 4], and keeping it within this Section makes this discussion more transparent.
The thermal free energy is given by the ﬂuid moment variables in quadratic combination. The state variable free

ΩG
ni +
2

D
E2
e

(50)

−
τi

Ti⊥

φG

dΛ



!

 

=

e

e

e

Z

e

e

e

energy is given by

while the ﬂux variable free energy (the “generalised parallel kinetic energy”) is given by

dΛ

τi

 

Z

e

n2
i +

2
⊥ +
Ti
2
e

Ti

2
k

!

e

dΛ

Z

u2
k +

qi

 

e

e

qi

2
k

3

2

⊥ + 2
2

!

e

ΩG should appear
Comparison of all these pieces leads to the conclusion that the combinations τi
together under ﬁrst derivatives in linear terms in the moment equations in order that in combination among all the
energy pieces the various terms reduce to terms involving single ﬁrst derivative operators acting upon combinations
of the variables, which have the form of total divergences, either B
. It is clear that since no operation by the
third gyroaverage Γ3 appears in the polarisation equation with only densities and temperatures kept in the closure

φG and τi

∇k or

Ti⊥ +

ni +

K

e

e

e

e

for the total space density, there is no place for the third gyroreduced potential
ΩG in the moment equations. This
is the ﬁrst and most obvious inconsistency of the standard gyroﬂuid model, and it impacts the parallel dynamics,
the curvature terms (quasistatic compressible part of the drift dynamics), and the magnetic pumping process, each
of which we presently examine in turn. Finally, the additional inconsistency in the treatment of higher moments in
qi⊥ is addressed.
the curvature terms in the equations for

qik and

eb

We ﬁrst look at the parallel dynamics. This involves conservative energy transfer in the sound waves and conductive
heat ﬂuxes. The simplest case of a sound wave in the absence of any eﬀects due to the potential is of a parallel gradient
in the pressure causing a parallel ﬂow, and the corresponding parallel compression of that ﬂow acting to restore the
pressure disturbance. The total divergence term expressing energy conservation in such a local model as this one is
uk/B), up to numerical constant factors dependent on how the temperatures are described. This divergence
B
p
∇k(
represents a transport process, in this case advection of thermal energy by
uk. When the potential is also involved,
charge currents become part of this, but the structure is the same.

e

e

e
e

In the standard gyroﬂuid model, the part of the dynamics involving sound waves is

e

uk
∂
∂t
e

=

−∇k

τi
h

∂
ni
∂t
e
ni +

(cid:16)
Tik
∂
1
e
∂t
2
e

uk
B
e
φG

=

B

−

∇k

Tik

+

e
=

(cid:17)
B

−

e
∇k

i
uk
B
e

8

(48)

(49)

(51)

(52)

(53)

(54)

(55)

in addition to the polarisation equation. Evolution of the potential energy, the thermal state variable energy, and the
thermal ﬂux variable energy pieces involved in this is given by

φG

=

B

∇k

∂
ni
∂t
e
−

=

−
uk∇k
B
=
e

uk

uk
∂
e
∂t
e
ni

τi
h
∇k
τi

φG
uk
B
e
e
ni +

+

Tik

φG

uk∇k
e
φG
+

e
(cid:17)
e
uk∇kτi

(cid:16)
ni
τi
e
B
e
e
uk
Tik
B
e
When the pieces are summed, the transfer terms denoted by
uk∇k cancel, leaving the total transport divergence term
denoted by

∂
ni
∂t
e
=

Tik
∂
e
∂t
e

e
uk∇kτi

i
ni

(59)

(58)

∇k

e
Tik

Tik

1
2

uk

e
+

−

+

−

τi

τi

B

e

e

e

e

e

uk multiplied by
that is, just the divergence of a transport ﬂux given by the force potential in the equation for
ukB/B. Here we note that
ΩG. We ﬁnd by this analysis that the sound
Ti⊥ is not involved, so there is no action by
wave dynamics is in order and does not require modiﬁcation. The same conclusion results from examination of the
non-closure part of the heat conduction dynamics, for which the equation parts are
e

e

e

e

τi

ni +

+

φG

uk

e
Tik

(cid:17)

B
e

i

e

e

B

∇k h

(cid:16)

e

Tik
∂t
e
=

∂

1
2
∂
qik
∂t
e

=

B

−

∇k

3
2 ∇k

−

τi
h

qik
B
e
Tik

i

e

∂

Ti⊥
∂t
e
−∇k

qi⊥
B
e
ΩG

i

=

B

−

∇k

Ti⊥ +

τi
h

e

e

=

∂

qi⊥
∂t
e

1
2

τi

Tik

∂

Tik
∂t
e

e

=

B

−

τi

qik

Tik
B
e
∂
qik
e
∂t
e

∇k
2
3

qik

e

+

qik∇k
qik∇k
e
−

=

τi

Tik

h

i
e
Tik

τi

h

i

e

e

and the energetics parts are

and

and

τi

Ti⊥ +

ΩG

qi⊥

∂

Ti⊥
∂t
e

τi

Ti⊥

=

B

i
e
qi⊥
∂t
e
Here we note the factor of two diﬀerence in the deﬁnition of
and in the standard model.

e
qi⊥

−

B

e

e

e

∂

∇k h

τi
h

+

qi⊥∇k
qi⊥∇k
e
−

=

h

Ti⊥ +

ΩG

τi

e
Ti⊥ +

i
e
ΩG

i

qik here (conformal with the Braginskii deﬁnition [18])

e

e

e

There are also magnetic pumping terms in the gyroﬂuid parallel dynamics, due to the combination of parallel ﬂow
and conduction, magnetic moment conservation at the gyrokinetic level, and the parallel gradient in the strength of
the magnetic ﬁeld. Here, the standard model has the terms in the right places except for a single occurrence of the

e

“forbidden” potential

ΩG:

eb

∂
uk
∂t
e

=

−

τi
h

Ti⊥ −
(cid:16)
e

Tik

+

ΩG

(cid:17)

e

i

e

∇k log B

9

(56)

(57)

(60)

(61)

(62)

(63)

(64)

(65)

(66)

(67)

(68)

(69)

If we merely replace

ΩG by

∂

qi⊥
∂t
e

=

−

τi
(cid:20)

Ti⊥ −
e

(cid:16)

e
ΩG we restore consistency,

∂

1
2

Tik
∂t
e
∂

=

qi⊥ +

uk

−

=

(cid:0)
e
qi⊥ +

e
uk

(cid:0)
ΩG −
+ 2
e
eb

ΩG
e

e

Ti⊥
∂t
e
Tik

(cid:17)

∇k log B

∇k log B
∇k log B

(cid:1)

(cid:1)

(cid:21)

eb

e

∂

qi⊥
∂t
e

=

−

τi
h

Ti⊥ −
e

(cid:16)

Tik

+

ΩG

∇k log B

(cid:17)

i

When the free energy pieces are constructed, these eﬀects form transfer channels which then properly conserve energy

e

e

Ti⊥ and

because τi
equation. If it is present, then the conservation in the exchange between potential and thermal energy is broken.
eb

A similar problem appears in the curvature terms. For the thermal state variables in the standard model, these are

ΩG is “forbidden” is that it doesn’t appear in the polarisation

ΩG occur in combination. The reason

e

e

=

φG +

K  

∂
ni
∂t
e
1
2

∂

Tik
∂t
e
ΩG + τi
2

e

e

pi⊥

pik +
2

+ τi

ΩG
2
e
φG + τi

e
pik

e
Tik
+ τi

e
ΩG

e
ΩG + 2
2
e

eb

e

e
=

K  

2

e
3τi

Ti⊥ +

pi⊥

+

!

!





φG +

∂

Ti⊥
∂t
e

=

K 

e



eb

∂

Ti⊥
e
∂t
e

=

K  

φG +

pi⊥

ΩG + τi
2

+ 3

e

e

e

ΩG

τi

Ti⊥ +
2

e

e

!

Again, we need merely replace

ΩG by

ΩG to restore consistency,

Ti⊥ and
so that τi
standard model, but due to
e
e
free energy remained.

ΩG again occur in combination. Once more, thermal free energy was already conserved in the
ΩG a mismatch in the FLR part of the transfer between potential energy and thermal

eb

e

e

qik and

qik, and

qi⊥), arising from the factors of v2

The curvature terms in the ﬂuid moment ﬂux variables present a diﬀerent problem, the only inconsistency in the
standard model which is not a FLR eﬀect. There are no curvature terms involving the potential in the equations for
qi⊥, but there is a closure treatment at the level of the ﬁfth moments which appears in the equations for
uk,
k in the grad-B and curvature drift terms in
the third moments (
the gyrokinetic equation. In the standard model the closure for the 4th and 5th moments is taken from a perturbed
e
qi⊥ as dynamical variables, and so the 5th
Maxwellian (cf. its Eqs. 81 and 82). However, the model retains
⊥v3
moment should include contributions from pressures times conductive heat ﬂuxes. For example, parts of the v2
k
qi⊥.
⊥vk moment is provided by pi⊥
moment is provided under drift ordering by pi⊥
In the normalisation, the factors of pik and pi⊥ are replaced by unity. A way to do this systematically is to express
the perturbed distribution function as a general six-term polynomial in which each of the coeﬃcients is represented
by one of the ﬂuid moment variables retained in the six-moment model. Then, the ﬁfth moments are computed by
evaluating the integrals over v2
k times the perturbed distribution function. The result of this calculation is a
combination which automatically conserves free energy within the ﬂuid moment system:

qi⊥, and part of the v4

⊥vk or v3

⊥ and v2

qik and pik

qik and

e

e

e

e

e

e

e

10

(70)

(71)

(72)

(73)

(74)

(75)

(76)

(77)

(78)

(79)

(80)

=

4

uk + 2

qik +

qi⊥

∂
uk
∂t
e

τi
2 K
qik
∂
∂t
qi⊥
∂
e
∂t
e

(cid:0)
=

τi
e
2 K
τi
(cid:0)
2 K

=

3

qik
uk + 8
e
e

(cid:1)

uk + 6
e

(cid:1)
qi⊥
e

(cid:0)

e

(cid:1)

e

11

φG,

e
(81)

The “diagonal” terms in the implied curvature matrix conserve automatically, but what this procedure has done is to
ensure that the “cross” terms also act conservatively.

The ﬁnal consideration is the ExB advection terms, especially their FLR generalisations. All three potentials (

ΩG, and

ΩG) are involved in the standard model, acting through their respective drift velocities,

e

eb

uE =

F

φG

wE =

F

ΩG WE =

F

ΩG

e

e

b

b

b

e

eb

F

−

ni,

· ∇

· ∇

· ∇

×∇

ΩG.

ΩG
e

Ti⊥ +

Ti⊥ and

ΩG is not

Ti⊥/2 is not conserved by

in their own equations. Because

ΩG, the FLR potential energy

, and then extra “diagonal” FLR eﬀects in which

in its own equation, “cross” terms in which the pairs (

−
. The standard model has “diagonal”
Ti⊥)
qi⊥ are acted upon

−
represents the more familiar (c/B2)B
b
· ∇
qi⊥) are coupled by wE · ∇

where the tensor operator
−
terms, in which each variable is acted upon by uE · ∇
and (
uk,
by 2WE · ∇
e
e
WE · ∇
ΩG by
Ti⊥. Again, this is repaired by simply replacing
eb
e
Two minor considerations remain: ﬁrst, the part of the collision process which enforces isotropisation should have
eb
Tik, so that the total dissipation is positive
Tik rather than simply
Ti⊥ −
the collision frequency multiplying
deﬁnite. This merely captures the correspondence between a gyroﬂuid
ΩG and a ﬂuid Ti⊥ as discussed by Belova
Ti⊥ +
e
e
e
[19]. Second, we have discussed energetics independently of nondissipative closure. The standard model constructs
a curvature dissipation matrix in order to capture toroidal drift phase mixing by the velocity-dependent grad-B and
e
e
curvature drifts. Part of this is nondissipative and can in principle capture the 5th moment eﬀects discussed above.
However, we choose here to separate these eﬀects because in some applications involving nonperiodic drifts there
should be no phase mixing eﬀect at all. Moreover, the dissipation matrix treatment itself is not a real success.
It is explained (pp. 4057-8 of Ref. [4]) that a diﬀerent set of coeﬃcients was required to accurately represent the
kinetic result close to marginal stability for the adiabatic-electron, toroidal ITG mode. This is in itself an admission
of failure for the project of using the gyroﬂuid system as a quantitatively exact representation of the gyrokinetic
one. We do not attempt such an ambitious goal here; rather, the GEM model is intended for qualitative study of
basic physics mechanisms, especially energy transfer between small scale turbulence and large scale ﬂows and MHD
processes. Hence the neglect of dissipation free closure eﬀects, and in general the neglect of dissipative eﬀects other
than collisions and Landau damping.

ΩG −
e

e

e

e

e

e

e

e

The main point of this Section has been to highlight the way in which potential energy and thermal free energy are
conservatively exchanged by the various mechanisms involved in low frequency ﬂuid drift dynamics and their capture
by a gyroﬂuid model which is at least well behaved to arbitrary order in the ﬁnite Larmor radius parameter k⊥ρi. If a
turbulence model is to act at arbitrary FLR order it should conserve energy properly, even if for no other reason than
1. The procedure
that a numerical computation should not experience trouble in the spectral region around k⊥ρi ∼
to repair the standard model accordingly is to restore the use of the same closure treatment (and to the same depth in
the number of moments kept) in the polarisation equation(s) and in the ﬂuid moment equations. In the end, the same
gyroaveraging operators appear in the polarisation and ﬂuid moment equations — since the polarisation equation in
ni and
Ti⊥ it only involves the ﬁrst two operators Γ1 and Γ2, and hence only two
the six-moment model only involves
potentials (one nominal,
ΩG) can appear in the ﬂuid moment equations. The third gyroaverage
φG, and one FLR,
operator Γ3 may have a reasonable role in a gyroﬂuid model which retains 4th and 5th moments (one level in the
e
hierarchy past temperatures and conductive heat ﬂuxes), but we do not pursue this extension herein.
e

e

e

IV. CONSTRUCTION OF THE GEM MODEL

Subject to the conventions in Section II, our starting point is the polarisation equation, which links the variables
φ. We neglect true space charge eﬀects, setting the Debye

nz and
length to zero and assuming the space charge densities all add up to zero. This is the statement of quasineutrality:

Tz ⊥ for each species to the electrostatic potential,

e

e

where the gyroaveraging and screening operators are deﬁned separately for each species,

e

e

az

Γ1

nz + Γ2

z
X

(cid:20)

e
Tz ⊥ +

Γ0

1

−
τz

φ

= 0

(cid:21)
e

Γ0 = Γ0(bz)

Γ1 = Γ

1/2
0

(bz)

Γ2 = bz

(bz)

∂Γ1
∂b

(82)

(83)

with argument bz = k2
z = µzτz/B2, where B is the normalised strength of the equilibrium
magnetic ﬁeld. The considerations which lead to these forms are the ones given in the standard gyroﬂuid model [3],
as outlined in Section III.

z and squared gyroradius ρ2

⊥ρ2

12

(84)

(85)

(86)

(87)

(88)

(89)

(90)

(91)

We identify the generalised ExB energy using the polarisation densities in Eq. 82 as

Using Eq. 82 and the Hermitian property of the Γ operators, we recast this as

where the gyroreduced potentials are given by

Note that these are deﬁned separately for each species and that there is no Γ3.

e

e

e

We identify the thermal state variable part of the energy the same way as in the ﬂuid models,

The ﬂux variable part of the energy is

UE =

az

z
X

Γ0

1

−
τz

φ2
2
e

UE =

az

φG

nz +
ΩG
2

Tz⊥

e

e

e

e

z
X

φG = Γ1

φ

ΩG = Γ2

φ

e

e

Ut =

azτz

z
X

n2
z + (1/2)
Tz
2
e

e

2
k +

Tz

2
⊥

Uv =

azµz

z
X

e

uz

2
k + (2/3)
2

qz

2
k +

qz

2
⊥

e

e

2
⊥
− ∇

Ak =

Jk =

az

uz k

z
X

e

2

e

e

Um =

βe
2

Ak

∇⊥

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

e

Um = βe

Jk
Ak
2

e

e

The magnetic energy is given by

which using Eq. (89) may be rewritten as

We note here that since the evolution of Ut and UE ultimately follows from the same moment equations, the combi-
Tz ⊥.
nations which must appear together under the
Observing this will guarantee energetic consistency.

operators in those equations are

∇k and

ΩG + τz

φG + τz

nz and

K

The magnetic ﬁeld disturbances arise from the parallel magnetic potential, which is given by Ampere’s law in terms

e

e

e

e

of the total electric current,

This model neglects gyroaveraging and gyroscreening of the magnetic potential. On the same footing as the potential
qz ⊥, and due to the
equation we would have a more general Ampere’s law in which
ΩG several new ﬁnite gyroradius terms would appear in the magnetic
same consistency considerations as with
ﬂutter dynamics. This is being left for future work, however, because the consequences for energy conservation have
not yet been worked out.

uz k might be replaced by Γ1

uzk +Γ2

φG and

e

e

e

e

e

In situations wherein the ﬁnite electron gyroradius is neglected, we simply have

φG =

φ and

ΩG = 0 for the

electrons, so that the polarisation equation becomes

ai

Γ1

ni + Γ2

Ti⊥ +

φ

=

ne

(92)

e

e

e

i
X

(cid:20)

Γ0

1

−
τi

(cid:21)
e

e
where the species label is changed to i as it refers to the ions only. If as in most practical applications one takes a
single component plasma with singly charged ions, we merely have ai = 1 and τi = Ti/Te, and with normalisation to
that particular ion’s mass, µi = 1 and µe =
1. Since these are trivial restrictions, we
present the GEM model in terms of the general forms following from Eq. (82).

me/Mi along with ae = τe =

−

−

e

e

The ExB advection operators and the nonlinear part of the parallel gradient are given in terms of Poisson bracket

structures,

uE · ∇

= [

φG, ]

wE · ∇

= [

ΩG, ]

b⊥ · ∇

=

βe[

Ak, ]

−

in the two perpendicular coordinates, that is,

e

e

e

[f, g] =

∂f
∂x

∂g
∂y −

∂g
∂x

∂f
∂y

(cid:18)

(cid:19)

Deﬁned in this fashion, the quantities uE, wE, and b⊥ are all divergence free as written; the generally ﬁnite divergences
of uE and wE are treated separately, through
ΩG), respectively. The advective time derivative and the
(
parallel derivative are given by

φG) and
(

K

K

d
dt

=

e
+ uE · ∇

∂
∂t

e
∇k =

B

1
B

+ b⊥ · ∇

· ∇

where B and B are deﬁned in terms of the equilibrium magnetic ﬁeld. The variation of B along a ﬁeld line (poloidally
around the ﬂux surface in a tokamak) is incorporated into the gyroradii

The perpendicular parts of the Laplacian are given by

ρ2
z =

µzτz
B2

∂

1
g1/2

2
⊥ =
∇

∂xµ g1/2 gµν
elements of the entire metric, and gµν

⊥

∂
∂xν

bz = ρ

2

z (kµgµν

⊥ kν)

where g is the determinant of the
involves only the two perpendicular coordinates (x and y).
operators is given by

gµν}

{

⊥ is the perpendicular metric which
In these terms, the argument bz appearing in the Γ

where µ and ν are summed over the two perpendicular coordinates only. Note that ρ2
no gyroradius appears with the

2
⊥ operator in the Ampere’s law (Eq. 89).
∇

z commutes with

2
⊥ and that
∇

13

(93)

(94)

(95)

(96)

(97)

(98)

The six moment equations are the same ones appearing in the toroidal version of the standard gyroﬂuid model [4],
ΩG, appearing together, and the
corrected according to the ﬁndings in Section III. With
background gradient forcing terms nz and Tz (functions of x only) displayed explicitly, the dissipation free part of the
equations for each species are
e

Tz ⊥ and

φG, and

nz and

e

e

e

nz]

d [nz +
dt

+ wE · ∇

Tz +
h

Tz ⊥

+ B

∇k

i

e

uz k
B
e

=

φG +

K  

e

τz

pz ⊥ +
pz k + τz
2
e

e

ΩG

!

e

e

Ak
∂
∂t
e

βe

+ µz

uz k
d
dt
e

K

(cid:18)

qz ⊥ =

+ µzwE · ∇
qz k +
uzk + 2
µzτz
e
2
e

e

4

e

−∇k
qz ⊥

(cid:16)

−

e
τz

(cid:19)

+

φG + τz

pz +

pz k

(cid:2)
ΩG + τz

(cid:16)

e

(cid:3)(cid:17)
τz
Tz ⊥ −
e
e

(cid:17)

e

Tz k

∇k log B

Tzk

d

Tz +
h

dt

1
2

qz k

i

+ B

uzk +
B
pz k

∇k
e
φG + τz

e
+ τz

Tz k

e
=

K  

e

2

e

uz k +

qz ⊥

∇k log B

! −

e

(cid:0)

e

(cid:1)

e

[nz +

nz] + 2

Tz ⊥

+ B

d

Tz +
h

dt

Tz ⊥

e

=

i

+ wE · ∇
φG +

K  

(cid:16)

ΩG + τz
2

pz ⊥
e

+ 3

e

e

e

Tz +
h
ΩG + τz
e
2

e

e

i(cid:17)
Tz ⊥

=

3
2 ∇k

−

µz

qz k
d
dt
e

τz

Tz +
h

(cid:16)

Tz k

+

µzτz

K

(cid:18)

i(cid:17)

e

∇k

qz ⊥
B
e
uz k +

+

!

(cid:0)

e

e

(cid:19)

qz k

3

uzk + 8
2

e

e

qz ⊥

∇k log B

(cid:1)

µz

qz ⊥
d
dt
e

+ µzwE · ∇
µzτz
+

K

(cid:18)

uz k + 2

qz ⊥

=

ΩG + τz

Tz ⊥

uz k + 6
(cid:0)
e

qz⊥
e

2

e

e

(cid:1)

(cid:19)

−

−∇k

(cid:16)

τz

e
ΩG + τz

(cid:16)

e

Tz +
h
Tz ⊥ −
e

τz

e
Tzk

(cid:17)

e

i(cid:17)
∇k log B

The pressures are deﬁned as

nz +
Tz ⊥
pz k =
, wE · ∇
and all the thermal state variables are operated upon by uE · ∇
e

pz ⊥ =

nz +

Tzk

e

e

e

e

e

pz = nz + Tz

, and

∇k together with their gradients.

14

(99)

(100)

(101)

(102)

(103)

(104)

(105)

15

(106)

e
(108)

A. Local and Global Models

The GEM model is variously cast in both local and global versions. In the local version the gradient drive terms
appear explicitly in the equations as displayed above. Following the ordering, the pressures add linearly also in
these quantities. The densities and temperatures are given prescribed forms, usually simple linear gradients, e.g.,
nz =
gives the inverse of the normalised scale length, but they can be given
arbitrary form, allowing computations within any prescribed gradients. For this version all dependent variables are
given Dirichlet boundary conditions in the x-direction,

ωn x such that ωn =

log nz|

L⊥∇
|

−

f = 0

at x =

Lx
2

±

where Lx is the domain length.

In the global version the separate gradient terms do not appear in the moment equations. Instead, the ﬂuctuat-
ing gradient is part of the dependent variable. Accordingly, the dependent variables are given Neumann/Dirichlet
boundary conditions in the x-direction,

∂f
∂x

Lx
2

−

Lx
2

= 0

at x =

f = 0

at x =

(107)

allowing arbitrary proﬁle evolution. In this version the curvature operator and also all the dissipation operators act
upon the entire variable, including the proﬁle. Consequently, the two dimensional equilibrium including parallel ﬂows
and currents, and heat ﬂuxes, is also solved for and evolved self consistently with the turbulence. The transport
problem is also solved. One usually operates in one of two limits: the run time is either longer or much shorter than
the conﬁnement time. In the latter case sources are not necessary; the proﬁle is allowed to relax but is expected
not to do so very much (perhaps 30% relaxation is acceptable). For edge turbulence in a thin radial layer such that
Lx < L⊥, the conﬁnement time is usually shorter than the time for the zonal ﬂows, resulting from the evolving ﬂux
surface (“zonal”) averaged potential, to reach statistical equilibrium. In this case sources are necessary for all the
Tz⊥ for each species). In either global case, the proﬁles cannot be prescribed except
state variables (
for the fact that the system is initialised with the proﬁles set into the state variables.

Tz k and

nz and

e

A ﬁnal consideration in the global model is polarisation: vorticity is given in general by the “gyrocenter charge
nz, noting that it is the total charge density that is set to zero. Here, the proﬁles are
nei
h

density” made up by
included in the dependent variables, so especially in the adiabatic electron version one must keep the unchanging
in polarisation,

e
z az

P

e

e

ne =

+

φ

nei
h

−

φ

D

E
e

where the angle brackets denote the zonal average. In the local version, the proﬁle function ni(x) does not appear in
polarisation, since it is expected to be equal to ne(x).

e

e

e

Both global and local versions are set up with globally consistent boundary conditions parallel to the background
magnetic ﬁeld. This ensures individual fulﬁllment of the periodicity constraint for each Fourier component in y as if on
the entire ﬂux surface, even if the toroidal mode spectrum is truncated [15]. Here we note that ky follows the toroidal
mode number generally and hence the y-domain is periodic. The domain length for y is Ly. The periodicity constraint
applies as a boundary condition in s after one single poloidal cycle, so the s-domain is always one connection length
π < s < π. Additionally, the y-coordinate is shifted on each drift plane (constant-s surface), so that perpendicular
−
dynamics is always computed with an orthogonal metric, and magnetic shear enters as a set of relative shifts in
the y-coordinate in the expressions for ∂/∂s, as explained in Ref. [20]. This combination is required for capture of
slab-character modes, of which the most important in turbulence is the nonlinear drift wave instability [7, 9, 21].
Global consistency is also required to obtain the correct spectrum of sideband modes in the equilibrium, to which the
turbulence and zonal ﬂows are coupled by toroidal compression of the ExB velocity [22].

B. Fourier and Pad´e Versions

The operators involving

⊥, including the Γ’s, are solved variously in xy-space or in k⊥-space. The Fourier
versions are set up to be compatible with either the local or global boundary conditions. The local model with
Dirichlet boundaries uses half-wave Fourier transforms, with the basic x-domain odd-reﬂected about x = Lx/2, that
is, f (Lx/2 + x′) =
x′) for 0 < x′ < Lx. The Fourier transform and its inverse is then applied to the
doubled domain. In a similar manner, the global model uses quarter-wave Fourier transforms, with four copies of

f (Lx/2

−

−

2
∇

16

(109)

(110)

(111)

the x-domain arrayed odd-even-even-odd, and with the transforms applied to the quadrupled domain. This Fourier
version of either the local or global model is used whenever the argument bz = k2
z of any species is expected to
take large values. The hallmark example of this is ETG turbulence (Sec. V), which involves the entire scale range
between ρi and ρe in a single component plasma. If the ion moment variables are kept, the Fourier version should be
used to obtain an accurate ion response, which becomes more and more “adiabatic” (in the sense that
ne)
with increasing bi. In current implementations, the Fourier version always uses the full FLR form for every species,
including electrons, regardless of the expected values of bz.

⊥ρ2

→ −

τi

φ

e

For standard ITG or edge turbulence cases, where the scale range reaches down to but not below ρi, the Pad´e

e

version may be used. This approximates the Γ’s by [3]

Γ0(bz)

1

2
ρ2
⊥
z∇

−

→

−1

Γ1(bz)

(cid:0)
1

(cid:1)
2
ρ2
⊥
z∇

1
2

→

(cid:18)

−

−1

(cid:19)

−1

Γ2(bz) =

1
2

ρ2
2
⊥
z∇

1
(cid:18)

−

1
2

ρ2
2
⊥
z∇

(cid:19)

Γ1(bz)

However, if the ﬁnite gyroradius eﬀects of more than one species are taken into account, one must solve the combined
φ. This is simple in k⊥-space but complicated if using the Pad´e
screening operator given by
forms in conﬁguration space, even if one of the coordinates is Fourier decomposed. With only two gyroradii to follow,
however, one has the acceptable operation involving two successive Helmholtz solves. In current implementations, the
Pad´e version is only used for single component plasma cases in which the electron FLR eﬀects are neglected. The
adiabatic ion model is only used with the Pad´e version. The importance of the Pad´e version is that it is the only one
easily generalised to fully global geometry, wherein the metric coeﬃcients depend on x.

z(az/τz)(Γ0

1) to ﬁnd

P

−

e

C. Dissipation in GEM – Collisionless

The only true dissipation in the collisionless GEM model is phase mixing due to the kinetic resonances caused by
the parallel transit dynamics, i.e., Landau damping. This is represented by direct dissipation upon the parallel heat
ﬂux variables, using a Landau damping operator deﬁned by

aLz ≡

aL0

1

0.125V qR

2
k
∇

−
(cid:16)
with constant aL0 nominally set to unity, where qR is the ﬁeld line connection length divided by 2π [15], V = τz/µz
2
is the normalised thermal speed of species z, and
k is generally the full nonlinear parallel Laplacian divergence
∇
operator B

(cid:17)

∇k(1/B)

∇k. Both qR and

2
k are normalised in terms of L⊥.
∇

The GEM model does not employ a curvature drift dissipation model. The standard one did so [4], but also noted
in detail the problems it raised. For the reasons discussed in Section III, therefore, it is chosen to omit this feature.
Nonlinear FLR phase mixing [3] is also left out of the standard model [4], for similar reasons of tractability.

(112)

D. Dissipation in GEM – Collisional

The electromagnetic gyroﬂuid model ﬁnds a very useful application in tokamak edge turbulence [16], and hence
requires a treatment of collisions which will capture the collisional Braginskii ﬂuid model [18] in the appropriate limit
of large collision frequency and short mean free path. The usual types of dissipation are resistivity and thermal
conduction, which in a model treating both velocities and heat ﬂuxes as dynamical variables amounts to applying a
dissipation matrix to their combination. For an isotropic temperature the method used in the DALF Landau ﬂuid
model [8] is suﬃcient. The gyroﬂuid model, however, additionally includes temperature anisotropy. To combine these
eﬀects, a simple drift kinetic Chapman-Enskog procedure is used to ﬁnd the dissipative corrections to a state with
Tz ⊥ for each
stationary state variables [23], generalised to a bi-Maxwellian distribution (deﬁned by
species) for the dissipation free part. A Lorentz collision operator is used, and then the Braginskii coeﬃcients are
substituted to capture the collisional limit. The resulting model is given by

Tz k, and

nz,

e

e

e

βe

+ µz

+ µeνe

Jk +

qek +

qe⊥ + αe

Jk

(113)

∂
Ak
∂t
e

uz k
d
dt
e

=

· · ·

αe
κe

η
(cid:20)

e

(cid:16)

e

e

(cid:17)(cid:21)

e

17

(114)

(115)

(116)

(117)

(118)

1
2

Tz k
d
dt
e

Tz ⊥
d
dt
e

=

νz

· · · −

τz
h

Tz k −
e

(cid:16)

Tz ⊥

ΩG

−

(cid:17)

=

+ νz

· · ·

τz
h

Tz k −
(cid:16)
e

e

Tz⊥

−

(cid:17)

i

e

ΩG

i

e

(5/2)
κz

· · · −

µzνz

qz k −

0.6αz

Jk

+ 1.28νz

1.5

qz⊥

=

=

µz

µz

qz k
d
dt
e

qz ⊥
d
dt
e

(5/2)
κz

µzνz

· · · −

(cid:16)

(cid:16)

e
qz ⊥ −

e

(cid:17)

e

−

(cid:17)

e

0.4αz

Jk

1.28νz

1.5

qz⊥

qz k −
(cid:0)

e
qz k −
(cid:0)

(cid:1)

e

(cid:1)

where κz and αz are the thermal conduction and thermal force coeﬃcients for each species, and ηk is the resistivity
coeﬃcient. Herein, the thermal force is kept only for electrons (αz = αe), while for ions it is zero. For a single
component plasma with singly charged ions, the values of the coeﬃcients are

e

e

e

η = 0.51

αe = 0.71

κe = 3.2

κi = 3.9

To recover an isotropic model we would add (1/2)
the forms in Ref. [8]. Then, we could recover the Braginskii formula for
damping terms in its equation (i.e., neglect

Tz⊥ to form (3/2)

Tzk +

qz k except in the collisional damping term), as explained in Ref. [8].

e

e

The terms in the temperature equations and the ones with the factors of 1.28 represent relaxation of anisotropy,
ΩG in
and the others represent resistive (η) and thermal conductive (κz) dissipation. Note the combination τz
the temperature equations; this is required to make the dissipation positive deﬁnite, following the same considerations
as those concerning energy conservation resulting from the same combination under the

Tz ⊥ +

e

operators.
e

e

∇k and

K

qz k +

qz k. This yields
qz ⊥ to form
Tz and
qz k by neglecting the inertial and Landau
e
e

e

e

e

E. Nonlinear Dissipation and the Numerical Scheme in GEM

One ﬁnal dissipation mechanism remains to be considered, and in gradient driven turbulence it is often the most
important one: nonlinear cascading to arbitrarily small scales [21]. This enters explicitly as an artiﬁcial diﬀusion term
in each equation for computations using a dissipation free scheme to calculate the nonlinear advection terms.

The energy cascade in drift wave turbulence is generally local in k⊥-space [24], and can proceed in either direc-
tion following the properties of the various nonlinearities [24, 25, 26]. When energy cascades to the scale of the
computational grid (highest k⊥ values), it must be removed somehow lest the spectra approach the unphysical forms
representing the maximum entropy state [25] of the discrete system. One must check to ensure that the grid dissipation
rate is independent of the resolution, essentially the same statement contained in high Reynolds number turbulence
(dissipation independent of the diﬀusion or viscosity coeﬃcient).

In the past, the predecessor of this model has used an upwind scheme (a slope limiting algorithm [27] integrating all
the dimensions together [28], from computational ﬂuid dynamics) implemented as discussed elsewhere [16]. Herein, we
employ an alternative ﬁnite diﬀerence scheme which also does not involve Fourier transforming or spectral operations
and hence is applicable to situations forbidding such operations. The scheme has been used with success by Naulin on
the ﬂuid drift Alfv´en model [29]. The ﬁrst derivatives involved in Poisson bracket structures are evaluated with the
second-order version of the Arakawa spatial discretisation [30]. The linear terms involving parallel dynamics (∂/∂s)
) are evaluated with standard second-order central diﬀerences. Direct dissipation
and perpendicular compressibility (
terms (e.g., collision-based frictional damping of
Jk or Landau-based damping of heat ﬂuxes) are evaluated directly.
The entire right side is evaluated thereby once per time step, but using a third-order “stiﬄy stable” algorithm derived
by Karniadakis et al, according to which the previous three time steps of the dependent variables and the right hand
sides are used to get the new time step [31]. Since the entire right hand side is used this way, an unsplit second-order
accuracy is achieved. Finally, the artiﬁcial dissipation terms are applied separately, using the dependent variables at
the now-previous timestep. The structure of the equations is given by

K

e

where F is the functional of the dependent variables f appearing under the (∂/∂t) operator in each equation, S is
the right hand side of each equation, and D is the artiﬁcial dissipation operator in each equation. The structure of

∂F
∂t

= S + D(f )

(119)

the algorithm is given by

F1 =

3F0

F−1 +

F−2 + ∆t (3S0

3S−1 + S−2)

6
11

(cid:20)

3
2

−

1
3

S0 = S(f0)

−

F1

(cid:21)
F1 + ∆tD(f0)
(apply boundary conditions)
F1

←

f1

←

where the subscript ‘0’ refers to the current timestep, ‘1’ refers to the new timestep, and the negative ones refer to the
previous timesteps, ∆t is the timestep interval, “boundary conditions” refers to the loading of the guard cells at the
computational boundary so that derivatives are computed normally during the evaluations of S and D, and the last
step recovering f1 from F1 refers to the solving of the polarisation equations to recover
Ak and the evaluation
of the gyroaveraging operators Γ1 and Γ2 to get the gyroreduced potentials
ΩG. For waves, this scheme is
stable without the use of D, allaying the principal consideration which led to the upwind scheme in the ﬁrst place
[16]. But for turbulence we require the use of D.

φG and

φ and

e

e

e

e

It is important to note that the artiﬁcial dissipation must work in all three coordinates, not just the two perpendicu-
lar ones. ExB advection is the main agent causing the direct cascade towards large wavenumbers in the gyroﬂuid state
Tz ⊥ (almost solely, for core turbulence). It is important
variables, mostly
to note that this occurs not only in k⊥-space but also kk-space, simply due to the statistics [32]. The dissipation
operators must therefore function for both k2

nz (for edge turbulence) but also

Tzk and

e

⊥ and k2
k.
e

e

φG instead of

One might be tempted to apply D to the force potentials, e.g.,

nz, but this has been found to
nz −
Ak,
damage the solution measurably. It is indeed important not to apply artiﬁcial dissipation directly to either φ or
the main eﬀect of that being to destroy the Alfv´en dynamics (for k2
k) or medium to large scale vorticity (for k2
⊥). This
e
e
was the problem with the upwind scheme [16]: as the kinetic shear Alfv´en velocity is scale dependent the exact one
could not be used in the ﬂux splitting involved in the scheme, so the fastest one was used (otherwise, the scheme is
unstable). For βe < me/Mi the fastest wave (following vA) is at the lowest k⊥ and the smallest scales (highest k⊥) are
dominated by collisional dissipation anyway (since νe > cs/L⊥), so edge turbulence was not strongly impacted. For
core turbulence, on the other hand, the fastest wave (following Ve) is at the highest k⊥ so that the large scale MHD
response at the lowest k⊥ is strongly dissipated with a sort of super-resistivity acting directly upon
Ak rather than
Jk. To avoid the same problem with schemes with explicitly applied artiﬁcial dissipation, it is important to avoid
application of any of the artiﬁcial dissipation operators directly to
e
In the xy-plane the operations are summarised by the statement

Ak.

e

e

e

e
2
⊥ −

uE · ∇ −
in each equation; that is, artiﬁcial dissipation in both the xy-plane and the s-direction is applied to whatever is
advected by the gyroreduced ExB velocity. An alternative is a hyperdiﬀusion for the xy-plane, so that
uE · ∇

uE · ∇ →

uE · ∇ →

2
⊥ν⊥∇
∇

2
⊥ −

ν⊥∇

νk∇

(126)

(125)

+

2
k

2
k

νk∇
is used. For models with variable B these should be respectively changed to
uE · ∇ →

uE · ∇ − ∇ ·

2
s∇⊥ − ∇ ·

ν⊥ρ

(bνkb)

· ∇

and

with

uE · ∇ →

uE · ∇

+

2
∇

⊥ν⊥ρ4

2
⊥ − ∇ ·
s∇

(bνkb)

· ∇

ρ2
s =

1
B2

in normalised units, so that the property of positive deﬁniteness is preserved. If variable resolution causes problems,
then the metric elements in these forms should be replaced by their ﬂux surface averages.

Typical values of these dissipation coeﬃcients are set depending on the physical situation; in general they must
be set as small as possible. Full resolution is found when it can be shown the resulting grid dissipation rate (not

18

(120)

(121)

(122)
(123)
(124)

(127)

(128)

(129)

19

necessarily the answer for the transport ﬂuxes) is independent of the dissipation parameters. A resolution study will
generally not be done at a particular value of the coeﬃcient; rather, the coeﬃcient should be made smaller when the
resolution is increased. A window of operation opens when it is subsequently found that the above criteria for full
resolution is met. Tests on core turbulence with adiabatic electrons (νe = β = µe = 0) ﬁnd that ν⊥ as small as 10−2
ρs. Edge turbulence (C, ˆβ, ˆµ all unity or greater; cf. Section II and
is possible with resolutions of hx = hy = 1 or 2
Ref. [9]) requires hx = hy = 1
ρs
ρs or smaller to be able to reduce ν⊥ to as small as 3
a value of ν⊥ = 0.1 can be required, and this is generally too large to allow the vorticity dynamics in the range
0.5 < k⊥ρs < 1 to function properly. This is due to the robust nonlinear action by vE · ∇
ne in edge turbulence
[21]. Under these conditions the hyperdiﬀusion form is necessary to be able to reproduce the nonlinear drift wave
instability. For cold ion models (τi = 0) with no temperature dynamics, this instability can be reproduced with a
resolution of hx = hy = 2 and a hyperdiﬀusion of ν⊥ = 0.01.

10−2. With hx = hy = 2

×

×

×

×

e

The parallel dissipation coeﬃcients are easier as they are only needed to contain the cascade in the parallel wavenum-
10−3 for both ions and electrons are found to
ber kk by the nonlinear perpendicular dynamics. Values of νk = 3
be suﬃcient with hs = 2πqR/16, and for the most important wavenumber range
2 < kkqR < 2 these lead to small
corrections to the physical dissipation rates. It has been found necessary to use the same coeﬃcient for both ions and
electrons, to avoid artiﬁcial charge separation which can have a large eﬀect on the spectral region with kkqR moderate
and k⊥ρs small.

−

×

V. SELECTED COMPUTATIONAL RESULTS

It is not the purpose of this paper to enter detailed study of any of the problems the GEM model is to be applied
to; rather, the focus is upon the way energetics works in the model and to use that to assist consistent construction
of the model. Nevertheless, it is useful to apply the model brieﬂy herein to an elementary situation whose capture is
important (kinetic shear Alfv´en wave damping [33, 34]), a well known set of computational results (the Cyclone ITG
turbulence campaign [1]), and a demonstration that electron driven turbulence at scales below the ion gyroradius can
be addressed with a gyroﬂuid model (“ETG” [35]). The latter two cases will be treated in proper detail in the future.
ETG turbulence has been treated with a ﬂuid model before, but only with adiabatic ion models [36, 37, 38]. Herein,
we apply GEM directly and ﬁnd the ETG dynamics occurring naturally at its native scales.

A. Kinetic shear Alfv´en wave damping

Shear Alfv´en waves are well known from MHD [39], and the collisionless kinetic counterpart (KALF) is also well
known [40]. It has already been shown the gyrokinetic model treats them properly [33, 34]. We now use the result to
calibrate the model Landau damping coeﬃcient for the electrons.

{

K

×

×

32

16 in

x, y, s

We take a basic parameter case with ˆβ = 1 and ˆµ = 1 and ˆǫ = 18350 with both collisionalities set to zero as a
reference. The magnetic ﬁeld is straight and homogeneous (gxx = gyy = B = 1 with ˆs = 0 and
= 0) and there
are no background gradients (ωn = ωt = ωi = 0). The ions are cold (τi = 0 hence ρi = 0). The Pad´e version of the
local model is used. With the homogeneous situation, the proﬁle functions are set to zero and the domain is periodic
in both y and s. The perpendicular domain sizes are Lx = Ly = 2π/K, with K = 0.1. The parallel domain is one
ne.
connection length. The initial state is the sinusoidal disturbance
. The values of ˆβ and ˆµ, and the Landau damping model coeﬃcient aL0, were
The grid was 32
}
varied between 0.1 and 10. Artiﬁcial dissipation (ν⊥ and νk) was set to zero.

⊥ = (5/4)K 2. This range is found with the nominal sweep in ˆβ for ˆβ

The KALF dispersion relation, shown in Fig. 1, has the two standard asymptotic limits ˆβ/ˆµ

e
1 where
for these cases k2
1, and in the sweep in ˆµ
1, and is well captured by the GEM model as shown by the comparison to the kinetic result using the root
for ˆµ
ﬁnding method of Ref. [34]. When ˆβ
ˆµ there is substantial thermal electron resonance. In this regime the GEM
model shows a peak, but with the peak value and its location only approximately captured. In the sweep of aL0 the
damping rate was proportional to aL0 only for aL0 < 1. For aL0 > 1 the eﬀect is to remove the parallel heat ﬂux from
the dynamics, which becomes more ideal; hence the damping rate falls again. The maximum is found for aL0 = 1.6,
103γL < 9.6
which is close to the actual thermal resonance at √3. The damping rate varies within the interval 8.5 <
for 1 < aL0 < 2. As a robust model in the absence of ﬁtting for all possible cases, it appears to be suﬃcient to simply
leave aL0 = 1, and the model performs qualitatively well.

ne = 10−4 (1 + cos Kx) cos Ky cos s, with

1 and k2

⊥ ≪

ni =

≫

≫

≪

−

≈

e

e

20

(130)

(131)

B.

ITG turbulence

The standard of core turbulence studies with adiabatic electrons is the Cyclone project, which benchmarked a series
of models and computations against a particular case of hot ion collisionless turbulence and transport [1]. With the
only free energy source being the ion temperature gradient, this is called ITG turbulence. With adiabatic electrons
taken as a model ( ˆβ = ˆµ = C = 0), the parameter set is given by

The artiﬁcial dissipation coeﬃcients are ν⊥ = 0.01, using hyperdiﬀusion, and νk = 0.001. The boundary dissipation
coeﬃcient was 1.0. For the magnetic ﬁeld the simple circular tokamak model with globally consistent boundary
conditions and shifted metric coordinate system is used as detailed in Ref. [20]. The potential is initialised with a
random disturbance bath in x and y [7] and a parallel envelope following the ﬁeld lines from s = 0 [20], and an RMS
amplitude of 10−8. The Pad´e version of the global model is used. The basic proﬁle is given by

ωB = 0.290

ˆǫ = 93.4

ωt = ωi = τi = 1

ˆs = 0.78
ωn = 0.321

p0(x) =

Lx
2

1

sin

−

(cid:18)

πx
Lx (cid:19)

{
{

16 in
×
The four cases with ωi =

×

x, y, s
.
0.8, 1.0, 1.5, 2.2

}

Ti⊥) with ωiτip0. The adiabatic
and then both densities are initialised with ωnp0 +
form of the polarisation equation with proﬁles is used, with
= ωnp0(x), noting that ωt has no role for this
problem. The perpendicular domain sizes are Lx = Ly = 80π, roughly commensurate with the global tokamak
dimensions of a/ρs = 192 and 2πr/qρs = 350 (where r = a/2). The parallel domain is one connection length. The
grid was 128

φ and the ion temperatures (
nei
h

Tik,

128

e

e

e

e

}

were taken. Normalisation of the transport level is to Ln, following Ref.
vx
Ti⊥)
, is recast in terms of a transport
E
). Each run begins in a linear growth phase, overshoots to a transport level in
|

[1], so that the transport ﬂux in units of the nominal L⊥, Qi =
T
coeﬃcient by taking χi = Qi/(ωn |∇
)
the vicinity of χi = 10, and then saturates with the zonal ﬂow dynamics (the part of the ExB ﬂow arising from
reaching statistical equilibrium only well after t = 1000. Runs were taken to t = 4000. The transport is displayed
E
e
statistically, with a sample taken at intervals of ∆t = 10 in the phase 1000 < t < 4000. Slow relaxation of the
temperature proﬁle ﬁlls out the transport scaling curve. For each sample, the ﬂux and gradient were averaged over
all grid nodes in the part of the domain with 0 < x < Lx/4 before their ratio was computed.

Tik +

(0.5

D

E

D

φ

e

e

e

The resulting transport curve is shown in Fig. 2, wherein the triangle markers denote each sample (1200 in all), and
the dashed curve is the ﬁt to the gyrokinetic particle model results as given in Ref. [1]. Agreement at the 20% level
is found for most of the curve, and moreover the nonlinear threshold agrees within the statistical scatter. Moreover,
the fact that the groups of points from four decaying runs overlap well indicates the transport to be temporally local.

C. ETG turbulence

A class of turbulent dynamics at scales smaller than ρi driven by

Ti
is available as a drive because the ions are adiabatic (in the simplest treatments) or nearly so. Here, we carry both
electrons and ions with the full six moments and allow the spatial scale range kept in the particular case to determine
the dynamics. The Fourier version of the local model is used, with proﬁle functions ne = ni =
ωtx
ωix. The same magnetic geometry as in the ITG examples above is used. The same random bath as above
and Ti =
is used initially, but for

Te is called ETG [35]. Neither

ωnx and Te =

n nor

∇

∇

∇

−

−

−

ne.

e

Here we merely demonstrate the ability of the GEM model to capture this ETG turbulence for typical core pa-
rameters, the same as the one used for the ITG examples above, additionally with ˆβ = 0.464 and ˆµ = 0.0254 and
10−3 (using simple diﬀusion, not hyperdiﬀusion) and
νe = 0.0333. The artiﬁcial dissipation coeﬃcients were ν⊥ = 3
×
10−3. The spatial domain size was Lx = Ly = 4π/3 for
νk = 10−4. The initial RMS amplitude for
the drift plane and one connection length along the magnetic ﬁeld. The grid was 128
. The
10−4. The run was carried for 20L⊥/cs. With the minimum value of kyρi of 1.5, ITG activity is
timestep was 5
generally absent. The fastest growing spectral range is about 10 < ky < 20, representing structure scales ∆y = π/ky
on the order of 10ρe. The spatial morphology shows these to be radially extended, with ∆x > 8∆y. The nonlinear
transition begins at t
12. A very strong transport level is found, just under 0.1,
eVe/LT . The spectrum is broader than in the linear phase, but still narrow
which in terms of electron scales is χe ≈
compared to edge turbulence, and more importantly the transport spectrum peaks at ky = 10, very close to the linear

8 and saturation occurs after t

ne was a0 = 3

x, y, s

16 in

6ρ2

128

≈

×

×

×

×

≈

e

{

}

21

growth peak. The radially extended structures do persist in the saturated phase, by contrast to typical core ITG or
edge turbulence. These features, shown for both linear and nonlinear phases in Fig. 3, are the same as those shown
Tek is about
previously by nonlinear gyrokinetic studies [35]. The amplitude of the electron moment variables
0.2, while the corresponding ion variables are about two orders of magnitude smaller.

ne and

VI. SUMMARY

e

e

The standard local gyroﬂuid model has been placed on energetically consistent grounds, with the moment variables
and the electrostatic potential given a full ﬁnite Larmor radius (FLR) treatment at the same level of sophistication.
The FLR eﬀects on the magnetic potential and parallel velocities and heat ﬂuxes is left to the future. With these
changes it is possible to recover important results emerging from gyrokinetic computations, with a computationally
more tractable model. Large systems may be treated with full resolution with what at present time may be regarded as
modest computational resources. The model is ﬂexible, to the extent that the level of sophistication can be increased
or decreased while retaining energetic and geometric consistency. Both global and local situations can be treated.
Highly detailed dissipative linear closures as discussed in the main references [3, 4] are not necessary in many cases
of interest, in particular the one from the Cyclone study (Ref. [1]).

For proper edge turbulence (ˆµ > 1 and C > 1) in the electromagnetic regime ( ˆβ > 1) the model functions much as
in previous versions as published elsewhere [16]. Results from the two moment version GEM3 (density and parallel
velocity for both electrons and ions) are published elsewhere [9], showing the role of the three dimensional drift wave
nonlinear instability in the context of tokamak edge turbulence as done previously [21] for the corresponding ﬂuid
model. Work with cases with various ratios of ηi = ωi/ωn (cf. [21] for the role of this in the ﬂuid model) and with
two ion species is in progress.

[1] A. M. Dimits, G. Bateman, M. A. Beer et al, Phys. Plasmas 7 (2000) 969.
[2] G. Knorr, F. R. Hansen, J. P. Lynov, H. L. P´ecseli, and J. Juul Rasmussen, Physica Scripta 38 (1988) 829.
[3] W. Dorland and G. Hammett, Phys. Fluids B 5 (1993) 812.
[4] M. A. Beer and G. Hammett, Phys. Plasmas 3 (1996) 4046.
[5] M. Wakatani and A. Hasegawa, Phys. Fluids 27 (1984) 611.
[6] R. E. Waltz, Phys. Fluids B 2 (1990) 2118.
[7] B. Scott, Phys. Rev. Lett 65. (1990) 3289; Phys. Fluids B 4 (1992) 2468.
[8] B. Scott, Plasma Phys. Contr. Fusion 39 (1997) 1635.
[9] B. Scott, Plasma. Phys. Contr. Fusion 45 (2003) A385.

[10] P. Rutherford and E. A. Frieman, Phys. Fluids 11 (1968) 569; J. B. Taylor and R. J. Hastie, Plasma Phys. 10 (1968) 479.
[11] N. Krause, C. Lechte, J. Stoeber, U. Stroth, E. Ascasibar, J. Alonso, and S. Niedner, Rev. Sci. Instrum. 73 (2002) 3474.
[12] S.-T. Tsai, F. W. Perkins, and T. H. Stix, Phys. Fluids 13 (1970) 2108.
[13] F. L. Hinton and C. W. Horton, Jr, Phys. Fluids 14 (1971) 116.
[14] M. A. Beer, S. C. Cowley, and G. W. Hammett, Phys. Plasmas 2 (1995) 2687.
[15] B. Scott, Phys. Plasmas 5 (1998) 2334.
[16] B. Scott, Phys. Plasmas 7 (2000) 1845.
[17] W. W. Lee, Phys. Fluids 26 (1983) 556.
[18] S. I. Braginskii, Rev. Plasma Phys. 1 (1965) 205.
[19] E. V. Belova, Phys. Plasmas 8 (2001) 3936.
[20] B. Scott, Phys. Plasmas 8 (2001) 447.
[21] B. Scott, New J. Phys. 4 (2002) 52.
[22] B. Scott, Phys. Letters A 320 (2003) 53.
[23] A. B. Hassam, Phys. Fluids 23 (1980) 38.
[24] S. Camargo, B. Scott, and D. Biskamp, Phys. Plasmas 3 (1996) 3912.
[25] F. Y. Gang, B. D. Scott, and P. H. Diamond, Phys. Fluids B 1 (1989) 1331.
[26] B. Scott, H. Biglari, P. W. Terry, and P. H. Diamond, Phys. Fluids B 3 (1991) 51.
[27] B. Van Leer, J. Comput. Phys. 32 (1979) 101.
[28] P. Colella, J. Comput. Phys. 87 (1990) 171.
[29] V. Naulin, New J. Phys. 4 (2002) 28.
[30] A. Arakawa, J. Comput. Phys. 1 (1966) 119, repr J. Comput. Phys. 135 (1997) 103.
[31] G. E. Karniadakis, M. Israeli, and S. A. Orszag, J. Comput. Phys. 97 (1991) 414.
[32] J. M. Albert, P. L. Similon, and R. N. Sudan, Phys. Fluids B 2 (1990) 3032.
[33] W. W. Lee, J. Lewandowski, T.-S. Hahm, and Z. Lin, Phys. Plasmas 8 (2001) 4435.
[34] T. Dannert and F. Jenko, Comput. Phys. Comm. (2004) in press.

[35] F. Jenko, W. Dorland, M. Kotschenreuther, and B. N. Rogers, Phys. Plasmas 7 (2000) 1904.
[36] Horton, B. G. Hong, and W. M. Tang, Phys. Fluids 31 (1988) 2971.
[37] J. F. Drake, P. N. Guzdar, and A. B. Hassam, Phys. Rev. Lett. 61 (1988) 2205.
[38] B. Labit and M. Ottaviani, Phys. Plasmas 10 (2003) 126.
[39] J. P. Freidberg, Ideal Magnetohydrodynamics, (Plenum Press, New York, 1987).
[40] A. Hasegawa and L. Chen, Phys. Fluids 19 (1976) 1924.

22

23

(A1)

(A2)

(A4)

e

(A3)

APPENDIX A: SIMPLE CORRESPONDENCE BETWEEN FLUID AND GYROFLUID MODELS

A simple exercise using the most basic reduced MHD interchange model helps gain insight into the relationship
between the ﬂuid and gyroﬂuid models. We start with the two equations written down in the Introduction, writing
the electron density equation in terms of a charge density to equalise the units. For reasons which will become clear,
we retain the diamagnetic compression eﬀect in the density equation. We also incorporate the proﬁle variation of
the thermal state variables, normally acted up solely by ExB advection or magnetic ﬂutter, into the corresponding
dependent variables (the only diﬀerence this makes is that
now acts upon the proﬁles, which is actually somewhat
more realistic). The equations are

K

d
2
⊥
dt ∇

φ =

−

= nee

e
φ)
(

K

−

TeK
TeK

ne)
(

ne)
(
e

niMic2
B2
d
ne
dt
e

e

N e =

nee

niMic2

2
B2 ∇
⊥

−

φ

e

with d/dt representing the ExB advective derivative. We now deﬁne arbitrarily an auxiliary variable,

N , as

e

e

The evolution equation for

e
N is found therefore by subtracting Eqs. (A1,A2),

e

e

e

d
N
dt
e

= nee

φ)
(

K

By inspection with any of the gyroﬂuid models, we ﬁnd that N is simply the gyrocenter ion density ni, with the sole
proviso that the background constant parameters for ne and ni are equal. This tells us that the MHD formulation for
the ExB vorticity is identical to the cold-ion limit of the polarisation density in the gyroﬂuid model. The relation here
is between the polarisation current in the ﬂuid model and the polarisation density in the gyroﬂuid model. The MHD
interchange term
ne) appears properly only if the diamagnetic compression eﬀect is kept in the gyroﬂuid density
(
equations (i.e., unlike for a ﬂuid model, this eﬀect cannot be neglected in a gyroﬂuid model). The ExB compression
eﬀect in the density cancels out of the interchange eﬀect in the vorticity. However, it is necessary in either model to
retain the ExB compression in order to conserve energy. The incidental beneﬁt is to retain the geodesic curvature
eﬀect which is the principal mechanism limiting the growth of zonal ﬂows [22].

K

e

e

More detailed accounts of the correspondence between the ﬂuid and gyroﬂuid models may be found elsewhere

[3, 9, 19].

FIGURE CAPTIONS

24

Figure 1. Kinetic shear Alfv´en damping rates versus normalised beta, electron mass, and Landau damping
closure coeﬃcient. In the leftmost two frames the blue line (whose peak is toward lower ˆβ values and higher ˆµ values)
µe regime and
gives the kinetic dispersion relation using the method of Ref. [34]. The calibration works in the βe ≫
yields qualitatively similar behaviour elsewhere, though the details of the peaks can only be captured with a kinetic
model.

Figure 2. Transport of ITG turbulence found by GEM (triangles, one per sample as described in the text),
compared to the gyrokinetic ﬁt from Ref. [1]. The transport diﬀusivity, χi, calculated temporally as described in the
text, is normalised to a nominal value of χ0 = ρ2
scs/Ln. The fact that the groups of points from four decaying runs
overlap well indicates the transport to be temporally local.

Figure 3. Transport spectra and density morphology in core ETG turbulence in the linear (left) and saturated
(right) phases, as described in the text. Lines marked ’n’ and ’N’ are for the particle ﬂux, where it is positive or
negative, respectively. Lines marked ’t’ and ’i’ are for the electron and ion conductive heat ﬂuxes, respectively. The
scales are normalised to ρs; multiply

and divide ky by 60.6 to obtain them in terms of ρe.

x, y

{

}

25

FIG. 1: Kinetic shear Alfv´en damping rates versus normalised beta, electron mass, and Landau damping closure coeﬃcient.
In the leftmost two frames the blue line (whose peak is toward lower ˆβ values and higher ˆµ values) gives the kinetic dispersion
relation using the method of Ref. [34]. The calibration works in the βe ≫ µe regime and yields qualitatively similar behaviour
elsewhere, though the details of the peaks can only be captured with a kinetic model.

26

FIG. 2: Transport of ITG turbulence found by GEM (triangles, one per sample as described in the text), compared to the
gyrokinetic ﬁt from Ref. [1]. The transport diﬀusivity, χi, calculated temporally as described in the text, is normalised to a
nominal value of χ0 = ρ2
scs/Ln. The fact that the groups of points from four decaying runs overlap well indicates the transport
to be temporally local.

27

FIG. 3: Transport spectra and density morphology in core ETG turbulence in the linear (left) and saturated (right) phases,
as described in the text. Lines marked ’n’ and ’N’ are for the particle ﬂux, where it is positive or negative, respectively. Lines
marked ’t’ and ’i’ are for the electron and ion conductive heat ﬂuxes, respectively. The scales are normalised to ρs; multiply
{x, y} and divide ky by 60.6 to obtain them in terms of ρe.

