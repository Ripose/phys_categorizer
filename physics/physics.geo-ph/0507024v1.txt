Renormalization of the ETAS branching model of triggered seismicity

APS preprint

from total to observable seismicity

A. Saichev1, 2 and D. Sornette3, 4

1Mathematical Department, Nizhny Novgorod State University,

Gagarin prosp. 23, Nizhny Novgorod, 603950, Russia

2Institute of Geophysics and Planetary Physics,

University of California, Los Angeles, CA 90095

3Institute of Geophysics and Planetary Physics and Department of Earth and Space Sciences,

University of California, Los Angeles, CA 90095

4Laboratoire de Physique de la Mati`ere Condens´ee,
CNRS UMR 6622 and Universit´e de Nice-Sophia Antipolis, 06108 Nice Cedex 2, France∗

(Dated: February 2, 2008)

5
0
0
2
 
l
u
J
 
4
 
 
]
h
p
-
o
e
g
.
s
c
i
s
y
h
p
[
 
 
1
v
4
2
0
7
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

Abstract

Several recent works point out that the crowd of small unobservable earthquakes (with magnitudes

below the detection threshold md) may play a signiﬁcant and perhaps dominant role in triggering future

seismicity. Using the ETAS branching model of triggered seismicity, we apply the formalism of generating

probability functions to investigate how the statistical properties of observable earthquakes diﬀer from

the statistics of all events. The ETAS (epidemic-type aftershock sequence) model assumes that each

earthquake can trigger other earthquakes (“aftershocks”). An aftershock sequence results in this model

from the cascade of aftershocks of each past earthquake. The triggering eﬃciency of earthquakes is

assumed to vanish below a lower magnitude limit m0, in order to ensure the convergence of the theory and

may reﬂect the physics of state-and-velocity frictional rupture. We show that, to a good approximation,

the ETAS model is renormalized onto itself under what amounts to a decimation procedure m0 → md,

with just a renormalization of the branching ratio from n to an eﬀective value n(md). Our present

analysis thus conﬁrms, for the full statistical properties, the results obtained previously by one of us and

Werner, based solely on the average seismic rates (the ﬁrst-order moment of the statistics). However, our

analysis also demonstrates that this renormalization is not exact, as there are small corrections which can

be systematically calculated, in terms of additional contributions that can be mapped onto a diﬀerent

branching model (a new relevant direction in the language of the renormalization group).

∗Electronic address: sornette@moho.ess.ucla.edu

2

I.

INTRODUCTION

In the last few years, physicists’ interest for the space-time organization of seismicity in diﬀerent

regions of the world has spurred. This recent burst of attention is probably due to the introduction

of new diagnostic tools applied to earthquake catalogs [1–19] and to improved insights from cartoon

models of earthquakes [20–25]. The ﬁrst class of papers in particular suggest to re-examine the

standard statistical properties of earthquakes, usually documented under the following distinct

power law and fractal properties: (i) the Gutenberg-Richter distribution ∼ 1/E1+β (with β ≈ 2/3)

of earthquake energies E [26]; (ii) the Omori law ∼ 1/tp (with p ≈ 1 for large earthquakes) of

the rate of aftershocks as a function of time t since a mainshock [27]; (iii) the productivity law

∼ Ea (with a ≈ 2/3) giving the number of earthquakes triggered by an event of energy E [28];

(iv) the power law distribution ∼ 1/L2 of fault lengths L [29]; (v) the fractal structure of fault

networks [30] and of the spatial organization of earthquake epicenters [31]; (vi) the distribution

1/s2+δ (with δ ≥ 0) of seismic stress sources s in earthquake focal zones due to past earthquakes

[32]. Speciﬁcally, the statistical analysis based on (a) coarse-grained scaling ansatz [1, 2, 7–9, 13]

(b) entropic methods [4, 15], and (c) network methods [6, 10–12] suggest that the above standard

seismological description [26–32] may be inadequate. It is not clear however what should be the

correct physical model. Several papers have however questioned the novelty of the insights derived

from these approaches [2, 5, 16].

The present authors are among those who have studied how the standard seismological laws

[26–32] (in particular the laws (i)-(iii) mentioned above) could actually go a long way towards

explaining most of the empirical phenomenology of seismicity, including the supposed anomalous

or “novel” scaling laws proposed by the above quoted physicists (see for instance [33–38]). In this

series of papers, we have developed a consistent statistical description of seismicity using models

of triggered seismicity, which allows one to make quantitative predictions of observables that can

be compared with empirical data. The simplest class of models of triggered seismicity combines

the above mentioned Gutenberg-Richter (i), Omori (ii), and productivity laws (iii) which can be

applied to a fractal spatial geometry of earthquake epicenters (v) [38]. The fundamental physical

ingredient is that each earthquake can trigger other earthquakes and an earthquake sequence

results in this model from the cascade of events triggered by past earthquakes. The usual notions

of foreshocks, mainshocks and aftershocks lose their speciﬁcity as any earthquake can be triggered

3

by previous earthquakes and may trigger itself subsequent earthquakes. Here, we continue our

study of the general branching process, called the Epidemic-Type Aftershock Sequence (ETAS)

model of triggered seismicity, introduced by Ogata in the present form [39] and by Kagan and

Knopoﬀ in a slightly diﬀerent form [40] and whose main average statistical properties are reviewed

in [41]. This model has been shown to constitute a powerful null hypothesis to test against other

models [39]. The ETAS model belongs to a general class of branching processes [42, 43]. It can

be viewed as the monofractal approximation of the more general multifractal model of triggered

seismicity introduced recently in [24, 25], which derives from the physics of thermally activated

rupture aided by stress.

The physical problem addressed here is the following. We start from the empirical evidence

[28, 44] that small earthquakes dominate or are at least equivalent collectively to large earthquakes

in triggering other earthquakes. This can be seen by combining the Gutenberg-Richter law (i)
∝ 10−bm and the productivity law (iii) ∝ 10αm to obtain the typical number ∝ 10−(b−α)m of events

triggered by earthquakes of magnitude between m and m+1. With the empirical estimates of b ≈ 1

and 0.8 ≤ α ≤ 1 together with the observation that triggered events seem to have magnitudes with

only weak or no relation with the magnitude of the triggering event (magnitude-independence law)

[44] (i.e., large earthquakes can be triggered by small events), this implies the perhaps surprising

conclusion that large earthquakes are triggered more by the swarm of small previous earthquakes

than by preceding large earthquakes. This stems from the observation that the number of small

earthquakes increases faster as their magnitude decrease than their productivity decreases. The

conclusion that small earthquakes dominate triggering is thus intrinsically a collective eﬀect. This

picture, which emphasizes the collective organization of earthquakes or “many-body” view, can be

contrasted with the “one-body” or few-body approach of R. Stein and co-workers [45, 46] which

focuses exclusively on how a few large earthquakes can promote subsequent shocks at some sites

and inhibit them in others. If indeed the small earthquakes dominate in the triggering of future

events, this begs to deﬁne how small “small” can be, since the smaller the earthquakes the larger

their triggering inﬂuence. The evidence that small earthquakes should dominate triggering is based

on the empirical statistics (i) and (iii) established for event magnitudes above magnitude 2 or 3

(depending on the completeness of the studied catalogs). The question of how small “small”

is amounts to asking how far in the small magnitude range can the productivity law and the

magnitude-independence law be extrapolated. Because the Gutenberg-Richter law (i) has been

4

observed at such small scales as individual dislocation motions, we know for sure that there must be

a lower “ultra-violet” cut-oﬀ magnitude m0 at which the productivity of events of magnitude smaller
than m0 tapers oﬀ or vanishes. Otherwise, the factor ∝ 10−(b−α)m would diverges as m → −∞

(energy goes to zero). Is the ultra-violet cut-oﬀ associated with an atomic scale for rupture? Or are

other relevant scales? This question has been addressed in two recent papers by M. Werner and one

of us [47, 48] within the framework of the ETAS model. Consider a catalog complete for magnitudes

above some observational threshold md, i.e., all earthquakes with magnitudes m ≥ md have been

recorded but smaller earthquakes are not. Noting that the magnitude md of completeness of a

seismic catalog is not in general the same as the magnitude m0 of the smallest triggering earthquake,

Ref. [47] showed that bounds for m0 can be obtained from quantitative ﬁts to observed aftershock

sequences.

In addition, Ref. [48] remarked that, in models of triggered seismicity and in their

estimation from empirical data, the detection threshold md is commonly equated to the magnitude

m0 of the smallest triggering earthquake. This unjustiﬁed assumption neglects the possibility of

shocks below the detection threshold triggering observable events, a process which should dominate

according to our previous discussion. Ref. [48] developed a mean ﬁeld formalism within the ETAS

model: by considering the branching structure of one complete cascade of triggered events, the

catalog of observed events with magnitude above md was shown to be described by an eﬀective

“renormalized” ETAS model with its lower magnitude cut-oﬀ equal to md but with an apparent

branching ratio na (which is the apparent fraction of aftershocks in a given catalog) and an apparent

background source Sa, due to the presence of smaller undetected events capable of triggering larger

events. This result is potentially very important since it implies that previous estimates of the

clustering characteristics of seismicity may signiﬁcantly underestimate the true values: for instance,

an observed fraction of 55% of aftershocks is renormalized into a true value of 75% of triggered

events.

The object of the present paper is to extend the previous mean ﬁeld treatment to obtain the

full earthquake statistics using the formalism of generating probability function (GPF) already

developed in [35–38].

In a sense, the question addressed here is whether the ETAS model can

be renormalized onto itself by moving m0 to md > m0 (which can be seen as a coarse-graining

operation), that is, is there an eﬀective ETAS model with minimum magnitude md and with renor-

malized parameters, which describes the observed catalogs? Beyond its interest and application

to earthquakes, this problem is relevant to a general understanding of coarse-grained properties of

5

marked branching processes, to which our formalism applies.

The organization of the paper is the following. Section II A introduces the general formulation

of observable clusters of triggered events using the generating probability functions (GPF). It also

presents a simple intuitive approximation which will be make rigorous in later sections. Section

II B derives general relations for the eﬀective branching rates of observable events. Section II C

deﬁnes the ETAS model and recalls its main useful properties. Section II D introduces the GPF

for unobservable and observable aftershocks. Section II E gives the main properties of the eﬀective

branching rates, which recover the previous analysis of [48] in a slightly diﬀerent form. Section

II F explains that the present approach and that of [48] are equivalent physically but with a

diﬀerent mathematical formulation. The justiﬁcation for introducing a physically equivalent but

mathematically diﬀerent formulation here is that it is more adapted to the calculations of the full

statistics with the GPF formalism. Section III presents all our results on the statistics of observable

events in the ETAS branching model. Section III A derives the general equation governing the GPF

of observable events. Section III B use the derivation of the previous section to give quantitative

estimates for the fraction of observable events. Section III C discusses the approximation of self-

similarity, corresponding to a renormalization of the ETAS model onto itself by the change from m0

to md. This self-similarity amounts to say that the statistics of observable events can be deduced

entirely from the statistics of all events under a simple renormalization of the average branching

ratio into an eﬀective value. Section III D derives the implications of the self-similar approximation

for the distribution of the numbers of observable events. Section III E discusses the deviations from

self-similarity and identiﬁes a correction in the form of a new branching model, which gives rather

small corrections to the previously self-similar estimates. The last section concludes.

II. DEFINITION AND PROPERTIES OF EFFECTIVE RATE OF OBSERVABLE AF-

TERSHOCKS

A. General formulation of observable clusters

In this section, we present the general formulation of generating probability function (GPF) for

marked branching processes with an observational constraint. Recall that, for general branching

processes such as the ETAS model, the GPF formalism allows one to calculate the full statistical

6

properties. Here, the mark associated with an event is its magnitude. The observation constraint

is that only events with magnitude m ≥ md, where md is the observation threshold, are known,

while the process produces events which can have a lower magnitude, down to a lower triggering

cut-oﬀ m0.

To get a ﬁrst feeling of how the observational constraint can be taken into account in the

GPF formalism, consider the case of a large ﬁnite time window of size τ in which we count the

number of events and let us use the approach developed in [36] for the statistics of the number of

such windowed events. The time windows are considered large if their size is signiﬁcantly larger

than the typical life-time of the clusters, deﬁned as the sequence of aftershocks, triggered by single

background event (see [36] for a discussion). In this limit, the statistics of the total (observable and

unobservable) number of events in a window of size τ is obtained from the generating probability

function (GPF) Θw(z; τ ), which obeys the following equation

Θw(z; τ ) = eωτ [Θ(z)−1] .

Θ(z) is the GPF of the number of all the aftershocks triggered by a given source, including the

source event itself and ω is the Poisson intensity of the background sources. We have shown [35]

that Θ(z) has the structure

Θ(z) = zG(z) ,

where the factor z to the left of G(z) takes into account the contribution of the background source,

while the GPF G(z) describes the statistics of the number of all aftershocks within a given cluster

In view of (2), the GPF for ﬁnite time windows given by (1) is the natural generalization of the

GPF obtained for the Poissonian background events:

Θb(z; τ ) = eωτ (z−1) .

Now, the statistics of observable events requires to replace the GPF Θ(z) in (1) by the GPF

Θ(z; md) of the number of aftershocks (and their sources) whose magnitudes m are larger than the

detection threshold md to obtain

Note that some clusters might have no observable events at all. This means that there is a non-zero

probability

(1)

(2)

(3)

(4)

(5)

Θw(z; md, τ ) = eωτ [Θ(z;md)−1] .

p(md) = Θ(z = 0; md) 6= 0

7

that the cluster is completely unobservable. The complementary probability

q(md) = 1 − p(md) = 1 − Θ(0; md)

(6)

is the probability that there is at least one observable event (source or some aftershock) in the

cluster under inspection. In what follows, we refer to a cluster as “observable,” if it contains at

least one observable event (with magnitude m ≥ md). Accordingly, q(md) deﬁned in (6) is the

probability that a cluster is observable; it is also the fraction of observable clusters.

It is convenient to express the GPF Θ(z; md) in the form

where

Θ(z; md) = q(md) ˜Θ(z; md) + 1 − q(md) ,

˜Θ(z; md) =

1
q(md)

[Θ(z; md) − Θ(0; md)]

is nothing but the conditional GPF of the number of observable events within observable clusters.

This deﬁnition implies that it has the same structure

˜Θ(z : md) = z ˜G(z; md) ,

as that given by (2) of the GPF Θ(z) of the total number of events belonging to some cluster.

Expression (9) implies that one can treat the observable event which comes ﬁrst in time as the
“observable source,” and then interpret ˜G(z; md) as the GPF of its observable aftershocks.

Substituting (7) into (4) obtains the following representation for the GPF of the number of

observable windowed events

where

Θw(z; md, τ ) = eω(md)τ [ ˜Θ(z;md)−1] ,

ω(md) = ωq(md)

(7)

(8)

(9)

(10)

(11)

is the renormalized intensity of “observable sources,” which is the same as the intensity of observable

clusters by deﬁnition.

There is a physically transparent way to estimate the probability q(md) that a cluster is observ-

able. It is indeed always possible to represent q(md) in the form

q(md) = q+(md)Q(md) + q−(md)[1 − Q(md)] .

(12)

8

Here, q+(md) (respectively q−(md)) is the probability that the cluster is observable under the

condition that its generating source is also observable (respectively unobservable).

In addition,

Q(md) is the probability that the source is observable. Obviously, we have

q+(md) ≡ 1 ,

q−(md) = 1 − p−(md) ,

(13)

where p−(md) is the probability that all aftershocks triggered by an unobservable event are unob-
servable. To estimate p−(md), we make the assumption that each unobservable event either triggers

only one ﬁrst-generation aftershock, with probability ν(md), or does not trigger any aftershocks

with the probability 1 − ν(md). This approximation is quite reasonable, as can be seen from the

application of the productivity law ∼ Ea ∼ 10αm (with a ≈ 2/3, α ≈ 1): if an event of magnitude

m = 7 produces about 105 observable events on average, an event of magnitude 2 triggers about 0.1

events on average. In this example, ν(md) ≈ 0.1 and 1 − ν(md) ≈ 0.9 and the error in neglecting

the possibility for this event to trigger two aftershocks is of order 0.01. This error becomes even

smaller for smaller unobservable sources.

Suppose additionally that the magnitudes of the triggered aftershocks are statistically indepen-

dent of each other. Then, the probability that all aftershocks, triggered by an unobservable event,

are unobservable, is given by

p−(md) ≃

[1 − ν(md)]νk(md)[1 − Q(md)]k ,

∞

Xk=0

where (1 − ν)νk are the geometrical probability that an unobservable event triggers k aftershocks,

while (1 − Q)k is the probability that they are all unobservable. After summation, we obtain

Substituting this expression into (13) and then (13) into (12), we obtain the probability that a

cluster is observable under the form

p−(md) ≃

1 − ν(md)
1 − ν(md)[1 − Q(md)]

.

q(md) ≃

Q(md)
1 − ν(md)[1 − Q(md)]

.

In the following, we obtain with the framework of the ETAS model, a physically transparent

relation for the probability ν(md), which will allow us to obtain an accurate estimation of the

probability q(md) given by (16) and the corresponding renormalized intensity ω(md) of “observable

sources” given by (11). Speciﬁcally, the role of ν(md) is derived in expression (37) below for the

GPF of ﬁrst-generation aftershocks triggered by unobservable event.

9

(14)

(15)

(16)

B. Eﬀective observable aftershocks rate

Before turning to the speciﬁcs of the ETAS model and its statistics of observable events, it is

useful to discuss the properties of the average rate of general branching processes. The results

obtained in this section recover those obtained in [48] within a slighly diﬀerent interpretation, that

we present to be self-contained and to connect with the subsequent derivation of the full number

statistics in following sections.

It is well-known that the key parameter controlling the properties of cascades of triggered events

is the branching rate n, which is nothing but the average number of ﬁrst generation aftershocks,

where the average is performed over all possible triggering event of arbitrary magnitude. The cases

n < 1, n = 1 and n > 1 correspond respectively to the sub-critical, critical and super-critical

regimes, with the ﬁrst-two giving stationary time series in the presence of a stationary immigration

of sources and the later giving explosive time series with a positive probability [41–43].

In branching processes (of which the ETAS model is an example), we can use the representation

that each shock triggers independently its own aftershocks sequence (see [48] for a discussion on

the two interpretations in terms of decoupled branches used here or of collective triggering; the two

views are equivalent due to the linear sum over past events and the conditional Poisson process

formulation). The independence between diﬀerent branches allows us to obtain the average hRi of

the total number of events (mainshock itself and all its oﬀsprings over all geneations) triggered by

an arbitrary mainshock as [49]

hRi = 1 + n + n2 + · · · =

1
1 − n

,

where nk is the contribution of the k-th generation of aftershocks. Thus, if the average number

hRi of events per cluster is known, the aftershocks rate can then be obtained as

(17)

(18)

This simple remark will be useful in the following to derive an apparent or renormalized branching

ratio n(md) and test its usefulness to describe the full number statistics.

The average number of observable events, which are triggered by some arbitrary source, is simply

n given by (18) multiplied by the probability Q(md) that an event is observable:

Q(md) =

P (m)dm ,

(19)

n =

hRi − 1
hRi

.

∞

md

Z

10

where P (m) is the probability density function (PDF) of their random magnitudes (assumed to be

the same for sources and all aftershocks). This gives

Consider now the conditional average h ˜Ri(md) of the number of observable events within some

observable cluster. It is simply given by

hRi(md) = hRiQ(md) =

Q(md)
1 − n

.

h ˜Ri(md) =

hRi(md)
q(md)

=

Q(md)
(1 − n)q(md)

.

This quantity h ˜Ri(md) can not be derived as straightforwardly as the average number hRi over all

events obtained with (17). Indeed, an observable cluster may result from an eﬀective “observable

source” which might belong, for instance, to the 3-th or even 7-th generation of the total after-

shock sequence. Moreover, it seems impossible to classify uniquely observable events of observable

clusters as belonging to observable aftershocks of ﬁrst, second or k-th generations. Therefore, it
is not possible to use for h ˜Ri(md) the reasonings underlying relation (17). Notwithstanding this

limitation, we can introduce an eﬀective branching ratio for observed clusters, based on a natural

extension of relation (18). Let us thus deﬁne the eﬀective branching ratio of observable clusters as

With (21), this gives

Substituting in (23) the r.h.s. of equality (16) yields

n(md) =

h ˜Ri(md) − 1
h ˜Ri(md)

.

n(md) =

Q(md) − (1 − n)q(md)
Q(md)

n(md) ≃

n − ν(md)[1 − Q(md)]
1 − ν(md)[1 − Q(md)]

.

,

expressing the eﬀective average aftershock rate via the probability Q(md) that a background event

is observable and the probability ν(md) that an unobservable background event triggers some

ﬁrst-generation aftershock.

C. Basic properties of the ETAS model

To make further progress and in particular to calculate the probability q(md) given by (16) that

a cluster is observable and to obtain the eﬀective branching rate n(md) given by (24), we need

11

(20)

(21)

(22)

(23)

(24)

to specify the properties of ETAS branching model. The ETAS model is deﬁned by the following

rules. Each event of magnitude m triggers a Poissonian sequence of aftershocks characterized by

the Poissonian GPF [35]

G1(x; m|κ) = eκµ(m)(z−1) ,

where κµ(m) is the average number of ﬁrst generation aftershocks triggered by a mainshock of

magnitude m, κ is a numerical constant and µ(m) describes the so-called productivity law, i.e., the

dependence of the number of ﬁrst generation aftershocks number on the mainshock magnitude m.

Previous empirical studies have established that the productivity law is approximately exponential

[28, 44]:

µ(m) = 10α(m−m0) .

with an exponent α in the range 0.8 − 1. Here, m0 is the lower magnitude threshold below which

events are supposed not to be able to trigger any aftershock. The ETAS model also uses the

well-known Gutenberg-Richter (GR) law for the PDF of earthquake magnitudes

P (m) = b ln(10)10−b(m−m0) , with b ≈ 1 ,

which are assumed to be independently drawn at each event occurrence. Averaging the GPF

deﬁned by (25) over all possible random source magnitudes m weighted by the GR distribution

(27), we obtain the GPF of ﬁrst generation aftershock numbers triggered by an arbitrary source:

G1(z|κ) = F [κ(1 − z)] ,

where

F (x) = γ

∞

e−κxy dy

yγ+1 = γyγΓ(−γ, y) ,

1
Z

γ =

b
α

,

and Γ(−γ, y) is the incomplete Gamma function. In the sequel, we shall use the following power

law expansion of the function F (x)

F (x) ≃ 1 −

x + β xγ ,

β = γΓ(−γ) =

γ
γ − 1

Γ(2 − γ)
γ − 1

.

Thus, for γ → 1+, both coeﬃcients of x and xγ grow together.

Our previous calculations have shown that this expansion is very accurate for γ ≤ 1.25, which

is the relevant range [35–38].

(25)

(26)

(27)

(28)

(29)

(30)

12

(31)

(32)

(33)

(34)

This expansion (30) allows us to express the main properties of the statistics of the number

of aftershocks. For this, let us substitute (30) into (28) to obtain the corresponding approximate

expression for the GPF of the number of ﬁrst generation aftershocks

G1(z|κ) ≃ 1 − n(1 − z) + βκγ(1 − z)γ ,

where

is the average aftershock branching ratio, i.e., the average hR1i of the total number of ﬁrst gen-

eration aftershocks triggered by an arbitrary source. Recall that the last term βκγ(1 − z)γ in the

r.h.s. of expression (31) expresses the property that the distribution P1(r|κ) of the total number

of ﬁrst generation aftershocks triggered by an arbitrary source has a power law tail

n = hR1i =

γκ
γ − 1

P1(r|κ) ≃

γκγ
r1+γ .

Expression (33) is the leading asymptotic of the exact expression

P1(r|κ) =

1
r!

drG1(z|κ)
dzr

κγ
r!

= γ

Γ(r − γ, κ) ,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
corresponding to the exact GPF (28) of the number of ﬁrst generation aftershocks. Ref. [35] has

z=0

shown that the power law (33) leads to a PDF of the total number of aftershocks of all generations

which are triggered by an arbitrary source, which has a fatter tail ∼ 1/r1+(1/γ), close to criticality

n ≈ 1 .

D. Observable and unobservable aftershocks

Let us now consider a diﬀerent averaged GPF (25) obtained by using a truncated GR law

constrained to unobservable earthquakes (with magnitudes m between m0 and md):

P −(m|md) =

b ln(10)10−b(m−m0)
1 − Q(md)

H(md − m)H(m − m0) ,

(35)

where H(x) is the unit step (Heaviside) function and Q(md) = 10−b(md−m0) according to (19) and

(27) is the probability for an earthquake to be observable. Averaging expression (25) over all

13

(36)

(37)

(38)

(39)

magnitudes weighted by P −(m|md) given by (35) yields the GPF of the number of ﬁrst-generation

aftershocks triggered by an unobservable event:

G−

1 (z|κ, md) =

F [κ(1 − z)] − Q(md)F [κµ(md)(1 − z)]
1 − Q(md)

,

Substituting the expansion (30) in (36) yields ﬁnally

G−

1 (z|κ, md) ≃ 1 − ν(md)(1 − z) + O[(1 − z)2] ,

where the coeﬃcient ν(md) appears here from its deﬁnition as the probability that an unobservable

background event triggers some aftershock. The expansion (37) at this linear order for the GPF

of ﬁrst-generation aftershocks triggered by unobservable event is equivalent to saying that an

unobservable event can trigger at most a single aftershock, in agreement with the approximation

used to obtain (15) and (16).

Expressions (30) and (36) thus yield

ν(md) = n

1 − ρ(md)
1 − Q(md)

,

ρ(md) = Q(md)µ(md) = [µ(md)]1−γ

where

sources:

describes the competition between the GR and productivity laws at the observational magnitude

threshold md. Multiplying (38) by the fraction 1−Q(md) of unobservable sources yields the average
number hR−
1 i of ﬁrst generation aftershocks triggered by an unobservable source. hR−
1 i can be
interpreted as the branching rate n−(md) of ﬁrst-generation aftershocks triggered by unobservable

hR−

1 i(md) = n−(md) = n[1 − ρ(md)] .

(40)

Note that the GPF (37) does not contain a term of the form ∼ (1 − z)γ as in (31), which was

responsible for the power law tail (33) of the PDF of the total number of ﬁrst generation aftershocks.

As a consequence, the tail of the PDF of ﬁrst-generation aftershocks triggered by unobservable

sources is thinner than a power law. The power law tail (33) is simply due to the interplay between

the productivity law (26) and the GR law (27) for the sources. Now, constraining the source

magnitudes to be smaller than md truncates the GR law and thus the PDF of the number of

ﬁrst-generation events.

14

Let us now turn to the statistics of ﬁrst-generation aftershocks triggered by observable sources.

The corresponding GPF is obtained by averaging (25) over all magnitudes weighted by the following

modiﬁed GR law:

This leads to

P +(m; md) =

H(m − md) = b ln(10)10−b(m−md)H(m − md) .

P (m)
Q(md)

Note that expression (42) diﬀer from the GPF (28) of the total number of ﬁrst-generation events

only through the renormalization

G+

1 (z|κ, md) = F [κµ(md)(1 − z)] .

κ

→

κ(md) = κµ(md) .

This allows us to interpret the average number of ﬁrst-generation aftershocks triggered by an

arbitrary observable source as an eﬀective branching rate n+(md) equal to

hR+

1 i = n+(md) = nκ(md)Q(md) = nρ(md) ,

where ρ(md) is deﬁned by (39). Not surprisingly, the PDF of the number of ﬁrst-generation

aftershocks triggered by observable background events has a power law tail,

P +

1 (r|κ, md) =

1
r!

drG+

1 (z|κ, md)

dzr

,

z=0

(cid:12)
(cid:12)
(cid:12)
(cid:12)

These diﬀerent results are summarized in Figure 1 which shows the PDF’s P +

1 (r|κ, md) and

P −

1 (r|κ, md) as a function of the number r of events obtained from the exact relation (34), for two

analogous to (33).

diﬀerent values of µ(md).

(41)

(42)

(43)

(44)

(45)

E. Properties of eﬀective aftershock rates

We are now armed to discuss in the framework of the ETAS model the properties of the prob-

ability q(md) given by (16) for a cluster to be observable and the corresponding expression (24)

for the eﬀective branching rate n(md) of observable clusters. Note again that the expansion (37)

at this linear order writes that an unobservable event can trigger at most a single aftershock, in

15

agreement with the approximation used to obtain (15) and (16). This entitles us to substitute (38)

into (16) and (24) to obtain

and

q(md) =

Q(md)
1 − n[1 − ρ(md)]

n(md) =

nρ(md)
1 − n[1 − ρ(md)]

,

,

where ρ(md) is deﬁned by (39). In the following sections, these two relations (46) and (47) will

be derived from the exact equations obeyed by the GPF’s of the number of aftershocks over all

generations. In the mean time, let us discuss their properties and seismological implications.

Using the notations (40) and (44), we can rewrite the eﬀective rate (47) of observable clusters

in the form

n(md) =

n+(md)
1 − n−(md)

,

and interpret it as the rate n+(md) of aftershocks triggered by observable sources, ampliﬁed by the

impact of aftershocks triggered by unobservable sources since the denominator in (46) and (47)

describes the inﬂuence of aftershocks triggered by unobservable sources.

First, notice that, in critical case n = 1, we have n(md) ≡ 1. Thus, the critical regime for all

events is also critical for observable events. In this case, the probability q(md) that a cluster is

observable is given by

q(md) = µ−1(md)

(n = 1) ,

and decreases as the observation threshold md increases, which parallels the intensity of eﬀective

observable sources given by (11).

Two cases are worth discussing. For

n−(md) = n[1 − ρ(md)] ≪ 1 ,

which corresponds to a negligible productivity of unobservable events, then the impact of unob-

served sources is small and

q(md) ≃ Q(md) ,

n(md) ≃ n+(md) = nρ(md) ,

as if all aftershocks, which are triggered by observable sources, were observable.

In contrast, for

(46)

(47)

(48)

(49)

(50)

(51)

(52)

ρ(md) ≪ 1 ,

16

(53)

(54)

(55)

we have

Thus, for

[48]

q(md) ≃

Q(md)
1 − n

,

n(md) ≃

nρ(md)
1 − n

,

where the factor 1/(1−n), quantifying the impact of clusters triggered by unobservable background

events, becomes predominant.

Expression (47) can be rewritten as

n(md) =

1 + 1−n
n

1
[µ(md)]γ−1 .

md − m0 ≪ ∆∗ ≡

1
b − α

log10

n
1 − n (cid:19)

(cid:18)

,

the eﬀective aftershocks rate is critical: n(md) ≃ n. For example, if n = 0.9, b = 1 and α = 0.8 we
have ∆∗ ≃ 4.77. Figure 2 (respectively 3) shows the dependence of the eﬀective rate n(md) as a

function of md − m0 (respectively n) for various n (respectively md − m0).

F. Correspondence between the present formalism and Sornette-Werner representation

At this point, the astute reader will have noticed that the expression (47) for the eﬀective rate

of observable events of ﬁrst-generation is not the same as expression (10) of [48], which also gives

an apparent branching ratio denoted na for observable aftershocks of the ﬁrst generation. Our

present form (47) for n(md) departs from expression (10) of [48] for na via the denominator, that
is, by the fact that n−(md) deﬁned in (50) is not zero. The two approaches are actually equivalent

as we now explain. Expression (10) of [48] deﬁnes an apparent branching rate na as only due

to observable sources while n(md) given by (47) takes also into account the unobservable sources

on observable aftershocks. In other words, n(md) given by (47) counts the eﬀect of unobserved

sources in the production of ﬁrst generation events and thus describes the average number of ﬁrst-

generation daughters from unobservable aftershocks which are themselves “sources” for the future

generations. In contrast, Sornette and Werner construct a representation in which the introduction

of the observational cut-oﬀ md > m0 not only renormalizes n into na given by their equation (10)

but also introduces a renormalization of the spontaneous source rate [48]: for each real observable

spontaneous sources, there are many apparent spontaneous sources which result from the fact that

17

an event triggered by an unobservable previous aftershock is considered a spontaneous source since

one can not track its ancestor and can thus be counted as spontaneous. The two approaches can

thus be summarized as follows:

Sornette − Werner :

{n, 1 spontaneous source} → {na = nρ(md) , Sa = Nobs(n − na) spontaneous sources} ,(56)

where Nobs is the total number of observed aftershocks;

present work :

{n, 1 spontaneous source} → {n(md) =

, 1 spontaneous source} .

(57)

nρ(md)
1 − n[1 − ρ(md)]

Note that the fraction fa = Sa/Nobs of apparent sources among all observed events given by

expression (23) of [48] can be written

fa = Sa/Nobs = n − na = n − nρ(md) = n−(md) ,

where the last equality results from deﬁnition (50). This provides a physically intuitive interpre-
tation of n−(md). Expression (47) can thus be written

(58)

(59)

n(md) =

= na(1 + fa + f 2

a + ...) .

na
1 − fa

This formula clariﬁes completely the relationship between Sornette-Werner’s formation and the

present one: the ﬁrst term na in the r.h.s. of (59) corresponds to the average number of daughters

of ﬁrst-generation due to an observable initial source; The second term nafa corresponds to the

average number of daughters of ﬁrst-generation which are due to an apparent observable source

which is triggered from a ﬁrst-generation unobservable aftershock of the initial spontaneous source.

The third term naf 2

a corresponds to the average number of daughters of ﬁrst-generation which are

due to an apparent source which was itself triggered by an apparent source of a ﬁrst-generation

unobserved aftershock of the initial spontaneous source; and so on... This reasoning demonstrates

that the two formulations are physically equivalent, even though they have been obtained by

diﬀerent physical arguments.

III. STATISTICAL DESCRIPTION OF OBSERVABLE EVENTS

Until now, we have explored some properties of the fraction q(md) of observable clusters and its

corresponding eﬀective observable aftershock rate n(md), using a physically transparent but non-

18

rigorous approach based on the properties of ﬁrst-generation aftershocks triggered by observable

and unobservable sources. In the following, we study the full statistical properties of observable

events in large time window using the GPF’s of the number of events of all generations, belong to

an arbitrary cluster.

A. Derivation of the GPF of observable events

We start by the remark that the GPF of a single source of magnitude m, which takes into

account the observability of the source, is equal to

zH(m−md) = 1 + (z − 1)H(m − md) = 


1 , m < md ,

z , m > md .

Let us deﬁne G(z; m, md) as the GPF of the number of observable aftershocks of all generations



which are triggered by a source (which can be observable or unobservable). Multiplying G(z; m, md)

by (60) yields the GPF Θ(z; m, md) of the number of observable events triggered by a source of

given magnitude m:

Θ(z; m, md) = zH(m−md)G(z; m, md) .

Averaging this expression over all possible source magnitudes weighted by the GR law (27) gives

Θ(z; md) =

Θ(z; m, md)P (m)dm

of the total number of all observable events, which include all observable sources and all their

observable aftershocks of all generations. Θ(z; md) can be expressed as

∞

m0

Z

∞

x
Z

Θ(z; md) = G(z; md|m0) + (z − 1)G(z; md|md)

G(z; md|x) =

G(z; m, md)P (m)dm .

the GPF

where

Thus, determining the GPF Θ(z; md) requires to calculate the GPF G(z; m, md) of the number

of all observable aftershocks of all generations belonging to the same cluster. The later can be

obtained by using the statistical independence of sources and aftershocks magnitudes, which leads

to replacing z within the exponential of the r.h.s. of (25) by Θ(z; md), which yields

(60)

(61)

(62)

(63)

(64)

(65)

G(z; m, md) = eκµ(m)[Θ(z;md)−1] .

19

Substituting (65) and (27) into (64) yields

G(z; md|x) = Q(x)F (κµ(x)[1 − Θ(z; md)]) .

(66)

Using this expression (66) to express the terms in the r.h.s. of (63) leads to the following equation

determining the sought GPF Θ(z; md):

Θ(z; md) = F (κ[1 − Θ(z; md)]) + (z − 1)Q(md)F (κµ(md)[1 − Θ(z; md)]) .

(67)

For md = m0 (Q = µ = 1) such that all events can be observed, this equation reduces to the

standard functional equation

Θ(z|κ) = zF (κ[1 − Θ(z|κ)]) = zG1(Θ(z|κ)|κ) ,

(68)

where G1(z|κ) is the GPF given by (28) of the number of ﬁrst-generation aftershocks while Θ(z|κ) =

Θ(z; m0) is the GPF of the total number of event in a cluster. We make explicit the dependence

on the parameter κ because it is going to play a crucial role in the following discussion.

There is a physically natural partition of the GPF Θ(z; md) given by (67) according to

Θ(z; md) = G−(z; md) + zG+(z; md) ,

where

G−(z; md) = F (κ[1 − Θ(z; md)]) − Q(md)F (κµ(md)[1 − Θ(z; md)]) ,

describes the statistics of observable aftershocks triggered by an unobservable event, while

G+(z; md) = Q(md)F (κµ(md)[1 − Θ(z; md)]) .

describes the statistics of observable aftershocks triggered by an observable event.

There are a few exact consequences of relations (67)-(71) which can now be obtained. Consider

the average number of events over all generations of a given cluster, given by deﬁnition by

Using equation (67), it is easy to show that it satisﬁes the equation

hRi(md) =

dΘ(z; md)
dz

.

z=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)

hRi(md) = nhRi(md) + Q(md) ,

20

(69)

(70)

(71)

(72)

(73)

whose solution (20) was already obtained from a direct probabilistic argument. By construction,

hRi(md) given by (20) is equal to the sum

hRi(md) = Q(md) + hRi+(md) + hRi−(md)

of the contributions of observable events and aftershocks, which are triggered by both observable

and unobservable events, with

It follows from (70), (71) and (75) that

hRi±(md) =

dΘ±(z; md)
dz

.

z=1

(cid:12)
(cid:12)
(cid:12)
(cid:12)

hRi+(md) = nρ(md)hRi(md) = n+(md)hRi(md) ,

and

hRi−(md) = n[1 − ρ(md)]hRi(md) = n−(md)hRi(md) .

These two relations conﬁrm the physical meaning of the rates n±(md) deﬁned in (40) and (44),

which quantify the relative impact of aftershocks triggered by observable versus unobservable
events. Expressions (74), (76) and (77) show that the rates n±(md) are the fractions of after-
shocks of all generations which are triggered by observable (+) versus unobservable (−) events.

Figure 4 plots these two rates n±(md) as a function of md − m0 for α = 0.8, b = 1, n = 0.9,

showing that the impact of unobserved events may easily dominate for quite reasonable values of

the model parameters.

B. Fraction of observable clusters

One of the key parameters governing the statistics of windowed observable events is the fraction

q(md) deﬁned by (6) of observable clusters. Equation (67) allows us to calculate it exactly. Indeed,

it is easy to show that expression (67) implies that q(md) is solution of the equation

q(md) = 1 − F [κq(md)] + Q(md)F [κµ(md)q(md)] .

Noticing that Q(md) = [µ(md)]−γ ≡ µ−γ, we can rewrite (78) in the form

(74)

(75)

(76)

(77)

(78)

(79)

Ψ[q(md)] = 0 ,

21

Ψ(x) = 1 − x − F (κx) + µ−γF (κµx) .

A good approximate solution of (79) can be obtained by substituting the polynomial approximation

where

(30) for F to obtain

The corresponding solution of 79) then reads

Ψ(x) ≃ µ−γ − x[1 − n(1 − µ1−γ)] .

q(md) =

1
nµ + (1 − n)µγ ,

which is equivalent to expression (46) derived above using an intuitive nonrigorous reasoning. In

contrast, expression (82) and thus (46) is now obtained as an approximate solution of the exact

equation (78). The accuracy of this approximation (82) (or (46)) can thus be checked by comparing

it with the numerical solution of the exact equation (78). Correlatively, this also directly check

the quality of expression (47). Figure 5 shows the ratio of the approximation (82) divided by the

numerical solution of the exact equation (78), as a function of md − m0 for n = 0.9, b = 1 and three

values of α = 0.7, 0.8, 0.9. One can observe that the quality of the approximation (82) improves as

α gets closer to 1.

C. Self-similarity of the statistics of observable events

We now have the tools to calculate the conditional GPF ˜Θ(z; md) deﬁned by (8) of the total

number of observable events within an observable cluster. Substituting (7) into (67) yields the
equation for ˜Θ(z; md):

where

and

ϕ( ˜Θ; md) = zF (κ(md)(1 − ˜Θ)) ,

κ(md) = κµ(md)q(md) ,

ϕ(x; md) =

Ψ(q(md)(1 − x))
Q(md)

.

ϕ(0; md) ≡ 0 ,

ϕ(1; md) ≡ 1 .

22

Deﬁnition (80) and equation (79) imply that the following identities are true

(80)

(81)

(82)

(83)

(84)

(85)

(86)

Using (80) and the approximate expression (30), we obtain the linear approximation

ϕ(x; md) ≃ ϕ1(x) ,

ϕ1(x) = x ,

which is consistent with (86). Then, substituting (87) into (83) yields an approximate equation for
the GPF ˜Θ(z; md):

˜Θ(z; md) ≃ zF (κ(md)[1 − ˜Θ(z; md)]) .

We can check the accuracy of the linear approximation (87), and thus its consequence for
˜Θ(z; md) given by (88) by comparing the linear function ϕ1(x) = x of (87) with the exact one given

by (83). Figure 6 shows the diﬀerence

∆1(x; md) = ϕ(x; md) − x ,

where ϕ(x; md)− is given by (83), as a function of the variable x, for n = 0.9, γ = 1.25 and γ = 1.1

and several values of md − m0. This ﬁgure conﬁrms the good accuracy of the linear approximation.

The two following subsections will extract the consequence of this formulation for the distribution

of aftershock numbers and will quantify the impact of the next order correction to the linear

approximation (87).

Note that equation (88) coincides, after the application of the renormalization (43) where κ(md)

is now given by expression (84), with the equation (68) for the GPF Θ(z|κ) of the total number

of events within an arbitrary cluster. This has an important consequence for the physical under-

standing of seismicity according to the ETAS model: as long as the linear approximation (87) is

applicable, the statistics of the number of observable events within observable clusters is identical,

up to the renormalization (43), to the statistics of the total number of events within an arbitrary

cluster in which all events can be observed.

This can be restated as the following self-similar property for the statistical properties of ob-

servable clusters:

˜Θ(z; md) ≃ Θ(z|κ(md)) .

This self-similarity property means that the statistics of observable windowed events within large

time windows is identical after the correspondence

(87)

(88)

(89)

(90)

(91)

ω → ω(md) = ωq(md) ,

n → n(md) =

γκ(md)
γ − 1

,

23

to the statistics of the total number of windowed events. The eﬀective branching rate n(md) deﬁned

in (91) coincides, using the expression (84) for κ(md) and (82) for q(md), with expression (47) that

we have previously obtained for the eﬀective rate of observable aftershocks. This shows again that

the intuitive probabilistic reasoning of section II E on eﬀective aftershock rates is equivalent to the

linear approximation (87) for the GPF. As we are going to probe in greater depth, this suggests

that the self-similar property (90) is a resilient and general feature of the ETAS model.

D. Distribution of the number of observable events

We now derive the consequences of the above results for the distribution of the numbers of

observable events.

Let us denote by ˜P(r; md) the probability corresponding to the GPF ˜Θ(z; md) deﬁned by (8),

that there are r observable events in a given observable cluster. Similarly, we denote P(r; md) the

distribution of the numbers of observable events within an arbitrary cluster corresponding to the
GPF Θ(z; md). The two GPF ˜Θ(z; md) and Θ(z; md) are linked through equation (7). It follows

from (7) and (88) that, within the domain of application of the linear approximation (87), these

two probabilities can be expressed in terms of the probability P(r|κ) of the total number of events

of an arbitrary cluster via the following self-similar relations

˜P(r; md) ≃ P(r|κ(md)) , P(r; md) ≃ q(md)P(r|κ(md)) ,

r > 1 .

(92)

Thus, the statistical properties of observable events are known from those of the all events via the

scaling relations (92) (within the linear approximation (87) of the GPF). The self-similar properties

(90) and (92) mean that the ETAS model is renormalized onto itself under the transformation

m0 → md, with just a renormalization from κ to κ(md) and, as a consequence, a renormalization

of the branching ratio from n to n(md). Our present analysis thus conﬁrms for the full statistical

properties the results obtained previously, based solely on the average seismic rates [48].

The statistics properties of the total number of events in individual aftershock clusters (without

the constraint of observability) has been derived in our previous paper [35, 35]. Therefore, we just

need to recall brieﬂy some of its key properties which are useful for understanding the statistics of

observable events.

24

Recall that the probability density P(r|κ) is given by the Cauchy integral [38]

P(r|κ) =

1
2πir IC

dΘ(z|κ)
zr

,

where C is suﬃciently small contour enveloping the origin z = 0, and Θ(z|κ) is solution of the

functional equation (68). The main diﬃculty in the calculation of the integral (93) is that the GPF

Θ(z|κ) is deﬁned only implicitly, via the solution of equation (68). To overcome this obstacle, we

perform a change of variable and use the new integration variable y = Θ(z|κ). It follows from (68)

that

which yields the explicit integral for P(r|κ):

z =

y
G1(y|κ)

,

P(r|κ) =

1
2πir IC′

Gr

1(y|κ)

dy
yr ,

where C′ is some small contour in the complex plane y enveloping the origin y = 0.

It is interesting to point out that relation (95) has an intuitive probabilistic interpretation, as

it can be expressed as

where

P(r|κ) =

Pr (Yr = r − 1) ,

1
r

s

Ys =

Uk ,

Xk=1
and {U1, U2, . . . } are mutually independent random integers with GPF G1(z|κ) given by (28) with

(31). In the relevant regime for earthquakes for which, probably, 1 < γ < 2, and for r ≫ 1, the

PDF of the sum (97) tends asymptotically to

Pr (Yr = s) =

1
(νr)1/γ ℓγ

s − nr
(νr)1/γ !

 

,

ν = −κγΓ(1 − γ) ,

(98)

where ℓγ(x) is the stable L´evy distribution such that its two-sided Laplace transform is equal to

This L´evy distribution has the following properties

∞

−∞

Z

ℓγ(x)e−uxdx = euγ

.

ℓγ(x) ∼

(x → ∞) ,

ℓγ(0) =

x−γ−1
Γ(−γ)

1
γΓ(1 − 1/γ)

.

25

(93)

(94)

(95)

(96)

(97)

(99)

(100)

One can calculate ℓγ(x) numerically for any value 1 < γ < 2 using, for instance, the following

integral representation

ℓγ(x) =

exp

−uγ + ux cos

∞

1
π Z

0

"

π
γ !#

 

sin

ux sin
"

 

π
γ !

+

π
γ #

du .

(101)

The asymptotic expression for the probability (96) corresponding to (98) is

P(r|κ) ≃

1
r(νr)1/γ ℓγ

r(1 − n) − 1
(νr)1/γ

 

!

(r ≫ 1) .

(102)

When the average branching ratio n deﬁned by (18) is close to 1,Eq. (102) with (100) predicts the

existence of two characteristic power laws for the probability P(r|κ):

and

where

P(r|κ) ∼ r−1−1/γ

(r ≪ r∗) ,

P(r|κ) ∼ r−1−γ

(r ≫ r∗) ,

r∗ = ν1/(γ−1)

γ/(γ−1)

.

1
1 − n (cid:19)

(cid:18)

(103)

(104)

(105)

The power law (104) reﬂects the intrinsic distribution of the number of ﬁrst-generation aftershocks

given by relation (33), while the heavier power law tail (103) reﬂects the eﬀects of cascades over

many generations in the branching aftershocks triggering process [35]. See ﬁgure 2 in Ref. [35] for

a visualization of the two power laws (103) and (104) and their cross-over.

Then, substituting in (105) the eﬀective branching rate n(md) for observable clusters, we obtain
the dependence of the cross-over value r∗(md) separating the two power laws (103) and (104) for

the statistics of the number of observable events, as a function of the threshold magnitude md −m0.
Figure 7 shows r∗(md) as a function of md − m0 for γ = 1.25 and several values of n. One can
observe a fast decrease of r∗(md) with md − m0, which implies that increasing the observation

magnitude threshold md amounts to deviate more and more from criticality, as shown also directly

in Figure 2.

E. Deviations from self-similarity

All above results on the self-similarity of the statistics of observable events expressed by relations

(90) and (92) can be viewed as the consequence of the linear approximation (87).

It is thus

26

important to explore how strong can be the deviations from self-similarity resulting from the
properties of the exact equation (83) for the GPF ˜Θ of the number of observable events within an

observable cluster. In this goal, we rewrite equation (83) in the form

˜Θ = z ˜G1( ˜Θ; md) ,

˜G1(z; md) = G1(z|κ(md)g(z; md) ,

g(z; md) =

z
ϕ(z; md)

.

where

and

where

One can interpret (106) and (107) as describing some branching process such that the GPF of the
number of ﬁrst-generation aftershocks is equal to ˜G1(z; md). In other words, the random number

R1(md) of ﬁrst-generation aftershocks in this new branching model is equal to the sum of the two

statistically independent random integers

R1(md) = U(md) + V (md) ,

(109)

where U(md) has the self-similar GPF G1(z|κ(md), while V (md) has the GPF g(z; md).

Using (95), (96) and (107), we immediately obtain the exact integral representation of the PDF

of the number of observable events in an observable cluster:

P(r; md) =

Gr

1[z|κ(md)]gr(y; md)

1
2πir IC′

dy
yr .

Its corresponding probabilistic representation reads

˜P(r; md) =

Pr (Yr = r − 1) ,

Ys =

(Uk + Vk) .

1
r

s

Xk=1

27

The random integers {U1, U2, . . . } have the GPF G1[z|κ(md)], while the random numbers

{V1, V2, . . . } are random integers which are mutually statistically independent from each other

(and from U’s) with the GPF g(y; md) given by (108). As the transformation m0 → md is equiv-

alent to a decimation step in the language of the renormalization group (see [51] and [50] as well

(106)

(107)

(108)

(110)

(111)

(112)

as Chapter 11 of [52] for pedagogical introductions), the random variables {V1, V2, . . . } with their

GPF g(y; md) correspond to a new relevant direction (branching process diﬀerent from ETAS) in

the space of branching processes.

To obtain the statistical properties of the random integers V , consider the quadratic approxi-

mation of the function ϕ(x; md) deﬁned by (85):

ϕ(x; md) ≃ ϕ2(x; md) ,

ϕ2(x; md) = x + η(md)x(1 − x) .

(113)

This second-order approximation is again consistent with the identities (86). Here,

η(md) = 4∆1(1/2; md) ,

where ∆1 is deﬁned in (89). Figure 8 shows the diﬀerence

∆2(x; md) = ϕ(x; md) − ϕ2(x; md) ,

as a function of x for diﬀerent values of md − m0 for the same parameters as for Figure 6. γ = 1.1

and 1.25. Comparison between Figures 6 and 8 demonstrate the large improvement from the linear

to the quadratic approximation (113).

as

Substituting (113) into (108) yields the approximate GPF of the auxiliary random integers V

This GPF means that V has a geometric distribution with the following average and variance

g(z; md) =

1
1 + η(md)(1 − z)

.

hV i = η ,

σ2
V = η(η + 1) .

Thus, if η ≪ 1, the random variable V has a small impact on the statistics of the number of

observable events. In this case, we obtain the leading asymptotical contribution of the variable
V to the statistics of observable events by using a power law expansion for the GPF ˜G1(z; md),

similar to (31):

where

˜G1(z; md) ≃ 1 + ˜n(md)(1 − z) + βκγ(md)(1 − z)γ ,

(114)

(115)

(116)

(117)

(118)

(119)

˜n(md) = n(md) + η(md) .

28

Expression (118) shows that the main contribution of the random integer V resulting from the

ﬁrst-order correction to the linear approximation (87) is to introduce a small shift (for η ≪ 1)

equal to η(md) to the eﬀective branching rate n(md) obtained within the linear approximation

(87). Figure 9 shows the dependence of this shift η(md) as a function of md − m0 for diﬀerent

values of γ. Since n(md) is typically in the range 0.5 − 1, this shows that the corrections are no

more than about 10% in the value of the eﬀective branching rate for observable events.

IV. CONCLUSION

We have shown that, to a good approximation, the ETAS model is renormalized onto itself

under what amounts to a decimation procedure m0 → md, with just a renormalization of the

branching ratio from n to an eﬀective value n(md). Our present analysis thus conﬁrms, for the

full statistical properties, the results obtained previously in Ref. [48], based solely on the average

seismic rates (the ﬁrst-order moment of the statistics). However, our analysis also demonstrates

that this renormalization is not exact, as there are small corrections which can be systematically

calculated, in terms of additional contributions that can be mapped onto a diﬀerent branching

model (a new relevant direction in the language of the renormalization group). However, for prac-

tical applications, due to the strong stochasticity of the ETAS branching model, these deviations

from exact self-similarity will be diﬃcult to observe. This justiﬁes the standard procedure in sta-

tistical parameter estimations of using the ETAS model with magnitude cut-oﬀ md even if md is

an artiﬁcial detection threshold with no physical meaning for the triggering process. However, our

results, which conﬁrm by and large the conclusions of Ref. [48], show that the values of the branch-

ing ratio (or average rate of generation of ﬁrst-generation aftershocks) recovered by such statistical

estimations is not the “true” one, but a eﬀective or renormalized value. Thus, conclusions of the

properties of aftershock clusters has to be re-examined in this light: echoing the main conclusion

of Ref. [48], “ previous estimates of the clustering characteristics of seismicity may signiﬁcantly

underestimate the true values.”

Acknowledgments: We thank M. Werner for stimulation discussions. This work is partially

supported by NSF-EAR02-30429, and by the Southern California Earthquake Center (SCEC)

SCEC is funded by NSF Cooperative Agreement EAR-0106924 and USGS Cooperative Agreement

02HQAG0008. The SCEC contribution number for this paper is X.

29

[1] Bak, P., K. Christensen, L. Danon and T. Scanlon, Phys. Rev. Lett. 88, 178501, 2002.

[2] M. Lindman, K. Jonsdottir, R. Roberts, B. Lund, and R. B¨dvarsson, Phys. Rev. Lett. 94, 108501

(2005)

238501 (2003)

[3] K. F. Tiampo, J. B. Rundle, W. Klein, J. S. S. Martins, and C. D. Ferguson, Phys. Rev. Lett. 91,

[4] M. S. Mega, P. Allegrini, P. Grigolini, V. Latora, L. Palatella, A. Rapisarda and S. Vinciguerra, Phys.

Rev. Lett., 90, 18850 (2003).

[5] A. Helmstetter and D. Sornette, Phys. Rev. Lett. 92, 129801 (2004).

[6] Abe, S. and N. Suzuki, Europhys. Lett., 65 (4), 581-586, 2004.

[7] Corral A., Physical Review E. 6803(3 Part 2), 5102 (2003).

[8] A. Corral, Phys. Rev. Lett. 92, 108501 (2004)

[9] A. Corral, Phys. Rev. E 71, 017101 (2005).

[10] Baiesi, M. and M. Paczuski, Phys. Rev. E, 69, 066106, 2004.

[11] Baiesi, M. and M. Paczuski, Complex networks of earthquakes and aftershocks, preprint at

http://arxiv.org/abs/physics/0408018.

[12] Baiesi, M.

Scaling

and

precursor motifs

in

earthquake

networks,

preprint

at

http://arxiv.org/abs/cond-mat/0406198.

[13] J. Davidsen and M. Paczuski, Physical Review Letters, 94, 048501 (2005).

[14] A. Helmstetter, G. Ouillon and D. Sornette, J. Geophys. Res., 108, 2483, 10.1029/2003JB002503

(2003).

[15] D. Marsan and C. J. Bean, Phys. Rev. E 69, 063101 (2004).

[16] A. Helmstetter and D. Sornette, Phys. Rev. E 69, 063102 (2004).

[17] N. Scafetta and B. J. West, Phys. Rev. Lett. 92, 138501 (2004)

[18] X. Yang, S. Du, and J. Ma, Phys. Rev. Lett. 92, 228501 (2004).

[19] R. Woodard, D. E. Newman, R. Snchez, and B. A. Carreras, Phys. Rev. Lett. 93, 249801 (2004).

[20] P. B. Rundle, J. B. Rundle, K. F. Tiampo, J. S. Sa Martins, S. McGinnis, and W. Klein, Phys. Rev.

Lett. 87, 148501 (2001)

[21] S. Hergarten and H. J. Neugebauer, Phys. Rev. Lett. 88, 238501 (2002)

30

[22] A. Helmstetter and D. Sornette, Physical Review E. 66, 061104 (2002).

[23] A. Helmstetter, S. Hergarten, and D. Sornette, Phys. Rev. E 70, 046120 (2004).

[24] D. Sornette and G. Ouillon, Phys. Rev. Lett. 94, 038501 (2005).

[25] G. Ouillon and D. Sornette, J. Geophys. Res., 110, B04306, doi:10.1029/2004JB003311 (2005).

[26] L. Knopoﬀ, Y.Y. Kagan and R. Knopoﬀ, Bull. Seism. Soc. Am. 72, 1663-1676 (1982).

[27] T. Utsu, Y. Ogata and S. Matsu’ura, J. Phys. Earth 43, 1-33 (1995).

[28] A. Helmstetter, Phys. Rev. Let. 91, 058501 (2003).

[29] Sornette, D. and P. Davy, Geophys. Res.Lett. 18, 1079 (1991).

[30] Davy, P., A. Sornette and D. Sornette, Nature 348, 56-58 (1990).

[31] Kagan, Y.Y. and L. Knopoﬀ, Geophys. J. Roy. Astr. Soc., 62, 303-320 (1980).

[32] Kagan, Y.Y., Nonlin. Proc. Geophys., 1, 171, 1994.

[33] A. Helmstetter

and D. Sornette,

J. Geophys. Res.

(Solid Earth)

108

(B10),

2457

10.1029/2003JB002409 01 (2003).

[34] A. Helmstetter and D. Sornette, Geophys. Res. Lett., 30, 2069, 10.1029/2003GL018186 (2003).

[35] A. Saichev, A. Helmstetter and D. Sornette, Pure and Applied Geophysics 162, 1113-1134 (2005).

[38] A. Saichev and D. Sornette, Power law distribution of seismic rates: theory and data, in press in

[36] A. Saichev and D. Sornette, Phys. Rev. E 70, 046123 (2004).

[37] A. Saichev and D. Sornette, Phys. Rev. E 71, 056127 (2005).

Phys. Rev. E (2005) (http://arxiv.org/abs/physics/0412043)

[39] Y. Ogata, J. Am. Stat. Assoc., 83, 9-27 (1988).

[40] Kagan, Y.Y. and L. Knopoﬀ, J. Geophys. Res., 86, 2853 (1981).

[41] Helmstetter, A. and D. Sornette, J. Geophys. Res., 107 (B10) 2237, doi:10.1029/2001JB001580 (2002).

[42] Athreya, K.B. and P. Jagers, eds., Classical and modern branching processes (Springer, New York,

1997).

[43] Sankaranarayanan, G., Branching processes and its estimation theory (Wiley, New York, 1989).

[44] Helmstetter, A., Y.Y. Kagan and D.D.

Jackson,

J. Geophys. Res.,

110, B05S08,

10.1029/2004JB003286 (2005).

[45] R.S. Stein, Scientiﬁc American 288, 72-79 (2003).

[46] S. Toda, R.S. Stein, K. Richards-Dinger and S. Bozkurt, Forecasting the evolution of seismicity in

31

southern California: Animations built on earthquake stress transfer, Journal of Geophysical Research,

in press, doi:10.1029/2004JB003415 (2005).

[47] D. Sornette and M.J. Werner, Constraints on the Size of the Smallest Triggering Earthquake from

the ETAS Model, Baath’s Law, and Observed Aftershock Sequences, in press in J. Geophys. Res.

(2005) (http://arxiv.org/abs/physics/0411114)

[48] D. Sornette and M.J. Werner, Apparent Clustering and Apparent Background Earthquakes Biased by

Undetected Seismicity, in press in J. Geophys. Res. (2005) (http://arxiv.org/abs/physics/0501049)

[49] A. Helmstetter and D. Sornette, Geophys. Res. Lett. 30 (11) doi:10.1029/2003GL017670 (2003).

[50] K.G. Wilson, Scientiﬁc American 241, August, 158-179 (1979).

[51] K.G. Wilson and J. Kogut, Phys. Rep. 12, 75-200 (1974).

[52] D. Sornette, Critical Phenomena in Natural Sciences, Chaos, Fractals, Self-organization and Disorder:

Concepts and Tools, 2nd ed. (Springer Series in Synergetics, Heidelberg, 2004)

32

P (r)1

0.1
0.05

0.01
0.005

0.001
0.0005

0.0001

+

_

1

2

5

10

20

50

100

r

Fig. 1: Dependence of the PDF’s P +

1 (r|κ, md) and P

−
1 (r|κ, md) as a function of number r

for γ = 1.1, n = 0.9 and for µ(md) = 10 and 50, illustrating the presence of a power law tail
∼ r−γ−1 for ﬁrst-generation aftershocks triggered by observable sources and of fast decaying

tails for ﬁrst-generation aftershocks triggered by unobservable sources (of magnitude less than

md).

33

n(m )
d

0.8

0.6

0.4

0.2

2

4

6

8

m -m
d

0

Fig. 2: Dependence of the eﬀective rate n(md) given by (47) and (54) for α = 0.8 and b = 1

(γ = 1.25) for diﬀerent value of n: n = 0.7; 0.8; 0.9; 0.95 from bottom to top.

34

n(m )
d

1

0.8

0.6

0.4

0.2

0.2

0.4

0.6

0.8

n

1

Fig. 3: Dependence of eﬀective rate n(md) given by (47) and (54) as a function of the

branching ratio n of all ﬁrst-generation events, for α = 0.8 and b = 1 and several values of

md − m0: md − m0 = 1; 2; 3; 4 from bottom to top.

35

+
n (m )
d

_

n (m )
d

0.(cid:13)8(cid:13)

0.(cid:13)6(cid:13)

0.(cid:13)4(cid:13)

0.(cid:13)2(cid:13)

1(cid:13)

2(cid:13)

3(cid:13)

4(cid:13)

m -m
d

0

Fig. 4: Dependence of the rates n±(md) quantifying the relative impact of aftershocks
triggered by observable (+) versus unobservable (−) events, as a function of md − m0, for

α = 0.8, b = 1, and n = 0.9.

36

1.05(cid:13)

1.04(cid:13)

1.03(cid:13)

1.02(cid:13)

1.01(cid:13)

1(cid:13)

2(cid:13)

3(cid:13)

m -m
d

0

4(cid:13)

Fig. 5: Dependence of the ratio of the approximation (82) divided by the numerical solution

of the exact equation (78), as a function of md − m0, demonstrating the good accuracy of the

approximate expression (82), for n = 0.9, b = 1: α = 0.7; 0.8; 0.9 from top to bottom.

37

∆ (x)
1

0.004

0.003

0.002

0.001

0.2

0.4

0.6

0.8

x

1

Fig. 6: Dependence of the diﬀerence ∆1(x; md) given by (89) as a function of the variable

x, for n = 0.9, γ = 1.25 and several values of md − m0 = 1; 2; 3; 4 (four upper curves from

top to bottom). The group of almost undistinguishable curves at the bottom of the graph

corresponds to n = 0.9, md − m0 = 1; 2; 3; 4 and γ = 1.1.

38

*
r (m )
d

10000(cid:13)

1000(cid:13)

100(cid:13)

10(cid:13)

1(cid:13)

0(cid:13)

1(cid:13)

2(cid:13)

3(cid:13)

4(cid:13)

5(cid:13)

m -m
d

0

6(cid:13)

Fig. 7: Dependence of the cross-over value r∗(md) separating the two power laws (103) and

(104) for the statistics of the number of observable events, for γ = 1.25 and n = 0.9; 0.8; 0.7

(top to bottom).

39

∆ (x)
2

0.00002(cid:13)

0.00001(cid:13)

-0.00001(cid:13)

-0.00002(cid:13)

0.(cid:13)2(cid:13)

0.(cid:13)4(cid:13)

0.(cid:13)6(cid:13)

0.(cid:13)8(cid:13)

x

1(cid:13)

Fig. 8: Dependence of the diﬀerence ∆2(x; md) deﬁned in (115) as a function of x for the same

parameters as in Figure 6, demonstrating the high accuracy of the quadratic approximation

(113).

40

η

0.05(cid:13)

0.04(cid:13)

0.03(cid:13)

0.02(cid:13)

0.01(cid:13)

γ=1.5

γ=1.25

γ=1.1

1(cid:13)

2(cid:13)

3(cid:13)

4(cid:13)

5(cid:13)

m -m
d

0

6(cid:13)

Fig. 9: Dependence of the shift η(md) to the eﬀective branching rate for observable events

as a function of md − m0 for diﬀerent values of γ and for n = 0.9.

41

