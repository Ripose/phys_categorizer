Geophys. J. Int. (2003) 000, 000–000

Spectral element modeling of three dimensional wave

propagation in a self-gravitating Earth with an

arbitrarily stratiﬁed outer core

Emmanuel Chaljub1 and Bernard Valette2

1LGIT, CNRS, BP 53, 38041 Grenoble Cedex 9, France

2LGIT, IRD, Universit´e de Savoie, 73376 Le Bourget-du-Lac Cedex, France

Accepted xxx. Received xxx; in original form xxx

SUMMARY

This paper deals with the spectral element modeling of seismic wave propagation at the

global scale. Two aspects relevant to low-frequency studies are particularly emphasized.

First, the method is generalized beyond the Cowling approximation in order to fully ac-

count for the eﬀects of self-gravitation. In particular, the perturbation of the gravity ﬁeld

outside the Earth is handled by a projection of the spectral element solution onto the ba-

sis of spherical harmonics. Second, we propose a new formulation inside the ﬂuid which

allows to account for an arbitrary density stratiﬁcation. It is based upon a decomposition

of the displacement into two scalar potentials, and results in a fully explicit ﬂuid-solid cou-

pling strategy. The implementation of the method is carefully detailed and its accuracy is

demonstrated through a series of benchmark tests.

Key words: Brunt-V¨ais¨al¨a frequency – elastodynamics – global seismology – numerical

modeling – self-gravitation – spectral element method – synthetic seismograms.

3
0
0
2
 
g
u
A
 
7
2
 
 
]
h
p
-
o
e
g
.
s
c
i
s
y
h
p
[
 
 
1
v
2
0
1
8
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

2

E. Chaljub and B. Valette

1 INTRODUCTION

It has been recently established by several authors (Chaljub (2000), Komatitsch & Tromp

(2002a,b), Capdeville et al. (2003), Chaljub et al. (2003)) that the spectral element method

(SEM) provides an eﬃcient solution to the issue of computing synthetic seismograms in three

dimensional (3D) models of the Earth. Whereas most of current spectral element studies aim

at pushing calculations toward high frequencies, where the methods traditionally used at the

global scale reach their limits, this paper focuses on some physical eﬀects that are critical for

the lower part of the seismic frequency band: (i) the full treatment of self-gravitation and (ii)

the ability to take into account any density stratiﬁcation in the ﬂuid regions of the Earth.

The ﬁrst novelty of this paper stands in the incorporation of self-gravitation, the eﬀect of

which is important for seismic and gravimetric observations with periods larger than 100 s.

All the previously mentioned studies based upon the SEM accounted for the eﬀects of gravity

within the Cowling approximation (Cowling 1941), i.e. by neglecting the perturbation of the

gravity ﬁeld by seismic waves. The main reason for making this assumption lies in the intrinsic

diﬃculty of the problem. Considering the full eﬀects of self-gravitation requires, indeed, to solve

Poisson’s equation for the perturbed gravitational potential which is deﬁned over the whole

space. Unlike spherical harmonics approaches, the use of a grid-based method such as the SEM

does not provide a natural framework for the resolution of the exterior problem. Grid-based

approximations in unbounded domains proceed ﬁrst by restricting the computational domain,

then by imposing an appropriate condition on the truncating boundary. Diﬀerent methods

arise depending on whether the artiﬁcial boundary condition (ABC) is local or not. Methods

based upon a local ABC have the advantage of being computationally inexpensive and valid for

arbitrary geometries. An example of such methods is the inﬁnite element method (e.g. Bettess

(1992), Gerdes & Demkowicz (1996)), in which the behaviour of the exterior solution is enforced

in the radial direction. The second class of methods, based upon a non-local ABC, are not as

general since they usually require the knowledge of an analytical, or semi-analytical, solution

to the exterior problem. As a consequence they have very attractive properties regarding their

accuracy while being restricted to simple (usually spherical) geometries. The non-local ABC can

Modeling wave propagation in a self-gravitating Earth

3

be implemented into the ﬁnite element method within the rigorous framework of a Dirichlet-to-

Neumann (DtN) operator (e.g. Givoli (1992)). This is the approach that we retain here. The

DtN operator that suits our problem relies on the spherical harmonic decomposition of the

solution of Laplace’s equation outside the Earth. Unlike the one introduced by Capdeville et al.

(2003) to couple a time-dependent spectral element calculation to a modal solution in the

frequency domain, our DtN operator is much simpler to derive because it is applied to a static

problem. The spectral element discretization of the Poisson-Laplace equation yields a symmetric

algebraic system which has to be inverted at each time step to obtain the perturbation of the

gravitational potential. In practice, this is done by iterating a conjugate gradient method, the

preconditioning of which is critical to carry out routine calculations.

The other aspect we consider in great detail is the treatment of the ﬂuid part of the Earth’s

core. A parameter which is of particular importance with regard to core dynamics is the squared

Brunt-V¨ais¨al¨a frequency N 2 that characterizes the local response of the ﬂuid to perturbations

in density. To ﬁrst order, the core can be considered as neutrally stratiﬁed, i.e. N 2 = 0, because

a neutral buoyancy is expected in the bulk of a region subject to vigorous convection. However,

there is seismological evidence for a negative N 2 at the top of the core and a positive N 2 at its

bottom, with absolute values that can reach 10−7 rad2 · s−2 (Masters (1979), Valette & Lesage

(unpublished)). For the sake of generality, our description of the core’s structure will make no

assumption on the proﬁle of the buoyancy frequency. To this end, we introduce a two-potential

formulation of the wave equation in the ﬂuid that generalizes the neutral buoyancy formulation

of Komatitsch & Tromp (2002b) and Chaljub et al. (2003). Contrary to these studies, that

considered the velocity potential in the ﬂuid, our decomposition is applied to the displacement

ﬁeld in order to obtain natural solid-ﬂuid boundary conditions for the perturbed gravitational

potential. An attractive consequence of this choice is to yield a fully explicit solid-ﬂuid coupling

strategy, as opposed to the studies mentioned above. Note ﬁnally that our formulation is close

to the two-potential description proposed by Wu & Rochester (1990) in the context of core

dynamics studies, which is optimal with respect to the number of unknowns in the ﬂuid regions.

The remainder of the paper is organized as follows. In section 2, we recall the equations of

4

E. Chaljub and B. Valette

motion in a self-gravitating Earth in their strong and weak form, successively. We introduce

in particular the two-potential decomposition of the displacement ﬁeld in the ﬂuid regions and

we deﬁne the DtN operator that permits to handle the equations within a ﬁnite domain. In

section 3, we recall the principles of the spectral element approximation in space and we make

a detailed presentation of our explicit time marching algorithm. Finally, numerical results are

shown in section 4 for a set of spherically symmetric models that validate the implementation

of the method.

2 WAVE EQUATION IN A SELF-GRAVITATING EARTH

In this section we recall the strong and weak forms of the wave equation, which is obtained

through a ﬁrst order Lagrangian perturbation around a non-rotating, hydrostatically pre-

stressed, state of equilibrium. Throughout the paper, the Earth is denoted by ⊕ and its outer

boundary by ∂⊕. The solid (resp. ﬂuid) parts of ⊕ are referred to as ⊕S (resp. ⊕F ), and the set

of all solid-ﬂuid interfaces is denoted ΣSF . Whenever topography or ellipticity is considered on

∂⊕, B will denote a ball of radius b that contains the aspherical Earth (i.e. , ⊕ ⊂ B) and S will

stand for its spherical boundary (S = ∂B).

2.1 Strong form

Solving the wave equation within the previous assumptions consists in ﬁnding the Lagrangian

perturbation of the displacement, u, such that:

¨u + A(u) =

f ,

1
ρ

ρ A(u) = −∇ · T(u) − ∇ (ρu · g) + {∇·(ρu)} g + ρ∇ψ ,

(1)

(2)

where A is the elastic-gravitational operator, T(u) is the Lagrangian incremental stress tensor, ρ

is density, g is the acceleration due to gravity, ψ is the Eulerian perturbation of the gravitational

potential, also known as the mass redistribution potential (MRP), and f is the forcing term. As

usual, a dot over a symbol implies time derivation and ∇τ (resp. ∇ · τ ) stands for the gradient

(resp. the divergence) of a given tensor ﬁeld τ .

Modeling wave propagation in a self-gravitating Earth

5

In the (inviscid) ﬂuid regions the stress tensor takes the form:

T(u) = ρc2 ∇·u I ,

where c is the speed of sound and I denotes the second-order identity tensor. Neglecting any

source term in the ﬂuid, the wave equation can then be rewritten as:

¨u = −A(u) = ∇

c2∇·u + u · g − ψ
(cid:2)

(cid:3)

+ c2 ∇·u s ,

where s is deﬁned by:

s =

∇ρ
ρ

−

g
c2

,

and can be shown to be proportional to the gradient of speciﬁc entropy. Another parameter of

interest in the ﬂuid is the square of the Brunt-V¨ais¨al¨a frequency N 2, which is related to s by:

N 2 = s · g =

∇ρ −

g

· g .

1
ρ (cid:16)

ρ
c2

(cid:17)

The Brunt-V¨ais¨al¨a frequency arises naturally when analyzing the local stability of the ﬂuid

since it provides a simple way to formulate the Schwarzschild criterion (Schwarzschild 1906).

An inspection of the expression of the energy reveals, indeed, that the local convective stability

of the ﬂuid is determined by the sign of N 2 (e.g. Friedman & Schutz (1978); Valette (1986)).

Actually, N 2 controls the non-seismic part of the spectrum of the elastic-gravitational operator,

σe(A):

oscillation 0S2.

σe(A) =

inf), Max(0, N 2

sup)

,

Min(0, N 2
(cid:2)

(cid:3)

where N 2

inf and N 2

sup stand for the extrema of N 2 over ⊕F (Valette 1989). This implies that

the corresponding squared eigenfrequencies range in the latter interval. In the Earth, these

eigenfrequencies merely exceed 50 µHz, a value which is well below that of the gravest seismic

In this paper, we only intend to compute the seismic part of the ﬂuid outer core’s response,

which is also aﬀected by the variations of N 2. Taking into account a ﬂuid region within the

framework of the ﬁnite element method is known to be a diﬃcult problem, due to the possi-

ble splitting of the zero eigenfrequency induced by the numerical discretization of the elastic

(3)

(4)

(5)

(6)

(7)

6

E. Chaljub and B. Valette

operator (Hamdi et al. 1978). A key issue to produce a numerical solution free of spurious

modes is the correct representation of the null space of the elastic-gravitational operator, N (A)

(Berm´udez & Rodr´ıguez 1994). An alternative to the discretization of N (A) is to solve the

wave equation in the range of the operator, R(A). To proceed, we note from eq. (4) that an

acceptable form for any displacement ﬁeld in R(A) is:

u = ∇χ + ξ s,

where χ and ξ denote two arbitrary scalar ﬁelds. Diﬀerentiating twice in time and identifying

each term with the right-hand-side of eq. (4), we obtain two scalar wave equations, one for each

potential:

¨ξ = c2∇·(∇χ + ξ s) ,

¨χ = ¨ξ + ∇χ · g + N 2 ξ − ψ .

Eventually, the MRP ψ appearing in eqs. (2) and (10) is obtained by solving the Poisson-Laplace

equation over the entire space. This writes:

−4πG ∇·(ρu)

in ⊕S ,

∇2ψ =

−4πG ∇·(ρ ∇χ + ρ ξ s)

in ⊕F ,

outside ⊕ ,






0

where G is the gravitational constant.

2.2 Boundary conditions

The complete set of boundary conditions for displacement, traction and MRP can be found

in Dahlen & Tromp (1998, p. 104). Here we recall these boundary conditions that concern the

MRP or involve a solid-ﬂuid interface.

across Σ reads:

Let Σ be a given interface in the medium. The condition that the MRP must be continuous

where [

]Σ stands for the jump operator across Σ, deﬁned in accordance with the unit normal

[ψ]Σ = 0 ,

(12)

(8)

(9)

(10)

(11)

vector ˆn: [ψ]Σ = ψ+ − ψ− and ˆn points from the − to the + side. The normal derivative of ψ

Modeling wave propagation in a self-gravitating Earth

7

can have a jump which is controlled by:

[∇ψ · ˆn]Σ = −4πG [ρu · ˆn]Σ .

The condition that both traction and normal displacement must be continuous across the solid-

ﬂuid boundaries writes as a set of equalities on ΣSF :

(13)

(14)

(15)

u · ˆn = (∇χ + ξ s) · ˆn ,

T(u) · ˆn = ρ ¨ξ ˆn .

2.3 Weak form

Note that to obtain eq. (15) we have used eqs. (3), (8) and (9).

The weak form of the wave equation in the solid regions is obtained after multiplying each side

of eq. (1) with an admissible displacement ﬁeld w, then integrating over ⊕S. This writes:

(¨u + A(u) ; ρ w)⊕S = (f ; w)⊕S

(16)

where ( ; )⊕S stands for the L2 scalar product on ⊕S. For example, integrating by parts the

divergence of the stress tensor in eq. (2) yields:

− (∇ · T(u) ; w)⊕S =

Z⊕S

T(u) · ∇w dV −

T(u) · ˆn · w dS ,

(17)

ZΣSF

where ˆn stands for the unit vector normal to ΣSF pointing away from ⊕S. Note that the

condition of free traction at the surface of the Earth ∂⊕ is naturally satisﬁed in eq. (17) as we

have set the corresponding integral to zero. On the contrary, the continuity of traction (15)

across the solid-ﬂuid boundaries has to be enforced. To proceed, we simply replace the traction

vector in the surface integral of eq. (17) with its ﬂuid counterpart:

− (∇ · T(u) ; w)⊕S =

Z⊕S

T(u) · ∇w dV −

ρ ¨ξ ˆn · w dS .

(18)

ZΣSF

The weak form of the wave equation in the ﬂuid regions is obtained similarly after dotting each

side of eqs. (9) and (10) with admissible potentials ˜ξ and ˜χ, integrating (possibly by parts) over

⊕F , then forcing the continuity of the normal displacement (14) across the ﬂuid-solid interfaces.

8

E. Chaljub and B. Valette

One gets:

and

in section 3.

1
c2

Z⊕F

¨ξ ˜ξ dV = −

(∇χ + ξ s) · ∇ ˜ξ dV +

u · ˆn ˜ξ dS ,

(19)

Z⊕F

ZΣSF

1
c2 ¨χ ˜χ dV =

1
c2

Z⊕F

Z⊕F

¨ξ + ∇χ · g + N 2 ξ − ψ
(cid:16)

(cid:17)

˜χ dV .

(20)

In eq. (19), ˆn denotes the unit vector normal to ΣSF that points outward the ﬂuid. Note that

the scaling factor c−2 has been artiﬁcially included in eq. (20) in order to get the same left

hand side as in eq. (19). This will make the description of the time marching algorithm easier

Now, in order to establish the weak form of eq. (11), it is convenient to ﬁrst consider Poisson’s

equation within the ﬁnite (spherical) volume B. Multiplying with an admissible potential ˜ψ

deﬁned over B, then integrating by parts the Laplacian and the divergence we get:

∇ψ · ∇ ˜ψ dV −

∇ψ · ˆn ˜ψ dS =

(21)

ZB

(cid:26)Z⊕S

ZS

ZS

−4πG

ρ u · ∇ ˜ψ dV −

ρ u · ˆn ˜ψ dS +

ρ (∇χ + ξ s) · ∇ ˜ψ dV

Z⊕F

,

(cid:27)

with the boundary term involving the normal displacement being null, except in the absence of

topography (i.e. when S = ∂⊕). It is important to note that the jump condition (13) across the

solid-ﬂuid interfaces is naturally taken into account in (21). This property, which stems from

the potential decomposition (8), is a key argument that guided our choice to work with the

displacement ﬁeld (and not the velocity) in the ﬂuid.

2.4 DtN operator

The harmonic behaviour of ψ outside B has not been considered yet. In order to proceed, let ψint

denote the MRP interior to B. At the (spherical) surface S, consider the expansion of ψint onto

the orthonormal basis of real spherical harmonics Ylm (see Dahlen & Tromp (1998), p.851):

ψint(b, θ, ϕ) =

ψ lm
int (b) Ylm(θ, ϕ) ,

(22)

∞

l

Xl=0

Xm=−l

Modeling wave propagation in a self-gravitating Earth

9

where (θ, ϕ) are the spherical coordinates and where ψ lm

int (b) =

S ψintYlm dS. It is straightfor-
R

ward to extend ψint continuously to a potential ψext that satisﬁes Laplace’s equation outside B

and vanishes at inﬁnity:

ψext(r, θ, ϕ) =

Ylm(θ, ϕ) ,

r ≥ b .

(23)

∞

l

Xl=0

Xm=−l

ψ lm
int (b)

l+1

b
r (cid:19)

(cid:18)

The normal derivative of ψext on S is readily obtained by diﬀerentiating the previous expression

with respect to r :

∇ψext · ˆn (b, θ, ϕ) = −

(l + 1)

ψ lm
int (b) Ylm(θ, ϕ) .

(24)

1
b

∞

Xl=0

l

Xm=−l

Eq. (24) which relates the normal derivative of the potential to the potential itself is called a

Dirichlet-to-Neumann (DtN) operator on the spherical boundary S. Its action, which is non-

local, is rather simple to express in the spherical harmonics basis: it consists in multiplying each

coeﬃcient with −l−1

b

. Recall that the condition that the normal derivative of a given ﬁeld is

proportional to the ﬁeld at the surface is referred to as a Robin boundary condition. Applying

the DtN operator is therefore equivalent to imposing a Robin boundary condition on every

component of the spherical harmonics expansion of the original potential, and this yields a

well-posed problem.

the Poisson-Laplace equation as:

Taking into account the jump condition (13) across S, we can write the ﬁnal weak form of

−

ZB

4πG

(cid:26)Z⊕S

ZS

∇ψ · ∇ ˜ψ dV +

∇ψext · ˆn ˜ψ dS =

(25)

ρ u · ∇ ˜ψ dV +

ρ (∇χ + ξ s) · ∇ ˜ψ dV

,

(cid:27)

ZS

Z⊕F

with:

∇ψext · ˆn ˜ψ dS = −

(l + 1)

int (b) ˜ψ lm(b) .
ψ lm

(26)

1
b

∞

Xl=0

l

Xm=−l

In practice, the inﬁnite sum present in eq. (26) will be limited to angular orders l < lmax .

Note that the eﬀect of the truncation is to apply a Neumann boundary condition to the high

wavenumber content of the MRP, which according to eq. (23) is asymptotically consistent with

the behaviour of the MRP outside B.

10

E. Chaljub and B. Valette

3 NUMERICAL APPROXIMATION

This section deals with the numerical approximation of the wave equation in a self-gravitating

Earth, which we achieve in two steps. First, the SEM is applied to the weak form of the equations

in the space domain. Then a ﬁnite diﬀerence scheme is used to advance the system in time.

For the sake of conciseness, details of the method are avoided as much as possible unless this

prevents the paper from being self-contained. The reader is referred to (Komatitsch & Vilotte

1998) and to (Komatitsch & Tromp 1999) for a general description of the SEM applied to the

elastic wave equation, and to (Komatitsch & Tromp 2002a; 2002b) and (Chaljub et al. 2003) for

its extension to global seismology, including its parallel implementation on modern computers

with distributed memory.

3.1 Spatial discretization

3.1.1 Hexahedral Mesh

The ﬁrst discretization step consists in decomposing the spherical Earth into a collection of

non-overlapping hexahedral elements. This process is detailed in (Chaljub et al. 2003), where

non-conforming interfaces are introduced to avoid an artiﬁcial reﬁnement of the grid with depth.

Such a strategy allows the reﬁnement (or coarsening) of the mesh to be spatially localized, the

complexity being related to the continuity requirements between elements that do not match

across the interfaces. For the sake of simplicity, this paper is restricted to the case of a spherical,

geometrically conforming mesh such as the one represented in ﬁg. 6. Note that taking into

account the elliptical ﬁgure of the Earth or accounting for surface topography would require in

the self-gravitating case to extend the mesh outward the artiﬁcial boundary S.

3.1.2 Spectral element method

Based upon the 3D tiling of the sphere, the MRP (ψ) as well as the displacement in the solid

(u) and the potentials in the ﬂuid (χ and ξ) are approximated using continuous tensorized

polynomials. Note that the continuity of the normal displacement within the ﬂuid regions is

Modeling wave propagation in a self-gravitating Earth

11

naturally satisﬁed in the weak forms (19) and (20).

The basis of polynomials used on each spectral element are deﬁned as the shape functions

of the collocation points. One of the particularity of the SEM is that the collocation points

are the so-called Gauss-Lobatto-Legendre points, i.e. the exact same points that are used to

evaluate the integrals present in the weak form of the equations. One consequence of this choice

is that the matrix representation of the L2 scalar product is diagonal, a property that allows to

design explicit time schemes (see e.g. Komatitsch & Vilotte (1998) and Komatitsch & Tromp

(1999)).

3.2 Time evolution

in time, which writes:

The diﬀerent steps of the spatial discretization yield a system of ordinary diﬀerential equations

MS ¨d(t) + KS d(t) + G ψ(t)+ CSF ¨ξ(t) = F(t)

MF ¨ξ(t) + KF (ξ, χ) (t)

+ CF S d(t) = 0

MF ¨χ(t) + BF

¨ξ, ξ, χ, ψ
(cid:16)

(cid:17)

(t)

= 0

P ψ(t) = D (d, ξ, χ) (t)

(27)

(28)

(29)

(30)

In the previous equations, d stands for the displacement vector in the solid regions, F is the

approximation of the source term and ψ, χ, ξ respectively denote the nodal values of the MRP

and of the displacement potentials in the ﬂuid. MS is the mass matrix in the solid regions,

i.e. the matrix representation of the L2 scalar product weighted by density. Similarly, MF is

the matrix representation of the scalar product in the ﬂuid regions weighted by the quantity

c−2. As outlined before, both matrices are diagonal. KS and KF are the stiﬀness matrices which

arise from the approximation of the volume integrals in eqs. (18) and (19). The discretization

of the surface integrals in the latter equations yields the solid-ﬂuid coupling matrices CSF and

CF S. BF arises from the discretization of the right hand side of eq. (20) and only involves a

pointwise operation on ¨ξ, ξ, ∇χ and ψ. Finally, G, D and P are the matrix representations of

12

E. Chaljub and B. Valette

the gradient, divergence and Poisson-Laplace operator, respectively. Note that D contains the

factor 4πGρ and that P is symmetric according to eqs. (25) and (26).

To advance the equations forward in time we use the explicit, second-order accurate, New-

mark scheme (e.g. Hugues 1987). Let for example Xn denote the snapshot at time tn of one of

the unknown vectors d, χ or ξ involved in eqs. (27–29). The values of X and its time derivative

at the next time step are extrapolated as follows:

Xn+1 = Xn + ∆t ˙Xn +

˙Xn+1 = ˙Xn +

¨Xn

∆t2
2
¨Xn + ¨Xn+1

(cid:17)

∆t
2 (cid:16)

(31)

(32)

As it is readily seen from the previous equations, the algorithm is fully explicit in terms of X

and consists in a simple centered ﬁnite diﬀerence scheme in ˙X. The process of updating the

time derivatives of X is achieved in two steps: ﬁrst ¨Xn+1 is computed from the discrete version

of the wave equation (27–29) by inverting a diagonal mass matrix (MS or MF ), then ˙Xn+1 can

be updated using (32). Note that the wave equation has to be solved in the ﬂuid regions ﬁrst,

since the coupling operator CSF in eq. (27) acts on ¨ξn+1 which is not known at time tn.

Let us stress that the coupling between the ﬂuid and the solid regions does not require

iterations of eqs. (31,32) as this would be the case if a velocity potential formulation was used

(e.g. Komatitsch et al. 2000; Chaljub et al. 2003). This attractive property stems from the

potential decomposition (8) applied to the displacement which is the explicit variable in the

Newmark scheme.

The previous remark remains valid when the full eﬀects of self-gravitation are taken into

account. The computation of the MRP from the displacement ﬁeld is indeed explicit in the sense

that it does not involve any time derivative ˙X or ¨X. Needless to say, this task is expensive as it

requires to formally invert the symmetric, ill-conditioned matrix P (e.g. Deville et al. 2002). In

practice, we solve eq. (29) for the MRP with a conjugate gradient (CG) method which iterations

are stopped when the residual is decreased by a factor ǫ to be chosen. The issue of building an

eﬃcient preconditioner for the Poisson-Laplace solver is not addressed in this paper, but it is

certainly critical in order to avoid a performance bottleneck.

4 NUMERICAL RESULTS

Modeling wave propagation in a self-gravitating Earth

13

In this section, we demonstrate the validity of our approach through a couple of examples for

which a reference, semi-analytical, solution can be derived. First, the two potentials formulation

is tested within the Cowling approximation, i.e. without computing the MRP, for models having

a constant Brunt-V¨ais¨al¨a frequency. Then, the eﬀects of mass redistribution are included in a

simpliﬁed version of the PREM model (Dziewonski & Anderson 1981).

4.1 Validation of the two-potentials formulation

In order to deﬁne some benchmarks to test our formulation, we consider the radial Earth

model of ﬁg. 1. The model is adapted from PREM, with a smaller number of regions (6 instead

of 13). In particular, the details of the crustal structure as well as the presence of a global

ocean are ignored to ease the computation. This reference model is further constrained to ﬁt

a given proﬁle of the squared Brunt-V¨ais¨al¨a frequency in the ﬂuid outer core. To proceed, we

simply vary the P -velocity in eq. (6), keeping the density, its gradient and the gravitational

acceleration unchanged. Note that a realistic way would be to adjust density rather than P -

velocity (see e.g. Wu & Rochester (1993)) because the latter is much better constrained in the

Earth. However, acting on the P -velocity proﬁle is straightforward and still fully acceptable for

numerical validation purposes.

Fig. 2 shows three models that were built following the above procedure. The ‘N’ label refers

to a neutrally stratiﬁed outer core (i.e. with N 2 = 0), whereas the models labelled ‘S’ and ‘U’

correspond to a stable and unstable stratiﬁcation, respectively. For the sake of simplicity, we

chose the value of the squared Brunt-V¨ais¨al¨a frequency to be constant throughout models ’S’

and ’U’, respectively equal to N 2 = 10−7 rad2 · s−2 and N 2 = −5 10−8 rad2 · s−2. These values

correspond to the extrema that are expected from the inversion of seismic free oscillations of

the Earth (Masters (1979), Valette & Lesage, unpublished). Note that the values of N 2 within

PREM are about one order of magnitude smaller, as illustrated by the similarity of the PREM

P -velocities to those of a neutrally stratiﬁed proﬁle.

All three models are excited by a shallow explosive point source which time dependence

14

E. Chaljub and B. Valette

is a Ricker wavelet (i.e. the second derivative of a Gaussian bell) with dominant frequency

f0 = 1 mHz. The source is located at one grid-point from the Equator, at latitude θs ≃ −1.128◦

and depth ds ≃ 61 km, and the receivers sit along the Equator. Fig. 3 shows the longitudinal

displacement recorded at an epicentral distance of 90◦ in the three models. The traces were

computed within the Cowling approximation using a summation of the eigenmodes of each

model. The waveform diﬀerences illustrate the sensitivity of the seismic waves to the stratiﬁca-

tion of the ﬂuid core and suggest that models ‘U’ and ‘S’ constitute a demanding benchmark

for the two potentials formulation. In ﬁgs. 4 and 5, the spectral element results obtained in

those two models are compared to the modal solutions for a couple of epicentral distances. The

two solutions are in very close agreement with the largest relative diﬀerences being as small as

one per mil over the time interval considered.

The spectral element grid used to carry out the calculations is shown in ﬁg. 6. It consists of

640 elements in which the polynomial degree varies from 3 to 10 in the radial direction and is

kept constant, equal to 8, in the tangential direction. The total number of gridpoints is 334,368

corresponding to a number of points per wavelength much greater than 5, which is the empirical

ratio to get an accurate solution (e.g. Komatitsch & Vilotte (1998)). This explains the perfect

match between the spectral element calculations and the reference solutions.

4.2 Validation of the whole formulation

As a last example, we consider the computation of the elastic-gravitational response of the Earth

model of ﬁg. 1. This test presents all the diﬃculties mentioned in this paper: the stratiﬁcation of

the ﬂuid core is arbitrary and the physical description includes the full eﬀects of self-gravitation.

The parameters of the simulations are slightly diﬀerent than above, since the source domi-

nant frequency is set to a graver value f0 = 0.5 mHz, and the source latitude is now θs ≃ −2.64◦.

The spectral element grid is consequently adapted, and roughly coarsened by a factor of two

in each direction compared to the one of ﬁg. 6.

In order to check that the test is demanding enough with regard to the implementation of

self-gravitation, we compare in ﬁg. 7 the surface longitudinal displacement recorded with or

Modeling wave propagation in a self-gravitating Earth

15

without including the perturbation of the gravitational potential. Both traces were computed

by normal modes summation and recorded at an epicentral distance of 90◦ for about 10 hours.

The diﬀerences in phase and amplitude illustrate that the Cowling approximation is not valid

in the frequency range of the experiment.

Finally, the results obtained with the SEM are compared to the reference solution in ﬁg. 8.

Two cases are considered that correspond to a diﬀerent accuracy of the spectral element solution

regarding the CG resolution of the discrete Poisson-Laplace equation (29). In the ﬁrst case the

CG iterations are stopped when the residual is decreased by three orders of magnitude, which

means that ǫ = 10−3. The resulting spectral element solution is clearly not accurate enough

and contains a secular term that seems to break the conservation of energy at the discrete

level. To correct this behaviour, we consider a second test where the stopping criterion is ﬁxed

to ǫ = 10−5. In that case, the calculation is stable upon the time interval considered and the

accuracy of the spectral element solution is found to be acceptable, its relative diﬀerence with

the reference solution being less than a few per mil.

In each of the previous cases, the angular order truncation in eq. (26) was set to lmax = 20,

based on the a priori knowledge of the dispersion relation in PREM. The eﬀect of underesti-

mating the truncation order is to add oscillations to the spectral element solution (not shown

in this paper). It is interesting to note that the two possible sources of numerical errors (ǫ too

big or lmax too small) lead to a diﬀerent signature. This provides two diﬀerent diagnostics that

permit to build a spectral element solution with arbitrary accuracy.

5 CONCLUSIONS

We have shown how the SEM should be adapted to account for two eﬀects relevant to global

seismology: the full treatment of self-gravitation and the ability to consider any density strat-

iﬁcation in the ﬂuid outer core. The accuracy of the method has been illustrated through a

series of numerical tests conducted in spherically symmetric models. With the incorporation of

the two aforementioned eﬀects, we believe the SEM will provide new estimates of the elastic-

gravitational response of 3D models of the Earth.

16

E. Chaljub and B. Valette

ACKNOWLEDGMENTS

E. C. greatly acknowledges the numerous discussions he had with the members of the seis-

mological task force in Princeton University, USA, where this work was initiated. The writing

of the manuscript has beneﬁted from the careful reading of Ludovic Margerin and Alexan-

dre Fournier. The computations presented in this paper were performed both at the Service

Commun de Calcul Intensif (SCCI) at the Observatory in Grenoble, France and at the Centre

Informatique National de l’Enseignement Sup´erieur (CINES) in Montpellier, France.

REFERENCES

Berm´udez, A. & Rodr´ıguez, R., 1994, Finite element computation of the vibration modes of a ﬂuid-

solid system, Comput. Methods Appl. Mech. Engrg., 119, 355–370.

Bettess, P., 1992, Inﬁnite Elements, Penshaw Press, Sunderland, England.

Capdeville, Y., Chaljub, E., Vilotte, J.-P., & Montagner, J.-P., 2003, Coupling the spectral element

method with a modal solution for elastic wave propagation in global earth models, Geophys. J. Int.,

Chaljub, E., 2000, Mod´elisation num´erique de la propagation d’ondes sismiques en g´eom´etrie

sph´erique : application `a la sismologie globale (Numerical modeling of seismic wave propagation

in spherical geometry: application to global seismology), Ph.D. thesis, Universit´e Paris VII, Denis

Chaljub, E., Capdeville, Y., & Vilotte, J.-P., 2003, Solving elastodynamics in a ﬂuid-solid heteroge-

neous sphere: a parallel spectral element approximation on non-conforming grids, J. Comput. Phys.,

Cowling, T. G., 1941, The non-radial oscillations of polytropic stars, Mon. Not. Roy. Astron. Soc.,

Dahlen, F. A. & Tromp, J., 1998, Theoretical Global Seismology, Princeton University Press, Prince-

Deville, M. O., Fischer, P. F., & Mund, E. H., 2002, High-Order Methods for Incompressible Fluid

Flow , Cambridge University Press, Cambridge, UK.

Dziewonski, A. M. & Anderson, D. L., 1981, Preliminary Reference Earth Model, Phys. Earth Planet.

Friedman, J. L. & Schutz, B. F., 1978, Secular instability of rotating Newtonian stars, Ap J., 221,

152 (1), 34–67.

Diderot.

187 (2), 457–491.

101, 369–373.

ton, NJ.

Int., 25, 297–356.

937–957.

Modeling wave propagation in a self-gravitating Earth

17

Gerdes, K. & Demkowicz, L., 1996, Solution of 3D-Laplace and Helmholtz equations in exterior

domains using hp-inﬁnite elements, Comput. Methods Appl. Mech. Engrg., 137, 239–273.

Givoli, D., 1992, Numerical Methods for Problems in Inﬁnite Domains, Elsevier Science Publishers,

Amsterdam.

Hamdi, M., Ousset, Y., & Verchery, G., 1978, A displacement method for the analysis of vibrations

of coupled ﬂuid-structure systems, Int. J. Num. Meth. Engrg., 13, 139–150.

Hugues, T. J. R., 1987, The ﬁnite element method, linear static and dynamic ﬁnite element analysis,

Prentice-Hall International.

Komatitsch, D. & Tromp, J., 1999, Introduction to the spectral element method for three-dimensional

seismic wave propagation, Geophys. J. Int., 139, 806–822.

Komatitsch, D. & Tromp, J., 2002, Spectral-element simulations of global seismic wave propagation,

part I: Validation, Geophys. J. Int., 149, 390–412.

Komatitsch, D. & Tromp, J., 2002, Spectral-element simulations of global seismic wave propagation,

part II: 3-D models, oceans, rotation, and gravity, Geophys. J. Int., 150, 303–318.

Komatitsch, D. & Vilotte, J.-P., 1998, The spectral element method: an eﬀective tool to simulate the

seismic response of 2D and 3D geological structures, Bull. Seismol. Soc. Am., 88, 368–392.

Komatitsch, D., Barnes, C., & Tromp, J., 2000, Wave propagation near a ﬂuid-solid interface: a

spectral element approach, Geophysics, 65 (2), 623–631.

Masters, G., 1979, Observational constraints on the chemical and thermal structure of the Earth’s

interior, Geophys. J. R. Astron. Soc., 57, 507–534.
Schwarzschild, K., 1906, ¨Uber das Gleichgewicht der Sonneatmosph¨are (On the equilibrium of the

Sun’s atmosphere), G¨ottingen Nachrichten, 1, 41.

Valette, B., 1986, About the inﬂuence of pre-stress upon the adiabatic perturbations of the Earth,

Geophys. J. Roy. Astron. Soc., 85, 179–208.

Valette, B., 1989, Spectre des vibrations propres d’un corps ´elastique, auto-gravitant, en rotation

uniforme et contenant une partie ﬂuide (Free oscillations spectrum of an elastic, self-gravitating,

uniformly rotating body with a ﬂuid inclusion), C. R. Acad. Sci. Paris, 309, I, 419–422.

Wu, W.-J. & Rochester, M. G., 1990, Core dynamics: the two-potential description and a new vari-

ational principle, Geophys. J. Int., 103, 697–706.

Wu, W.-J. & Rochester, M. G., 1993, Computing core oscillation eigenperiods for the rotating Earth:

a test of the subseismic approximation, Phys. Earth Planet. Inter., 78, 33–50.

18

E. Chaljub and B. Valette

ρ
VP
VS

6000

4000

2000

)

m
k
(

i

s
u
d
a
R

0

−1

2

5

8

11

14

Veloity (km (cid:1) s

)

Density (kg (cid:1) m

)

(cid:0)1

(cid:0)3

Figure 1. Variation with depth of density (dashed curve), P -velocity (solid curve) and S-velocity

(dot-dashed curve) within the Earth-like model used in this paper. The model is adapted from PREM

(Dziewonski & Anderson 1981) with the complexity of the lithospheric structure being removed to

simplify computation.

Modeling wave propagation in a self-gravitating Earth

19

3200

2200

)

m
k
(

i

s
u
d
a
R

U

N

S

1200

8

10

12

(cid:0)1

14

Veloity (km (cid:1) s

)

Figure 2. Diﬀerent proﬁles of P -velocity used to test the two-potentials formulation in the ﬂuid

outer core. The dashed curve represents the variation of the sound speed within the model detailed

in ﬁg. 1. Each solid curve corresponds to a modiﬁcation of that proﬁle such that the square of the

Brunt-V¨ais¨al¨a frequency is constant throughout the ﬂuid. The label ‘N’ corresponds to a neutrally

stratiﬁed outer core, whereas ‘S’ (resp. ‘U’) stands for a stable (resp. unstable) stratiﬁcation for which
N 2 = 10−7 rad2 · s−2 (resp. N 2 = −5 10−8 rad2 · s−2).

20

E. Chaljub and B. Valette

20

10

0

−10

)

m
(cid:22)
(

t
n
e
m
e

a
l
p
s
i
D

U
N
S

−20

20000

25000

Time (s)

30000

Figure 3. Time window of the longitudinal surface displacement recorded at 90◦ in the models

labelled ‘N’, ‘S’ and ‘U’ in ﬁg. 2. The large waveform diﬀerences stem from the sensitivity of the

seismic modes to the variation of the P -velocity within the three models.

Modeling wave propagation in a self-gravitating Earth

21

Figure 4. Radial (left panel) and longitudinal (right panel) components of the surface displacement
recorded at 45◦ (top) and 90◦ (bottom) in the model labelled ‘S’ in ﬁg. 2. In each plot, the spectral

element solution (dashed line) is compared to the normal modes reference (solid thin line) and the

residual (solid bold line) is ampliﬁed by a factor of 10.

22

E. Chaljub and B. Valette

Figure 5. Radial (left panel) and longitudinal (right panel) components of the surface displacement
recorded at 45◦ (top) and 90◦ (bottom) in the model labelled ‘U’ in ﬁg. 2. In each plot, the spectral

element solution (dashed line) is compared to the normal modes reference (solid thin line) and the

residual (solid bold line) is ampliﬁed by a factor of 10.

Modeling wave propagation in a self-gravitating Earth

23

Figure 6. Spectral element mesh used to compute the results shown in ﬁgs. 4 and 5. Two blocks

of the 3D mesh have been removed to allow a view inside the volume. The mesh is composed of 640

spectral elements with varying polynomial order, for a total number of gridpoints equal to 334,368.

The process of building the mesh is detailed in (Chaljub et al. 2003). This image was generated using

the visualization software pV3 (http://raphael.mit.edu/pv3/pv3.html).

24

E. Chaljub and B. Valette

Full
Cowling

7.5

2.5

−2.5

)

m
(cid:22)
(

t
n
e
m
e

a
l
p
s
i
D

−7.5

5000

15000

25000

Time (s)

Figure 7. Longitudinal component of the surface displacement recorded at 90◦ in the Earth model

of ﬁg. 1. The trace computed with the full treatment of self-gravitation (solid thin line) is compared

to the one computed within the Cowling approximation (dashed bold line). The waveform diﬀer-

ences illustrate that the eﬀect of the MRP cannot be neglected at the frequencies considered in this

experiment.

Modeling wave propagation in a self-gravitating Earth

25

(cid:15) = 10

(cid:15) = 10

(cid:0)3

(cid:0)5

Modes
Diff*10
SEM

Modes
Diff*10
SEM

7.5

2.5

−2.5

7.5

2.5

−2.5

)

m
(cid:22)
(

t
n
e
m
e

a
l
p
s
i
D

−7.5

5000

15000

25000

−7.5

5000

15000

25000

Time (s)

Time (s)

Figure 8. Longitudinal surface displacements recorded at 90◦ in the Earth model of ﬁg. 1. The left

(resp. right) plot corresponds to a low (resp. high) accuracy test in which the CG iterations used to

compute the MRP are stopped when the residual is decreased by 3 (resp. 5) orders of magnitude.

In each plot, the spectral element solution (dashed line) is compared to the normal modes reference

(solid thin line) and the residual (solid bold line) is ampliﬁed by a factor of 10.

