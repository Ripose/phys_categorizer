6
0
0
2
 
c
e
D
 
1
1
 
 
]
h
p
-
o
e
g
.
s
c
i
s
y
h
p
[
 
 
1
v
9
9
0
2
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

A Dirichlet-integral based dual-access collocation-kernel
approach to point-source gravity-ﬁeld modeling∗

Naval Surface Warefare Center Dahlgren Division
17320 Dahlgren Road
Dahlgren, VA. 22448–5100

Alan Rufty

February 2, 2008

Abstract

Problems in R3 are addressed where the scalar potential of an associated vector ﬁeld satisﬁes Laplace’s
equation in some unbounded external region and is to be approximated by unknown (point) sources con-
tained in the complimentary subregion. Two speciﬁc ﬁeld geometries are considered: R3 half-space and
the exterior of an R3 sphere, which are the two standard settings for geophysical and geoexploration
gravitational problems. For these geometries it is shown that a new type of kernel space exists, which is
labeled a Dirichlet-integral dual-access collocation-kernel space (DIDACKS) and that is well suited for
many applications. The DIDACKS examples studied are related to reproducing kernel Hilbert spaces and
they have a replicating kernel (as opposed to a reproducing kernel) that has the ubiquitous form of the in-
verse of the distance between a ﬁeld point and a corresponding source point. Underpinning this approach
are three basic mathematical relationships of general interest. Two of these relationships—corresponding
to the two geometries—yield exact closed-form inner products and thus exact linear equation sets for
the corresponding point source strengths of various types (i.e., point mass, point dipole and/or point
quadrupole sets) at speciﬁed source locations. The given ﬁeld is reconstructed not only in a point
collocation sense, but also in a (weighted) ﬁeld-energy error-minimization sense.

Key words. Laplace’s equation, inverse problem, Dirichlet form, point collocation, reproducing

kernels, fundamental solutions, point sources, multipole, potential theory

AMS subject classiﬁcations. 35J05, 31B10, 86A22, 65D05

1

Introduction

The goal of this article is to set forth a mathematical framework for the approximation of R3 harmonic
ﬁelds in unbounded domains by point sources contained inside the complimentary region. The proposed
Dirichlet-integral dual-access collocation-kernel (DIDACK) approach has a mathematically and physically
well-motivated underpinning. The associated space (DIDACKS) has certain similarities to reproducing
kernel Hilbert space (RKHS), but is distinct from it. Two concrete R3 geometries are considered: (A) The
harmonic ﬁeld region consisting of half-space (denoted Ω1). (B) The harmonic ﬁeld region consisting of the
exterior of a sphere (denoted Ω0). Within this geometric context, the developed formalism easily handles
various combinations of diverse types of point sources (such as point masses, point mass dipoles or point
mass quadrupoles); moreover, for a set of speciﬁed source locations the formalism yields closed-form linear
equation sets that simultaneously minimize the volume integrals of (weighted) ﬁeld energy densities [i.e.,
(weighted) Dirichlet integrals].

∗Oﬃcially approved for public release; distribution is unlimited, but subject to both U.S. Government and arXive

intellectual property rights protection.

1

.

{

Techniques introduced here can be either applied directly or adapted for use in many mathematical and
physical areas. Examples on the mathematical side include potential theory, point source elliptic bound-
ary value modeling (i.e., method of fundamental solutions), fast multipole techniques, radial-basis function
techniques, RKHS techniques, geophysical collocation (GC) techniques and standard energy minimization
based techniques (such as Galerkin and Raleigh-Ritz based approaches). Also see [21]. Examples on the
physical side include geoexploration (where gravity is often used to locate oil or other minerals), geophysics,
magnetostatics (for a survey of these three areas see [11, 24, 22, 4]), general electromagnetic source analysis,
electrostatics and hydrostatics (for the physical signiﬁcance of these three areas, and of ﬁeld energy with
regards to them, see [3]). Also somewhat similar mathematical structures arise in many other areas such as
biophysical or biomedical engineering
where, for example, electric dipole models are used in electrocardio-
graphical (ECG) modeling and current dipole models are used in electroencephalography (EEG) [2]
}

First, given the diversity just noted, it is clearly desirable to not conﬁne potential readership to one
specialty or another; hence, the required mathematical background for the core part of the article is limited
to classical R3 potential theory [12, 10] and a basic understanding of functional analysis, as utilized in
approximation theory. This core part is primarily mathematical in content and makes up the ﬁrst four
sections. Another, perhaps stronger, motivation exists for limiting the level of this core material—there is
often a given mathematical level that certain research results tend to emerge from and the same results may
not be apparent at either a higher or lower level of mathematical sophistication. The ﬁrst four sections, as
well as the geophysical applications setting given in Section 5, are aimed at this default level of sophistication.
While a knowledge of neither RKHS nor GC is a necessity in these ﬁrst 5 sections, a better understanding of
both these areas is presupposed in Section 6, which describes the connections of DIDACKS theory to other
kernel based approaches. GC, which is often called least-squares collocation, is a RKHS based approach that
diﬀers from standard collocation techniques utilized by applied mathematicians in several relevant ways and,
as such, may not be familiar to many readers. Moritz [18] provides a readily accessible treatment of both
RKHS and GC theory; nevertheless, the thrust of Section 6 should be directly accessible to those familiar
[16], [1] or [26] (which contains [1])
with only standard RKHS theory
}

Next consider the applications setting and why it was chosen. While diverse candidate application areas
exist, the approach adopted here is to select one particular representative problem area, namely geophysical
gravitation, and discuss it thoroughly. In addition to Laplacian inverse source theory, geophysical gravitation
has two separate problem categories that point sources can be used in: ﬁeld modeling and ﬁeld estimation.
For gravitational modeling problems the ﬁeld is assumed to be known throughout the region of interest and
a more compact, but accurate, representation is desired. For estimation problems it is assumed that values
are known accurately at a certain number of points in the ﬁeld region and that one wants to predict gravity
values over some part of this ﬁeld region. Besides combinations of point sources, other techniques (such as
GC) exist for treating gravitational ﬁeld modeling and ﬁeld estimation problems. In a wider mathematical
context, since the kernels involved satisfy a generalized collocation property, DIDACKS modeling and esti-
mation approaches described here can be considered harmonic interpolation and extrapolation techniques,
respectively. With minor diﬀerences these gravitation ( ~G) problems use the same standard notation and
techniques employed in electrostatics, where ~E is the ﬁeld [10], and so this arena should be readily accessible
to all interested applied mathematicians, physicist and engineers. (Within this electrostatic context the for-
malism developed here handles multiple types of various point sources—such as point charges, electrostatic
dipoles or electrostatic quadrupoles.) For consistency the notation used in the ﬁrst four sections is also
specialized to the gravitational setting, but in these sections the intrusion of this setting is minimal.

{

.

Geophysical gravitation as an applications setting was chosen for the following ﬁve reasons: (a) It has
a strong overall historical association with potential theory. (b) It has an easily understood notation and a
readily accessible mature literature. (c) It provides a family of signiﬁcant and challenging problems (that
includes representative geophysical inverse source problems). (d) DIDACKS theory was developed to handle
gravitational problems and all of the author’s direct numerical experience with it is in this arena. (e) GC

2

and its extensions are the family of approaches that are mathematically closest to DIDACKS theory. A
discussion of point (a) is well outside the scope of the present article, but it is worth noting in this context
that Gauss played a very signiﬁcant role in the history of geophysics [9, p. 1]. With regards to point (b), as
well (c), see [9, 18]. (To gauge the advance of physical geodesy compare and contrast [9] with [8], upon which
it is based.) With regards to (c) and (d), since no previous geophysical background is presupposed in the
ﬁrst four sections of the paper, the relevant overall geophysical and point mass modeling context is supplied
in Section 5. Since GC is the most commonly used approach for regional gravitational data processing and
estimation it is brieﬂy described at the end of Section 5. The pertinent diﬀerences between GC and standard
collocation techniques utilized by applied mathematicians are also described in Section 5. Finally, Section 6
considers the mathematical connections implied by (e).

The DIDACKS approach was conceived and is best understood on its own merits as a self-contained
mathematical theory that is independent of the geophysical connections just indicated and it is this exposition
that occupies the ﬁrst four sections. Underpinning this mathematical side of the DIDACKS approach are
three intrinsically interesting relationships that will now be brieﬂy surveyed. First consider the notation
employed. For overall accessibility, for consistency with the geophysical and electrostatic literature and to
avoid various possible notational conﬂicts preference is given to a pedestrian but unambiguous notation:
Cartesian coordinates are used and overset arrows employed to denote R3 vectors, ~X = (x, y, z)T
R3 (for
superscript T := transpose), while for n
= 3 n-dimensional vectors and matrices are denoted by lower and
upper case bold letters, respectively. R0 is used to denote the radius of the sphere associated with Ω0 that
. Likewise for the half-space case, the origin is chosen
is centered over the origin: Ω0 :=
}
~X
in the plane ∂Ω1 :=
. (Observe that the overall shape of
{
the subscripts here match that of the associated boundary.) Frequently these two settings will be denoted
by a subscript j (for example, Ωj), where j = 0 or 1 is always implied.

~X
R0
so that Ω1 :=

~X
{
z = 0

∈
}

| ≥

R3

R3

R3

~X

| |

≥

∈

∈

∈

{

}

0

z

|

|

·

Ω

v

~
∇

~
∇

Temporarily leaving aside the issue of admissible functions, these relationships can be compactly stated in
terms of a Dirichlet integral over some connected but possibly unbounded region Ω, which are usually denoted
w dV for admissible harmonic functions v( ~X) and w( ~X), or in terms of the more
by D[v, w] =
inclusive concept of a weighted Dirichlet integral for the region Ω denoted by D[v, w, µ, Ω], where µ = µ( ~X)
w dV . Clearly D[v, w, 1, Ω] = D[v, w]. Let
is the weighting function so that D[v, w, µ, Ω] :=
ℓ−1 := 1/
, where ~X
j :=
|
compliment of Ωj. (By convention, generally primed variables occur in Ω′
j and unprimed ones in Ωj.) Then
the ﬁrst two relations give the replication (or generalized collocation) properties of the DIDACKS kernel
ℓ−1:

Ωj and ~X ′ is in the corresponding closed source region := ΩSj ⊂

Ω µ ~
v
∇

~X
|

~
∇

~X ′

RRR

RRR

Ω′

−

∈

·

(1)

and

(2a)

(2b)

with µ0 = 1/r ( r :=

~X
|

) and where
|

D[w, ℓ

′
−1, 1, Ω1] = 2π w(x

, y

′

,

′

z

)

−

D[w, ℓ

−1, µ0, Ω0] = 2π

w( ~P )/R2
0

~P
|

|

~P =

R2
0
~X ′
|

2 !
|

 

~X

′

.

Finally the third relationship ties the unweighted Dirichlet integral over Ω0 to the weighted integral given
on the left hand side (LHS) of (2a) and can be written as

(3a)

D[v, w, 1, Ω0] = R0

D[v, w, µ0, Ω0] + (2πR0)

(v, w)σ ,

·

·

3

6
where the surface inner product on the right hand side (RHS) here is deﬁned as

(3b)

(4)

(v, w)σ := (1/4π)

v(r, θ, φ) w(r, θ, φ) d σ

Z Zσ

2π

π

and where, as in [8] and [9], σ and d σ have the following meaning when associated with the integral of f ( ~X)

f (r, θ, φ) d σ :=

[f (r, θ, φ)]

sin θ d θ d φ

Z Zσ

Zφ=0

Zθ=0

r=R0

(cid:12)
(cid:12)
(cid:12)

for standard spherical coordinates r, θ, φ. [Occasionally the limits implicit in (4) will be stated explicitly for
emphasis.] Due to the way r dependence enters in (4) it can be used to derive expressions that are otherwise
not obvious, as will be apparent in the sequel.

Clearly (1) and (2a) give a means of performing closed-form inner products based on the Dirichlet
integral, while (3a) links the weighted Dirichlet inner product to the unweighted one over Ω0. The general
approximation and functional analysis framework for these relationships is given in Section 2. The derivation
of (1) is given in Section 3 and that of (2a) and (3a) in Section 4. In order to understand their connection to
the applications described in Section 5 and to put them in proper historical context, next brieﬂy consider the
history of these relationships. Originally (2a) and (3a) were discovered in a diﬀerent form by the author in
the early 1980’s—namely (27) and (22), where the “integral norm” introduced in Section 4 is used in place of
the weighted Dirichlet integral. The history of these relationships in this form and of their application from
inception to the mid-1990’s can be found in [20]. The germane part of this internal history is summarized and
updated in Section 5. As an aside, although (1) is not explicitly mentioned in [20], the derivation in Section 3
of it is the one originally found by the author in the early 1980’s. The direct relationship of the integral norm
to the weighted Dirichlet norm (32) is new. Also unless otherwise noted, the presentation itself (including
various terms and concepts) is completely new here. Finally, while the general DIDACKS technique is a
synthesis of several results that seem to have been overlooked by the broader scientiﬁc community, for any
mathematical approach that directly touches on harmonic analysis, RKHS theory and gravimetric inverse
source theory either precedents or specialized parallel lines of development would seem to be a necessity. The
known ones for R3 DIDACKS theory are addressed in Section 6. In one way or another all of the discussions
of Section 6 pertain to the second DIDACKS relation in weighted Dirichlet form, (2a). As discussed there,
(2a) should clearly be viewed as going back to Krarup in [14], since he derived it there in a directly equivalent
form. Aside from the author’s work, there are no known instances of (1) and (3a), or for that matter for the
second DIDACKS relation expressed in the integral norm form (27).

To motivate a further exploration of the paper’s scope and limits it is useful to envision the possible
reactions of four typical classes of readers to the above relations. First, consider an applied mathematician,
physicist, engineer or other scientist who may be familiar with the material in the ﬁrst four chapters of [10],
but is not yet a seasoned practitioner and may beneﬁt by consulting [16], [18] or [12]. (The physical and
historical importance of Dirichlet integrals and of the associated Dirichlet principle may be obtained from
other sources [3, 17, 6].) This reader may ﬁnd all three of the above ﬁeld energy expressions somewhat
surprising: (1) and (2a) because they allow for the closed form evaluation of volume integrals and (3a)
since it allows for an unusual reexpression of the volume ﬁeld energy. This reader may also observe that
(1) and (2a) appear to have some connection to Green’s functions and the method of images [10] and may
recognize (2b) as the coordinate transformation part of a Kelvin transformation [12, 13]. These particular
connections arise from the nature of Green’s functions for Ωj, but the most direct explanation requires some
knowledge of RKHS theory. First, as noted in [3], the existence of a closed-form reproducing kernel occurs
when closed-form expressions for both Neumann and Dirichlet Green’s functions exist. Second, for the cases

4

studied here a dual-action collocation kernel (DACK) arises from the result of a reﬂection, (1), or Kelvin
transformation, (2b), applied to a reproducing kernel of the right form for the relevant geometry.

Second, while the possible reactions of any number of specialists might also be examined, consider a
reader who has a particular interest in integral kernels or RKHS theory. For various reasons this reader may
also ﬁnd the above relationships somewhat surprising. This reader might, for example, observe that ℓ−1 plays
−1 for ~X
the role of a kernel and then recall that a symmetric reproducing kernel (SRK) of the form
|
and ~Y both in the same region cannot exist since a SRK must be bounded and this kernel is not. Here ~X ′
is a ﬁxed interior point and ~X is in the exterior region so ℓ−1 is bounded, which is a very diﬀerent situation
and implies a change of perspective. This in itself could raise further questions since although DACKs are
not reproducing kernels they have some properties analogous to them. In the previous paragraph the kernels
studied here were linked to reproducing kernels, but it is unclear whether minimum norm DACKs can arise
in other ways. Moreover, consideration of DACKs as a separate class of kernels also raises the question as to
how they ﬁt into our current overall understanding of kernel structures. These and other issues of a general
nature are outside the scope of the present article, but some speciﬁc topics that might interest the second
type of reader, such as the exact deﬁnition of the replication and generalized collocation property mentioned
above, are addressed in Section 2.

~X
|

−

~Y

Third, consider a reader who is very applications and results oriented. Such a reader may be disappointed
to discover that there is not a table containing numerical examples and results; however, a discussion of point
mass and point dipole DIDACKS results and their associated applications settings can be found in Section 5,
where global non-linear least squares (NLLSQ) results are emphasized. Due to the variety and nature of
regional gravity data, as well as other issues [20], no known easily replicated example provides generic
benchmark results, which is normally an expectation for these tabulated examples. Moreover, point source
ﬁtting problems are part of a general class of problems that are “notoriously” ill-conditioned and problematic
[4, pp. 214-222] so that each problem encountered should be tackled on its own terms, which means that one
or two simple table examples cannot serve to provide adequate implementation guidance. Unfortunately,
a thorough discussion of associated implementation strategies is outside the scope of the present article.
Also observe that a concrete example provides a replication check that can serve as a consistency test for
implementors, but this point is largely superﬂuous here since the DIDACKS approach exhibits the generalized
collocation property with respect to point sources and thus, when implemented correctly, any point mass
or dipole ﬁt replicates the point ﬁeld data that was used to produce it in the ﬁrst place to within allowed
round-oﬀ error and thus any implementation serves as its own self-consistency test.

Fourth and ﬁnally, consider a reader whose primary interest is in the theory and application of Laplacian
inverse source theory. Since there are many shared implementation pitfalls common to both point source ﬁeld
modeling and inverse source estimation problems, the comments just made in the last paragraph are also
relevant in this context. While speciﬁc mathematical tools and implementation strategies are not discussed
here, readers with solid applications experience should be able to make direct use of the formalism presented.
These readers may also be interested in the topic of continuous parameterized distributions, which is raised
in Section 2. Finally, it is worth noting that other source region shapes can be entertained within the
contexts of the two considered geometries since the only real requirement is that source regions be bounded
and contained within the compliment of the unbounded harmonic ﬁeld region.

2 Generalized Linear-Least Squares Setting

This section addresses the generalized least-squares (GLLSQ) plan of approach and the associated functional
space setting. There are numerous approaches closely aligned to the GLLSQ one adopted here—such as the
Galerkin and Raleigh-Ritz based techniques mentioned in the introduction; however, the acronym GLLSQ is
introduced to imply an implicit change of perspective. In particular, connections to generalized collocation,

5

as discussed later in the section and explicitly formalized by the GLLSQ collocation condition, are implied
as well as an approach that is distinct from the usual LLSQ ones where sampling and discretization are
introduced. Connections to GC are also implied.

Both LLSQ and GLLSQ approaches minimize some cost function Φ′ =

2, where for the problems
of interest v( ~X) is a point source potential model and w( ~X) is some given canonical (or truth) reference
potential. For a point mass ﬁt with Nk point masses v has the form

−

w

k

k

v

(5)

v( ~X) = G

Nk

~X
|

Xk=1
6.6742

mk

,

~X ′
k|

−
10−11m3s−2Kg

where G is the Newtonian gravitational constant
~X
basis functions occurring in (5) are always bounded. Further ~X ′
k′

Ωj and ~X ′

ΩSj , which is a bounded and closed subregion of the open region Ω′

k for all k′

= ~X ′

k ∈

≈

×

∈

−1 [9, p.3]. As previously noted,
j, so that the (kernel)

= k is always assumed.

Five conventions are adopted here. First, in physics texts the potential function v is interpreted as
potential energy and (5) has a negative sign since all gravitational bodies attract and the resulting force
is given by the negative of the gradient of the potential. In geophysics these sign conventions are diﬀerent
and consistent with (5), but in either case this should cause little diﬃculty since in ﬁtting problems all
that is required is that the overall sign conventions for v and w be consistent. Second, it is assumed that
gravitational force is always acting on a unit test mass [9, p. 4] and thus it will be treated as having
the units of acceleration [9, p. 45]. Third, physical geodesists distinguish between gravity ﬁeld quantities,
which include the eﬀects of the Earth’s rotation, and gravitational quantities like (5), which do not [9, p.
44]. This is a distinction physicists generally do not make since rotational eﬀects can be easily tracked and
accounted for as required. The physicist’s lead is followed here and this distinction is ignored. Fourth,
both positive and negative masses will be considered a possibility since this is the usual convention adopted
in point mass ﬁtting approaches. Speciﬁcally, for gravity modeling and estimation problems each mk can
clearly be viewed as a mathematical parameter that can assume either sign. This convention also allows for
the ready adaptation of material developed here to other areas where both signs can occur. (Even regional
geoexploration inverse mass density estimation problems can be handled by assuming that all smoothed
density estimates are with respect to an average or ambient density.) Fifth, it is useful to introduce scaled
versions of the above potential functions in order to absorb the factor of G: V = v/G and W = w/G. Thus
the cost function to be minimized becomes (with Φ := Φ′/G2):

(6)

Φ =

V

k

−

W

2

k

=

V

k

2

k

−

2 (V, W ) +

W

2

.

k

k

(Notice that scaling a cost function leaves the minima unchanged.)

Next consider the philosophy behind the norm selection process. As discussed later in Section 5 the
minimization philosophy of matching the observations as closely as possible has generally been chosen for
point mass ﬁtting problems. This philosophy is, however, not necessarily sound in all or even most cases.
For modeling problems a reference model, which is assumed to be accurate, is given and one wishes to
match this reference as closely as possible in some physical sense. Here the desire is to minimize the possible
error diﬀerences that will result when this given reference model is replaced by a new point mass (or point
source) model, which invariably occurs in some sort of software emulation of a physical situation. Thus
instead of “matching the observables as closely as possible,” a sounder strategy is to “minimize the type
of errors that will lead to the greatest errors in the end product.” From Newton’s second law, since these
end-product errors here are most often the direct result of gravity errors it is clear that the diﬀerence in
the given gravity reference ﬁeld and the developed point mass gravity model should be minimized, say in a
squared residual sense at a large number of appropriate sample points. As this distribution of sample points

6

6
6
becomes uniformly dense over the entire global region of interest the following key integral condition results:

(7)

Minimize Φ =

V

~
∇
|

W

~
∇

2 dV = D[W
|

−

−

V, W

V, 1, Ωj] .

−

Z Z ZΩj

Temporarily leaving aside fundamental issues, such as how to turn the RHS of (7) into a proper norm
structure, consider the general form of the linear equation sets that result from minimizing this type of cost
function. For concreteness consider the minimization process in R3 half-space (Ω1). Since the RHS of (7) is
already proportional to the ﬁeld energy, it is natural to consider the half-space (j = 1) energy norm:

(8)

V

k

−

W

2
E1

k

:=

1
8π

V

~
∇
|

W

~
∇

2 dV
|

−

Z Z ZΩ1

(a factor of 8π has been inserted since it often occurs for various ﬁeld energy expressions in appropriate
units). Because

, the energy inner-product

W

W

=

+

V

V

2
E1

k

2
E1

k

k

k

2
E1 −

k

2(V, W )E1

k

−

(V, W )E1

:= D[V, W, 1, Ω1]/8π

is also needed. In particular if V is speciﬁed through (5), with ℓk :=
reference ﬁeld, then

~X
|

~X ′
k|

−

, and if W is an appropriate

(9)

V

k

−

W

2
E1

k

=

W

k

2
E1 −

k

2

mk(ℓ

−1
k , W )E1

+

mk mk′ (ℓ

−1
k , ℓ

−1
k′ )E1

.

Nk

Xk=1

Nk

Nk

Xk=1

Xk′=1

Taking the partial of (9) with respect to mk′′ (for k′′ = 1, 2, 3, . . . , Nk), setting the result to zero, then
dividing by two yields a linear equation set that can be easily inverted for the mass values, provided that
(ℓ
can be easily computed for φ = W and φ = 1/ℓk. The relationship which makes this possible is
−1
(1). By introducing Tk,k′ = (ℓ
k )E1

the linear equation set can be written as

and Ak = (W, ℓ

−1
k , φ)E1

−1
k′ )E1

−1
k , ℓ

(10)

Tk,k′ mk′ = Ak .

Nk

Xk′=1

For the spherical exterior matters proceed in much the same fashion except that a weight function,
into a replicating kernel,
µ0 = 1/r, must be introduced into (7). Not only is this weighting required to turn ℓ
but since regions closer to the Earth’s surface are normally of greater interest for geophysical applications
than regions further away it is also desirable.

−1
k

Obviously with regards to applications (10) is pivotal and, as such, warrants at least an informal ex-
amination. Before proceeding it is useful to clarify the diﬀerences between reproducing, replication and
−1
generalized collocation kernels. When a kernel, like ℓ
k , is not symmetric since its arguments are in diﬀerent
domains and there is a relationship such as (1) or (2a) that allows for closed-form inner-product expressions
it will be called a replication kernel and be said to have the point replication property. Since reproducing
kernels are necessarily symmetric they cannot be considered replicating kernels so this terminology distin-
guishes replication and reproducing kernels. Alternatively, the term generalized collocation property will be
taken to be a generalization of a point data and/or collocation matching condition and as such includes not
only the possibility of reproducing kernels, but also replicating kernels. As discussed below, it also allows
for the possibility that resulting inner products may be obtainable by numerical means (after assuming an

7

underlying replication property also holds)—so long as the resulting inner products, Ak, occuring on the
RHS of (10) can be matched. (The Ak’s may also represent empirically obtained data.)

As a concrete example of situations where numerical integration frequently enters consider ﬁts based on

the continuous analog of (5) where the potential is due to some parameterized density function ρ:

(11)

V ( ~X) =

ρ( ~X ′, α)
~X ′
~X
|

−

|

dV

′

.

Z Z ZΩS

Nk

W

P

then minimizing

k=1 αkψk( ~X ′)
}

Here α = (α1, α2, α3, . . . , αNk )T .
If ρ consists of a linear superposition of density basis functions ψk
2 yields a linear equation set similar to (10), where
V
i.e., ρ =
k
{
the Ak’s and Tk,k′ ’s must generally be computed numerically; however, when (1) or (2a) is used then great
simpliﬁcations result and continuous distributions are tractable. Besides parameterized volume distributions,
parameterized surface and line distributions are also obviously possible. One interesting choice for volume
density basis functions ψk is the use of ﬁnite element method (FEM) basis functions. Thus consider the case
k are taken to be a set of node points over ΩS and the ψk( ~X ′) are chosen to be a set of localized FEM
where ~q ′
k) = 1 if k′ = k and ψk′ (~q ′
basis functions with the property that ψk′ (~q ′
k) = 0 otherwise. The αk determined
directly from the analog of (10) then represent the density strengths at the node points ~q ′
k.

−

k

k

k

k

k

V

V

−

W

and

Ω replacing the values of ~X ′

Any additional structure that can help to clarify the possibilities inherent in (10) is desirable. Towards
that end brieﬂy consider a suggestive theorem from RKHS theory. When a reproducing kernel, with speciﬁed
kernel points ~Qk ∈
k in (5), is used for a basis functions expansion of V that
is analogous to (5), and when (6) is replaced by the corresponding cost function based on the reproducing
kernel norm, then minimization of this cost function results in a closed-form linear equation set that is just
like (10)—except that the inner products corresponding to Ak take on the simpler form W ( ~Qk). This type
of reproducing kernel ﬁt also satisﬁes a minimum norm collocation property: the function with the smallest
associated norm that matches the prescribed data set [i.e., the values W ( ~Qk)] is the one which results from
solving the analog of (10) [18, pp. 207–220]. This minimum norm property is a well known functional analysis
result [16] and it insures that a reproducing kernel ﬁt will simultaneously match the given point data and
minimize both
for the associated norm. This fact is of interest here since it strongly
suggests that if a replicating kernel expansion for V is used in (10), then generally any speciﬁed values for
Ak are recovered and that D[V, V, 1, Ω1] or D[V, V, µ0, Ω0] also is simultaneously minimized. While this
may fail to happen due to auxiliary restrictions placed on the basis functions or on the overall space of
admissible functions, the main way that it can fail to happen is if the kernel basis functions themselves are
not linearly independent. These possibilities are not usually addressed in connection with general discussions
of the minimum norm collocation property, but in many settings linear independence may not always be
transparent, especially if combinations resulting from linear operators acting on kernel basis functions are
allowed. (These possibilities can be seen from, among other things, the consequences of the fact that various
restricted classes of functions, such as polynomials of ﬁxed degree, may have a reproducing kernel.) When
(10) is invertible the source parameters (mk) are uniquely determined and in some sense one can say that the
solution to the inverse point source problem has been obtained. To preserve and extend these inverse source
interpretational possibilities, the conservative stance is adopted here of requiring that all admitted basis
function sets be invertible and that the solutions to (10) replicate the speciﬁed Ak values. This condition
is called the generalized least squares collocation (GLLSQC) condition. There are two obvious ways to
enforce this condition: either on a computational case by case basis or by proving general theoretical results
about classes of particular basis functions. While it is not comparatively well known outside geophysics, a
demonstration exists that shows point mass basis functions are independent in Rn for ﬁnite n > 1 [23]. Thus,
in a theoretical sense the GLLSQC condition holds for point mass ﬁts, but on a case-by-case basis some care
is generally required in solving (10) due to ill-conditioning. (As a matter of practice, either a singular value
decomposition or a Hausholder triangulation algorithm implemented to an appropriate number of signiﬁcant

8

digits should be used.) Finally, it should be readily apparent that while continuous distributions may
well satisfy the GLLSQC condition, counter-examples can be easily constructed, with perhaps the simplest
example resulting from the consideration of several concentric homogenous spherical shells.

With regard to the overall functional analysis setting, the standard course taken nowadays is to adopt
some type of general Banach space setting (such as one type or another of Sobolev space), where the
completeness of Cauchy sequences is presupposed. The limit of sequences of functions composed from basis
functions that satisfy the GLLSQC condition may not satisfy it, hence admitting limits of sequences can
lead to unwanted interpretational diﬃculties here. Obviously, to solve (10) it is only necessary that a ﬁnite
linear span of basis functions be admitted, which requires only an inner-product structure. In accord with
the conservative stance outlined above, a structured pre-Hilbert space setting is adopted since a pre-Hilbert
space setting presupposes an inner product structure, but it does not make the usual assumptions about
admissible sequences of functions. (This way of specifying functions of interest is somewhat dated, but prior
to the mid-1950’s it was the prevailing way of addressing Dirichlet inner product spaces and it was used,
for example, in [3]). The adjective “structured” here means that further auxiliary conditions are imposed
on the class of admissible functions. One such condition is that any set of basis functions considered must
satisfy the GLLSQC condition stated above. Another requirement is that all functions, f , must be harmonic
over Ωj (including ∂Ωj). Additional structure is needed to insure that (weighted) Dirichlet integrals over
unbounded domains can be regarded as deﬁning a positive deﬁnite norm. This can be accomplished by
assuming one (or all) of the following four largely equivalent requirements:

(I) D[f, f, 1, Ωj] is bounded and f tails oﬀ at least as fast as 1/r as r

(II) The ﬁrst Sobolev norm of f over Ωj is bounded: D[f, f, 1, Ωj] +

.
−→ ∞
f
|

2 d V <
|

.
∞

Ωj
RRR

(III) f is a potential function generated by a (well-behaved) localized source distribution in ΩSj ⊂
(IV) A well behaved series representation for f always exists in the form of a spherical harmonic expansion

j \

Ω′

∂Ω′
j.

of f in powers of 1/r, for the exterior of some sphere contained inside Ω′
j.

f from this point to a point at inﬁnity one can infer that

Notice that (I) is the historical approach [3] and that (II) equivalent to (I) for Ωj = Ω0 since both the
integrals occurring in the ﬁrst Sobolev norm must be separately bounded. Also for all f not identically
zero, 0 < D[f, f, µ0, Ω0] < D[f, f, 1, Ω0]/R0, where positivity can be easily proved using several standard
= 0 at some point in Ω0 then taking the line integral of
properties of harmonic functions. (Speciﬁcally, if
~
> 0 for at least one point along this line.
∇
Then from the mean-value theorem and the maximum-modulus theorem ~d
f > 0 must occur throughout
some neighborhood near ∂Ω0 for one ﬁxed direction ~d or another and from this it follows immediately that
D[f, f, µ0, Ω0] > 0.) It is clear that (III) and (IV) are largely equivalent to (I) or (II) [although (III) and
(IV) do not require harmonicity as a separate condition]. Requirement (III) is more or less tantamount to
the assumption that a collection of a point sources is being modeled.

~
f
∇
|

~
∇

f
|

| 6

|

·

3 Half-Space (Ω1) Relationships

For the class of admissible functions just described with bounded source region, the following half-space
analog of Poisson’s solution to the Dirichlet boundary value problem holds [5, p. 268]:

(12)

W ( ~X) =

1
2π

∞

∞

−∞
Z

−∞
Z

[(x

−

W (x′′, y′′, 0) z dx′′ dy′′
x′′)2 + (y

y′′)2 + z2]3/2

−

9

Observation Type

Source Type

Invariance Property

Potential
Gravity

Point Mass
Point Dipole

Gravity Gradient Point Quadrupole

Scalar
Vector
2nd Rank Tensor

Table 1: Point Data/Source Correspondences for R3 Half-Space

where z > 0 and ~X ′′
region Ω1, that ∂ /∂ n :=
ﬁrst identity1 yields:

∈

(13)

(ℓ

−1
k , W )E1

=

−

1
8π

Z Z ZΩ1

Next observe that

∂Ω1. Using the facts that the surface integral at inﬁnity is zero for the unbounded
∂ /∂z and that dS = dx dy for the boundary plane (∂Ω1) and applying Green’s

−1
k

~
ℓ
∇

~
∇

·

W dV =

1
8π

−

W ∂
∂z

1
| ~X− ~X′
k|

dx dy .

∞

∞

−∞ Z
Z

−∞

h

z=0
i (cid:12)
(cid:12)
(cid:12)
(cid:12)

(14)

where z′

(15)

k < 0. Combining (12), (13) and (14) produces:

∂
∂z

1
| ~X− ~X′
k|

h

=

z=0
i (cid:12)
(cid:12)
(cid:12)
(cid:12)
−1
k , W )E1

(ℓ

[(x

−

x′
k)2 + (y

k)2 + (z′
y′

k)2]3/2 ,

z′
k

−

′
k, y
= W (x

′
k,

′
k)/4 ,

z

−

which shows (1). This relation can be used to evaluate the terms Tk,k′ and Ak occurring in (10):

(16)

Tk,k′ =

4

(x′

k −

p

x′
k′ )2 + (y′

y′
k′ )2 + (z′

k + z′

k′ )2

1

k −

, Ak =

W (x′

k, y′
k,
4

z′
)
k|
|

.

k

i SkiLki(ℓk

Two ﬁnal points are relevant. First, dipole and other higher order multipoles also can be easily ﬁt. In
−1) where Ski are the associated
general potentials for these point sources can be written as
source strengths and the Lki are appropriate linear diﬀerential operators that can be expressed as a sum of
P
partials of various orders with respect to x, y, or z. For example, an electrostatic or point mass dipole term is
−1
k := (∂ /∂x′
′
k , where ~
proportional to ~Dk ·
k)T , and components
∇
of ~X ′
k serve only as parameters when they occur inside the inner product here, all ~X dependent derivative
that occur inside inner products can be replaced with ~X ′
factors operating on ℓ
k derivative factors; hence,
these diﬀerential operators can be moved inside or outside the inner products entirely as desired so that
all required inner products for Tk,k′ and Ak can be easily evaluated in closed form. For half-space, these
possibilities and the associated measurable point quantities are displayed in Table 1. Analogous possibilities
exist for the spherical exterior case.

−1
k . Since ~
∇

k, ∂ /∂y′

k, ∂ /∂z′

′
~
kℓ
∇

−1
k =

~
ℓ
∇

−1
k

P

−

ℓ

Second, to improve the condition number of the matrix T in (10), it is often desirable to use normalized

basis functions ˆϕk in place of ℓ

−1
k :

(17)

ˆϕk :=

, where

Nk :=

1

RRRΩ(φ∇2ψ + ~∇ψ · ~∇φ) dV =

RR∂Ω φ ∂ψ

∂n dS

Nk
ℓk
e

1
−1
k k

ℓ

k

e

10

in the general norm setting. Introducing
mk := mk/

Nk allows (16) to be reexpressed as

Tk,k′ := ( ˆϕk, ˆϕk′ ) =

Nk

Nk′ Tk,k′ , ˜Ak := (W, ˆϕk) =

Nk Ak and

e

e

e

e
(18)

e

For the R3 half-space energy norm

Tk,k′

mk′ = ˜Ak .

e

Nk

Xk′=1

e

e

2

(19)

Nk = 2

,

Tk,k′ =

3
2

z′
k|
|
q

(x′

k −

k′ )2 + (y′
x′
p
k −

kz′
z′
k′
k′ )2 + (z′
y′

k + z′

k′ )2 ,

˜Ak =

z′
k|
|
√2
p

′
W (x
k y

′
k,

′
k) ,

z

−

e

e

p

so that (18) can easily be inverted to determine the values of
mk and thus mk. While the use of normalized
basis functions is not always required for point mass ﬁts, their use in mixed type point source ﬁts is always
highly recommended due to the diverse associated physical scales that occur there and the attendant large
condition numbers for T . (An experiment was performed on the results from one of the global NLLSQ
combined point mass/dipole ﬁts discussed in Section 5. At the speciﬁed source locations a linear ﬁt was
done both with and without normalized basis functions. The ratio of the two resulting condition numbers
was over 1020.)

e

4 Spherical Exterior (Ω0) Relationships

The goal of this section is the derivation of the two relevant spherical exterior DIDACKS relationships, (2a)
and (3a). Matters are more complex for this case than they were for the half-space case, but all of the
supporting issues raised in Sections 2 and 3 can obviously be carried over here, so they are not repeated.
Let f and g be two admissible functions as discussed in Section 2 and consider the integral norm [20]:

(20)

(f, g)I :=

Dr(rf g) d σ =

Dr(f r g)

d σ , where Dr :=

∂
∂r ·

R2
0
4π

−

Z Zσ

R2
0
4π

−

Z Zσ

(cid:2)

r=R0

(cid:3)(cid:12)
(cid:12)
(cid:12)

The last expression on the RHS here follows from the evaluation convention of (4). The label “integral norm”
was chosen by the author since, as discussed below, the integrals required for point mass ﬁtting in Ω0 can
be evaluated in closed form and there is little chance of confusing this norm with the usual norm of square
integrable functions.

Applying Green’s ﬁrst identity to the Ω0 energy inner product and noting that the surface integral at
Dr for the bounding inner exterior surface of Ω0, yields:

inﬁnity vanishes, while dS = R2

0 d σ and ∂ /∂ n :=

(21)

(f, g)E0

:=

1
8π

Z Z ZΩ0

f

~
∇

~
∇

·

g dV =

−
R2
0
8π

−

Z Zσ

g Drf d σ =

R2
0
16π

−

From (20) and (21) it follows immediately that

(22)

(f, g)I = 4 R0(f, g)E0 −

R2

0(f, g)σ .

Dr(f g)

d σ .

r=R0

Z Zσ

(cid:2)

(cid:3)(cid:12)
(cid:12)
(cid:12)

After the second DIDACKS relation, (2a), is addressed, it will be shown that the integral norm is proportional
to the weighted Dirichlet integral, which will complete the proof of the third DIDACKS relationship, (3a).

11

First, observe that the following two equations can be shown through a relatively straightforward evalu-

ation of their respective LHS and RHSs:

=

R2
0
r′
k (cid:24)(cid:22)

1

~X
|

−

(cid:24)(cid:22)

r=R0

r
ℓk (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

r=R0

~Pk| (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1

(23)

and

(25)

(26)

(27)

(28)

~X ′
k|
|
R4
0
4πr′
k

(cid:24)(cid:22)

Z Zσ

(24)

r
ℓk (cid:19) (cid:21)(cid:12)
(cid:18)
r=R0
(cid:12)
(cid:12)
(cid:12)
k = ~X ′ and r′
where ~Pk is given by (2b) with ~X ′
(cid:12)

Dr
(cid:24)(cid:22)

=

k :=

R2
0
r′
k (cid:24)(cid:22)

−

Dr

~X
|

~Pk| (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
. Employing (23) and (24) yields
(cid:12)

r=R0

−

R2
0
4π

−

Z Zσ

Dr

(cid:24)(cid:22)

(cid:18)

rW
ℓk (cid:19) (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dσ =

−

r=R0

(DrW )
~Pk|
~X
|

−

W Dr

−

1

~X
|

−

dσ .

r=R0

~Pk| (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Recall that W is harmonic for r > R0. Applying Green’s second identity2 to (25) yields

R2
0
4π

−

Z Zσ

Dr
(cid:24)(cid:22)

(cid:18)

dσ =

R2
0
4πr′
k

−

r=R0

Z Z ZΩ0

W

2
∇

1

~X
|

−

~Pk| (cid:19)

(cid:18)

dV .

rW
ℓk (cid:19) (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

4πδ( ~X

−

Then using

2
∇

1/

~X
|

−

(cid:16)

~Pk|
(cid:17)

=

−

~Pk), where δ is the Dirac delta function [10, p. 35], gives

or ﬁnally, with Pk =

~Pk|
:
|

R2
0
4π

−

Z Zσ

Dr
(cid:24)(cid:22)

(cid:18)

rW
ℓk (cid:19) (cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

dσ =

W

~Pk

r=R0

(cid:16)

(cid:17)

R2
0
r′
k

(ℓ

−1
k , W )I = Pk W

.

~Pk
(cid:16)

(cid:17)

−1
k

into the LHS of (26). A second way is to ﬁrst observe that (ℓ

Various other ways to prove (27) exist. One way is to substitute spherical harmonic expansions for
−1
W and ℓ
k′ )I can be evaluated in
closed form by using spherical coordinates on the LHS of (26). Next, this result can be generalized by
substituting the integral form of Poisson’s equation (not Poisson’s integral) for W into the LHS of (27) and
−1
then reintroducing the closed-form expression just obtained for (ℓ
k′ )I , which results in the RHS of (27)
reexpressed in terms of the integral form of Poisson’s equation. As previously noted these various steps were
the ones originally followed by the author and account for the nomenclature. Other proofs have also been
discovered.

−1
k , ℓ

−1
k , ℓ

This leaves the proof of the relationship between the weighted Dirichlet integral and the integral norm.

Recalling the limit convention implicit for integration over σ, (4), and expanding the RHS of (20) yields

(f, g)I =

f g d σ

R2
0
4π

−

Z Zσ
RRRΩ(φ∇2ψ − ψ∇2φ) dV

R2
0
4π

−

Z Zσ

rDr(f g) d σ .

2

RR∂Ω “φ ∂ψ

∂n − ψ ∂φ

∂n ” dS =

12

Next temporarily ignore the common factor of R2
Using the fact that Drf = ( ~X/r)

~
∇

·

∞

0/4π and consider the two integrals on the RHS of (28).

f , the ﬁrst integral on the RHS of (28) can be written as

f g d σ =

−

ZZσ

Z Zσ

Zr=R0




Dr (f g) dr

d σ =

−2 Dr (f g) dV

r




Z Z ZΩ0

=


(g r

−3) ( ~X


f ) dV +

(f r

−3) ( ~X

g) dV .

~
∇

·

~
∇

·

Z Z ZΩ0

Z Z ZΩ0

Green’s second identity in the following form will be useful in reexpressing the second term on the RHS

ψ

~
∇

~
∇

·

φ dV =

−

ZZσ

Z Z ZΩ0

r2 ψ (Drφ) dσ

where φ is harmonic in Ω0, but ψ need not be and both must vanish suﬃciently fast as r
. Using this
identity at the appropriate place twice in the following expression (ﬁrst with ψ = f /r and φ = g and then
with f and g reversed), the second term on the RHS of (28) can be rewritten as

−→ ∞

(31)

rf (Drg) d σ

r g (Drf ) d σ =

−

Z Zσ

−

Z Zσ

~
g
∇

~
∇

·

(f /r) dV +

~
f
∇

~
∇

·

(g/r) dV .

Z Z ZΩ0

Z Z ZΩ0

Finally using ~
∇
produces

(f /r) = r−1 ~
∇

f

−

r−3 ~Xf in (31) and substituting this result along with (29) into (28)

(29)

of (28):

(30)

(32)

(f, g)I =

R2
0
2π

Z Z ZΩ0

r

−1 ~
f
∇

~
∇

·

g dV .

With the aid of (22), (27) and (32), the second and third DIDACKS relationship [i.e., (2a) and (3a)] follow
immediately. From (32) and the discussion at the end of Section 2 the integral norm is positive deﬁnite.

DIDACKS dipole and other higher order multipole implementations diﬀer for the half-space and spherical
settings in one signiﬁcant way. While closed-form expressions for all the required inner products for an
integral-norm point-mass ﬁt can be evaluated just as discussed in Section 3, for higher-order multipole ﬁts
all the derivatives of the potential for all the lower orders are also required in the spherical case because
taking partials with respect to the components of ~X ′
k yields additional terms on the RHS of (27). This means,
for example, that a dipole ﬁt requires not only point gravity information, but point potential information as
well. It is thus natural in this case to perform not only a point dipole ﬁt, but a combined point mass/dipole
ﬁt. With this understanding the spherical case analog of Table 1 is readily obtained.

When an integral norm higher order multipole ﬁt is desired and the lower order derivatives of W are not
available then it still may be possible to do the ﬁt [20]. For example, if a dipole ﬁt is desired and information
about W is not available, but the gradient of W is known along various intersecting lines, then potential
data in the form W ( ~X) = W0 + δW ( ~X), where W0 is an unknown constant, can be assumed anywhere
along these lines since the form of δW ( ~X) can be found by numerical line integration. For any assumed
trial value of W0, a DIDACKS ﬁt can be performed. The results of this ﬁt can then, in turn, be substituted
into a standard LLSQ type of cost function that is the analog of (33) and is based on minimizing gravity
computations at various sample points. If gravity data itself is plentiful, then an outer-loop optimization
process can be based on minimizing this new cost function, where W0 is treated as an unknown NLLSQ

13

parameter.
In this outer-loop process sample point gravity diﬀerences are minimized throughout the ﬁt
region of interest (which may be only a small part of Ω0). When its choice is not obvious, R0 can also be
treated as a parameter and optimized in the same fashion.

5 Broader Point Mass Fitting Context

The goal of this section is to illuminate certain aspects of relevant geophysics and point mass ﬁtting back-
ground material by way of a brief synopsis (as such this section is somewhat subjective). Before considering
the associated geophysical context it is useful to clarify the distinction between NLLSQ and GLLSQ or LLSQ
problems and to brieﬂy consider how the pertinent DIDACKS applications history ﬁts into these categories.
In the sequel, the distinction between GLLSQ and LLSQ is generally dropped and only the acronym LLSQ is
used so that both classes can be referred to jointly. If all the source locations are known then linear equation
sets result for the source strengths and in the DIDACKS approach these linear equation sets are exact due to
(1) and (2a). Alternatively, if both the locations and strengths are to be determined then a NLLSQ problem
results since source locations enter as non-quadratic parameters in the cost function. While only LLSQ prob-
lems have been addressed so far in this article, accurate low degree and order spherical harmonic (tesseral)
NLLSQ ﬁts have been obtained by the author and this was, in fact, the ﬁrst area of DIDACKS applications
in the early 1980’s [20]. These NLLSQ ﬁts are discussed further below. While rather varied approaches
have been used by diﬀerent researchers for point mass based geoexploration inverse source applications, for
the gravity modeling and estimation problems dealt with here far fewer point mass based approaches have
been employed; nevertheless, not only have the associated research eﬀorts been internationally diverse, but
the corresponding literature is also extensive so that only a small part of it can be considered here (see [25]
for additional history and references). LLSQ and NLLSQ point mass gravity models can also be produced
to serve as synthetic gravity models with realistic attributes, but DIDACKS applications in this area have
not been considered so it is not discussed below. Finally, two conventions are adopted in the sequel: (a) a
N ﬁeld or expansion and (b) both
spherical harmonic expansion to degree and order N will be called a N
ﬁeld modeling and estimation problems will be referred to as ﬁeld reconstruction problems.

×

Next, consider the relevant geophysical aspects. Approximately a quarter of a century ago one could

divide the Earth’s gravity ﬁeld into three parts corresponding to their respective data sources:

(I) Global spherical harmonic ﬁeld data derived directly from satellite tracking data and historically con-
sidered accurate to around the degree and order 8 to 12 range. Here this part of the ﬁeld is called ‘low
12 and below.
degree and order” and it is taken to be 12

×

(II) An intermediate ﬁeld taken here to be the part above 12

12 and below 120

120, which before the

evolution of more advanced radar equipped satellites could not be accurately determined.

×

×

(III) Regional measurements of geophysical surface quantities known as gravity anomaly and vertical de-
ﬂections. [These data sets contain part (I) and (II) contributions unless they are factored out.]

Parts (I) and (II) together will be taken as comprising the global part of the gravity ﬁeld. As discussed
below, much higher accuracy is desirable for part (I) than part (II) or part (III) data. Currently very
accurate spherical harmonic expansions to a much higher degree and order are available on the Internet,
so the distinction between the above three data sets is not as distinct as it once was, but to understand
the context of the methods discussed in this section it is useful to keep this historical data partition in
mind.
360 are common and the recent Gravity Recovery and Climate Experiment
(GRACE) [9, 19] has already established new global gravity accuracy benchmarks up through 110

110.
}
Next consider the origins of part (III) data. Regional data measurements are often made at sea and it is
in this context that the concepts of gravity anomaly and vertical deﬂection components are best understood.

Expansions beyond 360

×

×

{

14

Suppose that the Earth were composed of a homogenous liquid with the same overall mass and volume, then
due to rotational eﬀects it would take on an ellipsoidal shape. Geophysicists set up a mathematical model of
this conﬁguration that they call the reference ellipsoid. The associated ﬁeld is called the normal gravity ﬁeld
and it is the predominant part of the ﬁeld. If transient eﬀects (like tides and ocean waves) are accounted
for, then under the inﬂuence of gravity the oceans form an equal-potential surface (otherwise water would
ﬂow from one part to another until an equilibrium was reestablished). If normal gravity is subtracted oﬀ
and if these transient eﬀects are properly taken into account then the measurement taken by a gravimeter
on a ship is called gravity anomaly, ∆g, and it is a scalar since the measurement is taken along a plumb
line. The angular displacement of this plumb line from the vertical is called vertical deﬂection, which can
be resolved into north-south and east-west components. Due to the equipotential eﬀect just noted, this
measurement is displaced from the speciﬁed reference ellipsoid by a distance that is called geoid height, but
the measurement is recorded as if it had been made at a point on the reference ellipsoid itself [9]. Geoid
height and scalar potential values are connected by Bruns formula [9]. Geoid height itself can be determined
by a radar equipped satellite that has a known location. Gravity anomaly is typically measured in units of
10−5m/s2. A 1 milligal error is considered more-or-less acceptable for regional
milligal, where 1 milligal = 1
gravity anomaly data processing [9, p. 274] and various underpinning geophysical relationships are derived
with an inherent approximation consistent with this 1 milligal requirement [8, 9]. Much higher accuracy is
desirable for part (I) than part (II) or part (III) data since gravitational eﬀects are cumulative for most uses
and low degree and order errors tend not to cancel out. GRACE and other modern ﬁelds have error levels
considerably under a milligal for part (I) data and for this part of the ﬁeld it is also desirable to have point
mass models with errors somewhat under a milligal.

×

Historically, there have been three primary motivations for performing NLLSQ ﬁts to the low degree and
order spherical harmonic part of the Earth’s gravity ﬁeld: (a) To ﬁnd a more eﬃcient computational scheme
for gravity evaluations. (b) To gain some insight into the distribution of matter in the Earth’s interior. (c)
To conduct goal oriented pure research. Due to the computational ease and speed of low degree and order
spherical harmonic gravity evaluations that has resulted from computer hardware and software advances,
(a) has long ceased to be a realistic reason for using point mass ﬁts and this point is totally irrelevant now.
Other measurement programs and advances have also emerged to address the issues raised by (b), but in fact
it was never clear that the small number of point masses used in NLLSQ ﬁts could provide truly signiﬁcant
mantle or deep core density information, which leaves only (c). NLLSQ point mass ﬁtting presents a very
challenging problem that can conceivably serve as a sort of test bed for developing techniques to tackle
other ill-conditioned problematic NLLSQ problems; moreover, aside from these NLLSQ aspects, it is an
intrinsically interesting potential theory problem that has associated cross-fertilization possibilities.

The ﬁrst step in attacking any LLSQ or NLLSQ problem is to set up a cost function. A commonly
chosen minimization philosophy for the NLLSQ point mass ﬁtting problem is that of matching the observed
quantities as closely as possible. Since there is a classical result in geophysics (Stokes’ integral) that says
that if gravity anomaly is known over the entire reference ellipsoid then the external ﬁeld quantities can be
reconstructed, standard approaches to performing global NLLSQ low degree and order point mass ﬁts often
have been based on matching gravity anomaly at Ni diﬀerent sample points, ~Xi, speciﬁed on the reference
surface. This technique will be called the “classical point mass” approach. If ∆gP M ( ~Xi) denotes the anomaly
generated by a collection of Nk point masses and ∆gref ( ~Xi) represents the truth anomaly value at the same
point, this classical NLLSQ point mass approach can be framed through the requirement that the following
cost function be minimized:

(33)

Φ =

∆gP M ( ~Xi)

∆gref ( ~Xi)

−

Ni

i=1
X

(cid:0)

2

,

(cid:1)

where Ni >> Nk. The usual prescribed number of point masses, Nk, is approximately 50 for a NLLSQ 9
ﬁt, while Nk ≈

9
12 ﬁt. The resulting gravity anomaly error standard deviations (sigma) achieved

80 for a 12

×

×

15

by applying this classical point mass ﬁtting approach has typically been from 3/4 to several milligals. These
approaches normally have a much more sizeable error in the smaller degree and order terms than is desirable.
The global NLLSQ point mass ﬁtting problem itself is inherently nonlinear and the point masses must
be quite deep to obtain good results, which heightens numerical diﬃculties and associated convergence
problems. Given this state of aﬀairs, coupled with the facts that the smaller degree and order errors cannot
be easily removed using this classical approach and that it contains inherent sampling and discretization
error, there is an error ﬂoor of around 2/3 milligal that these approaches historically have not been able to
overcome. While the associated regional LLSQ approaches that have been tried are remarkably diverse, far
fewer low degree and order NLLSQ approaches have been employed—nevertheless the diversity of attempted
NLLSQ point mass approaches in the literature is much wider than the above discussion indicates, but still
the accuracy levels and deﬁciencies of the classical point mass approach presented above are thought to be
representative of these other existing NLLSQ attempts as well. In Section 2 it was argued that the usual
philosophy of matching measured quantities is not the correct one and that an energy basis or weighted
energy basis is clearly called for in approaching both LLSQ and NLLSQ gravity modeling problems.

×

As noted above, accurate global NLLSQ low-degree and order spherical-harmonic point-mass ﬁts using
the DIDACKS approach were ﬁrst obtained almost a quarter of a century ago by the author and in the past
as better spherical harmonic data has became available more accurate ﬁts have been obtained [20]. This
has been an ongoing eﬀort and the current NLLSQ 50 point mass ﬁt to the 9
9 part of a recent ﬁeld has
a sigma error of about 0.035 milligal, while the corresponding error in an NLLSQ 80 point mass ﬁt to the
12
12 part of the ﬁeld is 0.030 milligal. As one might expect, additional masses here can oﬀer marked
improvements in accuracy, but at a loss of eﬃciency. Combined point mass/dipole ﬁts (c.f., Section 4),
which are combinations of point masses and dipoles at the same location, have also been performed over the
years [20]. Only about half as many of these combined point sources are required for an accurate NLLSQ
ﬁt: 22 for a 9
12 ﬁeld. These NLLSQ DIDACKS ﬁts have all been based on the
integral norm introduced in Section 4. Besides the basic DIDACKS formalism, these ﬁts also use additional
specialized NLLSQ techniques developed by the author to handle the existence of numerous false minima at
various physical scales.

9 ﬁeld and 35 for a 12

×

×

×

While the ﬁts should be doable, neither LLSQ nor NLLSQ DIDACKS ﬁts to the complete global inter-
mediate part of the ﬁeld [part (II)] have been attempted, although eﬃcient and accurate DIDACKS ﬁts for
various regional and local gravity modeling and estimation problems using both LLSQ and partial NLLSQ
implementations have been obtained by the author [20]. Regional point mass gravity ﬁeld reconstruction
[part (III)] based on the “classical point mass” approach epitomized by (33) has also often been successfully
done over the years by various researchers; however, some have reported disappointing results. This is not
surprising since considerable patience is also often required in order to obtain the best or even good results
with the DIDACKS approach due to source placement issues. Thus while both DIDACKS and the classical
point mass ﬁtting approach can be viewed as an alternative to GC for regional applications, they both clearly
share the same sensitivity to and dependence on point mass placement. This sensitivity to point mass place-
ment is also apparent from the low degree and order NLLSQ DIDACKS results since NLLSQ iterations have
obviously reduced the errors by several orders of magnitude over that of initial trial conﬁgurations. GC is
designed to not be as sensitive to the placement of the kernel measurement points (which is the corresponding
placement issue for it) and thus GC generally requires less patience and skill. Alternative part (II) and (III)
grid-based point mass approaches are referenced and discussed in [25].

It is thus useful to brieﬂy describe GC in order to compare and contrast it with the DIDACKS approach.
Unlike DIDACKS, GC theory generally assumes all available data is used. GC as commonly practiced diﬀers
from standard collocation techniques utilized by applied mathematicians in ﬁve basic ways:

1 A SRK basis is assumed and emphasis is primarily focused on a statistical (covariance) interpretation

given to these kernels.

16

2 Laplace’s equation in R3 is always assumed to hold over the region of interest.

3 This ﬁeld region is assumed to be either half-space or the exterior of a sphere (but the half-space setting

is used only occasionally for localized regional distributions, so it is not stressed).

4 The study of kernels is broken down into the standard empirically modeled statistical covariance kernels
and analytical collocation (where closed-form kernels are studied)—analytical collocation is generally
only used when the functional form of the kernel is understood to be a workable representation of the
statistical covariance function.

5 Field measurement errors are allowed.

Practitioners of GC have cataloged most, if not all, useful kernel possibilities allowed by these ﬁve diﬀerences.
The main interpretational basis of GC is the GC or minimum norm property previously mentioned in
connection with the GLLSQC condition in Section 2: Under the assumption of errorless measurements,
from all possible candidate functions that reproduce the given point measurements, GC selects the one that
is smoothest—that is the one with the smallest norm, where the norm is determined by the underlying
covariance function [18, pp. 207–220]. It this minimum norm property, in concert with the emphasis on
statistical covariance functions indicated by the ﬁrst point above, that makes GC approaches less sensitive
to kernel point placement issues; however, as indicated above this also implies a corresponding loss of ﬁtting
responsiveness and thus, for example, it would be hard to argue that GC is capable of the overall level of
economy and eﬃcency indicated above for the NLLSQ DIDACKS low degree and order tesseral ﬁts. Further
observe that just as in RKHS theory, GC also satisﬁes a least squares norm property [18], but in practice
this property is usually ignored by physical geodesists.

For LLSQ gravity reconstruction problems GC has historically been the ﬁrst procedure of choice and
for these problems one could argue that when good covariance data is available, these techniques are safe
and easy to use; however, as classically practiced GC techniques do have notable limitations, which are not
shared by the DIDACKS approach:

(A) NLLSQ applications cannot be treated.

(B) GC techniques are customarily applicable only to the Earth’s gravitational ﬁeld environment since they

require covariance information that is often only available in this context.

(C) The application of GC requires a certain level of familiarity and thus it is almost never adapted
to problems outside the geophysical realm, even when appropriate covariance data can be gathered.
(There are, however, various other areas that use somewhat related kernel techniques [21].)

(D) Inverse source estimation problems cannot be entertained.

In summary, for gravity reconstruction problems with accurate selected data sets where either approach
can be used, results using the DIDACKS approach can be both much better or much worse than one
might normally expect with GC approaches since the ingenuity, implementation skill and patience of the
practitioner have a much more signiﬁcant bearing on the outcome for DIDACKS approaches. GC is and
probably will always remain the primary mathematical tool employed for raw gravity data processing and
related uses where eﬃciency is not the primary concern, since its behavior in these arenas is well understood
and it can handle measurement errors naturally.

6 Mathematical Connections to Geophysical Collocation

As indicated in Section 1, (2a) can be related to a line of preexisting research performed by Krarup in
conjunction with his studies of GC [14]. Also an independent parallel line of point source research exists

17

that maintains direct connections to GC itself and can be considered a direct outgrowth of Krarup’s original
work. This alternative collocation based point source scheme is brieﬂy considered after the connections of
DIDACKS theory to Krarup’s work are addressed. Since this alternative scheme and Krarup’s work are
primarily based on GC for spherical exteriors, only this geometry will be considered in the sequel.

Krarup ﬁrst introduced the weighted integral occurring on the RHS of (32) in conjuction with his study

of GC [14, pp. 62–65]. The SRK corresponding to this norm (the “Krarup kernel,” KK ) has the form

(34)

KK ( ~P , ~Q) =

2 ~P

2
~Q + (P Q/R0)

,

R0

·

R2

0 −

q

−→

k and ~Q

~Q
. To understand how point
which Krarup and his followers extensively studied and applied. In (34) Q =
|
|
~X ′
~X ′
~Q
mass ﬁtting enters, observe that this SRK can be recast in the form R2
0/(P
|
|
|
since ~X ′ = ~P R2
0/P 2, which is proportional to a point mass potential at a ﬁxed location. Making the ansatz
~X ′
~X ′
~X allows one to transform a collocation ﬁt into a point mass ﬁt if the mass locations
are restricted to be at a ﬁxed depth r′
k is simply treated as an overall constant of
proportionality. The relevant history of this and related ideas is brieﬂy touched on below. Here one possible
next step, which Krarup and his followers did not apparently take since it entails abandoning symmetric
kernel forms altogether, is to generalize this procedure to independent variable depths by absorbing the factors
Pk := R2
k and R0 into each of the collocation ﬁtting parameters separately and then reinterpreting the
resulting collocation ﬁt as a point mass ﬁt, which yields a ﬁt based on (2a) as the end product.

= constant, where r′

), or
|

~X ′
k|
|

0/r′

~Q
|

k =

−→

~X ′

/
|

−

−

Conversely, DIDACKS point mass ﬁts based on the integral norm can be reinterpreted as collocation
ﬁts [20]. The resulting ﬁts are based on what is called the reciprocal distance covariance function [18, p.
182], which corresponds to R2
0/P Q times the Krarup kernel speciﬁed by (34). Notice that while the integral
norm can be reexpressed in terms of the “Krarup norm” by (32), it is useful to retain the integral norm as
a distinct entity speciﬁed by (20) since (a) it is a surface integral rather than a volume integral, (b) there
are some consequences of this form, such as (22), that are not apparent from the weighted Dirichlet integral
form itself and (c) the Krarup norm is associated exclusively with the Krarup kernel in SRK form and it is
primarily linked to GC theory where, as previously noted, the goals and practices are quite diﬀerent.

As summarized in [15] and as just indicated, starting in the early 1980’s a distinct line of point source
research based on Krarup’s original work above was developed by A. N. Marchenko and others [7]. This
research is based on maintaining connections to symmetric global GC covariance kernel forms. For the
spherical case, assuming the usual GC covariance properties, the general form of allowed global covariance
kernel, C( ~P , ~Q), can be written as:

(35)

C( ~P , ~Q) =

Pn(cos ψ) , where cos ψ = ( ~P

~Q/P Q) ,

·

n+1

∞

n=0
X

kn

R2
0
P Q

(cid:18)

(cid:19)

where the Pn are standard (un-normalized) Legendre polynomials and the kn are constants [18, p. 181].
Here, as before, R0 is the radius of the spherical region. Mathematically, a kernel speciﬁed by (35) can,
in general, be simply considered a SRK with an added layer of statistical interpretation. Solving (2b) for
~X ′ = ~X ′( ~P ) and substituting the result into (35) yields a kernel that is a function of one interior point and
one exterior point. For certain applications, when (35) is reexpressed in terms of a smaller radius RB < R0
the resulting sphere is known as a Bjerhammar sphere. For particular choices of kn if (35) can be rewritten
as a closed-form expression and if this expression has the correct form, such as (34), then the result can be
reexpressed as a point mass or other linear combinations of point or line source potentials. As just noted
in connection with (34), additional parameters will occur in the resulting expressions that do not appear in
the source potentials themselves, but if the locations of the sources are restricted these parameters can be

18

explained away as common constant factors. A Bjerhammar sphere is generally used since it allows for an
independent adjustment of the overall depth of the interior source points. By maintaining connections to
the symmetric kernel forms that are allowed by (35), a statistical covariance interpretation is possible.

As one might expect there are notable diﬀerences between this approach and DIDACKS since this al-
ternative approach adopts the basic philosophy of maintaining connections to GC and DIDACKS does not.
In particular for a speciﬁed domain, from RKHS theory one can deduce that the choice of inner product
(or norm) and reproducing kernel must be in one-to-one correspondence [18]; hence, the choice of multipole
form to be ﬁt and norm are directly linked. A list of known covariance kernel and multipole point source
correspondences for this approach can be found in [15]. For example, in [7] some of the consequences of
the Krarup norm choice, along with its half-space approximation, are examined for point mass ﬁts. By
employing (35) this approach allows for an underpinning statistical covariance interpretation, which is im-
portant for many geophysical applications; nevertheless, implicitly retaining symmetric kernel forms also
adds a layer of additional complexity, which has the eﬀect of greatly complicating the theory and of limiting
the possible choices of dipole and higher multipole forms. For uses outside geophysics there are also clearly
interpretational diﬃculties that limit its use.

In DIDACKS theory all attempts at retaining connections to SRKs are dropped and the primary empha-
sis is placed on the (weighted) energy or integral norm and the associated kernel form ℓ−1. As noted earlier,
this makes consideration of dipoles and higher multipoles trivial since the required inner products are readily
obtained. Moreover, since the DIDACKS approach maintains the same norm choice for all source types there
are few interpretational issues—especially with regards to multipole ﬁts of all orders. The types of geophys-
ical areas where one of these two approaches or GC should be preferred over the others clearly warrants
further study and consideration since, to date, there have been no researchers proﬁcient in applying all three
algorithms. (While GC has had many practitioners and this alternative collocation based approach has had
a few practitioners, so far DIDACKS development and use has been limited to the author’s involvement.)

References

[1] N. Aronszajn, Theory of Reproducing Kernels, Trns. Amer. Math. Soc., 68 (1950), pp. 337–404.

[2] A. El Badia and T. Ha-Duong, An inverse source problem in potential analysis, Inverse Problems,

16 (2000), pp. 651–663.

[3] Stefan Bergman and M. Schiffer, Kernel Functions and Elliptic Diﬀerential Equations in Math-

ematical Physics, Academic Press Inc., New York, N.Y., 1953.

[4] Richard J. Blakely, Potential Theory in Gravity & Magnetic Applications, Cambridge University

Press, New York, N.Y., 1996.

York, 1962.

[5] R. Courant and D. Hilbert, Methods of Mathematical Physics, Volume II, John Wiley & Sons, New

[6] Lars Garding, The Dirichlet Problem, Math. Intelligencer, 2 (1979), No. 1, pp. 42–52.

[7] Hermann Hauck and Dieter Lelgemann, Regional gravity ﬁeld approximation with buried masses

using least-norm collocation, Manuscripta Geodaetica, 10 (1985), pp. 50–58.

[8] Weikko A. Heiskanen and Helmut Moritz, Physical Geodesy, W. H. Freeman and Company, San

Francisco, 1967.

19

[9] Bernhard Hofmann-Wellenhof and Helmut Moritz, Physical Geodesy, First Edition, Springer-

Verlag New York, New York, 2005.

[10] John David Jackson, Classical Electrodynamics, Third Edition, John Wiley & Sons, Inc., New York,

1999.

[11] Philip Kearey, Michael Brooks and Ian Hill, An Introduction to Geophysical Exploration, Third

Edition, Blackwell Science Ltd., Malden, Ma., 2002.

[12] Oliver Dimon Kellogg, Foundations of Potential Theory, Dover Publications, New York, 1953.

[13] Granino A. Korn and Teresa M. Korn, Mathematical Handbook for Scientists and Engineers:
Deﬁnitions, Theorems, and Formulas for Reference and Review, Second Edition, Dover Publications,
New York, 2003.

[14] Torben Krarup, A Contribution to the Mathematical Foundation of Physical Geodesy, Publ. 44,

Danish Geod. Inst., Copenhagen, Denmark 1969.

[15] A. Marchenko and D. Lelgemann, A classiﬁcation of reproducing kernels according to their func-

tional and physical signiﬁcance, IGeS Bulletin, Milan, No. 8, (1998), pp. 49–52.

[16] L´aszl´o M´at´e, Hilbert Space Methods in Science and Engineering, Adam Hinger imprint by IO Pub-

lishing Ltd, Bristol, England, 1989.

[17] A. F. Mona, Dirichlet’s principle: a mathematical comedy of errors and its inﬂuence on the develop-

ment of analysis, Oosthoek, Scheltema & Holkema, Utrecht, 1975.

[18] Helmut Moritz, Advanced Physical Geodesy, Abacus Press, Tunbridge Wells, Kent, England, 1980.

[19] Christoph Reigber, Roland Schmidt, Frank Flechtner, Rolf K¨onig, Ulrich Meyer,
Karl-Hans Neumayer, Peter Schwintzer and Sheng Yuan Zhu, An Earth ﬁeld model com-
plete to degree and order 150 from GRACE: EIGEN-GRACE02S, Journal of Geodynamics, 39, (2005),
pp. 1–10.

[20] Alan E. Rufty, Point Mass, Dipole, and Quadrupole Gravity Modeling for FBM Systems Support,

Naval Surface Warefare Center Dahlgren Division Technical Digest 1997 Issue, pp. 100–108.

[21] Robert Schaback and Holger Wendland, Kernel Techniques: From Machine Learning to Mesh-

less Methods, Acta Numerica, 15 (2006), pp. 1–97.

[22] Norman H. Sleep, Kazuya Fujita and K. Fujita, Principles of Geophysics, Blackwell Science

Ltd., Malden, Ma., 1997.

[23] D. Stromeyer and L. Ballani, Uniqueness of the Inverse Gravimetric Problem for Point Mass

Models, Manuscripta Geodaetica, 9 (1984), pp. 125–136.

[24] W. M. Telford, L. P. Geldart and R. E. Sheriff, Applied Geophysics, Second Edition, Cambridge

University Press, New York, N.Y., 1990.

[25] Martin Vermeer, Mass point geopotential modelling using fast spectral techniques; historical overview,

toolbox description, numerical experiment, Manuscripta Geodaetica, 20 (1995), pp. 362–378.

[26] Howard L. Weinert (editor), Reproducing Kernel Hilbert Spaces Applications in Statistical Signal
Processing, Benchmark Papers in Electrical Engineering and computer Science / 25, Hutchinson Ross
Publishing Company, Stroudsburg, Pennsylvania, 1982.

20

