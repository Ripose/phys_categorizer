4
0
0
2
 
r
a

M
 
1
3
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
6
4
1
3
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Quantum Monte Carlo method for the ground state of many-boson systems

Wirawan Purwanto∗ and Shiwei Zhang†
Department of Physics, The College of William and Mary, Williamsburg, Virginia 23187
(Dated: February 2, 2008)

We formulate a quantum Monte Carlo (QMC) method for calculating the ground state of many-boson systems.
The method is based on a ﬁeld-theoretical approach, and is closely related to existing fermion auxiliary-ﬁeld
QMC methods which are applied in several ﬁelds of physics. The ground-state projection is implemented as a
branching random walk in the space of permanents consisting of identical single-particle orbitals. Any single-
particle basis can be used, and the method is in principle exact. We illustrate this method with a trapped atomic
boson gas, where the atoms interact via an attractive or repulsive contact two-body potential. We choose as the
single-particle basis a real-space grid. We compare with exact results in small systems, and arbitrarily-sized sys-
tems of untrapped bosons with attractive interactions in one dimension, where analytical solutions exist. We also
compare with the corresponding Gross-Pitaevskii (GP) mean-ﬁeld calculations for trapped atoms, and discuss
the close formal relation between our method and the GP approach. Our method provides a way to system-
atically improve upon GP while using the same framework, capturing interaction and correlation effects with
a stochastic, coherent ensemble of non-interacting solutions. We discuss various algorithmic issues, including
importance sampling and the back-propagation technique for computing observables, and illustrate them with
numerical studies. We show results for systems with up to N ∼ 400 bosons.

I.

INTRODUCTION

The study of many-body quantum systems has been a very
challenging research ﬁeld for many years. Computational
methods have often been the way of choice to extract theoreti-
cal understanding on such systems. Most computational quan-
tum mechanical studies are based on simpler mean-ﬁeld theo-
ries such as the Gross-Pitaevskii (GP) equation for bosons or
the Kohn-Sham density-functional theory (DFT) for fermions.
Despite their remarkable success, the treatment of particle
interaction or correlation effects is only approximate within
these approaches, and can lead to incorrect results, especially
as the strength of particle interactions is increased. It is there-
fore necessary to develop alternative computational methods
that can describe the effect of interaction more accurately and
reliably.

In this paper we present a quantum Monte Carlo (QMC)
method to study the ground state of many-boson systems.
The method is in principle exact. Our interest in the devel-
opment and use of this method was motivated by the real-
ization of the Bose-Einstein condensation in ultracold atomic
gases [1]. These are dilute gases consisting of interacting al-
kali atoms. The interaction among the atoms is well described
by a simple two-body potential, either attractive or repulsive,
based on the scattering length. For weakly-interacting sys-
tems the mean-ﬁeld GP approach has, as expected, performed
extremely well [2, 3]. More recently, Fesbach resonances [4]
have successfully been used as a powerful way to tune the
strength of the interaction experimentally. This provides a
source of rich physics, and increases the need for theoretical
methods which can benchmark GP and provide an alternative
where GP is inadequate.

Several QMC methods exist for calculating the properties

∗Electronic address: wirawan@camelot.physics.wm.edu
†Electronic address: shiwei@physics.wm.edu

of interacting many-body systems. The ground-state diffu-
sion Monte Carlo [5] and the ﬁnite-temperature path-integral
Monte Carlo (PIMC) [6] methods, which work in many-
particle conﬁguration space and in the ﬁrst-quantized frame-
work, have been successfully applied to a variety of boson and
fermion systems. In the context of atomic gases, Krauth [7],
Gruter et al. [8], and Holzmann and Krauth [9] have em-
ployed PIMC to study ﬁnite-temperature properties of trapped
bosons with positive scattering lengths, modeling the two-
body interactions by a hard-sphere potential. Glyde and co-
workers have studied the ground state of trapped bosons, also
by hard spheres [10, 11]. Ulmke and Scalletar [12] did ﬁnite-
temperature QMC calculations on quantum spin systems and
the Bose-Hubbard model. In the latter calculation, a hard-core
repulsive potential was assumed, which allowed a transforma-
tion of the problem into an XXZ spin-like problem that can be
treated with a fermion QMC method.

Our method is based on the auxiliary ﬁeld quantum Monte
Carlo (AFQMC) approach [13, 14]. The AFQMC is a ﬁeld-
theoretical method, where many-body propagators resulting
from two-body interactions are transformed, by use of auxil-
iary ﬁelds, into a many-dimensional integral over one-body
propagators
[15, 16]. The many-dimensional integral is
then computed using stochastic means. The AFQMC frame-
work is appealing for several reasons. Working in second-
quantization, it automatically imposes the proper particle-
permutation symmetry or antisymmetry. It provides a many-
body method with close formal relation to mean-ﬁeld ap-
proaches, as we discuss later. In addition, it allows convenient
calculation of the observables and correlation functions.

The AFQMC method has been widely employed to study
fermion systems in condensed matter [17, 18, 19], nuclear
physics [20, 21], and lattice gauge theory. In this paper, we
generalize the fermion ground-state auxiliary-ﬁeld quantum
Monte Carlo method [19, 22] to many-boson systems. We
project the many-body boson ground-state from an initial trial
state
is a permanent consisting of N
identical single-particle orbitals, which was ﬁrst suggested in

. Our choice of

ΨTi
|

ΨTi
|

a model calculation by Sugiyama and Koonin [14]. The many-
body ground state is projected from
with open-ended,
branching random walks to sample the auxiliary ﬁelds. We
formulate an importance sampling scheme, which greatly im-
proves the efﬁciency of the method and makes possible sim-
ulations of large systems. We also discuss in detail the back-
propagation technique which allows convenient calculation of
virtually any ground-state observables.

ΨTi
|

Our method retains all the advantages of AFQMC. It al-
lows the use of any single-particle basis, which in this paper
is chosen to be a real-space grid. As we discuss in Sec. VI, it
provides a means for true many-body calculations in a frame-
work which closely relates to the GP approach. The approach
can be viewed as a stochastic collection of parallel GP-like
calculations whose “coherent” linear combination gives the
interaction and correlation effects.

In this paper we present our QMC method for bosons and
discuss its behavior and characteristics. We use a trapped
atomic boson gas as our test system, where the atoms inter-
act via an attractive or repulsive contact two-body potential.
A sufﬁciently detailed description of the method is given to
facilitate implementation. Compared to its fermionic counter-
part, our method here is formally simpler. It therefore also
offers opportunities to study algorithmic issues. Because of
the intense interest in methods for treating correlated systems
(fermions or bosons) and the relatively early stage of this type
of QMC methods, a second purpose of the paper is to use
the bosonic test ground to explore, discuss, and illustrate the
generic features of ground-state QMC methods based on aux-
iliary ﬁelds. An example is the case of repulsive interactions,
where a phase problem appears in a bosonic system, which
provides a clean test ground to study methods for controlling
this problem [22], which is crucial for applications in fermion
systems. The majority of the applications in this paper will be
to systems where exact results are available for benchmark.
These include small systems, which can be diagonalized ex-
actly, and the case of untrapped bosons with attractive inter-
actions in one dimension, where analytical solutions exist. It
is worth emphasizing that the method scales gracefully (sim-
ilar to GP) and allows calculations for a large number (N )
of bosons. We will show results for larger systems (
1000
sites and hundreds of particles) in one- and three-dimensions
to illustrate this.

∼

Our paper is organized as follows.

In section II, we es-
tablish some conventions and review the basic ground-state
projection and auxiliary-ﬁeld quantum Monte Carlo method.
In section III, we introduce our new AFQMC implementa-
tion for bosons, including the formulation of an importance-
sampling scheme and the back-propagation technique for con-
venient calculation of virtually any ground-state observables.
In section IV, we describe the implementation of our method
to study the ground state of a trapped Bose atomic gas, which
we model by by a Bose-Hubbard Hamiltonian with an exter-
nal trapping potential. We also describe our implementation
of the GP approach to study the same Hamiltonian. In section
V, we present our computational results. We benchmark the
method in systems where exact results are available. We also
provide examples to illustrate the behavior and key charac-

2

teristics of our method. We carry out GP calculations on the
same Hamiltonian and compare the results with those from
our QMC calculations. In section VI we comment on some
characteristics of the method, further discuss its relation to
and differences from GP, and mention future directions and
some immediate applications of this method. Some comput-
ing issues will also be discussed. Finally, in the appendices
we provide additional technical details of the method.

II. BACKGROUND

A. Many-body Hamiltonian

We use the second quantized formalism throughout this pa-
per. We assume that an appropriate set of single-particle basis
has been chosen, in terms of which the wave func-
χii}
{|
tions will be expanded. For simplicity, we assume that the
single-particle basis is orthonormal, although this is not re-
quired. The number of basis states is M . The operators c†i and
ci, respectively, are the usual creation and annihilation oper-
ator for the state
. They satisfy the commutation relation
= δij. This automatically imposes the symmetriza-
[ci, c†j]
tion requirement of the many-body wave functions.

χii
|

−

We limit our discussion to a quantum-mechanical, many-
body system with two-body interactions. The Hamiltonian ˆH
has a general form of

ˆH = ˆK + ˆV ,

(1)

where ˆK is the sum total of all the one-body operators (the
kinetic energy and external potential energy),

and ˆV contains the two-body interactions:

ˆK =

Kijc†i cj ;

ij
X

ˆV =

Vijklc†i c†jckcl .

Xijkl

Our objective is to calculate the ground state properties of
such a system, which contains a ﬁxed number of particles,
N .

B. Ground state projection

The ground state wave function

tracted from a given trial solution
projection operator

can be readily ex-
Φ0i
|
using the ground-state
ΨTi
|

∆τ ˆHe∆τ ET ,

e−

Pgs ≡

(2)

where ET is the best guess of the ground-state energy, pro-
. Applying the oper-
vided that
would
ator
ΨTi
|

is not orthogonal to
Pgs repeatedly to the initial wave function

ΨTi
|

Φ0i
|

3

(6)

(7)

(8)

exponentially attenuate the excited-state components of the
initial wave function, leaving only the ground state:

where ˆv is a one-body operator:

;
.

Φ0i
Φ0i

n
Pgs)n
ΨTi
(
→∞
|
−→ |
Φ0i −→ |
Pgs|
Because of its resemblance to the real-time propagator, the
Pgs is also called the imaginary-time propagator. In
operator
ground-state QMC methods,
Pgs is evaluated by means of a
Monte Carlo sampling, resulting in a stochastic representation
of the ground-state wave function.

(3a)
(3b)

C. Basic auxiliary-ﬁeld method

Two essential ingredients are needed in order to evaluate
Pgs within a reasonable computing time. The ﬁrst is the
Trotter-Suzuki approximation [23, 24]. The propagator is
broken up into a product of exponential operators, which be-
0. The second-order form of
comes exact in the limit ∆τ
this approximation is

→

∆τ ( ˆK+ ˆV ) = e−

e−

∆τ ˆV e−

1

2 ∆τ ˆK

1

2 ∆τ ˆKe−
(∆τ 3) .

+

O

(4)

The second ingredient is the Hubbard-Stratonovich (HS)
transformation [15, 16], which allows us to reduce the two-
body propagator to a multidimensional integral involving only
one-body operators, using the following identity: [25]

1

2 ∆τ ˆv2

e

=

∞

dx e−

1

2 x2

ex√∆τ ˆv ,

(5)

1
√2π

Z

−∞

The hermiticity of ˆV allows us to decompose it into a sum
of the square of one-body operators
(see, for example,
Refs. 19 and 25):

ˆvi}

{

ˆvij c†i cj .

ˆv

≡

ij
X

ˆV =

1
2

−

ˆv2
i ,

i
X

Because of
this, we can always apply the Hubbard-
Stratonovich transformation on a general two-body potential
operator:

∆τ ˆV =

e−

1

2 ∆τ ˆv2

i +

e

(∆τ 2)

i
Y

=

∞

dxi

i Z

Y

−∞

O

1

2 x2

i

e−
√2π

exi√∆τ ˆvi +

(∆τ 2) .

O

In general, the Trotter breakup incurs an additional systematic
error of

(∆τ 2).

O

Applying these two procedures, we obtain an approximate

expression of the ground-state projection operator:

Pgs = e∆τ ET

·

1

2 ∆τ ˆK

e−

∞

dxi p(xi)exi√∆τ ˆvi

e−

1

2 ∆τ ˆK +

(∆τ 2) ,

)

O

(

i Z
Y

−∞

1

where p(x) is the normalized Gaussian probability density
2 x2
.
function with unit standard deviation: p(x)
This approach is applicable to both boson and fermion sys-
tems.
It enables us to compute the exact ground state of a
quantum many-body system. To reduce the systematic er-
ror from the ﬁnite timestep ∆τ , the so-called “Trotter er-
ror”, small timesteps ∆τ are necessary. Often, calculations
are performed for several ∆τ values, then an extrapolation to
∆τ

0 is made to remove the Trotter error.

1
√2π

e−

≡

For convenience we deﬁne the following notations:

•

•

ˆBv(~x) : a product of the exponential one-body op-
erators arising from the auxiliary-ﬁeld transformation.
From Eq. (8), ˆBv(~x)

i exi√∆τ ˆvi .

≡

Q

ˆB(~x) :
the product of ˆBv(~x) with all other one-body
exponential operators that do not depend on the aux-
iliary ﬁelds ~x, and all the necessary scalar prefac-
tors. For the projector in Eq. (8), ˆB(~x)
2 ∆τ ˆK .
e−

2 ∆τ ˆK ˆBv(~x) e−

e∆τ ET

≡

·

1

1

~x
≡ {
ﬁelds.

x1, x2, . . .
}

: the collection of all the auxiliary-

With these notations,
dimensional integral operator:

Pgs takes a generic form of a high-

≡

i p(xi) : a (normalized) multidimensional
p(~x)
probability density function, which is the product of the
one-dimensional probability density functions p(xi).

Q

d~x p(~x) ˆB(~x) .

(9)

Pgs ≈

Z

→

•

•

4

(12)

(13)

D. Wave function representation

We write our wave functions in terms of the basis functions
χii
|

. A single-particle wave function is written as

=

ϕ
i
|

ϕi|

χii

=

0
ϕic†i |

i ≡

ˆϕ†

.

0
|

i

(10)

i
X

i
X

A single-permanent, N -Bosons wave function is given by

φ
i
|

= ˆφ†1

ˆφ†2 . . . ˆφ†N |
0

i

.

(11)

In general, the exact ground state wave function is a superpo-
sition of such permanents. Unlike the fermionic case, where
the particles occupy mutually orthogonal orbitals, there is no
such restriction on the orbitals here. We use this freedom in
our method to have all the bosons occupy the same orbital in
, which greatly simpliﬁes the computation [14]. We will re-
φ
|
i
fer to this as identical orbital representation (IOR). The most

important virtue of this representation is that the exponen-
tial of a one-body operator ˆA transform a single-permanent
into another single-permanent wave func-
wave function
: [26]
tion
φ′
i
|

φ
i
|

ˆA

e

φ
i
|

=

.

φ′
|

i

into another single permanent

In particular, ˆB(~x) in Eq. (12) transforms a single permanent
. (In Appendix A we
φ
|
i
i
include a brief summary of properties of wave functions in
IOR.)

φ′
|

E. Metropolis AFQMC

Standard AFQMC calculations [14] employ Metropolis

Monte Carlo to compute various ground-state observables,

ˆA
ig.s. = h
h

ΨTi

D

ΨT|Pgs · · · Pgs ˆA
Pgs · · · Pgs|
ΨTi
ΨT|Pgs · · · Pgs|
h
~xm, ~yn}
~xm, ~yn}
) P (
(
)
{
{
~xm, ~yn}
) P (
~xm, ~yn}
(
{
{
)
~xm, ~yn}
) P (
~xm, ~yn}
(
{
{
~xm, ~yn}
(
{

R
D

D

D

=

R

=

R

R

m

m

ˆB(~xm) ˆA
ˆB(~xm)

ˆB(~yn)
ΨTi
ΨT|
n
|
h
ˆB(~yn)
ΨTi
ΨT|
)
Q
Q
n
|
h
ˆA
~xm}
~yn}
φ(
)
η(
Q
Q
)
~xm}
η(
~yn}
φ(
)
{
|
{
|
h
)
~yn}
φ(
)
~xm}
η(
i
{
{
h
|
{
h
i
{
|
)
~yn}
φ(
)
~xm}
η(
~xm, ~yn}
) P (
i
{
|
{
h
{

)

)
i

,

where

~xm, ~yn}
(
{
D
~xm, ~yn}
P (
{

)
)

≡
≡

m d~xm
m p(~xm)
Q

n d~yn ,

n p(~yn) ,

Q
Q

and in the last line we have introduced the shorthand

Q

)
| ≡ h

~xn}
η(
{
h
)
~ym}
φ(
i ≡
{
|

ΨT|

m

ˆB(~xn) ;
n
ˆB(~ym)
.
ΨTi
Q
|

Q
The Metropolis simulation is carried out by sampling the
probability density function deﬁned by the integrand in the
denominator. Given the choice of ΨT in the identical-orbital
representation, this readily applies to bosons, which is how the
model calculation by Sugiyama and Koonin [14] was done.
The total length of the imaginary time is predetermined by
∆τ and the number of ˆB operators in the product.

III. NEW METHOD FOR BOSONS

are several advantages in implementing the Monte Carlo sam-
pling as a random walk process. It is a true ground-state for-
malisms with open-ended random walks which allow projec-
tion to long enough imaginary-times. The sampling process
can be made much more efﬁcient than in standard AFQMC,
by virtue of importance sampling with ΨT to guide the ran-
dom walks. It also leads to a universal approach for bosons
and fermions, where it is necessary to use the random walk
formalism in order to implement a constraint to deal with the
sign and complex-phase problems [19, 22].

≡

A key observation is that we can choose an IOR single-
permanent wave function as the initial wave function
.
ΨTi
|
At each imaginary timestep τ
n ∆τ in the projection in
Eq. (3), the wave function is stochastically sampled by a col-
, where
lection of single-permanent wave functions
the index i (in Cursive letter) is different from the basis in-
dex i. From Eqs. (9) and (12), we see that, with each walker
φ(0)
in IOR, the resulting projection will
ΨTi
i i
|
|
lead to a superposition of single-permanent wave functions,
all of which are in IOR.

initialized to

φ(τ )
i

i}

{|

In this paper we formulate a new approach for ground-state
calculations of bosons with branching random walks. There

Each permanent evolves by the stochastic application of
Pgs, as follows: we randomly sample ~x from the probability

density function p(~x), then apply ˆB(~x) on

φ(τ )
i
|

:
i

φ(τ +∆τ )
i
|

i ←

φ(τ )
ˆB(~x)
i
|

i

,

(14)

We will call these permanents random walkers. The collection
of these random walkers at each imaginary-time step is also
referred to as population.

The population must ﬁrst be equilibrated so that the ground-
state distribution is reached. After equilibrium the ground
state is given stochastically by the collection of single-
permanent wave functions
φi

:

i}

{|
.
=

Φ0i
|

.

φi
|

i

(15)

i
X
Measurement of ground-state observables can then be carried
out.

The random walk process naturally causes the walker’s or-
bitals to ﬂuctuate. In order to increase sampling efﬁciency,
we may associate a weight factor wi to each walker
. For
i
example, we can use the walker’s amplitude as the weight fac-
tor:

φi
|

.

i

≡

wi

φi
|

φi
h
p
A better deﬁnition of the weight will be introduced later when
we discuss importance sampling. We duplicate a walker when
its weight exceeds a preset threshold. Conversely, walkers
with small weight (lower than a predetermined limit) should
be removed with the corresponding probability. In this way,
the walkers will have roughly the same weight. This results in
a branching random walk.

A. Measurement: “brute force” and mixed estimators

The ground-state value of an observable ˆA is its expectation

value with the ground-state wave function:

ˆA
g.s. = h
h
i

ˆA
Φ0|
Φ0i
|
Φ0i
Φ0|
h
In principle, we can use the same Monte Carlo samples as both
. A “brute force” measurement on population
Φ0|
h
φ(τ )
i
{|

Φ0i
|
at imaginary-time τ is then given by

(16)

and

i}

.

(17)

φ(τ )
φ(τ )
ˆA
j
i
|
|
φ(τ )
φ(τ )
i
j
|

ijh
ijh

i

(τ )
ˆA
bf ≡ P
h
i
P

i
ˆA
ibf is the average of such measurements.
and the estimator
h
The “brute force” estimator is not useful in real-space based
QMC methods such as diffusion Monte Carlo, because the
overlaps between different walkers would lead to δ-functions.
Here the walkers are non-orthogonal mean-ﬁeld wave func-
tions, and Eq. (17) is well deﬁned in principle. The estima-
tor is exact for all observables in the limit of large Nwlkr.
The ground-state energy estimated in this way is variational,
namely, the computed energy lies higher than the exact value

5

(19)

(20)

(outside of the statistical errorbar) and converges to the exact
value as Nwlkr is increased.
In practice, however, the use-
fulness of the ‘brute force” estimator is limited to smaller
In general it will have large variances. Reducing
systems.
ˆA
the variance is expensive because
wlkr),
ibf scales as
h
where Nwlkr is the size of the population used to represent
.
Φ0i
|
The simplest approach to measuring the observables is the
mixed estimator, i.e.

(N 2

O

ˆA
Φ0i
ψT|
|
Φ0i
ψT|
h
For example, to compute the ground-state energy, we can in-
troduce the so-called local energy EL[ψT, φ]:

ˆA
imix = h
h

(18)

.

EL[ψT, φ] = h

ˆH
ψT|
φ
|
i
φ
ψT|
i
h

The ground state energy is obtained from the weighted sum of
the local energies associated with each walker:

Emix =

φi
EL[ψT, φi]
ψT|
ih
i
ψT|
ih

φi

i

P

The local energy for each walker can be computed using the
P
formula given in Appendix A.

The mixed estimator in Eq. (18) is exact only if the operator
ˆA commutes with the Hamiltonian. Otherwise, a systematic
error arises. Nonetheless the mixed estimator often gives an
improvement over the purely variational estimator:

ˆA
ΨTi
ΨT|
|
h
ΨTi
ΨT|
h
Two formulas are often employed to correct for the systematic
error:

iT ≡

ˆA
h

(21)

.

.

2

≡

≡

(22)

ˆA
iT ;

imix − h
2
mix

ˆA
extrap1
h
i
ˆA
extrap2
i
h

ˆA
h
ˆA
i
h
ˆA
iT
h
The second formula is useful for quantities such as density
proﬁle, where it must be nonnegative everywhere. These cor-
rections are good only if
does not differ signiﬁcantly
ΨTi
|
from
. In general, we need the back-propagation scheme
to recover the correct ground-state properties. We will de-
scribe this method after introducing importance sampling.

Φ0i
|

(23)

B.

Importance sampling

In practice, the efﬁciency of the bare random walk de-
scribed earlier is very low, because the random walks “ran-
domly” sample the Hilbert space, and the weights of the walk-
ers ﬂuctuate greatly. This results in large statistical noise. We
formulate an importance sampling procedure [19, 22]—using
the information provided by the trial wave function
—
to guide the random walk into the region where the expected
contribution to the wave function is large.

ΨTi
|

1.

Importance-sampled random walkers

that the walkers propagate in the following manner:

An importance-sampled walker also consists of a perma-
nent and a weight, although the weight will be redeﬁned ac-
cording to the projected overlap of the permanent with the
trial wave function. The purpose is to deﬁne a random walk
process which will lead to a stochastic representation of the
ground-state wave function in the form

.
=

Φ0i
|

wi

φi
|
ΨT|
h

i
φi

i

,

i
X

(24)

ΨTi
|

where wi is the new weight of the walker. The overlap enters
to redeﬁne the weight factor such that walkers which have
will be considered “important” and
large overlap with
will tend to be sampled more. Such walkers will also have
greater contributions in the measured observables. Since the
permanent now appears as a ratio
, its normal-
i
ization is no longer relevant and can be discarded, unlike in
the unguided random walk. The only meaningful information
in

is its position in the permanent space.

ΨT|
h

φi
|

φi

/

i

φi
|

i

2. Modiﬁed auxiliary-ﬁeld transformation

Now we describe the random walk process for the modiﬁed
Pgs in Eq. (9) such that the
walkers. The goal is to modify
random walk process leads to random walkers with the char-
acteristics described above in Eq. (24). The basic idea is the
same as that in Ref. 19. The main difference is that here we
are dealing with bosons. In addition the HS ﬁelds in Ref. 19
are discrete Ising-like, which allowed simpliﬁcations in the
importance sampling, while here the auxiliary ﬁelds are con-
tinuous and thus a more general formalism will be developed.
Our mathematical derivation here follows that of Ref. 22. Up
is real and positive.
to now we have assumed that
There is therefore no additional subtlety with the meaning of
importance sampling and the correct form of the overlap to
use, which Ref. 22 addressed in the context of fermionic cal-
culations with general interactions.

ΨT|
h

φi

i

To derive the importance-sampled propagator, we plug
Eq. (24) into Eq. (3b). We will focus on the two-body prop-
agator, which is evaluated stochastically and is therefore af-
fected by importance sampling in a non-trivial way.

The modiﬁed propagator,

Pgs, consists of two parts. The
ﬁrst part is the transformation introduced in Eq. (5), which we
now rewrite in the following form:
e

1

2 ∆τ ˆv2

e

=

∞

dx e−

1

2 x2

exx

−

1

2 x2

e√∆τ (x

x)ˆv ,

−

(25)

1
√2π

Z

−∞

where we have added an arbitrary shift x to the auxiliary ﬁeld
x in the auxiliary-ﬁeld operator. This is a change of variable
in the integral on the right-hand side and does not alter the
result of the integral. The new propagator
Pgs must preserve
in the form of Eq. (24); this dictates
the representation of
e

Φ0i
|

6

i

.

←−

(26)

w(τ )
i

w(τ +∆τ )

i
comes

φ(τ +∆τ )
φ(τ )
i
i
i
|
i
|
φ(τ )
φ(τ +∆τ )
ΨT|
ΨT|
i
i
h
h
of
From this
the
requirement
the overlap ratio
the modiﬁed propagator, which is
φ(τ )
φ(τ +∆τ )
This factor is obtained by
.
ΨT|
/
ΨT|
i
i
i
h
h
φ(τ +∆τ )
in Eq. (26) to the right-hand
bringing the term
ΨT|
i
h
side. It depends on
and the speciﬁc path in auxiliary-
ΨTi
|
ﬁeld space, and will “guide” the random-walk toward the
is large.
region where

i
second

part

i

i

φi

Combining the two parts gives an importance-sampled

ΨT|
h

i

propagator of the form

Pgs[φ]
e

≈

Z

where

d~x p(~x)W (~x, φ) ˆB(~x

~x) ,

(27)

−

i

i

−

≡

~x
·

~x
·

1
2 ~x

e~x

(28)

~x)
φ
|

W (~x, φ)

ΨT|
h

ˆB(~x
−
φ
ΨT|
h
is the aggregate of all the scalar prefactors in the modi-
w(τ )
φ(τ )
ﬁed propagator. This propagator takes
and
,
i
i
|
{
i}
φ(τ +∆τ )
advances the population to
, both of
,
i
i}
|
which represent
Pgs is similar
to the one without importance samping. We sample ~x from a
normal Gaussian distribution, and apply the operator ˆB(~x
~x)
e
. But now we accumulate an extra
to the current walker
i
multiplicative weight factor W (~x, φ(τ )
) every time we apply
Eq. (27):

w(τ +∆τ )
i
in the form of Eq. (24).

Monte Carlo sampling of the new propagator

φ(τ )
i
|

Φ0i
|

−

{

i

φ(τ +∆τ )
i
|
w(τ +∆τ )

i

i ←

←

φ(τ )
ˆB(~x
~x)
i
−
|
i
) w(τ )
W (~x, φ(τ )
i

i

.

(29a)

(29b)

~x

Here we use the customary notation of vector dot product, e.g.
) de-
~x
pends on both the current
walker
positions.

i xixi. Note that the weight factor W (~x, φ(τ )

φ(τ +∆τ )
i

and future

φ(τ )
i

P

≡

·

i

(cid:0)

(cid:1)

(cid:0)

(cid:1)

3. The optimal choice for auxiliary-ﬁeld shift ~x

The optimal importance sampling is achieved when each
random walker contributes equally to the estimator. We there-
fore choose ~x to minimize the ﬂuctuation in the weight factor
wi. The ﬂuctuation in wi will be minimized if we minimize
the ﬂuctuation in the prefactor Eq. (28). We do so by requiring
the partial derivatives of this prefactor to vanish with respect
to xi at its average (xi = 0):

ΨT|
h

∂
∂xi "

~x)

φi
|

i

ˆB(~x
−
φi
ΨT|
h

i

×

e~x

~x
·

−

1
2 ~x

~x
·

= 0 .

xi=0

#(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

→

It is sufﬁcient to expand the exponentials in terms of ∆τ and
require the term linear in xi to vanish, since this is the leading
term, containing √∆τ . The others contain higher-order terms
and are vanishingly small as ∆τ
0. The best choice for xi
that satisﬁes this requirement is
ˆvi|
ΨT|
φi
ΨT|
h
This choice depends on the current walker position as well
as
, which is to be expected, since the objective for the
ΨTi
|
shift is to guide the random walk toward the region where
φ(τ )
is large. With ~x determined, the algorithm for the
ΨT|
i
h
random walk, as given in Eq. (29), is now completely speci-
ﬁed.

√∆τ ¯vi .

√∆τ h

xi =

≡ −

(30)

φi

−

i

i

i

4. Local energy approximation

We can furthermore approximate the prefactor W (~x, φ) in
Eq. (28) to obtain a more elegant and compact expression.
After rewriting the prefactor in the form of an exponential,
expanding ˆB(~x
~x) in terms of ∆τ , and ignoring terms higher
than

(∆τ ) in the exponent, we obtain

−

1
2 ∆τ (1

e

−

x2

i )(¯v2
i

v2
i )e

−

1
2 ∆τ v2

i ,

(31)

O

where

i
Y

.

i

i

φi

(32)

v2
i ≡

ˆv2
ΨT|
i |
h
φi
ΨT|
h
The product is over the basis index i, which should be dis-
tinguished from the walker index i. The latter is held ﬁxed
here. The ﬁrst exponential in Eq. (31) can be ignored by not-
ing that the average value of x2
i with respect to the Gaussian
probability density function is unity. Setting x2
1, i.e.,
i →
x2
evaluating the exponential at the mean value
, is justi-
i i
h
ﬁed because ¯v2
i do not change drastically within one
ˆV
i v2
,
timestep. We also note that
ΨT|
i
which is the mixed-estimator of the potential energy with re-
spect to the walker
. Combining this term with the similar
i
contribution from the kinetic propagator, we obtain a simple,
approximate expression for Eq. (28):
W (~x, φ(τ )

EL[ΨT,φi]) ,

i and v2

e∆τ (ET−

ΨT|
h

φi
|

φi
|

i =

(33)

/
i

−h

P

φi

)

i

≈

where EL[ΨT, φi] is the local energy of φi as deﬁned in
Eq. (19). Note that, contrary to Eq. (28), this form depends
only on the current walker position and not the future, al-
though in practice a symmetrized version can be used which
replaces the local energy by the average of the two. For a
good trial wave function, the local energy ﬂuctuates less in the
random walk. If the trial wave function is the exact ground-
state wave function, the local energy becomes a constant and
the weight ﬂuctuation is altogether eliminated. This bears a
close formal resemblance to the importance-sampled difus-
sion Monte Carlo method.

The algorithm resulting from Eq. (33) is an alternative to
0,

Eq. (28). The two are identical and exact in the limit ∆τ
but can have different Trotter errors.

→

7

(34)

C. Measurement: back propagation

With importance sampling, the mixed estimator in Eq. (18)

is given by:

ˆA
imix = X
h

i

wi h

i

ˆA
ΨT|
φi
|
φi
ΨT|
h
wi

i

.

i
X

Emix =

i wiEL[ψT, φi]
i wi

.

P

For example, the ground-state energy is

As mentioned earlier, the normalization of φi is irrelevant be-
cause φi only appears in ratios in any formula that deﬁnes the
algorithm: Eqs. (24), (28), (30), (33), and Eq. (34). We can
(and should) normalize the permanent as needed, and discard
the resulting normalization factor.

P

The mixed estimator is often inadequte for computing ob-
servables whose operators do not commute with the Hamilto-
nian. In some cases the error due to this noncommutation is
unacceptable. For example, the condensate fraction in the at-
tractive trapped Bose-Hubbard model is greater than 100% if
the Green’s function
is estimated using the mixed esti-
c†i cji
h
mator. Therefore we have to propagate the wave functions on
both the right- and the left-hand side of the operator:

.

τbp

τbp

τbp

e−

e−

and

(35)

Φ0i
|

ˆH ˆA
Φ0i
|
ˆH
Φ0i
|

0 | ≡ h
Φ0i
|

ˆH , while avoiding the N 2

ΨT|
e−
ˆA
ibp = h
h
ΨT|
h
This estimator approaches the exact expectation value in
Eq. (16) as τbp is increased. Zhang and co-workers proposed
a back-propagation technique [19] that reuses the auxiliary-
ﬁeld “paths” from different segments of the simulation to ob-
Φbp
tain
wlkr scaling
ΨT|
h
of a brute-force evaluation with two separate populations for
. Here we give a more formal derivation and
Φ0|
h
description of the technique, and implement it to bosons.
At imaginary-time τ , the population is

τ + τbp, which consists of nbp ≡

, which rep-
resents
in the form of Eq. (24). The propagator in the
denominator can be viewed equivalently as operating on the
left or the right. The latter view is precisely the “normal”
importance-sampled random walk from τ to the future time
τbp/∆τ steps.
τ ′
We ﬁrst assume that there is no branching (birth/death of
walkers), i.e., the weights are fully multiplied according to
Eq. (28). The random walk of each walker will generate a
path in auxiliary-ﬁeld space. For convenience we will denote
the path-dependent operator ˆB[~x(τ )
, and
i −
) by W (τ )
weight factor W (~x(τ )
. Further we will denote
i
the time-ordered product of ˆB(τ )
from imaginary-time τ to
τ ′ by ˆB(τ
by
i
:τ )
W (τ
. Each path deﬁnes a product
i

, and correspondingly the product of W (τ )

)] by ˆB(τ )

~x(φ(τ )
i

, φ(τ )
i

φ(τ )
i

i}

{|

≡

:τ )

i

i

i

i

′

′

1
φ(τ ′)
ΨT|
h

i

i

W (τ
i

′

:τ )

ˆB(τ
i

′

:τ )

ΨT|
h

φ(τ )
i

.

i

(36)

ˆH .

τbp
Replacing the operator e−

Collectively these products give a stochastic representation of
e−

ˆH in the numerator and de-
τbp
nominator of Eq. (35) with Eq. (36), and using the expression
for

given by Eq. (24), we obtain

Φ0i
|

ˆA
ibp =
h

P

i h

ΨT|
ΨT|

h

i h

)

i

1
φ(τ ′
ΨT|
i
1
φ(τ ′
ΨT|

h

i

)

i

′

′

:τ )

:τ )

W (τ
i
W (τ ′:τ )

ˆB(τ
i
ˆB(τ ′:τ )

i

i

ˆA w(τ )
i

w(τ )
i

φ(τ )
i
|
φ(τ )
i
|

i

.

i
(37)

P

Using the propagation relation in Eq. (29), we can show that

′

:τ )

ˆB(τ

i W (τ

i

′

:τ )

w(τ )
i

φ(τ )
i
|

i

= w(τ
i

′

)

φ(τ
i
|

(38)

′

)

,

i
i w(τ

′

)

. This
i.e., the denominator in Eq. (37) reduces to
result is to be expected, and can also be seen by completing the
nbp steps of the “normal” random walk we discussed above.
With importance sampling, the Monte Carlo estimate of the
denominator is simply given by the weights at time τ ′.

P

i

To simplify the numerator we associate a back-propagated

wave function with each walker

φ(τ )
i
|

i

(τbp)
η
i
|

i ≡

(τ +τbp : τ )
ˆB
i
h

i

†

ΨTi
|

.

(39)

Note that each of these η’s originates from the trial wave func-
, and is propagated by applying the ˆB’s in reverse
tion
order, as implied by the Hermitian conjugation. We may then
write Eq. (37) in the following form:

ΨTi
|

′

)

w(τ
i

(τbp)
η
i
h

φ(τ )
ˆA
i
|
|
(τbp)
φ(τ )
η
i
i
|
h
w(τ
i

i

)

′

i

.

i

ˆA
ibp = X
h

(40)

η
h

’s and
φ
i
|

i
X
The estimators in Eqs. (35) and (40) parallel that of the stan-
dard AFQMC estimator in Eq. (13). The
’s have
|
similar meanings. The only difference lies in how the paths
are generated. Here an open-ended random walk is used to ad-
vance an ensemble of paths from τ to τ ′, which result in ﬂuc-
tuating weights that represent the path distribution. In stan-
dard AFQMC a ﬁxed length path (corresponding to τbp + τeq,
with τeq being the minimum time for equilibriation or, failing
that, the maximum time that can be managed by the calcula-
tion) is moved about by the Metropolis algorithm, which elim-
inates branching by the acceptance/rejection step.
In other
words, the estimators in Eq. (13) and Eq. (40) are the same
except for the weights.

Eq. (40) deﬁnes an algorithm for obtaining the estimate of
ˆA
ibp via the following steps:
h
1. A population is recorded as

;

φ(τ )
i

{|

i}

2. as the random walk continues, the path history is kept

for a time interval τbp;

8

3. the population

is then generated by back-

propagation using Eq. (39);

(τbp)
η
i
{|

i}

4. this population is matched in a one-to-one manner to
, weighted by the weight at the later time,

φ(τ )
i
{|
′
)
w(τ
i

i}
, and the estimator is formed.

i

In the back-propagation the propagators are, as shown in
Eq. (39), idential to those in the forward direction, but in re-
verse order in imaginary-time. As in the normal walk, the nor-
does not enter in the estimator. Similar
malization of
to the mixed estimator, this procedure can be repeated period-
ically to improve statistics. Evidently this estimator is exact
in the limit of large τbp.

(τbp)
η
i
|

We have assumed that there is no branching within the in-
terval τbp. In practice, a population control scheme is often
used which causes birth/death of walkers. This does not affect
the derivation above or the basic algorithm. The effect on the
implementation is that a list of ancestry links must be kept for
the forward steps, which indicates the parent of each walker
at each step in the imaginary-time duration τbp. As a result of
’s may share the same segment of
branching, two or more
|
the paths in their “past” and the same parent
. The esti-
i
mator remains exact for large τbp. Branching or weight ﬂuctu-
ation does have a more serious practical implication, however.
As τbp is increased, more and more
’s will be traced back
|
φ(τ )
to the same parent
. Or equivalently, fewer and fewer
i
|
i
φ(τ )
will contribute to the estimator.
permanents in the set
i
This results in a loss of efﬁciency or an increase in variance.
Better importance sampling will help improve the situation,
often greatly, by reducing ﬂuctuations in weights, although
the problem will always occur at large enough τbp. In our ap-
plications to date we have rarely encountered the problem and
ﬁnd that the computed observables converge quite rapidly (see
section V for illustrative results).

φ(τ )
i
|

η
h

η
h

i}

{|

IV. TRAPPED BOSON GAS: MODEL AND
IMPLEMENTATIONS OF QMC AND GP METHODS

In this section we discuss the model we use to describe
a single-species, Bose atomic gas with pair-wise contact
interaction, conﬁned in a harmonic trap in one- or three-
dimensions. We then describe the implementations of both
our QMC method and the standard mean-ﬁeld GP approach
to study this model. Numerical results will be presented in the
following section, Sec. V.

A. Model

We use an effective potential characterized by the low en-
ergy atom-atom scattering length, as. The two-body interac-
tion takes a simple form

U (r1 −

r2) =

4πas~2
m

δ(r1 −

r2) .

(41)

9

(42)

For this effective potential to be valid, several assumptions are
made; for example, the dominant effect is from s-wave scat-
is much smaller than the average inter-particle
tering, and
spacing. For more details we refer the reader to Ref. 3. In the
alkali gases these conditions are in general well met, and the
model potential can be expected to give quatitative informa-

as|
|

tion, although care must be taken to validate the conditions.

We now derive the Bose-Hubbard model from the standard
many-body Hamiltonian of the trapped boson problem in d-
dimension. In the continuous, real space, the Hamiltonian is
given by:

ˆH = ˆK + ˆV =

d3r ˆψ†(r)

Z
1
2 ·

+

4πas~2
m

~2

−

(cid:18)

2
r + 1
2m ∇

2 mω2

0r2

ˆψ(r)

(cid:19)
1) ˆψ†(r

d3r
1

d3r
2

ˆψ†(r

Z

Z

2)δ(r

1 −

2) ˆψ(r
r

2) ˆψ(r

1) .

The ﬁrst term is the one-body Hamiltonian ˆK, which consists
of the kinetic energy and the (external) conﬁnement poten-
tial. ˆV is the interaction Hamiltonian, which is the sum of all
the two-body potentials. The characteristic trap frequency is
ω0, which is related to the so-called oscillator length scale by
aho =

~/mω0.

We introduce a real-space lattice, with a linear dimension of

p

L, in a simulation cell of volume (2rb)d. The lattice spacing is
therefore ς = 2rb/L. Further we will consider only a spheri-
cally symmetric trap here for simplicity. We truncate the sim-
ulation cell accordingly and assume that the wave function is
negligible outside the maximum sphere enclosed by the cell.
(Generalization to inhomogeneous traps is straightforward.)
The discretized Hamiltonian corresponding to Eq. (42) is

ˆH =

i
X

nn(i)
h Xj
∈

i

c†i cj −

2dc†i ci

+ 1

2 κ

˜r
i −
|

˜r
2c†i ci
0|


+ 1

2 U

c†i cic†i ci −

c†i ci

,

(cid:17)

i (cid:16)
X

(43)

where c†i and ci are the usual creation and annihilation opera-
tors at site i. The Hubbard parameters t, U , and κ are related
to the real, physical parameters as follows:



terparticle spacing, but larger than the scattering length:

(45)

as| ≪
|

ζ

ρ−

1/d .

≪
With negative as, the particles tend to “lump” together due to
the gain in the interaction energy. This is a situation where
we especially have to be aware of the validity of the effective
potential. As mentioned we will do a consistency check at
the end of the calculation to ensure that the occupancy of the
lattice points are less than unity.

(44a)

(44b)

(44c)

t

−






t =

U =

κ =

1
2ς 2
4πas
ς d
ς 2
a4
ho

,

i is related to the real coordinate by ˜r

where for simplicity we have set ~ = m = 1. The lattice co-
ordinate ˜r
i = (L/2rb)r
i,
and ˜r
0 is the lattice coordinate of the trap’s center. Note that
as is the true scattering length only in three-dimensional sys-
tems. Nonetheless we will retain the symbol as in Eq. (44b)
as a convenient measure of the interaction strength in any di-
mension.

In the discretized model our resolution is limited by the lat-
tice spacing. This is consistent with the conditions of validity
of the model interaction in Eq. (41), as it in a sense “inte-
grates out” the short-range dynamics. In this model our lattice
constant ζ must be much smaller compared to the average in-

B.

Implementation of QMC

Implementation of our QMC method for this model is
straightforward. The number of basis M is equal to the num-
ber of lattice sites inside the truncated sphere of radius rb. The
two-body term in Eq. (43) is in the desired form of Eq. (6).
With a negative U , the HS transformation in Eq. (7) leads to
M auxiliary ﬁelds, with one-body propagators in the form of
xi ˆni), where ˆni ≡
c†i ci is the density opera-
exp(
|
tor. Our trial wave function
is the Gross-Pitaevskii (GP)
ΨTi
|
wave function ΦGP, which we describe in the next subsection.
We mention here a technical point in the implementation.

U
|

∆τ

p

O

The ground-state projection in our method involves the appli-
cation of one-body propagator in the form of e ˆA on a single-
. This usually translates into a
permanent wave function
φ
i
|
matrix-vector multiplication in the computer program, which
(M 2). Often there are special properties of
generally costs
ˆA that can be exploited to evaluate the one-body propagator
more efﬁciently. In the Bose-Hubbard Hamiltonian, the only
non-diagonal part of the Hamiltonian in real space is the ki-
netic operator in ˆK. We can separate it from the other one-
body operators and apply the kinetic propagator in momentum
space. Wave functions are quickly translated between these
two representations using the Fast Fourier transform (FFT).
2 ∆τ ˆK involves only
In this way, the actual application of e−
2 ∆τ ˆK op-
diagonal matrices; thus the overall cost for each e−
(M log M ). We observe in our calcu-
eration is reduced to
lations that the additional Trotter error is much smaller than
the error already introduced in the original breakup, Eq. (4).

O

1

1

C.

Implementation of Gross-Pitaevskii self-consistent equation

The Gross-Pitaevskii (GP) wave function ΦGP is the single-

permanent wave function

ΦGP(r1, r2, . . . rN ) = ϕ(r1)ϕ(r2)

ϕ(rN ) ,

(46)

· · ·

which minimizes the expectation value of the ground-state en-
ergy. Such a wave function satisﬁes the self-consistent Gross-
Pitaevskii equation [27, 28, 29]

~2

−

2m ∇

2ϕ(r) + 1

r
2 mω2
0|
−
4πas~2
1
m |

2ϕ(r)

r
0|
2ϕ(r) = µϕ(r) .
ϕ(r)
|

N

+

−
N

(47)

[We keep the prefactor (N
−
large and small values of N .]

1)/N , since we will study both

To compare our QMC results to those of mean-ﬁeld, we
carry out GP calculations on the same lattice systems. The
discretized GP Hamiltonian in the second-quantized form is:

ˆHGP =

t

−

c†i cj −

2dc†i ci

i (cid:16) Xj
nn(i)
X
∈
˜r
˜r
0|
i −
|

2c†i ci

+ 1

2 κ

N

+

i
X
1
−
N

U

¯nic†i ci −

1

2 ¯n2

i

.

i (cid:16)
X

(cid:17)

(cid:17)

(48)

Here ¯ni is the expectation value of the density operator:

c†i ci|

¯ni ≡

ΦGPi

ΦGP|
h
ΦGP|
h
We have implemented two methods for solving the GP
equation. The ﬁrst is the usual self-consistent iterative ap-
proach. We generate an initial density proﬁle, ¯n(0)
, by solving

ΦGPi

(49)

.

i

10

the non-interacting Hamiltonian (with U = 0). The density is
fed back to construct the initial Hamiltonian ˆH (0)
GP in (48). Di-
rect diagonalization of this one-body Hamiltonian yields its
. We thus obtain an updated density ¯n(1)
Φ(1)
ground state
GPi
|
and a better Hamiltonian ˆH (1)
GP. This procedure is iterated un-
til the desired convergence criterion is satisﬁed. We choose
our convergence condition to be:

i

ϕ(t+1)(r)
dr
ϕ(t)(r)
|
−
|
ϕ(t+1)(r) + ϕ(t)(r)
dr
|
|

1
R
2
R

< ǫ ,

(50)

where ǫ is a small number (usually on the order of 10−
double precision numbers).

13 for

The second method we use to solve Eq. (48) avoids the
diagonalization procedure. It is closely related to the QMC
method, both computationally and formally (see Sec. VI). We
use the ground-state projector e−

∆τ ˆHGP:

(e−

∆τ ˆHGP)n

Ψ(0)
|

i

n
→∞
−→ |

ΦGPi

.

(51)

The initial wave function is arbitrary and can be, for example,
chosen again as the solution with U = 0. The feedback mech-
anism through the density proﬁle ¯ni remains the same. By
using the same Fast Fourier transform for the kinetic propaga-
tor as described in subsection IV B, a speed gain is obtained,
especially for large systems. In practice we have often found
this method to be a simpler and faster alternative to the ﬁrst
method of diagonalization and iteration. Note that the scalar
term
i does not affect the projection pro-
cess, but with it ˆHGP corresponds to the original many-body
P
ˆHGP|
Hamiltonian in that

ˆH
ΦGP|
h

.
ΦGPi
|

ΦGP|
h

ΦGPi

N
1
N U
−

i ¯n2

−

=

1
2

V. RESULTS

In this section we present results from our QMC and GP
calculations in one-, two-, and three-dimensions. To validate
our new QMC method and illustrate its behavior, the major-
ity of the calculations will be on systems where exact results
are available for benchmark. These include small lattices,
which can be diagonalized exactly, and the case of attractive
δ-function interactions in one dimension, where analytic solu-
tions exist. For the purpose of presenting the method to facili-
tate implementation, some numerical results and comparisons
are shown in detail to illustrate the behavior and characteris-
tics of the method.

Most of the results we present here will be for attractive
interactions, where the method is exact and is free of any
phase problem [22] from complex propagators (see subsec-
tion V C). Such systems therefore provide a clean testground
for our new method. In addition, with attractive interactions
the condensate in 3-D is believed to collapse beyond a critical
interaction strength or number of particles. Mean-ﬁeld cal-
culations [30] estimate the collapse critical point to be about
0.575. The exact behavior of the condensate
N as/aho =
near the critical point is, however, not completely clear, as
many-body effects are expected to have an impact. At the end

−

of this section we will also show some preliminary results for
larger systems with both attractive and repulsive interactions
in 3-D.

ˆVtrapi
h

, density proﬁle

We measure the ground-state expectation values of the fol-
the ground-state energy, kinetic energy
lowing quantities:
ˆT
, interaction energy
, external conﬁning potential
h
i
ˆV2Bi
, and the condensate fraction (of-
h
ten abbreviated “cond.frac.” in the tables and ﬁgures). The
condensate fraction is deﬁned as the largest eigenvalue of the
If we write the one-body
diagonalized density matrix [3].
Green’s function matrix
in terms of its eigenvalues
c†i cji
h
:
χα(i)
nα}
}

and eigenvectors

ˆnii
h

{

{

c†i cji
h

=

α
X

nαχ†α(i)χα(j) ,

then the largest eigenvalue divided by the total number of par-
ticles gives the condensate fraction.

A. Comparison with exact diagonalization: as < 0

The many-body Hamiltonian (43) can be diagonalized ex-
actly for small systems to benchmark our QMC calculation.
We compare our QMC results with exact diagonalization for
a one-dimensional lattice of 13 sites, and study its behavior
for different values of the interaction strength as and number
of particles N .

1.

5.292

−
6 ˚A−

The ﬁrst system we study has 5 bosons, with t = 2.676,
1.538, κ = 0.3503. These values correspond to the

U =
physical parameters aho = 8546 ˚A and as =
×
(Recall that, by our deﬁnition, as in 1-D does
10−
not have the dimension of length, and is not the scattering
length itself.) Table I shows the comparison of the quantities
computed using three methods: QMC, GP, and exact diag-
onalization (ED). The statistical uncertainty of QMC results
are presented in parantheses. We see that the agreement be-
tween QMC and ED is excellent. GP makes signiﬁcant errors
here because of the sizable interaction strength as well as the
small number of particles.

−

TABLE I: Comparison of QMC calculation against exact diagonal-
ization (ED) and Gross-Pitaveskii (GP). The system has 13 sites, 5
particles, t = 2.676, U = −1.538, κ = 0.3503. In the QMC cal-
culation we use ∆τ = 0.01, τbp = 4.0, and the GP solution as the
trial wave function.

Type g.s.energy h ˆT i

h ˆVtrapi

h ˆV2Bi

cond.frac.

4.278

ED −1.009
95.59%
QMC −1.008(2) 4.279(3) 0.8423(5) −6.129(2) 95.59%
GP −0.493

−5.162

−6.129

0.8427

0.7504

3.919

100%

To illustrate the convergence in imaginary-timestep ∆τ , we
show in Fig. 1 the total energy and the average trap energy
ˆVtrapi
. The former can be obtained exactly from the mixed
h
estimator while the latter requires back propagation. To show
the Trotter error, we have deliberately done the calculations up

to rather large ∆τ values. We see that both quantities converge
0.
to the exact results as ∆τ

11

→

Trap Potential Energy

QMC (t

BP = 4.0)
Exact diag.

Total Energy

0.850

0.840

0.830

0.820

0.810

0.800

 0

−0.98

−0.99

−1.00

−1.01

−1.02

 0

 0.05  0.1  0.15  0.2

 0.05

 0.1

 0.15

 0.2

FIG. 1: Convergence of QMC observables with ∆τ . The system has
the same parameters as in Table I. Exact results are shown as dotted
lines. Lines connecting QMC data are to aid the eye.

To illustrate the convergence of observables in back-
propagation length, we show in Fig. 2 the various observables
computed by QMC as a function of τbp. Separate calculations
were done for different values of τbp. For all calculations,
a small ∆τ value of 0.01 was used. We see that all quanti-
2.
ties converge to the exact results rather quickly, by τbp ∼
(The total energy
is of course exact for any τbp, including
τbp = 0.) As we see from the energy expectations, this is in
fact a system with signiﬁcant interaction effects. Alkali sys-
tems at the experimental parameters often have signiﬁcantly
weaker interaction strengths and the convergence rate is ex-
pected to be even faster.

H
h

i

Our QMC method is exact and therefore independent of the
trial wave function ΨT, except for convergence rate and sta-
tistical errors. In Fig. 3 we show QMC results obtained us-
ing two different ΨT’s, the noninteracting solution and the
GP wave function. The convergence of condensate fraction
and trap energy are shown versus back-propagation time τbp
for a system of 6 particles on 13 sites. The calculations lead
to the same results. The quality of ΨT, however, does af-
fect the variances of the observables and their convergence
rates with τbp. For example, the noninteracting wave func-
tion, which disregards the two-body interaction, is more ex-
tended (in its density proﬁle) than GP. Its mixed estimator is
therefore worse than that with the GP trial wave function. The
mixed-estimator for the ground-state energy is exact in both,
but the variance is slightly larger with the former.

(N

We now show results for different systems with N from 2 to
9 bosons, and varying interaction strengths. We note that if we
keep the product U
1) constant, the Gross-Pitaevskii
equation predicts the same per-particle energies and densities.
For brevity, we shall refer to the curve in which U
1)
is constant as the GP isoline. Deviation from the GP isoline
is therefore an indication of the effect of many-body corre-
lations. In order to show results on multiple systems at the

(N

×

−

×

−

D
t
0.0

-0.1

-0.2

-0.3

-0.4

-0.5

0.55

0.50

0.45

0.40

0.35

0.30

0.25

0.20

0.15

0.10

0.05

0.00

Total Energy

Condensate Fraction (%)

Total Energy

Interaction Energy

12

QMC
Exact result
GP

-0.9

-1.0

-1.1

-1.2

-1.3

-1.4

-1.5

-1.6

-1.7

 0

 1

 2

 0

 1

 2

Kinetic Energy

Trap Energy

Interaction Energy

 2  3  4  5  6  7  8  9

 2  3  4  5  6  7  8  9

QMC
Exact diag.
GP

N

QMC
Exact diag.
GP

N

0.86

0.84

0.82

0.8

0.78

0.76

0.74

-5.0

-5.2

-5.4

-5.6

-5.8

-6.0

-6.2

-6.4

 0

 1

 2

 0

 1

 2

 0

 1

 2

FIG. 2: Convergence of the computed observables versus τbp. The
system is the same as in Table I. The different panels show ﬁve
different observables. The horizontal axes are the back-propagation
length. Exact results are shown as dotted lines, while GP results as
dash-dotted lines. Solid lines are present only to aid the eye.

Condensate Fraction (%)

Trap Energy

QMC (Y

QMC (Y

T = GP)
T = nonint)
GP

FIG. 4: Comparison of QMC, GP, and ED results for different sys-
tems. Calculations were done along a GP isoline U × (N − 1) =
−2.30t for up to nine particles in 13 sites. The graphs show the to-
tal and interaction energies per particle. QMC and exact results are
indistinguishable. GP is accurate in the limit of weak correlation but
deviates more from the exact results as the system becomes more
correlated. The solid lines are to aid the eye.

0.1605(2) for N = 2 and 9 particles, respectively, while the
GP value is 0.1501. In GP, interaction energy is lowered by
increasing particle overlap, namely by shrinking the proﬁle.
In reality, the particles ﬁnd a way to reduce interaction with-
out statically conﬁning to the central sites, resulting in a more
extended one-body proﬁle.

QMC, N = 2
QMC, N = 9
GP

-0.40

-0.50

-0.60

-0.70

-0.80

-0.90

-1.00

-1.10

4.4

4.2

4.0

3.8

 102

 100

 98

 96

 94

100

99

98

97

96

95

BP
BP

1.3

1.2

1.1

1.0

0.9

0.8

0.7

0.6

0.5

0.4

 0  0.5  1  1.5  2  2.5  3  3.5  4

 0  0.5  1  1.5  2  2.5  3  3.5  4

BP

BP

FIG. 3: Independence of QMC results on trial wave functions (“GP”
for Gross-Pitaevskii, “nonint” for noninteracting solution). The sys-
tem is the same as in Table I, except that here we use 6 particles. The
horizontal axes are the back-propagation length. Lines connecting
QMC data points are present only to aid the eye.

same time we will scan GP isolines. Figure 4 shows the QMC
and GP results as a function of the number of particles. In the
GP calculations the per-particle quantities are constants. The
QMC results, on the other hand, capture the effect of corre-
lation. Both the total energy and the interaction energy are
lowered from the GP results. The exact results deviate from
GP more as the system becomes more correlated along the GP
isoline, i.e. when U is increased or when N is decreased. Al-
though N is too small here because of the limitation of ED,
the results are representative of the general trend in larger sys-
tems (see below).

Figure 5 further illustrates the effect of particle correla-
tion in this system. Although the exact interaction energy is
lower than that of GP, the exact density proﬁle is more ex-
tended. This is also manifested in the average trap potential
/N , where the QMC results are 0.1981(8) and
energy

ˆVtrapi
h

 2

 3

 4

 5

 6

 7

 8

 9

 10

Lattice site

FIG. 5: The normalized density proﬁles as an illustration of parti-
cle correlation effects. Results are for 13-site systems along the GP
isoline U × (N − 1) = −2.30t. The normalized GP curve is iden-
tical for any number of particles along this line. QMC results are
shown for N = 2 and N = 9. The QMC results have very small
errorbars and are indistinguishable from ED (not shown). The QMC
density proﬁles are more extended, although the interaction energies
are lower than GP, as shown in Fig. 4.

B. Comparison with analytic results in 1-D: as < 0

The problem of an arbitrary number of untrapped bosons
interacting with an attractive δ-potential in one dimension can
be solved analytically [31], yielding analytic expressions for
the total energy and density proﬁle. In this section we carry
out QMC and GP calculations and compare our results against

t
t
t
t
these analytic results, on systems of up to 400 bosons. The
Hamiltonian in the continuous real space is

−200 −100

0

100

200

1.0e−02

)

3
−

0
1
 

(·
 
y
t
i
s
n
e
d
 
d
e
z

i
l

a
m
r
o
N

6.0

5.0

4.0

3.0

2.0

1.0

0.0

-0.164

-0.166

-0.168

-0.170

-0.172

-0.174

l

e
c
i
t
r
a
p
 
r
e
p
 
y
g
r
e
n
E

ˆH =

1
2

−

N

i=1
X

N

∂2
∂x2

i −

1
2

g

i>j=1
X

δ(xi −

xj ) .

(52)

U/√t

The interaction constant (g > 0) is related to our Hubbard pa-
rameters by g
. The ground state of this Hamilto-
|
nian is an N -boson bound state. By ﬁxing the center of mass
at x = 0, we can eliminate the contribution from its overall
motion, which leads to the following analytic expressions for
the density proﬁle [32],

≡ |

ρ(x) = 1
2 g

1)n+1

N

−

1
(
−

n=1
X

and the total energy,

n(N !)2e−

gnN

x

/2

(N + n

1)!(N

−

|

|
n

−

−

1)!

,

(53)

E =

−

1

96 g2N (N 2

1) .

−

(54)

In our QMC calculations, we again put the system on a real-
space lattice. The lattice size is chosen to be large enough so
that discretization errors are comparable to or smaller than sta-
tistical errors. As the ground state of the system is a droplet
in the absence of the external conﬁning potential, the center
of mass can slide in the calculation due to random noise. We
therefore need to subtract the center-of-mass motion. Tech-
nically, this can be accomplished conveniently in the random
walk by treating the system with respect to its center of mass.
In Appendix B, we describe our method for this correction,
which is applicable in any situation where the center of mass
and relative motions need to be separated. In our calculations,
the correction affects the kinetic and total energies as well as
the density proﬁles. The results shown below were all ob-
tained with such a correction applied.

We ﬁrst study a system of 20 particles with g = 0.154.
Table II shows the energies, and Fig. 6 the density proﬁles.
This is a system where mean-ﬁeld makes signiﬁcant errors.
Our QMC results are in excellent agreement with the exact
results.

TABLE II: Comparison of QMC and GP results to available exact
results. The system has 20 particles and g = 0.154. A lattice of 1024
sites was used, with ∆τ = 0.01 and τbp = 2.5.
h ˆV2Bi

g.s.energy h ˆT i

cond.frac.

Type

Analytic result −1.971
QMC
GP

−1.964(8) 2.044(8) −4.007(4) 99.76%
−1.784

−3.561

1.776

100%

-

-

-

13

Analytic
GP
QMC

1.0e−03

1.0e−04

−300

−200

−100

 0

 100

 200

 300

Distance (lattice unit)

FIG. 6: Comparison of calculated density proﬁles from QMC and
GP with analytical results. The densities are normalized. The QMC
errorbars are displayed every ﬁve data points to avoid cluttering the
plot. The QMC proﬁle is given by the dotted curve. The inset shows
the same curves with logarithmic vertical scale, indicating that at
large distances the density is exponential.

as N is decreased, mean-ﬁeld results deviate more and more
from the exact results. For example, as we go from g = 0.01
(N = 400) to 10 times the strength along the isoline, the sys-
tematic error in the GP total energy increases roughly from
0.5% to 5%.

Analytic
QMC
GP

 0

 50

 100

 150

 250

 300

 350

 400

 200
N

FIG. 7: Comparison of the energy from QMC (crosses) with the
exact answer (dotted curve) for different number of particles. Energy
per particle is shown along the GP isoline g × (N − 1) = 4.0. The
GP result is the ﬂat, dash-dotted line. We use a lattice of 1024 sites,
∆τ = 0.01 and τbp = 4.0.

We next scan systems with various numbers of particles by
following the GP isoline g
1) = 4.0. The energy
(N
per particle is shown as a function of N in Fig. 7, for up to
400 particles. Fig. 8 shows the density proﬁles for up to 100
particles. Again, the agreement between QMC and exact re-
sults is excellent. As the interaction strength g is increased or

×

−

We now study the system along a different line, holding the
interaction strength g ﬁxed while scanning the number of par-
ticles, again up to N = 400 particles. Figure 9 shows the
/N 3 for up to 400 particles, with g = 0.0403.
behavior of
i
At large N , the total energy is roughly proportional to N 3.
Compared to Figs. 7 and 8, the interaction strength here is

ˆH
h

14

Analytic
QMC
GP

GP
QMC, N = 5
QMC, N = 20
QMC, N = 100

-1.60

)

5

-1.64

0
1
 

3

(
 
 

N

 
/
 

H

-1.68

-1.72

)

3
−

0
1
 

(
 
y
t
i
s
n
e
d
 
d
e
z

i
l

a
m
r
o
N

 10

 9

 8

 7

 6

 5

 4

 3

 2

 1

 0

 0

 50

 100

 150

 200

Distance from the center−of−mass (lattice unit)

FIG. 8: Comparison of the density proﬁles from QMC and GP with
analytic results. The normalized densities are shown along the GP
isoline g × (N − 1) = 4.0 for several N values. The system is the
same as that in Fig. 7. The GP density is the same for any N on the
isoline, and is given by the dash-dotted line.

∼

stronger at larger N and weaker at lower N , with the crossover
at N
100. Most of the calculations are therefore more
challenging numerically. Again QMC was able to completely
recover the correlation energy missed by GP. At large N ,
smaller timesteps were used and more computing was nec-
essary to reduce the statistical errors. (Note that the errorbars
appear larger at smaller N in the plot because of the division
by N 3.)

C. Comparison with exact diagonalization: as > 0

We have shown that our new QMC algorithm is exact and
works well for a wide range of systems with attractive inter-
actions. If the interaction is repulsive (as > 0, or equivalently
U > 0) the one-body propagators resulting from the HS trans-
formation become complex, in the form of exp(i√∆τ U xi ˆni).
The same algorithm applies in this case as well. In principle
the complex one-body operator only requires a change to the
corresponding complex operations. But in practice a serious
phase problem occurs, which causes the calculation to lose ef-
ﬁciency rapidly at larger interaction strengths. We discuss this
problem and how to control it below. Our initial studies indi-
cate that, for moderate interaction strengths, the algorithm as
is remains very efﬁcient and gives accurate results, allowing
reliable calculations for parameters corresponding to experi-
mental situations in 3-D.

We benchmark our algorithm in one- and two-dimensional
systems with repulsive interactions against exact diagonaliza-
tion. Table III shows results for a one-dimensional system,

 0

 50

 100

 150

 250

 300

 350

 400

 200
N

FIG. 9: Comparison of computed ground-state energy for different
numbers of particles N . The interaction strength is held constant at
g = −0.0403. The total energy divided by N 3 is shown as a function
of N for QMC, GP and exact calculations. Conservative parameters
were used, with τbp = 4.0 in all case, and ∆τ = 0.01 for N < 200
and ∆τ = 0.005 otherwise.

with 13 sites and 4 particles. The agreement between QMC
and exact result is excellent. Results from GP are also shown.
The GP and QMC density proﬁles have roughly the same size,
ˆVtrapi
as evident from the values of
. However, GP overesti-
h
mates the interaction energy because it does not take into ac-
count the particle-particle correlation. In the mean ﬁeld pic-
ture, expanding the density proﬁle is the only way to lower
the interaction energy, so that the particles overlap less with
ˆVtrapi
is indeed slightly larger for
each other.
h
GP.) In reality, particles can avoid each other more effectively
by means of many-body correlation. The QMC correctly re-
covers this correlation, which lowers the total energy without
spreading the density as much as GP does.

(Note that

TABLE III: Comparison of QMC results against exact diagonaliza-
tion (ED) and Gross-Pitaveskii (GP) in 1-D. Here we use 13 sites and
4 particles; t = 2.676, U = +1.538, κ = 0.3503; ∆τ = 0.01 and
τbp = 2.5.

Type g.s.energy h ˆT i

h ˆVtrapi

h ˆV2Bi

cond.frac.

ED 4.24
QMC 4.24(2)
GP

4.43

1.269

1.793

1.18
98.5%
1.18(2) 1.790(8) 1.273(8) 98.6%
1.03
100%

1.800

1.599

×

Table IV shows results for bosons in a two-dimensional
trap, using a 4
4 lattice. The GP solution also exhibits the
same behavior as in the 1-D calculation, in that the density
proﬁle is slightly more extended, and the interaction energy is
overestimated. As in other cases, the QMC statistical errorbar
on the condensate fraction was not computed directly, but we
estimate it to be on the last digit.

As mentioned earlier, the only modiﬁcation necessary to
the algorithm in order to treat repulsive interactions (as > 0)

·
Æ
æ
·
-
TABLE IV: Comparison of QMC calculations against exact diag-
onalization (ED) and Gross-Pitaveskii (GP) projection in a 4 × 4
lattice, with 4 bosons. t = 0.2534, U = +0.3184, κ = 3.700;
∆τ = 0.01 and τbp = 2.5.
Type g.s.energy h ˆT i

cond.frac.

h ˆVtrapi

h ˆV2Bi

1.818

97.8%
ED 6.000
QMC 6.005(6) 1.817(2) 3.8325(2) 0.355(5) 97.8%
GP
100%

3.8326

3.8359

6.067

1.763

0.350

0.469

is to allow complex arithmetic. A more serious problem can
occur, however. The orbitals and the walker weights become
complex numbers. Asymptotically the phase of these weights
will be uniformly distributed in the complex plane. The de-
nomitors in Eqs. (34) and (40) will be dominated by noise,
causing the Monte Carlo sampling efﬁciency to decay and ul-
timately destroying the algebraic scaling of QMC. This is the
so-called sign or phase problem [19, 22]. In real-space meth-
ods this problem is connected to fermions, but here we have
a situation where a phase problem appears in the ground state
of a bosonic system. Physically, it is easy to see why a phase
problem must occur. Our many-body wave function is being
represented in IOR, with only one orbital in each walker. With
a repulsive interaction, the only way to reﬂect correlation ef-
fects, i.e., particles avoiding each other, is to make the orbitals
complex.

As we see below, our algorithm remains efﬁcient and gives
accurate results for large systems with scattering lengths cor-
responding to experimental situations in 3-D. As the interac-
tion strengths become much stronger, the phase problem will
ultimately make the approach ineffective. We have done pre-
liminary calculations in which we control the phase problem
by applying a phaseless formalism described in Ref. 22. Our
results indicate that the systematic errors introduced by the
phaseless approximation are small for moderate interaction
strengths. We expect to therefore be able to obtain accurate
and reliable results for scattering lengths well into the exper-
imental ’strong-interaction’ regime achievable by Feshbach
resonnance.

D. Realistic calculations in three-dimensions

In this section we present some test results on realistic
systems of trapped particles in three-dimensions. QMC re-
sults were obtained with back-propagation and conservative
choices of ∆τ and convergence parameters. We expect the
QMC results to be exact. We also carry out the corresponding
Gross-Pitaevskii calculations, and make comparisons against
our exact QMC results.

Table V shows the result of a QMC calculation for 175 par-
ticles in a three-dimensional trap. We choose a trap with a
characteristic length aho = 8546 ˚A. The trap was discretized
15 lattice, in a range that corresponds to
into a 15
×
22.4 ˚A. In
about 5
aho. The scattering length is as =
this regime the GP solution is a good approximation to the

15

−

×

×

15

exact ground-state wave function. We see that this is indeed
the case in Table V. The interaction energy is lowered in the
many-body calculation as expected. Interestingly, the external
potential energy is lower than in GP. Consistent with this, the
exact density proﬁle is tighter than in GP, as shown in Fig. 10.
The trend here appears different from what we observed in
small 1-D trapped systems in Fig. 5, but consistent with the
large untrapped systems in Fig. 8. We are presently carrying
out more calculations to cover a wider range of parameters
and study the role of dimensionality.

TABLE V: Comparisons of QMC and GP calculations for 175 parti-
cles in a 3-D spherical trap, with as = −22.4 ˚A and aho = 8546 ˚A.
The energies are displayed as per-particle quantities. Both the QMC
and GP results are extrapolated to ∆τ → 0.

Type g.s.energy h ˆT i

h ˆVtrapi h ˆV2Bi

cond.frac.

QMC 16.979(6) 16.47(5) 6.54(1) −6.03(4) 99.73%
GP

17.115

−5.25

15.60

100%

6.77

GP
QMC

4.0

3.5

3.0

2.5

2.0

1.5

1.0

0.5

)

3
−

Å

 

5
1
−

0
1
 

(·
 
y
t
i
s
n
e
D
 
d
e
z

i
l

a
m
r
o
N

0.0
−20000

−10000

 0
Distance (Å)

 10000

 20000

FIG. 10: Comparison of density proﬁles from the QMC and GP for
175 particles. The system is the same as described in Table V. The
QMC proﬁle is more peaked and tighter than GP.

×

×

15

We now turn to bosons with repulsive interactions in three-
15 lattice, and sim-
dimensional trap. We again use a 15
ulate 100 bosons. We choose a scattering length as of 80 ˚A.
This value is close to the experimental 39K singlet [33] or 87Rb
triplet [34] scattering lengths. In Table VI we show the cal-
culated energies and condensate fraction. For this interaction
strength, the impact of the phase problem on the statistical er-
ror is small, and the QMC calculation is very efﬁcient. The
true condensate is, like in the 1-D repulsive case, tighter than
that predicted by GP, with lower interaction energy.

VI. DISCUSSIONS

A. Connection between QMC and Gross-Pitaevskii projections

The QMC method we have presented allows us to go be-
yond mean-ﬁeld and treat many-body effects. On the other

TABLE VI: QMC calculation of 100 particles in a three-dimensional
trap. A lattice of 15 × 15 × 15 was used. The parameters correspond
to aho = 8546 ˚A and as = 80 ˚A. The quantities displayed are for
per particle.

Type g.s.energy h ˆT i

h ˆVtrapi

h ˆV2Bi

cond.frac.

QMC 24.687(9) 9.573(9) 11.933(5) 3.181(3) 99.80%
GP

24.922

12.028

9.281

3.612

100%

hand, it has a deep connection with the GP mean-ﬁeld ap-
proach. Our approach uses an HS transformation which leads
to integrals of single-particle operators over auxiliary-ﬁelds.
The mean-ﬁeld solution can be regarded as the leading term
in the stationary-phase asymptotic expansion of the exact so-
lution [35]. Our method evaluates this exact solution, which
is in the form of many-dimensional integrals, by Monte Carlo.
In this section we further comment on the formal connection
between our importance-sampled QMC and the GP as done
by projection (the second of the two GP methods discussed in
subsection IV C).

Let us reconsider the two-body propagator in the modiﬁed
AF transformation Eq. (25). Let us suppose that we are now
, and
taking our ﬁrst Monte Carlo step, where our walker is
φ
i
|
we will also use the same wave function as
. Following
the discussion of the optimal choice of ~x in the same section,
III B, we know that ~x = 0 is a stationary point with the choice

ΨTi
|

xi =

√∆τ ¯vi ≡ −

−

φ
ˆvi|
φ
√∆τ h
|
i
φ
φ
i
|
h

.

(55)

We can approximate the integral in Eq. (25) by the value of
the integrand at ~x = 0, which can be justiﬁed in the limit of
small ∆τ . More explicitly, as ∆τ
0, the Gaussian function
becomes the most rapidly varying term in the integrand. To
exhibit the asymptotic behavior of this integral, we change the
√∆τ ~x, so that the large parameter
integration variable to ~y
1/∆τ appears in the Gaussian’s exponent:

→

≡

1

2 ∆τ ˆv2

e

= e−

∆τ ( 1

2 ¯v2

¯v ˆv)

−

∞

dy

y2/2∆τ

e−
√2π∆τ

ey(ˆv

−

¯v) .

Z

−∞

The dominant contribution to the integral comes from the
maximum of the Gaussian function at y = 0. The asymptotic
leading term of the importance-sampled many-body propaga-
tor is therefore:

∆τ

ˆK

e−

−

P

(cid:0)

i ¯vi ˆvi+ 1
2

i ¯v2
i

P

,

(cid:1)

(56)

where ˆK is the one-body term in the original Hamiltonian.
Under this approximation, our random walk becomes deter-
ministic, needing only one walker. If for the next step we use
in
the updated wave function
φ′
i
|
Eq. (55), we obtain a self-consistent projection with one-body
propagators. In fact, the one-body Hamiltonian in the expo-
nent of Eq. (56) is precisely the mean-ﬁeld Hamiltonian. For

to evaluate the new

¯vi}

{

16

(57)

example, for Bose-Hubbard model the last two terms in the
exponent lead to the GP mean-ﬁeld potential

U

¯ni ˆni −

1

2 ¯n2

i

.

(cid:17)

−

i (cid:16)
X
Apart from the factor (N
1)/N which approaches unity in
the limit of large N , we have recovered the GP propagator.
The projection with Eq. (56) lowers the variational energy for
any initial
is the GP solution.
This is why GP is the best variational wave function that has
the form of a single permanent, and hence a reasonable trial
wave function to use for most of our QMC calculations.

and is stationary when

φ
i
|

φ
i
|

−

It is also clear from the discussion above that the impor-
tance sampling formalism allows us to have an optimal form
of HS transformation, in that the HS propagator ey(ˆv
¯v) in-
¯v. In other words, although
volves only the difference ˆv
−
in Eq. (7) we write the decomposition for the bare inter-
action term, the importance sampling transformation effec-
tively introduces a mean-ﬁeld background based on the trial
wave function and allows the HS to deal with only a residual
quadratic interaction term, (ˆv

−
To summarize, our QMC method reduces to GP if we eval-
uate the many-body propagator by the stationary-point ap-
proximation, using only the centroid of the Gaussian. The
full method evaluates the many-dimensional integral over
auxiliary-ﬁelds exactly by Monte Carlo.
It captures the in-
teraction and correlation effects with a stochastic, coherent
ensemble of mean-ﬁeld solutions. The structure of the cal-
culation can be viewed as a superposition of the GP projec-
tions that we have described. Our method therefore provides a
way to systematically improve upon GP while using the same
framework.

¯v)2.

B. Computing

Because of the structure of QMC as a superposition of GP
projections, our method scales gracefully with system size.
As discussed in Sec. IV B, the bulk of our method scales as
(M log M ), with the signiﬁcant speedup from using Fast
O
Fourier transform. For example, the QMC calculation shown
in Table VI required less than 8 hours on a single Alpha EV67
processor. The 1024-sites QMC calculation shown in Table II
took about four hours to get good statistics, with very con-
servative choices of ∆τ and other convergence parameters.
It required about 1.3 gigabytes of memory, largely because
of back-propagation path recording. In contrast, treated fully,
the latter problem would mean the diagonalization of a sparse,
1041)2 elements. Although
Hermitian matrix containing (8
this can be reduced by exploiting symmetries, exact diagonal-
ization of this problem is clearly not within reach with com-
puting capabilities in the foreseeable future.

×

We typically use hundreds of walkers in our calculation.
The stochastic nature of QMC means the number of walkers
ﬂuctuates due to branching and killing of walkers with very
large and very small weights (see subsection III). The popu-
lation therefore must be controlled to ensure that it does not
grow or decay too much, and that the walker weights have a

reasonable distribution. Our method to control the population
is similar to that discussed in Ref. 25.

We comment on the effect of the number of particles, N ,
on scaling. Because of the use of IOR, the number of parti-
cles does not enter in the propagation. It would then seem as
though the algorithm might have a super-scaling in N . This
∆τ ˆH depends on
is not true, of course, since the projector e−
N . For example, the shift ¯vi has a factor of N in front (see
Appendix A), and the local energy scales with N . As a result,
a smaller time-step must be used for larger N . The above ar-
guement suggests a linear reduction in ∆τ as N is increased,
which we have used as a rough guideline in our calculations
to select the range of ∆τ to use. Extrapolations with separate
calculations using different ∆τ values are then carried out.

C. Conclusion and Outlook

In conclusion, we have presented a new auxiliary-ﬁeld
QMC algorithm for obtaining the many-body ground state
of bosonic systems. The method, which is based upon the
ﬁeld-theoretical framework and is essentially exact, provides
a means to treat interactions more accurately in many-body
systems. Our method shares the same framework with the GP
approach, but captures interaction and correlation effects with
a stochastic ensemble of mean-ﬁeld solutions. We have il-
lustrated our method in trapped and untrapped boson atomic
gases in 1-, 2-, and 3-dimensions, using a real-space grid as
single-particle basis which leads to a Bose-Hubbard model
for these systems. We have demonstrated its ability to obtain
exact ground-state properties. We have also carried out the
GP mean-ﬁeld calculations and compared the predictions with
our exact QMC results. Our method is capable of handling
large systems, thus providing the possibility to simulate sys-
tem sizes relevant to experimental situations. We expect the
method to complement GP and other approaches, and become
a useful numerical and theoretical tool for studying trapped
atomic bosons, especially with the growing ability to tune the
interaction strengths experimentally and reach more strongly
interacting regimes.

From the methodological point of view, more work remains
to be done with the repulsive case to deal with the phase prob-
lem. We have shown that our method as it stands can be
very useful for moderate interaction strengths. For stronger
interactions, our preliminary study indicates that the phase-
less approximation [22], which eliminates the phase problem
but introduces a systematic error, is very accurate for scatter-
ing lengths well into the Feshbach resonnance regime. We are
currently examining this more systematically to quantify the
extent of the bias. Because of the simplicity of these bosonic
systems compared to electronic systems, they provide an ideal
testbed, where for small sizes the problem is readily solved by
exact diagonalization.

A variety of applications are possible. The ground state
of the Bose-Einstein condensates with both attractive and re-
pulsive interatomic interactions can be studied for various in-
teraction strengths, including the strongly interacting regime
reached by Fesbach resonance. They can also be studied in

17

different dimensions and under different conditions. In partic-
ular, it would seem straightforward to generalize our present
framework to study rotations and vortices, since we are al-
ready dealing with complex propagators and wave functions
in the repulsive case.
In addition, it will be interesting to
treat boson-fermion mixtures with our approach. As men-
tioned, the auxiliary-ﬁeld method is already widely used to
treat strongly interacting fermion systems.

Acknowledgments

We thank D. M. Ceperley and H. Krakauer for stimulat-
ing discussions. Financial support from NSF (grant DMR-
9734041), ONR (grant N00014-97-1-0049), and the Research
Corporation is gratefully acknowledged. SZ expresses his
gratitude to Prof.’s Ceperley and Richard Martin for their hos-
pitality during a sabbatical visit, where part of the work was
carried out. We also thank the Center of Piezoelectric by De-
sign (CPD), where part of our computing was performed.

APPENDIX A: IDENTICAL-ORBITAL REPRESENTATION

×

O

In this appendix we show that the matrix representation of
an N -boson wave function in AFQMC can be made particu-
larly simple. In fermion calculations, we must use an M
N
matrix to represent a determinant, because the orbitals must be
mutually orthogonal. In the boson case, however, this restric-
tion is absent. The most general form of a many boson perma-
nent is expensive to compute, having complexity of
(N M !).
But we can choose to make all the orbitals identical. In ma-
trix language, we will have only an M -row column vector.
We will term this representation identical-orbital representa-
tion—IOR. Each many-boson wave function in IOR has the
form of a GP mean-ﬁeld solution. Two conditions are neces-
sary for this choice to be viable in the QMC: that an initial
trial wave function of this form is allowed and that successive
projections preserve the form. The only requirement for the
former to hold is that the wave function in IOR not be orthog-
onal to the true many-body ground state, and it is straightfor-
in this form. More
ward to show that Eq. (12) holds for a
complex wave functions can always be generated by a linear
combination of such wave functions. In fact, this is what we
accomplish through our Monte Carlo simulation.

φ
i
|

In operator language, a single N -boson wave function

φ
i
|

is given by

= ˆφ† ˆφ†

φ
i
|

ˆφ†

=

0
|

i

N

ˆφ†

,

0
|

i

· · ·
N

(cid:0)

(cid:1)

|

{z

}

where ˆφ†
N
matrix φ whose columns are identical. The overlap of two
such wave functions is given by

α c†αφα. In matrix form,

would be M

φ
i
|

P

≡

×

ψ
h

φ
i
|

= per

ψT

= N !(ψψψ†

(cid:0)

φ
·
φφφ)N ,
(cid:1)

·

where the bold-phased symbols ψψψ and φφφ represent the single-
column vectors for ψ and φ, respectively. Similarly, for any
one-body operator ˆA,

ψ
h

ˆA
φ
i
|
|

= N ! N (ψψψ†

φφφ)(ψψψ†

φφφ)N

1 ,

−

(A1)

A

·

·

·

where A is the matrix for ˆA. The matrix element of a quartic
(two-body) operator is given by:

ψ
h

b†αb†βbγbδ|
φ
|
i

= N ! N (N

1)ψ∗αψ∗βφγφδ(ψψψ†

−

φφφ)N

·

2 .
−
(A2)

APPENDIX B: DROPLET CENTER-OF-MASS
CORRECTION

1. Correcting the density broadening

To handle the droplet system given by the translationally
invariant Hamiltonian in Eq. (52), an extra ingredient is nec-
essary in addition to the “basic” QMC algorithm that we have
described. In a deterministic calculation, for example in GP,
the motion of the center-of-mass (CM) can be simply elimi-
nated by ﬁxing it at the origin, as in Eq. (53). In the QMC
calculation, however, the orbitals ﬂuctuate as they are propa-
gated by ˆB(~x
~x), where the random ﬁelds ~x are drawn from
a Gaussian probability density. Random noise will inevitably
cause the CM of the system to slide, undergoing a free diffu-
sion whose average position is the origin.

−

Left unchecked, this spurious CM motion will lead to an
artiﬁcial broadening of the density proﬁle. To correct for it
in the density proﬁle, we could simply shift the CM of every
walker back to the origin. However, the importance-sampled
propagator involves ratios of overlaps with the trial wave func-
tion
, which would have to be corrected in the random
i
walk whenever a shift is made.

ΨT|
h

φi

Instead our solution to this diffusive motion is to let the trial
wave function slide along with the walkers. In other words,
we rewrite the kinetic energy operator as

ˆT = ˆTcm + ˆT ′ ,

(B1)

where ˆTcm represents the CM kinetic energy, and ˆT ′ the inter-
nal kinetic energy in the CM frame. The total Hamiltonian is
given by

ˆH = ˆTcm + ˆT ′ + ˆV

ˆTcm + ˆH ′ .

(B2)

≡

The quantities that we wish to compute are governed by the
“internal” Hamiltonian ˆH ′. Since ˆV involves only relative
coordinates among the particles, it commutes with ˆTcm; or
more generally,

[ ˆTcm, ˆH ′] = 0 .

(B3)

18

random-walk process, we are now free to correct for the CM
motion by shifting the walkers back to the origin whenever
necessary. For consistency, this correction must be applied
both in the normal random walk and in the back-propagation
phase.

2. Separating the center-of-mass kinetic energy

i

ˆT
h

ˆT ′
h

, in which Tcm ≡ h
i

The moving trial wave function, however, poses a problem
for the calculation of the kinetic energy. Now the orbitals are
free to slide, and the diffusive motion of the orbital’s CM is
no longer suppressed in the LAB frame. When we use the
usual t-term in the Hamiltonian in Eq. (43) to compute the ki-
ˆTcmi
netic energy, we obtain the total
are mixed. This leads to a spurious in-
and the desired
crease in the estimate of the kinetic energy and consequently
the total energy. For example, the uncorrected ground-state
energy for the system shown in Table II would be
1.887(2)
= 2.092(3); thus the total energy is overestimated
with
by 0.08 due to the contribution from Tcm. Since we know the
nature of the CM motion, it is fairly straightforward to extract
Tcm and explicitly subtract it from the kinetic and total energy
estimates. Allowing the droplet to freely slide in the calcula-
∆τ ˆTcm,
tion is equivalent to having a spurious “propagator” e−
whose effect on the wave function for the CM is described by
the diffusion equation

ˆT
h

−

i

∂Ψcm(R, τ )
∂τ

−

= ˆTcmΨcm(R, τ ) .

It is a well known property of such a diffusion process that the
R2(τ )
grows linearly with the
averaged squared distance
h
(imaginary) time τ :

i

R2(τ )
h

i

= bτ .

for a pe-
We can obtain b by recording the quantity
riod of time in the QMC simulation. The constant b is lin-
early proportional to Tcm. More speciﬁcally, the center-of-
mass Hubbard hopping parameter tcm can be extracted from
b:

R2(τ )
h

i

tcm = b/2 .

(B4)

This gives us the correct kinetic and total energies without the
spurious center-of-mass motion:

i

ˆT ′
h
ˆH ′
h

=

=

;

1
−
ˆT ′
(cid:0)
h

tcm
t
+

ˆT
i
h
ˆV2Bi
.
(cid:1)
h

(B5a)

(B5b)

i

i
To conclude, there are two necessary modiﬁcations in the
QMC algorithm in order to treat quantum droplets which are
not conﬁned:

In this way, the importance-sampled QMC propagation is de-
termined by ˆH ′. The motion of the CM in each walker is
a separate free diffusion which is governed by ˆTcm. In the

1. We let the trial wave function effectively “follow” the
QMC orbitals, by deﬁning its CM with that of each
QMC orbital.

2. For each orbital, we keep track and accumulate all the
applied CM shifts in order to estimate
. This
i
gives us the fraction of CM kinetic energy through the
constant tcm.

R2(τ )
h

These modiﬁcations in the QMC allows us to obtain the cor-
rect density proﬁle and energies of a translationally-invariant
Hamiltonian.

19

[1] M. H. Anderson, J. R. Ensher, M. R. Matthews, C. E. Wieman,

and E. A. Cornell, Science 269, 198 (1995).

[20] D. J. Dean and S. E. Koonin, Phys. Rev. C 60, 054306 (1999).
[21] S. Fantoni, A. Sarsa, and K. E. Schmidt, Phys. Rev. Lett. 87,

[2] F. Dalfovo, S. Giorgini, L. P. Pitaevskii, and S. Stringari, Rev.

181101 (2001).

Mod. Phys. 71, 463 (1999).

[3] A. J. Leggett, Rev. Mod. Phys. 73, 307 (2001).
[4] S. L. Cornish, N. R. Claussen, J. L. Roberts, E. A. Cornell, and

C. E. Wieman, Phys. Rev. Lett. 85, 1795 (2000).

[5] W. M. C. Foulkes, L. Mitas, R. J. Needs, and G. Rajagopal, Rev.
Mod. Phys. 73, 33 (2001), and also the references therein.
[6] D. M. Ceperley, Rev. Mod. Phys. 67, 279 (1995), and also the

[7] W. Krauth, Phys. Rev. Lett. 77, 3695 (1996).
[8] P. Gr¨uter, D. Ceperley, and F. Lalo¨e, Phys. Rev. Lett. 79, 3549

references therein.

(1997).

[9] M. Holzmann and W. Krauth, Phys. Rev. Lett. 83, 2687 (1999).
[10] J. L. DuBois and H. R. Glyde, Phys. Rev. A 63, 023602 (2001).
[11] J. L. DuBois and H. R. Glyde, Phys. Rev. A 68, 033602 (2003).
[12] M. Ulmke and R. T. Scalettar, Phys. Rev. B 61, 9607 (2000).
[13] R. Blankenbecler, D. J. Scalapino, and R. L. Sugar, Phys. Rev.

D 24, 2278 (1981).

[14] G. Sugiyama and S. E. Koonin, Ann. Phys. 168, 1 (1986).
[15] J. Hubbard, Phys. Rev. Lett. 3, 77 (1959).
[16] R. D. Stratonovich, Dokl. Akad. Nauk. SSSR 115, 1907 (1957).
[17] J. E. Hirsch, Phys. Rev. B 28, 4059 (1983).
[18] S. R. White, D. J. Scalapino, R. L. Sugar, E. Y. Loh, J. E. Gu-
bernatis, and R. T. Scalettar, Phys. Rev. B 40, 506 (1989).
[19] S. Zhang, J. Carlson, and J. E. Gubernatis, Phys. Rev. B 55,

7464 (1997).

[22] S. Zhang and H. Krakauer, Phys. Rev. Lett. 90, 136401 (2003).
[23] H. F. Trotter, Proc. Am. Math. Soc. 10, 545 (1959).
[24] M. Suzuki, Commun. Math. Phys. 51, 183 (1976).
[25] S. Zhang, in Theoretical Methods for Strongly Correlated Elec-
trons, edited by D. S´en´echal, A.-M. Tremblay, and C. Bourbon-
nais (Springer, New York, 2003), CRM Series in Mathematical
Physics, pp. 39–74.

[26] D. R. Hamann and S. B. Fahy, Phys. Rev. B 41, 11352 (1990).
[27] E. P. Gross, Nuovo Cimento 20, 454 (1961).
[28] E. P. Gross, J. Math. Phys. 4, 195 (1963).
[29] L. P. Pitaevskii, Sov. Phys.–JETP 13, 451 (1961).
[30] P. A. Ruprecht, M. J. Holland, K. Burnett, and M. Edwards,

Phys. Rev. A 51, 4704 (1995).

[31] J. B. McGuire, J. Math. Phys. 5, 622 (1964).
[32] F. Calogero and A. Degasperis, Phys. Rev. A 11, 265 (1975),

and also the references therein.

[33] J. L. Bohn, J. P. Burke, C. H. Greene, H. Wang, P. L. Gould,

and W. C. Stwalley, Phys. Rev. A 59, 3660 (1999).

[34] J. Weiner, V. S. Bagnato, S. Zilio, and P. S. Julienne, Rev. Mod.

Phys. 71, 1 (1999).

[35] J. W. Negele and H. Orland, Quantum Many-Particle Sys-
tems, Advanced Book Classics (Perseus Books, Reading, Mas-
sacusetts, 1998).

