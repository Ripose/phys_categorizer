4
0
0
2
 
n
a
J
 
1
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
8
0
1
1
0
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Comparison of localization procedures for applications in crystal embedding

O. Danyliv∗ and L. Kantorovich†
Department of Physics, Kings College London, Strand, London WC2R 2LS, UK
(Dated: February 2, 2008)

With the aim of future applications in quantum mechanical embedding in extended systems such
as crystals, we suggest a simple and computationally eﬃcient method which enables construction of
a set of nonorthogonal highly localized one-electron orbitals for periodic nonmetallic crystals which
reﬂect their chemical nature. The orbitals are also used to build up the Hartree-Fock (HF) electron
density of the entire crystals. The simplicity of the method stems from the fact that it does not
require usage and/or modiﬁcation of periodic electronic structure codes, and is instead based on the
HF calculation of a sequence of ﬁnite clusters with subsequent application of a localization procedure
to transform the HF canonical molecular orbitals. Two extreme cases of chemical bonding, ionic
(MgO crystal) and covalent (Si crystal), are considered for which a number of known localization
schemes are applied and compared. With some modiﬁcations our method can also be applied to
nonperiodic nonmetallic systems as well.

PACS numbers: 31.15.Ar, 71.15.Ap, 71.20.Nr

I.

INTRODUCTION

Electronic structure calculations of extended systems with a local perturbation, such as point defects in the bulk of
crystals [1] or adsorption of molecules at their surfaces [2] are of fundamental importance in solid state physics and
chemistry. Over the last decade a number of eﬀective computational techniques have been developed to study the
electronic ground state of such systems which are based on periodic boundary conditions (PBC) and either Hartree-
Fock (HF) [3, 4] or Density Functional Theory (DFT) [5, 6] approaches. In these methods a local perturbation (e.g.
an adsorbed molecule together with a fragment of a crystal surface) is artiﬁcially periodically repeated in a cell which
is large enough to ensure that the interaction between periodic images is negligible. These methods can also be applied
to study extended (but not inﬁnite) biological systems in which important chemistry is usually associated with a local
part of the entire molecule(s) [7].

Another set of methods, commonly referred to as embedding techniques, originate from a model in which a single
local perturbation is considered in the direct space of the entire system. This makes the model closer to reality at low
concentration, but, at the same time, it makes it more challenging since, due to the lack of periodic symmetry, well
developed PBC based techniques cannot be applied here. Instead, a number of hybrid methods have been developed
which treat diﬀerent parts of the system at diﬀerent levels of the theory. Most of these methods combine ab initio
quantum mechanics (QM) methods (based either on the DFT or the HF methods and their extensions) applied to a
ﬁnite fragment of the system (a quantum cluster ), with molecular mechanics (MM) methods based on semi-classical
force ﬁelds and applied to the rest of the system (environment region). The idea is to consider the most relevant part
of the system (e.g. with respect to a process in question) in great detail, while the rest of the system is treated at a
substantially lower level. These methods, developed mostly within the quantum chemistry community, and usually
referred to as QM/MM have proven to be extremely successful [8, 9, 10, 11, 12]. Note that some other embedding
schemes [13, 14, 15, 16, 17, 18, 19] developed mostly in the solid state community are very close in spirit to the
QM/MM methods.

Almost in all embedding methods mentioned above the quantum cluster is surrounded by point charges of the MM
region. In addition, in covalent systems the bonds coming out of the cluster are usually terminated by pseudoatoms
(see, e.g. [18]), so-called link atoms [9, 11, 12] or pseudopotentials [17, 18, 19, 20, 21].

Another class of embedding schemes relies on a more “electronic” (less “mechanical”) representation of the envi-
ronment region surrounding the quantum cluster. For instance, in [9, 22, 23] this is achieved by a special total energy
construction which allows a combination of several electronic structure methods of diﬀerent complexity applied to dif-
ferent parts of the system; other methods [13, 14, 15] rely on a representation of the wavefunction of the whole system

∗Electronic address: oleh.danyliv@kcl.ac.uk; On leave from Institute for Condensed Matter Physics, National Academy of Science of
Ukraine, Ukraine
†Electronic address: lev.kantorovich@kcl.ac.uk

2

as an antisymmetrised product of strongly orthogonal many-electron group functions (see, e.g.
with atoms, bonds or molecules depending on the speciﬁc type of chemical bonding in the system.

[24, 25]) associated

We believe that the formalism based on group functions is the most appropriate one for the derivation of any
embedding scheme. A rather general method based on overlapping (not strongly orthogonal) group functions [26, 27]
is presently being developed in our laboratory. Our method which is similar in spirit to some one-electron methods
[28, 29, 30] is based on construction of strongly localized orbitals which are designed to represent the true electronic
density of the entire system via a combination of elementary densities associated in simple cases with atoms, ions
and/or bonds. Our initial eﬀort in this project is focused on the development of an embedding scheme based on the
HF approximation and applied to point defects in the bulk or at surfaces of periodic crystals. Our intention is to
create a rather general technique which can be valid for systems of diﬀerent chemical character, ranging from purely
ionic to strongly covalent (note that our method cannot be directly applied to metals). Therefore, the proper choice
of the localization technique which can deliver localized orbitals across a wide range of systems with various character
of chemical bonding is crucial for our method to work for those systems.

It is the main objective of the present paper to critically analyze and develop further a number of localization
methods in order to verify their ability to describe a wide range of diﬀerent chemical bondings in periodic crystals.
Two systems are considered in the present paper in detail, MgO and Si bulk crystals, which are examples of extreme
ionic and covalent bonding, respectively. Note, however, that the method we suggest is not limited to periodic systems
and, with some insigniﬁcant modiﬁcations, can also be applied e.g. to inﬁnite amorphous and ﬁnite biological systems.
The application of the present method to those systems will be a matter of future publications.

It is relevant to mention, as far as the localization methods are concerned, that there are several methods developed
[31, 32] for obtaining orthogonal localized orbitals (i.e. Wannier functions) out of the Bloch-like solutions of the HF or
Kohn-Sham (KS) equations [6] for periodic crystals. Due to the built-in orthogonality even strongly localized Wannier
functions have long-range tails which make these functions nontransferable to other systems, e.g. when a chemical
bond between the same species is placed in a diﬀerent chemical environment. That is why our interest is focused on
construction of non-orthogonal localized orbitals which do not have this disadvantage and thus are more appropriate
for our purposes.

The plan of the paper is the following. Our philosophy in constructing localized orbitals as well as a short overview
of existing localization methods is given in section II with special emphasis on the methods used in our present work.
All the necessary notations are also introduced there. In section 3 we describe our implementation of some of the
methods and their application to MgO and Si crystals. The paper is ﬁnished with a short discussion and conclusions
in section 4.

II. LOCALIZATION METHODS

A. General philosophy

In order to describe the crystal as a set of overlapping localized functions, {

ϕa(r)}, which are given as a linear
i (r)} (and which thus span the same occupied Fock space), one has ﬁrst
combination of the original canonical set {ϕc
e
ϕa(r) have to be localized. This question can be viewed
to identify the regions of space where each of the functions
as purely technical since, any linear combination of the canonical set will give the same electron density ρ(r). We,
however, adopt in our work a strategy based on the chemistry of the system in question. Namely, the choice of
the localization regions is based on the type of the chemical bonding, e.g. on atoms in the cases of atomic or ionic
systems, on two atoms in the case of covalent bonding, etc. A more complicated choice may be necessary in the cases
of intermediate bonding. Several diﬀerent nonequivalent regions may be necessary to represent a crystal unit cell
which can then be periodically translated to reproduce the whole inﬁnite crystal. Note that there could be several
localized orbitals associated with every such a region forming together an electronic group [13, 24]. For instance, in
the case of the Si crystal one needs four localized regions associated with four bonds; each bond is represented by a
single double occupied localized orbital.

e

Once the occupied Fock space is obtained via a set of canonical orbitals and localized regions are identiﬁed, it is
necessary to ﬁnd such linear combination of canonical orbitals which are localized in each of the regions. The topic
of construction of localized (non-canonical) molecular orbitals (MO) out of delocalized canonical solutions of the HF
or Kohn-Sham equations is an old one [33] and many methods have since been developed.

Let us assume that a canonical solution of the restricted HF equations for the entire system (a closed shell crystal)

is known [24]:

F ϕc

i (r) = εiϕc

i (r)

b

(1)

i (r) =
ϕc

Cc

µiχµ(r)

Xµ

ρ(r) = 2

|ϕc

i (r)|2

occ

Xi

occ

Xj

e

ϕa(r) =

Uajϕc

j (r) ≡

Cµaχµ(r)

Xµ

e

ρ(r) = 2

ϕa(r)

occ

Xab

−1

b (r)
ϕ∗

(cid:16)

ab

(cid:17)

S

e

F is the Fock operator, ϕc

where
atomic orbitals (AOs) χµ(r). The electronic density of the system

i (r) is a spin-independent canonical MO (CMO) which is expanded over a set of

b

contains the summation only over occupied CMOs thus ensuring the correct normalization to the number N of the
electrons in the system. If an arbitrary (generally non-unitary) transformation U =kUajk of the CMOs within the
occupied subspace is performed,

than the expression for the density via the new set of orbitals should contain the inverse of the overlap matrix
[24]:

S =k

Sabk

e

e

e

e

e

ϕa(r)|

Sab = h

e
ϕb(r)i is the overlap integral. Note that the two representations of the electron density, Eqs.
where
(3) and (5) are absolutely equivalent. Moreover, any linear combination (4) of the occupied CMOs leads to the same
e
density.
If the transformation is unitary, then the overlap matrix is a unity matrix and the density takes on its
“diagonal“ form (3).

In general, any localization procedure is equivalent to some transformation U of the CMOs. Suppose, we would
like to obtain n localized MOs (LMOs) in some region A. To ﬁnd the necessary transformation, one can formulate
an optimization (minimization or maximization) problem for some speciﬁc localizing functional
ϕa}] with the
constraint that the LMOs associated with region A are orthonormal (of course, LMOs associated with diﬀerent regions
will not be orthogonal in general). We shall limit ourselves with such functionals which are invariant under arbitrary
unitary transformations of LMOs, i.e. which in fact depend on the orbitals {
ϕa} via invariants in the form of the
non-diagonal “density”

ΩA [{

e

e

e

σA(r, r′) =

ϕa(r)

a(r′)
ϕ∗

n

Xa=1

e

e
ΩA [{

ϕa}] ≡ ΩA [σA]. We shall see in a moment that
constructed out of the LMOs associated with region A, i.e.
his requirement ensures an existence of a simple eigenvalue-like problem for the LMOs. Note in passing that some
other types of functionals are also sometimes used which do not fall within this category. For instance, Admiston and
Ruedenberg proposed to ﬁnd the maximum of the self-repulsion energy [34], while later on von Niessen suggested to
maximize the charge density overlap functional [35]. Since the mentioned functionals are not invariant under unitary
transformations of LMOs and are also quite expensive computationally, we do not consider them in the following.
The quantity σA(r, r′) will be referred to in the following as the region electron density or region density for short.

e

e

To obtain all n LMOs associated with region A, an optimum of the following functional is sought for:

Ω′

A [σA] = ΩA [σA] −

ξab (h

ϕa|

ϕbi − δab)

n

Xa,b=1

e

e

where ξab are the corresponding Lagrangian multipliers. Because the actual dependence of the functional ΩA [σA]
on the orbitals is built-in via the region density (6), the functional derivative δΩA
a(r) can always be written using an
ϕ∗
δ
)
ϕa(r)δ(x − r′). Examples illustrating
a(x) =
e
ϕ∗
ΩA(r) as the localization operator in the following. An

this point will be given below. We shall refer to the operator

ΩA(r) deﬁned through an identity δΩA

ϕa(x) since δσA(r,r′

a(x) =
ϕ∗

operator

ΩA

e

e

δ

δ

b

e

b

e

b

3

(2)

(3)

(4)

(5)

(6)

(7)

4

(8)

(9)

important property of the localization operator is that it can also be considered as a functional of the region density
(6), i.e. it preserves the invariance property of the localizing functional it is built from.

Using standard methods, i.e. setting the variational derivative of the functional (7) with respect to the orbital
a(r) to zero and then performing a unitary transformation of the LMOs which diagonalizes the matrix of Lagrangian
ϕ∗
multipliers, one can easily obtain the following equations for the LMOs sought for:
e

or, in the matrix form,

ΩA

ϕa(r) = λa

ϕa(r)

e

ΩA

ij Uaj = λaUai

b

e

occ

Xj

ΩA calculated using canonical orbitals ϕc

i (r) and

where the matrix ΩA
j(r).
ϕc
Equations (8) resemble an eigenvalue problem for the operator

ij is given via matrix elements of the operator

b

ΩA. Note, however, that in some cases the localization
operator may still depend on the region density and thus on the orbitals themselves. Therefore, similarly to the HF
or Kohn-Sham problem, the system of equations (8) should be solved self-consistently.

b

The eigenvalue problem (8) or (9) may give a set of solutions from which only the ﬁrst (in the case when ΩA is
minimized) or the last (maximized) n solutions should be chosen. If the localization criterion (i.e. the functional
ΩA) used is appropriate, then (i) the chosen n solutions would have close eigenvalues λa which corresponds to their
similar localization in region A, and (ii) the gap in the eigenvalues λa between the chosen n and other solutions is
considerable, i.e. the other solutions have much worse localization in region A (cf.
[36]). By collecting LMOs from
all regions in the unit cell and then translating those over the whole crystal it should be possible to span the whole
occupied Fock space and thus construct the total electron density (5).

One point is in order now. So far we have assumed that the set of canonical MOs which span the occupied part
of the Fock space is already known. In other words, the procedure consists of two steps: ﬁrstly, a HF (or Kohn-
Sham) problem is solved and thus the occupied Fock space is determined, and, secondly, the LMOs are obtained by
ﬁnding an appropriate linear combinations of the canonical orbitals within this space. However, it is also possible to
formulate the problem in such a way that LMOs are obtained together with the set of canonical orbitals in a single
step [33]. In this method a localization criterion is considered alongside the energy minimization leading to a set of
so-called Adams-Gilbert (AG) equations (see, e.g. [37]) which are solved in a self-consistent manner. For instance, a
projection operator on the subspace of the LMOs was used by Stoll et. al. [38] as the speciﬁc localization method.
This technique was implemented in [28] for the embedded molecular cluster calculations. The LMOs resulting from
a single AG calculation are orthogonal as solutions of a single secular problem. The ﬁrst eigenvectors obtained will
show strong localization within the chosen region A; other eigenvectors will be much less localized and can usually
be distinguished by a gap in their eigenvalues as explained above. To obtain LMOs strongly localized in a diﬀerent
region A′, one has to solve the AG equations once again using another localization criterion and then pick up the
necessary number of the most localized orbitals. Repeating this procedure across the entire system, the whole occupied
Fock space can be split into sets of mutually non-orthogonal LMOs. Of course, in the case of the perfect crystals
this procedure should only be applied to various localization regions within the primitive unit cell owing to crystals
periodic symmetry.

Note that it is also possible to obtain all the LMOs corresponding to several localization regions at once within the
same self-consistent calculation by solving the necessary sets of eigenproblems associated with each region [29, 30].
The LMOs obtained using this technique are known as extremely localized MOs. This method is quite expensive
computationally since the overlap between LMOs localized in diﬀerent regions in space changes in the course of the
iteration procedure and this aﬀects the convergence. However, as will be discussed in the following, this technique is
a logical step forward in the future development of our method to be presented in section 3.

There are many ways in which the localizing functional ΩA can be chosen. Some of these methods which will be

utilized in the present work will be considered below in more detail.

B. Methods based on functionals linear in region density

In a number of methods [39] the localizing functional is proportional to the non-diagonal density (6) and thus can

be represented as a Hermitian bilinear functional with respect to the LMOs of the following general form:

ΩA =

ΩAσA(r, r′)

dr =

a(r)
ϕ∗

ΩA

ϕa(r)dr ≡

U ∗

ajΩA

jkUak

(10)

Z h

b

ir′→r

n

Z

Xa=1

e

b

e

n

occ

Xa=1

Xjk

5

(11)

(12)

(13)

(14)

ΩA is some localization operator and the Hermitian matrix ΩA =k ΩA

where
canonical MOs using the deﬁnition (2):

b

jk k can easily be written in terms of the

ΩA

jk =

ΩA |ϕc

ki =

Cc∗

µjCc

νk hχµ|

ΩA |χνi

Xµ,ν

b

ϕc
j
(cid:10)

(cid:12)
(cid:12) b

ΩA and the matrix ΩA do not depend on the LMOs sought for so
For all methods of this group both the operator
that in order to obtain the localized orbitals one has simply to ﬁnd the eigenvectors of the matrix ΩA using Eq. (9).
Two methods of this group are implemented in our work and will be considered in the following in more detail.

b

Magnasco-Perico criterion maximizes Mulliken’s [40] net atomic population produced by the LMOs in the selected

region [39, 41]. In this case the matrix ΩA is chosen in the following form:

Mulliken’s net population (method M)

ΩA

jk =

Cc∗

µjSµν Cc
νk

Xµ,ν∈A

where Sµν is the overlap integral between two AOs χµ and χν . The summation here is performed over AOs which are
centered in the chosen region A. Thus, in practice the localization region in this method is speciﬁed by a selection
of AOs in Eq. (12). This way one can make the LMOs to have the maximum contribution from the speciﬁed AOs
in region A. Sometimes a diﬀerent choice of AOs may lead to physically identical localization (see the next section).
This method will be referred to as method M.

The projection on the atomic subspace (method P)

The Roby’s population maximization [42] gives LMOs for which the projection on the subspace spanned by the
basis orbitals centered within the selected region is a maximum, or is at least stationary [39]. In this method the
localization operator

ΩA in Eq. (10) is chosen in the form of a projection operator:

|χµi (S−1

A )µν hχν|

ΩA =

b

Xµ,ν∈A

where S−1

A stands for the inverse of the overlap matrix SA deﬁned on all AOs µ, ν ∈ A. Note that operator

ΩA is

idempotent:

ΩA
(cid:16)
ΩA |χµi = |χµi. The detailed expression for the matrix ΩA is then:
b
In particular,

=

(cid:17)

b

ΩA. It projects any orbital into a subspace spanned by the AOs associated with region A only.

b

b

2

b

ΩA

jk =

Cc∗

λj Cc

τ k 

Sλµ(S−1

Xλ,τ

Xµ,ν∈A



A )µν Sντ 


Here the ﬁrst double summation is performed over all AOs of the system. Region A is also deﬁned via a subset of
AOs: by choosing particular AOs one ensures the maximum overlap of the LMOs with them. It is seen that this
method, which will be referred to as method P, although diﬀerent in the implementation, is very similar in spirit to
the previous method M.

Other methods

Note that several other methods [39] also belong to this class of methods. Since we are not using them here, we
shall only mention some of them. Bader’s method (see also [43]) is computationally expensive and leads to LMOs
with discontinuities at the boarder of the localization regions. The widely used Pipek-Mezey localization scheme
[44] could be described as the maximization of the Mulliken’s gross atomic population. The Pipek-Mezey functional

6

corresponds also to a minimization of the number of atoms over which the LMO is to be spread. This method is
very similar to the Mulliken’s net population method considered above, although is slightly more computationally
expensive. All population methods have an advantage of being very simple in the implementation which results in fast
non-self-consistent algorithms: indeed, only overlap integrals are to be computed. Note that instead of the overlap,
one can also maximize an exchange interaction of the LMOs with a set of AOs in region A [36].

Perhaps the most widely used, due to its relatively low computational cost, is the Foster-Boys [45] method in which
the dipole moment matrix element between so-called exclusive orbitals is maximized. The eﬃciency of the HF method
was improved in [46] by using localized orbitals constructed from the Foster-Boys method as AOs. Recently [32] the
Wannier functions were calculated for periodic Si and MgO crystals using the modiﬁed version of the Foster-Boys
method which ensured better localization within the cell volume. Note that, according to Ref. [39], the Pipek-Mezey
functional, unlike the Fosters-Boys method, preserves the σ/π separation of double bonds, which is in chemistry
usually preferred over the τ picture (where the orbitals are proportional to the linear combinations σ + π and σ − π)
associated with the Fosters-Boys localization procedure.

C. Methods based on functionals bilinear in region density

More complicated localization procedures can be constructed if the localizing functional is bilinear in non-diagonal
density (6) of region A in question, i.e. is of the fourth order with respect to the LMOs sought for. Three important
ΩA is linear in the density
general points should be mentioned: (i) for all methods of this group the localizing operator
σA(r, r′) and (ii) is thus invariant under any unitary transformation of the LMOs; (iii) therefore, one still has the
secular problem (8) or (9) for the LMOs in this case; however, it is to be solved self-consistently.

b

Minimization of the HF energy of a structure element (method E)

In this paper we shall only apply one method of this group in which the functional ΩA is chosen as the HF energy of
a ﬁnite fragment (structure element (SE), cf. [13]) of the system. This method, which will be referred to as method E
in the following, in its simplest version of the localization on a single atom originates from Adams [47]. This method
was recently used in [48] to derive an embedding potential provided by a part of a molecule. Method E is based on
an intuitive idea that every ﬁnite system, e.g. a SE, will try to ﬁnd an energetically favorable ground state which will
be localized in space. The SE could be an atom, group of atoms or a bond. In the latter case the SE for Si represents
essentially a hydrogen-like molecule consisting of fragments of two nearest atomic cores each of charge +e (e is the
electron charge) and two electrons of opposite spins (see the next section).

The eigenvalue problem (9) in this case is nothing but the usual Hartree-Fock-Roothaan (HFR) problem [24] for

molecular orbitals of region A, i.e. the elements of the matrix ΩA are matrix elements

ΩA

jk =

ΩA |ϕc
ki

ϕc
j
(cid:10)

(cid:12)
(cid:12) b

b

b

ΩA ≡

where
FA is the usual HF operator of the SE containing both electron-electron and electron-core interactions.
The peculiarity of this case is that the MOs (which are, in fact, LMOs) are expanded not via AOs but rather via
canonical HF orbitals for the whole system which, in turn, are linear combinations of AOs of the whole system as
in Eq. (2). In other words, the diﬀerence with the usual setup of the HFR problem is that in our case the preset
linear combinations (2) of the AOs of the whole system are used in place of the AOs themselves. Correspondingly,
this method is computationally expensive since all the one- and two-electron integrals which are necessary for the
construction of the Fock matrix ΩA are expressed as double and quadruple sums of the corresponding AO integrals.

III. LOCALIZED MOLECULAR ORBITALS FOR SI AND MGO BULK CRYSTALS

In this section we shall examine LMOs obtained using three methods described above. Two crystalline systems

with extreme types of chemical binding will be considered: MgO (ionic) and Si (covalent).

We are interested in calculating LMOs for perfect periodic solids. In this case the canonical MOs are Bloch-like
solutions of the HF or Kohn-Sham equations. This means that the eigenvalue problem (9) is of an inﬁnite dimension

A. General method

7

which make the calculation quite complicated; in addition, it would be necessary to use (and modify) a periodic
electronic structure code. To avoid these diﬃculties, we suggest a very simple procedure based on a cluster method.
The basic idea relies on the fact that when the cluster size is increased, the distribution of the electron density in its
central region should become closer to the actual electron distribution of the inﬁnite periodic system.

Our method is based on the following steps:

1. analyze the known electron charge density ρ(r) of the 3D periodic system in question to identify regions A, B,
C, etc. which can each be associated with even numbers of localized electrons, e.g. atoms, ions, bonds; the
density ρ(r) can be known from literature or own calculations;

2. consider a quantum cluster which contains region A in its center (or close to it); terminate the cluster using
pseudoatoms (see below) and/or an array of point charges to reproduce the correct Madelung ﬁeld; obtain the
occupied canonical orbitals ϕc

i (r) for the whole cluster;

3. then consider a localization problem for region A using one of the methods of the previous section; this should
ϕa(r) (a = 1, . . . , n) as a linear combination of the occupied canonical
i (r)}, Eq. (4); note that in some cases when e.g. pseudoatoms are used to terminate the cluster, their

give the necessary number of LMOs
MOs {ϕc
e
contribution to the LMOs should be removed and the orbitals renormalized;

4. repeat the procedure 2-3 for larger clusters to ensure that the LMOs obtained have converged;

5. if other types of regions exist, repeat steps 2-4 for those regions as well; when ﬁnished, LMOs for the whole
unit cell should be available; sometimes (as is the case for silicon), LMOs of some other regions can be obtained
without additional calculation by simply translating and possibly rotating the LMOs of a single region;

6. the LMOs within the primitive cell can be displaced by all possible lattice translations to obtain the complete
set of crystal LMOs spanning the complete occupied Fock space; these can now be employed for the calculation
ρ(r) and the actual periodic density ρ(r), calculated using a
of the density
periodic code and identical basis set, will not be exactly the same due to a number of approximations employed
here in calculating the LMOs (see below).

ρ(r) according to Eq. (5); note that

e

e

Some general comments of our general method are necessary at this point. Firstly, the convergence of our procedure
with the cluster size depends on the “boundary conditions” used in every case, i.e. it depends on the way the cluster is
terminated; it is nothing but the embedding method itself. The latter is, however, unknown. Therefore, our procedure
can be considered only as the ﬁrst iteration and thus larger cluster sizes are expected. In principle, when the LMOs
are obtained, one can use them for a new set of embedding calculations to obtain a better approximation for them,
etc. In this case smaller cluster sizes may only be necessary.

e

Secondly, it has already been mentioned that any linear combination of the canonical set of MOs should lead to the
ρ(r) obtained using the procedure outlined above
same electron density. Therefore, one may think that the density
will always result in the correct electron density ρ(r). This is, however, do not need to be the case due to a number
of approximations adopted. Indeed, we only consider ﬁnite clusters with ad-hoc boundary conditions; in addition,
the contribution of boundary cluster atoms may be modiﬁed when pseudoatoms are used. Finally, the cluster size
may be insuﬃcient to accommodate completely the LMOs. Therefore, the obtained occupied Fock space will never
be exactly the same as that obtained using the periodic calculation. Hence, the comparison of the electron densities
ρ(r) and ρ(r) may indicate on the quality of the calculated LMOs, and this method will be used in this paper.

The calculation of

ρ(r) is performed by exploiting the periodic symmetry and representing the LMOs as an integral
e
over the Brillouin zone. This method is exact and does not depend on the degree of localization of the LMOs. It also
allows exact handling of the inverse of the overlap matrix in Eq. (5). Details of the method will be published elsewhere.
To calculate the reference density ρ(r), we used our cluster calculations in the following way: (i) a parallelepiped in
the central part of the cluster with the sides along the primitive lattice translations a1, a2 and a3 which is equivalent
to the primitive unit cell is identiﬁed; its density is denoted ρc(r); (ii) the density of the whole 3D crystal is then
modelled as ρ(r) ≡ ρc(r1), where r1 is obtained from r by removing any lattice translations (this is most conveniently
performed by ﬁrst calculating fractional coordinates of r in terms of a1, a2 and a3 and then removing integral parts
from them). The larger size of the cluster is used in the calculations, the better approximation for the density ρ(r)
will be obtained in this way.

e

All numerical calculations reported in this paper were done using the HF method and the Gamess-UK [49] code

within the pseudopotential approximation.

B. Localized orbitals for the MgO bulk

8

A sequence of three ﬁnite clusters of increased size Mg6O, Mg38O13 and Mg44O19 containing 7, 51 and 63 atoms,
respectively, and surrounded by an array of nearly 103 point charges of ±2e to simulate the Madelung ﬁeld was
considered. The largest cluster used is shown in Fig. 1 (a). To consider explicitly only the valence electrons, for

FIG. 1: The largest quantum clusters used in our HF calculations to model (a) MgO and (b) Si crystals. Points charges
surrounding the MgO cluster to simulate the Madelung ﬁeld are not shown. One electron Na and two electron Mg pseudoatoms
(shown) were used in (b) to saturate bonds with boundary Si atoms (see text).

both Mg and O we used coreless Hartree-Fock pseudopotentials (CHF) with LP-31G basis set from Ref.
[50]. The
number of electrons in each cluster was calculated by adopting a well known ionic character of the MgO crystal, i.e. by
assuming that every Mg2+ ion is associated with no electrons, while every O2− ion has eight electrons. The LP-31G
basis set was used in all our calculations and the distance between the nearest Mg and O atoms is 2.122 [51].

After the HF solution was obtained for every cluster, we applied the three localization procedures (methods M, P
and E) considered in the previous section to obtain the LMOs for this system. Since there are only two atoms in the
primitive cell, Mg and O, and it is well known that the valence electron density is localized predominantly on the O
atoms, one can choose essentially a single region A within the primitive unit cell to localize the LMOs into, namely,
ϕs(r), and three of the p
on the O atom. We should expect four LMOs localized on every O atom: one of the s type,
type,

ϕpy (r) and

ϕpx (r),

ϕpz (r).

e

e

Therefore, when applying the methods M and P we used the s and px, py and pz type AOs centered on the O
atom in the center of every cluster when applying Eqs. (12) and (13). In the case of method E, we considered the
HF problem for a single oxygen ion O2− in the basis set of all occupied canonical MOs of the entire cluster. In every
case exactly four LMOs were obtained as having the smallest eigenvalues; other states were found to be separated by
a considerable gap.

e

e

The HF electron density through the central O atom for every cluster is shown in Fig. 2 (a). One can see that the
density is perfectly converged already for the smallest of the clusters. This means that the electron density in the
center of any of the clusters can be considered as being very close to the density of the actual 3D periodic crystal
calculated in the HF approximation using the same basis set.

The partial oxygen electron density

ρO(r) =

s(r) +
ϕ2

px(r) +
ϕ2

py (r) +
ϕ2

pz (r)
ϕ2

ϕpx(r), etc. We compare ρO(r)
can be conveniently used to characterize the localization of the obtained LMOs
obtained for all clusters using method M in Fig. 3 (a). Note that other methods give practically identical densities. It
is seen that all four LMOs are extremely well localized on the O atom (as one would expect for such an extremely ionic
system) and converge very quickly with the cluster size. The LMOs are essentially identical for all three methods.

ϕs(r),

e

e

e

e

e

e

Obviously, LMOs associated with any other unit cell can now be obtained simply by moving the calculated four
ρ(r)

LMOs by the appropriate lattice translation. We have made a careful comparison of the total electron density

(15)

e

9

FIG. 2: The HF electron density for (a) MgO and (b) Si for the three clusters studied in each case: (a) along the line passing
through the central O and the nearest Mg atoms; (b) across the central Si-Si bond. Positions of Mg, O and Si atoms are
indicated.

FIG. 3: (a) Partial density ρO(r), Eq. (15), calculated using method M for all clusters; (b) electron densities of the MgO
crystal constructed from LMOs obtained using methods M, P and E (lines) are compared with the HF density calculated from
the middle of the largest cluster (stars). All densities are shown along the Mg-O-Mg direction. Mg and O atoms are indicated
on the picture.

constructed using Eq. (5) with the density ρ(r) calculated using the central part of the largest cluster. In particular,
such a comparison is shown in Fig. 3 (b) along the (001) direction across the central O atom. One can see that either
ρ(r) obtained using the LMOs (indistinguishable on the
method results in the perfect matching between the density
plot) and the reference density, ρ(r). Thus, all three localization techniques work equally well in the case of MgO and
require clusters of very moderate sizes.

e

C. Localized orbitals for the Si bulk

10

Crystalline Si has the diamond-type lattice with the distance between the nearest Si atoms of 2.35. Each Si atom
is surrounded by four neighbors forming four covalent bonds with them. There are two Si atoms and thus eight
electrons (within the valence approximation) to be assigned to every primitive cell. Since each bond is associated
with two electrons, there should be four bonds per cell. We expect that well localized orbitals can be constructed for
this crystal if localization regions are associated with every two-electron bond. Therefore, in this case we have four
regions A, B, C and D of identical nature in the primitive cell as shown schematically in Fig. 4. Note that the choice

2

1

FIG. 4: Four two-electron bonds associated with a primitive unit cell in the Si crystal.

of four inequivalent bonds is not unique. In our choice shown in the ﬁgure all four bonds share atom 1 and can be
obtained from any single bond (e.g. the central bond between atoms 1 and 2) by applying appropriate displacements
and rotations.

Three quantum clusters Si2Na6, Si8Na18 and Si26Na18Mg12, containing 2, 8 and 26 Si atoms were used in our
calculations; every cluster contains a single Si-Si pair in its center as shown in Fig. 1 (b). The core electrons of all
Si atoms were described using the Hay-Wadt pseudopotential [52]. To terminate unsaturated bonds of the Si atoms
located at the boundary of the clusters, we used Na- and Mg-like pseudoatoms which have the same pseudopotentials
as the Si atoms. The Na pseudoatoms contribute a single electron to the cluster and are positioned at the correct
Si-Si distance to saturate a single dangling bond. Mg-like atoms have two electrons and were used in the same way
to saturate two dangling bonds from two nearest boundary Si atoms (see Fig. 1 (b)). Since the Si crystal is a highly
covalent system, the Madelung ﬁeld can be considered of a secondary importance and thus was neglected. The 66-21G
basis set [53] was used on the Si atoms in most cases. The basis set on pseudoatoms Na and Mg included only s type
AOs.

To construct the LMOs for the Si crystal, we oriented the coordinate system in such a way that the z axis would
pass along the central Si-Si bond of every cluster. This particular choice of the coordinate system is merely needed to
simplify the choice of the AOs to be associated with the localization region A. Then, the HF solution was obtained
which demonstrated a good degree of the sp3 hybridization, as expected. When applying the localization methods
M and P, AOs of the s and pz types centered on the two central Si atoms were chosen as belonging to region A. In
order to apply method E, the following SE was considered in place of the central Si-Si molecule: it consisted of two
electrons and two pseudoatoms with the Si pseudopotential and the total charge +e each. Eﬀectively, this way the
SE was chosen as a pseudo-hydrogen molecule with pseudo-hydrogen atoms at the Si-Si distance described each by
the Si pseudopotential.

By analyzing the electron density in the central region of every cluster, we ﬁnd that the largest cluster we considered
is suﬃcient for our purposes. As an example, we show in Fig. 2 (b) the electron densities across the central Si-Si bond
for the three clusters. The single LMOs calculated for the central Si-Si bond of the three clusters using methods M
and E are shown in Fig. 5. The LMOs calculated using method P are very similar to those calculated using method
M and thus are not shown here. The important conclusion which can be drawn from these pictures is that the LMO
obtained using method M is practically converged with the cluster size. On the contrary, the LMO calculated using
method E is not yet converged becoming more and more delocalized with the increase of the cluster size. Even bigger
clusters are thus needed to converge the LMO using this method. However, as was mentioned earlier in section II C,
larger clusters require a very expensive procedure of calculating two-electron integrals, and thus we did not consider
larger systems. Note that another way of circumventing the convergence problem in method E might be to add some
potential well to the HF problem for region A to enforce a stronger localization; although we did not pursue this idea
in this work, we may consider it in the future.

To construct the electron density

ρ(r) of the whole Si crystal we need other three LMOs assigned to the same

e

11

FIG. 5: Square of the central bond LMO
and (b) E.

e

ϕ(r) calculated across the central Si-Si bond for every cluster using methods (a) M

FIG. 6: Electron densities of the Si crystal constructed from LMOs obtained using diﬀerent methods based on the largest Si
cluster. All densities are shown along the central Si-Si bond. Positions of the two Si atoms are also indicated. (a) ρsz based on
s and pz types of AOs using methods M (solid line), P (small dashes) and E (long dashes) are compared with the HF density
ρ1 - all AOs centered on a single central Si atom (long dashes);
calculated from the middle of the largest cluster (stars); (b)
ρsxyz (solid line) were obtained using {s, pz}, {s, px, py} and {s, px, py, pz} types of AOs
ρsz (stars),
centered on both central Si atoms, respectively; method M was used for all cases in (b).
e

ρsxy (small dashes) and

e

e

e

primitive cell. These are obtained by appropriate rotations and displacements of the central bond LMO considered
above. The LMOs corresponding to other crystal cells are then obtained by applying appropriate lattice translations.
ρ(r) obtained using the three localization methods for the largest cluster have been thoroughly
The electron densities
compared with the reference density, ρ(r), obtained by translating the central part of the same cluster. It has been
found that comparison of the densities along the central Si-Si bond, as shown in Fig. 6 (a), reﬂects well the extent in
which the densities match with each other. One can see that both methods M and P lead to the electron density of
the Si crystal which is very close to the reference density ρ(r). However, the density
ρ(r) calculated from the LMOs
obtained using method E shows an unphysical oscillatory behavior which is due to their poor localization and thus
an insuﬃcient cluster size used to construct them.

e

e

12

ϕ2(r) obtained using method M for the two choices of region A: (i) all
FIG. 7: Contour plots of the LMO partial densities
AOs of the two central Si atoms (solid line) and (ii) only {s, px, py} AOs (dashed lines). The plots are calculated in the plane
passing through the Si atoms and two of their nearest neighbors (all four atoms are indicated).

e

IV. DISCUSSION AND CONCLUSIONS

We have seen in the previous section that for an ionic system such as MgO all localization procedures give identical
results and do not require large cluster sizes. This is because a natural localization takes place in those systems. In
fact we ﬁnd that practically identical LMOs can be obtained for MgO using methods M and P if in addition to the
AOs centered on the central O atom one also adds AOs of any of the nearest Mg atoms to deﬁne region A. This
means that these localization procedures are suﬃciently ﬂexible in terms of the AOs used to deﬁne the localization
regions.

We ﬁnd that the localization procedures for covalent system with strong hybridization in its chemical bonding are
more sensitive to the choice of the localization region and the particular localization method. We have seen above
that method E fails for this system since the LMOs it produces are not suﬃciently localized within the cluster sizes
we use.

We have also experimented with localization methods M and P by trying to use diﬀerent deﬁnitions of region A in
order to ﬁnd the LMO. First of all, we used all AOs on the two central Si atoms. Similarly to the case of MgO, in
this case an LMO practically identical to the one which we calculated using only s and pz types AOs was obtained.
ρ densities calculated in these two cases are also the same as is demonstrated in Fig. 6 (b) by the good matching
The
ρsz. The two methods succeeded since the chemical bonding is essentially correctly
between
ϕ2(r) associated
reproduced by either choice of region A. This is conﬁrmed by the contour plot of the partial density
with the LMO and calculated using all AOs centered on the two central Si atoms: as shown in Fig. 7, the LMO
essentially corresponds to the Si-Si bond.

ρsxyz and

ρ ≡

ρ ≡

e

e

e

e

e

e

In contrast, when assuming a wrong character of the chemical bonding in Si, we obtained LMOs which were either
not very well localized or had completely unexpected (unphysical) spatial distribution. For instance, assuming atomic
character of the chemical bonding, we attempted to use AOs on a single Si atom to deﬁne the single localization
region in the primitive cell. This assumption gave four LMOs similarly to the MgO case. We ﬁnd, however, that
ρ1 is very diﬀerent from
these LMOs become much less localized and, as a result, the constructed electron density
ρsz as is obvious from Fig. 6 (b). Another example of an “unwise” choice of the localization region is to use only
s, px and py AOs of the two central Si atoms to deﬁne region A (recall that the two Si atoms are positioned along
e
ρsz, but,
the z axis). In this case the total electron density
at the same time, reproduces all its main features. However, the LMO itself appears to have a completely diﬀerent
spatial distribution (see Fig. 7): it is not anymore localized on the Si-Si bond, but instead was found to be delocalized
over a large volume around it. This explains why the total density
ρsxy was found quite diﬀerent from the reference
one: much larger cluster should be considered to accommodate fully the LMO obtained using this particular choice
of region A. Therefore, the proper choice of the localization regions which reﬂect the chemistry of the given crystal
results in more localized orbitals and thus much smaller cluster sizes needed to construct them.

ρsxy also shown in Fig. 6 (b) somewhat diﬀers from

ρ ≡

ρ ≡

e

e

e

e

e

e

Concluding, a simple method based on a cluster approach was suggested in order to construct localized molecular
orbitals (LMOs) for a periodic solid. Our method does not require usage of periodic codes, is thus much easier to

13

implement in practice and also, in addition, can also be applied to nonperiodic systems. The work in this direction is
presently in progress and will be published elsewhere.

Several localization procedures were analyzed and two crystals were considered in detail (MgO and Si) which
corresponds to the two cases of extreme types of chemical bonding - ionic and covalent. We ﬁnd that two localization
procedures considered, one based on the Mulliken populations (method M) and another on a projection operator
(method P), give well localized orbitals with the expected conventional meaning adopted in chemistry using already
quite moderate cluster sizes. The third procedure, based on the minimization of the HF energy of a structural
element (one or two atoms) demonstrated a much slower convergence with the cluster size and is found to be also
computationally expensive.

Two cases considered here, MgO and Si crystals, have a well known type of chemical bonding and thus the choice
of the localization regions in these two cases was obvious. At the same time, we ﬁnd that there is a certain degree
of ﬂexibility in choosing the localization regions and this can be exploited in the cases of more complicated (e.g.
intermediate) types of chemical bonding. This work is being done in our laboratory at present and will be a matter
for future publications.

Acknowledgments

We are extremely grateful to I. V. Abarenkov and A. Shluger for a number of useful and stimulating discussions
during his stay in London. O.D. would also like to acknowledge the ﬁnancial support from the Leverhulme Trust
(grant F/07134/S) which made this work possible.

[1] A. M. Stoneham, Theory of Defects in Solids (Clarendon, Oxford, 1975).
[2] R. M. Lambert and G. Pacchioni, editors, Chemisorption and Reactivity on Supported Clusters and Thin Films, Series E,

[3] R. Dovesi et al., CRYSTAL98 User’s Manual (University of Torino, Torino, 1998).
[4] C. Pisani, R. Dovesi, and C. Roetti, Hartree-Fock Ab Initio Treatment of Cryslalline Systems (Lecture Notes in Chemistry

NATO ASI Vol. 331, Kluwer, 1997.

48, Springer, Berlin, 1988).

[5] M. C. Payne, M. P. Teter, D. C. Allan, T. A. Arias, and J. D. Joannopoulos, Rev. Mod. Phys. 64, 1045 (1992).
[6] R. G. Parr and W. Yang, Density-Functional Theory of Atoms and Molecules (Oxford Univ. Press, New York, 1989).
[7] M. D. Segall, J. Phys. Cond. Matter 14, 2957 (2002).
[8] D. Bakowies and W. Thiel, J. Phys. Chem. 100, 10580 (1996).
[9] J. Sauer and M. Sierka, J. Comp. Chem. 21, 1470 (2000).
[10] R. J. Hall, S. A. Hinde, N. A. Burton, and I. H. Hillier, J. Comp. Chem. 21, 1433 (2000).
[11] X. Assfeld and J.-L. Rivail, Chem. Phys. Letters 263, 100 (1996).
[12] R. B. Murphy, D. M. Philipp, and R. A. Freisner, J. Comp. Chem. 21, 1442 (2000).
[13] L. N. Kantorovich, J. Phys. C: Solid State Phys. 21, 5041 (1988).
[14] L. N. Kantorovich, J. Phys. C: Solid State Phys. 21, 5057 (1988).
[15] L. S. Seijo and Z. Barandiaran, Intern. J. Quant. Chem. 60, 617 (1996).
[16] T. Bredow, Int. J. Quant. Chem. 75, 127 (1999).
[17] P. V. Sushko, A. L. Shluger, and C. R. A. Catlow, Surf. Science 450, 153 (2000).
[18] V. Sulimov, P. Sushko, A. Edwards, A. Shluger, and A. Stoneham, Phys. Rev. B 66, 024108 (2002).
[19] V. Nasluzov et al., J.Chem.Phys. 115, 8157 (2001).
[20] I. V. Abarenkov and I. I. Tupitsyn, J. Chem. Phys. 115, 1650 (2001).
[21] I. V. Abarenkov and I. I. Tupitsyn, Russ. J. Phys. Chem. 75, 1485 (2001).
[22] T. Vreven and K. Morokuma, J. Comp. Chem. 21, 1419 (2000).
[23] I. V. Abarenkov et al., Phys. Rev. B 56, 1743 (1997).
[24] R. McWeeny, Methods of Molecular Quantum Mechanics (Academic Press, London, 1992).
[25] R. McWeeny, Rev. Mod. Phys. 32, 335 (1960).
[26] L. N. Kantorovich and B. P. Zapol, J. Chem. Phys. 96, 8420 (1992).
[27] L. N. Kantorovich and B. P. Zapol, J. Chem. Phys. 96, 8427 (1992).
[28] E. K. Shidlovskaya, Int. J. Quant. Chem. 89, 349 (2002).
[29] A. Fornili, M. Sironi, and M. Raimondi, J. Mol. Struct. (Theochem) 632, 157 (2003).
[30] Y. Mo and J. Gao, J. Comp. Chem. 21, 1458 (2000).
[31] N. Marzari and D. Vanderbilt, Phys. Rev. B 56, 12847 (1997).
[32] C. Zicovich-Wilson, R. Dovesi, and V. Saunders, J. Chem. Phys. 115, 9708 (2001).
[33] O. Chalwet, R. Daudel, and J. P. Malrieu, editorsLocalisation and Delocalisation in Quantum Chemistry Vol. 1 (Reidel,

Dordrecht, 1975).

14

[34] C. Edmiston and K. Ruedenberg, Rev. Mod. Phys. 35, 457 (1963).
[35] W. von Niessen, J. Chem. Phys. 56, 4290 (1971).
[36] J. L. Whitten and T. A. Pakkanen, Phys. Rev. B 21, 4357 (1980).
[37] T. L. Gilbert, In: Molecular orbitals in chemistry, physics and biology, p. 405, Academic, New York, 1964.
[38] H. Stoll, G. Wagenblast, and H. Preuss, Theor.Chim.Acta 57, 169 (1980).
[39] I. Mayer, J. Phys.: Chem. 100, 6249 (1996).
[40] R. S. Mulliken, J. Chem. Phys. 49, 497 (1949).
[41] V. Magnasco and A. Perico, J. Chem. Phys. 47, 971 (1967).
[42] K. Roby, Mol. Phys. 27, 81 (1974).
[43] R. F. W. Bader, Atoms in Molecules: A Quantum Theory (Oxford University Press, Oxford, 1990).
[44] J. Pipek and P. G. Mezey, J. Chem. Phys. 90, 4916 (1989).
[45] J. M. Foster and S. F. Boys, Rev. Mod. Phys 32, 300 (1960).
[46] N. Anikin, V. Bugaenko, M. Frash, L. Gorb, and J. Leszczynski, J. Comp. Chem. 24, 1132 (2003).
[47] W. H. Adams, J. Chem. Phys. 37, 2009 (1962).
[48] I. V. Abarenkov and A. I. M., Int. J. Quant. Chem. 96, 263 (2004).
[49] M. F. Guest et al., GAMESS-UK, a package of ab initio programs, , nrcc software catalog, vol. 1, program no. qg01 ed.,

1980.

[50] C. Melius and W. Goddard III, Phys.Rev.A 10, 1528 (1974).
[51] L. N. Kantorovich, J. Holender, and M. J. Gillan, Surf. Sci. 343, 221 (1995).
[52] P. J. Hay and W. R. Wadt, J. Chem. Phys. 82, 270 (1985).
[53] R. Nada, C. R. A. Catlow, R. Dovesi, and V. R. Saunders, Proc. R. Soc. London, Ser. A 436, 499 (1992).

