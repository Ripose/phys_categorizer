7
0
0
2
 
n
a
J
 
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
1
3
0
1
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Coarse-grained analysis of a lattice Boltzmann model for planar streamer fronts

Wim Vanroose,∗ Giovanni Samaey, and Pieter Van Leemput
Department of Computer Science, Katholieke Universiteit Leuven, Celestijnenlaan 200A, B-3001 Heverlee, Belgium

We study the traveling wave solutions of a lattice Boltzmann model for the planar streamer fronts
that appear in the transport of electrons through a gas in a strong electrical ﬁeld. To mimic the
physical properties of the impact ionization reaction, we introduce a reaction matrix containing
reaction rates that depend on the electron velocities. Via a Chapman–Enskog expansion, one is able
to ﬁnd only a rough approximation for a macroscopic evolution law that describes the traveling wave
solution. We propose to compute these solutions with the help of a coarse-grained time-stepper,
which is an eﬀective evolution law for the macroscopic ﬁelds that only uses appropriately initialized
simulations of the lattice Boltzmann model over short time intervals. The traveling wave solution is
found as a ﬁxed point of the sequential application of the coarse-grained time-stepper and a shift-
back operator. The ﬁxed point is then computed with a Newton-Krylov Solver. We compare the
resulting solutions with those of the approximate PDE model, and propose a method to ﬁnd the
minimal physical wave speed.

I.

INTRODUCTION

When a gas of neutral atoms or molecules is exposed
to a strong electrical ﬁeld, a small initial seed of electrons
can lead to an ionization avalanche. Indeed, the seed elec-
trons are accelerated by the ﬁeld and gain enough energy
to ionize the neutral atoms when they collide. The two
slow electrons that emerge from this reaction, i.e. the
impact and the ionized electron, are again accelerated by
the ﬁeld and cause, on their turn, an ionization reaction.
Simultaneously the electrical ﬁeld is locally modiﬁed be-
cause of the charge creation. This interplay between the
dynamics of the electrons and the electrical ﬁeld can lead
to a multitude of phenomena studied in plasma physics
such as arcs, glows, sparks and streamers.

In this article we will focus on the initial ﬁeld driven
ionization that can lead to traveling waves known as
streamer fronts. These waves have previously been stud-
ied by Ebert et al. [1] who introduced and analyzed the
minimal streamer model, a one-dimensional model for
the propagation of planar streamer fronts. This model
consists of two coupled non-linear PDEs: a reaction-
convection-diﬀusion equation for the evolution of the
electron density and a Poisson-like evolution equation
for the electrical ﬁeld. The reaction term is based on
the Townsend approximation that expresses the growth
of the number of electrons as a function of the local elec-
trical ﬁeld.

During the last two decades, however, a lot of progress
has been made in the microscopic understanding of im-
pact ionization reactions in atomic and molecular sys-
tems. In this reaction an impact electron ionizes the tar-
get and kicks out an additional electron. There are sev-
eral successful theories that can predict the exact prob-
ability distribution of the escaping electron [7, 8, 9, 10].
In the next decade, we expect that the theoretical tools

∗Present address: Departement Wiskunde-Informatica, Univer-
siteit Antwerpen, Middelheimlaan 1, 2020 Antwerpen, Belgium

will be able to accurately predict the microscopic physics
of electron impact on molecular targets such as N2 and
O2, the most important molecules in the composition of
air. This progress in the understanding of the impact
ionization reaction, however, has not been incorporated
in the description of the macroscopic behavior such as the
minimal streamer front of Ebert et al. Instead, such mod-
els still make use of a phenomenological approximation
to the reactions, such as the Townsend approximation.
This article extends the minimal streamer model and in-
corporates more microscopic information. We model the
system by a Boltzmann equation, which is constructed
such that the cross sections in the collision integral re-
semble the true microscopic cross sections.

To ﬁnd the traveling wave solutions of this more micro-
scopic model, we exploit a separation of time scales be-
tween the relaxation of the electron distribution function
to a local equilibrium and the evolution of the macro-
scopic ﬁelds (electron density and electrical ﬁeld). It is
known from kinetic theory that the ﬁrst process is fast:
once initialized, it takes a molecular gas not more than
a few collisions to relax to its equilibrium state.

In kinetic theory, the fast times scales are often elimi-
nated from the problem by assuming a local equilibrium
distribution function which leads to a reaction-diﬀusion
model with transport coeﬃcients that depend on the lo-
cal electrical ﬁeld. This reduction method, however, is
only successful in the absence of steep gradients in the
electron density [18], an assumption not valid for the
planar streamer fronts that have, typically, very steep
increases in the electron density.

In this article, we take an alternative route and ﬁnd
the traveling wave solution through a so-called coarse-
grained time-stepper (CGTS) that exploits the separation
of time scales to extract the eﬀective macroscopic behav-
ior. This method was proposed by Kevrekidis et al. [5]
and the numerical aspects of its application to ﬁnd trav-
eling wave solutions of lattice Boltzmann models have
recently been studied [3]. The time-stepper uses a se-
quence of computational steps to evolve the macroscopic
state. This sequence involves: (1) a lifting step, which

2

R

20

40

60

Energy (eV)

)
s
t
i
n
u

b
r
a
(

n
o
i
t
c
e
s

s
s
o
r
c

)
s
t
i
n
u

b
r
a
(

n
o
i
t
c
e
s

s
s
o
r
c

0

0

0

0

creates an appropriate electron distribution function for
a given electron density, (2) a simulation step, where
the lattice Boltzmann model is evolved over a coarse-
grained time step ∆T , and (3) a restriction step, where
the macroscopic state is extracted from the electron dis-
tribution function. This method does not derive eﬀec-
tive equations explicitly, and therefore allows steep gra-
dients to be present. We compare our results with those
obtained by deriving an approximate macroscopic PDE
model through the more traditional Chapman-Enskog ex-
pansion. The paper therefore illustrates the applicability
of the coarse-grained time-stepper on a non-trivial prob-
lem where the exact macroscopic equations are hard to
derive.

The outline of the paper is as follows. In section II, we
shortly review the physics of the impact ionization reac-
tion and the streamer fronts, and recapitulate the Boltz-
mann equations. In section III, we derive from the Boltz-
mann equation a lattice Boltzmann model with multiple
velocities and discuss how the ionization reaction, exter-
nal ﬁeld and electron diﬀusion are incorporated in the
model. Section IV derives a macroscopic PDE from the
model using the Chapman-Enskog expansion and dis-
cusses the minimal velocity of the traveling waves. Sec-
tion V formulates the coarse-grained time-stepper and
VI how the traveling wave solutions are found. Finally
in section VII, we have some numerical results.

II. MODEL

A. The physics of the impact ionization reaction

The impact ionization reaction is a microscopic reac-
tion where electrons with, typically, an energy around
50eV collide with an atom or a molecule and ionize this
target. The reaction rates of this process depend sensi-
tively on a number of parameters. Let us consider the
simplest system: an electron hits a hydrogen atom with
a bound electron in its ground state. When the incoming
electron has an energy larger than the binding energy of
the electron in the atom, it can kick out, with a certain
probability, the bound electron that will escape, together
with the impact electron, from the atom. The total en-
ergy of the two electrons after the collision is equal to
the energy of the incoming electron minus the original
binding energy of the bound electron.

The reaction rates of this process are expressed by cross
sections; these are probabilities that a certain event will
take place. One such cross section is the triple diﬀer-
ential cross section, which is the probability to ﬁnd af-
ter the collision one electron escaping in the direction
(θ1, φ1) with an energy E1 and a second electron escap-
ing in the direction (θ2, φ2) with an energy E2, where
the angles are measured with respect to the axis deﬁned
by the momentum of the incoming electron. Since the
two electrons repel each other, it is more likely that they
escape in opposite directions [13].

5

10

15

20

25

Energy (eV)

Figure 1: A sketch of the typical shape of the impact ion-
ization cross section ( see the experimental results in [6]).
On top, we show the total cross section as a function of the
impact energy where below a threshold energy of 25eV no
reactions take place. In the proposed model we distinguish
between slow particles with an energy below this threshold
that do not react and fast particles with their energy above
this threshold. The fast reacting particles experience a cross
section of R, as indicated by the dashed line. In the bottom
ﬁgure, we show the energy diﬀerential cross section for the
escaping electron, where the total energy of the escaping elec-
trons is 25eV. Since the two electrons are indistinguishable
there is a symmetry. In our ﬁve speed model, we make the
approximation that the two electrons can only escape with
equal energy sharing.

When this cross section is integrated over all angles
(θ1, φ1) and (θ2, φ2) of the escaping electrons and all pos-
sible ratios of E1/E2 of the electron energies, we get the
total cross section. This is the total probability that the
incoming electron will cause an ionization event. This
total cross section depends on the energy of the incom-
ing electron and is zero when the energy of the incoming
electron is below the binding energy of the bound elec-
tron. Just above this binding energy, there is a steep
rise in the cross section that is known as a threshold.
Just above this threshold the cross section is the largest
and as we further increase the energy the cross section

diminishes. This is illustrated in ﬁgure 1 (top).

When the cross section is integrated of the angles only,
but not over the relative energies, we get the so called en-
ergy diﬀerential cross section, which is the probability of
causing an ionization event with a given relative energy
of the two electrons. In contrast with the electron direc-
tions, there is no pronounced preference for the energy
sharing between the two electrons, see ﬁgure 1 (bottom).
It is only slightly more likely that two electrons will come
out with unequal energy.

Recently, several theoretical methods have successfully
predicted the directions of the escaping electrons, the to-
tal cross section and the energy diﬀerential cross section
in the hydrogen atom. We name exterior complex scal-
ing [7], time dependent close coupling [8], HRW-SOW [9]
and convergent close coupling [10].

When the electron hits a molecular system instead of
an atom, the physics is complicated by the extra degrees
of freedom. The cross sections now depend on both the
orientation and internuclear coordinates of the molecule
at the moment of electron impact, as is seen in processes
where two electrons are ejected from molecules after it is
hit by a photon [11, 12]. Therefore, there will be some
random terms in the reaction cross section, which will
need to be included in a realistic microscopic model. In
this paper, we will model the microscopic interactions
using a Boltzmann equation, which is still deterministic;
extensions that accurately account for random eﬀects will
be treated in future work. However, we note that the
coarse-grained time-stepper approach that is used in this
work has already been applied successfully to study sys-
tems with stochastic eﬀects [20].

B. Review of the physics of streamer fronts.

Ebert et al. [1] introduced the minimal streamer model.
It consists of two coupled non-linear PDEs: a reaction-
convection-diﬀusion equation for the evolution of the
electron density and an equation that relates the change
in the electrical ﬁeld to the charge ﬂux. The electron den-
sity evolves because of the drift due to the electrical ﬁeld,
the electron diﬀusion and the ionization reaction, which
is formulated in the Townsend approximation. The re-
action rate is then given by an exponential that depends
on the strength of the local electrical ﬁeld. The evolu-
tion of the electrical ﬁeld is determined by Poisson’s law
of electrostatics where the ﬁeld changes because of the
charge creation by the ionization reaction. This minimal
streamer model exhibits both negatively and positively
charged fronts. The ﬁrst moves in the direction of the
electrical ﬁeld, while the positively charged moves in the
opposite direction and can only propagate because of the
electron diﬀusion and the ionization reactions. Each of
these fronts appears as a one-parameter family of uni-
formly translating solutions (since any translate of the
wave is also a solution).

In our extension of the Ebert model, we replace the

3

reaction-diﬀusion equation for the evolution of the elec-
tron density with a Boltzmann equation for the one-
electron distribution function f (x, v, t), that counts the
number of electrons in the phase-space volume element
bounded by position x and x + dx and by speed v and
v + dv. The Boltzmann equation is

∂f (x, v, t)
∂t

+v·

∂f (x, v, t)
∂x

+E(x, t)·

= Ω(x, t),

∂f (x, v, t)
∂v

(1)
where E(x, t) is the external electrical ﬁeld and Ω(x, t)
is the collision operator, an integral operator that inte-
grates the cross sections of the ionization reaction over
the velocity space. This Boltzmann equation is coupled
to an evolution equation for the electrical ﬁeld. Because
additional electrons are created, the local charge density
changes the electrical ﬁeld through the Poisson law

∇ · E(x, t) = q(x, t),

where q(x, t) = (n+ − ne)e/q0 is the charge distribution.
Here, n+ represents the number of ions, ne is the number
of electrons and q0 a unit of charge.

We now connect the change in electrical ﬁeld with the

change in the charge distribution. We have

∂q(x, t)
∂t

+ ∇ · j(x, t) = 0

in which j(x, t) is the charge ﬂux. This leads to an equa-
tion for the evolution of the electrical ﬁeld,

∂E(x, t)
∂t

+ j(x, t) = 0.

(2)

Since we assume that the ions are immobile, the ﬂux
j(x, t) is solely determined by the one-particle distribu-
tion function f (x, v, t) of the electrons.

Our extension of the minimal streamer model is now
the coupled evolution of eq. (1) and (2). Note that the
set of coupled equations is very similar to the Wigner-
Poisson problem [15] used to model electron transport
through diodes.

III. LATTICE BOLTZMANN DISCRETIZATION

Together with the impact ionization cross sections, the
coupled equations (1) and (2) are a non-linear integro-
diﬀerential equation coupled to a scalar partial diﬀeren-
tial equation for the electrical ﬁeld. This equation in its
full dimension is hard to solve, both analytically and nu-
merically. As a ﬁrst step, we look at the one-dimensional
streamer fronts of the Boltzmann equation in the lattice
Boltzmann discretization.

A. Discretization of the Boltzmann equation

where we have introduced the shorthand fi(x, t) for
f (x, vi, t) and Ωi(x, t) for Ω(x, vi, t) with i ∈ S.

4

In this section, we discretize the one-dimensional
Boltzmann equation (1). The distribution functions
f (x, v, t) are discretized on a lattice in space, velocity
and time. The grid spacing is ∆x in space and ∆t in
time. The velocity grid of vi is chosen such that the dis-
tance traveled in a single time step, vi∆t, is a multiple
of the grid distance ∆x, or in short

vi = i

∆x
∆t

,

with

i ∈ S.

Typically, only a small set of discrete velocities is used.
A discretization with three grid points on the velocity
grid has a set S = {−1, 0, 1} and is called a D1Q3
model. A discretization with ﬁve grid points has S =
{−2, −1, 0, 1, 2} and is a D1Q5 model. The size of the set
S is denoted by m. We will also denote ci = vi∆t/∆x
for the dimensionless velocity.

Note that, for ease of notation, we will also use the set
S to index matrices. For example, the result of a linear
operator A working on a vector vj∈S will be denoted as
i∈S Aij vj, where both the indices i and j are in S.
The means that the A−2,−2 matrix element with S =
P
{−2, −1, 0, 1, 2} is the matrix element in the upper left
corner of the matrix.

We start from the continuous equation for the distribu-
tion function in the discrete point (x + vi∆t, vi) in phase
space at time t.
In the absence of external forces, the
Boltzmann equation in this point reads

∂f (x + vi∆t, vi, t)
∂t
= Ω(x + vi∆t, vi, t)

+ vi

∂f (x + vi∆t, vi, t)
∂x

(3)

A discrete lattice Boltzmann equation is now obtained
by replacing the time derivative with an explicit forward
diﬀerence, the introduction of an upwind discretization
of the convection term and a downwind discretization of
the collision term Ω(x + vi∆t, vi, t) and replace it with
Ω(x, vi, t) [14],

f (x + vi∆t, vi, t + ∆t) − f (x + vi∆t, vi, t)
∆t

+vi

f (x + vi∆t, vi, t) − f (x, vi, t)
vi∆t

= Ω(x, vi, t). (4)

Note that this discretization of the spatial derivative
becomes less accurate for the largest speeds in the set
Indeed, in the ﬁve speed model, for example, the
S.
largest speed is v±2 = ±2∆x/∆t, and the convec-
tion term will be calculated from the diﬀerence between
f (x + v±2∆t, v±2, t) and f (x, v±2, t), which is 2∆x apart.
The discretization error is then proportional to 2∆x.

Equation (4) reduces to

B. The collision term

The collision term consists out of two parts

∆tΩi = Ωdiﬀ

i + Ωreaction
i

(6)

where the ﬁrst term will model the electron diﬀusion, the
second term the ionization reactions and the third term
the inﬂuence of the external force. Note that we also
incorporated ∆t in the notation. We will now discuss
the two terms individually.

The ﬁrst term models the electron diﬀusion as a BGK
relaxation process [21].
In this approximation, it as-
sumed that the distribution is attracted to a local equi-
librium distribution function f eq
i

,

Ωdiﬀ

i = −

(fi − f eq

i ) ,

1
τ

(7)

with f eq
diﬀusion. In the ﬁve speed model, we choose

i (x, t) the equilibrium distribution for electron

i = weq
f eq

i ρ with weq

i = {0, 1/4, 2/4, 1/4, 0}

(8)

and ρ(x, t) the electron density. This choice of equi-
librium weights conserves the number of electrons, but
does not conserve momentum as a traditional ﬂuid would
do. Indeed, the electrons diﬀuse because they randomly
change their direction during the elastic collisions with
the much heavier neutral molecular particles. We fur-
ther chose the weights such that there are no fast parti-
cles under diﬀusive equilibrium. The relaxation time τ is
related to the electron diﬀusion coeﬃcient

τ =

+

1
2

D
i∈S c2

i weq

i

∆t
∆x2 .

(9)

Note that, in the literature, the relaxation time τ is often
characterized by its inverse ω = 1/τ .

The second term in (6) is the reaction term Ωreaction

P

i

that is modelled with a m × m matrix R

Ωreaction

i

= ∆t

Rijfj,

(10)

j∈S
X

which represents the velocity dependent reaction rates
and allows us to select between slow and fast particles.

For the ﬁve speed model, we choose a reaction matrix

−R 0 0 0 0
R 0 0 0 R
0 0 0 0 0
R 0 0 0 R
0 0 0 0 −R








R = 





(11)

fi(x + vi∆t, t + ∆t) − fi(x, t) = ∆t Ωi(x, t),

(5)

that describes how the reaction cross sections depend on

the velocities of the particles. Each time step ∆t, a frac-
tion R of the particles with speed v±2 will collide and
cause a ionization reaction. The reaction rate R is cho-
sen to match the height of the cross section, see ﬁgure
1. Since the colliding fast particles transfer their energy
to the bound electron, they will loose energy. There-
fore, the number of particles with speed v±2 diminishes
with a rate −R∆t and we have R−2,−2 = R+2,+2 = −R.
At the same time, the number of slow electrons increases
because both the impact electron and the ionization elec-
tron emerge as slow particles with speed v±1. Because of
the Coulomb repulsion, the two slow electrons are more
likely to emerge in opposite directions and we choose the
rates such that one electron emerges with speed of v−1
and the other with v+1.

This choice of model parameters ensures that the en-
ergy balance during the ionization reaction is not vio-
lated. As discussed in section II A, the energy of the
incoming electron is larger that the sum of the energies
of the escaping electrons because some of the impact en-
ergy covers the binding energy of the bound electron. In
the above model, a single ionization reaction transforms
one electron with speed v+2 into two electrons with, re-
spectively, speed v+1 and speed v−1. The energy of the
impact electron is mv2
+2/2 = 2m∆x/∆t, while the sum
of the escaping electrons is merely 2mv2
1/2 = m∆x/∆t,
where m is the mass of the electron.
So a portion
m∆x/∆t of the impact energy covers the binding energy.
For our model, this is half of the initial impact energy;
for more general problems other values are possible.

We now derive a discretization of the E ∂fi

∂v term that
models the external force in the Boltzmann equation. We
start by expanding

∂f
∂v

= a0v0 + a1v1 + . . . + am−1vm−1,

where V = {v0, v1, . . . , vm−1} forms a linear indepen-
dent set of vectors in Rm. We ﬁnd the coeﬃcients
a0, a1, . . . , am−1 by enforcing the Galerkin condition.

∂f
∂v

−

 

m−1

i=0
X

aivi

⊥ V

!

In the current paper, we choose a particular set of vec-
tors in V, namely the polynomials {1, v, v2, . . . , vm−1}
discretized in the points vi. For the ﬁve speed example
the vectors are, besides their powers of ∆x/∆t,

−2
−1
0
1
2

1
1
1
1
1








, 





4
1
0
1
4








, 












, 





−8
−1
0
1
8








, 





16
1
0
1
16










V = 










5

The Galerkin condition leads to the linear system



m 0 α 0 β
0 α 0 β 0
α 0 β 0 γ
0 β 0 γ 0
β 0 γ 0 δ







i ,β =





= 













i∈S v4
i , γ =

i∈S v2

a0
a1
a2
a3
a4

∂v

∂v

0 · ∂f
vt
1 · ∂f
vt
2 · ∂f
vt
3 · ∂f
vt
4 · ∂f
vt

∂v



(12)

∂v

∂v






i∈S v6
i and δ =





where α =
i∈S v8
i .

P

P

P

To calculate the right-hand side of (12) we make a
P
detour around the continuous representation. We note
that

vt
l ·

∂f
∂v

=

+∞

−∞

Z

vl ∂f (x, v, t)
∂v

dv,

(13)

where l ∈ {0, 1, . . . , m − 1}. Because of our particular
choice of basis vectors and the fact that there are no
particles with inﬁnite velocities, we have that

+∞

−∞

Z

vl ∂f (x, v, t)
∂v

+∞

−∞

Z

dv +

f (x, v, t)

dv

∂vl
∂v

= vlf (x, v, t)|+∞

−∞ = 0

(14)

or, in other words,

f (x, v, t)vl−1dv

vt
l ·

∂f
∂v

= −i

= −l

+∞

−∞

Z

j∈S
X

vl−1
j

fj

(15)

0
−1

0
−1

0
−1

0
−1
−2v−2 −2v−1 −2v0 −2v1 −2v2
2
2 −3v0
1 −3v2
−3v−2
3 −4v0
1 −4v2
−4v−2

2 −3v−1
3 −4v−1

2 −3v2
3 −4v3

0
−1

3

N = 




we can now deﬁne



,

(16)






4

4

3 v−2
2 v−2
1 v−2 v−2
3 v−1
2 v−1
1 v−1 v−1
4
3
2
v0
v0
v0
1 v0
v1
v1
v1
1 v1
v2
v2
v2
1 v2

3

2

2

3

4

4

m 0 α 0 β
0 α 0 β 0
α 0 β 0 γ
0 β 0 γ 0
β 0 γ 0 δ

−1

N,








(17)















V =





and calculate the external force term as

E(x, t)

∂fi(x, t)
∂v

= E(x, t)

Vij fj(x, t),

(18)

j∈S
X

where the elements of S denote matrix elements.

From eq. (18), it is clear that we can include the exter-
nal force as an additional collision term in the right-hand
side of the lattice Boltzmann equation.

C. External Force

With the help of

D. Flux

The evolution of the electrical ﬁeld E(x, t) is deter-
mined by the net ﬂux j(x, t) of electrons as expressed in
(2). We discretize (2) on a staggered grid with grid points
halfway between the grid points of the lattice Boltzmann
model. The ﬂux is deﬁned as the number of particles
that move between grid points (pass through an inter-
face) within a single time step. For the ﬁve speed model,
we have

j(x + ∆x/2, t) = f1(x + ∆x, t) − f−1(x, t)
+f2(x + ∆x, t) − f−2(x, t)
+f2(x + 2∆x, t) − f−2(x − ∆x, t)

(19)

E. Coupled equations

The coupled equations (1) and (2) for the evolution of
the electron distribution functions and the electrical ﬁeld
is now, after discretization,

fi(x + vi∆t, t + ∆t) − fi(x, t) =

−

1
τ

fi(x, t) − f eq

i (x, t)

+

∆tRij fj(x, t)

(cid:0)

j∈S
X
(E(x − ∆x/2, t) + E(x + ∆x/2, t))
2

(cid:1)

−

∆tVij fj(x, t)

j∈S
X

(20)

E(x+

, t+∆t) = E(x+

, t)−∆tj(x+

, t), (21)

∆x
2

∆x
2

∆x
2

where j(x + ∆x/2, t) is calculated from (19). The equa-
tions are coupled because the electrical ﬁeld appears as an
external force in the ﬁrst equation, while the ﬂux drives
the evolution of the electrical ﬁeld in the second equa-
tion. This coupling makes the evolution of the system
non-linear.

IV. A PDE MODEL THROUGH
CHAPMAN-ENSKOG EXPANSION

The model (20)–(21) evolves the electrical ﬁeld E(x, t)
and the distribution functions fi∈S(x, t) from t to t +
∆t simultaneously. Alternatively, the evolution of the
distribution functions can be rewritten in terms of the
corresponding (dimensionless) velocity moments deﬁned
as

̺l(x, t) =

cl
ifi(x, t),

(22)

i∈S
X
where l ∈ {0, 1, . . . , m−1}. The zeroth moment ̺l=0(x, t)
corresponds to the electron density ρ(x, t), i.e. the macro-

6

(23)

scopic variable of interest. The transformation between
distribution functions fi and moments ̺l can be written
as a matrix transformation M . In the ﬁve speed model,
this matrix is

1

1 1 1 1
−2 −1 0 1 2
1 0 1 4
−8 −1 0 1 8
1 0 1 16
16

4

M = 











m−1
l=0

M −1

il̺l.
(cid:1)

such that ̺l =

i∈S Mlifi and fi =

P

An evolution law for ̺l(x, t) is now easily constructed
by the following sequence: ﬁrst transform ̺l into fi(x, t)
using M −1, then use the lattice Boltzmann equation (20)
to evolve fi(x, t) to fi(x, t+∆t) and, then, transform back
to the moments ̺l(x, t + ∆t).

P

(cid:0)

It has been observed phenomenological that the ion-
ization wave can approximately be described by a PDE
in the density. This suggests that, in practice, the evo-
lution of these moments is rapidly attracted to a low
dimensional manifold described by the lowest moment
̺0(x, t), which is the density. The higher order moments
have then become functional of this density and the dy-
namics of the system can eﬀectively be described by the
evolution of this macroscopic moment.

In general, however, it is very hard to ﬁnd analytic ex-
pressions for this low dimensional description in the form
of a PDE without making crude approximations. For the
problem at hand, we illustrate these diﬃculties in this
section where we apply the Chapman-Enskog expansion
and derive a macroscopic PDE in terms of electron den-
sity. Only after dropping several coupling terms, a closed
PDE is derived.

The model discussed in the previous sections can be

summarized by the lattice Boltzmann equation

fi(x + ci∆x, t + ∆t) − fi(x, t) =

−

1
τ

(fi(x, t) − f eq

i (x, t)) +

Aij fj(x, t) ,

(24)

j∈S
X

for ∀i ∈ S. Here, Aij can be the reaction term Rij , a
force term Vij , or a combination of both.

A second order Taylor expansion of the term fi(x +

ci∆x, t + ∆t) in (24) around fi(x, t) leads to

ci∆x

+ ∆t

+

∂fi
∂x

∂fi
∂t

+ci∆x∆t

= −

1
τ

∆t2
2

+

∂2fi
∂x∂t
(fi − f eq

i ) +

∂fi
∂x2

i ∆x2
c2
2
∂2fi
∂t2

j∈S
X

Aij fj,

∀i ∈ S. (25)

We then expand fi in terms of increasingly higher order
contributions as follows

fi = f (0)

i + ǫf (1)

i + ǫ2f (2)

i + . . .

(26)

with ǫ a small tracer parameter.
In ﬂuid dynamics, ǫ
typically refers to the Knudsen number. The spatial and
time derivatives are scaled respectively as

∂
∂t

=

∂
∂t0

+ ǫ

∂
∂t1

+ ǫ2 ∂
∂t2

and

∂
∂x

= ǫ

∂
∂x1

,

(27)

where we explicitly presume that a zeroth order time
scale t0 is present in the system. As we will show later
on, this scale corresponds to the observed exponential
growth of the electron density.

Because of the multiple time scales t0, t1 and t2, all the
terms in the expansion will couple to all the time scales,
which complicates the derivation of an eﬀective equation.
In our search for a reduced second order PDE model,
we only keep the terms up to second order in ǫ2. For the
same reason, we also drop the second derivative w.r.t.
time from (25). Substitution of (26) and (27) into (25)
leads to

∂f (0)
i
∂x
∂f (0)
i
∂t0
∂f (0)
i
∂t1

ǫci∆x

+ ǫ2ci∆x

+∆t

+ ǫ∆t

+ ǫ2∆t

∂2f (0)
i
∂x2

∂f (1)
i
∂x

∂f (1)
i
∂t0
∂f (1)
i
∂t1

i ∆x2
+ ǫ2 c2
2
∂f (2)
i
∂t0
∂f (0)
i
∂t2
∂2f (1)
i
∂x∂t0

+ǫ∆t

+ ǫ2∆t

+ ǫ2∆t

+ǫci∆x∆t

+ ǫ2ci∆x∆t

∂2f (0)
i
∂x∂t0
∂2f (0)
i
∂x∂t1
i + ǫf (1)
f (0)

+ǫ2ci∆x∆t

= −

1
τ

(cid:16)

Aij

+

j∈S
X

(cid:16)

i + ǫ2f (2)

i − f eq

i

j + ǫf (1)
f (0)

j + ǫ2f (2)

j

(cid:17)

(cid:17)

7

and are found as the the solution of the linear system

(1 − τ Aij ) f (0)

j = f eq

i

.

(30)

j∈S
X

Since f eq
i = w(0)
f (0)

i = wiρ (8) only depend on the density, we ﬁnd
i ρ with the weights w(0)

deﬁned by

i

w(0)

i =

(1 − τ A)

−1

weq
j .

(31)

j∈S (cid:16)
X

ij

(cid:17)

Since the matrix A can include the ionization reac-
tion that does not conserve the particle number, the
i∈S w(0)
sum of the weights
is not necessarily equal
6= ρ. We choose
to one. This means that
to rescale the weights w(0)
i with a normalization factor
such that
N =

P
(1 − τ A)

i∈S f (0)

P

i∈S w(0)

i =

weq
j

i,j∈S

−1

i

i

i∈S f (0)
P

i = ρ. With this rescaling we ﬁnd the zeroth

P

(cid:16)

order term of the Chapman-Enskog expansion
P

i = w(0)
f (0)

i ρ =

1
N

j∈S (cid:16)
X

(1 − τ A)

−1

weq
j ρ

(32)

ij

(cid:17)

ij

(cid:17)

The rescaling, however, forces us to reconsider equa-
tion (30) because f (0)
, as deﬁned above, fails to be a
solution. Still, we keep our f (0)
of (32) as our zeroth-
order term and ﬁnd for the evolution of the system at
time scale t0

i

i

(28)

∆t

∂f (0)
i
∂t0

= −

1
τ

(1 − τ Aij ) f (0)

j +

f eq
i

1
τ

We will now group the terms order by order and derive
and f (2)
expressions for f (0)
and the corresponding
evolution equations for ρ at the diﬀerent time scales.

, f (1)
i

i

i

We will use the fact that if ∆t and ∆x2 are of the same
order of magnitude — which is the case for our examples
— the terms that have factors as ∆t∆x are eﬀectively of
order ∆x3 and can be neglected compared to terms with
∆t or ∆x2.

= −

(1 − τ Aij )

j∈S
X

1
τ

j∈S
X

1
N

=

1 −

1
τ
(cid:18)
= αf eq
i ∆t,

f eq
i

(cid:19)

where the growth factor is

1
N

k∈S
X

(cid:16)

(1 − τ A)

−1

f eq
k +

f eq
i

1
τ

jk

(cid:17)

(33)

1. Zeroth order contribution

α = (1 − 1/N )/(τ ∆t).

(34)

From expansion (28), we collect the zeroth order terms

Summation of (33) over the set S leads to the zeroth

order PDE for the evolution of ρ

∆t

∂f (0)
i
∂t0

= −

1
τ

f (0)
i − f eq

i

+

Aij f (0)
j

.

(29)

(cid:16)

(cid:17)

j∈S
X

∂ρ
∂t0

= αρ.

(35)

We choose f (0)
such that the right-hand side of (24) is
zero; these distributions will not evolve on time scale t0

i

This is a growth equation if α is positive, which is the
case for the ionization reaction.

2. First order contribution

3. Second order contribution

8

To derive the ﬁrst order equation, we collect the terms

that are ﬁrst order in ǫ from (28)

∂f (0)
i
∂x

+ ∆t

∂f (1)
i
∂t0
∂2f (0)
i
∂x∂t0
(1 − τ Aij ) f (1)

+ ci∆t∆x

j

.

ci∆x

+∆t

∂f (0)
i
∂t1
1
τ

= −

j∈S
X

(36)

We drop the term ci∆t∆x∂2f (0)
i /(∂x∂t0) because it is of
order ∆t∆x, which is smaller than the other terms that
are ﬁrst order in ∆t or ∆x. The second term we neglect
is ∆t∂f (1)
i /∂t0 because we will show below, a postiori,
that it is also of order ∆t∆x.

We now have

ci∆x

+ ∆t

∂f (0)
i
∂x

∂f (0)
i
∂t1

=

−

+ Aij

f (1)
j

1
τ

(cid:19)

j∈S (cid:18)
X

what leads to a ﬁrst order term

.

(cid:17)

−1

ij  

+ ∆t

cj∆x

j∈S (cid:16)
X

f (1)
i =

(−1/τ + A)

∂f (0)
j
∂x

∂f (0)
j
∂t1 !
(37)
We now see that it is justiﬁed to neglect the term
∆t∂f (1)
i /∂t0 in (36) because it is of order ∆t∆x. Using
(32) and
i = 0 (the latter because
i∈S fi =
i∈S f (0)
i + ǫ2f (2)
i = ρ),
P
we ﬁnd the following PDE at time scale t1 for the evolu-
(cid:17)
P
tion of the system

i∈S f (1)
i + ǫf (1)
f (0)
P
(cid:16)

= ρ and

P

i∈S

i

∂ρ
∂t1

+ C

= 0,

∂ρ
∂x

where the advection coeﬃcient c equals

C =

i,j∈S

P

(cid:16)
i,j∈S

P

(cid:16)

(−1/τ + A)

−1

(−1/τ + A)

cjw(0)
j

w(0)
j

∆x
∆t

.

ij

(cid:17)
−1

ij

(cid:17)

(38)

(39)

f (1)
i =

(−1/τ + A)

−1

w(0)(cj ∆x − C∆t)

j∈S (cid:16)
X

ij

(cid:17)

∂ρ
∂x

.

(40)

Finally, we derive the second order evolution. We col-

lect from (28) the second order terms and ﬁnd

+∆t

+ ∆t

+ ci∆t∆x

∂2f (0)
i
∂x2 + ∆t

∂f (2)
i
∂t0
∂2f (1)
i
∂x∂t0

ci∆x

+

∂f (1)
i
∂x
∂f (1)
i
∂t1
∂2f (0)
i
∂x∂t1

i ∆x2
c2
2
∂f (0)
i
∂t2
1
τ

= −

j∈S
X

+ci∆t∆x

(1 − τ Aij ) f (2)

j

(41)

terms

i / (∂x∂t1),

∂2f (1)
i / (∂x∂t0),
i /∂t1 (when replacing f (1)

∂2f (0)
and
The
∂f (1)
by (37)) are of order
∆t∆x, which is smaller than ∆x2 for our parameter
settings. We also neglect ∆t∂f (2)
i /∂t0 because it can be
shown, again a postiori, that it is of order ∆t∆x.
The second order expansion term then becomes

i

+

i ∆x2
c2
2

∂2f (0)
i
∂x2

(1 − τ Aij ) f (2)

,

j

(42)

+∆t

= −

∂f (0)
i
∂t2

ci∆x

∂f (1)
i
∂x
1
τ

j∈S
X
and f (0)

i

When replacing f (1)

i

by (40) and (32), we get

ci∆x

(−1/τ + A)

−1

(cj∆x − C∆t)

∂2ρ
∂x2

j∈S (cid:16)
X

w(0)
j

ij

(cid:17)
i ∆x2w(0)
c2
2

i

+

= −

1
τ

j∈S
X

∂2ρ
∂x2 + ∆tw(0)

∂ρ
∂t2
(1 − τ Aij ) f (2)

i

j (43)

and the expression for the second order term becomes

f (2)
i =

Bijcj

Bjk (ck∆x − C∆t) ∆xw(0)
k

j∈S
X

+

j∈S
X
j w(0)

j

Bijc2

∆x2
2

∂2ρ
∂x2

+

Bijw(0)

j ∆t

∂ρ
∂t2

,

j∈S
X

j∈S
X

∂2ρ
∂x2

(44)

where we use Bij =

(−1/τ + A)−1

(cid:0)

ij . If we deﬁne
(cid:1)

i,j,k∈S
X





+

k,i∈S
X

Bijc2

j w(0)

j ∆x2/2

Bij w(0)

j ∆t

,

/

−









i,j∈S
X





With the help of (38), the ﬁrst order contribution (37)
can be written alternatively as

D =

BijcjBjk (ck∆x − C∆t) ∆xw(0)
k

(45)

9

0.2

0.4

0.6

0.8

1

Electric ﬁeld |E|

0.2

0.4

0.6

0.8

1

Electric ﬁeld |E|

0.05

0.04

0.03

0.02

0.01

r
o
t
c
a
f

h
t
w
o
r
g

0

0

0

t
n
e
i
c
ﬃ
e
o
c

n
o
i
t
c
e
v
d
a

−0.25

−0.5

−0.75

−1

0

1.004

1.003

1.002

1.001

t
n
e
i
c
ﬃ
e
o
c

n
o
i
s
u
ﬀ
i
d

1

0

we obtain the evolution at time scale t2 (because

f (2)
k = 0)

P

∂ρ
∂t2

= D

∂2ρ
∂2x

,

(46)

where D acts as a diﬀusion coeﬃcient.

We are now in the position to combine the evolution at
the diﬀerent timescales t0, t1 and t2 into a single PDE.
Because the matrix A of the model equation (24) con-
tains both the reaction term and the external force, the
transport coeﬃcients α, C and D will depend on the local
electrical ﬁeld E(x, t). For our example the dependence
of the transport coeﬃcients is shown in ﬁgure 2, we ﬁnd
that D hardly depends on the strength of the ﬁeld and
can be set equal to the electron diﬀusion D used in (9)
to deﬁne the relaxation of the lattice Boltzmann model.
In a similar way, we ﬁnd that c, the transport coeﬃcient
of the advection term, is approximately equal to the −E,
the local electrical ﬁeld that causes the drift. Only the
growth factor α, deﬁned in (34), depends on the strength
of the local electrical ﬁeld. With the help of these obser-
vations we get the coupled PDE

∂ρ
∂t
∂E
∂t

= α(E(x, t))ρ + E(x, t)

+ D

∂ρ
∂x

∂2ρ
∂x2

= −E(x, t)ρ − D

(47)

∂ρ
∂t

for the evolution of E(x, t) and ρ(x, t). The second equa-
tion expresses the ﬂux with the help of the transport
coeﬃcients.

These coupled equations are similar

to minimal
streamer model of Ebert, Van Saarloos and Caroli [1],
except that the growth rate is now deﬁned by (34) in-
stead of the Townsend approximation.
In ﬁgure 2, we
illustrate how the growth coeﬃcient depends on the lo-
cal electrical ﬁeld and compare with a Townsend ap-
proximation. We ﬁnd that a Townsend reaction term
0.111 · |E| exp(−1/|E|) approximately describes a similar
growth term as the PDE model derived from the lattice
Boltzmann model.

4. Traveling wave solutions

The system (47) is non-linear and it is well-known
that it has a one-parameter family of front solutions that
translate uniformly with a speed c [2]. There is a minimal
speed c∗ that is usually found by looking at the asymp-
totic region → +∞.
In this limit, the electrical ﬁeld
becomes constant and is denoted by E+ — the same
notation as in [1] — and the equation for the electron
density becomes

0.2

0.4

0.6

0.8

1

Electric ﬁeld |E|

Figure 2:
Top: The growth factor α(E) (solid) of the
PDE model derived from the lattice Boltzmann model. The
growth depends on the strength of the local electrical ﬁeld
and is similar to the Townsend approximation with 0.111 ·
|E| exp(−1/|E|)(dashed). We have a reaction rate R = 100
and model parameters given in section VII. Middle: The ad-
vection coeﬃcient C is equal to the external ﬁeld −E. Bottom:
The diﬀusion coeﬃcient D only changes with the external ﬁeld
in the fourth signiﬁcant ﬁgure.

where the transport coeﬃcients have become constants.
In a co-moving coordinate frame that travels with the
same speed c along the x-axis, we deﬁne ξ = x − ct.
The PDE (48) becomes stationary and the solution in
the asymptotic region ﬁts

∂ρ
∂t

= α(E+)ρ + E+ ∂ρ
∂x

+ D

∂2ρ
∂x2 ,

(48)

0 = α(E+)ρ(ξ) + (c + E+)

∂ρ(ξ)
∂ξ

+ D

∂2ρ(ξ)
∂ξ2

.

(49)

The latter is a second order ODE that can be transformed
into two coupled ﬁrst order ODEs by denoting ∂ρ/∂ξ as
v and ρ as u . The system of coupled equations is

Algorithm 1 Constrained runs scheme for LBM

initialize f [0]
repeat

i = weq

i ρ(x, t)

∀i ∈ S

uξ
vξ

=

(cid:18)

(cid:19)

(cid:18)

1

0
− α(E+)
D − c+E+

D (cid:19) (cid:18)

(cid:19)

u
v

(50)

where uξ and vξ denote derivatives of, respectively, u and
v to ξ. The matrix has two eigenvalues

until

f [k+1] = LBM(f [k])
̺[k+1] = M f [k+1]
ρ[k+1] = ρ(x, t)
f [k+1] = M −1̺[k+1] map into distributions
convergence heuristic

a single LBM step
map into moments
reset the density

10

λ± =

−(c + E+) ±

(c + E+)2 − 4Dα(E+)

.

2D

p

There are two cases, if (c + E+)2 < 4Dα(E+) the two
eigenvalues are complex, otherwise, they are real.

The electron density in the asymptotic region is now a

linear combination of two exponentials

lim
x→+∞

ρ(x) = Aeλ+x + Beλ−x.

(51)

When the two eigenvalues are complex, the asymptotic
density is oscillating and can becomes negative. This is
unphysical because we cannot have a negative number of
particles and it is concluded that the speed c has to be
above a minimal speed

c > c∗ = c(E+) + 2

Dα(E+),

(52)

to keep both eigenvalues real. Note that both eigenvalues
λ+ and λ− coalesce at the critical speed c = c∗.

p

V. THE COARSE-GRAINED TIME-STEPPER

In this section, we describe an alternative way to per-
form the analysis of the macroscopic behavior of the sys-
tem. It is based on the work of Kevrekidis et al. [5] who
developed a coarse-grained time stepper (CGTS), which
is an eﬀective evolution law for the density. This evolu-
tion law F is not an analytic expression such as a PDE,
but the following sequence of computational steps: 1)
lifting, 2) simulation and 3) restriction, denoted by the
operators µ, LBM and M respectively (ﬁgure 3). Note
that the simulation time ∆T is in general a multiple of
∆t, the lattice Boltzmann time step. Formally, this is
written as

U (x, t + ∆T ) = F (U (x, t), ∆T )

= M(LBM(µ(U (x, t)), ∆T )),

(53)

where we have introduced U (x, t) = (ρ(x, t), E(x, t)) as
a shorthand notation. The time-stepper F evolves the
i∈S fi(x, t) and the elec-
macroscopic density ρ(x, t) =
trical ﬁeld E(x, t) from time t to t + ∆T .

P

Table I: Lifting. The constrained runs algorithm computes
the distribution functions fi(x, t) corresponding to a given
density ρ(x, t). The superscript k indicates the iteration num-
ber.

A. Lifting

Since the electrical ﬁeld E(x, t) is the same in both the
lattice Boltzmann and the macroscopic model, we can
ignore it for the discussion of the lifting and restriction
In the lifting step, the particle distribution
operators.
functions are initialized starting from the initial density

µ : Rn 7→ Rn×m : ρ(xj , t) 7→ fi(xj , t)

with i ∈ S, m the number of speeds in S, and j ∈
{1, 2, . . . , n} denoting the discrete spatial grid points. Be-
cause lifting is a one-to-many mapping problem, it is the
most critical step in the coarse-grained time-stepper. We
use the constrained runs scheme, an algorithm proposed
in [17] in the context of singularly perturbed systems.
Here, it is wrapped around a single time step ∆t of the
lattice Boltzmann model [4].

The procedure is given in table I. Starting from an ini-
tial guess ρ(x, t) for the density, we obtain initial guesses
for the distribution functions using the BGK equilibrium
weights (8). This choice determines the initial guess for
the higher order moments through the transformation
matrix M , see equation (23). (In principle, the initial
guesses for the higher order moments can be chosen ar-
bitrarily; the scheme is designed precisely to converge to
the correct value of these moments for the given density.)
We then perform the following iteration. First, we use
the lattice Boltzmann model to evolve f [k]
i∈S from t to
t + ∆t. The result is transformed back into the moment
representation by a matrix multiplication with M , which
gives us ̺[k+1]. Next, the zeroth moment of the vector
̺[k+1] is reset to the initial value ρ(x, t). Transforming
this modiﬁed moment vector ̺[k+1] back into distribu-
tion functions gives us the next f [k+1]
i∈S . We repeat this
iteration until the higher order moments have converged.
The convergence behavior of the constrained runs algo-
rithm from table I is analyzed in [4] for one-dimensional
reaction-diﬀusion lattice Boltzmann models with S =
{−1, 0, 1} (D1Q3 stencil) and a density dependent re-
action term. For such systems, the algorithm is uncondi-
tionally stable and converges up to the ﬁrst order terms in
the Chapman-Enskog expansion of the distribution func-

11

↑ LIFT ↑

↓ RESTRICT ↓

↓

M
B
L

↓

↑

-

K
C
A
B
T
F
I
H
S

↑

Figure 3: A summary of the diﬀerent steps involved in ﬁnding the traveling wave solutions as ﬁxed points of the coarse-grained
time-stepper. We start with an initial guess for the density in the left bottom (panel a). This density is mapped to the
corresponding components of the one-particle distribution function using the constrained runs lifting operator. The initial
conditions (panel b) are then evolved with the full lattice Boltzmann model over a time ∆T . Each component travels over a
distance c∆T and arrives at panel c. In the next step, the density at time t + ∆T is extracted using the restriction operator
(panel d). The resulting density is shifted back over a distance c∆T to arrive at the original position. The traveling wave
solution should be invariant under this sequence of operations and is formulated as a ﬁxed point.

tions. The convergence rate is |1 − 1/τ |, i.e. the same
rate at which the lattice Boltzmann simulation relaxes
towards the diﬀusive BGK equilibrium.

Below, we extend the results from [4] to the current
ﬁve speed model with the velocity dependent reaction
term (11). In the absence of an electrical force ﬁeld, the
distributions f±2 for the fast particles evolve as (20), i.e.

f±2(xj ± 2∆x, t + ∆t) = (1 −

− ∆tR)f±2(xj , t)

1
τ
weq

+

1
τ

±2ρ(xj , t),

(54)

where the second term is “frozen” because in each iter-
ation of the constrained runs algorithm, the density is
reset to its original value. Because the LBM propaga-
tion of distributions is a conservative operation [16], this
iteration is linearly stable if

|1 −

− ∆tR| < 1.

(55)

1
τ

The distributions f±1 evolve as

f±1(xj ± ∆x, t + ∆t) = (1 −

)f±1(xj, t)

1
τ

+

weq

±1ρ(xj, t) + ∆tR

f+2(xj, t) + f−2(xj , t)

,(56)

1
τ

(cid:0)
where the number of slow particles is increased pro-
portional to the number of fast particles because of

(cid:1)

the ionization reaction. Again, the density value in
the BGK equilibrium in (56) is “frozen” to the initial
value. Because the convergence rate for the f±2 compo-
nents is given by (55), equation (56) converges at a rate
|1 − 1/τ − ∆tR| if this value dominates over |1 − 1/τ |, or
at a rate |1 − 1/τ | if the latter is dominant over (55).

So far, we have no formal proof for the convergence
when an electrical ﬁeld is present, but we can illustrate
the convergence of the algorithm for the full system (20)–
(21) numerically for the parameter settings from sec-
tion VII. The ﬁgure is produced as follows. We ﬁrst ex-
tract the velocity moments (22) from a full lattice Boltz-
mann simulation that has evolved from an initial state
for several thousand time steps. Subsequently, we use
the obtained density ρ as the initial condition for an-
other lattice Boltzmann simulation and use algorithm I
for its initialization; the distribution functions of the orig-
inal simulation are considered to be the “exact” solution.
Figure 4 (top) plots the norm of the error between the
constrained runs state and the state of the ﬁrst lattice
Boltzmann simulation that it tries to reconstruct. We
also observe that after initialization, when evolving the
full lattice Boltzmann system both from the “exact” and
the re-initialized distributions, the error between the ﬁrst
and second system further decreases (ﬁgure 4, bottom).
The same observation was made in [3]. Note that we have
no analytical expression for the initial state returned by
the constrained runs scheme in this setting, but we be-
lieve that the results on the accuracy from [4] generalize
and that the obtained initial state is a ﬁrst order approx-

r
o
r
r
e

100

10−1

10−2

10−3

10−4

10−5

10−5

10−6

10−8

10−9

r
o
r
r
e

10−7

0

10

20

30

40

iteration [k]

0

0.025

0.05

0.1

0.125

0.15

0.075
time t

Figure 4: Convergence of the constrained runs algorithm for
the ﬁve speed ionization model both during lifting and simula-
tion step. Top: Error (2-norm) in the lifted distribution func-
tions (circles) and the ﬂux (squares) as a function of the num-
ber constrained runs iterations. After an initial convergence
with rate |1 − 1/τ − ∆tR|, the error stagnates after approx-
imately 25 iterations. Bottom: Diﬀerence (2-norm) between
the distribution functions (circles) and the ﬂux (squares) of
the lattice Boltzmann simulation that started from the stag-
nation point of the top ﬁgure and the original simulation.
Again the error decreases for approximately 25 lattice Boltz-
mann steps. Note however that after stagnation there is a
slow evolution because the macroscopic ﬁelds also evolve.

imation of the Chapman-Enskog relations.

B. Simulation

In the simulation step, the initial distributions ob-
tained from the lifting step, are evolved for a coarse-
grained macroscopic time step ∆T using the lattice
Boltzmann model discussed in the previous sections.
This step is denoted as

fi(xj , t + ∆T ) = LBM(fi(xj , t), ∆T ),

12

C. Restriction

In the last step, the restriction step, we extract the
macroscopic variables from the result of the simulation.
The macroscopic density at time t + ∆T is then

M : Rn×m 7→ Rn : fi(xj , t + ∆T ) 7→

ρ(xj, t + ∆T ) =

fi(xj , t + ∆T ).

(57)

i∈S
X

VI. THE TRAVELING WAVES AS A FIXED
POINT PROBLEM

In this section we describe the methodology outlined
in [3] to ﬁnd the traveling wave solutions of the coarse-
grained time-stepper F (U (x, t)) deﬁned in section V. If
a traveling wave solution with a speed c of F (U (x, t)) is
evolved over a time ∆T , the solution has shifted over a
distance c∆T . We deﬁne a shift-back operator σψ that
shifts the solution back over a distance ψ.

σψ : U (x, t) 7→ σψ(U (x, t)) = U (x, t) + ψ∂xU (x, t),

where we implement the shift-back by using the charac-
teristic solution of ∂tU (x, t) + ψ∂xU (x, t) in the forward
Euler time discretization.

This shift-back operator is combined with the coarse-
grained time-stepper to write a non-linear system for the
traveling wave in the co-moving coordinate system with
ξ = x − ct

U (ξ) − σc∆T (F (U (ξ), ∆T )) = 0.

(58)

This equation expresses the sequence of computational
steps as illustrated in ﬁgure 3. This system, however, is
singular because any translate of a solution will also be
a solution of (58) [3].

To get a regular system we add phase (pinning) con-
dition p(U ) and a regularization parameter α as an ad-
ditional unknown, as discussed in [3]. The resulting non-
linear system is

G(U, α) =

(cid:26)

U − σc∆T (F (U, ∆T )) = 0
= 0
p(U )

,

(59)

where the phase condition p(U ) is deﬁned as

p(U ) =

U (ξ)dξUref (ξ)dξ.

ξN −1

ξ0

Z

where the number of time steps depends on the ratio
of ∆T /∆t. When the ratio is not an integer, a linear
interpolation is used between subsequent steps.

This condition minimizes phase shifts with respect to the
reference solution Uref (ξ).

)
t
,

x
(
ρ

0.03

0.02

0.01

0

0

)
t
,

x
(
E

−0.25

−0.5

−0.75

−1

A. Preconditioned Newton-GMRES

We solve the non-linear system (59) using a Newton-

Raphson method,

U [k+1] = U [k] + dU [k]
α[k+1] = α[k] + dα[k] ,

(cid:26)

where the corrections dU [k] and dα[k] are calculated by
solving, in each Newton iteration, a linear system of the
form

I − J(U [k], α[k]) dξU [k]

dU p(U [k])

(cid:18)
= −G(U [k], α[k]).

dU [k]
dα[k]

(cid:19) (cid:18)

(cid:19)

0

(60)

This system is the linearization of G(U, α) around the
point (U [k], α[k]) and J(U [k], α[k]) denotes the Jacobian
of σc∆T (F (U [k], α[k])). Since F is deﬁned as a sequence
of computational steps, it is impossible to construct the
Jacobian J explicitly. We therefore use a Krylov method
(GMRES) that only requires its application to a vector
v, which can be estimated as

(I − J(U, ∆T ))v ≈

v −

σc∆T (F (U + ǫv, ∆T )) − σc∆T (F (U, ∆T ))
ǫ

.

(61)

Since the convergence rate of GMRES depends sen-
sitively on the spectral properties of the system matrix
(60), we propose to precondition the linear system (60)
with a rough macroscopic model based on a PDE to speed
In section IV, we derived an
up the convergence [3].
approximate PDE model using a Chapman-Enskog ex-
pansion. We deﬁne a time-stepper for this approximate
model as F (U (x, t), ∆T ), we can again write a non-linear
system

G(U, α) =

(cid:26)

U − σc∆T (F (U, ∆T )) = 0
= 0
p(U )

,

(62)

in which we have replaced the coarse-grained time-
stepper by a time-stepper for the approximate PDE
model. The solution of this system will look very similar
to the solution of the full model, but will diﬀer in places
where the approximations made during the derivation of
the PDE model fail. The linearization of this problem
leads to a matrix problem for the Newton corrections
dU [k] and dα[k] as in (60) with very similar spectral prop-
erties. The Jacobian however, is now known analytically
and can be inverted easily. The idea is to use this matrix
as a preconditioner of the linear system that is solved
each Newton iteration. The preconditioned system reads

M (U [k], α[k])
(cid:17)

(cid:16)

−1

A(U [k], α[k])

dU [k]
dα[k]

−1

(cid:18)

(cid:19)
G(U [k], α[k]),

(63)

= −

M (U [k], α[k])
(cid:17)
(cid:16)

13

0

100

300

400

200
x

0

100

300

400

200
x

Figure 5: The traveling wave solution for c = 1.3 and R = 100.
It is a ﬁxed point of sequential application of the evolution
with the coarse-grained time-stepper over a time ∆T and the
shift-back over a distance c∆T .

−1

(cid:1)

(cid:0)

M (U [k], α[k])

where
is the inverse of the matrix of
the linearization of (62) and A(U [k], α[k]) denotes the
linear system of (60). Because the spectral proper-
ties of A(U [k], α[k]) and M (U [k], α[k]) are so similar that
M (U [k], α[k])
A(U [k], α[k]) has spectral properties fa-
vorable for the convergence of GMRES. Detailed numer-
(cid:0)
ical experiments, showing the spectral properties of the
linear systems and the GMRES convergence, are reported
in [3].

−1

(cid:1)

B. The minimal speed and the coarse-grained
time-stepper

In section IV, we derived the minimal speed c∗ (52)
of the uniformly translating front solution of the PDE
model in terms of the asymptotic transport coeﬃcients.
Solutions with a speed below this critical value have a
density that oscillates in the asymptotic region, which
leads to unphysical negative densities.

For the coarse-grained time-stepper, the asymptotic
transport coeﬃcients are not available and no analytic
expression for the minimal speed can be found. We pro-
pose to use the time-stepper and its ﬁxed point solutions
to determine the minimal speed. We vary the imposed
speed of the shift-back operator σc∆T and monitor the
solutions of the ﬁxed point problem in the asymptotic
region. As the imposed speed c falls below the minimal
speed c∗ the solutions will become oscillatory because
the solution in the asymptotic region is a combination of
two exponentials (51), whose exponents λ± coalesce and
become complex at the critical speed.

We can extract the two exponents from the solution in
the asymptotic region, if we assume that it ﬁts a second
order ODE of the form

.

∂ρ
∂x

∂2ρ
∂x2 = a1ρ + a2
The coeﬃcients a1 and a2 are found by taking the ﬁxed
point solution in two grid points, where we estimate the
spatial derivatives using ﬁnite diﬀerences. This allows us
to formulate a 2-by-2 system for a1 and a2.
The eigenvalues of the 2-by-2 matrix

0 1
a1 a2

(cid:18)

(cid:19)

(64)

are then λ+ and λ−, which coalesce at the critical speed.
For a speed c far above the critical speed c∗, this
method estimates only one of the two exponents with
conﬁdence. Indeed, above the critical speed the solution
in the asymptotic region is a combination of two decay-
ing exponentials with diﬀerent exponents. However, one
of them is slowly decaying, while the other decays fast.
Far away from the critical speed, the method will only
detect the slowly decaying exponential and a ﬁt with a
ﬁrst order ODE would be suﬃcient. Near the critical
speed, however, the solution is a combination of both ex-
ponentials that decay with comparable rates and both
eigenvalues can be reliably extracted from the solution.

VII. NUMERICAL RESULTS

As an illustration, we look at a one-dimensional lattice
Boltzmann model on a grid with N = 1600, grid dis-
tance ∆x = 0.4 and a time step ∆t = 0.008. We look at
a model with ﬁve velocities with (S = {−2, −1, 0, −1, 2}),
weights weq
i = {0, 1/4, 2/4, 1/4, 0} and an electron diﬀu-

14

sion coeﬃcient of D = 1.0. This leads to a relaxation
parameter of τ = 0.8 or ω = 1.25. Note that with this
choice of equilibrium weights only slow particles exist in
the absence of external ﬁelds.

We enforce boundary conditions at the level of the lat-
tice Boltzmann model where we use homogeneous Dirich-
let boundaries at the right and no-ﬂux boundaries at the
left. The electrical ﬁeld is kept constant at E+ = −1.0
at the right and at the left we require that ∂2E/∂x2 = 0.
We ﬁrst compute the traveling wave with speed c =
1.30 for a reaction rate R = 100, which is shown in ﬁgure
5. As an initial guess for the Newton procedure, we take

ρ(x, t) = 0.025/(1 + exp(0.15(x − L 2/3)))
E(x, t) = −1/(1 + exp(0.05(x − L 5/9)))

(65)

To assess the overall performance of the method, we com-
pute the total number of required lattice Boltzmann time
steps. We observe that about 5 Newton steps are needed.
Each Newton step, in turn, requires the solution of a
linear system with the help of a preconditioned Krylov
subspace. On average about 40 GMRES iterations are
required to solve the linear system with a tolerance of
1 · 10−12. Each GMRES iteration requires an evaluation
of the CGTS, which costs about 50 lattice Boltzmann
iterations — 25 for the lifting and 25 for the simulation.
This leads to a total of 10 000 evolutions with the lattice
Boltzmann system to ﬁnd a single ﬁxed point. Detailed
ﬁgures about convergence are given in [3].

Next, we vary the cross section R, which is related to
the number of times an ionization reaction appears, and
study the eﬀect on the critical velocity of the traveling
wave solution. We increase R from 60 to 100, which cor-
responds at the level of the PDE to an increase of the
growth transport coeﬃcient from α(E+) = 0.02015 to
α(E+) = 0.03707, with E+ = −1.0. For this range of re-
action rates with the chosen value of ∆t, the constrained
runs algorithm always converges because all the eigenval-
ues of the Jacobian are smaller than |1 − 1/τ − ∆tR| < 1,
as discussed in section V A.

We now turn to the numerical computation of the criti-
cal velocity with the method proposed in section VI B. In
table II, we show the critical speed determined for a se-
ries of ionization strengths between R = 60 and R = 100.
As outlined in section VI B, the critical velocity for each
value of R is found by performing a numerical contin-
uation with the wave speed c as a free parameter and
monitoring the eigenvalues of the 2-by-2 matrix (64).
For comparison, we also show the minimal speed as ob-
tained using the approximate analytical expressions for
the transport coeﬃcients, which we found through the
Chapman-Enskog expansion. We observe a small diﬀer-
ence between the two results. The critical speed that
results from the Chapman-Enskog expansion is higher
than the critical speed that is computed using the CGTS.
Note that both methods make approximations and it is
not clear which method is more exact.

A short discussion about the accuracy of the shift-

R

60
70
80
90
100

c∗ with

c∗ with
Chapman-Enskog CGTS
1.3177
1.3318
1.3433
1.3517
1.3566

1.3351
1.3496
1.3609
1.3696
1.3755

Table II: The critical speed for diﬀerent values of the ioniza-
tion rate R.

back operator is necessary. Since we have implemented
the shift-back operator using a forward Euler approx-
imation of the characteristic solutions of the equation
ut + cux = 0, the error in the critical speed grows linearly
with the time step ∆T . Therefore, we should take ∆T
as small as possible, i.e.
the minimal possible number
of lattice Boltzmann steps in the simulation step. (Note
that accuracy and eﬃciency go together here.) However,
we cannot take less than 25 LBM steps because these
steps are necessary to reduce the error in the lifting (see
ﬁgure 4).

VIII. DISCUSSION AND CONCLUSIONS

In one dimension, an initial seed of electrons in a strong
electrical ﬁeld will evolve into a streamer front that trav-
els with a constant speed c. Before the front, the density
is zero and the electrical ﬁeld is constant; behind the
front the electrical ﬁeld is shielded and there is a sur-
plus of electrons. In this article we extended the min-
imal streamer model of Ebert et al. [1] to add some
details about the microscopic physics. To this end, we
replaced the reaction-diﬀusion PDE with a lattice Boltz-
mann model that has a velocity dependent reaction term.
The reaction rates are a chosen to model the ionization
reaction, where fast particles have a given probability to
undergo an ionization reaction and create two slow par-
ticles. The electrical ﬁeld changes simultaneously as a
result of the charge creation.

This macroscopic behavior of the model was analyzed
with two methods. The ﬁrst is the more traditional anal-
ysis based on a Chapman-Enskog expansion that derives
an approximate PDE model and the corresponding trans-
port coeﬃcients. The resulting PDE model is very simi-
lar to the minimal streamer model of Ebert, Van Saarloos
and Caroli, where the ionization rate depends on the lo-
cal electrical ﬁeld. Based on the transport coeﬃcients, we
found the dependence of the critical speed (below which
the traveling waves are unphysical) and its dependence
on the strength of the ionization cross section.

Our second method is a computational method based
on the coarse-grained time-stepper, which deﬁnes the
eﬀective evolution law as a sequence of computational
steps. The traveling wave solutions were formulated as
ﬁxed points of this coarse-grained time-stepper combined

15

with a shift-back operator. By varying the applied shift-
back, we again found the critical speed, and we demon-
strated how to calculate its dependence on the cross sec-
tion strength numerically.

We showed that the coarse-grained time-stepper pro-
vides a viable alternative to the traditional Chapman-
Enskog analysis. However, in this paper, we did not
make any statements about which of the two methods
provides the most accurate information. Both methods
make approximations to obtain the critical velocity of
the proposed lattice Boltzmann model.
In contrast to
the theoretical approximations in the Chapman-Enskog
analysis, these approximations are due to numerical ac-
curacy for the coarse-grained time-stepper.

Further progress in the accuracy can be made in several
ways. First, the lifting can be done more accurately if a
higher order constrained runs algorithm is used. Such a
method would take multiple steps with the lattice Boltz-
mann model and uses these multiple points to provide us
with an approximate initial state [17]. We expect that
these higher order lifting procedures will reproduce more
than two terms in the Chapman-Enskog series and there-
fore provide a better initial state for the simulation step.
This will allow limiting the number of simulation steps,
which will immediately improve the accuracy of the com-
puted solutions and the critical speed.

Although the model problem in this paper is non-
trivial, and the Chapman-Enskog expansion is tedious,
we emphasize that our method is mainly developed with
applications in sight where the traditional Chapman-
Enskog analysis is completely intractable. The model
problem in this paper both allows us to analyze the pro-
posed methods and provide directions for further devel-
opment. In a forthcoming article, we will do a complete
analysis of the traveling wave solutions in the proposed
model and illustrate more extensively how the macro-
scopic behavior depends on the parameters of the micro-
scopic model. In our calculations, we have also observed
the positively charged fronts that move in the opposite
direction of the electrical ﬁeld. These solutions have been
discussed by Ebert et al in [1] and our methods are also
able to locate these states.

We expect that most of the results presented in this
paper will remain valid when the number of velocities in
the discretization of the Boltzmann model is increased.
With additional velocities, it is possible to model the
cross sections of colliding particles with more detail and
study other reactions than the ionization reaction.
It
would also be interesting to study models with multiple
species where the collision rates between the particles
are velocity dependent. This would allow us to include
photo-ionization eﬀects into the minimal streamer model,
an important eﬀect that is neglected in the current model
[22].

Acknowledgments

GS is a postdoctoral researcher of the Fund for Sci-
entiﬁc Research — Flanders, who also supports PVL
through projects G.0130.03 and G.0365.06. The paper

presents research results of the Belgian Programme on
Interuniversity Attraction Poles, initiated by the Belgian
Federal Science Policy Oﬃce, which also funded WV with
a DWTC return grant. We also thank Christophe Van-
dekerckhove for fruitful discussions.

16

[1] U. Ebert, W. Van Saarloos, and C. Caroli, Phys. Rev. E,

55 p1530 (1997).

[2] W. Van Saarloos, Phys. Rep. 386 p29-222 (2003).
[3] G. Samaey, W. Vanroose, D. Roose and I.G. Kevrekidis,
Coarse-grained computation of traveling waves of lattice
Boltzmann models with Newton-Krylov methods, submit-
ted to Journal of Computational Physics, (2006). Arxiv
preprint physics/0604147.

[4] P. Van Leemput, W. Vanroose and D. Roose, Initializa-
tion of a lattice Boltzmann model with constrained runs,
submitted. Technical Report TW 444, Dept. of Computer
Science, K.U.Leuven (2005).

[5] I. G. Kevrekidis et al, Comm. Math. Sci. 1 p715 (2003).
[6] W. Hu, D. Fang, Y. Wang and F. Yang, Phys. Rev. A,

bf 49 p 989 (2006)

[7] T. N. Rescigno, M. Baertchy, W. A. Isaacs and C. W.

McCurdy, Science 5449 p2474 (1999).

[8] M. S. Pindzola and D. R. Schultz. Phys. Rev. A 53 p1525

[9] L. Malegat, P. Selles, and A. K. Kazansky, Phys. Rev.

Lett 85 p4450 (2000).

(1996).

(1992).

[13] G. H. Wannier, Phys. Rev. 90 817 (1953).
[14] N. Cao, S. Chen, Shi Jin and D. Martinez, Phys. Rev E,

55, R21 (1997).

[15] A. Arnold and C. Ringhofer, SIAM Journal of Numerical

Analysis, 33 p1622 (1996).

[16] S. Succi, The lattice Boltzmann equation for ﬂuid dy-
namics and beyond, Oxford University Press (2001).
[17] C. W. Gear, T. J. Kaper, I. G. Kevrekidis, and A. Za-
garis. Projecting to a slow manifold: Singularly perturbed
systems and legacy codes. SIAM Journal on Applied Dy-
namical Systems, 4 p711, (2005).

[18] G. E. Uhlenbeck and G. W. Ford, Lectures in Statistical
Mechanics, American Mathematical Society, Providence,
Rhode Island, (1963).

[19] Y.H. Qian, D. d’Humi`eres, and P. Lallemand, Lattice
BGK models for the Navier-Stokes equation. Europhysics
Letters, 17 p479 (1992).

[20] L. Qiao, R Erban, C.T. Kelley, I. G. Kevrekidis, Spa-
tially distributed Stochastic Systems: Equation-free and
equation-assisted bifurcation analysis submitted to Phys.
Rev. E, arxiv preprint q-bio/0606006.

94, p511 (1954).

[10] I. Bray and A. T. Stelbovics, Phys. Rev. A 46 p6995

[21] P. L. Bhatnagar, E. P. Gross and M. Krook, Phys. Rev.

[11] W. Vanroose, F. Martin, T. N. Rescigno and C. W. Mc-

[22] A. A. Kulikovsky, Phys. Rev. Lett. 89 p229401 (2002)

Curdy, Science, 310 p5755 (2005).

[12] T. Weber et. al., Nature 7007 p437-439 (2004).

