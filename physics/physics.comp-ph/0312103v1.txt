Applications of the wave packet method to
resonant transmission and reﬂection gratings

Andrei G. Borisov a,1 and Sergei V. Shabanov b,2

a Laboratory of Atomic and Molecular Collisions, University of Paris-Sud, Orsay, France

b Department of Mathematics, University of Florida, Gainesville, FL 32611, USA

Abstract

H

H

Ψ, where

Scattering of femtosecond laser pulses on resonant transmission and reﬂection gratings
made of dispersive (Drude metals) and dielectric materials is studied by a time-domain
numerical algorithm for Maxwell’s theory of linear passive (dispersive and absorbing) me-
dia. The algorithm is based on the Hamiltonian formalism in the framework of which
Maxwell’s equations for passive media are shown to be equivalent to the ﬁrst-order equa-
is a linear diﬀerential operator (Hamiltonian) acting on a
tion, ∂Ψ/∂t =
multi-dimensional vector Ψ built of the electromagnetic inductions and auxiliary mat-
ter ﬁelds describing the medium response. The initial value problem is then solved by
means of a modiﬁed time leapfrog method in combination with the Fourier pseudospectral
method applied on a non-uniform grid that is constructed by a change of variables and
designed to enhance the sampling eﬃciency near medium interfaces. The algorithm is
shown to be highly accurate at relatively low computational costs. An excellent agree-
ment with previous theoretical and experimental studies of the gratings is demonstrated
by numerical simulations using our algorithm. In addition, our algorithm allows one to
see real time dynamics of long leaving resonant excitations of electromagnetic ﬁelds in
the gratings in the entire frequency range of the initial wide band wave packet as well as
formation of the reﬂected and transmitted wave fronts.

3
0
0
2
 
c
e
D
 
7
1
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
3
0
1
2
1
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1email: borisov@lcam.u-psud.fr

2email: shabanov@phys.uﬂ.edu

1

1 Introduction

The purpose of the present study is twofold. First, we test a novel time-domain algorithm
for the Maxwell’s theory of linear, passive (dispersive and absorbing) media. The algorithm
is based on (i) the Hamiltonian formalism for evolution diﬀerential equations [1], on (ii) the
time leapfrog scheme [2], and on (iii) the Fourier pseudospectral method [3] in combination
with a change of variables that enhances the spatial grid resolution in designated domains
(in the vicinity of medium interfaces) and, thereby, prevents the loss of accuracy due to the
aliasing problem of the Fourier transform, while keeping the total spatial grid size ﬁxed [4], [5].
Boundary conditions at medium interfaces are not ﬁxed in the algorithm, but rather medium
parameters are allowed to have spatial discontinuities so that the correct boundary conditions
are enforced dynamically [6], similarly to the wave packet method for quantum mechanical
systems with discontinuous potentials. Although, each of these three main ingredients of our
algorithm have been used individually in various computational problems in electromagnetism
and quantum mechanics, to our knowledge they have never been put together in applications
to numerical simulations of propagation of a wideband electromagnetic pulse in passive media
and its scattering on targets made of dispersive and absorbing materials. By combining these
methods, we have obtained an eﬃcient, true time-domain algorithm that is highly accurate,
which is a known virtue of pseudospectral methods of solving partial diﬀerential equations [7].

An essential advantage of time-domain numerical methods is that one can see all the imme-
diate eﬀects the medium and targets have on the propagating wideband wave packet. Yet, a
single simulation of scattering of a wideband wave packet is suﬃcient to determine some basic
electromagnetic properties of a target, e.g., transmission and reﬂection coeﬃcients, in the entire
frequency range of the initial wave packet.

It has been reported [8] that a periodic thin-ﬁlm metallic grating (either with holes or one-
dimensional slits) can transmit more light at certain wavelengths than the projected area of
the holes (or slits) in the grating would suggest, while at other wavelengths transmission is
almost fully blocked. There is an ongoing discussion about the mechanism of such anomalous
transmission. Among suggested mechanisms are formation of dynamical diﬀraction resonances
in periodic metallic structures [9], surface plasmons whose resonances are enhanced by the array
of holes in the grating [10], and, speciﬁc to the slit gratings, open Fabry-P´erot resonant cavities
[11]. Since all the approaches produce essentially identical predictions for the transmission and
reﬂection coeﬃcients (the far-ﬁeld) of the slit grating, it is, perhaps, necessary to have a closer
look at the details of the electromagnetic ﬁeld dynamics in the vicinity of the grating where
deviations of theoretical predictions of a particular mechanism from the actual exact solution
of Maxwell’s equations might occur (see, e.g., a discussion in a recent work [12]). This is our
second motivation of the present study. We apply our algorithm to scattering of a wideband
electromagnetic pulse on various transmission and reﬂection slit gratings (dispersive metallic
and purely dielectric ones). Our time-domain algorithm allows one to observe in details (in real
time) formation and decay of long-living resonant excitations of electromagnetic ﬁelds as well as
formation of resonant transmission and reﬂection wave fronts. Thanks to the use of the Fourier

2

pseudospectral method in combination with nonuniform grids, an extremely high accuracy of
simulations can be achieved in the entire simulation volume and time span at relatively low
computational costs. We think that these virtues of our time-domain algorithm would be useful
for numerical studies of electromagnetic properties of other nanostructured materials [13].

The paper is organized as follows. Section 2 is devoted to the Hamiltonian formalism
applied to the Maxwell’s theory for general passive linear media. Maxwell’s equations for elec-
tromagnetic ﬁelds and medium responses are shown to be equivalent to a ﬁrst order evolution
diﬀerential equation similar to the Schr¨odinger equation in quantum mechanics. The wave
function is a multidimensional column whose components are electromagnetic ﬁelds and aux-
iliary ﬁelds describing the medium response. The Hamiltonian operator is a linear diﬀerential
operator acting on a Hilbert space spanned by square integrable wave functions. In Section
3, an example of the multi-resonant Lorentz model, which is widely used to describe passive
media, is considered in the framework of the Hamiltonian formalism. In Section 4, we establish
a relation between the norm of wave functions and electromagnetic energy. The discussion is
limited to the Lorentz model and non-dispersive dielectric media. Section 5 is devoted to a
general description of our algorithm. In particular, we show how the action of the Hamiltonian
on wave functions is deﬁned on a grid by means of the fast Fourier transform method. We prove
that the Gauss law is enforced in the grid representation at no extra computational costs in our
algorithm. Then we discuss how the sampling eﬃciency of the fast Fourier method can be en-
hanced in designated spatial regions (typically at medium interfaces) by changing variables on
the grid. The time evolution is done by a modiﬁed leapfrog method applied to the Schr¨odinger
equation. We show that the conventional leapfrog method leads to an unstable algorithm for
media with absorption and propose a general method to modify the leapfrog scheme to obtain
a conditionally stable algorithm. Finally, we give an explicit realization of our algorithm in
the case of the multi-resonant Lorentz model. Section 6 contains a detailed description of the
actual computational scheme used in our simulations of extraordinary transmission and reﬂec-
tion grating. We analyze the stability of the scheme using our general approach developed in
Section 5. Section 7 is devoted to our numerical results. We also compare them with previous
theoretical and experimental studies. Section 8 contains a brief conclusion.

2 Maxwell’s theory for passive media in the Hamiltonian

formalism

Let E and H be electric and magnetic ﬁelds, respectively, D and B the corresponding in-
ductions, and P and M the medium polarization and magnetization vectors. Boldface letters
denote three-vector ﬁelds in R3. Propagation of an electromagnetic wave packet in passive
linear media in the absence of external radiating sources is described by the following set of
equations [6]

˙ψI(t) =

H0ψF (t) ,

(2.1)

3

ψI(t) = ψF (t) + ψR(t) = ψF (t) +

dτ χ(t

τ )ψF (τ ) ,

ψI =

, ψF =

D
B

(cid:18)

(cid:19)

E
H

(cid:18)

(cid:19)

,

H0 =

0
c∇

c∇
0

×

(cid:18)

(cid:19)

(cid:18)

−

×

(cid:19)

t

0
Z
, ψR =

−
P
M

(2.2)

,

(2.3)

where c is the speed of light in vacuum, the overdot denotes the partial derivative ∂/∂t with
respect to time t, the spatial argument of the ﬁelds, denoted below by r, is suppressed. For
generic anisotropic media, the medium response function χ(t) is regarded as a linear operator
(matrix) acting on the components of ψF . For isotropic media, it is a scalar. The response
function is also position dependent for non-homogeneous media. Let ψI(0) = ψF (0) be an
initial wave packet with ﬁnite energy (ﬁnite L2(R3) norm). We are interested in a ﬁnite norm
solution of the initial value problem for Maxwell equations (2.1) subject to the constraint (the
Gauss law)

∇

B(t) = ∇

D(t) = 0 .

·

·

The response function χ(t) is usually deduced from a microscopic model of the medium in
question [6]. Therefore it is natural to assume that χ(t) is a fundamental solution of some
linear evolution diﬀerential equation so that

LtψR(t) = ωpψF (t) ,

Lt is a linear diﬀerential operator (a polynomial in ∂/∂t) and ωp describes a coupling
where
In general, ωg is a position dependent
between applied electromagnetic ﬁelds and matter.
matrix. Causality of the medium response requires that the Fourier transform ˜χ(ω) of the
response function should have poles only in the lower part of the complex plane of ω [6] so
that the Fourier transform of (2.2) reads ˜ψR(ω) = ˜χ(ω) ˜ψF (ω). By taking the Fourier transform
of Eq.
If
the response function is known from measurements in the frequency domain, components of
[ ˜χ(ω)]−1 can always be approximated by a polynomial with suﬃcient accuracy in a frequency
range of interest.

(2.5), one ﬁnds that ˜
L

(ω) ˜ψR(ω) = ωp ˜ψF (ω) and, hence,

p [ ˜χ(i∂/∂t)]−1.

Lt = ω−1

Now the Hamiltonian formalism [1] can be applied to (2.5) to transform it to an equivalent

system of ﬁrst-order diﬀerential equations

˙ξ(t) =

F
M ξ(t) +

VM F ψF (t) ,

H

where ξ is a column of auxiliary ﬁelds which are linear combinations of the response ﬁeld and
its time derivatives, save for the one of the highest order. There exists a linear operator
such
that ψR(t) =
ξ(t). Its explicit form depends on the details of going over to the Hamiltonian
formalism. One can, for instance, identify the ﬁrst component of ξ with ψR. In this case,
R
projects the column ξ onto its ﬁrst component. The response function can be expressed through
the operators

by making use of the fundamental solution of Eq. (2.6)

R

R

F
M and

H

VM F and

R

(2.4)

(2.5)

(2.6)

(2.7)

χ(t) = θ(t)

eHF
M t

VM F ,

R

4

where θ(t) is the Heaviside function. Equation (2.7) can be regarded as a condition on possible
choices of the operators

F
M and

H

VM F and

.
R

Applying

to (2.6) we ﬁnd

R

˙ψR(t) =

(2.8)
where the relation
RVM F = 0 has been used. It is not hard to be convinced that the latter
relation holds when the ﬁrst component of ξ coincides with ψR. Any other choice of ξ can
be obtained by a canonical transformation [1] which is a linear nonsingular transformation of
auxiliary ﬁelds,

RH

F
M ξ(t) ,

ξ

(2.9)
F
VM F → SM VM F and,
M S
RVM F = 0 remains true in the new basis of auxiliary ﬁelds. Denoting
F
M and substituting (2.2) and (2.8) into (2.1) Maxwell’s evolution equations (2.1)

SM 6
F
M → SM H

→ SM ξ ,
−1
M ,

According to (2.6) and (2.7),
therefore, the condition
VF M =
can be written in the Hamiltonian form

−1
M , and

R → RS

−RH

= 0 .

det

H

H0ψF (t) +
Finally, the electromagnetic and auxiliary ﬁelds are uniﬁed into one column (wave function) so
that Eqs. (2.10) and (2.6) can be represented as a single ﬁrst-order evolution equation

VF M ξ(t) .

(2.10)

˙ψF (t) =

˙ΨF (t) =

ΨF =

F ΨF (t) ,
ψF
ξ

,

(cid:19)

H

(cid:18)

F =

H

H0
VM F H

VF M
F
M (cid:19)

(cid:18)

.

The index F indicates that electromagnetic ﬁelds are used as independent electromagnetic
degrees of freedom. We shall refer to (2.12) as to a ﬁeld representation. Accordingly, an
induction representation is obtained by the similarity transformation

ΨI =

ψI
ξ

(cid:18)

(cid:19)

=

ΨF ,

S

=

S

1
0

(cid:18)

,

R
1

(cid:19)

I =

F

−1 .

H

SH

S

The corresponding blocks of

I have the form

H
HI =
VIM =
I
M =
H

H0 ,
VF M +
F
M − VM F R
H

RH

.

VM I =
F
M − H0R

VM F ,
=

,

−H0R

In what follows we denote wave functions by ΨQ(t) with Q being the representation index, F
or I. This completes construction of the Hamiltonian representation of Maxwell’s theory for
linear passive media.

Boundary conditions at medium interfaces and possible scatterers (targets) are not im-
posed on electromagnetic ﬁelds, but rather they are enforced dynamically by allowing medium
parameters to be discontinuous functions. The fundamental solution of (2.11)

(2.11)

(2.12)

(2.13)

(2.14)
(2.15)
(2.16)

(2.17)

ΨF (t) = etHF

ΨF (0) ,

0 ,

t

≥

5

VF M , for example, by means of the
is well deﬁned for discontinuous “potentials”
Kato-Trotter product formula used in the path integral representation of (2.17) as shown in
[14].

VM F and

3 The Lorentz model

The Hamiltonian formalism for the Lorentz model has been used in [15] to develop a ﬁnite
diﬀerencing algorithm to study an electromagnetic pulse propagation in Lorentz media. Here
we derive an explicit form of the Hamiltonian for the Lorentz model which is used in Section 5
for the stability analysis of our algorithm. The Lorentz model of a passive medium is based on
the assumption that the medium magnetization is zero, M = 0, while the medium polarization
is described by a set of decoupled second-order diﬀerential equations [6]

¨Pa + 2γa ˙Pa + ω2

aPa = ω2

paE ,

P =

Pa .

(3.1)

N

a=1
X

where ωa are resonant frequencies, γa are damping coeﬃcients, and ωpa are plasma frequencies.
As has been pointed out, no boundary conditions are imposed on electromagnetic ﬁelds at
Instead, the coupling constants ωpa = ωpa(r) are allowed
medium and/or target interfaces.
to have discontinuities at medium interfaces, or, from the physical point of view, they remain
smooth but change rapidly, λw|
/ωp >> 1, at the interface, where λw is a typical wave
length of the incident wave packet. The initial value problem is solved in the space of square
integrable wave functions. Initial conditions for the response ﬁeld are P(t = 0) = ˙P(t = 0) = 0.

∇ωp|

Consider 2N real vector ﬁelds, ξj, j = 1, 2, ..., 2N, such that

Pa = (ωpa/ωa) ξ2a−1 ,
˙ξ2a =

˙ξ2a−1 = ωaξ2a ,

2γaξ2a −
−
Thus, the original system of second order equations has been converted into the ﬁrst order
system. The operator

is deﬁned by (3.2). After simple algebraic transformations, we infer

ωaξ2a−1 + ωpaE .

(3.3)

R

VF M = (
VM F =

VF M 1,
†
F M ,

−V
F
M = diag

H

H
(cid:0)

VF M 2,

,

VF M N ) ,

· · ·

VF M a =

0
0

−

ωpa
0

,

(cid:19)

(cid:18)

F
M 1,

F
M 2,

,

F
M N

· · ·

H

H

,

F
M a =

H

ωa
0
2γa (cid:19)
ωa −
−

(cid:18)

,

(3.2)

(3.4)

(3.5)

(3.6)

where diag indicates that the corresponding matrix is block-diagonal with blocks listed in the
order from the upper left to lower right corners. Note that the matrices
HF M a act
on a six-dimensional column ξa composed of two vectors ξ2a−1 and ξ2a. Therefore they should

VF M a and

(cid:1)

6

be understood as composed of 3
matrix by the number indicated in place of the block in (3.4) and (3.6).

3 blocks. Each block is obtained by multiplying the unit

×

Another convenient way to introduce the Hamiltonian formalism is to use N complex vector

ﬁelds ζa which satisfy the ﬁrst order diﬀerential equation

˙ζa = λaζa −

iωpaE , Pa =

ζa + ¯ζa

,

ωpa
2νa

(3.7)

(cid:0)

−

p

ω2

a −

γa+iνa and νa =

(cid:1)
γ2
a. This representation is deﬁned only if γa < ωa (i.e., the
where λa =
attenuation is not high). From the numerical point of view, solving a decoupled system of N ﬁrst
order diﬀerential equation and taking complex conjugation (denoted here by an over bar) is less
expensive than solving the original system of second-order diﬀerential equations for the medium
polarization. In general, there is always a freedom of choosing a new basis for the auxiliary ﬁeld
Q) is computed in one basis, it can be computed in
space (2.9). If the evolution operator exp(t
another basis by a suitable similarity transformation. This is an important observation because
the auxiliary ﬁeld basis can be chosen in a way that facilitates computation of the evolution
operator, e.g., to speed up simulations. For instance, in the complex representation (3.7), the
F
M is diagonal. The corresponding transformation of auxiliary ﬁelds is
matter Hamiltonian
given by

H

H

1
2νa (cid:18)
To transform the whole system into this representation, the Hamiltonian

ξ2a−1
ξ2a (cid:19)

ωa ωa
λa

ζa
¯ζa (cid:19)

ζa
¯ζa (cid:19)

¯λa (cid:19) (cid:18)

≡ SM

=

(cid:18)

(cid:18)

.

−1

F

and the wave function ΨF by

S
the upper left (ﬁeld) corner and with

H

S

F is replaced by
is block-diagonal with the unit matrix in

ΨF where

H
S
SM in the lower right (matter) corner.

S

(3.8)

4 Energy and the norm of state vectors

Accuracy and convergence of a numerical algorithm is deﬁned relative to some norm. Let us
discuss the choice of a norm in the space spanned by wave functions ΨQ(t). The discussion
is limited to the Lorentz model and the case of a nonhomogeneous, nondispersive medium
(dielectric) which are used in our numerical simulations.

I The Lorentz model

Consider a multi-resonant Lorentz model with no attenuation γa = 0. The ﬁeld and matter
evolution equations can be obtained from the variational principle for the action

S =

dtL =

Z

dr

1
2

"

E2

B2

+

−

1
2

dt
Z

Z

(cid:0)

a (cid:16)
X

˙ϑ

2
a −

aϑ2
ω2

a

+ P

E

,

·

#

(cid:17)

(4.1)

(cid:1)

7

where the polarization of the medium is expressed via matter ﬁelds as P =
a ωpaϑa. The
electromagnetic degrees of freedom are described by the vector and scalar potentials, respec-
tively, A and ϕ. The ﬁelds are deﬁned by E =
A. The units are
chosen in this Section so that c = 1. The least action principle for the scalar potential ϕ leads
to the Gauss law, ∇
B,
and for the matter ﬁelds ϑa to the medium polarization evolution equation (3.1) of the Lorentz
model with no attenuation, γa = 0. The second Maxwell’s equation and the Gauss law for
the magnetic ﬁeld follows from the relation B = ∇
A by taking its time derivative and
divergence, respectively.

D = 0, for the vector potential A to the Maxwell’s equation,

˙A and B = ∇

˙D = ∇

∇ϕ

P

×

×

−

×

−

·

The energy of the system coincides with the canonical Hamiltonian which is obtained by
the Legendre transformation [1] of the Lagrangian L for the velocities ˙A and ˙ϑa. The canonical
momenta are πa = δL/δ ˙ϑa = ˙ϑa and Π = δL/δ ˙A =
D. Doing the Legendre
transformation, we ﬁnd the canonical Hamiltonian (energy) of the system

P =

−

−

−

E

1
2

·

 

dr

dr

˙A

˙ϑa + Π

L =

a
X

! −

E(t) =

πa ·
Z
where the Gauss law ∇
D = 0 has been used. The energy conservation follows directly from
˙E(t) = 0.
the Noether theorem [1] applied to the time translation symmetry of the action (4.1),
Equation (4.2) becomes the conventional expression for the electromagnetic energy in a passive
medium [6] when πa and ϑa are replaced by the corresponding solutions of the equations of
motion with initial conditions πa(t = 0) = ϑa(t = 0) = 0.

E2 + B2 +
"

a + ω2

(4.2)

a
X

π2

aϑ2

#

Z

(cid:1)

(cid:0)

·

,

a

An important observation is that the Noether integral of motion (4.2) coincides with the

norm squared of the corresponding state vector

E =

dr ΨF †ΨF

(ΨF , ΨF ) = (ΨI, µΨI) ,

(4.3)

1
2

Z

≡

S

S

−1†

−1. This follows from the fact that, if we identify ξ2a = πa and ξ2a−1 = ωaϑa,
where µ =
δE/δϑa, coincide with (3.3)
the Hamiltonian equations of motion,
when γa = 0. Note that canonically conjugated electromagnetic variables are A and
D.
Therefore, the coupling between the electromagnetic and matter degrees of freedom in the
Hamiltonian equations of motion is generated by the term E2 = (D
P)2 in (4.2). Thus, in
the absence of attenuation, the norm of the state vector is proportional to the wave packet
electromagnetic energy and, hence, is conserved.

˙ϑa = δE/δπa and ˙πa =

−

−

−

The norm conservation also follows from anti-Hermiticity of the Hamiltonian

F if
γa = 0, while (4.3) establishes a relation between the electromagnetic energy and the norm. In
the induction representation, the norm in the measure space, deﬁned by the operator µ in (4.3),
is also conserved by construction. Consequently, the Hamiltonian is anti-Hermitian relative to
the measure space scalar product,

I†µ =

−H

F † =

H

I.

µ

H

−

H

The norm (energy) conservation can be used to control numerical convergence, especially
when the aliasing problem in the fast Fourier transform is present, e.g., when parameters of

8

the medium are discontinuous functions in space. In a properly designed algorithm the loss of
energy (norm) due to attenuation should be controlled by the symmetric part of the Hamiltonian
operator

˙E(t) =

−

γa

dr ξ2

2a(t)

ΨF (t),

γ ΨF (t)
F
V

0 ,

≤

(4.4)

0 (a negative semideﬁnite operator) which is, in this case,

(cid:1)

1
2

≡

(cid:0)

where
a diagonal matrix with nonpositive elements.

F
γ = (

F †
γ =

F † +

H

H

≤

V

V

Z

a
X
F )/2

II Nondispersive media

If the medium in question does not have dispersion and absorption, the formalism is simpliﬁed.
Let ε = ε(x) be the dielectric constant of the medium, D = εE. If the medium is not isotropic,
then ε is symmetric positive deﬁnite 3
3 matrix everywhere in space. We rewrite Maxwell’s
equations in the form

×

˙ψI(t) =

HGψI(t) ,

HG =

0

c∇

(ε−1 )

c∇
0

×

,

(cid:18)
where the parenthesis in (ε−1) mean that the induction is ﬁrst multiplied by ε−1 and then the
curl of the resulting vector ﬁeld is computed. Consider the scalar product

−

×

(cid:19)

(ψI

1, µεψI

2) =

dr ψI†

1 µεψI

2 , µε =

Z

ε−1
0

(cid:18)

.

0
1

(cid:19)

†
Gµε =
The Hamiltonian is anti-Hermitian with respect to this measure space scalar product,
µεHG. Therefore the corresponding norm is preserved in the time evolution generated by
−
HG), that is, (ψI(t), µεψI(t)) = (ψI(0), µεψI(0)). The electromagnetic energy of the wave
exp(t
packet is conserved because it is proportional to the measure space norm of the initial state
vector.

H

(4.5)

(4.6)

5 The algorithm

I The grid representation

Consider an equidistantly spaced ﬁnite grid with periodic boundary conditions. Let ∆r be the
grid step and n be a vector with integer valued components. Then the dynamical variables
are projected onto the grid by taking their values at grid points r = n∆r, that is, the wave
function is replaced by a vector (column) whose dimension is determined by the grid size,
ΨQ(r)
n . A cubic grid is assumed. Consider a discrete Fourier transformation
≡
associated with the grid, ˜ΨQ(nk0) =
˜ΨQ
† = 1. The

ΨQ(n∆r)

n , where

nn′ΨQ
n′

ΨQ

→

=

n′

†

≡

F

F

F F

F

9

P

reciprocal lattice step is k0 = 2π/∆r. The grid spatial size L and step ∆r must be chosen so that
the Fourier transform of the initial wave packet has support within the region k
[kmin, kmax]
, kmax = k0 and kmin = 2π/L. The action is of any position dependent operator
where k =

∈

k
|

|

Q =

Q(r) is deﬁned by

V

V

Q(r)ΨQ

t (r)

Q(n∆r)ΨQ

t (n∆r)

V

→ V

nn′ΨQ
Q

n′ ,

(5.1)

Q
nn′ = δnn′

0 (∇) depend only on the ∇
where
operator. The projection of its action onto the grid is then deﬁned via the discrete Fourier
transform

Q(n∆r) is a diagonal matrix. Let

H

H

V

V

Q

Q

0 (∇)ΨQ

t (r)

H

Q

0nn′ΨQ

n′ ,

Q
0nn′ =

H

†

nn′′

H

Q

0 (in′′k0) (

F

)n′′n′

.

(5.2)

≡

n′ V
X
Q
0 =

n′′
X

F
(cid:0)

(cid:1)

The projection (5.2) is performed by the fast Fourier transform method.

r=n∆r →
(cid:12)
(cid:12)
(cid:12)

n′ H
X

In what follows, the action of a product of

Q
0 on any state vector is understood
H
as multiplication of ΨQ
n by the corresponding matrices, deﬁned in (5.1) and (5.2), in the order
speciﬁed in the product. The main advantage of using the Fourier basis is the exponential con-
vergence (versus the polynomial one in ﬁnite diﬀerencing schemes) [7] as the grid size increases,
which allows one to substantially increase the accuracy of simulations.

Q and

V

II The Gauss law

Another advantage of the Fourier basis is that the Gauss law is enforced at no extra compu-
tational cost. In the grid representation deﬁned above, the Gauss law (2.4) requires that the
Fourier transforms of the inductions ˜D(k) and ˜B(k) remains perpendicular to the reciprocal
grid vector k = nk0 at any moment of time. In our algorithm, as we shall show shortly, the
time evolution is generated by applying powers of the Hamiltonian to the wave function. In
I always produces the cross product
the induction representation, the action of powers of
˜C(k), for some ˜C(k) regular at k = 0, in the entries of ΨI that correspond to the elec-
k
I)mΨI satisﬁes
tromagnetic inductions. Hence, in the grid representation the wave function (
˜C(k)) = 0 valid for any
the Gauss law for any power m because of the trivial identity k
vector k of the reciprocal grid.

(k

H

H

×

×

·

It should be noted that a high accuracy of the Gauss law is essential to achieve a high

accuracy of simulated electromagnetic ﬁelds near medium interfaces.

III

Improving sampling eﬃciency by changing variables

As is well known from the Fourier analysis, the convergence rate can be aﬀected for functions
which have discontinuities [3]. The latter is, unfortunately, the case in electromagnetic scat-
tering problems [6]. Suppose there is an interface between two media. It can be deduced from

10

the dynamical Maxwell’s equations that the components of electric and magnetic ﬁelds, E and
H, tangential to the interface must be continuous, provided there is no surface electric current
on the interface. From the Gauss law it follows that components of the inductions, D and B,
normal to the interface must be continuous, provided there is no surface charge on the inter-
face. In contrast, normal components of the ﬁelds and tangential components of the inductions
can be discontinuous. Their discontinuities are determined by discontinuities of medium pa-
rameters (e.g., discontinuities in plasma frequencies in Lorentz models). Therefore, in either
the induction or ﬁeld representation, there are components which suﬀer discontinuities at the
interface. The only way to cope with the problem, while keeping the use of the Fourier basis,
is to make the grid ﬁner [3]. This would lead to a substantial waste of computational resources
because the conventional fast Fourier transform is deﬁned on a uniform periodic grid, while the
sampling eﬃciency should only be enhanced in the neighborhood of medium interfaces. The
use of wavelet bases might be helpful for such a task [16] in time domain algorithms. Here we
retain the Fourier basis, and increase the sampling eﬃciency by a change of variables.

The basic idea can be understood with a one-dimensional example. Let z be a physical co-
ordinate. Consider a change of variables deﬁned by z = f (y) where y is an auxiliary coordinate.
An equidistant grid yn = n∆y, with n being integers, of the auxiliary coordinate generates a
non-uniform grid of the the physical coordinate, zn = f (n∆y). Assuming ∆y to be suﬃciently
small and f (y) suﬃciently smooth, the physical grid spacing can be approximated as

∆zn = zn+1 −

zn ≈
So, if f ′(y) = 1, then ∆zn = ∆y and the grid is equidistant. By making the derivative
0 < f ′(y)
1 in some designated areas, one can achieve a desired local grid density in the
physical space, while keeping the total grid size ﬁxed. For example, if it is necessary to increase
the sampling eﬃciency in the vicinity z = 0, one can take f ′(y) = 1
0y2]−1, where
0 < a0 < 1, and , hence,

a0[1 + b2

≤

−

∆yf ′(n∆y) .

f (y) = y

tan−1(by)

y

g(y, a, b) .

≡

−

a
b

−

By adjusting parameters a and b, the local grid density can be changed as desired. Consequently,
if the sampling eﬃciency is to be enhanced at several points yi, a suitable change of variables
can be of the form f (y) = y
yi, ai, bi). The fast Fourier transform is applied on a
i g(y
uniform grid of the auxiliary variable.

−

−

P

Upon the change of variables, the integration measure in the scalar product and the deriva-
tive transform, respectively, dz = dyf ′(y) and ∂z = [f ′(y)]−1∂y. When projected on a uniform
grid of the physical coordinate by means of (5.2), the derivative operator ∂z becomes an anti-
Hermitian matrix. When the rule (5.2) is applied on a uniform grid of the auxiliary coordinate
y, the derivative operator ∂z is no longer represented by an anti-Hermitian matrix, although it
is still an anti-Hermitian linear operator, but in the measure space where the scalar product
is deﬁned with the weight f ′(n∆y) at each lattice cite. From the numerical point of view it
is convenient to have an explicitly anti-Hermitian matrix representation of the derivative on
the grid. Due to round-oﬀ errors, the exact anti-Hermiticity of ∂z in the measure space can

11

be violated in the grid representation, which, in turn, may lead to numerical instabilities of
simulations. Note that if a computed matrix is known to be anti-Hermitian, then only half of
its elements is to be computed, while the other elements are restored by the symmetry. In the
measure space, an explicit anti-Hermiticity of a linear operator is much more diﬃcult to main-
tain in numerical simulations because the symmetry relation between matrix elements depends
on the scalar product measure. For this reason, the wave function is rescaled by the square
√f ′Ψ so that the integration measure becomes dy leading to the
root of the Jacobian [5], Ψ
conventional Euclidean scalar product in the grid representation (with the uniform unit weight
[f ′]−1/2∂y[f ′]−1/2
In such a representation, the derivative operator ∂z →
at each grid site).
becomes again an explicitly anti-Hermitian matrix in the grid representation deﬁned by the
rules (5.1) and (5.2).

→

IV A modiﬁed temporal leapfrog scheme

A conventional temporal leapfrog method of solving the Schr¨odinger equation is based on the
iteration scheme [2]

ΨQ(t + ∆t) = ΨQ(t

∆t) + 2∆t

QΨQ(t) ,

(5.3)

−
so that the wave function in the consecutive time moment is computed from the wave function
at two previous moments of time, where ∆t is the time step. The action of the Hamiltonian
Q is computed by pseudospectral methods, in particular, by means of the Fourier basis and
H
the fast Fourier transform in our algorithm. The leapfrog algorithm is conditionally stable for
Q, which is true for nondispersive media, but not the case for media with
an anti-Hermitian
absorption.

H

H

To investigate the stability, let us introduce the ampliﬁcation matrix for the leapfrog algo-
(∆t)Ψ(t) (the representation index, Q, is suppressed for a moment). From
(∆t) satisﬁes the equation
1 = 0 which has two

2(∆t)

(∆t)

2∆t

rithm, Ψ(t + ∆t) =
(5.3) it follows that
solutions

G
G

(±)(∆t) =

G

∆t

H

±

2∆t2 .

H

−

HG

−

G
√1 +

(5.4)

The stability of the algorithm requires that the energy norm of both approximate solutions
(±)(∆t)]nΨ(0) must be uniformly bounded for n > 0. The necessary condition (but not
[
G
suﬃcient) is the von Neumann condition that the spectral radius of the ampliﬁcation matrix
does not exceed 1. If a complex number Reiϕ is an eigenvalue of ∆t
, then the von Neumann
condition implies that ϕ =
must
be imaginary and their magnitude should not exceed 1. If in addition we demand that the
Hamiltonian is diagonalizable, then a conditional stability can be achieved for suﬃciently small
∆t. Indeed, in this case there exists an non-singular

H
In other words, eigenvalues of ∆t

π/2 and R2

such that

H

±

≤

1.

H
HS satisﬁes the von Neumann condition. Since
and

and ∆t
ampliﬁcation matrices for

H

S

HS have the same eigenvalues, the
HS are related by the same similarity transformation (5.5).

H

H

(5.5)

=

−1

,

HSS

S
†
S =

−HS ,
and

12

Hence, the norm of a wave function obtained by the action of powers of (5.4) on an initial wave
function is uniformly bounded. Note also that the Hamiltonian (5.5) is anti-Hermitian relative
−1. The stability can also
µ
to the measure space scalar product,
be proved via the equivalence of the conventional Euclidean norm and the µ-norm [14].

, where µ =

†µ =

H

H

−1†

−

S

S

In the case of nondispersive media, the Hamiltonian

space, and the von Neumann condition is fulﬁlled if

HG is anti-Hermitian in the measure

∆t c kε

1 ,

max ≤

(5.6)

where kε

max the maximal norm of all wave vectors in the medium which can be estimated by
ρ(ε)kmax with kmax being the maximal wave vector of the initial pulse in vacuum and ρ(ε)
the maximal spectral radius of the symmetric matrix ε(x) over x (or simply the maximum of
p
ε(x) if the medium is isotropic). This can be understood from the following principle [17]. A
ﬁnite diﬀerence scheme with variable coeﬃcients is stable if all the corresponding schemes with
frozen (i.e., ﬁxed to a particular value everywhere in space) coeﬃcients are stable.

The von Neumann condition cannot be met if absorption is present because eigenvalues
of the Hamiltonian must have real parts in order to account for exponential attenuation of
ﬁeld amplitudes. To circumvent this diﬃculty, the leapfrog scheme is modiﬁed in the following
way [14]. We assume the Hamiltonian to be diagonalizable. The lack of eigenvectors of the
Hamiltonian typically leads to solutions whose amplitudes grow polynomially in time [14]. This
feature cannot be present in a physically reasonable model of passive media. So our assumption
is justiﬁed from the physical point of view and, yet, the Lorentz model Hamiltonian is indeed
diagonalizable. Let

,

0

V

V

=

≤

H

H

Ψ)

(Ψ,

H0 +
(5.7)
for any Ψ in the Hilbert space and the von Neumann condition is satisﬁed for
H0 has
imaginary eigenvalues. The split (5.7) can be achieved in many ways. For instance,
H0 can be
obtained from
by setting all parameters responsible for attenuation to zero. In a physically
acceptable model, the energy must be conservative in an absorption free medium and so must
be the energy norm of wave vectors, and, therefore, the corresponding Hamiltonian must be
anti-Hermitian (relative to the energy induced scalar product). In the Lorentz model this is
H0 =
easily seen in the ﬁeld representation if we set
H|γa=0 which is explicitly anti-Hermitian
2γa. Another
is diagonal with matrix elements being zeros and
(see Section 3). Then
−
V
possibility is to identify
H − H0 must be
=
H0 with the Hamiltonian in the vacuum, then
negative semideﬁnite in order to model exponential attenuation in passive media. Finally, one
can also split the Hamiltonian into the sum of Hermitian and anti-Hermitian parts.

H0, i.e.,

V

After choosing a suitable split (5.7) we make a substitution Ψ(t) = exp(t

)Φ(t) in the
original evolution equation (2.11). The new wave function Φ(t) satisﬁes the equation with a
time dependent Hamiltonian

V

H0etVΦ(t)
to be solved with the same initial condition Φ(0) = Ψ(0). Applying the leapfrog method to
(t)Φ(t) valid up to O(∆t3). Returning to the initial
(5.8) we get Φ(t + ∆t) = Φ(t

∆t) + 2∆t

(t)Φ(t) ,

˙Φ(t) = e−tV

(5.8)

≡ H

−

H

13

variables, we arrive at the following recurrence relation

(∆t) = exp(∆t
where
rence (5.9) satisﬁes the equation

L

V

Ψ(t + ∆t) =

(2∆t)Ψ(t

∆t) + 2∆t

(∆t)

−
). The ampliﬁcation matrix, Ψ(t + ∆t) =

L

L

H0Ψ(t) ,

(5.9)

GL(∆t)Ψ(t), for the recur-

GL(∆t) =

(2∆t)

−1
L (∆t) + 2∆t

(∆t)

H0 .

L

G
n
L(∆t)Ψ(0) from the exact solution relative to the
A deviation of the approximate solution
energy norm is of order ∆t2 for any n > 0. Thus, the scheme is convergent and, hence, a
conditional stability exists for a suﬃciently small ∆t > 0 according to a general theorem of
Kantorovich [2] that establishes a general equivalence between convergence and conditional
stability. The conditional stability of (5.9) can be understood from the following observation.
Solving (5.10) by perturbation theory in ∆t, it is not hard to ﬁnd that

L

G

(5.10)

(5.11)

(∆t/2) ,

GL(∆t)

G0(∆t)
(∆t) is regular in the vicinity of ∆t = 0 and vanishes whenever

− GV (∆t) = ∆t3

GV (∆t) =

(∆t/2)

(∆t) ,

K

L

V

K

G0(∆t) is the ampliﬁcation matrix when

G0(∆t) for a suﬃciently small ∆t > 0. Hence, powers of

where
commute,
V
and
is set to zero. The von Neumann condition is
G0(∆t) applied to Ψ(0)
satisﬁed for
G0(∆t)
cannot produce any exponential norm growth. Powers of
by factors that are powers of e∆tV and, hence, can only produce exponential attenuation of the
amplitude. Indeed, let ΨV (t) = etV Ψ(0). Then ∂/∂t(ΨV , ΨV ) = 2(ΨV ,
is
negative semideﬁnite. Thus, the approximate solution produced by the ampliﬁcation matrix
GV (∆t) has no exponential growth, while diﬀering, relative to the energy norm, from that
GL(∆t) by order of O(∆t2). Therefore the modiﬁed leapfrog scheme can be made
produced by
conditionally stable and as accurate as desired by reducing the time step.

GV (∆t) diﬀer from those of

0 since

ΨV )

≤

V

V

L
H0 and

Ψ(t)

k
Ψ(t)

It should be noted that our arguments do not prove that there cannot be any exponential
= (Ψ(t), Ψ(t))1/2 in the modiﬁed leapfrog scheme (5.9). All we
growth of the norm
exp(Kt) which is also true for the conventional leapfrog scheme.
can claim is that
O(∆t2) as we have argued (a
The diﬀerence is that in the modiﬁed leapfrog scheme K
∼
consequence of (5.11) and uniform boundedness of powers of
GV ), while in the conventional
leapfrog scheme the constant K is independent of ∆t. Hence a possible exponential growth
cannot be suppressed by reducing the time step in (5.3), while it can be done in (5.9).

k
k ≤

k

V An example of the Lorentz model

To illustrate our general method we give an example of the Lorentz model commonly used to
describe dispersive media. In the ﬁeld representation of the Hamiltonian for the Lorentz model,
we make the following decomposition

F =

H

H0
VM F

(cid:18)

VF M
0

0
0

+

(cid:19)

(cid:18)

0
F
M (cid:19)

H

F
0 +

F .

V

≡ H

(5.12)

14

Substituting this decomposition into (5.9) we arrive at the following scheme

ψF (t + ∆t) = ψF (t

−
ξa(t + ∆t) = e2∆t HF

∆t) + 2∆t

H0ψF (t) + 2∆t
∆t) + 2∆t e∆t HF

M a

M a ξa(t

−

etHF

M a = e−γat

cosh ˜νat +

VF M aξa(t) ,
a
X
VM F a ψF (t) ,
,

sinh ˜νat
˜νa

F
M a + γa

H

(cid:21)

(cid:20)

(5.13)

(5.14)

(5.15)

a −

(cid:0)
a)1/2 and the six-dimensional columns ξa are introduced in Section 3. The
ω2
where ˜νa = (γ2
F
exponential (5.15) is easy to compute by expanding
M a in the Pauli matrix basis (a basis for
the Lie algebra su(2)) and then by using the well known formula for the exponential of a linear
combination of Pauli matrices. For small attenuation, γa < ωa, we get ˜νa = iνa. The hyperbolic
functions in (5.15) become the trigonometric ones and ˜νa is replaced by νa. Eigenvalues of the
˜νa. Hence, Re λa < 0 and amplitudes of the matter ﬁelds
matter Hamiltonian are λa =
, unless γa = 0 leading to Re λa = 0.
are always exponentially attenuated as t

γa ±
−

H

(cid:1)

→ ∞

The stability is ensured if

F
0 satisﬁes the von Neumann condition. Let kmax be the maximal
H
norm of all wave vectors of the initial wave packet and ωmax
be the maximal value of ωp =
(

pa)1/2 as a function of position, then a suﬃcient condition for stability reads

p

a ω2

P

∆t

c2k2

max + (ωmax

p

)2

1 .

≤

q

(5.16)

p

. Note that it is not diﬃcult to solve the characteristic equation for

Here the idea of the frozen coeﬃcients [17] has been used again. The left hand side of inequality
F
(5.16) is nothing but the spectral radius of ∆t
0 with frozen plasma frequencies so that
ωp = ωmax
F
0 with frozen
plasma frequencies by using the Fourier basis. The scheme (5.9) becomes especially simple in
the case of small attenuation γa < ωa. In the complex representation of the auxiliary ﬁelds
F
(3.8) (cf. (3.7)) the matter Hamiltonians
M a are diagonal and the action of its exponential is
reduced to multiplication by a complex number eiνa∆t.

H

H

H

VM F to

VF M and

1. This would come at the price of having a more complicated expression for

Finally, it should be mentioned that, by rearranging operators in the split, namely, by
F in (5.12), the stability condition (5.16) can be weakened to
moving
(∆t).
∆tckmax ≤
In the case of the Lorentz model it can still be computed analytically. The new split can also be
I
viewed as the use of the induction representation in the modiﬁed leapfrog scheme,
V
I with the ∇ operator. The proof of the weaker stability
where
condition can be found in [14].

I
0 contains only the blocks of

I =

I
0 +

H

H

H

H

L

V

6 Metal gratings in the Drude formalism

Here we apply our method to gratings made of a metal whose optical properties are described
by the Drude formalism. This is an actual numerical scheme used in simulations in Section 7.

15

The metal dielectric constant as a function of frequency is given by

ε(ω) = 1 + ˜χ(ω) = 1

ω2
p
ω(ω + iη)

,

−

where ωp is the plasma frequency, which is zero in the vacuum and constant in the region
occupied by the metal as shown in Fig.1, and η is the absorption. The model coincides with
a one-resonant Lorentz model if ω0 = 0 and η
2γ. To satisfy the Gauss law exactly in
simulations, we use the induction representation according to Section 5.II. An auxiliary ﬁeld
is chosen so that its ﬁrst component equals P and the second is denoted ξ. The Hamiltonian
evolution equations are taken in the form

≡

B ,

˙D = c∇
×
˙B =
c∇
˙P = ηξ ,

−

(D

P) ,

×

−

˙ξ =

ηξ

−

−

ω2
p
η

(D

P) .

−

To apply the modiﬁed leapfrog scheme the Hamiltonian is split into the sum

0
c∇
×
0
pη−1
ω2

I = 

−

−
I = diag(0, 0, 0,





0
c∇
×
0
pη−1
ω2

×

c∇
0
0
0

η) .

−

0
0
η
−
η
−





H

V



=

I
0 +

I ,

V

H

(6.1)

V

H

I is negative semideﬁnite because η > 0. The stability of the modiﬁed leapfrog scheme
Clearly,
I
requires that eigenvalues of
0 have zero real parts. This is indeed the case. In the Fourier
basis, the ∇ operator becomes ik. It is straightforward to ﬁnd the characteristic polynomial
det(
p. Hence the scheme is stable if the time
step is chosen so that the condition (5.16) is satisﬁed. In particular, kmax can be set to k0 being
p
the step of the reciprocal lattice and ωmax
is the plasma frequency of the metal (silver in our
simulations, see Section 7). An explicit form of the modiﬁed leapfrog scheme for the split (6.1)
reads

λ). Its nonzero roots are λ =

c2k2 + ω2

I
0 −

i
±

H

p

∆t) + 2c∆t∇
D(t + ∆t) = D(t
×
2c∆t∇
B(t + ∆t) = B(t
∆t)
×
P(t + ∆t) = P(t
2η∆tξ(t) ,
∆t)
ξ(t + ∆t) = e−2η∆t ξ(t
∆t)

−
−
−

B(t) ,
[D(t)

−
−
−

P(t)] ,

−

2∆tω2

pη−1 e−η∆t [D(t)

P(t)] .

−
The action of the curl is computed by the fast Fourier method in combination with a change of
variables that enhances the sampling eﬃciency near the metal-vacuum interface. The details
are in Section 7.

−

16

7 Results for extraordinary transmission gratings

To test our method we applied it to study transmission properties of metal and dielectric
gratings suspended in vacuum. Transmission and reﬂection gratings have been subject of a
number of experimental and theoretical works [9]–[12], [18]. The interest is stimulated by nearly
100% transmission or reﬂection within narrow wavelength range with possibility of using such
grating as eﬃcient ﬁlters. Moreover, extraordinary optical transmission has been observed in
the 2D hole arrays [8], further stimulating theoretical and experimental interest to transmission
properties of nanostructured materials [13].

In Fig.1 we schematically represent our system comprising a metallic or dielectric slab with
gratings. D is a grating period, a the size of the grating and h its thickness. For the sake of
comparison with previously published results we have chosen D = 1.75µm and a = 0.30µm.
Transmission and reﬂection coeﬃcients are computed as a function of the grating thickness
h. An incident electromagnetic wave packet propagates along the z-direction, normal to the
slab. The polarization is such that the electric ﬁeld vector is perpendicular to the gratings,
while the magnetic ﬁeld is parallel to them (the so called p -polarization). Calculations are
D/2 < x < D/2. A uniform
performed in a ﬁnite (x, z) box of the size -15D < z < 12D,
mesh of typically 256 knots is used in the x-direction and a nonuniform mesh of 512 knots
generated by the change of variables is used in the z-direction. The change of variables is
used to enhance the sampling eﬃciency near the two interfaces in the z-direction. Periodic
boundary conditions are insured in x through the pseudospectral approach based on the Fast
Fourier Transform. To suppress an artiﬁcial reﬂection of the wave packet, absorbing layers
are introduced at the box boundaries z =
15D. The initial wave packet is Gaussian, which
allows us to obtain transmission (reﬂection) coeﬃcients within the entire frequency bandwidth
of the initial wave packet by a single simulation. In what follows we are mainly interested in
transmission (reﬂection) of the radiation with wavelengths larger than the grating period (zero
order diﬀraction). Thus, reﬂected or transmitted waves propagate in the direction of the z-axis,
the same as the incident radiation. Note, however, that this is not a limitation of our method
which allows for a priori extraction of the entire scattering matrix for all wave vectors.

−

±

In Fig.2 we show transmission and reﬂection coeﬃcients obtained for metallic gratings of
variable depth. The dielectric response of the metal is described within the Drude formalism
(see Section 6). Following [10] we use ωp = 9eV and η = 0.1eV representative for silver. As
clearly seen in the Figure, the transmission coeﬃcients exhibit narrow resonances for certain
wavelengths. With increasing thickness of the gratings, h, the number of resonant structures
increases. Our results are in a full agreement with previously published theoretical studies [10].
The only diﬀerence being, that the model used in [10] assumes perfect metal surfaces inside
the gratings, neglecting possible absorption of the radiation. This leads to 100% transmission
at the resonant frequencies. In our case, a part of radiation is absorbed by the metal so that
the transmission never reaches 100%.

The observed structures in transmission are associated with resonant modes of the elec-

17

tromagnetic ﬁeld produced by coupled surface electromagnetic modes (called surface plasmon
polaritons) and waveguide modes inside the gratings. Some of these resonances posses rela-
tively long lifetimes. This can be immediately inferred from their width, as, e.g., the resonance
located at λ = 1.1D in the case of the grating with thickness h = 1.4µm. Another way to
observe the trapped ﬁeld resonances is to look at the time dependence of the ﬁeld transmitted
in the z-direction. The signal in Fig. 3 is registered by a detector placed at the distance of
3.5D behind the gratings. As seen in the ﬁgure, as soon as the resonances are populated by
an incident 25f s-long pulse, they radiate the ﬁeld during at least 125f s. Here the radiation
time is determined by the lifetime of the narrowest resonance located at λ = 1.1D. It is worth
mentioning that, as shows the sum of the transmission and reﬂection coeﬃcients, the total
absorption is largest at the resonance positions, i.e., when the interaction time between the
radiation (trapped mode) and the metal is large.

Finally, Fig. 4 shows the ﬁeld structure of a trapped mode corresponding to the narrowest
resonance observed with the h = 2.4µm thickness grating. The Ex component of the electric
ﬁeld is presented. It is obtained via suﬃciently long time propagation so that contributions
from less long-lived states vanish.

In Figs. 5 and 6 we show reﬂection coeﬃcients for dielectric gratings suspended in vacuum.
Simulations are performed using the conventional leapfrog scheme (5.3) applied to (4.5). Since
the attenuation is absent, the scheme is stable if the time step satisﬁes (5.6). The dielectric
material is modeled through the frequency independent dielectric constant ε = 2 (Fig.5) and
ε = 4 (Fig.6). Only the reﬂection coeﬃcient is shown here since there is no absorption of the
radiation in dielectric so that the transmission can simply be inferred from the unitarity of the
scattering matrix. Without gratings the dielectric slabs are basically transparent in both cases.
Introducing grating structures results in a complete reﬂection of the incident radiation within
an extremely narrow wavelength bandwidth. The associated guided mode resonances have been
extensively discussed in the literature [18]. In the case of ε = 2 the resonances are so narrow
that extraction of frequency dependent transmission and reﬂection coeﬃcients by the Fourier
transform of the scattered wave would require too large propagation time (see also Fig. 7). We
had to stop our wave packet propagation before the radiation emitted by resonances ended.
This explains why the reﬂection coeﬃcients do not reach its maximal value 1 in this case.
Consistently with the metal case, the number of resonant structures increases with increase
of the width h of the gratings. The width of resonances increases with ε as follows from the
comparison of Figs. 5 and 6. Note also that resonances are associated with Fano proﬁles that
usually arise because of the interference between the non-resonant and resonant contributions
to the scattered wave. Such narrow reﬂection structures in the case of dielectric gratings have
been usually studied by stationary methods in the frequency domain. An important advantage
of the time-dependent study is that one has an immediate access to all the details the temporal
evolution of electromagnetic ﬁelds in any desired part of the system.

In Fig. 7 we show the time dependence of the ﬁeld transmitted in the z-direction for gratings
characterized by ε = 2 and h = 0.8µm. With these parameters there is only one resonance in
the reﬂection spectrum. The signal is registered by a detector placed at the distance of 3.5D

18

behind the gratings. First, we observe that a 25f s incident pulse is transmitted through the
structure without modiﬁcation. The lasing eﬀect, when the transmitted ﬁeld is followed by
basically monochromatic radiation, can clearly be seen. For readability reasons we could not
show the complete time evolution in the ﬁgure, but the lasing eﬀect lasts for at least (!) 2ps
reﬂecting an extraordinary long lifetime of the trapped resonant ﬁeld. It is this radiation which
comes in the phase opposite to the corresponding harmonic in the transmitted initial pulse and
leads, ﬁnally, to the zero transmission at the corresponding frequency. The same lasing eﬀect to
the left from the grating structure is responsible for the 100% reﬂection at the same frequency.

In Fig. 8 we show a typical structure of the ﬁeld corresponding to a trapped (resonant)
mode. The Dx component of the electric induction is represented in the case of dielectric
gratings with ε = 4. The thickness of the dielectric slab is h = 0.6µm. Note that in contrast to
the metal grating structure, the ﬁeld in the present case occupies the entire slab and not only
the vacuum part of the grating.

8 Conclusions

We have developed a time domain algorithm for the initial value problem for the Maxwell’s
theory of linear passive media. The algorithm is based on (i) the Hamiltonian formalism for
evolution diﬀerential equations, (ii) the Fourier pseudospectral method in which the sampling
eﬃciency in designated space regions is enhanced by a suitable change of variables, and (iii)
the modiﬁed leapfrog scheme. We have analyzed the stability of the algorithm and found
explicit stability conditions when passive media are described by multi-resonant Lorentz models.
We have implemented and tested our algorithm for extraordinary transmission and reﬂection
gratings whose optical properties have been studied in a number of theoretical and experimental
works. Numerical simulations based on our algorithm are shown to produce extremely accurate
data for the well studied far-ﬁeld (zero-order diﬀraction) at relatively low computational costs.
A single simulation of an incident wideband wave packet is suﬃcient to determine transmission
and reﬂection properties of the gratings in the frequency range of the initial wave packet. In
addition, our algorithm allows us to see a real time dynamics of formation of long-living resonant
excitations of electromagnetic ﬁelds in the grating as well as formation of transmitted and/or
reﬂected wave fronts in the entire frequency range of the initial wave packet. It is believed that
our algorithm would be useful for numerical studies of other nanostructured materials.

Acknowledgments

S.V.S thanks the Laboratory of Atomic and Molecular Collisions of the University of Paris-
Sud for the warm hospitality and Dr. R. Albanese (Brooks, Air Force Base, TX) for his
continued interest and support of this project. The work of S.V.S. has been supported in part
by US Air Force Grants F4920-03-10414 and F49620-01-1-0473.

19

References

[1] V.I. Arnold, Mathematical methods of classical mechanics, Springer-Verlag, Berlin, 1989.

[2] R. Richtmyer and K.W. Morton, Diﬀerence Methods for Initial Value Problems, Interscience

Publishers, New York, 1967.

[3] M. Pickering, An introduction to fast Fourier transform methods for partial diﬀerential

equations, Research Study Press, John Wiley & Sons Inc., New York, 1986;
E.O. Brigham, The fast Fourier transform and applications, Prentice-Hall, Inc., Eglewood
Cliﬀs, New Jersey, 1988.

[4] E. Fattal, R. Baer and R. Kosloﬀ, Phys. Rev. E 53 (1996) 1217;

D. Lemoine, Chem. Phys. Lett. 320 (2000) 492.

[5] A.G. Borisov, J. Chem. Phys. 114, 7770 (2001).

[6] L.D. Landau and E.M. Lifshitz, Electrodynamics of continuous media, Theoretical Physics,

Vol. VIII, Oxford, Pergamon, New York, 1984.

[7] B. Fornberg, A practical guide to pseudospectral methods, Cambridge University Press, Cam-

bridge, 1996;
J.P. Boyd, Chebyshev and Fourier spectral methods, Springer-Verlag, New York, 1989.

[8] T.W. Ebbesen, H.J. Lezec, H.F. Ghaemi, T. Thio, and P.A. Wolﬀ, Nature (London) 391,

667 (1998).

[9] M.M.J. Treacy, Appl. Phys. Lett. 75, 606 (1999);
M.M.J. Treacy, Phys. Rev. B 66, 195105 (2002).

[10] F.J. Garcia-Vidal, L. Martin-Moreno, Phys. Rev. B66, 155412 (2002);

U. Schr¨oter and D. Heitmann, Phys. Rev. B 58, 15419 (1998).

[11] J.A. Porto, F.J. Garcia-Vidal, and J.B. Pendry, Phys. Rev. Lett. 83, 2845 (1999);

Ph. Lalanne, J.P. Hugonin, S. Astilean, M. Palamaru, and K.D. M¨oller, J. Opt. A: Pure
Appl. Opt. 2, 48 (2000).

[12] J.M. Steele, C.E. Moran, A. Lee, C.M. Aguirre, and N.J. Halas, Phys. Rev. B 68, 205103

(2003).

[13] H.J. Lezec, A. Degiron, E. Devaux, R.A. Linke, L. Martin-Moreno, F.J. Garcia-Vidal,

T.W. Ebbesen, Science 297, 820 (2002);
L. Martin-Moreno, F.J. Garcia-Vidal, H.J. Lezec, A. Degiron, and T.W. Ebbesen, Phys. Rev.
Lett. 90, 167401 (2003);
S. A. Darmanyan and A. V. Zayats, Phys. Rev. B 67, 035424 (2003);
A.P. Hibbins, J.R. Sambles, and C.R. Lawrence, Phys. Rev. E 61, 5900 (2000);
F. Yang and J.R. Sambles, Phys. Rev. Lett. 89, 063901 (2002);
W.-C. Tan, T.W. Preist, and R.J. Sambles, Phys. Rev. B 62, 11134 (2000)

20

[14] S.V. Shabanov, Electromagnetic pulse propagation in passive media by path integral meth-
ods, a LANL e-preprint, 2003, math.NA/0312296 (submitted to Appl. Comput. Harm. Anal-
ysis)

[15] R.M. Joseph, S.C. Hagness, and A. Taﬂove, Opt. Lett. 16 (1991) 1412;

L.Gilles, S.C. Hagness, and L. V´azquez, J. Comput. Phys. 161 (2000) 379.

[16] A.G. Borisov and S.V. Shabanov, Chem. Phys. Lett. 361 (2002) 15.

[17] H. Shintani and K. Tomoeda, Hiroshima Math. J., 7 (1977) 309.

[18] K. Koshino, Phys. Rev. B 67, 165213 (2003);

L. Pilozzi, A. D’Andera, R. Del Sole, Phys. Rev. B 54, 10763 (1996)

21

Figures

Fig. 1 A schematic representation of the studied system. The incident wave packet propa-

gates along the normal to the slab containing the gratings (z-direction).

Fig. 2. Calculated zero-order transmission (solid lines) and reﬂection (dashed lines) coef-
ﬁcients for metallic gratings described in the text. The results are presented as a function of
the wavelength λ of the incident radiation measured in the units of the period of the gratings,
D. Diﬀerent panels of the ﬁgure correspond to the diﬀerent thickness h of the gratings, as
indicated.

Fig. 3. The electric ﬁeld measured by a detector placed behind the metallic gratings
with thickness h = 1.4µm. Only the ﬁeld corresponding to the zero-order transmitted wave
propagating along the z-axis is represented. It is obtained by the Fourier analysis of the x-
coordinate dependence of the ﬁeld at the detector position. The signal is shown as a function
of time measured in femtoseconds.

Fig. 4. A snapshot of the x-component of the electric ﬁeld, Ex for the grating thickness
h = 2.4µm. The results are presented as a function of x and z coordinates measured in units
of D. Red and blue colors correspond, respectively, to positive and negative values of the ﬁeld.
The snapshot has been produced after a suﬃciently long propagation time so that the ﬁeld
pictured in it indeed corresponds to the long-lived resonance giving enhanced transmission at
λ = 1.15D (see Fig.2).

Fig. 5. Calculated zero-order reﬂection coeﬃcient for dielectric gratings with ε = 2. The
results are presented as a function of the wavelength λ of the incident radiation measured in the
units of the period of the gratings, D. Diﬀerent panels of the ﬁgure correspond to the diﬀerent
thickness h of the gratings, as indicated.

Fig. 6. Calculated zero-order reﬂection coeﬃcient for dielectric gratings with ε = 4. Results
are presented as a function of the wavelength λ of the incident radiation measured in the units
of the period of the gratings, D. Diﬀerent panels of the ﬁgure correspond to the diﬀerent
thickness h of the gratings, as indicated.

Fig. 7. The electric ﬁeld measured by a detector placed behind the dielectric grating
with thickness h = 0.8µm and dielectric constant ε = 4. Only the ﬁeld corresponding to the
zero-order transmitted wave propagating along the z-axis is represented. It is obtained by the
Fourier analysis of the x-coordinate dependence of the ﬁeld at the detector position. The signal
is shown as a function of time measured in femtoseconds.

Fig. 8. A snapshot of the x-component of the electric induction, Dx for the dielectric
grating with dielectric constant ε = 4 and thickness h = 0.6µm. The results are presented as
a function of x and z coordinates measured in units of D. Red and blue colors correspond,
respectively, to positive and negative values of the induction. The snapshot has been produced
after a suﬃciently long propagation time so that the induction pictured in it indeed corresponds

22

to the resonance giving enhanced transmission at λ ∼= 1.3D (see Fig.6).

23

This figure "Fig1.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig2.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig3.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig4.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig5.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig6.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig7.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

This figure "Fig8.png" is available in "png"(cid:10) format from:

http://arXiv.org/ps/physics/0312103v1

