5
0
0
2
 
n
u
J
 
0
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
9
5
1
6
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

First principles electron transport: ﬁnite-element implementation for nanostructures

P. Havu1, V. Havu2, M. J. Puska1, M. H. Hakala1, A. S. Foster1, and R. M. Nieminen1
1) Laboratory of Physics, Helsinki University of Technology, P.O. Box 1100, FIN-02015 HUT, Finland and
2) Institute of Mathematics, Helsinki University of Technology, P.O. Box 1100, FIN-02015 HUT, Finland
(Dated: February 2, 2008)

APS/123-QED

We have modeled transport properties of nanostructures using the Green’s function method within
the framework of the density-functional theory. The scheme is computationally demanding so that
numerical methods have to be chosen carefully. A typical solution to the numerical burden is to
use a special basis-function set, which is tailored to the problem in question, for example, the
atomic orbital basis. In this paper we present our solution to the problem. We have used the ﬁnite
element method (FEM) with a hierarchical high-order polynomial basis, the so-called p-elements.
This method allows the discretation error to be controlled in a systematic way. The p-elements
work so eﬃciently that they can be used to solve interesting nanosystems described by non-local
pseudopotentials.

We demonstrate the potential of the implementation with two diﬀerent systems. As a test system
a simple Na-atom chain between two leads is modeled and the results are compared with several
previous calculations. Secondly, we consider a thin hafnium dioxide (HfO2) layer on a silicon surface
as a model for a gate structure of the next generation of microelectronics.

PACS numbers: 72.10.-d, 71.15.-m, 73.40.-c

I.

INTRODUCTION

Using small nano-scale lithographic structures, atomic
aggregates and even single molecules, it is possible to fab-
ricate new kind of electronic devices [1]. The function and
scale of these devices is based on quantum-mechanical
phenomena, and cannot be described within the classical
regime. Of particular relevance are the electron trans-
port properties of these nanoscale devices, as this will
determine their eﬀectiveness in, for example, a new gen-
eration of transistors. As the experimental work on these
devices grows, increasing emphasis is placed on develop-
ing a matching theoretical description [2, 3]. Although
some eﬀorts have included a full description of an elec-
tronic circuit [4, 5], current research is mainly focused to
study single electronic components.

Density-functional theory (DFT) is widely used in
atomistic modeling of materials properties and recently
also properties and phenomena in nanostructures. The
power of DFT is in its capacity to treat accurately sys-
tems with a hundreds of atoms, yet retain a full quantum-
mechanical treatment. Although the full justiﬁcation of
use of the DFT in electron transport calculations is de-
bated [6, 7] we adopt it as a practical scheme to describe
the real systems and devices.

In the Kohn-Sham scheme of DFT the electron den-
sity is calculated using single-particle wave functions.
The explicit use of the wave functions in constructing
the density suﬃces well in two kinds of systems. Either
the system has a repeating structure so that it can be
modeled with periodic boundary conditions or the sys-
tem is so small that it can be calculated as a whole. In
nano electronics, however, a system consists usually of a
small ﬁnite part, the nanostructure, which is connected
to the surrounding inﬁnite leads. If one enforces periodic
boundary conditions even a large repeating super cell or

calculation volume can cause ﬁnite-size eﬀects with spu-
rious results for electron transport.

A commonly used solution to this problem, which we
have also employed, is to combine DFT with the Green’s
function formalism [1]. The Green’s functions are ﬁrst
constructed for the semi-inﬁnite leads by using the ana-
lytically known or easily calculated wave functions. Once
the Green’s function for the combined nanostructure and
leads is constructed, the wave functions are no longer
needed explicitly. This makes it possible to use open
boundary conditions between the nanostructure and the
lead. In this way we have an eﬀectively inﬁnite system
without periodicity, making the ﬁnite-size eﬀects small.
It is also possible to calculate the electric current through
the system for a ﬁnite bias voltage between the leads in a
self-consistent manner with the electron density. The en-
suing model for the current is analogous to the Landauer-
B¨utteker model [2]. We have used non-local pseudopo-
tentials for modeling atoms, and the ideal metal “jellium”
model for the leads. The charge density in the leads can
be varied according to the conducting properties of the
leads we wish to model.

The use of Green’s functions instead of the explicit use
of wave functions is computationally demanding. This
is why special care has to be taken in choosing the nu-
merical methods. The ﬁrst implementations used tight-
binding methods [8, 9], but a more typical solution is
to expand the Green’s functions in a special basis tai-
lored for the system. Common examples are localized
atomic orbitals [10, 11], an O(N ) optimized basis [12],
a wavelet basis [13], full-potential linearized augmented
plane-waves [14], maximally localized Wannier functions
[15], a ﬁnite-diﬀerence method [16], and linear a ﬁnite-
element method [17]. Our solution is to use the ﬁnite-
element method (FEM). It allows a systematic error con-
trol which is especially important in transport problems

as there are many diﬀerent properties which must be
monitored. For example, the pole of the Green’s func-
tion can cause numerical problems. According to our
experience electronic tunneling in particular is sensitive
to numerical accuracy.

Besides systematic error control, the FEM has also
other good properties which makes it a natural method
for transport problems.
It is a ﬂexible method which
allows one to take into account the geometry of the
nano device exactly. Special boundary conditions are
easy to derive without mixing the model with the nu-
merical method and their implementation is straightfor-
ward. Moreover, the local nature of the basis produces
sparse matrices for which eﬃcient solving methods exist.
Varying the size of the elements can be used to reduce
the number of the basis functions and, consequently, the
size of the system as compared to the ﬁnite-diﬀerence
method. This is especially true for the high-order p-
method. Finally, there exists a lot of theoretical work
together with tested and reliable tools, such as mesh gen-
erators and optimized linear solvers. These are used as
standard building blocks for any FEM implementation
granting easy access to state-of-the-art algorithms. Us-
ing the FEM new theoretical or numerical ideas are easy
to implement and test.

The structure of the paper is as follows: in Sec. II we
describe the model itself in detail, including a discussion
of the formalism of our implementation; in Sec. III we
apply the model to two example systems, a Na atom
chain and HfO2-Si interface between two leads. In Sec.
IV we summarize the work. In this paper we use atomic
units in all equations.

II. MODEL

The schematic picture of our model is shown in Fig. 1.
Actually, the ﬁgure present our second test case, the
HfO2-Si interface between two leads. We have an atom-
istic nanostructure between two semi-inﬁnite leads. The
system is divided into three parts, Ω being the calcula-
tion volume, and ΩL and ΩR are left and right leads,
respectively. The boundaries ∂ΩL/R are open so that
electrons can penetrate through them without any re-
ﬂection or refraction. We use the DFT to model electron
interactions. The basic quantity, the electron density, is
calculated from single-particle Green’s functions. Then
we use the density to calculate the eﬀective potential as

Veﬀ = Vext + Vc + Vxc + Vbias + ˆVnl,

(1)

where Vext is the external potential caused by positive
background charges, local parts of the pseudopotential
operators and the potential outside potential barriers.
Vc is the Coulomb Hartree interaction part, and Vxc is
the exchange-correlation part which we calculate using
the local-density approximation parametrized by Perdew
and Zunger [18, 19]. Vbias sets the boundary conditions

Semi infinite leads

2

∂ΩP1

ΩL

Ω

∂Ω
L

ΩR

∂Ω
R

∂ΩP2

FIG. 1: Schematic picture of the model. The HfO2 interface
is used as an example. The small and large gray gray spheres
denote the Hf and Si atoms, respectively, and dark spheres the
O atoms. The gray volumes are the jellium leads. The system
consist the volumes ΩL, Ω, and ΩR and of the boundaries
∂ΩL, ∂ΩR, ∂ΩP 1, ∂ΩP 2, ∂ΩP 3, and ∂ΩP 4.

if a bias voltage is applied. ˆVnl is the nonlocal part of the
pseudopotential operators.

The Hartree potential is calculated from the modiﬁed

Poisson equation

2V i

c −

∇

k2
PV i

c = 4π(ρ+ −

ρ)

−

k2
PV i
−
c

1

,

(2)

where kP is an adjustable parameter. kP does not af-
fect the ﬁnal self-consistent result, but the stability and
convergence of iterations are improved [20], because the
Coulomb potential due to charge redistribution between
adjacent iterations is screened. The non-local pseudopo-
tential is an operator given by

ˆVnlv(r) =

el,mζl,m(r)

ζl,m(r′)v(r′)dr′,

(3)

Xl,m

ZΩ

where el,m and ζl,m(r) are deﬁned using the Troullier-
Martins pseudopotentials [21, 22]. Eq. (3) uses the pro-
jection of the function v(r) (arbitrary function, which in
practical calculations is a basis function) on the atomic-
speciﬁc function ζl,m depending on the quantum numbers
l and m corresponding to the angular momentum.

We have implemented the guaranteed-reduction-Pulay
[23] method for the mixing of the self-consistent itera-
tions. It uses potentials from the ﬁve previous iterations
for computing a new potential in such a way that the pre-
dicted norm of the potential residue is minimized. The
simplest mixing scheme in which potentials are mixed
with a linear feed-back coeﬃcient does not work well in
open systems. The calculations are rather unstable so
that quite a small feed-back coeﬃcient has to be used.
This is because the net charge in the calculation volume
Ω varies during the calculations.

A. Green’s function model

The details of the Green’s function method for electron
transport in nanostructures are explained, for example,
in Ref. [24]. Here we give only a short introduction to the
equations to be solved. The retarded Green’s function Gr
is solved from the equation

ω

−

ˆH(r)

Gr(r, r′; ω) = δ(r

r′),

(4)

−

(cid:0)
where ω is the electron energy and ˆH is the DFT Hamil-
tonian of the system,

(cid:1)

−

ˆH(r) =

2 + Veﬀ (r).

1
2 ∇
When we know Gr we can calculate the so-called lesser
Green’s function G<. In the equilibrium when no bias
voltage is applied over the nanostructure it is obtained
from

(5)

G<(r, r′; ω) = 2fL/R(ω) Gr(r, r′; ω),

(6)

where fL/R are the Fermi functions of the leads. In the
equilibrium, fL = fR. For a ﬁnite bias voltage fL/R
we take into account the bias and a more complicated
equation for G< has to be used. To obtain it we write
Eq. (4) in the form
ˆH0 −

Gr(r, r′; ω) = δ(r

r′), (7)

R(ω)

L(ω)

Σr

Σr

−

−

−

ω

(cid:0)
(cid:1)
where ˆH0 is the Hamiltonian of the isolated volume Ω
and Σr
L/R are the so-called self-energies of the leads. We
also deﬁne

iΓL/R = Σr

L/R −
and can solve G< for a ﬁnite bias voltage as

Σa

L/R = 2i Im(Σr

L/R),

(8)

G<(r, r′; ω) =

−

−

ifR(ω)

Gr(r, rR; ω) ΓR(rR, r′R; ω)

Z∂ΩR Z∂ΩR

Ga(r′R, r′; ω) drR dr′R

(9)

ifL(ω)

Gr(r, rL; ω) ΓL(rL, r′L; ω)

Z∂ΩL Z∂ΩL

Ga(r′L, r′; ω) drL dr′L.

×

×

The ﬁrst and second terms correspond to electrons orig-
inating from the right- and left leads, respectively. The
electron density is calculated from

1
ρ(r) = −
2π

Z

−∞

∞

Im(G<(r, r; ω))dω

(10)

and the tunneling probability from

T (ω) =

×

ΓL(rL, r′L; ω) Gr(r′L, rR; ω)

Z∂ΩL Z∂ΩL Z∂ΩR Z∂ΩR
ΓR(rR, r′R; ω) Ga(r′R, rL; ω) drL dr′L drR dr′R,

3

from the values of the functions at the boundaries ∂ΩL/R.
Finally the current is determined as

I =

T (ω) (fL(ω)

fR(ω)) dω.

(12)

−

1
π

∞

Z

−∞

We use the FEM in the numerical implementation.
Therefore we ﬁrst cast Eq. (4) in the variational form
with open boundary conditions (for the derivation, see
Ref. [25]) as

Gr(r, r′; ω)

ZΩ

− ∇
n
+ v(r)

1
2 ∇
Veﬀ (r)

v(r)

·

ω

−

< ˆΣLGr, v >

(cid:2)

o
< ˆΣRGr, v >
(cid:3)

−

−
= v(r′),

Gr(r, r′; ω)

dr

(13)

where the self energy-operators

< ˆΣLGr, v >=

Z∂ΩL Z∂ΩL
∂2ge(r′L, rL; ω)
∂nL∂n′L

×

1
4

Gr(r′L, r′; ω)

v(rL) dr′LdrL.

(14)

Above, ge is the Green’s function of the semi-inﬁnite lead
in the domain ΩL/R with the zero-value condition on the
boundary ∂ΩL/R. In our implementation the leads are
described by a uniform positive background charge and
therefore ge can be calculated partly analytically. Thus
our model means that the leads are of some kind of ideal
generic metals. The important interface between the
nanostructure, e.g. a molecule, and the actual metal-
lic lead can be described accurately by including some
lead metal atoms in the computational domain Ω. It is
also possible to use fully atomistic leads by calculating
numerically ge for them.

Note that the Eqs. (13) and (14) are analogous to those
derivations of the open boundary conditions in which
truncated matrices [1] are used. In the continuum limit
these two forms give the same results. However, the weak
form is more natural in the FEM formulation and more
suitable for theoretical purposes when analyzing nonlin-
ear partial diﬀerential equations. It is also straightfor-
ward to use and the error control is systematic. Note
that this formulation can be used with any continuous
basis set, not only with the FEM. In the context of basis
set methods, the weak formulation case is known as the
Galerkin method. In practice the Green’s functions are
approximated with respect to this basis so that

Gr(r, r′; ω)

gij(ω)φi(r)φj (r′).

(15)

N

≈

i,j=1
X

(11)

The coeﬃcients gij(ω) can be solved from (13) by choos-
ing v = φk and evaluating the equations.

B. Finite-element p-basis

functions. E.g. for the edge between the nodes 1 and 2

In the FEM we partition the calculation volume to (in
our case, tetrahedral) sub-domains called elements and
the basis functions φi are constructed using globally con-
tinuous (but not necessarily continuously diﬀerentiable)
piecewise polynomials with respect to the ﬁnite element
mesh. This gives both unique ﬂexibility of the approxi-
mating functions as well as completeness of the basis with
respect to almost any norm. Each basis function has a
support that is concentrated to only a few neighboring
elements. This makes the basis local and results in sparse
system matrices.

There are several options of how to choose the ﬁnite-
element basis and one has to be careful in achieving ac-
ceptable accuracy. The simplest basis is the linear one. It
is easy to implement and works well, especially in systems
with rapidly varying functions. A typical improvement
to this basis is to use node-based higher-order elements.
These elements converge faster to a smooth solution than
the linear ones. However, practically only relatively low
orders, two and three, can be used because of numerical
stability problems.

In this work we have used so-called hierarchical p-
elements. They also span higher-order polynomials, but
the choice of the local basis ensures that stability prob-
lems do not appear. This is because the basis functions
are chosen so that their derivatives are close to orthogo-
nal in the L2-norm. The hierarchical nature also makes
it easy to change the order of the basis from element to
element within the same mesh.

The actual FEM implementation consists of a refer-
ence element and reference basis that are mapped sep-
arately to each of the elements of the mesh. Our ref-
erence element is a tetrahedron with nodes at the co-
1, 0, 0), 2 : (1, 0, 0), 3 : (0, √3, 0) and
ordinates 1 : (
−
4 : (0, 1
2
3 ). One can easily show that there exists
√3
an aﬃne map taking the reference element to any of the
tetrahedron. The order of our basis is p meaning that in
each element polynomials of the order of p are employed.
The basis is constructed hierarchically. First, there are
four linear node basis functions inside the elements shar-
ing a common node. In the reference element they are

q

, 2

ζ
√6
ζ
√6

(cid:19)

(cid:19)

−

µ
√3 −
µ
√3 −
−
ζ
√8

(cid:19)

L1 =

L2 =

L3 =

L4 =

1
2
1
2
(cid:18)
1
√3
3
8

r

ξ

−

1
(cid:18)

1 + ξ

µ

−

(cid:18)

ζ

(16)

where ξ µ and ζ are the cartesian coordinates of the ref-
1) edge
erence element. Secondly, for p >1 we have 6(p

−

4

(18)

N (1,2)
i
−

1 = L1L2ϕi(L2 −

L1), i = 2, ...p.

(17)

Here one usually sets

ϕi(ξ) =

φi(ξ) =

4φi(ξ)
ξ2
1

−

1
2(2i

s

(Pi(ξ)

Pi

2(ξ))

−

−

1)

−

Above Pi is the Legendre polynomial of the order of i.
Third, we have 2(p
2) face functions. For example
−
for the face between the nodes 1,2, and 3 they are

1)(p

−

N (1,2,3)
i,j

= L1L2L3Pi(L2 −
i, j = 0, ..., p

L1)Pj (2L3 −
3, i + j = 0, ..., p
−

−

1),

3.

(19)

Fourth, we have 1
3) bubble functions,
−
which are supported only in a single element each. These
are

6 (p

1)(p

2)(p

−

−

Ni,j,k = L1L2L3L4 Pi(L2 −
Pj (2L3 −
4, i + j + k = 0, ..., p

L1)
1) Pk(2L4 −
−

−

×
1)
4.

i, j, k = 0, ..., p

(20)

3

When p-elements are used one must take care of the
continuity of the basis. This is because, for example,
the local basis function N (1,2)
has an orientation on the
boundary. The basis includes the function ϕ(L2 −
L1),
L2), which would be another possibility. This
not ϕ(L1 −
means that all the edges in the mesh have to have in-
formation about the direction. Otherwise there is very
likely a continuity problem on some boundaries. In prac-
tice, for tetrahedral elements the orientation problem can
be handled for arbitrary ﬁnite-element meshes using only
two reference elements [26].

The beneﬁts of selecting the basis described above are
rather clear. The polynomial basis is very easy to real-
ize and has good approximating properties. For smooth
solutions the p-basis is known to give exponential conver-
gence rates with respect to the number of basis functions
used. In the DFT methods the theory is typically devel-
oped to the direction that the solutions are as smooth
as possible. For example, pseudopotential operators are
designed so that they produce as smooth an electron po-
tential as smooth as possible. This is because the plane-
wave basis set needs smooth solutions in order to work
eﬃciently. On the other hand, in the case of non-smooth
solutions one can beneﬁt from the piecewise nature of the
FEM basis allowing one to approximate even singular so-
lutions to some extent. Moreover, the ﬁnite element mesh
can be reﬁned in regions where solution changes rapidly.
When modeling molecules there is also a lot of empty
space in the calculation domain. It is then practical to
use large elements in the empty space and smaller ones
near atoms.

C. Linear algebra methods

The use of the Green’s function method is compu-
tationally demanding in comparison to explicit wave-
function methods. Since the main computational burden
of our method is to ﬁnd a subset of the coeﬃcients of
the Green’s function in question, a special consideration
must be taken when choosing the methods of linear al-
gebra to be used. The eigenvalue problems in explicit
wave-function methods are typically solved by iterative
methods. In our case it is better to use direct solvers,
because a set of linear equations needs to be solved. We
have opted for the frontal method widely used in the
solution of sparse linear systems [27, 28] and extremely
suitable for ﬁnite-element matrices. The actual imple-
mentation is ME47 of the Harwell Subroutine Library
(HSL) [29] (see Refs. [30, 31, 32] for other similar ap-
proaches). In the frontal method, one ﬁrst ﬁnds a per-
mutation of the sparse matrix aiming to minimize the
ﬁll-in resulting from the factorization process. Next, a
LU-decomposition (or Cholesky-decomposition for sym-
metric problems) of the matrix A is found, and ﬁnally,
two systems with triangular coeﬃcient matrices, Lz = b
and U x = z (where U = LT for symmetric problems) are
solved. To ﬁnd all the required coeﬃcients of the solution
we must vary the right-hand side b of the system.

For a three-dimensional problem the size of the linear
system can grow so large that the CPU-time and memory
requirements of diﬀerent systems have to be addressed.
The main question is how large systems can be calculated
using these methods so that the calculation time for a
single self-consistent iteration is not too large. Currently
a system of several tens of thousands of unknowns can
be solved in a commodity-CPU cluster environment.

×

In detail, the Green’s function method includes a com-
putation of the elements for the inverse of a sparse ma-
trix, so that the calculation time requirements increase
relatively fast with the system size. A classical complex-
ity result for the solution (and inversion) of a general
N system with a direct method is O(N 3). How-
N
ever, for sparse systems and modern frontal methods this
bound is too pessimistic [33]. The CPU time require-
ment depends on the ﬁll-in of the inversion problem. For
very simple cases one can show that the key statistic
of the problem, the number of non-zeros (nnz) present
nnz(U ) =
in the factors L and U , satisﬁes nnz(L)
O(N log (N )) [33]. Then the solution of each of the
systems requires O(nnz(L) + nnz(R)) ﬂoating-point op-
erations, and in the worst case we must solve these
with N diﬀerent right-hand sides eﬀectively giving us
the inverse of the matrix A, so that the total cost is
O(N (nnz(L) + nnz(R))). However, in modern computer
systems the complexity is not the only relevant measure
since the performance may be highly nonlinear (see, e.g.
[34, 35] for an example on BLAS-tuning).

∼

Another topic related directly to the performance of
modern computer systems is the relation between proces-
sor power and memory bandwidth. This is especially true

5

for the computation of the Green’s function where the ac-
tual bottleneck is the lack of available memory bandwidth
in commodity-based cluster systems used in calculations,
not the ﬂoating-point performance of the processor itself.
It is likely that a better performance can be achieved
by upgrading several parts of the algorithms. First, the
current parallel solver is implemented using the Mes-
sage Passing Interface (MPI) [36]. However, in Symmet-
ric multiprocessor (SMP) systems it is likely that well-
designed OpenMP [37] (or similar) parallelism would re-
duce the need for data transfer and thus increase perfor-
mance. It would also decrease the memory requirements
of the problems. Second, at the moment the solution
of the Green’s function is computed varying one vector
on the right-hand side at a time. A better performance
could be obtained if the equations could be solved for
multiple right-hand sides at a time allowing the use of
BLAS3 routines. Finally, it is likely that computations
would beneﬁt from a computer system having a larger
memory bandwidth than our present commodity-based
one.

III. EXAMPLE SYSTEMS

A. Atomic wire

Using the atomic force microscope or the mechanically
controlled break junction technique, a chain of atoms can
be made of certain metals [38].
It has been observed
that the conductances of atom chains vary as a function
of the number of atoms in the chain [39]. The conduc-
tances of these systems have been studied also theoreti-
cally in several works. In order to benchmark our results
against other calculations, we use Na-atom chains as test
systems. They have been simulated in several previous
studies [40, 41, 42, 43] using diﬀerent models. According
to these calculations the conductances of the wires show
even-odd oscillation as a function of the number of atoms
in the wire.

In our setup, the Na-atom chain is located between two
leads, with the lead shape deﬁned by a 70◦ cone angle
(see Fig. 2). We consider two diﬀerent connections of the
atom chain to the electrodes. In model A we have just
three Na atoms between the jellium leads. This resembles
closely the system used in Ref. [41]. In model B, there are
four Na atoms at the tips of the leads in a square form.
This makes the connection between the atom chain and
the leads more realistic. This kind of structure is modeled
also in Ref. [42].

The conductances as a function of the number of chain
atoms for systems A and B are shown in Fig. 3. In the
Na-atom chain, electrons have only one conducting mode
so that the conductance can be one conductance quan-
tum 2e2/h at maximum. Both systems A and B exhibit
conductance oscillations as a function of the number of
atoms. These oscillations arise from resonance states in
the atom chain. Depending on the position of the reso-

Ω

Na

Ω

Na

50o

90o

a)

∂ΩL

ΩL

b)

ΩL

α

α

1

70o

2

)
h

/

e
2
(
 

e
c
n
a
t
c
u
d
n
o
C

0.8

0.6

FIG. 2: Two models of the Na-atom chain. a) In model A,
Na atoms are directly connected to the cone-shape leads. b)
In model B, there are four Na atoms as squares at the tips of
the leads.

A
B

70o

1

2

3
Number of Na atoms in the chain

4

5

FIG. 3: Conductance through the Na-atom chain as func-
tion of the number of Na atoms in the chain. The results
for systems A and B (see Fig. 2) are denoted by circles and
stars, respectively. For system A with three Na atoms, results
◦
corresponding to 50

cone angles α are also given.

◦
and 90

×

nances relative to Fermi-level the conductance has either
a maximum or minimum value, so that the maxima and
minima correspond to approximately half and fully oc-
cupied resonance states, respectively. The oscillation is
2e2/h for system A and
within the range of 0.9 - 1.0
2e2/h for system B. The diﬀerence between
0.6 - 1.0
the oscillation amplitudes is due to diﬀerent strengths of
the connection of the chains to the leads. System B has
a weaker coupling to the leads than system A. Weak con-
nections make the resonances also sharper, as is seen in
the tunneling probability in Fig. 4. In contrast to Ref.
[44], we do not see a strong lead-shape dependence in the
conductance. The widening of the cone angle lowers the
conductance as the edges of the wire become sharper.

×

The electron tunneling probabilities through chains

∂ΩP1

3 Na atoms

A

B

6

∂ΩR

ΩR

Jellium

∂ΩP2
∂ΩP1

ΩR

∂ΩP2

1

0.5

0
−1.5

1

0.5

0
−1.5

)
h
/

2

e
2
(
 
)

(ω
T

 
,
y
t
i
l
i

b
a
p
o
r
p
 
g
n

i
l

e
n
n
u
T

−1

−0.5

0

0.5

4 Na atoms

B

A

−1

−0.5
Electron energy (eV)

0

0.5

FIG. 4: Tunneling probability from Eq. (11) for three- and
four- atom chains between two semi-inﬁnite jellium leads. The
solid and dashed lines correspond to systems A and B shown
in Fig. 2, respectively. The Fermi-level is marked by dashed
◦
vertical lines. The cone angle α=70

of three- and four- atom systems A and B are shown
in Fig. 4. The probability function T (ω) is deﬁned in
Eq. (11). The conductance of the system in the zero-bias
limit can be read at the Fermi-level. Here, as well as in
Fig 3, we see that the conductance oscillations for sys-
tems A and B are in a diﬀerent phase. This is because
in system B the atom chain is eﬀectively shorter than in
A, as the ﬁrst and the last chain atom are partly inside
the square of the four Na atoms.

When we compare the conductance oscillations of sys-
tem A (see Fig. 3) to those in Ref. [41] obtained by us-
ing semi-inﬁnite jellium leads with planar surfaces (α =
180◦), we see that the even-odd oscillations in the con-
ductance are in the same phase. In the case of system
B we can directly compare the tunneling probability of
Fig. 4 with those in Ref. [42] where the atom chain is con-
nected also through a square of four Na atoms to jellium.
The phase and the amplitude of the conductance oscil-
lations of these results are in good agreement with our
values in Fig. 3. Now that we have satisﬁed ourselves that
the method provides a good model for electron transport
we can consider a more interesting and demanding ex-
ample.

B. Thin insulating layer

The general increase in the performance of microelec-
tronic devices in the past few decades has been made
possible by continuous transistor scaling - based on a re-
duction in the thickness of the gate dielectric in typical
metal-oxide-semiconductor ﬁeld-eﬀect transistors (MOS-
FET). At present the process has reached a bottleneck,
as further reduction leads to a large increase in leakage

2.5

−3

x 10

02
a

3

 
/
 
)

ω
(
T

6

5

4

2

1

0

1.5

)
h
/

2

e
2
(
 
)

ω
(
T

0.5

2

1

0

0.3

0.25

0.2

0.15

0.1

0.05

0

)

V
e
(
 
e
c
n
e
r
e
f
f
i
d
 
l
a
i
t
n
e
t
o
P

−0.05
0

current due to direct tunneling across the thin silicon
dioxide (SiO2) layer. Several possible approaches to re-
solve this are being considered [45], but retaining conven-
tional MOSFET design remains an economically attrac-
tive choice, and a leading option is just to replace SiO2
with another oxide of higher dielectric constant (high-k).
A high-k oxide would provide higher eﬀective capacitance
to a comparable SiO2 layer, hence allowing thicker layers
to be used to reduce losses due to tunneling. The speciﬁc
choice of oxide is determined by a set of requirements [46]
based on both the intrinsic properties of the grown oxide
and its integration into the fabrication process, and at
present hafnium oxide (HfO2) remains a leading candi-
date.

In order to study to transport properties of thin HfO2
ﬁlms we have simulated the growth of the oxide on a sil-
icon surface via ﬁrst principles molecular dynamics [47].
Here we consider three model interfaces: (i) a nonstoi-
chiometric oxide interface (C), which is basically metallic
due to Hf-Hf and Hf-Si bonds across the interface; (ii) a
stoichiometric oxide interface ( D), which has a localized
state in the band gap due to a few Hf-Hf bonds; (iii) a
more idealistic interface (E), which remains insulating if
no defects are present. The last model is based on the
interface used in Ref. [48], but slightly reduced in size to
make it computationally manageable [49]. These models
were calculated with periodic boundary conditions with
k-points on the boundaries ∂ΩP 1/P 2/P 3/P 4. The eﬀective
potentials have been calculated for systems C and D us-
ing the gamma point, and for system E, four k-points.
All the tunneling probabilities T (ω) are calculated using
four k-points, which was enough to converge the proba-
bilities to a good accuracy.

As shown in Fig. 1, the interface models are positioned
between two leads. The charge density in the leads is
chosen so that in the right lead rs = 2 (electron density
ne = 3/(4πr3
s)), representing a metal, and in the left one
rs = 3.1, representing doped-silicon - as in a standard
MOSFET design.

The tunneling proﬁles of the systems are shown in
Fig. 5. Here it is seen that systems C and D show clearly
metallic behavior, with a large tunneling probability at
the Fermi energy. Although in principle, the stoichio-
metric interface (D) has a much lower density of metallic
bonds, it is clear that both in interfaces C and D around
two channels dominate the transport. The localized de-
fect state in the band gap of system D plays an equivalent
role in transport to the metallic bonds in interface C.

As expected, the tunneling probability for the more
ideal interface E is an order of magnitude smaller at the
Fermi energy than those for interfaces C and D. Yet we
also see that it remains signiﬁcant - this is largely due
to the structure of the interface itself [48]. Although
bulk HfO2 is a wide-bandgap insulator, at the interface
it exists as almost tetragonal HfSiO4, and the eﬀective
band gap is actually smaller than that of bulk silicon
below the interface. This means that there is a negative
conduction band oﬀset between silicon and HfO2, and no

7

C

D

E

−5

−4

−3

−2

−1

0

Electron energy (eV)

−5

−4

−3

−2

−1

0

Electron energy (eV)

FIG. 5: Tunneling probability T (ω) through thin HfO2 lay-
ers. Results for system C (dotted line) - nonstoichiometric
interface, system D (solid line) - stoichiometric interface and
system E - ideal interface are shown. The inset shows T (ω)
normalized with the conducting area enabling the comparison
of actual insulating properties of diﬀerent systems.

real barrier for leakage. Although some of this is caused
by the underestimation of the band gap in the DFT, this
also reduces the silicon band gap (although the eﬀect is
not systematic).

5

10

20
)
Position along transport direction (a
o

15

25

FIG. 6: Change of the average eﬀective potential in inter-
face D when a 0.25 V bias voltage is applied over the HfO2
layer. In every position along the transport direction the eﬀec-
tive potential is averaged over the perpendicular-coordinates.
Atom positions are indicated: open circles are silicon, ﬁlled
circles, and stars hafnium and oxygen atoms, respectively.
The gray areas mark the positions of the leads.

The poor performance of interface D can also be seen
in its capacity for dropping the potential. Fig. 6 shows

the potential change for 0.25 V applied bias voltage. The
potential drop across HfO2 is less than 0.05 eV, demon-
strating that the oxide hardly perturbs the electron ﬂow
from the right lead. The potential drops fastest at the
right hand side of HfO2-layer where pure HfO2 exists,
and much more slowly in the thin layer of SiO2 formed
due to diﬀusion of oxygen. The large drop at the lead
and silicon atoms is just an artifact of the boundary con-
ditions of the Coulomb part of the eﬀective potential.

In the rigid band approximation (used for example in
Ref. [48]) it is assumed that the shape of the tunneling
probability stays constant and is only shifted in energy
so that T (ω, Vbias) = T (ω + ηVbias), where η is the ratio
of potential drop at the other end of the nanostructure to
the total drop over the nanostructure. In Fig. 7 we have
studied how well this approximation works for interface
D. The curves are plotted so that the zero-bias Fermi
level is in the middle of the left and right Fermi levels of
the biased interface. This corresponds to the symmetric
case with η = 0.5. We see that the tunneling proba-
bility curves roughly coincide. This indicates that po-
tential drops symmetrically over the nanostructure and
the rigid-band approximation gives a rather reasonable
result.

2.5

1.5

)
h
/

2

e
2
(
 
)

ω
(
T

0.5

2

1

0

8

calculations [48] that tunneling through a more ideal,
insulating interface is still signiﬁcant due to a negative
band oﬀset with silicon. Since the only HfO2 interfaces
providing signiﬁcant band oﬀsets to silicon were built
very idealistically (i.e. assuming no signiﬁcant atom mi-
gration nor interfacial SiO2 growth) [50, 51], this indi-
cates that fabricating a good interface directly between
silicon and HfO2 is very diﬃcult. A more viable alterna-
tive maybe to sacriﬁce somewhat in dielectric constant,
and grow HfO2 onto a pre-existing SiO2 layer. These
possibilities will be explored in more detail in a further
work [47].

IV. CONCLUSIONS

In this paper we present a ﬁnite-element implemen-
tation of the non-equilibrium Green’s function method
which is combined to the density-functional theory. Al-
though the Green’s function method is computationally
demanding, we demonstrate that by using hierarchical
p-elements,
large, physically relevant systems become
tractable. More importantly, our method oﬀers a much
more rigorous control of accuracy than is usually possible
in transport calculations.

We demonstrate the functionality of our implementa-
tion with two kinds of systems, the sodium atom chain
wire and the silicon-HfO2 interface. For the atom chain,
we show that the method reproduces the previous re-
sults of other Green’s function transport methods. This
gives us conﬁdence to apply it to the more complex sys-
tem: a thin layer of hafnium oxide on a silicon substrate.
Here we show that the transport properties are an even
more sensitive indicator of the role of defects than the
electronic structure. Comparison of stoichiometric and
non-stoichiometric HfO2 oxide layers demonstrates that
even one or two defects in a stoichiometric interface can
result in tunneling comparable to that of a fully metallic
non-stoichiometric interface.

Acknowledgments

−5

−4

−3

−2

−1

0

Electron energy (eV)

FIG. 7: Tunneling probability through a thin HfO2 layer.
Results for interface D with 0.25 V bias (solid line) and zero
bias (broken line) voltages shown. The vertical lines show the
positions of the Fermi levels in the left and right leads for
the biased system. Between them is located the “so-called”
conductance window [see equation (12)]. The Fermi level of
the non-biased system is in the middle of these lines.

The above results show, in agreement with previous

We are grateful to J. L. Gavartin and L. R. C. Fonseca
for providing us with access to their interface structures,
and for helpful discussions. We acknowledge the gen-
erous computer resources from the Center for Scientiﬁc
Computing, Espoo, Finland. This research has been sup-
ported by the Academy of Finland through its Centers
of Excellence Program (2000-2005). We have used the
Harwell Subroutine Library in our calculations.

[1] S. Datta, Electronic transport in mesoscopic systems

[3] A. Nitzan and M. A. Ratner, Science May 30, 1384

(Cambridge University Press, Cambridge, 1995).
[2] A. Nitzan, Annu. Rev. Phys. Chem. 52, 681 (2001).

(2003).

[4] Y. Luo, C. P. Collier, J. O. Jeppesen, K. A. Nielsen,

9

E. Delonno, G. Ho, J. Perkins, H.-R. Tseng, T. Ya-
mamoto, J. F. Stoddart, et al., Chem. Phys. Chem. 3,
519 (2002).

[29] The

Harwell

Subroutine

Library,

see

http://www.cse.clrc.ac.uk/nag/hsl/.

[5] Y.-H. Kim, S. S. Jang, Y. H. Jang, and W. A. Goddard,

[30] A. Gupta, IBM Research Report, RC 21886, 98462

(1996).

(2000).

Phys. Rev. Lett. 94, 156801 (2005).

[6] K. Burke, R. Car, and R. Gebauer, Phys. Rev. Lett. 94,

146803 (2005).

(2004).

[7] K. S. Thygesen and K. W. Jacobsen, cond-mat/0411589

[8] P. Sautet and C. Joachim, Phys. Rev. B 38, 12238 (1988).
[9] L. Chico, L. X. Benedict, S. G. Louie, and M. L. Cohen,

Phys. Rev. B 54, 2600 (1996).

[31] T. A. Davis, ACM Trans. Math. Software 30, 353 (2004).
[32] J. W. Demmel, S. C. Eisenstat, J. R. Gilbert, X. S. Lia,
and J. W. H. Li, SIAM J. Matrix Analysis and Applica-
tions 20, 720 (1999).

[33] A. George and J. W.-H. Liu, Computer solution of large
sparse positive deﬁnite systems (Prentice Hall, NJ, 1981).
[34] Automatically Tuned Linear Algebra Software (ATLAS),

[10] J. Taylor, H. Guo, and J. Wang, Phys. Rev. B 63, 245407

http://math-atlas.sourceforge.net/.

(2001).

[11] M. Brandbyge, J. L. Mozos, P. Ordejo´n, J. L. Taylor, and

K. Stokbro, Phys. Rev. B 65, 165401 (2002).

[12] M. B. Nardelli, J.-L. Fattebert, and J. Bernholc, Phys.

Rev. B 64, 245423 (2001).

[13] K. S. Thygesen, M. V. Bollinger, and K. W. Jacobsen,

[35] K. Goto and R. van de Geijn, The University of Texas
at Austin, Department of Computer Sciences. Technical
Report TR-2002-55 (2002).

[36] MPI: http://www.mpi-forum.org/.
[37] Open MP: http://www.openmp.org/.
[38] N. Agrait, A. L. Yeyati, and J. M. van Ruitenbeek, Phys.

Phys. Rev. B 67, 115404 (2003).

Rep. 377, 81 (2003).

[14] D. Wortmann, H. Ishida, and S. Blugel, Phys. Rev. B 66,

075113 (2002).

[15] A. Calzolari, N. Marzari, I. Souza, and M. B. Nardelli,

Phys. Rev. B 69, 035108 (2004).

[39] R. H. M. Smit, C. Untiedt, G. Rubio-Bollinger, R. C.
Segers, and J. M. van Ruitenbeek, Phys. Rev. Lett. 91,
076805 (2003).

[40] H.-S. Sim, H.-W. Lee, and K. J. Chang, Phys. Rev. Lett.

[16] P. A. Khomyakov and G. Brocks, Phys. Rev. B 70,

87, 096803 (2001).

195402 (2004).

[17] E. Polizzi and A. N. Ben, J. Comput. Phys. 202, 150

[41] N. D. Lang, Phys. Rev. Lett. 79, 1357 (1997).
[42] S. Tsukamoto and K. Hirose, Phys. Rev. B 66, 161402(R)

[18] D. M. Ceperley and B. J. Alder, Phys. Rev. Lett. 45, 566

[19] J. P. Perdew and A. Zunger, Phys. Rev. B 23, 5048

(2005).

(1980).

(1981).

(2002).

[43] Y.-J. Lee, M. Brandbyge, M. J. Puska, J. Taylor, K. Stok-
bro, and R. M. Nieminen, Phys. Rev. B 69, 125409
(2004).

[44] P. Havu, T. Torsti, M. J. Puska, and R. M. Nieminen,

[20] J. Arponen, P. Hautoj¨arvi, R. Nieminen, and E. Pajanne,

Phys. Rev. B 66, 075401 (2002).

J. Phys. F: Met. Phys. 3, 2092 (1973).

[45] A. I. Kingon, J. P. Maria, and S. K. Streiﬀer, Nature

[21] M. Fuchs and M. Scheﬄer, Comput. Phys. Commun.

406, 1032 (2000).

[22] N. Troullier and J. L. Martins, Phys. Rev. B 43, 1993

[23] D. R. Bowler and M. J. Gillan, Chem. Phys. Lett. 325,

119, 67 (1999).

(1991).

473 (2000).

151 (2002).

[46] H. R. Huﬀ, A. Hou, C. Lim, Y. Kim, J. Barnett,
G. Bersuker, G. A. Brown, C. D. Young, P. M. Zeitzoﬀ,
J. Gutt, et al., Microelectron. Eng. 69, 152 (2003).
[47] M. H. Hakala and A. S. Foster, in preparation (2005).
[48] L. R. C. Fonseca, A. A. Demkov, and A. Knizhnik, Phys.

[49] J. L. Gavartin, L. Fonseca, G. Bersuker, and A. L.

[24] Y. Xue, S. Datta, and M. A. Ratner, Chem. Phys. 281,

Stat. Sol. (b) 239, 48 (2003).

[25] P. Havu, V. Havu, M. J. Puska, and R. M. Nieminen,

Shluger, Microelectrinics Eng. (accepted) (2005).

Phys. Rev. B 69, 115325 (2004).

[50] V. Fiorentini and G. Gulleri, Phys. Rev. Lett 89, 266101

[26] M. Ainsworth and J. Coyle, International Journal of Nu-

(2002).

merical Methods in Engineering 58, 2103 (2003).

[51] P. W. Peacock and J. Robertson, Phys. Rev. Lett. 92,

[27] J. K. Reid and I. S. Duﬀ, ACM Trans. on Math. Software

057601 (2004).

9, 302 (1983).

[28] I. S. Duﬀ, Computer Physics Communications 97, 45

