2
0
0
2
 
r
a

M
 
6
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
4
7
0
3
0
2
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

An improved uniﬁed solver for compressible
and incompressible ﬂuids involving free
surfaces. II. Multi-time-step integration and
applications

Masato Ida

Satellite Venture Business Laboratory, Gunma University,
1–5–1 Tenjin-cho, Kiryu-shi, Gunma 376–8515, Japan
E-mail: ida@vbl.gunma-u.ac.jp

Abstract

An improved numerical solver for the uniﬁed solution of compressible and incom-
pressible ﬂuids involving interfaces is proposed. The present method is based on
the CIP-CUP (Cubic Interpolated Propagation / Combined, Uniﬁed Procedure)
method, which is a pressure-based semi-implicit solver for the Euler equations of
ﬂuid ﬂows. In Part I of this series of articles [M. Ida, Comput. Phys. Commun.
132 (2000) 44], we proposed an improved scheme for the convection terms in the
equations, which allowed us discontinuous descriptions of the density interface by
replacing the cubic interpolation function used in the CIP scheme with a quadratic
extrapolation function only around the interface. In this paper, as Part II of this
series, the multi-time-step integration technique is adapted to the CIP-CUP integra-
tion. Because the CIP-CUP treats diﬀerent-nature components in the ﬂuid equations
separately, the adaptation of the technique is straightforward. This modiﬁcation al-
lows us ﬂexible determinations of the time interval, which results in an eﬃcient
and accurate integration. Furthermore, some additional discussion on our methods
is presented. Finally, the application results to composite ﬂow problems such as
compressible and incompressible Kelvin-Helmholtz instabilities and the dynamics
of two acoustically coupled deformable bubbles in a viscous liquid are provided.

Key words: Uniﬁed solution, CIP, Compressible ﬂuid, Incompressible ﬂuid,
Multi-time-step integration, Extrapolation, Free-surface ﬂow, Bubble dynamics
PACS: 02.70.Bf, 47.11.+j, 47.20.Ma, 43.25.Yw

Preprint submitted to Elsevier Preprint

21 February 2014

1 Introduction

This series of articles presents an improved solver for a challenging problem,
the uniﬁed solution of compressible and incompressible ﬂuids. After Harlow
and Amsden proposed the ICE algorithm as a fully implicit solver for ﬂuid
equations in a conservative form [1], some approaches for this purpose have
been investigated, such as the pressure-based semi-implicit algorithms [2–4],
approaches based on the asymptotic expansion with respect to the local Mach
number [5,6], and the boundary condition capturing method that treats com-
pressible and incompressible materials separately [7]. (See also recent reviews
[8,9] for more details.) Among them, the CIP-CUP method, a pressure-based
semi-implicit algorithm proposed by Yabe and Wang [3], has already been
applied to many practical multi-material problems such as the laser machin-
ing of a metal plate [10], comet Shoemaker-Levy 9’s collision with the planet
Jupiter [11], the interaction of a shock wave and a liquid drop [12], and the
milk-crown formation on a liquid surface [13], and has been proven to be an
eﬃcient and robust solver for the uniﬁed solution [14–17]. In this method, the
Euler (or the Navier-Stokes) equations for ﬂuid ﬂows in a non-conservative
form are selected as the governing equations, and the convection terms in the
equations are solved explicitly by the CIP method [18], while the acoustic
terms are solved implicitly by the CUP method [3]. In Part I of this series
[19], an improved solver for the convection terms was constructed using both
an interpolation and an extrapolation function to describe the spatial proﬁle
of the density of materials. In the improved method, the cubic interpolation
function used in the CIP scheme is replaced with the quadratic extrapolation
functions constructed under some constraints for guaranteeing stability, only
in a cell containing an interface between materials. This method allows us
to solve the density interface with no dissipation across the interface, and is
applicable to compressible ﬂow problems, i.e., to variable-density problems.

As Part II of this series, this paper presents some further improvements for
the CIP-CUP method, and also gives some application results. In Sec. 3, we
attempt to incorporate the concept of the multi-time-step (MTS) integration
techniques into the CIP-CUP algorithm. The MTS integration techniques,
which allow us the eﬃcient integration of dynamical systems involving some
diﬀerent time scales, have been used to solve a variety of problems, such as
gravitational N-body problems [20,21], molecular dynamics [22–24], and atmo-
spheric ﬂow problems [25]. This technique reduces the computational eﬀort by
integrating only rapidly varying components of a system (e.g., strongly accel-
erated particles or waves having fast phase speeds) with a small time interval,
and others with a larger time interval. In the present study, based on this
concept, diﬀerent-nature terms in the ﬂuid equations (convection, acoustic,
and other terms) are solved using diﬀerent time intervals. This modiﬁcation
allows us a more ﬂexible determination of the time interval, and improves the

2

accuracy and eﬃciency of the CIP-CUP. As will be shown, the adaptation
of the MTS concept to the CIP-CUP integration is straightforward, because
the CIP-CUP separately treats the terms having diﬀerent natures, i.e., those
having diﬀerent characteristic time scales.

Section 4 presents a modiﬁed scheme to update the spatial derivatives during
the computational steps except for the convection parts. As was shown in
Part I, the spatial derivatives of the dependent variables are used explicitly as
additional dependent variables to solve the convection terms. In the convection
process, the derivatives are updated to obey the equations derived by taking
derivatives of the governing equations [18,19]. Those spatial derivatives should
be updated by some way also in the non-convection processes. In Refs. [18,26],
simple methods for this purpose have been proposed using classical centered
diﬀerences. As was discussed in Part I, however, the use of such a classical
discretization gives rise to the numerical dispersion and dissipation around
the interfaces at which the spatial derivatives of the dependent variables tend
to be discontinuous. We modify the centered scheme by adopting a simple
extrapolation.

In Sec. 5, the applicability of the present methods to the compressible Navier-
Stokes equations with a surface tension term is investigated, and in the Ap-
pendixes, some additional discussions regarding the averaging of the density
(needed to solve the terms other than the convection) and the treatment of
the surface-tension term are given. Section 6 presents some application results
for the compressible and incompressible Kelvin-Helmholtz instabilities and
the multibubble dynamics in an acoustic ﬁeld, and Sec. 7 presents concluding
remarks.

2 The CUP method and its variants

2.1 The CUP method

The CIP-CUP method [3] is a semi-implicit solver for the Euler equations of
ﬂuid ﬂows:

∂ρ
∂t

∂u
∂t

∂p
∂t

+ u

ρ =

ρ
−

∇ ·

u,

· ∇

+ u

u =

· ∇

p
∇
ρ

−

+

F
ρ

,

+ u

p =

ρC 2

−

S∇ ·

u,

· ∇

3

(1)

(2)

(3)

where ρ, u, p, and CS denote the density, the velocity vector, the pressure,
and the local sound speed, respectively, and F may contain the viscosity, the
surface tension, and external forces. This method separately solves the terms in
Eqs. (1)–(3) of diﬀerent natures by a time splitting technique. The convection
parts of these equations,

are solved by the CIP method [18] (In the present work, of course, the hybrid
interpolation-extrapolation method proposed in Part I is adapted), while the
acoustic parts,

are solved by the CUP method, which is an implicit ﬁnite diﬀerence method.
The remaining part,

may be solved by some existing methods, such as the ﬁnite diﬀerence or ﬁnite
volume method. (We refer to Eq. (7) as the “additional part”.) Solving these
parts successively completes one step of the CIP-CUP time integration. In the
following, the CUP method for the acoustic parts is concretely reviewed.

Discretizing the time derivatives on the LHS of Eqs. (4)–(6) and estimating
the spatial derivatives on the RHS with future values, one obtains

∂ρ
∂t

∂u
∂t

∂p
∂t

+ u

ρ = 0,

· ∇

+ u

u = 0,

· ∇

+ u

p = 0,

· ∇

∂ρ
∂t

=

ρ
−

∇ ·

u,

∂u
∂t

=

p
∇
ρ

,

−

∂p
∂t

=

ρC 2

−

S∇ ·

u,

∂u
∂t

=

F
ρ

,

ρn+1

ρ∗

−
∆t

=

ρ∗

−

∇ ·

un+1,

un+1

u∗

−
∆t

=

∇

pn+1
ρ∗

,

−

4

(4)

(5)

(6)

(7)

(8)

(9)

pn+1

p∗

−
∆t

=

−

ρ∗C ∗ 2

S ∇ ·

un+1,

(10)

where n is the number of the time step, ∆t is the time interval, and the
quantities with the superscript
indicate the values after solving the parts
other than the acoustic parts. (The acoustic parts should be solved at the ﬁnal
stage of a time step, because, as is shown below, solving these parts enforces
the divergence-free condition for an incompressible ﬂuid.) Taking divergence of
Eq. (9) and substituting it into Eq. (10) yield the following pressure equation:

∗

pn+1

p∗

−
∆t

= ρ∗C ∗ 2

S ∆t

∇

pn+1
ρ∗ −

∇ ·

ρ∗C ∗ 2

S ∇ ·

u∗.

(11)

(Substituting Eq. (6) into this and rewriting as

pn+1

p∗

−
∆t

∂p∗
∂t !,

−

 

∆t = ρ∗C ∗ 2

S ∇ ·

∇

pn+1
ρ∗

ﬁnds that Eq. (11) corresponds to a ﬁrst-order approximation of the wave
equation in terms of the pressure.) Almost the same pressure equation is given
in Ref. [4], but discretization is done by a ﬁnite element technique.

After solving Eq. (11) to get pn+1, the velocity is updated explicitly by Eq.
(9). Also, the density is updated explicitly by

ρn+1 = ρ∗ +

pn+1

−
C ∗ 2
S

p∗

,

given by Eqs. (8) and (10). Generally, the spatial discretization for the above
equations is performed using the 2nd-order centered ﬁnite diﬀerencing on the
staggered grids.

When the sound speed is inﬁnite, the pressure equation (11) is reduced to an
elliptic equation,

∇

pn+1
ρ∗ = ∇ ·
∆t

u∗

,

∇ ·

which corresponds to that used in the SMAC algorithm [27] for incompress-
ible ﬂows. This result reveals that the CUP method is applicable to both
compressible and incompressible ﬂuids.

In the case where the CIP or its variant is used to solve the convection parts,
we also need to update the spatial derivatives, used explicitly in those schemes,

(12)

(13)

5

(14)

(15)

(16)

in the non-convection processes. Simple schemes for this purpose have already
been proposed [18,26]. For a two-dimensional case, the scheme is represented
as

∂xf n+1

i,j −

∂xf ∗

i,j =

∂yf n+1

i,j −

∂yf ∗

i,j =

f n+1
i−1,j

f n+1
i,j−1

f n+1
i+1,j −
2h

f n+1
i,j+1 −
2h

f ∗
i+1,j −
2h

f ∗
i,j+1 −
2h

−

−

f ∗
i−1,j

f ∗
i,j−1

,

,

where f indicates an dependent variable, ∂xf = ∂f /∂x, ∂yf = ∂f /∂y, the
subscripts i and j indicate (x, y) = (i h, j h), and h is the grid spacing (assumed
to be constant for simplicity). In the case where the cross derivative ∂xyf is
used in the convection process [26,19], the following equation is additionally
used:

∂xyf n+1

i,j −

∂xyf ∗

i,j =

f n+1
i+1,j+1 −

f ∗
i+1,j+1 −

i−1,j−1

i+1,j−1 + f n+1
f n+1

f n+1
i−1,j+1 −
4h2
i+1,j−1 + f ∗
f ∗
f ∗
i−1,j+1 −
4h2

i−1,j−1

.

−

Equations (14)–(16) can be solved explicitly using the quantities obtained
before and after solving the non-convection parts.

2.2 Improved variants of the pressure equation

In 1994 [28], Ito proposed an improved variant of the pressure equation [Eq.
(11)] by incorporating the concept of the exponential method for a heat-
conduction equation [29]. The 1-D formula of the variant is represented by

pn+1

p∗

−
∆t

= ρ∗C ∗ 2

S ∆t [α

pn+1
x
ρ∗

 

+ (1

α)

−

!x

p∗
x
ρ∗

 

]

!x

−

ρ∗C ∗ 2

S u∗
x,

(17)

where α is the weighting factor determined theoretically as

α(E) =

1
exp(

1

−

E) −

−

1
E

,

1

1

+

ρ∗
i+1/2

ρ∗
i−1/2

CS

2

∗
i ∆t
h !

,

ρ∗
i

 





E =





and ρ∗
and ρ∗

i±1/2 is the density at x = h (i + 1/2), determined approximately with ρ∗
i
), α converges to
i±1 (see Appendix A). For E

∗
i ∆t/h

(i.e., CS

→ ∞

→ ∞

6

1 and Eq. (17) is reduced to the elliptic equation (13); therefore, this variant
is applicable to incompressible ﬂows. For E
0, α becomes 1/2, resulting in
a higher resolution than that of the conventional CUP [28,30]. We adopted
this variant in the present study.

→

The 2-D formula of this variant (not shown in Ito’s paper) may be represented
by

pn+1

p∗

−
∆t

= ρ∗C ∗ 2

S ∆t ( ˜G1 + ˜G2)

ρ∗C ∗ 2

S u∗
x,

−

where

˜G1 = α(E1)

+ (1

α(E1))

pn+1
x
ρ∗

 

!x

pn+1
y
ρ∗

 

!y

−

−

˜G2 = α(E2)

+ (1

α(E2))

E1 =

E2 =









ρ∗
i+1/2,j

ρ∗
i−1/2,j

1

1

1

1

+

+

ρ∗
i,j+1/2

ρ∗
i,j−1/2









CS

∗
i,j∆t
h

!

ρ∗
i,j

 

CS

∗
i,j∆t
h

!

ρ∗
i,j

 

p∗
x
ρ∗

p∗
y
ρ∗

 

!x

 

!y

,

,

2

2

,

.

We simplify this as follows to reduce the computational eﬀorts:

pn+1

p∗

−
∆t

= ρ∗C ∗ 2

S ∆t [α(Emax)

ρ∗C ∗ 2

S ∇ ·

−

u∗,

∇

pn+1
ρ∗ + (1

−

∇ ·

α(Emax))

p∗
ρ∗ ]
∇

∇ ·

(18)

where

Emax = max(E1, E2).

This formula requires only one weighting factor. This simpliﬁcation may be
valid because E1

E2 generally.

≈

In Ref. [30], an alternative variant was proposed. Though this variant can
provide higher resolution of the sound wave than that obtained by Ito’s variant,
it is likely that the use of this variant as a part of the solver for ﬂuid ﬂows
sometimes causes great violation of mass conservation [31]. We therefore did
not adapt it.

7

3 Multi-time-step integration

In many ﬂuid ﬂow problems, the time scale of a signiﬁcant phenomenon is de-
termined by the ﬂow velocity (i.e., the characteristic speed of the convection
parts), rather than by the sound speed or other characteristic speed. In certain
cases, however, the acoustic parts (or others) have much smaller time scales
(i.e., much greater characteristic speeds), resulting in an excessive restriction
on the time interval, ∆t. The CIP-CUP overcomes this problem by solving
the acoustic parts implicitly. Such an approach, however, guarantees only the
stability, and probably provides inaccurate results in certain situations. For
example, under an intermediate condition of ﬂows such as weakly compress-
ible ﬂows, the acoustic parts may need to be solved by using a time interval
of suﬃciently small κC that makes κu very small, since the compressibility
described by the acoustic parts plays an important role, where

κC ≡

max(CS)∆t/h and κu ≡

max(
|

u
|

)∆t/h.

To achieve an eﬃcient computation even in such a situation, we adopt the
multi-time-step (MTS) integration technique to the CIP-CUP method.

The adaptation of the MTS integration to the CIP-CUP is straightforward
because the components of diﬀerent time scales (convection, sound propaga-
tion, and others) are treated separately. The time propagation performed in
the CIP-CUP can be represented schematically as follows:

U∗∗ = L1(∆t) Un,

U∗ = L2(∆t) U∗∗,

Un+1 = L3(∆t) U∗,

(19)

(20)

(21)

where U = (ρ, u, p) and the operators L1(∆t), L2(∆t), and L3(∆t) indicate
the discrete propagators for the corresponding integration steps (the convec-
tion, the additional, and the acoustic steps, respectively). These equations can
be summarized as

Un+1 = L3(∆t)L2(∆t)L1(∆t) Un.

(22)

If we factor L2(∆t) and L3(∆t) into some identical pieces, we get

Un+1 = [L3(∆t/m3)]m3[L2(∆t/m2)]m2L1(∆t) Un,

(23)

where m2 and m3 are positive integers. This equation means that, after solving
the convection parts with ∆t, the additional part is solved m2 times with

8

∆t/m2, and subsequently the acoustic parts are solved m3 times with ∆t/m3.
If necessary, we divide L2 into two parts as L2 = L2(2)L2(1), and modify Eq.
(23) as

Un+1 = [L3(∆t/m3) L2(2)(∆t/m3)]m3 [L2(1)(∆t/m2)]m2L1(∆t) Un (24)

or

Un+1 = [L3(∆t/m3) L2(2)(∆t/m3) [L2(1)(∆t/m2)]m2]m3L1(∆t) Un. (25)

Such a treatment of the additional parts is necessary, e.g., when the surface-
tension term exists. (The surface-tension part, represented by L2(2), should
be solved together with the acoustic parts because the surface tension always
needs to balance with the pressure jump at the interface.) Some other forms
of factorization adjusted for a governing system can be employed.

We determine the fundamental time interval, ∆t, by

∆t = min

c1

 

h
max(
|

)

u
|

, c2

h
max(CS) !

,

where the parameters are typically set to c1 = 0.2 and c2 = 10. m3 is deter-
mined so that, e.g., the following condition is satisﬁed:

∆t
m3 ≤

min

c3





max(
(cid:12)
(cid:12)
(cid:12)

h
CS i+1,j −

, c3

CS i,j

)

h
CS i,j+1 −

CS i,j

max(
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

, ∆t

,





)
(cid:12)
(cid:12)
(cid:12)

where the spatial diﬀerence of sound speed is used as a criterion. If the surface-
tension term exists, the stability condition needed to solve it [32,33],

∆t
m3 ≤

∆tst ≡ s

(ρa + ρb)h3
4πσ

,

(26)

should be taken into consideration to determine m3, where ρa and ρb are the
densities of materials on diﬀerent sides of the interface, and σ is the surface-
tension coeﬃcient. Also, m2 is determined based on the stability condition of
a method for the viscous term or others.

9

4 Stabilization of the derivative advancement

At the interfaces where the value or derivatives of physical quantities are in
general discontinuous, the use of the conventional centered schemes (14)–(16)
for updating the spatial derivatives is not suitable, providing less accurate
results, as will be demonstrated below using a numerical example. To modify
the schemes, we recall here the extrapolation concept investigated in Part I [19]
and by others [34–37]. As has been pointed out in Ref. [19], an interpolation
or diﬀerencing across the phase boundary may not physically valid, and gives
rise to serious numerical errors. In the following, those schemes are modiﬁed
by adapting a simple extrapolation.

Equation (14) can be rewritten as

∂xf n+1

i,j −

∂xf ∗

i,j =

1
2  

di+1,j −
h

di,j

+

di−1,j
di,j −
h

,

!

(27)

di,j ≡

f n+1
i,j −

f ∗
i,j.

We introduce here a switching parameter H, deﬁned as

(28)

(29)

(30)

Hi+1/2,j = 


1 for φn+1

φn+1

i,j > 0,

i+1,j ·

0 otherwise,

Hi,j+1/2 = 


1 for φn+1

φn+1

i,j > 0,

i,j+1 ·

0 otherwise,





where φ is the ID function (a density function or a level set function) deﬁned
as φ > 0 in the region occupied by a material and φ < 0 elsewhere, and is
updated by solving

∂φ
∂t

+ u

φ = 0.

· ∇

Using this, we modify Eq. (27) as

∂xf n+1

i,j −

∂xf ∗

i,j =

1
2  

Hi+1/2,j

di,j

di+1,j −
h

+ Hi−1/2,j

di−1,j
di,j −
h

!

. (31)

i,j < 0,
This modiﬁcation vanishes the derivative (di+1,j −
resulting in the advancement of ∂xfi,j using only the values of an identical

di,j)/h when φn+1

i+1,j ·

φn+1

10

material. This procedure corresponds to an extrapolation such as di+1,j = di,j.
Equation (15) can be modiﬁed in the same manner, as

∂yf n+1

i,j −

∂yf ∗

i,j =

1
2  

Hi,j+1/2

di,j

di,j+1 −
h

+ Hi,j−1/2

di,j−1
di,j −
h

!

. (32)

The scheme (16) for the cross derivative can be rewritten as

∂xyf n+1

i,j −

∂xyf ∗

i,j =

1
4h2 [(di+1,j+1 −
(di+1,j−1 −
−

−

(di−1,j+1 −
di,j)
di,j) + (di−1,j−1 −

di,j)

di,j)].

(33)

We modify this as

∂xyf n+1

i,j −

i,j =

1
∂xyf ∗
4h2
[Hi+1/2,j+1/2(di+1,j+1 −
×
Hi+1/2,j−1/2(di+1,j−1 −
−

where

di,j)
Hi−1/2,j+1/2(di−1,j+1 −
di,j) + Hi−1/2,j−1/2(di−1,j−1 −

−

di,j)
(34)
di,j)], (35)

Hi±1/2,j±1/2 = 


1

0

for φn+1

i±1,j±1 ·

otherwise.

φn+1

i,j > 0,

(36)



The extrapolations used above are merely rough compared with those used
to solve the convection parts [19,36]; these, however, might be suﬃcient, be-
cause the derivatives require lower accuracy than those required for the non-
derivatives represented here by f .

Let us perform a numerical test to demonstrate the eﬀectiveness of the above
modiﬁcation. A one-dimensional nonlinear sound propagation is solved based
on Eqs. (4)–(6). The convection and other components are neglected for sim-
plicity. The initial condition is

1.025

10−3 for x < 0.5,

ρ(x, 0) = 


1

×

elsewhere,

u(x, 0) = 0,


p(x, 0) = 1,

x

[0,

),

∞

∈

11

and the boundary condition is

p(0, t) = 1.1

0.1 cos ω1t

and ∂u(0, t)/∂x = 0,

−

where the angular frequency ω1 is determined so that the wavelength of the
emitted sound wave is 0.225. The initial values of all derivatives are zero. The
square of sound speed is determined by

7(p + 3172.04)/ρ for x < 0.5,

C 2

S = 


1.4p/ρ

elsewhere.


Other parameters are ∆t = 2
κC is about 0.6 for x
set to be a color function,

≥

10−5 and h = 5

10−3. (Under this condition,
0.5 and is about 0.15 elsewhere.) The ID function is

×

×

1

for x < 0.5,

1 elsewhere.

φ = 


−



The matrix equation given by discretizing Eq. (18) is solved by the Red-Black
Gauss-Seidel method with the convergence criterion of εres < 10−6, where

εres =

pn+1,(k)
i
(cid:13)
(cid:13)
(cid:13)

−

pn+1,(k−1)

i

p∗
i k2,

k

.

2
(cid:13)
(cid:13)
(cid:13)

and k denotes the number of the Gauss-Seidel iteration. Figures 1(a) and 1(b)
10−2.
show the calculated pressure and density distributions at t = 1.602
Also, Figs. 1(c) and 1(d) show the density gradients at the same t, calculated
using the conventional and the modiﬁed schemes. (In the acoustic step, the
derivatives are not used to update the non-derivatives; thus, the results shown
in Figs. 1(a) and 1(b) are irrespective of the schemes for the derivatives.) As
can be clearly seen, the result obtained by the conventional scheme has a
strong overshoot at the interface, while the result obtained by the modiﬁed
scheme is smooth. The result given using the modiﬁed scheme with ∆t/4 and
h/4 (the dashed lines) is similar to the latter result. These results can roughly
prove the validity of the modiﬁed scheme, although more detailed discussions
should be necessary.

×

5 Application to the compressible Navier-Stokes equations

In this section, as a summary of methods, we illustrate how to apply the
methods discussed in this series to the compressible Navier-Stokes equations

12

with a surface tension term:

∂ρ
∂ t
∂u
∂t
∂p
∂ t

+ u

ρ =

ρ
−

· ∇

+ u

u =

· ∇

u,

∇ ·
p
∇
ρ

+

+ u

p =

ρC 2

· ∇

s ∇ ·

−

−

1
2
ρ (cid:18)
u,

(µT)

∇ ·

2
3 ∇

(µ

−

∇ ·

Fst
ρ

,

u)

+

(cid:19)

(37)

(38)

(39)

where T is the deformation tensor, µ is the viscosity coeﬃcient, and Fst indi-
cates the surface tension as a volume force. We factor them into the following
four systems:

Convection system:

Viscous system:

Surface-tension system:

Acoustic system:

∂ρ
∂ t

(

+ u

ρ = 0,

· ∇

∂u
∂ t

+ u

u = 0,

· ∇

∂p
∂ t

+ u

p = 0,

· ∇

∂ρ
∂ t

(

= 0,

∂u
∂ t

=

1
2
ρ (cid:18)

∇ ·

(µT)

2
3 ∇

(µ

∇ ·

−

u)

,

(cid:19)

∂p
∂ t

= 0,

∂ρ
∂ t

(

= 0,

∂u
∂ t

=

Fst
ρ

,

∂p
∂ t

= 0,

∂ρ
∂ t

(

=

ρ
−

∇ ·

u,

∂u
∂ t

=

p
∇
ρ

,

−

∂p
∂ t

=

ρC 2

−

s ∇ ·

u.

Successively solving these four systems by the MTS technique completes one
step of the time integration. Among the convection equations, one in terms of
the density is solved by the hybrid interpolation-extrapolation method intro-
duced in Part I, and the others are solved by the conventional CIP (the “Type
B” multidimensional formula [26] is adapted). The time integration of φ is
performed together with the convection system. The viscous system is solved
by the conventional second-order centered ﬁnite diﬀerencing, and the surface-
tension system is solved by the CSF model [32], coupled with the smoothing
procedure introduced in Appendix B. The acoustic system is solved by the
modiﬁed CUP method reviewed in Sec. 2.2.

13

6 Application results

This section presents the application results for the multiphase ﬂow problems,
given using the present methods. Compressible and incompressible Kelvin-
Helmholtz instabilities and multibubble dynamics in an acoustic ﬁeld were
selected as application examples.

Compressible and incompressible Kelvin-Helmholtz instabilities. It
is well known that an interface between ﬂuids of diﬀerent densities is unstable.
When the velocity ﬁeld around the interface is perturbed, the interface forms
a complicated structure [38]. This instability, called the Kelvin-Helmholtz in-
stability or the Rayleigh-Taylor instability, has been the subject of quite a
number of theoretical, experimental, and numerical studies [38–45], and even
the CIP have been employed to investigate it [41,46]. Using this example, the
eﬀectiveness of the extrapolation technique for the convection parts and that
of the MTS technique are demonstrated. The initial arrangement of materials
is shown in Fig. 2. The density of the heavy material (one for x < 0) is ρh = 1,
and that of the light one ρl = 1/3, and the initial pressure is p0(x, y, t = 0) = 1.
The initial velocity ﬁeld [u(x, y, t = 0) = (u0(x, y), v0(x, y))] is set to

u0(x, y) = sgn(x) umax exp(

2π

/λ) sin(2πy/λ),

v0(x, y) = umax exp(

2π

/λ) cos(2πy/λ),

x
|

|

−

x
|
|

−

(x, y)

[
−

∈

1.25, 1.25]

[0, 0.5],

×

∇·

u = 0, where umax is the maximum velocity and λ (= 1) is the
which satisﬁes
wavelength of the perturbation. The non-dimensional parameter λ√ρhp0/µ is
ﬁxed to 1400, and µ is assumed to be constant. The surface tension and the
gravity are neglected. The slip boundary condition is adapted to the bound-
aries of y = 0 and y = 0.5, and the Neumann boundary condition (∂/∂~n = 0)
1.25 and x = 1.25. Figures 3(a)–3(d) show the time sequence of ρ
to x =
−
for umax = 0.7, C 2
S = 1.4p/ρ (the Mach number under this condition is about
0.6), and h (= ∆x = ∆y) = 0.5/60, at t = 4. Here, the linear monotone
function [19] is used for the extrapolation, and Eq. (23) is used for the MTS
integration. The parameters for the time intervals are c1 = 0.5, c2 =
, and
∞
c3 = 0.1. (The inner iteration number for the acoustic parts, m3, is 7
13
in this case.) These results present sharp descriptions of the density interface,
while the numerical diﬀusion and oscillation can be observed in the result
given when the convection parts are solved by the conventional CIP (Figs.
3(e) and 4). Figures 5(a)–5(d) show φ = 0 surfaces at t = 4 for diﬀerent c3.
(For c3 =
, the MTS integration is disabled, that is, a single time step is
used.) As is clearly seen, decreasing c3 changes the result. A similar result to
that for c3 = 0.1 can be given, even using a smaller ∆t (see Figs. 5(e) and

∞

∼

14

5(f), which show the results for c1 = 0.2 and diﬀerent c3). These results reveal
that integrating the acoustic parts with a smaller time interval improves the
accuracy of the solution, even if the time interval for the convection parts
holds.

4

×

≈

∼

∞

S = 1000

While the above example can be solved by an explicit scheme without any
diﬃculty, the next example is anxious for an implicit scheme. Figure 6 shows
the results given by artiﬁcially resetting the sound speed to C 2
1.4p/ρ
for only the heavy material. This setting results in a much greater sound
speed than the ﬂow velocity, and also results in the coexistence of materials
of greatly diﬀerent compressibilities. The parameters for the time integration
are c1 = 0.25, c2 =
, and c3 = 5.0. (Under this setting, m3 = 3
5 and
κC/m3
5.) This result is not changed noticeably by decreasing the
time interval, proving the applicability of the present method to a high κC
condition and proving its robustness. Using this example, we perform here a
convergency test. Figures 7(a)–7(c) show the interfaces at t = 4 given using
the same parameters except for the grid width set to h = h0, h0/1.5, or h0/2,
respectively, where h0 = 0.5/60. The reﬁned results are in good agreement
with that for h = h0. In contrast, the result given by solving the convection
parts with only the interpolation (i.e. by the conventional CIP) changes as the
computational grids are reﬁned (see Figs. 7(d)–7(f)); the convergency of the
solution is obviously lower than that obtained by the hybrid method. These
results show that the improvement given in Part I accelerates the convergency,
and that the hybrid scheme can accurately describe such deformable interfaces.

∼

Two-bubble dynamics in an acoustic ﬁeld. When a sound wave is ap-
plied, a bubble immersed in a liquid begins volume oscillation. When other
bubbles exist, they interact acoustically with each other, resulting in the
changes in the oscillation amplitude and phase and the eﬀective resonance fre-
quencies [47–49]. Moreover, it is known that an acoustic interaction force called
the secondary Bjerknes force acts between such pulsating bubbles [50,51]. The
force is attractive when the bubbles pulsate in-phase, and is repulsive other-
wise. Such eﬀects resulting from the radiative interaction between bubbles have
been important subjects not only for physicists and mechanical and acousti-
cal engineers, but also for medical engineers and chemists [52–56], and novel
insights regarding these eﬀects have been provided even in very recent years
[57–61]. (In Refs. [59,60], for example, the author discovered that in multi-
bubble cases, the phase shift of the bubbles’ pulsation can take place not only
at their natural frequencies, but also at some other driving frequencies. In a
more recent paper [61], it was found that the latter characteristic frequencies
cause the sign reversal of the secondary Bjerknes force [51].)

Solving this problem numerically has some interesting points. (1) The gas in-
side the bubbles and the liquid surrounding them have quite diﬀerent densities
and compressibilities. (2) The compressibility of the gas is not negligible in

15

principle, meaning that a solver for incompressible ﬂows is not applicable. (3)
Especially for small bubbles, the viscosity of the surrounding liquid and the
surface tension are not negligible. (4) Many diﬀerent time scales exist, deter-
mined by the ﬂow velocity, the sound speed, the surface tension, the viscosity,
the bubbles’ natural frequencies, and the frequency of an external sound. (5)
The topology of the interfaces changes when the bubbles coalesce as a result
of their radiative interaction. Based on these interesting factors, we consider
this problem to be a very good example for demonstrating the abilities of our
methods.

×
×

The axisymmetric coordinate (r, z) is selected for the computational domain,
and the centers of the bubbles are located on the central axis. Bubbles 1 and
2, whose equilibrium radii are R10 = 5 µm and R20 = 9 µm, respectively, are
ﬁlled with a gas of the constant speciﬁc heat ratio γ = 1.33. The equilibrium
10−5 Pa s for
density and the viscosity coeﬃcient are 1.226 kg/m3 and 1.78
×
10−3 Pa s for the liquid phase.
the gas phase, and 1000 kg/m3 and 1.137
10−2 Pa m, and the equilibrium
The surface tension coeﬃcient is σ = 7.28
pressure of the liquid is P0 = 101.3 kPa. The initial pressures inside the bubbles
are thus determined by P0 + 2σ/Rj0 (for j = 1 and 2), in order to balance
0.16P0. The
with the surface tension, where 2σ/R10 ≈
sound speed is set to C 2
S = γp/ρ for the gas, and to C 2
S = 7(p + 3172.04P0)/ρ
for the liquid. The external sound is applied as the boundary condition to the
pressure by p(Γ) = P0(1 + 0.3 sin ωt), where Γ denotes the boundaries of the
computational domain except for r = 0, and ω is the angular frequency of the
sound. The boundary condition for the velocity is free. The initial distance
between the centers of the bubbles [D(t = 0)] is ﬁxed to 20 µm. The grid
width assumed to be constant is set to h = (5/20) µm, and the total number
310. ρa +ρb in Eq. (26) is set to 1000 kg/m3 (= the equilibrium
of grids is 100
density of the liquid), because the density of the gas is negligible, and that of
the liquid can be assumed to be almost constant in time.

0.29P0 and 2σ/R20 ≈

×

Figure 8 shows the bubbles’ mean radii and mass centers calculated for ω = ω10
and ω = ω10/1.8 (
ω20), where ωj0 is the linear, monopole natural frequency
of bubble j determined by

≈

ωj0 =

[3γP0 + (3γ

1)2σ/Rj0] /ρR2

j0,

−

q

and the parameters for the MTS integration were set to c1 = 0.2, c2 = 20,
and c3 = 2, resulting in m3
8. Also, Figs. 9 and 10 display the interfaces
at selected times. We can observe the repulsion of the bubbles when ω = ω10,
while the attraction when ω = ω10/1.8. These results are validated by the
theory presented in Ref. [51], and reexamined in Refs. [62,61]. The theory
determines the sign of the interaction force (F2B) by

≈

sgn(F2B) = sgn(cos(φ1 −

φ2)),

(40)

16

where

with

φ1 = tan−1 (B1/A1)

[0, 2π]

∈

A1 =

H1F + M2G
F 2 + G2

, B1 =

H1G

M2F

−
F 2 + G2

,

F = L1L2 −

R10R20
D2 ω4

−

M1M2,

G = L1M2 + L2M1, H1 = L2 +

R20
D

ω2,

L1 = (ω2

ω2), L2 = (ω2

ω2),

10 −

20 −

M1 = δ1ω, M2 = δ2ω,

j0) + (ω2Rj0/cl) in the present study, is the damp-
where δj, set to (4µl/ρlR2
ing coeﬃcient [63], µl, ρl, and cl are the viscosity coeﬃcient, the equilibrium
density and the sound speed, respectively, of the liquid, and exchanging 1 and
2 (or 10 and 20) in the subscripts of these equations yields the expression
for φ2. The positive sign of Eq. (40) indicates attraction, while the negative
indicates repulsion. Figure 11 shows sgn(F2B) as a function of ω for D = 20
µm, revealing that the bubbles repel each other when ω = ω10, while they at-
tract when ω = ω10/1.8. This theoretical prediction is well reproduced in the
numerical results. (More detailed discussions from the physical viewpoint are
given in Ref. [64].) Meanwhile, in the result for ω = ω10/1.8, we can observe
the coalescence of the bubbles as a result of the attraction. This result proves
the ability of the present methods to treat the topology change.

Figure 12 shows ∆t normalized by c1 h/ max(
), c2 h/ max(CS), or ∆tst,
|
as functions of time. This ﬁgure reveals that the fundamental time interval
was mainly determined by the sound speed, whereas the ﬂow velocity was
responsible when a rapid motion of the interfaces, caused by the coalescence,
occurred.

u
|

Using the example for ω = ω10, we investigate here the eﬀectiveness of the
MTS integration on this problem. Figure 13 shows the bubbles’ mean radii as
functions of time, for c1 = 0.2 and diﬀerent c2 and c3. Large diﬀerences cannot
be seen between the results for c3
2)
are obviously inaccurate. This result proves that the MTS integration has
obviously contributed to the accurate solutions given for c3

4, while the results for c3 = 8 (m3

≤

≈

4.

≤

During the computation for ω = ω10/1.8 introduced above, we sometimes
observed negative p near the interfaces. In such a case, we adopted p =

17

max(p, εcP0), where εc is set to 10−3; the numerical results were insensitive
to the magnitude of this parameter. This problem would be overcome by em-
ploying the oscillation-free variants of the CIP [65–68].

7 Conclusions

In this series of articles, we have proposed an improved uniﬁed solver for com-
pressible and incompressible ﬂuids involving free surfaces, based on the CIP-
CUP method, by adapting several improvements and modiﬁcations. (The most
signiﬁcant one given here in Part II is the adaptation of the MTS integration
technique, which makes the determination of the time interval very ﬂexible.)
High accuracy and excellent robustness of the improved methods have been
demonstrated by using examples of free-surface ﬂows that contain both com-
pressible and incompressible materials. The present methods, however, face
the following challenges:

1. Optimizing the extrapolation function for the convection parts

In Part I of this series, we proposed ﬁve kinds of extrapolation functions used
to solve the convection of the density. Although a concrete discussion has not
been provided in the present paper, we observed that the most accurate result
for a diﬀerent problem was achieved by a diﬀerent extrapolation function.
The optimization of the function based on some criterion is, therefore, sorely
expected.

2. Optimizing the time intervals

Although in the present study we have empirically determined the parame-
ters for the MTS integration, an automatic, optimized determination should
be useful in a practical application. The optimal time interval for the acous-
tic parts might be determined by a criterion based on the compressibility of
ﬂuids. If, for example, materials can be considered to be almost completely
incompressible, as has been well known previously, one can use a time interval
of an inﬁnite CFL number with respect to the sound speed, whereas when
a compressible material exists, as has been demonstrated in this paper, one
needs a time interval depending on the sound speed. This means that the
maximum values of c2 and c3 suﬃcient for accurate computations are rightly
dependent on the compressibility.

The above subjects will be addressed in a future paper.

18

Acknowledgement

The author would like to thank Dr. N. Masuda at Gunma University for his
helpful supply of materials on the multi-time-step integration methods (or the
individual timestep schemes) used in the astrophysical community.

References

[1] F. H. Harlow, A. A. Amsden, J. Comput. Phys. 8 (1971) 197.

[2] R. I. Issa, J. Comput. Phys. 62 (1985) 40.

[3] T. Yabe, P. Y. Wang, J. Phys. Soc. Jpn 60 (1991) 2105.

[4] O. C. Zienkiewicz, J. Wu, Int. J. Numer. Meth. Eng. 35 (1992) 457.

[5] R. Klein, J. Comput. Phys. 121 (1995) 213.

[6] T. Schneider, N. Botta, K. J. Geratz, R. Klein, J. Comput. Phys. 155 (1999) 248.

[7] R. Caiden, R. Fedkiw, C. Anderson, J. Comput. Phys. 166 (2001) 1.

[8] B. M¨uller, in: Proc. 30th Comput. Fluid Dynam. (Von Karman Institute for Fluid

Dynamics, Lecture Series 1999-03), March 1999 [review].

[9] T. Yabe, in: Proc. ECCOMAS 2000, Barcelona, September 2000 [review].

[10] T. Yabe, T. Mochizuki, H. Hara, in: Proc. LAMP ’92, Nagoya. June 1992, p.387.

[11] T. Yabe, F. Xiao, D. Zhang, S. Sasaki, Y. Abe, N. Kobayashi, T. Terasawa, J.

Geomag. Geoelec. 46 (1994) 657.

[12] T. Yabe, F. Xiao, J. Phys. Soc. Jpn. 62 (1993) 2537.

[13] Y. Zhang, T. Yabe, Comput. Fluid Dyman. J. 8 (1999) 378.

[14] T. Yabe, F. Xiao, T. Utsumi, J. Comput. Phys. 169 (2001) 556 [review].

[15] F. Xiao, J. Comput. Phys. 155 (1999) 348.

[16] S. Y. Yoon, T. Yabe, Comput. Phys. Commun. 119 (1999) 149.

[17] “The special issue of the CIP method”, Comput. Fluid Dynam. J. 8 (1999).

[18] T. Yabe, T. Aoki, Comput. Phys. Commun. 66 (1991) 219.

[19] M. Ida, Comput. Phys. Commun. 132 (2000) 44.

[20] S. J. Aarseth, Mon. Notices Roy. Astron. Soc. 126 (1963) 223.

[21] J. Makino, Publ. Astron. Soc. Jpn. 43 (1991) 859.

[22] R. D. Swindoll, J. M. Haile, J. Comput. Phys. 53 (1984) 289.

19

[23] M. Tuckerman, B. J. Berne, G. J. Martyna, J. Chem. Phys. 97 (1992) 1990.

[24] R. Zhou, E. Harder, H. Xu, B. J. Berne, J. Chem. Phys. 115 (2001) 2348.

[25] W. C. Chao, Mon. Wea. Rev. 110 (1982) 1603.

[26] T. Aoki, Comput. Fluid Dynam. J. 4 (1995) 279.

[27] A. A. Amsden, F. H. Harlow, LA-4370, Los-Alamos Scientiﬁc Laboratory

(1970).

Japanese].

[28] S. Ito, in: Proc. The 43rd Nat. Cong. Theor. & Appl. Mech., 1994, p. 311 [in

[29] S. V. Patankar, B. R. Baliga, Numer. Heat Transfer 1 (1978) 27.

[30] M. Ida, Y. Yamakoshi, Jpn. J. Appl. Phys. 40 (2001) 3846.

[31] M. Ida (unpublished).

[32] J. U. Brackbill, D. B. Kothe, C. Zemach, J. Comput. Phys. 100 (1992) 335.

[33] M. Sussman, E. Fatemi, P. Smereka, S. Osher, Comput. Fluids, 27 (1998) 663.

[34] P. Charrier, B. Tessieras, SIAM J. Numer. Anal. 23 (1986) 461.

[35] D. Mao, J. Comput. Phys. 92 (1991) 422.

[36] M. Ida, in: Proc. 10th Symp. Comput. Fluid. Dynam., Tokyo, Japan, 1996, p.

382 [in Japanese].

Japanese].

[37] M. Ida, in: Proc. 10th Comput. Mech. Conf., Tokyo, Japan, 1997, p. 17 [in

[38] D. H. Sharp, Physica D 12 (1984) 3 [review].

[39] J. Glimm, X. L. Li, R. Menikoﬀ, D. H. Sharp, Q. Zhang, Phys. Fluids A 2

(1990) 2046.

[40] D. Youngs, Phys. Fluids A 3 (1991) 1312.

[41] T. Yabe, H. Hoshino, T. Tsuchiya, Phys. Rev. A 44 (1991) 2756.

[42] W. Mulder, S. Osher, J. A. Sethian, J. Comput. Phys. 100 (1992) 209.

[43] S. K. Zhdanov, Physica D 87 (1995) 375.

[44] M. B. Schneider, G. Dimonte, B. Remington, Phys. Rev. Lett. 80 (1998) 3507.

[45] L. Meignin, P. Ern, P. Gondret, M. Rabaud, Phys. Rev. E 64 (2001) 026308.

[46] T. Yabe, T. Aoki, G. Sakaguchi, P. Y. Wang, T. Ishikawa, Comput. Fluids 19

(1991) 421.

[47] M. Strasberg, J. Acoust. Soc. Am. 25 (1953) 536.

[48] A. Shima, Trans. ASME, J. Basic Eng. 93 (1971) 426.

20

[49] J. F. Scott, J. Fluid Mech. 113 (1981) 487.

[50] L. A. Crum, J. Acoust. Soc. Am. 57 (1975) 1363.

[51] E. A. Zabolotskaya, Sov. Phys. Acoust. 30 (1984) 365.

[52] J. R. Blake, P. B. Robinson, A. Shima, Y. Tomita, J. Fluid Mech. 255 (1993)

707.

[53] P. A. Dayton, K. E. Morgan, A. L. Klibanov, G. Brandenburger, K. R.
Nightingale, K. W. Ferrara, IEEE Trans. Ultrason. Ferroelect. & Freq. Control 44
(1997) 1264.

[54] O. Louisnard, N. Lyczko, F. Espitalier, M. Urzedowski, Y. Vargas-Hernandez,

C. Sanchez-Romero, Ultrason. Sonochem. 8 (2001) 183.

[55] C. Feuillade, J. Acoust. Soc. Am. 109, (2001) 2606.

[56] W. Lauterborn, T. Kurz, R. Mettin, C. D. Ohl, Adv. Chem. Phys. 110 (1999)

295 [review].

[57] Z. Ye, A. Alvarez, Phys. Rev. Lett. 80 (1998) 3503.

[58] A. A. Doinikov, Phys. Rev. E 64 (2001) 026301.

[59] M. Ida, Phys. Lett. A (in press).

[60] M. Ida, J. Phys. Soc. Jpn. (accepted).

[61] M. Ida (submitted); e-print, physics/0109005.

[62] A. Harkin, T. J. Kaper, A. Nadim, J. Fluid Mech. 445 (2001) 377.

[63] A. Prosperetti, Ultrasonics 22 (1984) 69.

[64] M. Ida, e-print, physics/0111138 (still in preparation).

[65] F. Xiao, T. Yabe, T. Ito, Comput. Phys. Commun. 93 (1996) 1.

[66] F. Xiao, Mon. Wea. Rev. 128 (2000) 1165.

[67] M. Ida, Comput. Fluid Dynam. J. 10 (2001) 159.

[68] M. Ida, Comput. Phys. Commun. 143 (2002) 142.

[69] C. W. Hirt, B. D. Nichols, J. Comput. Phys. 39 (1981) 201.

[70] M. Rudman, Int. J. Numer. Meth. Fluids 28 (1998) 357.

21

APPENDIX A: Averaging at phase boundary

To discretize the acoustic, viscous, and surface tension terms on the staggered
grids, we need the values of ρ at the velocity positions, i.e., ρi+1/2,j and ρi,j+1/2.
In this appendix, we brieﬂy discuss how to estimate them.

As discussed in Part I, the phase boundary is recognized using the zero level set
of the ID function (Identiﬁcation Function; the color or the level set function),
φi,j < 0 is
φ, and materials are identiﬁed using the sign of the function. If φi+1,j ·
true, it is recognized that the call between (xi+1,j, yi+1,j) and (xi,j, yi,j) contains
an interface. In such a cell, we estimate the densities by the following VOF
[69]-like procedure, which implies the weighted linear interpolation:

ρ∗
i+1/2,j = (cid:12)
(cid:12)
(cid:12)

ρ∗
i,j+1/2 = (cid:12)
(cid:12)
(cid:12)

ρ∗
i,j

ρ∗
i,j

φn+1
i+1,j

(cid:12)
(cid:12)
(cid:12)
φn+1
i,j+1

ρ∗
i+1,j +
(cid:12)
φn+1
+
(cid:12)
i+1,j
(cid:12)

φn+1
i,j
(cid:12)
φn+1
(cid:12)
i,j
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
ρ∗
(cid:12)
(cid:12)
i,j+1 +
(cid:12)
φn+1
+
(cid:12)
i,j+1
(cid:12)

(cid:12)
(cid:12)
(cid:12)
φn+1
i,j
(cid:12)
φn+1
(cid:12)
i,j
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

for φn+1

i+1,j ·

φn+1
i,j < 0,

(41)

for φn+1

i,j+1 ·

φn+1
i,j < 0,

(42)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
where φn+1 (= φ∗ = φ∗∗. Note that the position of the interface is changed
only when solving the convection parts.) is the ID function after solving the
convection part. In the remaining cells, we use the simple average,

(cid:12)
(cid:12)
(cid:12)

ρ∗
i+1/2,j =

ρ∗
i,j+1/2 =

i,j

i+1,j + ρ∗
ρ∗
2
i,j+1 + ρ∗
ρ∗
2

i,j

,

,

which has been used in the conventional CIP algorithm [18], or in others.

The above averaging scheme is also used to estimate the values of some other
quantities at the velocity positions, such as the viscosity coeﬃcient.

22

APPENDIX B: On the surface tension term

This appendix concerns how to calculate the surface tension term in our code.

In the model named the CSF (continuum surface force), proposed by Brackbill
et al [32], the surface tension as a volume force is represented by

Fst = σκ

θ,

∇

(43)

where σ is the surface tension coeﬃcient, κ deﬁned as

κ =

∇ ·  

θ
∇
θ
|∇

|

!

is the mean radius of the surface curvature, and θ denotes the color function
deﬁned as θ = 1 for a material, and θ = 0 otherwise. The singularity appearing
θ at the interface is molliﬁed by some smoothing procedures [32,33,70].
in
In the present study, the smoothed θ is constructed as follows:

∇

Step 1: The non-smoothed color function is made from the ID function, which
is an arbitrary function whose φ = 0 surface represents the interface [19,42],
by setting θi,j = 1 for φi,j > 0 and θi,j = 0 for φi,j < 0. (φ always has a
non-zero value at the gird points [19].)

Step 2: The values of the color function at the velocity positions, θi+1/2,j and
θi,j+1/2, are determined by the averaging procedure described in Appendix A.

Step 3: Using the 4-point simple average, the weakly smoothed values of the
color function at the original position (i, j) is obtained as

¯θi,j = 0.25(θi+1/2,j + θi−1/2,j + θi,j+1/2 + θi,j−1/2).

Step 4: Using the following 5-point smoother, ¯θ is smoothed further:

¯θ(m+1)
i,j

= (1

ε)¯θ(m)

i,j + ε

(¯θ(m)

i+1,j + ¯θ(m)

i−1,j + ¯θ(m)

i,j+1 + ¯θ(m)

i,j−1),

−

1
4

where m (= 0, 1,
, M
of iteration, and ε is a small positive value.

· · ·

−

1) is the number of iteration, M is the total number

Steps 2 and 3 are necessary to approximately take into account the phase
property of the interface, which is not contained in θ given at Step 1, but is

23

latent between the grid points. ε and M are typically set to ε = 0.15 and
M = 20.

Replacing θ with ¯θ(M ), we calculate the surface-tension term by the second-
order centered ﬁnite diﬀerencing on the staggered grids, as is done in Ref.
[32].

24

(cid:19)(cid:17)(cid:19)(cid:19)(cid:24)

(cid:19)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:19)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:20)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:20)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:21)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:21)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:22)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:24)

(cid:19)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:19)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:20)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:20)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:21)

(cid:16)(cid:19)(cid:17)(cid:19)(cid:21)(cid:24)

r

[(cid:3)(cid:3)
(cid:11)F(cid:12)(cid:3)(cid:3)
>SUHVHQW@

r

[(cid:3)(cid:3)
(cid:11)G(cid:12)(cid:3)(cid:3)
>FRQYHQWLRQDO@

(cid:20)(cid:17)(cid:25)

(cid:20)(cid:17)(cid:23)

(cid:20)(cid:17)(cid:21)

(cid:20)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:19)(cid:20)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:22)

(cid:19)(cid:17)(cid:19)(cid:19)(cid:20)

(cid:19)

(cid:11)D(cid:12)(cid:3)(cid:3)S

r

(cid:11)E(cid:12)(cid:3)(cid:3)

×

(cid:19)(cid:17)(cid:24)

[

(cid:16)(cid:19)(cid:17)(cid:19)(cid:22)

(cid:19)

(cid:20)

(cid:19)(cid:17)(cid:24)

(cid:20)

[

Fig. 1. Nonlinear propagation of sound wave. Pressure (a), density (b), density
gradient calculated by the present method (c), and by the conventional method (d),
at t = 1.602

10−2. The dashed lines denote the result for ∆t/4 and h/4.

(cid:19)(cid:17)(cid:24)

\

(cid:19)(cid:17)(cid:21)(cid:24)

(cid:19)
(cid:16)(cid:20)(cid:17)(cid:21)(cid:24)

Heavy
  material

Light
  material

(cid:16)(cid:20)

(cid:16)(cid:19)(cid:17)(cid:26)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:24)

(cid:16)(cid:19)(cid:17)(cid:21)(cid:24)

(cid:19)

(cid:19)(cid:17)(cid:21)(cid:24)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:26)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:21)(cid:24)

[

Fig. 2. Initial material arrangement for Kelvin-Helmholtz instabilities.

25

(cid:11)D(cid:12)(cid:3)W(cid:3) (cid:3)(cid:19)(cid:17)(cid:21)

(cid:11)E(cid:12)(cid:3)W(cid:3) (cid:3)(cid:20)

(cid:11)F(cid:12)(cid:3)W(cid:3) (cid:3)(cid:21)

(cid:11)G(cid:12)(cid:3)W(cid:3) (cid:3)(cid:23)

\

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)

(cid:12)
(cid:23)
(cid:3)
 

(cid:3)
W
(cid:3)
(cid:15)
(cid:24)
(cid:17)
(cid:20)
(cid:3)
 
(cid:3)
[
 (cid:11)

r

(cid:20)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)

(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:24)

(cid:11)H(cid:12)(cid:3)W(cid:3) (cid:3)(cid:23)(cid:3)(cid:3)>&,3@

(cid:20)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:20)(cid:17)(cid:24)

[

[

(cid:21)

(cid:21)

Fig. 3. Results for compressible Kelvin-Helmholtz instability by the hybrid method
(a–d) and by the conventional CIP (e).

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:24)

(cid:19)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:24)

+\EULG

\

&,3

\

Fig. 4. Density proﬁles on x = 1.5 at t = 4, by the hybrid method (left) and by the
conventional CIP (right).

26

F(cid:20)(cid:3) (cid:3)(cid:19)(cid:17)(cid:24)

(cid:11)D(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)(cid:19)(cid:17)(cid:20)

(cid:11)E(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)(cid:19)(cid:17)(cid:21)

\

(cid:11)F(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)(cid:19)(cid:17)(cid:24)

(cid:11)G(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)

F(cid:20)(cid:3) (cid:3)(cid:19)(cid:17)(cid:21)

(cid:11)H(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)(cid:19)(cid:17)(cid:20)

(cid:11)I(cid:12)(cid:3)F(cid:22)(cid:3) (cid:3)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)

(cid:19)

(cid:19)

27

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:21)

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:21)

[

Fig. 5. Interfaces (φ = 0 surfaces) at t = 4 for c1 = 0.5 (a–d) or c1 = 0.2 (e and f)
and diﬀerent c3.

¥
¥
\

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)

W(cid:3) (cid:3)(cid:19)(cid:17)(cid:21)

W(cid:3) (cid:3)(cid:20)

W(cid:3) (cid:3)(cid:21)

W(cid:3) (cid:3)(cid:23)

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:21)

[

Fig. 6. Kelvin-Helmholtz instability in a composite ﬂow of compressible and incom-
pressible ﬂuids.

28

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:21)

+\EULG

(cid:11)D(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)

\ (cid:11)E(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)(cid:3)(cid:18)(cid:3)(cid:20)(cid:17)(cid:24)

(cid:11)F(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)(cid:3)(cid:18)(cid:3)(cid:21)

&,3

(cid:11)G(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)

\ (cid:11)H(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)(cid:3)(cid:18)(cid:3)(cid:20)(cid:17)(cid:24)

(cid:11)I(cid:12)(cid:3)(cid:3)K(cid:3) (cid:3)K(cid:19)(cid:3)(cid:18)(cid:3)(cid:21)

(cid:19)

(cid:19)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)(cid:17)(cid:24)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:22)

(cid:19)(cid:17)(cid:21)

(cid:19)(cid:17)(cid:20)

(cid:19)

(cid:19)

[

[

29

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:20)(cid:17)(cid:24)

(cid:21)

Fig. 7. Convergency test. Results at t = 4 given by the hybrid method (a–c) and
by the conventional CIP (d–f), for h = h0, h0/1.5, and h0/2.

w

w

(cid:3) (cid:3)

(cid:20)(cid:19)

w

w

(cid:3) (cid:3)

(cid:20)(cid:19)(cid:3)(cid:18)(cid:3)(cid:20)(cid:17)(cid:27)

@

P

(cid:20)(cid:19)

>m
(cid:3)
(cid:3)
,
,

’
$
5

(cid:20)(cid:21)

(cid:27)

(cid:25)

(cid:23)

(cid:24)

(cid:19)

(cid:20)(cid:19)

@

P

>
(cid:3)
(cid:3)

6
1
2
,
7
,
6
2
3

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:16)(cid:20)(cid:24)

(cid:19)

(cid:21)

(cid:23)

(cid:25)

(cid:27)

(cid:20)(cid:19)

(cid:19)

(cid:21)

(cid:23)

(cid:25)

(cid:27)

(cid:20)(cid:19)

7,0((cid:3)(cid:3)>

V@

7,0((cid:3)(cid:3)>

V@

Fig. 8. Bubbles’ mean radii and positions (the lower one is for the smaller bubble)
for ω = ω10 and ω = ω10/1.8 as functions of time. The coalescence of the bubbles
occurred at the time when the number of the lines became one.

30

m
m
m
(cid:20)(cid:19)

W(cid:3) (cid:3)(cid:19)

W(cid:3) (cid:3)(cid:25)(cid:17)(cid:21)

U
(cid:19)

(cid:20)(cid:19)

W(cid:3) (cid:3)(cid:28)(cid:17)(cid:21)

W(cid:3) (cid:3)(cid:28)(cid:17)(cid:27)

(cid:24)

(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:20)(cid:19)

(cid:24)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:20)(cid:19)

(cid:24)

(cid:19)

(cid:24)

(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:16)(cid:22)(cid:19)

(cid:16)(cid:21)(cid:19)

(cid:16)(cid:20)(cid:19)

(cid:19)

(cid:20)(cid:19)

(cid:21)(cid:19)

(cid:22)(cid:19)

]

Fig. 9. Calculated interfaces for ω = ω10 at selected times.

31

(cid:20)(cid:19)

W(cid:3) (cid:3)(cid:19)

W(cid:3) (cid:3)(cid:23)(cid:17)(cid:21)

U
(cid:19)

(cid:20)(cid:19)

W(cid:3) (cid:3)(cid:24)(cid:17)(cid:27)

W(cid:3) (cid:3)(cid:25)(cid:17)(cid:21)

(cid:24)

(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:20)(cid:19)

(cid:24)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:20)(cid:19)

(cid:24)

(cid:19)

(cid:24)

(cid:19)

(cid:16)(cid:24)

(cid:16)(cid:20)(cid:19)

(cid:16)(cid:22)(cid:19)

(cid:16)(cid:21)(cid:19)

(cid:16)(cid:20)(cid:19)

(cid:19)

(cid:20)(cid:19)

(cid:21)(cid:19)

(cid:22)(cid:19)

]

Fig. 10. Calculated interfaces for ω = ω10/1.8 at selected times.

32

w

(cid:20)(cid:19)(cid:3)(cid:18)(cid:3)(cid:20)(cid:17)(cid:27)

(cid:12)

)

(cid:11)
Q
J
V

(cid:19)(cid:17)(cid:24)

(cid:20)

(cid:19)

(cid:16)(cid:19)(cid:17)(cid:24)

(cid:16)(cid:20)

w

(cid:20)(cid:19)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:25)

(cid:20)

(cid:20)(cid:17)(cid:21)

w

(cid:19)(cid:17)(cid:27)
w

(cid:3)(cid:18)(cid:3)

(cid:20)(cid:19)

Fig. 11. Theoretical result for the sign of the secondary Bjerknes force for D = 20
µm.

w

w

(cid:3) (cid:3)

(cid:20)(cid:19)

w

w

(cid:3) (cid:3)

(cid:20)(cid:19)(cid:3)(cid:18)(cid:3)(cid:20)(cid:17)(cid:27)

.(cid:20)
.(cid:21)
.(cid:22)

.(cid:20)
.(cid:21)
.(cid:22)

(cid:20)(cid:17)(cid:23)

(cid:20)(cid:17)(cid:21)

(cid:20)

(cid:19)(cid:17)(cid:27)

(cid:19)(cid:17)(cid:25)

(cid:19)(cid:17)(cid:23)

(cid:19)(cid:17)(cid:21)

(cid:19)

(cid:22)

(cid:23)

(cid:24)

(cid:25)

(cid:26)

(cid:22)

(cid:23)

(cid:24)

(cid:25)

(cid:26)

7,0((cid:3)(cid:3)>

V@

7,0((cid:3)(cid:3)>

V@

Fig. 12. Time intervals normalized by c1 h/ max(
|
or ∆tst (K3) as functions of time.

u
) (K1), c2 h/ max(CS) (K2),
|

33

m
m
(cid:20)(cid:19)

(cid:28)

(cid:27)

(cid:26)

(cid:25)

(cid:24)

(cid:23)

(cid:28)

(cid:27)

(cid:26)

(cid:25)

(cid:24)

(cid:23)

(cid:28)

(cid:27)

(cid:26)

(cid:25)

(cid:24)

(cid:23)

(cid:20)(cid:19)

@

P

>
(cid:3)
(cid:3)
,
,

’
$
5

(cid:20)(cid:19)

F(cid:22)(cid:3) (cid:3)(cid:20)
F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:23)

F(cid:22)(cid:3) (cid:3)(cid:20)
F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:23)

F(cid:22)(cid:3) (cid:3)(cid:20)
F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:23)

F(cid:21)(cid:3) (cid:3)(cid:20)(cid:19)

F(cid:21)(cid:3) (cid:3)(cid:21)(cid:19)

F(cid:21)(cid:3) (cid:3)(cid:22)(cid:19)

F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:27)

F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:27)

F(cid:22)(cid:3) (cid:3)(cid:21)
F(cid:22)(cid:3) (cid:3)(cid:27)

34

(cid:19)

(cid:21)

(cid:23)

(cid:25)

(cid:27)

(cid:19)

(cid:21)

(cid:23)

(cid:25)

(cid:27)

(cid:20)(cid:19)

7,0((cid:3)(cid:3)>

V@

Fig. 13. Bubbles’ mean radii for ω = ω10 as functions of time, for c1 = 0.2 and
diﬀerent c2 and c3.

m
m
