6
9
9
1
 
t
c
O
 
4
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
4
0
0
0
1
6
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Harmonic analysis of random number generators

Oliver Schnetz∗

September 26, 1996

Abstract

The spectral test of random number generators (R.R. Coveyou and R.D. McPher-
son, 1967) is generalized. The sequence of random numbers is analyzed explic-
itly, not just via their n-tupel distributions. We ﬁnd that the mixed multiplica-
tive generator with power of two modulus does not pass the extended test with
an ideal result. Best qualities has a new generator with the recursion formula
Xk+1 = aXk + c int(k/2) mod 2d. We discuss the choice of the parameters a, c for
very large moduli 2d and present an implementation of the suggested generator with
d = 256, a = 2128 + 264 + 232 + 62181, c = (2160 + 1)

11463.

·

Contents

1 Introduction

2 The generalized spectral test

2.1 Review of the spectral test . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Generalization of the spectral test . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . .
2.3 Valuation with the generalized spectral test

3 Generators

6
3.1 X0 = 1, Xk+1 = aXk mod P . . . . . . . . . . . . . . . . . . . . . . . . . .
7
3.2 X0 = 0, Xk+1 = aXk + c mod M . . . . . . . . . . . . . . . . . . . . . . . .
8
3.3 X0 = 0, Xk+1 = aXk + c int(k/2) mod M . . . . . . . . . . . . . . . . . . . 10
3.4 X0 = 1, X−1 = ... = X−r+1 = 0, Xk+1 = ar−1Xk + ... + a0Xk−r+1 mod P . . . . . 10

4 Choice of parameters

5 Results and outlook

∗Institut f¨ur theoretische Physik III, Staudtstraße 7, 91058 Erlangen, Germany,

e-mail: schnetz@pest.physik.uni-erlangen.de
Supported in parts by the DFG Graduiertenkolleg ’Starke Wechselwirkung’ and the BMBF.
FAU-TP3-96/14

2

3
3
4
5

12

18

1

1 INTRODUCTION

1 Introduction

2

The spectral test was proposed by R.R. Coveyou and R.D. McPherson in 1967 [1]. The
advantage of this test is to present an algebraic criterion for the quality of the generator.
For the mixed multiplicative generator Xk+1 = aXk + c mod M

min

=

s
|

{|

q

s2
1 + . . . + s2

n with sa = s1 + as2 + . . . + an−1sn = 0 mod M

(1)

}

should be as large as possible [1, 2]. The criterion is that simple since the n-tupels of
random numbers form an n-dimensional lattice (cf. e.g. Fig. 2). A good generator has
uniformly distributed n-tupels which refers to an almost cubic lattice [3, 4, 5].

The lattice is a consequence of the (aﬃne) linear dependence of X k+1 on X k. From
the ﬁgures on the left (type I) we see that the relation between k and X k is much more
complicated. This is however one of the most fundamental aspects of randomness. In order
to judge whether a sequence X k takes random values one would ﬁrst plot the sequence
itself and then maybe X k+1 over X k.

Of course, the correlation between k and X k is not independent from the distribution
of pairs (Xk, Xk+1). E.g., a poor ’random’ sequence Xk = ak lying on a line with gradient
a leads to pairs (Xk, Xk+1 = Xk + a) lying on a line with gradient 1 shifted by a oﬀ
the origin. This makes it reasonable to judge randomness by only looking at the n-tupel
distributions. However, random number generators which have identical valuation by the
spectral test may still look quite diﬀerent. The generators Xk+1 = 41Xk + 3 mod 1024
(Fig. 3) and Xk+1 = 41Xk + 1 mod 1024 (Fig. 4), e.g., diﬀer only by the additive constant
which does not enter Eq. (1). The lattices of pair distributions (type II in the ﬁgures)
are similar whereas the plots of X k over k show diﬀerent behavior. The spectral test not
even makes a diﬀerence between a prime number and a power of two modulus (cf. Fig. 1
vs. Fig. 2).

Therefore it is desirable to include the analysis of the correlation between k and X k
into the valuation of the test. In fact it is possible to analyze the accumulation of random
numbers along certain lines (which is often seen in the ﬁgures) by Fourier transformation.
More generally we extend the spectral test by analyzing the correlation between k and
the n-tupel (Xk, Xk+1, . . ., Xk+n−1). The generators mentioned above (Figs. 3, 4) acquire
diﬀerent valuations. Fig. 4 is preferred since the random numbers spread more uniformly
in Fig. 4I than in Fig. 3I (cf. Sec. 3.2 1).

We will ﬁnd that the commonly used mixed multiplicative generator always shows
correlations along certain lines if the modulus is not a prime number. We will present
an improved generator which is almost free from these correlations (Fig. 7). It has the
recursion formula

Xk+1 = aXk + c int (k/2) mod 2d

(2)

with the parameters

d = 2kd0

, a = 22k−1d0 + 22k−2d0 + . . . + 22d0 +

3 580 621 541 mod 2d0

,

c =

2int(2k+1/3)d0 + 1
(cid:18)

(cid:19) (cid:16)

(cid:16)
3 370 134 727 mod 2d0

(cid:17)

(3)

.

(cid:17)

2 THE GENERALIZED SPECTRAL TEST

3

In particular, the case d0 = 16, k = 4 is discussed in Ex. 7.1.

This generator is supposed to be a good choice with respect to the following three

criteria.

Firstly, the sequence of numbers provided by the generator should behave as close to

a true random sequence as possible.

Secondly, the calculation of random numbers should be as fast as possible. The gen-
erator given in Eqs. (2), (3) is explicitly constructed to have best performance.
It is
important to note that this is not independent from the ﬁrst criterion. It is possible to
produce better random numbers the more eﬀort one spends in calculating the numbers.
Figs. 2 and 6 show how a simple doubling of the digits of the modulus improves the ran-
domness of the generator. In general we can produce arbitrarily good random numbers
with e.g. d0 = 32 and large k in Eq. (3).

Thirdly, the properties of the random numbers should be known as detailed as possible.
It is not suﬃcient to use a messy, opaque formula. It has often been seen that this leads
to numbers which are far from being random [2]. As long as one is not familiar with
the qualities of the generator one can never rely on the results gained with it. The full
evaluation of the generalized spectral test is supposed to provide a profound knowledge
of the generator.

We start with the development of the generalized spectral test in the next section. In Sec.
3 we apply the test to a series of commonly used and some new generators. Finally we
discuss the choice of parameters in Sec. 4.

2 The generalized spectral test

2.1 Review of the spectral test

We start with a short review of the spectral test [1, 2] in which we try to stress its
geometrical meaning. The idea is to plot all n-tupels of successive random numbers in an
n-dimensional diagram. This is done, e.g. for n = 2 in the ﬁgures of type II.

Mathematically a ﬁgure is presented as a function g which is 1 at every dot and 0
If NX is the period of the generator X, that is the smallest number with

elsewhere.
Xk+NX = Xk ∀

k, then

g (x1, . . ., xn) =

δx1,Xk · · ·

δxn,Xk+n−1 ≡

δx,Xk ,

Xk∈ZNX

NX

Xk=1

(4)

where δa,b = 1 if a = b and δa,b = 0 if a
Kronecker δ as δa=b). Moreover we have introduced the notation

= b (for later convenience we also write the

Xk = (Xk, Xk+1, . . ., Xk+n−1) , x = (x1, x2, . . ., xn) , ZNX = Z/NXZ .

(5)

We want to check whether the dots accumulate along certain hyper-planes (see e.g.
the lines in Fig. 3II). To this end we select a hyper-plane and project all the dots onto a

6
2 THE GENERALIZED SPECTRAL TEST

4

(7)

line perpendicular to it. If points accumulate along the plane many dots will lie on top
of each other, otherwise the dots are spread uniformly over the line.
The hyper-plane H is determined by its Hesse normal form

{

H =

x : s1x1 + s2x2 + . . . + snxn ≡
s
|

The line is stretched by the factor
to the plane is given by the number s

|

Xk.

·

s

x = 0

,

·

}

≡
. The position of a point Xk on the line perpendicular

q

·

|

s2
1 + . . . + s2
n 6

= 0 . (6)

√s

s

s
| ≡

Next we wind the line up to a circle so that the modulus M as point on the line lies
1, 25) all points in Fig. 3II lie

on top of the 0. For a suitable choice of s, namely s = (
now on the point represented by the number 25.

−

The points are realized as complex phases on the unit circle. We obtain the assignment

Xk 7→

exp

2πi
M

s

·

(cid:18)

Xk

.

(cid:19)

Finally we draw arrows from the center of the circle to all the dots and add them. The
length of the resulting vector describes how the dots are balanced on the circle. If the
dots spread uniformly the arrows cancel each other and the resulting vector is small. If,
on the other hand, all dots lie on top of each other the length of the arrows sums up to
NX.

If we restrict ourselves to integer s1, . . . , sn (accumulation of random numbers always
occur along hyper-planes given by integer si) the resulting vector is given by the Fourier
transform of g,

ˆg (s) =

1
√NX

g (x) exp

2πi
M

(cid:18)

s

x

=

·

(cid:19)

1
√NX

exp

2πi
M

s

·

(cid:18)

Xk

,

(cid:19)

Xk∈ZNX

x∈Zn
X

NX

(8)

where we have introduced the normalization factor NX
mulations along the hyper-plane is contained in

−1/2. The information about accu-

2, the phase of ˆg is irrelevant.

We remember that for the mixed multiplicative generator the n-tupels form a lattice
2(s) will assume the maximum value NX if s
(which is displaced oﬀ the origin). So
2(s) is zero. Since
lies in the dual lattice, s
Xk = c(ak
1) mod M this means, if gcd(c, M) = 1 and X has full period, that
k : (ak
∀

1, M) from which Eq. (1) follows (cf. Sec. 3.2).

−
1)sa = 0 mod M gcd(a

Xk = C + ℓM, C, ℓ

Z, otherwise

1)/(a

ˆg
|

ˆg
|

−

−

−

∈

|

·

|

ˆg
|

|

2.2 Generalization of the spectral test

We generalize the spectral test by caring for the sequence in which the n-tupels are
generated. The index k is added to the n-tupel Xk as zeroth component and we deﬁne g
as

g (x0, x) =

δx0,kδx,Xk = δx,Xx0 .

(9)

Xk∈ZNX

2 THE GENERALIZED SPECTRAL TEST

5

(10)

(12)
(13)
(14)

(15)

The geometrical interpretation remains untouched but now we consider also the ﬁgures
of type I. The Fourier transform of g is given by

ˆg (s0, s) =

1
√NX

exp

s0k +

2πi
NX

(cid:18)

2πi
M

s

·

Xk

.

(cid:19)

Xk∈ZNX

|

ˆg
|
2πi
NX

(cid:18)

2πi
NX

(cid:18)

1
NX

1
NX

Xk,k′∈ZNX

X∆k∈ZNX

The sum over k is hard to evaluate since in the exponential k is combined with X k.
2 and ﬁnd
However in fact we are interested in

2 (s0, s) =

ˆg
|

|

exp

s0 (k′

k) +

−

2πi
M

s

·

(Xk′

Xk)

−

(cid:19)

=

exp

s0∆k

exp

2πi
M

(cid:18)

s

(Xk+∆k −

·

Xk)

. (11)

(cid:19)

(cid:19) Xk∈ZNX

The sum over k has no linear k-dependence, only diﬀerences of random numbers occur.
Like in the standard spectral test in many cases the sum over k can be evaluated. The
result is often simple enough to be able to evaluate the sum over ∆k also.

Note that the standard spectral test corresponds to s0 = 0. We give some simple

ˆg
results on
|
Lemma 2.1.

|

2 in the following lemma.

ˆg
|

|

2[Xk+c2 + c3] (s0, s) =
ˆg
|
ˆg
|

2[Xk] (s0, s) ,
ˆg
|
|
2 (s0, 0) = NXδs0=0 modNX ,
2 (s0, s) = NX

|
|

Xs0∈ZNX

ˆg
|

|

s∈Zn
X
M

2 (s0, s) = M n

if Xk = Xk′

k = k′ modNX .

⇒

One may also be interested in correlations between non-successive random numbers like
X k and X k+2. In general it is possible to study n-tupels Xk+τ ≡
(Xk+τ1, . . ., Xk+τn). This
amounts to replacing Xk by Xk+τ and sa by sa,τ ≡

s1aτ1 + . . . + snaτn in our results.

2.3 Valuation with the generalized spectral test

Now we have to clarify how the calculation of

We can not expect that

ˆg
|
|
would be constant. Eq. (14) shows that the mean value of

2 leads to a valuation of the generator.
2 vanishes identically outside the origin since in this case g
ˆg
|

2 is 1.

ˆg
|

|

|

What would we expect for a sum of truly random phases? Real and imaginary part
of a random arrow with length 1 have equal variance 1/2. For large NX the sum of
(x2 + y2)/NX)dxdy =
arrows is therefore normally distributed with density 1/πNX ·
z) for a true random sequence
exp(
ˆg
and the expected value for
|
This means that values of

r2/NX)dr2/NX. Thus z =

2 has the density exp(

1 can be accepted.

exp(

−

−

−

|

ˆg
|
|
2 is 1.
2
ˆg
|

|

≤

It is clear that for a given
2(s0, s) > 1 is. But what does the

= (0, 0) the correlations are worse the higher

(s0, s)
location of an (s0, s) with

2(s0, s) > 1 mean for the generator?

ˆg
|

|

ˆg
|

|

6
3 GENERATORS

6

We remember that (s0, s) may be seen as normal vector on the hyper-plane along which
the accumulations occur. If e.g. n = 1 and (s0, s1) = (1, 1) the corresponding 1-plane has
the equation x0 +x1 = 0 (cf. e.g. Figs. 2I, 3I). If the k-axis and the X k-axis are normalized
to length 1 this line has length √2. With the normal vector (3,1) (cf. Fig. 4I) one obtains
the equation 3x0 + x1 = 0 mod 1 which intersects the unit cube three times and therefore
has the length √32 + 1 = √10. Accumulations along this longer line are less important
than along the short line. In the extreme case where the line ﬁlls the whole unit cube
by intersecting it very often, accumulations can hardly be recognized. Note that in this
sense the normal vectors (s0, s1) and (2s0, 2s1) do not determine the same line. The latter
one contains e.g. the points (1/2, 0), (0, 1/2), (1, 1/2), (1/2, 1). It has twice the length of
2 has half the eﬀect.
the former one and too large a

We generalize these considerations to n > 1 by taking the area of the n-dimensional
hyper-plane with normal vector (s0, s) as measure for the importance of the accumulations
0 + s2)1/2, the Euclidean length of the normal
detected. The area is given by
vector.

(s0, s)

= (s2

|

|

ˆg
|

|

We can relate both mechanisms by deﬁning the quality parameter

Qn (s0, s)

(s0, s)
|
ˆg (s0, s)

|
|

≡

|

2 , Qn ≡

max (s0,s)∈ZNX ×Zn

M \{0,0}Qn (s0, s) .

(16)

Good generators have Q1 ≈
1 for n > 1 (see however Sec.
1. It is hard to achieve Qn ≈
M 1/n−1 (cf. Sec. 4) which means that the distribution of
3.4). More realistic is Qn ≈
n-tupels deteriorates for higher n. In general small n are more important than large n.
Apart from the value of Qn also the number of sites (s0, s) at which Qn(s0, s) = Qn is
relevant (cf. Sec. 3.2 1.).

ˆg
|

M. Then

Let us try to ﬁnd an interpretation for Qn. Assume the generator produces only mul-
2(0, s1 = M/t, 0, . . ., 0) = NX, thus Qn(0, M/t, 0, . . ., 0) = M/tNX,
tiples of t
|
|
and NXQn determines the number of non-trivial digits. In general NXQn may be larger
than M and therefore we say that ˜Mn ≡
max(NXQn, M) determines the number of digits
we can rely on. Analogously ˜Nn ≡
max(NXQn, NX) gives the quantity of random num-
bers for which the n-tupel distributions are reasonably random. Speciﬁcally ˜Mn(s0, s) =
max(NXQn(s0, s), M) determines the digits and ˜Nn(s0, s) = max(NXQn(s0, s), NX) the
quantity of random numbers not aﬀected by accumulations perpendicular to (s0, s) (cf.
[2, ,p. 90]).

Note however that these are only crude statements. If, e.g., the ’period’ of the genera-
tor is enlarged by simply repeating it then NXQn(s0, s) remains unaﬀected only if s0 = 0.
Moreover a high

2(s0, s) may be harmful even if

is large.

(s0, s)

Note that Qn is a relative quality parameter. Although Qn usually does not increase
with larger modulus (for n > 1 is actually decreases) the quality of the generator gets
better since NX grows (cf. Fig. 2 vs. Fig. 6).

|

|

ˆg
|

|

3 Generators

Here we restrict ourselves to the analysis of the most important generators. More examples
are found in [6].

3 GENERATORS

3.1 X0 = 1, Xk+1 = aXk mod P
Let P be a prime number and a a primitive element of Z×
ZP (Fig. 1).

P , the multiplicative group of

We start the analysis of this multiplicative generator with Eq. (11). We ﬁnd s

= ˜k
Xk) = saak(a∆k
1) = sa
1) mod P for some 0
∈
−
−
P then ˜k sweeps out the whole ZP \{
1 values of Z×
P
. Assume sa 6
0
−
is trivial), then the sum over ˜k can be evaluated yielding P δ∆k=0 −
over ∆k gives together with the normalization
1)

2 = P/(P

˜k(a∆k

}

ˆg
|

|

δs0=0.

−

−

(Xk+∆k−
ZP . If k runs through the
= 0 (the case sa = 0
1. Finally the sum

·

7

(17)

|

2 (s0, s) s0 = 0
ˆg
|
sa = 0
1
sa 6
= 0

−
0

P

= 0

s0 6
1/ (P
P/ (P

1)
1)

−
−

We ﬁnd that Q1 = Q1(1, 1) = √2(P
For n
the case with power of two modulus presented in Sec. 4. We ﬁnd

1)/P is independent of a and even greater than 1.
2 only the case (s0, sa) = (0, 0) contributes to Qn and the discussion is equal to

≥

−

NX = (P

1) P d−1 , Q1 = √2 (P

−

1) /P , Qn≥2 ≈

−

P 1/n−1 .

(18)

−

In particular ˜N1 = P

From a mathematical point of view odd prime number moduli give good random number
1, ˜M1 = P whereas for the mixed multiplicative
generators.
generator with a power of two modulus M we will ﬁnd ˜N1 = ˜M1 = √2M/4. So we need
M > 4P/√2 to obtain power of two generators which behave better than generators with
prime number moduli. However, one has to take into account that computers calculate
automatically modulo powers of two. Moreover, the power of two generator will be im-
proved in Sec. 3.3 until we achieve Q1 = 1. As a byproduct a better behavior of Qn for
n

2 is obtained, too.
≥
Best performance allow prime numbers of the form P = 2k
b = c12k + c2 leads to a
b = c2 ∓

In this case
c1 mod P . The extra eﬀort, compared with a
a
calculation mod 2k is one addition and, which is more important, the calculation of c1.
In Ex. 7.1 we discuss the improved generator with M = 2256 which can most easily be
changed to M = 2128. Alternatively one may construct a generator mod 2127
1 which is a
prime number. This generator will however be more time consuming and moreover it has
worse quality ˜N1 ≈
265,
etc. for the generator with power of two modulus (cf. Sec. 3.3, Sec. 4). So, power of two
generators are more eﬃcient than multiplicative generators with prime number modulus.
The situation is slightly diﬀerent if one considers multiply recursive generators with prime
number modulus, analyzed in Sec. 3.4 and Ex. 7.2.

242.3, etc. vs. ˜N1 = 2129, ˜N2 ≈

−
286.3, ˜N3 ≈

263.5, ˜N3 ≈

2127, ˜N2 ≈

1 [2].

±

·

·

Multiplicative generators with prime number modulus and primitive a produce every
= 0 mod P exactly once in a period. We recommend to use a prime

random number
number modulus only if one needs this quality.

6
6
3 GENERATORS

8

3.2 X0 = 0, Xk+1 = aXk + c mod M

Let M be any non-prime modulus, gcd(c, M) = 1 and let a
properties

= 1 have the following

1. b

gcd (a

1, M) contains every prime factor of M,

≡

−

2. 4

b if 4

M. (19)

|

|

It was shown by Greenberger [7] for M = 2d and by Hull and Dobell [8] for general M that
this leads to the quality that every random number occurs exactly once in a period. This
theorem can also be obtained by harmonic analysis in a little more general framework [6].

The generator is called mixed multiplicative generator with full period.

Proposition 2. Let M 1 be a divisor of M, then

XkM1 = ckM1 · 

1
1 + b/2

, M 1 odd
, M 1 odd 


mod bM1 .

(20)

Proof. With a

db + 1 we ﬁnd







≡

XkM1 = c

−
=

1

akM1
a

−
1

= ckM1

1 +

 

1

kM1 −
2

db

+ cdb

!

M1k

M1k

Xj=3  

j !

(db)j−2 .

(cid:16)

(cid:17)

(cid:16)

∋

M1k
j

M1k
j

M1k−1
j−1

. Since j has at most j

3
(db)j−2k/j =
(cid:17)
(db)j−2/M1. Therefore the latter term drops mod bM0 and the former gives the
2
gcd(sa, M/b). The Fourier transform of the mixed multiplica-

Obviously N
and b has by deﬁnition every prime factor of M 1 we obtain N
(cid:17)
M1k
j
result.
(cid:16)
(cid:17)
Theorem 3. Let sa,M/b ≡
tive generator with full period is

2 prime factors for j

M1k−1
j−1

≥

−

∋

(cid:16)

2 (s0, s) = bsa,M/bδs0+csa= 1

ˆg
|

|

2 bsa,M/bδ2| M

mod bsa,M/b

bsa,M/b

,

(21)

where the Kronecker δ gives 1 if the equation in the argument holds and 0 otherwise.
Proof. Since (c(ak
1))k∈ZM gives every number mod M exactly once, in (ak
−
1)k∈ZM mod M every multiple of b occurs b times. With s
get from Eq. (11) after a rearrangement of the k-sum

−
Xk) = saakX∆k we

(X∆k+k −

1)/(a

−

·

2 (s0, s) =

ˆg
|

|

1
M

exp

2πi
M

(cid:18)

s0∆k

b

(cid:19) ·

Xk∈Z

M/b

X∆k∈ZM

2πi
M

(cid:18)

exp

(kb + 1) saX∆k

.

(cid:19)

The k-sum gives M/b if bsaX∆k = 0 mod M and vanishes otherwise. Since gcd(bsa, M) =
2 for which X∆k = 0 mod M/bsa,M/b. The generator
bsa,M/b only that ∆k contribute to
has a full period, thus there are bsa,M/b such ∆k. From Prop. 2 with M1 = M/bsa,M/b we
ﬁnd that these have the form ∆k = kM1. Moreover, since M

sabM1,

ˆg
|

|

2 (s0, s) =

ˆg
|

|

exp

2πi
M  

 

Xk∈Zbsa,M/b

s0kM1 + sackM1

1 +

δ2|M1

!!!

|

 

b
2

= bsa,M/bδs0+csa(1+ b

2 δ2|M1)=0 mod bsa,M/b

We get the result since csab/2 =

bsa,M/b/2 mod bsa,M/b if 2

M1.

−

2

.

|

6
3 GENERATORS

9

Now the proper choice of the parameters a and c can be discussed.

∈

a c

c
b/2 since every c emerges from
≤
≤
X∆k = a∆kXk) or reﬂection (Xk 7→
Xk+∆k −
Xk). We can determine c by the condition that there should be no small (s0, sa),
√b gives
δ2|M/b mod b.
b−1/2. In the case where M/b is even and b is small

1. Choice of c. We can restrict ourselves to 1
(0, b/2) via translations (Xk 7→
−
gcd(M, sa) = 1 with s0 + sac = b/2
√b + 1/b
Q1(s0 ≈
the choice c = 1 is best with the result Q1(s0 ≈
0.35.

(b/4)/b = √2/4

If M/b is odd c

s1 ≈

b/4)

√b,

√2

1)

≈

−

≈

≈

≈

≈

·

·

≈

In the case of Fig. 3 with the ’wrong’ choice c = 3 one has a = 9 mod 16, b = 8 and
2(1, 1) = 8 we obtain
the smallest (s0, s1) with non-vanishing ˆg is (1,1). Since
Q1(1, 1) = √2/8
0.18 (notice the correlations perpendicular to the (1,1)-direction
in Fig. 3I). With the right choice c = 1 (Fig. 4) it takes an (s0, s1) = (1, 3) (or (3,1))
0.40 which means that the random
to get
numbers are more uniformly distributed in Fig. 4I. The large value of Q1(1, 3) is yet
2 assumes the small
misleading since Q1 = Q1(
value of Q1 at much less sites as in the case of c = 3 which means that the choice
c = 1 is better than c = 3.

2 = 8. Therefore Q1(1, 3) = √10/8

M/8, M/8) = √2/8. However

ˆg
|

ˆg
|

ˆg
|

−

≈

|

|

|

Notice the similar pair distributions in Fig. 3II and Fig. 4II. In general the quality
dependence on c can not be obtained by the standard spectral test (corresponding
to s0 = 0) since the n-tuple distributions are only shifted by a change of c.

2. Choice of b. In general b should be as small as possible in order to prevent

2 from
√b then Q1 behaves like
√2/4 for small

b/4)

ˆg
|

|

≈
s1 ≈
M/b, M/b) = √2/b which forbids large values of b.

being concentrated on too few points. If M/b is odd, c
b−1/2. If M/b is even, c = 1 then Q1(s0, s1) = Q1(s0 ≈
(s0, s1) (cf. 1.). However Q1(
For a power of two modulus the smallest value possible is b = 4 which implies
Q1 = √2/4 (Fig. 2). In particular M = 10d (Fig. 5) should be avoided since in this
case b
These arguments require s0 6
test.

= 0. They are not obtained by the standard spectral

20.

≥

−

≈

3. Choice of a. Up to now we have evaluated

ˆg
|
2. In this case Qn = min sQn(s0 = 0, sa = 0) = min s:sa=0|

2(s0, s1) for n = 1 which is given by b
and c. In order to determine a more precisely we have to look at the distribution of
n-tupels for n
/M.
A further discussion of the choice of a is postponed to Sec. 4. We will see that a
reasonable a gives Qn ≈
Since s0 = 0 this part of the choice of a is identical with the standard spectral test.

M 1/n−1.

s
|

≥

|

Let us summarize the result for M = 2d,

a = 5 mod 8 , max amin s:sa=0|

c = 1 ,
NX = M , Q1 = √2/4 , Qn≥2 ≈

s
|
M 1/n−1 .

, for n = 2, 3, . . . gives

(22)
(23)

A loss of randomness for n-tupels is avoided if one takes gcd(n, M) = 1.

3 GENERATORS

10

3.3 X0 = 0, Xk+1 = aXk + c int(k/2) mod M
Let M = 2d, 1

= a, a = 1 mod 4 and c be odd (cf. Fig. 7).

We have seen that the quality parameter Q1 is not greater than √2/4 for the mixed
multiplicative generator with power of two modulus. This results in correlations along
certain lines in the ﬁgures (cf. e.g. Fig. 2I). This does not mean that mixed multiplicative
generators can not be used if one takes large enough moduli (cf. Fig. 6 and Sec. 4). Nev-
ertheless it is worth to look for a generator with behaves better. The generator presented
in this section can be algebraically analyzed and it has Q1 = 1. The implementation
presented in Ex. 7.1 shows that it has good performance. It is possible to motivate the
generator by geometrical arguments [6].
Theorem 4. Let sa,M = gcd(sa, M).

2 (s0, s) = δs0+s·Xmm

ˆg
|

|

0 =0 mod sa,M ·

M

1 + cos

 

π
M  

 

s0 + 2c

if sa,M 6
sj

!!!

= M

else.

δ2|j

aj−1−a
a2−1

n

j=3
P

(24)
1) is the mixed multiplicative generator related to X. The period

sa,M





It is useful to put the proof in a more general context. It is given in [6]. Here we only

X mm
k = c(ak
is NX = 2M.

−

1)/(a

−

discuss the result. We obtain

NX = 2M , Q1 = 1 , Q2 ≈

M −1/3 , Qn≥3 ≈

M 1/(n−1)−1

(25)

as will be shown in Sec. 4. It is advantageous to have two parameters a and c at hand
to optimize the quality of higher n-tuples and not only a as in the case of the mixed
multiplicative generator.

The generator does not provide full periods since

= 2Mδs1=0. How-
ever the deviation from an exact uniform distribution is not larger than in a ﬁnite true
random sequence. If one does not use the entire period of the generator (and this is not
recommended because of the n-tupel distribution) the feature of having a full period is
anyway irrelevant. If, for some reasons, one insists in a full period we recommend to use a
multiplicative generator with prime number modulus or the multiply recursive generator
which will be analyzed next.

2(0, s1) = s1,M 6

ˆg
|

|

The generator of this section behaves in every aspect better than the widely used
mixed multiplicative generator. This is also conﬁrmed by the ﬁgures (cf. Fig. 2 and Fig.
7). The extra eﬀort in calculating random numbers is little (cf. Ex. 7.1). If n-tuples are
used one should take odd n and occasionally omit one random number.

Nevertheless the most essential step for producing good random numbers is to use

large moduli (cf. Fig. 6 and Sec. 4).

1 = ... = X

3.4 X0 = 1, X
−
Let P be a prime number and X k have the maximum period of P r
In
this case the random number generator has a full period in the sense that every r-tuple
(X0, . . ., Xr−1)

= (0, . . ., 0) occurs exactly once in a period.

r+1 = 0, Xk+1 = ar

1Xk + ... + a0Xk

−
1 (Fig. 8).

r+1 mod P

−

−

−

6
6
11

(26)

3 GENERATORS

Theorem 5 (Grube [9]). Let

P (λ) = λr

ar−1λr−1

−

. . .

a0.

−

−

The corresponding generator has maximum period if and only if P is a primitive polyno-
mial over ZP r .

The proof is found in [9, Satz 2.1].

Theorem 6. Let X k be deﬁned as above and sa ≡
2 is given by the following table.
then

·

ˆg
|

|

(s

Xk)0≤k<r = (

n
j=1 sjXk+j−1)0≤k<r

P

|

s0 = 0
P r
1
−
1/ (P r

s0 6
= 0
0
1) P r/ (P r

2 (s0, s)
ˆg
|
sa = 0
= 0
sa 6
Proof. First we notice that (s
s
either identically zero or it has maximum period. In the latter case every number
is produced P r−1 times in a period and the zero is generated P r−1
same holds for (s

Xk)k obeys the same recursion relation as (Xk)k since
r
Xk)k is
ℓ=1 ar−ℓ s
Z×
P
1 times. Since the

n
j=1 sjXk+j−ℓ =

n
j=1 sjXk+j =

Xk+1−ℓ. So, (s

·
r
ℓ=1 ar−ℓ

Xk))k we get

Xk+1 =

(27)

1)

−

−

−

P

P

P

P

∈

·

·

·

·

(Xk+∆k −
2πi
P

s

·

exp

(cid:18)

Xk∈Z

P r −1

(Xk+∆k −

Xk)

= P rδs·(Xk+∆k−Xk)=0 ∀0≤k<r −

1 .

(cid:19)

·

∀

−

δs0=0.

Xk = 0

= 0 then (s

2(s0, sa = 0) = (P r

1)δs0=0. If on the other hand sa 6

If sa = 0 then s
ˆg
|
|
period and the Kronecker δ vanishes unless ∆k = 0. In this case Eq. (11) yields P r/(P r
1)

k, the Kronecker δ gives 1 and from Eq. (11) we obtain
Xk)k has maximum

−
2
−
The choice of parameters is determined by avoiding small s with sa = 0. For practical
Xk)0≤k<r = 0 by the equiv-
purposes it is more convenient to replace the condition sa = (s
n
alent requirement 0 = (s
j=k sjXj−k = 0 mod P , k = 1, 2, . . ., min(r, n).
r the only solution is s = 0 mod P . For n > r one has the problem of ﬁnding the
If n
smallest lattice vector of an n-dimensional lattice. The unit cell of this lattice has the
volume P r (cf. Sec. 4). Thus for proper parameters the quality of the generator is

X1−k)1≤k≤r ⇔

≤

P

·

·

·

NX = P r

1 , Q1 = Q2 = . . . = Qr = √2/

−

P −r

1
(cid:16)

−

, Qn>r ≈
r > 1. For 2

(cid:17)

P r/n−r .

(28)

n

1 for 1

r the
1 but lower ˜Mn = P than the multiplicative generator

This is the ﬁrst generator which has Qn ≥
generator has higher ˜Nn = P r
−
˜Mn ≈
mod P r (Sec. 3.1, with ˜Nn ≈
P r/n).
In particular if one needs the full periods this generator may be recommended. For
prime numbers of the form P = 2k
1 the generator has good performance, too. If the
prime factors of P r
1 are known it is no problem to ﬁnd multipliers which lead to a full
period. A short discussion of the choice of parameters for large P and r is given in the
next section and an implementation is presented in Ex. 7.2.

±

−

≤

≤

≤

≤

n

4 CHOICE OF PARAMETERS

12

4 Choice of parameters

We start with a discussion of the mixed multiplicative generator (the multiplicative gen-
erator is analogous). For practical purposes we can restrict ourselves to M = 2d and
a = 5 mod 8. We set c = 1 which is equivalent to any other odd c and assume n
2 since
the case n = 1 depends only on b which is 4 for a = 5 mod 8.

≥
From Eq. (21) we obtain, as long as bsa,M/b < M, that ˆg vanishes unless sa,M/b|

s0 6

= 0
a,M/b/4 > 1/4. However if sa,M/b = M/b we get
/M which for some s is much

2 = M for (B) s0 = sa = 0 mod M. This leads to Qn =

q

1 + s2/s2

and therefore (A) Qn(s0, s) =
ˆg
|
|
smaller than 1/4.

s
|

|

So Eq. (B) is more important. We solve it for s1 yielding s1 = kM

a2s3 −
an−1sn depending on the free integer constants k, s2, s3, . . . , sn which give rise to
. . .
an n-dimensional lattice (cf. [2]). The lattice is given by an n by n matrix A according
to s = A

(k, s2, . . ., sn)T , and we read oﬀ

as2 −

−

−

·

A =












a2

. . .

an−1

−

M

a
−
1

−

1

. . .

1












∼











M

a
−
1

a

−
1

. . .

a
−
1











,

(29)

where zeros have been omitted and both matrices deﬁne the same lattice since they diﬀer
only by SL(n, Z) lattice transformations.

We denote the length of the smallest non-vanishing lattice vector by νn. Since the
quality of the random numbers is determined by νn = MQn we search for an a which
large νn. Most important are small n, in particular the pair correlation n = 2. In the
best case the lattice has a cubic unit-cell and νn is determined by the dimension of the
lattice and the volume of the unit-cell. Since the volume is given by the determinant of
A we get as an approximate upper bound νn / M 1/n. The calculation of νn is a standard
problem in mathematics for which eﬃcient algorithms exist [10].

To simplify the search for reasonable multipliers it is useful to have also a lower bound
for νn. Due to the speciﬁc form of A it is easy to see that νn has to be larger than the
smallest ratio > 1 between two elements of then set
.
If we take e.g. a

{
M 1/2 we ﬁnd ν2 ' M 1/2 which is identical with the upper bound.

1, a, a2 mod M, . . ., an−1 mod M, M

≈
2M 1/4 which diﬀers little from M 1/2. Therefore ν2 ≈

≈
Similarly we obtain ν3 ≈
≈
M 1/2 + 1
≈
M + M 3/4 + 1
4 M 1/4
≈
k−1M 1/2k−1
2M 1/4 + . . . + 1
as long as k

is not compatible with a
can take a
since a2
a
signs) we get νn ' M 1/2n−1
≥
a lower bound for νn. In the generic case νn will be close to M 1/n (cf. Ex. 7.1).

M 2/3. However this
M 1/3 or a
M 1/2 and we only get ν2 ' M 1/3. On the other hand we
M 1/2 and
M 3/4 mod M we have ν3 ' M 1/4. Generally, with
(the plus signs may as well be replaced by minus
is only

1. Note that M 1/2n−1

M 1/3 if we take a

n and M 1/2n−1

≈
M 1/2 + 1

≫

≈

≈

}

Obviously νn increases with M. For all practical purposes the magnitude of M is
only limited by the performance of the generator. In practice one has to split M into
groups of digits (16 or 32 bit) that can be treated on a computer. The multiplication by

4 CHOICE OF PARAMETERS

13

M 1/2 + M 1/4 + . . . + M 1/2k−1

a performs best if the pre-factors 1/j are omitted. This should be done even though for
a
1)!.
Note that the number of digits of M is much more important for randomness than the
ﬁne-tuning of a.

the lower bounds for νn decrease, νn ' M 1/2n−1

/(n

≈

−

Finally, we have to add not too small a constant a0 = 5 mod 8 (16 or 32 bit) to the sum
of powers of M. This constant can be ﬁxed by explicit calculation of the νn or by looking
at (A) from the beginning of this section which implies that a0 should have large
for
. A suitable choice is e.g. a0 = 3 580 621 541 = 62 181 mod 216.
all 16 < m = sa,M |
With this value of a0 we ﬁnd

m1/n for n = 2, 3.
We summarize the result for the parameters of the mixed multiplicative generator:

M 1/2k−1

s
| ≈

s
|

|

|

c = 1 , a = 22k−1d0 + 22k−2d0 + . . . + 22d0 + a0 , with
e.g. a0 = 3 580 621 541 mod 2d0 , leads to

2d0 ,

M = 22kd0 ,
a0 = 5 mod 8 ,
a0 ≈
NX = 2256 , Q1 = √2/4 , Qn ≈

M 1/n−1 .

(30)

Now we turn to the improved generator of Sec. 3.3. The Fourier transform of the
generator is given by Eq. (24). We set n
2 since independently of the parameters
2 = m if and only if (C) sa = km, k
Q1 = 1. Further on, we ﬁx an m
|
odd if m < M, and (D) s0 + c
2 may
a−1
−
even be 2M for m = M.) Eq. (C) can be solved for s1 and Eq. (D) for s0 depending on
the integer parameters k, ℓ, s2, . . . , sn. This gives rise to an (n + 1)-dimensional lattice
(for m < M we actually obtain an aﬃne sub-lattice since k has to be odd) determined by
the matrix B via (s0, s) = B

1)sj = ℓm. (We neglect here that

(ℓ, k, s2, . . ., sn)T ,

M and ﬁnd that

n
j=2(aj−1

ˆg
|

≥

P

ˆg

|

|

|































∼

·

−

c (an−2 + . . . + 1)
an−1

−

m

m

. . .
c
−
a . . .
−
1

. . .

B =

m

m

c
−
a
−
1

c
−

a

−
1

. . .

c
−

. . .

a
−
1














(31)

∼



























m

m

c
−
a
−
1

a
a
−
1

−

1

a2 + a
a2
a

−

−

−

. . .
1 . . .

an−2 + . . . + a
an−2
1

. . .

−

−

−

,

(32)

1

1


















. . .

1

where again zeros have been omitted.
B describes an (n + 1)-dimensional lattice which has a unit-cell with volume m2. However
this does not imply that the smallest lattice vector νn has length of about m2/(n+1). We
see from (32) that there exists an (n
1)-dimensional sub-lattice with s0 = 0 and s2 =
sn (delete the ﬁrst and the third row and column in (32)). The unit-cell of
s1 −
−

s3 −

. . .

−

−

4 CHOICE OF PARAMETERS

14

≥

m1/(n−1) which, for n
4 will have the form (0, s1,

4, is smaller than m2/(n+1).
the sub-lattice has volume m and νn ≈
≥
The smallest lattice vector for n
sn, s3, . . ., sn)
s1 −
≥
−
3 + . . . + s2
1 + s2
with the length (s2
n + (s1 + s3 + . . . + sn)2)1/2. Since this is of about the same
n)1/2 we may simply omit s2 and reduce the problem to
3 + . . . + s2
1 + s2
magnitude as (s2
1) dimensions given by (s1, s3, . . ., sn). Geometrically this means that the lattice
the (n
corresponding to B for n
4 never has an approximately cubic unit-cell. Note moreover
that the sub-lattice is independent of c which means that c can not be ﬁxed by looking
at the n-tupel distributions for n

s3 −

. . .

≥

−

−

4.

−

1)-dimensional case of the mixed multiplicative generator, Eq. (29), with

The smallest value of Qn = νn/m is obtained for m = M which is thus the most
important case. For m = M we are not restricted to odd k. The situation is similar to the
aj replaced
(n
−
by aj +aj−1+. . .+a. This allows us to use a = M 1/2+M 1/4+. . .+M 1/2k−1
+a0 again. Since
2)!M 1−22−n
2M 3/4
a2 mod M
M
1
we have aj + aj−1 + . . . + a
aj mod M. The minus sign is irrelevant, thus we can
copy the corresponding lower bounds from the mixed multiplicative generator: νn '
M 1/2n−2
4. The constant a0 is given by the case m < M as will
/(n
be discussed below.

an−2 mod M

2)! for k + 1

M 1/2

≈
≈

. . .

≪

≪

≪

≪

≪

(n

≥

−

≥

≈

≈

−

n

a

|

≥

−

c, s1 =

ˆg
|
|
(s0, s)

M 1/2, s2 = 1 with

2/3, M λ
2 = 0 mod M λ has a solution with
s0|

The constant c can be ﬁxed by the case n = 2. We have to meet two equations (E)
2 = M. Both equations are
s1 + as2 = 0 mod M and (F) s0 + cs2 = 0 mod M to get
(c2 + M)1/2. In order to
solved by e.g. s0 =
a
≈ −
−
M 2/3 one needs c ' M 2/3. So, the simplest ansatz for c is
reach the theoretical limit ν2 ≈
N. On the other hand, if s1 = M 1−λs′
c = M λ + 1 for λ
2 then
∈
M 1−λs′
1 +as′
s′
2
/ M 1−λM λ/2 = M 1−λ/2. To allow for the maximum value M 2/3
we ﬁnd
| ≈ |
2/3. In general, c should not have more successive zero digits than M 2/3
one needs λ
has. The simplest reasonable choice is therefore c = M 2/3 + 1. We can generalize this
slightly to c = (2d1 + 1)c0, where c0 is a 16 or 32 bit number and 2d1
c02d1.
This choice of c leads to best performance among all reasonable c. We will see in Ex. 7.1
M 1/2. As a lower bound for ν2, ν3 one has only
M 2/3 and ν3 ≈
that it actually gives ν2 ≈
the values M 1/2, M 1/4 that are obtained from Eqs. (E), (C) alone.

/ M λ/2. Since (F) is solved by s0 =

1, s2 = M 1−λs′

(s0, s)

M 2/3

| ≈

≤

−

≤

≤

s′

|

|

|

Now we determine c0 and a0 by looking at sa,M = m < M. The case m < M is
more important than for the mixed multiplicative generator since Qn is not limited by
1/4. To some extent the smaller Qn for m < M is compensated by the fact that for
small m there are more points with sa = odd
m. We use a0 = 3 580 621 541 as for the
mixed multiplicative generator and ﬁnd with c0 = 3 370 134 727 = 11 463 mod 216 that
m1/2−1 if sa,M = m.
Q2(s0, s)

m2/3−1 and Q3(s0, s)

·

≈

≈

We summarize the result for the generator of Sec. 3.3:

M = 22kd0, a = 22k−1d0 + 22k−2d0 + . . . + 22d0 + a0, c =

2int(2k+1/3)d0 + 1
(cid:18)

(cid:19)

c0, with

2d0 ,

c0 odd ,

a0 = 5 mod 8 ,
a0 ≈
e.g. a0 = 3 580 621 541 mod 2d0 ,
M 2/3−1 , Qn≥3 ≈
NX = 2257 , Q1 = 1 , Q2 ≈
Finally we give a short discussion of the multiply recursive generator of Sec. 3.4 (cf.

c0 = 3 370 134 727 mod 2d0
M 1/(n−1)−1 .

leads to

c0 ≥

(33)

22/3·d0 ,

4 CHOICE OF PARAMETERS

15

Ex. 7.2).
P should not be taken too small to provide enough digits for the random numbers. To
optimize the performance one should use a prime number of the form P = 2d
1, e.g.
P = 231

1. Moreover we set ar−1 = 1, ar−2 = . . . = a1 = 0.
The most severe problem is to ﬁnd the prime factors of P r

−

±

to take r = 2k since in this case P 2k
·
basically left with the problem to determine the prime factors of P 2k−1

1 = (P 2k−1

+ 1)

. . .

·
P that makes the polynomial P (λ) = λr

−
+ 1.

·

Z×

−
Afterwards it is easy to ﬁnd an a0 ∈

a0 primitive over ZP r . Since

λr−1

−

−

1. To this end it is useful
1) and one is

−
(P + 1)

(P

Xk
Xk−1
...
Xk−r+1





















1
0
...
0





















= X k

·

, with X

≡











ar−1 ar−2

. . . a1 a0

1

0

,

(34)

. . .

1

0











a necessary and suﬃcient condition for a maximum period is X (P r−1) = 1l mod P and
X (P r−1)/p
1. High powers of X are easily
computed. If N =

= 1l mod P for all prime factors p of P r

{i:bi=1} X 2i and X 2i = (X 2i−1

then X N =

0, 1

)2.

−

2 = P r
n

Now one has to check the n-tupel distributions for n > r. We found (Eq. (27))
P
1 if and only if s0 = 0 and sa = 0. The latter equation is equivalent
Z (cf. Sec. 3.4) and gives rise to an
(ℓ1, . . ., ℓr, sr+1, . . ., sn)T , C = C1 · · ·
Cr,

ˆg
that
|
to 0 =
n-dimensional lattice determined by C via s = C

j=k sjXj−k = ℓkP , k = 1, 2, . . ., r, ℓk ∈
·

−

P

Q

|

bi2i, bi ∈ {

}

1



. . .

1



P



. . .

P

a0

−

1
−

. . .



a0

P

∼

−

. . .

. C

Xn−k

Ck =

C0 ≡

X1
−
1




























(after some lattice transformations) if r < n
determinant of C 0 is P r, however the symmetry of C 0 leads to νr+1 = . . . = ν2r ≡
is given by the shortest lattice vector of the 2 by 3 matrix












(35)
2r and ar−1 = 1, ar−2 = . . . = a1 = 0. The
ν which

. Since the














1
−

. . .

. . .

. . .

≤

−

1

1

1

T

P
0
0
a0 −
1 1 !
−

 

second and third row are identical (up to a minus sign) the problem is analogous to the
calculation of ν2 in the case of the mixed multiplicative generator. We obtain ν / 21/4P 1/2
with a0 ≈
1.

55109 for P = 231
We summarize the result for the generator of Sec. 3.4:

21/4P 1/2

≈

−

−

P = 2d
X (P r−1) = 1l mod P and X (P r−1)/p
NX = (P r

1, prime , r = 2k, ar−1 = 1, ar−2 = . . . = a1 = 0, a0 ≈
(P r
= 1l mod P
p
∀
|
√2 , Qr+1 = . . . = Q2r ≈

1) , Q1 = . . . = Qr ≈

−

−

1) , p prime, leads to

21/4P 1/2−r .

(36)

21/4P 1/2, with

6
6
4 CHOICE OF PARAMETERS

16

Notice that the eﬀort for calculating random numbers does not increase with r.

r
−

1, . . .,

Let us ﬁnally mention that the quality of the n-tupel Xℓ of the (non-successive) random
numbers Xℓ, Xk2+ℓ, . . ., Xkn+ℓ deteriorates to Qn / P (r−d)/n−r if there exist d > r
n values
with Xj = 0 (see the remark at the end of Sec. 2.2). In particular
of j
∈ {−
if Xk−1 = . . . = Xk−r+1 = 0 the pair (X0, Xk) has quality of less than P 1/2−r because
ℓ if a = bXk mod P . From Eq. (34) we see immediately that this happens
aXℓ = bXk+ℓ ∀
for multiples of k = (P r
1) (notice the equidistant zeros in Fig. 8I). This makes
it not desirable to use more than (P r
1) multiply recursive random numbers.
Example 7.

1)/(P

1)/(P

−

−

−

−

−

}

1. We set M = 2256 = 224·16, a = 2128 + 264 + 232 + 62 181 and in case of the generator
of Sec. 3.3 c = (2160 + 1)
11 463. In the following table we compare the mixed
multiplicative generator with the generator of Sec. 3.3. The results can easily be
obtained with a computer algebra program and Eq. (24).

·

Qn ≡

M αn−1 Xk+1 = aXk + 1 Eq. (30) Xk+1 = aXk + c ink (k/2) Eq. (33)
1.00000
α1
α2
0.66667
α3
0.50000
0.33333
α4
α5
0.25000
0.20000
α6

1.00000
0.65658
0.49783
0.33436
0.24636
0.19882

0.99414
0.50000
0.33203
0.24859
0.19721
0.16335

0.99414
0.50000
0.33333
0.25000
0.20000
0.16667

(37)
We see a good agreement of the quality parameters with the approximate upper
bounds. This means that our choice of parameters is satisfactory. Moreover the
table conﬁrms that the quality parameter of the generator of Sec. 3.3 lies above the
quality of the mixed multiplicative generator.

Finally we present an implementation of the generator in Pascal. We group the
digits of X k to 16 blocks of 16 digits X[1], . . . , X[16] starting from the highest
digits.

unit random1;
interface
const n=16; n0=(n+2) div 3; a0=62181; c0=11463;
var X:array[1..n] of longint;
procedure nextrandom;
implementation
var even:boolean; i:word; c:longint;
procedure nextrandom;
var j,k:word;
begin
if even then inc(c,c0); even:=not even;
for j:=1 to n do begin

4 CHOICE OF PARAMETERS

17

X[j]:=X[j]*a0;
k:=2;while j+k<=n do begin inc(X[j],X[j+k]);k:=k shl 1 end end;

inc(X[n-1],X[n] shr 16); X[n]:=(X[n] and $FFFF)+c;
inc(X[n0-1],X[n0] shr 16); X[n0]:=(X[n0] and $FFFF)+c;
for j:=n downto 2 do begin

inc(X[j-1],X[j] shr 16); X[j]:=X[j] and $FFFF end;

X[1]:=X[1] and $FFFF
end;
begin for i:=1 to n do X[i]:=0; c:=0; even:=true end.

The corresponding mixed multiplicative generator is obtained by omitting or chang-
ing the lines containing c. On a 100MHz Pentium computer this (not optimized)
program produces 19 563 random numbers per second whereas 20 938 mixed mul-
tiplicative random numbers can be produced. A loss of speed of about 6.6% seems
us worth the gain of better random numbers. Note that the number c suﬀers an
overﬂow every about 750 000th random number. This does not aﬀect randomness
and it is not worth the eﬀort to correct this ﬂaw.

2. We set P = 231
1709
733

1, r = 8 which leads to P r
368140581013
331
we take ar−1 = 1, ar−2 = . . . = a1 = 0, a0 = 60 045 yielding

151
·
·
708651694622727115232673724657. Moreover

−
21529

1 = 234

11

31

17

41

32

−

5

7

·

·

·

·

·

·

·

·

·

·

·

·

1

X0 = 1, X−1 = . . . = X−7 = 0 , Xk+1 = Xk + 60 045Xk−7 mod 231
NX = P 8

P 8
(cid:17)
(cid:16)
The following program gives on a 100MHz Pentium 74 473 random numbers (X[k])
per second.

−
1.00202−1, Q9 = . . . = Q16 =

2248, Q1 = . . . = Q8 =

(38)
0.06368−1.

P 8
(cid:17)
(cid:16)

1 ,

≈

−

unit random2;
interface
var X:array[0..7] of longint; k:integer;
procedure nextrandom;
implementation
const a0=60045;
var i:integer; x0,x1,x2:longint;
procedure nextrandom;
begin
x0:=X[(k+1) and 7];
x2:=(x0 and $FFFF)*a0; x1:=(x0 shr 16)*a0+(x2 shr 16);
x2:=(x2 and $FFFF)+(x1 shr 15)+((x1 and $7FFF) shl 16);
if (x2 shr 31)=1 then x2:=(x2 xor $80000000)+1;
inc(x2,X[k]);
while (x2 shr 31)=1 do x2:=(x2 xor $80000000)+1;
k:=(k+1) and 7;
if x2=$7FFFFFFF then X[k]:=0 else X[k]:=x2

5 RESULTS AND OUTLOOK

18

end;
begin k:=0; X[0]:=1; for i:=1 to 7 do X[i]:=0 end.

5 Results and outlook

We have generalized the spectral test. As the new feature we analyze the sequence of
random numbers (I in the ﬁgures) not only the distribution of n-tupels (II in the ﬁgures).
We saw that the mixed multiplicative generator did not pass the test with an ideal
result. We were able to construct an improved generator which has the recursion formula

X0 = 0 , Xk+1 = aXk + c int (k/2) mod 2d .

(39)

For the choice of the parameters a, c, d we made suggestions in Eq. (33). This generator
(or the multiply recursive generator given in Eq. (38)) seems us to be the best choice in
quality and performance. An implementation of a generator of this type with modulus
2d = 2256
1077 was presented in Ex. 7.1. The calculation of random numbers is fast
even though the modulus is that large. We think that for all practical purposes pseudo
random numbers generated with this generator can not be distinguished from a true
random sequence.

≈

We were able to analyze this and several other generators. The choice of parameters

was discussed in Sec. 4.

For practical purposes there is essentially no need for further improvements. From a
purely mathematical point of view however there are lots of open questions.

Some further generators are discussed in [6]. However there is still little known about
multiplicative generators with prime number modulus and a non-primitive multiplier. In
this case N

2(s0, s1) is given as zero of the polynomial

ˆg
|

|

(40)

Ps0 (Y )

≡

Y

N

ˆg
|

|

−

2 (s0, s1)

.

Ys1∈ZM (cid:16)
For multiplicative generators Ps0(Y ) = Y M
show that Ps0 has integer coeﬃcients. We were not able to prove this for s0 6
analytically determine the coeﬃcients for non-trivial examples.

MNY M −1 + . . .. Numerical calculations
= 0 nor to

−

(cid:17)

Further on, the Fourier analysis of generators involving polynomials may lead to in-

teresting results. Here exist some connections to the theory of Gauß sums.

Finally we would be interested in multiply recursive generators. Those generators are
given by a matrix-valued multiplier. The simplest example with a prime number modulus
was presented in Sec. 3.4. In this section we saw that multiply recursive generators are
also the best candidates for being even more eﬃcient than the generator given in (39).
In this connection multiply recursive generators with power of two modulus may be of
special interest.

19

5 RESULTS AND OUTLOOK

Aknowledgement

Figures

I am grateful to Manfred H¨uck who motivated me to this work by showing me some ﬁgures
of random number generators.

Some graphs of random number generators are presented to give a visual impression of
what the generator looks like. There are two possibilities to draw a two-dimensional
plot: ﬁrst (I), to plot the k-th random number X k over k and second (II), to plot X k+1
over X k presenting the pair correlation. The third part of the ﬁgures give the absolute
2(s0, s1) is a measure for the correlations along a line
ˆg
of the Fourier transform of I.
|
|
perpendicular to (s0, s1) in I (cf. Eq. (16)). For ideal generators
1 and
Figs. I and II should look like ﬁrst rain drops on a dry road.

2 should be

ˆg
|

≤

|

X k+1

Fig. 1: X0 = 1, Xk+1 = 195Xk mod 1009
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

I

k

II

X k

1009
1008
1009
1008
1009
1008
1009
1008
0

1009
1008
1009
1008
1009
1008
1009
1008
0

1009
1008
1009
1008
1009
1008
1009
1008
0

1
1008
1
1008
1
1008
1
1008
1008
2 0

1009
1008
1009
1008
1009
1008
1009
1008
0
s0

p

X k+1

Fig. 2: X0 = 0, Xk+1 = 37Xk + 1 mod 1024
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
ppp
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
X k
p
p
p
ppp
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
ppp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
ppp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
ppp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

I

k

II

X k

0
0
0
0
210
2 0

0
4
0
4
0

0
0
8
0
0

0
0
0
0
0

16
0
0
0
0
s0

s1

0
ˆg
|

|

s1

0
ˆg
|

|

5 RESULTS AND OUTLOOK

20

Fig. 3: X0 = 0, Xk+1 = 41Xk + 3 mod 1024
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p X k+1
pp
pp
p
p
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

X k+1

Fig. 4: X0 = 0, Xk+1 = 41Xk + 1 mod 1024
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
ppp
pppp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
pp
pppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
pp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
pppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
pppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
pppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

ppp
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

0
8
0
8
0

0
8
0
0
0

0
0
0
0
210
2 0

0
0
0
0
210
2 0

s1

0
ˆg
|

|

s1

0
ˆg
|

|

0
0
16
0
0

0
0
0
0
0

32
0
0
0
0
s0

0
0
0
0
0

0
0
0
8
0

0
0
0
0
0
s0

X k+1

Fig. 5: X0 = 0, Xk+1 = 21Xk + 1 mod 1000
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
X k
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p

p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

1000
0
0
0
0
0

s1 0

4
−
2
ˆg
|
|

0
0
0
0
0

0
0
40
0
0

0
0
0
0
0

0
0
0
0
40
s0

Fig. 6: X0 = 0, Xk+1 = (37 + 1024)Xk + 1 mod 10242
X k+1
X k

p
pp
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
ppp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
p
p
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
pp
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
pp
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
pp
p
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
pp
p
p
p
p
pp
p
p
pp
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
pp
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp

p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p

k

II

X k

cf. Fig. 2
with NX = 1020

I

I

I

I

REFERENCES

21

Fig. 7: X0 = 0, Xk+1 = 37Xk + 129 int(k/2) mod 1024
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
ppp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
ppp
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
p
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
ppp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p

X k+1

k

II

X k

4
1
2
1
211
2 0

s1

0
ˆg
|

|

0
1
0
1
0

0
1
2
1
0

0
1
0
1
0

4
1
2
1
0
s0

I

I

Fig. 8: X0 = 1, X−1 = 0, Xk+1 = Xk + 7Xk−1 mod 31

X k

X k+1

p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
pp
pp
p
p
pp
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
pp
p
p
p
ppp
pp
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
pp
p
p
pp
p
p
p
p
p
p
p
pp
p
pppp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pppp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pppp
p
p
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
ppp
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
pppp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
ppp
p
p
pp
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
pp
p
p
p
p
pp
p
p
p
pp
pp
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

s1

1
960
1
960
1
960
1
960
960
2 0

0
ˆg
|

|

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0
s0

References

[1] R.R. Coveyou, R.D. MacPherson, Jour. ACM 14, 100–119 (1967).

[2] D.E. Knuth, The Art of Computer Programming, vol. II, 2nd. edition, Reading
(Mass.), Menlo Park (Cal.), London, Amsterdam, Don Miles (Ont.), Sydney, Addison-
Wesley (1981).

[3] G. Marsaglia, Proc. Nat. Acad. Sci. 61, 25–28, (1968).

[4] W.A. Beyer, R.B. Roof, D. Williamson, Math. Comp. 25, 345–360 (1971).

[5] H. Niederreiter, Advances in Math. 26, 99–181 (1977).

[6] O. Schnetz, physics/9610004 (http://xxx.lanl.gov/ e-Print archive), FAU-TP3-96/13.

[7] M. Greenberger, Jour. ACM 8, 163–167 (1961).

[8] T.E. Hull, A.R. Dobell, SIAM Review 4, 230–254 (1962).

[9] A. Grube, Mehrfach rekursiv erzeugte Zufallszahlen, PhD. thesis, Karlsruhe, Germany

(1973).

[10] A.K. Lenstra, H.W. Lenstra, L. Lovasz, Math. Ann. 261, 515–534 (1982).

