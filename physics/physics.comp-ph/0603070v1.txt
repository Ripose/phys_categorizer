An Adaptive Grid Reﬁnement Strategy for
the Simulation of Negative Streamers

C. Montijn a,1 W. Hundsdorfer a,2 U. Ebert a,b,2

aCWI, P.O. Box 94079, 1090 GB Amsterdam, The Netherlands
bDepartment of Physics, TU Eindhoven, 5600 MB Eindhoven, The Netherlands

Abstract

The evolution of negative streamers during electric breakdown of a non-attaching
gas can be described by a two-ﬂuid model for electrons and positive ions. It con-
sists of continuity equations for the charged particles including drift, diﬀusion and
reaction in the local electric ﬁeld, coupled to the Poisson equation for the electric
potential. The model generates ﬁeld enhancement and steep propagating ionization
fronts at the tip of growing ionized ﬁlaments. An adaptive grid reﬁnement method
for the simulation of these structures is presented. It uses ﬁnite volume spatial dis-
cretizations and explicit time stepping, which allows the decoupling of the grids for
the continuity equations from those for the Poisson equation. Standard reﬁnement
methods in which the reﬁnement criterion is based on local error monitors fail due
to the pulled character of the streamer front that propagates into a linearly un-
stable state. We present a reﬁnement method which deals with all these features.
Tests on one-dimensional streamer fronts as well as on three-dimensional stream-
ers with cylindrical symmetry are carried out successfully. Results on ﬁne grids
are presented, they show that such an adaptive grid method is needed to capture
the streamer characteristics well. This reﬁnement strategy enables us to adequately
compute negative streamers in pure gases in the parameter regime where a physical
instability appears: branching streamers.

Key words: Adaptive grid reﬁnements, ﬁnite volumes, elliptic-parabolic system,
negative streamers, pulled front
PACS: 52.25.Aj, 52.35.Mw, 52.65.Kj, 52.80.Mj

6
0
0
2
 
r
a

M
 
9
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
0
3
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Email address: carolynne.montijn@cwi.nl (C. Montijn).

1 Financial support is provided by NWO in the Computational Science program.
2 This research was also supported by the Dutch national program BSIK: knowledge and research
capacity, in the ICT project BRICKS, theme MSV1.

Preprint submitted to Elsevier Science

21 February 2014

1 Introduction

When non-ionized or lowly ionized matter is exposed to high electric ﬁelds, non-equilibrium ionization
processes, so-called discharges, occur. They may appear in various forms depending on the spatio-
temporal characteristics of the electric ﬁeld and on the pressure and volume of the medium. One
distinguishes the dark, glow or arc discharges that are stationary, and transient non-stationary phe-
nomena such as leaders and streamers. We will focus here on streamers, that are growing ﬁlaments of
plasma whose dynamics are controlled by highly localized and nonlinear space charge regions.

Streamers occur in nature as well as in many technical applications. They play a role in creating
the path of sparks and lightning [1] and they are believed to be directly observable as the multiple
channels in so-called sprite discharges. These huge, lightning related discharges above thunderclouds
attract large research eﬀort since their ﬁrst observation in 1989 [2,3,4,5]. Because of the reactive
radicals they emit, they are used for the treatment of contaminated media like exhaust gasses [6,7],
polluted water [8,9] or biogas [10]. More recently, eﬀorts have been undertaken to improve the ﬂow
around aircraft wings by coupling space charge regions to gas convection [11].

Streamers can be either cathode directed or anode directed; the charge in their head is then positive
or negative, respectively. Positive streamers propagate against the drift velocity of electrons, therefore
they need additional (and not well known) mechanisms like nonlocal photoionization or background
ionization. Negative streamers in simple non-attaching gases like nitrogen or argon, on the other hand,
can be described by a minimal model with rather well-accessible parameters [12]. We therefore focus
on this case.

The minimal streamer model for negative streamers is a continuum approximation for the densities of
the electrons and positive ions with a local ﬁeld-dependent impact ionization term and with particle
diﬀusion and particle drift in the local electrical ﬁeld. As space charges of the streamer change the
ﬁeld, and the ﬁeld determines drift and reaction rates of the particles, the model is nonlinear, and
steep ionization fronts between ionized and non-ionized regions emerge dynamically.

After the ﬁrst claim [13] that a streamer ﬁlament within this deterministic continuum model in a
suﬃciently high ﬁeld can evolve into an unstable state where it branches spontaneously, streamer
branching was observed in more simulations [14,15]. While the physical nature of the Laplacian
instability was elaborated in simpliﬁed analytical models [13,16,17,18,19], other authors challenged
the accuracy of the numerical results [20,21,22,23]. Based on purely numerical evidence, their questions
were justiﬁed, as all simulations within the minimal model up to now were carried out on uniform
grids, and the numerical convergence on ﬁner grids could hardly be tested.

Therefore, in the present paper, we present a grid reﬁnement strategy for the minimal streamer model
and discuss its results. This procedure allows us to test the numerical convergence of branching, and
also to calculate streamers eﬃciently in longer systems without introducing too many grid points.
Moreover, the simulations in [13,14,24] were performed on the same uniform grid for both the particle
densities and the electric potential. As the Poisson equation for the electric potential has to be solved
on the complete large non-ionized outer space, this grid had to be much larger than the actual domain
in which the particles evolve. Furthermore, the streamer has an inner layered structure with very steep
ionization fronts and thin space charge layers. An eﬃcient reﬁnement is therefore badly needed.

2

There is an additional complication: standard grid reﬁnement procedures in regions with steep gradi-
ents fail due to the pulled character of the streamer front. “Pulling” means that the dynamics and, in
particular, the front velocity, is determined in the linearly unstable high ﬁeld region ahead of the front
rather than by the regions with the steepest density gradients [12,25]. The high ﬁeld region where
any single electron immediately will create an ionization avalanche, is generated by the approaching
curved ionization front itself.

In the paper, a reﬁnement strategy dealing eﬃciently with all these speciﬁc problems is developed. It
is based on physical insight on the one hand, by which the relevant region for the particle densities
can be restricted, and on the knowledge of the importance of the leading edge on the other hand. The
drift-diﬀusion equations for the particle densities and the Poisson equation for the electric potential
are treated separately, allowing the solutions for particle densities and electric potential to adapt to the
speciﬁc diﬃculties. This reﬁnement procedure will be applied to problems in two spatial dimensions,
or in three dimensions with cylindrical symmetry.

The outline of this paper is as follows. First, in Section 2, we give a brief description of the model.
In Section 3 the numerical discretizations are introduced and motivated. Section 4 discusses the
reﬁnement procedure. Section 5 contains a one-dimensional example in which some of the essential
numerical diﬃculties with local grid reﬁnements of pulled fronts are illustrated and discussed. Section 6
deals with the performance of our reﬁnement algorithm, and the results are presented in the Section 7.
The ﬁnal section contains a discussion of the results and conclusions.

2 Hydrodynamic approximation for the ionized channel

2.1 Drift, diﬀusion and ionization in a gas

The essential properties of anode directed streamer propagation in a non-attaching gas like N2 or Ar,
can be analyzed by a ﬂuid model for two species of charged particles (electrons and positive ions). It
consists of continuity equations for the electron and positive ion number densities, ne and n+,

∂ne
∂t −∇ ·

E
ne + De∇
(µe|
|

ne) = Si ,

= Si .

∂n+
∂t

(2.1)

(2.2)

The electrons drift with a velocity µeE and diﬀuse with a diﬀusion coeﬃcient De. Here E is the local
electric ﬁeld and µe the electron mobility. The ions can be considered to be immobile on the short
time scales considered here, since their mobility is two orders of magnitude smaller than that of the
electrons [26]. We remark that extending our algorithm to moving ions and eventually other species
is rather straightforward, and not including this makes no diﬀerence for the algorithm itself.

The source term Si represents creation of electrons and positive ions through impact ionization, and is
the same for both species since charge is conserved during an ionization event. The impact ionization
can be described with Townsend’s approximation [27] (but any other local ﬁeld dependence can be

3

inserted as well)

E
Si = neµe|

E
α(
|
|

E
) = neµe|
|

α0 e−E0/|E| ,
|

where α0 is the ionization coeﬃcient and E0 the threshold ﬁeld for ionization. We do not include
photoionization or recombination since, in the particular case of N2 and for the short time scales
considered, these processes are negligible compared to impact ionization [21]. However, an ionization
mechanism such as photoionization is essential for the development of positive streamers, which are
therefore excluded from the present study.

The electric ﬁeld E is determined through Poisson’s equation for the electric potential V ,

(2.3)

(2.4)

2V =

∇

e
ǫ0

(ne −

n+) , E =

V ,

−∇

where ǫ0 is the permittivity of free space, and e the electron charge.

2.2 Dimensional analysis

This model has been implemented in dimensionless form. The characteristic length and ﬁeld scales
emerge directly from Townsend’s ionization formula (2.3) as l0 = α−1
and E0, respectively. The
0
characteristic velocity is then given as v0 = µeE0, which leads to a characteristic timescale t0 =
l0/v0 = l0/(µeE0). The characteristic density then becomes D0 = l2
0/t0. The number density scale
emerges from the Poisson equation (2.4), n0 = ǫ0E0/el0. We use the values from [26,28] for µe, E0
and α0 in N2 at 300 K, which depend on the neutral gas density,

µe ≃

380
(N/N0)

cm2
V s

, α0 ≃

4332
(N/N0)

1
cm

, E0 ≃

105
2
·
(N/N0)

V
cm

.

(2.5)

Inserting these values in the characteristic scales we obtain, for molecular nitrogen at normal condi-
tions,

10−4
2.3
·
(N/N0)

l0 ≃

cm ,

10−12
3
·
(N/N0)

t0 ≃

s , n0 ≃

1014
4.7
·
e ((N/N0)2

1
cm3 , D0 ≃

104
1.8
·
(T /T0)

cm2
s

.

(2.6)

Here N0 and T0 are the neutral gas density and temperature under normal conditions. The dimen-
sionless quantities are then deﬁned as follows,

r =

R

l0

,

τ =

,

σ =

,

ρ =

, E =

, φ =

, D =

t
t0

ne
n0

n+
n0

V
(E0l0)

De
D0

.

E

E0

(2.7)

For the diﬀusion coeﬃcient we use the value given in [29], De=1800 cm2 s−1, which gives a dimen-
sionless diﬀusion coeﬃcient of 0.1 under normal conditions.

4

Inserting these dimensionless quantities into the continuity equations (2.1)-(2.4), we obtain

=

∇ ·

(σE + D

σ) + σ

exp(

E
|

|

E
1/
|

) ,
|

−

∇

∂σ
∂τ

∂ρ
∂τ

= σ

exp(

E
|

|

E
1/
|

) ,
|

−

2φ = σ

ρ , E =

∇

−

φ ,

−∇

where σ and ρ denote the dimensionless electron and ion number densities, respectively, τ the di-
mensionless time, E the dimensionless electric ﬁeld, φ the dimensionless electric potential and D the
dimensionless diﬀusion coeﬃcient.

We refer to the equations (2.8)-(2.10) as the minimal streamer model, since it contains all the basic
physics needed for negative streamers in a non-attaching gas.

2.3 Geometry and boundary conditions

In narrow geometries, streamers frequently are growing from pointed electrodes, that create strong
local ﬁelds in their neighborhood and a pronounced asymmetry between the initiation of positive and
negative streamers [30]. On the other hand, in many natural discharges and, in particular, for sprites
above thunderclouds [15], it is appropriate to assume that the electric ﬁeld is homogeneous. Of course,
dust particles or other nucleation centers can play an additional role in discharge generation, but in
this paper we will focus on the eﬀect of a homogeneous ﬁeld on a homogeneous gas.

The computational domain is limited by two planar electrodes. The model is implemented in a cylin-
drical symmetric coordinate system (r, z)
(0, Lz), such that the electrodes are placed
(0, Lr)
perpendicular to the axis of symmetry (r=0), the cathode at z = 0 and the anode at z = Lz. The
boundary conditions for the electric potential read

×

∈

φ(r, 0, τ ) = 0 ,

φ(r, Lz, τ ) = φ0 > 0 ,

(Lr, z, τ ) = 0 .

The background electric ﬁeld then becomes

E b =

E b|

−|

ˆez =

φ0
Lz

−

ˆez ,

where ˆez is the unit vector in the z
direction. The radial boundary at Lr is virtual, and only present
to create a ﬁnite computational domain. In order for the boundary condition no to aﬀect the solution
near the axis of symmetry along which the streamer propagates, we need to place this boundary
relatively far from the axis of symmetry.

−

Throughout this article, we use a Gaussian initial ionization seed, placed on the axis of symmetry, at
a distance z = zb from the cathode,

∂φ
∂r

5

(2.8)

(2.9)

(2.10)

(2.11)

(2.12)

σ(r, z, 0) = ρ(r, z, 0) = σ0 exp

zb)2

r2 + (z
−
R2
b

.

(cid:19)

(cid:18)

(2.13)

The maximal density σ0 of this seed, the radius Rb at which the density drops to 1/e of its maximal
value, and the value of zb diﬀer from case to case, and will be speciﬁed where needed. Furthermore,
the use of a dense seed, in particular in low ﬁelds, accelerates the emergence of a streamer. We remark
that the initial seed is charge neutral.

The continuity equation for the electron density is second order in space, and therefore requires two
boundary conditions for each direction in space. At r = Lr and z = Lz we use Neumann boundary
conditions, so that electrons that arrive at those boundaries may ﬂow out of or into the system, but in
all cases discussed in this paper the streamer is too far from the boundary for this to happen. At the
cathode, we impose either homogeneous Neumann or Dirichlet boundary conditions. In the ﬁrst case
we again allow for a net ﬂux of particles through the boundary. Dirichlet conditions will only be used
for a one-dimensional test in this paper. To recapitulate, the boundary conditions for the electrons
read

∂σ
∂z

(r, 0, τ ) = 0 , or σ(r, 0, τ ) = 0 ,

(r, Lz, τ ) = 0 ,

(Lr, z, τ ) = 0 .

(2.14)

∂σ
∂z

∂σ
∂r

Rb, the ionization seed is detached from the cathode, and this results in
We notice that, if zb ≫
practice in a zero inﬂow of electrons. On the other hand, placing the seed near the cathode will result
in an inﬂow of electrons. Varying the value of zb will therefore enable us to investigate the inﬂuence
of the inﬂow of electrons on the streamer propagation.

3 Numerical discretizations

In our numerical simulations we shall mainly consider the streamer model with radial symmetry,
making it eﬀectively two dimensional. To illustrate some of the diﬃculties and their solutions we will
also deal with the one-dimensional case.

In the cylindrically symmetric coordinate system introduced in the previous section, the equations (2.8)-
(2.10) read

=

1
r

∂(rσ
∂r

Er)

+

∂(σ
Ez)
∂z

+

D
r

∂
∂r

∂σ
∂r

(r

) + D

∂2σ
∂z2 + σ

E
|

e−1/|E| ,
|

∂σ
∂t

∂ρ
∂t

= σ

E
|

e−1/|E| ,
|

2φ =

∇

1
r

∂
∂r

(r

) +

∂φ
∂r

∂2φ
∂z2 = σ

ρ .

−

The electric ﬁeld E = (

Er,

Ez)T can be computed from the electric potential as

6

(3.1)

(3.2)

(3.3)

E =

φ =

−∇

∂φ
∂r

,

∂φ
∂z

T

.

(cid:17)

−

(cid:16)

The boundary conditions for this system have been treated in Sect. 2.3.

(3.4)

3.1 Spatial discretization of the continuity equations

The equations will be solved on a sequence of (locally) uniform grids with cells

Cij = [(i

−

×

−

1)∆r, i∆r]

[(j

1)∆z, j∆z], i = 1...Mr, j = 1...Mz ,

where Mr = Lr/∆r and Mz = Lz/∆z are the number of grid points in the r- respectively z-direction,
1
2 )∆z). We denote by σi,j and ρi,j the density approximations
and cell centers (ri, zj) = ((i
in the cell centers. These can also be viewed as cell averages. The electric potential φij and ﬁeld
strength
|i,j are taken in the cell centers, whereas the electric ﬁeld components are taken on the
cell vertices. For the moment it is supposed that the electric ﬁeld is known, its computation will be
discussed later on.

1
2 )∆r, (j

E
|

−

−

The equations for the particle densities are discretized with ﬁnite volume methods, based on mass
balances for all cells. Rewriting the continuity equations (3.3) will result in the semi-discrete system

(ri−

1
2

Fi−

1

2 ,j −

ri+

Fi+

1

2 ,j) +

1
2

(Fi,j−

1
2 −

Fi,j+

1
2

) + Si,j ,

1
∆z

(3.5)

dσi,j
dt

dρi,j
dt

=

1
ri∆r

= Si,j ,

in which F = F a + F d. F a and F d are the advective and diﬀusive electron ﬂuxes through the cell
boundaries, and Sij is the source term in the grid cell

Cij.

The discretization of the advective terms requires care. A ﬁrst order upwind scheme as used in [21,23]
appears to be much too diﬀusive [31], leading to a totally diﬀerent asymptotic behavior on realistic
grids. Moreover, it is expected that the numerical diﬀusion might over-stabilize the numerical scheme,
thereby suppressing interesting features of the solutions. This explains why streamer branching is not
seen by the authors of [21,23]. On the other hand, higher order linear discretizations lead to numerical
oscillations and negative values for the electron density, that will grow in time due to the reaction term.
This holds in particular for central discretizations [32]. The choice was made to use an upwind-biased
scheme with ﬂux limiting. This gives mass conservation and monotone solutions without introducing
too much numerical diﬀusion. For the limiter we will take the Koren limiter function, which is slightly
more accurate than standard choices such as the van Leer limiter function [32].

Denoting
E
components

+ = max(
Er,

−E

, 0) and

− = min(

E

−E

Ez, the advective ﬂuxes in the r- direction are computed by

, 0) to distinguish upwind directions for the ﬁeld

F a
i+

1

2 ,j =

+
r; i+

1
2 ,j

E

θi,j

σi+1,j −

σi,j

+

−
r; i+

1
2 ,j

E

σi+1,j + ψ

σi,j + ψ
h

(cid:0)

(cid:1)(cid:0)

h

1
θi+1,j

(cid:0)

(cid:1)(cid:0)

σi,j −

σi+1,j

,(3.6)

(cid:1)i

(cid:1)i

7

in which

θi,j =

σi,j −
σi+1,j −

σi−1,j
σi,j

,

ψ(θ) = max

0, min

1,

+

, θ

.

(3.7)

1
3

θ
6

(cid:16)

(cid:16)
The advective ﬂuxes in the vertical direction are computed in the same way; the fact that the r-
direction is radial is already taken care of in (3.5). Note that in regions where the solution is smooth
we will have values of θij close to 1, and then the scheme simply reduces to the third-order upwind-
biased discretization corresponding to ψ(θ) = 1
3 + 1
6 θ. In non-smooth regions where monotonicity is
important the scheme can switch to ﬁrst-order upwind, which corresponds to ψ(θ) = 0.

(cid:17)(cid:17)

The diﬀusive ﬂuxes are calculated with standard second-order central diﬀerences as

F d
i+

1

2 ,j =

D
∆r

(σi,j −

σi+1,j) .

F d

i,j+

1
2

=

D
∆z

(σi,j −

σi,j+1) ,

Finally, the reaction term Sij in (3.5) is computed in the cell centers as

E
Si,j = σi,j|

|ije−1/|E|ij .

Boundary values will be either homogeneous Dirichlet or homogeneous Neumann type. For example,
for Dirichlet boundary conditions σ = 0 for z = 0, we introduce virtual values [32]

σi,0 =

σi,1 ,

σi,−1 =

σi,2 .

−

−

For Neumann boundary conditions ∂zσ = 0 for z = 0 we set

σi,0 = σi,1 ,

σi,−1 = σi,2 .

These formulas follow from the approximations

σ(ri, z 1
2

) =

σz(ri, z 1
2

) =

1
(σ(ri, z0) + σ(ri, z1)) +
2
1
∆z

O
σ(ri, z0)) +

(σ(ri, z1)

−

(∆z2)

(∆z2)

O

3.2 Spatial discretization of the Poisson equation

(3.8)

(3.9)

(3.10)

(3.11)

(3.12)

The electric potential φ is computed through a second-order central approximation of Eq. (2.10), and
is deﬁned at the cell centers:

σi,j −

ρi,j =

φi+1,j −

2φi,j + φi−1,j
∆r2

φi+1,j −

+

φi−1,j

φi,j+1 −

+

2ri∆r

2φi,j + φi,j−1
∆z2

.

(3.13)

8

The electric ﬁeld components are then computed by using a second-order central discretization of
E =

φ, they are deﬁned in the cell boundaries,

−∇

1

2 ,j =

Er;i+

φi+1,j

φi,j −
∆r

,

Ez;i,j+

=

1
2

φi,j+1

φi,j −
∆z

.

The electric ﬁeld strength is computed at the cell centers, therefore the components are ﬁrst deter-
mined in the cell centers by averaging the cell boundary values, and the electric ﬁeld strength then
becomes:

E
|

|i,j =

1
2

q

(
Er;i−

1

2 ,j +

Er;i+

1

2 ,j)2 + (

Ez;i,j−

+

1
2

Ez;i,j+

)2 .

1
2

We notice here that, discretizing

E with a second-order central scheme gives

∇ ·

∂
∂t

(
∇ ·

E) =

∂(σi,j −
∂t

ρi,j)

.

Therefore, the total current conservation,

∂E
∂t −

σE

D

σ

∇

−

= 0 ,

(cid:19)

∇ ·

(cid:18)

also holds on the level of the discretizations.

3.3 Temporal discretization

dσ
dτ

dρ
dτ

= G(σ, E) ,

= S(σ, E) ,

After the spatial discretization, the system of equations (3.5) can be written in vector form as a system
of ordinary diﬀerential equations,

where the components of G and S are given by the spatial discretizations in (3.5). The electric ﬁeld
E and the ﬁeld strength
are computed from given σ, ρ by discretized versions of (3.3) and (3.4),
discussed in Sect. 4.4. Therefore the full set of semi-discrete equations actually forms a system of
diﬀerential-algebraic equations.

E
|

|

The particle densities are updated in time using the explicit trapezoidal rule, which is a two-stage
method, with step size ∆τ . Starting at time τ n = n∆τ from known particle distributions σn(r, z)

9

(3.14)

(3.15)

(3.16)

(3.17)

≈

σ(r, z, τ n), ρn(r, z)
and ¯ρn+1 for the electron and ion densities at time τ n+1 are ﬁrst computed by

ρ(r, z, τ n) and known electric ﬁeld E n(r, z)

≈

≈

E(r, z, τ n), the predictors ¯σn+1

¯σn+1 = σn + ∆τ G(σn, E n) ,

¯ρn+1 = ρn + ∆τ S(σn, E n) ,

After this the Poisson equation (3.3) is solved with source term ¯σn+1
¯ρn+1, leading to the electric
ﬁeld ¯E n+1 at this intermediate stage by Eq. (3.4). The ﬁnal densities at the new time level τ n+1 are
then computed as

−

σn+1 = ¯σn+1 +

G(σn, E n) +

G(¯σn+1, ¯E n+1) ,

ρn+1 = ¯ρn+1 +

S(σn, E n) +

S(¯σn+1, ¯E n+1) ,

∆τ
2

∆τ
2

∆τ
2

∆τ
2

after which the Poisson equation is solved once more, but now with the source term σn+1
ρn+1, giving
the electric ﬁeld E n+1 induced by the ﬁnal particle densities at time τ n+1. This time discretization is
second-order accurate, which is in line with the accuracy of the spatial discretization.

−

The use of an explicit time integration scheme implies that the grid spacing and time step should obey
restrictions for stability. For the advection part we get a Courant-Friedrichs-Lewy (CFL) restriction

max

+ max

< νa ,

∆τ
∆r

Er

∆τ
∆z

Ez

and the diﬀusion part leads to

D

∆τ
∆r2 + D

∆τ
∆z2 < νd .

Actually, to be more precise, a combination of (3.20), (3.21) should be considered. However, in our
simulations, condition (3.20) will dominate and the time step will be chosen well inside this constraint.

For the ﬁrst order upwind advection scheme combined with a two-stage Runge-Kutta method, the
maximal Courant number is [32] ν1
a = 0.87. The
second order central discretization demands a maximal Courant number νd = 0.5.

a = 1, while for the third order upwind scheme it is ν3

A third restriction for the time step comes from the dielectric relaxation time. The ions are considered
to be immobile, which leaves us with the following time step restriction in dimensional units [33],

∆t

≤

ǫ0
eµe max ne

,

10

(3.18)

(3.19)

(3.20)

(3.21)

(3.22)

where we refer to the previous section for the meaning of these quantities. If we apply the dimensional
analysis of the previous section, we obtain the time step restriction in dimensionless units,

∆τ

1
σ

.

≤

(3.23)

In practice, it appears that this restriction is much weaker than that for the stability of the numerical
scheme.

The choice for an explicit time stepping scheme was made after tests with VLUGR [34], a local
reﬁnement code that uses –computationally much more intensive– implicit schemes (BDF2). These
tests showed that these implicit schemes also needed relatively small time steps to obtain accurate
solutions, so that in the end an explicit scheme would be more eﬃcient in spite of stability restrictions
for the time steps. Moreover the use of an explicit scheme allows us to decouple the computation of the
particle densities from that of the electric potential and electric ﬁelds. With a fully implicit scheme all
quantities are coupled, leading to much more complex computations and longer computation times.

Another reason for preferring explicit time stepping is monotonicity. The solutions in our model have
very steep gradients for we use spatial discretizations with limiters to prevent spurious oscillations.
Of course, such oscillations should also be prevented in the time integration. This has led to the
development of schemes with TVD (total variation diminishing) or SSP (strong stability preserving)
properties; see [35,32]. In contrast to stability in the von Neumann sense (i.e., L2-stability for lin-
ear(ized) problems with (frozen) constant coeﬃcients), such monotonicity requirements do not allow
large step sizes with implicit methods of order larger than one. Among the explicit methods, the
explicit trapezoidal rule is optimal with respect to such monotonicity requirements.

3.4 Remarks on alternative discretizations

The above combination of spatial and temporal discretizations provide a relatively simple scheme
for the streamer simulations. The accuracy will be roughly O(∆x2) + O(∆τ 2) in regions where the
solution is smooth (also for the limited advection discretization [32, p. 218]). In our tests, step size
restrictions mainly originate from the advective parts in the continuity equations. The above scheme
is stable and monotone (free of oscillations) for Courant numbers up to one, approximately. Usually
we take smaller step sizes than imposed by this bound to reduce temporal errors.

As mentioned before in Sect. 3.1 using a ﬁrst-order upwind discretization for the advective term will
usually give rise to too much diﬀusion, whereas second-order central advection discretizations lead to
numerical oscillations and negative concentrations.

Higher-order discretizations can certainly be viable alternatives. However, we then will have larger
spatial stencils, which creates more diﬃculties with local grid reﬁnements where numerical interfaces
are created. The above discretization is robust and easy to implement.

It is well known that limiting as in (3.6) gives some clipping of peak values in linear advection tests,
simply because the limiter does not distinguish genuine extrema from oscillations induced numerically.
This can be avoided by adjusting the limiter near extrema, but in the streamer tests it was found

11

that such adjustments were not necessary. In the streamer model the local extrema in each spatial
direction are located in the streamer head, and the nonlinear character of the equations gives a natural
steepening there which counteracts local numerical dissipation.

In [28] a ﬂux-corrected transport (FCT) scheme was used. The advantage of our semi-discrete approach
is that is becomes easier to add source terms without having to change the simulation drastically.
Also the transition from 1D discretizations to 2D or 3D becomes straightforward conceptually; the
implementations for higher dimensions are still diﬃcult, of course, in particular for the Poisson equa-
tion. Moreover, in [31] comparisons of the FCT scheme with a scheme using the van Leer limiter
(which is closely related to the limiter used in our scheme) show that the FCT scheme, in contrast to
the limited scheme, gives somewhat irregular results for simple advection tests in regions with small
densities. In the leading edge the densities decay exponentially, and we do not want such irregularities
to occur.

4 The adaptive reﬁnement procedure

4.1 The limitations of the uniform grid approach

Up to now, all simulations that have been carried out on the minimal streamer model were performed
on a uniform grid [26,28,13,14]. However the use of a uniform grid on such a large system has several
limitations.

·

×

2000 = 4

The ﬁrst limitation is the size of the system. In [13,14] the simulations were performed in a radially
106 grid points. Since the number of variables is of at least
symmetric geometry with 2000
10 per grid point (the electron and ion densities both at old and new time step, the electric potential,
the electric ﬁeld components and strength, and the terms containing the temporal derivatives of both
106. So, when computing
electrons and ions), the total number of variables will be of at least 40
in double precision (64 bits or 8-bytes values) the memory usage is in the order of several hundreds
MB, depending on the compiler. Moreover, these simulations show that the streamer will eventually
branch, and up to now there was no convergence of the branching time with respect to the mesh size.
In order to investigate the branching, it would be necessary to rerun the simulation with a smaller
grid size. Moreover it would be interesting to investigate larger systems. So from that point of view
it is worth looking at an algorithm that would require much less memory usage.

·

The second limitation comes from the Poisson equation, which has to be solved at each time step,
and therefore requires a fast solver. For this we use the Fishpak routine, described in [36,37]. One
of the major limitations of this routine is its ineptitude to deal accurately with very large grids, due
to numerical instabilities with respect to round-oﬀ errors. Numerical experiments show that on an
mz grid with either mr or mz substantially larger than 2000, the Fishpak routine gives large
mr ×
errors due to numerical instabilities with respect to round-oﬀ errors. An illustration is presented in
the appendix.

It is necessary to develop some strategy to counteract these limitations. This will be done by choosing
separate grids with suitable local reﬁnements for the continuity equations (2.8)-(2.9) and the Poisson

12

+
+

+
+

++
+
+

+ +
+

+ +
+ + +

Fig. 1. An example of nested grids: (cid:4) cell centers on Ω1 with l(1) = 1,
cell centers on Ω4 with l(4) = 3.
+ cell centers on Ω3 with l(3) = 3,

×

cell centers on Ω2 with l(2) = 2,

equation (2.10).

◦

4.2 General structure of the locally uniform reﬁned grids

Both the continuity equations (3.3) and the Poisson equation (3.3) are computed on a set of uniform,
radially symmetric grids, that are reﬁned locally where needed. Solving these equations separately
rather than simultaneously allows the use of diﬀerent sets of grids for each equation, thereby making
it possible to decouple the grids for the continuity equation from those of the Poisson equation; grids
can then be tailored for the particular task at hand. We emphasize that it is the use of an explicit
time stepping method that allows us to decouple the grids.

In both cases the equations are ﬁrst solved on a coarse grid. This grid is then reﬁned in those regions
where a reﬁnement criterion – which will be treated in more detail below – is met. These ﬁner grids can
be further reﬁned, wherever the criterion is still satisﬁed. Both the grids and the reﬁnement criteria
may be diﬀerent for the continuity equations on the one hand and the Poisson equation on the other
hand, but the general structure of the grids is the same for both type of equations. It consists of a
series of nested grids Ωk, k being the grid number, with level l(k). This level function gives the mesh
width of a grid, l(1) = 1 corresponding to the coarsest grid Ω1 with mesh width ∆rc and ∆zc. A
certain grid will have a mesh twice as ﬁne as the grid one level coarser – which we will call its parent
grid – so that the mesh widths of a grid with level l become ∆rl = ∆rc/2l−1 and ∆zl = ∆zc/2l−1.

Fig. 1 shows an example of four nested grids on three levels. We will denote a quantity u on a certain
j). Recall that rl
grid Ωk with level l = l(k) as uk

1/2)∆rl, zl

ij = u(rl

1/2)∆zl.

j = (j

i = (i

i, zl

−

−

, those for the continuity
Throughout this article, the grids for the Poisson equation are denoted by
. For the Poisson equation the grids are structured as follows: we determine all grid
equations by
H
l at a certain level l that, following some reﬁnement monitor (we will give more
points of a grid
details later), have to be reﬁned. This results in one or more connected sets of ﬁner grid cells. The
l cover the smallest rectangular domain enclosing each of
ﬁner child grids
these sets.

of the parent grid

{G

l+1

G

G

G

}

For the continuity equations, the placement of child grids is somewhat diﬀerent. Again we ﬁnd the

13

l at a certain level l. However instead of taking
set of grid points that have to be reﬁned on a grid
one single rectangular grid that encloses the entire connected set of reﬁned grid points, we now use a
series of smaller rectangular domains
, each of which covers a part of the region that has to be
{H
}
l+1
reﬁned. The union of the sets
obviously should cover the whole reﬁned region. We notice that
l+1 contain an identical, user deﬁned, number of grid points M0 in the radial direction.
all the grids

{H

l+1

H

}

H

In what follows, to make the distinction between the indices on a coarse and on a ﬁne grid, we use
capital indices I and J for the coarse grid and small indices i and j for the ﬁne grid. Notice that
a coarse grid cell with the cell center (rI , zJ ) contains four ﬁner cells with centers (ri, zj ), (ri, zj+1),
(ri+1, zj), (ri+1, zj+1), with i = 2I

1 and j = 2J

1.

−

−

4.3 Reﬁnement scheme for the continuity equation

Let us assume that the particle distributions and electric ﬁeld at time τ n are known on a set Sn of
m rectangular grids
m, as shown in Fig. 2. Then, using the explicit
k
time stepping method introduced in Sect. 3.3, the particle distributions at time τ n+1 can be computed
on all the grids of Sn (Fig. 2b). Now the new set Sn+1 of nested grids that is best suitable for the
solution at τ n+1 has to be found, as in Fig. 2c.

n,k with level l = l(k), 1

H

≤

≤

Moreover, the computational domain for the continuity equations can be reduced substantially by
the following physical consideration: our model is a ﬂuid model based in the continuum hypothesis,
which is not valid anymore if the densities are below a certain threshold, that is taken as 1 mm−3. In
nitrogen at atmospheric pressure, this corresponds roughly to a dimensionless density of 10−12. The
regions where all densities are below this threshold is ignored. Therefore, after each time step the
densities below this threshold are set to zero. The computational domain for the continuity equations
for the next time step is then taken as the region where σ or ρ are strictly positive. In view of our
two-stage Runge-Kutta time stepping we use a four point extension of this domain in all directions.

4.3.1 Restriction of ﬁne grid values to a coarse grid

H

H

n,k are restricted to

n,K at level L = L(K) contains a ﬁner grid

n,k at level l = L + 1, the particle
At ﬁrst, when a grid
n,K in such a way that the total mass of each particle species is
densities on
n,k, and the
conserved locally. From Fig. 1 it can be seen that one cell of
mass conservation implies that for each particle species the total mass in the coarse grid cell is equal to
the sum of the masses in the ﬁner grid cells, which, taking into account the cylindrical geometry of the
cells, translates in the following restriction formula U K = Res(U k) for the grid functions U K =
and U k =

n,K contains four cells on

uK
IJ }
{

H

H

H

H

uk
,
ij}
{

IJ = Res(U k)IJ =
U K

1
4rL
I

2I

2J

mul
rl

mn ,

Xm=2I−1

Xn=2J−1

(4.1)

in which u stands for either the electron or the ion density. This restriction step is carried out because
time stepping on a too coarse grid may lead to erroneous values, which are now overwritten by the

14

better restricted values. The r-factors account for the mass distribution in the radial cells in cylindrical
symmetry.

4.3.2 Reﬁnement criterion: curvature monitor

It is now possible to ﬁnd the regions where the grids should be reﬁned at tn+1. The decision whether a
ﬁner grid should be used on a certain region is made with a relative curvature monitor. This monitor
is deﬁned on a grid with level l as the discretization of

Mu(rl, zl) = (∆rl)2

1
r

∂
∂r

(r

∂u
∂r

)

+ (∆zl)2

∂2u
∂z2

.

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
Although this expression does not provide an accurate estimate of the discretization errors, it does
give a good indication of the degree of spatial diﬃculty of the problem [38]. It is applied ﬁrst to the
electron density σ, since that is the quantity which advects and diﬀuses, and therefore the quantity
in which some discretization error will appear. The monitor is also applied to the total charge density
ρ since this is the source term of the Poisson equation, and the accuracy of the solution of the
σ
Poisson equation is of course dependent on the accuracy of the source term. The monitor is taken
relative to the maximum value of each quantity, and the reﬁnement criterion through which the need
to reﬁne a certain grid

k with level l then reads:

−

H

reﬁne all grid cells i, j where

Mu(rl
i, zl
j)
max ul
ij ≥

ǫl
u,

u = σ, σ

ρ

−

(4.2)

(4.3)

(a)

(b)

(c)

Fig. 2. (a): Contour line of the solution and the set of rectangular computational grids, both at τ n. (b):
Contour line of the solution at τ n+1 and computational grids at τ n. (c): Contour line and computational
grids at τ n+1, the dashed lines are the grids at τ n.

15

in which ǫl
and Sect. 6.

σ and ǫl

σ−ρ are grid-dependent reﬁnement tolerances that will further be discussed in Sect. 5

Now, starting from the coarsest grid, the monitors are computed by approximating them with a second
order central discretization, which determines the regions that should be reﬁned. For this set of ﬁner
grids again the regions to be reﬁned are computed, and so on either until the ﬁnest discretization
level is reached, or until the monitor is small enough on every grid. Now the new set of nested grids
Sn+1 has been determined, but the particle densities are still only known on the set Sn (in Fig. 2c
this means that we have to convert the density distributions on the dashed grids to distributions on
the solid rectangles).

Criteria such as (4.2) are common for grid reﬁnements. As we shall see in experiments, it will be
necessary to extend the reﬁned regions to include (a part of) the leading edge of a streamer. This
leading edge is the high ﬁeld region into which the streamer propagates, and where the densities decay
exponentially. This modiﬁcation, due to the pulled front character of the equations [25], is discussed
in Sect. 5.

(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)

Ωn,1

Ωn+1,2

Ωn,2

Ωn,3

(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)

Fig. 3. Three grids at time τ n (solid lines) and a grid at next time step τ n+1 (enclosed by the dashed
n,2. In the vertically striped region the new grid coincides with a ﬁner grid
lines) with the same level as
at the previous time step, in the horizontally striped region only a coarser grid existed at τ n, and in the
region that is not ﬁlled a grid at the same level existed at τ n.

H

4.3.3 Grid mapping

In the following we consider mapping functions from a coarse grid
k with level l. There are three possible relations between a grid

K with level L to a child grid
H
n+1,k at time τ n+1 and the older

H
grids

n,k

{H

, as illustrated in Fig. 3.
}

H

First it is possible that at the previous time step a ﬁner grid
(as in the vertically striped region of Fig. 3). Then the values of the densities on the new grid are
computed by the restriction (4.1):

n,K existed on some region of

n+1,k

H

H

U n+1,k = Res(U n,K)

on

n+1,k

n,k ,

H

∩ H

(4.4)

16

where U again stands for the set of grid values of either electron- or ion densities.

Secondly, there is the possibility that (part of) the new grid already existed at previous time step, in
which case there is no need for projecting the density distributions from one grid to the other.

n,K existed at
Finally, it may occur that the new grid lies on a region where only a coarser grid
the previous time level (as in the horizontally striped region in Fig. 3). Then we have prolongate
the coarse grid values U n+1,K to the new ﬁne grid. One main consideration in the choice of the
prolongation is the conservation of charge in the discretizations. For simplicity, we will ﬁrst consider a
one-dimensional prolongation, which is then easily extended to more dimensions. We consider coarse
grid values U K =
. Then a mass conserving interpolation for values U k =
on a grid twice
as ﬁne is,

uK
I }
{

uk
i }
{

H

uk
i = U K

I + DI ,

uk
i+1 = U K

DI ,

I −

which obviously implies mass conservation, ∆zluk
the coeﬃcient DI , such that the interpolation is second order accurate, can be written as

i+1 = ∆zLU K

i + ∆zluk

I . Using a three-points stencil,

(4.5)

(4.6)

DI =

(UI−1 + UI+1) .

1
8

In the case of a three-dimensional geometry with axial symmetry, the above interpolation is applied
on U K in the z-direction, and on RU K in the radial direction, which ensures mass conservation on
such a system.
Remark: This mass conserving interpolation might lead to new extrema or negative values. That could
be prevented automatically by limiting the size of the slopes. However, in our simulations this turned
out not to be necessary.

Finally, we need boundary values for all grids. On the coarsest grid these simply follow from the
discretization of the boundary conditions (2.11)-(2.14), as explained in Sect. 3.1. On ﬁner grids they
are interpolated bi-quadratically from coarse grid values. The interpolation error is then third order,
and therefore smaller than the discretization error, which would not be the case with a bi-linear
interpolation. The quadratic interpolation is derived using the Lagrange interpolation formula to ﬁnd
U k =

from the coarse grid values U K =

. The interpolated value becomes

uK
IJ }
{

uk
ij}
{

ij = Int(U K)ij =
uk

rl(K)
I+p uK

I+p,J+q

1
rl(k)

1

1

p=−1
X

q=−1
X

1

YP 6=p
P =−1

rl(k)
i −
rl(K)
I+p −

rl(K)
I+P
rl(K)
I+P

1

YQ6=q
Q=−1

zl(k)
j −
zl(K)
J+q −

zl(K)
J+Q
zl(K)
J+Q

,

(4.7)

in which I = (i + i mod 2)/2 and J = (j + j mod 2)/2. We notice that the interpolated quantity
again is not σ but rσ because of the cylindrical coordinate system.

In our algorithm, mass conservation at the grid interfaces will simply be ensured by matching the
ﬂuxes of the ﬁne and coarse grids.

17

4.3.4 Flux conservation at grid interfaces

The mapping from one grid to the other must take into account a ﬂux correction on grid interfaces,
in order to ensure mass conservation. This correction yields that the total mass going through one
coarse grid cell must be the same as the sum of total mass going through two ﬁne grid cells. Taking
into account the cylindrical geometry of the system, the ﬂuxes through coarse grid cells become, in
terms of the ﬁne grid ﬂuxes,

F K

r;I+1/2,J =

F K

z;I,J+1/2 =

∆rl
∆rL (F k
∆rl
(rl
∆rLrI

r;i+1/2,j + F k

r;i+1/2,j+1) ,

iF k

z;i,j+1/2 + rl

i+1F k

z;i+1,j+1/2) ,

where i = 2I

1 and j = 2J

1.

−

−

4.4 Reﬁnement scheme for the Poisson equation

(4.8)

The reﬁnement strategy for the computation of the electric potential is also based on a static regridding
approach, where the grids are adapted after each complete time step. In this case however, the
reﬁnement criterion is not based on a curvature monitor but on an iterative error estimate approach.
The Fishpak routine will be used on a sequence of nested grids
m. The solution on a coarse grid will
be used to provide boundary conditions for the grid on the ﬁner level, which will in general extend
over a smaller region. This approach is explained in full detail in [39]; here we will discuss the main
features of the scheme.

G

k

Starting from the (known) charge density distribution σ
equation is ﬁrst solved on the two coarsest grids
domain (0, Lr)

, the Poisson
−
}
2, both covering the entire computational
G
(0, Lz). The ﬁnest of these two grids is coarser or as coarse as the coarsest grid of
2, using the restriction
{H
formula (4.1). The source term of the Poisson equation is then known on these two coarse grids, and
the Poisson equation is solved using a Fishpak routine that discretizes Eq. (3.3) using second-order
diﬀerences:

. The densities should then ﬁrst be mapped onto the coarse grids
}

ρ on a set of grids

1 and

1 and

{H

×

G

G

G

k

σm
i,j −

ρm
i,j =

φm
i+1,j −

2φm
(∆rl)2

i,j + φm

i−1,j

+

φm
i+1,j −
2rl

φm
i∆rl

i−1,j

+

φm
i,j+1 −

φm
i,j + φm
(∆zl)2

i,j−1

(4.9)

m. This system of linear equations is then solved using a cyclic
in which l = l(m) is the level of grid
reduction algorithm, see [40]. The details of Fishpak are described in [37]. The subroutine was used
as a black box in our simulations. A comparison with iterative solvers, multigrid or conjugate gradient
type, can be found in [41]. For the special problem we have here – Poisson equation on a rectangle
– such iterative solvers are not only much slower than Fishpak, but they also require much more
computational memory.

G

As a next step, the coarse grid electric potentials φ1 on
other, by mapping φ1 onto
in Fig. 4.

2 are compared with each
1 and φ2 on
2 with a quadratic interpolation based on a nine-point stencil as shown

G

G

G

18

(cid:0)(cid:1)

(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

l−1zJ+1

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
l
(cid:0)
(cid:1)
j+1z
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)
(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:1)(cid:1)
(cid:0)(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

l−1z
J−1

l−1
r I+1

l−1
r I

l−1
z
J

(cid:1)
(cid:0)
(cid:1)
(cid:0)
(cid:0)
(cid:1)
(cid:0)
(cid:1)

(cid:1)
(cid:0)
(cid:0)
(cid:1)

l−1
I−1

lzj

r

lr i

lr i+1

Fig. 4. The nine-points stencil used to map coarse grid values of the electric potential φl−1
grid, thus obtaining φl
(cid:4), those of the ﬁne grids with

IJ onto the ﬁne
i+1,j+1. The cell centers of the coarse grid are marked with

, and the boundary points of the ﬁne grids are marked with
◦

i,j+1 and φl

i+1,j, φl

i,j, φl

.

For the prolongation that gives a continuous map of an electric potential φM =
grid

m the following formula, based on a least square ﬁt, is used:

φM
IJ }
{

×
onto a ﬁner

G

φm(r, z) = P ro( φM (r, z))

= φM

IJ + c10(r

rM
I ) + c01(z

zM
J ) + c11(r

rM
I )(z

zM
J )+

−

−

−

+ c20(r

I )2 + c02(z
rM

−

−
zl−1
)2 .
J

−

(4.10)

For the values of the coeﬃcients cij we refer to [39]. This interpolation will primarily be used to
generate boundary conditions for the ﬁner level, as illustrated in Fig. 4 for the boundary points on
the ﬁner grid marked with
, but it will also be used for error estimation. The interpolation for the
boundary conditions will be done such that there is a bias in the stencil toward the smooth region to
enhance the accuracy.

×

The error of the solution on a grid
solution on that grid and the interpolation of the solution on the underlying coarser grid

m is then estimated by the point-wise diﬀerence between the

M :

G

G

(4.11)

(4.12)

The reﬁnement criterion is as follows:

i,j = φm
gm

i,j −

(P ro φM )i,j .

reﬁne all grid cells i, j where

gm
i,j| ≥
|

ǫφ

where ǫφ is a small parameter that still has to be chosen. This leads to new and ﬁner grids on which
the whole procedure of mapping the charge densities onto it, solving the Poisson equation using the
Fishpak routine and estimating the error is repeated, and so on either until the error is smaller than
ǫφ everywhere or until the ﬁnest desired level is reached. Notice that, since the grids do not cover the
whole computational domain anymore, the boundary conditions (2.11) do no longer hold. We now
have Dirichlet boundary conditions on each boundary that lies in the interior of the computational
domain, and they are computed by interpolating the electric potential on the ﬁnest grid that is known
using Eq. (4.10). Using this third order interpolation formula implies that the error introduced by the
interpolation is negligible compared to to discretization error, which is second order. With this method

19

there is an upper bound for the maximum error em on grid m with level l [39]:

em

3 max
i,j

≤

gm
ij + (l

−

1)ǫφ,

(4.13)

where gm = max gm
can be made as small as wanted provided ǫφ is taken small enough.

ij as deﬁned in Eq. (4.11). This means that the extra error due to the reﬁnement

k, since it appears in the continuity
The electric ﬁeld has to be known on the continuity grids
equations (2.8)-(2.9). However it has to be computed from the electric potential that is only known
k with level l(k) on which the electric ﬁeld
on the Poisson grids, using Eq. (3.4). We consider the grid
m with level l(m), which has a non-empty intersection
has to be known, and the ﬁnest potential grid
with

k.

H

H

G

H

There are three possible situations: the potential grid can be either coarser, as ﬁne as, or ﬁner than the
continuity grid. If both grids have the same size (l(k) = l(m)), or if the continuity grid is coarser than
the Poisson grid (l(k) < l(m)), then the ﬁeld components are set directly with a second order central
approximation of Eq. (3.4), using the neighboring points of the point where the ﬁeld components need
to be known. If the Poisson grid is coarser than the continuity grid (l(k) > l(m)), the electric ﬁeld
is ﬁrst computed on the Poisson grid with a second order central approximation of Eq. (3.4), and
then this ﬁeld is interpolated to the continuity grid. The interpolation is performed with a piecewise
bilinear approximation.

4.5 Overall algorithm

In previous sections, the reﬁnement algorithms for the continuity equations and the Poisson equation
have been treated separately. We here describe the overall algorithm.

We start from known density distributions of the charged particles σn and ρn at a certain time τ n,
n,k is computed using
on a set of grids
the reﬁnement method described in Sect. 4.4.

n,k. The electric ﬁeld induced by the charges on the grids

H

H

The step size for the time integration is then set in such a way that the stability conditions (3.20)-
(3.21) of both advection and diﬀusion discretizations are met on the ﬁnest grid. The values of both
νa and νd have been taken as 0.1. This is smaller than the maximal values of 0.87 and 0.37 speciﬁc
to the third-order upwind scheme for the advection and the second-order central discretization for
diﬀusion, respectively, together with a two-stage Runge Kutta time integration method [32].

Then, starting on the ﬁnest grid level, the particle ﬂuxes are computed on each grid and corrected
using the ﬂux correction formulas (4.8). Then the ﬁrst stage of the Runge Kutta step (3.18) is carried
out. The ﬁeld induced by the density predictors ¯σn and ¯ρn is again computed using the procedure
described in Sect. 4.4. The new boundary conditions for the particle densities are computed on all
n,k, and the second stage of the Runga-Kutta method is carried out in the same way as the
grids
ﬁrst stage. We then obtain the density distributions σn+1 and ρn+1 on the set of grids

n,k.

H

H

Following the procedure described in Sect. 4.3, after restriction of ﬁne grid values to the parent grids,
n+1,k for the next time step are computed using the reﬁnement monitor (4.3). The densities
the grids
n+1,k, and the new boundary conditions are
are then mapped from the grids

n,k to the grids

H

H

H

20

computed. We thus obtain the density distributions σn+1 and ρn+1 on the set of grids
new time τ n+1.

H

n+1,k at the

5 Tests of the algorithm on a planar ionization front

The implementation of the grid reﬁnements is ﬁrst tested on the evolution of a planar streamer front.
As analytical results for this case are available [12], any errors in the implementation can be identiﬁed.
Moreover, conclusions on the tolerances and interpolations can be drawn for the more general two-
dimensional simulations.

A one-dimensional simulation is carried out with the two-dimensional code by letting initial and
boundary conditions depend on z only and not on the radial coordinate r. Speciﬁcally, the initial
ionization seed

σ(r, z, 0) = ρ(r, z, 0) = 10−2 e−(z−zb)2
is located at z = zb and a constant background electric ﬁeld E b =
region in this speciﬁc example is (r, z)
the electron density and the electric potential in this speciﬁc case are

[0, L]

×

∈

ˆez is applied. The spatial
E b|
[0, L] with L = 1024. The boundary conditions for

−|

σ(r, 0, τ ) = 0 ,

(r, L, τ ) = 0 ,

(0, z, τ ) = 0 ,

(L, z, τ ) = 0 ,

∂σ
∂z

∂φ
∂z

∂σ
∂r

∂φ
∂r

∂σ
∂r

∂φ
∂r

(r, L, τ ) =

φ(r, 0, τ ) = 0 ,

E b|
|
In this situation, the electric ﬁeld does not depend on r. It can be written as E(r, z, τ ) =
and it can be obtained directly from the charge densities by integrating
along the z-direction and using the boundary condition
result is

(z, τ )ˆez,
E
σ from Eq. (2.10)
for the electric ﬁeld at z = L. The

(L, z, τ ) = 0 .

(0, z, τ ) = 0 ,

E = ρ

E b|

∇ ·

−|

=

−

E

,

(z, τ ) =

E

E b|

−|

+

σ(z′, τ )

ρ(z′, τ )

dz′.

−

L

z

Z

(cid:0)
This means that it is not necessary to calculate the electric potential φ. Rather the electron and
n at each cell vertex by discretizing
positive ion density at time tn determine the electric ﬁeld
Eq. (5.3). Starting from the value at z = L, which corresponds to j = M on a grid with M grid points
in the z-direction, we thus obtain:

E

(cid:1)

n
M +

1
2

E

=

E b|

,

−|

n
j−

1
2

E

=

n
j+

1
2

E

+ ∆z(σn

ρn
j ) for j

j −

M .

≤

The electric ﬁeld strength in the cell centers is then taken as the average ﬁeld of the corresponding
vertices,

(5.1)

(5.2)

(5.3)

(5.4)

(5.5)

Fig. 5 shows the temporal evolution of the initial ionization seed (5.1) located at zb = 31, with a
background ﬁeld
= 1 and a diﬀusion coeﬃcient D = 0.1, on a uniform grid with grid size ∆r = 32
and ∆z = 1/4. zb is chosen large enough that boundary eﬀects at z = 0 don’t matter, neither on the
ﬁne nor on a coarse grid with ∆z = 2, and that the initial maximum is well presented on the coarse

E b|
|

n
j =
|E|

1
2

n
j−

1
2

+

n
j+

1
2

E

(cid:12)
(cid:12)
(cid:12)

E
(cid:12)
(cid:12)
(cid:12)

21

0.2

σ

0.1

ρ
−
σ

0

0

0.1

0

−0.1

0

0

−1

0

|

ε

|

−0.5

1.5  

y
t
i
c
o
e
v
 
t

l

n
o
r
f

1.45 

1.4  
v*

1.35 

1.3  

0

50

100

150

200

250

300

350

50

100

150

200

250

300

350

50

100

150

200

250

300

350

Fig. 5. Uniform grid solutions of the planar streamer front with
with time steps of 10. The thick lines correspond to multiples of 50 for τ .

E b|
|

= 1 and D = 0.1 for 0

τ

200

≤

≤

20

40

60

80

120

140

160

180

200

100
τ

Fig. 6. Numerical front velocity (solid line) as a function of time, compared to the theoretical asymptotic
front velocity v∗ = 1.3863

grid. After an initial growth until time τ
constant velocity to the right in the direction opposite to the background ﬁeld.

25, an ionization front emerges that moves with about

≈

The front velocity as a function of time is plotted in Fig. 6. It is derived from the numerical dis-
placement of the level σf = 10−8 within a time interval of 10. The front decelerates and eventually
approaches a value somewhat below the asymptotic front velocity [12]

v∗ =

E b|
|

+ 2

D

E b|
|

e−1/|Eb|

(5.6)

q
which for these particular values of the background electric ﬁeld and the diﬀusion coeﬃcient is equal
to 1.3836. The numerical velocity at large times is around 1.365 which corresponds within an error
margin of 1.5% to the asymtpotic value. We expect to obtain even better results on ﬁner grids, but
we focus in what follows on the performance of the reﬁnement algorithm compared to this uniform
grid computation. For further discussion of the results we refer to Appendix B.

In the following illustrations we have computed the temporal evolution of the densities and the electric
ﬁeld on a ﬁne and on a coarse uniform grid as well as on locally reﬁned grids. The reﬁnement algorithm
for the continuity equations is as explained in Sect. 4.3. To demonstrate that the leading edge has

z

z

z

22

50

100

150

200

250

300

350

0.2

0.15

σ

0.1

0.05

0

0

0.2

0.15

0.05

0

0

σ

0.1

50

100

150

200

250

300

350

τ

Fig. 7. Performance of the reﬁnements without and with inclusion of the leading edge. Plotted is σ(z, τ )
as a function of z for τ = 200. Upper row: results on grids reﬁned with the standard criterion with a
tolerance of 10−3 (circles) and 10−8 (pluses) compared to a ﬁne grid computation (∆z = 1
4 , thick solid
line) and a coarse grid computation (∆z = 2, thick dash dotted line). Lower row: the same, but now with
leading edge included in the reﬁnement, only shown with a tolerance of 10−3.

to be included in the reﬁnement, results with the “standard” reﬁnement (i.e. without including the
leading edge) will be compared to those that do include the leading edge. In this leading edge of
the ionization front the densities decay exponentially, but the electric ﬁeld strength is such that the
reaction term is non-negligible. From theoretical studies [12] as brieﬂy recalled in Appendix B it is
known that this region is very important since it determines the asymptotic dynamics of the front.

For the present problem we use the a priori knowledge that the front moves to the right and the
leading edge is the region ahead of the front. The standard criterion reads,

reﬁne all grid cells j where

ǫu,

u = σ, σ

ρ

−

≥

(5.7)

(cid:12)
(cid:12)
(cid:12)
Second, we use the same criterion but now with the inclusion of the so-called leading edge in the
reﬁned region, taking into account the cut-oﬀ of densities below the continuum threshold of 10−12,
i.e.:

∂2u
∂z2 (zj)
(cid:12)
(cid:12)
(cid:12)

reﬁne all grid cells j obeying criterion (5.7),

extend the reﬁned region in the propagation direction

(5.8)

to all

zj |
{

σj > 10−12

.
}

The upper and lower plot of Fig. 7 show the results of the one-dimensional streamer simulation com-
puted with the criterion 5.7 and 5.8, respectively, together with a coarse and a ﬁne uniform grid
computation. The time step is such that the Courant numbers for both advection and diﬀusion are
at most 0.1, which is suﬃciently small to render the temporal errors negligible.

23

Table 1
Front velocities vf on various grids. The reﬁnements have been carried out with ǫσ = ǫσ−ρ = 10−3. The
exact asymptotic velocity is v∗ = 1.3836. For comparison, results for the 1st-order upwind scheme on the
ﬁne grid are added.

method

uniform ∆z = 1

uniform ∆z = 1

4 , 1st-order upw.
4 , ﬂux limited
uniform ∆z = 2, ﬂux limited

standard reﬁnement

vf

1.585

1.365

1.448

1.469

reﬁnement including leading edge

1.365

The value of x0 in the initial pulse (5.1) has been chosen such that the maximum of this Gaussian
pulse was situated in a coarse grid cell center. Moreover, if a grid reﬁnement is needed at the very ﬁrst
time step, the initial condition on the ﬁner grids is not interpolated from the coarser grid values, but
is calculated directly from Eq. (5.1), so that the initial pulse on the ﬁner grids is computed without
interpolation errors.

The results with a ﬁne uniform grid can be considered as a reference solution, and it is clear that on
the coarse uniform grid the front moves too fast and is too smooth. This is due to the large amount of
numerical diﬀusion introduced by the coarse grid. As can be concluded directly from the expression
for the asymptotic front velocity, a larger diﬀusion constant leads to a larger velocity, and a larger
velocity makes the front smoother [12].

The same is observed on the grids reﬁned according to the standard criterion, even with a very strict
tolerance the front is badly captured. This also appeared with other standard reﬁnements codes, e.g.
VLUGR [34] The major conclusion from this failure is that the reﬁnement takes place at the wrong
place, namely at the regions with steep gradients. This is not where the dynamics of a pulled front
is determined. This occurs rather in the leading edge where any perturbation of the linearly unstable
state will grow [12]. Therefore the method in which the leading edge is included in the reﬁned region
gives even with a relatively low tolerance much better results than the standard reﬁnement strategy.

In Table 1 the front velocities vf are listed for the ﬁne (∆x = 1
2 ) and the coarse (∆x = 2) uniform grids,
as well as for reﬁned grids with or without inclusion of the leading edge, and with linear or quadratic
interpolation of the boundary conditions; the tolerances are ǫσ = ǫσ−ρ = 10−3. The velocities in the
table have all been determined from the displacement of the maximal electron density between τ =250
and 262.5. As explained before [12], the numerically computed front velocities should be smaller than
the theoretical value, which is indeed the case for the ﬁne grids.

We also looked at the results obtained by discretizing the advective term with a ﬁrst-order upwind
scheme. We concluded from those tests that this scheme performs very badly, quite in contrast to
what is said in [23]. The amount of numerical diﬀusion introduced by that scheme completely changes
the asymptotic velocities on realistic grids. Moreover, numerical diﬀusion can be expected to over-
stabilize the numerical scheme [32] and to suppress thereby interesting features of the solutions such
as streamer branching.

24

From these tests it appears that the grid reﬁnement based on a simple curvature monitor works well
provided the leading edge is included in the regions of reﬁnement. This is in accordance with [12]
where the importance of the leading edge for dynamics of a planar front is discussed.

6 Performance of the code on streamer propagation with axial symmetry

A planar ionization front as treated in the previous section is mainly of theoretical interest. Genuine
ionization fronts are curved around the streamer head, which leads to ﬁeld enhancement ahead of
the front. We now consider the streamer propagation with cylindrical symmetry (2D case), which
diﬀers substantially from the planar front (1D case), mainly due to the ﬁeld enhancement ahead of
a curved front. In particular, the electric ﬁeld cannot be calculated as easily as in Eq. (5.3), but has
to be computed through the Poisson equation for the electric potential. The tolerance ǫσ−ρ will play
a non-negligible role in that case. Also, as the electric ﬁeld is enhanced immediately ahead of the
ionization front and decreases further ahead, the leading edge region of maximal linear instability of
the non-ionized state is bounded.

In this section the reﬁnement algorithm as presented in Sect. 4 will be applied to a streamer initiated
by a Gaussian ionization seed situated on the axis of symmetry at the cathode, z = 0.

σ(r, z, 0) = ρ(r, z, 0) = 10−4 exp

r2 + z2
100

.

(cid:19)

−

(cid:18)

(6.1)

The computational domain is Lr=1024 and Lz=2048, and the background electric ﬁeld is set to
E b|
= 0.5. We use homogeneous Neumann boundary conditions at the cathode (z = 0), which,
|
together with the ionization seed placed on the cathode, means that electrons ﬂow into the system.
For other boundary conditions we refer to Sect. 2.3.

E b|
|

The temporal evolution of the ionization seed (6.1) under these conditions is shown in Fig. 8. Let us
ﬁrst present the temporal evolution of the ionization seed (6.1) placed on the cathode at z = 0 in a
background ﬁeld
= 0.5, on a domain with dimensions Lr = 1024 and Lz = 2048. A uniform grid
with grid size ∆r = ∆z = 1 covers the domain where both the electron and positive ion densities
are strictly positive. This is a relatively coarse grid, but, as mentioned in Sect. 4.1, the use of ﬁner
grids would require too many grid points for the Fishpak routine to handle within an acceptable
accuracy. Therefore we will use this uniform grid computation as a reference to test the performance
of the adaptive reﬁnement method. Fig. 8 shows the snapshots of the electron and net charge density
distributions as well as the electric ﬁeld, at τ = 75, 150, 225 and 300.

At τ = 75, the maximal deviation of the electric ﬁeld strength from its background value is around
0.4%, and space charges do not play a signiﬁcant role yet. This is the electron avalanche phase, during
which the Gaussian electron density distribution advects with an almost constant velocity, undergoes
a diﬀusive widening, and grows due to impact ionization, leaving behind a small trail with positive
ions [42].

At τ = 150 the space charges concentrate in a layer around the streamer head, as can be seen in
the second column of Fig. 8. Due to its curvature, this space charge layer focuses the electric ﬁeld

25

τ=150

τ=225

τ=300

0
−100 0 100
r

−100 0 100
r

−100 0 100
r

−100 0 100
r

0
−100 0 100
r

−100 0 100
r

−100 0 100
r

−100 0 100
r

τ=75

log

σ

10

400

300

200

100

z

400

σ−ρ, φ

z

300

200

100

|ε|

400

300

200

100

z

−2

−4

−6

−8

−10

−12

−3

x 10

3

2

1

0

0.505

0.5

0.495

0

−5

−10

0.2

0.1

0

1.2

1

0.8

0.6

0.4

0

−5

−10

0.3

0.2

0.1

0

1.5

1

0.5

0
−100 0 100
r

−100 0 100
r

−100 0 100
r

−100 0 100
r

Fig. 8. Propagation of a Gaussian ionization seed as given by Eq.(6.1) in a background ﬁeld
= 0.5.
The snapshots correspond to times τ =75, 150, 225 and 300. The upper row gives the logarithm of the
ρ and the lower ﬁgure the electric ﬁeld
electron density σ, the middle row the net charge density σ
E
strength
. A uniform grid ∆r = ∆z = 1 has been used for both the continuity equations and the
|
|
Poisson equation.

−

E b|
|

−2

−4

−6

−8

−10

−12

0.06

0.04

0.02

0

0.8

0.7

0.6

0.5

0.4

26

towards the axis of symmetry, thereby enhancing it. The body of the streamer is suﬃciently ionized
(and its conductivity therefore enhanced) and the electric ﬁeld in the streamer body is lower than the
background ﬁeld. The space charge layer becomes thinner and denser in time, and the electric ﬁeld is
increasingly enhanced, as can be seen in the third column of Fig. 8.

Eventually, the streamer becomes unstable, and branches. The beginning of this branching state is
shown in the rightmost column of Fig. 8.

Let us now consider the eﬀect of the reﬁnements on the streamer dynamics, as well as the eﬀect of
cutting oﬀ the densities that are below the continuum threshold. To this end, we run the simulations
with the same parameters – background ﬁeld, initial and boundary conditions – as in the previous
subsection, but we now allow one level of reﬁnement for the continuity equations, and seven levels of
reﬁnement for the Poisson equation. The ﬁnest grids in both cases have a ﬁnest mesh size ∆r = ∆z = 1.
In the next section, more levels of reﬁnement will be used. In Sect. 5 we could see that, provided the
leading edge of the streamer front is included in the reﬁnement, and a quadratic interpolation is
used to provide the boundary conditions for ﬁner grids, a tolerance for the continuity equations of
ǫσ = 10−3 is well suited. Moreover, the error in the spatial discretization of the net charge density
σ
ρ is induced by the discretization of the drift and diﬀusion terms in Eq.(2.8). Hence it is natural
to take the tolerance for the net charge density equal to that for the electron density.

−

The choice for the tolerance for the reﬁnement of the Poisson equation is less straightforward. In one
dimension, the error in the second order discretization of the Poisson equation (2.10) reads

δφ =

∆z2
12

∂4φ
∂z4 =

∆z2
12

∂2(σ

−
∂z2

ρ)

.

(6.2)

(6.3)

Therefore, in the one-dimensional case, the curvature monitor for the net charge density will also give
the error in the spatial discretization of φ. In higher dimensions however, this correspondence does
not strictly hold anymore. Nevertheless we assume that the tolerance for σ
ρ will still give a good
estimation for the error in the solution of the Poisson equation, and we therefore take

−

ǫφ = ǫσ−ρ = ǫσ = 10−3 .

The number of grid points in the r
direction contained in each ﬁne grid for the continuity equations
has be chosen as M0 = 32. The net charge density distribution at τ = 75, 150, 225 and 300 are plotted
in the upper row of Fig. 9, together with the grids on which the continuity equations have been solved.
The equipotential lines are shown together with the grid distribution for the Poisson equation in the
lower panel of Fig. 9.

−

Since the streamer front is not planar anymore, it is necessary to investigate the eﬀect of the reﬁne-
ments not only on the axis, but in the whole streamer. The evolution of the half maximum contours
of the net charge density is depicted in the left plot of Fig. 10, both in the uniform grid computation
without cut-oﬀ below the continuum threshold, and with the reﬁnements including the cut-oﬀ. There
is an excellent correspondence between the uniform grid computation and the one where all grids are
reﬁned. At some places there is a slight diﬀerence between the results, but this is also a consequence of
the results being plotted for the coarsest grid, i.e. ∆r = ∆z = 1 for uniform grid, and on ∆r = ∆z = 2
for the reﬁned grids. The grid points on which the results are plotted therefore do not coincide, and

27

the contours consequently might be slightly diﬀerent. Up to branching however, there is no signiﬁcant
error in either the radius or the width of the space charge layer. A minor eﬀect of the reﬁnement
only becomes visible once the streamer has become unstable. A more detailed investigation of this
branching will follow in a later paper.

The leftmost plot of Fig. 10 has to be completed with the evolution of the axial charge density
distribution of the streamer, in order to control not only the position of the half maximum contours,
but also the maxima themselves. This is shown in the middle and rightmost plots of Fig. 10, where the
axial charge density and electric ﬁeld strength distributions, respectively, are shown for the same times
as the leftmost plot of Fig. 10. Again it appears that the adaptive grid reﬁnement method produces
results that coincide very well with the uniform grid computation.

Finally, because of the charge conservation during an ionization event, it should be veriﬁed that
the reﬁnements are indeed mass conserving, as has been taken care of in Sect. 4.3. This is shown in
Fig.11, where we have compared a uniform grid computation where the densities below the continuum
threshold have not been cut oﬀ, with the reﬁned grid computation. It is clear that neither the cut-oﬀ,

τ=75

τ=150

τ=225

τ=300

0
−100 0 100
r

−100 0 100
r

−100 0 100
r

−100 0 100
r

Continuity
 grids

400

300

z

200

100

Poisson 
grids

2000

1500

1000

500

0

−500 0 500
r

−500 0 500
r

−500 0 500
r

−500 0 500
r

Fig. 9. Grid distributions for the continuity equations (upper row), and for the Poisson equation (lower
row). The times are the same as in Fig. 8. For the continuity grids, the black regions correspond to the
coarsest grid with ∆r = ∆z = 2, and which covers the domain on which the particle densities are above
the continuum threshold. The gray regions are covered with the ﬁne grids with ∆r = ∆z = 1. The two
coarsest grids – with ∆r = ∆z = 128 and 64 – on which the Poisson equation has been solved cover the
whole computational domain, which is ﬁlled in black. The ﬁner grids with cell size 32, 16, 8, 4 and 2 are
plotted in lighter gray shades, the white grid corresponds to ∆r = ∆z = 1.

28

600

500

400

200

100

w 

 
2r
e

z

300

600

500

400

300

200

100

0

600

500

400

300

200

100

0
−100

0
r

100

0

0.1 0.2 0.3
(σ−ρ)(0,z)

0
0

1
|ε|(0,z)

2

Fig. 10. Comparison of uniform grid results with those obtained using the grid reﬁnement strategy. Left
panel: evolution of the half maximum contours of the net charge density. Middle panel: evolution of the
net charge density on the axis of symmetry, (σ
ρ)(0, z, τ ). Right panel: evolution of the electric ﬁeld
strength on the axis of symmetry,
(0, z, τ ). The results in all panels are shown for τ = 25 to 325, with
|
steps of 25. Solid line: uniform grid (∆r = ∆z = 1), dots: grid reﬁnement (∆r = ∆z = 1, 2).

E
|

−

nor the reﬁnement disturb the total number of particles in a visible way.

The gain in memory obtained with the reﬁnement method can be observed through the number of
grid points that are used to solve the continuity equations and the Poisson equation. As can be seen
in Fig.12, the number of grid points used are one to three orders of magnitude smaller than in the
computations as performed in [14], where a uniform grid covers the whole computational domain.

We emphasize that in the previous test the choice for two levels of reﬁnements has been made in
order to compare the results with uniform grid computations. In later simulations we will use more
reﬁnement levels, thereby reaching much smaller mesh sizes. We can however extrapolate the outcome
of these tests to cases using more levels.

29

∫σdV
∫(σ−ρ)dV

10

10

5
10

0
10

0

7
10

6
10

5
10

4
10

i

s
t
n
o
p
d
i
r
g
 
f
o
 
r
e
b
m
u
n

3
10
0

50

100

150

200

250

300

350

τ

Fig. 11. Evolution of the total number of electrons (solid line) and net charge (dashed line). The lines
correspond to a uniform grid computation without cutting oﬀ the densities below the continuum threshold,
the dots to the reﬁned grid computation.

50

100

150

200

250

300

350

τ

Fig. 12. Number of grid points as a function of time. The thin dashed line represents the number of grid
points corresponding to a grid of grid size ∆r = ∆z = 1 over the whole domain, i.e. 1024
2048. The
thick lines give the temporal evolution of the number of grid points when the reﬁnement algorithm is
applied up to a ﬁnest mesh size of ∆r = ∆z = 1. Solid line: continuity equations, 1 level of reﬁnement.
Dashed line: Poisson equation, 6 levels of reﬁnement.

×

7 Accuracy requirements for the streamer simulations

To illustrate the use of the above algorithm, we present results in a new parameter regime, namely
in a very long gap with relatively low background ﬁeld, and a short gap with high ﬁeld. We present
results on diﬀerent ﬁnest mesh sizes, and investigate the convergence of the solution on decreasing
the ﬁnest mesh.

7.1 Long streamers in a low electric ﬁeld

We consider a gas gap on which a background electric ﬁeld
= 0.15 is applied. The negative
electrode (cathode) is placed at z = 0, the positive one (the anode) at a distance Lz = 216 =65 536. The
radial boundary is situated at Lr = 2(15) =32 768. For N2 at atmospheric pressure, this corresponds
approximately to an inter-electrode distance of 15 cm and an electric ﬁeld of 30 kV/cm.

E b|
|

The initial seed (2.13) is placed on the cathode at z = 0 (zb = 0). The maximal initial density is
σ0 = 1/4.7 and the e-folding radius of the seed is Rb = 10, which correspond to a density of 14 cm−3
and a radius of 23 µm, respectively, for N2 under normal conditions. This relatively dense seed enables

30

us to bypass the avalanche phase. If we would start with a single electron at this value of the electric
ﬁeld, analytical results [42] show that the transition to streamer would occur after the avalanche has
E b|
18α−1(
traveled a distance d
14 000. Using a dense seed accelerates the transition time
)
|
considerably. The dense seed mimics streamer emergence from a needle inserted into the cathode or
from a laser induced ionization seed.

≈

≈

The coarsest grid for the continuity equations has a mesh size of 64, the coarsest one for the Poisson
equation a size of 8192. We ﬁrst present the results when the ﬁnest grid has a mesh size of 2.

The upper panel of Fig. 13 shows the electron density distribution on a logarithmic scale. There are two
regions in the streamer: a rather wide one with low electron densities, and one which is much narrower
and very dense. The lower panel of Fig. 13 clearly shows the negatively charged layer and its eﬀect
on the equipotential lines. These are close to each other ahead of the streamer tip, which indicates
an enhancement of the electric ﬁeld. In the interior ﬁeld the distance between the equipotential lines
is slightly larger than outside the streamer, which implies that the ﬁeld in the streamer body is
somewhat smaller than the background ﬁeld.

Let us now compare these results with those obtained on coarser grids. We have run the simulations
on grids that were reﬁned up to mesh sizes of 4 and 8, thus the ﬁnest grids in these cases are twice
respectively four times coarser than those on which the results shown in Fig. 13 have been obtained.

Fig. 14 shows the inﬂuence of the mesh size by means of the net charge density distribution and the
electric ﬁeld. The leftmost plot of this ﬁgure shows the evolution of the half maximum contours of
the net charge density. The evolution of the density distribution and the electric ﬁeld strength are
shown in the middle and rightmost plot, respectively. Up to τ
5000 we see that the coarse grid
simulations already give convergent results. After this time, the front starts to move somewhat too
fast on this coarse grid. This is due to numerical diﬀusion. The simulation with a ﬁnest grid of mesh
size 4 gives the same results as those on a grid with size 2 up to τ
7500, after which numerical
diﬀusion again makes the front move somewhat too fast. However, the inﬂuence of the grid becomes
signiﬁcant only around τ
10000, when the streamer head becomes unstable. The eﬀect of the grid
size on the streamer instability will be considered in more detail in a future paper.

≈

≈

≈

In Fig. 15 we compare the evolution of the maximal net charge density on the axis of symmetry for
diﬀerent choices of the ﬁnest mesh size. It shows that, the coarser the grid, the more underestimated
the maximal net charge density becomes. This indicates that it is indeed numerical diﬀusion which
smears out the space charge layer, thereby accelerating it and decreasing its density.

We conclude that the simulations run on a ﬁnest grid with mesh size 8 will give non-negligible errors
in the results. However, one more level of reﬁnement, leading to a ﬁnest grid with mesh size 4,
already gives acceptable solutions during the streamer regime. Moreover, from these results, we can
extrapolate that reﬁning the grids even more (e.g. up to a ﬁnest mesh size of 1) will not lead to a
signiﬁcant correction of the results, and that the computational work required to run the simulations
on such ﬁne grids is not in proportion with the gain in accuracy.

31

τ=2500

τ=5000

τ=7500

τ=10000

1000 2000

0

1000 2000

0

1000 2000

0

1000 2000

r

r

r

r

z

5000

4000

3000

2000

1000

0
0

z

5000

4000

3000

2000

1000

0
0

1000 2000

0

1000 2000

0

1000 2000

0

1000 2000

r

r

r

r

Fig. 13. Evolution of a streamer and the computational grids in a low background electric ﬁeld
= 0.15.
Upper panel: logarithm of the electron density with the grids for the continuity equations. The coarsest
grid with mesh size 64, covering the domain on which the continuum approximation for the densities holds,
is ﬁlled in black. The ﬁnest grids with mesh size 2 are white. The particle densities in the white region
ahead of the streamer are below the continuum threshold and therefore not solved. Lower panel: net charge
density (thick lines) and equipotential lines (thin lines) together with the grids for the Poisson equation.
The white domains are covered with the ﬁnest mesh size of 2, the black regions are covered by a grid with
mesh size 64. The gray region ahead of the streamer at τ =2500 is covered by a grid with mesh size 128.
The coarser grids (with mesh sizes up to 8192) are not shown.

E b|
|

32

5000

4500

4000

3500

3000

2000

1500

1000

500

z

2500

0.025

0.02

x
a
m

0.015

0.01

0.005

)
ρ
−
σ
(

0
0

5000

4500

4000

3500

3000

2500

2000

1500

1000

500

5000

4500

4000

3500

3000

2500

2000

1500

1000

500

0

−200

0
r

200

0

0

5

10
(σ−ρ)(0,z)

15

20
−3

x 10

0
0

0.1

0.2

0.3

0.4

|ε|(0,z)

Fig. 14. Inﬂuence on the mesh size on the numerical solution for a background ﬁeld of 0.15. The left panel
shows the evolution of the half maximum contours of the net charge density σ
ρ. To show the structure
clearly, the aspect ratio is not equal. The middle and the right panels show the evolution of the net charge
density and the electric ﬁeld strength on the axis, respectively. The times shown go from 500 to 11000
with equidistant time steps of 500. The thick lines correspond to the times shown in Fig. 13. Solid line:
hf =2; dashed line: hf =4; dotted line: hf =8.

−

2000

4000

8000

10000

12000

6000
τ

Fig. 15. Temporal evolution of the maximal net charge density on the axis. Solid line: hf =2; dashed line:
hf =4; dotted line: hf =8.

33

7.2 Fine grid computations at a high electric ﬁeld

We now consider the evolution of a streamer in a short overvolted gap. The inter-electrode distance is
set to 2048, corresponding to 5 mm for N2 at atmospheric pressure. The background electric ﬁeld is
0.5ˆez, which corresponds to 100 kV/cm. The initial seed (2.13) is placed on the cathode
set to E b =
(zb = 0). The maximal density of the initial seed is set to σ0 = 10−4, and its radius to Rb = 10.

−

The evolution of the streamer with previous initial and boundary conditions, during the non-linear
phase is shown in Fig. 16. These results have been obtained on ﬁnest grids with a mesh size of 1/8
for both the continuity and the Poisson equations. The coarsest grid for the continuity equation has
a mesh size of 2, the one for the Poisson equation has a size of 128.

The discharge clearly exhibits the streamer features which are, as in the low ﬁeld case, a thin negatively
charged layer that enhances the electric ﬁeld ahead of it, and partially screens the interior of the
streamer body from the background electric ﬁeld.

In order to investigate the convergence of the solution under decreasing grid size, we have also run the
simulations on ﬁnest mesh sizes of 1/4, 1/2 and 1. Fig. 17 shows the evolution of the half maximum
contours of the net charge density, as well as that of the axial distribution of the net charge density
and the electric ﬁeld strength.

We see that up to τ = 200, a grid size of 1 gives the same results as a grid size of 1/8. After that time,
the predicted front velocity on a grid size of 1 is much faster than that on the ﬁner grids, whereas the
maximal electric ﬁeld does not diﬀer that strongly from ﬁne grid computations. This implies that the
front propagates faster because of numerical diﬀusion.

The ﬁner grids on the other hand all give similar solutions up to τ
300. After this time, the
streamer head has become unstable, and the numerical details will inﬂuence the branching behavior
of the streamer. Indeed, for hf = 1/8, the streamer exhibits two branches that propagate oﬀ-axis,
whereas for hf = 1/4 and 1/2 one branch continues propagating along the axis while the other does
not. Therefore the results at the time of branching diﬀer. An oﬀ-axis branching results in a decrease
of the maximal ﬁeld and densities on the axis, whereas an on-axis branching on the contrary results
in an increase of these quantities. This is why the maximal net charge density and ﬁeld strength on
axis are smaller in the hf = 1/8 case than in the hf = 1/4 and 1/2 cases.

≈

8 Summary and conclusions

We have presented an adaptive grid reﬁnement strategy for the computation of negative streamers
within the minimal model in a three dimensional geometry with cylindrical symmetry. The equations
are rewritten in dimensionless quantities allowing the transcription of the results to arbitrary gases
of arbitrary pressure.

The numerical discretization are based on ﬁnite volume methods. It uses a second order central scheme
for the electron diﬀusion, and a ﬂux limiting scheme for the advection, so that the numerical diﬀusion
is reduced and no spurious oscillations are introduced. The Poisson equation is discretized with a

34

τ=100

τ=200

τ=300

τ=375

0
0

100
r

200

0

200

0

200

0

100
r

100
r

100
r

200

z

300

600

500

400

200

100

600

500

400

200

100

z

300

0
0

100
r

200

0

200

0

200

0

100
r

100
r

100
r

200

Fig. 16. Evolution of a streamer and the computational grids in a high background electric ﬁeld
= 0.5.
Upper panel: logarithm of the electron density together with the grids for the continuity equations. the
coarsest grid has a mesh size of 2 and is ﬁlled in black. The ﬁnest grid has a mesh size of 1/8 and is
white. The white region surrounding the coarsest grid has not been covered by a computational grid since
the densities are below the continuum threshold there. Lower panel: net charge density (thick lines) and
equipotential lines (thin lines) together with the grids for the Poisson equation. The black region is covered
with a grid with mesh size 2, and the grids are reﬁned up to a mesh of 1/8. However, this ﬁnest grid is
only used at τ =375, in a very small part of the computational domain. The ﬁnest grid for the Poisson
equation at τ =100 has a mesh size of 1. At τ =200 and 300 the ﬁnest grid has a mesh size of 1/4.

E b|
|

35

600

500

400

200

100

600

500

400

200

100

600

500

400

200

100

z

300

z

300

z

300

0

−100

100

0
r

0

0

0.2

0.4

(σ−ρ)(0,z)

0
0

2
|ε|(0,z)

4

Fig. 17. Inﬂuence on the mesh size on the numerical solution for a background ﬁeld of 0.15. The left panel
shows the evolution of the half maximum contours of the net charge density σ
ρ. The middle and the right
panels show the evolution of the net charge density and the electric ﬁeld strength on the axis, respectively.
The times shown go from 25 to 375 with equidistant time steps of 25. The thick lines correspond to the
times shown in Fig. 13. Solid line: hf =1/8; dashed line: hf =1/4; dash-dotted line: hf =1/2, dotted line:
hf =1.

−

second order central scheme. The time stepping is achieved with an explicit two-stage Runge-Kutta
method.

The explicit time stepping method allows us to reﬁne separately the grids for the continuity equations
and those for the Poisson equation. The reﬁnement criterion of the continuity equations is based on a
curvature monitor of the solution, while that of the Poisson equation is based on an error estimation.
It results in two series of nested grids, one for the continuity and one for the Poisson equation, that
communicate with each other using adequate restrictions and prolongations of the densities and the
electric ﬁeld. The reﬁnement method has been implemented in such a way that mass, and therefore
charge, is conserved during the reﬁnements.

Tests on planar ionization fronts show that the leading edge has to be included in the reﬁnements to
capture the front velocity well. This is because the front penetrates a non-ionized high ﬁeld region
that is linearly unstable against even inﬁnitesimal electron densities; in fact, the ionization front is
a so-called pulled front whose velocity is determined in the linear leading edge region, and not in
the nonlinear high gradient region of the front. A test on a genuine streamer emerging from a small
Gaussian ionization seed in a relatively high background electric ﬁeld shows that our reﬁnement

36

including the leading edge region performs very well. The space charge layer with its steep spatial
gradients is also captured well by our reﬁnements. Moreover the requested computational memory is
three orders of magnitude smaller than in a uniform grid computation as performed in [14].

The algorithm enables us to investigate streamers with suﬃcient accuracy in new parameter regimes,
namely in larger systems and/or in higher electric ﬁelds than previously. The results show how negative
streamers increasingly enhance the ﬁeld at their tip, both in lower and in higher background ﬁelds.
The spatial gradients increase with the ﬁeld [12] and therefore require an increasing spatial accuracy.

For simulating streamers in a background electric ﬁeld as high as 0.5 in dimensionless units, we
here used grids with meshes as ﬁne as 1/8, much ﬁner than the grids with meshes of 2 and 1 used
previously [13,14]. Earlier simulations of negative streamers were carried out in a background ﬁeld of
0.25, with a grid size of at least 2 [28]. These simulations show a ﬁeld enhancement up to a value of
1, and our tests show that a ﬁner grid size is required for reliable results.

In fact, since the characteristic scale of the inner structure of the streamer front is set by the ionization
E
length α(
|max) [12,16], one should take care that the grid size is ﬁne enough to capture this length
|
scale. As a rule, we suggest that the grid size should be at least four times smaller than the ionization
length in the maximal electric ﬁeld. For the case of a background ﬁeld of 0.15, where the enhanced
ﬁeld grows up to 0.4, this implies a grid size not exceed 3 (where we used 2). For a background ﬁeld
of 0.5, the enhanced ﬁeld grows up to 2; the rule then implies that the grid size should not exceed
1/2 (where we actually used 1/4 and 1/8).

Summarizing, we now have an eﬃcient and reliable tool for simulating negative streamers within the
minimal model up to the moment of branching which will be exploited in future studies of streamer
physics. Additional eﬀects like electron attachment or photoionization are important in more complex
gases like air, in particular, for positive streamers. Such eﬀects can be implemented in continuum
approximation along the same lines.

We ﬁnish with an outlook on open problems. First, fully three-dimensional simulations are required
to follow streamer evolution after branching. We actually expect the branching time in cylindrical
symmetry to be a close upper bound for the actual branching time in the fully three-dimensional
situation [43,19]. Second, numerical solutions of our deterministic ﬂuid model show that it is actually
admissible for streamer propagation to neglect densities below the threshold of 1 particle per mm3
where the continuum approximation deﬁnitely ceases to hold; we have used this threshold on our
computations with reﬁnement. In this region which actually belongs to the leading edge of the pulled
ionization front, the discrete nature of particles should be taken into account, such work is presently
in progress.

A Appendix A: Testing the Fishpak fast Poisson solver

The Fishpak routine is used to solve the Poisson equation. It is a fast Poisson solver but has limitations
with regards to the number of grid points. We illustrate the instabilities with the Fishpak routine on
large grids by an example. Consider the Laplace equation in a radially symmetric coordinate system
(r, z)

(0, Lz),

(0, Lr)

∈

×

37

|
|

φ

e

|
|

0
10

−1

10

−2

10

−3

10

−4

10

−5

10

0
10

−2

10

|
|

φ

e

|
|

−4

10

−6

10

−8

10

1
10

single precision

1
10

2
10

3
10

4
10

||eφ||
1
||eφ||
2
||eφ||∞

||eφ||
1
||eφ||
2
||eφ||∞

double precision

2
10

3
10

4
10

Fig. A.1. The L1-errors (solid), L2-errors (dashed) and L∞-errors (dash-dotted) for φ in (A.1) on m
grids, as a function of m. Upper panel, single precision; lower panel, double precision.

×

m

1

(cid:16)

−

2φ =

r2 + (z

2 Lz)2
6A + 4A2
−
∇
1
2 Lz)2) ,
φ(r, 0) = φ(r, Lz) = e−A(r2+(z−
(cid:1)(cid:17)
∂φ
2rA e−A(r2+(z−
∂r

(0, z) = 0 ,

(Lr, z) =

∂φ
∂r

(cid:0)

−

1

2 Lz)2) ,

e−A(r2+(z−

1

2 Lz)2) ,






with Lr = Lz = 1, giving the analytical solution φ(r, z) = e−A(r2+(z−Lz/2)2).

(A.1)

The accuracy of the method can be characterized by the discrete L1, L2 and L∞-norms of the errors.
For a grid function v = (vij) on a m

m grid these norms are deﬁned as

m

Xi,j=1

×

m

v
u
u
t

Xi,j=1

v
||

||1 =

∆r∆z

,

vi,j|
|

v
||

||2 =

∆r∆z

2 ,

vi,j|
|

v
||

||∞ = max

i,j

) .
vi,j|
(
|

(A.2)

Figure A.1 shows these Lp-norms of the numerical error eφ of the results obtained with the Fishpak
routine on a (m
m)-grid, as a function of m, with A = 100. The upper and lower panel show the
error of the single respectively double precision computations. In a similar way we determined the
Lp-norms of the numerical error in the electric ﬁeld strength
|ij, computed with Eq. (3.15). They
are shown in Figure A.2.

˜E
|

×

Up to a number of grid points of approximately 2000, the errors in the electric potential are of second
order, in agreement with the discretization. The errors in the ﬁeld are also of second order, even
though, at ﬁrst sight, a ﬁrst-order behavior might be expected, since it’s the derivative of a quantity
of second order accuracy. This can be explained through an asymptotic error expansion, which, for
simplicity, will be carried in one-dimension. The second order discretization for φ will give

m

m

38

1
10

0
10

−1

10

−2

10

−3

10

−4

10

1
10

−1

10

−3

10

−5

10

|
|
ε
e

|
|

|
|
ε
e

|
|

single precision

1
10

2
10

3
10

4
10

||eε||
1
||eε||
2
||eε||∞

||eε||
1
||eε||
2
||eε||∞

double precision

1
10

2
10

3
10

4
10

Fig. A.2. The L1-errors (solid), L2-errors (dashed) and L∞-errors (dash-dotted) for
m

m grids, as a function of m. Upper panel, single precision; lower panel, double precision.
φj = φ(zj) + ∆z2v(zj ) + O(∆z4) ,

×

|

E
|

in Eq. (A.1) on

(A.3)

with a principal error function v which will be smooth if the solution φ is so. By considering local
truncation errors it is seen that v should satisfy ∂zzv = ∂4
z φ/12 with corresponding homogeneous
boundary conditions. Then the discretized value of the ﬁeld at the cell boundary becomes:

(A.4)

(A.5)

=

1
2

Ej+

φj−1

φj −
∆z

=

φ(zj)

φ(zj+1)

−
∆z

+ ∆z(v(zj )

v(zj+1)) + O(∆z3),

−

which, using a Taylor expansion around zj+

, yields

1
2

1
2

Ej+

=

−

∂zφ(zj+

1
2

) + O(∆z2)

∆z2∂zv(zj ) + O(∆z3) =

−

(zj+

1
2

E

) + O(∆z2)

It is clear that the performance of the Fishpak routine decreases dramatically when more than ap-
proximately 2000 grid points (in double precision)are used. We note that these numerical instabilities
mz grid if either mr or mz are larger than 2000, approximately, in double
also show up on a mr ×
precision.

B Appendix B: An upper bound for the planar front velocity

The asymptotic velocity (5.6) and the convergence towards it can be derived analytically, following
arguments in [25]. First, the analysis in [12] shows that a negative streamer front is a pulled front
whose dynamics is determined in the leading edge. Linearizing the one-dimensional streamer equations
Eb < 0 ahead of the front gives
in the leading edge around the ﬁeld

m

m

39

∂σ
∂τ

=

∂σ
∂z

Eb

+ D

∂2σ
∂z2 + σf (

) ,

|Eb|

) =

|Eb|

where f (
). As the nonlinear front region has to be “pulled along” by the
evolution of the linear perturbations, the evolution of the linearized equation (B.1) yields an upper
bound for the velocity at each instant of time.

|Eb|

|Eb|

exp(

1/

−

For an initial condition of Gaussian form

σ(z, 0) = σ0 exp

(z

zb)2

−
R2
b

,

(cid:19)

−

(cid:18)

as used in the paper, the linearized equation (B.1) is solved through

σ(z, τ ) = σ0 exp

f (

Eb)τ

(cid:16)

(cid:17)

R2
b
b + 4Dτ

R2

s

exp

−

(cid:18)

(z

Ebτ )2

zb +
b + 4Dτ

−
R2

(cid:19)

for all times τ

0. Solving this equaton for z, the position zf (τ ) of a ﬁxed electron density level σf is

≥

σ (zf (τ ), τ ) = σf ,

z±
f (τ ) = zb +

τ
|Eb|

±

R2

b + 4Dτ

f (

)τ

|Eb|

−

ln

s

τ ≫1
−→

zb +

|Eb| ±

(cid:16)

4D f (

)
|Eb|

τ + O

√τ

.

(cid:17)

(cid:0)

(cid:1)

q

p

σf
σ0 −

1
2

ln

R2

b + 4Dτ
R2
b

For the pulled front moving to the right, we need z+

f (τ ). The velocity of the level σf is

f (τ ) = ∂τ z+
vlin

f (τ ).

This equation determines the asymptotic velocity (5.6) that is actually independent of the parameters
σ0, Rb and zb of the initial conditions. Moreover the time dependent velocity vlin
f (τ ) is an upper bound
for the actual velocity vf (τ ) of the full nonlinear problem. The two velocities are compared in Fig. 6.

(B.1)

(B.2)

(B.3)

(B.4)

(B.5)

(B.6)

(B.7)

40

References

[1] E. Bazelyan, Y. Raizer, Lightning Physics and Lightning Protection, Institute of Physics

Publishing, Bristol, U.K., 2000.

[2] R. Franz, R. Nemzek, J. Winckler, Television image of a large upward electrical discharge above

a thunderstorm system, Science 249 (1990) 48–51.

[3] D. Sentman, E. Wescott, D. Osborne, M. Heavner, Preliminary results from the Sprites94

campaign: Red sprites, Geophys. Res. Lett. 22 (1995) 1205–1209.

[4] E. Gerken, U. Inan, C. Barrington-Leigh, Telescopic imaging of sprites, Geophys. Res. Lett. 27

(2000) 2637.

[5] V. Pasko, M. Stanley, J. Mathews, U. Inan, T. Wood, Electrical discharge from a thundercloud

top to the lower ionosphere, Nature 416 (2002) 152–154.

[6] J. Clements, A. Mizuno, W. Finney, R. Davis, Combined removal of SO2, NOx, and ﬂy ash from
simulated ﬂue gas using pulsed streamer corona, IEEE Trans. Ind. Appl. 25 (1989) 62–69.

[7] E. van Veldhuizen, Electrical Discharges for Environmental Purposes: Fundamentals and

Applications, Nova Science Publishers, 2000.

[8] M. Sato, T. Ohgiyama, J. Clements, Formation of chemical species and their eﬀects on
microorganisms using a pulsed high voltage discharge in water, IEEE Trans. Ind. Appl. 32 (1996)
106–112.

[9] A. Abou-Ghazala, S. Katsuki, K. Schoenbach, F. Dobbs, K. Moreira, Bacterial decontamination
of water by means of pulsed-corona discharges, IEEE Trans. Plasma Sci. 30 (2002) 1449–1453.

[10] S. Nair, A. Pemen, K. Yan, E. van Heesch, K. Ptasinki, A. Drinkenburg, A high temperature
pulsed corona plasma system for tar removal from biomass derived fuel gas, J. Electrostatics
61 (2) (2004) 117–127.

[11] J. Boeuf, Y. Lagmich, L. Pitchford, Electrohydrodynamic force and aerodynamic ﬂow acceleration
in surface dielectric barrier discharges, in: Proc. XXVII Int. Conf. Phen. Ion. Gases, Veldhoven,
The Netherlands, 2005.

[12] U. Ebert, W. van Saarloos, C. Caroli, Propagation and structure of planar streamer fronts,

Phys. Rev. E 55 (1997) 1530–1549.

[13] M. Array´as, U. Ebert, W. Hundsdorfer, Spontaneous branching of anode-directed streamers

between planar electrodes, Phys. Rev. Lett. 88 (2002) 174502(1–4).

[14] A. Rocco, U. Ebert, W. Hundsdorfer, Branching of negative streamers in free ﬂight, Phys. Rev. E

66 (2002) 035102(1–4).

[15] N. Liu, V. Pasko, Eﬀects of photoionization on propagation and branching of positive and negative

streamers in sprites, J. Geophys. Res 109 (2004) A04301(1–17).

[16] M. Array´as, U. Ebert, Stability of negative ionization fronts: Regularization by electric screening?,

Phys. Rev. E 69 (2004) 036214(1–10).

41

[17] B. Meulenbroek, A. Rocco, U. Ebert, Streamer branching rationalized by conformal mapping

techniques, Phys. Rev. E 69 (2004) 067402(1–4).

[18] B. Meulenbroek, U. Ebert, L. Sch¨afer, Regularization of moving boundaries in a Laplacian ﬁeld
by a mixed Dirichlet-Neumann boundary condition – exact results, Phys. Rev. Lett. 95 (2005)
195004.

[19] U. Ebert, C. Montijn, T. Briels, W. Hundsdorfer, B. Meulenbroek, A. Rocco, E. van Veldhuizen,

The multiscale nature of streamers, submitted to Plasma Sources Sci. Technol.

[20] A. Kulikovsky, The role of the absorption length of photoionizing radiation in streamer dynamics
in weak ﬁelds: a characteristic scale of ionization domain, J. Phys. D: Appl. Phys. 33 (2000)
L5–L7.

[21] S. Pancheshnyi, S. Starikovskaia, A. Starikovskii, Role of photoionization processes in propagation

of cathode-directed streamer, J. Phys. D: Appl. Phys. 34 (2001) 105–115.

[22] A. Kulikovsky, Comment on “Spontaneous branching of anode-directed streamers between planar

electrodes”, Phys. Rev. Lett. 89 (2002) 229401.

[23] S. Pancheshnyi, A. Starikovskii, Two-dimensional numerical modeling of the cathode-directed
streamer development in a long gap at high voltage, J. Phys. D: Appl. Phys. 36 (2003) 2683–
2691.

[24] J.-B. Liu, P. Ronney, M. Gundersen, Premixed ﬂame ignition by transient plasma discharges, in:

Proc. 29th Int. Symp. on Combustion, Sapporo, Japan, 2002.

[25] U. Ebert, W. van Saarloos, Front propagation into unstable states: universal algebraic convergence

towards uniformly translating pulled fronts, Physica D 146 (2000) 1–99.

[26] S. Dhali, P. Williams, Two-dimensional studies of streamers in gases, J. Appl. Phys 62 (1987)

4696–4706.

[27] Y. Raizer, Gas Discharge Physics, Springer, Berlin, 1991.

[28] P. Vitello, B. Penetrante, J. Bardsley, Simulation of negative-streamer dynamics in nitrogen,

Phys. Rev. E 49 (1994) 5574–5598.

[29] J. Dutton, A survey of electron swarm data, J. Phys. Chem. Ref. Data 4 (1975) 664.

[30] E. van Veldhuizen, P. Kemps, W. Rutgers, Streamer branching under inﬂuence of the power

supply, IEEE Trans. Plasma Sci. 30 (2002) 162–163.

[31] Y. Bobrov, Y. Yurghelenas, Application of high-resolution schemes in the modeling of ionization

waves in gas discharges, Comp. Math. and Math. Physics 38 (1998) 1652–1661.

[32] W. Hundsdorfer, J. Verwer, Numerical Solution of Time-Dependent Advection-Diﬀusion-Reaction

Equations, Vol. 33 of Series in Comp. Math., Springer, Berlin, 2003.

[33] M. Barnes, T. Colter, M. Elta, Large-signal time-domain modeling of low-pressure rf glow

discharges, J. Appl. Phys. 61 (1986) 81–89.

[34] J. Blom, R. Trompert, J. Verwer, Algorithm 758: VLUGR2: A vectorizable adaptive grid solver

for PDEs in 2D, ACM Trans. Math. Softw. 22 (1996) 302–328.

42

[35] S. Gottlieb, C.-W. Shu, E. Tadmor, Strong stability-preserving high-order time discretization

methods, SIAM Review 43 (2001) 89–112.

[36] P. Wesseling, Principles of Computational Fluid Dynamics, Vol. 29 of Series in Comp. Math.,

Springer, Berlin, 2001.

[37] U. Schumann, R. Sweet, A direct method for the solution of Poisson’s equation with neumann
boundary conditions on a staggered grid of arbitrary size, J. Comp. Phys 20 (1976) 171–182.

[38] R. Trompert, J. Verwer, A static-regridding method for two-dimensional parabolic partial

diﬀerential equations, Appl. Numer. Math. 8 (1991) 65–90.

[39] J. Wackers, A nested-grid ﬁnite-diﬀerence Poisson solver for concentrated source terms, J. Comp.

Appl. Math. 180 (2005) 1–12.

1996.

[40] G. Golub, C. van Loan, Matrix Computations, 3rd Edition, John Hopkins Univ. Press, Baltimore,

[41] E. Botta, K. Dekker, Y. Notay, A. van der Ploeg, C. Vuik, F. Wubs, P. de Zeeuw, How fast the

Laplace equation was solved in 1995, Appl. Num. Math. 24 (1997) 439–455.

[42] C. Montijn, U. Ebert, Avalanche to streamer transition in homogeneous ﬁelds, Tech. Rep. MAS-

E0515, CWI,
http://www.cwi.nl/ftp/CWIreports/MAS/MAS-E0515.pdf,
http://www.arxiv.org/pdf/physics/0508109 (2005).

[43] U. Ebert, W. Hundsdorfer, Reply to the comment of A.A. Kulikovsky [22] on “Spontaneous
branching of anode-directed streamers between planar electrodes”, Phys. Rev. Lett. 89 (2002)
229402.

43

Contents

Introduction

1

2

Hydrodynamic approximation for the ionized channel

2.1 Drift, diﬀusion and ionization in a gas

2.2 Dimensional analysis

2.3 Geometry and boundary conditions

3

Numerical discretizations

3.1 Spatial discretization of the continuity equations

3.2 Spatial discretization of the Poisson equation

3.3 Temporal discretization

3.4 Remarks on alternative discretizations

4

The adaptive reﬁnement procedure

4.1 The limitations of the uniform grid approach

4.2 General structure of the locally uniform reﬁned grids

4.3 Reﬁnement scheme for the continuity equation

4.4 Reﬁnement scheme for the Poisson equation

4.5 Overall algorithm

Tests of the algorithm on a planar ionization front

5

6

7

8

A

B

Performance of the code on streamer propagation with axial symmetry

Accuracy requirements for the streamer simulations

7.1 Long streamers in a low electric ﬁeld

7.2 Fine grid computations at a high electric ﬁeld

Summary and conclusions

Appendix A: Testing the Fishpak fast Poisson solver

Appendix B: An upper bound for the planar front velocity

44

2

3

3

4

5

6

7

8

9

11

12

12

13

14

18

20

21

25

30

30

34

34

37

39

References

41

45

