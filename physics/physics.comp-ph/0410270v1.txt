Electromagnetic Pulse Propagation in Passive
Media by the Lanczos Method

Andrei G. BORISOV a,c,1

and Sergei V. SHABANOV b,c,2

a Laboratoire des Collisions Atomiques et Mol´eculaires,
UMR CNRS-Universit´e Paris-Sud 8625, Bˆat. 351,
Universit´e Paris-Sud, 91405 Orsay CEDEX, France
b Department of Mathematics, University of Florida, Gainesville,
FL 32611, USA
c Donostia International Physics Center (DIPC), P. Manuel de
Lardizabal 4, 20018 San Sebasti´an, Spain

Abstract

Maxwell’s equations are cast in the form of the Schr¨odinger equation. The Lanc-
zos propagation method is used in combination with the fast Fourier pseudospectral
method to solve the initial value problem. As a result, a time-domain, unconditionally
stable, and highly eﬃcient numerical algorithm is obtained for the propagation and
scattering of broad-band electromagnetic pulses in dispersive and absorbing media. As
compared to conventional ﬁnite-diﬀerence time-domain methods, an important advan-
tage of the proposed algorithm is a dynamical control of accuracy: Variable time steps
or variable computational costs per time step with error control are possible. The
method is illustrated with numerical simulations of extraordinary transmission and
reﬂection in metal and dielectric gratings with rectangular and cylindrical geometry.

Keywords: Lanczos algorithm; Maxwell’s equations; time-domain algorithms; pseudospec-

tral methods; gratings

1 borisov@lcam.u-psud.fr

2 shabanov@phys.uﬂ.edu

4
0
0
2
 
t
c
O
 
8
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
0
7
2
0
1
4
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

I

Introduction

Recent developments in photonics and nanostructure materials [1, 2] have increased inter-
est in eﬃcient and accurate algorithms for numerical simulations of the propagation and
scattering of short (broad band) laser pulses in generic passive (dispersive and absorbing)
media. Time-domain approaches for solving the Maxwell’s equations might be more suit-
able for this purpose than frequency domain methods because the sought-for information,
e.g., the scattering matrix, can be obtained within a desired frequency range by a single
propagation. Coupled with laser ellipsometry of broad band pulses, fast simulations of ex-
pected resonance patterns in the scattering amplitude appear to be an eﬃcient tool to control
quality of manufactured photonic devices. Unconditionally stable algorithms are especially
advantageous for such tasks because of their applicability to practically all materials and
geometries without any assessment of admissible values of the system parameters. Another
attractive property of time domain methods is their universality. The very same algorithms
can be used to calculate static properties of the system (e.g., a band structure of photonic
crystals), to simulate the electromagnetic pulse propagation in non-linear materials as well
as in media with time-dependent properties.

The advantages of time-domain methods have been for a long time recognized in quantum
mechanics where they are extensively used in the ﬁelds of chemical reaction dynamics[3], laser
- matter interactions [4], etc. Highly eﬃcient and accurate tools have been developed for the
wave packet propagation and analysis of the results [3, 5, 6, 7, 8, 9]. Since Maxwell’s equations
can be cast in the form of the Schr¨odinger equation, it is then natural to extend time-
domain methods of quantum mechanics to numerical electrodynamics. Some realizations
of this idea are rooted to the path integral representation of quantum theory (the Lie-
Trotter product formula [10] or the split operator method [5, 11, 12]). The others exploit
polynomial approximations of the fundamental solution of the Sch¨odinger equation. For
instance, the Chebychev time-propagation technique has been recently used to simulate the
electromagnetic pulse propagation in non-absorbing media [13, 14].

Here it is proposed to use the Lanczos algorithm [15] to obtain an unconditionally stable,
time-domain solver of Maxwell’s equations for passive media. The method allows for a
dynamical control of accuracy, meaning that computational costs are constantly optimized
in due course of simulations with error control. In brief, the approach can be summarized
as follows. Maxwell’s equations are written in the form of the Schr¨odinger equation which is
then solved by the Lanczos propagation scheme [16, 5] (Section II). The diﬀerence with the
well studied quantum mechanical case is that the wave function is a multi-dimensional vector
ﬁeld and the Hamiltonian is non-Hermitian for absorbing media. The split operator method
[5, 11, 12] has been used to include attenuation into the Lanczos propagation scheme, while
preserving its unconditional stability (Section III). The action of the Hamiltonian on the
wave function is computed by means of the Fourier pseudospectral method introduced in
[17].

The accuracy of the method is investigated in Section IV. In Section V the Lanczos
propagation scheme is applied to various gratings. In particular, a resonant extraordinary

2

reﬂection of a periodic array of parallel dielectric cylinders is observed. This eﬀect is similar to
the Wood anomalies [18] and related to the existence of stationary (trapped) electromagnetic
waves with wave vectors parallel to the discrete translation symmetry axis of the system.
Simulations of the scattering of broad band pulses on metallic grating and grooves, whose
dielectric properties are described by the Drude model, are performed to demonstrate that
the Lanczos propagation scheme is able to reproduce the results known in the literature
and obtained by diﬀerent means (by ﬁnite diﬀerencing schemes or by the scattering matrix
method).

II The Lanczos method for Maxwell’s equations

Consider ﬁrst the case of non-dispersive media. Let D and B be electric and magnetic
inductions, respectively, and E and H the corresponding ﬁelds so that D = εE and B = µH
where ε and µ are positive, symmetric, position dependent matrices for generic non-isotropic
and non-homogeneous media. For isotropic media, ε and µ are scalars. At interfaces of
diﬀerent media, the boundary conditions are enforced dynamically, that is, ε and µ are
allowed to have discontinuities. Maxwell’s equations are rewritten as:

i ˙ψ = Hψ ,

ψ =

, H =

E
H (cid:19)

(cid:18)

0
−icµ−1∇×

(cid:18)

icε−1∇×
0

.

(cid:19)

(2.1)

The over-dot denotes the time derivative, and c is the speed of light in the vacuum. One can
also use the electromagnetic inductions as independent variables instead of the ﬁelds. The
Hamiltonian H must then be modiﬁed accordingly. The initial value problem is solved by
applying the evolution operator (or the fundamental solution) to the initial wave function

ψ(t) = e−iHtψ(0) .

(2.2)

(2.3)

The Hamiltonian is a Hermitian operator, H† = H, with respect to the measure scalar
product

(ψ1, ψ2) =

(D1 · E2 + B1 · H2) dr ≡

Z

ψ†

1κψ2 dr .

Z

The symmetric positive matrix κ is block-diagonal, with the blocks being ε and µ. The
norm of the wave function with respect to the scalar product (2.3) is proportional to the
electromagnetic energy and is conserved because the evolution operator is unitary.

In numerical simulations, the Hilbert space is projected onto a ﬁnite dimensional Eu-
clidean space so that ψ becomes a vector whose components are values of the wave function
at sites of a ﬁnite spatial grid. In the grid representation, H is a matrix. If the Hamiltonian
is Hermitian, it is then convenient to have H as an explicitly Hermitian matrix.
In the
Maxwell theory, this can be achieved if, before projecting onto the grid, the wave function
and the Hamiltonian are scaled

ψ → κ−1/2ψ , H → κ−1/2Hκ1/2 .

(2.4)

3

In the representation (2.1) we have

E → ε−1/2E, H → µ−1/2H, H →

0
−icµ−1/2∇×ε−1/2

(cid:18)

icε−1/2∇×µ−1/2
0

.

(cid:19)

(2.5)

The scaled Hamiltonian is Hermitian with respect to the conventional scalar product in the
space of square integrable functions, and, hence, it is a Hermitian matrix, when projected
onto the grid. The action of spatial derivatives is calculated within the pseudospectral
approach based on the Fourier grid representation of the wavefunction and the fast Fourier
transform. In what follows, only consecutive actions of H on wave functions are required.

A direct use of (2.2) implies a diagonalization of H, which is not feasible if the matrix
size is too large. Various numerical approximations are based on the semigroup property of
the evolution operator

ψ(t + ∆t) = e−i∆tHψ(t) .

(2.6)

In a local propagation scheme the exponential can be approximated by a polynomial for a
suﬃciently small time step ∆t. The basic idea of the Lanczos propagation method is that the
exact solution ψ(t + ∆t) is projected onto the Krylov subspace associated with the initial
state ψ(t) and the Hamiltonian, ψ(t + ∆t) → ψ(n)(t + ∆t) ≡ Pnψ(t + ∆t) ∈ Kn, where
P †

n= P n, P 2

n= P n, and

Kn = Span

ψ(t), Hψ(t), ..., Hn−1ψ(t)

.

(cid:0)

(cid:1)

The accuracy of such an approximation is O(∆tn). The Hamiltonian is projected accordingly,
H → H(n) ≡ PnHPn. Thus,

ψ(t + ∆t) ≈ ψ(n)(t + ∆t) = e−i∆tH(n)

ψ(n)(t) .

(2.7)

The projection is done via an orthonormal basis for Kn which is constructed by means
In this basis, the matrix H(n) is Hermitian and
of the Lanczos recursion algorithm [15].
tridiagonal. Typically, just a few orders are suﬃcient (n ≤ 9) so that n is much smaller than
the dimension of H and the matrix H(n) can easily be diagonalized. The dimension n may
be set diﬀerently at each time step, depending on the current vector ψ(t), and is determined
by a pre-set required accuracy. In particular, it allows to avoid excessive actions of H on the
wave function. This feature leads to a dynamical optimization of computational costs with
error control, which is one the greatest advantages of the Lanczos method.

A detailed discussion of the Lanczos recursion algorithm and its application to the wave
packet propagation can be found elsewhere [16, 5]. Here only a brief summary is given with
notations used later in the text. Let ψ0 = ψ(t) where ψ(t) is assumed to be normalized so
that kψ0k = 1. Due to the linearity of the Schr¨odinger equation one can always scale ψ0 by
a number and rescale it back after applying the inﬁnitesimal evolution operator. Deﬁne

α0 = (ψ0, Hψ0) ,
φ1 = (H − α0)ψ0 ,
ψ1 = φ1/kφ1k .

4

(2.8)
(2.9)
(2.10)

By construction, ψ1 and ψ0 are orthonormal. For k = 2, 3, ..., n − 1 the rest of the basis for
Kn is generated by the recursion relation

αk−1 = (ψk−1, Hψk−1) ,
βk−2 = (ψk−2, Hψk−1) ,

φk = (H − αk−1)ψk−1 − βk−2ψk−2 ,
ψk = φk/kφkk .

(2.11)
(2.12)
(2.13)
(2.14)

By construction, the vector Hψj is a linear combination of ψj−1, ψj, and ψj+1. Hence, in
the Lanczos basis the matrix H(n)
ij = (ψi, Hψj) is tridiagonal. Elementary calculations show
that the diagonal elements are H(n)
jj = αj = ¯αj, the upper and lower superdiagonals are
j−1j = βj = ¯βj.
H(n)

jj+1 = H(n)

Let U be a unitary transformation such that U †H(n)U is a diagonal matrix, and Ej be
eigenvalues of H(n). The approximate solution (2.7) is obtained by expanding the wave
function over the Lanczos basis and solving the Sch¨odinger equation for the expansion coef-
ﬁcients:

ψ(n)(t + ∆t) =

¯Ujk e−i∆tEj Uj0 ψk ≡

ck(∆t)ψk ,

(2.15)

n−1

Xk,j=0

n−1

Xk=0

where the initial condition ck(0) = δk0 has been taken into account. Since H(n) is Hermitian,
the evolution preserves the norm

kψ(n)(t + ∆t)k2 = kψ(n)(t)k2 = kψ0k2 = 1 .
Thus, the algorithm is unconditionally stable because the norm of the ampliﬁcation matrix
G(n)(∆t), deﬁned by ψ(n)(t + ∆t) = G(n)(∆t)ψ(t), is uniformly bounded, kG(n)(t)k ≤ 1, for
all parameters of the Hamiltonian and ∆t ≥ 0.

(2.16)

The accuracy of the algorithm can be estimated from the following observation [16]. The
norm of a projection of the exact solution onto the orthogonal complement of Kn can be
used as a measure of accuracy of the Lanczos algorithm. By expanding the exponential in
the right hand side of (2.6) into the Taylor series, it is clear that the contribution of the term
(∆tH)n+1ψ(t), which has no projection onto Kn, can only be captured by the approximate
solution if the larger Krylov space Kn+2 is used in the Lanczos algorithm, which, in turn,
implies that the vector cj(∆t) acquires two additional components. Thus, the accuracy of
the Lanczos algorithm can be controlled, for example, by demanding that the absolute value
of cn−1(∆t) is less than a speciﬁed small number ǫ. Note that |cn−1(∆t)| ∼ O(∆tn−2) as one
can deduce from (2.15) and the tridiagonal structure of H(n) in the Lanzcos basis. To ensure
that the norm of the projection of ψ(t + ∆t) onto the orthogonal complement of Kn is small,
we demand that

|cn−3(∆t)|2 + |cn−2(∆t)|2 + |cn−1(∆t)|2 ≤ ǫ
(2.17)
where ǫ ∼ 10−14 in our calculations. To satisfy (2.17), the time step ∆t, or the dimension of
the Krylov subspace n, or both can be varied to minimize computational costs. This is the
aforementioned dynamical control of accuracy in the Lanczos propagation method. In our
simulations, ∆t has been kept ﬁxed, while (2.17) has been used to determine a minimal n
for each time step.

5

III

Including attenuation by the split method

The response function of a passive medium in an applied electromagnetic ﬁeld must satisfy
the causality condition. A common way to model the causal response function is to assume
that the medium polarization and magnetization satisfy a linear diﬀerential equation in time
in which a non-homogeneous term is proportional to the applied ﬁeld (for linear media). The
Maxwell’s equations in passive media appear then to be a system of (high-order) diﬀerential
equations to which numerical algorithms are applied [19, 20]. Any system of high-order
diﬀerential equations can be converted into a system of ﬁrst-order diﬀerential equations by
introducing auxiliary dynamical variables. This idea is used to convert Maxwell’s equations
for passive media into the Schr¨odinger equation (2.1) in which the wave function contains ad-
ditional components that describe dynamics of the medium polarization and magnetization.
Due to absorption the time evolution is no longer unitary.

It must be noted that absorption of the wave packet is required in numerical simulations
of scattering problems in which the pulse shape is to be computed in the asymptotic region.
Indeed, when the front edge of the pulse reaches the grid boundary, it will be reﬂected or
re-appear on the other side of the grid, depending on the boundary conditions. To avoid
an artiﬁcial interference of the scattered pulse with itself, a layer of an absorbing medium is
necessary at the grid boundary [21].

Here a simple way is proposed to include the attenuation of the wave packet amplitude
into the Lanczos method, while maintaining the unconditional stability of the algorithm.
The procedure is illustrated with the Drude model of metals.

Let H = H0 − iV where H†

0 = H0 and V † = V. The system is absorbing and, therefore,
V must be a positive semideﬁnite operator, that is, for any ψ, (ψ, Vψ) ≥ 0. This readily
follows from the condition that the norm of a solution of (2.1) cannot increase with time.
The exact time evolution (2.6) is approximated by means of the Lie-Trotter formula

ψ(t + ∆t) = e−∆tV/2e−i∆tH0e−∆tV/2ψ(t) + O(∆t3) .

(3.1)

The action of the exponential of H0 is computed by the Lanczos method as before. The
attenuation potential V typically does not involve spatial derivatives and, hence, the action
of its exponential on a wave function is far less expensive than that for H0. The norm
of any power of the ampliﬁcation matrix still remains uniformly bounded by one because
ke−∆tV/2k ≤ 1 for ∆t ≥ 0. Hence the unconditional stability is preserved.

Let us turn to the Drude model which is used in numerical simulations presented below.
Another popular model, a multi-resonance Lorenz model, can be treated similarly. Let
D = E + P and B = H. In the Drude model, the medium polarization is described by the
second order diﬀerential equation

¨P + η ˙P = ω2

pE ,

(3.2)

where η > 0 is the attenuation constant and ωp is the plasma frequency. Equation (3.2)
must be solved with zero initial conditions, P(0) = ˙P(0) = 0. Deﬁne an auxiliary ﬁeld Q

6

by ˙P = ωpQ. Rewriting the Maxwell’s equations and (3.2) in terms E, B, and Q and their
ﬁrst-order time derivatives, the Schr¨odinger equation is obtained in which

E
B
Q

ψ = 



, H = 







0
−ic∇×
iωp

ic∇× −iωp

0
0

0
−iη



.



(3.3)

The Hamiltonian is Hermitian when η = 0 (no attenuation). The attenuation potential V is
a diagonal matrix, diag (0, 0, η), that is positively semideﬁnite since η > 0.

For an absorber at the grid boundaries, a layer of a conducting medium has been used
with a position dependent conductivity σ. As the induced current in a conducting medium
has the form J = σE, the matrix V is changed to diag (−4πσ, 0, η). The function σ is
constructed according to the frequency band of the initial pulse.

IV Free space propagation. Phase and amplitude er-

rors

To illustrate the eﬃciency of the Lanczos time-propagation method, we compare it with a
widely adopted Second Order Finite Diﬀerencing (SOD, or leapfrog) propagation method
[5, 20, 22], using the simplest example of the electromagnetic pulse propagation in vacuum.
The action of the Hamiltonian on wave functions in the Lanczos and leapfrog methods are
done in the same way, that is, by the fast Fourier pseudospectral method on the same grid.

Consider a Gaussian wave packet linearly polarized along the y axis and propagating

along the z axis. The amplitude of the ﬁelds at the initial time t = 0 is given by

Ey(z) = e−z2/D2

eik0z , Hx(z) = −Ey(z) ,

(4.1)

where k0 = 5.5/D, and D determines the width of the wave packet. The carrier wave length
λ = 2π/k0 so that D = 0.875λ. We take D = 1.75 µm, or λ = 2 µm. The step of the grid
is ∆z = 0.1D. An exact solution directly follows from (4.1) Ey(z, t) = Ey(z − ct). The
wave packet propagates in the direction of positive z. With our settings the pulse duration
is about 25 f s.

Numerical solutions are obtained by the Lanczos and leapfrog algorithms for the Schr¨o-
dinger equation (2.1) in which ε = µ = 1. Recall that the leapfrog propagation scheme is
based on the third-order ﬁnite diﬀerence approximation of the time derivative

ψ(t + ∆t) = ψ(t − ∆t) − 2i∆tHψ(t) .

(4.2)

The scheme is conditionally stable, and the time step must be chosen accordingly. The
simulated electric ﬁeld is recorded by a detector placed at z = zdet = 18D. Its phase and
amplitude are compared with those of the exact solution. For a signal E(t) = E0(t)eiϕ(t),

7

where E0(t) = |E(t)|, the phase and amplitude errors are deﬁned, respectively, by

δP =

|ϕexact − ϕapprox|
ϕexact

,

δA =

|Eexact
0

− Eapprox
0
Eexact
0

|

.

(4.3)

The errors δP,A are plotted respectively in Figs 1 and 2 as functions of S = (zdet − ct) /D,
the position of the pulse center relative to the detector measured in units of D. The results
are shown for |S| ≤ 2.5 where the signal on the detector is suﬃcient. Dashed and solid lines
correspond to the leapfrog and Lanczos methods, respectively, for various settings of the
time step.

The time step for the black dashed line is a reference time step, ∆t0 ≈ 0.01 f s. If NH is
the number of elementary operations required to compute the action of the Hamiltonian on a
wave function, then the total number of operations reads N = sNHNt, where s is the number
of actions of the Hamiltonian per a time step, Nt = t/∆t is the total number of time steps.
For the leapfrog method, s = 1 for all time steps. In the Lanczos method, s = n − 1, with n
being the dimension of the Krylov space. Despite that the dynamic control of accuracy has
been activated, de facto n does not vary in due course of simulations in vacuum.

Let N = N0 for the black dashed curve. The red dashed curve is obtained by reducing
the time step, ∆t = ∆t0/2, and, hence, the total number of operations increases accordingly,
N = 2N0. In the Lanczos method, the black solid curve corresponds to ∆t = 10∆t0 and
s = 7, the blue solid curve to ∆t = 5∆t0 and s = 7, and the red one to ∆t = 2.5∆t0
and s = 6. The total number of operations is, respectively, N = 0.7N0, N = 1.4N0, and
N = 2.4N0. It is readily seen that at roughly the same number of operations, the Lanczos
algorithm has phase and amplitude errors that are less than those in the leapfrog method
by several orders of magnitude.

A few remarks are in order. There are, of course, algorithms that would be more eﬃ-
cient than the Lanczos propagation method in free space. For instance, the split propagation
method [12] essentially reproduces an exact solution and is also unconditionally stable. How-
ever, the split method would not be applicable when the Hamiltonian involves products of
operators that depend on spatial derivatives and positions. The accuracy of the leapfrog
scheme can be improved by, for example, taking into account the next term of the Taylor
expansion of ψ(t ± ∆t) in powers of ∆t in (4.2) [23],

−2i∆tHψ → −2i∆tH(1 − ∆t2H2/3)ψ .

In this case, s = 3. The method is still conditionally stable where the stability condition of
the SOD, ∆tkHk ≤ 1, changes accordingly to ∆tkH(1 − ∆t2H2/3)k ≤ 1. Even though s
has tripled, the new stability condition allows one to increase the time step by the factor of
2.1. Therefore the total number of operations increases only slightly. The accuracy of the
scheme will be of O(∆t5) which is still not as high as in the Lanczos method, O(∆tn) with
n = 8, 7 in the above examples.

Some care should be taken regarding a known drawback of the Lanczos algorithm – a
possible loss of orthogonality of basis functions due to round-oﬀ errors [15, 24]. This is why

8

the time step has to be adjusted so that only low dimensional Krylov spaces, n ≤ 9, are
invoked in contrast to the conventional use of the Lanczos method for solving linear systems.

V Applications to gratings

In this section the Lanczos propagation scheme is applied to the scattering of a broad band
wave packet on nanostructure periodic materials such as gratings and grooves. We are
particularly interested in transmission (reﬂection) properties currently being a subject of
intense research [2, 26, 27, 28]. The results obtained here are compared with those available
in the literature. The time-dependent approach allows us to underline the role played by
trapped modes or resonances in the existence of extraordinary transmittance and reﬂectance
of periodic structures. The longer lives a trapped mode, the more narrow resonance occurs
in the reﬂection and/or transmission coeﬃcient.

All systems considered here have a translation symmetry along one of the Euclidean axes,
chosen to be the y axis. The structures are periodic along the x axis with the period Dg,
and the z direction is transverse to the structure. The initial wave packet is Gaussian and
propagates along the z axis. Its spectrum is broad enough to cover the frequency range of
interest. The zero diﬀraction mode is studied for wavelengths λ ≥ Dg so that reﬂected and
transmitted beams propagate along the z-axis. As in our previous work [25] we use a change
of variables to enhance the sampling eﬃciency in the vicinity of medium interfaces so that
the boundary conditions at sharp interfaces are accurately reproduced by the Fourier-grid
pseudospectral method. A typical size of the mesh corresponds to −15Dg ≤ z ≤ 15Dg, and
−0.5Dg ≤ x ≤ 0.5Dg with, respectively, 512 and 128 knots. The frequency resolved trans-
mission and reﬂection coeﬃcients are obtained via the time-to-frequency Fourier transform
of the signal on “virtual detectors” placed at some distance in front and behind the slab
with a periodic structure [29].

V.1 Array of dielectric cylinders

The signiﬁcance of trapped modes is ﬁrst illustrated with a periodic array of non-dispersive
dielectric cylinders, the system which has not received as much attention as metal or dielectric
gratings. Consider an array of parallel, periodically positioned, dielectric cylinders in vacuum
oriented along the y axis. The radius R of cylinders is small as compared to the array period
Dg = 1.75µm. In simulations, the ratio R/Dg is taken to be 0.0857. The incident wave
packet is linearly polarized. The electric ﬁeld is oriented along the y axis, i.e., parallel to the
cylinders (the so called TM polarization). The Hamiltonian for the Lanczos scheme has the
form (2.1) where µ = 1.

In Fig. 3 the reﬂection coeﬃcient R is shown as a function of the wave length expressed
in units of Dg. In the Schr¨odinger formulation of Maxwell’s theory the norm of the wave
function is proportional to the total electromagnetic energy. Hence, for a lossless medium the

9

transmission T can simply be obtained from the energy conservation: T +R = 1. Recall that
the Lanczos propagation method preserves the norm. The solid-blue and dashed-red curves
correspond, respectively, to ε = 2 and ε = 4. As one can see the array becomes a perfect
reﬂector within a fairly narrow wavelength range centered at the resonant wavelength that is
slightly larger than the period Dg. Similar results have been obtained for dielectric grating
structures. The resonant pattern is associated with the so-called Wood anomalies [18], and
can be explained by the existence of trapped modes or guided wave resonances [25, 30]. The
widths of the resonances in the reﬂection (transmission) coeﬃcient are determined by the
lifetime of a corresponding quasi-stationary trapped mode which is a standing wave along
the x axis and is excited by the incoming wave.

The existence of trapped modes can easily be inferred from the temporal evolution of
the electromagnetic ﬁeld. Figure 4 shows the transmitted electric ﬁeld as a function of time
measured by a detector placed behind the layer of dielectric cylinders. The main transmitted
pulse is clearly visible. It has a signiﬁcant amplitude and duration about 25 f s. After the
main pulse passes the array, it leaves behind an excited quasi-stationary mode which looses its
energy by radiating almost monochromatic waves with the same amplitude, but an opposite
phase, in the transmission and reﬂection directions. The lasing eﬀect of the trapped mode
appears as exponentially dumped oscillations coming after the main signal. The exponential
decay due to a ﬁnite lifetime of the quasi-stationary state is clearly seen. By the symmetry,
the same lasing eﬀect is registered by a detector placed in front of the layer (not shown here).
A 100% reﬂection at the resonant frequency can be understood from the fact that the ﬁeld
emitted by the trapped mode in the transmission direction and the corresponding frequency
component of the initially transmitted pulse have an opposite phase, thus compensating each
other. The solid-blue and dashed-red curves correspond, respectively, to ε = 2 and ε = 4.
The radiation coming from the narrow resonance (the blue curve) has a lower amplitude and
a much longer duration. The lifetime of the trapped mode in this case is in the picosecond
range, i.e., thousand times longer than the initial pulse duration. Note that the more narrow
resonance is the less energy gets trapped from the initial pulse. This explains the amplitude
diﬀerence of the blue and red curves. Finally, the concept of trapped modes localized on
successive layers and interacting with each other provides a theoretical framework for the
light propagation in layered structures such as photonic crystal slabs [31].

V.2 Metal gratings and grooves

Metal gratings and grooves have been extensively studied in micro-wave and optical domains
[26, 27]. The purpose of this section is to show that the Lanczos propagation method can
successfully be applied to metals described by the Drude model. The Hamiltonian has the
form (3.3). The attenuation and the plasma frequency are taken to be representative for
silver: ωp = 9eV , and η = 0.1eV [26]. The grating geometry is sketched in the inset of Fig.
5. The grating period is Dg = 1.75 µm, the thickness (along the z axis) is h = 0.8 µm, and
the grating width a = 0.3 µm. The corresponding grooves are obtained by attaching a solid
metal plate on one side of the gratings so that no transmission is possible. The polarization
of the incident wave packet is such that the electric ﬁeld vector is oriented along the x axis,

10

i.e., perpendicular to the gratings (the so called TE polarization). The diﬀerence with the
non-dispersive case discussed above is the presence of attenuation. The trapped mode looses
its energy due to (non-perfect) conductivity of the metal. This leads to broadening of the
resonance.

In Fig.5 the dashed red and solid blue curves represent the transmission and reﬂection
coeﬃcients, respectively, as functions of the wavelength expressed in units of the grating
period, Dg. The resonance is again associated with the existence of a trapped stationary
wave in the grating. The transmittance does not reach 100% due to dissipative loss of energy
in the Drude metal. While for a lossless medium the sum of the reﬂection and transmission
coeﬃcients must be one, this is not the case for the Drude metal (the dashed-dotted green
curve in Fig. 5). The maximal loss of energy corresponds to the resonant wavelength. It is
easily understood because the trapped mode remains in contact with the metal much longer
than the main pulse, and, therefore, can dissipate more energy through exciting surface
electrical currents in metal. The black curve in Fig. 5 shows the reﬂectance of the grooves.
Since the light cannot be transmitted through the grooves, a resonance structure in the
reﬂection coeﬃcient is directly related to the enhanced energy loss at the wavelength of the
trapped mode. Note that as compared to the metal gratings, the resonance is broadened
and shifted to the lower frequencies (larger wavelength). The results obtained here are in a
full agreement with previous theoretical and numerical analysis [26, 27].

VI Conclusions

It has been demonstrated that the Lanczos algorithm can be used to develop a highly eﬃcient,
accurate, and unconditionally stable propagation scheme to simulate scattering of broad band
electromagnetic pulses in passive media. The accuracy and eﬃciency of the algorithm have
been illustrated with an example of the electromagnetic wave propagation in vacuum. At
the same computational costs, a signiﬁcant reduction of phase and amplitude errors has
been observed in the Lanczos propagation method as compared to the second-order ﬁnite-
diﬀerence (leapfrog) scheme.

As an example of possible applications, the Lanczos propagation method has been applied
to study resonant transmission and reﬂection of various periodic nano-structures: An array
of periodically placed parallel cylinders made of a non-dispersive dielectric material, metal-
lic gratings and grooves. The time-domain study clearly demonstrates the role played by
quasi-stationary (trapped) electromagnetic waves supported by the corresponding periodic
structure in the extraordinary transmission (reﬂection) properties of the grating. The re-
sults for metallic gratings and grooves coincide with those obtained earlier by means of other
numerical algorithms and are also in agreement with theoretical studies. The unconditional
stability of the Lanczos propagation scheme for media with attenuation has been achieved
via the split method, which reduces the accuracy. It is possible to restore the accuracy up
to the level gained for non-absorbing media. However, stability conditions require a further
study that will be reported elsewhere.

11

In summary, the Lanczos algorithm has been shown to lead to a highly accurate, eﬃcient,
and unconditionally stable time-propagation numerical solver for the Maxwell’s equations.
Variable time steps and/or variable computational costs with accuracy control are possible.
The method is applicable to various electromagnetic systems (no restrictions on the Hamil-
tonian). All these virtues are hardly available in other unconditionally stable algorithms in
numerical electrodynamics of passive media.

Acknowledgments

We acknowledge the ﬁnancial support and hospitality of Donostia International Physics
Center (DIPC). S.V.S. thanks the director of LCAM, Dr. V. Sidis, for his continued support
and kind hospitality. S.V.S. is also grateful to Dr. R. Albanese (US Air Force Brooks
Research Center, TX), Profs. J.R. Klauder and T. Olson (University of Florida) for the
support of this project.

References

[1] E. Yablonovitch, Phys. Rev. Lett. 58, 2059 (1987)

J.D. Joannopoulos, R.D. Meade, and J.N. Winn, Photonic Crystals (Princeton University
Press, Princeton, NJ, 1995)
H.J. Lezec, A. Degiron, E. Devaux, R.A. Linke, L. Martin-Moreno, F.J. Garcia-Vidal, and
T.W. Ebbesen, Science 297, 820 (2002)

[2] T.W. Ebbesen, H.J. Lezec, H.F. Ghaemi, T. Thio, and P.A. Wolﬀ, Nature (London) 391,

[3] R. E. Wyatt and Z.H. Zhang, Dynamics of Molecules and Chemical Reactions (Marcel

667 (1998)

Dekker, NY, 1996)

[4] S. Chelkowski, C. Foisy, and A.D. Bandrauk, Phys. Rev. A 57, 1176 (1998)
L. Malegat, P. Selles, and A. K. Kazansky, Phys. Rev. Lett. 85, 4450 (2000)
C. Lemell, X.-M. Tong, F. Krausz, and J. Burgd¨orfer, Phys. Rev. Lett. 90, 076403 (2003)

[5] For a review of diﬀerent propagation schemes for the time-dependent Schr¨odinger equa-
tion see: C. Leforestier, R.H. Bisseling, C. Cerjan, M.D. Feit, R. Friesner, A. Guldberg,
A. Hammerich, G. Jolicard, W. Karrlein, H.-D. Meyer, N. Lipkin, O. Roncero, and R.
Kosloﬀ, J. Comp. Physics 94, 59 (1991) and references therein.

[6] C. Cerjan, ed. Numerical Grid Methods and Their Application to Schr¨odiger’s Equa-
tion (NATO ASI Series, Series C: Mathematical and Physical Sciences, Vol. 412, Kluwer
Academic Publishers, London, 1993)

[7] M.R. Wall and D. Neuhauser, J. Chem. Phys. 102, 8011 (1995)

V.A. Mandelshtam and H.S. Taylor, Phys. Rev. Lett. 78, 3274 (1997)

12

[8] D. Neuhauser and M. Baer, J. Phys. Chem. 94, 185 (1990)

M.-C. Heitz and H.D. Meyer, J. Chem. Phys. 114, 1382 (2001)

[9] A.J.H.M. Meijer, E.M. Goldﬁeld, S.K. Gray, and G.G. Balint-Kurti, Chem. Phys. Lett.

293, 270 (1998)

[10] E. Nelson, J. Math. Phys. 5, 332 (1964)

[11] M.D. Feit, and J.A. Fleck, Jr., Appl. Opt. 17, 3990 (1978)

[12] S.V. Shabanov, Electromagnetic pulse propagation in passive media by path integral

methods, a LANL e-preprint, 2003, http://xxx.lanl.gov/abs/math.NA/0312296

[13] H. De Raedt, K. Michielsen, J.S. Kole and M.T. Figge, Phys. Rev. E 67, 056706 (2003);

IEEE Transactions on Antennas and Propagation 51, 3155 (2003)

[14] D. Neuhauser and R. Baer, J. of Theoretical and Computational Chemistry 2, 537

(2003)

[15] C.J. Lanczos, J. Res. Natl. Bur. Stand. 45, 255 (1950)

[16] T.J. Park, and J.C. Light, J. Chem. Phys. 85, 5870 (1986)

[17] D. Kosloﬀ, and R. Kosloﬀ, J. Comput. Phys. 52, 35 (1983)

[18] R.W. Wood, Phys. Rev. 48, 928 (1935)

[19] P.M. Goorjian and A. Taﬂove, Opt. Lett. 17, 180 (1992)

L. Gilles, S. C. Hagness and L. V´azquez, J. Comput. Phys. 161, 379 (2000)

[20] A. Taﬂove and S.C. Hagness, Computational Electrodynamics: The Finite-Diﬀerence

Time-Domain Method (Artech House, Norwood, MA, 2000)

[21] P.G. Petropoulos, J. Appl. Mathematics 60, 1037 (2000)

J.-L. Vay, J. Comp. Phys. 165, 511 (2000)

[22] K.S. Yee, IEEE Transactions on Antennas and Propagation 14, 302 (1966)

[23] R. Richtmyer and K. Morton, Diﬀerence methods for initial-value problems (Willey, NY,

1967)
T.W. Lee and S.C. Hagness, J. Opt. Soc. Am. B 21, 330 (2004)

[24] B.N Parlett and D.S. Scott, Math. Comput. 33, 217 (1979)

H.D. Simon, Linear Algebr. Appl. 61, 101 (1984)
W.E. Arnoldi, Q. Appl. Math. 9, 17 (1951)

[25] A.G. Borisov, and S.V. Shabanov, J. Comput. Phys. (2004) (in press)

[26] F.J. Garcia-Vidal, L. Martin-Moreno, Phys. Rev. B66, 155412 (2002)

13

[27] U. Schr¨oter and D. Heitmann, Phys. Rev. B 58, 15419 (1998)

M.M.J. Treacy, Appl. Phys. Lett. 75, 606 (1999);
J.A. Porto,F.J. Garcia-Vidal, and J.B. Pendry,Phys. Rev. Lett. 83, 2845 (1999);
Y. Takakura, Phys. Rev. Lett. 86, 5601 (2001);
M.M.J. Treacy, Phys. Rev. B 66, 195105 (2002);
Q. Cao and Ph. Lalanne, Phys. Rev. Lett. 90, 213901 (2003);
P. Lalanne, C. Sauvan, J.P. Hugonin, J.C. Rodier, and P. Chavel, Phys. Rev. B 68, 125401
(2003);
J.M. Steele, C.E. Moran, A. Lee, C.M. Aguirre, and N.J. Halas, Phys. Rev. B 68, 205103
(2003);
S. A. Darmanyan and A. V. Zayats, Phys. Rev. B 67, 035424 (2003);
F. Yang and J.R. Sambles, Phys. Rev. Lett. 89, 063901 (2002);
W.-C. Tan, T.W. Preist, and R.J. Sambles, Phys. Rev. B 62, 11134 (2000)

[28] F.J. Garcia-Vidal, H.J. Lezec, T.W. Ebbesen, and L. Martin-Moreno, Phys. Rev. Lett.

90, 213901 (2003);
P.Kramper, W. Agio, C.M. Soukoulis, A. Birner, F. M¨uller, R.B. Wehrpohn, U. G¨osele,
and V. Sandoghdar, Phys. Rev. Lett. 92, 113903 (2004);
K.J. Klein Koerkamp, S. Enoch, F.B. Segerink, N.F. van Hulst, and L. Kuipers, Phys.
Rev. Lett. 92, 182901 (2004)

[29] J. Sjakste, A.G. Borisov, J.P. Gauyacq, A.K. Kazansky, J. Phys. B: At. Mol. Phys. 37,

1593 (2004)

[30] R. Magnusson and S.S. Wang, Appl. Phys. Lett. 61, 1022 (1992);

S. Peng, G.M. Morris, Opt. Lett. 21, 549 (1996);
T. Peter, R. Br¨auer, O. Bryngdahl, Optics Communications 139, 177 (1997);
K. Koshino, Phys. Rev. B 67, 165213 (2003);
L. Pilozzi, A. D’Andera, R. Del Sole, Phys. Rev. B 54, 10763 (1996)

[31] L-S Chen, C-H Kuo, Z. Ye, Phys. Rev. E 69, 066612 (2004)

E. Chow, S.Y. Lin, S.G. Johnson, P.R. Villeneuve, J.D. Joannopoulos, J.R. Wendt, G.A.
Vawter, W. Zubrzycki, H. Hou, A. Alleman, Nature 407, 983 (2000)

14

Figure captions

Fig. 1.

The phase errors for the propagation of an electromagnetic gaussian pulse
in vacuum. Results are presented as a function of the position of the pulse center relative
to the detector, S, measured in units of the pulse width D. Dashed and solid curves cor-
respond, respectively, to the leapfrog and Lanczos propagation methods. Diﬀerent colors
represent computational costs of simulations measured as the total number of actions of the
Hamiltonian on the wave function for ﬁxed propagation time. Further details are given in
the text.

Fig. 2.

The amplitude errors for the propagation of an electromagnetic gaussian
pulse in vacuum. Results are presented as a function of the position of the pulse center
relative to the detector, S, measured in units of the pulse width D. Dashed and solid curves
correspond, respectively, to the leapfrog and Lanczos propagation methods. Diﬀerent colors
represent computational costs of simulations measured as the total number of actions of the
Hamiltonian on the wave function for ﬁxed propagation time. Further details are given in
the text.

Fig. 3

Calculated zero-order reﬂection coeﬃcient for a periodic array of dielectric
cylinders in vacuum described in the text. Results are presented as a function of the wave-
length of the incident radiation measured in units of the period Dg. The solid blue and dashed
red curves correspond, respectively, to the array of cylinders with dielectric constants ε = 2
and ε = 4.

Fig. 4

The electric ﬁeld measured by a detector placed behind the periodic layer
of dielectric cylinders. Only the ﬁeld corresponding to the zero-order transmitted wave
propagating along the z-axis is represented.
It is obtained by the Fourier analysis of the
x-coordinate dependence of the ﬁeld at the detector position. The signal is shown as a
function of time measured in femtoseconds. The solid blue and dashed red curves correspond,
respectively, to the array of cylinders with dielectric constants ε = 2 and ε = 4.

Fig. 5.

Calculated zero-order reﬂection and transmission coeﬃcients for metallic grat-
ings and groves described in the text. Results are presented as a function of the wavelength
of the incident radiation measured in units of the period Dg. The inset of the ﬁgure gives a
schematic view on the grating geometry. The black line shows the reﬂection coeﬃcient for
metallic grooves. Blue and (dashed red) line shows the reﬂection (transmission) coeﬃcient
for metallic gratings. The sum of the reﬂection and transmission coeﬃcients for metallic
gratings is shown as the dashed-dotted green curve. Its deviation from 1 represents the loss
of electromagnetic energy because of the absorption in metal.

15

This figure "Fig1.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0410270v1

This figure "Fig2.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0410270v1

This figure "Fig3.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0410270v1

This figure "Fig4.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0410270v1

This figure "Fig5.png" is available in "png"(cid:10) format from:

http://arxiv.org/ps/physics/0410270v1

