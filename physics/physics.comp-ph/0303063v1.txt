3
0
0
2
 
r
a

M
 
5
1
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
3
6
0
3
0
3
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Dynamics and Topological Aspects of a Reconstructed Two-Dimensional Foam Time
Series Using Potts Model on a Pinned Lattice

Igor F. Vasconcelos
Department of Physics, University of Notre Dame,
225 Nieuwland Science Hall, 46556-5670, Notre Dame, IN, USA

Isabelle Cantat
GMCM, U.M.R. C.N.R.S. 6626, Campus de Beaulieu, Bˆatiment 11A,
CS 74205 263, av. du G´en´eral Leclerc, 35042 Rennes Cedex, France

James A. Glazier
Department of Physics, Indiana University, Swain Hall West 159,
727 East Third Street, 47405-7105, Bloomington, IN, USA
(Dated: February 21, 2014)

We discuss a method to reconstruct an approximate two-dimensional foam structure from an
incomplete image using the extended Potts mode with a pinned lattice we introduced in a previous
paper [1]. The initial information consists of the positions of the vertices only. We locate the centers
of the bubbles using the Euclidean distance-map construction and assign at each vertex position a
continuous pinning ﬁeld with a potential falling oﬀ as 1/r. We nucleate a bubble at each center
using the extended Potts model and let the structure evolve under the constraint of scaled target
areas until the bubbles contact each other. The target area constraint and pinning centers prevent
further coarsening. We then turn the area constraint oﬀ and let the edges relax to a minimum energy
conﬁguration. The result is a reconstructed structure very close to the simulation. We repeated
this procedure for various stages of the coarsening of the same simulated foam and investigated the
simulation and reconstruction dynamics, topology and area distribution, ﬁnding that they agree to
good accuracy.

I.

INTRODUCTION

This paper addresses the reconstruction of domain
boundaries from experimental images of foams, cellular
images which consist of sets of compact domains sepa-
rated from each other by sharp boundaries which meet
at vertices. The data to be reconstructed contain only
partial information, in particular the position of vertices
in the complete image. This task, which is a special case
of the problem of image segmentation, recurs in many
domains, e.g. medical imaging and cartography [2, 3, 4].
An ISI Web of Science search reveals nearly 2000 refer-
ences on image segmentation. Even when the image data
is complete, a typical pixel image requires reconstruction
to obtain information about domain shapes, volumes and
adjacencies. In real images the presence of noise further
complicates reconstruction [5].

The general reconstruction problem is underdeter-
mined. Unless we supply further constraints, an arbi-
trary number of diﬀerent domain patterns with diﬀer-
ent numbers of domains and domain area distributions
can have the same set of vertices. However, in the case
of many domain patterns of real interest, e.g. metal-
lic polycrystals, foams and biological cells, the patterns
are well behaved in a manner which is clear to the eye,
though diﬃcult to quantify completely. For example, in
two dimensions, boundaries meet at three-fold vertices
at approximately 120◦ angles and are relatively smooth
and constant in curvature. Many of these regularities,
known as Plateau rules [6], result from the physical pro-

cesses generating the domain boundaries: the presence of
a surface tension or surface energy causes boundaries to
be approximately minimal surfaces. As a result almost
all reconstruction of three-dimensional foams has been
manual, which is extremely inconvenient and time con-
suming and greatly limits the numbers of bubbles which
we can examine [7, 8, 9, 10, 11, 12, 13].

In these cases we can proceed quite far in reconstruct-
ing the complete pattern from the vertex positions and
we present an algorithm that accomplishes this recon-
struction with accuracy good enough for many practical
purposes. The algorithm is attractive in that it uses a
physical simulation of the development of minimal sur-
faces which in some sense duplicates the original forma-
tion of the pattern. One great advantage is that it works
directly with real pixel-wise input data. We illustrate
several pathological cases where the algorithm fails and
discuss ways to ﬁx these errors.

II. MOTIVATION

Why do we need an algorithm that can recon-
struct minimal surface partitions from vertex posi-
tions? Whole subﬁelds of physics and mathemat-
ics have developed to study the structure of complex
minimal surfaces (for a review see the web site of
Kenneth Brakke and his program Surface Evolver at
http://www.susqu.edu/facstaﬀ/b/brakke/).

The division of space into subdomains with minimum

partition area has attracted attention of scientists in
ﬁelds ranging from Geography and Physics to Mathe-
matics and Computer Science [14, 15]. The more re-
stricted question of which geometric structure, replicated
inﬁnitely, ﬁlls space without leaving gaps, has minimum
surface area is known as the Kelvin Problem after Lord
Kelvin who ﬁrst proposed a solution in 1887 [16].

Dry liquid foams (i.e. foams in which the liquid frac-
tion is below about 1%) are a good probe of the various
proposed solutions to the Kelvin problem. The idealized
model of a foam retains only the surface energy (propor-
tional to the surface area) of the bubbles. Where bubbles
contact each other, they form a cell face of negligible
thickness. The bubble wall membranes bend, forming
surfaces of constant mean curvature. The faces contact
each other at edges known as Plateau borders where wa-
ter accumulates and these edges in turn meet at Plateau
vertices at the tetrahedral angle.

Foams also exhibit a complex dynamics in which gas
passes from bubbles of higher pressure to lower pressure
bubbles [17, 18]. Since smaller bubbles tend to have
higher pressures because of geometric constraints, bub-
bles gradually disappear and the pattern coarsens [17,
18]. The same general phenomena with additional com-
plications occur in metallic polycrystals, sintered ceram-
ics, ferromagnets, micelles and ferroﬂuids and biological
tissues and organs [18, 19, 20, 21]. Domain growth is a
common feature of most of these patterns, though the
time scales diﬀer depending on the diﬀusion mechanisms
controlling boundary motion. If the initial conditions are
reasonably homogeneous, most of these materials develop
geometrically similar structures [22]. Thus, understand-
ing the kinetics and geometry of a coarsening foam can
provide information on a broad class of important mate-
rials.

Unfortunately, determining the

three-dimensional
structure of a foam is surprisingly diﬃcult. Foams scatter
light extremely eﬀectively, so seeing deep inside a liquid
foam is diﬃcult [23, 24]. Optical tomography is only
possible for very dry foams, in which the Plateau bor-
ders but not the faces are visible [8, 9, 10, 11, 12, 13].
Magnetic resonance imaging (MRI) can reveal a foam’s
three-dimensional structure [25]. MRI measures the nu-
clear magnetic resonance (NMR) signal from protons in
the hydrogen in the water present in the sample. How-
ever, since foams contain very little water, which mostly
concentrates in the Plateau borders, the MRI signal is
very weak and the best result we obtain is an image of
the Plateau borders, which looks like a skeleton of the
foam as in ﬁg. 1. Recent synchrotron CT images provide
higher quality images [26], but seeing the faces between
bubbles remains eﬀectively impossible.

The raw image is missing crucial information, e.g. the
bubble volumes, because of the absence of the bubbles?
membranes. The same problem can occur in confocal
microscopy of cells, CT, MRI and ultrasound imaging
of tissues and X-ray and neutron imaging of solids. An
added diﬃculty is that the signal to noise ratio of such

2

FIG. 1: MRI image of a foam from [7].

images is often close to one.

Reconstruction of foam structure from partial informa-
tion is, then, essential to the study of cellular patterns.
The concept underlying our reconstruction is energy min-
imization, in the sense that reconstructing the pattern
is equivalent to ﬁnding the minimum energy partition
consistent with the partial information available about
the structure. Since the pattern itself results from con-
strained energy minimization, the use of an energy min-
imization method in reconstruction seems natural and
appealing. In three dimensions, this partial information
consists of a pixel image of the edges of bubbles (Plateau
borders) and the reconstruction consists of ﬁnding the
surfaces that connect the edges with minimum energy.
In two dimensions, on the other hand, the correspond-
ing partial data are the positions of the vertices of the
domains and the reconstruction connects the vertices to
obtain a minimum energy conﬁguration. Although the
results we present here concern two-dimensional recon-
struction only, the method extends to three dimensions
without major conceptual modiﬁcations.

We now summarize our method to reconstruct the two-
dimensional structure starting solely from the positions
of the vertices and our knowledge of minimal surfaces [1].
Subsequent sections provide details and results. The
method consists of three main independent steps:

•

•

Finding the center of bubbles in the pattern to be
reconstructed.

Reconstructing the pattern by nucleating a bubble
from each center using the extended large-Q Potts
model.

•

Growing the nucleated bubbles until evolution
stops.

Minimum distance maps provide the position of the cen-
ter and the initial target area (Each bubble receives
a target area which we adjust during the simulations

to achieve the minimum surface energy of each bub-
ble) [27]. A continuous pinning ﬁeld traps the moving
bubble edges.

We employ this method to reconstruct several patterns
from a foam evolution time series obtained from a coars-
ening simulation. In order to test the validity of our re-
sults, we perform a detailed analysis of the dynamics and
spatial structure of the reconstructed foam and compare
it with the simulation and theoretical and experimental
results found in the literature.

III. THE POTTS MODEL

The Potts model [28] is a generalization of the Ising
model to more than two spin components. Although
initially proposed to study critical phenomena in statis-
tical Physics, the Potts model ﬁnds a wide variety of
applications, including the simulation of metallic grain
growth [29, 30, 31], soap foams [32, 33, 34], magnetic
froths [36] and biological cells [35].

∗

We map the foam structure onto a rectangular lattice
containing Nx
Ny sites. Each lattice site contains an in-
teger σ (a spin) which corresponds to a particular bubble
(number of bubbles = number of spins). The boundary
between two bubbles is the set of links between lattice
sites associated to the spins of those bubbles. The bound-
ary energy associates a positive energy (equivalent to a
surface tension) with boundary links and zero energy for
links within bubbles.

Wejchert et al. [32] introduced an area constraint en-
ergy term to simulate equilibration in a foam, where
boundary equilibration is much faster than diﬀusion.
Coarsening has two time scales. Surface tension and vis-
cous dissipation determine the time, τ1, which describes
the relaxation of an edge toward equilibrium without vol-
ume (or area in two dimensions) variation. After a per-
turbation, the pattern returns to obeying the Plateau
rules after a delay of τ1. The second time scale, τ2, de-
pends mainly on gas permeability and foam polydisper-
sity and controls the coarsening rate. In liquid foams τ1
is typically fractions of a second while τ2 is minutes or
hours. In metal foams the two times are usually compa-
rable, as they are in the simple Potts model, so the foam
only obeys Plateau’s rules approximately. If we constrain
the area for a ﬁxed number of Monte Carlo steps (mcs)
per volume diﬀusion step we can choose any ratio we like
between the time scales. We deﬁne a Monte Carlo step
as a sequence of Nx

Ny random site selections.

The Hamiltonian including surface energy and the area

∗

constraint has the general form:

H = J

(1

δσiσj ) + λ

−

Xi,j(sites)

Xk(bubbles)

(Sk

−

St

k)2.

(1)

The ﬁrst term in eq. 1 accounts for the surface energy.
The sum in i runs over all the sites in the lattice and the
sum in j runs over sites neighboring i. The parameter J

3

sets the energy/unit surface area. The second term is the
area constraint. The sum in k runs over all the bubbles
in the pattern. λ is a parameter specifying the strength
of the area constraint, Sk the area of the kth bubble, and
St
k the target area of the same bubble. Because of the
surface energy, each bubble’s area is usually smaller than
its target area.

Most Potts simulation use Metropolis Monte Carlo dy-
namics [37] in which we select a boundary lattice site at
random and randomly propose to change its spin to the
value of one of the neighboring spins (Kawasaki dynam-
ics [38] and Glauber dynamics [39] are also possible). If
the resulting change of energy is less than or equal to
zero, we accept the new spin conﬁguration. However, if
the change in energy is positive, we accept the new con-
ﬁguration with Boltzmann probability:

P = exp

∆E
kT (cid:19)

,

(cid:18)−

(2)

where T is the temperature assigned to allows for thermal
ﬂuctuations to overcome local energy minima.

IV. GENERATION OF THE INPUT DATA

Any experimental picture of 2D foam may be used as
input data, once the vertices positions are known. Any-
way, in order to be able to compare the statistical prop-
erties of the reconstructed foam to those of the original
one, we need a controlled series of well characterised foam
structures. Thus, to develop and test our reconstruction
procedures, we generate two-dimensional foam structures
at diﬀerent stages of a coarsening evolution using the
large-Q Potts model [33].

The Hamiltonian contains the surface term only:

H = J

(1

δσiσj ).

−

Xi,j

(3)

The j sum ranges up to third-nearest neighbors, or 20
sites around the ith site. In our simulation J = 1. In
order to minimize ﬁnite size and edge eﬀects we used a
1024 square lattice with periodic boundary condi-
1024
tions. We start the simulations with 16384 square 8
8
bubbles and ﬁnish with just a few tens of bubbles.

×

×

We performed the main part of the numerical simula-
tion at T = 0. However, in order to overcome metastable
traps, we periodically increase the temperature for short
periods during the simulation. So we alternate 40 mcs
at temperature T = 0 (relaxation period) and 5 mcs at
T = 0.5 (ﬂuctuation period). This method is known to
produce very realistic foam structures [33]. Thus the fact
that both original and reconstructed structures are based
on a Potts model simulation does not bias our error es-
timations.

4

(4)

V. PINNING FIELD

Our inspiration for a continuous attractive pinning
ﬁeld to keep vertices ﬁxed comes from Zener pins [40,
41, 42, 43, 44, 45, 46], which simulate the microstruc-
tural evolution of materials in the presence of a second
phase dispersion of particles. The presence of insoluble
precipitates inhibits grain growth, greatly aﬀecting the
mechanical properties of the material.

Srolovitz et al. [41] extended the Potts model to simu-
late grain growth in the presence of a second phase par-
ticle dispersion. The model incorporates particles by as-

signing a particular spin to the lattice sites the particles
occupy. The kinetics is the regular Monte Carlo dynamics
for the Potts model. Other groups [42, 43, 44] have also
used this procedure to obtain properties including grain
size, characteristic exponents, etc. for such pinned mate-
rials. Krichevsky and Stavans [45] and Herrera et al. [46]
performed two-dimensional experiments on foam evolu-
tion in the presence of pinning centers, using a square
array of pins and randomly distributed pins respectively.
We construct a continuous attractive pinning ﬁeld
around a point size Zener pin at each vertex in the source
image, contributing a Hamiltonian term:

Hp =

γ

−

Xi,j(sites)

−

(1

δσiσj )F(xi, yi) =

γ

−

Xi,j(sites)

(1

δσiσj )

−

× (cid:18)

1
,
ri (cid:19)

where γ is a constant that determines the pinning cou-
pling strength and ri is the distance from the site i to
the closest pin. This term causes edges, and ultimately
the reconstructed vertices, to move toward and eventu-
ally trap on the pins. The ﬁeld F(x, y) has its maximum
value of 1 at the position of the pins and falls oﬀ as the
inverse of the distance (1/r). It contributes a negative
energy at each place where a link between two diﬀerent
bubbles is present (see eq. 4). Therefore, boundaries and
vertices cost less energy when located close to a pinning
center, producing an attractive pinning force on the ver-
tices.

We choose the value of γ to produce a circular region
around each center where the attraction of that center
dominates, i.e., the center will deﬁnitely attract any edge
or vertex within this circle. In our simulations, we chose
the circles’ radii to be 20 pixels, which gives a value for
the ﬁeld, at the edge of the circles, of about 0.05. With
γ = 1000, the pinning energies are strong enough to as-
sure that no edge or vertex will slip oﬀ a pin.
In the
region between two pins closer than 40 lattice sites the
closest pin will still attract it to due to the stronger pin-
ning ﬁeld in that direction. This situation becomes less
signiﬁcant when we impose the cutoﬀs discussed below.
Figure 2a shows the entire range of the pinning ﬁeld
for a particular foam conﬁguration while ﬁg. 2b shows
the same ﬁeld scaled to show the ﬁeld within 20 pixels
of the pins. The pinning ﬁeld within the circles (shown
on the top plane in ﬁg. 2b) around each pin is much
stronger than other energy components. The great ad-
vantage of this method compared to simple Zener pins
is that in the ﬁnal patterns almost all pins lie in edges.
If the nucleation algorithm has missed bubbles, then the
number of pins may be larger than the number of vertices
in the reconstructed pattern and a few pins may not cor-
respond to vertices. If the nucleation algorithm creates
extra bubbles then a few vertices may not correspond to

pins.

A drawback of this implementation is that the lattice
becomes very stiﬀ and, although the vertices pin appro-
priately, the edges are not free to relax. To overcome this
problem, we impose a cutoﬀ on the ﬁeld, after a certain
number of mcs. After the cutoﬀ, the ﬁeld still falls oﬀ
as 1/r but we limit its range to a certain radius around
each pin. This procedure keeps the vertices pinned but
frees most of the edge length from the pinning ﬁeld, al-
lowing edges to straighten in order to minimize surface
energy. We apply successively shorter range cutoﬀs until
the range of the pinning ﬁeld is about four lattice sites.
Figure 2c-d shows the ﬁeld conﬁguration after a cutoﬀ
for r = 20.

VI. RECONSTRUCTION

A. Centers of Bubbles

Our ﬁrst step is to ﬁnd the bubbles’ centers. We follow
Glantz and Prause and use a Euclidean distance map to
ﬁnd the centers [7, 27, 47, 48, 49, 50, 51, 52, 53]. We con-
struct such a map by picking a lattice site, calculating its
distance from all the vertices and storing the minimum
of these distances for that site. Repeating this procedure
for all lattice sites produces the map [53, 54, 55]. Fig-
ure 3a shows the map for a typical foam conﬁguration.
We assume that the centers of the bubbles sit on the lo-
cal maxima in the map. Figure 3b shows the positions of
the calculated centers (green) compared to the real ones
(black) obtained from center of mass calculations. The
agreement is fairly good.

This method, however, has some pathologies. Multiple
maxima may be present within a bubble. We treat this
problem by combining any two maxima that are closer

5

(a) Pinning ﬁeld for
FIG. 2:
a particular foam conﬁguration.
The spikes sit at the positions
of the vertices.
(b) The same
pinning ﬁeld scaled to show the
circle around each pin as dis-
cussed in the text. (c) and (d)
Pinning ﬁeld for the same foam
conﬁguration as in ﬁg.
3 ob-
tained after the cutoﬀ discussed
in the text. The vertical axis
corresponds to the ﬁeld value
F (x, y) in the (x, y) position in
the lattice (horizontal plane).
This foam conﬁguration was ob-
tained from the coarsening sim-
ulation after 50000 mcs.

FIG. 3: (a) Minimum distance map superimposed on the orig-
inal foam structure and the centers obtained from the max-
ima. (b) Positions of calculated centers (light dots) compared
to the positions of the real ones (dark dots). The areas of the
circles show our estimated target area for each bubble. Both
pictures correspond to the 5000 mcs coarsened foam struc-
ture.

to each other than to the closest vertex. The solution
has an intrinsic ﬂaw: when a bubble is long and thin, its
centers may be closer to neighboring bubble centers than
to the closest vertex, causing the disappearance of the
bubble. Alternatively, the centers in a stretched bubble
may be further from each other than from the nearest
edge, causing the center map to create an extra bubble.
Figure 4 illustrates these two situations. Saddle points
are another problem. The center point of an edge is a
saddle point in the Euclidean map and if the edge is long
enough, the saddle point may look like a maximum, espe-
cially because of errors resulting from lattice discretiza-
tion. An eﬀort to exclude saddle points when search-
ing for maxima may result in missing centers for small
bubbles. If the initial bubble size distribution is narrow
(bubbles are roughly the same size) and the domains are

FIG. 4: Two typical errors occuring during bubble center
determination. Bullets show the bubble centers obtained with
our modiﬁed Euclidean-distance algorithm and circles show
the actual centers. The solid lines show the boundaries of the
simulated input foam and the dotted lines the reconstructed
structure.

fairly isotropic, then no errors result. We are currently
working to quantify the consequences and thresholds of
these errors. Overall, we lose a few very small or elon-
gated bubbles. During foam coarsening, these bubbles
have a short lifetime (they disappear rapidly), so the er-
ror in many cases is quite small and has the eﬀect of
reconstructing a foam pattern that seems slightly later
in time than the source pattern.

These pathologies result from the distance algorithm,
i.e., the ﬁrst part of our method. Our main reconstruc-
tion procedure, however, is independent of the method
we use to ﬁnd the centers of bubbles which we can im-
prove or replace.

B. Nucleation

Once we have chosen a set of bubble centers we nucle-
ate a bubble with unique spin and area of one pixel at
each center and set the remaining sites to spin 0. The
spin 0 domain behaves like a big bubble which shrinks

6

(5)

while the others coarsen. The bubbles coarsen under a
target area constraint. These target areas are roughly

the areas each bubble will have at the end of coarsening.
We deﬁned the pinning ﬁeld above. The Hamiltonian is:

H =

Xi,j(sites)

J

(cid:18)

−

γ
ri (cid:19)

(1

−

δσiσj ) +

Λk(Sk

St
k)2,

−

Xk(bubbles)

where we have generalized the area constraint. The area
coupling constant Λk is:

C. Results

Λk = λ

1
St
k (cid:19)

(cid:18)

St

max,

(6)

where λ is a constant and St
max is the largest of the tar-
get areas. With a uniform Λ as in previous applications,
the area term is larger for bigger bubbles. Therefore, the
former ”swallow” the latter in order to minimize energy.
To overcome this problem, we weight the coupling con-
stant by making it inversely proportional to the bubble
target area.

To estimate the tentative target area, we used the area
of a circle centered at the bubble’s calculated center with
radius equal to the distance to the closest vertex. Fig-
ure 3b illustrates this procedure. Clearly this approxi-
mation works better for isotropic bubbles. We could also
use the average distance to the neighboring vertices or
other estimates. The geometrical element that ﬁlls two-
dimensional space with minimum surface energy is the
hexagon. The area of a hexagon that ﬁts inside a cir-
cle is about 10% smaller than the area of the circle itself.
Therefore, we use 90% of the areas of the circles in ﬁg. 3b
as the tentative target areas. The method we use to ob-
tain the tentative target areas plays only a small role, if
any, in the ﬁnal reconstruction.

To ensure that all the bubbles grow at comparable
rates, we increase their target areas in steps to their full
values. During the ﬁrst 50 mcs we set the target area
to 10% of its full value, so after 50 mcs, all the bubbles
have grown to 10% of their ﬁnal sizes. After each 50 mcs,
we increase the target areas by 10%, so the target areas
reach their full values only after 500 mcs.

After all the bubbles have achieved their ﬁnal areas and
the structure has pinned, we turn oﬀ the area constraint
and impose a cutoﬀ on the pinning ﬁeld, as discussed
above to allow the interfaces to relax, and the areas to
change, in order to obtain the lowest energy conﬁgura-
tion.

For many purposes the approximate reconstruction is
adequate. However, if we wish to measure the growth
rates of bubbles to high accuracy we are examining small
diﬀerences of large areas so even a small error in the
areas gives a large error in their growth rates. We are
developing procedures to correct the bubbles’ areas [56].

Figure 5 shows (up to 25000 mcs) the growth of bub-
bles and structures reconstructed for a simulated foam
coarsened for 50000 mcs. The last picture in the series
shows a snapshot of the simulation superimposed on the
reconstruction. Our reconstructions used the same al-
ternating temperature approach as our coarsening sim-
ulations. We set T = 1 to allow the vertices to ﬁnd
the pinning centers faster. The parameters for all re-
construction simulations were J = 1, T = 1, γ = 1000,
and λ = 0.1. We repeated the same procedure for many
diﬀerent conﬁgurations and obtained the reconstructed
foam coarsening of ﬁg. 6.

D. Analysis of Results

During nucleation and growth of bubbles, the bubbles
are at ﬁrst circular and grow at the same pace due to
the rescaling of their target areas. Eventually they im-
pinge on one another, forming interfaces and vertices.
The contact between bubbles keeps them from growing
further and both the area constraint and pins further in-
hibit global coarsening.

Once the bubbles ﬁll the lattice, their conﬁguration is
already close to the ﬁnal one. Most of the vertices have
already trapped on pinning centers and most untrapped
vertices eventually trap during the relaxation of edges
and rearrangement of areas after we turn oﬀ the target
area constraint and impose cutoﬀs on the pinning ﬁeld.
The residual pinning ﬁeld hinders further coarsening.

Although defects in the center calculation cause most
errors in the reconstructed pattern, the nucleation of
bubbles and relaxation of edges can introduce additional
imperfections. A particular vertex may ﬁx to the wrong
pin or an edge may be missing. A bubble which was origi-
nally very long and thin might receive a target area much
diﬀerent from its original area because the anisotropy
makes the nearest vertex much closer to the center than
the average distance to the vertices. Since all bubbles
nucleate as circles an edge may miss a pin during the
nucleation of a long, thin bubble leaving a pin inside the
bubble which never captures the edge. After this bubble
achieves its ﬁnal target area, it will still have to jump
over an energy barrier in order to squeeze into a long,
thin shape. A pair of stretched bubbles just before a T 1

7

FIG. 5: Growth of bubbles from their centers for the 50000 mcs coarsened foam. In the ﬁrst stages the bubbles have energetically
favorable circular shapes and grow at the same pace. Eventually they impinge on one another forming interfaces and vertices
and the vertices trap on the pinning centers (dtos). The interfaces relax and straighten after we turn oﬀ the area constraint
and cutoﬀs the range of the pinning ﬁeld. From the upper left to the lower right corner: 50, 150, 250, 350, 500, 1000, 2000,
3500, 6000, 9000, and 25000 mcs. The last picture in the series shows the original (light lines) and reconstructed (dark lines)
structures superimposed. The simulation parameters we chose are J = 1, T = 0/1 (see text), γ = 1000, and λ = 0.1.

process (topological transition where a four-fold vertex
decays into two three-fold vertices) in the original image
will almost never reconstruct properly because they are
so near the much lower energy state after the T 1 that
the reconstruction jumps over the real conﬁguration to
the lower energy conﬁguration. However, the real foam
pattern would evolve rapidly to this state so the eﬀective
error is small.

Even after a vertex pins, it may break loose. Vertices
in less energetically favorable conﬁgurations, like those
undergoing T 1s or joining edges that make angles much
smaller than 120◦, may detach from the pins despite very
strong coupling to the pinning ﬁeld. These extreme sit-
uations create loose vertices that evolve locally with the
dynamics of an unpinned foam which may complete T 1s
in progress or lead to disappearance of bubbles. As a

result, the reconstructed structure may depart slightly
from the original conﬁguration as in ﬁg. 6. Errors are
less common in more homogeneous, isotropic foams. Fig-
ure 7 shows the fraction of missing bubbles as a function
of time.

How do these deviations aﬀect the global coarsening
described in [29, 33, 57, 58]? If we characterize coarsen-
ing by ﬁtting the average area < A > per bubble as a
function of time to a power law:

< A >= ktα,

(7)

we obtain a growth exponent characterizing the coarsen-
ing. For a foam-like material, the characteristic exponent
must be α = 1 [33]. Besides the mean bubble area, the
basic measures of the state of a foam are the distribution
ρ(n) of the number of sides (the probability that a ran-

8

FIG. 6: Reconstruction (dark lines) of foam evolution during coarsening on top of the original structures (light lines). From
the upper left to the lower right corners: 6000, 8000, 10000, 14000, 22000, 26000, 32000, 38000, 42000, 44000, 46000, and 50000
mcs. For the coarsening procedure we chose J = 1, and T = 0/0.5 (see text) while for the reconstruction we chose J = 1,
T = 0/1, γ = 1000, and λ = 0.1

domly selected bubble has n sides), and the normalized
area distribution ρ(A/ < A >) (the probability that a
bubble has an area which is a given fraction of the mean
bubble area). The distributions show dynamical scaling,
i.e. they become time invariant at long times. We deﬁne
the mth moment of the side distribution as
∞

0.03 for the orig-
power law, with exponents α = 1.03
0.03
inal foam (solid line in the ﬁgure) and α = 1.01
for the reconstructed foam (dotted line). Both exponents
are consistent, within error, with the expected value of
one. Thus, the reconstructed foam has the same global
dynamics as the original and theory.

±

±

Figure 9 shows the mean deviation of the reconstructed

µm =

ρ(n)(n

< n >)m,

Xn=2

−

(8)

areas from the original areas given by:

where < n > is the average number of sides of a bubble
in the pattern (for inﬁnite patterns < n >= 6). The
second moment, µ2, measures the r.m.s. width of the
distribution while µ3 and µ4 measure the asymmetry and
the ﬂatness of the side distribution.

To test these properties and quantify the errors, we
analyzed the coarsening dynamics of both the simulated
and reconstructed foams. Figure 8 shows the time evo-
lution of < A > for both foams. Both curves follow a

∆A
A E

D

=

1
N

N

Xi=1

1
AO
i |

AO

i −

AR
,
i |

(9)

as a function of time, including and excluding missing
bubbles in the calculation. The superscripts O and R
stand for original and reconstruction, respectively. The
sum in eq. 9 runs over all N bubbles in the foam. Both
curves decrease slightly due to the increasing length
scale of the pattern. The time averaged deviation is

±

(9.2
1.6)%
3.0)% including missing bubbles and (5.4
excluding them. Hence, the area of a reconstructed bub-
ble diﬀers by about 5.4% from the area of the original
bubble.

±

eas given by:

9

∆A
A Etime

D

=

1
Nn

Nn

Xi=1

1
AO
i

(AO

i −

AR

i ),

(10)

as a function of the number of sides n. The sum in eq. 10
runs over all Nn bubbles with n sides at any instant of
time. For few-sided bubbles, the reconstructed area is
smaller than the original area, while for many-sided bub-
bles the reconstructed area is larger than the original
area. The reconstructed images had no 3- or 11-sided
bubbles to analyze. Otherwise, the relative area devi-
ations follow very closely the theoretical predictions for
δ(P/√A)n.

FIG. 7: Fraction of missing bubbles in the reconstruction as
a function of time.

FIG. 9: Relative mean area deviation of the reconstruction
from the simulation as a function of time.

FIG. 8: Average bubble area evolution for the original and
reconstructed structures.

This residual error is a consequence of reconstructing
straight edges rather than the curved boundaries of a
real foam. According to Plateau’s rules, the ratio be-
tween the perimeter and the square root of a regular
bubble is a constant (P/√A
3.72) while the ratio for
polygonal bubbles with straight sides is 2
n tan(π/n).
Therefore, the relative deviation from a regular Plateau
bubble from a bubble with straight sides is approxi-
mately δ(P/√A)n = 2
3.72. Figure 10
shows δ(P/√A)n (stars) on top of the time averaged rel-
ative diﬀerence between simulated and reconstructed ar-

n tan(π/n)

p

p

≈

−

FIG. 10: Relative diﬀerence between simulated and recon-
structed areas averaged over time as function of bubble topol-
ogy (number of sides). The stars represent the relative devia-
tion of a regular Plateau bubble from a bubble with straight
sides δ(P/√A)n (see text).

von Neumann’s law states that, in two dimensions, the
area growth rate of individual bubbles with n edges is

10

rate for small bubbles which are an artifact of the regular
Potts model simulation [59].

Figure 12 shows the time dependence of the area of four
individual bubbles. Filled and open symbols of the same
type (circles, squares, etc.) correspond to simulated and
reconstructed areas. The local dynamics are very similar
for the simulation and reconstruction. Figure 6 shows
that for the great majority of the bubbles, simulation
and reconstruction follow the same dynamics.

FIG. 11: von Neumann’s law. Detail: average dAn/dt as
a function of n for the simulated and reconstructed foams.
Main graph: percentage in von Neumann’s law between the
simulated and reconstructed foams.

(a) original

(b) reconstruction

FIG. 13: Normalized area distributions for the simulated (a)
and reconstructed (b) foams. Each graph shows several dis-
tributions for diﬀerent times. All distributions have approxi-
mately the same shape (thick line).

FIG. 12: Area evolution for four simulated (ﬁlled symbols)
and reconstructed (hollow symbols) bubbles.

proportional to (n

6):

−

dAn
dt

= κ(n

6).

−

Few-sided bubbles are convex, so a straight-sided recon-
struction cuts oﬀ the bulges, while many-sided bubbles
are concave so a straight-sided reconstruction ﬁlls in the
dips. Figure 11 shows the deviation in von Neumann’s
law calculated for the simulated and reconstructed foams
as:

∆

D

(cid:16)

dAn
dt (cid:17)E

=

1
Nn

Nn

Xi=1 (cid:16)

−1

dAO
i
dt (cid:17)

dAO
i
dt −

(12)

dAR
i
,
dt (cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

where the summation in i runs over all the Nn n-sided
bubbles at any instant of time. The nonlinearity seen in
the inset to ﬁgure 11 results from deviations in growth

(11)

FIG. 14: Comparison of the shape of the simulated and re-
constructed area distributions.

Another important aspect of coarsening foam is self-
similarity. Figure 13a shows the normalized area distri-
butions at several times for the simulated foam. These
distributions are congruent indicating that the foam is in
a scaling state. The thick line obtained by averaging all
the distributions represents all the individual cases within
3%. The same applies to the reconstruction (ﬁg. 13b).
The scaled area distributions are equivalent within 7%
(ﬁg. 14) so the reconstructed foam scales in the same
way as the simulation.

Figure. 15 shows the evolution of the side distribution
for both the simulation (left) and reconstruction (right).

The distributions are time-independent and remarkably
similar, peaking at n = 6 [58]. Figure 16 shows the sec-
ond moment of the side distribution as function of time.
The general behavior is similar for both patterns: µ2 os-
cillates about a stable value, since in the scaling state, the
width of the distribution is nearly constant. The average
0.30
values of 1.62
for the reconstruction agree well with experimental val-
ues [33, 58].

0.27 for the simulation and 1.46

±

±

(a) original

(b) reconstruction

FIG. 15: Side distribution ρ(n) as a function of time for the
simulation (left) and reconstruction (right).

Figures 17 and 18 show, respectively, the third and
fourth moments as functions of time. The third moment
begins near its maximum (µ3 = 2.5) showing the inho-
mogeneity in the foam that lasts until about 30000 mcs.
It then drops to a stable value of µ3 = 0.61
0.27 for the
simulation and µ3 = 0.63
0.33 for the reconstruction.
±
The fourth moment behaves similarly: an initial equili-
bration stage up to 30000 mcs followed by stability with
µ4 = 5.6
1.8 for
1.4 for the simulation and µ4 = 5.5
the reconstruction, again agreeing with experiment [33].

±

±

±

FIG. 16: Second moment µ2 of the side distribution as a
function of time for the simulation and reconstruction.

11

FIG. 17: Third moment µ3 of the side distribution as a func-
tion of time for the simulation and reconstruction.

FIG. 18: Fourth moment µ3 of the side distribution as a func-
tion of time for the simulation and reconstruction.

VII. CONCLUSIONS

Our method of reconstructing two-dimensional foam
structures works well. The Potts model generates min-
imal energy surfaces and the pins hinder coarsening.
These two tools together reconstruct a coarsening foam.
We show that little imperfections are mainly introduced
by distance maps calculation, which are not the core of
our method. The few deviations do not induce system-
atic errors in the statistical properties of a foam during
a coarsening process. This method extends to three di-
mensions with no major modiﬁcations, which will be very
helpful in studies of the dynamics of three- dimensional
cellular patterns.

Our aims are now two-fold. We must deal with real
data. The reconstruction algorithm presented in this ar-
ticle will be the basis for analyzing the images of three-
dimensional foams we recently obtained using X-ray to-

mography at the European Synchrotron Radiation Facil-
ity (ESRF). To extract the maximum information from
experimental images we will directly couple the value of
J in the Potts

Hamiltonian to the pixel gray level. A bubble bound-
ary localized in a dark region (ﬂuid phase) will cost much
less energy than a boundary in a light region (gas phase).
This reformulation of the pinning ﬁeld has the great ad-
vantage that it requires no image pretreatment or thresh-
olding. Randomly distributed “ﬂuid” pixels due to exper-
imental noise will have much less power to pin boundaries
than the organized pixels corresponding to faces, even
if their gray level values are of the same order of mag-
nitude. The method is also relatively immune to long
wavelength inhomogeneities in the image saturation, e.g.
due to MRI coil geometry. Second, we are working to
improve our image reconstruction in several ways, by de-

veloping heuristics to correct for missing/extra bubbles,
by introducing additional mechanisms to deal with noise,
and by implementing target area corrections.

12

Acknowledgments

We thank Dr. Mark Zajac and Dr. Marius Asi-
pauskas for great help and inﬁnite patience in our count-
less discussions, Dr. Igor Veretennikov and Dr. Burkhard
Prause for the MRI image of a foam and Prof. Fran¸cois
Graner for his helpful revisions to the manuscript. We ac-
knowledge support from NSF grants DMR-0089162 and
INT98-02417, NASA grant NAG3-2366 and DOE grant
DE-FGO299ER45785.

[1] I. F. Vasconcelos, I. Cantat, and J. A. Glazier, to be

man, Scripta Metall. 19, 1291 (1985) .

published.

[23] D. J. Durian, D. A. Weitz, and D. J. Pine, Science 252,

[2] X. Munoz, J. Freixenet, X. Cuﬁ, and J. Marti, Pattern

686 (1991).

Recogn. Lett. 24, 375 (2003).

[24] D. J. Durian, D. A. Weitz, and D. J. Pine, Phys. Rev. A

[3] D. L. Pham, C. Y. Xu, and J. L. Prince, Annu. Rev.

44, R7902 (1991).

Biomed. Eng. 2, 315 (2000) .

[4] J. S. Suri, K. C. Liu, S. Singh, S. N. Laxminarayan, X. L.
Zeng, and L. Reden, IEEE T. Inf. Technol. B 6, 8 (2002).

[5] P. Zinzindohoue, Optik 87, 141 (1991).
[6] J. Plateau, Statique Experimentale et Theorique des Liq-
uides Soumis aux Seulles Forces Moleculaires (Gauthier-
Villars, Paris, 1873).

[7] B. Prause, Magnetic Resonance Imaging of Coarsening
in Three-Dimensional Foams (Ph.D. dissertation, Uni-
versity of Notre Dame, 2000).

[8] C. Monnereau and M. Vignes-Adler, J. Colloid Interf.

[25] C. P. Gonatas, J. S. Leigh, A. G. Yodh, J. A. Glazier,

and B. Prause, Phys. Rev. Lett. 75, 573 (1995).

[26] F. Graner, I. Cantat, R. Delannay, J. A. Glazier, and P.

Cloetens, unpublished.

[27] R. Glantz,

Porennetzwerke

von Erdstoﬀ-Filtern.
Mathematisch-morphologische
kern-
Beschreibung
spintomographischer Aufnahmen (Ph.D. dissertation,
University of Karlsruhe, 1997).

[28] F. Y. Wu, Rev. Mod. Phys. 54, 235 (1982).
[29] D. J. Srolovitz, M. P. Anderson, G. S. Grest, and P. S.

Sahni, Scripta Metall. 17, 241 (1983).

[30] D. J. Srolovitz, M. P. Anderson, G. S. Grest, and P. S.

Sci. 202, 45 (1998).

5228 (1998).

[9] C. Monnereau and M. Vignes-Adler, Phys. Rev. Lett. 80,

Sahni, Acta Metall. 32, 783 (1984).

[10] C. Monnereau, M. Vignes-Adler, and N. Pitter, Philos.

Grest , Acta Metall. 32, 793 (1984).

Mag. B 79, 1213 (1999).

[32] J. Wejchert, D. Weaire, and J. P. Kermode, Philos. Mag.

[11] C. Monnereau, N. Pittet, and D. Weaire, Europhys. Lett.

B 53, 15 (1986).

52, 361 (2000).

[33] J. A. Glazier, M. P. Anderson, and G. S. Grest, Philos.

[12] C. Monnereau, B. Prunet-Foch, and M. Vignes-Adler,

Mag. B 62, 615 (1990).

Phys. Rev. E 63, 061402 (2001).

[34] Y. Jiang and J. A. Glazier, Philos. Mag. Lett. 74, 119

[31] D. J. Srolovitz, M. P. Anderson, P. S. Sahni, and G. S.

[13] M. R. Fetterman, E. Tan, L. Ying, R. A. Stack, D. L.
Marks, S. Feller, E. Cull, J. M. Sullivan, D. C. Munson,
S. T. Thoroddsen, and D. J. Brady, Opt. Express 7, 186
(2000).

[14] F. Morgan and R. Bolton, Am. Math. Mon. 109, 165

(2002).

[15] F. Morgan, J. Sullivan et al., Int. J. Math. 7, 833 (1996).
[16] W. Thomson (Lord Kelvin), Phil. Mag. 25, 503 (1887)
[17] H. V. Atkinson, Acta Metall. Matter. 36, 469 (1988). 5
[18] D. Weaire and N. Rivier, Contemp. Phys. 25, 59 (1984).
[19] G. Reiter, Phys. Rev. Lett. 68, 75 (1992).
[20] D’Arcy W. Thompson, On Growth and Form (Cambridge

(1996).

(1992).

[35] F. Graner and J. A. Glazier, Phys. Rev. Lett. 69, 2013

[36] D. Weaire, F. Bolton, P. Molho, and J. A. Glazier, J.

Phys: Condens. Matter. 3, 2101 (1991).

[37] N. Metropolis, A. Rosenbluth, M. Rosenbluth, A. Teller,

and E. Teller, J. Chem. Phys. 21, 1087 (1953).

[38] K. Kawasaki, Phys. Rev. 145, 224 (1965).
[39] R. J. Glauber, J. Math. Phys. 4, 294 (1963).
[40] C. S. Smith, Trans. Metall. Soc. AIME 175, 15 (1948).
[41] D. J. Srolovitz, M. P. Anderson, G. S. Grest, and P. S.

Sahni, Acta Metall. 32, 1429 (1984).

University Press, Cambrigde, 1942).

[42] B. K. Kad and P. M. Hazzledine, Mat. Sci. Eng. A238,

[21] K. J. Dormer, Fundamental Tissue Geometry for Biolo-
gists (Cambridge University Press, Cambrigde, 1980).
[22] V. E. Fradkov, A. S. Kravchenco, and L. S. Shvindler-

70 (1997).

[43] M. Soucail, R. Messina, A. Cosnuau, and L. P. Kubin,

Mat. Sci. Eng. A271, 1 (1999).

13

[44] A. Miyake, Scripta Mater. 45, 1009 (2001).
[45] O. Krichevsky and J. Stavans, Phys. Rev. B 46, 10579

SPE J. 7, 40 (2002).

[51] I. Hidajat, A. Rastogi, M. Singh, and K. K. Mohanty,

(1992).

[52] J. H. Jang and K. S. Hong, Pattern Recogn. 35, 807

[46] O. Herrera, A. Olguin, M. Ortiz, and C. H. Worner, Phys.

(2002).

Rev. E 55, 4475 (1997).

[53] M. N. Kulountzakis, and K. N. Kutulakos, Inform. Pro-

[47] R. Glantz and U. Schuler, Proceedings of Geoﬁlters’96,
edited by J. Laﬂeur and A. Rollin, (BITECH, Montreal,
Canada, 1996) p. 75.

[48] R. Glantz, R. Englert, and W. G. Kropatsch, Computer
Vision - CVWW’99, Proceedings of the Computer Vision
Winter Workshop, edited by N. Br¨andle (PRIP TU Wien,
Wien, Austria, 1999) p. 112.

[49] E. S. Blurock, R. Glantz, and R. Englert, 2nd
IAPR-TC-15 Workshop on Graph-based Representation,
edited by W. G. Kropatsch, and J.-M. Jolion, (OCG-
Schriftenreihe, Band 126, Osterreichische Computer
Gesellschaft, 1999) p. 213.

[50] J. Timonen, K. Kippo, R. Glantz, and T. Pakkanen, J.

Mat. Sci.: Mater. M. 12, 319 (2001).

cess. Lett. 43, 181 (1992).

[54] L. Chen and H. Y. H Chuang, Inform. Process. Lett. 51,

25 (1994).

[55] A. Fujiwara, T. Masuzawa, and H. Fujiwara, Inform. Pro-

cess. Lett. 54, 295 (1995).

[56] I. F. Vasconcelos, I. Cantat, and J. A. Glazier, to be

[57] J. A. Glazier, S. P. Gross, and J. Stavans, Phys. Rev. A

[58] J. Stavans and J. A. Glazier, Phys. Rev. Lett. 62, 1318

published.

36, 306 (1987).

(1989).

[59] E. Holm, J. A. Glazier, D. J. Srolovitz, and G. S. Grest,

Phys. Rev. A 43, 2662 (1991)

