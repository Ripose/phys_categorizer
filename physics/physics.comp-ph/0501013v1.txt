5
0
0
2
 
n
a
J
 
4
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
3
1
0
1
0
5
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Computational methods in Coupled Eletron-Ion

Monte Carlo

Carlo Pierleoni

and David M. Ceperley

a ∗

b

19th January 2014

Department of Physis, University of L'Aquila, Via Vetoio, I-67010 L'Aquila,

Dept. of Physis and NCSA, University of Illinois at Urbana-Champaign, Ur-

a

b

Italy

bana, IL 61801, USA

Abstrat

In the last few years we have been developing a Monte Carlo simula-

tion method to ope with systems of many eletrons and ions in the Born-

Oppenheimer (BO) approximation, the Coupled Eletron-Ion Monte Carlo

Method (CEIMC). Eletroni properties in CEIMC are omputed by Quan-

tum Monte Carlo (QMC) rather than by Density Funtional Theory (DFT)

based tehniques. CEIMC an, in priniple, overome some of the limita-

tions of the present DFT based ab initio dynamial methods. Appliation of

the new method to high pressure metalli hydrogen has reently appeared. In

this paper we present a new sampling algorithm that we have developed in the

framework of the Reptation Quantum Monte Carlo (RQMC) method hosen

to sample the eletroni degrees of freedom, thereby improving its e(cid:30)ieny.

Moreover, we show here that, at least for the ase of metalli hydrogen, varia-

tional estimates of the eletroni energies lead to an aurate sampling of the

proton degrees of freedom.

∗

Corresponding author: Carlo Pierleoni, Physis Dept. University of L'Aquila, Via Vetoio,

67010 Coppito, L'Aquila (Italy), fax:+39-0862433033; email: arlo.pierleoniaquila.infn.it

1

1 Introdution

Modern theoretial methods in ondensed matter physis and hemistry rely heav-

ily on numerial simulations. The problem of solving the Shroedinger equation

for many-body systems is too di(cid:30)ult to be addressed diretly, even within the

simpli(cid:28)ation provided by the Born-Oppenheimer approximation. In the most pop-

ular pratial approahes (Hartree-Fok (HF) and the Density Funtional Theory

(DFT) based methods[1℄) the original problem is replaed by the problem of solving

the time independent Shroedinger equation for a single eletron in the (cid:28)eld of the

nulei and the mean (cid:28)eld generated by the other eletrons. DFT is, in priniple, an

exat theory but the energy funtional must be treated approximately for pratial

purposes. In the simplest Loal Density Approximation (LDA), this exat theory

beomes a self-onsistent mean (cid:28)eld theory. Extensions of LDA, suh as Gener-

alized Gradient Approximation (GGA) provide more aurate results but remain

essentially at the level of an e(cid:27)etive mean (cid:28)eld treatment. Despite the mean (cid:28)eld

harater, DFT shemes have proved to provide quite aurate results for many

di(cid:27)erent systems[1℄

In 1985, Car and Parrinello introdued an e(cid:30)ient method to ouple standard

Moleular Dynamis for lassial nulei with the eletroni struture alulation at

the level of LDA done (cid:16)on the (cid:29)y(cid:17) to extrat the nulear fores[2℄. Beause the

method allowed study of the statistial mehanis of lassial nulei with many

body eletroni interations, it opened the way for the use of simulation methods

for realisti systems with an auray well beyond the limits of e(cid:27)etive fore (cid:28)elds

available. In the last twenty years, the number of appliations of the Car-Parrinello

ab-initio moleular dynamis has ranged from simple ovalent bonded solids, to

high pressure physis, material siene and biologial systems. There have also been

extensions of the original algorithm to simulate systems at onstant temperature and

onstant pressure[3℄, (cid:28)nite temperature e(cid:27)ets for the eletrons [4℄, and quantum

nulei [5℄.

Despite reent progress, DFT su(cid:27)ers from well-known limitations, for example,

exited state properties suh as optial gap and spetra are less reliable. DFT

shows serious de(cid:28)ienies in desribing van der Waals interations, non-equilibrium

geometries suh as reation barriers, systems with transition metals and/or luster

isomers with ompeting bonding patterns[1, 6℄. As a onsequene, urrent ab-initio

preditions of metallization transition at high pressures, or even predition of phase

transitions are often only qualitative. Hydrogen is an extreme ase[7, 8, 9℄ but even

in silion the diamond/β -tin transition pressure and the melting temperature are

seriously underestimated[10℄.

Another route to the ground state properties of a system of many eletrons

in presene of nulei is the Quantum Monte Carlo method[11, 6℄. In its simplest

form, an analyti many eletron wave funtion is hosen on the basis of the vari-

ational priniple (Variational Monte Carlo, VMC) and the quantum averages are

obtained by a Metropolis Monte Carlo simulation of the eletroni oordinates. A

more aurate representation of the ground state wave funtion an be obtained by

pro jeting the variational wave funtion with the operator exp{−βeH} where H

is the many-body hamiltonian, and βe is the pro jetion time. Provided that the

variational wave funtion is not orthogonal to the ground state wave funtion, the

pro jeted funtion tends exponentially fast to the ground state wave funtion as

βe → ∞. Sine matrix elements of the above pro jetion operator at large values

of βe are unknown for non trivial systems, a Trotter breakup in many (P ) small

imaginary time intervals (τe = βe/P ) must be employed. In the on(cid:28)guration rep-

resentation, eah pro jetion orresponds to a 3N -dimensional integral whih an

be performed by Metropolis Monte Carlo method provided that the propagator in

imaginary time an be hosen real and an be interpreted as a probability distribu-

tion. This is the essene of the Di(cid:27)usion Monte Carlo method (DMC) whih is an

(cid:16)exat(cid:17) method for systems of bosons or boltzmannons. This means that all system-

ati errors in a simulation are under ontrol in the sense that they an be redued

as muh as desired. Sine eletron are fermions, the above sheme fails beause the

imaginary time propagator must be ompletely antisymmetri under exhange of

two eletrons and therefore annot be hosen stritly non-negative everywhere in

on(cid:28)gurational spae. This is the origin of the infamous (cid:16)fermion sign problem(cid:17).

In order to avoid the sign problem the (cid:16)(cid:28)xed node approximation(cid:17) has been pro-

posed and used routinely to perform fermion simulations[6℄. The energy alulated

with this approximation is variational with respet to the position of the nodal sur-

faes of the trial wave funtion. Over the years, the level of auray of the (cid:28)xed

node approximation for simple homogeneous systems, suh as

3He and the eletron

gas, has been systematially improved by introduing more sophistiated nodal sur-

faes (bak(cid:29)ow orbitals)[12, 13℄. In more omplex, inhomogeneous situations suh

as atoms, moleules and extended systems of eletrons and nulei, progress have

been somewhat slower. Nonetheless, in most ases, (cid:28)xed-node QMC methods have

proved to be more aurate than mean (cid:28)eld methods (HF and DFT)[6℄. Computing

ioni fores with QMC to replae the DFT fores in the ab-initio MD, is more di(cid:30)-

ult and a general and e(cid:30)ient algorithm is still missing. Moreover, the omputer

time required for a QMC estimate of the eletroni energy is, in general, more than

for a orresponding DFT-LDA alulation. These problems have seriously limited

the development of an ab-initio simulation method based on the QMC solution of

the eletroni problem (cid:16)on the (cid:29)y(cid:17).

In reent years, we have developed a di(cid:27)erent strategy based entirely on the

Monte Carlo method both for solving the eletroni problem and for sampling the

ioni on(cid:28)guration spae[14, 15℄. The new method, alled the Coupled Eletron-Ion

Monte Carlo method (CEIMC) has been applied so far to high pressure metalli

hydrogen where it has found quite di(cid:27)erent e(cid:27)ets of temperature than CPMD

based on the LDA fores[16℄. Our present interpretation of the disagreement is that

LDA provides a Born-Oppenheimer surfae quite smoother than the more aurate

QMC one and this strongly a(cid:27)ets the struture of the protoni system at T > 0.

The paper is organized as follows. The following setion 2 is devoted to an outline

of the CEIMC method. We will not go into all details sine two long artiles have

appeared on general aspets and early implementations of the method[14, 15℄. One

of the new aspets that we have reently implemented in CEIMC, not desribed in

those referenes, is the Reptation Quantum Monte Carlo pro jetion of the eletroni

variational wave funtion[17℄. So in the subsetion 2.1 we review the RQMC method

and in the following subsetion 2.2 we fous on the sampling algorithm, we introdue

our new sheme to improve e(cid:30)ieny and reliability of RQMC and we provide an

analytial proof. In Setion3 we report numerial results on the onvergene of the

new sheme with the pro jetion time and with the Trotter time step. Finally, in

setion 4, we onlude.

2 The Coupled Eletron-Ion Monte Carlo method

CEIMC method is based on the Born-Oppenheimer (BO) separation between the

slow nulei and the fast eletrons. This is in ontrast with other Quantum Monte

Carlo methods, Di(cid:27)usion Monte Carlo (DMC)[11, 6℄ or (cid:28)nite temperature Path

Integral Monte Carlo (PIMC)[18, 19℄ methods where eletrons and ions are treated

on the same footing. As usual, the BO approximation allows to overome the

limitations of the other QMC methods, while introduing an often negligible error.

In CEIMC, the on(cid:28)gurational spae of the proton degrees of freedom at inverse

temperature β = (kBT )−1

is sampled with a Metropolis algorithm in whih the

di(cid:27)erene between the BO energy of a proton state S and of a trial state S′

is

omputed by an eletroni ground state QMC alulation. The QMC estimate of

the energy di(cid:27)erene ∆ = [E(S′) − E(S)] has statistial noise whih would bias the

standard Metropolis algorithm. Unbiased sampling of the proton on(cid:28)gurations is

ahieved by the penalty method[20℄ whih replaes the energy di(cid:27)erene ∆ in the

aeptane formula by ∆ + (βσ∆)2/2, where σ2

∆ is the variane of the energy di(cid:27)er-

ene. Sine σ2

∆ > 0, the noise always auses extra rejetions but this ompensates

for (cid:17)uphill(cid:17) moves aepted beause of a favorable energy (cid:29)utuation.

Several methods for omputing energy di(cid:27)erenes in QMC are available.[14, 15℄.

A simple and e(cid:30)ient method is to sample the eletroni degrees of freedom from a

distribution funtion whih is the sum of the eletroni distribution funtions for the

S and S′

states (e. g. the sum of the the square of the trial wave funtions in VMC).

Averages of operators involving eletroni degrees of freedom and a single proton

on(cid:28)guration, say S , (for instane total energy, variane, et.) are then omputed

by orrelated sampling[11, 14, 15℄. For the typial size of the proton moves (between

0.01Å and 0.5Å for lassial protons depending on density and temperature) and

the typial system size (up to 54 protons) we have investigated, this method is muh

more e(cid:30)ient than performing two independent eletroni alulations for the state

S and S′

.

In the ground state QMC methods, an eletroni trial wave funtion must be

hosen aording to the physis of the system being studied. For the metalli phase

of hydrogen, we have reently developed analyti funtions whih inlude bak(cid:29)ow

and three-body orrelations[21℄. These wave funtions are partiularly appropriate

to CEIMC sine they have aurate energies already at the variational level, they

have no adjustable parameters requiring optimization, and their omputational ost

is muh less than using orbitals expanded in a plane wave basis typially used in

QMC alulations[22℄.

In metalli systems, (cid:28)nite size e(cid:27)ets are large and must be suitably treated. The

ommon proedure is to repeat the alulation for systems of inreasing size and

extrapolate to the thermodynami limit but this is impratial within CEIMC, sine

it would have to be performed for any proposed protoni step before its aeptane.

A muh better strategy is to use Twist Averaged Boundary Condition (TABC)

[23, 15℄ whih redues the (cid:28)nite size error in the energy to the lassial 1/N behavior.

It onsists in averaging the energy over the phase that the many body wave funtion

an pik if a single eletron wraps around the super-ell. This is equivalent to

Brillouin zone sampling in the single eletron approximation. Within CEIMC it

does not ause a large inrease in required CPU time/step.

Finally a reent improvement of the method is the introdution of quantum

e(cid:27)ets for the protons, quite important in high pressure hydrogen. This is done by

developing the thermal density matrix of protoni degrees of freedom on the BO

surfae in Feynman Path Integrals[18, 16℄. A similar tehnique in the ontext of

Car-Parrinello method has appeared[5℄. We are not going to disuss the last two

aspets of the CEIMC. While TABC implementation in CEIMC has been desribed

in ref.[15℄, our implementation of PIMC for proton degrees of freedom in CEIMC

will be the sub jet of a future publiation.

2.1 Reptation Quantum Monte Carlo Method

To go beyond VMC eletroni energies, we implemented a Reptation Quantum

Monte Carlo algorithm (RQMC)[17℄, rather than Di(cid:27)usion Monte Carlo algorithm

(DMC). The implementation of the energy di(cid:27)erene method is more straightfor-

ward in RQMC, nor are averages of observables whih do not ommute with the

hamiltonian biased.

In RQMC the ground state wave funtion is obtained by onstruting an imag-

inary time path integral for the eletroni degrees of freedom. If |Ψ0i is the trial

state, the trial state pro jeted in a (cid:16)time(cid:17) βe/2, |Ψβe/2i = e−βeH/2|Ψ0i, will onverge

to the ground state for large βe . Let us de(cid:28)ne the (cid:16)partition(cid:17) funtion

Zβe = hΨ0|e−βeH |Ψ0i.

(1)

The energy is then de(cid:28)ned as

E(βe) = −

ln Zβe =

hΨ0|e−βeH H|Ψ0i = hEL(R)i

(2)

d
dβe

1
Zβe

where the averages of the loal energy, EL(R) = ℜ(Ψ−1

0 (R) HΨ0(R)), are with

respet to the path average. In pratie, the energy is omputed as the average

of the loal energy at the two ends of the path. Here ℜ indiates the real part in

the ase that the trial funtion or Hamiltonian is omplex. The energy E(βe) is an

upper bound to the (cid:28)xed node energy for eah value of βe , it onverges to this at

large βe , and its βe derivative is stritly negative. This latter quantity is, in fat,

minus the variane of the total energy

σ2(βe) = −

= hEL(0)EL(βe)i − hE(βe)i2.

(3)

dE(βe)
dβe

The variane tends to zero for large enough values of βe providing a useful signal

for the onvergene of the energy to the ground state. This is the zero variane

theorem in RQMC. On the other hand, the variane of the loal energy omputed

at either end of the path is the mixed estimator of DMC for σ2(βe). In pratial

implementations, it is desirable to keep βe as small as possible to maximize the

e(cid:30)ieny of the energy di(cid:27)erene method.

To ompute the needed density matrix elements, we divide the pro jetion time

βe into P time slies τe = βe/P and make a semi-lassial approximation for

exp(−τeH). Our notation for a single eletroni on(cid:28)guration is R = {r1, . . . , rN },

while for the entire path is s = {R0, R1, . . . , RP }. The probability distribution for

a path is

Π(s) = exp

−U (R0) − U (Rp) −

Ls(Ri+1, Ri)

(4)

(

)

where U (R) = ℜ[lnΨ0(R)] and Ls(R, R′) is the symmetrized link ation for our

P −1

i=1
X

approximation of the short time propagator. We have used the importane sampling

Green's funtion of the DMC propagator

R|e−τeH |R′

=

exp

−τeEL(R) −

Ψ0(R)
Ψ0(R′)

(cid:11)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:20)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

[R′ − R − 2λτeF (R)]2
4λτe

.

(cid:21)

(5)

where the fore is F (R) = ∇U (R) and λ = ¯h2/2me , whih provides the symmetrized

(cid:10)

link ation

Ls(R, R′) =

EL(R) + EL(R′) + λ

F 2(R) + F 2(R′)

τe
2
(R − R′)2
(cid:2)
4λτe

+

+

(R − R′) · (F (R) − F (R′))
(cid:0)
2

(cid:1)(cid:3)

(6)

An alternative form for the link ation ould be obtained through the pair ation

developed in (cid:28)nite temperature Path Integral MC[18℄. However, we have not im-

plemented this form and do not have a omparison of its e(cid:30)ieny.

In order to impose the (cid:28)xed phase onstraint on the pro jeted wave funtion, we

must add to the link ation a term of the form LF P

(R, R′) = λτe

s

1
0 dη |∇φ(X(η))|

2

where φ(X) is the phase of the trial wave funtion at eletroni position X and the

R

integral is taken over all paths X(η) with boundary onditions X(0) = R, X(1) =

R′

. We have taken an end-point approximation for this term exept for real wave

funtions in whih ase (cid:28)xed-node boundary onditions were used.

Note that in the expressions above, the dependene on the nulear degrees of

freedom was not shown even though all quantities depend on them. The probability

distribution of an eletroni path will be Π(s, S) where S indiates the position of

all nulei. Beause we have an expliit distribution of the eletroni paths, it is

straightforward to apply the importane sampling sheme for the energy di(cid:27)erenes

by sampling the probability distribution [Π(s, S) + Π(s, S′)] where S and S′

are the

urrent and the trial protoni state, respetively. Note also, for VMC Π(s, S) ∝

beomes the square of modulus of the trial wave funtion (no pro jetion

2
|Ψ0(s, S)|

and R0 = RP ).

2.2 The (cid:16)boune(cid:17) algorithm

In the original work on RQMC[17℄, the eletroni path spae was sampled by a

reptation algorithm, an algorithm introdued to sample the on(cid:28)gurational spae

of linear polymer hains. The slithering snake or reptation method seems to have

originated by Kron[24℄ and by Wall and Mandel[25℄. Given a path on(cid:28)guration s,

a move is done in two stages. First one of the two ends (either R0 or RP ) is sampled

with probability 1/2 to be the growth end Rg . Then a new point near the growth

end is sampled from a Gaussian distribution with enter at Rg + 2λτeF (Rg). In

order to keep the number of links on the path length onstant, the old tail position

is disarded in the trial move. The move is aepted or rejeted with the Metropolis

formula based on the probability of a reverse move. For use in the following, let us

de(cid:28)ne the diretion variable d as d = +1 for a head move (Rg = RP ), and d = −1

for a tail move (Rg = R0 ). In standard reptation, the diretion d is hosen randomly

at eah attempted step.

In the standard reptation algorithm, the transition probability P (s → s′) is the

produt of an attempt probability Td(s → s′) and an aeptane probability ad(s →

s′). Note that the path distribution given in Eq.(4), beause of the symmetrized

link ation does not depend on the diretion d in whih it was onstruted. In the

Metropolis algorithm, the aeptane probability for the attempted move is

whih ensures that the transition probability Pd(s → s′) satis(cid:28)es detailed balane

ad(s → s′) = min

1,

Π(s′)T−d(s′ → s)
Π(s)Td(s → s′)

(cid:21)

(cid:20)

Π(s)Pd(s → s′) = Π(s′)P−d(s′ → s)

(7)

(8)

The autoorrelation time of this algorithm in Monte Carlo steps, that is the

number of MC steps between two unorrelated on(cid:28)gurations, sales as [(βe/τe)2/A],

where A is the aeptane rate, an unfavorable saling for large βe . Moreover the

oasional appearane of persistent on(cid:28)gurations bouning bak and forth without

really sampling the on(cid:28)guration spae has been previously observed[26℄. These are

two very unfavorable features, partiularly in the present ontext, where we need

to perform many di(cid:27)erent eletroni alulations (at least one per protoni move).

There is a premium for a reliable, e(cid:30)ient and robust algorithm.

We have found that a minimal modi(cid:28)ation of the reptation algorithm solves

both of these problems. The idea is to hose randomly the growth diretion at the

beginning of the Markov hain, and reverse the diretion upon rejetion only, the

(cid:16)boune(cid:17) algorithm. As far as we are aware, (cid:17)boune(cid:17) dynamis has not been previ-

ously investigated for RQMC, though Wall and Mandel[25℄ mentioned it without a

detailed proof and subsequent polymer simulations did not use boune, perhaps be-

ause the aeptane ratio in the polymer systems is muh smaller than in RQMC.

There is a related algorithm for direted loop algorithm on the lattie and for sim-

ulations of trapped di(cid:27)usion[28, 27℄.

What follows is the proof that the boune algorithm samples the orret prob-

ability distribution Π(s). The variable d is no longer randomly sampled, but,

as before, the appropriate move is sampled from the same Gaussian distribution

Td(s → s′) and aepted aording to the Eq. (7). To be able to use the tehniques

of Markov hains, we need to enlarge the state spae with the diretion variable d.

In the enlarged on(cid:28)guration spae {s, d}, let us de(cid:28)ne the transition probability

P (s, d → s′, d′) of the Markov hain. The algorithm is a Markov proess in the

extended path spae, and it is ergodi as DMC method, hene, it must onverge to

a unique stationary state, Υ(s, d) satisfying the eigenvalue equation:

Υ(s, d) P (s, d → s′, d′) = Υ(s′, d′).

(9)

Xs,d

We show that our desired probability Π(s) is solution of this equation. Within the

imposed rule not all transitions are allowed, but P (s, d → s′, d′) 6= 0 for d = d′

and

s 6= s′

(aepted move), or d′ = −d and s = s′

(rejeted move) only. Without loss

of generality let us assume d′ = +1 sine we have symmetry between ±1. Eq. (9)

with Υ(s, d) replaed by Π(s) is

Π(s′)P (s′, −1 → s′, 1) +

Π(s)P (s, 1 → s′, 1) = Π(s′).

Xs6=s′

s
X

Beause of detailed balane Eq.(8), we have Π(s)P (s, 1 → s′, 1) = Π(s′)P (s′, −1 →

s, −1), whih when substituted in this equation gives

Π(s′)

P (s′, −1 → s′, 1) +
"

P (s′, −1 → s, −1)
#

= Π(s′).

Note that we have ompleted the sum over s with the term s = s′

beause its

probability vanishes. The term in the braket exhausts all possibilities for a move

from the state (s′, −1), thus it adds to one. Hene Π(s) is a solution of eq. (9) and

by the theory of Markov hains, it is the probability distribution of the stationary

state.

3 Results

In order to hek the validity of our proof we (cid:28)rst applied the boune algorithm to

an analytially solvable model, namely a one dimensional harmoni osillator and

obtained the expeted results. For a realisti test, we ompare the standard and

the boune algorithms for a (cid:28)xed pair of protoni on(cid:28)guration (S, S′) generated

during a VMC run of liquid hydrogen at rs = 1.31 and T = 5000K . We have

onsidered Np = Ne = 16 protons and eletrons using analyti wave funtions with

3-body and bak(cid:29)ow terms at the Γ point (periodi boundary onditions)[21℄. In

the test, we (cid:28)xed the eletroni imaginary time step to τe = 0.04 h−1

and the

pro jetion time to βe = 0.2 h−1

whih orresponds to 4 links. The key quantity in

CEIMC is the orrelation time tc in eletroni MC steps of the energy di(cid:27)erene ∆ =

EBO(S′) − EBO(S) whih determines, for a (cid:28)xed length of the eletroni run and

for a given proton displaement, the noise level. The shorter the orrelation time tc

the larger the number of independent determinations of the energy di(cid:27)erene. This

implies smaller noise level and a larger aeptane for protoni moves, i.e. a higher

e(cid:30)ieny of the algorithm. In (cid:28)g. 1 we ompare the histogram of the orrelation

time tc of the energy di(cid:27)erene obtained with standard reptation and with the

boune algorithm over 400 bloks of 105

eletroni steps. In both alulations the

eletroni aeptane rate is 0.89 but the noise level is 0.28 with standard reptation

and only 0.14 with the boune algorithm, in agreement with the observed orrelation

times. Note that, not only the average, but also the width of the distribution is

roughly twie as large with standard reptation than with boune dynamis.

Next we study the onvergene of the boune algorithm with respet to τe and βe .

We (cid:28)rst onsider protons on a b lattie to study the onvergene of total energy

and variane and to ompare with DMC. As above, we onsider Ne = Np = 16 at

rs = 1.31, with the boundary ondition θ = 2π(0.4, 0.5, 0.6). Data obtained with

runs of 106

eletroni steps, are shown in (cid:28)g. 2. At (cid:28)xed β = 0.16H −1

we observed

a roughly linear onvergene (from below) of the total energy with τe (not shown).

reptation
bounce

)

c

t
(

P

0.25

0.2

0.15

0.1

0.05

0

0

10

20
tc (electronic steps)

30

40

Figure 1: Histogram of the orrelation time tc of the energy di(cid:27)erene. Comparison

between the reptation and the boune algorithm for a path with 4 links.

The results in (cid:28)g. 2 are for τe = 0.04H −1

whih may underestimate the energy by

0.3mH/atom. Beause of the high quality of the trial funtion, the ground state is

reahed with a very small pro jetion time. Already at βe = 0.6 the energy saturates

at the value obtained with DMC (essentially in(cid:28)nite pro jetion time, it is shown as

a horizontal line in the upper left panel). The remarkable linear dependene of the

energy versus the variane below σ2 = 0.005 (upper middle panel) an be used to

reliably extrapolate the energy to the β → ∞ limit.

In order to study the onvergene of the energy di(cid:27)erene and to estimate the

saling of tc with βe , we onsider a pair of suessive protoni on(cid:28)gurations for

the same system generated during a CEIMC run at T=5000K, i. e.

in the liquid

state. At (cid:28)xed βe = 0.16H −1

, we study the onvergene with τe in the range

0.01H −1 ≤ τe ≤ 0.08H −1

, and at (cid:28)xed τe = 0.02H −1

, we study the onvergene

with βe in the range 0.08H −1 ≤ β ≤ 9.6H −1

whih orresponds to 4 ≤ P ≤ 480

time slies. In (cid:28)gure 3 we show the (cid:28)rst two moments tc and σ2

c of high quality

Gaussian (cid:28)ts to the histograms of tc . At (cid:28)xed βe , the rejetion rate inreases linearly

with τe (not shown). However, suessful moves are more e(cid:27)etive and this results

in the observed saling tc ∼ σc ∼ τ −0.67

e

(left panels) at least in the limited range

of values of τe spanned. The behavior for inreasing βe at (cid:28)xed τe is more sluggish.

Note that the rejetion rate, 0.037 in the present ase, does not depend on βe . Both

tc and σ2

c exhibit a somewhat errati behavior but the overall salings are quite

favorable. Note that σc appears to sale roughly as tc

2

. Although the quality of the

)

m
o
t
a
/
H
T

(

E

-0.639

-0.6395

-0.64

-0.6405

-0.639

-0.6395

-0.64

-0.6405

0.015

0

0.2

0.6

0

0.4
-1
)

β
e (H

0.005
σ2

2
 (H

0.01
/atom)

Figure 2: B hydrogen at rs = 1.31. Convergene with βe for the energy (left
panel) and total energy versus the variane σ2

(right panel). In the left panel the

urve is a shifted exponential (cid:28)t while the horizontal dot-dashed lines represent the

DMC result with its statistial error. .

Gaussian (cid:28)t remains good even at large βe , for βe > 1 the histogram of tc starts

developing an small asymmetry with respet to the maximum with slower deay at

large values of tc .

In (cid:28)g. 4 we report the related energy onvergene study at (cid:28)xed τe = 0.02H −1

.

In all panels, horizontal lines represent the variational estimate with its statistial

error. In partiular the panel a) shows that the energy di(cid:27)erene ∆E/kBT used

in CEIMC to perform the aeptane/rejetion test is roughly independent of βe

(neither is there any τe dependene at (cid:28)xed βe )). This result suggests that di(cid:27)erene

of the eletroni energies at the variational level is aurate enough to perform

CEIMC, at least in the present ase of metalli hydrogen with these analytial

trial funtions; we an sample the proton oordinates using VMC and ompute

the orretions to the energy and to the equation of state with RQMC for well

equilibrated, statistially independent on(cid:28)gurations. From panel ) we see that

the pro jeted energy is lower by 5.7mH/atom = 1809K/atom with respet to the

variational estimate, a signi(cid:28)ant hange on the proton energy sale. In panels b)

and ) are shown exponential (cid:28)ts to the data. Panel d) shows the energy vs the

variane. As previously notied, linear behavior is obtained for σ2 ≤ 0.005.

Finally, in order to test whether the VMC and RQMC omputed BO surfaes

have the same shape in the relevant part of the proton on(cid:28)gurational spae and

not only at a single point, we have studied a system of Np = Ne = 54 atoms

α=-0.67

α=0.15

2α=-1.34

α=0.56

100

tc

2

σ
c

10

10

B

-0.05

T

k
/
E
∆

-0.1

-0.6

)

t

m
o
a
H

/

(

 

T

E

-0.602

-0.604

-0.606

100

tc

10

100

2

σ
c

10

10

3

0.03

b)

0.02

σ2

0.01

-0.6

-0.602

-0.604

-0.606

d)

1

0.01

τ

-1
e (H

)

0.1

0.1

1
-1
β
e (H

)

Figure 3: Saling of the average orrelation time tc of the energy di(cid:27)erene and
of its variane σ2
behavior with τe at (cid:28)xed βe = 0.16H −1
at (cid:28)xed τe = 0.02H −1

c for a (cid:28)xed pair of proton on(cid:28)gurations. Left panels show the
, while right panels show the βe dependene

.

β

e

β

e

0

0

2

4

6

10

1

2

8

a)

c)

0

2

4

6

8

10

β

e

0.01
σ2 

0.02
2
/atom)
(H

0.03

Figure 4: βe dependene of total energy, variane and energy di(cid:27)erene for a pair
of proton on(cid:28)gurations (S, S′). The study is performed for τe = 0.02H −1

. Dot-

dashed lines represent the variational estimates with their error bars. In panel b)

and ) the lines are exponential (cid:28)ts to data and in panel d) the ontinuous line is a

linear (cid:28)t in the region σ2 ≤ 0.005.

at rs = 1 and T = 1000K with zero twist phase (Γ point). Comparison of our

VMC pair orrelation funtions with CPMD-LDA results[29℄ at this thermodynami

point has reently appeared [16℄. The RQMC alulation has been performed with

τe = 0.02H −1

and βe = 1.0H −1

and provides an energy of −0.41114(8)H/atom to

be ompared with the variational estimate of −0.4087(1)H/atom. The omputed

pressure is 17.47(1)Mbars and VMC and RQMC estimates are in agreement within

error bars. Average orrelation time and variane of the energy di(cid:27)erene are tc =

7.1, σ2

c = 2.3 and tc = 16.5, σ2

c = 26.5 for VMC and RQMC respetively. Therefore,

going from VMC to RQMC with the same e(cid:30)ieny requires eletroni runs between

two and three times longer.

4 Conlusions

In onlusion, we have developed a new sampling algorithm for reptation Quantum

Monte Carlo whih we have shown to be more e(cid:30)ient than the standard sampling

sheme and to have a favorable saling with the pro jetion (imaginary) time. This

new sheme, whih requires a minimal hange of existing odes, allows one to sam-

ple long eletroni paths with a limited e(cid:27)ort. We did not observe the ourrene

of pathologial situations previously reported with the standard sheme where the

diretion was resampled eah move. We have implemented the new sampling al-

gorithm in the CEIMC method and found that the orrelation time of the energy

di(cid:27)erene for a given pair of protoni on(cid:28)gurations grows like the pro jetion time

to the power 0.15. This means, in pratie, that the noise level in CEIMC will get

only moderately worse with inreasing pro jetion time, i.e. approahing the ground

eletroni state. More important, we have found that the di(cid:27)erene in energy be-

tween the two on(cid:28)gurations is not sensitive to the pro jetion time, suggesting that

CEIMC sampling with VMC provides aurate dynamis. This onjeture has been

veri(cid:28)ed for metalli hydrogen at a single thermodynami point.

An interesting question that remains unanswered is how general our onlusions

are. Sine the trial wave funtions used in the present appliation are partiularly

aurate, whih is not generally the ase, aution must be exerised in applying the

algorithms to ases where the auray of the trial funtion is unknown.

Early aspets of the CEIMC algorithm were developed in ollaboration with M.

Dewing. We have the pleasure to thank S. Moroni for useful disussions. This work

has been supported by a visiting grant from INFM-SezG and by MIUR-COFIN-

2003. Computer time has been provided by NCSA (Illinois), PSC (Pittsburg) and

CINECA (Italy) through the INFM Parallel Computing initiative.

Referenes

[1℄ R.M. Martin, (cid:16)Eletroni Struture. Basi Theory and Pratial Methods(cid:17),

Cambridge University Press (Cambridge, 2004).

[2℄ R. Car, M. Parrinello, Phys. Rev. Letts. 55, 2471 (1985).

[3℄ M. Bernasoni, G.L. Chiarotti, P. Foher, S. Sandolo, E. Tosatti, M. Par-

rinello, J. Phys. Chem. Solids 56, 501 (1995).

[4℄ A. Alavi, J. Kohano(cid:27), M. Parrinello, D. Frenkel, Phys. Rev. Letts. 73, 2599

(1994).

33-83 (2001).

[5℄ D. Marx, M. Parrinello, J. Chem. Phys. 140, 4077 (1996).

[6℄ M.W.C. Foulkes, L. Mitas, R.J. Needs, G. Ra jagopal, Rev. Mod. Phys. 73,

[7℄ E.G.Maksimov, Yu I.Silov, Physis-Uspekhi, 42, 1121 (1999).

[8℄ M. Stadele, R.M. Martin, Phys. Rev. Lett. 84, 6070 (2000)

[9℄ K.A.Johnson, N.W.Ashroft, Nature 403, 632 (2000).

[10℄ D. Alfé, M. Gillan, M.D. Towler, R.J. Needs, (cid:16)Diamond and β -tin strutures

of Si studied with quantum Monte Carlo alulations", ond-mat/0407038.

[11℄ B.L. Hammond, W.A. Lester Jr., P.J. Reynolds (cid:16)Monte Carlo methods in Ab

Initio Quantum Chemistry(cid:17), World Sienti(cid:28) (Singapore 1994).

[12℄ R. M. Pano(cid:27), J. Carlson, Phys. Rev. Letts. 62, 1130 (1989).

[13℄ Y. Kwon, D.M. Ceperley, R.M. Martin, Phys. Rev. B 50, 1684 (1994).

[14℄ M. Dewing, D. M. Ceperley, in Reent Advanes in Quantum Monte Carlo

Methods, II (Ed. S. Rothstein), World Sienti(cid:28) 2002.

[15℄ D. M. Ceperley, M. Dewing, C. Pierleoni. Leture Notes in Physis (cid:16)Bridging

Time Sales(cid:17) , Vol 605, (Eds. P. Nielaba et al., Springer-Verlag 2003, pg. 473-

499. physis/0207006.

[16℄ C. Pierleoni, D.M. Ceperley, M. Holzmann, Phys. Rev. Lett. 93, 146402 (2004).

[17℄ S. Baroni, S. Moroni, Phys. Rev. Lett 82, 4745 (1999).

[18℄ D. M. Ceperley, Rev. Mod. Phys. 67, 279 (1995).

[19℄ D. M. Ceperley in Monte Carlo and Moleular Dynamis of Condensed Matter

Systems, (Eds. by K. Binder and G. Ciotti) Editrie Compositori, Bologna,

Italy, 1996.

(2003).

[20℄ D. M. Ceperley, M. Dewing: J. Chem. Phys. 110, 9812 (1999)

[21℄ M. Holzmann, D. M. Ceperley, C. Pierleoni, K. Esler, Phys. Rev E 68, 046707

[22℄ V. Natoli, R. M. Martin, D. M. Ceperley, Phys. Rev. Lett. 70, 1952 (1993);

ibid. 74, 1601 (1995).

[23℄ C. Lin, F. H. Zong, D. M. Ceperley, Phys. Rev. E 64, 016702 (2001).

[24℄ A. Kron, Polymer Siene 7, 1361 (1965).

[25℄ F.T. Wall, F. Mandel, J. Chem. Phys. 63, 4592 (1975).

[26℄ S. Moroni, private ommuniation.

[27℄ L.K. Gallos, P. Argyrakis, K.W. Kehr, Phys. Rev. E 63, 021104 (2001).

[28℄ J.K. Anlauf, Ph.D. dissertation, University of Cologne (1988).

[29℄ J.Kohano(cid:27), J.P.Hansen, Phys. Rev. Lett. 74, 626 (1995); Phys. Rev. E 54, 768

(1996).

