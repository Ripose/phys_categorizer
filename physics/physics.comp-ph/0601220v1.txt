6
0
0
2
 
n
a
J
 
1
3
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
0
2
2
1
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Darwin-Vlasov Simulations of magnetized
Plasmas

H. Schmitz and R. Grauer

Theoretische Physik I, Ruhr-Universit¨at Bochum, 44780 Bochum, Germany

Abstract

We present a new Vlasov code for collisionless plasmas in the nonrelativistic regime.
A Darwin approximation is used for suppressing electromagnetic vacuum modes.
The spatial integration is based on an extension of the ﬂux-conservative scheme,
introduced by Filbet et al. [23]. Performance and accuracy is demonstrated by com-
paring it to a standard ﬁnite diﬀerences scheme for two test cases, including a Harris
sheet magnetic reconnection scenario. This comparison suggests that the presented
scheme is a promising alternative to ﬁnite diﬀerence schemes.

Key words: Vlasov simulations, positive ﬂux-conservative scheme, Darwin
approximation, Boris scheme, reconnection
PACS: 02.70.-c, 52.25.Dg, 52.65.Ff, 52.25.Xz, 52.35.Vd

1 Introduction

For many interesting problems in plasma physics a deeper understanding can
only be gained with the help of kinetic plasma models. In contrast to macro-
scopic models where only the streaming velocity, pressure, temperature and
other ﬂuid quantities are considered, the kinetic description deals with the
particle distribution function f (x, v). Here x is the position in space and v is
the three dimensional velocity. The equation describing the evolution of the
six dimensional distribution function in phase space for a collisionless system
is the Vlasov equation. The complexity of kinetic plasma descriptions arises
because of the electromagnetic ﬁelds appearing in the Vlasov equation. These
depend on the charge density and current density in the plasma which are
in turn given by the moments of the distribution function. Thus the system
presents itself as a strongly coupled non–linear system of partial diﬀerential
equations. Analytical solutions of this system are only possible for a very re-
stricted number of special problems.

Preprint submitted to Elsevier Science

2 February 2008

Among the numerous problems, where collisionless kinetic plasma simula-
tions are important, we name only two topics, which are important in both
laboratory- and astrophysical settings. These are the thin current sheet region
in collisionless magnetic reconnection processes and the structure of collision-
less shocks. The Harris sheet model [1] gives a kinetic equilibrium of a current
sheet separating two regions of diﬀerent magnetic ﬁeld. While this can be for-
mulated analytically, the reconnection process, which is initiated by small per-
turbations from the Harris equilibrium, is not yet fully understood. Also, there
has been tremendous progress in the last 10 years, both on the ﬂuid level (see
[2,3,4,5,6,7]) and using kinetic simulations (see [8,9,10,11,12,13,14,15,16,17]
for Particle in Cell simulations and [18,19] for Vlasov simulations). Still many
questions remain to be solved, such as: the spontaneous onset of reconnection,
three dimensional eﬀects, turbulence in the reconnection zone, acceleration
of particles, and comparison to experiments. It has become clear that, espe-
cially for the acceleration of particles, fully kinetic models and simulations are
inevitable. Up to now most kinetic simulations make use of the Particle in
Cell method (PIC), and very few deal with a direct integration of the Vlasov
equation. In order to validate PIC simulations of collisionless magnetic recon-
nection, it is necessary to simulate the same problems using diﬀerent schemes,
and Vlasov schemes are an important alternative method.

The second important system currently investigated is the problem of colli-
sionless shocks. In the framework of MHD–equations these shocks appear as
singular points, where the macroscopic quantities show a discontinuity. To
understand the inner structure of shocks, kinetic models are necessary since
only they can describe the underlying dissipation processes. For some spe-
cial geometries together with low Mach numbers there are time independent
analytical solutions to the kinetic equations, corresponding to stable shock
conditions. For higher Mach numbers these solutions break down, and a time
dependant behaviour appears. This leads to excitation of wave modes with
a possibility of particle acceleration. This time dependant behaviour is not
accessible with analytical methods, and numerical approaches have to be at-
tempted.

As mentioned above, in practise there are two diﬀerent numerical approaches
to solving the Vlasov equation. In the Particle in Cell (PIC) approach trajecto-
ries of individual representative particles are followed through the electromag-
netic ﬁelds. The ﬁelds are given on a numerical grid, while the positions and
velocities of the simulation particles can be any value. Due to the ﬁnite num-
ber of particles, the PIC method suﬀers from considerable numerical noise. A
related problem is the fact that only those parts of the distribution function
can be calculated with high precision which contain many particles in a phase
space volume. In particular the high energy tails of the distribution function
cannot be resolved.

2

The other numerical approach integrates the Vlasov equation directly on a
high dimensional numerical grid in phase space. These Vlasov schemes do not
suﬀer from any numerical noise. The tails of the distribution function can be
modelled with high accuracy, and deviations from a Maxwellian distribution
can be pinpointed. These advantages are traded against higher computational
eﬀort of the Vlasov–codes as compared to PIC–codes. Additionally, care has
to be taken for choosing the integration scheme of Vlasov’s equation, taking
into account the hyperbolic nature and corresponding integral quantities.

The distribution function has to fulﬁl a number of restrictions which are de-
rived from its physical interpretation as probability density in phase space
and from the properties of the Vlasov equation. The probability density inter-
pretation implies that the distribution function has to remain positive at all
times. One property of Vlasov’s equation is that the values of the distribution
function are transported along the characteristics through phase space with-
out modiﬁcation. When starting from a positive distribution function this not
only implies that the positivity is preserved but also that both upper and lower
bounds of the distribution function remain unchanged, and that no new max-
ima or minima are generated. A second property of Vlasov’s equation is the
conservation of phase space density as a consequence of Liouville’s equation.

A numerical scheme cannot satisfy all the above criteria exactly. Therefore a
number of numerical schemes have been proposed, each of which is a compro-
mise between diﬀerent requirements. Spectral codes which solve the Vlasov
equation in the Fourier domain suﬀer only from little numerical diﬀusion, but
they are mostly limited to periodic boundary conditions, see e.g. [21]. Another
important drawback of these methods is that they do not preserve positivity,
let alone the number of extrema in the distribution function. Eulerian solvers,
on the other hand, allow for non–periodic boundary conditions and can be
made to preserve positivity and the maximum principle. They are, however,
slightly more diﬀusive than spectral codes. A recent comparison of Eulerian
solvers can be found in [22]. In this work we will use a ﬂux conservative and
positive scheme [23] which obeys the maximum principle and suﬀers from
relatively little numerical diﬀusion.

The integration of the Vlasov equation has to be performed simultaneously
to the evaluation of the Maxwell equations. The dynamics of the full electro-
dynamic ﬁelds imposes an additional criterion for the time step used in the
simulation. Since electromagnetic waves can travel through the system, the
time step has to be chosen such that the speed of light c is resolved on the
numerical grid: ∆t < c∆x, where ∆t is the time step and ∆x is the grid reso-
lution. One way to avoid this is to use an electrostatic model. This is, however,
only applicable in special situations where the self generated magnetic ﬁeld
can be neglected. Here we will use the Darwin approximation of Maxwell’s
equations, which follows from a rigorous expansion of the full Maxwell equa-

3

tions in orders of v2/c2, where v is a characteristic velocity of the system.
In the framework of the Darwin approximation, the purely electromagnetic
modes are neglected but electrostatic, magnetostatic, and inductive ﬁelds are
still considered. Darwin’s approximation has been widely used with Particle
in Cell simulations [24,27], however, it has not found its way into Vlasov sim-
ulations yet. An alternative method is the use of an implicit time stepping as
it has been implemented by [14] in the Celested3D code.

The next section will present the basic equations together with their nor-
malisation. In section 3 we will introduce the Darwin approximation of the
Maxwell equations. Section 4 will give an overview of the one dimensional
ﬂux conservative scheme used for integrating Vlasov’s equation, while section
5 will describe the time splitting schemes that provides the generalisation to
the 5–dimensional phase space. In section 6 results are presented, and section
7 contains some concluding remarks.

2 Basic equations

In this and the next section we want to present the basic equations and ap-
proximations of our model. The aim is to simulate Vlasov’s equation

∂fk
∂t

+ v

fk +

· ∇

(E + v

B)

vfk = 0.

×

· ∇

qk
mk

Here fk(x, v, t) is the distribution function of species k. In this work only
singly charged ions and electrons k = i, e are considered, although the code
allows arbitrary species. The quantities qk and mk are the charge and the mass
of the particles of species k. The Lorentz force depends on the electric and
magnetic ﬁelds. These are in general given by Maxwell’s equations,

(1)

(2)

(3)

(4)

,

+ j ,

∂B
∂t
∂E
∂t

ρ ,

E =

−
B = ε0

E =

1
ε0
B = 0 ,

∇ ×

1
µ0 ∇ ×

∇ ·

∇ ·

4

where B is the magnetic and E the electric ﬁeld. In section 3 we will present
the Darwin approximation of Maxwell’s equations, which is used to solve the
electromagnetic ﬁelds in our simulation code. The charge density ρ and the

current density j are given by the moments of the distribution function,

ρ =

j =

qk

qk

Z

Z

Xk

Xk

fk(x, v)d3v ,

vfk(x, v)d3v .

2.1 Normalisation

Here we want to present the normalisation of the Vlasov–Maxwell system
equations. For this we introduce normalising parameters A0, where A stands
for any of the physical quantities. The normalised quantities ˆA are then given
by ˆA = A/A0.

The un–normalised characteristics of Vlasov’s equation for species k are given
by

Here we have used the symbols x and v to denote the characteristics x =
x(t, x0, v0) and v = v(t, x0, v0). These have to be distinguished from the
independent variables x and v in Vlasov’s equation. In the following the ap-
propriate meaning should be clear from the context. The form of the above
equations is not modiﬁed by the normalisation,

Only the individual charge to mass ratios ˆqk/ ˆmk are relevant parameters of
the system. On the other hand, Maxwell’s equations simplify to

dx
dt
dv
dt

= v ,

=

qk
mk

(E + v

B) .

×

dˆx
dˆt
dˆv
dˆt

= ˆv ,

=

ˆqk
ˆmk (cid:16)

ˆE + ˆv

ˆB

.

×

(cid:17)

,

∂ ˆE
∂ˆt

ˆE =

∂ ˆB
∂ˆt

−

ˆB = α2

 
ˆE = ˆρ ,
ˆB = 0 .

∇ ×

∇ ×

∇ ·

∇ ·

+ ˆj
!

,

5

(5)

(6)

(7)

(8)

(9)

(10)

(11)

(12)

(13)

(14)

Here α = v0/c is the ratio of the normalisation velocity over the speed of light.

We choose m0 = mi and q0 = e, where mi is the ion mass and e is the unit
electron charge. B0 and n0 remain free to choose. Then x0 = λi is the ion
inertial length, t0 = 1/Ωi is the inverse ion gyro frequency (Ωi = eB
), and
mi
v0 = vA = B0/√µ0min0 is the Alfv´en velocity.

We still have the freedom of choosing the magnetic ﬁeld B0. If we choose B0
to be a characteristic magnetic ﬁeld magnitude in the system, then α gives the
ratio of Alfv´en velocity to the speed of light in the system. On the other hand
we can choose B0 such that α = 1. Then the local magnetic ﬁeld magnitude in
the system determines vA/c. In this work we will choose the ﬁrst, so that the
ﬁeld magnitude in the system remains around unity and the free parameter α
can be used to set the magnetic ﬁeld strength. In the following we will drop
the hat–notation (ˆ) for the normalised quantities.

3 Darwin approximation

The ﬂux conservative integration scheme of the Vlasov equation, which will be
presented in section 4, is not restricted by a CFL condition on the time step.
However, when combined with the Maxwell equations for the electromagnetic
ﬁelds a CFL condition is introduced by the time integration of the ﬁelds on
the numerical grid. This implies that the fastest electromagnetic wave mode,
i.e. the vacuum mode, has to be resolved on the grid,

∆t <

∆x
c

,

(15)

where c is the speed of light. This condition imposes severe restrictions on the
time step. In many applications the electromagnetic vacuum modes are not
important. The standard solution to this problem is the electrostatic approx-
imation. In this approximation only Poisson’s equation needs to be solved for
the electric ﬁeld. A magnetic vacuum ﬁeld can also be superimposed. The in-
ﬂuence of the plasma on the magnetic ﬁeld is, however, completely neglected.
To account for this inﬂuence, and thus the possibility of magnetosonic wave
modes, the Darwin approximation is commonly used in particle simulations.
This approximation can be derived from the Maxwell equations in an ex-
pansion in orders of v2/c2, where v is some characteristic velocity. Assuming
v2
c2 this leads to a set of equations where the vacuum modes are elimi-
nated but all other wave modes are retained. Darwin’s approximation can be
used when the velocities are small compared to the speed of light and there
is no energy transported by the electromagnetic radiation. Some applications
are the study of magnetic reconnection, e.g. in the earths magnetotail [25],
or the investigation of high intensity charged particle beams [26]. Naturally
it is not capable of describing phenomena where the electromagnetic vacuum
modes play a major role, e.g. in laser–plasma interaction.

≪

6

(16)

(17)

(18)
(19)
(20)
(21)

Darwin’s approximation starts from a separation of the electric ﬁeld into a
longitudinal and a transverse part [27]

with

E = EL + ET ,

EL = 0

and

ET = 0 .

∇ ·

∇ ×

The normalised Maxwell’s equations are then approximated by

EL = ρ ,
B = 0
ET =
∂tB ,
B = α2 (∂tEL + j) .

−

∇ ·
∇ ·
∇ ×
∇ ×

The approximation only appears in eq (21), where only the longitudinal part
of the displacement current is taken. All other equations remain unchanged.
In vacuum, equations (20) and (21) are now decoupled and no purely electro-
magnetic modes can appear.

An advantage of using Darwin’s approximation instead of the full Maxwell
equations is the fact, that the equations can be solved without performing a
time integration step. All the electromagnetic ﬁelds can be calculated from
the moments of the distribution at a given time together with the boundary
conditions for the ﬁelds. This will be presented in the following.

Poisson’s equation for the electrostatic potential

∆Φ =

ρ with EL =

−

Φ

−∇

immediately gives the longitudinal electric ﬁeld. Taking the curl of (21), to-
gether with (17) and (19, results in

∆B =

α2

j ,

−

∇ ×

giving three Poisson equations for the components of the magnetic ﬁeld. To
calculate ET the curl of eq (20) is taken and eqs (21) and (17) substituted,
giving

∆ET = ∂t∇ ×
= α2∂tj

B

− ∇
To eliminate the time derivative of the current density, j is expressed as mo-
ment of the distribution function,

(cid:17)

α2∂ttφ
(cid:16)

.

(22)

(23)

∂tj =

qk

v∂tfk d3v.

Xk

Z

7

Here the index k sums over all particle species. Now, Vlasov’s equations for
the diﬀerent species are substituted,

∂tj =

vv

ρkh

ik +

qkρk
mk

E +

qkρk
mk h

v

ik ×

B .

−

Xk

Xk

Xk ∇
.
Here the pointed brackets
ik denote averaging with the distribution function
fk. The electric ﬁeld appearing on the right hand side is, of course, comprised
of the longitudinal and the transverse part. While the longitudinal component
is already known from the charge density, it is the transverse component that
is being calculated here. Inserting ∂tj into eq (23) and introducing the local
plasma frequency

h

ω2 =

qkρk
mk

,

Xk

(24)

this leads to

∆ET −
−

α2ω2ET =
vv
ρkh

Xk ∇

ik +

qkρk
mk

EL +

qkρk
mk h

v

B

ik ×

− ∇

α2∂ttφ
(cid:16)

.

(25)

Xk

Xk
This equation is a Helmholtz–equation for each component of ET . The last
ET = 0,
term on the right hand side can be deduced from the condition
since it only adds a curl free component to ET . It can thus be omitted to
calculate ˜ET , with

∇ ·

(cid:17)

∆˜ET −

α2ω2 ˜ET =

−

Xk ∇

vv

ρkh

ik +

Xk

qkρk
mk

EL +

qkρk
mk h

v

ik ×

B .

Xk

˜ET is then projected onto its divergence free part by calculating Θ with ∆Θ =

˜ET to give ET = ˜ET − ∇

Θ.

∇ ·

Altogether this sums up to 8 elliptic equations. However, the time spent in
solving these equations, compared to the integration of the 5 or 6 dimensional
problem, is negligible. This situation is diﬀerent in PIC simulations. One has
to compare about 30 particles per cell used in standard PIC simulations to 103
- 303 mesh points for the resolution of the velocity space used in Vlasov codes.
For this reason the computational eﬀort of solving the above elliptic equations
has an eﬀect on the total computational time in standard PIC simulations,
but not in Vlasov simulations.

4 Flux Conservative Scheme

In this section we brieﬂy present the numerical scheme used for integrating
the Vlasov equation. This scheme has originally been presented in Filbet et

8

al. [23]. The scheme uses a ﬂux conservative formulation and is based on a
third order reconstruction of the primitive of the distribution function using
a ﬁxed stencil.

To formulate the scheme we start from the observation that in Hamiltonian
systems the values of the distribution function are transported along the char-
acteristics

f (ξ, t) = f (X(s, t, ξ), s).

(26)

Here X(s, t, ξ) denotes the characteristic with parameter s that satisﬁes
X(t, t, ξ) = ξ, where in general ξ = (x, v). For the rest of this section, we
restrict the calculations to one dimension. The generalisation to the higher
R. Then we can
dimensional system will be given later. We thus assume ξ
integrate (26) and obtain a propagator from time tn to time tn+1

∈

xi+1/2

Zxi−1/2

X(tn,tn+1,xi+1/2)

Z
X(tn,tn+1,xi−1/2)

f (x, tn+1) dx =

f (x, tn) dx.

(27)

Here xi−1/2 and xi+1/2 are the boundaries of the numerical grid cell i. The dis-
cretisation of the distribution function is now suggested by the above equation.
The values f n
i on the numerical grid represent the cell integrals

We also deﬁne the ﬂux through a cell boundary at xi+1/2 during the time
interval [tn; tn+1]

f n
i =

1
∆x

xi+1/2

Zxi−1/2

f (x, tn) dx.

xi+1/2

Φn

i+1/2 =

f (x, tn) dx

Z
X(tn,tn+1,xi+1/2)

Then equation (27) can be expressed in the following form

i = Φn
f n+1

i−1/2 + f n

Φn

i+1/2.

i −

(28)

This equation still follows exactly from Vlasov’s equation. However, the ﬂux
Φ has to be calculated, and this requires an approximation of the distribution
function.

In the framework of the third order positive and ﬂux conservative scheme, as
presented by [23], the primitive of the distribution function is approximated
using a four point stencil. Let

F (x, tn) =

f (x′, tn) dx′,

(29)

x

x0

Z

9

(30)

(31)

(32)

(33)

then it follows exactly that

F (xi+1/2, tn) = ∆x

i

Xk=0

f n
k ≡

F n
i .

The primitive is given exactly on the cell boundaries. To approximate F (x, tn)
in the cell interval [xi−1/2; xi+1/2], the four points
xi−3/2, xi−1/2, xi+1/2, xi+3/2}
are used. Taking the derivative of the primitive, we recover the approximation
of the distribution function

{

f≈(x) = fi +

ǫ+
i
6∆x2
x
−
ǫ−
i
6∆x2
x

(cid:16)

−

(cid:16)

+

−
+

xi−3/2

2 (x
h
xi−1/2

−

xi)

x

x
(cid:16)
−

−
xi+1/2

(cid:17)

(fi+1 −

fi)

2 (x

xi)

x

(cid:17)i
xi+3/2

−
xi+1/2

x

(cid:16)
−

(cid:17)

(fi −

(cid:17)i

fi−1) .

(cid:17) (cid:16)

−

(cid:17) (cid:16)

h
xi−1/2

Here limiters ǫ±
limit the values of the distribution function to a ﬁxed interval 0
where f∞ is the maximum of all fi. The ǫ±
i can be written as

i are introduced. The limiters are chosen in such a way as to
f∞,

f≈(x)

≤

≤

and

ǫ+
i =

min(1; 2fi/(fi+1 −
min(1; 2(f∞

fi))
fi)/(fi −

−

fi+1))

if fi+1 −
if fi+1 −

fi > 0
fi < 0

ǫ−
i =

min(1; 2(f∞
min(1; 2fi/(fi−1 −

fi)/(fi −
fi))

−

fi−1))

if fi −
if fi −
X(tn, tn+1, xi+1/2) < xj+1/2, we get

fi−1 > 0
fi−1 < 0

.











If we determine j such that xj−1/2 ≤
δ)
Φi+1/2 = (1

−

h

fj + (1/6)δ(δ + 1)ǫ+(fj+1 −
2)ǫ−(fj −

(1/6)δ(δ

−

−

fj)

where δ = X(tn, tn+1, xi+1/2)

xj−1/2.

−

fj−1))

+ ∆x

max(i,j)−1

(34)

fk,

i

Xk=min(i,j)+1

5 Time splitting and integration of characteristics

The above scheme was presented in one dimension. To perform two dimen-
sional Vlasov–simulations including magnetic ﬁelds, the scheme has to be gen-
eralised to a total of 5 dimensions. Califano et al. [28] proposed a scheme in
which the individual steps for the diﬀerent dimension are carried out using a

10

second order time splitting scheme. The scheme is an extension of the time
splitting scheme presented by Cheng and Knorr [29]. For the two spatial di-
rections x and y, the projection of the characteristics onto the axes is simply
evaluated from by the corresponding velocity components vx and vy. In this
way, the two space dimensions are independent of each other and can be per-
formed sequentially,

Tx = TxTy
(35)
where Tk denotes a time–integration step in one dimension with the direction
k. In contrast to this, the velocity components are not independent of each
other due to the magnetic ﬁeld. To create a second order scheme Califano et
al. [28] formulated a straightforward second order time splitting scheme,

Tv(∆t) = Tvx(

)Tvy(

)Tvx(

)Tvz(∆t)Tvx(

)Tvy(

)Tvx(

(36)

∆t
4

∆t
2

∆t
4

∆t
4

∆t
2

∆t
4

).

This propagator in the velocity directions was then combined with the prop-
agator in the space directions to create the full scheme,

Tfull(∆t) = Tx(∆t/2)Tv(∆t)Tx(∆t/2).

(37)

In the following we will refer to this method as the time splitting method.

We implemented and tested this scheme, but found it to suﬀer from substantial
inaccuracies, as shown in section 6.1. Therefore, a new scheme for the inte-
gration is proposed in this work which we call the back substitution method.
Here, the integration of Vlasov’s equation in the three velocity dimensions is
still split into three separate steps, one for each direction. The diﬀerence to
the above scheme is the way the integration of the characteristics is separated
out into the three substeps. This implies that the concrete implementation
of the scheme proposed here depends on the method of integration of the
characteristics. We will therefore quickly present Boris’ scheme for integration
of characteristics in a magnetic ﬁeld [27,30,31]. Boris’ scheme is widely used
in Particle codes and has the advantage that it is a second order integration
scheme in which the magnetic ﬁeld does not cause a change in the kinetic en-
ergy. The integration step is formulated as an implicit ﬁnite diﬀerence scheme

vn+1 + vn
−
∆t
2
The electric and magnetic forces are separated,

q
m  

vn+1

E +

vn

=

B.

!

×

leading to

v− = vn +

v+ = vn+1

∆t
2

q
m
∆t
2

E,

q
m

−

E,

v+

v−

−
∆t

=

q
2m

v+ + v−
(cid:16)

(cid:17)

B.

×

11

(38)

(39)

(40)

(41)

The transformation from v− to v+ is a pure rotation with an angle θ, where

tan
(cid:12)
(cid:12)
(cid:12)
(cid:12)
To implement this rotation the vectors t and s are deﬁned
(cid:12)

=

.

∆t
2

qB
m

θ
2 (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

Then the rotation is performed in two steps

t =

∆t
2

qB
m

,

s =

2t
1 + t2 .

v′ = v− + v−

t

×

(42)

(43)

(44)

and

This scheme supplies vn+1 = (vn+1

v+ = v− + v′
, vn+1
y

×
, vn+1
z

x

s.
) in terms of vn = (vn

(45)
z ).

x , vn

y , vn

For the integration of Vlasov’s equation in three dimensional velocity space the
three individual integration steps are performed in turn, thus, the integration
of the characteristics also has to be split into three separate steps. For this,
two things have to be considered. Firstly, when integrating one component
of the velocity, we take into account the shifts of the distribution function
that have already been performed. Secondly, we then have to observe the
order of integration, which is reversed with respect to the integration of a
particle trajectory. This follows from the fact that, for the Vlasov scheme, the
characteristics have to be traced backwards in time.

x

(vn

x , vn

y , vn

For clarity, we will present the back substation method for forward integra-
tion of the characteristics. Later, we will reverse the order of the substeps for
the backward integration needed in the Vlasov scheme. For forward integra-
tion, ﬁrst, the integration in vx is performed, as described in the discussion
of Boris’ scheme above. For the integration of the characteristics this means
vn+1
x = vn+1
z ). When the integration along the vy–direction is per-
formed, in the next step, the shift along the vx–direction has already been
performed. For the integration of the characteristics this means that a scheme
calculating vn+1
z ) is needed. In the above notation, it is
suﬃcient to reformulate the integration to give v+
y (v+
z ). This can
be achieved using simple algebraic manipulations and eliminating v−
x . For the
last integration step along the vz–direction, one can ﬁnd in the same manner
a scheme giving v+
z ). The details of this scheme are presented
in appendix A. The scheme has also been implemented and it was found to
be less diﬀusive than the second order time splitting scheme (see section 6.1).
As stated above, the characteristics have to be traced backwards in time. To
this end, we reverse the order of integration, without changing the above for-
mulas; i.e. we ﬁrst shift the distribution function in the vz–direction using

y = vn+1

z = v+

y = v+

y , v−

x , v−

y , v−

(vn+1
x

x , v+

z (v+

y , vn

, vn

y

12

z (v+

z = v+
v+
ﬁnally in the vx–direction using vn+1

y = v+
z ), then in the vy–direction using v+
y , vn
z ).

x = vn+1

x , v+

x , vn

(vn

x

y , v−

y (v+

x , v−

y , v−

z ), and

i and ǫ−

The splitting of the integration into individual steps introduces another prob-
lem, independent of the splitting scheme used. The limiters ǫ+
i guar-
antee only that the distribution function is positive and limited by f∞ from
above for incompressible transport equations. The Vlasov equation together
with any set of equations for the electromagnetic ﬁelds presents such a sys-
tem. Due to the separation of the integration along the diﬀerent directions
in velocity space together with the forces originating from the magnetic ﬁeld,
the single integration steps are, however, not incompressible. This holds for
both the splitting and the back substitution scheme. The ﬁrst direction of
integration might compress the distribution function in the vx direction, while
the successive integrations decompress the distribution function in the vy and
vz directions. In the end the total compression will always vanish. The max-
imum value of the distribution function might however increase during an
intermediate step.

We present two types of calculations. In the ﬁrst we omit the limiter from
above completely, allowing the distribution function to rise uncontrollably.
The limiters ǫ+

i are then given by

i and ǫ−

and

ǫ+
i =

min(1; 2fi/(fi+1 −

1


fi))

if fi+1 −
if fi+1 −

fi > 0
fi < 0

ǫ−
i =


1
min(1; 2fi/(fi−1 −




fi))

if fi −
if fi −

fi−1 > 0
fi−1 < 0

.

(46)

(47)



This means, the maximum principle, that was fulﬁlled by the original scheme,
is now no longer satisﬁed. In the second type of simulation we keep the original
limiters (32) and (33) but determine f∞ to be the global maximum of the
distribution function after each intermediate integration step for each direction
in velocity space.

6 Numerical tests

The third order positive ﬂux conservative method has been extensively tested
in one dimension and in the electrostatic limit [23]. Here, we ﬁrst want to
present results of the integration scheme in three dimensional velocity space
with a given magnetic ﬁeld. We compare the results of the two integration
schemes and a standard second order ﬁnite diﬀerence scheme. The latter is
included in the comparison since it has been used for Vlasov simulations of
reconnection by various authors.

13

In the second part of this section we present results of reconnection simula-
tions. These have been carried out using both the ﬂux conservative scheme
with the back substitution method and the ﬁnite diﬀerence scheme. Results
of the two are compared.

6.1 Gyro motion

To test the quality of the Vlasov integration scheme together with the inte-
gration of the characteristics a simple test system was simulated. In this test
only one positively charged species was simulated in a constant magnetic ﬁeld
B = B0ez, with B0 = 1. The initial distribution function was taken to be a
shifted Maxwellian

v0)2

,

−

(v

f (x, v) = exp

(48)
h
where v0 = v0ex is a constant velocity in the x–direction. There was no spatial
variation, and so a simple gyro motion of the thermal peak in velocity space
is expected. However, due to numerical errors this peak will change its shape.
These numerical errors only appear in the presence of a magnetic ﬁeld. In the
pure one dimensional advection problem only small errors compared with the
exact solution are found.

−

i

We have simulated the gyro motion of a thermal peak using the two diﬀerent
integration methods for the characteristics, diﬀerent time steps, and vary-
ing resolutions of the grid in the velocity dimensions. Additional simulations
have been carried out using a simple ﬁnite diﬀerence scheme. The scheme is
obtained from eq (2) by substituting all partial derivatives by their centred
ﬁnite diﬀerence approximation over one grid cell. A third order Runge-Kutta
method is used for the time step. In Figure 1 the vx–vy distribution function is
shown for the case of Nv = 30 and ∆t = 2πΩc/200 using the ﬂux conservative
scheme with the back substitution algorithm for integration of the character-
istics. The z–scaling is arbitrary but identical in the three sub–plots of Figure
1. Initially (a), the distribution function is set to the shifted Maxwellian. At
t = 2πΩc (b), the peak has performed one full gyration. A slight dissipa-
tion can be observed. The dissipation has increased after ﬁve gyration periods
t = 10πΩc (c). With the above time step, this correspond to a total of 1000
time steps.

(v

The dissipation in phase space can be quantiﬁed by taking the second moment
2 which represents the
)2
of the distribution function
i
thermal energy in the system. These have been calculated over a time of
ﬁve gyro–periods for diﬀerent simulation time steps, diﬀerent grid resolutions
of the phase space, and diﬀerent time splitting algorithms. In Figure 2 the
thermal energies are shown for both the back–substitution algorithm (upper
panel) and for the time splitting algorithm (lower panel), both taken without

i − h

− h

v2

=

v

v

h

i

i

h

14

Fig. 1. Gyration of a Maxwellian peak using the back-substitution algorithm with
Nv = 30 and ∆t = 2πΩc/200 (a) initially, (b) after one gyration period and (c) after
ﬁve gyration periods. The scale on the z–axis is in arbitrary units but identical in
the three diagrams.

limiting the distribution function from above. For a small time step ∆t =
0.01Ωc/π, i.e. a time–resolution of 200 time steps per gyration, calculations
using Nv = 10 and Nv = 30 grid points per velocity dimension have been
carried out. In the case of Nv = 10 and using the back–substitution algorithm,
the thermal energy rises more than a factor of 4.5 during the simulated time
period. The amount of diﬀusion can be reduced considerably by increasing the

15

t=0.01W
t=0.01W
t=0.1W
t=0.1W
t=0.1W

C / p
C / p
C / p
C / p
C / p

  Nv=10
  Nv=30
    Nv=10
    Nv=30
    Nv=60

t=0.01W
t=0.01W
t=0.1W
t=0.1W
t=0.1W

C / p
C / p
C / p
C / p
C / p

  Nv=10
  Nv=30
    Nv=10
    Nv=30
    Nv=60

3

2

væ

 
 
2æ
v

0
0

10

5

4

2

1

8

6

4

2

0
0

2

væ

 
 
2æ
v

1

2

3

4

5

t / W

C

1

2

3

4

5

t / W

C

2 during ﬁve
Fig. 2. The thermal energy of the distribution function
i
gyro–periods for diﬀerent time–steps and diﬀerent phase space resolutions. The
upper panel shows the curves resulting from the back–substitution algorithm, the
lower panel those resulting from the time splitting algorithm. No limiting from above
was applied

v
i − h

v2
h

grid resolution. At Nv = 30, the increase in thermal energy reduces to around
20% over the simulated ﬁve gyro–periods.

For Nv = 10, an increase in the time step by a factor of 10 does not modify the
results by a great amount. The already large diﬀusion values remain similar
although somewhat lower. In contrast, for the Nv = 30 case, the thermal
energy at the end of the simulation is risen only by less than 5% from the
starting value, for a time step of ∆t = 0.1Ωc/π, i.e. 20 time steps per gyration.

16

Æ
-
Æ
D
D
D
D
D
Æ
-
Æ
D
D
D
D
D
This means that an increase in the time steps leads to better results for the
thermal energy. An increase in grid resolution further improves the result and
reduces the error to less than 2%.

The results using the time splitting scheme (lower panel of Figure 2) diﬀer
considerably from the previous results. Again, the thermal energy in the small
time step case with Nv = 10 rises strongly. This now gets substantially less
accurate by increasing the time step to 20 steps per gyration. Here, the thermal
energy increases by more than a factor of 12! The best result is achieved by
taking a small time step and a grid resolution of Nv = 30. Instead of a slight
increase in thermal energy, a slight decrease can be observed here. Increasing
the time step to 20 steps per gyration degrades the results again. A strong
increase in the thermal energy is observed, which is even worse for higher grid
resolutions.

In Figure 3 the same results are shown again, but this time with the lim-
iting from above switched on. These results diﬀer only marginally from
those obtained without the limiter in place. Note, that the limiter ensur-
ing positivity of the distribution function is always in place. Summarising,
one ﬁnds that the back–substitution method gives superior results over the
time–splitting method. Furthermore in terms of thermal energy, the back–
substitution method rewards larger time steps (i.e. less computational time)
with higher accuracy.

Instead of looking at the thermal energy, which is related to dissipation in
phase space, one can also investigate the gyro–motion of the Maxwellian peak.
From the distribution function the averages
are taken and plotted
against each other through time. In the exact case, this should result in per-
fectly circular motion with exactly one turn during a gyration period 2π/ΩC.
The numerical Vlasov scheme does not, however, produce exact results and
thus one will observe some form of spiral. An example of this spiral is plotted
in Figure 4.

vxi

vyi

and

h

h

After some time one can observe errors in both the absolute magnitude of
the velocity and in the phase of the gyro–motion. For the same parameters
as above, the magnitude of the velocity after ﬁve gyro–periods is given in
table 1, for the various schemes and numerical parameters. Table 2 shows the
corresponding phase errors in radians.

The back–substitution shows better results both for the large and the small
time steps than the time splitting method. The best overall result is achieved
by the back–substitution method in conjunction with a small time step and a
grid resolution of Nv = 30. Only a marginal phase error can be observed. There
is almost no error in the average velocity. A decrease of the grid resolution

17

t=0.01W
t=0.01W
t=0.1W
t=0.1W
t=0.1W

C / p
C / p
C / p
C / p
C / p

  Nv=10
  Nv=30
    Nv=10
    Nv=30
    Nv=60

t=0.01W
t=0.01W
t=0.1W
t=0.1W
t=0.1W

C / p
C / p
C / p
C / p
C / p

  Nv=10
  Nv=30
    Nv=10
    Nv=30
    Nv=60

3

2

væ

 
 
2æ
v

0
0

10

5

4

2

1

8

6

4

2

0
0

2

væ

 
 
2æ
v

1

2

3

4

5

t / W

C

1

2

3

4

5

t / W

C

2 during ﬁve
Fig. 3. The thermal energy of the distribution function
i
gyro–periods for diﬀerent time–steps and diﬀerent phase space resolutions. The
upper panel shows the curves resulting from the back–substitution algorithm, the
lower panel those resulting from the time splitting algorithm. Limiting from above
was applied

v
i − h

v2
h

results in a positive phase error and a decrease of the velocity magnitude error.
In contrast, an increase of the time step causes a rise in the velocity magnitude
together with an increase of the phase error. Here now, an increase in the grid
resolution from 30 to 60 does not improve the results when using a large time
step. For a resolution of 10 and a large time step only the phase error increases.
One can note, that in all these cases the phase error is negative. This means
that the simulated gyro motion always lags behind the physical gyro motion.

18

Æ
-
Æ
D
D
D
D
D
Æ
-
Æ
D
D
D
D
D
t = 10  p / W

C

t = 0

y

v

0

1

0.5

-0.5

-1

-1

-0.5

0.5

1

0
vx

vxi
Fig. 4. The gyro-motion of the Maxwellian peak expressed in
h
over ﬁve gyro–periods. After ﬁve gyro–periods the mean velocity has an error in
magnitude and phase from the starting value.

against

vyi
h

Back Substitution

Splitting

Finite Diﬀ.

∆t

Nv

limiter no limiter

limiter

no limiter

2nd order

4th order

π/100

π/100

π/10

π/10

10

30

10

30

0.8892

0.9178

1.0843

1.0496

1.09933

1.04747

0.9981

0.9991

1.2029

1.2021

0.998163

0.999867

1.1100

1.1082

2.1824

2.0992

unstable

unstable

1.1301

1.1328

2.9553

2.9452

unstable

unstable

60

1.1209

1.1190

π/10
Table 1
Magnitude of the Maxwellian peak after ﬁve gyro–periods for diﬀerent time–steps,
diﬀerent phase space resolutions and diﬀerent integration methods. The magnitudes
are normalised to the initial height of the peak.

unstable

unstable

4.0402

4.0757

The errors in phase and velocity magnitude are generally larger when using the
time splitting method. With the large time step the magnitude of the velocity
goes up by approximately 2 to 4 times the initial velocity. The velocity error
is lower when using the small time step; however, for the high resolution the
error is still 20%. Only the low resolution, large time step case has a relatively
small error in the magnitude. This is accompanied by a large error in phase.
For resolutions 30 and 60 the phase error is better than the one found with

19

Back Substitution

Splitting

Finite Diﬀ.

∆t

Nv

limiter

no limiter

limiter

no limiter

2nd order

4th order

π/100

π/100

π/10

π/10

10

30

10

30

0.04214

0.06544

0.1512

0.1363

2.05693

1.99755

-0.04178

-0.03969

-0.01143

-0.01341

2.07876

2.10456

-0.2500

-0.2349

0.6331

0.6002

unstable

unstable

-0.08965

-0.09051

0.09543

0.08768

unstable

unstable

60

-0.09232

π/10
Table 2
Phase error of the Maxwellian peak after ﬁve gyro–periods for diﬀerent time–steps,
diﬀerent phase space resolutions and diﬀerent integration methods.

unstable

unstable

-0.09244

0.05441

0.05011

the back–substitution method. The error in the velocity magnitude here is on
the other hand, unacceptable. In both cases one ﬁnds that switching on the
limiter does not modify any of these results considerably.

Finally, comparing this with the results from the ﬁnite diﬀerence scheme one
ﬁnds that the ﬂux conservative approach is far superior in all cases. Although
the ﬁnite diﬀerence schemes show small amplitude errors, phase errors are se-
rious. In addition, for the large time steps the ﬁnite diﬀerence scheme becomes
completely unstable (in agreement with the CFL condition).

6.2 Reconnection

A test of the complete Vlasov–Darwin system has been performed on a mag-
netic reconnection setup, including full ion and electron dynamics. As pointed
out in the introduction, research on magnetic reconnection is still one the most
challenging topics in collisionless plasmas. Kinetic simulations using a Vlasov
code have been carried out, for example by Silin and B¨uchner [18]. Since these
simulations were carried out using a ﬁnite diﬀerence scheme, we will here again
present the results of both ﬁnite diﬀerence and the ﬂux conservative scheme.
We used a simulation box consisting of 50x100 grid cells in space with a grid
spacing of ∆x = 0.1. The total size of the simulation box is Lx = 10 by
Ly = 5. There are 10x10x10 grid cells in velocity space. Although the resolu-
tion in velocity space is — as shown above — insuﬃcient for the gyro motion,
especially for the ﬁnite diﬀerence scheme, this low resolution is chosen for a
number of reasons. Firstly, it keeps the computational eﬀort to a reasonable
magnitude. Secondly, this corresponds to the phase space resolution chosen
by Wiegelmann and B¨uchner [19] and thus allows some comparison. Thirdly,
we think that the pure gyro motion test is a very strict test for the numerical
scheme. In the most regions of the reconnection simulation, the magnetic ﬁeld
is balanced by some electric ﬁeld or by the density gradient in such a way that

20

FD 2nd Order
FD 4th Order
PFC

2.5

1.5

2

1

0.5

0

0

5

10
t  / W

i

15

20

Fig. 5. The reconnected magnetic ﬂux Φ over time. The solid line is the result of
the second order ﬁnite diﬀerence scheme. The dashed line is the result of a fourth
order ﬁnite diﬀerence scheme. The dashed–dotted line is the result from the ﬂux
conservative scheme.
the gyro motion does not occur the way as presented in the previous section.
The mass ratio between electrons and ions has been chosen to mi/me = 16
and the time step is

∆t = 2.5

10−3 =

·

1
25Ωce

,

where Ωce is the electron Larmor frequency in the unit magnetic ﬁeld. Simu-
lations with half this time step have been performed as convergence test (not
shown here) but no substantial deviations have been found.

The initial conditions are chosen as two opposite current sheets. Each cur-
rent layer has the well known Harris sheet proﬁle [1] together with a small
perturbation. The distribution function is given by a shifted Maxwellian

fi,e(x, y) = ρ(x, y) exp

mj
2kTj

 

x + v2
v2
(cid:16)

y + (vz −

v±
0 )2

,

!

(cid:17)

with v±

0 =

±

1. The particle density ρ(x, y) is given by

ρ(x, y) =

1

−

cosh

y
(cid:16)(cid:16)

1 + ε cos(

y±
0

/λ

 

2π(x

x±
0 )

−
Lx

)

.

!

(cid:17)
The two Harris sheets, positioned at y+ = Ly/4 and y− = 3Ly/4, carry op-
posite current, and the perturbations have a relative shift along the x–axis

(cid:17)

(49)

(50)

(51)

21

F
Fig. 6. The out of plane magnetic ﬁeld component Bz in the simulation box at
t = 4.1 using the back–substitution method (upper panel) and at t = 3.1 using the
ﬁnite diﬀerence scheme in 2nd order (middle panel) and 4th order (lower panel).
of π/Lx, given by x+ = 0 and x− = 1/2. The perturbation has a value of
ε = 0.05. Periodic boundary conditions are used both in the x and y direc-
tion. The X–points will then develop at X + = (5, 1.25) and X − = (0, 3.75).

Figure 5 shows the temporal evolution of the reconnected ﬂux. The curves
are quite similar keeping in mind that the resolution is marginal. The major
diﬀerence is the slightly earlier onset of reconnection for the ﬁnite diﬀerence
runs.

If one wants to compare the schemes, one has to choose the time for the dif-
ferent simulations separately such that the reconnected ﬂux is the same for all

22

(j
in the simulation box at t = 4.1
Fig. 7. The magnitude of the Hall term
|
using the back–substitution method (upper panel) and at t = 3.1 using the ﬁnite
diﬀerence scheme in 2nd order (middle panel) and 4th order (lower panel).

B)z|

×

simulations. Therefore, we choose a time at the beginning of the reconnection
phase which corresponds to t = 4.1 for the ﬂux conservative method and to
t = 3.1 for the ﬁnite diﬀerence schemes.

Figure 6 shows the perpendicular magnetic ﬁeld Bz. The upper panel shows the
result of the ﬂux conservative simulation while the mid and lower panel display
the results of the ﬁnite diﬀerence schemes (mid: second order, lower: fourth
order). One can clearly see the quadrupolar structure of the magnetic ﬁeld
component at the X–point which has been observed in previous simulations of
the reconnection process. There is a slight diﬀerence in the distribution of the

23

magnetic ﬁeld component between the simulations. One signiﬁcant diﬀerence
is the magnitude of Bz. The values are considerably larger in the second order
ﬁnite diﬀerence scheme than in the ﬂux conservative scheme and fourth order
ﬁnite diﬀerence scheme.

B)z|
In Figure 7 the magnitude of the z–component of the Hall-term
is shown for the diﬀerent schemes. This quantity can be taken as a measure
for the importance of the Hall term when comparing to MHD models. All
simulations show qualitatively a similar behaviour. From the results of the
ﬂux conservative simulation one can see that the z–component of the Hall
term is largest outside of the X–points.1

×

(j

|

7 Conclusions

A 5 dimensional Vlasov code using the Darwin approximation of Maxwell’s
equations has been presented. While in the past a lot of development has gone
into developing numerical schemes for one dimensional electrostatic Vlasov
codes, there is a growing need for kinetic codes that include the eﬀects of the
magnetic ﬁeld. This is needed for both the simulation of astrophysical as well
as laboratory plasmas. For a large number of problems the electromagnetic
vacuum modes contained in the full set of Maxwell equations is not of major
importance for the physical processes. These, however, pose severe restric-
tions on the simulation parameters, due to the CFL criterion. The Darwin
approximation resolves this problem by eliminating the vacuum modes with-
out reverting to the electrostatic limit. In contrast to other approximation of
Maxwell’s equations, the Darwin approximation can be shown to consistently
0/c2. The Darwin
emerge from an expansion of the full equations in orders of v2
approximation has been used extensively in particle in cell simulations but has
not found it’s way into Vlasov codes until now. Within the framework of the
Darwin approximation the purely electromagnetic modes are cancelled, but
the modes that rely on the plasma reaction to the magnetic ﬁeld are retained,
such as the magnetosonic or Alfv´en modes.

For the integration of the Vlasov equation in time a recently developed ﬂux
conservative scheme [23] has been used. The scheme, which was originally pro-
posed for a one dimensional electrostatic system had, to be generalised for the
higher dimensional phase space required for the Vlasov–Darwin system. The
generalisation of the one dimensional system is ambiguous and two diﬀerent
schemes have been compared: the straightforward time splitting scheme [28]
using a generalised time splitting iteration was shown to suﬀer from substan-
tial inaccuracies; the back substitution scheme, proposed in this work, gives
far better results not only in terms of an accurate reproduction of the gyro
motion but also concerning the controllability of the errors. Results were also

24

compared to ﬁnite diﬀerence simulations which were shown to be greatly in-
accurate in comparison to the ﬂux conservative scheme.

Finally, a simulation of magnetic reconnection has been performed to test the
full Vlasov–Darwin system. For comparison, the same system has also been
simulated using the ﬁnite diﬀerence scheme. The ﬁnite diﬀerence scheme has
been chosen as a reference scheme since this is the most common approach for
simulation magnetic reconnection using a Vlasov code. Substantial improve-
ments were achieved using the code presented here. The results especially of
derived quantities, did not suﬀer from numerical ﬁne scale distortions. It was
shown that the results of the scheme presented here can be treated as much
more reliable that those of a ﬁnite diﬀerence scheme.

The code presented here may be used for the investigation of magnetic recon-
nection processes and for the simulation of nonrelativistic collisionless shocks.
The main advantages, as compared to PIC simulations, is the absence of nu-
merical noise and the access to the full distribution function, especially the
high energy tails. In PIC simulations these high energy tails generally suﬀer
from bad statistics. For this reason it might be of interest to use Vlasov codes
to simulate particle acceleration.

One should note however that, because of the large computational time, the
applicability of Vlasov codes at this time stays restricted to two dimensional
models. Again, in comparison to PIC codes, Vlasov codes are slower by a fac-
tor of a hundred. Despite this comparatively large numerical eﬀort, Vlasov
simulations are still valuable since they complement other simulation tech-
niques.

Acknowledgements

We acknowledge interesting discussions with J. B¨uchner, J. Dreher and R.
Sydora. This work was supported by the SFB 591 of the Deutsche Forschungs-
gesellschaft. Access to the JUMP multiprocessor computer at Forschungszen-
trum J¨ulich was made available through project HBO20.

A Back–Substitution Method for Integration of Characteristics

Here we present the formulae for the integration of the characteristics in the
velocity space using the back–substitution method. The three integrations in
vx, vy and vz–direction are carried out individually. The underlying equations
have been presented in section 5 but are in an implicit form for our purpose.

25

(A.1)
(A.2)
(A.3)

(A.4)
(A.5)
(A.6)

(A.8)

(A.9)

Here we want to give explicit formulae for the three steps

Since the bijections between vn and v− on one hand and vn+1 and v+ on the
other hand are trivial (see eqs (39) and (40)) it is suﬃcient to formulate the
three steps

x

vn+1
x = vn+1
y = vn+1
vn+1
z = vn+1
vn+1

y

z

(vn
x , vn
(vn+1
x
(vn+1
x

y , vn
z ),
y , vn
, vn
, vn+1
y

z ),
, vn

z ).

x = v+
v+
v+
y = v+
z = v+
v+

x (v−
y (v+
z (v+

x , v−
x , v−
x , v+

y , v−
z ),
y , v−
z ),
y , v−
z ).

By virtue of equations (44) and the x–component of (45), vx is already given
in the above form. The integration in vx is identical to the integration used in
the time splitting algorithm.

In the second integration step v+
The y–component of equation (45) gives v+
x–component of that equation can now be solved for v−

y has to be determined from (v+
y (v−

y , v−
x to give

y = v+

x , v−

y , v−
x , v−
z ).
z ). However, the

x = v−
v−

x (v+

x , v−

y , v−

z ) =

1
Ax (cid:16)

v+
x −

v−
y (sz + sytx)

v−
z (sy −

−

sztx)

,

(A.7)

(cid:17)

with

With this we get

Ax = 1

syty −

−

sztz

y (v+
v+

x , v−

y , v−

z ) = v+

y (v−

x (v+

x , v−

y , v−

z ), v−

y , v−
z ).

In the same manner the z–component of equation (45) gives v+
y , v−
x , v−
z (v−
v+
to solve for v−

z =
z ). Then the x and the y–components of that equation are used
x and v−

y

(1

−

v−
x =

sxtx −
(1
−

sztz) (v+
syty −

x + (sy −
sztz)(1
−

sztx)v−
v+
(sz + sytx)
z )
y −
(cid:16)
sztz) + (sz + sytx)(sz −
sxtx −

−

(sz −

v−
y =

sxty) (v+

sztx)v−

x + (sy −
syty −

sztz)(1

−

z ) + (1
sxtx −

syty −

v+
sztz)
y −
−
(cid:16)
sztz) + (sz + sytx)(sz −

(1

−

(sx + szty)v−

z

sxty)

(A.10)
(sx + szty)v−

z

,

(cid:17)

.

(cid:17)

sxty)

(A.11)

26

Inserting this into v+
y , v−
z (v+
v+
z ).

x , v+

z (v−

x , v−

y , v−

z ) then provides the expression for v+

z =

References

[1] E. G. Harris, On a plasma sheath separating regions of oppositely directed

magnetic ﬁeld, Il Nuovo Cimento 23 (1962) 115.

[2] D. Biskamp, E. Schwartz, and J. F. Drake, Two ﬂuid theory of collisionless

magnetic reconnection, Phys. Plasmas 4 (1997) 1002.

[3] R. F. Lottermoser and M. Scholer, Undriven magnetic reconnection in
magnetohydrodynamics and Hall Magnetohydrodynamics, J. Geophys. Res.
102 (1997) 4875.

[4] M. A. Shay and J. F. Drake, The role of electron dissipation on the rate of
collisionless magnetic reconnection, Geophys. Res. Lett. 25 (1998) 3759.

[5] M. A. Shay, J. F. Drake, B. N. Rogers, and R. E. Denton, Alfv´enic collisionless

magnetic reconnection and the Hall term, J. Geophys. Res. 106 (2001) 3759.

[6] X. Wang, A. Bhattacharjee, and Z. W. Ma, Scaling of Collisionless Forced

Reconnection, Phys. Rev. Lett. 87 (2001) 265003.

[7] J. D. Huba and L. I. Rudakov, Hall Magnetic Reconnection Rate, Phys. Rev.

Lett. 93 (2004) 175003.

[8] J. B¨uchner and J.-P. Kuska, Sausage mode instability of thin current sheets as

a cause of magnetospheric substorms, Ann. Geophys. 17 (1999) 64.

[9] R. Horiuchi and T. Sato, Three-dimensional particle simulation of plasma
instability and collisionless reconnection in a current sheet, Phys. Plasmas 6
(1999) 4565.

[10] P. L. Pritchett, Geospace Environment Modeling magnetic reconnection
challenge: Simulation with a full particle electromagnetic code, J. Geophys.
Res. 106 (2001) 3783.

[11] P. L. Pritchett, Collisionless magnetic reconnection in a three-dimensional open

system, J. Geophys. Res. 106 (2001) 25961.

[12] M. Hesse, M. Kuznetsova, and J. Birn, Particle-in-cell simulations of three-
dimensional collisionless magnetic reconnection, J. Geophys. Res. 106 (2001)
29831.

[13] R. Sydora, Nonlinear dynamics of small-scale magnetic islands in high

temperature plasmas, Phys. Plasmas 8 (2001) 1929.

[14] P. Ricci, G. Lapenta, and J. U. Brackbill A Simpliﬁed Implicit Maxwell Solver,

J. Comp. Phys. 183 (2002) 117.

27

[15] P. Ricci, G. Lapenta, and J. U. Brackbill, GEM reconnection challenge: Implicit
kinetic simulations with the physical mass ratio, Geophys. Res. Lett. 29 (2002)
2088.

[16] A. Zeiler, D. Biskamp, J. F. Drake, B. N. Rogers, M. A. Shay, and M. Scholer,
Three-dimensional particle simulations of collisionless magnetic reconnection,
J. Geophys. Res. 107 (2002) 1230.

[17] M. Scholer, I. Sidorenko, C. H. Jaroschek, R. A. Treumann, and A. Zeiler Onset
of collisionless magnetic reconnection in thin current sheets: Three-dimensional
particle simulations, Phys. Plasmas 10 (2003) 3521.

[18] I. Silin, J. B¨uchner, Kinetic instabilities of thin current sheets: Results of two-
and-one-half-dimensional Vlasov code simulations, Phys. Plasmas 10 (2003)
1299.

[19] T. Wiegelmann, J. B¨uchner, Evolution of magnetic helicity in the course of
kinetic magnetic reconnection, Nonlinear Processes in Geophysics 8 (2001) 127.

[20] J. Birn, J. F. Drake, M. A. Shay, B. N. Rogers, R. E. Denton, M. Hesse, M.
Kuznetsova, Z. W. Ma, A. Bhattacharjee, A. Otto, P. L. Pritchett, Geospace
Environmental Modeling (GEM) magnetic reconnection challenge, J. Geophys.
Res. 106 (2001) 3715.

[21] T. P. Armstrong, R. Harding, G. Knorr, D. Montgomery, Solution of Vlasov’s
equation by transform methods, Advances in Computational Physics 9 (1976)
29.

[22] T. Arber, R. G. L. Vann, A critical comparison of Eulerian grid based Vlasov

solvers, J. Comp. Phys. 180 (2002) 339.

[23] F. Filbet, E. Sonnendr¨ucker, P. Bertrand, Conservative numerical schemes for

the Vlasov equation, J. Comp. Phys. 172 (2001) 166.

[24] C. W. Nielson, H. R. Lewis, Particle–code models in the nonradiative limit,

Meth. Comput. Phys. 16 (1976) 367.

[25] P. L. Pritchett, F. V. Coroniti, R. Pellat, H. Karimadbadi Collisionless
reconnection in two-dimensional magnetotail equilibria J. Geophys. Res. 96
(1991) 11523.

[26] W. W. L. Lee, E. Startsev, Qin Hong, R. C. Davidson Electromagnetic (Darwin)
model for three-dimensional perturbative particle simulation of high intensity
beams. PACS2001, Proceedings of the 2001 Particle Accelerator Conference,
IEEE Part vol. 3 (2001) 1906

[27] C. K. Birdsall, A. B. Langdon, Plasma Physics via Computer Simulation,

McGraw-Hill, New York, 1985.

[28] F. Califano, A. Mangeney, C. Cavazzoni, P. Travnicek, A numerical scheme
for the integration of the Vlasov–Maxwell system of equations, in: Science and
Supercomputing at CINECA, 2001, p. 456.

28

[29] C. Z. Cheng, G. Knorr, The integration of the Vlasov equation in conﬁguration

space, J. Comp. Phys. 22 (1976) 330.

[30] O. Buneman, Time reversible diﬀerence procedures, J. Comp. Phys. 1 (1967)

517.

[31] J. P. Boris, Relativistic plasma simulation-optimization of a hybrid code, in:

Proc. Fourth Conf. Num. Sim. Plasmas, Vol. 3, 1970, p. 67.

29

