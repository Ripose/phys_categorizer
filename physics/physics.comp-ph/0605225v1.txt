6
0
0
2
 
y
a
M
 
5
2
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
5
2
2
5
0
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Worm Algorithm and Diagrammatic Monte Carlo: A New Approach
to Continuous-Space Path Integral Monte Carlo Simulations

M. Boninsegni,1 N.V. Prokof’ev,2, 3, 4 and B.V. Svistunov2, 4
1Department of Physics, University of Alberta, Edmonton, Alberta T6G 2J1
2Department of Physics, University of Massachusetts, Amherst, MA 01003, USA
3BEC-INFM, Dipartimento di Fisica, Universita di Trento, Via Sommarive 14, I-38050 Povo, Italy
4Russian Research Center “Kurchatov Institute”, 123182 Moscow, Russia

A detailed description is provided of a new Worm Algorithm, enabling the accurate computation
of thermodynamic properties of quantum many-body systems in continuous space, at ﬁnite temper-
ature. The algorithm is formulated within the general Path Integral Monte Carlo (PIMC) scheme,
but also allows one to perform quantum simulations in the grand canonical ensemble, as well as to
compute oﬀ-diagonal imaginary-time correlation functions, such as the Matsubara Green function,
simultaneously with diagonal observables. Another important innovation consists of the expansion
of the attractive part of the pairwise potential energy into elementary (diagrammatic) contributions,
which are then statistically sampled. This aﬀords a complete microscopic account of the long-range
part of the potential energy, while keeping the computational complexity of all updates independent
of the size of the simulated system. The computational scheme allows for eﬃcient calculations of
the superﬂuid fraction and oﬀ-diagonal correlations in space-time, for system sizes which are orders
of magnitude larger than those accessible to conventional PIMC. We present illustrative results for
the superﬂuid transition in bulk liquid 4He in two and three dimensions, as well as the calculation
of the chemical potential of hcp 4He.

PACS numbers: 75.10.Jm, 05.30.Jp, 67.40.Kh, 74.25.Dw

I.

INTRODUCTION

It is now twenty years since Ceperley and Pollock (CP)
carried out the ﬁrst Path Integral Monte Carlo (PIMC)
simulation of the superﬂuid transition of liquid 4He.1 Al-
beit restricted to a system of 64 4He atoms with periodic
boundary conditions, that study demonstrated the fea-
sibility of ab initio numerical studies of quantum many-
body systems, the mass of the particles and the interac-
tion potential being the sole input to the calculation.

The PIMC method,

in the form developed by CP
(henceforth referred to as “conventional”), has since
played a major role in the theoretical investigation of
quantum many-body systems. Not only has it provided
quantitative results for a wide range of physical systems,
it has also shaped, to some extent, our qualitative un-
derstanding of such phenomena as superﬂuidity (SF) and
Bose condensation, at the microscopic level. At least for
Bose systems, PIMC is the only presently known method
capable of furnishing in principle exact numerical esti-
mates of physical observables at ﬁnite temperature (T ),
including the superﬂuid (ρs) and condensate (n◦) frac-
tions. Moreover, despite the notorious sign problem,
that has so far made it impossible to obtain equally high
quality results for Fermi systems, PIMC proves a valid
option in this case as well, allowing one to obtain approx-
imate estimates of accuracy at least comparable to that
aﬀorded by the other leading methods.2,3

It thus seems reasonable to regard PIMC as the most
realistic option to investigate ever more complex quan-
tum many-body systems, and it makes sense to try and
overcome its most important present limitations. Aside
from the above-mentioned sign problem, which we do not

discuss in this paper, the main bottleneck of the current
PIMC technology is inarguably the maximum system size
(i.e., number N of particles) for which accurate estimates
can be obtained, in a reasonable amount of computer
time. Speciﬁcally, the computational eﬀort required to
study properties that most directly depend on particle in-
distinguishability, is observed to scale prohibitively with
N .

For example, the superﬂuid fraction ρs is obtained in
a PIMC simulation of bulk condensed matter, by means
of the so-called winding number estimator,5 which can
only take on a nonzero value if long permutation cycles
of identical particles occur. In conventional PIMC, the
frequency with which such cycles are sampled, is an ex-
ponentially decreasing function of N . For this reason,
and in spite of (at least) a hundredfold increase in com-
puter speed,4 since the pioneering work of Ref. 1 it has
not proven possible to obtain estimates of the superﬂuid
fraction in bulk liquid 4He for ﬁnite systems of more than
N =64 particles. Besides the unfavorable scaling of com-
puting resources as a function of N , another major is-
sue that this entails is the diﬃculty of assessing reliably
whether the observed absence of long permutation cy-
cles reﬂects a genuine physical eﬀect, or merely lack of
ergodicity of the path sampling scheme.6

How important is the above size limitation ? For
most observables diagonal in the coordinate represen-
tation, one can often approach surprisingly closely the
thermodynamic limit by simulating as few as ∼ 30 parti-
cles, especially for systems characterized by short-ranged,
Lennard-Jones-type interactions. On the other hand,
an accurate quantitative characterization of the super-
ﬂuid transition (including the calculation of the transi-

tion temperature Tc) can only be obtained via ﬁnite-size
scaling analysis of results for ρs(T ) and/or n◦(T ). The
reliability of this procedure crucially hinges on the avail-
ability of data for large systems of signiﬁcantly diﬀerent
sizes. Attempts to estimate Tc for superﬂuid 4He, based
on PIMC data for ρs(T ) for systems of size N =64 and
smaller, failed to yield quantitative results.7

But there are other reasons, arguably more important
than the mere pursuit of numerical accuracy, pointing to
the importance and timeliness of extending by one or two
orders of magnitude the size of the systems accessible to
PIMC. Quite generally, in order for a scientiﬁc question
to be meaningfully addressed by numerical simulations,
the size of the simulated system should be greater than
all characteristic length scales aﬀecting the physics of in-
terest. This is particularly important in the study of in-
homogeneous phases of matter, or ﬂuids in conﬁnement,
or restricted geometries. An example is provided by the
study of helium ﬂuid in porous glass, such as Vycor; the
diameter of a characteristic pore is of the order of a few
tens of ˚A. Thus, a realistic calculation, at the typical liq-
uid helium density, requires that one be able to simulate
a system comprising several thousands of atoms. Other
examples are the numerical investigations of multicompo-
nent systems, as well as of grain boundaries, dislocations
and other defects in quantum solids, or of incommensu-
rate phases of ﬁlms of helium or para-hydrogen adsorbed
over substrates such as graphite.

Over the past two decades, there has been relatively
little experimentation with approaches to PIMC simula-
tions diﬀering in some important aspects from the con-
ventional one of CP, thoroughly described in Ref. 2. As
mentioned above, in conventional PIMC the simulation
of properties that are most directly aﬀected by quan-
tum statistics (i.e., by many-particle permutations), is
aﬀected by a very unfavorable scaling of required com-
puter time with system size. This hurdle seems diﬃcult
to conquer within conventional PIMC, and more gener-
ally within any Monte Carlo scheme formulated in the
canonical ensemble, in which the winding number be-
comes “topologically locked” in the N → ∞ limit.2

On the other hand, the same hurdle has been com-
pletely overcome in Quantum Monte Carlo (QMC) simu-
lations of lattice models. A lattice Path Integral scheme
based on an alternative sampling approach, known as
worm algorithm (WA),8 has been demonstrated to allow
for eﬃcient calculations of winding numbers and of the
one-particle Green function G, for systems of as many as
∼ 106 particles.9 It is particularly useful for the studies of
critical phenomena since it does not suﬀer from the criti-
cal slowing down problem10 present in other local-update
schemes.

The WA has been recently extended to the study of
systems in continuous space;11 it has ﬁrst been shown
to aﬀord the simulation of the superﬂuid transition in
liquid 4He in two dimensions, for systems comprising as
many as 2500 particles, i.e., about 100 times greater than
those accessible to conventional PIMC. Subsequently, it

2

has been applied to the study of Bose condensation in
crystalline 4He,12 as well as to the investigation of super-
ﬂuid properties of para-Hydrogen droplets.13

In all of these applications, the WA has provided ac-
curate numerical results, simply not obtainable with any
other existing method. It need be stressed, however, that
the WA is not merely about doing large system sizes
(important as this is); it is also the ﬁrst grand canon-
ical QMC method with local updates to incorporate in
full quantum statistics. It aﬀords the exact computation
of imaginary-time oﬀ-diagonal correlations, such as the
one-particle Matsubara Green function, that are not ac-
cessible to conventional PIMC (nor to any other QMC
technique in continuous space).

In this paper, we provide a detailed description of
this new, powerful computational tool, which promises
to open novel avenues to the theoretical exploration of
strongly correlated many-body system. The manuscript
is organized as follows:
in the next section (II), we de-
scribe the simplest implementation of the WA, also intro-
ducing our nomenclature, conﬁgurational space and data
structure. In section III, we discuss in detail the compu-
tation of the Matsubara Green function, as well as of its
equal-time limit, namely the one-particle density matrix.
In section IV, we describe an important enhancement
of the simple implementation, namely the expansion of
(the attractive part of) the potential energy of interaction
among particles in elementary (diagrammatic) contribu-
tions, that are then sampled by a Monte Carlo method.
This scheme, which falls in the general category of Dia-
grammatic Monte Carlo techniques,14 allows for the full
inclusion of the contribution of the potential energy (for
an important class of potentials) at a computational cost
that is independent of the size of the system.

In Sec. V, we provide some quantitative information
related to the speciﬁc utilization of the WA in simulation
studies of superﬂuid 4He. In Sec. VI, we oﬀer a quantita-
tive demonstration of the power of the WA, by illustrat-
ing in detail our results for simulations of the superﬂuid
transition of liquid 4He in two and three dimensions. We
outline our conclusions, and discuss outlook for future
applications of the WA, in Sec. VII.

II. SIMPLEST VERSION

We begin with some basic notation. We assume for
deﬁniteness a system of identical particles (in d dimen-
sions) obeying Bose statistics.15 Let m be the mass of
each particle. The system is enclosed in a cubic vessel
of volume V = Ld, with periodic boundary conditions
in all directions (other geometries, boundary conditions,
and/or external forces require obvious and minimal mod-
iﬁcations which are standard for any QMC scheme).

We make from the outset the assumption of working in
the grand canonical ensemble; that is, the system is held
in thermal equilibrium with a heat reservoir at tempera-
ture T = 1/β (we set kB=1), with which it can exchange

particles as well. Consequently, in order to specify the
thermodynamic state of the system, we need to assign
the chemical potential µ, which is an input parameter in
our computational scheme, just like the temperature T .
The number of particles N is allowed to ﬂuctuate.

Let ˆH be the (many-body) system Hamiltonian, which

we assume of the following form:

ˆH = −λ

∇2

i +

v(|ri − rj|) ,

(2.1)

N

Xi=1

Xi<j

where λ = ¯h2/2m and where v is a pairwise interaction
potential that depends only of the relative distance be-
tween any two particles.16 Below, R will always be used
as a collective “coordinate”, representing positions of all
particles in the system, i.e., R ≡ (r1, r2, . . . , rN ).

with

A. Conﬁgurational Space

A fundamental aspect of the WA, which crucially dis-
tinguishes it from conventional PIMC and from all ex-
isting QMC methods in the continuum, is that it op-
erates in an extended conﬁgurational space, containing
both closed world line conﬁgurations (henceforth referred
to as Z- or diagonal conﬁgurations), as well as conﬁg-
urations containing one open world line (worm). The
Z-conﬁgurations contribute to the partition function,
whereas those with an open world line contribute to the
one-particle Matsubara Green function; in the following,
the latter will be referred to as G- (or, oﬀ-diagonal) con-
ﬁgurations. As we shall see, all topologically non-trivial
modiﬁcations of world lines occur in the oﬀ-diagonal con-
ﬁgurational space (or, G-sector). The sampling process
allows for transitions from the G- to the Z-sector (by
closing, or removing the existing open world line) and
vice versa (by creating a new open world line, or by
opening an existing closed one). Expectation values of
all physical quantities of interest (with the exception of
the Green function), including particle and winding num-
bers, are only updated when the random walk generates
a diagonal conﬁguration.

Next, we proceed to describe in detail the two sectors
in which our conﬁguration space is conceptually divided.

1. The Z-sector

The Z-sector of our conﬁguration space, is nothing
but the full conﬁguration space of conventional PIMC.
It naturally emerges from the Path Integral representa-
tion of the grand partition function Z = Tr e−β ˆK, where
ˆK = ˆH − µ ˆN .

Each Z−conﬁguration is a discrete imaginary-time
many-particle path, X ≡ (R0, R1, R2, . . . , RP ), with
RP ≡ R0 (except for a possible permutation of particle
labels), representing the integrand in the asymptotically

3

exact (in the P → ∞ limit) integral decomposition of Z

Z ≈

eβµN

dX A(X, ε) e−U(X) ,

(2.2)

∞

XN =0

where dX ≡ dR0dR1...dRP −1, ε = β/P , and where

A(X, ǫ) ≡

ρF (Rj, Rj+1, ε) .

In turn, ρF is a product of free-particle imaginary-time
propagators, i.e., with an obvious notation,

ρF (Rj, Rj+1, ǫ) =

ρ◦(rij , ri,j+1, ε)

(2.3)

Z

P −1

Yj=0

N

Yi=1

ρ◦(r, r′, ǫ) = (4πλǫ)−d/2 exp
(cid:20)

−

(r − r′)2
4λǫ

.

(cid:21)

(2.4)

The function U in Eq. (2.2) incorporates correlations,
both in space and in imaginary time, arising from inter-
actions among particles. U is chosen so that, in the ε → 0
limit, the distribution of discrete paths X will asymp-
totically approach the correct continuous limit. Several
choices are possible2 for U , but the simplest version of
the algorithm described in this section does not depend
on its particular form. In what follows, we refer to the
product W (X) ≡ A(X, ε) e−U(X) as a conﬁgurational
weight.

Eq. (2.2) implies the following conﬁguration space
structure: one has N single-particle paths (world lines),
labeled i = 1, 2, . . . , N , propagating in the discretized
imaginary time interval [0, β] (speciﬁcally, t0 = 0, tP =
β). Each world line consists of P successively linked
“beads” (particle positions), labeled by the index of the
corresponding imaginary time “slice”, j = 0, . . . , P − 1.
The j-th bead of the i-th world line is positioned at rij .
As a result of β-periodicity, coupled with the physi-
cal indistinguishability of particles, the (P − 1)-st bead
of each world line must be linked to the zero-th bead of
either the same, or another world line. For both theoret-
ical and practical (data structure) purposes, it is advan-
tageous to guarantee β-periodicity automatically; to this
aim, we regard world line conﬁgurations as closed loops
on a (d + 1)-dimensional surface of a (d + 2)-dimensional
β-cylinder, on which lie P equidistant (and equivalent)
imaginary time “hyperplanes” (corresponding to the dif-
ferent time slices), labelled j = 0, . . . , P − 1. It should be
noted that the total number of world line loops deﬁned
on the β-cylinder can be diﬀerent from the total num-
ber of particles; this is because a single world line which
“winds around” the imaginary time interval l times be-
fore returning to its initial position represents not just
one particle, but rather l particles involved in the same
exchange cycle. The presence of such exchange cycles is
essential, in order to incorporate in the computational
scheme the symmetry of the system with respect to par-
ticle permutations.

2. The G-sector

In accordance with Eq. (2.7), the simplest estimators in
WA are [assuming that conﬁgurations are sampled from
the probability density W (X)]

The G-sector of our conﬁgurational space comes from
the representation—analogous to that of the partition
function, Eq. (2.2)—of the one-particle Matsubara Green
function

g(r1, r2, τ )
Z

,

G(r1, r2, τ ) = h T { ˆψ(r1, τ ) ˆψ†(r2, 0)} i ≡

(2.5)
where h. . .i denotes thermal averaging, T is the time-
ordering operator and ˆψ†(r, τ ) and ˆψ(r, τ ) are (Bose)
particle creation and annihilation operators in Matsubara
representation. The structure of the integral representa-
tion of g(r1, r2, τ ) is very similar to that of Z. In fact, the
only qualitative diﬀerence of a G-sector (“oﬀ-diagonal”)
conﬁguration from a diagonal one, is that the former con-
tains a worm, that is, a world line on a β-cylinder with
two ends—the “head” and the “tail”—corresponding to
the Green function annihilation and creation operators,
respectively. The two special beads at the open world line
ends are named (for historical reasons) Ira (I) and Masha
(M). Conﬁgurations in which I and M are located in
space-time at points (rI , τI ) and (rM, τM) contribute to
g(rI , rM, τI − τM) with the weight deﬁned in accordance
with Eq. (2.2) generalized to include the oﬀ-diagonal con-
ﬁguration sector.

Formally, the ensemble of WA conﬁgurations corre-

sponds to the generalized partition function

ZW = Z + Z ′ ,

(2.6)

with

Z ′ = C

Z

XjI ,jM

drI drM g(rI, rM, ε(jI − jM)) . (2.7)

The value of dimensionless parameter C only aﬀects the
eﬃciency of the simulation, as C controls the relative
statistics of Z- and G-sectors; for the moment, we leave
it undetermined, to come back to it later on, when dis-
cussing updates.

An important new feature that arises when going from
Z to ZW , is that the number of continuous variables in
G-sector conﬁgurations is not constant, but rather varies
from conﬁguration to conﬁguration. This immediately
points to Diagrammatic Monte Carlo,14 as a general way
to perform updates whenever the number of variables to
sample, is itself variable.

The sampling of paths {Xl}, is implemented within
the WA exclusively through a set of simple, local space-
time updates involving I (or, M). The particle number
becomes conﬁguration- and time-dependent (there is one
less particle between I and M, than in the rest of the
path). This clearly shows how, by its very construction,
the WA opens up the possibility of working in the grand
canonical ensemble, with the chemical potential µ being
an input parameter.17 Obviously, WA updates can be
combined with the conventional PIMC updates to have
the most ﬂexible scheme.

4

(2.8)

(2.9)

δ(Z) =

1 ,
0 ,

(cid:26)

if in Z-sector ,
if in G-sector ,

δ(G) =

0 ,
1 ,

if in Z-sector ,
if in G-sector .

(cid:26)

In the statistical limit, their Monte Carlo averages are

h δ(Z)iMC = Z/ZW ,

(2.10)

h δ(G)iMC =

dr1 dr2 g(r1, r2, εj) ,

(2.11)

CP
ZW

P −1

Z

Xj=0

where V is the system volume. In particular

h δ(G)iMC
h δ(Z)iMC

P −1

Z

Xj=0

= CP

dr1 dr2 G(r1, r2, εj) .

(2.12)

The simplest estimator for g(r, τ ), τ = εj, is given by

h δ(G) δj, (jI −jM) δ(r1 − rI ) δ(r2 − rM) iMC =
CP
ZW

g(r1, r2, εj) .

=

(2.13)

However, below we introduce a more elaborated scheme
which allows one to circumvent the problem of working
with generalized functions (typically solved by collecting
statistics to ﬁnite-size spatial bins at the expense of an
additional systematic error).

B. Data Structure and Updates

In this section, we describe a set of ergodic local up-
dates which sample the extended conﬁguration space,
switching between the Z- and G-sectors. Updates which
change the number of continuous variables in X, are ar-
ranged in complementary pairs, designed so as to satisfy
the requirement of detailed balance. General principles of
balancing complementary pairs can be found in Ref. 14.
We have three pairs of updates altogether: Open/Close,
Insert/Remove, and Advance/Recede. Only the Swap up-
date in the list below does not fall in this category, be-
cause it preserves the number of variables, i.e., it is self-
complementary. Proposed updates are either accepted or
rejected based on the Metropolis algorithm, according to
the standard procedure.18

In order to keep the presentation simple, the sampling
scheme described below is one in which every update can
be proposed, regardless of its applicability to the cur-
rent conﬁguration (for example, the proposal to Remove
the worm is allowed even if there is no worm in the cur-
rent conﬁguration, in which case the proposed update will

j+2

j+1

j

j -1

j -2

next2 (α)

α

prev (α)

next(α)

prev2 (α)

FIG. 1: World line beads on the β-cylinder and nearest neigh-
bor associations between them.

necessarily be rejected). It should be understood, how-
ever, that standard sampling tricks can be used, whereby
only applicable updates are proposed, thereby enhancing
the performance.19

To be speciﬁc, let us adopt the following data struc-
ture: all beads are labeled, and each bead is linked to
its two world-line neighbors, the next and the previous
beads on the β-cylinder, see Fig. 1. It proves convenient
to introduce two functions, ’next’ and ’prev’, mapping
each bead onto its next and previous neighbor, respec-
tively. Correspondingly, σ = nextm(α) means that the
bead σ is the result of the m-fold application of ’next’ to
the bead α; likewise, α = prevm(σ).

In order to have an eﬃcient spatial addressing of beads,
and thus a scalable algorithm (i.e., one in which the num-
ber of operations required to perform updates does not
depend on either system size, nor temperature), we use
nearest-neighbor tables at all imaginary time slices.20
That is, for each time slice, the volume of the system
is hashed into equal microscopic “bins”, labeled by the
discrete time label, j = 0, 1, 2, . . . , (P − 1), and discrete
radius vector, ~R. [In practice, we set the bin volume, Ω,
to be of the order of the volume per particle.] For each
bin there is a list of all beads contained in it. Accord-
ingly, addressing/searching relevant beads is performed
through nearest-neighbor tables and next/previous links.
(1a) Open. The update is only possible if the conﬁgu-
ration is diagonal. A bead α is selected at random. An in-
teger number M is selected at random within the interval
[1, ¯M ] with ¯M < P being an arbitrary algorithm param-
eter. Then, (M − 1) beads, namely, next1(α), next2(α),
. . . , next(M−1)(α) are removed, so that a worm appears
with I = α and M = σ ≡ nextM (α). The acceptance
probability for this update is

Pop = min

1,

C ¯M Nbd e∆U−µMε

(cid:26)

ρ◦(rα, rσ, M ε) (cid:27)

,

(2.14)

where ∆U = U (X) − U (X ⋆) is the diﬀerence between
the U -function values for the initial (X) and proposed

5

(X ⋆) conﬁgurations, Nbd is the total number of beads in
the initial diagonal conﬁguration equal to the number of
particles, N , times the number of slices, Nbd = N P . If
M = 1, then no beads are removed; only the link between
the beads α and σ disappears with the appearance of I
and M.

(1b) Close. This update is only possible if the con-
ﬁguration is oﬀ-diagonal. Let the integer M ≥ 0 be
the discrete algebraic distance from I to M, understood
as a number of time-slice steps—in the positive direc-
tion on the β-cylinder—one has to make to reach the
slice at which M is currently positioned, starting from
If M > ¯M or M = 0, then the move is
that of I.
rejected,19 otherwise, one proposes to generate a piece
of world line connecting I to M, thereby rendering the
conﬁguration diagonal. If M > 1, the corresponding spa-
tial positions of new (M − 1) beads, r1, r2 . . . , rM−1, are
sampled from the product of M free-particle propagators
M
ν=1 ρ◦(rν−1, rν , ε), where r0 ≡ rI and rM ≡ rM. The

probability of accepting the move is
Q

Pcl = min

1,

(cid:26)

ρ◦(rI , rM, M ε) e∆U+µMε
C ¯M Nbd

,

(cid:27)

(2.15)

where Nbd is the number of beads in the ﬁnal diagonal
conﬁguration.
In our implementation, proposed Open
and Close updates are automatically rejected whenever
the quantity

(rI − rM)2
4M λǫ

is larger than some (arbitrary) number of order unity, so
as to avoid small acceptance ratios in the close update
when the worm ends are far away in space (in our simu-
lations we set this number equal to 4).

(2a) Insert. The other way to create an oﬀ-diagonal
conﬁguration from a diagonal one, besides Open, is to
seed a new, M -link long, open world line. The number
of links 1 ≤ M ≤ ¯M and the position of M in space-
time are selected at random. The spatial positions of
the other M beads are generated from the product of
M free-particle propagators. The move is accepted with
probability

Pin = min{1, C V P ¯M e∆U+µMε} ,

(2.16)

where V is the volume of the system, as mentioned above.
(2b) Remove. The removal of the worm, i.e., of the
world line connecting M to I, is proposed, provided its
algebraic length is 1 ≤ M ≤ ¯M . (If M > ¯M , the proposal
is rejected.19) The acceptance probability for the move is

Prm = min{1, e∆U−µMε/CV P ¯M } .

(2.17)

At this point, we are in position to discuss the value of the
constant C, which up to now we have left undetermined.
A natural choice is

C = C0/V P ¯M , C0 ∼ O(1) ,

(2.18)

I

ζ

j

j

so that the probabilities to Open, Close, Insert, or Re-
move a worm, do not contain macroscopically large/small
factors, and are of order unity at the optimal choice of
¯M . Normally, optimal ¯M is such that the time ε ¯M is of
the order of the characteristic single-particle time, which
guarantees that the exponentials in the acceptance prob-
abilities are of order unity, while the propagators are of
the order of the particle number density. This implies
the following scaling:

_
j+M

C ∝

ε2
V β

.

(2.19)

(3a) Advance. This move advances I by a random
number M of slices forward in time. Its implementation
is similar to that of Insert. The acceptance probability
is

Pad = min{1, e∆U+µMε}

(2.20)

(3b) Recede. Now I is displaced backwards in time
(again, in a β-periodic sense), by erasing M consecutive
links; the number 1 ≤ M ≤ ¯M is selected at random.
The acceptance probability is

_
j+M

Pre = min{1, e∆U−µMε}

(2.21)

If M turns out to be equal to or larger than the number
of links in the worm, the update is rejected.19

(4) Swap. This update is applicable to oﬀ-diagonal
conﬁgurations only and is illustrated in Fig. 2. Let I be
positioned on the j-th slice in the bin ( ~RI , j). Consider
the (j + ¯M )-th slice (because of β-periodicity, this ad-
dition is understood modulo P ) and create a temporary
list, LI, of all the beads that are contained, at the slice
j + ¯M , in the bins that spatially coincide with the bin
( ~RI , j) or with one of its nearest neighbors.21 Select one
bead, α, from the list, with the probability

Tα = ρ◦(rI , rα, ¯M ε)/ΣI ,

(2.22)

where

ΣI =

ρ◦(rI , rσ, ¯M ε)

(2.23)

Xσ∈LI

is the normalization factor.
If any of the beads α,
prev1(α), prev2(α), . . ., prev ¯M (α) coincides with M, the
move is rejected. Next, consider the bead ζ = prev ¯M (α)
and identify its bin, ( ~Rζ , j). One must now check
whether the bead α is contained in the bin spatially co-
inciding with ( ~Rζ , j), or with one of its nearest neigh-
bors; if that is not the case, the move is rejected. A
second list is then created, Lζ, of beads contained in
the ( ~Rζ, j + ¯M ) bin and in its nearest neighboring ones.
At this point, a set of new positions between beads α
and I is generated (in the same way as in the Close
move), r1, . . . , r ¯M−1 for the beads prev1(α), prev2(α),
. . ., prev( ¯M −1)(α), respectively. One may now rename I

α

α

6

ζ

I

FIG. 2: An illustration of the Swap update and the notation
introduced in the main text.

into ζ, and vice versa, and re-link beads in the following
manner: former prev( ¯M +1)(α) becomes prev(I), etc. As
a result of this world-line reconnection, a piece of world
line between the original bead ζ and the bead α is erased,
while a new piece of world line appears that connects the
former bead I with the bead α. The move is accepted
with probability

Psw = min{1, e∆U ΣI /Σζ} .

(2.24)

Here Σζ is deﬁned similarly to ΣI in Eq. (2.23) using the
Lζ-list.

The Swap move generates all possible many-body per-
mutations through a chain of local single-particle up-
dates. Since no two particles need be brought within

a distance of the order of the hard core of a typical in-
teratomic potential potential, this move enjoys a high ac-
ceptance rate, similar to that for the Advance/Recede up-
dates (we provide a quantitative example of acceptance
ratios measured in simulations of the two-dimensional
4He liquid below).
It must be emphasized that in our
algorithm, unlike in conventional PIMC, arbitrary per-
mutations of identical particles, as well as macroscopic
exchange cycles need not be explicitly sampled. For, they
appear automatically, if the physical conditions warrant
them. This is because the statistics of the relative po-
sitions for the worm ends is given exactly by the Green
function G(r1, r2, τ ).

In a typical sweep, a worm is created (either by opening
an existing closed world line, or by inserting a new one),
advances and/or recedes in imaginary time and performs
a number of swaps, until it ﬁnally closes or is removed. It
is easy to convince oneself that, as a result of this proce-
dure, an exchange cycle involving a macroscopic number
of particles can appear in just one sweep.

Since the complementary pairs are detail-balanced, the
ﬁnal results do not depend on the global probability of
addressing each pair, so long as the probabilities of ad-
dressing each update within a complementary pair are
equal, which is assumed in the acceptance probabilities
presented above. Otherwise, the acceptance probabilities
should be modiﬁed as follows:
if the probability to ad-
dress update A is uA and the probability to address a
complementary update is uB then PA → PA(uB/uA).

As noted in the Introduction, the description of WA
given above is complete even without expansion of the
pairwise potential tail into diagrams (described below).
In the original version of the code we did not use this eﬃ-
ciency enhancing modiﬁcation of the conventional PIMC
conﬁguration space, and still were able to perform accu-
rate studies of several hundred atoms. Since expansion
into diagrams works only for the attractive part of the
potential it can not be used for purely repulsive models.

III. PHYSICAL ESTIMATORS

The statistical estimators for all physical quantities
that are computed in the Z-sector, including those of
all energetic and structural properties, are identical with
those utilized in conventional PIMC. We therefore refer
the reader to Ref. 2 for a detailed discussion of these esti-
mators. Instead, we focus our discussion here on the esti-
mator that is a characteristic feature of the WA, namely
that of the Matsubara Green function.

Z

Xξ0

1
¯M Xξ0,j0

Z

where

A. Green function and density matrix estimators

Since the Green function is sensitive only to relative
distances in time, without loss of generality we can ﬁx
jM = 0 to simplify the notation. For an extra simplic-
ity, we will also assume that at least one of the following

7

two statements is true: (i) The problem is translation-
ally invariant in the coordinate space. (ii) The quantity
of interest is the Green function averaged over spatial
translations,

¯G(r, τ ) = V −1

dr′ G(r + r′, r′, τ ) .

(3.1)

Z

In both cases we can formally ﬁx rM = 0. [The general-
ization of the treatment to the case of two independent
spatial coordinates is straightforward.]

Consider the conﬁgurations, or path-integral diagrams,

Dξ(rI , jI ) contributing to the function g(r, εj):

g(rI , jI) =

Dξ(rI , jI) .

(3.2)

Xξ

The subscript ξ stands for all variables of the diagram
except for the end point space-time positions. That is ξ
contains both positions of the beads (in which case the
summation is understood as integration) and a topolog-
ical structure of the world lines on the β-cylinder.

Comparing the diagrams with diﬀerent jI and rI (in-
cidentally, it is precisely this comparison that stands be-
hind the acceptance probabilities of Advance update), we
readily see that given some diagram Dξ0(r0, j0) we can
“upgrade” it to a diagram Dξ(r, j) with j > j0 by at-
taching to I a world line piece of M = j − j0 beads.
Speciﬁcally,

Dξ(r, j) = Dξ0 (r0, j0) Rj0j(r0, r)

(j0 < j) ,

(3.3)

Rj0j(r0, r) = e∆U+µεM

ρ◦(rν−1, rν , ε) ,

(3.4)

M

Yν=1

where ξ = {ξ0, r1, r2, . . . , rM−1}, rM ≡ r, and the mean-
ing of ∆U is the same as in Advance update: ∆U =
Uξ0 − Uξ, where Uξ and Uξ0 correspond to the diagrams
Dξ and Dξ0, respectively. Hence, we have

g(r, εj) =

dr0 . . . drM−1 Dξ0 (r0, j0) Rj0j(r0, r) =

dr0 . . . drM−1 Dξ0 (r0, j0) Rj0j(r0, r)δ

¯(M)
j0j ,

(3.5)

¯(M)
j0j =

δ

1 ,
0 ,

(cid:26)

if j0 ∈ [j − ¯M , j − 1] ,
otherwise .

(3.6)

Though Eq. (3.6) is not the ﬁnal answer yet,
it al-
ready contains an important element. It allows one to
sample the time slice j from the adjacent time slices
j0 ∈ [j − ¯M , j − 1]. The problem with Eq. (3.6) is that
we still have a continuous variable r while we would like
to know the Green function only at the discrete set of
pre-deﬁned points {rp}. To proceed further, we utilize

8

r

[

rp

]

(and to a certain extent generalize) the idea which has
been already used in diagrammatic Monte Carlo.22 Sup-
pose we are interested in g(rp, εj), where rp ∈ Vp is a
pre-selected point for collecting statistics and Vp is a 3D
volume containing this point. We formally rewrite (3.5)
at point rp as (below rM ≡ rp)

g(rp, εj) =

dr0 Dξ0 (r0, j0) δ

¯(M)
j0j

Z

Xξ0,j0

×

dr WM (r0, r) δ(Vp)

r

Z
M
ν=1 ρ◦(rν−1, rν, ε)
ρ◦(r0, rp, εM )

Q ,

(3.7)

×

Z

dr1 . . . drM−1 Q

Q = ( ¯M Vp)−1 ρ◦(r0, rp, εM )
WM (r0, r)

e∆U+µεM ,

(3.8)

j

j0

I

δ(Vp)
r

=

1 ,
0 ,

(cid:26)

if r ∈ Vp ,
otherwise .

(3.9)

FIG. 3: Construction of the estimator for the Green function
G(rp, εj), where without loss of generality we assume that
rM = 0, jM = 0.

The value of ∆U corresponds to the extra piece of world
line (r0, r1, . . . , rM−1, rp). In principle, WM (r0, r) is an
arbitrary function, but we want it to be positive-deﬁnite
and normalized (the integration is over the whole system
volume, not just Vp), i.e.
to have the meaning of the
probability density

dr WM (r0, r) = 1 .

(3.10)

Z

Moreover, for our purposes the most reasonable choice is
simply

WM (r0, r) = ρ◦(r0, r, εM ) .

(3.11)

Now we just need to interpret the relation (3.7) in terms
of a stochastic process. First, we integrate/sum this re-
lation over the position of M in space/time and com-
pensate for that by dividing (3.7) by P V . To interpret
the ﬁrst line in (3.7), we recall that in accordance with
(2.7) the value of Dξ0 is equal to the probability den-
sity to sample the corresponding diagram of the G-sector
times the factor ZW /C. Hence, we can interpret the
ﬁrst line as averaging—over the ensemble of all Monte
Carlo diagrams—of the stochastic variable given by the
rest of the expression times projector δ(G) times projector
¯(M)
δ
(jI −jM),j times ZW /CV P . The second line says that the
evaluation of the stochastic variable starts with sampling
a vector r distributed in accordance with Eq. (3.11). The
projector δ(Vp)
r means that if r /∈ Vp, then the stochastic
variable is automatically zero. If r ∈ Vp, then the eval-
uation procedure continues in accordance with the third
line of Eq. (3.7), which we interpret as sampling (M − 1)
auxiliary variables, r1, . . . , rM−1, where M = j −jI +jM.
(In the special case of M = 1, auxiliary variables are not

sampled.) The auxiliary variables are sampled from the
distribution

ρ◦(r0, r1, ε)ρ◦(r1, r2, ε) . . . ρ◦(rM−1, rp, ε)
ρ◦(r0, rp, εM )

.

(3.12)

When these are ﬁxed,
the stochastic variable in
question—up to the global pre-factors discussed above—
is nothing other than Q, deﬁned by Eq. (3.8).
Summarizing, we have derived the estimator

h δ(G) δ

¯(M)
(jI −jM),j δ(Vp)

r Q iMC =

CV P
ZW

g(rp, εj) ,

(3.13)
where the variable Q is calculated in accordance with
Eq. (3.8) in terms of the auxiliary variables of the above-
described procedure, which we illustrate in Fig. 3,

Q =

1
¯M Vp

ρ◦(r0, rp, εM )
ρ◦(r0, r, εM )

e∆U+µεM .

The free parameters of the procedure, ¯M and Vp, are
optimized to yield the best possible convergence.

Our ﬁnal note is that if one is interested in the Green
function at a certain momentum p then the correspond-
ing estimator does not require any elaboration presented
above due to extra integration over r. Indeed, according
to Eq. (2.13) we have

h δ(G) δj, (jI −jM) eip(rI −rM) iMC =

g(p, εj) .

CV P
ZW

(3.14)

9

We conﬁne ourselves to the simplest case, i.e., the one

in which U (X) is a sum of pairwise contributions:

P −1

U =

Xj=0 Xhaj bj i

u(raj − rbj ) ,

(4.1)

where beads on the j-th time slice are labeled using sub-
scripts aj and bj, the notation hajbji stands for all pairs
of beads on a given slice, and r’s are the spatial co-
In the simplest2 choice for U
ordinates of the beads.
u(r) = v(r)ε. Correspondingly,

e−U =

e−u(raj −rbj ) .

(4.2)

Yj Yhaj bj i

An important observation now is that if |raj − rbj | >
rc, where rc is some distance, greater than the radius
of the repulsive core of the pair potential, then u(raj −
rbj ) < 0, and the corresponding pairwise exponential can
be identically split into a sum of two positive deﬁnite
terms:

e−u(raj −rbj ) = 1 +

e−u(raj −rbj ) − 1

.

(4.3)

h

i

Graphically, this decomposition can be represented as fol-
lows: Any two beads within one and the same slice with
|raj − rbj | > rc, now may or not share an extra graphical
element, a bond, see Fig. 4. The new conﬁguration space
is reminiscent of the Feynman’s diagrammatic expansion
in powers of the interaction potential. The absence of a
bond between two beads aj and bj represents the ﬁrst
term in Eq. (4.3), i.e. unity, and means that the beads
at a distance |raj − rbj | > rc do not interact. A bond
between beads aj and bj represents the second term of
Eq. (4.3).
Its relative contribution to the statistics as
compared to the case of no bond has an extra factor of

e−u(raj −rbj ) − 1

(bond factor) .

(4.4)

If one of the beads in the bond is a worm, then the bond
factor is

e−u(raj −rbj )/2 − 1

(worm bond factor) .

(4.5)

Formally, we attribute potential energy exponents to
beads, but in reality they represent interactions between
the world line trajectories; since the worm bead has a
trajectory attached to it from one side only, its potential
energy exponent is reduced by a factor of two. Corre-
spondingly, the two worm beads do not interact and thus
I can not be connected by the bond to M.

The standard MC prescription for sampling the new
conﬁguration space would be to have updates which cre-
ate and remove bonds.
It is easy to see how a “rad-
ical gain in performance” can be achieved, as, statis-
tically, the probability for two beads aj and bj with
|raj −rbj | > rc to share a bond is much smaller than unity.
Indeed, this probability is proportional to the bond factor

FIG. 4: Conﬁguration space with diagrammatic bonds be-
tween the equal-time beads.

IV. ENHANCED VERSION: DIAGRAMMATIC
EXPANSION OF THE ATTRACTIVE
POTENTIAL TAIL

The WA described in II can be (and, has been) used for
eﬃcient simulations of systems comprising a few hundred
particles. This section describes a general procedure that
signiﬁcantly improves performance of PIMC, through an
eﬃcient sampling of the contribution of the attractive
tail of the pair potential. The trick per se is not directly
related to the WA, and can be implemented within other
PIMC schemes. Obviously, the modiﬁcation of the con-
ﬁgurational space it brings about should be adequately
taken into account in the updates. Moreover, in order for
the trick to be applicable an attractive tail of the inter-
particle potential must exist, i.e., what described below
does not apply to purely repulsive interactions, such as
hard-sphere.

Straightforward schemes for calculating the potential
energy exponent of a multi-particle path, U (X), have
to deal with a compromise between accuracy and per-
formance. By a “straightforward scheme”, we mean one
that treats the pair interaction between any two particles
on the same footing, irrespectively of the value of the po-
tential, as long as it is non-zero, which is the case in all
realistic models. The computational complexity of such
schemes scales linearly with N per single-particle update.
To improve on eﬃciency, one typically truncates the po-
tential at some distance, thus introducing a systematic
error.

There is, however, a way to reduce radically the com-
putational eﬀort required for accurate treatment of the
potential tail, without introducing any additional system-
atic error. The only price to pay is a more complex con-
ﬁguration space (see Fig. 4) and, correspondingly, addi-
tional updates to sample it.

(4.4), which can be estimated as ∼ v(r)ε ≪ 1. In order
to sample the new conﬁguration space, we introduce a
pair of complementary updates that create and remove
bonds. This pair of updates is reminiscent of diagram-
matic Monte Carlo updates that create and delete beads.
There is, however, an important mathematical diﬀerence.
When creating new beads one has to seed new continu-
ous variables associated with them. Bonds are created
between existing beads, and formally the new updates
are of the standard Metropolis type.

Create Bond. The update is only possible if the conﬁg-
uration is oﬀ-diagonal. An integer number M is selected
at random within the interval [0, ¯M ]; ¯M < P . This num-
ber is used to select the ﬁrst bead, aj ≡ prevM (I), in
the pair to be connected by the bond. If prevM (I) is not
deﬁned because the world line terminates at M, the up-
date is rejected. The second bead, bj, is selected in two
steps. First, within the slice j of the bead aj we select a
spatial bin, B. This is done by randomly generating the
bin label from some probability distribution, PAB, which,
in general, depends on the distance between B and the
bin A that contains the ﬁrst bead aj. (We discuss a rea-
sonable choice of PAB below.) Let nB be the number of
beads in the bin B. If nB = 0, the update is rejected.
If nB > 0, we select at random a bead from the bin B
and call it bj. If it happens that aj = I and bj = M the
update is rejected because physically the world line ends
do not interact. Also, if aj and bj are already connected
by a bond, or the distance between the selected beads is
smaller than rc, the update is rejected. Otherwise, we
propose to create a bond between the selected pair of
beads, and accept the proposal with the probability

Pcrb =

( ¯M + 1)nB
(lbnd + 1)PAB h

e−f u(raj −rbj ) − 1

.

(4.6)

i

Here lbnd is the total number of bonds in the initial
conﬁguration associated with the beads I, prev(I), . . .,
prev ¯M (I) or I, prev(I), . . ., M if prev ¯M (I) is not de-
ﬁned. The balancing factor (lbnd + 1) naturally emerges
from the Remove Bond update which is complementary
to the Create Bond. An additional factor f = 1/2 in the
exponent is necessary only if one of the beads in the pair
is the world line end; otherwise, f = 1.

Remove Bond. The update is only possible if the con-
ﬁguration is oﬀ-diagonal. We list all lbnd bonds asso-
ciated with the beads I, prev(I), . . ., prev ¯M (I) or I,
prev(I), . . ., M if prev ¯M (I) is not deﬁned. If lbnd = 0,
the update is rejected. Otherwise, we randomly select a
bond from the list and propose to remove it. The accep-
tance probability for the update is

Prmb =

lbndPAB
( ¯M + 1)nB h

e−f u(raj −rbj ) − 1

.

(4.7)

−1

i

From Eqs. (4.6)-(4.7) we realize that an optimal choice
for PAB is based on the interaction potential between the
bin centers

PAB ∝ e−u( ~RB− ~RA) − 1 ≈ −u( ~RB − ~RA) .

(4.8)

10

An estimator for the bond contribution to the poten-
tial energy, Ubonds, is obtained using a standard trick of
replacing v(r) → λv(r) and then utilizing the identity

h U i = −

(4.9)

1
βZ

dZ
dλ

λ=1 ,

(cid:12)
(cid:12)

in accordance to which each Z-conﬁguration is diﬀeren-
tiated with respect to λ, and then λ is set to unity. The
contribution to the derivative from the bond factors (4.4)
yields

Ubonds =

1
β

h δ(Z)

b ub/(1 − eub ) iMC
h δ(Z)iMC

,

P

(4.10)

where the sum is over all bonds in a current conﬁguration.

A. Worm updates within the diagrammatic bonds

How does the presence of bonds eﬀect the worm up-
dates? The answer depends on the updating scenario.
The easiest way is to work with the same updating pro-
cedures we had without bonds. The only extra price is
then in having simple constraints on the updates applica-
bility to a given conﬁguration. Namely, we require that
all the beads being either deleted, or created, or shifted
as a result of worm updates be free of bonds. Special
care of bond factors has to be taken when interconvert-
ing regular beads to worms [see Eqs. (4.4) and (4.5)].

The above requirement is not, in practice, as restrictive
as one might think, since the probability of having no
bonds at ¯M consecutive beads is of order unity, with the
proper choice of parameters discussed in the next Section.
A brief qualitative discussion of the parameter rc is in
order here. Formally, rc can be as small as the size of
the repulsive core of the potential, to guarantee the posi-
tive deﬁniteness of the second term in Eq. (4.3). It turns
out, however, that this choice is not optimal, because
in this case the total number of bonds per ¯M consecu-
tive beads of a world line may grow large (assuming that
¯M is optimized in terms of the worm updates), and the
above-mentioned condition of absence of bonds, in order
for worm updates to be performed, may be satisﬁed very
infrequently; consequently, the scheme may become inef-
ﬁcient. In the next Section we show that for helium, rc
is slightly larger than the radius of the ﬁrst coordination
shell. For best performance, both ¯M and rc should be
simultaneously optimized.

Finally, we note that it is possible to generalize the
diagrammatic procedure to cases when the e−U(X) ex-
ponential does not factor into pairwise terms. A great
simpliﬁcation here comes from the observation that for
any particular choice of U (X), factorization does take
place at least to the ﬁrst approximation. The correcting
terms are then of the form of close-to-unity three-bead,
four-bead (and so forth) factors. The larger the number
of beads in the correcting factor, the closer the correct-
ing factor is to unity in terms of the powers of ε. This

¯M ∼

(a0/2)2m
2ε

,

(5.1)

where

observation immediately suggests a recurrent (perturba-
tive) scheme, which consists of ascribing correction fac-
tors to the diagrams, depending on the number of beads
in the bond-connected cluster. The description of such a
scheme goes beyond the scope of the present paper, since
we ﬁnd that higher-order corrections can be safely ne-
glected for the realistic choice of rc discussed in the next
Section.

V. ADDITIONAL NOTES ON THE OPTIMAL
ALGORITHM PARAMETERS FOR 4HE.

The separation radius for the diagrammatic expansion
is determined from two conditions which ensure high per-
formance of the algorithm. For eﬃcient Swap updates
one has to keep the length (in imaginary time) of the
updated trajectory long enough to avoid proposing large
displacements over short time periods. If a0 is the inter-
atomic distance, then the parameter ¯M must satisfy the
condition

which for 4He with a0 = 3.5 ˚A gives ¯M ∼ 25 assuming
relatively small ε = 5 × 10−3 K −1.

Since Swap and other updates are performed on trajec-
tory pieces having no bonds on the corresponding time
intervals, it is important to have also

h lbnd( ¯M ) i ∼ 1 ,

(5.2)

where hlbnd( ¯M )i is the average number of bonds on the
trajectory interval of length ¯M ε. If this number is large,
the simple updating strategy presented above will be-
come ineﬃcient due to small probability of ﬂuctuations
to the state with lbnd( ¯M ) = 0.
In practice, the com-
putational cost of calculating acceptance ratios in the
strongly-correlated system is much larger than a simple
check for the presence of bonds; thus, the above condition
can be easily extended to hlbnd( ¯M )i ≈ 2.

The number of bonds per time interval can be readily
estimated from the pairwise interaction potential by us-
ing a mean-ﬁeld estimate for the chemical potential shift

∞

Z

rc

∞

Z

rc

hlbndi ≈ ¯M εn

ddr v(r) g(r) ≈ ¯M εn

ddr v(r) ,

(5.3)
where g(r) is the pair correlation function, which tends to
1 in the r → ∞ limit. The last approximation in Eq. (5.3)
is quite accurate for r greater than a few times a0. For
the Aziz pair potential, ¯M ε = 0.125 K −1, and particle
number density n = 0.025 ˚A−3 we have the condition
hlbndi ≈ 2 satisﬁed for

rc ≈ 4.2 ˚A ,

(5.4)

in three dimensions. This radius falls in between the ﬁrst
and second peaks of the pair correlation function, and,

11

roughly speaking, includes the ﬁrst coordination sphere
of 4He atoms. Thus, on average, not more than 12 neigh-
boring particles are contributing to the potential energy
term in the exponent for the conﬁguration weight of the
trajectory.
It should be stressed that the above set of
control parameters is, of course, merely an approximate
guideline. To give a concrete example, for simulations
of liquid helium near the λ-point at the saturated vapor
pressure (SVP), we ﬁnd that rc = 4 ˚A and ¯M ε ≈ 0.125
is a reasonable choice.

The advantage of using sophisticated forms of U (X),
lies in the fact that one may achieve the same accuracy in
evaluating the conﬁguration weight, with smaller number
of time slices (see Ref. 2 for an exhaustive discussion of
this aspect). Below we discuss the scheme suggested in
23, which takes into account the ﬁrst derivatives
Ref.
of the interparticle potential (this is the scheme that we
have adopted in all calculations presented below):

U (X) =

v(Rj)+

2ε
3

Xj=2k

Xj=2k+1

4ε
3

(cid:20)

v(Rj)+

ε3
9m

F (Rj)
(cid:21)

,

(5.5)

N

N

N

2

N

N

F (Rj) =

f 2
i ≡

Xi=1

(cid:18)

Xi=1

Xj6=i

fij(cid:19)

≡

(cid:18)

Xi=1

Xj6=i

2

,

∂v
∂rij (cid:19)

(5.6)
sums squares of forces acting on particles. The “force”
term is very important in the repulsive region of the po-
tential and close to the point where v(r) changes sign. In
this region v(r) derivatives are large and their contribu-
tion to the conﬁguration weight may become comparable
to the leading linear in ε terms on some slices.

Let us separate in Eq. (5.6) contributions coming from
forces between close (rij < rc) and distant (rij′ > rc)
pairs (we label them with indexes 1 and 2 respectively),
F = F1 + F2 + F12:

F1 =

2

f (1)
ij (cid:19)

(cid:18) Xj6=i

N

Xi=1
N

N

; F2 =

2

;

f (2)
ij′

(cid:19)

Xi=1

(cid:18) Xj′6=i

F12 = 2

Xi=1

(cid:18) Xj6=i

f (1)
ij (cid:19)

·

f (2)
ij′

.

(cid:19)

(cid:18) Xj′6=i

(5.7)

If only F1 and F12 terms were present, the diagrammatic
expansion would be easy to modify to include these terms
into the consideration. The F1 term is accounted for
directly in the weight exponent by keeping records of
short-range forces acting on particles and updating them
accordingly. We assume that this procedure is always
implemented and discuss below only how to deal with the
force term in the diagrammatic expansion of the potential
tail.

The F12 term modiﬁes the diagram weight and accep-
tance ratios for the diagrammatic updates. Now, the rel-
ative weight of conﬁgurations with and without a bond
between distant (odd) beads a and b is given by the same

12

formula (4.4) with

VI. SIMULATION RESULTS

uab =

v(rab) +

(f (1)

a − f (1)

b

) · f (2)
ab .

(5.8)

4ε
3

2ε3
9m

Since the procedure of keeping track of forces acting on
particles is standard for high-accuracy PIMC schemes,
the required modiﬁcations of the scheme are minimal.
[Note that short-range forces are present now in the ex-
pression for the bond factor (5.8), and thus their possible
eﬀects on bonds should be accounted for whenever these
forces change].

Dealing with the F2 term is more cumbersome. Its ex-
act treatment requires a solution of recursive relations for
every chain of beads connected by the diagrammatic ex-
pansion. At this point we notice that forces between dis-
tant particles are orders of magnitude smaller than forces
acting at short distances r < 2.6 ˚A and thus can be safely
neglected. Indeed, for rc = 4.5 ˚A and ε = 5 × 10−3 K −1,
the F2 term can be estimated to be of order of 10−6 and
thus has no measurable eﬀect on the simulation results.
After all, the interatomic potential is not even known
with this accuracy. We conclude then that the diagram-
matic expansion can be straightforwardly implemented
for the high-accuracy scheme by omitting the F2 term in
the conﬁguration weight.

Formally, due to extremely rare statistical ﬂuctuations
which bring two particles at very close distance and re-
sult in large forces f (1) acting on them, the sign of uab in
Eq. (5.8) may change from positive to negative. This, in
turn, will change the sign of the conﬁguration weight if
the corresponding bond is accepted. One can hardly clas-
sify the possibility of such rare events as a “sign problem”
because the average conﬁguration sign will remain close
to unity, and will not impair the algorithm eﬃciency. In
practice, for rc = 4 − 5 ˚A and ε < 0.01 K −1 the con-
ﬁguration sign simply never changes during the entire
simulation.

Finally, one may wonder if the inclusion of the F12
term really helps to achieve better accuracy with smaller
If the desired accuracy does not ex-
number of slices.
ceed three signiﬁcant digits and rc is kept larger than
4 ˚A then the answer is “No”. At this level of accu-
racy, one may implement the diagrammatic expansion
for the potential tail by ignoring the force term in the
bond factor altogether, i.e. exactly as described in the
previous section. Though we have implemented schemes
with and without the F12 term, we did not detect any
diﬀerence in ﬁnal answers when using algorithm param-
eters speciﬁed above. The F1 term was still kept in the
exponent for more accurate evaluation of the short-range
part. Alternatively, one may choose to deal with the
short-range part using the pair-product approximation
of Ceperley and Pollock,2 making use of tables for the
two-particle density matrix calculated for an interaction
potential which is identically zero at distances greater
than rc.

In this Section, we present WA simulation results for
bulk liquid 4He in two and three dimensions, with the
aim of demonstrating that superﬂuid properties and oﬀ-
diagonal correlations can be calculated with the WA for
very large system sizes, orders of magnitude larger than
accessible to the conventional PIMC technology. We use
the standard interatomic (Aziz) potential for helium, in
an early form for consistency with other calculations.24
The reason for our choice of illustrative system, is simply
that the simulation of 4He in its condensed phase is a
de facto test bench for new computational many-body
techniques.

As mentioned above, we have utilized the form for
U (X) suggested in Ref. 23 for all the calculations for
which results are presented here. In both two and three
dimensions, we have observed convergence of the kinetic
energy estimates (computed with the usual thermody-
namic estimator2) using a time step ε=1/640 K−1; for all
other quantities, four times a value of ε can be used, and
the estimates are seeing to coincide, within their statis-
tical uncertainties, with those extrapolated to the ε → 0
limit.

A.

4He in two dimensions

We start with the two dimensional case and extend
the study of the superﬂuid-normal liquid (SF-N) transi-
tion ﬁrst carried out in Ref. 25, at a density n = 0.0432
˚A−2; we consider system sizes up to hundred times larger
than in the original study.26 In Fig. 5 we present data
for the superﬂuid fraction ρs(T ), for systems comprising
N = 25, 200, and 2500 atoms. Since the SF-N transition
in 2D is in the Kosterlitz-Thouless universality class,27
with strong (logarithmic) ﬁnite-size corrections, a reliable
extrapolation to the thermodynamic limit requires that
simulations be performed for signiﬁcantly diﬀerent num-
ber of particles. In the vicinity of the transition point,
one may then employ the asymptotic (in the limit of large
distances) vortex-pair renormalization group (RG) the-
ory to ﬁt the data. In our study, we used the same RG
procedure as in Ref.25, which is based on the notion of
the vortex core diameter, d (as a short-range cut-oﬀ for
RG equations), and vortex energy, Ec, to control vortex
density at distance d. Only data in the narrow vicinity
of the transition point 0.65 K ≤ T ≤ 0.8 K were used in
the ﬁtting procedure. Our estimates for the values of the
ﬁtting parameters are d = 8.8 ± 0.5 ˚A for the vortex core
diameter, and E=2.18 ± 0.04 K for the vortex energy,
which lead to an estimate for the critical temperature
Tc=0.653±0.010 K. The vortex diameter (roughly twice
the interatomic distance) turns out to be comparable to
the linear system size L for N = 25, clearly showing that
the use of the asymptotic RG analysis is questionable for
such a small system size. This fact also explains why our
result for Tc is signiﬁcantly diﬀerent from the previous

25
200
2500

ρ(r)

0.06

0.04

0.02

n(r)

0.8

0.6

0.4

0.2

)
Τ
(
 
ρ

s

 1.0

 0.8

 0.6

 0.4

 0.2

 0.0

 1.0

 0.8

 0.6

 0.4

 0.2

 0.0

 0.5  0.6  0.7  0.8  0.9  1.0
Τ

FIG. 5: Superﬂuid fraction ρs(T ) computed for 2D 4He on
systems with diﬀerent numbers N of 4He atoms. The system
density is n = 0.0432 ˚A−2. Dashed lines represent ﬁts to
the numerical data (in the critical region) obtained using the
procedure illustrated in Ref.25. The leftmost dashed line is
the extrapolation to the inﬁnite system. Open squares show
results obtained in Ref.25 for the same system, with N =25.

 1.0

 0.1

 0.1

 1

 10  100

 5

 10  15  20  25  30

o

r (A)

FIG. 6: (Color online). One-particle density matrix computed
for 2D 4He at a density n = 0.0432 ˚A−2 for a system of
200 atoms, at T =0.675 K (upper curve) and T =1.0 K (lower
curve). Statistical errors on the curves are very small, and
not shown for clarity. In the inset, we present data (on a log-
log scale) for the N=2500 system at T =0.675 K, with clear
signatures of the Kosterlitz-Thouless behavior in the vicinity
of the critical point. [Reproduced from Ref. 11.]

estimate, 0.72±0.02 K, deduced from the N = 25 data.25
In Fig. 6, we show results for the single-particle density
matrix n(r). For 2D helium, this quantity is expected to
decay to zero at all ﬁnite temperatures. In the normal
phase, and far from the critical point, the decay is expo-
nential. At the critical point, the decay is described by a
slow power-law n(r) ∼ 1/r1/4. The same law should be

13

T = 2.14 K

n  =0.024(1)

0

0

5

10

15

20

r(A)

0

5

10

15

r(A)

FIG. 7: (Color online). One-particle density matrix n(r) close
to the SVP critical point at T = 2.14 K for two system
sizes N = 64 (ﬁlled squares) and N = 2048 (open squares).
The solid line is the theoretical prediction based on long-
wavelength phase ﬂuctuations, Eq. (6.1).

observed in the vicinity of the critical point up to expo-
nentially large distances. At low T , the exponent in the
power law approaches zero. The data in Fig. 6 are in line
with these expectations; quantitatively, the slope of the
n(r) curve on the log-log plot shown in the inset is close
to one quarter.

We wish to conclude this subsection by giving an ex-
ample of typical (without any extensive optimization) al-
gorithm parameters used for the two-dimensional helium.
For the T = 1 K, µ = −1 K, and N = 25 system with
P = 200, ¯M = 40, C0 = 7.5, and rc = 4.05 ˚A the mea-
sured acceptance probabilities were Pop = 0.47, Pcl =
0.43, Pin = 0.13, Prm = 0.44, Pad = 0.43, Pre = 0.59,
Psw = 0.33, Pcrb = 0.58 Prmb = 0.42.

B.

4He in three dimensions

As mentioned in the Introduction, simulations of bulk
3D liquid helium were among the ﬁrst remarkably suc-
cessful applications of the PIMC method.1 However, pre-
vious predictions made for the superﬂuid properties were
never at the same level of accuracy as for energetic or
structural properties, for reasons mentioned in the Intro-
duction. In this subsection, we show how the WA, based
on updates described above, eliminates the shortcomings
of the existing PIMC method, by allowing simulations of
several thousand atoms with suﬃcient precision to deter-
mine, for example, the critical temperature of the SF-N
transition at the saturated vapor pressure (SVP) with
accuracy of three signiﬁcant digits.

In Fig. 7, we show our data for the density matrix n(r)
in the vicinity of the critical point, at the saturated vapor
pressure (at a temperature T =2.14 K and at a density
n=0.02198 ˚A−3) for system sizes N = 64 and N = 2048.

Though the data for small and large system sizes appear
nearly identical in the main plot, the crucial diﬀerence is
clearly seen in the inset. The N = 64 curve terminates
right after the ﬁrst coordination shell oscillation; the best
estimate that can be obtained of the condensate fraction
n◦ (namely, the asymptotic value to which n(r) should
plateau at long distances) from this set of data alone,
would be about 0.045. Obviously, the same coordination
shell oscillation prohibits a fortiori any reliable ﬁnite-
size scaling for smaller system sizes, e.g. using series
N = 16, 32, 64.

In contrast, the N = 2048 system is large enough to see
the eﬀect of long-wavelength hydrodynamic phase ﬂuc-
tuations. The Bogoliubov expression for the asymptotic
behavior of n(r) at large distances in the superﬂuid, is
given by

n(r)

0.8

0.6

0.4

0.2

0
0

n(r)n(r)

0.09

0.08
0

14

T=1 K

n  =0.081(2)

0

5

10

r(A)

5

10

r(A)

n(r) = n◦ exp
(cid:20)

T
8πλnρsr (cid:21)

.

(6.1)

FIG. 8: One-particle density matrix n(r) for N = 1024 par-
ticles at T = 1 K and SVP pressure. The solid line is the
theoretical prediction based on the long-wave phase ﬂuctua-
tions, Eq. (6.1).

Since ρs is calculated independently, the shape of the
density matrix decay is ﬁxed. The condensate fraction
controls only the overall normalization of the theoretical
curve, and this allows precise extrapolation of the data
to the thermodynamic limit. An example of such ex-
trapolation is shown in Fig. 7 by the solid line, which
predicts n0 = 0.024(1) for the condensate fraction n◦ at
T = 2.14 K—nearly a factor of two smaller than the
0.045 estimate obtained on a 64-atom system.

The hydrodynamic correction to the tail of n(r) is less
important at low temperature and for large values of ρs.
For comparison, in Fig. 8 we present data for a system
of N = 1024 atoms, at a temperature T = 1 K (in this
case, the density is n=0.02184 ˚A−3). In this temperature
range, smaller system sizes can be used to obtain reliable
thermodynamic estimates of n◦. Our estimate for n◦ at
T =1 K is 0.082±0.002. This is consistent with the ex-
isting PIMC estimate (0.07±0.01 at T =1.2 K, from Ref.
2), obtained on a system of 64 4He atoms, but some-
what above the most recent T =0 estimate (0.069±0.005,
Ref. 28). Although the diﬀerence is only slightly greater
than the combined statistical uncertainties, it should be
noted that ﬁnite temperature calculations are unbiased,
whereas ground state calculations are based on an input
trial wave function. While it is in principle possible to
remove the variational bias associated to the trial wave
function, this may be diﬃcult a goal to achieve in prac-
tice.

Having access to system sizes which allow asymptotic
hydrodynamic description is a necessary condition for
determining critical parameters using ﬁnite-size scaling
techniques (see, e.g., Ref 29). The idea is to consider
quantities which are determined by system properties at
the largest scales, becoming scale-invariant at the critical
point. For small deviations from criticality, δ → 0, the
dependence on system size for such quantities is given by

R(L, δ) = fR(L/ξ(δ)) ≡ gR(δL1/ν) ,

(6.2)

where fR(x) and gR(x) are the corresponding universal
scaling functions (gR(x) is analytic at x = 0) and ξ(δ) is
the correlation length which diverges at the critical point
as ξ ∝ δ−ν. For the U(1) universality class in 3D, the
best numerical estimate currently available for the corre-
lation length exponent is ν = 0.6717.30 The intersection
of R(L, δ) curves for diﬀerent system sizes provides very
accurate and unbiased estimates of critical parameters.
Previous attempts to determine Tc from the scale-
invariance of R(L) = ρsL (Josephson relation) have
failed.7 Though the authors of Ref. 7 correctly argue that
“The statistical uncertainty in the data is too large to ac-
curately determine Tc from the crossing of these [scaling]
two curves”, it seems that coordination shell oscillations
also contribute to several intersections in the 1.6 K < T <
2.4 K interval.

In Fig. 9, we show the temperature dependence of the
superﬂuid fraction for various system sizes. After extrap-
olation to the thermodynamic limit, there is nearly per-
fect agreement between the numerical and experimental
results. In order to determine the transition temperature
Tc, we perform ﬁnite-size scaling analysis of

,

=

hW 2i
3

R(L, T ) =

2λnρsL
T
where W=(Wx, Wy, Wz) is the winding number.5 The
raw data are shown in Fig 10. As an independent
check, we also draw a horizontal line at the known U(1)-
universality class value for winding number ﬂuctuations
at the critical point.30,32 From the intersection of scal-
ing curves (which is seen to take place at the univer-
sal value, within the statistical uncertainties), we ﬁnd
Tc = 2.193(6). The diﬀerence between this prediction
and the experimental value, 2.177 K, is very small, i.e.,
simulations of the superﬂuid density dependence on sys-
tem size in the vicinity of the critical point, do allow us

n 0

0.08

0.04

0.02

0
0

o
-3
n(A  )

0.0262

0.0261

0.026

0.0259

15

PIMC, Ceperley et al.

0.06

Experiment

ρ
s

1

0.75

0.5

0.25

0

1

1.5

2

T(K)

FIG. 9: (Color online). Superﬂuid fraction ρs(T ) as a function
of temperature at SVP, computed for diﬀerent system sizes,
namely N = 64 (ﬁlled circles), N = 128 (open circles), N =
256 (ﬁlled squares), N = 512 (diamonds), N = 1024 (triangles
down), and N = 2048 (triangles left). The solid line is the
experimental curve.

0.5

1

1.5

2

2.5

T(K)

FIG. 11: (Color online). Condensate fraction at the saturated
vapor pressure. The dashed line is used to guide the eye.

<W  >2
3

2048

1024

512

128

64

U(1)

1

0.8

0.6

0.4

0.02599 (freezing density)

(exp)

cT

(Aziz)

Tc

µ

o

0

0.2

0.4

0.6

µ

(K)

2.12

2.14

2.16

2.18

2.2

T(K)

(Color online).

FIG. 10:
Finite-size scaling plot for
2λnρsL/T = hW 2i/3 at SVP. The solid line is the U(1) uni-
versality class value of 0.516(1).

FIG. 12: (Color online). Liquid density as a function of chem-
ical potential at low temperature T = 0.25 K. The slope of
the solid line is deduced from the simulated values of com-
pressibility averaged over four points shown in the plot. The
critical value of the chemical potential deduced from this plot
is estimated as µ◦ = 0.06 ± 0.04.

to calculate Tc with a relative accuracy of better than
0.5%. There is no reason to expect the Aziz pair po-
tential to reproduce Tc with much better accuracy, as
it was not optimized for this purpose. It is only a very
good approximation to the true interatomic potential for
4He which, in reality, includes irreducible forces acting
between three and more particles.33

Condensate density has been consistently one the most
diﬃcult properties to compute and measure for helium.
Shown in Fig. 11 are available experimental data34 along
with the previous PIMC results2 and new estimates ob-
tained in the present study, extrapolated to the thermo-
dynamic limit as explained above. With new technology

we substantially reduce theoretical uncertainties on pre-
dictions of no at the SVP.

We conclude by mentioning that we have also obtained
estimates for all other standard thermodynamic quanti-
ties, such as the kinetic energy, pair correlation function
etc. Our data are generally consistent with those of exist-
ing calculations; speciﬁcally, our T =1 K results are indis-
tinguishable, within statistical uncertainties, from those
yielded by numerically exact ground state methods (see,
e.g., Ref. 35).

16

is obtained from the average value of κ for all data points
shown. From this set of data we deduce that the critical
value of the chemical potential as

µo = 0.06 ± 0.04 .

(7.1)

1.01

1

0.99

0.98

0.97

)
 
 
τ
 
,
0
=
p
(
G

VII. DISCUSSION AND CONCLUSIONS

We have introduced a new Worm algorithm, aﬀord-
ing an accurate PIMC study of strongly correlated Bose
systems. Illustrative results of numerical simulations of
the superﬂuid transition in liquid 4He have been pre-
sented, for system sizes two orders of magnitude larger
than what is accessible to conventional PIMC. It should
be stressed that such an advance cannot be simply at-
tributed to the availability of faster computing facilities
than back in the days when the ﬁrst PIMC simulations of
liquid 4He were carried out. Rather, the WA decisively
overcomes the most important limitation of conventional
PIMC, namely the exponential ineﬃciency with which
long permutation cycles are sampled, in the thermody-
namic limit (a limitation acknowledged by practitioners
of PIMC6).

We have also described a procedure, based on ideas of
Diagrammatic Monte Carlo, which allows one to enhance
signiﬁcantly the scalability of the computational scheme,
without compromising on the accuracy of the calculation.
The new methodology has already been applied to the
study of the supersolid phase of helium,12 for which ac-
cess to large system sizes is crucial; it can also be ex-
pected to have broad impact on a wide variety of strongly
correlated quantum many-body systems.
It should be
mentioned, that the eﬃciency with which long permu-
tation cycles can be sampled using the WA, also signiﬁ-
cantly impacts the convergence of calculations of the su-
perﬂuid properties of ﬁnite systems, such as quantum
clusters.13

There are other advantages to this new method, chieﬂy
the fact that it is fully grand canonical, and that allows
for the calculation of the Matsubara Green function, a
quantity that can not e computed with any other existing
QMC technique (in continuous space). An immediate
application of these last two aspects, is the calculation
of chemical potentials and excitation gaps. Consider, for
instance, the calculation of the chemical potential at the
liquid-solid transition line at low temperature, µ◦. The
study of G(k = 0, τ ) in the solid phase can be found in
Ref. 36.

The value of µ◦ can be determined from the n(µ) curve
and known freezing density for the liquid which is at
n = 0.02599 ˚A−3.
In Fig. 12 we show data points for
four values of the chemical potential and the position of
the freezing density. All simulations were performed at
T = 0.25 K, and with the particle number N ≈ 800.
Apart from average density we also calculated statistics
of particle number ﬂuctuations to obtain the compress-
ibility of the system from κ = dn/dµ = h(N −hN i)2i/T V .
It provides an independent check for consistency and con-
vergence of the data. In Fig. 12 the slope of the solid line

-0.5

-0.25

0.25

0.5

0
τ (K   )-1

FIG. 13: Zero-momentum Green function for the superﬂuid
state of N ≈ 1000 atoms at T = 1 K, µ = −7.35 K, and
density n = 0.02184 ˚A−3 . It is normalized to unity at the
origin. Note the small vertical scale: The τ -dependence is a
ﬁnite-size eﬀect.

Though one can deduce this parameter from the ground
state energy as a function of particle number using µ =
dE/dN ≈ E(N + 1) − E(N ), such simulations can not
be performed for large system sizes with accuracy signif-
icantly better then few K.

The zero-momentum Matsubara Green function G(k =
0, τ ) for the superﬂuid state at T = 1 is shown in Fig. 13.
In the macroscopic limit, G(k = 0, τ ) is τ -independent,
being equal to the total number of condensate particles.
We show this plot to support our previous claim that in
the superﬂuid state the two worm ends perform a random
walk on large distances, and come close within the reach
of the Close and Remove updates once per sweep.

VIII. ACKNOWLEDGMENTS

This work was supported by the National Aero and
Space Administration grant NAG3-2870, the National
Science Foundation under Grants Nos. PHY-0426881,
NSF PHY-0456261, by the Sloan Foundation, and by
the Natural Science and Engineering Research Council
of Canada under grant G121210893. NP gratefully ac-
knowledges hospitality and support from the Paciﬁc In-
stitute of Theoretical Physics, Vancouver (BC).

1 D. M. Ceperley and E. L. Pollock, Phys. Rev. Lett. 56,

2 D. M. Ceperley, Rev. Mod. Phys. 67, 279 (1995).

351 (1986).

17

3 See, for instance, D. M. Ceperley in Monte Carlo and
Molecular Dynamics of Condensed Matter Systems, Ed.
K. Binder and G. Ciccotti, Editrice Compositori (Bologna,
Italy, 1996).

4 See, for instance, A. Brenner, Physics Today, October

5 E. L. Pollock and D. M. Ceperley, Phys. Rev. B 36, 8343

1996, p. 24.

(1987).

6 See, for instance, B. Bernu and D. M. Ceperley, Phys. Rev.

Lett. 95, 155303 (2004).

7 E.L. Pollock and K.J. Runge, Phys. Rev. B 46, 3535

(1992).

8 N. V. Prokof’ev, B. V. Svistunov, and I. S. Tupitsyn, Phys.
Lett. A 238, 253 (1998); Sov. Phys. JETP 87, 310 (1998).
9 N. V. Prokof’ev and B. V. Svistunov, Phys. Rev. Lett. 92,

10 N. V. Prokof’ev and B. V. Svistunov Phys. Rev. Lett. 87,

015703 (2004).

160601 (2001).

with no calculation needed.

20 See, for instance, M. P. Allen and D, J. Tildesley, Computer
Simulation of Liquids, Oxford University Press (1987).
21 The speciﬁc deﬁnition of “nearest neighbor” is not relevant

for the generic description of the move.

22 A. S. Mishchenko, N. Nagaosa, N. V. Prokof’ev, A.
Sakamoto, and B. V. Svistunov, Phys. Rev. B 62, 6317
(2000).

23 S. A. Chin, Phys. Lett. A 226, 344 (1997).
24 R. A. Aziz, V. P. S. Nain, J. S. Carley, W. L. Taylor and

G. T. McConville, J. Chem. Phys. 70, 4330 (1979).

25 D. M. Ceperley and E. L. Pollock, Phys. Rev. B 39, 2084

(1989).

26 The largest system size for which calculations of superﬂuid
properties of helium ﬁlms have been carried out using con-
ventional PIMC, is, to date N =36. M. Boninsegni, M. W.
Cole and F. Toigo, Phys. Rev. Lett. 87, 2002 (1999).
27 J. M. Kosterlitz and D. J. Thouless, Prog. Low Temp.

11 M. Boninsegni, N. Prokof’ev, and B. Svistunov, Phys. Rev.

Phys. VIIB, 371 (1978).

Lett. 96, 070601 (2006).

12 M. Boninsegni, N. V. Prokof’ev and B. V. Svistunov, Phys.

129 (2004).

28 S. Moroni and M. Boninsegni, J. Low Temp. Phys. 136,

Rev. Lett. 96, 105301 (2006).

13 F. Mezzacapo and M. Boninsegni, cond-mat/0603677.
14 N. V. Prokof’ev and B. V. Svistunov, Phys. Rev. Lett. 81,

2514 (1998).

15 The WA can be applied to Fermi systems as well; how-
ever it will be aﬀected by the sign problem. Although we
do not discuss the fermion problem here, we note that ap-
proximate schemes such as the “ﬁxed-node approximation”
(see, for instance, Ref. 3) can be easily incorporated in the
WA.

16 Note that this assumption on the potential is made for sim-
plicity only; the applicability of the WA does not depend
on it, i.e., more general interactions can be studied without
altering the computational scheme in any signiﬁcant way.
17 Using standard importance sampling, one may control
statistics of particle number ﬂuctuations, and perform
canonical ensemble measurements.

18 N. A. Metropolis, A. W. Rosenbluth, M. N. Rosenbluth,
A. Teller and E. Teller, J. Chem. Phys. 21, 1087 (1953).
19 Since balance equation deals only with accepted moves, one
can propose a move without a priory checking that the cur-
rent conﬁguration is consistent with the proposal.—If it is
not, the move is automatically rejected after the proposal,

29 K. Binder, Phys. Rev. Lett. 47, 693 (1981); W.H. Press,
S.A. Teukolsky, W.T. Vetterling, and B.P. Flannery, Nu-
merical Recipes in C, 2nd ed, Cambridge, 1992.

30 M. Campostrini, M. Hasenbusch, A. Pelissetto, P. Rossi,
and E. Vicari, Phys. Rev. B 63, 214503 (2001); E.
Burovski, J. Machta, N.V. Prokof’ev, and B.V. Svistunov,
cond-mat/0507352; M. Campostrini, M. Hasenbusch, A.
Pelissetto, and E. Vicari, cond-mat/0605083.

31 E. L. Pollock and D. M. Ceperley, Phys. Rev. B 36, 8343

(1987).

32 M.-C. Cha, M.P.A. Fisher, S.M. Girvin, M. Wallin, and

A.P. Young, Phys. Rev. B 44, 6883 (1991).

33 See, for instance, S. Moroni, F. Pederiva, S. Fantoni and
M. Boninsegni, Phys. Rev. Lett. 84, 2650 (2000), and ref-
erences therein.

34 H. R. Glyde, R. T. Azuah and W. G. Stirling, Phys. Rev.

35 J. E. Cuervo, P.-N. Roy and M. Boninsegni, J. Chem. Phys.

B 62, 14337 (2000).

122, 114504 (2005).

36 M. Boninsegni, A. B. Kuklov, L. Pollet, N. V. Prokof’ev,

B. V. Svistunov, M. Troyer, cond-mat/0605627.

