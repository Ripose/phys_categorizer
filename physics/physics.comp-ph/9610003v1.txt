6
9
9
1
 
t
c
O
 
4
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
3
0
0
0
1
6
9
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Harmonic analysis of random number generators
and multiplicative groups of residue class rings

Oliver Schnetz∗

September 26, 1996

Abstract

The spectral test of random number generators (R.R. Coveyou and R.D. McPher-
son, 1967) is generalized. The sequence of random numbers is analyzed explicitly,
not just via their n-tupel distributions. The generalized analysis of many generators
becomes possible due to a theorem on the harmonic analysis of multiplicative groups
of residue class rings. We ﬁnd that the mixed multiplicative generator with power
of two modulus does not pass the extended test with an ideal result. Best qualities
has a new generator with the recursion formula Xk+1 = aXk + c int(k/2) mod 2d.
We discuss the choice of the parameters a, c for very large moduli 2d and present an
implementation of the suggested generator with d = 256, a = 2128 +264+232+62181,
c = (2160 + 1)

11463.

·

Contents

1 Introduction

2 The generalized spectral test

2.1 Review of the spectral test . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Generalization of the spectral test . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . .
2.3 Valuation with the generalized spectral test

3 Multiplicative groups of residue class rings

∗Institut f¨ur theoretische Physik III, Staudtstraße 7, 91058 Erlangen, Germany,

e-mail: schnetz@pest.physik.uni-erlangen.de
Supported in parts by the DFG Graduiertenkolleg ’Starke Wechselwirkung’ and the BMBF.
FAU-TP3-96/13

2

4
4
5
6

8

1

1 INTRODUCTION

4 Generators

14
4.1 X0 = c, Xk+1 = aXk mod M . . . . . . . . . . . . . . . . . . . . . . . . . . 14
4.2 X0 = 0, Xk+1 = aXk + c mod M . . . . . . . . . . . . . . . . . . . . . . . . 17
4.3 X0 = 0, Xk+1 = aXk + ck mod M . . . . . . . . . . . . . . . . . . . . . . . 20
4.4 X0 = 0, Xk+1 = aXk + c int(k/t) mod M . . . . . . . . . . . . . . . . . . . 23
4.5 X0 = 1, X−1 = ... = X−r+1 = 0, Xk+1 = ar−1Xk + ... + a0Xk−r+1 mod P . . . . . 26

2

27

34

5 Choice of parameters

6 Results and outlook

1 Introduction

The spectral test was proposed by R.R. Coveyou and R.D. McPherson in 1967 [1]. The
advantage of this test is to present an algebraic criterion for the quality of the generator.
For the mixed multiplicative generator Xk+1 = aXk + c mod M

min

=

s
|

{|

q

s2
1 + . . . + s2

n with sa = s1 + as2 + . . . + an−1sn = 0 mod M

(1)

}

should be as large as possible [1, 2]. The criterion is that simple since the n-tupels of
random numbers form an n-dimensional lattice (cf. e.g. Fig. 4). A good generator has
uniformly distributed n-tupels which refers to an almost cubic lattice [3, 4, 5].

The lattice is a consequence of the (aﬃne) linear dependence of X k+1 on X k. From
the ﬁgures on the left (type I) we see that the relation between k and X k is much more
complicated. This is however one of the most fundamental aspects of randomness. In order
to judge whether a sequence X k takes random values one would ﬁrst plot the sequence
itself and then maybe X k+1 over X k.

Of course, the correlation between k and X k is not independent from the distribution
of pairs (Xk, Xk+1). E.g., a poor ’random’ sequence Xk = ak lying on a line with gradient
a leads to pairs (Xk, Xk+1 = Xk + a) lying on a line with gradient 1 shifted by a oﬀ
the origin. This makes it reasonable to judge randomness by only looking at the n-tupel
distributions. However, random number generators which have identical valuation by the
spectral test may still look quite diﬀerent. The generators Xk+1 = 41Xk + 3 mod 1024
(Fig. 5) and Xk+1 = 41Xk + 1 mod 1024 (Fig. 6), e.g., diﬀer only by the additive constant
which does not enter Eq. (1). The lattices of pair distributions (type II in the ﬁgures)
are similar whereas the plots of X k over k show diﬀerent behavior. The spectral test not
even makes a diﬀerence between a prime number and a power of two modulus (cf. Fig. 1
vs. Fig. 4).

Therefore it is desirable to include the analysis of the correlation between k and X k
into the valuation of the test. In fact it is possible to analyze the accumulation of random
numbers along certain lines (which is often seen in the ﬁgures) by Fourier transformation.
More generally we extend the spectral test by analyzing the correlation between k and
the n-tupel (Xk, Xk+1, . . ., Xk+n−1). The generators mentioned above (Figs. 5, 6) acquire

1 INTRODUCTION

3

diﬀerent valuations. Fig. 6 is preferred since the random numbers spread more uniformly
in Fig. 6I than in Fig. 5I (cf. Ex. 4.3 1.(a)).

We will develop a powerful theorem (Thm. 3.4, Cor. 3.5) on the harmonic analysis
of multiplicative groups of residue class rings that allows us to algebraically perform the
test for the standard generators. It becomes even possible to evaluate the extended test
on more generators than the original spectral test has yet been applied. This has the
advantage to have more freedom for the search after an optimum generator.

In fact we will ﬁnd that the commonly used mixed multiplicative generator always
shows correlations along certain lines if the modulus is not a prime number. We will
improve the generator until these correlations will essentially disappear (from Fig. 4 via
Fig. 9 to Fig. 11). We ﬁnally recommend the recursion formula

Xk+1 = aXk + c int (k/2) mod 2d

(2)

with the parameters

d = 2kd0

, a = 22k−1d0 + 22k−2d0 + . . . + 22d0 +

3 580 621 541 mod 2d0

,

c =

2int(2k+1/3)d0 + 1
(cid:18)

(cid:19) (cid:16)

(cid:16)
3 370 134 727 mod 2d0

(cid:17)

(3)

.

(cid:17)

In particular, the case d0 = 16, k = 4 is discussed in Ex. 5.1 1.

This generator is supposed to be a good choice with respect to the following three

criteria.

Firstly, the sequence of numbers provided by the generator should behave as close to

a true random sequence as possible.

Secondly, the calculation of random numbers should be as fast as possible. The gen-
It is
erator given in Eqs. (2), (3) is explicitly constructed to have best performance.
important to note that this is not independent from the ﬁrst criterion. It is possible to
produce better random numbers the more eﬀort one spends in calculating the numbers.
Figs. 4 and 8 show how a simple doubling of the digits of the modulus improves the ran-
domness of the generator. In general we can produce arbitrarily good random numbers
with e.g. d0 = 32 and large k in Eq. (3).

Thirdly, the properties of the random numbers should be known as detailed as possible.
It is not suﬃcient to use a messy, opaque formula. It has often been seen that this leads
to numbers which are far from being random [2]. As long as one is not familiar with
the qualities of the generator one can never rely on the results gained with it. The full
evaluation of the generalized spectral test is supposed to provide a profound knowledge
of the generator.

We start with the development of the generalized spectral test in the next section. In
Sec. 3 we derive some mathematical results on the Fourier transformation of residue class
rings.
In Sec. 4 we apply the result of the previous section, Thm. 3.4, to a series of
commonly used and some new generators. Finally we discuss the choice of parameters in
Sec. 5.

4

(4)

(7)

2 THE GENERALIZED SPECTRAL TEST

2 The generalized spectral test

2.1 Review of the spectral test

We start with a short review of the spectral test [1, 2] in which we try to stress its
geometrical meaning. The idea is to plot all n-tupels of successive random numbers in an
n-dimensional diagram. This is done, e.g. for n = 2 in the ﬁgures of type II.

Mathematically a ﬁgure is presented as a function g which is 1 at every dot and 0
If NX is the period of the generator X, that is the smallest number with

elsewhere.
Xk+NX = Xk ∀

k, then

g (x1, . . ., xn) =

δx1,Xk · · ·

δxn,Xk+n−1 ≡

δx,Xk ,

Xk∈ZNX

NX

Xk=1

where δa,b = 1 if a = b and δa,b = 0 if a
Kronecker δ as δa=b). Moreover we have introduced the notation

= b (for later convenience we also write the

Xk = (Xk, Xk+1, . . ., Xk+n−1) , x = (x1, x2, . . ., xn) , ZNX = Z/NXZ .

(5)

We want to check whether the dots accumulate along certain hyper-planes (see e.g.
the lines in Fig. 1II). To this end we select a hyper-plane and project all the dots onto a
line perpendicular to it. If points accumulate along the plane many dots will lie on top
of each other, otherwise the dots are spread uniformly over the line.
The hyper-plane H is determined by its Hesse normal form

{

H =

x : s1x1 + s2x2 + . . . + snxn ≡
s
|

The line is stretched by the factor
to the plane is given by the number s

|

Xk.

·

s

x = 0

,

·

≡
. The position of a point Xk on the line perpendicular

q

}

|

·

s2
1 + . . . + s2
n 6

= 0 . (6)

√s

s

s
| ≡

Next we wind the line up to a circle so that the modulus M as point on the line lies
3, 7) all points in Fig. 1II lie

on top of the 0. For a suitable choice of s, namely s = (
now on the point represented by the number 256.

−

The points are realized as complex phases on the unit circle. We obtain the assignment

Xk 7→

exp

2πi
M

s

·

Xk

.

(cid:18)
Finally we draw arrows from the center of the circle to all the dots and add them. The
length of the resulting vector describes how the dots are balanced on the circle. If the
dots spread uniformly the arrows cancel each other and the resulting vector is small. If,
on the other hand, all dots lie on top of each other the length of the arrows sums up to
NX.

(cid:19)

If we restrict ourselves to integer s1, . . . , sn (accumulation of random numbers always
occur along hyper-planes given by integer si) the resulting vector is given by the Fourier
transform of g,

ˆg (s) =

1
√NX

g (x) exp

2πi
M

(cid:18)

s

x

=

·

(cid:19)

1
√NX

exp

2πi
M

s

·

(cid:18)

Xk

,

(cid:19)

Xk∈ZNX

x∈Zn
X

NX

(8)

6
2 THE GENERALIZED SPECTRAL TEST

5

where we have introduced the normalization factor NX
mulations along the hyper-plane is contained in

−1/2. The information about accu-

2, the phase of ˆg is irrelevant.

We remember that for the mixed multiplicative generator the n-tupels form a lattice
2(s) will assume the maximum value NX if s
(which is displaced oﬀ the origin). So
2(s) is zero. Since
lies in the dual lattice, s
Xk = c(ak
1) mod M this means, if gcd(c, M) = 1 and X has full period, that
k : (ak
∀

1, M) from which Eq. (1) follows (cf. Ex. 4.3 1).

−
1)sa = 0 mod M gcd(a

Xk = C + ℓM, C, ℓ

Z, otherwise

1)/(a

ˆg
|

ˆg
|

−

−

−

∈

|

·

|

ˆg
|

|

2.2 Generalization of the spectral test

We generalize the spectral test by caring for the sequence in which the n-tupels are
generated. The index k is added to the n-tupel Xk as zeroth component and we deﬁne g
as

g (x0, x) =

δx0,kδx,Xk = δx,Xx0 .

(9)

Xk∈ZNX

The geometrical interpretation remains untouched but now we consider also the ﬁgures of
type I. With the Fourier transform of g we introduce some notation that will be needed
later,

ˆgZN1 [N2, M, X] (s0, s) =

1
√N1

exp

s0k +

Xk

.

(10)

2πi
N2

2πi
M

s

·

(cid:18)

Xk∈ZN1
Normally N1 = N2 = NX is the period of X. We write g[N2, M, X] if N1 = N2 and we
also suppress N 2 if N1 = N2 = NX. However, sometimes it is convenient to use a multiple
N 2 of the period NX instead of the period itself. Moreover for some values of (s0, s), e.g.
(0, 0), the right hand side is periodic in k with a smaller period N1|
N2. In this case we
may sum over ZN1 only and use the subscript ZN1. Note that
f (k) always implies
k∈ZN1
that f is a function on ZN1 which means that f is periodic, f (k) = f (k + N1)
k. We
P
also suppress M and X on the left hand if the context is clear.

∀

(cid:19)

The sum over k is hard to evaluate since in the exponential k is combined with X k.

However in fact we are interested in

2 and ﬁnd

2 (s0, s) =

ˆg
|

|

exp

s0 (k′

k) +

−

2πi
M

s

·

(Xk′

Xk)

−

(cid:19)

|

ˆg
|
2πi
NX

(cid:18)

2πi
NX

(cid:18)

1
NX

1
NX

Xk,k′∈ZNX

X∆k∈ZNX

=

exp

s0∆k

exp

2πi
M

(cid:18)

s

(Xk+∆k −

·

Xk)

. (11)

(cid:19)

(cid:19) Xk∈ZNX

The sum over k has no linear k-dependence, only diﬀerences of random numbers occur.
Like in the standard spectral test in many cases the sum over k can be evaluated. The
result is often simple enough to be able to evaluate the sum over ∆k also.

If, e.g., Xk = ak mod P where P is a prime number and a is a primitive element of Z×
P ,
˜k(a∆k

the multiplicative group of ZP , we ﬁnd that s
(Xk+∆k −
1) = sa
−
−
P then ˜k sweeps
= ˜k
1 values of Z×
ZP . If k runs through the P
1) mod P for some 0
. The sum over ˜k can be evaluated yielding P δ∆k=0 −
out the whole ZP \{
1 for sa 6
= 0.
0

Xk) = saak(a∆k

−

∈

}

·

6
2 THE GENERALIZED SPECTRAL TEST

Finally the sum over ∆k gives together with the normalization
(cf. Eq. (52) for d = 1).

ˆg
|

|

2 = P/(P

1)

−

−

δs0=0

Note that the standard spectral test corresponds to s0 = 0. We give some simple

ˆg
results on
|
Lemma 2.1.

|

2 in the following lemma.

ˆg
|

|

ˆg
|
ˆg
|

2[Xk] (s0, c1s)
2[Xk] (s0, s) if

2[c1Xk+c2 + c3] (s0, s) =
=
[c1NX] (s0, s) = c2δs0=0 mod c1|
,
ˆg
|
2 (s0, s) = NX ,

2
Z1 = 1

2
Zc2NX

ˆg
|

ˆg
|

|
|

|

|

|

2 (s0/c1, s) ,

ˆg
|
2 (s0, 0) = NXδs0=0 modNX ,

∃

c0 : c1Xk = Xk+c0 ,

ˆg
|

|

Xs0∈ZNX

ˆg
|

|

s∈Zn
X
M

2 (s0, s) = M n if Xk = Xk′

k = k′ modNX.

⇒

Proof. The proofs are straight forward. We show Eq. (13) to get used to the notation:

6

(12)
(13)

(14)

(15)

q

q

q

q

=

=

=

ˆgZc2NX

[c1NX] (s0, s) =

1/c2NX

exp

s0k +

2πi
c1NX

(cid:18)

2πi
c1NX

(cid:18)

2πi
M

s

·

Xk

(cid:19)

2πi
M

s

·

Xk

(cid:19)

Xk∈Zc2NX

Xk∈Zc1NX

c2/c2

1NX

exp

s0k +

c2/c2

1NX

Xk1∈ZNX Xk2∈Zc1

exp

2πi
c1NX

(cid:18)

s0 (k1 + NXk2) +

2πi
M

s

·

Xk1

(cid:19)

c2/NXδs0=0 mod c1

exp

2πi
NX

s0
c1

(cid:18)

k1 +

2πi
M

s

·

Xk1

.

(cid:19)

Xk1∈ZNX

2
One may also be interested in correlations between non-successive random numbers
(Xk+τ1, . . ., Xk+τn).
s1aτ1 + . . . + snaτn in our results.

like X k and X k+2. In general it is possible to study n-tupels Xk+τ ≡
This amounts to replacing Xk by Xk+τ and sa by sa,τ ≡

2.3 Valuation with the generalized spectral test

|

Now we have to clarify how the calculation of

We can not expect that

ˆg
|
|
would be constant. Eq. (15) shows that the mean value of

2 leads to a valuation of the generator.
2 vanishes identically outside the origin since in this case g
ˆg
|

2 is 1.

ˆg
|

What would we expect for a sum of truly random phases? Real and imaginary part
of a random arrow with length 1 have equal variance 1/2. For large NX the sum of
(x2 + y2)/NX)dxdy =
arrows is therefore normally distributed with density 1/πNX ·
z) for a true random sequence
exp(
ˆg
and the expected value for
|
This means that values of

r2/NX)dr2/NX. Thus z =

2 has the density exp(

1 can be accepted.

exp(

−

−

−

|

|

ˆg
|
|
2 is 1.
2
ˆg
|

|

≤

It is clear that for a given
2(s0, s) > 1 is. But what does the

= (0, 0) the correlations are worse the higher

(s0, s)
location of an (s0, s) with

2(s0, s) > 1 mean for the generator?

ˆg
|

|

ˆg
|

|

6
2 THE GENERALIZED SPECTRAL TEST

7

We remember that (s0, s) may be seen as normal vector on the hyper-plane along which
the accumulations occur. If e.g. n = 1 and (s0, s1) = (1, 1) the corresponding 1-plane has
the equation x0 +x1 = 0 (cf. e.g. Figs. 4I, 5I). If the k-axis and the X k-axis are normalized
to length 1 this line has length √2. With the normal vector (3,1) (cf. Fig. 6I) one obtains
the equation 3x0 + x1 = 0 mod 1 which intersects the unit cube three times and therefore
has the length √32 + 1 = √10. Accumulations along this longer line are less important
than along the short line. In the extreme case where the line ﬁlls the whole unit cube
by intersecting it very often, accumulations can hardly be recognized. Note that in this
sense the normal vectors (s0, s1) and (2s0, 2s1) do not determine the same line. The latter
one contains e.g. the points (1/2, 0), (0, 1/2), (1, 1/2), (1/2, 1). It has twice the length of
2 has half the eﬀect.
the former one and too large a

We generalize these considerations to n > 1 by taking the area of the n-dimensional
hyper-plane with normal vector (s0, s) as measure for the importance of the accumulations
0 + s2)1/2, the Euclidean length of the normal
detected. The area is given by
vector.

(s0, s)

= (s2

|

|

ˆg
|

|

We can relate both mechanisms by deﬁning the quality parameter

Qn (s0, s)

(s0, s)
|
ˆg (s0, s)

|
|

≡

|

2 , Qn ≡

max (s0,s)∈ZNX ×Zn

M \{0,0}Qn (s0, s) .

(16)

Good generators have Q1 ≈
1 for n > 1 (see however Sec.
1. It is hard to achieve Qn ≈
M 1/n−1 (cf. Sec. 5) which means that the distribution of
4.5). More realistic is Qn ≈
n-tupels deteriorates for higher n. In general small n are more important than large n.
Apart from the value of Qn also the number of sites (s0, s) at which Qn(s0, s) = Qn is
relevant (cf. Ex. 4.3 1.(a)).

ˆg
|

M. Then

Let us try to ﬁnd an interpretation for Qn. Assume the generator produces only mul-
2(0, s1 = M/t, 0, . . ., 0) = NX, thus Qn(0, M/t, 0, . . ., 0) = M/tNX,
tiples of t
|
|
and NXQn determines the number of non-trivial digits. In general NXQn may be larger
than M and therefore we say that ˜Mn ≡
max(NXQn, M) determines the number of digits
we can rely on. Analogously ˜Nn ≡
max(NXQn, NX) gives the quantity of random num-
bers for which the n-tupel distributions are reasonably random. Speciﬁcally ˜Mn(s0, s) =
max(NXQn(s0, s), M) determines the digits and ˜Nn(s0, s) = max(NXQn(s0, s), NX) the
quantity of random numbers not aﬀected by accumulations perpendicular to (s0, s) (cf.
[2, ,p. 90]).

Note however that these are only crude statements. If, e.g., the ’period’ of the gen-
erator is enlarged by simply repeating it then NXQn(s0, s) remains unaﬀected only if
2(s0, s) may be harmful even if
s0 = 0. Moreover, a high
is large (cf. Fig. 3I
with Q1 > 1).

(s0, s)

ˆg
|

|

|

|

Note that Qn is a relative quality parameter. Although Qn usually does not increase
with larger modulus (for n > 1 is actually decreases) the quality of the generator gets
better since NX grows (cf. Fig. 4 vs. Fig. 8).

3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

8

3 Multiplicative groups of residue class rings

This section provides the mathematical tools that are needed to analyze several random
2 for Xk = ak mod M for
number generators. We derive Eq. (44) which determines
various moduli M and multipliers a. There are some connections to the theory of Gauß
sums (see e.g. [6,
3]) where however the calculation of the absolute is almost trivial. In
our case the exponent is not quadratic but has a linear and an exponential component
(cf. Cor. 3.5, but also Ex. 4.6 4). The modulus is not restricted to a prime number. We
are concerned with residue class rings rather than with ﬁelds.
Throughout the paper we use the following notation,

ˆg
|

§

|

ZM ≡
Z×
M ≡
a
iM ≡ {
sa ≡
N
≡

h

δa=b = 1

Z/ZM integers mod M .
multiplicative group of ZM , a
ak mod M, k
Z
∈
}
n
j=1 sjaj−1 ,
sa,M ≡
, the order of a mod M ,

gcd (sa, M) .

Z×

∈

, the cyclic group of a mod M .

gcd (a, M) = 1 .

M ⇐⇒

a
iM |

Na,M ≡ |h
P
the subscripts a and M are suppressed except for in sa and sa,M .
= b .

if a = b ,

δa=b = 0

if a

Deﬁnition 3.1. Let M
∈
positive integer with (Nm =

N, a
∈
a
)
im|

Z×

M . Then m

ma ≡

mM ≡

≡

ma,M is the smallest

|h
m contains every prime factor of M,
4

m if 8

M,

|
|
m = gcd

aNm
(cid:16)

−

1, M

.

(cid:17)

Moreover

m0 ≡

gcd (m, M/m) , M0 ≡

M/mm0 = M/ gcd

m2, M

.

(cid:16)

(cid:17)

In practice m is easily determined by Eq. (28). We begin with a technical proposition.
Proposition 3.2. For M1|

M we deﬁne

M, a

Z×

∈

aNm

1

1

c

≡

−
m ·

1 + m
1 + m
(cid:16)
2
(cid:16)
With this deﬁnition we obtain for Xk = ak

2 + M





(cid:17)

(cid:17)

4

if M1 odd,
if M1 even, M = 4 mod 8 and m = 2 mod 4,
else.

Z×

M/m ,

c

∈

m2M1, M

,

(cid:17)
Z×
M/m with aNmk = 1 + ckmk mod M ,

(cid:16)

aNmM1k = 1 + cmM1k mod gcd
ck ∈
∃
ˆg =

δ NmM

√N
NmM1

Xk∈ZNmM1

mN s0+saakc=0 mod M
mM1

exp

2πi
N

(cid:18)

2πi
M

s0k +

saak

, if M

m2M1. (26)

(cid:19)

|

(17)

(18)
(19)

(20)

(21)

(22)

(23)

(24)

(25)

6
3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

9

=

√N
Nm

Xk∈ZNm

δms0+saak(aNm −1)=0 mod M exp

s0k +

saak

, if M

m2.

(27)

2πi
N

(cid:18)

2πi
M

(cid:19)

|

Proof. Eq. (23) is an immediate consequence of Def. 3.1. Moreover

aNmM1k

=

aNm

(cid:16)

−

(cid:17)

1 =

aNm
(cid:16)
M1k

1 +

−

1

1 + 1

−
M1k
2

(cid:17)
1
−

 

M1k

1

−

aNm

1

−

(cid:16)

+

aNm

1

−

!

(cid:17)

(cid:16)

M1k

2

M1k

(cid:17)

Xj=3  

j !

(cid:16)

aNm

j−2

.

1

−

(cid:17)

M1k
j

(cid:17)

∋

=

≥

M1k
j

M1k−1
j−1

3 and aNm

2 prime factors for j

. Since j has at most j

−
(cid:16)
every prime factor of M 1 we obtain N

First we show that the sum over j is a multiple of M 1. Obviously N
M1k−1
j−1

(cid:16)
1 has by deﬁnition
(aNm
1)j−2/M1.
−
1)M1k(1 +
m/2) mod m2M1 if M 1 is even. Finally the term M/4 can be added without harm if M 1
is even and M = 4 mod 8. This gives Eq. (24).
Let M2 = max j gcd(k, M j). Then k2 ≡

−
1)M1k mod m2M1 if M 1 is odd, and (aNm

Z×
M and with M1 ≡

The ﬁrst term equals (aNm

we have gcd(m2M1, M) = gcd(m2M2, M) = ℓ1m2M2 + ℓ2M for some ℓ1, ℓ2 ∈
k−1
2 ∈
ck ≡

Z Eq. (24) gives aNmk = 1 + cmk + ℓ3ℓ1m2M2k2k−1

Z×
M , ℓ3 ∈
c + ℓ3ℓ1mk−1

M/m from Eqs. (18), (23).

Eq. (26) is obtained if one plugs Eq. (24) into the deﬁnition (10) of ˆg. We ﬁnd

gcd(M2, M)
Z. With
2 mod M. We ﬁnd

(aNm
(cid:17)

k/M2 ∈

1)j−2k/j =

−
M1k
j

2 ∈

Z×

−

−

∋

(cid:16)

(cid:17)

(cid:17)

(cid:16)

ˆg

(13)
=

=

1
M1√N
1
M1√N

exp

s0k +

2πi
N

(cid:18)

saak

(cid:19)

Xk∈ZNM1

Xk∈ZNmM1 Xk′∈Z

N/Nm

exp

(cid:18)

2πi
M

2πi
N

s0 (k + NmM1k′) +

saak (1 + cmM1k′)

.

2πi
M

The sum over k′ gives the Kronecker δ and we get Eq. (26).

Finally Eq. (27) will be obtained for M1 = 1 with Eq. (36). This equation will next
2

be derived independently of Eq. (27).
Lemma 3.3.

If m′ is the smallest number that meets Eqs. (18), (19) then

Nm

2k p

Nm = Nm′ , m = gcd

aNm′
= N2k0 p1···pℓ = lcm (N2k0 , Np1, . . ., Npℓ) ,

k1
1 ···p
if p1, . . ., pℓ are odd, prime and k0 = min (k, 2) .

1, M

−

kℓ
ℓ

(cid:17)

(cid:16)

.

Nm = 1
⇔
M = P d, 2
M = 2d, d
M ′
M
⇒
mm = m .

|

m = gcd (a
−
−
= P prime: a is primitive,

1, M)

⇔

a

1 meets conditions 1 and 2 of Def. 3.1.
1 .
m = P

Nm = P

iP d = Z×
a
Nm = 1 ,

P d ⇔
a = 3 mod 4

h

∧

Nm = 2 .

−

⇔

3 : a = 1 mod 4
Nm , mM ′

m .

⇔

≥
NmM ′ |

|

(cid:19)

(28)

(29)
(30)
(31)
(32)
(33)
(34)

6
3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

im + mZM/m .
a
a
iM =
h
h
N
Nm
.
=
M
m
mm0 = mM/m .
NM/m
Nm0

N
NM/m

= M0 ,

=

Nmm0
Nm0

.

Nm0 = gcd

NmaA =

.

Nm, NM/m
(cid:16)
Nm
gcd (Nm, A)

(cid:17)
, maA =

Nm

NM/m

a

=

, ma

NM/m =

Nm
Nm0

M
m0

.

gcd (N, A) m
gcd (Nm, A)

.

10

(35)

(36)

(37)

(38)

(39)

(40)

(41)

Proof. Obviously m′
im. Since m is
a
Nm since
minimal we ﬁnd Nm = Nm′ and thus Eq. (28). Eqs. (29)–(34) follow directly from Eq.
(28).

a
im′ is a subgroup of

m and thus Nm′

h

h

|

|

∈

Z×

We use Eq. (26) with s0 = 0 and n = 1 to Fourier transform

iM . We choose M 1
a
with s1m2M1 = 0 mod M and obtain that ˆg vanishes unless caks1mM1 = 0 mod M. Since
Z×
M/m (Eq. (23)) this implies s1mM1 = 0 mod M. Thus for non-vanishing
M , c
a
ˆg and M ′
1 = 0 mod M which enables us to use Eq.
(26) again (with M 1 replaced by M ′
1 = 0 mod M.
Since m contains every prime factor of M and M1|
1 = 1 and
ﬁnally we obtain

1) yielding the stronger condition s1mM ′

1 = M1/ gcd(M1, m) we have s1m2M ′

M we can continue until M ′...′

∈

h

ˆg[N] (0, s) = √N/Nmδs1=0 modM/mˆg[Nm] (0, s) .

(42)

This ﬁxes
∈
statement of Eq. (35) and Eq. (36) follows immediately.

a
iM to be

ak + k′m mod M, k

ZNm, k′

h
From mM/m|
mM/m = mmM/m|
Eq. (38) follows from Eqs. (36), (37):

{
M/m and mM/m|
mm0|

∈
m (Eq. (33)) we get mM/m|

mM/m, thus Eq. (37) is veriﬁed.

ZM/m}

(Eq. (13)). This is the

m0. Eqs. (34) and (33) give

NM/m

(36)
=

M
m

NmM/m
mM/m

(37)
=

MNmm0
mmm0

(36)
=

MNm0
mm0

(36)
=

NNm0
Nmm0

.

To prove Eq. (39) we begin with

m0
Nm0

gcd

Nm, NM/m

(36),(37)
=

(cid:16)

(cid:17)

mM/m
NmM/m

gcd

Nm, NM/m
(cid:16)

(cid:17)

(36)
= gcd

NmmM/m
NmM/m

,

M
m !

 

.

We will show that the right hand side equals m0. From Eq. (25) we know that there exists
a c′

with

Z×

∈

M/m
mM/m

cm

aNm

1 = a

≡

−

NmM/m

Nm
NmM/m

1 = c′mM/m

−

Nm
NmM/m

mod

M
m

.

3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

11

Z×

Since c

M/m we have also c, c′′

∈
there exists a k
∈
hand side of the ﬁrst equation (c′′

cc′−1

Z×

M/m
mM/m

∈

≡

Z×

M/m
m0

∈

, Eq. (37))

Z with NmmM/m/NmM/m = kM/m + c′′m. Finally we ﬁnd for the right

and the above equation implies that

gcd

mM/mNm/NmM/m, M/m
(cid:17)

(cid:16)
aANm

= gcd (kM/m + c′′m, M/m) = m0 .

maA

Since m
|
number with this property, so NmaA = Nm/ gcd(Nm, A). Moreover we ﬁnd

ANmaA . On the other hand NmaA is the smallest

1, we get Nm|

−

aA

|

maA

(36)
=

NmaA M
NaA

(40)
=

NmM
gcd (Nm, A) NaA

=

NmM gcd (N, A)
gcd (Nm, A) N

(36)
=

gcd (N, A) m
gcd (Nm, A)

.

Finally the ﬁrst statement of Eq. (41) follows from Eq. (40) and Eq. (39). Moreover

ma

NM/m

(40)
=

m

gcd

N, NM/m
(cid:16)
gcd

(cid:17)
Nm, NM/m
(cid:16)

(cid:17)

(39)
=

NM/mm
Nm0

(38),(21)
=

M
m0

.

Theorem 3.4. For M
ˆg
obtain for
|

|

X0 ≡
2 deﬁned in Eq. (10) and m, m0 given by Def. 3.1,

N let Xk = ak mod M. If a, s

∈

·

sa ≡

2[N, X•] (s0, s) =

ˆg
|

|

1
Nm

ˆg
|

|

P

·

2
M we

Z×

n
j=1 sjaj−1

∈

2[N/NM/m, Xk+NM/m•] (s0, s

X0)

(43)

Xk∈ZNm
[N/NM/m, Xk+NM/m•] (s0, s

X0) ,

·
Xk)/m = m0

ZNm0 : s0 + s

(XNm+k −

·

2 δ2| M

mm0

mod m0 ,

(44)

Nm/Nm0

m0
Nm0 |
if

2
Z

ˆg
|

k

∈

∃
else .

0

= 



Corollary 3.5. For all sa and all generators of the type

Xk = c1ak + c2k + c3 mod M

(45)

with period NX we have

ˆg
|

2[NX, M, X] (s0, s) =

|
M ′ = M/ gcd (c1sa, M) , N ′ = NM ′ ,

2[N ′, M ′, X]

NX
N ′ |

ˆg
|

N ′
NX

 

s0,

M ′
M

s
!

, with

(46)

and for the right hand side of Eq. (46) Eqs. (43), (44) apply. With m′ = mM ′, m′
M ′

0 = M ′/m′m′

0 we obtain

0 = m0M ′,

2[NX, X•] (s0, s) =

ˆg
|

|

NX
Nm′Nm′

2
Z

ˆg
|

0M ′
0 |

N

m′ /N

m′
0

ZNm′

0

:

Nm′s0
NX

if

k

∈

∃
else .

0

[

NX
0M ′
Nm′
0
s

+

·

(cid:16)

0

, Xk+Nm′
XNm′ +k −
M

0•] (s0, s

M ′

X0) ,

Xk

=

(cid:17)

·
δ2|M ′
2M ′
0

0

mod

1
M ′
0

,

(47)






3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

1
N

1
Nm
1
Nm

1
Nm

1
Nm

=

=

=

=

The denominators in the above condition are understood according to

0 ⇐⇒
Proof of the theorem. We start with Eq. (11)

a/b = c/d mod 1/M ′

adM ′

0 = cbM ′

0 mod bd .

2 =

1
N

ˆg
|

|

(35)
=

exp

s0∆k +

saak

a∆k

2πi
N

(cid:18)

2πi
M

1

−

(cid:17)(cid:19)

Xk,∆k∈ZN

Xk∈ZNm Xk′∈Z

M/m X∆k∈ZN

exp

s0∆k +

2πi
N

(cid:18)

δsa(a∆k−1)=0 modM/m exp

Xk∈ZNm X∆k∈ZN

Xk∈ZNm X∆k∈Z
[ replace ∆k by ∆k

N/NM/m

exp

NM/ms0∆k +

2πi
N

(cid:18)

∆k′ and k by k + NM/m∆k′]

(cid:16)
2πi
M

2πi
N

(cid:18)

sa

ak + mk′
(cid:16)

(cid:17) (cid:16)

a∆k

1

−

(cid:17)(cid:19)

s0∆k +

saak

a∆k

1

−

(cid:17)(cid:19)

(cid:16)

2πi
M

2πi
M

saak

aNM/m∆k
(cid:16)

1

−

(cid:17)(cid:19)

−
exp

2πi
N

NM/ms0 (∆k

∆k′) +

saak

aNM/m∆k

−

2πi
M

(cid:16)

aNM/m∆k′

−

(cid:17)(cid:19)

Xk∈ZNm X∆k∈Z

N/NM/m

(cid:18)

[ average over ∆k′ with NM/m/N

2[N/NM/m, X˜k = ak+NM/m

ˆg
|

|

Xk∈ZNm

]

X

∆k′∈Z

N/NM/m
˜k] (s0, sa)

which proves Eq. (43).

Now we split the k-sum according to k = k0 + gcd(Nm, NM/m)k′ = k0 + Nm0k′. One
. So k =
˜k + k′ of

Z×
can replace k′ by NM/m/Nm0k′ since k′
k0 + NM/mk′ and the k′-dependence drops, since it amounts to a shift ˜k
X˜k = ak+NM/m
Since ma

˜k (cf. Eq. (12)). The sum over k′ gives simply Nm/Nm0.
NM/m = 0 modM/m we have (ma
NM/m = 0 mod m and ma

ZNm/Nm0 and NM/m/Nm0 ∈

NM/m )2 = 0 mod M

and Eq. (27) applies with a replaced by aNM/m and sa by aksa. With Eq. (41) we get

Nm/Nm0

7→

∈

2 =

ˆg
|

|

1
Nm0

N/NM/m
Nm/Nm0 ·

Nm0
Nm ·

Xk∈ZNm0

δ s0M
m0

(cid:12)
(cid:12)
(cid:12)
Xk′∈Z Nm
(cid:12)
(cid:12)
Nm0
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k+NM/mk′

+saa

NM/m Nm/Nm0 −1)=0 mod M

(a

exp

NM/ms0k +

saak+NM/mk′

2πi
M

2πi
N

(cid:18)

The k′-dependence drops mod M (Eq. (38)) in the argument of the Kronecker δ. The
k′-sum interchanges with the Kronecker δ and we obtain with Eq. (38)

2 =

ˆg
|

|

m0
Nm0

δ M
m0

Xk∈ZNm0

s0+saak(aNmM0 −1)=0 mod M |

ˆg
|

2
Z Nm
Nm0

[N/NM/m, Xk+NM/m•].

12

(48)

2

.

(cid:12)
(cid:12)
(cid:12)
(cid:19)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

3 MULTIPLICATIVE GROUPS OF RESIDUE CLASS RINGS

13

We use Eq. (24) with M1 = M0, k = 1 yielding mod M

aNmM0

1 = c

=

−

M
m0

M
m0  

aNm

1
−
m ! (cid:18)

1 +

m
2

δ2| M

mm0 (cid:19)

(25)
=

M
m0  

aNm
m

−

1

+

m
2

δ2| M

mm0 !

.

−

M
,
mm0
m0/2 mod m0. Since the k-sum has at most one non-vanishing
2
jaj−1 =

Finally we divide the argument of the Kronecker δ by M/m0 and notice that, if 2
we have m/2 = m0/2 =
term we obtain the desired result.
Proof of Cor. 3.5. With the deﬁnition s′
M ′. With ˜NX ≡
Z×
c1sa/ gcd(c1sa, M)
2πi
NX

M ′c1s/M we ﬁnd s′

lcm(NX, M) we obtain

2 (s0, s) =

c1saak + c2

sj (k + j

1 + c3)

n
j=1 s′

s0k +

a ≡

exp

ˆg
|

−

≡

P

∈







n

|

|

2

2πi
M 

˜NX
M

s0 +



2πi
˜NX

exp

˜NX
NX

1
NX (cid:12)
Xk∈ZNX
(cid:12)
(cid:12)
(cid:12)
(cid:12)
1
(cid:12)
NX (cid:12)
Xk∈ZNX
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
k∈ZNX

=

Xj=1

k +

2πi
M ′ s′

aak

2

.

n

c2

sj 


(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)







(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
k′∈Z ˜NX /N′ with
We can replace
(cid:12)
k = k0 + N ′k′. The exponential depends linearly on k′, thus the sum over k′ gives a
Kronecker δ,

. This sum splits into


by NX/ ˜NX


k∈Z ˜NX

Xj=1

k0∈Z

P

P

P

P



N′

2

2

=

NX
N ′ δ ˜NX N ′

1
NX (cid:12)
Xk∈ZNX
(cid:12)
(cid:12)
(cid:12)
(cid:12)
The Kronecker δ assures that s′
(cid:12)
over k gives N ′
ˆg
|
Eq. (48) the condition in Eq. (44) becomes

. . .
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
2[N ′, M ′, X ′

0 ≡
k = ak](s′

|

s0/NX +c2

n
j=1 sj /M

. . .
(cid:12)
(cid:12)
(cid:12)
(cid:16)
(cid:12)
(cid:12)
N ′(s0/NX + c2
(cid:12)
0, s′) and Theorem 3.4 applies. With δs′

1
N ′ (cid:12)
Xk∈Z
(cid:12)
N′
(cid:12)
(cid:17)
(cid:12)
(cid:12)
n
j=1 sj/M) is an integer. The sum
(cid:12)
0 integer and

=0 mod ˜NX

P

.

P

N ′

s0
NX

 

c2

+

n
j=1 sj
M !

P

+

M ′c1sa
Mm′ ak

(36)
=

N ′
NX

s0 +

M ′
Mm′ 


aNm′
(cid:16)

n

1

=

−

(cid:17)

δ2|M ′

0 mod m′

0

m′
0
2





m′
0
2

sj −

Xj=1
(XNm′ +k −

c1saaNm′ +k + c2Nm′

c1saak

=

δ2|M ′

0 mod m′

0 .

The expression in the brackets equals s
invariance of the condition in Eq. (44) as claimed in Eq. (46). Similarly

·

Xk). So we have conﬁrmed the

2[N ′/NM ′/m′, M, X ′

k+NM ′/m′ •] (s′

0, s′

X′

0)

ˆg
|

|

·
NM ′/m′
M

n

c2

NM ′/m′
NX

s0 +

=

exp

2πi









=

(cid:12)
(cid:12)
Xk′
Xj=1
(cid:12)
(cid:12)
2[N ′/NM ′/m′, M ′, Xk+NM ′/m′ •] (N ′/NX ·
ˆg
(cid:12)
(cid:12)
|
|
2[NX/NM ′/m′, M, Xk+NM ′/m′ •] (s0, s
ˆg
|
Altogether we have proven that
Eqs. (21), (36), (38), (44) we ﬁnd Eq. (47).

ˆg
|

=

|

|

·

X0) .

c1saak+NM ′/m′ k′

k′ +

2πi
sj 
M

s0, M ′/M

s

X0)

·

·

2





(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

2[NX, M] is given by Eqs. (43), (44) and Eq. (46). With
2

4 GENERATORS

4 Generators

14

4.1 X0 = c, Xk+1 = aXk mod M

= a, c

We assume that 1
M . Generators of this type are called multiplicative. The
recursion formula implies Xk = cak mod M. The harmonic analysis of many multiplicative
generators is easily obtained by Eqs. (44) and (47).
Examples 4.1.

∈

Z×

−

1. Nm = 1 (Fig. 1). We ﬁnd m = gcd(a
1)2, M)/ gcd(a

−
1, M) and M0 = M/ gcd((a

gcd((a
With M ′ = M/ gcd(sa, M) = M/sa,M we get Nm′ = Nm′
0 = gcd(m′2 gcd(sa, M), M) = gcd( gcd((a
1, M ′) and M/M ′
gcd(sam2, M) = mm0 gcd(sa, M0) = mm0sa,M0. Thus

−

−

1, M), N = M/m, m0 = gcd(m, M/m) =
1)2, M).

0 = 1, m′ = gcd(a

−
1)2, M ′2)sa, M) =

−

M ′

0 = M0/sa,M0 if Nm = 1 .

(49)

We obtain from Eq. (47)

2 (s0, s) = m0sa,M0δs0+csa(a−1)/m= 1

ˆg
|

|

2 m0sa,M0 δ

mod m0sa,M0

2|

M0
sa,M0

.

(50)

In the case of a power of two modulus M = 2d with m = 4 (m = 2 is not possible
for d > 2) we obtain for a proper choice of a (cf. Sec. 5)

NX = M/4 , Q1 = √2/4 , Qn≥2 ≈

M 1/n−1 .

(51)

If we look at correlations of k with X k, disregarding higher n-tupels, we get ˜N1 =
˜M1 = NQ1 = √2M/16 reasonable random numbers with log(√2M/16) digits.
A detailed discussion is postponed to the next section where we analyze the mixed
multiplicative generator which is very similar but more popular than the multiplica-
tive generator.

2. M = P d, P is odd, prime and a is a primitive element of Z×

(Figs. 2, 3). We ﬁnd Nm = P
m0 = P if d
2.

−

1, m = P , N = (P

−

P d,

Z×
iP d = Z×
a
P d
1)P d−1, m0 = 1 if d = 1 and

P d, c

∈

h

≥

= 0 mod P (Eq. (12)). With Eqs. (14), (15) we obtain (P

2 from the very deﬁnition. In fact it is even simpler to observe that

For the case d = 1 Eq. (44) is useless. However, we saw in Sec. 2.2 how to calculate
2 is constant
ˆg
|
|
for all sa 6
2(s0, sa 6
ˆg
1)
|
|
2 we obtain for sa 6
If d
≥
δs0+saak(aP −1−1)/P mod P = P/(P

2(s0, s) = P/(P
k∈ZP −1
δs06=0 mod P . For general sa we use Eq. (46) and

= 0) = P with the result given in Eq. (52).

ˆg
|
|
1)δs0=0 + (P

= 0 mod P from Eq. (44)

ˆg
|

1)

1)

−

−

−

|

·

P

−

·

6
4 GENERATORS

obtain the result

15

(52)

s0 = 0

|

2 (s0, s)
ˆg
|
sa = 0

P d−1 (P
1 P d−1/ (P
2
0
gcd

λ = d
−
λ
d
−
where sa,P d

≤

1)
1)

−
−

sa, P d

s0 6
= 0
0

P dδµ=d−1/ (P
P λ+1δµ=λ/ (P
s0, P d

P λ , gcd

−
−

1)
1)

P µ .

≡

≡
≡
1)/P is independent of a and even greater
2 only the case (s0, sa) = (0, 0) contributes to Qn and the discussion

We ﬁnd that Q1 = Q1(P λ, P λ) = √2(P
than 1. For n
is equal to the case with power of two modulus presented in Sec. 5. We ﬁnd

≥

−

(cid:16)

(cid:16)

(cid:17)

(cid:17)

NX = (P

1) P d−1 , Q1 = √2 (P

−

1) /P , Qn≥2 ≈

−

P 1/n−1 .

(53)

−

b = c12k + c2 leads to a

In particular ˜N1 = P

From a mathematical point of view odd prime number moduli give good random
1, ˜M1 = P whereas for a power of
number generators.
two modulus M we had ˜N1 = ˜M1 = √2M/16. So we need M > 16P d/√2 to
obtain power of two multiplicative generators which behave better than generators
with powers of odd prime numbers. However, one has to take into account that
computers calculate automatically modulo powers of two. Moreover, the power of
two generator will be improved in the next sections until we achieve Q1 = 1 (cf. Sec.
4.4). As a byproduct a better behavior of Qn for n
Best performance allow prime numbers of the form P = 2k
1 [2]. In this case
a
c1 mod P . The extra eﬀort, compared with
a calculation mod 2k is one addition and, which is more important, the calculation
of c1. In Ex. 5.1 1 we discuss the improved generator with M = 2256 which can
most easily be changed to M = 2128. Alternatively one may construct a generator
mod 2127
1 which is a prime number. This generator will however be more time
−
consuming and moreover it has worse quality ˜N1 ≈
2127, ˜N2 ≈
242.3,
etc. vs. ˜N1 = 2129, ˜N2 ≈
265, etc. for the generator with power of two
modulus (cf. Sec. 4.4, Sec. 5). So, power of two generators are more eﬃcient than
multiplicative generators with prime number modulus. The situation is slightly
diﬀerent if one considers multiply recursive generators with prime number modulus,
analyzed in Sec. 4.5 and Ex. 5.1 2.

263.5, ˜N3 ≈

286.3, ˜N3 ≈

2 is obtained, too.

b = c2 ∓

≥

±

·

·

Multiplicative generators with prime number modulus and primitive a produce every
= 0 mod P exactly once in a period. We recommend to use a prime
random number
number modulus only if one needs this quality.

3. M = 2d, c = 1, a = 3 mod 8 (the cases a = 1, a = 5 mod 8 were discussed in Ex. 1).
This example and the following ones are less interesting from the random number
point of view. They are discussed to demonstrate how Eq. (44) applies in less trivial
cases. We restrict ourselves to sa ∈
if d
≥
if d = 1, 2

if d
≥
if d = 1, 2

if d
≥
if d = 1, 2

M and ﬁnd

2d−2
2d−1

, N =

, m =

Nm =

Z×

8
2

2
1

3

3

3

,
















6
4 GENERATORS

16



8
2d−3
2
1

if d
6
≥
if d = 3, 4, 5
if d = 2
if d = 1

m0 =

, Nm0 =






The most complicated case is d = 4 where we get
exp( 2πi
16 s0) + exp( 2πi
16 (4s0 + asa))
obtain the following table
(cid:12)
(cid:12)
(cid:12)



(cid:12)
(cid:12)
(cid:12)

2

2
1

if d
if d

5
4

≥
≤

.

= 2δs0=1 mod 2(1 + cos( π

ˆg
|

|

2(s0, s) = δs0+sa(a2−1)/8=0 mod 2 ·
1)sa))). We
−

8 (4s0 + (a

M = 2d
d
7
≥
d = 6
d = 5

d = 4

d = 3
d = 2
d = 0, 1

|

ˆg
|

2 (s0, s)
k=0,1 δs0+sa3k(a2−1)/8=4 mod 8
k=0,1 δs0+sa3k(a2−1)/8=0 mod 8

4
4

P

P

2δs0=1 mod 2
sa = 1, 3 mod 8
s0 = 0, 2 mod 4
0
√2
s0 = 1 mod 4
√2
s0 = 3 mod 4
upper sign: a = 3 mod 16, lower sign: a = 11 mod 16
1
2δs0=1 mod 2
1

sa = 5, 7 mod 8
0
√2
√2

∓
±

±
∓

2
2

2
2

(54)

and Q1 = √2/4, Qn≥2 ≈

≥

M 1/n−1 for d

6 like in the case a = 5 mod 8.

4. M = 10d, c = 1, a = 3, gcd(sa, 10) = 1. We ﬁnd

9

d

M = 10d Nm m
80
80
2d
·
10

≥
d
≤
≤
d
≤
≤
d = 1

4
4
4
4

8
4

5

5
2

N
10d−2
10d−2 5
5d−1
4

m0
80
2d−4
5
1

·

5
·
5
·
4
·

Nm0
4
4
4
1

20
2d−6

P

5

·

|

ˆg
|

2 (s0, s)
3
k=0 δs0+3ksa=40 mod 80
3
k=0 δs0+3ksa=0 mod 5·2d−4
δs06=0 mod 5
5/4
P
1/4 + δs06=0 mod 4

·

and Q1 = √2/20, Qn ≤

−

Qn(0,

3, 1, 0, . . ., 0) = 2

103/2−d, if d

·

8.

≥

5. M = 27

·

7, c = 1, a = 3, gcd(sa, 14) = 1. This example illustrates all aspects of
3, M/m = 24, NM/m = 4,
2(s0, s) = 4/3

2. We ﬁnd Nm = 6, m = 8

3 mod m0. Eq. (44) gives

7, N = 25

1)/m =

·

·

−

−
Z3[N = 24, M = 27
2
4)sa = 3ksa + 4 mod 8.

·

7, a = 34](s0, 3ksa).

ˆg
|

|

(55)

·

ˆg
calculating
|
|
m0 = 8, Nm0 = 2, (aNm
k=0,1 δs0−3k+1sa=4 mod 8|
ˆg
|
3k+1sa = 3k(1

Firstly,
P

−
Secondly, in the
yielding

ˆg
|

|

−

·

2
Z3 we sum over k′
ˆg
|
2[N = 3, M = 27

|

7, a = 332](s0, 3ksa).

∈

Z3. Since 8

∈

Z×

3 we can replace k′ by 8k′

4 GENERATORS

17

Finally, we notice that 332 = 1 mod 27. With the Euclidean algorithm we ﬁnd
integers c1, c2 with 1 = 27c1 + 7c2. This plugged into the deﬁnition of ˆg gives
7 sa332k′c1 + 2πi
exp( 2πi
27 sac2). The second term is inde-
pendent of k′ and drops in
2. Since 332 = 2 mod 7 and c1 = 2−7 = 4 mod 7 we
obtain with Eq. (12)

M sa332k′(27c1 + 7c2)) = exp( 2πi

ˆg
|

|

2 (s0, s) =

ˆg
|

|

4
3

Xk=0,1

δs0+3ksa=0 mod 8|

ˆg
|

2[N = 3, M = 7, a = 2]

s0, 3ksa
(cid:16)

(cid:17)

.

An explicit calculation (cf. Eq. (91)) is needed to obtain

|

ˆg
|

2 (s0, s)
s0 = 0 mod 3
s0 = 1 mod 3
s0 = 2 mod 3

sa = 1, 9, 11 mod 14 sa = 3, 5, 13 mod 14

2/3

2/3

8/3
√21
7
7 + √21
(cid:17)
(cid:17)

−

(cid:16)

(cid:16)

·

·

2/3

2/3

8/3
7 + √21
√21
(cid:16)
(cid:17)
7
(cid:16)

−

(cid:17)

·

·

2 (s0, s) = 0

ˆg
|

|

if

k

0, 1 with
∃
s0 + 3ksa = 0 mod 8

∈

else .

(56)

4.2 X0 = 0, Xk+1 = aXk + c mod M

= a, c

Let 1
Generators of this type are called mixed multiplicative.

M . The recursion formula implies Xk = c(ak

∈

Z×

−

1)/(a

1) mod M.

−

There are two ways of deriving the mixed multiplicative generator from the multi-

plicative generator.

−

Xk+1−

Firstly, we expect from a good generator to have random diﬀerences ∆Xk ≡

Xk.
1)Xk mod M and in deed for the
For the multiplicative generator we have ∆Xk = (a
case M = P d, (Ex. 4.1 2) where the multiplicative generator was good, the diﬀerence
generator has the same quality as the original one. However if M = 2d obviously a
1
and M have common divisors. If e.g. a = 5 mod 8 then (∆Xk)k produces only multiples
of 4 which deteriorates the randomness of the sequence. This suggests to use the sum
generator ΣXk ≡
1) which is the mixed multiplicative generator.
c and
c produces only
X k diﬀer only by a shift they have the same quality. The ﬂaw that Xk −
multiples of gcd(a
1 which yields the mixed
multiplicative generator.
Theorem 4.2. Let B be deﬁned by

1)/(a
−
−
1 divides Xk −
1, M) can be corrected by a division by a

1) mod M. Since Xk −

Secondly, we observe that a

k−1
j=0 Xj = c(ak

c = c(ak

−

−

−

−

−

P

B

≡

max k gcd

1, M k

a
(cid:16)

−

(cid:17)

(57)

= a, c

then the Fourier transform of the mixed multiplicative generator X0 = 0, Xk+1 = aXk +
Z×
M is given by Thm. 3.4 and Cor. 3.5 with MB and XB instead of
c mod M, 1
M and X, respectively.
Z×
Proof. From a, c, (a
1)/B
1)/B mod MB by B
inverse of (a
applies with XB and MB instead of X and M.

Z×
M B. If we denote the
1)/MB mod 1. Cor. 3.5
2

M we conclude a, c, (a
1)/B
−
a−1 we have Xk/M = c B
a−1 (ak

∈
−

−

−

∈

∈

6
6
4 GENERATORS

Example 4.3.

1. NmM B = 1 which is equivalent to

18

(59)

(36)
=

(60)

(61)

1. a

1 contains every prime factor of M,

2. 4

(a

1) if 4

M.

(58)

|

−

|

−

(Figs. 4–8). With

b = gcd (a

1, M) = gcd (B, M)

−

we ﬁnd mM B = gcd(a
MB/mM B = M and s

1, MB) = B, m0M B = b, M0M B = M/b, NX
X0) = sac. We obtain from Eqs. (47), (49)

−
(X1 −

·

2 (s0, s) = bsa,M/bδs0+csa= 1

ˆg
|

|

2 bsa,M/bδ2| M

mod bsa,M/b

bsa,M/b

.

In particular for s0 = 0 we observe that ˆg is only non-zero if M/bsa,M/b is odd and
sa = 0 mod bsa,M/b. From the second identity we conclude sa = 0 mod M and thus

2 (0, s) = Mδsa=0 mod M

ˆg
|

|

For n = 1 we get sa = s1 and ˆg is the Fourier transform of the uniform distribution.
So, X k has the property to produce every number in ZM exactly once in a period.
The generator is called to have a full period.

We proceed with a discussion of the parameters a and c.

(a) Choice of c. We can restrict ourselves to 1

·

≈

≈

≈

√b,

0.35.

·
≈

≈
s1 ≈

(b/4)/b = √2/4

c
≤
≤
Xk+∆k −

δ2|M/b mod b.
b−1/2.

√b gives Q1(s0 ≈
√2
b/4)

b/2 since every c emerges
X∆k = a∆kXk) or reﬂection
(0, b/2) via translations (Xk 7→
from a c
∈
Xk). We can determine c by the condition that there should be no
(Xk 7→ −
If M/b
small (s0, sa), gcd(M, sa) = 1 with s0 + sac = b/2
√b + 1/b
is odd c
In the case
1)
−
where M/b is even and b is small the choice c = 1 is best with the result
Q1(s0 ≈
In the case of Fig. 5 with the ’wrong’ choice c = 3 one has a = 9 mod 16, b = 8
2(1, 1) = 8 we
and the smallest (s0, s1) with non-vanishing ˆg is (1,1). Since
obtain Q1(1, 1) = √2/8
0.18 (notice the correlations perpendicular to the
(1,1)-direction in Fig. 5I). With the right choice c = 1 (Fig. 6) it takes an
0.40
(s0, s1) = (1, 3) (or (3,1)) to get
which means that the random numbers are more uniformly distributed in Fig.
6I. The large value of Q1(1, 3) is yet misleading since Q1 = Q1(
M/8, M/8) =
√2/8. However
2 assumes the small value of Q1 at much less sites as in the
case of c = 3 which means that the choice c = 1 is better than c = 3.
Notice the similar pair distributions in Fig. 5II and Fig. 6II. In general the
quality dependence on c can not be obtained by the standard spectral test
(corresponding to s0 = 0) since the n-tuple distributions are only shifted by
changing c.

2 = 8. Therefore Q1(1, 3) = √10/8

ˆg
|

ˆg
|

ˆg
|

≈

−

≈

|

|

|

4 GENERATORS

19

≈

√2/4 for small (s0, s1) (cf. (a)). However Q1(

(b) Choice of b. In general b should be as small as possible in order to prevent
√b then
s1 ≈
M/b, M/b) = √2/b

2 from being concentrated on too few points. If M/b is odd, c
ˆg
|
|
Q1 behaves like b−1/2. If M/b is even, c = 1 then Q1(s0, s1) = Q1(s0 ≈
b/4)
which forbids large values of b.
For a power of two modulus the smallest value possible is b = 4 which implies
Q1 = √2/4 (Fig. 4). In particular M = 10d (Fig. 7) should be avoided since
in this case b
≥
These arguments require s0 6
spectral test.

= 0. They are not obtained by the standard

20.

−

≈

(c) Choice of a. Up to now we have evaluated

2(s0, s1) for n = 1 which is given
ˆg
|
In order to determine a more precisely we have to look at the
2. In this case Qn = min sQn(s0 = 0, sa =
/M. A further discussion of the choice of a is postponed to

by b and c.
distribution of n-tupels for n
0) = min s:sa=0|
Sec. 5. We will see that a reasonable a gives Qn ≈
Since s0 = 0 this part of the choice of a is identical with the standard spectral
test.

M 1/n−1.

s
|

≥

|

Let us summarize the result for M = 2d,

s
c = 1 , a = 5 mod 8 , max amin s:sa=0|
|
NX = M , Q1 = √2/4 , Qn ≈
M 1/n−1 .

, for n = 2, 3, . . . gives

(62)
(63)

A loss of randomness for n-tupels is avoided if one takes gcd(n, M) = 1.

2. a = 3 mod 8, M = 2d. If sa,M ≤

M/32sa,M , Nm′

= Nm0

′
M B

M B

M/32 then B = 2, m′

M B = m0

′
M B = 8, M0

′
M B =

= 2 and from Eq. (47) we get

2 (s0, s) =

ˆg
|

|

8NXsa,M
M

Xk=0,1

δ M
2NX

s0+3kc a+1

4 sa=4sa,M δ64| M
sa,M

mod 8sa,M

.

(64)

We obtain NX = M/2 (cf. Eq. (13)) and either Q1(1, 1) = √2/4 or Q1(
1, 1) =
√2/4. The period is doubled compared with the multiplicative case and the quality
remains unchanged. Since a = 3 mod 8 has only half the period of a = 5 mod 8 the
latter should be preferred.

−

The only improvement we achieved was an increased period by a factor of B. The
mixed multiplicative generator mod M equals the multiplicative generator mod MB. For
a power of two modulus we still have Q1 = √2/4 < 1.

This does not mean that one can not use the mixed multiplicative generator if the
modulus is large enough. In Fig. 8 we see that all problems dissolve if the modulus is
much larger than the range of random numbers used. Nevertheless it will be proﬁtable to
look for improvements in the next sections.

We close this section with a well known theorem which is a corollary of our general theory.

4 GENERATORS

20

Corollary 4.4 (Greenberger [7], Hull and Dobell [8]). The mixed multiplicative generator
has a full period if and only if (58) holds.
Proof. We saw in Ex. 4.3 1 that (58) implies a full period. If on the other hand NmM B > 1,
due to Eq. (29) there either exists a prime factor P
M and
In the ﬁrst case we look at the generator mod P and ﬁnd B = 1. Hence
N4 > 1.
NX mod P = NP < P and the generator has no full period. In the second case a = 3 mod 4
2
and

k: Xk = 0 mod 4 or Xk = c mod 4.

= 2 of M with NP > 1 or 4

|

∀

4.3 X0 = 0, Xk+1 = aXk + ck mod M

Let 1

= a, c

Z×

M . The recursion formula gives Xk = c

∈

a−1 ( ak−1

a−1 −

k) mod M.

1)/(a

k−1
j=0 c(ak

−
ck = c

to both ways presented in the last section. Firstly, it is the sum generator

The generator of this section improves the mixed multiplicative generator according
j =
1) of the mixed multiplicative generator. Secondly, we observe that
1. On the other hand the
ck and the division by a
1

X mm
1) mod M can be divided by a
P
k −
−
randomness of Xk should not diﬀer much from that of Xk −
improves the generator.
Theorem 4.5. Let B be deﬁned by Eq. (57) then the Fourier transform of the generator
X0 = 0, Xk+1 = aXk + ck mod M, 1

M is given by Cor. 3.5 with

k−1
j=0 X mm

−
k−1
j=0(aj

= a, c

Z×

−

−

P

P

∈

X

7→

7→

XB2 , M

MB2 .

NX = lcm

Nm, 2δ2|M M

(65)

(cid:16)

(cid:17)

is the period of X.
Proof. Analogously to the proof of Thm. 4.2 we ﬁnd that Xk/M = c(( B
a−1 Bk)/MB2 mod 1 where B
B
a−1 is the inverse of (a
remains to show that the period of X is given by Eq. (65).

−

−
1)/B in ZM B2. With Cor. 3.5 it only

−

a−1)2(ak

1)

−

Since 0 = X1 = XNX +1 = aXNX + cNX = cNX mod M we know that M

1 = 0 mod M implies Nm|
ℓ , it suﬃces to show that XNX = 0 mod pkj
pkℓ
If Npj > 1 then a
1

aNX
components M = 2kpk1
and X2k = 2k−1 mod 2k.
a−1 ( aNX −1
XNX = c
M = 2 we get X2 = 1 and for M = 2k the result follows by induction since

NX and since
NX. If we split M into its prime
j = 1, . . ., ℓ
pj and one obtains immediately
j . The case Npj = 1 is treated in Ex. 4.6 1. For

NX we have lcm(Nm, M)

NX) = 0 mod pkj

a−1 −

1 · · ·

j ∀

Z×

−

∈

|

|

c

−
2.

X2M =

a

1  

for M
≥
Examples 4.6.

a2M
a

1
−
1 −

−

2M

=

!

a

1  

2c

−

aM
a

−
−

1
1 −

M

+ c

!

aM
a

 

2

1
1 !

−
−

= 2XM mod 2M

2

1. NmM B2 = 1 which means that a

1)
if M is even (Fig. 9). We ﬁnd mM B2 = m0M B2 = B, M0M B2 = M and for odd M
we obtain

1 contains every prime factor of M and 4

(a

−

−

|

2 (s0, s) =

ˆg
|

|

NX
M

sa,M δ M
NX

s0+s·Xmm

0 =0 mod sa,M

, X mm

k = c

(66)

ak
a

1
1

.

−
−

6
6
6
4 GENERATORS

21

With Eq. (13) we can conclude that NX = M since any NX = λM leads to
ˆg
|

s0. This completes the proof of Theorem 4.5.

2(s0, s) = 0 unless λ

|

|
If M is even we have NX = 2M yielding

ˆg
|

|

2 (s0, s) = 2sa,M δs0+2s·Xmm

0 =sa,M δ2| M
sa,M

mod 2sa,M .

(67)

For n = 1 we have sa,M = s1,M = gcd(s1, M) and s
0 = 0. Thus for
odd M we have Q1 = Q1(0, s1,M ) = 1. If M is even then Q1(1, 1) = √2/2 and if
= M/2k is odd then Q1(0, 2k) = 1/2. Therefore
k

N so that 1

0 = s1X mm

Xmm

·

∃

∈

NX = 2δ2|M M, Q1 = 


1
√2/2
1/2

if M is odd
if M = 2d
else

, Q2 ≈

M −1/3, Qn≥3 ≈

M 1/(n−1)−1 .

≈



2 which we will derive in Sec. 5.

(68)
In case of a power of two modulus we have increased Q1 from √2/4 for the mixed
multiplicative generator to √2/2
0.70 and NX from M to 2M. Notice also the
better behavior of Qn for n
2(0, s1) = 2δ2|M s1,M δM/s1,M odd . Only for M = 2d this is
For s0 = 0 we obtain
NXδs1=0, the Fourier transform of the uniform distribution. In this case one obtains
two full periods, every random number occurs twice in a period. Analogously to the
proof of Cor. 4.4 one can show that for NmM B2 > 1 a full period is not possible.
Thus the generator Xk+1 = aXk + ck mod M produces exactly uniformly distributed
random numbers if and only if M is a power of two and a = 1 mod 4.

ˆg
|

≥

|

The distribution of n-tupels is no longer a lattice as can be seen from Fig. 9II. So
even for the standard spectral test (s0 = 0) one would need Eq. (47) to analyze
the generator. We skip a further discussion here since in the next section we will
present an improved generator for a power of two modulus.

2. M = 2d, a = 3 mod 8. Let sa,M ≤

0M B2 = M/16sa,M , Nm′

M B2 = Nm′

M ′

0M B2 = 2 and we obtain

M/16 then B = 2, m′

M B2 = m′

0M B2 = 8,

2 (s0, s) = 8sa,M

ˆg
|

|

Xk=0,1

δs0+s·(Xmm

k+1+Xmm

k )=8sa,M δ32| M
sa,M

mod16 sa,M

.

(69)

For e.g. c = 1 we obtain Q1(3, 1) = √10/8
0.40 or Q1(1, 3) = √10/8. The
improvement in the quality is very little in comparison with the mixed multiplicative
generator. The period increases from M/2 to 2M. The generator with a = 5 mod 8
behaves clearly better.

≈

3. M = P d, P is an odd prime number and a is primitive,

1)P d. In the following c
1 mod P d. We have to distinguish three cases:

a−1 ∈

−

−

ﬁnd B = 1, NX = (P
a
1. sa,P d = 0 mod P d, m′ = m′
(X1 −
(47) is s0 + (P

1)s

−

·

0 = M ′
X0) = 0 mod(P

0 = 1, Nm′ = Nm′
1)P d

0 = 1. The condition in Eq.
1 and

s0 = 0 mod P

−

⇔

−

iP d = Z×
a
P d (Fig. 10). We
h
Z×
P d is c times the inverse of

6
4 GENERATORS

22

0, Nm′ = P

n
j=1 sj = 0 mod P d. With

P
1, Nm′
0 = 1. We obtain from Eq.

n
j=1 sj)/(a

1) = s0 −
1)P d we obtain the ﬁrst line in Eq. (70).
P

1) c
a−1

(P

−

−

1)c(sa −
−

s0 + (P
−
the pre-factor (P
2. sa,P d = P d−1, m′ = P , m′
2(s0, s) = P d
ˆg
(47)
|
|
Z×
2[P
ˆg
|
−
1, M = P, Xk = c

2
ZP −1[(P
1, XP d•](s0, s)δs0+ c

0 = 1 = M ′

ˆg
|

−

|

|

1)P d, X•](s0, s)δs0+s·(XP −1−X0)=0 mod P d. Since P d

|

ˆg
|

P −1 we get P d
2[N = P

∈
j=1 sj)=0 mod P d =
P d
j=1 sj mod P d.
Since aP dk = akmod P we can use the result of the multiplicative generator, Eq.
(52), d = 1, yielding the second line in Eq. (70).
P d−2, m′ = m′
1)

a−1 (sa(aP −1−1)/(a−1)−(P −1)
(a−1)2 aP dk](s0, s/P d−1)δs0=(P −1) c
P

0 = P d−λ−2, Nm′ = Nm′

0 = P , M ′

0 = P

1. We

P λ

−

−

P

a−1

n

n

−

k∈ZP −1 δs0+s·(XP −1+k−Xk)=0 mod P λ+2 = P λ+2/(P
j=1 sj)=0 mod P λ+2 = P λ+2/(P

−
k′∈Z×
P

1)

≤

≡
2(s0, s) = P λ+2/(P
ˆg
|

k∈ZP −1 δs0+ c

−
a−1 (saak(aP −1−1)/(a−1)−(P −1)
j=1 sj =k′saP mod P λ+2. Altogether,
P

P

·

n

n

3. sa,P d
obtain
1)
·
δs0− c
P
a−1 (P −1)

|

−

·

P

P

|

2 (s0, s) µ = d , s0 = 0 mod P
ˆg
|
sa = 0

1) P d
1)

−

(P
−
P d/(P
0
sa, P d
(cid:16)

1 µ = d , s0 6

−

= 0 mod P

1

−

0

P d+1/ (P

1)

−

µ < d
0
0

λ = d
1
λ
d
2
with sa,P d

−
−

≤

≡

gcd

0
1) s0 −
≡
(70)
(cid:17)
P −1/2. The
We ﬁnd that a proper choice of a and c leads to Q1 ≈
by a factor of P longer period compared with the multiplicative case (Ex. 4.1 2) is
to some extend compensated by a worse relative quality Q1.

P λ+2δµ=λ+1/(P
n
j=1 sj, P d

P
1)/P 2

1)
−
P µ.

P λ , gcd

(a
(cid:16)

√P (P

c (P

1)

≈

−

−

≡

−

(cid:17)

If we set s0 = 0 and n = 1 we ﬁnd λ = µ and therefore
random numbers are exactly uniformly distributed, the generator produces P
full periods.

2 = NXδs1=0. The
1

ˆg
|

−

|

Although NXQn is larger than for the multiplicative generator we can not recom-
mend the generator. If one is not interested in having full periods, generators with
a power of two modulus are more eﬃcient. If one needs a full period the velocity of
the generator is not important since M has to be comparatively small. Then only
the relative quality Qn is essential and the multiplicative generator is better.

4. Xk = c(k2

−

k)/2. This quadratic polynomial is obtained with a = M + 1. Since,
of course, NmM B2 = 1 Eqs. (66) and (67) of Ex. 1 for odd and even M are valid,
respectively. Although this generator has reasonable Q1 it is too simple to have
good pair and n-tupel distributions (cf. Sec. 5).

We close this section with a lemma which will play an essential role in Sec. 4.4.
Lemma 4.7. Let A
M ′/m′m′
If one of the following conditions holds there exists at most one C

0. Moreover ˜M ′ = ˜M B2/sa, ˜M B2, ˜m′ = maA, ˜M ′, ˜m′

N, M ′ = MB2/sa,M B2, m′ = maA,M ′, m′

0 =
0 = ˜M ′/ ˜m′ ˜m′
0.
ZA with ˆg[N, M, X• =

0 = m0aA, ˜M ′, ˜M ′

0 = m0aA,M ′, M ′

∈

∈

23

(71)

(72)

4 GENERATORS

(XA•+C+j−1)j=1...n]

= 0.

1.
2.

N with NMA = A and MA|

M with a = 1 mod ˜m′

0 and

(M ′/m′) .

MA ∈
∃
˜M
∃
|
MNaA,m′
NX

As0 + s

XANaA,m′ −

X0

=

·

(cid:16)

δ2|M ′

0 mod

˜M
˜M ′
0

.

M
2M ′
0

(cid:17)
gcd(aA

Proof. Since MA|
m′
m′, hence MA|
instead of X and M we obtain as a necessary condition for ˆg[X• = (XA•+C1+j−1)j]
ˆg[X• = (XA•+C2+j−1)j]:

(M ′/m′) we get MA|
1, M ′) =
0. Because of the condition in Eq. (44) and Eq. (46) with XB2 and MB2
=

M ′. Thus MA|

gcd(aANm′

1, M ′)

= 0

−

−

|

k1, k2 , with

M ′
MB2m′

n

sjB2

1)i

(

−

Xi=1,2
aANm′
m′

1

−

Xj=1
aAk1+C1

(cid:16)

−

(cid:16)

sa
sa,M B2

cB2

1)2

(a

−

∃

⇔

and therefore C1 = C2.

XA(Nm′ +ki)+Ci+j−1 −

XAki+Ci+j−1

= 0 mod m′
0

aAk2+C2

= 0 mod m′

0 ⇒

(cid:17)

(cid:17)
aC1 = aC2 mod MA

In case of Eq. (72) we may relax the condition in Eq. (47) and replace (after multipli-
cation with M) M/M ′
0. Since a = 1 mod ˜m′
0 we see from the above calculation
that in this case the condition is independent of C. Therefore all the ˆg[X• = (XA•+C+j−1)j]
are zero if ˆg[X• = (XA•+j−1)j] is zero. The dependence on k1, k2 drops, too, and we end
2
up with the condition in Eq. (72).

0 by ˜M/ ˜M ′

If ˆg is decomposed √NX ˆg[NX] =
only one of the terms on the right hand side can be non-zero. Therefore NX|

NX/Aˆg[NX/A, (XA•+C+j−1)j]
2[NX] =

C∈ZA exp(2πiCs0/NX)

ˆg
|

P

q

ˆg
|

2[NX/A, (XA•+C+j−1)j].

C∈ZA NX/A
|
This shows explicitly that the quality of n-tupels deteriorates if A
|
2[NX/A, (XA•+C+j−1)j] = A
|

the period reduces by A and max C∈ZA |

ˆg
|

P

ˆg
|

n and A
|
2[NX, X•].

NX because

4.4 X0 = 0, Xk+1 = aXk + c int(k/t) mod M

Let 1

= a, c

Z×

M , 2

t
|

|

∈

M and NM B2 = 1 (Fig. 11).

This section is restricted to even M since for odd M the random number generator of
Sec. 4.3 was already satisfactory. We only discuss NM B2 = 1 since this suﬃces to ﬁnd a
power of two generator with Q1 = 1.

If one tries to improve the generator of the last section by building sum generators one
would obtain the recursion relation Xk+1 = aXk + P (k) mod M, where P is a polynomial
of degree greater than one. Such generators may be interesting from a mathematical point
of view, however they are not easy to analyze and the calculation of the random numbers
becomes more time consuming.

We follow the second way to improve the generator of the last section. Looking at this
generator mod 2 one obtains the sequence 0, 0, 1, 1, 0, 0, 1, 1. . . and to make all random
Xk + int(k/2) which does not seriously
numbers even one could perform the map Xk 7→

6
6
6
6
4 GENERATORS

24

aﬀect the quality of the generator.
If we afterwards divide the random numbers by 2
we should end up with an improved generator. A slightly more general framework leads
to the recursion formula of the generator of this section (cf. Prop. 4.9).
It is perhaps
surprising that even this generator can be Fourier transformed algebraically at almost all
points (s0, s).

It would be possible to analyze this generator for NM B2 > 1. However this would

cause some extra eﬀort and for practical purposes this is not needed.

The Fourier transform of the generator is again derived from Eq. (47).

Theorem 4.8. Let X0 = 0, Xk+1 = aXk + c int(k/t) mod M, 1
NM B2 = 1 then

= a, c

Z×

M , 2

t
|

|

∈

M and

|

ˆg
|
1)/(a

2 (s0, s) = Sδs0+s·Xmm

0 =0 mod sa,M with S = sa,M if sa,M |

M/t .

(73)

1) is the mixed multiplicative generator related to X. The period

−

X mm
k = c(ak
is NX = Mt.
Proposition 4.9. There exists a c′
R(k) = R(k + t)

−

∈
Q, R(0) = 0, so that we get with X ′

∈

Z×

M , a d′

∈

Z, odd, and a periodic function R,
k),

k = c′

a−1 ( ak−1

a−1 −

Xk =

1
t  

X ′

k −

d′
2

k + R (k)

mod M .

!

(74)

k −

t (X ′

t (X ′

ad′k/2 + aR(k) + tc int(k/t)) = 1

−
−
d′(k +1)/2+R(k +1)) mod M we ﬁnd (a) c′ +ad′/2

Proof. The equation is trivial for k = 0. We can assume by induction that the equation
holds for k and prove it for k + 1. With k = tk′ + k0, 0
k0 < t we get Xk+1 =
1
t (aX ′
k0)). If we
compare this with 1
c = d′/2.
Further on, R(k + 1) is determined by R(k) and k0. Therefore the periodicity of R
is equivalent to R(t) = R(0) = 0. This means (b) Xt = c′
d′/2. To
solve Eqs. (a) and (b) we need the following observation. Due to Eq. (25) (replace M
by MBt2, B = m = gcd(a
ZM t2 with
at
M t and it has an inverse mod Mt which we will
denote by t(a−1)

−
1, MB)) we know that there exists a ct ∈
t(a−1) ∈

1 = ctBt mod MBt2. Thus at−1

ad′k/2 + aR(k) + c(k

a−1( at−1

t(a−1) −

k+1 −

k+1 −

Z×

c′k

1)

−

−

−

≤

at−1 . Now we can solve Eqs. (a) and (b) for c′ and d′ mod Mt,
t (a
t (a
at
at

1) Xt + c) ,

1)
1 ! −

t (a
at

1
1  

1)
1

d′ =

((a

2c

−

−

a

2

c′ =

−
−
Z×
M we have (a

1)
1

Xt .

−
−
1)Xt +c

−

1 and c

Since every prime factor of M is contained in a
and therefore c′

Z×

−
M . It remains to show that d′ is odd. We obtain mod 2:
1
1

X Sec. 4.3

1
1 −

at
a

a
at

a
at

= 2

= 2

1
1

t
2

t
!

1  

−

∈

c

a

t

= 1 mod 2 .

d′ = 2

∈

−
−

1
1

a
at

−

−
−

−
−

−
−

−
−

Proof of Thm. 4.8. We start with Prop. 4.9. Let k = tk′ + k0 and
equals

|

P (k0)

2 = 1 then

P (k0)

exp

Xk0∈Zt

Xk′∈Z

NX /t

2πi
NX





1
NX

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

s0 (tk′+k0) +

sj

X ′

 

tk′+k0+j−1 −

(tk′+k0)

2πi
Mt

n

Xj=1

Z×
M

∈

2
2
ˆg
|

|

2

.

!


(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

|

d′
2

6
4 GENERATORS

25

n
Now we combine the d′tk′/2-term with the s0tk′-term yielding (s0 −
j=1 sj)
·
(tk′ + k0). For the moment we set NX = 2Mt since we want to apply Lemma 4.7 on the
generator X ′. Later we will show that actually we have NX = Mt.

NX/2Mt

d′

P

·

P (k0)

Then only one term in the sum over k0 can be non-zero. Therefore

We assume that one of the conditions (71), (72) is valid (which we will show later).
2 = 1/NX ·
2 and P (k0) drops. Afterwards we interchange the sum over k0 and
taking the square once more and recombine the k0-sum with the k′-sum. We end up with
P
the squared Fourier transform of X ′ which was already analyzed in Ex. 4.6 1. The result
(Eq. (67)) is

k′... |

k0 |

ˆg
|

P

|

2[NX = 2Mt] (s0, s) = 2sa,M tδs0−d′

ˆg
|

|

n

j=1 sj+2s·X′mm

0 =sa,M tδ2| M t
sa,M t

mod 2sa,M t .

P

n

−

−

d′

X′mm

0 −
P

n
j=1 sj + 2s
·
1)

We ﬁnd
−
2c′)(sa −
Xmm
2s
·
d′ is odd d′sa = sa,M t mod 2sa,M t. Altogether the equation in the Kronecker δ in
Xmm
s0 + 2s
odd if sa is even so that
c1 = c2 = 2 we see that X has actually the period NX = Mt and since d′ is odd

n
j=1 sj + 2c′(sa −
d′
j=1 sj)/(a
1) +
0 =
n
d′sa and with Eq. (a) in the proof of Prop. 4.9 this equals
j=1 sj)/(a
P
P
d′sa. Now we assume that Mt/sa,M t is even. Then sa/sa,M t is odd and since
2 gives
0 = d′saδM t/sa,M t odd mod 2sa,M t. We recognize that Mt/sa,M t can only be
2[NX = 2Mt](s0, s) vanishes for odd s0. From Eq. (13) for

1) = (d′(a

ˆg
|

ˆg
|

−

−

−

P

·

|

|

2[NX = Mt] (s0, s) = sa,M tδs0+s·Xmm

0 = sa

2 δM t/sa,M t odd mod sa,M t .

ˆg
|

|

|

|

−

−

−

Z×
t

(Eq. (25)) with ak

1, Mt) = Mt/t there exists a ck ∈

gcd(M ′/m′, tk) for all k (M ′ = MB2t/sa,M B2t). Since sa,M |
1, M ′)

Now we check the conditions of Lemma 4.7. We set Mt = max k∈N gcd(tB, tk). Since
mMt = gcd(a
1 =
ckkMt/t mod Mt, hence NMt = t. Assume sa,M |
M/t. Since Mt consists only of prime
gcd(MB/sa,M , tk) it suﬃces to show that
factors of t and gcd(Mt, tk) = gcd(Bt, tk)
gcd(MB/sa,M , tk)
M/t we
get gcd(sa,M , tk) = gcd(sa,M B2t, tk) and therefore gcd(MB/sa,M , tk) = gcd(M ′/Bt, tk).
1, MB2t) = Bt, hence m′ = gcd(at
Finally from Eq. (25) we get gcd(at
Bt. So
−
|
Mt/sa,M which
t
Eq. (71) holds if sa,M |
|
proves Eq. (73) if sa,M |
M has to be replaced by Mt in Lemma 4.7). Since ˜M ′ = sa,M B2t/sa,M B2t|
˜m′ = gcd(at
and ˜M ′
(X′
·
M t
δ2|M ′
a−1 (sa −
2M ′
·
0
Xmm
and with Eq. (a) in the proof of Prop. 4.9 we get
0 −
·
0 + sa(X ′
t −

Mt (notice that
B2t and
B. Therefore a = 1 mod ˜m′
0
0 = 1. We can use Lemma 4.7 if M t
d′
X′
=
0)
0) = c′
n
n
j=1 sj) = saX ′
j=1 sj)
d′
n
j=1 sj) = s
2 (sa −
P
d′t/2)
Xmm
=

|
If sa,M does not divide M/t we take ˜M = tsa,M in Eq. (72). So ˜M

M/t. Moreover, in this case sa,M t = sa,M and 2
M/t.

n
j=1 sj). Collecting all pieces we obtain the condition ts0/2 + ts
M t
P
2M ′
0

1, ˜M ′) = gcd(Bt, ˜M ′) we have ˜m′
0|

( ˜M ′/ ˜m′)
|
2M tt(s0 −
t
c′
a−1 (sa −

−
0 = ˜M ′/ ˜m′ ˜m′
0 mod ˜M . Now s

δ2|M ′
Since mat,M B2t = m0at,M B2t = Bt we get with Eq. (49) M ′

n
j=1 sj) + s
t + t c′

0 mod ˜M .

at−1
a−1 −

a−1(sa

(X′

t −

t −

= t gcd(tsa, M)/2 = 0 mod ˜M if 2

fore M t
2M ′
0
satXt = 0 mod ˜M . We can divide the condition by t and get s0/2 + s

= 0 mod sa,M .
This condition holds for odd s0 which completes the proof that ˆg[NX = 2Mt](s0, s)
vanishes for odd s0. The period is NX = Mt and due to Eq. (13) we may replace s0/2 by

0. With Eq. (74) we get sa(X ′

Xmm
0

t −

M ′

0 = M/ gcd(tsa, M). There-
d′t/2) =

X′

P

P

P

|

|

·

·

6
6
6
4 GENERATORS

26

s0 if we calculate ˆg[NX = Mt](s0, s). This means that Eq. (73) is valid if the Kronecker
2
δ vanishes. Otherwise the equation holds trivially with S

If sa,M fails to be a divisor of M/t then
s0. At these points we only know that the average of

ˆg
|

|

2(s0, s).
2 remains undetermined for Mt/sa,M values of
2 is sa,M (Eq. (15)).

ˆg
|

≡ |

ˆg
|

|

Therefore one should choose t as small as possible, namely t = 2. In this case

M/2 and an explicit calculation using Eq. (74) (note that ak

is known if sa,M |
(a2
(a
1)k/2
−

−

−

1)2δk odd /2 mod 2B2) gives

2

ˆg
|
|
1 =

−

S = M

1 + cos

s0 + 2c

if sa = 0 mod M ,

t = 2 .

π
M 






n

Xj=3

aj−1
a2

aδ2|j
1

−
−





sj






In particular for n = 1 we ﬁnd
ˆg
|

2(s0, sa = 0) = M(1 + cos(πs0/M))
≈
If moreover M is a power of two then

ˆg
|

|

|

(75)
2(s0, 0) = 2Mδs0=0 (cf. Eq. (14)), and n = 2 gives





2M for small s0.

ˆg
|

|

2 is completely determined by Eqs. (73), (75)

and the generator can also best be implemented (cf. Ex. 5.1 1). We obtain

NX = 2M , Q1 = 1 , Q2 ≈

M −1/3 , Qn ≈

M 1/(n−1)−1 for n

3

≥

(76)

as will be shown in Sec. 5. It is advantageous to have two parameters a and c at hand
to optimize the quality of higher n-tuples and not only a as in the case of the mixed
multiplicative generator.

The generator does not provide full periods since

= 2Mδs1=0. How-
ever the deviation from an exact uniform distribution is not larger than in a ﬁnite true
random sequence. If one does not use the entire period of the generator (and this is not
recommended because of the n-tupel distribution) the feature of having a full period is
anyway irrelevant. If, for some reasons, one insists in a full period we recommend to use a
multiplicative generator with prime number modulus or the multiply recursive generator
which will be analyzed next.

2(0, s1) = s1,M 6

ˆg
|

|

The generator of this section behaves in every aspect better than the widely used
mixed multiplicative generator. This is also conﬁrmed by the ﬁgures (cf. Fig. 4 vs. Fig.
11). The extra eﬀort in calculating random numbers is little (cf. Ex. 5.1 1). If n-tuples
are used one should take odd n and occasionally omit one random number.

Nevertheless the most essential step for producing good random numbers is to use

large moduli (cf. Fig. 8 and Sec. 5).

1 = ... = X

r+1 = 0, Xk+1 = ar

4.5 X0 = 1, X
−
Let P be a prime number and X k have the maximum period of P r
In
this case the random number generator has a full period in the sense that every r-tuple
(X0, . . ., Xr−1)
Theorem 4.10 (Grube [9]). Let

= (0, . . ., 0) occurs exactly once in a period.

1Xk + ... + a0Xk

r+1 mod P

1 (Fig. 12).

−

−

−

−

P (λ) = λr

ar−1λr−1

−

. . .

a0.

−

−

(77)

The corresponding generator has maximum period if and only if P is a primitive polyno-
mial over ZP r .

6
5 CHOICE OF PARAMETERS

27

·

(Xk+∆k −
2πi
s
exp
P

·

The proof is found in [9, Satz 2.1].

Theorem 4.11. Let X k be deﬁned as above and sa ≡
then

2 is given by the following table.

·

ˆg
|

|

(s

Xk)0≤k<r = (

n
j=1 sjXk+j−1)0≤k<r

P

|

s0 = 0
P r
1
−
1/ (P r

s0 6
= 0
0
1) P r/ (P r

2 (s0, s)
ˆg
|
sa = 0
= 0
sa 6
Proof. First we notice that (s
s
either identically zero or it has maximum period. In the latter case every number
is produced P r−1 times in a period and the zero is generated P r−1
same holds for (s

Xk)k obeys the same recursion relation as (Xk)k since
r
Xk)k is
ℓ=1 ar−ℓ s
Z×
P
1 times. Since the

n
j=1 sjXk+j−ℓ =

n
j=1 sjXk+j =

Xk+1−ℓ. So, (s

·
r
ℓ=1 ar−ℓ

Xk))k we get

Xk+1 =

(78)

1)

−

−

−

P

P

P

P

∈

·

·

·

(Xk+∆k −

Xk)

= P rδs·(Xk+∆k−Xk)=0 ∀0≤k<r −

1 .

·

(cid:19)

(cid:18)

∀

−

δs0=0.

Xk = 0

2(s0, sa = 0) = (P r

1)δs0=0. If on the other hand sa 6

Xk∈ZP r −1
If sa = 0 then s
ˆg
|
|
period and the Kronecker δ vanishes unless ∆k = 0. In this case Eq. (11) yields P r/(P r
1)

k, the Kronecker δ gives 1 and from Eq. (11) we obtain
Xk)k has maximum

−
2
−
The choice of parameters is determined by avoiding small s with sa = 0. For practical
Xk)0≤k<r = 0 by the equiv-
purposes it is more convenient to replace the condition sa = (s
n
alent requirement 0 = (s
j=k sjXj−k = 0 mod P , k = 1, 2, . . ., min(r, n).
r the only solution is s = 0 mod P . For n > k one has the problem of ﬁnding the
If n
smallest lattice vector of an n-dimensional lattice. The unit cell of this lattice has the
volume P r (cf. Sec. 5). Thus for proper parameters the quality of the generator is

X1−k)1≤k≤r ⇔

= 0 then (s

≤

P

·

·

·

NX = P r

1 , Q1 = Q2 = . . . = Qr = √2/

−

P −r

1
(cid:16)

−

(cid:17)
≤

, Qn>r ≈
r > 1. For 2

P r/n−r .

(79)

n

1 for 1

This is the ﬁrst generator which has Qn ≥
generator has higher ˜Nn = max(NXQn, NX) = P r
P than the multiplicative generator mod P r (Ex. 4.1 2, with ˜Nn ≈
In particular if one needs the full periods this generator may be recommended. For
prime numbers of the form P = 2k
1 the generator has good performance, too. If the
prime factors of P r
1 are known it is no problem to ﬁnd multipliers which lead to a full
period. A short discussion of the choice of parameters for large P and r is given in the
next section and an implementation is presented in Ex. 5.2 2.

r the
≤
1 but lower ˜Mn = max(NXQn, M) =
˜Mn ≈

P r/n).

−

±

−

≤

≤

n

5 Choice of parameters

We start with a discussion of the mixed multiplicative generator (the multiplicative gen-
erator is analogous). For practical purposes we can restrict ourselves to M = 2d and
a = 5 mod 8. We set c = 1 which is equivalent to any other odd c and assume n
2 since
the case n = 1 depends only on b which is 4 for a = 5 mod 8.

≥

5 CHOICE OF PARAMETERS

28

From Eq. (60) we obtain, as long as bsa,M/b < M, that ˆg vanishes unless sa,M/b|

= 0
a,M/b/4 > 1/4. However if sa,M/b = M/b we get
/M which for some s is much

s0 6

2 = M for (B) s0 = sa = 0 mod M. This leads to Qn =

q

1 + s2/s2

and therefore (A) Qn(s0, s) =
ˆg
|
|
smaller than 1/4.

s
|

|

So Eq. (B) is more important. We solve it for s1 yielding s1 = kM

a2s3 −
an−1sn depending on the free integer constants k, s2, s3, . . . , sn which give rise to
. . .
an n-dimensional lattice (cf. [2]). The lattice is given by an n by n matrix A according
to s = A

(k, s2, . . ., sn)T and we read oﬀ

as2 −

−

−

·

A =












a2

. . .

an−1

−

M

a
−
1

−

1

. . .

1












∼











M

a
−
1

a

−
1

. . .

a
−
1











,

(80)

where zeros have been omitted and both matrices deﬁne the same lattice since they diﬀer
only by SL(n, Z) lattice transformations.

We denote the length of the smallest non-vanishing lattice vector by νn. Since the
quality of the random numbers is determined by νn = MQn we search for an a which
large νn. Most important are small n, in particular the pair correlation n = 2. In the
best case the lattice has a cubic unit-cell and νn is determined by the dimension of the
lattice and the volume of the unit-cell. Since the volume is given by the determinant of
A we get as an approximate upper bound νn / M 1/n. The calculation of νn is a standard
problem in mathematics for which eﬃcient algorithms exist [10].

To simplify the search for reasonable multipliers it is useful to have also a lower bound
for νn. Due to the speciﬁc form of A it is easy to see that νn has to be larger than the
smallest ratio > 1 between two elements of then set
.
If we take e.g. a

{
M 1/2 we ﬁnd ν2 ' M 1/2 which is identical with the upper bound.

1, a, a2 mod M, . . ., an−1 mod M, M

≈
2M 1/4 which diﬀers little from M 1/2. Therefore ν2 ≈

≈
Similarly we obtain ν3 ≈
≈
M 1/2 + 1
≈
M + M 3/4 + 1
4 M 1/4
≈
k−1M 1/2k−1
2M 1/4 + . . . + 1
as long as k

is not compatible with a
can take a
since a2
a
signs) we get νn ' M 1/2n−1
1. Note that M 1/2n−1
≥
a lower bound for νn. In the generic case νn will be close to M 1/n (cf. Ex. 5.1 1).

M 2/3. However this
M 1/3 or a
M 1/2 and we only get ν2 ' M 1/3. On the other hand we
M 1/2 and
M 3/4 mod M we have ν3 ' M 1/4. Generally, with
(the plus signs may as well be replaced by minus
is only

M 1/3 if we take a

n and M 1/2n−1

≈
M 1/2 + 1

≫

≈

≈

}

Obviously νn increases with M. For all practical purposes the magnitude of M is
only limited by the performance of the generator. In practice one has to split M into
groups of digits (16 or 32 bit) that can be treated on a computer. The multiplication by
a performs best if the pre-factors 1/j are omitted. This should be done even though for
a
1)!.
Note that the number of digits of M is much more important for randomness than the
ﬁne-tuning of a.

the lower bounds for νn decrease, νn ' M 1/2n−1

M 1/2 + M 1/4 + . . . + M 1/2k−1

/(n

≈

−

Finally, we have to add not too small a constant a0 = 5 mod 8 (16 or 32 bit) to the sum
of powers of M. This constant can be ﬁxed by explicit calculation of the νn or by looking

5 CHOICE OF PARAMETERS

29

at (A) from the beginning of this section which implies that a0 should have large
all 16 < m = sa,M |
With this value of a0 we ﬁnd

for
. A suitable choice is e.g. a0 = 3 580 621 541 = 62 181 mod 216.

m1/n for n = 2, 3.
We summarize the result for the parameters of the mixed multiplicative generator:

M 1/2k−1

s
| ≈

|

|

s
|

c = 1 , a = 22k−1d0 + 22k−2d0 + . . . + 22d0 + a0 , with
e.g. a0 = 3 580 621 541 mod 2d0 , leads to

M = 22kd0 ,
a0 = 5 mod 8 ,
a0 ≈
NX = 2256 , Q1 = √2/4 , Qn ≈

2d0 ,

M 1/n−1 .

(81)

Now we turn to the improved generator of Sec. 4.4. The discussion of the generator

of Sec. 4.3 is analogous.

The Fourier transform of the generator is given by Eq. (73). We set n

2 since
2 =
ˆg
independently of the parameters Q1 = 1. Further on, we ﬁx an m
|
|
|
m if and only if (C) sa = km, k odd if m < M, and (D) s0 + c
1)sj = ℓm.
a−1
2 may even be 2M for m = M, cf Eq. (75).) Eq. (C) can be solved
(We neglect here that
for s1 and Eq. (D) for s0 depending on the integer parameters k, ℓ, s2, . . . , sn. This gives
rise to an (n + 1)-dimensional lattice (for m < M we actually obtain an aﬃne sub-lattice
since k has to be odd) determined by the matrix B via (s0, s) = B

M and ﬁnd that
n
j=2(aj−1

(ℓ, k, s2, . . ., sn)T ,

−

≥

P

ˆg

|

|

m

m

c
. . .
−
a . . .
−
1

. . .

B =

−

c (an−2 + . . . + 1)
an−1

−

m

m

·

c
−
a
−
1

∼



























c
−

a

−
1

. . .

c
−

. . .

a
−
1














(82)

m

m

c
−
a
−
1

a
a
−
1

−

1

a2 + a
a2
a

−

−

−

. . .
1 . . .

an−2 + . . . + a
an−2
1

. . .

−

−

−

,

(83)

1

1


















. . .

1

where again zeros have been omitted.
B describes an (n + 1)-dimensional lattice which has a unit-cell with volume m2. However
this does not imply that the smallest lattice vector νn has length of about m2/(n+1). We
see from (83) that there exists an (n
1)-dimensional sub-lattice with s0 = 0 and s2 =
−
sn (delete the ﬁrst and the third row and column in (83)). The unit-cell of
s1 −
−
4, is smaller than m2/(n+1).
the sub-lattice has volume m and νn ≈
≥
The smallest lattice vector for n
sn, s3, . . ., sn)
s1 −
≥
−
n + (s1 + s3 + . . . + sn)2)1/2. Since this is of about the same
3 + . . . + s2
1 + s2
with the length (s2
n)1/2 we may simply omit s2 and reduce the problem to
3 + . . . + s2
1 + s2
magnitude as (s2
1) dimensions given by (s1, s3, . . ., sn). Geometrically this means that the lattice
the (n

m1/(n−1) which, for n
4 will have the form (0, s1,

s3 −

s3 −

. . .

. . .

−

−































∼

−

5 CHOICE OF PARAMETERS

30

≥

corresponding to B for n
4 never has an approximately cubic unit-cell. Note moreover
that the sub-lattice is independent of c which means that c can not be ﬁxed by looking
at the n-tupel distributions for n

≥

4.

−

1)-dimensional case of the mixed multiplicative generator, Eq. (80), with

The smallest value of Qn = νn/m is obtained for m = M which is thus the most
important case. For m = M we are not restricted to odd k. The situation is similar to the
aj replaced
(n
−
by aj +aj−1+. . .+a. This allows us to use a = M 1/2+M 1/4+. . .+M 1/2k−1
+a0 again. Since
2)!M 1−22−n
2M 3/4
a2 mod M
M
1
aj mod M. The minus sign is irrelevant, thus we can
we have aj + aj−1 + . . . + a
copy the corresponding lower bounds from the mixed multiplicative generator: νn '
M 1/2n−2
4. The constant a0 is given by the case m < M as will
/(n
be discussed below.

an−2 mod M

2)! for k + 1

M 1/2

≈
≈

. . .

≪

≪

≪

≪

≪

(n

≥

−

≥

≈

≈

−

n

a

|

−

c, s1 =

ˆg
|
|
(s0, s)

M 1/2, s2 = 1 with

2/3, M λ
2 = 0 mod M λ has a solution with

The constant c can be ﬁxed by the case n = 2. We have to meet two equations (E)
2 = M. Both equations are
s1 + as2 = 0 mod M and (F) s0 + cs2 = 0 mod M to get
(c2 + M)1/2. In order to
solved by e.g. s0 =
a
≈ −
−
M 2/3 one needs c ' M 2/3. So, the simplest ansatz for c is
reach the theoretical limit ν2 ≈
N. On the other hand, if s1 = M 1−λs′
c = M λ + 1 for λ
2 then
∈
M 1−λs′
s′
1 +as′
2
/ M 1−λM λ/2 = M 1−λ/2. To allow for the maximum value M 2/3 one
we ﬁnd
2/3. In general, c should not have more successive zero digits than M 2/3 has.
needs λ
The simplest reasonable choice is therefore c = M 2/3 + 1. We can generalize this slightly
to c = (2d1 + 1)c0, where c0 is a 16 or 32 bit number and 2d1
c02d1. This choice
≤
of c leads to best performance among all reasonable c. We will see in Ex. 5.1 1 that it
M 1/2. As a lower bound for ν2, ν3 one has only the
actually gives ν2 ≈
values M 1/2, M 1/4 that are obtained from Eqs. (E), (C) alone.

/ M λ/2. Since (F) is solved by s0 =

M 2/3 and ν3 ≈

1, s2 = M 1−λs′

≥
s0|

(s0, s)

M 2/3

|
≤

| ≈ |

| ≈

−

≤

s′

|

|

Now we determine c0 and a0 by looking at sa,M = m < M. The case m < M is
more important than for the mixed multiplicative generator since Qn is not limited by
1/4. To some extent the smaller Qn for m < M is compensated by the fact that for
m. We use a0 = 3 580 621 541 as for the
small m there are more points with sa = odd
mixed multiplicative generator and ﬁnd with c0 = 3 370 134 727 = 11 463 mod 216 that
m1/2−1 if sa,M = m.
Q2(s0, s)

m2/3−1 and Q3(s0, s)

·

≈

≈

We summarize the result for the generator of Sec. 4.4:

M = 22kd0, a = 22k−1d0 + 22k−2d0 + . . . + 22d0 + a0, c =

2int(2k+1/3)d0 + 1
(cid:18)

(cid:19)

c0, with

2d0 ,

c0 odd ,

a0 ≈
a0 = 5 mod 8 ,
e.g. a0 = 3 580 621 541 mod 2d0 ,
M 2/3−1 , Qn≥3 ≈
NX = 2257 , Q1 = 1 , Q2 ≈
Finally we give a short discussion of the multiply recursive generator of Sec. 4.5 (cf.

c0 = 3 370 134 727 mod 2d0
M 1/(n−1)−1 .

leads to

c0 ≥

(84)

22/3·d0 ,

Ex. 5.1 2).
P should not be taken too small to provide enough digits for the random numbers. To
optimize the performance one should use a prime number of the form P = 2d
1, e.g.
P = 231

1. Moreover we set ar−1 = 1, ar−2 = . . . = a1 = 0.

±

−

5 CHOICE OF PARAMETERS

31

The most severe problem is to ﬁnd the prime factors of P r

to take r = 2k since in this case P 2k
·
basically left with the problem to determine the prime factors of P 2k−1

1 = (P 2k−1

+ 1)

. . .

1. To this end it is useful
1) and one is

−
(P + 1)

(P

·
P that makes the polynomial P (λ) = λr

−
+ 1.

·

Z×

−
Afterwards it is easy to ﬁnd an a0 ∈

a0 primitive over ZP r . Since

λr−1

−

−

Xk
Xk−1
...
Xk−r+1





















1
0
...
0





















= X k

·

, with X

≡











ar−1 ar−2

. . . a1 a0

1

0

,

(85)

. . .

1

0











a necessary and suﬃcient condition for a maximum period is X (P r−1) = 1l mod P and
X (P r−1)/p
1. High powers of X are easily
computed. If N =

= 1l mod P for all prime factors p of P r

{i:bi=1} X 2i and X 2i = (X 2i−1

then X N =

0, 1

)2.

−

2 = P r
n

Now one has to check the n-tupel distributions for n > r. We found (Eq. (78))
P
1 if and only if s0 = 0 and sa = 0. The latter equation is equivalent
Z (cf. Sec. 4.5) and gives rise to an
(ℓ1, . . ., ℓr, sr+1, . . ., sn)T , C = C1 · · ·
Cr,

ˆg
that
|
to 0 =
n-dimensional lattice determined by C via s = C

j=k sjXj−k = ℓkP , k = 1, 2, . . ., r, ℓk ∈
·

−

P

Q

|

bi2i, bi ∈ {

}

1



. . .

1



P



. . .

P

a0

−

1
−

. . .



a0

P

∼

−

. . .

. C

Xn−k

Ck =

C0 ≡

X1
−
1




























(after some lattice transformations) if r < n
determinant of C 0 is P r, however the symmetry of C 0 leads to νr+1 = . . . = ν2r ≡
is given by the shortest lattice vector of the 2 by 3 matrix













(86)
2r and ar−1 = 1, ar−2 = . . . = a1 = 0. The
ν which

. Since the














1
−

. . .

. . .

. . .

−

≤

1

1

1

T

,

P
0
0
a0 −
1 1 !
−

 

second and third row are identical (up to a minus sign) the problem is analogous to the
calculation of ν2 in the case of the mixed multiplicative generator. We obtain ν / 21/4P 1/2
with a0 ≈
1.

55109 for P = 231
We summarize the result for the generator of Sec. 4.5:

21/4P 1/2

≈

−

−

P = 2d
X (P r−1) = 1l mod P and X (P r−1)/p
NX = (P r

1, prime , r = 2k, ar−1 = 1, ar−2 = . . . = a1 = 0, a0 ≈
(P r
= 1l mod P
p
∀
|
√2 , Qr+1 = . . . = Q2r ≈

1) , Q1 = . . . = Qr ≈

−

−

1) , p prime, leads to

21/4P 1/2−r .

(87)

21/4P 1/2, with

Notice that the eﬀort for calculating random numbers does not increase with r.

Let us ﬁnally mention that the quality of the n-tupel Xℓ of the (non-successive) random
n values

numbers Xℓ, Xk2+ℓ, . . ., Xkn+ℓ deteriorates to Qn / P (r−d)/n−r if there exist d > r

−

6
6
5 CHOICE OF PARAMETERS

32

}

r
−

1, . . .,

with Xj = 0 (see the remark at the end of Sec. 2.2). In particular
of j
∈ {−
if Xk−1 = . . . = Xk−r+1 = 0 the pair (X0, Xk) has quality of less than P 1/2−r because
ℓ if a = bXk mod P . From Eq. (85) we see immediately that this happens
aXℓ = bXk+ℓ ∀
for multiples of k = (P r
1) (notice the equidistant zeros in Fig. 12I). This makes
it not desirable to use more than (P r
1) multiply recursive random numbers.
Example 5.1.

1)/(P

1)/(P

−

−

−

−

1. We set M = 2256 = 224·16, a = 2128 + 264 + 232 + 62 181 and in case of the generator
of Sec. 4.4 c = (2160 + 1)
11 463. In the following table we compare the mixed
multiplicative generator with the generator of Sec. 4.4. The results can easily be
obtained with a computer algebra program and Eq. (75).

·

Qn ≡

M αn−1 Xk+1 = aXk + 1 Eq. (81) Xk+1 = aXk + c ink (k/2) Eq. (84)
α1
1.00000
0.66667
α2
α3
0.50000
0.33333
α4
α5
0.25000
0.20000
α6

1.00000
0.65658
0.49783
0.33436
0.24636
0.19882

0.99414
0.50000
0.33203
0.24859
0.19721
0.16335

0.99414
0.50000
0.33333
0.25000
0.20000
0.16667

(88)
We see a good agreement of the quality parameters with the approximate upper
bounds. This means that our choice of parameters is satisfactory. Moreover the
table conﬁrms that the quality parameter of the generator of Sec. 4.4 lies above the
quality of the mixed multiplicative generator.

Finally we present an implementation of the generator in Pascal. We group the
digits of X k to 16 blocks of 16 digits X[1], . . . , X[16] starting from the highest
digits.

unit random1;
interface
const n=16; n0=(n+2) div 3; a0=62181; c0=11463;
var X:array[1..n] of longint;
procedure nextrandom;
implementation
var even:boolean; i:word; c:longint;
procedure nextrandom;
var j,k:word;
begin
if even then inc(c,c0); even:=not even;
for j:=1 to n do begin
X[j]:=X[j]*a0;
k:=2;while j+k<=n do begin inc(X[j],X[j+k]);k:=k shl 1 end end;

inc(X[n-1],X[n] shr 16); X[n]:=(X[n] and $FFFF)+c;

5 CHOICE OF PARAMETERS

33

inc(X[n0-1],X[n0] shr 16); X[n0]:=(X[n0] and $FFFF)+c;
for j:=n downto 2 do begin

inc(X[j-1],X[j] shr 16); X[j]:=X[j] and $FFFF end;

X[1]:=X[1] and $FFFF
end;
begin for i:=1 to n do X[i]:=0; c:=0; even:=true end.

The corresponding mixed multiplicative generator is obtained by omitting or chang-
ing the lines containing c. On a 100MHz Pentium computer this (not optimized)
program produces 19 563 random numbers per second whereas 20 938 mixed mul-
tiplicative random numbers can be produced. A loss of speed of about 6.6% seems
us worth the gain of better random numbers. Note that the number c suﬀers an
overﬂow every about 750 000th random number. This does not aﬀect randomness
and it is not worth the eﬀort to correct this ﬂaw.

2. We set P = 231
1709
733

1, r = 8 which leads to P r
331
368140581013
we take ar−1 = 1, ar−2 = . . . = a1 = 0, a0 = 60 045 yielding

151
·
·
708651694622727115232673724657. Moreover

−
21529

1 = 234

11

31

17

41

32

−

5

7

·

·

·

·

·

·

·

·

·

·

·

·

1

X0 = 1, X−1 = . . . = X−7 = 0 , Xk+1 = Xk + 60 045Xk−7 mod 231
NX = P 8

P 8
(cid:17)
(cid:16)
The following program gives on a 100MHz Pentium 74 473 random numbers (X[k])
per second.

−
1.00202−1, Q9 = . . . = Q16 =

2248, Q1 = . . . = Q8 =

(89)
0.06368−1.

P 8
(cid:17)
(cid:16)

1 ,

−

≈

unit random2;
interface
var X:array[0..7] of longint; k:integer;
procedure nextrandom;
implementation
const a0=60045;
var i:integer; x0,x1,x2:longint;
procedure nextrandom;
begin
x0:=X[(k+1) and 7];
x2:=(x0 and $FFFF)*a0; x1:=(x0 shr 16)*a0+(x2 shr 16);
x2:=(x2 and $FFFF)+(x1 shr 15)+((x1 and $7FFF) shl 16);
if (x2 shr 31)=1 then x2:=(x2 xor $80000000)+1;
inc(x2,X[k]);
while (x2 shr 31)=1 do x2:=(x2 xor $80000000)+1;
k:=(k+1) and 7;
if x2=$7FFFFFFF then X[k]:=0 else X[k]:=x2
end;
begin k:=0; X[0]:=1; for i:=1 to 7 do X[i]:=0 end.

6 RESULTS AND OUTLOOK

34

6 Results and outlook

We have generalized the spectral test. As the new feature we analyze the sequence of
random numbers (I in the ﬁgures) not only the distribution of n-tupels (II in the ﬁgures).
We saw that the mixed multiplicative generator did not pass the test with an ideal
result. We were able to construct an improved generator which has the recursion formula

X0 = 0 , Xk+1 = aXk + c int (k/2) mod 2d .

(90)

For the choice of the parameters a, c, d we made suggestions in Eq. (84). This generator
(or the multiply recursive generator given in Eq. (89)) seems us to be the best choice in
quality and performance. An implementation of a generator of this type with modulus
1077 was presented in Ex. 5.1 1. The calculation of random numbers is fast
2d = 2256
even though the modulus is that large. We think that for all practical purposes pseudo
random numbers generated with this generator can not be distinguished from a true
random sequence.

≈

We were able to analyze this generator and several others by virtue of a remarkable
formula on the harmonic analysis of multiplicative rings of remainder class rings (cf. Thm.
3.4 and Eq. (47)). The choice of parameters was discussed in Sec. 5.

For practical purposes there is essentially no need for further improvements. From a
purely mathematical point of view however there are lots of open questions.

First of all one could be interested in the cases where Eq. (47) does not provide the
P , cf. Ex. 4.1 5). In these

result (take e.g. M = P prime and a no primitive element of Z×
2(s0, s1) is given as zero of the polynomial
cases N

ˆg
|

|

Ps0 (Y )

≡

Y

N

ˆg
|

|

−

2 (s0, s1)

.

Ys1∈ZM (cid:16)
For multiplicative generators Ps0(Y ) = Y M
show that Ps0 has integer coeﬃcients. We were not able to prove this for s0 6
analytically determine the coeﬃcients for non-trivial examples.

MNY M −1 + . . .. Numerical calculations
= 0 nor to

−

(cid:17)

Further on, generators involving polynomials may be of interest. An example with a

(91)

quadratic polynomial was presented in Ex. 4.6 4.

Finally we would be interested in multiply recursive generators. Those generators are
given by a matrix-valued multiplier. The simplest example with a prime number modulus
was presented in Sec. 4.5. In this section we saw that multiply recursive generators are
also the best candidates for being even more eﬃcient than the generator given in (90).
In this connection multiply recursive generators with power of two modulus may be of
special interest.

Aknowledgement

I am grateful to Manfred H¨uck who motivated me to this work by showing me some ﬁgures
of random number generators.

6 RESULTS AND OUTLOOK

35

Figures

Some graphs of random number generators are presented to give a visual impression of
what the generator looks like. There are two possibilities to draw a two-dimensional
plot: ﬁrst (I), to plot the k-th random number X k over k and second (II), to plot X k+1
over X k presenting the pair correlation. The third part of the ﬁgures give the absolute
2(s0, s1) is a measure for the correlations along a line
ˆg
of the Fourier transform of I.
|
|
perpendicular to (s0, s1) in I (cf. Eq. (16)). For ideal generators
1 and
Figs. I and II should look like ﬁrst rain drops on a dry road.

2 should be

ˆg
|

≤

|

Fig. 1: X0 = 1, Xk+1 = 37Xk mod 1024
p
p
p
p
p
p
s1
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p X k+1
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
p

p
p
pp
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
pp
p
p
p
p

p
p
p
p
pp
p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p
p

p
p
p
p
p
p

p
p
p
p
p
p

p

I k

II

X k

0
0
0
0
210
2 0

0
ˆg
|

|

0
4
0
4
0

0
0
8
0
0

0
0
0
0
0

16
0
0
0
0
s0

X k+1

Fig. 2: X0 = 1, Xk+1 = 195Xk mod 1009
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
X k
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
ppp
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
ppp
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
ppp
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

1
1008
1
1008
1
1008
1
1008
1008
2 0

s1

0
ˆg
|

|

1009
1008
1009
1008
1009
1008
1009
1008
0

1009
1008
1009
1008
1009
1008
1009
1008
0

1009
1008
1009
1008
1009
1008
1009
1008
0

1009
1008
1009
1008
1009
1008
1009
1008
0
s0

X k

Fig. 3: X0 = 1, Xk+1 = 44Xk mod 312
p
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pppp
p
p
p
p
p
p
p
pppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
pp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p

X k+1

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

31
30

...
0
0
930
0

0
...

31
30
31
30
0

0 . . .
...
31
30 . . .
31
30 . . .
0 . . .

961
30

...
0
0
0
31

s1 31

0
ˆg
|

|

2

k

II

X k

s0

I

I

6 RESULTS AND OUTLOOK

36

p

X k+1

Fig. 4: X0 = 0, Xk+1 = 37Xk + 1 mod 1024
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
ppp
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
X k
p
p
p
p
p
ppp
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
ppp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
ppp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
ppp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
ppp
pp
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

Fig. 5: X0 = 0, Xk+1 = 41Xk + 3 mod 1024
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p X k+1
pp
pp
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

X k+1

Fig. 6: X0 = 0, Xk+1 = 41Xk + 1 mod 1024
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
pp
ppp
pppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
X k
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
pp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
pp
pppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
pppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

ppp
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

0
0
0
0
210
2 0

0
0
0
0
210
2 0

0
0
0
0
210
2 0

s1

0
ˆg
|

|

s1

0
ˆg
|

|

s1

0
ˆg
|

|

0
4
0
4
0

0
8
0
8
0

0
8
0
0
0

0
0
8
0
0

0
0
0
0
0

16
0
0
0
0
s0

0
0
16
0
0

0
0
0
0
0

32
0
0
0
0
s0

0
0
0
0
0

0
0
0
8
0

0
0
0
0
0
s0

X k+1

Fig. 7: X0 = 0, Xk+1 = 21Xk + 1 mod 1000
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
X k
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

k

II

X k

1000
0
0
0
0
0

s1 0

4
−
2
ˆg
|
|

0
0
0
0
0

0
0
40
0
0

0
0
0
0
0

0
0
0
0
40
s0

I

I

I

I

6 RESULTS AND OUTLOOK

37

Fig. 8: X0 = 0, Xk+1 = (37 + 1024)Xk + 1 mod 10242
X k+1
X k

p
pp
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
ppp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
pp
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
pp
pp
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
pp
pp
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
pp
p
pp
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
pp
p
p
p
p
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp

p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p

k

II

X k

cf. Fig. 4
with NX = 1020

I

I

I

I

Fig. 9: X0 = 0, Xk+1 = 37Xk + 129k mod 1024
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppppp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
X k
p
pp
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
pp
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppppp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
p
p
p
pp
pp
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p

X k+1

p

k

II

X k

0
0
0
0
211
2 0

s1

0
ˆg
|

|

0
2
0
2
0

0
0
4
0
0

0
2
0
2
0

8
0
0
0
0
s0

X k

Fig. 10: X0 = 0, Xk+1 = 30Xk + 25k mod 112
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
ppp
p
pppp
p
p
p
p
p
p
pp
ppp
p
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
pp
p
p
p
p
p
p
p
p
pppp
p
p
p
ppp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pppp
p
p
pp
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
ppp
p
pppp
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pppp
ppp
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
pppp
p
pp
ppp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
pp
p
p
p
ppp
p
p
p
pppp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
ppp
p
p
pppp
ppp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
pp
p
pp
ppp
p
p
p
p
p
p
p
p
p
pppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pppp
p
ppp
p
p
pp
ppp
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p

X k+1

k

II

X k

1210
0
0
0
0
0

s1 0

4
−
2
ˆg
|
|

0
0
0
0
0

0
121
10
0
0
0

0
0
0
0
0

0
0
121
10
0
0
s0

Fig. 11: X0 = 0, Xk+1 = 37Xk + 129 int(k/2) mod 1024
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pppp
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
X k
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
pp
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
ppp
pppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
pp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
pp
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
ppp
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
ppp
p
p

X k+1

k

II

X k

4
1
2
1
211
2 0

s1

0
ˆg
|

|

0
1
0
1
0

0
1
2
1
0

0
1
0
1
0

4
1
2
1
0
s0

REFERENCES

38

X k

Fig. 12: X0 = 1, X−1 = 0, Xk+1 = Xk + 7Xk−1 mod 31
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
pp
pp
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
p
p
p
p
pp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
pp
pp
p
p
p
p
pp
pp
p
p
p
p
pp
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
ppp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pppp
p
p
p
p
p
p
pp
p
p
p
p
p
p
pppp
ppp
p
p
p
ppp
p
p
p
p
p
p
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
ppp
p
pp
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
pp
p
p
p
p
pp
p
p
p
p
ppp
pp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
pp
p
p
pppp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
pp
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pppp
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
ppp
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
pp
pp
p
p
p
pp
p
p
pp
p
pp
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
pp
pp
p
p
p
p
p
pp
p
pp
p
p
p
pp
p
p
pp
p
p
p
p
pp
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
pp
p
pp
p
pp
p
p
p
p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
pp
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
pp p
p
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
p
pp
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
p
p
p
pp
p
p
pp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p p
ppp
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

X k+1

s1

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p
p

I

k

II

X k

1
960
1
960
1
960
1
960
960
2 0

0
ˆg
|

|

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0

961
960
961
960
961
960
961
960
0
s0

References

[1] R.R. Coveyou, R.D. MacPherson, Jour. ACM 14, 100–119 (1967).

[2] D.E. Knuth, The Art of Computer Programming, vol. II, 2nd. edition, Reading
(Mass.), Menlo Park (Cal.), London, Amsterdam, Don Miles (Ont.), Sydney, Addison-
Wesley (1981).

[3] G. Marsaglia, Proc. Nat. Acad. Sci. 61, 25–28, (1968).

[4] W.A. Beyer, R.B. Roof, D. Williamson, Math. Comp. 25, 345–360 (1971).

[5] H. Niederreiter, Advances in Math. 26, 99–181 (1977).

[6] Serge Lang, Algebraic Number Theory, 2nd. edition, New York, Berlin, Heidelberg,

London, Paris, Tokyo, Hong Kong, Barcelona, Budapest, Springer (1994).

[7] M. Greenberger, Jour. ACM 8, 163–167 (1961).

[8] T.E. Hull, A.R. Dobell, SIAM Review 4, 230–254 (1962).

[9] A. Grube, Mehrfach rekursiv erzeugte Zufallszahlen, PhD. thesis, Karlsruhe, Germany

(1973).

[10] A.K. Lenstra, H.W. Lenstra, L. Lovasz, Math. Ann. 261, 515–534 (1982).

