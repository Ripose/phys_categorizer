Eﬃcient Monte Carlo Calculations of the One-Body Density

Roland Assarafa), Michel Caﬀarelb), and Anthony Scemamac)

a) Laboratoire de Chimie Th´eorique, CNRS-UMR 7616,

Universit´e Pierre et Marie Curie Paris VI, Case 137,

4, place Jussieu 75252 PARIS Cedex 05, France

b) Laboratoire de Chimie et Physique Quantiques,

CNRS-UMR 5626, IRSAMC Universit´e Paul Sabatier,

118 route de Narbonne 31062 Toulouse Cedex, France

c) Laboratoire Cermics, Ecole Nationale des Ponts et Chauss´ees,

6 et 8 avenue Blaise Pascal, Cit Descartes-Champs sur Marne,

77455 Marne la Valle Cedex 2, France

(Dated: July 28, 2013)

Abstract

An alternative Monte Carlo estimator for the one-body density ρ(r) is presented. This estimator

has a simple form and can be readily used in any type of Monte Carlo simulation. Comparisons

with the usual regularization of the delta-function on a grid show that the statistical errors are

greatly reduced. Furthermore, our expression allows accurate calculations of the density at any

point in space, even in the regions never visited during the Monte Carlo simulation. The method

is illustrated with the computation of accurate Variational Monte Carlo electronic densities for

the Helium atom (1D curve) and for the water dimer (3D grid containing up to 51x51x51=132651

points).

PACS numbers: 02.70.Ss, 02.70.Uu, 02.50.Ng,71.15.-m

6
0
0
2
 
t
c
O
 
8
1
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
2
3
1
0
1
6
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

1

The Monte Carlo approach is probably one of the most widely employed numerical ap-

proaches in the scientiﬁc and engineering community. In computational physics, it has been

extensively used in the last ﬁfty years for studying a great variety of many-body systems un-

der many diﬀerent conditions. To date, the most popular application of the method is prob-

ably the calculation of classical thermodynamical properties.[1] However, the Monte Carlo

approach is also employed for evaluating quantum properties by using the Path-Integral

formulation of quantum averages as classical ones (Quantum Monte Carlo or Path Integral

Monte Carlo approaches[2]). In the recent years, these later approaches have emerged as

an unique and powerful tool for studying quantitatively the interplay between quantum and

thermal eﬀects in many-body systems (e.g., to understand the very rich physics of strongly

correlated materials).

At the heart of all these applications lies the calculation of a number of high-dimensional

integrals (or sums, for lattice problems) written under the general form

I(F ) =

dr1 · · ·

Z

drN Π(r1,

, rN )F (r1,

, rN )

· · ·

· · ·

(1)

where Π is some arbitrary N-body probability distribution (Π positive and normalized) and

F some arbitrary real-valued function. The integration is performed over all accessible con-

ﬁgurations for the N-particle system. The general idea of Monte Carlo approaches is to

evaluate the integral by sampling the conﬁguration space according to the probability dis-

tribution, Π, and by averaging F over the various conﬁgurations generated by the sampling
h· · ·iΠ indicates the statistical
average over the density Π. Various Monte Carlo algorithms (sampling procedures) can be

iΠ. Here and in what follows, the symbol

procedure, I(F ) =

F

h

found in the literature, the most celebrated one being, of course, the Metropolis algorithm.[3]

The eﬃciency of a Monte Carlo approach is directly related to the magnitude of the ﬂuctu-

ations of the integrand in the regions where the probability distribution, Π, is large. More

precisely, for a given number of Monte Carlo steps, the statistical error δF is proportional

to the square root of the variance of the integrand F deﬁned as σ2(F )

I(F 2)

I(F )2.

≡

−

Accordingly, a very attractive way of enhancing the convergence of a Monte Carlo simula-
tion consists in introducing alternative “improved” estimators deﬁned as new integrands ˜F

having the same average as F but a lower variance

˜F

h

iΠ =

F

h

iΠ and σ2( ˜F ) < σ2(F ).

(2)

2

In previous works[4, 5] it has been shown how improved estimators can be designed for any

type of integrand F and Monte Carlo algorithm, and some applications to the computation

of forces have been presented[5].

one-body (or one-particle) density, ρ(r)

In this Letter we present an eﬃcient improved Monte Carlo estimator for calculating the

ρ(r) =

δ(ri

r)

iΠ

−

N

h

Xi=1

(3)

and, more generally, any one-body average of the form

drρ(r)F (r). As we shall see,

our estimator allows very important reductions in variance. In the example of the charge

R

density of the water dimer presented below, a reduction of up to two orders of magnitude

in CPU time is possible for some regions of space.

In addition, and in sharp constrast

with the usual estimator based on the regularization of the delta-function on a grid, our

expression leads to accurate estimates of the density at any point in space, even in the regions

never visited during the Monte Carlo simulation (e.g., in the large-distance regime). This

property is particularly interesting when a global knowledge of the density map is searched

for. For the water dimer case, we were able to accurately compute the charge density for

51x51x51=132651 grid points. Note that such a calculation is vastly more diﬃcult to perform

when using the standard approach.

Let us recall that accurate one-particle properties are of central interest for the under-

standing of the physics of many complex many-body systems. Such systems include all

those which are not translationally invariant (typically, all ﬁnite systems: atoms, molecules,

clusters, nuclei, etc.) and all those whose translational symmetry has been explicitly broken,

e.g., by the application of an inhomogeneous external ﬁeld. In addition to this, many phys-

ical modelizations and/or eﬀective theories rely explicitly on the knowledge of the one-body

density. Many examples could be cited but let us mention, for example, the various mod-

elings of the electrostatic ﬁeld of molecules from the one-electron density[13], the studies

of the structure and reactivity of molecular systems based on the topological analysis of

the electron density and/or its Laplacian,[14], and, also, the very important case of Density

Functional Theories (DFT) which could greatly beneﬁt from the possibility of computing

accurate 3D charge/spin density maps for large molecular systems (e.g., via accurate ﬁts of

the exchange-correlation Kohn-Sham potential, see [15]).

Finally, let us note that the use of alternative forms for evaluating the density is not

3

new. For example, in the works of Hiller et al.[6], Sucher and Drachman[7], Hariman[8],

Rassolov and Chipman[9] new classes of global operators built for computing the density

have been introduced. However, in these works, the general idea is to design operators

whose expectation values give an accurate estimate of the unknown exact one-body density

and not the exact one-body density associated with a known N-body density. Actually, our

strategy is more closely related to what has been presented by Vrbik et al.[10], Langfelder et

al.[11], and Alexander and Coldwell[12]. In these works, alternative Monte Carlo estimators

with lower variances are also introduced. However, the emphasis is only put on the case of

evaluating the charge and/or spin density at the nuclei. Here, such ideas are extended to

any point in space and a general formula allowing to control all possible sources of statistical

ﬂuctuations in all possible regimes is presented.

General improved density estimator. Due to the presence of Dirac functions in the Monte

Carlo estimator of the density, Eq.(3), some sort of regularization has to be introduced. It is

usually done by partionning the physically relevant part of the one-particle space (usually,

the 3D ordinary space) into small domains of ﬁnite volume and by evaluating the corre-

sponding locally-averaged densities. In practice, such a procedure is particularly simple to

implement by counting the number of particles present in each elementary domain at each

step of the simulation. However, the statistical ﬂuctuations can be rather large. This is

particularly true for the low-density regions which are rarely visited by the particles. Even

worse, there is no way of evaluating the density in regions which are never visited during the

ﬁnite Monte Carlo simulation. One way to escape from these diﬃculties is to introduce some

global estimators deﬁned in the whole space. To do that, we regularize the δ Dirac-function

by using the following equality

δ(ri

r) = −

−

f (ri; r)

4π ∇

1

2
i

,

ri

|

r

|

−

where f (ri; r) is a smooth function of ri (here, r plays the role of an external parameter)

verifying f (ri = r; r) = 1. Note that this formula is just a slightly generalized form of the

well-known equality corresponding to f = 1. Now, injecting this expression into Eq.(3) and

integrating by parts, the density can be rewritten as

ρ(r) =

N

1
4π

−

h

ri

Xi=1

1

∇

2
i (f Π)
Π iΠ.

r

|
Next, we introduce some additional function g(r) independent on the particle coordinates

−

|

(4)

(5)

4

and write ρ(r) under the form

ρ(r) =

1
4π

−

N

1

[

h
Xi=1

ri

|

r

|

−

−

g]∇

2
i (f Π)
Π iΠ,

the last step being allowed since

∇2

i (f Π)

Π iΠ = 0.

h

Expression (6) is our general form for the improved estimator of the one-body density.

The two functions f and g play the role of auxiliary quantities. They are introduced to

decrease the variance of the density estimator. As with any optimization problem, there is

no universal strategy for choosing f and g. However, the guiding principle is to identify the

leading sources of ﬂuctuations and, then, to adjust the auxiliary functions to remove most

of them.

Improved electronic density estimator for molecules.

In what follows, we consider the one-electron density of molecular systems issued from

the N-body quantum probability distribution written as

ψ2
dr1 · · ·

, rN )

T (r1,
· · ·
drN ψ2
T (r1,

· · ·

,

, rN )

Π =

R

where ψT is some electronic trial wavefunction.

1. Short electron-nucleus distance regime.

For a system of electrons in coulombic interaction with a set of ﬁxed nuclei the exact

wave function is known to obey the following electron-nuclear cusp condition

where RA denotes the position of a given nucleus A of charge ZA. Most of the accurate

trial wavefunctions employed in the literature fulﬁll this important condition. Now, as a

consequence of the cusp condition we have

(6)

(7)

(8)

(9)

In the neigbhorhood of nucleus A, this term is an important source of ﬂuctuations. This is

easily seen by noting that, in the regime r

RA, the estimator of ρ(r), Eq.(6), behaves as

1

|ri−RA|2 , a quantity which has an inﬁnite variance [
R
of wild ﬂuctuations we adjust the function f so that ∇2

( 1
r2 )2r2dr = +
i f
f

∞

]. To remove this source

exactly vanishes the divergence

ψ

ri→RA 1

∼

ZA

ri

|

−

RA

,

|

−

∇

2
i Π
Π ∼

ri→RA −

4ZA

ri

|

−

RA

.

|

∼

5

i Π
Π . A simple suitable form for f verifying such a condition plus the constraint, f (ri =

of ∇2
r; r) = 1, is given by

f (ri; r) = 1 + 2ZA(

ri

RA

r

|

−

| − |

−

RA

).

|

(10)

2. Large-distance regime.

In the large-distance regime,
|

r

| →

∞

+

, the exact one-electron density is known to decay

exponentially. In contrast, our basic estimator decays algebraically as a function of r. Here,

we propose to force the latter estimator to decay also exponentially. In practice, a simple

choice for the function f is

f (ri; r) = (1 + λ

ri

r

) exp [

|

−

|

λ

ri

−

|

r

],

|

−

(11)

where λ is some real parameter. Note that the coeﬃcients of the linear and exponential terms

have been taken identical (= λ) to avoid the divergence of the laplacian of f at ri = r. The

parameter λ can be adjusted eiher by minimizing the ﬂuctuations of the average density

or ﬁxed at some value close to the theoretical value of λex = 2√

2I (I ﬁrst ionization

−

potential, the exact density is known to decay as ρ

exp

λexr).

Another useful remark is that, in the regime

+

, the electrons of the molecule

are, in ﬁrst approximation, at the same distance from the point where ρ is evaluated. As

a consequence, during the simulation the quantity 1/

ﬂuctuates very little around

the approximate average 1/

. Therefore, to reduce the ﬂuctuations it is valuable

ri

|h

i −

r

|

to remove a quantity close to the latter average from the former one. Here, this idea is

∼

r

|

| →

−

∞

ri

|

r

|

−

implemented by introducing the following function g

g(r) =

1
M

M

1
RA

.

r

|

−

XA=1

|

(12)

In our ﬁrst application we consider the He atom described by a simple trial wavefunction

written under the form, ψT = φ(r1)φ(r2) with φ = exp (

γr), and γ = 1.6875 (Slater value).

For this problem, the exact density is known and is given by ρ(r) = 2γ3/π exp (

2γr). Figure

−

−

1 shows the results obtained for ρ(r) for a relatively short Monte Carlo run. The main curve

displays the results obtained with i.) the usual estimator based on the delta representation,

Eq.(3), ii.) the simple improved estimator corresponding to Eq.(6) with f = 1 and g = 0,

and our best improved estimator deﬁned via Eqs.(6,10,11,12). In the latter case, the densities

corresponding to each of the two possible choices for f [Eqs.(10) or (11)] have been computed

6

for each distance, the ﬁnal value corresponding to the value having the smallest statistical

error. The usual estimator, Eq.(3), has been regularized by introducing small elementary

cubes of length a = 0.2. For all distances the statistical error associated with the usual

estimator is very large with respect to improved estimators. At intermediate distances, at

least one order of magnitude in accuracy is lost. For example, at r = 0.6 the statistical error

is about 10 times larger than for the simple estimator case and a factor of about 20 is found

with respect to the best improved estimator. At large distances, a region rarely visited by

the electrons, the standard estimator is so noisy that it is useless in practice. Now, regarding

improved estimators it is clear that the auxiliary functions f and g have a great impact in

reducing the errors. At very small distances (ﬁrst inset) a gain of about 5 in statistical error

is obtained with the best improved estimator. At r = 0, the gain is even larger since the

simple estimator has an inﬁnite variance. At large distances where both improved estimators

have a ﬁnite variance, it is seen that introducing some exponential decay into the estimator

plus a proper shift (g-contribution) improves considerably the convergence.

In the range

(2.5,3.) the gain in error increases from 15 at r = 2.5 to 40 at r = 3.

In our second application we consider the water dimer in a non-symmetric nuclear ge-

ometry (structure #2 of Ref.[16]) described by an electronic wavefunction consisting of a

Hartree-Fock part (cc-pVTZ basis set) plus a standard explicitly correlated Jastrow term.

Figure 2 shows the density plots obtained with our best improved estimator for a number

of points equal to 51x51x51 (=132651). As seen on the ﬁgure the density obtained displays

a very smooth aspect. A closer look shows that this regularity is present at a rather small

scale. In Figure 3 we present a more quantitative comparison of the data along the O-O

axis. The ﬁgure clearly shows that the best estimator outperforms the usual one. First, the

curve corresponding to the new estimator (solid line connecting the points) is very smooth,

although it has been obtained by simple linear extrapolation of the data.

In sharp con-

trast, this is absolutely not true for the usual estimator curve whose overall behavior is

particularly chaotic. Second, the statistical error has been greatly reduced using the new

estimator. Depending on the distance, a gain in accuracy ranging roughly from 5 to 10 (i.e,

up to two orders of magnitude in CPU time) has been obtained. An interesting point to

mention is the presence of some very wild ﬂuctuations in the neighborhood of r

1.5 for the

∼

standard estimator. These ﬂuctuations are due to the presence of a hydrogen atom close

to the O

O axis. We can verify that, in sharp contrast, our new estimator, which has

−

7

been built to correctly take into account the nuclear cusp, Eq.(10), performs well in that

region. Finally, remark that in the large-r regime (data not shown here) where the standard

estimator is strictly zero (no sampling of this region), the improved estimator still continues

to give accurate values of the very small density.

Acknowledgments The authors would like to thank the ACI: “Simulation Molculaire” for

its support. Numerical calculations have been performed using the computational ressources

of IDRIS (CNRS, Orsay) and CALMIP (Toulouse).

[1] See, e.g., K. Binder and D. W. Heermann, Monte Carlo Simulation in Statistical Physics :

An Introduction (Springer Series in Solid-State Sciences, 80), Springer-Verlag, 1998.

[2] See, e.g., D.M. Ceperley, Rev. Mod. Phys. 67, 279 (1995).

[3] N. Metropolis, A. Rosenbluth, M. Rosenbluth, A. Teller, and E. Teller, J. Chem. Phys. 21,

[4] R. Assaraf and M. Caﬀarel, Phys. Rev. Lett. 83 , 4682 (1999).

[5] R. Assaraf and M. Caﬀarel, J. Chem. Phys. 113 ,4028 (2000); R. Assaraf, ibid. 119, 10536

1087 (1953).

(2003).

[6] J. Hiller, J. Sucher, G. Feinberg, Phys. Rev. A 18, 2399 (1978).

[7] J. Sucher and R.J. Drachman, Phys.Rev.A 20, 424 (1979).

[8] J.E. Harriman, Int. J. Quantum Chem. 17, 689 (1980).

[9] V.A. Rassolov and D.M. Chipman, J. Chem. Phys. 105, 1470 (1996).

[10] J. Vrbik, M.F. de Pasquale, S.M. Rothstein, J. Chem. Phys. 88, 3784 (1988).

[11] P. Langfelder, S.M. Rothstein, J. Vrbik, J. Chem. Phys. 107 8525 (1997).

[12] S.A. Alexander and R.L. Coldwell, J. Mol. Phys.(Theochem) 487 67 (1999).

[13] S.R. Gadre, S.A. Kulkarni, and I.H. Shrivastava, J. Chem. Phys. 96 5253 (1992).

[14] R. F. W. Bader, Atoms in Molecules: A Quantum Theory (Clarendon, Oxford, 1990).

[15] See, e.g., R. van Leeuwen and E.J. Baerends, Phys. Rev. A 49, 2421 (1994); C.J. Umrigar

and X. Gonze, Phys. Rev. A 50, 3827 (1994); Q. Zhao, R. C. Morrison, and R.G. Parr, Phys.

Rev. A 50, 2138 (1994); R. C. Morrison and Q. Zhao, Phys. Rev. A 51, 1980 (1995);

[16] G.S. Tschumper, M.L. Leininger, B.C. Hoﬀman, E.F. Valeev, H.F. Schaefer III, and M. Quack,

J. Chem. Phys. 116 690 (2002).

8

FIGURE CAPTIONS

Fig.1 Density of Helium from various estimators, see text.

•

•

•

Fig.2 One-electron density of the H2O dimer with the best improved estimator.

Fig.3 Cut of the one-electron density along the O-O axis of the H2O dimer. Data for

the best and usual estimators. Solid lines are simple linear extrapolations of the data.

9

 2

ρ

(r)

 3.5

 3

 2.5

 1.5

 0.5

 1

 0

Usual Estimator
Simple Improved Estimator
Best Improved Estimator
Exact

 3.3

 3.2

 3.1

 3

 2.9

 2.8

 2.7

 2.6

 2.5

 2.4

 0

 0.02

 0.04

 0.06

 0.0005

 0.0035

 0.003

 0.0025

 0.002

 0.0015

 0.001

 0

-0.0005

-0.001

 1.5

r

FIG. 1:

 2.5  2.6  2.7  2.8  2.9  3

 0

 0.5

 1

 2

 2.5

 3

10

FIG. 2:

11

 1

 0.8

 0.6

 0.4

 0.2

ρ

 0

-2

(H O)2

2

Best
Usual

 0

 2

 4
r (along the O−O axis)

 6

 8

FIG. 3:

12

