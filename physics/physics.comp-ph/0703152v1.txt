7
0
0
2
 
r
a

M
 
5
1
 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 
1
v
2
5
1
3
0
7
0
/
s
c
i
s
y
h
p
:
v
i
X
r
a

Eﬃcient generation of correlated random numbers using Chebyshev-optimal
magnitude-only IIR ﬁlters

Alejandro Rodriguez1, ∗ and Steven G. Johnson2
1Department of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139
2Department of Mathematics, Massachusetts Institute of Technology, Cambridge, MA 02139

We compare several methods for the eﬃcient generation of correlated random sequences (colored
noise) by ﬁltering white noise to achieve a desired correlation spectrum. We argue that a class of
IIR ﬁlter-design techniques developed in the 1970s, which obtain the global Chebyshev-optimum
minimum-phase ﬁlter with a desired magnitude and arbitrary phase, are uniquely suited for this
problem but have seldom been used. The short ﬁlters that result from such techniques are crucial
for applications of colored noise in physical simulations involving random processes, for which many
long random sequences must be generated and computational time and memory are at a premium.

)

ω
R

(

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
0

The generation of correlated random sequences, or
“colored noise”, is important for many physical simula-
tions involving random processes [1, 2, 3, 4, 5], and often
the required computational time and memory is a criti-
cal concern. Although many ﬁlter-based techniques have
been applied to this problem [1, 2, 3, 6, 7, 8, 9, 10, 11],
in this Letter we point out that these methods are sub-
optimal: a global Chebyshev-optimum IIR ﬁlter for this
problem may be designed based on techniques developed
in the 1970s [12, 13].

Colored-noise generation is required for many types of
numerical simulations, such as thermodynamics [2, 3, 4],
laser noise and ﬁrst-passage time problems [1], and
chaotic dynamics [5].
In general, any numerical model
involving stochastic diﬀerential equations in which there
is some background distribution, nonlinearity, or external
noise associated with the quantities driving the ﬂuctua-
tions will require the use of colored noise [1, 3, 5, 8, 11].
From a computational standpoint, the key problem is
that many of these applications require large numbers of
random sequences to be generated in parallel, imposing
stringent performance and memory constraints on the
noise generation. For example, to investigate thermal
radiation, Ref. 4 introduces a stochastic partial diﬀeren-
tial equation (Maxwell’s equations) involving spatially-
uncorrelated random sources at every point in space with
a temporal correlation spectrum given by the Planck
spectrum, shown in Fig. 1. In a three-dimensional simu-
lation, this can require millions of simultaneous colored-
noise sequences, each of which could consist of hundreds
of thousands of random numbers [23].

The fundamental technique for generating correlated
random sequences is to start with white noise (uncor-
related random numbers) and to apply a ﬁlter whose
power spectrum matches the desired correlation spec-
trum [2, 3, 6, 10, 11]. That is, suppose that we want
colored-noise yn with some desired correlation function
Rm = ynyn+m, the (discrete-time) Fourier transform of
which is the correlation spectrum R(ω). We then start
with white noise xn, e.g. uncorrelated Gaussian ran-
dom numbers, with zero mean and x2
n = 1, and apply

0.1

0.2

0.3

0.4

0.6

0.7

0.8

0.9

1

0.5
ω

1)
FIG. 1: Plot of Planck distribution R(ω) = aω/(exp(aω)
vs. ω (red). The periodogram (spectrum) of a ﬁnite-length
correlated random sequence generated by the methods in
this paper is also shown (black), computed by Bartlett’s
method [14].

−

a ﬁlter H(ω): in frequency domain, Y (ω) = H(ω) X(ω).
2 =
The desired correlation spectrum is achieved if
H(ω)
|
|
R(ω).

Although this ﬁltering operation can be performed di-
rectly in the frequency domain via a fast Fourier trans-
form (FFT) of the data sequences [2, 3, 11], such an
approach is often too ineﬃcient. Filtering in the fre-
quency domain requires the entire data sequence yn to
be computed and stored in advance, and if many long
sequences are required the storage becomes prohibitive.
The alternative is to perform the ﬁltering in the time
domain, using either ﬁnite-impulse response (FIR) ﬁlters
or inﬁnite-impulse response (IIR) ﬁlters (also called re-
cursive ﬁlters). Since the generation of colored noise is

of interest to many researchers without a background in
signal processing, let us brieﬂy review the basics of FIR
and IIR ﬁltering, which are covered in more detail by
numerous textbooks [14]. FIR ﬁlters consist of a ﬁnite-
length sequence bn that is convolved with the xn. The
Fourier transform of the bn is the ﬁlter H(ω), but in
general a ﬁnite-length sequence can only approximate an
arbitrary desired spectrum R(ω). In particular, an FIR
ﬁlter yields a spectrum H(ω) which is a polynomial in
z = eiω with coeﬃcients bn. A better approximation may
be obtained by generalizing to a ratio of two polynomials
(i.e., rational functions), which leads to IIR ﬁlters. An
IIR ﬁlter is determined by two ﬁnite-length sequences,
an (n = 0 . . . N , a0 = 1) and bn (n = 0 . . . M ), that de-
termine yn via the recurrence (which can be written in
several equivalent forms):

yn =

bkxn−k

akyn−k .

(1)

M

X
k=0

N

−

X
k=1

That is, yn is a convolution of bn with xn and of an with
the previous values of yn. The ﬁlter design problem is
then, given ﬁlter orders N and M , to ﬁnd the an and bn
that best approximate the desired spectrum.

Therefore, we must choose what type of ﬁlter to apply
(IIR or FIR) and a ﬁlter-design method. Several choices
have been previously proposed in the context of colored-
noise generation. The simplest method, as we mentioned
above, is to just perform a fast Fourier transform (FFT)
of the entire desired spectrum [2, 3, 9, 11]. This is equiv-
alent to an FIR ﬁlter of the same length as the data,
designed by the “window” method [14]. One can also em-
ploy FIR ﬁlters of shorter lengths, designed by a variety
of standard methods such as Parks-McClellan [14, 15].
For certain noise problems, an FIR ﬁlter may also be de-
signed by analytical methods [3, 9]. In order to shorten
the length of the required ﬁlter, and thus the memory
and time requirements, IIR recursive ﬁlters have been
proposed [3, 6, 10]. In general, the design of IIR ﬁlters
is a diﬃcult problem [14, 16], and past approaches to
colored noise generation by IIR ﬁltering have used local-
optimization [10] or Yule-Walker methods [6] that are
not guaranteed to yield the global-optimum ﬁlter coef-
ﬁcients. One important exception is exponentially cor-
related noise, for which an exact ﬁrst-order IIR ﬁlter
is known analytically and is commonly used (although
typically derived from a stochastic diﬀerential equation
y′ =
ay + x and not recognized as an IIR ﬁlter per
se) [1, 5, 7, 8]. However, there is a key property of the
IIR ﬁlter design problem for colored-noise generation that
makes optimal ﬁlter design practical: the phase of the ﬁl-
ter H(ω) is irrelevant, since it is multiplied in any case
by white noise X(ω) with a random phase.

−

In particular, we

results by Dud-
geon [12] and Rabiner [13], who demonstrated that the
global Chebyshev-optimum magnitude-only minimum-

can exploit

2

phase IIR ﬁlter-design problem can be eﬃciently solved
by a sequence of linear-programming problems [17]. Al-
ternative methods with similar properties have also been
proposed [18, 19], and the Dudgeon and Rabiner tech-
nique was recently generalized to multidimensional IIR
ﬁlters [20]. However, its applicability to the problem
of colored-noise generation does not seem to have been
appreciated, and in this Letter we demonstrate that it
yields dramatically more eﬃcient ﬁlters than previous
approaches.

To demonstrate the eﬃcacy of the various ﬁlter-design
approaches for colored-noise generation, we consider an
example drawn from thermodynamic simulations of gray-
body thermal radiation [4]. In this problem, thermal ef-
fects are modeled as random ﬂuctuating current sources
everywhere in space, with a correlation spectrum R(ω) =
aω/(exp(aω)
1), for a constant a determined by the
temperature, based on the Planck distribution. This dis-
tribution is shown in Fig. 1, along with the periodogram
of a ﬁnite-length correlated random sequence generated
by the methods in this paper.

−

An IIR ﬁlter is deﬁned by a rational polynomial func-

tion in z = eiω:

H(ω) =

(2)

iωk

bke

M

X
k=0
N

iωk

ake

1 +

X
k=1

where N and M deﬁne the ﬁlter order and a0 = 1 for
convenience. A stable minimum-phase IIR ﬁlter has all
of its poles and zeros within the unit circle in z (i.e., for
Im ω > 0) [14]. Given a sequence of uncorrelated random
numbers xn, the output colored-noise sequence yn is then
given by the recurrence (1) above. The required memory,
along with the computation time per output, is therefore
O(N + M ). An FIR ﬁlter is the special case N = 0.
A sequence yn of length K from an FIR ﬁlter can be
generated in O(K log M ) time instead of O(KM ) by use
of fast Fourier transforms, but the memory requirements
are not improved.

− |

R(ω)

2
H(ω)
|

In Fig. 2, we plot

the L∞ (Chebyshev) error,
, as a function of the total ﬁl-
maxω (cid:12)
(cid:12)
(cid:12)
(cid:12)
ter order N + M , for ﬁlters H(ω) designed by several
techniques. (Here, we employ the Chebyshev error over
the entire frequency bandwidth; for other applications,
only a subset of the bandwidth may be of interest.)
smallest Chebychev error for
The best method,
any given-order, is the optimal magnitude-only IIR ﬁl-
ter design (implemented using the diﬀerential-correction
algorithm [12, 17]). The other design methods plot-
ted consist of two FIR and two IIR ﬁlter techniques.
The two linear-phase FIR ﬁlter techniques are (from
the Matlab signal-processing toolbox): ﬁrst, the Parks-
McClellan algorithm, which ﬁnds the global Chebyshev

i.e.

3

FIR-LS
FIR-PM
IIR-YW
IIR-L

(a)

IIR-L

(b)

2

2

IIR-global

FIR-LS
FIR-PM
IIR-YW
IIR-L

(a)

IIR-L

(b)

2

2

IIR-global

0

10

r
o
r
r
e
 
v
e
h
c
y
b
e
h
C

10-1

-2

10

-3

10

0

FIR-LS
FIR-PM
IIR-YW
IIR-L

IIR-L

(a)
2
(b)
2

IIR-global

-1

10

-2

10

10-3

 
 )
R

-

H
 
(
L

2

10

20

30

40

50

N+M

2
|

R(ω)
|

FIG. 2: Plot of Chebychev error, L∞ = maxω
−
, vs. N + M for the Planck distribution R(ω)
H(ω)
|
|
given in Fig. 1. The Chebychev error is plotted for six dif-
ferent ﬁlter methods:
IIR Yule-Walker (red squares), FIR
Parks-McClellan (black crosses), FIR Least-Squares (blue
dots), IIR global-optimum ﬁlter (gray circles), and two non-
linear conjugate-gradient methods optimizing two diﬀerent
√R) (green diamonds) and (b)
L2 norms:
H
L2(
|

H
|
R) (magenta triangles).

(a) L2(

| −

2
|

−

-4

10

0

10

20

30

N+M

40

50

| −

H
|

√R), vs. N + M for the
FIG. 3: Plot of L2 error, L2(
√R)
H
Planck distribution R(ω) given in Fig. 1. The L2(
|
error is plotted for six diﬀerent ﬁlter methods:
IIR Yule-
Walker (red squares), FIR Parks-McClellan (black crosses),
FIR Least-Squares (blue dots), IIR global-optimum ﬁlter
(gray circles), and two nonlinear conjugate-gradient methods
√R) (green
optimizing two diﬀerent L2 norms: (a) L2(
diamonds) and (b) L2(

R) (magenta triangles).

H
|

| −

| −

H
|

2
|

−

-1

10

-2

10

 
 )
R

-

2

H
 
(
L

2

-3

10

optimum [14, 15] (black); second, a least-squares FIR op-
timization (blue), as described in Ref. 16. The two IIR
ﬁlter designs plotted are: ﬁrst, a nonlinear conjugate-
gradient minimization of a least-squares norm proposed
by Ref. 21, and suggested by Ref. 10 for use in gen-
eration of Rayleigh-correlated noise (gray circles); sec-
ond, another (non-global) optimization technique based
on the modiﬁed Yule-Walker algorithm in the Matlab
signal-processing toolbox [6, 22]. The conjugate-gradient
method only ﬁnds a local optimum, and is highly sen-
sitive to the starting point of the optimization for this
problem [10]. Here, we use the Yule-Walker IIR ﬁlter as
the starting point, and conjugate gradient is able to im-
prove upon it signiﬁcantly (in fact, it happens to nearly
match the Parks-McClellan FIR performance). We ex-
amined the conjugate-gradient minimization of two dif-
ferent L2 norms [L2(xn=1...N ) = pPn x2
n/N ] of the er-
√R) [10, 21] and L2(
ror: L2(
R), although
H
H
−
|
|
it turns out to make little diﬀerence in the result.

| −

2
|

We believe that the Chebyshev norm is typically the
most appropriate one for physical simulations involving
random processes. The reason is that a large error in a
narrow bandwidth, which might be allowed by a least-
square (L2) norm, could result in a spectral feature that
might be mistaken for a spurious physical phenomenon;
a large “spike” in error may also interact adversely with

-4

10

0

10

20

30

N+M

40

50

2
|

−

H
|

R), vs. N + M for the
FIG. 4: Plot of L2 error, L2(
R)
H
Planck distribution R(ω) given in Fig. 1. The L2(
−
|
error is plotted for six diﬀerent ﬁlter methods:
IIR Yule-
Walker (red squares), FIR Parks-McClellan (black crosses),
FIR Least-Square (blue dots), IIR global-optimum ﬁlter (gray
circles), and two nonlinear conjugate-gradient methods op-
√R) (green
timizing two diﬀerent L2 norms: (a) L2(
diamonds) and (b) L2(

H
|
R) (magenta triangles).

2
|

| −

H
|

2
|

−

−

2
|

nonlinearities in the physics. Nevertheless, in Fig. 3 and
√R) and
Fig. 4, we show two diﬀerent L2 errors, L2(
H
|
R), for the same ﬁlter designs as in Fig. 2, and
H
L2(
|
the results demonstrate that the Chebychev-optimal IIR
ﬁlter is at least comparable, and often superior to, the
other methods, even in norms that it does not strictly
R) norm of the
optimize.
Chebyshev-optimum IIR ﬁlter does better than all other
local optimization techniques for most N + M .

H
In particular, the L2(
|

2
|

|−

−

ACKNOWLEDGEMENTS

We are grateful to Alan V. Oppenheim, Stephen Boyd,
and Almir Mutapcic for helpful discussions. This work
was supported in part by the Materials Research Science
and Engineering Center program of the National Sci-
ence Foundation under award DMR 02-13282, by a De-
partment of Energy (DOE) Computational Science Fel-
lowship under grant DE-FG02-97ER25308, and also by
the Paul E. Gray Undergraduate Research Opportunities
Program Fund at MIT.

∗

Electronic address: alexrod7@mit.edu

Rev. A 38, 5938 (1988).

[2] K. Y. Billah and M. Shinozuka, Phys. Rev. A 42, 7492

(1990).

[3] J. N. Kasdin, Proc. IEEE 83, 802 (1995).
[4] C. Luo, A. Narayanaswamy, G. Ghen, and J. D.
Joannopoulos, Phys. Rev. Lett. 93, 213905 (2004).
[5] A. Traulsen, K. Lippert, and U. Behn, Phys. Rev. E 69,

026116 (2004).

4

[6] Y. K. Chan and R. W. Edsinger, IEEE Trans. Automatic

Control 26, 676 (1981).

[7] R. Manella, Phys. Rev. A 40, 3381 (1989).
[8] J. Garcia-Ojalvo, Phys. Rev. A 46, 4670 (1992).
[9] D. J. Young and N. C. Beaulieu, IEEE Trans. Comm.

48, 1114 (2000).

[10] C. Komninakis and J. F. Kirshman, Satellite Communi-

cations pp. 24–34 (2004).

[11] K. Lu and J.-D. Bao, Phys. Rev. E 72, 067701 (2005).
[12] D. E. Dudgeon, IEEE Trans. Acoust, Speech and Sig.

Proc. 22, 443 (1974).

[13] L. R. Rabiner, N. Y. Graham, and H. D. Helms, IEEE
Trans. Acoust, Speech and Sig. Proc. 22, 117 (1974).
[14] A. V. Oppenheim and R. A. Schafer, Discrete-Time Sig-
nal Processing: Second Edition (Prentice-Hall, Engle-
wood Cliﬀs, NJ, 1999).

[15] L. R. Rabiner, J. H. McClellan, and T. W. Parks, Proc.

of the IEEE 63, 595 (1975).

[16] T. W. Parks and C. S. Burrus, Digital Filter Design

(John Wiley and Sons, New York, 1987).

[17] S. Crosara and G. A. Mian, IEEE Trans. Circ. and Sys.

[18] A. Alkhairy, IEEE Trans. Circ. and Sys. II 42, 618

[19] X. Zhang and H. Iwakura, IEEE Trans. Sig. Proc. 44,

[20] D. Gorinevsky and S. Boyd, IEEE Trans. Circ. Syst. I

[21] K. Steiglitz, IEEE Trans. Audio and Electroacoustics 18,

30, 898 (1983).

(1995).

1325 (1996).

53, 372 (2006).

123 (1970).

Sys. 20, 158 (1984).

[23] In the speciﬁc problem considered in Ref. 4, the corre-
lation function could be renormalized to an uncorrelated
sequence due to the linearity of the system, but this trick
would not work in nonlinear or nonequilibrium systems.

[1] R. F. Fox, I. R. Gatland, R. Roy, and G. Vemuri, Phys.

[22] B. Friedlander and B. Porat, IEEE Trans. Aero. and Elec.

